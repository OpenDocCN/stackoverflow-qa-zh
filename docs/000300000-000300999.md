# StackOverflow 问答 000300000-000300999

# database - 带有 GUI 前端的 Jumpdrive 便携式数据库

> ID：300014
> 
> 赞同：2
> 
> 时间：2008-11-18T20:24:28.570
> 
> 标签：database, open-source, tags

是否有一个简单的数据库程序可以让我收集、排序、标记和重复琐事问题和答案？

如果开源中已经存在某些东西，你能指出我吗？我有汇编编程技能（提示笑话），但在 Perl、LINQ、Delphi、VB、C#、Java 领域没有那么多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T20:32:58.287

你的任务不会很困难。这将是学习 C# 的好方法（我最推荐这样做，因为用它创建 GUI 很容易）。您可以将数据存储在文本文件或序列化字典中。

如果您的数据库要变大，您可能会考虑使用 SQLite（将数据库存储为常规文件）。我不知道 SQLite 的 C# 绑定的状态，但可能有一些。

祝你好运！

# c++ - VARIANT_BOOL 与 BOOL

> ID：300027
> 
> 赞同：8
> 
> 时间：2008-11-18T20:28:23.290
> 
> 标签：c++, com

我正在使用 ATL 在 C++ 中编写一个 COM 对象，但不确定是否应该将其`VARIANT_BOOL`用于我的方法/属性。该对象将被其他 C++ 应用程序调用，但我不能排除来自 .NET 的使用。

我可以坚持使用旧的`BOOL`（IIRC 只是一个无符号整数）但是就`VARIANT_BOOL`在那里，我不应该使用它吗？如果我确实使用它，并从 C++ 应用程序调用这些方法，我必须添加额外的代码，因为 a`VARIANT_BOOL`不像“正常”布尔值，我必须检查`VARIANT_TRUE`和`VARIANT_FALSE`值。

是`VARIANT_BOOL`我可以忘记的时代错误还是应该坚持下去？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T20:36:54.770

VARIANT_BOOL 将使您的 COM 组件 VB6 友好。COM 似乎从来没有真正用于简单地在 C++ 中做事，而是更专注于使其易于从 VB 中使用。不确定这是否仍然适用于 COM 组件的 .net 访问。

# python - 是否可以将事件绑定到菜单而不是 wxPython 中的菜单项？

> ID：300032
> 
> 赞同：-1
> 
> 时间：2008-11-18T20:29:33.677
> 
> 标签：python, wxpython

没有什么可添加的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T20:34:58.283

当您的菜单打开时，您想要一个活动吗？使用`EVT_MENU_OPEN(func)`( `wxMenuEvent`)。但这并不是特别精确。正如文档所说，如果您打开菜单，它只会发送一次。对于另一个事件，您必须关闭它并再次打开另一个菜单。即在两者之间，您可以打开其他菜单（通过将鼠标悬停在菜单栏中的其他项目），并且不会再次发送事件。

你需要这个做什么？可能还有另一种方法可以做到这一点，而不是监听这种事件。

如果您想要菜单的所有项目的事件，请使用`EVT_MENU_RANGE(id1, id2, func)`（它正在使用`wxCommandEvent`）。所有从`id1`到 包括在内的 ID`id2`都将连接到给定的事件处理程序。使用范围而不是单独连接每个项目将提供更好的性能，因为事件处理程序列表中的项目更少。

# guidance-automation-tool - 智能客户端软件工厂：GAT 卸载

> ID：300033
> 
> 赞同：0
> 
> 时间：2008-11-18T20:30:40.743
> 
> 标签：guidance-automation-tool

我下载了适用于 VS 2008 的 Guidance Automation Toolkit，在安装过程中出现错误，迫使它关闭。现在，每当我重新运行 GuidanceAutomationToolkitForVS2008.msi 时，它都会告诉我该工具包已经安装，我需要在安装之前将其删除。我之前没有安装，在删除程序窗口中找不到 GAT。**有没有办法使用 regedit 为 Visual Studio 2008 的 2008 年 2 月 GAT 删除此安装？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T20:52:07.580

1.  删除所有 TEMP 文件夹中的所有内容。
2.  在 VS9.0 部分下的本地计算机和当前用户配置单元中的 regedit 中进行挖掘。搜索 GAT 或 Guidance Automation Toolkit 并记录 GUID。然后搜索那些 GUID 并删除所有引用，最后删除在搜索“GAT”时找到的所有条目。
3.  最后，运行 devenv /setup 以“重新初始化”自身。

您还可以尝试为 VS SP1 发布的服务包准备工具。

不确定这是否会有所帮助，但希望它提供一些见解:)

祝你好运！

# vb.net - WCF 服务器/客户端连接处理

> ID：300044
> 
> 赞同：-1
> 
> 时间：2008-11-18T20:34:04.090
> 
> 标签：vb.net, wcf, wcf-binding

我的 WCF 服务器和客户端连接存在一些问题。

如果我正常使用我的服务和客户端，这意味着我的客户端通过正常操作（myclient.Close（））连接和断开连接一切正常。但是在我让服务器运行并且我使用 Visual Studio“停止”按钮退出我的客户端应用程序的情况下，我的服务器和客户端通信似乎搞砸了，服务器没有正确清理连接和任何新连接来自我的客户的非常不稳定，只有某些函数调用才能工作，直到一个函数抛出异常：

[System.ServiceModel.CommunicationException：接收对http://localhost:8080/Design_Time_Addresses/Service_Beta1/Service](http://localhost:8080/Design_Time_Addresses/Service_Beta1/Service)的 HTTP 响应时发生错误。这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于服务器中止了 HTTP 请求上下文（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。---> System.Net.WebException：底层连接已关闭：接收时发生意外错误。

在那之后还有许多其他例外，我会让你免于阅读这些。

如果我关闭服务器和客户端并重新启动两者，我的所有调用都可以正常工作，直到我在 Visual Studio 中进行剧烈的“停止”。如何强制服务器清理不正确关闭的连接？我知道在生产中“停止”按钮消失了，理论上不应该有问题，但我不想因为客户端崩溃或断开连接而出现服务器连接问题。因为不可避免地会有这些情况。最好在有 20 多个客户端尝试连接并获取异常之前解决此问题。

谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2009-01-23T22:54:26.440

很抱歉花了这么长时间才回复。我的问题是我将数据表传回给客户端，但在创建时没有给表命名。见下文。

```
Dim dt As New DataTable() 'Passing just a blank un-named table to client gave errors.
Dim dt As New DataTable("Table") 'Naming the table like so passes just fine. 
```

# python - 为什么 fuse 不使用 file_class 中提供的类

> ID：300047
> 
> 赞同：1
> 
> 时间：2008-11-18T20:35:12.357
> 
> 标签：python, fuse

我有一个基于 fuse 文档中的 Xmp 示例的 python fuse 项目。我已经包含了一小段代码来展示它是如何工作的。出于某种原因，get_file 确实被调用并创建了类，但不是从 get_file (file_class) 熔丝调用 .read() 类，而是继续调用 Dstorage.read() ，这违背了将读取函数移出的目的班级。

```
class Dstorage(Fuse, Distributor):
    def get_file(self, server, path, flags, *mode):
        pass
        # This does some work and passes back an instance of
        # a class very similar to XmpFile

    def main(self, *a, **kw):
        self.file_class = self.get_file
        return Fuse.main(self, *a, **kw) 
```

我的代码托管在启动板上，您可以使用此命令下载它。
~~bzr co [https://code.launchpad.net/~asa-ayers/+junk/dstorage](https://code.launchpad.net/~asa-ayers/+junk/dstorage)~~
bzr 分支 lp:~asa-ayers/dstorage/trunk

**解决方案：**
我使用了一个代理类，它继承了我需要的类，在构造函数中我得到了我需要的类的实例并覆盖了所有代理的方法以简单地调用实例方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T10:10:28.433

查看 Fuse 类的代码（这是一个创建方法代理的曲折小段落的迷宫），我看到了这一点（这是一个用于在内部创建 setter 的闭包`Fuse.MethodProxy._add_class_type`，第 865 行）：

```
 def setter(self, xcls):

            setattr(self, type + '_class', xcls)

            for m in inits:
                self.mdic[m] = xcls

            for m in proxied:
                if hasattr(xcls, m):
                    self.mdic[m] = self.proxyclass(m) 
```

当你这样做时`self.file_class = self.get_file`，它会被调用`self.get_file`，这是一个绑定方法。代理属性的循环期望能够从您设置的类中获取属性，`mdic`在包装它们后将它们放入其代理字典中，但它们不存在，因为它是一个绑定方法，而不是一个类。由于找不到它们，它会恢复为调用它们 on `Dstorage`。

所以，长话短说，你不能在这里使用返回实例（一种伪类）而不是类的可调用对象，因为 Fuse 正在内省你设置的对象以找到它应该调用的方法。

您需要分配一个类`file_class`- 如果您需要引用父实例，您可以使用它们在文档中显示的嵌套类技巧。

# iphone - 为什么 Xcode 不断更改其活动的可执行文件？

> ID：300048
> 
> 赞同：0
> 
> 时间：2008-11-18T20:35:22.543
> 
> 标签：iphone, cocoa-touch, xcode, build-process, ios-simulator

Xcode 和我正在开发的 iPhone 项目发生了一些非常奇怪的事情，当我为模拟器构建时，该项目有 2 个活动的可执行文件（MyApp - iPhone Simulator (2.0) 和 MyApp - iPhone Simulator (2.1)）几乎所有时间，我都想使用 2.1 的活动可执行文件，但 Xcode 偶尔会默默地更改为 2.0 的。

这似乎没有任何模式或我能注意到的任何触发器。谷歌搜索发现有几个人有同样的问题，但没有解决方案。

帮我stackoverflow-kenobi！你是我唯一的希望！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T12:49:50.250

好的，这是一个错误。好消息：它已在全新的 2.2 SDK 中得到修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T23:39:59.720

这*很*奇怪——我从事 iPhone/XCode 开发已经有一段时间了，从来没有见过这样的事情。

你绝对确定你没有在导致变化的地方闲逛吗？

您可能有损坏的 XCode 或 .xcodeproj？如果它仍然存在，我会尝试重新创建我的项目，如果没有帮助，请重新安装 XCode。

很奇怪，确实……！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T23:59:18.963

我也有同样的问题。我需要将活动的可执行文件设置为 2.1 才能使 openAL 正常工作。我观察到的模式是每次我切换到导出到设备时它都会切换回来。这不是发生在你身上吗？

我已经在官方 iphone 开发论坛上看到过多次评论该问题，但没有解决方案。看起来像一个错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-18T23:14:12.597

所以..你为什么要这么做？考虑到 iPhone 的性质（具有多种架构的多种框架），为您的各种项目设置不同的目标可能会更好。生成的可执行文件将是目标构建阶段的结果。

# javascript - ASP.NET 阿贾克斯

> ID：300052
> 
> 赞同：2
> 
> 时间：2008-11-18T20:36:06.410
> 
> 标签：javascript, asp.net-ajax

我有一个具有以下原型的自定义控件。

```
Type.registerNamespace('Demo');

Demo.CustomTextBox = function(element) {
    Demo.CustomTextBox.initializeBase(this, [element]);
}

Demo.CustomTextBox.prototype = {

    initialize: function() {
    Demo.CustomTextBox.callBaseMethod(this, 'initialize');

        this._onblurHandler = Function.createDelegate(this, this._onBlur);

        $addHandlers(this.get_element(),
                     {
                         'blur': this._onBlur
                     },
                     this);
    },

    dispose: function() {
        $clearHandlers(this.get_element());

        Demo.CustomTextBox.callBaseMethod(this, 'dispose');
    },

    _onBlur: function(e) {
        if (this.get_element() && !this.get_element().disabled) {
            alert(this.get_element().value);
        }
    }
}

Demo.CustomTextBox.registerClass('Demo.CustomTextBox', Sys.UI.Control);

if (typeof (Sys) !== 'undefined') Sys.Application.notifyScriptLoaded(); 
```

如何在 _onBlur 方法中向服务器发起回发事件？

干杯

罗汉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T21:14:09.873

您可以使用 __doPostBack 方法来执行此操作，该方法具有以下签名：

```
function __doPostBack(eventTarget, eventArgument) 
```

所以它会是这样的：

```
__doPostBack(this.get_element().id, 0); 
```

或者，如果需要，您可以选择将参数与事件一起传递。

# java - 将 Double 转换为 Int - Java vs .Net 时的不同答案

> ID：300055
> 
> 赞同：4
> 
> 时间：2008-11-18T20:37:58.653
> 
> 标签：java, .net, rounding

在 C# 中，如果我想将 double (1.71472) 转换为 int，那么我会得到答案 2。如果我在 Java 中使用 intValue() 方法执行此操作，我会得到 1 作为答案。

Java 是否对转换进行舍入？

为什么 Java API 文档没有关于他们的类的信息，即

> 以 int 形式返回指定数字的值。这可能涉及舍入或截断。

有关四舍五入的更多信息会有所帮助！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-18T20:43:19.983

当从浮点类型缩小到整数类型时，Java 会向零舍入——当您使用强制转换时，C# 也是如此。就是`Convert.ToInt32`这样循环：

```
double d = 1.71472;
int x = (int) d; // x = 1
int y = Convert.ToInt32(d); // y = 2 
```

可以在[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html)中找到详细信息。请注意，虽然中引用的文档`Number`为子类保留了选项，但关于具体装箱类型的文档，如[`Double`，](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Double.html)对实现是明确的：

> 将此 Double 的值作为 int 返回（通过强制转换为 int 类型）。

使用 时[`BigDecimal`](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)，您可以指定八种不同的舍入策略之一。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-18T20:40:14.827

当从浮点类型缩小到整数类型时，Java 会向零舍入。

[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html)中有更多关于一般规则的文档。请注意，虽然中的文档`Number`为子类保留了选项，但有关具体装箱类型的文档更加明确：

> 将此 Double 的值作为 int 返回（通过强制转换为 int 类型）。

使用[BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)时，您可以指定八种不同的舍入策略之一。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T22:37:47.333

Jon Skeet 是正确的，但其他需要注意的是 .NET 使用[Banker's Rounding](http://blogs.msdn.com/ericlippert/archive/2003/09/26/bankers-rounding.aspx)作为其舍入算法。当您在舍入到偶数整数之间时。

# windows - Windows 64 位上的 adodb 驱动程序解决方法

> ID：300076
> 
> 赞同：1
> 
> 时间：2008-11-18T20:45:12.710
> 
> 标签：windows, 64-bit

我必须支持使用访问数据库的应用程序。我的开发机器正在运行 Windows XP 64 位，这很好，除了 Windowx XP 64 没有安装 adodb 驱动程序，所以每当我编写脚本来更新访问数据库时，我必须将数据库和脚本移动到 32 位机器，RDP，然后运行脚本并将所有内容复制回来。这很麻烦，我不敢相信没有更好的方法。

有没有更好的方法，或者这是微软没有那么温和的方式告诉我将每个人都转移到 SQL Server Express（我可能早就应该这样做了）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T20:47:00.053

您用什么语言编写脚本？如果它们只是 vbscript/jscript，那么您可以使用 32 位脚本解释器运行它们。

从命令提示符：

```
\windows\syswow64\wscript scriptfile
\windows\syswow64\cscript scriptfile 
```

这将使他们能够加载 32 位进程内 COM 对象，例如您的数据库驱动程序。

# algorithm - 列表排名算法

> ID：300077
> 
> 赞同：2
> 
> 时间：2008-11-18T20:45:29.043
> 
> 标签：algorithm, sorting, ranking

给定一个数字列表，可以按任何顺序排列，例如

```
3, -5, -1, 2, 7, 12, -8 
```

我想制作一个代表他们排名的列表，在这种情况下是

```
4, 1, 2, 3, 5, 6, 0 
```

这些数字实际上是有序列表中的某个成员。请注意，列表的顺序不会改变，它们只是根据他们的排名来计算。

（这些数字代表 z 顺序，但可能还有其他用途）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T20:45:44.737

这是我的解决方案，尚未经过测试：

```
// this will be our storage of the new z-order
int *tmpZ = new int[GetCount()];

int currentZ = INT_MIN;
int smallestIdx = -1;
int newZ = 0;
for (int passes = 0; passes < GetCount(); passes++)
{
    int smallestZ = INT_MAX;
    // find the index of the next smallest item
    for (int i = 0; i < GetCount(); i++)
    {
        if (GetAt(i)->m_zOrder > currentZ && GetAt(i) < smallestZ)
        {
            smallestIdx = i;
            smallestZ = GetAt(i)->m_zOrder;
        }
    }
    tmpZ[smallestIdx] = newZ;

    // prepare for the next item
    currentZ = smallestZ;
    newZ++;
    smallestIdx = -1;
}

// push the new z-order into the array
for (int i = 0; i < GetCount(); i++)
    GetAt(i)->m_zOrder = tmpZ[i]; 
```

如您所见，它是 O(n^2).... :(

# javascript - jQuery UI 选项卡 - 如何获取当前选定的选项卡索引

> ID：300078
> 
> 赞同：112
> 
> 时间：2008-11-18T20:45:35.377
> 
> 标签：javascript, jquery, jquery-ui, tabs, jquery-ui-tabs

我知道之前有人[问过](https://stackoverflow.com/questions/185235/jquery-tabs-getting-newly-selected-index)这个特定问题，但我没有使用插件`bind()`上的事件得到任何结果。`jQuery UI Tabs`

我只需要`index`新选择的选项卡在单击选项卡时执行操作。`bind()`允许我挂钩到 select 事件，但我获取当前选定选项卡的常用方法不起作用。它返回先前选择的选项卡索引，而不是新的：

```
var selectedTab = $("#TabList").tabs().data("selected.tabs"); 
```

这是我试图用来获取当前选定选项卡的代码：

```
$("#TabList").bind("tabsselect", function(event, ui) {

}); 
```

**当我使用这段代码时，ui 对象又回来了`undefined`**。从文档来看，这应该是我用来使用 ui.tab 挂钩到新选择的索引的对象。我已经在初次`tabs()`通话时尝试过，也单独尝试过。我在这里做错了吗？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2009-08-26T14:52:44.617

如果您需要从选项卡事件的上下文之外获取选项卡索引，请使用以下命令：

```
function getSelectedTabIndex() { 
    return $("#TabList").tabs('option', 'selected');
} 
```

更新：从版本 1.9 'selected' 更改为 'active'

```
$("#TabList").tabs('option', 'active') 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2008-11-18T21:39:33.723

**对于 1.9 之前的 JQuery UI 版本**：`ui.index`from the`event`是你想要的。

**对于 JQuery UI 1.9 或更高版本**：请参阅下面 Giorgio Luparia 的[回答](https://stackoverflow.com/a/12973370/2333214)。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2011-11-01T14:25:50.947

> **更新**[ [Sun 08/26/2012] ] 这个答案已经变得如此受欢迎，以至于我决定将其变成一个成熟的博客/教程
> 请访问[我的博客在这里](http://spyk3lc.blogspot.com/2012/08/jqueryjqueryui-help-tabs-get-currently.html)查看最新的轻松访问信息以使用jQueryUI 中的*选项卡*
> 还包括（也在博客中）是一个[jsFiddle](http://jsfiddle.net/SpYk3/vAggn/)

* * *

更新！请注意：在较新版本的 jQueryUI (1.9+) 中，`ui-tabs-selected`已替换为`ui-tabs-active`. ！！！

* * *

*~~我知道这个线程很旧，但~~*我没有看到提到的是如何从“选项卡事件”以外的其他地方获取“选定选项卡”（当前下拉面板）。我有一个简单的方法...

```
var curTab = $('.ui-tabs-panel:not(.ui-tabs-hide)'); 
```

而要轻松获取索引，当然有网站上列出的方式...

```
var $tabs = $('#example').tabs();
var selected = $tabs.tabs('option', 'selected'); // => 0 
```

但是，您可以使用我的第一种方法来轻松获取索引以及您想要的有关该面板的任何内容...

```
var curTab = $('.ui-tabs-panel:not(.ui-tabs-hide)'),
    curTabIndex = curTab.index(),
    curTabID = curTab.prop("id"),
    curTabCls = curTab.attr("class");
        //  etc .... 
```

PS。如果您使用 iframe 变量然后 .find('.ui-tabs-panel:not(.ui-tabs-hide)')，您会发现对框架中的选定选项卡执行此操作也很容易。请记住，jQuery 已经完成了所有艰苦的工作，无需重新发明轮子！

> 只是为了扩展（更新）

有人向我提出了一个问题，“如果视图上有多个选项卡区域怎么办？” 再一次，简单的想，使用我相同的设置，但使用一个 ID 来识别你想要掌握的标签。

例如，如果您有：

```
$('#example-1').tabs();
$('#example-2').tabs(); 
```

并且您想要第二个选项卡集的当前面板：

```
var curTabPanel = $('#example-2 .ui-tabs-panel:not(.ui-tabs-hide)'); 
```

如果你想要 ACTUAL 选项卡而不是面板（真的很简单，这就是为什么我之前没有提到它，但我想我现在会提到它，只是为了彻底）

```
// for page with only one set of tabs
var curTab = $('.ui-tabs-selected'); // '.ui-tabs-active' in jQuery 1.9+

// for page with multiple sets of tabs
var curTab2 = $('#example-2 .ui-tabs-selected'); // '.ui-tabs-active' in jQuery 1.9+ 
```

再一次，记住，jQuery 做了所有的努力，不要想得那么难。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2012-10-19T11:32:32.793

如果您使用的是 1.9.0 或更高版本的 JQuery UI，您可以在您的函数中访问**ui.newTab.index()**并获取您需要的内容。

对于早期版本，请使用**ui.index**。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-03-12T13:31:01.537

```
var $tabs = $('#tabs-menu').tabs();
// jquery ui 1.8
var selected = $tabs.tabs('option', 'selected');
// jquery ui 1.9+
var active = $tabs.tabs('option', 'active'); 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-11-19T02:29:36.180

您何时尝试访问 ui 对象？如果您尝试在绑定事件之外访问它，ui 将是未定义的。另外，如果这条线

```
var selectedTab = $("#TabList").tabs().data("selected.tabs"); 
```

在这样的事件中运行：

```
$("#TabList").bind("tabsselect", function(event, ui) {
  var selectedTab = $("#TabList").tabs().data("selected.tabs");
}); 
```

selectedTab 将等于该时间点的当前选项卡（“前一个”选项卡）。这是因为在单击的选项卡变为当前选项卡之前调用了“tabsselect”事件。如果您仍想以这种方式执行此操作，则使用“tabsshow”将导致 selectedTab 等于单击的选项卡。

但是，如果您想要的只是索引，这似乎过于复杂。事件内部的 ui.index 或事件外部的 $("#TabList").tabs().data("selected.tabs") 应该是您所需要的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-02-08T18:35:00.483

这在 1.9 版中有所改变

就像是

```
 $(document).ready(function () {
            $('#tabs').tabs({
                activate: function (event, ui) {
                    var act = $("#tabs").tabs("option", "active");
                    $("#<%= hidLastTab.ClientID %>").val(act);
                    //console.log($(ui.newTab));
                    //console.log($(ui.oldTab));
                }
            });

            if ($("#<%= hidLastTab.ClientID %>").val() != "") 
            {
                $("#tabs").tabs("option", "active", $("#<%= hidLastTab.ClientID %>").val());
            }

        }); 
```

应该使用。这对我来说很好;-)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-04-20T18:48:03.133

如果有人试图从 iframe 中访问选项卡，您可能会注意到这是不可能的。选项卡`div`的 永远不会被标记为已选中，就像隐藏或未隐藏一样。链接本身是唯一标记为选中的部分。

```
<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-focus"><a href="#tabs-4">Tab 5</a></li> 
```

以下将为您`href`提供链接的值，该值应与选项卡容器的 id 相同：

```
jQuery('.ui-tabs-selected a',window.parent.document).attr('href') 
```

这也应该代替：`$tabs.tabs('option', 'selected');`

从某种意义上说，最好不要只获取选项卡的索引，而是为您提供选项卡的实际 ID。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-04-03T13:39:00.660

最简单的方法是

```
$("#tabs div[aria-hidden='false']"); 
```

和索引

```
$("#tabs div[aria-hidden='false']").index(); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-07-11T17:53:00.973

如果您找到活动选项卡索引，然后指向活动选项卡

首先获取Active索引

```
var activeIndex = $("#panel").tabs('option', 'active'); 
```

然后使用css类获取tab内容面板

```
// this will return the html element
var element=   $("#panel").find( ".ui-tabs-panel" )[activeIndex]; 
```

现在将其包装在 jQuery 对象中以进一步使用它

```
 var tabContent$ = $(element); 
```

在这里，我想添加两个信息，该类`.ui-tabs-nav`用于与导航关联的导航，并`.ui-tabs-panel`与选项卡内容面板关联。在 jquery ui 网站中的此链接演示中，您将看到使用了此类 - [http://jqueryui.com/tabs/#manipulation](http://jqueryui.com/tabs/#manipulation)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-03-21T14:20:09.947

```
$( "#tabs" ).tabs( "option", "active" ) 
```

那么您将拥有从 0 开始的选项卡索引

简单的

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-09-09T22:23:41.680

我发现下面的代码可以解决问题。设置新选择的标签索引的变量

```
$("#tabs").tabs({
    activate: function (e, ui) {
        currentTabIndex =ui.newTab.index().toString();
    }
}); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-03-05T16:23:33.417

尝试以下操作：

```
var $tabs = $('#tabs-menu').tabs();

var selected = $tabs.tabs('option', 'selected');

var divAssocAtual = $('#tabs-menu ul li').tabs()[selected].hash; 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-09-29T07:27:26.390

您可以在下一篇文章中发布以下答案

```
var selectedTabIndex= $("#tabs").tabs('option', 'active'); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-10-26T03:29:14.860

获取所选标签索引的另一种方法是：

```
var index = jQuery('#tabs').data('tabs').options.selected; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-04-19T05:22:26.187

```
$("#tabs").tabs({  
    load:  function(event, ui){  
        var anchor = ui.tab.find(".ui-tabs-anchor");  
        var url = anchor.attr('href');  
    }  
}); 
```

在**url**变量中，您将获得当前选项卡的 HREF / URL

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-05-20T13:26:05.450

您可以通过以下方式找到它：

```
$(yourEl).tabs({
    activate: function(event, ui) {
        console.log(ui.newPanel.index());
    }
}); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-12-10T09:12:21.783

取一个隐藏变量，`'<input type="hidden" id="sel_tab" name="sel_tab" value="" />'`并在每个选项卡的 onclick 事件上编写代码，如...

```
<li><a href="#tabs-0" onclick="document.getElementById('sel_tab').value=0;" >TAB -1</a></li>
<li><a href="#tabs-1" onclick="document.getElementById('sel_tab').value=1;" >TAB -2</a></li> 
```

您可以在发布的页面上获取“sel_tab”的值。：） ， 简单的 ！！！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-09-30T00:36:05.127

如果您想确保`ui.newTab.index()`在所有情况下都可用（本地和远程选项卡），请在**激活**函数中调用它，如[文档](http://api.jqueryui.com/tabs/#event-activate)所述：

```
$("#tabs").tabs({
        activate: function(event, ui){
             alert(ui.newTab.index());
             // You can also use this to set another tab, see fiddle...
             // $("#other-tabs").tabs("option", "active", ui.newTab.index());                   
        },
}); 
```

[http://jsfiddle.net/7v7n0v3j/](http://jsfiddle.net/7v7n0v3j/)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-08-05T14:46:34.147

```
$("#tabs").tabs({
    activate: function(event, ui) {
        new_index = ui.newTab.index()+1;
        //do anything
    }
}); 
```

# cocoa - 在 NSTextView 中显示隐藏字符

> ID：300086
> 
> 赞同：7
> 
> 时间：2008-11-18T20:47:32.987
> 
> 标签：cocoa, special-characters, hidden-characters

我正在为 Mac OS X 编写文本编辑器。我需要在 NSTextView 中显示隐藏字符（例如空格、制表符和特殊字符）。我花了很多时间寻找如何做到这一点，但到目前为止我还没有找到答案。如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-04-16T16:51:01.863

这是一个完整的工作和干净的实现

```
@interface GILayoutManager : NSLayoutManager
@end

@implementation GILayoutManager

- (void)drawGlyphsForGlyphRange:(NSRange)range atPoint:(NSPoint)point {
  NSTextStorage* storage = self.textStorage;
  NSString* string = storage.string;
  for (NSUInteger glyphIndex = range.location; glyphIndex < range.location + range.length; glyphIndex++) {
    NSUInteger characterIndex = [self characterIndexForGlyphAtIndex: glyphIndex];
    switch ([string characterAtIndex:characterIndex]) {

      case ' ': {
        NSFont* font = [storage attribute:NSFontAttributeName atIndex:characterIndex effectiveRange:NULL];
        [self replaceGlyphAtIndex:glyphIndex withGlyph:[font glyphWithName:@"periodcentered"]];
        break;
      }

      case '\n': {
        NSFont* font = [storage attribute:NSFontAttributeName atIndex:characterIndex effectiveRange:NULL];
        [self replaceGlyphAtIndex:glyphIndex withGlyph:[font glyphWithName:@"carriagereturn"]];
        break;
      }

    }
  }

  [super drawGlyphsForGlyphRange:range atPoint:point];
}

@end 
```

要安装，请使用：

```
[myTextView.textContainer replaceLayoutManager:[[GILayoutManager alloc] init]]; 
```

要查找字体字形名称，您必须转到 CoreGraphics：

```
CGFontRef font = CGFontCreateWithFontName(CFSTR("Menlo-Regular"));
for (size_t i = 0; i < CGFontGetNumberOfGlyphs(font); ++i) {
  printf("%s\n", [CFBridgingRelease(CGFontCopyGlyphNameForGlyph(font, i)) UTF8String]);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T21:07:24.350

看看 NSLayoutManager 类。您的 NSTextView 将有一个与之关联的布局管理器，并且布局管理器负责将字符（空格、制表符等）与字形（在屏幕上绘制的该字符的图像）相关联。

在您的情况下，您可能对该`[replaceGlyphAtIndex:withGlyph:](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSLayoutManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSLayoutManager/replaceGlyphAtIndex:withGlyph:)`方法最感兴趣，它允许您替换单个字形。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T06:00:54.907

几年前我写了一个文本编辑器——这里有一些毫无意义的代码应该让你（希望）找到正确的方向（顺便说一句，这是一个 NSLayoutManager 子类——是的，我知道它像众所周知的厨房水槽一样泄漏）：

```
- (void)drawGlyphsForGlyphRange:(NSRange)glyphRange atPoint:(NSPoint)containerOrigin
{
    if ([[[[MJDocumentController sharedDocumentController] currentDocument] editor] showInvisibles])
    {
        //init glyphs
        unichar crlf = 0x00B6; 
        NSString *CRLF = [[NSString alloc] initWithCharacters:&crlf length:1];
        unichar space = 0x00B7;
        NSString *SPACE = [[NSString alloc] initWithCharacters:&space length:1];
        unichar tab = 0x2192; 
        NSString *TAB = [[NSString alloc] initWithCharacters:&tab length:1];

        NSString *docContents = [[self textStorage] string];
        NSString *glyph;
        NSPoint glyphPoint;
        NSRect glyphRect;
        NSDictionary *attr = [[NSDictionary alloc] initWithObjectsAndKeys:[NSUnarchiver unarchiveObjectWithData:[[NSUserDefaults standardUserDefaults] objectForKey:@"invisiblesColor"]], NSForegroundColorAttributeName, nil];

        //loop thru current range, drawing glyphs
        int i;
        for (i = glyphRange.location; i < NSMaxRange(glyphRange); i++)
        {
            glyph = @"";

            //look for special chars
            switch ([docContents characterAtIndex:i])
            {
                //space
                case ' ':
                    glyph = SPACE;
                    break;

                //tab
                case '\t':
                    glyph = TAB;
                    break;

                //eol
                case 0x2028:
                case 0x2029:
                case '\n':
                case '\r':
                    glyph = CRLF;
                    break;

                //do nothing
                default:
                    glyph = @"";
                    break;                  
            }

            //should we draw?
            if ([glyph length])
            {
                glyphPoint = [self locationForGlyphAtIndex:i];
                glyphRect = [self lineFragmentRectForGlyphAtIndex:i effectiveRange:NULL];
                glyphPoint.x += glyphRect.origin.x;
                glyphPoint.y = glyphRect.origin.y;
                [glyph drawAtPoint:glyphPoint withAttributes:attr];
            }
        }
    }

    [super drawGlyphsForGlyphRange:glyphRange atPoint:containerOrigin];
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T06:31:43.087

我解决了NSGlyphs和NSTextView中对应的unichar之间转换的问题。下面的代码运行良好，并用项目符号替换可见文本的空格：

```
- (void)drawGlyphsForGlyphRange:(NSRange)range atPoint:(NSPoint)origin
{
    NSFont *font = [[CURRENT_TEXT_VIEW typingAttributes]
                       objectForKey:NSFontAttributeName];

    NSGlyph bullet = [font glyphWithName:@"bullet"];

    for (int i = range.location; i != range.location + range.length; i++)
    {
        unsigned charIndex = [self characterIndexForGlyphAtIndex:i];

        unichar c =[[[self textStorage] string] characterAtIndex:charIndex];

        if (c == ' ')
            [self replaceGlyphAtIndex:charIndex withGlyph:bullet];
    }

    [super drawGlyphsForGlyphRange:range atPoint:origin];
}
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T03:53:29.253

也许 -[NSLayoutManager setShowsControlCharacters:] 和/或 -[NSLayoutManager setShowsInvisibleCharacters:] 会做你想做的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-24T11:01:14.527

这是 Pol 在 Swift 中的解决方案：

```
class MyLayoutManager: NSLayoutManager {
    override func drawGlyphsForGlyphRange(glyphsToShow: NSRange, atPoint origin: NSPoint) {
        if let storage = self.textStorage {
            let s = storage.string
            let startIndex = s.startIndex
            for var glyphIndex = glyphsToShow.location; glyphIndex < glyphsToShow.location + glyphsToShow.length; glyphIndex++ {
                let characterIndex = self.characterIndexForGlyphAtIndex(glyphIndex)
                let ch = s[startIndex.advancedBy(characterIndex)]
                switch ch {
                case " ":
                    let attrs = storage.attributesAtIndex(characterIndex, effectiveRange: nil)
                    if let font = attrs[NSFontAttributeName] {
                        let g = font.glyphWithName("periodcentered")
                        self.replaceGlyphAtIndex(glyphIndex, withGlyph: g)
                    }
                case "\n":
                    let attrs = storage.attributesAtIndex(characterIndex, effectiveRange: nil)
                    if let font = attrs[NSFontAttributeName] {
//                        let g = font.glyphWithName("carriagereturn")
                        let g = font.glyphWithName("paragraph")
                        self.replaceGlyphAtIndex(glyphIndex, withGlyph: g)
                    }
                case "\t":
                    let attrs = storage.attributesAtIndex(characterIndex, effectiveRange: nil)
                    if let font = attrs[NSFontAttributeName] {
                        let g = font.glyphWithName("arrowdblright")
                        self.replaceGlyphAtIndex(glyphIndex, withGlyph: g)
                    }
                default:
                    break
                }
            }
        }
        super.drawGlyphsForGlyphRange(glyphsToShow, atPoint: origin)
    }
} 
```

并列出字形名称：

```
 func listFonts() {
        let font = CGFontCreateWithFontName("Menlo-Regular")
        for var i:UInt16 = 0; i < UInt16(CGFontGetNumberOfGlyphs(font)); i++ {
            if let name = CGFontCopyGlyphNameForGlyph(font, i) {
                print("name: \(name) at index \(i)")
            }
        }
    } 
```

# .net - 在 Silverlight2 中剪裁形状

> ID：300088
> 
> 赞同：5
> 
> 时间：2008-11-18T20:47:57.150
> 
> 标签：.net, silverlight-2.0

我正在编写一个简单的应用程序`SilverLight2`，它需要在画布元素内绘制一个椭圆 - 椭圆的位置、高度和宽度是在运行时计算的。

我需要修复的是椭圆的剪裁。如果它变大，它会部分绘制在画布之外，在其他 UI 元素之上。我希望画布的边界框也是椭圆的边界框。

我用 Clip 属性和矩形几何体进行了几次尝试，但没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-30T08:58:37.570

在 Silverlight 2 中，并非所有 UI 元素都支持剪辑，但只有其中的一些元素：

*   文本框
*   堆栈面板
*   弹出
*   密码箱
*   边界

[https://msdn.microsoft.com/en-us/library/bb979930(v=vs.95).aspx](https://msdn.microsoft.com/en-us/library/bb979930(v=vs.95).aspx)

# c# - 如何在 C# 中找到包含给定分区的磁盘？

> ID：300089
> 
> 赞同：1
> 
> 时间：2008-11-18T20:48:28.023
> 
> 标签：c#, filesystems, disk

有谁知道以编程方式找出哪个物理磁盘包含给定分区的方法？手动，我可以使用 Start->Run->diskmgmt.msc 找到此信息，在那里我可以看到（在我的计算机上）分区 C: 和 D: 在磁盘 1 上，E: & F: 在磁盘 0 上。

如果文件位于不同的物理磁盘上，这是为了通过并行执行某些文件处理操作来优化它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T21:06:25.227

[您可以通过查询Win32_DiskDrive](http://msdn.microsoft.com/en-us/library/aa394132(VS.85).aspx)类使用 WMI 从 System.Management 命名空间获取此信息。

[这是](http://msdn.microsoft.com/en-us/library/ms257340(VS.80).aspx).NET 中有关 WMI 的基本信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T21:46:05.957

除了 Arul 的回答之外，这里还有一个链接，它显示了如何从 VBS 脚本中使用 WMI 获取磁盘<->分区关联：[WMI 任务：磁盘和文件系统](http://msdn.microsoft.com/en-us/library/aa394592.aspx) -> 请参阅页面上的最后一个示例。

编辑：更好的是，[这是一篇关于使用 C# 的 WMI 的好文章](http://www.c-sharpcorner.com/UploadFile/klaus_salchner@hotmail.com/WMIPart211162005021718AM/WMIPart2.aspx)，它恰好也描述了获取`\\\\.\\PHYSICALDRIVE0`包含逻辑磁盘的磁盘驱动器（例如）所需的 WMI 类之间的确切关系（例如`C:`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T18:22:36.160

请参阅 HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices

```
wmic path CIM_BasedOn get * > wmic-path-CIM_BasedOn-get.txt
wmic path CIM_DiskPartition get * > wmic-path-CIM_DiskPartition-get.txt
wmic path CIM_StorageExtent get * > wmic-path-CIM_StorageExtent-get.txt 
```

请参阅类：CIM_BasedOn - 非枚举隐藏分区、CIM_DiskPartition -all，但看不到磁盘标签、CIM_StorageExtent - GUID、标签、分区（也隐藏）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T21:20:25.133

您确定该分区仅与一个磁盘关联吗？它可以跨多个物理磁盘进行条带化/跨越/等。

# c++ - 源文件的首选命名空间语法

> ID：300091
> 
> 赞同：2
> 
> 时间：2008-11-18T20:48:49.927
> 
> 标签：c++, namespaces

假设在名为`Bar`的命名空间中调用了一个类`foo`，您更喜欢源 (.cpp/.cc) 文件的哪种语法？

```
namespace foo {
...
void Bar::SomeMethod()
{
    ...
}

} // foo 
```

或者

```
void foo::Bar::SomeMethod()
{
    ...
} 
```

我大量使用命名空间并且更喜欢第一种语法，但是当使用 Visual Studio 类向导（WM_COMMAND 处理程序等）添加代码时，自动生成的代码使用第二种语法。一种语法比另一种语法有什么优势吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T20:55:11.877

我会拒绝第一个（*编辑*：问题改变了，第一个也是我现在更喜欢的）。由于仅从函数定义来看，尚不清楚 Bar 指的是哪里。此外，使用您的~~第~~一种方法，可能会出现滑溜的错误：

```
namespace bar { 
     struct foo { void f(); };
}

namespace baz { 
    struct foo { void f(); };
}

using namespace bar;
using namespace baz;

void foo::f() { // which foo??

} 
```

因为它在当前范围内查找（那里是全局范围），所以它找到了两个 foo，并告诉您对它的引用是不明确的。

我个人会这样做：

```
namespace foo {
void Bar::SomeMethod() {
    // something in here
}
} 
```

仅查看 SomeMethod 的定义也不清楚它属于哪个名称空间，但是您有一个名称空间范围围绕它，您可以轻松查找它。此外，现在很清楚 Bar 指的是命名空间 foo。

你展示的第二种方式实际上对我来说打字太多了。此外，第二种方式可能会在您的代码的新读者中引起混淆： foo 是类，而 Bar 是它的嵌套类吗？还是 foo 是命名空间而 Bar 是类？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T20:55:48.540

我更喜欢未列出的选项：

```
namespace foo {

void Bar::SomeMethod()
{
    ...
}

}  // foo namespace 
```

与选项一不同，这使您的代码明显属于 foo 命名空间，而不仅仅是使用它。与选项二不同，它节省了大量的打字。双赢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T22:25:20.870

我宁愿选择第一种情况，其中明确标记了命名空间：

```
namespace TheNamespace {
void TheClass::TheMethod() {
   // code
}
} 
```

原因是从该语法中可以清楚地看出 TheClass 是一个类，而 TheNamespace 是一个命名空间（任何其他名称都不那么明显）。如果代码是

```
void TheNamespace::TheClass::TheMethod() {
   // code
} 
```

那么读者并不清楚 TheNamespace 是一个命名空间，还是一个内部类名为 TheClass 的类。

```
class TheClass1
{
   class TheClass2
   {
      void TheMethod();
   }
};

void TheClass1::TheClass2::TheMethod() {
   // code
} 
```

我倾向于避免使用“using”语句，即使这样，litb 的示例在两个不同的命名空间中都有两个类会使编译器和程序员都感到困惑，应该避免。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T20:54:55.280

我认为这取决于每种情况。如果它是与您自己的代码类似的第 3 方库，并且您希望避免代码混淆，那么在每次出现时指定完整的命名空间可能是有益的。但除此之外，更少的代码通常更好（除非变得不清楚）。

# asp.net - 在 Global.Application_Error 中访问 SessionState

> ID：300093
> 
> 赞同：1
> 
> 时间：2008-11-18T20:49:11.297
> 
> 标签：asp.net, session-state, global-asax

在 Global.asax 的 Application_Error 方法中，我试图从会话状态中检索一个值。

只要我抛出异常，我就可以访问会话状态。例如：

```
thow new Exception("Test exception"); 
```

但是，如果它是未处理的异常，我在尝试访问会话状态时会收到以下错误：“会话状态在此上下文中不可用。”。

为什么行为上的差异，有解决办法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T18:59:23.437

我有时讨厌 ASP.NET...

因此使用以下方法生成错误：

```
Response.Redirect("thispagedoesnotexist.aspx", false); 
```

上面的行将重定向到 Application_Error with session state not available

然而

```
throw new Exception("test"); 
```

上面的行将重定向到 Application_Error 会话状态 AVAILABLE

因此，与其在 Application_Error 中做这一切，我将不得不在我的代码中使用 try/catch 来捕获错误。然后从会话、日志和电子邮件错误详细信息中收集数据，最后重定向到友好的错误页面。很多额外的代码..

结论：Application_Error 毫无价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T04:10:27.053

我认为您正在尝试通过 HttpContext.Current.Session 访问会话。我相信行为上的区别在于，在未处理的异常处理程序中，请求已进入“故障安全”模式，并且页面生命周期（包括加载和处理会话）已经完成。

查看[生命周期](http://msdn.microsoft.com/en-us/library/ms178473.aspx)上的此页面以获取更多信息

# ffmpeg - 理解和使用 ffmpeg 设置

> ID：300095
> 
> 赞同：8
> 
> 时间：2008-11-18T20:49:51.827
> 
> 标签：ffmpeg

ffmpeg 和 libavcodec 的最佳文档在哪里？

似乎 ffmpeg 支持许多未记录的选项，很难找到一个好的参考。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-01T11:53:36.740

*   ffmpeg 格式
*   ffmpeg -帮助
*   ffmpeg.org/documentation.html 和
*   源代码作为最后的手段。

不幸的是，这并不容易弄清楚。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-20T16:16:12.190

可能非常有用的事情之一：

```
ffmpeg -formats 
```

列出了所有可以使用的编解码器和容器......我还没有找到任何其他可以找到这些的好地方，可能是因为它们取决于你的 ffmpeg 副本是用什么库构建的。这个页面（[http://ffmpeg.mplayerhq.hu/general.html](http://ffmpeg.mplayerhq.hu/general.html)）有一些，但不告诉你在命令行输入什么。

此外，howto-pages.org 在这里有一个不错的教程：http: [//howto-pages.org/ffmpeg/](http://howto-pages.org/ffmpeg/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-05T16:32:57.263

`ffmpeg --help`

`ffmpeg -formats`

`ffmpeg -codecs`

`ffmpeg -`

如果您使用 Linux，请尝试 `man ffmpeg`

`ffmpeg -decoders`

`ffmpeg -encoders`

`ffmpeg -protocols`

`ffmpeg -filters`

当然，如果你想做某事却想不通，谷歌是你的朋友。FFmpeg 邮件列表中的结果通常很有用，链接到 stackoverflow 和 stackexchange 的结果也是如此。甚至雅虎问答也偶尔给我一个答案。FFmpeg 文档也很不错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-08T13:23:26.173

您还可以将[https://ffmpeg.org/doxygen/trunk/index.html](https://ffmpeg.org/doxygen/trunk/index.html)用于 libav 代码和 api 文档。

# php - 多对多查找

> ID：300104
> 
> 赞同：3
> 
> 时间：2008-11-18T20:53:43.253
> 
> 标签：php, orm, symfony1

我正在申请候补名单。我希望能够向应用程序发送一个唯一的确认码 - 稍后能够通过确认码或用户名找到用户。

Symfony 是否能够调用 Models 说：

```
Code->findUser($code_string);

User->getCode(); 
```

我相信下面的模式有关系，但我不确定这是否是 Symfony 将这些关系联系在一起的方式。

感谢您的时间，

```
 user:
    id:
    last_name: varchar(255)
    first_name: varchar(255)
    email: varchar(255)

  code:
    id:
    secret: varchar(255)

  user_code:
    id:
    user_id:
    code_id:

  course:
    id:
    title: varchar(255)

  quarter:
    id:
    title: varchar(255)

  wait_list:
    id:
    user_id:
    course_id:
    quarter_id: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T17:57:47.163

Symfony 默认使用 Propel，并支持 Doctrine 作为插件。

通过多对多关系查询的示例，其中表通过交集表与表`Bugs`相关：`Products``BugsProducts`

```
[Bugs]  <--  [BugsProducts]  -->  [Products] 
```

**使用 Propel 的解决方案：**

`schema.xml`：

```
 <table name="Bugs">
    <column name="bug_id" type="INTEGER" required="true" 
     primaryKey="true" autoIncrement="true" />
  </table>

  <table name="Products">
    <column name="product_id" type="INTEGER" required="true" 
     primaryKey="true" autoIncrement="true" />
    <column name="product_name" type="VARCHAR" size="50" required="true" />
  </table>

  <table name="BugsProducts">
    <column name="bug_id" type="INTEGER" required="true" primaryKey="true" />
    <column name="product_id" type="INTEGER" required="true" primaryKey="true" />
    <foreign-key foreignTable="Bugs">
      <reference local="bug_id" foreign="bug_id" />
    </foreign-key>
    <foreign-key foreignTable="Products">
      <reference local="product_id" foreign="product_id" />
    </foreign-key>
  </table> 
```

查询示例：查找bug#1234，通过多对多查询获取相关产品，并进行报告。

```
$bug = BugsPeer::retrieveByPK(1234);

$bugProducts = $bug->getBugsproductsJoinProducts();

foreach ($bugProducts as $bp) {
  $product = $bp->getProducts();
  print "bug id #".$bug->getBugId().": product ".$product->getProductName()."\n"
;
} 
```

**使用 Doctrine 的解决方案：**

```
class Bugs extends Doctrine_Record
{
  public function setUp()
  {
    $this->hasMany('Products', array('local'=>'bug_id',
                 'foreign'=>'bug_id',
                 'refClass'=>'BugsProducts'));
  }
}

class Products extends Doctrine_Record
{
  public function setUp()
  {
    $this->hasMany('Bugs', array('local'=>'product_id',
                 'foreign'=>'product_id',
                 'refClass'=>'BugsProducts'));
  }
} 
```

查询示例：查找bug#1234，通过多对多查询获取相关产品，并进行报告。

```
$bugsTable = Doctrine::getTable('Bugs');

$bug = $bugsTable->find(1234);

foreach ($bug->Products as $product) {
  print 'Bug #'.$bug->bug_id.': product '.$product->product_name."\n";
} 
```

# sql - 在 SQL 中的表之间移动行

> ID：300118
> 
> 赞同：5
> 
> 时间：2008-11-18T20:59:26.893
> 
> 标签：sql, partitioning

我有 2 个表，一个活动表和一个非活动表。我想*将*行从活动表移动到非活动表。我的第一个想法是

```
insert into inactive select * from active where ...
delete from active active where ... 
```

但是大约 0.42 秒后，我注意到如果更新改变了 where 子句选择的内容，这将删除/重复行。

在这种情况下，我可以很容易地防止这种情况发生，但如果我不能，我该怎么办？

编辑：从答案看来，没有一种简单/简单的方法可以做到这一点。我对此感到非常惊讶。我认为拥有它会有一些实质性的好处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T21:01:46.297

状态标志是您的朋友。

```
UPDATE old_data SET move="MARKED";
INSERT INTO somewhere... SELECT where move="MARKED";
DELETE FROM old_data WHERE move="MARKED"; 
```

如果您在关闭 Autocommit 的情况下执行此操作，它将在所有地方占用锁。

如果你想少做一点锁定，你可以在每一步之后提交。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T21:03:26.137

（至少在 MS SQL 中）您可以使用事务和锁定提示：

```
begin tran

insert into inactive
select * from active with (updlock)
where ...

delete from active
where ...

commit tran 
```

如果有人确实更改了正在删除的记录，则可能会出现没有锁定提示（updlock）的死锁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T14:38:32.793

您的数据库是否支持 OUTPUT 子句？那么这对您来说可能是一个完美且易于遵循的解决方案，不是吗？

[http://msdn.microsoft.com/en-us/library/ms177564.aspx](http://msdn.microsoft.com/en-us/library/ms177564.aspx)

```
delete active with (readpast)
output DELETED.*
into inactive
where ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T21:04:20.613

如果您可以悲观地锁定行，即在您读取它们以将它们复制到非活动表中时，那么没有人可以将它们从您下面更改出来。

锁定行的方法因数据库品牌而异，您没有在问题中指定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T21:05:08.053

声明一个本地表 var 并将值放入其中，将它们插入到非活动表中，然后从活动表中删除本地列表中的行。

交易的想法也同样有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T21:06:16.473

要么使用唯一的 id 列，如

```
delete from active where rowid in (select rowid in inactive) 
```

或者

```
delete from active as a 
where exists (select * 
              from inactive 
              where pkfld1=a.pkfld1 
              and pkfld2=a.pkfld2) 
```

另外，不要忘记将此过程包装在事务中。

祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T21:14:37.470

这就是我保留 where 子句的方式：

```
DECLARE @MyTable TABLE
(
  TheKey int PRIMARY KEY
)
--
INSERT INTO @MyTable(TheKey)
SELECT TheKey FROM SourceTable WHERE rows I want
--
INSERT INTO Inactive(fieldlist)
SELECT fieldlist
FROM Active
WHERE TheKey IN (SELECT TheKey FROM @MyTable)
--
DELETE
FROM Active
WHERE TheKey IN (SELECT TheKey FROM @MyTable) 
```

如果您需要比这更强大，则需要查看锁定（在事务期间阻止更改）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T21:43:53.543

为什么你有两个表，而不是“IsActive”列？

# mysql - 在 MySQL 中组合查询

> ID：300123
> 
> 赞同：0
> 
> 时间：2008-11-18T21:01:22.567
> 
> 标签：mysql, sql

我知道您可以使用 Join 语句组合多个表选择，但是**有没有办法将这两个查询组合成一个**？

```
SELECT Statistics.StatisticID
FROM Statistics
ORDER BY `SubmittedTime` DESC
LIMIT 0, 10 
```

和这个？

```
SELECT COUNT(Votes.StatisticID)
FROM Votes
WHERE Votes.StatisticID = ? 
```

（去除绒毛）

目前，我已经取得了*几乎*可行的东西。

```
SELECT Statistics.StatisticID, COUNT(Score.StatisticID) AS Votes
FROM `Statistics`
LEFT JOIN `Votes` AS `Score` ON `Statistics`.`StatisticID` = `Score`.`StatisticID`
ORDER BY `SubmittedTime` DESC
LIMIT 0, 10 
```

该`Votes`表是一个简单的 StatID、UserID 连接器。在我的测试用例中，它包含 3 行，其中两行 StatID 5 - 1 和 StatID 2。

例如，如果我添加 WHERE 子句`WHERE StatisticID = 5`并正确返回 2 票，我的查询将起作用。但是，如果我删除 WHERE 子句，我仍然会返回一行并获得 3 票。

是否可以组合这些查询，或者我必须为每个结果运行第二个（显然不是最好的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T21:06:19.780

假设您要统计每个统计信息的投票数

```
SELECT StatisticID, COUNT(*) AS CountVotes
FROM `Votes`
GROUP BY Statistics.StatisticsID 
```

我没有看到必须加入表格的原因。

[编辑] 啊...我看到你想按统计表的提交时间排序。

```
SELECT Votes.StatisticID, COUNT(*) AS CountVotes
FROM `Votes` JOIN Statistics ON votes.statisticsID = Statistics.StatisticsID
GROUP BY Statistics.StatisticsID
ORDER BY Statistics.SubmittedTime 
```

# javascript - 如何在javascript中围绕一段文本包装一个跨度？

> ID：300129
> 
> 赞同：2
> 
> 时间：2008-11-18T21:03:54.013
> 
> 标签：javascript, jquery, dom

我有这样的标记：

```
<p>one two three four</p> 
```

我想使用 javascript 将其转换为：

```
<p>one <span>two three<span> four</p> 
```

我有我想在跨度中换行的部分的偏移量和长度，在这种情况下`offset = 4`和`length = 9`. 如果使用 jQuery 可以使它更容易，那就更可取了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T21:08:43.490

这不是问题**[Highlight a word with jQuery](https://stackoverflow.com/questions/119441)**的小重复吗？

[JQuery 搜索高亮插件](http://www.jquery.info/scripts/SearchHighlight/demo_en.html)之类的东西可能会有所帮助

或者，正如[在同一个问题中指出的那样](https://stackoverflow.com/questions/119441#120289)，编写自己的 jquery 函数：
类似（未经测试的代码，随意编辑）：

```
jQuery.fn.addSpan = function (elName, str, offset, length)
{
    if(this.innerHTML = str)
    {
        return this.each(function ()
        {
            this.innerHTML = this.innerHTML.substring(0,offset) + "<span>" + this.innerHTML.substring(offset, offset+length) + "</span>" + this.innerHTML.substring(offset+length));
        });
    }
}; 
```

你会像这样使用它：

```
$("p").addSpan("one two three four", 4, 9); 
```

# c++ - 如何使用现代 Web 客户端界面保持 C++ 实时服务器应用程序？

> ID：300144
> 
> 赞同：1
> 
> 时间：2008-11-18T21:06:36.800
> 
> 标签：c++, ajax, com

我开发具有强烈实时要求的工业客户端/服务器应用程序 (C++)。我觉得是时候改变客户端界面的外观了——它是在 MFC 中开发的——但我想知道哪个是正确的选择。如果我使用 Web 客户端，除了 AJAX <-> Web 服务 <-> COM 之外，还有什么方法可以在 C++ 和 javascript 之间交换数据？Web 客户端的要求是：快速状态刷新、用户命令、表格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T21:17:57.293

几个月前，我的团队不得不做出同样的决定……

使它成为一个 Web 应用程序的一个很酷的事情是，以后可以*很*容易地对其进行修改。即使是界面的用户（有一点知识）也可以修改它以满足他/她的需要。定制软件变得如此简单。

我们使用了一个 Web 界面，而 ajax 似乎是要走的路，它的响应速度非常快。

另一方面，根据您的实时要求有多强，这可能会很困难。我们遇到了通过浏览器绘制实时数据的挑战，最终我们使用了一个 firefox 插件来绘制绘图。如果您只是想显示实时文本数据，那应该不是什么大问题。

为您的特定应用程序运行一些测试并查看它的外观。

其他需要考虑的事情，如果您将网页作为服务器的接口，请记住，如果您计划允许多个接口连接到您的服务器，则需要想办法在另一个客户端更改服务器状态时更新一个客户端服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-31T15:31:51.310

我通常构建我的应用程序 2-folded ：

1.  仅拥有真正的重型应用程序 CLI。使用的协议通常是纯文本的，由请求和答案组成。
2.  将 GUI 包装为与 CLI 后端*对话*的另一个进程。

然后，Web 界面只是另一个要包装的 GUI。在 CLI 界面上包装基于 REST/JSON 的 API 也容易得多（只是自动翻译消息）。

调试也很容易，因为您可以在 2 个元素之间转储请求并更轻松地重现错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T21:32:25.813

在您的服务器中编写一个 HTTP 服务器来处理 AJAX 反馈。如果您不想提供文件，请在非标准端口（例如 8081）上创建服务器，并使用常规 Web 服务器进行实际网页交付。现在让您的 AJAX 引擎在 Bizarro 端口而不是端口 80 上与服务器通信。

但是编写文件服务器部分也并不难。如果您这样做，您还可以根据需要即时生成预先填充数据的网页。

Google 桌面搜索现在可以做到这一点。当我在桌面上搜索“foobar”时，打开的 URL 是这样的：

> [http://127.0.0.1:4664/search?q=foobar&flags=68&num=10](http://127.0.0.1:4664/search?q=foobar&flags=68&num=10)

在这种情况下，4664 是 Bizarro 端口。（GoogleDesktop 在这里提供所有数据；它只使用 Bizarro 端口以避免与我可能正在运行的任何 Web 服务器发生冲突。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T21:10:56.620

您可能需要考虑数据所在的位置。如果您的应用程序提供后端数据库，您可以编写一个 Web 应用程序，保留您的 C++ 代码 - Web 应用程序将是独立的，并为 Web 用户提供页面并直接与数据库对话 - 在这种情况下，您有正如您所指出的那样，有很多选项，甚至更多。

# visual-studio - Sharepoint 工作流开发（2 部分问题）

> ID：300145
> 
> 赞同：2
> 
> 时间：2008-11-18T21:06:41.200
> 
> 标签：visual-studio, sharepoint, workflow

我正在尝试为我工作的公司开发一些 SharePoint 工作流，但我不太熟悉这项技术的来龙去脉。通常，当我想熟悉某件事时，我只是玩弄它，查看属性，找到所有方法等。

当我启动 Visual Studio 并尝试创建 SharePoint 工作流时，它给了我一个错误，表明我没有对“Microsoft.SharePoint.dll”的引用。有人告诉我，看到这种情况很正常，因为如果你想做工作流，你必须在 SharePoint Server 本身上进行所有的开发。这是真的？

如果是这样，是否有任何人在多开发人员环境中成功开发 SharePoint 工作流，而不诉诸任何“黑客”？感谢您的阅读和您的回复...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T21:13:33.603

如果要使用 Sharepoint 模板创建 Sharepoint 工作流，则需要有运行 Sharepoint 的 Windows 2003 或 2008 Server。本质上，所有 Sharepoint 开发都是如此：要真正高效，您**需要**在 Sharepoint 服务器上运行 Visual Studio。这反过来意味着每个开发人员都需要自己的 Sharepoint 服务器，然后您有一个额外的“暂存”服务器，您可以在其中部署和测试您的组合解决方案。突然间，那个 MSDN 订阅看起来很有吸引力 :-)

至于您的 Workflow 学习问题：我强烈推荐 Apress 的“ [Workflow in the 2007 Microsoft Office System](http://www.apress.com/book/view/1590597001) ”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T21:10:00.320

是的，您必须在 SharePoint 服务器本身上进行所有开发。考虑使用虚拟机并打包可以部署到登台和生产环境的功能。

[http://weblogs.asp.net/erobillard/archive/2007/02/23/build-a-sharepoint-development-machine.aspx](http://weblogs.asp.net/erobillard/archive/2007/02/23/build-a-sharepoint-development-machine.aspx) [http://www.wssdemo.com/Pages/EntDev.aspx](http://www.wssdemo.com/Pages/EntDev.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T21:34:58.647

是的，您可以在多开发人员环境中开发 SharePoint 工作流、WebPart 等，而无需任何 hack。我建议你使用

*   一个[MOSS 2007 VPC 图像](http://www.pptspaces.com/sharepointreporterblog/Lists/Posts/Post.aspx?List=7537e639-b4e5-48b6-97c0-a75e44ee9be3&ID=7)
*   [Ankhsvn](http://ankhsvn.open.collab.net/)在 Visual Studio 中使用 svn
*   以及[WSPBuilder 扩展](http://www.codeplex.com/wspbuilder)

也许您应该阅读[您对 Sharepoint 最大的抱怨是什么？](https://stackoverflow.com/questions/256407/what-are-your-biggest-complaints-about-sharepoint)看看你在做什么;-)

要学习 SharePoint 工作流开发，您可以从分[步教程开始。为 Windows Sharepoint Services 和 MOSS2007 创建工作流](http://sergeluca.spaces.live.com/blog/cns!E8A06D5F2F585013!859.entry)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-21T13:54:33.960

虽然您确实需要在开发计算机上安装 SharePoint 才能进行大多数 SharePoint 开发，但您可以在没有它的情况下进行工作流开发。跟着这些步骤：

*   将 SharePoint DLL 复制到您的开发计算机（对于工作流，您需要 microsoft.sharepoint.WorkflowActions.dll）。
*   打开 Visual Studio 并打开工具箱选项卡
*   添加一个新选项卡（称为 SharePoint 工作流项）
*   在新选项卡中，单击“添加项目”
*   点击“活动”标签
*   找到并添加 microsoft.sharepoint.WorkflowActions.dll
*   您会看到一些新任务出现并且已经被选中。

完成此操作后，您将能够开发可以使用特定于 SharePoint 的任务的 WF 工作流。部署和测试工作流完全是另一项任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-10T16:32:54.407

此外，在此线程中随便提到了它，但您目前无法在 64 位 SharePoint Server 上开发 SharePoint 工作流。您必须安装 32 位 Windows Server 和 SharePoint Server。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-29T15:12:55.803

这是一些 SharePoint 工作流如何制作视频的链接。

[http://chrisbarba.wordpress.com/2009/12/21/sharepoint-workflow-how-to-videos/](http://chrisbarba.wordpress.com/2009/12/21/sharepoint-workflow-how-to-videos/)

# perforce - 我可以在 perforce 上将签出的文件集成到不同的分支中吗

> ID：300160
> 
> 赞同：10
> 
> 时间：2008-11-18T21:12:28.100
> 
> 标签：perforce, integrate

我们正在进行设计，为此我们在主分支中创建了类的骨架。现在，我们开始编写代码，为此我们有了一个新分支。因此，如果我可以将主分支中的所有新文件移动到新分支中，那就太好了。但是，我还不能签入。那么，是否可以集成签出的变更列表？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-19T01:58:36.353

Perforce 支持网站解释了如何执行此操作：[Perforce 知识库：进行中的分支工作](https://community.perforce.com/s/article/3372)。如果它是一个不需要运行八个不同命令的单个步骤，那就更好了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-05T13:07:46.890

自 2013.1 版本以来，将进行中的工作分支的方式是[`shelve`](https://www.perforce.com/perforce/doc.current/manuals/cmdref/index.html#CmdRef/p4_shelve.html#p4_shelve%3FTocPath%3DCommands%2520-%2520alphabetical%2520list%7Cp4%2520shelve%7C_____0)工作和[`unshelve`](https://www.perforce.com/perforce/doc.current/manuals/cmdref/index.html#CmdRef/p4_unshelve.html#p4_unshelve%3FTocPath%3DCommands%2520-%2520alphabetical%2520list%7Cp4%2520unshelve%7C_____0)分支上的工作。详细地：

1.  搁置您未完成的更改：

    ```
    $ p4 shelve ...
    Change 182535 created with 10 open file(s).
    Shelving files for change 182535.
    edit //info.ravenbrook.com/project/mps/master/code/arenavm.c#26
    # etc. 
    ```

2.  在分支上取消搁置它们（使用`-b`选项，通过分支规范映射文件名）：

    ```
    $ p4 unshelve -b mps/branch/2013-06-05/diag -s 182535
    ... //info.ravenbrook.com/project/mps/branch/2013-06-05/diag/code/arenavm.c - must resolve //info.ravenbrook.com/project/mps/master/code/arenavm.c@=182535 before submitting
    # etc. 
    ```

3.  解决由 产生的任何合并`unshelve`，使用`p4 resolve -as`快速执行“安全”合并，然后`p4 resolve`像往常一样执行其余操作。

    ```
    $ p4 resolve -as
    //gdr-peewit/info.ravenbrook.com/project/mps/branch/2013-06-05/diag/code/arenavm.c - copy from //info.ravenbrook.com/project/mps/master/code/arenavm.c
    # etc.
    $ p4 resolve
    No file(s) to resolve. 
    ```

（示例输出来自我刚才运行的一个真实用例。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T21:38:11.107

我从来没有找到一种在 perforce 中做到这一点的方法，但你至少可以部分自动化它。

通常当我不得不做类似的事情时，我会检查我想要移动的分支中的文件，然后使用[WinMerge](http://winmerge.org/)来区分分支并复制更改。完成后，您可以还原原始分支中的更改并将它们签入新分支。

这不是最好的解决方案（新分支上没有自动签出/添加/删除文件），但它是我想出的最快的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T21:52:12.637

并不真地。

您当然可以简单地在新分支中打开文件进行编辑，然后手动将更改的文件从主分支的工作区复制到新分支的工作区。如果只有几个文件，这可能是最简单的方法。

如果涉及大量文件，[这里有一些脚本会很方便。](http://code.google.com/p/p4scripts/)例如，使用[P4Shelf](http://www.tilander.org/aurora/2008/01/p4shelf.html)脚本，您可以创建所有更改文件的存档，然后在恢复更改的任何分支中自动打开它们。

另外，请查看Jim Tilander 为 Perforce编写的[其他一些漂亮脚本。](http://www.tilander.org/aurora/perforce/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-12T06:54:02.437

用简单的术语改写 Gareth Rees 上面的回答，

```
p4 unshelve -b target_branchspec -s changelist 
```

:)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-18T21:49:52.283

简单的答案是——不，你不能。不幸的是，快速浏览 Perforce 文档并没有为此提供现成的引用，但根据我的经验，任何从 Perforce 服务器下拉出地毯的尝试都会导致您的更改丢失，这会让您不开心露营车。

进行备份，在新分支上创建一个新工作区，然后重新应用您的更改，可能使用 Herms 回答中概述的差异/合并策略。

# multithreading - 什么是上下文切换？

> ID：300167
> 
> 赞同：21
> 
> 时间：2008-11-18T21:15:34.847
> 
> 标签：multithreading, operating-system

我正在阅读有关该`debuggerstepperboundary`属性的信息，并且一个站点说它在上下文切换中很有用。

究竟什么是上下文切换？我假设它是从一个线程切换到另一个线程，还是在执行或安全上下文中？但是，这些并不是特别有根据的猜测，所以我在这里问。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-18T21:19:06.260

上下文切换（有时也称为进程切换或任务切换）是 CPU（中央处理单元）从一个进程或线程切换到另一个。

上下文切换可以稍微更详细地描述为内核（即操作系统的核心）针对 CPU 上的进程（包括线程）执行以下活动：（1）暂停一个进程的进程并存储该进程在内存中某处的 CPU 状态（即上下文），（2）从内存中检索下一个进程的上下文并将其恢复到 CPU 的寄存器中，以及（3）返回到程序计数器指示的位置（即，返回到中断进程的代码行）以恢复进程。

上下文切换有时被描述为内核暂停 CPU 上一个进程的执行，并恢复执行先前已暂停的某个其他进程。尽管这种措辞有助于澄清概念，但它本身可能会造成混淆，因为根据定义，进程是程序的执行实例。因此，暂停进程进展的措辞可能更可取。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T21:22:12.323

上下文切换是 CPU 从一个进程/线程切换到另一个进程/线程。

人们有时会在特定的计算机世界之外使用术语上下文切换来反映他们在自己的生活中所做的事情。“如果我要回答这个问题，我需要从考虑 A 切换到考虑 B”。

[维基百科](http://en.wikipedia.org/wiki/Context_switch)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T21:17:16.483

它通常是指在线程或进程之间切换。 [维基百科](http://en.wikipedia.org/wiki/Context_switch)有更详尽的描述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T21:18:24.920

它是在 CPU 上的进程之间切换的过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-12T09:05:34.550

> 将 CPU 内核切换到另一个进程需要执行当前进程的状态保存和不同进程的状态恢复。此任务称为***上下文切换***

摘自：Operating System Concepts，Abraham（恐龙封面）

* * *

但这并不一定能帮助我理解这个概念。我喜欢看动画或图像作为学习。因此，[RTOS 的链接](http://web.archive.org/web/20171119164253/http://www.freertos.org/implementation/a00006.html)确实很有帮助。

# html - IE6中的css li菜单动态线宽

> ID：300175
> 
> 赞同：1
> 
> 时间：2008-11-18T21:18:40.553
> 
> 标签：html, css, menu, internet-explorer-6

我有一个像这样的 CSS 菜单：

```
<ul>
  <li><a>Item1</a></li>
  <li><a>Item Two</a></li>
  <li><a>Item C</a></li>
  <li><a>A Rather Long Menu Item Down Here</a></li>
</ul> 
```

我想创建这个：

```
|------------------------------------------------|
| 项目1 |
|------------------------------------------------|
| 项目二 |
|------------------------------------------------|
| 项目 C |
|------------------------------------------------|
| 一个相当长的菜单项在这里 |
|------------------------------------------------|

```

但我得到了这个：

```
--------
| 项目1 |
|-----------
| 项目二 |
|-----------
| 项目 C |
|------------------------------------------------
| 一个相当长的菜单项在这里 |
 ----------------------------------

```

如果我将 [li] 或 [a] 标签设置为 display:block，它们会拉伸以填充最大可能宽度。我希望它们都具有相同的宽度，该宽度由最宽的项目动态确定，而不是通过手动在 [ul] 标签上放置宽度。

哦，目标是IE6。:)

### 更新：

`width:1px, overflow:visible`没用。（获得与没有显示相同的压扁效果：阻塞锚点。）

这是针对以 IE6 为目标的 Intranet，所以我被困在那里。（在其他项目中，我已经不再担心它了。）JS 是必需的，所以也许我会使用它。（不过，我总是讨厌这样做。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T02:00:07.800

这非常简单：

```
<style>
ul {
float: left;
}
    ul li a {
    display: block;
    white-space: nowrap;
    border: 1px solid blue;
    }
</style>

<ul>
  <li><a>Item1</a></li>
  <li><a>Item Two</a></li>
  <li><a>Item C</a></li>
  <li><a>A Rather Long Menu Item Down Here</a></li>
</ul> 
```

这里的技巧是浮动 <ul> 和添加空格的组合： nowrap; 到被阻塞的锚点。事实上，除非你的 <ul> 正在争夺空间，否则你甚至不需要“nowrap”。至于忽略 12% 的访客的建议……嗯……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T21:39:10.713

你唯一的选择是javascript。

顺便说一句，我的一个网站被大量家庭用户访问。我们已经看到 IE6 占我们流量的 12%。两个月前是20%。而整体 IE 流量保持在 76%

我的观点是，您可能不应该再担心 IE6 的怪癖了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T21:42:37.133

一定数量的黑客使它在 IE6 中工作，因为 width:auto 从来没有真正正常工作。

我已经看到了一些使用 width:1px; 来解决这个问题的方法；溢出：可见；，在这种情况下可能会起作用，但最好在条件注释中执行，以免在“真实”浏览器中填充，或使用 holly hack 或类似方法。请注意，IE 6 在怪癖模式和标准模式下的处理方式可能不同，因此请了解您的文档类型。

顺便说一句，会将您的锚标记作为块放置，因此您可以获得一致的宽度鼠标目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T22:13:10.987

要使用纯 CSS 但宽度不均匀的 ul 在*ul中获得收缩包装的**li* ，请尝试：

 *```
ul,li {float:left;}
ul {overflow:hidden;}
li {clear:left;} 
```

（然后可能会调整具有固定行高和重复背景图像的*[人造列](http://www.alistapart.com/articles/fauxcolumns/)**来设置li*元素的样式）

如果您*确定*它是仅限 IE 的，那么 JavaScript 可以内置到 CSS 中，并使用*[动态属性](http://msdn.microsoft.com/en-us/library/ms537634.aspx)*来设置子宽度以匹配父级：

```
ul,li {float:left;}
ul {overflow:hidden;}
li {clear:left;width:expression(this.parentNode.offsetWidth);} 
```

# unit-testing - 为什么我的单元测试需要一个模拟框架？

> ID：300177
> 
> 赞同：38
> 
> 时间：2008-11-18T21:19:58.083
> 
> 标签：unit-testing, mocking

最近，围绕 .NET 世界中所有不同的模拟框架进行了相当大的宣传。我还没有完全理解他们的伟大之处。编写我自己需要的模拟对象似乎并不难。特别是在 Visual Studio 的帮助下，我可以快速编写一个类来实现我想要模拟的接口（它为我自动生成几乎所有内容），然后为我的测试所需的方法编写一个实现。完毕！为什么要为了节省几行代码而费尽心思去理解一个模拟框架。还是一个模拟框架不仅仅是为了节省代码行数？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-18T21:29:20.123

一旦我终于掌握了模拟对象的窍门，我意识到它们对于单元测试至关重要，原因与双盲测试或对照组对于科学试验必不可少：它们隔离了您实际测试的内容。

如果您正在测试一个通过其他接口进行大量交互的类，您不仅可以节省模拟每个接口的代码行，而且您还可以获得执行诸如“抛出异常”之类的能力调用了意外的方法”或“如果这些方法被乱序调用，则异常”。您可以使用模拟框架变得非常复杂，尽管我很快承认学习曲线很大，但当您加快速度时，它们将有助于使您的单元测试更加彻底而不会臃肿。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-18T21:36:58.720

您实际上在问题中确定了模拟框架的关键点之一。您自己编写模拟代码的事实不是开发人员应该关心的。模拟框架以编程方式为您提供接口的实现，而且它们是功能性的（基于您的模拟设置）。

例如，如果您正在测试一个 ICustomerDAO，并且您想对某个方法进行 14 次不同结果的测试，您会怎么做？手动实现 14 个不同的类？我怀疑有人愿意这样做。

当您不关心它们是否真正起作用时，模拟使您能够定义类的某些部分会发生什么，例如在您想要它们时抛出异常，返回零结果并确保您正确处理，等等...

它们是一个很棒的单元测试工具。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-18T21:36:32.623

以前可能有帮助的问题：
[什么是模拟，什么时候应该使用它？](https://stackoverflow.com/questions/214092/what-is-a-mock-and-when-should-you-use-it)
[Mockist 与经典 TDD](https://stackoverflow.com/questions/184666/should-i-practice-mockist-or-classical-tdd)

我发现使用模拟框架可以让我更快地生成测试，并且可以更好地验证我期望在测试中发生的事情实际上是发生。我过去曾自己实施过存根或伪造品。我发现我需要生成特定于我想要的测试的存根，这需要很多时间。我可以使用模拟框架更快地创建相同的测试。好的支持以简单的语法生成假货、存根或模拟。

需要一段时间才能掌握它，我有一段时间避免使用它，但由于@Chamelaeon 所述的原因，现在不会尝试在没有模拟框架的情况下工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-18T21:28:58.347

[Roy Osherove](http://weblogs.asp.net/rosherove/archive/2007/04/26/choosing-a-mock-object-framework.aspx)对 Mock Frameworks 进行了一项民意调查，在评论部分，有一个关于是否需要 Mock Framework 的讨论（尽管很简短）。

我个人一直按照您所说的手动进行操作，并且效果很好，但这主要是出于习惯，而不是对模拟框架的普遍看法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-18T21:26:28.040

好吧，我当然不认为你需要一个模拟框架。它与任何其他框架一样，最终旨在为您节省一些时间和精力。您还可以执行诸如滚动您自己的常见数据结构（如堆栈和队列）之类的事情，但通常只使用内置于您选择的语言的编译器/IDE 附带的类库中的那些不是更容易吗？

我确信使用模拟框架还有其他令人信服的理由，尽管我将把它留给 TDD 和单元测试专家来回答。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T21:54:41.260

出于同样的原因，您不会尝试在没有 NUnit 的情况下编写单元测试。模拟框架将帮助您验证数百个单元测试的状态和行为。花费 2 周左右的时间来加快速度并真正帮助您专注于需要测试的内容是值得的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-04T14:48:32.547

关于模拟框架让我困扰的一件事是“给定 i/p 的函数应该 o/p”通过

**when(mock.someMethod("some arg")).thenReturn("something");**

语句分布在许多单元测试类中。

让我用一个例子来详细说明。假设有一个 DAO 接口函数 getEmp(int EmpID) 在将员工 ID 作为参数传递时返回一个员工对象。假设这个函数被 10 个不同的单元测试类模拟。现在，如果将来更改此函数以返回更新版本的 Employee 对象，则必须访问 10 个不同的类中的每一个来更新此更改。

缺点如下...

a) 我不知道如何找出所有模拟这个函数的类，以便我可以去更新这个变化。

b) 我现有的使用模拟 DAO 对象的测试用例仍然幸福地没有意识到 DAO 接口发生的变化，因为模拟没有改变，因此继续保持绿色。理想情况下，如果我自己编写了一个模拟类并在任何地方使用它，我将只有一个地方可以更新 Employee 对象的新版本。此外，一旦我在这个地方更新，我所有使用模拟的现有测试用例都会中断，然后我会确切地知道我需要去哪些地方并为新的员工对象进行更新。

对我的观点有任何想法..

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T21:40:32.397

模拟框架的好处之一是它允许对被模拟的对象设置期望。有了期望，我就可以设置各种条件来运行正在测试的代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-24T08:48:05.817

隔离框架或[模拟框架](http://www.typemock.com/index.php)允许您测试您想要的代码，而无需依赖它。它可以进行短期运行测试，允许您快速调试，并轻松地围绕代码构建测试安全网。不同的框架有不同的特性，如前所述——它是一个工具，你应该为工作选择合适的工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-21T20:55:22.753

我使用 rhino 模拟作为模拟框架。我和其他 5 位开发人员在一个为期 8 个月的大型企业应用程序中使用了它。我们在项目中使用了 tdd。它值得吗？我猜。使用模拟是否有如此巨大的卖点，以至于我必须在每个项目中都使用它？在我看来，没有。这不是必需的，它只是一个工具，如果你想尝试一下就可以使用。有些项目你可以推出自己的模拟类，因为这里有些人说他们更喜欢 - 这更容易。其他项目更大，可能需要一个模拟框架。关键词（在我看来）是可能需要...你需要多少代码覆盖率？对我来说，这是使用模拟的另一个考虑因素。我用 tdd/rhino 模拟做的项目要求我们有 80% 的代码覆盖率，所以模拟帮助我们实现了这一目标。

# c# - C#：从基类静态方法确定派生对象类型

> ID：300181
> 
> 赞同：5
> 
> 时间：2008-11-18T21:20:45.353
> 
> 标签：c#, static-methods, derived-class

在 C# 程序中，我有一个带有静态“创建”方法的抽象基类。Create 方法用于创建类的实例并将其存储在本地以供以后使用。由于基类是抽象的，实现对象总是从它派生的。

我希望能够从基类中派生出一个对象，通过派生类调用静态的Create方法（在基类中实现一次），并创建派生对象的实例。

C# 语言中是否有任何工具可以让我完成这项工作。我当前的后备位置是将派生类的实例作为参数之一传递给 Create 函数，即：

```
objDerived.Create(new objDerived(), "Arg1", "Arg2"); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-18T21:35:15.183

尝试使用泛型：

```
public static BaseClass Create<T>() where T : BaseClass, new()
{
    T newVar = new T();
    // Do something with newVar
    return T;
} 
```

样品用途：

```
DerivedClass d = BaseClass.Create<DerivedClass>(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T22:17:46.253

## 概括

有两个主要选项。比较新的一种是使用泛型，另一种是使用反射。如果您需要开发适用于 .NET 2.0 之前的解决方案，我会同时提供这两种解决方案。

## 泛型

```
abstract class BaseClass
{
  public static BaseClass Create<T>() where T : BaseClass, new()
  {
    return new T();
  }
} 
```

在哪里使用：

```
DerivedClass derivedInstance = BaseClass.Create<DerivedClass>(); 
```

## 反射

```
abstract class BaseClass
{
  public static BaseClass Create(Type derivedType)
  {
    // Cast will throw at runtime if the created class
    // doesn't derive from BaseClass.
    return (BaseClass)Activator.CreateInstance(derivedType);
  }
} 
```

使用的地方（为了便于阅读，分成两行）：

```
DerivedClass derivedClass
    = (DerivedClass)BaseClass.Create(typeof(DerivedClass)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T21:46:42.540

您想使用抽象基类上的静态工厂方法从派生的另一个实例内部创建一个新的派生实例吗？如果是这样，我想知道为什么......但是......

```
 public abstract class MyBase
 {
    public static T GetNewDerived<T>() where T : MyBase, new()
    {
        return new T();
    }    
 }
 public class DerivedA : MyBase
 {
    public static DerivedA GetNewDerived()
    {
        return GetNewDerived<DerivedA>();
    }
 }

 public class DerivedB : MyBase
 {
    public static DerivedB GetNewDerived()
    {
        return GetNewDerived<DerivedB>();
    }
 } 
```

这是你想要的吗 ？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T21:24:53.910

听起来您需要将 Create() 方法抽象化。一旦你这样做了，你不妨重命名它并使其成为构造函数。然后，如果需要，您可以在构造对象后调用不同的 Init() 方法，并且正常的多态效果将处理这些事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T21:22:46.143

如果没有外部信息，您将无法做到；派生类的类型、它的实例或派生类的完全限定名称。这些中的任何一个都等同于您已经在做的事情；我知道没有更好的解决方案。静态方法的本质排除了任何更优雅的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T21:50:27.057

我不确定您的设计目标是什么，但根据您的要求，这听起来可能最终会产生很多代码气味。我认为您应该真正研究在 Microsoft Unity、Castle Windsor、StructureMap、Ninject、Spring.Net 等众多框架中实现的控制反转 (IoC) / 依赖注入 (DI) 设计模式。

我认为，如果您考虑使用 IoC 容器，它将以更清洁和松散耦合的方式解决您的问题。

# c# - 实现 IEquatable 方法会破坏序列化吗？

> ID：300183
> 
> 赞同：2
> 
> 时间：2008-11-18T21:21:59.437
> 
> 标签：c#

我有一个可以毫无问题地序列化为 XML 的对象。但是，当我实现 IEquatable 并覆盖这些函数时，我收到一个关于未正确生成 XML 的错误。有人遇到过这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T21:50:14.607

您可能需要覆盖 Equals 和 GetHashCode。有关详细信息，请参阅[http://www.codeproject.com/KB/dotnet/IEquatable.aspx](http://www.codeproject.com/KB/dotnet/IEquatable.aspx)。

# javascript - 谷歌浏览器 - JavaScript 版本

> ID：300185
> 
> 赞同：47
> 
> 时间：2008-11-18T21:22:41.637
> 
> 标签：javascript, firefox, google-chrome

相对于 Mozilla Firefox，Google Chrome 支持哪个版本的 JavaScript？换句话说，Chrome 是否支持 Firefox 也支持的 JavaScript 1.6、1.7 或 1.8 或它们的某种组合？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-07-14T13:24:08.493

虽然 Chrome 会执行标记为“javascript1.7”的 Javascript，但它不支持 JS1.7 功能，例如“let”作用域变量运算符。

此代码将在 Firefox 3.5 上运行，但不能在使用 V8 的 Chrome 上运行：

```
<script language="javascript" type="application/javascript;version=1.7">
    function foo(){ let a = 4; alert(a); }; foo();
</script> 
```

如果您将语言更改为“javascript1.7”并省略类型，它将无法使用 Firefox 3.5 中的 JS 1.7 功能运行。类型部分是必需的。

这似乎与一般 WebKit 错误有关，[https](https://bugs.webkit.org/show_bug.cgi?id=23097) ://bugs.webkit.org/show_bug.cgi?id=23097 ；Chrome 可能会模拟 Safari 的行为，即使它使用不同的引擎。

[当被问及是否支持 JS 1.8 功能](http://www.mail-archive.com/v8-users@googlegroups.com/msg00731.html)时，V8 团队表示他们正在尝试跟踪 Safari 中使用的版本，以便页面在两种浏览器中的行为相同。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-03-14T03:52:50.070

这个线程仍然是相关的。截至 2012 年，Chrome 支持大部分 Javascript 1.6，不包括字符串和数组泛型。它不支持1.7。[它支持从 1.8 开始的 reduce 和 reduceRight，所有 1.8.1，以及 Getter 和 setter 以及此页面](http://robertnyman.com/javascript/index.html)上列出的所有非版本特定的东西。此页面链接自 Mozilla 开发者网络，该网络指定了 javascript 的版本，可在[此处](https://developer.mozilla.org/en/JavaScript)找到。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-18T21:46:31.417

Google Chrome 使用[V8 javascript 引擎](http://code.google.com/p/v8/)，该引擎目前声明它实现了 ECMA-262，第 3 版。这意味着它至少支持 1.5 版。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-01-08T15:11:20.203

这是一个简单的 Javascript 1.6 功能 Chrome（和 V8 用户，如 node.js）不会运行：[for each … in](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for_each...in)

```
for each (variable in object)
  statement 
```

因为它是 JS 1.5（根据 J c 的回答）是 Chrome 声称完全实现的唯一版本。

事实上，Chrome 团队的主要目标是与 Safari（当时最杰出的 Webkit 用户）兼容，并以此为由拒绝了功能。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-18T21:41:01.460

Google Chrome 最高支持 Javascript 1.7：

```
<script language="javascript1.7">alert(1.7);</script> - Alerts
<script language="javascript1.8">alert(1.8);</script> - Doesn't alert 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-04-13T21:12:52.490

这是一个旧线程，但是这里有。谷歌浏览器不响应以下内容

```
function foo(){
  let a = 4;
  alert(a);
}
foo(); 
```

因此它不支持 JavaScript 1.7

# wpf - WPF 是否有任何 FlowDocument 差异查看器？

> ID：300187
> 
> 赞同：1
> 
> 时间：2008-11-18T21:23:16.237
> 
> 标签：wpf

我们有 2 个流文档，我们想比较类似于使用差异查看器（winmerge、超越比较等）时的情况。有没有人这样做或知道如何从流文档中获取文本进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T13:41:19.457

这是一种从代码隐藏文件中将其保存为原始xaml（文本文件）的方法，假设流文档（不是查看器）本身命名为“myFlowDoc”，如果仅命名查看器，则使用查看器的属性.Document为拿到它，为实现它。和流到流 myStream（FileStream、MemoryStream 等无关紧要）。

```
// Create a TextRange around the entire document.
TextRange documentTextRange = new TextRange(myFlowDoc.ContentStart, myFlowDoc.ContentEnd);

// Save it. Note that it will not respect current stream position;
//  it'll assume that it gets the entire stream.
documentTextRange.Save(myStream, DataFormats.Xaml); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-31T00:53:32.813

我刚刚锻造了一个基本的 WPF 差异查看器。不应该太难适应它来编写并排的 Flowdocument 差异视图。

在此处查找更多信息：http: [//www.eqqon.com/index.php/GitSharp#GitSharp.Demo](http://www.eqqon.com/index.php/GitSharp#GitSharp.Demo)

——海农

# macos - 如何在没有冗长阻塞期的情况下使用 Carbon 卸载 WebDAV 卷？

> ID：300188
> 
> 赞同：1
> 
> 时间：2008-11-18T21:23:49.043
> 
> 标签：macos, webdav, macos-carbon, volumes

我正在尝试使用 FSUnmountVolumeSync() 或 FSEjectVolumeSync() 卸载 WebDAV 卷（使用 FSMountServerVolumeSync() 安装）。到目前为止，我无法让它们中的任何一个可靠地卸载卷而不阻塞超过 20 秒。当他们阻止时，我可以看到 webdavfs_agent 在 Console.app 中抱怨 WebDAV 服务器没有响应。但是，它们永远不会出错，并且 WebDAV 卷之后总是会被卸载。就好像我错过了一步。

我是不是走错了路，还是这只是 OS X 的怪癖/错误？就这两种方法之间的区别或调用它们的任何先决条件而言，文档非常模糊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:41:15.287

你可以试试`FSEjectVolume`*`Async`*。这将在完成弹出卷时调用您的函数。

# xml - W3C XML Schema 和 maxOccurs 的最大整数

> ID：300196
> 
> 赞同：2
> 
> 时间：2008-11-18T21:29:18.707
> 
> 标签：xml, xsd

我在 W3C XML Schema 上工作（不是我写的）。一种工具 xmllint 拒绝使用模式：

```
traceroute.xsd:658: element element: Schemas parser error : Element
 '{http://www.w3.org/2001/XMLSchema}element', attribute 'maxOccurs': The value
 '4294967295' is not valid. Expected is '(xs:nonNegativeInteger | unbounded)'. 
```

4294967295 是 2^32-1 所以，很明显，xmllint 实现了带符号的 32 位数字的整数，这还不够。

xmllint 对吗？该标准显然不限制整数的大小：

[http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#p-max_occurs](http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#p-max_occurs) [http://www.w3.org/TR/2004/REC-xmlschema-2-20041028 /datatypes.html#nonNegativeInteger](http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#nonNegativeInteger)

> nonNegativeInteger 的值空间是无限集 {0,1,2,...}。

所以，实现者应该使用无限整数......

最佳实践是什么？

实现者应该使用 bigints 还是类似的东西？（在这种情况下， xmllint 是错误的。）

模式作者是否应该将自己限制为 maxOccurs 的“合理”值？（在这种情况下，我会将问题报告给架构作者。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T21:48:27.777

虽然可能是该`maxOccurs`属性的“技术上”正确用法，但这种用法不是（IMO）`maxOccurs`打算如何使用的。

看起来模式编写者的意思是该元素可能出现任意多次，在这种情况下，定义的正确值将是`unbounded`.

当前定义的含义是，使用此模式的系统对于元素计数将完全正确，`4294967295`但对于更大的元素将失败。

我想这是一个可能有意义的技术要求 - 许多系统将`int32`编码为元素的最大数量，因此在理想世界中您可能想要强制执行此限制，但我认为这不是一个合理或有用的在现实世界的模式中尝试和捕获的东西。

此外，如果您要发送这么多元素，那么 XML 可能是错误的数据格式。

我建议架构作者使用`unbounded`属性值，或者使用实际匹配使用此 XML 的系统的限制和要求的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T20:38:48.407

最后，该模式已被其作者修改。它已在[RFC 5388](http://www.ietf.org/rfc/rfc5388.txt)中发布，现在包含：

```
 <xs:element maxOccurs="2147483647" minOccurs="0"
                 name="Measurement">
       <xs:complexType>
         <xs:sequence> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-20T08:48:27.910

maxOccurs 的最大值是 4095。
如果需要更多，请将其设置为“无界”。
参考： [https ://docs.microsoft.com/en-us/biztalk/core/technical-reference/max-occurs-node-property-of-all-schemas](https://docs.microsoft.com/en-us/biztalk/core/technical-reference/max-occurs-node-property-of-all-schemas)

希望这有帮助！

# html - 如何在 html 页面上嵌入 swf？

> ID：300200
> 
> 赞同：1
> 
> 时间：2008-11-18T21:30:26.300
> 
> 标签：html, flash, embed

我想在 html 页面上嵌入 swf，例如浮动视频观看面板。我已经有一个 swf 文件，它会根据浏览器大小自动调整其大小，并且 swf 文件是部分透明的。我以为我可以添加一个 div 标签，使位置绝对并更改 z-index 更大，但这不起作用，因为 swf 只是替换了页面上的所有内容。

这就是我所做的

```
<script>
      swfobject.embedSWF("swf/float.swf", "header", "100%", "100%", "9.0.0");
</script>

<body bgcolor="#000000">
      <div id="header"></div>
      <div id="shell">
          things in my html
      </div>
</body>

#header {
    position:absolute;
    z-index:100;

} 
```

任何的想法？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T23:31:35.650

一旦你的尺寸正常工作，你需要将*wmode 设置*为*透明*以便能够看到闪光灯后面的内容，如果你不这样做，它的背景将是不透明的。

这是来自[swfobject docs](http://code.google.com/p/swfobject/wiki/documentation)的快速复制粘贴，但它应该明白这一点：

```
<script type="text/javascript">

var flashvars = {};
var params = {wmode : "transparent"};
var attributes = {};

swfobject.embedSWF("myContent.swf", "myContent", "300", "120", "9.0.0","expressInstall.swf", flashvars, params, attributes);

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T22:14:42.717

我认为问题在于 CSS 不能很好地处理`<object />`标签。将`swfobject.embedSWF`变成`<div id="header"></div>`一个`<object />`带有一堆可能影响 CSS 的属性的标签。如果您在标题 DIV 周围创建一个包装器 DIV 并将 CSS 应用于包装器 DIV，那么一切都会更好。您还需要在 CSS 中添加 100% 的宽度和高度。这是修改后的来源：

```
<script>
    swfobject.embedSWF("swf/float.swf", "header", "100%", "100%", "9.0.0");
</script>

<body bgcolor="#000000">
    <div id="wrapper">
        <div id="header"></div>
        </div>
    <div id="shell">
        things in my html
    </div>
</body>

#wrapper {
    position:absolute;
    z-index:100;
    width:100%;
    height:100%;
} 
```

# c++ - 如何在 C/C++ 中执行无操作？

> ID：300208
> 
> 赞同：5
> 
> 时间：2008-11-18T21:35:33.420
> 
> 标签：c++

对于以下内容：

```
( a != b ) ? cout<<"not equal" : cout<<"equal"; 
```

假设我不在乎它是否相等，我如何通过`cout<<"equal"`用无操作替换来使用上述语句。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-18T21:40:02.537

如果它确实适用于不需要第二个操作的三元运算符，那么最好的选择是将其替换为 if：

```
if (a!=b) cout << "not equal"; 
```

它闻起来会少很多。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T21:40:22.037

简单：我会将其编码为

```
if (a != b)
   cout << "not equal"; 
```

三元运算符要求两个结果的类型相同。所以你也可以逃脱

```
(a != b) ? cout << "not equal" : cout; 
```

因为流运算符 (<<) 只返回 ostream 引用。不过，在我看来，这是丑陋和不必要的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T14:50:34.827

以下将实现您正在寻找的内容，但是，阅读您的代码的人可能不清楚它*为什么*起作用：

```
(a != b) && (cout << "equal"); 
```

就个人而言，我同意 Vinko Vrsalovic 的[这个](https://stackoverflow.com/questions/300208/how-does-one-execute-a-no-op-in-cc#300225)回答。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-18T21:45:38.297

其他答案中唯一缺少的是：没有办法直接在 C/C++ 中编写“noop”。

此外，doing:`(a != b) ? : printf("equal\n");`确实为我编译（gcc 4.2.4 中的 gcc -ansi）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-08T15:25:21.633

`(void)0;`是noop。`expr?false:true`使用表单有很多很好的理由。看看 assert() 是如何实现的。

所以在你的例子中，使用`( a != b ) ? (void)0 : cout<<"equal";`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T21:39:53.833

这是非常混乱的代码。你*可以*写

```
cond ? cout << "equal" : cout; 
```

但你不会（会吗？）因为你已经习惯`if`了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-18T21:43:26.617

我认为这里的问题是运算符 : 有两个 EXPRESSIONS 作为参数。假设.. a = x ？y：z；

根据定义，表达式必须有一个值......这就是为什么你不能只是“跳过”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T15:02:49.407

如果代码的重点是输出操作而不是条件，那么可以这样做：

```
cout << (cond ? "not equal" : ""); 
```

不过，我怀疑情况并非如此，因为您不想在“else”子句中执行任何操作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-18T15:14:18.940

在 C++11 中，您可以编写（在 void 的情况下）：

```
somecondition ? foo() : [] {} () ; 
```

所以 NOP 实际上是一个空的 lambda。除了 void 你可以返回任何类型和值。

这本身可能看起来有点矫枉过正，但假设你有这个：

```
somecondition1 ? foo1() :
somecondition2 ? foo2() :
somecondition3 ? foo3() :
                 flip_out_because_unhandled_condition() ; 
```

现在，如果有人添加了 somecondition4，但忘记将其包含在处理代码中，软件将调用 flip_out_... 函数，从而导致各种不良影响。但也许 somecondition4 不需要特别注意，只需要忽略即可。那么你可以写：

```
somecondition1 ? foo1()   :
somecondition2 ? foo2()   :
somecondition3 ? foo3()   :
somecondition4 ? []{}() :
                 flip_out_because_unhandled_condition() ; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-18T21:40:09.510

```
if (a!=b) cout<<"not equal"; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-18T21:46:12.837

语法只需要一个表达式。你可以去： (a!=b)?cout<<"not equal":1;

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-05T00:53:23.687

两个语句都编译：

```
( a != b ) ? cout<<"not equal" : NULL;

( a != b ) ? NULL : cout<<"equal"; 
```

# html - HTML - xml 数据孤岛

> ID：300210
> 
> 赞同：1
> 
> 时间：2008-11-18T21:36:28.317
> 
> 标签：html, xml

我正在设计一个 Web 应用程序，我打算将数据嵌入到一个 xml 岛，以便我可以根据用户将选择的选项在客户端的 HTML 表上动态呈现它。

我有广泛的概念，但我需要有关如何使用 DOM 导航我的 xml 的指针。以及如何更新我的 xml 岛以将其发回服务器？

请任何指向在线资源的链接或快速建议将不胜感激。

注意：我了解大多数动态 HTML 概念以及服务器和客户端的东西，所以不要害羞在您的回复中非常技术性:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T21:59:39.377

在*W3C* HTML 中没有 XML 数据孤岛（除非您指的是通过使用 Javascript 加载的框架链接的外部 XML 文件），但您可以重用 HTML 元素并在`class`,中插入元数据`title`（如果您关心 HTML4 有效性），`data-*`（ HTML5) 或您的自定义属性。

对于 DOM 导航，您有[DOM Core](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-745549614)，例如`element.childNodes`, `.nextSibling`,`.getAttribute()`等。

DOM 使用起来可能很冗长和乏味（例如，在 DOM 中查找元素时，您必须小心跳过文本节点），因此有 jQuery 和 Prototype 等 JS 库构建在其之上，提供更方便的 API。

如果您打算进行大量 DOM 转换，那么用于[XPath](https://developer.mozilla.org/en/Introduction_to_using_XPath_in_JavaScript)和[XSLT 处理器](https://developer.mozilla.org/en/Using_the_Mozilla_JavaScript_interface_to_XSL_Transformations)的 Javascript API将非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T22:03:55.593

你所描述的可以用 XML 来完成。

但是，我认为如果使用 JSON 而不是 XML，会容易得多。这样，您可以直接使用 Javascript 对象，这比导航 XML DOM 更友好。[然后您可以使用JSON 库](http://www.json.org/js.html)将序列化的 JSON 表单发送到服务器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T22:03:48.480

Ajax 模式有一些使用数据岛的好例子：[http ://ajaxpatterns.org/wiki/index.php?title=XML_Data_Island](http://ajaxpatterns.org/wiki/index.php?title=XML_Data_Island)

# javascript - Javascript 框架发现

> ID：300217
> 
> 赞同：1
> 
> 时间：2008-11-18T21:39:00.933
> 
> 标签：javascript, frames

在javascript中，如何根据该框架中的元素获取我所在的框架的句柄？

```
function myFunction(elementInFrame){
   // here I want to get a handle on the frame that elementInFrame lives in
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T21:59:16.023

elementInFrame.document.defaultView 用于非 IE 浏览器。

（它不是*DOM*的标准部分；DOM Level 2 Views 表示该属性存在，但没有明确表示它指向“窗口”，因为 DOM 标准目前对窗口对象一无所知。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T21:56:18.713

在 IE 中你可以做`elementInFrame.document.parentWindow` 不幸的是在 Firefox 中不起作用。

编辑：如果你使用框架，那么在 FF 中你可以做很长的路......遍历所有框架，直到找到你正在寻找的元素。

# html - 如何防止表格单元格中的文本换行

> ID：300220
> 
> 赞同：335
> 
> 时间：2008-11-18T21:39:28.340
> 
> 标签：html, css

有谁知道如何防止表格单元格中的文本换行？这是一个表格的标题，标题比它下面的数据长很多，但我需要它只显示在一行上。如果列很宽也没关系。

我的（简化的）表格的 HTML 如下所示：

```
<table>
  <thead>
    <tr>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
      <th>
        <div>Really long column heading</div>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
      <td>
        <div>data</div>
      </td>
    </tr>
  </tbody>
</table> 
```

`th`由于与页面上的 javascript 有关的原因 ，标题本身被包裹在标签内的 div 中。

该表格的标题包含多行。这似乎只在表格足够宽时发生，因为浏览器试图避免水平滚动。不过，就我而言，我想要水平滚动。

有任何想法吗？

* * *

## 回答 #1

> 赞同：573
> 
> 时间：2008-11-18T21:43:06.273

看看[`white-space`](http://www.w3.org/TR/CSS21/text.html#white-space-prop)属性，使用如下：

```
th {
    white-space: nowrap;
} 
```

这将强制 的内容`<th>`显示在一行上。

从链接页面，这里有各种选项`white-space`：

> **normal**
> 此值指示用户代理折叠空白序列，并根据需要换行以填充行框。
> 
> **pre**
> 这个值防止用户代理折叠空白序列。仅在保留的换行符处换行。
> 
> **nowrap**
> 此值会像“正常”一样折叠空白，但会抑制文本中的换行符。
> 
> **pre-wrap**
> 该值防止用户代理折叠空白序列。在保留的换行符处换行，并根据需要填充行框。
> 
> **pre-line**
> 该值指示用户代理折叠空白序列。在保留的换行符处换行，并根据需要填充行框。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-11-18T21:43:08.427

```
<th nowrap="nowrap"> 
```

或者

```
<th style="white-space:nowrap;"> 
```

或者

```
<th class="nowrap">
<style type="text/css">
.nowrap { white-space: nowrap; }
</style> 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-11-18T21:42:56.837

至少有两种方法可以做到：

在“td”标签内使用 nowrap 属性：

```
<th nowrap="nowrap">Really long column heading</th> 
```

在单词之间使用不可破坏的空格：

```
<th>Really&nbsp;long&nbsp;column&nbsp;heading</th> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-03-08T16:24:11.107

我遇到了这个问题，需要防止在连字符处换行。

我是这样做的：

```
<td><nobr>Table Text</nobr></td> 
```

参考：

[如何防止在所有浏览器上的连字符处换行](https://stackoverflow.com/questions/8753296/how-to-prevent-line-break-at-hyphens-on-all-browsers)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-02T18:36:34.890

### 用于 React / Material UI

如果您在这里想知道在 React 中构建 Material UI 时这是如何工作的，那么您可以将其添加到`<TableHead>`组件中：

```
<TableHead style={{ whiteSpace: 'nowrap'}}> 
```

# jdbctemplate - jdbcTemplate 和 Oracle 10

> ID：300236
> 
> 赞同：0
> 
> 时间：2008-11-18T21:43:01.313
> 
> 标签：jdbctemplate

试图做一个插入，我有： jdbcTemplate.update("insert into....", new Object[]{foo.getId(), foo.getName()}) foo.getId() 返回一个 long，并且getName() 一个字符串。我将“NUMBER”作为 Oracle 中的 id 类型，将 varchar2 作为名称字段。

我遇到了 SQLtype 未知问题。update 方法有一个版本，我不必输入 SQL 类型，但我必须，如果是，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T22:56:39.403

我假设您的意思是[Spring Framework](http://static.springframework.org) [JdbcTemplate](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/JdbcTemplate.html)类。这些`JdbcTemplate`方法将尝试猜测值引用的[java.sql.Type](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Types.html)，但在这种情况下显然没有正确猜测。

有几种方法可以包含类型：

[ `JdbcTemplate.update(String, Object[])`javadoc]( [http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/JdbcTemplate.html#update(java.lang.String](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/JdbcTemplate.html#update(java.lang.String) , java.lang.Object [])) 表示可以传递[SqlParameterValue](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/SqlParameterValue.html)实例，由[java.sql.Type](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Types.html)和*value*组成。

或者，您可以使用传递[java.sql.Type](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Types.html)`JdbcTemplate.update(String, Object[], int[])`数组

# c# - 将传统缓存映射到 memcached？（但在 .NET 中）

> ID：300245
> 
> 赞同：1
> 
> 时间：2008-11-18T21:44:02.590
> 
> 标签：c#, asp.net, caching, memcached, appfabric

我正在构建一个缓存系统，我希望它能够为分布式缓存（la memcached）做好准备。我要做的是转换（字符串->对象）的传统哈希表/字典，并允许缓存本身处理每个项目的到期，就像 System.Web.Caching.Cache 可以做。

我知道 memcache 需要您对缓存的想法进行一些更改，特别是在管理过期方面，但我还没有太多经验。有谁知道在分布式缓存周围带有缓存包装器的文章/站点/等？我想尝试了解如何控制缓存大小，根据使用量对缓存中的项目进行优先级排序等。

谢谢！史蒂夫

PS - 我对 Velocity 的了解还不够多，无法知道是否适用相同的哈希键模型，如果您对 Velocity 有很多了解，我也会很感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-22T12:02:36.497

最重要的是确保您的应用程序易于移植，遵循正常的 DI/IOC（依赖注入/控制反转）原则。所以依赖缓存的代码不应该

*   获取对缓存本身的引用
*   引用 Dictionary<,> 对象

相反，请确保代码

*   通过接口调用缓存，例如IDictionary<,>
*   获取对注入缓存的引用

如果您使用的是 DI 框架，那么当您迁移到 memcached 时，您只需更改 DI 配置代码，所有需要缓存的组件现在都可以使用 memcached。

如果您发现某个特定的 memcached .NET 组件不能正常工作，您可以轻松更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T21:51:32.170

您可以查看 .Net 的开源 Memcached 包装器之一。这可能会有所帮助。这是我在生产中运行了一段时间的 Sourceforge 的一个。

[内存缓存.net](http://sourceforge.net/projects/memcacheddotnet/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T22:32:57.757

这可能会有所帮助 [Memcached Providers](http://www.codeplex.com/memcachedproviders)

# eclipse - 有哪些 SWT 数据网格/表格？

> ID：300246
> 
> 赞同：3
> 
> 时间：2008-11-18T21:44:39.673
> 
> 标签：eclipse, swt

我需要能够在 Eclipse 中的网格/表格控件中显示一些数据...我需要分页、多列排序、列选择等内容。有一个 SWT 表，而[Nebula 项目在 alpha 中有一个网格](http://www.eclipse.org/nebula/widgets/grid/grid.php)。

我需要的东西存在吗？可能是第三者？不一定是免费的，我们可以为功能付费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T18:38:50.983

我还没有看到在我能想到的可重用小部件中实现的那些功能，它们是更多应用程序级别的功能。

**分页：** 如果您要使用 JFace 类型的查看器（SWT Table 或[Nebula Grid都支持这种风格的 MVC 架构，就像](http://www.eclipse.org/nebula/widgets/grid/grid.php)[这个问题](https://stackoverflow.com/questions/115766/a-more-advanced-table-spreadsheet-swt-implementation)中提到的其他一些架构一样），应该可以在内容提供者中实现分页，只需在数据集中设置一些自定义偏移量，然后刷新网格。

**多列排序：** 你可以这样做，它只需要一个正确的表排序接口的实现。你得到两行来比较，你可以在排序算法中比较你喜欢的任何列。不过，实际上选择要对哪些列进行排序的界面取决于您。

**列选择：** 这需要一个带有单元格选择的网格控件。Nebula 是其中之一，SWT Table 不是。如果单元格选择可用，则只需捕获正确的选择事件（可能单击标题）并遍历行以选择正确的单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:18:58.707

小部件天空上还有一个新的“后起之秀”，称为“nattable 2.0”。这是一个开源项目，开发团队反应迅速。你应该看看 nattable.org ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T21:54:09.577

[您可以使用BIRT 插件](http://www.eclipse.org/birt/phoenix/intro/)提供的表格展示功能，即如果您确实[需要高级表格布局](http://java.sys-con.com/node/295339/print)。[（来源：][[theserverside.com](http://www.theserverside.com/tt/articles/content/EclipseBRT/Images/templ_use.png)][）]
[![替代文字](https://i.stack.imgur.com/SmJFN.png)](https://i.stack.imgur.com/SmJFN.png)

（否则经典的 SWT [TableViewer](http://www.richclient2.eu/2006_07_28/tableviewer-with-eclipse-32-sorter-filter-and-sort-indicator/)已经提供了您所追求的一些功能[（来源：][[richclient2.eu](http://www.richclient2.eu/wp-content/uploads/2006/07/table_fract.png)][）] ）[![替代文字](https://i.stack.imgur.com/0RsaJ.png)](https://i.stack.imgur.com/0RsaJ.png)

# c# - C# - 解析网页的最佳方法？

> ID：300252
> 
> 赞同：19
> 
> 时间：2008-11-18T21:46:35.567
> 
> 标签：c#, html, xml, html-content-extraction

我已经将整个网页的 html 保存到一个字符串中，现在**我想**从链接中获取“href”值，最好能够稍后将它们保存到不同的字符串中。最好的方法是什么？

我已经尝试将字符串保存为 .xml 文档并使用 XPathDocument 导航器对其进行解析，但是（令人惊讶的是）它不能很好地导航一个 not-really-an-xml-document。

正则表达式是实现我想要完成的**最佳方式吗？**

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-18T22:10:04.520

我可以推荐[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)。我曾在一些需要解析 HTML 的情况下使用它，而且效果很好。一旦将 HTML 加载到其中，就可以使用[XPath](http://msdn.microsoft.com/en-us/library/ms256115.aspx)表达式来查询文档并获取锚标记（以及其中的任何其他内容）。

```
HtmlDocument yourDoc = // load your HTML;
int someCount = yourDoc.DocumentNode.SelectNodes("your_xpath").Count; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-18T21:49:26.120

正则表达式是一种方法，但它可能会出现问题。

大多数 HTML 页面无法使用标准的 html 技术进行解析，因为正如您所发现的，大多数页面不进行验证。

您可以花时间尝试集成[HTML Tidy](http://tidy.sourceforge.net/)或类似工具，但只构建您需要的正则表达式会快得多。

**更新**

在本次更新时，我收到了 15 票赞成票和 9 票反对票。我认为也许人们没有阅读问题或对此答案的评论。OP 想要做的就是获取 href 值。 **就是这样。** 从这个角度来看，一个简单的正则表达式就可以了。如果作者想要解析其他项目，那么我不会像我在开头所说的那样推荐正则表达式，充其量是有问题的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-18T22:05:53.967

为了处理各种形状和大小的 HTML，我更喜欢使用 HTMLAgility 包@http [://www.codeplex.com/htmlagilitypack](http://www.codeplex.com/htmlagilitypack)，它允许您针对所需的节点编写 XPath，并在集合中获得这些返回。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T21:57:32.627

可能您想要 Majestic 解析器之类的东西：http: [//www.majestic12.co.uk/projects/html_parser.php](http://www.majestic12.co.uk/projects/html_parser.php)

还有一些其他选项可以处理易碎的 html。正如其他人所提到的，Html Agility Pack 值得一看。

我不认为正则表达式是 HTML 的理想解决方案，因为 HTML 不是上下文无关的。如果不精确，它们可能会产生足够的结果；甚至确定性地识别 URI 也是一个麻烦的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T03:37:58.103

如果可能的话，最好不要重新发现轮子。有一些很好的工具可以将 HTML 转换为格式良好的 XML，或者充当 XmlReader：

这里有三个很好的工具：

1.  [**TagSoup**](http://home.ccil.org/~cowan/XML/tagsoup/)是一个开源程序，是一个基于 Java 和 SAX 的工具，由[**John Cowan**](http://home.ccil.org/~cowan/)开发。这是一个用 Java 编写的符合 SAX 的解析器，它不是解析格式良好或有效的 XML，而是解析在野外发现的 HTML：糟糕、肮脏和野蛮，尽管通常很不短。TagSoup 是为那些必须使用某种看似合理的应用程序设计来处理这些东西的人设计的。通过提供 SAX 接口，它允许将标准 XML 工具应用于甚至最糟糕的 HTML。TagSoup 还包括一个命令行处理器，它可以读取 HTML 文件，并且可以生成干净的 HTML 或与 XHTML 非常接近的格式良好的 XML。
    [Taggle](http://www.jezuk.co.uk/arabica/log?id=3591)是 TagSoup 的商业 C++ 端口。

2.  [**SgmlReader**](http://code.msdn.microsoft.com/SgmlReader)是微软的[**Chris Lovett**](http://www.lovettsoftware.com/)开发的一个工具。
    SgmlReader 是任何 SGML 文档（包括对 HTML 的内置支持）的 XmlReader API。还提供了一个命令行实用程序，用于输出格式良好的 XML 结果。
    下载包含独立可执行文件和完整源代码的 zip 文件： [**SgmlReader.zip**](http://code.msdn.microsoft.com/SgmlReader/Release/ProjectReleases.aspx?)

3.  一项杰出的成就是由[**David Carlisle**](http://dpcarlisle.blogspot.com/)编写[**的纯 XSLT 2.0 HTML 解析器**](http://www.dcarlisle.demon.co.uk/htmlparse.xsl)。[](http://dpcarlisle.blogspot.com/)

 **阅读它的代码对我们每个人来说都是一个很好的学习练习。

从描述：

" *d:htmlparse(string)
 d:htmlparse(string,namespace,html-mode)

  单参数形式等价于)
  d:htmlparse(string,' [http://ww.w3.org/1999/xhtml](http://ww.w3.org/1999/xhtml) ',true ()))

  使用一些内置的启发式将字符串解析为 HTML 和/或 XML 以)
  控制元素的隐含打开和关闭。

  它不具备 HTML DTD 的完整知识，但具有
  空元素的完整列表和实体的完整列表定义。HTML 实体，以及
  十进制和十六进制字符引用都被接受。注意
  ，即使 html-mode=false()，html-entities 也会被识别。

  元素名称是小写的（如果 html-mode 为 true()）并放入
  由命名空间参数指定的命名空间（可能是“”以表示
  无命名空间，除非输入有明确的命名空间声明，在
  这种情况下，这些将被尊重。

  如果 html-mode=true()，属性名称将小写*“

[**在此处**](http://www.dcarlisle.demon.co.uk/htmlparse.xsl)阅读更详细的说明。

希望这有帮助。

干杯，

迪米特雷·诺瓦切夫。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T22:02:01.790

我同意 Chris Lively 的观点，因为 HTML 通常不是很好的格式，你可能最好使用正则表达式。

```
href=[\"\'](http:\/\/|\.\/|\/)?\w+(\.\w+)*(\/\w+(\.\w+)?)*(\/|\?\w*=\w*(&\w*=\w*)*)?[\"\'] 
```

从[这里](http://regexlib.com/REDetails.aspx?regexp_id=646)开始 RegExLib 应该让你开始

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T21:56:26.217

如果您知道或可以将文档修复为至少格式正确，那么您可能会更幸运地使用 xml。如果你有*好的*html（或者更确切地说，xhtml），.Net 中的 xml 系统应该能够处理它。不幸的是，好的 html 是极其罕见的。

另一方面，正则表达式在解析 html方面*确实很糟糕。*幸运的是，您不需要处理完整的 html 规范。您需要担心的是解析`href=`字符串以获取 url。即使这可能很棘手，所以我不会马上尝试。相反，我将首先提出一些问题，以尝试建立一些基本规则。它们基本上都归结为“您对文档了解多少？”，但这里是：

*   你知道“href”文本是否总是小写吗？
*   你知道它是否总是在 url 周围使用双引号、单引号或什么都不用？
*   它是否始终是一个有效的 URL，或者您是否需要考虑诸如“#”、javascript 语句之类的内容？
*   是否可以使用内容描述 html 功能的文档（IE：`href=`也可以在文档中并且不属于锚标记）？
*   关于该文件，您还能告诉我们什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-08T22:13:52.307

我在这里链接了一些代码，可以让您使用“LINQ to HTML”...

[寻找 C# HTML 解析器](https://stackoverflow.com/questions/100358/looking-for-c-html-parser/624410#624410)

# windows-xp - 如何在没有VB的情况下制作样机截图

> ID：300254
> 
> 赞同：6
> 
> 时间：2008-11-18T21:47:54.953
> 
> 标签：windows-xp, mockups

我正在寻找一个程序来制作模型截图。我首先发现我可以使用来自[joelonsoftware.com](http://www.joelonsoftware.com/articles/fog0000000033.html)的 Visual Basic（我还没有听说过一种编程语言被称为丑陋的名字）来做到这一点。我现在不想开始学习VB，尤其是因为我还在学习Java。然后我找到[了 mockupscreens.com](http://www.mockupscreens.com)，搜索字符串为“如何制作模型截图”。但鉴于我将很少使用这个程序，我不认为为此支付 80 美元是值得的。

我想做的模型主要用于 Windows XP（也许也用于 GNOME、KDE ​​和 Mac OSX，但这些不是最优先的）。

编辑：建议使用 Balsamiq，但这也是一个非免费程序。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-18T21:53:41.183

[香脂](http://www.balsamiq.com/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-18T22:06:44.307

Visio 运行良好，如果你有的话。

就个人而言，我喜欢纸和笔。然后我就不能沉迷于它的外观，而更多地关注可用性和功能。与网站相同。

一旦您将表格放在客户面前，您的移动空间就为零 - 如果您没有提供像素完美的表格，他们会......生气。:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-18T21:53:53.290

您无需学习使用 Visual Studio 中的可视化表单设计器创建模型的语言。此外， Visual Studio[速成版](http://www.microsoft.com/express/)可免费提供多种语言版本，即 VB、C# 和 C++。任你选。所有这些都带有相同的表单设计器，可以用其中一种语言生成后端代码。但是，如果您只需要设计器，则代码可能与您无关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T21:53:28.110

为此，Microsoft Visio 曾经附带一个包含常用 Windows UI 元素的模板。我不知道它是否仍然存在。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-18T22:20:12.800

[Jeff Attwood 在 CodingHorror 上发布了有关此内容的信息](http://www.codinghorror.com/blog/archives/001091.html)- 他提到了[Powerpoint 原型设计](http://blogs.msdn.com/jensenh/archive/2006/01/06/510069.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T22:32:53.960

笔和纸，或者如果可能的话，白板。一旦你有一些你个人认为可以工作的东西，我会尽可能地选择一个粗糙的计算机模型，这样你就不会在工作流程等完成之前花时间同意字体大小。我在这里使用的工具是我的 Visual Studio 视觉设计器（截图看起来不太好，只能传达您想要构建的内容）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-18T22:13:19.070

正如建议的那样，C# Express 很适合这个，就像 VB 一样，它有一个 GUI 设计器，但它在语法上也类似于 Java，所以 - 考虑到你正在尝试学习和做的事情，它可能是一个不错的选择.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-18T22:46:15.790

[铅笔](http://www.evolus.vn/Pencil/Screenshots.html) （在 Firefox 中运行）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-05-27T07:14:34.640

这里有一个非常详尽的列表：http: //c2.com/cgi/wiki? [GuiPrototypingTools](http://c2.com/cgi/wiki?GuiPrototypingTools)

重要的一点是该工具是否具有用于您的模型的“黑白”（或“手绘”）皮肤，正如其他人已经评论的那样。许多工具（包括我自己的 MockupScreens）都可以。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-18T22:14:52.933

wxGlade 也可以，而且它是免费软件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-15T22:41:45.953

[http://balsamiq.com/](http://balsamiq.com/)已经提到过，但我想解释一下为什么我喜欢它。它将允许您草绘屏幕截图，它看起来仍然像纸笔版本或白板讨论。

如果您对屏幕截图进行了详细说明，那么客户会认为您已经“完成”并且不明白您花了这么长时间才完成项目的原因。因此，这种“粗略”充当了另一层抽象。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-05-18T00:21:47.763

[MockupUI](http://mockupui.com/examples/)是另一个，但它的模型看起来不像手绘。它们看起来像真实的东西并带有真实的数据。它允许您绘制线框以及从您的操作系统配置（也称为 Windows 视觉样式）继承其外观的本机小部件。

关于高保真模型：只要您在项目的设计规范阶段（即开始编码之前）进行模型，客户认为它“已经完成”的风险就很小。相反，草图可能对客户来说太抽象而无法消化，除非他也是一名软件设计师。草图是给开发者而不是客户的。

线框（或草图）和模型不是一回事，它们有不同的用途。一个是解释功能，另一个是产品外观的表示。查看 Yisela 关于[线框和模型之间区别](https://graphicdesign.stackexchange.com/questions/30860/what-is-the-difference-between-wireframes-and-mockups)的帖子。

你的问题是关于样机截图软件，但你最终购买了一个非常强大的线框图软件。

# wpf - 如何将 UserControl 中的控件设为私有？

> ID：300255
> 
> 赞同：32
> 
> 时间：2008-11-18T21:48:10.837
> 
> 标签：wpf, user-controls, access-modifiers

我有一个带有组合框和文本框的用户控件。一切都很好，除了我注意到从我的用户控件的实例对象中，我可以访问这两个控件。除非通过我自己的公开属性，否则它们不应该是可访问的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-18T21:56:18.650

您可以在控件上使用[x:FieldModifier 属性](http://msdn.microsoft.com/en-us/library/aa970905.aspx)，因此：

```
<TextBox x:Name="textBox1" x:FieldModifier="private" /> 
```

有趣的是，x:FieldModifier 的 MSDN 页面并没有将“private”作为属性的有效值，但我已经对其进行了测试并且它可以工作。

# php - 当我尝试“回显” html 字符串时，如何获得这些奇怪的字符？

> ID：300259
> 
> 赞同：0
> 
> 时间：2008-11-18T21:49:06.357
> 
> 标签：php, html, echo, character

我正在通过 PHP 从包含 HTML 代码的变量将回显发送到邮件函数。奇怪的是，这

```
<����}im� 
```

出现在字符串之后..但我不再使用它了。邮件功能（附件）的字符集与 HTML 代码的字符集相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T21:51:45.367

编码问题，也许它试图显示二进制代码？

如果你想显示 HTML，你应该使用 htmlentities

> // 输出：'quote' 是
> 
> <b>粗体</b>回显
> 
> htmlentities($str);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T21:52:33.620

这些字符可能是字符串中的“垃圾”数据。根据字符串的来源，这些字符可能是：HTML 页面之后的套接字中的额外 TCP 数据，或者 HTML 页面之后的文件中的额外数据，或者其他人实际上将这些字符放在他们的 HTML 页面中（可能是他们的文件被意外损坏或出于其他原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T02:49:44.113

您可以考虑使用[htmlMimeMail](http://www.phpguru.org/static/mime.mail.html)类来处理电子邮件。所以你可以避免讨厌的电子邮件内部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T17:12:31.313

这就是我遇到的问题..我使用来自 Internet 源的代码，$body 是生成发票并发送电子邮件..这些字符位于 HTML 源文件的末尾，但我不明白为什么它们是那里 ：（

```
$to = 'email@email.com';
$subject = 'Invoice';
$random_hash = md5(date('r', time()));
$headers = "From: mymail@mymail.com\r\nReply-To: webmaster@example.com";
$headers .= "\r\nContent-Type: multipart/mixed; boundary=\"PHP-mixed-".$random_hash."\"";
$body=rtrim(chunk_split(base64_encode($body))); 
//define the body of the message.
ob_start(); //Turn on output buffering
?>
--PHP-mixed-<?php echo $random_hash; ?> 
Content-Type: multipart/alternative; boundary="PHP-alt-<?php echo $random_hash; ?>"

--PHP-alt-<?php echo $random_hash; ?> 
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 7bit

Hello World!!!
This is simple text email message.

--PHP-alt-<?php echo $random_hash; ?> 
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: 7bit

Text Emailu.

--PHP-alt-<?php echo $random_hash; ?>--

--PHP-mixed-<?php echo $random_hash; ?> 
Content-Type: text/html; charset="UTF-8"; name="faktura.html" 
Content-Transfer-Encoding: base64 
Content-Disposition: attachment 

<?php echo htmlentities($body); ?>
--PHP-mixed-<?php echo $random_hash; ?>--

<?php
//copy current buffer contents into $message variable and delete current output buffer
$message = ob_get_clean();
//send the email
$mail_sent = @mail( $to, $subject, $message, $headers ); 
```

# .net - .net 2.0 安全配置

> ID：300268
> 
> 赞同：3
> 
> 时间：2008-11-18T21:52:00.330
> 
> 标签：.net, security, .net-2.0

是否有一些帮助资源，或者任何人都可以给我一个简短的想法，我将如何为以下场景配置 .net 2 运行时安全策略：

我在 IE 中托管了一个 Windows 窗体控件。控件尝试从串行端口读取并写入事件日志。由于浏览器中的安全限制，这两个操作都失败了：

请求“System.Security.Permissions.SecurityPermission,mscorlib, Version=2.0.0.0, Culture=neutral,PublicKeyToken=b77a5c561934e089 类型的权限失败。

请求“System.Diagnostics.EventLogPermission,System, Version=2.0.0.0, Culture=neutral,PublicKeyToken=b77a5c561934e089 类型的权限失败。

我已通过将我的网站添加到 IE 中完全受信任的网站列表中，将我的网站设置为完全受信任，但我仍然遇到问题。我很确定答案在 .net 2.0 配置中的运行时安全策略中，但我只是不知道要更改什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:07:10.343

尝试以下操作：

控制面板 -> 管理工具 -> Microsoft .NET Framework 2.0 配置

展开并选择：

.Net Framework 2.0 配置 -> MyComputer -> 运行时安全策略 -> 机器 -> 代码组 -> All_Code

在这之下有不同的区域。我不确定哪一个适用于 IE 和您的场景，但请尝试对它们中的每一个进行以下操作（请记住在测试后将它们重新设置）

右键单击“??????_Zone”选择“权限集”选项卡将“权限集”组合更改为“完全信任”

“会员权限”选项卡也可能会提供一些线索来判断哪个是正确的。

[代码访问安全](http://www.emmet-gray.com/Articles/CodeAccessSecurity.htm)信息

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-18T21:59:43.277

由于（我假设）您在 IIS 下运行，因此您需要确保您的 I_USRmachinename 帐户位于具有所需权限的安全组中，或者它不在像“Guests”这样的组中访问系统事件日志等内容。查看您尝试运行的系统上的 I_USR、I_WAM 和 ASP.NET 帐户的权限/组。我认为这就是你的问题所在。

# entity-framework - 实体框架和水晶报表

> ID：300284
> 
> 赞同：4
> 
> 时间：2008-11-18T21:57:39.553
> 
> 标签：entity-framework, crystal-reports

据我了解，水晶报表可以使用EntityFramework，对吗？

我宁愿使用实体框架而不是使用数据集。

我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T22:48:00.350

Crystal 报表支持 .net 对象。因此，您可以将实体框架对象的 ienumerable 传递给报表而不是数据集。

# c# - 构造函数注入和默认重载

> ID：300286
> 
> 赞同：6
> 
> 时间：2008-11-18T21:58:01.503
> 
> 标签：c#, .net, dependency-injection

假设我们有

```
public interface ITimestampProvider
{
    DateTime GetTimestamp();
} 
```

和一个消耗它的类

```
public class Timestamped
{
    private ITimestampProvider _timestampProvider

    public Timestamped(ITimestampProvider timestampProvider)
    {
        // arg null check

        _timestampProvider = timestampProvider;
    }

    public DateTime Timestamp { get; private set; }

    public void Stamp()
    {
        this.Timestamp = _timestampProvider.GetTimestamp();
    }
} 
```

和一个默认实现：

```
public sealed class SystemTimestampProvider : ITimestampProvider
{
    public DateTime GetTimestamp()
    {
        return DateTime.Now;
    }
} 
```

引入这个构造函数是有帮助还是有害？

```
public Timestamped() : this(new SystemTimestampProvider())
{} 
```

这是一个普遍的问题，即时间戳不是有趣的部分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T22:35:18.120

我认为这取决于场景，并且基本上是代码的使用者（库与应用程序）以及您是否使用 IoC 容器的函数。

*   如果您使用的是 IoC 容器，并且这不是公共 API 的一部分，那么让容器完成繁重的工作，并且只使用单个构造函数。添加无参数构造函数只会使事情变得混乱，因为您永远不会使用它。

*   如果这是公共 API 的一部分，则保留两者。如果您使用 IoC，只需确保您的 IoC 找到“最贪婪”的构造函数（具有最多参数的构造函数）。不使用 IoC，但使用您的 API 的人会喜欢不必为了使用您的对象而构建整个依赖关系图。

*   如果您不使用 IoC 容器，而只是想使用模拟进行单元测试，请保留无参数构造函数，并将贪婪构造函数设为内部。为您的单元测试程序集添加 InternalsVisibleTo ，以便它可以使用贪婪构造函数。如果您只是单元测试，那么您不需要额外的公共 API 表面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T22:03:42.287

我不会提供那个构造函数。当您的 IoC 可能配置为使用 OtherTimestampProvider() 时，这样做会使调用 new TimeStamped 并使用 new SystemTimestampProvider() 获取实例变得非常容易。

一天结束时，您将花费大量时间尝试调试为什么您得到错误的时间戳。

如果您只提供第一个构造函数，您可以简单地查找 SystemTimestampProvider 的用法，以找出谁（错误地）使用该提供程序而不是 IoC 配置的提供程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T22:04:09.757

一般来说，我不这么认为......这取决于您使用依赖注入的目的。当我使用 DI 进行单元测试时，我通过在注入的实例为空时实例化依赖对象的生产版本来做同样的事情（或多或少）......然后我有一个不带参数和委托的重载到那个……我将无参数的用于生产代码，并为单元测试方法注入测试版本……

如果您在谈论 IOC 容器应用程序，otoh，您需要小心干预配置设置告诉容器以不清楚的方式执行的操作......

```
 public class EventsLogic
   { 
       private readonly IEventDAL ievtDal;
       public IEventDAL IEventDAL { get { return ievtDal; } }

       public EventsLogic(): this(null) {}
       public EventsLogic(IIEEWSDAL wsDal, IEventDAL evtDal)
       {
          ievtDal = evtDal ?? new EventDAL();
       }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T22:08:15.240

我尽量避免这种情况——在一些地方我发现它是一个有用的设计，但我发现它常常会导致我犯错误，这可能会让我有些困惑。

通过使用依赖注入容器（我使用 StructureMap）来管理所有这些连接，大大减少了对默认注入对象的需求——DI 容器确保您始终获得可以使用的具体实例。

我仍然想使用您建议的构造函数的唯一地方是在我的单元测试中，但最近我从使用假对象或模拟对象中获得了更大的价值。

有些地方拥有默认的依赖对象是正确且有用的设计，但总的来说，我会说您只是引入了紧密耦合，不会增加很多价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T22:08:40.483

它既无用也无害。它提出了一个美学问题，因为只有当您的设计允许属性设置器注入时，您才将 DI 限制为构造函数注入。

另一种选择是实现一个返回默认实现的getter：

```
public DateTime Timestamp
{
    get { return _timestampProvider??new SystemTimestampProvider(); }
    set { _timestampProvider = value; }
} 
```

或者，如果您担心在堆中创建太多对象，则可以使用单例实现上述操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T23:01:56.147

我的团队使用这种方法取得了很大的成功。我建议进行一项更改：
将 _timestampProvider 设为只读。这迫使提供者在构建时具有确定性，并将消除错误。

```
public class Timestamped
{
    private readonly ITimestampProvider _timestampProvider;

    public Timestamped(ITimestampProvider timestampProvider)
    {
        _timestampProvider = timestampProvider;
    }

    public Timestamped(): this(new SystemTimestampProvider())
    { }
} 
```

也就是说，我们*一直*在研究新技术，包括 DI 框架。如果我们为了更好的东西而放弃这种技术，我会告诉你的。

# networking - 使用状态机的网络服务器/客户端的通用架构

> ID：300289
> 
> 赞同：3
> 
> 时间：2008-11-18T21:59:34.417
> 
> 标签：networking, client-server, tcp, state-machine

全部，

所以，我~~发明~~了一个简单的协议，我想用它来让客户端与服务器交谈。这是典型的（我认为）三相布局：

*   连接建立（最终将包括能力协商）
*   实际数据交换 - 数据包愉快地来回传输'，由相应的接收器解释，并相应地作用于它们
*   Connection Teardown - 一方说“不想再”，另一方说“就这样吧”（最终将允许另一方发送一些数据直到完成，而不是简单地关闭对话）

该框架是一个简单的设置：服务器执行 java.net.ServerSocket.accept() 并启动一个线程来处理客户端的传入连接，该客户端创建一个 java.net.Socket() 到服务器所在的主机/端口在等待。双方使用 java.io.InputStream 和 java.io.OutputStream 并互相喷出数据，组装传出和解析传入的消息。很好，到目前为止。

到目前为止，该协议是硬编码的。连接建立和拆除几乎没问题，而数据交换部分——我想是全双工的——几乎是一团糟。

所以，我想，让我们做一个好方法，并使用同名的设计模式来设置状态机。我非常清楚服务器和客户端的状态分别应该是什么，发生转换应该发生什么样的事件，以及发生转换时应该采取什么行动。这看起来*不错*——在纸面上，就是这样。在实践中，我遇到了几个我无法在纸上解决的问题。

特别是，状态机的输入......有点多样化。我怎么可能同时写入数据、读取数据和检查连接（它可能已关闭或已断开）？此外，第 1 和第 3 阶段应该设置计时器，以避免潜在的无限等待答案的时间。

因此，我将不胜感激任何可以弥合理论状态机和代码状态机之间差距的帮助。

顺便说一句，我也可以阅读 C/C++/C# - 无需翻译成 Java（这是我正在使用的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T22:10:22.290

您的机器的状态需要按“连接”存储

每个连接的客户端可能处于不同的状态。因此，如果您有一个对象跟踪您的状态，那么每个连接都会有一个该对象的实例。

如果您有兴趣，我实际上写了一个小库，它从状态机中抽象出几乎所有内容。那里还有一些测试代码应该向您展示如何工作。 [状态机代码](http://code.google.com/p/state-machine/)

它做了一些你可能会忘记的事情，比如确保不是“有效”的状态转换实际上是一个错误而不是可能被遗漏，并且记录状态转换是免费的。

附言。（任何人）如果你看到它并且不喜欢它——请告诉我为什么。我想让它对任何人都可用。

# c# - 从容器应用程序在嵌入式浏览器中启动脚本

> ID：300298
> 
> 赞同：0
> 
> 时间：2008-11-18T22:02:08.403
> 
> 标签：c#, .net, internet-explorer

如果我有一个 Windows 窗体中的嵌入式浏览器，是否可以从容器应用程序启动 javascript 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:04:54.687

您可以使用 Document.InvokeScript，如这篇出色的 MSDN 文章中所述：

[如何：在 DHTML 代码和客户端应用程序代码之间实现双向通信](http://msdn.microsoft.com/en-us/library/a0746166(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T22:06:37.663

就在这里..

```
webBrowser.Document.InvokeScript("doSomething()"); 
```

# ruby-on-rails - Rails：整洁的样式表

> ID：300299
> 
> 赞同：0
> 
> 时间：2008-11-18T22:02:35.253
> 
> 标签：ruby-on-rails, stylesheet

任何人都知道如何采用[本](http://the-banana-peel.saltybanana.com/2008/06/tidy-stylesheets-take-two.html)教程中提到的很棒的方法并使用**绝对 URL**生成样式表标签吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T21:54:08.373

弄清楚了。

在 application_helper.rb 的内容中：

```
def get_stylesheets
  stylesheets = [] unless stylesheets
  ["http://www.example.com/stylesheets/#{controller.controller_path}/#{controller.action_name}"].each do |ss|
    stylesheets << ss if File.exists? "#{Dir.pwd}/public/stylesheets/#{ss}.css"
  end
end 
```

像宣传的那样工作。好的！

多年来我一直想这样做 - 现在感谢 Rails，我可以！呜呼！

# javascript - 如何在放置事件中获取可拖动的容器？

> ID：300303
> 
> 赞同：1
> 
> 时间：2008-11-18T22:03:49.977
> 
> 标签：javascript, jquery, dom

我有一个这样的html：

```
<div id="container1">
    <div class="dragme">drag me</div>
</div>
<div id="container2">
    <div class="dragme">drag me</div>
</div>
<div id="droponme"></div>

$(".dragme").draggable();
$("#droponme").droppable({
    accept: ".dragme",
    drop: function(e, u) { alert( /* find id of the container here*/ ); };
}); 
```

我想在放置事件处理程序上找到可拖动对象的容器。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T22:22:47.100

```
$(".dragme").draggable();
$("#droponme").droppable({
    accept: ".dragme",
    drop: function(e, u) {
        alert(u.draggable.parent().attr('id') );
        // in your example: container1 or container2
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T14:43:50.417

这是获取可放置容器的另一种形式：

```
$(".dragme").draggable();
$("#droponme").droppable({
    accept: ".dragme",
    drop: function(e, u) {
        alert(e.toElement);
    }
}); 
```

# javascript - 如何在 Dojo 中执行 JS XHR 响应？

> ID：300306
> 
> 赞同：1
> 
> 时间：2008-11-18T22:04:19.727
> 
> 标签：javascript, jquery, dojo

我正在寻找的东西在 jQuery 中看起来像这样：

```
jQuery.ajaxSetup({
  'beforeSend': function(xhr) {
    xhr.setRequestHeader("Accept", "text/javascript");
  }
});
...
$("#my_form").submit({
  $.post($(this).attr("action", $(this).serialize(), null, "script");
  return false;
}); 
```

然后，当我的服务器返回一些 Javascript（Accept-header 位）时，jQuery 会执行它（最后一个“脚本”参数）。

我试图在 Dojo 中获得相同的效果。我最好的猜测是：

```
form = dojo.byId("my_form")
form.onsubmit = function() {
  dojo.xhrGet({
    url: form.action,
    form: form,
    handleAs: "javascript"
  })
} 
```

`handleAs: "javascript"`应该会导致 Dojo 以 JS 的形式执行响应。我的问题是我不知道如何设置标头，以便我的 Web 服务器（`respond_to do |format|`Rails 中的一个块）知道要返回什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T23:00:23.577

我相信答案是：

```
form = dojo.byId("my_form")
  form.onsubmit = function() {
  dojo.xhrGet({
    url: form.action,
    form: form,
    handleAs: "javascript",
    headers: { "Accept": "text/javascript" }
  })
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T22:20:18.417

我自己不确定dojo，但我知道phiggins（lead dojo dev）在freenode irc上的#dojo频道上可用，也就是说，如果没有其他人可以给你答案。

# linq - Linq to SQL 和实体框架的区别？

> ID：300314
> 
> 赞同：5
> 
> 时间：2008-11-18T22:07:48.283
> 
> 标签：linq, linq-to-sql, entity-framework

假设我使用 SQL Server 作为我的数据库，这两者之间有什么区别？他们是一样的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T22:32:30.247

这篇[文章](http://blogs.microsoft.co.il/blogs/sasha/archive/2008/07/01/linq-to-sql-more-useful-than-you-d-think.aspx)指出了一些信息。特别是3个主要区别：

*   能够查询 Microsoft SQL Server 以外的关系存储

*   不限于 LINQ 语言支持的全文查询语言

*   高级映射工具，例如将单个类映射到多个表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T22:27:20.087

长答案：谷歌。简短的回答：使用实体框架，您将能够基于类似于域对象的类（部分，您可以“扩展”）创建一些东西（虽然不是真正的 DDD，这就是 NHibernate 仍然存在并且正在开发 linq to nhibernate 的原因），使用 sql 你只会想到数据库和表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T02:34:29.227

Roger Jennings 于 2008 年 12 月出版的 Visual Studio Magazine 封面故事是关于该主题的好读物，其中有一些 L2S 与 EF 的并排比较：

[http://visualstudiomagazine.com/features/article.aspx?editorialsid=2583](http://visualstudiomagazine.com/features/article.aspx?editorialsid=2583)

# css - 有没有办法强制 IE 或 FF 进入手持模式以测试“@media 手持”样式表？

> ID：300315
> 
> 赞同：3
> 
> 时间：2008-11-18T22:07:49.687
> 
> 标签：css, internet-explorer, firefox, testing, handheld

有没有办法强制 IE 或 FF 进入手持模式以测试“@media 手持”样式表？

或者，我是否必须发布页面并使用我的 Blackberry 进行测试？

我更愿意在不将应用程序推送到实时服务器的情况下对此进行测试，因为该应用程序已经在使用中。

对我有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-25T19:23:05.840

FF 的 Web 开发人员工具栏可让您测试网页 media=handheld

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-15T15:35:59.627

[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)有一种简单的方法：

```
@media handheld, screen and (max-width: 500px) { /* your css */ } 
```

当您将窗口大小调整为小于 500 像素时，这将使实现媒体查询的浏览器使用您的手持 CSS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T22:10:05.237

关于这个问题的一些帮助： [你用什么来测试你网站上的手持 css？](https://stackoverflow.com/questions/259330/what-do-you-use-to-test-the-handheld-css-on-your-website)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T23:09:30.267

我发现黑莓浏览器完全坏了，在 Firefox 甚至 IE 中进行测试没有任何意义。Netscape 4 似乎是最接近的。

如果你想在BB上获得体面的体验，那么你必须得到一个BB模拟器。它可从 RIM 网站免费获得（您需要点击一些表格）。

如果您只想在移动浏览器下进行测试，则可以尝试*在线*[Opera Mini 模拟器](http://operamini.com/demo)或[小屏幕视图中的桌面 Opera](http://www.opera.com/download/index.dml?custom=yes)（如果您想要与今天在智能手机上使用的引擎完全相同，请从存档中获取版本 7.6 或 8.0）。

或者添加`html {max-width:240px}`到您的样式中并使用`media=screen`而不是`handheld`.

# java - Java 并发场景——我是否需要同步？

> ID：300316
> 
> 赞同：16
> 
> 时间：2008-11-18T22:07:54.320
> 
> 标签：java, concurrency

这是交易。我有一个包含我称之为“程序代码”的数据的哈希映射，它存在于一个对象中，如下所示：

```
Class Metadata
{
    private HashMap validProgramCodes;
    public HashMap getValidProgramCodes() { return validProgramCodes; }
    public void setValidProgramCodes(HashMap h) { validProgramCodes = h; }
} 
```

我有很多很多阅读器线程，每个阅读器线程都会调用一次 getValidProgramCodes() ，然后将该哈希图用作只读资源。

到目前为止，一切都很好。这就是我们变得有趣的地方。

我想放入一个计时器，它每隔一段时间会生成一个新的有效程序代码列表（不管如何），并调用 setValidProgramCodes。

我的理论——我需要帮助来验证——是我可以继续按原样使用代码，而无需进行显式同步。它是这样的：在更新 validProgramCodes 时，validProgramCodes 的值总是好的——它是指向新哈希图或旧哈希图的指针。 *这是一切都取决于的假设。* 拥有旧 hashmap 的读者是可以的；他可以继续使用旧值，因为在他释放它之前不会被垃圾收集。每个读者都是短暂的；它很快就会死去，并被一个新的取而代之的人取代，后者将获得新的价值。

这个有水吗？我的主要目标是在绝大多数没有更新发生的情况下避免代价高昂的同步和阻塞。我们每小时只更新一次左右，读者不断地进进出出。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-18T22:14:56.850

## 使用易失性

这是一个线程关心另一个线程在做什么的情况吗？那么[JMM FAQ](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#reordering)有答案：

> 大多数时候，一个线程并不关心另一个线程在做什么。但是当它发生时，这就是同步的目的。

作为对那些说 OP 的代码是安全的人的回应，请考虑一下：Java 的内存模型中没有任何内容可以保证在启动新线程时该字段将被刷新到主内存。此外，只要在线程中无法检测到更改，JVM 就可以自由地重新排序操作。

从理论上讲，不能保证读取器线程看到“写入”到 validProgramCodes。在实践中，他们最终会，但你不能确定什么时候。

我建议将 validProgramCodes 成员声明为“volatile”。速度差异可以忽略不计，并且无论现在和将来可能引入何种 JVM 优化，都可以保证代码的安全性。

这是一个具体的建议：

```
import java.util.Collections;

class Metadata {

    private volatile Map validProgramCodes = Collections.emptyMap();

    public Map getValidProgramCodes() { 
      return validProgramCodes; 
    }

    public void setValidProgramCodes(Map h) { 
      if (h == null)
        throw new NullPointerException("validProgramCodes == null");
      validProgramCodes = Collections.unmodifiableMap(new HashMap(h));
    }

} 
```

## 不变性

除了用 包裹它之外`unmodifiableMap`，我还复制了地图 ( `new HashMap(h)`)。即使 setter 的调用者继续更新映射“h”，这也会生成一个不会更改的快照。例如，他们可能会清除地图并添加新条目。

## 依赖接口

`List`从风格上讲，通常最好使用像and这样的抽象类型来声明 API `Map`，而不是像`ArrayList`and`HashMap.`这样的具体类型。如果具体类型需要更改（就像我在这里所做的那样），这在未来提供了灵活性。

## 缓存

将“h”分配给“validProgramCodes”的结果可能只是对处理器缓存的写入。即使新线程启动，“h”对新线程也不会可见，除非它已被刷新到共享内存。一个好的运行时会避免刷新，除非它是必要的，而 using`volatile`是表明它是必要的一种方式。

## 重新排序

假设以下代码：

```
HashMap codes = new HashMap();
codes.putAll(source);
meta.setValidProgramCodes(codes); 
```

如果`setValidCodes`只是 OP's `validProgramCodes = h;`，编译器可以自由地重新排序代码，如下所示：

```
 1: meta.validProgramCodes = codes = new HashMap();
 2: codes.putAll(source); 
```

假设在编写器第 1 行执行后，读取器线程开始运行以下代码：

```
 1: Map codes = meta.getValidProgramCodes();
 2: Iterator i = codes.entrySet().iterator();
 3: while (i.hasNext()) {
 4:   Map.Entry e = (Map.Entry) i.next();
 5:   // Do something with e.
 6: } 
```

现在假设编写器线程在读取器的第 2 行和第 3 行之间的映射上调用“putAll”。Iterator 底层的映射经历了并发修改，并抛出了运行时异常——一个极其间歇的、看似莫名其妙的运行时异常，从来没有测试过程中产生。

## 并发编程

任何时候你有一个线程关心另一个线程在做什么，你*必须*有某种内存屏障来确保一个线程的操作对另一个线程是可见的。如果一个线程中的事件必须在另一个线程中的事件之前发生，则*必须*明确指出。否则无法保证。在实践中，这意味着`volatile`或`synchronized`。

不要吝啬。不正确的程序无法完成其工作的速度并不重要。此处显示的示例简单且做作，但请放心，它们说明了现实世界的并发错误，由于其不可预测性和平台敏感性，这些错误非常难以识别和解决。

## 其他资源

*   Java 语言规范 - [17 线程和锁](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html)部分：[§17.3](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html#17.3)和[§17.4](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html#17.4)
*   [JMM 常见问题解答](http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html#reordering)
*   [Doug Lea 的](http://g.oswego.edu/)并发书籍

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-20T07:23:56.023

不，代码示例不安全，因为没有任何新 HashMap 实例的**安全发布**。如果没有任何同步，读取器线程可能会看到*部分初始化*的HashMap。

在他的回答中查看@erickson 在“重新排序”下的解释。此外，我不能推荐 Brian Goetz 的[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)一书！

读者线程可能会看到旧的（陈旧的）HashMap 引用，或者甚至可能永远不会看到新的引用，这对您来说是无关紧要的。可能发生的最糟糕的事情是读取器线程可能会获取对尚未初始化且尚未准备好访问的 HashMap 实例的引用并尝试访问该实例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T15:44:48.260

正如其他人已经指出的那样，这是不安全的，您不应该这样做。您需要在此处使用 volatile 或 synchronized 来强制其他线程看到更改。

没有提到的是 synchronized 尤其是 volatile 可能比您想象的要快得多。如果它实际上是您的应用程序的性能瓶颈，那么我会吃掉这个网页。

另一种选择（可能比 volatile 慢，但 YMMV）是使用 ReentrantReadWriteLock 来保护访问，以便多个并发读者可以读取它。如果这仍然是性能瓶颈，我会吃掉整个网站。

```
 public class Metadata
  {
    private HashMap validProgramCodes;
    private ReadWriteLock lock = new ReentrantReadWriteLock();

    public HashMap getValidProgramCodes() { 
      lock.readLock().lock();
      try {
        return validProgramCodes; 
      } finally {
        lock.readLock().unlock();
      }
    }

    public void setValidProgramCodes(HashMap h) { 
      lock.writeLock().lock();
      try {
        validProgramCodes = h; 
      } finally {
        lock.writeLock().unlock();
      }
    }
  } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T15:09:30.530

不，根据 Java 内存模型 (JMM)，这不是线程安全的。

写入和读取实现对象之间没有*发生之前的*关系。`HashMap`因此，虽然写线程似乎先写出对象，然后再写出引用，但读线程可能不会看到相同的顺序。

如前所述，不能保证真正的线程会看到新值。在现有硬件上的当前编译器的实践中，值应该得到更新，除非循环体足够小以至于可以充分内联。

因此，`volatile`在新的 JMM 下进行参考就足够了。它不太可能对系统性能产生重大影响。

这个故事的寓意：穿线很困难。不要试图变得聪明，因为有时（可能不在你的测试系统上）你不够聪明。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-18T22:23:10.717

我认为你的假设是正确的。我唯一要做的就是设置`validProgramCodes`易失性。

```
private volatile HashMap validProgramCodes; 
```

这样，当您更新“指针”时，`validProgramCodes`您可以保证所有线程都访问相同的最新`HasMap`“指针”，因为它们不依赖本地线程缓存并直接进入内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T22:18:15.313

只要您不担心读取过时的值，并且只要您可以保证在初始化时正确填充哈希图，该分配就可以工作。您至少应该在 Hashmap 上使用 Collections.unmodifiableMap 创建 hashMap，以确保您的读者不会从映射中更改/删除对象，并避免多个线程相互踩踏并在其他线程销毁时使迭代器无效。

（上面的作者对易失性的看法是正确的，应该已经看到了）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-21T13:45:39.360

虽然这不是这个特定问题的最佳解决方案（埃里克森的新 unmodifiableMap 想法是），但我想花点时间提一下Java 5 中引入的[java.util.concurrent.ConcurrentHashMap](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)类，特别是 HashMap 的一个版本在考虑并发的情况下构建。此构造不会**阻塞**读取。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-28T11:44:32.313

查看这篇关于并发基础的帖子。它应该能够令人满意地回答您的问题。

[http://walivi.wordpress.com/2013/08/24/concurrency-in-java-a-beginners-introduction/](http://walivi.wordpress.com/2013/08/24/concurrency-in-java-a-beginners-introduction/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-18T22:13:12.860

我认为这是有风险的。线程化会导致各种微妙的问题，调试起来非常痛苦。您可能想查看[`FastHashMap`](http://commons.apache.org/collections/api/org/apache/commons/collections/FastHashMap.html)，它适用于像这样的只读线程情况。

至少，我还要声明`validProgramCodes`这样`volatile`引用不会被优化到寄存器或其他东西中。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-11-18T22:35:51.630

如果我正确阅读了[JLS](http://docs.oracle.com/javase/specs/jls/se5.0/html/j3TOC.html)（没有保证！），对*引用*的访问总是原子的，句号。请参阅[第 17.7 节 double 和 long 的非原子处理](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html#17.7)

因此，如果对引用的访问始终是原子的，并且线程看到的返回的实例无关紧要`Hashmap`，那么您应该没问题。您永远不会看到对引用的部分写入。

* * *

编辑：在查看下面评论和其他答案中的讨论后，这里是来自的参考/引用

[Doug Lea](http://g.oswego.edu/)的书（Java 中的并发编程，第 2 版），第 94 页，第 2.2.7.2 节*可见性*，第 3 项：“

> 线程第一次访问对象的字段时，它会看到该字段的初始值或其他线程写入后的值。”

在页。94，Lea 继续描述与这种方法相关的风险：

> 内存模型保证，给定上述操作的最终发生，一个线程对特定字段进行的特定更新最终将对另一个线程可见。但*最终*可以是任意长的时间。

因此，当它***绝对，肯定地，必须***对任何调用线程可见，`volatile`或者需要一些其他同步屏障时，尤其是在长时间运行的线程或在循环中访问值的线程中（如 Lea 所说）。

***但是***，在存在*短命线程*的情况下，正如问题所暗示的那样，为新读者提供新线程并且*不会影响应用程序读取陈旧数据，**则* 不需要同步***。***

* * *

@ [erickson](https://stackoverflow.com/users/3474/erickson)的答案在这种情况下是最安全的，保证其他线程会在发生`HashMap`引用更改时看到它们。我建议遵循该建议，只是为了避免对要求和实施的混淆，从而导致对该答案和下面的讨论“投反对票”。

我不会删除答案，希望它会有用。我**不是**在寻找“同伴压力”徽章...... ;-)

# javascript - 你把你的javascript放在哪里？

> ID：300321
> 
> 赞同：11
> 
> 时间：2008-11-18T22:08:54.303
> 
> 标签：javascript

您是否将您的 javascript 本地化到页面，或者有一个主“application.js”或类似的？

如果是后者，确保您的 .js 没有在错误页面上执行的最佳做法是什么？

编辑： javascript 我的意思是您作为开发人员编写的自定义 javascript，而不是 js 库。我无法想象有人会将 jQuery 源代码复制/粘贴到他们的页面中，但你永远不知道。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-18T22:22:02.030

将所有 js 放在一个文件中可以提高性能（只有一个请求而不是多个请求）。如果您使用像 Akamai 这样的内容分发网络，它会提高您的缓存命中率。此外，始终将内联 js 放在页面的最底部（就在 body 标记上方），因为它是同步执行的，并且可能会延迟您的页面呈现。

是的，如果您使用的其中一个 js 文件也托管在 google 上，请确保使用该文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T22:28:09.320

这是我的“指导方针”。请注意，这些都不是正式的，它们只是看起来是正确的做法。

所有共享的 JS 代码都位于`SITE/javascripts`目录中，但它是在“层”中加载的

对于站点范围的内容（如 jquery 或我的站点范围的 application.js），站点范围的布局（这将是 ASP.net 中的母版页）包含该文件。标签位于`script`页面顶部。

还有“区域范围”的东西（例如：仅在站点的管理部分需要的 js 代码）。这些区域要么具有共同的布局（然后可以包含脚本标签），要么将呈现共同的部分，并且该部分可以包含脚本标签）

对于共享较少的东西（比如我的库只在几个地方需要），然后我`script`在这些 HTML 页面中分别放置一个标签。脚本标签位于页面顶部。

对于仅与单页相关的内容，我只编写内联 javascript。我尽量让它接近它的“目标”。例如，如果我有一些用于按钮的 onclick js，则`script`标签将位于按钮下方。

对于没有目标的内联 JS（例如：`onload`事件），它位于页面底部。

* * *

那么，某些东西是如何进入本地化库或站点范围的库的呢？

*   第一次需要时，内联写
*   下次需要时，将内联代码拉到本地化库中
*   如果您从（大约）3 个或更多地方引用本地化库中的某些代码，请将代码拉到区域范围的库中
*   如果多个地区需要它，请将其拉​​到站点范围的库中。

对于这样的系统，一个常见的抱怨是，您最终会得到 10 或 20 个小 JS 文件，而从网络的角度来看，2 或 3 个大 JS 文件的性能会更好。但是，rails 和 ASP.NET 都具有处理将多个 JS 文件组合和缓存到一个或多个“超级”js 文件以用于生产情况的功能。

我建议使用这样的功能，而不是损害实际源代码的质量/可读性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T22:46:01.950

[Yahoo! 的 Exceptional Performance Team](http://developer.yahoo.com/performance/)为 JavaScript 提供了一些很棒的性能建议。 [Steve Souders](http://stevesouders.com/)曾经是那个团队的成员（他现在在 Google），他编写了一些[有趣的工具](http://stevesouders.com/cuzillion/)，可以帮助您决定将 JavaScript 放在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T22:45:14.433

我尽量避免将 javascript 函数放在呈现的页面上。一般来说，我有一个具有通用功能（如菜单操作）的 application.js（或 root.js）。如果给定页面具有特定的 javascript 功能，我将创建一个 .js 文件来处理该代码并模仿如何访问该文件的 dir 结构（也使用与呈现文件相同的名称）。

换句话说，如果渲染的页面在 public/dir1/dir2/mypage.html 中，那么 js 文件将在 public/js/dir1/dir2/mypage.js 中。我发现这种风格很适合我，尤其是在网站上做模板时。我构建模板引擎以“自动加载”我的资源（css 和 js），方法是获取请求路径并检查根目录中 css 和 js 目录中的 css 和 js 等效项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T22:14:31.280

就个人而言，我尝试包含几个按模块排序的 Javascript 文件（[就像 YUI 一样](http://developer.yahoo.com/yui/)）。但是偶尔，当我基本上写一个单行字时，我会把它放在页面上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T22:16:17.690

最佳做法可能是将其[放在 Google 的服务器上](http://code.google.com/apis/ajaxlibs/)。

（虽然我想，这取决于你所说的“你的”javascript：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T22:46:10.203

这也是我一直在纠结的事情。我最终使用我的后端 PHP 脚本根据用户请求的内容智能地构建所需的 JS 文件列表。

通过将我的 JS 文件组织到一个存储库中，该存储库包含按目的组织的多个文件（它们是通用的、专注于单个页面、单个部分等），我可以使用在后端构建页面的事件链来有选择地根据需要选择包含哪些 JS 文件（参见下面的示例）。

这是在实现我的 Web 应用程序之后，没有对代码的这方面给予足够的考虑。现在，我还应该补充一点，我使用的 javascript*增强*了但不构成我网站的基础。如果您使用的是 SproutCore 或 Ext 之类的东西，我想解决方案会有所不同。

* * *

下面是一个 PHP 驱动网站的示例： 如果您的网站分为多个部分，其中一个部分是日历。用户导航到“index.phhp?module=calendar&action=view”。如果 PHP 代码是基于类的，则路由算法会实例化 CalendarModule 类，该类基于“模块”并具有虚拟方法“getJavascript”。这将返回在“日历”模块上执行“视图”操作所需的那些 javascript 类。它还可以考虑任何其他特殊要求，并为这些特殊要求返回 js 文件。当为最终页面构建 javascript 包含列表时，渲染代码可以验证没有重复的 js 文件。所以 getJavascript 方法返回一个像这样的数组

```
return array('prototype.js','mycalendar.js'); 
```

请注意，这或某种形式的这并不是一个新想法。但我花了一些时间才认为它足够重要，可以去惹麻烦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T22:58:48.010

如果它只有几百字节或更少，并且不需要在其他任何地方使用，我可能会内联它。另一个 http 请求的网络开销可能会超过将其拉出页面所获得的任何性能提升。

如果需要在几个地方使用它，我会将函数放入一个通用的外部文件中，并根据需要从内联脚本中调用它。

如果您的目标是 iphone，请尝试将您想要缓存的任何内容保持在 25k 以下。

确实没有硬性规定，每种方法都有利有弊，强烈建议您查看可以在 yahoo 开发人员部分找到的文章，以便您可以根据具体情况做出明智的决定。

# .net - 如何在 .NET 中包含多个 Javascript 文件（就像在 rails 中一样）

> ID：300327
> 
> 赞同：8
> 
> 时间：2008-11-18T22:12:07.993
> 
> 标签：.net, javascript, asp.net-mvc, css

我嫉妒铁轨的家伙。他们可以这样做：

```
<%= javascript_include_tag "all_min" %> 
```

...我坚持这样做：

```
<script src="/public/javascript/jquery/jquery.js" type="text/javascript"></script>
<script src="/public/javascript/jquery/jquery.tablesorter.js" type="text/javascript"></script>
<script src="/public/javascript/jquery/jquery.tablehover.pack.js" type="text/javascript"></script>
<script src="/public/javascript/jquery/jquery.validate.js" type="text/javascript"></script>
<script src="/public/javascript/jquery/jquery.form.js" type="text/javascript"></script>
<script src="/public/javascript/jquery/application.js" type="text/javascript"></script> 
```

是否有任何库可以压缩、gzip 和组合多个 js 文件？CSS文件怎么样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T22:25:58.467

您可以使用[ScriptManager](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx) / [ScriptManagerProxy控件并在](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanagerproxy.aspx)[CompositeScript](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.compositescript.aspx)部分/属性中定义脚本。请参阅[MSDN 参考资料](http://msdn.microsoft.com/en-us/library/cc488552.aspx)。

```
<asp:ScriptManager runat="server">
    <CompositeScript>
        <Scripts>
            <asp:ScriptReference Path="~/public/javascript/jquery/jquery.js" />
            <asp:ScriptReference Path="~/public/javascript/jquery/jquery.tablesorter.js" />
            <asp:ScriptReference Path="~/public/javascript/jquery/jquery.tablehover.pack.js" />
            <asp:ScriptReference Path="~/public/javascript/jquery/jquery.validate.js" />
            <asp:ScriptReference Path="~/public/javascript/jquery/jquery.form.js" />
            <asp:ScriptReference Path="~/public/javascript/jquery/application.js" />
        </Scripts>
    </CompositeScript>
</asp:ScriptManager> 
```

它不一定会清理任何标记，但它确实会将它们压缩在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-19T04:21:52.090

[Combres](http://combres.codeplex.com/)对 JavaScript 和 CSS 资源进行捆绑、版本控制、缩小和缓存。它非常可配置且高性能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-18T22:31:43.603

```
<%= javascript_include_tag "all_min" %> 
```

这确实具有经典 asp 函数调用的所有语义，即使它真的是 ruby​​。事实上，不知道任何红宝石我仍然可以非常自信地猜测这*只是*一个函数，“all_min”指的是作为参数传入的文件夹名称。

由于`<%= %>`蜜蜂蜇伤只是经典 ASP 中的一个捷径`Response.Write`，我们可以得出结论，您应该能够构建自己的函数，该函数本质上做同样的事情并返回一个包含相关包含的字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T22:19:40.273

您可以使用 HTTP 处理程序执行此操作。查看 Mads Kristensen 的这篇博文：

[在运行时组合多个样式表](http://blog.madskristensen.dk/post/Combine-multiple-stylesheets-at-runtime.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T08:15:25.213

ScriptManager 在 BSD 许可证下，我不喜欢这个 :(。你可能会看到一个很好的替代方案，它是如何在 KiGG 的方法中实现的：[KiGG](http://www.codeplex.com/Kigg)

背后的想法是，该控件允许您通过将它们分成类别（您登记他们的名称）来加入来自 web config 的文件 js，非常简单。祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-19T13:56:16.193

A lot of solutions out there do this with an http handler that dynamically creates a crushed js or css file per a page is not a good idea. It is better to crush your entire sites js and css files into one file and rather serve that. This way the browser loads it once and its cached. All further requests just load from cache. Dynamically crushed js and css files create a file per page. So you might be re-serving the same css and js files for every page.

You can then let the web server serve the crushed css/js file. Most web server. IIS implements kernel mode caching, which is the fastest way to serve any static file.

If you want a performant, scalable solutions that works in web farms check out:

[http://code.google.com/p/talifun-web/wiki/CrusherModule](http://code.google.com/p/talifun-web/wiki/CrusherModule)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-30T09:23:30.230

我最近发现了这个工具**[SquishIt](http://www.codethinked.com/post/2010/05/26/SquishIt-The-Friendly-ASPNET-JavaScript-and-CSS-Squisher.aspx)**。

格兹，克里斯。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2010-05-19T04:18:14.097

这是rails中的一个辅助方法。

传递它 :all 将包括默认的原型库。

ASP.net MVC 试图复制 Rails，但你永远无法正确地获得内部美学。

我的建议：

不要从开源中复制所有好的东西，只需使用真实的东西，即 rails

# java - Eclipse：通过本地属性将源/javadoc 附加到库

> ID：300328
> 
> 赞同：10
> 
> 时间：2008-11-18T22:12:28.320
> 
> 标签：java, eclipse, jar, javadoc

我的 SVN 存储库中有一个第三方库，我想在 Eclipse 中将 source/javadoc 与它本地关联。即，应该有一些本地设置（例如，`local.properties`文件中的条目）将源/javadoc 与 JAR 文件相关联，但不会通过`.classpath`. 理想情况下我会有

```
lib_src_dir = /my/path/to/lib/src 
```

在`local.properties`然后

```
<classpathentry kind="lib" path="lib.jar" sourcepath="${lib_src_dir}"> 
```

在`.classpath`. 这可以做到吗？

[编辑] @VonC 的回答很有帮助......有没有办法从文本文件（例如，`local.properties`）加载路径变量，而不是通过 Window -> Preferences -> General -> Workspace -> Linked Resources？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-18T22:17:06.143

我相信这将通过以下方式更好地实现：

*   链接文件夹的创建与
*   链接资源的声明

链接的资源定义了一个路径变量，它等于`/my/path/to/lib/src`

![Eclipse 链接资源](https://i.stack.imgur.com/YPlVi.jpg)

链接文件夹将引用您的链接资源

![链接资源](https://i.stack.imgur.com/cwywG.gif)

（您可以使用“变量”按钮使用变量而不是固定路径）

该变量实际上始终是本地的（对于一个人的工作区），并且将通过`Linked Resources`首选项屏幕进行修改。

链接文件夹也可以是...链接*文件*，从而允许通过相对路径（相对于变量）引用存档。
然后这个链接文件（这里是链接档案）可以`classpathentry`在“ `source`”属性中关联到您的。

* * *

链接资源的问题在于它们在首选项中位于工作区的本地。
您可以**将首选项导出到一个`[myPrefs.epf]`文件**中，然后修剪导出的文件以便只保留包含以下内容的行**`pathvariable`**：

```
/instance/org.eclipse.core.resources/pathvariable.MY_DIRECTORY=/my/path/to/lib/src 
```

然后任何人都可以导入这个特殊的首选项文件，这只会影响“ `Linked Resources`”部分。

**该解决方案不是很令人满意，因为`.epf`无法在项目中自动加载首选项文件**。
当我设置一个带有定义路径的链接资源的项目时，我总是`README.txt`在我的项目的根目录下留下一个大的，以鼓励所述项目的用户使用他/她自己的固定本地路径定义相同的链接资源。

[一些 bug](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=relative+path+linked&long_desc_type=allwordssubstr&long_desc=&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&resolution=FIXED&resolution=INVALID&resolution=WONTFIX&resolution=LATER&resolution=REMIND&resolution=DUPLICATE&resolution=WORKSFORME&resolution=MOVED&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=noop&type0-0-0=noop&value0-0-0=)正在进行中以增强这种情况或围绕[链接资源主题](https://bugs.eclipse.org/bugs/buglist.cgi?quicksearch=LinkedResources)。

尤其：

*   [导出具有链接资源的项目](https://bugs.eclipse.org/bugs/show_bug.cgi?id=67329)
*   [没有变量的相对路径](https://bugs.eclipse.org/bugs/show_bug.cgi?id=86607)
*   [具有相对于工作区路径的链接资源](https://bugs.eclipse.org/bugs/show_bug.cgi?id=33957)
*   [想使用相对于工作空间根目录的路径](https://bugs.eclipse.org/bugs/show_bug.cgi?id=29023)

* * *

[DevByStarlight](https://stackoverflow.com/users/735533/devbystarlight)在[评论](https://stackoverflow.com/questions/300328/eclipse-attach-source-javadoc-to-a-library-via-a-local-property/300346?noredirect=1#comment22430417_300346)中提到了该项目（自 2011 年 10 月以来不太活跃）[workspacemechanic](https://code.google.com/a/eclipselabs.org/p/workspacemechanic/)。

> Workspace Mechanic 通过调整首选项、添加扩展位置等来自动维护 Eclipse 环境。您可以使用它来：
> 
> *   在整个公司、您的本地团队甚至您自己的许多工作空间中创建一个一致的环境
> *   节省设置新工作区的时间
> *   创建任务以确保将您最喜欢的新首选项应用到您当前和未来的所有工作区。（这是我们最喜欢的功能之一！）
> 
> Workspace Mechanic 行为的关键是**`Task`**.
> 任务描述了一个简单的测试和一个动作，当它运行时会改变环境，因此测试随后会通过。
> **`Tasks`**可以有多种形式：首选项文件、Java 类、Groovy 脚本和 Eclipse 扩展。您可以轻松定义自己的任务。

它带有一组脚本：

*   [工作区机械师](https://github.com/oschrenk/workspace-mechanic)
*   [工作空间机械设置](https://github.com/signed/workspacemechanic-settings)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-12-15T18:04:05.003

在后台和空闲时间工作了几天之后，我刚刚想出了一个简单的答案（在 Indigo 中）。我发现最简单的方法是在 Project Explorer 中展开您的项目，进入您的 Referenced Libraries，右键单击相应的引用 JAR，然后单击 Properties。在那里，您可以选择指定 JavaDocs 位置。输入包含 index.html 和 packages-list 的文件夹的位置，这些文件是 Javadocs 的一部分。小菜一碟！

到目前为止，我看到的唯一问题是我敢打赌，您需要在每个引用该库的项目中都这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T20:16:48.447

您可以使用类路径变量来执行此操作。

每个开发人员在 Window -> Preferences -> Java -> Build Path -> Classpath Variables 处创建几个新变量。

定义一个指向包含第三方 JAR（或 JARS）的目录的变量（比如 JAVA_LIB_DIR）。定义另一个指向包含第三方源代码 (JAVA_SRC_DIR) 的目录的变量。您可以按照自己的喜好进行设置，但我们的结构如下：

```
common/   
  lib/
    java/       <-- JAVA_LIB_DIR variable points to this directory
      axis/
      bitronix/
        1.0/bitronix.jar   "extension" is "bitronix/1.0/bitronix.jar"
      ... 
```

在项目的构建路径中，使用“添加变量...”选项添加库。然后，当您“附加源”时，系统会提示您输入源代码的变量和扩展名。

这样，可以签入单个共享的 .classpath 文件，同时允许每个开发人员在他们喜欢的位置找到他们自己的库和源目录。

# java - 如何以编程方式发送加密电子邮件（来自自动化过程）

> ID：300334
> 
> 赞同：10
> 
> 时间：2008-11-18T22:13:48.647
> 
> 标签：java, email, encryption

我有一个在每晚运行的 UNIX (Solaris) 服务器上运行的进程，并且需要能够发送加密的电子邮件。

我只需要“加密”部分，而不是 PKI 的数字签名/自我否认部分。

我在公司环境中使用 MS Outlook，我假设当用户单击工具 -> 选项 -> 安全下的“发布到 GAL...”时，这会将他们的公钥发布到全局地址列表 (GAL)。

所以我认为我需要一种方法来从我的 UNIX 服务器连接到 GAL 所在的 Exchange 服务器。然后我需要检索收件人公钥。然后我可以使用收件人公钥加密电子邮件。这将加密电子邮件，并且只允许拥有收件人 PRIVATE KEY 的人阅读电子邮件，对吗？然后我会发送电子邮件。但是，我不确定的是，如何仅使用收件人 PUBLIC KEY（在 UNIX 端没有 KEYS）加密电子邮件，以使 MS Outlook 在收件人收到电子邮件时能够读取电子邮件？

这行得通吗？有没有人遇到类似的问题并提出解决方案？Java 代码是首选，但任何语言都可以开始。

为了获得合理的答案，还需要任何其他详细信息吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T00:17:32.290

**You're logic is right.**

Typical PKI encryption is:

```
cryptoAlgorithm(plaintext, public key) = ciphertext

cryptoAlgorithm(ciphertext, private key) = plaintext 
```

For some algorithms, the cryptoAlgorithm is the same procedure, sending and receiving.

So... for each recipient you need their digital certificate, which will contain their public key.

**GAL Certificate Storage**

I would think it would be possible to configure the GAL to allow users to publish certificates. My general impression is that how the GAL is configured and used varies from company to company.

**S/MIME & PGP**

I agree with the post that S/MIME is what you want for Outlook.

Also note - if your users are using Outlook Web, rather than the Outlook client, they won't be able to receive encrypted emails. At least as of 2000, but I suspect 2003 as well. It's a huge usability problem and I've got no good workaround.

**General Microsoftyness**

Microsoft has their own special way of doing things (no kidding...). They are no different in the world of PKI. User certificates must be clearly marked with an encryption capability. I know it must have the KeyUsage field KeyEncipherment. And there may be one other extension required by Microsoft. Having an incorrectly formatted user certificate could mean that the recipient will be unable to read the mail when it arrives, because Outlook won't agree on the fact that the mail was encrypted. Spare some serious integration testing time here and plan to hit lots of user groups on how to do this. Every time my team has had to integrate with a Microsoft product, there have been nasty surprises, particularly regarding how the certificate is configured.

**Libraries & Tools**

I second the recommendation for BouncyCastle - I haven't used it, but people I trust swear by it. I personally loved the Phaos toolkit when I had to write this stuff, but I'm out of date. I know it cost serious money, and may be too much bang for your buck.

OpenSSL is another fabulous tool, and useful for much more than SSL. It's great for generating test certificates, but I can't remember if it does S/MIME email encryption as well.

For most libraries, you should be able to take plaintext, and the certificate, and put both into a function that generates the S/MIME message. They may require the encryption algorithm as well.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T13:23:03.537

在一般情况下：要向某人发送加密消息，您只需要他们的公钥。你不需要自己有钥匙。非对称加密的规则是用公钥加密的任何东西都可以用相应的私钥解密，用私钥加密的任何东西都可以用相应的公钥解密。

仅当您想对消息进行签名时，您才需要服务器的密钥。

如果你想用 Java 来实现，我认为 JavaMail 不支持开箱即用的加密，但你可以看看[JavaMail-Crypto](http://javamail-crypto.sourceforge.net/)（我自己没用过）。据说在某个地方有一个 GnuPG 的 JNI 接口......你总是可以从任何语言执行 PGP 或 GnuPG......

我不知道 Outlook 中对 PGP 的支持，也不知道关于 Outlook 的任何其他内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T12:20:48.763

您必须以 s/mime 格式将加密邮件发送到 Outlook。Outlook 不支持 PGP。

首先尝试从 Java 发送纯文本消息，看看是否可以将其输入 Outlook。以后担心加密。使用 JavaMail 库创建和发送电子邮件。

我不知道如何从 GAL 中提取密钥。通过手动导出密钥并查看是否可以使用它可能是最简单的开始。

要创建 s/mime 格式的加密邮件，我推荐[Bouncy Castle](http://www.bouncycastle.org)。Bouncy Castle 是一个加密货币提供商，也支持 s/mime。（寻找 CMS/Smime 包）。下载的源代码中应该有一些示例。我过去曾用它向各种电子邮件客户端发送电子邮件，包括 Outlook，它运行良好。但是为加密货币做好准备——这可能是一个陡峭的学习曲线！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T20:24:56.540

前面没有提到的警告是，GAL 不一定在 Exchange Server 上，并且在不以独立模式运行时更常见于域服务器上。该证书将在 LDAP 属性 userCertificate 或 userSMIMECertificate 中找到。

# reporting-services - 在报表中显示参数（多值）

> ID：300339
> 
> 赞同：81
> 
> 时间：2008-11-18T22:14:50.767
> 
> 标签：reporting-services, parameters

谁能告诉我如何在 SSRS 报告中显示我的多值参数的所有选定值。给出`parameter.value`选项时会出错。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2008-11-18T22:21:42.517

您可以使用“加入”函数从标签数组中创建单个字符串，如下所示：

```
=Join(Parameters!Product.Label, ",") 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T11:55:58.243

=Join(Parameters!Product.Label, vbcrfl) 换行

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-09T20:18:03.997

我不知道加入功能 - 很好！我写了一个放在代码部分的函数（报告属性->代码选项卡：

```
Public Function ShowParmValues(ByVal parm as Parameter) as string
   Dim s as String 

      For i as integer = 0 to parm.Count-1
         s &= CStr(parm.value(i)) & IIF( i < parm.Count-1, ", ","")
      Next
  Return s
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-21T09:35:47.007

希望其他人觉得这很有用：

使用 Join 是使用多值参数的最佳方式。但是如果你想要一个高效的“全选”呢？如果有 100s+，那么查询将非常低效。

要解决此问题，而不是按原样使用 SQL 查询，请将其更改为使用表达式（单击右上角的 Fx 按钮），然后构建类似这样的查询（需要语音标记）：

```
= "Select * from tProducts Where 1 = 1 " 
IIF(Parameters!ProductID.Value(0)=-1,Nothing," And ProductID In (" & Join(Parameters!ProductID.Value,"','") & ")") 
```

在您的参数中执行以下操作：

```
 SELECT -1 As ProductID, 'All' as ProductName Union All
    Select  
    tProducts.ProductID,tProducts.ProductName
    FROM
    tProducts 
```

通过将查询构建为表达式意味着您可以提高 SQL 语句的效率，但也可以解决 SQL Server 在处理“In”语句中的值时遇到的困难。

# php - PHP - 成员封装返回奇怪的引用

> ID：300344
> 
> 赞同：1
> 
> 时间：2008-11-18T22:16:23.353
> 
> 标签：php, reference

我有一个有私人成员的班级`$content`。这是由 get 方法包装的：

```
class ContentHolder
{
    private $content;
    public function __construct()
    {
        $this->content = "";
    }

    public function getContent()
    {
        return $this->content;
    }
}
$c = new ContentHolder();
$foo = array();
$foo['c'] = $c->getContent(); 
```

现在`$foo['c']`是对 的引用`content`，这是我不明白的。我怎样才能获得价值？先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T22:33:30.057

我刚刚尝试了您的代码，`$foo['c']`并不是对`$content`. （分配一个新值`$foo['c']`不影响`$content`。）

默认情况下，所有 PHP 函数/方法按值传递参数并按值返回。要通过引用返回，您需要对方法定义使用以下语法：

```
public function &getContent()
{
    return $this->content;
} 
```

调用方法时的语法如下：

```
$foo['c'] = &$c->getContent(); 
```

请参阅[http://ca.php.net/manual/en/language.references.return.php](http://ca.php.net/manual/en/language.references.return.php)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T22:31:04.370

我不太明白你的问题。说你改变了：

```
public function __construct() {
    $this->content = "test";
}

$c = new ContentHolder();
$foo = array();
$foo['c'] = $c->getContent();

print $foo['c'];          // prints "test"
print $c->getContent();   // prints "test" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T22:21:05.760

在 PHP 中，您不说：“ `$foo = new array();`”，而是简单地说：“ `$foo = array();`”

我运行了您的代码（PHP 5.2.6），它似乎工作正常。我通过转储数组对其进行了测试：

```
var_dump($foo); 
```

这输出：

```
array(1) {
  ["c"]=>
  string(0) ""
} 
```

我也可以简单地使用`echo`：

```
echo "foo[c] = '" . $foo['c'] . "'\n"; 
```

这输出：

```
foo[c] = '' 
```

# palm-os - Palm Centro 上 6GB+ 卡上的 VFSVolumeSize 溢出

> ID：300356
> 
> 赞同：1
> 
> 时间：2008-11-18T22:20:42.377
> 
> 标签：palm-os

当我在插入 6GB SanDisk 卡的 Palm Centro 上调用 Palm OS 上的 VFSVolumeSize 时，它​​返回 1810366464 作为卡的大小，但使用了 2098102272 字节。显然，卡片大小会溢出。

有没有办法检测这种溢出并获得卡的实际大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:11:10.200

没有很好的方法可以做到这一点。VFSVolumeSize API 仅使用 32 位值，因此它无法正确报告大于 4GB 的大小。有扩展管理器 API 可以告诉您有关卡插槽的信息，但它们都没有谈论卡的块大小或块数。

如果您进入设备上的 Card Info 应用程序，您会看到同样的故障——它也会错误地指示卡片的大小。

# design-patterns - 用户/角色管理系统的最佳设计？

> ID：300359
> 
> 赞同：33
> 
> 时间：2008-11-18T22:21:06.370
> 
> 标签：design-patterns, architecture

这是我多次遇到但从未找到理想解决方案的软件设计问题（我现在也在处理它。）

许多应用程序需要某种形式的用户/角色管理。您有基础用户、这些用户可以属于的组（不仅限于一个）、他们拥有的角色和权限、组织单位，以及一大堆特定于项目的属性和其他功能。

我的问题是，人们知道和/或有哪些方式来设计和构建一个真正动态、灵活的用户管理系统？有没有你知道的真正有用的设计模式？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-08-19T18:56:53.567

您应该调整您的设计，因为每个组织都是不同的。 [查看此页面](http://en.wikipedia.org/wiki/Role-based_access_control)，您可以看到基于角色的管理模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T22:24:51.667

不确定它是否会对您有所帮助，但如果您有机会，您应该检查一下 ASP.NET 中的内置功能。至少，你可以从那里得到一些指示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-11T16:37:29.483

数据模型资源书第 2 章[，卷。1](https://rads.stackoverflow.com/amzn/click/com/0471380237)：适用于所有企业的通用数据模型库可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-11T19:23:39.473

看看 Scott Mitchell 的 ASP.NET 2.0 Membership, Roles and Profile 教程系列：

[http://weblogs.asp.net/scottgu/archive/2006/05/07/ASP.NET-2.0-Membership-and-Roles-Tutorial-Series.aspx](http://weblogs.asp.net/scottgu/archive/2006/05/07/ASP.NET-2.0-Membership-and-Roles-Tutorial-Series.aspx)

# apache-flex - 在动作脚本中创建一个带有图标的按钮

> ID：300360
> 
> 赞同：7
> 
> 时间：2008-11-18T22:21:14.217
> 
> 标签：apache-flex, actionscript-3

我想使用 Actionscript 在 Flex 中动态创建带有图标的按钮。

我试过这个，没有成功：

```
var closeButton = new Button();
closeButton.setStyle("icon", "@Embed(source='images/closeWindowUp.png"); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-19T01:40:35.937

我找到了一个适合我的答案。在我的 .mxml 文件中，我为我将使用的图标创建类：

```
// Classes for icons
[Embed(source='images/closeWindowUp.png')]
public static var CloseWindowUp:Class;
[Embed(source='/images/Down_Up.png')]
public static var Down_Up:Class;
[Embed(source='/images/Up_Up.png')]
public static var Up_Up:Class; 
```

在我的应用程序的 Actionscript 部分，我在动态创建按钮时使用这些类：

```
var buttonHBox:HBox = new HBox();
var closeButton:Button = new Button();
var upButton:Button = new Button();
var downButton:Button = new Button();

closeButton.setStyle("icon", SimpleWLM.CloseWindowUp);
buttonHBox.addChild(closeButton);

upButton.setStyle("icon", SimpleWLM.Up_Up);
buttonHBox.addChild(upButton);

downButton.setStyle("icon", SimpleWLM.Down_Up);
buttonHBox.addChild(downButton); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-29T07:50:44.650

您可以使用按钮图标的动态更改这一选项。

嵌入你的图标

```
[Embed(source='com/images/play.png')]
[Bindable]
public var imagePlay:Class; 

[Embed(source='com/images/pause.png')]
[Bindable]
public var imagePause:Class; 
```

一键切换视频播放和暂停

```
private function playpause():void
{
    if (seesmicVideo.playing)
    {
        seesmicVideo.pause();
        btn_play.setStyle("icon",imagePlay);
    }
    else
    {
        seesmicVideo.play();
        btn_play.setStyle("icon",imagePause);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T11:30:54.810

错误在引号中，周围不应有引号`@Embed`：

```
closeButton.setStyle("icon", @Embed(source="images/closeWindowUp.png")); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-09T11:15:55.557

我可以通过以下代码在按钮中使用图标：

```
<mx:Button id="buttonPlay" label="Play" click="playButtonClicked();" enabled="false" icon="@Embed('./play.png')"/> 
```

文件 play.png 与 mxml 文件位于同一文件夹中。

我正在使用 Flash Builder 4.6 版。

**Edit:** the question was about ActionScript and not MXML, but I leave this answer just for reference.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T22:45:22.170

我假设您将其添加到舞台上？

另外，我认为您的嵌入缺少一个紧密的引号/括号。

```
closeButton.setStyle("icon", "@Embed(source='images/closeWindowUp.png"); 
```

应该：

```
closeButton.setStyle("icon", "@Embed(source='images/closeWindowUp.png')"); 
```

# c# - 使用 LINQ (C#) 从 Atom 提要中选择作者姓名字段

> ID：300376
> 
> 赞同：5
> 
> 时间：2008-11-18T22:28:52.313
> 
> 标签：c#, linq, atom-feed

我正在尝试使用 LINQ 从 ATOM 提要中的作者节点中选择“名称”字段。我可以像这样获得我需要的所有字段：

```
XDocument stories = XDocument.Parse(xmlContent);
XNamespace xmlns = "http://www.w3.org/2005/Atom";
var story = from entry in stories.Descendants(xmlns + "entry")
            select new Story
            {
                Title = entry.Element(xmlns + "title").Value,
                Content = entry.Element(xmlns + "content").Value
            }; 
```

在这种情况下，我将如何选择作者-> 姓名字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T22:42:36.373

你基本上想要：

```
entry.Element(xmlns + "author").Element(xmlns + "name").Value 
```

但是您可能希望将其包装在一个额外的方法中，以便在缺少作者或名称元素时轻松采取适当的措施。如果有不止一位作者，您可能还想考虑您想要发生的事情。

提要也可能有作者元素……只是要记住的另一件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T23:09:24.917

它可能是这样的：

```
 var story = from entry in stories.Descendants(xmlns + "entry")
                    from a in entry.Descendants(xmlns + "author")
                    select new Story
                    {
                        Title = entry.Element(xmlns + "title").Value,
                        Content = entry.Element(xmlns + "subtitle").Value,
                        Author = new AuthorInfo(
                            a.Element(xmlns + "name").Value,
                            a.Element(xmlns + "email").Value,
                            a.Element(xmlns + "uri").Value
                         )
                    }; 
```

# javascript - 如何在 IE6 中找到 Javascript 的减速

> ID：300380
> 
> 赞同：4
> 
> 时间：2008-11-18T22:32:04.833
> 
> 标签：javascript, debugging, internet-explorer-6

某些东西使我在 IE6 中的 Javascript 代码减慢到悬停时明显滞后的地方。在 FF 中很好，所以使用 firebug 并没有那么有用。有哪些工具可以帮助在 IE 中进行调试？

**更多信息：**我认为实际上没有任何 JS 在我鼠标悬停的对象上运行。（至少我没有放入。）只是 css :hover 的东西。另外，我在项目上同时运行了 jquery 和 dojo，所以谁知道他们在后台做什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T03:44:25.577

只是那个“东西”可能是什么的提示......

**IE 中的字符串连接**（或至少在我[测试](http://forums.thedailywtf.com/forums/p/8931/169331.aspx)时）非常慢。**Opera 0.2s 完成，Firefox 4.1s 和 Internet Explorer 7 20分钟**后仍然没有完成！！！

不要这样做：

```
for (var i=0, i < 200; i++) { s = s + "something";} 
```

相反，暂时使用一个数组，然后加入它：

```
var s=[];
for (var i=0; i < 200; i++) s.push("something");
s=s.join(""); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T14:34:02.083

我通常做的是：

```
var startTime = new Date();
// Lots of heavy code here
console.log("Processing time: ", new Date() - startTime, " ms"); 
```

你可以让[Firebug lite](http://getfirebug.com/lite.html)让 console.log 跨浏览器工作。这让您了解代码的任何给定部分需要多长时间才能执行。

一旦你知道哪个是错误的部分，你可以探索修复它的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T22:36:42.033

[Microsoft Script Debugger](http://www.microsoft.com/downloads/details.aspx?FamilyId=2F465BE0-94FD-4569-B3C4-DFFDF19CCD99&displaylang=en)，另请参阅[IEBlog](http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx)以获取提示

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T15:51:19.293

滞后也可能来自 DOM 更新。当 IE 由于 DOM 更改而需要重新渲染页面时，它可能会明显比 Firefox 慢。通常，当这种情况发生时，光标会冻结。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T16:08:11.397

考虑到快速的 firefox 和慢速的 IE，xpath 表达式和事件处理程序（确保您获得正确数量的调用，而不是预期数量的 10 倍）是手动插入计时器的好地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-21T21:12:22.263

我想我已经为任何好奇的人找到了减速的根源：我正在使用[bgiframe](http://plugins.jquery.com/project/bgiframe)来解决 IE6 选择框 z-index 问题（在 SO的[其他地方讨论）。](https://stackoverflow.com/questions/224471/iframe-shimming-or-ie6-and-below-select-z-index-bug)

# java - 动态列单元格宽度

> ID：300383
> 
> 赞同：6
> 
> 时间：2008-11-18T22:32:31.183
> 
> 标签：java, html, jasper-reports

我有一些以 HTML 格式显示的 Jasper 报告。我希望 HTML 表中列的宽度能够自动调整大小以适合最宽单元格（在该列中）的内容，以便显示所有数据。

目前这不会发生，因为 Jasper 生成的 HTML 为 <table> 和一些 <td> 元素指定了固定宽度，例如

```
<td style="width: 20px; height: 17px;">
  <span style="font-family: Arial; font-size: 11px;">foo-bar-baz@examp</span>
</td> 
```

我不能简单地删除所有这些宽度属性（使用 JavaScript），因为（如上面的 HTML 所示）在使用这些宽度时将隐藏的任何数据甚至都不会返回到客户端

干杯，唐

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T20:48:40.923

虽然不完美，但您可以将字段标记为溢出。这至少会给你所有的数据。在您的 jrxml 文件中，它将类似于：

```
<textField isStretchWithOverflow="true" hyperlinkType="None">
    <reportElement style="Report Sub-Title" x="0" y="84" width="802" height="20"/>
    <textElement/>
    <textFieldExpression class="java.lang.String">
        <![CDATA["For the period ...]]>
    </textFieldExpression>
</textField> 
```

恐怕我不知道 Jasper 报告的任何允许动态调整列宽大小的功能 - 这可能是对 HTML 有意义但对 PDF 等其他输出格式没有意义的事情之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-07T17:13:32.273

开发人员有意识地决定不允许单元格宽度拉伸。要让列根据内容改变宽度，必须通过编程来完成。一个有用的工具：[DynamicJasper](http://dynamicjasper.com/)。

> DynamicJasper 动态创建报告，在运行时定义列、列宽（自动宽度）、组、变量、字体、图表、交叉表、子报告（也可以是动态的）、页面大小以及您可以在设计时定义的所有其他内容.

[JasperReports 论坛](https://community.jaspersoft.com/questions/522554/how-dynamically-increaze-column-width)和[DynamicJasper HOW-TO](http://dynamicjasper.com/2010/10/06/how-to-create-bar-code-columns/)都有自动（动态）列宽的示例。

```
FastReportBuilder drb = new FastReportBuilder();
drb.addColumn("State", "state", String.class.getName(),20)
        .addColumn("Branch", "branch", String.class.getName(),30)
        .addColumn("Quantity", "quantity", Long.class.getName(),60,true)
        .addColumn("Amount", "amount", Float.class.getName(),70,true)
        .addBarcodeColumn("Bar-Code", "amount", Long.class.getName(), BarcodeTypes.USD3, true,
false,null, 100, true, ImageScaleMode.FILL, null)
        .addGroups(1)
        .setDetailHeight(30)
        .setTitle("November 2006 sales report")
        .setSubtitle("This report was generated at " + new Date())
        .setUseFullPageWidth(true);     

DynamicReport dr = drb.build(); 
```

调用`true`时传入`addColumn`表示使用*固定*宽度。关闭或传递参数`false`将动态设置列宽。您可能还需要调用`setUseFullPageWidth( true )`自动宽度来激活，但我不确定这一点。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-09-03T15:18:38.403

在 iReport 中有一个名为“Stretch Type”的选项。选择“相对于带高”

# c++ - Borland C++：与 std 的歧义（错误 E2015）

> ID：300386
> 
> 赞同：1
> 
> 时间：2008-11-18T22:33:03.490
> 
> 标签：c++, c++builder, ambiguity

我一直在 Visual Studio 2005 中开发一个 DLL。目前它可以编译并完成它应该做的事情。

但是，我想使用 Borland C++ 2006 来编译它，因为我听说它更好并且可以生成更快的代码。当我尝试这样做时，我收到如下错误消息：

> E2015 **strcmp** (const char *,const char *) 和 std:: **strcmp** (const char *,const char *)之间的歧义

我已将 strcmp 的每个实例更改为 std::strcmp 以解决歧义问题并且它有效，但我想知道是否有更聪明的方法来做到这一点。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T22:46:10.203

你可能有

```
#include <cstring> 
```

和

```
#include <string.h> 
```

和一个

```
using namespace std; 
```

在你的代码某处。cstring 声明 std::strcmp，string.h 声明 strcmp。这导致了歧义。如果您可以避免做所有这三件事，那可能会解决您的问题。

# c# - 客户端 ID 在哪个页面生命周期生成？

> ID：300389
> 
> 赞同：6
> 
> 时间：2008-11-18T22:34:11.820
> 
> 标签：c#, .net, asp.net, page-lifecycle

我以编程方式将 Web 控件添加到用户控件中我还添加了一个 javascript 事件，将 controlID 作为参数传递，但 clientID 是我分配的一个，它不包含 asp.net 生成的那个

```
 var txt = new TextBox();
   txt.ID = "MyID"+Number;

   chkBox.Attributes.Add("onClick", "EnableTxtBox('" +txt.ClientID + "');"); 
```

我可以通过添加父控件 ID 来解决这个问题

```
 chkBox.Attributes.Add("onClick", "EnableTxtBox('" + this.ClientID+"_"+txt.ClientID + "');"); 
```

客户端 ID 在哪个页面生命周期生成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-18T22:57:48.323

在添加属性之前，您需要将控件添加到控件层次结构。

```
 var txt = new TextBox();
   txt.ID = "MyID"+Number;
   Controls.Add ( txt );
   chkBox.Attributes.Add("onClick", "EnableTxtBox('" +txt.ClientID + "');"); 
```

ControlCollection 不是普通的集合；它在添加控件时通知所有者控件，并且控件可以采取适当的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:13:19.727

您应该能够在 OnPreRender() 期间添加该属性。INamingContainer 有时很痛苦……

# linq-to-sql - 如何强制 Linq to SQL 不使用缓存？

> ID：300402
> 
> 赞同：7
> 
> 时间：2008-11-18T22:37:32.547
> 
> 标签：linq-to-sql

当我两次进行相同的查询时，第二次它不会从数据库返回新行（我猜它只是使用缓存）。

这是一个 Windows 窗体应用程序，我在应用程序启动时创建 dataContext。

如何强制 Linq to SQL 不使用缓存？

这是我遇到问题的示例函数：

```
public IEnumerable<Orders> NewOrders()
{
    return from order in dataContext.Orders
           where order.Status == 1
           select order; 
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-18T22:40:01.247

最简单的方法是使用新的 DataContext - 鉴于上下文提供给您的大部分内容是缓存和身份管理，听起来您真的只想要一个新的上下文。为什么你想只创造一个然后坚持下去？

顺便说一句，对于像您这样的简单查询，使用带有扩展方法而不是查询表达式的“普通”C# 更具可读性（IMO）：

```
public IEnumerable<Orders> NewOrders()
{
    return dataContext.Orders.Where(order => order.Status == 1);
} 
```

编辑：如果您*从不*希望它跟踪更改，请在执行任何操作之前将[ObjectTrackingEnabled设置为 false。](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.objecttrackingenabled.aspx)但是，这将严重限制它的实用性。您不能只是前后翻转开关（在两者之间进行了查询）。IMO，更改您的设计以避免单例上下文会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-25T05:59:42.880

您如何将对象添加到 DataContext 是否将包含在未来的查询中可能很重要。

**不会在内存查询中将新的 InventoryTransaction 添加到未来**

在此示例中，我添加了一个带有 ID 的对象，然后将其添加到上下文中。

```
var transaction = new InventoryTransaction()
                 {
                     AdjustmentDate = currentTime,
                     QtyAdjustment = 5,
                     InventoryProductId = inventoryProductId
                 };

dbContext.InventoryTransactions.Add(transaction);
dbContext.SubmitChanges(); 
```

Linq-to-SQL 不够聪明，无法将此视为需要添加到`InventoryTransactions`.

**将在内存查询中添加新的 InventoryTransaction**

```
var transaction = new InventoryTransaction()
                 {
                     AdjustmentDate = currentTime,
                     QtyAdjustment = 5
                 };

inventoryProduct.InventoryTransactions.Add(transaction);
dbContext.SubmitChanges(); 
```

在创建关系时尽可能使用 Linq-to-SQL 中的集合而不是 ID。

此外，正如 Jon 所说，尽量减少 DataContext 的范围。

# .net - 如何在不取消对程序集签名的情况下构建部署项目？

> ID：300405
> 
> 赞同：0
> 
> 时间：2008-11-18T22:39:11.420
> 
> 标签：.net, deployment, code-signing, release-management

我对构建不是很有经验 - 这可能真的很容易！我有一个简单的应用程序和一个简单的部署项目。我进入了 DLL 的发布编译版本所在的目录，对它们进行了签名（verisign），然后进入部署项目，选择了构建（而不是重新构建），它重新编译了我所有的程序集，现在它们不是t 签了。我可以保留很好的简单部署项目并且仍然有签名的程序集，还是我必须以不同的方式创建 MSI？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T23:56:00.407

没试过，但是……不要让部署项目依赖于应用项目。相反，手动将应用程序的输出添加到部署中。因此，不应触发自动构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T00:14:48.543

尝试将程序集签名作为构建的中间步骤。

一种方法是添加一个虚拟项目，该项目具有一个对您的程序集进行签名的生成事件。将此项目作为创建 MSI 包之前的最后一步。

# asp.net - 在 ASP.NET 中验证上传文件的 ContentType

> ID：300406
> 
> 赞同：3
> 
> 时间：2008-11-18T22:39:21.620
> 
> 标签：asp.net

我在我的数据库中存储了一些文件，因为我以二进制格式存储它们并且不保留任何其他信息，所以我必须确保它们都采用相同的格式，以便我能够“服务" 稍后（如果有一种***简单***的方法可以从字节数组推断文件类型，请告知，但这不是这里的重点）。

所以，我需要做的是验证上传的每个文件，以确保它符合要求的格式。

我设置了一个带有 FileUpload 控件和 CustomValidator 的 FieldTemplate：

```
<asp:FileUpload ID="FileUpload" runat="server" />&nbsp;

<asp:CustomValidator
    ID="CustomValidator1"
    runat="server"
    ErrorMessage="PDF only."
    ControlToValidate="FileUpload"
    OnServerValidate="CustomValidator1_ServerValidate">
</asp:CustomValidator> 
```

我缺少的是放置在 CustomValidator1_ServerValidate 方法中的代码，该方法检查上传的文件以确保其格式正确（在本例中为 PDF）。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T23:10:33.167

使用 FileUpload.PostedFile.ContentType 属性来验证 MIME 类型（应该是 application/pdf ）。出于安全原因，还要验证文件扩展名是否合适 ( .pdf )。您可以拥有一个静态哈希表，其中包含从 MIME 类型到文件扩展名的映射，并用作查找来验证扩展名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-15T19:28:43.647

就像阿瑞说的。这都可以被欺骗。获取一个 .txt 文件，将其重命名为 pdf 文件并尝试获取内容类型。它将是“应用程序\pdf”。

但是，我以前使用过一种解决方案。在我对 PDF 文件的简短测试中，我发现前 3 个字节总是相同的。我只尝试了前 3 个字节，因为它看起来已经足够了。前三个字节的值是：37、80、68。

所以我读取了字节（InputFile1.FileContent.ReadByte()），将它们与上面的 3 个字节进行比较，如果它们相同，那么我就有了一个 PDF 文件。此外，我在某处读到您应该关闭 IIS 中上传目录的脚本执行。希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T00:03:59.017

FileUpload.PostedFile.ContentType 正是我想要的。

只是提醒尝试做同样事情的人：似乎 PDF 文件的 MIME 类型可以是“application/pdf”或“text/pdf”，因此请务必检查两者。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-10T15:09:29.720

用户可以欺骗它。在上面的解决方案中，没有验证实际字节内容。我可以向您发送可执行文件并将其伪装为 pdf，这不会捕获它。

# iis - 如何向用户表明我的 IIS 网站正在进行维护？

> ID：300416
> 
> 赞同：62
> 
> 时间：2008-11-18T22:41:46.873
> 
> 标签：iis, redirect

对于我的 IIS 网站，我想将所有请求重定向到一个页面。这样做的目的是我想对我所有的 Web 应用程序使用的数据库进行一些维护（使其脱机）。我在这个网站下运行了大约 50 个网络应用程序，所以我想避免访问它们中的每一个来改变一些东西。我在想我可以在 machine.config 中进行一次更改吗？任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-11-18T22:45:23.013

如果您使用的是 ASP.NET 2.0（或更高版本），则可以将 app_offline.htm 页面放在根目录中。

[更多信息在这里](http://www.codeguru.com/csharp/.net/net_asp/article.php/c19653)。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2010-04-17T20:04:55.940

在网络配置中

```
 <rewrite>
        <rules>
            <rule name="redirect all requests" stopProcessing="true">
                <match url="^(.*)$" ignoreCase="false" />
                <conditions logicalGrouping="MatchAll">
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" pattern="" ignoreCase="false" />
                </conditions>
                <action type="Rewrite" url="index.php" appendQueryString="true" />
            </rule>
        </rules>
    </rewrite> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-18T22:44:18.927

使所有页面不可用，可能会停止当前网站并在其位置创建一个全新的完全空白的网站。然后为 404（找不到文件）错误建立一个自定义错误页面。自定义错误是 IIS 中网站属性对话框上的一个选项卡。只需创建您要发送的页面，然后将自定义错误选项卡上的 404 条目更改为指向您刚刚创建的新文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-31T14:16:19.737

在 IIS 10 中有一个可选组件“HTTP Redirect”（它可能在早期的 IIS 版本中可用；我不知道）。它允许您使用任何常见的 HTTP 重定向响应代码设置非常简单的包罗万象的重定向。这可以通过 Windows Server 2019 中的服务器管理器安装。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-17T20:54:45.940

您能否在 IIS 中创建一个新站点，并使用空白主机头（很像默认站点）绑定到端口 80，然后停止其他站点？这样一来，所有请求都将由新站点处理，这可能只是一个静态 HTML 页面，通知用户该站点因维护而停机。

# asp.net-mvc - 如何为我的控制器设置一个“默认操作”，当没有其他操作匹配时将调用它？

> ID：300417
> 
> 赞同：15
> 
> 时间：2008-11-18T22:42:13.753
> 
> 标签：asp.net-mvc

假设我有以下路线：

```
routes.MapRoute("Default", "{controller}/{action}/{id}", 
    new { controller = "Home", action = "Index", id = "" }); 
```

还可以说我的控制器具有以下方法：`Index(Int32 id)`和`Edit(Int32 id)`.

`/MyController/Index/1`该路由的有效 URL 也是如此。也是`/MyController/Edit/1`

但是，如果收到正确映射到我的控制器但未映射到现有操作的 URL，我如何定义要执行的“默认操作”而不是让 MVC 框架抛出错误屏幕？

基本上，当 {action} 令牌无法映射到控制器上的现有操作时，我想要 URL`/MyController/Preview/1`并执行我提前指定的操作。`/MyController/Whatever/1`

我看到 Codeplex 上的 MvcContrib 项目有一个属性，可以将其与 ConventionController 一起使用，但我现在想将它与纯 MS ASP.NET MVC 一起使用。

我还看到[Fredrik](http://fredrik.nsquared2.com/viewpost.aspx?PostID=460)提到了一个`[ControllerAction(DefaultAction = true)]`属性，但除了他的博客之外，我在任何地方都找不到它的提及（当我在控制器中尝试时，我的应用程序无法编译）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-19T01:05:47.347

您现在可以执行以下操作。

```
protected override void HandleUnknownAction(string actionName) {
  //your code here.
} 
```

另一种方法是对默认路由施加约束，使其仅匹配您*知道*控制器上存在的方法。然后你可以有另一条这样的路线：

```
routes.MapRoute("default-action", "{controller}/{actionName}/{id}", new {action="DefaultAction"}); 
```

哪个映射到

```
public ActionResult DefaultAction(string actionName, string id) {
  //handle default action
} 
```

这将为您提供您正在寻找的结果。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-03-15T17:09:41.920

Farooq Kaiser 在 CodeProject 上写了一篇关于这个主题的文章，我发现它很有用： [Handling Unknown Actions in ASP.NET MVC](http://www.codeproject.com/Articles/39005/Handling-Unknown-Actions-in-ASP-NET-MVC "处理 ASP.NET MVC 中的未知操作")

我特别喜欢创建“仅查看”页面的技巧（显然应该添加错误处理代码）：

```
protected override void HandleUnknownAction(string actionName)
{
   this.View(actionName).ExecuteResult(ControllerContext);
} 
```

# html - 如何从 ASP.NET MVC 视图显示存储在数据库中的 HTML？

> ID：300424
> 
> 赞同：31
> 
> 时间：2008-11-18T22:43:41.363
> 
> 标签：html, asp.net-mvc, html-encode

我将由 FCKEditor 编辑的 HTML 代码存储在数据库中，并希望将其显示（很好地呈现）到视图上。因此，例如，存储为：

```
&lt;&gt;pre&lt;&gt;This is some sample text&lt;&gt;pre&lt;/&gt 
```

将向用户显示为：

```
This is some sample text 
```

（具有预格式化文本的适当样式）

该视图已经具有显示所需的字符串`ViewData`，我只是不确定向用户显示它的最佳方式是什么。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-18T22:57:15.063

试试这个：

```
<%= System.Web.HttpUtility.HtmlDecode(yourEncodedHtmlFromYouDatabase) %> 
```

更多信息[在这里](http://msdn.microsoft.com/en-us/library/system.web.httputility.htmldecode.aspx)。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-08-09T06:21:40.390

Pure.Krome 提供的答案对于 MVC2 来说是完美无缺的，但请考虑 Razor 语法：

```
@Html.Raw(System.Web.HttpUtility.HtmlDecode(Model.yourEncodedHtmlFromYourDatabase)) 
```

或者，

```
@Html.Raw(Server.HtmlDecode(Model.yourEncodedHtmlFromYourDatabase)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-14T23:56:48.073

你想用`@Html.Raw(str)`.

有关详细信息，请参阅[MSDN](https://docs.microsoft.com/en-us/dotnet/api/system.web.mvc.htmlhelper.raw)。

> 返回非 HTML 编码的标记。
> 
> 此方法使用 IHtmlString 类包装 HTML 标记，该类呈现未编码的 HTML。

# sql - 在 T-SQL 中使用任意数量的参数

> ID：300427
> 
> 赞同：3
> 
> 时间：2008-11-18T22:44:35.980
> 
> 标签：sql, sql-server, tsql

是否可以创建一个带任意数量参数的参数化 SQL 语句？我试图让用户根据多个关键字过滤列表，每个关键字用分号分隔。因此，输入将类似于“Oakland;City;Planning”，而 WHERE 子句将与以下内容等效：

```
WHERE ProjectName LIKE '%Oakland%' AND ProjectName Like '%City%' AND ProjectName Like '%Planning%'
```

用连接创建这样一个列表真的很容易，但由于 SQL 注入漏洞，我不想采用这种方法。我有哪些选择？我是否创建了一堆参数并希望用户永远不要尝试使用我定义的更多参数？或者有没有办法安全地动态创建参数化 SQL？

性能并不是什么大问题，因为该表现在只有大约 900 行，并且不会很快增长，每年可能会增长 50 到 100 行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T19:38:50.720

一个基本的概念证明......实际代码会更少，但由于我不知道你的表/字段名称，这是完整的代码，所以任何人都可以验证它是否有效，调整它等等。

```
--Search Parameters

DECLARE @SearchString VARCHAR(MAX)
SET @SearchString='Oakland;City;Planning' --Using your example search
DECLARE @Delim CHAR(1)
SET @Delim=';' --Using your deliminator from the example

--I didn't know your table name, so I'm making it... along with a few extra rows...

DECLARE @Projects TABLE (ProjectID INT, ProjectName VARCHAR(200))
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 1, 'Oakland City Planning'
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 2, 'Oakland City Construction'
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 3, 'Skunk Works'
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 4, 'Oakland Town Hall'
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 5, 'Oakland Mall'
INSERT INTO @Projects (ProjectID, ProjectName) SELECT 6, 'StackOverflow Answer Planning'

--*** MAIN PROGRAM CODE STARTS HERE ***

DECLARE @Keywords TABLE (Keyword VARCHAR(MAX))

DECLARE @index int 
SET @index = -1 

--Each keyword gets inserted into the table
--Single keywords are handled, but I did not add code to remove duplicates
--since that affects performance only, not the result.

WHILE (LEN(@SearchString) > 0) 
  BEGIN  
    SET @index = CHARINDEX(@Delim , @SearchString)  
    IF (@index = 0) AND (LEN(@SearchString) > 0)  
      BEGIN   
        INSERT INTO @Keywords VALUES (@SearchString)
          BREAK  
      END  
    IF (@index > 1)  
      BEGIN   
        INSERT INTO @Keywords VALUES (LEFT(@SearchString, @index - 1))   
        SET @SearchString = RIGHT(@SearchString, (LEN(@SearchString) - @index))  
      END  
    ELSE 
      SET @SearchString = RIGHT(@SearchString, (LEN(@SearchString) - @index)) 
END

--This way, only a project with all of our keywords will be shown...

SELECT * 
FROM @Projects
WHERE ProjectID NOT IN (SELECT ProjectID FROM @Projects Projects INNER JOIN @Keywords Keywords ON CHARINDEX(Keywords.Keyword,Projects.ProjectName)=0) 
```

我决定将几个不同的答案混合在一起：-P

**这假设您将作为VARCHAR(MAX)**传入搜索关键字的分隔字符串列表（通过 @SearchString 传入） ，实际上，**您不会遇到关键字搜索的限制**。

每个关键字都从列表中分解并**添加到关键字表中。**您可能想要添加代码以删除重复的关键字，但在我的示例中不会受到伤害。只是效果稍差一些，因为理想情况下，我们只需要对每个关键字进行一次评估。

从那里，**任何不属于项目名称的关键字都会从列表中删除该项目**......

因此，搜索“奥克兰”会得到 4 个结果，但“奥克兰；城市；规划”只会得到 1 个结果。

您还可以更改分隔符，因此可以使用空格代替分号。或者任何让你的船漂浮的东西......

此外，由于连接和什么不是动态 SQL，它不会像您担心的那样冒 SQL 注入的风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:01:52.823

您可能还想考虑全文搜索并使用`CONTAINS`or`CONTAINSTABLE`以获得更“自然”的搜索功能。

对 1K 行来说可能有点矫枉过正，但它是写出来的，不容易被注入破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T22:51:57.837

诀窍通常是将列表作为以逗号分隔的字符串（csv 样式）简单地传递，在循环中解析该字符串并动态构建查询。

上面的帖子也是正确的，也许最好的方法不是 T-SQL，而是业务/应用程序层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T19:39:57.553

使用 XML 数据类型来包含参数怎么样？它可以在运行时无界和组装......

我传入未知数量的 PK 进行表更新，然后将它们泵入临时表。然后很容易更新 PKTempTable 中的 PK 位置。

这是解析 XML 数据类型的代码...

```
 INSERT INTO #ERXMLRead (ExpenseReportID)
    SELECT ParamValues.ID.value('.','VARCHAR(20)')
    FROM @ExpenseReportIDs.nodes('/Root/ExpenseReportID') as ParamValues(ID) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T22:48:39.153

使用像 NHibernate 这样的工具将允许您安全地动态构建查询，而无需存储过程。

Frans Bouma 有一篇关于存储过程与动态 sql 的[优秀文章](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)，以及使用 SQL 生成器的一些好处超过使用手动生成的语句

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T22:52:20.253

如果您使用存储过程，您可以包含参数的默认值，然后您可以选择在客户端代码中传递或不传递它们，但您仍然必须在存储过程中单独声明它们......也只有当您'正在使用存储过程，您可以将单个参数作为分隔的值字符串传递，并解析出存储过程中的各个值（有一些“标准” T-SQL 函数可用，可以将记录拆分为动态表变量为你）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T23:00:49.037

如果您使用 SQL Server 2008，请查看这篇文章 [传递表值参数](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/datacenter/?p=168)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T19:14:53.063

无论您采用哪种方式，请注意 SQL Server 的参数限制：~2000 个参数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T20:47:15.877

与其他一些答案类似，您可以解析出分隔字符串或 XML 文档。请参阅[此出色的链接](http://www.sommarskog.se/arrays-in-sql-2005.html#iter-list-of-strings)，该链接演示了 SQL Server 的两种方法。

# ruby-on-rails - 如何使我的 RoR 链接成为绝对链接？

> ID：300439
> 
> 赞同：2
> 
> 时间：2008-11-18T22:46:12.420
> 
> 标签：ruby-on-rails

`<%= link_to 'Show', buddy, :only`_`path => false %>`

似乎不起作用。我需要完整路径：[http ://www.my-server.com/buddy](http://www.my-server.com/buddy)

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T23:00:47.630

如果您在 routes.rb 中将 buddy 定义为资源：

```
map.resources :buddy 
```

那么您应该能够执行以下操作：

```
<%= link_to 'Show', buddy_url(buddy) %> 
```

# python - 如何在python中取消引用urlencoded unicode字符串？

> ID：300445
> 
> 赞同：53
> 
> 时间：2008-11-18T22:49:27.513
> 
> 标签：python, unicode, character-encoding, urllib, w3c

我有一个像“Tanım”这样的unicode字符串，它以某种方式编码为“Tan%u0131m”。如何将此编码字符串转换回原始 unicode。显然 urllib.unquote 不支持 unicode。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-18T23:22:44.060

%uXXXX 是一种[非标准的编码方案](http://en.wikipedia.org/wiki/Percent-encoding#Non-standard_implementations)，已被 w3c 拒绝，尽管实现仍然存在于 JavaScript 领域。

更常见的技术似乎是对字符串进行 UTF-8 编码，然后使用 %XX 对结果字节进行 % 转义。urllib.unquote 支持此方案：

```
>>> urllib2.unquote("%0a")
'\n' 
```

不幸的是，如果你真的**需要**支持 %uXXXX，你可能不得不推出自己的解码器。否则，可能更可取的是简单地 UTF-8 编码您的 unicode，然后 % 转义结果字节。

一个更完整的例子：

```
>>> u"Tanım"
u'Tan\u0131m'
>>> url = urllib.quote(u"Tanım".encode('utf8'))
>>> urllib.unquote(url).decode('utf8')
u'Tan\u0131m' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T23:22:24.703

```
def unquote(text):
    def unicode_unquoter(match):
        return unichr(int(match.group(1),16))
    return re.sub(r'%u([0-9a-fA-F]{4})',unicode_unquoter,text) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-18T23:32:49.127

如果你绝对必须这样做（我真的同意“非标准”的呼声），这将做到这一点：

```
from urllib import unquote

def unquote_u(source):
    result = unquote(source)
    if '%u' in result:
        result = result.replace('%u','\\u').decode('unicode_escape')
    return result

print unquote_u('Tan%u0131m')

> Tanım 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-16T03:13:58.407

上述版本中存在一个错误，有时当字符串中同时存在 ascii 编码和 unicode 编码字符时，它会吓坏。我认为它特别是当除了 unicode 之外还有 '\xab' 等高 128 范围内的字符时。

例如。“%5B%AB%u03E1%BB%5D”会导致此错误。

我发现如果你只是先做 unicode ，问题就消失了：

```
def unquote_u(source):
  result = source
  if '%u' in result:
    result = result.replace('%u','\\u').decode('unicode_escape')
  result = unquote(result)
  return result 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-07T14:41:41.143

您有一个使用[非标准编码方案](https://en.wikipedia.org/wiki/Percent-encoding#Non-standard_implementations)的 URL ，被标准机构拒绝，但仍由某些编码器生成。Python`urllib.parse.unquote()`函数无法处理这些。

幸运的是，创建自己的解码器并不难。`%uhhhh`这里的条目是*UTF-16*代码点，所以我们需要考虑[代理对](https://en.wikipedia.org/wiki/UTF-16#U+010000_to_U+10FFFF)。我还看到`%hh`混入了代码点，增加了混乱。

考虑到这一点，这里有一个可以在 Python 2 和 Python 3 中工作的解码器，前提是你`str`在 Python 3 中传入一个对象（Python 2 不太关心）：

```
try:
    # Python 3
    from urllib.parse import unquote
    unichr = chr
except ImportError:
    # Python 2
    from urllib import unquote

def unquote_unicode(string, _cache={}):
    string = unquote(string)  # handle two-digit %hh components first
    parts = string.split(u'%u')
    if len(parts) == 1:
        return parts
    r = [parts[0]]
    append = r.append
    for part in parts[1:]:
        try:
            digits = part[:4].lower()
            if len(digits) < 4:
                raise ValueError
            ch = _cache.get(digits)
            if ch is None:
                ch = _cache[digits] = unichr(int(digits, 16))
            if (
                not r[-1] and
                u'\uDC00' <= ch <= u'\uDFFF' and
                u'\uD800' <= r[-2] <= u'\uDBFF'
            ):
                # UTF-16 surrogate pair, replace with single non-BMP codepoint
                r[-2] = (r[-2] + ch).encode(
                    'utf-16', 'surrogatepass').decode('utf-16')
            else:
                append(ch)
            append(part[4:])
        except ValueError:
            append(u'%u')
            append(part)
    return u''.join(r) 
```

该函数深受[当前标准库实现](https://github.com/python/cpython/blob/1f58f4fa6a0e3c60cee8df4a35c8dcf3903acde8/Lib/urllib/parse.py#L569-L627)的启发。

演示：

```
>>> print(unquote_unicode('Tan%u0131m'))
Tanım
>>> print(unquote_unicode('%u05D0%u05D9%u05DA%20%u05DE%u05DE%u05D9%u05E8%u05D9%u05DD%20%u05D0%u05EA%20%u05D4%u05D8%u05E7%u05E1%u05D8%20%u05D4%u05D6%u05D4'))
איך ממירים את הטקסט הזה
>>> print(unquote_unicode('%ud83c%udfd6'))  # surrogate pair

>>> print(unquote_unicode('%ufoobar%u666'))  # incomplete
%ufoobar%u666 
```

该函数适用于 Python 2（在 2.4 - 2.7 上测试）和 Python 3（在 3.3 - 3.8 上测试）。

# delphi - 将启用 unicode 的 Delphi 2006 应用程序移植到 Delphi 2009

> ID：300446
> 
> 赞同：5
> 
> 时间：2008-11-18T22:49:50.993
> 
> 标签：delphi, unicode, delphi-2009

我有一个在 Delphi 2006 中完全兼容 unicode 的应用程序。我已将所有 AnsiStrings 替换为 WideStrings，将所有 VCL 控件替换为 TNT 控件，并将所有字符串函数从 AnsiStrings 更改为 WideStrings。看起来所有这些工作都是徒劳的，因为我将不得不扭转这一切。有没有办法让 Delphi 2009 认为 Widestrings 实际上是 UnicodeStrings？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-18T23:28:00.557

不，真的没有。但是您不会后悔为真正的 Unicode 启用您的应用程序所做的工作。

TNT 控件可以很容易地替换为常规的 VCL 控件。您可以非常简单地使用 GExperts ( [http://www.gexperts.org](http://www.gexperts.org) ) 中的向导来自动将一种控件类型替换为另一种控件类型。

然后，您可以将所有 WideString 声明更改为常规字符串。String 现在是 UnicodeString 的别名，因此您的所有字符串都可以很好地保存 Unicode 数据。

顺便说一句，TNT 控件的作者 Troy Wolbrink 现在比他自己的控件更喜欢 Delphi 2009。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T08:29:00.403

TNT Controls 的主要优点只是它可以在 Windows 9x 中作为 Ansi 程序运行。它不是完整的 unicode。如果您希望在任何地方都获得完整的 unicode 支持（例如 Stringlist.LoadFromFile、Form.OnKeyPress），最好迁移到 Delphi 2009。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T11:26:41.837

我在使用不同 XML 文件作为输入的应用程序中做了同样的事情。就我而言，我在整个程序中使用 UTF-8（因此我们可以使用常规字符串），并且仅转换为 WideString 用于显示目的（TNT 控件）。

我删除了 WideString 和 UTF-8 之间的来回转换，并手动将 TNT 控件替换为常规 VCL 控件，因为只有少数表格。

转换大约需要一个小时进行测试。代码更简单，程序明显更快。

# css - 使用图像的 CSS 无边框标签

> ID：300448
> 
> 赞同：3
> 
> 时间：2008-11-18T22:51:24.937
> 
> 标签：css

在选项卡所在的 Stack Overflow 的用户页面上（统计信息、最近的、响应等），您会产生一种错觉，即选项卡是它们所在行的扩展。Stack Overflow 通过定义纯 CSS 边框来创建这种效果。我想达到相同的效果，但我有标签和他们所在的行的图像。

我有一个带圆角的盒子（白色背景，灰色轮廓）。标签在顶部，相同的颜色。选项卡具有圆角顶角，没有底部边框。选项卡位于框的 div 之前的 div 中。

为了实现上述效果，我想标签必须下降并覆盖它们相遇的框边框的那部分。我在 Firefox 中完成了此操作，但在 IE 中您仍然可以看到框的边框线。

您如何调整它以在两种浏览器中工作？

这是我在 FF 中有效但在 IE 中无效的示例：[http ://www.mcrackan.com/recipes/csstest-loggedin.htm](http://www.mcrackan.com/recipes/csstest-loggedin.htm)

[**编辑：**固定网址]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T22:59:18.680

可能是[推拉门技术](http://www.alistapart.com/articles/slidingdoors2/)可以派上用场

此[示例](http://www.alistapart.com/d/slidingdoors2/v1/ex9.html)在 Firefox 和 IE 中有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T00:06:34.270

我以前做过类似的事情，给“活动”选项卡类一个负的底部位置，从而移动它，使它位于框架边框的顶部。也许是解决方案？例如：

```
<style>
ul.tabs {
border-bottom: 1px solid blue;
height: 20px;
margin: 0;
padding: 0;
list-style-type: none;
}
    ul.tabs li {
    float: left;
    position: relative;
    bottom: 5px;
    margin: 0;
    padding: 0;
    }
        ul.tabs li img {
        float: left;
        height: 20px;
        width: 50px;
        border: none;
        }
    ul.tabs li.selected {
    bottom: -1px;
    }
</style>

<ul class="tabs">
    <li><a href=""><img src="tab1.gif" /></a></li>
    <li class="selected"><a href=""><img src="tab2.gif" /></a></li>
    <li><a href=""><img src="tab3.gif" /></a></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T01:57:29.163

虽然我后来开始自己动手，但当我第一次弄清楚 CSS 选项卡时，对我帮助最大的一个例子是：

[http://unraveled.com/projects/css_tabs/](http://unraveled.com/projects/css_tabs/)

这种相对定位的方法通常是最适合我的。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T02:06:15.660

这个[标签生成器](http://www.pagecolumn.com/tool/top_tabs_generator.htm)可能会有所帮助。

# c# - 你如何获得进程所有者的用户名？

> ID：300449
> 
> 赞同：16
> 
> 时间：2008-11-18T22:51:54.903
> 
> 标签：c#, .net, process

我正在尝试获取当前用户 ( `Environment.UserName`) 当前拥有的进程列表。不幸的是，`Process`该类没有任何方法可以获取拥有进程的用户的用户名。

您如何获取用户的用户名，该用户是使用`Process`该类的进程的所有者，以便我可以将其与`Environment.UserName`？

如果您的解决方案需要`pinvoke`，请提供代码示例。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-18T23:23:18.600

谢谢，您的回答使我走上了正确的道路。对于那些需要代码示例的人：

```
public class App
{
    public static void Main(string[] Args)
    {
        Management.ManagementObjectSearcher Processes = new Management.ManagementObjectSearcher("SELECT * FROM Win32_Process");

        foreach (Management.ManagementObject Process in Processes.Get()) {
            if (Process["ExecutablePath"] != null) {
                string ExecutablePath = Process["ExecutablePath"].ToString();

                string[] OwnerInfo = new string[2];
                Process.InvokeMethod("GetOwner", (object[]) OwnerInfo);

                Console.WriteLine(string.Format("{0}: {1}", IO.Path.GetFileName(ExecutablePath), OwnerInfo[0]));
            }
        }

        Console.ReadLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-18T23:22:25.420

CodeProject 文章[How To Get Process Owner ID and Current User SID](http://www.codeproject.com/KB/cs/processownersid.aspx) by [Warlib](http://www.codeproject.com/script/Membership/Profiles.aspx?mid=856529)描述了如何使用 WMI 和通过 PInvoke 使用 Win32 API 来做到这一点。

WMI 代码更简单，但执行速度较慢。您的问题并未表明哪个更适合您的场景。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T22:56:21.977

您可能会考虑使用 System.Management (WMI)。有了它，您可以查询 Win32_Process 树。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T22:57:59.570

这是标有“Win32_Process 类的 GetOwner 方法”的[MS 链接](http://msdn.microsoft.com/en-us/library/aa390460.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-22T20:29:55.743

如果不是计算机管理员，您将很难获得用户名。

除非您是管理员，否则使用 WMI、通过 OpenProcess 或使用 WTSEnumerateProcesses 的任何方法都不会为您提供用户名。尝试启用 SeDebugPrivilege 等也不起作用。我仍然需要看到一个无需管理员即可工作的代码。

如果有人知道如何在不成为正在运行的机器上的管理员的情况下获得它，请写下如何做到这一点，因为我还没有找到如何为服务用户启用该级别的访问权限。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-27T11:11:02.840

支持 Andrew Moore 的回答，我只是格式化它，因为它没有在 C# 3.5 中编译。

```
private string GetUserName(string procName)
{
    string query = "SELECT * FROM Win32_Process WHERE Name = \'" + procName + "\'";
    var procs = new System.Management.ManagementObjectSearcher(query);
    foreach (System.Management.ManagementObject p in procs.Get())
    {
        var path = p["ExecutablePath"];
        if (path != null)
        {
            string executablePath = path.ToString();
            string[] ownerInfo = new string[2];
            p.InvokeMethod("GetOwner", (object[])ownerInfo);
            return ownerInfo[0];
        }
    }
    return null;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-18T18:12:44.787

**您需要添加对 System.Management.dll 的引用才能使其正常工作。**

这是我最终使用的。它适用于 .NET 3.5：

```
using System.Linq;
using System.Management;

class Program
{
    /// <summary>
    /// Adapted from https://www.codeproject.com/Articles/14828/How-To-Get-Process-Owner-ID-and-Current-User-SID
    /// </summary>
    public static void GetProcessOwnerByProcessId(int processId, out string user, out string domain)
    {
        user = "???";
        domain = "???";

        var sq = new ObjectQuery("Select * from Win32_Process Where ProcessID = '" + processId + "'");
        var searcher = new ManagementObjectSearcher(sq);
        if (searcher.Get().Count != 1)
        {
            return;
        }
        var process = searcher.Get().Cast<ManagementObject>().First();
        var ownerInfo = new string[2];
        process.InvokeMethod("GetOwner", ownerInfo);

        if (user != null)
        {
            user = ownerInfo[0];
        }
        if (domain != null)
        {
            domain = ownerInfo[1];
        }
    }

    public static void Main()
    {
        var processId = System.Diagnostics.Process.GetCurrentProcess().Id;
        string user;
        string domain;
        GetProcessOwnerByProcessId(processId, out user, out domain);
        System.Console.WriteLine(domain + "\\" + user);
    }
} 
```

# gnu - gnuwin32 程序：[.exe 有什么作用？

> ID：300472
> 
> 赞同：3
> 
> 时间：2008-11-18T22:58:56.793
> 
> 标签：gnu, gnuwin32

查看 gnuwin32/bin 目录，有一个看起来很奇怪的程序文件，名为`[.exe`

我在文档 gnuwin32.sourceforge.net 或谷歌搜索中找不到它，所以我运行它并得到：

```
$ [
[: missing `]'
$ 
```

所以我把它 ] 作为参数并得到了

```
$ [ ]

$ 
```

它没有抱怨，所以我认为它在正确的轨道上。我试过：

```
$ [ hello ] 
```

再次，没有投诉。所以我尝试了一个算术表达式：

```
$ [ 1 + 1 ]
[: +: binary operator expected
$ 
```

我尝试了一堆不同的组合，包括前缀和后缀表示法，但似乎没有任何效果。这东西有什么作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T23:00:02.580

```
test a 
```

==

```
[ a ] 
```

这只是糖

编辑：为了澄清，这是条件语法，例如 [ "a" = "a" ]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T23:12:38.700

它用于评估*条件*表达式。
它相当于（可能是符号链接？）`test`可执行文件。
手册页在[这里](http://www.ss64.com/bash/test.html)。

您可能会在很多 bash 脚本中看到这一点：

```
if [ "$LOGNAME" = "scott" ]
then
    echo "Logged in as Scott"
else
     echo "incorrect user"
fi 
```

有趣的是，**`[`**它不是 bash 语言的一部分，它实际上是一个可执行文件，它的返回码被 'IF' 使用。这就是为什么 the 后面的空格**`[`**和它的第一个参数是强制性的 - 如果它被省略，脚本将尝试执行**`["$LOGNAME"`**并失败。

你不能用它做算术运算——用它来做**`expr`**（见[这里](http://www.ss64.com/bash/expr.html)）。但是，您可以测试各种文件属性（它是否存在？它是什么类型？等等）以及对字符串和数字使用比较运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T10:50:50.710

已经提到的另一个答案与 相同`test`。在 bash 上，它也是一个内置函数，因此您可以使用内置函数`help`( `help test`) 获得帮助。

# ms-word - 防止另存为功能

> ID：300487
> 
> 赞同：0
> 
> 时间：2008-11-18T23:03:39.280
> 
> 标签：ms-word, encrypting-file-system

我需要防止文档被保存/另存为（比如从 ms word 中）。我环顾四周，并没有找到令人满意的答案。我考虑过 EFS... 但我认为它不会阻止用户将文档另存为...（尽管它会阻止访问原始源文件）。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T19:32:52.323

在具有只读磁盘、没有网络和可移动驱动器的完全锁定的系统上运行它。对计算机的访问也必须受到物理限制。

这应该会阻止“另存为”工作，但仍不会阻止文档被复制（有人可能会对屏幕拍照并对其进行 OCR）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:40:40.343

禁用“另存为”通常是不值得的，因为您首先需要访问原始文件才能打开它。总有办法复制文件。

当有人要求我禁用 PDF 的另存为时，我遇到了同样的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T00:00:13.847

无法获取任意文档并以无法保存的方式对其进行修改。您可以修改诸如 Word 之类的程序以不允许保存或另存为，但这仍然允许某人使用不同的程序或在不同的计算机上打开和保存文档。

# project-management - 基于证据的调度是否适用于异质估计？

> ID：300488
> 
> 赞同：2
> 
> 时间：2008-11-18T23:03:43.507
> 
> 标签：project-management, scheduling, fogbugz

在一个项目期间观察一年的估算，我发现了一些奇怪的事情，这让我想知道基于证据的调度是否可以在这里工作？

*   个别程序员似乎有最喜欢的数字（例如 2、4、8、16、30 小时）
*   大任务似乎被一个固定值（大约 2）低估了，但这里的标准偏差很低
*   小任务（1 或 2 小时）绝对分布广泛。平均而言，它们具有相同的平均低估因子 2，但标准偏差很高：
    *   大约 5 分钟的拼写问题估计需要 1 小时
    *   其他错误修复估计也需要 1 小时，但需要一天

那么，让程序员在估算期间将 30 小时的任务分解为 4 或 2 小时的步骤真的是个好主意吗？这不会提高标准偏差吗？（好吧，让他们把它分解——但也许在估计之后？！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T23:36:33.753

*   是的，您的观察正是 EBS 旨在解决的问题。
*   是的，分解更大的任务很重要。或多或少地拍摄 1-2 天的任务。
    *   如果您有估计在 2 小时内的事情，请查看将它们分组是否有意义。（可能不会——没关系！）
    *   如果您有估计需要 3 天以上的任务，请查看是否有办法将它们分成几部分。应该有。如果估计者说没有，让他们为这个断言辩护。如果事实证明这项任务真的只需要 3 天，那很好，但是你拥有的这些越多，你就越应该仔细照镜子，看看人们是否没有在玩这个系统。
    *   将 4 天和 5 天的估计数算作 2 倍和 4 倍于 3 天的估计。如果有人说某件事需要超过 5 天的时间并且无法分解，请告诉他们您希望他们花 4 小时思考问题以及如何分解问题。请记住，这是一项任务，顺便说一句。
*   当你和你的团队练习这个时，你会更好地估计。
*   ...您还将开始识别失败的模式，并且解决方案将出现。
*   **基于证据**的日程安排的重点是使用**证据**作为日程安排的基础，而不是一堆疯狂的猜测。这是*一件好事*......！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T23:33:13.620

我认为这是个好主意。当人们分解任务时——他们会弄清楚任务的细节，你可能会在这里和那里得到小的偏差，这种或那种方式，他们可能会补偿或不补偿......但你会感觉到正在发生的事情。如果您有 30 个小时的巨大任务 - 可能会花费 100 个小时。这是可能发生的最糟糕的情况。管理风险 - 分解。你已经弄清楚了这些小偏差——你知道如何处理它们。

因此，请确保开发人员也知道他们所做的和所说的 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T00:03:28.037

“那么，让程序员在估算期间将 30 小时的任务分解为 4 或 2 小时的步骤真的是个好主意吗？这不会提高标准偏差吗？（好吧，让他们分解——但也许在估计？！）”

我当然完全不明白这个问题。

你在说什么（你可能不是*这么*说，但听起来确实如此）

1.  程序员根本无法估计——这些数字总是四舍五入到“神奇”值，并减少 2 倍。

2.  我不能相信他们既能定义工作又能估计完成工作所需的时间。

3.  只有我知道完成任务所需时间的正确估计。这不是一轮 1/2 天的倍数。这是精确的分钟数。

这是我的后续问题：

你在说什么？你不能做什么？你有什么问题？为什么你认为程序员估计不好？为什么不能信任他们估计？

从你的陈述来看，没有任何问题。您可以计划并执行该计划。我会说你是完全成功的并且在这方面做得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T10:26:24.160

好的，我有答案了。是的，这是正确的，我所做的观察（见问题）是完全可以理解的。可以肯定的是，我做了一个小的 Excel 模拟来确保我自己的猜测。

如果将多个具有高标准偏差的小任务添加到更大的任务中，它们的偏差将更低，因为小任务部分补偿了不确定性。

所以答案是：是的，它会起作用，如果你分解你的任务，使它们的长度大致相同。这是因为模拟会自动对更大的任务进行补偿。我不需要担心较小任务中的更高标准偏差。

*但我相信你**不能**把低估计任务和高估计任务混为一谈——因为它们根本没有相同的方差。*

因此，最好将它们分解。:)

* * *

我做的Excel模拟：

*   使用这些列创建 50 行：
    *   首先 - 一个固定值 2（非常均匀的估计）
    *   20 列带有一些随机函数（例如“=rand()*rand()*20”）
*   对每一列求和
*   为每个随机列添加“=VARIANCE(..)”
*   并为总和添加方差计算

我的模拟中每列的方差约为 2-3，总和的方差低于 1。

# version-control - 为什么将带有尾随空格的行提交到源代码管理中是不好的？

> ID：300489
> 
> 赞同：22
> 
> 时间：2008-11-18T23:04:09.263
> 
> 标签：version-control

为什么将带有尾随空格的行签入源代码控制是不好的？这会导致什么样的问题？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-18T23:06:00.350

基本上是错误的差异。如果差异仅显示“真实”更改，这将很有帮助。一些差异程序会忽略空格，但最好首先避免虚拟更改。

当然，如果在同事的机器上换行也无济于事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T23:19:09.653

这就像粉刷你的墙壁，但没有正确地完成边缘，并直接进入踢脚板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T23:07:30.783

因为很多人删除它们，如果你不使用所有选项（比如普通的旧 cvs diff），你会让它们在 diff 工具中显示为修改的行，这意味着人们无缘无故地看到你的行。

从理论上讲，您还可以使用字符串来包装空白真正不好的行，但是……可能不是您的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T23:39:04.857

有些编辑器会自动删除尾随空格，有些则不会。这会产生差异噪声并可能导致合并冲突。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T23:16:51.047

是的，我有点同意其他帖子，但我要补充一点，它*本身*还不错。这不是一个很好的练习，但这就是发生的事情，你只是叹了口气，然后继续做下去。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T23:20:57.543

现代差异实用程序不会挂在空白上。

# java - 如何通过连接和基于行的限制（分页）在休眠中获得不同的结果？

> ID：300491
> 
> 赞同：76
> 
> 时间：2008-11-18T23:05:13.690
> 
> 标签：java, hibernate, paging, criteria, distinct

我正在尝试在连接到其他表的 Hibernate Criteria 查询上使用基于行的限制（例如：`setFirstResult(5)`和）来实现分页。`setMaxResults(10)`

可以理解的是，数据被随机截断。其原因在[这里](https://developer.jboss.org/wiki/HibernateFAQ-AdvancedProblems#jive_content_id_Hibernate_does_not_return_distinct_results_for_a_query_with_outer_join_fetching_enabled_for_a_collection_even_if_I_use_the_distinct_keyword)解释。

作为一种解决方案，该页面建议使用“第二个 sql 选择”而不是连接。

如何将现有的条件查询（使用 连接`createAlias()`）转换为使用嵌套选择？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-11-19T00:53:36.903

您可以通过请求不同的 id 列表而不是不同的水合对象列表来获得所需的结果。

只需将其添加到您的标准中：

```
criteria.setProjection(Projections.distinct(Projections.property("id"))); 
```

现在，您将根据基于行的限制获得正确数量的结果。之所以可行，是因为投影将作为 sql 查询**的一部分**执行区别性检查，而不是 ResultTransformer在执行 sql 查询**后**过滤结果的区别性。

值得注意的是，您现在将获得一个 id 列表，而不是获取对象列表，您可以使用它来在以后从休眠状态中对对象进行水合。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-12-03T06:56:52.433

我在我的代码中使用这个。

只需将其添加到您的标准中：

> 标准.setResultTransformer（标准.DISTINCT_ROOT_ENTITY）；

该代码将类似于从本机 sql 的表中选择不同的 *。希望这个有帮助。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-10-27T04:43:57.447

基于 FishBoy 的建议略有改进。

可以一次完成这种查询，而不是分两个单独的阶段。即下面的单个查询将正确分页不同的结果，并且还返回实体而不仅仅是ID。

只需使用带有 id 投影的 DetachedCriteria 作为子查询，然后在主 Criteria 对象上添加分页值。

它看起来像这样：

```
DetachedCriteria idsOnlyCriteria = DetachedCriteria.forClass(MyClass.class);
//add other joins and query params here
idsOnlyCriteria.setProjection(Projections.distinct(Projections.id()));

Criteria criteria = getSession().createCriteria(myClass);
criteria.add(Subqueries.propertyIn("id", idsOnlyCriteria));
criteria.setFirstResult(0).setMaxResults(50);
return criteria.list(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-08T15:04:32.077

@FishBoy 建议的一个小改进是使用 id 投影，因此您不必对标识符属性名称进行硬编码。

```
criteria.setProjection(Projections.distinct(Projections.id())); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-04-16T11:07:31.047

解决方案：

```
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 
```

效果很好。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-01-24T13:12:50.603

```
session = (Session) getEntityManager().getDelegate();
Criteria criteria = session.createCriteria(ComputedProdDaily.class);
ProjectionList projList = Projections.projectionList();
projList.add(Projections.property("user.id"), "userid");
projList.add(Projections.property("loanState"), "state");
criteria.setProjection(Projections.distinct(projList));
criteria.add(Restrictions.isNotNull("this.loanState"));
criteria.setResultTransformer(Transformers.aliasToBean(UserStateTransformer.class)); 
```

这对我有帮助：D

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-14T16:01:59.207

如果您想使用 ORDER BY，只需添加：

```
criteria.setProjection(
    Projections.distinct(
        Projections.projectionList()
        .add(Projections.id())
        .add(Projections.property("the property that you want to ordered by"))
    )
); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-06T14:44:45.617

我现在将解释一个不同的解决方案，您可以在其中使用正常的查询和分页方法，而不会出现可能重复或抑制项目的问题。

该解决方案具有以下优点：

*   比本文提到的PK id解决方案更快
*   保留排序，不要在可能较大的 PK 数据集上使用“in 子句”

完整的文章可以在[我的博客上找到](http://hartmann-schneevoigt.com/2012/07/06/how-to-get-distinct-results-in-hibernate-with-joins-and-row-based-paging/)

Hibernate 不仅可以在设计时定义关联获取方法，还可以在运行时通过查询执行来定义关联获取方法。因此，我们将这种方法与一个简单的 relfection 东西结合使用，并且还可以自动更改仅针对集合属性的查询属性获取算法的过程。

首先，我们创建一个从实体类解析所有集合属性的方法：

```
public static List<String> resolveCollectionProperties(Class<?> type) {
  List<String> ret = new ArrayList<String>();
  try {
   BeanInfo beanInfo = Introspector.getBeanInfo(type);
   for (PropertyDescriptor pd : beanInfo.getPropertyDescriptors()) {
     if (Collection.class.isAssignableFrom(pd.getPropertyType()))
     ret.add(pd.getName());
   }
  } catch (IntrospectionException e) {
    e.printStackTrace();
  }
  return ret;
} 
```

之后，您可以使用这个小助手方法建议您的条件对象在该查询中将 FetchMode 更改为 SELECT。

```
Criteria criteria = …

//    … add your expression here  …

// set fetchmode for every Collection Property to SELECT
for (String property : ReflectUtil.resolveCollectionProperties(YourEntity.class)) {
  criteria.setFetchMode(property, org.hibernate.FetchMode.SELECT);
}
criteria.setFirstResult(firstResult);
criteria.setMaxResults(maxResults);
criteria.list(); 
```

这样做与在设计时定义实体的 FetchMode 不同。因此，您可以在 UI 中对分页算法使用正常的连接关联获取，因为这在大多数情况下不是关键部分，并且尽可能快地获得结果更为重要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-08T07:21:11.380

下面是我们可以通过多重投影来执行 Distinct 的方法

```
 package org.hibernate.criterion;

import org.hibernate.Criteria;
import org.hibernate.Hibernate;
import org.hibernate.HibernateException;
import org.hibernate.type.Type;

/**
* A count for style :  count (distinct (a || b || c))
*/
public class MultipleCountProjection extends AggregateProjection {

   private boolean distinct;

   protected MultipleCountProjection(String prop) {
      super("count", prop);
   }

   public String toString() {
      if(distinct) {
         return "distinct " + super.toString();
      } else {
         return super.toString();
      }
   }

   public Type[] getTypes(Criteria criteria, CriteriaQuery criteriaQuery) 
   throws HibernateException {
      return new Type[] { Hibernate.INTEGER };
   }

   public String toSqlString(Criteria criteria, int position, CriteriaQuery criteriaQuery) 
   throws HibernateException {
      StringBuffer buf = new StringBuffer();
      buf.append("count(");
      if (distinct) buf.append("distinct ");
        String[] properties = propertyName.split(";");
        for (int i = 0; i < properties.length; i++) {
           buf.append( criteriaQuery.getColumn(criteria, properties[i]) );
             if(i != properties.length - 1) 
                buf.append(" || ");
        }
        buf.append(") as y");
        buf.append(position);
        buf.append('_');
        return buf.toString();
   }

   public MultipleCountProjection setDistinct() {
      distinct = true;
      return this;
   }

} 
```

ExtraProjections.java

```
package org.hibernate.criterion; 

public final class ExtraProjections
{ 
    public static MultipleCountProjection countMultipleDistinct(String propertyNames) {
        return new MultipleCountProjection(propertyNames).setDistinct();
    }
} 
```

样品用法：

```
String propertyNames = "titleName;titleDescr;titleVersion"

criteria countCriteria = ....

countCriteria.setProjection(ExtraProjections.countMultipleDistinct(propertyNames); 
```

引用自[https://forum.hibernate.org/viewtopic.php?t=964506](https://forum.hibernate.org/viewtopic.php?t=964506)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-05-19T09:46:14.810

`NullPointerException`在某些情况下！没有`criteria.setProjection(Projections.distinct(Projections.property("id")))` 所有查询顺利！这个解决方案很糟糕！

另一种方法是使用 SQLQuery。在我的情况下，以下代码可以正常工作：

```
List result = getSession().createSQLQuery(
"SELECT distinct u.id as usrId, b.currentBillingAccountType as oldUser_type,"
+ " r.accountTypeWhenRegister as newUser_type, count(r.accountTypeWhenRegister) as numOfRegUsers"
+ " FROM recommendations r, users u, billing_accounts b WHERE "
+ " r.user_fk = u.id and"
+ " b.user_fk = u.id and"
+ " r.activated = true and"
+ " r.audit_CD > :monthAgo and"
+ " r.bonusExceeded is null and"
+ " group by u.id, r.accountTypeWhenRegister")
.addScalar("usrId", Hibernate.LONG)
.addScalar("oldUser_type", Hibernate.INTEGER)
.addScalar("newUser_type", Hibernate.INTEGER)
.addScalar("numOfRegUsers", Hibernate.BIG_INTEGER)
.setParameter("monthAgo", monthAgo)
.setMaxResults(20)
.list(); 
```

**区分是在数据库中完成的！**与以下相反：

```
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 
```

加载实体后，在内存中进行区分！

# .net - 将 DLL 和 EXE 合并到单个 EXE 文件中的缺点

> ID：300496
> 
> 赞同：4
> 
> 时间：2008-11-18T23:08:09.987
> 
> 标签：.net

我正在开发一个 .NET 应用程序，它使用了我从其他内部项目拼凑而成的几个项目。[我正在考虑使用名为ILMerge](http://research.microsoft.com/~mbarnett/ilmerge.aspx)的工具将 .exe 和 DLLS 合并到一个可执行文件中。

我可能会将可执行文件发送到公司外部，因此将所有内容合并到一个文件中会更容易传递。但是，我想知道将 DLL 与可执行文件合并是否有任何缺点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-18T23:14:04.953

只要它们是您的库，我认为它没有什么大问题。除非它使图像变得绝对巨大，否则我认为如果可执行文件尽可能多地依赖自身会更好（当然，当您复制系统功能时......没有意义）。

另一方面，如果这些库实际上并不属于您，您最好确保它们的使用条款允许这样做。您可能不被允许将它们打包到您的可执行文件中并将它们作为您自己的代码分发（即使您放弃了您的产品并且该库是“免费的”，您可能仍然必须承认您使用它的方式，所以请确保检查您包含的*所有*库的使用条款）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T23:28:13.253

共享库的许多优点源于它们实际上是共享的。您是否有其他应用程序使用相同的 DLL，这些 DLL 也公开分发或将来可能会分发？如果是这样，那么坚持使用共享库可以带来几个好处。通常，即使多个应用程序使用它，也只会将库的一份副本存储在内存中，因此可以减少内存使用量。它还简化了升级，因为对库的更改只会影响 DLL 本身，就像它静态链接到一个或多个应用程序一样，当库更改时，它们都必须升级。

自从我对 .NET 做了很多工作以来已经有一段时间了，但我总是对 GAC 以及它提供的库版本支持感到相当满意。您是否有*不*使用共享库的令人信服的理由？我怀疑在大多数情况下，将应用程序减少到单个文件并不足以抵消潜在的优势。

# javascript - 如何在 JS Rails 响应中包含 HTML？

> ID：300498
> 
> 赞同：15
> 
> 时间：2008-11-18T23:08:46.257
> 
> 标签：javascript, ruby-on-rails, ruby, erb

我有一个响应 HTML 和 JS (AJAX) 查询的 FooController：

```
# app/controllers/foo_controller.rb:
class FooController < ApplicationController
  layout 'foo'
  def bar
    respond_to do |format|
      format.html # foo/bar.html.erb
      format.js   # foo/bar.js.erb
    end
  end
end 
```

支持它的模板：

```
# app/views/layouts/foo.html.erb:
<html>...<%= yield %>...</html>

# app/views/layouts/foo.json.erb:
<%= yield %> 
```

还有一个 AJAX 模板，我想在其中呈现部分内容：

```
# app/views/foo/bar.js.erb:
dojo.byID('some_div').innerHTML = "<%= escape_javascript(render(:partial => 'some/partial')) %>"; 
```

如果 JS 模板中只有普通的旧 JS（如`alert('hi');`），它使用我的 JS 模板。但是，当我放入 render(:partial) 时，它会使整个响应使用 HTML 模板，这意味着它不再是有效的 JS。

一种可能的解决方案是使用布局函数：

```
class FooController < ApplicationController
  layout :choose_layout
  ...
  private
  def choose_layout
    return nil if request.xhr?
    'foo'
  end
end 
```

但我的版本*应该可以*工作！为什么不呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T13:30:51.120

最近的[Railscast 涵盖了这个主题（使用 jQuery）](http://railscasts.com/episodes/136-jquery)。

我不太清楚你可能会出错的地方，但这里有一个来自 Railscast 的片段，它可以很好地渲染部分：

```
// views/reviews/create.js.erb
$("#new_review").before('<div id="flash_notice"><%= escape_javascript(flash.delete(:notice)) %></div>');
$("#reviews_count").html("<%= pluralize(@review.product.reviews.count, 'Review') %>");
$("#reviews").append("<%= escape_javascript(render(:partial => @review)) %>");
$("#new_review")[0].reset(); 
```

你在哪里存储你的Javascript？你有一个 Application.js 来保存东西吗？如果是这样，您是否在 javascript_include_tag 中的“应用程序”之前包含“dojo”？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T03:35:44.920

尝试以下操作；

```
class FooController < ApplicationController
  layout 'foo'
  def bar
    respond_to do |format|
      format.html
      format.js { render :layout => false }
    end
  end
end 
```

希望有帮助。

JK

# c# - .NET 程序员必须具备的 CLR 最低知识是什么才能成为一名优秀的程序员？

> ID：300499
> 
> 赞同：17
> 
> 时间：2008-11-18T23:08:57.257
> 
> 标签：c#, .net, clr

当我们谈论 .NET 世界时，我们所做的一切都依赖于 CLR。.NET 程序员必须具备的 CLR 最低知识是什么才能成为一名优秀的程序员？你能给我一个/许多你认为是/是最重要的主题：GC？、AppDomain？、Threads？、Processes？、Assemblies/Fusion？

如果您发布有关可以找到更多信息的主题的文章、博客、书籍或其他内容的链接，我将非常感激。

更新：我从一些评论中注意到我的问题有些人不清楚。当我说 CLR 时，我不是指 .Net Framework。这不是要记住 .NET 库，而是要了解执行环境（这些库在运行时所在的环境）如何工作。

我的问题直接受到“Debugging Applications for Microsoft® .NE​​T”一书（我推荐）的作者 John Robbins 的启发，他的同事在这里引用了 Wintellect 的 Jeffrey Richter。在其中一个介绍性章节中，他说“......任何 .NET 程序员都应该知道什么是探测以及如何将程序集加载到运行时”。你认为还有其他这样的事情吗？

最后更新：在阅读了“通过 C# 进行 CLR”的前 5 章后，我必须对阅读本文的任何人说。如果您还没有准备好，请阅读本书！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-18T23:13:17.340

根据我的经验，其中大多数比许多开发人员所迷恋的东西要深得多。在我的经验中，最容易被误解（也是重要）的方面：

*   值类型与引用类型
*   变量与对象
*   按引用传递与按值传递
*   代表和活动
*   区分语言、运行时和框架
*   拳击
*   垃圾收集

在“变量 vs 对象”前面，这里是关于代码的三个陈述

```
string x = "hello"; 
```

*   （非常糟糕）`x`是一个包含 5 个字母的字符串
*   （稍微好一点）`x`是对包含 5 个字母的字符串的引用
*   （正确） 的值`x`是对包含 5 个字母的字符串的引用

显然，前两个在“随意”对话中是可以的，但前提是每个相关人员都了解真实情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T00:22:24.500

一个*伟大的*程序员不能用他对 CLR 了解的数量来衡量。当然这是一个不错的开始，但他还必须了解 OOP/D/A 和许多其他知识，例如设计模式、最佳实践、O/RM 概念等。

事实上，我想说一个“伟大的 .Net 程序员”根本不需要对 CLR 有太多了解，只要他对一般编程理论和概念有很好的了解......

我宁愿聘请具有丰富的 Java 知识和经验的“出色的 Java 开发人员”来从事 .Net 工作，然后是 .Net 中的“大师”，他们几乎没有经验，并且认为 O/RM 是股票行情，存储过程非常棒“抽象数据库”的方法......

我见过.Net 中的*专业教师*由于缺乏“一般知识”而在做非常简单的事情时完全失败，而他们同时“了解所有”关于 .Net 和 CLR 的知识。 .

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-18T23:13:01.570

更新：阅读 Jeffrey Richter 通过 C# 编写的 CLR 一书的相关部分。这本书可以作为一个很好的参考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T23:47:50.627

应该了解内存管理，代表

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T20:24:31.940

Jon 的回答对我（加上代表）来说似乎很完整，但我认为从根本上区分优秀程序员与普通程序员的区别是回答为什么问题而不是如何回答问题。了解垃圾回收的工作原理以及值类型和引用类型的工作方式固然很棒，但了解何时使用值类型与引用类型则是另一个层面。这是用一种语言说话与用一种语言发表演讲之间的区别（这完全取决于我们如何应用我们所拥有的知识以及我们如何做出这些决定）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T23:24:02.700

乔恩的回答很好。这些都是很多开发人员没有很好理解的基本但重要的领域。我认为了解值类型和引用类型之间的区别与基本了解 .NET 中 GC 的行为方式有关，但更重要的是，对 Dispose 模式的良好理解很重要。

您提到的其他领域要么是关于 CLR 本身的非常深入的知识，要么是（尚未）广泛使用的更高级的概念。[.NET 4.0 将通过引入并行扩展和 MEF 开始改变其中的一些。]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T00:06:24.610

一件很难掌握的事情是延迟执行之类的。

你如何解释返回 IEnumerable 的方法是如何工作的？代表的真正作用是什么？像这样的东西。

# java - 如何使用 Java 中的锚启动文件协议 URL？

> ID：300509
> 
> 赞同：12
> 
> 时间：2008-11-18T23:12:58.950
> 
> 标签：java, file, uri, anchor, file-uri

从 Java 程序中，我需要在本地 HTML 文件上启动默认浏览器，指向文件内的锚点。在 Java SE 6 中，java.awt.Desktop.browse 方法将打开文件，但不会尊重锚点，因此类似以下内容会在顶部打开文件，但不会将浏览器分页到锚点：

```
Desktop.getDesktop("file:///C:/foo/bar.html#anchor"); 
```

Sun 在这里说[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6477862](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6477862)文件 URI 协议不支持锚点。

有人有更好的答案吗？

我可以使用 Java SE 6。我可以使用仅限 Windows 的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T20:11:51.793

我只是以另一种方式解决了这个问题，因为这些示例中的任何引用或空格都不适合我。

1 检测文件URI是否有锚或查询字符串

2 如果是这样，创建一个`File tmpfile = File.createTempFile("apphelp", ".html")`带有元重定向到我想要的实际文件 URI 的临时文件：

```
<html><head>
<meta http-equiv="refresh" content="0;url=help.html#set_filter" />
</head></html> 
```

3 使用新的临时 URI 执行本地 rundll 命令：

```
Runtime.getRuntime().exec(
  "rundll32 url.dll,FileProtocolHandler \"" 
  +tmpfile.toURI().toString()+ "\""); 
```

我希望这对你有用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-12T09:03:30.233

Windows 上的解决方案是：

rundll32 URL.dll, FileProtocolHandler "file:///x:/temp/fragtest.htm#frag"

注意引号！！！

rundll32 URL.dll, FileProtocolHandler file:///x:/temp/fragtest.htm#frag 确实按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T11:05:50.853

您可以尝试使用[BrowserLauncher2](http://browserlaunch2.sourceforge.net/)。这是一个小型且独立的跨平台库，用于打开默认浏览器。它完美地处理锚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T07:56:52.740

仅适用于 Windows，您可以尝试

```
System.exec("cmd.exe start file:///C:/foo/bar.html#anchor") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-08T19:10:23.183

我在[这里](https://stackoverflow.com/a/9187510/1084078)对此项目进行了一些调查- 请注意，打开`cmd`和输入`start file:///c:/temp/test.html#anchor`也不起作用。

我认为唯一真正有效的方法是手动调用浏览器（或使用第三方工具）。

在 Windows 上，你总是有 Internet Explorer，所以`Runtime.getRuntime().exec("cmd.exe start iexplore " + myURL)`如果你真的不想自己找到 iexplore.exe，你可以打电话——但这也并不总是有效。

# asp.net - 来自服务器端代码的 asp.net 中的客户端模式对话框。（我该怎么做呢）

> ID：300515
> 
> 赞同：3
> 
> 时间：2008-11-18T23:15:10.270
> 
> 标签：asp.net, javascript, ajax

我需要一种技术来处理看起来很简单的事情！

我有一个表单，在服务器端有一些逻辑用于验证。如果服务器端代码表明存在问题，我想向客户端显示一个模式弹出窗口。

我很难让它以这种方式工作。

我发现如果我保留所有逻辑客户端，我可以使用 javascript 函数

```
window.showModalDialog("url","title", "style"); 
```

但是，逻辑当前在服务器端。这是一个 ASP.NET 3.5 Web 项目 - 有没有办法使用 AJAX 控件（如脚本管理器、更新面板等）来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-18T23:43:09.497

我知道您使用 ScriptManager 控件来执行此操作。基本上，您只需从服务器发送一行 JavaScript 即可立即执行。在这种情况下，您描述的客户端行。

抱歉含糊其辞，但几乎是下班时间了，我将不得不通过大量代码来查找示例。

[这是一个例子](http://codepagoda.com/2008/08/26/example-error-messages-using-a-modal-dialog-box-with-the-modalpopupextender-in-microsoft-ajax/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T23:43:05.270

请注意，并非所有浏览器都支持模式对话框。

如果您的服务器端验证失败，您可以使用 DHTML 并从服务器端设置 div 的可见性来完成类似的操作。

您还可以查看[Telerik 的 RadWindow 控件](http://www.telerik.com/products/aspnet-ajax/window.aspx)，该控件旨在（部分）解决模态对话框问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T23:41:46.677

您需要使用 AJAX 回调来执行服务器端验证并向客户端返回响应 - 然后决定是否显示模式对话框......但是，为什么需要在服务器上进行验证？通常最好在客户端尝试验证以节省往返...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T08:16:40.567

你真的不应该使用模态弹出器。首先，它仅在 IE 中有效。其次，这对您的最终用户来说*真的*很烦人......

你应该使用类似这样的东西；[Ra-Ajax Clendar Starter-Kit](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)（点击左下角的“Create New Activity”）

# java - j2me 服务发现和可同时发现

> ID：300516
> 
> 赞同：1
> 
> 时间：2008-11-18T23:16:23.077
> 
> 标签：java, java-me, mobile, client-server, bluetooth

我尝试编写一个简单的客户端/服务器应用程序（所有应用程序都是蓝牙服务和客户端）。客户端代码找到蓝牙设备并注册到本地数据库。但是当查询运行时，它是不可发现的。（服务器代码在另一个线程上运行）。我的模拟器可以工作（扫描时间为0），但是当我安装到真机（两个SE和一个诺基亚）时，扫描时间是10-15秒。在此期间，该设备无法被其他设备检测到。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T11:24:43.023

据我所知，您尝试创建同时工作的服务器和客户端，对吗？好吧，我认为这行不通，您必须制作一个电话服务器，而另一个将是客户端。

我建议查看与 WTK 或 SE SDK 捆绑的示例应用程序，您可以将它们用作参考。另外我建议[为开发人员阅读 SE 网站](http://developer.sonyericsson.com/community/java_me/java_me?tagSetID=1007&view=documents)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T17:36:16.537

当您执行设备搜索时，蓝牙无线电将忙于执行此操作，因此它不会响应其他设备的发现查询。

# java - 如果线程安全不是问题，Java 中的 ArrayList 与 Vectors

> ID：300519
> 
> 赞同：29
> 
> 时间：2008-11-18T23:17:50.187
> 
> 标签：java, performance, collections

`Vector`和的性能真的有那么大的区别`ArrayList`吗？当线程安全不是问题时，始终使用 ArrayLists 是一种好习惯吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-18T23:25:10.063

Vector起源于Collections API之前的日子，并且已经被改造成为它的一部分。根据我的阅读，它不被弃用的原因是核心 API 依赖于它。

ArrayList 是作为 Collections API 的一部分从头开始编写的，除非您需要支持低至 1.2 的 Java 版本，否则应该使用它。

如果你需要一个线程安全的 ArrayList，你可以使用静态工厂方法`Collections.synchronizedList(new ArrayList<type>);`来生成你的列表。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-18T23:24:12.280

如果线程安全不是问题，`ArrayList`它会更快，因为它不必同步。不过，您应该始终将变量声明为 a `List`，以便以后可以根据需要更改实现。

我更喜欢明确地处理我的同步，因为很多操作需要多次调用。例如：

```
if (!myList.isEmpty()) { 
    myList.get(0);
} 
```

应该：

```
synchronized (myList) {
   if (!myList.isEmpty()) { 
       myList.get(0);
   }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-18T23:32:21.703

如果线程安全不是问题，您应该始终使用`ArrayList`. Vector 有同步的开销，并且已经证明`ArrayList`和之间的性能差异`Vector`非常大。你可以用谷歌搜索很多性能基准。

这是一个[时间和性能](http://www.particle.kth.se/~lindsey/JavaCourse/Book/Part1/Java/Chapter12/timing.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-19T23:29:21.410

`Vector`忽略同步，和之间的主要区别在于`ArrayList`它`Vector`是可调整大小的数组（类似于 C++ STL 向量）和`ArrayList`恰好由数组支持的列表。

差异体现在[setSize()](http://java.sun.com/javase/6/docs/api/java/util/Vector.html#setSize(int))方法中。中没有等效的方法`ArrayList`。一些前 C++ Java 开发人员对此束手无策。有许多***简单***的方法可以解决它，所以它不应该是一个问题。

只是不要错误地告诉 C++ 开发人员 an`ArrayList`等同于`std::vector`. 你永远不会听到它的结束。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-03T10:37:20.257

## ArrayList 与向量

### 1\. 同步和线程安全

Vector 和 ArrayList 之间的首要区别是 Vector 是同步的，而 ArrayList 不是，这意味着所有在结构上修改 Vector`add ()`或`remove ()`同步的方法，这使其成为线程安全的，并允许它在多线程中安全使用-线程和并发环境。另一方面，ArrayList 方法不同步，因此不适合在多线程环境中使用。

### 2.速度和性能

ArrayList 比 Vector 快得多。由于 Vector 是同步的并且是线程安全的，因此它付出了同步的代价，这使得它有点慢。另一方面，ArrayList 不同步且速度不快，这使其成为单线程访问环境中的明显选择。

### 3.容量

`ensureCapacity()`每当 Vector 超过指定的阈值时，它会根据 capacityIncrement 字段中指定的值自行增加，而您可以通过调用方法增加 ArrayList 的大小。

### 4\. 枚举和迭代器

Vector 可以通过调用方法返回它持有的项目的枚举，该`elements()`方法与 Iterator 不同并且`ListIterator`由`ArrayList`.

### 5\. 遗产

值得记住的另一点是 Vector 是 JDK 1.0 附带的那些类之一，最初不是 Collection 框架的一部分，但在以后的版本中，它被重构为实现 List 接口，以便它可以成为集合框架的一部分

# syntax - 用于各种语言代码语法高亮的 LaTeX 包

> ID：300521
> 
> 赞同：180
> 
> 时间：2008-11-18T23:18:25.567
> 
> 标签：syntax, package, latex, highlight

我正在寻找一个对代码进行语法突出显示的 LaTeX 包。例如，现在我使用逐字块来编写代码：

```
\begin{verbatim}
    <html>
       <head>
           <title>Hello</title>
       </head>
       <body>Hello</body>
    </html>
\end{verbatim} 
```

这可以很好地在我的文档上显示代码。但是，假设我想像 IDE 在输出文档中那样突出显示 HTML 标记？**有没有可以提供帮助的软件包？**

我想对 Java、C#、HTML、CSS 等各种语言做同样的事情。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2008-11-18T23:43:01.057

您可以使用[列表](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/)包。它支持许多不同的语言，并且有很多用于自定义输出的选项。

```
\documentclass{article}
\usepackage{listings}

\begin{document}
\begin{lstlisting}[language=html]
<html>
    <head>
        <title>Hello</title>
    </head>
    <body>Hello</body>
</html>
\end{lstlisting}
\end{document} 
```

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2010-01-24T11:20:07.010

在问了一个[类似的问题](https://stackoverflow.com/questions/1966425/source-code-highlighting-in-latex)后，我创建了另一个使用 Pygments 的包，并提供了比`texments`. 它被称为[**`minted`**](http://www.ctan.org/tex-archive/macros/latex/contrib/minted/)并且非常稳定和可用。

只是为了炫耀一下，这里有一个用 minted 突出显示的代码：

![示例代码](https://i.stack.imgur.com/BFNXp.png)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-09-20T21:39:11.280

我推荐[Pygments](http://pygments.org/)。它接受任何语言的一段代码并输出语法突出显示的 LaTeX 代码。它使用[fancyvrb](http://www.ctan.org/tex-archive/macros/latex/contrib/fancyvrb/)和[color](http://www.ctan.org/tex-archive/help/Catalogue/entries/color.html)包来产生它的输出。我个人更喜欢它而不是列表包。我认为[fancyvrb](http://www.ctan.org/tex-archive/macros/latex/contrib/fancyvrb/)创造了更漂亮的结果。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-18T23:27:34.193

[LGrind 就是](http://www.ctan.org/pkg/lgrind)这样做的。这是一个成熟的 LaTeX 包，从 adam 还是个牛仔就已经存在，并且支持多种编程语言。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-11-06T11:09:59.307

我会使用开发人员 Konrad Rudolph 提到的[minted 包，而不是](https://www.ctan.org/tex-archive/macros/latex/contrib/minted/)[列表包](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/)。原因如下：

**上市包**

列表包默认不支持颜色。要使用颜色，您需要包含颜色包并使用*\lstset命令自行定义颜色规则，如此*[处](http://www.tjansson.dk/2008/11/using-lstlisting-to-include-code-in-latex/)的 matlab 代码所述。

此外，列表包不适用于 unicode，但您可以按照[此处](https://tex.stackexchange.com/questions/39640/typesetting-utf8-listings-with-german-umlaute)和[此处](https://tex.stackexchange.com/questions/108692/listing-with-mixed-english-and-russian-symbols-in-comments)的说明解决这些问题。

以下代码

```
\documentclass{article}
\usepackage{listings}

\begin{document}
\begin{lstlisting}[language=html]
<html>
    <head>
        <title>Hello</title>
    </head>
    <body>Hello</body>
</html>
\end{lstlisting}
\end{document} 
```

生成以下图像：

[![在此处输入图像描述](https://i.stack.imgur.com/ak3i8.png)](https://i.stack.imgur.com/ak3i8.png)

***铸造包装***

minted 包支持颜色、unicode 并且看起来很棒。然而，为了使用它，你需要有 python 2.6 和[pygments](http://pygments.org/)。在 Ubuntu 中，您可以使用以下命令在终端中检查您的 python 版本

```
python --version 
```

你可以安装 pygments

```
sudo apt-get install python-pygments 
```

然后，由于 minted 调用 pygments，你需要像这样使用*-shell-escape编译它*

```
pdflatex -shell-escape yourfile.tex 
```

如果您使用 TexMaker 之类的乳胶编辑器，我建议您添加一个用户命令，以便您仍然可以在编辑器中编译它。

以下代码

```
\documentclass{article}
\usepackage{minted}
\begin{document}

\begin{minted}{html}
    <!DOCTYPE html>
    <html>
       <head>
           <title>Hello</title>
       </head>

       <body>Hello</body>
    </html>
\end{minted}
\end{document} 
```

生成以下图像：

[![在此处输入图像描述](https://i.stack.imgur.com/EaYlI.png)](https://i.stack.imgur.com/EaYlI.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-08-05T17:27:16.313

我主要在论文中使用 lstlistings，但对于彩色输出（用于幻灯片），我使用 pygments。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-11-14T17:13:23.930

我建议根据以下 tex 代码定义自己的包；这给了你完全的自由。[http://ubuntuforums.org/archive/index.php/t-331602.html](http://ubuntuforums.org/archive/index.php/t-331602.html)

# collections - 集合中的计数 vs 长度 vs 大小

> ID：300522
> 
> 赞同：191
> 
> 时间：2008-11-18T23:18:33.460
> 
> 标签：collections, naming-conventions, terminology, semantics

通过使用多种编程语言和库，我注意到用于表示集合中元素总数的各种术语。

最常见的似乎是`length`,`count`和`size`。

例如。

```
array.length
vector.size()
collection.count 
```

有什么首选的术语可以使用吗？这取决于它是什么类型的集合？IE。可变/不可变

是否倾向于将其作为属性而不是方法？

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2008-11-18T23:25:04.180

`Length()`往往指的是连续的元素——例如，一个字符串有一个长度。

`Count()`倾向于指较松散集合中的元素数量。

`Size()`倾向于指集合的大小，通常这可能与向量（或字符串）等情况下的长度不同，一个字符串中可能有 10 个字符，但存储空间保留为 20 个。它也可能指的是元素 - 检查源/文档。

`Capacity()`- 用于专门指代集合中分配的空间，而不是其中有效元素的数量。如果 type 定义了“容量”和“大小”，那么“大小”通常是指实际元素的数量。

我认为重点在于人类语言和习语，字符串的大小似乎不是很明显，而集合的长度同样令人困惑，即使它们可能用于指代相同的事物（元素的数量) 在数据集合中。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-10-01T23:43:21.697

FWIW（这几乎没有），我更喜欢“计数”，因为它似乎表明它将非常明确地返回集合中元素/项目的数量。

当面对“长度”或“大小”这些术语时，我经常会想知道片刻（甚至被迫重新阅读文档）该死的东西是否会告诉我集合中有多少元素或如何集合正在消耗的许多字节。对于旨在连续的集合（如数组或字符串）尤其如此。

但是，负责 Java、BCL/.Net 或 C/C++ 标准框架/库所使用的命名约定的人都懒得问我，所以你们都被他们提出的任何问题所困扰。

如果我比我聪明得多并被命名为 Bjarne，你们所有人都可以免于痛苦......

当然，回到现实世界中，您应该尝试坚持您正在使用的语言/平台（例如，`size()`在 C++ 中）使用的任何命名约定。并不是说这似乎可以帮助您解决`Array.Length`困境。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-19T00:14:00.510

这些术语在某种程度上可以互换，尽管在某些情况下我更喜欢其中一个。**通常，如果您考虑如何向其他人口头描述此元素的长度/大小/计数，**通常可以获得最佳用法？

 **`length()`意味着元素有长度。字符串有长度。你说“一个字符串有 20 个字符长”，对吧？所以它有一个长度。

`size()`意味着元素具有大小。例如，文件有大小。您说“此文件的大小为 2 MB”，对吗？所以它有一个大小。

也就是说，字符串也可以有大小，但我希望这里有别的东西。例如，一个 UTF-16 字符串的长度可能为 100 个字符，但由于每个字符由两个字节组成，我希望大小为 200。

`count()`很不寻常。Objective-C 使用 count 来表示数组中元素的数量。有人可能会争论一个数组是否有长度（如在 Java 中）、有大小（如在大多数其他语言中）或有计数。但是，大小可能又是以字节为单位的大小（如果数组项是 32 位 int，则每个项是 4 个字节）和长度......我不会说“一个数组有 20 个元素长”，这听起来很奇怪我。我会说“一个数组有 20 个元素”。我不确定 count 是否能很好地表达这一点，但我认为 count 是这里的缩写形式，`elementCount()`对于数组来说，这再次比`length()`or更有意义`size()`。

如果您在编程语言中创建自己的对象/元素，最好使用任何其他类似的元素，因为程序员习惯于使用该术语访问所需的属性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-18T23:24:11.297

如果您要查找集合中的项目数，我认为计数是最明显的术语。对于还没有特别依赖于特定语言的新程序员来说，这甚至应该是显而易见的。

它应该是一个属性，因为它就是这样：集合的描述（又名属性）。一个方法意味着它必须对集合做一些事情来获取项目的数量，这似乎不直观。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-18T23:23:03.093

嗯...我不会使用大小。因为这可能与字节大小混淆。长度 - 对数组可能有意义，只要它们应该使用后续字节的内存。虽然......长度......在什么？数清楚。有多少元素。我会使用计数。

关于属性/方法，我会使用属性来标记它是快的，而方法来标记它是慢的。

而且，最重要的是 - 我会坚持您使用的语言/库的标准。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-18T23:29:31.007

添加到@gbjbaanb的答案...

如果“属性”意味着对值的公共访问，我会说“方法”只是为了提供封装和隐藏实现而更受欢迎。

你可能会改变你对如何`count`元素或如何维护它的想法`count`。如果它是一个属性，你就会被卡住——如果它是通过一种方法访问的，你可以在不影响集合用户的情况下更改底层实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-14T13:41:49.180

在 Elixir 中，实际上有一个明确的命名方案与语言中的类型相关联。

> 在“计算”数据结构中元素的数量时，Elixir 还遵循一个简单的规则：`size`如果运算是在恒定时间内（即预先计算出的值）或 `length`运算是线性的（即计算随着输入的增长，长度会变慢）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T23:21:37.090

对我来说，这有点像问“foreach”是否比“for each”更好。它仅取决于语言/框架。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-02T11:16:05.480

我会说这取决于您使用的特定**语言和****类**。例如，在 c# 中，如果您使用的是 Array，则您有**Property** Length，如果您有从 IEnumerable 继承的东西，则您有扩展**Method** Count()，但它并不快。如果您从 ICollection 继承，您将拥有**Property** Count。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-15T13:32:22.277

**科特林**回答

来自_Collections.kt

```
/**
 * Returns the number of elements in this collection.
 */
@kotlin.internal.InlineOnly
public inline fun <T> Collection<T>.count(): Int {
    return size
} 
```

# scheme - 为什么这段代码在 Scheme 中不起作用？

> ID：300551
> 
> 赞同：1
> 
> 时间：2008-11-18T23:30:38.617
> 
> 标签：scheme

```
 (define a 42)
 (set! 'a 10)

(define a 42)
(define (symbol) 'a)
(set! (symbol) 10)

(define a (cons 1 2))
(set! (car a) 10) 
```

我尝试在 DrScheme 中运行它们，但它们不起作用。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T23:53:27.680

想一套！是一种特殊形式，例如 define，它不计算其第一个操作数。您正在告诉方案解释器准确地设置该变量的编写方式。在您的示例中，它不会将表达式 'a 评估为单词 a。相反，它会寻找一个名为“'a”的变量绑定（或者取决于你的解释器可能会在那之前中断，因为我认为'a不是一个有效的绑定）。

对于最后一组表达式，如果您想设置一对汽车，请使用函数 (set-car!pair val)，它的工作原理与任何方案函数一样，因为它会评估其所有操作数。它接受两个值，一对和一些方案值，并改变这对，以便汽车现在指向方案值。

举个例子。

```
>(define pair (cons 1 2))
>pair
(1 . 2)
>(set-car! pair 3)
(3 . 2) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:37:56.667

因为 set 的第一个参数！可以说是变量名，而不是“左值”。

对于最后一种情况，使用 (set-car!a 10)。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-11-19T00:25:20.877

问题在于*(set! 'a 10)*，因为您不应该引用符号*a*。

听起来你正在尝试学习 Scheme，但你不知道 Lisp，是吗？如果是这样，我强烈建议尝试将 Clojure 作为更容易学习的 Lisp。在 Common Lisp 和 Scheme 中，我没能掌握阅读器、求值、符号、特殊形式、宏等之间的交互，因为这些东西似乎都以错综复杂的方式交互，但我终于在 Clojure 中真正理解了它们。尽管它是新的，但我发现 Clojure 文档实际上比我为 Scheme 或 CL 找到的任何内容都更清晰。[从http://clojure.blip.tv/](http://clojure.blip.tv/)上的视频开始，然后阅读 clojure.org 上的文档。

# mysql - 使用 MYSQL 而不是 MSSQL 进行跨表连接

> ID：300553
> 
> 赞同：0
> 
> 时间：2008-11-18T23:32:09.533
> 
> 标签：mysql, sql-server, join, cross-database

是否可以在跨不同表的 mysql 中进行跨表连接？在不同的数据库中。

这在 MSSQL 中似乎很容易实现，并且大大加快了数据传输速度？

mysql怎么样，需要借助强大的IDE来实现吗？或者你必须编写一个程序来做这样的事情吗？

UPDATE tblUser SET tblUser.ReceiveInfo=old_database.dbo.contact.third_party_info_yn FROM tblUser 内部加入 old_database.dbo.contact ON old_database.dbo.contact.id=tblUser.oldid

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T00:00:01.990

当然，非常容易。用数据库名称作为表名的前缀，就像你展示的那样。我们定期进行跨数据库连接。例如：

> 从 newusers1.users 中选择 COUNT(*) 加入 newusers2.users

不过，与将两个表放在同一个数据库中相比，它肯定不会加快数据传输速度。

现在，如果您的表位于不同的数据库服务器上，答案是否定的。例如，如果您的数据库太大，您需要对表进行分片。事情变得有点混乱。但鉴于您似乎对 MS SQL 解决方案感到满意，这似乎不适用于这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T00:35:22.590

在 MySQL 中，您可以进行跨数据库连接，并且通过 FEDERATED 引擎，甚至可以进行跨服务器连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T07:22:12.220

MySQL 实际上并不关心这些表是否在同一个“数据库”中，它只是一个用于方便管理、权限等的表的逻辑集合。

因此，您可以像在同一个中一样轻松地在它们之间进行连接（请参阅 ChrisInEdmonton 的回答）

# sphinx - 使用 sphinx 搜索时可以识别匹配的词吗？

> ID：300554
> 
> 赞同：3
> 
> 时间：2008-11-18T23:32:13.340
> 
> 标签：sphinx, thinking-sphinx

我正在使用 sphinx 通过思想 sphinx 对 mysql 数据库进行全文搜索。

我想在向用户显示的结果中突出显示匹配的术语。

Shpinx 足够聪明，搜索“肉毒杆菌”将匹配“我喜欢将肉毒杆菌注射到我的眼睛”

我怎样才能让它告诉我“肉毒杆菌”与“肉毒杆菌中毒”相匹配？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T11:25:08.993

首先，我在我的一个项目中大量使用 sphinx，但我没有使用 ThinkingSphinx，因为我们使用的配置文件非常复杂，我使用的是定制的 act_as_sphinx 插件。

从纯狮身人面像的角度回答您的问题：

*   sphinx 中有一个 BuildExcerpts api，用于获取带有下划线匹配的内容的摘录，请参见[http://www.sphinxsearch.com/docs/current.html#api-func-buildexcerpts](http://www.sphinxsearch.com/docs/current.html#api-func-buildexcerpts)。
    认为 Sphinx 应该提供这个功能

*   要将肉毒杆菌中毒与肉毒杆菌相匹配，您应该使用词干分析器编译 sphinx，也许波特算法可以回答您的问题：请参阅[http://www.sphinxsearch.com/docs/current.html#conf-morphology](http://www.sphinxsearch.com/docs/current.html#conf-morphology)

希望这会有所帮助，我强烈建议您查看 sphinx 文档以充分使用这个非常高效的索引器

曼弗雷德

# java - Java中的移动/复制文件操作

> ID：300559
> 
> 赞同：71
> 
> 时间：2008-11-18T23:34:39.483
> 
> 标签：java, file, copy, move

是否有一个标准的 Java 库来处理常见的文件操作，例如移动/复制文件/文件夹？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-26T07:28:27.570

以下是如何通过操作执行此`java.nio`操作：

```
public static void copyFile(File sourceFile, File destFile) throws IOException {
    if(!destFile.exists()) {
        destFile.createNewFile();
    }

    FileChannel source = null;
    FileChannel destination = null;
    try {
        source = new FileInputStream(sourceFile).getChannel();
        destination = new FileOutputStream(destFile).getChannel();

        // previous code: destination.transferFrom(source, 0, source.size());
        // to avoid infinite loops, should be:
        long count = 0;
        long size = source.size();              
        while((count += destination.transferFrom(source, count, size-count))<size);
    }
    finally {
        if(source != null) {
            source.close();
        }
        if(destination != null) {
            destination.close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-11-18T23:38:12.813

目前还没有，但[New NIO (JSR 203)](http://jcp.org/en/jsr/detail?id=203)将支持这些常见操作。

与此同时，有几件事情要记住。

[File.renameTo](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#renameTo(java.io.File))通常仅适用于同一文件系统卷。我认为这相当于“mv”命令。如果可以，请使用它，但对于一般的复制和移动支持，您需要有一个后备。

当重命名不起作用时，您将需要实际复制文件（如果它是“移动”操作，则使用[File.delete删除原始文件）。](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#delete())要以最高效率执行此操作，请使用[FileChannel.transferTo](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/channels/FileChannel.html#transferTo(long,%20long,%20java.nio.channels.WritableByteChannel))或[FileChannel.transferFrom](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/channels/FileChannel.html#transferFrom(java.nio.channels.ReadableByteChannel,%20long,%20long))方法。该实现是特定于平台的，但通常，当从一个文件复制到另一个文件时，实现避免在内核和用户空间之间来回传输数据，从而大大提高了效率。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-18T23:41:43.710

查看： [http ://commons.apache.org/io/](http://commons.apache.org/io/)

它有副本，并且如前所述，JDK 已经移动。

不要实现自己的复制方法。有这么多漂浮在那里...

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-06T13:02:34.477

以前的答案似乎已经过时了。

Java 的[File.renameTo()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#renameTo%28java.io.File%29)可能是 API 7 最简单的解决方案，而且似乎工作正常。小心它不会抛出异常，而是返回真/假！！！

请注意，在以前的版本中似乎存在问题（与[NIO](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#move%28java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...%29)相同）。

如果您需要使用以前的版本，请查看[此处](https://stackoverflow.com/questions/1000183/reliable-file-renameto-alternative-on-windows)。

以下是 API7 的示例：

```
File f1= new File("C:\\Users\\.....\\foo");
File f2= new File("C:\\Users\\......\\foo.old");
System.err.println("Result of move:"+f1.renameTo(f2)); 
```

或者：

```
System.err.println("Move:" +f1.toURI() +"--->>>>"+f2.toURI());
Path b1=Files.move(f1.toPath(),  f2.toPath(), StandardCopyOption.ATOMIC_MOVE ,StandardCopyOption.REPLACE_EXISTING ););
System.err.println("Move: RETURNS:"+b1); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-07-05T16:14:13.430

Google 的 Guava 库也有这些：

[http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/io/Files.html](http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/io/Files.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-02-01T12:54:17.130

尝试使用[org.apache.commons.io.FileUtils](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html)（通用文件操作实用程序）。通过以下方式提供设施：

> (1) [FileUtils.moveDirectory(File srcDir, File destDir)](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#moveDirectory%28java.io.File,%20java.io.File%29) => 移动一个目录。
> 
> (2) [FileUtils.moveDirectoryToDirectory(File src, File destDir, boolean createDestDir)](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#moveDirectoryToDirectory%28java.io.File,%20java.io.File,%20boolean%29) => 将一个目录移动到另一个目录。
> 
> (3) [FileUtils.moveFile(File srcFile, File destFile)](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#moveFile%28java.io.File,%20java.io.File%29) => 移动文件。
> 
> (4) [FileUtils.moveFileToDirectory(File srcFile, File destDir, boolean createDestDir)](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#moveFileToDirectory%28java.io.File,%20java.io.File,%20boolean%29) => 将文件移动到目录。
> 
> (5) [FileUtils.moveToDirectory(File src, File destDir, boolean createDestDir)](http://commons.apache.org/proper/commons-io/javadocs/api-2.4/org/apache/commons/io/FileUtils.html#moveToDirectory%28java.io.File,%20java.io.File,%20boolean%29) => 将文件或目录移动到目标目录。

它简单、容易、快速。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-09T09:43:44.593

有趣的观察：试图通过各种 java 类复制同一个文件，并以纳秒为单位打印时间。

使用 FileOutputStream 字节流的持续时间：4 965 078

使用 BufferedOutputStream 的持续时间：1 237 206

使用时间（字符文本阅读器：2 858 875

使用 BufferedReader 的持续时间（缓冲字符文本流：1 998 005

使用时间（文件 NIO 副本）：18 351 115

当使用 Files Nio 复制选项时，它花费了将近 18 倍的时间！！！Nio 是复制文件最慢的选项，而 BufferedOutputStream 看起来是最快的。我对每个类都使用了相同的简单文本文件。

# .net - 有没有人听说过 .NET 4.0 会如何改变/影响 Asp.net MVC？

> ID：300572
> 
> 赞同：2
> 
> 时间：2008-11-18T23:42:16.080
> 
> 标签：.net, asp.net, asp.net-mvc, .net-4.0

在 .NET 4.0 和 VS 10 出来之前，我们应该有一个完整的 asp.net MVC 版本，对吧？

我真的希望 MS 可以像其他更开放的框架一样保持 MVC 的动态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T01:03:06.137

是的，在 .NET 4.0 和 VS 10 发布之前，MVC 1.0 RTM 将作为完全支持的带外框架发布。我们也希望保持动态，并将继续通过 CodePlex 发布更新，就像我们对 1.0 所做的那样。至少这是我们目前的计划。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T23:55:43.840

我认为它不会产生太大影响，除了 MVC 框架将成为 .NET 框架的一部分。在 MVC 上所做的工作应该继续通过 CodePlex 提供，即使在这两个框架正式发布之后也是如此。

# sharepoint - SharePoint - 在自定义管理表单中从 Active Directory 添加用户

> ID：300576
> 
> 赞同：1
> 
> 时间：2008-11-18T23:43:44.270
> 
> 标签：sharepoint, active-directory

我有一个项目需要将用户添加到 SharePoint 门户，但是当我添加它们时，我还需要在单独的数据库中设置添加参数。

我想添加一个自定义管理屏幕，管理员可以在添加用户时设置这些值，而不是强制他们先添加用户，然后转到他们设置值的单独界面页面。

有谁知道任何可以解释如何做到这一点的好文章？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T00:23:47.917

创建一个自定义的 asp.net 表单会更容易，该表单将获取有关用户所需的所有信息。然后提交可以将信息添加到所需的数据库中，并使用对象模型来添加用户。

```
SPRoleAssignment MyRoleAssign = new SPRoleAssignment(”domain/alias”, “email address”, “User Name”, “Description”);
SPRoleDefinition MyRoleDef = newSubWeb.RoleDefinitions["Contribute"];    
MyRoleAssign.RoleDefinitionBindings.Add(MyRoleDef);    
site.RoleAssignments.Add(MyRoleAssign); 
```

[farhanfaiz.wordpress.com 的代码在这里](http://farhanfaiz.wordpress.com/2008/04/14/moss-add-user-to-site-through-code-programmatically/)

否则，SharePoint Web 服务可能会这样做。 [这里的例子](http://aspalliance.com/791_Using_SharePoint_Web_Services_to_Change_Subsite_Permissions.all)

# c# - C# WPF 分辨率独立性？

> ID：300577
> 
> 赞同：12
> 
> 时间：2008-11-18T23:43:50.290
> 
> 标签：c#, wpf, gis, resolution, dpi

我正在使用 C# 在 WPF 中开发地图控件。我正在使用一个画布控件，例如 400 x 200，它被分配了一个例如 2,000mx 1,000m 的地图区域。

地图的比例为： **canvas_size_in_meters / real_size_in_meters**。

我想找到canvas_size_in_meters。

canvas.ActualWidth 以 DIU（设备独立单位）为单位给出宽度。所以，400 DIU 是 400/96 = 4,17 英寸，前提**是**我的显示器的**物理**分辨率是 96 dpi。

但是，使用尺子，我发现我的显示器的物理分辨率是 87 dpi。（实际上只有少数显示器具有 96 物理 dpi）

DPI 差异 (10%) 转化为屏幕上实际地图控件宽度的 +10% 差异。

无论屏幕分辨率和 DPI 设置如何，如何准确测量 WPF 控件的大小（以英寸为单位）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T00:48:06.400

> 无论屏幕分辨率和 DPI 设置如何，如何准确测量 WPF 控件的大小（以英寸为单位）？

这实际上是不可能的，因为要使其工作，WPF 必须知道显示器的分辨率（以 DPI 为单位）。理论上听起来不错，但实际上 windows 不知道这些信息。这就是为什么 windows 本身总是盲目地假设 96dpi 而不是更聪明的原因。

即使有一些方法可以手动告诉它，或者如果您的特定显示器有一个自定义驱动程序可以将正确的信息传递给 Windows，这在其他任何人的计算机上都不起作用，因此 Windows 不会传递这些信息到任何应用程序。

你能做的最好的就是像谷歌地图那样画一个比例尺。你知道 1*像素*== 1 英里，所以你可以在地图上画一条 50 像素的线，标签上写着“这条线等于 50 英里”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T15:03:39.520

有办法以毫米或英寸为单位计算当前像素大小。如前文所述，它不是一个固定值，会根据当前分辨率和显示器尺寸而有所不同。

首先获取当前分辨率。假设它是 1280x1024 现在使用 GetDeviceCaps 函数获取以 mm 为单位的显示器宽度。它是一个标准的 Windows 库函数。

int widthmm = GetDeviceCaps(deviceContext, HORZSIZE); 我的显示器宽度是362mm

所以像素大小 = 362/1280 = 0.282 mm

这种方法的准确性取决于显示区域完全覆盖显示器宽度的假设。

因此，要回答最初的问题，当我的显示器上显示时，400 x 200 像素的画布尺寸将为 (400 * 0.282/1000) x (200 * 0.282/1000) 米。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T13:29:45.927

感谢您的及时回复。

我完全同意，但我一开始就不想相信。您会看到，如果地图用于显示不同图层的地图数据（取决于比例），则必须对地图的比例进行**近似计算。**大多数应用程序使用具有例如 10 个离散地图级别的滑块控件来设置“比例”。

拥有绝对比例对于应用程序来说并不重要，最好显示一个*指示性*比例，例如 1:15,000。

绝对比例需要一个额外的变量*monitorPhysicalDPI*（最初设置为 96），如果使用选择更改会提供稍微更好的比例（同样这并不重要）。地图控件的大小为：

map.ActualWidth * (96/monitorPhysicalDPI) * 英寸PerDIU， *英寸PerDIU 为1/96*

这些都是化妆品。如果 Windows 知道 ACTUAL 控件的尺寸不是很好吗？（用户必须在操作系统设置中提供有关屏幕尺寸的信息，或者只是安装监视器 INF 文件）

# vb.net - 在 vb.net 控制台 exe 中获取启动路径

> ID：300578
> 
> 赞同：5
> 
> 时间：2008-11-18T23:44:14.720
> 
> 标签：vb.net, io

如何在不添加对 system.windows.forms 的引用的情况下获取我的 exe 的启动路径（ system.windows.forms.application.StartupPath ）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-19T00:09:35.217

你可以试试

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

这适用于大多数情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-18T23:51:14.020

编辑：@KiwiBastard 的答案是正确的方法：

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

* * *

添加引用`System.Reflection`并使用

```
Assembly.GetExecutingAssembly().Location 
```

编辑：根据您打算获得启动路径的位置，这可能更合适：

```
Assembly.GetEntryAssembly().Location 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T00:05:51.870

您可以使用以下方法获得无需反射的启动路径：

```
IO.Path.GetDirectoryName(Diagnostics.Process.GetCurrentProcess().MainModule.FileName) 
```

# c# - 在 C# 中构建对象的更好方法

> ID：300581
> 
> 赞同：3
> 
> 时间：2008-11-18T23:45:33.343
> 
> 标签：c#, data-access-layer

我有一个应用程序，其对象类型继承自包含应用程序对象大部分属性的基类。所有对象类型都存储在数据库的一张表中。“ClassType”列确定了我将 SqlDataReader 行转换为的对象类型。

这是我当前的实现：

```
SqlDataReader dr = SqlServerHelper.ExecuteReader("MyStoreProc", MySqlParmas);

if(dr.HasRows)
{
    while(dr.Read())
    {
        switch(dr["ClassType"].ToString())
        {
            case "ClassA":
                //cast sqldatareader a ClassA object
                ClassA a = new ClassFactory.CreateClassA(object p1, object p2);
            case "ClassB":
                //cast sqldatareader a ClassB object
                ClassB b = new ClassFactory.CreateClassB(object p1, object p2);
        //it continues for all objects with app....
        }
    }
}

dr.Close() 
```

我的问题是他们对这种类型的处理有更好的实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-18T23:57:54.723

这种方法是如果您不想切换到生成 ORM 的代码。

在您的对象表中，包括对象的完全限定类型名称。

然后，您可以执行以下操作：

```
 private Dictionary<String, Type> _objectTypes = new Dictionary<String, Type>();

    public ObjectFactory()
    {
        // Preload the Object Types into a dictionary so we can look them up later
        foreach (Type type in typeof(ObjectFactory).Assembly.GetTypes())
        {
            if (type.IsSubclassOf(typeof(BaseEntity)))
            {
                _objectTypes[type.Name.ToLower()] = type;
            }
        }
    } 
```

现在，使用预加载的映射器，您可以将代码替换为：

```
 string objectName = dr["ClassType"].ToString().ToLower();
    Type objectType;

    if (_objectTypes.TryGetValue(objectName, out objectType))
    {
       return (BaseEntity)Activator.CreateInstance(objectType,reader);
    } 
```

将阅读器传递给对象的构造函数，这样它就可以完全填充自己，这种类型的代码不属于工厂。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T23:49:48.563

我想我会为此倾向于使用对象关系映射器。[NHibernate](http://www.hibernate.org/343.html)是现有的、免费的、成熟的 .NET 平台 ORM 解决方案的一个示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T23:55:34.027

LINQ to SQL 可能是一个合法的选择。但是，它不能很好地与未正确使用主键和外键约束的数据库一起使用。它将根据表生成类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T00:12:46.770

感谢所有反馈，但我不想实现第三方工具或新语言，因为我现在没有时间学习它。

@乔纳森霍拉德：

我的对象模块当前设计如下：

```
public class BaseClass
{
    public BaseClass() { }

    public object p1 { get; set;}

    public object p2 { get; set; }

    public virtual void ImplementLogic()  
    {
        //do some fun stuff....
    }
}

public class ClassA : BaseClass
{
    public ClassA { }

    public override void ImplementLogic()
    {
        //make it rain.....
    }
} 

public class ClassB : BaseClass
{
    public ClassB { }    

    public override void ImplementLogic()
    {
        //do some more fun stuff
    }
} 
```

它将如何与这个模型一起工作？

我是否会在我的 BaseClassFactory 构造函数中抛出第一个代码示例，因为它会识别从 BaseClass 继承的所有类？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T00:45:41.163

You could store the fully-qualified type name in your database, and then construct it with `Activator.GetInstance`. This would get rid of the ugly switch statement, but would call the type's constructor instead of a factory method. Will that do what you want?

# c# - SSCrypto/OpenSSL 到 C# 加密

> ID：300582
> 
> 赞同：3
> 
> 时间：2008-11-18T23:46:41.843
> 
> 标签：c#, .net, cocoa, encryption, openssl

有没有人能够使用 SSCrypto Framework for Cocoa 加密文本，然后在 C#/.NET 中解密？或者有人可以提供一些指导吗？

我很确定我的问题与正确设置加密货币设置有关，但我对 Cocoa 的使用还很不熟练，所以我无法确定图书馆中使用了哪些设置。然而，我试图破译它似乎是 md5 散列、CBC 模式、用零填充，我不知道是否设置了 IV...

我的 C# 代码如下所示：

```
 public static string Decrypt( string toDecrypt, string key, bool useHashing )
    {
        byte[] keyArray;
        byte[] toEncryptArray = Convert.FromBase64String( toDecrypt );

        if( useHashing )
        {
            MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
            keyArray = hashmd5.ComputeHash( UTF8Encoding.UTF8.GetBytes( key ) );
            hashmd5.Clear();
        }
        else
            keyArray = UTF8Encoding.UTF8.GetBytes( key );

        TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
        tdes.Key = keyArray;
        tdes.Mode = CipherMode.CBC;
        tdes.Padding = PaddingMode.Zeros;

        ICryptoTransform cTransform = tdes.CreateDecryptor();
        byte[] resultArray = cTransform.TransformFinalBlock( toEncryptArray, 0, toEncryptArray.Length );

        tdes.Clear();

        return UTF8Encoding.UTF8.GetString( resultArray );
    } 
```

当我在 Cocoa 端运行加密时，我得到了加密的文本：

UMldOZh8sBnHAbfN6E/9KfS1VyWAa7RN

但这不会在 C# 端使用相同的密钥进行解密。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-02T12:45:53.097

[您可以通过OpenSSL.NET](http://openssl-net.sourceforge.net)包装器直接在 C# 中使用 OpenSSL ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T01:48:31.473

有几点需要注意：

1-确保您正确解释了键和数据字符串。例如，密钥是用 ASCII 编码而不是 UTF8 编码的吗？它是否可能以 binhex 格式表示？

2-在解密之前您没有初始化 IV（初始化向量）。它需要与您用于在 Cocoa 端加密的 IV 相匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T01:55:01.927

可能与字节顺序有关，

尝试在解密之前调用 Array.Reverse。

```
var reversedArr = Array.Reverse(toEncrytArray)
byte[] resultArray = cTransform.TransformFinalBlock( reversedArr, 0, reversedArr.Length ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T17:54:41.817

您也应该真正发布 Cocoa 代码，让我们有机会找到您的问题。

但是您发布的内容中隐藏了一些提示：

使用密钥和 iv 解密 PyPqLI/d18Q= (base64) 得到“97737D09E48B0202”（十六进制）。这看起来像带有 PKCS7 填充的纯文本“97737D09E48B”。因此，我将首先更改 .NET 代码以使用 PaddingMode.PKCS7 并仔细查看将明文传递给 Cocoa 代码的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T01:49:39.663

IIRC，OpenSSL 使用 MS 所称的 PKCS7 填充（尽管 OpenSSL 将其称为 PKCS5，但我没有足够的标准知识来关心为什么）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T21:04:24.993

从 Mac 到 PC 来回移动数据的经典问题之一是字节顺序。你没有说 Cocoa 代码的执行平台是什么，但这是需要注意的，特别是如果它是 PowerPC Mac。

# c++ - C++ 中的枚举就像 Ada 中的枚举？

> ID：300592
> 
> 赞同：4
> 
> 时间：2008-11-18T23:51:46.577
> 
> 标签：c++, ada

有一次，我曾考虑在 C++ 中实现一个类/模板，该类/模板将支持 Enum，其行为类似于在 Ada 中的行为。自从我考虑这个问题以来已经有一段时间了，我想知道是否有人解决了这个问题？

编辑：

抱歉，我应该澄清一下我认为在 Enum 的 Ada 实现中哪些功能有用。鉴于枚举

```
type fruit is (apple, banana, cherry, peach, grape); 
```

我们知道水果是列出的水果之一：苹果、香蕉、樱桃、桃子、葡萄。与 C++ 没有什么不同。

非常有用的是以下功能，您可以在 Ada 中的每个枚举中获得以下功能，而无需任何额外工作：

*   打印出枚举值生成字符串版本
*   您可以增加枚举变量
*   您可以减少枚举变量

我希望这能更多地定义问题。

* * *

*从评论中添加的注释*：

*   参见：[维基百科](http://en.wikipedia.org/wiki/Enumerated_type#Ada) （Judah Himango，2008-11-19 at 0:09）
*   参见：[维基教科书](http://en.wikibooks.org/wiki/Ada_Programming/Types/Enumeration)

## Ada 枚举的有用特性

*   枚举中的第一个值是`fruit'first`which 给出`apple`.
*   枚举中的最后一个值是`fruit'last`which 给出`grape`.
*   递增操作`fruit'succ(apple)`给出`banana`.
*   减量操作`fruit'pred(cherry)`也给出了`banana`.
*   从枚举到整数的转换是`fruit'pos(cherry)`返回的`2`，因为 Ada 使用基于 0 的枚举。
*   从整数到枚举的转换是`fruit'val(2)`返回`cherry`。
*   从枚举到字符串的转换是`fruit'Image(apple)`返回（大写）字符串`"APPLE"`。
*   从字符串到枚举的转换是`fruit'Value("apple")`返回值`apple`。

* * *

另请参阅相关的 SO 问题：

*   [您使用的是 C++ 中的哪个类型安全枚举？](https://stackoverflow.com/questions/217549/which-typesafe-enum-in-c-are-you-using)
*   [下一个或上一个枚举](https://stackoverflow.com/questions/430264/next-or-previous-enum)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T23:35:56.170

好的，让我们暂时搁置 C++。C++ 只是 C 的超集（这意味着可以在 C 中完成的所有事情也可以在 C++ 中完成）。所以让我们专注于plain-C（因为这是我熟悉的语言）。C有枚举：

```
enum fruit { apple, banana, cherry, peach, grape }; 
```

这是完全合法的 C 并且值是连续的，apple 的值为 0，banana 的值为 apple + 1。您可以创建带有孔的枚举，但前提是您明确地制作这样的*孔*

```
enum  fruit { apple = 0, banana, cherry = 20, peach, grape }; 
```

apple 为 0，banana 为 1，cherry 为 20，因此 peach 为 21，grape 为 22，1 到 20 之间的所有值都是未定义的。通常你不想要洞。您可以执行以下操作：

```
enum fruit { apple = 0, banana, cherry, peach, grape };
enum fruit myFruit = banana;
myFruit++;
// myFruit is now cherry
printf("My fruit is cherry? %s\n", myFruit == cherry ? "YES" : "NO"); 
```

这将打印 YES。您还可以执行以下操作：

```
enum fruit { apple = 0, banana, cherry = 20, peach, grape };
enum fruit myFruit = banana;
myFruit++;
// myFruit is now cherry
printf("My fruit is cherry? %s\n", myFruit == cherry ? "YES" : "NO"); 
```

这将打印 NO，并且 myFruit 的值与任何枚举常量都不相同。

顺便说一句，为避免您必须说“enum fruit myFruit”，您可以使用 typedef 避免枚举。只需使用“typedef enum fruitfruit；” 在自己的线上。现在你可以说“fruit myFruit”，前面没有枚举。通常在定义枚举时直接完成：

```
typedef enum fruit { apple = 0, banana, cherry, peach, grape } fruit;

fruit myFruit; 
```

缺点是你不再知道fruit 是一个枚举，它可能是一个对象、一个结构或其他任何东西。我通常避免使用这些类型的 typedef，如果是 enum，我宁愿在前面写 enum，如果是 struct，我宁愿在前面写 struct（我将在这里使用它们，因为它看起来更好）。

无法获取字符串值。在运行时，枚举只是一个数字。这意味着，如果您不知道那是哪种枚举，这是不可能的（因为 0 可能是苹果，但它也可能是不同枚举集的不同事物）。但是，如果您知道它是一种水果，那么编写一个可以为您完成此任务的函数就很容易了。预处理器是你的朋友:-)

```
typedef enum fruit {
    apple = 0,
    banana,
    cherry,
    peach,
    grape
} fruit;

#define STR_CASE(x) case x: return #x
const char * enum_fruit_to_string(fruit f) {
    switch (f) {
        STR_CASE(apple); STR_CASE(banana); STR_CASE(cherry);
        STR_CASE(peach); STR_CASE(grape);
    }
    return NULL;
}
#undef STR_CASE

static void testCall(fruit f) {
    // I have no idea what fruit will be passed to me, but I know it is
    // a fruit and I want to print the name at runtime
    printf("I got called with fruit %s\n", enum_fruit_to_string(f));
}

int main(int argc, char ** argv) {
    printf("%s\n", enum_fruit_to_string(banana));
    fruit myFruit = cherry;
    myFruit++; // myFruit is now peach
    printf("%s\n", enum_fruit_to_string(myFruit));
    // I can also pass an enumeration to a function
    testCall(grape);
    return 0;
} 
```

输出：

```
banana
peach
I got called with fruit grape 
```

这正是您想要的，还是我完全走错了路？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T01:11:48.583

One of my colleagues has implemented a tool to generate classes that do most (if not all) of what you want:

[http://code.google.com/p/enumgen/](http://code.google.com/p/enumgen/)

The current implementation is in Lisp, but do not hold that against him :-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-17T03:43:24.420

我写了一个`enum_iterator`这样做的，连同一个`ENUM`使用 Boost.Preprocessor 的宏：

```
#include <iostream>
#include "enum.hpp"

ENUM(FooEnum, 
  (N)
  (A = 1)
  (B = 2)
  (C = 4)
  (D = 8));

int main() {
  litb::enum_iterator< FooEnum, litb::SparseRange<FooEnum> > i = N, end;
  while(i != end) {
    std::cout << i.to_string() << ": " << *i << std::endl;
    ++i;
  }
} 
```

它将枚举声明为普通的旧枚举，因此您仍可以将其用于“正常”目的。迭代器也可以用于其他具有顺序值的普通枚举，这就是为什么它有第二个模板参数，默认为`litb::ConsequtiveRange<>`. 它符合双向迭代器的要求。

愚蠢的代码可以[从这里下载](http://www.johannes-schaub.de/enums.tar.gz)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T01:05:49.687

There isn't an easy way to do that in C++, not least because the enumeration constants are not required to be unique or contiguous. The conversion from value to string is also non-trivial; the solutions I know of involve C/C++ Preprocessor hackery - and that is a pejorative use of the term hackery.

I'm tempted to say "No"; I'm not certain that's correct, but it most certainly is non-trivial.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T01:06:20.747

you might take a look at the java enum ([http://madbean.com/2004/mb2004-3/](http://madbean.com/2004/mb2004-3/)) and this idea: [http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T23:43:48.667

如果你对 enumgen 感兴趣，我用你的例子做了一个简单的演示。如前所述，我使用通用 lisp 实现了它，因此您编写的输入文件是 lispy，但我非常努力使语法合理。

这里是：

```
$ cat Fruit.enum
(def-enum "Fruit" (("apple")
                   ("banana")
                   ("cherry")
                   ("peach")
                   ("grape")
                   ("INVALID_")))

$ enumgen Fruit.enum
Using clisp
;; Loading file /tmp/enumgen/enumgen.lisp ...
;; Loaded file /tmp/enumgen/enumgen.lisp
loading def file:
;; Loading file /tmp/enumgen/enumgen.def ...
;; Loaded file /tmp/enumgen/enumgen.def
generating output:
  Fruit.cpp
  Fruit.ipp
  Fruit.hpp
DONE 
```

要查看生成的代码，请访问以下网址： [http ://code.google.com/p/enumgen/source/browse/#svn/trunk/demo](http://code.google.com/p/enumgen/source/browse/#svn/trunk/demo)

虽然它的功能非常丰富，但也可以通过在输入文件中设置变量或指定枚举器的属性来调整很多东西。

例如，默认情况下，它使用 std::string 表示字符串名称，但只要稍加努力，它就可以使用 char const * 或任何用户定义的字符串类。

您可以将多个名称映射到同一个枚举值，但必须选择一个作为“主要”，以便将值映射到字符串将产生此名称（与其他名称相反。）

您可以为枚举显式提供值，它们不需要是唯一的。（重复项是具有相同值的前一个枚举的隐式别名。）

此外，您可以遍历所有唯一值，并为每个值遍历其所有别名，如果您想为它们生成脚本语言“包装器”，这很有用，就像我们使用 ruby​​ 一样。

如果您有兴趣使用它并有任何疑问，请随时通过电子邮件与我联系。（在 gmail 的 cuzdav）。

希望这可以帮助。（除了测试套件和演示代码之外，没有很多文档，如果您关心的话，可以参考源代码。）

克里斯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T01:41:35.873

[本文](http://www.edm2.com/0405/enumeration.html)向您展示了如何生成枚举值的字符串版本，尽管它需要您自己编写代码来执行此操作。它还提供了一个预处理器宏，可以很容易地允许递增和递减枚举变量，只要您的枚举是连续的。

[该库](http://cryp.to/smart-enum/)提供更灵活的递增和递减。

[Boost Vault](http://www.boostpro.com/vault/)中的 enum_rev4.6.zip 库提供了简单的字符串转换。看起来它支持使用迭代器进行递增和递减（这可能不太方便，但它可以工作）。它基本上没有记录，尽管 libs/test 目录包含一些很好的示例代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-04T16:17:15.833

这是未发布的软件，但 Frank Laub 的 BOOST_ENUM 似乎符合要求。我喜欢它的部分是你可以在一个类的范围内定义一个枚举，大多数基于宏的枚举通常不允许你这样做。它位于 Boost Vault 中：[http](http://www.boostpro.com/vault/index.php?action=downloadfile&filename=enum_rev4.6.zip&directory=&) ://www.boostpro.com/vault/index.php?action=downloadfile&filename=enum_rev4.6.zip&directory=& 自 2006 年以来没有看到任何发展，所以我没有知道它与新的 Boost 版本的编译效果如何。在 libs/test 下查看使用示例。还有 Boost smart_enum（也没有发布）。它执行您问题的迭代器部分，但不是字符串的输出。[http://cryp.to/smart-enum/](http://cryp.to/smart-enum/)

# apache-flex - 为 Flex 应用程序实现“请稍候”控件的提示

> ID：300595
> 
> 赞同：2
> 
> 时间：2008-11-18T23:52:29.447
> 
> 标签：apache-flex, web-services, pleasewait

什么是为 Flex 应用程序制作“请稍候”控件以进行长时间运行的操作（如调用 Web 服务）的聪明方法。

我不是在问它的图形部分——只是“控制器”部分。我应该如何触发它并隐藏它。我打算只制作一个带有文本的简单画布。

例如 ：

*   我能否以某种方式拦截所有 Web 服务调用 - 而不必为每个 Web 服务激活它
*   我应该如何将它添加到我的画布上。它应该作为顶级组件添加到“阶段”吗？
*   如果需要太长时间，它是否应该有一个“取消”按钮来取消 Web 服务请求。这听起来有点复杂，因为我什至不确定是否可以终止正在运行的异步 Web 请求？

仅供参考：这是针对报告应用程序的，因此需要长时间运行的查询

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T14:57:34.893

我过去做过的一种方法是使用全局整数并根据运行的 Web 服务增加/减少值。当计数器为 0 时，我会隐藏加载文本，当它大于 0 时，我会显示加载文本。这是它的简化版本：

```
 <mx:Application>
    <mx:Script>
        [Bindable]public var ws_count:int = 0;
    </mx:Script>
    <mx:Label text = "loading..." visible="{ws_count > 0}" />
</mx:Application> 

```

然后我有一个小助手类来控制全局计数器：

```
 package ws {
    import mx.core.Application;
    public class WSCounter {
        public static function sent():void {
            Application.application.ws_count += 1;
        }
        public static function receive():void {
            Application.application.ws_count -= 1;
        }
    }
} 

```

然后所有需要做的就是在调用 Web 服务时调用辅助函数......例如：

```
 import ws.WSCounter;
import mx.rpc.http.HTTPService;

var srv:HTTPService = new HTTPService();
srv.url = "http://localhost/service.py";
srv.addEventListener(ResultEvent.RESULT,function(event:ResultEvent):void {
    WSCounter.receive();
});
srv.send();
WSCounter.sent(); 

```

我一直认为有更好的方法来做到这一点，就像你说的有某种类型的钩子来检测服务是否正在运行......我期待这篇文章中的其他回复......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-21T23:15:20.393

如果您使用像 Cairngorm 或类似的实现 MVC 的框架，直接的方法是更新绑定到 UI 组件（即 main mxml 下的 titleWindow 或其他）可见属性的“全局”变量（通过 Singleton 对象）。变量将在 execute() 期间更新为 true，在到达结果或错误回调方法时更新为 false。
您可以添加一个“取消”按钮，将变量重置为“false”，但这并不意味着服务器将停止异步调用。我不知道如何停止它并防止它从取消的方法调用返回数据。快速浏览一下 ASDoc，remoteobject 确实有一个 disconnect() 方法可以丢弃所有未决的请求响应者。我不确定这是否是优雅/正确的方法
如果您不想为每个 Web 服务调用设置它，您可能想使用自定义事件链（有关想法，请参阅[http://www.herrodius.com/blog/80](http://www.herrodius.com/blog/80)），这样您只需设置一次您正在调用单个或多个服务。

# testing - Scrum，但没有测试或文档

> ID：300605
> 
> 赞同：3
> 
> 时间：2008-11-18T23:58:17.110
> 
> 标签：testing, scrum

当你加入一个说他们使用 Scrum，但只将其用作时间管理工具而不是整个过程的团队时，你会怎么做？如何恢复回测和文档？

我正在考虑从添加专门用于测试和记录的用户故事开始。也许其他人对此有更多的经验，然后我对此进行了处理，因为我相信这并不少见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T00:02:12.173

Scrum 的关键在于，在将任务归类为已完成之前，可将其识别为“已完成”。贵公司如何在不审查文档和测试的情况下评估某事是否已完成？

也许他们有一种不寻常但有效的方式来做这件事。或者他们可能错过了“完成任务”的意义。我建议您首先询问他们如何衡量以及是否可以改进。然后建议将文档和测试作为改进流程的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T06:35:46.560

请注意，测试和文档实际上都不是 Scrum 的一部分。Scrum 是一种纯粹的项目管理方法 - 所需的工程实践，就像你提到的那样，应该在项目期间“出现”。更具体地说，它们应该在你在每个 sprint 结束时进行的心跳回顾中被识别出来。你在做那些吗？你能在那里提出你的担忧吗？它们实际上是团队最大的担忧吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T01:29:14.603

问题是他们没有任何文档和测试，还是他们没有实施整个 Scrum 方法？在我看来，这是两个非常不同的问题。

我更喜欢一个花费时间和精力来寻找和适应与其开发风格相匹配的开发过程的组织，而不是从高处强制执行一个真正的过程。因此，如果他们使用他们称为 Scrum 但不符合所有“官方”准则的流程，我根本不会担心。试着确定为什么这个过程是这样的。很有可能，如果他们花时间进行定制，团队就会接受你的想法，特别是如果你花时间确定事情为什么会这样。如果您只是简单地将其视为“这不是 Scrum，因此是不正确的”，您可能不会取得太大进展，但通过务实地看待好处，您可能会做出一些实质性的改进。

或者，如果他们没有进行测试并且没有任何文档，我会认为这是一个相当糟糕的迹象。通过文档，我在这里采取了极简主义的观点——功能列表、错误跟踪等——我会非常担心这些项目的缺失，而不是抽象列表中更高层的项目的缺失。在没有管理层支持的情况下，我建议您以身作则。自己设置一个简单的错误跟踪系统（有几个 - 在紧要关头，中央位置的简单文本列表也可以工作）。在其他人测试之前不要宣布您的功能完成。这可以简单到走到另一个开发人员面前，让他们在你面前尝试一下。如果有人声称某项功能已完成，请花几分钟时间熟悉它。如果您发现错误，请礼貌地向负责的开发人员提及。慢慢建立一个环境，让团队可以看到运行测试和跟踪功能和错误的好处。

大多数团队以这种方式运作只是因为错误地认为他们没有时间“做正确的事”，或者他们稍后会去做。当一个或两个开发人员作为副项目完成的简单概念验证转变为全面的开发工作时，通常会发生这种情况。通过展示它实际上可以节省时间和精力，并降低团队其他成员的初始成本，您经常会发现它作为流程的一部分变得根深蒂固，而实际上并未得到正式认可或接受。

如果您有管理层的支持，这将变得更加容易，但请始终小心确保团队能够接受更改。这可能意味着它需要的时间比您想要的要长，但是就这样吧，如果没有团队的支持，任何强制性流程都会在压力的第一个迹象出现时失败，这是您最需要流程的时候。

*免责声明 - 在我的上一个项目中，我带头调整 SCRUM 流程以适应我们的环境。“官方”流程对​​我们的客户来说根本站不住脚，但它仍然是我们定制流程的宝贵指南。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T00:16:30.130

“添加专门用于测试和记录的用户故事”

虽然元用户故事在某些圈子中可能有意义，但它很少能奏效。软件人员很少能很好地处理元用户故事，他们要么不知道他们可以通过编写故事来改变自己的流程，要么——更典型地——他们将元用户故事设计得死去活来。

当你采访用户时，感觉就像他们在编造用户故事。当然，当您聆听他们并尝试捕捉它时，您正在编造它。

当 IT 组织试图编造自己的关于 IT 应该如何工作的用户故事时，这个过程就会分崩离析。直到组织手动完成了很多次（例如测试），他们才真正有资格编写用户故事。然后，在他们完成之后，他们就不需要软件开发过程，他们只会一次一点地自动化重要的部分。

我认为改变必须来自一个不太正式的方向。实际上，不愿将未经测试的事情称为“完成”是一个很好的起点。

除非被迫，否则 IT 不会做任何事情。因此，与用户会面并找出他们不需要测试的原因。指导他们要求测试。告诉他们后果和要使用的词语。

组织中的很多问题都可能导致糟糕的流程。重要的是要知道哪里出了问题，并提出改变的需求。最好的办法是让你的老板抱怨你没有修复它，而不是你建议修复它可能会很好。

[当你的老板要求你修复流程时*感觉*不对，但这是改变发生的唯一方式。]

# powershell - 在 Powershell 中，如何将带有尾随“符号”的字符串转换为数字？

> ID：300606
> 
> 赞同：6
> 
> 时间：2008-11-18T23:59:01.460
> 
> 标签：powershell, globalization, type-conversion

我需要使用 Powershell 将带有可选尾随符号的字符串转换为实际数字。

可能的字符串是：

*   1000-
*   323+
*   456

我正在尝试将 System.Int.TryParse 与 AllowTrailingSign 的 NumberStyles 一起使用，但我无法弄清楚如何使 System.Globalization.NumberStyles 可用于 Powershell。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T00:28:53.443

编辑：根据 Halr9000 的建议

```
$foo = "300-";
$bar = 0;
$numberStyles = [System.Globalization.NumberStyles];
$cultureInfo = [System.Globalization.CultureInfo];

[int]::TryParse($foo, $numberStyles::AllowTrailingSign, $cultureInfo::CurrentCulture, [ref]$bar); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T00:20:49.733

```
[System.Globalization.NumberStyles]::AllowTrailingSign 
```

我还应该指出，当我处理一般的枚举时，有时我可以通过输入字符串来获得。例如，在这种情况下，只需放

```
"AllowTrailingSign" 
```

最后一点，在对所有可能值的枚举进行测试时，请使用以下行：

```
[System.Globalization.NumberStyles] | gm -static 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T03:28:07.310

这是获取枚举值的更好方法：

```
$type = [System.Globalization.NumberStyles]
[enum]::GetValues($type) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T00:11:20.563

如果您确定符号可能是 - 或 +，String.Replace 可能会有所帮助。

如果您的意思是 323- 应该返回 -323，检查符号并将其乘以 -1 会有所帮助。

# c# - 如何在 Windows Mobile 上设置网络管理设置或使对话框出现在 C# 中？

> ID：300607
> 
> 赞同：4
> 
> 时间：2008-11-18T23:59:15.640
> 
> 标签：c#, .net, windows-mobile, compact-framework

在 Windows Mobile 中，当您打开 Internet Explorer 并输入您的设备无法连接的 URL 时，您会收到通知并提示您（手动）导航到您可以作为用户实际执行此操作的屏幕（网络管理），像这样：

[替代文字 http://www.freeimagehosting.net/uploads/d3d95e00d2.gif](http://www.freeimagehosting.net/uploads/d3d95e00d2.gif)

但是，如果 .NET Compact Framework 应用程序尝试连接到 Web 服务并且无法访问 Web 服务 URL，则不会出现“无法连接”气泡，而是对 Web 服务的调用失败。有时我们最终会通过电话与客户*交谈*：

[替代文字 http://www.freeimagehosting.net/uploads/e74a0d4230.gif](http://www.freeimagehosting.net/uploads/e74a0d4230.gif)

然后他们还有两个步骤要走。

**问题 1：是否可以以编程方式控制（在 C# 中）网络管理屏幕上的两个 ComboBox 的设置？**

通常解决客户的连接问题涉及摆弄这两个盒子，直到它们可以连接。问题在于，由于客户可以自己在这里自由更改他们的网络内容，我经常不知道该告诉他们将其设置为什么（“它说明了什么？”这是我经常说的话）。到目前为止，从我的搜索来看，**DMProcessConfigXML 似乎**是这样做的方式，但到目前为止我所知道的是您调用此方法并传递一些 XML。

**问题 2：是否可以通过编程方式（C#）触发“无法连接”气泡，或者更好的是是否可以通过编程方式使网络管理屏幕立即出现？**

据推测，如果我的代码看不到 web 服务 URL，它可能会触发气泡或直接进入屏幕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-10T23:40:35.480

在回答您的问题 2 时，此代码将显示连接控制面板：

```
Process.Start(@"\windows\ctlpnl.exe", "cplmain.cpl,19"); 
```

许多内置设置小程序通过 ctlpnl.exe 显示。我从[这里](http://knowledgepointer.wordpress.com/2009/02/07/how-to-show-control-panel-applets/)的列表中获得了幻数，不确定它是否有帮助，因为您仍然需要指导用户完成其余的通信设置。

关于您的问题 1，我使用了 DMProcessConfigXML 和配置管理器设置 cabs 来配置通信设置（诚然来自 c++，但查看 api 它应该很容易按照 Shane 的建议进行 p/invoke）。这是不久前的事了，所以我现在手头没有任何示例，但我们确实可以进行新的网络设置并切换这些下拉菜单以选择新设置。稍后我会看看是否可以挖掘出 XML 的示例。

似乎不需要 P/Invoke，[ConfigurationManager.ProcessConfiguration](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.configuration.configurationmanager.processconfiguration.aspx)是 Microsoft.WindowsMo​​bile 命名空间中调用 DMProcessConfigXML 的托管包装器。

我仍在寻找要发送给它的正确 xml，很可能是 CM_Networks、CM_Planner 和其他一些组合的某种组合......细节都[在这里](http://msdn.microsoft.com/en-us/library/bb737572%28v=MSDN.10%29.aspx)，但文档有点棘手，无法弄清楚什么是什么，我可以'不记得了，因为那是很久以前的事了:(

好的，经过一些试验（因为我没有找到 xml），这里有一些 xml，您可以将其传递给 ConfigurationManager.ProcessConfiguration 来更改这两个设置：

```
<wap-provisioningdoc>
  <characteristic type="CM_ProxyEntries">
    <characteristic type="HTTP-{ADB0B001-10B5-3F39-27C6-9742E785FCD4}">
      <parm name="SrcId" value="{ADB0B001-10B5-3F39-27C6-9742E785FCD4}" options="My Work Network{18AD9FBD-F716-ACB6-FD8A-1965DB95B814}My ISP{ADB0B001-10B5-3F39-27C6-9742E785FCD4}Work{A1182988-0D73-439E-87AD-2A5B369F808B}Secure WAP Network{F28D1F74-72BE-4394-A4A7-4E296219390C}The WAP Network{7022E968-5A97-4051-BC1C-C578E2FBA5D9}The Internet{436EF144-B4FB-4863-A041-8F905A62C572}" />
      <parm name="DestId" value="{436EF144-B4FB-4863-A041-8F905A62C572}" options="My Work Network{18AD9FBD-F716-ACB6-FD8A-1965DB95B814}My ISP{ADB0B001-10B5-3F39-27C6-9742E785FCD4}Work{A1182988-0D73-439E-87AD-2A5B369F808B}Secure WAP Network{F28D1F74-72BE-4394-A4A7-4E296219390C}The WAP Network{7022E968-5A97-4051-BC1C-C578E2FBA5D9}The Internet{436EF144-B4FB-4863-A041-8F905A62C572}" />
      <parm name="Proxy" value="new-inet:1159" />
      <parm name="Override" value="" />
      <parm name="Enable" value="1" />
      <parm name="Type" value="0" />
      <parm name="Username" value="" />
      <parm name="Password" value="" />
      <parm name="ExtraInfo" value="" />
    </characteristic>
    <characteristic type="null-corp-{ADB0B001-10B5-3F39-27C6-9742E785FCD4}">
      <parm name="SrcId" value="{ADB0B001-10B5-3F39-27C6-9742E785FCD4}" options="My Work Network{18AD9FBD-F716-ACB6-FD8A-1965DB95B814}My ISP{ADB0B001-10B5-3F39-27C6-9742E785FCD4}Work{A1182988-0D73-439E-87AD-2A5B369F808B}Secure WAP Network{F28D1F74-72BE-4394-A4A7-4E296219390C}The WAP Network{7022E968-5A97-4051-BC1C-C578E2FBA5D9}The Internet{436EF144-B4FB-4863-A041-8F905A62C572}" />
      <parm name="DestId" value="{A1182988-0D73-439E-87AD-2A5B369F808B}" options="My Work Network{18AD9FBD-F716-ACB6-FD8A-1965DB95B814}My ISP{ADB0B001-10B5-3F39-27C6-9742E785FCD4}Work{A1182988-0D73-439E-87AD-2A5B369F808B}Secure WAP Network{F28D1F74-72BE-4394-A4A7-4E296219390C}The WAP Network{7022E968-5A97-4051-BC1C-C578E2FBA5D9}The Internet{436EF144-B4FB-4863-A041-8F905A62C572}" />
      <parm name="Proxy" value="" />
      <parm name="Override" value="" />
      <parm name="Enable" value="1" />
      <parm name="Type" value="0" />
      <parm name="Username" value="" />
      <parm name="Password" value="" />
      <parm name="ExtraInfo" value="" />
    </characteristic>
  </characteristic>
  </wap-provisioningdoc> 
```

这是从我的 wm 6 pro 模拟器中获取的，因此您可能需要稍微调整一下设置。它将两个下拉菜单都设置为我的 ISP（ADB0B001-10B5-3F39-27C6-9742E785FCD4 guid）只需更改 type="HTTP-xxxx" 和 type="null-corp-xxxx" 中的 guid 并确保它在srcId 参数也是。

我用这个 xml（元数据设置为 true）调用 ProcessConfiguration 以获取所有已配置条目的列表，它在 xml 文档中返回它们。

```
<wap-provisioningdoc>
  <characteristic-query type="CM_Mappings" recursive="true"/>
  <characteristic-query type="CM_Planner" recursive="true"/>
  <characteristic-query type="CM_Networks" recursive="true"/>
  <characteristic-query type="CM_ProxyEntries" recursive="true"/>
  <characteristic-query type="Wi-Fi" recursive="true"/>
  <characteristic-query type="CM_PPPEntries" recursive="true"/>
  <characteristic-query type="CM_VPNEntries" recursive="true"/>
  <characteristic-query type="CM_NetEntries" recursive="true"/>
  <characteristic-query type="CM_GPRSEntries" recursive="true"/>
</wap-provisioningdoc> 
```

您可以使用它来查看 guid 和设置是什么，或者查看 WM sdk 中的包含文件，因为它们在那里列出以与连接管理器 api 一起使用。

一个警告是我在弄乱它们之后没有尝试使用这些连接，但是当你处理配置时 UI 确实会改变

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T05:13:03.463

您需要使用[Connection Manager](http://msdn.microsoft.com/en-us/library/ms879581.aspx) API 来建立连接。实际上，您可以设置一个标志来停止错误通知！

[这](http://blogs.msdn.com/windowsmobile/archive/2005/09/14/466579.aspx)是一篇关于如何在 wininet 中使用连接管理器的文章。我假设您将不得不 P/Invoke API。

我的一个建议是尽可能抽象地使用连接管理器，并尽可能少地使用它。连接管理器使用起来不是很好，我相信当前的界面将在未来版本的 Windows Mobile 中被删除。

更新：

从本机代码调用[DMProcessConfigXML](http://msdn.microsoft.com/en-us/library/ms852998.aspx)非常简单。我再次假设这个函数在 C# 中的 P/Invoke 应该不会太糟糕。按照链接查看调用此 DMProcessConfigXML 的简单示例。had 部分是从 microsoft 文档中找出您要发送的 xml。

您基本上需要在可以配置的任何区域中查看[配置服务提供商](http://msdn.microsoft.com/en-us/library/ms889540.aspx)MSDN 文档。如果您正在研究网络设置，我个人不会打扰。这是一个大麻烦，实际上仅对为特定移动运营商和/或公司网络 WIFI 设置设置代理设置有用。如果您想设置通用的 GPRS / Wifi 连接，这并不容易。

更新2：我应该更仔细地阅读这个问题，我相信“修改网络选项”的答案是否定的，但创建全新的网络设置的答案是“是的”。那是如果我正确理解规范。我只玩过设置网络。

希望有帮助。

# java - 用 Java 发送电子邮件

> ID：300611
> 
> 赞同：1
> 
> 时间：2008-11-19T00:00:57.837
> 
> 标签：java, email, web-applications

我已经读过要使用 Java 发送电子邮件我需要获取我的 ISP 的 SMTP 地址，但如果我打算在线托管我的 Web 应用程序，这将是我的主机 ISP SMTP 地址吗？

编辑：所以我需要找出我的客户 ISP 的 SMTP 地址并通过它发送？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T02:34:16.983

[JavaMail](http://java.sun.com/products/javamail/)是电子邮件的内置 API。

询问您的 ISP 主机是否在本地运行 sendmail 或同等功能（Web 服务器主机）。尽早移交给 sendmail 可能是一个优势。换句话说，尝试将“localhost”作为 SMTP 服务器名称。

为什么？JavaMail 是一个简单的 SMTP 客户端。它不处理 DNS MX 记录。如果 SMTP 服务器不可用，它没有内置的邮件队列功能。有默认的 Java 无限 DNS 缓存，因此对 SMTP 主机的 DNS 更改不会在您的应用程序中注册（可调整，但需要进行更多调整）。这些是本地 sendmail（或等效）进程会做的事情。

因此，如果您可以将电子邮件移交给本地 sendmail/等价物，则可能会提高电子邮件传递的可靠性。当然，假设本地 sendmail 有效。这就是我们如何配置一些使用 JavaMail 发送邮件的内部应用程序并解决所有上述问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T00:05:03.943

不可以，除非您的虚拟主机与您的 ISP 相同，或者您的虚拟主机也提供 SMTP 服务。

作为对您的编辑的回应，是的，您需要您的 ISP 的 SMTP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T00:05:07.627

它将是您要通过其转发电子邮件的 SMTP 地址。

如果您想通过您的 ISP 帐户发送电子邮件，那么它将是 SMTP。

# algorithm - 视觉间隔对象的算法

> ID：300616
> 
> 赞同：1
> 
> 时间：2008-11-19T00:02:24.293
> 
> 标签：algorithm, language-agnostic, graphics

我想知道是否有任何众所周知的算法我应该知道在视觉上间隔对象。

例如，一个 LINQ to SQL 图有许多表，但为了便于阅读，会自动将它们隔开。这几乎是一个“如果太近/重叠，随机放置并移动”类型算法还是还有更多？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T00:09:18.757

粗略地说，您可以对对象图执行“连通性”分析，以确定哪个（是）更中心；即与其他对象具有更高程度的连接性。那些在中心。确定您个人的对象大小，确定剩余空间量，将其除以要放置的项目数，然后根据该数据放置它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T00:37:24.380

看看[GraphViz](http://www.graphviz.org/)。它可能是现成可用的，或者可能是一个很好的起点。

# cocoa - 使用 Cocoa (OS X) 进行内存中 mime 类型检测？

> ID：300618
> 
> 赞同：4
> 
> 时间：2008-11-19T00:03:11.687
> 
> 标签：cocoa, macos, mime-types, quicktime

我的应用程序是一个自定义格式的查看器，一个带有明确定义的 XML 清单和资源（如图像和电影）的 zip 文件。我使用 zlib 打开内存中的 zip 文件，然后继续显示所述资源。

我遇到的一个问题是我无法正确显示视频，显然是因为 QTMovie 无法确定 mime 类型。从文件（[QTMovie movieWithFile]）加载的电影效果很好。从内存加载（[QTMovie movieWithData]）拒绝工作。

这是有道理的，因为缺少文件扩展名，QTMovie 无法确定 mime 类型信息。经过一番搜索后，我采用了以下方式使用 QTDataReference：

```
NSData *movieData = ...read from memory...;
QTDataReference *movieDataReference = [[QTDataReference alloc] initWithReferenceToData:movieData name:fileName MIMEType:@"video/x-m4v"];
QTMovie *mov = [QTMovie movieWithDataReference:movieDataReference error:&err]; 
```

这很好用，但是硬编码 MIMEType 远非理想。我可以访问文件名和扩展名，所以我尝试使用 UTI 找到 mime 类型（感谢#macdev 上的好人）：

```
- (NSString*)mimeTypeForExtension:(NSString*)ext {

    CFStringRef UTI = UTTypeCreatePreferredIdentifierForTag(kUTTagClassFilenameExtension,(CFStringRef)ext,NULL);
    return NSMakeCollectable(UTTypeCopyPreferredTagWithClass((CFStringRef)UTI,kUTTagClassMIMEType));
} 
```

然而这不起作用。显然，在某个地方有一个内部 OS X 扩展数据库和相应的 mime 类型。否则从磁盘电影将无法正常工作。我如何访问它？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T22:54:40.593

您遇到的问题是 m4v 和 m4p 没有向 Launch Services 注册的 mime 类型（可能是因为 m4v 和 m4p 的 mime 类型不是标准的）。无论如何，您可能应该做的是处理这样的边缘情况，然后在函数返回时检查 nil （以防扩展既未注册也未由您处理）。

另一件事是您当前的使用正在泄漏内存。我假设您正在使用垃圾收集，但第一次调用会创建一个永远不会释放的 CFString。这是您的方法的建议实现：

```
-(NSString*)mimeTypeForExtension:(NSString*)ext
{
    NSAssert( ext, @"Extension cannot be nil" );
    NSString* mimeType = nil;

    CFStringRef UTI = UTTypeCreatePreferredIdentifierForTag(kUTTagClassFilenameExtension,
        (CFStringRef)ext, NULL);
    if( !UTI ) return nil;

    CFStringRef registeredType = UTTypeCopyPreferredTagWithClass(UTI, kUTTagClassMIMEType);
    if( !registeredType ) // check for edge case
    {
        if( [ext isEqualToString:@"m4v"] )
            mimeType = @"video/x-m4v";
        else if( [ext isEqualToString:@"m4p"] )
            mimeType = @"audio/x-m4p";
        // handle anything else here that you know is not registered
    } else {
        mimeType = NSMakeCollectable(registeredType);
    }

    CFRelease(UTI);
    return mimeType;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-19T15:05:26.233

您可以使用 NSWorkspace 让系统猜测文件的 UTI。

```
-(NSString *)mimeTypeForFileAtPath:(NSString *)path error:(NSError **)err {
  NSString *uti, *mimeType = nil;

  if (!(uti = [[NSWorkspace sharedWorkspace] typeOfFile:path error:err]))
    return nil;
  if (err)
    *err = nil;

  if ((mimeType = (NSString *)UTTypeCopyPreferredTagWithClass((CFStringRef)uti, kUTTagClassMIMEType)))
    mimeType = NSMakeCollectable(mimeType);

  return mimeType;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-18T20:34:19.890

建议大家把return改成[mimeType autorelease]；- 我们中的一些人仍然使用古老的方式！

谢谢！这是一个很大的帮助。

# window - 窗口边框宽度和高度

> ID：300629
> 
> 赞同：1
> 
> 时间：2008-11-19T00:09:02.843
> 
> 标签：window, border

我正在编写一个direct3d应用程序，并注意到奇怪的错误，例如即使在它被关闭并且鼠标指针没有与具有相同坐标的东西对齐时也会发生抗锯齿，我发现在创建窗口时，宽度和高度参数包括边框。该程序将 800x600 图形输出渲染到相同大小的窗口，但由于边框的原因，它被压缩成 792x566 矩形。我已经增加了窗口的大小来进行补偿，但是如果系统使用标准 XP 样式以外的边框样式，这将不起作用。（以经典风格为例）

有没有办法在我创建窗口之前告诉边框宽度和高度是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T00:22:11.040

另一种选择是确保 D3D 表面的大小与客户端矩形大小（[GetClientRect()](http://msdn.microsoft.com/en-us/library/ms633503(VS.85).aspx)）相同。然后你就知道你会渲染到合适的大小，而不必担心菜单、边框等的宽度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T00:12:20.810

听起来您正在寻找 GetSystemMetrics 函数。例如，以像素为单位的边框宽度由

```
GetSystemMetrics(SM_CXBORDER) 
```

**添加：** 对于总大小，您需要将非客户区的各种“部分”相加：边框、框架大小、标题栏等。

# testing - JMeter 测试和非静态 GET/POST 参数

> ID：300631
> 
> 赞同：2
> 
> 时间：2008-11-19T00:09:22.250
> 
> 标签：testing, post, get, jmeter

在针对 Web 应用程序编写 JMeters 测试时使用的最佳策略是什么，其中某些查询字符串和发布变量的值将在每次运行时发生变化。

快速，常见，示例

1.  你去一个网页
2.  在表格中输入一些信息
3.  点击保存
4.  在后台，在数据库中输入了一条新记录
5.  您想编辑刚刚输入的记录，因此您转到另一个网页。在幕后，它向页面传递了一个带有您刚刚创建的行的数据库 ID 的参数

当您运行上述测试的第 5 步时，页面参数/数据库 ID 每次都会发生变化。

我目前使用的工作流程/策略是

1.  使用上述操作记录测试
2.  记下查询字符串变量可能因运行而变化的每个地方
3.  使用 XPath 或正则表达式提取器将值从响应中提取到 JMeter 变量中
4.  用上述变量替换硬编码参数的所有适当实例。

这是可行的，并且可以在一定程度上实现自动化。但是，它可能会变得乏味、容易出错且脆弱。是否有更好/普遍接受的方式来处理这种情况？（或者这就是为什么大多数人只使用 JMeter 来回放日志的原因？（-;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T08:09:25.587

在我看来，你在正确的轨道上。JMeter 可以实现的最佳效果是使用正则表达式或 xpath 后处理器提取页面变量。但是，您绝对正确，因为这不是一个可扩展的解决方案，并且维护或增长变得越来越棘手。

如果您已经达到目的，那么您可能需要考虑一种更专门用于解决此类问题的工具。看看Watir之类的web测试工具，它会自动处理变化的post参数；但是如果您需要进行数据库更新，您仍然需要提取参数，但是使用 Watir 可以更好地重用代码，从而减少问题的痛苦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T21:54:30.120

通过将参数存储在 JDBC 断言中的 JMeter 变量中，我们在使用 JMeter 测试类似场景方面取得了巨大成功。然后我们执行我们的 http get/post 并使用 BSF 断言和 javascript 对响应进行复杂的验证。希望能帮助到你

# c# - 为黑莓创建 c# 邀请

> ID：300633
> 
> 赞同：0
> 
> 时间：2008-11-19T00:10:36.633
> 
> 标签：c#, email, invite

我需要在 C# 中创建一封发送到黑莓（或 Outlook）并被识别为邀请的电子邮件。现在，我创建了一封包含 text.ics 附件的电子邮件，以便在 Outlook 中，用户可以单击附件并将其添加到他的日历中，这样就可以了。问题是它在 Outlook 邀请电子邮件和黑莓上都没有被识别为邀请。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T10:23:49.267

[http://shaunakpandit.wordpress.com/2008/09/10/sending-a-appointment-programmatically-through-code-aspnet-icalendar-format/](http://shaunakpandit.wordpress.com/2008/09/10/sending-a-appointment-programmatically-through-code-aspnet-icalendar-format/)在帖子末尾描述了所需的格式。

问候，坦伯格

# visual-studio - 有什么方法可以从命令行运行宏（在打开的 VS 实例中）？

> ID：300634
> 
> 赞同：1
> 
> 时间：2008-11-19T00:10:45.837
> 
> 标签：visual-studio, macros

我通常每晚运行一个脚本，从 SVN 更新我的代码，然后构建它。最近几天，我有一个很长的调试运行，我想在晚上开始，这样它可以在我第二天早上来之前经历一两个小时才能遇到错误。到目前为止，我这样做的方式是在晚上晚些时候使用 VPN 来开始运行。

有什么办法可以让脚本告诉活动的 Visual Studio 实例执行宏？要么启动一个新实例，一旦它打开就会运行一个宏。这样我就可以自动化整个事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T02:23:35.023

要在新会话中**执行宏或命令，请执行以下操作：**

```
devenv /Command CommandName 
```

要**调试**可执行文件，请执行以下操作：

```
devenv /DebugExe ExecutableFile 
```

要使用默认设置**运行解决方案：**

```
devenv /r Solution 
```

更多信息： http: [//msdn.microsoft.com/en-us/library/a329t4ed (VS.80).aspx](http://msdn.microsoft.com/en-us/library/a329t4ed(VS.80).aspx)

# java - 启动 java 应用程序时使用 -noverify

> ID：300639
> 
> 赞同：46
> 
> 时间：2008-11-19T00:12:27.440
> 
> 标签：java, command-line-arguments

我见过许多应用程序`-javaagent`在加载时采用仪器类并作为参数，也将 a 放入`-noverify`命令行。

Java 文档说这`-noverify`会关闭类验证。

但是，即使他们正在检测类，为什么有人想要关闭验证？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-19T00:20:37.783

启动时间，我会说。加载类时验证类是否正确需要一些时间。由于类可能以惰性方式加载（不是在应用程序启动时，而是在第一次使用时），这可能会导致意外和不希望的运行时延迟。

实际上类一般不需要检查。编译器不会发出任何无效的字节码或类构造。进行验证的原因是该课程可能建立在一个系统上，在线托管并通过未受保护的互联网传输给您。在这条路径上，恶意攻击者可能会修改字节码并创建编译器可能永远不会创建的东西；可能会使 JVM 崩溃或可能绕过安全限制的东西。因此，在使用该类之前对其进行验证。如果这是本地应用程序，通常不需要再次检查字节码。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-12-04T20:03:24.267

当它与 结合使用时`-javaagent`，很可能**不是**出于性能原因，而是因为代理故意创建“无效”字节码。

需要注意的是，无效的字节码可能仍然可以正常执行，因为某些验证规则非常严格。例如，`this`在调用超级构造函数之前不能在构造函数中访问，因为此时变量尚未初始化。但是您可能还想做其他事情（请参阅 JRebel 示例）。然后，您可以`-noverify`用来规避该规则。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-01T21:17:07.667

调试！事实上，这就是我现在正在做的事情，以及我是如何偶然发现这个问题的。在 Terracotta，我们做了很多字节码检测，有时在调试类适配器时关闭验证器会有所帮助，这样我们就可以看到它们在运行时到底在哪里失败。

你说得对，我们希望验证器继续投入生产。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-07-29T12:12:34.397

不使用 JRebel`-noverify`将在启动时发出此警告：

> JRebel：缺少“-noverify”，将无法启用更改/添加/删除构造函数！

因此，似乎`-noverify`允许字节码重新检测来做一些原本不可能的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T15:25:07.440

启动时间曾经是一个问题。但是，验证器现在更快，处理器也更快。默认情况下，使用 JDK6 javac 编译的代码将包含额外信息以加快验证程序步骤。Apache Harmony 只是使用了更快的验证算法。

一些非常旧的 javac 版本产生了不正确的字节码。实际上，Sun 插件仍然包含修复代码，以验证某些损坏的类文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-19T17:32:12.743

JAVA 6 中引入的新验证器对于代码操作的处理非常复杂。

看看这个： [http ://chrononsystems.com/blog/java-7-design-flaw-leads-to-huge-backward-step-for-the-jvm](http://chrononsystems.com/blog/java-7-design-flaw-leads-to-huge-backward-step-for-the-jvm)

以及相关的错误报告： [http ://bugs.sun.com/view_bug.do?bug_id=8009595](http://bugs.sun.com/view_bug.do?bug_id=8009595)

# wpf - 更改 WPF RichTextBox 的字体增量

> ID：300656
> 
> 赞同：1
> 
> 时间：2008-11-19T00:25:51.483
> 
> 标签：wpf, richtextbox

我正在使用 WPF RichTextBox 控件输入一些具有用户格式化功能的文本，包括字体大小调整。每次执行命令时，IncreaseFontSize 和 DecreaseFontSize 的内置命令都会将字体大小调整 0.75pt。我想将粒度增加到 2pt。

这可以在不实现我自己的自定义命令的情况下完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T19:09:23.493

不幸的是，该值是硬编码的，您无法更改它。实现这一点的最快方法是使用 TextRange 类。像这样的东西：

```
var range = new TextRange( rtb.Document.ContentStart, rtb.Document.ContentEnd );
range.ApplyPropertyValue( TextElement.FontSizeProperty, 30.0 ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T13:30:05.123

这不适用于作为文本块的 InlineContainer

# scheme - 如何使用套装！在计划函数中？

> ID：300658
> 
> 赞同：4
> 
> 时间：2008-11-19T00:27:02.060
> 
> 标签：scheme

你会怎么用set！在一个简单的过程 f 中，如果 (+ (f 0) (f 1)) 的参数是从左到右计算的，那么计算 (+ (f 0) (f 1)) 将返回 0，但如果参数是从右到左计算的，则返回 1？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T00:40:36.197

最简单的方法可能是存储一些外部状态并让 f 的实现影响它的内容。

```
(define x 0)
(define (f n) (let ((tmp x)) (set! x n) tmp)) 
```

因此，x 最初为 0，每次调用 f 都将返回 x 的当前值并将参数保存为 x 的新值。因此，(f 0) 后跟 (f 1) 都将返回 0，最终的 x 值为 1。而评估 (f 1) 后跟 (f 0) 将产生 0 然后 1，最终 x 为 0。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-22T08:16:04.953

用[call/cc](http://community.schemewiki.org/?call-with-current-continuation)。

```
(define (f)
  (call/cc
    (lambda (c) (+ (c 0) (c 1)))))

(write (f)) 
```

在任一参数中调用 c`+`会导致`*f*`立即返回，产生 0 或 1，具体取决于首先评估哪个参数。

但我怀疑它总是会从左到右评估并因此返回 0。

# c# - 如何在不在列表中的字符串中查找第一个字符的索引

> ID：300660
> 
> 赞同：1
> 
> 时间：2008-11-19T00:30:20.883
> 
> 标签：c#, string, search

我知道我可以遍历字符串或构建正则表达式或反转集合（毕竟 ASCII 不是那么大）并搜索它的第一个实例，但 Yuck。

我正在寻找的是一个不错的单班轮。

功能越少越好，LINQ 已经出局（对我来说，别问了，*说来话长*）

* * *

我要使用的解决方案（除非我看到更好的东西）

```
static int FirstNotMeta(int i, string str)
{
    for(; i < str.Length; i++)
        switch(str[i])
        {
            case '\\':
            case '/':
            case '.':
                continue;
            default:
                return i;
        }
    return -1;
} 
```

好吧，我作弊了，我提前知道我在乎什么 char。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T00:46:01.337

这有效：

```
public static char FindFirstNotAny(this string value, params char[] charset)
{
    return value.TrimStart(charset)[0];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T00:36:30.170

如果您无法访问 LINQ，我认为您可能只需要编写一个带循环的静态方法（无论如何这可能比 LINQ 更有效。请记住，编译器会尽可能内联小方法。

我能想到的最简单的非 LINQ 如下。我建议添加大括号，以便范围和块清晰：

```
public static char? GetFirstChar(string str, char[] list)
{
    foreach (char c in str) if (!list.Contains(c)) return c;
    return null;
} 
```

使用 C# 3.0 和 LINQ：

```
char[] list = { 'A', 'B' };
string str = "AABAGAF";

char first = str.ToArray().Where(c => !list.Contains(c)).FirstOrDefault(); 
```

在这种情况下，如果没有非列表字符，first 将等于 0x0000（或*字符*null）。你可以这样做：

```
char? first = str.ToArray().Cast<char?>().Where(
    c => !list.Contains(c.Value)).FirstOrDefault(); 
```

如果没有匹配项，则 first 将为 null。这也可以写成：

```
var query = from char c in str
            where !list.Contains(c)
            select (char?)c;
char? first = query.FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T00:35:32.807

不是那么有效，但是：

```
char f(string str, IEnumerable<char> list)
{
  return str.ToCharArray().First(c => !list.Contains(c))
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T01:08:07.763

这个 C/C++ 示例是否适合您：

```
char *strToSearch = "This is the one liner you want"
char *skipChars = "Tthise";
size_f numToSkip = strcspn(strToSearch, skipChars); 
```

该`strcspn()`函数扫描字符串以查找指定集合的​​补码。它返回集合中*不*包含字符的初始字符数。

# c++ - 如何使用 reverse_iterator 插入

> ID：300662
> 
> 赞同：29
> 
> 时间：2008-11-19T00:33:38.473
> 
> 标签：c++, stl

我想在 C++ 中的 STL 列表中插入一些东西，但我只有一个反向迭代器。完成此操作的通常方法是什么？

这有效：（当然可以）

```
std::list<int> l;
std::list<int>::iterator forward = l.begin();
l.insert(forward, 5); 
```

这不起作用：（我应该怎么做？）

```
std::list<int> l;
std::list<int>::reverse_iterator reverse = l.rbegin();
l.insert(reverse, 10); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-19T00:47:28.307

`l.insert(reverse.base(), 10);`鉴于您对“反向”迭代器的定义，将在末尾插入“10”。其实，`l.rbegin().base() == l.end()`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-19T00:54:13.113

本质上，你没有。参见 TCPPPL 中的 19.2.5。

`reverse_iterator`有一个名为的成员，`base()`它将返回一个“常规”迭代器。因此，以下代码将适用于您的示例：

```
l.insert(reverse.base(), 10); 
```

不过要小心，因为该`base()`方法在原始`reverse_iterator`指向之后返回元素之一。（这是为了让 reverse_iterators 指向`rbegin()`并`rend()`正常工作。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-16T22:33:45.023

以防万一它有帮助，因为这是搜索的第一次点击，这里是一个使用`rbegin`. 这应该比使用`std::stringstream`or更快`sprint`。在某些印刷工作中，我挑衅地呼叫会员`fmt_currency`数千次。`std::isalnum`用于处理减号。

```
std::wstring fmt_long(long val) {//for now, no options? Just insert commas
    std::wstring str(std::to_wstring(val));
    std::size_t pos{ 0 };
    for (auto r = rbegin(str) + 1; r != str.rend() && std::isalnum(*r); ++r) {
        if (!(++pos % 3)) {
            r = std::make_reverse_iterator(str.insert(r.base(), L','));
        }
    }
    return str;
} 
```

# unit-testing - 如何对使用 ASP.NET 提供程序模型编写的代码进行集成测试？

> ID：300664
> 
> 赞同：0
> 
> 时间：2008-11-19T00:34:33.497
> 
> 标签：unit-testing, nunit, provider-model

我对单元测试相当陌生。我有一个建立在 3 层架构中的站点，UI -> BLL -> DAL。而且我使用了 asp.net 提供程序模型，因此通过对 web.config 进行更改，我可以切换到 DAL dll 以针对不同的数据源，以完成使用实体框架编写的 DAL。

现在，我的问题是如何对我的 BLL 进行单元测试？我使用 NUnit。

如果运行/调试我的站点，asp.net/IIS 会加载所有内容并从 web.config 获取正确的配置，所以一切正常，因为入口点来自 IIS。现在，如果我使用 NUnit gui 进行测试并说我的测试项目“MySite.Test.dll”对我的 BLL 有测试用例，那么测试框架如何获得正确的配置以成功运行所有测试。它需要 web.config 中的信息来加载正确的提供程序！

现在，在我的 DAL 中有一个由 EntityFramework 创建的 App.config，其中只有 connectionString。我应该将所有与提供程序相关的配置都放在这个 app.config 中吗？还是我错过了一些关于如何正确执行此操作的大图？

这应该是我认为人们需要经常做的一件常见的事情。有人可以详细说明如何对我的库进行单元测试。

谢谢你，雷。

* * *

编辑：阅读前 2 个答案后，我认为我应该通过集成测试更正我的描述。基本上不是 IIS 作为入口点，而是使用 NUnit 之类的 GUI 工具来运行和测试我的代码，所以 NUnit -> BLL -> DAL。人们如何实际设置它？

谢谢，雷。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T00:48:49.567

Looks like what you are trying to do - is integration testing... Unit testing, by definition, testing Plain Old .Net Classes in isolation. No database, no configuration...so...as I see it, to do proper unit testing, you need to refactor your BLL to service layer and domain logic classes which you will test separately. Like: Service layer uses domain logic classes, and your unit test uses them. So, domain classes do not go to database, and you do not need connection strings and everything.

However, if you want to do proper integration testing with database, you might want to do that too. If this is what you need - google it, it's not difficult to get some configuration strings in nunit.config or something...I don't know the details.

However, I feel what you want to do is unit testing and not integration testing..

Ask yourself, WHAT EXACTLY DO I WANT TO TEST? Unit testing does not test "everything". Refactor, invert dependencies, and try to test you business logic in isolation.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:22:00.560

您需要一个“MySite.Test.dll.config”文件，而不是单元测试项目中的“web.config”文件，而您可以在其中输入正确的测试配置。请注意，使用此方法，您可以根据需要使用不同的提供程序连接到内存数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T01:02:00.523

You have a couple of different options depending on how isolated you want to be from the DAL. If you want to involve the DAL in your tests, then you can copy the connection string section of the app.config file to an app.config file in your unit test project. As @badbadboy says, though, this really is integration testing, not unit testing.

If you want to do proper unit testing you probably want to use dependency injection and interfaces to allow you to mock out the DAL from your BLL. I use LINQ-to-SQL so what I do is create an interface and wrapper class around the DataContext. This allows me to create a mock database to use for unit testing to test my entity classes in isolation.

Testing your entity classes in isolation will make your tests less brittle and allow you to set up the data for each test independently. This makes it much easier to maintain.

You also might want to look into a mocking framework that will make it almost trivial to generate the mock objects. I've had pretty good success with Rhino Mocks, but there are others.

# c++ - 启动应用程序，在 C++ 中捕获标准输出和标准错误

> ID：300669
> 
> 赞同：8
> 
> 时间：2008-11-19T00:36:50.293
> 
> 标签：c++, process, stdout, capture, launch

如何启动应用程序并通过 stdout 和 stderr 捕获输出？

我正在编写一个自动构建系统，我需要捕获输出以进行分析。我想更新 svn repo 并获取修订号，以便如果成功，我可以将文件移动到 autobuild/revNumber/ 中。我还想使用 make 构建并将编译文本上传到我的服务器，让每个人都能看到构建失败的警告和错误。

我找不到该`system()`功能，但我`CreateProcess()`在MSDN上找到了该功能。我能够启动我需要的东西，但我不知道如何捕获标准错误和标准输出。我注意到该进程单独启动，除非我设置断点并让我的应用程序退出，然后它将所有文本保留在我的应用程序控制台窗口中。我还想等到所有进程完成，然后扫描它产生的数据以执行我需要的任何其他操作。我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-19T00:42:34.150

在真正的贝壳中（意思是，不是贝壳——我的意思是，不是在 C Shell 或其衍生物中），然后：

```
program arg1 arg2 >/tmp/log.file 2>&1 
```

这将使用给定的参数运行程序，并将标准输出重定向到 /tmp/log.file；符号（~~象形文字~~) ' `2>&1`' 最后将 stderr (文件描述符 2) 发送到 stdout (文件描述符 1) 所在的位置。请注意，操作顺序很重要；如果您反转它们，那么标准错误将转到标准输出所在的位置，然后标准输出（但不是标准错误）将被重定向到文件。

显示的文件名选择很糟糕，原因有很多——您应该允许用户选择目录，并且可能应该在文件名中包含进程 ID 或时间戳。

```
LOG=${TMPDIR:-/tmp}/log.$$.$(date +%Y%m%d-%H%M%S)
program arg1 arg2 >$LOG 2>&1 
```

在 C++ 中，您可以使用`system()`函数（从 C 继承）来运行进程。如果您需要知道 C++ 程序中的文件名（似是而非），则在程序中生成名称（`strftime()`是您的朋友）并使用该文件名创建命令字符串。（严格来说，您还需要`getenv()`获取 $TMPDIR，以及`getpid()`获取进程 ID 的 POSIX 函数，然后您可以模拟两行 shell 脚本（尽管使用的 PID 是 C++ 程序的，而不是启动的 shell）。

您可以改为使用 POSIX`popen()`函数；您必须`2>&1`在创建的命令字符串中包含“”符号，以将命令的标准错误发送到与标准输出相同的位置，但您不需要临时文件：

```
FILE *pp = popen("program arg1 arg2 2>&1", "r"); 
```

然后，您可以读取文件流。我不确定是否有一种干净的方法可以将 C 文件流映射到 C++ istream；可能有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T00:56:59.673

您需要填写 STARTUP_INFO 结构，该结构具有 hStdInput、hStdOutput 和 hStdError。请记住在 CreateProcess 时继承句柄。

```
/* Assume you open a file handle or pipe called myoutput */
STARTUP_INFO si_startinfo;
ZeroMemory(&si_startinfo, sizeof(STARTUP_INFO));
si_startinfo.cb = sizeof(STARTUP_INFO);
si_startinfo.hStdInput = GetStdHandle(STD_INPUT_HANDLE);
si_startinfo.hStdOutput = myoutput;
si_startinfo.hStdError = myoutput;
si_startifno.dwFlags != STARTF_USEHANDLES;

PROCESS_INFORMATION pi_procinfo;
ZeroMemory(&pi_procinfo, sizeof(PROCESS_INFORMATION);

CreateProcess(NULL, cmdline, NULL, NULL, true, 0, NULL, pathname, &si_startinfo, &pi_procinfo); 
```

我没有展示你需要做的错误处理方面。第 5 个参数设置为 true 以继承句柄。其他人已经解释了如何创建管道，所以我不会在这里重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T01:00:21.417

Microsoft 的 CRT 和 MSDN 库确实包含 system 函数和 _popen 函数。

# c# - 如何在c#中解析文本文件

> ID：300671
> 
> 赞同：4
> 
> 时间：2008-11-19T00:37:17.547
> 
> 标签：c#, parsing, text-files

如何在 C# 中解析文本文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T00:51:45.583

Check this interesting approach, [Linq To Text Files](http://blogs.msdn.com/ericwhite/archive/2006/08/31/734383.aspx), very nice, you only need a `IEnumerable<string>` method, that yields every `file.ReadLine()`, and you do the query.

[Here](http://schotime.net/blog/index.php/2008/03/18/importing-data-files-with-linq) is another article that better explains the same technique.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-15T14:55:20.510

```
using (TextReader rdr = new StreamReader(fullFilePath))
{
  string line;

  while ((line = rdr.ReadLine()) != null)
  {
    // use line here
  }
} 
```

将变量“fullFilePath”设置为完整路径，例如。C:\temp\myTextFile.txt

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T00:42:43.870

该算法可能如下所示：

1.  打开文本文件
2.  对于文件中的每一行：
3.  解析线

解析一行有几种方法。

从初学者的角度来看，最简单的方法是使用 String 方法。

[MSDN 上的 System.String](http://msdn.microsoft.com/en-us/library/system.string_members%28VS.71%29.aspx)

如果您准备迎接更多挑战，那么您可以使用 System.Text.RegularExpression 库来解析您的文本。

[MSDN 上的正则表达式](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-23T18:17:53.550

您可能想要使用一个帮助器类，例如[http://www.blackbeltcoder.com/Articles/strings/a-text-parsing-helper-class](http://www.blackbeltcoder.com/Articles/strings/a-text-parsing-helper-class)中描述的那个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-23T17:35:00.607

从多年分析 CSV 文件（包括损坏或有边缘情况的文件）来看，这是我通过几乎所有单元测试的代码：

```
/// <summary>
/// Read in a line of text, and use the Add() function to add these items to the current CSV structure
/// </summary>
/// <param name="s"></param>
public static bool TryParseCSVLine(string s, char delimiter, char text_qualifier, out string[] array)
{
    bool success = true;
    List<string> list = new List<string>();
    StringBuilder work = new StringBuilder();
    for (int i = 0; i < s.Length; i++) {
        char c = s[i];

        // If we are starting a new field, is this field text qualified?
        if ((c == text_qualifier) && (work.Length == 0)) {
            int p2;
            while (true) {
                p2 = s.IndexOf(text_qualifier, i + 1);

                // for some reason, this text qualifier is broken
                if (p2 < 0) {
                    work.Append(s.Substring(i + 1));
                    i = s.Length;
                    success = false;
                    break;
                }

                // Append this qualified string
                work.Append(s.Substring(i + 1, p2 - i - 1));
                i = p2;

                // If this is a double quote, keep going!
                if (((p2 + 1) < s.Length) && (s[p2 + 1] == text_qualifier)) {
                    work.Append(text_qualifier);
                    i++;

                    // otherwise, this is a single qualifier, we're done
                } else {
                    break;
                }
            }

            // Does this start a new field?
        } else if (c == delimiter) {
            list.Add(work.ToString());
            work.Length = 0;

            // Test for special case: when the user has written a casual comma, space, and text qualifier, skip the space
            // Checks if the second parameter of the if statement will pass through successfully
            // e.g. "bob", "mary", "bill"
            if (i + 2 <= s.Length - 1) {
                if (s[i + 1].Equals(' ') && s[i + 2].Equals(text_qualifier)) {
                    i++;
                }
            }
        } else {
            work.Append(c);
        }
    }
    list.Add(work.ToString());

    // If we have nothing in the list, and it's possible that this might be a tab delimited list, try that before giving up
    if (list.Count == 1 && delimiter != DEFAULT_TAB_DELIMITER) {
        string[] tab_delimited_array = ParseLine(s, DEFAULT_TAB_DELIMITER, DEFAULT_QUALIFIER);
        if (tab_delimited_array.Length > list.Count) {
            array = tab_delimited_array;
            return success;
        }
    }

    // Return the array we parsed
    array = list.ToArray();
    return success;
} 
```

然而，这个函数实际上并没有解析所有有效的 CSV 文件！一些文件中嵌入了换行符，您需要启用流阅读器来同时解析多行以返回一个数组。这是一个可以做到这一点的工具：

```
/// <summary>
/// Parse a line whose values may include newline symbols or CR/LF
/// </summary>
/// <param name="sr"></param>
/// <returns></returns>
public static string[] ParseMultiLine(StreamReader sr, char delimiter, char text_qualifier)
{
    StringBuilder sb = new StringBuilder();
    string[] array = null;
    while (!sr.EndOfStream) {

        // Read in a line
        sb.Append(sr.ReadLine());

        // Does it parse?
        string s = sb.ToString();
        if (TryParseCSVLine(s, delimiter, text_qualifier, out array)) {
            return array;
        }
    }

    // Fails to parse - return the best array we were able to get
    return array;
} 
```

作为参考，我将我的[开源 CSV 代码放在 code.google.com 上](http://code.google.com/p/csharp-csv-reader/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T15:18:47.203

Pero 回答的一个小改进：

```
FileInfo txtFile = new FileInfo("c:\myfile.txt");
if(!txtFile.Exists) { // error handling }

using (TextReader rdr = txtFile.OpenText())
{
     // use the text file as Pero suggested
} 
```

FileInfo 类使您有机会在实际开始读取文件之前对文件进行“处理”。您还可以在函数之间传递它作为文件位置的更好抽象（而不是使用完整路径字符串）。FileInfo 将路径规范化，使其绝对正确（例如，在适当的情况下将 / 转换为 \），并允许您提取有关文件的额外数据——父目录、扩展名、仅名称、权限等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T00:38:41.677

如果您有不只是简单的语言，请使用解析器生成器。它让*我*发疯，但我听说过关于[ANTLR](http://www.antlr.org/)的好消息（注意：在开始之前获取手册并阅读它。如果您使用过解析器生成器以外的其他解析器生成器，那么您将无法立即正确处理它，至少我没有）

其他工具也存在。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T00:40:21.550

在不真正知道您正在使用哪种文本文件的情况下，很难回答。但是，[FileHelpers](http://filehelpers.sourceforge.net/)库有一套广泛的工具来帮助处理固定长度的文件格式、多记录、分隔等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T00:42:37.643

解析是什么意思？Parse 通常意味着将输入拆分为标记，如果您尝试实现编程语言，您可能会这样做。如果您只想读取文本文件的内容，请查看 System.IO.FileInfo。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-25T08:55:41.367

首先，请确保您具有以下命名空间：

```
using System.Data;
using System.IO;
using System.Text.RegularExpressions; 
```

接下来，我们构建一个函数，将任何 CSV 输入字符串解析为 DataTable：

```
public DataTable ParseCSV(string inputString) {

  DataTable dt=new DataTable();

  // declare the Regular Expression that will match versus the input string
  Regex re=new Regex("((?<field>[^\",\\r\\n]+)|\"(?<field>([^\"]|\"\")+)\")(,|(?<rowbreak>\\r\\n|\\n|$))");

  ArrayList colArray=new ArrayList();
  ArrayList rowArray=new ArrayList();

  int colCount=0;
  int maxColCount=0;
  string rowbreak="";
  string field="";

  MatchCollection mc=re.Matches(inputString);

  foreach(Match m in mc) {

    // retrieve the field and replace two double-quotes with a single double-quote
    field=m.Result("${field}").Replace("\"\"","\"");

    rowbreak=m.Result("${rowbreak}");

    if (field.Length > 0) {
      colArray.Add(field);                  
      colCount++;
    }

    if (rowbreak.Length > 0) {

      // add the column array to the row Array List
      rowArray.Add(colArray.ToArray());

      // create a new Array List to hold the field values
      colArray=new ArrayList(); 

      if (colCount > maxColCount)
        maxColCount=colCount;

      colCount=0;
    }
  }

  if (rowbreak.Length == 0) {
    // this is executed when the last line doesn't
    // end with a line break
    rowArray.Add(colArray.ToArray());
    if (colCount > maxColCount)
      maxColCount=colCount;
  }

  // create the columns for the table
  for(int i=0; i < maxColCount; i++)
  dt.Columns.Add(String.Format("col{0:000}",i));

  // convert the row Array List into an Array object for easier access
  Array ra=rowArray.ToArray();
  for(int i=0; i < ra.Length; i++) {                

    // create a new DataRow
    DataRow dr=dt.NewRow();

    // convert the column Array List into an Array object for easier access
    Array ca=(Array)(ra.GetValue(i));               

    // add each field into the new DataRow
    for(int j=0; j < ca.Length; j++)
      dr[j]=ca.GetValue(j);

    // add the new DataRow to the DataTable
    dt.Rows.Add(dr);
  }

  // in case no data was parsed, create a single column
  if (dt.Columns.Count == 0)
    dt.Columns.Add("NoData");

  return dt;
} 
```

现在我们有了一个用于将字符串转换为 DataTable 的解析器，我们现在只需要一个函数，该函数将从 CSV 文件中读取内容并将其传递给 ParseCSV 函数：

```
public DataTable ParseCSVFile(string path) {

  string inputString="";

  // check that the file exists before opening it
  if (File.Exists(path)) {

    StreamReader sr = new StreamReader(path);
    inputString = sr.ReadToEnd();
    sr.Close();

  }

  return ParseCSV(inputString);
} 
```

现在您可以轻松地使用来自 CSV 文件的数据填充 DataGrid：

```
protected System.Web.UI.WebControls.DataGrid DataGrid1;

private void Page_Load(object sender, System.EventArgs e) {

  // call the parser
  DataTable dt=ParseCSVFile(Server.MapPath("./demo.csv"));          

  // bind the resulting DataTable to a DataGrid Web Control
  DataGrid1.DataSource=dt;
  DataGrid1.DataBind();
} 
```

恭喜！您现在可以将 CSV 解析为 DataTable。祝你编程好运。

# iphone - 真的不应该在生产代码上使用 NSLog() 吗？

> ID：300673
> 
> 赞同：156
> 
> 时间：2008-11-19T00:37:28.967
> 
> 标签：iphone, objective-c, nslog

我在这个网站上被告知过几次，但我想确保情况确实如此。

我希望能够在我的代码中散布 NSLog 函数调用，并且 Xcode/gcc 会在构建我的发布/分发版本时自动删除这些调用。

我应该避免使用这个吗？如果是这样，有经验的 Objective-C 程序员之间最常见的选择是什么？

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2008-11-19T15:25:55.350

预处理器宏确实非常适合调试。NSLog() 没有任何问题，但是很容易定义自己的日志功能，并具有更好的功能。这是我使用的一个，它包括文件名和行号，以便更容易跟踪日志语句。

```
#define DEBUG_MODE

#ifdef DEBUG_MODE
    #define DebugLog( s, ... ) NSLog( @"<%p %@:(%d)> %@", self, [[NSString stringWithUTF8String:__FILE__] lastPathComponent], __LINE__, [NSString stringWithFormat:(s), ##__VA_ARGS__] )
#else
    #define DebugLog( s, ... ) 
#endif 
```

我发现将整个语句放在前缀标头而不是它自己的文件中更容易。如果你愿意，你可以通过让 DebugLog 与普通的 Objective-C 对象交互来构建一个更复杂的日志系统。例如，您可以有一个日志记录类，它写入自己的日志文件（或数据库），并包含一个您可以在运行时设置的“优先级”参数，因此调试消息不会显示在您的发布版本中，但错误消息是 (如果你这样做了，你可以制作 DebugLog()、WarningLog() 等等）。

哦，记住`#define DEBUG_MODE`可以在你的应用程序的不同地方重复使用。例如，在我的应用程序中，我使用它来禁用许可证密钥检查，并且只允许应用程序在某个日期之前运行。这让我能够以最小的努力分发一个时间有限的、功能齐全的 beta 副本。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-06-20T05:58:16.203

将这 3 行放在 -prefix.pch 文件的末尾：

```
#ifndef DEBUG
  #define NSLog(...) /* suppress NSLog when in release mode */
#endif 
```

您不需要在项目中定义任何内容，因为`DEBUG`在创建项目时默认在构建设置中定义。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-11-19T00:47:50.817

NSLog 调用可以留在生产代码中，但应该只用于真正的例外情况，或者需要记录到系统日志中的信息。

乱扔系统日志的应用程序很烦人，而且不专业。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-09-28T00:10:48.147

我无法对[Marc Charbonneau 的回答](https://stackoverflow.com/questions/300673/is-it-true-that-one-should-not-use-nslog-on-production-code/302246#302246)发表评论，所以我会将其发布为答案。

除了将宏添加到预编译的标头之外，您还可以使用 Target 构建配置来控制`DEBUG_MODE`.

如果您选择“**调试**”活动配置，`DEBUG_MODE`将被定义，并且宏扩展为完整`NSLog`定义。

选择“**发布**”活动配置将不会定义`DEBUG_MODE`，并且您的`NSLog`ging 将从发布构建中省略。

脚步：

*   目标 > 获取信息
*   构建选项卡
*   搜索“预处理器宏”（或**`GCC_PREPROCESSOR_DEFINITIONS`**）
*   选择配置：**调试**
*   在此级别编辑定义
*   添加**`DEBUG_MODE=1`**
*   选择配置：**发布**
*   *确认`DEBUG_MODE`未设置`GCC_PREPROCESSOR_DEFINITIONS`*

*如果你在定义中省略了'='字符，你会从预处理器中得到一个错误*

此外，在宏定义上方粘贴此注释（如下所示）以提醒您`DEBUG_MACRO`定义的来源；）

```
// Target > Get Info > Build > GCC_PREPROCESSOR_DEFINITIONS
// Configuration = Release: <empty>
//               = Debug:   DEBUG_MODE=1 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-19T01:50:49.690

**编辑：由**[Marc Charbonneau](https://stackoverflow.com/users/35136/marc-charbonneau)发布并由[sho](https://stackoverflow.com/users/59465/sho)引起我注意的方法[远比](https://stackoverflow.com/questions/300673/is-it-true-that-one-should-not-use-nslog-on-production-code/302246#302246)这个好。

我已经删除了我的答案部分，该部分建议在禁用调试模式时使用空函数来禁用日志记录。处理设置自动预处理器宏的部分仍然是相关的，所以它仍然存在。我还编辑了预处理器宏的名称，使其更适合 Marc Charbonneau 的回答。

* * *

要在 Xcode 中实现自动（和预期）行为：

在项目设置中，转到“构建”选项卡，然后选择“调试”配置。找到“预处理器宏”部分，并添加一个名为`DEBUG_MODE`.

...

**编辑：**有关使用宏启用和禁用日志记录的正确方法，请参阅[Marc Charbonneau 的答案。](https://stackoverflow.com/questions/300673/is-it-true-that-one-should-not-use-nslog-on-production-code/302246#302246)`DEBUG_MODE`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-19T05:07:15.287

我同意马修的观点。NSLog 在生产代码中没有任何问题。事实上，它对用户很有用。也就是说，如果您使用 NSLog 的唯一原因是帮助调试，那么，是的，应该在发布之前将其删除。

此外，由于您已将此标记为 iPhone 问题，因此 NSLog 会占用资源，而 iPhone 几乎没有这种资源。如果您在iPhone 上对*任何内容*进行 NSLogging ，这会占用您应用程序的处理器时间。明智地使用它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-19T04:19:38.083

简单的事实是 NSLog 很慢。

但为什么？为了回答这个问题，让我们找出 NSLog 是做什么的，然后是它是如何做到的。

NSLog 到底是做什么的？

NSLog 做了两件事：

它将日志消息写入 Apple 系统日志 (asl) 工具。这允许日志消息显示在 Console.app 中。它还检查应用程序的 stderr 流是否将发送到终端（例如当应用程序通过 Xcode 运行时）。如果是这样，它将日志消息写入 stderr（以便它显示在 Xcode 控制台中）。

写到 STDERR 听起来并不难。这可以通过 fprintf 和 stderr 文件描述符参考来完成。但是 asl 呢？

我发现的关于 ASL 的最佳文档是 Peter Hosey 的 10 部分博客文章：[链接](http://boredzo.org/blog/archives/2008-01-20/why-asl)

无需过多介绍，重点（因为它涉及性能）是这样的：

要将日志消息发送到 ASL 工具，您基本上打开一个到 ASL 守护程序的客户端连接并发送消息。但是 - 每个线程必须使用单独的客户端连接。因此，为了线程安全，每次调用 NSLog 时，它都会打开一个新的 asl 客户端连接，发送消息，然后关闭连接。

资源可以在[这里](https://github.com/robbiehanson/CocoaLumberjack/wiki/Performance#a-better-nslog)和[这里](http://boredzo.org/blog/archives/2008-01-20/why-asl)找到。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-09T11:20:02.047

如其他答案所述，您可以使用 #define 来更改在编译时是否使用 NSLog。

然而，更灵活的方法是使用像[Cocoa Lumberjack](http://deusty.blogspot.co.uk/2010/05/introducing-cocoa-lumberjack.html)这样的日志库，它允许您更改是否也在运行时记录某些内容。

在您的代码中，将 NSLog 替换为 DDLogVerbose 或 DDLogError 等，为宏定义等添加 #import 并设置记录器，通常在 applicationDidFinishLaunching 方法中。

为了达到与 NSLog 相同的效果，配置代码为

```
[DDLog addLogger:[DDASLLogger sharedInstance]];
[DDLog addLogger:[DDTTYLogger sharedInstance]]; 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-02-15T21:18:54.970

从安全的角度来看，这取决于记录的内容。如果`NSLog`（或其他记录器）正在写入敏感信息，那么您应该在生产代码中删除记录器。

从审计的角度来看，审计员不想查看每次使用`NSLog`以确保其不记录敏感信息。他/她只会告诉您删除记录器。

我与这两个小组一起工作。我们审核代码、编写编码指南等。我们的指南要求在生产代码中禁用日志记录。所以内部团队知道不要尝试；）

我们还将拒绝登录生产环境的外部应用程序，因为我们不想接受与意外泄露敏感信息相关的风险。我们不在乎开发商告诉我们什么。它根本不值得我们花时间去调查。

请记住，我们定义“敏感”，而不是开发人员；）

我还认为一个执行大量日志记录的应用程序是一个准备好崩溃的应用程序。执行/需要如此多的日志记录是有原因的，而且它通常不稳定。它就在那里，带有重新启动挂起服务的“看门狗”线程。

如果您从未通过安全架构 (SecArch) 审查，那么这些就是我们所关注的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-18T00:59:48.683

您不应该在发布代码中对 printf 或 NSLog 过于冗长。如果应用程序发生了不好的事情，请尝试仅执行 printf 或 NSLog，即无法恢复的错误。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-12-16T23:17:50.283

请记住，NSLogs 会减慢 UI / 主线程的速度。除非绝对必要，否则最好将它们从发布版本中删除。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-03T19:14:08.867

我强烈建议使用 TestFlight 进行日志记录（免费）。他们的方法将覆盖 NSLog（使用宏）并允许您为所有现有的 NSLog 调用打开/关闭到他们的服务器、Apple 系统日志和 STDERR 日志的日志记录。这样做的好处是，您仍然可以查看部署到测试人员的应用程序和部署在 App Store 中的应用程序的日志消息，而不会出现在用户的系统日志中。两全其美的。

# asp.net - 从 ASP.net 中运行的 Web 参考客户端获取 RAW Soap 数据

> ID：300674
> 
> 赞同：97
> 
> 时间：2008-11-19T00:38:25.640
> 
> 标签：asp.net, soap, proxy, asmx, web-reference

我正在尝试解决当前项目中的 Web 服务客户端问题。我不确定服务服务器的平台（很可能是 LAMP）。我相信他们这边有问题，因为我已经消除了我客户的潜在问题。客户端是从服务 WSDL 自动生成的标准 ASMX 类型 Web 引用代理。

我需要得到的是 RAW SOAP 消息（请求和响应）

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-01-09T14:29:09.583

我进行了以下更改`web.config`以获取 SOAP（请求/响应）信封。这会将所有原始 SOAP 信息输出到文件`trace.log`中。

```
<system.diagnostics>
  <trace autoflush="true"/>
  <sources>
    <source name="System.Net" maxdatasize="1024">
      <listeners>
        <add name="TraceFile"/>
      </listeners>
    </source>
    <source name="System.Net.Sockets" maxdatasize="1024">
      <listeners>
        <add name="TraceFile"/>
      </listeners>
    </source>
  </sources>
  <sharedListeners>
    <add name="TraceFile" type="System.Diagnostics.TextWriterTraceListener"
      initializeData="trace.log"/>
  </sharedListeners>
  <switches>
    <add name="System.Net" value="Verbose"/>
    <add name="System.Net.Sockets" value="Verbose"/>
  </switches>
</system.diagnostics> 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-11-19T02:12:38.103

您可以实现将完整请求和响应记录到日志文件的 SoapExtension。然后，您可以在 web.config 中启用 SoapExtension，这样可以轻松打开/关闭以进行调试。这是我找到并修改为我自己使用的示例，在我的情况下，日志记录是由 log4net 完成的，但您可以用自己的方法替换日志方法。

```
public class SoapLoggerExtension : SoapExtension
{
    private static readonly ILog log = LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);
    private Stream oldStream;
    private Stream newStream;

    public override object GetInitializer(LogicalMethodInfo methodInfo, SoapExtensionAttribute attribute)
    {
        return null;
    }

    public override object GetInitializer(Type serviceType)
    {
        return null;
    }

    public override void Initialize(object initializer)
    {

    }

    public override System.IO.Stream ChainStream(System.IO.Stream stream)
    {
        oldStream = stream;
        newStream = new MemoryStream();
        return newStream;
    }

    public override void ProcessMessage(SoapMessage message)
    {

        switch (message.Stage)
        {
            case SoapMessageStage.BeforeSerialize:
                break;
            case SoapMessageStage.AfterSerialize:
                Log(message, "AfterSerialize");
                    CopyStream(newStream, oldStream);
                    newStream.Position = 0;
                break;
                case SoapMessageStage.BeforeDeserialize:
                    CopyStream(oldStream, newStream);
                    Log(message, "BeforeDeserialize");
                break;
            case SoapMessageStage.AfterDeserialize:
                break;
        }
    }

    public void Log(SoapMessage message, string stage)
    {

        newStream.Position = 0;
        string contents = (message is SoapServerMessage) ? "SoapRequest " : "SoapResponse ";
        contents += stage + ";";

        StreamReader reader = new StreamReader(newStream);

        contents += reader.ReadToEnd();

        newStream.Position = 0;

        log.Debug(contents);
    }

    void ReturnStream()
    {
        CopyAndReverse(newStream, oldStream);
    }

    void ReceiveStream()
    {
        CopyAndReverse(newStream, oldStream);
    }

    public void ReverseIncomingStream()
    {
        ReverseStream(newStream);
    }

    public void ReverseOutgoingStream()
    {
        ReverseStream(newStream);
    }

    public void ReverseStream(Stream stream)
    {
        TextReader tr = new StreamReader(stream);
        string str = tr.ReadToEnd();
        char[] data = str.ToCharArray();
        Array.Reverse(data);
        string strReversed = new string(data);

        TextWriter tw = new StreamWriter(stream);
        stream.Position = 0;
        tw.Write(strReversed);
        tw.Flush();
    }
    void CopyAndReverse(Stream from, Stream to)
    {
        TextReader tr = new StreamReader(from);
        TextWriter tw = new StreamWriter(to);

        string str = tr.ReadToEnd();
        char[] data = str.ToCharArray();
        Array.Reverse(data);
        string strReversed = new string(data);
        tw.Write(strReversed);
        tw.Flush();
    }

    private void CopyStream(Stream fromStream, Stream toStream)
    {
        try
        {
            StreamReader sr = new StreamReader(fromStream);
            StreamWriter sw = new StreamWriter(toStream);
            sw.WriteLine(sr.ReadToEnd());
            sw.Flush();
        }
        catch (Exception ex)
        {
            string message = String.Format("CopyStream failed because: {0}", ex.Message);
            log.Error(message, ex);
        }
    }
}

[AttributeUsage(AttributeTargets.Method)]
public class SoapLoggerExtensionAttribute : SoapExtensionAttribute
{
    private int priority = 1; 

    public override int Priority
    {
        get { return priority; }
        set { priority = value; }
    }

    public override System.Type ExtensionType
    {
        get { return typeof (SoapLoggerExtension); }
    }
} 
```

然后将以下部分添加到 web.config 中，其中 YourNamespace 和 YourAssembly 指向 SoapExtension 的类和程序集：

```
<webServices>
  <soapExtensionTypes>
    <add type="YourNamespace.SoapLoggerExtension, YourAssembly" 
       priority="1" group="0" />
  </soapExtensionTypes>
</webServices> 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2015-01-22T22:37:54.580

不知道为什么对 web.config 或序列化程序类大惊小怪。下面的代码对我有用：

```
XmlSerializer xmlSerializer = new XmlSerializer(myEnvelope.GetType());

using (StringWriter textWriter = new StringWriter())
{
    xmlSerializer.Serialize(textWriter, myEnvelope);
    return textWriter.ToString();
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-11-19T01:54:19.653

试试[Fiddler2](http://www.fiddlertool.com/fiddler/)，它会让你检查请求和响应。值得注意的是，Fiddler 同时适用于 http 和 https 流量。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-04-09T18:41:48.517

如果对 Web 引用的调用引发异常，那么 Tim Carter 的解决方案似乎不起作用。我一直在尝试获取原始的网络响应，以便一旦抛出异常，我就可以在错误处理程序中检查它（在代码中）。但是，我发现当调用抛出异常时，Tim 的方法写入的响应日志是空白的。我不完全理解代码，但似乎 Tim 的方法在 .Net 已经失效并丢弃 Web 响应之后切入了该过程。

我正在与一个使用低级编码手动开发 Web 服务的客户端合作。此时，他们将自己的内部流程错误消息作为 HTML 格式的消息添加到响应中，然后是 SOAP 格式的响应。当然，automagic .Net 网络参考对此大加赞赏。如果在抛出异常后我可以获取原始 HTTP 响应，我可以在混合返回的 HTTP 响应中查找并解析任何 SOAP 响应，并知道它们是否正确接收了我的数据。

之后 ...

这是一个有效的解决方案，即使在执行之后（请注意，我只是在响应之后 - 也可以得到请求）：

```
namespace ChuckBevitt
{
    class GetRawResponseSoapExtension : SoapExtension
    {
        //must override these three methods
        public override object GetInitializer(LogicalMethodInfo methodInfo, SoapExtensionAttribute attribute)
        {
            return null;
        }
        public override object GetInitializer(Type serviceType)
        {
            return null;
        }
        public override void Initialize(object initializer)
        {
        }

        private bool IsResponse = false;

        public override void ProcessMessage(SoapMessage message)
        {
            //Note that ProcessMessage gets called AFTER ChainStream.
            //That's why I'm looking for AfterSerialize, rather than BeforeDeserialize
            if (message.Stage == SoapMessageStage.AfterSerialize)
                IsResponse = true;
            else
                IsResponse = false;
        }

        public override Stream ChainStream(Stream stream)
        {
            if (IsResponse)
            {
                StreamReader sr = new StreamReader(stream);
                string response = sr.ReadToEnd();
                sr.Close();
                sr.Dispose();

                File.WriteAllText(@"C:\test.txt", response);

                byte[] ResponseBytes = Encoding.ASCII.GetBytes(response);
                MemoryStream ms = new MemoryStream(ResponseBytes);
                return ms;

            }
            else
                return stream;
        }
    }
} 
```

这是您在配置文件中配置它的方式：

```
<configuration>
     ...
  <system.web>
    <webServices>
      <soapExtensionTypes>
        <add type="ChuckBevitt.GetRawResponseSoapExtension, TestCallWebService"
           priority="1" group="0" />
      </soapExtensionTypes>
    </webServices>
  </system.web>
</configuration> 
```

“TestCallWebService”应该替换为库的名称（恰好是我正在使用的测试控制台应用程序的名称）。

你真的不应该去ChainStream；您应该能够更简单地从 ProcessMessage 做到这一点：

```
public override void ProcessMessage(SoapMessage message)
{
    if (message.Stage == SoapMessageStage.BeforeDeserialize)
    {
        StreamReader sr = new StreamReader(message.Stream);
        File.WriteAllText(@"C:\test.txt", sr.ReadToEnd());
        message.Stream.Position = 0; //Will blow up 'cause type of stream ("ConnectStream") doesn't alow seek so can't reset position
    }
} 
```

如果您查找 SoapMessage.Stream，它应该是一个只读流，此时您可以使用它来检查数据。这是一个错误，因为如果您确实读取了流，后续处理炸弹没有发现数据错误（流在末尾）并且您无法将位置重置为开头。

有趣的是，如果您同时使用 ChainStream 和 ProcessMessage 两种方法，则 ProcessMessage 方法将起作用，因为您在 ChainStream 中将流类型从 ConnectStream 更改为 MemoryStream，并且 MemoryStream 确实允许查找操作。（我尝试将 ConnectStream 转换为 MemoryStream - 不允许。）

所以.....微软应该要么允许对 ChainStream 类型进行搜索操作，要么让 SoapMessage.Stream 真正成为它应该的只读副本。（写你的国会议员，等等......）

还有一点。在创建了一种在异常后检索原始 HTTP 响应的方法后，我仍然没有得到完整的响应（由 HTTP 嗅探器确定）。这是因为开发 Web 服务在响应开头添加 HTML 错误消息时，并没有调整 Content-Length 标头，因此 Content-Length 值小于实际响应正文的大小。我得到的只是 Content-Length 值的字符数 - 其余的都丢失了。显然，当 .Net 读取响应流时，它只读取 Content-Length 字符数并且不允许 Content-Length 值可能是错误的。这是应该的；但是如果 Content-Length 标头值错误，您获得整个响应正文的唯一方法是使用 HTTP 嗅探器（我使用 HTTP Analyzer from[http://www.ieinspector.com](http://www.ieinspector.com)）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-01-03T17:31:48.163

这是最佳答案的简化版本。将此添加到您的或文件的`<configuration>`元素中。它将在您的项目文件夹中创建一个文件。或者，您可以使用该属性指定日志文件的绝对路径。`web.config``App.config``trace.log``bin/Debug``initializeData`

```
 <system.diagnostics>
    <trace autoflush="true"/>
    <sources>
      <source name="System.Net" maxdatasize="9999" tracemode="protocolonly">
        <listeners>
          <add name="TraceFile" type="System.Diagnostics.TextWriterTraceListener" initializeData="trace.log"/>
        </listeners>
      </source>
    </sources>
    <switches>
      <add name="System.Net" value="Verbose"/>
    </switches>
  </system.diagnostics> 
```

它警告不允许使用`maxdatasize`and属性，但它们会增加可以记录的数据量，并避免以十六进制记录所有内容。`tracemode`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-09T17:33:28.883

我希望框架通过挂钩日志流来为您进行日志记录，该日志流记录为框架处理该底层流。以下内容不像我希望的那样干净，因为您无法在 ChainStream 方法中的请求和响应之间做出决定。以下是我的处理方式。感谢 Jon Hanna 提出了最重要的流创意

```
public class LoggerSoapExtension : SoapExtension
{
    private static readonly string LOG_DIRECTORY = ConfigurationManager.AppSettings["LOG_DIRECTORY"];
    private LogStream _logger;

    public override object GetInitializer(LogicalMethodInfo methodInfo, SoapExtensionAttribute attribute)
    {
        return null;
    }
    public override object GetInitializer(Type serviceType)
    {
        return null;
    }
    public override void Initialize(object initializer)
    {
    }
    public override System.IO.Stream ChainStream(System.IO.Stream stream)
    {
        _logger = new LogStream(stream);
        return _logger;
    }
    public override void ProcessMessage(SoapMessage message)
    {
        if (LOG_DIRECTORY != null)
        {
            switch (message.Stage)
            {
                case SoapMessageStage.BeforeSerialize:
                    _logger.Type = "request";
                    break;
                case SoapMessageStage.AfterSerialize:
                    break;
                case SoapMessageStage.BeforeDeserialize:
                    _logger.Type = "response";
                    break;
                case SoapMessageStage.AfterDeserialize:
                    break;
            }
        }
    }
    internal class LogStream : Stream
    {
        private Stream _source;
        private Stream _log;
        private bool _logSetup;
        private string _type;

        public LogStream(Stream source)
        {
            _source = source;
        }
        internal string Type
        {
            set { _type = value; }
        }
        private Stream Logger
        {
            get
            {
                if (!_logSetup)
                {
                    if (LOG_DIRECTORY != null)
                    {
                        try
                        {
                            DateTime now = DateTime.Now;
                            string folder = LOG_DIRECTORY + now.ToString("yyyyMMdd");
                            string subfolder = folder + "\\" + now.ToString("HH");
                            string client = System.Web.HttpContext.Current != null && System.Web.HttpContext.Current.Request != null && System.Web.HttpContext.Current.Request.UserHostAddress != null ? System.Web.HttpContext.Current.Request.UserHostAddress : string.Empty;
                            string ticks = now.ToString("yyyyMMdd'T'HHmmss.fffffff");
                            if (!Directory.Exists(folder))
                                Directory.CreateDirectory(folder);
                            if (!Directory.Exists(subfolder))
                                Directory.CreateDirectory(subfolder);
                            _log = new FileStream(new System.Text.StringBuilder(subfolder).Append('\\').Append(client).Append('_').Append(ticks).Append('_').Append(_type).Append(".xml").ToString(), FileMode.Create);
                        }
                        catch
                        {
                            _log = null;
                        }
                    }
                    _logSetup = true;
                }
                return _log;
            }
        }
        public override bool CanRead
        {
            get
            {
                return _source.CanRead;
            }
        }
        public override bool CanSeek
        {
            get
            {
                return _source.CanSeek;
            }
        }

        public override bool CanWrite
        {
            get
            {
                return _source.CanWrite;
            }
        }

        public override long Length
        {
            get
            {
                return _source.Length;
            }
        }

        public override long Position
        {
            get
            {
                return _source.Position;
            }
            set
            {
                _source.Position = value;
            }
        }

        public override void Flush()
        {
            _source.Flush();
            if (Logger != null)
                Logger.Flush();
        }

        public override long Seek(long offset, SeekOrigin origin)
        {
            return _source.Seek(offset, origin);
        }

        public override void SetLength(long value)
        {
            _source.SetLength(value);
        }

        public override int Read(byte[] buffer, int offset, int count)
        {
            count = _source.Read(buffer, offset, count);
            if (Logger != null)
                Logger.Write(buffer, offset, count);
            return count;
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            _source.Write(buffer, offset, count);
            if (Logger != null)
                Logger.Write(buffer, offset, count);
        }
        public override int ReadByte()
        {
            int ret = _source.ReadByte();
            if (ret != -1 && Logger != null)
                Logger.WriteByte((byte)ret);
            return ret;
        }
        public override void Close()
        {
            _source.Close();
            if (Logger != null)
                Logger.Close();
            base.Close();
        }
        public override int ReadTimeout
        {
            get { return _source.ReadTimeout; }
            set { _source.ReadTimeout = value; }
        }
        public override int WriteTimeout
        {
            get { return _source.WriteTimeout; }
            set { _source.WriteTimeout = value; }
        }
    }
}
[AttributeUsage(AttributeTargets.Method)]
public class LoggerSoapExtensionAttribute : SoapExtensionAttribute
{
    private int priority = 1;
    public override int Priority
    {
        get
        {
            return priority;
        }
        set
        {
            priority = value;
        }
    }
    public override System.Type ExtensionType
    {
        get
        {
            return typeof(LoggerSoapExtension);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T01:43:46.337

您尚未指定您使用的语言，但假设 C#/.NET 您可以使用[SOAP 扩展](http://msdn.microsoft.com/en-us/library/esw638yk(VS.71).aspx)。

否则，请使用嗅探器，例如[Wireshark](http://www.wireshark.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-10T13:43:18.747

这是在 c# 中获取原始消息的命令：

```
OperationContext.Current.RequestContext.RequestMessage 
```

我浪费了 3 天时间尝试使用肥皂扩展，这比我想象的要简单得多。不推荐使用肥皂扩展。我建议[在 MSDN 上阅读这些操作方法：检查或修改客户端上的消息。](https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client?redirectedfrom=MSDN)并[使用消息类](https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/using-the-message-class?redirectedfrom=MSDN)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2015-10-09T16:48:04.973

我意识到我参加聚会已经很晚了，因为实际上并没有指定语言，所以这里有一个基于 Bimmerbound 答案的 VB.NET 解决方案，以防有人碰巧遇到这个并需要解决方案。注意：如果您还没有，您需要在项目中引用 stringbuilder 类。

```
 Shared Function returnSerializedXML(ByVal obj As Object) As String
    Dim xmlSerializer As New System.Xml.Serialization.XmlSerializer(obj.GetType())
    Dim xmlSb As New StringBuilder
    Using textWriter As New IO.StringWriter(xmlSb)
        xmlSerializer.Serialize(textWriter, obj)
    End Using

    returnSerializedXML = xmlSb.ToString().Replace(vbCrLf, "")

End Function 
```

只需调用该函数，它就会返回一个字符串，其中包含您尝试传递给 Web 服务的对象的序列化 xml（实际上，这也适用于您想扔给它的任何对象）。

作为旁注，在返回 xml 之前函数中的替换调用是从输出中去除 vbCrLf 字符。我的在生成的 xml 中有一堆，但是这显然会根据您尝试序列化的内容而有所不同，我认为它们可能会在对象被发送到 Web 服务期间被剥离。

# windows - 通用makefile？

> ID：300679
> 
> 赞同：0
> 
> 时间：2008-11-19T00:41:01.830
> 
> 标签：windows, makefile

是否有一个通用的 makefile 我可以用来构建一个简单的 C++ 项目？在窗户上？我将工作的wii makefile 修改为win32，但无法正确构建（make 的差异？make 应用程序和makefile 似乎已找到）。我做了一些小技巧，并制作了一份 mingw32-make 的副本。

-edit- export PATH 似乎是我现在使用我的新makefile（单个文件而不是2）得到我的旧错误（make：make Command not found）的原因

> "make" make[1]: `/c/nightly/test/test.exe' 没有什么可做的。

这是我当前的 makefile [http://pastie.org/318548](http://pastie.org/318548)

我正在使用mingw。我从该站点安装了另一个带有代码块的安装。'make' 二进制文件是一个复制的 mingw32-make.exe，我在其中切掉了前缀。做 make -hi get "This program built for i686-pc-msys" 所以看起来是正确的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T00:45:21.697

Your make file looks fine, for the most part.

Check to see that gcc and g++ are installed correctly.

Also the Clean target uses: rm -rf

rm is the unix (linux et al) command for remove. In order to get rm on windows, I recommend using Cygwin.

Which C++ compiler are you using?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T00:57:55.680

As indicated in the error message, the problem does not come from your Makefile.

"make" itself couldn't be found in your path.

# web-services - Generating documentation for a RESTful Web Service from Python

> ID：300685
> 
> 赞同：4
> 
> 时间：2008-11-19T00:43:43.307
> 
> 标签：web-services, rest, documentation

I would like to generate documentation for a RESTful web service API that is written in Python. Ideally it would look like Yahoo's RESTful web service docs. Does anyone have any ideas or references?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-18T17:16:20.183

Sphinx 项目 ( [www.sphinx-doc.org](https://www.sphinx-doc.org) ) 是 Python 文档中当前最先进的。它真的很强大和灵活......所以也有点令人困惑。不过，我认为这是你最好的选择。

在他们的网站上有关于如何设置文档源文件以及将它们构建到完成的文档（如 HTML）的过程的优秀文档。您应该感兴趣的部分是它从 Python 源代码合并文档字符串的系统，我假设您一直在为服务于 REST 请求的方法做这件事。请注意，这不会神奇地解释正在发生的事情，但会带来所有命名元素及其参数（如果合适），并为您提供一个很好的框架来放入适当的文档。

假设您在一个名为的模块中拥有所有 REST 功能，`restapi.py`并且它只是在您`src`的项目目录中，您需要做两件事来让 Sphinx 自动生成文档：

首先，包含 autodoc 扩展并将`src`目录添加到 Sphinx 的路径中`conf.py`：

```
import sys, os
sys.path.append(os.path.abspath('sphinxext'))
extensions = ['sphinx.ext.autodoc']

sys.path.append(os.path.abspath('src')) 
```

然后在狮身人面像

```
.. automodule:: restapi
    :members: 
```

注意：此信息直接取自 Sphinx“第一步”文档，重新排序最少。如果看起来可以满足您的需求，请查看该文档和站点的其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T14:24:35.313

听起来您不是在制作 REST API，而只是在制作 RPC。通常没有简单、自动化的方法来组装 REST API，它应该主要是对您的媒体类型的描述。

如果您的意思是您希望将服务中的所有 URI 组合在一起并将它们放入 API 文档中，那么这根本不是 REST，因为从 URI 到资源的所有耦合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:16:19.767

不幸的是，我不知道任何具体可以帮助您在 Python 中的具体内容——但是，作为参考点，您可能会在 JAX-RS java 规范正在使用的 WADL 规范上达到顶峰[——https://wadl。 dev.java.net/](https://wadl.dev.java.net/) -- 此外，还有一个 xslt 可以将 wadl 转换为 html -- [http://www.mnot.net/webdesc/](http://www.mnot.net/webdesc/)

他们使用 yahoo REST API 作为示例。

# view - How to convert Perforce depot locations to client view locations

> ID：300692
> 
> 赞同：9
> 
> 时间：2008-11-19T00:47:21.707
> 
> 标签：view, mapping, client, perforce

I'd like to know how to convert Perforce depot locations to client view locations for the purpose of script writing.

I have a script that first checks out a file for edit in perforce and then interacts with the file. I need to have the depot location (i.e. \Projects\Project6) converted to the client view location. (i.e. d:\Projects\Project6).

Is this possible?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-19T01:41:47.370

我一直为此使用**p4 where**命令。以下是内置帮助中的描述：

> ```
> where -- Show how file names map through the client view
> 
> p4 where [ file ... ]
> 
>     Where shows how the named files map through the client view.
>     For each argument, three names are produced: the name in the
>     depot, the name on the client in Perforce syntax, and the name
>     on the client in local syntax.
> 
>     If no file is given, the mapping for '...' (all files in the
>     current directory and below) is shown.
> 
>     Note that 'p4 where' does not determine where any real files are.
>     It only computes where they should be according to the client view. 
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T01:34:28.290

我会使用**p4 fstat**命令。我发现它的格式比**p4**更容易解析。此外，如果您在 python 中编写脚本，您可以使用[-G 选项](http://kb.perforce.com/ToolsScripts/UsingP4G)将返回值编组为 python 字典。

还需要注意的是，您可以键入**p4 help 命令**来查看命令列表和它们的作用的简短描述。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T00:49:48.847

Check out the `p4 have` command. You give it *either* a depot location *or* a client filename and it gives you the depot location, client filename, *and* what version of that file you have.

# mysql - 在mysql的存储函数中的SELECT语句中使用变量作为OFFSET

> ID：300697
> 
> 赞同：9
> 
> 时间：2008-11-19T00:48:12.097
> 
> 标签：mysql, stored-functions

我对为 mySQL 数据库编写存储函数的主题很陌生，因此我不确定我在这里尝试做的事情是否可行。

我需要一个函数，它将从表中的随机行返回一列。我不想使用 ORDER BY RAND() 方法来做到这一点，而是我会这样做：

```
DECLARE MAX_COUNT INT DEFAULT 120000;
DECLARE rand_offset INT;
DECLARE str_rnd_word VARCHAR(255);
SET rand_offset = FLOOR((RAND() * MAX_COUNT));

SELECT word INTO str_rnd_word FROM all_words LIMIT 1 OFFSET rand_offset ;

RETURN str_rnd_word; 
```

MySQL 在使用这样的主体创建函数时抛出错误。但是当我使用硬编码数字作为偏移量时，它工作得很好。

有人可以对这个主题有所了解吗？

我在 Windows 盒子上运行 MySQL 5.0.45。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T01:05:51.343

在 MySQL 5.5 之前的版本中，不能将变量放入`LIMIT`MySQL 存储过程的子句中。您必须将其插入字符串，然后将该字符串作为动态查询执行。

```
SET rand_offset = FLOOR(RAND() * (SELECT COUNT(*) FROM all_words));
SET @sql = CONCAT('SELECT word INTO str_rnd_word FROM all_words LIMIT 1 OFFSET ', rand_offset);
PREPARE stmt1 FROM @sql;
EXECUTE stmt1; 
```

# dependencies - What release management solutions are worth investigating?

> ID：300703
> 
> 赞同：3
> 
> 时间：2008-11-19T00:50:28.907
> 
> 标签：dependencies, enterprise, release-management

In organisations where you have large numbers of applications, written in a *myriad* of languages running on *innumerable* platforms and databases how do folks manage the release of builds and patches, particularly when some of the releases are 3rd party? I know there a whole bunch of "Release Management" applications out there, but I'd be interested to know what experiences people have had.

To clarify, this isn't a question on configuration management, although that might be a small part of it. I'm more interested in managing software releases and the interdependencies and prerequisites that stem from that.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-04T20:54:55.163

我有一个类似的问题。我只见过这个问题的本土解决方案（本质上是一个由 unix 脚本组成的命令行程序）。

在我的调查中，到目前为止，我看到的唯一专门针对该问题的软件包是 incanica 的[tableaux](http://www.incanica.com/tableaux.html)（（无从属关系）。他们的文献专门讨论了软件组件以及与版本控制和变更管理系统的集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-08T05:32:19.547

我是 Incanica 的所有者，是上面 Mike 提到的 Tableaux 软件的开发者。

你绝对不是一个人遇到这个问题。通常的管理解决方案是投入人力，大多数人现在已经发现这并不能很好地扩展，而且往往成本很高。

另一种解决方案是允许开发人员完全访问所有环境，包括生产环境。您在此处发布问题的事实意味着您认识到可能随之而来的伤害世界。

这几乎就是我们开发 Tableaux 软件的原因。它旨在将包含多个组件的软件发布到多个平台。它位于您现有工具之上，提供发布管理框架，让您可以控制从开发到生产的完整发布。在许多其他功能中，它还提供了一些围绕发布的工作流程，以控制谁可以部署以及谁可以批准发布到各种环境中。

如果您想了解更多信息，请访问我们的网站：www.incanica.com/tableaux.html 或发送电子邮件至“info at (nospam) incanica.com”

为商业发布向所有人道歉。

达米安·莱德勒

印加尼卡私人有限公司

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-21T09:28:49.687

您可以使用[NDepend](http://www.NDepend.com)来准确了解和控制您从层库中使用的内容。我写了一篇关于这个[控制库的使用的文章](http://codebetter.com/blogs/patricksmacchia/archive/2008/10/20/controlling-the-usage-of-libraries.aspx)

# ruby-on-rails - ruby 方法名称中的变量

> ID：300705
> 
> 赞同：46
> 
> 时间：2008-11-19T00:52:50.043
> 
> 标签：ruby-on-rails, ruby

我有以下代码：

```
for attribute in site.device_attributes
  device.attribute
end 
```

我希望代码用“属性”的值替换方法名称。

我已经尝试过`device."#{attribute}"`各种排列。

这完全不可能吗？我错过了什么吗？

我已经考虑过覆盖method_missing，但是当我的问题是我需要调用“未知”方法时，我无法弄清楚这对我有什么帮助。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-11-19T13:14:05.473

您可以使用#send 方法通过方法名称调用对象的方法：

```
object.send(:foo) # same as object.foo 
```

您可以将参数传递给调用的方法：

```
object.send(:foo, 1, "bar", 1.23) # same as object.foo(1, "bar", 1.23) 
```

因此，如果您在变量“attribute”中有属性名称，您可以读取对象的属性

```
object.send(attribute.to_sym) 
```

并用

```
object.send("#{attribute}=".to_sym, value) 
```

在 Ruby 1.8.6 中，#send 方法可以执行任何对象的方法，而不管其可见性如何（例如，您可以调用私有方法）。这可能会在 Ruby 的未来版本中发生变化，您不应依赖它。要执行私有方法，请使用#instance_eval：

```
object.instance_eval {
  # code as block, can reference variables in current scope
}

# or

object.instance_eval <<-CODE
  # code as string, can generate any code text
CODE 
```

## 更新

您可以使用`public_send`to 调用有关可见性规则的方法。

```
object.public_send :public_foo # ok
object.public_send :private_bar # exception 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-19T01:01:49.027

“发送”方法应该做你正在寻找的东西：

```
object = "upcase me!"
method = "upcase"
object.send(method.to_sym) # => "UPCASE ME!" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-23T18:00:34.727

Matt 和 Maxim 都是正确的，但遗漏了一个细节，可以帮助您理解 #send 语法： *在 Ruby 中，调用方法实际上就是发送消息。* Softies on Rails 对此有一个[相对简单的解释](http://www.softiesonrails.com/posts/2007-8-15-ruby-101-methods-and-messages.html "Ruby 中的消息")。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T02:03:03.053

你也可以

```
device.instance_eval(attribute) 
```

# asp.net - Codebehind and inline on same page in ASP.NET?

> ID：300712
> 
> 赞同：1
> 
> 时间：2008-11-19T00:56:59.817
> 
> 标签：asp.net, inline, code-behind

In ASP.NET, is it possible to use both code behind and inline on the same page? I want to add some inline code that's related to the UI of the page, the reason to make it inline is to make it easy to modify as it outputs some HTML which is why I don't want to add it in the code behind, is this possible in ASP.NET?

Edit: I'm sorry, obviously my question wasn't very clear, what I meant is using a script block with runat="server", this is what I meant by inline code.

Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T01:06:40.280

Yes, you can use inline code just like in classic asp. You can use 'this' or 'me' to get to the code behind fields, methods, etc.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T02:30:42.607

是的，这会起作用，确保类后面的代码被声明为部分类，无论如何这都是默认的。不要认为它适用于 1 或 1.1

# java - JWebUnit / HttpUnit 的替代品

> ID：300715
> 
> 赞同：3
> 
> 时间：2008-11-19T00:57:12.203
> 
> 标签：java, testing, continuous-integration, web-testing

我们过去曾使用过 JWebUnit 和 HttpUnit 来对 Web 应用程序进行功能测试。他们俩似乎在处理 javascript 方面都有问题。在这一点上，我们对测试 javascript 并不特别感兴趣，但是 JWebUnit 和 HttpUnit 测试已经中断，因为我们在页面中添加了一些小的 Ajax 组件（例如 Dojo 日期/时间选择器）。

Selenium 和 Watir 不适合，因为它们本质上驱动浏览器，我们在不允许安装浏览器的机器上从 CruiseControl 运行这些测试。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T05:40:04.987

[Canoo 的 WebTest](http://webtest.canoo.com/webtest/manual/Downloads.html)非常好，可以处理您正在寻找的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T05:53:49.700

你想要[HtmlUnit](http://htmlunit.sourceforge.net/)。

它不是完美的浏览器仿真（因为您需要浏览器驱动程序），但它具有重要的 javascript 支持。查看[测试 JavaScript 的介绍](http://htmlunit.sourceforge.net/javascript-howto.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T05:57:51.220

和佳能一起去吧。Canoon 是基于 HtmlUnit 构建的，之前是基于 HttpUnit 构建的。

yc

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T10:07:34.807

> [Celerity](http://celerity.rubyforge.org/)是一个 JRuby 库，用于轻松快速地自动化 Web 应用程序测试。它是 HtmlUnit Java 库的包装器，旨在提供与 Watir 相同的 API 和功能。

# c# - ADAM 身份验证 - 如何？

> ID：300716
> 
> 赞同：1
> 
> 时间：2008-11-19T00:57:22.903
> 
> 标签：c#, authentication, active-directory, adam

我正在尝试使用我在 ADAM 中创建的用户对用户进行身份验证。但是，无论使用什么密码（正确或不正确），我的搜索都会返回一个有效的 DirectoryEntry 对象。我假设如果密码无效，那么搜索将返回一个空对象。我的假设是错误的还是下面的代码有缺陷？

```
DirectoryEntry de = new DirectoryEntry("LDAP://localhost:389/cn=Groups,cn=XXX,cn=YYY,dc=ZZZ");
DirectorySearcher deSearch = new DirectorySearcher();
deSearch.SearchRoot = de;
deSearch.Filter = "(&(objectClass=user) (cn=" + userId + "))";
SearchResultCollection results = deSearch.FindAll();
if (results.Count > 0)
{
    DirectoryEntry d = new DirectoryEntry(results[0].Path, userId, password);
        if (d != null)
        DoSomething();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T01:06:39.203

您需要访问 DirectoryEntry 的属性以确定它是否有效。我通常检查 Guid 是否为空。

```
bool valid = false;
using (DirectoryEntry entry = new DirectoryEntry( results[0].Path, userId, password ))
{
     try
     {
         if (entry.Guid != null)
         {
            valid = true;
         }
     }
     catch (NullReferenceException) {}
} 
```

注意：您还需要将搜索根目录条目和搜索器包装在`using`语句中，或者在完成后显式处理它们，以免资源处于使用状态。

PS我不确定当您尝试访问无效的目录条目属性时会引发哪个异常。一些实验可能是为了找出要捕获的异常。您不希望捕获所有异常，因为您可能希望以不同于身份验证失败的方式处理其他问题（例如，目录服务器不可用）。

# sql - embedded sql in C

> ID：300746
> 
> 赞同：2
> 
> 时间：2008-11-19T01:20:23.980
> 
> 标签：sql, c, db2, embedded-sql

I've been attempting to write embedded SQL statements for DB2 that ultimately gets compiled in C.

I couldn't find a tutorial or manual on the embedded SQL syntax for C for reference. One case I would like to do is to insert data into a table. I know most embedded sql statements need the initalizer `EXEC SQL`, but that's the extent of my knowledge generally. I'm doing this for an assignment and would appreciate if there are more information regarding this or solution.

Example of a statement to query the database:

```
EXEC SQL SELECT SNAME, AGE into :sname, :sage
    FROM ONE.SAILOR
    WHERE sid = :sid; 
```

I like to see what statement allows me to INSERT into the database. I've tried something like the following, but it doesn't work.

```
 EXEC SQL INSERT .... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T01:25:13.223

请参阅 IBM 的[嵌入式 SQL](http://publib.boulder.ibm.com/infocenter/db2luw/v9/index.jsp?topic=/com.ibm.db2.udb.apdv.embed.doc/doc/t0007158.htm)手册。

无论宿主语言是什么，嵌入式 SQL 基本相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T05:36:52.560

这四个点在语法上无效:-D

可靠的方法与任何其他 INSERT 语句相同：列出列和值。

```
EXEC SQL INSERT INTO SomeTable(Col1, Col2, Col3) VALUES(:hv1, :hv2, :hv3); 
```

在这里，:hv1、:hv2 和:hv3 代表与表中的列相应的类型的三个主变量。请注意，该表可以包含除这三个之外的其他列，只要这些列具有指定的默认值或接受 NULL（在这种情况下实际上只是默认值）。不可靠的方式不列出列：

```
EXEC SQL INSERT INTO SomeTable VALUES(:hv1, :hv2, :hv3); 
```

现在您依赖于获得正确的序列，并且您必须为每一列提供一个值——SomeTable 中不能有额外的列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T03:45:44.640

我刚开始使用[sqllite](http://www.sqlite.org)。除了 C++ 的良好[文档](http://www.sqlite.org/c3ref/intro.html)之外，拥有 SQLlist 可能是一件好事，因为您可以在不依赖 DB2 的情况下对代码进行单元测试，并且很容易添加到您的代码中。

# video - Protect flash video from download/right protect

> ID：300749
> 
> 赞同：17
> 
> 时间：2008-11-19T01:23:50.260
> 
> 标签：video, streaming, drm, copy-protection

Is it possible to protect flv files from download? I'd like to protect my files from download but I don't have the money for a streaming server which I think provides some sort of protection. The files are streamed via PHP and are located in an upload folder on my server.

I've used PHP to ensure that only subscribers can view the video but I basically want to go a step further and prevent subscribers from, upon login, downloading my videos with downloaders such as Sothink Flv Downloader for Firefox.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-10-30T15:54:30.340

我完全同意其他答案的 DRM 共识。但是想补充...

有几种***[混淆](http://en.wikipedia.org/wiki/Obfuscation)***技术可以满足您的需求。 正如他们所说，*“足够好” 。*这些不是完整的证明机制，但很可能会阻止 80%-99% 的人尝试复制您的`FLV`流/文件。一个专门的黑客会得到它，但大多数人只是脚本小子（或他们喜欢 FireFox 插件的表亲）。另外，其中一些技术非常简单：

*   **更改/删除**服务器响应的 MIME 类型。无论如何，Flash 播放器都乐于忽略它。例如：图像/JPEG
*   **将文件扩展名**从 .flv 更改为其他内容，例如 .jpg。同样，Flash 播放器无论如何都乐于忽略它。此外，一旦文件保存到磁盘，非 FLV 播放器将打开它（并抱怨它是无效的文件格式。）
*   **为所有`FLV`内容**设置激进的“不缓存”标题。**（这自然意味着消耗更多的流量和带宽。也许这对您来说不是问题？）**
***   **通过基于 UDP 的协议**（如 RTSP）流式传输。虽然我的阅读是 UDP 协议即将用于大规模点播内容流，但复制起来要困难得多。例如：Real Downloader 目前无法窃取这些流。*   **将内容分解为两个或多个**部分内容，并背靠背播放。*   **将您的 FLV 内容隐藏在一种简单的自定义一次性身份验证机制后面**
    *   播放器请求内容 A 的授权密钥
    *   服务器返回一个*授权*密钥：*SHA1*（内容密钥+ *salt1*）
    *   服务器存储内容密钥、*授权*1密钥、*授权*2密钥（即*SHA1*（*授权*1 + *salt2*））
        *   一次性使用
        *   有限的有效性（例如：2 秒）
    *   玩家创建*授权2*
    *   播放器请求内容 a 具有*授权 2*
    *   服务器向客户端发送“FLV”内容当且仅当
        *   授权密钥与服务器端存储中的内容密钥匹配
        *   授权密钥未过期**

 **我实际上已经实现了最后一个想法，授权机制，我自己可以保证它的实际有效性。不，它并不完全安全。但这已经足够了。即使是高级用户也无法击败它。

打败它需要

1.  对过程进行逆向工程，
2.  反编译您的 Flash 播放器，
3.  将它们重新组合在一起。

# 够好了。

* * *

令人惊讶的是，这篇文章从*“简单、自定义的一次性身份验证机制”*建议中生成了多少*“请向我发送代码”电子邮件。*不要打扰，我不能——这是我的雇主[xtendx AG](http://xtendx.com)的专有项目。如果有兴趣购买该系统，请发送电子邮件至 sales@xtendx.com。

 ** * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-19T02:38:38.753

无法为静态 FLV 文件添加 DRM 保护（即加密） - 任何知道 URL 的人都可以简单地下载它们，或者（在某些情况下）将它们从浏览器的缓存中取出，然后在任何支持的播放器中播放。（但是，您可能会阻止人们将您的内容嵌入其他网站 - 谷歌“ [Hotlinking protection](http://www.google.com/search?hl=en&q=hotlinking+protection) ”。）

[使用Red 5](http://osflash.org/red5)之类的 OSS 可以免费流式传输您的 FLV 。这本身不提供“DRM”保护，但它确实以文件流的形式发送视频，因此没有供用户下载和保存的单个文件。用户仍然可以使用某些程序来捕获文件，但它更不方便。

至于“真正的” DRM，我知道的唯一解决方案是[Adob​​e Flash Media Rights Management Server](http://www.adobe.com/products/flashmediarightsmanagement/)。我从未使用过它，但显然它会流式传输 DRM 加密的 FLV 或 MP3 内容，并使您能够应用通常的 DRM 限制。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-19T02:06:48.253

你不能。您花在追求 DRM 上的任何努力或金钱都将浪费您本可以用于改进产品的资源。将您的徽标和 URL 放入视频中，以便任何复制它们的人都在为您的网站做广告，在视频中放入版权声明并起诉任何您发现非法复制您的内容的人，然后收工。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T01:28:05.087

简短的版本是 DRM（任何形式）是一场军备竞赛，如果我能玩它，我就能偷它。唯一的问题是它有多难。

就个人而言，我不认为 DRM 是一个好主意。从长远来看，这无济于事，因为窃取它的人，无论您做什么都会窃取它，即使如此，那些不这样做的人也会因此而感到不便。

[http://xkcd.com/488/](http://xkcd.com/488/)

* * *

也就是说，窃取它也不是一个好主意，你应该有权控制你生产的东西。（但是我不知道该怎么做）

* * *

我能想到的唯一答案是：1）开始销售不能被盗的东西或1）让购买变得更容易然后被盗。第一个相当于 Pandora 付费/Netflix 音乐（但类似于主要唱片公司歌曲的 CC 许可证）。第二个甚至不是音乐行业的问题，而是金融行业的问题；如何使双方的在线支付变得轻松和安全，而又不至于搞砸买卖双方。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-30T11:06:17.147

您是否考虑过在 Amazon S3 上托管您的视频？您可以将视频的网址设置为过期，以便视频链接仅在特定时间段内有效。这不会阻止任何人在下载视频后从缓存中获取视频，也不会阻止使用 Orbit 下载器或 RealPlayer 视频下载器等其他方式，但它会阻止盗链。

我同意这样的评论，即这是一场军备竞赛和一种视频交付策略，它接受人们确实想要下载视频以共享或复制到其他设备等，并尝试与之共存可能是最成功和最轻松的。水印，嵌入到您网站的链接，尝试利用由于可下载而导致观看您的视频的眼球数量的增加。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-12T00:38:41.890

像 youtube 这样的网站试图通过混淆 flash 并经常更改结构来使下载视频变得困难。正如其他人所说，这是一场军备竞赛。Youtube 更新了它们的结构，然后像[pytube](http://code.google.com/p/pytube/)这样的工具也必须更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-26T20:36:37.297

为您的内容创建一个单独的站点。为第二个站点（“内容服务器”）配置 Web 服务器应用程序设置以拦截对任何静态内容（您的视频、图片等）的请求，以便您可以检查每个请求的内容的权限 cookie，以检查它们是否已经验证并授予对该内容的访问权限。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-29T15:22:01.640

看看[Longtail 的这个分析](http://www.longtailvideo.com/support/jw-player/48/securing-content-protect-your-video)。

它始于一条黄金法则：

> 任何可以观看您视频的人都可以窃取您的视频。

它最终会带来一系列非常好的安全问题和预防技术。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-05-28T11:12:20.177

没有任何保护可以击败 WireShark + NetMiner 的简单使用。

时期。

哦，顺便说一下，关于 youtube，如果您使用 Chrome，请查看此扩展程序：

[http://hosting.gmodules.com/ig/gadgets/file/113621719436589749332/ZiTube.crx](http://hosting.gmodules.com/ig/gadgets/file/113621719436589749332/ZiTube.crx)

它只是在 youtube 视频下创建一个下载按钮；）

# mercurial - 如何配置 tortoisehg 以在 Web 服务器页面中查看“图表”链接？

> ID：300754
> 
> 赞同：0
> 
> 时间：2008-11-19T01:27:00.800
> 
> 标签：mercurial, webserver, dvcs, tortoisehg

在 mercurial repo 中我可以看到它。我认为 mercurial 已经在修订图上有了这个功能。

我如何配置 tortoisehg 来实现这一目标？

我想为 hgweb提供类似[的东西。](http://selenic.com/repo/index.cgi/hg-stable/graph/b965605dfb2e)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:20:37.543

Tortisehg 没有内置的图形查看器，但如果安装了“hg view”或“hgk”并且您在 Mercurial.ini 文件中配置了 tortoisehg.view，它将调用它们。

来自[http://tortoisehg.wiki.sourceforge.net/FAQ](http://tortoisehg.wiki.sourceforge.net/FAQ)：

问：如何将 hgk（hg 视图）添加回 TortoiseHg-0.3？

A: 下载 tclkit 并将它放在你的 TortoiseHg 目录中。从 Mercurial 存储库下载 hgk 脚本并将其放在您的 TortoiseHg\contrib 目录中。创建一个 hgk.cmd 文件并将其放在 TortoiseHg\scripts 中。该文件应包含：

```
@set HG=C:\Program Files\TortoiseHg\hg.exe
@"C:\Program Files\TortoiseHg\tclkit-win32.exe" "C:\Program Files\TortoiseHg\contrib\hgk" %* 
```

然后在 Mercurial.ini 文件中启用 hgk：

```
[extensions]
hgext.hgk =

[hgk]
path=C:\Program Files\TortoiseHg\scripts\hgk.cmd
vdiff=vdiff 
```

然后告诉 TortoiseHg 使用 hgk 作为 Mercurial.ini 文件中的外部日志查看器。这将启用上下文菜单中的“修订图”条目并使其启动 hgk。'View Changelog' 菜单条目仍然会启动 TortoiseHg 的 changelog 查看器。

```
[tortoisehg]
view = hgk 
```

# c# - 如何有条件地更改数据绑定 WPF ListView 的 CellTemplate 中控件的属性？

> ID：300755
> 
> 赞同：2
> 
> 时间：2008-11-19T01:27:37.443
> 
> 标签：c#, wpf, xaml

好的...我是 WPF 的新手，但我知道如何使用 DataTriggers 和 Converters 来做事。

但是，我想要的似乎比这更复杂一些。让我给你详细信息：

ListView 控件的 DataContext 是一个 IList 对象 (object=Room)。这些是可用的房间。我有另一个控件（假设它是一个 TextBox），它绑定到 IList 中包含的 Room 对象之一。我只想为绑定到另一个控件的房间（ListViewItem）显示图像。

这是我的一些 XAML：

```
<TextBox Name="Room" />
<ListView Name="RoomsList" SelectionMode="Single">
    <ListView.View>
        <GridView>
            <GridViewColumn Width="32">
                <GridViewColumn.CellTemplate>
                    <DataTemplate>
                        <!-- 
                           Here's where I want to change the Source property
                           depending on whether or not the item matches the
                           TextBox DataContext.
                        -->
                        <Image Source="Images/Check.png" />
                    </DataTemplate>
                </GridViewColumn.CellTemplate>
            </GridViewColumn>
            <GridViewColumn Header="Room Name" Width="150" HeaderContainerStyle="{StaticResource textHeaderStyle}" 
                DisplayMemberBinding="{Binding Path=RoomName}" />
        </GridView>
    </ListView.View>
</ListView> 
```

我有点坚持这个。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T01:57:55.120

您可以编写一个 MultiValueConverter，它返回 Visibility，并将 DataContext 作为第一个转换器值，将特定的“房间”对象作为第二个值（使用 ElementName 与 Element 绑定作为“房间”）如果值匹配，则显示图像控件，即imgControl.Visibility 绑定到转换器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T14:56:42.367

假设您的房间对象包含图片或图片链接，您可以使用 ListView 的 SelectedIndex 属性并绑定到图片字段。

```
<TextBox Name="Room" Text="{Binding ElementName=RoomsList.SelectedItem, Path=Picture}" /> 
```

其中 Roomlist.Picture 是您要显示的照片。如果它是一个 URL，您可能必须这样做是一个包含在文本框中的图像标签。请注意，我尚未测试此代码，因此可能需要对其进行一些调整才能使其正常工作。

# apache-flex - 防止浏览器中的 Flex 应用程序缓存（多个模块）

> ID：300757
> 
> 赞同：8
> 
> 时间：2008-11-19T01:28:29.690
> 
> 标签：apache-flex, caching

我有一个包含多个模块的 Flex 应用程序。

当我重新部署应用程序时，我发现模块（作为单独的 swf 文件部署）被缓存在浏览器中，并且没有加载新版本。

`?version=xxx`所以我尝试了在加载所有模块时添加到所有模块的古老技巧。该值`xxx`是一个全局参数，它实际上存储在主机 html 页面中：

```
var moduleSection:ModuleLoaderSection;
moduleSection = new ModuleLoaderSection();
moduleSection.visible = false;
moduleSection.moduleName = moduleName + "?version=" + MySite.masterVersion; 
```

此外，我需要添加`?version=xxx`到正在加载的主 .swf。由于这是由 HTML 完成的，因此我必须通过修改我的 AC_OETags.js 文件来做到这一点，如下所示：

```
function AC_FL_RunContent(){
  var ret = 
    AC_GetArgs
    (  arguments, ".swf?mv=" + getMasterVersion(), "movie", "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
     , "application/x-shockwave-flash"
    );
  AC_Generateobj(ret.objAttrs, ret.params, ret.embedAttrs);
} 
```

这一切都很好，效果很好。我很难相信 Adob​​e 还没有办法处理这个问题。鉴于 Flex 的目标是为商业设计模块化应用程序，我觉得这特别令人惊讶。

其他人做什么？`once per session`即使有人选择了他们的“浏览器缓存检查策略”，我也需要确保我的应用程序正确重新加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-19T16:43:28.763

我遇到了类似的问题，最后将 SWF 文件放在名为内部版本号的子目录中。这意味着 SWF 文件的 URL 每次都指向不同的位置。

理想情况下，这应该由平台来满足，但那里没有乐趣。但这对我们来说非常有效，并且很容易集成到我们与 Hudson 的自动化构建中 - 到目前为止没有任何抱怨。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-09T13:57:09.803

弹性 说：

[http://www.adobe.com/livedocs/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001388.html](http://www.adobe.com/livedocs/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001388.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T20:49:50.287

What I have done is checksum the SWF file and then add that to its url. Stays the same until the file is rebuilt/redeployed. Handled automagically by a few lines of server-side PHP script

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-26T20:15:59.950

这是样本。

```
 function AC_FL_RunContent(){
    var ret = AC_GetArgs(arguments, ".swf?ts=" + getTS(), "movie", 
              "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",
              "application/x-shockwave-flash");
    AC_Generateobj(ret.objAttrs, ret.params, ret.embedAttrs);  
  }

  function getTS() {
    var ts = new Date().getTime();
    return ts;
  } 
```

AC_OETags.js 是文件，它存在 html-template 几个地方。但正如我的帖子所说，我面临着另一种类型的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T11:32:25.010

缓存不是由 Flash Player 完成的，而是由浏览器完成的，因此它不受 Adob​​e 的控制。我认为您已经找到了一个可行的解决方案。如果我想避免缓存，我通常会在 URL 上附加一个随机数。

# c# - 你如何反序列化带有子集合的集合？

> ID：300761
> 
> 赞同：1
> 
> 时间：2008-11-19T01:33:25.297
> 
> 标签：c#, web-services, serialization

我有一组自定义实体对象，其中一个属性是`ArrayList`字节数组。

自定义实体是可序列化的，并且集合属性标记有以下属性：`[XmlArray("Images"), XmlArrayItem("Image",typeof(byte[]))]`

所以我序列化了这些自定义实体的集合，并将它们作为字符串传递给 Web 服务。

Web 服务接收字符串和字节数组，

下面的代码然后尝试反序列化集合 - 回到自定义实体进行处理......

```
XmlSerializer ser = new XmlSerializer(typeof(List<myCustomEntity>));
StringReader reader = new StringReader(xmlStringPassedToWS);
List<myCustomEntity> entities = (List<myCustomEntity>)ser.Deserialize(reader);

foreach (myCustomEntity e in entities)
{
    // ...do some stuff...

    foreach (myChildCollection c in entities.ChildCollection
    {
        // .. do some more stuff....
    }
} 
```

我检查了初始序列化产生的 XML，它确实包含字节数组 - 子集合，上面构建的 StringReader 也是如此。

在反序列化过程之后，生成的自定义实体集合很好，除了集合中的每个对象不包含其子集合中的任何项目。（即它没有达到上面的“......做更多的事情......”。

有人可以解释我做错了什么吗？是否可以在自定义实体的通用集合中序列化 ArrayList？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T01:44:38.753

根据您正在做什么，有多种选择...调查 System.Xml.Serialization 命名空间中的 Xml 属性...特别是，请查看

[XmlArrayItem(ElementName = "")]

这是一个类的属性，该类被键入为某种集合（我认为它需要实现 IList），并将由 XmlDeserializer 填充名为“ElementName”的 Xml 元素......

这个命名空间中有一大堆 Xml 属性，您可以使用它们来精确控制序列化和反序列化的发生方式。您可以通过使用正确的 Xml*Atttributes 进行适当的装饰来创建几乎任何您想要的类结构

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T04:51:20.140

要序列化的可序列化类的属性必须是读/写。

在我上面的例子中， ArrayList 属性为只读，它基于添加了文件名的单独函数返回字节数组。

一旦为 ArrayList 属性编写了一个 setter，并且在整个 Add 方法中对逻辑进行了一些调整，序列化就可以工作了。

教训：对于需要基于序列化流重构的可序列化类，所有序列化属性都必须是可写的——当你这么说的时候有点明显。

# user-interface - UI 是内部质量的有效指标吗？

> ID：300766
> 
> 赞同：0
> 
> 时间：2008-11-19T01:37:18.080
> 
> 标签：user-interface

在查看我们公司编写的无数类型的软件时，我会立即根据 UI 得出整个产品质量的结论。如果我发现拼写错误、奇怪的标签顺序、未排列的字段、奇怪的颜色，我认为整个应用程序质量很差。

我假设如果程序员不够在意使外观看起来不错，那么他们根本就不够在意。我不会假设 UI 看起来是否不错，应用程序会做它应该做的事情，尽管我并没有立即反对它——在评估它时它会获得更多的回旋余地。

这是一个有效的决定吗？对于商业软件也是如此？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-19T03:33:31.433

它可能是也可能不是。但这并不重要。对于您的最终用户来说，糟糕的 UI = 糟糕的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T01:44:07.863

我认为这很好地表明了开发人员对其工作的关心——基本上是一种职业自豪感。

可以肯定的是，大多数开发人员都不会成为出色的 UI 设计师，但是在开发专业软件时应该遵循一组基本规则，这些规则适用于 UI 就像它们适用于内部一样。

所以，基本上我同意你的看法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T03:23:35.370

**如果**该应用程序是由一位开发人员编写的，那么不公平的假设就是一个不整洁的 UI 表明了底层代码的质量。

但是，如果它是由 5 人或 7 人或 13 人的团队编写的，那么引擎盖下的质量可能会很宽泛（可能只是新蜜蜂被赋予了 UI）。

此外，如果该应用程序的生命周期已超过 5 年，并且由 FBN 承包商或实习生或任何方便的人执行维护，您可能会发现很多好的代码在引擎盖下慢慢腐烂，因为管理冷漠和无纪律的开发人员只是抛出一个“补丁”，编译它，检查它，然后把它扔到墙上去生产。

蹩脚的 UI 可以代表很多事情，其中​​没有一个是好的，有些比其他的更糟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T01:40:37.420

在我看来，这是一个有效的决定。当你说好看的软件在内部不一定是好的软件时，你是对的。

但可以肯定的是，如果程序员不关心程序的可用性，他们很可能不会关心它的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T01:42:31.923

尽管我*真的*很想说“是的，绝对是”，但这并不总是一个有效的结论。程序员或 QA 团队可能对应用程序有很好的理解，但对语言或演示文稿的掌握却很糟糕。

有些人只是专注于他们认为重要的东西——并让它非常接近完美——而几乎忽略了他们认为“绒毛”或“装饰”的东西。

但我确实非常倾向于根据第一印象预先判断软件的整体质量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T02:12:02.613

如果 UI 中充斥着拼写错误和不一致，那么可以说 QA 流程和项目管理有点欠缺。并没有真正推断出代码库充满了错误。

在商业产品中，这很可能意味着更少的人会购买它，因此虽然销售额并不是真正的质量指标，但它们在整体方案中非常重要。
人们更有可能购买看起来不错、行为符合他们期望并且“不要让他们思考”的东西。

许多程序员不擅长 UI 设计，这不是他们的错，这并不意味着他们不擅长编码。他们通常只是对他们所做的内在美更感兴趣，否则，他们会成为文科专业的学生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T02:48:30.260

这真的取决于。我知道一些软件开发人员在设计和实现的各个方面都很出色，但 UI 技能却很糟糕。很多时候，UI 是对用户的认可。在科学软件或其他以处理为中心或关键的软件的情况下，通过 UI 判断其余代码的质量可能不是一个好主意。但是，总体而言，这可能是软件公司做得不好的一个很好的指标。

这一切都取决于每种情况，但如果 UI 不可用或脖子疼，那么底层代码更难使用，我想不值得花时间。

反之亦然——华丽、漂亮的 UI 并不意味着底层代码就很好。任何人都可以用漂亮的 UI 包装一块垃圾。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T03:23:53.030

我同意这里的群众。糟糕的用户界面意味着产品开发团队丢球了……也就是说。我认为自己是一个优秀的程序员。擅长数学，但有阅读障碍和注意力缺陷障碍。给我一副耳机和一些代码，我就在路上了。但是不要指望我模拟一个很棒的 GUI。把事情排好……我做的。

现在再加上一个事实，即作为“程序员”，即使我在 GUI 中看到让我（作为使用它的人）讨厌的东西，我也无法修复它们。当我这样做的时候该死修复它们 我得到 QA 要求我提供设计文件和高层的批准。过了一会儿，我不再关心 GUI 了。

我写了可靠的代码，那行得通。它快速、干净、小巧……这是我能产生影响的地方。GUI 超出了我的工资等级。:(

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T03:54:39.800

根据我的经验，通常情况相反。通过让人们花费“大量”时间专注于小部件行为和外观而不是域模型或自动化测试，您可以获得高质量的 UI。

我使用过的一些质量最好的系统具有自动生成的 UI，使用起来相当不愉快。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T04:11:54.273

不，UI 不代表内部代码。很多时候，我们会遇到闪亮的、看起来很酷但毫无用处的东西。把它想象成看到一辆法拉利停在商店里。它看起来棒极了，你想知道驾驶它会是什么样子——只是发现它是一个车身套件，贴在一辆 1980 年后期车型讴歌上，上面有 50 万英里。

一个个人的例子，在我现在的雇主，我们的软件中有一流的代码（我主观地说这是因为我 99% 的创作都没有在那里）。但是，当您查看我们的 UI 时，它会显得有些陈旧和生锈。很多时候，UI 开发人员甚至不会触及很多内部代码。

“我假设如果程序员不关心让外观看起来不错，那么他们根本不关心” - 我不相信这是真的。我认为大多数程序员都在寻找功能而不是光鲜，因为他们往往是逻辑的生物，而不是艺术家。

以 linux 为例——内部代码很出色，但 UI 长期缺乏，因此主流中没有人广泛使用它，而不是 Windows 或 Mac。

短版：**!UI.Equals(InternalQuality)**

# .net - Microsoft.NET 和 Doom 的多核 CPU

> ID：300779
> 
> 赞同：2
> 
> 时间：2008-11-19T01:45:52.073
> 
> 标签：.net, multithreading, multicore, ioexception

## 正确的问题

**有没有人在单核**机器上遇到过这个异常？

> `The I/O operation has been aborted because of either a thread exit or an application request.`

## 一些上下文

在单个 CPU 系统上，一次只执行一条 MSIL 指令，尽管有线程。在操作之间，运行时可以进行内务处理。

引入第二个 CPU（或第二个内核），就可以在运行*时*进行内务处理时执行操作。因此，在单 CPU 机器上完美运行的代码在多核环境中执行时可能会崩溃，甚至导致蓝屏。

有趣的是，超线程 Pentium 并*没有*表现出这个问题。

我有在单核上完美运行并在多核 CPU 上剥落的示例代码。它在某个地方，但我仍在努力寻找它。它的要点是，当它被实现为访问者模式时，它会在不可预知的迭代次数后剥落，但是将方法移动到访问者操作的对象中会使问题消失。

对我来说，这表明该框架具有某种用于解析对象引用的内部哈希表，并且在多核系统上，存在与访问它有关的竞争条件。

我目前也有代码使用 APM 来处理串行通信。它曾经在我的 USB 串行适配器的虚拟 comport 驱动程序中间歇性地蓝屏，但我通过`Thread.Sleep(0)`在每次`Stream.EndRead(IAsyncResult)`

以随机间隔，当我提供的 AsyncCallback`Stream.BeginRead(...)`被调用并且处理程序尝试调用`Stream.EndRead(IAsyncResult)`时，它会抛出一个`IOException`声明`The I/O operation has been aborted because of either a thread exit or an application request.`

我怀疑这也与多核相关，并且某种内部错误正在杀死等待线程，从而导致这种行为。如果我对此是正确的，那么该框架在多核环境的上下文中存在严重缺陷。虽然有我提到的变通方法，但您不能总是应用它们，因为有时它们需要*在*其他框架代码中应用。

例如，如果您在网上搜索有关上述 IOException 的信息，您会发现它会影响那些显然甚至不知道他们正在使用多线程的人编写的代码，因为它发生在框架便利包装器的掩护下。

微软倾向于吹嘘这些错误报告是不可重现的。我怀疑这是因为问题只发生在多核系统上，并且像[这样](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=266425)的错误报告没有提到 CPU 的数量。

所以...请帮我解决问题。如果我对此是正确的，我将不得不能够用可重复的测试用例来证明它，因为我认为错误的是需要在框架和运行时进行错误修复。

* * *

有人建议问题更可能是我的代码而不是框架。

调查问题的变体 A，我已将问题代码移植到示例应用程序中，并对其进行了精简，直到只剩下线程设置和在一个 CPU 上工作但在两个 CPU 上失败的方法调用。

变体 BI 还没有经过如此测试，因为我不再有任何单核系统。所以我重复这个问题：有没有人在单核平台上看到过这个异常？

不幸的是，没有人能证实我的怀疑，只能反驳它。

告诉我我容易犯错是没有帮助的，我已经意识到了这一点。

如果您知道将 .NET 应用程序固定到单个 CPU 的方法，那么解决这个问题会非常方便。---感谢VM的建议。我会这样做，很好的电话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T02:07:30.173

根据您的描述，我倾向于责怪 COM 端口驱动程序。它的驱动程序是在多核时代之前开发的吗？我曾经在这样的设备上遇到过类似的问题，谢天谢地，后来的驱动程序修订版修复了。

另外：要回答有关如何将应用程序限制为单个 CPU 的问题，您需要将进程关联设置为单个 CPU。请参阅[此链接](http://pinvoke.net/default.aspx/kernel32/SetProcessAffinityMask.html)。您也可以在您的进程开始使用任务管理器后执行此操作（右键单击任务管理器中的进程并选择“设置关联...”）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T07:16:38.083

蓝屏不仅仅是由于应用程序或框架中的错误。蓝屏需要内核模式的“帮助”。您的问题之一是有缺陷的驱动程序，无论有缺陷的驱动程序是在哪个“时代”编码的。

关于一个线程关闭端口而另一个线程仍在使用它的可能性，我认为这可能与框架内务管理中的一些著名错误有关。我认为这些错误不取决于内核的数量，但是当有更多内核时，被这些错误击中的频率可能会增加。尝试添加 GC.KeepAlive 调用以防止框架过早删除您的端口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T18:39:08.877

我目前正在重写我们应用程序中使用的整个文件传输堆栈。从与其他工作人员的交谈中，我知道几年前还可以工作，当时在生产中使用单核笔记本电脑和低速连接。现在每个人都转向双核和高速互联网，整个软件显示出不可预测的结果。

因此，当我开始更多地学习代码时，我发现开发它的人**对如何正确编写多线程代码一无所知**。所有“同步”都是使用 Thread.Sleep() 完成的！线程管理是在“即发即弃”的基础上完成的。有人想停止线程吗？线程.Abort()！该死！令人惊讶的是，这该死的东西竟然在起作用。

我的意思是——**去检查你的代码**，如果你正在使用一些定制硬件，他们的驱动程序代码。问题就在那里，不在 .NET、Win32 或其他地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T17:39:27.297

在 Vista 之前，任何在发出它的线程终止时正在进行的异步 IO 都会被终止。这往往会给出您报告的错误，即

> 由于线程退出或应用程序请求，I/O 操作已中止。

我不确定这是否与您的问题相关，但是您是否从可以在操作完成之前终止的线程发出异步操作？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T18:16:00.390

我在这里完全不知所措。你说你的代码在双核机器上被破坏了，你怀疑是 MS ！！！

现在有一天，每台机器都有双核甚至四核。如果 .net 框架在使用双核时遇到任何重大问题，那么为什么 live messenger、live writer 和许多其他 .net 厚应用程序不会经常中断。我相信 SQL Server 2K5 和 2K8 管理工作室也在 .net 中。整个 System.Web 实现在 C# 本身中。整个 Biztalk 编排设计器都在 .net 中

现在说到点子上了。您的应用程序似乎有多线程和大量的异步调用上下。你有没有灵活配置。应用程序中的线程数？如果是，您能否将线程数限制为 1，然后进行测试。由于多线程导致的错误很难追踪。

你试过SOS吗？尝试这样做......我不太了解，但谷歌为它，你肯定会得到关于使用 SOS 的好资源。

作为最后的手段，请在 MS 支持下打开一个案例。你需要对他们有点耐心，因为起初他们会从所有愚蠢的问题开始:)。祝你好运。

# c# - Guid.NewGuid() 返回的重复项？

> ID：300786
> 
> 赞同：10
> 
> 时间：2008-11-19T01:52:24.867
> 
> 标签：c#, guid

我们有一个应用程序可以为我们的一项服务生成模拟数据以进行测试。每个数据项都有一个唯一的 Guid。但是，当我们在对模拟器进行一些小的代码更改后运行测试时，它生成的所有对象都具有相同的 Guid。

创建了一个数据对象，然后是一个 for 循环，其中对象的属性被修改，包括一个新的唯一 Guid，并通过远程处理（可序列化，而不是 marshal-by-ref，如果这是你的话）发送到服务'正在考虑），循环并再次执行，等等。

如果我们在循环中放置一个小的 Thread.Sleep( ...)，它会生成唯一的 id。我认为这是一个红鲱鱼。我创建了一个测试应用程序，它只是一个接一个地创建了一个 guid，并且没有得到一个副本。

我的理论是，IL 的优化方式导致了这种行为。但是关于我的理论就足够了。你怎么看？我愿意接受建议和测试它的方法。

更新：我的问题似乎有很多困惑，所以让我澄清一下。我不认为 N​​ewGuid() 坏了。显然它有效。没关系！但是在某处有一个错误，导致 NewGuid() ：1）在我的循环中只被调用一次 2）在我的循环中每次都被调用但只分配一次 3）我没有想到的其他东西

这个错误可能在我的代码中（很可能）或在某处的优化中。

所以重申我的问题，我应该如何调试这个场景？

（感谢您的精彩讨论，这真的帮助我澄清了我心中的问题）

更新＃2：我很想发布一个显示问题的示例，但这是我的问题的一部分。我不能在整个应用程序套件（客户端和服务器）之外复制它。

这是一个相关的片段：

```
OrderTicket ticket = new OrderTicket(... );

for( int i = 0; i < _numOrders; i++ )
{
    ticket.CacheId = Guid.NewGuid();
    Submit( ticket );  // note that this simply makes a remoting call
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-20T00:16:10.707

Submit 是否进行异步调用，或者工单对象是否在任何阶段进入另一个线程。

在代码示例中，您正在重用同一个对象。如果 Submit 在短暂延迟后在后台线程中发送票证（并且不获取副本）怎么办。当您更改 CacheId 时，您实际上是在更新所有待提交的提交。这也解释了为什么 Thread.Sleep 可以解决问题。试试这个：

```
for( int i = 0; i < _numOrders; i++ )
{
    OrderTicket ticket = new OrderTicket(... );
    ticket.CacheId = Guid.NewGuid();
    Submit( ticket );  // note that this simply makes a remoting call
} 
```

如果由于某种原因这是不可能的，试试这个，看看它们是否仍然相同：

```
ticket.CacheId = new Guid("00000000-0000-0000-0000-" + 
     string.Format("{0:000000000000}", i)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T02:24:37.220

成千上万的开发人员在 .NET 中使用 Guid。如果 Guid.NewGuid() 有任何被“卡”在一个值上的趋势，那么这个问题早就已经遇到了。

小的代码更改是这里的罪魁祸首。[Thread.Sleep](https://stackoverflow.com/questions/143429/whats-the-least-useful-comment-youve-ever-seen#143556)（与其说是一条在阳光下腐烂的鱼不如说是一条红鲱鱼）“修复”了您的问题这一事实表明您的属性正在以某种奇怪的方式设置，直到循环停止阻塞（或者通过结束或通过 Thread.Sleep）。我什至愿意打赌“微小的变化”是从一个单独的线程中重置所有属性。

如果您发布了一些示例代码，那将有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T01:54:36.237

这是您的代码中的错误。如果您设法生成了多个 guid，这是最有可能的解释。线索就在您的问题中：“当我们在**对模拟器进行一些小的代码更改后**运行测试时，它生成的所有对象都具有相同的 Guid”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T02:03:29.977

请参阅[这篇](http://blogs.msdn.com/oldnewthing/archive/2008/06/27/8659071.aspx)关于如何创建 Guid 的文章。

这篇文章来自[这个](https://stackoverflow.com/questions/39771/is-a-guid-unique-100-of-the-time)答案。

最重要的是，如果您创建 GUID 太快并且时钟没有向前移动，这就是为什么您会得到相同的 GUID。但是，当您进入睡眠状态时，它会起作用，因为时钟已经移动。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T02:21:27.320

Submit 和 OrderTicket 中的代码也会有所帮助......

您正在重用 OrderTicket。我怀疑您（或远程处理本身）正在批量调用 - 可能与连接数/主机限制有关 - 并在最终发送它们时获取 CacheId 的最后一个值。

如果您调试或 Thread.Sleep 应用程序，您正在更改时间，以便远程调用在您分配新的 CacheId 之前完成。

您是否正在异步远程调用？我认为同步调用会阻塞 - 但我会使用像 Wireshark 这样的数据包嗅探器来确定。无论如何，只需更改为在每次迭代中创建一个新的 OrderTicket 就可以解决问题。

编辑：问题*不*在于 NewGuid 被破坏......所以我之前的答案已被删除。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T04:43:49.857

我不知道如何生成 GUID 的详细信息......但是。但是目前我的组织。正在以让兔子感到羞耻的速度繁殖 GUID。所以我可以保证*GUID 还没有被破坏*。

*   如果可能，请发布源代码.. 或克隆 repro 应用程序。很多时候，我发现创建克隆应用程序来重现问题的行为向我展示了问题。
*   另一种方法是注释掉“那些微小的变化”。如果这样可以解决问题，则可以进行三角化以找到有问题的代码行。仔细观察细微的变化……我的意思是真正的困难。

一定要告诉我们进展如何……这听起来很有趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T00:40:34.217

我的直觉告诉我，这些事情正在发生……

```
class OrderTicket 
{
   Guid CacheId {set {_guid = new Guid("00000000-0000-0000-0000-");}
} 
```

每次使用堆栈跟踪调用它时，将 CacheId 的值记录到日志文件中......也许其他人正在设置它。

# continuous-integration - 如何从“奥术集成”迁移到持续集成？

> ID：300787
> 
> 赞同：9
> 
> 时间：2008-11-19T01:53:15.210
> 
> 标签：continuous-integration

现在，我正在进行的一个项目已经达到了一个复杂程度，需要多个步骤（实际上它变得神秘！）才能生产出完整/可用的产品。不幸的是，我们一开始并没有采用 Continuos 集成的心态，所以你可以想象它有时会很痛苦，而在其他情况下，我很容易浪费半天时间来尝试获得一个干净/经过测试的构建。

无论如何，作为任何 HUGE 项目，它由许多不同语言的组件组成（不仅是企业风格的 Java 或 C#，例如），以及许多图形和文本资源。现在的问题是，当我寻找 Continuos 集成时，我总是会找到最佳实践和技术，假设人们正在从头开始一个新项目。然而，这不是一个新项目，所以我想知道有哪些好的资源可以主动开始从 Arcane Integration 迁移到 Continuos Integration :)

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T02:27:43.877

这是两个简单的（哈哈）步骤。

1.  寻找可重复的构建：
    1.  使用源代码管理，签入所有代码。
    2.  建立并记录用于构建的所有工具（主要是哪个编译器版本）。对这些工具进行可重复的部署和设置过程。
    3.  建立并清楚记录构建所需但未签入的任何资源（第三方安装、服务包等）。对这些依赖项进行可重复的部署和设置过程。
2.  在承诺进行源代码控制之前，开发人员必须
    1.  更新他们的工作副本
    2.  成功构建
    3.  运行并通过自动化测试

这些步骤可以一次完成 1 个，有点像要遵循的路径。您将在每个阶段获得好处。例如，如果您根本不使用源代码控制，那么只需将代码放入源代码控制（无需其他任何东西）就是向前迈出的一大步。此外，如果没有自动化测试，那么开发人员就无法运行它们——但他们仍然可以获得先前的提交并让编译器检查他们的工作。

如果你能做到所有这些，你会得到一个很好的理智的地方。

目标是可重复的构建过程和开发人员，他们将插入他们的更改如何影响构建和其他开发人员。

然后，您可以通过建立更高的合规性来获得红利：

*   开发人员建立了频繁提交的习惯。工作副本中的代码不得超过 1 天。
*   自动构建过程监控签入的源代码控制，并将结果发送到用户可以接受的地方（例如测试环境、预览网站，或者甚至只是将 .exe 放在用户可以找到的地方）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T02:11:54.157

就像你吃大象一样（一次咬一口）；-) 持续集成需要自动化构建。从那开始。自动构建每件作品。Ant 或 NAnt 是执行此操作的好方法。让每个组件的构造成为 NAnt 任务。然后您的整个系统构建可以聚合这些单独的任务。

从那里，您可以添加用于部署、单元测试等的任务。如果您想使用 CI 技术，您可以将其连接到您的 NAnt 构建。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T02:39:42.807

我会首先写下手动构建和测试所需的所有步骤。之后，您至少有一个以旧方式进行操作的指南，并且写下来让您有机会将其视为一个完整的过程。

然后寻找要编写脚本的部分。

理想情况下，您希望从代码提交触发构建和测试，并且只重建和重新测试更改的部分，可能每晚或每周进行一次完整的构建和测试。您将需要日志文件或数据库条目，并报告构建是否成功。

您需要搜索和评估预构建产品和开源构建您自己的工具包。您当然可以自己编写所有脚本和报告，但这需要一段时间，而且您最终可能会得到一个勉强够用的报告系统，因为您的工作是对产品进行编码，而不是对构建系统进行编码。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T02:09:53.397

我猜想迁移并不是一个真正的选择——半途而废的解决方案只会让情况变得更糟。

我的方法是找一位了解构建过程的创意工程师，让他坐下来说“修复这个”。给他一两个星期。

最终目标将是一个使用单个 make 命令从头到尾运行的进程。

我还推荐一个自动化的“设置”过程，您只需执行检查并从网络共享运行批处理文件来安装和构建您的所有工具。如果你引进新的程序员，这将节省的时间总量是惊人的。大多数项目需要一到三天的时间才能在新计算机上进行设置——而且总是“新”程序员不知道在自己的系统上进行安装时发生了什么……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T02:21:02.237

简而言之：增量

选择一个适用于各种项目的框架。

一个一个，将组件添加到框架中。

如果您不熟悉框架，请先处理几个更简单的组件，以减少搞砸的风险。

如果您确实了解该框架，请先处理一些更困难和/或常用构建的组件，这样您的团队（和管理层）就会尽早体会到这些好处，并更多地支持这项工作。

一定要制定一个包含*所有*组件的计划，因为这样才能实现全部收益。

带上你的团队；确保您对这将是有价值的达成共识，否则人们不会在组件更改时维护它。

# javascript - 大学班级注册脚本

> ID：300788
> 
> 赞同：1
> 
> 时间：2008-11-19T01:54:12.010
> 
> 标签：javascript

我明天早上报名参加春季课程（转入计算机科学课程）。因为我是转学生，所以我得到了最后一个还没有上过的剩余课程。强调“最后的选择”和“剩余的”。很有可能我明天打算选什么课，我什至可能都拿不到，因为其他学生会争夺同样的课。除此之外，即使有调度，当服务器受到大负载冲击时，它也会变得非常缓慢。

所以，当我下学期注册时（或者如果其他人放弃他们，甚至为 Spring 注册不同的课程）我想准备好一个脚本或代码，这样我就可以自动化我的输入，而无需填写网络表格并希望服务器正确解析它们。（通过输入，我很笼统——从自动填写表单字段到 SQL 输入）。显然，这可能行不通。但是，我正在寻找的是一种用于网络浏览器的键盘记录器，它可以下载所有访问过的网页、执行的任何 javascript、填写的表格、任何东西。这样，我可以稍后在闲暇时分析数据，看看我是否能以更好的方式做到这一点。

关于什么可以做到这一点的任何建议？（我在想也许是一些测试软件？）。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T02:04:41.177

**Selenium**可以自动执行大多数基于浏览器的任务。[http://selenium.seleniumhq.org/](http://selenium.seleniumhq.org/)

**Grinder**带有一个本地代理，可以记录流量并且可以使用 Python 编写脚本。[http://grinder.sourceforge.net/](http://grinder.sourceforge.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T03:16:31.220

我强烈建议您查看您所在大学的*可接受使用政策*，在我的，这样的事情将被视为严重违规行为，并可能让您被踢出局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T02:12:12.143

[CoScripter](http://services.alphaworks.ibm.com/coscripter)几乎可以满足您的需求。

# jquery - 如何为“以#开头的（此）属性”进行属性选择

> ID：300791
> 
> 赞同：1
> 
> 时间：2008-11-19T01:55:33.817
> 
> 标签：jquery, syntax, css-selectors

也许这是我真正的深夜，但我无法弄清楚这一点。首先是html：

```
<div>
<a href="#internal">Internal Link</a>
<a href="http://external.com">External Link</a>
<a href="#internal2">Internal Link2</a>
</div> 
```

为了在页面上做某事而不是转到链接，我需要根据它是否在开头包含 # 来过滤它。这是 [attribute^=value] 解决方案的完美问题，但这不起作用......

```
var link = $(this[href^=#]); 
```

我只知道如何将它和属性限定符放在一起是一个问题……而且我不知道在 .val() 之后要放什么？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T02:13:49.787

我对你到底在追求什么有点困惑......

如果你想测试当前对象是否在其 href 属性的开头有一个 # ：

```
var link = $(this);
if (link.is("[href^='#']") ... 
```

否则，您可以执行以下操作：

```
$('div a[href^="#"]').val("This link starts with a #"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T02:41:00.073

//使用以下内容，您正在搜索所有在 'this' 中具有以 '#' 开头的 href 标记的子项

```
 var links = $('*[href^=#]', this); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T03:23:20.830

我猜测您要提取的是链接上 href 属性的内容，并且您已经知道带有链接的容器。

我建议你想要的是：

```
var link = $('a[href^=#]',this).attr('href'); 
```

这应该在您的示例中返回数组 [ '#internal', '#internal2' ]。如果这不是您想要的，您可能希望`link`在查询后显示您期望的样子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T05:49:46.153

对不起，伙计们——就像我说的那样，我从深夜开始就处于阴霾之中。简单的答案是在我尝试建立变量之前将 [href^=#] 移动到选择器。这是我的错，将它修剪得太多，而我试图在变量内部而不是在选择器上进行过滤，我的头脑一团糟……不过，谢谢你，如果不阅读你的（正确的）困惑的回复，我就无法做到这一点。以下是我通常会通过更多睡眠来解决的问题：

```
$("div a[href^=#]").click(function() {
  var link = $(this).attr("href");
  ... 
```

谢谢

附言。我今天一整天都在尝试解决另一个问题，我正在考虑发布它，但在此之后我想我会回家，睡觉，早上想一想：D

# iphone - iPhone 模拟器：SpringBoard 无法启动应用程序并出现错误：7

> ID：300793
> 
> 赞同：68
> 
> 时间：2008-11-19T01:56:57.370
> 
> 标签：iphone, iphone-sdk-3.0, ios-simulator

构建 iPhone 项目会导致：

> 启动模拟应用程序失败：SpringBoard 启动应用程序失败，错误：7

并且该应用程序未安装在模拟器上。这是怎么回事？什么是 SpringBoard，什么是错误 7？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-01-17T02:31:12.753

我遇到了完全相同的问题 - 我重置了 iphone 模拟器，然后退出了模拟器（即命令 q），然后再次启动它。

工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-13T23:02:47.617

男孩，这是一个很难找到的答案，但我想出了一个解决方法。如果模拟器在访问 ~/Library/Application Support/iPhone Simulator/ 中的文件时遇到任何问题，则会出现此错误。这可能是一个权限问题，但在我的情况下它更加微妙：我的主目录是 NFS 挂载的，这似乎是问题的根源。

基本的解决方法是在机器本地创建一个目录，并将 iPhone Simulator 的目录链接到该本地目录。您不需要移动源文件或项目目录；问题只是模拟器目标。

这是完成解决方法的一系列步骤，在终端输入（在您将要开发的每台机器上完成 1-3 次，在 NFS 挂载的主目录中执行 4-6 次）：

1.  `sudo mkdir /usr/local/iphone-dirs`
2.  `sudo chmod 777 /usr/local/iphone-dirs`
3.  `mkdir /usr/local/iphone-dirs/my-dir`
4.  `cd "~/Library/Application Support/"`
5.  `rm -rf "iPhone Simulator/"`
6.  `ln -s /usr/local/iphone-dirs/my-dir/ "iPhone Simulator"`

这个主题显然有很多变化；我怀疑在 /tmp 中使用本地托管的目录会很好（并且不需要管理员权限，但每次重新启动系统时都必须重做）。如上所述，如果您将有多个用户使用这些您不想相互碰撞的机器，那么步骤 1 和 2 是很好的。如果您有自己的个人计算机但 NFS 挂载您的 homedir，您可能只需跳到步骤 3 之类的内容（然后 sudo 执行）。只要确保您在步骤 3 中创建的任何目录都是您在步骤 6 中符号链接到的目录。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-14T10:21:22.607

无需完全模拟器或删除应用程序..

只需选择模拟器，按**command + shift + h + h 并**从后台进程中删除应用程序（长按应用程序图标），然后再次运行您的应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-24T19:27:49.880

我从 Xcode 中的一个新项目开始，并收到错误 3 消息，但其他情况相同。新的该死的项目 - 所以我添加的损坏代码或命名错误或其他任何问题都没有问题。但是应用程序会构建但无法在模拟器中运行，并出现 Springboard -3 错误代码。我以前见过很多次，基本的kill-the-app-in-simulator，clean-and-run 可以工作，但这次不行。

原来我的旧 2007 iMac 几乎没有足够的 RAM 和可用磁盘空间了。我正在运行 Mavericks，我隐藏了除 Xcode 和模拟器之外的所有内容，然后运行了一个内存清理实用程序来释放所有可用的 RAM（恢复到 1GB 左右），然后应用程序在模拟器中运行，没有一个障碍。不再有跳板错误。

我还没有看到“RAM 太少”被列为此错误的原因，因此这可能对其他人有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T15:40:06.520

XCode 菜单-> 清除缓存解决了我的问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T16:23:17.497

也许这会有所帮助：[http ://discussions.apple.com/thread.jspa?threadID=1605042&tstart=72](http://discussions.apple.com/thread.jspa?threadID=1605042&tstart=72)

当我试图在 iPhone 上安装我当前的开发时，我遇到了类似的问题，而有关 AppID 的信息修复了它。

为了快速参考，您在开始创建用于开发和配置 iphone 的证书时创建的 AppID 要求您创建反向域名标识符。类似于：QS32H9XPNE.domain.subdomain.companyname.*

要将您的应用程序正确链接到 AppID，您需要将应用程序中的标识符设置为 domain.subdomain.companyname.application.*

希望这可以帮助

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-11T06:29:12.233

我有同样的问题，模拟器会挂起。这是全新安装的 XC 3.2.5 GM 并使用带有 4.2 SDK 的模拟器。应用程序可以在真实设备上正常运行，但模拟器会挂起。

我最终将 iPhone App Support 目录和所有子目录更改为 777 访问权限。对 777 -R 来说不是一个好主意，但我很绝望，它奏效了。

$sudo chmod -R 777 ~/Library/Application Support/iPhone Simulator/

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-19T03:03:27.890

Springboard 是启动应用程序的应用程序。这是 iPhone 的主屏幕。当我试图让我的应用程序在手机上运行时，我遇到了很多问题——结果证明我有一个旧版本的 SDK，它与我手机的操作系统版本不兼容。重新安装最新的 SDK 就可以了。

另外，听说清除 XCode 缓存有时会有所帮助（对我来说没有）——XCode 菜单->清除缓存...

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-22T11:59:52.280

我有同样的问题，但这个解决方案有效......！！！1）从模拟器中删除应用程序。2）退出模拟器。3）重启模拟器。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-11T06:20:21.623

当我从设备上的测试切换到模拟器上的测试时，就会发生这种情况。重新启动 Xcode 和模拟器为我消除了这个错误。傻。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-08-27T04:11:19.463

我最初通过重新启动 iPhone 模拟器解决了这个问题。但这不应该是答案。错误来自编辑信息 plist。

在为您的设备配置您的应用程序之前，检查您是否未更改任何设置的值。我想更改我的 Bundle Identifier，但在出现此错误后必须返回默认值。现在它已经修复了。下一步将是获取一个新的配置 ID，其中 Bundle Id 已更改。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-28T12:03:53.210

对我来说，这是解决方案。如果您启用了后台获取模式。如果您在模拟器中运行应用程序期间收到此警报，请删除此选项。

![在此处输入图像描述](https://i.stack.imgur.com/vVPPi.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-02T08:47:46.007

我有同样的问题。

它发生如下......

我有一个文件夹，将图像存储在一些子文件夹中。

如果我将根图像文件夹添加为“目录”，我会收到此错误。

如果我将根图像文件夹添加为“组”，模拟器运行良好。

诡异的...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-03T07:37:02.217

它也恰好与文件夹名称有关。我的图像文件夹最初被命名为“内容”，我得到了描述的错误。

将文件夹名称更改为“image_files”并将其作为“文件夹”重新导入 Xcode 项目。有用！

这完全是随机的...

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-10-31T06:58:43.873

我得到了同样的错误。这就是我解决它的方法。希望这可以帮助。

1.  要从命令行显示下面的所有隐藏文件

    $ defaults write com.apple.finder AppleShowAllFiles TRUE; killall 查找器

2.  访问**DerivedData**文件夹并删除它的内容（在 DerivedData 下）。基本上这是模拟器缓存，有时不会从 XCode 中删除。库是一个隐藏文件夹
    ，这就是我们运行第 1 步的原因。

    /Users/**你的用户名**/Library/Developer/Xcode/DerivedData

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-07-07T14:44:59.747

这也为我做了：

> 当我从设备上的测试切换到模拟器上的测试时，就会发生这种情况。重新启动 Xcode 和模拟器为我消除了这个错误。傻。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-02-24T11:53:48.980

我经常遇到这个问题，通常只是退出并重新启动 Xcode 即可。

然而，我又遇到了这个问题，似乎没有什么能解决它 - 退出 sim，Xcode，重新启动......奇怪的是一些目标工作（我已经为这个项目增加了构建目标），而其他项目工作。但是无论我做什么，一个目标都无法发射。

最后，我发现了问题：在目标的属性中，可执行文件名 $[EXECUTABLE_NAME] 被意外删除了！更换它，它的工作原理。

值得记住……</p>

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-10-09T11:08:56.677

当在 NFS 中挂载主目录时，模拟器会出现问题。

要摆脱它，您需要在您有权写入的某个本地位置创建几个目录，“iPhone Simulator”和“Interface builder”。然后删除“~/Library/Application Support/iPhone Simulator”和“~/Library/Application Support/Interface Builder 3.0”。最后在指向本地目录的已删除目录的确切位置创建符号链接。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-09-14T03:43:52.257

检查您的控制台，您将更好地了解错误可能是什么。该错误编号非常通用。就我而言，我的 Plist 文件中有错误。我做了一些我不应该做的事情。但我意识到这是问题所在，因为控制台有更详细的错误消息：

```
2010-09-13 23:30:27.149 Appname[5580:207] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Could not load NIB in bundle: 
```

......它继续。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-02-01T20:04:52.290

就我而言，当我尝试更改 info.plist 文件中的 App bundle ID 设置以运行测试时出现错误。把它改回来解决了这个问题，但对我的测试没有任何好处。幸运的是，该应用程序已加载到模拟器中，我手动运行它进行测试。

据我所知，问题源于捆绑 ID 同时匹配特定 ID 和通配符 ID。我尝试过的仅与特定 ID/配置文件匹配的应用 ID 没有显示出问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-10-30T13:38:13.397

我经常面临完全相同的问题，我所做的是 1）我退出 iphone 模拟器 2）如果在执行步骤 1 之后，如果问题仍然相同，则重置模拟器

它从第 1 步本身就一直解决了我的问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-03-25T15:10:14.173

退出并重新打开模拟器，它会工作我也遇到了这样的问题，这对我有帮助。

# dom - NodeList 是如何实现的？

> ID：300794
> 
> 赞同：4
> 
> 时间：2008-11-19T01:57:06.620
> 
> 标签：dom, data-structures, nodelist

DOM NodeList（例如由 element.getElementsByTagName 返回）是一个有趣的对象，因为它不是快照，而是反映了在创建 NodeList 之后对文档所做的更改。

我想知道如何实现这样的集合：完全懒惰的评估一定非常慢，但保持缓存版本的一致性需要在内部进行大量的簿记。

我尝试在 google 上搜索有关该主题的博客文章，并尝试查找 Mozilla 的相关源代码文件，但无法立即找到任何内容（当我无法立即找到内容时，我会来这里...）。

那么 Firefox、Safari、Internet Explorer（和其他非浏览器 DOM 实现）如何处理 NodeList？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T02:48:07.830

对于 .NET 的 XML 库，XmlNodeList 有 3 个内部子类，具有不同的策略。对于 XmlNode.ChildNodes 属性，XmlChildNodes 集合使用基于对其包含元素的引用的简单惰性求值。XmlElementList 在 DOM 更改时使用事件侦听器。第三个，XPathNodelList，用于 XPath 查询（例如，XmlNode.SelectNodes()），并在每次访问其索引、读取其 Count 属性或迭代时评估 XPath。

# c++ - C++：如何将数组中的 2 个字节转换为无符号短

> ID：300808
> 
> 赞同：19
> 
> 时间：2008-11-19T02:05:43.373
> 
> 标签：c++, pointers, casting

我一直在开发一个遗留的 C++ 应用程序，并且绝对超出了我的舒适区（一件好事）。我想知道是否有人愿意给我一些指示（双关语）。

我需要将 unsigned char 数组中的 2 个字节转换为 unsigned short。字节是连续的。

例如，我正在尝试做的事情：

我从套接字接收一个字符串并将其放在一个无符号字符数组中。我可以忽略第一个字节，然后接下来的 2 个字节应转换为无符号字符。这将仅在 Windows 上，因此没有 Big/Little Endian 问题（我知道）。

这是我现在所拥有的（显然没有工作）：

```
//packetBuffer is an unsigned char array containing the string "123456789" for testing
//I need to convert bytes 2 and 3 into the short, 2 being the most significant byte
//so I would expect to get 515 (2*256 + 3) instead all the code I have tried gives me
//either errors or 2 (only converting one byte
unsigned short myShort;
myShort = static_cast<unsigned_short>(packetBuffer[1]) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-19T02:24:51.853

好吧，您正在将 char 扩大为一个短值。您想要的是将两个字节解释为一个短字节。`static_cast`不能从`unsigned char*`to 转换`unsigned short*`。您必须转换为`void*`，然后转换为`unsigned short*`：

```
unsigned short *p = static_cast<unsigned short*>(static_cast<void*>(&packetBuffer[1])); 
```

现在，您可以取消引用 p 并获取短值。但是这种方法的问题是你从 unsigned char* 转换为 void* 然后转换为一些不同的类型。标准不保证地址保持不变（此外，取消引用该指针将是未定义的行为）。更好的方法是使用位移位，这将始终有效：

```
unsigned short p = (packetBuffer[1] << 8) | packetBuffer[2]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T02:15:11.403

这可能远低于您关心的内容，但请记住，您可以轻松获得未对齐的访问权限。x86 是宽容的，未对齐访问导致的中止将在内部被捕获，并最终得到一个值的副本和返回，因此您的应用程序不会知道任何不同（尽管它比对齐访问慢得多）。但是，如果此代码将在非 x86 上运行（您没有提到目标平台，所以我假设 x86 桌面 Windows），那么这样做会导致处理器数据中止，您将不得不手动复制在尝试强制转换之前将数据传输到对齐的地址。

简而言之，如果您要经常进行这种访问，您可能会考虑对代码进行调整，以免出现未对齐的读取，并且您会看到性能优势。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T02:28:05.810

```
unsigned short myShort = *(unsigned short *)&packetBuffer[1]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-20T23:39:17.973

上面的位移有一个错误：

```
unsigned short p = (packetBuffer[1] << 8) | packetBuffer[2]; 
```

如果`packetBuffer`以字节为单位（8 位宽），则上述移位可以并且将变成`packetBuffer`零，只剩下`packetBuffer[2];`

尽管如此，这仍然比指针更受欢迎。为了避免上述问题，我浪费了几行代码（除了相当字面的零优化）它导致相同的机器代码：

```
unsigned short p;
p = packetBuffer[1]; p <<= 8; p |= packetBuffer[2]; 
```

或者为了节省一些时钟周期而不是将位移到末尾：

```
unsigned short p;
p = (((unsigned short)packetBuffer[1])<<8) | packetBuffer[2]; 
```

你必须小心指针，优化器会咬你，还有内存对齐和一长串其他问题。是的，做对了会更快，做错了错误会持续很长时间，并在最不希望的时候发生攻击。

假设你很懒，想在 8 位数组上做一些 16 位数学运算。（小端）

```
unsigned short *s;
unsigned char b[10];

s=(unsigned short *)&b[0];

if(b[0]&7)
{
   *s = *s+8;
   *s &= ~7;
}

do_something_With(b);

*s=*s+8;

do_something_With(b);

*s=*s+8;

do_something_With(b); 
```

无法保证完美无错误的编译器会创建您期望的代码。`b`发送到函数的字节数组`do_something_with()`可能永远不会被`*s`操作修改。上面的代码中没有任何内容表明它应该这样做。如果您不优化代码，那么您可能永远不会看到这个问题（直到有人优化或更改编译器或编译器版本）。如果您使用调试器，您可能永远不会看到这个问题（直到为时已晚）。

编译器看不到 s 和 b 之间的联系，它们是两个完全独立的项目。优化器可能会选择不写`*s`回内存，因为它看到`*s`有许多操作，因此它可以将该值保存在寄存器中，并且仅在最后将其保存到内存中（如果有的话）。

解决上述指针问题的三种基本方法：

1.  声明`s`为易失性。
2.  使用工会。
3.  更改类型时使用一个或多个函数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T02:18:17.920

您不应该将 unsigned char 指针转换为 unsigned short 指针（就此而言，从较小数据类型的指针转​​换为较大数据类型）。这是因为假定地址将正确对齐。更好的方法是将字节转换为真正的无符号短对象，或将 memcpy 转换为无符号短数组。

毫无疑问，您可以调整编译器设置来绕过这个限制，但这是一个非常微妙的事情，如果代码被传递和重用，将来会破坏。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-21T14:50:54.813

也许这是一个非常晚的解决方案，但我只想与您分享。当你想转换原语或其他类型时，你可以使用联合。见下文：

```
union CharToStruct {
    char charArray[2];
    unsigned short value;
};

short toShort(char* value){
    CharToStruct cs;
    cs.charArray[0] = value[1]; // most significant bit of short is not first bit of char array
    cs.charArray[1] = value[0];
    return cs.value;
} 
```

当你创建一个低于十六进制值的数组并调用 toShort 函数时，你会得到一个 3 的短值。

```
char array[2]; 
array[0] = 0x00;
array[1] = 0x03;
short i = toShort(array);
cout << i << endl; // or printf("%h", i); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T02:08:41.200

static cast 有不同的语法，加上你需要使用指针，你想要做的是：

```
unsigned short *myShort = static_cast<unsigned short*>(&packetBuffer[1]); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T03:41:08.160

没有人看到输入是一个字符串！

```
/* If it is a string as explicitly stated in the question.
 */
int byte1 = packetBuffer[1] - '0'; // convert 1st byte from char to number.
int byte2 = packetBuffer[2] - '0';

unsigned short result = (byte1 * 256) + byte2;

/* Alternatively if is an array of bytes.
 */
int byte1 = packetBuffer[1];
int byte2 = packetBuffer[2];

unsigned short result = (byte1 * 256) + byte2; 
```

这也避免了大多数其他解决方案在某些平台上可能存在的对齐问题。注意 short 至少是两个字节。如果您尝试取消引用不是 2 字节对齐的短指针（或者系统上的 sizeof(short) 是什么），大多数系统都会给您一个内存错误！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T05:59:48.737

```
char packetBuffer[] = {1, 2, 3};
unsigned short myShort = * reinterpret_cast<unsigned short*>(&packetBuffer[1]); 
```

我（不得不）一直这样做。大端是一个明显的问题。当机器不喜欢未对齐的读取时，真正会得到的是不正确的数据！（和写）。

您可能想编写一个测试转换和一个断言来查看它是否正确读取。因此，当在大端机器或更重要的是不喜欢未对齐读取的机器上运行时，将发生断言错误，而不是奇怪的难以追踪的“错误”；）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-21T11:33:20.340

在 Windows 上，您可以使用：

```
unsigned short i = MAKEWORD(lowbyte,hibyte); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-23T20:37:08.140

我意识到这是一个旧线程，我不能说我尝试了这里提出的每一个建议。我只是让自己对 mfc 感到满意，我正在寻找一种将 uint 转换为两个字节的方法，然后再返回到套接字的另一端。

您可以在网上找到很多位移示例，但它们似乎都没有真正起作用。很多例子似乎过于复杂。我的意思是我们只是在谈论从一个 uint 中获取 2 个字节，通过网络发送它们，然后将它们插回到另一端的 uint 中，对吧？

这是我最终想出的解决方案：

```
类字节转换器
{
上市：
 static void uIntToBytes(unsigned int theUint, char* bytes)
  {
   无符号整数 tInt = theUint;

   无效 *uintConverter = &tInt;
   char *theBytes = (char*)uintConverter;

   字节[0] = theBytes[0]；
   字节[1] = theBytes[1];
  }
 静态无符号整数 bytesToUint(char *bytes)
  {
   unsigned theUint = 0;

   无效 *uintConverter = &theUint;
   char *thebytes = (char*)uintConverter;

   thebytes[0] = 字节[0]；
   thebytes[1] = 字节[1];

   返回 Uint；
  }
};

```

像这样使用：

```
无符号整数；
字符字节[2]；
CString 消息；

ByteConverter::uIntToBytes(65000,bytes);
theUint = ByteConverter::bytesToUint(bytes);

msg.Format(_T("theUint = %d"), theUint);
AfxMessageBox(msg, MB_ICONINFORMATION | MB_OK);

```

希望这可以帮助某人。

# c# - 强制 PHP 整数溢出

> ID：300840
> 
> 赞同：8
> 
> 时间：2008-11-19T02:26:27.107
> 
> 标签：c#, php, integer-overflow

我们有一些整数运算，由于历史原因，它在 PHP 上的工作方式与在一些静态类型语言中的工作方式相同。自从我们上次升级 PHP 以来，溢出整数的行为已经改变。基本上我们使用以下公式：

```
function f($x1, $x2, $x3, $x4)
{
   return (($x1 + $x2) ^ $x3) + $x4;
} 
```

但是，即使有转换：

```
function f($x1, $x2, $x3, $x4)
{
   return intval(intval(intval($x1 + $x2) ^ $x3) + $x4);
} 
```

我仍然以完全错误的数字结束...

例如，对于 $x1 = -1580033017、$x2 = -2072974554、$x3 = -1170476976) 和 $x4 = -1007518822，我在 PHP 中得到 -30512150，在 C# 中得到 1617621783。

只是将 $x1 和 $x2 加在一起我无法得到正确的答案：

在 C# 中我得到

```
(-1580033017 + -2072974554) = 641959725 
```

在 PHP 中：

```
intval(intval(-1580033017) + intval(-2072974554)) = -2147483648 
```

这与以下内容相同：

```
intval(-1580033017 + -2072974554) = -2147483648 
```

我不介意写一个“IntegerOverflowAdd”函数之类的，但我不太清楚 (-1580033017 + -2072974554) 如何等于 641959725。（我知道它是 -2147483648 + (2 * 2^31) ，但是 -2147483648 + 2^31 是 -1505523923 大于 Int.Min 那么为什么要添加 2*2^31 而不是 2^31？）

任何帮助，将不胜感激...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-19T23:53:17.977

所以我解决了这个问题，并发现了很多关于 PHP 的东西（至少在它处理整数溢出的方式上）。

1) 它完全取决于机器运行的平台、PHP 的版本、是否运行 Suhosin Hardened PHP 以及编译的位数（32 或 64）。6 台机器的行为符合我的预期（实际上是错误的，至少根据他们的文档是错误的），3 台机器的行为方式我仍然无法解释，3 台机器的行为与 intval 命令在文档。

2) 当 int > PHP_INT_MAX（不是 int & 0xffffffff）时，Intval 应该返回 PHP_INT_MAX，但这只发生在 PHP4 和 PHP5 的某些版本上。当 int > PHP_INT_MAX 时，不同版本的 PHP 返回不同的值。

3）以下代码可以返回3种不同的结果（见1）：

```
<?php
echo "Php max int: ".PHP_INT_MAX."\n";
echo "The Val: ".(-1580033017 + -2072974554)."\n";
echo "Intval of the val: ".intval(-3653007571)."\n";
echo "And 0xffffffff of the val: ".(-3653007571 & 0xffffffff)."\n";
?> 
```

它可以返回（这对于 Intval 似乎是正确的，但对于 & 0xffffff 是错误的）

```
Php max int: 2147483647
The Val: -3653007571
Intval of the val: -2147483648
And of the val: -2147483648 
```

它可以返回（这与 intval 的 PHP 文档相矛盾）：

```
Php max int: 2147483647
The Val: -3653007571
Intval of the val: -641959725
And of the val: -641959725 
```

在 64 位机器上它返回（这是正确的）：

```
Php max int: 2147483647
The Val: -3653007571
Intval of the val: -3653007571
And of the val: -641959725 
```

**解决方案**

无论如何，我需要一个可以在所有这些平台上工作的解决方案，并且不依赖于使用特定 Max int 编译的特定 PHP 版本的怪癖。因此，我想出了以下跨 PHP 的 ttyTwoBitIntval 函数：

```
function thirtyTwoBitIntval($value)
{
    if ($value < -2147483648)
    {
        return -(-($value) & 0xffffffff);
    }
    elseif ($value > 2147483647)
    {
        return ($value & 0xffffffff);
    }
    return $value;
} 
```

*评论*

我确实认为 PHP 的设计者应该说一个 Int 是一个 32 位 Int，无论它是在 32 位、64 位还是 128 位机器上运行（例如 DotNet CLR），并且没有将它随机上转换为浮动取决于 PHP 在编译器下的位数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-01-23T14:27:36.293

如果您想在 32 位和 64 位平台上都有 32 位整数的 100% 工作解决方案，那么我建议您使用以下解决方案：

```
function intval32bits($value)
{
    $value = ($value & 0xFFFFFFFF);

    if ($value & 0x80000000)
        $value = -((~$value & 0xFFFFFFFF) + 1);

    return $value;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T02:39:54.943

在内部，PHP 对大多数数字使用“整数”类型。然而，这些只是到目前为止：如果你将一个大整数添加到一个大整数，PHP 将看到结果太大而无法放入一个普通整数，并将其分配给一个浮点数。然而，浮点数 (floats) 本身只会变得如此之高，并且在 16 位标记附近有一个点，PHP 将完全失去情节。

有一个选项可以使用任意精度数学，它*支持任意大小和精度的数字，表示为 strings*。在这里查看更多信息：http: [//us2.php.net/bc](http://us2.php.net/bc)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-19T02:34:30.150

我认为这可能与 PHP 中的整数是无符号 32 位有关，因为在 C# 中它们默认为有符号 32 位。

您正在使用正常 31-32 位范围边缘的数字。

请参阅 PHP 手册中的其他文档：

[http://www.php.net/manual/en/language.types.integer.php](http://www.php.net/manual/en/language.types.integer.php)

整数的大小取决于平台，尽管通常值约为 20 亿的最大值（即 32 位有符号）。PHP 不支持无符号整数。自 PHP 4.4.0 和 PHP 5.0.5 起，可以使用常量 PHP_INT_SIZE 确定整数大小，使用常量 PHP_INT_MAX 确定最大值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-19T02:36:43.733

这行得通吗？

```
echo (-1580033017 + -2072974554) & 0xffffffff 
```

概括地说，您可以这样做（请原谅任何语法错误，我很长时间没有接触过 PHP）：

```
function s32add($a, $b) {
    return ($a + $b) & 0xffffffff;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T03:22:15.280

检查您的 PHP 版本号 - 我相信您可能会使用不同版本的 PHP 获得不同的结果，这些版本可能对长整数有不同的支持。我相信最后一个 PHP 5 版本中存在长整数错误。

在 PHP 5.2.0 版本中 - 答案与 C# 中的答案完全相同

1617621783,

利用上面的确切功能。

您可以使用**phpinfo()**命令轻松找到您的版本号。

```
$x1 = -1580033017; 
$x2 = -2072974554; 
$x3 = -1170476976 ; 
$x4 = -1007518822;
echo f($x1, $x2, $x3, $x4);

function f($x1, $x2, $x3, $x4)
{
   return intval(intval(intval($x1 + $x2) ^ $x3) + $x4);
} 
```

# asp.net - 如何在 ASP.NET 中全局设置日期格式？

> ID：300841
> 
> 赞同：63
> 
> 时间：2008-11-19T02:26:54.330
> 
> 标签：asp.net, date-format

如何在 ASP.NET 中全局设置日期格式？

我的本地机器和服务器将区域设置设置为“英语（新西兰）”。

例如，当我格式化日期时，`dd/MM/yyyy`我希望看到`19/11/2008`今天。

直到最近，这实际上是我从本地机器和服务器中得到的。

就在最近，由于某种神秘的原因，我们的本地机器发生了如此细微的变化。尽管仍设置为“英语（新西兰）”，但日期分隔符已从`/`变为`-`！在仍然显示“英语（新西兰）”和`/`日期分隔符的服务器上没有发生相同的更改。

`dd/MM/yyyy`所以现在对于我的本地机器，对于我得到的格式`19-11-2008`而不是`19/11/2008`.

这有点令人不安。

到目前为止，我能看到的唯一解决方法是转义斜杠并将格式设置为`dd\/MM\/yyyy`. 它似乎有效，但似乎不是理想的解决方案。

有人可以帮忙吗？

注意：这是针对 Intranet 应用程序的，我不关心真正的全球化。我只想修复日期格式而不是让它改变我。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-11-19T02:35:14.250

您可以在 Global.asax 文件中更改当前线程文化，并覆盖日期格式，例如：

```
using System.Globalization;
using System.Threading;

//...
protected void Application_BeginRequest(Object sender, EventArgs e)
{    
  CultureInfo newCulture = (CultureInfo) System.Threading.Thread.CurrentThread.CurrentCulture.Clone();
  newCulture.DateTimeFormat.ShortDatePattern = "dd-MMM-yyyy";
  newCulture.DateTimeFormat.DateSeparator = "-";
  Thread.CurrentThread.CurrentCulture = newCulture;
} 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-05-08T00:47:45.803

[在 web.config 中，按照以下文档](http://msdn.microsoft.com/en-us/library/vstudio/hy4kkhe0%28v=vs.100%29.aspx)设置标签

```
<system.web>
    <globalization  culture="en-NZ"  uiCulture="en-NZ"/>
</system.web> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-11-06T02:18:29.227

一个好办法是配置Web.Config，日期格式出现在一个aspx的所有组件中

```
<system.web>    
<globalization uiCulture="en" culture="en-NZ" />
</system.web> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-19T03:03:21.463

您可以在不进行任何操作的情况下设置您的文化：

```
 using System.Globalization;
using System.Threading;

//...
protected void Application_BeginRequest(Object sender, EventArgs e)
{

  Thread.CurrentThread.CurrentCulture = Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-NZ");
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-02-01T10:11:25.713

这是一篇旧帖子，但我认为在这里提及它可能很有用，我的问题类似于 OP 所要求的，但解决方案是在 IIS 中更改了文化，而不是从控制面板更改。

IIS 有自己的文化选择，默认情况下将遵循本地计算机文化。但由于某种原因，它变成了一种不同的文化，我开始得到那些奇怪的日期格式。

[你可以在这里](https://stackoverflow.com/questions/6484053/how-to-set-date-and-time-format-in-iis-7)寻找更多的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T03:15:18.647

对于格式字符串，格式字符 / 实际上并不像您期望的那样解析为文字“/”。相反，它会解析为您在区域设置中配置的当前日期时间分隔符。尝试更改 DateTimeFormatInfo.DateSeparator 属性。

有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# icalendar - ics (iCal) 文件的 HTML 查看器

> ID：300849
> 
> 赞同：37
> 
> 时间：2008-11-19T02:31:19.563
> 
> 标签：icalendar

我正在 ASP.NET MVC 中创建一个小应用程序，它根据某些标准生成 ics (iCal) 文件。生成的文件可通过永久 URL ( [http://myserver/some/criterias.ics](http://myserver/some/criterias.ics) ) 访问。

我正在寻找一种在页面上显示日历数据的方法，以便为用户提供生成文件的预览。理想情况下，我希望在页面中嵌入一个 Google 日历类型的界面。不幸的是，谷歌日历似乎只允许嵌入以前添加到其系统中的日历。

是否有任何免费服务或库可以让我在我的网站上为任意 ics 文件嵌入日历？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-19T04:52:28.670

我找到了[InstantCal](http://instantcal.com/)，它可以满足我的需求。它创建的显示虽然不是那么好。此外，它在 Chrome 中似乎有问题。

我想要类似的东西，界面更简单，更好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T03:22:27.370

有一个用 php 编写的程序，IIRC，做这种事情。

[PHP iCalendar](http://phpicalendar.net/)它被称为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T06:00:39.567

您可以将 .ics 文件导入 Google 日历并在那里查看。昨晚，我从 MS Outlook 中以 CSV 格式导出了一个日历，并将其导入到 Google 日历中，我能够与我的同事分享相同的内容。

该过程虽然在界面上不是很明显。我必须`Other Calenders`在左侧面板上查找该部分，然后单击“设置”。我找到了一个选项，上面写着“导入”，单击该选项后，我可以上传 MS Outlook 导出的 CSV 格式文件，并在 Google 上在线查看日历。

# theory - 替代熵源

> ID：300854
> 
> 赞同：13
> 
> 时间：2008-11-19T02:35:42.173
> 
> 标签：theory, random, entropy

好的，我想这完全是主观的，但我正在考虑随机数生成器的熵源。大多数生成器都是以当前时间播种的，对吗？好吧，我很好奇还有哪些其他来源可以用来生成完全有效的随机（松散定义）数字。

使用多个源（例如时间 + 当前 HDD 寻道时间 [我们在这里太棒了]）一起创建一个比单个源“更随机”的数字吗？来源数量的逻辑限制是什么？多少才真正够？仅仅因为方便才选择时间吗？

如果不允许这种事情，请原谅，但我对来源背后的理论感到好奇。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-19T02:46:07.863

维基百科关于[硬件随机数生成器的](http://en.wikipedia.org/wiki/Hardware_random_number_generator)文章列出了一些有趣的使用物理属性的随机数来源。

我最喜爱的：

*   由连接到 PC 的盖革计数器检测到的核衰变辐射源。
*   光子穿过半透明镜子。互斥事件（反射-传输）被检测并分别与“0”或“1”位值相关联。
*   来自电阻器的热噪声，经过放大以提供随机电压源。
*   **雪崩二极管产生的雪崩噪声。**（多么酷啊？）
*   大气噪声，由连接到 PC 的无线电接收器检测到

维基百科文章的[问题部分](http://en.wikipedia.org/wiki/Hardware_random_number_generator#Problems)还描述了许多这些来源/传感器的脆弱性。随着老化/退化，传感器几乎总是产生递减的随机数。这些物理来源应通过统计测试不断检查，可以分析生成的数据，确保仪器没有无声无息地损坏。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-19T02:53:44.277

SGI 曾经使用熔岩灯在不同“glob 阶段”的照片作为熵的来源，最终演变成一个名为[LavaRnd](http://www.lavarnd.org/index.html)的开源随机数生成器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-19T02:55:08.907

我使用[Random.ORG](http://www.random.org/integers/)，它们提供来自大气噪声的免费随机数据，我用它来定期重新播种 Mersene-Twister RNG。在没有硬件依赖的情况下，它几乎是随机的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-19T02:43:10.350

不要担心随机数生成器的“好”种子。序列的统计特性不依赖于生成器的播种方式。然而，还有其他事情。担心。请参阅[随机数生成中的陷阱](http://www.codeproject.com/KB/recipes/pitfalls_random_number.aspx)。

对于硬件随机数发生器，这些物理源都需要测量，测量过程存在系统误差。您可能会发现“伪”随机数的质量高于“真实”随机数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T03:06:52.970

Linux 内核使用设备中断时序（鼠标、键盘、硬盘驱动器）来生成熵。维基百科上有一篇关于熵的好[文章。](http://en.wikipedia.org/wiki/Entropy_(computing))

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-19T03:29:16.933

现代 RNG 既检查了附近种子中的相关性，又在播种后运行了数百次迭代。所以，不幸的是，无聊但真实的答案是，它真的无关紧要。

一般来说，使用随机物理过程必须检查它们是否符合均匀分布，否则会被去除。

[在我看来，使用一个很好理解的伪随机数生成器通常会更好。](https://stackoverflow.com/questions/37702/true-random-number-generator#37862)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-19T03:14:30.367

我使用了一个加密程序，该程序使用用户鼠标移动来生成随机数。唯一的问题是程序必须暂停并要求用户随机移动鼠标几秒钟才能正常工作，这可能并不总是可行的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-19T03:20:22.303

几年前我发现了[HotBits——这些数字是由放射性衰变产生的，真正的](http://www.fourmilab.ch/hotbits/)*随机*数字。

每天可以下载多少个数字是有限制的，但我总是很开心将这些用作 RNG 的真正随机种子。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-19T19:22:15.467

一些 TPM（可信平台模块）“芯片”具有硬件 RNG。不幸的是，我的戴尔笔记本电脑中的 (Broadcom) TPM 缺少此功能，但今天出售的许多计算机都配备了使用真正不可预测的量子力学过程的硬件 RNG。英特尔已经实施了热噪声种类。

此外，不要单独使用当前时间来为 RNG 播种用于加密目的或任何对不可预测性很重要的应用程序。将当时的一些低阶位与其他几个来源结合使用可能是可以的。

类似的[问题](https://stackoverflow.com/questions/203382/do-stateless-random-number-generators-exist)可能对您有用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-18T01:33:51.023

抱歉，我迟到了这个讨论（现在 3 1/2 岁是什么？），但我重新燃起了对 PRN 生成和熵的替代来源的兴趣。Linux 内核开发人员 Rusty Russell 最近在他的[博客](http://rusty.ozlabs.org/?p=265)上讨论了熵的替代来源（除了`/dev/urandom`）。

但是，他的选择给我留下了深刻的印象。NIC 的 MAC 地址永远不会改变（尽管它与其他所有地址不同），并且 PID 似乎可能的样本量太小。

我涉足了一个[Mersenne Twister](https://stackoverflow.com/search?q=mersenne+twister&submit=search)（在我的 Linux 机器上），它使用以下算法播种。如果有人愿意和感兴趣，我正在征求任何意见/反馈：

1.  在下面创建一个 64 位 + 256 位 * 文件数的数组缓冲区`/proc`。
2.  将时间戳计数器 (TSC) 值放在此缓冲区的前 64 位中。
3.  对于以下每个`/proc`文件，计算 SHA256 和：

    *   `/proc/meminfo`
    *   `/proc/self/maps`
    *   `/proc/self/smaps`
    *   `/proc/interrupts`
    *   `/proc/diskstats`
    *   `/proc/self/stat`

        将每个 256 位哈希值放入 (1) 中创建的数组的自己的区域中。

4.  创建整个缓冲区的 SHA256 哈希。**注意：**我可以（并且可能应该）使用完全独立于 SHA 函数的不同散列函数 - 这种技术已被提议作为针对弱散列函数的“保护措施”。

现在我有 256 位**希望**随机（足够）的熵数据来播种我的 Mersenne Twister。我使用上面的方法来填充 MT 数组的开头（624 个 32 位整数），然后用 MT 作者的代码初始化该数组的其余部分。此外，我*可以*使用不同的散列函数（例如 SHA384、SHA512），但我需要不同大小的数组缓冲区（显然）。

最初的 Mersenne Twister 代码需要一个 32 位种子，但我觉得这非常不合适。“仅仅”运行 2^32-1 个不同的 MT 来寻找破解加密货币在当今时代并没有超出实际可能性的范围。

我很乐意阅读任何人对此的反馈。批评是非常受欢迎的。我将捍卫我对上述`/proc`文件的使用，因为它们在不断变化（尤其是`/proc/self/*`文件，并且 TSC 总是产生不同的值（纳秒 [或更好] 分辨率，IIRC）。我已经对此进行了顽固的[测试](http://en.wikipedia.org/wiki/Diehard_tests)（到几**千亿**比特的曲调），它似乎正在以优异的成绩通过。但这可能更多地证明了 Mersenne Twister 作为 PRNG 的稳健性，而不是我如何播种它。

当然，这些并不是**完全**不受黑客攻击的影响，但我只是没有看到所有这些（和 SHA*）在我的有生之年被黑客攻击*和*破坏。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-19T02:44:12.003

有些使用键盘输入（按键之间的超时），我听说我在小说中认为可以使用无线电静态接收 - 但当然这需要其他硬件和软件......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-19T19:40:35.337

宇宙微波背景光谱顶部的噪声。当然，您必须首先去除一些各向异性、前景物体、相关探测器噪声、星系和局部群速度、极化等。[仍然存在许多陷阱](http://arxiv.org/abs/astro-ph/0703806)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-07T14:59:08.873

> 不要担心随机数生成器的“好”种子。序列的统计特性不依赖于生成器的播种方式。

我不同意[John D. Cook 的建议](https://stackoverflow.com/a/300864/366904)。如果您将 Mersenne Twister 的种子设置为除 1 之外的所有位都设置为 0，它最初会生成非随机的数字。生成器需要很长时间才能将这种状态转化为可以通过统计测试的任何东西。简单地将生成器的前 32 位设置为种子将产生类似的效果。此外，如果整个状态设置为零，则生成器将产生无穷无尽的零。

正确编写的 RNG 代码将具有正确编写的种子算法，该算法接受 64 位值并种子生成器，因此它将为每个可能的输入生成合适的随机数。因此，如果您使用的是可靠的库，那么任何种子都可以。但是，如果您将自己的实现组合在一起，那么您需要小心。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-07T15:40:33.983

种子的来源并不那么重要。更重要的是伪数生成器算法。然而，我前段时间听说过为一些银行业务生成种子。他们综合考虑了许多因素：

*   时间
*   处理器温度
*   风扇转速
*   中央处理器电压
*   我不记得更多了：）

即使其中一些参数没有及时改变，您也可以将它们放入一些好的散列函数中。

**如何生成好的随机数？**

也许我们可以考虑无限数量的宇宙？如果这是真的，新的平行宇宙一直在被创造，我们可以这样做：

```
int Random() {
    return Universe.object_id % MAX_INT;
} 
```

每时每刻我们都应该在平行宇宙的另一个分支上，所以我们应该有不同的身份。唯一的问题是如何获取 Universe 对象:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-09T23:35:09.560

如何在一个固定的时间内关闭一个线程，该线程将在一个紧密的循环中操纵一些变量，然后再被杀死。您最终得到的结果将取决于处理器速度、系统负载等...非常老套，但比 srand(time(NULL)) 更好...

# javascript - 用于 TDD 的 JavaScript 单元测试工具

> ID：300855
> 
> 赞同：716
> 
> 时间：2008-11-19T02:35:49.913
> 
> 标签：javascript, unit-testing, tdd

我研究并考虑了许多 JavaScript 单元测试和测试工具，但一直找不到合适的选项来保持完全符合 TDD 的要求。那么，是否有完全符合 TDD 的 JavaScript 单元测试工具？

* * *

## 回答 #1

> 赞同：1517
> 
> 时间：2009-03-25T08:44:55.243

## [业力](http://karma-runner.github.io)或[量角器](http://angular.github.io/protractor/#/)

Karma 是一个用 Node.js 构建的 JavaScript 测试运行器，用于单元测试。

Protractor 用于端到端测试，并使用 Selenium Web Driver 来驱动测试。

两者都是由 Angular 团队制作的。你可以使用任何你想要的断言库。

截屏视频：[Karma 入门](http://www.youtube.com/watch?v=MVw8N3hTfCI)

**相关**：

*   [我应该使用 Protractor 还是 Karma 进行端到端测试？](https://stackoverflow.com/questions/21732379/should-i-be-using-protractor-or-karma-for-my-end-to-end-testing/21733114#21733114)
*   [Protractor 和 Karma 可以一起使用吗？](https://stackoverflow.com/questions/17070522/can-protractor-and-karma-be-used-together)

**优点**：

*   使用 node.js，因此与 Win/OS X/Linux 兼容
*   使用 PhantomJS 从浏览器或无头运行测试
*   一次在多个客户端上运行
*   启动、捕获和自动关闭浏览器的选项
*   在开发计算机上或单独运行服务器/客户端的选项
*   从命令行运行测试（可以集成到 ant/maven 中）
*   编写测试 xUnit 或 BDD 风格
*   支持多种 JavaScript 测试框架
*   保存时自动运行测试
*   代理请求跨域
*   可定制：
    *   扩展它以包装其他测试框架（Jasmine、Mocha、QUnit 内置）
    *   你自己的断言/反驳
    *   记者
    *   浏览器启动器
*   WebStorm 插件
*   受 Netbeans IDE 支持

**缺点**：

*   不[支持 NodeJS（即后端）](https://stackoverflow.com/a/16660909/1175496)测试
*   没有适用于 Eclipse 的插件（还没有）
*   没有以前的测试结果的历史

# [mocha.js](http://mochajs.org)

我完全没有资格评论 mocha.js 的特性、优势和劣势，但它只是由我在 JS 社区中信任的人推荐给我的。

其网站报告的功能列表：

*   浏览器支持
*   简单的异步支持，包括 Promise
*   测试覆盖率报告
*   字符串差异支持
*   javascript # 用于运行测试的 API
*   CI支持等的正确退出状态
*   自动检测并禁用非 tty 的着色
*   将未捕获的异常映射到正确的测试用例
*   异步测试超时支持
*   特定于测试的超时
*   咆哮通知支持
*   报告测试持续时间
*   突出慢速测试
*   文件观察器支持
*   全局变量泄漏检测
*   可选地运行与正则表达式匹配的测试
*   自动退出以防止活动循环“挂起”
*   轻松元生成套件和测试用例
*   mocha.opts 文件支持
*   可点击的套件标题以过滤测试执行
*   节点调试器支持
*   检测到对 done() 的多次调用
*   使用任何你想要的断言库
*   可扩展的报告，与 9 个以上的报告器捆绑在一起
*   可扩展的测试 DSL 或“接口”
*   之前，之后，之前，每个钩子之后
*   任意转译器支持（咖啡脚本等）
*   文本伴侣包

## [约尔波](http://www.yolpo.com)

![约尔波](https://i.imgur.com/5HKEWSW.png)

> 这不再存在，而是重定向到[sequential.js](https://sequential.js.org)

Yolpo 是一个可视化 javascript 执行的工具。鼓励 Javascript API 开发人员编写他们的用例来展示和讲述他们的 API。这样的用例构成了回归测试的基础。

## [艾娃](https://github.com/sindresorhus/ava)

[![AVA 徽标](https://i.stack.imgur.com/43HiK.png)](https://github.com/sindresorhus/ava)

内置支持 ES2015 的未来派测试运行器。尽管 JavaScript 是单线程的，但 Node.js 中的 IO 由于其异步特性而可以并行发生。AVA 利用这一点并同时运行您的测试，这对于 IO 繁重的测试特别有用。此外，测试文件作为单独的进程并行运行，为每个测试文件提供更好的性能和隔离环境。

*   最小和快速
*   简单的测试语法
*   同时运行测试
*   强制编写原子测试
*   没有隐式全局变量
*   每个测试文件的隔离环境
*   在 ES2015 中编写测试
*   承诺支持
*   生成器功能支持
*   异步功能支持
*   可观察的支持
*   增强的断言
*   可选的 TAP 输出
*   清理堆栈跟踪

## [Buster.js](http://busterjs.org/)

使用 Node.js 构建的 JavaScript 测试运行器。非常模块化和灵活。它带有自己的断言库，但您可以根据需要添加自己的断言库。[断言库](http://docs.busterjs.org/en/latest/modules/referee/)是解耦的，因此您也可以将它与其他测试运行器一起使用。而不是使用`assert(!...)`or `expect(...).not...`，它使用`refute(...)`which 是一个很好的转折恕我直言。

> 浏览器 JavaScript 测试工具包。它使用浏览器自动化进行浏览器测试（想想 JsTestDriver）、QUnit 风格的静态 HTML 页面测试、无头浏览器中的测试（PhantomJS、jsdom、...）等等。看看[概述](http://docs.busterjs.org/en/latest/overview/)！
> 
> 一个 Node.js 测试工具包。您将获得相同的测试用例库、断言库等。这对于混合浏览器和 Node.js 代码也非常有用。使用 Buster.JS 编写测试用例，并在 Node.js 和真实浏览器中运行它。

截屏视频：[Buster.js 入门](http://www.youtube.com/watch?v=VSFGAl1BekY)(2:45)

**优点**：

*   使用 node.js，因此与 Win/OS X/Linux 兼容
*   使用 PhantomJS 从浏览器或无头运行测试（很快）
*   一次在多个客户端上运行
*   支持 NodeJS 测试
*   不需要在开发计算机上运行服务器/客户端（不需要 IE）
*   从命令行运行测试（可以集成到 ant/maven 中）
*   编写测试 xUnit 或 BDD 风格
*   支持多种 JavaScript 测试框架
*   推迟测试而不是注释掉它们
*   内置SinonJS
*   [保存时自动运行测试](http://www.youtube.com/watch?v=gKVej9SAzH4)
*   代理请求跨域
*   可定制：
    *   扩展它以包装其他测试框架（内置 JsTestDriver）
    *   你自己的断言/反驳
    *   Reporters（xUnit XML、传统点、规范、tap、TeamCity 等内置）
    *   自定义/替换用于运行浏览器测试的 HTML
*   TextMate 和 Emacs 集成

**缺点**：

*   仍处于测试阶段，所以可能是错误的
*   没有适用于 Eclipse/IntelliJ 的插件（还没有）
*   不会像 TestSwarm * 那样按操作系统/浏览器/版本对结果进行分组。但是，它会在测试结果中打印出浏览器名称和版本。
*   没有以前测试结果的历史记录，例如 TestSwarm *
*   [截至 2014 年 5 月，](http://docs.busterjs.org/en/latest/developers/windows/)无法在 Windows 上完全运行

* TestSwarm 也是一个持续集成服务器，而 Buster.js 需要一个单独的 CI 服务器。然而，它确实输出 xUnit XML 报告，因此它应该很容易与[Hudson](http://hudson-ci.org/)、[Bamboo](http://www.atlassian.com/software/bamboo/overview)或其他 CI 服务器集成。

## [测试群](https://github.com/jquery/testswarm/)

[https://github.com/jquery/testswarm](https://github.com/jquery/testswarm)

如其 GitHub 网页上所述，TestSwarm 正式不再处于积极开发中。他们推荐 Karma、browserstack-runner 或 Intern。

## [茉莉花](https://github.com/pivotal/jasmine/)

![茉莉花](https://jasmine.github.io/images/jasmine-purple-horizontal.svg)

这是一个行为驱动的框架（如下面的引文所述），熟悉 Ruby 或 Ruby on Rails 的开发人员可能会对它感兴趣。该语法基于用于在 Rails 项目中进行测试的[RSpec 。](http://rspec.info/)

Jasmine 规范可以从 html 页面（以 qUnit 方式）或从测试运行器（作为 Karma）运行。

> Jasmine 是一个行为驱动的开发框架，用于测试您的 JavaScript 代码。它不依赖于任何其他 JavaScript 框架。它不需要 DOM。

如果您有使用此测试框架的经验，请提供更多信息 :)

项目主页：http: [//jasmine.github.io/](https://github.com/pivotal/jasmine/)

## [QUnit](http://qunitjs.com/)

QUnit 专注于在浏览器中测试 JavaScript，同时为开发人员提供尽可能多的便利。来自网站的简介：

> QUnit 是一个功能强大、易于使用的 JavaScript 单元测试套件。它被 jQuery、jQuery UI 和 jQuery Mobile 项目使用，并且能够测试任何通用 JavaScript 代码

QUnit 与 TestSwarm 分享了一些历史（上图）：

> QUnit 最初是由 John Resig 作为 jQuery 的一部分开发的。2008 年，它有了自己的主页、名称和 API 文档，允许其他人也可以使用它进行单元测试。当时它仍然依赖于 jQuery。2009 年的重写修复了这个问题，现在 QUnit 完全独立运行。QUnit 的断言方法遵循 CommonJS 单元测试规范，这在一定程度上受到了 QUnit 的影响。

项目主页：http: [//qunitjs.com/](http://qunitjs.com/)

## [诗乃](http://sinonjs.org)

另一个很棒的工具是由[Test-Driven JavaScript Development](http://tddjs.com/)的作者 Christian Johansen 编写的[sinon.js](http://sinonjs.org)。最好由他自己描述：

> JavaScript 的独立测试间谍、存根和模拟。没有依赖项适用于任何单元测试框架。

## [实习生](http://theintern.io)

[Intern 网站](http://theintern.io/#compare)提供了与此列表中其他测试框架的直接功能比较。它提供了比任何其他基于 JavaScript 的测试系统更多的开箱即用功能。

## [笑话](https://jestjs.io/)

一个新的但非常强大的测试框架。它还允许基于快照的测试，这提高了测试速度并在测试方面创造了新的动态

查看他们的演讲之一：[https ://www.youtube.com/watch?v=cAKYQpTC7MA](https://www.youtube.com/watch?v=cAKYQpTC7MA)

更好的是：[入门](https://jestjs.io/docs/en/getting-started.html)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-11-19T03:32:01.407

看看[Dojo Object Harness (DOH) 单元测试框架](http://www.dojotoolkit.org/reference-guide/util/doh.html)，它几乎是用于 JavaScript 单元测试的框架独立工具，并且没有任何 Dojo 依赖项。[在Unit testing Web 2.0 applications using the Dojo Objective Harness](http://www.ibm.com/developerworks/web/library/wa-aj-doh/index.html)中有很好的描述。

如果您想自动化 UI 测试（许多开发人员的痛点）——请查看[doh.robot](http://dojotoolkit.org/2008/08/11/doh-robot-automating-web-ui-unit-tests-real-user-events) *（暂时关闭。更新：其他链接[http://dojotoolkit.org/reference-guide/util/dohrobot.html](http://dojotoolkit.org/reference-guide/util/dohrobot.html)）*和[dijit .robotx](http://blog.dojotoolkit.org/2008/10/31/doh-robot-part-2-automating-acceptance-tests-and-user-stories) *（暂时停机）*。后者是为验收测试而设计的。更新：

参考文章解释了如何使用它们，如何模拟用户使用鼠标和/或键盘与您的 UI 交互，以及如何记录测试会话，以便您以后可以自动“播放”它。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2011-06-24T18:44:32.273

## [Chutzpah - JavaScript 测试运行器](https://github.com/mmanela/chutzpah)

我创建了一个名为 Chutzpah 的开源项目，它是 JavaScript 单元测试的测试运行器。Chutzpah 使您能够从命令行和 Visual Studio 内部运行 JavaScript 单元测试。它还支持在 TeamCity 持续集成服务器中运行。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-06-01T18:07:42.467

Wikipedia 条目的 JavaScript 部分[List of Unit Testing Frameworks](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#JavaScript)提供了可用选项的列表。它指示它们是在客户端、服务器端还是两者都工作。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-02-08T21:52:15.667

# 巴斯特JS

还有来自 Test Driven Javascript Development 和 Sinon 框架的作者 Christian Johansen 的[BusterJS](http://busterjs.org/)。从网站：

> Buster.JS 是一个新的 JavaScript 测试框架。它通过在实际浏览器中自动运行测试（想想 JsTestDriver）以及 Node.js 测试来进行浏览器测试。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-10-05T10:59:54.817

### 谷歌-js-测试：

谷歌发布的 JavaScript 测试框架： [https ://github.com/google/gjstest](https://github.com/google/gjstest)

> *   极快的测试启动和执行时间，无需运行浏览器。
> *   在通过和失败测试的情况下，干净、可读的输出。
> *   一个[基于浏览器的测试运行器](https://github.com/google/gjstest/wiki/Frequently-asked-questions)，只要 JS 更改就可以简单地刷新。
> *   类似于[Google Test](http://code.google.com/p/googletest/) for C++ 的样式和语义。
> *   一个内置的模拟框架，需要最少的样板代码（例如 no `$tearDown`或`$verifyAll`），具有基于[Google C++ Mocking Framework](http://code.google.com/p/googlemock/)的样式和语义。

目前没有适用于 Windows 的二进制文件

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-12-08T20:33:29.117

我们现在将 Qunit 与 Pavlov 和 JSTestDriver 一起使用。这种方法对我们很有效。

[QUnit](http://qunitjs.com/)

[巴甫洛夫](http://www.elijahmanor.com/bdd-style-qunit-testing-asp-net-mvcs-jquery-validation/)_ [_](https://github.com/mmonteleone/pavlov)

[jsTestDriver](http://slmoloch.blogspot.com/2009/08/how-to-run-jstestdriver-with-visual_02.html) ,[源码](http://code.google.com/p/js-test-driver/)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-19T06:11:18.900

作为专业人士，您“在实际浏览器上运行”，但根据我的经验，这是一个缺点，因为它很慢。但它的价值在于非浏览器替代品缺乏足够的 JS 仿真。可能是如果您的 JS 足够复杂，只需要在浏览器中进行测试就足够了，但还有几个选项需要考虑：

[HtmlUnit](http://htmlunit.sourceforge.net/)：“它具有相当好的 JavaScript 支持（不断改进），甚至能够使用非常复杂的 AJAX 库，根据您要使用的配置模拟 Firefox 或 Internet Explorer。” 如果它的仿真对您来说足够好，那么它将比驱动浏览器快得多。

但也许 HtmlUnit 有足够好的 JS 支持但你不喜欢 Java？那么也许：

[Celerity](http://celerity.rubyforge.org/)：在 HtmlUnit 支持的 JRuby 上运行的 Watir API。

或类似的

[Schnell](http://code.google.com/p/schnell-jruby/)：HtmlUnit 的另一个 JRuby 包装器。

当然，如果 HtmlUnit 不够好并且您必须驱动浏览器，那么您可能会考虑[使用 Watir 来驱动您的 JS](http://justaddwater.dk/2007/11/20/how-to-run-javascript-from-watir-scripts/)。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-01-22T14:53:14.043

YUI 也有一个[测试框架](http://yuilibrary.com/projects/yuitest/)。 [这段视频](http://www.yuiblog.com/blog/2010/11/29/video-yuiconf2010-yuitest/)来自雅虎！剧院是一个很好的介绍，尽管前面有很多关于 TDD 的基础知识。

这个框架是通用的，可以针对任何 JavaScript 或 JS 库运行。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-28T19:54:34.183

您可能还对作为[qooxdoo](http://qooxdoo.org)一部分的单元测试框架感兴趣，这是一个类似于 Dojo、ExtJS 等的开源 RIA 框架，但具有相当全面的工具链。

试试[testrunner](http://demo.qooxdoo.org/current/testrunner)的在线版本。提示：点击左上角的灰色箭头（应该更明显）。这是一个运行选定测试的“播放”按钮。

要了解有关让您定义单元测试的 JS 类的更多信息，请参阅在线[API 查看器](http://demo.qooxdoo.org/current/apiviewer/#qx.dev.unit)。

对于自动化 UI 测试（基于 Selenium RC），请查看[Simulator](http://qooxdoo.org/contrib/project/simulator)项目。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-01-10T21:57:35.890

我们在我们的 Java 到 Javascript 代码生成器 ST-JS ( [http://st-js.org](http://st-js.sourceforge.net) ) 中添加了 JUnit 集成。该框架为测试代码和单元测试生成相应的 Javascript，并将代码发送到不同的浏览器。

不需要单独的服务器，因为单元测试运行程序会打开所需的 http 端口（并在测试完成后关闭它）。该框架操作 Java 堆栈跟踪，以便 JUnit Eclipse 插件正确显示失败的断言。这是一个使用 jQuery 和 Mockjax 的简单示例：

```
@RunWith(STJSTestDriverRunner.class)
@HTMLFixture("<div id='fortune'></div>")

@Scripts({ "classpath://jquery.js",
       "classpath://jquery.mockjax.js", "classpath://json2.js" })
public class MockjaxExampleTest {
  @Test
  public void myTest() {
    $.ajaxSetup($map("async", false));
    $.mockjax(new MockjaxOptions() {
      {
        url = "/restful/fortune";
        responseText = new Fortune() {
          {
            status = "success";
            fortune = "Are you a turtle?";
          }
        };
      }
    });

    $.getJSON("/restful/fortune", null, new Callback3<Fortune, String, JQueryXHR>() {
      @Override
      public void $invoke(Fortune response, String p2, JQueryXHR p3) {
        if (response.status.equals("success")) {
          $("#fortune").html("Your fortune is: " + response.fortune);
        } else {
          $("#fortune").html("Things do not look good, no fortune was told");
        }

      }
    });
    assertEquals("Your fortune is: Are you a turtle?", $("#fortune").html());
  }

  private static class Fortune {
    public String status;
    public String fortune;
  }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-12-01T10:33:33.597

你应该看看[env.js](http://groups.google.com/group/envjs)。有关如何使用 env.js 编写单元测试的示例，请参阅[我的博客。](http://blog.pdark.de/2008/11/18/testing-the-impossible-javascript-in-a-web-page/)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-19T10:16:08.190

[MochiKit](http://mochikit.com/)有一个名为 SimpleTest 的测试框架，似乎已经流行起来。这是[原作者的博客文章](http://blog.leosoto.com/2008/10/interesting-open-source-surprises.html)。

# algorithm - 在最接近给定点的圆上找到点的最佳方法

> ID：300871
> 
> 赞同：39
> 
> 时间：2008-11-19T02:49:12.210
> 
> 标签：algorithm, language-agnostic, geometry

给定一个点 (pX, pY) 和一个具有已知中心 (cX,cY) 和半径 (r) 的圆，您可以用最短的代码量找到最接近 (pX, pY) ?

我有一些代码可以工作，但它涉及将圆转换为 (x - cX)^2 + (y - cY)^2 = r^2 形式的方程（其中 r 是半径）并使用方程从点 (pX, pY) 到 (cX, cY) 的直线，以创建要求解的二次方程。

一旦我解决了它会做的错误，但这似乎是一个不雅的解决方案。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-11-19T03:10:31.060

其中 P 是点，C 是中心，R 是半径，使用合适的“数学”语言：

```
V = (P - C); Answer = C + V / |V| * R; 
```

其中|V| 是 V 的长度。

好的好的

```
double vX = pX - cX;
double vY = pY - cY;
double magV = sqrt(vX*vX + vY*vY);
double aX = cX + vX / magV * R;
double aY = cY + vY / magV * R; 
```

易于扩展到 >2 维。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T02:56:23.380

我会从中心到点画一条线，然后计算该图穿过圆圈的位置 oO 我认为并不难

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T03:06:49.210

先用数学方法求解，然后转化为代码。请记住，点和圆边缘之间的最短线也将通过其中心（如@litb 所述）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-31T00:08:46.770

1.  最短距离点位于通过中心和输入点的圆周和直线的交点处。中心点、输入点和输出点也位于一条直线上

2.  设中心为 (xc, yc) 和输入 (xi, yi) 的最短点为 (x,y) 然后 sqrt((xc-x)^2 + (yc-y)^2) = r

3.  由于中心点、输入点和输出点位于一条直线上，因此在其中任何两个点之间计算的斜率应该相同。

(yc-yi)/(xc-xi) = (y-yc)/(x-xc)

4.求解方程 2 和 3 应该给我们最短的点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T02:52:42.127

Trig 函数，乘以 r，并根据需要添加 pX 或 pY。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T03:09:02.327

将圆的中心视为原点，将 (pX, pY) 的坐标转换为极坐标， (theta, r') 将 r' 替换为原始圆的 r 并转换回笛卡尔坐标 (并调整原点）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-19T04:02:30.097

您要求最短的代码，所以在这里。可以在四行中完成，尽管仍然存在二次方。我认为该点在圆圈之外。我没有考虑如果该点直接位于圆心上方或下方会发生什么，即 cX=pX。

```
m=(cY-pY)/(cX-pX);  //slope
b=cY-m*cX;  //or Py-m*Px.  Now you have a line in the form y=m*x+b
X=(  (2mcY)*((-2*m*cY)^2-4*(cY^2+cX^2-b^2-2*b*cY-r^2)*(-1-m^2))^(1/2)  )/(2*(cY^2+cX^2-b^2-2*bc*Y-r^2));
Y=mX+b; 
```

1] 得到连接点和圆心的直线方程。

2] 沿直线移动距离中心一半径的距离，以找到圆上的点。即：radius=a^2+b^2 即：r=((cY-Y)+(cX-X))^(1/2)

3] 二次求解。X=quadratic_solver(r=((cY-Y)+(cX-X))^(1/2),X) 如果你用 Y=m*X+b 代替，你会得到上面的地狱。

4] X 和 Y 是你在圆圈上的结果。

我很确定我在某处犯了错误，如果有人发现了什么，请发表评论。当然它是退化的，一个答案离你的观点最远，另一个离你最近。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-19T04:22:40.227

用图片来思考它的简单方法，并且很容易变成代码：从中心到点取向量（pX - cX，pY - cY）。除以它的长度 sqrt(blah blah blah)，乘以半径。将此添加到（cX，cY）。

# javascript - 您可以在 YUI 数据表的每个单元格中呈现任意 HTML 吗？

> ID：300895
> 
> 赞同：1
> 
> 时间：2008-11-19T03:12:31.803
> 
> 标签：javascript, yui

我想将分页表添加到页面。它应该是 2 行乘 4 列。每个单元格都包含一个缩略图和一些小链接。

我们在项目的其他地方使用 YUI，所以我想使用 Datatable。我看到的所有示例都围绕表格数据（可以理解），但我的直觉是我可以使用 Javascript 重写每个单元格的 HTML。我没有看到我应该挂钩来重写单元格的回调函数。

可能的？还是我想用螺丝刀敲钉子？如果有更简单的方法可以用 YUI 做到这一点，我很想听听。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T20:31:03.550

库珀，

要对图像/文本元素的简单网格进行分页，我几乎希望看到您在不使用 DataTable 的情况下使用 Paginator。DataTable 是一个功能强大的组件，但它正在努力做很多你不需要的东西。

另一方面，轮播 ( [http://developer.yahoo.com/yui/carousel/](http://developer.yahoo.com/yui/carousel/) ) 似乎正试图成为您想要的。 例如，[http://developer.yahoo.com/yui/examples/carousel/csl_imagentext.html可能是一个不错的起点。](http://developer.yahoo.com/yui/examples/carousel/csl_imagentext.html)

如果这不是您想要的，您绝对可以使用 DataTable 执行此操作。只需为每个单元格创建要使用的标记片段，将它们存储在数组中，然后按照使用数组数据源和分页的说明进行操作。

问候， 埃里克

# algorithm - 按求和算法对数字进行排序

> ID：300907
> 
> 赞同：7
> 
> 时间：2008-11-19T03:23:42.140
> 
> 标签：algorithm, language-agnostic, math

我有一个关于算法的与语言无关的问题。

这来自我读过的一个（可能很简单的）编程挑战。问题是，我太愚蠢了，无法弄清楚，而且很好奇它正在困扰着我。

目标是通过交换列表中数字的位置来对整数列表进行升序排序。每次交换两个数字时，您都必须将它们的总和添加到运行总数中。挑战是生成具有最小可能运行总数的排序列表。例子：

```
3 2 1 - 4
1 8 9 7 6 - 41
8 4 5 3 2 7 - 34 
```

尽管您可以根据需要随意给出答案，但如果您宁愿在正确的方向上提供“提示”（如果可能的话），我更愿意这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-19T05:36:31.157

只阅读前两段是你想要的提示。对此有一个有效的解决方案（当然，除非我犯了错误）。首先对列表进行排序。现在我们可以将原始列表写成不相交循环的产品列表。

例如 5,3,4,2,1 有两个循环，(5,1) 和 (3,4,2)。循环可以认为是从 3 开始，4 在 3 的位置，2 在 4 的位置，4 在 3 的位置。点。最终目标是 1,2,3,4,5 或 (1)(2)(3)(4)(5)，五个不相交的循环。

如果我们从不同的循环切换两个元素，比如 1 和 3，那么我们得到：5,1,4,2,3 和循环表示法 (1,5,3,4,2)。这两个循环合为一个循环，这与我们想要做的相反。

如果我们从同一个循环中切换两个元素，比如 3 和 4，那么我们得到：循环符号 (5,1)(2,4)(3) 中的 5,4,3,2,1。一个周期分为两个较小的周期。这使我们更接近所有长度为 1 的循环的目标。请注意，同一循环中两个元素的任何切换都会将该循环分成两个循环。

如果我们能找出切换一个循环的最佳算法，我们就可以将其应用于所有循环，并获得整个排序的最佳算法。一种算法是取循环中的最小元素并将其与它所在的位置进行切换。因此，对于 (3,4,2)，我们将 2 与 4 切换。这留下了一个长度为 1 的循环（元素刚刚切换到正确的位置）和一个比以前小一号的循环。然后我们可以再次应用该规则。该算法切换最小元素周期长度 -1 次，每隔一个元素切换一次。

要将长度为 n 的循环转换为长度为 1 的循环需要 n - 1 次操作。每个元素必须至少操作一次（考虑每个要排序的元素，它必须移动到正确的位置）。我提出的算法对每个元素执行一次，所有算法都必须这样做，然后其他所有操作都对最小元素执行。没有算法可以做得更好。

该算法需要 O(n log n) 进行排序，然后 O(n) 来处理循环。解决一个周期需要 O（周期长度），所有周期的总长度为 n，因此周期操作的成本为 O（n）。最终运行时间为 O(n log n)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T04:15:45.110

我假设内存是空闲的，您可以在对真实对象执行排序之前模拟排序。

一种方法（可能不是最快的）是维护优先级队列。队列中的每个节点都以到达那里的交换成本为键，它包含当前项目排序和实现该排序的步骤序列。例如，最初它将包含一个具有原始数据排序且没有步骤的 0 成本节点。

运行一个循环，使成本最低的队列项目出队，并从该点开始将所有可能的单交换步骤入队。继续运行循环，直到队列的头部有一个排序列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T05:03:41.283

我尝试手动解决其中一个示例：

*   1 8 9 7 6
*   6 8 9 7 1 (+6+1=7)
*   6 8 1 7 9 (7+1+9=17)
*   6 8 7 1 9 (17+1+7=25)
*   6 1 7 8 9 (25+1+8=34)
*   1 6 7 8 9 (34+1+6=41)

由于您需要替换 1，看来您可能必须进行详尽的搜索才能完成问题 - 其他用户已经发布了该问题的详细信息。请注意，如果数据集很大，则在执行此方法时会遇到问题。

如果问题允许“关闭”答案，您可以简单地制作一个贪心算法，将最大的项目放置到位 - 直接这样做，或者首先将最小的元素交换到该插槽中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T04:03:27.613

比较和遍历显然是免费的，您可以预先计算一个数字必须经过的“距离”（实际上是最终的排序顺序）。难题是交换算法。

最小化整体掉期显然很重要。最大程度地减少掉期也很重要。

我很确定不能通过以无状态方式评估每个排序来保证最佳交换过程，尽管您可能经常接近（不是挑战）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T04:40:39.630

我认为这个问题没有简单的解决方案，我的方法可能并不比优先队列方法好。

找到最小的数字 N。除了 N 之外，任何占据彼此所需位置的数字对都应交换。组装（通过蛮力）可以相互交换到所需位置的每组数字的集合，例如对集合进行排序的成本小于将集合中的每个元素与 N 交换的成本。这些集合将包含多个循环。在这些周期内交换，最小的数字交换两次。使用 N 作为占位符交换所有剩余的数字，这些数字构成一个包括 N 的循环。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T03:25:54.397

作为提示，这有动态编程的味道。这可能不是一个足够精确的提示来提供帮助，但我宁愿从太少开始！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-19T03:33:35.053

您按交换次数而不是比较次数付费。你也没有提到因保存其他记录而被收费。

# svn - 查看已删除文件 Svn 的内容

> ID：300911
> 
> 赞同：21
> 
> 时间：2008-11-19T03:27:31.057
> 
> 标签：svn, command-line

对于已删除的文件，用于查看旧修订内容的命令是什么

```
E:\Downloads\eeli\eel\eel>svn cat eel-scalable-font.h -r 2
svn: warning: 'eel-scalable-font.h' is not under version control 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-19T04:36:48.500

您需要使用存储库 URL（不是工作副本），并使用 @rev 语法。就像是：

```
svn cat https://myhost/svn/eeli/eel/eel/eel-scalable-font.h@2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T03:39:39.317

我认为您正在寻找的是：

```
svn cat eel-scalable-font.h@2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-19T04:33:28.397

好的，我知道了。我必须指向存储库而不是工作副本

E:\Downloads\eeld>svn cat file:///E:/​​Downloads/eel/trunk/eel/eel-scalable-font.h@2

# asp.net-mvc - ASP.NET MVC 替代品？

> ID：300925
> 
> 赞同：11
> 
> 时间：2008-11-19T03:38:42.110
> 
> 标签：asp.net-mvc, open-source, webforms

因此，我已经花了足够的时间使用 ASP.NET 网络表单，我知道我几乎宁愿回到使用经典 ASP 而不是使用它们。但在它变得更加成熟之前，我对转向 ASP.NET MVC 犹豫不决。有没有开源替代品？

我正在寻找的主要内容是易于学习并易于启动和运行原型的东西。如果有任何帮助，我的主要偏好是 python“混合和匹配”方法（比如 web.py/SQLAlchemy/任何适合我当时喜欢的模板引擎）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-19T05:38:57.717

在过去的 18 个月里，我们在小型企业的在线商店中使用了[MonoRail](http://www.castleproject.org/projects/monorail) RC2。它取代了 7 年前的经典 ASP 页面灾难。MonoRail RC2 对我们来说效果很好，平均每天处理约 14,000 个页面请求。它使我能够非常快速地开发该网站，而且是免费的，并且运行良好。为此，我感谢 MonoRail 团队。

我刚刚使用了 MonoRail 位。我选择了 iBATIS.NET 而不是 ActiveRecord，因为我必须编写创造性的 SQL 来保持与 7 年历史的数据库的兼容性。所以我不能代表其他一些城堡图书馆。

MonoRail 的一些优点包括：

*   进入那里并进行修改非常容易。例如，默认路由实现在重新路由时不保留查询字符串（出于 SEO 原因，我需要它来保持与现已解散的经典 ASP 站点使用的旧 URL 格式的向后兼容性）并且它不支持发出 HTTP 301该方案的永久重定向标头。所以我实现了任何 MonoRail 接口，将它插入我的配置文件，然后我就走了。
*   它仍然是 ASP.NET，因此您仍然可以使用 Forms Authentication、Codeproject 上非常棒的[HTTP/HTTPS 切换器](http://www.codeproject.com/KB/web-security/WebPageSecurity_v2.aspx)和缓存。
*   惊喜相对较少。在使用它一年多之后，我没有太多天诅咒 MonoRail。这是一个很好的试金石。一些帮助类（FormHelper）的行为可能有点奇怪，向导框架非常奇怪，参数绑定有时会让你陷入循环，但这种情况并不经常发生。
*   视图引擎（模板）的选择。我把它放在这里是因为大多数人似乎认为这里的选择是一件好事，尽管我通常认为它不是。

然而，MonoRail 也不是没有问题：

*   缺乏发展方向。RC2 和 RC3 之间的变化多得离谱；很多受保护的虚拟方法消失了，很多助手发生了变化（当您的视图引擎不是静态类型时，这很重要），甚至单元测试控制器和视图的机制也发生了变化。出于这个原因，我们可能会永远留在 RC2 上。现在 ASP.NET MVC 已经推出，尚不清楚 MonoRail 背后的社区将保持多健康（尽管 ayende 和 hammett 一如既往地热情和活跃）。
*   NVelocity 是 MonoRail 的“事实上的”视图引擎（至少在我们开始开发的时候），是一种很有前途的模板语言，具有不健康的实现和维护前景。（它有效吗？足够好。但是作为 Java 版本的 CTRL+C CTRL+V 端口，不要阅读该库的源代码，因为你的眼睛会流血。）
*   NVelocity 和 RC2 带有一个非常严重的线程错误，多个用户同时访问该站点可能会获得为另一个用户提供的页面。它已在最新版本中修复（由于 Castle 项目的发布性质，很难升级到该版本），我们设法解决了它。但这是一个非常令人不安和意想不到的问题，在 Microsoft 框架上极不可能遇到。买者自负。

MonoRail 在 2007 年 6 月为我们提供了一个极好的机会，它为我们提供了一种将 Microsoft 堆栈上的现有站点迁移到 .NET 平台的方法，从而避免了 WebForms（这对于 Intranet 站点非常有用，但在您需要时就不那么好了在我看来，对面向公众的网站上的 HTML 输出进行细粒度控制）。（好吧，真正的原因是我只是鄙视 WebForms 回发模型。） ASP.NET MVC 在那个时候甚至在微软眼中都没有。

然而，既然 ASP.NET MVC 确实存在，并且鉴于 Microsoft 将其定位为 WebForms 的替代品，我知道我个人将强烈考虑将其用于任何未来的项目。MonoRail 是一个很棒的项目，它为我们提供了很好的服务，我很感谢开源社区的贡献，但我很喜欢它作为一个被大量使用、磨损的工具，它被淘汰到我工作台的较低抽屉里。没有它，今天的 ASP.NET MVC 可能就不存在了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-19T05:30:54.333

我个人尝试过 CastleProject 的 ASP.NET MVC 和 MonoRail。虽然我真的很喜欢其他 CastleProject 库，但我发现我更喜欢 ASP.NET MVC 实现模型而不是 CastleProject MonoRail 模型。现在 ASP.NET MVC 已经发布，他们将在发布中包含 jQuery，我真的很兴奋。最终，我认为这取决于您使用的其他库。如果您使用 NHibernate、ActiveRecord 和 Castle Windsor，那么您可能会喜欢 MonoRail 库。如果您不使用任何这些库，或者更喜欢 Microsoft Enterprise Libraries（目前是我工作的公司标准），那么您可能会发现 ASP.NET MVC 更适合您的需求。由于 Scott Guthrie 本人对 ASP.NET MVC 的关注，我怀疑它会很快消失。实际上，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T04:08:00.023

我没有经验的另一种选择是[ProMesh](http://www.codeplex.com/promesh)。就个人而言，我转向 ASP.NET MVC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T03:39:19.910

一个看起来很有趣的替代方案是[MonoRail](http://www.castleproject.org/monorail/index.html) ，尽管我还没有完全测试过它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-29T17:46:05.643

ASP.NET MVC 应该开始变得越来越被接受，因为它正在快速成熟。现在它是测试版，并且据说功能几乎已完成，人们采用它的速度将继续增长，而且可能会更快。随着 RTM/RTW 版本承诺在不久的将来发布，现在是开始采用它的最佳时机，这样您就可以开始使用它了。

如果您在 ASP.NET MVC 中看到了特定的缺点，您绝对应该让 Microsoft 知道它。 [Scott Guthrie](http://weblogs.asp.net/scottgu/about.aspx)非常乐于接受反馈，并且[MVC Contrib](http://www.codeplex.com/MVCContrib)项目既愿意接受建议，又通过他们的库提供了大量的增强功能。

# c# - 林克帮助。int.Contains 和 int == iqueryable 不起作用

> ID：300929
> 
> 赞同：2
> 
> 时间：2008-11-19T03:40:10.267
> 
> 标签：c#, asp.net, linq

编辑：对于内部查询，每个内部查询可能有多个匹配项。它抓取了一堆具有相同 game_ID 的标签。这就是 .First 或 .Max 不起作用的原因。

需要一些帮助，我在 LINQ 中有一个查询，如下所示：

```
from yy in Tags_Lookups
where yy.Tag_ID == (from xx in Tags_Lookups
where xx.Game_ID == new Guid("4962d645-711c-4db8-a7ce-ae9b36dd730c")
select xx.Tag_ID)
select yy 
```

我收到一个看起来像这样的错误：

运算符“==”不能应用于“int”和“System.Linq.IQueryable”类型的操作数

我也试过这个没有运气：

```
from yy in Tags_Lookups
where yy.Tag_ID.Contains(from xx in Tags_Lookups
where xx.Game_ID == new Guid("4962d645-711c-4db8-a7ce-ae9b36dd730c")
select xx.Tag_ID)
select yy 
```

出现此错误：

“int”不包含“包含”的定义，并且找不到接受“int”类型的第一个参数的扩展方法“包含”

任何人都可以帮我写一个很好的查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T03:43:46.140

由于您的内部查询可以返回多个匹配项，因此您只需要将内部查询转换为列表并反转 contains 子句的含义，我认为。

```
from yy in Tags_Lookups
where (from xx in Tags_Lookups
       where xx.Game_ID == new Guid("4962d645-711c-4db8-a7ce-ae9b36dd730c")
       select xx.Tag_ID).ToList()
                        .Contains( yy.Tag_ID )
select yy 
```

**编辑**根据新信息更改查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T04:05:54.990

刚刚看到编辑 - 我认为这就是你想要的（不过请检查我的语法）：

```
from yy in Tags_Lookups
join xx in Tags_Lookups on yy.Tag_ID Equals xx.Tag_ID
where xx.Game_ID == new Guid("4962d645-711c-4db8-a7ce-ae9b36dd730c")
select yy 
```

这将为每个匹配的 Game_ID 获得一个 Tags_Lookups 值。您可能希望将整个内容括在括号中并添加“.Distinct”，以防您可能获得多次点击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T04:01:32.360

它可能应该是 SingleOrDefault() 而不是 Max()，因为您永远不会通过 GUID 查找获得多个记录。两者都会让你到达那里。底线是内部查询是一个集合，您需要告诉它如何从该集合中选择一行。

# security - 暴露电子邮件地址和用户名的安全风险？

> ID：300933
> 
> 赞同：2
> 
> 时间：2008-11-19T03:44:18.933
> 
> 标签：security, email

Joomla 在其登录屏幕上具有内置功能“我忘记了我的用户名”，这样您就可以输入您的电子邮件地址，用户名会通过电子邮件发送给您。

我正在考虑更改它，以便用户名立即显示在屏幕上，无需任何形式的身份验证。这将大大减少我们的用户在很长一段时间后返回的摩擦，但它允许任何人输入任何电子邮件地址并查看相关的用户名（但绝对不是相反）。

这会产生任何安全风险吗？这是个好主意吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-19T03:52:34.220

当前的实现要求用户*拥有*电子邮件地址，并阅读生成的电子邮件，以检索用户名。

您的实现让攻击者立即知道哪个用户名连接到电子邮件地址。因此，如果攻击者知道一个人的用户名，就有可能猜测电子邮件地址。

更糟糕的是，假设攻击者不知何故知道密码但不知道电子邮件地址。在成功猜出一个电子邮件地址后，可以合理地猜测该*电子邮件帐户*的密码与您网站的密码相似。因此，您已经帮助攻击者劫持了电子邮件帐户，其中可能包含有关*其他帐户的**更多*信息，等等。

 *通常，更改任何与安全相关的功能以使事情比标准实现“更容易”可能会带来安全风险。+1 用于在实施前通过 SO 进行研究！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-19T10:14:51.983

乍一看，这似乎是一个“坏主意”，因为您允许任何人：

1.  验证帐户是否存在
2.  确认用户名和电子邮件地址之间的关联

如果用户名和邮件地址在您的站点上被视为“私人”信息并且尚未共享，那么我不会通过电子邮件功能实现用户名查找。实际上，您将安全栏降低了 1 个因素：

*   目前，查找用户名需要电子邮件地址和用户的完整邮件凭据（以便他们可以收到回复）
*   更改后，他们所需要的只是邮件地址。

也许更重要的是，您创建了一个需要解决的隐私问题（如@SoapBox 所述）。

但实际上，您的站点可能已经使用“用户名”作为公共句柄或昵称。而且您可能已经让用户在他们的个人资料中发布了他们的电子邮件。如果是这种情况，用户名查找不会泄漏任何新信息，您可以争辩说不会产生新的安全或隐私问题。

但这会让这一切变得有点太容易了，比如发布关于*如何破解我的网站*的脚本小子指南：

1.  从您的首选供应商处获取电子邮件地址列表
2.  来到我的自助邮件到用户名翻译页面并运行列表（为此的简单脚本）
3.  使用生成的用户名列表在网站上发起字典攻击

底线 - 我认为您最好保留此功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-19T03:50:41.663

我会说这对于不太懂行的用户来说是一个*轻微*的安全风险。对于密码较弱的用户，尤其是与他们的用户名或电子邮件地址相关的用户，暴露他们的用户名会使他们的帐户被劫持。除此之外，我想不出它会成为问题的原因。如果用户有好的密码，那根本不重要。

我想有一个轻微的匿名问题。例如，在论坛上，我不希望“认识”我的人在没有我告诉他们的情况下找到我的用户名。在这种情况下，他们可以拿走我的电子邮件并得到它。但这是否是一个问题取决于您的网站和您的用户群。

# data-structures - 二叉搜索树的定义中是否允许重复键？

> ID：300935
> 
> 赞同：187
> 
> 时间：2008-11-19T03:45:21.520
> 
> 标签：data-structures, computer-science, binary-tree

我试图找到二叉搜索树的定义，并且到处都在寻找不同的定义。

有人说对于任何给定的子树，左子键小于或等于根。

有人说对于任何给定的子树，右子键大于或等于根。

我的旧大学数据结构书说“每个元素都有一个键，没有两个元素有相同的键”。

bst 有一个通用的定义吗？特别是关于如何处理具有相同键的多个实例的树。

编辑：也许我不清楚，我看到的定义是

1) 左 <= 根 < 右

2) 左 < 根 <= 右

3) left < root < right，这样不存在重复的键。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-11-19T04:08:53.953

许多算法将指定排除重复项。例如，麻省理工学院算法书中的示例算法通常提供没有重复的示例。实现重复是相当简单的（无论是作为节点上的列表，还是在一个特定方向上。）

大多数（我见过的）将左孩子指定为<=，右孩子指定为>。实际上，允许右子节点或左子节点等于根节点的 BST 将需要额外的计算步骤来完成允许重复节点的搜索。

最好在节点上使用列表来存储重复项，因为将“=”值插入节点的一侧需要重写该侧的树以将节点放置为子节点，或者将节点放置为大节点-child，在下面的某个点，它消除了一些搜索效率。

您必须记住，大多数课堂示例都经过简化来描述和传达概念。在许多现实世界的情况下，它们不值得深蹲。但是，“每个元素都有一个键并且没有两个元素具有相同的键”这句话并没有因为在元素节点上使用列表而被违反。

所以按照你的数据结构书所说的去做吧！

编辑：

二叉搜索树的通用定义涉及基于在两个方向之一上遍历数据结构来存储和搜索键。从实用的意义上讲，这意味着如果值为 <>，则您将在两个“方向”之一中遍历数据结构。所以，从这个意义上说，重复值根本没有任何意义。

这与 BSP 或二分搜索分区不同，但并非完全不同。搜索算法具有“旅行”的两个方向之一，或者已经完成（成功与否）。所以我很抱歉我的原始答案没有解决“通用定义”的概念，因为重复确实是一个不同的主题（您在成功搜索后处理的内容，而不是作为二分搜索的一部分。）

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-12-04T04:27:44.317

如果你的二叉搜索树是一棵红黑树，或者你打算进行任何一种“树旋转”操作，重复的节点都会导致问题。想象一下你的树规则是这样的：

左 < 根 <= 右

现在想象一个简单的树，它的根是 5，左孩子是 nil，右孩子是 5。如果你对根进行左旋转，你最终会在左孩子中得到 5，在右孩子中得到 5为零。现在左树中的某些东西等于根，但您上面的规则假设左 < 根。

我花了几个小时试图弄清楚为什么我的红/黑树偶尔会乱序遍历，问题就是我上面描述的。希望有人阅读此内容并在将来节省数小时的调试时间！

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2013-12-06T14:32:29.833

所有三个定义都是可以接受和正确的。它们定义了 BST 的不同变体。

你的大学数据结构的书未能阐明它的定义不是唯一可能的。

当然，允许重复会增加复杂性。如果您使用定义“left <= root < right”，并且您有一棵树，例如：

```
 3
    /   \
  2       4 
```

然后向该树添加“3”重复键将导致：

```
 3
    /   \
  2       4
    \
     3 
```

请注意，重复项不在连续级别中。

当允许上述 BST 表示中的重复时，这是一个大问题：重复可以由任意数量的级别分隔，因此检查重复的存在并不像检查节点的直接子节点那么简单。

避免此问题的一个选项是不在结构上表示重复项（作为单独的节点），而是使用一个计数器来计算键的出现次数。前面的示例将有一个树，如：

```
 3(1)
    /     \
  2(1)     4(1) 
```

插入重复的“3”键后，它将变为：

```
 3(2)
    /     \
  2(1)     4(1) 
```

这简化了查找、删除和插入操作，但代价是一些额外的字节和计数器操作。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2008-11-19T04:04:23.370

在 BST 中，从节点左侧下降的所有值都小于（或等于，见后文）节点本身。类似地，在节点右侧下降的所有值都大于（或等于）该节点值^((a))。

一些 BST*可能*选择允许重复值，因此上面的“或等于”限定词。下面的例子可以说明：

```
 14
    /  \
  13    22
 /     /  \
1    16    29
          /  \
        28    29 
```

这显示了一个允许重复的 BST ^((b)) - 您可以看到要查找一个值，您从根节点开始，然后根据您的搜索值是小于还是大于节点值，沿着左子树或右子树向下移动。

这可以通过以下方式递归完成：

```
def hasVal (node, srchval):
    if node == NULL:
         return false
    if node.val == srchval:
        return true
    if node.val > srchval:
        return hasVal (node.left, srchval)
    return hasVal (node.right, srchval) 
```

并调用它：

```
foundIt = hasVal (rootNode, valToLookFor) 
```

重复增加了一点复杂性，因为一旦找到值，您可能需要继续搜索具有相同值的其他节点。显然，这并不重要，`hasVal`因为有多少并不重要，只要至少存在一个即可。然而，它对于像这样的事情很重要`countVal`，因为它需要知道有多少。

* * *

^((a))如果您希望调整搜索特定键的方式，您实际上可以按相反的方向对它们进行排序*。*BST 只需要维护一些排序顺序，无论是升序还是降序（甚至是一些奇怪的多层排序方法，比如所有奇数升序，然后所有偶数降序）都无关紧要。

* * *

^((b))有趣的是，如果您的排序键使用存储在节点上的*整个*值（因此包含相同键的节点*没有*其他额外信息来区分它们），则可以通过向每个节点添加计数来提高性能，而不是允许重复节点。

主要好处是添加或删除重复项只会修改计数而不是插入或删除新节点（可能需要重新平衡树的操作）。

所以，要*添加*一个项目，你首先要检查它是否已经存在。如果是这样，只需增加计数并退出。如果没有，您需要插入一个计数为 1 的新节点，然后重新平衡。

要*删除*一个项目，您找到它然后减少计数 - 只有当结果计数为零时，您才会从树中删除实际节点并重新平衡。

考虑到节点较少，搜索也更快，但这可能影响不大。

例如，以下两棵树（左侧不计数，右侧计数）将等价（在计数树中，`i.c`表示`c`item 的副本`i`）：

```
 __14__                    ___22.2___
    /      \                  /          \
  14        22             7.1            29.1
 /  \      /  \           /   \          /    \
1    14  22    29      1.1     14.3  28.1      30.1
 \            /  \
  7         28    30 
```

`22`从左树中删除叶节点将涉及重新平衡（因为它现在的高度差为 2）生成的`22-29-28-30`子树如下所示（这是*一种*选择，还有其他也满足“高度差必须为零或一“ 规则）：

```
\                      \
 22                     29
   \                   /  \
    29      -->      28    30
   /  \             /
 28    30         22 
```

在右树上执行相同的操作是对根节点从`22.2`to的简单修改`22.1`（不需要重新平衡）。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-09-07T08:01:44.370

在 Cormen、Leiserson、Rivest 和 Stein 所著的第三版“算法简介”一书中，二叉搜索树 (BST) 被明确定义为**允许重复**。这可以在图 12.1 和以下（第 287 页）中看到：

> “二叉搜索树中的键总是以满足二叉搜索树属性的方式存储：设`x`是二叉搜索树`y`中的一个节点。如果是 的左子树中的一个节点`x`，那么`y:key <= x:key`。如果`y`是的右子树中的一个节点`x`，则`y:key >= x:key`."

此外，然后在第 308 页将*红黑树定义为：*

> “红黑树是一种二叉搜索树，每个节点有一个额外的存储位：它的颜色”

因此，本书中定义的红黑树支持重复。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-19T03:47:19.097

任何定义都是有效的。只要您在实现中保持一致（始终将相等的节点放在右侧，始终将它们放在左侧，或者永远不允许它们），那么您就可以了。我认为不允许它们是最常见的，但如果它们被允许并且放置在左侧或右侧，它仍然是 BST。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-04-18T16:42:26.217

我只想为@Robert Paulson 回答的内容添加更多信息。

假设节点包含密钥和数据。因此具有相同键的节点可能包含不同的数据。
（所以搜索必须找到所有具有相同键的节点）

> 1.  左 <= 当前 < 右

> 2.  左 < cur <= 右

> 3.  左 <= 当前 <= 右

> 4.  left < cur < right && cur 包含具有相同键的*兄弟节点。*

> 5.  left < cur < right，这样就不存在重复的键。

如果树没有任何**与旋转相关的功能**来防止偏斜，则 1 和 2\. 可以正常工作。
但是这种形式**不适**用于*AVL 树*或*Red-Black 树*，因为旋转会破坏主体。
并且即使 search() 找到具有键的节点，它也必须向下遍历到具有重复键的节点的叶节点。
使 search = **theta(logN)**

3\. 的时间复杂度可以很好地与任何形式的具有旋转相关功能的 BST 配合使用。
但是搜索将花费**O(n)**，破坏了使用 BST 的目的。
假设我们有如下树，3) 主体。

```
 12
       /    \
     10     20
    /  \    /
   9   11  12 
      /      \
    10       12 
```

如果我们在这棵树上执行*search(12)*，即使我们在根处找到 12，我们也必须继续搜索左右子节点以寻找重复键。
正如我所说，这需要 O(n) 时间。

4.是我个人的最爱。假设*兄弟*节点意味着具有相同键的节点。
我们可以把上面的树变成下面的。

```
 12 - 12 - 12
       /    \
10 - 10     20
    /  \
   9   11 
```

现在任何搜索都将花费 O(logN)，因为我们不必遍历子项来查找重复键。
而且这个主体也适用于*AVL*或*RB 树*。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-04-11T20:56:38.177

在处理红黑树实现时，我在使用多个键验证树时遇到问题，直到我意识到使用红黑插入旋转时，您必须放松约束以

`left <= root <= right`

由于我查看的所有文档都不允许重复键，并且我不想重写旋转方法来解决它，我只是决定修改我的节点以允许节点内有多个值，并且没有重复键那个树。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-19T03:52:02.537

你说的这三件事都是真的。

*   键是唯一的
*   左边是小于这个的键
*   右边是大于这个的键

我想你可以反转你的树并将较小的键放在右边，但实际上“左”和“右”的概念就是这样：一个视觉概念，帮助我们思考一个没有真正左的数据结构或者正确，所以这并不重要。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-07-29T22:17:07.880

重复键 • 如果多个数据项具有相同的键，会发生什么情况？– 这在红黑树中提出了一个小问题。– 重要的是，具有相同密钥的节点分布在具有相同密钥的其他节点的两侧。– 也就是说，如果密钥按 50、50、50 的顺序到达， • 您希望第二个 50 位于第一个的右侧，第三个 50 位于第一个的左侧。• 否则，树会变得不平衡。• 这可以通过插入算法中的某种随机化过程来处理。– 但是，如果必须找到具有相同键的所有项目，则搜索过程会变得更加复杂。• 使用相同密钥取缔物品更简单。– 在本次讨论中，我们假设不允许重复

可以为包含重复键的树的每个节点创建一个链表，并将数据存储在链表中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-19T05:22:58.373

> 1.) 左 <= 根 < 右
> 
> 2.) 左 < 根 <= 右
> 
> 3.) left < root < right，这样不存在重复的键。

我可能不得不去挖掘我的算法书籍，但我的头顶（3）是规范形式。

(1) 或 (2) 仅在您开始允许重复节点*并将*重复节点放入树本身（而不是包含列表的节点）时出现。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-13T18:56:28.267

元素排序关系 <= 是一个[总顺序](http://en.wikipedia.org/wiki/Total_order)，因此关系必须是自反的，但通常二叉搜索树（又名 BST）是没有重复的树。

否则，如果有重复，您需要运行两次或更多次相同的删除功能！

# asp.net - 使用 ASP.NET AJAX 在没有更新程序面板的情况下刷新控件

> ID：300943
> 
> 赞同：1
> 
> 时间：2008-11-19T03:51:14.160
> 
> 标签：asp.net, ajax

[这个问题和我之前的问题ASP.NET AJAX](https://stackoverflow.com/questions/300052/aspnet-ajax)直接相关

是否可以异步执行回发？我在页面上有多个 CustomTextbox 控件，当我回发时我想更新表单上的另一个控件。

如果我在第一次发回需要几秒钟才能完成的过程后将所有控件放在更新程序面板中，那么我对使用其原始值呈现的其他控件所做的任何更改。

知道如何解决这个问题吗？

```
Type.registerNamespace('Demo');

Demo.CustomTextBox = function(element) {
    Demo.CustomTextBox.initializeBase(this, [element]);
}

Demo.CustomTextBox.prototype = {

    initialize: function() {
        Demo.CustomTextBox.callBaseMethod(this, 'initialize');

        this._onblurHandler = Function.createDelegate(this, this._onBlur);

        $addHandlers(this.get_element(),
                     {
                         'blur': this._onBlur
                     },
                     this);
    },

    dispose: function() {
        $clearHandlers(this.get_element());

        Demo.CustomTextBox.callBaseMethod(this, 'dispose');
    },

    _onBlur: function(e) {
    if (this.get_element() && !this.get_element().disabled) {
            /* Cridit to AdamB for this line of code */
            __doPostBack(this.get_element().id, 0);
        }
    }
}

Demo.CustomTextBox.registerClass('Demo.CustomTextBox', Sys.UI.Control);

if (typeof (Sys) !== 'undefined') Sys.Application.notifyScriptLoaded(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T04:23:03.393

仅将更新面板放在需要更新的控件周围，并使触发更改的控件在该更新面板上触发：

```
<asp:TextBox runat="server" ID="Entry2" />
<asp:TextBox runat="server" ID="Entry1" />
<asp:UpdatePanel>
    <ContentTemplate>
        <asp:TextBox runat="server" ID="Result" ReadOnly="true" />
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="Entry1" />
        <asp:AsyncPostBackTrigger ControlID="Entry2" />
    </Triggers>
</asp:UpdatePanel> 
```

因此，当回发完成时，只有更新面板中的内容会发生变化。AJAX 回发页面上所有控件的值，而不仅仅是内容模板中的那些。

选项 2（以及更多参与）将是编写一个进行计算的 Web 服务和一些 javascript 来调用它。

# apache-flex - 如何为 Flex Datagrid 制作可重复使用的 labelFunction？

> ID：300950
> 
> 赞同：8
> 
> 时间：2008-11-19T03:55:30.097
> 
> 标签：apache-flex, datagrid, labelfunction

我有一个标签功能，如：

```
private function formatDate (item:Object, column:DataGridColumn):String
{
    var df:DateFormatter = new DateFormatter();
    df.formatString = "MM/DD/YY";

    if (column.dataField == "startDate") {
        return df.format(item.startDate);
    }

    return "ERR";
} 
```

我在数据列中使用`labelFunction`.

如果我的数据字段被称为“startDate”，这很好用。我想让这个函数通用，这样我就可以在任何地方使用它。

我怎样才能做到这一点。我想我需要使用某种“反思”——或者完全是另一种方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-21T17:42:02.997

您可以使用列的 dataField 属性作为项目的键来使函数通用。

```
private function formatDate (item:Object, column:DataGridColumn):String
{
    var df:DateFormatter = new DateFormatter();
    df.formatString = "MM/DD/YY";

    var value:object = item[column.dataField];

    return df.format(value);
} 
```

-本

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-19T08:18:59.533

您可以定义另一个函数，我们称它为`partial`将一些额外的参数绑定到您的函数：

```
function partial( func : Function, ...boundArgs ) : Function {
  return function( ...dynamicArgs ) : * {
    return func.apply(null, boundArgs.concat(dynamicArgs))
  }
} 
```

然后你改变你的功能是这样的：

```
private function formatDate( dataField : String, item : Object, column : DataGridColumn ) : String {
  var df : DateFormatter = new DateFormatter();

  df.formatString = "MM/DD/YY";

  if ( column.dataField == dataField ) {
    return df.format(item[dataField]);
  }

  return "ERR";
} 
```

请注意，我`dataField`在参数列表中添加了一个名为 first 的新参数，并将所有对“startDate”的引用替换为该参数。

并像这样使用它：

```
var startDateLabelFunction : Function = partial(formatDate, "startDate");
var endDateLabelFunction   : Function = partial(formatDate, "endDate"); 
```

该`partial`函数返回一个新函数，该函数使用从调用到部分的参数调用原始函数，并与新函数的参数连接......你和我一起吗？另一种说法是它可以返回一个新函数，其中 N 个参数预先绑定到特定值。

让我们一步一步来：

`partial(formatDate, "startDate")`返回一个如下所示的函数：

```
function( ...dynamicArgs ) : * {
  return func.apply(null, boundArgs.concat(dynamicArgs));
} 
```

但是`func`and`boundArgs`是你作为参数传递给 的`partial`，所以你可以说它看起来像这样：

```
function( ...dynamicArgs ) : * {
  return formatDate.apply(null, ["startDate"].concat(dynamicArgs));
} 
```

当它被调用时，它或多或少与 this 相同

```
function( item : Object, column : DataGridColumn ) : * {
  return formatDate("startDate", item, column);
} 
```

多田！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T18:29:58.900

这是更通用的方式：

```
public static function getDateLabelFunction(dateFormatString:String=null, mxFunction:Boolean = false) : Function {
        var retf:Function;

        // defaults
        if(dateFormatString == null) dateFormatString = "MM/DD/YY";
        if(mxFunction) {
            retf = function  (item:Object, column:DataGridColumn):String
            {
                var df:DateFormatter = new DateFormatter();
                df.formatString = dateFormatString;

                var value:Object = item[column.dataField];

                return df.format(value);
            }
        }else {
            retf = function  (item:Object, column:GridColumn):String
            {
                var df:DateFormatter = new DateFormatter();
                df.formatString = dateFormatString;

                var value:Object = item[column.dataField];

                return df.format(new Date(value));
            }
        }

        return retf;

    } 
```

用法（Spark 数据网格）

```
var labelFunction = getDateLabelFunction(); 
```

或用于 MX 数据网格

```
var labelFunction = getDateLabelFunction(null,true); 
```

传递自定义日期格式字符串：

```
var labelFunction = getDateLabelFunction("DD/MM/YYYY",true); 
```

默认为“MM/DD/YYYY”；

# winforms - 在网格与详细表单中进行编辑 - 最终用户有多聪明？

> ID：300952
> 
> 赞同：7
> 
> 时间：2008-11-19T03:58:14.707
> 
> 标签：winforms, user-interface

我喜欢网格——尤其是像 Devex、C1 等很酷的第三方。

我们的程序员认为最终用户无法处理它们 - 所以他总是用只读网格（带有只读类）设计他的表单。选择编辑网格中的项目会打开一个允许编辑的详细信息表单。

这个应用程序将由一般商业人士使用 - 而不是极客。但他们都是非常优秀的 Excel 用户——我认为这有点像“网格”。我应该相信我的首席开发人员，还是按照我的直觉说用户喜欢快速编辑——网格比细节表单做得更好？我确实希望对应用程序有一个一致的感觉，所以不想把它混得太多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T04:30:27.340

*这主要是口味问题，但我的偏好与您的开发人员的（以及上面 Corey 的回答）一致。对于大多数应用程序*，我更喜欢只读/编辑模型而不是大型可编辑网格。但是我在 Excel 中工作了很多，一次必须打开一行会害死我。不同的目的！如果您主要要进行大量随机访问编辑，我会坚持使用网格。对于其他所有内容（包括顺序输入），我会使用带有拆分表单的只读模型。我使用过的各种应用程序表明，用户可以在适当的上下文中处理任何一种。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T04:24:36.887

根据我的经验，具有编辑功能的网格对程序员、测试人员和用户来说都很难，因为通常验证的触发器是终止焦点事件。也就是说，用户在一个单元格上打勾，然后在那个单元格中出现错误，直到他更正它为止。

那样可以么？依靠。

如果可以验证网格中每个单元格中的数据而无需引用其他单元格，尤其是其他行，那么也许没问题。但是，如果一个单元格的有效性取决于另一个单元格中的值，那么由 kill focus 触发的验证可能会很棘手。您的用户最终可能会遇到一种情况，即他们必须在单元格中放入一些东西才能离开该单元格并导航到导致问题的真实单元格。

对话框的另一个优点是有很多屏幕空间用于显示有用的文本、更长的标签、同时出现多个错误消息，所有这些都在错误字段旁边。在网格中，有时您所能做的就是更改单元格颜色并为该单元格弹出一个模式对话框。

我正在开发一个应用程序，该应用程序取代了在网格中进行编辑的应用程序。每个参与旧应用程序的程序员都同意，在新应用程序中不会对网格进行编辑，这并不是我们懒惰。我们只是想发布一些我们知道我们可以制作的东西，这对我们的测试人员来说更容易测试。

我同意具有 Excel 经验的用户可以在网格中轻松编辑，但是您最好确保您的网格与 Excel 的网格一样好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-19T12:39:44.687

尽可能在网格上就地编辑，并且永远不会有编辑对话框。我认为拥有“编辑模式”没有任何好处，它会浪费用户的时间并增加应用程序的复杂性（从用户的角度来看）。拥有编辑对话框比就地编辑*更难学习应用程序，因为用户必须学习**两个*窗口*以及*如何在它们之间导航。

使用 Excel、Access 和其他桌面应用程序的经验表明，用户在编辑网格时不会遇到任何问题，而不是在编辑其他任何内容时遇到问题。您应该没有问题，特别是如果让您的网格看起来像 Excel 工作表或 Access 表或表单，而不像典型的“单击此处更新”Web 应用程序。

我认为一些开发人员制作只读网格的趋势是早期 Web 应用程序时代的遗留物，当时没有可编辑的网格或根本没有网格——有 html 表格，任何编辑都需要表单。以当今的技术，我认为编辑模式没有任何借口。

至于验证，当焦点离开单元格时通知用户任何验证错误，但不要使用*模态*错误指示（用颜色标记字段是一种方法，但不是唯一的方法）。让用户随时更正它，也许通过修复其他字段。这解决了依赖验证问题。

如果可以异步或在不到半秒的时间内完成，请考虑在失去对单元格或（或者）行的焦点的情况下自动发布记录更改。这解决了多用户应用程序的并发问题，并为您的用户提供隐式保存，这是 Web 应用程序可以使用的另一个可用性改进。

自从 GUI 发明以来，直接操作一直是一种经过验证的可用性原则。长期以来，人们一直认为模式存在可用性问题。现在是 Web 应用程序赶上 1980 年代可用性水平的时候了。

顺便说一句，许多解释性的窗口内文本（例如，长标签和多条消息）是可用性问题的指示，而不是解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-19T04:07:29.773

用户可以完全处理网格。它比编辑按钮和详细表单更直观。

但是，此应用程序是多用户应用程序吗？基础数据是否可以一次由多个用户更改？如果是这样，那么您需要做出一些并发设计决策，有时，当用户一次只能编辑一行时，这可能更容易解决。

不过它闻起来有点腥，我怀疑你的程序员在找方便的借口，因为他更容易以主/细节模式设计只读网格。

坚持你的直觉。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T05:40:42.537

如果您不完全信任您的首席开发人员*，*那么他们不应该成为您的首席开发人员。

另外：如果您的首席开发人员拥有计算机科学学位（或其他类似学位），请不要称他们为“程序员”。这对专业工程师来说是负面的。

如果你推翻他们的决定，他们至少不会感受到爱。小心踩到你的软件工程师的脚趾。仅当您 100% 确定他们犯了错误时才这样做。即便如此，你可能会以一种让他们意识到这是一个错误的方式来处理这个问题，而你实际上并没有推翻他们的一个决定。通过询问他们将如何解决您担心的特定案例来帮助他们做出更好的决定。如果他们不担心同一个案子，那就放手吧。这就是为什么他们是主要开发人员。只要他们很聪明并且理解您的担忧，只要您雇用合适的人，这就是您能做的最好的事情。通过压倒您的首席开发人员可能对您的关系及其生产力造成的损害

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T13:43:25.430

你为什么不做一些用户测试并以这种方式找出答案呢？模拟几个简单的原型或使用现有示例并让它们执行简单的任务。您将很快看到用户有多优秀，并且从中做出的选择应该非常简单。

# asp.net-mvc - 在 ASP.Net MVC 中根据用户输入动态填充表单

> ID：300957
> 
> 赞同：0
> 
> 时间：2008-11-19T04:01:48.710
> 
> 标签：asp.net-mvc, forms, dynamic, http-post

我的问题与 Engram's [here](https://stackoverflow.com/questions/223149/how-do-you-handle-the-output-of-a-dynamically-generated-form-in-aspnet-mvc)类似，但我的问题更进一步。我打算让它工作的方式是我有一个文本框询问用户要输入多少条目。在他们输入数字后，我需要创建更多的文本框以允许输入（然后对这些文本框重复相同的过程，但首先是婴儿步骤......）我尝试收集帖子上的密钥，但它只返回初始文本框询问条目数。我仍在尝试掌握 MVC，到目前为止的教程/视频还没有深入研究它。再说一次，我知道这可能是我可以使用 JQuery 处理的事情，但我仍然会陷入同样的​​境地。

这是我正在使用的控制器：

```
[AcceptVerbsAttribute("POST")]
    public ActionResult Create(int tbxNumberOfExercises)
    {
        ViewData["number"] = tbxNumberOfExercises;
        foreach (var key in Request.Form.Keys)
        {
            string keyString = key.ToString();
            if (keyString.StartsWith("tbox_exercise", StringComparison.OrdinalIgnoreCase))
            {
                string recNum = keyString.Substring(13, keyString.Length - 13);
                string approvedKey = Request.Form["tbox_exercise" + recNum];
                int number;
                int.TryParse(approvedKey, out number);
            }
        }
        return View("Create");
    } 
```

这是我的aspx：

```
<form action="/CreateWorkout/Create" method="post">
Number of Exercises:
<%= Html.TextBox("tbxNumberOfExercises") %>
<br />
<br />
<input type="submit" value="Set Exercise Number" />
</form>
<% if (ViewData["number"] != null)%>
There are this many:<%=Html.Encode(ViewData["number"])%>
<br />
and this line should show up
<% if (ViewData["number"] != null)
   {
       int max = (int)ViewData["number"];

       for (int i = 0; i < max; i++)
       {%>
          <br />
          <br />
          <%= Html.TextBox("tbox_exercise" + i) %>
    <% }
   } %>
<% if (ViewData["s"] != null) %>
<%=Html.Encode(ViewData["s"]) %> 
```

有没有什么我忽略了，没有理解，或者我应该在我做的时候放弃，因为我似乎永远不会得到它？

在此先感谢您的帮助-我只是尽力学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T04:38:11.413

我将分阶段分解，您需要根据需要在某处添加“保存”视图。

斯科特

```
<form action="/Demo01/Create" method="post">
Number of Exercises:
<%= Html.TextBox("tbxNumberOfExercises") %>
<br />
<br />
<input type="submit" value="Set Exercise Number" />
</form>
<% if (ViewData["number"] != null) {%>
<form action="/Demo01/Save" method="post">
There are this many:<%=Html.Encode(ViewData["number"])%>
<br />
and this line should show up
<% if (ViewData["number"] != null) {
       int max = (int)ViewData["number"];

       for (int i = 0; i < max; i++) {%>
<br />
<br />
<%= Html.TextBox("tbox_exercise" + i) %>
<% }
   } %>
<% if (ViewData["s"] != null) %>
<%=Html.Encode(ViewData["s"]) %>
<input type="submit" value="Save Exercises" />
<% } %>
</form> 
```

然后在你的控制器中是这样的：

```
public class Demo01Controller : Controller {
    public ActionResult Create() {
        return View();
    }

    [AcceptVerbsAttribute("POST")]
    public ActionResult Create(int tbxNumberOfExercises) {
        ViewData["number"] = tbxNumberOfExercises;
        return View("Create");
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Save() {
        foreach (var key in Request.Form.Keys) {
            string keyString = key.ToString();
            if (keyString.StartsWith("tbox_exercise", StringComparison.OrdinalIgnoreCase)) {
                string recNum = keyString.Substring(13, keyString.Length - 13);
                string approvedKey = Request.Form["tbox_exercise" + recNum];
                int number;
                int.TryParse(approvedKey, out number);
            }
        }
        return View(); // return/redirect to wherever you want
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T05:20:22.450

我会考虑通过javascript在客户端添加文本框，而不是发回服务器以重新绘制表单，假设您可以使用javascript作为使用应用程序的要求。如果没有，那么@Scott 的方法应该有效。作为一个偏好问题，我可能会让 Save 方法采用 FormCollection 参数，而不是直接处理 Request 对象。

javascript 解决方案是有一个文本框和一个按钮来添加另一个。用户可以继续添加文本框，直到他们有足够的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T04:42:17.240

问题是您的`</form>`结束标签需要出现在视图的末尾。

试试这个修改后的视图：

```
<form action="/CreateWorkout/Create" method="post">
Number of Exercises:
<%= Html.TextBox("tbxNumberOfExercises") %>
<br />
<br />
<input type="submit" value="Set Exercise Number" />
<% if (ViewData["number"] != null)%>
There are this many:<%=Html.Encode(ViewData["number"])%>
<br />
and this line should show up
<% if (ViewData["number"] != null)
   {
       int max = (int)ViewData["number"];

       for (int i = 0; i < max; i++)
       {%>
          <br />
          <br />
          <%= Html.TextBox("tbox_exercise" + i) %>
    <% }
   } %>
<% if (ViewData["s"] != null) %>
<%=Html.Encode(ViewData["s"]) %>
</form> 
```

就最佳实践而言，我会推荐 Scott 的方法。这个答案是关于让你的确切场景工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T11:03:33.290

谢谢你们的帮助。我今天早上 5 点意识到我的问题是表单不包含新的文本框/我需要另一个表单。我将不得不认真研究 Javascript 并实际修改 DOM，因为将其保留在客户端会更好。

非常感谢。

# asp.net - 如何在 javascript 中同步 web 服务调用

> ID：300965
> 
> 赞同：0
> 
> 时间：2008-11-19T04:07:39.883
> 
> 标签：asp.net, javascript, web-services, asynchronous

我有一个控制应用程序 - 使用 asp.net webservices。

我有一个计时器，它每 5 秒执行一次异步 Web 服务调用以更新屏幕。还有用于刷新部分屏幕的用户按钮，也进行异步 Web 服务调用。

问题是如果在计时器 web 服务响应到达之前发出用户 web 服务命令，我的屏幕会变得混乱。基本上，如果正在进行挂起的异步计时器调用，我希望用户命令等待。如何在 Javascript 中的这些调用之间进行同步？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T04:34:44.133

发生用户回发时是否可以忽略定时回发？

如果是这样，则在用户进行回发时设置 2 个标志（DontRequest 和 IgnoreNext）。当用户回发返回时，取消设置 DontRequest。

设置 DontRequest 时，您的自动化流程不会启动请求。如果收到响应并设置了 IgnoreNext，则忽略响应并取消设置标志。

# cocoa - 如何更改 NSButtonCell 对象在单击时突出显示的方式？

> ID：300971
> 
> 赞同：2
> 
> 时间：2008-11-19T04:13:47.873
> 
> 标签：cocoa

我在 NSTableView 中使用了几个 NSButtonCell 对象。它们是简单的方形按钮，上面有自定义图像。

这些按钮在未突出显示时正确绘制：可见的只有图像，按钮矩形的其余部分是透明的。但是，当我单击它们时，整个按钮矩形都会突出显示，从而反转透明部分的背景。

我希望看到图像被倒置，透明部分保持透明。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-19T05:50:17.383

尝试将单元格的`highlightsBy`属性设置为`NSContentsCellMask`. 我认为您必须在代码中执行此操作（可能在 中`awakeFromNib`）；我没有看到单独在 IB 中做到这一点的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-23T05:03:44.037

你也可以在 Interface Builder 中完成。我使用“ `Square Button`”，所以按钮在两个图像之间改变（所以图像根本不会反转）。

您的按钮行为可能设置为“ `Momentary Light`”或“ `Momentary Push In`”。

将其设置`Behaviour`为“ `Momentary Change`”，它应该可以工作。

# apache2 - 我需要哪些虚拟主机定义来支持 Apache 2 上同一 IP 地址上的 subdomain.mydomain.com 和 *.mydomain.com？

> ID：300976
> 
> 赞同：0
> 
> 时间：2008-11-19T04:19:29.627
> 
> 标签：apache2, virtualhost, wildcard-subdomain

我在 Apache 2 上有一个虚拟主机设置，如下所示（简化）：

```
<VirtualHost *>
  ServerName domain.com
  ServerAlias *.domain.com
  DocumentRoot /var/www/domain.com/html
</VirtualHost>

<VirtualHost sub1.domain.com>
  ServerName sub1.domain.com
  DocumentRoot /var/www/sub1.domain.com/html
</VirtualHost>

<VirtualHost sub2.domain.com>
  ServerName sub2.domain.com
  DocumentRoot /var/www/sub2.domain.com/html
</VirtualHost> 
```

我正在寻找的结果是所有不是 sub2.domain.com 或 sub1.domain.com 的东西都应该转到 domain.com。它们都必须位于相同的默认端口上，并且它们都共享相同的 IP 地址。

实际发生的是 sub2 按预期转到 sub2，而其他所有内容都转到 sub1，即忽略通配符定义。

我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T04:43:44.677

将 <VirtualHost sub1.domain.com> 更改为 <VirtualHost *> 并将 <VirtualHost sub2.domain.com> 更改为 <VirtualHost *>。无论如何，第一个是默认的。

# c++ - 什么时候不应该使用虚拟析构函数？

> ID：300986
> 
> 赞同：103
> 
> 时间：2008-11-19T04:27:50.513
> 
> 标签：c++, virtual-functions, virtual-destructor

是否有充分的理由*不*为类声明虚拟析构函数？你什么时候应该特别避免写一个？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-19T04:33:10.410

当以下任何一种情况为真时，无需使用虚拟析构函数：

*   无意从中派生类
*   堆上没有实例化
*   无意通过指向超类的指针访问存储

除非您真的非常需要记忆，否则没有具体的理由避免它。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-11-19T15:09:55.740

明确地回答这个问题，即你什么时候不应该*声明*一个虚拟析构函数。

**C++ '98/'03**

添加虚拟析构函数可能会将您的类从[POD（普通旧数据）](https://en.wikipedia.org/wiki/Passive_data_structure) * 或聚合更改为非 POD。如果您的类类型在某处聚合初始化，这可能会阻止您的项目编译。

```
struct A {
  // virtual ~A ();
  int i;
  int j;
};
void foo () { 
  A a = { 0, 1 };  // Will fail if virtual dtor declared
} 
```

在极端情况下，这样的更改也可能导致未定义的行为，其中类以需要 POD 的方式使用，例如通过省略号参数传递它，或者将它与 memcpy 一起使用。

```
void bar (...);
void foo (A & a) { 
  bar (a);  // Undefined behavior if virtual dtor declared
} 
```

[* POD 类型是对其内存布局有特定保证的类型。该标准实际上只是说，如果您要从具有 POD 类型的对象复制到一个字符数组（或无符号字符）中并再次返回，那么结果将与原始对象相同。]

**现代 C++**

在最近的 C++ 版本中，POD 的概念分为类布局及其构造、复制和销毁。

对于省略号的情况，它不再是未定义的行为，它现在由实现定义的语义有条件地支持（N3937 - ~C++ '14 - 5.2.2/7）：

> ...传递具有非平凡复制构造函数、非平凡移动构造函数或平凡析构函数的类类型（第 9 条）的潜在评估参数，没有相应的参数，有条件地支持实现-定义的语义。

声明一个析构函数不是`=default`意味着它不是微不足道的（12.4/5）

> ...如果不是用户提供的析构函数，那么它是微不足道的...

Modern C++ 的其他更改减少了聚合初始化问题的影响，因为可以添加构造函数：

```
struct A {
  A(int i, int j);
  virtual ~A ();
  int i;

  int j;
};
void foo () { 
  A a = { 0, 1 };  // OK
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-19T04:37:54.440

当且仅当我有虚拟方法时，我才声明一个虚拟析构函数。一旦有了虚方法，我就不相信自己会避免在堆上实例化它或存储指向基类的指针。这两个都是非常常见的操作，如果析构函数没有声明为虚拟的，通常会悄悄地泄漏资源。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-19T04:54:35.297

每当有`delete`可能在指向具有您的类类型的子类对象的指针上调用时，都需要虚拟析构函数。这确保在运行时调用正确的析构函数，而编译器不必在编译时知道堆上对象的类。例如，假设`B`是 的子类`A`：

```
A *x = new B;
delete x;     // ~B() called, even though x has type A* 
```

如果您的代码不是性能关键，那么为您编写的每个基类添加一个虚拟析构函数是合理的，只是为了安全。

但是，如果您发现自己`delete`在一个紧密的循环中调用了很多对象，那么调用虚函数（即使是空的）的性能开销可能会很明显。编译器通常不能内联这些调用，处理器可能很难预测去哪里。这不太可能对性能产生重大影响，但值得一提。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-19T15:31:29.597

虚函数意味着每个分配的对象都会通过虚函数表指针增加内存成本。

因此，如果您的程序涉及分配大量对象，则值得避免使用所有虚函数，以便为每个对象节省额外的 32 位。

在所有其他情况下，您将省去调试痛苦以使 dtor 虚拟化。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-21T14:09:30.807

并非所有 C++ 类都适合用作具有动态多态性的基类。

如果你想让你的类适合动态多态，那么它的析构函数必须是虚拟的。此外，子类可能想要覆盖的任何方法（这可能意味着所有公共方法，以及可能在内部使用的一些受保护的方法）必须是虚拟的。

如果你的类不适合动态多态，那么析构函数不应该被标记为虚拟的，因为这样做会产生误导。它只是鼓励人们错误地使用你的课程。

这是一个不适合动态多态性的类的示例，即使它的析构函数是虚拟的：

```
class MutexLock {
    mutex *mtx_;
public:
    explicit MutexLock(mutex *mtx) : mtx_(mtx) { mtx_->lock(); }
    ~MutexLock() { mtx_->unlock(); }
private:
    MutexLock(const MutexLock &rhs);
    MutexLock &operator=(const MutexLock &rhs);
}; 
```

这门课的重点是为 RAII 坐在堆栈上。如果您要传递指向此类对象的指针，更不用说它的子类了，那么您做错了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-02-17T07:12:30.203

不将析构函数声明为虚拟的一个很好的理由是，这样可以使您的类免于添加虚拟函数表，并且您应该尽可能避免这种情况。

我知道很多人更喜欢总是将析构函数声明为虚拟的，只是为了安全起见。但是，如果您的类没有任何其他虚函数，那么拥有虚析构函数真的非常没有意义。即使您将您的类提供给其他人，然后他们从中派生出其他类，那么他们也没有理由对向上转换到您的类的指针调用 delete - 如果他们这样做，那么我会认为这是一个错误。

好的，有一个例外，即如果您的类（错误）用于执行派生对象的多态删除，但是您 - 或其他人 - 希望知道这需要一个虚拟析构函数。

换句话说，如果你的类有一个非虚拟析构函数，那么这是一个非常明确的声明：“不要用我来删除派生对象！”

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-04-12T23:19:29.223

如果您有一个包含大量实例的非常小的类，则 vtable 指针的开销可能会影响程序的内存使用量。只要您的类没有任何其他虚拟方法，将析构函数设为非虚拟就可以节省开销。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T10:52:30.847

我通常将析构函数声明为虚拟的，但如果您有在内部循环中使用的性能关键代码，您可能希望避免虚拟表查找。在某些情况下，这可能很重要，例如碰撞检查。但是，如果使用继承，请注意如何销毁这些对象，否则只会销毁对象的一半。

请注意，如果该对象上的*任何*方法是虚拟的，则会针对该对象进行虚拟表查找。因此，如果您在类中有其他虚拟方法，则删除析构函数上的虚拟规范毫无意义。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-05-11T22:34:19.523

如果您绝对肯定必须确保您的类没有 vtable，那么您也不能有虚拟析构函数。

这是一种罕见的情况，但确实会发生。

最熟悉的模式示例是 DirectX D3DVECTOR 和 D3DMATRIX 类。这些是类方法而不是语法糖的函数，但是这些类故意没有 vtable 以避免函数开销，因为这些类专门用于许多高性能应用程序的内部循环。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-13T17:52:49.080

将在基类上执行的操作应该是虚拟的，应该是虚拟的。如果可以通过基类接口多态地执行删除，那么它必须是虚拟的并且是虚拟的。

如果您不打算从类派生，则析构函数不需要是虚拟的。即使你这样做了，如果不需要**删除基类指针，受保护的非虚拟析构函数也一样好**。

* * *

## 回答 #12

> 赞同：-8
> 
> 时间：2008-11-19T05:04:18.490

性能答案是我所知道的唯一一个有可能成为真实的答案。如果您已经测量并发现对析构函数进行去虚拟化确实加快了速度，那么您可能在该类中还有其他需要加速的东西，但此时还有更重要的考虑因素。总有一天，有人会发现您的代码会为他们提供一个很好的基类，并为他们节省一周的工作量。你最好确保他们完成那一周的工作，复制和粘贴你的代码，而不是使用你的代码作为基础。你最好确保你的一些重要方法是私有的，这样任何人都不能从你那里继承。

# .net - 您如何在 Db4o 对象数据库中执行数据管理任务？

> ID：300987
> 
> 赞同：2
> 
> 时间：2008-11-19T04:28:00.200
> 
> 标签：.net, db4o, object-oriented-database

我是 OODBMS 系统的新手，但我在一个非常适合的新项目中使用 Db4o。事情进展顺利，我真的很喜欢这个概念，但我正在为如何完成与开发相关的基本数据管理任务而苦苦挣扎。定期我想清除数据库中的所有特定类型，如何在不实际编写代码方法然后运行我的应用程序的情况下执行此操作？另外，我如何解决“模式”的变化。如果我更改了特定类的定义，Db4o 是否会为它创建一个新的“表”，或者它是否将其识别为具有不同成员集的相同类型？

顺便说一句...我在 .NET 3.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T09:19:05.423

我通常会根据需要编写开发代码（直到应用程序可以自己处理这些问题）。你会很高兴知道 ObjectManager 现在是免费的，所以你可能想看看[http://developer.db4o.com/blogs/product_news/archive/2009/01/25/object-manager-enterprise-now -free-to-all-developers.aspx](http://developer.db4o.com/blogs/product_news/archive/2009/01/25/object-manager-enterprise-now-free-to-all-developers.aspx)

架构更改应通过向新字段添加默认值来解决。Db4o 不会为它“创建一个新表”，而只是“添加一个新列”。更改类定义后从 db 检索的对象将具有新属性，但将为 null - 因此向其添加默认值是个好主意。这样，您的所有对象都会在首次​​使用时自行排序。删除的字段将被忽略。

# javascript - JQuery 中的可插拔编辑组件

> ID：300990
> 
> 赞同：2
> 
> 时间：2008-11-19T04:29:57.560
> 
> 标签：javascript, jquery, architecture, plugins

我正在 JQuery 中开发一个编辑组件（基于 iframe）。

我的目的是让通过插件扩展编辑器的功能变得容易。因此，例如，您可能会制作一个插件，在拼写错误下方放置波浪下划线，或允许插入图像等。

我很高兴自己解决这个问题，但我发现很难决定如何构建 API。

编辑器本身目前是一个插件。您可以通过如下代码实例化它：

```
$("#id_of_a_div").editComponent(); 
```

JQuery 是否允许您在插件内部拥有插件？或者有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-20T17:30:26.517

你应该看看[jQuery.ui 指南](http://docs.jquery.com/UI/Guidelines#Plugin_Extensions)。其中提到了可拖动组件作为带有插件的插件的示例。*********