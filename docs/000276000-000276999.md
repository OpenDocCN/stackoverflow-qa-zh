# StackOverflow 问答 000276000-000276999

# winforms - winforms .net 的 mvc 框架

> ID：276000
> 
> 赞同：3
> 
> 时间：2008-11-09T15:13:09.943
> 
> 标签：winforms, model-view-controller

请为 Winforms 推荐一个好的 MVC 框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T16:44:52.597

[http://www.codeplex.com/CompositeWPF](http://www.codeplex.com/CompositeWPF)（用于 WPF/Silverlight 的 MVC 应用程序块）

[http://blogs.msdn.com/priozersk/archive/2008/11/04/mobile-mvc-framework-part-4-passing-data-between-controllers.aspx（.NET](http://blogs.msdn.com/priozersk/archive/2008/11/04/mobile-mvc-framework-part-4-passing-data-between-controllers.aspx) Compact Framework 的 MVC 框架）

问候，坦伯格

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T08:45:17.587

[http://www.mvcsharp.org/](http://www.mvcsharp.org/) 欢迎来到 MVC# 主页 MVC# - 是一个适用于 .NET 平台的 Model-View-Presenter 框架。它允许以最少的努力利用 MVP 模式。结果，应用程序获得了 3 层结构，变得结构更好并且更易于维护。

MVC# Overview - MVC# 框架的介绍。10 分钟示例 - 使用 MVC# 框架的简单示例。

有关更多信息，请查看网站的文档部分。

如果您感觉自己准备好了，请继续下载页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T15:28:35.807

CAB还不错

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T09:18:27.893

智能客户端软件工厂：

[http://www.codeplex.com/smartclient](http://www.codeplex.com/smartclient)

# php - 什么是通过 FTP 部署 PHP/MySQL 站点的好解决方案？

> ID：276007
> 
> 赞同：0
> 
> 时间：2008-11-09T15:23:08.173
> 
> 标签：php, mysql, deployment

我目前正在开发一个使用 PHP 和 MySQL 的 Web 应用程序，但我没有对服务器的 shell 访问权限（已经在解决这个问题......）。目前，我在本地计算机上进行了带有 subversion 的源代码控制，并且我在本地计算机上有一个数据库，我对它进行了所有更改。然后，一旦我在本地计算机上测试了所有更新，我就会手动部署该站点。我使用 filezilla 上传更新的文件，然后转储我的本地数据库并将其导入部署服务器。

显然，我目前的解决方案远非理想。对于一件主要的事情，我需要一种方法来避免复制我的 .svn 文件......有谁知道这个特定设置的最佳解决方案是什么？我已经对 Capistrano 和 Ant 进行了一些研究，但是这两个看起来都是我没有 shell 访问权限的问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T15:33:15.643

我正在使用[Weex](http://weex.sourceforge.net/)通过 FTP 同步服务器。Weex 基本上是一个非交互的 FTP 客户端，可以自动上传和删除远程服务器上的文件/目录。它可以配置为不上传某些路径（如 SVN 目录），以及保留某些远程路径（如日志目录）。

不幸的是，我手头也没有同步 MySQL 数据库的解决方案......

也许您可以在“SQL 补丁脚本”中记录您的数据库更改（或使用完整的转储），使用 Weex 上传这些更改，然后调用远程 PHP 脚本执行 SQL 补丁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T16:44:14.877

我在生产中使用 rsync 但你可以这样做：

在您的站点中添加一个配置表来保存您当前所处的数据库级别。

在开发过程中，将每组 SQL 更改存储到一个文件中（我使用类似 delta_X-up.sql 的文件）。这些也将保留在您的 SVN 中。因此，例如，如果您在 delta_5 并在当前版本和新版本之间添加一个表，则所需的所有 SQL 都将放在 delta_6-up.sql 中

当需要构建时，导出 repo 而不是使用 checkout。这使您可以忽略所有出现的 SVN 杂物，因为您不需要将其用于生产。

使用[Weex](http://weex.sourceforge.net/)将这些更改推送到生产中（这将是我会使用 rsync 但你没有那个选项）。调用一个远程脚本来检查您的配置数据库以查看您当前处于什么增量级别，使用您的 delta_x-up.sql 文件解析目录并查看是否有任何新文件。如果有，请阅读它们并在其中运行 SQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T15:45:00.407

您可以从工作副本将颠覆导出（而不是签出）到不同的目录，然后它将为您删除所有 .svn 内容

# sql - 使用 XQUERY/Modify 将我的一段 XML 替换为 varchar 字段中的值

> ID：276009
> 
> 赞同：8
> 
> 时间：2008-11-09T15:24:33.053
> 
> 标签：sql, sql-server, xml, tsql, xquery

我有一张桌子：

```
MyTable
  config as XML
  title as varchar(255) 
```

在 MyTable.config 我有以下结构的 XML：

```
<configuration pagetitle="myConfig">
  <column>
    <row>
      <component id="1" type="MyPiece" title="My Title" text="junk" />
    </row>
  </column>
</configuration> 
```

我需要一个脚本来将 MyTable.text 的值注入到我的配置 XML 中组件节点的文本属性中。

我知道这是错误的，但我想做类似的事情：

```
UPDATE MyTable SET config.configuration.column.row.component.title = title 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-09T16:08:29.597

```
UPDATE MyTable
   SET Config.modify('
   replace value of (/configuration/column/row/component/@title)[1]
    with sql:column("title")
   ') 
```

# c++ - std::wcout 到 Xcode 中的控制台窗口

> ID：276010
> 
> 赞同：2
> 
> 时间：2008-11-09T15:25:40.463
> 
> 标签：c++, xcode, macos, unicode, iostream

在 Xcode 项目中，如果我`std::cout`用来写入控制台，则输出很好。

但是，如果我使用`std::wcout`我没有输出。

我知道这是 C++ 中的一个棘手问题，我一直在谷歌搜索以尝试在 Xcode 案例中找到特定的解决方案。我发现建议应该起作用的几件事是：

```
std::cout.imbue( std::locale("") ); 
```

和

```
std::setlocale(LC_ALL, ""); 
```

这些都没有任何区别。在我辞职花接下来的几周研究 facets API 以便能够写入控制台之前，我想我会在这里与尊敬的观众核实一下。

[更新]

我认为我一直遇到的问题的原因实际上与我尝试打印的一些字符串的特定编码有关。

如果我只发送一个字符串文字，使用`L"my string" syntax`它就可以了！看来这是使用 UTF32 - little endian encoding。

但是，我一直将它与使用 NSUTF32BigEndianStringEncoding 编码从 Objective C++ 代码传递的字符串混合。正是这种编码组合导致了问题。

我想我们可以认为这件事已经结束了。谢谢阅读。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T16:15:42.297

std::wcout 应该像 std::cout 一样工作。

以下在我的 MAC 上运行良好：

```
#include <iostream>

int main()
{
    std::cout << "HI" << std::endl;
    std::wcout << L"PLOP" << std::endl;
} 
```

也许（尽管有些代码会很好）是因为您没有刷新缓冲区。请记住 std::cout 和 std::wcout 是缓冲的。这意味着在缓冲区被填满或您明确刷新缓冲区之前，输出不会被推送到控制台。

您可以使用以下命令刷新缓冲区：

```
std::wcout << flush();
// or
std::wcout << endl;  // Those also puts a '\n' on the stream. 
```

# nant - NAnt 什么时候达到 1.0 版

> ID：276014
> 
> 赞同：2
> 
> 时间：2008-11-09T15:29:56.493
> 
> 标签：nant

我非常喜欢南特。我用 NAnt 编写了很多脚本。这是一个很棒的小工具。

由于 NAnt 是 1.0 之前的版本，所以当出现问题时，我经常会想是不是 NAnt 本身的问题，但并非总是如此。

一个有趣的例子：运行 oracle 脚本后，我解析了日志输出以确保没有问题。我正在用一个小日志文件对此进行测试，这很好。

我使用任务将文件内容加载到字符串属性并使用正则表达式来搜索错误。

当我将此脚本用于大型日志文件时，我停止在底部收到“构建失败”消息，因为我正在打印错误消息。

因为“构建失败”隐藏在顶部，我认为 NAnt 崩溃了，但它工作正常。

NAnt 最好有 1.0 版本。有什么不可以的理由吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T15:40:21.977

NAnt 是一个开源项目，已经存在很长时间并且相当稳定。虽然他们有理由不将其称为版本“1”，但在这种情况下，版本号真的那么重要吗？这只是一个标签。

我会联系团队并在他们将其标记为此类之前找出需要做的事情，也许您可​​以贡献一些错误修复等......

开源的好处是如果你发现了一个错误，你可以自己修复它。因此，如果您愿意花一点时间，它不是 1.0 的风险会稍微降低。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-01T04:26:27.120

不确定这是否重要...查看官方博客 - NAnt 没有死，它只是在休息

[https://sourceforge.net/apps/wordpress/nant/2010/04/05/nants-not-dead-it-was-just-resting/](https://sourceforge.net/apps/wordpress/nant/2010/04/05/nants-not-dead-it-was-just-resting/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T15:58:02.177

开源项目倾向于使用比商业产品更“谦虚”的版本，而商业产品往往更受营销驱动。差异的一个很好的例子是 Java 版本控制方案，它从 1.0 到 1.4，然后当它到 1.5 版本时，它又转向使用版本 5（尽管 1.5 是内部名称）。

# coding-style - 线宽格式标准

> ID：276022
> 
> 赞同：34
> 
> 时间：2008-11-09T15:36:25.900
> 
> 标签：coding-style, formatting

您是否遵循在源代码中包装长行的标准？你觉得读起来最舒服的行长是多少？

有时我发现有人在宽屏显示器上编程，喜欢用它的全宽来显示源代码。我更喜欢较短的行数，大约 80-100 个字符，但我很难用越来越受欢迎的宽屏设备来说服同事。

*编辑：*

类似问题：

*   [在当今时代，是否有正当理由在代码文件中强制规定最大宽度为 80 个字符？](https://stackoverflow.com/questions/110928/)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-10T00:40:12.810

不要损害关于一行中确切字符数的教条规则的可读性。水平滚动是不可取的，但 81 个字符的行比缩进混淆的换行版本更容易阅读。

80 characters is likely to be inadaquate for programming styles with large indentations and/or verbose variable names. Keep the amount of logical complexity down to a per-line maximum, not the number of characters.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-09T15:53:41.483

我坚持 80 行规则（并试图说服每个人都这样做）。一些原因：

1.  您可以一次打开 2 个（或更多）编辑器。
2.  比较工具也是如此。- 大多数（全部？）并排显示两个（一些三个（一些更多？））文件。
3.  有时您需要远程工作，在不同的工作站或笔记本电脑上工作，突然间，您格式精美的 120 字符到行代码看起来很糟糕。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-09T17:18:53.993

我更喜欢更长的行，原因很简单：我可以在窗口中放入更多代码。必须垂直滚动才能读取函数与能够将其放入单个屏幕之间存在*巨大差异。*如果所有内容都是换行的，以便函数从底部滚动而我的屏幕右半部分是空的，我认为这是一种巨大的浪费。请注意，在这里打开两个编辑器窗口也无济于事。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-09T15:43:34.967

您不必水平滚动即可阅读代码。但更大的屏幕并不意味着更长的线路！一行中应该有多少也有限制。

所以我说：和往常一样保持在 70-80 个字符。更大的屏幕只是意味着 IDE 有更多的空间。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-09T17:14:54.533

它还取决于您使用的其他约定。在一项工作中，我们使用 Java 进行编程，惯例是使用长且描述性的标识符，这意味着只有几个标识符可以放在一行中，而不会超过 80 个字符的限制。考虑到公司里的每个开发人员都得到了一个可以轻松容纳 200 个字符的宽屏显示器，我认为这非常愚蠢。有了这样的硬件一致性，强制执行一个愚蠢的小换行限制是没有意义的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-09T16:01:06.553

我们使用一行 80 个字符的编码标准。80 字符限制的最初原因与今天无关，但应该选择一些数字......

除了显而易见的（代码组织和可读性）之外，我通常发现长行是不良样式的结果，遵循这样的规则可以提高代码质量并减少错误。只需比较以下示例：

```
status = do_something(); 
if (status == error)
{
    do_error_handling();
    return;
} 
/* do you regular flow */
status = do_more();
if (status == error)
{
    do_error_handling();
    return; 
}
/* do more of you regular flow  and keep you line 80 chars*/ 
```

反而 ：

```
status = do_something(); 
if (status == succes)
{
     /* do you regular flow */
     status = do_more();
     if (status == success)
     {
            /* do you regular flow */
            /*  nest again and get line behind visible screen */
     }
     else
     {
         /* do error handling */ 
     }

}
else
{
     /* do error handling */ 
} 
```

第二个示例的可读性要低得多，难以维护，并且可能会导致一些问题......

**编辑**

在代码中替换`goto` 为`do_error_handling()`以避免不相关的讨论。

正如我之前所说的 80 个字符与今天无关，它只是一个数字 100 也很好。

对于发现第二个示例更具可读性的任何人，请使用真实代码再嵌套几次，然后再次尝试阅读:)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-09T16:37:26.683

更大的屏幕——更大的字体。`Conslas`我在 1280x800 屏幕分辨率下使用 14pt 最大化的 GVim 。我尝试以大约 80-90% 的屏幕宽度换行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T15:52:51.063

我几乎只在笔记本电脑上编程，所以我同意较短的行。当然，我通常为 PDA 设计屏幕，所以我可以侥幸逃脱。但如果代码在开发人员之间共享，它最终会出现在某人的笔记本电脑上，滚动条让我哭泣。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-09T21:21:30.540

我使用大约 72-75 列来确保我可以在字母格式的页面上打印代码而不会太麻烦。我也使用空格而不是制表符，并且对布局很小心。

为了注意我何时离开右边距，我经常输入一个可以用作标尺的文本行。我设置了 IDE 显示窗口，使标尺刚好适合水平宽度，然后我确保我不会超出它。

我在 .txt 文档以及 .c、.java、.cpp、批处理文件等中执行此操作。这使得在电子邮件中发送片段、在博客上发帖、发表评论等变得更容易。标尺通常是就在标识文件和文本格式的顶行下方：

```
/* example.txt 0.00                  UTF-8                   dh:2008-11-09
*---|----1----|----2----|----3----|----4----|----5----|----6----|----7----*
*/ 
```

当然，使用特定类型文件的注释约定。

# regex - 正则表达式用链接替换单词

> ID：276029
> 
> 赞同：3
> 
> 时间：2008-11-09T15:42:55.967
> 
> 标签：regex, string, replace

我想编写一个正则表达式，用链接替换单词 Paris，因为只有这个词还没有准备好作为链接的一部分。

例子：

```
 i'm living <a href="Paris" atl="Paris link">in Paris</a>, near Paris <a href="gare">Gare du Nord</a>,  i love Paris. 
```

会成为

```
 i'm living.........near <a href="">Paris</a>..........i love <a href="">Paris</a>. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T16:54:21.783

这很难一步完成。编写一个这样的正则表达式几乎是不可能的。

尝试两步法。

1.  在每个“巴黎”周围放置一个链接，无论是否已经存在另一个链接。
2.  查找所有错误嵌套的链接 ( `<a href="..."><a href="...">Paris</a></a>`)，并消除内部链接。

第一步的正则表达式非常简单：

```
\bParis\b 
```

第二步的正则表达式稍微复杂一些：

```
(<a[^>]+>.*?(?!:</a>))<a[^>]+>(Paris)</a> 
```

在整个字符串上使用那个并将其替换为匹配组 1 和 2 的内容，有效地删除了多余的内部链接。

正则表达式 #2 的简单解释：

*   查找每个链接 ( `<a[^>]+>`)，可选地后跟任何不是本身的链接 ( `.*?(?!:</a>)`)。将其保存到匹配组 1。
*   现在寻找下一个链接 ( `<a[^>]+>`)。确保它在那里，但不要保存它。
*   现在寻找“巴黎”这个词。将其保存到匹配组 2。
*   寻找关闭链接 ( `</a>`)。确保它在那里，但不要保存它。
*   将所有内容替换为第 1 组和第 2 组的内容，从而丢失您未保存的所有内容。

该方法假设以下附带条件：

*   您的输入 HTML 并没有严重损坏。
*   您的正则表达式支持非贪婪量词 (.*?) 和零宽度负前瞻断言 ( `(?!:...)`)。
*   您仅在步骤 1 中的链接中包含“Paris”一词，没有其他字符。每个“ `Paris`”都变成“ `<a href"...">Paris</a>`”，否则第二步将失败（直到您更改第二个正则表达式）。
*   顺便说一句：regex #2 明确允许这样的结构：

    `<a href="">in the <b>capital of France</b>, <a href="">Paris</a></a>`

    剩余链接来自步骤一，步骤二的替换结果将是：

    `<a href="">in the <b>capital of France</b>, Paris</a>`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T09:07:51.567

您可以搜索此正则表达式：

```
(<a[^>]*>.*?</a>)|Paris 
```

这个正则表达式匹配一个链接，它捕获到第一个（也是唯一的）捕获组或单词 Paris。

仅当捕获组不匹配任何内容时，才将匹配项替换为您的链接。

例如在 C# 中：

```
resultString = 
    Regex.Replace(
        subjectString, 
        "(<a[^>]*>.*?</a>)|Paris", 
        new MatchEvaluator(ComputeReplacement));

public String ComputeReplacement(Match m) {
    if (m.groups(1).Success) {
        return m.groups(1).Value;
    } else {
        return "<a href=\"link to paris\">Paris</a>";
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T16:32:10.733

此类问题的传统答案：使用真正的 HTML 解析器。因为 RE 并不擅长在上下文中操作。而且 HTML 很复杂，“a”标签可以有或没有属性，以任何顺序，可以在链接中是否有 HTML，等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T16:29:21.567

**正则表达式：**

```
!(<a.*</a>.*)*Paris!isU 
```

**替换：**

```
$1<a href="Paris">Paris</a> 
```

$1 指的是第一个子模式（至少在 PHP 中）。根据您使用的语言，它可能会略有不同。

这应该用替换中的链接替换所有出现的“巴黎”。它只是检查所有打开的 a-Tag 在“Paris”之前是否已关闭。

PHP 示例：

```
<?php
$s = 'i\'m living <a href="Paris" atl="Paris link">in Paris</a>, near Paris <a href="gare">Gare du Nord</a>, i love Paris.'; 
$regex = '!(<a.*</a>.*)*Paris!isU'; 
$replace = '$1<a href="Paris">Paris</a>'; 
$result = preg_replace( $regex, $replace, $s); 
?> 
```

添加：

这不是最好的解决方案。此正则表达式不起作用的一种情况是当您有一个 img-Tag 时，它不在 a-Element 内。当您将该图像的标题属性设置为“巴黎”时，该“巴黎”也将被替换。这不是你想要的。尽管如此，我认为无法使用简单的正则表达式完全解决您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T23:06:23.450

如果您不限于在这种情况下使用正则表达式，那么 XSLT 是您可以定义此替换的语言的不错选择，因为它“理解”XML。

您定义了两个模板：一个模板查找链接并删除那些没有“Paris”作为正文的链接。另一个模板查找其他所有内容，将其拆分为单词并添加标签。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-12T12:55:43.907

```
 $pattern = 'Paris';
  $text = 'i\'m living <a href="Paris" atl="Paris link">in Paris</a>,  near Paris <a href="gare">Gare du Nord</a>,  i love Paris.';

  // 1\. Define 2 arrays:
  //  $matches[1] - array of links with our keyword
  //  $matches[2] - array of keyword
  preg_match_all('@(<a[^>]*?>[^<]*?'.$pattern.'[^<]*?</a>)|(?<!\pL)('.$pattern.')(?!\pL)@', $text, $matches);

  // Exists keywords for replace? Define first keyword without tag <a>
  $number = array_search($pattern, $matches[2]);

  // Keyword exists, let's go rock
  if ($number !== FALSE) {

    // Replace all link with temporary value
    foreach ($matches[1] as $k => $tag) {
      $text = preg_replace('@(<a[^>]*?>[^<]*?'.$pattern.'[^<]*?</a>)@', 'KEYWORD_IS_ALREADY_LINK_'.$k, $text, 1);
    }

    // Replace our keywords with link
    $text = preg_replace('/(?<!\pL)('.$pattern.')(?!\pL)/', '<a href="">'.$pattern.'</a>', $text);

    // Return link
    foreach ($matches[1] as $k => $tag) {

      $text = str_replace('KEYWORD_IS_ALREADY_LINK_'.$k, $tag, $text);
    }

    // It's work!
    echo $text;
  } 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-11-10T01:01:26.993

正则表达式不会替换。语言可以。

语言和库也会从包含您关心的单词列表的数据库或文件中读取，并将 URL 与其名称相关联。这是我可以想象的最简单的替换我的单个正则表达式（perl 用于*替换*语法。）

```
s/([a-z-']+)/<a href="http:\/\/en.wikipedia.org\/wiki\/$1">$1<\/a>/i 
```

正确的名称可能会更好：

```
s/([A-Z][a-z-']+)/<a href="http:\/\/en.wikipedia.org\/wiki\/$1">$1<\/a>/gi; 
```

当然，“巴吞鲁日”将成为两个链接：

```
<a href="http://en.wikipedia.org/wiki/Baton">Baton</a> 
<a href="http://en.wikipedia.org/wiki/Rouge">Rouge</a> 
```

在*Perl*中，您可以这样做：

```
my $barred_list_of_cities 
    = join( '|'
    , sort { ( length $a <=> $b ) || ( $a cmp $b ) } keys %url_for_city_of
    );
s/($barred_list_of_cities)/<a href="$url_for_city_of{$1}">$1<\/a>/g; 
```

但同样，它是一种为正则表达式实现一组操作的*语言*，正则表达式不做任何事情。（实际上，这是一个非常常见的应用程序，如果没有[CPAN](http://cpan.org/)模块可以做到这一点，我会感到惊讶，而您只需要加载哈希。

# visual-c++ - _configthreadlocale 和 localeconv

> ID：276030
> 
> 赞同：3
> 
> 时间：2008-11-09T15:43:00.023
> 
> 标签：visual-c++, locale, localeconv

众所周知，全局数据，如影响数字小数点 printf() 和 strtod() 正在使用的区域设置，是邪恶的。幸运的是，MSVC++ 9 允许通过`_configthreadlocale(_ENABLE_PER_THREAD_LOCALE)`调用使用每个线程的语言环境。不幸的是，localeconv() 函数似乎没有注意到这一点，并且仍然返回全局语言环境设置，例如 localeconv()->decimal_point 似乎总是在 _configthreadlocale() 调用之前返回全局语言环境设置。这是 MSVC 库中的错误还是预期的？

TIA 帕沃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-10-10T01:29:27.087

尽管建议这是 rubenvb 的预期行为，但这实际上是我不久前遇到的一个错误。我怀疑 rubenvb 误读了这部分问题：

> 不幸的是，localeconv() 函数似乎没有注意到这一点，并且仍然返回全局语言环境设置，例如 localeconv()->decimal_point 似乎总是在 _configthreadlocale() 调用之前返回全局语言环境设置。

这个问题并不打算让 localeconv() 在调用 _configthreadlocale() 之前基于每个线程返回，因为这会破坏时间连续性。问题是在调用 _configthreadlocale() 之后调用 localeconv() 的结果与之前调用它的结果相同，这是出乎意料的。这实质上意味着使用 _configthreadlocale() 时，Microsoft 对 C++ STL 流的实现从根本上被破坏了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-22T14:21:42.317

对`_configthreadlocale`设置属性的调用，在调用之前，没有什么特别的事情发生。所以是的，这是预期的行为。您首先必须调用此函数，然后才能利用线程本地语言环境。

# php - 使用 PHP 删除 FTP 存档中具有特定名称的所有目录

> ID：276033
> 
> 赞同：1
> 
> 时间：2008-11-09T15:45:07.570
> 
> 标签：php, ftp

如果对服务器的唯一访问是通过 FTP，那么如何删除目录树中具有特定名称的所有目录？

为了澄清，我想遍历目录树并通过 FTP 删除名称与某个字符串匹配的每个目录。一种在 PHP 中实现这一点的方法会很好——我应该从哪里开始？此外，如果有人知道任何已经这样做的实用程序，那也很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T20:13:03.253

这是一个起点 - 一个函数，它将扫描 FTP 目录并打印树中与模式匹配的任何目录的名称。我已经对其进行了简要测试。

```
function scan_ftp_dir($conn, $dir, $pattern) {
    $files = ftp_nlist($conn, $dir);
    if (!$files) {
        return;
    }

    foreach ($files as $file) {
        //the quickest way i can think of to check if is a directory
        if (ftp_size($conn, $file) == -1) {

            //get just the directory name
            $dirName = substr($file, strrpos($file, '/') + 1);

            if (preg_match($pattern, $dirName)) {
                echo $file . ' matched pattern';
            } else {        
                //directory didn't match pattern, recurse   
                scan_ftp_dir($conn, $file, $pattern);
            }
        } 
    }
} 
```

然后做这样的事情

```
$host = 'localhost';
$user = 'user';
$pass = 'pass';

if (false === ($conn = ftp_connect($host))) {
    die ('cannot connect');
}

if (!ftp_login($conn, $user, $pass)) die ('cannot authenticate');

scan_ftp_dir($conn, '.', '/^beginswith/'); 
```

不幸的是，您只能使用 删除一个空目录`ftp_rmdir()`，但如果您查看[此处](http://theserverpages.com/php/manual/en/function.ftp-rmdir.php)，则有一个名为的函数`ftp_rmAll()`，您可以使用它来删除您找到的整个目录结构。

此外，我只在 Unix 上测试了使用从返回的失败状态`ftp_size()`作为检查返回的项目`ftp_nlist()`是否是目录的方法的技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T15:52:36.633

大概这个问题比它最初出现的要多。

FTP支持DIR列出目录内容，RMDIR删除目录，DEL删除文件，所以它支持你需要的操作。

或者您在问如何遍历 FTP 目录树？

您对此有首选/必需的实现语言吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T16:39:19.930

好吧，这是我最终使用的脚本。这是一个相当具体的实例，必须使用它，但如果您处于与我相同的困境中，只需输入您的 ftp 服务器地址、用户名、密码、您要删除的文件夹的名称以及路径要开始的文件夹，这将遍历目录，删除与名称匹配的所有文件夹。如果与服务器的连接断开，则重新连接会出现错误，因此如果它断开连接，您可能需要再次运行脚本。

```
 if( $argc == 2 ) {
        $directoryToSearch = $argv[1];
        $host = '';
        $username = '';
        $password = '';
        $connection = connect( $host, $username, $password );
        deleteDirectoriesWithName( $connection, 'directoryToDelete', $directoryToSearch );
        ftp_close( $connection );
        exit( 0 );
}
else {
        cliPrint( "This script currently only supports 1 argument.\n");
        cliPrint( "Usage: php deleteDirectories.php directoryNameToSearch\n");
        exit( 1 );
}

/**
 * Recursively traverse directories and files starting with the path
 * passed in and then delete all directories that match the name
 * passed in
 * @param $connection the connection resource to the database.  
 * @param $name the name of the directories that should be * deleted.
 * @param $path the path to start searching from
 */
function deleteDirectoriesWithName( &$connection, $name, $path ) {
        global $host, $username, $password;
        cliPrint( "At path: $path\n" );
        //Get a list of files in the directory
        $list = ftp_nlist( $connection, $path );
        if ( empty( $list ) ) {
                $rawList = ftp_rawlist( $connection, $path );
                if( empty( $rawList ) ) {
                        cliPrint( "Reconnecting\n");
                        ftp_close( $connection );
                        $connection = connect( $host, $username, $password );
                        cliPrint( "Reconnected\n" );
                        deleteDirectoriesWithName( $connection, $name, $path );
                        return true;
                }

                $pathToPass = addSlashToEnd( $path );
                $list = RawlistToNlist( $rawList, $pathToPass );
        }
        //If we have selected a directory, then 'visit' the files (or directories) in the dir
        if ( $list[0] != $path ) {
                $path = addSlashToEnd( $path );
                //iterate through all of the items listed in the directory
                foreach ( $list as $item ) {
                        //if the directory matches the name to be deleted, delete it recursively
                        if ( $item == $name ) {
                                DeleteDirRecursive( $connection, $path . $item );
                        }

                        //otherwise continue traversing
                        else if ( $item != '..' && $item != '.' ) {
                                deleteDirectoriesWithName( $connection, $name, $path . $item );
                        }
                }
        }
        return true;
}

/**
 *Put output to STDOUT
 */
function cliPrint( $string ) {
        fwrite( STDOUT, $string );
}

/**
 *Connect to the ftp server
 */
function connect( $host, $username, $password ) {
        $connection = ftp_connect( $host );
        if ( !$connection ) {
                die('Could not connect to server: ' . $host );
        }
        $loginSuccessful = ftp_login( $connection, $username, $password );
        if ( !$loginSuccessful ) {
                die( 'Could not login as: ' . $username . '@' . $host );
        }
        cliPrint( "Connection successful\n" );
        return $connection;
}

/**
 *    Delete the provided directory and all its contents from the FTP-server.
 *
 *    @param string $path Path to the directory on the FTP-server relative to
 *    the current working directory
 */
function DeleteDirRecursive(&$resource, $path) {
        global $host, $username, $password;
        cliPrint( $path . "\n" );
        $result_message = "";

        //Get a list of files and directories in the current directory
        $list = ftp_nlist($resource, $path);

        if ( empty($list) ) {
                $listToPass = ftp_rawlist( $resource, $path );
                if ( empty( $listToPass ) ) {
                        cliPrint( "Reconnecting\n" );
                        ftp_close( $resource );
                        $resource = connect( $host, $username, $password );
                        $result_message = "Reconnected\n";
                        cliPrint( "Reconnected\n" );
                        $result_message .= DeleteDirRecursive( $resource, $path );
                        return $result_message;
                }
                $list = RawlistToNlist( $listToPass, addSlashToEnd( $path ) );
        }

        //if the current path is a directory, recursively delete the file within and then
        //delete the empty directory
        if ($list[0] != $path) {
                $path = addSlashToEnd( $path );
                foreach ($list as $item) {
                        if ($item != ".." && $item != ".") {
                                $result_message .= DeleteDirRecursive($resource, $path . $item);
                        }
                }
                cliPrint( 'Delete: ' . $path . "\n" );
                if (ftp_rmdir ($resource, $path)) {

                        cliPrint( "Successfully deleted $path\n" );
                } else {

                        cliPrint( "There was a problem deleting $path\n" );
                }
        }
        //otherwise delete the file
        else {
                cliPrint( 'Delete file: ' . $path . "\n" );
                if (ftp_delete ($resource, $path)) {
                        cliPrint( "Successfully deleted $path\n" );
                } else {

                        cliPrint( "There was a problem deleting $path\n" );
                }
        }
        return $result_message;
}

/**
*    Convert a result from ftp_rawlist() to a result of ftp_nlist()
*
*    @param array $rawlist        Result from ftp_rawlist();
*    @param string $path Path to the directory on the FTP-server relative 
*    to the current working directory
*    @return array An array with the paths of the files in the directory
*/
function RawlistToNlist($rawlist, $path) {
        $array = array();
        foreach ($rawlist as $item) {
                $filename = trim(substr($item, 55, strlen($item) - 55));
                if ($filename != "." || $filename != "..") {
                        $array[] = $filename;
                }
        }
        return $array;
}

/**
 *Adds a '/' to the end of the path if it is not already present.
 */
function addSlashToEnd( $path ) {
        $endOfPath = substr( $path, strlen( $path ) - 1, 1 );
        if( $endOfPath == '/' ) {
                $pathEnding = '';
        }
        else {
                $pathEnding = '/';
        }

        return $path . $pathEnding;
} 

```

# php - 如何使用 PHP 中的对象从 MYSQL 数据库中连接/检索数据？

> ID：276040
> 
> 赞同：1
> 
> 时间：2008-11-09T15:52:43.577
> 
> 标签：php, oop

通常，我使用标准方式连接和检索数据（为简单起见，删除了错误检查）：

```
$db = mysql_select_db("dbname", mysql_connect("host","username","passord"));
$items = mysql_query("SELECT * FROM $db");

while($item = mysql_fetch_array($items)) {
    my_function($item[rowname]);
} 
```

my_function 对特定行做了一些有用的事情。

使用对象的等效代码是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T16:18:16.863

从 5.1 版开始，PHP 附带了 PDO 驱动程序，它为准备好的语句提供了一个类。

```
$dbh = new PDO("mysql:host=$hostname;dbname=$db", $username, $password); //connect to the database
//each :keyword represents a parameter or value to be bound later
$query= $dbh->prepare('SELECT * FROM users WHERE id = :id AND password = :pass');

# Variables are set here.
$query->bindParam(':id', $id); // this is a pass by reference 
$query->bindValue(':pass', $pass); // this is a pass by value

$query->execute(); // query is run

// to get all the data at once
$res = $query->fetchall();
print_r($res); 
```

请参阅[php.net 上的 PDO 驱动程序](http://ca3.php.net/manual/en/book.pdo.php)

请注意，只要您使用 binbParam 或 bindValue，这种方式（使用准备好的语句）将自动转义所有需要并且是执行 mysql 查询的最安全方式之一。

还有[mysqli](http://ca3.php.net/manual/en/book.mysqli.php) 扩展来做类似的任务，但我个人觉得 PDO 更干净。

就 PHP 而言，整个过程并使用所有这些步骤可能是比其他任何方法更好的解决方案。

然后，您可以使用[$query->fetchobject](http://ca3.php.net/manual/en/pdostatement.fetchobject.php)将您的数据作为对象检索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T16:14:18.307

您可以使用 mysql_fetch_object()

[http://is2.php.net/manual/en/function.mysql-fetch-object.php](http://is2.php.net/manual/en/function.mysql-fetch-object.php)

# java - 如何更改 JTable 单元格中的数据？

> ID：276043
> 
> 赞同：1
> 
> 时间：2008-11-09T15:53:43.667
> 
> 标签：java, jtable

我可以在 JTable 构造函数中设置数据，然后用户可以在程序手动运行时更改这些数据（从键盘键入）。

但是如果我想更改某些列中的数据，我应该使用什么方法？要更改列标题，我使用 TableColumn 方法 setHeaderValue。我应该使用什么来设置 JTable 单元格中的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T15:58:12.690

如果要允许用户编辑数据，则需要在希望人们编辑的单元格上设置 TableCellEditor。您可能还想开始使用 TableModel 而不是在 JTable 本身中对数据进行硬编码。

请参阅[http://java.sun.com/docs/books/tutorial/uiswing/components/table.html](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:06:51.287

创建 JTable 时，您首先需要指定特定列的值是可编辑的。您显然还可以提供基于行的编辑功能。但是您应该在创建表本身时定义所有这些内容。如果您需要任何帮助，请回复。

# python - 如何在 Python 中获取当前的 CPU 和 RAM 使用情况？

> ID：276052
> 
> 赞同：441
> 
> 时间：2008-11-09T16:04:50.213
> 
> 标签：python, system, cpu, status, ram

在 Python 中获取当前系统状态（当前 CPU、RAM、可用磁盘空间等）的首选方式是什么？unix 和 Windows 平台的奖励积分。

似乎有几种可能的方法可以从我的搜索中提取它：

1.  使用诸如[PSI](http://www.psychofx.com/psi/trac/wiki/)之类的库（目前似乎没有积极开发并且在多个平台上不受支持）或类似[pystatgrab 之](http://www.i-scream.org/pystatgrab/)类的东西（自 2007 年以来似乎没有任何活动，并且不支持 Windows）。

2.  使用特定于平台的代码，例如`os.popen("ps")`在 *nix 系统中使用 a 或类似代码，在 Windows 平台上使用`MEMORYSTATUS`in `ctypes.windll.kernel32`（参见[ActiveState 上](http://code.activestate.com/recipes/511491/)的这个秘籍）。可以将 Python 类与所有这些代码片段放在一起。

并不是说这些方法不好，而是已经有一种得到良好支持的多平台方法来做同样的事情？

* * *

## 回答 #1

> 赞同：541
> 
> 时间：2010-03-18T10:24:30.273

[psutil 库](https://pypi.python.org/pypi/psutil)为您提供有关各种平台上的 CPU、RAM 等的信息：

> psutil 是一个模块，它提供了一个接口，用于通过使用 Python 以可移植的方式检索有关正在运行的进程和系统利用率（CPU、内存）的信息，实现了 ps、top 和 Windows 任务管理器等工具提供的许多功能。
> 
> 它目前支持 Linux、Windows、OSX、Sun Solaris、FreeBSD、OpenBSD 和 NetBSD，32 位和 64 位架构，Python 版本从 2.6 到 3.5（Python 2.4 和 2.5 的用户可以使用 2.1.3 版本）。

* * *

一些例子：

```
#!/usr/bin/env python
import psutil
# gives a single float value
psutil.cpu_percent()
# gives an object with many fields
psutil.virtual_memory()
# you can convert that object to a dictionary 
dict(psutil.virtual_memory()._asdict())
# you can have the percentage of used RAM
psutil.virtual_memory().percent
79.2
# you can calculate percentage of available memory
psutil.virtual_memory().available * 100 / psutil.virtual_memory().total
20.8 
```

以下是提供更多概念和兴趣概念的其他文档：

*   [https://psutil.readthedocs.io/en/latest/](https://psutil.readthedocs.io/en/latest/)

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2016-08-16T21:07:35.690

使用[psutil 库](https://pypi.org/project/psutil/)。在 Ubuntu 18.04 上，截至 2019 年 1 月 30 日，pip 安装了 5.5.0（最新版本）。旧版本的行为可能会有所不同。您可以通过在 Python 中执行以下操作来检查您的 psutil 版本：

```
from __future__ import print_function  # for Python2
import psutil
print(psutil.__versi‌​on__) 
```

要获取一些内存和 CPU 统计信息：

```
from __future__ import print_function
import psutil
print(psutil.cpu_percent())
print(psutil.virtual_memory())  # physical memory usage
print('memory % used:', psutil.virtual_memory()[2]) 
```

（`virtual_memory`元组）将具有系统范围内使用的内存百分比。在 Ubuntu 18.04 上，这似乎被我高估了几个百分点。

您还可以获取当前 Python 实例使用的内存：

```
import os
import psutil
pid = os.getpid()
python_process = psutil.Process(pid)
memoryUse = python_process.memory_info()[0]/2.**30  # memory use in GB...I think
print('memory use:', memoryUse) 
```

它给出了 Python 脚本的当前内存使用情况。

[在psutil](https://pypi.org/project/psutil/)的 pypi 页面上有一些更深入的示例。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2017-02-16T13:24:10.293

仅适用于 Linux：仅依赖于 stdlib 的 RAM 使用单线：

```
import os
tot_m, used_m, free_m = map(int, os.popen('free -t -m').readlines()[-1].split()[1:]) 
```

编辑：指定的解决方案操作系统依赖

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2017-02-15T12:24:45.757

下面的代码，没有为我工作的外部库。我在 Python 2.7.9 测试过

**CPU使用率**

```
import os

    CPU_Pct=str(round(float(os.popen('''grep 'cpu ' /proc/stat | awk '{usage=($2+$4)*100/($2+$4+$5)} END {print usage }' ''').readline()),2))

    #print results
    print("CPU Usage = " + CPU_Pct) 
```

**和 Ram 使用情况、总计、已使用和免费**

```
import os
mem=str(os.popen('free -t -m').readlines())
"""
Get a whole line of memory output, it will be something like below
['             total       used       free     shared    buffers     cached\n', 
'Mem:           925        591        334         14         30        355\n', 
'-/+ buffers/cache:        205        719\n', 
'Swap:           99          0         99\n', 
'Total:        1025        591        434\n']
 So, we need total memory, usage and free memory.
 We should find the index of capital T which is unique at this string
"""
T_ind=mem.index('T')
"""
Than, we can recreate the string with this information. After T we have,
"Total:        " which has 14 characters, so we can start from index of T +14
and last 4 characters are also not necessary.
We can create a new sub-string using this information
"""
mem_G=mem[T_ind+14:-4]
"""
The result will be like
1025        603        422
we need to find first index of the first space, and we can start our substring
from from 0 to this index number, this will give us the string of total memory
"""
S1_ind=mem_G.index(' ')
mem_T=mem_G[0:S1_ind]
"""
Similarly we will create a new sub-string, which will start at the second value. 
The resulting string will be like
603        422
Again, we should find the index of first space and than the 
take the Used Memory and Free memory.
"""
mem_G1=mem_G[S1_ind+8:]
S2_ind=mem_G1.index(' ')
mem_U=mem_G1[0:S2_ind]

mem_F=mem_G1[S2_ind+8:]
print 'Summary = ' + mem_G
print 'Total Memory = ' + mem_T +' MB'
print 'Used Memory = ' + mem_U +' MB'
print 'Free Memory = ' + mem_F +' MB' 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2020-05-20T10:00:23.817

要获得程序**的逐行**内存和时间分析，我建议使用`memory_profiler`and `line_profiler`。

**安装：**

```
# Time profiler
$ pip install line_profiler
# Memory profiler
$ pip install memory_profiler
# Install the dependency for a faster analysis
$ pip install psutil 
```

共同点是，您可以使用相应的装饰器指定要分析的函数。

示例：我的 Python 文件`main.py`中有几个要分析的函数。其中之一是`linearRegressionfit()`。我需要使用装饰器`@profile`来帮助我分析代码：时间和内存。

**对函数定义进行以下更改**

```
@profile
def linearRegressionfit(Xt,Yt,Xts,Yts):
    lr=LinearRegression()
    model=lr.fit(Xt,Yt)
    predict=lr.predict(Xts)
    # More Code 
```

对于**时间分析**，

**跑：**

```
$ kernprof -l -v main.py 
```

输出

```
Total time: 0.181071 s
File: main.py
Function: linearRegressionfit at line 35

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    35                                           @profile
    36                                           def linearRegressionfit(Xt,Yt,Xts,Yts):
    37         1         52.0     52.0      0.1      lr=LinearRegression()
    38         1      28942.0  28942.0     75.2      model=lr.fit(Xt,Yt)
    39         1       1347.0   1347.0      3.5      predict=lr.predict(Xts)
    40                                           
    41         1       4924.0   4924.0     12.8      print("train Accuracy",lr.score(Xt,Yt))
    42         1       3242.0   3242.0      8.4      print("test Accuracy",lr.score(Xts,Yts)) 
```

对于**内存分析**，

**跑：**

```
$ python -m memory_profiler main.py 
```

输出

```
Filename: main.py

Line #    Mem usage    Increment   Line Contents
================================================
    35  125.992 MiB  125.992 MiB   @profile
    36                             def linearRegressionfit(Xt,Yt,Xts,Yts):
    37  125.992 MiB    0.000 MiB       lr=LinearRegression()
    38  130.547 MiB    4.555 MiB       model=lr.fit(Xt,Yt)
    39  130.547 MiB    0.000 MiB       predict=lr.predict(Xts)
    40                             
    41  130.547 MiB    0.000 MiB       print("train Accuracy",lr.score(Xt,Yt))
    42  130.547 MiB    0.000 MiB       print("test Accuracy",lr.score(Xts,Yts)) 
```

此外，还可以使用以下方法绘制内存分析器`matplotlib`结果

```
$ mprof run main.py
$ mprof plot 
```

[![在此处输入图像描述](https://i.stack.imgur.com/EXEXg.png)](https://i.stack.imgur.com/EXEXg.png) 注意：测试于

`line_profiler`版本 == 3.0.2

`memory_profiler`版本 == 0.57.0

`psutil`版本 == 5.7.0

* * *

编辑：分析器的结果可以使用[TAMPPA](https://github.com/pra-dan/TAMPPA/blob/master/README.md)包进行解析。使用它，我们可以获得逐行所需的图 ![阴谋](https://github.com/pra-dan/TAMPPA/raw/master/resources/mem_res.png)

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2021-10-10T00:26:43.603

`tqdm`结合和可以得到实时的 CPU 和 RAM 监控`psutil`。在运行繁重的计算/处理时可能会很方便。

[![在此处输入图像描述](https://i.stack.imgur.com/NaEJh.gif)](https://i.stack.imgur.com/NaEJh.gif)

它也适用于 Jupyter，无需任何代码更改：

[![在此处输入图像描述](https://i.stack.imgur.com/WkxtP.png)](https://i.stack.imgur.com/WkxtP.png)

```
from tqdm import tqdm
from time import sleep
import psutil

with tqdm(total=100, desc='cpu%', position=1) as cpubar, tqdm(total=100, desc='ram%', position=0) as rambar:
    while True:
        rambar.n=psutil.virtual_memory().percent
        cpubar.n=psutil.cpu_percent()
        rambar.refresh()
        cpubar.refresh()
        sleep(0.5) 
```

此代码片段也[可用作 gist](https://gist.github.com/karolzlot/26864e21e7347ce41f71f87f156ea266)。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-11-10T02:38:51.197

这是我不久前整理的东西，它只是 Windows，但可以帮助您完成您需要完成的部分工作。

源自：“for sys 可用内存” [http://msdn2.microsoft.com/en-us/library/aa455130.aspx](http://msdn2.microsoft.com/en-us/library/aa455130.aspx)

《个别进程信息及python脚本示例》 [http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true](http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true)

注意：WMI 接口/进程也可用于执行类似的任务，我在这里没有使用它，因为当前方法满足了我的需求，但如果有一天需要扩展或改进它，那么可能需要研究 WMI 工具.

用于 python 的 WMI：

[http://tgolden.sc.sabren.com/python/wmi.html](http://tgolden.sc.sabren.com/python/wmi.html)

编码：

```
'''
Monitor window processes

derived from:
>for sys available mem
http://msdn2.microsoft.com/en-us/library/aa455130.aspx

> individual process information and python script examples
http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true

NOTE: the WMI interface/process is also available for performing similar tasks
        I'm not using it here because the current method covers my needs, but if someday it's needed
        to extend or improve this module, then may want to investigate the WMI tools available.
        WMI for python:
        http://tgolden.sc.sabren.com/python/wmi.html
'''

__revision__ = 3

import win32com.client
from ctypes import *
from ctypes.wintypes import *
import pythoncom
import pywintypes
import datetime

class MEMORYSTATUS(Structure):
    _fields_ = [
                ('dwLength', DWORD),
                ('dwMemoryLoad', DWORD),
                ('dwTotalPhys', DWORD),
                ('dwAvailPhys', DWORD),
                ('dwTotalPageFile', DWORD),
                ('dwAvailPageFile', DWORD),
                ('dwTotalVirtual', DWORD),
                ('dwAvailVirtual', DWORD),
                ]

def winmem():
    x = MEMORYSTATUS() # create the structure
    windll.kernel32.GlobalMemoryStatus(byref(x)) # from cytypes.wintypes
    return x    

class process_stats:
    '''process_stats is able to provide counters of (all?) the items available in perfmon.
    Refer to the self.supported_types keys for the currently supported 'Performance Objects'

    To add logging support for other data you can derive the necessary data from perfmon:
    ---------
    perfmon can be run from windows 'run' menu by entering 'perfmon' and enter.
    Clicking on the '+' will open the 'add counters' menu,
    From the 'Add Counters' dialog, the 'Performance object' is the self.support_types key.
    --> Where spaces are removed and symbols are entered as text (Ex. # == Number, % == Percent)
    For the items you wish to log add the proper attribute name in the list in the self.supported_types dictionary,
    keyed by the 'Performance Object' name as mentioned above.
    ---------

    NOTE: The 'NETFramework_NETCLRMemory' key does not seem to log dotnet 2.0 properly.

    Initially the python implementation was derived from:
    http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true
    '''
    def __init__(self,process_name_list=[],perf_object_list=[],filter_list=[]):
        '''process_names_list == the list of all processes to log (if empty log all)
        perf_object_list == list of process counters to log
        filter_list == list of text to filter
        print_results == boolean, output to stdout
        '''
        pythoncom.CoInitialize() # Needed when run by the same process in a thread

        self.process_name_list = process_name_list
        self.perf_object_list = perf_object_list
        self.filter_list = filter_list

        self.win32_perf_base = 'Win32_PerfFormattedData_'

        # Define new datatypes here!
        self.supported_types = {
                                    'NETFramework_NETCLRMemory':    [
                                                                        'Name',
                                                                        'NumberTotalCommittedBytes',
                                                                        'NumberTotalReservedBytes',
                                                                        'NumberInducedGC',    
                                                                        'NumberGen0Collections',
                                                                        'NumberGen1Collections',
                                                                        'NumberGen2Collections',
                                                                        'PromotedMemoryFromGen0',
                                                                        'PromotedMemoryFromGen1',
                                                                        'PercentTimeInGC',
                                                                        'LargeObjectHeapSize'
                                                                     ],

                                    'PerfProc_Process':              [
                                                                          'Name',
                                                                          'PrivateBytes',
                                                                          'ElapsedTime',
                                                                          'IDProcess',# pid
                                                                          'Caption',
                                                                          'CreatingProcessID',
                                                                          'Description',
                                                                          'IODataBytesPersec',
                                                                          'IODataOperationsPersec',
                                                                          'IOOtherBytesPersec',
                                                                          'IOOtherOperationsPersec',
                                                                          'IOReadBytesPersec',
                                                                          'IOReadOperationsPersec',
                                                                          'IOWriteBytesPersec',
                                                                          'IOWriteOperationsPersec'     
                                                                      ]
                                }

    def get_pid_stats(self, pid):
        this_proc_dict = {}

        pythoncom.CoInitialize() # Needed when run by the same process in a thread
        if not self.perf_object_list:
            perf_object_list = self.supported_types.keys()

        for counter_type in perf_object_list:
            strComputer = "."
            objWMIService = win32com.client.Dispatch("WbemScripting.SWbemLocator")
            objSWbemServices = objWMIService.ConnectServer(strComputer,"root\cimv2")

            query_str = '''Select * from %s%s''' % (self.win32_perf_base,counter_type)
            colItems = objSWbemServices.ExecQuery(query_str) # "Select * from Win32_PerfFormattedData_PerfProc_Process")# changed from Win32_Thread        

            if len(colItems) > 0:        
                for objItem in colItems:
                    if hasattr(objItem, 'IDProcess') and pid == objItem.IDProcess:

                            for attribute in self.supported_types[counter_type]:
                                eval_str = 'objItem.%s' % (attribute)
                                this_proc_dict[attribute] = eval(eval_str)

                            this_proc_dict['TimeStamp'] = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S.') + str(datetime.datetime.now().microsecond)[:3]
                            break

        return this_proc_dict      

    def get_stats(self):
        '''
        Show process stats for all processes in given list, if none given return all processes   
        If filter list is defined return only the items that match or contained in the list
        Returns a list of result dictionaries
        '''    
        pythoncom.CoInitialize() # Needed when run by the same process in a thread
        proc_results_list = []
        if not self.perf_object_list:
            perf_object_list = self.supported_types.keys()

        for counter_type in perf_object_list:
            strComputer = "."
            objWMIService = win32com.client.Dispatch("WbemScripting.SWbemLocator")
            objSWbemServices = objWMIService.ConnectServer(strComputer,"root\cimv2")

            query_str = '''Select * from %s%s''' % (self.win32_perf_base,counter_type)
            colItems = objSWbemServices.ExecQuery(query_str) # "Select * from Win32_PerfFormattedData_PerfProc_Process")# changed from Win32_Thread

            try:  
                if len(colItems) > 0:
                    for objItem in colItems:
                        found_flag = False
                        this_proc_dict = {}

                        if not self.process_name_list:
                            found_flag = True
                        else:
                            # Check if process name is in the process name list, allow print if it is
                            for proc_name in self.process_name_list:
                                obj_name = objItem.Name
                                if proc_name.lower() in obj_name.lower(): # will log if contains name
                                    found_flag = True
                                    break

                        if found_flag:
                            for attribute in self.supported_types[counter_type]:
                                eval_str = 'objItem.%s' % (attribute)
                                this_proc_dict[attribute] = eval(eval_str)

                            this_proc_dict['TimeStamp'] = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S.') + str(datetime.datetime.now().microsecond)[:3]
                            proc_results_list.append(this_proc_dict)

            except pywintypes.com_error, err_msg:
                # Ignore and continue (proc_mem_logger calls this function once per second)
                continue
        return proc_results_list     

def get_sys_stats():
    ''' Returns a dictionary of the system stats'''
    pythoncom.CoInitialize() # Needed when run by the same process in a thread
    x = winmem()

    sys_dict = { 
                    'dwAvailPhys': x.dwAvailPhys,
                    'dwAvailVirtual':x.dwAvailVirtual
                }
    return sys_dict

if __name__ == '__main__':
    # This area used for testing only
    sys_dict = get_sys_stats()

    stats_processor = process_stats(process_name_list=['process2watch'],perf_object_list=[],filter_list=[])
    proc_results = stats_processor.get_stats()

    for result_dict in proc_results:
        print result_dict

    import os
    this_pid = os.getpid()
    this_proc_results = stats_processor.get_pid_stats(this_pid)

    print 'this proc results:'
    print this_proc_results 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2018-09-29T15:30:44.360

为此，我们选择使用通常的信息源，因为我们可以发现可用内存的瞬时波动，并且觉得查询**meminfo**数据源很有帮助。这也帮助我们获得了更多预先解析的相关参数。

**代码**

```
import os

linux_filepath = "/proc/meminfo"
meminfo = dict(
    (i.split()[0].rstrip(":"), int(i.split()[1]))
    for i in open(linux_filepath).readlines()
)
meminfo["memory_total_gb"] = meminfo["MemTotal"] / (2 ** 20)
meminfo["memory_free_gb"] = meminfo["MemFree"] / (2 ** 20)
meminfo["memory_available_gb"] = meminfo["MemAvailable"] / (2 ** 20) 
```

**输出供参考**（我们删除了所有换行符以进行进一步分析）

> MemTotal：1014500 kB MemFree：562680 kB MemAvailable：646364 kB 缓冲区：15144 kB 缓存：210720 kB SwapCached：0 kB 活动：261476 kB 非活动：128888 kB 活动（匿名）：167092 kB 非活动（匿名）：208 : 94384 kB 非活动(文件): 108000 kB Unevictable: 3652 kB Mlocked: 3652 kB SwapTotal: 0 kB SwapFree: 0 kB Dirty: 0 kB Writeback: 0 kB AnonPages: 168160 kB Mapped: 81352 kB Shmem: 21060 kB Slab: 34492 SReclaimable：18044 KB Sunreclable：16448 KB攻击：8180 KB NFS_UNSTABLE：0 KB弹跳：0 KB WERCHBACKTMP：0 KB ComputLimit：507248 KB Commited_AS：34359738367 KB vmallocused：0 kB vmallocchunk：0 kb hardwarecurrupted：0 kb hardwarecurrupted： 0 kB AnonHugePages：88064 kB CmaTotal：0 kB CmaFree：0 kB HugePages_Total：0 HugePages_Free：0 HugePages_Rsvd：0 HugePages_Surp：0 Hugepagesize：2048 kB DirectMap4k：43008 kB DirectMap2M：1005568 kB

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2018-03-24T17:43:01.717

我觉得这些答案是为 Python 2 编写的，并且无论如何没有人提到[`resource`](https://docs.python.org/3/library/resource.html)可用于 Python 3 的标准包。它提供了用于获取给定进程（默认调用 Python 进程）的资源*限制的命令。*这与获取整个系统的当前资源*使用情况*不同，但它可以解决一些相同的问题，例如“我想确保我在这个脚本中只使用 X 多 RAM”。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2020-12-10T14:43:19.047

这汇集了所有的好处： `psutil`+`os`获得 Unix 和 Windows 兼容性： 这使我们能够获得：

1.  中央处理器
2.  记忆
3.  磁盘

代码：

```
import os
import psutil  # need: pip install psutil

In [32]: psutil.virtual_memory()
Out[32]: svmem(total=6247907328, available=2502328320, percent=59.9, used=3327135744, free=167067648, active=3671199744, inactive=1662668800,     buffers=844783616, cached=1908920320, shared=123912192, slab=613048320)

In [33]: psutil.virtual_memory().percent
Out[33]: 60.0

In [34]: psutil.cpu_percent()
Out[34]: 5.5

In [35]: os.sep
Out[35]: '/'

In [36]: psutil.disk_usage(os.sep)
Out[36]: sdiskusage(total=50190790656, used=41343860736, free=6467502080, percent=86.5)

In [37]: psutil.disk_usage(os.sep).percent
Out[37]: 86.5 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-09T18:50:34.417

“...当前系统状态（当前 CPU、RAM、可用磁盘空间等）”和“*nix 和 Windows 平台”可能是难以实现的组合。

操作系统在管理这些资源的方式上有着根本的不同。实际上，它们在核心概念上有所不同，例如定义什么是系统以及什么是应用程序时间。

“可用磁盘空间”？什么算作“磁盘空间”？所有设备的所有分区？多引导环境中的外部分区呢？

我认为 Windows 和 *nix 之间没有足够明确的共识来使这成为可能。事实上，在称为 Windows 的各种操作系统之间甚至可能没有任何共识。是否有一个适用于 XP 和 Vista 的 Windows API？

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-07-07T15:16:06.520

从第一反应中获取反馈并进行小改动

```
#!/usr/bin/env python
#Execute commond on windows machine to install psutil>>>>python -m pip install psutil
import psutil

print ('                                                                   ')
print ('----------------------CPU Information summary----------------------')
print ('                                                                   ')

# gives a single float value
vcc=psutil.cpu_count()
print ('Total number of CPUs :',vcc)

vcpu=psutil.cpu_percent()
print ('Total CPUs utilized percentage :',vcpu,'%')

print ('                                                                   ')
print ('----------------------RAM Information summary----------------------')
print ('                                                                   ')
# you can convert that object to a dictionary 
#print(dict(psutil.virtual_memory()._asdict()))
# gives an object with many fields
vvm=psutil.virtual_memory()

x=dict(psutil.virtual_memory()._asdict())

def forloop():
    for i in x:
        print (i,"--",x[i]/1024/1024/1024)#Output will be printed in GBs

forloop()
print ('                                                                   ')
print ('----------------------RAM Utilization summary----------------------')
print ('                                                                   ')
# you can have the percentage of used RAM
print('Percentage of used RAM :',psutil.virtual_memory().percent,'%')
#79.2
# you can calculate percentage of available memory
print('Percentage of available RAM :',psutil.virtual_memory().available * 100 / psutil.virtual_memory().total,'%')
#20.8 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-10-01T07:06:46.510

此脚本用于 CPU 使用：

```
import os

def get_cpu_load():
    """ Returns a list CPU Loads"""
    result = []
    cmd = "WMIC CPU GET LoadPercentage "
    response = os.popen(cmd + ' 2>&1','r').read().strip().split("\r\n")
    for load in response[1:]:
       result.append(int(load))
    return result

if __name__ == '__main__':
    print get_cpu_load() 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-04-21T12:14:41.803

*   有关 CPU 详细信息，请使用**psutil**库

    > [https://psutil.readthedocs.io/en/latest/#cpu](https://psutil.readthedocs.io/en/latest/#cpu)

*   对于 RAM 频率（以 MHz 为单位），请使用内置的 Linux 库**dmidecode**并稍微操作输出；）。此命令需要 root 权限，因此也提供您的密码。只需复制以下建议，将**mypass**替换为您的密码

> `import os`
> 
> `os.system("echo mypass | sudo -S dmidecode -t memory | grep 'Clock Speed' | cut -d ':' -f2")`
> 
> ------------------- 产量 ---------------
> 1600 MT/ s
> 未知
> 1600 MT/s
> 未知 0

*   更具体地说
    `[i for i in os.popen("echo mypass | sudo -S dmidecode -t memory | grep 'Clock Speed' | cut -d ':' -f2").read().split(' ') if i.isdigit()]`

> - - - - - - - - - - - - - 输出 - - - - - - - - - - - - --
> ['1600', '1600']

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-11-10T16:03:01.370

您可以阅读 /proc/meminfo 以获取已用内存

```
file1 = open('/proc/meminfo', 'r') 

for line in file1: 
    if 'MemTotal' in line: 
        x = line.split()
        memTotal = int(x[1])

    if 'Buffers' in line: 
        x = line.split()
        buffers = int(x[1])

    if 'Cached' in line and 'SwapCached' not in line: 
        x = line.split()
        cached = int(x[1])

    if 'MemFree' in line: 
        x = line.split()
        memFree = int(x[1])

file1.close()

percentage_used = int ( ( memTotal - (buffers + cached + memFree) ) / memTotal * 100 )
print(percentage_used) 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-03-31T14:57:48.967

您可以将 psutil 或 psmem 与子流程示例代码一起使用

```
import subprocess
cmd =   subprocess.Popen(['sudo','./ps_mem'],stdout=subprocess.PIPE,stderr=subprocess.PIPE) 
out,error = cmd.communicate() 
memory = out.splitlines() 
```

参考

[https://github.com/Leo-g/python-flask-cmd](https://github.com/Leo-g/python-flask-cmd)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-10-22T15:50:26.827

根据@Hrabal 的 cpu 使用代码，这是我使用的：

```
from subprocess import Popen, PIPE

def get_cpu_usage():
    ''' Get CPU usage on Linux by reading /proc/stat '''

    sub = Popen(('grep', 'cpu', '/proc/stat'), stdout=PIPE, stderr=PIPE)
    top_vals = [int(val) for val in sub.communicate()[0].split('\n')[0].split[1:5]]

    return (top_vals[0] + top_vals[2]) * 100\. /(top_vals[0] + top_vals[2] + top_vals[3]) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-01T15:14:09.703

使用 crontab 运行不会打印 pid

设置：`*/1 * * * * sh dog.sh`这一行在`crontab -e`

```
import os
import re

CUT_OFF = 90

def get_cpu_load():
    cmd = "ps -Ao user,uid,comm,pid,pcpu --sort=-pcpu | head -n 2 | tail -1"
    response = os.popen(cmd, 'r').read()
    arr = re.findall(r'\S+', response)
    print(arr)
    needKill = float(arr[-1]) > CUT_OFF
    if needKill:
        r = os.popen(f"kill -9 {arr[-2]}")
        print('kill:', r)

if __name__ == '__main__':
    # Test CPU with 
    # $ stress --cpu 1
    # crontab -e
    # Every 1 min
    # */1 * * * * sh dog.sh
    # ctlr o, ctlr x
    # crontab -l
    print(get_cpu_load()) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-26T17:23:32.400

[@CodeGench](https://stackoverflow.com/users/5203370)的[解决方案](https://stackoverflow.com/a/42249349/)不需要外壳，因此假设 Linux 和 Python 的标准库：

```
def cpu_load(): 
    with open("/proc/stat", "r") as stat:
        (key, user, nice, system, idle, _) = (stat.readline().split(None, 5))
    assert key == "cpu", "'cpu ...' should be the first line in /proc/stat"
    busy = int(user) + int(nice) + int(system)
    return 100 * busy / (busy + int(idle)) 
```

* * *

## 回答 #20

> 赞同：-12
> 
> 时间：2008-11-09T17:25:10.067

我不相信有一个支持良好的多平台库可用。请记住，Python 本身是用 C 语言编写的，因此任何库都会像您上面建议的那样，对运行哪个特定于操作系统的代码片段做出明智的决定。

# c++ - 对于最大吞吐量，UDP 数据包的最佳大小是多少？

> ID：276058
> 
> 赞同：38
> 
> 时间：2008-11-09T16:11:52.663
> 
> 标签：c++, windows, linux, network-programming, udp

我需要通过**可能有损**的网络将数据包从一台主机发送到另一台主机。为了最大限度地减少数据包延迟，我不考虑 TCP/IP。但是，我希望最大化使用 UDP 的吞吐量。要使用的 UDP 数据包的最佳大小应该是多少？

以下是我的一些考虑：

*   网络中交换机的 MTU 大小为 1500。如果我使用大数据包，例如 8192，这会导致分片。丢失一个片段会导致整个数据包丢失，对吗？

*   如果我使用较小的数据包，我会产生 UDP 和 IP 标头的开销

*   如果我使用一个非常大的数据包，我可以使用的最大数据包是多少？我读到最大的数据报大小是 65507。我应该使用什么缓冲区大小来允许我发送这样的大小？这会有助于提高我的吞吐量吗？

*   常见操作系统（例如 Windows、Linux 等）支持的典型最大数据报大小是多少？

更新：

一些数据的接收者是没有实现 TCP/IP 堆栈的嵌入式系统。

我知道这个地方到处都是非常坚持使用可用的东西的人。但我希望有更好的答案，而不是只关注 MTU。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-09T16:45:23.797

替代答案：小心不要重新发明轮子。

TCP 是数十年网络经验的产物。它所做的每一件事或几乎每一件事都有一个共鸣。它有几种大多数人不经常考虑的算法（拥塞控制、重传、缓冲区管理、处理重新排序的数据包等）。

如果您开始重新实现所有 TCP 算法，您可能会遇到一个（引用[Greenspun 的第十条规则](http://en.wikipedia.org/wiki/Greenspun%27s_Tenth_Rule)）“临时的、非正式指定的、漏洞百出的、缓慢的 TCP 实现”。

如果您还没有这样做，那么查看 TCP/UDP 的一些最新替代方案可能是个好主意，例如 SCTP 或 DCCP。它们是为 TCP 和 UDP 都不是很好匹配的领域而设计的，正是为了允许人们使用已经“调试过”的协议，而不是为每个新应用程序重新发明轮子。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-09T16:29:24.267

找到理想数据包大小的最佳方法是完全按照 TCP 本身为找到理想数据包大小所做的工作：[路径 MTU 发现](http://en.wikipedia.org/wiki/Path_MTU_discovery)。

TCP 也有一个广泛使用的选项，双方告诉对方他们的 MSS（基本上，MTU 减去标头）是什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-11T03:59:47.707

在 c# 中找到 mtu 的最简单的解决方法是发送 udp 数据包并将 dontfragment 标志设置为 true。如果它引发异常，请尝试减小数据包大小。这样做直到没有抛出异常。您可以从 1500 个数据包大小开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T11:58:32.143

好吧，我有一个非 MTU 的答案给你。使用连接的 UDP 套接字应该为您加快速度。在 UDP 套接字上调用 connect 有两个原因。首先是效率。当您在未连接的 UDP 套接字上调用 sendto 时，会发生内核临时连接套接字、发送数据然后断开连接的情况。我读到一项研究表明，这在发送时占用了近 30% 的处理时间。调用 connect 的另一个原因是您可以获得 ICMP 错误消息。在未连接的 UDP 套接字上，内核不知道将 ICMP 错误传递给哪个应用程序，因此它们只会被丢弃。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-09T17:09:01.567

要考虑的另一件事是某些网络设备不能很好地处理碎片。我们已经看到许多路由器丢弃分段的 UDP 数据包或太大的数据包。[CesarB](https://stackoverflow.com/users/28258/cesarb)建议使用 Path MTU 是一个很好的建议。

最大吞吐量不仅仅由数据包大小驱动（尽管这当然有贡献）。最小化延迟和最大化吞吐量通常是相互矛盾的。在 TCP 中，您拥有 Nagle 算法，该算法（部分）旨在提高整体吞吐量。然而，一些协议（例如，telnet）经常禁用 Nagle（即，设置 No Delay 位）以改善延迟。

您对数据有一些实时限制吗？流式音频不同于推送非实时数据（例如，日志信息），因为前者受益于低延迟，而后者受益于增加的吞吐量和可能的可靠性。有可靠性要求吗？如果你不能丢失数据包并且必须有一个协议来请求重传，这将降低整体吞吐量。

有无数其他因素会影响这一点，并且（正如另一个响应中所建议的）在某些时候你会得到一个糟糕的 TCP 实现。话虽这么说，如果您想实现低延迟并且可以容忍使用 UDP 将整体数据包大小设置为 PATH MTU 的丢失（确保设置有效负载大小以考虑标头）可能是最佳解决方案（尤其是如果您可以保证UDP可以从一端到达另一端。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T16:51:30.400

IP 标头 >= 20 字节，但大部分为 20，UDP 标头为 8 字节。这将为您留下 1500 - 28 = 1472 字节的数据。PATH MTU 发现在到达目的地的途中找到可能的最小 MTU。但这并不一定意味着，当您使用最小的 MTU 时，您将获得可能的最佳性能。我认为最好的方法是做一个基准测试。或者，也许您根本不应该关心最小的 MTU。网络设备可以很好地使用一个小的 MTU，并且也可以非常快速地传输数据包。而且它的价值在未来很可能会发生变化。因此，您无法发现它并将其保存在某个地方以供以后使用，您必须定期进行。如果我是你，我会将 MTU 设置为 1440 之类的东西并对应用程序进行基准测试...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T16:17:33.197

即使交换机上的 MTU 是 1500，您也可能会遇到一些情况（例如通过 VPN 进行隧道传输），在数据包周围包裹一些额外的标头 - 您最好稍微减少它们，然后达到 1450 左右。

你能模拟网络并测试不同数据包大小的性能吗？

# c++ - 实现 count_permutations 的更好方法？

> ID：276066
> 
> 赞同：1
> 
> 时间：2008-11-09T16:18:23.943
> 
> 标签：c++, algorithm, math

我需要一个函数 count_permutations() 来返回给定范围的排列数。*假设允许修改范围，并从第一个排列开始，*我可以天真地将其实现为对 next_permutation() 的重复调用，如下所示：

```
template<class Ret, class Iter>
Ret count_permutations(Iter first, Iter last)
{
    Ret ret = 0;
    do {
        ++ret;
    } while (next_permutation(first, last));
    return ret;
} 
```

*有没有一种更快的方法不需要遍历所有排列来找到答案？它仍然可以假设输入可以被修改，并从第一个排列开始，但显然如果可以在没有这些假设的情况下实现它也会很棒。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T16:25:54.647

所有元素都是唯一的范围的排列数是 n！其中 n 是范围的长度。

如果有重复元素，您可以使用 n!/(n_0!)...(n_m!) 其中 n_0...n_m 是重复范围的长度。

因此，例如 [1,2,3] 有 3！= 6 个排列，而 [1,2,2] 有 3!/2! = 3个排列。

**编辑：**一个更好的例子是 [1,2,2,3,3,3] 它有 6!/2!3! = 60 个排列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T16:31:06.040

在数学中，函数 factorial !n 表示 n 个元素的排列数。

正如 Can Berg 和 Greg 建议的那样，如果一个集合中有重复的元素，为了将它们考虑在内，我们必须将阶乘除以每个不可区分的组（由相同元素组成的组）的排列数。

以下实现计算范围 [first, end) 中元素的排列数。范围不需要排序。

```
// generic factorial implementation...

int factorial(int number) {
    int temp;
    if(number <= 1) return 1;
    temp = number * factorial(number - 1);
    return temp;
}

template<class Ret, class Iter>
Ret count_permutations(Iter first, Iter end)
{
    std::map<typename Iter::value_type, int> counter;
    Iter it = first;
    for( ; it != end; ++it) {
        counter[*it]++;
    }

    int n = 0;
    typename std::map<typename Iter::value_type, int>::iterator mi = counter.begin();
    for(; mi != counter.end() ; mi++)
        if ( mi->second > 1 )
            n += factorial(mi->second);

   return factorial(std::distance(first,end))/n;
} 
```

# ruby-on-rails - 关于使用 Rails 构建购物车/结账的问题

> ID：276072
> 
> 赞同：3
> 
> 时间：2008-11-09T16:28:15.780
> 
> 标签：ruby-on-rails, cart, shopping, awdwr

我刚刚学习了使用 Rails 3rd Ed. 进行敏捷 Web 开发，我正在阅读 Depot 应用程序章节，我有一个关于产品/项目选项的问题-

如果我想修改产品目录和商店以便产品可以有选项（尺寸、颜色等），我会在哪里/如何做到这一点？

假设我在卖 T 恤，它们有不同的尺寸。我觉得这不是真正需要创建一个模型来处理尺寸的东西，所以我想我可以将它作为选择框添加到商店视图中的 html 中。

但是，每个“添加到购物车”按钮都由 button_to 自动生成的表单标签包裹，并且似乎无法让我将其他参数传递给我的购物车。如何获取添加到 POST 到 add_to_cart 的项目的大小？

也许更重要**的是——最 Railsy 的方式是什么？**

提前感谢您的帮助！ - 标记

我认为的帮手：

```
<%= button_to "Add to Cart" , :action => :add_to_cart, :id => product %> 
```

它生成的形式：

```
<form method="post" action="/store/add_to_cart/3" class="button-to"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-11T04:28:00.633

好的，2天后，我想通了。这是我必须做的——

# 1、在我的店铺视图中：

```
<% form_for @product, :url => {:action => "add_to_cart", :id => @product} do |f| %>
  <select name="productsize" id="productsize">
    <option value="L">L</option>
    <option value="XL">XL</option>
  </select>
  <%= f.submit 'Add to Cart' %>
<% end %> 
```

# 2、添加到我的商店控制器：

```
productsize = params[:productsize]
@cart.add_product(product, productsize) 
```

必须从参数中获取 productsize，然后将其与产品模型的其余部分一起传递给购物车模型的 add_product 操作。

# 3、调整购物车模型以接受参数，并且：

```
@items << CartItem.new(product, productsize) 
```

将它与产品模型的其余部分一起传递，以创建一个新的购物车项目并将其添加到项目中。

# 4、加入cart_item模型：

```
attr_reader :product, :quantity, :productsize

def initialize(product, productsize)
@product = product
@productsize = productsize 
```

读取 productsize 并初始化 Cart Item。

# 5、添加到我的 add_to_cart 视图中：

```
Size: <%=h item.productsize %> 
```

为用户显示它。

而已。如果有更简单或更干燥的方法来解决它，我会全神贯注（眼睛？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T16:37:50.363

我不确定您为什么不存储尺寸，除非您的意思是将尺寸存储为 cart_item 而不是产品的一部分，这很好。在这种情况下，你会做这样的事情：

```
<% form_for(@cart_item) do |f| %>
<%= f.select :size, ['S', 'M', 'L', 'XL', 'XXL'] %>
<%= f.hidden_field :product_id, :value => @product.id %> 
# other properties...
<%= f.submit 'Add to Cart' %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T14:08:50.040

您需要为模型添加属性。为此，您需要创建一个迁移来更新您的数据库表。我只有这本书的第 2 版，但有一个名为“迭代 A2：添加缺失的列”的部分描述了如何执行此操作。我假设类似的部分将在第 3 版中。

之后，您可以按照 Can Berk Güder 的建议，将按钮替换为表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T16:34:58.577

我会放弃`button_to`帮助程序并使用适当的表单，将产品属性提交给`add_to_cart`操作。

```
<% form_for(@product) do |f| %>
<%= f.select :size, ['S', 'M', 'L', 'XL', 'XXL'] %>
# other properties...
<%= f.submit 'Add to Cart' %>
<% end %> 
```

# javascript - 防止 AJAX 内存泄漏

> ID：276087
> 
> 赞同：8
> 
> 时间：2008-11-09T16:38:13.390
> 
> 标签：javascript, ajax, browser, memory-leaks

我正在开发一个 Web 应用程序，该应用程序旨在显示一组使用 AJAX 定期更新的数据。一般的使用场景是用户整天打开它，不时看一眼。

我遇到了一个问题，即浏览器内存占用随着时间的推移缓慢增长。这发生在 Firefox 和 IE 7 中（虽然不在 Chrome 中）。几个小时后，它会导致 IE7 的占用空间约为 200MB，而 FF3 的占用空间约为 400MB。

经过大量测试，我发现只有在响应 AJAX 调用时才会发生内存泄漏。如果服务器没有响应任何东西，我可以让页面打开几个小时，并且占用空间不会增加。

我正在为我的 AJAX 调用使用原型。所以，我猜想创建这些内存泄漏的 onSuccess 回调存在问题。

有没有人有任何关于使用原型/AJAX 防止内存泄漏的提示？或有关如何解决此问题的任何方法？

编辑：发现问题出在我正在使用的 js 图形库中。可以在[这里](http://code.google.com/p/flotr/issues/detail?id=5)看到。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-09T16:59:35.657

您可以注意的最重要的事情是事件，以及您如何分配它们。

例如，采取这种情况（因为您没有提供一个）：

```
<div id="ajaxResponseTarget">
    ...
</div>
<script type="text/javascript">
    $(someButton).observe('click', function() {
        new Ajax.Updater($('ajaxResponseTarget'), someUrl, {
            onSuccess: function() {
                $$('#ajaxResponseTarget .someButtonClass').invoke('observe', 'click', function() {
                    ...
                });
            }
        });
    });
</script> 
```

这将造成内存泄漏，因为当`#ajaxResponseTarget`更新时（在内部，Prototype 将使用`innerHTML`）带有事件的元素`click`将从文档中删除，而不会删除它们的事件。第二次单击`someButton`时，您将拥有两倍的事件处理程序，并且垃圾收集无法删除第一组。

避免这种情况的一种方法是使用事件委托：

```
<div id="ajaxResponseTarget">
    ...
</div>
<script type="text/javascript">
    $('ajaxResponseTarget').observe('click', function(e) {
        if(e.element().match('.someButtonClass')) {
            ...
        }
    });
    $(someButton).observe('click', function() {
        new Ajax.Updater($('ajaxResponseTarget'), someUrl);
    });
</script> 
```

由于 DOM 事件的工作方式，“click” on`.someButtonClass`也会触发 on `#ajaxResponseTarget`，并且 Prototype 使得确定哪个元素是事件的目标变得非常简单。没有事件分配给*内* `#ajaxResponseTarget`的元素，因此无法将其内容替换为内目标的孤立事件。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-11-09T16:43:47.920

我可能错了，但听起来您正在围绕响应对象创建闭包。每个响应对象都会不同，这会导致内存占用增加。

# c# - 在 ASP.NET 中处理大文件传输时应采取哪些预防措施？

> ID：276088
> 
> 赞同：1
> 
> 时间：2008-11-09T16:38:26.277
> 
> 标签：c#, asp.net, large-files, file-transfer

我的 ASP.NET 应用程序允许用户上传和下载大文件。这两个过程都涉及读取和写入文件流。我应该怎么做才能确保应用程序在处理大文件时不会挂起或崩溃？例如，文件操作是否应该在工作线程上处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T16:48:14.307

确保正确缓冲文件，以免它们占用系统中过多的内存。

例如，从下载应用程序中摘录，在读取文件的 while 循环内：

```
// Read the data in buffer.
length = iStream.Read(buffer, 0, bufferSize);

// Write the data to the current output stream.
Response.OutputStream.Write(buffer, 0, length); 
```

如果 bufferSize 是合理的，例如 100000 字节，则权衡是对于较小的缓冲区大小会更慢。

[http://support.microsoft.com/kb/812406](http://support.microsoft.com/kb/812406)

编辑：还要确保 IIS 设置为采用足够大的[请求长度](http://dwnz.spaces.live.com/Blog/cns!BCC0973FC7B19D91!643.entry)（IIS7）和超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T16:54:37.630

除非这是您网站的主要目的，否则请考虑将这些操作划分为单独的应用程序，例如子应用程序或子域。除了降低风险之外，这还将随着用户群的增长而简化扩展。

# c++ - C ++将mac id字符串转换为uint8_t数组

> ID：276099
> 
> 赞同：1
> 
> 时间：2008-11-09T16:49:11.013
> 
> 标签：c++, string, networking, parsing

我想从命令行读取一个 mac id 并将其转换为一个`uint8_t`值数组以在结构中使用它。我无法让它工作。我有一个用于 mac id 拆分的字符串向量，`:`我想用它`stringstream`来转换它们，但没有运气。我错过了什么？

```
int parseHex(const string &num){
  stringstream ss(num);
  ss << std::hex;
  int n;
  ss >> n;  
  return n;
}

uint8_t tgt_mac[6] = {0, 0, 0, 0, 0, 0};
  v = StringSplit( mac , ":" );
  for( int j = 0 ; j < v.size() ; j++ ){
    tgt_mac[j] = parseHex(v.at(j)); 
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-30T01:55:41.007

我讨厌以这种方式回答这个问题，但这`sscanf()`可能是解析 MAC 地址的最简洁的方法。它处理零/非零填充、宽度检查、大小写折叠以及所有其他没人喜欢处理的东西。无论如何，这是我的 C++ 版本：

```
void
parse_mac(std::vector<uint8_t>& out, std::string const& in) {
    unsigned int bytes[6];
    if (std::sscanf(in.c_str(),
                    "%02x:%02x:%02x:%02x:%02x:%02x",
                    &bytes[0], &bytes[1], &bytes[2],
                    &bytes[3], &bytes[4], &bytes[5]) != 6)
    {
        throw std::runtime_error(in+std::string(" is an invalid MAC address"));
    }
    out.assign(&bytes[0], &bytes[6]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T21:26:43.417

您的问题可能出在解析数据的输出中。"<<" 运算符根据传递给它的数据类型决定如何显示数据，并且 uint8_t 可能会被解释为 char。确保在打印时将数组值转换为整数，或在调试器中进行调查。

示例程序：

```
uint8_t tgt_mac[6] = {0};
std::stringstream ss( "AA:BB:CC:DD:EE:11" );
char trash;

for ( int i = 0; i < 6; i++ )
{
    int foo;
    ss >> std::hex >> foo >> trash;
    tgt_mac[i] = foo;
    std::cout << std::hex << "Reading: " << foo << std::endl;
}

std::cout << "As int array: " << std::hex
    << (int) tgt_mac[0]
    << ":"
    << (int) tgt_mac[1]
    << ":"
    << (int) tgt_mac[2]
    << ":"
    << (int) tgt_mac[3]
    << ":"
    << (int) tgt_mac[4]
    << ":"
    << (int) tgt_mac[5]
    << std::endl;
std::cout << "As unint8_t array: " << std::hex
    << tgt_mac[0]
    << ":"
    << tgt_mac[1]
    << ":"
    << tgt_mac[2]
    << ":"
    << tgt_mac[3]
    << ":"
    << tgt_mac[4]
    << ":"
    << tgt_mac[5]
    << std::endl; 
```

给出以下输出（cygwin g++）

```
Reading: aa
Reading: bb
Reading: cc
Reading: dd
Reading: ee
Reading: 11
As int array: aa:bb:cc:dd:ee:11
As unint8_t array: ª:»:I:Y:î:◄ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T21:52:30.057

首先我想指出，我认为@Steven 的答案是一个非常好的答案——事实上我也注意到了这一点：值是正确的，但输出看起来很尴尬。这是由于`ostream& operator<<( ostream&, unsigned char )`被使用了，因为`uint8_t`您使用的类型是 typedef `unsigned char`（正如我在 linux 手册页中找到的那样）。请注意，在 VC++ 上，typedef 不存在，您必须使用`unsigned __int8`它（这也会将您引导到`char`专业化）。

接下来，您可以像这样*测试*您的代码（与输出无关）：

```
assert( uint8_t( parseHex( "00" ) ) == uint8_t(0) );
assert( uint8_t( parseHex( "01" ) ) == uint8_t(1) );
//...
assert( uint8_t( parseHex( "ff" ) ) == uint8_t(255) ); 
```

除了史蒂文的回答，我只想指出`transform`算法的存在，它仍然可以简化你的代码。

```
for( int j = 0 ; j < v.size() ; j++ ){
  tgt_mac[j] = parseHex(v.at(j)); 
} 
```

在一行中写道：

```
std::transform( v.begin(), v.end(), tgt_mac, &parseHex ); 
```

（而且我知道这与问题无关......）

（请参阅[codepad.org](http://codepad.org/d8roEuBP)了解它的外观）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T17:16:56.480

我认为您在错误的地方使用了 std::hex ：

```
#include <sstream>
#include <iostream>

int main()
{
    std::string     h("a5");
    std::stringstream   s(h);
    int x;

    s >> std::hex >> x;
    std::cout << "X(" << x << ")\n";
} 
```

# c++ - 捕获所有未处理的 C++ 异常？

> ID：276102
> 
> 赞同：27
> 
> 时间：2008-11-09T16:51:01.913
> 
> 标签：c++, exception, exception-handling

是否有某种方法可以捕获未处理的异常（包括那些在 catch 块之外抛出的异常）？

我并不真正关心使用异常完成的所有正常清理工作，只是我可以捕获它，将其写入日志/通知用户并退出程序，因为这些情况下的异常通常是致命的、不可恢复的错误。

就像是：

```
global_catch()
{
    MessageBox(NULL,L"Fatal Error", L"A fatal error has occured. Sorry for any inconvience", MB_ICONERROR);
    exit(-1);
}
global_catch(Exception *except)
{
    MessageBox(NULL,L"Fatal Error", except->ToString(), MB_ICONERROR);
    exit(-1);
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-09T16:54:24.293

这可用于捕获意外异常。

```
catch (...)
{
    std::cout << "OMG! an unexpected exception has been caught" << std::endl;
} 
```

如果没有 try catch 块，我认为您无法捕获异常，因此请构建您的程序，以便异常代码在 try/catch 的控制下。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-03-08T13:51:59.403

查看[`std::set_terminate()`](http://en.cppreference.com/w/cpp/error/set_terminate)

编辑：这是一个带有异常匹配的完整示例：

```
#include <iostream>
#include <exception>
#include <stdexcept>

struct FooException: std::runtime_error {
    FooException(const std::string& what): std::runtime_error(what) {}
};

int main() {
    std::set_terminate([]() {
        try {
            std::rethrow_exception(std::current_exception());
        } catch (const FooException& e) {
            std::cerr << "Unhandled FooException: " << e.what() << std::endl;
        } catch (const std::exception& e) {
            std::cerr << "Unhandled exception: " << e.what() << std::endl;
        } catch (...) {
            std::cerr << "Unhandled exception of unknown type" << std::endl;
        }

        std::abort();
    });

    throw FooException("Bad things have happened.");
    // throw std::runtime_error("Bad things have happened.");
    // throw 9001;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-09T17:24:24.327

您可以在 Windows 上使用[SetUnhandledExceptionFilter](http://msdn.microsoft.com/en-us/library/ms680634.aspx)，它将捕获所有未处理的 SEH 异常。

通常，这足以解决您的所有问题，因为 IIRC 所有 C++ 异常都是作为 SEH 实现的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-09T18:34:49.333

没有任何 catch 块，您将不会捕获任何异常。您可以在 main() 中有一个 catch(...) 块（以及每个附加线程中的等价物）。在这个 catch 块中，您可以恢复异常详细信息，并且可以对它们执行一些操作，例如记录和退出。

但是，一般的 catch(...) 块也有缺点：系统发现异常已由您处理，因此不再提供任何帮助。在 Unix/Linux 上，此帮助将构成创建一个 CORE 文件，您可以将其加载到调试器中并查看未例外异常的原始位置。如果您使用 catch(...) 处理它，则此信息已经丢失。

在 Windows 上，没有 CORE 文件，所以我建议使用 catch(...) 块。从该块中，您通常会调用一个函数来恢复实际的异常：

```
std::string ResurrectException()
   try {
       throw;
   } catch (const std::exception& e) {
       return e.what();
   } catch (your_custom_exception_type& e) {
       return e.ToString();
   } catch(...) {
       return "Ünknown exception!";
   }
}

int main() {
   try {
       // your code here
   } catch(...) {
       std::string message = ResurrectException();
       std::cerr << "Fatal exception: " << message << "\n";
   }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-09T18:44:54.290

**更新**：这仅涵盖 c++98。

从Meyers 的《[更有效的 C++](https://rads.stackoverflow.com/amzn/click/com/020163371X)》（第 76 页）中，您可以定义一个函数，当函数生成其异常规范未定义的异常时调用该函数。

```
void convertUnexpected()
{
    // You could redefine the exception here into a known exception
    // throw UnexpectedException();

    // ... or I suppose you could log an error and exit.
} 
```

在您的应用程序中注册功能：

```
std::set_unexpected( convertUnexpected ); 
```

如果函数生成未由其异常规范定义的异常，您的函数 convertUnexpected() 将被调用......这意味着这仅在您使用异常规范时才有效。;(

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-09T17:11:14.337

这就是我在 main() 中经常做的事情

```
int main()
{
    try
    {
        // Do Work
    }
    catch(std::exception const& e)
    {
         Log(e.what());
         // If you are feeling mad (not in main) you could rethrow! 
    }
    catch(...)
    {
         Log("UNKNOWN EXCEPTION");
         // If you are feeling mad (not in main) you could rethrow! 
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-06-21T14:33:59.687

如果 C++11 可用，则可以使用此方法（参见示例：[http](http://en.cppreference.com/w/cpp/error/rethrow_exception) ://en.cppreference.com/w/cpp/error/rethrow_exception ）：

```
#include <iostream>
#include <exception>

void onterminate() {
  try {
    auto unknown = std::current_exception();
    if (unknown) {
      std::rethrow_exception(unknown);
    } else {
      std::cerr << "normal termination" << std::endl;
    }
  } catch (const std::exception& e) { // for proper `std::` exceptions
    std::cerr << "unexpected exception: " << e.what() << std::endl;
  } catch (...) { // last resort for things like `throw 1;`
    std::cerr << "unknown exception" << std::endl;
  }
}

int main () {
  std::set_terminate(onterminate); // set custom terminate handler
  // code which may throw...
  return 0;
} 
```

这种方法还允许您为未处理的异常自定义控制台输出：拥有类似这样的东西

```
unexpected exception: wrong input parameters
Aborted 
```

而不是这个：

```
terminate called after throwing an instance of 'std::logic_error'
  what():  wrong input parameters
Aborted 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T22:35:13.060

在所有异常屏障（不仅仅是主线程）中使用 catch (...)。我建议您始终重新抛出 (...) 并将标准输出/错误重定向到日志文件，因为您无法在 (...) 上执行有意义的 RTTI。OTOH，像 GCC 这样的编译器将输出关于未处理异常的相当详细的描述：类型、what() 的值等。

# asp.net-mvc - 如何使用类似 http://localhost/admin#sayhi 的 URL 在 MVC 中返回视图

> ID：276112
> 
> 赞同：1
> 
> 时间：2008-11-09T16:54:42.390
> 
> 标签：asp.net-mvc, model-view-controller

好的，这是确切的场景：

我有一个名为 Index 的视图我有一个名为 SayHi 的局部视图（用户控件）我有一个 AdminController，它有一个名为 SayHi 的 Action，它不执行任何其他操作

```
ViewData["Message"]  = "Hi There!"; 
```

我正在使用 ajax 从 Index.aspx 加载部分视图，所以当我有 followinf url > [http://localhost/Index#Sayhi](http://localhost/Index#Sayhi) sayhi 部分视图时被调用。

所以我现在需要的是如何在控制器中返回这个地址我不能使用 View("Index#Sayhi") 而且如果我使用 RedirectUrl("index#sayhi") 我会丢失 ViewData。

请任何帮助表示赞赏提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T07:48:18.343

'#' 字符用于页面内部书签链接，不应用于服务器端逻辑。所以用你的#sayhi url链接到一个页面，浏览器将转到该页面并向下滚动到这样的标签：

```
<a name="sayhi"></a>
```

如果你想传入`sayhi`你应该使用的动作？而是从请求中获取它。

# algorithm - 冒泡排序有什么用？

> ID：276113
> 
> 赞同：51
> 
> 时间：2008-11-09T16:55:00.063
> 
> 标签：algorithm, language-agnostic, sorting, bubble-sort

冒泡排序在现实世界中有任何用途吗？每次我看到有人提到，它总是要么：

1.  一种可以学习的排序算法。
2.  *不*使用的排序算法示例。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2010-07-18T03:28:51.013

冒泡排序（可证明）是在*非常*特定的情况下可用的最快排序。它最初之所以广为人知，主要是因为它是最早经过严格分析的算法之一（任何类型的），并且证明它在其有限的情况下是最优的。

考虑一个存储在磁带驱动器上的文件，以及如此小的随机存取内存（或如此大的密钥），以至于您在任何给定时间只能将*两条记录加载到内存中。*倒带速度很慢，以至于在文件中进行随机访问通常是不切实际的——如果可能的话，您希望按顺序处理记录，一次不超过两个。

回到磁带驱动器很常见的时候，只有几千个（字|字节）RAM（任何类型）的机器很常见，这足够现实值得研究。这种情况现在很少见，所以研究冒泡排序毫无意义——但更糟糕的是，无论如何都没有教授最佳的情况，所以即使/如果出现正确的情况，几乎没有人会*意识到*这一点。

至于在极小和/或几乎排序的数据集上是最快的，虽然这可以掩盖冒泡排序的弱点（至少在某种程度上），但插入排序本质上总是对两者中的任何一个/两者都更好那些。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-09T16:59:28.247

这取决于您的数据分布方式 - 如果您可以做出一些假设。

我发现了解何时使用冒泡排序或其他排序的最佳链接之一是关于排序算法的动画视图：

[http://www.sorting-algorithms.com/](http://www.sorting-algorithms.com/)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-09T16:57:22.617

它在现实世界中并没有得到太多使用。它是一个很好的学习工具，因为它易于理解并且可以快速*实施*。它具有糟糕的 (O(n^2)) 最坏情况和平均性能。当您知道数据几乎已排序时，它具有良好的最佳情况性能，但是还有许多其他算法具有此属性，具有更好的最坏情况和平均情况性能。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-09T17:16:57.057

我最近在一个优化轶事中发现了它的一个很好的用途。一个程序需要一组按每帧深度排序的精灵。仇恨顺序在帧之间不会有太大变化，因此作为一种优化，它们在每帧一次通过的情况下进行了冒泡排序。这是在两个方向（从上到下和从下到上）完成的。因此，精灵几乎总是使用非常有效的 O(N) 算法进行排序。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-09T16:56:57.893

**对于小型**套装来说，这可能是最快的。

说到教育。[整理整理](http://www.youtube.com/watch?v=AUn7-36oluU&feature=related)最后一幕的链接，太神奇了。必看。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-09T17:35:33.213

这对小型数据集很有用——这就是为什么当分区大小变小时一些 qsort 实现会切换到它的原因。但是插入排序仍然更快，所以除了作为教学辅助之外，没有什么好的理由使用它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-29T21:51:52.013

我们最近在算法的最优性证明中使用了冒泡排序。我们必须将由一系列对象表示的任意最优解转换为我们的算法找到的解。因为我们的算法只是“按此标准排序”，所以我们必须证明我们可以对最优解进行排序而不会使其变得更糟。在这种情况下，冒泡排序是一种非常好的算法，因为它具有很好的不变量，即只交换两个相邻且顺序错误的元素。我认为，使用更复杂的算法会使大脑融化。

问候。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-09T16:57:49.280

我认为这是一个很好的“教学”算法，因为它很容易理解和实现。出于同样的原因，它也可能对小型数据集有用（尽管一些 O(n lg n) 算法也很容易实现）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-10T15:59:09.333

我无法抗拒对冒泡排序的任何评论，提到更快的（似乎是 O(nlogn)，但这并没有真正得到证明）[Comb Sort](http://en.wikipedia.org/wiki/Comb_sort)。请注意，如果您使用预先计算的表，梳排序会更快一些。梳排序与冒泡排序完全相同，只是它最初不是通过交换相邻元素开始的。它几乎与冒泡排序一样容易实现/理解。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-29T22:06:30.640

[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)很容易实现，当你有小数据集时它足够快。

当您的集合几乎已排序（例如，一个或多个元素不在正确的位置）时，冒泡排序足够快，在这种情况下，您最好交错从 0-index 到 n-index 以及从 n-index 到 0-index . 使用 C++ 可以通过以下方式实现：

```
void bubbleSort(vector<int>& v) { // sort in ascending order
  bool go = true;
  while (go) {
    go = false;
    for (int i = 0; i+1 < v.size(); ++i)
      if (v[i] > v[i+1]) {
         swap(v[i], v[j]);
         go = true;
      }
    for (int i = (int)v.size()-1; i > 0; --i) 
      if (v[i-1] > v[i]) {
         swap(v[i-1], v[i]);
         go = true;
      }
  }
} 
```

如果两个相邻项目的交换是筹码并且任意项目的交换很昂贵，那可能会很好。

[Donald Knuth 在他著名的“计算机编程艺术”中总结道，“冒泡排序似乎没有什么可推荐的，除了一个吸引人的名字和它导致一些有趣的理论问题的事实”](http://en.wikipedia.org/wiki/Bubble_sort#In_practice)。

由于该算法易于实现，因此易于支持，并且在实际应用程序生命周期中减少支持工作量很重要。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-09T17:19:44.070

实际上，这是我最常使用的那种。（在我们的项目中，我们不能使用任何外部库。）

当我确定数据集非常小时，它很有用，所以我一点也不关心速度，想要最短和最简单的代码。

泡沫不是你能达到的最低值。最近，我遇到了需要对三个元素进行准确排序的情况。我写了这样的东西：

```
// Use sort of stooge to sort the three elements by cpFirst

SwapElementsIfNeeded(&elementTop, &elementBottom);
SwapElementsIfNeeded(&elementTop, &elementMiddle);
SwapElementsIfNeeded(&elementMiddle, &elementBottom);

*pelement1 = elementTop;
*pelement2 = elementMiddle;
*pelement3 = elementBottom; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-09T22:19:57.880

在某些情况下，我曾经在 TRS-80 Model 1 上将它用于小 N。使用 for 循环，可以在一个程序行上实现完整的排序。

除此之外，它对教学很有用，有时也适用于几乎按排序顺序排列的列表。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-09T22:43:06.353

我曾经将它用于绝大多数情况下它将对两个项目进行排序的情况。

下次我看到该代码时，有人将其替换为库排序。我希望他们首先对其进行基准测试！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-10T15:47:00.903

编码既快速又容易（几乎不可能出错）。如果你不做繁重的工作并且没有图书馆分类支持，它就有它的位置。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-29T21:06:55.613

哦，是的，这是一个很好的选择机制。如果您在某人编写的代码中找到它，您就不会雇用他。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-29T22:33:21.930

大多*没有*。请改用 QuickSort 或 SelectionSort...！

# sql - auto_increment 导致 CREATE TABLE 出错

> ID：276121
> 
> 赞同：1
> 
> 时间：2008-11-09T16:58:45.923
> 
> 标签：sql, mysql, syntax

我一直在使用 netbeans 作为我的 java 工具，但我遇到了问题。我阅读[了本教程](http://www.netbeans.org/kb/61/java/gui-db-custom.html)，然后尝试使用以下 SQL 创建表：

```
CREATE TABLE CUSTOMERS (
    ID INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
    FIRST_NAME VARCHAR(20),
    LAST_NAME VARCHAR(30),
    ADDRESS VARCHAR(30),
    CITY VARCHAR(30),
    STATE_ VARCHAR(30),
    ZIP VARCHAR(15),
    COUNTRY_ID INTEGER,
    PHONE VARCHAR(15),
    EMAIL_ADDRESS VARCHAR(50)
)ENGINE=INNODB; 
```

当我尝试运行它时，我收到以下错误消息：

> sql state 42X01：语法错误：在第 2 行第 29 列遇到“AUTO_INCREMENT”

当我删除 AUTO_INCREMENT 时，另一个错误：

> 检测到引擎=INNODB；

有人能帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T17:06:50.307

您似乎正在将 MySQL 语法与另一个数据库引擎一起使用。它抱怨的部分正是 MySQL 特定的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T17:04:54.617

我的建议如下

```
CREATE TABLE CUSTOMERS 
( ID INTEGER NOT NULL auto_increment,
FIRST_NAME VARCHAR(20), 
LAST_NAME VARCHAR(30), 
ADDRESS VARCHAR(30), 
CITY VARCHAR(30), 
STATE_ VARCHAR(30), 
ZIP VARCHAR(15), 
COUNTRY_ID INTEGER, 
PHONE VARCHAR(15), 
EMAIL_ADDRESS VARCHAR(50),
PRIMARY KEY (ID)); 
```

不知道 engine=innodb 是干什么用的，你试过没有它吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T17:26:40.780

“engine=innodb”部分指定在数据库中使用的数据库引擎。使用 MySQL，您可以指定不同的引擎，如“InnoDB”、“MyISAM”等。它们具有不同的属性和特性——有些允许外部索引，有些则不允许。有些具有不同的锁定机制，有些具有不同的原子性/回滚属性。我不知道细节，但如果您需要一个真正高性能的数据库设置，您应该调查哪种引擎最适合您正在创建的每种类型的表。此外，我所有的数据库经验都是使用 MySQL 的，我不确定您是否正在使用它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-15T20:01:56.687

已经很长时间了，但是如果其他人像我一样偶然发现了这个问题，那么对我有用的解决方案不是使用`auto_increment`，而是将 ID 列描述为

`ID INTEGER GENERATED ALWAYS AS IDENTITY, WHATEVER VARCHAR(20), ETC ETC...`

# windows - 我在哪里报告 Windows 核心库问题？

> ID：276125
> 
> 赞同：6
> 
> 时间：2008-11-09T16:59:59.617
> 
> 标签：windows, msdn, bug-reporting, core-api

我如何让 Microsoft 知道我在其核心库例程之一中发现的问题？他们是否有一个中央存储库来报告这些事情？

我不是 Microsoft 开发网络 (MSDN) 的成员。

或者我什至应该打扰？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T17:05:32.460

没有官方方法可以为最终用户向 Microsoft 报告错误。如果您正在参与即将发布的测试版计划，那么测试版计划包括一个错误报告渠道。否则，如果错误导致您想要解决的问题，您可以致电 Microsoft 支持，他们将帮助您解决问题（通过提供补丁或解决方法）；如果问题确实是由错误引起的，他们将退还支持电话的费用。

Microsoft 确实有一个中央存储库（可能每个产品都有单独的存储库），但该存储库不可供公众访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T17:24:08.930

如果它是一个文档错误（或者如果文档应该指出它），您可以使用 MSDN 库中的反馈链接获得良好的结果。您可以通过在 connect.microsoft.com 上注册来报告 Microsoft 开发人员工具中的错误（除其他外）。

如果您确定在核心库例程中发现了错误，您可以提出 PSS（支持案例。这将花费您的钱，但如果事实证明您是对的（他们会向您发布修补程序） ，我认为他们退还了钱。

我从未如此自信地发现了一个我愿意冒险的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T21:23:28.133

我不知道为什么[ChrisN](https://stackoverflow.com/users/3853/chrisn)收回了他的回答。我今天早些时候看到它，当他把它拿出来时，他说：

> [您可以在Microsoft Connect 网站](http://connect.microsoft.com)上报告错误（我过去曾这样做过）。您不必订阅 MSDN。

我没有听说过 Microsoft Connect 网站，但是当我使用那里的搜索框搜索“Registry Unicode”时，列出的第一个条目是一个与我遇到的非常相似的错误。[通过点击该条目，](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=343523&wa=wsignin1.0)我看到了似乎是微软人员解决问题的对话，将其传递给适当的人，并在必要时将其升级。

我没有使用 Microsoft Connect 网站的经验，但如果事实证明它像看起来那样有希望，这可能就是我的问题的答案。

# c# - 使用子相关内容对列表进行数据绑定的最佳方法（例如，带有标签的 SO 问题）

> ID：276126
> 
> 赞同：1
> 
> 时间：2008-11-09T17:00:30.397
> 
> 标签：c#, asp.net, sql, data-binding

使用 ASP.net 2.0，我如何向用户呈现类似于 SO 上的问题列表的信息，其中每个问题都有一些子项（如标签）。

我可能会进行两个单独的查询，一个首先查找问题列表，然后另一个查询查找属于问题列表的所有标签。

*方法一：*

然后我可能会使用嵌套中继器并在每个嵌套中继器“OnItemDataBind”的代码隐藏中执行选择语句......

*方法二：*

或者使用这两个数据集，我将使用 C# 代码为每个“问题”创建一个业务实体，并拥有一个名为“标签”的属性。然后我会遍历我的标签数据集并分配属性。

什么更有效率？还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T18:17:15.560

我肯定会避免使用第二种方法——您不想在每次数据绑定父项时都访问数据库。正如 DOK 所说，尝试正确地构建您的系统。对我来说，这意味着填充业务对象的集合并绑定到它。我用自定义菜单控件做了类似的事情（注意这嵌套了三个数据列表，但你可以使用中继器）：

在 aspx 页面中：

```
<asp:DataList ID="dlMenuOne" runat="server" onitemdatabound="dlMenu_ItemDataBound" >
            <ItemTemplate>
             //your object

                <asp:DataList ID="dlMenuTwo"  runat="server" onitemdatabound="dlMenuTwo_ItemDataBound">
                <ItemTemplate>
                //your object's child items

                    <asp:DataList ID="dlMenuThree" runat="server">
                    <ItemTemplate>
                       //child item's child items    
                    </ItemTemplate>
                    </asp:DataList>

                </ItemTemplate>
                </asp:DataList> 

            </ItemTemplate>
            </asp:DataList> 
```

然后在后面的代码中：

```
protected void dlMenu_ItemDataBound(object sender, DataListItemEventArgs e)
{
    DataListItem parentList = e.Item;
    DataList dlMenuTwo = (DataList)parentList.FindControl("dlMenuTwo");
    MenuItem item = (MenuItem)parentList.DataItem;
    dlMenuTwo.DataSource = _menu.GetChildItems(item);
    dlMenuTwo.DataBind();
} 
```

此方法基本上获取对正在绑定的对象（parentList.DataItem）的引用，然后将嵌套的 DataList 绑定到子项（_menu.GetChildItems(item)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T17:20:52.837

如果您执行两个单独的查询，您仍然可以在一次调用数据库中进行查询，并返回两个结果集。

您可以使用更高效的 DataReader（带有两个结果集）来代替 DataSet。循环遍历结果集并使用关联的 Tag 对象或属性填充 Question 对象。将这些对象放在 ArrayList 或通用列表中，您可以将其绑定到您的中继器。

如果您不需要业务逻辑层（另一个类），那么您应该考虑将该代码至少移动到一个数据访问层（类），而不是在代码隐藏中做任何事情。

所有这些建议仅适用于您的应用程序不平凡的情况。使用 OO 方法确实会增加代码，但如果您要做的不仅仅是显示信息，最好从一个好的 OO 架构开始（DAL 和 BLL，如果不是 MVC）。

# security - 保护面向 Internet 的 IIS 主机的建议？

> ID：276132
> 
> 赞同：0
> 
> 时间：2008-11-09T17:06:46.703
> 
> 标签：security, iis

我正在 Windows 2008 上设置一个面向 Internet 的 ASP.NET MVC 应用程序。它使用 SQL Server 2008 作为其数据库。我正在寻找保护它的最佳实践。

我找到[了这篇文章](http://www.enterprisenetworkingplanet.com/netsecur/article.php/3552711)，但现在有点过时了。这些建议有多少仍然有价值？

一些背景——这是一个个人站点，在我家的 NAT/防火墙箱后面；我只会将端口 80 和 443 转发给它。IIS 服务器本身是一台运行在 HyperV 上的 Windows 2008 主机（我只有一个物理机可用）。

在那篇文章中提到的一件有用的事情（我已经想到了）是 IIS 框不应该是域的成员，因此入侵者不能轻易摆脱框。稍后我将把它从域中删除 :)

我（以及部署到更大环境的任何人）还应该记住哪些其他提示？

我知道这不是严格意义上的与编程相关的问题（其中没有源代码！），但我猜大多数程序员在部署建议时必须涉足操作方面的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T22:11:01.097

我不知道将它从域中删除，但我肯定会[禁用 LanMan hashes](http://support.microsoft.com/default.aspx?scid=KB;EN-US;q299656&)，保持系统完全修补，并使用良好的密码安全性。确保在 IIS 中运行的任何进程都从最低特权帐户运行，即，不要在本地管理员中的 ID 下运行工作进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T23:15:02.467

您可以看看这两个工具： [ASP.NET 的最佳实践分析器](http://msdn.microsoft.com/en-us/vs2005/aa718345.aspx)

[SQL Server 2005 最佳实践分析器（即使您使用的是 2008，仍然可能会有所帮助）](http://www.microsoft.com/downloads/details.aspx?FamilyId=DA0531E4-E94C-4991-82FA-F0E3FBD05E63&displaylang=en)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T17:26:41.263

这肯定会有很大帮助：
[Microsoft Web Application Configuration Analyzer v2.0](http://www.microsoft.com/en-us/download/details.aspx?id=573)

# apache - 如何在 Apache 上为虚拟主机设置不同的 SSL 证书？

> ID：276134
> 
> 赞同：8
> 
> 时间：2008-11-09T17:06:56.313
> 
> 标签：apache, ssl, virtual-hosts

我有一个网络服务器，它提供不同的域名，但只分配了一个 IP 地址。这适用于 Apache 中的虚拟主机。现在我想要网站的 SSL 加密连接。如何为不同的虚拟主机设置不同的 SSL 证书？

为不同的主机名使用不同的 IP 将是一种解决方案 - 不是很优雅但可能。但我想知道，如何为不同的虚拟主机使用不同的 SSL 证书。所以我寻找一种只有一个 IP 地址的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T17:16:59.317

**更新：2013**

随着旧版浏览器的淘汰，SNI 似乎终于开始占据上风。这里是[Apache SNI 的文档](http://wiki.apache.org/httpd/NameBasedSSLVHostsWithSNI) ，这里是[一篇关于 SNI 的维基百科文章](http://en.wikipedia.org/wiki/Server_Name_Indication)，其中包括支持它的浏览器的图表。简而言之，所有主流浏览器都在支持的版本中支持它；如果支持旧版浏览器很重要，您可能必须考虑到这一点。

*------ 上一个答案 ------------*

SSL 主机必须绑定到唯一的 IP 地址/端口组合，因此您不能使用虚拟主机（或者至少，每个 IP 地址只能有一个 ssl 主机）。这是因为 https 在 Host: 参数在 http 中发送之前开始加密，因此它无法从主机名确定使用哪个密码 - 它只有 IP 地址。

如果 HTTP 有一个 TLS 命令，这将很容易解决，因此它可以在询问主机名后启动 SSL，但没有人问我。

有关明确的答案，请参阅[http://httpd.apache.org/docs/2.0/ssl/ssl_faq.html#vhosts2](http://httpd.apache.org/docs/2.0/ssl/ssl_faq.html#vhosts2)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T18:01:46.123

在给出答案的提示和对它的评论（尤其是 Martin v. Löwis）之后，我做了一些谷歌搜索，发现[了这个关于 RFC 2817 和 RFC 3546 的网站](http://hightechsorcery.com/2007/12/status-rfc-2817-and-rfc-3546-implementations)。RFC 3546 似乎是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T17:25:13.483

AFAIK 无法使用 mod_ssl 为基于名称的虚拟主机设置不同的 SSL 证书。[你可以在这里](http://httpd.apache.org/docs/2.2/ssl/ssl_faq.html#vhosts)阅读详细的原因。另一种方法是使用基于 IP 的虚拟主机（这可能是不可能的/不是一个非常令人满意的解决方案） - 只需插入不同的 SSLCertificateFile 指令，或者您可以使用 mod_gnutls 尝试[此](http://www.g-loaded.eu/2007/08/10/ssl-enabled-name-based-apache-virtual-hosts-with-mod_gnutls/)方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T00:31:39.533

每个虚拟主机都需要一个单独的 IP：端口组合。

RFC 3546 尚不可行。IE 只在 Vista 下运行时才支持，上次我查了一下 Safari 也不管理它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T14:04:12.937

虽然 DGM 提到的所有内容都是正确的，但已经有人尝试绕过对每个证书（包括 mod_gnutls 和使用[TLS 扩展](http://www.howtoforge.com/enable-multiple-https-sites-on-one-ip-using-tls-extensions-on-debian-etch)）的唯一 IP 地址的要求。有一些缺点，但它们可能对你来说是可以接受的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-13T14:25:07.617

终于有可能了！您需要服务器和客户端都支持服务器名称指示 (SNI)

支持 SNI 的浏览器：

*   Mozilla Firefox 2.0 或更高版本
*   Opera 8.0 或更高版本（启用 TLS 1.1）
*   Internet Explorer 7.0 或更高版本（在 Vista 上，不是 XP）
*   谷歌浏览器
*   Mac OS X 10.5.6 上的 Safari 3.2.1

该文档显示了配置服务器的方法：[SSL with Virtual Hosts Using SNI](http://wiki.apache.org/httpd/NameBasedSSLVHostsWithSNI)

# vb.net - 使用 VS 2008 (vb.net) 我需要创建一个可以在经典 ASP 中使用 CreateObject 的对象

> ID：276152
> 
> 赞同：1
> 
> 时间：2008-11-09T17:16:59.333
> 
> 标签：vb.net, visual-studio-2008, com, interop, createobject

我对 VB.net 很陌生。我以前在 VB6 中编写过这些对象。我只是迷失在 VB.net 中，但是（踢和尖叫）我必须学习如何做到这一点。我已经用谷歌搜索了几个小时，只向前迈出了一小步。任何人都可以发布一个链接来解释从头到尾如何做到这一点？

我已经设法编写了类对象，但我不知道如何注册它以及 CreateObject("Name1.Name2") 中的 name1 和 name2 来自哪里。

Regsrv32 将不起作用。它说“找不到入口点”并且不会注册它。另外，我不能把它放到 Assemblies 目录中。我读了一些关于使用 regasm 命令的内容，但我似乎也无法完成这项工作。

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T13:25:24.917

我将假设您不是要编写 COM DLL，而是要编写一个完整的项目，该项目调用各种子程序集，例如 VB6 EXE 调用 ActiveX DLL。如果您可以更具体地说明您要做什么，那将对我有更好的帮助。

关于 VB.NET 与 VB6 的几点。

1) 对于仅 .NET 的项目，没有注册。如果 EXE 或 DLL 引用另一个 .NET DLL，则唯一的要求是 DLL 必须存在于父目录中。

2) 您只能通过在 GAC 中注册 .NET 程序集来为 .NET 应用程序进行 COM 样式注册。但是，这样做有几个要求。在 .NET GAC 上进行搜索，它将为您提供有关如何执行此操作的独家新闻。

3) 您可以设置 .NET 程序集以使用 COM，在这种情况下，它将按照 COM 规则运行，包括向 regsvr 注册。

您会发现#2 或#3 仅在极少数情况下出现的.NET 项目。#1 将适用于 90% 的 DLL 程序集。这取决于你的项目。

CreateObject 的一个常见用途是允许插件或可安装库。.NET 通过反射 API 处理这个问题。使用反射 API，您可以查看目录、浏览每个 .NET DLL 并查看它们的内容并根据您找到的内容创建对象。搜索 .NET Reflection 以了解此内容。

如果您的项目只是 .NET，那么我建议您创建一个由主程序集和定义您正在创建的对象的接口的单个​​子程序集引用的程序集。当您使用反射 API 并确定对象类型时，您可以将其分配给该接口的变量，并使用智能感知和其他辅助工具对其进行正常编码。

如果您有旧的 COM ActiveX 控件或 DLL，.NET 将生成一个将 ActiveX 对象公开给 .NET 的包装类。我会花一些时间学习 .NET 如何做到这一点。我所做的是创建一个虚拟项目并让 .NET 引用我需要的 ActiveX 内容。然后我找到它制作的包装器项目和 DLL，并将它们移动到中心区域。这就是为什么当我使用相同的 ActiveX 东西处理后续项目时，我知道所有包装器在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T17:23:36.963

您必须转到您的类库属性并选择“注册 COM 互操作”选项。这将使您的程序集可用于 COM。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-09T18:49:50.987

您想为您的 .NET 组件创建所谓的[COM 可调用包装器](http://www.codeproject.com/KB/COM/nettocom.aspx)（又名 CCW）。这基本上需要使用一些 GUID 设置一些 COM 接口，并在项目属性中启用“注册 COM 互操作”（如前所述）或使用 regasm.exe。

# c# - 嵌套的 linq 查询，如何获得不同的值？

> ID：276166
> 
> 赞同：5
> 
> 时间：2008-11-09T17:26:38.020
> 
> 标签：c#, linq, linq-to-sql

2列“类别”和“子类别”的表格数据

我想使用下面的代码获取“类别”、[子类别]的集合，我得到了重复项。将 .Distinct() 放在外部“来自”之后并没有多大帮助。我想念什么？

```
 var rootcategories = (from p in sr.products
                                 orderby p.category
                                  select new
                                  {
                                      category = p.category,
                                      subcategories = (
                                      from p2 in sr.products
                                      where p2.category == p.category
                                      select  p2.subcategory).Distinct()
                                  }).Distinct(); 
```

sr.products 看起来像这样

```
category   subcategory
----------------------
cat1       subcat1
cat1       subcat2
cat2       subcat3
cat2       subcat3 
```

我得到的结果是

```
cat1, [subcat1,subcat2]
cat1, [subcat1,subcat2] 
```

但我只想要一个条目

用这段代码解决了我的问题：

```
 var rootcategories2 = (from p in sr.products
                               group p.subcategory by p.category into subcats

                               select subcats); 
```

现在也许是时候想想什么是正确的问题了.. (-:

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T17:54:55.920

用这段代码解决

```
 var rootcategories2 = (from p in sr.products
                               group p.subcategory by p.category into subcats

                               select subcats); 
```

谢谢大家

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T17:33:49.300

我认为您需要 2 个“Distinct()”调用，一个用于主要类别，另一个用于子类别。

这应该适合你：

```
var mainCategories = (from p in products select p.category).Distinct();

var rootCategories =
    from c in mainCategories
    select new {
        category = c,
        subcategories = (from p in products
                         where p.category == c
                         select p.subcategory).Distinct()
    }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T17:53:07.123

Distinct() 背后的算法需要一种方法来判断源 IEnumerable 中的 2 个对象是否相等。默认方法是通过引用比较 2 个对象，因此很可能没有 2 个对象是“相等的”，因为您使用“new”关键字创建它们。

您需要做的是编写一个实现 IEnumerable 的自定义类并将其传递给 Distinct() 调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T17:48:56.040

您的主要查询是关于产品的，因此您将获取每个产品的记录。切换它，以便您查询类别，但过滤 Product.Category

# c++ - 你最喜欢的 C++ 编码风格习语是什么

> ID：276173
> 
> 赞同：71
> 
> 时间：2008-11-09T17:35:08.860
> 
> 标签：c++, coding-style

你最喜欢的 C++ 编码风格习语是什么？我在询问样式或编码排版，例如在哪里放置花括号，关键字后是否有空格，缩进的大小等。这与最佳实践或要求相反，例如始终删除带有`delete[]`.

这是我最喜欢的示例之一：在 C++ 类初始化程序中，我们将分隔符放在行的前面，而不是后面。这使得更容易保持最新状态。这也意味着版本之间的源代码控制差异更清晰。

```
TextFileProcessor::
TextFileProcessor( class ConstStringFinder& theConstStringFinder ) 

    : TextFileProcessor_Base( theConstStringFinder )

    , m_ThreadHandle  ( NULL )
    , m_startNLSearch (    0 )
    , m_endNLSearch   (    0 )
    , m_LineEndGetIdx (    0 )
    , m_LineEndPutIdx (    0 )
    , m_LineEnds      ( new const void*[ sc_LineEndSize ] )
{
    ;
} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-01-09T18:01:14.613

## RAII：资源获取是初始化

RAII 可能是最重要的成语。它的想法是资源应该映射到对象，以便根据声明这些对象的范围自动管理它们的生命周期。

例如，如果在堆栈上声明了一个文件句柄，那么一旦我们从函数（或循环，或它在内部声明的任何范围）返回，它就应该被隐式关闭。如果动态内存分配是作为类的成员分配的，则在销毁该类实例时应该隐式释放它。等等。每一种资源——内存分配、文件句柄、数据库连接、套接字和任何其他必须获取和释放的资源——都应该包装在这样一个 RAII 类中，其生命周期由它所在的范围决定宣布。

这样做的一个主要优点是 C++ 保证在对象超出范围时调用析构函数，*而不管控制如何离开该范围*。即使抛出异常，所有本地对象也会超出范围，因此它们的关联资源将被清理。

```
void foo() {
  std::fstream file("bar.txt"); // open a file "bar.txt"
  if (rand() % 2) {
    // if this exception is thrown, we leave the function, and so
    // file's destructor is called, which closes the file handle.
    throw std::exception();
  }
  // if the exception is not called, we leave the function normally, and so
  // again, file's destructor is called, which closes the file handle.
} 
```

无论我们如何离开该函数，以及打开文件后会发生什么，我们都不需要显式关闭文件，或在该函数中处理异常（例如 try-finally）。相反，该文件会被清理，因为它与一个本地对象相关联，当它超出范围时会被销毁。

RAII 也不太常见，称为 SBRM（范围绑定资源管理）。

也可以看看：

*   [ScopeGuard](http://www.ddj.com/cpp/184403758)允许代码“在抛出异常的情况下自动调用‘撤消’操作……”。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-11-09T22:20:46.537

创建枚举时，将它们放在命名空间中，以便您可以使用有意义的名称访问它们：

```
namespace EntityType {
    enum Enum {
        Ground = 0,
        Human,
        Aerial,
        Total
    };
}

void foo(EntityType::Enum entityType)
{
    if (entityType == EntityType::Ground) {
        /*code*/
    }
} 
```

**编辑**：但是，这种技术在 C++11 中已经过时了。*应使用作用域枚举*（用`enum class`or声明`enum struct`）：它更安全、更简洁、更灵活。对于旧式枚举，值被放置在外部范围内。对于新式枚举，它们被放置在`enum class`名称的范围内。
使用范围枚举（也称为*强类型枚举*）重写的上一个示例：

```
enum class EntityType {
    Ground = 0,
    Human,
    Aerial,
    Total
};

void foo(EntityType entityType)
{
    if (entityType == EntityType::Ground) {
        /*code*/
    }
} 
```

使用范围枚举还有其他显着的好处：没有隐式转换、可能的前向声明以及使用自定义基础类型（不是默认值`int`）的能力。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2010-01-09T18:36:27.687

## 复制交换

复制交换习语提供异常安全的复制。它要求实施正确的复制 ctor 和交换。

```
struct String {
  String(String const& other);

  String& operator=(String copy) { // passed by value
    copy.swap(*this); // nothrow swap
    return *this; // old resources now in copy, released in its dtor
  }

  void swap(String& other) throw() {
    using std::swap; // enable ADL, defaulting to std::swap
    swap(data_members, other.data_members);
  }

private:
  Various data_members;
};
void swap(String& a, String& b) { // provide non-member for ADL
  a.swap(b);
} 
```

您也可以[直接](https://stackoverflow.com/questions/1996548/segmentation-fault-in-overloading-operator/1996586#1996586)使用 ADL（Argument Dependent Lookup）实现 swap 方法。

这个习惯用法很重要，因为它处理自赋值^([1])，提供强大的异常保证^([2])，并且通常很容易编写。

* * *

^([1])尽管自分配没有尽可能有效地处理，但它应该*很少见*，所以如果它永远不会发生，这实际上更快。

^([2])如果抛出任何异常，对象 ( `*this`) 的状态不会被修改。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2010-01-09T18:34:07.150

## CRTP：奇怪重复的模板模式

当您将一个类作为模板参数传递给它的基类时，就会发生[CRTP ：](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)

```
template<class Derived>
struct BaseCRTP {};

struct Example : BaseCRTP<Example> {}; 
```

在基类中，它可以简单地通过强制转换（*static_cast*或*dynamic_cast*工作）获得派生实例*和派生类型：*

 **```
template<class Derived>
struct BaseCRTP {
  void call_foo() {
    Derived& self = *static_cast<Derived*>(this);
    self.foo();
  }
};

struct Example : BaseCRTP<Example> {
  void foo() { cout << "foo()\n"; }
}; 
```

实际上，*call_foo*已被*注入*到派生类中，可以完全访问派生类的成员。

随意编辑和添加特定的使用示例，可​​能会添加到[其他 SO 帖子](https://stackoverflow.com/questions/2032881/creating-a-new-object-from-dynamic-type-info/2033034#2033034)中。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2010-01-09T18:13:12.577

## pImpl：指向实现的指针

pImpl 习惯用法是将类的接口与其实现分离的一种非常有用的方法。

通常，类定义必须包含成员变量和方法，这可能会暴露太多信息。例如，成员变量可能是我们不希望在任何地方都包含的头文件中定义的类型。

`windows.h`标题是这里的一个主要示例。我们可能希望`HANDLE`在一个类中包装一个或另一个 Win32 类型，但我们不能`HANDLE`在类定义中放置一个，而不必在使用`windows.h`该类的任何地方都包括在内。

然后解决方案是创建一个私有*IMPL**实体*或类的指向*IMPL的**指针*，并让公共实现只存储一个指向私有的指针，并转发所有成员方法。

例如：

```
class private_foo; // a forward declaration a pointer may be used

// foo.h
class foo {
public:
  foo();
  ~foo();
  void bar();
private:
  private_foo* pImpl;
};

// foo.cpp
#include whichever header defines the types T and U

// define the private implementation class
class private_foo {
public:
  void bar() { /*...*/ }

private:
  T member1;
  U member2;
};

// fill in the public interface function definitions:
foo::foo() : pImpl(new private_foo()) {}
foo::~foo() { delete pImpl; }
void foo::bar() { pImpl->bar(); } 
```

的实现`foo`现在与其公共接口分离，因此

*   它可以使用来自其他头文件的成员和类型，而不需要在使用类时存在这些依赖项，并且
*   可以在不强制重新编译使用该类的代码的情况下修改实现。

类的用户只包含标题，它不包含任何关于类实现的具体内容。所有实现细节都包含在`foo.cpp`.

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-11-09T22:09:02.473

我喜欢在“列”中排列代码/初始化...在使用支持“列”模式的编辑器进行编辑时证明非常有用，而且对我来说似乎更容易阅读...

```
int myVar        = 1;    // comment 1
int myLongerVar  = 200;  // comment 2

MyStruct arrayOfMyStruct[] = 
{   
    // Name,                 timeout,   valid
    {"A string",             1000,      true    },   // Comment 1
    {"Another string",       2000,      false   },   // Comment 2 
    {"Yet another string",   11111000,  false   },   // Comment 3
    {NULL,                   5,         true    },   // Comment 4
}; 
```

相反，会出现与上面没有缩进和格式化的相同代码......（在我看来有点难以阅读）

```
int myVar = 1; // comment 1
int myLongerVar = 200; // comment 2

MyStruct arrayOfMyStruct[] = 
{   
    // Name, timeout, valid
    {"A string", 1000, true},// Comment 1
    {"Another string", 2000, false }, // Comment 2 
    {"Yet another string", 11111000,false}, // Comment 3
    {NULL, 5, true }, // Comment 4
}; 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2011-06-21T11:58:25.967

公共上衣 - 私下

一个看似很小的优化，但自从我切换到这个约定后，我有一个更有趣的时间来掌握我的课程，尤其是在我 42 年没有看过它们之后。

拥有一致的成员可见性，从经常感兴趣的点到无聊的东西，非常有帮助，尤其是当代码应该是自我记录的时候。

（qt 用户的旁注：槽位于信号之前，因为它们应该像非槽成员函数一样可调用，并且除了它们的槽性之外，它们与非槽无法区分）

*   公共、受保护、私有
*   然后工厂，ctor，dtor，复制，交换
*   然后是类的接口 最后，在一个单独的`private:`部分中，是数据（理想情况下只有一个 impl-pointer）。

如果您在保持类声明整洁时遇到问题，这条规则也有很大帮助。

```
class Widget : public Purple {
public:
    // Factory methods.
    Widget FromRadians (float);
    Widget FromDegrees (float);

    // Ctors, rule of three, swap
    Widget();
    Widget (Widget const&);
    Widget &operator = (Widget const &);
    void swap (Widget &) throw();

    // Member methods.
    float area() const;

    // in case of qt {{ 
public slots:
    void invalidateBlackHole();

signals:
    void areaChanged (float);
    // }}

protected:    
    // same as public, but for protected members

private:    
    // same as public, but for private members

private:
    // data
    float widgetness_;
    bool  isMale_;
}; 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-11-09T21:12:36.347

在`if`语句中，当有困难的条件时，可以清楚地显示每个条件在哪个级别使用缩进。

```
if (  (  (var1A == var2A)
      || (var1B == var2B))
   && (  (var1C == var2C)
      || (var1D == var2D)))
{
   // do something
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2010-01-09T19:19:17.413

## 编译时多态性

（也称为句法多态和静态多态，与运行时多态相对。）

使用模板函数，可以编写依赖于类型构造函数和参数化类型家族的调用签名的代码，而无需引入公共基类。

在[*Elements of Programming*](http://www.elementsofprogramming.com/book.html)一书中，作者将这种对类型的处理称为*抽象类*。使用*概念*可以指定对此类类型参数的要求，尽管 C++ 不强制要求此类规范。

两个简单的例子：

```
#include <stdexcept>

template <typename T>
T twice(T n) {
  return 2 * n;
}

InIt find(InIt f, InIt l,
          typename std::iterator_traits<InIt>::reference v)
{
  while (f != l && *f != v)
    ++f;
  return f;
}   

int main(int argc, char* argv[]) {
  if (6 != twice(3))
    throw std::logic_error("3 x 2 = 6");

  int const nums[] = { 1, 2, 3 };
  if (nums + 4 != find(nums, nums + 4, 42))
    throw std::logic_error("42 should not have been found.");

  return 0;
} 
```

可以使用定义`twice`了二元运算符的任何常规类型进行调用`*`。同样，可以`find()`使用任何可比较的类型和模型*Input Iterator*进行调用。一组代码在不同类型上运行类似，看不到共享基类。

当然，这里真正发生的是，相同的源代码在模板实例化时被*扩展*为各种特定于类型的函数，每个函数都有单独的生成机器代码。在没有模板的情况下容纳相同的类型集需要 1) 具有特定签名的单独手写函数，或 2) 通过虚拟函数实现运行时多态性。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-11-09T22:16:17.827

没有收藏夹，但我*将*修复具有以下内容的代码：

1.  制表符 - 导致许多 IDE 和代码审查工具不对齐，因为它们并不总是同意 mod 8 空格处的制表符。
2.  超过 80 列的行 - 让我们面对现实吧，较短的行更具可读性。只要行很短，我的大脑就可以解析大多数编码约定。
3.  带有尾随空格的行 - git 会将其抱怨为空格*错误*，在差异中显示为红色斑点，这很烦人。

这是查找违规文件的单行代码：

```
git grep -I -E '<tab>|.{81,}|  *$' | cut -f1 -d: | sort -u 
```

制表符在哪里`<tab>`（POSIX 正则表达式不做 \t）

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-11-09T22:25:01.880

回复：伊迪达克

我修复了将长语句分成太多短行的代码。

让我们面对现实吧：现在已经不是 90 年代了。如果您的公司买不起其编码器的宽屏 LCD，那么您需要找到一份更好的工作 :)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-10-04T01:24:57.847

## if/while/for 带括号的表达式，带空格分隔符

```
if (expression)  // preferred - if keyword sticks out more 
```

对比

```
if(expression)  // looks too much like a void function call 
```

我想这意味着我喜欢我的函数调用没有空格分隔符

```
foo(parm1, parm2); 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-11-11T22:46:50.307

在与一个部分失明的人一起工作后——并应他的要求——我转而使用更多的空间。我当时不喜欢它，但现在我更喜欢它。在我的脑海中，唯一在标识符和关键字之间没有空格的地方是函数名称*之后*和以下括号之前。

```
void foo( int a, int b )
{
  int c = a + ( a * ( a * b ) );
  if ( c > 12 )
    c += 9;
  return foo( 2, c );
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2010-01-09T19:27:27.933

## 模板和钩子

这是一种在框架中尽可能多地处理的方法，并为框架的用户提供定制的*门*或*钩子*。也称为热点和[模板方法](http://pages.cpsc.ucalgary.ca/~kremer/patterns/templateMethod.html)。

```
class Class {
  void PrintInvoice();     // Called Template (boilerplate) which uses CalcRate()
  virtual void CalcRate() = 0;  // Called Hook
}

class SubClass : public Class {
  virtual void CalcRate();      // Customized method
} 
```

[Wolfgang Pree](http://en.wikipedia.org/wiki/Wolfgang_Pree)在他的《[面向对象软件开发的设计模式》](https://rads.stackoverflow.com/amzn/click/com/0201422948)一书中进行了描述。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-11-09T18:50:22.703

不确定这是否算作成语，但我倾向于使用[doxygen](http://www.doxygen.nl/)样式的内联注释，即使项目尚未使用 doxygen ......

```
bool MyObjects::isUpToSomething() ///< Is my object up to something 
```

（除此之外。我的评论通常不会那么蹩脚。）

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-11-10T18:46:09.637

我真的很喜欢把一个小语句和 if 放在同一行

```
int myFunc(int x) {
   if(x >20) return -1;
   //do other stuff ....
} 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-01-09T19:04:31.497

我不知道它是否符合成语的要求，确切地说，但相当多的重型模板编程（通常严重）依赖于 SFINAE（替换失败不是错误）。[上一个问题](https://stackoverflow.com/questions/982808/c-sfinae-examples)的几个答案都有示例。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-09T18:34:11.533

在函数行记录返回值，这样很容易找到。

```
int function(void) /* return 1 on success, 0 on failure */ 
{
    return 1;
}; 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-11T11:07:32.463

将函数名称放在新行上很有用，因此您可以像 grep

```
grep -R '^fun_name' . 
```

为他们。我已经看到用于大量 GNU 项目的样式并喜欢它：

```
static void
fun_name (int a, int b) {
    /* ... */
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-11-09T17:54:38.617

将每个方法或函数参数写在单独的行上，以便于注释。

```
int ReturnMaxValue(
    int* inputList,   /* the list of integer values from which to get the maximum */
    long size,        /* count of the number of integer values in inputList */
    char* extraArgs   /* additional arguments that a caller can provide.    */
) 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-01-09T18:15:39.193

我建议 PIMPL 或 James Coplien 最初将其称为“Handle Body”。

这个习惯用法允许您将接口与实现完全分离。在重写和重新发布一个主要的 CORBA 中间件组件时，这个习惯用法被用来将 API 与实现完全分离。

这实际上消除了任何可能的逆向工程。

James Coplien 的优秀书籍“ [Advanced C++ Programming Styles and Idioms](https://rads.stackoverflow.com/amzn/click/com/0201548550) ”是 C++ 习语的绝佳资源。强烈推荐！

**编辑：**正如 Neil 在下面指出的那样，这本书已经过时了，他的许多建议实际上已被纳入 C++ 标准本身。但是，我仍然发现它是有用信息的来源，尤其是。以他[关于 C++ 习语的 PLoP 论文](http://users.rcn.com/jcoplien/Patterns/C++Idioms/EuroPLoP98.html)的形式，其中许多习语被重铸为模式形式。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-11T10:53:24.800

我总是挑剔并编辑以下内容：

*   多余的换行符
*   EOF 处没有换行符

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-11-11T11:19:33.470

我通常坚持 *BSD [STYLE(9)中描述的 KNF](http://www.openbsd.org/cgi-bin/man.cgi?query=style&apropos=0&sektion=0&manpath=OpenBSD+Current&arch=i386&format=html)

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2008-11-12T01:38:11.973

我倾向于在我所有的ifs上加上一个else。

```
if (condition)
{
    complicated code goes here
}
else
{
    /* This is a comment as to why the else path isn't significant */ 
} 
```

尽管这让我的同事很生气。你一眼就能看出，我在编码过程中考虑了 else 情况。

# security - 隐藏的输入字段会导致潜在危险的 Request.Form 值错误

> ID：276177
> 
> 赞同：1
> 
> 时间：2008-11-09T17:37:46.657
> 
> 标签：security, validation, postback, asp.net-1.1

在我的 ASP.NET 1.1 应用程序中，我正在压缩并用另一个压缩值替换隐藏的 Viewstate 变量，该值存储在一个名为 __VSTATE 的隐藏字段中。这很好用，但在少数情况下，提交页面会导致常见的“潜在危险的 Request.Form 值...”错误。

我检查了 __VSTATE 值，似乎没有任何危险。我能够使用完全精简的页面版本和 __VSTATE 值重现错误，如下所示。按下提交按钮会导致错误。如果我将值更改为“”，页面工作正常。

```
<%@ Page Language="vb" AutoEventWireup="false" Codebehind="Dangerous.aspx.vb" Inherits="Dynalabs.Dangerous" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <body MS_POSITIONING="FlowLayout">

    <form id="Form1" method="post" runat="server">
      <input type="hidden" id="__VSTATE" runat="server" value="Onw=" />
      <asp:Button ID="btnSubmit" Runat="server" Text="Submit" />
    </form>

  </body>
</html> 
```

将字段名称更改为“MyHiddenWT”没有任何区别。删除 runat="server" 确实停止了错误，但这仅意味着 .NET 仅检查服务器端控件。我还尝试了一些附加值，并发现了以下值：

```
"Anw=", "Bnw=", "Cnw=", ... "Nnw=", "Onw=", "Pnw=", ... "Znw=", 
```

"Onw=" 是唯一导致问题的原因。大写的 O 是否以某种方式被视为八进制值？

有人可以解释为什么这个值会触发错误消息吗？我也在寻找解决方案，但请不要告诉我删除页面验证。这就像说一辆刹车不好的汽车可以通过不开车来修理一样。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T18:30:23.023

我的第一个猜测是它看起来像一个 "OnSomething=" javascript 事件声明。

只有大写的 O 会触发错误，这有点奇怪，您是否也对小写的 o 进行了测试？

你可以试试这些：“OnClick=", "abc OnClick=", "onclick=", "abc onclick=", "anw=", "bnw=", ...

* * *

如果 "OnSomething=x" javascript 是一个问题，那么只需在您的值中添加另一个字符就可以解决问题。也许一个简单的'v'应该做。

```
<input type="hidden" id="__VSTATE" runat="server" value="vOnw=" /> 
```

然后在提交时，在解码之前删除多余的字符。

或者更好的是，升级到 2.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T21:11:00.860

你已经掌握了原因的本质。这是我从另一个网站得到的回复中的最佳链接：

[http://groups.google.com/group/microsoft.public.dotnet.framework.aspnet.security/browse_thread/thread/d91d89511401e979](http://groups.google.com/group/microsoft.public.dotnet.framework.aspnet.security/browse_thread/thread/d91d89511401e979)

# c# - 如何更改禁用的文本框的字体颜色？

> ID：276179
> 
> 赞同：64
> 
> 时间：2008-11-09T17:38:42.410
> 
> 标签：c#, winforms

有谁知道哪个属性设置了禁用控件的文本颜色？我必须在禁用状态下显示一些文本，`TextBox`并且我想将其颜色设置为黑色。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-11-09T17:50:13.340

**注意：**请参阅下面 Cheetah 的回答，因为它确定了使该解决方案发挥作用的先决条件。设置. `BackColor`_`TextBox`

* * *

我认为您真正想要做的是启用`TextBox`并将`ReadOnly`属性设置为`true`.

更改 disabled 中文本的颜色有点棘手`TextBox`。我认为您可能必须继承并覆盖该`OnPaint`事件。

`ReadOnly`虽然应该给你相同的结果，`!Enabled`并允许你保持对颜色和格式的控制`TextBox`。我认为它仍然支持从`TextBox`禁用的`TextBox`.

另一个简单的替代方法是使用 a`Label`而不是 a `TextBox`。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-03-10T19:50:34.460

此外，为了在标记为 ReadOnly 的 TextBox 上遵守 ForeColor，您必须显式设置 BackColor。如果你想让它仍然使用默认的 BackColor，你必须明确设置，因为设计者太聪明了，不适合这里。将 BackColor 设置为其当前值就足够了。我在表单的 Load 事件中执行此操作，如下所示：

```
private void FormFoo_Load(...) {
    txtFoo.BackColor = txtFoo.BackColor;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-11-19T21:58:48.427

我刚刚找到了一个很好的方法。在我的示例中，我使用的是 RichTextBox，但它应该适用于任何控件：

```
public class DisabledRichTextBox : System.Windows.Forms.RichTextBox
{
    // See: http://wiki.winehq.org/List_Of_Windows_Messages

    private const int WM_SETFOCUS   = 0x07;
    private const int WM_ENABLE     = 0x0A;
    private const int WM_SETCURSOR  = 0x20;

    protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        if (!(m.Msg == WM_SETFOCUS || m.Msg == WM_ENABLE || m.Msg == WM_SETCURSOR))
            base.WndProc(ref m);
    }
} 
```

您可以安全地设置 Enabled = true 和 ReadOnly = false，它会像一个标签一样，防止焦点、用户输入、光标更改，而不会被实际禁用。

看看它是否适合你。问候

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-14T06:59:51.827

嗨，从代码端或运行时将 readonly 属性设置为 true，而不是从设计时

```
txtFingerPrints.BackColor = System.Drawing.SystemColors.Info;
txtFingerPrints.ReadOnly = true; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-02T12:59:29.563

你可以试试这个。覆盖 TextBox 的 OnPaint 事件。

```
 protected override void OnPaint(PaintEventArgs e)
{
     SolidBrush drawBrush = new SolidBrush(ForeColor); //Use the ForeColor property
     // Draw string to screen.
     e.Graphics.DrawString(Text, Font, drawBrush, 0f,0f); //Use the Font property
} 
```

将 ControlStyles 设置为“UserPaint”

```
public MyTextBox()//constructor
{
     // This call is required by the Windows.Forms Form Designer.
     this.SetStyle(ControlStyles.UserPaint,true);

     InitializeComponent();

     // TODO: Add any initialization after the InitForm call
} 
```

[参考](http://www.syncfusion.com/FAQ/WindowsForms/FAQ_c94c.aspx#q1121q)

或者你可以试试这个黑客

在 Enter 事件中设置焦点

```
int index=this.Controls.IndexOf(this.textBox1);

this.Controls[index-1].Focus(); 
```

所以你的控制不会集中并且表现得像禁用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-21T16:55:10.830

除了@spoon16 和@Cheetah 的回答，我总是`tabstop`在文本框上将属性设置为False，以防止默认选择文本。

或者，您也可以执行以下操作：

```
private void FormFoo_Load(...) {
    txtFoo.Select(0, 0);
} 
```

或者

```
private void FormFoo_Load(...) {
    txtFoo.SelectionLength = 0;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-15T19:09:51.073

只需处理启用更改并将其设置为您需要的颜色

```
private void TextBoxName_EnabledChanged(System.Object sender, System.EventArgs e)
{
    ((TextBox)sender).ForeColor = Color.Black;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-21T10:53:15.663

如果您想显示无法编辑或选择的文本，您可以简单地使用标签

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-20T17:18:37.093

将“只读”设置为“真”是最简单的方法。

# monitoring - 服务器监控和警报软件？

> ID：276180
> 
> 赞同：7
> 
> 时间：2008-11-09T17:39:12.580
> 
> 标签：monitoring, nagios, cacti

大家都用什么软件来监控硬件？我知道 nagios 和 cacti，但有人使用其他软件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T17:47:06.417

[SolarWinds IPMonitor](http://www.solarwinds.com/products/ipmonitor/)非常有用。有点像仙人掌或 nagios，但更令人赏心悦目。不过，仅限 Windows，而不是免费的（甚至不像“免费啤酒”那样）。;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T19:25:48.823

[http://www.zabbix.com/](http://www.zabbix.com/ "扎比克斯")也相当不错——至少可以与 Nagios 和 Cacti 媲美。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T19:32:25.363

[OpenNMS](http://www.opennms.org/index.php/Main_Page)相当不错，如果你有大量的服务器并且需要做非常全面的监控。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-18T17:38:56.933

要监控 HP Proliant 服务器和 HP Blade 中心的硬件，我可以推荐 Nagios（如果你想成为前卫的话，也可以推荐[Shinken ）和插件](http://shinken-monitoring.org)[check_hpasm](http://labs.consol.de/nagios/check_hpasm)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-08T13:38:46.440

对于服务器监控，无需在您的服务器上安装任何软件，请查看我的公司 ServerMonitoringHQ.com[服务器监控](http://servermonitoringhq.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T21:04:59.047

如果您不想自己运行监控服务器，请考虑使用像 Alertra (alertra.com) 这样的服务。我们已经使用了大约一年，并且对它非常满意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-06T08:32:25.203

您可以使用 RHQ (http://rhq-project.org/)。虽然它在硬件方面不是太强大，但它提供了对许多服务的支持。图表和警报开箱即用，并且可以通过插件提供对新/其他类型的托管资源的支持。RHQ 是开源的，最近刚刚发布了带有漂亮新 GUI 的 4.0 版。RHQ 还提供了一个命令行界面，允许编写脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-09T18:00:18.513

我用过[mon](http://mon.wiki.kernel.org/index.php/Main_Page)和[munin](http://mon.wiki.kernel.org/index.php/Main_Page)。我喜欢 munin 因为它的简单性和灵活性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T19:00:42.663

我们使用[Zenoss](http://www.zenoss.com)来监控我们的系统。我们发现使用 OpenNMS 更容易。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-09T19:43:38.553

我的公司刚刚开始使用 Nagios，主要是为了跟踪正常运行时间。您会寻找另一种解决方案的困难是什么？是规模大还是缺乏监控能力？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-22T01:52:39.643

我们将 NAGIOS 用于一切，并`god`在较低级别/在 Rails 应用程序中。

如果您向我们提供有关您正在寻找或尝试完成的具体内容的更多详细信息，我将很高兴为您提供更多详细信息。

# objective-c - 更新 sqlite3 API

> ID：276182
> 
> 赞同：0
> 
> 时间：2008-11-09T17:40:45.417
> 
> 标签：objective-c, cocoa, sqlite

我想将 Sqlite3 的标准 Leopard 安装更新/升级到 >3.5，以使用 Cocoa 项目中的新 sqlite_xxx_v2 方法。

我似乎找不到有关如何执行此操作的任何信息。有没有人有任何提示或概述更新过程的网站。

iPhone 也支持 3.5+。我知道它是嵌入式的，所以应该不是问题......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T20:35:29.183

您要做的是从[http://sqlite.org/download.html](http://sqlite.org/download.html)获取合并源。然后只需将其编译到/添加到您的项目中。您不想替换系统 sqlite——这会在其他应用程序中产生意想不到的后果。另外，我很确定系统 sqlite 不是库存 sqlite... Apple 可能已经对核心数据所依赖的它进行了自己的修改。

您可以在此处阅读合并内容：http: [//sqlite.org/amalgamation.html](http://sqlite.org/amalgamation.html)，但简而言之：'''合并是一个名为“sqlite3.c”的单个 C 代码文件，其中包含所有 C 代码用于核心 SQLite 库和 FTS3 和 RTREE 扩展'''

我还建议不要直接使用 sqlite 调用，它们的设计初衷不是这样（sqlite 的作者说）。相反，有许多可可包装器，包括 fmdb：[http](http://code.google.com/p/flycode/source/browse/trunk/fmdb/) ://code.google.com/p/flycode/source/browse/trunk/fmdb/ （我写的）:)

-格斯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T06:34:46.647

您真的不想在 Mac OS X 上升级 SQLite 的系统版本。原因是所有 Mac OS X 软件都符合其包含的软件包版本，由 Apple 的构建过程构建。安装不同版本的包，或者甚至自己构建相同的版本，但这样做与 Apple 的做法略有不同，可能会导致系统出现意外行为。

最后，如果您将更新版本的 SQLite（或 Mac OS X 中包含的任何开源库或框架）嵌入到您自己的应用程序中，您应该确保从 Apple 的公共源站点集成 Darwin 更改。这样，您就可以确保从您自己构建的库中尽可能接近与 Apple 发布的版本相同的行为，这对于数据库中的文件锁定等功能尤其重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T18:28:11.513

我不相信我已经更新了我的版本，但它目前是 3.4.2，我可以在当前版本中使用新方法。

我正在使用最新的（公共）iPhone SDK 运行 10.5.5。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T19:47:35.957

将库放入您的项目并从那里链接它可能会更容易。

# python - WCF 和 Python

> ID：276184
> 
> 赞同：25
> 
> 时间：2008-11-09T17:41:15.073
> 
> 标签：python, wcf

是否有可以调用 Windows Communication Foundation (WCF) 服务的[cpython （不是 IronPython）客户端的示例代码？](http://www.python.org/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-10-05T15:42:35.013

我用过[肥皂水](/questions/tagged/suds "显示标记为“泡沫”的问题")。

```
from suds.client import Client

print "Connecting to Service..."
wsdl = "http://serviceurl.com/service.svc?WSDL"
client = Client(wsdl)
result = client.service.Method(variable1, variable2)
print result 
```

那应该让你开始。我能够从 WCF 和 RESTful 层连接到公开的服务。需要进行一些数据按摩来帮助您完成所需的工作，尤其是当您需要绑定到多个命名空间时。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T00:56:04.980

WCF 需要通过通信协议公开功能。我认为最常用的协议可能是 SOAP over HTTP。让我们假设这就是您当时正在使用的东西。

看看[Dive Into Python 中的这一章](https://linux.die.net/diveintopython/html/soap_web_services/index.html)。它将向您展示如何进行 SOAP 调用。

无论通信协议如何，我都不知道在 Python 中调用 WCF 服务的统一方式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-02-20T19:22:37.433

TL;DR：对于 wsHttpBinding (SOAP 1.2) 使用[zeep](http://docs.python-zeep.org/en/master/)

* * *

如果有人在使用带有 WCF 和 wsHttpBinding（即 SOAP 1.2）的 suds（或 suds-jurko）时遇到问题：

*   suds 几乎死了（甚至不能在 python 3 上安装它）
*   suds-jurko 似乎有点死了。0.6 版本有一个非常烦人的无限递归错误（至少在我们的服务公开的 WSDL 上），该错误已在提示中修复，但尚未发布，自上次发布以来已经 1.5 年（截至 2017 年 2 月撰写本文时）犯罪。
    它适用于 python 3，但不支持 SOAP 1.2。[Sovetnikov 的回答](https://stackoverflow.com/a/36152458/220986)是试图让它与 1.2 一起工作，但我没有设法让它对我有用。
*   zeep 似乎是开箱即用的当前方式（我不隶属于 zeep，它只对我有用，我花了几个小时将头撞在砖墙上试图使泡沫起作用）。~~为了使 zeep 工作，WCF 服务主机配置必须在 wsHttpBinding 节点下包含 <security mode="None"/>~~实际上 zeep 似乎支持[基于用户名和签名 (x509) 的 WS-SE](http://docs.python-zeep.org/en/master/wsse.html)，但我没有尝试过，所以可以不要谈论它周围的任何问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-22T10:53:14.897

只是为了帮助某人使用 suds 通过 WS-Addressing 访问 WCF SOAP 1.2 服务。主要问题是在每条消息中注入动作名称。

此示例适用于 python 3 和 suds 端口[https://bitbucket.org/jurko/suds](https://bitbucket.org/jurko/suds)。

示例使用基于 HTTP 标头的自定义身份验证，我保持原样。

TODO：自动从 WSDL 获取 api_direct_url（现在它是硬编码的）。

```
from suds.plugin import MessagePlugin
from suds.sax.text import Text
from suds.wsse import Security, UsernameToken
from suds.sax.element import Element
from suds.sax.attribute import Attribute
from suds.xsd.sxbasic import Import

api_username = 'some'
api_password = 'none'

class api(object):
    api_direct_url = 'some/mex'
    api_url = 'some.svc?singleWsdl|Wsdl'

    NS_WSA = ('wsa', 'http://www.w3.org/2005/08/addressing')

    _client_instance = None
    @property
    def client(self):
        if self._client_instance:
            return self._client_instance
        from suds.bindings import binding
        binding.envns = ('SOAP-ENV', 'http://www.w3.org/2003/05/soap-envelope')

        api_inst = self
        class _WSAPlugin(MessagePlugin):
            def marshalled(self, context):
                api_inst._marshalled_message(context)

        self._client_instance = Client(self.api_url,
                             plugins=[_WSAPlugin()],
                             headers={'Content-Type': 'application/soap+xml',
                                      'login':api_username,
                                      'password': api_password}
                             )
        headers = []
        headers.append(Element('To', ns=self.NS_WSA).setText(self.api_direct_url))
        headers.append(Element('Action', ns=self.NS_WSA).setText('Blank'))
        self._client_instance.set_options(soapheaders=headers)

        cache = self._client_instance.options.cache
        cache.setduration(days=10)
        return self._client_instance

    def _marshalled_message(self, context):
        def _children(r):
            if hasattr(r, 'children'):
                for c in r.children:
                    yield from _children(c)
                    yield c
        for el in _children(context.envelope):
            if el.name == 'Action':
                el.text = Text(self._current_action)
                return

    _current_action = None
    def _invoke(self, method, *args):
        try:
            self._current_action = method.method.soap.action.strip('"')
            return method(*args)
        finally:
            self._current_action = None

    def GetRequestTypes(self):
        return self._invoke(self.client.service.GetRequestTypes)[0]

    def GetTemplateByRequestType(self, request_type_id):
        js = self._invoke(self.client.service.GetTemplateByRequestType, request_type_id)
        return json.loads(js)

    def GetRequestStatus(self, request_guid):
        return self._invoke(self.client.service.GetRequestStatus, request_guid)

    def SendRequest(self, request_type_id, request_json):
        r = json.dumps(request_json, ensure_ascii=False)
        return self._invoke(self.client.service.SendRequest, request_type_id, r) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T22:07:26.357

我不知道任何直接的例子，但如果 WCF 服务启用了 REST，您可以通过 POX（普通旧 XML）通过 REST 方法/等（如果服务有）访问它。如果您控制服务，您也可以通过 REST 公开端点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-08T19:04:43.037

如果您需要通过 tcp 进行二进制序列化通信，请考虑实施 Thrift 之类的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T22:03:59.003

即使没有从 Python 调用 WCF 的特定示例，您也应该能够使用 WCF 创建完全符合 SOAP 的服务。然后，您所要做的就是找到一些如何从 Python 调用普通 SOAP 服务的示例。

最简单的方法是在 WCF 中使用 BasicHttpBinding，然后您可以通过在每个请求和响应中传递一个会话令牌来支持您自己的会话。

# c++ - 可变参数模板

> ID：276188
> 
> 赞同：23
> 
> 时间：2008-11-09T17:46:03.800
> 
> 标签：c++, templates, c++11

C++0x 将允许模板采用任意数量的参数。除了实现元组之外，此功能的最佳用途是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-10T10:02:19.303

1.  **类型安全的 printf**
2.  **在工厂方法**中转发任意多个构造函数参数
***   拥有**任意**基类允许放置和删除有用的**策略**。*   通过具有可变参数模板的构造函数将**异构类型对象**直接移动到容器中进行初始化。*   具有可以计算用户定义的文字（如“10110b”）的值的**文字运算符。****

 **样本到 3：

```
template<typename... T> struct flexible : T... { flexible(): T()... { } }; 
```

采样到 4：

```
struct my_container { template<typename... T> my_container(T&&... t) { } };
my_container c = { a, b, c }; 
```

采样到 5：

```
template<char... digits>
int operator "" b() { return convert<digits...>::value; } 
```

请参阅此示例代码：[here](https://stackoverflow.com/questions/537303/binary-literals/538101#538101)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T14:38:53.383

也许 Andrei Alexandrescu 关于 Going Native 2012 活动的演讲会引起您的兴趣：

[这](http://video.ch9.ms/ch9/5174/7feb4b38-591d-478f-8341-9fd4012d5174/GN12AndreiAlexandrescuVariadicTemplates_high_ch9.mp4)是视频和文档[。](http://ecn.channel9.msdn.com/events/GoingNative12/GN12VariadicTemplatesAreFunadic.pdf)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T17:52:23.287

*   类型安全`printf`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T18:09:07.327

允许诸如 Boost.Function 之类的东西采用任意数量的参数

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-04T08:48:02.807

我刚刚写了[一篇](http://www.codeproject.com/KB/cpp/com_variadic_templates.aspx)关于如何实现多个 COM 接口并使用 C++0x 可变参数模板保持代码紧凑和优雅的文章。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-20T12:54:54.307

我已经实现了一个 NDArray（N 维数组），它具有方法 setSizes 和可变参数计数。使用可变参数模板参数比使用可变参数函数参数类型更安全，而且我可以仅使用可变参数模板参数在编译时控制传递给此函数的参数计数。

```
void setSizes(uintmax_t currentSize) {
    static_assert(1 == NDimensions, "Invalid count of arguments given to setSizes.");

    size_ = currentSize;
    data_ = new NDArrayReferenceType[currentSize];
}

template <typename... Sizes>
void setSizes(uintmax_t currentSize, Sizes... sizes) {
    static_assert(sizeof...(Sizes) + 1 == NDimensions, "Invalid count of arguments given to setSizes.");

    size_ = currentSize;
    data_ = new NDArrayReferenceType[currentSize];

    for (uintmax_t i = 0; i < currentSize; i++) {
        data_[i]->setSizes(sizes...);
    }
} 
```

我还为我自制的 SmartPointer 实现了一个通用的构造函数包装器。它包装了所有用户定义的原始指针类型的构造函数。

```
template <typename TSmartPointer, typename... Args>
static inline void initialize(TSmartPointer *smartPointer, Args... args) {
    smartPointer->pointer_ = new typename TSmartPointer::PointerType(std::forward<Args>(args)...);
    smartPointer->__retain();
} 
```

这段代码似乎不明显，这是SmartPointer初始化程序的一部分，用于SmartPointer是否应该在获取SmartPointer（RAII）时自动调用指针的构造函数。在抽象类的情况下，它无法调用构造函数。

所以，如果我有一个 AbstractObject 类型，它是一个抽象类的 SmartPointer，以及一个 ConcreteObject 类型，它是带有两个整数的构造函数的类的 SmartPointer，我可以编写以下代码：

```
AbstractObject object = ConcreteObject(42, 42); 
```

它就像 C# 和 Java（但带有 RAII），它适用于 C++/GCC 4.8 =）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-25T09:39:17.913

使用动态参数号键入每个调用的安全性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-12T15:27:59.463

其他答案中提到了类型安全的 printf ，但更普遍的是，可变参数模板可用于实现根本不需要通过格式说明符传递类型信息的格式化函数。例如，[C++ Format 库](https://github.com/cppformat/cppformat)实现了类似于 Python 的[str.format](https://docs.python.org/2/library/stdtypes.html#str.format)的格式化函数：

```
fmt::print("I'd rather be {1} than {0}.", "right", "happy"); 
```

除了安全的 printf。使用 C++11 中的可变参数模板自动捕获参数类型。

这使得 printf 说明符 like `lld`or notorious`PRIdPTR`不必要，而不是

```
std::printf("Local number: %" PRIdPTR "\n\n", someIntPtr); 
```

可以简单地使用

```
fmt::printf("Local number: %d\n\n", someIntPtr); 
```

**免责声明**：我是这个库的作者

# performance - MATLAB 类数组

> ID：276198
> 
> 赞同：3
> 
> 时间：2008-11-09T17:52:40.277
> 
> 标签：performance, arrays, matlab, oop

在 MATLAB 中管理大量同一类的实例的最佳方法是什么？

使用幼稚的方式会产生极端的结果：

```
classdef Request
    properties
        num=7;
    end
    methods
        function f=foo(this)
            f = this.num + 4;
        end
    end
end

>> a=[];  

>> tic,for i=1:1000 a=[a Request];end;toc  

Elapsed time is 5.426852 seconds.  

>> tic,for i=1:1000 a=[a Request];end;toc  
Elapsed time is 31.261500 seconds. 
```

继承句柄极大地改善了结果：

```
classdef RequestH < handle
    properties
        num=7;
    end
    methods
        function f=foo(this)
            f = this.num + 4;
        end
    end
end

>> tic,for i=1:1000 a=[a RequestH];end;toc
Elapsed time is 0.097472 seconds.
>> tic,for i=1:1000 a=[a RequestH];end;toc
Elapsed time is 0.134007 seconds.
>> tic,for i=1:1000 a=[a RequestH];end;toc
Elapsed time is 0.174573 seconds. 
```

但仍然不是可接受的性能，特别是考虑到重新分配开销的增加

有没有办法预先分配类数组？关于如何有效管理对象数量的任何想法？

谢谢，
丹妮

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-10T14:48:33.053

这么晚了，但这不是另一种解决方案吗？

```
a = Request.empty(1000,0); tic; for i=1:1000, a(i)=Request; end; toc;
Elapsed time is 0.087539 seconds. 
```

甚至更好：

```
a(1000, 1) = Request;
Elapsed time is 0.019755 seconds. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T21:11:05.053

此解决方案扩展了[Marc 的答案](https://stackoverflow.com/questions/276198/matlab-class-array#276530)。使用**repmat**初始化 RequestH 对象数组，然后使用循环创建所需的对象：

```
>> a = repmat(RequestH,10000,1);tic,for i=1:10000 a(i)=RequestH;end;toc
Elapsed time is 0.396645 seconds. 
```

这是对以下方面的改进：

```
>> a=[];tic,for i=1:10000 a=[a RequestH];end;toc
Elapsed time is 2.313368 seconds. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T21:49:46.617

`repmat`是你的朋友：

```
b = repmat(Request, 1000, 1);

Elapsed time is 0.056720 seconds

b = repmat(RequestH, 1000, 1);
Elapsed time is 0.021749 seconds. 
```

通过追加增长非常缓慢，这就是为什么 mlint 将其称为。

# development-environment - Virtual PC 在个人开发机器上的实用性如何？

> ID：276203
> 
> 赞同：8
> 
> 时间：2008-11-09T17:56:46.820
> 
> 标签：development-environment, virtualization

虚拟 PC 在家庭个人开发计算机上是否实用。我在家里做了一些定制的 .net 编程，我想知道在性能和整体使用方面，Virtual PC 是否有用。Virtual PC 会话中的应用程序运行速度是否较慢。它将帮助我使用我的个人开发机器。你会推荐其他产品吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T00:04:22.583

在我看来，虚拟机是开发人员可以拥有的最好的工具之一。我有我的基础开发机器，并在其上为不同平台运行 VPC 以测试安装和应用程序功能。对于 Web 开发，我让 VPC 运行我支持的每个主要浏览器，因此我不断在各种浏览器上测试我的网站。我什至还在维护一个旧的 VB6 应用程序，并且我已经将旧的 VB6 构建环境复制到了一个 VPC 映像。确保你有大量的 RAM。我的机器以 4GB 运行，它适用于我需要的大多数东西。我还为源代码管理设置了 Sourcegear Vault。我将客户端加载到用于开发的各种 VPC 上，它们都将数据从我的中央 SQL Server 框中检入和检出。它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T18:13:39.687

这真的取决于你的家用电脑是什么样的。我使用 VPC 测试了不同版本的 Visual Studio（例如，确保解决方案与 VS2005 兼容，并检查 VS2010）。

我不想一直使用它，但是我正在使用笔记本电脑。给定一个非常丰富的多核家用台式机（当然最好有硬件支持和大量内存），它对于日常使用可能相当实用。

[VMWare Player](http://vmware.com)是免费的，有些人发现它更快——我自己使用它还不足以正确比较两者。如果您花费大量时间“在”虚拟机中，那么可能值得同时进行适当的试驾。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T19:45:15.667

我在这方面取得了一些成功；我不得不在 Vista 上开发一些较旧的 .NET 1.1 软件，但它不受支持。我必须在虚拟 PC 容器中运行 XP 才能完成项目。

最大的问题是可用的 RAM。我建议您尽可能多地使用家用 PC - 这可能会小于 4GB，除非您运行的是 64 位操作系统。我发现获得额外的 ram 让生活变得更好。Ram 现在很便宜，所以如果一开始对我来说不够好，我会从那里开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T18:27:07.803

VPC 是一个非常好的选择。我用它来测试部署和演示目的。

如果您的 PC 具有新的 Intel 芯片和至少 2 GB 的 RAM，那么它的运行速度实际上与普通 PC 一样快 :)。

不过，我推荐 4 gigs 的 ram，它们现在便宜得要命，而且真的很重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-09T18:01:56.873

是的，应用程序运行速度会变慢，但影响并不像您预期​​的那么大。在虚拟机上进行开发是非常合理的。显然，性能与您的计算机的速度有关，多核机器会做得很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T18:20:24.400

如果您开发驱动程序或核心例程，那么每个错误都可能并且通常会导致崩溃。虚拟机是您可以使用的最好的。

我尝试了 Virtual PC 和 VMWare。他们都非常适合这样的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T20:13:21.007

如果您已经获得了 VirtualPC 许可证，请务必使用它。如果没有，您可以看看 Sun 的[VirtualBox](http://www.virtualbox.org/)。它是免费/自由和跨平台的。我用它在 mac os x 和 linux 上运行 windows 和 linux，并且对它非常满意。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T18:29:35.723

Virtual PC 应该足够快，除非您的驱动程序或代码对时间非常敏感。Virtual PC 的跨平台免费替代品是[Virtual box](http://www.virtualbox.org)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-09T22:16:07.187

我有一个带有 2G 内存的东芝笔记本。我想知道是否值得安装 Virtual box 并用它来浏览网页、加速、一些小型开发工作等？如何在 virtualbox 虚拟会话上安装 Windows 操作系统？那里有很好的教程吗？2gig 的 ram 是否足以在具有以下配置的笔记本电脑上运行虚拟会话：

2 gig ram Intel Pentium 4 cpu 60 gig hdd

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-09T18:07:24.067

您可以在您选择的操作系统上本地运行您的开发工具。并使用虚拟机在其他环境上进行测试。如果您打算这样做，请获得大量内存，例如 2GB 或更多——如果您还没有的话。

AMD 芯片具有一些提高 VM 性能的工具（嵌套页表等）。第二代 Opterons 和一些 Athlon 64 芯片将以合理的价格支持这一点。您甚至可以以相当合理的价格获得具有此类芯片的 HP XW4550 等品牌硬件。我不确定英特尔在多大程度上已经赶上了这一点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-09T19:24:19.157

假设您的主机具有足够的原始功率，那么虚拟机可以正常工作。我有一台 2.5GB 内存，2Ghz 决斗核心工作笔记本电脑，不想安装 vs2008 用于个人开发，所以有一个虚拟机。我现在已经给了它 1 GB 的专用内存，它运行得很好，没有问题。如果需要，我会增加内存分配，但现在我很高兴。

希望这可以帮助 ：-）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-09T20:18:28.547

我使用 VirtualBox 进行所有开发，发现性能比 VPC 好得多。我的机器是大约 2 年的双核，具有 4GB 内存，性能并没有明显比原生运行慢。虚拟机是 Vista，主机操作系统是 Windows 2008。我绝对推荐使用虚拟机，因为为新项目创建新机器非常容易。

# c# - 我可以在新版本的 Visual Studio 中编写一个应用程序并使其与 .NET Framework 1.1 兼容吗

> ID：276204
> 
> 赞同：2
> 
> 时间：2008-11-09T17:58:26.007
> 
> 标签：c#, .net, vb.net, .net-1.1, version-compatibility

我是一名 Web 开发人员，他 99% 的时间都花在 Linux 上，但我需要使用 VB 或可能的 C# (.Net) 开发一个超级简单的应用程序。我拥有的唯一版本的 Visual Studio 是最新的免费版本。某处可能有一份 2001 年的副本。无论如何，我需要为其开发的机器正在运行 Windows NT4。我无法改变这一点，因为另一个软件需要它运行。

有没有办法使用新的 VS 开发应用程序并使其与.Net 框架（1.1）的旧版本兼容？

如果没有别的，我可以在机器上安装 Perl 并编写命令行类型的脚本，但考虑到将使用它的人，GUI 会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T18:10:37.027

我不相信您可以在 Visual Studio 2008 中定位 .Net 1.1。这是开发人员的解释之一，来自[此博客条目](http://blogs.msdn.com/lukeh/archive/2007/06/29/net-framework-multitargeting-in-visual-studio-2008-aka-orcas.aspx)中的评论：

> Visual Studio 2008 将不支持面向 .Net Framework 1.1。这是我们真正希望能够支持的东西——因为我们知道有很多 .NET 开发人员在开发 .NET 1.1 应用程序。但是，返回并支持 .NET 1.1 会更加困难，因为它是一个完全不同的运行时。
> 
> 因此，为了适应这个版本，最终决定要么根本不支持多目标，要么只支持 .NET2.0 和更高版本。因为我们真的希望 Visual Studio 2008 成为至少适用于 .NET 3.0 和 .NET 3.5 的出色工具 - 我们决定在此版本中提供我们可以适应的最多的多目标支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T18:27:51.687

你试过[MSBee](http://msdn.microsoft.com/en-us/vs2005/aa718347.aspx)吗？这是 VS2005 的附加组件（严格来说：MSBuild in 2.0），但它也可以与 VS2008 一起使用。当然，您可以随时使用 IDE 编写代码，只需使用 2.0 文件夹中的 MSBuild 即可构建...

无论哪种方式，如果您以 .NET 1.1 为目标，则只能使用 .NET 1.1 / C# 1.2 功能。

~~就个人而言，我的目标是 3.5SP1，使用（如果需要免费的话）C# Express 2008。~~（我已经删除了这个，因为你需要定位这么旧的操作系统）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T00:19:26.580

您可以使用 vs.net 2008 编写能够在 .net v1.1 上运行的代码，但 IDE 不会为您提供任何关于什么会起作用等的提示。

您将无法使用内联 asp.net 作为模型。（或使用命令行工具编译）

这里有很多使用这种方法的例子：http: [//www.learnasp.com/freebook/learn/](http://www.learnasp.com/freebook/learn/)

除了 v2 示例的显式命名之外，此代码都是 v1.1。

# jquery - 如何根据其中的空输入字段隐藏 div？

> ID：276206
> 
> 赞同：3
> 
> 时间：2008-11-09T17:59:15.083
> 
> 标签：jquery

我有一个由多个可选子部分组成的表单 - 每个子部分都包含在

```
<div class="details"></div> 
```

在编辑表格时，我想隐藏那些尚未完成的子部分，显然我想不显眼地做到这一点。为了简化事情，我只是检查名称以“姓”结尾的那些字段是否为空，然后适当地显示/隐藏。到目前为止，我有这个。

```
//hide the all of the element class details
$(".details").each(function (i) {
  if ($('input[name$=surname]:empty',this).length == 1) { 
    $(this).hide();
  } else {
    $(this).show();
  }
}); 
```

当然， :empty 选择器可能是错误的，或者确实不合适。（当然，我真正想做的是显示所有字段已完成的任何部分，但我想我会从检查最重要的部分开始。）

如果有人能指出我正确的方向，我会很感激......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T18:07:23.553

没有选择器的爱？不完全确定这是您真正要查找的内容，但这会隐藏所有带有空输入的详细信息元素。也许这是一个线索。

```
<div class="details">
    <input type="text" name="surname" />
</div>

<script type="text/javascript">
    $(".details input[@value='']").parents(".details").hide();
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T19:15:08.283

谢谢大家 - [value=""] 是我缺少的部分。万一其他人想知道，做这个伎俩的准系统jQuery（感谢克里斯蒂安）是

```
 //hide the all of the element class details
    $(".details").each(function (i) {
      if ($('input[name$=surname][value=""]',this).length == 1) { 
        $(this).hide();
        console.log('hiding');
      } else {
        $(this).show();
        console.log('showing');
      }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T18:18:41.330

这可能只是一个错字，但您也不需要/不应该在您的标记中使用“.details”的 CSS 类名，只需“details”。点前缀是 CSS/jQuery 选择器语法的一部分。

根据[文档](http://docs.jquery.com/Selectors/empty)，":empty" 查找空元素（如不包含子元素），而不是没有值的表单元素（空文本框）。检查等于空字符串的 value 属性将适用于单行文本输入，但您需要更复杂的查询来包括文本区域、单选按钮等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T18:43:49.987

这可能会做要求的事情：

```
$("div.details input").each(function () {
  if (this.value == "")
    $(this).parents("div.details").eq(1).hide();
  else
    $(this).parents("div.details").eq(1).show();
}); 
```

要仅影响 name 属性中带有“surname”的字段，请执行以下明显操作：

```
$("div.details input[name$=surname]").each(function () { /* etc... */ 
```

# asp.net - ASP.NET MVC Web 应用程序与 ASP.NET Web 应用程序

> ID：276211
> 
> 赞同：15
> 
> 时间：2008-11-09T18:01:17.543
> 
> 标签：asp.net, asp.net-mvc

除了**ASP.NET MVC Web 应用程序**在其 MVC 模式的实现上更加清晰并且严格遵循 MVC 模式这一事实之外，它与**ASP.NET Web 应用程序**有何不同？

如果您让您的**ASP.NET Web 应用程序**具有**业务逻辑层**、**数据访问层**并严格使用它们进行所有数据查询，那么它不完全遵循**MVC 模式**吗？

我的逻辑是：BLL 和 DLL 一起是**Model**，ASPX 页面是**View**而代码隐藏（ASPX.CS）页面是**Controller**。

提前感谢任何可以确认上述内容和/或对这个主题有更多了解的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T18:07:02.617

这个最近的问题可能会解决您的担忧：[MVC 模式与 DAL / BLL 设计模式有何不同（如果有的话）？](https://stackoverflow.com/questions/267924/how-does-the-mvc-pattern-differ-if-at-all-from-the-dal-bll-design-pattern)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T18:32:48.323

设计 ASP.NET MVP Web 应用程序需要更多经验、纪律和工作，以便您的应用程序支持测试自动化。当您可以将高级 GridView 与 SqlDataSource 一起放在页面上并将其直接绑定到存储过程时，您会将测试自动化抛到窗外。

许多 MVP 应用程序是使用封装了许多代码隐藏逻辑的 3rd 方工具包编写的。这往往会破坏 MVP 设计中清晰的职责分离。

从好的方面来说，我可以使用 3rd 方工具包编写具有丰富 UI 的 ASP.NET Web 应用程序，而我可以在当前状态下使用 MVC 的时间的十分之一。对于一个简单的管理工具，这正是我今天要做的。对于大规模的 n 层应用程序，我倾向于 MVC。

# sql - 更改没有主键的表中的每条记录？

> ID：276212
> 
> 赞同：0
> 
> 时间：2008-11-09T18:01:27.573
> 
> 标签：sql, mysql, primary-key

我在数据库中有一个以文本形式表示日期的表（即“2008-11-09”），我想用 UNIX 时间戳替换它们。但是，我不认为 MySQL 能够自己进行转换，所以我想编写一个小脚本来进行转换。我能想到的方法包括获取表中的所有记录，遍历它们，并更新数据库记录。但是，由于没有主键，我无法轻松获得需要更新的确切记录。

有没有办法让 MySQL 在 SELECT 期间为记录分配临时 ID，以便我在执行 UPDATE 时参考它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-09T18:10:52.330

这不做吗？

```
UPDATE
  MyTable
SET
  MyTimeStamp = UNIX_TIMESTAMP(MyDateTime); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T18:10:07.823

如果由于某种原因您必须进行迭代（其他答案涵盖了您不需要迭代的情况），我可以想到两种方法（这些不是 MySQL 特定的）：

1.  在表中添加一个自动分配编号的列。将其用作更新的 PK，然后删除该列（或将其保留以备将来使用）。

2.  在没有定义 PK 的表中，只要不存在完全重复的行，就可以将整行作为复合 PK；只需将行中的每一列用作您的显着特征。即，如果表有 3 列，“名称”、“地址”和“更新”，请执行以下操作：

    UPDATE mytable SET updated = [timestamp value] WHERE name = [name] AND address = [address] AND timestamp = [old timestamp]

许多数据访问框架使用这种精确的策略来实现乐观并发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T18:10:27.963

不，您应该能够使用单个更新语句来执行此操作。如果所有日期都是 yyyy-mm-dd 并且它们只是存储在某种文本列而不是 DATETIME 中，则您可以将数据移过来。SQL 就像：

```
ALTER TABLE t ADD COLUMN dates DATETIME;
UPDATE t set t.dates=t.olddate; 
```

这不应该依赖于 PK，因为 MySQL 可以扫描表中的每一行。PK 成为问题的唯一一次是如果您需要更新单行，但该行可能不是唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T18:14:43.867

您可以在使用 MySQL 用户变量功能期间生成值`SELECT`，但这些值不引用行；它们只是结果集的临时部分。您不能在`UPDATE`语句中使用它们。

```
SET @v := 0;
SELECT @v:=@v+1, * FROM mytable; 
```

这是我解决问题的方法。无论如何，您将不得不为您的 UNIX 时间戳创建另一列，因此您可以先添加它。然后将旧 datetime 列中的值转换为 UNIX 时间戳并将其放入新列中。然后删除旧的文本日期时间列。

```
ALTER TABLE mytable ADD COLUMN unix_timestamp INT UNSIGNED NOT NULL DEFAULT 0;

UPDATE mytable
SET unix_timestamp = UNIX_TIMESTAMP( STR_TO_DATE( text_timestamp, '%Y-%m-%d' ) );

ALTER TABLE mytable DROP COLUMN text_timestamp; 
```

当然，您应该在删除旧列之前确认转换已正确完成！

见[`UNIX_TIMESTAMP()`](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_unix-timestamp)和[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_str-to-date)

# javascript - 用jQuery选择多个后代？

> ID：276249
> 
> 赞同：16
> 
> 时间：2008-11-09T18:22:36.877
> 
> 标签：javascript, jquery, forms, jquery-selectors

我有这个表格：

```
<form name="customize">
    Only show results within 
        <select name="distance" id="slct_distance">
            <option>25</option>
            <option>50</option>
            <option>100</option>
            <option value="10000" selected="selected">Any</option>
    </select> miles of zip code
    <input type="text" class="text" name="zip_code" id="txt_zip_code" />
    <span id="customize_validation_msg"></span>
</form> 
```

如何使用一个 jQuery 选择器选择`input`and ？`select`

我试过这个，但它选择了页面上的所有选择和输入：

```
$("form[name='customize'] select,input") 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-09T18:39:02.430

选择器字符串中的逗号分隔完全独立的表达式，就像在 CSS 中一样，因此您提供的选择器获取名为“customize”的表单中的选择元素以及表单上的所有输入（如您所描述的）。听起来你想要这样的东西：

```
$("form[name='customize'] select, form[name='customize'] input") 
```

或者如果你不喜欢重复，这个：

```
$("form[name='customize']").children("select, input") 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-09T18:45:49.170

更短的语法 $(selector,parentselector) 也是可能的。本页示例：

```
// all spans
$("span").css("background-color","#ff0");

// spans below a post-text class
$("span", ".post-text").css("background-color","#f00"); 
```

编辑 - 我忘记了几种孩子的特殊情况！

```
// spans and p's below a post-text class
$("span,p", ".post-text").css("background-color","#f00"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T18:28:53.823

对我来说，你的建议奏效了。你也可以使用

```
form[name='customize'] select, form[name='customize'] input 
```

两个选择器都像我看到的那样工作。也许问题出在其他地方？

我试过

```
$("form[name='customize'] select, input").css( 'font-size', '80px' ); 
```

在您的示例 HTML 上。选择和输入的字体大小已更改。

- - 编辑 - -

我上面的建议是正确的。它只选择自定义表单中的元素。

# c# - C#：如何在函数参数中传递对象？

> ID：276253
> 
> 赞同：6
> 
> 时间：2008-11-09T18:25:57.447
> 
> 标签：c#

C#：如何在函数参数中传递对象？

```
public void MyFunction(TextBox txtField)
{
  txtField.Text = "Hi.";
} 
```

以上是否有效？或者？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T18:27:37.320

只要您不在其他线程中，是的，代码示例是有效的。文本框（或其他窗体项）仍然是可以传递给方法并由方法操作的对象。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-09T18:30:19.687

是的，这会奏效。您实际上并没有传递对象 - 您传递的是对该对象的*引用*。

有关按引用传递与按值传递的详细信息，请参阅[“C# 中的参数传递” 。](http://pobox.com/~skeet/csharp/parameters.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-09T18:34:34.730

对于任何引用类型，这都很好 - 您已将*引用*传递给对象，但只有一个对象，因此调用者可以看到更改。

*不起作用*的主要时间是“结构”（值类型） - 但它们实际上不应该是可变的（即它们不应该真正具有可编辑的属性）。

如果您*需要*使用结构执行此操作，您可以添加“ref” - 即

```
public void MyFunction(ref MyMutableStruct whatever)
{
  whatever.Value = "Hi."; // but avoid mutable structs in the first place!
} 
```

# java - 如何禁用（或隐藏）JFrame 上的关闭 (x) 按钮？

> ID：276254
> 
> 赞同：27
> 
> 时间：2008-11-09T18:26:09.647
> 
> 标签：java, windows, swing

我有一个窗口（从 JFrame 派生），我想在某些不可中断的操作期间禁用关闭按钮。我知道我可以通过调用使按钮不做任何事情（或调用 WindowListener 中的处理程序）

```
setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); 
```

但我想从视觉上说清楚点击它是没有意义的。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-11T02:19:00.190

这可能是你会得到的最好的：

```
setUndecorated(true);
getRootPane().setWindowDecorationStyle(JRootPane.NONE); 
```

这将删除整个标题栏，java 并没有真正指定删除标题栏各个组件的方法

编辑：

可能有办法，看看这些线程：

*   [链接 1](http://saloon.javaranch.com/cgi-bin/ubb/ultimatebb.cgi?ubb=get_topic&f=2&t=015407)
*   [链接 2](http://forums.sun.com/thread.jspa?messageID=10255068)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-09T21:15:12.003

如果我理解正确，[则此错误报告](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6199687)表明这目前是不可能的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-02T18:27:10.837

对于那些迟于 2008 年的人来说，发生了一些变化，使之成为可能。看到[这个链接](http://www.coderanch.com/t/344419/GUI/java/deactivate-close-minimise-resizable-window)

底部的第二个响应显示了如何按名称进行操作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-15T11:49:44.503

这将帮助您：

```
frame.setDefaultCloseOperation(0); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-27T22:27:59.333

要简单地使它们消失，请尝试以下操作：

```
setUndecorated(true); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-12-21T08:25:29.343

请试试这个

```
frame.addWindowListener(new WindowAdapter() {
      public void windowClosing(WindowEvent e) {
        e.getWindow().setVisible(false);
            try {
                wait();
            } catch (InterruptedException ex) {
                Logger.getLogger(WindowsActions.class.getName()).log(Level.SEVERE, null, ex);
            }
      }
    }); 
```

# python - 在 python 中播放声音文件的跨平台方式是什么？

> ID：276266
> 
> 赞同：20
> 
> 时间：2008-11-09T18:28:42.700
> 
> 标签：python, cross-platform, audio

我尝试使用 pyaudio 播放 .wav 文件。它在 Windows 上运行良好，但在另一台设备使用声音时无法在 Ubuntu 中运行。

> 错误是“IOError: [Errorno Invalid output device (no default output device)] -9996

我可以尝试使用另一个库吗？另一种方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-10T07:21:59.830

你可以使用[wxPython](http://wxpython.org/)

```
sound = wx.Sound('sound.wav')
sound.Play(wx.SOUND_SYNC) 
```

或者

```
sound.Play(wx.SOUND_ASYNC) 
```

[这](http://svn.wxwidgets.org/viewvc/wx/wxPython/tags/wxPy-2.8.9.1/wxPython/demo/Sound.py?view=markup)是 wxPython 演示中的一个示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T19:05:47.757

你看过pymedia吗？播放 WAV 文件看起来就像这样简单：

```
import time, wave, pymedia.audio.sound as sound
f= wave.open('YOUR FILE NAME', 'rb')
sampleRate= f.getframerate()
channels= f.getnchannels()
format= sound.AFMT_S16_LE
snd= sound.Output(sampleRate, channels, format)
s= f.readframes(300000)
snd.play(s)
while snd.isPlaying(): time.sleep(0.05) 
```

参考： http: [//pymedia.org/tut/play_wav.html](http://pymedia.org/tut/play_wav.html)

当然，您可以查看音频 ( [http://wiki.python.org/moin/Audio/](http://wiki.python.org/moin/Audio/) ) 下的 Python wiki，了解其他库，例如[https://docs.python.org/library/wave.html](https://docs.python.org/library/wave.html)或者再次在 Python 的 wiki 中的 Game Libraries ( [http://wiki.python.org/moin/PythonGameLibraries](http://wiki.python.org/moin/PythonGameLibraries) ) 下，将指向具有声音模块的 OpenAL 或 Pygame 的绑定。

最后，虽然我不知道 pyaudio 的局限性，但您的错误消息听起来更像是库无法找到默认输出设备，而不是另一个进程正在使用该设备。也许看看`get_default_output_device_info`pyaudio 返回的输出设备，并将其与 Ubuntu 中的默认设置进行比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-29T12:16:08.457

您可以尝试[Simpleaudio](http://simpleaudio.readthedocs.org/en/latest/index.html)：

```
> pip install simpleaudio 
```

然后：

```
import simpleaudio as sa

wave_obj = sa.WaveObject.from_wave_file("path/to/file.wav")
play_obj = wave_obj.play()
play_obj.wait_done() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T09:37:33.830

我不确定这是否满足您的要求，但我立即想到 PyGame

[http://www.pygame.org/docs/ref/mixer.html#pygame.mixer.Sound](http://www.pygame.org/docs/ref/mixer.html#pygame.mixer.Sound "PyGame 声音模块")

```
from pygame import mixer

mixer.init()
s = mixer.Sound('sound.wav')
s.play() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-23T19:51:12.140

我发现[`playsound`](https://pypi.python.org/pypi/playsound)是最简单的。

```
from playsound import playsound

is_synchronus = False
playsound(r"C:\Windows\Media\chimes.wav", is_synchronus) 
```

# java - LinkedList 与 Array 对已排序数据与未排序数据的可行性？

> ID：276278
> 
> 赞同：-4
> 
> 时间：2008-11-09T18:34:18.960
> 
> 标签：java, data-structures, big-o

比较 LinkedLists 和 Arrays，同时比较它们与已排序和未排序数据的差异

*   添加
*   移除
*   检索
*   排序
*   整体速度
*   总体内存使用情况

实际问题

> 讨论将未排序的数据集实现为链表而不是数组的可行性。在插入、删除、检索、计算机内存和应用程序速度方面的权衡是什么？
> 
> 讨论将排序数据集实现为链表而不是数组的可行性。在插入、删除、检索、计算机内存和应用程序速度方面的权衡是什么？
> 
> 根据您对前面问题的回答，总结在应用程序中使用链表的成本和收益。

我的答案/输入：

> 每次添加新节点时，LinkedLists 都必须分配内存，这在添加许多节点并且大小不断变化时很有用，但在添加少量元素时通常会变慢
> 
> 数组在程序运行开始时分配内存，调整列表的速度很慢（如果必须调整大小，添加许多元素很慢）
> 
> 由于索引，在数组中检索速度更快
> 
> 由于指针，在 LinkedList 中添加/删除更快

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T18:59:19.300

不确定这是针对哪个课程的，但是对于 CS 程序，您必须比“慢”和“快”做得更好。尝试根据需要的操作数来量化它。您应该熟悉通常用于此类量化的机器 - 使用该机器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T19:34:46.373

关于未排序与排序。我会做一个，然后你真的需要做你的功课

Stackoverflow 标记确实需要表格来执行此操作。您想说对于未排序/数组、已排序/数组、未排序/链表、已排序/链表的操作有多“昂贵”

最后一点：“应用程序的速度”暗示要考虑的不仅仅是单个操作的速度。

```
* Adding 
```

未排序：除非需要调整大小，否则数组添加是 O(1) - 只需将其添加到末尾。您可能想讨论一种最小化开销的调整大小策略（提示：不要只是将大小增加一）

排序：数组添加是 O(n) - 找到添加它的位置是 O(log(n))，但是您需要（平均）向上移动一半元素以为新元素创建 romm

未排序：链表为 O(1) - 将其添加到列表的开头或结尾。

排序：链表是 O(n) - 尽管您可以再次在 O(1) 中添加元素，但您需要平均扫描一半列表以找到放置它的位置。

所以，剩下的交给你了。发表一个答案，我们会批评它，但是为了从你（大概）昂贵的教育中获得最大收益，你真的需要在这方面做一些工作:)

```
* Removing
* Retrieving
* Sorting
* Overall speed
* Overall memory usage 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-04T06:18:38.547

```
Here is a C++ code that illustrates that sorting the data miraculously makes the code faster than the unsorted version. Let’s try out a sample C++ program to understand the problem statement better. 
```

// CPP 程序演示处理 // 排序和未排序数组的时间

```
#include <iostream>
#include <algorithm>
#include <ctime>
using namespace std;

const int N = 100001;

int main()
{
    int arr[N];

    // Assign random values to array
    for (int i=0; i<N; i++)
        arr[i] = rand()%N;

    // for loop for unsorted array
    int count = 0;
    double start = clock();
    for (int i=0; i<N; i++)
        if (arr[i] < N/2)
            count++;

    double end = clock();
    cout << "Time for unsorted array :: "
         << ((end - start)/CLOCKS_PER_SEC)
         << endl;
    sort(arr, arr+N);

    // for loop for sorted array
    count = 0;
    start = clock();

    for (int i=0; i<N; i++)
        if (arr[i] < N/2)
            count++;

    end = clock();
    cout << "Time for sorted array :: "
         << ((end - start)/CLOCKS_PER_SEC)
         << endl;

    return 0;
} 
```

//代码的输出

```
Output :

Execution 1:
Time for an unsorted array: 0.00108
Time for a sorted array: 0.00053

Execution 2:
Time for an unsorted array: 0.001101
Time for a sorted array: 0.000593

Execution 3:
Time for an unsorted array: 0.0011
Time for a sorted array: 0.000418
Observe that time taken for processing a sorted array is less as compared to an unsorted array. The reason for this optimization for a sorted array is branch prediction. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T19:45:32.793

@保罗：谢谢

> *   移除

未排序和已排序：数组删除是 O(n) - 必须将所有元素移动以填充“洞”

未排序和排序：链表是 O(1) - 根据需要更改指针

# python - Python中每个进程的CPU使用率

> ID：276281
> 
> 赞同：15
> 
> 时间：2008-11-09T18:35:14.543
> 
> 标签：python, monitoring, cpu-usage

我是否可以看到当前 python 应用程序正在使用的处理器使用量（最大值的百分比）？

场景：我的主机将允许我运行我的应用程序，只要它不消耗超过 X% 的 CPU 功率，所以我希望它“关注自身”并减速。那么我怎样才能知道应用程序使用了多少 CPU 呢？

目标平台是 *nix，但我也想在 Win 主机上进行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-09T18:44:10.703

```
>>> import os
>>> os.times()
(1.296875, 0.765625, 0.0, 0.0, 0.0)
>>> print os.times.__doc__
times() -> (utime, stime, cutime, cstime, elapsed_time)

Return a tuple of floating point numbers indicating process times. 
```

从（2.5）手册：

> 次( )
> 
> 返回一个浮点数的 5 元组，以秒为单位表示累积（处理器或其他）时间。这些项目是：用户时间、系统时间、孩子的用户时间、孩子的系统时间和自过去的固定点以来经过的实际时间，按此顺序。请参阅 Unix 手册页 times(2) 或相应的 Windows 平台 API 文档。可用性：Macintosh、Unix、Windows。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-06-07T12:55:38.500

通过使用[psutil](http://code.google.com/p/psutil)：

```
>>> import psutil
>>> p = psutil.Process()
>>> p.cpu_times()
cputimes(user=0.06, system=0.03)
>>> p.cpu_percent(interval=1)
0.0
>>> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-09T18:40:07.217

该`resource`模块提供了[`getrusage`](http://www.python.org/doc/2.5.2/lib/node522.html)可以为您提供所需信息的模块，至少对于类 Unix 平台而言。

请注意，CPU 使用率始终是在一个时间间隔内测量的。本质上，它是你的程序做某事所花费的时间除以间隔时间。

例如，如果您的应用程序在 5 秒的时间段内占用了 2 秒的 CPU 时间，那么可以说它使用了 40% 的 CPU。

请注意，这种计算虽然看起来很简单，但在使用多处理器系统时可能会变得很棘手。如果您的应用程序在双处理器系统上的 5 秒挂钟时间中使用 7 秒的 CPU 时间，您说它是使用 140% 还是 70% 的 CPU？

更新：正如[gimel](https://stackoverflow.com/questions/276281/cpu-usage-per-process-in-python#276295)提到的，该`os.times`功能还以独立于平台的方式提供此信息。当然，上述计算说明仍然适用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-27T10:24:24.120

用于`time.clock()`获取 CPU 时间。要获得 CPU 使用率，请执行 CPU time elapsed/time elapsed

例如，如果经过的 CPU 时间为 0.2，经过的时间为 1，则 CPU 使用率为 20%。

注意：您必须除以您拥有的处理器数量。如果您有 2 个即双核：

```
import decimal,timeit
decimal.getcontext().prec=1000
def torture():
    decimal.Decimal(2).sqrt()
    time.sleep(0.1)
import time
clock=time.clock()
while 1:
    clock=timeit.timeit(torture,number=10)
    tclock=time.clock()
    print((tclock-clock)*p)
    clock=tclock 
```

# python - 如何在 Django 中向访问者显示移动的网页并返回 301 重定向 HTTP 响应状态代码？

> ID：276286
> 
> 赞同：0
> 
> 时间：2008-11-09T18:39:37.390
> 
> 标签：python, django, http, redirect, http-headers

当网页移动到新位置时，如何显示移动的网页并在[Django](http://djangoproject.com/)中返回 301 永久重定向 HTTP 响应状态代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T19:13:21.360

```
 from django import http

   return http.HttpResponsePermanentRedirect('/yournewpage.html') 
```

浏览器将获得 301，并按`/yournewpage.html`预期进行。另一个答案在技术上是正确的，因为 python 本身并没有处理重定向，浏览器是。这就是幕后发生的事情：

```
Browser             Python         HTTP
   ------------------->            GET /youroldpage.html HTTP/1.1

   <-------------------            HTTP/1.1 301 Moved Permanently
                                   Location: /yournewpage.html
   ------------------->            GET /yournewpage.html HTTP/1.1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T19:08:06.147

你不能。

301 是浏览器直接执行的 HTTP 返回码。许多网站通过首先将用户发送到一个重定向器页面来处理这两个问题，该页面告诉用户更改，然后 X 秒后将它们发送到新页面。但是redirect-er 页面*必须*有一个200 代码。

一个小的变体是检测搜索引擎蜘蛛（通过 IP 和/或用户代理）并给*它们*301。这样搜索结果就会指向您的新页面。

# java - 在java中从网络摄像头捕获图像？

> ID：276292
> 
> 赞同：86
> 
> 时间：2008-11-09T18:42:22.577
> 
> 标签：java, image, webcam, capture

如何从网络摄像头连续捕获图像？

我想尝试对象识别（可能使用 java 媒体框架）。

我正在考虑创建两个线程

一个线程：

*   节点 1：捕获实时图像
*   节点2：将图像另存为“1.jpg”
*   节点 3：等待 5 秒
*   节点 4：重复...

其他线程：

*   节点 1：等到图像被捕获
*   节点 2：使用“1.jpg”从每个像素中获取颜色
*   节点 3：将数据保存在数组中
*   节点 4：重复...

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-01-28T15:21:15.990

这个 JavaCV 实现工作正常。

代码：

```
import org.bytedeco.javacv.*;
import org.bytedeco.opencv.opencv_core.IplImage;

import java.io.File;

import static org.bytedeco.opencv.global.opencv_core.cvFlip;
import static org.bytedeco.opencv.helper.opencv_imgcodecs.cvSaveImage;

public class Test implements Runnable {
    final int INTERVAL = 100;///you may use interval
    CanvasFrame canvas = new CanvasFrame("Web Cam");

    public Test() {
        canvas.setDefaultCloseOperation(javax.swing.JFrame.EXIT_ON_CLOSE);
    }

    public void run() {

        new File("images").mkdir();

        FrameGrabber grabber = new OpenCVFrameGrabber(0); // 1 for next camera
        OpenCVFrameConverter.ToIplImage converter = new OpenCVFrameConverter.ToIplImage();
        IplImage img;
        int i = 0;
        try {
            grabber.start();

            while (true) {
                Frame frame = grabber.grab();

                img = converter.convert(frame);

                //the grabbed frame will be flipped, re-flip to make it right
                cvFlip(img, img, 1);// l-r = 90_degrees_steps_anti_clockwise

                //save
                cvSaveImage("images" + File.separator + (i++) + "-aa.jpg", img);

                canvas.showImage(converter.convert(img));

                Thread.sleep(INTERVAL);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        Test gs = new Test();
        Thread th = new Thread(gs);
        th.start();
    }
} 
```

[JavaCV的配置](http://ganeshtiwaridotcomdotnp.blogspot.com/2017/01/javacv-configuration-in-windows.html)也有帖子

您可以修改代码并能够定期保存图像并进行所需的其余处理。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-11-12T16:51:25.267

前段时间，我创建了通用 Java 库，可用于使用 PC 网络摄像头拍照。API 非常简单，功能不过分，可以独立工作，还支持其他网络摄像头驱动程序，如 OpenIMAJ、JMF、FMJ、LTI-CIVIL 等，以及一些 IP 摄像头。

该项目的链接是[https://github.com/sarxos/webcam-capture](https://github.com/sarxos/webcam-capture)

示例代码（拍照并保存在test.jpg中）：

```
Webcam webcam = Webcam.getDefault();
webcam.open();
BufferedImage image = webcam.getImage();
ImageIO.write(image, "JPG", new File("test.jpg")); 
```

它也可以在 Maven 中央存储库中使用，或者作为单独的 ZIP 提供，其中包括所有必需的依赖项和 3rd 方 JAR。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-12-08T01:32:16.657

JMyron 使用起来非常简单。 [http://webcamxtra.sourceforge.net/](http://webcamxtra.sourceforge.net/)

```
myron = new JMyron();
myron.start(imgw, imgh);
myron.update();
int[] img = myron.image(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-15T11:19:45.380

[这](https://stackoverflow.com/questions/115835/what-is-the-best-method-to-capture-images-from-a-live-video-device-for-use-by-a)是一个类似的问题，有一些 - 但未被接受 - 答案。其中一个提到[FMJ](http://fmj-sf.net/)作为 JMF 的 Java 替代品。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-12T22:46:43.623

这种使用 JavaCV 与 gt_ebuddy 的答案不同，但我的视频输出质量比他的答案高得多。我还添加了一些其他随机改进（例如在按下 和 时关闭程序`ESC`，`CTRL+C`并确保关闭程序正确使用的资源）。

```
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.image.BufferedImage;

import javax.swing.AbstractAction;
import javax.swing.ActionMap;
import javax.swing.InputMap;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.KeyStroke;

import com.googlecode.javacv.CanvasFrame;
import com.googlecode.javacv.OpenCVFrameGrabber;
import com.googlecode.javacv.cpp.opencv_core.IplImage;

public class HighRes extends JComponent implements Runnable {
    private static final long serialVersionUID = 1L;

    private static CanvasFrame frame = new CanvasFrame("Web Cam");
    private static boolean running = false;
    private static int frameWidth = 800;
    private static int frameHeight = 600;
    private static OpenCVFrameGrabber grabber = new OpenCVFrameGrabber(0);
    private static BufferedImage bufImg;

    public HighRes()
    {
        // setup key bindings
        ActionMap actionMap = frame.getRootPane().getActionMap();
        InputMap inputMap = frame.getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);

        for (Keys direction : Keys.values())
        {
            actionMap.put(direction.getText(), new KeyBinding(direction.getText()));
            inputMap.put(direction.getKeyStroke(), direction.getText());
        }

        frame.getRootPane().setActionMap(actionMap);
        frame.getRootPane().setInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW, inputMap);

        // setup window listener for close action
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.addWindowListener(new WindowAdapter()
        {
            public void windowClosing(WindowEvent e)
            {
                stop();
            }
        });
    }

    public static void main(String... args)
    {
        HighRes webcam = new HighRes();
        webcam.start();
    }

    @Override
    public void run()
    {
        try
        {

            grabber.setImageWidth(frameWidth);
            grabber.setImageHeight(frameHeight);
            grabber.start();
            while (running)
            {

                final IplImage cvimg = grabber.grab();
                if (cvimg != null)
                {

                    // cvFlip(cvimg, cvimg, 1); // mirror

                    // show image on window
                    bufImg = cvimg.getBufferedImage();
                    frame.showImage(bufImg);
                }
            }
            grabber.stop();
            grabber.release();
            frame.dispose();
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
    }

    public void start()
    {
        new Thread(this).start();
        running = true;
    }

    public void stop()
    {
        running = false;
    }

    private class KeyBinding extends AbstractAction {

        private static final long serialVersionUID = 1L;

        public KeyBinding(String text)
        {
            super(text);
            putValue(ACTION_COMMAND_KEY, text);
        }

        @Override
        public void actionPerformed(ActionEvent e)
        {
            String action = e.getActionCommand();
            if (action.equals(Keys.ESCAPE.toString()) || action.equals(Keys.CTRLC.toString())) stop();
            else System.out.println("Key Binding: " + action);
        }
    }
}

enum Keys
{
    ESCAPE("Escape", KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0)),
    CTRLC("Control-C", KeyStroke.getKeyStroke(KeyEvent.VK_C, KeyEvent.CTRL_DOWN_MASK)),
    UP("Up", KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0)),
    DOWN("Down", KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0)),
    LEFT("Left", KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0)),
    RIGHT("Right", KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0));

    private String text;
    private KeyStroke keyStroke;

    Keys(String text, KeyStroke keyStroke)
    {
        this.text = text;
        this.keyStroke = keyStroke;
    }

    public String getText()
    {
        return text;
    }

    public KeyStroke getKeyStroke()
    {
        return keyStroke;
    }

    @Override
    public String toString()
    {
        return text;
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-02-06T12:23:52.993

您也可以尝试[Java Webcam SDK](http://www.smaxe.com/product.jsf?id=juv-webcam-sdk)库。SDK 演示小程序可在[链接](http://demo.smaxe.com/juv-na-demo-webcam.html)中找到。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-10T18:14:55.130

我在视频会议应用程序中使用了 JMF，它在两台笔记本电脑上运行良好：一台带有集成网络摄像头，另一台带有旧的 USB 网络摄像头。它需要预先安装和配置 JMF，但是一旦完成，您就可以相当轻松地通过 Java 代码访问硬件。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-18T15:48:25.717

你可以试试[Marvin 框架](http://marvinproject.sourceforge.net)。它提供了一个使用相机的界面。此外，它还提供了一组实时视频处理功能，如对象跟踪和过滤。

看一看！

实时视频处理演示：
[http ://www.youtube.com/watch?v=D5mBt0kRYvk](http://www.youtube.com/watch?v=D5mBt0kRYvk)

您可以使用以下来源。只需每 5 秒使用**MarvinImageIO.saveImage()**保存一帧。

**网络摄像头视频演示：**

```
public class SimpleVideoTest extends JFrame implements Runnable{

    private MarvinVideoInterface    videoAdapter;
    private MarvinImage             image;
    private MarvinImagePanel        videoPanel;

    public SimpleVideoTest(){
        super("Simple Video Test");
        videoAdapter = new MarvinJavaCVAdapter();
        videoAdapter.connect(0);
        videoPanel = new MarvinImagePanel();
        add(videoPanel);
        new Thread(this).start();
        setSize(800,600);
        setVisible(true);
    }
    @Override
    public void run() {
        while(true){
            // Request a video frame and set into the VideoPanel
            image = videoAdapter.getFrame();
            videoPanel.setImage(image);
        }
    }
    public static void main(String[] args) {
        SimpleVideoTest t = new SimpleVideoTest();
        t.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

对于那些只想拍一张照片的人：

**网络摄像头图片.java**

```
public class WebcamPicture {
    public static void main(String[] args) {
        try{
            MarvinVideoInterface videoAdapter = new MarvinJavaCVAdapter();
            videoAdapter.connect(0);
            MarvinImage image = videoAdapter.getFrame();
            MarvinImageIO.saveImage(image, "./res/webcam_picture.jpg");
        } catch(MarvinVideoInterfaceException e){
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-09-10T20:38:19.240

# 我使用了 Webcam Capture API...你可以从这个[http://webcam-capture.sarxos.pl/下载](http://webcam-capture.sarxos.pl/)

```
 webcam = Webcam.getDefault();
        webcam.open();

        if (webcam.isOpen()) { //if web cam open 
            BufferedImage image = webcam.getImage();
            JLabel imageLbl = new JLabel();
            imageLbl.setSize(640, 480);             //show captured image
            imageLbl.setIcon(new ImageIcon(image));

            int showConfirmDialog = JOptionPane.showConfirmDialog(null, imageLbl, "Image Viewer", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, new ImageIcon(""));

            if (showConfirmDialog == JOptionPane.YES_OPTION) {
                JFileChooser chooser = new JFileChooser();
                chooser.setDialogTitle("Save Image");
                chooser.setFileFilter(new FileNameExtensionFilter("IMAGES ONLY", "png", "jpeg", "jpg")); //this file extentions are shown
                int showSaveDialog = chooser.showSaveDialog(this);
                if (showSaveDialog == 0) {                  //if pressed 'Save' button
                    String filePath = chooser.getCurrentDirectory().toString().replace("\\", "/");
                    String fileName = chooser.getSelectedFile().getName(); //get user entered file name to save
                    ImageIO.write(image, "PNG", new File(filePath + "/" + fileName + ".png"));

                }
            }
        } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-09T18:19:25.730

[http://grack.com/downloads/school/enel619.10/report/java_media_framework.html](http://grack.com/downloads/school/enel619.10/report/java_media_framework.html)

将播放器与 Swing 一起使用

Player 也可以在 Swing 应用程序中轻松使用。以下代码创建了一个基于 Swing 的电视捕捉程序，视频输出显示在整个窗口中：

```
import javax.media.*;
import javax.swing.*;
import java.awt.*;
import java.net.*;
import java.awt.event.*;
import javax.swing.event.*;

public class JMFTest extends JFrame {
    Player _player;
    JMFTest() {
        addWindowListener( new WindowAdapter() {
            public void windowClosing( WindowEvent e ) {
                _player.stop();
                _player.deallocate();
                _player.close();
                System.exit( 0 );
            }
        });
          setExtent( 0, 0, 320, 260 );
        JPanel panel = (JPanel)getContentPane();
        panel.setLayout( new BorderLayout() );
        String mediaFile = "vfw://1";
        try {
            MediaLocator mlr = new MediaLocator( mediaFile );
            _player = Manager.createRealizedPlayer( mlr );
            if (_player.getVisualComponent() != null)
            panel.add("Center", _player.getVisualComponent());
            if (_player.getControlPanelComponent() != null)
            panel.add("South", _player.getControlPanelComponent());
        }
        catch (Exception e) {
            System.err.println( "Got exception " + e );
        }
    }

    public static void main(String[] args) {
        JMFTest jmfTest = new JMFTest();
        jmfTest.show();
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-10T17:52:03.413

Java 通常不喜欢访问硬件，因此您需要某种驱动程序，正如 Goldenmean 所说。我已经在我的笔记本电脑上通过找到一个拍摄图片的命令行程序来完成此操作。然后和goldmean解释的一样；您在 takepicture() 例程中从您的 java 程序运行命令行程序，其余代码运行相同。

除了关于将像素值读取到数组中的部分之外，最好将文件保存为 BMP，这已经接近这种格式，然后使用标准的 java 图像库。

使用命令行程序会增加对程序的依赖并降低其可移植性，但网络摄像头也是如此，对吧？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-09T03:20:46.597

尝试使用 JMyron[如何使用 Java 使用网络摄像头](http://howto-java.blogspot.com/2012/05/how-to-use-webcam-using-java.html)。我认为使用 JMyron 是使用 java 访问网络摄像头的最简单方法。我尝试将它与 64 位处理器一起使用，但它给了我一个错误。不过，它在 32 位处理器上运行良好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-10T00:41:18.093

我相信网络摄像头附带的网络摄像头应用软件，或者你的原生Windows网络摄像头软件可以在打开网络摄像头后以批处理脚本（windows / dos脚本）运行（即如果它需要外部电源供应）。在 bacth 脚本中，您可以添加适当的延迟以在特定时间段后捕获。并继续循环执行捕获命令。

我想这应该是可能的

-广告

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-05T13:52:08.660

推荐使用 FMJ 进行多媒体相关的 java 应用程序。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-27T14:51:35.197

FMJ 可以做到这一点，它使用的支持库 LTI-CIVIL 也可以。两者都在 sourceforge 上。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-10T18:39:40.820

[在processing](http://processing.org)中有一个非常好的接口，这是一种为图形设计的[pidgin](http://www.flight404.com/_videos/pigeonCam.mov) java。它被用于一些图像识别工作，例如那个链接。

根据您的需要，您可能能够加载在 java 中使用的视频库，或者如果您只是在玩它，您可能可以通过使用处理本身来获得。

# php - Symfony 是否有 OpenID 2.0 插件？

> ID：276310
> 
> 赞同：9
> 
> 时间：2008-11-09T18:56:21.257
> 
> 标签：php, symfony1, openid

我正在为 Symfony 使用 sfOpenID 插件，它不支持 OpenID 2.0。这意味着，例如，人们使用 Yahoo! OpenID 无法登录我的网站。

有一个可与 sfGuard 配合使用的 OpenID 2.0 插件，但我不使用也不打算使用 sfGuard。另外，它还需要安装 Zend 框架，这在我的场景中是多余的。

所以我有两个问题，真的：

*   Symfony 是否有另一个支持 OpenID 2.0 的 OpenID 插件？
*   使 sfOpenID 支持 OpenID 2.0 所需的 hack 是什么？

我想我可以研究 OpenID 规范并自己破解它，但是，我是一个懒惰的程序员 :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T19:21:46.070

我认为您已经使用 sfOpenID 和 taOpenIDsfGuardPlugin 为 Symfony 的插件提供了所有选项。

但是，如果不详细研究 OpenID 的规范，您可以通过将其中一个 PHP 库 ( [http://wiki.openid.net/Libraries](http://wiki.openid.net/Libraries) ) 放入您的 lib 并连接到 a`sfUser`或您用于身份验证的任何内容来尝试其中一个。还有 OpenID Enabled 库 ( [http://openidenabled.com/php-openid/ )，如果您](http://openidenabled.com/php-openid/)[调整错误报告级别](http://www.php.net/manual/en/errorfunc.configuration.php)以排除一些警告，它仍然使用 PHP4，但与 PHP5 兼容。

有一些教程解释了如何使用 PHP 在您的站点上启用 OpenID：http: [//www.saeven.net/openid.htm](http://www.saeven.net/openid.htm)或[http://www.plaxo.com/api/openid_recipe](http://www.plaxo.com/api/openid_recipe)。

更好的是，之后利用这些知识[制作一个 sfPlugin](http://www.symfony-project.org/book/1_1/17-Extending-Symfony#How%20to%20Write%20a%20Plug-In)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T23:35:15.457

有一个更简单的方法。JanRain 提供 OpenID（和 facebook）作为服务[http://rpxnow.com](http://rpxnow.com)。比使用库本地化更容易/更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T13:11:43.313

我有（而且我仍然有）同样的问题。首先，没有任何功能完整的 php5 openid 库。唯一的一个被 Zend Framework 附带的那个放弃了。

因此，您要么自己编写（不推荐，大量工作），要么使用 Zend 中的那个（这就是我使用的）。

问题是它被大量嵌入到 Zend 中并且需要很多 ZF 的东西。

也许我会发布一个类似于 taOpenIDsfGuardPlugin 但在没有 sfGuard 的情况下使用的插件，因为它经常被要求（并且我将在我未来的项目中需要它；））

# c# - 从 C# 中的多个内存文件创建 Zip 存档

> ID：276319
> 
> 赞同：33
> 
> 时间：2008-11-09T19:04:00.117
> 
> 标签：c#, compression, zip

当文件当前在内存中时，有没有办法创建包含多个文件的 Zip 存档？我要保存的文件实际上只是文本，并且存储在我的应用程序的字符串类中。但我想将多个文件保存在一个独立的存档中。它们都可以位于存档的根目录中。

如果能够使用 SharpZipLib 做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-09T19:24:54.817

使用`ZipEntry`和`PutNextEntry()`。下面显示了如何对文件执行此操作，但对于内存对象只需使用 MemoryStream

```
FileStream fZip = File.Create(compressedOutputFile);
ZipOutputStream zipOStream = new ZipOutputStream(fZip);
foreach (FileInfo fi in allfiles)
{
    ZipEntry entry = new ZipEntry((fi.Name));
    zipOStream.PutNextEntry(entry);
    FileStream fs = File.OpenRead(fi.FullName);
    try
    {
        byte[] transferBuffer[1024];
        do
        {
            bytesRead = fs.Read(transferBuffer, 0, transferBuffer.Length);
            zipOStream.Write(transferBuffer, 0, bytesRead);
        }
        while (bytesRead > 0);
    }
    finally
    {
        fs.Close();
    }
}
zipOStream.Finish();
zipOStream.Close(); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-21T03:44:34.110

为此使用 SharpZipLib 似乎相当复杂。这在[DotNetZip](http://www.codeplex.com/DotNetZip)中要容易得多。在 v1.9 中，代码如下所示：

```
using (ZipFile zip = new ZipFile())
{
    zip.AddEntry("Readme.txt", stringContent1);
    zip.AddEntry("readings/Data.csv", stringContent2);
    zip.AddEntry("readings/Index.xml", stringContent3);
    zip.Save("Archive1.zip"); 
} 
```

上面的代码假定 stringContent{1,2,3} 包含要存储在 zip 存档中的文件（或条目）中的数据。第一个条目是“Readme.txt”，它存储在 zip 存档的顶级“目录”中。接下来的两个条目存储在 zip 存档的“读数”目录中。

字符串以默认编码进行编码。AddEntry() 有一个重载，此处未显示，它允许您显式指定要使用的编码。

如果您在流或字节数组中包含内容，而不是字符串，则 AddEntry() 有接受这些类型的重载。还有一些接受 Write 委托的重载，这是一种您的方法，被调用以将数据写入 zip。例如，这适用于轻松地将 DataSet 保存到 zip 文件中。

DotNetZip 是免费和开源的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-07-12T20:40:39.157

这个函数应该从数据流中创建一个字节数组：为了简单起见，我创建了一个简单的接口来处理文件

```
public interface IHasDocumentProperties
{
    byte[] Content { get; set; }
    string Name { get; set; }
}

public void CreateZipFileContent(string filePath, IEnumerable<IHasDocumentProperties> fileInfos)
{    
    using (var memoryStream = new MemoryStream())
    {
        using (var zipArchive = new ZipArchive(memoryStream, ZipArchiveMode.Create, true))
        {
            foreach(var fileInfo in fileInfos)
            {
                var entry = zipArchive.CreateEntry(fileInfo.Name);

                using (var entryStream = entry.Open())
                {
                    entryStream.Write(fileInfo.Content, 0, fileInfo.Content.Length);
                }                        
            }
        }

        using (var fileStream = new FileStream(filePath, FileMode.OpenOrCreate, System.IO.FileAccess.Write))
        {
            memoryStream.Position = 0;
            memoryStream.CopyTo(fileStream);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-09T19:17:08.233

是的，您可以使用 SharpZipLib 来执行此操作 - 当您需要提供要写入的流时，请使用`MemoryStream`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-10-07T15:24:20.863

我遇到了这个问题，使用我创建的这个类的 MSDN 示例：

```
using System;  
using System.Collections.Generic;  
using System.Linq;  
using System.Text;  
using System.IO.Packaging;  
using System.IO;  

public class ZipSticle  
{  
    Package package;  

    public ZipSticle(Stream s)  
    {  
        package = ZipPackage.Open(s, FileMode.Create);  
    }  

    public void Add(Stream stream, string Name)  
    {  
        Uri partUriDocument = PackUriHelper.CreatePartUri(new Uri(Name, UriKind.Relative));  
        PackagePart packagePartDocument = package.CreatePart(partUriDocument, "");  

        CopyStream(stream, packagePartDocument.GetStream());  
        stream.Close();  
    }  

    private static void CopyStream(Stream source, Stream target)  
    {  
        const int bufSize = 0x1000;  
        byte[] buf = new byte[bufSize];  
        int bytesRead = 0;  
        while ((bytesRead = source.Read(buf, 0, bufSize)) > 0)  
            target.Write(buf, 0, bytesRead);  
    }  

    public void Close()  
    {  
        package.Close();  
    }  
} 
```

然后你可以像这样使用它：

```
FileStream str = File.Open("MyAwesomeZip.zip", FileMode.Create);  
ZipSticle zip = new ZipSticle(str);  

zip.Add(File.OpenRead("C:/Users/C0BRA/SimpleFile.txt"), "Some directory/SimpleFile.txt");  
zip.Add(File.OpenRead("C:/Users/C0BRA/Hurp.derp"), "hurp.Derp");  

zip.Close();
str.Close(); 
```

您可以将 a `MemoryStream`（或任何`Stream`）传递给`ZipSticle.Add`例如：

```
FileStream str = File.Open("MyAwesomeZip.zip", FileMode.Create);  
ZipSticle zip = new ZipSticle(str);  

byte[] fileinmem = new byte[1000];
// Do stuff to FileInMemory
MemoryStream memstr = new MemoryStream(fileinmem);
zip.Add(memstr, "Some directory/SimpleFile.txt");

memstr.Close();
zip.Close();
str.Close(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T20:08:50.750

*请注意，此答案已过时；从 .Net 4.5 开始，`ZipArchive`该类允许在内存中压缩文件。有关如何使用它，请参阅[下面的 johnny 5 的答案。](https://stackoverflow.com/a/45067125/9536)*

* * *

你也可以做一些不同的事情，使用 Serializable 对象来存储所有字符串

```
[Serializable]
public class MyStrings {
    public string Foo { get; set; }
    public string Bar { get; set; }
} 
```

然后，您可以将其序列化为流以保存它。
为了节省空间，您可以使用 GZipStream (From System.IO.Compression) 来压缩它。（注意：GZip 是流压缩，而不是多个文件的存档）。

也就是说，当然，如果您实际上需要的是保存数据，而不是压缩一些特定格式的文件以供其他软件使用。此外，这将允许您保存除字符串之外的更多类型的数据。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-20T14:31:21.547

我通过添加s 作为不同 Excel 文件的源来利用[Cheeso 的答案。](https://stackoverflow.com/a/384068/1195056)`MemoryStream`当我下载 zip 时，文件中没有任何内容。这可能是我们试图通过 AJAX 创建和下载文件的方式。

为了将不同 Excel 文件的内容包含在 Zip 中，我必须将每个文件添加为`byte[]`.

```
using (var memoryStream = new MemoryStream())
using (var zip = new ZipFile())
{
    zip.AddEntry("Excel File 1.xlsx", excelFileStream1.ToArray());
    zip.AddEntry("Excel File 2.xlsx", excelFileStream2.ToArray());

    // Keep the file off of disk, and in memory.
    zip.Save(memoryStream);
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-09T19:20:36.120

使用[StringReader](http://msdn.microsoft.com/en-us/library/system.io.stringreader.aspx)从您的字符串对象中读取并将它们公开为 Stream s。

这应该可以轻松地将它们提供给您的邮政编码。

# css - css水平导航间距

> ID：276324
> 
> 赞同：26
> 
> 时间：2008-11-09T19:10:56.560
> 
> 标签：css, navigation

我正在尝试用 5 个均匀分布的链接在 CSS 中创建一个水平导航栏。html 希望将保持这样的状态：

```
<div id="footer">
    <ul>
        <li><a href="one.html">One</a></li>
        <li><a href="two.html">Two</a></li>
        <li><a href="three.html">Three</a></li>
        <li><a href="four.html">Four</a></li>
        <li><a href="five.html">Five</a></li>
    </ul>
</div> 
```

因此，对于 CSS，我想将它们均匀地分布在页脚 div 中。到目前为止，我正在使用这个：

```
div#footer{
    height:1.5em;
    background-color:green;
    clear:both;
    padding-top:.5em;
    font-size:1.5em;
    width:800px;
}
div#footer ul{
    margin:0;
    padding:0;
    list-style:none;
}
div#footer li{
    width:155px;
    display:inline-block;
    text-align:center;
} 
```

这工作得很好，但是我不想要的 li 之间有间距。这就是为什么我使用 155px 而不是 160px 作为宽度的原因，每个 li 之间有大约 5px 的空间。这个间距是从哪里来的？我怎样才能摆脱它？如果我增加字体大小，间距也会增加。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-09T19:22:36.257

我曾经发生过这种情况。不幸的是，这是由浏览器在列表项之间换行并将它们呈现为空格引起的。要修复，请将您的 HTML 更改为：

```
<div id="footer">
  <ul>
    <li><a href="one.html">One</a></li><li><a href="two.html">Two</a></li><li><a href="three.html">Three</a></li><li><a href="four.html">Four</a></li><li><a href="five.html">Five</a></li>
  </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-09T19:17:56.937

如果你使用这个：

```
div#footer li{
  width:160px;
  display:block;
  float: left;
  text-align:center;
} 
```

一切看起来都很可爱：D

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T19:29:34.807

由于内联样式，元素之间的`<li>`空格是由于它们之间的空格和回车所致。如果你写：

```
<li><a href="one.html">One</a></li><li><a href="two.html">Two</a></li><li><a href="three.html">Three</a></li><li><a href="four.html">Four</a></li><li><a href="five.html">Five</a></li> 
```

你会看到它们之间没有更多的空间。

我不确定 inline-block 是否会在 IE6 上很好地显示，所以您可能想尝试浮动方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-03T10:13:38.910

这已经被 CSS flexbox 完全解决了。

CSS-Tricks 在这里有一个很好[的](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)文章，还有一个 Codepen 示例`<ul>` [在这里](http://codepen.io/HugoGiraudel/pen/LklCv)使用。

```
.flex-container {
  padding: 0;
  margin: 0;
  list-style: none;

  display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;

  -webkit-flex-flow: row nowrap;
  justify-content: space-around;
}

.flex-item {
  background: tomato;
  padding: 5px;
  margin: 0px;

  line-height: 40px;
  color: white;
  font-weight: bold;
  font-size: 2em;
  text-align: center;
  flex: 1 1 auto;
}
```

```
<ul class="flex-container">
  <li class="flex-item">1</li>
  <li class="flex-item">2</li>
  <li class="flex-item">3</li>
  <li class="flex-item">4</li>
  <li class="flex-item">5</li>
  <li class="flex-item">6</li>
</ul>
```

我意识到这已经很老了，但我在 7 年后的 2015 年遇到了这个问题，所以这可能对其他人也有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T12:00:37.793

```
div#footer ul{
    margin:0;
    padding:0;
    list-style:none;
}

div#footer li{
    width:155px;
    float:left;
    display:block;        
} 
```

此代码水平定位 li 而它们之间的空间。如果要在 li 元素之间添加空格：

```
div#footer li{
    width:155px;
    margin-right: 5px; //5px Space between li elements 
    float:left;
    display:block;        
} 
```

# mediawiki - 将 Sandcastle 帮助文件生成器输出（网站）转换为 MediaWiki 格式

> ID：276334
> 
> 赞同：6
> 
> 时间：2008-11-09T19:19:07.387
> 
> 标签：mediawiki, sandcastle, shfb

我需要

1.  将作为网站 (HTML) 的 Sandcastle 帮助文件生成器 (SHFB) 输出转换为媒体 wiki 格式
2.  找到一种方法将转换后的页面直接传输/包含到我们设置的 MediaWiki 中。

有任何想法吗？我们在网站上有超过 1000 页的 HTML 文件（SHFB 的输出）。

我想过使用 html2wiki 转换器..我可以考虑寻找一个脚本来将这 1000 个页面转换为 wiki 格式......这可以解决 (1)。

但是我仍然会在管道的最后一位中留下块 - 如何将转换后的页面直接输入 Wiki？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-05T13:53:14.163

看看帮助服务器。它允许在网络上发布由任何工具（包括 Sandcastle）生成的 .CHM / .HxS 并提供[基于 URL 的集成 API](http://help.x-tensive.com/)。

我们也使用 MediaWiki。[它的一组模板](http://wiki.dataobjects.net/index.php?title=Code_templates)允许我们创建指向帮助服务器共享的类引用的链接。可以在该页面上找到此类链接的一些示例。

请注意，[DataObjects.Net 帮助](http://help.dataobjects.net/)网站在帮助服务器 2.X 上运行，但最新的是 3.X（[示例网站在这里](http://help.x-tensive.com/)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T04:00:49.127

我做了一些工作，将几个站点的现有材料提取到一个全面的 Wiki 中。它不涉及 Sandcastle，但如果您正在处理 HTML，它应该无关紧要。**html2wiki**扩展就在那里，根据我的阅读，它们可以解决很多问题。我需要对 DOM 中的每个节点进行更多控制，因此我使用了[Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)。它在 PHP 中，很容易被放入 Mediawiki 的包含中。

为了创建新页面，我最终编写了一个使用 Mediawiki 的 Article 类的小脚本，特别是[doEdit 函数](http://svn.wikimedia.org/doc/classArticle.html#44882bb1533f07bf67baca3e65821bb3)。这允许您以编程方式创建新文章，而无需用户交互。当然，你要小心这个......你需要做的最后一件事是创建 1000 个不好的页面，并且必须删除。但也许这会帮助你继续前进。

# c# - 在gridview控件上过滤VS-2008

> ID：276336
> 
> 赞同：0
> 
> 时间：2008-11-09T19:20:36.213
> 
> 标签：c#, asp.net

这就是我正在努力回到网络开发世界的原因

ASP.Net 与 VS2008

亚音速作为数据访问层

SqlServer 数据库

首页 项目描述：我有一个学生注册系统。我有一个应该显示学生记录的网页。

目前我有一个显示记录的gridview控件

用户登录并进入查看学生页面。网格视图显示系统中的学生，其中一列是开放、待定、完成的注册状态。

我希望用户能够对返回的结果应用动态排序或过滤器，以获得他们希望看到的更精细的结果。我设想允许用户通过亚音速方法通过数据集接口对返回的结果应用 where 子句或 like 子句来过滤结果。我不想再次查询数据库以应用过滤器

示例：初始查询

```
Select * from studentrecords where date = convert(varchar(32,getdate(),101) 
```

然后，用户应该能够对返回的结果集应用过滤器，以便他们可以使用姓氏，例如 '%Souza%'

这甚至可能吗？将数据源绑定到gridview控件是最好的方法，还是我应该创建一个从collectionbase继承的自定义集合，然后将其绑定到gridview控件？

PS：抱歉打错字了。我的机器受到笔记本电脑上茶水的影响

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T19:43:20.083

我使用 LINQ-to-SQL，而不是 Subsonic，所以使用 YMMV，但我的过滤方法是为数据源提供 OnSelecting 处理程序。在 LINQ-to-SQL 中，我可以将结果替换为对 DataContext 方法的引用，该方法返回应用表值函数的结果。您可能想用 Subsonic 调查类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T20:10:30.043

正如 tvanfosson 所说，LINQ 非常适合进行可组合查询；您可以使用基础库生成的完全标准的 TSQL 或通过在数据上下文中使用 [FunctionAttribute(..., IsComposable=true)] 标记的 UDF 来执行此操作。

我不熟悉 Subsonic，所以我不能在那里提供建议；但另一个想法：在您的“date =”代码中，您可能会考虑声明一个日期时间变量并首先分配它......这样优化器通常可以更好地优化它（查询更简单，并且没有质疑它是将日期时间（每行）转换为 varchar，还是将 varchar 转换为日期时间）。获取日期部分的最有效方法是cast/floor/cast：

```
SET @today = GETDATE()
SET @today = CAST(FLOOR(CAST(@today as float)) as datetime) 
```

[更新重新评论]

可组合 - 我的意思是这允许您构建一个查询，以便仅在数据库中执行*最终*查询。例如：

```
var query = from row in ctx.SomeComplexUdf(someArg)
            where row.IsOpen && row.Value > 0
            select row; 
```

可能会通过 TSQL 关闭服务器：

```
SELECT u1.*
FROM dbo.SomeComplexUdf(@p1) u1
WHERE u1.IsOpen = 1 -- might end up parameterized
AND u1.Value > 0 -- might end up parameterized 
```

这里的重点是服务器只返回合适的数据，而不是返回大量数据，然后丢弃。LINQ-to-SQL 可以通过可组合查询执行各种操作，包括分页、排序等。通过最大限度地减少从数据库加载的数据量，您可以显着提高性能。

没有可组合性的替代方案是它只是：

```
SELECT u1.*
FROM dbo.SomeComplexUdf(@p1) u1 
```

然后丢弃您的网络应用程序中的其他行......显然，如果您期望 20 个打开的记录和 10000 个关闭的记录，这是一个巨大的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T17:12:35.537

How about something like this?

Rather than assigning a data source / table to your grid control, instead attach a 'DataView' to it.

Here's sort of a pseudocode example:

```
DataTable myDataTable = GetDataTableFromSomewhere();    
DataGridView dgv = new DataGridView();
DataView dv = new DataView(myDataTable);

//Then you can specify things like:
dv.Sort = "StudentStatus DESC";
dv.Filter = "StudentName LIKE '" + searchName + '";
dgv.DataSource = dv; 
```

...and so on.

# php - 有没有类似字符串翻译数据库的东西？

> ID：276342
> 
> 赞同：1
> 
> 时间：2008-11-09T19:23:01.577
> 
> 标签：php, localization, translation

我正在寻找一个带有翻译的数据库，这样我就可以使用机器而不是昂贵的翻译器翻译常用的短语和单词。有没有单词和常用短语的翻译数据库之类的东西？

如果你不知道，你会使用这样的服务吗？

编辑：数据库应该只由人监控，而不是一些自动翻译器，因为它们往往非常糟糕

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T19:43:04.593

> 编辑：数据库应该只由人监控，而不是一些自动翻译器，因为它们往往非常糟糕

我认为这还不够。如果您要翻译单个单词，您需要对使用该单词的上下文有所了解。

例如，考虑英文单词“row”

这是否意味着 1\. 一系列事情 2\. 争论 3\. 用桨划船 4\. 一片哗然 5\. 几件事情接连发生（“他们连续四年赢了”）

这些可能有非常不同的翻译。

所以相反，保留一个多语言词汇表可能是值得的，您可以在其中记录术语的定义及其所有您关心的语言的翻译，但我认为您需要专业的翻译人员才能正确翻译，并且“查找”将始终需要手动进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:19:20.250

检查：[open-tran.eu](http://open-tran.eu/)。它是一个来自各种开源项目的翻译数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T19:29:37.193

[http://www.google.com/language_tools](http://www.google.com/language_tools)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T13:58:32.650

那么你想要的是数据库短语手册吗？你要那个干什么？您不能使用短语手册来翻译书籍或软件等。您也不能使用机器翻译，即使它是一个有用的工具。您必须使用非常了解源语言和目标语言的人工翻译，最好是双语人员。

短语手册唯一有用的就是问路。并且不明白答案... ;)

# python - 每当我将 Python 代码放入 Django 模板时都会出现语法错误

> ID：276345
> 
> 赞同：3
> 
> 时间：2008-11-09T19:24:41.493
> 
> 标签：python, django, templates, django-templates

我正在尝试在我的 Django 模板中执行以下操作：

```
 {% for embed in embeds %}
           {% embed2 = embed.replace("&lt;", "<") %}
           {{embed2}}<br />
    {% endfor %} 
```

但是，当我执行类似的操作时（我的意思是循环内的 {% %} 代码），我总是会得到一个无效的块或一些语法错误。Python 没有 {} 来表示“范围”，所以我认为这可能是我的问题？我的代码格式错误吗？

编辑：确切的错误是：`Invalid block tag: 'embed2'`

Edit2：由于有人说 Django 模板不支持我正在做的事情，所以我重写了代码，将逻辑放在视图中。我现在有：

```
embed_list = []
for embed in embeds:
    embed_list[len(embed_list):] = [embed.replace("&lt;", "<")] #this is line 35
return render_to_response("scanvideos.html", {
    "embed_list" :embed_list
}) 
```

但是，我现在收到一个错误：`'NoneType' object is not callable" on line 35`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T19:44:06.090

我很确定 Django 模板不支持这一点。对于您的替换操作，我会研究不同的过滤器。

你真的应该尽量在视图中而不是在模板中保留尽可能多的逻辑。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-10T01:25:36.913

Django 的模板语言是故意蹩脚的。当被非编程设计师使用时，这绝对是一件好事，但有时你*需要*做一点编程。（不，我不想为此争论。这在 django-users 和 django-dev 上已经出现了好几次。）

两种方法来完成你正在尝试的事情：

*   使用不同的模板引擎。有关与 Django 集成的完整说明，请参见[Jinja2 。](http://jinja.pocoo.org/2/)
*   使用允许您执行 Python 表达式的模板标签。请参阅[limodou 的 Expr 标签](http://www.djangosnippets.org/snippets/9/)。

我在几个地方使用了 expr 标签，它让生活*变得*更加轻松。我的下一个主要 Django 站点将使用 jinja2。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T20:04:59.947

我不明白为什么你会得到“NoneType object is not callable”。这应该意味着该行的某处是像“foo(...)”这样的表达式，这意味着 foo 是 None。

顺便说一句：您正在尝试扩展 embed_list，这样做更容易：

```
embed_list = []
for embed in embeds:
    embed_list.append(embed.replace("&lt;", "<")) #this is line 35
return render_to_response("scanvideos.html", {"embed_list":embed_list}) 
```

甚至更容易使用列表推导：

```
embed_list = [embed.replace("&lt;", "<") for embed in embeds] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T19:58:50.787

Django 模板使用自己的语法，不像[Kid](http://en.wikipedia.org/wiki/Kid_%28templating_language%29)或[Genshi](http://en.wikipedia.org/wiki/Genshi_%28templating_language%29)。

您必须滚动您自己的[自定义模板标签](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/)。

我想主要原因是执行良好的做法。就我而言，我已经很难向我们团队的设计师解释这些特殊的模板标签。如果是纯 Python，我敢肯定我们根本不会选择 Django。我认为还有一个性能问题，Django 模板基准测试很快，而我上次检查 genshi 时要慢得多。不过，我不知道这是否是由于免费嵌入了 Python。

您要么需要检查您的方法并编写自己的自定义模板（或多或少是 Ruby on Rails 中“助手”的同义词），要么尝试使用其他模板引擎。

对于您的编辑，Python 中有更好的语法：

```
embed_list.append(embed.replace("&lt;", "<")) 
```

我不知道它是否能解决你的错误，但至少它不像 JavaScriptesque ;-)

编辑 2：Django 自动转义所有变量。您可以使用 |safe filter : 强制执行原始 HTML `{{embed|safe}}`。

您最好花一些时间阅读文档，这真的很棒而且很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-09T20:04:55.097

而不是使用切片分配来增长列表

`embed_list[len(embed_list):] = [foo]`

你可能应该这样做

`embed_list.append(foo)`

但实际上，您应该尝试使用库函数对 html 进行转义，而不是自己动手。

NoneType 错误在某些时候听起来像 embed.replace 是 None ，这仅在您的列表不是字符串列表时才有意义 - 您可能需要使用一些断言或类似的东西仔细检查。

# asp.net - 我可以从 HTTPModule 访问会话状态吗？

> ID：276355
> 
> 赞同：87
> 
> 时间：2008-11-09T19:31:11.717
> 
> 标签：asp.net, session-state, httpmodule

我真的可以从我的 HTTPModule 中更新用户的会话变量，但据我所见，这是不可能的。

*更新：*我的代码当前正在`OnBeginRequest ()`事件处理程序中运行。

*更新：*根据目前收到的建议，我尝试将其添加到`Init ()`我的 HTTPModule 中的例程中：

`AddHandler context.PreRequestHandlerExecute, AddressOf OnPreRequestHandlerExecute`

但是在我的`OnPreRequestHandlerExecute`例程中，会话状态仍然不可用！

谢谢，如果我遗漏了什么，我们深表歉意！

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-11-09T19:44:25.963

在[ASP.NET 论坛](http://forums.asp.net/p/1098574/1665773.aspx)上找到了这个：

```
using System;
using System.Web;
using System.Web.Security;
using System.Web.SessionState;
using System.Diagnostics;

// This code demonstrates how to make session state available in HttpModule,
// regardless of requested resource.
// author: Tomasz Jastrzebski

public class MyHttpModule : IHttpModule
{
   public void Init(HttpApplication application)
   {
      application.PostAcquireRequestState += new EventHandler(Application_PostAcquireRequestState);
      application.PostMapRequestHandler += new EventHandler(Application_PostMapRequestHandler);
   }

   void Application_PostMapRequestHandler(object source, EventArgs e)
   {
      HttpApplication app = (HttpApplication)source;

      if (app.Context.Handler is IReadOnlySessionState || app.Context.Handler is IRequiresSessionState) {
         // no need to replace the current handler
         return;
      }

      // swap the current handler
      app.Context.Handler = new MyHttpHandler(app.Context.Handler);
   }

   void Application_PostAcquireRequestState(object source, EventArgs e)
   {
      HttpApplication app = (HttpApplication)source;

      MyHttpHandler resourceHttpHandler = HttpContext.Current.Handler as MyHttpHandler;

      if (resourceHttpHandler != null) {
         // set the original handler back
         HttpContext.Current.Handler = resourceHttpHandler.OriginalHandler;
      }

      // -> at this point session state should be available

      Debug.Assert(app.Session != null, "it did not work :(");
   }

   public void Dispose()
   {

   }

   // a temp handler used to force the SessionStateModule to load session state
   public class MyHttpHandler : IHttpHandler, IRequiresSessionState
   {
      internal readonly IHttpHandler OriginalHandler;

      public MyHttpHandler(IHttpHandler originalHandler)
      {
         OriginalHandler = originalHandler;
      }

      public void ProcessRequest(HttpContext context)
      {
         // do not worry, ProcessRequest() will not be called, but let's be safe
         throw new InvalidOperationException("MyHttpHandler cannot process requests.");
      }

      public bool IsReusable
      {
         // IsReusable must be set to false since class has a member!
         get { return false; }
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-09T19:35:52.890

[HttpContext.Current.Session](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.session.aspx)应该可以正常工作，假设您的 HTTP 模块没有处理在会话状态初始化之前发生的任何[管道事件......](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

编辑，在注释中澄清后：在处理[BeginRequest 事件](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.beginrequest.aspx)时，Session 对象确实仍然是 null/Nothing，因为它还没有被 ASP.NET 运行时初始化。要解决此问题，请将您的处理代码移至[PostAcquireRequestState](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.postacquirerequeststate.aspx)之后发生的事件——我自己喜欢[PreRequestHandlerExecute](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.prerequesthandlerexecute.aspx)，因为所有低级工作都在此阶段完成，但您仍然抢占任何正常处理。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-09-13T10:56:31.533

访问`HttpContext.Current.Session`in a`IHttpModule`可以在`PreRequestHandlerExecute`处理程序中完成。

**PreRequestHandlerExecute**：“发生在 ASP.NET 开始执行事件处理程序（例如，页面或 XML Web 服务）之前。” 这意味着在提供“aspx”页面之前，会执行此事件。“会话状态”可用，因此您可以将自己击倒。

例子：

```
public class SessionModule : IHttpModule 
    {
        public void Init(HttpApplication context)
        {
            context.BeginRequest += BeginTransaction;
            context.EndRequest += CommitAndCloseSession;
            context.PreRequestHandlerExecute += PreRequestHandlerExecute;
        }

        public void Dispose() { }

        public void PreRequestHandlerExecute(object sender, EventArgs e)
        {
            var context = ((HttpApplication)sender).Context;
            context.Session["some_sesion"] = new SomeObject();
        }
...
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-02T21:15:14.410

如果您在托管应用程序中编写一个普通的、基本的 HttpModule 并希望通过页面或处理程序应用于 asp.net 请求，您只需确保在会话创建后使用生命周期中的事件。PreRequestHandlerExecute 而不是 Begin_Request 通常是我去的地方。mdb 在他的编辑中有它。

最初列为回答问题的较长代码片段有效，但比最初的问题更复杂和更广泛。当内容来自没有可用的 ASP.net 处理程序时，它将处理这种情况，您可以在其中实现 IRequiresSessionState 接口，从而触发会话机制使其可用。（就像磁盘上的静态 gif 文件一样）。它基本上是设置一个虚拟处理程序，然后只实现该接口以使会话可用。

如果您只想要代码的会话，只需在模块中选择要处理的正确事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-18T18:16:10.767

试试看：在 MyHttpModule 类中声明：

```
private HttpApplication contextapp; 
```

然后：

```
public void Init(HttpApplication application)
{
     //Must be after AcquireRequestState - the session exist after RequestState
     application.PostAcquireRequestState += new EventHandler(MyNewEvent);
     this.contextapp=application;
} 
```

因此，在同一类的另一个方法（事件）中：

```
public void MyNewEvent(object sender, EventArgs e)
{
    //A example...
    if(contextoapp.Context.Session != null)
    {
       this.contextapp.Context.Session.Timeout=30;
       System.Diagnostics.Debug.WriteLine("Timeout changed");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-07T19:59:22.760

由于 .NET 4.0 没有必要使用 IHttpHandler 来加载会话状态（就像最受好评的答案中的一个）。有一个方法[HttpContext.SetSessionStateBehavior](https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcontext.setsessionstatebehavior)来定义所需的会话行为。如果在 web.config HttpModule 声明中设置为 true 的所有请求都需要 Session ，但请注意，为所有请求运行所有模块会产生巨大的性能成本，因此如果您不需要所有请求的 Session，请`runAllManagedModulesForAllRequests`务必使用。`preCondition="managedHandler"`对于未来的读者，这里有一个完整的例子：

web.config 声明 - 为所有请求调用 HttpModule：

```
<system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
        <add name="ModuleWithSessionAccess" type="HttpModuleWithSessionAccess.ModuleWithSessionAccess, HttpModuleWithSessionAccess"/>
    </modules>
</system.webServer> 
```

web.config 声明 - 仅为托管请求调用 HttpModule：

```
<system.webServer>
    <modules>
        <add name="ModuleWithSessionAccess" type="HttpModuleWithSessionAccess.ModuleWithSessionAccess, HttpModuleWithSessionAccess" preCondition="managedHandler"/>
    </modules>
</system.webServer> 
```

IHttpModule 实现：

```
namespace HttpModuleWithSessionAccess
{
    public class ModuleWithSessionAccess : IHttpModule
    {
        public void Init(HttpApplication context)
        {
            context.BeginRequest += Context_BeginRequest;
            context.PreRequestHandlerExecute += Context_PreRequestHandlerExecute;
        }

        private void Context_BeginRequest(object sender, EventArgs e)
        {
            var app = (HttpApplication)sender;
            app.Context.SetSessionStateBehavior(System.Web.SessionState.SessionStateBehavior.Required);
        }

        private void Context_PreRequestHandlerExecute(object sender, EventArgs e)
        {
            var app = (HttpApplication)sender;
            if (app.Context.Session != null)
            {
                app.Context.Session["Random"] = $"Random value: {new Random().Next()}";
            }
        }

        public void Dispose()
        {
        }
    }
} 
```

# php - 有没有办法在 PHP 中测量解析时间？

> ID：276360
> 
> 赞同：8
> 
> 时间：2008-11-09T19:34:40.290
> 
> 标签：php, benchmarking, opcode-cache

通过运行时基准测试优化 PHP 代码是直截了当的。通过代码块周围的 microtime() 跟踪 $start 和 $end 时间 - 我不是在寻找涉及 microtime() 使用的答案。

我想做的是测量 PHP 准备运行它的代码所需的时间 - 代码解析/操作代码树构建时间。我的理由是，虽然很容易为站点上的每个页面包含（）您**可能**需要的每个类，但 CPU 开销不能“免费”。我想知道解析时间到底有多“昂贵”。

我假设 APC 等操作码缓存**不是**场景的一部分。

我是否正确认为 PHP 中的解析时间测量必须在 mod_php 中进行？

**编辑**：如果可能的话，考虑到`$_SERVER['DOCUMENT_ROOT']`代码中的使用会有所帮助。命令解决方案可能需要一些修补才能做到这一点（但仍然是有价值的答案）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-09T19:38:17.583

是的。有。

```
<?php return; rest of the code ?> 
```

或者

```
<?php whole code; $%^parse erorr!@! ?> 
```

然后比较运行空脚本的时间

```
time php empty.php 
```

随着我上面提到的添加运行（或失败）常规脚本所需的时间：

```
time php test.php 
```

我在大文件上使用了这种方法，Core2Duo 2.4Ghz 上的 PHP5.3 每秒可以解析 1.5 到 4.5MB 的 PHP 代码（当然，这在很大程度上取决于代码的复杂性）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T19:36:53.653

一种方法是从命令行定时执行脚本。

以 Linux 为例：

```
$ time php5 -r 'echo "Hello world";'
Hello world
real    0m1.565s
user    0m0.036s
sys     0m0.024s 
```

这些帮助有用？也许它有助于发现不同脚本之间的相对时间，但它可能并不表示通过 Apache 模块所花费的时间

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T20:21:42.127

对于您正在寻求的详细分析级别，似乎实现 Xdebug ( [http://xdebug.org/](http://xdebug.org/) ) 将为您提供最大的信息，而无需将您的代码分成分段。

# objective-c - 如何以编程方式从 OSX 上的任何文档生成 PDF？

> ID：276362
> 
> 赞同：18
> 
> 时间：2008-11-09T19:35:21.613
> 
> 标签：objective-c, macos, pdf, applescript, automator

我正在为 OSX 开发一个项目，用户可以选择一组文档（从任何应用程序），我需要从中生成 PDF。标准 Macintosh 打印对话框有一个 PDF 按钮，其中包含许多与 PDF 相关的命令，包括“另存为 PDF...”。但是，我需要在不需要用户交互的情况下生成 PDF 文件。理想情况下，我希望它适用于任何类型的文档。

以下是我迄今为止探索过的选项：

*   自动化操作。Automator 有一个 PDF 库，但它提供了处理 PDF 文件的操作，而不是生成它们。有一个 Finder 操作可以打印任何文件，但仅限于真正的打印机。
*   苹果脚本。某些应用程序能够生成 PDF 文件（例如，如果您将“在“test.pdf”中保存文档”发送到 Pages，它将生成 PDF（但这仅适用于 Pages - 我需要对任何类型的文档的支持） .
*   自定义打印机。我可以创建一个虚拟打印机驱动程序，然后使用自动操作，但我不喜欢将用户与打印列表中的额外打印机混淆的想法。

我希望有某种方式可以与活动应用程序进行交互，就好像用户正在执行以下步骤一样：

1.  执行 Cmd-P（打开打印对话框）
2.  点击“PDF”按钮
3.  选择“另存为 PDF...”（菜单中的第二项）
4.  在保存对话框中输入文件名
5.  点击“保存”

如果这是最好的方法（是吗？），那么真正的问题是：如何将 UI 事件发送到外部应用程序（击键、鼠标事件、菜单选择）？

**更新：**只是为了澄清一点：我需要转换为 PDF 的文档是由*其他应用程序*创建的文档。例如，用户可能会选择 Word 文档或 Numbers 电子表格或 OmniGraffle 绘图或网页。共同点是这些文档中的每一个都有一个关联的应用程序，并且该应用程序知道如何打印它（并且 OSX 知道如何将打印输出呈现为 PDF 文件）。

因此，Cocoa Dev Central 的示例没有帮助，因为它们是关于从*我的应用程序*生成 PDF 的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-10T03:40:18.763

我认为您可以使用 applescript 打开文档，然后使用 [applescript UI 脚本](https://developer.apple.com/library/content/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/AutomatetheUserInterface.html)调用打印菜单。

例如 ：

```
tell application "System Events"
        tell window of process "Safari"
            set foremost to true
            keystroke "p" using {command down}
            delay 3
            click menu button "PDF" of sheet 2
            click menu item "Save as PDF…" of menu 1 of menu button "PDF" of sheet 2
            keystroke "my_test.file"
            keystroke return
            delay 10
        end tell

    end tell 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-28T17:18:45.863

看看一个名为[CUPS-PDF的程序](http://bitbucket.org/codepoet/cups-pdf-for-mac-os-x/wiki/Home)

它是 OS X 的虚拟打印机，它在通过普通打印机打印时执行“另存为 PDF”方法所做的工作，但通过它的每个打印作业都会产生 pdf 输出。

安装后，您可以使用**lp**命令创建 shell 或 AppleScripts。

例如，一旦设置了虚拟打印机，您就可以打印 test.txt 并将其自动保存为 pdf。要使用 AppleScript 执行此操作，您将使用以下代码：

```
do shell script "lp -d CUPS_PDF test.txt" 
```

CUPS-PDF 应用程序将所有输出保存到 /Users/Shared/CUPS-PDF。我不确定您是否可以更改该路径，但您可以在脚本中检索文件并移动它。

不过有一些注意事项。

首先，**lp**命令不能打印 .doc 文件。我认为还有其他一些第三方应用程序可以让你这样做。

其次，CUPS-PDF 应用程序在“系统偏好设置”的“打印机”窗格中显示其名称中带有连字符，但 CUPS 将队列名称显示为带有下划线。因此，在命令行上，您需要引用 CUPS 队列名称，即带有下划线的 CUPS_PDF。

**即使您发现通过lp**命令构建脚本并不是很有用，并且仍然希望涉及 GUI 脚本，那么拥有虚拟打印机应该可以为您节省一些步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-13T14:50:42.497

你可以用这样的杯子

```
 on open afile
        set filename to name of (info for afile)
        tell application "Finder"
            set filepath to (container of (afile as alias)) as alias
        end tell
        set filepath to quoted form of POSIX path of filepath
        set tid to AppleScript's text item delimiters
        set AppleScript's text item delimiters to "."
        set filename to text item 1 of filename
        set AppleScript's text item delimiters to tid
        set afile to quoted form of POSIX path of afile
        do shell script "cupsfilter " & afile & " > " & filepath & filename & ".pdf"
    end open 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-20T08:48:29.900

为此，我在 bash 中创建了一个别名：

```
convert2pdf() {
  /System/Library/Printers/Libraries/convert -f "$1" -o "$2" -j "application/pdf"
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-25T19:35:53.793

我在 Automator 的帮助下输入了下面的代码（记录一个动作，然后将特定动作拖出“Watch Me Do”窗口以获取 Applescript）。如果要从 Safari 以外的应用程序打印 PDF，则可能必须运行相同的过程并围绕“打印”对话框调整此 Applescript，因为每个程序可能具有不同的打印 GUI。

```
# Convert the current Safari window to a PDF
# by Sebastain Gallese

# props to the following for helping me get frontmost window
# http://stackoverflow.com/questions/480866/get-the-title-of-the-current-active-window-            document-in-mac-os-x

global window_name

# This script works with Safari, you might have
# to tweak it to work with other applications 
set myApplication to "Safari"

# You can name the PDF whatever you want
# Just make sure to delete it or move it or rename it
# Before running the script again
set myPDFName to "mynewpdfile"

tell application myApplication
    activate
    if the (count of windows) is not 0 then
        set window_name to name of front window
    end if
end tell

set timeoutSeconds to 2.0
set uiScript to "keystroke \"p\" using command down"
my doWithTimeout(uiScript, timeoutSeconds)
set uiScript to "click menu button \"PDF\" of sheet 1 of window \"" & window_name & "\" of application process \"" & myApplication & "\""
my doWithTimeout(uiScript, timeoutSeconds)
set uiScript to "click menu item 2 of menu 1 of menu button \"PDF\" of sheet 1 of window \"" & window_name & "\" of application process \"" & myApplication & "\""
my doWithTimeout(uiScript, timeoutSeconds)
set uiScript to "keystroke \"" & myPDFName & "\""
my doWithTimeout(uiScript, timeoutSeconds)
set uiScript to "keystroke return"
my doWithTimeout(uiScript, timeoutSeconds)

on doWithTimeout(uiScript, timeoutSeconds)
    set endDate to (current date) + timeoutSeconds
    repeat
        try
            run script "tell application \"System Events\"
" & uiScript & "
end tell"
            exit repeat
        on error errorMessage
            if ((current date) > endDate) then
                error "Can not " & uiScript
            end if
        end try
    end repeat
end doWithTimeout 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-13T01:54:52.840

`"/System/Library/Printers/Libraries/./convert"` 已在更高版本的 MacOS 中删除。

你现在可以使用sips了。AppleScript 示例：执行 shell 脚本：`sips -s format pdf Filename.jpg --out Filename.pdf`

# monitoring - 就构建（或设置）基于 RRD 工具的 Web 应用程序提出建议，用于比 Cacti 更简单的网站监控？

> ID：276381
> 
> 赞同：2
> 
> 时间：2008-11-09T19:50:59.303
> 
> 标签：monitoring, rrdtool, rrd

我认为 Cacti 很棒，除了它需要几个小时来配置它。你可以用它做很多事情，但我觉得它有点过于复杂。一个收集磁盘利用率的脚本最近突然出现在我身上（没有明显的原因），我花了 3 个小时却没有找到任何地方。

我想要一个像 Cacti 这样的工具，但超级容易设置。我对 RRD 有点熟悉，所以一点点手动工作是可以的。

为了使这与编程更加相关：不同软件包的替代方案是开发定制的东西。有没有人尝试过这个？您使用哪些部件来构建哪些部件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-05T16:59:53.623

那里有很多工具：

*   仙人掌
*   神经节
*   扎比克斯
*   海瑞克
*   监控
*   侦察
*   石墨

每个都关注可用性的不同方面。Reconnoiter 和 Graphite 是出于特殊需求而诞生的，他们希望获得比 RRD 提供的更高的分辨率。

我建议你在构建自己之前再看看 Cacti。在 cacti 中为您的主机和图表创建模板。然后使用内置的 CLI 工具进行自动化。这样，对于每个主机，您都无需单击 GUI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T02:47:58.790

我想这就是我想要的：

[http://collectd.org](http://collectd.org)

与draw结合收集看起来很适合我的需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T03:42:34.983

我不知道这是否能满足您的需求，但您可能还想查看 RRDUtil：

[http://www.tnpi.biz/internet/manage/rrdutil/](http://www.tnpi.biz/internet/manage/rrdutil/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T20:17:11.200

不幸的是，它们的学习和配置都非常耗时。您必须花时间了解使用的所有原则并阅读示例配置。

这件家务事没有捷径可走:-D

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T21:08:25.170

我们使用 gmond 和 ganglia。

# iphone - 输入带小数点的数值的最佳方法是什么？

> ID：276382
> 
> 赞同：51
> 
> 时间：2008-11-09T19:51:48.007
> 
> 标签：iphone, cocoa-touch

在我的应用程序中，用户需要能够输入带小数位的数值。iPhone 没有提供专门用于此目的的键盘——只有一个数字键盘和一个带有数字和符号的键盘。

有没有一种简单的方法来使用后者并防止输入任何非数字输入而不必正则表达式最终结果？

谢谢！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2011-02-13T07:49:22.480

我认为最好指出从 iOS 4.1 开始您可以使用新的`UIKeyboardTypeDecimalPad`.

所以现在你只需要：

```
myTextField.keyboardType=UIKeyboardTypeDecimalPad; 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-11-26T18:03:14.810

一个更优雅的解决方案恰好也是最简单的。

*您不需要小数分隔键*

为什么？因为你可以简单地从用户的输入中推断出来。例如，在美国地区，当您输入 1.23 美元时，您首先输入数字 1-2-3（按该顺序）。在系统中，当输入每个字符时，这将被识别为：

*   用户输入 1：$0.01
*   用户输入 2：$0.12
*   用户输入 3：$1.23

请注意我们如何根据用户的输入推断小数点分隔符。现在，如果用户想输入 1.00 美元，他们只需输入数字 1-0-0。

为了让您的代码处理不同语言环境的货币，您需要获取货币的最大小数位数。这可以通过以下代码片段来完成：

```
NSNumberFormatter *currencyFormatter = [[NSNumberFormatter alloc] init];
[currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
int currencyScale = [currencyFormatter maximumFractionDigits]; 
```

例如，日元的最大小数位数为 0。因此，在处理日元输入时，没有小数分隔符，因此甚至无需担心小数。

这种解决问题的方法允许您使用 Apple 提供的库存数字输入键盘，而无需担心自定义键盘、正则表达式验证等。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-04-14T10:49:32.010

这是已接受答案中建议的解决方案的示例。这不处理其他货币或任何东西 - 在我的情况下，我只需要支持美元，不管语言环境/货币是什么，所以这对我来说没问题：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range
    replacementString:(NSString *)string {

    double currentValue = [textField.text doubleValue];
    //Replace line above with this
    //double currentValue = [[textField text] substringFromIndex:1] doubleValue];
    double cents = round(currentValue * 100.0f);

    if ([string length]) {
        for (size_t i = 0; i < [string length]; i++) {
            unichar c = [string characterAtIndex:i];
            if (isnumber(c)) {
                cents *= 10;
                cents += c - '0'; 
            }            
        }
    } else {
        // back Space
        cents = floor(cents / 10);
    }

    textField.text = [NSString stringWithFormat:@"%.2f", cents / 100.0f];
    //Add this line
    //[textField setText:[NSString stringWithFormat:@"$%@",[textField text]]];
    return NO;
} 
```

舍入和下限很重要 a) 因为浮点表示有时会丢失 .00001 或其他任何值，并且 b) 格式字符串会舍入我们在退格部分删除的任何精度。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T21:30:18.947

我想做完全相同的事情，除了使用货币而不是直接十进制值。

我最终创建了一个包含 UITextField 和 UILabel 的自定义视图。标签覆盖了文本字段，但文本字段仍会收到触摸。我使用 UITextFieldTextDidChange 通知来观察文本字段的变化（我使用 NSNumberFormatter 将结果数字转换为格式化的货币值）来更新标签。

要禁用允许用户重新定位插入点的放大镜，您需要使用自定义 UITextField 子类并覆盖 touchesBegan:withEvent: 并将其设置为不执行任何操作。

我的解决方案可能与您需要的不同，因为小数点始终是固定的——我使用系统的货币设置来确定小数点后应该有多少位数字。但是，数字小键盘上没有小数点。而且您无法在键盘上添加任何按钮（这尤其令人讨厌，因为键盘左下角有一个空白按钮非常适合小数点！）所以我没有解决方案， 很遗憾。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-09T20:27:33.927

根据特定的应用程序，在 iphone 上提供一个用户可以从中选择位置的滑块可能是更好的选择。然后根本不需要输入数字。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-10T15:02:04.893

您可能希望使用滑块（如 Martin v. Löwis 所建议）或 UIPickerView，每个数字都有一个单独的轮子。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-11T10:17:55.697

我构建了一个带小数点的自定义数字键盘视图控制器......检查一下：

[http://sites.google.com/site/psychopupnet/iphone-sdk/tenkeypadcustom10-keypadwithdecimal](http://sites.google.com/site/psychopupnet/iphone-sdk/tenkeypadcustom10-keypadwithdecimal)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-10T10:30:31.057

从 iOS4.1 开始，有一个新的键盘类型 UIKeyboardTypeNumberPad，但不幸的是，到目前为止，它似乎还没有出现在 Interface Builder 选择列表中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-07T17:37:59.610

以下是如何以与货币无关的方式在不使用浮点数、round() 或 ceil() 的情况下做到这一点。

在您的视图控制器中，设置以下实例变量（如果这是您的包，请使用关联的 @property 语句）：

```
@interface MyViewController : UIViewController <UITextFieldDelegate> {
@private
    UITextField *firstResponder;
    NSNumberFormatter *formatter;
    NSInteger currencyScale;
    NSString *enteredDigits;
}

@property (nonatomic, readwrite, assign) UITextField *firstResponder;
@property (nonatomic, readwrite, retain) NSNumberFormatter *formatter;
@property (nonatomic, readwrite, retain) NSString *enteredDigits;

@end 
```

并且您的 viewDidLoad 方法应包含以下内容：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    NSNumberFormatter *aFormatter = [[NSNumberFormatter alloc] init];
    [aFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
    currencyScale = -1 * [aFormatter maximumFractionDigits];
    self.formatter = aFormatter;
    [aFormatter release];
} 
```

然后按如下方式实现您的 UITextFieldDelegate 方法：

```
#pragma mark -
#pragma mark UITextFieldDelegate methods

- (void)textFieldDidBeginEditing:(UITextField *)textField {
    // Keep a pointer to the field, so we can resign it from a toolbar
    self.firstResponder = textField;
    self.enteredDigits = @"";
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    if ([self.enteredDigits length] > 0) {
        // Get the amount
        NSDecimalNumber *result = [[NSDecimalNumber decimalNumberWithString:self.enteredDigits] decimalNumberByMultiplyingByPowerOf10:currencyScale];
        NSLog(@"result: %@", result);
    }
}

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    // Check the length of the string
    if ([string length]) {
        self.enteredDigits = [self.enteredDigits stringByAppendingFormat:@"%d", [string integerValue]];
    } else {
        // This is a backspace
        NSUInteger len = [self.enteredDigits length];
        if (len > 1) {
            self.enteredDigits = [self.enteredDigits substringWithRange:NSMakeRange(0, len - 1)];
        } else {
            self.enteredDigits = @"";
        }
    }

    NSDecimalNumber *decimal = nil;

    if ( ![self.enteredDigits isEqualToString:@""]) {
        decimal = [[NSDecimalNumber decimalNumberWithString:self.enteredDigits] decimalNumberByMultiplyingByPowerOf10:currencyScale];
    } else {
        decimal = [NSDecimalNumber zero];
    }

    // Replace the text with the localized decimal number
    textField.text = [self.formatter stringFromNumber:decimal];

    return NO;  
} 
```

只用英镑和便士对此进行了测试，但它也适用于日元。如果你想为非货币目的格式化小数，那么只需阅读[NSNumberFormatter](http://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html "NSNumberFormatter")上的文档并设置你想要的任何格式/maximumFractionDigits。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-09-24T23:05:26.317

Mike Weller 帖子的 Swift 2 实现，也只有美元：

```
 func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {
    guard let str = textField.text else {
        textField.text = "0.00"
        return false
    }

    let value = (str as NSString).doubleValue

    var cents = round(value * 100)
    if string.characters.count > 0 {
        for c in string.characters {
            if let num = Int(String(c)) {
                cents *= 10
                cents += Double(num)
            }
        }
    }
    else {
        cents = floor(cents / 10)
    }

    textField.text = NSString(format: "%.2f", cents/100) as String

    return false
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-16T05:22:40.310

您可以使用[STATextField](https://github.com/Stunner/STAControls/blob/master/STAControls/STAControls/TextField/STATextField.h)并将 currencyRepresentation 设置为 YES，其中：

> 确保输入的小数点不超过一位，并且在所述小数点右侧输入的数字不超过 2 位。

还有[STAATMTextField](https://github.com/Stunner/STAControls/blob/master/STAControls/STAControls/TextField/STAATMTextField.h)默认支持货币模式*和*ATM 文本输入：

> 提供模拟 ATM 机输入行为的文本字段。

# .net-3.5 - 将容器类添加到字典

> ID：276383
> 
> 赞同：0
> 
> 时间：2008-11-09T19:52:24.230
> 
> 标签：.net-3.5, dictionary

我有一个字典，当我向它添加多个值时，之前输入的项目会采用添加的项目的值。我正在使用.Net 3.5 这是代码：

```
public static Dictionary<string, Neighborhoods> Families()
    {
        if (File.Exists(calculatePath() + "Family.txt")){}
        else {File.Create(calculatePath() + "Family.txt").Close();}
        string[] inp = File.ReadAllLines(calculatePath() + "Family.txt");
        Neighborhoods temp = new Neighborhoods();
        Dictionary<string, Neighborhoods> All_Families = new Dictionary<string, Neighborhoods>();
        string currentphase = null;
        foreach (string s in inp)
        {
            switch (s)
            {
                case "!<Start Family>!": temp = new Neighborhoods();
                    break;
                case "<Family Name>": currentphase = "<Family Name>";
                    break;
                case "<End Family Name>": currentphase = null;
                    break;
                case "<Neighbour Enabled>True": temp.Neighbourhood_Enabled1 = true;
                    currentphase = "<Neighbour Enabled>True";
                    break;
                case "<Neighbour Enabled>False": temp.Neighbourhood_Enabled1 = false;
                    temp.Neighbourhood_Input1 = null;
                    break;
                case "<University Enabled>True": temp.University_Enabled1 = true;
                    currentphase = "<University Enabled>True";
                    break;
                case "<University Enabled>False": temp.University_Enabled1 = false;
                    temp.University_Input1 = null;
                    currentphase = null;
                    break;
                case "<Downtown Enabled>True": temp.Downtown_Enabled1 = true;
                    currentphase = "<Downtown Enabled>True";
                    break;
                case "<Downtown Enabled>False": temp.Downtown_Enabled1 = false;
                    temp.Downtown_Input1 = null;
                    currentphase = null;
                    break;
                case "!<End Family>!": All_Families.Add(temp.Name, temp);
                    break;
                default: if (currentphase == "<Family Name>") temp.Name = s;
                    if (currentphase == "<Neighbour Enabled>True") temp.Neighbourhood_Input1 = s;
                    if (currentphase == "<University Enabled>True") temp.University_Input1 = s;
                    if (currentphase == "<Downtown Enabled>True") temp.Downtown_Input1 = s;
                    break;
            }
        }
        return All_Families;
    } 
```

如何做到这一点，以便在添加新键和值时，旧键保持其原始值

* * *

样本数据：

```
!<Start Family>!
Family Name>
qwe
<End Family Name>
<Neighbour Enabled>True
qwe
<University Enabled>True
we
<Downtown Enabled>True
qwe
!<End Family>!
!<Start Family>!
<Family Name>
123
<End Family Name>
<Neighbour Enabled>True
123
<University Enabled>True
123
<Downtown Enabled>True
123
!<End Family>! 
```

* * *

这是 nieghbourhoods 类供参考。我会尝试 xml 方法，但它不会很快完成，我还在学习这些东西。

```
class Neighborhoods
{
    public Neighborhoods()
    {
        name = "";
        Neighbourhood_Enabled = false;
        Neighbourhood_Input = "";
        University_Enabled = false;
        University_Input = "";
        Downtown_Enabled = false;
        Downtown_Input = "";
    }

    static string name;

    public string Name
    {
        get { return Neighborhoods.name; }
        set { Neighborhoods.name = value; }
    }
    static bool Neighbourhood_Enabled;

    public bool Neighbourhood_Enabled1
    {
        get { return Neighborhoods.Neighbourhood_Enabled; }
        set { Neighborhoods.Neighbourhood_Enabled = value; }
    }
    static string Neighbourhood_Input;

    public string Neighbourhood_Input1
    {
        get { return Neighborhoods.Neighbourhood_Input; }
        set { Neighborhoods.Neighbourhood_Input = value; }
    }
    static bool University_Enabled;

    public bool University_Enabled1
    {
        get { return Neighborhoods.University_Enabled; }
        set { Neighborhoods.University_Enabled = value; }
    }
    static string University_Input;

    public string University_Input1
    {
        get { return Neighborhoods.University_Input; }
        set { Neighborhoods.University_Input = value; }
    }
    static bool Downtown_Enabled;

    public bool Downtown_Enabled1
    {
        get { return Neighborhoods.Downtown_Enabled; }
        set { Neighborhoods.Downtown_Enabled = value; }
    }
    static string Downtown_Input;

    public string Downtown_Input1
    {
        get { return Neighborhoods.Downtown_Input; }
        set { Neighborhoods.Downtown_Input = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T20:14:14.547

从外观上看，您想要解析一个文件，并将其加载到 Dictionary 集合中。

一对夫妇的批评......使用 XML 作为一个，并摆脱疯狂的解析器：

```
<?xml version="1.0" encoding="utf-8"?>
<families>
  <family>
    <name>Smith</name>
    <neighborhood>true</neighborhood>
    <university>false</university>
    <downtown>false</downtown>
  </family>
  <family>
    <name>Jones</name>
    <neighborhood>false</neighborhood>
    <university>true</university>
    <downtown>false</downtown>
  </family>
</families> 
```

现在，我们可以使用内置的 System.XML 命名空间来更轻松地解析它。

例如，我只是将您的代码重写为：

```
 Dictionary<String, Neighborhood> families = new Dictionary<string, Neighborhood>();

        XmlDocument doc = new XmlDocument();
        doc.Load("family.xml");

        foreach (XmlNode familyNode in doc.SelectNodes("//family"))
        {
            Neighborhood n = new Neighborhood();
            n.Name = familyNode.SelectSingleNode("name").InnerText;
            n.InNeighborhood = Boolean.Parse(familyNode.SelectSingleNode("neighborhood").InnerText);
            n.InDowntown = Boolean.Parse(familyNode.SelectSingleNode("downtown").InnerText);
            n.InUniversity = Boolean.Parse(familyNode.SelectSingleNode("university").InnerText);

            families.Add(n.Name,n);
        } 
```

它工作得很好，虽然我没有在我的代码中添加任何错误处理以保持简短。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T20:38:25.777

使用您提供的示例数据和您提供的代码，使用这样的`Neighborhoods`类可以正常工作：

```
public class Neighborhoods
{
    public string Name { get; set; }
    public string Neighbourhood_Input1 { get; set; }
    public string University_Input1 { get; set; }
    public string Downtown_Input1 { get; set; }
    public bool Neighbourhood_Enabled1 { get; set; }
    public bool University_Enabled1 { get; set; }
    public bool Downtown_Enabled1 { get; set; }
} 
```

我的测试是运行这段代码：

```
static void Main()
{
    var families = Families();

    foreach (var family in x.Values)
    {
        Console.WriteLine(y.Name);
    }
} 
```

打印出“qwe”和“123”——表明涉及两个不同的对象。

但是，我们还没有看到真正的`Neighborhoods`课程。我不认为它使用静态字段（但仍然是实例属性）是吗？这肯定会解释你所看到的行为。

编辑：是的，现在你已经向我们展示了它是有意义的 Neighborhoods 代码。这些字段意味着与每个*实例*相关，而不仅仅是类型本身 - 所以它们不应该是静态的。

为了证明这与解析器无关，试试这个：

```
Neighborhoods first = new Neighborhoods();
Neighborhoods second = new Neighborhoods();

first.Name = "First";
Console.WriteLine(second.Name); 
```

你会看到它打印出“First”——这显然不是你想要的！

不幸的是，我没有关于“静态”意味着什么的好页面，但我建议您在您拥有的任何 C# 书籍中查找它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T20:44:32.143

就像 Jon Skeet 指出的那样，你不能像那样使用静态。

用私有替换静态，一切都应该很好。

# c - 如何在 C 中构造#includes

> ID：276386
> 
> 赞同：6
> 
> 时间：2008-11-09T19:58:29.647
> 
> 标签：c, header, include

假设我有一个 C 程序，它被分解为一组 *.c 和 *.h 文件。如果一个文件中的代码使用另一个文件中的函数，我应该在哪里包含头文件？在使用该函数的 *.c 文件中，还是在该文件的标头中？

例如文件`foo.c`包括`foo.h`，其中包含所有声明`foo.c`；`bar.c`和相同`bar.h`。函数`foo1()`内部`foo.c`调用`bar1()`，在中声明`bar.h`和定义`bar.c`。现在的问题是，我应该包括`bar.h`inside`foo.h`还是 inside `foo.c`？

对于此类问题，一套好的经验法则是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T20:10:50.730

您应该在 foo.c 中包含 foo.h。这样，其他包含 foo.h 的 c 文件就不会不必要地携带 bar.h。这是我对包含头文件的建议：

*   在 c 文件中添加包含定义 - 这样在阅读代码时文件依赖关系更加明显。
*   将 foo.h 拆分为两个单独的文件，例如 foo_int.h 和 foo.h。第一个带有只有 foo.c 需要的类型和前向声明。foo.h 包含外部模块所需的函数和类型。这类似于 foo 的私有和公共部分。
*   避免交叉引用，即 foo 引用 bar 和 bar 引用 foo。这可能会导致链接问题，也是设计不良的标志

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T22:32:02.363

正如其他人所指出的，头文件 foo.h 应该声明能够使用源文件 foo.c 提供的工具所必需的信息。这将包括 foo.c 提供的类型、枚举和函数。（你不使用全局变量，对吗？如果你这样做了，那么它们也会在 foo.h 中声明。）

头文件 foo.h 应该是自包含的和幂等的。自包含意味着任何用户都可以包含 foo.h 而无需担心可能需要哪些其他标头（因为 foo.h 包含这些标头）。幂等意味着如果标题被包含多次，则不会造成任何损坏。这是通过经典技术实现的：

```
 #ifndef FOO_H_INCLUDED
 #define FOO_H_INCLUDED
 ...rest of the contents of foo.h...
 #endif /* FOO_H_INCLUDED */ 
```

问题问：

*文件 foo.c 包括 foo.h，其中包含 foo.c 的所有声明；bar.c 和 bar.h 相同。foo.c 中的函数 foo1() 调用 bar1()，它在 bar.h 中声明并在 bar.c 中定义。现在的问题是，我应该将 bar.h 包含在 foo.h 中，还是包含在 foo.c 中？*

这将取决于 foo.h 提供的服务是否依赖于 bar.h。如果使用 foo.h 的其他文件需要 bar.h 定义的类型或枚举之一才能使用 foo.h 的功能，则 foo.h 应确保包含 bar.h（通过包含它）。但是，如果 bar.h 的服务只在 foo.c 中使用，而使用 foo.h 的人不需要，那么 foo.h 不应该包含 bar.h

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T20:03:28.000

我只会在头文件本身所需的 *.h 文件中包含头文件。在我看来，源文件所需的头文件应该包含在源文件中，以便从源代码中可以明显看出依赖关系。应构建头文件以处理多个包含，因此如果需要清晰起见，您可以将其放入两者中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T22:21:55.380

使用以下示例，`foo.c`我`foo.h`发现这些指南很有帮助：

*   请记住， 的目的`foo.h`是为了方便使用`foo.c`，因此请尽可能保持其简单、有条理和不言自明。*对解释如何*以及*何时*`foo.c`使用- 以及何时*不*使用它们的功能的注释要自由。

*   `foo.h`声明了以下公共特性`foo.c`：函数、宏、typedef 和（*颤抖*）全局变量。

*   `foo.c`应该`#include "foo.h`- 参见讨论，以及下面 Jonathan Leffler 的评论。

*   如果`foo.c`需要额外的头文件来编译，请将它们包含在`foo.c`.

*   `foo.h`如果编译需要外部头文件，请将它们包含在`foo.h`

*   利用预处理器防止`foo.h`被多次包含。（见下文。）

*   如果由于某种原因需要一个外部头文件才能让另一个`.c`文件使用 中的功能，请在`foo.c`其中包含该头文件`foo.h`以使下一个开发人员免于不必要的调试。如果您对此不满意，请考虑添加宏，如果未包含所需的标头，则该宏将在编译时显示指令。

*   *不要*`.c`在另一个文件中包含一个文件，`.c`除非你有充分*的*理由并清楚地记录它。

正如 kgiannakakis 所指出的，将公共接口与仅在其内部需要的定义和声明分开是有帮助的`foo.c`。但与其创建两个文件，有时最好让预处理器为您执行此操作：

```
// foo.c
#define _foo_c_         // Tell foo.h it's being included from foo.c
#include "foo.h"
. . . 
```

```
// foo.h
#if !defined(_foo_h_)   // Prevent multiple inclusion
#define _foo_h_

// This section is used only internally to foo.c
#ifdef _foo_c_
. . .
#endif

// Public interface continues to end of file.

#endif // _foo_h_       // Last-ish line in foo.h 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-09T20:02:55.130

我在文件中包含尽可能少的标题集`.h`，并将其余部分包含在`.c`文件中。这有时会减少编译时间。鉴于您的示例，如果`foo.h`确实不需要`bar.h`但无论如何都包含它，并且其他一些文件包含`foo.h`，那么如果`bar.h`更改该文件将被重新编译，即使它实际上可能不需要或使用`bar.h`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T20:27:51.477

.h 文件应为 .c 文件中的函数定义公共接口（也称为 api）。

如果file1的接口使用file2的接口那么#include file2.h in file1.h

如果file1.c 中的实现使用了file2.c 中的内容，那么file1.c 应该#include file2.h。

我必须承认 - 因为我总是在 file1.c 中 #include file1.h - 如果它已经在 file1.h 中 #included，我通常不会直接在 file1.c 中打扰 #include file2.h

如果您发现自己处于两个 .c 文件 #include 彼此 .h 文件的情况，那么这表明模块化已经崩溃，您应该考虑重新调整一下。

# .net - WCF over HTTPS 与 PHP 引发“方法不允许”异常

> ID：276389
> 
> 赞同：1
> 
> 时间：2008-11-09T19:59:38.100
> 
> 标签：.net, php, wcf, soap, https

我创建了一个旨在始终通过 HTTPS 的 .NET WCF 服务。当我第一次创建服务框架并通过 HTTP 运行它时，它运行良好。我使用 PHP5 来测试与内置 SOAP 函数的互操作性。但是，一旦我切换到 HTTPS，当我尝试从 PHP 调用该函数时，我会收到错误消息“方法不允许”和错误代码“http”。它确实允许我检索方法列表。当它调用方法“Test”时会发生错误。

这是 WCF 配置：

```
 <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="secureBasic">
          <security mode="Transport">
            <transport clientCredentialType="None" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <services>
      <service behaviorConfiguration="apiBehavior" name="TestAPI.API">
        <endpoint address="https://192.168.0.3/API" 
                  binding="basicHttpBinding" 
                  bindingConfiguration="secureBasic" 
                  contract="TestAPI.IAPI"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="apiBehavior">
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

PHP 是这样称呼它的：

```
$client = new SoapClient("https://192.168.0.3/API.svc?wsdl");
echo "<pre>" . print_r($client->__getFunctions(), 1) . "</pre>";
$param = new stdClass();
$param->A = "123";
$param->B = "456";
try {
    $client->Test($param);
} catch (Exception $e) {
    die("<pre>" . print_r($e,1) . "</pre>");
} 
```

我正在使用自签名 SSL 证书进行测试，我不相信 PHP 需要受信任的证书。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T20:16:36.007

您是否尝试过网络嗅探器来查看实际从哪里请求的内容？像 Fiddler 或 Wireshark 之类的东西（取决于场景）。

另外-我注意到您缺少`behaviorConfiguration="apiBehavior"`该`<service...`元素。

# php - 使用 PHP/Javascript 进行多文件上传，无需 Flash

> ID：276400
> 
> 赞同：4
> 
> 时间：2008-11-09T20:08:56.087
> 
> 标签：php, javascript, file-upload

我正在尝试制作一个允许同时上传多个文件的网页。我会将文件扩展名限制为最常见的图像，如 JPG、JPEG、PNG 和 GIF。

我已经对此进行了一些研究，并且在我所看到的任何地方都闪烁着这个和闪烁着那个。

我真的不想用闪光灯。尤其是 Flash 10，它禁用了启用多文件上传的最常用方法。

我正在寻找的是一种不断创建越来越多输入字段的方法，每个输入字段都有一个浏览按钮，然后在表单底部有一个最终上传按钮。用 Javascript 创建新的输入字段真的没什么大不了的。

所以我想知道这是如何工作的。我是否需要为所有文件输入字段提供相同的名称属性，以便我可以使用 1 段 PHP 代码来解决这个问题？或者 PHP 有什么方法可以检测到有多少文件被提交并简单地将用于解析文件的代码放在 for 循环中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-09T20:16:29.440

您可以继续添加“文件”输入，但使用类似“上传 []”的名称

```
<input type="file" name="upload[]"> 
```

然后在 $_FILES['upload'] 你将有一个文件数组，你可以像这样循环

```
foreach ($_FILES['upload'] as $file) {
    echo $file['size'];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T20:14:06.293

这是算法：

您将新的文件输入字段添加到表单中。每个字段必须有一个唯一的名称。然后，在服务器端，循环遍历 $_FILES 数组，查看已上传的文件数量并进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T20:23:17.273

在使用 JavaScript 添加新的上传字段时，您还可以让 JavaScript 使用表单中上传字段的数量更新一些“隐藏”输入字段。这样，一旦您单击提交，该隐藏值应该被提交，并且为所有上传的文件解析出 $_FILES 数组将是微不足道的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T00:01:38.393

如果您对文件数量有合理的最大限制，最好在静态表单中包含那么多文件上传字段，然后使用 JavaScript 隐藏多余的字段，而不是动态创建它们。然后，当 JavaScript 不可用时，表单仍然可以工作。

旁注：从技术上讲，单个 HTML 文件上传表单已经是多个文件上传表单。根据 HTML 表单编码标准，应该能够在“浏览”对话框中选择多个文件，并将它们作为多部分/混合 MIME 结构提交。

然而，实际上几乎没有任何东西支持这一点。旧版本的 Opera 在客户端（而且，我认为是某种古老的测试浏览器，可能是 Viola），在服务器端有一些表单解析组件，但不是 PHP 内置。在任何情况下，用户界面都不是很实用，所以你不会错过太多。

# c++ - 如何在 CDockablePane 中放置 MFC CFormView？

> ID：276420
> 
> 赞同：5
> 
> 时间：2008-11-09T20:18:24.787
> 
> 标签：c++, mfc, mfc-feature-pack

如何将 MFC CFormView 放置在 VS 2008 MFC 功能包中引入的 CDockablePane 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T00:14:37.977

检查[BCGSoft](http://www.bcgsoft.com/samples/docview.htm)示例以使用 cview 执行此操作。类名略有不同，但它们或多或少是相同的东西，因为它们向 Microsoft 提供了 CDockablePane。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-25T23:32:16.920

我在 MFC Feature Pack 示例中找不到此类示例。

所有包含 CFormView 的项目是：

TasksPane TabControl TabbedView StatusBarDemo SetPaneSize MenuSubSet

但是在任何项目中，CFormView 都没有嵌入到 CDockablePane 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-30T21:18:11.027

这辆出租车可能是个线索。

[http://www.codeproject.com/KB/toolbars/sizecbar.aspx](http://www.codeproject.com/KB/toolbars/sizecbar.aspx)

虽然它没有使用 CDockablePane，但其背后的概念是相同的。我还没有尝试过页面中解释的 CDockablePane 和 CFormView 工作，但看了一眼，我觉得事情很相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T15:26:33.930

有一个功能包示例可以执行此操作。

但是，我所做的如下：我创建了一个 CDialog 派生类，并将其放入 DockablePane 中。然后我创建了一个 CFormView 派生类，并将该类的一个实例作为可停靠窗格的成员变量。我感兴趣的每个函数（很可能是 UpdateView() 或任何它的名称），我都会转发到 CDialog 派生类。这样我就可以避开将文档/视图结构硬塞到我的应用程序中的困难，并且仍然可以获得好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T19:54:08.890

实际上有几种方法可以做到这一点。

如果您派生自己的 CFameWnd 类，然后将该类的实例放在 CDockable 窗格中，您现在可以将所需的任何类型的框架放入该 CFrameWnd 派生类中。

诀窍是确保您以正确的顺序进行创建。如果您尝试尽早调用它，那么您的内部视图将永远不会被创建。

# interpreter - 为什么要使用目标语言编写语言解释器？

> ID：276432
> 
> 赞同：7
> 
> 时间：2008-11-09T20:25:31.387
> 
> 标签：interpreter

> **可能重复：**
> [引导语言](https://stackoverflow.com/questions/13537/bootstrapping-a-language)

为以目标语言编写的给定语言（例如[PyPy](http://en.wikipedia.org/wiki/PyPy)）配备解释器的重要性是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T20:45:38.040

与其说是自己编写解释器，不如说是用高级语言而不是 C 语言编写解释器。理想情况下，这样做可以更改实现的细节，并使解释器更加模块化。

对于 PyPy 的特定情况，在 (R)Python 中编写解释器和核心对象允许为目标（C、JVM、.NET、JavaScript 等）重新定位 PyPy，还允许替换垃圾收集器等方面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T20:35:45.860

我确信这样做有很多不同的原因。在某些情况下，这是因为你真的相信语言是最好的工具......所以用语言本身编写语言解释器或编译器可以被视为一种狗食形式。如果您真的对这个主题感兴趣，那么下面的文章是一篇关于 squeak 发展的非常精彩的读物。当前版本的 squeak 是一个用 smalltalk 编写的 smalltalk 运行时。

[http://users.ipa.net/~dwighth/squeak/oopsla_squeak.html](http://users.ipa.net/~dwighth/squeak/oopsla_squeak.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-08T05:56:29.343

这样，您可以证明目标语言是严肃的事情，因为能够使其编译某些东西表明它是一门好语言。

好的，C++ 和 Java 也产生编译器......所以也许这个论点只是看起来的一半。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T18:53:25.493

另一个好处是，如果您为目标语言实现了良好的调试器和 IDE，它们也适用于您的源语言。

# .net - 您认为切换到实体框架是否有利？

> ID：276433
> 
> 赞同：25
> 
> 时间：2008-11-09T20:25:43.697
> 
> 标签：.net, linq-to-sql, entity-framework, ado.net

使用 LINQ to SQL 很可能不会像实体框架那样获得积极的开发，您认为最好切换到实体框架吗？

与感觉非常自然的 LINQ to SQL 相比，我个人发现 EF 非常笨重且难以使用。

编辑：我最近在我的博客上发表了一篇关于我对这个潜在决定的感受的文章......

[ADO.NET v LINQ to SQL](http://weblogs.asp.net/chadmoran/archive/2008/11/09/ado-net-v-linq-to-sql.aspx)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-09T20:28:25.937

IMO，目前没有。

很明显（特别是从[最近的公告](http://blogs.msdn.com/adonet/archive/2008/10/31/clarifying-the-message-on-l2s-futures.aspx)来看）EF 正在进行一些重大修订，因为LINQ-to-SQL 和 EF 之间出现了“[雷电”场景。](http://codebetter.com/blogs/ian_cooper/archive/2008/11/03/linq-to-sql-ef-and-the-thunderdome-solution.aspx)无论发生什么，EF（几年后）几乎肯定会与今天的 EF 完全不同。或者当然“足够不同”；-p

因此，我的观点是：坚持简单。简单的是 LINQ-to-SQL。

如果我知道它很快就会改变，那么学习一个臭名昭著的复杂系统并没有多大好处。

在 LINQ-to-SQL 上，我 100% 支持你；-p

如果我现在需要的不仅仅是 LINQ-to-SQL，我会考虑[NHibernate](http://www.nhibernate.org/)或者[LLBLGen Pro](http://www.llblgen.com/)。

（**编辑**——作为更新，我的立场有所软化，[在这里](http://marcgravell.blogspot.com/2008/12/entity-framework-in-reality.html)和[这里](http://marcgravell.blogspot.com/2009/03/back-to-coal-face.html)——但我仍然使用 LINQ-to-SQL 作为我的主要工具；另外——LINQ-to-SQL[还没有完全消亡](http://marcgravell.blogspot.com/2009/02/linq-to-sql-not-quite-dead-yet.html)；- p)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T09:04:37.313

我已经完成了一些 MVC 项目，现在在生产环境中使用 L2SQL 并发现它使用起来非常愉快。我现在正在着手一个新项目，并决定使用 EF 和 L2EF 编写它，因为之前引用的文章宣称 L2SQL 已死。仅仅几天后，我决定回到 L2SQL。简单的事情，比如必须使用下面显示的糟糕语法或不必要的查找来为插入设置外键，这让我感到震惊。

```
foo.Foreign_TypeReference.EntityKey = 
     new EntityKey("DataContextName.Foreign_Type", "Foreign_Type_Id", ForeignTypeId); 
```

而不是：

```
foo.Foreign_Type_Id = ForeignTypeId; 
```

我认为将 L2SQL 移植到 EF 的未来版本并不难，因为 L2SQL 具有功能的子集（尽管实现得更好）。L2SQL 拥有而 L2EF 没有的一些东西，例如 Single() 和 SingleOrDefault()，可以通过创建一些扩展方法迁移到 EF。我认为使用 L2SQL 让系统运行并在以后 EF 不那么臭时将其移植过来将花费更少的时间。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T00:41:09.603

如果您正在进行数据库驱动的开发，那么 EF 在今天具有真正的优势。

我同时使用了 LINQ to SQL 和 EF，并克服了 EF v1 的许多小挫折。

然而，让 EF v1 为我赢得胜利的一件事是**来自数据库**向导的惊人的好更新。令人难以置信的是，这*确实有效*！这听起来可能微不足道，但如果您正在进行数据库优先设计，您希望依靠工具为您创建类，并且您不希望仅仅为了进行更改而重新生成整个模型。

仅此一项就使 EF v1 成为我的选择。我建议忽略 EF v1 的高级功能——它远没有作为它目标的雄心勃勃的平台可用。

忍受 EF v1 的笨拙，您将处于未来的最佳位置。

皮特。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T03:36:34.847

我必须同意 Marc Gravell 的观点。*可能*下一个版本的Entity Framework（.net 4.0 / VS2010）发布时，使用EF会有优势，到那时它可能与当前版本的EF有很大的不同。

在那之前，至少我会避免像瘟疫一样的 EF，除了永远不会投入生产的测试/实验代码。

[EF msdn 论坛](http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=533&SiteID=1)充满了关于为什么 EF 还没有为黄金时段做好准备的例子，但我有[一个特别的例子](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3874607&SiteID=1)是一个明显的赢家——通常是一个简单的五表查询（10-15 行 SQL）使用 EF 和 EntityDataSource 控件时变为[>1500 行 SQL ：](http://paste-it.net/public/q6ed5c2/)

[http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3874607&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3874607&SiteID=1)

[http://paste-it.net/public/q6ed5c2/](http://paste-it.net/public/q6ed5c2/)

至于 EF 的未来——随着微软在一夜之间[改变重大战略方向的历史](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4100399&SiteID=1#4107623)，谁知道他们目前与 EF 的“战略目标”是否会在几年后实现..？我肯定不会赌它。看：

[http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4100399&SiteID=1#4107623](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4100399&SiteID=1#4107623)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-09T20:41:05.367

为了记录，这里表达了对 LINQ to SQL 未来的一些犹豫：

[LINQ to SQL 是 DOA 吗？](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)

[微软真的杀死了 LINQ to SQL 吗？](https://stackoverflow.com/questions/253263/has-microsoft-really-killed-linq-to-sql)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-19T14:38:17.427

除非您使用 SQL Server（或 SQL Server compact），否则 LINQ to SQL 似乎不是一个选项，所以这足以让我避免使用它并使用 EF（我想使用 PostgreSQL）。

EF v1 中肯定有足够多的东西让我犹豫是否推荐它。听起来 EF 的第 2 版（发布时）将是第一个可以认真推荐切换到的版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-09T20:38:01.410

很多有经验的开发人员都给出了“ [ADO .NET Entity Framework 不信任投票”，这将](http://efvote.wufoo.com/forms/ado-net-entity-framework-vote-of-no-confidence/)[在此处](http://blogs.zdnet.com/microsoft/?p=1457)进一步讨论。

我认为我们期望ADO.Net 团队在[.Net 4.0中对其进行显着改进。](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)

这是最近 PDC 的一些[视频](http://channel9.msdn.com/pdc2008/TL20/)。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-24T13:02:20.057

最近，我不得不研究应该使用哪个 ORM 项目。起初 - 尝试 L2S。它一点也不差，但它已经过时了（MS 将不再支持它），这就是我开始检查 L2E 的原因。我对生成的代码很好，但是创建假视图、实体和它们之间的映射只是为了使存储过程可用而不是填充实体的所有字段，这对我来说太过分了。而且我想分离我的数据访问层，所以 - 我必须将数据从生成的对象映射到我制作的对象。

我花了几个小时试验 NHibernate+Fluent NHibernate+LINQ to NHibernate
来坚持这种组合。

# python - 使用 Python 将 PDF 转换为 HTML

> ID：276434
> 
> 赞同：24
> 
> 时间：2008-11-09T20:26:00.933
> 
> 标签：python, html, apache, pdf

如何使用 Python 将 PDF 文件转换为 HTML？

我在单独考虑 Google 所做的（或似乎要做的）索引 PDF 文件的工作。

我的最终目标是设置 Apache 以显示 PDF 文件的 HTML，因此任何引导我朝这个方向发展的东西也将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T20:34:05.240

[poppler](http://poppler.freedesktop.org/)包提供了一个您可以使用的 pdf2html 实用程序。还有一个与 libpoppler的[Python 绑定。](https://code.launchpad.net/poppler-python)

# php - 如何保持具有 url 路由目录独立的网站

> ID：276443
> 
> 赞同：8
> 
> 时间：2008-11-09T20:30:35.590
> 
> 标签：php, url-routing

我正在开发一个使用 url 路由的 PHP 网站。我希望该站点独立于目录，以便可以将其从[http://site.example.com/](http://site.example.com/)移动到[http://example.com/site/](http://example.com/site/)而无需更改 HTML 中的每个路径。当我链接到不受路由影响的文件时，问题就出现了，比如 css 文件、图像等。

例如，假设`index`控制器动作的视图`welcome`包含图像`img/banner.jpg`。如果使用 url [http://site.example.com/welcome](http://site.example.com/welcome)请求页面，浏览器将请求图像为[http://site.example.com/img/banner.jpg](http://site.example.com/img/banner.jpg)，这很好。但是，如果页面是通过 url [http://site.example.com/welcome/index](http://site.example.com/welcome/index)请求的，浏览器会认为这`welcome`是一个目录，并会尝试以[http://site.example.com/welcome获取图像/img/banner.jpg](http://site.example.com/welcome/img/banner.jpg)，这显然是错误的。

我已经考虑了一些选项，但它们对我来说似乎都不完美：

*   **使用 url 重写将来自 ( *.css** | ***.js** |...) 或 ( **css/*** | **js/*** |...) 的请求重定向到正确的路径。

    *问题*：每个扩展都必须在重写规则中命名。如果有人要添加新的文件类型（例如 mp3 文件），它不会被重写。

*   使用 php 函数为每个相对路径添加基本路径。例如：
    `<img src="<?php echo url::base(); ?>img/banner.jpg" />`

    *问题*：看起来很乱；**包含路径的css** - 和**js** -文件必须由 PHP 处理。

那么，如何保持网站目录的独立性？有没有比我想出的更好/更清洁的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T20:32:43.243

你可以放在头上

```
<base href="<?php echo url::base(); ?>" /> 
```

这意味着浏览器将请求与该路径相关的任何非绝对 URL。~~但是我不确定这将如何影响嵌入在 CSS 文件等中的 URL。~~这不会影响 CSS 文件中定义的路径。（感谢 mooware）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T13:37:38.073

这个`<base>`东西会起作用，但你需要记住它`<a>`也会影响你的标签。考虑这个例子：

```
<!-- this page is http://oursite.com/index.html -->
<html>
 <head>
    <base href="http://static.oursite.com/" />
 </head>
 <body>
    <img src="logo.gif" alt="this is http://static.oursite.com/logo.gif" />
    <a href="/login">this links to http://static.oursite.com/login which is not what we wanted.  we wanted http://oursite.com/login</a>
 </body>
</html> 
```

如果您使用 PHP 函数调用来创建链接，那将不是问题，因为您只需确保它输出绝对 URL。但是，如果您（或您的设计师）对标签进行手工编码，`<a>`那么您又会遇到同样的问题，只是现在使用`<a>`而不是`<img>`.

编辑：我应该添加上面的段落是假设您像我们一样从不同的主机名提供图像。如果你不这样做，那么显然这不会是一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T21:31:27.387

tomhaigh 有一个很好的观点，值得进一步调查。

根据[MSDN](http://msdn.microsoft.com/en-au/library/ms535191(VS.85).aspx)，[基本](http://msdn.microsoft.com/en-au/library/ms535191(VS.85).aspx)标签适用于所有外部资源，包括样式表、图像等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T22:30:17.843

也许我错过了一些东西，但你不能做我（我认为其他人）做的事吗？即将你所有的图片、css、javascripts等放在一个公共目录中，即：

```
/inc/images/
/inc/css/
/inc/javascript/
etc 
```

然后使用基本相对 URL 引用它们，即：

```
<img src="/inc/images/foo.jpg" />
etc 
```

?

# html - 使用 safari 链接到网络共享

> ID：276464
> 
> 赞同：1
> 
> 时间：2008-11-09T20:46:03.670
> 
> 标签：html, safari

我正在尝试动态生成指向网络共享上的文件的链接，该链接可在 IE 和 safari 中使用。在 IE 中，`href=\\networksharename\foldername\filename`工作正常，我们在最初的测试中认为这在 safari 上运行良好，但是我们的 safari 用户报告页面无法显示。这些是pdf文件。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T21:10:03.327

首先，您应该将反斜杠 (\) 替换为斜杠 (/)。完整的 URL 也可能会有所帮助（类似于 smb://server/shared-folder/...），但我不知道您有什么共享。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T21:05:10.387

股票在 DFS 上吗？MacOS 不支持 DFS。

# open-source - 跨平台、多语法高亮编辑器

> ID：276465
> 
> 赞同：1
> 
> 时间：2008-11-09T20:46:35.587
> 
> 标签：open-source, syntax, editor

有没有这样的编辑器：

1.  至少适用于 windows 和 linux
2.  突出显示同一文档中的多个语法。（阿拉织梦者）
3.  选项卡式界面

我尝试的所有编辑器都仅通过文件扩展名突出显示，但粒度不够细。至少它需要将脚本与同一文档中的 html、css 和 javascript 区分开来。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T20:58:30.137

[赛特！](http://www.scintilla.org/SciTE.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T21:15:56.123

答案是emacs。你几乎可以用那个编辑器做任何你想做的事情。有一个“nxhtml 模式”，您可以使用它来编辑同一文件上的 javascript、php、html、ruby、jsp、css 等。如果你还在上大学，我能给你的最好建议是开始学习如何使用 emacs。它会改变你的生活，真的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T20:50:35.410

*   Eclipse（非常好，但很重）
*   vim（没有标签，但是非常轻巧且非常好）
*   emacs（只听说非常好，但是学习曲线很陡）

跳它有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T20:51:47.513

网豆。

不过，我只在同一个文件中对两种语言的 HTML av Javascript 进行了尝试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T21:00:33.720

我用过[jedit](http://www.jedit.org/)。只需要一个java运行时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T23:30:32.247

处理多语言文件的语法高亮和补全是 NetBeans 人员一直在努力的事情，并且自 6.1起就可[用于 javascript 。](http://wiki.netbeans.org/JavaScript#section-JavaScript-EmbeddedCompletion)我从[JavaPosse#214](http://javaposse.com/index.php?post_id=398366)得到的印象是，这在 6.5 中得到了进一步的改进。

我自己不是 Netbeans（我的主要工具是 Emacs 和 Eclipse），但它可能值得你看看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T09:44:34.410

[赛特](http://www.scintilla.org/SciTEDownload.html)FTW！！！甚至不需要安装！一个可移植的单个 exe。

# java - 使用序列图编码

> ID：276472
> 
> 赞同：4
> 
> 时间：2008-11-09T21:04:41.807
> 
> 标签：java, uml, sequence-diagram

当我在大学时，一位讲师说有些人如何设法使用序列图进行编码，这对我来说似乎是一种很好的编程方式，但当然魔鬼在细节中。我有几个问题。

*   这是真的发生还是我误解了他所说的？
*   这里有人真的这样做过吗？
*   是不是更有生产力？
*   有什么缺点？
*   使用 Java 时需要哪些工具？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-09T21:09:43.763

我发现“正常”序列图几乎总是比它们的价值更痛苦（尽管我发现它们对于在 LINQ 中显示数据流很有用）。根据我的经验，做一个“粗略和准备好的”图表并解释它（最好是亲自进行，但无论哪种方式都有大量的文字）效果更好。

我认为有一个（或多个）图表来显示您的应用程序的一种“垂直切片”是一个好主意——每一层如何与另一层通信，并可能在合适的情况下显示请求/响应的过程。但是，这并不需要处于“单独的方法调用且始终 100% 准确”的级别——确保您传达正确的总体印象更为重要，前提是读者可以深入了解真实代码。

说了这么多，我对UML的看法大体上是一样的，所以如果你是精确图表的忠实粉丝，总是一丝不苟地与现实保持同步等，那就用一点盐吧:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T21:31:43.890

我认为序列图是可视化复杂的多线程程序的最佳方式之一，其中有大量消息在线程之间传递。我在设计中很少使用它们，但有时它们是最好的调试方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T17:40:35.183

我发现序列图不适合实际应用，因为：

1.  当有一个控制线程时，我可以很好地使用英语大纲来解释从层到层的调用层次结构。MS Word 中的大纲样式在这里做得很好。

2.  我的英文解释比 UML 图片更详细，占用的空间更少。

3.  用英语，我可以比序列图更好地解释其他细节，例如保护条件和循环。

4.  我可以比绘制 UML 更快地写出大纲。

如果你真的需要这么详细的“图片”，也许活动图就可以了。

另一方面，序列图非常适合高级概述。

就 Java 而言，我的项目团队非常喜欢[Jude](http://jude.change-vision.com/jude-web/index.html)，因为它可以对 Java 5 代码库的类层次结构进行逆向工程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T21:52:17.140

序列图将显示交互，这通常是通过代码的单一路径。另一方面，您的代码必须定义每条路径，每个 if-then-else 和边缘条件等。您*可以*在序列图上显示所有这些东西，但它们往往变得过于复杂和笨拙。我建议您在设计阶段使用序列图来帮助可视化您的代码，如果这对您有用的话，但您可能应该这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-07T21:15:50.637

序列图有它们的位置。我从不担心保持 UML 图与代码更改同步。话虽如此，我非常喜欢使用序列图作为头脑风暴工具。您希望您的团队理解并就底层流程和调用结构达成一致。当您还跟踪参数和实例创建时，它可以突出您理解中的漏洞。如果你需要数据'x'作为参数，它要么已经是本地的，要么需要传入，“我们正在从数据库中请求报表数据，它需要我们发送报表类型，我们记得把它作为一个传入参数，对吧？

这适用于设计的高级传递。之后，它可以作为后来者的通用文档。他们会明白你的目标，当他们看到代码时，他们不会对这些变化感到困惑。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-11-10T22:14:46.207

序列图适用于过程语言。它们对 OO 语言没有那么有用。

# java - java的跨类可扩展静态分析工具？

> ID：276476
> 
> 赞同：4
> 
> 时间：2008-11-09T21:08:35.293
> 
> 标签：java, multithreading, annotations, static-analysis

我正在尝试编写规则来检测带*注释*的多线程 Java 程序中的一些错误。作为一个玩具示例，我想检测是否有任何用 @ThreadSafe 注释的方法调用了没有这种注释的方法，没有同步。我正在寻找一种工具，可以让我编写这样的测试。

我看过源分析器，例如 CheckStyle 和 PMD，它们并没有真正的跨类分析功能。字节码分析器，如 FindBugs 和 JLint 似乎很难扩展。

我愿意为更简单的事情找到一个解决方案，但也带来了同样的困难：编写一个*自定义*规则来检查每个被覆盖的方法是否使用@Override 进行注释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-20T12:33:04.793

你试过[FindBugs](http://findbugs.sourceforge.net/)吗？它实际上支持一组[用于线程安全的注释（与](http://www.javaconcurrencyinpractice.com/annotations/doc/net/jcip/annotations/package-summary.html)[Java Concurrency in Practice](http://www.javaconcurrencyinpractice.com)中使用的相同）。此外，您可以编写自己的自定义规则。我不确定您是否可以进行跨类分析，但我相信可以。

[Peter Ventjeer](http://pveentjer.wordpress.com)有一个[并发检查工具](http://pveentjer.wordpress.com/2008/05/26/the-concurrency-detector/)（使用 ASM）来检测这样的东西。我不确定他是否公开发布了它，但他可能会帮助你。

而且我相信[Coverity 的](http://www.coverity.com/)线程安全静态/动态分析工具会像这样进行检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:26:47.157

您可以[在 PMD 中进行跨类分析](http://pmd.sourceforge.net/howtowritearule.html#I_want_to_implement_a_rule_that_analyse_more_than_the_class__)（尽管我从未将它用于此特定目的）。我认为可以使用他们记录的这种访问者模式，但我会将细节留给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T15:45:58.767

一个检查注释的简单工具是 apt（[http://java.sun.com/j2se/1.5.0/docs/guide/apt/](http://java.sun.com/j2se/1.5.0/docs/guide/apt/)也是 javax.annotation.processing 中 Java 6 api 的一部分）但是这只有类型信息（即，我找不到使用 javax.lang.model api 获取继承层次结构的快速方法，但是如果您可以加载类，则可以使用反射获取该信息）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T16:01:56.973

尝试 javap + 正则表达式（例如 Perl）

# javascript - Javascript：如何验证格式为 MM-DD-YYYY 的日期？

> ID：276479
> 
> 赞同：35
> 
> 时间：2008-11-09T21:10:32.967
> 
> 标签：javascript, validation, date

我在这里看到了一个潜在的答案，但那是针对 YYYY-MM-DD: [JavaScript date validation](http://paulschreiber.com/blog/2007/03/02/javascript-date-validation/)

我像这样为 MM-DD-YYYY 修改了上面的代码，但我仍然无法让它工作：

```
String.prototype.isValidDate = function() 
{
     var IsoDateRe = new RegExp("^([0-9]{2})-([0-9]{2})-([0-9]{4})$");
     var matches = IsoDateRe.exec(this);
     if (!matches) return false;
     var composedDate = new Date(matches[3], (matches[1] - 1), matches[2]);
     return ((composedDate.getMonth() == (matches[1] - 1)) &&
      (composedDate.getDate() == matches[2]) &&
      (composedDate.getFullYear() == matches[3]));
} 
```

如何让上述代码适用于 MM-DD-YYYY 以及更好的 MM/DD/YYYY？

谢谢。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-11-09T22:57:15.887

```
function isValidDate(date)
{
    var matches = /^(\d{1,2})[-\/](\d{1,2})[-\/](\d{4})$/.exec(date);
    if (matches == null) return false;
    var d = matches[2];
    var m = matches[1] - 1;
    var y = matches[3];
    var composedDate = new Date(y, m, d);
    return composedDate.getDate() == d &&
            composedDate.getMonth() == m &&
            composedDate.getFullYear() == y;
}
console.log(isValidDate('10-12-1961'));
console.log(isValidDate('12/11/1961'));
console.log(isValidDate('02-11-1961'));
console.log(isValidDate('12/01/1961'));
console.log(isValidDate('13-11-1961'));
console.log(isValidDate('11-31-1961'));
console.log(isValidDate('11-31-1061')); 
```

有用。（使用 Firebug 测试，因此使用了 console.log()。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-12-05T18:53:28.383

```
function isValidDate(date) {
        var valid = true;

        date = date.replace('/-/g', '');

        var month = parseInt(date.substring(0, 2),10);
        var day   = parseInt(date.substring(2, 4),10);
        var year  = parseInt(date.substring(4, 8),10);

        if(isNaN(month) || isNaN(day) || isNaN(year)) return false;

        if((month < 1) || (month > 12)) valid = false;
        else if((day < 1) || (day > 31)) valid = false;
        else if(((month == 4) || (month == 6) || (month == 9) || (month == 11)) && (day > 30)) valid = false;
        else if((month == 2) && (((year % 400) == 0) || ((year % 4) == 0)) && ((year % 100) != 0) && (day > 29)) valid = false;
        else if((month == 2) && ((year % 100) == 0) && (day > 29)) valid = false;
        else if((month == 2) && (day > 28)) valid = false;

    return valid;
} 
```

这将检查每个月的有效天数和有效的闰年天数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-04-05T14:08:23.703

如何以“ANY”日期格式验证日期？我一直在使用 DateJS 库并将其添加到现有表单中，以确保我获得按我想要的方式格式化的有效日期和时间。用户甚至可以输入诸如“现在”和“明天”之类的内容，它将被转换为有效日期。

这是 dateJS 库： [http ://www.datejs.com/](http://www.datejs.com/)

这是我写的一个 jQuery 提示： [http ://www.ssmedia.com/utilities/jquery/index.cfm/datejs.htm](http://www.ssmedia.com/utilities/jquery/index.cfm/datejs.htm)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-04T19:42:46.807

我会使用[Moment.js](http://momentjs.com/)来完成这项任务。它使解析日期变得*非常容易*，并且还提供了以正确格式检测无效日期^(1的支持。)例如，考虑[这个例子](http://jsfiddle.net/ygqgz/)：

```
var formats = ['MM-DD-YYYY', 'MM/DD/YYYY']

moment('11/28/1981', formats).isValid()  // true
moment('2-29-2003', formats).isValid()   // false (not leap year)
moment('2-29-2004', formats).isValid()   // true  (leap year) 
```

First`moment(.., formats)`用于根据提供的本地化格式解析输入。然后在`isValid`生成的时刻对象上调用该函数，以便我们可以实际判断它是否是*有效*日期。

这可以用来简单地派生 isValidDate 方法：

```
String.prototype.isValidDate = function() {
    var formats = ['MM-DD-YYYY', 'MM/DD/YYYY'];
    return moment("" + this, formats).isValid();
} 
```

* * *

¹由于我几乎找不到关于此事的评论，我只会将 moment.js 用于[公历](http://en.wikipedia.org/wiki/Gregorian_calendar)涵盖的日期。可能有其他（包括历史或科学）日历的插件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-09T21:40:22.283

我使用这个正则表达式来验证 MM-DD-YYYY：

```
function isValidDate(subject){
  if (subject.match(/^(?:(0[1-9]|1[012])[\- \/.](0[1-9]|[12][0-9]|3[01])[\- \/.](19|20)[0-9]{2})$/)){
    return true;
  }else{
    return false;
  }
} 
```

它将仅匹配有效月份，您可以使用 / - 或 . 作为分隔符。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-09T21:27:43.510

什么不起作用？这是一个经过测试的版本：

```
String.prototype.isValidDate = function()   {

    const match = this.match(/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/);
    if (!match || match.length !== 4) {
        return false
    }

    const test = new Date(match[3], match[1] - 1, match[2]);

    return (
        (test.getMonth() == match[1] - 1) &&
        (test.getDate() == match[2]) &&
        (test.getFullYear() == match[3])
    );
}

var date = '12/08/1984'; // Date() is 'Sat Dec 08 1984 00:00:00 GMT-0800 (PST)'
alert(date.isValidDate() ); // true 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-14T16:05:37.793

此函数将验证日期以查看它是否正确或格式是否正确：DD/MM/YYYY。

```
function isValidDate(date)
{
    var matches = /^(\d{2})[-\/](\d{2})[-\/](\d{4})$/.exec(date);
    if (matches == null) return false;
    var d = matches[1];
    var m = matches[2]-1;
    var y = matches[3];
    var composedDate = new Date(y, m, d);
    return composedDate.getDate() == d &&
           composedDate.getMonth() == m &&
           composedDate.getFullYear() == y;
}
console.log(isValidDate('10-12-1961'));
console.log(isValidDate('12/11/1961'));
console.log(isValidDate('02-11-1961'));
console.log(isValidDate('12/01/1961'));
console.log(isValidDate('13-11-1961'));
console.log(isValidDate('11-31-1961'));
console.log(isValidDate('11-31-1061')); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T21:18:57.253

您可以通过将函数的前两行更改为以下内容来简化它：

```
var matches = this.match(/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/); 
```

或者，只需将 RegExp 构造函数的参数更改为

```
^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-24T17:40:37.213

简单的解决方法

```
var day = document.getElementById("DayTextBox").value;

var regExp = /^([1-9]|[1][012])\/|-([1-9]|[1][0-9]|[2][0-9]|[3][01])\/|-([1][6-9][0-9][0-9]|[2][0][01][0-9])$/;

return regExp.test(day); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-20T11:52:26.657

这是为了验证格式中的日期字符串 dd.mm.yyyy 很容易自定义它。您只需要在 isValidDate() 中调整 pos1 和 pos2。

var dtCh = "."; 变量 minYear=1900;

```
function isInteger(s){
    var i;
    for (i = 0; i < s.length; i++){   
        // Check that current character is number.
        var c = s.charAt(i);
        if (((c < "0") || (c > "9"))) return false;
    }
    // All characters are numbers.
    return true;
}

function stripCharsInBag(s, bag){
    var i;
    var returnString = "";
    // Search through string's characters one by one.
    // If character is not in bag, append to returnString.
    for (i = 0; i < s.length; i++){   
        var c = s.charAt(i);
        if (bag.indexOf(c) == -1) returnString += c;
    }
    return returnString;
}

function daysInFebruary (year){
    // February has 29 days in any year evenly divisible by four,
    // EXCEPT for centurial years which are not also divisible by 400.
    return (((year % 4 == 0) && ( (!(year % 100 == 0)) || (year % 400 == 0))) ? 29 : 28 );
}
function DaysArray(n) {
    for (var i = 1; i <= n; i++) {
        this[i] = 31;
        if (i==4 || i==6 || i==9 || i==11) {
            this[i] = 30;
        }
        if (i==2) {
            this[i] = 29;
        }
   } 
   return this;
}

function isValidDate(dtStr){
    var daysInMonth = DaysArray(12);
    var pos1=dtStr.indexOf(dtCh);
    var pos2=dtStr.indexOf(dtCh,pos1+1);
    var strDay=dtStr.substring(0,pos1);
    var strMonth=dtStr.substring(pos1+1,pos2);
    var strYear=dtStr.substring(pos2+1);
    strYr=strYear;
    if (strDay.charAt(0)=="0" && strDay.length>1) 
        strDay=strDay.substring(1);
    if (strMonth.charAt(0)=="0" && strMonth.length>1) 
        strMonth=strMonth.substring(1);
    for (var i = 1; i <= 3; i++) {
        if (strYr.charAt(0)=="0" && strYr.length>1) 
            strYr=strYr.substring(1);
    }
    month=parseInt(strMonth);
    day=parseInt(strDay);
    year=parseInt(strYr);
    if (pos1==-1 || pos2==-1){
        alert("The date format should be : dd.mm.yyyy");
        return false;
    }
    if (strMonth.length<1 || month<1 || month>12){
        alert("Please enter a valid month");
        return false;
    }
    if (strDay.length<1 || day<1 || day>31 || (month==2 && day>daysInFebruary(year)) || day > daysInMonth[month]){
        alert("Please enter a valid day");
        return false;
    }
    if (strYear.length != 4 || year==0 || year<minYear){
        alert("Please enter a valid 4 digit year after "+minYear);
        return false;
    }
    if (dtStr.indexOf(dtCh,pos2+1)!=-1 || isInteger(stripCharsInBag(dtStr, dtCh))==false){
        alert("Please enter a valid date");
        return false;
    }
    return true;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-14T11:50:07.193

将此函数传递给日期，格式为 //10-10-2012 和对象 ID。

```
function isValidDateFormat(date, id)
{
  var todayDate = new Date();
  var matches = /^(\d{2})[-\/](\d{2})[-\/](\d{4})$/.exec(date);

  if (matches == null)
  {
   if(date != '__-__-____')
    {
      alert('Please enter valid date');
    }
  }
  else
  {
    var day    = 31;
    var month  = 12;
    var b_date = date.split("-");
    if(b_date[0] <= day)
    {
      if(b_date[1] <= month)
      {
        if(b_date[2] >= 1900 && b_date[2] <= todayDate.getFullYear())
        {
          return true;
        }
        else
        {
          $("#"+id).val('');
          alert('Please enter valid Year'); 
        }         
      }
      else
      {
        $("#"+id).val('');
        alert('Please enter valid Month');    
      } 
    }
    else
    {
      alert('Please enter valid Day');
      $("#"+id).val('');  
    }
  }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-02-17T21:48:50.437

```
if (document.getElementById('expiryDay').value != test(match("/^([0-9]{2})\/([0-9]{2})$/"))){
     alert("Enter the date in two digit month flowed by two digits year \n");
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-01T13:30:20.520

德语变体，但可以适应 Iso

```
export function isLeapYear(year) {
  return (
    year % 4 === 0 && (year % 100 != 0 || year % 1000 === 0 || year % 400 === 0)
  )
}

export function isValidGermanDate(germanDate) {
  if (
    !germanDate ||
    germanDate.length < 5 ||
    germanDate.split('.').length < 3
  ) {
    return false
  }

  const day = parseInt(germanDate.split('.')[0])
  const month = parseInt(germanDate.split('.')[1])
  const year = parseInt(germanDate.split('.')[2])

  if (isNaN(month) || isNaN(day) || isNaN(year)) {
    return false
  }

  if (month < 1 || month > 12) {
    return false
  }

  if (day < 1 || day > 31) {
    return false
  }

  if ((month === 4 || month === 6 || month === 9 || month === 11) && day > 30) {
    return false
  }

  if (isLeapYear(year)) {
    if (month === 2 && day > 29) {
      return false
    }
  } else {
    if (month === 2 && day > 28) {
      return false
    }
  }

  return true
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-18T06:27:25.637

尝试这个：

```
function validateDate(dates){
    re = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;     
    var days=new Array(31,28,31,30,31,30,31,31,30,31,30,31);

            if(regs = dates.match(re)) {
                    // day value between 1 and 31
                    if(regs[1] < 1 || regs[1] > 31) {                    
                      return false;
                    }
                    // month value between 1 and 12
                    if(regs[2] < 1 || regs[2] > 12) {                         
                      return false;
                    }

                    var maxday=days[regs[2]-1];

                    if(regs[2]==2){
                        if(regs[3]%4==0){
                            maxday=maxday+1;                                
                        }
                    }

                    if(regs[1]>maxday){
                        return false;
                    }

                    return true;
              }else{
                  return false;
              }                   
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-30T15:28:16.737

请在下面的代码中找到可以对任何提供的格式执行日期验证或基于用户区域设置来验证开始/开始和结束/结束日期。可能有一些更好的方法，但已经想出了这个。已针对以下格式对其进行了测试：MM/dd/yyyy、dd/MM/yyyy、yyyy-MM-dd、yyyy.MM.dd、yyyy/MM/dd 和 dd-MM-yyyy。

**注意提供的日期格式和日期字符串齐头并进。**

```
<script type="text/javascript">
function validate(format) {

    if(isAfterCurrentDate(document.getElementById('start').value, format)) {
        alert('Date is after the current date.');
    } else {
        alert('Date is not after the current date.');
    }
    if(isBeforeCurrentDate(document.getElementById('start').value, format)) {
        alert('Date is before current date.');
    } else {
        alert('Date is not before current date.');
    }
    if(isCurrentDate(document.getElementById('start').value, format)) {
        alert('Date is current date.');
    } else {
        alert('Date is not a current date.');
    }
    if (isBefore(document.getElementById('start').value, document.getElementById('end').value, format)) {
        alert('Start/Effective Date cannot be greater than End/Expiration Date');
    } else {
        alert('Valid dates...');
    }
    if (isAfter(document.getElementById('start').value, document.getElementById('end').value, format)) {
        alert('End/Expiration Date cannot be less than Start/Effective Date');
    } else {
        alert('Valid dates...');
    }
    if (isEquals(document.getElementById('start').value, document.getElementById('end').value, format)) {
        alert('Dates are equals...');
    } else {
        alert('Dates are not equals...');
    }
    if (isDate(document.getElementById('start').value, format)) {
        alert('Is valid date...');
    } else {
        alert('Is invalid date...');
    }
}

/**
 * This method gets the year index from the supplied format
 */
function getYearIndex(format) {

    var tokens = splitDateFormat(format);

    if (tokens[0] === 'YYYY'
            || tokens[0] === 'yyyy') {
        return 0;
    } else if (tokens[1]=== 'YYYY'
            || tokens[1] === 'yyyy') {
        return 1;
    } else if (tokens[2] === 'YYYY'
            || tokens[2] === 'yyyy') {
        return 2;
    }
    // Returning the default value as -1
    return -1;
}

/**
 * This method returns the year string located at the supplied index
 */
function getYear(date, index) {

    var tokens = splitDateFormat(date);
    return tokens[index];
}

/**
 * This method gets the month index from the supplied format
 */
function getMonthIndex(format) {

    var tokens = splitDateFormat(format);

    if (tokens[0] === 'MM'
            || tokens[0] === 'mm') {
        return 0;
    } else if (tokens[1] === 'MM'
            || tokens[1] === 'mm') {
        return 1;
    } else if (tokens[2] === 'MM'
            || tokens[2] === 'mm') {
        return 2;
    }
    // Returning the default value as -1
    return -1;
}

/**
 * This method returns the month string located at the supplied index
 */
function getMonth(date, index) {

    var tokens = splitDateFormat(date);
    return tokens[index];
}

/**
 * This method gets the date index from the supplied format
 */
function getDateIndex(format) {

    var tokens = splitDateFormat(format);

    if (tokens[0] === 'DD'
            || tokens[0] === 'dd') {
        return 0;
    } else if (tokens[1] === 'DD'
            || tokens[1] === 'dd') {
        return 1;
    } else if (tokens[2] === 'DD'
            || tokens[2] === 'dd') {
        return 2;
    }
    // Returning the default value as -1
    return -1;
}

/**
 * This method returns the date string located at the supplied index
 */
function getDate(date, index) {

    var tokens = splitDateFormat(date);
    return tokens[index];
}

/**
 * This method returns true if date1 is before date2 else return false
 */
function isBefore(date1, date2, format) {
    // Validating if date1 date is greater than the date2 date
    if (new Date(getYear(date1, getYearIndex(format)), 
            getMonth(date1, getMonthIndex(format)) - 1, 
            getDate(date1, getDateIndex(format))).getTime()
        > new Date(getYear(date2, getYearIndex(format)), 
            getMonth(date2, getMonthIndex(format)) - 1, 
            getDate(date2, getDateIndex(format))).getTime()) {
        return true;
    } 
    return false;                
}

/**
 * This method returns true if date1 is after date2 else return false
 */
function isAfter(date1, date2, format) {
    // Validating if date2 date is less than the date1 date
    if (new Date(getYear(date2, getYearIndex(format)), 
            getMonth(date2, getMonthIndex(format)) - 1, 
            getDate(date2, getDateIndex(format))).getTime()
        < new Date(getYear(date1, getYearIndex(format)), 
            getMonth(date1, getMonthIndex(format)) - 1, 
            getDate(date1, getDateIndex(format))).getTime()
        ) {
        return true;
    } 
    return false;                
}

/**
 * This method returns true if date1 is equals to date2 else return false
 */
function isEquals(date1, date2, format) {
    // Validating if date1 date is equals to the date2 date
    if (new Date(getYear(date1, getYearIndex(format)), 
            getMonth(date1, getMonthIndex(format)) - 1, 
            getDate(date1, getDateIndex(format))).getTime()
        === new Date(getYear(date2, getYearIndex(format)), 
            getMonth(date2, getMonthIndex(format)) - 1, 
            getDate(date2, getDateIndex(format))).getTime()) {
        return true;
    } 
    return false;
}

/**
 * This method validates and returns true if the supplied date is 
 * equals to the current date.
 */
function isCurrentDate(date, format) {
    // Validating if the supplied date is the current date
    if (new Date(getYear(date, getYearIndex(format)), 
            getMonth(date, getMonthIndex(format)) - 1, 
            getDate(date, getDateIndex(format))).getTime()
        === new Date(new Date().getFullYear(), 
                new Date().getMonth(), 
                new Date().getDate()).getTime()) {
        return true;
    } 
    return false;                
}

/**
 * This method validates and returns true if the supplied date value 
 * is before the current date.
 */
function isBeforeCurrentDate(date, format) {
    // Validating if the supplied date is before the current date
    if (new Date(getYear(date, getYearIndex(format)), 
            getMonth(date, getMonthIndex(format)) - 1, 
            getDate(date, getDateIndex(format))).getTime()
        < new Date(new Date().getFullYear(), 
                new Date().getMonth(), 
                new Date().getDate()).getTime()) {
        return true;
    } 
    return false;                
}

/**
 * This method validates and returns true if the supplied date value 
 * is after the current date.
 */
function isAfterCurrentDate(date, format) {
    // Validating if the supplied date is before the current date
    if (new Date(getYear(date, getYearIndex(format)), 
            getMonth(date, getMonthIndex(format)) - 1, 
            getDate(date, getDateIndex(format))).getTime()
        > new Date(new Date().getFullYear(),
                new Date().getMonth(), 
                new Date().getDate()).getTime()) {
        return true;
    } 
    return false;                
}

/**
 * This method splits the supplied date OR format based 
 * on non alpha numeric characters in the supplied string.
 */
function splitDateFormat(dateFormat) {
    // Spliting the supplied string based on non characters
    return dateFormat.split(/\W/);
}

/*
 * This method validates if the supplied value is a valid date.
 */
function isDate(date, format) {                
    // Validating if the supplied date string is valid and not a NaN (Not a Number)
    if (!isNaN(new Date(getYear(date, getYearIndex(format)), 
            getMonth(date, getMonthIndex(format)) - 1, 
            getDate(date, getDateIndex(format))))) {                    
        return true;
    } 
    return false;                                      
} 
```

> 下面是 HTML 片段

```
 <input type="text" name="start" id="start" size="10" value="05/31/2016" />
<br/> 
<input type="text" name="end" id="end" size="10" value="04/28/2016" />
<br/>
<input type="button" value="Submit" onclick="javascript:validate('MM/dd/yyyy');" /> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-31T15:39:59.270

@Adam Leggett 扩展了上面的“Short and Fast”，因为像“02/30/2020”这样的情况`true`应该在`false`. 我真的很喜欢位图...

对于 MM/DD/YYYY 日期格式验证：

```
const dateValid = (date) => {
  const isLeapYear = (yearNum) => {
    return ((yearNum % 100 === 0) ? (yearNum % 400 === 0) : (yearNum % 4 === 0))?
      1:
      0;
  }
  const match = date.match(/^(\d\d)\/(\d\d)\/(\d{4})$/) || [];
  const month = (match[1] | 0) - 1;
  const day = match[2] | 0;
  const year = match[3] | 0;

const dateEval=!( month < 0 ||                     // Before January
      month > 11 ||                    // After December
      day < 1 ||                     // Before the 1st of the month
      day - 30 > (2773 >> month & 1) ||
      month === 1 && day - 28 > isLeapYear(year) 
      // Day is 28 or 29, month is 02, year is leap year ==> true
      );

return `\nDate: ${date}\n\n     
  Valid Date?: ${dateEval}\n
  =======================================`
}

console.log(dateValid('02/28/2020')) // true
console.log(dateValid('02/29/2020')) // true
console.log(dateValid('02/30/2020')) // false
console.log(dateValid('01/31/2020')) // true
console.log(dateValid('01/31/2000')) // true
console.log(dateValid('04/31/2020')) // false
console.log(dateValid('04/31/2000')) // false
console.log(dateValid('04/30/2020')) // true
console.log(dateValid('01/32/2020')) // false
console.log(dateValid('02/28/2021')) // true
console.log(dateValid('02/29/2021')) // false
console.log(dateValid('02/30/2021')) // false
console.log(dateValid('02/28/2000')) // true
console.log(dateValid('02/29/2000')) // true
console.log(dateValid('02/30/2000')) // false
console.log(dateValid('02/28/2001')) // true
console.log(dateValid('02/29/2001')) // false
console.log(dateValid('02/30/2001')) // false 
```

对于 MM-DD-YYYY 日期格式验证：`\/`在模式中替换`match`by `-`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-16T23:47:21.930

短而快。

```
function dateValid(date) {
  var match = date.match(/^(\d\d)-(\d\d)-(\d{4})$/) || [];
  var m = (match[1] | 0) - 1;
  var d = match[2] | 0;
  var y = match[3] | 0;
  return !(
      m < 0 ||                     // Before January
      m > 11 ||                    // After December
      d < 1 ||                     // Before the 1st of the month
      d - 30 > (2773 >> m & 1) ||  // After the 30th or 31st of the month using bitmap
      m == 1 && d - 28 >           // After the 28th or 29th of February depending on leap year
          (!(y % 4) && y % 100 || !(y % 400)));
}

console.log('02-29-2000', dateValid('02-29-2000'));
console.log('02-29-2001', dateValid('02-29-2001'));
console.log('12-31-1970', dateValid('12-31-1970'));
console.log('Hello', dateValid('Hello'));
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-09-23T07:05:58.510

如果您的日期需要匹配 DD.MM.YYYY 并使用 AngularJS，请使用以下代码：

```
$scope.validDate = function(value){
            var matches = /^(\d{1,2})[.](\d{1,2})[.](\d{4})$/.exec(value);
            if (matches == null) return false;
            var d = matches[1];
            var m = matches[2] - 1;
            var y = matches[3];
            var composedDate = new Date(y, m, d);
            return composedDate.getDate() == d &&
                composedDate.getMonth() == m &&
                composedDate.getFullYear() == y;
        };
            console.log($scope.validDate('22.04.2001'));
            console.log($scope.validDate('03.10.2001'));
            console.log($scope.validDate('30.02.2001'));
            console.log($scope.validDate('23.09.2016'));
            console.log($scope.validDate('29.02.2016'));
            console.log($scope.validDate('31.02.2016')); 
```

可以在[此处](https://docs.angularjs.org/guide/scope)找到有关范围对象的更多信息。如果没有 AngularJS，只需将第一行更改为：

```
ValidDate = new function(value) { 
```

并使用以下方法调用它：

```
var MyDate= ValidDate('29.09.2016'); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-02-16T03:43:46.353

DateFormat = DD.MM.YYYY 或 DMYYYY

```
function dateValidate(val){ 
var dateStr = val.split('.'); 
  var date = new Date(dateStr[2], dateStr[1]-1, dateStr[0]); 
  if(date.getDate() == dateStr[0] && date.getMonth()+1 == dateStr[1] && date.getFullYear() == dateStr[2])
  { return date; }
  else{ return 'NotValid';} 
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-08-27T04:32:55.230

```
<!DOCTYPE html>  
<html>  
<head>  

<title></title>  
 <script>
     function dateCheck(inputText) {
         debugger;

         var dateFormat = /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/;

         var flag = 1;

         if (inputText.value.match(dateFormat)) {
             document.myForm.dateInput.focus();

             var inputFormat1 = inputText.value.split('/');
             var inputFormat2 = inputText.value.split('-');
             linputFormat1 = inputFormat1.length;
             linputFormat2 = inputFormat2.length;

             if (linputFormat1 > 1) {
                 var pdate = inputText.value.split('/');
             }
             else if (linputFormat2 > 1) {
                 var pdate = inputText.value.split('-');
             }
             var date = parseInt(pdate[0]);
             var month = parseInt(pdate[1]);
             var year = parseInt(pdate[2]);

             var ListofDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
             if (month == 1 || month > 2) {
                 if (date > ListofDays[month - 1]) {
                     alert("Invalid date format!");
                     return false;
                 }
             }

             if (month == 2) {
                 var leapYear = false;

                 if ((!(year % 4) && year % 100) || !(year % 400)) {
                     leapYear = true;

                 }
                 if ((leapYear == false) && (date >= 29)) {
                     alert("Invalid date format!");
                     return false;
                 }
                 if ((leapYear == true) && (date > 29)) {
                     alert("Invalid date format!");
                     return false;
                 }
             }
             if (flag == 1) {
                 alert("Valid Date");
             }
         }
         else {
             alert("Invalid date format!");
             document.myForm.dateInput.focus();
             return false;
         }
     }
     function restrictCharacters(evt) {

         evt = (evt) ? evt : window.event;
         var charCode = (evt.which) ? evt.which : evt.keyCode;
         if (((charCode >= '48') && (charCode <= '57')) || (charCode == '47')) {
             return true;
         }
         else {
             return false;
         }
     }

 </script>   
</head>

<body>  
    <div>  
        <form name="myForm" action="#">   
            <table>
                <tr>
                    <td>Enter Date</td>
                    <td><input type="text" onkeypress="return restrictCharacters(event);" name="dateInput"/></td>
                    <td></td>
                    <td><span id="span2"></span></td>
                </tr>

                <tr>
                    <td></td>
                    <td><input type="button" name="submit" value="Submit" onclick="dateCheck(document.myForm.dateInput)"  /></td>
                </tr>
            </table>
        </form>  
    </div>   
</body>  
</html> 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2013-04-16T09:43:02.073

```
<script language = "Javascript">
// Declaring valid date character, minimum year and maximum year
var dtCh= "/";
var minYear=1900;
var maxYear=2100;

function isInteger(s){
    var i;
    for (i = 0; i < s.length; i++){   
        // Check that current character is number.
        var c = s.charAt(i);
        if (((c < "0") || (c > "9"))) return false;
    }
    // All characters are numbers.
    return true;
}

function stripCharsInBag(s, bag){
    var i;
    var returnString = "";
    // Search through string's characters one by one.
    // If character is not in bag, append to returnString.
    for (i = 0; i < s.length; i++){   
        var c = s.charAt(i);
        if (bag.indexOf(c) == -1) returnString += c;
    }
    return returnString;
}

function daysInFebruary (year){
    // February has 29 days in any year evenly divisible by four,
    // EXCEPT for centurial years which are not also divisible by 400.
    return (((year % 4 == 0) && ( (!(year % 100 == 0)) || (year % 400 == 0))) ? 29 : 28 );
}
function DaysArray(n) {
    for (var i = 1; i <= n; i++) {
        this[i] = 31
        if (i==4 || i==6 || i==9 || i==11) {this[i] = 30}
        if (i==2) {this[i] = 29}
   } 
   return this
}

function isDate(dtStr){
    var daysInMonth = DaysArray(12)
    var pos1=dtStr.indexOf(dtCh)
    var pos2=dtStr.indexOf(dtCh,pos1+1)
    var strDay=dtStr.substring(0,pos1)
    var strMonth=dtStr.substring(pos1+1,pos2)
    var strYear=dtStr.substring(pos2+1)
    strYr=strYear
    if (strDay.charAt(0)=="0" && strDay.length>1) strDay=strDay.substring(1)
    if (strMonth.charAt(0)=="0" && strMonth.length>1) strMonth=strMonth.substring(1)
    for (var i = 1; i <= 3; i++) {
        if (strYr.charAt(0)=="0" && strYr.length>1) strYr=strYr.substring(1)
    }
    month=parseInt(strMonth)
    day=parseInt(strDay)
    year=parseInt(strYr)
    if (pos1==-1 || pos2==-1){
        alert("The date format should be : dd/mm/yyyy")
        return false
    }
    if (strMonth.length<1 || month<1 || month>12){
        alert("Please enter a valid month")
        return false
    }
    if (strDay.length<1 || day<1 || day>31 || (month==2 && day>daysInFebruary(year)) || day > daysInMonth[month]){
        alert("Please enter a valid day")
        return false
    }
    if (strYear.length != 4 || year==0 || year<minYear || year>maxYear){
        alert("Please enter a valid 4 digit year between "+minYear+" and "+maxYear)
        return false
    }
    if (dtStr.indexOf(dtCh,pos2+1)!=-1 || isInteger(stripCharsInBag(dtStr, dtCh))==false){
        alert("Please enter a valid date")
        return false
    }
return true
}

function ValidateForm(){
    var dt=document.frmSample.txtDateenter code here
    if (isDate(dt.value)==false){
        dt.focus()
        return false
    }
    return true
 }

</script> 
```

# sqlite - 在移动设备上进行全文搜索？

> ID：276489
> 
> 赞同：4
> 
> 时间：2008-11-09T21:20:17.267
> 
> 标签：sqlite, search, windows-mobile, full-text-search, sql-server-ce

我们很快将着手开发新的移动应用程序。这个特定的应用程序将用于大量搜索基于文本的字段。整个小组对哪种数据库引擎最适合在移动平台上进行这些类型的搜索有什么建议吗？

具体包括 Windows Mobile 6，我们将使用 .Net CF。此外，一些基于文本的字段将介于 35 到 500 个字符之间。该设备将以两种不同的方法运行，批处理和 WiFi。当然，对于 WiFi，我们可以将请求提交给一个成熟的数据库引擎，然后再取回结果。这个问题围绕“批处理”版本展开，该版本将包含一个数据库，其中包含有关设备闪存/可移动存储卡的信息。

无论如何，我知道 SQLCE 有一些基本的索引，但是在您获得完整的版本之前，您不会进入真正花哨的“全文”样式索引，而这在移动平台上当然是不可用的。

数据的外观示例：

*“围裙木匠可调节皮革容器口袋腰部五金腰带”*等等等。

我还没有对任何其他具体选项进行评估，因为我认为我会利用这个小组的经验来首先为我指明一些具体的途径。

有什么建议/提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T19:41:03.533

就在最近我遇到了同样的问题。这是我所做的：

我创建了一个类来保存每个对象的 id 和文本（在我的例子中，我称之为 sku（项目编号）和描述）。这会创建一个使用较少内存的较小对象，因为它仅用于搜索。找到匹配项后，我仍然会从数据库中获取完整的对象。

```
public class SmallItem
{
    private int _sku;
    public int Sku
    {
        get { return _sku; }
        set { _sku = value; }
    }

    // Size of max description size + 1 for null terminator.
    private char[] _description = new char[36];
    public char[] Description
    {
        get { return _description; }
        set { _description = value; }
    }

    public SmallItem()
    {
    }
} 
```

创建此类后，您可以创建这些对象的数组（在我的例子中我实际上使用了 List），并使用它在整个应用程序中进行搜索。此列表的初始化需要一些时间，但您只需要在启动时担心这一点。基本上只需在您的数据库上运行查询并获取创建此列表所需的数据。

获得列表后，您可以快速浏览它以搜索您想要的任何单词。由于它是一个包含，它还必须在单词中查找单词（例如，drill 将返回钻头、钻头、钻头等）。为此，我们编写了一个本地开发的非托管 c# contains 函数。它接受一个单词的字符串数组（因此您可以搜索多个单词...我们将其用于“AND”搜索...描述必须包含传入的所有单词...“OR”目前不支持在这个例子中）。当它搜索单词列表时，它会构建一个 ID 列表，然后将其传递回调用函数。获得 ID 列表后，您可以轻松地在数据库中运行快速查询，以根据快速索引 ID 号返回完整的对象。我应该提一下，我们还限制了返回结果的最大数量。这个可以取出来。如果有人输入“e”之类的东西作为他们的搜索词，这很方便。这将返回很多结果。

这是自定义 Contains 函数的示例：

```
public static int[] Contains(string[] descriptionTerms, int maxResults, List<SmallItem> itemList)
{
    // Don't allow more than the maximum allowable results constant.            
    int[] matchingSkus = new int[maxResults];

    // Indexes and counters.
    int matchNumber = 0;
    int currentWord = 0;
    int totalWords = descriptionTerms.Count() - 1;  // - 1 because it will be used with 0 based array indexes

    bool matchedWord;

    try
    {   
        /* Character array of character arrays. Each array is a word we want to match.
         * We need the + 1 because totalWords had - 1 (We are setting a size/length here,
         * so it is not 0 based... we used - 1 on totalWords because it is used for 0
         * based index referencing.)
         * */
        char[][] allWordsToMatch = new char[totalWords + 1][];

        // Character array to hold the current word to match. 
        char[] wordToMatch = new char[36]; // Max allowable word size + null terminator... I just picked 36 to be consistent with max description size.

        // Loop through the original string array or words to match and create the character arrays. 
        for (currentWord = 0; currentWord <= totalWords; currentWord++)
        {
            char[] desc = new char[descriptionTerms[currentWord].Length + 1];
            Array.Copy(descriptionTerms[currentWord].ToUpper().ToCharArray(), desc, descriptionTerms[currentWord].Length);
            allWordsToMatch[currentWord] = desc;
        }

        // Offsets for description and filter(word to match) pointers.
        int descriptionOffset = 0, filterOffset = 0;

        // Loop through the list of items trying to find matching words.
        foreach (SmallItem i in itemList)
        {
            // If we have reached our maximum allowable matches, we should stop searching and just return the results.
            if (matchNumber == maxResults)
                break;

            // Loop through the "words to match" filter list.
            for (currentWord = 0; currentWord <= totalWords; currentWord++)
            {
                // Reset our match flag and current word to match.
                matchedWord = false;
                wordToMatch = allWordsToMatch[currentWord];

                // Delving into unmanaged code for SCREAMING performance ;)
                unsafe
                {
                    // Pointer to the description of the current item on the list (starting at first char).
                    fixed (char* pdesc = &i.Description[0])
                    {
                        // Pointer to the current word we are trying to match (starting at first char).
                        fixed (char* pfilter = &wordToMatch[0])
                        {
                            // Reset the description offset.
                            descriptionOffset = 0;

                            // Continue our search on the current word until we hit a null terminator for the char array.
                            while (*(pdesc + descriptionOffset) != '\0')
                            {
                                // We've matched the first character of the word we're trying to match.
                                if (*(pdesc + descriptionOffset) == *pfilter)
                                {
                                    // Reset the filter offset.
                                            filterOffset = 0;

                                    /* Keep moving the offsets together while we have consecutive character matches. Once we hit a non-match
                                     * or a null terminator, we need to jump out of this loop.
                                     * */
                                    while (*(pfilter + filterOffset) != '\0' && *(pfilter + filterOffset) == *(pdesc + descriptionOffset))
                                    {
                                        // Increase the offsets together to the next character.
                                        ++filterOffset;
                                        ++descriptionOffset;
                                    }

                                    // We hit matches all the way to the null terminator. The entire word was a match.
                                    if (*(pfilter + filterOffset) == '\0')
                                    {
                                        // If our current word matched is the last word on the match list, we have matched all words.
                                        if (currentWord == totalWords)
                                        {
                                            // Add the sku as a match.
                                            matchingSkus[matchNumber] = i.Sku.ToString();
                                            matchNumber++;

                                            /* Break out of this item description. We have matched all needed words and can move to
                                             * the next item.
                                             * */
                                            break;
                                        }

                                        /* We've matched a word, but still have more words left in our list of words to match.
                                         * Set our match flag to true, which will mean we continue continue to search for the
                                         * next word on the list.
                                         * */
                                         matchedWord = true;
                                    }
                                }

                                // No match on the current character. Move to next one.
                                descriptionOffset++;
                            }

                            /* The current word had no match, so no sense in looking for the rest of the words. Break to the
                             * next item description.
                             * */
                             if (!matchedWord)
                                break;
                        }
                    }
                }
            }
        };

        // We have our list of matching skus. We'll resize the array and pass it back.
        Array.Resize(ref matchingSkus, matchNumber);
        return matchingSkus;
    }
    catch (Exception ex)
    {
        // Handle the exception
    }
} 
```

获得匹配 sku 的列表后，您可以遍历数组并构建一个仅返回匹配 sku 的查询命令。

对于性能的想法，这是我们发现的（执行以下步骤）：

*   搜索 ~171,000 项
*   创建所有匹配项目的列表
*   查询数据库，只返回匹配项
*   构建成熟的项目（类似于 SmallItem 类，但更多的领域）
*   使用完整的项目对象填充数据网格。

在我们的移动设备上，整个过程需要 2-4 秒（如果我们在搜索所有项目之前达到匹配限制则需要 2 秒……如果我们必须扫描每个项目则需要 4 秒）。

我也尝试过不使用非托管代码并使用 String.IndexOf （并尝试过 String.Contains... 与 IndexOf 具有应有的性能相同）。这种方式要慢得多……大约 25 秒。

我还尝试使用 StreamReader 和包含 [Sku Number]|[Description] 行的文件。该代码类似于非托管代码示例。整个扫描这种方式大约需要 15 秒。速度还不错，但也不是很好。与我向您展示的方式相比，文件和 StreamReader 方法有一个优势。该文件可以提前创建。我向您展示的方式需要内存和在应用程序启动时加载列表的初始时间。对于我们的 171,000 件商品，这大约需要 2 分钟。如果您有能力在每次应用程序启动时等待初始加载（当然可以在单独的线程上完成），那么以这种方式搜索是最快的方式（至少我已经找到）。

希望有帮助。

PS - 感谢 Dolch 帮助处理一些非托管代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T21:59:44.083

你可以试试 Lucene.Net。我不确定它是否适合移动设备，但它被称为“高性能、全功能的文本搜索引擎库”。

[http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/) [http://lucene.apache.org/java/docs/](http://lucene.apache.org/java/docs/)

# iphone - 带有键盘输入的自定义 UIView？

> ID：276499
> 
> 赞同：1
> 
> 时间：2008-11-09T21:28:55.067
> 
> 标签：iphone, cocoa-touch, keyboard

我有一个用于显示货币值的自定义 UILabel 子类。我只希望用户能够输入数字并让视图将这些数字格式化为货币值——就像收银机一样。这使得 UITextField 不适合这种输入。

我已经覆盖了 hitTest: 以便 UILabel 将返回自身——这显然是一个错误。另外，我已经覆盖了 canBecomeFirstResponder 和 becomeFirstResponder 以返回 YES。但是，这些方法都没有被调用。

我只想让用户输入数字并使用退格键。我已经实现了 UITextInputTraits，但是没有出现键盘。那么，这可以做到吗？如果是这样，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T22:27:04.713

我做过这样的事情。子类 UITextField，使其文本颜色清晰，并在其顶部粘贴标签以显示格式化版本。

编辑-实际上，严格来说，您甚至不需要对其进行子类化。只需实现委托方法 (-textField:shouldChangeCharactersInRange:replacementString:)，将标签添加到 UITextField，然后根据需要设置标签文本的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T23:07:06.757

好的，我已经回答了我自己的问题：放置在 UITextView 顶部的 UILabel 也会隐藏插入点，但仍然可以成为第一响应者并获得输入。

谢谢！

# c# - 通过 .NET DbConnection 连接到 DB2

> ID：276505
> 
> 赞同：3
> 
> 时间：2008-11-09T21:35:57.393
> 
> 标签：c#, .net, db2, dbconnection

我们当前的数据库连接提供程序模型依赖于数据库连接来使用基于 DbConnection (System.Data) 的对象。

我们可以通过 OdbcConnection 连接到 DB2 (*Nix * Windows)，但我们希望允许使用本机 DB2 驱动程序。

有没有办法在不脱离我们当前的 DAL 模型的情况下这样做（.Net 框架、开源或（最后选择）供应商）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T20:58:09.723

还有一种方法在上面的文章中没有提到，那就是使用**DbNetData**，它可以简化数据库访问，并且可以从 .NET 连接到 DB2。源代码托管在下面的 CodePlex 上：

[数据库网络数据](http://dbnetdata.codeplex.com/)

# iphone - 带有嵌入式快速视频的 iPhone UIwebview？

> ID：276510
> 
> 赞同：3
> 
> 时间：2008-11-09T21:38:57.760
> 
> 标签：iphone, cocoa-touch

当我使用 UIWebview 在我的应用程序上加载带有 .MOV 嵌入视频的 HTML 页面时，它会出现一个损坏的图标，知道吗？Iphone Safari 上的相同 HTML 页面工作正常，媒体播放器启动没有问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T20:23:41.437

网页在哪里？它是否嵌入到您的应用程序中？如果你没有给 UIWebView 一个 URL 来从它所在的服务器加载它，请确保你正确设置了 baseURL，以便 webview 知道如何处理相对 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T10:09:24.003

使用应用程序沙箱时，Apple 会阻止 WebKit 访问它的 com.apple.security.WebKit.PluginAgent。

您必须在权利文件中使用适当的权利启用这些

将此行作为数组添加到权利文件中：com.apple.security.temporary-exception.mach-lookup.global-name

在这个数组中添加值：com.apple.security.WebKit.PluginAgent

并且您应该让您的应用程序授予沙盒权限，以便该应用程序可以访问快速电影插件。

希望这会有所帮助，如果这不能解决问题，可能电影不见了……；）

# c - C 中完整的“for”循环语法是什么？

> ID：276512
> 
> 赞同：59
> 
> 时间：2008-11-09T21:40:34.950
> 
> 标签：c, syntax, for-loop

在阅读其他人的代码时，我看到了一些非常奇怪`for`的循环。我一直在尝试为`for`C 中的循环搜索完整的语法解释，但这非常困难，因为“for”一词出现在不相关的句子中，使得搜索几乎不可能有效地谷歌搜索。

[读完这篇](https://stackoverflow.com/questions/260511/russian-peasant-multiplication)文章后，我想到了这个问题，这让我再次感到好奇。

这里`for`：

```
for(p=0;p+=(a&1)*b,a!=1;a>>=1,b<<=1); 
```

中间条件有一个逗号分隔两段代码，这个逗号有什么作用？我理解右侧的逗号，因为它同时表示`a>>=1`和`b<<=1`。

但是在循环退出条件下，会发生什么？它是在何时`p==0`、何时`a==1`或两者都发生时退出？

如果有人能帮助我理解这一点，并可能为我指明完整`for`循环语法描述的方向，那就太好了。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2008-11-09T21:47:03.267

逗号不排除 for 循环；它是逗号运算符。

```
x = (a, b); 
```

将首先执行 a，然后执行 b，然后将 x 设置为 b 的值。

for 语法是：

```
for (init; condition; increment)
    ... 
```

这在某种程度上（暂时忽略`continue`）`break`相当于：

```
init;
while (condition) {
    ...
    increment;
} 
```

因此，您的 for 循环示例（再次忽略`continue`and `break`）等效于

```
p=0;
while (p+=(a&1)*b,a!=1) {
    ...
    a>>=1,b<<=1;
} 
```

就像它一样（再次忽略`continue`and `break`）：

```
p=0; 
while (true) {
    p+=(a&1)*b;
    if (a == 1) break;
    ...
    a>>=1;
    b<<=1;
} 
```

for 循环的两个额外细节，它们不在上面对 while 循环的简化转换中：

*   如果条件被省略，它总是`true`（导致无限循环，除非 a `break`，`goto`，或其他东西打破循环）。
*   A`continue`就像在增量之前转到标签一样，不像`continue`while 循环中的 a 会跳过增量。

此外，关于逗号运算符的一个重要细节：它是一个序列点，例如`&&`and `||`（这就是为什么我可以将它拆分为单独的语句并保持其含义完整的原因）。

* * *

### C99 的变化

C99 标准引入了本解释前面未提及的一些细微差别（这对 C89/C90 非常有用）。

首先，所有循环本身就是块。有效地，

```
for (...) { ... } 
```

本身包裹在一对大括号中

```
{
for (...) { ... }
} 
```

标准说：

> ### ISO/IEC 9899:1999 §6.8.5 迭代声明
> 
> ¶5迭代语句是一个块，其范围是其封闭块范围的严格子集。循环体也是一个块，其范围是迭代语句范围的严格子集。

这也在基本原理中根据额外的大括号进行了描述。

其次，`init`C99 中的部分可以是（单个）声明，如

```
for (int i = 0; i < sizeof(something); i++) { ... } 
```

现在“环绕循环的块”变成了它自己的；它解释了为什么`i`不能在循环外访问变量。您可以声明多个变量，但它们必须是同一类型：

```
for (int i = 0, j = sizeof(something); i < j; i++, j--) { ... } 
```

标准说：

> ### ISO/IEC 9899:1999 §6.8.5.3 for 声明
> 
> 该声明
> 
> ```
> for ( clause-1 ; expression-2 ; expression-3 ) statement 
> ```
> 
> 行为如下： 表达式 expression-2 是在每次执行循环体之前计算的控制表达式。每次执行循环体后，表达式 expression-3 被评估为 void 表达式。如果clause-1 是一个声明，它声明的任何变量的范围是声明的其余部分和整个循环，包括其他两个表达式；它在控制表达式的第一次评估之前按照执行顺序到达。如果 Clause-1 是一个表达式，则在第一次计算控制表达式之前，它会被计算为一个 void 表达式。^(133))
> 
> 子句 1 和表达式 3 都可以省略。省略的表达式 2 被非零常量替换。
> 
> ^(133))因此，第 1 条规定了循环的初始化，可能声明一个或多个变量用于循环；控制表达式 expression-2 指定在每次迭代之前进行的评估，这样循环的执行将继续，直到表达式比较等于 0；而 expression-3 指定在每次迭代后执行的操作（例如递增）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-09T21:46:10.897

逗号只是分隔两个表达式，并且在 C 中允许正常表达式的任何地方都有效。这些是按从左到右的顺序执行的。最右边表达式的值是整个表达式的值。

`for`循环由三部分组成，其中任何部分也可以是空的；一个（第一个）在开始时执行，一个（第三个）在每次迭代结束时执行。这些部分通常分别初始化和增加一个计数器；但他们可以做任何事情。

第二部分是在每次执行开始时执行的*测试。*如果测试产生`false`，则中止循环。这里的所有都是它的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-09T21:57:58.580

C 风格的 for 循环由三个表达式组成：

```
for (initializer; condition; counter) statement_or_statement_block; 
```

*   初始化程序在循环开始时运行一次。
*   在每次迭代之前检查条件。只要计算结果为真，循环就会运行。
*   计数器在每次迭代后运行一次。

这些部分中的每一个都可以是在您编写循环所用的语言中有效的表达式。这意味着可以更有创意地使用它们。任何你想事先做的事情都可以进入初始化程序，你想做的任何事情都可以进入条件或计数器，直到循环不再有主体。

为此，逗号运算符非常方便。它允许您将表达式链接在一起以形成一个新的表达式。大多数情况下，它在 for 循环中以这种方式使用，逗号运算符的其他含义（例如值分配注意事项）起着次要作用。

即使你可以通过创造性地使用语法来做一些聪明的事情——我会保持清醒，直到我找到一个*真正*好的理由这样做。使用 for 循环玩代码高尔夫会使代码更难阅读和理解（和维护）。

维基百科也有[一篇关于 for 循环的好文章](http://en.wikipedia.org/wiki/For_loop)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T14:04:22.537

`for`循环中的所有内容都是可选的。我们可以初始化多个变量，可以检查多个条件，可以使用逗号运算符迭代多个变量。

以下`for`循环将带您进入无限循环。检查条件时要小心。

```
for(;;) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-13T18:11:15.937

Konrad 提到了我要重复的关键点：最右边的表达式的值是整个表达式的值。

当我在 for 循环的“条件”部分中放置两个测试时，Gnu 编译器会发出此警告

```
warning: left-hand operand of comma expression has no effect 
```

我真正想要的“条件”是两个测试之间有一个“&&”。根据 Konrad 的说法，只有逗号右侧的测试会影响条件。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-10-14T11:15:07.350

for 循环是在特定时间执行 for(;;)

for 循环的语法

为了（;;）

或者

for（初始化器；条件；计数器）

例如 (rmv=1;rmv<=15;rmv++)

在 for 块中执行 15 次

1.首先初始化值，因为启动值

（例如）rmv=1 或 rmv=2

2.第二条语句是测试条件为真或假，条件为真执行for循环的次数，条件为假终止块，

例如 i=5;i<=10 条件为真

```
i=10;i<10 the condition is false terminate for block, 
```

3.三是递增或递减

（例如）rmv++ 或 ++rmv

# sql-server - 安装sql server express：VS2008 sp1问题

> ID：276514
> 
> 赞同：0
> 
> 时间：2008-11-09T21:44:18.000
> 
> 标签：sql-server, sql-server-2008, sql-server-express

我正在尝试在我的机器上安装 SQL Server Express 2008。我收到一条错误消息，指出计算机上安装了旧版本的 VS 2008。在安装 Sql server 2008 之前升级到 VS2008 SP1。

我尝试安装 sp1，但收到一条错误消息，提示系统上未检测到与 vs2008 兼容的版本。升级与 Express 版本不兼容。

我在安装我的机器上安装的 sql server 2008 express 时遇到问题，我遇到了问题。请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-07T18:40:54.550

我遇到了与 Ironsavior 描述的相同的问题。我有 VS 2008 SP1 并且没有安装其他 VS（即没有任何 Express 版本。）

[这是我解决](http://devlicio.us/blogs/sergio_pereira/archive/2010/03/07/rule-quot-previous-releases-of-microsoft-visual-studio-2008-quot-failed.aspx)它的方法，基本上是注册表*激励*。我去了注册表项`HKLM\SOFTWARE\Wow6432Node\Microsoft\DevDiv\VS\Servicing\9.0\IDE\1033`并更改了以下值（它们曾经分别是**0**、**0**和**"RTM"**）

```
SP = dword:00000001
SPIndex = dword:00000001
SPName = "SP1" 
```

您甚至无需退出安装程序即可执行此操作。只需在注册表调整后重新运行检查，它应该会通过。至少对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T21:51:01.247

您需要安装完整版的 Visual Studio 2008 才能升级到 Service Pack 1。您应该在 MS 站点上查看特定于 Visual Studio Express 版本的 SP1。

事实上，我不确定，但尝试重新下载 Visual Studio express，它应该已经集成了 SP1。这是一个[链接](http://www.microsoft.com/express/vb/default.aspx)。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-04T18:49:13.953

无需安装完整版的 Visual Studio 2008 即可升级到 Service Pack 1。您可以安装任何带有 sp1 的 Express 版本，最好是 Visual C++ 和 C#。如果您已经在 PC 上安装了它们，请重新安装并删除任何旧版本的 SQL Server Express（添加/删除程序中的 2000 或 2005）。最后，安装 SQL Server 2008 Express；这应该可以解决问题。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-06T01:10:24.403

不管你信不信，SQL Express SP1 更新程序在 SQL Express 上不起作用。如果您使用“完整版 sql 2008 sp1”修补 SQL Express，则可以。我在 2009 年 6 月发现情况就是这样。

# php - 从 URL 解析域

> ID：276516
> 
> 赞同：172
> 
> 时间：2008-11-09T21:44:48.637
> 
> 标签：php

我需要构建一个从 URL 解析域的函数。

所以，随着

```
http://google.com/dhasjkdas/sadsdds/sdda/sdads.html 
```

或者

```
http://www.google.com/dhasjkdas/sadsdds/sdda/sdads.html 
```

它应该返回`google.com`

和

```
http://google.co.uk/dhasjkdas/sadsdds/sdda/sdads.html 
```

它应该返回`google.co.uk`。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2008-11-09T21:48:33.920

签出[`parse_url()`](http://php.net/parse_url)：

```
$url = 'http://google.com/dhasjkdas/sadsdds/sdda/sdads.html';
$parse = parse_url($url);
echo $parse['host']; // prints 'google.com' 
```

`parse_url`不能很好地处理严重损坏的 url，但是如果您通常期望得到不错的 url，那就没问题了。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2009-12-29T11:03:14.990

```
$domain = str_ireplace('www.', '', parse_url($url, PHP_URL_HOST)); 
```

**这将返回`google.com`http://google.com/ [...](http://google.com/)和[http://www.google.com/](http://www.google.com/) ...**

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-12-29T10:58:25.680

来自[http://us3.php.net/manual/en/function.parse-url.php#93983](http://us3.php.net/manual/en/function.parse-url.php#93983)

> 出于某种奇怪的原因，当输入 url 中未提供任何方案时，parse_url 返回主机（例如 example.com）作为路径。所以我写了一个快速函数来获取真正的主机：

```
function getHost($Address) { 
   $parseUrl = parse_url(trim($Address)); 
   return trim($parseUrl['host'] ? $parseUrl['host'] : array_shift(explode('/', $parseUrl['path'], 2))); 
} 

getHost("example.com"); // Gives example.com 
getHost("http://example.com"); // Gives example.com 
getHost("www.example.com"); // Gives www.example.com 
getHost("http://example.com/xyz"); // Gives example.com 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-11-25T14:35:28.587

```
function get_domain($url = SITE_URL)
{
    preg_match("/[a-z0-9\-]{1,63}\.[a-z\.]{2,6}$/", parse_url($url, PHP_URL_HOST), $_domain_tld);
    return $_domain_tld[0];
}

get_domain('http://www.cdl.gr'); //cdl.gr
get_domain('http://cdl.gr'); //cdl.gr
get_domain('http://www2.cdl.gr'); //cdl.gr 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-09-27T17:33:21.773

本来可以 100% 工作的代码似乎并没有为我解决问题，我确实对示例进行了一些修补，但发现代码没有帮助并且存在问题。所以我把它改成了几个函数（为了省去一直从 Mozilla 请求列表，并删除缓存系统）。这已经针对一组 1000 个 URL 进行了测试，并且似乎有效。

```
function domain($url)
{
    global $subtlds;
    $slds = "";
    $url = strtolower($url);

    $host = parse_url('http://'.$url,PHP_URL_HOST);

    preg_match("/[^\.\/]+\.[^\.\/]+$/", $host, $matches);
    foreach($subtlds as $sub){
        if (preg_match('/\.'.preg_quote($sub).'$/', $host, $xyz)){
            preg_match("/[^\.\/]+\.[^\.\/]+\.[^\.\/]+$/", $host, $matches);
        }
    }

    return @$matches[0];
}

function get_tlds() {
    $address = 'http://mxr.mozilla.org/mozilla-central/source/netwerk/dns/effective_tld_names.dat?raw=1';
    $content = file($address);
    foreach ($content as $num => $line) {
        $line = trim($line);
        if($line == '') continue;
        if(@substr($line[0], 0, 2) == '/') continue;
        $line = @preg_replace("/[^a-zA-Z0-9\.]/", '', $line);
        if($line == '') continue;  //$line = '.'.$line;
        if(@$line[0] == '.') $line = substr($line, 1);
        if(!strstr($line, '.')) continue;
        $subtlds[] = $line;
        //echo "{$num}: '{$line}'"; echo "<br>";
    }

    $subtlds = array_merge(array(
            'co.uk', 'me.uk', 'net.uk', 'org.uk', 'sch.uk', 'ac.uk', 
            'gov.uk', 'nhs.uk', 'police.uk', 'mod.uk', 'asn.au', 'com.au',
            'net.au', 'id.au', 'org.au', 'edu.au', 'gov.au', 'csiro.au'
        ), $subtlds);

    $subtlds = array_unique($subtlds);

    return $subtlds;    
} 
```

然后像这样使用它

```
$subtlds = get_tlds();
echo domain('www.example.com') //outputs: example.com
echo domain('www.example.uk.com') //outputs: example.uk.com
echo domain('www.example.fr') //outputs: example.fr 
```

我知道我应该把它变成一堂课，但没有时间。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-06-23T09:15:05.620

如果您想从字符串中提取主机`http://google.com/dhasjkdas/sadsdds/sdda/sdads.html`，则使用 parse_url() 是您可以接受的解决方案。

但是，如果您想提取域或其部分，则需要使用[Public Suffix List](https://publicsuffix.org/)进行打包。是的，您可以在 parse_url() 周围使用字符串函数，但有时会产生不正确的结果。

我推荐[TLDExtract](https://github.com/layershifter/TLDExtract)进行域解析，这里是显示差异的示例代码：

```
$extract = new LayerShifter\TLDExtract\Extract();

# For 'http://google.com/dhasjkdas/sadsdds/sdda/sdads.html'

$url = 'http://google.com/dhasjkdas/sadsdds/sdda/sdads.html';

parse_url($url, PHP_URL_HOST); // will return google.com

$result = $extract->parse($url);
$result->getFullHost(); // will return 'google.com'
$result->getRegistrableDomain(); // will return 'google.com'
$result->getSuffix(); // will return 'com'

# For 'http://search.google.com/dhasjkdas/sadsdds/sdda/sdads.html'

$url = 'http://search.google.com/dhasjkdas/sadsdds/sdda/sdads.html';

parse_url($url, PHP_URL_HOST); // will return 'search.google.com'

$result = $extract->parse($url);
$result->getFullHost(); // will return 'search.google.com'
$result->getRegistrableDomain(); // will return 'google.com' 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-12-31T17:44:21.373

请考虑将已接受的解决方案替换为以下内容：

parse_url() 将始终包含任何子域，因此该函数不能很好地解析域名。这里有些例子：

```
$url = 'http://www.google.com/dhasjkdas/sadsdds/sdda/sdads.html';
$parse = parse_url($url);
echo $parse['host']; // prints 'www.google.com'

echo parse_url('https://subdomain.example.com/foo/bar', PHP_URL_HOST);
// Output: subdomain.example.com

echo parse_url('https://subdomain.example.co.uk/foo/bar', PHP_URL_HOST);
// Output: subdomain.example.co.uk 
```

相反，您可以考虑这种务实的解决方案。它将涵盖许多但不是所有的域名——例如，不涵盖诸如“sos.state.oh.us”之类的较低级别的域。

```
function getDomain($url) {
    $host = parse_url($url, PHP_URL_HOST);

    if(filter_var($host,FILTER_VALIDATE_IP)) {
        // IP address returned as domain
        return $host; //* or replace with null if you don't want an IP back
    }

    $domain_array = explode(".", str_replace('www.', '', $host));
    $count = count($domain_array);
    if( $count>=3 && strlen($domain_array[$count-2])==2 ) {
        // SLD (example.co.uk)
        return implode('.', array_splice($domain_array, $count-3,3));
    } else if( $count>=2 ) {
        // TLD (example.com)
        return implode('.', array_splice($domain_array, $count-2,2));
    }
}

// Your domains
    echo getDomain('http://google.com/dhasjkdas/sadsdds/sdda/sdads.html'); // google.com
    echo getDomain('http://www.google.com/dhasjkdas/sadsdds/sdda/sdads.html'); // google.com
    echo getDomain('http://google.co.uk/dhasjkdas/sadsdds/sdda/sdads.html'); // google.co.uk

// TLD
    echo getDomain('https://shop.example.com'); // example.com
    echo getDomain('https://foo.bar.example.com'); // example.com
    echo getDomain('https://www.example.com'); // example.com
    echo getDomain('https://example.com'); // example.com

// SLD
    echo getDomain('https://more.news.bbc.co.uk'); // bbc.co.uk
    echo getDomain('https://www.bbc.co.uk'); // bbc.co.uk
    echo getDomain('https://bbc.co.uk'); // bbc.co.uk

// IP
    echo getDomain('https://1.2.3.45');  // 1.2.3.45 
```

最后，Jeremy Kendall 的[PHP 域解析器](https://github.com/jeremykendall/php-domain-parser)允许您从 url 解析域名。[League URI Hostname Parser](https://uri.thephpleague.com/domain-parser/1.0/)也将完成这项工作。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-07-21T16:31:54.223

您可以将 PHP_URL_HOST 作为第二个参数传递给 parse_url 函数

```
$url = 'http://google.com/dhasjkdas/sadsdds/sdda/sdads.html';
$host = parse_url($url, PHP_URL_HOST);
print $host; // prints 'google.com' 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-09-10T20:17:34.933

我发现@philfreo 的解决方案（引用自 php.net）非常好，可以得到很好的结果，但在某些情况下，它会显示 php 的“通知”和“严格标准”消息。这是此代码的固定版本。

```
function getHost($url) { 
   $parseUrl = parse_url(trim($url)); 
   if(isset($parseUrl['host']))
   {
       $host = $parseUrl['host'];
   }
   else
   {
        $path = explode('/', $parseUrl['path']);
        $host = $path[0];
   }
   return trim($host); 
} 

echo getHost("http://example.com/anything.html");           // example.com
echo getHost("http://www.example.net/directory/post.php");  // www.example.net
echo getHost("https://example.co.uk");                      // example.co.uk
echo getHost("www.example.net");                            // example.net
echo getHost("subdomain.example.net/anything");             // subdomain.example.net
echo getHost("example.net");                                // example.net 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-05-23T10:16:42.333

这是我制作的代码，它 100% 只找到域名，因为它需要 mozilla sub tlds 来考虑。您唯一需要检查的是如何缓存该文件，因此您不必每次都查询 mozilla。

出于某种奇怪的原因，像 co.uk 这样的域不在列表中，因此您必须进行一些黑客攻击并手动添加它们。它不是最干净的解决方案，但我希望它可以帮助某人。

```
//=====================================================
static function domain($url)
{
    $slds = "";
    $url = strtolower($url);

            $address = 'http://mxr.mozilla.org/mozilla-central/source/netwerk/dns/effective_tld_names.dat?raw=1';
    if(!$subtlds = @kohana::cache('subtlds', null, 60)) 
    {
        $content = file($address);
        foreach($content as $num => $line)
        {
            $line = trim($line);
            if($line == '') continue;
            if(@substr($line[0], 0, 2) == '/') continue;
            $line = @preg_replace("/[^a-zA-Z0-9\.]/", '', $line);
            if($line == '') continue;  //$line = '.'.$line;
            if(@$line[0] == '.') $line = substr($line, 1);
            if(!strstr($line, '.')) continue;
            $subtlds[] = $line;
            //echo "{$num}: '{$line}'"; echo "<br>";
        }
        $subtlds = array_merge(Array(
            'co.uk', 'me.uk', 'net.uk', 'org.uk', 'sch.uk', 'ac.uk', 
            'gov.uk', 'nhs.uk', 'police.uk', 'mod.uk', 'asn.au', 'com.au',
            'net.au', 'id.au', 'org.au', 'edu.au', 'gov.au', 'csiro.au',
            ),$subtlds);

        $subtlds = array_unique($subtlds);
        //echo var_dump($subtlds);
        @kohana::cache('subtlds', $subtlds);
    }

    preg_match('/^(http:[\/]{2,})?([^\/]+)/i', $url, $matches);
    //preg_match("/^(http:\/\/|https:\/\/|)[a-zA-Z-]([^\/]+)/i", $url, $matches);
    $host = @$matches[2];
    //echo var_dump($matches);

    preg_match("/[^\.\/]+\.[^\.\/]+$/", $host, $matches);
    foreach($subtlds as $sub) 
    {
        if (preg_match("/{$sub}$/", $host, $xyz))
        preg_match("/[^\.\/]+\.[^\.\/]+\.[^\.\/]+$/", $host, $matches);
    }

    return @$matches[0];
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-02-06T16:32:02.923

```
function getTrimmedUrl($link)
{
    $str = str_replace(["www.","https://","http://"],[''],$link);
    $link = explode("/",$str);
    return strtolower($link[0]);                
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-10-23T15:50:20.253

```
$domain = parse_url($url, PHP_URL_HOST);
echo implode('.', array_slice(explode('.', $domain), -2, 2)) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-11-29T01:06:40.253

parse_url 对我不起作用。它只返回了路径。使用 php5.3+ 切换到基础：

```
$url  = str_replace('http://', '', strtolower( $s->website));
if (strpos($url, '/'))  $url = strstr($url, '/', true); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-17T11:01:55.100

我为你编辑了：

```
function getHost($Address) { 
    $parseUrl = parse_url(trim($Address));
    $host = trim($parseUrl['host'] ? $parseUrl['host'] : array_shift(explode('/', $parseUrl['path'], 2))); 

    $parts = explode( '.', $host );
    $num_parts = count($parts);

    if ($parts[0] == "www") {
        for ($i=1; $i < $num_parts; $i++) { 
            $h .= $parts[$i] . '.';
        }
    }else {
        for ($i=0; $i < $num_parts; $i++) { 
            $h .= $parts[$i] . '.';
        }
    }
    return substr($h,0,-1);
} 
```

所有类型的 url (www.domain.ltd, sub1.subn.domain.ltd 将导致：domain.ltd。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-09-08T23:51:06.810

我很晚才添加这个答案，因为这是在谷歌上弹出最多的答案......

您可以使用 PHP 来...

```
$url = "www.google.co.uk";
$host = parse_url($url, PHP_URL_HOST);
// $host == "www.google.co.uk" 
```

抓取*主机*，但不抓取主机所指的*私有域。*（示例`www.google.co.uk`是主机，但是`google.co.uk`是私有域）

要获取私有域，您必须知道*可以*注册私有域的公共后缀列表。此列表恰好由 Mozilla 在[https://publicsuffix.org/上策划](https://publicsuffix.org/)

下面的代码在已经创建公共后缀数组时有效。只需调用

```
$domain = get_private_domain("www.google.co.uk"); 
```

剩下的代码......

```
// find some way to parse the above list of public suffix
// then add them to a PHP array
$suffix = [... all valid public suffix ...];

function get_public_suffix($host) {
  $parts = split("\.", $host);
  while (count($parts) > 0) {
    if (is_public_suffix(join(".", $parts)))
      return join(".", $parts);

    array_shift($parts);
  }

  return false;
}

function is_public_suffix($host) {
  global $suffix;
  return isset($suffix[$host]);
}

function get_private_domain($host) {
  $public = get_public_suffix($host);
  $public_parts = split("\.", $public);
  $all_parts = split("\.", $host);

  $private = [];

  for ($x = 0; $x < count($public_parts); ++$x) 
    $private[] = array_pop($all_parts);

  if (count($all_parts) > 0)
    $private[] = array_pop($all_parts);

  return join(".", array_reverse($private));
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-04-10T18:58:48.517

如果输入的 URL 不是完全垃圾，这通常会很好地工作。它删除子域。

```
$host = parse_url( $Row->url, PHP_URL_HOST );
$parts = explode( '.', $host );
$parts = array_reverse( $parts );
$domain = $parts[1].'.'.$parts[0]; 
```

**例子**

输入：`http://www2.website.com:8080/some/file/structure?some=parameters`

输出：`website.com`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-06-13T13:34:56.700

**将worldofjr**和**Alix Axel**的答案组合成一个可以处理大多数用例的小函数：

```
function get_url_hostname($url) {

    $parse = parse_url($url);
    return str_ireplace('www.', '', $parse['host']);

}

get_url_hostname('http://www.google.com/example/path/file.html'); // google.com 
```

* * *

## 回答 #18

> 赞同：-6
> 
> 时间：2014-12-28T10:51:44.337

就像下面这样使用...

```
<?php
   echo $_SERVER['SERVER_NAME'];
?> 
```

# guid - 为什么 GUID 结构是这样声明的？

> ID：276524
> 
> 赞同：15
> 
> 时间：2008-11-09T21:48:17.350
> 
> 标签：guid

在 rpc.h 中，GUID 结构声明如下：

```
typedef struct _GUID 
{  
   DWORD Data1;  
   WORD Data2;  
   WORD Data3;  
   BYTE Data[8];
} GUID; 
```

我了解 Data1、Data2 和 Data3。它们在写出 GUID (XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXX) 时定义了第一组、第二组和第三组十六进制数字。

我从来不明白为什么最后两组在同一个字节数组中一起声明。这不是更有意义（并且更容易编码）吗？

```
typedef struct _GUID 
{  
   DWORD Data1;  
   WORD Data2;  
   WORD Data3;  
   WORD Data4;  
   BYTE Data5[6]; 
} GUID; 
```

有谁知道为什么要这样声明？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-10T05:26:28.767

[这是因为 GUID 是UUID](http://en.wikipedia.org/wiki/UUID)的特例。有关所有字段含义的信息，您可以查看[RFC 4122](http://www.ietf.org/rfc/rfc4122.txt)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T21:49:22.780

[http://en.wikipedia.org/wiki/Globally_Unique_Identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)和[http://www.opengroup.org/onlinepubs/9629399/apdxa.htm（DCE](http://www.opengroup.org/onlinepubs/9629399/apdxa.htm)的原始表示，您可以在表格中看到**位分组）**

# .net - 获取对象的 DataContext

> ID：276531
> 
> 赞同：9
> 
> 时间：2008-11-09T21:50:31.747
> 
> 标签：.net, linq-to-sql, c#-3.0, datacontext

如果我有 LINQ 对象：

```
public class SampleDataContext : DataContext {
    public Table<Customer> Customers { get { return this.GetTable<Customer>(); } }
    public SampleDataContext( string connectionString ) : base( connectionString ) { }
}

[Table( Name="dbo.tblCustomers" )]
public class Customer {
    private Guid? customerID;
    [Column( Storage="customerID", DbType="uniqueidentifier NOT NULL", IsPrimaryKey=true )]
    public Guid? CustomerID {
        get { return this.customerID; }
        set { this.customerID = value; }
    }

    private string customerName;
    [Column( Storage = "customerName", DbType = "nvarchar(255) NOT NULL" )]
    public string CustomerName {
        get { return this.customerName; }
        set { this.customerName = value; }
    }
} 
```

以及应用程序中的其他地方：

```
public static void DoSomethingWithCustomer( Customer customer ) {
    // some operations
    // now, I want save changes to the database
} 
```

如何获取跟踪“客户”对象更改的 DataContext 实例？

**编辑：为什么我不想将 DataContext 传递给方法。**

1) 始终传递 2 个对象而不是 1 个是整个应用程序的“丑陋”模式。

*   每个业务对象的方法都需要下一个参数。
*   收藏将需要从“列表”更改为“列表>”。

这两点将更难维护 - 开发人员必须每次都设置正确的 DataContext 实例（容易创建错误），尽管 DataContext 知道具体对象是否附加到另一个 DataContext。

2）我想要（当前版本的应用程序使用它）处理来自不同“地方”的对象集合的“任何”业务逻辑（例如，通过拖放操作浮动窗口）。

Currentyl 我们使用自定义类型的数据集，因此有关更改的信息位于数据行（DataRow = 业务对象）中，获取它没有问题，或者创建一个克隆然后将其保存到数据库中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-12T11:05:01.230

Kevin - 我感到你的痛苦......当你围绕你的业务对象构建业务逻辑时，有时你只*需要*访问对象所属的 DataContext，因为不知道 DataContext 不得不放置你的代码在降低代码可维护性的地方。

我编写了以下代码（恐怕是 VB），它提供了一个 Context 属性，该属性可以放置在数据对象上，然后用于返回该对象附加到的 DataContext（如果有）。

```
Private Const StandardChangeTrackerName As String = "System.Data.Linq.ChangeTracker+StandardChangeTracker"

Private _context As DataClasses1DataContext
Public Property Context() As DataClasses1DataContext
    Get
        Dim hasContext As Boolean = False
        Dim myType As Type = Me.GetType()
        Dim propertyChangingField As FieldInfo = myType.GetField("PropertyChangingEvent", BindingFlags.NonPublic Or BindingFlags.Instance)
        Dim propertyChangingDelegate As PropertyChangingEventHandler = propertyChangingField.GetValue(Me)
        Dim delegateType As Type = Nothing

        For Each thisDelegate In propertyChangingDelegate.GetInvocationList()
            delegateType = thisDelegate.Target.GetType()
            If delegateType.FullName.Equals(StandardChangeTrackerName) Then
                propertyChangingDelegate = thisDelegate
                hasContext = True
                Exit For
            End If
        Next

        If hasContext Then
            Dim targetField = propertyChangingDelegate.Target
            Dim servicesField As FieldInfo = targetField.GetType().GetField("services", BindingFlags.NonPublic Or BindingFlags.Instance)
            If servicesField IsNot Nothing Then

                Dim servicesObject = servicesField.GetValue(targetField)

                Dim contextField As FieldInfo = servicesObject.GetType.GetField("context", BindingFlags.NonPublic Or BindingFlags.Instance)

                _context = contextField.GetValue(servicesObject)

            End If
        End If

        Return _context
    End Get
    Set(ByVal value As DataClasses1DataContext)

        _context = value

    End Set

End Property 
```

这是一个 C# 版本：

```
public DataContext GetMyDataContext()
{
    // Find the StandardChangeTracker listening to property changes on this object.
    // If no StandardChangeTracker is listening, then this object is probably not
    // attached to a data context.
    var eventField = this.GetType().GetField("PropertyChangingEvent", BindingFlags.NonPublic | BindingFlags.Instance);
    var eventDelegate = eventField.GetValue(this) as Delegate;
    if (eventDelegate == null)
        return null;
    eventDelegate = eventDelegate.GetInvocationList().FirstOrDefault(
        del => del.Target.GetType().FullName == "System.Data.Linq.ChangeTracker+StandardChangeTracker");
    if (eventDelegate == null)
        return null;

    // Dig through the objects to get the underlying DataContext.
    // If the following fails, then there was most likely an internal change
    // to the LINQ-to-SQL framework classes.
    var targetField = eventDelegate.Target;
    var servicesField = targetField.GetType().GetField("services", BindingFlags.NonPublic | BindingFlags.Instance);
    var servicesObject = servicesField.GetValue(targetField);
    var contextField = servicesObject.GetType().GetField("context", BindingFlags.NonPublic | BindingFlags.Instance);
    return (DataContext)contextField.GetValue(servicesObject);
} 
```

请注意，如果对象当前附加到已打开 ChangeTracking 的上下文，则该对象只能找到它的 DataContext。此属性依赖于 DataContext 已订阅对象的 OnPropertyChanging 事件以监视对象生命周期内的更改这一事实。

如果这有帮助，请给这篇文章投票。

有关使用反射查找事件处理程序的更多信息：

*   [http://weblogs.asp.net/avnerk/archive/2007/03/29/reflecting-over-an-event.aspx](https://weblogs.asp.net/avnerk/reflecting-over-an-event)
*   [https://web.archive.org/web/20131213074318/http://bobpowell.net/eventsubscribers.aspx](https://web.archive.org/web/20131213074318/http://bobpowell.net/eventsubscribers.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T21:55:37.523

[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)的部分乐趣在于你不能确定对象*知道*谁在跟踪他。如果对象具有数据感知/延迟加载属性，那么您*也许*可以通过反射跟踪上下文，但实际上这将是一团糟。将数据上下文简单地传递给需要它的代码会更干净。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T21:55:32.500

最简单的做法是将 DataContext 传递到您的方法中。

但是，您也可以考虑更改您的设计，以便遵循“单一方法应该只有一个目的”的规则，在这种情况下，您不希望以与“修改”相同的方法“保存”。

# c++ - 如何在 Visual C++ 6.0 中使用命令行参数运行控制台应用程序？

> ID：276543
> 
> 赞同：30
> 
> 时间：2008-11-09T22:02:15.560
> 
> 标签：c++, command-line, parameters, visual-c++-6

我有一个控制台应用程序，可以用 Visual C++ 6.0 编译和执行，但它只会告诉我缺少命令行参数。似乎没有任何明显的地方可以输入这些。如何使用命令行参数运行或调试它？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-11-09T22:08:04.550

我假设您正在谈论设置在 IDE 中运行的命令行参数。

打开项目/设置属性页并转到调试选项卡。

您可以将它们放入“程序参数”字段。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-09T22:08:30.727

如果我没记错的话，在 Project/Settings/Debug 选项卡下有一个地方可以输入命令行参数。这是“程序参数”字段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-02T15:10:46.570

在 VS2010 中：右键单击项目。选择属性。选择调试选项卡。开始选项 -> 命令行参数：在此处输入参数。

# java - 从文本文件中提取单词

> ID：276546
> 
> 赞同：11
> 
> 时间：2008-11-09T22:05:10.610
> 
> 标签：java, text

假设您有一个像这样的文本文件：http: [//www.gutenberg.org/files/17921/17921-8.txt](http://www.gutenberg.org/files/17921/17921-8.txt)

有没有人有一个好的算法或开源代码来从文本文件中提取单词？如何获取所有单词，同时避免特殊字符，并保留“it's”等内容......

我在 Java 中工作。谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-09T22:20:45.010

这听起来像是正则表达式的正确工作。如果您不知道如何开始，这里有一些 Java 代码可以给您一个想法：

```
String input = "Input text, with words, punctuation, etc. Well, it's rather short.";
Pattern p = Pattern.compile("[\\w']+");
Matcher m = p.matcher(input);

while ( m.find() ) {
    System.out.println(input.substring(m.start(), m.end()));
} 
```

该模式`[\w']+`多次匹配所有单词字符和撇号。示例字符串将逐字打印。查看[Java Pattern 类文档](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)以了解更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T08:35:30.027

这是解决问题的好方法：此函数接收您的文本作为输入，并返回给定文本中所有单词的数组

```
private ArrayList<String> get_Words(String SInput){

    StringBuilder stringBuffer = new StringBuilder(SInput);
    ArrayList<String> all_Words_List = new ArrayList<String>();

    String SWord = "";
    for(int i=0; i<stringBuffer.length(); i++){
        Character charAt = stringBuffer.charAt(i);
        if(Character.isAlphabetic(charAt) || Character.isDigit(charAt)){
            SWord = SWord + charAt;
        }
        else{
            if(!SWord.isEmpty()) all_Words_List.add(new String(SWord));
            SWord = "";
        }

    }

    return all_Words_List;

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T22:16:11.320

伪代码如下所示：

```
create words, a list of words, by splitting the input by whitespace
for every word, strip out whitespace and punctuation on the left and the right 
```

python代码将是这样的：

```
words = input.split()
words = [word.strip(PUNCTUATION) for word in words] 
```

在哪里

```
PUNCTUATION = ",. \n\t\\\"'][#*:" 
```

或您要删除的任何其他字符。

我相信 Java 在 String 类中有等效的功能：[String](http://java.sun.com/javase/6/docs/api/java/lang/String.html) .split() 。

* * *

在您在链接中提供的文本上运行此代码的输出：

```
>>> print words[:100]
['Project', "Gutenberg's", 'Manual', 'of', 'Surgery', 'by', 'Alexis', 
'Thomson', 'and', 'Alexander', 'Miles', 'This', 'eBook', 'is', 'for', 
'the', 'use', 'of', 'anyone', 'anywhere', 'at', 'no', 'cost', 'and', 
'with', 'almost', 'no', 'restrictions', 'whatsoever', 'You', 'may', 
'copy', 'it', 'give', 'it', 'away', 'or', 're-use', 'it', 'under', 
... etc etc. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T22:20:06.430

基本上，你想匹配

([A-Za-z])+('([A-Za-z])*)?

对？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T22:11:35.667

您可以尝试正则表达式，使用您制作的模式，并计算找到该模式的次数。

# java - 在 Java 中按名称设置变量

> ID：276555
> 
> 赞同：17
> 
> 时间：2008-11-09T22:11:56.727
> 
> 标签：java, reflection, eval

我希望在 Java 中实现一些东西：

```
class Foo{
 private int lorem; //
 private int ipsum;      

 public setAttribute(String attr, int val){
  //sets attribute based on name
 }

 public static void main(String [] args){
  Foo f = new Foo();
  f.setAttribute("lorem",1);
  f.setAttribute("ipsum",2);
 }

 public Foo(){}
} 
```

...其中一个变量是基于变量名设置的，没有硬编码的变量名，也没有使用任何其他数据结构。这可能吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-09T22:22:54.257

以下是`setAttribute`使用反射实现的方法（我已经重命名了函数；对于不同的字段类型有不同的反射函数）：

```
public void setIntField(String fieldName, int value)
        throws NoSuchFieldException, IllegalAccessException {
    Field field = getClass().getDeclaredField(fieldName);
    field.setInt(this, value);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T22:17:06.437

通常，您希望使用反射。这是一个很好的[主题介绍和例子](http://web.archive.org/web/20081218060124/http://java.sun.com/developer/technicalArticles/ALT/Reflection/index.html)

特别是，“更改字段值”部分描述了如何做您想做的事情。

我注意到作者说，“这个功能非常强大，在其他传统语言中是没有的。” 当然，在过去的十年里（这篇文章写于 1998 年），我们已经看到动态语言取得了长足的进步。上面的内容在 Perl、Python、PHP、Ruby 等中很容易完成。我怀疑这是您基于“eval”标签可能来自的方向。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-09T22:21:26.193

另外，看看[BeanUtils](http://commons.apache.org/beanutils/)可以隐藏使用反射的一些复杂性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-18T18:16:39.387

这个问题是特定于整数的，这很有帮助，但是这里有一些更笼统的东西。`String`如果您正在加载字段名称/字段值对的表示形式，这种类型的方法很有用。

```
import java.lang.reflect.Field;

public class FieldTest {

    static boolean isValid = false;
    static int count = 5;

    public static void main(String[] args) throws NoSuchFieldException, IllegalAccessException {
        FieldTest test = new FieldTest();
        test.setProperty("count", "24");
        System.out.println(count);
        test.setProperty("isValid", "true");
        System.out.println(isValid);
    }

    public void setProperty(String fieldName, String value) throws NoSuchFieldException, IllegalAccessException {
        Field field = this.getClass().getDeclaredField(fieldName);
        if (field.getType() == Character.TYPE) {field.set(getClass(), value.charAt(0)); return;}
        if (field.getType() == Short.TYPE) {field.set(getClass(), Short.parseShort(value)); return;}
        if (field.getType() == Integer.TYPE) {field.set(getClass(), Integer.parseInt(value)); return;}
        if (field.getType() == Long.TYPE) {field.set(getClass(), Long.parseLong(value)); return;}
        if (field.getType() == Float.TYPE) {field.set(getClass(), Float.parseFloat(value)); return;}
        if (field.getType() == Double.TYPE) {field.set(getClass(), Double.parseDouble(value)); return;}
        if (field.getType() == Byte.TYPE) {field.set(getClass(), Byte.parseByte(value)); return;}
        if (field.getType() == Boolean.TYPE) {field.set(getClass(), Boolean.parseBoolean(value)); return;}
        field.set(getClass(), value);
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T09:43:49.247

根据使用情况，您可以按照上面的建议使用反射，或者 HashMap 可能更适合...

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-09T23:16:14.553

您可能希望在使用时缓存一些反射数据：

```
import java.lang.reflect.Field;
import java.util.HashMap;

class Foo {
    private HashMap<String, Field> fields = new HashMap<String, Field>();

    private void setAttribute(Field field, Object value) {
        field.set(this, value);
    }

    public void setAttribute(String fieldName, Object value) {
        if (!fields.containsKey(fieldName)) {
            fields.put(fieldName, value);
        }
        setAttribute(fields.get(fieldName), value);
    }
} 
```

# c++ - 在便携式应用程序中使用 Windows DLL

> ID：276562
> 
> 赞同：5
> 
> 时间：2008-11-09T22:17:22.020
> 
> 标签：c++, windows, linux, dll, portability

我已经构建了一个我想移植到 linux 的 windows C++ 应用程序。这样做的主要原因是便于我们的 IT 员工进行系统维护。除了运行这个应用程序的一台 Windows 机器之外，我们是一个仅限 linux 的操作。

此应用程序内置并在 Windows 上运行的原因是它使用 Windows API（dll 和标头）连接到属于外部方的服务器。这个连接使用了一些我真的不想弄乱的专有协议，（而且我认为我在合同上不允许这样做）所以我坚持使用 .dll。

这个dll是windows只是因为（我怀疑）dll中的windows sockets特定代码。除此之外，它并没有做很多高级的事情。在WINE中在Linux上运行应用程序和嗅探协议并自己重新实现DLL之间有什么方法可以让我让这个应用程序在Linux机器上运行？

这个想法的灵感来自[关于 QT creator 的这个项目，](http://labs.trolltech.com/blogs/2008/10/31/qt-creator-tech-preview-released/)所以任何允许我玩的解决方案都会非常酷。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T22:31:10.993

最明显的中间立场是使用[Winelib](http://www.winehq.org/site/docs/winelib-guide/index)。我不知道它是否可以直接链接到本机 DLL，但如果不能，您可能可以使用`LoadLibrary()`.

然后，您可以将应用程序分成两部分：仅调用 DLL 的包装器，以及与包装器对话的其余代码。您可以在单独的进程中同时拥有这两者，因此只有包装器必须使用 Winelib 进行编译。然后应用程序的其余部分可以使用您想要的任何框架。

# visual-studio - Visual Studio 可以使用代码片段自动扩展文本吗？

> ID：276563
> 
> 赞同：3
> 
> 时间：2008-11-09T22:18:26.450
> 
> 标签：visual-studio

在 Delphi 中，如果我键入“i​​f”和空格，它会自动插入定义了 if 语句块的代码片段。我知道在 Visual Studio 中我可以插入一个片段，但我必须右键单击并选择“插入片段”，或者按 CTRL-K，然后按 CTRL-X。

有没有办法将 Visual Studio 配置为像 Delphi 那样自动插入代码片段？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T22:19:43.793

按标签标签。

# c# - .Net 远程处理 WCF 挑战！

> ID：276575
> 
> 赞同：4
> 
> 时间：2008-11-09T22:22:28.127
> 
> 标签：c#, wcf, remoting

我正在尝试将我的 .net 远程处理代码迁移到 wcf，但我发现它很困难。有人可以帮我迁移下面这个基于远程处理的简单程序以使用 WCF 吗？该程序实现了一个简单的发布者/订阅者模式，其中我们有一个 TemperatureProviderProgram，它发布到许多订阅 TemperatureProvider 的 TemperatureSubcriberProgram。

要运行程序：

1.  将 TemperatureProviderProgram 和 TemperatureSubcriberProgram 复制到单独的控制台应用程序项目中。
2.  将剩余的类和接口复制到一个公共类库项目中，然后添加对 System.Runtime.Remoting 库的引用
3.  从控制台应用程序项目中添加对类库项目的引用。
4.  编译并运行 1 个 TemperatureProviderProgram 和多个 TemperatureSubcriberProgram。

请注意，不应使用 IIS 或 xml。提前致谢。

```
public interface ITemperatureProvider
{
    void Subcribe(ObjRef temperatureSubcriber);
}

[Serializable]
public sealed class TemperatureProvider : MarshalByRefObject, ITemperatureProvider
{
    private readonly List<ITemperatureSubcriber> _temperatureSubcribers = new List<ITemperatureSubcriber>();
    private readonly Random randomTemperature = new Random();

    public void Subcribe(ObjRef temperatureSubcriber)
    {
        ITemperatureSubcriber tempSubcriber = (ITemperatureSubcriber)RemotingServices.Unmarshal(temperatureSubcriber);
        lock (_temperatureSubcribers)
        {
            _temperatureSubcribers.Add(tempSubcriber);
        }
    }

    public void Start()
    {
        Console.WriteLine("TemperatureProvider started...");
        BinaryServerFormatterSinkProvider provider = new BinaryServerFormatterSinkProvider();
        provider.TypeFilterLevel = System.Runtime.Serialization.Formatters.TypeFilterLevel.Full;
        TcpServerChannel tcpChannel = new TcpServerChannel("TemperatureProviderChannel", 5001, provider);
        ChannelServices.RegisterChannel(tcpChannel, false);
        RemotingServices.Marshal(this, "TemperatureProvider", typeof(ITemperatureProvider));

        while (true)
        {
            double nextTemp = randomTemperature.NextDouble();

            lock (_temperatureSubcribers)
            {
                foreach (var item in _temperatureSubcribers)
                {
                    try
                    {
                        item.OnTemperature(nextTemp);
                    }
                    catch (SocketException)
                    {}
                    catch(RemotingException)
                    {}
                }
            }
            Thread.Sleep(200);
        }
    }
}

public interface ITemperatureSubcriber
{
    void OnTemperature(double temperature);
}

[Serializable]
public sealed class TemperatureSubcriber : MarshalByRefObject, ITemperatureSubcriber
{
    private ObjRef _clientRef;
    private readonly Random portGen = new Random();

    public void OnTemperature(double temperature)
    {
        Console.WriteLine(temperature);
    }
    public override object InitializeLifetimeService()
    {
        return null;
    }

    public void Start()
    {
        BinaryServerFormatterSinkProvider provider = new BinaryServerFormatterSinkProvider();
        provider.TypeFilterLevel = System.Runtime.Serialization.Formatters.TypeFilterLevel.Full;

        int port = portGen.Next(1, 65535);
        TcpServerChannel tcpChannel = new TcpServerChannel(string.Format("TemperatureSubcriber_{0}", Guid.NewGuid()), port, provider);
        ChannelServices.RegisterChannel(tcpChannel, false);

        ITemperatureProvider p1 = (ITemperatureProvider)RemotingServices.Connect(typeof(ITemperatureProvider), "tcp://localhost:5001/TemperatureProvider");
        _clientRef = RemotingServices.Marshal(this, string.Format("TemperatureSubcriber_{0}_{1}.rem", Environment.MachineName, Guid.NewGuid()));
        p1.Subcribe(_clientRef);
    }
}

public class TemperatureProviderProgram
{
    static void Main(string[] args)
    {
        TemperatureProvider tp = new TemperatureProvider();
        tp.Start();
    }
}
public class TemperatureSubcriberProgram
{
    static void Main(string[] args)
    {
        Console.WriteLine("Press any key to start TemperatureSubcriber.");
        Console.ReadLine();
        TemperatureSubcriber ts = new TemperatureSubcriber();
        ts.Start();
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T09:16:15.810

您将需要稍微修改您的逻辑。如果您想将此应用程序迁移到`WCF`. 您需要让客户端定期从服务中提取数据。

您还需要一个 Windows 服务或应用程序来托管`WCF`您在前面代码中使用的控制台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T09:18:10.097

在 WCF 中，通过服务器的“推送”，您实际上是在谈论双工通信；这`MarshalByRefObject`在很大程度上是多余的（AFAIK）。[此处](http://msdn.microsoft.com/en-us/library/ms735103.aspx)的页面讨论了各种场景，包括双工/回调。

如果问题是 xml（出于某种哲学原因），那么简单地使用`NetDataContractSerializer`而不是`DataContractSerializer`可能会有所帮助。

另一种方法是让客户端定期“拉”数据。如果您需要支持基本的 http 等，这很有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T14:32:26.977

听起来您想要做的是使用带有回调的 WCF NetTcpBinding。

看看这个： http: [//www.codeproject.com/KB/WCF/publisher_subscriber.aspx](http://www.codeproject.com/KB/WCF/publisher_subscriber.aspx)

Michele Bustamante 的《Learning WCF》也很不错。您可以在她的网站上获得 VS2008 的 Chpt1 以及本书的代码。Chpt1 将解释/演示设置连接等。她还有可下载的示例代码。其中一个示例是 DuplexPublishSubscribe。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T14:02:47.460

是的，这是真的，只是一个更正。当任何 MarshalByRefObject 派生对象超出 appdomain 时，会自动创建 ObjRefs。因此，在这种情况下，您的 ITemperatureProvider 接口订阅方法应该采用 ITemperatureSubscriber 而不是 objref。然后在客户端只需调用 p1.Subscribe(this) ，远程处理层将从将被序列化和发送的对象生成 ObjRef。（发送b参考）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T13:25:45.900

好吧，我构建了实时系统，所以轮询不是一种选择——我需要推送数据。

另外我发现没有与 System.Runtime.Remoting.ObjRef 等效的 WCF！这是一种非常有用的类型，它封装了一个服务端点，可以序列化并通过网络传递给其他远程服务。

认为在引入等效的 ObjRef 之前，我会坚持使用旧的远程处理。

# database - 使用 PHP 防止重复插入 SQL

> ID：276580
> 
> 赞同：0
> 
> 时间：2008-11-09T22:27:55.853
> 
> 标签：database, database-design, indexing

我将在 SQL 中运行数千个查询，并且我需要防止字段“域”的重复。以前从来没有这样做过，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-09T22:38:41.913

您可能想在字段“域”上创建一个“唯一”约束 - 如果您在数据库中创建两个具有相同域的行，此约束将引发错误。有关解释，请参阅[W3C 学校的本教程](http://www.w3schools.com/sql/sql_unique.asp)-

[http://www.w3schools.com/sql/sql_unique.asp](http://www.w3schools.com/sql/sql_unique.asp)

如果这不能解决您的问题，请说明您选择使用的数据库（MySql？）。

注意：此约束与您选择 PHP 作为编程语言完全不同，它是 SQL 数据库定义的东西。在 SQL 中表达此约束的一个巨大优势是，即使人们从数据库导入/导出数据、您的应用程序有问题或其他应用程序共享数据库，您也可以信任数据库来保留该约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T22:46:01.043

如果这是一个绝对的数据库完整性要求（它不太可能改变，现有数据也没有这个问题），我会在数据库中使用唯一约束强制它。

至于在尝试之前或之后检测它以通知用户，有许多可以使用的技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T03:24:38.233

数据从何而来？这是您只想运行一次、几次还是经常运行的东西？如果域值已经存在，您只是想跳过插入还是做其他事情（即增加一个计数器）？

根据您的答案，有许多可能的解决方案：

1.  对数据进行预排序，消除重复，然后插入（假设数据相对静态，以空表开头）

2.  在 PHP 中使用关联数组作为本地域值缓存（如果表已经包含数据，则从读取现有内容开始；不是线程安全的，但如果它一次只运行一次就可以工作）

3.  使域成为唯一列并编写包装器代码来处理返回错误

4.  将 domain 设为 UNIQUE 或 PRIMARY KEY 列并使用 ON DUPLICATE KEY 子句： INSERT INTO mydata ( domain, count ) VALUES ( 'firstdomain', 1 ), ( 'seconddomain', 1 ), ( 'thirddomain', 1 ) ON DUPLICATE密钥更新计数 = 计数 + 1

5.  将所有数据插入表中，然后删除重复项

请注意，批处理插入（即每个语句使用多个值子句）可以明显更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T22:38:59.573

我不确定我是否理解您的问题，但也许您正在寻找 SQL 的["UNIQUE" 约束](http://www.w3schools.com/sql/sql_unique.asp)。如果查询尝试将预先存在的值插入到字段中，您 (PHP) 将收到有关此约束违规的通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T22:40:02.303

有很多方法可以解决这个问题。您可以在该列上设置唯一约束（如主键）。如果该域也已插入，这将导致插入失败。您也可以插入所有重复的域，然后再删除它们。如果没有那么多域重复，这将很有效。已经发布了一些关于查找重复行的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T23:25:09.277

这可以用 sql 来完成，而不是用 php。

我假设您使用的是 MySQl，但相同的原则适用于不同的数据库。

使 Domain 列成为主键。（有道理，因为它必须是独一无二的。）

与其使用 INSERT，不如使用 UPDATE。

如果主键已经存在（你试图放入表中）， update 将更新现有的元组，而不是创建一个新的元组。

因此，如果现有数据不同，您将覆盖现有数据，如果相同，则将跳过更新。

# ruby-on-rails - 神秘的 Mongrel Rails 崩溃

> ID：276581
> 
> 赞同：2
> 
> 时间：2008-11-09T22:28:10.563
> 
> 标签：ruby-on-rails, macos, postgresql, mongrel

在 OS X 10.4 服务器上通过 ruby​​-pg 0.7.9 使用 PostgreSQL 8.3 在 Rails 2.1.2 上运行 Mongrel 1.1.5...

添加了 restful_authentication 和 exception_notification，当我每次选择 /RESOURCE_NAME/new 时 Mongrel 都会因“非法指令”而死时，后者似乎对我没有好处。

不管是什么资源。

在 development.log 中，我看到它声明其意图呈现 /layouts/RESOURCE_NAME.html.erb 然后......什么都没有。没有堆栈跟踪，什么都没有。server.log 为空。

这是一个令人兴奋的事情，我不知道该怎么做。我尝试运行 webbrick，一个 la：

脚本/服务器 webbrick --force

但它无视我的意愿并加载杂种。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T01:11:25.193

当您尝试从其他 OS/ABI/架构运行二进制文件时，通常会发生非法指令。也许32位与64位？检查你的库！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T06:14:40.620

我的猜测是，当它从 Ruby 下降到 Postgress C 库与数据库对话时，它会死掉。可能的原因可能是

*   您以某种方式获得了用于不同操作系统或版本的 ruby​​-pg gem。
*   您的 ruby​​-pg 与系统上的 Postgres 库不匹配。
*   还有什么...

# .net - 枚举扩展方法

> ID：276585
> 
> 赞同：54
> 
> 时间：2008-11-09T22:31:22.553
> 
> 标签：.net, enums, extension-methods, enumeration

在 vs2008 中，是否可以编写适用于任何枚举的扩展方法。

我知道您可以针对特定枚举编写扩展方法，但我希望能够使用单个扩展方法来处理每个枚举。这可能吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-09T22:34:01.970

是的，只需针对基本`Enum`类型进行编码，例如

```
public static void Something(this Enum e)
{
    // code here
} 
```

不利的一面是，您可能最终会做一些非常讨厌的事情，例如使用[`Enum.GetUnderlyingType`](http://msdn.microsoft.com/en-us/library/system.enum.getunderlyingtype.aspx)、强制转换和根据枚举的基本类型进入不同的分支，但您可以找到一些好的用途它（例如，我们有适用于所有枚举的方法）`IsOneOf`。`IsCombinationOf`

PS：请记住，在编写方法时，尽管不建议使用，但您可以使用`float`and`double`作为枚举的基本类型，因此您需要一些特殊情况以及无符号值。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-09T22:40:45.717

是的你可以。目标扩展类型是 type `Enum`。在 C# 中，这将作为：

```
public static void EnumExtension(this Enum e)
{
} 
```

或者在 VB 中像这样：

```
<Extension()> _
Public Sub EnumExtension(ByVal s As Enum)
End Sub 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-06-18T00:01:57.120

仅供参考，这是我能够使用的枚举扩展方法的一个很好的例子。它为枚举实现了一个不区分大小写的 TryParse() 函数：

```
public static class ExtensionMethods
{
    public static bool TryParse<T>(this Enum theEnum, string strType, 
        out T result)
    {
        string strTypeFixed = strType.Replace(' ', '_');
        if (Enum.IsDefined(typeof(T), strTypeFixed))
        {
            result = (T)Enum.Parse(typeof(T), strTypeFixed, true);
            return true;
        }
        else
        {
            foreach (string value in Enum.GetNames(typeof(T)))
            {
                if (value.Equals(strTypeFixed, 
                    StringComparison.OrdinalIgnoreCase))
                {
                    result = (T)Enum.Parse(typeof(T), value);
                    return true;
                }
            }
            result = default(T);
            return false;
        }
    }
} 
```

您可以通过以下方式使用它：

```
public enum TestEnum
{
    A,
    B,
    C
}

public void TestMethod(string StringOfEnum)
{
    TestEnum myEnum;
    myEnum.TryParse(StringOfEnum, out myEnum);
} 
```

以下是我访问的两个网站以帮助提出此代码：

[枚举的不区分大小写的 TryParse](http://mironabramson.com/blog/post/2008/03/Another-version-for-the-missing-method-EnumTryParse.aspx)

[枚举的扩展方法](http://www.objectreference.net/post/Enum-TryParse-Extension-Method.aspx)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-01-12T05:29:28.063

这是另一个示例-恕我直言，这比必须创建和初始化临时变量更好。

```
public static class ExtensionMethods 
{
    public static void ForEach(this Enum enumType, Action<Enum> action)
    {
        foreach (var type in Enum.GetValues(enumType.GetType()))
        {
            action((Enum)type);
        }
    }
}

public enum TestEnum { A,B,C } 
public void TestMethod() 
{
    default(TestEnum).ForEach(Console.WriteLine); 
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-25T14:22:18.113

您还可以实现以下转换方法：

```
public static class Extensions
{
    public static ConvertType Convert<ConvertType>(this Enum e)
    {
        object o = null;
        Type type = typeof(ConvertType);

        if (type == typeof(int))
        {
            o = Convert.ToInt32(e);
        }
        else if (type == typeof(long))
        {
            o = Convert.ToInt64(e);
        }
        else if (type == typeof(short))
        {
            o = Convert.ToInt16(e);
        }
        else
        {
            o = Convert.ToString(e);
        }

        return (ConvertType)o;
    }
} 
```

这是一个示例用法：

```
int a = MyEnum.A.Convert<int>(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-31T13:33:58.190

有时需要根据枚举的名称或值从一个枚举转换为另一个枚举。以下是如何使用扩展方法很好地完成它：

```
enum Enum1 { One = 1, Two = 2, Three = 3 };
enum Enum2 { Due = 2, Uno = 1 };
enum Enum3 { Two, One };

Enum2 e2 = Enum1.One.ConvertByValue<Enum2>();
Enum3 e3 = Enum1.One.ConvertByName<Enum3>();
Enum3 x2 = Enum1.Three.ConvertByValue<Enum3>();

public static class EnumConversionExtensions
{
    public static T ConvertByName<T>(this Enum value)
    {
        return (T)Enum.Parse(typeof(T), Enum.GetName(value.GetType(), value));
    }

    public static T ConvertByValue<T>(this Enum value)
    {
        return (T)((dynamic)((int)((object)value)));
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-20T22:39:20.863

制作 Enum 扩展的另一个示例 - 但这次它返回输入枚举类型。

```
public static IEnumerable<T> toElementsCollection<T>(this T value) where T : struct, IConvertible
    {
        if (typeof(T).IsEnum == false) throw new Exception("typeof(T).IsEnum == false");

        return Enum.GetValues(typeof(T)).Cast<T>();
    } 
```

使用示例：

```
public enum TestEnum { A,B,C };

TestEnum.A.toElementsCollection(); 
```

# java - 使用 Google Analytics 跟踪 Java 版本

> ID：276587
> 
> 赞同：1
> 
> 时间：2008-11-09T22:31:52.257
> 
> 标签：java, google-analytics

我正在跟踪网络访问者使用的 Java 版本：http: [//cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html](http://cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html)

不幸的是，集成级别是肤浅的。我希望 Google Analytics 告诉我有多少百分比的访问者运行了哪个版本，并进一步深入了解每个版本与哪些子属性相关联。例如，哪些推荐/来源为用户带来了特定版本？他们使用什么屏幕分辨率？等等……另一方面，有多少百分比的 Mac 用户正在运行什么版本的 Java？

关于如何改进集成的任何想法？关于如何将其集成到 Google Analytics 的竞争对手中的任何想法？归根结底，我正在寻找最好的集成免费分析产品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T04:33:08.187

您想使用新的高级细分功能。它位于页面的右上角并创建一个新段。将维度访客 > 用户定义的值拖到您的维度中并输入匹配的术语。您可能希望使用正则表达式对版本进行分组，例如`6.*`匹配所有版本 6 Java。

有了这个，您将能够按您的 Java 版本对任何报告进行切片和切块。

但是请注意，我发现高级细分有点不稳定。它仍然是测试版，我在某些细分市场上得到了一些奇怪的数字。

# sql - 将 CArchive 转换为使用 SQL 数据库进行序列化的最简单方法？

> ID：276595
> 
> 赞同：0
> 
> 时间：2008-11-09T22:38:36.440
> 
> 标签：sql, serialization, mfc, carchive

我有一个使用 CArchive 将对象结构序列化为文件的现有应用程序。我想知道是否可以用一些自定义类替换 CArchive 的使用，以便以与序列化相同的方式写入数据库。在我开始弄清楚这是否可行之前，我想知道其他人是否也这样做过——解决这个问题的最佳方法是什么？我希望能够为 CArchive 的使用创建一个替代品，以便现有的对象结构可以简单地读取/写入数据库而不是序列化文件。是否像为每个类覆盖 Serialize 方法一样简单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-10T21:41:04.573

简短的回答：忘记它。

更长的答案：

CArchive 没有单个虚拟成员。即使它的析构函数也不是虚拟的，这意味着您不应该从该类派生（C# 程序员说*sealed*）。

我只能想到一种可能性来自定义 CArchive 的工作（并且无需重写 CDocument 中的整个序列化代码）：通过将指向 CFile 派生类的指针传递给 CArchive 对象来构造您的对象，该派生类将为您处理数据连接。

从那时起，您如何通过简单地覆盖 CFile 的 Read() 和 Write() 来控制数据库超出了我的想象:-(

# emacs - Emacs 可以支持项目吗？

> ID：276601
> 
> 赞同：7
> 
> 时间：2008-11-09T22:41:32.643
> 
> 标签：emacs

Emacs 可以支持项目的概念吗？这将是几个配置选项根据您正在处理的项目而变化的地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-10T07:38:07.177

是的，请查看[CEDET 库中的 EDE 包](http://cedet.sf.net)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T00:54:35.057

查看[project-local-variables](http://www.emacswiki.org/emacs/ProjectLocalVariables)插件。我没有亲自使用过它，但我在 Rinari-mode 文档中看到它用于限定项目中的查找文件功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T22:54:36.360

您通常不会期望 emacs 知道构建要求的差异——您让构建系统（make 或其他）来处理它。要处理不同的编码标准，请定义本地**`yourproject.el`**文件以设置变量、加载和卸载本地模式等...（用于**`M-x load-file`**运行它）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T22:57:06.293

作为迂腐的，Emacs 可以支持任何东西，因为它是一个 Lisp 语言运行时，因此恰好在它之上有一个编辑器。

具体来说，Emacs 的一些插件支持项目，例如[JDEE](http://jdee.sourceforge.net/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-01T23:20:10.163

好吧，正如你所看到的，有几个包可以做到这一点。

您可能会喜欢这种方法： [http ://blog.jrock.us/articles/eproject.pod](http://blog.jrock.us/articles/eproject.pod)

我今天刚读完。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T00:51:16.967

伙计，正如另一个答案中提到的，EMACS 可以做*任何事情*。也就是说，让我们稍微扩展一下“项目”在这种情况下的含义。在大多数 IDE 中，如 Eclipse、Netbeans、Visual Studio 或 Xcode，“项目”意味着两件事：属于一起的部分的文件布局，以及构建系统构建由这些部分组成的东西的指令。

在 EMACS 中，您可以完全控制这些东西，但它们如何协同工作取决于两个目标环境——Lisp、Java、C/C++ 等等。Lisp 由 SLIME 支持，Java 由 JDEE 支持，C/C++ 由内置模式和一堆约定支持；如果您想使用它，还内置了版本控制。

在大多数情况下，构建细节不会真正对编辑器本身产生太大影响，但您可以使用模式行或局部变量专门针对特定文件的行为。JDEE 内置了一个特定的“项目”概念。

您尝试使用哪些语言和环境？

# php - PHP 获取 URL 内容并搜索字符串

> ID：276602
> 
> 赞同：1
> 
> 时间：2008-11-09T22:42:37.460
> 
> 标签：php

在 php 中，我需要获取 url（源）的内容，搜索字符串“也许宝贝爱你”，如果它不包含这个，那么执行 x。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-09T22:47:48.403

只需像阅读文件一样阅读页面内容。PHP 为您完成连接工作。然后只需通过正则表达式或简单的字符串比较来查找字符串。

```
$url = 'http://my.url.com/';
$data = file_get_contents( $url );

if ( strpos( 'maybe baby love you', $data ) === false )
{

    // do something

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-11T07:55:20.013

```
//The Answer No 3 Is good But a small Mistake in the function strpos() I have correction the code bellow.

$url = 'http://my.url.com/';
$data = file_get_contents( $url );

if ( strpos($data,'maybe baby love you' ) === false )
{
    // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T22:49:07.667

假设 fopen URL Wrappers 开启...

```
$string = file_get_contents('http://example.com/file.html');
if(strpos ('maybe baby love you', $string) === false){  
    //do X
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T03:28:21.003

如果未启用 fopen URL 包装器，您可以使用 curl 模块（请参阅[http://www.php.net/curl](http://www.php.net/curl)）

Curl 还使您能够处理经过身份验证的页面、重定向等。

# excel - Excel 2007 中对数刻度图表上部分缺少网格线

> ID：276605
> 
> 赞同：1
> 
> 时间：2008-11-09T22:43:15.820
> 
> 标签：excel, charts, logging, logarithm, gridlines

我正在使用 Excel 2007 创建一个随时间变化的数字对数图表（特别是津巴布韦美元汇率）。我正在使用 xy 散点图并注意到一个奇怪的怪癖。

y 值（数字）的范围跨越大约 10^30 的因子。在我使用这些数据制作的每张图表上，一半的网格线都丢失了。具体来说，仅显示对应于最大值的网格线。事实上，无论总范围如何，只有 10^13 左右的顶部因子有网格线。这不依赖于日志库。

难道我做错了什么？这是一个已知的错误？我在谷歌或微软的错误报告中找不到任何关于这个问题的参考资料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-17T19:45:15.813

愚蠢的工作也是如此，但如果您要在 Powerpoint 中展示您的图表，您可以将图表的背景颜色设置为“无填充”，然后将其粘贴到 Powerpoint 中（我将其粘贴为 PDF）。您可以绘制网格线并将它们与 y 轴上的刻度匹配。完成绘图后将图表“放在前面”排列，这样线条就不会出现在数据前面。您可以将它们全部分组以确保在进行演示时线条不会移动，并且如果您重新调整图表大小，它们会正确调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T19:22:55.857

我能够复制您的问题并提出一个伪解决方法。

格式有点有趣，但是如果您右键单击轴，选择“设置轴格式”，所有的行都会显示出来。在 Axis Options 下，有一个 Horizo​​ntal Axis Crosses 设置。将其从自动更改为最大轴值会导致所有网格线出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T21:17:21.350

我也遇到了同样的问题，肯定是bug。尝试序列 1, 10, 100, 1e+12, 1e+30 vs 0..4 并绘制 x,y 散点图，显然比例网格即使在线性中也是混乱的，并且在 log 中是您描述的行为。

我的解决方法是对值进行转换并按比例缩小它们（按一百万倍）。这样，图表处理的数据永远不会超过 10e9（我开始遇到问题的值）。

所以，我的建议是：绘制数据的日志版本（并清楚地为它做一个图例）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T07:06:06.730

遇到同样的事情：不会显示 y 轴范围低于 1e-7 的日志网格线。需要从 1e5 到 1e-15 的动态范围。标记 auto 或 max 将显示网格，但将轴标签放在无用的位置进行显示。

我的解决方法：使用 Open Office 来获得我需要的东西。在 Excel 2010 中找不到有用的解决方案。

# dailybuilds - 日常构建例程中的数据库重建级别

> ID：276610
> 
> 赞同：1
> 
> 时间：2008-11-09T22:47:34.173
> 
> 标签：dailybuilds

我正在为我的项目设计日常构建例程。我们正在使用 Flex 3 和 SQL Server 2005。我不确定在日常构建中我应该在多大程度上重建数据库。我应该删除所有表和存储过程并重新添加它们吗？然后我必须有一个将所有默认数据放回表中的脚本。

或者我应该让 DBA 编写仅在进行更改时运行的 Alter 脚本，并专注于每天构建代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T23:05:00.067

这实际上取决于您当前的项目开发阶段。

在没有任何生产部署的积极开发中，要做的简单事情就是每次都删除并重新创建您的数据库。这样，您的代码和数据库应该是同步的，尤其是在您进行单元测试时。这基本上是在做一个主干构建，即最新和最好的。维护起来要简单得多。编写默认数据脚本很简单，也是在需要时进行干净设置的好方法。查看[`sp_ generate_inserts`](http://vyaskn.tripod.com/code.htm)存储过程以获得一个很好的实用程序来编写现有数据库中的数据。

一旦您拥有生产数据库并且将通过代码版本更改您的数据库，测试更改脚本也很重要。由于依赖关系和数据操作考虑，更改脚本往往更难编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T23:03:02.410

删除并重新创建它们。使用 alter 总是有可能忘记中间更改。

# c - 检查是否有东西被分配

> ID：276612
> 
> 赞同：8
> 
> 时间：2008-11-09T22:48:16.637
> 
> 标签：c, malloc

给定一个指向某个变量的指针..有没有办法检查它是静态分配的还是动态分配的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-09T23:36:03.890

引用您的评论：

> 我正在制作一个基本上可以摆脱结构的方法。它有一个数据成员，它是指向可能会或可能不会被分配的东西的指针..取决于哪个，我想释放它

正确的方法是在结构中添加*另一个*成员：指向释放函数的指针。

这不仅仅是静态分配与动态分配。有*几种*可能的分配器，其中`malloc()`只是一种。

在类 Unix 系统上，它可能是：

*   静态变量
*   在堆栈上
*   在堆栈上但动态分配（即`alloca()`）
*   在堆上，分配有`malloc()`
*   在堆上，分配有`new`
*   在堆上，在分配的数组中间`new[]`
*   在堆上，在分配有的结构内`malloc()`
*   在堆上，在一个对象的基类中分配有`new`
*   分配给`mmap`
*   使用自定义分配器分配
*   更多选项，包括上述几种组合和变体

在 Windows 上，您还有多个运行时、、、`LocalAlloc`（`GlobalAlloc`您`HeapAlloc`可以轻松创建多个堆）等等。

您必须始终使用您使用的分配器的正确释放函数来释放内存。因此，负责分配内存的程序部分也应该释放内存，或者您必须将正确的释放函数（或围绕它的包装器）传递给将释放内存的代码。

您还可以通过要求始终使用特定分配器分配指针或通过自己提供分配器（以分配内存的函数和可能释放内存的函数的形式）来避免整个问题。如果您自己提供分配器，您甚至可以使用技巧（如标记指针）来允许也使用静态分配（但我不会在这里详细介绍这种方法）。

[Raymond Chen](http://en.wikipedia.org/wiki/Raymond_Chen)有一篇关于它的博客文章（以 Windows 为中心，但概念在任何地方都是相同的）：[分配和释放内存跨模块边界](https://devblogs.microsoft.com/oldnewthing/20060915-04/?p=29723)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T22:55:37.043

[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)库无处不在。您也许可以检查他们是如何做到的。一般来说，你可能一开始就不需要这样做......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T23:01:40.307

由于堆、堆栈和静态数据区通常占用不同范围的内存，因此可以在熟悉进程内存映射的情况下查看地址并确定它位于哪个分配区域。这种技术既是架构和编译器特定的，因此它使您的代码移植更加困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-09T23:10:45.517

大多数 libc malloc 实现通过在每个返回的内存块之前存储一个标头来工作，该标头具有字段（由 free() 调用使用），其中包含有关块大小的信息以及“魔术”值。这个神奇的值是为了防止用户意外删除未分配的指针（或释放被用户覆盖的块）。它是非常特定于系统的，因此您必须查看 libc 库的实现才能确切了解那里的神奇价值。

一旦你知道了，你将给定的指针移回指向标题，然后检查它的魔法值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T22:52:55.240

你能像 malloc 调试器那样使用 LD_PRELOAD 或其他东西连接到 malloc() 本身吗？如果是这样，您可以保留所有已分配指针的表并使用它。否则，我不确定。有没有办法获取malloc的记账信息？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T22:58:02.437

不作为标准功能。
malloc 库的调试版本可能具有执行此操作的某些功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T23:01:03.820

您可以将其地址与您知道的静态地址进行比较，并说它仅在距离较远时才被分配，如果您知道它应该来自的范围，但如果它的范围未知，您就不能真正相信这一点。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-09T23:26:17.043

1.) 获取您拥有的代码的映射文件。

2.) 底层进程/硬件目标平台应该有一个内存映射文件，它通常指示 - 内存的起始地址（堆栈、堆、global0、该块的大小、该内存块的读写属性。

3.) 从 1.) 中的 mao 文件中获取对象（指针变量）的地址后，尝试查看该地址属于哪个块。你可能会有一些想法。

=广告

# oop - 如何发展*现实生活* oop 技能？

> ID：276620
> 
> 赞同：13
> 
> 时间：2008-11-09T22:56:23.050
> 
> 标签：oop, ooad

我已经研究 OOP 很长一段时间了，我对这个理论有了很好的掌握。我阅读了关于 OOP 的[Head First 一](https://rads.stackoverflow.com/amzn/click/com/0596008678)书，虽然它强化了很多理论，但我发现案例研究有些琐碎。

我发现我每天都在将 OOP 原则应用到我的代码中，但我不确定我是否正确应用了它们。我需要达到能够查看我的代码并知道我是否正确使用继承，我的对象是否足够内聚等等的地步。

有没有人有任何好的建议（书籍、在线指南、博客、演练等），以帮助您在下一步发展扎实的 OOP 技能？

我主要在 .NET（Visual Basic）中工作，但我欢迎包含各种平台的建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-09T23:10:07.717

阅读Martin Fowler 的[Refactoring](https://rads.stackoverflow.com/amzn/click/com/0201485672)，并将其应用到您自己的工作中。

它将带您了解软件代码的一系列恶臭特征，这些特征描述了如何检测不正确构造的类，更重要的是，如何修复它们。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-09T23:03:43.410

考虑研究设计模式。尽管它们似乎在企业应用程序中并不常用（我已经看到它们在 API 和框架中比嵌入到企业代码中更常用），但它们可以在很多情况下用于使软件更简单或更健壮，如果只有开发人员知道如何应用它们。

关键是首先要了解设计模式，然后通过经验学习如何应用它们。

有[一本关于设计模式的 Head First 书籍，](http://oreilly.com/catalog/9780596007126/)它非常简单地教授了这个概念，但如果你想要一本真正详细介绍设计模式的书，请查看[Gang of Four design patterns book](https://rads.stackoverflow.com/amzn/click/com/0201633612)，这基本上是使设计模式成为主流的原因，并且是几乎每次提起这个话题都会提到。

设计模式可以在某种程度上应用于几乎任何面向对象的语言中，尽管在某些情况下某些模式可能是矫枉过正或过度工程化。

**编辑：**
我还想补充一点，你应该看看这本书[Code Complete 2](http://cc2e.com/)。在软件开发领域，这是一本非常有影响力的书。它涵盖了许多不同的概念和理论。每次阅读它，我都会学到一些新东西。这是一本非常好的书，如果我每 6 个月到一年读一次，我会从不同的角度来看待它，只要重新阅读它，我就会成为一个更好的程序员。无论你认为自己知道多少，这本书都会让你意识到你真正知道的有多么少。这真的是一本很棒的书。我不能强调你应该拥有这本书多少。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-09T23:04:20.270

如果您已经具备基础知识，我相信只有经验才能让您走得更远。你说你不确定你是否正确地应用了这些原则，但没有一种正确的方法。您今天编写的代码，您将在 6 个月后查看，并想知道为什么要这样写，并且可能知道更好、更清洁的方法。我还保证，10 年后，你仍然会学习新的技术和技巧。不要太担心它，它会来的，尽可能多地阅读，并尝试将你所阅读的内容分成小块应用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-09T23:12:00.413

我目前正在阅读以下书的一半：

[http://www.amazon.com/Applying-UML-Patterns-Introduction-Object-Oriented/dp/0131489062](https://rads.stackoverflow.com/amzn/click/com/0131489062)

**在深入研究代码之前，我不能强烈推荐这本书，因为它可以**学习一种真实的、专业级的、实用的方法来起草和应用格式良好的迭代设计策略。

我也读了“ **Head First** ”这本书，觉得读了它我感觉好多了。

在拥有几年的工作世界经验之后，我现在查看了我推荐的 Craig Larman 书，这本书对我来说是完美的“下一步”。

### 关于本书标题中“UML”的存在：

无论您对 UML 表示法有积极的感受还是消极的感受，请不要让它影响您购买这本书 (ISBN 0131489062) 的决定。

标题中突出显示“UML”具有误导性。虽然作者确实使用并解释了 UML 符号，但这些解释非常好地融入了相关的设计讨论中，而且本书在任何时候读起来都不像一个无聊的 UML 规范。

事实上，这是直接从书中摘录的一段话：

> 重要的是知道如何在对象中思考和设计，这是一项与了解 UML 符号非常不同且更有价值的技能。在绘制图表时，我们需要回答关键问题：对象的职责是什么？它与谁合作？应该应用哪些设计模式？远比了解 UML 1.4 和 2.0 之间的区别更重要！

这本书有时看起来像是在与首席架构师或项目经理“交谈”。我的意思是，它假定读者对软件项目的规划和方向有很大的控制权。

尽管如此，即使您只负责公司的一小部分项目和产品，我仍然会推荐这本书，并鼓励您将本书建议的一些“缩小”修改应用到您的项目中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-09T23:10:05.673

我的 OOP 顿悟来自很久以前 Grady Booch 的书。突然我意识到*为什么*物体是好的。

虽然多态性很酷，但封装是对象很酷的 75%。它有点像一个界面：你看到的是按钮，但看不到接线。在对象出现之前，只有最自律的编码人员才会让他们肮脏的手指远离其他人程序的内部部分（这被称为“结构化编程”）。

对象使做正确的事变得容易。继承和多态性是很少的好处。

了解对象的一种方法是阅读其他人的代码。通过阅读 Delphi VCL 框架的源代码，我学到了很多东西。即使只是查看 Java 的文档也可以帮助您了解单个对象类应该做什么以及它是如何设计为供其他对象使用的。

开始一个你自己的项目，当你想对你自己的类进行子类化并发现你必须返回并分解一些受保护的方法时要注意，这样你就可以只覆盖一个过程而不是全部替换它。看看祖先如何通过调用抽象函数与后代对话。换句话说，去犯很多错误并从中吸取教训。

享受！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-11T22:23:40.273

坦率地说，重新阅读有关信息隐藏的旧 David Parnas 论文有助于我保持正确的心态。案例研究可能不直接适用，但您应该能够从中获得一些有用的概括。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-15T05:51:33.403

当我试图在 VB6 中实现一个非常 OO 的问题（动态和递归地构建 SQL 语句）时，我顿悟了。理解多态性或继承的最好方法是需要它而不能使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-09T23:03:58.417

肯定会帮助您的一件事是从事一个著名的、受人尊敬的开源项目。要么挖掘源代码，看看事情是如何完成的，要么尝试做一些添加/修改。您会发现对于大多数问题没有一种风格或一种正确答案，但是通过查看几个项目，您将能够对如何完成事情有一个广泛的了解。从那里开始，您将开始发展自己的风格，并希望在此过程中为开源做出一些贡献。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-10T01:32:00.223

我认为您必须尝试实施 OO 解决方案并失败。反正我就是这样做的。我所说的失败是指你最终编写了臭代码，同时成功地交付了一个可行的解决方案。写完之后，您会感觉到事情不太对劲。您可能会有一些顿悟，和/或您可能会去寻找其他程序员的更巧妙的解决方案。毫无疑问，您会意外地实现标准设计模式的一些变体。事后看来，一盏灯会亮起（哦！这就是访客的目的），然后理解就会加速。

正如其他人所说，我认为通过一些好的 OO 开源代码工具是一个好主意。与愿意批评您的工作的更有经验的程序员一起工作也是如此。然而，理解来自于实践。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-11T21:37:54.220

您可能想尝试阅读（和编写）一些 Smalltalk 一段时间。Squeak 是一个免费的实现，它可以向您展示完全面向对象的环境（与 java 或 .net 不同）的强大功能。包括所有库代码源。语言本身非常简单。您会发现，自 1980 年以来，java 和 c# 正在慢慢添加 Smalltalk 众所周知的功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-25T16:15:16.620

[Tortoise HG](http://bitbucket.org/tortoisehg/stable/src/tip/tortoisehg/hgtk/)是一款设计精美的 OO 开源软件（用 Python 编写）。

如果您已经了解基础知识，那么使用完全面向对象的语言从头开始构建将是充分理解 OOP 软件架构的良好一步。如果您不了解 Python，[Python Essential Reference](https://rads.stackoverflow.com/amzn/click/com/0672328623) 将在几天到一周内带您完整了解该语言。

在你理解了语言之后，看看上面的软件，你会有各种各样的顿悟。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-25T16:29:19.020

要彻底理解任何事情，您需要对至少一个抽象级别以上和以下一个级别有相当的了解。在 OO 的情况下，其他人提到设计模式是 OO 之上的层。这有助于说明为什么 OO 是有用的。

As far as the layer below OO, try to play around with higher-order functions/late binding for a while and get a feel for how these relatively simple constructs are used. Also, try to understand how OO is implemented under the hood (vtables, etc.) and how it can be done in pure C. Once you grok the value of using higher order functions and late binding, you'll quickly realize that OO is just a convenient syntax for passing around a set of related functions and the data they operate on.

# java - 关于为基于 Servlet 的 Java Web 应用程序设置负载平衡和故障转移的书籍/资源

> ID：276623
> 
> 赞同：1
> 
> 时间：2008-11-09T22:57:20.457
> 
> 标签：java, web-applications, load-balancing, redundancy, failovercluster

我们正在使用 Java 和 Servlet 技术（实际上是表示层的 Wicket）创建一个 Web 系统，我们需要我们的系统几乎始终可用，因为我们的客户将非常依赖它。

这导致我们寻找一本专注于该主题的好书或其他资源，以解释如何为我们的系统设置更多冗余和故障安全架构。

我们目前的非排他性问题清单：

*   您如何拥有一个域名（例如[http://www.google.com](http://www.google.com)）实际上由多台具有负载平衡功能的服务器提供服务以分配用户？在这样的解决方案中是否总是存在弱点（在他们的情况下，这两个 [因为不能有更多] google.com 的 DNS 服务器）？
*   拥有多个数据库服务器来实现冗余和负载平衡似乎是个好主意。那是怎么设置的？
*   如果我们的其中一台 Web 服务器出现故障，我们希望进行某种故障转移并让用户使用仍在运行的服务器。除其他事项外，会话必须以某种方式同步。那是怎么设置的？
*   我们是否也需要某种同步交易？
*   亚马逊计算机云对我们来说是一个不错的选择吗？我们如何在那里设置它？是否有任何具有成本效益的替代方案？
*   我们是否需要在 JBoss 或 Glassfish 等 Java EE 容器中运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T18:53:33.613

关于 GlassFish，通过管理 GUI 进行集中管理对于需要管理多个应用服务器实例的环境有很大帮助。“始终可用”已超载。它可以是服务可用性，在故障时不保留会话，也可以是备份会话信息的数据可用性。当然，GlassFish 可以两者兼得。一些可能对 GlassFish 和高可用性有所帮助的资源：

GlassFish 高可用性指南： http: [//www.sun.com/offers/details/glassfish_HAref_config.html](http://www.sun.com/offers/details/glassfish_HAref_config.html)

在 10 分钟内设置 GlassFish 集群：http: [//blogs.oracle.com/jclingan/entry/glassfish_clustering_in_under_10](http://blogs.oracle.com/jclingan/entry/glassfish_clustering_in_under_10)

GlassFish 集团产品经理 John Clingan

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T16:18:18.123

Liferay wiki 有一个[高可用性指南](https://www.liferay.com/web/guest/community/wiki/-/wiki/Main/High+Availability+Guide)条目，概述了可以作为起点的架构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T07:56:50.370

这可能是一种简单的方法，但我最近实现了类似的负载平衡和高可用性解决方案。
我的应用程序将 Tomcat 作为 Web 容器和 MySQL 数据库。我在 Tomcat 前面使用了 Apache Http Server，并使用 Apache mod_jk2 模块作为接口来处理负载平衡和故障转移。

从 Apache 文档开始，Web 上提供了大量资源。这里有几个：

[http://tomcat.apache.org/connectors-doc/reference/workers.html](http://tomcat.apache.org/connectors-doc/reference/workers.html)

[http://www.redhat.com/docs/manuals/rhaps/jonas-guide/s1-load-balancing.html](http://www.redhat.com/docs/manuals/rhaps/jonas-guide/s1-load-balancing.html)

[http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html](http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html)

对于 MySQL，请查看 MySQL 代理以进行负载平衡和故障转移。拥有多个用于负载平衡和故障转移的数据库服务器是一个好主意。一组数据库可用于读取，另一组用于写入。根据卷，您可能希望为读/写分配更多/更少的服务器。您的数据库文档也可以帮助您进行配置。

HTH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T08:17:57.283

我的一个朋友说，《[构建可扩展的网站》](https://rads.stackoverflow.com/amzn/click/com/0596102356)是关于这个主题的权威书籍：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T09:26:48.267

Theo Schlossnagle 的[Scalable Internet Architectures可能也很有趣。](https://rads.stackoverflow.com/amzn/click/com/067232699X)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T02:02:17.913

我刚刚读完[《架构企业解决方案：基于 Internet 的高性能系统的模式》](https://rads.stackoverflow.com/amzn/click/com/0470856122 "构建企业解决方案：基于 Internet 的高性能系统的模式")。为我介绍了企业系统的可扩展性、可用性、性能、安全性和许多其他方面

# c# - C#：是否有快捷方式来检测鼠标是否仍然悬停在 MouseHover 事件上的 Label 顶部？

> ID：276642
> 
> 赞同：1
> 
> 时间：2008-11-09T23:10:06.313
> 
> 标签：c#, winforms

C#：是否有快捷方式来检测鼠标是否仍然悬停在 MouseHover 事件上的 Label 顶部？

只是好奇是否有要检查的布尔值，如果不是要数学的话:(。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T23:14:36.100

我认为数学是确定鼠标是否“仍然”悬停的唯一途径，但如果您同时订阅悬停和离开事件，那么在大多数情况下，您应该能够处理您需要的任何事情。

```
 private void label1_MouseHover(object sender, EventArgs e)
    {
        //make changes for hovering
    }

    private void label1_MouseLeave(object sender, EventArgs e)
    {
        //undo changes
    } 
```

# iphone - 如何在 iPhone 上录制 AMR 音频格式？

> ID：276644
> 
> 赞同：13
> 
> 时间：2008-11-09T23:10:12.803
> 
> 标签：iphone, ios, core-audio, audio-recording, amr

录音机不需要未压缩的线性 PCM 音频。压缩`AMR`会很好。为录制音频而构建的 iPhone 框架非常简单，但我发现的用于设置音频格式（来自 Apple）的唯一示例使用 LinearPCM。我尝试了各种其他的值组合，但似乎没有任何效果。

有没有人有任何实际记录的代码`AMR`？

**编辑：** AMR 格式是设置数据类型的选项之一，但其他选项（数据包大小、帧大小等）似乎不匹配，无论我将它们设置为什么。

**编辑：**这是我的 PCM 版本：

```
/*
 If we want to use AMR instead of PCM:
 AMR Format:
 Sampling Frequency: 8 kHz/13-bit (160 samples for 20 ms frames), filtered to 200-3400 Hz
 eight source codecs :  12.2, 1.2, 7.95, 7.40, 6.70, 5.90, 5.15, 4.75 kbit/s
 generated frame length: 244, 204,  159,  148,  134,  118,  103,   95 bits per frame
 */
format->mFormatID = kAudioFormatLinearPCM;
format->mSampleRate = 8000.0;    //8 kHz
format->mFramesPerPacket = 1;    //1 frame per packet
format->mChannelsPerFrame = 1;    //Mono
format->mBytesPerFrame = 2;        //8/bits per frame (round up)
format->mBytesPerPacket = 2;    //Same as bytes per frame
format->mBitsPerChannel = 16;    //16-bit audio
format->mReserved = 0;            //always 0
format->mFormatFlags = kLinearPCMFormatFlagIsBigEndian |
                       kLinearPCMFormatFlagIsSignedInteger |
                       kLinearPCMFormatFlagIsPacked; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T13:10:13.310

AMR 编解码器不支持在 iPhone 上进行编码/录制，尽管它支持播放：这就是 kAudioFormatAMR 常量存在的原因。

[官方api](http://developer.apple.com/library/ios/#qa/qa1615/_index.html)说支持的编码格式有：

*   **ALAC** (Apple Lossless) ~> kAudioFormatAppleLossless
*   **iLBC**（互联网低比特率编解码器，用于语音）~> kAudioFormatiLBC
*   **IMA/ADPCM** (IMA4) ~> kAudioFormatAppleIMA4
*   **线性 PCM** ~> kAudioFormatLinearPCM
*   **µ-law** ~> kAudioFormatULaw
*   **a-law** ~> kAudioFormatALaw

[您可以尝试其中一种格式，或者按照Goldenmean 的](https://stackoverflow.com/questions/276644/how-can-i-record-amr-audio-format-on-the-iphone/276794#276794)建议使用开源 AMR 编码器。

**编辑**：更新了官方 api 链接

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-30T19:03:11.337

更新 olegueret 到官方文档的链接（他们为什么要隐藏这些东西？）

[http://developer.apple.com/library/ios/#qa/qa2008/qa1615.html](http://developer.apple.com/library/ios/#qa/qa2008/qa1615.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T00:53:44.623

我猜我的 iPhone 录音机应用程序不支持 AMR 编解码器格式。

也许可以尝试将一些开源的 AMR 编码器实现集成到苹果的 iPhone 应用程序框架中，并尝试让录音机以 AMR 编码格式存储音频。（我不知道苹果的 NDA/许可证是否允许这样做）。

-广告

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T18:36:51.723

您可以将音频录制到未压缩的线性 PCM 缓冲区（圆形或环形）中，并在另一个线程中使用您自己的 AMR（或其他）压缩引擎转换此缓冲区中的数据，然后将压缩的音频数据保存到文件中。

# udp - 如何使用 unix Sockets API 查找本地可用的 UDP 端口

> ID：276647
> 
> 赞同：1
> 
> 时间：2008-11-09T23:12:13.610
> 
> 标签：udp, port, ip

我有一个应用程序，其中可能有许多进程必须向一个进程发送消息。我认为最方便的方法是发送一个 UDP 数据报。

打开套接字时，我需要指定要监听的端口。因为我只想触发并忘记 UDP 数据报，所以我想让操作系统选择一个可用端口。我宁愿不必寻找一个，特别是因为我的进程的许多实例可能正在运行。有没有办法告诉操作系统只选择一个可用端口（或者更好的是，甚至不打开侦听套接字）来触发并忘记我的 UDP 数据报？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T23:20:35.107

是的。指定 0 作为端口。操作系统将为您选择一个可用的端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T23:19:33.627

回答“问题”而不是“问题”

如果所有进程都在同一台 PC 上运行，您可能需要查看共享文件或网络堆栈以外的其他一些通信方式。

我建议您探索 Boost 的进程间库 [http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess.html中的选项](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess.html)

此处的快速指南：http: [//www.boost.org/doc/libs/1_37_0/doc/html/interprocess/quick_guide.html](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess/quick_guide.html)

具体来说，我建议您在进程之间使用命名管道或共享内存。

# c# - 全局变量访问解决方案思路

> ID：276654
> 
> 赞同：1
> 
> 时间：2008-11-09T23:16:43.850
> 
> 标签：c#

我有一个初始化类，可以将内容预加载到变量（可能是列表或数组）中。这个初始化类只有一个实例，但是会有很多类需要访问预加载的内容。

问题是它们中没有多少是相关的，并且它们都没有扩展我的初始化类。我想了想，决定使用静态方法和变量。所以像这样的事情......

```
public class InitClass
{
     static List PreloadedContent;

     static ModelData GetContent(String ContentName)
     {
          //return the preloaded content that matches given name
     }
} 
```

根据情况的要求，预加载的内容有时可能会减小或增大大小。然而，我遇到过这样的情况是唯一看起来不错的解决方案；我认为这是一个丑陋的解决方案。

注意：由于各种原因，我无法将数据加载到创建时需要它的类中——其中大部分是我还不知道但很可能会出现的原因。某些类将根据场景的渲染加载/卸载，而我的 InitClass 大多数时候不会处理这些对象的创建。

谁能给我一个更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T23:24:31.510

你正在做的事情被称为[singleton](http://en.wikipedia.org/wiki/Singleton_pattern)。以下是之前对此的一些讨论：

*   [如何在 C# 中实现单例](https://stackoverflow.com/questions/246710/how-to-implement-a-singleton-in-c)
*   [什么是 C# 中好的线程安全单例泛型模板模式](https://stackoverflow.com/questions/100081/whats-a-good-threadsafe-singleton-generic-template-pattern-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T23:21:45.900

为了避免静态/全局范围，您可以使用某种注册表类。这意味着您有一个在程序启动时初始化的类。此类包含对需要全局访问的所有其他类的引用。现在您将注册表类的初始化实例传递给应用程序中的所有实例。这不是一个非常漂亮的解决方案，但对我来说它是最好的。使用静态和全局变量，我在测试或调试代码时总是会遇到一些问题。

另一种方法是使用单例。因为他们也只是持有一个静态实例，我不喜欢他们。

# python - 你能在 Sqlite3（使用 Django）中实现不区分大小写的“唯一”约束吗？

> ID：276656
> 
> 赞同：13
> 
> 时间：2008-11-09T23:20:13.267
> 
> 标签：python, django, sqlite, django-models

因此，假设我使用的是 Python 2.5 的内置默认 sqlite3，并且我有一个 Django 模型类，其代码如下：

```
class SomeEntity(models.Model):
    some_field = models.CharField(max_length=50, db_index=True, unique=True) 
```

我已经设置了管理界面，一切似乎都工作正常，除了我可以创建两条 SomeEntity 记录，一条带有 some_field='some value' 和一条带有 some_field='Some Value' 因为 some_field 上的唯一约束似乎是区分大小写。

在检查唯一性时，是否有某种方法可以强制 sqlite*在敏感比较中执行大小写？*

我似乎在 Django 的文档中找不到这个选项，我想知道是否有什么我可以直接对 sqlite 做的事情，让它按照我想要的方式运行。:-)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T22:18:21.477

是的，这可以通过使用以下命令向表中添加唯一索引来轻松完成：

在 mytable (myfield COLLATE NOCASE) 上创建唯一索引 uidxName

如果您需要对非 ASCII 字母不区分大小写，则需要使用类似于以下的命令注册自己的 COLLATION：

以下示例显示了一个按“错误方式”排序的自定义排序规则：

```
import sqlite3

def collate_reverse(string1, string2):
    return -cmp(string1, string2)

con = sqlite3.connect(":memory:")
con.create_collation("reverse", collate_reverse)

cur = con.cursor()
cur.execute("create table test(x)")
cur.executemany("insert into test(x) values (?)", [("a",), ("b",)])
cur.execute("select x from test order by x collate reverse")
for row in cur:
    print row
con.close() 
```

[此处](http://docs.python.org/library/sqlite3.html)显示的 sqlite3 的其他 python 文档

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T00:00:26.960

也许您可以创建和使用自定义模型字段；它将是 CharField 的子类，但提供返回“文本整理 nocase”的[db_type方法](http://docs.djangoproject.com/en/dev/howto/custom-model-fields/#db_type)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-12-12T10:41:14.567

对于 2021 年的任何人，在[Django 4.0 UniqueConstraint 表达式](https://docs.djangoproject.com/en/4.0/releases/4.0/#functional-unique-constraints)的帮助下，您可以将 Meta 类添加到您的模型中，如下所示：

```
class Meta:
    constraints = [
        models.UniqueConstraint(
            Lower('<field name>'),
            name='<constraint name>'
        ),
    ] 
```

# metrics - 一生中的代码行数

> ID：276657
> 
> 赞同：14
> 
> 时间：2008-11-09T23:20:35.107
> 
> 标签：metrics

其中一家公司要求其潜在员工提供在其一生中以某种编程语言（如 Java 或 C#）编写的代码行数。因为，我们中的大多数人在多种语言的不同项目中都有多年的经验，而且我们几乎没有记录这一点，所以计算这个指标的最佳方法是什么。我相信 stackoverlow.com 的聪明成员会有一些想法。

这是一家在其领域中非常受人尊敬的公司，我相信他们有充分的理由提出这个问题。但也难以回答的是要考虑的代码类型。我是否应该只包括我实现的困难算法或我为例如具有 300 个属性并且其 getter/setter 是使用 IDE 生成的 POJO 编写的任何代码！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-09T23:29:32.513

对此类问题的最佳回答是以下之一：

*   你为什么想知道？
*   你认为这样一个数字有什么意义？
*   如果我现在就起身离开可以吗？

我会认真质疑任何向现任或未来员工提出此类问题的人背后的动机。很可能是同一类型的公司开始进行代码审查，重点是您键入的代码行数。

现在，如果他们认为代码行数是衡量程序员经验的标准，那么我肯定会在那时离开面试。

可以为复杂的问题找到简单的解决方案，并且通常比*只在问题上抛出足够多的代码行它会自行解决*更好。由于产生的错误数量与语句的数量成线性关系并高于该数量，我会说相反的情况可能会更好，再加上他们已经解决的问题的数量。

作为测试响应，我会问这个：

> 如果在一个程序中我能够用 1000 行代码解决问题 A、B 和 C，而另一个程序员用 500 行代码解决相同的问题，那么我们谁是最好的（答案是：没有足够的信息判断）

* * *

现在，如果您**仍**想估计行数，我会简单地开始考虑该人编写的项目，并将它们的大小与已知数量进行比较。例如，我有一个类库，目前大约有 130K 行代码，我用 Delphi 和其他语言编写过类似的东西，加上一些相当大的应用程序项目，所以我估计我有 1000 万行代码至少我自己。数字有意义吗？一点也不。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-12-01T08:02:57.053

听起来这是 DE Shaw 的问卷？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-09T23:49:00.760

这似乎是诸如“波音 747 能装多少个乒乓球？”之类的问题之一。在这种情况下，提问者希望看到您展示您解决问题的能力，而不是知道您实际编写了多少行代码。我会小心不要对问题做出任何批评，而是诚实地尝试解决问题；)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-09T23:44:58.770

看看[哦](http://www.ohloh.net/)。该站点显示来自开源项目的指标。

该网站估计 107,187 行代码对应于 27 人年的工作量（每年 4000 行代码）。

这种指标愚蠢的一个例子是，这个数字来自我两年来一直在玩弄外部工作的一个项目。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-09T23:43:32.877

基本上有三种方法可以处理对无意义指标的荒谬请求。

1.  拒绝回答，质疑提问者的理由，并解释为什么这些理由很愚蠢。

2.  花时间收集你能收集到的所有信息，并尽你所能计算出答案。

3.  做出一个合理的答案，并在尽可能少的愚蠢情绪中继续前进。

我看到的第一个答案似乎是第一行。想想你是否仍然想要这份工作，尽管他们的要求很愚蠢。如果答案仍然是肯定的，请避免使用数字 1。

第二种方法将涉及查看旧项目中的旧代码存储库。

在这种情况下，我会选择第三种方式。

将你在一种语言上工作的年数乘以每年 200 个工作日，再乘以每天 20 行代码，然后使用它。

如果您每年要求使用一种以上的语言，请在它们之间分配。

如果您在分析、设计或管理方面工作更多，请将这个数字降低四分之三。

如果您一直在高仪式环境（国防、医学）中工作，请将该数字降低一个数量级。

如果您一直在一个仪式特别低的环境中工作，请将其提高一个数量级。

然后把愚蠢抛在脑后，尽快开始你的生活

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-09T23:56:18.450

根据他们对答案的处理方式，我认为这不是一个坏问题。例如，如果候选人将 JavaScript 放在简历中，我想知道他们实际编写了多少 JavaScript。例如，我可能会询问他们编写的最大 JavaScript 项目中的行数。但我只是在寻找一种规模感，而不是一个实际的数字。是 10、100、1000 还是 10,000 行？

当我问起时，我会非常清楚地表明我只是在寻找一个粗略的数字来衡量项目的规模。我希望提问者案件中的雇主也是如此。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-09T23:25:08.840

这是一个有趣的指标，考虑到你可以写很多行糟糕的代码，而不是只写几行聪明的代码。

我只能假设他们正在考虑更多的线路比更少的线路更好。完全不计划并开始编写代码会更好吗？那将是编写更多代码行的好方法，因为至少如果我这样做，我通常最终会至少编写两次所有内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-09T23:43:03.313

聪明的堆栈溢出者通常会避开提出此类问题的组织。除非正确答案是“嗯，wtf??”

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-07-25T08:22:12.347

如果您要**真正**诚实，那么您会说您不知道，因为您从未将其视为有效的指标。如果面试官是一个理性/理性的人，那么这就是他们正在寻找的答案。

说你不知道的唯一其他选择是猜测，这并不能证明你解决问题的能力。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-09T23:31:08.110

为什么要在没有充分理由的情况下计算这个指标？一些随机要求该指标的公司**确实**不是一个好的理由。

如果公司的问题真的很严重，并且您认为面试可能会导致一些有趣的事情，那么我会选择一个随机数来查看它会导致什么:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-10T03:40:08.843

哈，这让我想起了当我接手一个基于 C 的测试框架时，它一开始是 20K+ 行，但我最终通过分解为一个子例程而不是最初由原作者编写的 20K 行 diarrea 代码而崩溃成 1K LOC。不幸的是，因为我写的 KLOC 写的实际上是负面的，所以我对代码中的任何错误都大打出手……我会认真考虑在指标驱动的组织中缩小代码库……

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-10T00:00:05.213

即使我同意大多数人的说法，这不是一个很好的指标，如果它是一个严肃的公司，正如你所说，他们可能有理由问这个。这就是我可能会做的：

拿一个你现有的项目，获取行数，然后除以你编写它的时间。这将为您提供一种每小时行数度量。然后，尝试估计您使用该特定语言的时间，并将其与您已经计算的指标相乘。老实说，我认为这不是一个好方法.. 但老实说，这也不是一个好问题.. 我还会告诉公司我过去提出这个数字的策略.. 也许，也许，这就是他们想..知道您对这个问题的看法以及您将如何回答？:p

或者，他们只是想知道您是否有一些经验……所以，猜一个令人印象深刻的数字并写下来：D

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-10T00:06:35.357

> “这是一家在其领域中非常受人尊敬的公司，我相信他们有充分的理由提出这个问题”

而且我很确定他们不会，因为“受到尊重”并不意味着“他们做的一切都正确”，因为这肯定是不对的，或者如果是，那么在我看来至少是愚蠢的。

什么算作“代码行”？我估计我已经编写了大约 250.000 行 C# 代码，可能更多。问题？95% 是一次性代码，并非全部用于学习。我仍然发现自己第十次编写了一个小型的 3 行程序，仅仅是因为再次编写这三行（并更改参数）比去搜索现有的更容易。

此外，代码行**没有任何意义**。所以我有两个人，一个比另一个多写了 20% 的行，但是这 20% 多是不必要的复杂行，“循环展开”和其他可以重构的无用内容。

很抱歉，受人尊敬的公司与否：询问代码行数是一个明确的迹象，表明他们对衡量程序员的效率一无所知，这意味着他们必须依赖石器时代的技术，比如测量同样准确的 LoC作为石器时代的日历。这意味着，如果您喜欢偶尔放松一下并增加您的数字，这可能是一个工作的好地方。

好吧，这更像是一个咆哮而不是一个答案，但我真的认为这个数字绝对没有充分的理由。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-25T08:50:40.930

还没有人引用[比尔·阿特金森 -2000 线的故事](http://www.folklore.org/StoryView.py?project=Macintosh&story=Negative_2000_Lines_Of_Code.txt)......

在过去一年的工作中，我的周五下午（嗯，大约每月一个周五）进行自我开发练习，包括测试、原型和基础设施，我可能已经写了大约 5 kloc。然而，一个项目将现有的 25kloc C/C++ 应用程序重新实现为 1100 行 Erlang，另一个项目将现有 C 库的 15kloc 转换为 C++ 的 1kloc，因此网络严重负面。我拥有这些数字的唯一原因是我想看看有多么消极。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-01T07:51:01.143

我知道这是一个旧帖子，但这可能对某人有用......

我最近从一家公司离职，我作为一名 Java 开发人员工作了大约 9.5 年。我们所有的代码都在 CVS 中，然后是 SVN，Atlassian Fisheye 提供了它的视图。

当我离开时，Fisheye 报告我的个人总 LOC 为 +- 250,000。这是关于其[LOC 指标](http://confluence.atlassian.com/display/FISHEYE/About+the+Lines+of+Code+metric)的 Fisheye 描述，包括关于如何计算每个 SVN 用户的个人 LOC 的讨论。注意 SVN 中的分支和合并问题，并且 LOC 通常应该只基于 TRUNK。

# javascript - 如何覆盖 OnBeforeUnload 对话框并将其替换为我自己的？

> ID：276660
> 
> 赞同：373
> 
> 时间：2008-11-09T23:24:17.580
> 
> 标签：javascript, jquery, onbeforeunload

我需要在用户离开页面之前警告用户未保存的更改（一个很常见的问题）。

```
window.onbeforeunload = handler 
```

这可行，但它会引发一个默认对话框，其中包含我自己的文本的令人讨厌的标准消息。我需要完全替换标准消息，以便我的文本清晰，或者（甚至更好）使用 jQuery 将整个对话框替换为模态对话框。

到目前为止，我失败了，我还没有找到其他似乎有答案的人。甚至可能吗？

我页面中的Javascript：

```
<script type="text/javascript">   
    window.onbeforeunload = closeIt;
</script> 
```

closeIt() 函数：

```
function closeIt()
{
  if (changes == "true" || files == "true")
  {
      return "Here you can append a custom message to the default dialog.";
  }
} 
```

使用 jQuery 和 jqModal 我已经尝试过这种事情（使用自定义确认对话框）：

```
$(window).beforeunload(function () {
    confirm('new message: ' + this.href + ' !', this.href);
    return false;
}); 
```

这也不起作用 - 我似乎无法绑定到`beforeunload`事件。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2008-11-10T00:21:25.653

您无法修改 的默认对话框`onbeforeunload`，因此最好的选择可能是使用它。

```
window.onbeforeunload = function() {
    return 'You have unsaved changes!';
} 
```

[以下是](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)微软对此的参考：

> 将字符串分配给 window.event 的 returnValue 属性时，会出现一个对话框，让用户可以选择留在当前页面并保留分配给它的字符串。对话框中显示的默认语句“您确定要离开此页面吗？...按 OK 继续，或按 Cancel 留在当前页面。”无法删除或更改。

问题似乎是：

1.  当`onbeforeunload`被调用时，它将处理程序的返回值作为`window.event.returnValue`.
2.  然后它将返回值解析为字符串（除非它为空）。
3.  由于`false`被解析为字符串，因此对话框将触发，然后将传递适当的`true`/ `false`。

结果是，似乎没有一种分配`false`方式`onbeforeunload`来阻止它进入默认对话。

关于 jQuery 的附加说明：

*   在 jQuery 中设置事件**可能会**出现问题，因为这也允许其他`onbeforeunload`事件发生。如果你只希望你的卸载事件发生，我会坚持使用普通的 JavaScript。
*   jQuery 没有快捷方式，`onbeforeunload`因此您必须使用通用`bind`语法。

    ```
    $(window).bind('beforeunload', function() {} ); 
    ```

**编辑 09/04/2018**：onbeforeunload 对话框中的自定义消息自 chrome-51 以来已弃用（参见：[发行说明](https://developers.google.com/web/updates/2016/04/chrome-51-deprecations#remove_custom_messages_in_onbeforeunload_dialogs)）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-02-14T11:37:11.347

使用[jQuery](https://jquery.com/)并在 IE8、Chrome 和 Firefox 中测试对我有用的是：

```
$(window).bind("beforeunload",function(event) {
    if(hasChanged) return "You have unsaved changes";
}); 
```

如果不需要提示，请务必不要返回任何内容，因为此处的 IE 和其他浏览器行为之间存在差异。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-07-12T04:41:48.000

虽然在某些情况下您无法对盒子做任何事情，但您可以拦截点击链接的人。对我来说，这在大多数情况下都是值得的，作为后备，我已经离开了卸载事件。

我使用 Boxy 而不是标准的 jQuery Dialog，它可以在这里找到：http: [//onehackoranother.com/projects/jquery/boxy/](http://onehackoranother.com/projects/jquery/boxy/)

```
$(':input').change(function() {
    if(!is_dirty){
        // When the user changes a field on this page, set our is_dirty flag.
        is_dirty = true;
    }
});

$('a').mousedown(function(e) {
    if(is_dirty) {
        // if the user navigates away from this page via an anchor link, 
        //    popup a new boxy confirmation.
        answer = Boxy.confirm("You have made some changes which you might want to save.");
    }
});

window.onbeforeunload = function() {
if((is_dirty)&&(!answer)){
            // call this if the box wasn't shown.
    return 'You have made some changes which you might want to save.';
    }
}; 
```

您可以附加到另一个事件，并更多地过滤单击了哪种锚点，但这对我和我想要做的事情有用，并作为其他人使用或改进的示例。以为我会为那些想要这个解决方案的人分享这个。

*我已经删掉了代码，所以这可能无法正常工作。*

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-18T20:48:19.880

1）使用onbeforeunload，而不是onunload。

2）重要的是避免执行return语句。我并不是说要避免从您的处理程序返回。您可以正常返回，但您要确保到达函数的末尾并且不要执行 return 语句。在这些情况下，不会出现内置标准对话框。

3）如果你使用onbeforeunload，你可以在你的unbeforeunload处理程序中运行一个ajax调用来整理服务器，但它必须是一个同步的，你必须等待并处理你的onbeforeunload处理程序中的回复（仍然尊重上述条件（2））。我这样做并且效果很好。如果您执行同步 ajax 调用，则一切都会暂停，直到响应返回。如果您执行异步操作，认为您不关心来自服务器的回复，则页面卸载继续并且您的 ajax 调用被此进程中止 - 包括远程脚本（如果它正在运行）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-05-31T00:39:30.623

现在无法在 chrome 中完成此操作以避免垃圾邮件，请参阅[javascript onbeforeunload 不显示自定义消息](https://stackoverflow.com/questions/37782104/javascript-onbeforeunload-not-showing-custom-message)以获取更多详细信息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-21T15:02:56.087

尝试放置一个`return;`而不是消息..这对我来说大多数浏览器都有效。（这只会真正阻止对话框的呈现）

```
window.onbeforeunload = function(evt) {            
        //Your Extra Code
        return;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-04-28T10:49:51.833

Angular 9 方法：

```
constructor() {
    window.addEventListener('beforeunload', (event: BeforeUnloadEvent) => {
     if (this.generatedBarcodeIndex) {
      event.preventDefault(); // for Firefox
      event.returnValue = ''; // for Chrome
      return '';
     }
     return false;
    });
   } 
```

浏览器支持和删除自定义消息：

*   Chrome 在 51 分钟内删除了对自定义消息的支持
*   Opera 在 38 分钟版本中删除了对自定义消息的支持
*   Firefox 在 44.0 分钟版本中删除了对自定义消息的支持
*   Safari 在 9.1 分钟版本中删除了对自定义消息的支持

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-06-10T11:25:10.460

我遇到了同样的问题，我可以在我的消息中获得自己的对话框，但我面临的问题是：1）它在所有导航上都提供消息，我只希望它用于关闭单击。2）如果用户选择取消，我自己的确认消息仍然显示浏览器的默认对话框。

以下是我在母版页上找到的解决方案代码。

```
function closeMe(evt) {
    if (typeof evt == 'undefined') {
        evt = window.event; }
    if (evt && evt.clientX >= (window.event.screenX - 150) &&
        evt.clientY >= -150 && evt.clientY <= 0) {
        return "Do you want to log out of your current session?";
    }
}
window.onbeforeunload = closeMe; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-03-03T13:14:40.523

您可以检测用户按下了哪个按钮（确定或取消），因为仅当用户选择离开页面时才会调用 onunload 函数。尽管在这个函数中可能性是有限的，因为 DOM 正在被折叠。您可以运行 javascript，但 ajax POST 不执行任何操作，因此您不能使用此方法进行自动注销。但是有一个解决方案。window.open('logout.php') 在 onunload 函数中执行，因此用户将注销并打开一个新窗口。

```
function onunload = (){
    window.open('logout.php');
} 
```

当用户离开页面或关闭活动窗口并且用户通过“logout.php”注销时调用此代码。当注销 php 包含代码时，新窗口会立即关闭：

```
window.close(); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-08-20T16:15:41.737

如何使用“绑定”命令“一”的专用版本。一旦事件处理程序第一次执行，它会作为事件处理程序自动删除。

```
$(window).one("beforeunload", BeforeUnload); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-03-16T10:11:24.140

```
 <script type="text/javascript">
        window.onbeforeunload = function(evt) {
            var message = 'Are you sure you want to leave?';
            if (typeof evt == 'undefined') {
                evt = window.event;
            }       
            if (evt) {
                evt.returnValue = message;
            }
            return message;
        } 
    </script> 
```

参考[http://www.codeprojectdownload.com](http://www.codeprojectdownload.com)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-12T18:45:49.790

试试这个

```
$(window).bind('beforeunload', function (event) {
            setTimeout(function () {
                var retVal = confirm("Do you want to continue ?");
                if (retVal == true) {
                    alert("User wants to continue!");
                    return true;
                }
                else {
                    window.stop();
                    return false;
                }
            });
            return;
        }); 
```

# excel - 处理电子邮件地址列表的最佳方式

> ID：276666
> 
> 赞同：1
> 
> 时间：2008-11-09T23:26:48.400
> 
> 标签：excel, list, scripting, merge

我有 3 个文本文件（A、B 和 C），每个文件都有数百个电子邮件地址。我想将列表 A 和列表 B 合并到一个文件中，忽略大小写和空格的差异。然后我想删除列表 C 中新列表中的所有电子邮件，再次忽略大小写和空格的差异。

我选择的编程语言通常是 C++，但它似乎不太适合这项任务。是否有一种脚本语言可以在相对较少的行中执行此操作（和类似任务）？

还是已经有软件（免费或商业）可以让我这样做？例如，是否可以在 Excel 中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-09T23:42:01.100

最快的方法可能不一定需要编码。您可以在一个工作表中将文件 A 和 B 导入 Excel，然后（如有必要）对生成的地址列表进行过滤以删除任何重复项。

下一步是将文件 C 导入第二个工作表。在第三个工作表中，您将执行 VLOOKUP 以挑选出您的第一个列表中的所有地址，如果它们在您的“列表 C”中，则将它们删除。

VLOOKUP 看起来像这样：

**=IF(ISNA(VLOOKUP( *email_address_cell* , Sheet2! *email_duplicates_list* , 1, false), "", (VLOOKUP( *email_address_cell* , Sheet2! *email_duplicates_list* , 1, false)))**

我还检查了公式是否返回“值不可用”错误，在这种情况下，单元格只显示一个空白值。从那里，你只需要删除你的空白，然后你的最终列表就出来了。

现在说了这么多，你仍然可以做一个 VBA 宏来做同样的事情，但可能会清理一下列表，这取决于你需要什么。希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T00:09:05.693

正如提到的 Excel，您也可以使用 Jet 和 VBScript 来做这种事情。

```
Set cn = CreateObject("ADODB.Connection")
strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\Docs\;" _
& "Extended Properties=""text;HDR=No;FMT=Delimited"";"

cn.Open strCon

strSQL = "SELECT F1 Into New.txt From EmailsA.txt " _
    & "WHERE UCase(F1) Not IN (SELECT UCase(F1) From EmailsC.txt)"
cn.Execute strSQL

strSQL = "INSERT INTO New.txt ( F1 ) SELECT F1 FROM EmailsB.txt " _
    & "WHERE UCase(F1) Not IN (SELECT UCase(F1) From EmailsC.txt)"
cn.Execute strSQL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T23:46:27.427

对于您描述的那种文本处理，perl 或 python 都是理想的。

您可以使用关联数组（在这种情况下为带有字符串索引的数组）将电子邮件地址存储在列表中。

使用小写的、未加空格的电子邮件地址作为键，使用真实的电子邮件地址作为值。

然后是读入并存储第一个文件，读入并存储第二个文件（这将使用相同的密钥覆盖电子邮件地址），然后读入第三个文件并使用该密钥从列表中删除条目。

然后剩下的就是您想要的列表（A + B - C）。

这里的伪代码：

```
set list to empty
foreach line in file one:
    key = unwhitespace(tolowercase(line))
    list{key} = line
foreach line in file two:
    key = unwhitespace(tolowercase(line))
    list{key} = line
foreach line in file three:
    key = unwhitespace(tolowercase(line))
    if exists(list{key})
        delete list{key}
foreach key in list:
    print list{key} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-11T06:06:42.273

Sadly this answer probably won't help you, but if in fact you were using Unix (Linux for example) you could do something like:

cat filea >> fileb # append file a to file b

sort fileb | uniq > newFile # newFile now contains a merger of file a and file b, with sorted and unique email addresses

The above could all be done on one line as follows: cat filea >> fileb | sort | uniq > newFile

Now you're left with simply removing common emails. Some variation of "diff" should be helpful there such as perhaps: diff newFile fileC > finalFile

diff will give you a list of differences between the two files, so the output in "finalFile" should be a list of emails that are in "newFile" (the merger of A & B) but are NOT in fileC. Options to the various tools allow you to ignore whitespace and case. I'd have to play with it a bit to get it exactly right but the above is the general idea.

I used to have an extra box running Linux for the sole purpose of doing stuff like the above which is a hassle under Windoze but a breeze under Unix type operating systems. When my hardware died I never got around to building another Linux box.

I believe the MKS toolkit for Windoze probably has all of the above utilities.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T00:23:57.287

我想上面的答案，回答技术HOW TO问题；唯一需要考虑的是您必须执行多少次任务。如果这是一次性的事情，并且您对 Excel 更满意，请从那里开始。如果您知道您将执行此任务至少两次甚至更多次，那么编写脚本或可执行文件是您的最佳选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-09T23:55:47.843

在 Python 中，是这样的：

请注意，这会将小写电子邮件写入最终输出。如果这不行，那么基于字典的解决方案将是必要的。

```
def read_file(filename):
    with file(filename, "r") as f:
        while True:
            line = f.readline();
            if not line:
                break;
            line = line.rstrip();
            if line:
                yield line;

def write_file(filename, lines):
    with file(filename, "w") as f:
        for line in lines:
            f.write(line + "\n");

set_a = set((line.lower() for line in read_file("file_a.txt")));
set_b = set((line.lower() for line in read_file("file_b.txt")));
set_c = set((line.lower() for line in read_file("file_c.txt")));

# Calculate (a + b) - c
write_file("result.txt", set_a.union(set_b).difference(set_c)); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-09T23:51:38.290

Excel 可以做到，如上。最适合的编程语言是 Perl。

# c# - Visual Studio 2008 中单元测试的初学者介绍

> ID：276677
> 
> 赞同：11
> 
> 时间：2008-11-09T23:37:49.160
> 
> 标签：c#, visual-studio-2008, unit-testing

我是一名自学成才的开发人员，我的经验全是我开发的小型应用程序。

我目前正在开发一个已公开的应用程序，并且我意识到我需要开始进行良好的单元测试以捕获回归并通常确保一切正常。

我已经阅读了上一个[问题](https://stackoverflow.com/questions/205566/comprehensive-introduction-to-unit-testing)。我想知道是否有任何在线资源专门处理 Visual Studio 2008 中的 C# 单元测试，最好带有示例。

编辑：我使用 Visual Studio 2008 Professional for Windows 应用程序，没有 Web 开发。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-10T07:06:54.057

您没有指定您使用的是哪种[风格的 VS2008](http://msdn.microsoft.com/en-us/subscriptions/subscriptionschart.aspx)。如果它是 Pro 或更高版本，则捆绑了 MSTest，但很多人对此有疑问 - 它并不总是非常直观，并且需要进行太多设置才能完成覆盖/文件部署等简单的事情。

演练在[这里](http://msdn.microsoft.com/en-us/library/ms379625(VS.80).aspx)。

作为建议，我建议将 VS2008 与[NUnit](http://www.nunit.org/)（免费）和[TestDriven.NET](http://testdriven.net/)（非免费）一起使用。它消除了所有的痛苦，让你只需要写一些简单的东西，比如：

```
[TestFixture]
public class Foo {
    [Test]
    public void Bar() {
        Assert.AreEqual(2, 1+1);
    }
} 
```

然后只需右键单击（在类上、在方法上、在项目上、在解决方案上）并使用 TestDriven.NET 提供的测试选项，包括（如果你有 MSTest）“Test With -> Team Coverage”，其中使用 MSTest 覆盖工具运行您的 NUnit 测试，包括将着色返回到 IDE 以显示执行了哪些行。不要弄乱“testrunco​​nfig”和 MSTest 希望您使用的其他文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T23:41:10.727

[http://www.asp.net/learn/mvc-videos/](http://www.asp.net/learn/mvc-videos/)

店面和结对编程视频涉及大量 TDD（测试驱动开发）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T00:37:20.270

您没有指定您是否正在使用 web/windows 应用程序，但如果您也在学习 ASP.NET，那么 Richard Dingwall 有一些很好的链接到使用 TDD 的示例 asp.net mvc 应用程序。有使用 nUnit 的示例以及诸如 Rhino.Mocks 和 Moq 之类的模拟框架。

在这里查看他的博客文章以获取一些链接：

[http://richarddingwall.name/2008/11/02/best-practice-dddtdd-aspnet-mvc-example-applications/](http://richarddingwall.name/2008/11/02/best-practice-dddtdd-aspnet-mvc-example-applications/)

James Gregory 在这里发布了一个非常好的单元测试入门：

[http://blog.jagregory.com/2007/07/17/getting-with-it-test-driven-development/](http://blog.jagregory.com/2007/07/17/getting-with-it-test-driven-development/)

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T00:51:01.617

电子书编程基础：[http ://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx](http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx)

还包括单元测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T18:31:12.040

如果您不仅对普通单元测试感兴趣，请查看[PEX](http://research.microsoft.com/Pex/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T16:16:49.267

我建议您查看截屏视频，以了解如何应用 TDD。在[Dnr TV](http://www.dnrtv.com/)有两集与 JP Boodhoo 合作，他介绍了测试驱动开发：

*   [使用 JP Boodhoo 进行测试驱动开发，第 1 部分](http://www.dnrtv.com/default.aspx?showNum=10)
*   [Test Driven Development with JP Boodhoo, Part 2](http://www.dnrtv.com/default.aspx?showNum=11)

If you want to see unit testing and TDD used together with a whole bunch of other agile practices, I would recommend watching the sceencast series [Autumn of Agile](http://autumnofagile.net/). This series shows the development of a fully unit tested application from start to finish.

# .net - WinForms：在运行时从标签更改字体样式（下划线）的正确方法是什么？

> ID：276678
> 
> 赞同：6
> 
> 时间：2008-11-09T23:40:16.253
> 
> 标签：.net, winforms

C#：在运行时从标签更改字体样式（下划线）的正确方法是什么？

到目前为止，我了解如果您想在运行时从标签更改字体相关属性，主要是所有字体属性，您将不得不使用，

```
 lblName.Font = new Font(... etc. etc. 
```

是否有上述方法的快捷方式，但只指定一个新的字体样式，如 FontStyle.Underline？

或者

我是否必须继续使用“new Font()”方法并分配所有字段以及它只是为了给我的标签加下划线？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-10T00:50:47.000

你这样做的方式：

```
this.Font = new Font(this.Font, FontStyle.Underline); 
```

是正确的。原因是 Font 是密封且不可变的类型（按设计）。当在 .NET 1 中引入时，这似乎有点奇怪，但随着今天对函数式编程、并发性和不变性的重视，这种风格被更多地看到。也许这样做是因为控件继承了其容器的字体，并且跟踪单个字体属性更改比跟踪批发字体更改要多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T00:11:18.093

诉诸于，

> this.Font = new Font(this.Font, FontStyle.Underline);

适用于 Win32 窗体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-17T15:37:59.227

```
//Bold.
    label1.Font = new Font(label1.Font.Name, 12, FontStyle.Bold); 

//Bold With Underline.
    label1.Font = new Font(label1.Font.Name, 12, FontStyle.Bold | FontStyle.Underline); 

//Bold with Underline with Italic.
    label1.Font = new Font(label1.Font.Name, 12, FontStyle.Bold | FontStyle.Underline | FontStyle.Italic); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-09T23:45:09.660

怎么样（我正在使用 .Net Framework 2.0） 好的，这适用于 Web 应用程序。在表单应用程序中，它是只读的。

lblName.Font.Underline = true;

这是定义：

```
 //
    // Summary:
    //     Gets or sets a value that indicates whether the font is underlined.
    //
    // Returns:
    //     true if the font is underlined; otherwise, false. The default value is false.
    [DefaultValue(false)]
    [NotifyParentProperty(true)]
    public bool Underline { get; set; } 
```

# python - 如何在python脚本中多次导入python文件

> ID：276679
> 
> 赞同：2
> 
> 时间：2008-11-09T23:40:27.280
> 
> 标签：python

是否可以在 python 脚本中多次导入 python 文件，因为我使用 import 命令在函数中运行循环回到我的驱动程序文件，但它只工作一次？谢谢

**编辑：**解决了自己谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-09T23:51:56.230

您很可能不应该将 import 用于您正在尝试做的事情。

如果没有更多信息，我只能猜测，但是您应该将您导入的模块中的代码从顶层移动到一个函数中，执行一次导入，而不是简单地从循环中调用该函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T23:50:30.477

最简单的答案是将您尝试运行的代码放在这样的函数中

（在您现在正在导入的模块内）：

```
def main():
    # All the code that currently does work goes in here 
    # rather than just in the module 
```

（执行导入的模块）

```
import your_module #used to do the work

your_module.main() # now does the work (and you can call it multiple times)
# some other code
your_module.main() # do the work again 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T09:53:09.340

虽然 Tom Ley 的回答是正确的方法，但*可以*使用内置的 reload 多次导入模块。

```
module.py:
print "imported!"

>>> import module
imported!
>>> reload(module)
imported!
<module 'module' from 'module.pyc'> 
```

请注意，重新加载会返回模块，允许您在必要时重新绑定它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T23:51:31.177

导入语句——根据定义——只导入一次。

如果需要，您可以尝试使用`execfile()`(或`eval()`) 多次执行单独的文件。

# asp.net - 您可以从 Javascript 函数更改 ASP.NET 控件的高度/宽度吗？

> ID：276693
> 
> 赞同：1
> 
> 时间：2008-11-09T23:50:44.280
> 
> 标签：asp.net, javascript

从客户端 Javascript 函数更改 ASP.NET 控件的高度和宽度的最佳方法是什么？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T23:55:10.747

您可以使用控件 .ClientID 和一些 javascript 并以这种方式进行更改。

您可以通过 CSS 高度/宽度或直接在控件本身上的某些控件上执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T10:21:28.063

是的，这是可能的。ASP 控件在浏览器上呈现为带有一些附加属性的 HTML 控件。如果您在创建 ASP.Net 控件时为其提供了 ID，它也会显示为 HTML 控件的 ID。

您应该能够使用 javascript 的 getElementById() 函数访问控件，并且您应该能够修改 CSS 属性（样式在上面的消息中指定）。

如果您使用 JQuery，选择和设置 CSS 样式会更容易，例如

$("#myControl").css("width")== myNewValue;

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T00:51:50.507

由于 ASP.NET 引入了名称 mangling，我使用底部的函数来查找 ASP 控件。获得控件后，您可以根据需要设置高度/宽度。

```
example usage:

<input type='button' value='Expand' onclick='setSize("myDiv", 500, 500);' />

...

function setSize(ctlName, height, width ) {
    var ctl = asp$( ctlName, 'div' );
    if (ctl) {
       ctl.style.height = height + 'px';
       ctl.style.width = width + 'px';
    }
}

function asp$( id, tagName ) {
    var idRegexp = new RegExp( id + '$', 'i' );
    var tags = new Array();
    if (tagName) {
        tags = document.getElementsByTagName( tagName );
    }
    else {
        tags = document.getElementsByName( id );
    }
    var control = null;
    for (var i = 0; i < tags.length; ++i) {
       var ctl = tags[i];
       if (idRegexp.test(ctl.id)) {
          control = ctl;
          break;
       }
    }

    if (control) {
        return $(control.id);
    }
    else {
        return null;
    }
} 
```

# javascript - 什么是位运算符？

> ID：276706
> 
> 赞同：134
> 
> 时间：2008-11-09T23:59:26.307
> 
> 标签：javascript, boolean, bitwise-operators, boolean-logic

我是一个写代码只是为了好玩的人，在学术或专业环境中都没有真正深入研究过，所以像这些按位运算符这样的东西真的让我无法理解。

我正在阅读一篇关于 JavaScript 的文章，它显然支持按位运算。我一直在某些地方看到此操作，并且我尝试阅读以弄清楚它到底是什么，但我似乎根本不明白。那么它们是什么？清晰的例子会很棒！:D

还有几个问题——按位运算有哪些实际应用？你什么时候可以使用它们？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2008-11-10T00:39:20.750

由于没有人提出这些为什么有用的主题：

在处理标志时，我经常使用按位运算。例如，如果您想将一系列标志传递给操作（例如，`File.Open()`同时启用读取模式和写入模式），您可以将它们作为单个值传递。这是通过在位集（字节、短、整数或长）中为每个可能的标志分配它自己的位来实现的。例如：

```
 Read: 00000001
Write: 00000010 
```

所以如果你想通过读写，你会通过 (READ | WRITE) 然后将两者组合成

```
00000011 
```

然后可以在另一端解密，例如：

```
if ((flag & Read) != 0) { //... 
```

检查

```
00000011 &
00000001 
```

返回

```
00000001 
```

这不是 0，因此该标志确实指定了 READ。

您可以使用 XOR 来切换各种位。我在使用标志指定方向输入（上、下、左、右）时使用了它。例如，如果一个精灵水平移动，我希望它转身：

```
 Up: 00000001
   Down: 00000010
   Left: 00000100
  Right: 00001000
Current: 00000100 
```

在这种情况下，我只需将当前值与 (LEFT | RIGHT) 进行异或，这将关闭 LEFT 并打开 RIGHT。

移位在几种情况下很有用。

```
x << y 
```

是相同的

> x * 2^年

如果您需要快速乘以 2 的幂，但要注意将 1 位移到最高位 - 这会使数字变为负数，除非它是无符号的。在处理不同大小的数据时它也很有用。例如，从四个字节中读取一个整数：

```
int val = (A << 24) | (B << 16) | (C << 8) | D; 
```

假设 A 是最重要的字节，而 D 是最少的。它最终会是：

```
A = 01000000
B = 00000101
C = 00101011
D = 11100011
val = 01000000 00000101 00101011 11100011 
```

颜色通常以这种方式存储（最高有效字节被忽略或用作 Alpha）：

```
A = 255 = 11111111
R = 21 = 00010101
G = 255 = 11111111
B = 0 = 00000000
Color = 11111111 00010101 11111111 00000000 
```

要再次找到这些值，只需将这些位向右移动直到它位于底部，然后屏蔽掉剩余的高阶位：

```
Int Alpha = Color >> 24
Int Red = Color >> 16 & 0xFF
Int Green = Color >> 8 & 0xFF
Int Blue = Color & 0xFF 
```

`0xFF`是一样的`11111111`。所以本质上，对于 Red，你会这样做：

```
Color >> 16 = (filled in 00000000 00000000)11111111 00010101  (removed 11111111 00000000)
00000000 00000000 11111111 00010101 &
00000000 00000000 00000000 11111111 =
00000000 00000000 00000000 00010101 (The original value) 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-10T00:11:05.223

值得注意的是，作为其他答案列出的单位真值表一次只能处理一个或两个输入位。使用整数时会发生什么，例如：

```
int x = 5 & 6; 
```

答案在于每个输入的二进制展开：

```
 5 = 0 0 0 0 0 1 0 1
& 6 = 0 0 0 0 0 1 1 0
---------------------
      0 0 0 0 0 1 0 0 
```

每列中的每一对位都通过“与”函数运行，以在底行给出相应的输出位。所以上面表达式的答案是 4。CPU 已经（在这个例子中）并行完成了 8 次单独的“AND”操作，每列一个。

我提到这个是因为我还记得有这个“啊哈！” 多年前我得知这一点的那一刻。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-11-10T00:04:28.373

位运算符是一次处理一个位的运算符。

仅当两个输入都为 1 时 AND 才为 1。

如果一个或多个输入为 1，则 OR 为 1。

仅当其输入之一恰好为 1 时，XOR 才为 1。

只有当它的输入为 0 时才为 1。

这些可以最好地描述为真值表。输入可能性位于顶部和左侧，结果位是显示在两个输入交叉处的四个（在 NOT 的情况下为两个，因为它只有一个输入）值之一。

```
AND|0 1      OR|0 1
---+----    ---+----
  0|0 0       0|0 1
  1|0 1       1|1 1

XOR|0 1     NOT|0 1
---+----    ---+---
  0|0 1        |1 0
  1|1 0 
```

一个例子是，如果你只想要一个整数的低 4 位，你将它与 15（二进制 1111）相加，所以：

```
 203: 1100 1011
AND  15: 0000 1111
------------------
 IS  11: 0000 1011 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-11-10T00:03:13.273

这些是位运算符，JavaScript 都支持：

*   `op1 & op2`--`AND`运算符比较两个位，如果两个位都为 1，则生成结果 1；否则，它返回 0。

*   `op1 | op2`--`OR`运算符比较两个位，如果位互补，则生成结果 1；否则，它返回 0。

*   `op1 ^ op2`--`EXCLUSIVE-OR`运算符比较两个位，如果其中一个位为 1，则返回 1，如果两个位为 0 或 1，则返回 0。

*   `~op1`--`COMPLEMENT`运算符用于反转操作数的所有位。

*   `op1 << op2`--`SHIFT LEFT`运算符向左移动位，丢弃最左边的位，并将最右边的位赋值为 0。每次向左移动都会有效地将 op1 乘以 2。

*   `op1 >> op2`--`SHIFT RIGHT`运算符向右移动位，丢弃最右边的位，并将最左边的位赋值为 0。每次向右移动有效地将 op1 分成两半。最左边的符号位被保留。

*   `op1 >>> op2`-- `SHIFT RIGHT`-`ZERO FILL`运算符将位向右移动，丢弃最右边的位，并将最左边的位赋值为 0。每次向右移动有效地将 op1 分成两半。最左边的符号位被丢弃。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-10T00:14:43.203

为了进一步分解，它与所讨论值的二进制表示有很大关系。

```
例如（十进制）：
x = 8
y = 1

会出来（二进制）：
x = 1000
y = 0001

从那里，您可以进行计算操作，例如“与”或“或”；在这种情况下：
x | y =
1000
0001 |
------
1001

或...9 十进制

```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-10T00:26:02.040

当提到“按位”一词时，有时会澄清这不是“逻辑”运算符。

例如，在 JavaScript 中，[按位运算符将其操作数视为 32 位（零和一）的序列](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Bitwise_Operators)；同时，[逻辑运算符通常与布尔（逻辑）值一起使用，](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Logical_Operators)但可以与非布尔类型一起使用。

以 expr1 && expr2 为例。

> 如果可以转换为 false，则返回 expr1；否则，返回 expr2。因此，当与布尔值一起使用时，如果两个操作数都为真，则 && 返回真；否则，返回 false。

```
a = "Cat" && "Dog"     // t && t returns Dog
a = 2 && 4     // t && t returns 4 
```

正如其他人所指出的，2 和 4 是按位与，因此它将返回 0。

您可以将以下内容复制到 test.html 或其他内容并进行测试：

```
<html>
<body>
<script>
    alert("\"Cat\" && \"Dog\" = " + ("Cat" && "Dog") + "\n"
        + "2 && 4 = " + (2 && 4) + "\n"
        + "2 & 4 = " + (2 & 4));
</script> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-21T07:02:19.427

> 在数字计算机编程中，按位运算在一个或多个位模式或二进制数字的各个位级别上进行操作。它是处理器直接支持的快速、原始的操作，用于操作值以进行比较和计算。

**操作**：

*   按位与

*   按位或

*   按位非

*   按位异或

*   ETC

项目清单

```
 AND|0 1        OR|0 1 
    ---+----      ---+---- 
      0|0 0         0|0 1 
      1|0 1         1|1 1 

   XOR|0 1        NOT|0 1 
   ---+----       ---+--- 
     0|0 1           |1 0 
     1|1 0 
```

例如。

```
 203: 1100 1011
AND  15: 0000 1111
------------------
  =  11: 0000 1011 
```

**位运算符的使用**

*   左移和右移运算符分别相当于 x * 2 ^y的乘法和除法。

例如。

```
int main()
{
     int x = 19;
     printf ("x << 1 = %d\n" , x <<1);
     printf ("x >> 1 = %d\n", x >>1);
     return 0;
}
// Output: 38 9 
```

*   & 运算符可用于快速检查数字是奇数还是偶数

例如。

```
int main()
{
    int x = 19;
    (x & 1)? printf("Odd"): printf("Even");
    return 0;
 }
// Output: Odd 
```

*   快速查找 x 和 y 的最小值，无需`if else`声明

例如。

```
int min(int x, int y)
{
    return y ^ ((x ^ y) & - (x < y))
} 
```

*   十进制到二进制转换

例如。

```
#include <stdio.h>
int main ()
{
    int n , c , k ;
    printf("Enter an integer in decimal number system\n " ) ;
    scanf( "%d" , & n );
    printf("%d in binary number
    system is: \n " , n ) ;
    for ( c = 31; c >= 0 ; c -- )
    {
         k = n >> c ;
         if ( k & 1 )
              printf("1" ) ;
         else
              printf("0" ) ;
      }
      printf(" \n " );
      return 0 ;
} 
```

*   异或门加密是一种流行的技术，因为它的复杂性和程序员可以使用。
*   从技术面试的角度来看，按位异或运算符是最有用的运算符。

*按位移位仅适用于 +ve 数字*

**位逻辑的使用范围也很广**

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-20T14:30:49.533

以这种方式思考它可能会有所帮助。这就是 AND (&) 的工作原理：

它基本上说这两个数字都是数字，所以如果你有两个数字 5 和 3，它们将被转换为二进制，计算机会认为

```
 5: 00000101
         3: 00000011 
```

都是一：00000001 0 为假，1 为真

所以 5 和 3 的 AND 是一。OR (|) 运算符执行相同的操作，只是其中一个数字必须为 1 才能输出 1，而不是两者。

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2009-02-10T00:35:44.707

我一直听说 JavaScript 位运算符有多慢。[我为我最新的博客文章](http://dreaminginjavascript.wordpress.com/2009/02/09/bitwise-byte-foolish/)做了一些测试，发现它们在几个测试中比算术替代方法快 40% 到 80%。也许他们曾经很慢。在现代浏览器中，我喜欢它们。

我的代码中有一个案例，因此会更快、更容易阅读。我会睁大眼睛了解更多。

# php - memcached 数据缓存的设计模式

> ID：276709
> 
> 赞同：10
> 
> 时间：2008-11-10T00:01:31.933
> 
> 标签：php, database, design-patterns, oop, memcached

围绕现有数据库查询包装可选的 memcached 缓存很容易。例如：

旧的（仅限 DB）：

```
function getX
    x = get from db
    return x
end 
```

新的（带有内存缓存的数据库）：

```
function getX
    x = get from memcache
    if found
      return x
    endif

    x = get from db
    set x in memcache
    return x
end 
```

但问题是，这并不总是您想要缓存的方式。例如，采取以下两个查询：

```
-- get all items (recordset)
SELECT * FROM items;

-- get one item (record)
SELECT * FROM items WHERE pkid = 42; 
```

如果我要使用上面的伪代码来处理缓存，我将存储项目 42 的所有字段两次。一次进入大记录集，一次独立。而我宁愿做这样的事情：

```
SELECT pkid FROM items; 
```

并缓存 PK 的索引。然后单独缓存每条记录。

所以总而言之，最适合数据库的数据访问策略并不完全适合 memcache 策略。由于我希望 memcache 层是可选的（即，如果 memcache 关闭，站点仍然可以工作）我有点想要两全其美，但要做到这一点，我很确定我需要维护一个许多查询有 2 种不同的形式（1\. 获取索引，然后是记录；2\. 在一个查询中获取记录集）。分页变得更加复杂。使用 DB，您可以执行 LIMIT/OFFSET SQL 查询，但使用 memcache，您只需获取 PK 的索引，然后批量获取数组的相关切片。

我不知道如何巧妙地设计这个，有人有什么建议吗？

更好的是，如果你自己遇到了这个问题。你如何处理它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T02:01:42.473

如果您正在使用缓存，那么为了充分利用它，您必须接受您的数据在一定程度上总是过时的，并且某些部分的数据将彼此不同步。通过维护一个副本来保持所有记录是最新的最好留给关系数据库，所以如果这是您需要的行为，那么您可能最好使用具有大量 RAM 的强大 64 位数据库服务器因此它可以执行自己的内部缓存。

如果您可以接受陈旧数据（如果真正的可伸缩性很重要，您将需要这样做），那么一种方法是将整个结果集放入缓存中；不用担心重复。内存很便宜。如果您发现您的缓存已满，那么只需购买更多 RAM 和/或缓存服务器。例如，如果您有一个查询表示一组按条件 X 和 Y 过滤的项目 1-24，然后使用包含所有这些信息的缓存键，然后当再次要求进行相同的搜索时，只需从缓存。您要么一键从缓存中获取完整的结果集，要么转到数据库。

最困难的事情是计算出有多少数据可能是陈旧的，以及在不（a）人们注意到太多，或（b）破坏业务要求（例如最小更新间隔）的情况下，它可能会过时。

这种方法适用于以读取为主的应用程序，特别是具有分页查询和/或数据过滤条件有限集的应用程序。这也意味着您的应用程序在打开或关闭缓存的情况下的工作方式完全相同，只是在缓存关闭时命中率为 0%。在几乎所有情况下，这都是我们在 blinkBox 采用的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T01:38:55.873

阅读有关[身份映射](http://martinfowler.com/eaaCatalog/identityMap.html)模式的信息。这是一种确保您在应用程序空间中只保留给定行的一个副本的方法。无论您将其存储在 memcached 中还是仅存储在普通对象中，这都是一种处理您想要的内容的方法。我猜想当您通常一次获取一行时，最好使用 Identity Map。

当您获取表的整个子集时，您必须单独处理每一行。您可能经常面临是否从缓存中获得最佳使用的两难境地，因为如果 99% 的行都在缓存中但需要从数据库中获取，那么无论如何您都必须运行 SQL 查询（至少一次）。

您可以转换 SQL 查询以仅获取不在缓存中的行，但在不增加 SQL 查询成本的情况下自动执行此转换并非易事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T01:22:21.490

好吧，我想这是你必须忍受的。如果您不真正分批做事，Memcahced 会工作得最好。例如，它非常适合“这个用户的东西在哪里？这是给这个用户的一堆东西”之类的东西。这并不意味着这个查询不做批处理。当然会 - 如果某些用户的东西是他/她的帖子之类的东西。

我想你会遇到的问题是，你正在混合需要自己从数据库中获取一个项目的查询和一些需要一堆相同类型的先前项目的情况。

这种情况总是有另一面。如果您真的想对您的实现感到毛茸茸，您可以更改您的批处理查询以不包括 memcached 中已经存在的项目。非常非常难看...

在我看来，它总是归结为“我**真正**想要缓存哪些查询？”

编辑：

我会这样做的方法是：

*   单项查询 - 如果在 memcached 中，则使用该查询，否则从数据库中获取并更新 memcached。
*   批量查询 - 不用担心 memcached 中有哪些项目，只需获取所有内容并更新 memcached。

这当然假设批处理查询已经花费了更多的时间来完成，所以我已经花了很多时间来处理已经缓存的项目的外部查找。

但是，如果您大量使用批量查询，最终您的缓存将包含很多项目。因此，您必须权衡利弊，以确定您仍希望在什么时候执行数据库查找。好消息是，如果批处理查询在应用程序的生命周期中更早，那么所有内容都会更早地被缓存。在第一批查询之后，您可以告诉自己不再需要从数据库中获取，除非缓存中的数据因更新或删除而失效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-24T13:16:09.810

这是我对 NHibernate（因此可能是 Hibernate）如何做到这一点的理解。它有 4 个缓存：

*   行缓存：缓存数据库行。缓存键是 TableName#id，其他条目是行值。
*   查询缓存：缓存为特定查询返回的结果。缓存键是带有参数的查询，数据是作为查询结果返回的 TableName#id 行键的列表。
*   集合缓存：这会缓存任何给定父对象的子对象（NHibernate 允许延迟加载）。因此，如果您访问 myCompany.Employees，员工集合将被缓存在集合缓存中。缓存键是 CollectionName#entityId，数据是子行的 TableName#id 行键的列表。
*   表更新缓存：每个表的列表以及上次更新的时间。如果在缓存数据后更新了表，则数据被认为是陈旧的。

这是一个非常灵活的解决方案，在空间方面非常有效，并保证数据不会过时。缺点是单个查询可能需要多次往返缓存，如果缓存服务器在网络上，这可能会成为问题。

# android - 任何人都对为 Google Android 设备进行开发有任何印象、提示和教程吗？

> ID：276719
> 
> 赞同：10
> 
> 时间：2008-11-10T00:07:33.047
> 
> 标签：android, sdk

我有一个`T-Mobile G1`，我将下载开发人员 SDK，看看是否可以为我的手机创建一些简单的应用程序。如果您做过类似的开发，请在下面回答并告诉我您的经验。请分享您发现特别有用的任何链接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-13T19:37:55.983

我没有发现 SDK 文档有那么大的帮助，至少一开始是这样。真正开始的是从 CommonsWare查看**The Busy Coder's Guide to Android的示例章节。**你可以[在本书的网站上](http://commonsware.com/Android/index.html)找到这个。该链接还提供了本书的代码示例。

这些示例中提供的示例代码以及 SDK 中包含的示例代码让我很好地了解了从哪里开始。我在很多事情上还不是很扎实，但是发展比以前快了很多。

您肯定要确保做的一件事是观看 Google 提供的视频。Android 的应用程序生命周期与传统应用程序有很大不同，因此您需要确保您了解意图、视图和内容提供程序是什么。这些视频都可以在 YouTube 上的[这个播放列表](http://www.youtube.com/view_play_list?p=8D19D01A9F4AA199)中看到。

我可以指出的最后一个有用的资源是博客社区。时不时地，[Planet Android](http://planetandroid.com/)和[Hello Android](http://helloandroid.com/)会从它们聚合的博客中摘录代码。[Jeffrey Sharkey 热衷](http://jsharkey.org/)于 Android 开发，并在他的博客上发布了一些有用的代码。

Android 开发目前很像在黑暗中拍摄，但它有望尽快起飞并为我们提供更多有价值的资源！我知道那里[有](https://rads.stackoverflow.com/amzn/click/com/1430210648) [几](https://rads.stackoverflow.com/amzn/click/com/0071599886) [本书](https://rads.stackoverflow.com/amzn/click/com/1934356174)。祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-28T22:47:27.597

我建议的最重要的事情是确保您真正了解 Android 应用程序的生命周期。许多应用程序都出现崩溃或性能不佳（或使整个手机运行不佳），因为它们的设计并未正确遵循应用程序生命周期。

对于简单的应用程序，无需担心，但很快您可能想在后台运行一些东西（播放音乐等），或者如果用户切换应用程序时需要保存您的状态。这很棘手，但一旦你看到一些例子就有意义了。

您还可以查看 5 月 Google I/O 开发者大会上的一些 Android 会议：

*   [安卓简介](http://sites.google.com/site/io/an-introduction-to-android)
*   [构建 Android 应用程序 101](http://sites.google.com/site/io/building-an-android-application)
*   [Android 的解剖学和生理学](http://sites.google.com/site/io/anatomy--physiology-of-an-android)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-10T00:11:55.597

我从这里开始

[http://code.google.com/android/kb/commontasks.html](http://code.google.com/android/kb/commontasks.html)

我在大约 15 分钟内启动并运行了我的环境和模拟器。

第一印象是使用起来很有趣。

保罗

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-16T16:05:05.913

我发现[记事本教程](http://code.google.com/android/intro/tutorial.html)对理解基础知识非常有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-19T12:21:03.970

我也开始涉足 android 开发。老实说，我认为那里的一些书籍很好地解释了开发框架并让您快速开始使用这些工具。我正在阅读的一些书籍包括《24 小时内自学 Android 应用程序开发》（显然标题是夸大其词；这本书只是按小时组织。对于初学者来说，每个小时都需要一些时间）、《你好，Android : 介绍 Google 的移动开发平台（第 3 版）”和“开始 Android 2”。根据我目前有限的经验，使用 SDK 进行开发是可访问且令人愉快的。话虽如此，您确实需要投入时间/精力来跟上进度。

# file - 使用文件的注意事项

> ID：276729
> 
> 赞同：1
> 
> 时间：2008-11-10T00:15:33.450
> 
> 标签：file, dos-donts

我正在为编程课的初级学生准备一个关于文件的讲座。我要阐述的要点之一是文件的良好做法。

在任何编程语言中使用文件时要记住什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T00:41:50.560

*   可以认为文件包含一组*记录*，每个记录要么是*固定长度，要么以**分隔符*结尾。

*   文件通常针对*顺序访问*进行优化，而不是*随机访问*。很难将数据插入到文件的中间，而且线性处理文件（如盒式磁带）通常比随机处理文件（如“随机播放”模式下的 CD）更快。

*   随机存取文件通常包含固定长度的记录，其中大部分包含空白空间，使得它们比顺序存取文件大。

*   文件是喜怒无常且不可预测的生物。他们可以更改长度、消失、更改访问权限*等*。在访问之间，因此请仔细*验证*您的操作并*检查返回码*。

*   如果您从头（尾）读取并写入尾（头），则文件可以用作*缓冲区。*

*   *冲洗你的缓冲区！*

既然还没有人这么说：这应该让你的学生掌握这个主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T00:25:24.633

总是安装一只抓挠猴子。

[http://catb.org/jargon/html/S/scratch-monkey.html](http://catb.org/jargon/html/S/scratch-monkey.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T06:08:18.107

我发现初级程序员经常缺乏直觉，或者在访问文件的速度方面学到了错误的教训。

非常新的程序员认为文件非常快，需要帮助理解为什么从无缓冲文件中一次读取一个字节是一个坏主意。类似地，访问目录信息可能非常慢，如果可能，应该缓存。

不幸的是，一些更有经验的程序员吸取了错误的教训，并认为一切都需要缓存在 RAM 中，否则会太慢。现代操作系统具有非常复杂的磁盘缓存，因此您第二次访问文件的同一部分时可能会明显更快。

最后，交互式程序应该在另一个线程中执行所有文件操作，因此当磁盘繁忙或远程卷暂时不可用时，您的应用程序不会慢到爬行或停止工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T00:16:29.237

完成后请记住关闭它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T00:18:52.040

## 文件总是不安全的

与任何其他输入一样，文件会增加安全风险。此外，它可能是格式错误的，要么是因为它是由过时的应用程序创建的，要么是因为最终用户试图自己修改它们。

要么完全忽略这样的文件，要么尽可能多地获取并丢弃其余文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T00:19:10.340

完成后，请始终关闭文件并处理所有资源。

在二进制文件上使用读取二进制文件并在文本文件上读取。（不记得有多少次我帮助那些代码没有读取整个文件的人，因为他们正在读取带有文本结构的二进制文件，并且文件中间恰好有一个 ^Z）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-10T00:20:19.480

做：

*   不再需要临时文件时删除它们

不：

*   不要在用户目录中创建随机文件（例如我的文档）。为此使用临时/程序文件夹
*   不要将敏感信息保存在纯文本文件中

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-10T01:18:40.360

如果您正在编写服务器端或并发代码，请密切注意文件锁定：太少会导致数据损坏，太多会导致应用程序死锁。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-10T02:01:21.617

Vista 在程序目录中有新的权限内容，因此创建文件的程序在安装在 vista 上时可能会出现问题（易于修复但同样烦人）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-10T06:01:11.960

*   不要在每次写入后刷新。
*   不要担心进行小的写入和读取。操作系统非常擅长缓冲这些。不要试图重新发明自己的缓冲方案。在最好的情况下，它什么也不做。最糟糕的是，它实际上会对抗操作系统的缓冲。
*   不要创建包含数千个文件的目录。
*   如果发生变化，人们会想要查看或编辑数据。确保它是人类可读的。
*   在考虑提取您自己的格式之前，请考虑 XML。

# css - CSS ul li 图像与文本对齐

> ID：276732
> 
> 赞同：12
> 
> 时间：2008-11-10T00:16:29.987
> 
> 标签：css

我有一个这样的 CSS

```
ul {
    list-style-image:url(images/bulletArrow.gif);
}

ul li {
    background: url(images/hr.gif) no-repeat left bottom;
    padding: 5px 0 7px 0;
} 
```

但是项目符号图像在 IE 中没有正确对齐（在 Firefox 中很好）。我已经有 li 的背景图片，所以我不能使用子弹图片作为背景。有什么解决办法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-10T01:14:52.207

这里有一个很好的解释和解决方案：http: [//css.maxdesign.com.au/listutorial/master.htm](http://css.maxdesign.com.au/listutorial/master.htm)

它说使用`list-style-image`导致图像在不同浏览器中的位置不一致。然后它解释了如何为子弹使用背景图像以获得更好的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-26T18:13:14.027

使用行高:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T01:24:43.640

我看到您正在删除列表项的左填充。对于 IE，您需要对左边距执行相同的操作 - 完全删除它（设置为零）或使其小于默认值。然后您的列表项将很好地对齐。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T01:41:44.573

谢谢你们俩。问题是我已经使用背景作为行分隔符。但我会将其更改为边框，然后我将使用背景作为项目符号图像。

# ms-access - 规范化现有的 MS Access 数据库

> ID：276737
> 
> 赞同：3
> 
> 时间：2008-11-10T00:20:04.330
> 
> 标签：ms-access, normalizing

我有一个大型访问数据库，需要将其规范化为五个表和一个查找表。我了解规范化背后的理论，并且已经勾勒出表格的外观，但我不知道如何转换表格以使数据库标准化。表格分析器不提供我想要的细分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-10T02:50:03.467

如果您有一个表，请向其中添加一个自动编号字段。

然后创建其他表，并使用原始单个表中的自动编号值作为外键将它们连接回原始数据。

如果你有 tblPerson：

```
 tblPerson
  LastName, FirstName, WorkPhone, HomePhone 
```

你想把它分解，添加 PersonID 自动编号，然后创建一个电话表：

```
 tblPhone
  PhoneID, PersonID, PhoneNumber, Type 
```

然后，您将从 tblPerson 为适当的字段附加数据：

```
 INSERT INTO tblPhone (PersonID, PhoneNumber, Type)
  SELECT tblPerson.PersonID, tblPerson.WorkPhone, "Work"
  FROM tblPerson
  WHERE tblPerson.WorkPhone Is Not Null; 
```

然后你会为家庭电话运行另一个查询：

```
 INSERT INTO tblPhone (PersonID, PhoneNumber, Type)
  SELECT tblPerson.PersonID, tblPerson.HomePhone, "Home"
  FROM tblPerson
  WHERE tblPerson.HomePhone Is Not Null; 
```

有人建议了一个 UNION 查询，您必须保存它，因为您不能将 UNION 查询作为 Jet SQL 中的子选择。保存的查询看起来像这样：

```
 SELECT tblPerson.PersonID, tblPerson.WorkPhone, "Work" As Type
  FROM tblPerson
  WHERE tblPerson.WorkPhone Is Not Null
  UNION ALL 
  SELECT tblPerson.PersonID, tblPerson.HomePhone, "Home" As Type
  FROM tblPerson
  WHERE tblPerson.HomePhone Is Not Null; 
```

如果您将其保存为 qryPhones，那么您将使用以下 SQL 附加 qryPhones：

```
 INSERT INTO tblPhone (PersonID, PhoneNumber, Type)
  SELECT qryPhones.PersonID, qryPhones.WorkPhone, qryPhones.Type
  FROM qryPhones; 
```

显然，这只是最简单的例子。你会为所有领域做同样的事情。关键是您必须为源表创建一个 PK 值，它将所有派生记录绑定回原始表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T00:23:03.373

查询，尤其是联合查询，能否提供解决方案？你在哪里看到问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T00:50:24.503

该数据库是一个非常典型的数据库，没有什么特别之处可以与其他数据库区分开来。

该数据库由一张表组成，其中：

公司名称、地址、电话等典型相关领域的联系人

这基本上将用作营销数据库，我将需要跟踪事件、业务通信等。我只是迷失在如何保持关系完好无损。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T01:02:57.973

您是指关系窗口中的关系吗？这些可以很容易地重建。或者你的意思是关键领域等？这有时可能很困难，并且可能涉及中间表。每种情况都不同。正如 doofledorfer 所说，如果您发布模式，您可能会得到更具体的建议。

# svn - 是否可以从 Subversion 获取添加或删除文件的列表？

> ID：276740
> 
> 赞同：8
> 
> 时间：2008-11-10T00:22:29.787
> 
> 标签：svn

我想检索例如上个月从我们的 Subversion 存储库中添加或删除的文件的列表。

我更喜欢有文件名，而不仅仅是计数。

这可以从 Subversion 命令行中实现吗，还是我需要使用脚本来搜索日志？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-10T00:27:36.577

我认为您不能仅使用命令行工具来完成它，但是以 XML 格式输出它并进行一些 grepping 或过滤可能会给您想要的东西。

试试这个：

```
svn log -v --xml | grep 'action="[A|D]"' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-16T14:04:39.670

我使用以下几行创建 2 个文件，其中包含已添加和已删除文件的列表。当它不是主要的开发环境时，它对于更新 Visual Studio 项目非常有用。

```
svn diff -r 14311:HEAD --summarize | findstr "^A" > AddedFiles.txt
svn diff -r 14311:HEAD --summarize | findstr "^D" > DeletedFiles.txt 
```

在示例中，它找到了修订版 14311 和 HEAD 之间的所有差异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-27T23:39:54.993

我使用 SVN 日志命令和 grep 的混搭来获取删除内容。例如

```
% svn log -v -r \{2013-09-01\}:\{2013-10-31\}|grep '  D' 
```

将列出 2013 年 9 月至 2013 年 10 月从当前分支中删除的文件（或者...任何其他带有“空间、空间、dee”的文件）

# rest - 使用 Adob e Air 使用 REST API

> ID：276754
> 
> 赞同：3
> 
> 时间：2008-11-10T00:27:36.453
> 
> 标签：rest, air

有人可以向我展示一个使用 REST API 的 Adob​​e Air 应用程序（使用 Javascript）的好例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T15:22:46.300

如果您打算使用 Javascript（而不是 Flex）来构建功能，那么 AFAIK 您不需要特定于 AIR 的示例；JS 代码可以并且应该与应用程序在标准浏览器中运行时相同。任何关于通过 Javascript（或 AJAX）使用 RESTful Web 服务的一般教程就足够了。虽然我不知道使用这种方法的任何具体教程，但可能有一些。

即使您没有找到任何专门针对在 Javascript 中使用 RESTful Web 服务的教程或示例，您仍然应该能够理解 JS XMLHttpRequest 对象本质上只是一个相当标准的 HTTP 客户端工具。一旦理解了这一点，您就可以分别了解 REST 和 HTTP，然后将这些知识结合起来构建您的应用程序。

我强烈推荐这本书[RESTful Web Services](http://www.crummy.com/writing/RESTful-Web-Services/)；对RESTful Web Services有很好的解释，理论与实践的完美平衡。它甚至有一章题为“作为 REST 客户端的 Ajax 应用程序”。所以你可能想把它捡起来。

# c - 专业的#include 内容

> ID：276757
> 
> 赞同：0
> 
> 时间：2008-11-10T00:30:06.010
> 
> 标签：c, api, include, header

我需要创建一个 API，允许我的客户的开发人员使用专有的 C 模块，该模块将作为库发布（想想`.lib`或`.so`——不是源代码）。

我想让标题尽可能对开发人员友好（所以我不需要这样做），遵循最佳实践并提供带有描述、示例、警告*等*的评论。

我还应该从业务、技术和普通常识的角度考虑什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T00:56:22.107

一种选择是使用（例如）Doxygen 从标头生成 API 文档。显然，您仍然会随代码一起提供文档。

这给你两个好处：

1）您不必太担心应该在“文档中”还是“在标题中的注释中”，因为更改一个与更改另一个一样容易。所以一切都在文档中。

2）用户不太可能首先阅读您的头文件，因为他们可以合理地确信所有感兴趣的内容都在文档中。但即使他们是顽固的“我不信任文档，我阅读代码”类型，他们仍然会看到您希望他们看到的一切。

自动生成的 API 文档的缺点是它们可能是搜索的噩梦，因此 IMO 值得付出额外的努力来编写非常好的“介绍性”文档。这可能是也可能不是生成的 API 文档的一部分，这取决于您喜欢什么。对于小型 API，仅按“逻辑”而不是字母或源顺序列出所有函数，根据它们的*用途*而不是它们的作用进行描述，可以更容易进入 API 文档。通过“逻辑”，我的意思是首先列出常用的函数，按照客户端调用它们的顺序，将“做相同类型的事情”的替代方法（如套接字的 send 和 sendTo）组合在一起。然后列出不太常用的功能，

该方法的一个主要困难（可能是阻碍因素）是，根据您的组织，您可能有一个文档团队，并且他们可能无法编辑标题。最好的情况是他们复制编辑您所做的事情，然后您进行更改并将其反馈回来。最坏的情况是整个想法停滞不前，因为“只有文档团队应该编写面向客户的文档，并且必须采用标准格式，我们不能让 Doxygen 输出那种格式”。

至于“您还应该考虑什么”-您已经说过您将遵循最佳实践，因此很难添加太多:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-10T16:37:35.090

其他人提到了文档问题，所以我会远离那些:-P。首先，确保你有理智的包括警卫。我个人倾向于喜欢：

`FILENAME_20081110_H_`，基本上是全部大写的文件名，然后是完整的日期，这有助于确保它足够唯一，即使树中有另一个具有相同名称的标题。（例如，您可以想象从 2 个不同的 lib 目录中包含的两个 config.h 具有使用`CONFIG_H_`或类似的保护，因此会发生冲突。您选择什么并不重要，只要它可能是唯一的。

此外，如果有*任何*机会在 c++ 项目中使用此标头，请将标头包装在如下块中：

```
#ifdef __cplusplus
extern "C" {
#endif

/* your stuff */

#ifdef __cplusplus
}
#endif 
```

这将避免一些因名称修改问题而令人头疼的问题，并使他们不必在外部用这些标题包装标题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-11T21:53:08.183

请漂亮请确保您不（重新）定义可能在其他任何地方定义的符号。我不只是指标准名称，请在公共标头中声明/定义的所有符号加上特定字符串的前缀，并避免使用任何其他人可能曾经使用过的名称。

在“专业”公开可用的标题中看到太多这样的疯狂之后，我这样说：

```
typedef unsigned short uchar; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T00:44:33.893

头文件本身应该干净整洁，并且可能接近最小。它应该指向可以找到文档的位置。它可能不应该包含完整的示例（尽管我自己的一些标题会这样做）。它应包括有关版权和许可的基本信息以及作者详细信息。它应该只包含最终用户需要的东西——没有只有开发人员需要的东西。它应该是独立的；它应该包括使其工作所需的任何其他标头（因此用户可以编写' `#include "your-header.h"`'并且代码将干净地编译，即使这是它们包含的第一个或唯一的标头）。

*补充*：标题也应该包含一些基本的版本信息（文件修订号和修改日期，和/或产品发布版本号和发布日期）。这有助于人们查看软件的两个版本——成功的软件不止一次发布。

*补充*：亚当让我扩展“只有开发人员需要的东西”。这意味着，例如，即使内部函数可能使用某种结构类型，但如果没有外部接口使用该结构类型，那么公共标头不应包含该结构类型的定义。它应该位于未分发的私有标头中（或仅与完整源一起分发）。它不应该污染公共标头。说“只是浪费了一点点空间”很诱人，说的很准确，但如果每个人都浪费一点点空间和时间，那么总的浪费就会变得昂贵。

公共标头的关键在于它应该包含库用户（函数集）需要的所有内容，而不是他们不需要的任何内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-10T00:35:12.397

考虑实际编写单独的文档。我认为 man/info 页面提供了一个很好的例子来说明 API 文档应该是什么样的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T16:30:57.197

考虑将文档放在网上，除了任何附带的东西，并将 URL 放在标题中。这将允许一些维护程序员在几年后访问文档，即使原件已经丢失。

# mysql - 从 SQL 中的字符串中解析整数

> ID：276758
> 
> 赞同：2
> 
> 时间：2008-11-10T00:30:53.013
> 
> 标签：mysql

我有一个相当大的数据库，其中有一列包含大部分实际上只是整数的字符串，例如“1234”或“345”。然而，其中一些在前面附加了字符串（长度不同），例如“a123”或“abc123”。

有没有一种聪明的方法来创建一个只有整数值的新列？因此，“abc123”会变成“123”吗？我知道我可以读取 PHP 中的所有行，然后使用正则表达式很容易地做到这一点，但我想看看是否有办法让 SQL 为我做这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T00:59:09.963

不幸的是，你不能单独在 MySQL 中做到这一点。MySQL 具有正则表达式匹配功能，但没有正则表达式替换功能。您最好的选择是在 PHP 中使用正则表达式来执行替换。[（[来源](http://forums.mysql.com/read.php?20,54128,54199)）]

```
$sql = "SELECT `id`, `myMixedColumn` FROM `myTable` "
     . "WHERE `myMixedColumn` NOT RLIKE '^[[:digit:]]+$'";
$r = mysql_query($sql);

$updates = array();
while ($row = mysql_fetch_assoc($r)) {
    $updates = sprintf("UPDATE `myTable` SET `myIntField` = %s WHERE `id` = %d",
        preg_replace("@\\D@", "", $row['myMixedColumn']),
        $row['id']
    );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T05:43:09.983

如果您真的想在 SQL 中执行此操作，只是为了不在 PHP 中执行，您可以创建一个小函数来执行此操作，直到 MySQL 实现正则表达式替换，但我不会在性能上打任何赌。

只有当字母在开头并且除了 [a-zA-Z] 之外没有其他字符时，这样的事情才会起作用。而且您必须检查它如何在不同的字符集中运行。

```
CREATE FUNCTION last_letter(s VARCHAR(100)) RETURNS INT
BEGIN
  DECLARE last, current INT default 0;
  DECLARE letter_a INT;
  DECLARE letter_z INT;
  DECLARE letter_iter INT;
  SELECT ord('a') INTO letter_a;
  SELECT ord('z') INTO letter_z;
  SET letter_iter = letter_a;
  # Will loop for all letters a to z
  WHILE letter_iter <= letter_z DO
    # Will get the last case-insensitive occurrence of a letter
    SELECT LOCATE(CHAR(letter_iter), REVERSE(LOWER(s))) INTO current;
    IF current > 0 THEN
      SELECT LENGTH(s) - current + 1 INTO current;
    END IF;
    # Was that the rightmost letter?
    IF current > last THEN
      SET last = current;
    END IF;
    SET letter_iter = letter_iter + 1;
  END WHILE;
  # Return the max we found
  RETURN last;
END; // 
```

然后获取整数值：

```
UPDATE test_table SET int_result = 
  CAST(SUBSTR(str_value, last_letter(str_value) + 1) AS SIGNED); 
```

# c++ - 向 Python 公开 C++ API

> ID：276761
> 
> 赞同：41
> 
> 时间：2008-11-10T00:34:50.073
> 
> 标签：c++, python, boost, swig

我目前正在做一个项目，我必须用 Python 包装 C++ 类才能编写程序脚本。所以我的具体经验还涉及在我们的程序中嵌入 Python 解释器。

我尝试的替代方案是：

*   Boost.Python

    我喜欢 Boost.Python 生成的更简洁的 API，但它需要用户安装额外的依赖项这一事实使我们切换到 SWIG。

*   痛饮

    SWIG 对我们来说的主要优势是它不需要最终用户安装它来使用最终程序。

你以前做过什么，你有什么经验？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-10T07:41:53.237

我已经使用了两者（对于同一个项目）：Boost 与 STL 更好地集成，尤其是 C++ 异常。此外，它的内存管理机制（试图桥接 C++ 内存管理和 Python GC）比 SWIG 更灵活。但是，SWIG 具有*更好的*文档，没有外部依赖项，并且如果您将库包装在 SWIG for Python 中，那么您也可以获得 Java/Perl/Ruby 包装器的一半以上。

我不认为有一个明确的选择：对于较小的项目，我会再次使用 Boost.Python，对于较大的长期项目，对 SWIG 的额外投资是值得的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-13T23:03:19.487

编辑 - Robin 项目遗憾地被放弃了，今天不会有太大用处

我使用[Robin](http://code.google.com/p/robin/)取得了巨大的成功。

**与 C++ 类型的完美集成，并创建单个 .cpp 文件来编译并包含在您的共享对象中**。****

 *** * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-13T14:45:33.437

我建议[SIP](http://www.riverbankcomputing.co.uk/software/sip/intro)。由于以下原因，SIP 优于 SWIG：

1.  对于给定的一组文件，swig 生成的重复（开销）代码比 SIP 多。SIP 通过使用可以静态或动态链接的库文件来设法生成更少的重复（开销）代码。换句话说，SIP 具有更好的可扩展性。

2.  SIP 的执行时间远小于 SWIG。请参阅[Python 包装器工具：性能研究](http://people.web.psi.ch/geus/talks/europython2004_geus.pdf)。不幸的是，链接似乎已损坏。我有一份个人副本，可应要求共享。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-10T07:42:23.393

[pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)或[cython](http://cython.org/)也是混合这两个世界的好方法。

使用这些工具封装 C++ 比封装 C 有点棘手，但可以做到。[这](http://wiki.cython.org/WrappingCPlusPlus)是关于它的维基页面。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-11T11:27:15.507

Boost::Python 的一大优点是它允许在 ipython shell 中完成制表符：您导入一个由 Boost 直接公开的 C++ 类，或者您将其子类化，从那时起，它的行为就像一个纯 Python 类。

缺点：安装和使用 Boost 需要很长时间，以至于所有 Tab 完成时间节省都不会摊销；-(

所以我更喜欢 Swig：没有花里胡哨的东西，但在一个简短的介绍性示例之后可以可靠地工作。

# c# - ASP.NET MVC 路由

> ID：276766
> 
> 赞同：11
> 
> 时间：2008-11-10T00:37:17.930
> 
> 标签：c#, asp.net-mvc, .net-3.5, c#-3.0, asp.net-mvc-routing

我需要有关此路线图的帮助

```
routes.MapRoute("Blog_Archive", 
                "Blog/Archive/{year}/{month}/{day}",
                new { 
                      controller = "Blog",
                      action = "archive",
                      year = "",
                      month = "",
                      day = "",
                      page = 0
                    }); 
```

当我调用**[http://localhost:5060/blog/Archive/2008/11](http://localhost:5060/blog/Archive/2008/11)**时，它会获取年份和月份并将其发送到控制器。但是当我尝试**[http://localhost:5060/blog/Archive/2008](http://localhost:5060/blog/Archive/2008)**
时，它会将其发送到控制器，但 year 参数为空，所有其他参数也是如此。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-10T00:40:05.163

您还有其他用于博客/存档/{something} 的路线吗？

使用[路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)查看实际命中的路由，很可能它没有命中该路由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T15:30:58.730

Subnus，我在您的代码中注意到您有 routes.IgnoreRoute("favicon.ico"); 我认为 MVC 1.0 不需要这样做，因为该句点不再被忽略，对吗？

# c++ - 如何暴露 std::vector 作为使用 SWIG 的 Python 列表？

> ID：276769
> 
> 赞同：18
> 
> 时间：2008-11-10T00:38:59.253
> 
> 标签：c++, python, stl, swig

我正在尝试使用 SWIG 将此函数公开给 Python：

```
std::vector<int> get_match_stats(); 
```

我希望 SWIG 为 Python 生成包装代码，以便我可以将其视为整数列表。

将此添加到 .i 文件中：

```
%包括“typemaps.i”
%包括“std_vector.i”

命名空间标准
{
  %template(IntVector) 向量<int>;
}

```

我正在跑步`SWIG Version 1.3.36`并与 swig 通话`-Wall`，但没有收到任何警告。

我能够访问一个列表，但是在使用`-Wall`(with `g++ (GCC) 4.2.4`) 生成的 C++ 代码进行编译时会收到一堆警告，这些代码说：

```
  警告：取消引用类型双关指针将破坏严格别名规则

```

我是否正确地公开了该功能？如果是这样，警告是什么意思？

* * *

这些是同一函数中违规行之前的行：

```
SWIGINTERN PyObject *_wrap_IntVector_erase__SWIG_0(PyObject *SWIGUNUSEDPARM(self), PyObject *args) {
  PyObject *resultobj = 0;
  std::vector *arg1 = (std::vector *) 0 ;
  std::vector::iterator arg2 ;
  std::vector::iterator 结果；
  无效 *argp1 = 0 ;
  整数 res1 = 0 ;
  swig::PySwigIterator *iter2 = 0 ;
  诠释 res2 ;
  PyObject * obj0 = 0 ;
  PyObject * obj1 = 0 ;

  if (!PyArg_ParseTuple(args,(char *)"OO:IntVector_erase",&obj0,&obj1)) SWIG_fail;
  res1 = SWIG_ConvertPtr(obj0, &argp1,SWIGTYPE_p_std__vectorT_int_std__allocatorT_int_t_t, 0 | 0);
  如果（！SWIG_IsOK（res1））{
    SWIG_exception_fail(SWIG_ArgError(res1), "in method '" "IntVector_erase" "', 参数 ""1"" of type '" "std::vector *""'");
  }
  arg1 = reinterpret_cast * >(argp1);

```

这是有问题的行：

```
  res2 = SWIG_ConvertPtr(obj1, SWIG_as_voidptrptr(&iter2), swig::PySwigIterator::descriptor(), 0);

```

更多代码如下。

使用 g++ 4.2.4 编译时产生的警告是：

```
swig_iss_wrap.cxx：在函数'PyObject* _wrap_IntVector_erase__SWIG_0（PyObject*，PyObject*）'中：
swig_iss_wrap.cxx:5885：警告：取消引用类型双关指针将破坏严格的别名规则

```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-10T11:44:15.637

```
%template(IntVector) vector<int>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T16:40:34.130

我对 Swig 没有太多经验，但是您是否在 .i 文件中包含您的 C++ 头文件？尝试其中一种（或两种）

```
%include "myvector.h"

%{
#   include "myvector.h"
%} 
```

# php - 使用 GD 库制作图像灰度

> ID：276780
> 
> 赞同：4
> 
> 时间：2008-11-10T00:46:46.960
> 
> 标签：php, image, gd

我的任务是创建一个小应用程序，您可以在其中上传图片，该应用程序会将其转换为 ASCII 艺术。我确信这些已经存在，但我想证明我自己可以做到。

这将涉及拍摄图像，使其成为灰度，然后根据图片的暗度和字符的饱满程度将每个像素与字符匹配。

所以我的问题是，使用 GD 库（或者如果需要，我猜其他方式）如何制作黑白图像？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-10T08:24:31.857

[正如nickf](https://stackoverflow.com/users/9021/nickf)在他的[评论](https://stackoverflow.com/questions/276780/making-an-image-greyscale-with-gd-library#276811)中指出的那样，简单的公式`(pixel.r + pixel.g + pixel.b) / 3`是不正确的。使用包含 GD 的函数`imagefilter()`（无需使用 PHP 循环遍历图像中的所有像素）：

```
$im = imagecreatefrompng('dave.png');
imagefilter($im, IMG_FILTER_GRAYSCALE);
imagepng($im, 'dave.png'); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-23T20:48:13.453

要使其成为纯黑白（如您所写），请使用此

```
imagefilter($im, IMG_FILTER_GRAYSCALE);
imagefilter($im, IMG_FILTER_CONTRAST, -1000); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-08-23T21:55:34.027

nickf 的答案虽然很常见，但却是错误的。（对不起，尼克。）首先，这些是 NTSC RGB 的亮度数，而不是计算机图像使用的 sRGB。正确的数字是 0.21、0.72、0.07。其次，必须将权重应用于未经伽马校正的 RGB 值，然后重新应用伽马校正。sRGB 的 Gamma 约为 2.2。准确地说，它是一个复合函数，近似取幂为 1/2.2。这里是 C++。（我不会说php。对不起，你需要翻译。）

```
// sRGB luminance(Y) values
const double rY = 0.212655;
const double gY = 0.715158;
const double bY = 0.072187;

// Inverse of sRGB "gamma" function. (approx 2.2)
double inv_gam_sRGB(int ic) {
    double c = ic/255.0;
    if ( c <= 0.04045 )
        return c/12.92;
    else 
        return pow(((c+0.055)/(1.055)),2.4);
}

// sRGB "gamma" function (approx 2.2)
int gam_sRGB(double v) {
    if(v<=0.0031308)
        v *= 12.92;
    else 
        v = 1.055*pow(v,1.0/2.4)-0.055;
    return int(v*255+.5);
}

// GRAY VALUE
int gray(int r, int g, int b) {
    return gam_sRGB(
            rY*inv_gam_sRGB(r) +
            gY*inv_gam_sRGB(g) +
            bY*inv_gam_sRGB(b)
    );
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T06:04:58.677

将 RGB 转换为灰度的常用公式是：

```
灰度强度 = 0.30R + 0.59G + 0.11B
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T01:56:44.527

您不必将其转换为灰度...如果您只是计算一个像素与某种颜色的接近程度（在您的情况下为一系列灰点），结果将是相同的，您必须这样做无论如何，在比较您的灰度图像，然后选择适当的字符时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T02:17:42.377

通常在 RGB 颜色空间中，每个颜色分量（RG 和 B）的值为 128 将给出中等灰色。您不妨输入任何低于或大于 128 的值来获得不同强度（阴影）的灰色。

-广告

# lisp - 我如何更清楚地表达这个 Scheme 功能？

> ID：276790
> 
> 赞同：3
> 
> 时间：2008-11-10T00:52:18.667
> 
> 标签：lisp, scheme

```
(define (repeated f n)
   if (= n 0)
   f
   ((compose repeated f) (lambda (x) (- n 1)))) 
```

我写了这个函数，但是我如何更清楚地表达这个，使用简单的递归和重复？

对不起，我忘了定义我的撰写功能。

```
(define (compose f g) (lambda (x) (f (g x)))) 
```

该函数将计算 f 和正整数 n 的过程作为输入，并返回计算 f 的第 n 次重复应用的过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T02:59:42.620

我假设 (repeated f 3) 应该返回一个函数 g(x)=f(f(f(x)))。如果这不是你想要的，请澄清。无论如何，重复的定义可以写成如下：

```
(define (repeated f n)
  (lambda (x)
    (if (= n 0)
        x
        ((repeated f (- n 1)) (f x))))) 

(define (square x)
  (* x x))

(define y (repeated square 3))

(y 2) ; returns 256, which is (square (square (square 2))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T03:03:01.337

```
(define (repeated f n)
  (lambda (x)
    (let recur ((x x) (n n))
      (if (= n 0)
          args
          (recur (f x) (sub1 n)))))) 
```

以您通常的方式编写函数，除了参数分两个阶段传递。用这种方式定义可能更清楚`repeated`：

```
(define repeated (lambda (f n) (lambda (x) 
  (define (recur x n)
    (if (= n 0)
        x
        (recur (f x) (sub1 n))))
  (recur x n)))) 
```

您不必以这种方式使用“let-loop”，并且 lambda 表达式清楚地表明您期望您的参数分两个阶段。（注意：recur 不像 Clojure 那样内置在 Scheme 中，我只是喜欢这个名字）

```
> (define foonly (repeat sub1 10))
> (foonly 11)
1
> (foonly 9)
-1 
```

您在这里想要的很酷的功能特性是柯里化，而不是组合。这是带有隐式柯里化的 Haskell：

```
repeated _ 0 x = x
repeated f n x = repeated f (pred n) (f x) 
```

我希望这不是作业问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T02:07:03.430

出于好奇，您的功能*是*什么？是跑步`f`吗`n`？如果是这样，您可以这样做。

```
(define (repeated f n)
  (for-each (lambda (i) (f)) (iota n))) 
```

# sql-server-2005 - 如何将 SQL Express 数据库升级到 SQL Server Workgroup 或 Standard？

> ID：276791
> 
> 赞同：0
> 
> 时间：2008-11-10T00:52:33.533
> 
> 标签：sql-server-2005, upgrade, sql-server-express

我有一个网站，最初是使用 App_Data 文件夹中的 SQL Express 数据库开发的。现在我需要在不丢失任何数据的情况下将它升级到 SQL Server 2005 Workgroup 或 Standard。

是否有关于如何由 Microsoft 或其他来源正确升级的指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T18:03:15.827

安装 Workgroup 或 Standard 时，它将同时升级数据库服务器和数据库。确保您有数据库的备份（以防万一）。您始终可以备份数据库并将其还原到 Workgroup 或 Standard。

这是一个指南： [http ://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=55](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=55)

# tfs - 有没有可以托管项目的免费 Team Foundation Server？

> ID：276802
> 
> 赞同：31
> 
> 时间：2008-11-10T01:02:02.843
> 
> 标签：tfs, hosting

是否有任何免费的 Team Foundation Server 站点可供我们用于*私人*开发？请不要说 CodePlex（我喜欢），因为这意味着代码都是开源的。

最后，我也明白有些人可能会提出将他们的私人代码托管在他们不认识的人的某个地方等问题。所以请不要提出任何安全问题。

我猜由于许可原因没有免费服务？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-10T10:44:14.273

[微软目前在tfs.visualstudiow.com](http://tfspreview.com)上提供他们的下一代云托管 TFS 服务- 私人存储库对最多 5 位用户免费，但他们表示，当您将来拥有超过 5 位用户时，他们将对服务收费您帐户中的用户。

如果您是一家小型初创公司并想在防火墙内使用 TFS，那么请查看 Microsoft 的新[BizSpark](http://www.microsoft.com/bizspark/)程序。这基本上提供了免费启动基于 Microsoft 技术的公司所需的一切（硬件除外） - 包括 TFS 和 Visual Studio。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-10T01:08:07.777

我会怀疑是否会有免费的。Team Foundation Server 对我们来说实施起来非常昂贵，所以如果有人免费托管，我会感到惊讶。除了 CodePlex 类型选项。

有些服务您可以每月按用户付费，例如 [这个](http://www.phase2.com/hosted_team_foundation_server_overview2.aspx)或[这个](http://www.teamdevcentral.com/pricing.html)>

不过，我怀疑您是否会找到免费的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-28T16:21:40.260

没有一个是免费的，但是这篇[Simple Talk 文章](http://www.simple-talk.com/content/article.aspx?article=1315)中讨论了四个 TFS 托管选项，包括：

*   PRAKTIK 托管
*   团队开发中心
*   SaaS 变得简单
*   折扣ASP

微软自己的 TFSPreview 现在更名为[Team Foundation Service](http://tfs.visualstudio.com/en-us/pricing/information/)，最多可免费供 5 位用户使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-12T12:09:39.803

我们正在我们的 TFS 托管服务上运行一个试点计划，因此在短时间内它是免费的。之后，我们将获得完整 TFS 套件的最优惠价格。

[http://www.tfsserver.com](http://www.tfsserver.com)

# c++ - 返回 0 隐式

> ID：276807
> 
> 赞同：17
> 
> 时间：2008-11-10T01:05:38.390
> 
> 标签：c++

上周在 ACM ICPC 墨西哥比赛中，我错过了一个 C++ 程序的“返回 0”。因此，我们受到了 20 分钟的惩罚。

我读过该标准并不强制我们将其写在 main 函数的末尾。它是隐含的，不是吗？我该如何证明呢？

我们使用的是带有 G++ 编译器的 Fedora 系统。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-10T01:09:33.513

您参考 C++ 标准，第 3.6.1 章第 5 段：

> main 中的 return 语句具有离开 main 函数（销毁任何具有自动存储持续时间的对象）并以返回值作为参数调用 exit 的效果。如果控制到达main的末尾没有遇到return语句，效果就是执行`return 0;`

如果您手头没有标准，您可以在工作草案中显示该段落。这是 c++98 的一个，它已经定义了这个。

[你可以在这里](http://www.kuzbass.ru:8086/docs/isocpp/basic.html#basic.start.main)了解更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T01:12:42.993

您可以向他们展示[Bjarne Stroustrup 书中](http://www.research.att.com/~bs/3rd.html)定义标准的那一行：因为它是该语言的规范标准，所以它不接受辩论。不幸的是，我没有副本可以自己查找。

# .net - 如何基于二维数组填充 WPF 网格

> ID：276808
> 
> 赞同：57
> 
> 时间：2008-11-10T01:05:52.257
> 
> 标签：.net, wpf, data-binding, templates, grid

我有一个二维对象数组，我基本上想将每个对象数据绑定到 WPF 网格中的一个单元格。目前我有这个工作，但我大部分都是按程序完成的。我创建正确数量的行和列定义，然后循环单元格并创建控件并为每个控件设置正确的绑定。

至少我希望能够使用模板来指定 xaml 中的控件和绑定。理想情况下，我想摆脱程序代码，只使用数据绑定来完成这一切，但我不确定这是否可能。

这是我目前正在使用的代码：

```
public void BindGrid()
{
    m_Grid.Children.Clear();
    m_Grid.ColumnDefinitions.Clear();
    m_Grid.RowDefinitions.Clear();

    for (int x = 0; x < MefGrid.Width; x++)
    {
        m_Grid.ColumnDefinitions.Add(new ColumnDefinition() { Width = new GridLength(1, GridUnitType.Star), });
    }

    for (int y = 0; y < MefGrid.Height; y++)
    {
        m_Grid.RowDefinitions.Add(new RowDefinition() { Height = new GridLength(1, GridUnitType.Star), });
    }

    for (int x = 0; x < MefGrid.Width; x++)
    {
        for (int y = 0; y < MefGrid.Height; y++)
        {
            Cell cell = (Cell)MefGrid[x, y];                    

            SolidColorBrush brush = new SolidColorBrush();

            var binding = new Binding("On");
            binding.Converter = new BoolColorConverter();
            binding.Mode = BindingMode.OneWay;

            BindingOperations.SetBinding(brush, SolidColorBrush.ColorProperty, binding);

            var rect = new Rectangle();
            rect.DataContext = cell;
            rect.Fill = brush;
            rect.SetValue(Grid.RowProperty, y);
            rect.SetValue(Grid.ColumnProperty, x);
            m_Grid.Children.Add(rect);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-11-10T01:50:03.977

Grid 的目的不是为了真正的数据绑定，它只是一个面板。我列出了完成二维列表可视化的最简单方法

```
<Window.Resources>
    <DataTemplate x:Key="DataTemplate_Level2">
            <Button Content="{Binding}" Height="40" Width="50" Margin="4,4,4,4"/>
    </DataTemplate>

    <DataTemplate x:Key="DataTemplate_Level1">
        <ItemsControl ItemsSource="{Binding}" ItemTemplate="{DynamicResource DataTemplate_Level2}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ItemsControl>
    </DataTemplate>

</Window.Resources>
<Grid>
    <ItemsControl x:Name="lst" ItemTemplate="{DynamicResource DataTemplate_Level1}"/>
</Grid> 
```

并且在后面的代码中使用 TwoDimentional 数据结构设置 lst 的 ItemsSource。

```
 public Window1()
    {
        List<List<int>> lsts = new List<List<int>>();

        for (int i = 0; i < 5; i++)
        {
            lsts.Add(new List<int>());

            for (int j = 0; j < 5; j++)
            {
                lsts[i].Add(i * 10 + j);
            }
        }

        InitializeComponent();

        lst.ItemsSource = lsts;
    } 
```

这将为您提供以下屏幕作为输出。您可以编辑 DataTemplate_Level2 以添加对象的更多特定数据。

![替代文字](https://i.stack.imgur.com/Y6yH9.jpg)

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-10-23T04:02:04.203

这是一个`DataGrid2D`可以根据 2D 或
1D 数组（或任何实现`IList`接口的东西）填充的控件。它继承`DataGrid`并添加了一个名为的属性`ItemsSource2D`，用于绑定 2D 或 1D 源。库可以在[这里](http://www.mediafire.com/download.php?1bw6dm9y11fbmnu)下载，源代码可以在[这里](http://www.mediafire.com/download.php?tm1arm230rr1tgi)下载。

要使用它，只需添加对 DataGrid2DLibrary.dll 的引用，添加此命名空间

```
xmlns:dg2d="clr-namespace:DataGrid2DLibrary;assembly=DataGrid2DLibrary" 
```

然后创建一个 DataGrid2D 并将其绑定到您的 IList、二维数组或一维数组，如下所示

```
<dg2d:DataGrid2D Name="dataGrid2D"
                 ItemsSource2D="{Binding Int2DList}"/> 
```

![在此处输入图像描述](https://i.stack.imgur.com/JL7xy.png)

* * *

**OLD POST**
这是一个可以将二维数组绑定到 WPF 数据网格的实现。

假设我们有这个二维数组

```
private int[,] m_intArray = new int[5, 5];
...
for (int i = 0; i < 5; i++)
{
    for (int j = 0; j < 5; j++)
    {
        m_intArray[i,j] = (i * 10 + j);
    }
} 
```

然后我们想将此二维数组绑定到 WPF DataGrid，我们所做的更改将反映在数组中。为此，我使用了[此](https://stackoverflow.com/questions/2980463/how-do-i-assign-by-reference-to-a-class-field-in-c/2982037#2982037)线程中的 Eric Lippert 的 Ref 类。

```
public class Ref<T>  
{ 
    private readonly Func<T> getter;  
    private readonly Action<T> setter; 
    public Ref(Func<T> getter, Action<T> setter)  
    {  
        this.getter = getter;  
        this.setter = setter;  
    } 
    public T Value { get { return getter(); } set { setter(value); } }  
} 
```

然后，我使用上面的 Ref 类创建了一个静态辅助类，该类可以采用 2D 数组并返回 DataView。

```
public static DataView GetBindable2DArray<T>(T[,] array)
{
    DataTable dataTable = new DataTable();
    for (int i = 0; i < array.GetLength(1); i++)
    {
        dataTable.Columns.Add(i.ToString(), typeof(Ref<T>));
    }
    for (int i = 0; i < array.GetLength(0); i++)
    {
        DataRow dataRow = dataTable.NewRow();
        dataTable.Rows.Add(dataRow);
    }
    DataView dataView = new DataView(dataTable);
    for (int i = 0; i < array.GetLength(0); i++)
    {
        for (int j = 0; j < array.GetLength(1); j++)
        {
            int a = i;
            int b = j;
            Ref<T> refT = new Ref<T>(() => array[a, b], z => { array[a, b] = z; });
            dataView[i][j] = refT;
        }
    }
    return dataView;
} 
```

这几乎足以绑定到，但绑定中的路径将指向 Ref 对象，而不是我们需要的 Ref.Value，因此我们必须在生成列时更改它。

```
<DataGrid Name="c_dataGrid"
          RowHeaderWidth="0"
          ColumnHeaderHeight="0"
          AutoGenerateColumns="True"
          AutoGeneratingColumn="c_dataGrid_AutoGeneratingColumn"/>

private void c_dataGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
{
    DataGridTextColumn column = e.Column as DataGridTextColumn;
    Binding binding = column.Binding as Binding;
    binding.Path = new PropertyPath(binding.Path.Path + ".Value");
} 
```

在此之后我们可以使用

```
c_dataGrid.ItemsSource = BindingHelper.GetBindable2DArray<int>(m_intArray); 
```

输出看起来像这样

![替代文字](https://i.stack.imgur.com/FvZro.png)

中所做的任何更改`DataGrid`都将反映在 m_intArray 中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-06-28T18:08:23.510

我为`DataGrid`. [这里是源](https://github.com/JohanLarsson/Gu.Wpf.DataGrid2D)

示例，其中 Data2D 为`int[,]`：

```
<DataGrid HeadersVisibility="None"
          dataGrid2D:Source2D.ItemsSource2D="{Binding Data2D}" /> 
```

渲染： ![在此处输入图像描述](https://i.stack.imgur.com/uYv8v.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-30T13:43:09.200

这是基于[Meleak](https://stackoverflow.com/a/4002409/684399)的答案的另一种解决方案，但不需要`AutoGeneratingColumn`在每个绑定的代码中使用事件处理程序`DataGrid`：

```
public static DataView GetBindable2DArray<T>(T[,] array)
{
    var table = new DataTable();
    for (var i = 0; i < array.GetLength(1); i++)
    {
        table.Columns.Add(i+1, typeof(bool))
                     .ExtendedProperties.Add("idx", i); // Save original column index
    }
    for (var i = 0; i < array.GetLength(0); i++)
    {
        table.Rows.Add(table.NewRow());
    }

    var view = new DataView(table);
    for (var ri = 0; ri < array.GetLength(0); ri++)
    {
        for (var ci = 0; ci < array.GetLength(1); ci++)
        {
            view[ri][ci] = array[ri, ci];
        }
    }

    // Avoids writing an 'AutogeneratingColumn' handler
    table.ColumnChanged += (s, e) => 
    {
        var ci = (int)e.Column.ExtendedProperties["idx"]; // Retrieve original column index
        var ri = e.Row.Table.Rows.IndexOf(e.Row); // Retrieve row index

        array[ri, ci] = (T)view[ri][ci];
    };

    return view;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-28T09:19:50.057

您可能想查看此链接：[http ://www.thinkbottomup.com.au/site/blog/Game_of_Life_in_XAML_WPF_using_embedded_Python](http://www.thinkbottomup.com.au/site/blog/Game_of_Life_in_XAML_WPF_using_embedded_Python)

如果您在列表中使用列表，则可以使用 myList[x][y] 访问单元格。

# asp.net - ASP.NET MVC 和 Ajax

> ID：276810
> 
> 赞同：0
> 
> 时间：2008-11-10T01:06:41.803
> 
> 标签：asp.net, asp.net-mvc

从我读到的关于 ASP.NET MVC 的内容来看，它似乎需要发布才能工作，是否有任何在 Ajax 的帮助下没有回发的 ASP.NET MVC 网站的工作示例（有可用的源代码）？

（我之前检查了相关问题，但找不到我要找的东西）

提前致谢。

编辑：我需要 jQuery 解决方案而不是 Atlas Toolkit 的东西！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T01:14:01.103

这是来自预览 4...

[http://www.hanselman.com/blog/ASPNETMVCPreview4UsingAjaxAndAjaxForm.aspx](http://www.hanselman.com/blog/ASPNETMVCPreview4UsingAjaxAndAjaxForm.aspx)

用 jquery

[http://weblogs.asp.net/mikebosch/archive/2008/02/15/asp-net-mvc-submitting-ajax-form-with-jquery.aspx](http://weblogs.asp.net/mikebosch/archive/2008/02/15/asp-net-mvc-submitting-ajax-form-with-jquery.aspx)

# .net - 什么是红/绿测试？

> ID：276813
> 
> 赞同：15
> 
> 时间：2008-11-10T01:08:26.933
> 
> 标签：.net, unit-testing

我相信我已经知道答案，但我不是 100% 确定，所以只是一个简单的问题：红/绿测试实际上意味着什么？

我将其理解为“首先编写您的测试，以便它们都失败（= 全部为红色），然后编写您的代码并观察每个测试如何变成绿色，当所有测试都变成绿色时，您就没事了”。

我在[Scott 的 MVC Talk at Mix](http://sessions.visitmix.com/?selectedSearch=T22)中听到了这一点，所以我不知道这是一个“官方”术语还是他只是编造的。（编辑：斯科特实际上也在 55:00 分钟开始解释它，并且他很好地评论了为什么他相信它）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-10T01:16:23.640

它确实指的是 TDD 或测试驱动开发，但它适用于每个测试。先写测试，再写代码通过测试。首先编写所有测试是错误的。TDD 是一种增量开发方法。

基本思想是在未通过测​​试 (RED) 之前不编写任何代码。当您的测试失败时，您编写代码以通过测试（绿色）。现在您已准备好编写下一个测试——即，在所有测试都为绿色之前，不要进行新的测试。或者重构，正如@Brian 指出的那样。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-10T01:19:08.393

“红-绿-重构”是 TDD 的口头禅。

[http://en.wikipedia.org/wiki/Test-driven_development](http://en.wikipedia.org/wiki/Test-driven_development)

当我在办公室糖果盘中放纵了一个下午后，正忙着吃糖时，我有时会在编码时喊出这些词。如果您在编写失败的测试用例后通过喊“红色！”来奖励自己，那么预先编写测试会更容易。和吃一块巧克力。:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-10T01:27:09.967

当您运行 TDD GUI 时，显示为红色，直到所有测试通过，然后切换为绿色。

这是对测试优先开发的粗略大纲的总结。

1.  编写一些可编译的骨架代码，有足够的 API 可测试。

2.  编写测试——最初——将主要是失败的。红色的。

3.  完成代码。测试通过。绿。

在这一点上，你至少有一些有用的东西。但是，您所拥有的并不是很高的质量。因此，您需要进行重构以提高整体质量。

# tortoisesvn - 如何安全地重启 TortoiseSVN？

> ID：276816
> 
> 赞同：14
> 
> 时间：2008-11-10T01:11:31.967
> 
> 标签：tortoisesvn

这对我来说并不明显..

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-10T01:37:22.833

如果您确实杀死了 TSVNCache，则无需手动重新启动它，shell-extension 将在下次需要它时执行此操作。

如果您尝试重新启动 shell 扩展，您可以通过杀死所有 Explorer.exe 进程以及任何其他以 TSVN 进程结束的方式来实现它。这基本上是任何向 shell 询问图标或使用常见文件/目录对话框的应用程序。您可能需要使用“进程资源管理器”（sysinternals）之类的东西来查找哪些进程加载了 TSVN DLL。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-11-21T10:17:23.923

如果您不再看到 TortoiseSVN 图标，您可以`TSVNCache.exe`通过导航到 TortoiseSVN 的`bin`目录重新启动，例如`C:\Program Files\TortoiseSVN\bin`，然后双击它。请注意，如果您以这种方式重新启动它，它将在您注销时被杀死。否则请按照其他答案的建议。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-10T01:19:52.603

监视您的文件系统以查找 SVN 相关文件和文件夹的后台进程是 TSVNCache.exe。您可以终止该进程并重新启动它，或者只是重新启动您的机器:)

# c - C中的字符串填充

> ID：276827
> 
> 赞同：89
> 
> 时间：2008-11-10T01:19:50.887
> 
> 标签：c, string, padding

我写了这个应该做 StringPadRight("Hello", 10, "0") -> "Hello00000" 的函数。

```
char *StringPadRight(char *string, int padded_len, char *pad) {
    int len = (int) strlen(string);
    if (len >= padded_len) {
        return string;
    }
    int i;
    for (i = 0; i < padded_len - len; i++) {
        strcat(string, pad);
    }
    return string;
} 
```

它有效，但有一些奇怪的副作用......其他一些变量会发生变化。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2008-11-10T01:50:15.320

知道 printf 为您进行填充可能会有所帮助，使用 %-10s 作为格式字符串将在 10 个字符长的字段中填充输入

```
printf("|%-10s|", "Hello"); 
```

将输出

```
|Hello     | 
```

在这种情况下， - 符号表示“左对齐”，10 表示“字段中的十个字符”，s 表示您正在对齐字符串。

Printf 样式格式有多种语言版本，并且在网络上有大量参考资料。这是解释格式化标志[的许多页面之一。](http://en.cppreference.com/w/c/io/fprintf)像往常一样[，维基百科的 printf 页面](http://en.wikipedia.org/wiki/Printf)也有帮助（主要是关于 printf 传播范围的历史课程）。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-03-16T16:34:38.640

对于“C”，当需要自定义填充时，可以使用不需要任何 malloc() 或预格式化的 [s]printf 的替代（更复杂）使用。

诀窍是对 %s 使用 '*' 长度说明符（最小值和最大值），再加上一个用您的填充字符填充到最大潜在长度的字符串。

```
int targetStrLen = 10;           // Target output length  
const char *myString="Monkey";   // String for output 
const char *padding="#####################################################";

int padLen = targetStrLen - strlen(myString); // Calc Padding length
if(padLen < 0) padLen = 0;    // Avoid negative length

printf("[%*.*s%s]", padLen, padLen, padding, myString);  // LEFT Padding 
printf("[%s%*.*s]", myString, padLen, padLen, padding);  // RIGHT Padding 
```

"%*.*s" 可以放在 "%s" 之前或之后，这取决于对 LEFT 或 RIGHT 填充的需要。

> `[####Monkey] <-- Left padded, "%*.*s%s"`
> `[Monkey####] <-- Right padded, "%s%*.*s"`

我发现 PHP printf ([这里](http://www.php.net/manual/en/function.sprintf.php)) 确实支持在 %s 格式中*使用单引号 (') 后跟自定义填充字符来提供自定义填充字符的能力。*
`printf("[%'#10s]\n", $s); // use the custom padding character '#'`
产生：
`[####monkey]`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-08T00:37:21.107

```
#include <stdio.h>
#include <string.h>

int main(void) {
    char buf[BUFSIZ] = { 0 };
    char str[] = "Hello";
    char fill = '#';
    int width = 20; /* or whatever you need but less than BUFSIZ ;) */

    printf("%s%s\n", (char*)memset(buf, fill, width - strlen(str)), str);

    return 0;
} 
```

输出：

```
$ gcc -Wall -ansi -pedantic padding.c
$ ./a.out 
###############Hello 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T01:25:13.670

您必须确保输入字符串有足够的空间来容纳所有填充字符。试试这个：

```
char hello[11] = "Hello";
StringPadRight(hello, 10, "0"); 
```

请注意，我为`hello`字符串分配了 11 个字节以说明最后的空终止符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T01:25:04.497

您传递“Hello”的参数位于常量数据区。除非您为 char * 字符串分配了足够的内存，否则它会溢出到其他变量。

```
char buffer[1024];
memset(buffer, 0, sizeof(buffer));
strncpy(buffer, "Hello", sizeof(buffer));
StringPadRight(buffer, 10, "0"); 
```

编辑：从堆栈更正为常量数据区域。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T01:37:17.250

哦，好吧，有道理。所以我这样做了：

```
 char foo[10] = "hello";
    char padded[16];
    strcpy(padded, foo);
    printf("%s", StringPadRight(padded, 15, " ")); 
```

谢谢！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-01T11:32:48.463

```
#include <iostream>
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

using namespace std;

int main() {
    // your code goes here
    int pi_length=11; //Total length 
    char *str1;
    const char *padding="0000000000000000000000000000000000000000";
    const char *myString="Monkey";

    int padLen = pi_length - strlen(myString); //length of padding to apply

    if(padLen < 0) padLen = 0;   

    str1= (char *)malloc(100*sizeof(char));

    sprintf(str1,"%*.*s%s", padLen, padLen, padding, myString);

    printf("%s --> %d \n",str1,strlen(str1));

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-10T01:25:27.710

该功能本身对我来说看起来不错。问题可能是您没有为字符串分配足够的空间来填充那么多字符。您可以在将来通过将`size_of_string`参数传递给函数来避免此问题，并确保在长度即将大于大小时不填充字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-21T15:02:32.843

在这个线程中形成原始问题的函数中绝对错误的一件事是，它正在将额外的字符连接到作为参数传入的字符串文字的末尾。这将产生不可预知的结果。在函数的示例调用中，字符串文字“Hello”将被硬编码到程序中，因此可能连接到它的末尾会危险地覆盖代码。如果您想返回一个大于原始字符串的字符串，那么您需要确保动态分配它，然后在完成后在调用代码中删除它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-27T16:17:43.623

```
#include<stdio.h>
#include <string.h>

void padLeft(int length, char pad, char* inStr,char* outStr) {
    int minLength = length * sizeof(char);
    if (minLength < sizeof(outStr)) {
        return;
    }

    int padLen = length - strlen(inStr);
    padLen = padLen < 0 ? 0 : padLen;

    memset(outStr, 0, sizeof(outStr));
    memset(outStr, pad,padLen);
    memcpy(outStr+padLen, inStr, minLength - padLen);
} 
```

# c# - 我可以使用什么来获得 C#/.NET 的高质量代码覆盖率？

> ID：276829
> 
> 赞同：414
> 
> 时间：2008-11-10T01:20:29.840
> 
> 标签：c#, .net, code-coverage

我想知道 .NET（或特别是 C#）代码覆盖率有哪些选择，尤其是在价格较低的部分？

我不是在寻找建议，而是基于事实对产品进行比较。我知道以下内容：

*   [无盖](http://www.ncover.com/)
    *   似乎很受欢迎，看起来相当不错
    *   支持语句覆盖和分支覆盖
    *   [“NCover 3 Complete”售价 480 美元](https://www.ncover.com/quote)
    *   旧的测试版[免费提供](https://stackoverflow.com/questions/276829/code-coverage-for-cnet#276840)
*   [Visual Studio (2008 专业版) | （2005 团队系统（开发、测试或团队套件版本））](https://web.archive.org/web/20090118182937/http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx)
    *   嗯，它是微软，所以我希望它能够正常工作
    *   完全集成到 Visual Studio
    *   至少 5,469 美元
*   [PartCover](https://github.com/sawilde/partcover.net4) - 没有进一步开发（移至 OpenCover）
    *   开源
    *   支持语句覆盖
*   [OpenCover](https://github.com/OpenCover/opencover) - PartCover 的继任者
    *   开源
    *   支持分支和语句覆盖
    *   32 位和 64 位支持
    *   Silverlight 支持
    *   [背景](http://scubamunki.blogspot.com/2011/06/opencover-first-beta-release.html)
    *   [主要开发人员的代码项目教程](https://www.codeproject.com/Articles/677691/Getting-code-coverage-from-your-NET-testing-using)
    *   尚无[.NET Core 支持](https://github.com/OpenCover/opencover/issues/595)
*   [SD 测试覆盖率](http://www.semanticdesigns.com/Products/TestCoverage/CSharpTestCoverage.html)
    *   适用于 32 位和 64 位，完整的 C# 4.0
    *   处理小型和超大型代码库
    *   单用户许可证 250 美元
*   [JetBrains dotCover](https://www.jetbrains.com/dotcover/)
    *   个人许可证 100 美元。对用户组、开源项目、学生和教师免费。
    *   支持语句覆盖
    *   Silverlight 支持
*   [NCrunch](https://www.ncrunch.net/)

    *   个人许可证 159 美元
    *   商业席位许可证 289 美元 ~~* 测试期间免费，[变为商业，定价未知，](https://blog.ncrunch.net/post/The-Future-Of-NCrunch-Part-2.aspx) [未来未知](https://blog.ncrunch.net/post/The-Future-of-NCrunch.aspx)~~。
    *   Visual Studio 中的代码覆盖率指示器
    *   连续（接近实时）测试
    *   可视化每次测试代码覆盖率
    *   性能指标，并行多核测试执行
*   [依赖](https://www.ndepend.com/Coverage.aspx)

    *   开发者许可证[410 美元](https://www.ndepend.com/Purchase.aspx)
    *   NDepend 可以从 NCover、DotCover、Visual Studio 2017 导入覆盖数据；2015、2013、2012、2010 和 2008 代码覆盖率文件。
    *   依赖图
    *   依赖结构矩阵
    *   可视化代码指标
    *   验证代码规则

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-11-10T01:30:52.957

我使用[TestDriven.NET](http://www.testdriven.net)附带的 NCover 版本。它将允许您轻松地右键单击您的单元测试类库，然后点击*Test With→Coverage*，它会拉出报告。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-11-10T01:29:42.007

NCover 的替代品可以是[PartCover](https://sourceforge.net/projects/partcover/)，它是一个用于 .NET 的开源代码覆盖工具，与 NCover 非常相似，它包括一个控制台应用程序、一个 GUI 覆盖浏览器和用于[CruiseControl.NET](http://en.wikipedia.org/wiki/CruiseControl)的 XSL 转换。

这是一个非常有趣的产品。

**[OpenCover](https://github.com/OpenCover/opencover)**已取代 PartCover。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-07-03T17:47:50.230

JetBrains（以[ReSharper](http://en.wikipedia.org/wiki/ReSharper)闻名）一直致力于开发一种名为[dotCover](https://confluence.jetbrains.com/display/DCVR/dotCover+Early+Access+Program)的覆盖工具。它显示出很大的希望。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-04-26T07:13:24.453

我刚刚测试了[NCrunch](https://www.ncrunch.net/)，不得不说我印象非常深刻。它是一个持续测试工具，几乎可以实时地在 Visual Studio 中为您的代码添加代码覆盖率。在我写这篇文章的时候，NCrunch 是免费的。不过，目前还不清楚它是免费的、花钱的还是开源[的](https://blog.ncrunch.net/post/The-Future-of-NCrunch.aspx)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-01T18:41:46.623

[TestCocoon](http://www.testcocoon.org/index.html)也很不错。它正在积极开发中并拥有一个用户社区：

*   开源（GPL 3）
*   支持 C/C++/C# 跨平台（Linux、Windows 和 Mac）
*   CoverageScanner - 生成过程中的检测
*   CoverageBrowser - 代码覆盖结果的查看、分析和管理

然而，TestCocoon 不再开发，它的创建者现在正在为 C/C++ 制作商业软件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-10T01:27:47.283

[有免费的](http://www.ncover.com/download/discontinued "available for free")[NCover](http://en.wikipedia.org/wiki/NCover) 预发布（测试版）版本。它们在大多数情况下都能正常工作，尤其是与 NCoverExplorer 结合使用时。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-15T19:02:30.073

我不确定零售 NCover 有什么区别，但[SourceForge 上还有一个 NCover 项目](http://ncover.sourceforge.net/)，它当然是开源和免费的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-12T08:05:50.880

请参阅我公司 Semantic Designs的[C# 测试覆盖率工具：](http://www.semanticdesigns.com/Products/TestCoverage/CSharpTestCoverage.html)

它具有非常低的开销、处理庞大的文件系统、直观的 GUI、如何覆盖特定文件，并生成包含方法、类和包级别的覆盖率细分的报告。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-06T06:30:06.180

[TestMatrix](http://submain.com/testmatrix)是一个单元测试运行器和代码覆盖工具。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-05-02T09:11:16.880

*[C# 测试覆盖率工具](http://www.semanticdesigns.com/Products/TestCoverage/CSharpTestCoverage.html)*的开销非常低，可处理庞大的文件系统，直观的 GUI 显示特定文件的覆盖率，并生成包含方法、类和包级别的覆盖率细分的报告。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-03T17:44:19.520

Visual Studio 2010 附带了代码覆盖率功能以及可编程 API。遗憾的是，仅有的两个包含完整代码覆盖率功能的版本是 Premium 和 Ultimate。但是，我确实相信 API 将适用于任何版本，因此创建代码覆盖率文件并为覆盖率信息编写查看器是可能的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-05T17:38:23.863

我们已将 EAP 发布到[dotCover](http://www.jetbrains.com/dotcover)，并将很快发布测试版。

# security - 7 次或 35 次擦除如何工作？为什么要使用这些方法？

> ID：276832
> 
> 赞同：13
> 
> 时间：2008-11-10T01:23:39.647
> 
> 标签：security, hardware, erase

7 遍和 35 遍擦除如何以及为何起作用？一个简单的全零重写不应该足够吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-10T01:28:35.643

带零的单次通过并不能完全擦除磁盘上的磁伪影。仍然可以从驱动器中恢复数据。使用随机数据的 7 次擦除将完成一项非常完整的工作，以防止重建驱动器上的数据。

维基百科有许多与此主题相关的不同文章。

[http://en.wikipedia.org/wiki/Data_remanence](http://en.wikipedia.org/wiki/Data_remanence)

[http://en.wikipedia.org/wiki/Computer_forensics](http://en.wikipedia.org/wiki/Computer_forensics)

[http://en.wikipedia.org/wiki/Data_erasure](http://en.wikipedia.org/wiki/Data_erasure)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-10T02:27:56.663

我从未听说过 35 部分擦除：[http ://en.wikipedia.org/wiki/Gutmann_method](http://en.wikipedia.org/wiki/Gutmann_method)

> Gutmann 方法是一种用于安全擦除计算机硬盘驱动器内容（例如文件）的算法。它由 Peter Gutmann 和 Colin Plumb 设计，通过在要擦除的区域上写入一系列 35 个图案来实现。模式的选择假设用户不知道驱动器使用的编码机制，因此包括专门为三种不同类型的驱动器设计的模式。知道驱动器使用哪种编码类型的用户只能选择用于其驱动器的那些模式。具有不同编码机制的驱动器将需要不同的模式。Gutmann 方法中的大多数模式都是为较旧的 MFM/RLL 编码磁盘设计的。相对现代的驱动器不再使用旧的编码技术，

也很有趣：

> 恢复已在硬盘驱动器上覆盖的数据的一种标准方法是捕获在解码之前由驱动器磁头读取的模拟信号。该模拟信号将接近理想的数字信号，但重要的是不同之处。通过计算理想的数字信号，然后从实际的模拟信号中减去它，可以忽略最后写入的信息，放大剩余的信号并查看之前写入的内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-10T03:30:19.300

如前所述，磁盘上先前的数据中存在磁性伪影。

在最近一期的 MaximumPC 中，他们对此进行了测试。他们拿了一个驱动器，通过全零的传递，并聘请了一家数据恢复公司来尝试恢复他们所能做的。答：没有恢复一比特。他们的分析是，除非您期望 NSA 会尝试，否则零通过可能就足够了。

就个人而言，我会在它上面运行一个或两个交替模式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-17T01:04:01.933

一次随机通过就足以实现合理的否认，因为丢失的数据必须大部分“重建”，误差范围随着试图恢复的数据长度以及数据是否连续而增长（大多数情况下，它不是）。

对于疯狂的偏执狂来说，三遍是好的。0xAA（10101010），0x55​​（01010101），然后随机。前两个将使残留位变灰，最后一个随机传递将消除任何“残留残留”位。

永远不要用零传球。在磁显微镜下，数据仍然存在，只是“褪色”了。

永远不要相信“单个文件粉碎”，尤其是在闪存驱动器等固态介质上。如果您需要“切碎”一个文件，那么请“删除”它并用随机数据文件填充您的驱动器，直到它用完空间。然后下一次三思而后行，将有价值的数据与“低清除”的东西放在同一介质上。

古特曼方法是基于锡箔帽的推测，它做各种事情来让驱动器对自己消磁，这在艺术意义上是令人钦佩的，但实际上它是矫枉过正的。迄今为止，没有任何私人组织能够成功地从一次随机传递中恢复数据。至于老大哥，如果国防部认为它已经消失了，那么您就知道它已经消失了，军事工业综合体会花大价钱尝试做古特曼声称他们可以做的事情，如果他们有技术可以做，请相信我所以它已经泄露给了私营部门，因为他们都在床上。但是，尽管如此，如果您想使用 gutmann，请查看用于 linux 的安全删除包。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-10T03:29:49.237

7 次传球和 35 次传球将永远完成。HIPAA 只需要 DOD 3 次覆盖，我不确定为什么 DOD 甚至有 7 次覆盖，因为看起来他们只是在处理机器之前简单地粉碎了磁盘。从理论上讲，您可以从每个轨道的外边缘恢复数据（使用扫描电子显微镜或显微磁探针），但实际上您需要磁盘驱动器制造商或三个字母政府组织之一的资源来执行此操作.

执行多遍写入的原因是利用定位中的轻微错误来覆盖磁道的边缘，从而大大降低恢复的可能性。

大多数驱动器恢复公司甚至无法恢复数据被覆盖一次的驱动器。他们通常利用 Windows 不会将数据块归零，只是更改目录以标记可用空间这一事实。他们只是简单地“取消删除”文件并使其再次可见。

如果您不相信我，请打电话给他们并询问他们是否可以恢复已被dd'ed的磁盘......他们通常会告诉您不，如果他们同意尝试，那将是严重的$ $$ 把它找回来...

对于大多数（即非绝密）人来说，DOD 3 次通过，然后是零覆盖应该已经足够了。

DBAN（及其商业支持的后代 EBAN）干净利落地完成了这一切......我会推荐这些。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-10T01:49:01.127

请参阅：[从磁性和固态存储器中安全删除数据](http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-14T03:16:54.653

高级恢复工具可以轻松恢复单次删除的文件。而且它们也很昂贵（例如[http://accessdata.com/](http://accessdata.com/)）。

来自[http://sourceforge.net/projects/gutmannmethod/](http://sourceforge.net/projects/gutmannmethod/)的 Gutmann 通道的可视化 GUI显示它有 8 个半随机通道。我从未见过 Gutmann 删除的文件被恢复的证据。

一个矫枉过正，也许，比 Windows 软删除要好得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-16T17:02:49.910

关于问题的第二部分，这里的一些答案实际上与对该确切特应性的实际研究相矛盾。根据维基百科上[数据擦除](http://en.wikipedia.org/wiki/Data_erasure)文章所需的[覆盖次数](http://en.wikipedia.org/wiki/Data_erasure#Number_of_overwrites_needed)，在现代驱动器上，多次擦除是多余的：

> “2001 年之后制造的 ATA 磁盘驱动器（超过 15 GB）通过一次覆盖媒体来清除足以保护媒体免受键盘和实验室攻击。” （[引用](http://en.wikipedia.org/wiki/Data_erasure#cite_note-SP800-88-18)）

此外，[infosec 做了一篇很好的文章，题为“多通道硬盘覆盖的城市传奇”](http://www.infosecisland.com/blogview/16130-The-Urban-Legend-of-Multipass-Hard-Disk-Overwrite.html)，在整个主题上，谈到了*旧*的美国政府擦除标准等，多通道神话是如何在行业中建立起来的。

> “幸运的是，几位安全研究人员在第四届信息系统安全国际会议 (ICISS 2008) 上发表了一篇论文 [WRIG08]，该论文宣布了关于要解决多少次覆盖各种数据值的“巨大争议”：他们的研究表明即使使用了 MFM 和 STM 技术，使用任意数据值的单次覆盖也会使原始数据无法恢复。
> 
> 研究人员发现，从以前使用过的 HDD 中恢复单个位的概率仅比抛硬币好一点，并且恢复更多位的概率呈指数下降，因此很快就接近于零。
> 
> 因此，使用任意值（随机选择或不随机选择）的单次覆盖足以使原始 HDD 数据有效地无法恢复。”

# visual-studio - 在 Visual Studio 中调试命令行应用程序后暂停

> ID：276843
> 
> 赞同：1
> 
> 时间：2008-11-10T01:30:09.480
> 
> 标签：visual-studio, command-line

有没有办法在命令行应用程序完成运行后在主函数结束之前编写单独的批处理文件或添加系统调用以暂停或获取或断点以保持命令窗口打开？

换句话说，项目属性中是否有办法在运行目标路径后运行另一个命令？如果我的程序是“foo.exe”，则相当于包含

```
@foo
@pause 
```

编辑：添加“或 getch 或断点”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-10T01:39:42.783

你可能知道，至少在 C# 项目系统中，按 Ctrl-F5 会在末尾添加一个“按任意键继续”。但这不能在调试器下运行，所以我赞同先前的回答，即“在 main 的末尾放置一个断点”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T01:37:04.190

如果在调试器中运行（按照您的问题的标题），我只是在 main 方法的右大括号处放置一个断点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T01:36:20.450

在 C++ 中

```
#include <conio.h>

// .. Your code

int main()
{
  // More of your code

  // Tell the user to press a key 
  getch();      // Get one character from the user (i.e a keypress)

  return 0;

} 
```

如果您在批处理文件中，“暂停”命令会输出“按任意键继续”并等待按键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T01:37:47.123

如果有人可以访问源代码，

1.) 是否会在 main 结束之前添加一个 getch()，而不是在显示控制台应用程序控制台窗口时暂停应用程序执行？基本上添加任何等待键盘输入的代码

-广告

# c++ - MFC 中 AddString 的性能缓慢

> ID：276847
> 
> 赞同：4
> 
> 时间：2008-11-10T01:35:00.840
> 
> 标签：c++, performance, winapi, mfc

我有一个对话框，里面有几个大的组合框（每个可能有几百个项目）。当这些被填充时，施工有一个明显的延迟（通过分析确认是它们）。

我最初的想法是排序正在扼杀它的性能，但禁用排序并改用 InsertString 似乎并没有让事情变得更好。我没想到这似乎是过多的项目 - 我应该在这里做或考虑其他事情吗？

MFC 调用是 Win32 消息调用的微不足道的包装，所以我认为那里没有任何重大开销。

重复[如何尽可能快地将大量字符串加载到 MFC 组合框控件中？](https://stackoverflow.com/questions/229395/how-to-load-string-of-array-in-to-combobox-faster-in-mfc)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-10T01:46:07.857

您应该在添加周围使用 CWnd::SetRedraw，以防止控件在每次添加后更新其所有内部状态。

如果您还没有这样做，请执行以下操作：

```
combo.SetRedraw(FALSE);

...  All the adds

combo.SetRedraw(TRUE);
combo.Invalidate(); 
```

您还应该考虑使用[CComboBox::InitStorage](http://msdn.microsoft.com/en-us/library/9eyf7ht2%28VS.80%29.aspx)函数，该函数为组合框预分配内存。

# design-patterns - 一个对象是否应该有一个结果是基于业务逻辑的属性？

> ID：276853
> 
> 赞同：2
> 
> 时间：2008-11-10T01:37:23.317
> 
> 标签：design-patterns, oop

还是在涉及业务逻辑时它们应该始终是一个函数？

示例：Order.RequiresPayment

属性或功能？至于何时是真的，有商业规则

是否有一种模式可以确定这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T01:50:17.613

如有疑问，请考虑将代码维护作为指导方针。

如果`OrderRequiresPayment`非常简单地确定（例如，`true`在订单创建`false`时设置，在收到付款时设置），则属性很好。

如果它是由公式确定的，或者在很多地方都更新了，那么最好将它封装在一个函数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T01:50:30.467

这是一个特定于语言的问题。

例如，在 Python 中，业务规则可以（而且通常是）两者兼而有之。

主要是，它们是方法函数。

但是，如果在阅读代码时看起来更容易，Python 允许它们显示为属性。

注意

1.  业务规则通常是方法功能。有时它们是对象之间的关系。方法功能易于扩展和修改。当您需要添加特性并将属性更改为方法函数时，从属性开始是错误的。

2.  属性最好用作语法糖，使方法函数看起来像属性，因为它使代码更简单或更易于阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T03:42:12.207

通常，属性不需要复杂的计算。

一个属性承诺非常快，而一个函数（或方法）却没有。因此，一个计算出来的值或者可能需要一些时间来检索的值应该是一个方法，而一个立即准备好的值可以是一个属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T03:50:18.573

我最讨厌的一点是对属性的访问导致对象的状态发生变化。属性应该揭示对象的现有状态，而函数可以用来改变对象的某些东西。

在访问属性时导致对象的状态发生变化会使调试变得非常困难 - 开发人员通常希望函数会导致某些事情发生，并且在使用调试器时不会让函数运行，除非他们为结果做好准备。另一方面，大多数调试器会自动访问对象的公共属性，而不期望仅通过访问属性来更改对象的状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T02:08:29.353

您通常可以决定将其视为业务属性还是业务功能更有意义。抽象级别不会改变你思考事物的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T02:08:35.907

我同意亚当的观点。通常，一个属性将包含一个值，例如 Count、Length 等。

# refactoring - Makefile 中的循环

> ID：276856
> 
> 赞同：4
> 
> 时间：2008-11-10T01:38:14.190
> 
> 标签：refactoring, makefile

我有很多任务，我必须在添加更多后续编号的 C 程序时不断更新 Makefile。有没有办法通过循环遍历值 1.1、1.2、1.3 等来做到这一点？

```
all: 1.1 1.2 1.3 1.4 1.5 1.6 1.7\. 1.8 1.9

1.1: 1.1.o
    gcc -o 1.1 $(FLAGS) 1.1.o
1.1.o: 1.1.c
    gcc -c $(FLAGS) 1.1.c

1.2: 1.2.o
    gcc -o 1.2 $(FLAGS) 1.2.o
1.2.o: 1.2.c
    gcc -c $(FLAGS) 1.2.c

1.3: 1.3.o
    gcc -o 1.3 $(FLAGS) 1.3.o
1.3.o: 1.3.c
    gcc -c $(FLAGS) 1.3.c

1.4: 1.4.o
    gcc -o 1.4 $(FLAGS) 1.4.o
1.4.o: 1.4.c
    gcc -c $(FLAGS) 1.4.c

1.5: 1.5.o
    gcc -o 1.5 $(FLAGS) 1.5.o
1.5.o: 1.5.c
    gcc -c $(FLAGS) 1.5.c

1.6: 1.6.o
    gcc -o 1.6 $(FLAGS) 1.6.o
1.6.o: 1.6.c
    gcc -c $(FLAGS) 1.6.c

1.7: 1.7.o
    gcc -o 1.7 $(FLAGS) 1.7.o
1.7.o: 1.7.c
    gcc -c $(FLAGS) 1.7.c

1.8: 1.8.o
    gcc -o 1.8 $(FLAGS) 1.8.o
1.8.o: 1.8.c
    gcc -c $(FLAGS) 1.8.c

1.9: 1.9.o
    gcc -o 1.9 $(FLAGS) 1.9.o
1.9.o: 1.9.c
    gcc -c $(FLAGS) 1.9.c

clean:
    rm -f *.o
    rm -f 1.1 1.2 1.3 1.4 1.5 1.6 1.7\. 1.8 1.9
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-10T01:46:19.367

你想要一个[后缀规则](http://owen.sj.ca.us/rkowen/howto/slides/make/slides/makesuff.html)，而不是一个循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T01:51:39.717

尝试如下规则：

```
OBJECTS = 1.1.o 1.2.o 1.3.o

all: $(OBJECTS)

%.o: %.c
    gcc $(FLAGS) %< -o $* 
```

然后你只需要将额外的对象添加到列表中，一切都很好。

隐式规则可帮助您真正最小化 makefile 中的复制/粘贴周期。

[http://www.gnu.org/software/autoconf/manual/make/Implicit-Rules.html#Implicit-Rules](http://www.gnu.org/software/autoconf/manual/make/Implicit-Rules.html#Implicit-Rules)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T01:44:49.963

是的; 您可以在 Makefile 中使用 shell 命令，并且 make 本身可以提供您需要的循环。网络上有很多很好的例子。假设您使用的`gcc`是 GNU make，请在此处尝试：

[http://www.gnu.org/software/make/manual/make.html#Foreach-Function](http://www.gnu.org/software/make/manual/make.html#Foreach-Function)

# iphone - 如何从视图中动态隐藏按钮？

> ID：276861
> 
> 赞同：36
> 
> 时间：2008-11-10T01:45:16.703
> 
> 标签：iphone, cocoa-touch

我想根据特定条件在我的一个视图中动态隐藏一个按钮。

我尝试在视图控制器的`-viewWillAppear`方法中添加一些代码，以在显示实际视图之前隐藏按钮，但我仍然不知道该怎么做。

我通过 IBOutlet 引用了按钮，但我不确定如何从这里继续前进。作为参考，这是一个 UIBarButtonItem 实例。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-10T04:23:55.337

如果您试图隐藏 UIBarButtonItem，您实际上必须修改父栏的内容。如果它是 UIToolBar，则需要将栏的 items 数组设置为不包含您的 item 的数组。

```
NSMutableArray     *items = [[myToolbar.items mutableCopy] autorelease];
[items removeObject: myButton];
myToolbar.items = items; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-07-30T23:26:12.840

将 bar 项设置为 nil。

例如：

```
self.navigationItem.leftBarButtonItem = nil; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-04-14T20:01:42.580

所以我尝试了 Ben 的获胜方法，但最终我发现它对我的目的来说是错误的——尽管我确信这取决于你想要做什么。我试图仅在某些条件下显示导航栏按钮，然后在不再满足条件时立即隐藏它（在我的情况下，它是一个“完成”按钮，用于隐藏与 UITextView 关联的键盘。它应该只是当用户在文本视图中键入时显示）。我的步骤如下：

1.  我在 UIViewController 类中添加了一个 UIBarButtonItem 作为属性。我在 initWithNibName 方法中实例化它。

2.  一旦用户开始在文本视图中输入，我就将 UIBarButtonItem 属性分配为导航栏中的 rightBarButtonItem。

3.  当用户完成输入时，我将 UIBarButtonItem 属性设置为 nil。

它就像一个魅力。我在下面添加了一些代码示例。

首先在我的视图控制器初始化方法中实例化按钮：

```
barButtonItemDone = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(done:)]; 
```

然后我将它设置为委托方法中的右栏按钮，一旦用户开始编辑文本视图，就会调用该按钮：

```
self.navigationItem.rightBarButtonItem=[self barButtonItemDone]; 
```

最后，当单击按钮本身时，会调用一个名为“done”的方法，我只是在该方法中将 rightBarButtonItem 设置为 nil：

```
self.navigationItem.rightBarButtonItem=nil; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-08-23T18:09:07.867

如果想要隐藏的只是导航栏中的后退按钮，那么有一种更简单的方法：

```
self.navigationItem.hidesBackButton = YES; 
```

来自开发者文档的引用：

> 隐藏返回按钮
> 
> 一个布尔值，用于确定后退按钮是否隐藏。
> 
> @property(nonatomic, assign) BOOL hidesBackButton
> 
> 讨论
> 
> YES 如果在此导航项是顶部项时隐藏后退按钮；否则，否。默认值为 NO。
> 
> 可用性
> 
> 适用于 iPhone OS 2.0 及更高版本。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-11-28T16:27:54.460

这有点小技巧，但它适用于我的情况（并且它可以正确处理动态间距）：

隐藏：

```
myButton.width = 0.1; 
```

显示：

```
myButton.width = 0.0; 
```

0.0 的宽度是“自动宽度”，宽度为 0.1 时，按钮完全消失（甚至没有按钮的“条”，尽管我没有在视网膜显示器上尝试过）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-01-20T23:59:30.607

另一个hacky解决方案：

```
myButton.customView = [[UIView alloc] init]; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-15T19:53:35.240

最好的解决方案是技术含量较低。您需要做的就是创建正常的导航栏（顶部）或工具栏（底部），但没有可选按钮。然后创建另一个相同但较短的栏，然后将其放置在您想要可选按钮的部分，并在第二个较短的栏上创建您的可选按钮。

现在您可以调用`hidden = YES`整个附加栏。

对我来说，这些条形无缝重叠，您的里程可能会有所不同。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-12-11T02:07:25.947

这个答案是关于基于文本的 UIBarButtonItems，但是，同样的概念也可以应用于其他类型的按钮。请注意，这将允许您再次隐藏*和*显示该项目。上面的许多答案（例如，那些将按钮的值设置为 nil 的答案，如果需要，不允许重新显示按钮）。

TL;博士：

```
if (shouldShowMyBarButtonItem) {
    self.myBarButtonItem.title = nil;
    self.myBarButtonItem.action = nil;
} else if (!shouldShowMyBarButtonItem) {
    self.myBarButtonItem.title = @"Title";
    self.myBarButtonItem.action = @selector(mySelector:);
} 
```

长版：

我试图隐藏的 UIBarButtonItem 位于 UIToolbar 中，而不是 UINavigationBar 中，因此访问导航项上左侧（或右侧）barButtonItem 属性的所有建议都对我不起作用。另外，如上所述，我希望在情况发生变化时重新显示按钮。

Michael 的建议最接近有效，但是，至少在 iOS 7 中，显示的按钮仍有一小部分是可点击的*。*在我的应用程序中，当它不应该可用时点击该项目是不可接受的。上面的代码既隐藏了按钮，又关键的是停用了按钮。

我在私有刷新方法中调用上述代码，当用户事件发生时调用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-16T04:23:24.667

这是我为不属于导航栏的按钮项所做的（其中 Blank.png 是我创建的空白图像，与它替换的图像大小相同）：

```
theButton.enabled = NO;
theButton.image = [UIImage imageNamed: @"Blank.png"]; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-09-03T01:08:36.180

Ben 的回答在技术上是正确的，但是当我在我的自定义 UIToolbar 上尝试它时，项目以我不喜欢的方式间隔开，因为我使用 UIBarButtonSystemItemFlexibleSpace 项目。

如果您希望其他物品留在同一个地方，您要么必须将灵活空间设置为固定空间，要么尝试我所做的：

```
[filterBarButton.customView setHidden:YES]; 
```

注意：这仅适用于您的 UIBarButtonItem 使用自定义视图。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-30T19:04:35.130

如果您将 a 添加`UIButton`到`UIBarButtonItem`而不是仅使用`UIBarButtonItem`.

然后您可以分配`UIButton.hidden`给`TRUE`or`YES`并且它（和`UIBarButtonItem`）将不可见或不活动。

希望有帮助。

* * *

## 回答 #12

> 赞同：-13
> 
> 时间：2008-11-10T02:11:06.527

只需将按钮的隐藏属性设置为 true：

```
myButton.hidden = YES; 
```

# asp.net - 如何使 ASP.NET MVC 从 IRouteHandler.GetHttpHandler() 识别 IHttpAsyncHandler？

> ID：276867
> 
> 赞同：4
> 
> 时间：2008-11-10T01:49:34.120
> 
> 标签：asp.net, asp.net-mvc, asynchronous, ihttpasynchandler, iroutehandler

在这个[问答](https://stackoverflow.com/questions/275545/does-aspnet-mvc-framework-support-asynchronous-page-execution)中，我找到了一种让 ASP.NET MVC 支持异步处理的方法。但是，我不能让它工作。

基本上，这个想法是创建一个新的 IRouteHandler 实现，它只有一个方法***GetHttpHandler***。GetHttpHandler方法应该返回一个实现而不是 just ***，***因为有 Begin/EndXXXX 模式 API。`IHttpAsyncHandler``IHttpHandler``IHttpAsyncHandler`

```
public class AsyncMvcRouteHandler : IRouteHandler
{
    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        return new AsyncMvcHandler(requestContext);
    }

    class AsyncMvcHandler : IHttpAsyncHandler, IRequiresSessionState
    {
        public AsyncMvcHandler(RequestContext context)
        {
        }

        // IHttpHandler members
        public bool IsReusable { get { return false; } }
        public void ProcessRequest(HttpContext httpContext) { throw new NotImplementedException(); }

        // IHttpAsyncHandler members
        public IAsyncResult BeginProcessRequest(HttpContext context, AsyncCallback cb, object extraData)
        {
            throw new NotImplementedException();
        }

        public void EndProcessRequest(IAsyncResult result)
        {
            throw new NotImplementedException();
        }
    }
} 
```

然后，在文件 Global.asax.cs 的 RegisterRoutes 方法中，注册这个类***AsyncMvcRouteHandler***。

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.Add(new Route("{controller}/{action}/{id}", new AsyncMvcRouteHandler())
    {
        Defaults = new RouteValueDictionary(new { controller = "Home", action = "Index", id = "" }),
    });
} 
```

***我在ProcessRequest***、***BeginProcessRequest***和***EndProcessRequest***设置断点。仅执行***ProcessRequest***。换句话说，即使***AsyncMvcHandler***实现了***IHttpAsyncHandler***。ASP.NET MVC 不知道这一点，只是将其作为`IHttpHandler`实现处理。

如何使 ASP.NET MVC 将***AsyncMvcHandler***视为***IHttpAsyncHandler***以便我们可以进行异步页面处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T00:17:14.140

我遇到了同样的问题，但是我发现这是因为我的捕获所有路由处理程序：

```
routes.MapRoute(
    "Default",                                                  
    "{controller}/{action}",                           
    new { controller = "Home", action = "Index" }  
); 
```

正在接收请求，而不是我添加的处理异步路由处理程序的自定义路由。也许通过在您的自定义路由定义中使用 .mvc，您创建了一个区别，以便使用它而不是同步包罗万象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T02:30:38.543

经过数小时的代码麻烦后，我发现了问题所在。

在我的 Visual Studio 2008 中，当我按下 Ctrl+F5 时，会启动应用程序开发服务器并弹出 IE 以访问“ [http://localhost:3573/](http://localhost:3573/) ”。在这种情况下，将调用同步 API ***ProcessRequest***。堆栈跟踪是这样的。

> > MyMvcApplication.DLL!MyMvcApplication.AsyncMvcRouteHandler.AsyncMvcHandler.ProcessRequest(System.Web.HttpContext httpContext = {System.Web.HttpContext}) 第 59 行 C# System.Web.Mvc.dll!System.Web.Mvc.MvcHttpHandler.VerifyAndProcessRequest(System. Web.IHttpHandler httpHandler, System.Web.HttpContextBase httpContext) + 0x19 字节
> > System.Web.Routing.dll!System.Web.Routing.UrlRoutingHandler.ProcessRequest(System.Web.HttpContextBase httpContext) + 0x66 字节
> > System.Web.Routing.dll !System.Web.Routing.UrlRoutingHandler.ProcessRequest(System.Web.HttpContext httpContext) + 0x28 字节
> > System.Web.Routing.dll!System.Web.Routing.UrlRoutingHandler.System.Web.IHttpHandler.ProcessRequest(System.Web.HttpContext上下文）+ 0x8 字节
> > MyMvcApplication.DLL!MyMvcApplication._Default.Page_Load(object sender = {ASP.default_aspx}, System.EventArgs e = {System.EventArgs}) 第 13 行 + 0x1a 字节 C#

但是，当我将 IE 中的 URL 更改为“ [http://localhost:3573/whatever.mvc](http://localhost:3573/whatever.mvc) ”时，它会命中***BeginProcessRequest***。堆栈跟踪是这样的。

> > MyMvcApplication.DLL!MyMvcApplication.AsyncMvcRouteHandler.AsyncMvcHandler.BeginProcessRequest（System.Web.HttpContext context = {System.Web.HttpContext}，System.AsyncCallback cb = {Method = {Void OnAsyncHandlerCompletion(System.IAsyncResult)}}，对象 extraData = null ) 第 66 行 C# System.Web.dll!System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() + 0x249 字节 System.Web.dll!System.Web.HttpApplication.ExecuteStep(System.Web. HttpApplication.IExecutionStep step = {System.Web.HttpApplication.CallHandlerExecutionStep}, ref bool completedSynchronously = true) + 0x9c 字节
> > System.Web.dll!System.Web.HttpApplication.ApplicationStepManager.ResumeSteps(System.Exception 错误) + 0x133 字节
> > System.Web.dll!System.Web.HttpApplication.System.Web.IHttpAsyncHandler.BeginProcessRequest(System.Web.HttpContext context, System.AsyncCallback cb, object extraData) + 0x7c 字节
> > System.Web.dll!System.Web.HttpRuntime。 ProcessRequestInternal(System.Web.HttpWorkerRequest wr = {Microsoft.VisualStudio.WebHost.Request}) + 0x17c 字节 System.Web.dll!System.Web.HttpRuntime.ProcessRequestNoDemand(System.Web.HttpWorkerRequest wr) + 0x63 字节
> > System.Web。 dll!System.Web.HttpRuntime.ProcessRequest(System.Web.HttpWorkerRequest WR) + 0x47 字节
> > WebDev.WebHost.dll!Microsoft.VisualStudio.WebHost.Request.Process() + 0xf1 字节 WebDev.WebHost.dll!Microsoft.VisualStudio.WebHost.Host.ProcessRequest(Microsoft.VisualStudio.WebHost.Connection conn) + 0x4e 字节

似乎只有带有“.mvc”后缀的url才能调用异步API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T19:07:18.953

我过去曾尝试过这样做，我设法要么让视图呈现，然后所有异步任务都会完成。或者异步任务要完成但视图不会呈现。

我基于原始 MVC 代码创建了一个 RouteCollectionExtensions。在我的 AsyncMvcHandler 中，我有一个用于 ProcessMethod 的空方法（没有例外）。

# c# - 非网络环境中的第一个“程序”

> ID：276872
> 
> 赞同：2
> 
> 时间：2008-11-10T01:50:57.923
> 
> 标签：c#, .net, winforms

我开始在桌面应用程序中重新掌握自己的技能。几年来我一直在做 Web 应用程序。

我正在阅读一些不错的 C# 书籍，但它们更像是语言参考。我想要的是带有实践练习的列表/站点/书籍，最好按照难度分级。

它们也不一定必须来自 C# 站点，但这当然是有利的。

你知道这样的资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T02:20:15.913

关于学习 C# 语言本身和运行时的话题，我会推荐MSDN 上的[Learn C#部分。](http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx)有很多关于 C# 的文章和整理材料的链接。您可以将其与 Jesse Liberty 的[Learning C# 3.0](https://rads.stackoverflow.com/amzn/click/com/0596521065)结合使用。

关于桌面编程这个话题，答案取决于你想使用什么平台。

如果您想以 WPF 为目标，我建议您使用 Petzold 的[Applications = Data + Markup](https://rads.stackoverflow.com/amzn/click/com/0596510373)。（附带说明一下，学习 WPF 将为您提供使用 Silverlight 了解 RIA 的基础）

如果您想以 WinForms 为目标...好吧，我有偏见，建议您反对。但是，如果您坚持，Petzold 的[Programming Microsoft Windows Forms](https://rads.stackoverflow.com/amzn/click/com/0735621535)是另一本好书。:-) Chris Sells 的[Windows Forms 2.0 Programming](https://rads.stackoverflow.com/amzn/click/com/0321267966)也是一本非常好的关于 WinForms 的书。

WindowsClient.net[入门](http://windowsclient.net/getstarted/)和[学习](http://windowsclient.net/learn/)部分包含大量针对 WinForms 和 WPF 的培训视频、文章、常见问题解答和示例。[社区书籍](http://windowsclient.net/Community/books.aspx)部分还包含大量有关这两种技术的书籍。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-10T01:59:38.047

有很多关于[C# Practical Learning](http://www.functionx.com/csharp/)的优秀 C# 教程，涵盖多个主题。

如果您想尝试非参考书，我还推荐[Head First C# 。](http://oreilly.com/catalog/9780596514822/)

# asp.net-mvc - 如何让 CheckBox 在 ASP.NET MVC 的回发中保持选中状态？

> ID：276874
> 
> 赞同：0
> 
> 时间：2008-11-10T01:55:11.347
> 
> 标签：asp.net-mvc

我有一个带有表单的 ASP.NET MVC 项目。在处理 POST 动词的 Action 方法中，我有一个自定义`IModelBinder`实现，它将表单数据绑定到我的模型实例。如果我正在使用错误`bindingContext.ModelState.SetAttemptedValue()`并将`bindingContext.ModelState.AddModelError()`提交的值和错误消息保存到`ModelState`.

这很好用，我可以看到我的输入控件上发生的预期行为`Html.TextBox()`（通过调用 to `Html.InputHelper()`）。当我使用`Html.CheckBox()`（也调用 to `Html.InputHelper()`）时，我的 CheckBox 的状态**不会**输出到 th`<input />`标签。

在我看来，该`Html.InputHelper()`方法似乎没有将 ModelState 中的 AttemptedValue 用于 CheckBox 类型的输入字段。

这是来自[ASP.NET MVC`Html.InputHelper()`方法](http://www.codeplex.com/aspnet/SourceControl/FileView.aspx?itemId=288010&changeSetId=17272)的代码。

为什么 CheckBox allowedValue 没有输出到输入标签。我在这里遗漏了什么，还是我需要通过检查 ModelState 并自己设置标签属性来手动处理这种情况？

**更新 11/09**这是我用来输出 CheckBox
的调用：`HtmlHelpers`

```
<%= Html.CheckBox("IsDerived") %> 
```

这是我用来注册尝试值的调用：

```
string isDerivedRequestValue = !string.IsNullOrEmpty(bindingContext.HttpContext.Request["IsDerived"]) ? bindingContext.HttpContext.Request.Form.GetValues("IsDerived") [0] : null;
bindingContext.ModelState.SetAttemptedValue("IsDerived", isDerivedRequestValue); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T02:37:33.383

我不确定这是否是解决问题的最佳方法，但由于该`Html.InputHelper()`方法没有检查 CheckBox 控件的 AttemptedValue，我将以下内容添加到我的控制器中，该控制器将正确的值嵌入其中，`ModelState`并且`ViewData`似乎做到了把戏相当好。

```
ViewData["IsDerived"] = ViewData.ModelState.ContainsKey("IsDerived")
                           ? bool.Parse(ViewData.ModelState["IsDerived"].AttemptedValue)
                           : false; 
```

确保在调用时没有显式设置`isChecked`参数值，`Html.CheckBox()`因为这将覆盖存储在`ViewData`.

# c# - 在 C++ 之后学习 C#

> ID：276884
> 
> 赞同：25
> 
> 时间：2008-11-10T02:06:00.997
> 
> 标签：c#, c++

在语言的发展过程中，我一直在学习 C 和 C++。现在我想学习C#。我知道它们之间存在一些巨大的差异 - 例如删除指针和垃圾收集。但是，我不知道两者之间的许多区别。

C++ 程序员在迁移到 C# 时需要了解的主要区别是什么？（例如，我可以用什么来代替 STL，它们之间的语法差异，或者其他任何可能被认为重要的东西。）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-10T02:08:40.167

[C# for C++ Developers](https://msdn.microsoft.com/en-us/library/yyaad03b(v=vs.90).aspx?f=255&MSPPError=-2147217396)是一个很好的起点。该表列出了两种语言之间最重要的比较。

一旦你探索了其中的一些差异，你可能会选择一个你过去用 C++ 编写的独立项目，然后用 C# 重新编写它。在您的第一遍中，您可能会使用相同的设计和算法直接进行翻译。随着您对 C# 的熟悉程度越来越高，您将了解如何利用仅在 C# 中提供的语言功能以及极其通用的 .NET Framework。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-10T02:12:34.993

我认为重要的是要注意指针并没有真正从 C# 中*删除*，但它们仍然存在，它们无处不在，它们被称为**引用**。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-10T06:32:33.113

Charles Petzold 有一本[.NET Book Zero](http://www.charlespetzold.com/dotnet/index.html)，专为想要学习 C# 和 .NET 的 C/C++ Windows 程序员设计。这是从他的网站免费下载的 PDF 文件。本书中使用的所有源代码都可作为单独的 Zip 文件下载。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T02:26:16.590

查看类似 STL 的功能的通用集合和 LINQ（与 LINQ 相关的所有技术）。

要注意的第一件事是 ~/Destructor is c++ 与 c# 中的 ~/finalizer 完全不同——请参阅 IDisposable/using。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-10T02:26:47.133

有一个类似的问题有很多关于 C++ 和 C# 之间差异的指针（双关语:-)）和资源，以及学习过渡时要注意的事项 - [Linux/C++ 程序员到 Windows/C# 程序员](https://stackoverflow.com/questions/131589/linuxc-programmer-to-cwindows-programmer)。

# asp.net - 如何在 ASP.NET 中删除/丢弃请求？

> ID：276891
> 
> 赞同：6
> 
> 时间：2008-11-10T02:12:21.407
> 
> 标签：asp.net

我试图弄清楚如何丢弃/丢弃请求，我基本上是在尝试在我的应用程序中实现一个阻止的 IP 列表来阻止垃圾邮件发送者，我不想返回任何响应（只是忽略请求），这在 ASP.NET 中可行吗？

编辑：一些答案表明我可以将它们添加到防火墙中，虽然这肯定会更好，但它不适合我的情况。长话短说，我在我的网站上添加了一个审核部分，版主将在其中检查等待审核的帖子是否有垃圾邮件（由垃圾邮件过滤器过滤），我希望将某些帖子的发件人的 IP 添加到帖子被版主标记为垃圾邮件后被阻止的 IP 列表，这就是我想在应用程序中执行此操作的原因。

编辑：调用 Response.End() 向用户返回一个响应（即使它是空的），我的问题的全部目的是如何不返回任何响应。这可能吗（即使出于好奇）？还有 Response.Close() 关闭套接字但它在执行此操作时发送通知（在 TCP/IP 中），我只是想忽略它，因为它从未收到过（即不向用户发送任何内容）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-10T02:54:38.123

对于这种类型的事情，我会使用**[HTTP 模块](http://msdn.microsoft.com/en-us/library/t2yzs44b.aspx)**，而不是使用处理程序或页面。

为什么使用模块而不是处理程序？在请求管道中较早地调用了 HTTP 模块。对于这些类型的列入黑名单的请求，您希望尽可能早且快速地放弃该请求。这意味着您可以在请求中越早放弃请求越好。

[您可以在此处](http://msdn.microsoft.com/en-us/library/bb398986.aspx)阅读更多关于模块与处理程序的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-10T02:14:51.493

也许你可以使用

```
Response.Clear();
Response.End(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T02:41:41.520

**编辑：**这可能更好地实现为 HTTPModule 而不是处理程序，但基本思想是正确的。有关详细信息，请参阅[http://www.kowitz.net/archive/2006/03/08/ihttpmodule-vs-ihttphandler.aspx](http://www.kowitz.net/archive/2006/03/08/ihttpmodule-vs-ihttphandler.aspx)

* * *

您可能可以使用 httphandler 来执行此操作，这样您就不必担心在应用程序代码中检查它 - 它甚至在您的应用程序执行之前就已处理。

**伪代码 - 未经测试**

```
class IgnoreHandler : IHttpHandler
{
    #region IHttpHandler Members

    public bool IsReusable
    {
        get { return true; }
    }

    public void ProcessRequest(HttpContext context)
    {
        context.Response.Clear();
        context.Response.StatusCode = 401;
        context.Response.Status = "Unauthorized";
        context.Response.End();
    }

    #endregion
} 
```

显然，如果您希望它返回 HTTP 200（OK）和一个空白页面，只需删除引用 StatusCode 和 Status 的两行。

然后在 web.config 中注册

```
<httpHandlers>
    <add verb="*" 
         path="*" 
         validate="false" 
         type="MyNamespace.IgnoreHandler, MyAssembly" />
</httpHandlers> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T02:17:45.437

我的第一个想法是约翰建议的。最理想的解决方案是将这些 IP 添加到防火墙中的阻止 IP 列表（如果您可以访问它），这样您的应用程序根本不需要进行任何处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-22T09:15:19.870

干得好：

```
public class RequestDropper : IHttpModule
{
    public void Dispose()
    {
        throw new NotImplementedException();
    }

    public void Init(HttpApplication context)
    {
        context.BeginRequest += Context_BeginRequest;
    }

    public void Context_BeginRequest(object sender, EventArgs e)
    {
        var request = ((HttpApplication)sender).Context.Request;

        if (todayIAmNotInAMoodToProcessRequests)
        {
            request.Abort();
        }
    }
} 
```

希望这可以节省您一些时间

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T10:32:29.400

AFAIK 没有办法在没有响应的情况下直接放弃请求。您可以使用您喜欢的任何线程休眠技术在 ASP.NET 中保持请求旋转，但这样不会让您的服务器生活得更好。

我所知道的实现您想要的最佳方法是让像[ZXTM](http://www.zeus.com/)这样的流量管理器在请求完全到达网络服务器之前关闭请求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-10T03:32:19.920

我建议最好的解决方案不是给出特定的“无响应”，而是给出更令人沮丧的标准 http 错误消息。每当我试图阻止未经授权的用户时，我都会发出一条找不到页面/网址的消息，如下所示：

```
throw new HttpException(404, "File not found - " + Request.AppRelativeCurrentExecutionFilePath);
```

我认为这对于说服另一端的人放弃并离开非常有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-10T04:07:58.753

您可能想看看这个[http://www.angrypets.com/tools/rdos/](http://www.angrypets.com/tools/rdos/)，出于类似的原因，它与您正在谈论的内容类似，并且被实现为一个模块。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-10T13:41:51.640

另一种烦人但简单的方法是在关闭请求之前将请求休眠一段令人沮丧的时间。

# wpf - 我将如何制作一个在鼠标点击时闪烁/淡出的控件？（视窗）

> ID：276905
> 
> 赞同：3
> 
> 时间：2008-11-10T02:22:56.453
> 
> 标签：wpf, winforms, controls, fade

当用户单击我控件中的某些位置时，我想更改网格中某些行和列的颜色，然后在大约 500 毫秒内将其淡化回正常颜色。我还没有决定是使用 Winforms 还是 WPF，所以任何一种技术的建议都可以。谢谢你。

编辑：我知道我可以通过在单击事件中循环调用 Paint 来正确设置绘图参数来做到这一点。但是我相信这会阻止用户界面，我希望比这更敏感。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T04:54:54.790

WPF 对动画有很好的支持。xaml 和背后的代码都支持动画，因此您应该能够实现您想要的任何外观。

WPF的 MSDN[动画概述](http://msdn.microsoft.com/en-us/library/ms752312.aspx)看起来有很多很好的信息可以帮助您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T06:28:43.697

这是处理淡入淡出的一种方法：

```
using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

namespace WindowsApplication1
{
    public class FadeForm : Form
    {
        private Timer fadeTimer;
        private Panel fadePanel;
        private Button fadeButton;
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose( bool disposing )
        {
            if ( disposing && ( components != null ) )
            {
                components.Dispose();
            }
            base.Dispose( disposing );
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.fadePanel = new System.Windows.Forms.Panel();
            this.fadeButton = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // fadePanel
            // 
            this.fadePanel.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.fadePanel.Location = new System.Drawing.Point( 4, 8 );
            this.fadePanel.Name = "fadePanel";
            this.fadePanel.Size = new System.Drawing.Size( 276, 104 );
            this.fadePanel.TabIndex = 0;
            // 
            // fadeButton
            // 
            this.fadeButton.Location = new System.Drawing.Point( 104, 116 );
            this.fadeButton.Name = "fadeButton";
            this.fadeButton.Size = new System.Drawing.Size( 75, 23 );
            this.fadeButton.TabIndex = 1;
            this.fadeButton.Text = "Fade";
            this.fadeButton.UseVisualStyleBackColor = true;
            this.fadeButton.Click += new System.EventHandler( this.HandleFadeButtonClick );
            // 
            // FadeForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF( 6F, 13F );
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size( 284, 142 );
            this.Controls.Add( this.fadeButton );
            this.Controls.Add( this.fadePanel );
            this.Name = "FadeForm";
            this.Text = "Fade Form";
            this.ResumeLayout( false );

        }

        #endregion

        public FadeForm()
        {
            InitializeComponent();

            this.fadeTimer = new Timer();
        }

        private void HandleFadeButtonClick( object sender, EventArgs e )
        {
            this.fadeTimer.Tick += new EventHandler( HandleFadeTimerTick );
            this.fadePanel.BackColor = Color.Red;
            this.fadeTimer.Interval = 100;
            this.fadeTimer.Start();
        }

        void HandleFadeTimerTick( object sender, EventArgs e )
        {
            Color panelColor = this.fadePanel.BackColor;

            if ( panelColor.A > 0 )
            {
                this.fadePanel.BackColor = 
                    Color.FromArgb( 
                        Math.Max( panelColor.A - 20, 0 ), 
                        panelColor.R, panelColor.G, panelColor.B );
            }
            else
            {
                this.fadeTimer.Stop();
            }
        }
    }
} 
```

不幸的是，这种方法似乎不适用于 DataGridView 中的行。我不知道原因，但是如果颜色的 alpha 分量不是 255，则颜色根本不会显示。如果您能找到解决方法，此代码可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T04:44:51.490

在最简单的情况下，像这样的淡入淡出效果只需要某种计时器，每次滴答都会使颜色恢复正常。时间越快，您从头到尾显示的离散颜色越多，整体效果就越平滑（WPF 可能有内置的东西来做到这一点）。

您绝对*不想*循环重绘。正如您指出的那样，这将阻塞 UI，并且您将无法控制循环需要多长时间（不同的机器将在不同的时间长度内将相同数量的步骤从高亮颜色渲染到正常）。

# c# - CompositeWPF 是否支持多个窗口/外壳？

> ID：276906
> 
> 赞同：3
> 
> 时间：2008-11-10T02:24:58.790
> 
> 标签：c#, .net, wpf, prism

我正在考虑使用 CompositeWPF ( [http://www.codeplex.com/CompositeWPF](http://www.codeplex.com/CompositeWPF) ) - 又名 Prism 来构建我正在开发的应用程序。

该应用程序不是传统的 LOB 应用程序，但它确实向用户呈现数据和状态信息。

我不确定的一件事是 CompositeWPF 是否支持多个窗口或外壳。我想让我的应用程序通过出现在屏幕下部 RHS 中的无边框窗口通知用户（想想 MSN 通知），但仍然使用将视图注入区域等的想法。

除此之外，我希望能够对用户操作（例如双击某物）做出反应，隐藏主窗口并在执行工作时显示进度对话框。

那么，这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T17:41:23.907

我已经使用 Composite wpf 几个月了，看不出你为什么不能做你要求的事情。

我可能不会走多壳路线，有一个'Composite wpf contrib project'定义了一个'WindowRegionAdaptor'，它应该可以很容易地在单独的窗口中显示视图（见这里：[http://www.codeplex. com/CompositeWPFContrib](http://www.codeplex.com/CompositeWPFContrib)）我没有使用它，但使用了其他一些 contrib 项目，它们按广告宣传。尽管其中一些文档目前很少甚至不存在，但论坛可能很有用。

我必须尝试一下，但您可以使用事件聚合器在双击操作上发布事件

```
eventAggregator.GetEvent<MainWindowShowEvent>().Publish(false); 
```

ShellPresenter 可以订阅并调用 shell 视图以在收到时隐藏：

```
eventAggregator.GetEvent<MainWindowShowEvent>().Subscribe(b => View.Show(b) ); 
```

然后使用 WindowRegionAdaptor 显示您的进度对话框，然后在完成后发布主窗口订阅的第二个事件，这会导致它再次显示..（上面我使用有效负载来指示外壳是否应该显示或隐藏）

希望其中一些有所帮助-所有未经测试

特雷夫

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-14T12:32:34.633

您还可以查看以下帖子：

*   [在 Prism-v2 中创建多外壳应用程序](http://blogs.southworks.net/dschenkelman/2010/01/26/creating-a-multi-shell-application-in-prism-v2/)

希望这可以帮助，

埃齐奎尔·贾迪布

# ios - 在 Linux 中开始 iPhone 应用程序开发？

> ID：276907
> 
> 赞同：544
> 
> 时间：2008-11-10T02:25:49.880
> 
> 标签：ios, linux

我听说如果你想开发 iPhone 应用程序，你需要一台 Mac。这是真的？

是否可以使用 Linux 开发 iPhone 应用程序？如果是，我需要什么以及在哪里下载必要的工具？

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2009-05-29T00:46:13.110

为了提供不同的响应，我在 Linux 上的虚拟化 (VMware) 机器上运行 OS X 和 Xcode。CPU 是 Core2Quad (Q8800)，速度非常快。我在网上找到了一个预构建的虚拟机（我会留给你去寻找）Xcode/iPhone 开发工作完美，通过 USB 调试手机本身也是如此。

它实际上让我很惊讶——但我一点问题都没有。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-11-10T07:57:00.837

这个问题的答案实际上取决于您是否要开发应用程序，然后通过 iPhone 商店分发。如果您不这样做，并且不介意为“越狱”的 iPhone 人群开发 - 那么可以从 Linux 开发。

查看此章节的页面以获取有关操作的全面（如果有点复杂）指南：

[http://www.saurik.com/id/4](http://www.saurik.com/id/4)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-11-10T02:39:59.807

到目前为止，这似乎是真的。Apple 提供的唯一 SDK 仅针对 macOS 环境。我一直对此感到不安，但我现在正在考虑购买 Mac，只是为了进行 iPhone 开发。我真的不喜欢他们正在做的事情，我希望能有一个好的 SDK 用于其他环境，例如 Linux 和 Windows。

**SDK 的**障碍：****

 **> ### [iPhone SDK 和免费软件：不匹配](http://www.linux.com/feature/131752)
> 
> 苹果公司最近发布了一个用于 iPhone 的软件开发工具包 (SDK)，但如果你希望用它移植或开发原始的开源软件，那么这个消息就不好说了。代码签名和保密条件使免费软件成为禁忌。
> 
> SDK 本身是免费下载的，您可以使用它编写程序并在软件模拟器上运行它们。但是为了真正发布你编写的软件，你必须注册 iPhone 开发者计划——这一步与下载 SDK 是分开的，并且需要 Apple 的批准。

我认为他们认为只有 macOS 用户才能为他们的手机编写程序是相当精英的，而且如果你想发布你的东西，你需要购买 100 美元的许可证，这确实让业余程序员变得更加困难。不过，如果这是你需要做的，我打算跳过他们的圈子；我真的很想在我的 iPhone 上开发一些东西。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-01-10T02:35:46.397

曾经有*一个*专门解决这个缺陷的项目：[iphone-dev](http://code.google.com/p/iphone-dev)

> iphone-dev 项目的目标是创建一个免费、便携、高质量的工具链，以支持基于 ARM/Darwin 平台的 Apple iPhone 和其他嵌入式设备的开发。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-27T08:09:16.553

关于替代工具链，Saurik 的网站很有用，但对于最新的固件开发，他表示在 iPhone 本身上构建，并且没有表示您可能需要将必要的 iPhone 固件文件复制到您的 Linux 环境。这并非不可能，但只需要额外的工作，尤其是对代码签名（也有开放的替代解决方案）。

此外，请查看其他更有条理的指南（针对同一工具链）。

我建议仍然在 XCode 中进行最终构建和代码签名和打包（这可能意味着借用某人的 Mac），以防您在向 Apple 提交应用程序时遇到问题。使用替代工具链打开了（至少在 Mac 上）使用 XCode 以外的其他 IDE 开发应用程序并再次求助于 XCode 进行模拟器部署和测试的可能性。

当然，如果您确实从 XCode 之外的命令行中获得了代码签名/证书生成，那么您可以在您的实际 iPhone 上安装一个证书并在那里进行测试（通过 iTunes 安装带有您的证书的应用程序）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-10T03:09:44.927

我知道在 Linux 中为 iPhone 进行开发的唯一方法是安装 Vmware 并努力让 OS X 在虚拟机中运行。话虽如此，这样做存在一些“法律”问题。据报道，OS X Server 可以虚拟化，但至于开发故事我不知道。

如果你真的是认真的，那就是我要调查的。

祝你好运。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-08-21T14:07:19.397

您可能能够在最终会在 iPhone 或 iPad 上找到自己的 Linux 机器上编写代码，但最终您需要一台 Mac 来测试或将代码部署到 iPhone 或将其提交到 App Store。所以最终你需要一台 Mac，所以你也可以在 Mac 上使用 Apple 提供的所有工具来完成工作。有 Xcode 和 Objective-C 的替代品，例如 Monotouch - 但这些也使用 Apple 工具。

您可以通过一些工作在 Linux 上的 VM 中运行 OS X。但是我应该指出，即使您购买了 OSX 的副本，这也会违反 OSX 许可协议——因为它仅被许可在 Apple 硬件上运行。

很抱歉给你这个消息 - iPhone/iPad 周围的生态系统受到非常严格的控制。

编辑：一个主要的例外是为 iPhone 编写一个网络应用程序。iPhone 有一些出色的网络应用程序，它们的用户体验几乎与原生应用程序一样好。但是，我确实将您的问题解释为与本机应用程序开发有关。Web 应用程序，尽管用户可以创建一个图标来启动它们——仍然是“二等”公民。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-02-24T13:16:24.727

您可以使用[Tersus](http://www.tersus.com/#Id=3215)（开源），它允许您将应用程序导出为 Xcode 项目。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-04-03T20:43:16.250

我已经使用[cjacker 的 iOS clang 工具链](http://code.google.com/p/ios-toolchain-based-on-clang-for-linux/)在 linux 上成功构建了 iOS 应用程序。基本上，它包括来自您的 linux 发行版的上游 clang 和 llvm 工具、苹果链接器的 linux 端口以及一些有助于简化构建过程的额外工具（例如将 xcode 项目转换为 Makefile 格式）。

安装确实需要几个步骤，但是您是软件开发人员，因此您会习惯的。我在网上发布了 Debian 7 (Wheezy) 的最新操作指南：

[https://rogerkeays.com/how-to-build-an-ios-toolchain-for-linux-debian-7](https://rogerkeays.com/how-to-build-an-ios-toolchain-for-linux-debian-7)

否则，您想使用稍旧的通用指令：

[http://code.google.com/p/ios-toolchain-based-on-clang-for-linux/wiki/HowTo_en](http://code.google.com/p/ios-toolchain-based-on-clang-for-linux/wiki/HowTo_en)

祝你好运。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-08-28T09:58:01.450

有一个名为[Rhodes](http://rhomobile.com/)的框架。

该概念基于 Ruby on Rails，您可以使用 Ruby 和 HTML 开发移动应用程序，并且可以在 Linux 环境中编写代码。[然后，您可以在Rhhub](http://www.rhohub.com/)创建一个帐户，在其中添加代码（通过[GitHub](https://github.com/)），它允许您为 iPhone、Blackberry、Android、Windows Mobile 和 Symbian 编译它，所有这些都使用相同的代码。您不必为 iPhone 编写 Objective-C 代码，也不必为 Android 编写 Java 等。它会为您完成转换。您需要做的就是遵守创建 iPhone 应用程序（或您要为其开发的手机）的规则，以便它可以在 iTunes（或同等市场）上被接受。

这也将允许您将应用程序添加到 iTunes。

但是，我没有找到任何模拟器，这意味着要测试您的应用程序，您需要将其放在 iPhone 上，这是一项任务。

我正在使用此选项，因为我想为所有手机创建应用程序，并且我已经使用 Ruby on Rails。如果您只想为 iPhone 制作应用程序，那么请购买 Mac。

希望这可以帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-04-07T07:05:16.700

你需要为它获得mac。有几个可用的工具链（如 win-chain）实际上可以让您在 Windows 上编写和构建 i Phone 应用程序。有几个相关的教程可以在 Windows 上构建 Objective C 代码。但是有一个问题，因此开发的应用程序只能在越狱的 i 手机上运行。

我们已经看到很少有黑客可以克服这一点并进入 App Store，但随着 Apple 不断更新 SDK，工具链需要定期更新。一直编起来很麻烦。如果您想准备好应用程序，您还可以以合理的价格从 arcapps 的启动应用程序中获得帮助。 [iphone应用程序开发](http://www.arcapps.com)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-21T22:58:15.627

You're right non-jailbroken phones are limited to Apple's App store and Apple "has the right" to enforce whatever rule, it's totally nonfree territory. However while developing, one won't have to deal with Apple at all. You can use e.g. rsync to upload the code to the device and test it.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-08-21T14:09:18.300

在某种程度上，是的，这是可能的。您可以键入 Objective-C 代码并设置您的项目。您甚至可以使用 gcc 测试代码的 C 和 C++ 部分。

你不能做什么：

*   使用 Interface Builder 设置您的界面，因为它仅适用于 Mac。（不是必需的，但推荐。）
*   编译使用 Apple 的 Cocoa 类的代码——它们在 Linux 上不存在。
*   在模拟器中测试代码 - 没有适用于 Linux 的代码。
*   为真实设备或 App Store 编译代码——所有这些都需要 Apple 仅为 OS X 提供的工具。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-02-04T17:19:00.037

我尝试将 cocos2d-iphone 移植到 GNUstep，以便您可以基于 cocos2d*开发游戏。*但是，要发布，您需要一个 mac。[cocos2d-GNUstep](https://github.com/ANindie/cocos2d-GNUstep) .

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-08-21T14:19:51.817

我会推荐使用 mac，因为 ios 模拟器非常适合在应用程序的早期阶段进行测试。但我确实知道与我们合作的一家小公司使用 Unity 进行开发，因此他们不需要大量的 mac。这样他们办公室只需要一台mac，而这只是为了编译最终版本。这也意味着它可以在 android 上运行，但它真的取决于你的建筑，因为它是一个游戏引擎。您可能希望使用 Sencha Touch Mobile 等框架研究 Web 应用程序

Unity：[http](http://unity3d.com/) : //unity3d.com/ Sencha Touch：[http ://www.sencha.com/products/touch/](http://www.sencha.com/products/touch/)

* * *

## 回答 #16

> 赞同：-6
> 
> 时间：2008-11-27T08:19:43.803

如果您的应用程序不是使用 Xcode 开发的，那么您将永远无法获得 Apple 的批准。绝不。而且，如果您确实破解了 SDK 以在 Linux 上进行开发，而 Apple 发现了，那么当您得到服务时不要感到惊讶。我是 ADC 和 iPhone 开发者计划的成员。相信，Apple 对此非常认真。

不要冒险，购买 Macbook 或 Mac mini（是的，mini 可以运行 Xcode——虽然速度很慢——如果你使用 mini，可以增加 RAM）。此外，虽然我看到 OS X 被黑以在 VMware 上运行，但我从未见过有人在 VM 上运行 Xcode。祝你好运。在您遇到麻烦之前，我会检查 EULA。

PS：阅读以上内容后，是的，我同意如果您确实破解了 SDK 并在 Linux 上开发，至少在 Mac 上进行最终打包。并通过 Mac 提交。苹果没有逐行运行代码，所以我怀疑他们会抓住这一点。但是，伙计，这是很多假设和工作。做起来很有趣。:)

* * *

## 回答 #17

> 赞同：-6
> 
> 时间：2009-07-13T23:08:37.163

如果您珍惜时间，请购买 Mac！我对 Linux 开发选项了解不多，无法提供可行的解决方案，但建议的方法似乎涉及一些相当迂回的工作。如果您打算认真编写和销售 iPhone 应用程序，我认为您可以轻松收回 Mac Mini 或 Macbook 的成本。:-)

# sharepoint - 为面向公众的 SharePoint 网站设计拓扑

> ID：276908
> 
> 赞同：2
> 
> 时间：2008-11-10T02:26:09.007
> 
> 标签：sharepoint, authentication, collections

我目前正在计划将 Microsoft 内容管理服务器 (MCMS) 网站迁移到 SharePoint 2007 发布网站。

顶级网站是一个面向公众的匿名访问网站。它将包含两个需要使用基于表单的身份验证来保护的区域——每个区域都有一组不同的用户。

当前 MCMS 站点中的内容使用“连接的帖子”，即能够在多个地方使用内容而无需复制内容。在 SharePoint 中，可重用内容列表支持类似的概念，但这并不跨越网站集。

我在想这应该是一个包含三个网站集的 Web 应用程序。1个用于面向公众的站点，其他用于两个保护区。但是，我不确定 1 个网站集是否可以是匿名的，而其他 2 个网站集实施不同的 FBA 身份验证提供程序。

我希望我的网址是这样的：

www.whatever.com
www.whatever.com/protectedarea1
www.whatever.com/protectedarea2

如果没有 Url 重写，这对于单独的 Web 应用程序将很难做到。

如果我最终不得不使用 3 个单独的 Web 应用程序以使身份验证按要求工作，我可能必须在内容部署方面发挥创意，以免在创作过程中复制内容。

任何想法将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T10:25:26.760

不要做 MCMS，所以不能具体回答，请参阅[http://www.andrewconnell.com/blog/](http://www.andrewconnell.com/blog/)了解很多信息。

Microsoft 有许多不同的外联网设计，[http](http://technet.microsoft.com/en-us/library/cc263513.aspx) ://technet.microsoft.com/en-us/library/cc263513.aspx取决于您的需要。您可以按照您的描述进行设置，表单有点弱，它们是 CodePlex 上可用的更好版本。

对于 URL，Sharepoint 有一个名为“Manged Paths”的功能，可以满足您的需求。无需 URL 重写。

我们的设置是用于外部网和内部的网站集，大部分工作都在其中完成。完成后，他们可以将其发布（确实制作额外的副本）到公共站点。一些公共网站仅发布与非帐户人员没有互动的网站，有些是他们实际上完成大部分工作且非帐户人员可以做出贡献的网站。所有都在 MOSS 下可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T19:58:10.973

谢谢，在考虑将创作环境与发布环境分开时，该外联网链接将很有帮助。

我试图在同一个 Web 应用程序中的两个网站集上实现两个 FBA 会员提供程序。看起来我做不到，我会尝试使用具有不同角色的同一个会员提供者。

# java - 如何测试一个数组是否包含一对乘积为奇数的数字？

> ID：276909
> 
> 赞同：1
> 
> 时间：2008-11-10T02:26:14.327
> 
> 标签：java, algorithm, integer

如果存在一对乘积为奇数的数字，我如何编写一个接受整数数组并返回 true 的函数？

奇数的性质是什么？当然，你如何用 Java 编写这个函数？另外，也许是对您如何为实际实现制定算法的简短解释。

是的，这是教科书中的一个功能。不，这不是家庭作业——我只是想学习，所以请不要“做你自己的家庭作业评论”。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-10T02:30:27.890

奇数不能被二整除。您只需要知道集合中有两个奇数。只需检查每个数字 mod 2 是否非零。如果是这样，那就奇怪了。如果你找到两个奇数，那么你可以将它们相乘并得到另一个奇数。

注意：奇数乘以偶数总是偶数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-10T02:30:39.280

*只有*当两个整数都是奇数时，两个整数的乘积才会是奇数。所以，要解决这个问题，只需扫描一次数组，看看是否有两个（或更多）奇数。

**编辑：** 正如其他人所提到的，您可以使用模数 (%) 运算符检查数字是否为奇数。如果 N % 2 == 0，那么这个数是偶数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-10T02:32:58.213

值得思考的属性：

*   奇数不能被 2 整除
*   任何数乘以偶数都是偶数

因此，您可以将问题重新陈述为：

> 该数组是否包含至少两个不能被 2 整除的整数？

这应该让事情变得更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T02:32:37.263

您可以使用模数测试均匀性（或奇数）。

i % 2 = 0 如果 i 是偶数；测试一下，你可以找出一个数字是偶数/奇数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T04:18:30.497

蛮力算法：

```
public static boolean hasAtLeastTwoOdds(int[] args) {
    int[] target = args; // make defensive copy
    int oddsFound;
    int numberOddsSought = 2;

    for (int i = 0; i < target.length; i++) {
        if (target[i] % 2 != 0) {
            if (oddsFound== numberOddsSought) {
                return true;
            }
            oddsFound++;
        }
    }

    return false;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T19:04:24.280

感谢您的回答和评论。

我现在很好地理解了如何测试整数是否为奇数。例如，此方法是一种无需使用乘法、取模或除法运算符的简洁方法：

```
 protected boolean isOdd(int i) {
    return ( (i&1) == 1);

} 
```

在您的帮助下，我现在意识到问题比我预期的要简单得多。这是我在 Java 中实现的其余部分。欢迎评论和批评。

```
protected boolean isOddProduct(int[] arr) {
        int oddCount = 0;
        if (arr.length < 2) 
            throw new IllegalArgumentException();
        for (int i = 0; i <= arr.length-1; i++) {
            if (isOdd(arr[i]))
                oddCount++; 
        }
        return oddCount > 1;
    } 
```

我想知道是否还有其他方法可以在不使用 *、% 或 / 运算符的情况下执行此测试？也许我会在一个新线程中问这个问题。

# .net - 单击一次 - 所有用户

> ID：276916
> 
> 赞同：21
> 
> 时间：2008-11-10T02:28:58.893
> 
> 标签：.net, windows-installer, clickonce

如何配置单击一次以为所有用户安装应用程序。在另一个论坛上，我必须“使用 MSI” - 谢谢 - 但如何。此外，第一个安装用户可能不是管理员 - 这可能是一个问题。我希望所有用户都触发更新检查。没有本地存储，它是 WCF 服务的 WPF 客户端。

我们是 XP，内部。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-10T03:24:47.813

ClickOnce 无法按照您的想法安装，因为它只是一个 URL ( [http://server/myapp/myapp.application](http://server/myapp/myapp.application) )。因此，如果您可以让用户点击 URL，那么您就完成了同样的事情。这就是我们所做的，而且效果非常好。

我们在一家大型企业中管理着 5,000 个桌面，我们为在所有机器上安装应用程序所做的工作是创建一个简单的 MSI 文件，在桌面上放置一个图标（您可以将其放在开始菜单或我猜的任何内容中）。该图标具有标准的应用程序图标，只是一个指向 URL 的链接图标。

当用户单击图标时，它会启动应用程序并安装，因此所有自动更新也会下降。

现在这对我们有用，因为我们有非常好的企业管理软件能够将 MSI 部署到企业。我不知道你的情况，所以我不知道这是否有效。

构建完整应用程序的 MSI 违背了自动更新和 ClickOnce 提供的东西的目的。构建 MSI 以在机器上放置图标很简单，只需安装一次。

如果您需要任何帮助或对此有疑问，请给我发电子邮件，我很容易找到，只需查看我的博客即可。

希望有帮助。

-基思

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-29T23:11:30.833

如果您需要为 PC 上的所有用户安装/升级，Clickonce 不是一个选项。Clickonce 旨在为没有管理权限的单个用户安装应用程序。

您将需要创建一个 MSI 安装程序来将应用程序分发给同一台计算机上的多个用户。当客户端没有管理权限时，有多种方法可以在客户端上部署和更新应用程序。几个例子：

*   在 Active Directory 中宣传您的 MSI，安装和升级不需要管理权限。
*   使用 System Center Update Publisher (SCUP) 将应用程序发布到 Windows Server Update Services (WSUS)。使用 WSUS，您可以部署 Microsoft 更新和您的应用程序。WSUS 和 SCUP 均可免费下载。
*   使用组策略来提升安装程序（不是推荐的解决方案！），以使非管理员能够为所有用户安装 MSI

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T02:31:12.007

查看 WIX [http://wix.sourceforge.net/](http://wix.sourceforge.net/)

# c# - .Net 是否有内存缓存端口？

> ID：276924
> 
> 赞同：25
> 
> 时间：2008-11-10T02:32:37.760
> 
> 标签：c#, asp.net, windows, memcached

如果有用于服务器实现的端口，我很感兴趣。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-10T02:35:40.003

Windows 服务器端口：

*   [用于 Win32 的内存缓存](http://www.splinedancer.com/memcached-win32/)
*   [Jellycan 代码 - memcached](http://code.jellycan.com/memcached/)

Memcached .NET 客户端端口：

*   [内存缓存点网](http://sourceforge.net/projects/memcacheddotnet/)
*   [enyim.com Memcached 客户端](https://github.com/enyim/EnyimMemcached)
*   [贝特](http://code.google.com/p/beitmemcached/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-03-06T09:58:31.430

没有对 windows 构建的官方支持。检查此链接：[https ://github.com/memcached/memcached/wiki/Install](https://github.com/memcached/memcached/wiki/Install)

对于客户端，请查看此链接：[https ://github.com/memcached/memcached/wiki/Clients](https://github.com/memcached/memcached/wiki/Clients)

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T13:24:24.310

而且您可能还想检查[indeXus.net](http://www.sharedcache.com/cms/)是在 c# (服务器和 api) 中实现的

我们也使用 BeIt 作为 memcached 客户端端口，因为我们遇到了 enyim 问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T08:52:06.610

[在Codeplex](http://www.codeplex.com/)上发现了[很棒的端口](http://www.codeplex.com/memcachedproviders):) 看看吧！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-13T15:30:40.897

如果您对在 Windows 上运行 memcached 客户端感兴趣，那么还有两个额外的开源服务器可以完成这项工作。两者都实现了标准的 memcached 服务器协议，并且都是用 Java 编写的，因此它们可以在 Windows 上运行。

*   [jmemcached](http://code.google.com/p/jmemcache-daemon/)
*   [快速缓存](http://code.google.com/p/quickcached/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T02:54:11.040

您可能想查看我们的[Velocity](http://blogs.msdn.com/velocity/) - Microsoft 的分布式缓存。

# mysql - 我可以将多个 MySQL 行连接到一个字段中吗？

> ID：276927
> 
> 赞同：1391
> 
> 时间：2008-11-10T02:34:26.463
> 
> 标签：mysql, sql, concat, group-concat

使用`MySQL`，我可以执行以下操作：

```
SELECT hobbies FROM peoples_hobbies WHERE person_id = 5; 
```

**我的输出：**

```
shopping
fishing
coding 
```

但我只想要 1 行，1 列：

**预期输出：**

```
shopping, fishing, coding 
```

原因是我从多个表中选择多个值，并且在所有连接之后，我得到的行数比我想要的多得多。

我在[MySQL Doc](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)上寻找了一个函数，它看起来不像`CONCAT`or`CONCAT_WS`函数接受结果集。

那么这里有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1975
> 
> 时间：2008-11-10T02:48:11.677

您可以使用[`GROUP_CONCAT`](https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_group-concat)：

```
SELECT person_id,
   GROUP_CONCAT(hobbies SEPARATOR ', ')
FROM peoples_hobbies
GROUP BY person_id; 
```

正如路德维希在[他的评论中所说，](https://stackoverflow.com/questions/276927/can-i-concatenate-multiple-mysql-rows-into-one-field#comment14513101_276949)您可以添加`DISTINCT`运算符以避免重复：

```
SELECT person_id,
   GROUP_CONCAT(DISTINCT hobbies SEPARATOR ', ')
FROM peoples_hobbies
GROUP BY person_id; 
```

正如 Jan 在[他们的评论中所说，](https://stackoverflow.com/questions/276927/can-i-concatenate-multiple-mysql-rows-into-one-field#comment72475644_276949)您还可以在使用以下方法对值进行排序之前对其进行排序`ORDER BY`：

```
SELECT person_id, 
       GROUP_CONCAT(hobbies ORDER BY hobbies ASC SEPARATOR ', ')
FROM peoples_hobbies
GROUP BY person_id; 
```

正如 Dag 在[他的评论中所说，](https://stackoverflow.com/questions/276927/can-i-concatenate-multiple-mysql-rows-into-one-field/276949#comment12638055_276949)结果有 1024 字节的限制。要解决此问题，请在查询之前运行此查询：

```
SET group_concat_max_len = 2048; 
```

当然，您可以`2048`根据自己的需要进行更改。要计算和分配值：

```
SET group_concat_max_len = CAST(
                     (SELECT SUM(LENGTH(hobbies)) + COUNT(*) * LENGTH(', ')
                           FROM peoples_hobbies
                           GROUP BY person_id) AS UNSIGNED); 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2008-11-10T02:48:54.560

看看`GROUP_CONCAT`你的 MySQL 版本 (4.1) 是否支持它。有关更多详细信息，请参阅[文档](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。

它看起来像：

```
 SELECT GROUP_CONCAT(hobbies SEPARATOR ', ') 
  FROM peoples_hobbies 
  WHERE person_id = 5 
  GROUP BY 'all'; 
```

* * *

## 回答 #3

> 赞同：84
> 
> 时间：2014-09-23T20:26:46.890

# 连接*多个单独行的替代语法*

*警告：这篇文章会让你感到饥饿。*

## 鉴于：

我发现自己想要**选择多个单独的行**——而不是一个组——并在某个字段上连接。

假设您有一张包含产品 ID 及其名称和价格的表格：

```
+------------+--------------------+-------+
| product_id | name               | price |
+------------+--------------------+-------+
|         13 | Double Double      |     5 |
|         14 | Neapolitan Shake   |     2 |
|         15 | Animal Style Fries |     3 |
|         16 | Root Beer          |     2 |
|         17 | Lame T-Shirt       |    15 |
+------------+--------------------+-------+ 
```

然后你有一些花哨的 ajax 将这些小狗列为复选框。

您的饥饿河马用户选择`13, 15, 16`. 今天没有给她甜点...

## 寻找：

一种使用纯 mysql 在一行中总结用户订单的方法。

## 解决方案：

`GROUP_CONCAT`与[子句](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#function_in)一起使用[：`IN`](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#function_in)

```
mysql> SELECT GROUP_CONCAT(name SEPARATOR ' + ') AS order_summary FROM product WHERE product_id IN (13, 15, 16); 
```

哪个输出：

```
+------------------------------------------------+
| order_summary                                  |
+------------------------------------------------+
| Double Double + Animal Style Fries + Root Beer |
+------------------------------------------------+ 
```

## 奖金解决方案：

如果您也想要总价，请输入[`SUM()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_sum)：

```
mysql> SELECT GROUP_CONCAT(name SEPARATOR ' + ') AS order_summary, SUM(price) AS total FROM product WHERE product_id IN (13, 15, 16);
+------------------------------------------------+-------+
| order_summary                                  | total |
+------------------------------------------------+-------+
| Double Double + Animal Style Fries + Root Beer |    10 |
+------------------------------------------------+-------+ 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2010-04-08T11:32:55.043

`GROUP_CONCAT`您可以通过设置`group_concat_max_len`参数来更改值的最大长度。

请参阅[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)中的详细信息。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-11-10T02:48:38.227

有一个 GROUP 聚合函数[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2014-06-10T09:24:31.350

就我而言，我有一排 Id，必须将其转换为 char，否则，结果将被编码为二进制格式：

```
SELECT CAST(GROUP_CONCAT(field SEPARATOR ',') AS CHAR) FROM table 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-09-27T18:47:25.257

使用 MySQL(5.6.13) 会话变量和赋值运算符，如下所示

```
SELECT @logmsg := CONCAT_ws(',',@logmsg,items) FROM temp_SplitFields a; 
```

那么你可以得到

```
test1,test11 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2015-04-29T16:35:34.430

我有一个更复杂的查询，发现我必须`GROUP_CONCAT`在外部查询中使用才能让它工作：

## 原始查询：

```
SELECT DISTINCT userID 
FROM event GROUP BY userID 
HAVING count(distinct(cohort))=2); 
```

## 内爆：

```
SELECT GROUP_CONCAT(sub.userID SEPARATOR ', ') 
FROM (SELECT DISTINCT userID FROM event 
GROUP BY userID HAVING count(distinct(cohort))=2) as sub; 
```

希望这可能对某人有所帮助。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2019-04-26T09:26:01.907

对于在这里查看如何使用`GROUP_CONCAT`子查询的人-发布此示例

```
SELECT i.*,
(SELECT GROUP_CONCAT(userid) FROM favourites f WHERE f.itemid = i.id) AS idlist
FROM items i
WHERE i.id = $someid 
```

所以`GROUP_CONCAT`必须在子查询中使用，而不是包装它。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-02-26T15:25:38.097

试试这个：

```
DECLARE @Hobbies NVARCHAR(200) = ' '

SELECT @Hobbies = @Hobbies + hobbies + ',' FROM peoples_hobbies WHERE person_id = 5; 
```

TL;博士;

```
set @sql='';
set @result='';
set @separator=' union \r\n';
SELECT 
@sql:=concat('select ''',INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME  ,''' as col_name,',
INFORMATION_SCHEMA.COLUMNS.CHARACTER_MAXIMUM_LENGTH ,' as def_len ,' ,
'MAX(CHAR_LENGTH(',INFORMATION_SCHEMA.COLUMNS.COLUMN_NAME , '))as  max_char_len',
' FROM ',
INFORMATION_SCHEMA.COLUMNS.TABLE_NAME
) as sql_piece, if(@result:=if(@result='',@sql,concat(@result,@separator,@sql)),'','') as dummy
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE 
INFORMATION_SCHEMA.COLUMNS.DATA_TYPE like '%char%'
and INFORMATION_SCHEMA.COLUMNS.TABLE_SCHEMA='xxx' 
and INFORMATION_SCHEMA.COLUMNS.TABLE_NAME='yyy';
select @result; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-11-13T13:37:54.953

我们有两种方法来连接 MySql 中的列

```
select concat(hobbies) as `Hobbies` from people_hobbies where 1 
```

或者

```
select group_concat(hobbies) as `Hobbies` from people_hobbies where 1 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-13T06:21:25.790

已经很晚了，但对于那些正在搜索“使用数据透视表将多个 MySQL 行连接到一个字段”的人会有所帮助:)

询问：

```
SELECT pm.id, pm.name, GROUP_CONCAT(c.name) as channel_names
FROM payment_methods pm
LEFT JOIN payment_methods_channels_pivot pmcp ON pmcp.payment_method_id = pm.id
LEFT JOIN channels c ON c.id = pmcp.channel_id
GROUP BY pm.id 
```

表

```
payment_methods 
  id  | name
  1   | PayPal

channels
  id  | name
  1   | Google
  2   | Faceook

payment_methods_channels_pivot
   payment_method_id | channel_id
   1                 |  1
   1                 |  2 
```

输出：

[![在此处输入图像描述](https://i.stack.imgur.com/TCxjv.png)](https://i.stack.imgur.com/TCxjv.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-13T17:48:18.787

在 sql server 中使用 string_agg 将行字段值转换为列：

```
select string_agg(field1, ', ') a FROM mytable 

or

select string_agg(field1, ', ') within group (order by field1 dsc) a FROM mytable group by field2 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-11-08T19:04:38.767

在这里，我的意图是在不使用 group_concat() 函数的情况下应用字符串连接：

```
Set @concatHobbies = '';
SELECT TRIM(LEADING ', ' FROM T.hobbies ) FROM 
(
   select 
   Id, @concatHobbies := concat_ws(', ',@concatHobbies,hobbies) as hobbies
   from peoples_hobbies
)T
Order by Id DESC
LIMIT 1 
```

这里

```
 select 
   Id, @concatHobbies := concat_ws(', ',@concatHobbies,hobbies) as hobbies
   from peoples_hobbies 
```

将返回

```
 Id    hobbies
  1     , shopping
  2     , shopping, fishing
  3     , shopping, fishing, coding 
```

现在我们的预期结果排在第三位。所以我使用最后一行

```
 Order by Id DESC 
  LIMIT 1 
```

然后我还要从我的字符串中删除第一个'，'

```
 TRIM(LEADING ', ' FROM T.hobbies ) 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-10-04T09:29:34.020

在这种情况下另一个有趣的例子 -

以下是示例表的结构`people_hobbies`-

```
DESCRIBE people_hobbies;
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| id      | int unsigned | NO   | PRI | NULL    | auto_increment |
| ppl_id  | int unsigned | YES  | MUL | NULL    |                |
| name    | varchar(200) | YES  |     | NULL    |                |
| hby_id  | int unsigned | YES  | MUL | NULL    |                |
| hobbies | varchar(50)  | YES  |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+ 
```

该表填充如下 -

```
SELECT * FROM people_hobbies;
+----+--------+-----------------+--------+-----------+
| id | ppl_id | name            | hby_id | hobbies   |
+----+--------+-----------------+--------+-----------+
|  1 |      1 | Shriya Jain     |      1 | reading   |
|  2 |      4 | Shirley Setia   |      4 | coding    |
|  3 |      2 | Varsha Tripathi |      7 | gardening |
|  4 |      3 | Diya Ghosh      |      2 | fishing   |
|  5 |      4 | Shirley Setia   |      3 | gaming    |
|  6 |      1 | Shriya Jain     |      6 | cycling   |
|  7 |      2 | Varsha Tripathi |      1 | reading   |
|  8 |      3 | Diya Ghosh      |      5 | shopping  |
|  9 |      3 | Diya Ghosh      |      4 | coding    |
| 10 |      4 | Shirley Setia   |      1 | reading   |
| 11 |      1 | Shriya Jain     |      4 | coding    |
| 12 |      1 | Shriya Jain     |      3 | gaming    |
| 13 |      4 | Shirley Setia   |      2 | fishing   |
| 14 |      4 | Shirley Setia   |      7 | gardening |
| 15 |      2 | Varsha Tripathi |      3 | gaming    |
| 16 |      2 | Varsha Tripathi |      2 | fishing   |
| 17 |      1 | Shriya Jain     |      5 | shopping  |
| 18 |      1 | Shriya Jain     |      7 | gardening |
| 19 |      3 | Diya Ghosh      |      1 | reading   |
| 20 |      4 | Shirley Setia   |      5 | shopping  |
+----+--------+-----------------+--------+-----------+ 
```

现在，`hobby_list`生成了一个表格，其中包含所有人的列表和每个人的爱好列表，每个爱好在一个新行中 -

```
CREATE TABLE hobby_list AS
    -> SELECT ppl_id, name,
    -> GROUP_CONCAT(hobbies ORDER BY hby_id SEPARATOR "\n")
    -> AS hobbies
    -> FROM people_hobbies
    -> GROUP BY ppl_id
    -> ORDER BY ppl_id; 
```

```
SELECT * FROM hobby_list; 
```

[![CONCAT_GROUP()](https://i.stack.imgur.com/yBqzm.png)](https://i.stack.imgur.com/yBqzm.png)

# grails - 是否有可供学习的优秀 Grails 示例应用程序？

> ID：276928
> 
> 赞同：26
> 
> 时间：2008-11-10T02:35:13.747
> 
> 标签：grails

*除了《 Groovy 和 Grails*入门》和*《Grails 权威指南》*一书中介绍的示例应用程序之外，还有哪些用 Grails 编写的应用程序可以作为学习最佳实践的好例子吗？例如开源的真实应用程序？谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-10T04:32:56.740

在我的学习阶段，我遇到了几个很好的示例应用程序。

这个示例网络相册应用程序让我开始使用 grails。它涵盖了安全性、图像上传/操作、基本的 crud 等。

[http://www.syger.it/Tutorials/GrailsWebAlbum.html](http://www.syger.it/Tutorials/GrailsWebAlbum.html)

这是即将出版的《Grails in Action》一书的作者 Glen Smith 的一篇。groovy 博客聚合器的源代码位于此处：

[http://code.google.com/p/groovyblogs/](http://code.google.com/p/groovyblogs/)

这是 Glen 的另一个，一个用 grails 编写的博客引擎：

[http://code.google.com/p/gravl/](http://code.google.com/p/gravl/)

最后，这是 grails.org 站点的代码，其中包含 wiki 功能：

[http://github.com/grails/grails/tree/master/grails-samples/grails.org/](http://github.com/grails/grails/tree/master/grails-samples/grails.org/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-10T02:41:52.033

是的。IBM 在 IBM 的 developerworks 站点上有一系列基于示例应用程序的优秀文章：

第一部分：
[http ://www.ibm.com/developerworks/java/library/j-grails01158/](http://www.ibm.com/developerworks/java/library/j-grails01158/)

系列： [http ://www.ibm.com/developerworks/views/java/libraryview.jsp?search_by=mastering+grails](http://www.ibm.com/developerworks/views/java/libraryview.jsp?search_by=mastering+grails)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-11T02:34:04.497

如果您有兴趣查看一个预构建的应用程序，该应用程序还包含 Grails 特定的测试实践和方法（以及 Grails 中使用的一些广泛实践的测试方法），Winelovers 应用程序概述了一个完全工作的应用程序和一些不同的测试角度可用于为您的应用创建信心并增加测试覆盖率。

[https://svn.energydwork.com/skunkworks/grails/WineLovers/](https://svn.energizedwork.com/skunkworks/grails/WineLovers/)

还有一个伴随此的[演示文稿](http://docs.google.com/Presentation?id=dgb5cmdc_8jgvfzdd3)，其中介绍了示例和优缺点。

我将通过更多示例和进一步的教程类型更新来跟进这项工作，以帮助得出以这种方式进行测试的好处。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-11-09T23:08:38.937

我将 Stephane 的新应用程序添加到列表中：

> Stephane Maldini ✆ 向用户展示详细信息 10 月 21 日 大家好，
> 
> 我很高兴地宣布发布了一个相对较大的 grails 应用程序，名为 iceScrum (http://www.icescrum.org/demo)。[核心视图/设计 ( http://github.com/icescrum/iceScrum](http://github.com/icescrum/iceScrum) )的代码混合了 Apache Licence2、LGPL 和 AGPL 。
> 
> 您可以在此示例中看到什么（以及如果您想重用后面的视图标签库（140 个和更多标签）
> 
> *   Jquery 小部件：表格、Postits、Windows、小部件、可排序菜单栏、拖放、快捷键......
>     
>     
> *   使用 ICEpush 实时推送 jquery
>     
>     
> *   活动插件（“有人做了某事”）
> *   视图的 AJAX 范例（网址为[http://app/project/#view/action/id](http://app/project/#view/action/id)），如 GMAIL，完全支持历史记录。
> *   SpringSecurity ACL、Springcache、Resources插件等的应用
> *   控制器上的 Window/Widget 范式只需添加 static ui = true （使用icescrum Web Component 里面的插件） 到时候单独发布
> *   贾斯珀集成
> *   Jquery 图表集成
> *   很多很多东西都需要大量的文档，此时你将不得不自己探索一些部分。
> 
> 该应用程序的目的是为敏捷团队提供一个工具来共享仪表板（用于协作顾问等）、报告、故事、跟踪错误等。它将拥有自己的进化+一些专业服务，以便通过插件或简单地托管更好地集成到 IT 中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-24T00:29:49.647

...你看过 weceem 吗？ [http://www.weceem.org/weceem/](http://www.weceem.org/weceem/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-10T02:43:30.733

一个非常好的构建示例应用程序的系列：[http ://www.ibm.com/developerworks/views/java/libraryview.jsp?search_by=mastering+grails](http://www.ibm.com/developerworks/views/java/libraryview.jsp?search_by=mastering+grails)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-13T22:38:44.620

我第二次提到 Ray Tayek 提到的 IBM 系列，以及提到的 energetablework.com 示例。后者是我编写经过良好测试的代码的参考手册，没有它我就活不下去。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-25T20:11:35.410

来自 Paolo Foletto 的新 (Grails 2.0) GEvents 应用程序需要在此列表中。有一步一步的应用程序通向完整的应用程序。[https://github.com/pfoletto/GEvents/wiki/GrailsWorkshop](https://github.com/pfoletto/GEvents/wiki/GrailsWorkshop)

[在http://www.grailsworkshop.com/GEvents/](http://www.grailsworkshop.com/GEvents/)有一个工作版本。

# apache - 导入哪个库？

> ID：276931
> 
> 赞同：0
> 
> 时间：2008-11-10T02:37:23.120
> 
> 标签：apache, xpath, import

最近我下载了这个开源项目，我正在尝试编译它。

但是，其中一条是给我一个错误。

“导入 com.sun.org.apache.xpath.internal.functions.WrongNumberArgsException；”

似乎我错过了一个图书馆......有没有办法知道我需要哪个图书馆？

我尝试在 google 上搜索 com.sun.org.apache.xpath.internal.functions，而 kickjava.com/src 上似乎有包含源代码的结果。

我想我需要 Jar 文件，对吗？

我尝试从 apache 下载 xalan，但没有成功。我试图查看是否有 xpath 库，但我认为没有 xpath 库？搜索 xpath 将我带到 xalan。我也试过 Xerces-J-bin.2.9.1 。

谢谢！

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T02:56:24.373

Xalan 中的[WrongNumberArgsException](http://hppsys.passport.hp.com/hp_docs/xmltools/xalan_manual/apidocs/org/apache/xpath/functions/WrongNumberArgsException.html)类在`org.apache.xpath.functions`包中。使用项目中的 Xalan jar，您应该能够更改开源代码中的导入语句以使用正确的路径。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-10T15:08:59.717

开源作者（无论“这个开源项目”是什么）从 Java 6 中采用 xalan 类的 sun 导入了内部异常类。这根本不应该做！不适用于较旧的虚拟机，并且可能会与较新的虚拟机一起使用。

永远不要导入 com.sun.*！

# silverlight - 在 Silverlight 2 中更新工具提示

> ID：276947
> 
> 赞同：0
> 
> 时间：2008-11-10T02:46:52.193
> 
> 标签：silverlight, silverlight-2.0, tooltip

我在 Silverlight 2 中有一个在应用程序期间更改状态的控件。当它的状态改变时，我想更新它的工具提示。

我正在使用 ToolTipService：

```
ToolTipService.SetToolTip(ent.LayoutRoot, "FooBar"); 
```

我第一次设置工具提示时效果很好，但第二次我得到：

`"Object reference not set to an instance of an object"`从 Silverlight 内部的某个地方，我无法获得有用的堆栈跟踪/断点。

拖网会弹出一些类似的问题，但没有解决方案。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-10T03:19:06.047

发现问题 - 创建控件后您似乎无法设置工具提示。所以现在，我在控件构造函数中设置了 ToolTip，然后当它需要更新时，对 SetToolTop() 的调用就可以正常工作了。

# java - Java中的扫描仪可以从对话框中读取文本吗

> ID：276955
> 
> 赞同：5
> 
> 时间：2008-11-10T02:50:56.057
> 
> 标签：java, java.util.scanner

扫描仪只能从系统控制台获取输入？无法从任何对话窗口获取？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-10T03:00:40.683

[Scanner](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)可以从任何实现[Readable](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Readable.html)接口 的对象中读取文本。

这包括`BufferedReader`, `CharArrayReader`, `CharBuffer`, `FileReader`, `FilterReader`, `InputStreamReader`, `LineNumberReader`, `PipedReader`, `PushbackReader`, 和`StringReader`（来自`Readable`javadoc）。不幸的是，这不包括任何对话窗口。

将对话框窗口挂接到 a 的最简单方法`Scanner`可能是`Scanner`使用带有 a 的构造函数构建 a `String`，将用户输入从对话框直接传递到`Scanner`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T03:04:53.423

不; 可以为任意数量的可能输入创建 Scanner：Files、InputStreams、ReadableByteChannels、Strings 以及任何支持 Readable 接口的东西[。](http://java.sun.com/javase/6/docs/api/java/util/Scanner.html)请参阅[构造函数摘要](http://java.sun.com/javase/6/docs/api/java/util/Scanner.html#constructor_summary)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-03T07:57:34.600

您可以通过首先获取文本并对其进行扫描来在对话框或标签上使用扫描仪。

```
String text = input.getText();
Scanner scan = new Scanner(text); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T09:04:59.687

好吧，我尝试使用[最佳方式中给出的示例来确定 Java 中文件的总字数？](https://stackoverflow.com/questions/277143/best-way-to-determine-the-total-number-of-words-of-a-file-in-java#277190 "扫描仪示例")：只需`new File("my-text-file.txt")`用字符串变量替换，它就可以工作......

所以如果你把组件的文本内容拿到String中，就可以使用Scanner。

# open-source - 自由软件和开源软件的区别

> ID：276957
> 
> 赞同：28
> 
> 时间：2008-11-10T02:52:47.080
> 
> 标签：open-source, licensing

有一段时间，我认为自由软件是开源软件。我发现这种观点是错误的，开源软件不一定是自由软件。老实说，我看不出任何差异。

我在这里想念什么？双方的特点是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-10T03:04:14.500

两者基本相同，只是自由软件运动更加强调修改和重新分发代码的自由。例如，GNU GPL 会比 MIT 许可证更“免费”，因为 MIT 许可证不强制执行 copyleft，因此有人可以基于代码开发闭源软件。

另请参阅[Wikipedia 关于此的章节](http://en.wikipedia.org/wiki/Open_source_software#Open_source_software_versus_free_software)，其中提到了 Microsoft 共享源倡议，它可以为您提供其应用程序的非常不自由的源代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-11-11T01:13:18.940

> 开源是一种开发方法；自由软件是一种社会运动。

*——[理查德·斯托曼](http://www.gnu.org/philosophy/open-source-misses-the-point.html)*

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-10T03:09:10.853

GNU 项目直接回答了这个问题：

[http://www.gnu.org/philosophy/free-software-for-freedom.html](http://www.gnu.org/philosophy/free-software-for-freedom.html)

本质上的区别（稍微过于简单化）是，自由软件通常要求，如果您修改和/或将其合并到另一个作品中，**整个结果也必须作为自由软件分发，**并且禁止进一步限制任何“下游”用户不得修改、使用或重新分发具有授予您相同权利的软件。

* * *

*免责声明：* 该死，吉姆，我是开发人员，而不是律师。不要将任何条款或评论解释为“法律建议”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T03:13:48.507

开源定义： http: [//opensource.org/docs/osd](http://opensource.org/docs/osd)

自由软件定义： [http ://www.gnu.org/philosophy/free-sw.html](http://www.gnu.org/philosophy/free-sw.html)

两者都在谈论言论自由。FSF 是“更自由”的，因为要满足 FSF 标准的软件，它必须为其用户提供更多自由。~~OSI 标准更宽松，“自由”软件是“开放”的，但反过来不一定是正确的~~——事实证明，即使这并不总是正确的。

*在绝大多数*情况下，它们在功能上是相同的。这是一个哲学上的差异——FSF 想要智力自由，OSI 想要（重）使用和调整软件的实际自由。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-26T16:49:01.517

这很容易理解。

某种意义上的免费资源：一旦你修改它，它是免费的，适用的免费法律也应该与世界共享相同的法律！如果有的话，它的代码也可以是我们所有人！

开源意义上的：我们可以看到我们日常使用的实际应用程序，但不能使用它，因为它是我们的，意味着我们不能修改它的代码，因为它的版权归发行商所有！

欲了解更多信息：[“免费和开源之间的区别”](http://www.javastudychannel.com/forum/2126-What-difference-between-free-source-open-source.aspx)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-08-17T06:43:00.617

免费软件是免费的小软件，但代码无法访问，可以不受限制地下载、使用、复制。

共享软件只是小型软件公司开发的完整软件的演示版本，修改和其他可用性取决于开发组。这里最终用户依赖更多。

开源软件是大型厂商经常开发的软件，可以不受任何限制地重新分发、使用和修改。这里的软件代码完全由用户访问，以供将来修改和制作大型软件。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-02-17T10:01:33.143

免费意味着用户可以自由地运行、复制、学习、分发、更改和改进软件。开源与此不同。

# vmware - 如何保持 VMWare VM 的时钟同步？

> ID：276965
> 
> 赞同：51
> 
> 时间：2008-11-10T02:58:13.420
> 
> 标签：vmware

我注意到我们的 VMWare 虚拟机上的时间通常不正确。无论我重置了多少次他们继续不同步的时间。

有没有其他人注意到这一点？其他人如何使他们的 VM 时间保持同步？

**编辑：**这些是 CLI linux VMs btw ..

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-10T15:21:18.757

如果您的主机时间正确，您可以设置以下 .vmx 配置文件选项来启用定期同步：

```
tools.syncTime = true 
```

默认情况下，这会每分钟同步一次时间。要更改周期性速率，请将以下选项设置为所需的同步时间（以秒为单位）：

```
tools.syncTime.period = 60 
```

为此，您需要在来宾操作系统中安装 VMWare 工具。

有关详细信息，请参阅[http://www.vmware.com/pdf/vmware_timekeeping.pdf](http://www.vmware.com/pdf/vmware_timekeeping.pdf)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-04-09T16:54:58.310

根据 VMware 的知识库，实际解决方案取决于 Linux 发行版和发行版，在 RHEL 5.3 中，我通常编辑 /etc/grub.conf 并将此参数附加到内核条目：divider=10 clocksource=acpi_pm

然后启用 NTP，从 vmware-toolbox 禁用 VMware 时间同步，最后重新启动 VM

可以在此处找到包含每个 Linux 发行版指南的完整表格：

为 LINUX 来宾提供的计时最佳实践 [http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1006427](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1006427)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-10T03:13:55.090

我将为 Windows 客人回答。如果您安装了 VMware Tools，则任务栏的通知区域（接近时钟）会显示一个 VMware Tools 图标。双击它并设置您的选项。

如果您没有安装 VMware Tools，您仍然可以将时钟选项设置为 Internet 时间以与某些 NTP 服务器同步。如果您的物理机器为您的来宾机器提供 NTP 协议，那么您可以通过仅主机网络来完成。否则，您将不得不让您的客人与 Internet 上的正版 NTP 服务器同步，例如 time.windows.com。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-01T17:21:36.600

这里有一点需要注意。我们在 ESXi 主机上运行的 Windows VM 遇到了同样的问题。在客户机上的 VMWare 工具中打开了时间同步，但客户机时钟始终与主机时钟保持关闭（大约 30 秒）。ESXi 主机配置为从内部时间服务器获取时间更新。

事实证明，我们在 Windows VM 中打开了 Internet 时间设置（控制面板 > 日期和时间 > Internet 时间选项卡），因此来宾从两个地方获取时间更新，并且 Internet 时间获胜。我们关闭了它，现在来宾时钟很好，完全从 ESXi 主机获取时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-05-02T17:24:35.837

在我的例子中，我们在 Windows Server 2003 R2 Standard 上运行 VMWare Server 2.02。主机也是 Windows Server 2003 R2 Standard。我安装了 VMware Tools 并设置为同步时间。我做了我在各种互联网网站上发现的所有可以想象的事情。我们仍然有可怕的漂移，尽管它已经从 15 分钟或更长时间缩短到 3 或 4 分钟的范围。

最后在 vmware.log 中，我找到了这个条目（作为 .vmx 文件位于文件夹中）：“您的主机系统不保证在不同 CPU 之间同步 TSC，因此请将 Windows Boot.ini 文件中的 /usepmtimer 选项设置为确保计时可靠。有关详细信息，请参阅 Microsoft KB [http://support.microsoft.com/kb](http://support.microsoft.com/kb) ...，有关详细信息，请参阅 Microsoft KB [http://support.microsoft.com/kb](http://support.microsoft.com/kb) ...。 ”

原因：当计算机在 BIOS 或某些 Intel 多核处理器中启用了 AMD Cool'n'Quiet 技术（AMD 双核）时，会出现此问题。当不同内核之间的时间不同步时，多核或多处理器系统可能会遇到时间戳计数器 (TSC) 漂移。使用 TSC 作为计时资源的操作系统可能会遇到此问题。如果系统中有其他可用的计时器可用作计时源，则较新的操作系统通常默认不使用 TSC。其他可用的定时器包括 PM_Timer 和高精度事件定时器 (HPET)。解决方案：要解决此问题，请与硬件供应商联系，以查看是否有新的驱动程序/固件更新可用于解决此问题。

注意驱动程序安装可能会在 Boot.ini 文件中添加 /usepmtimer 开关。

一旦这个（/usepmtimer 开关）完成，时钟就准时死了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-09-25T08:40:48.107

[该文档](http://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vmtools.install.doc%2FGUID-C0D8326A-B6E7-4E61-8470-6C173FDDF656.html)为我解决了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-10T03:11:11.210

CPU 速度因省电而异。我最初注意到这一点是因为 VMware 在我的笔记本电脑上给了我一个有用的提示，但是这个页面提到了同样的事情：

引用自：[VMWare 提示和技巧](http://maple.rsvs.ulaval.ca/mediawiki/index.php/VMWare_tips_and_tricks) 省电（SpeedStep、C-states、P-States、...）

您的省电设置可能会严重影响 vmware 的性能。有几个级别的省电。

CPU频率

这不应该导致性能下降，除了以较低频率运行 CPU 时性能明显降低（手动或通过“ondemand”或“conservative”等调控器）。在 vmware 运行时改变 CPU 速度的唯一问题是 Windows 时钟会失去时间。为防止这种情况，请在 /etc/vmware/config 中以 kHz 为单位指定您的完整 CPU 速度

主机.cpukHz = 2167000

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-10T15:01:15.440

VMware 经历了很多时钟漂移。这个[Google 搜索](http://www.google.com/search?q=vmware+clock+drift)“vmware 时钟漂移”链接到几篇文章。

第一次点击可能对您最有用：[http ://www.fjc.net/linux/linux-and-vmware-related-issues/linux-2-6-kernels-and-vmware-clock-drift-issues](http://www.fjc.net/linux/linux-and-vmware-related-issues/linux-2-6-kernels-and-vmware-clock-drift-issues)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-23T07:24:27.070

在 Windows 客户机上安装 VMware Tools 时，默认情况下不启用“时间同步”。但是——“最佳实践”是在 Windows 客户机上启用时间同步。

有几种方法可以从 VM 外部执行此操作，但我想找到一种方法来在安装工具时或之后从客户机本身启用时间同步。

令人惊讶的是，这并不像我预期的那么简单。（我认为在工具安装期间将其设置为参数/配置选项是可能的）

经过一番搜索，我在一篇名为“使用 VMware Tools 命令行界面”的 VMware 文章中找到了一种方法。

因此，如果时间同步被禁用，您可以通过在来宾中运行以下命令行来启用它：

```
 VMwareService.exe –cmd “vmx.set_option synctime 0 1″ 
```

补充笔记

由于某些（恕我直言愚蠢的）原因，此实用程序要求您指定当前值和新值

0 = 禁用 1 = 启用

所以——如果你在已经设置了这个的机器上运行这个命令，你会得到一个错误消息——“无效的旧值”。显然你可以在运行时“忽略”这个错误（所以不是什么大问题），但目前的设计似乎有点愚蠢。恕我直言，如果您可以简单地指定要设置的值而不需要指定当前值，那将更加明智。

即VMwareService.exe –cmd “vmx.set_option synctime <0|1>”</p>

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-15T15:22:15.443

在 Active Directory 环境中，了解以下内容很重要：

*   所有成员计算机与任何域控制器同步。

*   在域中，所有域控制器都从该域的 PDC 仿真器 (PDCe) 同步。

*   域的 PDC 模拟器应与本地或 NTP 同步。

在 vmware 中设置时间或配置时间同步时，请务必考虑这一点。

摘自：[http ://www.sysadmit.com/2016/12/vmware-esxi-configurar-hora.html](http://www.sysadmit.com/2016/12/vmware-esxi-configurar-hora.html)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-06-27T06:18:49.000

我将以下作业添加到 crontab。这很hacky，但我认为应该可以。

*/5 * * * * service ntpd stop && ntpdate pool.ntp.org && service ntpd start

它停止来自服务的 ntpd 服务更新并再次启动 ntpd

# c++ - 3D 场景文件格式和查看器

> ID：276976
> 
> 赞同：5
> 
> 时间：2008-11-10T03:07:01.170
> 
> 标签：c++, cross-platform, file-format, 3d, vrml

我正在寻找用于保存和查看 3D 场景（工程仿真模型和结果的可视化）的跨平台解决方案，但那里（仍然）似乎并不多。

大约 10 年前，我对此进行了研究，然后选择了 VRML（并开始了最终转向[OpenVRML](http://openvrml.org/)的项目）。不幸的是，在过去的十年里，VRML/X3D 并没有变得无处不在。

理想的解决方案是提供一个 C++ 库，该库可以插入到某个级别的 3D 渲染管道中，以将 3D 场景捕获到文件中；以及一个可自由再分发的查看器，允许查看操作、部分隐藏、注释、尺寸标注等。至少应该支持 linux、mac 和 windows。

3D PDF 似乎可以满足大多数查看器的要求，但 Adob​​e sdk 显然只能在 Windows 上使用。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T14:54:24.237

我所知道的最接近的是[Collada](http://en.wikipedia.org/wiki/Collada)。许多 3D 引擎可以读取它，大多数 3D 设计工具都可以读取和写入它。我相信[Ogre](http://http:/www.ogre3d.org)引擎有很好的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T04:04:01.337

如果您使用的是 OpenGL，[GLIntercept](http://glintercept.nutty.org/)会将所有 OpenGL 调用（连同调用它们的数据）保存到 XML 文件中。不过，这只是解决方案的一半，但解析它并自己重新创建场景应该不难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T20:15:49.940

看看 Ogre3d.org。它只是一个引擎，您必须使用它进行编程。但 OGRE 可能是目前开发 3D 的更好（免费/开放）平台。

# windows - Windows 应用程序事实上的标准键盘快捷键列表？

> ID：276977
> 
> 赞同：11
> 
> 时间：2008-11-10T03:07:09.097
> 
> 标签：windows, language-agnostic, user-interface, keyboard-shortcuts, conventions

假设我正在为 Windows 开发一个新的桌面应用程序。是否有我可以咨询（来自 Microsoft 或第 3 方）所有 Windows 应用程序都应支持的键盘快捷键的列表？

（注意：当我在这里说“所有 Windows 应用程序”时，我的真正意思是“特定键盘快捷键有意义的所有 Windows 应用程序。”例如，标准的“开始调试会话”快捷键可能在 IDE 应用程序（如 Visual Studio）中有意义和 Eclipse，但不适用于记事本或 Firefox 等其他类型的应用程序。此外，对于具有自己完整的自定义键盘快捷键集的某些专业应用程序（例如 vi）遵循遵循的一些标准约定可能没有意义由其他应用程序。）

例如，我认为在有意义的情况下，Windows 应用程序应该支持以下键盘快捷键，因为它们是大多数其他应用程序支持的事实上的标准（只是部分列表）：

**从任何地方：**

*   `F1`- 显示帮助
*   `Alt`+ `F4`- 关闭应用程序

**编辑文本时：**

*   `Ctrl`+ `A`- 选择所有文本（在当前字段中，如果适用）
*   `Ctrl`+ `Home`/ `End`- 将插入符号移动到当前字段的开始/结束
*   `Shift`+ `[any navigation]`- 在前一个插入符号位置和新插入符号位置之间选择文本

**选择可以编辑或重命名的项目时：**

*   `F2`- 重命名或编辑当前项目

**当子窗口或选项卡在多窗口/多选项卡应用程序中具有焦点时：**

*   `Ctrl`+ `F4`- 关闭当前窗口/标签
*   `Ctrl`+ `W`- 关闭当前窗口/标签
*   `Ctrl`+ `Tab`/ `Ctrl`+ `Shift`+ `Tab`- 激活下一个/上一个窗口/选项卡

等等。（同样，这些只是部分列表——我认为存在更多事实上的标准快捷方式。）

那么：对于这些类型的 Windows 应用程序事实上的标准键盘快捷键，是否有更完整的列表，开发人员可以将其用作确定正在开发的新应用程序应支持的键盘快捷键的起点？

如果也有类似的鼠标行为约定列表，那将是理想的。（例如双击左键=选择单词）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-10T03:19:00.990

[键盘用户界面设计指南](http://msdn.microsoft.com/en-us/library/ms971323.aspx#atg_keyboardshortcuts_complying_with_standard_keyboard_navigation)。它包含有关创建键盘界面的建议，并在文章的底部包含应用程序应支持的标准快捷键列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T03:18:56.640

MSDN 是你的朋友。

[http://msdn.microsoft.com/en-us/library/bb545461.aspx](http://msdn.microsoft.com/en-us/library/bb545461.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T14:48:47.507

对于 Windows 8 应用商店应用程序，MSDN 上还有另一套键盘快捷键指南：

[http://msdn.microsoft.com/en-us/library/windows/apps/hh700405.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh700405.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-23T13:13:05.180

在 1999 年的“Microsoft® Windows® 用户体验”一书中，其他答案中提到的在线指南中没有捷径。

整本书包含在 Visual Studio 2005 MSDN 库中，该库曾经可供所有人免费下载，但现在显然已从微软网站上删除。我仍然有 img 文件（从 MSDVENUCD1_X13-63639.img 到 MSDVENUCD1_X13-63642.img），但我不确定是否可以在互联网上合法地重新分发它们。

如果您在磁盘或书籍上找到便宜的报价，那么它可能仍然是值得购买的（尽管它仅适用于“经典”应用程序，当然不适用于 Windows 8 应用程序）。

# c# - ListView FocusedItem 变为 NULL

> ID：276986
> 
> 赞同：5
> 
> 时间：2008-11-10T03:15:21.810
> 
> 标签：c#, listview, selection

程序运行时，有一系列的ListView窗体。我们用项目（作为字符串）填充其中一个，并检查选择状态是否已更改。更改后，我们使用 FocusedItem.Text 获取所选项目的文本。第一次工作得很好，但是当进行另一个选择时，所选项目返回为空。

我们可以暂时解决此问题的唯一方法是清除并重新填充表单。缺点是我们丢失了突出显示的项目。必须有另一种方法来解决这个问题。也许我们不清楚 ListView 是如何工作的？

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-28T19:27:41.443

将以下条件放在 中`OnSelectedIndexHandler`：

```
if(listViewObject.SelectedItems!=null&& listViewObject.SelectedItems.Count>0)
{
   //....your code here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T10:33:49.863

如果您在用户选择的项目之后，您应该使用`SelectedItems`集合中的第一个项目。`FocusedItem`是当前具有键盘焦点的项目（因此显示虚线焦点矩形）；如果控件没有焦点，项目也没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T06:11:36.883

我已经运行了一个测试程序，没有看到 FocusedItem 可能为空的实例。

你能发布一些代码吗？

这是我选择项目“a”然后选择项目“b”然后单击空白区域后得到的结果：

```
ItemSelectionChanged
    Item         : ListViewItem: {a}
    IsSelected   : True
    SelectedItem : ListViewItem: {a}
    FocusedItem  : ListViewItem: {a}
SelectedIndexChanged
    SelectedItem : ListViewItem: {a}
    FocusedItem  : ListViewItem: {a}
ItemSelectionChanged
    Item         : ListViewItem: {a}
    IsSelected   : False
    SelectedItem : null
    FocusedItem  : ListViewItem: {a}
SelectedIndexChanged
    SelectedItem : null
    FocusedItem  : ListViewItem: {a}
ItemSelectionChanged
    Item         : ListViewItem: {b}
    IsSelected   : True
    SelectedItem : ListViewItem: {b}
    FocusedItem  : ListViewItem: {b}
SelectedIndexChanged
    SelectedItem : ListViewItem: {b}
    FocusedItem  : ListViewItem: {b}
ItemSelectionChanged
    Item         : ListViewItem: {b}
    IsSelected   : False
    SelectedItem : null
    FocusedItem  : ListViewItem: {b}
SelectedIndexChanged
    SelectedItem : null
    FocusedItem  : ListViewItem: {b} 
```

注意到它`FocusedItem`永远不会为空。

你的情况也一样吗？

一个简单的`if (listView.FocusedItem == null)`检查对你的情况有用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-18T22:16:17.123

我在使用 listview 时遇到了同样的问题。选择时触发的事件似乎存在一些问题。

1.  `SelectedIndexChanged`焦点项目、选定项目和选定索引变为空的事件。这就是上述问题的原因。
2.  `ItemActivate` 在第二次或任何其他时间焦点项目、选定项目或选定索引不为空的情况下，可以交替使用事件而不会出现任何故障。

在创建带有详细信息的列表视图时，`SelectedIndexChanged`默认情况下会触发该事件。因此，相应的 Designer 类和主类中的相关事件处理程序的更改将完成这项工作。

在设计器类中，查看订阅的事件。例子：

```
this.TaskslistView.SelectedIndexChanged
      += new System.EventHandler(TaskslistView_SelectedIndexChanged); 
```

`TaskslistView_SelectedIndexChanged`主类中存在相应的事件处理程序方法。将此事件替换为

```
this.TaskslistView.ItemActivate
      += new System.EventHandler(this.TaskslistView_ItemActivate); 
```

并将相应的替换`TaskslistView_SelectedIndexChanged`为`TaskslistView_ItemActivate`.

这应该可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-04T21:10:23.737

您可以使用 ListViewItemSelectionChangedEventHandler。

```
ListView.ItemSelectionChanged += 
new ListViewItemSelectionChangedEventHandler(ListView_ItemSelectionChanged);

private void ListView_ItemSelectionChanged(Object sender, ListViewItemSelectionChangedEventArgs e)
{
    var x = e.IsSelected;
} 
```

ListView_ItemSelectionChanged 被调用两次。您可以通过使用忽略第一个

```
if (e.IsSelected == true) 
```

编辑：试试这个：

```
ListView.Select(); 
```

# .net - 标签验证事件未触发

> ID：276987
> 
> 赞同：1
> 
> 时间：2008-11-10T03:16:27.737
> 
> 标签：.net, vb.net, validation

我希望在 VB.Net（Visual Studio 2005，.Net Runtime 2.0）的标签上使用 Validating 事件。

我有两个并排的文本框。这些用于 %/% 拆分分配，例如 80/20、50/50 等。因此，我对每个框进行了验证，以确保它们的值 >= 0 和 <= 100。我希望拥有文本框左侧的标签有自己的验证，这将确保两个文本框的值总计正好为 100。

我知道我可以在单个文本框验证事件中执行此操作。我只是不想要那种行为。我宁愿在每个文本框上都有一条离散消息，说明其内容超出了值的有效域，并且如果它们的总数不是 100，则标签上有一条错误消息。

问题是，尽管在 Label 控件上设置了 CausesValidation = True，但它们的 Validating 事件不会触发。即使在表单级别手动调用 Me.ValidateChildren() 也不会触发标签事件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T13:31:30.633

验证事件适用于具有可编辑值的控件。标签没有可编辑的值。

您的情况并不少见，您有一个显示“正整数”的字段级验证和一个显示值 A 和 B 的总和必须等于 100% 的业务规则。

处理此问题的一种方法是延迟执行业务规则，直到表格完成；这将需要在用户单击“确定”按钮（或 Web 表单中的“提交”按钮）时验证业务规则

如果您想要即时验证，只需让两个字段的验证方法调用业务规则验证方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T03:26:22.740

请问这是一个网络项目还是表单项目？

用户不能在标签中输入任何数据，所以我不明白他们为什么会触发验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T03:36:55.370

寻找“文本更改”事件，我认为您误解了在控件的情况下使用验证。

在处理 tb1 的“文本更改”事件的方法中，您可以放置​​代码，在编辑 tb2 中的更改值时与 100 互补，反之亦然，编辑 tb2 将导致 tb1 中的自动更改。您还可以在此事件处理程序中对不正确的值做出反应

小心

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T18:47:01.370

根据 CausesValidation 的文档：

“获取或设置一个值，该值指示控件是否会导致在任何需要验证的控件上执行验证，当它接收到焦点时。”

在我自己的测试中，我必须专门调用 Label.Focus()，然后从该字段中跳出（或调用另一个 control.Focus()）才能触发事件。

我真的认为您使用错误的方法来获得您正在寻找的结果。我认为最好让文本框中的验证器调用一个实用方法来相应地设置标签。

# networking - 检测具有相同 MAC 地址的另一台主机

> ID：276990
> 
> 赞同：12
> 
> 时间：2008-11-10T03:19:05.903
> 
> 标签：networking, ethernet

如何检测另一台主机是否使用与当前主机相同的 MAC 地址，例如因为另一台主机在欺骗？

我在嵌入式环境中工作，因此在协议级别上寻找答案，而不是“使用这样那样的工具”。

**编辑**：RARP*不能解决*这个问题。要让 RARP 得到任何回复，网段上必须至少有一台主机支持 RARP。由于 RARP 已过时，现代操作系统不支持它。此外，RARP 所能做的就是告诉您自己的 IP 地址 - 如果网段上有另一台主机具有相同的 MAC，则响应不会有任何不同，除非该主机本身使用了不同的 IP 地址。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-10T05:21:33.990

这个问题太有趣了，不能放下！在几次错误的开始之后，我开始思考问题的基本组成部分，并在 RFC 中寻找建议。 **我还没有找到明确的答案，**但这是我的思考过程，希望对您有所帮助：

*   最初的问题询问如何使用您的 MAC 地址检测另一台设备。假设您在 IP 网络上，需要什么来完成此操作？

*   *被动*方法是简单地*侦听*流量并查找您未传输但具有您的 MAC 地址的任何数据包。这可能会发生也可能不会发生，因此尽管它*可以*明确地告诉您是否存在重复，但它*不能*明确地告诉您它不存在。

*   任何*主动*方法都要求您传输一个数据包，*迫使*冒名顶替者做出响应。这立即消除了任何依赖于*可选*协议的方法。

*   如果另一个设备在欺骗您，它*必须（根据定义）以**您的*MAC 地址作为目的地响应数据包。否则它是*窥探*而不是*欺骗*。

*   该解决方案应独立于 IP 地址，仅涉及 MAC 地址。

*   因此，答案似乎是传输广播（以太网）数据包或以您的 MAC 地址为目的地的数据包，这需要响应。猴子扳手是通常涉及IP地址，而您不知道。

*什么样的协议适合这种描述？*

**简单回答：**

*   如果您的网络支持 BOOTP 或 DHCP，那么您就完成了，因为这会权威地将 MAC 地址绑定到 IP 地址。发送一个 BOOTP 请求，获取一个 IP 地址，然后尝试与之交谈。您可能需要创造性地将数据包强制传输到网络上并阻止自己响应（我在考虑明智地使用 iptables 和 NAT）。

**不那么简单的答案：**

*   一种独立于 IP 的协议：要么不使用 IP 层，要么允许广播。没有想到。

*   发送通常会从您那里产生响应的*任何*数据包，阻止您自己响应，并寻找来自其他设备的响应。使用您的 IP 地址作为目的地似乎是明智的，但我不相信这一点。不幸的是，细节（以及因此的答案）留作 OP 的练习......但我希望讨论会有所帮助。

我怀疑最终的解决方案将涉及多种技术的组合，因为似乎没有一种方法可以保证可靠的确定。

一些信息可在[http://en.wikipedia.org/wiki/ARP_spoofing#Defenses获得](http://en.wikipedia.org/wiki/ARP_spoofing#Defenses)

如果一切都失败了，你可能会喜欢这个：[http ://www.rfc-editor.org/rfc/rfc2321.txt](http://www.rfc-editor.org/rfc/rfc2321.txt)

*请*发布您的解决方案的后续内容，因为我相信它会对其他人有所帮助。祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T00:25:16.163

您可以为子网中的每个可能的 ip 发送一个**ARP 请求**。当然 ARP 请求的源地址必须是*ff:ff:ff:ff:ff:ff*，否则你可能看不到响应。

我用 bittwiste 伪造了一个这样的数据包，并用 PReplay 重放了它，网络上的所有主机都得到了响应。（我不知道这些伪造的 ARP 数据包是否合法......某些操作系统可能会忽略它们）

这是伪造的包裹的样子： ![替代文字](https://dl.getdropbox.com/u/42655/eternity/packet.png)

这是回复的样子： ![替代文字](https://dl.getdropbox.com/u/42655/eternity/packet2.png)

如果您查看响应并在其中一个数据包中看到您的 MAC 地址（在红色矩形中），那么有人拥有与您相同的 MAC 地址......

不幸的是，我无法完全测试该理论，因为我的（Windows）机器都不关心我试图设置网卡的 MAC 地址......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T03:40:13.413

在单个网段上使用相同 MAC 地址的两台主机可能会使交换机发疯，您可能会通过极其不可靠的网络连接来检测它（因为交换机会将属于您的主机的部分数据包发送到第二台主机，取决于你们中的哪一个向他们发送了最后一个数据包）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-04T18:01:21.737

这已经很晚了，而且没有答案，但我想跟进我所做的事情，以防其他人感兴趣。

我正在使用一些非常奇怪的嵌入式硬件，这些硬件在制造时没有分配 MAC 地址。这意味着我们需要在软件中分配一个。

显而易见的解决方案是让用户选择他们知道在他们的网络上可用的 MAC 地址，最好是从本地管理的范围内，这就是我所做的。但是，我想选择一个相当安全的默认值，并尝试在发生冲突时警告用户。

最后，我在本地管理的范围内选择了一个随机的默认值，通过一些具有中等熵的硬件读数来选择。我故意排除了范围的开始和结束，假设它们更有可能是手动选择的。任何给定网络上可能只有其中一个设备，而且肯定少于 20 个，因此发生冲突的可能性非常低，尽管由于有些可预测的随机数而没有那么低。

考虑到出现问题的可能性很小，尽管上面给出了很好的答案，我还是决定放弃冲突检测，并警告用户注意 MAC 冲突问题。

如果我确实决定实施冲突检测，那么鉴于我控制了整个网络堆栈，我可能会寻找过多的未知或丢失的数据包，然后触发 MAC 地址的更改或在发生这种情况时警告用户。

希望这会在某个地方对其他人有所帮助——但可能不会！********