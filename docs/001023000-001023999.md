# StackOverflow 问答 1023000-1023999

# coding-style - 输入代码时如何尽量减少箭头键的使用？

> ID：1023002
> 
> 赞同：18
> 
> 时间：2009-06-21T02:13:26.523
> 
> 标签：coding-style, typing

键入代码时，我通常会关闭括号，返回内部，走出外部，键入分号等：

我可以从（| 是插入符号）开始：

```
System.out.println()| 
```

然后向左走：

```
System.out.println(|) 
```

然后这个：

```
System.out.println(foo()|) 
```

再次回溯一个空格：

```
System.out.println(foo(|)) 
```

键入引号是相似的：

```
System.out.println(foo(""|)) 
```

...ETC。

我的右手在主行和箭头键之间不断移动。我已经尝试过 vim，虽然我知道基础知识，但对我来说仍然感觉很尴尬。

我该怎么做？我应该从左到右输入（左括号，然后是内容，然后是右括号，然后是分号）？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-21T11:21:44.980

首先，在 Vim 中使用, `h`,`j`代替箭头键可以提高速度。有关这些键的概述，请参阅[Learning Vim the Pragmatic Way](http://jrmiii.com/2009/03/06/learning-vim-the-pragmatic-way.html)。`k``l`

但是，在这种情况下，您可能想要的是[AutoClose](http://www.vim.org/scripts/script.php?script_id=2009)插件。它会自动插入右括号（或引号）和开头，并在它们之间放置插入符号。这样你就从

```
System.out.println(|) 
```

至

```
System.out.println(foo(|)) 
```

至

```
System.out.println(foo("|")) 
```

如果您随后键入`"))`，插入符号将“移过”结束字符，而不是插入新字符。虽然，到达行尾的更快方法可能是`<Esc>A`.

```
System.out.println(foo("")); 
```

因此，综上所述，上述内容可以通过键入来生成`System.out.println(foo("<Esc>A;`。

*编辑*成对的字符，而不是插入它们，见环绕[.vim](http://www.vim.org/scripts/script.php?script_id=1697)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T02:23:41.357

好吧，那是 Java，如果您使用或多或少好的 IDE，您应该能够自动完成，这样当您键入“System.out.println”并按 Enter 接受自动完成时，括号将显示，插入符号将是在中间（哦，还有引号！）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-21T02:19:08.480

如果您已经在 vim 中，请尝试使用 h、j、k 和 l 键。它们的作用与箭头键相同，但更方便。尝试养成按顺序打字的习惯可能也会有所帮助，但这需要一些努力。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-21T02:40:47.327

您可以通过按住 Ctrl 键并使用箭头键来保存击键。它不是移动一个字符，而是一次移动一个单词。这在退格时也有效。所以 Ctrl-Backspace 将删除整个单词，而不仅仅是最后一个字符。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-03T19:33:46.820

试试 AutoHotKey 和我的脚本：

```
*!I::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Up}"
*!K::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Down}"
*!J::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Left}"
*!L::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Right}"
*!U::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Home}"
*!O::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{End}"
*!h::SendInput, % (GetKeyState("Shift", "P") ? "+" : "") (GetKeyState("Ctrl", "P") ? "^" : "") "{Del}" 
```

LAlt & Shift:: ('可选行')

这是关于按住 LAlt + 按下以下内容：i、k、j、l（箭头键）、u、o（home、end）或 h（删除）。如果您不想更改键盘语言，最后一行是可选的。LAlt + Shift 布局

您甚至可以将它与 shift 和 ctrl 等修饰符结合使用。

请享用 ;）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-21T02:37:45.587

不。

你结束你开始的事情的习惯——无论是右括号、括号、大括号，还是匹配 .Open() 的 .Close() 调用，或匹配你的 new/malloc 的 delete/free 调用——都是一个很好的习惯. 即使您打算在不同的范围内“关闭”您的对象（如终止函数），您的习惯也会迫使您考虑正确释放资源。

是的，有一些有用的编辑器可以让您更快地编码，您绝对应该使用它们，但不要让它们成为让您忘记关闭对象/释放资源的拐杖。

您问题的直接答案：大多数优秀的程序员编辑器都可以自定义/配置，因此您只需阅读一些有关您选择的编辑器的高级配置的信息 - vim、emacs、Visual Studio 编辑器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-21T02:21:48.880

我会完全推荐 vim ......因为它会帮助很多！另外，请查看可以为您自动关闭括号、方括号和大括号的内容......我在 vim 中有一些东西可以做到这一点，它有助于解决这类问题，因为我已经在括号内了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-21T03:54:15.710

我曾经完全线性地输入（是的，在 vim 中），永远无法掌握编写关闭元素立即创建的来回冲刺的窍门。

但是，我现在使用 Eclipse——它会在我去的时候为我创建它们，所以在结束时我只是打完并输入一个 ;，根本不需要手动处理它。有时让我感到困惑，但没关系。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-21T11:56:18.357

一个好的 IDE（伽利略几乎就在这里）会自动关闭括号、括号等，并且会在语句的末尾智能地插入一个分号。根本不需要使用箭头！

当然，对于 Eclipse 中的 println，您只需键入 sysout，但这可能是一个不好的习惯。

但小心点！如果你开得太快，你的同事总是会让你开车：P

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-21T03:15:41.330

再次投票给 Vim。此外，对于使用 Vi 键绑定的更多标准 IDE，还有一些很棒的插件。我不时在 Netbeans 中使用[jVI 。](http://jvi.sourceforge.net/)

你会发现，你使用 Vim 的次数越多，它在你的手腕上就越轻松。您还会发现，一个足够聪明的查找/替换可以为您节省不少击键次数，就像全局操作正则表达式一样。

将 :tabn 和 :tabp 绑定到可访问的东西上，并强迫自己完成工作而不放弃并使用适当的 GUI 编辑器。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-21T04:06:03.920

我发现数字键盘使导航非常容易，因为 home 键和 pgup 键非常接近。对于实际输入数字，您只需使用键盘的第一行（我同意这很难学习，但一段时间后足够快）。

对我来说，唯一的缺点是使用笔记本电脑键盘和使用其他人的机器，我每次都必须关闭数字锁定。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-10T18:45:20.730

对我来说解决这个问题的最好方法是将键盘上的第二个布局更改为

```
h -> Left Arrow, j -> Up Arrow, k -> Down Arrow, l -> Right Arrow 
```

现在，当我按下右手拇指下方的 Fn 按钮时，我得到了类似 Vim 的导航。我就是喜欢它。它对所有程序都是通用的。我还设置了一些其他键，Page Up、Page Down 等。

# java - Java 内存移动？

> ID：1023004
> 
> 赞同：6
> 
> 时间：2009-06-21T02:13:36.460
> 
> 标签：java, api

我正在将一些旧的 C 代码移植到 Java 的过程中，由于我对 Java 的经验不足，我在定位 memmove 等效项时遇到了问题。Java中有这样的方法吗？我已经对它进行了足够的研究，以假设我忽略了一些相当明显的东西。提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-21T02:15:57.080

你可以使用[`System.arraycopy`](http://java.sun.com/javase/6/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29), 如果你想做的只是在一个数组中随机播放。

具体来说，该函数允许源和目标在同一个数组中，并且允许范围重叠；所以从这个意义上说，它就像`memmove`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T06:52:55.647

实际上，这[`System.arrayCopy()`](http://java.sun.com/javase/6/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)是老派的方法，只有当你 a) 卡在 Java 5 或更早版本上，或者 b) 必须在预先存在的数组之间复制时才应该使用。如果要创建数组的副本，可以使用[`Arrays.copyOf()`](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#copyOf%28T%5B%5D%2C%20int%29)或[`Arrays.copyOfRange()`](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28T%5B%5D%2C%20int%2C%20int%29)

# javascript - jQuery新手：如何将参数传递给事件处理函数？

> ID：1023007
> 
> 赞同：1
> 
> 时间：2009-06-21T02:15:19.767
> 
> 标签：javascript, jquery

我在[这里查看](http://docs.jquery.com/Events/click#fn)jQuery 文档中的“单击”事件示例。我可以如下重构这两个匿名函数，它仍然有效：

```
$(document).ready(function(){
    $("p").hover(hilite, remove_hilite);
  });

  function hilite()
  {
    $(this).addClass("hilite");
  }

  function remove_hilite()
  {
    $(this).removeClass("hilite");
  } 
```

但是，如果我想将参数传递给`hilite`? 我的第一个猜测是我应该使用这样的匿名[函数](http://docs.jquery.com/How_jQuery_Works#Right)。但是，这似乎不起作用，即使我在没有参数的情况下使用它：

```
$("p").hover(
    function()
    {
        hilite();
    }
    ,
    function()
    {
        remove_hilite();
    }
); 
```

我也尝试如下重构，但这也不起作用：

```
$(document).ready(function(){
    $("p").hover(hilite2, remove_hilite);
  });

  function hilite2(){
     return hilite();
  } 
```

这样做的正确方法是什么？我觉得我有一个很大的概念误解。特别是，我不清楚在我的第一次重构中，`this`对象是如何传递给`hilite`函数的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T02:24:08.717

您可以将悬停函数调用封装到另一个接受“className”参数的函数中：

```
$.fn.hoverClass = function(className){
    return this.hover(function(){
        $(this).addClass(className);
    }, function(){
        $(this).removeClass(className);
    });
} 
```

然后您可以通过以下方式简单地使用它：

```
$('p').hoverClass('hilite'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T02:24:16.953

我认为您想要的是一个**部分功能应用程序**。

```
function partial(func /*, 0..n args */) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var allArguments = args.concat(Array.prototype.slice.call(arguments));
    return func.apply(this, allArguments);
  };
} 
```

使用上述功能，您现在可以执行以下操作：

```
$(document).ready(function(){
    var f = partial(hilite, "arg1", "arg2" /*etc...*/);
    $("p").hover(f, remove_hilite);
  }); 
```

*参考：[如何在 JavaScript 函数调用中预设参数？（部分功能应用）](https://stackoverflow.com/questions/321113)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T02:20:45.807

为什么不能简单地`$(this).addClass()`在匿名函数中调用该方法？

```
$("p").hover(
  function () {
    $(this).addClass("hilight");
  },
  function () {
    $(this).removeClass("hilight");
  }
); 
```

# macos - 如何通过命令行获取 Mac OS X 的开发工具（例如 make）

> ID：1023011
> 
> 赞同：1
> 
> 时间：2009-06-21T02:18:32.677
> 
> 标签：macos, compiler-construction, curl, makefile

我有点吃醋了。我有几台 Mac Mini 在我的 ISP 上托管，并且只有 shell 访问权限（例如通过 ssh）来管理这些盒子。这很好，但我刚刚意识到 - 在为我需要的几个包下载了一些 tar 文件之后 - 我没有安装基本的开发工具（例如用于编译源代码的 make）。有没有可以使用 curl 下载它们的地方？

提前致谢！~阿基

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T02:21:31.983

从 Mac OS 安装媒体安装 xcode（我认为这是第二张 dvd 或 cd 或其他任何东西，但我不确定）。应该这样做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T02:21:31.517

安装[MacPorts](http://macports.org)。这将为您提供您可能需要的所有常用命令行工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T02:22:42.683

您可以使用[fink](http://www.finkproject.org/)为自己获取 lynx（命令行网络浏览器）的副本，然后使用它从[Apple](http://connect.apple.com)下载 OS X 开发人员工具。或者你可以从 Fink 安装一个 GNU 工具链。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T03:20:25.937

您应该已经拥有`curl`（我的位于`/usr/bin/curl`），您可以使用它来获取[`fink`](http://www.finkproject.org/)或[`MacPorts`](http://www.macports.org/)下载。然后从那里去。

我自己就是一个芬克人。Fink 需要安装 devtools DVD。

# c# - 如何阻止 Visual Studio 自动格式化代码的某些部分？

> ID：1023014
> 
> 赞同：16
> 
> 时间：2009-06-21T02:19:23.097
> 
> 标签：c#, visual-studio, visual-studio-2008, preferences

这似乎应该很简单，但我就是想不通。我想让 Visual Studio 保持自动格式化我的代码，除了这部分：

```
public SomeClass : BaseClass {
    public SomeClass() 
        : base()
    {

    }
} 
```

为什么我不能让它看起来像这样：

```
public SomeClass : BaseClass {
    public SomeClass() : base() {

    }
} 
```

我查看了工具 -> 选项 -> 文本编辑器 -> C# -> 新行，但找不到它。有没有办法可以更改它以允许自动格式化和我的第二个示例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T03:06:08.663

AFAIK 没有办法阻止 Visual Studio 这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T03:11:47.250

你确定取消选中：

Options -> Text Editor -> C# -> Formatting -> New Lines -> Place Open Brace on new line for types

不做你想做的事？

并取消选中

在方法的换行符上放置左大括号。

（nvrmind ..我明白你在做什么......这很烦人）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T03:28:58.853

您购买[ReSharper](http://www.jetbrains.com/resharper/index.html)并将其用于所有格式设置，您可以完全按照您的需要进行设置 =)

# javascript - 为什么这个 javascript 会崩溃 safari 而不是 firefox？

> ID：1023017
> 
> 赞同：0
> 
> 时间：2009-06-21T02:21:15.587
> 
> 标签：javascript, safari, crash

我有一个窗格，其中包含一组 javascript 生成的表格，每个表格都有一个唯一的 ID 和 4 个单元格，我使用以下 Javascript 代码为其中一个表格设置背景颜色。它在 Firefox 中运行良好，但它在第一次尝试设置背景颜色（在 if 语句中）时使 Safari 崩溃。任何想法为什么？

```
<script language='Javascript'>
  function colortree(source) {
    var el=parent.frames['tree-pane'].document.getElementsByTagName('table');
    for (var i=0;i<el.length;i++) {
        var id = el[i].id;
        if (id) {
           var cell = el[i].getElementsByTagName('td')[3];
           if (id == source) { cell.style.backgroundColor = 'yellow' }
           else { cell.style.backgroundColor = 'white' };
        }
    }
    return false;
  }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T02:31:14.803

如果数组索引有可能不存在，您应该始终测试它们是否存在

例如

```
<script language='Javascript'>
  function colortree(source) {
    var cells, cell, id;
    var el=parent.frames['tree-pane'].document.getElementsByTagName('table');
    for (var i=0;i<el.length;i++) {
        id = el[i].id;
        if (id) {
           cells = el[i].getElementsByTagName('td');
           if (cells[3]) {
               cell = cells[3];
               if (id == source) { cell.style.backgroundColor = 'yellow' }
               else { cell.style.backgroundColor = 'white' };
           }
        }
    }
    return false;
  }
</script> 
```

# java - 如何将 ASCII 值映射到适当的键码？

> ID：1023034
> 
> 赞同：1
> 
> 时间：2009-06-21T02:24:36.237
> 
> 标签：java

如何将 ASCII 值映射到适当的键码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T02:30:53.243

键码是为常用键定义的。它们以 VK_ 为前缀（用于虚拟键）：

**字母数字键**

*VK_0, VK_1, ..., VK_9, VK_A, VK_B, ..., VK_Z*

**控制键**

V *K_ENTER, VK_BACKSPACE, VK_TAB, VK_ESCAPE*

**功能键**

*VK_F1、VK_F2、VK_F3、VK_F4 VK_F5、VK_F6、VK_F7、VK_F8、VK_F9、VK_F10、VK_F11、VK_F12、VK_SCROLL_LOCK、VK_PRINTSCREEN、VK_PAUSE、VK_DELETE、VK_ENDSERT、VK_PAGE_UP、VK_PAGE_DOWN、*

**方向键**

*VK_LEFT、VK_RIGHT、VK_UP、VK_DOWN*

参考。: [Java 笔记: 键盘](http://leepoint.net/notes-java/GUI-lowlevel/keyboard/keyboard.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T03:27:08.030

如果我理解正确，您将提出要作为 KeyEvents 广播的消息，并且将消息转换为 ASCII 很简单。现在您希望我们将该 ACSII 转换为键码。

如果您查看 KeyEvent 的代码，您会发现 VK_A 到 VK_Z 等同于 A 到 Z 的 ASCII 值，这使得映射相对容易。请注意，尽管这些是大写字母的 ASCII，但在 KeyEvent 中未经修改，它们代表小写字母。要获得大写的键码，您需要将 VK_SHIFT（和/或 VK_CAPSLOCK）的修饰符与大写字母的 ASCII 组合起来。

因此，继续假设的目标，您可以通过将小写和大写都解析为相同的 ASCII 码（对于大写字母）来设置字母的键码来创建 KeyEvent。然后，如果您的输入 ASCII 落在大写 ASCII 范围的范围内，您可以将 KeyEvent 上的修饰符设置为 VK_SHIFT。

如果您的问题区域更广泛，您可能需要设置一个地图，您可以使用它查找这些代码以及其他标点符号和控制字符。KeyEvent.getKeyText() 的实现显示了类似的内容，但方向相反。你可以用它作为你的起点。如果出于某种原因，Java 决定更改这些 VK_ 字段的常量值，那么沿着这条路线走也将降低您的应用程序的风险。

# python - 在 Python 中更改进程优先级，跨平台

> ID：1023038
> 
> 赞同：33
> 
> 时间：2009-06-21T02:27:19.243
> 
> 标签：python

我有一个执行耗时计算的 Python 程序。由于它使用高 CPU，并且我希望我的系统保持响应，我希望程序将其优先级更改为低于正常值。

我发现了这个： [在 Windows 中设置进程优先级 - ActiveState](http://code.activestate.com/recipes/496767/)

但我正在寻找一个跨平台的解决方案。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-21T05:21:37.573

这是我用来将我的进程设置为低于正常优先级的解决方案：

**`lowpriority.py`**

```
def lowpriority():
    """ Set the priority of the process to below-normal."""

    import sys
    try:
        sys.getwindowsversion()
    except AttributeError:
        isWindows = False
    else:
        isWindows = True

    if isWindows:
        # Based on:
        #   "Recipe 496767: Set Process Priority In Windows" on ActiveState
        #   http://code.activestate.com/recipes/496767/
        import win32api,win32process,win32con

        pid = win32api.GetCurrentProcessId()
        handle = win32api.OpenProcess(win32con.PROCESS_ALL_ACCESS, True, pid)
        win32process.SetPriorityClass(handle, win32process.BELOW_NORMAL_PRIORITY_CLASS)
    else:
        import os

        os.nice(1) 
```

在 Windows 和 Linux 上的 Python 2.6 上测试。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2011-06-05T18:56:37.373

您可以使用[psutil](http://code.google.com/p/psutil/wiki/Documentation)模块。

在 POSIX 平台上：

```
>>> import psutil, os
>>> p = psutil.Process(os.getpid())
>>> p.nice()
0
>>> p.nice(10)  # set
>>> p.nice()
10 
```

在 Windows 上：

```
>>> p.nice(psutil.HIGH_PRIORITY_CLASS) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-21T03:01:50.607

在每个类 Unix 平台（包括 Linux 和 MacOsX）上，请参见`os.nice` [此处](https://docs.python.org/library/os.html#os.nice)：

```
os.nice(increment)
Add increment to the process’s “niceness”. Return the new niceness. Availability: Unix. 
```

由于您已经有一个适用于 Windows 的配方，它涵盖了大多数平台——在除 Windows 之外的任何地方使用一个肯定的参数调用 os.nice，在那里使用该配方。没有“包装精美”的跨平台解决方案 AFAIK（很难将这个组合打包，但是，仅打包它会带来多少额外价值？-）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-28T16:38:28.337

如果您无权访问其中一些模块，您可以在 Windows 中使用以下方法进行操作：

```
import os  
def lowpriority():  
    """ Set the priority of the process to below-normal."""  
    os.system("wmic process where processid=\""+str(os.getpid())+"\" CALL   setpriority \"below normal\"") 
```

为了兼容性，您可以明显区分操作系统类型，如上面的示例。

# php - 变量变量的验证不起作用

> ID：1023041
> 
> 赞同：0
> 
> 时间：2009-06-21T02:28:09.443
> 
> 标签：php, variables, validation

```
$method = 'post';

$method = strtoupper($method);
echo $method.'test1';

$method = '_'.$method;
echo $method.'test2';

$method = $$method;
echo $method.'test3'; 
```

为什么这不会在 2 和 3 之间打印 $_POST 的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T02:32:19.607

您想要`$method['test3']`访问`$_POST`数组的元素。点`.`运算符执行字符串连接。方括号`[]`用于数组访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T02:38:39.297

除了约翰库格曼的优秀观点，我会使用以下

```
$method = $_POST;

echo $method['test1'];

echo $method['test2'];

echo $method['test3']; 
```

并且不打扰尝试通过字符串访问*常量*数组名称

如果你真的坚持使用字符串来访问这些，你可以

```
$method = "post";
$method = strtoupper($method."_");    
if (isset(${$method})) {
  $method = ${$method};

  echo $method['test1'];

  echo $method['test2'];

  echo $method['test3'];
} 
```

# sql-server - 将 WHERE 条件传递给存储过程

> ID：1023042
> 
> 赞同：2
> 
> 时间：2009-06-21T02:28:51.500
> 
> 标签：sql-server, tsql

这是我的存储过程

```
CREATE PROCEDURE [B]

 @BoardID varchar(5000)

AS

declare @sB varchar(8000)
set @sB= ' '

Select name,id,address  from BoardDetail

WHere IsActive=1 and @sB=@BoardID
GO 
```

在这里我发送字符串参数....我的**@BoardID**包含字符串条件，如：**name=a 和 id=5 和 address =adfas**

我只想提供字符串并想在旁边设置，**任何**人都可以帮我修复错误

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T02:34:13.190

您需要构建一个动态查询。

请参阅这篇文章：[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)。它是动态 SQL 的规范参考。

正如其他人所指出的，您应该谨慎使用动态 SQL，并且在没有其他方法适合的情况下使用。动态 SQL 可以打开 SQL 注入攻击的风险，正如“动态 SQL 的祸与福”中所指出的，还有一些更微妙的陷阱需要注意。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T02:37:12.263

这是一个非常糟糕的做法。这将限制您验证 SQL 参数、减少或消除查询计划重用的能力，并且可能会扩大臭氧层中的漏洞。

我在开玩笑最后一个 - 而不是前两个。

你最好只创建三个参数：

```
CREATE PROCEDURE B
  @name varchar(10),
  @id int,
  @address varchar(20)
AS
BEGIN
  SELECT name, address FROM BoardDetail
  WHERE IsActive = 1 AND BoardID = @id AND name = @name AND address = @address
END 
```

相信我 - 通往地狱的道路是由串联的查询字符串铺成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T03:00:11.047

[您可以通过exec](http://msdn.microsoft.com/en-us/library/ms188332.aspx)或[sp_executesql](http://msdn.microsoft.com/en-us/library/ms188001.aspx)使用动态 SQL 来做到这一点：

```
CREATE PROCEDURE [B]
    @BoardWhere varchar(5000)
AS
declare @query varchar(8000)
set @query = 'Select name,id,address from BoardDetail where ' + @BoardWhere
exec (@query) 
```

在声明存储过程 fe 时，最好给出模式名称：

```
CREATE PROCEDURE dbo.[B] 
```

而且，存储过程对 sql 注入是开放的，因此请注意您赋予谁执行权限。例如，有人可以将“1=1”作为参数传递，甚至更糟糕的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-22T20:08:20.293

如果您想要在运行时传递多个搜索项，您可以这样做而不是使用动态 SQl。请记住，如果可以避免，使用动态 SQL 通常是一种不好的做法。

select * from mytable where (my_ID = @my_id OR @my_id IS NULL) and (client_id = @client_id or @client_id is null)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T02:34:04.627

好吧，你不能那样做。查看这篇文章，了解执行[动态 where 子句](http://www.sqlteam.com/article/implementing-a-dynamic-where-clause)的几种方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T02:34:15.140

您认为它是错误的（当然没有错，但是从框架如何让您使用它的角度产生了偏差）。

您正在尝试将 SQL 作为参数传递，然后将其附加到您拥有的 SQL 中。使用[动态 SQL](http://www.sommarskog.se/dynamic_sql.html)可以做到这一点，但没有它就不行——而且您没有使用它。

你实际上在做的是比较：

```
WHere IsActive=1 and @sB=@BoardID
becomes:
WHere IsActive=1 and ' '='name=5 and id=6' 
```

这当然不会返回任何结果，因为空字符串不等于包含这些字符的字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-21T02:34:54.563

您正在尝试检查不存在的列

从 BoardDetail 中选择名称、ID、地址

其中 IsActive=1 和 @sB=@BoardID

@sB 是一个始终为 NULL 且永远不会是 = @BoardDetail 的变量

如果您尝试根据参数 @BoardDetail = 'name=a and id=5 and address =adfas' 发送的字符串值进行选择，请尝试以下操作：

创建过程 [B]

@BoardID varchar(5000)

作为

声明@cmd varchar(8000)

SET @cmd = '从 BoardDetail 中选择名称、id、地址，其中 IsActive=1 和 '+ @BoardID

执行 (@CMD)

拉吉

# java - 尝试在 Eclipse 中运行更新 UI 时收到消息“无法启动更新 UI ...”

> ID：1023044
> 
> 赞同：6
> 
> 时间：2009-06-21T02:30:37.240
> 
> 标签：java, eclipse

当我尝试在 Eclipse 中运行更新管理器时，我收到错误消息“无法启动更新 UI。此安装没有为软件更新正确配置。”

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-21T05:54:33.423

关于该消息已经输入了一些错误：

*   [错误 238910](https://bugs.eclipse.org/bugs/show_bug.cgi?id=238910)：如果您的 Eclipse 错误日志包含：

    !MESSAGE 解析配置文件 /opt/eclipse/p2/org.eclipse.equinox.p2.engine/profileRegistry/SDKProfile.profile/1214752385704.profile 时出错。

> .profile 已损坏。
> 我只是删除了损坏的.profile，重新启动了eclipse，现在一切似乎都很好

*   [bug 224658](https://bugs.eclipse.org/bugs/show_bug.cgi?id=224658) : self-hosting 时, p2 update ui won't up (self-hosting case (即Eclipse调试另一个Eclipse实例, 如插件开发情况)
    3.4修复

*   [错误 230245](https://bugs.eclipse.org/bugs/show_bug.cgi?id=230245)：无法读取 unicode（在某些 xml 文件中）：已在 3.4 中修复

你运行的是什么版本的eclipse？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T02:35:28.070

尝试启用*经典更新*

```
Window -> Preferences -> General -> Capabilities -> Classic Update 
```

如果您无法使用该条目：

1.  关闭日食
2.  导航到此文件

`[yourWORKSPACE]/.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.ui.workbench.prefs`

并尝试添加此行并重新启动 eclipse

```
UIActivities.org.eclipse.equinox.p2.ui.sdk.classicUpdate=true 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-21T10:30:55.403

如果您使用的是 Flash Builder 4，通过自动更新更新了您的安装并遇到此问题，请更改此文件：

```
Adobe Flash Builder Beta\.metadata\.plugins\org.eclipse.update.ui\dialog_settings.xml 
```

并编辑内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<section name="Workbench">
    <section name="ModeSelectionPage">
        <item key="new-features-mode" value="false"/>
    </section>
</section> 
```

写 FALSE 而不是 TRUE

重新启动后，我的帮助菜单中有两个项目：

*   软件更新 - 经典下拉菜单
*   软件更新-它下面的项目给了我错误

但我终于可以进入更新对话框并管理更新了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T13:49:55.757

您也可以尝试在“运行配置”->“配置”选项卡中检查“已启动应用程序中的支持软件安装”字段。

# vim - 在gvim中从当前点到文件末尾排序？

> ID：1023055
> 
> 赞同：4
> 
> 时间：2009-06-21T02:34:47.153
> 
> 标签：vim

命令模式下的以下内容（gvim）

```
:.,G!sort 
```

结果是

```
E464: Ambiguous use of user defined-command

:help E464 
```

```
  用户自定义命令的模糊使用

有两个带有通用名称前缀的用户定义命令，您使用了
执行其中之一的命令行补全。|用户命令不明确|
示例：>
    :command MyCommand1 回显“一”
    :command MyCommand2 回显“二”
    :我的命令

  不是编辑器命令

```

我已经盯着这个看了一会儿，有人可以用我的方式扔骨头或提供一种方法来做到这一点而不诉诸视觉模式吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T02:35:43.577

我通常使用`:.,$!sort`; 那对你有用吗？

**原始海报编辑**

G 不是正确的范围规范。从 :help range 输出见下文。

```
行号可以指定为： *:range* *E14* *{address}*
    {number} 绝对行号
    . 当前行 *:.*
    $ 文件的最后一行 *:$*
    % 等于 1,$（整个文件）*:%*
    't 标记 t 的位置（小写）*:'*
    'T 标记 T 的位置（大写）；当标记在
            另一个文件它不能在一个范围内使用
    /{pattern}[/] {pattern} 匹配的下一行 *:/*
    ?{pattern}[?] {pattern} 匹配的上一行 *:?*
    \/ 先前使用的搜索的下一行
            模式匹配
    \? 先前使用搜索的上一行
            模式匹配
    \& 先前使用的替代品的下一行
            模式匹配

每个都可以（多次）后跟“+”或“-”和一个可选数字。
这个数字是从前面的行号中加上或减去的。如果
数字省略，使用 1。

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T02:41:04.877

G 是运动，而不是范围说明符。见`:help range`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-21T18:51:05.803

```
" vim 有内部排序
:.,$排序

“如果有数字使用
:.,$排序 n

"删除重复的行
:.,$排序你

" 读 :h 排序

```

# java - Java Linux 非阻塞套接字超时行为

> ID：1023059
> 
> 赞同：4
> 
> 时间：2009-06-21T02:35:21.893
> 
> 标签：java, linux, sockets, nonblocking

我有一个 Java 非阻塞服务器，它跟踪选择器中的所有套接字通道。然后我与服务器建立 500 个连接并定期发送数据。服务器接收到的每条数据都会回显给客户端。

问题出现在测试工作出色的几个小时，然后突然间，服务器管理的所有套接字在尝试读取数据时都会抛出 Connection timed out IOException。

我已经查看了客户端线程是否被饿死（而不是发送数据），但我正在让客户端线程遍历所有套接字并写出数据。流量似乎一直在正常流动，但一段时间后它就全部消失了。任何想法可能导致这种行为？

我正在使用最新版本的 Java 6 的 Linux 平台上运行。我的应用程序启动两个线程，一个用于服务器，一个用于所有客户端。提前致谢！

**额外：** 问题是处理 Linux 而不是我的代码。当我在 Windows 机器上（在同一硬件上）运行完全相同的设置时，它永远不会超时，但几个小时后它们开始在 Linux 上发生。一定是Linux中的某种TCP设置导致它发生。谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-26T14:20:43.110

问题是处理 Linux 而不是我的代码。当我在 Windows 机器上（在同一硬件上）运行完全相同的设置时，它永远不会超时，但几个小时后它们开始在 Linux 上发生。一定是Linux中的某种TCP设置导致它发生。谢谢你的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T20:31:55.067

The -doCloseWithReadPending option in Java and JRE versions 1.5 or 5.0 allows one thread to close a socket when there is a read pending on the same socket from another thread.

When close() is called on a socket which has an outstanding read call from another thread, the close() by default blocks the socket until the read call completes.

With the -doCloseWithReadPending option, the socket close() call closes the socket and in the context of the thread with the pending read, a SocketException with the message "Socket closed" is thrown.

I don't know if this is the root cause of your issue without seeing the code, but I thought I would add this here incase it affects your issue.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-03T21:00:42.073

因此，在两种情况下（Windows 和最新的 JVM）和不工作的情况（Linux 和最新的 JVM），服务器和客户端都在同一个 JVM 中的同一台机器上？

你能澄清一下“突然逐渐”是什么意思吗？就像，几个小时后——而且总是相同的小时数——然后在几秒钟内所有服务器端套接字都会抛出异常？

您没有提到客户端线程读取返回的数据。也许它已经停止了，而你没有注意到。（服务端线程遇到500个快速异常时，客户端线程在做什么？连续尝试几次堆栈转储看看。）

# javascript - JQueryUI 到底是做什么用的？

> ID：1023063
> 
> 赞同：1
> 
> 时间：2009-06-21T02:35:54.577
> 
> 标签：javascript, jquery-ui

我对 jqueryui 的确切用例有点困惑。你用它来做什么？

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T03:10:13.523

如果您正在开发丰富的交互式 UI，您会发现 jQuery UI 交互（例如可拖动、可放置、可调整大小等）是构建的方便基础。这些东西自己编写代码并不简单。

正如有人建议的那样，jQuery UI 并不是真正旨在使您的网站漂亮 - 它的主要目的是提供有用的 javascript 工具来促进一些常见的用户交互。如果您正在制作一个基于 CMS 的信息密集型网站，这可能不是很有帮助。但是，如果您正在构建电子表格应用程序或所见即所得的编辑器或复杂的仪表板——简而言之，一个高度交互的应用程序——那么 jQuery UI 将为您提供一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T02:44:29.130

我将它用于 Adob​​e AIR 项目。

选项卡和模态警报一样运行良好，我可以使用 Themeroller 为我的 div 设置主题，但我对其他方面并不满意。只是没有足够的好小工具。下次我尝试使用带有大量小工具的 RIA 时，我可能会使用 ExtJS。我现在会使用 ExtJS，除了许可证每次我看它时都会让我感到困惑。

在这一点上，我无法完全弄清楚谁会对 jQueryUI 感到满意，但也许随着更多“东西”的推出，它会值得使用。但对我来说，小部件的进展似乎很缓慢。

此外，我对“悬停”和“点击”没有区别感到恼火。[将鼠标悬停在 datepicker 中的某个日期上](http://jqueryui.com/demos/datepicker/)，然后单击并按住（不要释放）。你有没有看到任何表明你点击的东西？

因此，在使用过它之后，我也对确切的用例感到有些困惑。但是，我认识一些来自 Twitter 的人。我真的很喜欢他们，我祝他们一切顺利。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-21T02:39:05.130

我认为它类似于[http://script.aculo.us/](http://script.aculo.us/)。一个基于 javascript 的网站小部件库。

# c# - 标记界面的目的是什么？

> ID：1023068
> 
> 赞同：99
> 
> 时间：2009-06-21T02:38:23.900
> 
> 标签：c#, interface, class-design

标记界面的目的是什么？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-06-21T03:37:14.280

根据“米奇小麦”的回应，这有点切线。

一般来说，每当我看到人们引用框架设计指南时，我总是喜欢提到：

**大多数情况下，您通常应该忽略框架设计指南。**

这不是因为框架设计指南有任何问题。我认为 .NET 框架是一个很棒的类库。很多奇妙的东西来自框架设计指南。

但是，设计指南不适用于大多数程序员编写的大多数代码。他们的目的是创建一个供数百万开发人员使用的大型框架，而不是提高库编写效率。

其中的许多建议可以指导您执行以下操作：

1.  可能不是实现某事的最直接方式
2.  可能导致额外的代码重复
3.  可能有额外的运行时开销

.net 框架很大，真的很大。它是如此之大，以至于假设任何人都对它的各个方面都有详细的了解是绝对不合理的。事实上，假设大多数程序员经常遇到他们以前从未使用过的框架部分，会更安全。

在这种情况下，API 设计者的主要目标是：

1.  使事情与框架的其余部分保持一致
2.  消除 API 表面积中不必要的复杂性

**框架设计指南推动开发人员创建实现这些目标的代码。**

这意味着做一些事情，比如避免继承层，即使这意味着复制代码，或者将所有抛出异常的代码推送到“入口点”而不是使用共享帮助器（这样堆栈跟踪在调试器中更有意义），还有很多的其他类似的事情。

这些指南建议使用属性而不是标记接口的主要原因是因为删除标记接口使类库的继承结构更容易接近。与具有 15 种类型和 2 层层次结构的类图相比，具有 30 种类型和 6 层继承层次结构的类图非常令人生畏。

**如果确实有数百万开发人员在使用您的 API，或者您的代码库非常大（例如超过 100K LOC），那么遵循这些指南会大有帮助。**

如果 500 万开发人员花 15 分钟学习一个 API，而不是花 60 分钟学习它，那么结果就是净节省了 428 人年。那是很多时间。

然而，大多数项目不涉及数百万开发人员或 100K+ LOC。在一个典型的项目中，假设有 4 个开发人员和大约 50K loc，假设集有很大不同。团队中的开发人员将对代码的工作方式有更好的理解。这意味着优化以快速生成高质量代码、减少错误数量和进行更改所需的工作量更有意义。

花 1 周时间开发与 .net 框架一致的代码，而不是花 8 小时编写易于更改且错误较少的代码，这会导致：

1.  后期项目
2.  较低的奖金
3.  错误数量增加
4.  在办公室度过的时间更多，在海滩上喝玛格丽塔酒的时间更少。

**如果没有 4,999,999 名其他开发人员来承担通常不值得的成本。**

例如，对标记接口的测试归结为单个“is”表达式，并导致查找属性的代码更少。

**所以我的建议是：**

1.  如果您正在开发旨在广泛使用的类库（或 UI 小部件），请认真遵循框架指南。
2.  如果您的项目中有超过 100K LOC，请考虑采用其中一些
3.  否则完全忽略它们。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-06-21T02:43:11.690

标记接口用于将类的能力标记为在运行时实现特定接口。

[接口设计](http://msdn.microsoft.com/en-us/library/ms229022.aspx)和[.NET 类型设计指南 - 接口设计](https://msdn.microsoft.com/en-us/library/ms229022%28v=vs.110%29.aspx)不鼓励使用标记接口，而倾向于在 C# 中使用属性，但正如@Jay Bazuzi 指出的那样，检查标记接口比检查属性更容易：`o is I`

所以代替这个：

```
public interface IFooAssignable {} 

public class Foo : IFooAssignable 
{
    ...
} 
```

.NET 指南建议您这样做：

```
public class FooAssignableAttribute : Attribute 
{
    ...
}

[FooAssignable]
public class Foo 
{    
   ...
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-10-02T10:44:27.340

由于所有其他答案都表示“应该避免它们”，因此解释原因会很有用。

首先，为什么使用标记接口：它们的存在是为了允许使用实现它的对象的代码检查它们是否实现了所述接口，如果确实如此，则以不同的方式对待对象。

这种方法的问题在于它破坏了封装。对象本身现在可以间接控制它在外部的使用方式。此外，它了解将要使用的系统。通过应用标记接口，类定义表明它希望在某个地方使用它来检查标记的存在。它对它所使用的环境有隐含的了解，并试图定义它应该如何被使用。这违背了封装的想法，因为它知道系统的一部分完全存在于它自己的范围之外的实现。

在实际水平上，这降低了可移植性和可重用性。如果该类在不同的应用程序中重用，则该接口也需要复制，并且它在新环境中可能没有任何意义，使其完全冗余。

因此，“标记”是关于类的元数据。此元数据不被类本身使用，仅对（某些！）外部客户端代码有意义，以便它可以以某种方式处理对象。因为它只对客户端代码有意义，所以元数据应该在客户端代码中，而不是类 API。

“标记接口”和普通接口之间的区别在于，带有方法的接口告诉外界如何使用它，*而*空接口意味着它告诉外界*应该*如何使用它。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-07-10T10:08:59.627

当语言不支持可*区分的联合*类型时，标记接口有时可能是必要的。

假设您要定义一个方法，该方法需要一个类型必须恰好是 A、B 或 C 之一的参数。在许多功能优先语言（如[F#](http://msdn.microsoft.com/en-us/library/dd233226.aspx)）中，这种类型可以明确定义为：

```
type Arg = 
    | AArg of A 
    | BArg of B 
    | CArg of C 
```

但是，在 C# 等面向对象优先的语言中，这是不可能的。在这里实现类似功能的唯一方法是定义接口 IArg 并用它“标记”A、B 和 C。

当然，您可以通过简单地接受类型“object”作为参数来避免使用标记接口，但这样您将失去表达能力和某种程度的类型安全性。

可区分的联合类型非常有用，并且在函数式语言中已经存在了至少 30 年。奇怪的是，直到今天，所有主流的 OO 语言都忽略了这个特性——虽然它实际上与函数式编程本身无关，但属于类型系统。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-21T02:48:08.467

标记界面只是一个空的界面。出于某种原因，一个类会将此接口实现为要使用的元数据。在 C# 中，您更常使用属性来标记类，原因与在其他语言中使用标记接口的原因相同。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-06-14T05:54:09.480

这两种扩展方法将解决 Scott 断言的标记接口优于属性的大多数问题：

```
public static bool HasAttribute<T>(this ICustomAttributeProvider self)
    where T : Attribute
{
    return self.GetCustomAttributes(true).Any(o => o is T);
}

public static bool HasAttribute<T>(this object self)
    where T : Attribute
{
    return self != null && self.GetType().HasAttribute<T>()
} 
```

现在你有：

```
if (o.HasAttribute<FooAssignableAttribute>())
{
    //...
} 
```

相对：

```
if (o is IFooAssignable)
{
    //...
} 
```

正如 Scott 所说，与第二种模式相比，我看不出使用第一种模式构建 API 所需的时间是第二种模式的 5 倍。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-01-24T16:24:09.660

标记接口允许以将应用于所有后代类的方式标记类。“纯”标记接口不会定义或继承任何东西；一种更有用的标记接口类型可能是“继承”另一个接口但不定义新成员的标记接口。例如，如果有一个接口“IReadableFoo”，也可以定义一个接口“IImmutableFoo”，它的行为类似于“Foo”，但会向任何使用它的人保证不会改变它的值。接受 IImmutableFoo 的例程将能够像使用 IReadableFoo 一样使用它，但例程只接受声明为实现 IImmutableFoo 的类。

我想不出“纯”标记界面有很多用途。我能想到的唯一一个是 EqualityComparer(of T).Default 是否会为任何实现 IDoNotUseEqualityComparer 的类型返回 Object.Equals，即使该类型也实现了 IEqualityComparer。这将允许一个人在不违反 Liskov 替换原则的情况下拥有一个未密封的不可变类型：如果该类型密封了与相等测试相关的所有方法，则派生类型可以添加额外的字段并使它们是可变的，但是这些字段的突变不会t 使用任何基本类型的方法都是可见的。拥有一个未密封的不可变类并避免使用 EqualityComparer.Default 或信任派生类不实现 IEqualityComparer 可能并不可怕，

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-10T06:47:21.393

标记是空接口。标记要么存在，要么不存在。

Foo 类：IConfidential

在这里，我们将 Foo 标记为机密。不需要实际的附加属性或属性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-07-09T12:00:35.293

标记接口实际上只是一种面向对象语言的过程编程。接口定义了实现者和消费者之间的契约，除了标记接口，因为标记接口只定义了它自己。因此，从一开始，标记接口就无法实现作为接口的基本目的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-08T08:22:05.727

标记界面是一个完全空白的界面，没有正文/数据成员/实现。
一个类在需要的时候*实现*marker接口，只是为了“ **mark** ”；意味着它告诉 JVM 特定类是用于克隆的，因此允许它进行克隆。这个特定的类是序列化它的对象，所以请允许它的对象被序列化。

# jquery - jquery UI 对话框：如何在没有标题栏的情况下进行初始化？

> ID：1023072
> 
> 赞同：260
> 
> 时间：2009-06-21T02:39:39.263
> 
> 标签：jquery, jquery-ui

是否可以打开没有标题栏的 jQuery UI 对话框？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2010-01-25T22:29:02.177

我认为最好的解决方案是使用 option `dialogClass`。

来自 jquery UI 文档的摘录：

在初始化期间： `$('.selector').dialog({ dialogClass: 'noTitleStuff' });`

或者如果你想在初始化之后。：

```
$('.selector').dialog('option', 'dialogClass', 'noTitleStuff'); 
```

所以我创建了一些带有选项 dialogClass='noTitleStuff' 的对话框和这样的 css：

```
.noTitleStuff .ui-dialog-titlebar {display:none} 
```

太简单 ！！但我花了 1 天时间思考为什么我以前的 id->class 钻孔方法不起作用。实际上，当您调用`.dialog()`方法时，您转换的 div 成为另一个 div（真正的对话 div）的子级，并且可能是 div 的“兄弟” `titlebar`，因此很难从前者开始尝试找到后者。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2009-06-21T03:03:20.917

我想出了一个动态删除标题栏的修复程序。

```
$("#example").dialog(dialogOpts);
// remove the title bar
$(".ui-dialog-titlebar").hide(); 
```

这将在对话框呈现后删除所有具有“ui-dialog-titlebar”类的元素。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-06-21T02:42:59.867

我相信你可以用 CSS 隐藏它：

```
.ui-dialog-titlebar {
    display: none;
} 
```

或者，您可以使用以下选项将其应用于特定对话框`dialogClass`：

```
$( "#createUserDialog" ).dialog({
    dialogClass: "no-titlebar"
}); 
```

```
.no-titlebar .ui-dialog-titlebar {
    display: none;
} 
```

查看“[主题](http://api.jqueryui.com/dialog/#theming)”对话框。上述建议使用了该`dialogClass`选项，该选项似乎[正在](http://bugs.jqueryui.com/ticket/12161)支持一种新方法。

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2010-09-18T22:00:19.917

我在我的项目中使用它

```
$("#myDialog").dialog(dialogOpts);
// remove the title bar
$("#myDialog").siblings('div.ui-dialog-titlebar').remove();
// one liner
$("#myDialog").dialog(dialogOpts).siblings('.ui-dialog-titlebar').remove(); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-02-24T11:49:22.397

这对我有用：

```
$("#dialog").dialog({
    create: function (event, ui) {
        $(".ui-widget-header").hide();
    }, 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-08-31T09:19:14.840

尝试使用

```
$("#mydialog").closest(".ui-dialog-titlebar").hide(); 
```

这将隐藏所有对话框标题

```
$(".ui-dialog-titlebar").hide(); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-06-20T21:28:43.507

实际上还有另一种方法可以做到这一点，`widget`直接使用对话框：

你可以得到对话框小部件

```
$("#example").dialog(dialogOpts);
$dlgWidget = $('#example').dialog('widget'); 
```

然后做

```
$dlgWidget.find(".ui-dialog-titlebar").hide(); 
```

`titlebar`仅在该对话框中隐藏

并在一行代码中（我喜欢链接）：

```
$('#example').dialog('widget').find(".ui-dialog-titlebar").hide(); 
```

这种方式不需要在对话框中添加额外的类，直接进行即可。对我来说效果很好。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-01-11T16:56:26.277

*我发现使用open*事件并从那里隐藏标题栏更有效，更易读。我不喜欢使用页面全局类名搜索。

```
open: function() { $(this).closest(".ui-dialog").find(".ui-dialog-titlebar:first").hide(); } 
```

简单的。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-06-04T17:50:40.447

初始化对话框时使用 dialogClass 后可以使用 jquery 隐藏标题栏。

在初始化期间：

```
$('.selector').dialog({
    dialogClass: 'yourclassname'
});

$('.yourclassname div.ui-dialog-titlebar').hide(); 
```

通过使用这种方法，您不需要更改您的 css 文件，这也是动态的。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-05-16T21:19:24.577

我喜欢覆盖 jQuery 小部件。

```
(function ($) {
    $.widget("sauti.dialog", $.ui.dialog, {
        options: {
            headerVisible: false
        },
        _create: function () {
            // ready to generate button
            this._super("_create"); // for 18 would be $.Widget.prototype._create.call(this);
            // decide if header is visible
            if(this.options.headerVisible == false)
                this.uiDialogTitlebar.hide();
        },
        _setOption: function (key, value) {
            this._super(key, value); // for 1.8 would be $.Widget.prototype._setOption.apply( this, arguments );
            if (key === "headerVisible") {
                if (key == false)
                    this.uiDialogTitlebar.hide();
                else
                    this.uiDialogTitlebar.show();
                return;
            }
        }
    });
})(jQuery); 
```

因此，您现在可以设置是否要显示标题栏

```
 $('#mydialog').dialog({
      headerVisible: false // or true
}); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-09-02T18:21:10.890

如果你有多个对话框，你可以使用这个：

```
$("#the_dialog").dialog({
        open: function(event, ui) { 
            //hide titlebar.
            $(this).parent().children('.ui-dialog-titlebar').hide();
        }
    }); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-10-13T13:35:21.847

这是最简单的方法，它只会删除该特定对话框中的标题栏；

```
$('.dialog_selector').find('.ui-dialog-titlebar').hide(); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-06-28T13:11:47.530

试试这个

```
$("#ui-dialog-title-divid").parent().hide(); 
```

替换`divid`为对应的`id`

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-04-13T12:07:46.053

我在隐藏 Dialog 标题栏时发现的一件事是，即使没有显示，屏幕阅读器仍然会选择它并阅读它。如果您已经添加了自己的标题栏，它会同时读取这两个标题栏，从而造成混乱。

我所做的是使用`$(selector).remove()`. 现在屏幕阅读器（以及其他所有人）将看不到它，因为它不再存在。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-08-26T17:55:13.510

下一个表格解决了我的问题。

```
$('#btnShow').click(function() {
  $("#basicModal").dialog({
    modal: true,
    height: 300,
    width: 400,
    create: function() {
      $(".ui-dialog").find(".ui-dialog-titlebar").css({
        'background-image': 'none',
        'background-color': 'white',
        'border': 'none'
      });
    }
  });
});
```

```
#basicModal {
  display: none;
}
```

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/smoothness/jquery-ui.css" />
<div id="basicModal">
  Here your HTML content
</div>
<button id="btnShow">Show me!</button>
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-10-02T00:52:34.357

我认为最干净的方法是创建一个新的 myDialog 小部件，由对话框小部件减去标题栏代码组成。删除标题条码看起来很简单。

[https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.dialog.js](https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.dialog.js)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-10-03T14:43:36.753

这对我有用，可以隐藏对话框标题栏：

```
$(".ui-dialog-titlebar" ).css("display", "none" ); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-04-18T09:25:05.783

这是如何做到的。

转到主题文件夹-> 基础-> 打开 jquery.ui.dialog.css

寻找

关注者

如果您不想显示 titleBar 则只需设置 display:none 就像我在下面所做的那样。

```
.ui dialog.ui-dialog .ui-dialog-titlebar 
{
    padding: .4em 1em;
    position: relative;
        display:none;
} 
```

同样的标题。

```
.ui-dialog .ui-dialog-title {
    float: left;
    margin: .1em 0;
    white-space: nowrap;
    width: 90%;
    overflow: hidden;
    text-overflow: ellipsis;
    display:none; 
} 
```

现在是关闭按钮，您也可以将其设置为无，或者您可以将其设置为

```
.ui-dialog .ui-dialog-titlebar-close {
    position: absolute;
    right: .3em;
    top: 50%;
    width: 21px;
    margin: -10px 0 0 0;
    padding: 1px;
    height: 20px;

   display:none;

} 
```

我做了很多搜索，但什么也没有，然后我就想到了这个想法。但是，这会影响整个应用程序没有关闭按钮，对话框的标题栏，但您也可以通过使用 jquery 并通过 jquery 添加和设置 css 来克服这个问题

这是这个的语法

```
$(".specificclass").css({display:normal}) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-03-31T13:42:16.617

对我来说，我仍然想使用可调整大小的角落，只是不想看到对角线。我用了

```
$(".ui-resizable-handle").css("opacity","0"); 
```

刚刚意识到我在评论错误的问题。不辜负我的同名:(

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-11-30T16:32:36.530

您是否尝试过 jQuery UI 文档的解决方案？ [https://api.jqueryui.com/dialog/#method-open](https://api.jqueryui.com/dialog/#method-open)

正如它所说，你可以这样做......

在 CSS 中：

```
.no-titlebar .ui-dialog-titlebar {
  display: none;
} 
```

在 JS 中：

```
$( "#dialog" ).dialog({
  dialogClass: "no-titlebar"
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-08-04T21:25:06.153

这对我有用

```
 open: function(event, ui) {
            $(".ui-dialog-titlebar", $(this).parent())
              .hide(); 
```

满的

```
$speedbump.dialog({
  dialogClass: 'speedbump-container',
  autoOpen: false,
  closeOnEscape: false,
  modal: true,
  resizable: false,
  draggable: false,
  create: function () {        
      $speedbump
        .closest('.ui-dialog')
        .attr('id', 'speedbump-container');
  },
  open: function(event, ui) {
    $(".ui-dialog-titlebar", $(this).parent())
      .hide();
} 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2013-02-28T15:29:41.820

您可以使用上述技术删除带有关闭图标的栏，然后自己添加一个关闭图标。

CSS：

```
.CloseButton {
background: url('../icons/close-button.png');   
width:15px;
height:15px;
border: 0px solid white;
top:0;
right:0;
position:absolute;
cursor: pointer;
z-index:999;
} 
```

HTML：

```
var closeDiv = document.createElement("div");
closeDiv.className = "CloseButton"; 
```

//将此div附加到包含您的内容的div

JS：

```
 $(closeDiv).click(function () {
         $("yourDialogContent").dialog('close');
     }); 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-08-23T16:44:28.850

转到您的 jquery-ui.js（在我的情况下为 jquery-ui-1.10.3.custom.js）并搜索 this._createTitlebar(); 并发表评论。

现在您的任何对话框都将显示标题。如果您想自定义标题，只需转到 _createTitlebar(); 并编辑里面的代码。

经过

# ruby-on-rails - 动作缓存不起作用

> ID：1023084
> 
> 赞同：0
> 
> 时间：2009-06-21T02:58:01.303
> 
> 标签：ruby-on-rails, xml, hpricot

我在我的 rails 应用程序中从 twitter 和 flickr 获取和操作 XML。结果出现在每个页面上，解析在应用程序控制器中使用 Hpricot 和 open-uri 处理。

这是我对动作缓存的第一次实验，它似乎不起作用。我使用 WEBRick 处于开发模式。在 development.rb 中所有合适的东西都设置为 true。

这是控制器中的内容：

```
 before_filter :twitter, :flickr
  caches_action :twitter, :flickr 
```

/tmp/cache 中没有显示任何内容，很明显 Hpricot 在每次页面加载时都在做这件事。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T03:09:02.153

默认缓存存储是用于操作和片段缓存的内存，因此 tmp/cache 中不会出现任何内容。您可以将其更改为 file_store 以进行调试。

我建议 gem 安装 mongrel 并在开发模式下使用它而不是 webrick。它比 webrick 更快，并且一目了然地提供更好的信息。

缓存操作时，所有之前的过滤器仍会运行。

看起来你正在做的是将你的 twitter 和 flickr 操作作为 before_filter 中的普通旧方法运行。这不会调用缓存。您应该查看片段缓存并将您的控制器更改为：

```
class SomeController
  before_filter :twitter, :flickr

  protected
  def twitter
    unless read_fragment('twitter')
      ... do stuff ...
    end
  end
end

#_twitter.erb
<% cache('twitter') do %>
  render the relevant stuff
<% end %> 
```

# php - php的命令行选项解析，howto

> ID：1023095
> 
> 赞同：3
> 
> 时间：2009-06-21T03:06:46.480
> 
> 标签：php, command-line-interface

我在 PHP 5.2 中使用 Console_Getopt，发现它与其他语言（perl、bash、java）中的 getopt 有多么不同，这让我感到惊讶。谁能推荐如何从返回的数组“$opts”中解析参数？

php myprog.php -a varA -c -b varB

```
$o= new Console_Getopt;
$opts = $o->getopt($argv, "a:b:c");
print_r($opts); 
```

// print_r 在下面返回

```
Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [0] => a
                    [1] => varA
                )

            [1] => Array
                (
                    [0] => c
                    [1] =>
                )

            [2] => Array
                (
                    [0] => b
                    [1] => varB
                )

        )

    [1] => Array
        (
        )

) 
```

我开始做类似下面的事情，这是冗长的，所以我正在寻找关于在 php.ini 中处理命令行标志的建议。

```
foreach($opts[0] as $i -> $keyval) {
    list($key, $val) = $keyval;
    if($key == 'a') {
        print "valueForA: $val\n";
    } else if($key == 'b') {
        print "valueForB: $val\n";         
    } else if($key == 'c') {
        print "c is set\n";
    }
} 
```

我想知道为什么 PHP 的 getopt 不像 perl 的那样，其中数组的键是标志，例如 $opts{'a'} .. 那会很方便。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-29T07:03:53.733

检查 PHP 的 GetOptionKit：

[https://github.com/c9s/php-GetOptionKit](https://github.com/c9s/php-GetOptionKit)

## 概要

```
use GetOptionKit\OptionCollection;
use GetOptionKit\OptionParser;

$options = new OptionCollection;
$options->add( 'f|foo:' , 'option require value' );  # returns spec object.

$options->add( 'b|bar+' , 'option with multiple value' );
$options->add( 'z|zoo?' , 'option with optional value' );

$options->add( 'f|foo:=i' , 'option require value, with integer type' );
$options->add( 'f|foo:=s' , 'option require value, with string type' );

$options->add( 'v|verbose' , 'verbose flag' );
$options->add( 'd|debug'   , 'debug flag' );

$parser = new OptionParser($options);
$result = $parser->parse( array( 'program' , '-f' , 'foo value' , '-v' , '-d' ) );

$spec = $result->verbose;
$spec = $result->debug;
$spec->value;  # get value 
```

GetOptionKit\OptionPrinter 可以为您打印选项：

```
* Available options:
              -f, --foo   option requires a value.
              -b, --bar   option with multiple value.
              -z, --zoo   option with optional value.
          -v, --verbose   verbose message.
            -d, --debug   debug message.
                 --long   long option name only.
                     -s   short option name only. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T03:36:08.260

根据内联文档

> 返回值是一个包含两个元素的数组：已解析选项列表和非选项命令行参数列表。已解析选项列表中的每个条目都是一对元素 - 第一个指定选项，第二个指定选项参数，如果有的话。

这意味着您可以轻松丢弃第二个数组，并承诺保留数组数组、第一个元素选项、第二个元素值、格式。

有了这个假设，尝试

```
$o= new Console_Getopt;
$opts = $o->getopt($argv, "a:b:c");
print_r(getHashOfOpts($opts));

function getHashOfOpts($opts) {
    $opts = $opts[0];
    $return_opts = $opts;
    $return_opts = Array();
    foreach($opts as $pair){
        $return_opts[$pair[0]] = $pair[1];
    }
    return $return_opts;
} 
```

获得更喜欢的数据结构。

至于为什么这与 getopt 的其他实现不同，请询问[维护](http://pear.php.net/package/Console_Getopt)人员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T09:44:33.670

我围绕 getopt() 编写了一个包装类，类似于 Console_GetOpt，但我认为更好一些。

你可以在这里找到它：http: [//github.com/pete-otaqui/ClipClop](http://github.com/pete-otaqui/ClipClop)

基于 getopt() 的 PHP 选项解析器。

ClipClop 允许您轻松创建带有选项的命令行工具。ClipClop 自动生成格式良好的使用说明，并提供方便的 API 用于访问参数和值。

ClipClop 处理必需和可选参数以及它们的值。因此，诸如“--verbose”之类的给定选项本身可以是必需的或可选的，它可以没有参数值，也可以是可选的，也可以是必需的。

ClipClop 管理多个值，尽管默认情况下强制执行单个值，可以根据正则表达式进行验证，并可以为您解析出某些类型：整数、数字、json 和 url。

快速示例使用以下代码创建一个名为“environment_test”的脚本

```
#!/usr/bin/env php
<?php

// do this unless you have setup an Autoloader
require_once('/path/to/ClipClop.php');

$clipclop = new ClipClop();

$clipclop->addOption(array(
    'short' => 'e', // shortname, i.e. "-e"
    'long' => 'environment', // longname, i.e. "--environment"
    'value' => TRUE, // A value must be given such as "--environment=TEST"
    'help' => 'Set the environment', // help text for the 'usage' text
    'required' => TRUE, // Environment must be provided
));

// as soon as we ask for an option, ClipClop will parse CLI arguments with getopt()

$environment = $clipclop->getOption('e'); // returns the value set for 'e' OR 'environment'

print "You ran this script with environment: $environment";
?> 
```

它包括各种其他选项和单元测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-31T19:19:57.473

对于它的价值，我最近破解了我自己的一个小项目，用于在 PHP 中解析命令行选项。我称它为*Pharse*（类似于“PHP Parse”……之类的）。可以在 github 上下载：

[https://github.com/chrisallenlane/Pharse](https://github.com/chrisallenlane/Pharse)

它深受[Trollop](http://trollop.rubyforge.org/)的启发，你几乎可以认为它是一个端口，尽管我没有实现 Trollop 的所有功能。（出于我自己的目的，我不需要一些功能——比如子命令——所以我没有打扰。）

该库的一般要点是它的用法涉及需要一个基本文件，然后将 Pharse 类传递给一个单一的关联选项数组。例如：

```
 <?php

   # specify some options
   $options = array(
        'user_name'     => array(
            'description'   => 'Your username',
            'default'       => 'admin',
            'type'          => 'string',
            'required'      => true,
            'short'         => 'u',
        ),

        'password' => array(
            'description'   => 'Your password',
            'default'       => 'sexsecretlovegod',
            'type'          => 'string',
            'required'      => true,
        ),
    );

# You may specify a program banner thusly:
$banner = "This program logs you in to the Gibson.";
Pharse::setBanner($banner);

# After you've configured Pharse, run it like so:
$opts = Pharse::options($options);

?> 
```

我在这里写了一篇介绍该库的博客文章：

[http://chris-allen-lane.com/2012/03/pharse-a-library-for-php-command-line-option-parsing/](http://chris-allen-lane.com/2012/03/pharse-a-library-for-php-command-line-option-parsing/)

我为我的个人项目临时使用了这个库，所以在将此脚本部署到生产环境之前我会谨慎行事。我什至还没有开始实施适当的单元测试，所以请注意。

尽管如此，我认为这是一个非常漂亮的小脚本，我认为它非常适合业余项目等。

# php - 注意：未定义的索引

> ID：1023099
> 
> 赞同：1
> 
> 时间：2009-06-21T03:09:45.957
> 
> 标签：php, sql

```
$thread_id = (isset($_GET['id']));
$thread_id = intval($_GET['id']);

$q = mysql_query("SELECT * FROM threads WHERE id = $thread_id"); 
```

你不能在一个变量上使用两个函数吗？如您所见，我检查了它是否已设置，但它仍然给了我：

*注意：未定义索引：第 7 行 C:\wamp\www\bfhq\thread.php 中的 id*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T03:13:41.550

尝试这个：

```
$thread_id = isset($_GET['id']) ? intval($_GET['id']) : 0; 
```

读作“如果`$_GET['id']`设置，设置`$thread_id`为`intval($_GET['id'])`，如果没有，设置为0”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T03:13:32.503

isset() 返回一个布尔值：TRUE / FALSE。如果要确定是否设置了 $_GET["id"]，则需要在 IF 语句中或通过三元运算符进行。

```
if (isset($_GET["id"])) {
  $thread_id = $_GET["id"]; // Bad idea taking values in from $_GET directly
} else {
  die("Thread id not set");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T03:19:11.867

此错误取决于 php.ini 中设置的错误/警告级别。使用它的好习惯...

```
array_key_exists('id', $_GET); 
```

[http://us2.php.net/manual/en/function.array-key-exists.php](http://us2.php.net/manual/en/function.array-key-exists.php)

另外：确保在执行此操作之前对 $_GET 中的输入进行清理。你让自己对 mysql 注入持开放态度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T03:31:57.660

[您只需使用error_reporting(4);](http://www.php.net/manual/en/function.error-reporting.php)即可摆脱所有通知。. 另一种可能是粗略但有效的抑制通知和清理变量的方法可能是：

```
$thread_id = (int)@$_GET["id"]; 
```

如果你做了很多这些事情，你可能想看看[filter_var()](http://au2.php.net/filter_var)并将所有功能放入一个单独的函数中（例如 get_int("id")）。

# c# - C# 程序结构

> ID：1023103
> 
> 赞同：0
> 
> 时间：2009-06-21T03:11:54.380
> 
> 标签：c#

我还在学习 C#，没有做过大型程序，只做过控制台应用程序。我正在阅读 Pro C# 3.5，我有以下问题。

1.  我看到 C# 有枚举，如何在大型程序上创建枚举？它们是在一个 C# 文件中创建的吗？还是它们分布在不同的 .cs 文件上？

2.  另外，当我在 C# express 中使用 Intellisense 时，我看到有数据类型字符串和字符串（带有大 S），它们是一样的吗？我检查了对象浏览器，我认为它们指向同一个类。

3.  这是一个相当琐碎的问题。我以前用 java 编程过，它们具有没有任何继承层次结构的原始数据类型。但是当我继续探索 C# 时，我注意到 C# 中的 ints、double、float 具有一些继承层次结构，因为它们继承自 System.ValueType。这是否意味着 C# 比 java 更 OO（面向对象）？不过我不确定这一点，因为从书中看， System.ValueType 不是一个具体的类。

抱歉，如果我的问题可能含糊不清，但我只是一个尝试学习的初学者。希望你对我有耐心。

也感谢这个网站推荐这本书，我真的很喜欢它教授主题的方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T03:20:01.537

1.) 枚举可以在您想要的任何地方创建，但将它们放在命名空间中逻辑上有意义的位置始终是一个很好的经验法则。我通常在名为 Constants.cs 的命名空间文件夹的根目录中有一个文件，或者包含该命名空间的枚举的文件。

2.)`string`映射到，`System.String`所以它们是等价的。

3.) CLR 中的所有内容都源自`System.Object`. CLR 中基本上有两种类型的对象，引用类型和值类型。所有原始类型和枚举都是值类型，这就是它们派生自`System.ValueType`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T03:23:14.357

我可以尝试回答您的问题：

1.  我尽量让我的枚举靠近需要它们的地方。也就是说，它们要么位于将要使用的同一个文件中（如果仅用于一个或两个位置），要么位于同一个文件夹中。（通用代码的本地化。）例如，我最近制作了一个 NavalBattle 游戏，并且有一个瓷砖类型（深水、浅水、陆地）的枚举以及一个命令类型（攻击、移动、投降）的枚举。我发现使用 TileType.Land 比使用更大的枚举包含所有内容要干净得多。

2.  他们是一样的。

3.  您可能想阅读： http: [//msdn.microsoft.com/en-us/library/ms228360 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms228360(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T03:24:49.890

1）枚举可以在任何你喜欢的地方完成。它们可以在同一个文件中，一个不同的文件但属于同一个类，我认为您甚至可以将它们放在对象中，但不要引用我的话。

2）它们是相同的，我相信这个答案与 3 相关。

3) C# 中的原语实际上是对象。这是否使它比 Java 更面向对象？这取决于您对面向对象的定义。如果您认为一种语言带来的数据类型决定了一种语言的 OO 程度，那么是的，C# 比 Java 更面向对象。如果您觉得它与您编写代码的方式以及对象的工作方式有关，那么就值得讨论，但我认为它们在这方面大致相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T03:27:28.997

1.  决定在哪里定义枚举取决于您使用的编码风格我更喜欢将定义保持在靠近它用于其主要处理的位置。
2.  String 和 string 是一回事，Int32 是 int，UInt32 是 uint，object 是 Object
3.  C# 中的一切都派生自 Object，值类型派生自 ValueType，ValueType 派生自 Object。从 ValueType 派生的东西会被特殊对待，因为它们可能会保留在堆栈中，尽管不能保证这一点。[有关更多信息，Eric Lippert 在http://blogs.msdn.com/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx](http://blogs.msdn.com/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx)上对 C# 中的堆栈进行了很好的讨论

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T03:41:08.937

1.  通常，这取决于您，但您应该尝试使放置与使用枚举的类互补。因此，将枚举放置在与使用它的类相同的命名空间（理想情况下意味着相同的项目目录）中是很常见的。或者，将所有枚举放入“ProjectNamespace.Constants”的行中也并不罕见。想象一下，当您使用一个将枚举作为参数的类时。找到它几乎不需要任何时间。

2.  他们是一样的。另外，请注意，其他类似的快捷方式（如“int”）映射到完全限定的名称，如 System.Int32。意识到这些也很重要。

3.  一切都派生自 System.Object 并从那里分支为值和引用类型。为了解决这个问题，可以尝试创建一个结构来理解值类型和一个类来理解引用类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T03:18:40.277

1.  您可以在任何现有的 .cs 文件或 .cs 文件本身中创建/声明枚举（尽管我建议使用单独的文件）。这与创建/声明类、结构等相同。

2.  字符串和字符串是同一类型。string 是映射到 CLR String 类型的 C# 内在类型。

3.  不确定您所说的“更多 OO”是什么意思。值类型仍然使用堆栈而不是堆。

# azure - Microsoft Azure 如何处理会话状态？

> ID：1023108
> 
> 赞同：22
> 
> 时间：2009-06-21T03:15:43.340
> 
> 标签：azure, session-state, azure-web-roles

当您选择拥有多个实例时，是否有人知道 Azure 中如何管理状态？InProc 似乎毫无价值，您必须拥有另一个状态服务器实例，或者使用数据存储跨服务器存储用户状态。

或者它是否实现了粘性会话，所以 InProc 就是你所需要的。

在这里找到答案： [Azure 论坛](http://social.msdn.microsoft.com/Forums/en-US/windowsazure/thread/2d1340ed-0ad0-456a-b069-aa6b85672102/)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-21T03:23:59.033

表存储将是最合乎逻辑的地方。其他服务器场类型设置也使用数据库表来存储会话信息。

查看 Windows Azure SDK 示例中的 AspProviders 项目。它有一个使用 Azure 表存储的 SessionState 提供程序。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-04-30T03:56:51.853

AppFabric Cache 刚刚投入生产，这是管理会话数据的绝佳方式。事实上，它有一个自定义会话状态提供程序，只需放入 web.config。你可以在 Azure 门户中找到它。

有关缓存大小、定价和 SLA 的所有信息都[在这里](http://msdn.microsoft.com/en-us/library/gg602420.aspx#CACHING_FAQ)。

**编辑**：Windows Azure Web 角色模板现在包括新的 ASP.NET 通用提供程序，包括支持 SQL Azure 的会话状态提供程序。查看 Nate Totten 的[博客文章](http://ntotten.com/2011/08/windows-azure-tools-1-4-released/)了解更多详情。

**编辑 2012 年 7 月 8 日**Windows Azure 现在提供缓存角色和内存缓存（都可以使用最新工具和 v1.7 SDK 轻松配置）。内存缓存将缓存分布在您现有的角色实例中，利用一定百分比的 RAM（如果您的应用程序中不需要太多 RAM，这是一个不错的“免费”选项）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-25T23:13:19.690

不需要会话亲和性，因此使用依赖`Azure storage`或是`SQL Azure storage`最佳选择的会话状态提供程序。

对于某些遗留应用程序，您可能仍需要会话亲和性。对于这些情况，介于`Azure load balancer`和 之间的ARR`Web farm`是一个选项。

更多详情请访问[http://go.archims.fr/hW54Xz](http://go.archims.fr/hW54Xz)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T13:41:37.037

另一种选择是使用粘性 http 会话：

[http://dunnry.com/blog/2010/10/14/StickyHTTPSessionRoutingInWindowsAzure.aspx](http://dunnry.com/blog/2010/10/14/StickyHTTPSessionRoutingInWindowsAzure.aspx)

然后你可以使用 InProc。

# perl - 如何在 Windows 上使用 Perl 将 WMF 图像转换为 PNG 或 JPG？

> ID：1023112
> 
> 赞同：2
> 
> 时间：2009-06-21T03:17:10.593
> 
> 标签：perl, module, png, jpeg, wmf

有没有人知道允许将 WMF 图像转换为 PNG 或 JPEG 格式的 Perl 模块？我搜索了 CPAN，但没有找到任何东西。

由于安装限制，必须是 Perl 模块并在 Windows 上工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T03:20:52.567

我听说过[ImageMagick](http://www.imagemagick.org/script/index.php)的好消息，虽然我没有亲自使用过它。看起来它会进行[转换](http://www.imagemagick.org/script/formats.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T03:22:15.387

[图片::Magick](http://search.cpan.org/dist/PerlMagick/Magick.pm)可能是要走的路。

# jquery - 如何清除文本框onfocus？

> ID：1023135
> 
> 赞同：25
> 
> 时间：2009-06-21T03:29:00.630
> 
> 标签：jquery

我已经尝试过了，但它不起作用：

```
$(function() {
    $('input[type=text]').focus(function() {
      $(this).val() == '';
      });
 }); 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-21T03:30:17.197

要设置该值，您必须将新值作为参数传递。这是 .val() jQuery 函数的一个时髦的东西。

```
$(this).val('') 
```

查看[jQuery API](http://api.jquery.com/)并搜索“val”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-23T00:09:27.203

有点晚了，但另一种方法是这样

[链接文本](http://snipplr.com/view/11429/jquery-input-value-select/)

当您单击输入框时，只有当它是框中的默认值时，它才会选择所有文本（不清楚）。这样，如果用户键入某些内容然后必须返回编辑它，它不会被清除，这可能会很烦人！

同样选择文本而不是清除它会提醒用户该示例。我猜要记住一个。

# continuous-integration - 是否可以延迟在 Hudson 上构建 CI 直到提交活动逐渐减少？

> ID：1023137
> 
> 赞同：4
> 
> 时间：2009-06-21T03:29:47.930
> 
> 标签：continuous-integration, hudson

这是我第一次设置 Hudson，我想以以下方式进行触发器构建：

（我们使用的是 SVN）

*   在提交之后，但只有在一段时间内没有提交活动之后。如果它们发生在一些小的时间增量内，我不想为每个提交触发构建。例如，在提交时标记待处理的构建/任务，但要等到一段时间内没有更多提交发生。

我不想在每个时间段都触发构建 - 我希望时间段和提交已经发生。另请注意，如果最后一次提交是最近的，则不应进行构建 - 我们需要等待一些不活动。

我可能最终会进行每日构建。我真的对每次提交的独特构建感到畏缩。现在 Win32 构建需要 20 分钟到一个小时，具体取决于机器。当我们有跨平台构建时，这也将是巨大的。

我也对在每次提交上进行构建的评论和论点持开放态度。（请注意，其中一位开发人员的模式是提交几组不同的文件 - 连续提交。）我宁愿不花费所有的 cpu 周期和磁盘空间来构建将在一分钟内无用/丢弃的构建或两个。我也不认为同时运行多个构建（hudson 是这样做还是等待构建完成）是有用的/可取的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T03:38:37.087

只需在每个项目的配置下设置构建的安静期。

[替代文字 http://img40.imageshack.us/img40/6357/hudsonquietperiod.png](http://img40.imageshack.us/img40/6357/hudsonquietperiod.png "哈德逊的安静时期")

你只需要超过 5 秒。

Hudson 一次可以进行多个构建，您只需要设置额外的[构建从站](http://wiki.hudson-ci.org/display/HUDSON/Distributed+builds)。

# asp.net - 无法将类型“System.Collections.Generic.List”隐式转换为“System.Collections.Generic.List”

> ID：1023140
> 
> 赞同：2
> 
> 时间：2009-06-21T03:33:22.573
> 
> 标签：asp.net

```
Cannot implicitly convert type 'System.Collections.Generic.List' to 'System.Collections.Generic.List

Error 2 Cannot implicitly convert type 'System.Collections.Generic.List<AnonymousType#1>' to 'System.Collections.Generic.List<Product>' D:\Fortune\App_Code\BL\StoreController.cs 204 45 D:\Fortune\

public static List<Product> GetProductsByCategoryID(int productCategoryId )
{
    FortuneDataContext db = SiteController.GetNewFortuneDataContext();
    List<Product>  prods = (from p in db.Products
                        join pc in db.ProductCategories 
                        on p.ProductCategoryId equals pc.ProductCategoryId 
                        where pc.ParentProductCategoryId == productCategoryId
                        select new
                        {
                           p.ProductId,
                           p.ProductCategoryId,
                           pc.ParentProductCategoryId,               
                           ProductName = p.Name,
                           Category = pc.Name,
                           p.Price,
                           p.ProductYear
                           }).ToList();  
    return prods;

} 
```

我想获取 select new {...} 中的所有字段，我这样写选择，但所有字段都不在 Product 表中.....

```
 select new Product
                    {
                       p.ProductId,
                       p.ProductCategoryId,
                       pc.ParentProductCategoryId,               
                       ProductName = p.Name,
                       Category = pc.Name,
                       p.Price,
                       p.ProductYear
                       }).ToList(); 
```

我该如何写声明？请.....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-14T13:08:26.903

而不是**select new**，使用**select new Product**。它将返回 Product 类型的列表：

```
...         
select new Product                   
{
    p.ProductId,
    p.ProductCategoryId,
    pc.ParentProductCategoryId,                                          
    ProductName = p.Name,                           
    Category = pc.Name,                           
    p.Price,                           
    p.ProductYear                           
}).ToList();      

return prods; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T03:41:26.720

您正在此行中选择匿名类型：

```
select new { ... } 
```

试试这条线：

```
select p 
```

如果您尝试返回 a `List<Product>`，您将无法将`ProductCategory`信息放入返回的列表中，除非`Product`具有链接到 的导航属性`ProductCategory`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T03:35:44.050

当您将 List 声明为一种类型时，您应该考虑添加正确的模板

例如

```
public static List<Product> GetProductsByCategoryID(...) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T04:24:05.593

您正在创建一个匿名类型，并且您不能从一个方法返回一个匿名类型（实际上有一种方法，但与仅创建一个新类相比它很复杂并且不值得），并且它与签名不匹配的列表。因此，您必须创建一个新类，其中包含您想要的所有属性的定义，例如 ProductDetails，并返回一个列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T13:02:26.797

我遇到了同样的问题..你应该`List<Product> prods` 改为`var prods`

# vim - MacVim 和 XHTML 的问题

> ID：1023143
> 
> 赞同：0
> 
> 时间：2009-06-21T03:36:46.433
> 
> 标签：vim

我对 MacVim 有疑问。每当我尝试更改 xhtml 元素的类属性中的单词时，MacVim 都会显示错误，如下所示：

[图片](http://img8.imageshack.us/img8/2527/picture1cfa.png) [替代文字 http://img8.imageshack.us/img8/2527/picture1cfa.png](http://img8.imageshack.us/img8/2527/picture1cfa.png)

这真的很烦人。我猜这个错误来自全能。我正在使用的插件：autocomplpop、F6_comment、matchit、snipMate、NERDTree、fuzzyfinder_textmate

我在 ubuntu 中的 GVim 不会出现这个问题。请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T20:56:29.827

搜索您的错误时，我发现[有人报告了与 omni-complete 类似的问题](http://markmail.org/search/%22processing+function+htmlcomplete%22)。回复建议在较旧版本的omni-complete 中，变量`g:xmldata_xhtml10s`是在外部定义的，这有时会导致问题。

您可以尝试更新插件并重试吗？

# ruby - 在 Ruby 中显式返回是一种好的风格吗？

> ID：1023146
> 
> 赞同：164
> 
> 时间：2009-06-21T03:38:11.813
> 
> 标签：ruby, coding-style, return-value

来自 Python 背景，在风格方面总是有一种“正确的方式”（一种“Pythonic”方式），我想知道 Ruby 是否也存在同样的情况。我一直在使用自己的风格指南，但我正在考虑发布我的源代码，并且我希望它遵守任何可能存在的不成文规则。

显式输入方法是“Ruby 方式”`return`吗？我已经看到它有没有完成，但是有正确的方法吗？是否有合适的*时间*去做？例如：

```
def some_func(arg1, arg2, etc)
  # Do some stuff...
  return value # <-- Is the 'return' needed here?
end 
```

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2012-11-29T21:27:59.523

旧的（和“已回答的”）问题，但我会投入两分钱作为答案。

TL;DR - 您不必这样做，但在某些情况下它可以使您的代码更加清晰。

尽管不使用显式返回可能是“Ruby 方式”，但对于使用不熟悉代码或不熟悉 Ruby 的此功能的程序员来说，这会让人感到困惑。

这是一个有点人为的例子，但想象一下有一个像这样的小函数，它将传递的数字加一，并将其​​分配给实例变量。

```
def plus_one_to_y(x)
    @y = x + 1
end 
```

这是否意味着是一个返回值的函数？很难说开发人员的意思是什么，因为它既分配了实例变量，又返回了分配的值。

假设很久以后，另一个程序员（可能不太熟悉 Ruby 如何根据执行的最后一行代码返回结果）出现并想要放入一些打印语句进行日志记录，并且函数变成了这个......

```
def plus_one_to_y(x)
    @y = x + 1
    puts "In plus_one_to_y"
end 
```

*现在，如果有任何东西需要返回值*，该函数就会被破坏。如果没有任何东西期望返回值，那很好。很明显，如果在代码链的某个地方，调用它的东西期望返回值，它将失败，因为它没有得到预期的结果。

现在真正的问题是：真的有什么期望返回值吗？这是否破坏了某些东西？它会在未来破坏一些东西吗？谁知道！只有对所有调用进行完整的代码审查才能让您知道。

所以至少对我来说，最佳实践方法是要么非常明确地表明你正在返回一些重要的东西，要么在它不重要时什么都不返回。

所以在我们的小演示函数的情况下，假设我们希望它返回一个值，它会这样写......

```
def plus_one_to_y(x)
    @y = x + 1
    puts "In plus_one_to_y"
    return @y
end 
```

任何程序员都非常清楚它确实返回了一个值，而且他们更难在没有意识到的情况下破坏它。

或者，可以这样写，省略 return 语句......

```
def plus_one_to_y(x)
    @y = x + 1
    puts "In plus_one_to_y"
    @y
end 
```

但是为什么要省去返回这个词呢？为什么不把它放在那里，让它 100% 清楚发生了什么？它实际上不会影响您的代码的执行能力。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-06-21T03:41:26.113

不。好的 Ruby 风格通常只使用显式返回来*提前返回*。Ruby 擅长代码极简主义/隐式魔法。

也就是说，如果显式返回会使事情变得更清晰或更易于阅读，那么它不会损害任何东西。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-06-21T08:29:17.793

我个人使用`return`关键字来区分我所谓的*函​​数方法*，即主要为返回值执行的方法和主要为副作用执行的*过程方法。*因此，在返回值很重要的方法中，获取一个额外的`return`关键字来引起对返回值的注意。

*我在调用*方法时使用相同的区别：函数式方法有括号，而过程式方法没有。

最后但并非最不重要的一点是，我还将这种区别与块一起使用：功能块得到花括号，程序块（即“做”某事的块）得到`do`/ `end`。

但是，我尽量不要对此感到虔诚：块、花括号和`do`/`end`有不同的优先级，而不是添加显式括号来消除表达式的歧义，我只是切换到另一种风格。方法调用也是如此：如果在参数列表周围添加括号使代码更具可读性，我会这样做，即使所讨论的方法本质上是程序性的。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-07-30T12:09:33.860

实际上，重要的是要区分：

1.  函数 - 为其返回值执行的方法
2.  过程 - 为其副作用执行的方法

Ruby 没有本地方式来区分这些 - 这使您很容易编写过程`side_effect()`并且另一个开发人员决定滥用您的过程的隐式返回值（基本上将其视为不纯函数）。

要解决这个问题，请参考 Scala 和 Haskell 的书，并让您的*过程*显式返回`nil`（又名`Unit`或`()`其他语言）。

如果您遵循这一点，那么是否使用显式`return`语法只是个人风格的问题。

进一步区分函数和过程：

1.  复制 Jörg W Mittag 的好主意，即用花括号编写功能块，用花括号编写程序块`do/end`
2.  调用过程时，使用`()`，而调用函数时，不要

请注意，Jörg W Mittag 实际上提倡相反的方式 - 避免`()`s 用于过程 - 但这是不可取的，因为您希望副作用方法调用与变量清楚地区分，特别是当 arity 为 0 时。请参阅[Scala style guide on method invocation](http://docs.scala-lang.org/style/method-invocation.html) for细节。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-01-24T17:00:01.707

[样式指南](https://github.com/bbatsov/ruby-style-guide#no-explicit-return)指出，您不应该`return`在最后一个语句中使用。[如果不是最后一个，](https://github.com/bbatsov/ruby-style-guide#no-nested-conditionals)您仍然可以使用它。这是社区严格遵守的约定之一，如果您打算与任何使用 Ruby 的人合作，您也应该如此。

* * *

话虽如此，使用显式`return`s 的主要论点是它会让来自其他语言的人感到困惑。

*   首先，这并不完全是 Ruby 独有的。例如 Perl 也有隐式返回。
*   其次，这适用于大多数人来自 Algol 语言。其中大多数都比 Ruby *“低级”*，因此您必须编写更多代码才能完成任务。

java 中方法长度（不包括 getter/setter）的常见启发式方法是*one screen*。在这种情况下，您可能看不到方法定义和/或已经忘记了您从哪里返回。

另一方面，在 Ruby 中，最好坚持使用[少于 10 行的](https://github.com/bbatsov/ruby-style-guide#short-methods)方法。鉴于此，人们会想知道为什么他必须多写约 10% 的陈述，而这些陈述是明确暗示的。

* * *

由于 Ruby 没有*void*方法，而且一切都更加简洁，因此如果使用显式`return`s，则只会增加开销，而不会带来任何好处。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-01-30T20:49:13.583

我同意 Ben Hughes 的观点，但不同意 Tim Holt 的观点，因为这个问题提到了 Python 的明确方式，并询问 Ruby 是否有类似的标准。

[确实如此。](https://github.com/bbatsov/ruby-style-guide#no-explicit-return)

这是该语言的一个众所周知的特性，任何希望在 ruby​​ 中调试问题的人都应该合理地期望知道它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-21T03:54:25.540

这是您最喜欢哪种风格的问题。如果要从方法中间的某个位置返回，则必须使用关键字 return。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-21T03:50:25.383

正如本所说。“ruby 方法的返回值是函数体中最后一条语句的返回值”这一事实导致 return 关键字在大多数 ruby​​ 方法中很少使用。

```
def some_func_which_returns_a_list( x, y, z)
  return nil if failed_some_early_check

  # function code 

  @list     # returns the list
end 
```

# c# - C# 将字典移动到另一个文件中

> ID：1023154
> 
> 赞同：0
> 
> 时间：2009-06-21T03:42:48.653
> 
> 标签：c#, asp.net, class, dictionary

 `````
namespace Webapplication1
{  

Public Class MyDictionaries : WebApplication1._Default
{

public static idictionary<string, label> LabelDict = new dictionary<string, label>()
{

     {"name", label1}

}

} 
```

}`  `嗨，大家好。我试图将字典从我的代码隐藏文件中分离到一个单独的类文件中。但是当我这样做时，当我尝试构建项目时，出现“非静态字段、方法或属性需要对象引用”错误。我不确定我做错了什么。

目标：将字典移动到单独的类文件中，并且仍然能够像在代码隐藏文件中一样使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T03:45:48.570

如果`label1`是类中的非静态变量，`WebApplication1._Default`那么您不能从静态上下文中访问它。要么`LabelDict`需要是非静态的，要么`label1`需要设为静态。大概是后者。``

# html - Float 创建重叠的 div

> ID：1023159
> 
> 赞同：12
> 
> 时间：2009-06-21T03:47:10.813
> 
> 标签：html, css

我有两个 div（一个在另一个里面），当我将里面的一个浮动到“左”时遇到了一些问题。问题是外部 div 没有扩展其高度以适应内部 div 内部的文本。由于这可能很令人困惑，我将尝试用一些代码来解释它。

HTML：

```
<body>
    <div id="div1">
        Inner Div:
        <div id="div2">Testing long content.</div>
    </div>
</body> 
```

CSS：

```
#div2 {
    float: left;
    width: 10px;
} 
```

我宁愿希望在测试时这实际上表明了我的问题，因为我没有机会对此进行测试。我的真实代码有更多属性，如果需要，我会提出这些属性。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-21T03:49:03.760

您需要使用清除修复。在浮动 div 之后和包含的 div 中插入以下内容。

```
<div class="clear"></div> 
```

并添加以下样式：

```
.clear { clear:both; } 
```

例子：

```
<div class="container">
  <div class="floatedDiv">Hello World</div>
  <div class="clear"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-21T11:45:12.857

如果您不想在 html 中添加额外的标记或在外部 div 中添加宽度，可以使用：

```
#div1 {
    overflow:hidden;   /* clears float for most browsers */
    zoom:1;            /* clears float for IE6           */
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-21T17:47:18.397

[可能需要注意的是，还有来自positioniseeverything](http://www.positioniseverything.net/easyclearing.html)的众所周知的 clearfix 代码，它是专门为这个问题编写的，可能是最健壮和最容易在任何情况下应用的。CSS 如下所示：

```
<style>
div.clearfix:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; }
div.clearfix { display: inline-block; margin: 0 0 8px 0; }
/* Hides from IE-mac \*/
* html div.clearfix { height: 1%; }
div.clearfix { display: block; }
/* End hide from IE-mac */
</style> 
```

为了在您的情况下使用它，您将执行以下操作：

```
<body>
<div id="div1" class="clearfix" >Inner Div:
<div id="div2">Testing long content.</div>
</div>
</body> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T03:49:55.133

（今天第三次:-)）给外层div溢出：隐藏；
和宽度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-22T08:26:18.123

虽然上面的解决方案应该有效，但我认为值得指出的是，我还没有看到一个神奇的技巧（在这个线程中）。

只需向左浮动#div1。当您浮动父元素时，它会自动清除子元素 - 非常有用，真的。您可以构建浮动堆栈的整个布局，然后在最后进行最终清除，这将是相当可靠的。

# c# - C# 请求队列

> ID：1023172
> 
> 赞同：3
> 
> 时间：2009-06-21T04:03:22.733
> 
> 标签：c#, asp.net, request-queueing

我的 Web 服务使用另一个 API 来获取数据。我缓存数据，清理它并在用户发出请求时将其返回给用户。目前我收到了很多请求，因为我每秒只能访问数据 API 2 次，所以我收到了错误，这意味着一些用户没有得到数据而其他用户得到了。

我想要做的是将每个请求添加到一个队列中并一个一个地处理它们，它们之间有 0.4 秒的睡眠。他必须一直运行队列以确保处理所有请求。

我将如何在 ASP.NET 3.5 中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T04:10:34.653

简而言之，我建议您创建一个 Windows 服务来处理 MSMQ 队列。您现有的 Web 服务会将请求放入该队列。

但是，您的服务需要成为异步 Web 服务。这样，在“等待”响应时，您的服务不会阻塞请求线程。

顺便说一句，您使用的是 ASMX Web 服务还是 WCF 服务？这将决定如何使服务异步。

# ruby-on-rails - Ruby on Rails：表单选择

> ID：1023173
> 
> 赞同：7
> 
> 时间：2009-06-21T04:04:13.153
> 
> 标签：ruby-on-rails, forms, select

我有一个表单，我想显示一个下拉菜单，显示一个人的年龄选择。范围是从 18 到 99。我如何使用表单选择助手来做到这一点？是不是有点像：

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-21T09:36:39.043

```
<%= f.select :age, (18..99) %> 
```

问题是 ['18'..'99'] 没有返回你所期望的。['18'..'99'] 不是一个范围，而是一个 1 大小的数组，其中唯一一项的值为 ['18'..'99']。

```
>> ['18'..'99'].class
=> Array
>> ['18'..'99'].size
=> 1
>> ['18'..'99'].first
=> "18".."99" 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-21T04:08:09.757

```
<%= select(@object, :age, (18..99).to_a) %> 
```

select 是在 FormOptionsHelper 中定义的，所以界面有点不同。

# objective-c - 从属性列表中读取 NSDictionary Keys

> ID：1023175
> 
> 赞同：2
> 
> 时间：2009-06-21T04:05:38.040
> 
> 标签：objective-c, cocoa, dictionary

在我的项目中，我使用 propertyList 来维护数据。plist 文件名为“DataBase.plist”。DataBase.plist 的根是一个字典，其中包含 5 个字典作为子项...现在子字典包含 4 个字符串，其中一个始终是带有键“URL”（不带引号）的网址 .... i' m 运行以下代码来提取此 URL 键的值，但它不工作..

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"DataBase" ofType:@"plist"];
NSDictionary *rootDict = [[NSDictionary alloc] initWithContentsOfFile:path];
NSString *URLforAll = [[NSString alloc] init];
for (id key in rootDict)
{
    if(key == rowString)
    {
        NSDictionary *dict = [rootDict objectForKey:key];
        URLforAll = [dict objectForKey:@"URL"];
    }
} 
```

rowstring 是一个字符串，其值与所选单元格中的文本相同（我已经测试过了，它是准确的）。如果可以的话，请帮帮我....我会很感激的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T02:01:38.553

此外，在您的代码中：

```
NSString *URLforAll = [[NSString alloc] init]; 
```

这永远没有意义。这里有一些问题：

*   您分配了一个对象，然后用`URLforAll = [dict objectForKey:@"URL"];`. 所以你需要在覆盖它之前释放它。
*   它被分配（即，在循环结束时，你“拥有”它并且必须释放它。但 `[dict objectForKey:@"URL"]`返回一个你不拥有的对象。所以在循环结束时，你不知道是否您是否拥有 URLforAll。
*   最后，`[[NSString alloc] init]`永远不会有意义，因为您应该只使用`@""`，它返回一个常量，空的，`NSString`不受`retain/release/autorelease`问题影响。

还处理 isEqualToString 问题，但忽略 amrox 更好的解决方案，代码将是：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"DataBase" ofType:@"plist"];
NSDictionary *rootDict = [[NSDictionary alloc] initWithContentsOfFile:path];
NSString *URLforAll = @"";
for (id key in rootDict) {
        if ( [key isEqualToString:rowString] ) {
                NSDictionary *dict = [rootDict objectForKey:key];
                URLforAll = [dict objectForKey:@"URL"];
        }
}
[[URLforAll retain] autorelease];
[rootDict release]; 
```

请注意，很`objectForKey`可能会返回对对象的内部引用，当您释放字典时该对象将变为无效，因此如果您想保留对象比字典的生命周期更长，则需要保留该对象。

amrox 的用途：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"DataBase" ofType:@"plist"];
NSDictionary *rootDict = [[NSDictionary alloc] initWithContentsOfFile:path];
NSString *URLString = [[rootDict objectForKey:key] objectForKey:@"URL"];
[[URLString retain] autorelease];
[rootDict release];
if ( !URLString ) {
    URLString = @"";
} 
```

是一个更好的解决方案，但您也应该了解您的原始解决方案有什么问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T04:37:16.363

尝试使用`[key isEqualToString: rowString]`而不是直接使用比较 key 和 rowString `==`。我认为`==`比较对象的指针值，即使字符串匹配也不会相等。

另外 - 顺便说一句，您不需要在设置 URLforAll 之前对其进行初始化。当您将其设置为等于时，`[dict objectForKey:@"URL"]`您将丢失指向您已创建的对象的指针，它将被泄露。相反，只需说`NSString *URLforAll = nil`; 或创建一个新字符串，`autorelease`以便自动清理对象：

```
NSString * URLforAll = [[[NSString alloc] init] autorelease]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T16:18:19.910

您也不需要遍历字典。只需向它询问您想要的数据。

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"DataBase" ofType:@"plist"];
NSDictionary *rootDict = [[[NSDictionary alloc] initWithContentsOfFile:path] autorelease];
NNSString *URLString = [[rootDict objectForKey:key] objectForKey:@"URL"];

// do something or return  URLString... 
```

# cmd - 如何关闭由另一个批处理文件启动的批处理文件的命令窗口

> ID：1023178
> 
> 赞同：0
> 
> 时间：2009-06-21T04:08:06.027
> 
> 标签：cmd, window

我创建了一个启动另一个脚本的 perl 脚本。但是启动的脚本必须在执行完任务后关闭。我该怎么做？我已经尝试了 EXIT 命令，但我没有工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T04:40:41.747

如果您使用 /C 参数启动 CMD，它将在命令完成时终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:09:17.837

这可能会起作用：

```
@ECHO off
CALL environment.bat
cmd.exe /c perlScript1.pl
cmd.exe /c perlScript2.pl
START /MIN perlScript3.pl
cmd.exe /c cleanup.bat
timeout 5 
```

# language-agnostic - 用于协议开发/调试的 RS-232 串行侦听工具

> ID：1023181
> 
> 赞同：11
> 
> 时间：2009-06-21T04:09:40.363
> 
> 标签：language-agnostic, serial-port, snoop

我开发了各种相对简单的固件设备。它们中的每一个最终都以一种或另一种方式通过[RS-232](http://en.wikipedia.org/wiki/RS-232)端口与 PC（或另一台设备）通信，因此我花了很多时间来实现和调试它们的通信协议。

我最常见的用例是窥探在我的 PC 上运行的程序，该程序通过串行端口 (RS-232) 与设备通信。我想查看发送的内容和时间，处理/延迟传入和传出数据，并可能注入数据（尤其是响应基于规则的传入数据）。

* * *

### 免费工具

1.  [Free Serial Port Monitor](http://www.serial-port-monitor.com/) - 有这样的名字，我怎么没找到？

### 很好的商业工具

1.  [SerialTest](http://www.fte.com/products/Serialtest-01.asp) - 演示版根本没有窥探，必须付费才能获得真正的试用。
2.  [RS232 分析仪](http://www.commfront.com/RS232_Protocol_Analyzer_Monitor/RS232-Analyzer.htm)- 演示版无法监控，必须付费才能真正试用。它似乎不做软件监控，只有使用硬件才能窥探。它有一个有用的模式，它可以像一个具有可编程自动响应的简单 RS-232 设备一样工作。
3.  [SerialSniffer](http://www.serialsniffer.com/en/sites/serialsniffer_modul_b.php) - 再次，商业。该演示似乎不包含功能。
4.  [Docklight](http://www.docklight.de/info_en.htm)有潜力，演示看起来很有用，仅硬件窥探和模拟，如 RS-232 分析仪。

### 有关的

1.  [com0com](http://com0com.sourceforge.net/) - 在您的 PC 上创建虚拟串行端口，然后将它们相互连接，以便在没有硬件的情况下将一个应用程序连接到另一个应用程序

我现在想要的基本上是用于串行的[WireShark 。](http://www.wireshark.org/)我喜欢它窥探和解码标准网络协议的方式。我只是希望它可以窥探串口（也许有一个很好的插件？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T04:34:13.803

我建议[Free Serial Port Monitor](http://www.serial-port-monitor.com/)。我两年前用过，非常好用，而且免费。

Free Serial Port Monitor 允许您拦截、显示和分析 Windows 应用程序和串行设备之间交换的所有数据。它可以成功地用于应用程序开发、设备驱动程序或串行硬件开发，并为有效的编码、测试和优化提供强大的平台。

# c# - ADO.NET 数据服务不动态更新

> ID：1023182
> 
> 赞同：1
> 
> 时间：2009-06-21T04:10:30.457
> 
> 标签：c#, .net, linq, data-binding

我的应用程序是使用 ADO.NET 数据服务的客户端/服务器解决方案。数据服务公开 transactionSummaryData，如下所示：

```
public IQueryable<TransactionSummary> TransactionSummaries
{
    get { return MainForm.transactionSummaryData.Items.AsQueryable(); }
} 
```

transactionSummaryData 是 TransactionSummaries 类型，其 items 属性定义如下：

```
public List<TransactionSummary> Items 
```

在客户端，我有一些控件数据绑定到在 TransactionSummaries 上工作的 LINQ 查询：

```
AvailibilityBox.DataContext = (from salesdata in srv.TransactionSummaries
                               where salesdata.PerformanceID == selectedshow.performancedata.PerformanceID
                               select salesdata); 
```

这会执行多次，因为 selectedshow.performancedata.PerformanceID 会响应用户导航 UI 而发生变化。

到目前为止一切都很好。但是，当服务器上的 transactionSummaryData 被服务器中的一些其他代码更新时，客户端继续显示“陈旧”数据并且不会注意到更新。我认为这是由于某种缓存。调试完代码后，我可以看到服务器发送了正确的数据，但客户端上的 LINQ 查询继续返回过时的数据。重新启动客户端会导致显示正确的数据。

我想我在这里遗漏了一些明显的东西，但是我看不到如何控制客户端上的任何缓存或使对象无效而不重新建立连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T07:30:12.827

Microsoft 论坛上的 Emre Meric 设法回答了我的问题：

> DataServiceContext 的默认合并选项是 AppendOnly，这意味着如果查询返回的实体已经被上下文跟踪，则不会对其进行任何更改。如果您希望实体始终从持久存储中更新，您可以将 MergeOption 设置为 OverwriteChanges。

[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.mergeoption.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T04:18:05.827

如果您将 DataContext 的“ObjectTrackingEnabled”属性设置为 false，那么您的问题应该会消失。请参阅此处的 MSDN 链接：

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.objecttrackingenabled.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.objecttrackingenabled.aspx)

# java - Java 中的 Max-Flow 图模拟

> ID：1023184
> 
> 赞同：0
> 
> 时间：2009-06-21T04:12:20.333
> 
> 标签：java, graph, simulation

我正在为联赛运动编写Java程序，该程序通过每支球队的当前比赛集和他们下一场比赛的时间表，然后在此基础上制作一个流网络模型。计划的想法是找出哪些球队已经被淘汰并且没有机会赢得或与任何其他球队分享一个位置。在分析网络后（应用 EdmondsKarp 算法。）我发现团队是否被淘汰。现在我也想模拟一下。我使用 JGraphT 作为图形库，并且可能会使用 JGraph 进行可视化（原因：一旦我创建了 JGraphT 对象，我就可以简单地用它们实例化 JGraph 对象并显示图形）。我昨天也发现了Jung框架，看起来不错。

主要问题是我从未编写过模拟程序，而这正是我需要“Hello World”帮助的地方。当我说模拟时，我的意思是我想直观地显示算法执行的每个部分，这里是示例场景：算法必须找到增广路径，所以我想显示每个新边何时添加到增广路径。用户将能够播放和停止动画。我还想展示所有边缘和类似事物的流动变化。到目前为止，我有算法工作，但我不知道如何进行模拟。我应该使用单独的线程进行模拟执行吗？我是否应该编写单独的类，该类将作为算法执行但状态记录甚至不知道真实算法（因为我不想中断真实算法的性能）。我是否应该使用当前算法并在其间添加一些行以保存某些数据结构中的执行状态，以便稍后用于向用户显示模拟？任何想法可能会有所帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T18:49:59.510

如果我对您的理解正确，那么您正在寻求一种方法来为您的算法*设置动画*并从动画中交互式控制其执行，这与模拟并不完全相同（模拟通常在给定的时间间隔内执行模型- 这与用户交互或动画无关，但当然也可以与两者结合）。

我建议您将问题分为两个主要部分，交互和动画。两者都可以通过应用[模型-视图-控制器](http://en.wikipedia.org/wiki/Model-view-controller)方法来解决：

*   要与您的算法交互，请确定您想要区分的“原子步骤”，例如向路径添加边。然后，您要么扩展您的算法以逐步工作，要么编写一个额外的类来包装算法并为逐步执行提供必要的例程。

*   要为您的算法所处的当前状态设置动画，您应该使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)，其中您的动画组件是观察者，并在其状态发生变化时得到算法的通知，例如将边添加到路径。您还可以通过传递一个*提示*来描述实际的状态变化（例如已添加到路径中的边缘对象）；这可能会使新旧状态之间的差异更容易可视化。

关于你的线程问题：算法可能应该在一个额外的线程中运行（除非它非常非常快），你也可以将动画放在一个额外的线程中（这可能已经由 JGraph 提供，只需检查文档或使用他们的建议的组件）。但是，您应该注意，您的算法的运行时性能几乎肯定会受到动画的影响，即使它在另一个线程*中*运行（因为通知仍然必须由算法完成） - 所以要小心性能分析并使用 un -此类研究的动画版本。

# .net - 自定义 .NET 属性的实际使用

> ID：1023186
> 
> 赞同：8
> 
> 时间：2009-06-21T04:13:42.690
> 
> 标签：.net, attributes, custom-attributes, class-attributes, .net-attributes

您在现实世界中将自定义 .NET 属性用于哪些方面？

我已经阅读了几篇关于它们的文章，但我从未使用过自定义属性。

我觉得当它们有用时我可能会忽略它们。

我说的是您创建的属性，而不是已经包含在框架中的属性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T04:50:44.193

我创建了一个脚本引擎，并用 [Command] 属性标记了各种方法。这意味着这些函数暴露给脚本引擎。

例子：

```
[Command(HelpText = "Lists active users")]
void ListUsers(void)
{

}

[Command(HelpText = "Terminate a specific user's connection")]
void EndConnection(int userID)
{

} 
```

并且如使用：

```
MyScriptEngine>>  Help
Available Commands are:
    ListUsers: Lists active users
    EndConnection {userID}: Terminate a specific user's connection

MyScriptEngine>> EndConnection 3
    User 3 (Michael) has had his connection terminated.

MyScriptEngine>> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T04:45:34.837

我已经使用它们“自定义”属性进行验证（即使用我自己的“信用卡验证”标记要验证的字段）和我编写的自定义 LinqToLucene 分析器（即指定在给定字段上使用哪个分析器） .

例如，验证代码如下所示：

```
public class Customer
{
     [CreditCardValidator]
     string creditCardNumber;

     [AddressValidator]
     string addressLineOne
} 
```

验证上述对象时，由于“自定义”属性，每个字段都使用适当的验证器进行验证。

在我编写的 LinqToLucene 东西中，自定义属性很好，因为它们允许您在运行时（通过反射）查找特定字段。例如，如果您有一个客户对象，您可能有兴趣获取已标记为“索引我”的所有属性：自定义属性让您可以轻松完成此操作，因为它以一种方式公开有关该对象的元数据：很容易查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T04:46:10.873

除其他外，我使用它们来指定在运行时读取的 EBNF，以动态创建自定义解析器，并指定有关数据库字段的元数据。

我发现我通常使用自定义属性的一种“模式”是替换枚举，尤其是当代码中的差异位置中的枚举依赖于枚举时。

例如，我可能有一个对象状态的枚举。基于这种状态，我在代码中可能有 3 或 4 个不同的位置，我会对该枚举进行“切换”并执行一些操作。其他一些开发人员可以很容易地通过添加一个新的枚举来引入一个错误，但不在代码中的其他地方处理其中一个 switch 语句。

因此，为了避免这种情况，我创建了一个声明为静态类的自定义属性。自定义属性在类的静态构造函数中加载到字典中，代码中的所有位置都使用字典而不是 switch 语句。自定义属性构造函数包含每个 switch 语句的“硬编码”值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T04:24:17.187

我必须将一些对象序列化为自定义（传统）格式，并且我使用属性来确定应该序列化哪些字段以及如何格式化它们。然后我有一个序列化程序，它可以获取具有这些属性的任何对象并使用反射来格式化它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T04:41:35.990

我曾在基于 ActiveRecord 模式开发的一个 ORM 框架中使用它。这与 LINQ、Castle 项目等中可用的实现相同。

该框架被称为“SkyFramework”，但它不是开源的。

例如，只是一个粗略的例子......

您也会在其他开源项目中找到类似的示例。

 `````
[Sky.Table ("user")]
public class User
{
    [Sky.Column ("username")]
    public string UserName;

    [Sky.Column ("pwd")]
    public string Password;
} 
````  `注意：属性“表”、“列”是当时的自定义属性。

ActiveRecord 引擎解析这些属性的对象并为 CRUD 生成相应的函数......等等......

同样，我开发了一些自定义属性来识别需要进行基准测试的代码部分……例如。

```
[Sky.BenchMark()]
public void LongRunningMethod(..)
{
} 
```

标有上述属性的方法会自动进行基准标记并生成日志。这些是一些较早的实现。

有一本关于该主题的 Apress 书籍 [。Applied .NET Attribues](http://www.amazon.com/Applied-NET-Attributes/product-reviews/B001GIPDIY) 可能对您有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T09:16:21.223

到目前为止，我还没有真正找到自定义属性的用途。在某些情况下，我认为它们可能是合适的，但没有使用它们，因为显然读取自定义属性所涉及的反射非常昂贵。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-28T19:44:07.253

我在“插件”DLL 中的类上放置了自定义属性。这允许框架动态发现可用插件，评估它们是否感兴趣，然后动态加载感兴趣的插件。

在我们的领域中，示例是模拟家庭中特定车辆的插件。一个车辆系列的一个插件实际上可以模拟该车辆系列中的多个车辆模型（例如，“MX-6”、“Probe”）。如果将 ID 或模型名称作为自定义属性数组包含在内，我们可以快速忽略任何甚至没有自定义属性的 DLL，然后进一步忽略任何不为感兴趣的车辆建模的 DLL。``

# c# - 将 C#（前端）连接到 apache/php/python（后端）

> ID：1023187
> 
> 赞同：2
> 
> 时间：2009-06-21T04:17:05.000
> 
> 标签：c#, php, python, web-applications, data-structures

**概述：**我们正在寻找编写一个 C# 用户界面来选择我们的 Web 应用程序的一部分。这适用于非常受束缚的观众（例如，在内部）。

我们的 Web 应用程序是用 PHP 和/或 Python 编写的，使用 Apache 作为 Web 服务器。

^(为什么？一个经过深思熟虑的原生 Windows 界面有时比使用 Web 浏览器强加的规则更有效。)

**问题：**使用 HTTPS 在 C# 和 PHP/Python 之间进行通信的最佳方式是什么？我说的主要是每种语言中驻留的各种数据类型的序列化/反序列化和转换。

理想情况下，我们应该在 C# 中使用强类型的结构或对象，并在 PHP/Python 中创建适当的数据结构以用于此目的。代码生成器很好。

我看过[Apache Thrift](http://incubator.apache.org/thrift/)，考虑过扩展我们的内部数据库，查看了 Google 的 Protocol Buffers 等…… *Thrift 看起来很有希望，但他们的文档非常稀少。*

1.  将开发人员的开销降至最低至关重要。
2.  保持性能合理，尤其是在服务器端，这一点很重要。

欢迎对 XMLRPC、SOAP 或其他相关技术的有用性发表评论。

**任何指针？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T04:44:50.903

我没有真正的 PHP 经验，但我已经完成了大量的 Python 后端 Web 服务，这些服务由各种语言和环境的前端客户端使用。在我尝试过的技术中，SOAP 是唯一一种在我嘴里留下酸味的技术——太多的“仪式”/开销。（在很久以前，我也尝试过 Corba，当我尝试在不同语言的独立实现之间进行互操作时，感觉并没有那么不同；-)。

XML-RPC、JSON 和协议缓冲区都证明对我非常有用。

Protocol buffers is what we normally use within Google, and I'm not sure what you find so under-documented about them -- please ask specific questions and I'll see what I can do to make our documentation better, officially or unofficially! Their main advantage is that they're so "tight" on the wire -- minimal overhead with maximum flexibility. JSON is great, too -- and not just for ease of use in Javascript clients, either: sometimes I've used it as the default format for communication among different languages, too, when no JS was involved at all!

一旦你的 web 应用程序设置为发出（比如说）一个协议缓冲区，让它能够根据请求发出 XML 或 JSON 一点也不难——*在*GET 请求中只需要一个 ?outputformat=JSON 额外参数，并且选择正确的输出序列化器非常容易（在 Python 中，但我敢肯定，在 PHP 中也是如此）。

"Getting strongly typed objects" on your C# end is, in my view, a job you can best do in a C# layer on your end. No direct experience with that, but, for example, I *have* wrapped reception of protocol buffers in C++ into factory classes that spewed out perfectly formed and statically typed objects (or raised exceptions when the incoming data was not semantically correct); I know it wouldn't be any harder for JSON or XML, and I very much doubt it would be any harder for Java, C#, Python if you cared, or any other language that's any use at all in the real world!-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T04:28:12.320

使用 Web 服务听起来是最适合您的方案的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T08:25:45.413

I have done this using a PHP SOAP Server and VB.Net client. Once you connect the VB.Net/C# client to the server (the location of the WSDL file) C# will automatically detect all the functions and all the objects that are exposed. Making programming much easier.

I would also recommend using NuSOAP which I found to be more functional. [http://sourceforge.net/projects/nusoap/](http://sourceforge.net/projects/nusoap/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T03:58:52.337

I recommend the PHP/Java Bridge. Don't let the name fool you. This can be used to connect both PHP and Python to any ECMA-335 virtual machine (Java and C#)!

[http://php-java-bridge.sourceforge.net/pjb/](http://php-java-bridge.sourceforge.net/pjb/)

To answer your comment:

> The communication works in both directions, the JSR 223 interface can be used to connect to a running PHP server (Apache/IIS, FastCGI, ...) so that Java components can call PHP instances and PHP scripts can invoke CLR (e.g. VB.NET, C#, COM) or Java (e.g. Java, KAWA, JRuby) based applications or transfer control back to the environment where the request came from. The bridge can be set up to automatically start a PHP front-end or start a Java/.NET back end, if needed.

# enums - 领域模型中对象的实体、值对象或枚举表示

> ID：1023193
> 
> 赞同：1
> 
> 时间：2009-06-21T04:24:00.087
> 
> 标签：enums, nhibernate-mapping, domain-driven-design

我正在尝试构建一个文档管理系统，尽管我读过所有关于实体、值对象、如何在如何映射它们之间进行选择等方面的文章……我仍然无法弄清楚什么是“正确”的方式去做就是了。很典型地，在这样的场景中，每个文档可以属于一个或多个类别，可以被属于一个或多个角色的用户查看等等......所以文档实体看起来像这样：

```
public class Document
{
    private int _id;
    private string _title;
    private string _brief;
    private DateTime _publicationDate;
    private string _author;
    private string _source;
    private DateTime _activeDate;
    private DateTime _inactiveDate;
    private IList<Category> _categories;
    private IList<Fund> _funds;
    private IList<Role> _roles;
    ...etc
} 
```

应用程序的实际域模型和业务逻辑目前非常薄，因此类别、基金和角色对象不包含任何业务逻辑，实际上只是分类、访问控制等（在角色的情况下）等的手段......因此，在数据库中，例如，我将有“角色”、“类别”、“基金”表，然后会有多对多映射表，其中包含 2 列：例如 DocumentId 和 RoleId。因此，我的问题是：

类别、基金、角色等是否应在域中表示为实体，例如

```
public class Role
{
    private int _id;
    private string _name;

    public virtual int Id 
    {
        get { return _id; }
        private set { _id = value; }
    }

    public virtual string Name 
    {
        get { return _name; }
        private set { _name = value; }
    }
} 
```

或者作为值对象或者角色应该只是一个枚举：

```
public enum Role
{
    AllUsers
    ,ShareHhlders
    ,Registered
    ,Administrator
} 
```

我从实体方法开始，但现在我正在尝试创建“添加文档”功能和 UI，并质疑它是否是正确的方法 - 在添加文档 UI 中，用户获取复选框列表组，然后他们选择哪些类别，角色资金等...文件将属于。如果选中了复选框，则 Onec 将此信息传递给控制器​​（我正在使用 ASP.NET MVC），然后需要创建类别/角色/基金等...并将其添加到文档对象中，但要这样做需要类别/角色/基金的 ID。因此，这意味着我可能必须在应用程序中维护映射对象，以获取给定类别/rle/fund 的类别/角色/基金 id，以传递给类别/角色/基金对象的构造函数。这看起来确实不对，因此为什么我

我开始尝试将对象更改为枚举，但随后需要单独维护用于引用完整性的枚举和类别/角色/基金/多对多映射表。这似乎是满足持久性的要求，但在数据库级别我认为有必要维护单独的类别/角色/基金表、映射表和外键约束。（还使用 NHibernate 进行 ORM 映射和持久性 ut 应该能够让它与 enumss 一起玩得很好）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T05:04:07.890

在实体和值对象之间进行选择时，重要的是要确定对象是否具有可以更改的内部部分的唯一标识。如果对象具有唯一标识并支持内部更改，那么这些更改是否需要跟踪或持久化到数据库中？简而言之，您是否需要对这些对象进行 CRUD 操作？如果是这样，您可能有一个实体。如果没有，您可能有一个值对象。

我的直觉说，如果你可以创建枚举而不是实体，那么你就不需要实体对象。我投票使用 NHibernate 来保存外键以实现引用完整性。

# java - Java 程序，用于监控我使用 J2EE 制作的网站

> ID：1023198
> 
> 赞同：0
> 
> 时间：2009-06-21T04:27:19.900
> 
> 标签：java, jakarta-ee

我在 J2EE 中制作了我的项目..

我想跟踪谁都访问了我的网站，以及他们的一些特定信息（例如他们访问的时间、IPAddress 等。）我怎样才能在 java 程序的帮助下做到这一点，，

我可以将信息存储在数据库中。所以我需要的是关于如何检索访问该网站的人的信息的逻辑。Tomcat 服务器，我正在使用 jsp+Servlets..

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T04:40:36.863

[AWStats](http://awstats.sourceforge.net/)是您真正应该考虑的。针对您的访问日志运行它。我知道您*想*使用 Java 应用程序，但您确实应该考虑 AWSStats，因为它是一个成熟的产品。**在 Java 中复制 AWStats 已经完成的工作需要很长时间。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T06:50:12.720

在我之前的工作中，我们也使用了[AStats 。](http://awstats.sourceforge.net/)管理层和客户似乎对此感到满意。

我想当您说*我在 J2EE 中制作项目时*，您的意思是指在 Glassfish、JBoss、Weblogic、Geronimo 等 J2EE 服务器上运行的企业应用程序。

如果您不需要复杂的解决方案，您可以使用 Tomcat 中的[servlet 过滤器](http://java.sun.com/products/servlet/Filters.html)或[阀门](http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html)设置（通常嵌入在大多数 J2EE 服务器中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T04:38:22.137

查看[ServletRequest](http://www.docjar.com/docs/api/javax/servlet/ServletRequest.html) API。特别要查看 getRemoteAddr()、客户端的远程 IP 地址、getRemoteHost() 和 getRemotePort()。希望您的大多数客户不会使用代理，否则您将获得代理的信息。

另一种技术是为每个客户端设置一个唯一的标识cookie，然后每个后续请求都会携带该cookie。这可能是比跟踪 IP 地址更好的方法。这是关于在 servlet 中处理 cookie 的[教程](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Cookies.html)。

根据 altCognito 的建议，Web 服务器级别的分析工具是另一种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T16:23:07.197

这是一个`HttpServletRequest`使用`ServletRequestListener`.

首先，将监听器添加到 web.xml 配置文件中。此文件应位于 WEB-INF 文件夹中。

```
 <listener>
        <description>RequestListener</description>
        <listener-class>web.MyRequestListener</listener-class>
    </listener> 
```

在上述配置中，`ServletRequestListener`named`MyRequestListener`位于`web`包中。

接下来，`MyRequestListener`在`web`包中创建如下。

```
 package web;

import javax.servlet.*;

public class MyRequestListener implements ServletRequestListener {

    public void requestInitialized(ServletRequestEvent event) {
        HttpServletRequest request = (HttpServletRequest)event.getServletRequest();
        System.out.println("request initialized");
        System.out.println("Request Remote Addr = " + request.getRemoteAddr());
        System.out.println("Request Remote Host = " + request.getRemoteHost());
        System.out.println("Request Remote Port = " + request.getRemotePort());
        java.util.Enumeration e = request.getAttributeNames();
        while(e.hasMoreElements()) {
            String attName = (String)e.nextElement();
            Object val = request.getAttribute(attName);
            System.out.println("Request Att (" + attName + ") = " + val.toString());
        }
        e = request.getParameterNames();
        while(e.hasMoreElements()) {
            String paramName = (String)e.nextElement();
            Object val = request.getParameter(paramName);
            System.out.println("Request Param (" + paramName + ") = " + val.toString());
        }
        e = request.getHeaderNames();
        while(e.hasMoreElements()) {
            String headerName = (String)e.nextElement();
            Object val = request.getHeader(headerName);
            System.out.println("Header (" + headerName + ") = " + val.toString());
        }
    }

    public void requestDestroyed(ServletRequestEvent event) {
        System.out.println("request destroyed");
    }
} 
```

代码所做的只是从 HTTP 标头中打印出属性、参数和信息。如果您需要请求的日期，您可以创建`java.util.Date`输入时间`requestInitialized()`。

请记住，每次有来自浏览器（或机器人）的 HTTP 请求时都会调用`ServletRequestListener`'s `requestInitialized()`，因此最好使用应用程序外部的工具来跟踪使用情况。如果您正在寻找外部工具，您可能需要考虑[Google Analytics](http://www.google.com/analytics/)或[Urchin](http://www.google.com/urchin/index.html) ，如果您的网络配置不允许您使用 Google Analytics。

# jquery - jQuery：查找包含嵌套 ul 的列表项的文本

> ID：1023199
> 
> 赞同：15
> 
> 时间：2009-06-21T04:27:20.760
> 
> 标签：jquery

我有以下内容：

```
<ul id="list">
<li>item1
    <ul>
        <li>sub1</li>
        <li>sub2</li>
    </ul>    
</li>
</ul> 
```

我想响应 li click 事件并在其他地方使用 li 的文本。但是，如果单击的是包含嵌套 ul 的 li，我当然会得到所有元素的文本。

```
$("#list li").click(function() {
    alert($(this).text());
}); 
```

按预期返回 item1sub1sub2。

如果单击项目 1 li，我无法弄清楚如何仅获取“项目 1”。我尝试了以下（除其他外）没有运气：

```
$("#list li").click(function() {
    alert($(this).filter("ul").text());
}); 
```

有任何想法吗？

编辑

这是一个示例的片段 - 它可能有多个层次。我也不想将列表项文本包装在跨度或其他标记中。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-21T13:16:56.667

这种方法怎么样？克隆对象，删除克隆的孩子，*然后*找到文本内容。

```
$("#list li").click(function () {
    alert($(this).clone().children().remove().end().text());
} 
```

也许不是最有效的方法，但它完全直观、非常整洁，而且您不必为您的 html 搞砸。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-04-18T11:31:24.887

普通的 DOM 方法只允许访问一个元素的文本内容，而不是 jquery：

```
$("#list li").click(function() {
    alert($(this)[0].firstChild.textContent)
}); 
```

在这种情况下，firstChild 是 li 元素下的 textNode

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-21T04:45:18.440

您遇到了困难，因为`text()`做了它应该做的 - 返回这个和所有子元素的文本。最简单的做法是给每个标签添加另一个标签`<li>`，然后使用这个标签。
例如：

```
<ul id="list">
<li><span>item1</span>
    <ul>
        <li><span>sub1</span></li>
        <li><span>sub2</span></li>
    </</ul>    
</li>
</ul> 
```

然后你有一个简单的选择器：

```
$("#list li").click(function() {
   alert($(this).find("span").eq(0).text());
}); 
```

或者，如果可能（取决于您的风格），您可以将事件添加到跨度：

```
$("#list span").click(function() {
   alert($(this).text());
}); 
```

如果您无法添加这些`<span>`s（如您所说），您可以使用 jQuery`.contents()` 为您添加它们，类似于此处所做的：

> [在<x>A<br/>B</x>中隐藏B](https://stackoverflow.com/questions/992472/hide-b-in-xabr-b-x/992568#992568)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T10:13:59.813

这将检查列表项是否有任何子项，如果有，则仅过滤掉文本节点并连接结果（在这种情况下，它适用于将文本元素放在 li 中的任何位置）。如果您只想在开始时检查元素，则可以避免 for 循环而只使用 this.firstChild

```
$("#list li").click(function(e) {
    if ($(this).children().length > 0) {
       var text = "";
       for (var i = 0; i < this.childNodes.length; i++) {
           var node = this.childNodes[i];
           if (node.nodeType === 3 && $.trim(node.nodeValue).length > 0) {
                text += $.trim(node.nodeValue);
           }
       }
       alert(text);
    }
    else {
       alert($(this).text());
    }
    e.stopPropagation();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T07:00:05.960

所以这个机制从子元素中取出 html，用空替换换行符，然后只返回字符串直到第一个 " `<`" 字符。我还添加`event.stopPropagation`了避免调用冒泡到父级的单击事件。

```
<script type="text/javascript">
$("#list li").click(function(event) {
    var sourceHTML = $(this).html().replace(/\n/g,'').replace(/<.*/,'');
    alert(sourceHTML);
    event.stopPropagation();
});
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T10:07:29.293

我认为您需要使用 each 方法。所以试试下面的脚本：

```
$(document).ready(function() {
        $('ul').each(function() {
            $(this).find('li').click(function() {
                var listItem = this;
                alert($(listItem).text());
            });
        })
    }); 
```

带有以下标记

```
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
</ul> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-26T14:42:51.537

另一种实现相同目标的方法

```
$("#list li").click(function() {
    alert($(this).contents().not('ul,ol').text());
}); 
```

# java - Java 中的内存映射文件

> ID：1023200
> 
> 赞同：8
> 
> 时间：2009-06-21T04:27:23.083
> 
> 标签：java, memory-mapping

我一直在尝试编写一些必须执行大量 I/O 的非常快速的 Java 代码。我正在使用一个返回 ByteBuffer 的内存映射文件：

```
public static ByteBuffer byteBufferForFile(String fname){
    FileChannel vectorChannel;
    ByteBuffer vector;
    try {
        vectorChannel = new FileInputStream(fname).getChannel();
    } catch (FileNotFoundException e1) {
        e1.printStackTrace();
        return null;
    }
    try {
        vector = vectorChannel.map(MapMode.READ_ONLY,0,vectorChannel.size());
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
    return vector;
} 
```

我遇到的问题是 ByteBuffer .array() 方法（应该返回一个 byte[] 数组）不适用于只读文件。我想编写我的代码，以便它可以与在内存中构建的内存缓冲区和从磁盘读取的缓冲区一起使用。但我不想将我的所有缓冲区都包装成一个 ByteBuffer.wrap() 函数，因为我担心这会减慢速度。所以我一直在写所有东西的两个版本，一个需要一个 byte[]，另一个需要一个 ByteBuffer。

我应该把所有东西都包起来吗？或者我应该把所有东西都写一遍？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-07-15T20:27:25.610

有没有人真正检查是否`ByteBuffers`由内存映射支持`.array()`首先调用创建，而不管只读/读写？

据我所知，答案是**否定**的。A`ByteBuffer`返回直接`byte[]`数组 via的能力由( )`ByteBuffer.array()`的存在决定，在创建a 时它始终设置为 null 。`ByteBuffer.hb``byte[]``MappedByteBuffer`

这对我来说有点糟糕，因为我希望做一些类似于问题作者想做的事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-21T06:31:23.490

不重新发明轮子总是好的。Apache 提供了一个漂亮的库来执行 I/O 操作。看看 [http://commons.apache.org/io/description.html](http://commons.apache.org/io/description.html)

这是它所服务的场景。假设您有一些您希望保留在内存中的数据，但您不提前知道会有多少数据。如果有太多，您想将其写入磁盘而不是占用内存，但您不想在需要之前写入磁盘，因为磁盘很慢并且是需要跟踪以进行清理的资源。

因此，您创建一个临时缓冲区并开始写入该缓冲区。如果/当您达到要保留在内存中的阈值时，您需要创建一个文件，将缓冲区中的内容写入该文件，并将所有后续数据写入文件而不是缓冲区。

这就是***DeferredOutputStream***为您所做的。它隐藏了切换点的所有混乱。您需要做的就是首先创建延迟流，配置阈值，然后写出您心中的内容。

编辑：我刚刚使用谷歌做了一个小的重新搜索，发现了这个链接： http: [//lists.apple.com/archives/java-dev/2004/Apr/msg00086.html](http://lists.apple.com/archives/java-dev/2004/Apr/msg00086.html) （闪电快速文件读/写）。非常令人印象深刻。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T06:08:00.073

包装 byte[] 不会减慢速度……不会有任何巨大的数组副本或其他小的性能问题。来自 JavaDocs：[java.nio.ByteBuffer .wrap()](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/ByteBuffer.html#wrap(byte[]))

> 将字节数组包装到缓冲区中。
> 
> **新缓冲区将由给定的字节数组支持；**也就是说，对缓冲区的修改将导致数组被修改，反之亦然。新缓冲区的容量和限制将为 array.length，其位置为零，其标记未定义。它的后备数组将是给定的数组，并且它的数组偏移量将为零。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T06:04:44.200

使用 ByteBuffer.wrap() 功能不会带来很大的负担。它分配一个简单的对象并初始化几个整数。因此，如果您需要使用只读文件，那么针对 ByteBuffer 编写算法是您最好的选择。

# actionscript-3 - AS3 在外部 swf 中嵌入或导入所有类，而不单独引用每个类

> ID：1023205
> 
> 赞同：6
> 
> 时间：2009-06-21T04:30:41.150
> 
> 标签：actionscript-3

我有一个 ArtLibrary.swf 文件，其中包含数百个以类名导出的 MovieClip。我希望能够在我正在处理的多个不同的 Flash 文件中使用这些电影，但我不知道在使用和嵌入命令后如何正确引用它们。

以下作品：

```
[Embed(source="ArtLibrary.swf", symbol="BirdBodyColor_mc")]
var BirdBodyColor_mc:Class;

myMC:MovieClip = new BirdBodyColor_mc();
addChild(myMC); 
```

在此示例中，我不确定如何引用“大师班”中的各个类。

```
[Embed(source="ArtLibrary.swf")]
var MasterClass:Class;

myMC:MovieClip = new BirdBodyColor_mc();
addChild(myMC.BirdBodyColor_mc); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-23T03:40:27.637

所以这是一个 CS4 太聪明的例子。由于您从未以编译器可以在编译时确定的方式*明确*引用有问题的类，因此它不会在您的 SWF 中包含这些类 - 因此出现错误。

在 Flex 中，您可以使用命令行参数解决此问题，但 CS4 并非如此。相反，您以编译器可以理解的方式至少一次明确地引用您想要使用的类。例如，我制作了一个简单的 SWC，其中包含一个将其类设置为“TestCircle”的符号。在使用 SWC 的代码中，我有以下代码，它工作得很好：

```
import flash.utils.getDefinitionByName;

TestCircle;

var test:MovieClip =  new (getDefinitionByName("TestCircle") as Class)();

addChild(test); 
```

如果您想变得花哨，可以编写一个小脚本来破解打开一个 SWC（它只是一个 zip 文件），读取其中的 XML 清单并自动创建一个特殊的“包含器”类。但正如他们所说 - 我将把它作为练习留给读者！;-)

希望有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-22T00:04:54.467

与其使用 SWF，不如使用 SWC。要创建 SWC，只需进入 Flash Pro 的发布设置，然后转到 Flash 选项卡并选择“导出 SWC”。SWC 包含 SWF 和一个特殊清单，其中包含 Flash 需要了解的有关 SWF 中的类的所有信息。

然后，要在另一个项目中使用 SWC，请转到 AS3 设置（也在发布设置的 Flash 选项卡中），前往库路径选项卡并添加您的 SWC（绝对路径和相对路径都可以正常工作）。

请注意，这只适用于 CS4 或 Flex（对于 Flex，我很确定您可以将 SWC 拖到您的项目中，但我会检查一下）。

现在 - 如果您想加载 SWF 并在运行时使用它的资产，那就是完全不同的蜡球了。为了使其正常工作，您需要摆弄 Loader 类和 ApplicationDomain 以便将类放入正确的域中。这里有一些关于这个主题的好信息：

[http://www.kirupa.com/forum/showpost.php?p=2123134&postcount=366](http://www.kirupa.com/forum/showpost.php?p=2123134&postcount=366)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-07T15:25:17.977

> 如果您想变得花哨，可以编写一个小脚本来破解打开一个 SWC（它只是一个 zip 文件），读取其中的 XML 清单并自动创建一个特殊的“包含器”类。但正如他们所说 - 我将把它作为练习留给读者！;-)

无需做任何如此复杂的事情（谢天谢地！）。include-libraries 编译器参数将自动包含 SWC 中的所有类，从而允许该`getDefinitionByName`方法按预期工作。

在您的 App-config.xml 文件中（或者直接作为参数传递给编译器）：

```
<include-libraries>
    <library>path/to/your.swc</library>
</include-libraries> 
```

然后你就可以`getDefinitionByName`正常使用了。

HTH。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-21T08:17:45.640

使用 FlashDevelop 很容易解决这个问题。

右键单击项目列表中包含的 swc。选择选项然后“包括库（完整库）”。

..您现在可以使用 getDefinitionByName 从您的 swc 文件中获取未引用的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-25T05:22:48.267

所以我仍然坚持编写一个长的、手动创建的脚本来引用每个导入的类。当然，这些行比嵌入方法短得多，甚至是一个术语。

最后，我制作了我的 ArtLibrary.fla，然后将该 fla 库中的所有文件夹复制并粘贴到我的其他 5 个 fla 中。我没有费心编译 swf 文件。对于我的需要，这是最有效的。

非常感谢所有的帮助。您的回答直截了当且非常详细。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-26T09:56:12.390

是的，

这个答案来得太晚了 9 年，但您可以在不使用 ApplicationDomain 实际创建引用的情况下做到这一点。因此，假设您在 base_library.swf 中有链接到您的 moveiclip 的类，您正在将其加载到您的主 swf 中。一个电影剪辑有类链接'Slide2' 在你的主 swf 你有这个

```
 private function loadSWF():void {
        var loader:Loader = new Loader();
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);
        loader.load(new URLRequest("./lib/base_library.swf"));
    }

    private function onComplete(e:Event):void {
        trace(" ON COMPLETE LOAD ");
        var movie:* = LoaderInfo(e.currentTarget).content;

        // now try and create an instance of a slide
        var mc:MovieClip = createInstance(movie,"Slide2", "slide2");
        addChild(mc);
    }

    public function createInstance(mc:MovieClip, className:String, instName:String):MovieClip
    { 
        var cls:Class = mc.loaderInfo.applicationDomain.getDefinition(className) as Class;
        if (cls)
        {
            var instMC:MovieClip = new cls();
            instMC.name = instName;
            return instMC;
        }
        return null;
    } 
```

# assembly - 我是否正确理解此 Y86 汇编代码中的堆栈？

> ID：1023208
> 
> 赞同：1
> 
> 时间：2009-06-21T04:34:31.667
> 
> 标签：assembly, stack, y86

我创建了这个简单且毫无意义的汇编 (Y86) 代码，以查看在使用指令调用、pushl、popl 和 ret 时我是否理解堆栈中发生的所有事情。

就像我说的，这段代码毫无意义，它只是用于测试/学习目的。虽然，所有内存地址都是正确（有希望的）计算出来的，而且不是随机的。

汇编代码如下：

```
 | .pos 0
0x00 |   irmovl Stack, %esp
0x06 |   rrmovl %esp, %ebp
0x08 |   irmovl $5, %eax
0x0E |   call func
0x13 |   halt
0x14 | func:
0x14 |   pushl %ebp
0x16 |   rrmovl %esp, %ebp
0x18 |   pushl %eax
0x1A |   popl %eax
0x1C |   popl %ebp
0x1E |   ret
     | .pos 50
0x32 | Stack: .long 0 
```

以下是我最好的绘制堆栈并解释每个步骤（指令）对堆栈的作用。请注意，我使用 SP 和 BP 分别指代 %esp 和 %ebp 因为它们被大量使用并且更易于阅读。

我想知道的是我是否把所有事情都做对了，或者我是否错过了任何事情。请随意复制/粘贴您想要的任何内容，并在您的答案中修复一些步骤。

另请注意，我对此的理解非常重要，我周一有一个考试，我需要为此做好准备，我希望你能给我最好的答案。根据您的回答，我可能（或没有）有一些相关问题，我们将在评论部分处理。

```
- INSTRUCTION: irmovl Stack, %esp
- INSTRUCTION: rrmovl %esp, %ebp
  1) Point %esp (SP) and %ebp (BP) to Stack

     |  ...  |
0x2E |-------|
     |       |
0x32 |-------| <--- SP & BP

- INSTRUCTION: irmovl $5, %eax
  1) Sets %eax = 5

- INSTRUCTION: call func
  1) Decrements SP by 4 (0x32 -> 0x2E)
  2) Saves return address (0x13) in memory location pointed by SP (0x2E)
  3) Jumps to "func" memory address (0x14)

     |  ...  |
0x2A |-------|
     | 0x13  |
0x2E |-------| <--- SP
     |       |
0x32 |-------| <--- BP

- INSTRUCTION: pushl %ebp
  1) Decrements SP by 4 (0x2E -> 0x2A)
  2) Saves BP value (0x32) in memory location pointed by SP (0x2A)

     |  ...  |
0x26 |-------|
     | 0x32  |
0x2A |-------| <--- SP
     | 0x13  |
0x2E |-------|
     |       |
0x32 |-------| <--- BP

- INSTRUCTION: rrmovl %esp, %ebp
  1) Sets BP = SP (0x32 -> 0x2A)

     |  ...  |
0x26 |-------|
     | 0x32  |
0x2A |-------| <--- SP & BP
     | 0x13  |
0x2E |-------|
     |       |
0x32 |-------|

- INSTRUCTION: pushl %eax
  1) Decrements SP by 4 (0x2A -> 0x26)
  2) Saves %eax value (5) in memory location pointed by SP (0x26)

     |  ...  |
0x22 |-------|
     |   5   |
0x26 |-------| <--- SP
     | 0x32  |
0x2A |-------| <--- BP
     | 0x13  |
0x2E |-------|
     |       |
0x32 |-------|

- INSTRUCTION: popl %eax
  1) Saves value (5) in memory location pointed by SP (0x26) in %eax
  2) Increments SP by 4 (0x26 -> 0x2A)

     |  ...  |
0x22 |-------|
     |   5   |
0x26 |-------|
     | 0x32  |
0x2A |-------| <--- SP & BP
     | 0x13  |
0x2E |-------|
     |       |
0x32 |-------|

- INSTRUCTION: popl %ebp
  1) Saves value (0x32) in memory location pointed by SP (0x2A) in %ebp
  2) Increments SP by 4 (0x2A -> 0x2E)

     |  ...  |
0x22 |-------|
     |   5   |
0x26 |-------|
     | 0x32  |
0x2A |-------|
     | 0x13  |
0x2E |-------| <--- SP
     |       |
0x32 |-------| <--- BP

- INSTRUCTION: ret
  1) Jumps to memory address (0x13) in memory location pointed by SP (0x2E)
  2) Increments SP by 4 (0x2E -> 0x32) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T05:14:22.230

据我所知，你一切都好。

我可以提出的一个小问题是，将地址写在这些地址的值之上可能更直观。那是：

```
0x2E |-------|
     | 0x13  |
0x32 |-------| 
```

原因是覆盖值 ( `0x2E`, `0x2F`, `0x30`, `0x31`) 的地址范围朝向下一个地址`0x32`。

当然，您可能希望在考试时使用老师期望的符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T03:18:32.523

你答对了。

您正在做的是使用标准的调用者-被调用者约定执行函数调用，为被调用者创建一个框架。然后，您在返回给调用者之前执行一个简单的寄存器推送和弹出操作。这是完全正确的，您的理解是正确的（有关详细信息，请参阅[http://y86tutoring.wordpress.com/2012/10/31/functioning-stacks/](http://y86tutoring.wordpress.com/2012/10/31/functioning-stacks/)）

一切看起来都很好。唯一的建议是您不需要在堆栈上定义 0x0000 字。只需定义 Stack 标签就可以了。

# java - 将 CharArrayBuffer 复制到另一个 CharArrayBuffer

> ID：1023209
> 
> 赞同：2
> 
> 时间：2009-06-21T04:35:01.807
> 
> 标签：java, android

如何在 Android 上的 Java 中的指定索引处将一个复制`CharArrayBuffer`到另一个？`CharArrayBuffer`

developer.android.com/reference/android/…

```
CharArrayBuffer stringBuffer1 = new CharArrayBuffer(128); 
System.arraycopy("Phone", 0, stringBuffer1.data, 0, "Phone".length()); 
```

但我得到一个`ArrayStoreException`. 我已`CharArrayBuffer`分配**128**。我不明白这个例外

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T12:30:39.460

从文档

```
System.arraycopy(Object src, int srcPos, Object dest, int destPos, int length) 
```

*将指定源数组中的数组从指定位置开始复制到目标数组的指定位置。*

*ArrayStoreException* 抛出该异常以指示已尝试将错误类型的对象存储到对象数组中。例如，以下代码生成一个`ArrayStoreException`：

```
 Object x[] = new String[3];
 x[0] = new Integer(0); 
```

以下代码行

```
System.arraycopy("Phone", 0, stringBuffer1.data, 0, "Phone".length()); 
```

正在尝试将 String 放入`CharArrayBuffer`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T05:56:19.910

ArrayStoreException 是因为一种类型。将“电话”转换为 CharArrayBuffer。（数组的大小不是问题。如果是，它将抛出 IndexOutOfBoundsException。）

# php - 我如何测试某人的 cookie 是否不起作用？(PHP)

> ID：1023214
> 
> 赞同：0
> 
> 时间：2009-06-21T04:40:13.337
> 
> 标签：php, cookies

有人可以告诉我一个简单的方法，我可以测试某人的 cookie 是否未在 php 中启用？我想创建一个测试脚本来确定用户是否可以正确使用我的网站。如果他们不能，我会将他们重定向到几个屏幕截图，向他们展示要更改的内容。

我只使用 $_SESSION[] 变量，并且我相信 cookie 在我的设置中的唯一用途是会话 id 变量。

理想情况下，我想在 PHP 中打开一个选项，让该用户在他们的 cookie 被弄乱时通过 GET/POST 来回传递会话 ID。

任何 Javascript 都不适合我，因为他们可能没有启用 javascript。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T04:46:38.317

```
setcookie("cookies","yes",time() +"3600"); 
```

然后在此之后重定向并测试是否在下一页上设置了 cookie。至少需要两页才能知道是否启用了 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T04:45:22.357

使用 SID
见[http://jp2.php.net/function.session-start](http://jp2.php.net/function.session-start)和[http://jp2.php.net/manual/en/session.idpassing.php](http://jp2.php.net/manual/en/session.idpassing.php)

如果 cookie 被接受，SID 将为空，否则包含会话 ID（实际上是 PHPSESSID=session_id()）。但是，这确实取决于编译标志，因此请务必检查 refs。

您可以将其用作：

```
echo '<br /><a href="page2.php?' . SID . '">page 2</a>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T08:19:44.347

执行此操作的标准方法是使用“证明在布丁中”编程。

有两种方法可以做到这一点：

*   如果在没有 Javascript 的情况下测试 cookie，发出一个 cookie 并在重定向后通过 PHP 读取它。如果它在那里，那很好。如果没有...您知道 cookie 未启用。
*   如果您可以使用 Javascript，请通过 PHP 发出 cookie 并使用 Javascript 读取它（我认为 cookie 将在第一个页面加载时出现，因为如果浏览器获取 setcookie 标头，cookie 将被设置）。

# python - 如何腌制 CookieJar？

> ID：1023224
> 
> 赞同：9
> 
> 时间：2009-06-21T04:46:07.737
> 
> 标签：python, persistence, pickle, cookiejar, cookielib

我有一个要腌制的带有 CookieJar 的对象。

然而，大家可能都知道，pickle 会阻塞包含锁定对象的对象。由于某些可怕的原因，CookieJar 有一个锁对象。

```
from cPickle import dumps
from cookielib import CookieJar

class Person(object):
    def __init__(self, name):
        self.name = name
        self.cookies = CookieJar()

bob = Person("bob")
dumps(bob)

# Traceback (most recent call last):
#  File "<stdin>", line 1, in <module>
# cPickle.UnpickleableError: Cannot pickle <type 'thread.lock'> objects 
```

我该如何坚持这一点？

我能想到的唯一解决方案是将 FileCookieJar.save 和 FileCookieJar.load 用于 stringIO 对象。但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-21T05:01:30.360

这是一个尝试，通过从 CookieJar 派生一个类来覆盖 pickle 使用的 getstate/setstate。我没有用过cookieJar，所以不知道它是否可用但你可以转储派生类

```
from cPickle import dumps
from cookielib import CookieJar
import threading

class MyCookieJar(CookieJar):
    def __getstate__(self):
        state = self.__dict__.copy()
        del state['_cookies_lock']
        return state

    def __setstate__(self, state):
        self.__dict__ = state
        self._cookies_lock = threading.RLock()

class Person(object):
    def __init__(self, name):
        self.name = name
        self.cookies = MyCookieJar()

bob = Person("bob")
print dumps(bob) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-21T04:56:19.820

`CookieJar`不是特别为持久化而设计的（这就是`FileCookieJar`子类的主要内容！-），但是您可以遍历一个`CookieJar`实例以获取所有 cookie（并持久化这些 cookie 的列表，例如），并重建给定的 jar cookie，`set_cookie`在每个上使用。这就是我将如何设置持久化和非持久化 cookie 罐，`copy_reg`如果我需要经常使用它们，使用该方法注册适当的函数。

# php - 是否有将 POSIX 转换为 PHP 的 PCRE 的实用程序？

> ID：1023227
> 
> 赞同：7
> 
> 时间：2009-06-21T04:47:37.787
> 
> 标签：php, regex, posix, utilities, pcre

是否有将 POSIX 转换为 PHP 的 PCRE 的实用程序？我对 PCRE 的 PHP 手册有些困惑，虽然我会尝试查找有关 PCRE 的更多信息，但我想知道是否有人设计了这样的实用程序。

或者，如果有人能解释如何转换以下内容，那也可以：

```
ereg("^#[01-9A-F]{6}$", $sColor) 
```

但请解释它是如何完成的，而不仅仅是告诉我转换。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T06:33:18.727

```
preg_match("/^#[01-9A-F]{6}$/", $sColor)
```

```In this case you only need to add the two delimiters.

In perl you can write something like` 

```
if ( s =~ /x.+y/ )
{ print "match"; }
```

As you can see the actual regular expression is encapsulated in //. If you want to set an option on the regular expression you put it after the second /, e.g. switching the expression to ungreedy by default /x.+y/U
pcre now emulates this behaviour. Though you have to call a function you also have to provide the delimiters and set the options after the second delimiter. In perl the delimiter has to be /, with pcre you can chose more freely`

```
preg_match("/^#[01-9A-F]{6}$/", $sColor)
preg_match("!^#[01-9A-F]{6}$!", $sColor)
preg_match("#^\#[01-9A-F]{6}$#", $sColor) // need to escape the # within the expression here
preg_match("^#[01-9A-F]{6}$", $s颜色)
```

与 pcre 一样，最好选择表达式中没有出现的字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-03T16:24:13.983

`preg_match("/^#[01-9A-F]{6}$/D", $sColor)`

注意[`D`修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)。人们总是忘记它。没有它，`$`将允许最后一个换行符。像“#000000\n”这样的字符串会通过。这是 POSIX 和 PCRE 之间的细微差别。

而且，当然，`[01-9]`可以重写为`[0-9]`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-21T04:58:27.150

顺便说一句，PHP 支持 PCRE 和 POSIX 正则表达式。这是关于 POSIX 正则表达式的 PHP 手册部分，因此您不必转换它们：[http ://www.php.net/manual/en/book.regex.php](http://www.php.net/manual/en/book.regex.php)`

# postgresql - PostgreSQL 中的空间数据

> ID：1023229
> 
> 赞同：33
> 
> 时间：2009-06-21T04:50:08.640
> 
> 标签：postgresql, spatial

PostgreSQL 支持各种开箱即用的[几何类型](http://www.postgresql.org/docs/8.3/static/datatype-geometric.html)，以及许多似乎提供数据空间索引的几何[运算符](http://www.postgresql.org/docs/8.3/static/functions-geometry.html)和[GiST 索引。](http://www.postgresql.org/docs/8.3/static/gist.html)

然后还有[PostGIS](http://postgis.refractions.net/)，它是 PG 的扩展。

PG 和 PostGIS 中内置的空间支持有什么区别？

如果我的应用程序需要存储地理坐标（点、区域、多边形）然后高效地进行查询（例如多边形中的点、多边形相交），我需要 PostGIS 还是可以使用（可以说）更方便和更简单的构建-in 数据类型/语法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-21T05:27:01.263

首先，我想澄清一下 GiST 索引：GiST 实际上是一个为新数据类型创建索引的框架，而不是任何特定的索引方案本身。这个框架恰好用于 Postgres 附带的几何类型，但它也用于标准文本列上的三元匹配文本相似度索引，当然也被许多外部包的索引方案使用，其中我们可以编号 PostGIS。

标准几何数据类型是否适合您或您需要 PostGIS 完全取决于您的应用程序。

PostGIS 将几何数据存储在“几何”类型的列中；在这里，您可以存储或多或少的任意数据（点、圆、多边形、你有什么）。索引是快速且非常复杂的：它可以使用边界框对复杂形状进行有损索引之类的事情，否则这些形状无法以任何合理的方式进行索引。支持不同的空间参考系统，自动转换查询结果。PostGIS 还支持行业标准的 OpenGIS 格式，有助于与其他系统共享数据。

相比之下，内部几何类型及其索引的集合就没有那么复杂了。没有真正的“通用”几何类型；相反，您必须选择将列的类型设为点、线、圆、多边形或其他类型；对于组合，您可能必须使用多个列。索引不太好；不能索引那么多不同类型的形状（尽管您可以通过为它们使用单​​独的列并手动生成边界框来添加边界框支持）并且在某些情况下索引可能没有那么快。另一方面，如果内部几何类型满足您的需求，您将获得优势，即您的应用程序更容易移植到安装了 Postgres 但未安装 PostGIS 的其他系统。

我的建议是使用内部几何类型，看看它对你的效果如何；如果您开始遇到问题，请尝试 PostGIS。

# google-app-engine - Google Appengine 数据存储的层次结构优化

> ID：1023234
> 
> 赞同：4
> 
> 时间：2009-06-21T04:55:23.113
> 
> 标签：google-app-engine, google-cloud-datastore

我使用如下所示的模型将分层数据存储在数据存储中：

```
class ToolCategories(db.Model):  
   name = db.StringProperty()  
   parentKey = db.SelfReferenceProperty(collection_name="parent_category")  
   ...  
   ... 
```

我想打印所有保留层次结构的类别名称，例如以如下形式：

```
--Information Gathering  
----OS Fingerprinting  
----DNS  
------dnstool  
----Port Scanning   
------windows  
--------nmap  
----DNS3  
----wireless sniffers  
------Windows  
--------Kismet 
```

为此，我使用了使用反向引用功能的简单递归：

```
class GetAllCategories (webapp.RequestHandler) :

        def RecurseList(self, object, breaks) :
                output = breaks + object.name + "</br>"
                for cat in object.parent_category:
                        output = output + self.RecurseList(cat, breaks + "--")

                return output

        def get (self) :
                output = ""
                allCategories = ToolCategories.all().filter(' parentKey = ', None)
                for category in allCategories :
                        output = output + self.RecurseList(category, "--")

                self.response.out.write(output) 
```

由于我对 App 引擎编程非常陌生（距离我开始编写代码还不到 3 天），我不确定从数据存储访问的角度来看，这是否是完成所需工作的最优化方式。

这是最好的方法吗？如果不是，那是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T12:34:17.907

您的方法的主要缺点是，因为您使用“邻接表”表示树的方式，您必须对树的每个分支进行一次数据存储查询。数据存储查询相当昂贵（每个大约 160 毫秒），因此构建树，特别是如果它很大，可能会相当昂贵）。

还有另一种方法，本质上是数据存储区用来表示实体组的方法：不只是存储父键，而是使用 ListProperty 存储整个祖先列表：

```
class ToolCategories(db.Model):
  name = db.StringProperty()
  parents = db.ListProperty(db.Key) 
```

然后，要构建树，您可以在一个查询中检索整个事物：

```
q = ToolCategories.all().filter('parents =', root_key) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T05:00:24.667

你有一个非常合理的方法！我的主要警告是与 GAE 几乎没有关系，而与 Python 有很大关系：**不要**`+`从带有or的片段构建字符串`+=`。相反，您制作了一个字符串片段列表（使用`append`or`extend`或列表推导 &c），当您完成所有操作后，您将其加入到最终的字符串结果中`''.join(thelist)`。尽管最近的 Python 版本努力优化or循环的内在`O(N squared)`性能，但最终你总是最好在此过程中构建字符串列表并在最后完成它们！`+``+=``''.join`

# c++ - VC9 中的字符串流错误？“无法访问私人会员”

> ID：1023236
> 
> 赞同：0
> 
> 时间：2009-06-21T04:56:20.490
> 
> 标签：c++, stl, stringstream, visual-c++-2008

```
std::string str;
std::stringstream strm(str); 
```

我收到此错误：

> 错误 11 错误 C2248：“std::basic_ios<_Elem,_Traits>::basic_ios”：无法访问在类“std::basic_ios<_Elem,_Traits>”c:\program files\microsoft visual studio 9.0\vc 中声明的私有成员\包括\流517

如果我使用 istringstream，也会发生同样的情况。

编译器：Visual C++ 2008。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T05:02:16.863

```
#include <string>
#include <sstream>

int main( int argc, char *argv[] ) {
    std::string str;
    std::stringstream strm( str );

    return 0;
} 
```

在 VS 2008 中编译正常，对我没有错误/警告。你能发布完整的代码吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T05:05:22.413

听起来您正在尝试复制流。这是不可能的，因为复制构造函数是私有的。

# .net - 在 .NET 中实现虚拟文件系统

> ID：1023238
> 
> 赞同：13
> 
> 时间：2009-06-21T04:56:53.970
> 
> 标签：.net, filesystems, virtual

不久前，a 发现了一个漂亮的框架，它允许 .net 开发人员实现虚拟文件系统。我以为我已经为它添加了书签，但似乎我没有。

有谁知道这样做的任何框架？

**编辑：**这里有一个提示......它有一个吸引人的短名称和它自己的域。抱歉，我只记得这些了:p

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2021-03-04T08:07:07.763

在这里，我将尝试总结我在 .NET 中为 Windows、Mac 和 iOS 构建虚拟文件系统的知识。本小结主要针对远程存储速度较慢的文件系统，如云存储。

首先，让我指出，应用程序和操作系统都会对本地文件系统进行大量读取和写入，并期望得到非常快速的响应。因此，几乎不可能将每个文件系统调用映射到远程存储调用。即使使用非常高速的连接（或本地存储），您的虚拟文件系统也可能会变得非常缓慢且无法使用这种设计。我猜想，最近的操作系统更新（2018-2021 年）中提供的新操作系统 API，以及在其之上创建的 OneDrive 等最终用户工具，都是以这些考虑为指导的。

用于创建虚拟文件系统的新 OS API 主要依赖于同步，而不是每个操作映射，为实现按需文件夹列表、按需文件下载、删除和移动操作提供额外的钩子。

# 视窗

## 云提供商 API

[Windows Cloud Provider API](https://docs.microsoft.com/en-us/windows/win32/cfapi/cloud-files-api-portal)（也称为 Cloud Files、Cloud Filter API 和 Cloud Sync Engine）在新的 Windows 驱动程序之上运行，该驱动程序作为 Windows 10 更新的一部分安装，于 2018 年发布（Windows Creator 更新）。

此 API 为按需文件夹列表提供[回调](https://docs.microsoft.com/en-us/windows/win32/api/cfapi/ne-cfapi-cf_callback_type)（因此您只能加载客户端应用程序请求的服务器文件系统的一小部分）、按需文件内容下载以及删除和移动/重命名操作的回调。它还提供确定文件状态的功能，您将使用这些功能来检测文件在客户端已被修改并需要发送到服务器。另一个有用的功能是它提供与 Windows 文件管理器的集成，显示文件状态栏、文件传输进度，并将文件下载事件发布到 Windows 操作中心面板。该 API 不需要管理员权限，并允许在普通用户下进行所有操作，包括初始文件系统挂载。

幸运的是，Windows Cloud Provider API 提供了文件打开和关闭事件，这对于某些应用程序可能至关重要，例如文件锁定/解锁或签出/签入。与 Mac OS 不同，其中打开/关闭事件仅限于某些应用程序类型，请参阅下面的 Mac 部分。

[GitHub 上的 C++](https://docs.microsoft.com/en-us/windows/win32/cfapi/build-a-cloud-file-sync-engine)
[示例 GitHub 上的 C# 示例。](https://github.com/ITHit/UserFileSystemSamples/tree/master/Windows/VirtualFileSystem)

## 投影文件系统 API

[投影文件系统 (ProjFS)](https://docs.microsoft.com/en-us/windows/win32/projfs/projected-file-system)旨在将（投影）分层数据表示为文件系统。它旨在从高速存储（例如注册表）发布数据。

它的主要特点是，与 Cloud Provider API 不同，它隐藏了您的存储是远程的这一事实。它不提供文件状态、进度或任何会告诉用户这不是本地文件系统的任何指示。

[GitHub 上的 C# 示例](https://github.com/Microsoft/VFSForGit)

## 内核模式文件系统驱动程序和过滤器

这是一种已经存在多年的传统方法。它适用于所有 Windows 版本，甚至是 20 年前发布的版本。构建一个稳定的驱动需要大量特殊的内核模式开发和调试经验，对抗系统崩溃，以及较长的开发周期。作为回报，它使您可以 100% 地访问低级别的所有文件系统功能。内核模式驱动程序最合适的用途可能是为本地硬件创建虚拟文件系统。

我担心在未来的 Windows 版本中创建文件系统驱动程序/过滤器可能会受到限制。请参阅下面的 Apple 在 Mac 上使用 Kext 驱动程序所做的事情。

## Shell 命名空间扩展

Windows [Shell 命名空间扩展](https://docs.microsoft.com/en-us/windows/win32/shell/namespace-intro)允许您自定义 Windows 文件管理器。特别是，您可以构建将在 Windows 文件管理器中显示并在视觉上看起来和行为类似于文件系统的节点。您还可以使用 Shell Extensions 扩展[Windows 文件管理器上下文菜单。](https://docs.microsoft.com/en-us/windows/win32/shell/context)Shell Extension 不是真正的文件系统，应用程序将无法将数据读/写到您的文件中（除非您在 shell 扩展下放置了一个真实的或一些虚拟的文件系统）。在许多情况下，您将在虚拟文件系统之上创建一个 Shell 扩展来扩展其功能并添加上下文菜单。

# 苹果系统

## 适用于 Mac 和系统扩展的文件提供程序 API。

自 macOS 11 Big Sur 以来，Apple 提供了一个用于与云存储同步的新 API—— [File Provider API](https://developer.apple.com/documentation/endpointsecurity)。其主要功能类似于Windows上的Cloud Provider API：按需列出文件夹、按需加载文件内容、文件状态（在云端/正在下载/在本地文件系统中、同步中/已修改）、Mac OS查找器集成。使用此 API 的应用程序不需要管理员权限即可安装和使用，可以按用户和机器模式安装，也可以在 Apple App Store 中发布。

看起来这个 API 的主要问题是它不提供文件打开和文件关闭事件。如果没有这些事件，可能很难或不可能创建某些功能，例如，在打开/关闭时自动锁定/解锁或签出/签入文件。出于某种原因，Mac 为[Endpoint Security](https://developer.apple.com/documentation/endpointsecurity)系统扩展提供了打开/关闭事件，这需要特殊权利（例如防病毒扫描程序）。

[GitHub 上 Xamarin/C# 中的示例](https://github.com/ITHit/UserFileSystemSamples/tree/master/macOS)

## Kext 文件系统驱动程序（已弃用）。

自 macOS 11 起，Apple 仅允许在恢复模式下在 ARM 机器上安装 Kext 驱动程序。App Store 中也不允许使用它们。Kexts 被 Dexts 和系统扩展取代。

# iOS

## iOS 的文件提供程序 API

iOS 11+ 提供了类似于 Mac 上的 File Provider API 的 File Provider API [。](https://developer.apple.com/design/human-interface-guidelines/ios/extensions/file-providers/)Apple 正在尝试统一 API 并让程序在 Mac 和 iOS 上运行，而只需进行最少的更改。iOS 和 macOS API 仍然存在一些差异，限制了为两个操作系统创建单个文件提供程序。

[.NET/C# 中 GitHub 上的示例](https://github.com/ITHit/WebDAVClientSamples/tree/master/iOS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-27T12:41:33.117

刚刚找到（开心！）

[多坎](https://dokan-dev.github.io/ "多坎")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T05:03:21.603

这可能是它吗？

[http://www.codeproject.com/KB/vb/QVFS.aspx](http://www.codeproject.com/KB/vb/QVFS.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T20:21:43.513

[http://vfs.codeplex.com/](http://vfs.codeplex.com/)或[http://code.google.com/p/sharpfilesystem/](http://code.google.com/p/sharpfilesystem/)怎么样

# asp.net-mvc - 树路径的asp.net mvc复杂路由

> ID：1023252
> 
> 赞同：12
> 
> 时间：2009-06-21T05:05:42.397
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我想知道如何定义这样的路由图：

```
{TreePath}/{Action}{Id} 
```

TreeMap 是从数据库中动态加载的，如下所示：

```
 'Gallery/GalleryA/SubGalleryA/View/3' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-21T10:20:31.313

您可以创建一个自定义路由处理程序来执行此操作。实际路线是包罗万象的：

```
routes.MapRoute(
    "Tree",
    "Tree/{*path}",
    new { controller = "Tree", action = "Index" })
        .RouteHandler = new TreeRouteHandler(); 
```

树处理程序查看路径，将最后一部分提取为操作，然后重定向到控制器。动作部分也从路径中删除。添加 {id} 部分应该很简单。

```
public class TreeRouteHandler : IRouteHandler
{
    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        string path = requestContext.RouteData.Values["path"] as string;

        if (path != null)
        {
            int idx = path.LastIndexOf('/');
            if (idx >= 0)
            {
                string actionName = path.Substring(idx+1);
                if (actionName.Length > 0)
                {
                    requestContext.RouteData.Values["action"] = actionName;
                    requestContext.RouteData.Values["path"] = 
                        path.Substring(0, idx);
                }
            }
        }

        return new MvcHandler(requestContext);
    }
} 
```

然后，您的控制器将按您的预期工作：

```
public class TreeController : Controller
{
    public ActionResult DoStuff(string path)
    {
        ViewData["path"] = path;
        return View("Index");
    }
} 
```

现在您可以调用 URL，如`/Tree/Node1/Node2/Node3/DoStuff`. 动作得到的路径是`Node1/Node2/Node3`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T05:29:26.657

可以换个网址吗？如果您可以将 {TreePath} 参数作为最后一个参数，则可以使用一条路线轻松完成此操作。

```
 routes.MapRoute("TreeRoute", 
                    "{Action}/{id}/{*TreePath}", 
                    new TreeRouteHandler())); 
```

通配符 catchall 参数必须是最后一个参数。

否则，我认为您将不得不定义多个参数，一个来匹配 TreeMap URL 的每个可能部分。

请注意，如果两个路由参数之间没有一些文字文本，则永远不能一起定义它们。换句话说，你可以定义`{Action}/{Id}`，但你**永远不能**定义`{Action}{Id}`。当模式匹配时，路由引擎无法知道一个参数在哪里结束，而下一个参数从哪里开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-16T15:39:26.927

您可以在查询字符串中包含“贪婪”部分，只要您可以在它之后有固定部分，例如

```
/{*TreePath}/Edit/{id}
/{*TreePath}/Action/{id} 
```

请注意，上述路由中的操作不是可变的，因为贪婪的部分需要在某个文字值处停止（其他正斜杠）。如果您只在“树”上执行一些操作，我会工作，但如果您有很多操作会很麻烦，因为每个操作都需要自己的路由条目。

它不能开箱即用，但需要自定义路由。[您可以在此处](http://www.thecodejunkie.com/2008/11/supporting-complex-route-patterns-with.html)找到有关该主题的精彩文章，包括代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T00:53:17.513

我是 MVC 的新手，但其中一个要求是这个选项。我是一个 vb-er，所以我在转换代码时遇到了一些麻烦，但让它工作并想贡献一个示例解决方案： [www.proovit.com/Download/MvcApplication1.zip](http://www.proovit.com/Download/MvcApplication1.zip) 这是一个简单的标准 MVC 项目，我离开了代码和 bin 目录，但您可以从标准项目中复制它们。

o，您必须使用标签 app/bla/bla/bla 用于索引和 app/trade/order/view 用于订单页面。

# c - 有没有办法在 C 中进行柯里化？

> ID：1023261
> 
> 赞同：38
> 
> 时间：2009-06-21T05:12:58.287
> 
> 标签：c, functional-programming, currying

假设我有一个指向函数的指针`_stack_push(stack* stk, void* el)`。我希望能够调用`curry(_stack_push, my_stack)`并取回一个只需要`void* el`. 我想不出办法，因为 C 不允许运行时函数定义，但我知道这里有比我聪明得多的人 :)。有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-21T05:25:31.030

我发现了 Laurent Dami 的一篇论文，讨论了 C/C++/Objective-C 中的柯里化：

[使用 Curried 函数在 C/C++/Objective-c 中实现更多功能可重用性](http://asg.unige.ch/site/papers/Dami91a.pdf)

对它如何在 C 中实现感兴趣：

> 我们当前的实现使用现有的 C 构造来添加柯里化机制。这比修改编译器要容易得多，并且足以证明柯里化的兴趣。然而，这种方法有两个缺点。首先，柯里化函数不能进行类型检查，因此需要小心使用以避免错误。其次，curry 函数不知道它的参数的大小，并且将它们当作整数大小来计算。

本文不包含 的实现`curry()`，但您可以想象它是如何使用[函数指针](http://www.newty.de/fpt/index.html)和[可变参数函数](http://en.wikipedia.org/wiki/Stdarg.h)实现的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-12T12:44:04.510

GCC 为嵌套函数的定义提供了扩展。虽然这不是 ISO 标准 C，但这可能会引起一些兴趣，因为它可以很方便地回答这个问题。简而言之，嵌套函数可以访问父函数的局部变量，并且父函数也可以返回指向它们的指针。

这是一个简短的、不言自明的示例：

```
#include <stdio.h>

typedef int (*two_var_func) (int, int);
typedef int (*one_var_func) (int);

int add_int (int a, int b) {
    return a+b;
}

one_var_func partial (two_var_func f, int a) {
    int g (int b) {
        return f (a, b);
    }
    return g;
}

int main (void) {
    int a = 1;
    int b = 2;
    printf ("%d\n", add_int (a, b));
    printf ("%d\n", partial (add_int, a) (b));
} 
```

然而，这种结构存在局限性。如果您保留指向结果函数的指针，如

```
one_var_func u = partial (add_int, a); 
```

函数调用`u(0)`可能会导致意外行为，因为读取的变量`a`在`u`终止后立即被破坏`partial`。

请参阅[GCC 文档的这一部分](http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html#Nested-Functions)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T05:32:05.283

这是我的第一个猜测（可能不是最好的解决方案）。

curry 函数可以在堆外分配一些内存，并将参数值放入堆分配的内存中。诀窍是让返回的函数知道它应该从堆分配的内存中读取它的参数。如果返回函数只有一个实例，那么指向这些参数的指针可以存储在单例/全局中。否则，如果返回函数的实例不止一个，那么我认为 curry 需要*在堆分配的内存中创建返回函数的每个实例*（通过将诸如“获取指向参数的指针”、“推送参数”和“调用其他函数”之类的操作码写入堆分配的内存中）。在那种情况下，您需要注意分配的内存是否可执行，并且可能（我不知道）甚至害怕防病毒程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-03-30T06:47:30.347

**好消息：**有一种方法可以在标准 ANSI C 中编写程序，而无需使用任何编译器特定的功能。（特别是它*不需要*`gcc`的嵌套[函数支持](https://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html)。）

**坏消息：**它需要创建一点点可执行代码来在运行时充当蹦床函数。这意味着实现将取决于：

*   处理器指令集
*   [ABI](https://en.wikipedia.org/wiki/Application_binary_interface)（特别是函数调用约定）
*   操作系统*将数据标记为可执行的能力*

**最好的消息：** 如果您只需要在真实的生产代码中执行此操作……您应该[使用`libffi`](https://www.chiark.greenend.org.uk/doc/libffi-dev/html/The-Closure-API.html#The-Closure-API). 它是许可许可的，并且包含针对[许多平台和 ABI](https://github.com/libffi/libffi#supported-platforms)的谨慎、灵活的实现。

* * *

如果您还在这里，您想了解一下如何“从头开始”实现这一点。</p>

下面的程序演示了如何在 C 中将 2 参数函数柯里化为 1 参数函数，给定...</p>

*   x86-64 处理器架构
*   [系统 V ABI](https://wiki.osdev.org/System_V_ABI)
*   Linux操作系统

它基于 [Infectious Executable Stacks](https://nullprogram.com/blog/2019/11/15)中的“Trampoline Illustration” ，但蹦床结构存储在*堆*（通过`malloc`）而不是堆栈上。这更安全，因为这意味着我们不必禁用编译器的堆栈执行保护（否`gcc -Wl,-z,execstack`）。

它使用[Linux`mprotect`系统调用](https://stackoverflow.com/a/23277109/20789)使堆对象可执行。

该程序的本质是它接受一个指向双参数函数 ( `uint32_t (*fp2)(uint32_t a, uint32_t b)`) 的指针并将其转换为指向单参数函数 ( `uint32_t (*fp1)(uint32_t a)`)的指针，该函数以参数`fp1`的预设值调用`b`。它通过创建小的 3 指令蹦床函数来做到这一点：

```
movl $imm32, %esi  /* $imm32 filled in with the value of 'b' */
movq %imm64, %rax  /* $imm64 filled in with the value of 'fp2' */
jmpq *%rax 
```

将 和 的值适当`b`地`fp2`缝合到其中后，指向包含这 3 条指令的内存块的指针可以`fp1`准确地用作单参数函数指针，如上所述。这是因为它遵循[x86-64 System V 调用约定](https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI)，其中单参数函数在 / 寄存器中接收它们的第一个参数`%edi`，`%rdi`而双参数函数在`%esi`/`%rsi`寄存器中接收第二个参数。在这种情况下，单参数 trampoline 函数接收其`uint32_t`参数 in ，然后将第二个参数`%edi`的值填入，然后直接跳转到“真正的”双参数函数，该函数期望其两个参数恰好在那些寄存器中。`uint32_t``%esi`

这是完整的工作代码，我也将其放在 GitHub 上的[dlenski/c-curry](https://github.com/dlenski/c-curry)：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#include <unistd.h>
#include <sys/mman.h>
#include <stdint.h>

#define PAGE_START(P) ((uintptr_t)(P) & ~(pagesize-1))
#define PAGE_END(P)   (((uintptr_t)(P) + pagesize - 1) & ~(pagesize-1))

/* x86-64 ABI passes parameters in rdi, rsi, rdx, rcx, r8, r9
 * (https://wiki.osdev.org/System_V_ABI), and return value
 * goes in %rax.
 *
 * Binary format of useful opcodes:
 *
 *       0xbf, [le32] = movl $imm32, %edi (1st param)
 *       0xbe, [le32] = movl $imm32, %esi (2nd param)
 *       0xba, [le32] = movl $imm32, %edx (3rd param)
 *       0xb9, [le32] = movl $imm32, %ecx (4rd param)
 *       0xb8, [le32] = movl $imm32, %eax
 * 0x48, 0x__, [le64] = movq $imm64, %r__
 *       0xff, 0xe0   = jmpq *%rax
 */

typedef uint32_t (*one_param_func_ptr)(uint32_t);
one_param_func_ptr curry_two_param_func(
    void *two_param_func, 
    uint32_t second_param)
{
    /* This is a template for calling a "curried" version of 
     * uint32_t (*two_param_func)(uint32_t a, uint32_t b),
     * using the Linux x86-64 ABI. The curried version can be
     * treated as uint32_t (*one_param_func)(uint32_t a).
     */
    uintptr_t fp = (uintptr_t)two_param_func;
    uint8_t template[] = {
        0xbe, 0, 0, 0, 0,                                   /* movl $imm32, %esi */
        0x48, 0xb8, fp >>  0, fp >>  8, fp >> 16, fp >> 24, /* movq fp, %rax */
                    fp >> 32, fp >> 40, fp >> 48, fp >> 56,
        0xff, 0xe0                                          /* jmpq *%rax */
    };

    /* Now we create a copy of this template on the HEAP, and
     * fill in the second param. */
    uint8_t *buf = malloc(sizeof(template));
    if (!buf)
        return NULL;

    memcpy(buf, template, sizeof(template));
    buf[1] = second_param >> 0;
    buf[2] = second_param >> 8;
    buf[3] = second_param >> 16;
    buf[4] = second_param >> 24;

    /* We do NOT want to make the stack executable,
     * but we NEED the heap-allocated buf to be executable.
     * Compiling with 'gcc -Wl,-z,execstack' would do BOTH.
     *
     * This appears to be the right way to only make a heap object executable:
     *   https://stackoverflow.com/a/23277109/20789
     */
    uintptr_t pagesize = sysconf(_SC_PAGE_SIZE);
    mprotect((void *)PAGE_START(buf),
             PAGE_END(buf + sizeof(template)) - PAGE_START(buf),
             PROT_READ|PROT_WRITE|PROT_EXEC);

    return (one_param_func_ptr)buf;
}

/********************************************/

int print_both_params(int a, int b)
{
    printf("Called with a=%d, b=%d\n", a, b);
    return a+b;
}

int main(int argc, char **argv)
{
    one_param_func_ptr print_both_params_b4 =
        curry_two_param_func(print_both_params, 4);
    one_param_func_ptr print_both_params_b256 = 
        curry_two_param_func(print_both_params, 256);

    print_both_params_b4(3);    // "Called with a=3, b=4"
    print_both_params_b256(6);  // "Called with a=6, b=256"

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-22T15:16:55.693

这是在 C 中进行柯里化的一种方法。虽然此示例应用程序使用 C++ iostream 输出为方便起见，但它都是 C 风格的编码。

这种方法的关键是要有一个`struct`包含一个数组的数组，`unsigned char`这个数组用于为函数建立一个参数列表。要调用的函数被指定为推入数组的参数之一。然后将结果数组提供给代理函数，该函数实际执行函数和参数的闭包。

在这个例子中，我提供了几个类型特定的帮助函数来将参数推送到闭包中，以及一个通用`pushMem()`函数来推送一个`struct`或其他内存区域。

这种方法确实需要分配一个内存区域，然后用于闭包数据。最好将堆栈用于该内存区域，这样内存管理就不会成为问题。还有一个问题是要使闭包存储内存区域有多大，以便有足够的空间容纳必要的参数，但又不会太大，以至于内存或堆栈中的多余空间被未使用的空间占用。

我已经尝试过使用定义略有不同的闭包结构，它包含一个附加字段，用于存储用于存储闭包数据的数组的当前使用大小。然后，这种不同的闭包结构与修改后的辅助函数一起使用，这消除了辅助函数的用户在`unsigned char *`向闭包结构添加参数时维护自己的指针的需要。

**注意事项和注意事项**

以下示例程序是使用 Visual Studio 2013 编译和测试的。下面提供了此示例的输出。我不确定在此示例中是否使用 GCC 或 CLANG，也不确定 64 位编译器可能会出现的问题，因为我的印象是我的测试是使用 32 位应用程序进行的。此外，这种方法似乎只适用于使用标准 C 声明的函数，其中调用函数在被调用者返回后处理从堆栈中弹出参数（`__cdecl`而不是`__stdcall`在 Windows API 中）。

由于我们在运行时构建参数列表，然后调用代理函数，因此这种方法不允许编译器对参数执行检查。由于编译器无法标记的参数类型不匹配，这可能会导致神秘的失败。

**示例应用程序**

```
// currytest.cpp : Defines the entry point for the console application.
//
// while this is C++ usng the standard C++ I/O it is written in
// a C style so as to demonstrate use of currying with C.
//
// this example shows implementing a closure with C function pointers
// along with arguments of various kinds. the closure is then used
// to provide a saved state which is used with other functions.

#include "stdafx.h"
#include <iostream>

// notation is used in the following defines
//   - tname is used to represent type name for a type
//   - cname is used to represent the closure type name that was defined
//   - fname is used to represent the function name

#define CLOSURE_MEM(tname,size) \
    typedef struct { \
        union { \
            void *p; \
            unsigned char args[size + sizeof(void *)]; \
        }; \
    } tname;

#define CLOSURE_ARGS(x,cname) *(cname *)(((x).args) + sizeof(void *))
#define CLOSURE_FTYPE(tname,m) ((tname((*)(...)))(m).p)

// define a call function that calls specified function, fname,
// that returns a value of type tname using the specified closure
// type of cname.
#define CLOSURE_FUNC(fname, tname, cname) \
    tname fname (cname m) \
    { \
        return ((tname((*)(...)))m.p)(CLOSURE_ARGS(m,cname)); \
    }

// helper functions that are used to build the closure.
unsigned char * pushPtr(unsigned char *pDest, void *ptr) {
    *(void * *)pDest = ptr;
    return pDest + sizeof(void *);
}

unsigned char * pushInt(unsigned char *pDest, int i) {
    *(int *)pDest = i;
    return pDest + sizeof(int);
}

unsigned char * pushFloat(unsigned char *pDest, float f) {
    *(float *)pDest = f;
    return pDest + sizeof(float);
}

unsigned char * pushMem(unsigned char *pDest, void *p, size_t nBytes) {
    memcpy(pDest, p, nBytes);
    return pDest + nBytes;
}

// test functions that show they are called and have arguments.
int func1(int i, int j) {
    std::cout << " func1 " << i << " " << j;
    return i + 2;
}

int func2(int i) {
    std::cout << " func2 " << i;
    return i + 3;
}

float func3(float f) {
    std::cout << " func3 " << f;
    return f + 2.0;
}

float func4(float f) {
    std::cout << " func4 " << f;
    return f + 3.0;
}

typedef struct {
    int i;
    char *xc;
} XStruct;

int func21(XStruct m) {
    std::cout << " fun21 " << m.i << " " << m.xc << ";";
    return m.i + 10;
}

int func22(XStruct *m) {
    std::cout << " fun22 " << m->i << " " << m->xc << ";";
    return m->i + 10;
}

void func33(int i, int j) {
    std::cout << " func33 " << i << " " << j;
}

// define my closure memory type along with the function(s) using it.

CLOSURE_MEM(XClosure2, 256)           // closure memory
CLOSURE_FUNC(doit, int, XClosure2)    // closure execution for return int
CLOSURE_FUNC(doitf, float, XClosure2) // closure execution for return float
CLOSURE_FUNC(doitv, void, XClosure2)  // closure execution for void

// a function that accepts a closure, adds additional arguments and
// then calls the function that is saved as part of the closure.
int doitargs(XClosure2 *m, unsigned char *x, int a1, int a2) {
    x = pushInt(x, a1);
    x = pushInt(x, a2);
    return CLOSURE_FTYPE(int, *m)(CLOSURE_ARGS(*m, XClosure2));
}

int _tmain(int argc, _TCHAR* argv[])
{
    int k = func2(func1(3, 23));
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    XClosure2 myClosure;
    unsigned char *x;

    x = myClosure.args;
    x = pushPtr(x, func1);
    x = pushInt(x, 4);
    x = pushInt(x, 20);
    k = func2(doit(myClosure));
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    x = myClosure.args;
    x = pushPtr(x, func1);
    x = pushInt(x, 4);
    pushInt(x, 24);               // call with second arg 24
    k = func2(doit(myClosure));   // first call with closure
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;
    pushInt(x, 14);              // call with second arg now 14 not 24
    k = func2(doit(myClosure));  // second call with closure, different value
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    k = func2(doitargs(&myClosure, x, 16, 0));  // second call with closure, different value
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    // further explorations of other argument types

    XStruct xs;

    xs.i = 8;
    xs.xc = "take 1";
    x = myClosure.args;
    x = pushPtr(x, func21);
    x = pushMem(x, &xs, sizeof(xs));
    k = func2(doit(myClosure));
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    xs.i = 11;
    xs.xc = "take 2";
    x = myClosure.args;
    x = pushPtr(x, func22);
    x = pushPtr(x, &xs);
    k = func2(doit(myClosure));
    std::cout << " main (" << __LINE__ << ") " << k << std::endl;

    x = myClosure.args;
    x = pushPtr(x, func3);
    x = pushFloat(x, 4.0);

    float dof = func4(doitf(myClosure));
    std::cout << " main (" << __LINE__ << ") " << dof << std::endl;

    x = myClosure.args;
    x = pushPtr(x, func33);
    x = pushInt(x, 6);
    x = pushInt(x, 26);
    doitv(myClosure);
    std::cout << " main (" << __LINE__ << ") " << std::endl;

    return 0;
} 
```

**测试输出**

此示例程序的输出。括号中的数字是进行函数调用的 main 中的行号。

```
 func1 3 23 func2 5 main (118) 8
 func1 4 20 func2 6 main (128) 9
 func1 4 24 func2 6 main (135) 9
 func1 4 14 func2 6 main (138) 9
 func1 4 16 func2 6 main (141) 9
 fun21 8 take 1; func2 18 main (153) 21
 fun22 11 take 2; func2 21 main (161) 24
 func3 4 func4 6 main (168) 9
 func33 6 26 main (175) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-31T05:22:29.683

> 因为 C 不允许运行时函数定义

这在[标准 C](https://en.cppreference.com/w/c)中原则上是正确的。阅读[n1570](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)了解详情。

然而，*在实践中*它可能是错误的。考虑

*   在 POSIX 系统（例如 Linux）上，在运行时在一些`/tmp/generated1234.c`定义某些函数的临时文件文件中生成一些 C 代码`void genfoo1234(void)`，编译该文件（例如，使用最近的[GCC](https://gcc.gnu.org/)编译器 as `gcc -O -fPIC -Wall -shared /tmp/generated1234.c -o /tmp/generated1234.so`）然后使用[dlopen(3)](https://man7.org/linux/man-pages/man3/dlopen.3.html)`/tmp/generated1234.so`然后[dlsym(3](https://man7.org/linux/man-pages/man3/dlsym.3.html) )在`genfoo1234`句柄返回`dlopen`以获取函数指针）。根据个人经验，这种方法在今天（2021 年，在 Linux 笔记本电脑上）已经足够快，即使是交互式使用（如果每个临时生成的 C 文件都有几百行 C 代码）。

*   在 x86、x86-64、ARM 处理器上使用一些机器代码生成库，如[GNU Lightning](https://www.gnu.org/software/lightning/)、[libgccjit](https://gcc.gnu.org/onlinedocs/jit/)（或 C++ 中的[asmjit](https://asmjit.com/)）

在实践中，您将为[闭包](https://en.wikipedia.org/wiki/Closure_(computer_programming))生成代码（将函数指针与封闭值分组）并将其用作[回调](https://en.wikipedia.org/wiki/Callback_(computer_programming))。

相关的一点是垃圾收集，所以请阅读[垃圾收集手册](https://gchandbook.org/)。

**还可以考虑在您的应用程序中嵌入一些现有的解释器**，例如[Lua](https://lua.org/)、[GNU guile](https://www.gnu.org/software/guile/)、[Python](https://python.org/)等......

研究一下这些解释器的源代码，至少是为了获得灵感。

Quenniec 的*Lisp in small pieces* 和[Dragon 的书](https://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)值得一​​读。两者都解释了实际问题和实施细节

另见[`__builtin_call_with_static_chain`](https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)最近的 GCC 编译器（2021 年）。

# iphone - 延迟但不禁用 iPhone 自动锁定

> ID：1023265
> 
> 赞同：5
> 
> 时间：2009-06-21T05:18:06.173
> 
> 标签：iphone, timer, delay, python-idle

我目前有一个非常简单的应用程序，唯一的交互就是摇动 iPhone。然而最终屏幕变暗并自动锁定，因为 iPhone 没有收到任何触摸事件。我想知道是否有办法在摇晃时重置自动锁定超时？

我知道要完全禁用自动锁定，我会这样做：

```
[[ UIApplication sharedApplication ] setIdleTimerDisabled: YES ] 
```

但我真的不想完全禁用它；如果 iPhone 没有被合法使用，它应该会按预期自动锁定。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-21T07:52:31.050

`[UIApplication sharedApplication].idleTimerDisabled`您可以根据自己的 NSTimer 或行为手势（摇晃手机）的值来切换 的值。它可以在您的应用程序中设置为`YES`/`NO`多次。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-07T17:21:41.990

这是我在我的应用程序中使用的代码。一点背景知识：我的应用程序有一个内置的网络服务器，因此用户可以通过 WIFI 从浏览器访问数据，每次请求到达服务器时，我都会延长锁定计时器（在这种情况下至少为 2 分钟；一旦重新启用，您仍然会获得添加的默认时间量）。

```
// disable idle timer for a fixed amount of time.
- (void) extendIdleTimerTimeout
{
    // cancel previous scheduled messages to turn idle timer back on
    [NSObject cancelPreviousPerformRequestsWithTarget:self
        selector:@selector(reenableIdleTimer)
        object:nil];
    // disable idle timer
    [[UIApplication sharedApplication] setIdleTimerDisabled:YES];

    // re-enable the timer on after specified delay.
    [self performSelector:@selector(reenableIdleTimer) withObject:nil afterDelay: 60 * 2];

}

- (void) reenableIdleTimer
{
sharedApplication].idleTimerDisabled );
    [NSObject cancelPreviousPerformRequestsWithTarget:self
        selector:@selector(reenableIdleTimer)
        object:nil];
    // disable idle timer
    [[UIApplication sharedApplication] setIdleTimerDisabled:NO];
} 
```

# html - 两步视图模式：XSLT 与对象图

> ID：1023281
> 
> 赞同：2
> 
> 时间：2009-06-21T05:35:34.530
> 
> 标签：html, xml, xslt, xhtml, view

我打算实现 Martin Fowler 的[两步视图模式](http://www.martinfowler.com/eaaCatalog/twoStepView.html) ，以便在我正在编写的 Web 应用程序中呈现 HTML。一般的想法是，它不是让应用程序输出原始 HTML，而是输出一个自定义的中间 XML，然后将其转换为 HTML/CSS。这具有许多优点，包括减少代码重复和更一致的输出。

Fowler 建议的将 XML 转换为最终 HTML 的方法是使用 XSLT。

我以前使用过 XSLT，而且我知道基础知识。但是，我想知道使用 XSLT 有什么好处。我正在考虑的另一种方法如下所示：

这是第一个渲染步骤的示例 XML 输出：

```
<grid>
   <headingRow>
      <cell>Product</cell>
      <cell>Price</cell>
   </headingRow>
   <row>
      <cell>A product</cell>
      <cell type="price">$54.95</cell>
   </row>
</grid> 
```

以及所需的最终 HTML 输出：

```
<table class="grid">
  <tr>
    <th>Product</th>
    <th>Price</th>
  </tr>
  <tr>
    <td>A product</td>
    <td>
      <span class="currency_symbol">$</span>
      <span class="decimal_number">54.95</span>
    </td>
  </tr>
</table> 
```

我正在考虑的方法是每个标签都有一个对象。

```
class GridTag extends Tag {
  ...
  public void render() {
    System.out.println("<table class=\"grid\">");
    foreach(Tag child: children) {
      child.render();
    }
    System.out.println("</table>");
  }
  ...
} 
```

这些对象将通过解析 XML 构造成一棵树。render() 方法将在根节点上调用。我特别喜欢这种方法，因为它可以让我做一些很酷的事情。特别是，如果我有一个像上面那样带有属性 type="price" 的单元格标签：

```
<cell type="price">$54.95</price> 
```

它关联的 Tag 类可以解析标签的内容，将货币符号和数值分隔成单独的 HTML 标签，以允许货币符号和小数点对齐，如上面的 HTML 输出所示。

```
<td>
  <span class="currency_symbol">$</span>
  <span class="decimal_number">54.95</span>
</td> 
```

**问题：**

我应该这样做还是应该使用 XSLT？我可能会错过使用 XSLT 的哪些优势？如果我应该使用 XSLT，我将如何解析价格标签的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T06:59:25.040

关于为什么你应该选择其中一个，我真的不能说太多。

我认为这在很大程度上取决于您的渲染过程的技术细节，您是否希望它发生在服务器或浏览器上，您对 XSLT 或 XSLT 替代方案的舒适程度。

XSLT 的一点当然*是*几乎不可能生成格式不正确的 XML 输出（我不是在说*有效*的）。写出字符串时很容易漏掉一些东西。

关于您的解析问题：毫无疑问，最好的方法是在 XML 中将数据和格式分开。XSLT 不用于解析，所以我不明白为什么您的 XML 从一开始就不能采用这种格式：

```
<cell type="price" symbol="$">54.95</cell> 
```

但是，假设您对此无能为力，这个 XSLT 会处理它。

```
<xsl:template match="cell[@type='price']">
  <td>
    <xsl:variable name="vNonNumbers" select="translate(., '0123456789.', '')" />
    <xsl:variable name="vTheNumbers" select="translate(., $vNonNumbers, '')" />
    <span class="currency_symbol">
      <xsl:value-of select="$vNonNumbers" />
    </span>
    <span class="decimal_number">
      <xsl:value-of select="$vTheNumbers" />
    </span>
  </td>
</xsl:template> 
```

我希望你能明白为什么上面的代码本质上是糟糕的代码。与替代方案比较（如果您的 XML*将*数据和格式分开）：

```
<xsl:template match="cell[@type='price']">
  <td>
    <span class="currency_symbol">
      <xsl:value-of select="@symbol" />
    </span>
    <span class="decimal_number">
      <xsl:value-of select="." />
    </span>
  </td>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T06:46:45.190

您提出的代码有一些问题。最大的问题是您将输出硬编码为标准输出，这使得进行额外的后处理变得更加困难。通过修改您的渲染方法以接受输出流或写入器来改变这一点并不难。

无论如何，您所提议的是大量的 java 代码，它们基本上将实现一个非常具体的 XSLT 转换。学习并使用 XSLT 将 XML 转换为 HTML 会好很多。优点是 XSLT 是专为这种转换而设计的通用工具。

这是一个 XSLT 示例，它几乎可以完成您想要做的事情。不幸的是，我对必须将货币价值解析为数字和符号部分的时间并不***关心***，但这当然足以让你开始。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
  <xsl:template match="/grid">
    <table class="grid">
      <xsl:apply-templates select="headingRow"/>
      <xsl:apply-templates select="row"/>
    </table>
  </xsl:template>
  <xsl:template match="headingRow">
      <tr>
        <xsl:apply-templates select="cell" mode="heading"/>
      </tr>
  </xsl:template>
  <xsl:template match="row">
      <tr>
        <xsl:apply-templates select="cell" mode="normal"/>
      </tr>
  </xsl:template>  
  <xsl:template match="cell" mode="heading">
    <th><xsl:value-of select="."/></th>
  </xsl:template>

  <xsl:template match="cell" mode="normal">
    <xsl:choose>
      <xsl:when test="@type='price'">
        <td>
          <span class="currency_symbol">
            <xsl:value-of select="." />
          </span>
          <span class="decimal_number">
            <xsl:value-of select="." />
          </span>
        </td>
      </xsl:when>
      <xsl:otherwise>
        <td>
          <xsl:value-of select="." />
        </td>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

# php - 使用 PHP 维护不同页面的对象状态

> ID：1023282
> 
> 赞同：3
> 
> 时间：2009-06-21T05:36:39.893
> 
> 标签：php, oop

如何使用 PHP OOP 来维护不同页面中的对象状态。

问题是我总是在每个页面上实例化对象。

有没有一种解决方案，我将它实例化一次并在不同的页面上维护它的对象。

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-21T05:40:14.133

在 PHP 中，几乎所有内容都会在每个页面点击时被实例化。如果你想保持状态，你有很多选择：

1.  对于特定于用户的数据，您可以将其放入 cookie 中（出于安全原因**不推荐）；**
2.  将特定于用户的数据放入会话中，这基本上意味着将其写入文件并在每次点击时从文件中加载；
3.  将其存储在某种形式的持久存储中，例如文件或数据库表；
4.  将其存储在某种缓存中（例如 memcached）。

您使用哪一种取决于数据是否是全局的、用户特定的等因素以及许多其他因素（例如读取频率、写入频率等）。

所以不可能给你一个明确的答案，因为你想要坚持的本质是不清楚的。如果您担心创建对象的成本，那么除非它**真的很**昂贵，否则不要。*在遇到*问题之前不要优化问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T08:10:19.733

您还可以查看对象序列化。您将在此处找到更多信息。[http://uk.php.net/serialize](http://uk.php.net/serialize)。这会将您的对象转换为可用于存储到会话数据中的格式。一旦您的数据存储在会话中，您就可以在下一个用户页面加载时读取数据并反序列化数据以取回您的对象！

这是一篇很好的文章，它展示了序列化如何允许您的对象在两个不同的 PHP 页面中使用。[http://www.phpbuilder.com/manual/en/language.oop.serialization.php](http://www.phpbuilder.com/manual/en/language.oop.serialization.php)

# iphone - 创建类似系统的高分系统，iPhone 端

> ID：1023289
> 
> 赞同：0
> 
> 时间：2009-06-21T05:45:15.857
> 
> 标签：iphone, objective-c, xcode, nsmutablearray

我很抱歉提出一个新问题，我不得不这样做 - 因为我以未注册用户的身份从我的 iPhone 上写了另一个问题，而且从 iPhone 上写起来不太舒服。

改写问题：

是否可以使用：

> [NSMutableArray writeToURL:(NSString *)path atomically:(BOOL)AuxSomething];

为了将文件 (NSMutableArray) XML 文件发送到 url，并更新 url 以包含该文件？

例如：我有一个数组，我想将它上传到一个特定的 URL，下次启动应用程序时我想下载该数组。

> NSMutableArray *arrayToWrite = [[NSMutableArray alloc] initWithObjects:@"One",@"Two",nil];
> 
> [arrayToWrite writeToURL：
> 
> [NSURL urlWithString:@"mywebsite.atwebpages.com/myArray.plist"] 原子：YES];

在运行时：

> NSMutableArray *arrayToRead =
> 
> [[NSMutableArray alloc] initWithContentsOfURL:[NSURL urlWithString:@"mywebsite.atwebpages.com/myArray.plist"]];

意思是，我想将一个 NSMutableArray 写入一个 URL，该 URL 位于 Web 托管服务
（例如 batcave.net）上，该 URL 接收信息并相应地更新服务器端文件。像设置这样的高分，用户发送他的分数，服务器更新它的文件，其他用户在运行时下载高分。

我希望这一点得到澄清。

编辑：我正在寻找的是编写 PHP 或 ASP 脚本，以便网站、数据发送到的 URL 知道如何处理它。如果可以在网络托管服务上执行此操作，我想要一个示例或教程，说明如何实现此脚本以处理数据。

〜提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T01:28:06.657

要回答“如何创建类似系统的高分？”这个问题，系统有多个部分：

*   您需要为每个用户提供一个 ID（在 iPhone 上生成的 GUID 以及用户名就足够了）。
*   您需要一台服务器： 记住高分；从用户那里获得高分；要么显示（在网站上）高分和/或使高分可下载到手机。
*   您需要一些欺诈保护，尽管这可能会与越狱者打一场失败的战斗。

在 iPhone 应用程序端，您可能希望能够下载当前的高分以进行显示，这很容易通过以下方式完成：

```
int statusCode = 0;
NSData* result = nil;
NSHTTPURLResponse* response = nil;
NSError* error = nil;
NSString* url = @"http://www.yourserver.com/highscores.php"; // returns XML plist data
NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:url] cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:180];
result = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
//  NSLog( @"NSURLConnection result %d %@ %@", [response statusCode], [request description], [error description] );
statusCode = [response statusCode];
if ( (statusCode == 0) || (!result && statusCode == 200) ) {
    statusCode = 500;
} 
```

由于它是同步的，您可能希望将其放在 NSOperation 中。或者，您可以使用

```
+ (NSURLConnection *)connectionWithRequest:(NSURLRequest *)request delegate:(id)delegate 
```

要发送高分数据，因为它非常小，最简单的方法就是在 URL 中对其进行编码。

```
NSString* url = [NSString stringWithFormat:@"http://www.yourserver.com/sethighscores.php?uid=%@;name=%@;score=%d;antifraud=%@", [uid encodeParameter], [name encodeParameter], score, [secureHash encodeParameter]]; 
```

其中 encodeParameter 是 NSString 上的一个自定义类别，它对 URL 参数进行编码，secureHash 是一个字符串，表示您的 iPhone 应用程序和您的网站已知的 uid、名称、分数和一些秘密的单向安全散列。您需要自己解决这些问题或提出单独的问题，因为这已经很长了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T09:35:22.027

根据 NSData writeToURL 文档（至少对于 iPhone OS 2.2.1）：

“由于目前只支持file://url，所以这个方法和writeToFile:atomically:没有区别，除了第一个参数的类型。”

尽管 NSArray/NSDictionary/NSString 的文档没有具体提及限制，但似乎很可能适用相同的限制。

因此，您必须使用其他机制上传 XML。

此外，网站通常是只读的，除非您在 Web 服务器上提供特定代码以支持上传。

# php - 如何从 MS DOC 文件中检索 PHP 中的孟加拉语数据

> ID：1023293
> 
> 赞同：1
> 
> 时间：2009-06-21T05:46:54.657
> 
> 标签：php, unicode

我想检索使用 UNICODE 以 MS word 文件编写的孟加拉语数据。如何使用 PHP 检索这些数据？我可以使用 Antiword 从 DOC 文件中检索英文数据。但我无法检索孟加拉语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T09:00:05.203

我使用 PHP 和 COM（仅在 Windows 服务器上）来读取文档文件。

通过 PHP 和 COM 从 Word 文档中提取文本

```
$word = new COM("word.application") or die ("Could not initialise MS Word object.");
$word->Documents->Open(realpath("Sample.doc")); 

# Extract content.
$content = (string) $word->ActiveDocument->Content; 

echo $content; 

$word->ActiveDocument->Close(false); 

$word->Quit();

$word = null; 

unset($word); 
```

我认为您必须使用 Windows 服务器才能正确完成此操作。或者您可以将文档转换为 OpenOffice 格式并试一试吗？有关 PHP COM 的更多详细信息，请参见此处。[http://us3.php.net/manual/en/book.com.php](http://us3.php.net/manual/en/book.com.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-09-10T05:49:12.323

您可以使用**fopen()**函数来解决这个问题。

# internet-explorer-8 - Watin - IE8 在 FileUpload.Set 上挂起

> ID：1023296
> 
> 赞同：0
> 
> 时间：2009-06-21T05:50:58.283
> 
> 标签：internet-explorer-8, watin

每当我调用 FileUpload.Set 时，IE8 都会打开文件浏览器窗口，然后就坐在那里而不输入任何文本。这是在 Windows XP 上，它曾经工作得很好，直到我从 Ie7 升级到 IE8。还有其他人遇到这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T00:59:16.197

原来 WatiN 源代码中的这一行是问题所在： if (Process.GetProcessById(window.ProcessID).ProcessName != "iexplore") return;

出于某种原因，这台机器上的 iexplore 进程全部大写显示为“IEXPLORE”。在进程名称中添加 .ToLower() 可以解决问题。

编辑：看起来这个错误已经被报告了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T18:38:48.610

由于 WatiN 查找对话框的方式（按样式编号），IE8 在低于 2.0 的版本中会被破坏是可以理解的。您可能想尝试使用 2.0 测试版。

或者，您可以在 FileUpload DialogHandler 上查看样式编号并添加 IE7 和 8（96CC20C4 和 96CC02C4）的样式编号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-02T07:18:48.497

我想发布此问题的更新，因为它在 Win7 操作系统中再次出现。

如果您在最新的 WatiN 版本中遇到同样的问题，您可以覆盖**FileUploadDialogHandler**类中的函数**CanHandleDialog**：

 **```
public override bool CanHandleDialog(Window window, System.IntPtr mainWindowHwnd)
{
   return true;
} 
```

这不是一个干净的解决方案，但它简单且有效。**

# c++ - 在没有 /proc/self/exe 的情况下查找当前可执行文件的路径

> ID：1023306
> 
> 赞同：224
> 
> 时间：2009-06-21T06:12:48.177
> 
> 标签：c++, c, linux, macos, executable

在我看来，Linux 使用 /proc/self/exe 很容易。但我想知道是否有一种方便的方法可以使用跨平台接口在 C/C++ 中找到当前应用程序的目录。我见过一些使用 argv[0] 的项目，但它似乎并不完全可靠。

如果你曾经必须支持没有 /proc/ 的 Mac OS X，你会怎么做？使用#ifdefs 隔离特定于平台的代码（例如NSBundle）？或者尝试从 argv[0]、$PATH 等推断出可执行文件的路径，冒着在极端情况下发现错误的风险？

* * *

## 回答 #1

> 赞同：377
> 
> 时间：2009-06-21T22:56:10.410

一些特定于操作系统的接口：

*   Mac OS X: [`_NSGetExecutablePath()`](https://stackoverflow.com/questions/799679/programatically-retrieving-the-absolute-path-of-an-os-x-command-line-app/1024933#1024933)( [man 3 dyld](https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/dyld.3.html) )
*   Linux：[`readlink /proc/self/exe`](https://man7.org/linux/man-pages/man5/proc.5.html)
*   索拉里斯：[`getexecname()`](http://download.oracle.com/docs/cd/E19253-01/816-5168/6mbb3hrb1/index.html)
*   自由BSD：[`sysctl CTL_KERN KERN_PROC KERN_PROC_PATHNAME -1`](https://stackoverflow.com/questions/799679)
*   *如果*FreeBSD有 procfs：`readlink /proc/curproc/file`（FreeBSD 默认没有 procfs）
*   NetBSD：`readlink /proc/curproc/exe`
*   蜻蜓 BSD：`readlink /proc/curproc/file`
*   窗户：[`GetModuleFileName()`](https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea)带`hModule`=`NULL`

也有第三方库可用于获取此信息，例如[骄傲的答案中提到的 whereami](https://stackoverflow.com/a/32793556/112212)，或者如果您使用的是 Qt，则 [QCoreApplication::applicationFilePath()](https://doc.qt.io/qt-5/qcoreapplication.html#applicationFilePath)如评论中所述。

可移植（但不太可靠）的方法是使用`argv[0]`. 尽管调用程序可以将其设置为任何内容，但按照惯例，它设置为可执行文件的路径名或使用找到的名称`$PATH`.

一些 shell，包括 bash 和 ksh，在执行之前[将环境变量“ `_`”](http://www.gnu.org/software/bash/manual/bashref.html#Environment)设置为可执行文件的完整路径。在这种情况下，您可以使用`getenv("_")`它来获取它。然而，这是不可靠的，因为并非所有的 shell 都这样做，并且它可以设置为任何内容，也可以从在执行程序之前没有更改它的父进程遗留下来。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-12-14T16:25:29.183

The use of `/proc/self/exe` is non-portable and unreliable. On my Ubuntu 12.04 system, you must be root to read/follow the symlink. This will make the Boost example and probably the `whereami()` solutions posted fail.

This post is very long but discusses the actual issues and presents code which actually works along with validation against a test suite.

The best way to find your program is to retrace the same steps the system uses. This is done by using `argv[0]` resolved against file system root, pwd, path environment and considering symlinks, and pathname canonicalization. This is from memory but I have done this in the past successfully and tested it in a variety of different situations. It is not guaranteed to work, but if it doesn't you probably have much bigger problems and it is more reliable overall than any of the other methods discussed. There are situations on a Unix compatible system in which proper handling of `argv[0]` will not get you to your program but then you are executing in a certifiably broken environment. It is also fairly portable to all Unix derived systems since around 1970 and even some non-Unix derived systems as it basically relies on libc() standard functionality and standard command line functionality. It should work on Linux (all versions), Android, Chrome OS, [Minix](https://duckduckgo.com/html/?q=Wikipedia%20Minix), original Bell Labs Unix, [FreeBSD](https://en.wikipedia.org/wiki/FreeBSD), [NetBSD](https://en.wikipedia.org/wiki/NetBSD), [OpenBSD](https://en.wikipedia.org/wiki/OpenBSD), [BSD](https://en.wikipedia.org/wiki/Berkeley_Software_Distribution) x.x, SunOS, [Solaris](https://en.wikipedia.org/wiki/Solaris_%28operating_system%29), SYSV, [HP-UX](https://en.wikipedia.org/wiki/HP-UX), Concentrix, SCO, Darwin, [AIX](https://en.wikipedia.org/wiki/IBM_AIX), OS X, [NeXTSTEP](https://en.wikipedia.org/wiki/NeXTSTEP), etc. And with a little modification probably [VMS](https://en.wikipedia.org/wiki/OpenVMS#Origin_and_name_changes), VM/CMS, DOS/Windows, [ReactOS](https://en.wikipedia.org/wiki/ReactOS), [OS/2](https://duckduckgo.com/html/?q=Wikipedia%20OS/2), etc. If a program was launched directly from a GUI environment, it should have set `argv[0]` to an absolute path.

Understand that almost every shell on every Unix compatible operating system that has ever been released basically finds programs the same way and sets up the operating environment almost the same way (with some optional extras). And any other program that launches a program is expected to create the same environment (argv, environment strings, etc.) for that program as if it were run from a shell, with some optional extras. A program or user can setup an environment that deviates from this convention for other subordinate programs that it launches but if it does, this is a bug and the program has no reasonable expectation that the subordinate program or its subordinates will function correctly.

Possible values of `argv[0]` include:

*   `/path/to/executable` — absolute path
*   `../bin/executable` — relative to pwd
*   `bin/executable` — relative to pwd
*   `./foo` — relative to pwd
*   `executable` — basename, find in path
*   `bin//executable` — relative to pwd, non-canonical
*   `src/../bin/executable` — relative to pwd, non-canonical, backtracking
*   `bin/./echoargc` — relative to pwd, non-canonical

Values you should not see:

*   `~/bin/executable` — rewritten before your program runs.
*   `~user/bin/executable` — rewritten before your program runs
*   `alias` — rewritten before your program runs
*   `$shellvariable` — rewritten before your program runs
*   `*foo*` — wildcard, rewritten before your program runs, not very useful
*   `?foo?` — wildcard, rewritten before your program runs, not very useful

In addition, these may contain non-canonical path names and multiple layers of symbolic links. In some cases, there may be multiple hard links to the same program. For example, `/bin/ls`, `/bin/ps`, `/bin/chmod`, `/bin/rm`, etc. may be hard links to `/bin/busybox`.

To find yourself, follow the steps below:

*   Save pwd, PATH, and argv[0] on entry to your program (or initialization of your library) as they may change later.

*   Optional: particularly for non-Unix systems, separate out but don't discard the pathname host/user/drive prefix part, if present; the part which often precedes a colon or follows an initial "//".

*   If `argv[0]` is an absolute path, use that as a starting point. An absolute path probably starts with "/" but on some non-Unix systems it might start with "" or a drive letter or name prefix followed by a colon.

*   Else if `argv[0]` is a relative path (contains "/" or "" but doesn't start with it, such as "../../bin/foo", then combine pwd+"/"+argv[0] (use present working directory from when program started, not current).

*   Else if argv[0] is a plain basename (no slashes), then combine it with each entry in PATH environment variable in turn and try those and use the first one which succeeds.

*   Optional: Else try the very platform specific `/proc/self/exe`, `/proc/curproc/file` (BSD), and `(char *)getauxval(AT_EXECFN)`, and `dlgetname(...)` if present. You might even try these before `argv[0]`-based methods, if they are available and you don't encounter permission issues. In the somewhat unlikely event (when you consider all versions of all systems) that they are present and don't fail, they might be more authoritative.

*   Optional: check for a path name passed in using a command line parameter.

*   Optional: check for a pathname in the environment explicitly passed in by your wrapper script, if any.

*   Optional: As a last resort try environment variable "_". It might point to a different program entirely, such as the users shell.

*   Resolve symlinks, there may be multiple layers. There is the possibility of infinite loops, though if they exist your program probably won't get invoked.

*   Canonicalize filename by resolving substrings like "/foo/../bar/" to "/bar/". Note this may potentially change the meaning if you cross a network mount point, so canonization is not always a good thing. On a network server, ".." in symlink may be used to traverse a path to another file in the server context instead of on the client. In this case, you probably want the client context so canonicalization is ok. Also convert patterns like "/./" to "/" and "//" to "/". In shell, `readlink --canonicalize` will resolve multiple symlinks and canonicalize name. Chase may do similar but isn't installed. `realpath()` or `canonicalize_file_name()`, if present, may help.

If `realpath()` doesn't exist at compile time, you might borrow a copy from a permissively licensed library distribution, and compile it in yourself rather than reinventing the wheel. Fix the potential buffer overflow (pass in sizeof output buffer, think strncpy() vs strcpy()) if you will be using a buffer less than PATH_MAX. It may be easier just to use a renamed private copy rather than testing if it exists. Permissive license copy from android/darwin/bsd: [https://android.googlesource.com/platform/bionic/+/f077784/libc/upstream-freebsd/lib/libc/stdlib/realpath.c](https://android.googlesource.com/platform/bionic/+/f077784/libc/upstream-freebsd/lib/libc/stdlib/realpath.c)

Be aware that multiple attempts may be successful or partially successful and they might not all point to the same executable, so consider verifying your executable; however, you may not have read permission — if you can't read it, don't treat that as a failure. Or verify something in proximity to your executable such as the "../lib/" directory you are trying to find. You may have multiple versions, packaged and locally compiled versions, local and network versions, and local and USB-drive portable versions, etc. and there is a small possibility that you might get two incompatible results from different methods of locating. And "_" may simply point to the wrong program.

A program using `execve` can deliberately set `argv[0]` to be incompatible with the actual path used to load the program and corrupt PATH, "_", pwd, etc. though there isn't generally much reason to do so; but this could have security implications if you have vulnerable code that ignores the fact that your execution environment can be changed in variety of ways including, but not limited, to this one (chroot, fuse filesystem, hard links, etc.) It is possible for shell commands to set PATH but fail to export it.

You don't necessarily need to code for non-Unix systems but it would be a good idea to be aware of some of the peculiarities so you can write the code in such a way that it isn't as hard for someone to port later. Be aware that some systems (DEC VMS, DOS, URLs, etc.) might have drive names or other prefixes which end with a colon such as "C:", "sys$drive:[foo]bar", and "file:///foo/bar/baz". Old DEC VMS systems use "[" and "]" to enclose the directory portion of the path though this may have changed if your program is compiled in a POSIX environment. Some systems, such as VMS, may have a file version (separated by a semicolon at the end). Some systems use two consecutive slashes as in "//drive/path/to/file" or "user@host:/path/to/file" (scp command) or "file://hostname/path/to/file" (URL). In some cases (DOS and Windows), PATH might have different separator characters — ";" vs ":" and "" vs "/" for a path separator. In csh/tsh there is "path" (delimited with spaces) and "PATH" delimited with colons but your program should receive PATH so you don't need to worry about path. DOS and some other systems can have relative paths that start with a drive prefix. C:foo.exe refers to foo.exe in the current directory on drive C, so you do need to lookup current directory on C: and use that for pwd.

An example of symlinks and wrappers on my system:

```
/usr/bin/google-chrome is symlink to
/etc/alternatives/google-chrome  which is symlink to
/usr/bin/google-chrome-stable which is symlink to
/opt/google/chrome/google-chrome which is a bash script which runs
/opt/google/chome/chrome 
```

Note that user [bill](https://stackoverflow.com/users/121958/bill) [posted](https://stackoverflow.com/a/1023377) a link above to a program at HP that handles the three basic cases of `argv[0]`. It needs some changes, though:

*   It will be necessary to rewrite all the `strcat()` and `strcpy()` to use `strncat()` and `strncpy()`. Even though the variables are declared of length PATHMAX, an input value of length PATHMAX-1 plus the length of concatenated strings is > PATHMAX and an input value of length PATHMAX would be unterminated.
*   It needs to be rewritten as a library function, rather than just to print out results.
*   It fails to canonicalize names (use the realpath code I linked to above)
*   It fails to resolve symbolic links (use the realpath code)

So, if you combine both the HP code and the realpath code and fix both to be resistant to buffer overflows, then you should have something which can properly interpret `argv[0]`.

The following illustrates actual values of `argv[0]` for various ways of invoking the same program on Ubuntu 12.04\. And yes, the program was accidentally named echoargc instead of echoargv. This was done using a script for clean copying but doing it manually in shell gets same results (except aliases don't work in script unless you explicitly enable them).

```
cat ~/src/echoargc.c
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
main(int argc, char **argv)
{
  printf("  argv[0]=\"%s\"\n", argv[0]);
  sleep(1);  /* in case run from desktop */
}
tcc -o ~/bin/echoargc ~/src/echoargc.c
cd ~
/home/whitis/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
echoargc
  argv[0]="echoargc"
bin/echoargc
  argv[0]="bin/echoargc"
bin//echoargc
  argv[0]="bin//echoargc"
bin/./echoargc
  argv[0]="bin/./echoargc"
src/../bin/echoargc
  argv[0]="src/../bin/echoargc"
cd ~/bin
*echo*
  argv[0]="echoargc"
e?hoargc
  argv[0]="echoargc"
./echoargc
  argv[0]="./echoargc"
cd ~/src
../bin/echoargc
  argv[0]="../bin/echoargc"
cd ~/junk
~/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
~whitis/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
alias echoit=~/bin/echoargc
echoit
  argv[0]="/home/whitis/bin/echoargc"
echoarg=~/bin/echoargc
$echoarg
  argv[0]="/home/whitis/bin/echoargc"
ln -s ~/bin/echoargc junk1
./junk1
  argv[0]="./junk1"
ln -s /home/whitis/bin/echoargc junk2
./junk2
  argv[0]="./junk2"
ln -s junk1 junk3
./junk3
  argv[0]="./junk3"

gnome-desktop-item-edit --create-new ~/Desktop
# interactive, create desktop link, then click on it
  argv[0]="/home/whitis/bin/echoargc"
# interactive, right click on gnome application menu, pick edit menus
# add menu item for echoargc, then run it from gnome menu
 argv[0]="/home/whitis/bin/echoargc"

 cat ./testargcscript 2>&1 | sed -e 's/^/    /g'
#!/bin/bash
# echoargc is in ~/bin/echoargc
# bin is in path
shopt -s expand_aliases
set -v
cat ~/src/echoargc.c
tcc -o ~/bin/echoargc ~/src/echoargc.c
cd ~
/home/whitis/bin/echoargc
echoargc
bin/echoargc
bin//echoargc
bin/./echoargc
src/../bin/echoargc
cd ~/bin
*echo*
e?hoargc
./echoargc
cd ~/src
../bin/echoargc
cd ~/junk
~/bin/echoargc
~whitis/bin/echoargc
alias echoit=~/bin/echoargc
echoit
echoarg=~/bin/echoargc
$echoarg
ln -s ~/bin/echoargc junk1
./junk1
ln -s /home/whitis/bin/echoargc junk2
./junk2
ln -s junk1 junk3
./junk3 
```

These examples illustrate that the techniques described in this post should work in a wide range of circumstances and why some of the steps are necessary.

EDIT: Now, the program that prints argv[0] has been updated to actually find itself.

```
// Copyright 2015 by Mark Whitis.  License=MIT style
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <limits.h>
#include <assert.h>
#include <string.h>
#include <errno.h>

// "look deep into yourself, Clarice"  -- Hanibal Lector
char findyourself_save_pwd[PATH_MAX];
char findyourself_save_argv0[PATH_MAX];
char findyourself_save_path[PATH_MAX];
char findyourself_path_separator='/';
char findyourself_path_separator_as_string[2]="/";
char findyourself_path_list_separator[8]=":";  // could be ":; "
char findyourself_debug=0;

int findyourself_initialized=0;

void findyourself_init(char *argv0)
{

  getcwd(findyourself_save_pwd, sizeof(findyourself_save_pwd));

  strncpy(findyourself_save_argv0, argv0, sizeof(findyourself_save_argv0));
  findyourself_save_argv0[sizeof(findyourself_save_argv0)-1]=0;

  strncpy(findyourself_save_path, getenv("PATH"), sizeof(findyourself_save_path));
  findyourself_save_path[sizeof(findyourself_save_path)-1]=0;
  findyourself_initialized=1;
}

int find_yourself(char *result, size_t size_of_result)
{
  char newpath[PATH_MAX+256];
  char newpath2[PATH_MAX+256];

  assert(findyourself_initialized);
  result[0]=0;

  if(findyourself_save_argv0[0]==findyourself_path_separator) {
    if(findyourself_debug) printf("  absolute path\n");
     realpath(findyourself_save_argv0, newpath);
     if(findyourself_debug) printf("  newpath=\"%s\"\n", newpath);
     if(!access(newpath, F_OK)) {
        strncpy(result, newpath, size_of_result);
        result[size_of_result-1]=0;
        return(0);
     } else {
    perror("access failed 1");
      }
  } else if( strchr(findyourself_save_argv0, findyourself_path_separator )) {
    if(findyourself_debug) printf("  relative path to pwd\n");
    strncpy(newpath2, findyourself_save_pwd, sizeof(newpath2));
    newpath2[sizeof(newpath2)-1]=0;
    strncat(newpath2, findyourself_path_separator_as_string, sizeof(newpath2));
    newpath2[sizeof(newpath2)-1]=0;
    strncat(newpath2, findyourself_save_argv0, sizeof(newpath2));
    newpath2[sizeof(newpath2)-1]=0;
    realpath(newpath2, newpath);
    if(findyourself_debug) printf("  newpath=\"%s\"\n", newpath);
    if(!access(newpath, F_OK)) {
        strncpy(result, newpath, size_of_result);
        result[size_of_result-1]=0;
        return(0);
     } else {
    perror("access failed 2");
      }
  } else {
    if(findyourself_debug) printf("  searching $PATH\n");
    char *saveptr;
    char *pathitem;
    for(pathitem=strtok_r(findyourself_save_path, findyourself_path_list_separator,  &saveptr); pathitem; pathitem=strtok_r(NULL, findyourself_path_list_separator, &saveptr) ) {
       if(findyourself_debug>=2) printf("pathitem=\"%s\"\n", pathitem);
       strncpy(newpath2, pathitem, sizeof(newpath2));
       newpath2[sizeof(newpath2)-1]=0;
       strncat(newpath2, findyourself_path_separator_as_string, sizeof(newpath2));
       newpath2[sizeof(newpath2)-1]=0;
       strncat(newpath2, findyourself_save_argv0, sizeof(newpath2));
       newpath2[sizeof(newpath2)-1]=0;
       realpath(newpath2, newpath);
       if(findyourself_debug) printf("  newpath=\"%s\"\n", newpath);
      if(!access(newpath, F_OK)) {
          strncpy(result, newpath, size_of_result);
          result[size_of_result-1]=0;
          return(0);
      }
    } // end for
    perror("access failed 3");

  } // end else
  // if we get here, we have tried all three methods on argv[0] and still haven't succeeded.   Include fallback methods here.
  return(1);
}

main(int argc, char **argv)
{
  findyourself_init(argv[0]);

  char newpath[PATH_MAX];
  printf("  argv[0]=\"%s\"\n", argv[0]);
  realpath(argv[0], newpath);
  if(strcmp(argv[0],newpath)) { printf("  realpath=\"%s\"\n", newpath); }
  find_yourself(newpath, sizeof(newpath));
  if(1 || strcmp(argv[0],newpath)) { printf("  findyourself=\"%s\"\n", newpath); }
  sleep(1);  /* in case run from desktop */
} 
```

And here is the output which demonstrates that in every one of the previous tests it actually did find itself.

```
tcc -o ~/bin/echoargc ~/src/echoargc.c
cd ~
/home/whitis/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
echoargc
  argv[0]="echoargc"
  realpath="/home/whitis/echoargc"
  findyourself="/home/whitis/bin/echoargc"
bin/echoargc
  argv[0]="bin/echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
bin//echoargc
  argv[0]="bin//echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
bin/./echoargc
  argv[0]="bin/./echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
src/../bin/echoargc
  argv[0]="src/../bin/echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
cd ~/bin
*echo*
  argv[0]="echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
e?hoargc
  argv[0]="echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
./echoargc
  argv[0]="./echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
cd ~/src
../bin/echoargc
  argv[0]="../bin/echoargc"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
cd ~/junk
~/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
~whitis/bin/echoargc
  argv[0]="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
alias echoit=~/bin/echoargc
echoit
  argv[0]="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
echoarg=~/bin/echoargc
$echoarg
  argv[0]="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
rm junk1 junk2 junk3
ln -s ~/bin/echoargc junk1
./junk1
  argv[0]="./junk1"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
ln -s /home/whitis/bin/echoargc junk2
./junk2
  argv[0]="./junk2"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc"
ln -s junk1 junk3
./junk3
  argv[0]="./junk3"
  realpath="/home/whitis/bin/echoargc"
  findyourself="/home/whitis/bin/echoargc" 
```

The two GUI launches described above also correctly find the program.

There is one potential pitfall. The `access()` function drops permissions if the program is setuid before testing. If there is a situation where the program can be found as an elevated user but not as a regular user, then there might be a situation where these tests would fail, although it is unlikely the program could actually be executed under those circumstances. One could use euidaccess() instead. It is possible, however, that it might find an inaccessable program earlier on path than the actual user could.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-09-26T04:14:10.310

Gregory Pakosz的[**whereami**库使用](https://github.com/gpakosz/whereami)[mark4o 帖子](https://stackoverflow.com/questions/1023306/finding-current-executables-path-without-proc-self-exe/1024937#1024937)中提到的 API 为各种平台实现了这一点。如果您“只是”需要一个适用于可移植项目并且对各种平台的特性不感兴趣的解决方案，这将是最有趣的。

在撰写本文时，支持的平台是：

*   视窗
*   Linux
*   苹果电脑
*   iOS
*   安卓
*   QNX中微子
*   自由BSD
*   NetBSD
*   蜻蜓 BSD
*   太阳操作系统

该库由MIT 和 WTFPL2 组成并获得许可`whereami.c`。`whereami.h`将文件拖放到您的项目中，包含标题并使用它：

```
#include "whereami.h"

int main() {
  int length = wai_getExecutablePath(NULL, 0, NULL);
  char* path = (char*)malloc(length + 1);
  wai_getExecutablePath(path, length, &dirname_length);
  path[length] = '\0';

  printf("My path: %s", path);

  free(path);
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-05-13T00:52:20.343

Linux 上使用`/proc/self/exe`或`argv[0]`使用 ELF 解释器传递的信息的替代方法，由 glibc 提供，如下所示：

```
#include <stdio.h>
#include <sys/auxv.h>

int main(int argc, char **argv)
{
    printf("%s\n", (char *)getauxval(AT_EXECFN));
    return(0);
} 
```

请注意，这`getauxval`是一个 glibc 扩展，为了保持稳健，您应该检查它以使其不会返回`NULL`（表明 ELF 解释器没有提供`AT_EXECFN`参数），但我认为这在 Linux 上实际上不是问题。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-21T00:29:30.503

使这项工作跨平台可靠地工作需要使用#ifdef 语句。

下面的代码在 Windows、Linux、MacOS、Solaris 或 FreeBSD 中找到可执行文件的路径（尽管 FreeBSD 未经测试）。它使用 [Boost](http://www.boost.org) 1.55.0（或更高版本）来简化代码，但如果您愿意，它很容易删除。只需按照操作系统和编译器的要求使用像 _MSC_VER 和 __linux 这样的定义。

```
#include <string>
#include <boost/predef/os.h>

#if (BOOST_OS_WINDOWS)
#  include <stdlib.h>
#elif (BOOST_OS_SOLARIS)
#  include <stdlib.h>
#  include <limits.h>
#elif (BOOST_OS_LINUX)
#  include <unistd.h>
#  include <limits.h>
#elif (BOOST_OS_MACOS)
#  include <mach-o/dyld.h>
#elif (BOOST_OS_BSD_FREE)
#  include <sys/types.h>
#  include <sys/sysctl.h>
#endif

/*
 * Returns the full path to the currently running executable,
 * or an empty string in case of failure.
 */
std::string getExecutablePath() {
    #if (BOOST_OS_WINDOWS)
        char *exePath;
        if (_get_pgmptr(&exePath) != 0)
            exePath = "";
    #elif (BOOST_OS_SOLARIS)
        char exePath[PATH_MAX];
        if (realpath(getexecname(), exePath) == NULL)
            exePath[0] = '\0';
    #elif (BOOST_OS_LINUX)
        char exePath[PATH_MAX];
        ssize_t len = ::readlink("/proc/self/exe", exePath, sizeof(exePath));
        if (len == -1 || len == sizeof(exePath))
            len = 0;
        exePath[len] = '\0';
    #elif (BOOST_OS_MACOS)
        char exePath[PATH_MAX];
        uint32_t len = sizeof(exePath);
        if (_NSGetExecutablePath(exePath, &len) != 0) {
            exePath[0] = '\0'; // buffer too small (!)
        } else {
            // resolve symlinks, ., .. if possible
            char *canonicalPath = realpath(exePath, NULL);
            if (canonicalPath != NULL) {
                strncpy(exePath,canonicalPath,len);
                free(canonicalPath);
            }
        }
    #elif (BOOST_OS_BSD_FREE)
        char exePath[2048];
        int mib[4];  mib[0] = CTL_KERN;  mib[1] = KERN_PROC;  mib[2] = KERN_PROC_PATHNAME;  mib[3] = -1;
        size_t len = sizeof(exePath);
        if (sysctl(mib, 4, exePath, &len, NULL, 0) != 0)
            exePath[0] = '\0';
    #endif
        return std::string(exePath);
} 
```

上述版本返回包含可执行文件名称的完整路径。相反，如果您想要没有可执行文件名称的路径，`#include boost/filesystem.hpp>`请将 return 语句更改为：

```
return strlen(exePath)>0 ? boost::filesystem::path(exePath).remove_filename().make_preferred().string() : std::string(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-21T07:50:31.380

> 如果你曾经必须支持没有 /proc/ 的 Mac OS X，你会怎么做？使用#ifdefs 隔离特定于平台的代码（例如NSBundle）？

是的，隔离特定于平台的代码`#ifdefs`是这样做的传统方式。

另一种方法是拥有一个`#ifdef`包含函数声明的 clean -less 标头，并将实现放在特定于平台的源文件中。

例如，查看*POCO*（可移植组件）C++ 库如何为他们的*[Environment](https://github.com/pocoproject/poco/blob/develop/Foundation/include/Poco/Environment.h)*类做类似的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-13T15:52:44.083

根据**QNX Neutrino**的版本，有不同的方法可以找到用于启动运行进程的可执行文件的完整路径和名称。我将进程标识符表示为`<PID>`. 尝试以下操作：

1.  如果文件`/proc/self/exefile`存在，那么它的内容就是请求的信息。
2.  如果文件`/proc/<PID>/exefile`存在，那么它的内容就是请求的信息。
3.  如果文件`/proc/self/as`存在，则：
    1.  `open()`文件。
    2.  至少分配一个缓冲区`sizeof(procfs_debuginfo) + _POSIX_PATH_MAX`。
    3.  将该缓冲区作为`devctl(fd, DCMD_PROC_MAPDEBUG_BASE,...`.
    4.  将缓冲区强制转换为`procfs_debuginfo*`.
    5.  请求的信息位于结构的`path`字段中`procfs_debuginfo`。**警告**：出于某种原因，有时 QNX 会省略`/`文件路径的第一个斜线。在需要时预先添加`/`。
    6.  清理（​​关闭文件、释放缓冲区等）。
4.  尝试`3.`使用文件中的过程`/proc/<PID>/as`。
5.  尝试`dladdr(dlsym(RTLD_DEFAULT, "main"), &dlinfo)`where`dlinfo`是一个可能包含请求信息的`Dl_info`结构。`dli_fname`

我希望这有帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-21T07:14:44.027

AFAIK，没有这样的方式。还有一个模棱两可的问题：如果同一个可执行文件有多个“指向”它的硬链接，你希望得到什么答案？（硬链接实际上并不“指向”，它们*是*同一个文件，只是位于文件系统层次结构中的另一个位置。）

一旦`execve()`成功执行新的二进制文件，有关原始程序参数的所有信息都会丢失。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-09-11T16:06:03.457

除了[mark4o 的回答](https://stackoverflow.com/questions/1023306/finding-current-executables-path-without-proc-self-exe/1024937#1024937)，[FreeBSD](https://en.wikipedia.org/wiki/FreeBSD)还有

```
const char* getprogname(void) 
```

它也应该在 macOS 中可用。它通过 libbsd 在 GNU/Linux 中可用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-09-11T09:03:15.113

当然，这并不适用于所有项目。尽管如此，`QCoreApplication::applicationFilePath()`在 6 年的 C++/Qt 开发中，我从未失败过。

当然，在尝试使用它之前应该仔细阅读文档：

> 警告：在 Linux 上，此函数将尝试从 /proc 文件系统获取路径。如果失败，则假定 argv[0] 包含可执行文件的绝对文件名。该函数还假定应用程序没有更改当前目录。

老实说，我认为这种`#ifdef`解决方案和其他类似的解决方案根本不应该在现代代码中使用。

我确信也存在较小的跨平台库。让他们将所有特定于平台的东西封装在里面。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-01-30T20:48:09.047

如果您正在编写 GPL 代码并使用 GNU 自动工具，那么在许多操作系统（包括 Windows 和 macOS）上处理细节的可移植方式是 gnulib 的[`relocatable-prog`](https://www.gnu.org/software/gnulib/manual/html_node/Supporting-Relocation.html)模块。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-21T07:30:51.170

您可以使用 argv[0] 并分析 PATH 环境变量。看：[可以找到自己的程序示例](http://h21007.www2.hp.com/portal/site/dspp/menuitem.863c3e4cbcdc3f3515b49c108973a801?ciid=88086d6e1de021106d6e1de02110275d6e10RCRD)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-12T06:28:18.997

只是我的两分钱。您可以使用此代码在具有跨平台接口的 C/C++ 中找到当前应用程序的目录。

```
void getExecutablePath(char ** path, unsigned int * pathLength)
{
    // Early exit when invalid out-parameters are passed
    if (!checkStringOutParameter(path, pathLength))
    {
        return;
    }

#if defined SYSTEM_LINUX

    // Preallocate PATH_MAX (e.g., 4096) characters and hope the executable path isn't longer (including null byte)
    char exePath[PATH_MAX];

    // Return written bytes, indicating if memory was sufficient
    int len = readlink("/proc/self/exe", exePath, PATH_MAX);

    if (len <= 0 || len == PATH_MAX) // memory not sufficient or general error occured
    {
        invalidateStringOutParameter(path, pathLength);
        return;
    }

    // Copy contents to caller, create caller ownership
    copyToStringOutParameter(exePath, len, path, pathLength);

#elif defined SYSTEM_WINDOWS

    // Preallocate MAX_PATH (e.g., 4095) characters and hope the executable path isn't longer (including null byte)
    char exePath[MAX_PATH];

    // Return written bytes, indicating if memory was sufficient
    unsigned int len = GetModuleFileNameA(GetModuleHandleA(0x0), exePath, MAX_PATH);
    if (len == 0) // memory not sufficient or general error occured
    {
        invalidateStringOutParameter(path, pathLength);
        return;
    }

    // Copy contents to caller, create caller ownership
    copyToStringOutParameter(exePath, len, path, pathLength);

#elif defined SYSTEM_SOLARIS

    // Preallocate PATH_MAX (e.g., 4096) characters and hope the executable path isn't longer (including null byte)
    char exePath[PATH_MAX];

    // Convert executable path to canonical path, return null pointer on error
    if (realpath(getexecname(), exePath) == 0x0)
    {
        invalidateStringOutParameter(path, pathLength);
        return;
    }

    // Copy contents to caller, create caller ownership
    unsigned int len = strlen(exePath);
    copyToStringOutParameter(exePath, len, path, pathLength);

#elif defined SYSTEM_DARWIN

    // Preallocate PATH_MAX (e.g., 4096) characters and hope the executable path isn't longer (including null byte)
    char exePath[PATH_MAX];

    unsigned int len = (unsigned int)PATH_MAX;

    // Obtain executable path to canonical path, return zero on success
    if (_NSGetExecutablePath(exePath, &len) == 0)
    {
        // Convert executable path to canonical path, return null pointer on error
        char * realPath = realpath(exePath, 0x0);

        if (realPath == 0x0)
        {
            invalidateStringOutParameter(path, pathLength);
            return;
        }

        // Copy contents to caller, create caller ownership
        unsigned int len = strlen(realPath);
        copyToStringOutParameter(realPath, len, path, pathLength);

        free(realPath);
    }
    else // len is initialized with the required number of bytes (including zero byte)
    {
        char * intermediatePath = (char *)malloc(sizeof(char) * len);

        // Convert executable path to canonical path, return null pointer on error
        if (_NSGetExecutablePath(intermediatePath, &len) != 0)
        {
            free(intermediatePath);
            invalidateStringOutParameter(path, pathLength);
            return;
        }

        char * realPath = realpath(intermediatePath, 0x0);

        free(intermediatePath);

        // Check if conversion to canonical path succeeded
        if (realPath == 0x0)
        {
            invalidateStringOutParameter(path, pathLength);
            return;
        }

        // Copy contents to caller, create caller ownership
        unsigned int len = strlen(realPath);
        copyToStringOutParameter(realPath, len, path, pathLength);

        free(realPath);
    }

#elif defined SYSTEM_FREEBSD

    // Preallocate characters and hope the executable path isn't longer (including null byte)
    char exePath[2048];

    unsigned int len = 2048;

    int mib[] = { CTL_KERN, KERN_PROC, KERN_PROC_PATHNAME, -1 };

    // Obtain executable path by syscall
    if (sysctl(mib, 4, exePath, &len, 0x0, 0) != 0)
    {
        invalidateStringOutParameter(path, pathLength);
        return;
    }

    // Copy contents to caller, create caller ownership
    copyToStringOutParameter(exePath, len, path, pathLength);

#else

    // If no OS could be detected ... degrade gracefully
    invalidateStringOutParameter(path, pathLength);

#endif
} 
```

[你可以在这里](https://github.com/cginternals/cpplocate/blob/master/source/liblocate/source/liblocate.c)详细看看。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-09-12T06:36:33.337

> 但我想知道是否有一种方便的方法可以使用跨平台接口在 C/C++ 中找到当前应用程序的目录。

## 你不能这样做（至少在 Linux 上）

由于可执行文件可以在运行它的[进程执行期间将其文件路径](https://en.wikipedia.org/wiki/Process_(computing))[重命名（2）](https://man7.org/linux/man-pages/man2/rename.2.html)到（同一文件系统的）不同目录。另请参见[syscalls(2)](https://man7.org/linux/man-pages/man2/syscalls.2.html)和[inode(7)](https://man7.org/linux/man-pages/man7/inode.7.html)。

在 Linux 上，可执行文件甚至（原则上）可以通过调用[unlink(2)来](https://man7.org/linux/man-pages/man2/unlink.2.html)[删除](https://man7.org/linux/man-pages/man3/remove.3.html)自身。然后，[Linux 内核](https://en.wikipedia.org/wiki/Linux_kernel)应该保持分配的文件，直到没有进程再引用它。使用[proc(5)](https://man7.org/linux/man-pages/man5/proc.5.html)你可以做一些奇怪的事情（例如[rename(2)](https://man7.org/linux/man-pages/man2/rename.2.html)那个文件，等等......）`/proc/self/exe`

换句话说，在 Linux 上，“当前应用程序的目录”的概念没有任何意义。

另请阅读[*高级 Linux 编程*](https://mentorembedded.github.io/advancedlinuxprogramming/)和[*操作系统：三个简单的部分*](http://pages.cs.wisc.edu/%7Eremzi/OSTEP/)了解更多信息。

还可以在[OSDEV](https://osdev.org/)上查看几个开源操作系统（包括[FreeBSD](https://www.freebsd.org/)或[GNU Hurd](https://www.gnu.org/software/hurd/)）。其中一些提供了接近 POSIX 的接口（API）。

考虑使用（经许可）跨平台 C++ 框架，如[Qt](https://qt.io/)或[POCO](https://pocoproject.org/)，也许通过将它们移植到您最喜欢的操作系统来为它们做出贡献。

# .net - Silverlight 业务线应用程序

> ID：1023309
> 
> 赞同：2
> 
> 时间：2009-06-21T06:15:45.317
> 
> 标签：.net, silverlight

好的，我一直在寻找一些在 silverlight 中实现的业务线应用程序的好例子。我在网上看到了一些内容，但没有任何实质内容。

MS silverlight 样本对于眼睛糖果和类似你在 Flash 中看到的东西很酷，但没有什么是真正的 LOB 可以真正为公司提供一些有用的东西。

有没有人有一些建议，链接等开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T06:32:49.900

MS Health CUI 项目包含一些 Silverlight LOB 控件。查看[codeplex 源代码](http://mscui.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25602)或[主项目](http://www.mscui.net/ControlsAndSamples.aspx)站点以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T12:34:51.540

看看 Telerik 示例仪表板

*   链接 - [http://www.telerik.com/products/salesdashboard.aspx](http://www.telerik.com/products/salesdashboard.aspx)
*   下载源 - [http://www.telerik.com/account/free-trials/single-trial.aspx?pmvid=2009](http://www.telerik.com/account/free-trials/single-trial.aspx?pmvid=2009)

> Telerik Sales Dashboard 是一个用于监控公司销售代表绩效的演示应用程序。仪表板为高级管理人员提供丰富的数据可视化，用于分析企业数据，从而促进典型业务环境中的决策过程。该演示演示了构建大型企业应用程序的最佳实践方法，该应用程序具有由两个不同表示层共享的单个业务逻辑层：桌面版本（基于 WPF）和 Web 版本（基于 Silverlight）。由于业界唯一真正跨平台的 UI 组件——Silverlight 的 RadControls 和 WPF 的 RadControls，这两种 UI 实现具有相同的外观。这两个套件共享相同的 API 并衍生自相同的代码库，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-15T15:58:07.777

我使用 asp.net 前端针对 Northwind 构建了 WCF 服务。

www.telerik.com/support/kb/orm/general/northwind-wcf-demo.aspx

您可以在以下位置查看 ajax UI：

demo.n-sv.com/NWUI/

我正在慢慢开始研究 SL 版本的 UI。

demo.n-sv.com/NWSL/ 注意我只在订单部分投入了时间。

使用 Telerik Silverlight 3 控件，我觉得您现在可以合法地编写一些 SL LOB 应用程序。

[http://www.telerik.com/products/silverlight.aspx](http://www.telerik.com/products/silverlight.aspx)

# zend-framework - 如何在 Zend Framework 中重写域

> ID：1023310
> 
> 赞同：0
> 
> 时间：2009-06-21T06:17:12.147
> 
> 标签：zend-framework

我正在写用户注册表。
在用户使用用户名（例如“Billy”）注册后，我希望他使用 URL billy.mydomain.com 访问服务器。

billy.mydomain.com 的 Zend 框架链接是
www.mydomain.com/profile/index/username/billy

我想知道如何将网址从
www.mydomain.com/profile/index/username/billy重写
为
billy.mydomain.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T07:26:19.540

抛弃我最初的答案，[这个解决方案](http://framework.zend.com/manual/en/zend.controller.router.html#zend.controller.router.routes.hostname)要优雅得多。

```
$hostnameRoute = new Zend_Controller_Router_Route_Hostname(
    ':username.mydomain.com',
    array(
        'controller' => 'profile',
    )
);

$pathRoute = new Zend_Controller_Router_Route(":action/*", array( 'action'=>'index' ));
$chain = $hostnameRoute->chain($pathRoute);

// add $chain to your router 
```

# c# - 当列表项以与下拉项相同的文本开头时，如何设置 ComboBox 默认值*不在下拉列表中？

> ID：1023323
> 
> 赞同：1
> 
> 时间：2009-06-21T06:32:25.453
> 
> 标签：c#, .net, user-interface, combobox

使用 C#，假设您有一个将 DropDownStyle 设置为 DropDown 的 ComboBox（下拉菜单中有项目，但用户也可以手动输入一个值）。如何为**不在**下拉列表中的值列表中但以可能选择*的文本开头的 ComboBox 设置默认值？*通常设置 ComboBox.Text 可以正常工作，但如果下拉列表中有一个项目以您想要的默认文本*开头*，它会自动选择列表中以该文本开头的第一个项目。例如：

**下拉列表中的值：**
`c:\program files\`
`c:\windows\`
`d:\media\`

**默认值分配**
`myComboBox.Text = "C:\";`

**结果**
表单打开时 ComboBox 的初始值为“ `c:\program files\`”。

那么我做错了什么？如何正确设置不在以可能选择开头的下拉列表中的项目的默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T07:01:20.777

以下代码有效吗？

```
myCombo.SelectedIndex = myCombo.FindString(@"c:\"); 
```

注意：我没试过。查找可以帮助使用反射器的属性/方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T06:53:56.470

我能够让 ComboBox 中的项目成为 ComboBoxItems （我不明白为什么这不适用于其他类型）。像你一样设置 ComboBox.Text 并确保 SelectedIndex = -1 并且你需要 IsEditable = True。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T07:00:39.343

我无法重现您所描述的行为。通过 Items 集合添加三个值，然后将初始值设置为“c:\”（顺便说一下，您在代码示例中省略了一个 @）工作正常。我的猜测是您的代码中的其他内容是在您设置组合框后设置它的值。

# python - 为什么批量导入不起作用但单独导入定义起作用？

> ID：1023326
> 
> 赞同：2
> 
> 时间：2009-06-21T06:33:41.783
> 
> 标签：python, django

所以我只是遇到了一个奇怪的所谓的bug。因为这适用于我的其他 .py 文件，但只是在这个文件上它突然停止工作。

```
from tuttobelo.management.models import * 
```

上面的过去可以工作，但它突然停止工作，我不得不用底部替换它。

```
from tuttobelo.management.models import Preferences, ProductVariant, UserSeller, ProductOwner, ProductModel, ProductVariant
from tuttobelo.management.models import ProductMeta, ShippingMethods 
```

我知道以下是更好的编码方式，但是使用了模型中提到的所有模型，所以我的问题是，通配符停止工作的可能原因是什么？

我得到的错误是我试图导入的模型不存在，只有删除通配符并导入模型的名称才能正确导入它。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T07:02:51.837

也许该`models`模块有一个`__all__`不包括您要查找的内容。无论如何，在生产代码`from ... import *`中**从来都不**是一个好主意——我们一直指的`import *`是交互式探索使用的功能，*而不是*生产使用。专门导入您需要的模块——使用该名称来限定属于那里的名称——从长远来看，你会更加快乐！-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T12:56:27.597

在 Python 中有些情况下使用 * 导入不会产生任何结果。`__init__.py`在您的示例中，如果 tuttobelo.management.models 是一个包含Preferences.py、ProductVariant.py 等文件的包（即带有别的。

这可以通过输入来解决`__init__.py`：

```
__all__ = ['Preferences', 'ProductVariant', 'UserSeller', <etc...> ] 
```

这将使 import * 再次成为可能，但如前所述，这是一种可怕的编码风格，有几个原因。第一，pyflakes 和 pylint 等工具以及编辑器中的代码自省停止工作。其次，您最终会在本地命名空间中放置很多名称，而在您的代码中您不知道它们来自哪里，其次您可能会在这样的名称中遇到冲突。

更好的方法是做

```
from tuttobelo.management import models 
```

然后通过 models.Preferences、models.ProductVariant 等引用其他内容。但这不适用于`__all__`变量。相反，您需要从以下位置导入模块`__init__.py`：

```
import Preferences, ProductVariant, UserSeller, ProductOwner, <etc...> 
```

这样做的缺点是即使您不使用所有模块也会被导入，这意味着它会占用更多内存。

# c# - 在 C# 中使用委托实现的观察者模式？

> ID：1023329
> 
> 赞同：11
> 
> 时间：2009-06-21T06:40:27.560
> 
> 标签：c#, design-patterns, events, delegates, observer-pattern

已经回答了一个问题，[在 C# 中，观察者模式不是已经使用事件实现了吗？](https://stackoverflow.com/questions/32034/in-c-isnt-the-observer-pattern-already-implemented-using-events)

它询问观察者模式是否已经在 c# 中使用事件实现。

虽然我得到了事件和观察者模式，但观察者模式真的不只是代表，事件是进一步的实现吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-21T07:02:32.803

你是对的。事件只是具有一些稍微不同的功能的委托。所有的观察者模式都可以用委托来实现，而无需触及`event`关键字。

您可能会对“event”关键字实际带来的内容感兴趣。

*   事件可以是接口的一部分，而常规委托字段不能
*   事件不能被外部类调用，但普通委托可以
*   事件具有额外的访问器（添加和删除），您可以覆盖这些访问器并为其提供自定义功能

编辑： 这是一篇关于事件和委托之间的 IL 代码比较[的精彩文章。](http://blog.monstuff.com/archives/000040.html)（提示：几乎相同）。

# crystal-reports - 如何为 CrossTab 中的每个单元格编写显示字符串公式？

> ID：1023332
> 
> 赞同：1
> 
> 时间：2009-06-21T06:49:28.743
> 
> 标签：crystal-reports, formula, crosstab

公式场景：检索到的数据有一个状态列，其值为（-1、0、1、2、3），我想使用公式根据这些值显示字符串。我使用显示字符串，但它不起作用。

我如何编写一个公式来为交叉表中的每个单元格工作？

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-24T20:58:12.757

公式很容易编写。只需创建一个简单的 if/if else/else than 语句：

```
if {TABLE.COLUMN} = 1 then 'One' else 'Unknown' 
```

并在交叉表中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-14T20:08:37.587

这是旧的，但我希望这对其他人有帮助。

```
Select CurrentFieldValue
    Case 1:
        "A"
    Case 2:
        "B" 
```

等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-03T15:10:04.923

用于`GridRowColumnValue("column name")`获取要对相关单元格进行评估的相应行或列值

# url - 应用程序是否等待 -initWithContentsOfURL: 检索网络数据？

> ID：1023337
> 
> 赞同：0
> 
> 时间：2009-06-21T06:58:36.213
> 
> 标签：url, asynchronous, iphone

我正在尝试从 iPhone OS 应用程序中的服务器上的 .php 文件中检索数据。在一种方法中，我使用以下代码：

```
NSString *aString = [[NSString alloc] initWithContentsOfURL:aURL encoding:anEncoding error:nil];

//See what I got
NSLog(aString); 
```

当我运行应用程序时，应用程序运行代码的速度似乎如此之快，我怀疑是否有足够的时间让数据请求发生。结果字符串完全是空的，这进一步支持了我的怀疑。这里发生了什么？应用程序是否没有等待 -initWithContentsOfURL 从我服务器上的 .php 文件中检索数据？如果应用程序不等待此方法，是否可以使用另一种方法来执行数据请求，以等待请求完成，然后再转到下一个代码？

（我还阅读了一些关于 NSURLConnection 的内容——这可能是我应该研究的而不是 -initWithContentsOfURL 吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T07:28:58.460

NSURLConnection 非常适合从网络获取文件......它本身并不“等待”，而是它的委托回调：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
- (void)connectionDidFinishLoading:(NSURLConnection *)connection 
```

...允许您在收到数据和完全下载数据时收到通知。这样，您可以让应用程序在数据进入时显示（如果您喜欢）一个 UIProgressBar，然后在完全接收到文件时按照您的意愿处理文件。

# c# - 为什么以下代码段会成为 C#2.0 类型推断的问题？

> ID：1023345
> 
> 赞同：1
> 
> 时间：2009-06-21T07:03:02.520
> 
> 标签：c#, type-inference

我在 Jon Skeet 的 CSharp in Depth 的第 9 章，该部分解释了 3.0 中类型推断的改进

Pg.247 上有“不应该用 2.0 编译”的代码片段 - 但是我找不到它不应该编译的原因。**在目标框架为 2.0**的项目上尝试了 VS2008 C# Express Edition 的问题-**以下所有三个调用也都编译和运行**。

2.0 引入了推断正确类型委托的能力。

```
new List<ThreadStart>().Add( delegate { Console.WriteLine("New Thread!"); } );   // works 
```

当然，乔恩不会错（；）“Sql 已损坏”+本书的勘误表页面上没有提到这一点。）所以我主要怀疑它仍在使用 3.0 类型推断——我错过了什么?

```
 delegate int MyDelegate(string s);
    delegate TOutput MyConverter<TInput, TOutput>(TInput input);
    static void MyParse(MyDelegate del)
    {
        Console.WriteLine(del("100"));
    }
    static void MyConvert<TInput, TOutput>(MyConverter<TInput, TOutput> del, TInput input)
    {
        Console.WriteLine(del(input));
    }

    // Jon's code snippet begin
    delegate T MyFunc<T>();
    static void WriteResult<T>(MyFunc<T> function)
    {
        Console.WriteLine(function());
    }
    // end

    static void Main(string[] args)
    {
        MyParse(delegate(string s)
            {
                return Int32.Parse(s);
            }
        );
        MyConvert(delegate(string s)
            {
                return Int32.Parse(s);
            },
            "100");
        WriteResult(delegate { return 5; });    // Jon: Shouldn't work.
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T07:11:29.040

我的计算机上安装了 Visual Studio 2005，我刚刚试用了您发布的代码。

MyConvert 和 WriteResult 都不起作用。我收到以下错误：

```
The type arguments for method 'ConsoleApplication1.Program.MyConvert<TInput,TOutput>(ConsoleApplication1.Program.MyConverter<TInput,TOutput>, TInput)' cannot be inferred from the usage. Try specifying the type arguments explicitly. 
```

和

```
The type arguments for method 'ConsoleApplication1.Program.WriteResult<T>(ConsoleApplication1.Program.MyFunc<T>)' cannot be inferred from the usage. Try specifying the type arguments explicitly. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T07:14:42.187

“目标框架”设置的作用是禁用已添加到较新框架版本中的库和方法。大多数新语言功能不需要特殊的运行时支持或新库。所以如果你使用它们，你需要更新的编译器，但你的应用程序仍然可以在 2.0 上运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T07:11:12.787

没有我的 Jon 的书，但他可能很快就会出现！

这是在哪个板块？尝试在这里查找：http: [//cshapindepth.com/Notes.aspx](http://csharpindepth.com/Notes.aspx)

**编辑：**实际上，针对框架版本与编译器版本无关。所以你仍在使用 C# 3.0。编译器只需要弄清楚要生成什么 IL 以便它可以在 CLR 2.0 上运行，因此它可以执行尽可能多的推理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-21T07:35:48.697

这里涉及*几个*不同的版本：

*   IDE：Visual Studio 2008
*   .NET 框架：您的目标是 .NET 2.0
*   CLR：您的目标是 2.0（忽略服务包 :)
*   您正在使用的 C# 编译器：Visual Studio 2008 始终使用 C# 3.0 编译器
*   编译器所针对的语言版本：默认为 3.0

要在不返回 2.0 版编译器的情况下查看类型推断失败，您需要使 C# 编译器使用该语言的 2 版。不知道Visual Studio的速成版会不会暴露这个，但是你可以用命令行看看。

不幸的是 - 这*真的很*奇怪 - 我现在也无法以这种方式重现困难。

这是我刚刚尝试过的：

```
using System;

class Test
{
    public delegate T Function<T>();
    public static T Execute<T>(Function<T> function)
    {
        return function();
    }

    static void Main()
    {
        Execute(delegate { return 5; });
    }
} 
```

我希望编译

```
csc /langversion:ISO-2 Test.cs 
```

会失败......但它不会。使用真正的 C# 2 编译器确实会失败：

```
>c:\Windows\Microsoft.NET\Framework\v2.0.50727\csc Test.cs
Microsoft (R) Visual C# 2005 Compiler version 8.00.50727.3053
for Microsoft (R) Windows (R) 2005 Framework version 2.0.50727
Copyright (C) Microsoft Corporation 2001-2005\. All rights reserved.

Test.cs(14,9): error CS0411: The type arguments for method
        'Test.Execute<T>(Test.Function<T>)' cannot be
        inferred from the usage. Try specifying the type 
        arguments explicitly. 
```

# mysql - MySQL - 选择不在分组依据中的列

> ID：1023347
> 
> 赞同：59
> 
> 时间：2009-06-21T07:06:59.487
> 
> 标签：mysql, group-by

我正在尝试向预先存在的应用程序添加功能，我遇到了一个类似这样的 MySQL 视图：

```
SELECT
     AVG(table_name.col1),
     AVG(table_name.col2),
     AVG(table_name.col3),
     table_name.personID,
     table_name.col4
FROM table_name
GROUP BY table_name.personID; 
```

好的，所以有一些聚合函数。您可以选择 personID，因为您正在按它进行分组。但它也会选择不在聚合函数中且不属于 GROUP BY 子句的列。这怎么可能？？？它只是选择一个随机值，因为这些值绝对不是每组唯一的吗？

我来自哪里（MSSQL Server），这是一个错误。有人可以向我解释这种行为以及为什么它在 MySQL 中是允许的吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-06-21T08:22:26.543

确实，此功能允许一些模棱两可的查询，并默默地返回一个结果集，该结果集具有从该列中选择的任意值。在实践中，它往往是首先物理存储的组内行的值。

如果您只选择在功能上依赖于 GROUP BY 条件中的列的列，则这些查询不会有歧义。换句话说，如果定义组的每个值只能有一个“模糊”列的不同值，则没有问题。此查询在 Microsoft SQL Server（和 ANSI SQL）中是非法的，即使它在逻辑上不会导致歧义：

```
SELECT AVG(table1.col1), table1.personID, persons.col4
FROM table1 JOIN persons ON (table1.personID = persons.id)
GROUP BY table1.personID; 
```

此外，MySQL 有一个 SQL 模式，使其符合标准： [`ONLY_FULL_GROUP_BY`](http://dev.mysql.com/doc/refman/5.7/en/sql-mode.html#sqlmode_only_full_group_by)

FWIW，SQLite 也允许这些模棱两可的 GROUP BY 子句，但它选择组中*最后*一行的值。^(†</sup>)

* * *

^(†</sup> 至少在我测试的版本中。*任意*的意思是 MySQL 或 SQLite 将来可能会改变它们的实现，并有一些不同的行为。因此，在这种模棱两可的情况下，您不应依赖当前的行为方式。最好将您的查询重写为确定性而不是模棱两可。这就是 MySQL 5.7 现在默认启用 ONLY_FULL_GROUP_BY 的原因。)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-21T07:09:40.807

我应该再用 Google 搜索一下……看来我找到[了答案](http://dev.mysql.com/doc/refman/5.0/en/group-by-hidden-columns.html)。

> MySQL 扩展了 GROUP BY 的使用，以便您可以使用 SELECT 列表中未出现在 GROUP BY 子句中的非聚合列或计算。您可以使用此功能通过避免不必要的列排序和分组来获得更好的性能。例如，您不需要在以下查询中对 customer.name 进行分组
> 
> 在标准 SQL 中，您必须将 customer.name 添加到 GROUP BY 子句。在 MySQL 中，名称是多余的。

不过，这似乎……是错误的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-05T05:33:28.643

假设您有这样的查询：

```
SELECT g, v 
FROM t
GROUP BY g; 
```

在这种情况下，对于 的每个可能值`g`，mysql 选择 的对应值之一`v`。

但是，选择哪一个取决于某些情况。

我在某处读到，对于每组 g，`v`按照记录插入表的顺序保留的第一个值`t`。

这很丑陋，因为表中的记录应该被视为一个*集合*，其中元素的顺序不重要。这太“mysql-ish”了……

如果要确定`v`要保留哪个值，则需要`t`像这样应用子选择：

```
SELECT g, v 
FROM (
    SELECT * 
        FROM t 
        ORDER BY g, v DESC
) q
GROUP BY g; 
```

通过这种方式，您可以定义外部查询处理子查询记录的顺序，因此您可以相信它将`v`为`g`.

但是，如果您需要一些 WHERE 条件，则要非常小心。如果您将 WHERE 条件添加到子查询，那么它将保持该行为，它将始终返回您期望的值：

```
SELECT g, v 
FROM (
    SELECT * 
        FROM t 
        WHERE g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9' 
        ORDER BY g, v DESC
) q
GROUP BY g; 
```

这是您所期望的，子选择过滤器并对表进行排序。它保留`g`具有给定值的记录，外部查询返回该`g`值和`v`.

但是，如果将相同的 WHERE 条件添加到外部查询，则会得到不确定的结果：

```
SELECT g, v 
FROM (
    SELECT * 
        FROM t 
        -- WHERE g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9' 
        ORDER BY g, v DESC
) q
WHERE g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9'
GROUP BY g; 
```

`v`令人惊讶的是，当一次又一次地执行相同的查询时，您可能会得到不同的值，这很奇怪。预期的行为是从子查询中以适当的顺序获取所有记录，在外部查询中过滤它们，然后选择与前一个示例中选择的相同的记录。但事实并非如此。

它选择一个`v`看似随机的值。`v`如果我执行更多（~20）次但分布不均匀，相同的查询返回不同的值。

如果不是添加外部 WHERE，而是指定 HAVING 条件，如下所示：

```
SELECT g, v 
FROM (
    SELECT * 
        FROM t1 
        -- WHERE g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9' 
        ORDER BY g, v DESC
) q
-- WHERE g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9'
GROUP BY g
HAVING g = '737a8783-110c-447e-b4c2-1cbb7c6b72c9'; 
```

然后你再次得到一致的行为。

结论：我建议完全不要依赖这种技术。如果您真的想要/需要避免外部查询中的 WHERE 条件。如果可以的话，在内部查询中使用它，或者在外部查询中使用 HAVING 子句。

我用这个数据测试了它：

```
CREATE TABLE t1 (
    v INT,
    g VARCHAR(36)
);

INSERT INTO t1 VALUES (1, '737a8783-110c-447e-b4c2-1cbb7c6b72c9');
INSERT INTO t1 VALUES (2, '737a8783-110c-447e-b4c2-1cbb7c6b72c9'); 
```

在 mysql 5.6.41 中。

也许这只是一个在较新版本中得到/修复的错误，如果您有使用较新版本的经验，请提供反馈。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T09:21:45.020

```
select * from personel where p_id IN(select
min(dbo.personel.p_id)
FROM
personel
GROUP BY dbo.personel.p_adi) 
```

# java - 文本区域文本被分割的条件重复

> ID：1023355
> 
> 赞同：0
> 
> 时间：2009-06-21T07:13:07.167
> 
> 标签：java, string, textarea

我有一个文本区域，其中我限制用户在一行中输入超过 15 个字符，因为我希望将自由流动文本分成最大限制 15 个字符的子字符串，并为每一行分配一个订单号。这就是我在我的 java 类中所做的：

```
int interval = 15;                
items = new ArrayList();
 TextItem item = null;
 for (int i = 0; i < text.length(); i = i + interval) {
  item = new TextItem ();
  item.setOrder(i);

  if (i + interval < text.length()) {
    item.setSubText(text.substring(i, i + interval));
    items.add(item);
  } 
  else {
    item.setSubText(text.substring(i));
    items.add(item);
  }
} 
```

现在它可以正常工作，除非用户按下回车键。每当用户按下回车键时，我想将该行作为一个新项目，只有该部分作为子文本。

我可以检查我的`text.substring(i, i + interval`) 是否包含任何内容`"\n"`并拆分到那里，但问题是`"\n"`在下一个 15 或下一个之前获取剩余的字符`"\n"`并设置正确的顺序和子文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T07:24:35.550

你可以颠倒做事的顺序：首先，在出现'\n'时分割你的文本区域的内容。然后取出每个生成的字符串并将它们分成最大长度为 15 的部分。

编辑：我不完全确定你想做什么，但这就是我会做的。请注意，我不是 Java 程序员，所以我可能会做出错误的假设，以下内容未经测试。

```
int interval = 15;                
items = new ArrayList();
lines = text.split("\n");
for (int i = 0; i < lines.length(); i++)
{
  str = lines[i];
  while (str.length() > interval)
  {
    items.add(str.substring(0,interval)); // add the first 15 characters of str to the list
    str = str.substring(interval); // ... and remove them from str
  }
  items.add(str); // add the rest
} 
```

之后，items 是一个按正确顺序排列的字符串的 ArrayList。应该可以将此代码扩展到您需要与实际字符串一起存储的任何附加信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T11:57:04.003

这是你想要做的吗？

```
public static void main(String[] args)
{
  String str =
  "\n\n123456789ABCDEF123456\n123456789AB\n\n123" +
  "456789ABCDEF123456789AB\n123456789ABCDEF\n";

  List<String> parts = new ArrayList<String>();

  // remove leading line separators
  str = str.replaceFirst("\\A[\r\n]+", "");

  // match up to 15 non-newline characters, but don't
  // match a zero-length string at the end
  Matcher m = Pattern.compile("(?!\\z).{0,15}").matcher(str);
  while (m.find())
  {
    parts.add(m.group());
  }

  for (String s : parts)
  {
    System.out.println(s);
  }
} 
```

结果：

```
123456789ABCDEF
123456

123456789AB

123456789ABCDEF
123456789AB

123456789ABCDEF
```

# objective-c - 如何在iphone中使用整数值生成图形

> ID：1023359
> 
> 赞同：1
> 
> 时间：2009-06-21T07:15:08.800
> 
> 标签：objective-c, iphone, xcode

我想在 iphone 中显示图形/条形图，如果没有自定义 API，我该怎么做；s

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T15:16:03.197

您可能想要调查[Core Plot](https://code.google.com/archive/p/core-plot)项目 [code.google.com]。Core Plot 是今年 WWDC 科学编码项目的主题，已经在某些情况下非常有用。从一开始，Core Plot 就供 OS X 和 iPhone 使用。源代码分发（还没有二进制版本）附带 OS X 和 iPhone 示例应用程序，并且项目 wiki 上有关于将其用作 iPhone 应用程序中的库的信息。这是它当前绘图功能的示例。

[![替代文字](../Images/c25d0fddd10dfc90bae8a91746e15fcf.png)](https://i.stack.imgur.com/V9AM0.png)
[（来源：[googlecode.com](http://core-plot.googlecode.com/files/DarkGraph.png)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T13:09:54.667

写你自己的。这并不容易，我现在正在做同样的事情。这是我的做法：

首先，如果您想允许缩放，请忽略您可能必须尝试使用​​ UIScrollView 的任何愿望。这完全不值得。

其次，创建类似`GraphElement`协议的东西。我有一个看起来像这样的层次结构：

*   图元
*   图形路径元素
*   图形数据元素
*   GraphDataSupplierElement

GraphElement 包含图形元素的基本必要方法，包括如何绘制、最大宽度（用于放大）、点是否在该元素内（用于触摸）以及标准`touchBegan`、、`touchMoved`和`touchEnded`函数。

`GraphPathElement`包含 a `CGPath`，线条颜色和宽度，填充颜色和绘图模式。每当提示绘制时，它只是将路径添加到上下文中，设置颜色和线宽，并使用给定的绘制模式绘制路径。

`GraphDataElement`，作为 的子类`GraphPathElement`，以 xy 坐标、图形类型（条形或线形）、框架和边界接收一组数据。框架是创建的输出 CGPath 的实际大小。边界是输入坐标中数据的大小。从本质上讲，它可以让您将数据缩放到屏幕大小。

它通过首先计算仿射变换以将边界变换到帧来创建图形，然后循环遍历每个点并将其作为数据添加到路径中，在添加之前将该变换应用于该点。它如何添加数据取决于类型。

如果它是条形图，它会创建一个宽度为 0、原点位于 (x,frame.size.height-y) 且高度=y 的矩形。然后它将图形水平“插入”-3 个像素，并将其添加到路径中。

如果是折线图，那就简单多了。它只是移动到第一个点，然后对于每个其他点，它在该点添加一条线，在该点周围的矩形中添加一个圆，然后返回该点继续到下一个点。

`GraphDataSupplierElement`是我的数据库的接口，它实际上包含所有数据。它确定应该是哪种图形，将数据格式化为 所需的类型`GraphDataElement`，然后将其传递给 ，并带有用于该特定图形的颜色。

对我来说，x 轴是时间，用`NSTimeInterval`s 表示。`GraphDataSupplierElement`包含 a `minDate`，`maxDate`因此 a可以根据`GraphDateElement`需要绘制 x 轴标签。

完成所有这些后，您需要创建实际的图表。你可以通过几种方式来解决它。一种选择是将所有元素保留在 an 中`NSArray`，并且无论何时`drawRect:`调用，循环遍历每个元素并绘制它。另一种选择是`CALayer`为每个元素创建一个，并将`GraphPathElement`用作`CALayer`的委托。或者你可以直接`GraphPathElement`从扩展。`CALayer`这取决于你。我还没有到尝试`CALayer`s的程度，我还停留在简单的`NSArray`阶段。`CALayer`一旦我对一切看起来都感到满意，我可能会在某个时候移动到s。

因此，总而言之，这个想法是您`CGPath`预先将图形创建为一个或多个 s，并在需要绘制图形时绘制它，而不是在`drawRect:`接到电话时尝试实际解析数据。

缩放可以通过将源数据保存在您的 中来完成`GraphDataElement`，并且只需更改框架，以便框架边界的缩放创建`CGPath`比屏幕更宽的范围，或者您需要的任何内容。我基本上为我的 Graph 子类重新实现了我自己的捏缩放`UIView`，它只水平缩放，通过改变它的变换，然后在完成时，获取当前帧，将变换重置为标识，将帧设置为保存的值，并设置将所有`GraphElement`s 的框架也添加到新框架中，以使它们缩放。然后只需调用`[self setNeedsDisplay]`绘图。

无论如何，这有点漫不经心，但它是我如何实现它的概述。如果您有更具体的问题，请随时发表评论。

# asp.net-mvc - 使用 LINQ to SQL 和 ASP.Net MVC 进行多对多插入

> ID：1023360
> 
> 赞同：2
> 
> 时间：2009-06-21T07:18:00.837
> 
> 标签：asp.net-mvc, linq-to-sql, many-to-many

我有两个表：`Products(ProductID, ProductName)`和 之间的`Categories(CategoryID, CategoryName)` 多对多关系`Products``Categories` `ProductsCategories(ProductID, CategoryID)`

如何实现一个视图，使用户能够**使用 Asp.Net Mvc 和 LINQ to SQL**添加和编辑具有多个类别的产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T13:56:36.273

Since LINQ to SQL only supports a strict 1:1 mapping with your database you would have to make a link table. This would look something like...

[ProductCategories]
ID
ProductID (FK)
CategoryID (FK)

Then for every relationship of product to categories you would just make a new ProductCategories entity and insert it. So given the data...

Products
ID Name
1 Apple
2 XBOX 360

Categories
ID Name
1 Produce
2 Electronics
3 Game Systems

Your link table would look like

ProductCategories
ID ProductID CategoryID
1 1 1
2 2 2
3 2 3

# language-agnostic - 人名比较：处理此任务的方法

> ID：1023361
> 
> 赞同：2
> 
> 时间：2009-06-21T07:18:36.857
> 
> 标签：language-agnostic, nlp

我不是自然语言编程的学生，但我知道这不是微不足道的 strcmp(n1,n2)。

这是我到目前为止所学到的：

*   比较个人姓名无法 100% 解决
*   有一些方法可以达到一定程度的准确性。
*   答案将是特定于语言环境的，没关系。

我不是在寻找拼写替代品！假设是输入的拼写是正确的。

例如，以下所有名称都可以指同一个人：

*   贝瑞·查卡拉
*   伯纳德·查卡拉
*   贝瑞·J·查卡拉
*   查卡拉，贝瑞

我试着：

1.  构建（或复制）对关系 2 输入名称进行评分的算法
2.  查找索引方法（用于我的数据库中的名称、哈希表等）

注意：我的任务不是在文本中查找名称，而是比较两个名称。例如

```
name_compare( "James Brown", "Brown, James", "en-US" ) ---> 99.0% 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T07:54:27.940

我在 Python 中使用 Tanimoto Coefficient 快速（但不是超级）解决方案：

```
"""
Formula:
  Na = number of set A elements
  Nb = number of set B elements
  Nc = number of common items

  T = Nc / (Na + Nb - Nc)
"""
def tanimoto(a, b):
    c = [v for v in a if v in b]
    return float(len(c)) / (len(a)+len(b)-len(c))

def name_compare(name1, name2):
    return tanimoto(name1, name2)

>>> name_compare("James Brown", "Brown, James")
0.91666666666666663
>>> name_compare("Berry Tsakala", "Bernard Tsakala")
0.75
>>> 
```

**编辑：** [一本好书和有用的书的链接](https://rads.stackoverflow.com/amzn/click/com/0596529325)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T07:31:26.053

[Soundex](http://en.wikipedia.org/wiki/Soundex)有时用于比较相似的名称。它不处理名字/姓氏排序，但您可能只是让您的代码查找逗号来解决该问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T18:53:52.530

我们最近一直在不停地做这种工作，我们采取的方法是有一个查找表或别名列表。如果您可以忽略拼写错误/听错/非英语名称，那么困难的部分就被消除了。在您的示例中，我们假设第一个单词和最后一个单词是名字和姓氏。介于两者之间的任何内容都将被丢弃（中间名、首字母）。Berry 和 Bernard 将在别名列表中 - 当 Tsakala 与 Berry 不匹配时，我们将翻转词序然后得到匹配项。

您需要了解的一件事是您正在处理的数据库/人员列表。在英语世界中，中间名的记录不一致。因此，您不能根据中间名或中间名首字母进行匹配或拒绝匹配。Soundex 不会帮助您使用常见的别名，例如“Dick”和“Richard”、“Berry”和“Bernard”，可能还有“Steve”和“Stephen”。在某些社区，人们住在同一个地址并有 2 或 3 代人以相同的名字居住在该地址是很常见的。将它们分开的唯一方法是按出生日期。出生日期可能记录也可能不记录。如果您有影响力，那么您可能应该强制记录出生日期。很多“人员数据库”要么不

实际上人名匹配并不复杂。它完全基于所提供数据的质量。在实践中发生的情况是，许多记录仍然不匹配——即使是看着它们的人也无法解决不匹配的问题。一个人可能会注意到别名列表中没有记录的别名，或者可能能够在 Internet 上查找该人的详细信息 - 但您不能真的指望您的程序会这样做。

银行、信用评级机构和政府有很多关于我们的详细信息。以前的地址，出生日期等。这有助于他们加入姓名。但对我们普通程序员来说，没有灵丹妙药。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T16:46:35.053

当然，分析名称顺序和中间名/首字母的存在是微不足道的，因此看起来真正的挑战是了解常用名称替代方案。我怀疑这可以在不使用某种昵称查找表的情况下完成。 [这个列表](http://deron.meranda.us/data/nicknames.txt)是一个很好的起点。它不会将 Bernard 映射到 Berry，但它可能会捕获最常见的情况。也许可以在其他地方找到更详尽的列表，但我绝对认为特定于语言环境的查找表是要走的路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-04T04:01:47.047

我在使用 utf-8 的 Tanimoto 上遇到了真正的问题。

对使用变音符号的语言有效的是`difflib.SequenceMatcher()`

# iphone - 您如何将应用程序仅限于 iPhone 而不是 iPod [iPhone SDK]？

> ID：1023363
> 
> 赞同：1
> 
> 时间：2009-06-21T07:21:10.317
> 
> 标签：iphone

提交向导中曾经有一个选项，您可以在其中指定您的应用程序是适用于 iPhone、iPod 还是两者兼有。现在该选项在 3.0 中消失了。然后我注意到 info.plist “应用程序需要 iPhone 环境”中有一个额外的选项。我检查了此项目，但该应用程序在门户中仍标记为 iPhone 和 iPod。有任何想法吗？找不到任何文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T13:51:17.643

When you finish your application and submit it to Apple for approval, there's a form on iTunes Connect where you can specify which devices it is compatible with. Many apps that use the camera, for example, are marked as iPhone-only. I'm not sure how they're handling the new 3G S, but there's definitely a way to limit the app to the iPhone only.

I think the item in the Info.plist is talking about Mac OS X v. iPhone, not iPod v. iPhone.

Hope that helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T23:40:40.023

iTunes Connect 中“添加新应用程序”向导的“概述”页面应该在“应用程序名称”和“应用程序描述”字段之后有一个“设备”下拉列表（它是从顶部算起的第三个字段）。那是你要找的地方吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T06:19:36.400

他们可能已经把它拿出来了，因为它并没有真正起作用。有人可以从 iTunes 购买任何应用程序，但只有在安装时他们才会发现它被限制在 Touch 上运行......

只需在描述中尽可能清楚地说明您需要什么。

# c++ - 如何将预建库添加到 VC++ 解决方案？

> ID：1023368
> 
> 赞同：0
> 
> 时间：2009-06-21T07:26:16.470
> 
> 标签：c++, visual-studio-2008, visual-c++

如果您为它创建一个项目并将其与解决方案中的其他项目一起构建，那么在 VC++ 2008 中使用库非常容易，但是如果该库的构建过程过于复杂并且必须通过 makefile 单独编译怎么办？

我的库就是这样，虽然我在命令行上编译它没有问题，但我不知道如何处理生成的头文件和 .lib 文件。我已将它们全部放在一个目录中，并将其路径添加到我的主项目的附加包含目录中，因此它可以很好地找到头文件。我还将相关信息添加到附加库目录和附加依赖项。

除了这三个之外，也许还有另一个我忘记设置的设置？我会很感激我能得到的所有帮助。谢谢。

**编辑**这是我得到的语法错误：

[http://pastebin.com/m72ece684](http://pastebin.com/m72ece684)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T07:32:37.580

好的，基于这些错误，它与查找您的 .lib 文件无关，它在头文件中窒息。

编辑：

它看起来像在 windows.h 中的某个地方，有一个 X942_DH_PARAMETERS 的宏定义正在破坏你的 dl_group.h。

不要将您的植物头文件放在顶部，而是将 windows.h 放在顶部，然后在您 #include 的植物头文件之前添加以下行：

```
#undef X942_DH_PARAMETERS 
```

或者正如我刚刚发现的那样，该宏是在 wincrypt.h 中定义的，如果您将 NOCRYPT 添加到您的预处理器定义中，它将不会包含该文件。由于您使用的是第三方加密库，因此您可能不需要 wincrypt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T07:42:39.510

虽然我不能确切地说出您的问题是什么，但我可以就如何找到解决方案提供一些建议。我建议创建一个包含单个方法和单个类的简单库，构建它，然后尝试将其成功链接到您的项目。一旦你在较小的规模上完成了这项工作，请尝试使用您的原始库重复这些步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T08:13:21.880

对于 msvc 编译器，您可以添加

```
#pragma comment(lib, "MYLIBNAME.lib") 
```

在你的标题中。这将自动使链接器在“附加库目录”中查找“MYLIBNAME.lib”。

如果不再出现错误

*   找不到标题...
*   找不到 MYLIBNAME.lib

该问题可能与其他一些问题有关，例如错误的 C 运行时、调试版本不匹配、...

PS：如果lib在解决方案树中只是设置对lib的依赖，会导致VS将targetpath添加到libfolder，将libname添加到库中。

# xcode - Xcode 针对不同目标的不同资源

> ID：1023371
> 
> 赞同：6
> 
> 时间：2009-06-21T07:27:50.537
> 
> 标签：xcode, resources, reference, target, custom-build-step

我正在开发一个 iPhone 应用程序，该应用程序将有完整版和精简版。为了从同一个源代码和 Xcode 项目中获取两个包，我向 Xcode 项目添加了另一个目标。

现在，我想让 Lite 目标仅将资源文件的一个子集复制到包中。但是，Xcode 不会简单地让我从“复制文件到捆绑包”构建步骤中删除单个文件，因为我将所有资源作为文件夹引用导入。我需要这个来维护资源目录中的目录结构。

我该如何解决这个问题？非常感谢任何建议或想法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-27T08:08:31.667

在 Xcode 的左侧面板中，右键单击顶部的“组和文件”栏。勾选“目标会员”。

现在，您将看到应包含在当前构建目标中的每个文件的勾号。取消你不想要的那些，切换到你的另一个目标，然后重复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-27T18:09:14.767

无需操作目标的“复制捆绑资源”步骤，您可以右键单击资源文件或组（文件夹），选择“获取信息”，并在信息窗口的“目标”选项卡下有选择地将内容从 Lite 构建中删除对于您选择的文件。在组（文件夹）上执行此操作会递归更改，因此使用资源组（文件夹）是为单独的构建创建单独的资源集合的一种非常简单的方法。

# java - Findbugs 警告：整数移位 32 - 这是什么意思？

> ID：1023373
> 
> 赞同：10
> 
> 时间：2009-06-21T07:28:55.073
> 
> 标签：java, findbugs, bit

我正在使用 Findbugs 扫描第三方源代码（只是在集成到我的之前要小心），并发现以下警告：

```
long a = b << 32 | c 
```

> 错误：整数移位 32 模式 id：ICAST_BAD_SHIFT_AMOUNT，类型：BSHIFT，类别：CORRECTNESS
> 
> 该代码在 0..31 范围之外执行一个常数值的整数移位。这样做的效果是使用整数值的低 5 位来决定要移动多少。这可能不是预期的，而且至少令人困惑。

任何人都可以解释一下上面的确切含义吗？

谢谢！（我是Java编程的新手）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-21T07:38:54.570

来自[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.19)：

> 如果左侧操作数的提升类型是 int，则只有右侧操作数的五个最低位用作移位距离。就好像右手操作数经过位逻辑与运算符 & (§15.22.1) 与掩码值 0x1f。因此，实际使用的移位距离始终在 0 到 31 的范围内，包括 0 到 31。

因此，如果 b 是 int，则表达式等同于

```
long a = b | c; 
```

我非常怀疑这是有意的。应该是

```
long a = ((long) b << 32) | c; 
```

（如果 b 已经很长，则代码是正确的，并且 FindBugs 对错误有误）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T07:32:43.867

*编辑：*问题几乎肯定源于'b'是'int'而不是'long'这一事实。

在 C 语言中，如果 'b' 是整数而不是 long 并且您左移 32 位，~~则原始值中的所有位都已被删除，因此整体表达式的结果将与~~您会的 'c' 相同调用未定义的行为，因此任何结果都是允许的。Java 对事物的定义不同——正如 Rasmus Faber 的评论和选择的答案中所指出的那样——并且会以可以移动的最大位数为模进行超长移位。[这似乎是一种奇怪的经商方式；我可能已经用有它们的语言安排了一个例外。但是，它是明确定义的，这比确切的定义更重要。] 在计算表达式时不会发生对 64 位的强制；它发生在表达式完成并且分配发生时。

对 5 位的引用是……很有趣。这意味着如果您左移 48 位或二进制 110000，则与左移 16 位相同。或者，“ `x << n`”与“ ”相同`x << (n % 32)`。

# c# - 为什么 C# 中的集合类（如 ArrayList）继承自多个接口，如果其中一个接口继承自其余接口？

> ID：1023375
> 
> 赞同：32
> 
> 时间：2009-06-21T07:29:09.693
> 
> 标签：c#, inheritance, interface, arraylist

当我在 ArrayList 关键字上按 f12 转到从 vs2008 生成的元数据时，我发现生成的类声明如下

```
public class ArrayList : IList, ICollection, IEnumerable, ICloneable 
```

我知道 IList 已经从 ICollection 和 IEnumerable 继承了，那么为什么 ArrayList 会冗余地从这些接口继承呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-21T08:19:39.043

好的，我已经做了一些研究。如果您创建以下层次结构：

```
 public interface One
    {
        void DoIt();
    }

    public interface Two : One
    {
        void DoItMore();
    }

    public class Magic : Two
    { 
        public void DoItMore()
        {
            throw new NotImplementedException();
        }

        public void DoIt()
        {
            throw new NotImplementedException();
        }
    } 
```

并编译它，然后在不同的解决方案中引用 DLL，键入 Magic 并按 F12，您将得到以下信息：

```
 public class Magic : Two, One
    {
        public Magic();

        public void DoIt();
        public void DoItMore();
    } 
```

您会看到接口层次结构是扁平化的，还是编译器正在添加接口？如果您使用反射器，您也会得到相同的结果。

更新：如果你在 ILDASM 中打开 DLL，你会看到它说：

实现...两个

实现...一个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T07:38:01.750

显示额外的接口是因为它们被 IList 隐含。如果实现 IList，则还必须实现 ICollection 和 IEnumerable。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T07:41:47.123

我只是猜测，但我认为实际上它只在代码中实现 IList，但文档还显示了其余接口，以便使用该类的程序员明确说明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T07:45:15.633

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms173157(VS.80).aspx) ....

> 如果一个类实现了两个包含具有相同签名的成员的接口，那么在该类上实现该成员将导致两个接口都使用该成员作为它们的实现。
> 
> 显式实现也用于解决两个接口各自声明具有相同名称的不同成员（例如属性和方法）的情况：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T08:20:38.887

不要接受这个作为答案。

我在重复上面 workmad3 所说的话。

通过在 ArrayList 中实现它，人们很容易知道 - ArrayList 实现了哪些接口，而不是通过 IList 发现它实现了 ICollection 和 IEnumerable。

这避免了来回继承链的需要。

编辑：在基本级别，实现另一个接口的接口不能提供实现。派生的类（来自 IList）因此也间接实现了 ICollection 和 IEnumerable。因此，即使您编写自己的实现 IList 的类（而不是在声明中添加 ICollection、IEnumerable） - 您也会看到它必须提供 ICollection 和 IEnumerable 的实现。

workmad3 的推理是有道理的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T12:43:14.267

我的猜测是 CLR 不支持从另一个接口继承的接口。

然而，C# 确实支持这种构造，但必须“扁平化”继承树以符合 CLR。

[编辑]

从下面得到建议后，快速设置一个 VB.Net 项目：

```
Public Interface IOne
    Sub DoIt()
End Interface

Public Interface ITwo
    Inherits IOne
    Sub DoIt2()
End Interface

Public Class Class1
    Implements ITwo

    Public Sub DoIt() Implements IOne.DoIt
        Throw New NotImplementedException()
    End Sub

    Public Sub DoIt2() Implements ITwo.DoIt2
        Throw New NotImplementedException()
    End Sub
End Class 
```

编译结果如下（C#）：

```
public class Class1 : ITwo
{
    public Class1();
    public void DoIt();
    public void DoIt2();
} 
```

这表明与 C# 相比，VB.Net 不会**扁平**化接口层次结构。我不知道为什么会这样。

# java - 为什么我不能在 IntelliJ 中拖动执行点（我可以在 Visual Studio 中）

> ID：1023376
> 
> 赞同：33
> 
> 时间：2009-06-21T07:30:31.547
> 
> 标签：java, .net, visual-studio, debugging, intellij-idea

在 Visual Studio 中，调试时，可以将执行点（当前指令指针，黄点）拖到当前方法中的另一个位置。

这在 IntelliJ 中是不可能的，有些人说这在 Java 中通常是不可能的。为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-21T07:46:55.210

IntelliJ 通过标准的 Java 调试接口与正在运行的 JVM 交互，因此它可以针对不同的 JDK 调试程序。这不支持您描述的移动执行点。

它确实可以让您回退调用堆栈并再次执行方法调用。在 IntelliJ 中，使用线程窗口选择挂起线程的堆栈帧并返回到它。然后继续线程以在程序中重新调用该点的方法。

注意：这不会回滚对象的状态，因此可能会出现奇怪的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T09:31:13.127

在 Eclipse 中，如果您编辑正在调试的方法导致被调试的代码被更新，JVM 会将执行回滚到第一个安全位置。通常这是该方法的第一行。

这在调试场景中非常有用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-21T09:14:32.583

您可以告诉调试器向前“运行到行”。

* * *

## 回答 #4

> 赞同：-8
> 
> 时间：2009-06-21T08:35:31.493

Java 没有可以指向随机代码段的当前执行指针。Java 假定执行顺序在代码中，而不是您可以操纵的东西。

也许您可以解释为什么要这样做，我们可以让您知道实现相同目标的另一种方法。

# objective-c - 如何将 NSArray 和 NSArrayController 与 Core Data 一起使用？

> ID：1023378
> 
> 赞同：-4
> 
> 时间：2009-06-21T07:31:18.580
> 
> 标签：objective-c, cocoa, nsarray

我有一些代码需要访问 NSArray 才能工作。我有一个与 Core Data 一起使用的 NSArray，其中将包含数据，但我不确定如何让我的 NSArrayController 访问 NSArray。

我不能像这样简单地在 Header 文件中声明它：`NSArray *objectArray;`因为它不知道如何访问或`NSArray`访问哪个。我将如何访问与 Core Data 一起使用的 NSArray？

**我的头文件：**

```
#import <Cocoa/Cocoa.h>

@interface MyOutlineView : NSOutlineView {
    NSArrayController* objectArray;
}

@end 
```

**我的实施文件：**

```
#import "MyOutlineView.h"

@implementation MyOutlineView

- (void) outlineView: (NSOutlineView *) aView
     willDisplayCell: (id) aCell
      forTableColumn: (NSTableColumn *)aColumn
                item: (id) anItem
{
    id rootObj = anItem;
    unsigned row = [aView rowForItem:anItem];

    [aCell setDrawsBackground: YES];

    while ([aView levelForRow:row] != 0) {
        row --;
        rootObj = [aView itemAtRow:row];
    }

    // The colours here are foul and ugly.  Use something else, for
    // God's sake!
    if( [objectArray indexOfObject:rootObj] % 2 )
        [aCell setBackgroundColor: [NSColor yellowColor]];
    else
        [aCell setBackgroundColor: [NSColor blueColor]];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T16:03:33.360

我制作了一个测试应用程序，其中 IBOutlet 从 Xib 连接到 NSArrayController。在这个测试中，我有：

*   从 Core Data 应用程序模板开始；
*   在具有两个属性（字符串、整数）的数据模型中创建实体；

在西布：

*   带有托管对象上下文的数组控制器，连接到 Test_AppDelegate.managedObjectContext；
*   TableView 与 cols 连接到 Array Controller 的第一个和第二个属性的排列对象；
*   添加和删​​除按钮，连接到阵列控制器的添加：和删除：操作；
*   按钮“显示计数”和标签；-

在代码中（Test_AppDelegate.*）：

*   IBOutlet NSArrayController *ac; （在 Xib 中从 Test_AppDelegate.ac 连接到阵列控制器）；
*   IBOutlet NSTextField *nLabel; （在 Xib 中连接到标签）；
*   (IBAction)showNum:(id)sender; （从“显示计数”按钮连接）；
*   实际代码 showNum: [nLabel setIntValue:[[ac mappedObjects] count]];

我能够：

*   向表格视图和受控数组添加/删除对象；
*   从代码中访问 NSArrayController 以获取 ArrangeObjects 数组。

因此，将 IBOutlet 从代码绑定到 Xib 的数组控制器并访问它的排列对象应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T19:55:18.717

我可能没有得到这个 - 但你不能只创建一个 initWithArray 方法吗？

# javascript - 如何创建显示全屏按钮以将我的谷歌地图页面切换为全屏？

> ID：1023386
> 
> 赞同：14
> 
> 时间：2009-06-21T07:35:54.170
> 
> 标签：javascript, google-maps

我在我的页面的一部分上集成了一个谷歌地图。我想创建一个切换按钮来在全屏和正常大小之间切换地图。因此，当您单击它时 - 地图会延伸到整个浏览器屏幕，然后再次单击它，它会恢复到页面上的原始大小。我该怎么做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-28T05:34:54.263

这是一个jQuery实现。

```
$("#map_toggler").click(function() {
  $("#map").toggleClass("fullscreen")
}); 
```

在 CSS 中：

```
#map {
  width: 400px;
  height: 200px;
}

#map.fullscreen {
  position: fixed;
  width:100%;
  height: 100%;
} 
```

未经测试，但类似的东西应该可以工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-21T12:38:22.640

如果您的页面上有地图，您需要做的就是编写一些 javascript 来调整包含地图的 DIV 的大小。我还没有实现一个调整 DIV 大小以填充浏览器的示例，但这[是](http://www.cannonade.net/geo.php?test=geo5)一个从 javascript 切换地图 div 大小的示例（我使用 mooTools 设置元素上的 style.width，但你可以使用任何你更喜欢操纵 DOM）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-02T12:27:26.233

在 Dom 准备就绪：

*   初始化地图并设置中心
*   获取包含地图的 div 的当前 CSS 大小

在输入全屏按钮上单击：

*   更新 CSS（大小和位置）
*   触发resize map方法
*   设置地图中心

在退出全屏按钮上单击：

*   更新 CSS（回到初始大小和位置）
*   触发resize map方法
*   设置地图中心

[你可以在这里](https://gist.github.com/1550454)找到代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-15T15:12:57.747

现在我们有了一个全屏 API [https://developer.mozilla.org/en/DOM/Using_full-screen_mode](https://developer.mozilla.org/en/DOM/Using_full-screen_mode)您只需选择要设置为全屏的 DOM 元素并在其上调用全屏 API。像这样的东西

```
var elem = document.getElementById("myvideo");
if (elem.requestFullScreen) {
  elem.requestFullScreen();
} else if (elem.mozRequestFullScreen) {
  elem.mozRequestFullScreen();
} else if (elem.webkitRequestFullScreen) {
  elem.webkitRequestFullScreen();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-28T05:19:10.290

单击时，您必须调整显示地图的 div 的大小.....我认为这很简单

# javascript - 多个仪表板小部件实例无法在小部件更新后继续存在。有什么办法可以防止这种情况？

> ID：1023397
> 
> 赞同：0
> 
> 时间：2009-06-21T07:44:42.813
> 
> 标签：javascript, macos, dashcode, mac-dashboard-widget

我编写了一个 Mac OS X 仪表板来展示你自己和其他人的 StackOverflow 天赋。

我的问题是，每当我将该小部件更新到新版本时，所有以前的实例都会被删除，并在仪表板上创建一个新实例。因此，如果您之前跟随 4 个人的风格，您将不得不重新创建小部件并再次输入他们的用户 ID。:(

有没有办法在更新小部件时保留所有正在运行的实例？

检查首选项文件，我看到在部署新版本的小部件后创建了一个新实例。这是设计使然吗？是否**所有**小部件都像这样工作？如果是这样，可以以某种方式手动规避吗？

[您可以在http://widget.huxhorn.de](http://widget.huxhorn.de)找到相关的小部件，包括项目文件

我已经更改了 remove() 中的代码，以**将**首选项设置为正确的值，而不是如下建议的*null* - 但这也无济于事。
我的错是什么？？帮助！我被困住了！

* * *

我的小部件的另一个问题已修复：
我不小心调用了

```
widget.preferenceForKey(null, dashcode.createInstancePreferenceKey(userIdPrefKey)); 
```

代替

```
widget.preferenceForKey(dashcode.createInstancePreferenceKey(userIdPrefKey)); 
```

但这现在已修复（尚未发布）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-12T05:53:33.913

我知道这个接管安装过程的工具：http: [//junecloud.com/software/mac/smart-widget-installer.html](http://junecloud.com/software/mac/smart-widget-installer.html)

[![替代文字](../Images/ceb132cf7adae16bfc056c1b06f44261.png)](https://i.stack.imgur.com/wJ5RU.jpg)
[（来源：[juncloud.com](http://junecloud.com/images/entries/.junecode/480x800/20080928_7125.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T08:19:26.377

我认为您对 setPreferenceForKey 和 preferenceForKey 的调用看起来很奇怪。这是哪里`null`来的。他们不应该看起来像吗

```
widget.preferenceForKey(dashcode.createInstancePreferenceKey(userIdPrefKey))
widget.setPreferenceForKey(value, dashcode.createInstancePreferenceKey(userIdPrefKey)); 
```

语法是否与`null`

```
widget.setPreferenceForKey(null, dashcode.createInstancePreferenceKey(userIdPrefKey)) 
```

在`remove()`删除首选项？我猜这可以解释你的情况。在更新`remove()`时调用了 surley，因此在重新启动小部件时，首选项消失了。

* * *

我想只有一种方法可以在更新期间保持您的偏好。创建一个首选项键而不依赖dashboard.createInstancePreferenceKey，而是认为自己有一个唯一的键值。

在这个preferenceKey中，您可以使用不断增长的（比如逗号分隔）列表保存所有曾经输入的用户ID（通过任何实例）。当一个小部件实例打开并且`widget.preferenceForKey(dashcode.createInstancePreferenceKey(userIdPrefKey))`尚未设置时，您可以让用户通过给他一个选择或类似的东西来选择其中一个

我只是在想也许更新过程足够好，可以将首选项迁移到新版本。即使您不删除首选项，我认为 widget.identifier (createInstancePreferenceKey) 也会更改，因此您无法访问“旧”设置。

# c# - 如何打印多页WPF？

> ID：1023401
> 
> 赞同：2
> 
> 时间：2009-06-21T07:47:24.757
> 
> 标签：c#, .net, wpf, printing

我有一个视觉效果，我希望打印我的多页。我有更多的页面可以打印出每个内容留在 StackPanel（它会像报告一样增加存储数据上下文）我希望像 StackPanel 中的 pageBreak 一样创建来修复页面大小所以开始再打印一页，但我不知道如何创建此功能。你有什么建议，诀窍，帮助解决这一步。祝您有愉快的一天，并提前感谢您的关注。

# c# - 如何使用从sql数据库中检索

> ID：1023406
> 
> 赞同：0
> 
> 时间：2009-06-21T07:52:19.333
> 
> 标签：c#

我想要说明如何使用从 sql 数据库表中检索到的数据，我的意思是我想用 c# 使用同一个表中两列的最后一个单元格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T07:59:16.260

假设您的表有以下列：

1.  ID
2.  姓名

您可以按如下方式访问第二列“名称”：

```
DataTable dtb=....;//Here your code returns DataTable

//suppose you want to set value of second column (Name) from 1st row on a label

label1.Text = dtb.Rows[0][1];

//OR

label1.Text = dtb.Rows[0]["Name"];

//OR if you want to use second column from all rows, say in a list

foreach(DataRow dr in dtb.Rows)
{
    list1.Items.Add(dr["Name"]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T15:48:18.873

使用 SqlDataReader：

```
using (SqlDataReader reader = command.ExecuteReader()) {
  while (reader.Read()) {
     int id = (int)reader["ID"]; // or reader.GetInt(0);
     string name = reader["Name"].ToString(); // or reader.GetString(1);
  }
  reader.Close();
} 
```

# linux - 网络中断后重新初始化/重新连接终端

> ID：1023413
> 
> 赞同：4
> 
> 时间：2009-06-21T08:00:45.573
> 
> 标签：linux, session, ssh, terminal

我有一个可能是一个非常简单的终端相关问题。我正在使用 Gnome 运行 Ubuntu 8.10 Intrepid Ibex，并且我经常打开一个基于终端的 ssh 会话，只是为了稍后将其删除。一旦会话被丢弃，终端就变得不可用，显然是因为网络连接被丢弃了。

有没有办法重新初始化会话，甚至恢复到工作的本地终端？

在 Windows 下，使用 putty，发生这种情况时，我可以右键单击并选择重新启动会话，并且不需要打开新终端，但是在 linux 下，我对这个主题缺乏了解导致我总是关闭已失效的终端，并且从头开始重新启动一个新的。如果有的话，我想学习一个新的有用的技巧。

另外，我发现以下帖子的措辞与我的非常相似，

[网络中断后自动（或更容易）重新连接到屏幕会话](https://stackoverflow.com/questions/474967/automatically-or-more-easily-) reconnect-to-a-screen-session-after-network-interr

但是，据我所知，这是一个不同的话题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T08:16:24.403

[你想使用你的 SSH 转义](http://www.void.gr/kargig/blog/2006/01/24/ssh-escape-characters/)。默认情况下它是'~'和~。将终止您的连接。

您链接到的问题是关于屏幕的，一旦您使用转义字符终止本地 ssh 进程并重新连接，这对于恢复远程会话很有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T08:16:56.023

首先用于`~.`在本地断开 ssh 连接。这会让您回到正常工作的本地终端。您也可以使用另一个终端来终止相应的 ssh 命令。

为了保持您的远程状态，您应该`screen`按照之前的建议使用。

我最近发现了[mosh](https://mosh.org/)，它是一个有趣的基于 UDP 的可恢复 shell 客户端。它使用 ssh 来初始化连接，并且可能需要在服务器上安装 mosh（以及客户端和服务器之间的 UDP 访问），但是它可以从客户端的断开连接和 IP 更改中恢复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-30T21:17:41.553

要让您的本地终端再次可用，您可以使用*reset*命令。

要在虚拟终端中运行命令，您可以使用*screen*或*tmux*附加/分离。*屏幕*的典型用法：

```
$ screen -S somename
screen$ some-console-command
...
^ad 
```

您可以通过键入 ctrl+a 然后 d 从屏幕分离

然后您可以列出会话并附加到它

```
$ screen -ls
$ screen -dr somename
screen$ 
```

# python - 使用 django 和 sqlalchemy 但后端 mysql

> ID：1023417
> 
> 赞同：1
> 
> 时间：2009-06-21T08:09:55.867
> 
> 标签：python, mysql, django, sqlalchemy

我正在使用 python 的 django 框架。我的模型是 sqlalchemy，我的后端数据库是 mysql。我将如何配置它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T12:52:13.300

一些可能对您有帮助的链接：

> [http://lethain.com/entry/2008/jul/23/replacing-django-s-orm-with-sqlalchemy/](http://lethain.com/entry/2008/jul/23/replacing-django-s-orm-with-sqlalchemy/)
> 
> [http://code.google.com/p/django-sqlalchemy/](http://code.google.com/p/django-sqlalchemy/)
> 
> [http://adam.gomaa.us/blog/2007/aug/26/the-django-orm-problem/](http://adam.gomaa.us/blog/2007/aug/26/the-django-orm-problem/)
> 
> [http://gitorious.org/django-sqlalchemy](http://gitorious.org/django-sqlalchemy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T09:09:24.093

请参阅[Django 数据库安装](http://docs.djangoproject.com/en/dev/topics/install/#database-installation)，

> 如果您使用 MySQL，则需要 MySQLdb，版本 1.2.1p2 或更高版本。您还需要阅读 MySQL 后端的特定于数据库的说明。

和[MySQL 笔记](http://docs.djangoproject.com/en/dev/ref/databases/#id2)，

> Django 期望数据库支持事务、参照完整性和 Unicode（UTF-8 编码）。幸运的是，MySQL 早在 3.23 就具备所有这些特性。虽然可以使用 3.23 或 4.0，但如果使用 4.1 或 5.0，您可能会遇到更少的麻烦。

# c# - 如何将比较器用于 HashSet

> ID：1023424
> 
> 赞同：12
> 
> 时间：2009-06-21T08:14:24.983
> 
> 标签：c#, templates, dictionary, hashset

由于我在这里提出的另一个问题，我想为我的对象使用 HashSet

我将创建包含字符串和对其所有者的引用的对象。

```
public class Synonym
{
   private string name;
   private Stock owner;
   public Stock(string NameSynonym, Stock stock)
   {
       name=NameSynonym;
       owner=stock
   }
   // [+ 'get' for 'name' and 'owner']
} 
```

我知道我需要一个比较器，但以前从未使用过它。我应该创建一个单独的类吗？像：

```
public class SynonymComparer : IComparer<Synonym>
{
   public int Compare(Synonym One, Synonym Two)
   { // Should I test if 'One == null'  or  'Two == null'  ???? 
       return String.Compare(One.Name, Two.Name, true); // Caseinsesitive
   } 
```

}

我更喜欢有一个函数（或嵌套类[可能是单例？] 如果需要）作为类 Synonym 的一部分，而不是另一个（独立）类。这可能吗？

关于用法：因为我之前从未使用过这种东西，所以我想我必须在 Synonym 类中编写一个 Find(string NameSynonym) 函数，但我应该怎么做呢？

```
public class SynonymManager
{ 
    private HashSet<SynonymComparer<Synonym>> ListOfSynonyms;

    public SynonymManager()
    {
        ListOfSymnonyms = new HashSet<SynonymComparer<Synonym>>();
    }

    public void SomeFunction()
    { // Just a function to add 2 sysnonyms to 1 stock
        Stock stock = GetStock("General Motors");
        Synonym otherName = new Synonym("GM", stock);
        ListOfSynonyms.Add(otherName);
        Synonym otherName = new Synonym("Gen. Motors", stock);
        ListOfSynonyms.Add(otherName);
    }

    public Synonym Find(string NameSynomym)
    {
       return ListOfSynonyms.??????(NameSynonym);
    }
 } 
```

在上面的代码中，我不知道如何实现“查找”方法。我该怎么做？

任何帮助将不胜感激（PS如果我关于如何实施的想法完全错误，请告诉我并告诉我如何实施）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-21T09:01:58.117

HashSet 不需要`IComparer<T>`- 它需要`IEqualityComparer<T>`，例如

```
public class SynonymComparer : IEqualityComparer<Synonym>      
{
   public bool Equals(Synonym one, Synonym two)
   {
        // Adjust according to requirements.
        return StringComparer.InvariantCultureIgnoreCase
                             .Equals(one.Name, two.Name);

   }

   public int GetHashCode(Synonym item)
   {
        return StringComparer.InvariantCultureIgnoreCase
                             .GetHashCode(item.Name);

   }
} 
```

但是，您当前的代码只能编译，因为您正在创建一组*比较器*而不是一组*同义词*。

此外，我认为你根本不想要一套。在我看来，您需要字典或查找，以便您可以找到给定名称的同义词：

```
public class SynonymManager
{ 
    private readonly IDictionary<string, Synonym> synonyms = new
        Dictionary<string, Synonym>();

    private void Add(Synonym synonym)
    {
        // This will overwrite any existing synonym with the same name.
        synonyms[synonym.Name] = synonym;
    }

    public void SomeFunction()
    { 
        // Just a function to add 2 synonyms to 1 stock.
        Stock stock = GetStock("General Motors");
        Synonym otherName = new Synonym("GM", stock);
        Add(otherName);
        ListOfSynonyms.Add(otherName);
        otherName = new Synonym("Gen. Motors", stock);
        Add(otherName);
    }

    public Synonym Find(string nameSynonym)
    {
       // This will throw an exception if you don't have
       // a synonym of the right name.  Do you want that?
       return synonyms[nameSynonym];
    }
} 
```

请注意，上面的代码中有一些问题，关于您希望它在各种情况下如何表现。你需要弄清楚你想要它做什么*。*

EDIT: If you want to be able to store multiple stocks for a single synonym, you *effectively* want a `Lookup<string, Stock>` - but that's immutable. You're probably best storing a `Dictionary<string, List<Stock>>`; a list of stocks for each string.

In terms of not throwing an error from `Find`, you should look at `Dictionary.TryGetValue` which doesn't throw an exception if the key isn't found (and also returns whether or not the key *was* found); the mapped value is "returned" in an out parameter.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T08:28:28.747

`Synonym`完全废弃该类并将同义词列表作为字符串`Dictonary`（或者，如果有这样的话， ）不是更合理吗？`HashDictionary`

（我对 C# 类型不是很熟悉，但我希望这能传达一般的想法）

我推荐的答案（已编辑，现在尊重案例）：

```
 IDictionary<string, Stock>>  ListOfSynonyms = new Dictionary<string,Stock>>(); 
    IDictionary<string, string>> ListOfSynForms = new Dictionary<string,string>>(); 
    class Stock 
    {   
        ...
        Stock addSynonym(String syn) 
        {
            ListOfSynForms[syn.ToUpper()] = syn;
            return ListOfSynonyms[syn.ToUpper()] = this;
        }
        Array findSynonyms()
        {
            return ListOfSynonyms.findKeysFromValue(this).map(x => ListOfSynForms[x]);
        }
    }

    ...
    GetStock("General Motors").addSynonym('GM').addSynonym('Gen. Motors');
    ...
    try  
    {
        ... ListOfSynonyms[synonym].name ...
    }  
    catch (OutOfBounds e) 
    {
        ...
    } 
    ...
    // output everything that is synonymous to GM. This is mix of C# and Python
    ... GetStock('General Motors').findSynonyms()
    // test if there is a synonym
    if (input in ListOfSynonyms) 
    {
        ...
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T08:28:45.000

您始终可以使用 LINQ 进行查找：

```
public Synonym Find(string NameSynomym)
{
   return ListOfSynonyms.SingleOrDefault(x => x.Name == NameSynomym);
} 
```

但是，您是否考虑过使用 Dictionary 代替，我相信它更适合提取单个成员，并且您仍然可以根据您选择的键保证没有重复项。

我不确定查找时间是 SingleOrDefault，但我很确定它是线性的 (O(n))，所以如果查找时间对您很重要，字典将为您提供 O(1) 查找时间。

# new-operator - 如何推广新产品/服务？

> ID：1023434
> 
> 赞同：7
> 
> 时间：2009-06-21T08:22:00.007
> 
> 标签：new-operator, ads, product, promotions

对于单独开发产品或服务的开发人员来说，这通常是一个问题。他们如何宣传他们的产品？

我最近完成了我的一个项目，我正在努力传播它。

您认为推广您的新产品/服务的最佳方式是什么？

尽管这个问题与编程并不*严格*相关，但对于想要将他们的作品进行创作的程序员来说，这是一个很好的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T08:32:03.840

互联网（显然）。

如果你一个人去做，通过博客、Facebook 和 Twitter 的草根工作。

您还可以购买 google 广告词和其他与广告相关的场所。

您可以考虑您的项目的开源版本，或加入与您的产品解决的任何问题相关的贸易组/论坛，并开始建立追随者（但请*不要*向这些组发送垃圾邮件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T08:52:09.290

您应该有一个简短的教程来解释您的产品的功能以及如何使用它，而无需安装任何东西或填写单个表格。我不确定[AnyHub](http://www.anyhub.net/)（OP 的网站）对我的文件做了什么，我将如何共享或管理它们，或者你为什么免费这样做。

看看 Web 2.0 的感受，看看它们如何简化从点击到客户的流程。例如， [Twitter](http://twitter.com/)在首页上有“什么”、“为什么”和“如何”按钮，没有其他东西可以分散你的注意力。它在那里也有激励性的推荐，并以代表这个想法为主题。

此外，您应该尝试找到许多人的痛点并尝试缓解它。Twitter 知道通过电子邮件、短信、博客、订阅源、RSS 等方式告诉您的朋友您在做什么是不可能的，因此请妥善处理。您提供什么（除了替代定价模式？）在您的网站上告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T09:00:28.900

**得益于 Apple 的 iPhone App Store 范式**，如今手机应用真的很容易推广。现在所有主要参与者（RIM、诺基亚、Palm 等）都开设了自己的应用商店，这从开发者那里夺走了大部分的推广工作。只要您的应用程序、游戏等有趣，它就会自行销售。尽管如此，一切都取决于您启动应用程序的第一周，并且它在最新到货列表中。

[尽管 Sun 最近宣布了针对 Java 应用程序的类似推广计划，](http://blogs.oracle.com/jonathan/entry/will_java_be_the_world)但在桌面世界中事情变得更加困难。更多可能会随之而来，但这将取决于 Sun 的成功或失败。

我相信（并且实际上希望）集中式“销售服务”将成为在不久的将来购买应用程序、游戏、插件、服务等的主要方式。过去太方便了。

# jquery - jQuery .load() 函数 + IE + 动态 URL = 掉发

> ID：1023442
> 
> 赞同：0
> 
> 时间：2009-06-21T08:33:43.383
> 
> 标签：jquery, ajax, load

IE 在 jQuery 加载函数中遇到了动态 url 的困难。

这是我的代码片段：

`var formValues = $('#testing').serialize();`
`var URL = "test.cfm?" + formValues;`
`var dialogOpts = {`
`modal: true,`
`bgiframe: true,`
`autoOpen: true,`
`height: 500,`
`width: 500,`
`draggable: true,`
`resizable: false,`
`closeOnEscape: false,`
`open: function() {`
`//display correct dialog content`
`$("#dialogContainer").load(URL}`
`};`
`$("#dialogContainer").dialog(dialogOpts);`

现在请注意，如果我将 URL 更改为诸如“thisHTMLfile.html”之类的静态内容，这将在 FF 和 IE 中完美运行。但由于 IE 的 URL 是动态的 barfs。我得到一个空白对话框。就好像 IE 不会进行 ajax 调用一样。

我已经尝试在字符串中放置一个随机值以使其成为唯一的 url，这样 IE 就不会缓存 url，没有骰子。

我还检查了 test2.cfm 文件是否有任何 HTML 错误。这里没有问题。

有没有人遇到过这个？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T08:43:28.607

@Karim79：是的，那会搞砸我，但这只是我在这里输入屏幕。不过，这在我的代码上是正确的。

我确实弄清楚了这个问题。我的 Coldfusion localhost 已将内部调试设置为 ON。它向我显示了为该页面运行的所有代码和进程。我认为这个额外的代码喷出让 IE 呕吐。所以我关闭了调试输出，瞧。我的 IE 6 头痛已经过去了 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T08:38:53.687

这可能只是一个错字，但这看起来很可疑：

```
open: function() {
//display correct dialog content
$("#dialogContainer").load(URL} <<< this curly brace
};

open: function() {
//display correct dialog content
$("#dialogContainer").load(URL) <<< should be a closing parentheses ')'
}; 
```

# java - 如果在响应提交后调用 java servlet:response.sendRedirect() 不会给出非法状态异常。为什么？

> ID：1023443
> 
> 赞同：1
> 
> 时间：2009-06-21T08:35:22.350
> 
> 标签：java, exception, servlets, redirect, commit

在提交响应后，因为这里的重定向语句应该给出异常，但如果这个重定向 statemnet 在 if 块中，它不会这样做。但是如果它不在 if 块中，它确实会给出异常。我已经显示了相同的语句（带有标记的星号）在下面的两个地方。你能告诉我原因吗？

```
protected void doPost(HttpServletRequest request, HttpServletResponse response)          throws    ServletException, IOException {
            // TODO Auto-generated method stub
    synchronized (noOfRequests)
    {
        noOfRequests++;
        }
        PrintWriter pw=null;
        response.setContentType("text/html");
        response.setHeader("foo","bar"); 
```

//由于上面的语句，响应被提交

```
 pw=response.getWriter();
        pw.print("hello : "+noOfRequests); 
```

//如果我删除下面的语句，这个相同的语句出现在 if block.so 语句中，如果块中的语句也应该像这个一样给出异常，但它没有这样做。为什么？

```
***response.sendRedirect("http://localhost:8625/ServletPrc/login%  20page.html");

    if(true)
    {
                  //same statement as above
        ***response.sendRedirect("http://localhost:8625/ServletPrc/login%20page.html");
    }
    else{

        request.setAttribute("noOfReq", noOfRequests);
        request.setAttribute("name", new Name().getName());
        request.setAttribute("GmailId",this.getServletConfig().getInitParameter("GmailId") );
        request.setAttribute("YahooId",this.getServletConfig().getInitParameter("YahooId") );
        RequestDispatcher view1=request.getRequestDispatcher("HomePage.jsp");
        view1.forward(request, response);

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T08:59:24.003

来自[servlet 规范](http://cds-esd.sun.com/ESD34/JSCDL/servlet/2.5-mrel2/servlet-2_5-mrel2-spec.pdf?AuthParam=1245574684_c10fb3b19151a5547f3e78e4b1286392&TicketId=B/w5kxWITFJNTRREO1JfnAHn&GroupName=CDS&FilePath=/ESD34/JSCDL/servlet/2.5-mrel2/servlet-2_5-mrel2-spec.pdf&File=servlet-2_5-mrel2-spec.pdf)，5.3：

> 如果响应尚未提交，这些方法将具有提交响应并终止它的副作用。调用这些方法后，servlet 不应再向客户端输出任何内容。如果在调用这些方法后将数据写入响应，则数据将被忽略。
> 
> 如果数据已经写入响应缓冲区，但没有返回给客户端（即响应未提交），则必须清除响应缓冲区中的数据，并用这些方法设置的数据替换。如果响应已提交，这些方法必须抛出 IllegalStateException。

我认为这两个规范涵盖了您的所有情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-01T21:20:08.267

尝试在第一个块结束之前放置一个 response.flush ，尽可能多地写入，但除非它被发送出缓冲区，否则它仍然没有提交。

# exchange-server - 与 Exchange Server 2003 邮箱通信

> ID：1023446
> 
> 赞同：0
> 
> 时间：2009-06-21T08:38:36.323
> 
> 标签：exchange-server

我正在寻找某种方法来使用 XMLHttpRequest 访问 Exchange Server 2003 邮箱，以便在我的页面上呈现收件箱等文件夹。

我知道我必须在我的 url 传递过程中包含凭据，但我不知道如何指定。有没有办法或一些例子来从服务器获取一些 XMLResponse ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T08:49:37.283

这篇 Microsoft 支持文章[如何以编程方式获取 Exchange 中邮箱的大小](http://support.microsoft.com/kb/320071)包含代码示例，可能是一个起点。此外，[如何在 Visual Basic .NET 中使用 XMLHTTP 和 WebDAV 发送简单的电子邮件](http://support.microsoft.com/kb/314187)

此代码片段显示了发送请求的基本模式：

```
strURL = "http://" & strExchangeServerName & "/Exchange/" & strMailboxName & "/" & 
strFolderName

Set objXMLHTTP = CreateObject("Microsoft.XMLHTTP")
objXMLHTTP.Open "DELETE", strURL, False, strUserName, strPassword
objXMLHTTP.setRequestHeader "Depth", "infinity,noroot"
objXMLHTTP.Send() 
```

# drupal - Drupal：最好的论坛模块？

> ID：1023451
> 
> 赞同：26
> 
> 时间：2009-06-21T08:43:43.457
> 
> 标签：drupal, module, forum

用于 Drupal 的最佳论坛模块是什么？核心有点欠缺。我正在调查：[http ://drupal.org/project/advanced_forum](http://drupal.org/project/advanced_forum)

有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-21T09:06:39.823

您可以查看使用 Drupal 的核心论坛模块：http: [//drupal.org/handbook/modules/forum](http://drupal.org/handbook/modules/forum)。
它易于扩展，您可以根据需要对其进行自定义。看看所有这些：

*   [高级论坛](http://drupal.org/project/advanced_forum)（强烈推荐）
*   [引用](http://drupal.org/project/quote)
*   [BB码](http://drupal.org/project/bbcode)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-22T17:15:59.090

AdvForum 和[“DruBB”项目](http://drupal.org/project/drubb)现在正在进行大量工作。AdvForum 的维护者和 Drupal 7 的发布维护者都为 DruBB 作为 PHPBB 的 Drupal 原生替代品投入了相当多的精力，即使它还没有准备好立即部署，也值得关注。如果您有任何开发能力并且愿意深入研究代码，他们几乎可以肯定地在开发工作或测试方面使用帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-21T09:05:05.270

Drupal 没有很好的开箱即用解决方案或模块。我建议你在你的服务器上安装[phpBB](http://www.phpbb.com/)，然后使用[这个模块](http://drupal.org/project/phpbb)将它与你的 Drupal 站点链接起来。phpBB 是一款很棒的软件！关于模块的一点介绍：

> 在实践中，它从 Drupal 数据库中获取内容，并在每次用户登录时更新 phpBB 数据库。它还提供了一个列出论坛最近主题的块。此模块需要 mod_rewrite/clean URL，**不建议初学者使用**。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-12-09T10:30:18.320

RPforum 对于基本的快速论坛实施来说相当不错，而不是 Advanced_forum 需要大量的研发才能找到适合您需求的合适模块。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-30T12:22:30.920

无耻的自我推销：我为 Drupal 6 创建了一个高级论坛的替代品，称为 RP 论坛。If 为您提供一个功能齐全（虽然简单）的论坛，并且尽可能少地额外下载。我不喜欢高级论坛的原因之一是它可能需要 10 到 20 个额外的模块下载才能构建您想要的功能集。

无论如何，可以在我的网站上找到 RP 论坛（和现场演示）： [http ://www.richardpeacock.com/get-rpforum](http://www.richardpeacock.com/get-rpforum)

# maven-2 - Maven 和 Spring

> ID：1023456
> 
> 赞同：1
> 
> 时间：2009-06-21T08:46:08.710
> 
> 标签：maven-2

嗨，我正在学习 Spring In Action 2.0，我是 Maven 新手。我正在浏览章节和代码，但是当我在 Eclipse 的 pom 编辑器上通过 pom.xml 导入项目时出现以下错误。

> 6/21/09 3:19:42 AM CDT：缺少间接引用的工件孵化器-activemq:activeio-core:jar:3.0-beta3:compile
> 
> 6/21/09 3:19:42 AM CDT：缺少间接引用的工件孵化器-activemq:activemq-core:jar:4.0:compile

我下载了jar文件并添加到库中。它仍然不起作用。我被卡住了下一步该怎么办？谁能帮我这个？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-02T15:14:46.450

[引用的 jar 在Maven2 中央存储库](http://repo1.maven.org/maven)上不可用，因此除非您在 POM 中有额外的存储库声明或在设置中有活动配置文件，否则 Maven 将不知道从哪里获取工件。

有一些像[这里](https://test.kuali.org/maven/)和[这里](http://repo.fusesource.com/maven2)这样的公共存储库托管这些工件。要使用这些存储库，您可以将相关的存储库声明添加到您的 POM 或设置中。有关示例配置，请参见[此处。](http://www.dailydev.org/resources/maven)

或者，如果您不信任存储库，您可以手动下载 jar 并将它们放入本地 Maven 存储库，尽管您需要小心复制 Maven 期望的结构，并且您很可能会遇到不同 jar 的相同问题.

另一种选择是使用 Maven 存储库管理器（如[Nexus](http://nexus.sonatype.org/)或[Artifactory](http://www.jfrog.org/products.php)）来管理 Maven 与外部存储库的交互，但如果您刚刚开始，这几乎肯定是太多信息。

有关 Maven 的一般帮助/信息，请查看[Maven 书籍](http://www.sonatype.com/books/maven-book/reference/)。

# javascript - 如何以编程方式替换（包装）新方法中的方法？

> ID：1023460
> 
> 赞同：2
> 
> 时间：2009-06-21T08:53:03.110
> 
> 标签：javascript, methods, scope, variable-assignment

我有几种方法需要以基本相同的方式包装在新方法中。我的第一个解决方案不起作用，我明白为什么，但我不知道是否有一个简单的解决方案可以解决这个问题，或者是否不能按照我想要的方式完成。

这是一个例子。我有具有 onClick 方法的对象 ac。我需要在 onClick 方法之前执行一些代码。我尝试了以下方法：

```
// objects a-c
a = {onClick : function () { console.log('a'); }};
b = {onClick : function () { console.log('b'); }};
c = {onClick : function () { console.log('c'); }};

// first try
var arr = [a, b, c]
for (var i = 0; i < arr.length; i++) {
    var oldOnClick = arr[i].onClick;
    arr[i].onClick = function () {
        // new code here
        oldOnClick();
    }  
}

// outputs 'c'
// what i want is to maintain a reference to the original method
// so in this case, execute my new code and output 'a'
a.onClick(); 
```

这不起作用，因为当调用新方法时，oldOnClick 将指向上一次迭代中的方法，而不是分配时的 to 方法。

有没有我忽略的简单解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T09:08:42.767

你需要的是关闭：

```
for(var i=0, l=arr.length; i<l; i++){
 (function(i){
   var oldOnclick = arr[i].onClick; 
   //etc.
 })(i);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T09:08:49.773

Javascript 绑定规则很奇怪。真的，javascript 很奇怪。

我不知道我会称之为修复它*的*方法，但是通过引入一个子函数，您可以引入另一个绑定，从而解决这个特定问题。

您的（针对快速 Chrome 黑客修改）代码变为：

```
a = {onClick : function () { alert('a'); }};
b = {onClick : function () { alert('b'); }};
c = {onClick : function () { alert('c'); }};

var arr = [a, b, c]
for (var i = 0; i < arr.length; i++) {
    var oldOnClick = arr[i].onClick;
    arr[i].onClick = bind(oldOnClick);
}

a.onClick();
b.onClick();
c.onClick();

function bind(oldFunc)
{
    return function () {
        //New Code
        oldFunc();
    }  
} 
```

上面的代码抛出了三个警报：a、b、c。任何替换“//新代码”的东西都将在正确的时间运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T09:11:31.420

您是否尝试过一些用于 Javascript 的 AOP 框架？

例如使用 jQuery AOP 插件：

```
jQuery.aop.before( {target: String, method: 'replace'}, 
  function(regex, newString) { 
    alert("About to replace string '" + this + "' with '" + newString + 
          "' using regEx '" + regex + "'");
  }
); 
```

也在[这里](https://stackoverflow.com/questions/1005486/javascript-aop-libraries)检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T15:48:46.097

```
var a = {onClick : function () { console.log('a'); }};
var b = {onClick : function () { console.log('b'); }};
var c = {onClick : function () { console.log('c'); }};

var arr = [a, b, c];
for (var i = 0; i < arr.length; i++) {
    var oldOnClick = arr[i].onClick;
    arr[i].onClick = wrapHandler(oldOnClick);  
}

function wrapHandler(handler) {
    return function() {
        console.log("New stuff");
        handler();
    }
}

a.onClick(); // outputs "New stuff" then "a"
b.onClick(); // outputs "New stuff" then "b"
b.onClick(); // outputs "New stuff" then "c" 
```

# sql-server-2008 - 如何使用 IP 地址远程连接到 Sql Server 2008？

> ID：1023462
> 
> 赞同：0
> 
> 时间：2009-06-21T08:53:26.433
> 
> 标签：sql-server-2008, connection-string, remote-connection

当我发布我的项目时，客户需要能够设置初始配置，其中一部分是 Sql 数据库连接。我的系统 (MSSQLSERVER2008) 和 SQLEXPRESS2005 上运行了一个 Sql Server 2008 实例。我正在尝试在本地使用以下连接字符串来查看它是否有效，但我无法让它工作：

```
ConnectionString = {Data Source=127.0.0.1;Initial Catalog=DCOMProductionsDesktop;Integrated Security=False;User ID=DCOMProductionsDesktopService;Password=;Network Library=dbmssocn} 
```

我得到的错误是通常的“目标机器主动拒绝连接”。

*没有任何防火墙在运行，并且无论如何都在网络内部 *TCP/IP 协议已启用 *远程连接已启用并允许

所以，我很难过。

**编辑**

我将连接字符串的数据源更改为：

```
DataSource=192.168.0.2\MSSQLSERVER2008 on my WinXP VM (for testing remotely) 
```

现在，这确实奏效了。但是，当我在 Internet 上部署它时，相同的连接字符串是否适用于我的网络外部使用域名的客户端，例如：

```
DataSource=desktop.dcomproductions.com\MSSQLSERVER2008 
```

还是我需要做一些不同的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T09:06:13.223

只要“desktop.dcomproductions.com”或其他任何东西解析到正确的IP地址，它就可以工作。因此，应在公共或私有 DNS 上正确设置该名称。

此外，请确保它解析为公共/外部 IP 地址，除非您的客户端脚本与 SQL 服务器位于同一网络中。

以为我将其发布为答案，而不是评论:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T08:58:26.377

已经有一段时间了，我使用除命名管道之外的任何东西来连接到 sql server 实例，所以这可能无关紧要，但尝试 changong Data Source to Server。

正如我所说，它们可能是同义词，已经有一段时间了。

此外，即使您使用的是 IP 地址，也没有指定要连接的 sql server 实例，这也可能导致问题

# iphone - iPhone 应用程序在启动时使用 60mb 的虚拟内存

> ID：1023471
> 
> 赞同：2
> 
> 时间：2009-06-21T09:00:36.653
> 
> 标签：iphone, virtual-memory

现在，我知道我的应用程序使用了很多图形，但不是 60mb 的图形。但是，Instruments 显示该应用程序在启动后就使用了 60+mb 的虚拟内存。编译后的应用程序有 24mb 大，我们说的是启动后空闲的欢迎屏幕；知道为什么 VM 大小可能会这么大吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T17:33:41.843

The virtual memory is the address space allocated by your app from calls like malloc. This does not mean that it uses this much physical memory. For example, all libraries (libSystem, ...) that your app links to are allocated in shared memory, which is part of your virtual memory.

A good explanation of memory types can be found in the help of the "Activity Monitor" application. There's also a [great blog post](http://www.mikeash.com/?page=pyblog/friday-qa-2009-06-19-mac-os-x-process-memory-statistics.html) from Mike Ash.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T09:20:23.790

您如何/何时加载图像？

我猜测一下，60MB 是您的应用程序的大小，其中包含未压缩的图像。

# c# - 推荐一个使用 C# 读取 Excel 文件的教程

> ID：1023472
> 
> 赞同：4
> 
> 时间：2009-06-21T09:01:18.820
> 
> 标签：c#, .net, excel

我有 C# 经验，但在使用 C# 从 Excel 读取内容方面经验有限。我的任务很简单，只需读取 Excel 文档每一行的每一列并检索它们的值。

对于初学者有什么好的教程或示例吗？我正在使用 VSTS 2008 + C# + .Net 3.5。

我正在使用 Excel 2007。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T09:41:07.460

Excel 2007 文件的格式并不简单。[使用Open XML Format SDK 2.0](http://www.microsoft.com/downloads/details.aspx?FamilyID=c6e744e5-36e9-45f5-8d8c-331df206e0d0&DisplayLang=en)获取单元格的文本值 需要很多操作。如果您不打算使用不知道的第三方库，则必须深入了解此 SDK。有教程，但即使对于您的简单任务，我也不知道简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T16:59:57.313

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)可以做到。下面是 C# 控制台应用程序中的一个简单示例：

```
using System;
using SpreadsheetGear;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            // Load Book.xlsx.
            IWorkbook workbook = Factory.GetWorkbook(@"c:\Book.xlsx");
            // Write the address and formatted text value of each
            // cell to the console.
            foreach (IRange cell in workbook.Worksheets[0].UsedRange)
                Console.WriteLine("{0}='{1}'", cell.Address, cell.Text);
        }
    }
} 
```

[您可以在此处](https://www.spreadsheetgear.com/downloads/register.aspx)下载免费试用版并亲自试用。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T09:05:13.290

看看这个[链接](http://support.microsoft.com/kb/302084)。

根据您的描述，这就足够了，但是如果您需要创建一个插件，我只会看看 VSTO。只是谷歌/ bing它，相当容易:)

# c++ - 注入的DLL在哪里循环？

> ID：1023474
> 
> 赞同：1
> 
> 时间：2009-06-21T09:01:46.043
> 
> 标签：c++, multithreading, dll, loops, detours

所以我有一个应用程序可以启动另一个应用程序并注入我的 DLL（使用 Detours）。入口点是 DllMain。我不能从 DllMain 做很多事情，当然也不能循环。那么如何每隔 x 秒调用一次我的 DLL 监视器函数呢？我读到你不能从 DllMain 创建一个线程（至少在它返回之前），它是真的，因为它让我崩溃了。所以我尝试在附加线程事件中创建它，它让我崩溃了。所以现在我要做的是再次注入它（以防 Detours 失败），这样我就可以获得模块句柄。然后我得到一个创建我的线程的初始化函数的地址。我得到了模块句柄，但我认为我不能得到函数地址。我将函数设为空，但它仍然让我崩溃。所以它甚至没有达到调用函数的程度。Visual Studio 说我没有读取权限。

那我该怎么办？当您不拥有附加的程序 (exe) 时，您如何循环您的 DLL 函数。

```
//Application.exe
STARTUPINFO si = {sizeof(STARTUPINFO)};
        PROCESS_INFORMATION pi = {0};

        DetourCreateProcessWithDll(filename, NULL, NULL, NULL, TRUE, 
                                    CREATE_DEFAULT_ERROR_MODE | CREATE_SUSPENDED, NULL, path,
                                    &si, &pi, detoured, hook, NULL);

        processID = pi.dwProcessId;

        hDll = InjectDLL(processID, hook);

if(hDll != NULL)
{
STARTER Starter = (STARTER)GetProcAddress(hDll, "Starter");

if(Starter != NULL)
    Starter();
}

        ResumeThread(pi.hThread); 
```

函数 Starter 是 extern C 导出的，并且看起来很好检查（它是序数 1）。

我不知道可能出了什么问题，只希望那里有人对这个话题和崩溃有过经验。

这是DLL代码：

```
//Hook.h
extern "C"
{
    void __declspec(dllexport) Starter(void);
}

//Hook.cpp
void Starter(void)
{

} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T09:51:19.500

您不能这样做，因为 DLL 被注入到不同的进程中，并且您正试图在挂钩进程的地址空间中执行该函数。

您需要做的是调用[CreateRemoteThread](http://msdn.microsoft.com/en-us/library/ms682437.aspx)，在 lpStartAddress 参数中传入您从 GetProcAddress 获得的地址。这将在远程进程上创建一个新线程，并在该进程的地址空间中，在新线程的上下文中执行该函数。

顺便说一句，从技术上讲，您应该能够在 DllMain/DLL_PROCESS_ATTACH 中创建一个新线程，只要您不与其他线程进行任何同步，尽管不推荐这样做。我不确定如果在注入 DLL 时这样做会存在什么问题。

# c# - 推荐一个库/API 在 C# 中解压缩文件

> ID：1023476
> 
> 赞同：48
> 
> 时间：2009-06-21T09:03:24.463
> 
> 标签：c#, .net, zip

看起来 C# 中没有内置库/API 来解压缩 zip 文件。我正在寻找一个免费（更好的开源）库/API，它可以与 .Net 3.5 + VSTS 2008 + C# 一起使用，以解压缩 zip 文件并将所有文件提取到特定文件夹中。

任何推荐的库/API 或示例？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-21T09:06:43.147

GPL

[http://www.icsharpcode.net/OpenSource/SharpZipLib/](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

或限制较少的 Ms-PL

[http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)

为了完成这个答案，.net 框架有[ZipPackage](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage.aspx)我没有成功。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-03-20T05:00:59.753

如果您只想将文件的内容解压缩到文件夹中，并且您知道您只能在 Windows 上运行，则可以使用 Windows Shell 对象。我`dynamic`在这个例子中使用了 Framework 4.0，但是你可以使用`Type.InvokeMember`.

```
dynamic shellApplication = Activator.CreateInstance(Type.GetTypeFromProgID("Shell.Application"));

dynamic compressedFolderContents = shellApplication.NameSpace(sourceFile).Items;
dynamic destinationFolder = shellApplication.NameSpace(destinationPath);

destinationFolder.CopyHere(compressedFolderContents); 
```

您可以使用[FILEOP_FLAGS](http://www.pinvoke.net/default.aspx/Enums/FILEOP_FLAGS.html)来控制`CopyHere`方法的行为。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-07-03T21:27:29.100

[DotNetZip](http://dotnetzip.codeplex.com)易于使用。这是一个解压缩示例

```
using (var zip = Ionic.Zip.ZipFile.Read("archive.zip"))
{
   zip.ExtractAll("unpack-directory");
} 
```

如果您有更复杂的需求，例如您想选择要提取的条目，或者是否有密码，或者如果您想控制提取文件的路径名等等等等，有很多选项. [查看帮助文件](http://cheeso.members.winisp.net/DotNetZipHelp)以获取更多示例。

DotNetZip 是免费和开源的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-07-03T21:35:42.063

过去，我使用过[DotNetZip](http://www.codeplex.com/DotNetZip) (MS-PL)、[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/) (GPL) 和用于 C# （公共域）的[7ZIP SDK 。](http://www.7-zip.org/sdk.html)它们都工作得很好，并且是开源的。

在这种情况下，我会选择 DotNetZip，下面是[C# 示例页面](http://dotnetzip.codeplex.com/Wiki/View.aspx?title=Examples)中的一些示例代码：

```
using (ZipFile zip = ZipFile.Read(ExistingZipFile))
{
  foreach (ZipEntry e in zip)
  {
    e.Extract(TargetDirectory);
  }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-21T09:13:52.023

SharpZipLib

[http://www.icsharpcode.net/OpenSource/SharpZipLib/](http://www.icsharpcode.net/OpenSource/SharpZipLib/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-08-27T07:10:26.260

看看我的小图书馆：[https ://github.com/jaime-olivares/zipstorer](https://github.com/jaime-olivares/zipstorer)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-21T15:38:39.627

如果您想使用 7-zip 压缩，请查看 Peter Bromberg 的[EggheadCafe 文章](http://www.eggheadcafe.com/tutorials/aspnet/064b41e4-60bc-4d35-9136-368603bcc27a/7zip-lzma-inmemory-com.aspx)。注意：c# 的[LZMA 源代码](http://www.7-zip.org/sdk.html)没有 xml 注释（实际上，注释很少）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-09T11:50:30.167

如果您不想使用外部组件，这里是我昨晚使用 .NET 的 ZipPackage 类开发的一些代码。

```
private static void Unzip()
{
    var zipFilePath = "c:\\myfile.zip";
    var tempFolderPath = "c:\\unzipped";

    using (Package pkg = ZipPackage.Open(zipFilePath, FileMode.Open, FileAccess.Read))
    {
        foreach (PackagePart part in pkg.GetParts())
        {
            var target = Path.GetFullPath(Path.Combine(tempFolderPath, part.Uri.OriginalString.TrimStart('/')));
            var targetDir = target.Remove(target.LastIndexOf('\\'));

            if (!Directory.Exists(targetDir))
                Directory.CreateDirectory(targetDir);

            using (Stream source = part.GetStream(FileMode.Open, FileAccess.Read))
            {
                CopyStream(source, File.OpenWrite(target));
            }
        }
    }
}

private static void CopyStream(Stream input, Stream output)
{
    byte[] buffer = new byte[4096];
    int read;
    while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
    {
        output.Write(buffer, 0, read);
    }
} 
```

注意事项：

*   ZIP 存档的根目录中必须有一个 [Content_Types].xml 文件。这对我的要求来说不是问题，因为我将控制通过此代码提取的任何 ZIP 文件的压缩。关于[Content_Types].xml文件的更多信息，请参考：http: [//msdn.microsoft.com/en-us/magazine/cc163372.aspx](http://msdn.microsoft.com/en-us/magazine/cc163372.aspx)文章图13下方有一个示例文件。

*   我没有测试 CopyStream 方法以确保它的行为正确，因为我最初是使用 Stream.CopyTo() 方法为 .NET 4.0 开发的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-03T03:52:58.860

```
 #region CreateZipFile
    public void StartZip(string directory, string zipfile_path)
    {
        Label1.Text = "Please wait, taking backup";
            #region Taking files from root Folder
                string[] filenames = Directory.GetFiles(directory);

                // path which the zip file built in 
                ZipOutputStream p = new ZipOutputStream(File.Create(zipfile_path));
                foreach (string filename in filenames)
                {
                    FileStream fs = File.OpenRead(filename);
                    byte[] buffer = new byte[fs.Length];
                    fs.Read(buffer, 0, buffer.Length);
                    ZipEntry entry = new ZipEntry(filename);
                    p.PutNextEntry(entry);
                    p.Write(buffer, 0 , buffer.Length);
                    fs.Close();
                }
            #endregion

            string dirName= string.Empty;
            #region Taking folders from root folder
                DirectoryInfo[] DI = new DirectoryInfo(directory).GetDirectories("*.*", SearchOption.AllDirectories);
                foreach (DirectoryInfo D1 in DI)
                {

                    // the directory you need to zip 
                    filenames = Directory.GetFiles(D1.FullName);
                    if (D1.ToString() == "backup")
                    {
                        filenames = null;
                        continue;
                    }
                    if (dirName == string.Empty)
                    {
                        if (D1.ToString() == "updates" || (D1.Parent).ToString() == "updates" || (D1.Parent).Parent.ToString() == "updates" || ((D1.Parent).Parent).Parent.ToString() == "updates" || (((D1.Parent).Parent).Parent).ToString() == "updates" || ((((D1.Parent).Parent).Parent)).ToString() == "updates")
                        {
                            dirName = D1.ToString();
                            filenames = null;
                            continue;
                        }
                    }
                    else
                    {
                        if (D1.ToString() == dirName) ;
                    }
                    foreach (string filename in filenames)
                    {
                        FileStream fs = File.OpenRead(filename);
                        byte[] buffer = new byte[fs.Length];
                        fs.Read(buffer, 0, buffer.Length);
                        ZipEntry entry = new ZipEntry(filename);
                        p.PutNextEntry(entry);
                        p.Write(buffer, 0, buffer.Length);
                        fs.Close();
                    }
                    filenames = null;
                }
                p.SetLevel(5);
                p.Finish();
                p.Close();
           #endregion
    }
    #endregion

    #region EXTRACT THE ZIP FILE
    public bool UnZipFile(string InputPathOfZipFile, string FileName)
    {
        bool ret = true;
        Label1.Text = "Please wait, extracting downloaded file";
        string zipDirectory = string.Empty;
        try
        {
            #region If Folder already exist Delete it
            if (Directory.Exists(Server.MapPath("~/updates/" + FileName))) // server data field
            {
                String[] files = Directory.GetFiles(Server.MapPath("~/updates/" + FileName));//server data field
                foreach (var file in files)
                    File.Delete(file);
                Directory.Delete(Server.MapPath("~/updates/" + FileName), true);//server data field
            }
            #endregion

            if (File.Exists(InputPathOfZipFile))
            {
                string baseDirectory = Path.GetDirectoryName(InputPathOfZipFile);

                using (ZipInputStream ZipStream = new

                ZipInputStream(File.OpenRead(InputPathOfZipFile)))
                {
                    ZipEntry theEntry;
                    while ((theEntry = ZipStream.GetNextEntry()) != null)
                    {
                        if (theEntry.IsFile)
                        {
                            if (theEntry.Name != "")
                            {
                                string directoryName = theEntry.Name.Substring(theEntry.Name.IndexOf(FileName)); // server data field

                                string[] DirectorySplit = directoryName.Split('\\');
                                for (int i = 0; i < DirectorySplit.Length - 1; i++)
                                {
                                    if (zipDirectory != null || zipDirectory != "")
                                        zipDirectory = zipDirectory + @"\" + DirectorySplit[i];
                                    else
                                        zipDirectory = zipDirectory + DirectorySplit[i];
                                }
                                string first = Server.MapPath("~/updates") + @"\" + zipDirectory;
                                if (!Directory.Exists(first))
                                    Directory.CreateDirectory(first);

                                string strNewFile = @"" + baseDirectory + @"\" + directoryName;

                                if (File.Exists(strNewFile))
                                {
                                    continue;
                                }
                                zipDirectory = string.Empty;

                                using (FileStream streamWriter = File.Create(strNewFile))
                                {
                                    int size = 2048;
                                    byte[] data = new byte[2048];
                                    while (true)
                                    {
                                        size = ZipStream.Read(data, 0, data.Length);
                                        if (size > 0)
                                            streamWriter.Write(data, 0, size);
                                        else
                                            break;
                                    }
                                    streamWriter.Close();
                                }
                            }
                        }
                        else if (theEntry.IsDirectory)
                        {
                            string strNewDirectory = @"" + baseDirectory + @"\" +

                            theEntry.Name;
                            if (!Directory.Exists(strNewDirectory))
                            {
                                Directory.CreateDirectory(strNewDirectory);
                            }
                        }
                    }
                    ZipStream.Close();
                }
            }
        }
        catch (Exception ex)
        {
            ret = false;
        }
        return ret;
    }  
    #endregion 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-07T17:23:12.730

我会推荐我们的[http://www.rebex.net/zip.net/](http://www.rebex.net/zip.net/)但我有偏见。[下载](http://www.rebex.net/zip.net/download.aspx)试用版并自己检查功能和示例。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-13T19:12:27.673

[SevenZipSharp](http://sevenzipsharp.codeplex.com/)是 7z.dll 和 LZMA SDK 的包装器，它是开源且免费的。

```
SevenZipCompressor compressor = new SevenZipCompressor(); 
compressor.CompressionLevel = CompressionLevel.Ultra;
compressor.CompressionMethod = CompressionMethod.Lzma;
compressor.CompressionMode = CompressionMode.Create;
compressor.CompressFiles(...); 
```

# model-view-controller - 在 MVC 中，1 个模型 1 个表或 1 个模型几个表？

> ID：1023484
> 
> 赞同：5
> 
> 时间：2009-06-21T09:07:08.433
> 
> 标签：model-view-controller

在 MVC 中，1 个模型 1 个表或 1 个模型几个表？

我正在构建一个包含 3 个表的应用程序。我不知道是应该为所有 3 个表创建一个模型还是为 3 个表创建 3 个模型。

如果我对 3 个表使用 3 个模型，如果我想加入这 3 个表，我应该把代码放在哪里？将代码放入 3 个模型中的任何一个？

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T09:49:06.430

通常，MVC 的“模型”部分应该被解释为“演示模型”或“视图模型”——即封装视图所需的所有数据和行为的类。这可能等同于也可能不等同于领域模型。

领域模型应设计为独立于 UI。这意味着此类模型不应被特定于 UI 的数据和行为污染 - 例如确定是否启用特定按钮。

您可能还希望在几个不同的视图中显示相同的域对象（例如主/详细信息或显示/编辑），如果这些视图差异很大，则为每个视图设置一个视图模型将是有益的。

所以，一般来说，你应该独立设计你的领域层和表示层。

在域层中，您可以选择将三个表建模为三个类。Fowler 的[企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)和 Evans 的[领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321125215)等书籍包含大量关于如何将关系数据建模为领域模型的指南。

在 MVC 中对视图进行建模时，为每个视图创建一个模型是最有意义的。这样的视图模型可能只是封装了一个领域对象，但它也可能封装和聚合了几个不同的领域对象。

通过这种方式，您可以确保关注点分离，并且您的类遵循单一职责原则。

对于非常简单的场景，将领域模型和表示模型合并到一层可能是有意义的，但您应该意识到这本质上意味着解决方案中没有领域模型——所有模型都是纯表示模型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T09:18:10.563

通常您将为每个表创建一个模型，因此在您的情况下，这意味着您需要 3 个模型。当我说“模型”时，我的意思是一个类，它将代表一个表中的一行（通常）。

例如： 表：

1.  产品
2.  订单
3.  顾客

在这种情况下，最简单的方法是创建 3 个不同的类（代表应用程序的数据模型），其中第一个类代表单个产品，下一个代表订单，最后一个类代表单个客户。

# php - 我的身份验证加密有用吗？

> ID：1023486
> 
> 赞同：2
> 
> 时间：2009-06-21T09:08:19.180
> 
> 标签：php, authentication, encryption, hash, salt

所以我一直在阅读很多关于 PHP 加密的内容。以至于我不确定究竟什么是安全存储登录信息的真正好方法。

但是，以下功能是我想出的：

```
function loginHash($username, $password){
    $salt = str_split($password,(strlen($password)/2)+1);
    $hash = hash('whirlpool', $username.$salt[0].'centerSalt'.$salt[1]);
    return $hash;
} 
```

我做对了吗？它用于验证与用户名组合的密码，以及将生成的哈希与存储在数据库中的哈希进行比较以验证登录的能力。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T09:17:47.397

我的建议是永远，永远，永远不要编写自己的加密和哈希函数。即使是专家也总是做错，所以不要自己尝试。

我听说[phpass (Openwall)](http://www.openwall.com/phpass/)是一个不错的散列框架，我建议你使用它。

他们在哈希中使用盐，并且有相当多的参数来调整哈希。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T10:05:18.190

加密！=散列。它们都被普遍认为属于密码学的范畴，但是当某些东西可以被加密时，它就可以被解密，而散列则不是这样。散列就是散列，仅此而已。

盐确实构造不正确。它应该是使用 fopen() 调用从 /dev/urandom 读取的 x 字节。例如，16 字节的盐是我个人使用的。这有效地防止了彩虹表攻击。

为了使事情更安全，也请使用密钥。例如：

```
$hashedPassword = hash_hmac('whirlpool',$password.$salt,$key); 
```

$key 只是随机数据。例如，您可以在文档根目录上方的隐藏文件夹中生成一个名为“key.bin”的 64 kB 文件，并在哈希处理之前使用 file_get_contents()。

为什么要使用密钥？如果您将哈希和盐存储在数据库中，并将密钥存储在文件系统中，那么这可以防止任何人在拿到您存储的哈希和盐时破解您的哈希。因此，攻击者需要同时破解数据库和文件系统来破解您的哈希值，但请注意，如果任何人已经破解了您的整个应用程序，那么破解您的哈希值将毫无意义，这意味着您的哈希方案是好的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-21T09:19:43.820

你实际上并没有使用盐。

Salt 是*随机*生成的字符串，包含在哈希函数的输入中。因此，每次都会有所不同。

这个想法是当用户存储密码时生成一个盐，并且这个盐包含在您的数据存储中。进行身份验证时，您检索盐和存储的哈希，在给定的密码前加上存储的盐，然后将两者散列在一起。然后将结果与存储的哈希进行比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T09:18:22.810

我认为上面的代码检查了这两个框。

*   避免彩虹表攻击（通过盐）
*   安全登录

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T11:02:20.183

使用盐解决了两个问题：

1.  **彩虹表：**彩虹表只是预先计算的哈希值，与源值一起存储。通过比较哈希值，您可以得到未经哈希处理的值（密码）。通过添加盐，你得到了另一层复杂性——攻击者必须知道盐才能生成自定义哈希表。

2.  **散列值的差异**：没有盐，相同的 2 个密码生成相同的 2 个散列。现在很容易看出两个用户是否使用相同的密码（这里的弱点与彩虹表大致相同，但仍然如此）。这可能不算多，但仍然是一个令人担忧的问题。

此外，您不应该使用快速算法进行密码散列。md5 快，sha 快。越慢越好。

matsano [chargen](http://www.matasano.com/log/)博客是一个很好的（有趣的）资源，提供有关安全性的提示和指针。

# c# - 尝试使用 LDAP 连接连接 AD 时出错

> ID：1023489
> 
> 赞同：10
> 
> 时间：2009-06-21T09:09:07.820
> 
> 标签：c#, active-directory, ldap

尝试使用此代码连接 AD

```
PrincipalContext context = new PrincipalContext(ContextType.Domain, domain) 
```

但我收到错误消息：

> LDAP 服务器不可用。

任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-21T12:53:11.393

问题是：您是否将我们的域指定为

*   “mydomain.com”（DNS 格式）
*   或“dc=mydomain,dc=com”（AD 样式格式）

令我惊讶的是，域名必须采用**DNS 格式**（例如“mydomain.com”）才能使其正常工作（而*不是*通常的 AD 样式格式“dc=mydomain,dc=com”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-20T11:03:09.547

我有同样的问题。

我的是因为网络服务器与用户不在同一个域中。

我通过忽略错误解决了它；然后这会强制进行身份验证挑战，使用户能够提供凭据，我可以从中获取正确的域。

# web-services - Web 服务：为泛型类型指定 XML 序列化元素名称

> ID：1023492
> 
> 赞同：1
> 
> 时间：2009-06-21T09:11:30.797
> 
> 标签：web-services, generics, xml-serialization

我创建了一个使用泛型类型的 Web 服务，`Response<TCode, TData>`所以我最终得到了像这样的元素

*   ResponseOfResponseCodeUserData
*   ResponseOfResponseCodeArrayOfRightData

等等

功能上工作得很好，但我想知道是否有办法命名这些特定元素？

**编辑：**

这是一个例子。

```
[return: XmlElement("AuthenticationResponse")]
[WebMethod]
public Response<ResponseCode, AuthenticationData> AuthenticateProcess(string ProcessName, string Password)
{
   // ... Code ...
} 
```

仍然返回

```
<ResponseOfResponseCodeAuthenticationData (...) > 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T16:03:29.300

如果您要显示一些代码可能会有所帮助。

不过，请查看 [XmlElementAttribute] 属性，它允许您指定元素名称。如果您的问题与返回值有关，那么您将需要使用

```
[return: XmlRoot("ReturnElementName")]
[WebMethod]
public int MyWebMethod() { ... } 
```

# jquery - 如何设置选项：在多选中选中

> ID：1023494
> 
> 赞同：3
> 
> 时间：2009-06-21T09:12:48.360
> 
> 标签：jquery, select, input, option

经过一番努力，我得到了以下代码来解决我的问题。但是，它仍然不会将 selected 添加到已选择的选项中。你可以在下面找到我原来的问题。改进了代码，但它仍然不起作用。

```
var $index = $('.drop').index(this)
// find drop index...
var $indexofmonth = $index + 1;
//alert($indexofmonth); // this works
var $indeximg = event.dragTarget.title;
var $indeximgnum = $indeximg.replace(/[a-zA-Z]/g,"");
//alert($indeximgnum); // this gives only number 1,2,3,4 etc. Use this in option:eq(2)
var $featurenumber = "Feature" + $indexofmonth;
//alert($featurenumber); //this works
var $eqnum = 'option:eq('+$indeximgnum + ')';
//alert($eqnum); //working

//and set up like this $('select[name=Feature1] option:eq(3)').attr('selected', 'selected' );
// find the drop select
$sel = $("select[name='"+ $featurenumber +"']");
//the above html() give an array
$('$sel $eqnum').attr('selected', 'selected' );
//alert ('$sel $eqnum'); //this does not work 
```

+++++++++++++++++++++++++++++++++

这是我原来的问题。

我有以下 HTML 和 jQuery。HTML 是 CMS 的输出。

[我使用了来自http://threedubmedia.com/demo/drop/](http://threedubmedia.com/demo/drop/)的拖放，因为它们总共有 6k。jQuery UI 核心本身就超过 100k。

我想将单个图像降到一个月。有 20 多张图片，当然还有 12 个月。为此，我使用了拖放。

我只使用了四张图片和四个月的时间来进行演示。

我整理了如何拖放部分。但是我被困住了如何创建一个函数，以便它从正确的月份中选择正确的图像。

例如，如果我在一月份放置一个海豚图像，我想在一月份选择海豚选择选项。

我认为这是我需要做的，但不是 100% 肯定。

总体：drop区域的title必须等于select的FeatureValue，例如januar就是FeatureValue1

第 1 步：找到删除区域/月的索引号 1,2,3 .. 并将其分配为 var monthindex

第 2 步：然后将 var index 添加到 FeatureValue var featurenumber

第 3 步：如果 tis 与 select 中的 FeatureValue(index number) 相同，请执行以下操作

第 4 步：找到丢弃图像的标题 var = droppedimg

步骤 5：添加 :selected 到一个选择选项值 if droppedimg = 删除的 img 的标题，dropimg

我感谢你的帮助。提前致谢。

## HTML

```
<div id="calendarimg">
<div id="status"></div>
<div id="calendartable">

<div id="jan" class="drop" Title="januar" >&nbsp;</div>
<div id="feb" class="drop" Title="febrar" >&nbsp;</div>
<div id="mar" class="drop" Title="mars" >&nbsp;</div>
<div id="apr" class="drop" Title="april">&nbsp;</div>
<div id="mai" class="drop" Title="mai">&nbsp;</div>
<div id="jun" class="drop" Title="juni">&nbsp;</div>
<div id="jul" class="drop" Title="juli">&nbsp;</div>
<div id="aug" class="drop" Title="august">&nbsp;</div>
<div id="sep" class="drop" Title="september">&nbsp;</div>
<div id="oct" class="drop" Title="october">&nbsp;</div>
<div id="nov" class="drop" Title="november">&nbsp;</div>
<div id="dec" class="drop" Title="december">&nbsp;</div>

</div>

<div id="nodrop">

<div class="drag" title="Angel" id="angel1"></div>
<div class="drag" title="Dolphin" id="dolphin2"></div>
<div class="drag" title="Fantail" id="fantail3"></div>
<div class="drag" title="Hawk" id="hawk4"></div>

</div>
<!-- End of printimgs --> 

</div>

<div id="featureright2">

<form method="post" action="http://www.mywebsite.com/shopaddtocart.asp">
<table cellspacing="1" cellpadding="2" border="0"><tr><td class="al">
<p class="al"><strong>januar</strong></p>
<select size="3" name="FeatureValue1">
    <option value="" selected="selected">velg</option>
    <option value="97">Angel</option>
    <option value="98">Dolphin</option>
    <option value="99">Fantail</option>
    <option value="89">Hawk</option>

</select>
<input type="hidden" name="Feature1" value="88">
<p class="al"><strong>februar</strong></p>
<select size="3" name="FeatureValue2">
    <option value="" selected="selected">velg</option>
    <option value="109">Angel</option>
    <option value="110">Dolphin</option>
    <option value="111">Fantail</option>
    <option value="101">Hawk</option>

</select>
<input type="hidden" name="Feature2" value="100">
<p class="al"><strong>mars</strong></p>
<select size="3" name="FeatureValue3">
    <option value="" selected="selected">velg</option>
    <option value="112">Angel</option>
    <option value="121">Dolphin</option>
    <option value="122">Fantail</option>
    <option value="123">Hawk</option>

</select>
<input type="hidden" name="Feature3" value="120">
<p class="al"><strong>april</strong></p>
<select size="3" name="FeatureValue4">
    <option value="" selected="selected">velg</option>
    <option value="124">Angel</option>
    <option value="133">Dolphin</option>
    <option value="134">Fantail</option>
    <option value="135">Hawk</option>

</select>
<input type="hidden" name="Feature4" value="132">

</td></tr><tr><td class="ac">

<input class="txtfield" type="text" size="2" maxlength="3" name="quantity" value="1" />
</td><td class="ac vm"><input class="imgbtn" src="images/vpnav_buy_norw.gif" type="image"></td></tr>
<input type="hidden" name="productid" value="81" />
</table></form>
</div> 
```

* * *

## jQuery

```
$(".drag")
    .bind( "dragstart", function( event ){
            // ref the "dragged" element, make a copy
            var $drag = $( this ), $proxy = $drag.clone();
            // modify the "dragged" source element
            $drag.addClass("outline");
            // insert and return the "proxy" element                
            return $proxy.appendTo( document.body ).addClass("ghost");
            })
    .bind( "drag", function( event ){
            // update the "proxy" element position
            $( event.dragProxy ).css({
                    left: event.offsetX,
                    top: event.offsetY
                    });
            })
    .bind( "dragend", function( event ){
            // remove the "proxy" element
            $( event.dragProxy ).fadeOut( "normal", function(){
                    $( this ).remove();
                    });
            // if there is no drop AND the target was previously dropped
            if ( !event.dropTarget && $(this).parent().is(".drop") ){
                    // output details of the action
                    $('#status').empty().append('<div>Removed <b>'+ this.title +'</b> from <b>'+ this.parentNode.title +'</b></div>');
                    // put it in it's original div...
                    $('#nodrop').append( this );
                    }
            // restore to a normal state
            $( this ).removeClass("outline");      

            });
$(".drop")
    .bind( "dropstart", function( event ){
            // don't drop in itself
            if ( this == event.dragTarget.parentNode ) return false;
            // activate the "drop" target element
            $( this ).addClass("active");
            })
    .bind( "drop", function( event ){
            // if there was a drop, move some data...
            $( this ).append( event.dragTarget );
            // output details of the action...
            $('#status').empty().append('<div>Dropped <b>'+ event.dragTarget.title +'</b> into <b>'+ this.title +'</b></div>');             

            })
    .bind( "dropend", function( event ){
            // deactivate the "drop" target element
            $( this ).removeClass("active");
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T02:45:50.947

这应该这样做：

你的滴...

```
.bind( "dropend", function( event ){
  // deactivate the "drop" target element
  $( this ).removeClass("active");

  // added here:
  $("select[name='FeatureValue" + ($.inArray(this, $('#calendartable').children() )+1) + " Multiple']").children('option').each(function(){ if ( $(this).html() === $(event.dragTarget).attr('title') ) $(this).attr('selected', 'selected') });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-14T07:59:31.437

我认为您的问题归结为您的最终选择器。 `'$sel $eqNum'`不是有效的 jQuery 选择器。JavaScript 不会在字符串中进行变量替换。此外，`$`对所有变量名的使用会变得非常混乱。我尝试仅`$`用于作为 jQuery 对象的变量。稍微重写你的变量声明以反映这一点。在代码块的底部附近，您实际上为您的 select ( `$sel`) 检索了一个 jQuery 对象，您可以使用该[`.find()`](http://docs.jquery.com/Traversing/find)对象上的方法来查找基于`eqnum`.

```
var index = $('.drop').index(this);
var indexofmonth = index + 1;

var indeximg = event.dragTarget.title;
var indeximgnum = indeximg.replace(/[a-zA-Z]/g,"");

var featurenumber = "Feature" + indexofmonth;
var eqnum = 'option:eq('+indeximgnum+')';

// find the drop select
var $sel = $("select[name="+featurenumber+"]");

// find the option using eqnum from before
$sel.find(eqnum).attr('selected', 'selected' );

// or do it all in one brush stroke:
$('select[name='+featurenumber+'] option:eq('+indeximgnum+')').attr('selected','selected'); 
```

该`$`函数从选择器字符串返回一个 jQuery 对象，您正在传递`'$sel $eqNum'`

# linux-kernel - kvm vs. vmware 用于内核调试/USB驱动开发

> ID：1023498
> 
> 赞同：1
> 
> 时间：2009-06-21T09:14:35.110
> 
> 标签：linux-kernel, vmware, linux-device-driver, kvm

我目前正在设置 vmware Server 2.0 以使用 gdb 进行内核调试（[请参阅此设置指南](http://stackframe.blogspot.com/2007/04/debugging-linux-kernels-with.html)），有人问我为什么不使用 kvm？

所以我问：内核调试/USB驱动开发的kvm vs. vmware

**各自的优缺点是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T09:34:27.910

驱动开发？您是否正在为特定硬件开发驱动程序？如果是这样，那么您可能无法使用虚拟化，因为虚拟化实例将无法访问新硬件。

为此，您将需要两台机器，一台在另一台上运行远程调试器。

***编辑：***显然您正在为 USB 设备开发驱动程序？这是一个特别是虚拟机实际上可以提供帮助的领域。如今，大多数虚拟机都能够将特定的 USB 设备委托给来宾操作系统。

也就是说，与远程调试器选项相比，这种情况并没有真正提供任何好处，因为您仍然需要一种方法来检查正在运行或崩溃的操作系统的状态，而虚拟机在这方面提供的帮助很少。您可能能够重播崩溃前保存的状态。

您可能能够使用 UML 获得一些牵引力，这将允许您像在常规用户进程上一样进行本地调试，这样麻烦会少一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T10:11:49.037

我最近开始构建 GNU Mach/HURD，发现 QEmu/KVM 的组合工作得非常好......原因如下：

1.  QEmu 呈现出相当干净的环境
2.  网络有很多选择
3.  我可以使用原始设备文件/环回轻松**挂载文件系统**

底线是，对于内核工作，我只希望启动最少的功能并查看结果。VMWare 更多的是用于可用的虚拟化而不是肮脏的。

但是，**无法与在****具有真实硬件**的真实机器上启动相比。VM 环境有时看起来像是一个安全毯……因为即使是我的烤面包机也会知道 Realtek RTL8139C 是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T10:47:11.103

如果它是一个“真正的硬件”设备，当然，vmware 不会模拟它，所以你将无法调试它下的驱动程序（任何其他虚拟化软件也不能，除非你扩展一个来这样做）。

设备驱动程序调试可以在一定程度上使用具有普通内核的真实硬件机器来完成——尽管显然有些事情你不能做——比如设置断点。

仍然可以将调试器附加到内核并检查内容。此外，传统的 printf() 调试是完全可行的（printk，anyone），并且内核中的各种特性使调试更容易。可以使用各种调试选项构建内核，以尝试检测指针问题、内存泄漏等。

默认情况下，当内核遇到 OOPS 或 BUG 情况时，它甚至会在日志上提供漂亮的堆栈跟踪（显然，如果系统挂起或崩溃，这不一定会写入任何地方）。当然，中断内发生的指针超出范围的情况是灾难的根源，但是您仍然可以在恐慌之前立即在屏幕上获得堆栈跟踪:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T09:27:47.190

我将添加另一个选项，而不是直接回答问题...根据所讨论的内核是否是 Linux 内核，以及您正在处理它的哪个部分，您可能会发现 UserModeLinux（包含在 2.6 .x 源，并作为 2.4 和 2.2 的补丁集提供）可能胜过这两个选项。

由于它将内核作为主机内核下的用户态进程运行，因此更容易附加常用的调试工具。我相信它在文件系统相关代码的更新/添加的早期阶段非常常用。如果您正在开发/调试直接与硬件交互的模块，那么它对您的使用可能要少得多。

参考链接：[首页](http://user-mode-linux.sourceforge.net/)、 [其他](http://en.wikipedia.org/wiki/User-mode_Linux)

# c# - 将两个日期时间值与 c# 比较表中的一个，另一个是当前的

> ID：1023501
> 
> 赞同：-1
> 
> 时间：2009-06-21T09:16:48.197
> 
> 标签：c#

```
da = new SqlDataAdapter("SELECT ExitTime,EnterTime,name,[tag-id-st],[build-id],[room-no],tagType FROM Students,GateLogging WHERE GateLogging.tagType='student'", MyConn);
DateTime ss=dt.Rows[0][1];       
DateTime date = DateTime.Now;
int x=date.CompareTo(ss); 
```

这是我的代码，我停在这里，我无法完成

请帮助我将“EnterTime”表中的值与当前时间进行比较，并在 gridview 中显示超过当前时间 10 分钟的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T09:53:58.980

首先，找到你真正关心的日期——例如它可能是

```
DateTime cutoff = DateTime.Now.AddMinutes(10); 
```

（在顶部执行一次，而不是每行） - 然后与那些进行比较，例如：

```
bool isOverdue = ss > cutoff; 
```

您也可以在数据库中使用`GETDATE()`and`DATEADD(...)`或`DATEDIFF(...)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T09:54:10.383

首先，您可以将选择查询更改为仅返回最后 10 分钟的行，并且您不需要比较，其次您可以使用 da.Fill(dt) 将结果集复制到数据表并使用 dt.Select(". ..") 只过滤你的行，第三个是什么问题？你可以写

```
DateTime now = DateTime.Now;
if (now - ss <= TimeSpan.FromMinutes(10))
{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-19T06:03:00.663

在单元测试中遇到同样的问题，我编写了一个 AssertEx 类，其中包含一些不太挑剔的断言：

```
public static void AreSimilar(DateTime expected, DateTime actual, TimeSpan tolerance, string message)
{
    DateTime expectedMin = expected.Subtract(tolerance);
    DateTime expectedMax = expected.Add(tolerance);

    if (actual < expectedMin || actual > expectedMax)
    {
        throw new AssertFailedException(message);
    }
} 
```

# android - 你将如何改进 Dalvik？Android的虚拟机

> ID：1023502
> 
> 赞同：17
> 
> 时间：2009-06-21T09:17:17.460
> 
> 标签：android, jit, dalvik, vm-implementation

我目前正在写一篇关于Android平台的论文。经过一番[研究](http://code.google.com/p/android-benchmarks/)，很明显Dalvik还有改进的空间。我想知道，您认为将开发人员的时间用于实现这一目标的最佳方式是什么？

JIT 编译似乎是一个大问题，但我也听说这在如此低资源的机器上使用有限。有没有人有资源或数据支持这一点？

是否还有其他选择需要考虑？除了开发一个强大的原生开发工具包来绕过虚拟机。

对于那些感兴趣的人，有一个关于[Dalvik VM](http://sites.google.com/site/io/dalvik-vm-internals)的讲座已经录制并在线发布。

欢迎任何想法，因为这个问题*看起来很主观*，我会澄清我将接受的答案必须有一些对提议的更改的理由。任何支持它的数据，例如 Sun JVM 在引入时的改进，都将是一个巨大的优势。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-21T17:39:18.343

1.  更好的垃​​圾收集：至少压缩（以消除今天遇到的内存碎片问题），理想情况下在收集本身时减少 CPU 密集度（以减少“我的游戏帧速率糟糕”的抱怨）
2.  JIT，正如你所引用的
3.  足够多的文档，当与 NDK 结合使用时，足够疯狂的人可以将 Dalvik 字节码编译为本机代码以用于 AOT 编译选项
4.  使其与 Android 本身分离，以便其他项目可以对其进行试验，并且社区贡献可能会以更多的速度和更快的速度到达

我敢肯定，如果您需要，我可以提出其他想法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-24T19:14:55.943

1.  即时通讯。关于它没有帮助的东西是一堆废话。您可能对 JIT 的代码更具选择性，但只有本地代码性能的 1/10 总是会受到限制

2.  体面的GC。现代世代垃圾收集器没有大口吃。

3.  更好的代码分析。在很多情况下，不需要进行分配/释放、持有锁等等。它允许您编写干净的代码，而不是进行机器更擅长的优化

理论上，大多数高级语言（Java、Javascript、python...）在大多数情况下应该在本机代码性能的 20% 以内。但这需要平台供应商花费 100 多个开发人员年。Sun Java 越来越好。他们也已经为此工作了 10 年。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T09:24:06.217

Dalvik 的主要问题之一是性能，我听说这很糟糕，但我最想要的一件事是添加更多语言。

JVM 已经有社区项目让 Python 和 Ruby 在平台上运行，甚至为它开发了 Scala、Groovy 和 Closure 等特殊语言。很高兴在 Dalvik 平台上看到这些（和/或其他）。Sun 也一直在研究 Da Vinci 机器，这是 JVM 的动态类型扩展，这表明 Sun 在过去 15 年中一直遵循的“一种语言适合所有人”的理念发生了重大转变。

# c++ - 多个接口继承。从一个铸造到另一个

> ID：1023511
> 
> 赞同：3
> 
> 时间：2009-06-21T09:21:06.267
> 
> 标签：c++

考虑以下一组类/接口：

```
class IFish{
public:
virtual void eat() = 0;
}

class IFriendly{
public:
virtual void protect() = 0;
}

class IAggresive{
public:
virtual void attack(Point inDest) = 0;
}

class CDolphin : public IFish, IFriendly{
eat...
protect....
}

class CShark : public IFish, IAggresive{
eat....
attack...
} 
```

现在我有以下课程

```
void CDiver
{

Void shouldRunAway(IFish* fish)
{
//???
}

} 
```

我的问题是，“shouldRunAway”是否可以从 fish 论点中提取，无论它是 IAggresive 还是 IFreindly（如果它是其中任何一个......）是否有某种类型的演员可以提供帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T09:52:54.737

扩展 Drakosha 发布的内容，您可以将 IFish 指针动态转换为 IAggressive 指针并检查它是否为 NULL。像这样;

```
#include <iostream>

class IFish {
public:
    virtual void eat() = 0;
};

class IFriendly {
public:
    virtual void protect() = 0;
};

class IAggressive {
public:
    virtual void attack() = 0;
};

class Dolphin : public IFish, public IFriendly {
public:
    virtual void eat() {
        std::cout << "Dolphin::eat()\n";
    }

    virtual void protect() {
        std::cout << "Dolphin::protect()\n";
    }
};

class Shark : public IFish, public IAggressive {
public:
    virtual void eat() {
        std::cout << "Shark::eat()\n";
    }

    virtual void attack() {
        std::cout << "Shark::attack()\n";
    }
};

class Diver {
public:
    void shouldRunAway( IFish *fish ) {
        if ( dynamic_cast<IAggressive *>( fish ) != NULL ) {
            std::cout << "Run away!\n";
        } else {
            std::cout << "Don't run away.\n";
        }
    }
};

int main( int argc, char *argv[] ) {
    Dolphin dolphin;
    Shark shark;
    Diver diver;

    diver.shouldRunAway( &dolphin );
    diver.shouldRunAway( &shark );

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T09:26:28.317

看看[dynamic_cast](http://en.wikipedia.org/wiki/Dynamic_cast)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-19T05:34:55.223

如果您不关心 dynamic_cast，您可以使用访问者模式

```
#include <iostream>

class Diver;

class IFish {
public:
    virtual void eat() = 0;
    virtual void visit(Diver*) = 0;
};

class IFriendly {
public:
    virtual void protect() = 0;
};

class IAggressive {
public:
    virtual void attack() = 0;
};

class Diver {
public:
    void shouldRunAway( IFish *fish ) {
        fish->visit(this);
    }

    void runAway()
    {
        std::cout << "Run away!\n";
    }

    void dontRunAway()
    {
        std::cout << "Don't run away!\n";
    }
};

class Dolphin : public IFish, public IFriendly {
public:
    virtual void eat() {
        std::cout << "Dolphin::eat()\n";
    }

    virtual void protect() {
        std::cout << "Dolphin::protect()\n";
    }

    virtual void visit(Diver* diver)
    {
        diver->dontRunAway();
    }
};

class Shark : public IFish, public IAggressive {
public:
    virtual void eat() {
        std::cout << "Shark::eat()\n";
    }

    virtual void attack() {
        std::cout << "Shark::attack()\n";
    }

    virtual void visit(Diver* diver)
    {
        diver->runAway();
    }
};

int main( int argc, char *argv[] ) {
    Dolphin dolphin;
    Shark shark;
    Diver diver;

    diver.shouldRunAway( &dolphin );
    diver.shouldRunAway( &shark );

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T09:33:25.557

接口定义了一个类*做*什么，而不是*它是什么*。您不应将它们用作“是”关系。在您的情况下，最好在 IFish 接口中定义 IsDangerous() 方法。

在这种情况下，在 C++ 中可以进行强制转换，但这将是糟糕的设计。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-21T09:47:40.833

如果这是 Java，你可以这样做：

```
if( fish instanceof IAggressive )
    runAway(); 
```

也许有一些 C++ 等价物？我听说过很多关于 RTTI 的信息。这有帮助吗？

jrh

# javascript - 将 div 定位在居中 div 的右侧？

> ID：1023514
> 
> 赞同：1
> 
> 时间：2009-06-21T09:23:25.657
> 
> 标签：css, javascript, css, html

我有一个`<div>`位于页面中心的 div，但现在我需要在中心框的右侧添加一个 div，我相信您可以使用[css](/questions/tagged/css "显示标记为“css”的问题")执行此操作，但想不出解决方案。

所以例如

```
div#container {
    margin-left: auto;
    margin-right: auto;
    width: 396px;
    display:block;
    margin-top: 110px;
} 
```

我需要的 div 会和那个一样吗？但是用 +396px 来清除已经存在的 div？这可能吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T11:39:09.127

将右侧的 div 浮动到右侧。确保它在您的 html 之前的`div#container`.

```
div#container {
    margin:100px auto 0;
    width: 396px;
    height:396px;
    margin-top: 110px;
    background-color:#ccc;
}
div#right {
    float:right;
    width:200px;
    height:200px;
    background-color:#c6c;
}

<div id="right"></div>
<div id="container"></div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T09:30:10.463

定位`#container`相对，`#inner`绝对。

```
div#container {
    margin-left: auto;
    margin-right: auto;
    width: 396px;
    display: block;
    margin-top: 110px;
    position: relative;
}

div#inner {
    position: absolute;
    right: 0px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T09:29:37.217

您正在寻找 float css 属性。

[http://www.w3schools.com/css/pr_class_float.asp](http://www.w3schools.com/css/pr_class_float.asp)

例如

```
<div>
  <div style="float:left"> Lorem Ipsum</div>
</div> 
```

# c - 参数检查与函数调用开销

> ID：1023519
> 
> 赞同：2
> 
> 时间：2009-06-21T09:27:44.103
> 
> 标签：c, validation, parameters, function

我有一个公共函数需要检查几个参数的有效性，但是这个函数也在我知道给定参数有效的其他几个地方内部使用。因此，我想知道哪个成本更高：1）在每个公共函数中保留有效性检查，或 2）在公共函数中进行有效性检查，但创建不进行检查的私有/内部函数（使用公共函数作为内部函数的包装器）。

函数调用的开销是否超过了不必执行冗余检查的好处？

基本上，我当前的代码将遵循以下几行：

```
boolean foo(int* a, int* b, int* c)
{
   if (!a || !b || !c) {
       return FALSE;
   }
   <do the whatever foo does here>
}

boolean bar(int* a, int* b, int* c)
{
    if (!a || !b || !c) {
        return FALSE;
    }
    <do the whatever bar does here>
    foo(a, b, c);
 } 
```

因此， bar() 对 a、b 和 c 进行检查，因为它是公开/公共函数，但随后 foo 重复相同的检查。允许这种情况发生会更有效吗？或按照以下方式创建内部函数：

```
static boolean foo_internal(int* a, int* b, int* c)
{
    <do the whatever foo does here>
}

boolean foo(int* a, int* b, int* c)
{
   if (!a || !b || !c) {
       return FALSE;
   }
   foo_internal();
}

boolean bar(int* a, int* b, int* c)
{
    if (!a || !b || !c) {
        return FALSE;
    }
    <do the whatever bar does here>
    foo_internal(a, b, c);
 } 
```

我主要关心 C 代码的效率，但针对其他语言的一般答案/答案也很有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T13:40:37.743

I usually advise using a lot of ASSERTS.I.e. in the debug mode you can check everything more is better.
Error handling in the release mode i will do only when i really can find a problem. For example i would not check buffer pointers for NULL in release mode (Null is a very small example of invalid pointer), but i would check for size of buffer if my buffer is limited.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T09:38:05.267

在性能方面，除非有可测量的数据表明使用分析存在性能问题，否则重点应该放在可读和可维护的代码上。

在这种情况下，除非参数检查*真的很*昂贵，否则我认为它就可以了。`foo`代码显示其意图是在执行and`bar`函数之前应该进行参数检查。

如果`foo`和`bar`是预期会被自己调用的独立函数，那么多次运行检查可能不是什么大问题。当然，如果参数检查成本太高，并且通过分析表明检查确实花费了很大一部分时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T09:35:45.287

如果检查如您所描述，我不会做任何事情，直到您真正看到这是一个性能问题。此检查可能会在纳秒内完成，如果不是 pico...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T09:38:26.780

如果你真的很在意速度，你总是可以让 public 函数内联。但我真的会检查这确实是一个问题。函数调用在 C 中非常快，除非您在紧密循环中调用函数，否则这不太可能成为问题。

这与像 python 这样的语言非常不同，其中函数调用非常昂贵（至少在 cPython 上）——在这种情况下，如果速度是一个问题，你应该在考虑到这一点的情况下提前考虑你的 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T09:55:16.527

每个函数调用都有以下开销：存储寄存器，将参数放入堆栈，每当它有结果返回时，它也应该被复制到返回寄存器，我可能忘记了更多细节。因此，您需要考虑拆分函数，因为您只想在参数检查非常、非常、非常昂贵的情况下避免双重参数检查。在 C 中工作时，您可以考虑使用宏来提高可读性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T10:07:23.303

将参数检查保留在 foo() 中并感到高兴。在调用它之前删除所有多余的检查。当你完成了这些，你会更高兴重构你的代码:)

# windows - 在 Vista 上创建异步可插拔协议时出现问题

> ID：1023526
> 
> 赞同：0
> 
> 时间：2009-06-21T09:31:27.497
> 
> 标签：windows, protocols, network-protocols

我创建了一个用于创建 dzone 协议的教程（例如，我可以在 firefox 中键入 dzone:n 以获取新链接），它工作得很好，但最后我想创建一个新的别名协议 dn 指向同一个处理程序，Vista 不想采用这条新路径，尽管注册表项是好的（我通过将 dn 重命名为 dzone 来检查）。

请参阅此处的教程： **[ [http://reboltutorial.com/blog/dzone-protocol/]](http://reboltutorial.com/blog/dzone-protocol/])**

仅在 Vista 上的 Windows XP 中不会出现此问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T00:55:50.120

好的，最后我在 Internet Explorer 中测试它可以工作，它也可以在以前版本的 Firefox 上工作，所以它似乎是一个 Firefox 3.0.11 错误。

# asp.net - 跨页面发布是否可以有多个目标页面？

> ID：1023529
> 
> 赞同：2
> 
> 时间：2009-06-21T09:35:19.733
> 
> 标签：asp.net, navigation, cross-page-posting

我有一个使用跨页发布来发布到不同目标页面的网页。

出现了一项新要求，这意味着根据在客户端上输入的数据，也可以发布 4 个不同的目标页面。

是否可以在客户端上以某种方式动态更改跨页发布目标？

通过查看源 html，我想可以使用 jquery 来操作提交按钮上的回发目标，但这似乎有点 hack。

我有什么选择，重写页面以删除跨页面发布并在会话中传递数据进行响应重定向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T14:32:37.857

是的，您当然可以更改`action`表单的。我将引导您完成操作。

首先，您的表单必须具有在 HTML 中指定的名称和操作 URL：

```
<form name="aformiam" method="post" action="/somewhere/to/go.php"> 
```

接下来，您将要在表单提交时运行一些 JavaScript，因此您应该将提交按钮的 onClick 属性设置为一个函数，如下所示：

```
<input type="submit" value="Send Form" onClick="return submitForm();" /> 
```

最后是您的 JavaScript 函数，用于实际更改表单操作并提交表单。

```
function submitForm() {
  // do anything here you need to determine which URL to post to
  // I am just making an example here
  var targetURL = '/some/url/to/post.php';

  // now we will change the form's action
  document.aformiam.action = targetURL;

  // finally, submit the form by returning true
  return true;
} 
```

请注意，在我们返回 true 的最后一步中，这会提交表单，因为输入元素的类型是`submit`，并且函数是由`onClick`事件触发的。例如，如果这是一个`button`类型输入元素或一个`a`标签，`img`那么我们需要使用以下内容触发表单提交：

```
document.aformiam.submit(); 
```

此解决方案将用于更改操作并提交到*单个*URL。如果您需要一次发布到多个 URL，则必须使用其他方法，例如 XMLHttpRequest。如果是这种情况，请发表评论表明这一点，我将为此提供一个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T11:26:30.883

`action`您可以尝试在表单提交之前使用 JavaScript更改表单的属性。

不幸的是，大多数浏览器不支持 POST 重定向。甚至[RFC 注释](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.3)：

> RFC 1945 和 RFC 2068 指定不允许客户端更改重定向请求的方法。然而，大多数现有的用户代理实现将 302 视为 303 响应，无论原始请求方法如何，都对 Location 字段值执行 GET。状态码 303 和 307 已被添加用于希望明确明确期望客户端做出何种反应的服务器。

因此，恕我直言，选择仅限于 JavaScript`action`修改或从您的服务器重新发布数据（您的服务器接受发布的数据，对其进行分析并自行执行 POST）。

将数据存储在会话中（或仅在 POST 上返回）然后从客户端重新发布它需要 JavaScript 支持（自动提交表单）或让用户再次单击“提交”按钮。不过，您可以考虑使用此方法作为备用方法。

将默认`action`点指向您的后备脚本。如果您在提交前成功修改`action`- 此时一切正常。如果某些事情失败了，比如 JavaScript 被禁用 - 使您的后备脚本输出页面带有隐藏的数据字段（因此不应再修改）和可见的提交按钮，将数据发布到适当的位置。

# html - HTML 中的用户身份验证，无需 PHP、ASP 或 JSP

> ID：1023535
> 
> 赞同：1
> 
> 时间：2009-06-21T09:37:32.273
> 
> 标签：html

我可以使用 HTML、VBScript 或 JavaScript 自动创建用户帐户吗？通过“帐户”，我的意思是能够将页面的访问权限仅限于授权用户。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T09:42:38.597

[带有 .htaccess 文件的HTTP 基本身份验证](http://en.wikipedia.org/wiki/Basic_access_authentication)可能就是您所追求的。

[http://httpd.apache.org/docs/1.3/howto/auth.html](http://httpd.apache.org/docs/1.3/howto/auth.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T09:52:08.547

HTML 是一种声明性语言，除了描述给定页面在解释时的外观外，什么都不做。Javascript 可以为您提供一个简单的登录解决方案，但它主要是经过验证的客户端，因此并不安全。

因此，要限制某些用户访问某些页面，“最简单”的解决方案*可能*是使用 CMS 系统或脚本语言。网上有很多很棒的教程可用于创建简单的登录系统。这些建议显然需要您的 Web 服务器支持脚本语言，可能是您选择的数据库。

一个选择可能是 PHP 语言和 MySQL 数据库。广泛使用和有据可查。我发现[这个指南](http://www.phpeasystep.com/phptu/6.html)看起来相当简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T10:28:29.470

当然，只需使用 javascript 检查是否设置了 cookie，然后使用 javascript 链接到页面中的“安全”区域。我说“安全”是因为它只会阻止普通浏览器到达那里。任何知道您的隐藏链接的人都可以在没有 cookie 的情况下前往那里。设置 robots.txt 文件以防止搜索引擎索引“安全”区域。这可能就是您所需要的。事实上，如果没有后端语言，除了 .htaccess 之外，它是您唯一真正的选择，但是如果您能处理好它，您可能也可以学习一些 PHP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T09:50:37.143

HTML 不允许您限制访问。如果您在 Windows 上，您可以使用 NT 身份验证来保护文件或文件夹。然后，当用户请求该文件或文件夹时，系统将提示他们输入用户名和密码。但这需要更改 IIS 并将帐户添加到 Active Directory（或至少添加到本地计算机）。

# c# - 如何使用asp.net C#计算文件上传和下载时间

> ID：1023543
> 
> 赞同：1
> 
> 时间：2009-06-21T09:43:06.067
> 
> 标签：c#, asp.net, javascript

我有一个场景需要根据连接速度计算上传文件的服务器时间。

**例子：**

> 需要计算连接速度为 256Kbps 及以上的文件上传时间 如果连接中断，则检查剩余时间并在中断处重新启动下载或上传操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T10:16:32.710

256 Kbps = 32 KB/秒 = 32768 字节/秒。

您的文件大小为 x 字节。所以需要 (x / 32768) 秒。

如果连接断开，您应该查询接收器接收到的最后一个字节是什么，将您的文件流放到该位置并继续。

# javascript - 如何使用 XML 将 HTMLCollection 对象转换为字符串？

> ID：1023551
> 
> 赞同：1
> 
> 时间：2009-06-21T09:50:45.927
> 
> 标签：javascript, jquery, xml, string

在输出字符串中获取 HTMLCollection 对象的完整字符串表示形式的最佳方法是什么，`javascript/jquery?`应该具有 XML 语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T10:12:44.090

```
$('<div/>').append(HTMLCollection).html(); // Retrieves the `outerHTML` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T20:27:59.087

我的猜测是在尝试 div 技巧之前先克隆节点：

```
$('<div/>').append($(HTMLCollection).clone()).html(); 
```

如果不进行克隆，将集合元素重新分配给新创建的 div 将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-03T03:52:03.263

考虑到 jQuery [.html()](http://api.jquery.com/html/)和 .outerHTML() 返回一组元素中的第一个匹配元素，您可以使用 https://github.com/darlesson/jquery-outerhtml 中的 .outerHTML(function(index, outerHTML) [)](https://github.com/darlesson/jquery-outerhtml)来做就像是：

考虑以下 HTML：

```
<span>One</span>
<span>Two</span>
<span>Three</span> 
```

考虑这个调用：

```
var allHTML = "";

$("span").outerHTML(function(index, outerHTML){
    allHTML = allHTML + outerHTML;
}); 
```

allHTML 变量等于“<span>One</span><span>Two</span><span>Three</span>”。

# asp.net - Asp.net 缓存和 w3p 内存使用

> ID：1023562
> 
> 赞同：0
> 
> 时间：2009-06-21T09:56:33.920
> 
> 标签：asp.net, caching

将图像存储在数据库中的 Web 应用程序。

在我们的第一个设置中，我们从在 asp.net 缓存中调整大小的数据库中存储（和提供）图像。这一切都很好，但是随着 web 开始获得越来越多的点击，我们开始遇到奇怪的问题，而且奇怪，我的意思是奇怪的 - 从没有任何细节的 w3p 崩溃到每天在各处发生几次的随​​机 OutOfMemoryExceptions。

我怀疑asp.net缓存可能被我们这里误用了，所以我重写了图像缓存到文件系统。我们的图像处理程序现在检查缓存目录中调整大小的图像，如果不存在这样的图像，则从数据库中获取它并将其保存在缓存目录中，并从那里提供它。

困扰我的是这个网站的 w3p 内存使用情况。之前，当我们使用 asp.net 缓存对象时，w3p 的典型内存使用量约为 600mb。现在，当处理程序从文件系统提供图像时，典型的内存使用量约为 750mb。不知何故，我预计它会下降（至少有一点），但绝对不会上升。对此有什么解释吗？

其次，有没有办法检查 w3p 进程以查看有多少内存用于什么用途？想到的一件事是性能计数器，但还没有时间检查它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T10:02:12.190

这只是我的猜测，但如果文件 I/O 被缓冲，那不会占用大量内存吗？可能比 ASP 缓存更重要，因为提供的每个文件都需要一个缓冲区，而不是从缓存中获取共享资源。

至于内存分析，有许多分析器程序，您可以使用它们来分析正在发生的事情。

*   [.NET 内存分析器](http://memprofiler.com/ ".NET 内存分析器")
*   [点追踪](http://www.jetbrains.com/profiler/features/)
*   [ANTS 性能分析器](http://www.red-gate.com/products/ants_performance_profiler/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T10:26:12.597

你确定你已经为这些项目禁用了 OutputCache 吗？看起来你仍然执行动态代码来确定是否在必要时创建调整大小的图像，所以仍然可能有一个活动的 OutputCache

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T10:49:10.850

缓存中的许多图像导致它不断增长。当进程拥有 60% 的可用内存时，asp.net 的默认行为是重新启动。

当一个进程将被回收并且第二个将被创建但第一个进程很长时间没有完成时，可以抛出 OutOfMemoryException。然后你有 2 个进程占用大量内存。如果应用程序很忙并且有很多请求，那么一次可能会超过 2 个进程。这会导致 OutOfMemoryException。

> 我重写了图像缓存以转到文件系统。我们的图像处理程序现在检查缓存目录中调整大小的图像，如果不存在这样的图像，则从数据库中获取它并将其保存在缓存目录中，并从那里提供它。

这是最好的解决方案。FileSystem 在操作系统级别缓存。

# search - 爬虫实例

> ID：1023563
> 
> 赞同：0
> 
> 时间：2009-06-21T09:57:41.577
> 
> 标签：search, web-crawler

我正在构建一个大型网络爬虫，当在位于互联网服务器场中的专用网络服务器上运行网络时，爬取网络时有多少实例是最佳的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T10:06:13.040

`spare_memory_on_machine / memory_footprint_of_crawler_process * 0.95`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-19T14:17:12.823

要制作大型爬虫，您将不得不处理一些问题，例如：

• 不可能将所有信息保存在一个数据库中。

• 没有足够的 RAM 来处理巨大的索引

• 多线程性能和并发性

• 爬虫陷阱（通过更改 url、日历、会话 ID... 创建无限循环）和重复内容。

• 从多台计算机上爬网

• 格式错误的 HTML 代码

• 来自服务器的持续 http 错误

• 没有压缩的数据库，这使您对空间的需求增加了大约 8 倍。

• 重新制定例行程序和优先事项。

• 使用压缩请求（Deflate/gzip）（适用于任何类型的爬虫）。

还有一些重要的事情

• 尊重 robots.txt

• 每次请求都会有爬虫延迟，以免让网络服务器窒息。

最佳线程配置将取决于您的代码。我正在使用 .net 运行 100 个进程。我建议您使用调度类来避免不必要的打开线程。

PS。如果您使用 5 个线程，您将需要数年时间才能达到“大规模”网络抓取。

# visual-studio-2008 - 将代码插入多个文件？从多个文件中删除？

> ID：1023567
> 
> 赞同：1
> 
> 时间：2009-06-21T10:00:23.553
> 
> 标签：visual-studio-2008

我有一些代码要插入到几个类中，但我不想手动执行，有没有办法在 Visual Studio 2008 中自动执行此操作？

你能以类似的方式从多个文件中删除代码吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T10:06:16.270

Visual Studio 有一个宏功能，您可能想看看。

虽然我不知道您的具体情况是什么，但如果出现这样的要求，我总是会有点担心，因为这听起来像是代码重复。

另一方面，如果您想这样做是因为您希望提供某些模板，Visual Studio 也具有此功能。您可以创建新的文件模板或编辑现有的文件模板。

但是，使用模板，您无法删除代码，因此在这种情况下，您将不得不求助于编写（或录制）宏。

# jquery - jQuery 模拟

> ID：1023569
> 
> 赞同：13
> 
> 时间：2009-06-21T10:03:15.560
> 
> 标签：jquery, unit-testing, mocking

我正在寻找一个可以进行 Javascript 模拟的**成熟框架，尤其是在 AJAX 和 JSON 领域。**

是否有任何现有的 Javascript（和/或 JQuery）模拟框架可供**您使用并且可以推荐**？

**编辑：我已经评估[了 jqmock](http://code.google.com/p/jqmock/)和[jqunit](http://code.google.com/p/jqunit/)。它似乎是唯一可以进行[基本库模拟和存根](http://itscommonsensestupid.blogspot.com/2009/06/mocking-and-stubbing-in-javascript.html)的框架，但它不能进行 AJAX 调用。**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-21T10:07:08.203

以下是一些可能对您有所帮助的链接：

[amok](http://code.google.com/p/amok/)（声称支持ajax）

[假查询](http://code.google.com/p/fakequery/)

[QUnit](http://docs.jquery.com/QUnit)

[JSMock](http://jsmock.sourceforge.net/)

[qMock](http://code.google.com/p/qmock/wiki/About_qMock)

[jqunit](http://code.google.com/p/jqunit/) + [jqmock](http://code.google.com/p/jqmock/)

* * *

其他 javascript 测试“框架”

[jqunit](http://code.google.com/p/jqunit/)

[杰克](http://boss.bekk.no/display/BOSS/Jack)

[YUI 测试](http://developer.yahoo.com/yui/yuitest/)

[JS规范](http://jania.pe.kr/aw/moin.cgi/JSSpec)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-25T11:24:28.213

我更喜欢模块化代码。模块化代码很容易模拟！

```
var function fetchAjaxData(){
  // Perform ajax request.
  // Call 'update' with the data in question.
}

var update = function(ajaxData){
  // do things with ajaxData
} 
```

使用这种代码，您需要做的就是调用“更新”函数来模拟 ajax 请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-27T10:31:45.667

Mocking 也包含在[jasmine](http://pivotal.github.com/jasmine/%20jasmine)测试框架中。我自己用它来模拟 jQuery.ajax：

```
spyOn(jQuery, 'ajax').andCallFake(function(value) {
    value.success(data);
}); 
```

# vb.net - 如何在窗口窗体应用程序中创建颜色枚举？

> ID：1023581
> 
> 赞同：6
> 
> 时间：2009-06-21T10:08:17.607
> 
> 标签：vb.net, enumeration

我遇到了一个我认为一定很常见的“问题”，想知道是否有人可以提供帮助。

我正在构建一个简单的 Windows 窗体（使用 VB.NET）供朋友在工作中使用。他的公司有大约 10 种特定的配色方案（它们有 RGB 值列表），用于公司徽标、网站等。

我想在我的应用程序中遵循这种配色方案，并且为了简化开发，想构建这些颜色的枚举，以避免对每个标签、面板等的 RBG 值进行硬编码。

我最初的想法是做以下事情：

```
Enum ColorTypes
   CompanyDarkBlue = Color.FromArgB(0,56,147)
   CompanyBlue = Color.FromArgB(0,111,198)
   CompanyLightBlue = Color.FromArgB(0,145,201)
End Enum 
```

然而，它并不是那么简单，因为需要一个常量。我在互联网上环顾四周，发现了一个如何实现我需要的示例，但对于应用程序开发似乎相当普遍的要求来说，这似乎非常复杂。

您认为解决此问题的最佳方法是什么？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T10:23:18.640

您可以使用扩展方法。首先简化您的枚举：

```
enum ColorType
{
   CompanyDarkBlue,
   CompanyBlue,
   CompanyLightBlue
} 
```

扩展方法将如下所示：

```
public static class ColorTypeExtensions
{
   public static Color ToColor(this ColorType colorType)
   {
      switch(colorType)
      {
         case ColorType.CompanyDarkBlue: return Color.FromArgB(0,56,147);
         ...
      }
   }
} 
```

这将允许您编写：

```
ColorType.CompanyDarkBlue.ToColor(); 
```

有关更多信息，请查看[C#：使用扩展方法增强枚举](http://pietschsoft.com/post/2008/07/C-Enhance-Enums-using-Extension-Methods.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T10:33:40.257

我不会说您需要在这里进行枚举。当您提到“配色方案”时，通常的做法是使用多态性来允许不同的配色方案。

这意味着您将拥有这样的界面：

```
 public interface IColorScheme
   {
        Color CompanyDarkBlue { get; }
        Color CompanyBlue { get; }
        Color CompanyLightBlue { get; }
   } 
```

然后以您喜欢的任何方式实现它：

```
 public class MyColorScheme : IColorScheme
   {
        public virtual Color CompanyDarkBlue
        { 
           get { return Color.FromArgB(0,56,147); }
        }

        public virtual Color CompanyBlue
        {
           get { return Color.FromArgB(0,56,147); }
        }

        // etc.
   } 
```

请注意，我还将这些属性设为虚拟，因此如果您需要稍微不同的方案，您可以轻松地仅覆盖特定颜色。

为了充分利用这种抽象，您的程序应该主要使用 IColorScheme 属性，而无需了解正在使用的实际实现。正确的配色方案应在初始化期间单独实例化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T10:28:10.720

将这些颜色放在单独的类中，并将它们作为属性而不是枚举。

```
 public class myColor
{
    public static Color CompanyDarkBlue
    {
        get { return Color.FromArgb(0, 56, 147); }
    }

    public static Color CompanyBlue
    {
        get { return Color.FromArgb(0, 111, 198); }
    }

    public static Color CompanyLightBlue
    {
        get { return Color.FromArgb(0, 145, 201); }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T10:12:29.253

您可以将相同的信息存储在具有共享字段/属性的类中，并达到与枚举相同的效果。

根本不明白为什么这里需要枚举

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-08T04:15:05.960

```
public enum ColorTypes {
    CompanyDarkBlue = 0x003893,
    CompanyBlue = 0x006FC6,
    CompanyLightBlue = 0x0091C9
} 
```

# intersection - 最快的水平线<->凸多边形相交算法？

> ID：1023583
> 
> 赞同：1
> 
> 时间：2009-06-21T10:09:37.200
> 
> 标签：intersection, horizontal-line, convex-polygon

我需要解决一个相对简单的问题——我有 n 个顶点凸 2D 多边形和一条带有一些“y”坐标的水平（！）线。我只需要一件事：检查多边形是否与这条线相交（即有2个交叉点）。

我能想到的最快的方法是在多边形内找到最小/最大 y 坐标（循环重复 n 次，两次比较和两次存储），然后比较最小 y <= y < max y。

不知何故，我觉得这可以更“数学”地解决，但我总是以较慢的代码结束（例如矢量方式——我需要计算 n[i] 和 n[i+1] 的差异，然后将它们相乘、相加等 - - 比 2 cmps+stores 慢得多）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T10:12:38.537

你只需要检查你的多边形是否有一个 y1 < y 和一个 y2 > y 的点。一旦你找到了这两点，你就完成了。如果您可以通过 y 坐标索引您的点，那应该是一个快速查找。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T10:14:57.203

如果它是水平二维线，那么是的，您描述的方法可能是最快的。您也可以将其短路，就好像您在检查中途并且有一个 > 和 < 您的 y 值的最小值 + 最大值，那么您就有一个交叉点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T10:24:31.367

如果您每次都必须在原始状态下进行，那么您可能不会找到任何技巧来使其更快。

如果您可以使用多边形缓存最小/最大 Y 值，那么您可以通过在每次进行测试时不循环每个顶点来节省时间。

如果您的多边形具有与之关联的对齐边界框，您可以根据框范围而不是多边形对其进行测试，并更快地获得相同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-03T12:38:43.013

此处描述了另一种方法： [最佳算法，如果线与凸多边形相交](https://stackoverflow.com/questions/4497841/optimal-algorithm-if-line-intersects-convex-polygon)。但是因为您正在处理正交线，所以您可以稍微简化一下:)。因此，在不存储值的情况下，总复杂度为 log N。

# c++ - 打印以记录核心转储文件堆栈，C++ over windows？

> ID：1023592
> 
> 赞同：0
> 
> 时间：2009-06-21T10:14:08.563
> 
> 标签：c++, windows, core, dump, signals

当我的进程崩溃时，如何通过 Windows 打印以记录核心转储文件堆栈、C++？我知道在 Unix 中有一种方法可以使用一些信号处理程序来做到这一点，但我自己从来没有这样做过。我如何在 Windows 中做到这一点（不喜欢使用 ACE）？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T12:07:30.677

Windows 等效的核心转储称为 Minidump，您可以使用[MiniDumpWriteDump](http://msdn.microsoft.com/en-us/library/ms680360.aspx)编写一个。这里有一篇关于 codeproject 的文章：http: [//www.codeproject.com/KB/debug/postmortemdebug_standalone1.aspx](http://www.codeproject.com/KB/debug/postmortemdebug_standalone1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T11:51:51.283

您可以设置自己的顶级异常处理程序并使用 dbghelp 库遍历堆栈以获取调用堆栈。您也可以通过[这种](https://stackoverflow.com/questions/696580/getting-a-dump-of-a-process-that-crashes-on-startup/700108#700108)方式生成应用程序故障转储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T12:13:09.930

如果您正在寻找堆栈步行器，请查看由 Jochen Kalmbach 创建的[这个。](http://www.codeproject.com/KB/threads/StackWalker.aspx)运行时，它将让您以任何您喜欢的方式记录堆栈跟踪。然而，常见的方法是让 Windows 创建一个转储（完整的或迷你的）。

# winapi - Windows下如何用汇编编写hello world？

> ID：1023593
> 
> 赞同：107
> 
> 时间：2009-06-21T10:14:14.163
> 
> 标签：winapi, assembly, x86, nasm

我想在 Windows 下编写一些基本的汇编程序，我正在使用 NASM，但我什么都做不了。

如何在 Windows 上不借助 C 函数编写和编译 hello world？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-06-22T19:51:29.407

这个例子展示了如何直接进入 Windows API 而不是 C 标准库中的链接。

```
 global _main
    extern  _GetStdHandle@4
    extern  _WriteFile@20
    extern  _ExitProcess@4

    section .text
_main:
    ; DWORD  bytes;    
    mov     ebp, esp
    sub     esp, 4

    ; hStdOut = GetstdHandle( STD_OUTPUT_HANDLE)
    push    -11
    call    _GetStdHandle@4
    mov     ebx, eax    

    ; WriteFile( hstdOut, message, length(message), &bytes, 0);
    push    0
    lea     eax, [ebp-4]
    push    eax
    push    (message_end - message)
    push    message
    push    ebx
    call    _WriteFile@20

    ; ExitProcess(0)
    push    0
    call    _ExitProcess@4

    ; never here
    hlt
message:
    db      'Hello, World', 10
message_end: 
```

要编译，您需要 NASM 和 LINK.EXE（来自 Visual Studio 标准版）

```
   nasm -fwin32 hello.asm
   链接 /subsystem:console /nodefaultlib /entry:main hello.obj

```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-06-21T10:17:49.600

[NASM 示例](http://web.archive.org/web/20120414223112/http://www.cs.lmu.edu/~ray/notes/nasmexamples/)。

调用 libc stdio `printf`，实现`int main(){ return printf(message); }`

```
; ----------------------------------------------------------------------------
; helloworld.asm
;
; This is a Win32 console program that writes "Hello, World" on one line and
; then exits.  It needs to be linked with a C library.
; ----------------------------------------------------------------------------

    global  _main
    extern  _printf

    section .text
_main:
    push    message
    call    _printf
    add     esp, 4
    ret
message:
    db  'Hello, World', 10, 0 
```

然后运行

```
nasm -fwin32 helloworld.asm
gcc helloworld.obj
a 
```

* * *

Nasm 中还有[The Clueless Newbies Guide to Hello World ，](http://web.archive.org/web/20100529113659/http://home.comcast.net/~fbkotler/clueless.html)无需使用 C 库。然后代码看起来像这样。

**带有 MS-DOS 系统调用的 16 位代码：在 DOS 仿真器或支持 NTVDM 的 32 位 Windows 中工作**。不能在任何 64 位 Windows 下“直接”（透明地）运行，因为 x86-64 内核不能使用 vm86 模式。

```
org 100h
mov dx,msg
mov ah,9
int 21h
mov ah,4Ch
int 21h
msg db 'Hello, World!',0Dh,0Ah,'$' 
```

将其构建为可执行文件，以便在所有段寄存器彼此相等的`.com`情况下加载它（微型内存模型）。`cs:100h`

祝你好运。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-06-23T12:58:44.697

这些是使用 Windows API 调用的 Win32 和 Win64 示例。它们适用于 MASM 而不是 NASM，但请查看它们。[您可以在本文](https://web.archive.org/web/20140225144938/http://www.codegurus.be/codegurus/Programming/assembler&win64_en.htm)中找到更多详细信息。

这使用 MessageBox 而不是打印到标准输出。

### Win32 MASM

```
;---ASM Hello World Win32 MessageBox

.386
.model flat, stdcall
include kernel32.inc
includelib kernel32.lib
include user32.inc
includelib user32.lib

.data
title db 'Win32', 0
msg db 'Hello World', 0

.code

Main:
push 0            ; uType = MB_OK
push offset title ; LPCSTR lpCaption
push offset msg   ; LPCSTR lpText
push 0            ; hWnd = HWND_DESKTOP
call MessageBoxA
push eax          ; uExitCode = MessageBox(...)
call ExitProcess

End Main 
```

### Win64 MASM

```
;---ASM Hello World Win64 MessageBox

extrn MessageBoxA: PROC
extrn ExitProcess: PROC

.data
title db 'Win64', 0
msg db 'Hello World!', 0

.code
main proc
  sub rsp, 28h  
  mov rcx, 0       ; hWnd = HWND_DESKTOP
  lea rdx, msg     ; LPCSTR lpText
  lea r8,  title   ; LPCSTR lpCaption
  mov r9d, 0       ; uType = MB_OK
  call MessageBoxA
  add rsp, 28h  
  mov ecx, eax     ; uExitCode = MessageBox(...)
  call ExitProcess
main endp

End 
```

要使用 MASM 组装和链接这些，请将其用于 32 位可执行文件：

```
ml.exe [filename] /link /subsystem:windows 
/defaultlib:kernel32.lib /defaultlib:user32.lib /entry:Main 
```

或者对于 64 位可执行文件：

```
ml64.exe [filename] /link /subsystem:windows 
/defaultlib:kernel32.lib /defaultlib:user32.lib /entry:main 
```

* * *

**为什么 x64 Windows 需要在 a 之前保留 28h 字节的堆栈空间`call`？** 这是调用约定所要求的 32 字节 (0x20) 的影子空间（也称为主空间）。另外 8 个字节将堆栈重新对齐 16，因为调用约定要求RSP*在*`call`. （我们`main`的调用者（在 CRT 启动代码中）这样做了。8 字节的返回地址意味着 RSP 距离函数入口处的 16 字节边界有 8 个字节。）

函数可以使用[影子空间将其寄存器参数转储到任何堆栈参数（如果有）所在的位置。](https://stackoverflow.com/questions/30190132/what-is-the-shadow-space-in-x64-assembly)`system call`除了前面提到的 4 个寄存器之外，A还需要 30h（48 个字节）来为 r10 和 r11 保留空间。但是 DLL 调用只是函数调用，即使它们是`syscall`指令的包装器。

有趣的事实：非 Windows，即 x86-64 System V 调用约定（例如在 Linux 上）根本不使用影子空间，并且在 XMM 寄存器中使用多达 6 个整数/指针寄存器参数*和*多达 8 个 FP 参数.

* * *

使用 MASM 的`invoke`指令（它知道调用约定），您可以使用一个 ifdef 来制作一个可以构建为 32 位或 64 位的版本。

```
ifdef rax
    extrn MessageBoxA: PROC
    extrn ExitProcess: PROC
else
    .386
    .model flat, stdcall
    include kernel32.inc
    includelib kernel32.lib
    include user32.inc
    includelib user32.lib
endif
.data
caption db 'WinAPI', 0
text    db 'Hello World', 0
.code
main proc
    invoke MessageBoxA, 0, offset text, offset caption, 0
    invoke ExitProcess, eax
main endp
end 
```

两者的宏变体相同，但您不会以这种方式学习汇编。您将改为学习 C 风格的 asm。`invoke`is for `stdcall`or `fastcall`while `cinvoke`is for `cdecl`or variable argument `fastcall`。汇编器知道使用哪个。

**您可以反汇编输出以查看`invoke`扩展程度。**

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-11-17T15:54:11.217

[Flat Assembler](http://flatassembler.net/)不需要额外的链接器。这使得汇编程序编程非常容易。它也可用于 Linux。

这是`hello.asm`来自 Fasm 的例子：

```
include 'win32ax.inc'

.code

  start:
    invoke  MessageBox,HWND_DESKTOP,"Hi! I'm the example program!",invoke GetCommandLine,MB_OK
    invoke  ExitProcess,0

.end start 
```

Fasm 创建一个可执行文件：

```
>fasm hello.asm
flat assembler 版本 1.70.03（1048575 KB 内存）
4 遍，1536 字节。

```

这是[IDA](https://www.hex-rays.com/products/ida/)中的程序：

![在此处输入图像描述](../Images/517194e24abfec9b04dd9a2944a5a65a.png)

您可以看到三个调用`GetCommandLine`：`MessageBox`和`ExitProcess`。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-01-16T16:53:54.997

要使用 NASM'compiler 和 Visual Studio 的链接器获取 .exe，此代码可以正常工作：

```
global WinMain
extern ExitProcess  ; external functions in system libraries 
extern MessageBoxA

section .data 
title:  db 'Win64', 0
msg:    db 'Hello world!', 0

section .text
WinMain:
    sub rsp, 28h  
    mov rcx, 0       ; hWnd = HWND_DESKTOP
    lea rdx,[msg]    ; LPCSTR lpText
    lea r8,[title]   ; LPCSTR lpCaption
    mov r9d, 0       ; uType = MB_OK
    call MessageBoxA
    add rsp, 28h  

    mov  ecx,eax
    call ExitProcess

    hlt     ; never here 
```

如果此代码保存在例如“test64.asm”上，则编译：

```
nasm -f win64 test64.asm 
```

产生“test64.obj”然后从命令提示符链接：

```
path_to_link\link.exe test64.obj /subsystem:windows /entry:WinMain  /libpath:path_to_libs /nodefaultlib kernel32.lib user32.lib /largeaddressaware:no 
```

其中*path_to_link*可以是*C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin*或您机器中的 link.exe 程序的任何位置， *path_to_libs*可以是*C:\Program Files (x86)\Windows Kits\8.1\ Lib\winv6.3\um\x64*或任何你的库（在这种情况下 kernel32.lib 和 user32.lib 都在同一个地方，否则为你需要的每个路径使用一个选项）并且*/largeaddressaware:no*选项是有必要避免链接器抱怨地址太长（在这种情况下是 user32.lib）。此外，正如这里所做的那样，如果从命令提示符调用 Visual 的链接器，则必须事先设置环境（运行一次 vcvarsall.bat 和/或查看[MS C++ 2010 和 mspdb100.dll](https://stackoverflow.com/questions/2990331/ms-c-2010-and-mspdb100-dll)）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-22T20:34:28.713

除非你调用*某个*函数，否则这根本不是微不足道的。（而且，说真的，调用 printf 和调用 win32 api 函数的复杂度并没有真正的区别。）

即使 DOS int 21h 实际上只是一个函数调用，即使它是一个不同的 API。

如果您想在没有帮助的情况下执行此操作，则需要直接与视频硬件对话，可能会将“Hello world”字母的位图写入帧缓冲区。即便如此，显卡仍在将这些内存值转换为 DisplayPort/HDMI/DVI/VGA 信号。

请注意，实际上，这些东西在 ASM 中一直到硬件都没有比在 C 中更有趣的了。“hello world”程序归结为函数调用。ASM 的一个优点是您可以相当轻松地使用任何您想要的 ABI。你只需要知道 ABI 是什么。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-02-26T21:54:17.723

如果要将 NASM 和 Visual Studio 的链接器 (link.exe) 与 anderstornvig 的 Hello World 示例一起使用，则必须手动链接包含 printf() 函数的 C 运行时库。

```
nasm -fwin32 helloworld.asm
link.exe helloworld.obj libcmt.lib 
```

希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-01-18T14:47:51.353

最好的例子是那些使用 fasm 的，因为 fasm 不使用链接器，它通过另一个不透明的复杂层隐藏了 windows 编程的复杂性。如果您对写入 gui 窗口的程序感到满意，那么 fasm 的示例目录中有一个示例。

如果你想要一个控制台程序，它允许标准输入和标准输出的重定向也是可能的。有一个（helas 非常重要的）示例程序可用，它不使用 gui，并且严格与控制台一起工作，这就是 fasm 本身。这可以精简到基本要素。（我编写了第四个编译器，这是另一个非 gui 示例，但它也很重要）。

这样的程序具有以下命令来为 32 位可执行文件生成适当的标头，通常由链接器完成。

```
FORMAT PE CONSOLE 
```

名为“.idata”的部分包含一个表，该表可帮助窗口在启动期间将函数名称与运行时地址耦合。它还包含对 KERNEL.DLL 的引用，它是 Windows 操作系统。

```
 section '.idata' import data readable writeable
    dd 0,0,0,rva kernel_name,rva kernel_table
    dd 0,0,0,0,0

  kernel_table:
    _ExitProcess@4    DD rva _ExitProcess
    CreateFile        DD rva _CreateFileA
        ...
        ...
    _GetStdHandle@4   DD rva _GetStdHandle
                      DD 0 
```

表格格式由窗口强加，并包含程序启动时在系统文件中查找的名称。FASM 隐藏了 rva 关键字背后的一些复杂性。所以 _ExitProcess@4 是一个 fasm 标签，_exitProcess 是一个由 Windows 查找的字符串。

您的程序位于“.text”部分。如果您声明该部分可读可写和可执行，则它是您需要添加的唯一部分。

```
 section '.text' code executable readable writable 
```

您可以调用您在 .idata 部分中声明的所有工具。对于控制台程序，您需要 _GetStdHandle 来查找标准输入和标准输出的文件描述符（使用符号名称，如 fasm 在包含文件 win32a.inc 中找到的 STD_INPUT_HANDLE）。一旦你有了文件描述符，你就可以执行 WriteFile 和 ReadFile。所有函数都在 kernel32 文档中描述。您可能已经意识到这一点，否则您不会尝试汇编程序编程。

总结：有一个带有 asci 名称的表与 windows 操作系统耦合。在启动期间，这将转换为您在程序中使用的可调用地址表。

# asp.net - 在 asp.net 中设置配置文件属性

> ID：1023599
> 
> 赞同：1
> 
> 时间：2009-06-21T10:17:45.560
> 
> 标签：asp.net, profile

我创建了自己的注册表单并使用 Membership 类创建用户。

```
MembershipCreateStatus status;
MembershipUser newUser = Membership.CreateUser(tbxUsername.Text, 
                                               tbxPassword.Text, 
                                               tbxEmail.Text, 
                                               null, null, true, out status); 
```

使用代码创建用户后，我尝试像这样设置一些配置文件属性

```
Profile.CountryCode = ddlCountry.SelectedValue;
Profile.DisplayName = tbxDisplayName.Text;
Profile.Save(); 
```

但是我收到以下异常消息

**不能为匿名用户设置此属性。**

任何想法为什么我得到这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T10:32:34.610

我认为这是因为您没有先获取配置文件（来自 DB/无论您使用什么）。

您的代码可能如下所示：

```
ProfileCommon p = Profile.GetProfile(tbxUsername.Text);
p.CountryCode = ddlCountry.SelectedValue;
p.DisplayName = tbxDisplayName.Text;
p.Save(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-12T20:38:38.013

我遇到了同样的错误，这是因为我只设置了 authCookie，但没有设置 httpcontext 用户。看哪：

```
HttpCookie authCookie = HttpContext.CurrentRequest.Cookies[FormsAuthentication.FormsCookieName];
if (authCookie != null)
{
    //Extract the forms authentication cookie
    FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value);

    // If caching roles in userData field then extract
    string[] roles = authTicket.UserData.Split(new char[] { '|' });

    // Create the IIdentity instance
    IIdentity id = new FormsIdentity(authTicket);

    // Create the IPrinciple instance
    IPrincipal principal = new GenericPrincipal(id, roles);

    // Set the context user 
    HttpContext.Current.User = principal;
} 
```

特别感谢[这篇文章](https://stackoverflow.com/questions/7217105/how-can-i-manually-create-a-authentication-cookie-instead-of-the-default-method)的代码！

# issue-tracking - 开发人员工作负载管理软件：推荐？

> ID：1023601
> 
> 赞同：2
> 
> 时间：2009-06-21T10:19:01.300
> 
> 标签：issue-tracking

在我的位置，我们使用两种问题跟踪工具，一种用于生产错误，另一种用于开发项目的问题。这些工具对管理者有好处。然而，在个人层面，其他工作也可以通过桌面访问、电子邮件或电话到达，而分配工作的人并不总是对问题跟踪系统感兴趣。

我最近完成了一个为期 18 个月的项目，我进入了一个加班周期，我发现我并不总是能很好地了解分配给我的所有工作。结果，我总是很忙，并且经常感到工作负荷过重，但没有明确的数据向我的经理展示（或者，具有讽刺意味的是，没有时间停下来收集信息！）。

每天结束时更新的手写列表是一个好的开始，但是谁能推荐更好的工具来帮助我清楚地了解自己的工作量？理想情况下，我正在考虑开发人员的软件工具，可以包含估计，但欢迎所有建议。

谢谢，稻田

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T10:30:12.510

很少有软件可以通过拍摄屏幕快照和监控活动进程来帮助跟踪您的时间使用情况。您可能对[如何跟踪您的工作时间感兴趣？](https://stackoverflow.com/questions/25707/how-do-you-track-your-hours). 我还发现一个小笔记本对于保存简单的待办事项列表很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T10:30:21.713

看看[Taskcoach](http://www.taskcoach.org)。它允许您组织和跟踪您的项目和开发时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-19T13:08:25.523

这可能是您正在寻找的。它考虑了各种活动——例如会议、缺勤、支持等——以及任何与项目相关的任务。还有一个时间表模块： [上下文](http://www.blackstairsmountains.com/BlackstairsHome/Pages/Context.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T08:10:46.330

我在另一个问题的未评级答案中找到了这个：http: [//www.codeproject.com/KB/applications/todolist2.aspx](http://www.codeproject.com/KB/applications/todolist2.aspx)

到目前为止，它似乎相当不错，我想到的那种东西（不过我也会与 Taskcoach 进行比较）。

我认为这两个中的一个将是我需要的计划工具，因此结合记事本/电子表格来跟踪花费的时间，我认为这回答了我的问题，谢谢小伙子们。

# c++ - 一个用于删除注释的 C++ 程序

> ID：1023608
> 
> 赞同：3
> 
> 时间：2009-06-21T10:24:07.343
> 
> 标签：c++, parsing

我正在尝试创建一个程序，该程序采用 c++ 代码的文本文件并使用该代码输出另一个文件，减去它包含的任何注释。

假设 rFile 和 wFile 定义如下：

```
ifstream rFile; // File stream object for read only
ofstream wFile; // File stream object for write only

rFile.open("input.txt", ios::in);
wFile.open("output.txt", ios::out); 
```

我的第一个想法是简单地浏览文本并在（略微改进的）peek（）识别/*时执行相当于上笔（徽标参考）的操作，并在看到*/时下笔。当然，在看到 // 之后它会“向上”，直到它到达 \n。

这种方法的问题是 output.txt 不包含任何原始空格或换行符。

这是代码（在这个阶段我什至没有尝试删除评论）：

```
while (!rFile.eof())
{
rFile>>first;  //first is a char
wFile<<first;
} 
```

因此，我尝试使用 getline() 分别获取每一行代码，然后将 endl 添加到 wFile。到目前为止它工作得很好，但是让事情变得更加复杂，不那么优雅，代码的可读性也降低了。

所以，我想知道是否有人对我有任何指示。（没有双关语！）

注意这是我收到的更大家庭作业的一部分，我仅限于使用 C++ 函数而不是 C 函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T10:34:12.597

**更新：**

其他人提到了这一点，但我认为[`get`](http://en.cppreference.com/w/cpp/io/basic_istream/get)可能是比“>>”更好的功能。

**原帖：**

解决方案是逐个字符读取输入，而不是使用`getline()`.

您可以使用“>>”读取字符，并使用“<<”将它们输出。这样你就不必使用“endl”了。行终止符和空格字符将作为单个字符读入。

当您看到评论的开头时，您可以停止输出字符，直到您吃掉适当的评论终止符。

在处理“//”标记的结尾时，您还需要确保将“\r\n”视为单个终止符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T17:22:39.020

我会使用 istreambuf_iterator：
这允许您一次遍历文件一个字符。

这还允许您从带您浏览文件的循环逻辑中删除处理逻辑。

```
#include <iterator>
#include <iostream>
#include <algorithm>

class CommentFilter
{
    public:
        CommentFilter(std::ostream& output)
            :m_commentOn(false)
            ,m_output(output)
        {}

        // For each character we find call this method 
        void operator()(char c) const
        {
            // Check for a change in the comment state. (ie PenDown)
            // Leaving this for you to do.

            // Now print the stuff you want.
            if (!m_commentOn)
            {
                // If the commentOn is true then we don't print.
                // Otherwise we do.
                m_output << c;
            }
        }
    private:
        bool            m_commentOn;
        std::ostream&    m_output;
};

int main()
{
    CommentFilter   filter(std::cout);

    // The istreambuf_iterator allows you to iterate through a stream one obejct at a time.
    // In this case we define the object to be a char.
    //
    // So for each obejct (char) we find we call the functor filter with that object.
    // This means filer must have a method so that it can be called like this  filter('a')
    // To-Do this we define the operator() see-above.
    std::for_each(  std::istreambuf_iterator<char>(std::cin),
                    std::istreambuf_iterator<char>(),
                    filter
                );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T10:39:40.633

您是否考虑过使用 C++ 库的[正则表达式来查找注释字符串](http://ostermiller.org/findcomment.html)？找到它们后，您显然可以用空字符串替换它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T10:46:48.687

您的问题类似于[使用 fstream 读取每个字符，包括空格和换行符](https://stackoverflow.com/questions/116951/using-fstream-to-read-every-character-including-spaces-and-newline)。如果您想逐字符读取文件，包括换行符和空格，请[尝试 istream::get](http://www.cplusplus.com/reference/iostream/istream/get/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T11:59:08.757

读取每个字符，并保留几个布尔变量。一个布尔用于字符串，另一个用于字符，另一个用于转义，另一个用于单行语句，另一个用于块注释。

仅当单行语句和块注释都为“假”时才输出您的字符。

如果您找到 // 或 /* 序列并且它不在字符串中（因此`"/*Abc*/"`不会被裁剪），则触发适当的布尔值。

哦，我差点忘了。换行符和 */ 序列应将相应的注释布尔值设置为 false。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-18T18:41:23.540

`>>`运算符不是一个完整的解决方案。正如您所发现的，它喜欢跳过空格。使用`get()`成员函数获取字符，`getline()`用于行。

一旦你这样做了，乐趣就开始了。

上笔，下笔的方法对我来说看起来不错。然后是什么是评论的问题。

您将需要跟踪引用的字符串和字符常量，以确保您没有将注释标记从其中拉出。(`'//'`是合法的，尽管是实现定义的，并且不开始注释。) 您可能需要注意，带引号的字符串中的`\"`or`??/"`不会关闭字符串，对于字符常量也是如此。您可能需要注意行尾的细微之处：行尾紧跟在行尾之前`\`或`??/`实际上不是行尾。（或者你可以忽略三元组；几乎其他人都这样做。）

如果您对有限状态机（又名确定性有限自动机）有些熟悉，您可能想要使用这种方法。本质上，您始终处于某种状态，并且在阅读角色时，您执行的操作取决于状态和角色，并且可能会更改为另一种状态。

例如，假设您在 state`READING_ALONG`中，并且遇到`/`. 你什么都不写，然后改变`SAW_A_SLASH`状态。如果下一个字符是`*`，则进入`C_STYLE_COMMENT`状态；如果是`/`，则进入`CPP_STYLE_COMMENT`状态，如果不是，则打印“/”和当前字符，然后返回`READING_ALONG`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-18T19:19:57.800

您需要考虑多个状态：

*   您在单引号字符串中的状态
*   您处于双引号字符串中的状态
*   您找到 // 的状态
*   您找到 /* 的状态
*   最后，在一行的末尾有一个 \，

这可能会导致编译器和文本荧光笔不同意的一些相当混乱的格式：

```
include <stdio>;
INT someVariable = 0;
/* where does this comment end? *\
///  I don't know
someVariable = 6;  
// most text editors don't think it ends until here --> */\
   but someVariable = 6;  shouldnt actually be commented out, and this line should be! \
this is also part of the comment ,   a "3 line " one line comment? WTF!
std::cout << someVariable << std::endl;
// even though "someVariable=6" appears to be commented out, it shouldn't be.
// so this will print "6"

// /* \
*/this text should be commented out aswell 
```

通过注释剥离器运行该代码应返回：

```
include <stdio>;
INT someVariable = 0;
someVariable = 6;  
std::cout << someVariable << std::endl; 
```

有趣的是，当您必须让编译器错误根据原始混乱而不是剥离版本引用代码行时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-21T11:55:13.307

如果您不想或不能使用正则表达式，您应该使用具有以下功能的 STL：

> find_last_off
> 
> find_first_of

识别您要删除的字符串的间隔。"\n" 是行尾，但这有点[复杂](http://en.wikipedia.org/wiki/Newline)。

但是您应该遵循 anderstornvig 的建议，正则表达式现在是 TR1 的一部分，因此这是 C++ 的工具（如果您使用 Visual C++ 2008，包括快速版或 G++ 的最新版本，如果不使用 Boost）。

寻找从哪里开始的第三个链接。

例如：

您应该在“;”之后寻找“//” 匹配“//”之后的所有文本直到行尾（正则表达式中的$）

此外，您还应该考虑花括号后的注释。/* 评论等。大量的特殊情况。

[C++ TR1 正则表达式入门](http://www.johndcook.com/cpp_regex.html)

[正则表达式教程](http://www.regular-expressions.info/tutorial.html)

[使用正则表达式在 (C) 源代码中查找注释](http://ostermiller.org/findcomment.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-21T15:02:45.783

我想这有点离题，因为您特别提到了 C++，但我认为 Perl 或 Python 会更容易使用。C 和 C++ 对字符串的东西来说是个麻烦事。

你可以：

1.  替换`' *\/\/.*'`为空字符串以删除 // 注释，并且
2.  通读文件，保留一个标志，指示您是否在 /* 注释中，如果是，则不要写任何内容。请记住 /* 注释不会嵌套。

编辑：小心数字 1。我忘了你必须确保你不在引号内。不要使用那个正则表达式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-18T18:18:50.623

我尽量保持简单和简短:-)..

```
#include <stdio.h>

FILE *rfd,*wfd;
char ch;

void end()
{
    int c=0;
    switch((ch=fgetc(rfd)))
    {
    case '/':
            do
            {
                ch=fgetc(rfd);
                if(ch=='\n')
                    break;
            }while(ch!=EOF);
            ch=fgetc(rfd);
            return;     

    case '*':do
            {
                c++;
                ch=fgetc(rfd);
                if(ch=='*' && (fgetc(rfd))=='/')
                    break;
            }while(ch!=EOF);            
            if(ch==EOF)
                fseek(rfd,-c-1,2);
            ch=fgetc(rfd);
            return;

    default:
        fputc('/',wfd);
        return;
    }
}

int main (int argc,char **argv)
{

    rfd=fopen("read.txt","r");
    wfd=fopen("write.txt","w");

    while((ch=fgetc(rfd))!=EOF)
    {
        if(ch=='/')
                end();

        fputc(ch,wfd);
    }

    printf("\ndone ");
    fflush(stdin);
    getchar();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-03-21T18:27:52.713

如果您只想从字符串中删除 // 样式的注释：

```
line.erase(line.find('//')); 
```

成功了。

# sql-server-2008 - 我的创建表 SQL 有什么问题？

> ID：1023609
> 
> 赞同：1
> 
> 时间：2009-06-21T10:24:16.110
> 
> 标签：sql-server-2008

我正在使用 SQL Server 2008 管理工作室执行以下 SQL 语句，这是来自 SQL Server 管理工作室的相关错误消息。有什么想法有什么问题吗？

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

Create TABLE [dbo].[BatchStatus](
    [BatchID] [uniqueidentifier] NOT NULL CONSTRAINT [PK_BatchStatus_ID],
    [BatchStatus] [int] NULL,
    CONSTRAINT [PK_BatchStatus_ID] PRIMARY KEY CLUSTERED 
    (
        [BatchID] ASC
    )WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]

GO

Msg 102, Level 15, State 1, Line 3
Incorrect syntax near ','.
Msg 319, Level 15, State 1, Line 8
Incorrect syntax near the keyword 'with'. If this statement is a common table
expression, an xmlnamespaces clause or a change tracking context clause, the 
previous statement must be terminated with a semicolon. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T10:31:31.900

试试这个：

```
Create TABLE [dbo].[BatchStatus](
    [BatchID] [uniqueidentifier] NOT NULL,
    [BatchStatus] [int] NULL,
    CONSTRAINT [PK_BatchStatus_ID] PRIMARY KEY CLUSTERED 
    (
        [BatchID] ASC
    )WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T10:41:45.357

您定义了两次“PK_BatchStatus_ID”约束 - 一次在定义 BatchID 字段的行上，一次在表定义的末尾。

您可以使用**列**定义约束“内联”：

```
CREATE TABLE [dbo].[BatchStatus]
    ([BatchID] [uniqueidentifier] NOT NULL 
        CONSTRAINT [PK_BatchStatus_ID] PRIMARY KEY,
    [BatchStatus] [int] NULL
) ON [PRIMARY] 
```

或者你可以在表的所有列**之后**定义它

```
CREATE TABLE [dbo].[BatchStatus]
    ([BatchID] [uniqueidentifier] NOT NULL,
    [BatchStatus] [int] NULL,
    CONSTRAINT [PK_BatchStatus_ID] PRIMARY KEY CLUSTERED 
    (
        [BatchID] ASC
    )WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] 
```

但你不能同时拥有（部分）

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T10:45:15.817

也许这就是你真正想要的。指定默认值的约束

```
Create TABLE [dbo].[BatchStatus](
    [BatchID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_BatchStatus_ID] DEFAULT((0)),
    [BatchStatus] [int] NULL,
    CONSTRAINT [PK_BatchStatus_ID] PRIMARY KEY CLUSTERED 
    (
        [BatchID] ASC
    ) WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] 
```

# c# - 将 INSERT 查询批处理到 SQL 2005/8 中的最有效和最简单的方法是什么

> ID：1023611
> 
> 赞同：2
> 
> 时间：2009-06-21T10:25:38.573
> 
> 标签：c#, sql-server, sql-server-2008, ado.net, insert

我是新手，`ADO.NET`所以寻求帮助。我必须在一张表中插入大量记录。

什么是最佳实践、有效和简单的方法？我找到了一篇名为[Batch Requests (ADO.NET Data Services Framework)](http://msdn.microsoft.com/en-us/library/cc668802.aspx)的文章，但对我来说并不清楚。

我还发现了一篇关于[BULK INSERT](http://msdn.microsoft.com/en-us/library/ms188365.aspx)但这种方法使用外部文件的文章，我不想使用它，因为有一个`ASP.NET`应用程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-21T10:27:40.143

查看[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类。这听起来也很明显，但并不是每个人都知道这一点——您可以通过使用事务显着提高插入性能——[我之前在博客上写过这个](http://richardod.blogspot.com/2009/03/speeding-up-sql-server-inserts-by-using.html)。

# .net - 有趣的命名空间示例

> ID：1023624
> 
> 赞同：0
> 
> 时间：2009-06-21T10:32:10.477
> 
> 标签：.net, namespaces

.NET 中的命名空间旨在

*   将逻辑代码段组合在一起
*   防止使用通用名称引起的冲突

也就是说，对于有趣、有趣或不同的命名是相当开放的。

你有这些不同名字的例子吗？

我不是在寻找[好的命名空间命名](https://stackoverflow.com/questions/587341/good-namespace-naming-conventions)——而是有趣或不同的一面，即使它违背了经过验证的实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T10:33:26.810

我看到的一个例子是团队中的每个人都有自己的命名空间，例如：

*   公司.产品.Jim
*   公司.产品.Bob

当我问到这个问题时，他们可以跟踪谁做了什么，并防止在登记时发生冲突。

# c# - 检测默认网络浏览器的代理设置

> ID：1023635
> 
> 赞同：6
> 
> 时间：2009-06-21T10:38:46.657
> 
> 标签：c#, proxy

MSDN 示例

```
HttpWebRequest myWebRequest=(HttpWebRequest)WebRequest.Create("http://www.microsoft.com");
WebProxy myProxy=new WebProxy();
// Obtain the 'Proxy' of the  Default browser.  
myProxy=(WebProxy)myWebRequest.Proxy; 
```

不工作。我得到的错误是：无法将“WebProxyWrapper”类型的对象转换为“System.Net.WebProxy”类型

我有什么选择？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-21T14:07:32.353

`[HttpWebRequest.Proxy](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.proxy.aspx)`返回一个`[IWebProxy](http://msdn.microsoft.com/en-us/library/system.net.iwebproxy.aspx)`接口，而不是`WebProxy`. 改变它，它会起作用。

您还可以使用[WebRequest.DefaultWebProxy](http://msdn.microsoft.com/en-us/library/system.net.webrequest.defaultwebproxy.aspx)或[WebRequest.GetSystemWebProxy()](http://msdn.microsoft.com/en-us/library/system.net.webrequest.getsystemwebproxy.aspx)来获取代理详细信息，而不是从中`HttpWebRequest`获取代理。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-02-04T17:40:57.027

要检查自动检测设置，请使用代码：

```
RegistryKey registry = Registry.CurrentUser.OpenSubKey(
    "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings", true);
registry.SetValue("ProxyEnable", 0);
RegistryKey registry2 = Registry.CurrentUser.OpenSubKey(
    "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections", true);
registry2.DeleteValue("DefaultConnectionSettings", false);
registry2.DeleteValue("SavedLegacySettings", false); 
```

# c++ - 包含两者的正确顺序 和 ?

> ID：1023638
> 
> 赞同：4
> 
> 时间：2009-06-21T10:42:31.767
> 
> 标签：c++, gcc, include, stdio

我需要使用系统特定的功能，例如`ftello()`（`stdio.h`根据 POSIX 标准定义）。我还需要使用标准 C++ 功能，例如`std::sprintf()`（`cstdio`根据 ISO C++ 标准在 中定义）。

AFAIK，仅包括`<cstdio>`不保证定义非标准 C++ 的东西，所以我想我必须包括两者。我很久以前就读过，（例如）使用 gcc 可能存在包含文件顺序的问题。

那么，同时包含`<cstdio>`和的正确顺序是什么`<stdio.h>`？我正在寻找一种尽可能跨平台的解决方案（至少对于 gcc、suncc、intel C++/linux 和 mingw）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T10:50:34.980

对于系统头文件，包含顺序通常不应成为错误的来源。

对于其他头文件，请查看[SO 的类似问题](https://stackoverflow.com/questions/614302/c-header-order)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T00:47:50.823

我不知道任何真正的规则，但一般来说，我在高级库之前包含较低级别的系统库。

所以在这种情况下 stdio.h 是一个 C 头文件，并且（在我的想象中）更接近机器，并且`<cstdio>`是更高级别的 C++ 标准库，我认为它更抽象。

我倾向于在自己`stdio.h`之前包括在内`cstdio`，但我不知道支持该理由的确切理由。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-18T13:30:49.880

好的，经过更多的研究，我终于得出一个结论，首先包含 C++ 头文件，然后是 C 头文件是正确的做法。例如，考虑以下 C++0x 标头（来自 gcc）：

/usr/include/c++/4.3/tr1_impl/cstdint：

```
 // ...
#define __STDC_LIMIT_MACROS
#define __STDC_CONSTANT_MACROS
#include_next <stdint.h>
// ... 
```

它的作用是定义了两个 C99 宏，然后才包含 C99 stdint.h 头文件。原因是在 C99 中，stdint.h 的某些功能是可选的，并且只有在定义了这些宏时才可用。但是，在 C++0x 中，所有 stdint.h 功能都是强制性的。现在，如果我先包含 C99 stdint.h，然后再包含 cstdint，由于 stdint.h 中的标头保护，我不会获得强制性的 C++0x 功能。有人可能会争辩说这是编译器供应商的错，但这是不正确的。stdint.h 是一个系统捆绑的头文件（在本例中来自 glibc），它是一个 C99 头文件，对 C++0x（毕竟它可能是一个旧系统）或 gcc 一无所知。编译器不能真正修复所有系统头文件（在这种情况下，总是在 C++ 模式下启用这些功能），但它必须在这些系统上提供 C++0x 支持，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T10:51:55.337

据我所知，ftello() 和 sprintf() 都包含在 stdio.h 中。

包含顺序对于非标准标头可能很重要，您必须检查依赖结构以找出哪个依赖于另一个，并以正确的顺序包含它们。

出于这个原因，包含文件的依赖项应该包含在包含文件中，而不是依赖“用户”来确保它们被正确包含。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T09:58:10.263

你无缘无故地担心。的内容是（17.4.1.2 Headers/4）的内容`<cstdio>`“好像包含在内” 。`<stdio.h>`不过，声明和定义（但不是宏）在命名空间 std 中。

所以你可能需要写`std::ftello()`. 为了提高便携性，添加一个`using std::ftello;`，你也不需要关心它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-22T09:56:40.660

我把最具体的东西放在顶部，把最不具体的东西放在底部。例如，对于源文件，它看起来像这样：

1.  预编译的头文件，如果有的话
2.  此源文件的标头
3.  项目包括
4.  大多数特定库，例如此项目中的库或公司库
5.  最少特定库，例如 boost 或 SDL 等“系统”库
6.  标准 C++
7.  标准 C
8.  操作系统头文件

我的理由是更具体的标题通常会包含更通用的标题，并希望通过宏来修改它们。如果已包含这些，则包含警卫或默认宏值将破坏系统库的行为。

另一个理由是，这种排序可以防止您“隐藏”其他头文件的依赖关系，也就是说，当从其他源文件中包含这些头文件时，这些头文件不会独立存在，因为它们之前总是包含系统库。

# c# - 如何限制用户登录？

> ID：1023641
> 
> 赞同：0
> 
> 时间：2009-06-21T10:45:10.827
> 
> 标签：c#, asp.net, javascript, web-applications, global-asax

我有一个场景，我必须按照以下详细信息限制用户登录：

每当第 500 个用户尝试登录我的网站时，都会出现一条消息**“用户登录超出，请稍后登录！”** .

一次只能登录 499 个用户，第 500 个用户是管理员。还需要在管理页面视图中显示在线用户。那么，如何计算登录用户并将数量限制在 500 以内。

请提供与 aps.net C# 相关的答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T06:38:31.820

我认为这适合应用程序上下文处理。

只是不要将这些东西保存在 MS sql 中，因为它浪费了连接数据库的资源。

最简单的方法是创建一个单例对象来保存有关在线用户数量的数据。该对象可以在 Application_Start 事件中实例化

每次登录操作发生时，锁定对象，更新当前用户数，然后释放锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T11:19:56.200

您需要跟踪当前登录到数据库中的用户。[Sev](https://stackoverflow.com/questions/1023641/how-to-limit-users-to-login/1023662#1023662)给出了一些关于如何完成它的好主意。但正如他在回答的评论中所提到的，当用户单击“注销”按钮时，您不能只将用户标记为已注销，因为许多用户只会关闭网页而没有正确注销。

因此，您需要一个会话管理，在用户闲置几秒钟后自动释放会话。

在我的网上银行软件中，这大约是 90 或 120 秒（更高的安全性），在 amazon.com 中至少是几个小时（更好的客户体验）。您设置此超时的时间取决于您的应用程序的具体要求。

无论如何，这是一个相当普遍的问题，所以应该有一些框架已经实现了这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T10:47:57.543

在 PHP 中，您可以通过更改 Sessions 的行为来做到这一点，以便将它们存储在数据库中。这样您就可以粗略地统计有多少人登录了。

我假设在 ASP 中有一种方法可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T11:00:20.453

如果您有性能良好的 RDBMS（和良好的网络），您可以在表中注册该信息......但如果这很昂贵，只需使用为您的服务器端技术（会话、应用程序等）提供的一些类。

用 JS 是不可能做到这一点的。您在哪里全局存储该信息（计数器变量）？

每次客户端连接到您的服务器时，所有 JS 代码都会重新加载，因此您无法存储该信息。

此外，如果您想使用 cookie，请记住 cookie 特定于使用它们的客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T11:01:06.473

有多种方法可以实现这一点。

数据库中的会话是一种方式。不过，这也可以用来了解您的网站上有多少匿名用户。

完成您正在寻找的任务的另一种方法是在名为“logged_in”的新字段中标记用户表中的用户。

当 login 方法执行时，flag 会相应修改，与 logout 方法类似。然后，每次用户尝试登录时运行一个 SELECT 查询，以检查当前有多少登录并采取相应措施。

更好的方法是在数据库中记录总共有多少登录用户，加减法，具体取决于执行的“登录”或“注销”方法。这样您就不会知道在任何给定时刻哪些特定用户登录了，但您至少会有一个您需要的总数。这种方法更好，因为您不必对整个用户表运行 SELECT 查询，而是可以从数据库中获取一个特定字段的值，从而提高性能。不幸的是，如果他们不是每次都注销，那么这种方法就没有用，除非您还存储了他们的登录时间并在一定时间后将他们注销。

要尝试解决用户可能会关闭浏览器而不是“注销”的问题，您可能仍然希望存储会话，并结合我上面提出的数据库结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T11:14:14.310

在 asp.net 中，您可以添加一个名为`global.asax`. 此文件具有应用程序级事件，包括`Session_Start`和`Session_End`。这将使跟踪会话变得容易，无论您是否使用数据库。

# http - 为什么 HTTP 协议最初被设计为无连接的？

> ID：1023643
> 
> 赞同：2
> 
> 时间：2009-06-21T10:46:28.530
> 
> 标签：http, networking, protocols

就我而言，Ajax 提供了一种解决方法，可以让 HTTP 协议的行为类似于面向连接的行为。但是为什么一开始 HTTP 协议没有被设计为面向连接的呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T11:04:00.273

因为它旨在用于连接没有意义的事情。

它被设计为超文本传输​​协议，这意味着它的职责只是允许发送“请给我文档 X”和“这里是文档 X，如你所愿”形式的消息。

这样的协议应该使用持久连接做什么？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T11:06:10.003

和简单。

回想起来可能不是一件坏事，因为这意味着 HTTP 很简单，这意味着它可以很容易地用于简单的事情。您可以通过在其之上构建层来将它用于需要状态的更难/更复杂的东西。

正是这种简单性使 HTTP 被广泛采用并具有吸引力。如果它不简单，那么它可能只是另一个复杂的协议，除非他们不得不使用，否则没有人使用。如果你不相信我，你能告诉我为什么你不使用 RPC 来编写你的 ajax 应用程序并使用 X11 来进行显示/渲染吗？:D

请记住，HTTP 最初的设计目的是实现像读/写信息存储这样的 wiki，而不是在线商店、银行、文字处理器等。我记得读过 Tim Berniers-Lee 的采访，他真的很高兴 wiki 获得了广泛的接受，因为（解释）这就是他打算如何让网络工作的方式。实际上，这在更广泛的 Web 上并没有发生，并且大多数站点都禁用了旨在启用此功能的 HTTP PUT 方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T10:57:49.613

1.  AJAX 不是面向连接的解决方法。这是为了确保基于用户交互，您只想在客户端更新一部分内容，而不是再次从服务器获取完整标记。它不会在您的浏览器和 Web 服务器之间建立来回连接。

2.  如果每台服务器与每个客户端都有实时连接，那么互联网规模将被限制在数百万用户范围内。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-21T11:05:45.357

HTTP 最初并且*仍然是*无连接的。AJAX 只是利用现代浏览器的 JavaScript 功能将 XML（或通常是 JSON）发送到服务器，而无需重新加载页面。

如前所述，主要原因是可扩展性。为网站的每个查看者保持活动连接将非常耗费资源。此外，事实是 HTTP 的最初创建者并没有设想任何需要维护连接的系统 - HTTP 的想法只是向请求发送文本响应然后完成。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-21T10:48:26.420

出于可扩展性的原因。保持连接会消耗资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T11:04:23.813

我认为原因很简单——当 http 被创建时：

1) 大多数/所有页面都是静态的 2) 由于互联网上几乎没有商业存在，因此假设链接很可能不会指向不同的站点。

所以，静态页面 + 非本地内容 = 无连接协议。

# javascript - Firefox 和 UniversalBrowserWrite 权限

> ID：1023644
> 
> 赞同：2
> 
> 时间：2009-06-21T10:46:40.497
> 
> 标签：javascript, firefox

如果我尝试写：

```
netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserWrite'); 
```

Firefox 3 告诉我，我的脚本已经取消了 UniversalBrowserWrite 权限！

现在我想在我的局域网中执行一个在全屏模式下最大化的程序，并且我想对窗口使用特权语句`toolbar=no`等，但我该怎么做呢？

我记得当我们使用上面的语句时，用户将被提示一个窗口，告诉它接受特权脚本，但现在该窗口不显示。

我希望我不能设置一些 about:config，因为我的程序必须运行到 LAN 中，我应该将该配置部署到所有客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T13:05:50.260

好的，我找到了这个解决方案：

首先我们必须在 about:config 中设置这个：

1) signed.applet.codebase_principal_support" 为 true 以允许执行

```
 netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserWrite'); 
```

并向用户显示一个确认窗口以允许该执行

2）“dom.disable_window_open_feature.location”为false以允许隐藏位置栏

3）“dom.disable_window_open_feature.status”为false'以允许隐藏状态栏

所以像这样的代码会让 Firefox 进入真正的全屏模式：

window.onload = 函数（）{

```
 netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserWrite');
    var newWin = window.open('http://www.stackoverflow.com', 'so', 'dialog=yes,minimizable=no,personalbar=no, directories=no, titlebar=no, location=no');
}; 
```

在 LAN 之后，我们应该为客户端设置 about:config 首选项，我们可以使用 SpliFF 建议的远程工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T11:00:56.723

我认为 UniversalBrowserWrite 只能在调用来自 chrome 窗口时才能设置，该窗口本身有一个 chrome 窗口作为父窗口

也许[R-kiosk 插件](https://addons.mozilla.org/de/firefox/addon/1659)为您做了正确的事情

# http - If-Unmodified-Since HTTP Header 有什么用？

> ID：1023648
> 
> 赞同：33
> 
> 时间：2009-06-21T10:48:23.173
> 
> 标签：http

你知道 If-Unmodified-Since 在野外的任何实际用途吗？从[描述](http://labs.apache.org/webarch/http/draft-fielding-http/p4-conditional.html#header.if-unmodified-since)来看，这个标头似乎是为了帮助避免脏写。即，仅当自上次可用于客户端的修改时间以来尚未修改此资源时才更新此资源。与 If-Modified-Since 不同，它似乎对缓存没有帮助。我错过了什么吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-21T10:54:33.803

例如，您可以将它用于[范围请求](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)。
示例：您的客户端请求资源[http://examp.le/foo?id=3](http://examp.le/foo?id=3)并且 Contents-length 为 4096，但您的客户端仅请求前 1024 个字节。然后它可以（稍后）请求剩余的 3072 字节，但如果资源同时发生变化，这没有意义。

编辑：如果资源同时更改，您可能不想更改/更新数据。例如，您请求客户记录并编辑某些内容。如果其他人同时更改了记录，这可能会导致不一致。因此，使用 if-unmodified-since(-I-retrived-the-data) 标头发送您的更新，如果记录已被更改，网络服务器将/应该拒绝您的更新 - 然后您的客户端可以请求“冲突”数据。

编辑2：因为您要求“在野外对 If-Unmodified-Since 进行任何实际使用”：请参阅[http://msdn.microsoft.com/en-us/library/dd179371.aspx#Subheading1](http://msdn.microsoft.com/en-us/library/dd179371.aspx#Subheading1)。
假设您首先[请求了 Blob 属性](http://msdn.microsoft.com/en-us/library/dd179394.aspx)。现在您知道了 Content-type 和 Content-length （也许您需要它来进行某种分配）。在您发送第二个[Get Blob](http://msdn.microsoft.com/en-us/library/dd179440.aspx)请求之前，某人/某事可能会更改 Blob。如果您将 Last-Modified 的值作为 If-Unmodified-Since 标头的值发送，则如果 blob 已更改，服务器将使用相应的错误代码进行响应。

* * *

这些是作为并发控制手段的乐观锁/标记锁的示例，其中 Last-Modified 标头的值用作保护令牌。参见例如[https://en.wikipedia.org/wiki/Optimistic_concurrency_control](https://en.wikipedia.org/wiki/Optimistic_concurrency_control)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-03-01T18:23:36.027

它对于在一段时间内执行但与单个未更改资源相关的多个请求很有用。

例子：

*   范围请求。对第一个范围请求（或者可能是初步的`HEAD`）的响应包括`Last-Modified`标头。后续请求仅适用于该资源的同一版本。如果资源在我们开始范围请求序列的时间和序列中间的某个时间之间发生了变化，我们希望重新开始。

*   乐观并发控制。我们首先`GET`是一个资源，在客户端进行一些更改，并希望`PUT`更新资源。但是我们只想`PUT`更新资源，只要同时没有其他人更新它。我们不想覆盖任何人的更改。如果在此期间发现有人更改了资源，我们想要`GET`再次更改，尝试重新应用客户端中的更改（有点像`git rebase`），并再次尝试`PUT`更改的资源。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T15:00:01.170

它在恢复大量下载时很有用。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-06-21T11:04:14.283

假设您正在开发一个显示给定地点当地天气的应用程序。如果服务器每天只更新 'x' 次天气信息，浏览器可以注意不要在该时间范围内发出 http 请求（即使有刷新）​​。

# distinct - 查询如何为每个不同的列只返回一个随机行？

> ID：1023657
> 
> 赞同：0
> 
> 时间：2009-06-21T10:58:28.427
> 
> 标签：distinct

我有一个包含两列的表，例如 column1 和 column2。Column2 不是唯一的。对于 column2 的每个不同值，我想要一个随机行，只有一行，从表中？

即我的结果集的行数应该与column2 的不同值的数量一样多。

例如：

```
column1   column2
x         1
y         2
z         1 
```

我希望结果是

```
column1   column2
x         1
y         2 
```

或者

```
column1   column2
z         1
y         2 
```

这可能只使用 SQL 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T11:11:34.720

`SELECT MAX(column1), column2 FROM yourtablename GROUP BY column2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T01:51:54.733

这个查询应该在 MySQL 上解决问题（在 MySQL 5 上测试）：

```
select a.column1, a.column2 from (select * from foo b order by rand()) a group by a.column2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T11:43:47.993

您可能想尝试诸如`ROW_NUMBER() OVER(ORDER BY column1 asc)`拉回您的行号并以这种方式过滤它。

你没有提到你使用什么风格的 SQL，我从记忆中回忆了这一点——但这种事情在 Oracle 9 中有效。

# asp.net - 网格视图摘要/详细信息（选项卡？）

> ID：1023668
> 
> 赞同：1
> 
> 时间：2009-06-21T11:04:07.027
> 
> 标签：asp.net, gridview, reporting, tabs

我正在显示的 Gridview 有一个非常具体的问题。

信不信由你，我的客户需要查看特定报告的大约 30 列。

显然，清晰地显示这些是不可能的，我正在寻找有关如何巧妙地实现这一目标的建议？

我在想 Ajax 选项卡在不同的选项卡上自然地将列组合在一起。

我主要担心的是 Gridview“日期范围”是根据 2 个日历控件中的值动态创建的。这会起作用吗，即我可以跨这些选项卡引用外部控件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T05:05:04.950

将您的 GridView 保留在 Panel 控件中，并将两个滚动条显示设置为 true。

这样页面将在没有滚动的情况下正确适应，但只有 GridView 会有滚动条。您的用户可以水平或垂直滚动​​浏览报告。

# c# - C# AC 电源连接/断开事件

> ID：1023671
> 
> 赞同：2
> 
> 时间：2009-06-21T11:05:36.290
> 
> 标签：c#, events

我正在编写一个桌面应用程序，想知道是否有任何事件在交流电源状态更改时触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T12:12:49.900

当电源设置更改时，Windows 会向窗口发送一个事件。它是[WM_POWERBROADCAST](http://msdn.microsoft.com/en-us/library/aa373247(VS.85).aspx)和它的 wParam [PBT_POWERSETTINGCHANGE](http://msdn.microsoft.com/en-us/library/aa372722(VS.85).aspx)。如果需要，您可以在收到此事件池 SystemInformation.PowerStatus 后按照 Noldorin 的建议进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T11:08:45.927

我不相信 BCL 中有任何内容会引发关于这种变化的事件。鉴于此类状态更新的频率很低，您真的需要一个吗？

我会简单地[`SystemInformation.PowerStatus`](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.powerstatus.aspx)定期轮询该属性（即一些秒数）。然后，如果您愿意，您可以基于此引发事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-20T19:20:56.560

The simplest way is to hook up to the [Microsoft.Win32.SystemEvents.PowerModeChanged](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28MICROSOFT.WIN32.SYSTEMEVENTS.POWERMODECHANGED%29;k%28POWERMODECHANGED%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29;k%28DevLang-CSHARP%29&rd=true). However, you need to look at the SystemInformation.PowerStatus value to figure out what changed.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-06T12:26:09.993

我搜索了很长时间，发现这是最好的方法，“睡眠”事件以前从未工作过

```
 private ManagementEventWatcher managementEventWatcher;
    private readonly Dictionary<string, string> powerValues = new Dictionary<string, string>
                         {
                             {"4", "Entering Suspend"},
                             {"7", "Resume from Suspend"},
                             {"10", "Power Status Change"},
                             {"11", "OEM Event"},
                             {"18", "Resume Automatic"}
                         };
    public void InitPowerEvents()
    {
        var q = new WqlEventQuery();
        var scope = new ManagementScope("root\\CIMV2");

        q.EventClassName = "Win32_PowerManagementEvent";
        managementEventWatcher = new ManagementEventWatcher(scope, q);
        managementEventWatcher.EventArrived += PowerEventArrive;
        managementEventWatcher.Start();
    }
    private void PowerEventArrive(object sender, EventArrivedEventArgs e)
    {
        foreach (PropertyData pd in e.NewEvent.Properties)
        {
            if (pd == null || pd.Value == null) continue;
            var name = powerValues.ContainsKey(pd.Value.ToString())
                           ? powerValues[pd.Value.ToString()]
                           : pd.Value.ToString();
            Console.WriteLine("PowerEvent:"+name);
        }
    }
    public void Stop()
    {
        managementEventWatcher.Stop();
    } 
```

# unicode - 我需要补充飞机吗？

> ID：1023674
> 
> 赞同：7
> 
> 时间：2009-06-21T11:06:10.067
> 
> 标签：unicode, utf, astral-plane, supplementary

我认为这个问题很简单，在基本平面之后我是否需要 Unicode 中的所有其他东西？包括什么样的东西，真的需要吗？（以及出于什么目的？）

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-11-11T08:11:51.413

如果您打算在中国销售任何东西，那么 GB 18030 标准是强制性的，并且需要 BMP（基本多语言平面）以外的字符。该标准是强制执行的，为了在那里销售，您需要通过 GB 18030 认证。

日本和香港也有国家标准要求字符超出 BMP。即使这些标准不像中国标准那样强制执行，支持它们也可能会给您带来一些优势。

所以简单的答案是：你需要那里的一些东西。

**=== 2016 ===**

那是7年前的事了。现在每个人都在谈论表情符号。好吧，大多数表情符号都超出了 BMP :-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-21T11:41:44.223

这取决于您是否控制数据。如果您使用来自您以外的任何人的 Unicode 数据，您通常必须假设它可能包含补充字符，这反过来意味着您需要处理 4 字节 UTF-8、UTF-16 代理字符等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-01T07:54:58.543

如果可能，您应该尝试支持所有 Unicode，包括补充平面。现在有活的语言坐在像[苗](http://unicode.org/charts/PDF/Unicode-6.1/U61-16F00.pdf)这样的辅助位面。未来会增加其他生活语言，部分语言目前需要补充私人使用区域。然后还有米海妮塔在他的[回答](https://stackoverflow.com/a/1713757/945854)中所说的。

MySQL 从 5.5 开始也[支持](http://dev.mysql.com/doc/refman/5.6/en/charset-unicode.html)辅助平面。

最好现在花一点时间来完全支持 Unicode，这样将来如果您确实需要它就不会遇到问题。而且您不知道谁将使用您的软件以及他们将来将使用哪些脚本。现在大部分的渲染引擎、GUI 工具包、浏览器、操作系统等都会毫无问题地支持这一点。

虽然这个问题是几年前提出的，但我在搜索时遇到了这个问题，从那时起情况发生了变化。我目前正在处理程序员认为不需要补充平面支持或未经测试的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T11:31:39.343

请参阅[字符图表的完整列表](http://unicode.org/charts/)。

补充字目前包含古文字。除非您的应用程序可以处理古代文字，例如 Kharoshthi、Old Persion 和 Cuneiform，否则**可能不会**。

我猜你只有在遇到不完整的 UTF-8 或 UTF-16 实现时才需要处理这个问题。UTF-8 的一些实现不支持 4 字节字符，这是补充平面：U+10000 以上的字符。我想到了[MySQL 。](http://dev.mysql.com/doc/refman/5.0/en/charset-unicode.html)

# mysql - MySQL 的 LIMIT 关键字是否保证返回数据的顺序？

> ID：1023675
> 
> 赞同：1
> 
> 时间：2009-06-21T11:06:25.650
> 
> 标签：mysql, database

我是 MySQL 新手，但我使用 Oracle 已有一段时间了。我对 MySQL 的`LIMIT`关键字有点困惑。这个关键字是否暗示每次执行查询时返回数据的顺序都是一样的？如果将更多数据添加到影响查询的表中怎么办？如果不存在 order-by 子句，数据将如何排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T11:13:33.810

不，`LIMIT`是不确定的。排序取决于数据、使用的索引、mysql 版本之间的内部变化、磁盘上数据的顺序等。

通常你会结合`LIMIT`an`ORDER BY`来避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T11:14:24.697

LIMIT 不会对返回的数据进行任何排序。

除非使用 ORDER BY 子句，否则无法保证每次执行时 limit 都会返回相同的订单。如果插入数据，这可能会影响有序和无序结果的结果。

如果省略 ORDER BY 子句，则基本上由数据库决定排序，并且可能基于表的索引方式。随着表被重新索引和/或添加更多数据，这将随着时间的推移而改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T11:13:35.213

除非您指定 ORDER BY，否则无法保证首先返回哪些行。

但在实践中，该顺序通常会匹配聚集索引顺序，并且不会在调用之间发生变化。不要依赖这种行为。

# asp.net - 寻找 ASP.NET 详细表单中的数据绑定指南

> ID：1023681
> 
> 赞同：5
> 
> 时间：2009-06-21T11:09:38.467
> 
> 标签：asp.net

几次在线搜索给我的印象是，当不涉及对象集合时，很少有人喜欢写有关数据绑定的文章。有使用 FormView 等数据绑定的资源，但这些资源就像煤矿中的彩虹一样稀缺。

你们中的一些人能否推荐一些关于数据绑定的好文章，以便在自定义 Web 表单中编辑对象详细信息，即不使用任何自动生成的编辑表单等。

我可能会被认为是太过分而做的很少，但我有一个原型的最后期限，并且很快需要在应用程序将要做什么的模型和功能性的第一次迭代之间做一些事情。稍后我将把我学到的东西写成一篇文章，希望能让其他人更容易找到关于这个主题的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T16:26:04.763

[我通常使用本文](http://www.15seconds.com/issue/040908.htm)定义的“蛮力”方法。制作一个 LoadToForm 和 LoadFromForm 方法只需要几分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T05:17:42.733

如果您真的在绑定一条记录并且不想走简单的路线，即仅使用 2 种从控件中设置/获取值的方法，则可以使用**FormView**（完全控件）或**DetailsView**（表格布局，但是你可以有自定义的html）。msdn 中有示例：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.aspx)和[http://msdn.microsoft.com/en-us/library/ system.web.ui.webcontrols.detailsview.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.aspx)。

它在 msdn 上时已不是什么秘密 ;)

正如您所提到的，您可以使用 asp.net 动态数据。如果您没有绑定到常规的 asp.net，在 asp.net mvc 上，您可以将对象放入从请求中的数据填充的控制器方法中，并且您有一个明确的方法来“绑定”您想要在看法。

我在一些项目中使用了 FormView 和 DetailsView 一段时间。它有效，但它并没有给你买那么多。现在我实际上一点也不喜欢它，主要是因为我不喜欢它引导你构建应用程序的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-20T15:19:17.643

除了 ASP.NET 中的网格和其他基于列表的控件之外，整个宇宙中似乎没有任何人数据绑定任何东西。无论是这样，还是那些确实受到公会约束的人都不能透露单记录数据绑定的奥秘。

如果没有人愿意分享，我会奖励自己这个推荐 ASP.NET 动态数据的答案，因为它是第一个全面涵盖细节和列表的主流技术。

# sharepoint - Sharepoint 工作流问题

> ID：1023682
> 
> 赞同：0
> 
> 时间：2009-06-21T11:10:44.597
> 
> 标签：sharepoint, workflow

我有自定义批准状态 machibe 工作流程，此工作流程附加到列表并启用在根据要求添加或更改任何项目时启动，当我的工作流程达到发布状态时，我编写自定义代码将其审核状态更改为已批准然后工作流程完成（项目状态将按我的意愿改变）但我的工作流程再次作为新实例开始的问题:(。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T14:55:47.373

如果我理解您的问题，您有一个从添加或更改开始的工作流程。但是在某些情况下，您不希望工作流程开始时项目发生更改。您无法在代码中启动工作流，因为您需要最终用户将您的工作流添加到自己的列表中。

唯一的选择是让工作流中的第一个活动检查工作流实例是否应该运行。如果不是，则退出工作流实例。如果您在 SharePoint Designer 中构建工作流并且没有此类活动，您可以在 Visual Studio 2008 中为此构建自定义活动，然后将其与 SharePoint Designer 一起使用。如果您在 Visual Studio 2008 中构建整个工作流，那么您可以在 Visual Studio 中创建一个自定义活动来使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T14:08:54.610

你有两个选择：

1）保持工作流在添加或更改时开始，并将活动添加到工作流的开始，检查审核状态，如果已经批准，则立即退出。

2) 让工作流从您编写的事件接收器中的代码开始，并在开始之前检查该项目。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-07-16T09:42:36.040

我创建了一个小解决方案来解决这个问题。我已经创建了直接重定向到最终状态的预最终状态。然后我在这种状态下创建一个自定义代码活动并制作它的代码：

```
Thread.Sleep(300); 
```

我的问题已解决:)

# php - 动态包括 php 脚本

> ID：1023684
> 
> 赞同：0
> 
> 时间：2009-06-21T11:13:02.593
> 
> 标签：php, include, require

我正在开发自己的 CMS，我想实现功能以动态包含位于服务器上的现有 PHP 脚本。

有一个名为 $page_content 的变量，其中包含页面内容，包括 HTML 和 JS 代码，还包含一些正则表达式识别的文本，然后处理识别的文本并替换为所需的动态创建的数据。我也想通过使用该正则表达式机制来触发包含新脚本，但这是一个问题，因为正则表达式识别是由函数解决的，而且似乎如果我在函数内执行“包含”或“要求”，则包含的脚本受函数变量的限制范围，所以我无法获得我需要的行为。

我应该怎么做才能使事情按我的意愿工作，我的意思是我可以更多地使用这些动态包含的脚本。

在此先感谢 MTH

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T11:37:32.640

听起来你在做危险的事情。您是否考虑过 HTML/JS（我假设是由您的 CMS 用户插入的）包含与您的正则表达式匹配的字符串的情况？

至于作用域问题：该函数[`compact()`](http://de.php.net/manual/en/function.compact.php)可以将当前作用域变量打包到一个数组中，并且[`extract()`](http://de.php.net/manual/en/function.extract.php)可以再次设置它们。但是在使用这些功能时要非常非常小心。您可能会意外覆盖您实际需要的其他变量。

```
function test($vars) {
    extract($vars);
    # The array might have contained the key 'vars', in which case
    # your function argument is now overwritten.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T11:32:42.493

看看 php extract 函数，它允许你将变量数组加载到你想要的范围内

[http://nz2.php.net/manual/en/function.extract.php](http://nz2.php.net/manual/en/function.extract.php)

```
ob_start();
extract($my_variables_array);
include $phpfile;
$output = ob_get_clean(); 
```

# c# - 为什么在 C# 中有 HashSet 而没有 Set？

> ID：1023697
> 
> 赞同：26
> 
> 时间：2009-06-21T11:21:18.257
> 
> 标签：c#, set, hashset

## 老问题

我的理解是C#在某种意义上`HashSet`和`set`类型。我明白是什么`HashSet`。但为什么`set`是一个单独的词？为什么不是每一套都是`HashSet<Object>`？

## 新问题

为什么C#没有泛型`Set`类型，类似于`Dictionary`类型？从我的角度来看，我想要一个具有标准查找/添加/删除性能的集合。我不太关心它是用哈希还是其他东西实现的。那么为什么不创建一个在这个版本的 C# 中实际实现为 a`HashSet`但在未来版本中可能有所不同的集合类呢？

或者为什么不至少 interface `ISet`？

# 回答

感谢以下回答的所有人：`ICollection`实现了很多您期望的`ISet`. 不过，从我的角度来看，虽然集合不一定是可枚举的——例如：1 到 2 之间的实数集（甚至可以动态生成集合）`ICollection`。`IEnumerable`我同意这是一个小小的抱怨，因为“普通程序员”很少需要不可数的集合。

好的，我想我明白了。`HashSet`绝对是要被调用`Set`的，但这个词`Set`在某种意义上是保留的。更具体地说，.NET 架构的创建者希望为不同的语言提供一致的类集（原文如此！）。这意味着标准类的每个名称都不能与 .NET 语言中的任何关键字重合。然而，在 VB.NET 中使用了这个词`Set`，它实际上是不区分大小写的（是吗？）所以不幸的是那里没有回旋余地。

谜团已揭开 ：）

# 结语

Alex Y. 的新答案链接到[MSDN 页面](http://msdn.microsoft.com/en-us/library/dd412081%28VS.100%29.aspx)，该页面描述了即将推出的 .NET 4.0 接口**`ISet`**，该接口的行为与我认为的差不多，并且由 .NET 实现`HashedSet`。好结局。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-21T11:54:16.350

（您最初的问题`set`已得到解答。IIRC，“set”是英语中含义最不同的词......显然这对计算也有影响。）

我认为有`HashSet<T>`这个名字很好，但我当然欢迎一个`ISet<T>`界面。鉴于`HashSet<T>`仅在 .NET 3.5 中出现（这本身就令人惊讶），我怀疑我们最终可能会获得更完整的基于集合的类型的集合。特别是，`LinkedHashSet`维护插入顺序的 Java 的等价物在某些情况下会很有用。

公平地说，该`ICollection<T>`界面实际上涵盖了您想要的大部分内容`ISet<T>`，所以也许这不是必需的。但是，您可能会争辩说，集合的核心目的（主要是关于包含，并且只是与能够迭代元素无关）与集合并不完全相同。这很棘手。事实上，一个真正的数学集合可能是不可迭代或不可数的——例如，你可以拥有“1 到 2 之间的实数集合”。如果您有一个任意精度的数字类型，那么计数将是无限的，并且迭代它没有任何意义。

同样，“添加”到集合的想法并不总是有意义的。命名集合时，可变性是一件棘手的事情:(

编辑：好的，回复评论：关键字`set`绝不是 Visual Basic 的遗产。它是*设置*属性值的操作，`get`而不是*检索*操作的操作。这与将集合作为操作的想法无关。

想象一下，关键字实际上是`fetch`and `assign`，例如

```
// Not real code!
public int Foo
{
    fetch
    {
        return fooField;
    } 
    assign
    {
        fooField = value;
    } 
} 
```

那里的目的明确吗？现在在 C# 中*真正的*等价物只是

```
public int Foo
{
    get
    {
        return fooField;
    } 
    set
    {
        fooField = value;
    } 
} 
```

所以如果你写：

```
x = y.Foo; 
```

这将使用`get`该属性的一部分。如果你写：

```
y.Foo = x; 
```

这将使用该`set`部分。

那是不是更清楚了？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-21T16:21:20.083

造成这种情况的唯一原因似乎是缺乏在 .NET 3.5 中理想地实现这一点的资源。

.NET 4.0 将包括[ISet](http://msdn.microsoft.com/en-us/library/dd412081(VS.100).aspx)以及除了[HashSet](http://msdn.microsoft.com/en-us/library/bb359438(VS.100).aspx) - [SortedSet](http://msdn.microsoft.com/en-us/library/dd412070(VS.100).aspx)之外的新实现。查看提供的 MSDN 库链接 - 它们已经在 .NET 4.0 beta1 中可用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-21T11:38:52.310

没有 Set `<T>`。这篇[BCL 团队博客文章](http://blogs.msdn.com/bclteam/archive/2006/11/09/introducing-hashset-t-kim-hamilton.aspx)有很多关于 HashSet 的详细信息，包括关于在名称中包含哈希的不完全决定性的讨论。我怀疑不是 BCL 团队中的每个人都喜欢使用名称 HashSet 的决定`<T>`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-21T11:49:54.877

`set`是自 1.0 版以来一直存在的 C# 语言关键字。Is 用于定义属性的赋值部分（`get`用于实现属性的值读取部分）。在这种情况下，您应该将“设置”一词理解为动词，就像设置值一样。

`HashSet<T>`是集合的数学概念的一种特殊实现。它最初是在 .NET 3.5 中引入的。BCL 团队的这篇博客文章解释了更多关于其背后的原因，以及为什么这个名字`HashSet<T>`不仅仅是这个名字的一些线索：http `Set<T>`: [//blogs.msdn.com/bclteam/archive/2006/11/09/introducing -hashset-t-kim-hamilton.aspx](http://blogs.msdn.com/bclteam/archive/2006/11/09/introducing-hashset-t-kim-hamilton.aspx)。

在这种情况下，`HashSet<T>`您应该将“集合”一词理解为名词。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-21T12:44:26.640

Set 是 VB.NET 中的保留关键字（相当于 C# 中的 set）。VB.NET 可以使用与关键字同名的类/方法/等，但它们必须写在方括号之间，这很难看：

```
Imports Wintellect.PowerCollections 'PowerCollections contains a class called Set'
Public Class Test
    Private _myValue As Integer  

    Public Property MyValue() As Integer
        Get
            Return _myValue
        End Get
        Set ' Set as keyword'
            _myValue = value
        End Set
    End Property

    Public Function X As [Set](Of Integer)
        Dim a As New [Set](Of Integer) ' Set as class'
        Return a
    End Function

End Class 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-21T11:41:09.777

啊，对了，我现在明白你的问题了
。不确定我能否 100% 看到对`ISet<T>`.
我想问题是你认为哪个是集合的基本行为？
是添加、删除、包含等吗？如果是，那么`ICollection<T>`已经为此提供了一个接口。
如果它是诸如 Union、Intersect 等设置操作，那么您认为这是否足够通用以抽象出合同样式的执行？

我不得不说我不知道​​这个问题的正确答案——我认为这是有争议的，我怀疑 BCL 团队最终可能会在未来的版本中加入类似的东西，但这取决于他们。我个人不认为它是大量缺失的功能

## 原帖

BCL 根本没有 Set 集合，至少据我所知没有。
.NET 3.5 中引入了一些像[Iesi.Collections](https://olex.openlogic.com/packages/iesi-collections)
`HashSet<T>`这样的第 3 方集合库，用于创建快速集合集合，即您想要一个没有重复的集合。它还具有典型的集合操作，例如 Union 和 Join。在 HashSet 上查看BCL 团队的[此链接](http://blogs.msdn.com/bclteam/archive/2006/11/09/introducing-hashset-t-kim-hamilton.aspx)

您通常会在以前必须使用的地方使用它，`List<T>`并在添加时检查重复项。
将项目添加到 a`HashSet<T>`也可以比 List[快得多](http://www.vcskicks.com/hashset.php)

一些进一步的细节：
HashSet 的另一个不错的功能是，如果您尝试添加重复项，它不会引发异常，它只是无法添加重复项，这使您不必在每个添加项周围放置大量 try.catch 块 - 很好:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-21T11:22:59.783

我很确定`Set<T>`BCL 中没有类，至少在 .NET 3.5 中（而且看起来也不是 .NET 4.0）。无论如何，您期望这样的课程需要什么？

`HashSet<T>`本身只是一个普通的集合数据结构，它使用哈希码（`GetHashCode`对象的方法）来比较元素。这只是实现集合类型的一种有效方式。（其他检查相等性的方法可能会降低性能。）

# java - 关于如何提高 Java String 到 byte[] 转换性能的任何建议？

> ID：1023701
> 
> 赞同：5
> 
> 时间：2009-06-21T11:24:17.657
> 
> 标签：java, performance, java-native-interface

我继承了一段代码，它大量使用 String -> byte[] 转换，反之亦然，用于一些自制的序列化代码。本质上，Java 对象知道如何将它们的组成部分转换为字符串，然后再转换为字节 []。然后，所述字节数组通过 JNI 传递到 C++ 代码中，该代码将 byte[] 重构为 C++ std::strings 并使用这些代码引导反映 Java 对象的 C++ 对象。还有更多内容，但这是这段代码如何工作的高级视图；通信在两个方向上都是这样工作的，因此 C++ -> Java 转换是我上面提到的 Java -> C++ 转换的镜像。

这段代码的一部分——将 String 实际转换为 byte[]——出乎意料地在分析器中显示为消耗大量 CPU。当然，有很多数据正在传输，但这是一个意想不到的瓶颈。

代码的基本大纲如下：

```
public void convertToByteArray(String convert_me, ByteArrayOutputStream stream)
{
  stream.write(convert_me.getBytes());
} 
```

该功能还有一点点，但不多。上面的函数会为每个 String/Stringified 对象调用一次，并且在将所有成分写入 ByteArrayOutputStream 之后，ByteArrayOutputStream 会转换为 byte[]。通过提取调用将上述内容分解为对分析器更友好的版本`convert_me.getBytes()`表明，此函数中超过 90% 的时间都花在了 getBytes() 调用中。

有没有办法提高 getBytes() 调用的性能，或者是否有另一种可能更快的方法来实现相同的转换？

正在转换的对象数量非常大。在仅使用一小部分生产数据的分析运行中，我看到对上述转换函数的调用超过 1000 万次。

由于我们非常接近将项目发布到生产环境中，因此目前无法采用一些解决方法：

*   重写序列化接口，只在 JNI 层传递字符串对象。这是改善情况的明显（对我而言）方法，但它需要对序列化层进行重大重新设计。鉴于我们将在本周早些时候进入 UAT，现在进行这种复杂的更改为时已晚。这是我下一个版本的首要任务，所以它会完成；然而，在那之前我确实需要一个解决方法，但到目前为止代码正在运行，已经使用了多年并且大部分问题都解决了。好吧，除了表演。
*   更改 JVM（当前为 1.5）也不是一种选择。不幸的是，这是安装在客户端机器上的默认 JVM，很遗憾无法更新到 1.6（在这种情况下可能会更快，也可能不会更快）。任何在大型组织工作过的人都可能明白为什么...
*   除此之外，我们已经遇到了内存限制，因此尝试缓存至少较大的字符串及其字节数组表示，虽然是一个潜在的优雅解决方案，但可能会导致比它解决的问题更多的问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T11:36:00.927

我猜问题的一部分可能是Java字符串是UTF-16格式——即每个字符两个字节；做`getBytes()`一堆工作将每个 UTF-16 元素转换为一个或两个字节，这取决于您当前的字符集。

您是否尝试过使用[CharsetEncoder](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/charset/CharsetEncoder.html) - 这应该可以让您更好地控制字符串编码，并允许您跳过默认`getBytes`实现中的一些开销。

或者，您是否尝试过将字符集明确指定为`getBytes`，并使用*US-ASCII*作为字符集？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T19:19:30.550

我看到几个选项：

*   如果你有 Latin-1 字符串，你可以只拆分字符串中字符的高字节（我认为 Charset 也这样做）*   如果您有更多内核，您还可以在多个内核之间拆分工作（fork-join 框架曾经向后移植到 1.5）*   您还可以将数据构建到字符串构建器中，最后只将其转换为字节数组一次。*   查看您的 GC/内存使用情况。由于频繁的 GC 中断，过多的内存使用可能会减慢您的算法速度

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T14:35:39.457

如果它是您一直转换的相同字符串，您可以将结果缓存在 WeakHashMap 中。

另外，请查看 getBytes() 方法（如果您安装了 SDK，则可以使用源代码）以了解它的具体作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-08T22:04:21.683

问题是，即使在今天，Java 中的所有方法都使用 UTF-8 产生式分配内存。要获得编码性能，您需要编写自定义代码并重用 byte[] 缓冲区。Colfer 可以生成代码或只是简单地复制其实现。

[https://github.com/pascaldekloe/colfer/blob/4c6f022c5183c0aebb8bc73e8137f976d31b1083/java/gen/O.java#L414](https://github.com/pascaldekloe/colfer/blob/4c6f022c5183c0aebb8bc73e8137f976d31b1083/java/gen/O.java#L414)

# c# - 如何在 C# 中挂钩多个窗口？

> ID：1023702
> 
> 赞同：0
> 
> 时间：2009-06-21T11:24:41.447
> 
> 标签：c#, windows, winforms, hook, transparent

我正在尝试创建一个应用程序，使窗口（应用程序外部）在失去焦点时透明。大多数事情（获取窗口 id、设置透明等）都很容易，除了一件事 - 我如何挂钩窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T11:35:16.387

您可以使用互操作。使用[SendMessage()](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)函数向您的窗口发送自定义消息。一旦您收到该消息以更改其透明度，该窗口就可以调用[SetLayeredWindowAttributes() 。](http://msdn.microsoft.com/en-us/library/ms633540(VS.85).aspx)

另一件事是你真的应该能够通过监听[WM_KILLFOCUS使窗口在失去焦点时变为透明](http://msdn.microsoft.com/en-us/library/ms646282(VS.85).aspx)

编辑：

锁定 C# 中的 Deactivate 和 Activated 事件。

```
    私人无效Form1_Deactivate（对象发送者，EventArgs e）
    {
      this.Opacity = 0.5 ;
    }

    私人无效Form1_Activated（对象发送者，EventArgs e）
    {
      this.Opacity = 1.0 ;
    }

```

# sql - SQL 分组：用户之间的最新记录

> ID：1023704
> 
> 赞同：2
> 
> 时间：2009-06-21T11:26:01.303
> 
> 标签：sql, grouping

也许我今天过得很糟糕，但有人可以帮我扭转这个局面：

```
MessageID | SendingUserID | ReceivingUserID
-------------------------------------------
1073      | 1002          | 1001
1065      | 1001          | 1002
1076      | 1008          | 1002 
```

进入：

```
MessageID | SendingUserID | ReceivingUserID
-------------------------------------------
1073      | 1002          | 1001
1076      | 1008          | 1002 
```

因此，仅列出两个用户之间的最新消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T11:45:17.973

试试这个：

```
SELECT Message.*
FROM Message
WHERE Message.MessageID IN
(SELECT MAX(MessageID) FROM Message 
    GROUP BY 
        CASE WHEN ReceivingUserID > SendingUserID 
            THEN ReceivingUserID ELSE SendingUserID END,
        CASE WHEN ReceivingUserID > SendingUserID
            THEN SendingUserID ELSE ReceivingUserID END
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T11:56:14.740

独家自加入方法：

```
select *
from YourTable a
left join YourTable b 
    on (
        (a.SendingUserID = b.SendingUserID
        and a.ReceivinggUserID = b.ReceivingUserID)
        or (a.SendingUserID = b.ReceivingUserID
        and a.ReceivinggUserID = b.SendingUserID)
    ) and b.messageid > a.messageid
 where b.messageid is null 
```

“b”上的加入搜索相同用户之间的后续消息。WHERE 子句过滤没有后续消息的消息。这只会为您提供每对用户之间的最新消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T13:17:37.493

您可以在 SQL Server 2005 及更高版本中使用 CTE（公用表表达式）来确保两个 UserID 始终是较小的，然后是较大的，然后为每个组合获取最大值：

```
WITH Messages(MessageID, User1, User2)
AS 
(
    SELECT
        MessageID,
        CASE 
          WHEN SendingUserID < ReceivingUserID
          THEN SendingUserID
          ELSE ReceivingUserID 
        END as 'User1',
        CASE 
          WHEN SendingUserID < ReceivingUserID
          THEN ReceivingUserID 
          ELSE SendingUserID
        END as 'User2'
    FROM 
        MyMessages
)
SELECT 
    MessageID, User1, User2 
FROM 
    Messages m1
WHERE
    MessageID = (SELECT MAX(MessageID) FROM  Messages m2 
                 WHERE m1.User1 = m2.User1 AND m1.User2 = m2.User2) 
```

CTE 内部的 SELECT 会像这样“排序”您的消息：

```
MessageID   User1   User2
  1065       1001    1002
  1073       1001    1002
  1076       1002    1008 
```

and the outer `SELECT` based on this CTE then just simply picks the entry with the maximum `MessageID` for every combination of (User1, User2).

Marc

# javascript - 需要一个可靠的替代 String.fromCharCode

> ID：1023708
> 
> 赞同：2
> 
> 时间：2009-06-21T11:28:35.747
> 
> 标签：javascript

```
function randomString( len ) {
  // A random string of length 'len' made up of alphanumerics.
  var out = '';
  for (var i=0; i<len; i++) {
      var random_key = 48 + Math.floor(Math.random()*42); //0-9,a-z
      out += String.fromCharCode( random_key );
  }
  window.alert(out);
  return out;
} 
```

据我所知，结果`String.fromCharCode`取决于系统和/或浏览器。我看到的所有解决方法都是针对您实际捕获键码而不是生成键码的情况。有没有更可靠的方法来做到这一点（比如从 ASCII 码转换？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T11:46:25.040

> var random_key = 48 + Math.floor(Math.random()*42); //0-9,az

代码和注释不对应。可以创建的字符范围为 0-9、:、;、<、=、>、?、@ 和 AZ。

此范围内的字符代码在 ASCII 字符集中，因此它们对于所有常用的西方字符集都是相同的。fromCharCode 方法应该使用您为页面指定的字符集，但在您使用的范围内并不重要。

缩小范围 7，如果不是数字则加 39 得到 0-9 和 az：

```
function randomString(len) {
   // A random string of length 'len' made up of alphanumerics.
   var out = '';
   for (var i=0; i<len; i++) {
      var random_key = 48 + Math.floor(Math.random() * 36);
      if (random_key > 57) random_key += 39;
      out += String.fromCharCode(random_key);
   }
   window.alert(out);
   return out;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-27T16:15:56.103

这是一些部分替代方案[，](https://jsfiddle.net/Lamik/zr2vbfjh/)可让您获得`0-1`和`a-z`

```
let l= 30483235087530204251026473460499750369628008625670311705n.toString(36)

console.log(l[26], l[0], l[25].toUpperCase(), l);
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-02T03:09:43.647

对于那些现在在这里并想要替代 的人`String.fromCharCode()`，请使用`TextDecoder()`。下面是一个例子：

```
//This gives back the String "Different" an unusual way
new TextDecoder().decode(new Uint8Array([68, 105, 102, 102, 101, 114, 101, 110, 116]));

//This gives back the String "Different" the usual way
String.fromCharCode(68, 105, 102, 102, 101, 114, 101, 110, 116); 
```

可能还有其他一些方法可以实现这一点，但我注意到没有一个答案真正回答了标题的问题。所以……给你。

# windows - 如何在 Windows 上安装和使用 ack 库？

> ID：1023710
> 
> 赞同：70
> 
> 时间：2009-06-21T11:29:09.550
> 
> 标签：windows, perl, ack

我从未使用过 Perl，但[ack](http://www.betterthangrep.com)给我留下了深刻的印象，我想将其用于源代码搜索等。

谁能指导我如何在 Windows 上使用这个优秀的库？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-06-21T11:38:09.813

首先安装 perl [http://strawberryperl.com/](http://strawberryperl.com/)

通过键入（在 Windows 命令外壳中）安装[App::Ack](http://search.cpan.org/~petdance/ack-1.88/)

```
C:\>cpan App::Ack 
```

毫无疑问，这将证明是有用[的 http://learn.perl.org/](http://learn.perl.org/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-11-30T14:00:45.900

并非所有测试都能在所有版本的 Windows 上通过。即使安装测试失败，您也很可能从 ack 获得 100% 的功能。如果失败的测试阻止正常安装，这是强制安装的命令：

```
perl -MCPAN -e "CPAN::Shell->force(qw(install App::Ack));" 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-01-25T10:52:53.923

如果你已经安装了 msysgit，那么你不需要安装 Perl，因为你已经有了一个版本。您只需要下载[ack 的独立版本](http://betterthangrep.com/ack-standalone)并将其放在您的 bash 路径¹中的某个位置。然后，您可以从您的 msysgit bash 提示符运行 ack。

如果您还希望能够从 Windows 命令提示符运行 ack，那么您需要在 Windows 路径²中的某处创建一个批处理脚本，其内容为：

```
@"C:\Program Files\Git\bin\perl" C:\path\to\ack-standalone.pl %* 
```

（您显然需要编辑上面的路径以匹配您的 msysgit 安装和放置 ack 脚本的位置。）

[1：我只是把我的卡在 mysysgit bin 目录中：`C:\Program Files\Git\bin\ack`. 这不是最明智的位置，但它确实有效。
2：同样，我刚刚`ack.bat`在 msysgit bin 目录中创建了文件`C:\Program File\Git\bin`。]

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-10-18T17:31:10.960

如果你安装了 cygwin，你可以简单地下载独立版本。Perl 与 cygwin 一起安装。以下是步骤：

```
$ vim .bash_profile 
```

删除行中的注释：

```
# if [ -d "${HOME}/bin" ] ; then
#  PATH="${HOME}/bin:${PATH}"
# fi 
```

加载更改：

```
$ source .bash_profile 
```

创建一个 bin 目录：

```
$ mkdir ~/bin 
```

下载ack（来自主页）：

```
$ curl https://beyondgrep.com/ack-2.22-single-file > ~/bin/ack && chmod 0755 ~/bin/ack 
```

**注意：**您必须手动安装 curl，因为默认情况下 cygwin 不附带它。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-12-28T19:29:52.867

您还应该运行以下命令来启用颜色突出显示： **cpan Win32::Console::ANSI**

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-03-26T23:50:36.760

`App::Ack`由于某些测试未通过，我不得不强制安装 cpan ：

```
C:\> cpan
cpan> force install App::Ack
cpan> q 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-07-26T06:23:50.797

没有什么对我有用，直到我去 ack 网站看到这个。

[![在此处输入图像描述](../Images/329831e6cf0cb54f3d2543d8e81c6b67.png)](https://i.stack.imgur.com/Thpud.png)

我在 cmd 提示符下运行了以下命令：

```
choco install ack 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-19T19:36:37.123

根据您对从开源项目安装预构建二进制文件的感受，您还可以考虑使用 Silver Searcher (ag)。它与 ack 兼容并且比 ack 更快。它也可以从最近发行版的存储库中的 Linux 上获得。

[http://blog.kowalczyk.info/software/the-silver-searcher-for-windows.html](http://blog.kowalczyk.info/software/the-silver-searcher-for-windows.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-13T10:19:50.130

您可以通过 cpan 安装 ack：

安装草莓perl

以管理员身份运行 cmd

安装确认：

cpan> 强制安装 App::Ack

它应该从那里开始工作，遵循本指南： http: [//www.jeedo.net/how-to-install-ack-on-windows-10/](http://www.jeedo.net/how-to-install-ack-on-windows-10/)

工作顺利。

# asp.net - 有没有办法使用 ASP.NET 代码隐藏将 Silverlight XAML 插入我的页面？

> ID：1023711
> 
> 赞同：0
> 
> 时间：2009-06-21T11:29:20.970
> 
> 标签：asp.net, ajax, silverlight, xaml

所以，我想从我的 ASP.NET 网页上的一些数据创建一些 Silverlight 图表。使用[Visifire](http://visifire.com)（我目前的东西）或即将推出的[Silverlight 图表](http://www.jeff.wilcox.name/2008/12/charting-rich-tooltips/)的方法似乎是创建一些 XAML，或至少创建一些 Silverlight 对象（[如在这个 Visifire 示例中](http://visifire.com/documentation/Visifire_Documentation/Samples/Silverlight/Silverlight_Sample.htm)），然后以某种方式将它们填充到页面中.

奇怪的是，这样做的唯一方法似乎是通过 JavaScript！也就是说，我必须做这样的事情：

用户 -> 单击按钮 -> JavaScript 事件处理程序 -> AJAX 调用以从服务器端方法获取 XAML -> 将 XAML 字符串填充到客户端 HTML[中（通常](http://weblogs.asp.net/palermo4/archive/2007/11/02/video-interactive-silverlight-using-ajax.aspx)像这样或[对于 Visifire 特定的方法这样](http://visifire.com/documentation/Visifire_Documentation/Samples/Silverlight/ASP.Net_Code_Example.htm)） .

这是非常违反直觉的！我更想要的是能够在里面做这样的事情`MyPage.aspx.cs`：

```
protected void MyButton_Click(object sender, EventArgs e)
{
    this.MyFictionalSilverlightControl.Xaml = this.GenerateXamlFromData();
} 
```

那会好很多！尽管效率低下，但我很乐意保留`MyFictionalSilverlightControl`在中；`UpdatePanel`我只是希望我知道如何制作这样一个虚构的 Silverlight 控件。

有任何想法吗？或者关于如何更好地做到这一点的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-27T17:21:32.030

我建议采用更 AJAXy 的方法：让 JS 请求 XAML，然后在从服务器返回 XAML 后，运行时将该 XAML 插入到控件中（请参阅 HTML 桥）。这样，您的控件可以对新显示进行很好的动画/过渡。

不过，你可以做你的目标：

*   将[Silverlight 服务器控件](http://msdn.microsoft.com/en-us/library/cc838274(VS.95).aspx)添加到您的更新面板中。
*   编写一个 aspx 页面以生成 XAML（更改 DocType 以使事情变得更容易）
*   将 Silverlight 服务器控件指向 .ASPX 页面：

    ... asp:Silverlight ID="Xaml1" runat="server" Source="~/ClientBin/myXAMLPage.aspx" MinimumVersion="2.0.30523" Width="100%" Height="100%">

*   每当用户单击您的按钮时，触发 UpdatePanel 来执行此操作。

现在，每当用户单击按钮时，将呈现更新面板（包含 Silverlight 控件），并且该 SL 控件将请求 XAML 文件并呈现它找到的内容。

请注意，此方法使用 XAML 文件实例化控件。这意味着您将无法在 Silverlight 中使用托管代码。如果您需要托管代码，而不是在源中指定“myXAMLPage.aspx”页面，而是指定您的 .xap 文件，然后使用 initparam 指定“myXAMLPage.aspx”。在您的 Silverlight 应用程序中，下载 xaml 文件（WebClient 或其他），然后使用 XamlReader.Load 加载并显示它。

hth，埃里克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T12:46:11.330

我建议您下载 ASP.NET Silverlight Server Control。可以在[此处找到有关此控件的更多信息。](http://msdn.microsoft.com/en-us/library/cc838274(VS.95).aspx)通常，您将编译后的 XAM 文件放在 BIN 目录中，然后将 XAML 链接到 asp:Silverlight 控件。他负责其余的事情。此外，可以使用 asp:Silverlight 的输入参数集合将一些参数传递给 Silverlight。这是一种繁琐的方法，但它确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T13:14:26.210

我可能是错的 - 作为 WPF 开发人员而不是 SilverLight 开发人员来回答这个问题，但在 WPF 中，您可以在代码中创建控件并将其插入到 XAML 中。

```
Label myLabel = new Label(); // Create a new control
myLabel.Text = "Hello Wirral"; // Change some of its properties
MyContainingPanel.Children.Add(myLabel); // Add it to an existing container 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T22:58:33.913

真正简单的解决方案是也只在 silverlight 中进行表格/数据表示。然后使用网络服务将数据提供给您的 silverlight 应用程序。

我确信 MS 完全赞同这一点。

否则（你要求它;）：

您提供的理想解决方案的问题是 ASP.Net 的抽象隐藏了双重发布数据的现实以及在客户端 Silverlight 应用程序可以完美完成时在服务器上构建客户端界面本身：

第 1 步 - 将嵌入数据的 html 发送到客户端

第 2 步 - 初始化客户端应用程序（silverlight 应用程序）

第 3 步 - 按下按钮调用服务器上的 GenerateXamlFromData

第 4 步 - 获取与第 1 步相同的数据，然后从中创建一些 Xaml

第 5 步 - 将其传回浏览器

第 6 步 - 在 Silverlight 应用程序中调用方法来设置 Xaml

步骤 3-5 完全是多余的。在客户端上，您已经拥有数据和能够动态创建图表的东西，silverlight 应用程序。

如果表绝对要求为 html，我将解决它的方法是：

使您的数据非 html。使用 XML/XSLTransform、JSON/javascript/JQuery 或任何您喜欢的客户端转换来呈现它。网络服务，随便。关键是你打开你的网页，http 回传数据并动态创建你的 html 表。然后将相同的数据传递给您的 silverlight 应用程序并让它创建图表。

您的 silverlight 应用程序可以通过简单的对象创建来动态构建图表。如果您真的喜欢用铅笔戳自己的眼睛，您仍然可以动态构建 Xaml 字符串并使用这些字符串来创建图表对象，这是获得 Xaml-Nazi 的 StackOverflow 徽章的简单方法

您的问题还有另一种解决方案，如果您真的想要，您可以将 Sivlerlight 应用程序传递给 html 表 dom 并从中提取数据。一般来说，除非你做了一些非常愚蠢的符合 XML 的 html 表，否则只需将其加载到 XDocument 中。

至于你描述的简单方式，afaik不可能atm。也许有一天会，但老实说，它永远不会是一个好的解决方案，它只会成为那些想要将快速而肮脏的应用程序组合在一起的人的解决方案。

# javascript - 如何制作类似“webmail”的文件附加/上传

> ID：1023714
> 
> 赞同：1
> 
> 时间：2009-06-21T11:32:56.110
> 
> 标签：javascript, ajax, file, uploading

我想用各种网络邮件界面中常见的行为来实现文件上传。我的意思是通过打开文件对话框选择附件（一个或多个），然后它们的名称出现在（例如）带有消息正文的文本区域下。并且只有添加附件并在提交表单时上传的信息。我知道它可能会包括 AJAX 一些服务器端脚本，但我完全不知道在哪里以及如何搜索这种机制的示例。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T13:00:23.923

请参阅[is-it-possible-to-ajax-a-file-upload](https://stackoverflow.com/questions/543926/is-it-possible-to-ajax-a-file-upload)。

标准浏览器 + Javascript 是不够的，需要额外的帮助。浏览器插件`flash`和服务器端支持的组合。在应用程序正在使用（或考虑）的 Web 框架中寻找解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T11:36:10.973

AJAX 不是必需的，Javascript 也不是。只有一个带有`<input type="file">`. 您的服务器必须处理结果，但这显然取决于您使用的语言。

# c# - 局域网中的客户端-服务器（Web-服务器）应用程序 - 应该注意代理吗？

> ID：1023715
> 
> 赞同：1
> 
> 时间：2009-06-21T11:33:24.473
> 
> 标签：c#, proxy, client-server

在 LAN 中，ASP .NET Web 应用程序充当服务器。它内部托管在组织的 Web 服务器上。

可以访问它 - 像这样说 - [http://192.168.0.23/myApp](http://192.168.0.23/myApp)

客户端是需要不断与服务器交互的桌面应用程序（驻留在 Intranet 上的 Web 应用程序）

考虑到这是一个 LAN 设置，并且来自客户端的请求并没有完全发送到互联网 - 客户端是否应该能够处理基于代理的连接？

含义 - 假设客户端使用代理连接到互联网，如果客户端的应用程序向[http://192.168.0.23/myApp](http://192.168.0.23/myApp)发送 WebRequest ，请求是否应该使用代理设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T11:37:47.460

我建议不要，但这不会有任何区别。代理只会增加开销，如果应用程序提供动态内容，它将几乎没有用处。

就应用程序而言，它不会关心代理是在访问它，还是直接访问客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T15:51:58.453

您应该设计您的应用程序，以便您不需要了解任何有关网络基础设施的信息。这样，网络基础设施就可以改变，而无需任何人先告诉你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T15:57:29.810

我认为您不需要获取代理详细信息。对于 Intranet 服务器应用程序，代理详细信息将无关紧要，因为客户端将对您的应用程序具有内部 LAN 访问权限，从而使代理设置无关紧要。

如果我错了，请纠正我。谢谢。

# python - 平滑不规则采样的时间数据

> ID：1023719
> 
> 赞同：6
> 
> 时间：2009-06-21T11:36:57.383
> 
> 标签：python, datetime, data-mining, smoothing

给定一个表格，其中第一列是某个参考点后的秒数，第二列是任意测量值：

```
6   0.738158581
21  0.801697222
39  1.797224596
49  2.77920469
54  2.839757536
79  3.832232283
91  4.676794376
97  5.18244704
100 5.521878863
118 6.316630137
131 6.778507504
147 7.020395216
157 7.331607129
176 7.637492223
202 7.848079136
223 7.989456499
251 8.76853608
278 9.092367123 
    ... 
```

如您所见，测量是在不规则的时间点进行采样的。我需要通过平均每次测量前 100 秒的读数（在 Python 中）来平滑数据。由于数据表很大，因此确实首选基于迭代器的方法。不幸的是，经过两个小时的编码，我无法找到有效而优雅的解决方案。

谁能帮我？

**编辑**_

1.  我希望每个原始读数都有一个平滑读数，并且平滑读数是原始读数和前 100（增量）秒内任何其他读数的算术平均值。（约翰，你是对的）

2.  巨大的 ~ 1e6 - 10e6 行 + 需要使用紧凑的 RAM

3.  数据近似随机游走

4.  数据已排序

# 解析度

我已经测试了 J Machin 和 yairchu 提出的解决方案。他们都给出了相同的结果，但是，在我的数据集上，J Machin 的版本呈指数增长，而 yairchu 的版本是线性的。以下是由 IPython 的*%timeit*测量的执行时间（以微秒为单位）：

```
data size   J Machin    yairchu
10        90.2        55.6
50          930         258
100         3080        514
500         64700       2660
1000        253000      5390
2000        952000      11500 
```

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T13:17:51.487

我正在使用一个求和结果，我将添加新成员并减去旧成员。然而，以这种方式，人们可能会遭受累积的浮点不准确性。

因此我用一个列表实现了一个“双端队列”。每当我的双端队列重新分配到更小的大小时。我在同一场合重新计算总和。

我还在计算直到点 x 的平均值，包括点 x，所以至少有一个样本点需要平均。

```
def getAvgValues(data, avgSampleTime):
  lastTime = 0
  prevValsBuf = []
  prevValsStart = 0
  tot = 0
  for t, v in data:
    avgStart = t - avgSampleTime
    # remove too old values
    while prevValsStart < len(prevValsBuf):
      pt, pv = prevValsBuf[prevValsStart]
      if pt > avgStart:
        break
      tot -= pv
      prevValsStart += 1
    # add new item
    tot += v
    prevValsBuf.append((t, v))
    # yield result
    numItems = len(prevValsBuf) - prevValsStart
    yield (t, tot / numItems)
    # clean prevVals if it's time
    if prevValsStart * 2 > len(prevValsBuf):
      prevValsBuf = prevValsBuf[prevValsStart:]
      prevValsStart = 0
      # recalculate tot for not accumulating float precision error
      tot = sum(v for (t, v) in prevValsBuf) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T12:48:04.383

你还没有确切地说出你想要输出的时间。我假设您希望每个原始读数都有一个平滑读数，并且平滑读数是原始读数和前 100（增量）秒内的任何其他读数的算术平均值。

简短的回答：使用 collections.deque ......它的读数永远不会超过“delta”秒。按照我的设置方式，您可以将 deque 视为列表，并轻松计算平均值或一些花哨的 gizmoid，这些 gizmoid 对最近的读数具有更大的权重。

长答案：

```
>>> the_data = [tuple(map(float, x.split())) for x in """\
... 6       0.738158581
... 21      0.801697222
[snip]
... 251     8.76853608
... 278     9.092367123""".splitlines()]
>>> import collections
>>> delta = 100.0
>>> q = collections.deque()
>>> for t, v in the_data:
...     while q and q[0][0] <= t - delta:
...         # jettison outdated readings
...         _unused = q.popleft()
...     q.append((t, v))
...     count = len(q)
...     print t, sum(item[1] for item in q) / count, count
...
...
6.0 0.738158581 1
21.0 0.7699279015 2
39.0 1.112360133 3
49.0 1.52907127225 4
54.0 1.791208525 5
79.0 2.13137915133 6
91.0 2.49500989771 7
97.0 2.8309395405 8
100.0 3.12993279856 9
118.0 3.74976297144 9
131.0 4.41385300278 9
147.0 4.99420529389 9
157.0 5.8325615685 8
176.0 6.033109419 9
202.0 7.15545189083 6
223.0 7.4342562845 6
251.0 7.9150342134 5
278.0 8.4246097095 4
>>> 
```

**编辑**

一站式商店：在这里获取您喜欢的小工具。这是代码：

```
numerator = sum(item[1] * upsilon ** (t - item[0]) for item in q)
denominator = sum(upsilon ** (t - item[0]) for item in q)
gizmoid = numerator / denominator 
```

其中 upsilon 应该略小于 1.0（<= 零是非法的，略高于零几乎没有平滑，一个得到算术平均值加上浪费的 CPU 时间，大于 1 则与您的目的相反）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T12:50:36.250

您的数据似乎大致呈线性：

[绘制您的数据 http://rix0r.nl/~rix0r/share/shot-20090621.144851.gif](http://rix0r.nl/~rix0r/share/shot-20090621.144851.gif)

你在寻找什么样的平滑？一条线与该数据集的最小二乘拟合？某种低通滤波器？或者是其他东西？

请告诉我们应用程序，以便我们可以为您提供更好的建议。

编辑：例如，根据应用程序，在第一个点和最后一个点之间插入一条线可能足以满足您的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T14:02:32.080

这使它成为线性：

```
def process_data(datafile):
    previous_n = 0
    previous_t = 0
    for line in datafile:
        t, number = line.strip().split()
        t = int(t)
        number = float(number)
        delta_n = number - previous_n
        delta_t = t - previous_t
        n_per_t = delta_n / delta_t
        for t0 in xrange(delta_t):
            yield previous_t + t0, previous_n + (n_per_t * t0)
        previous_n = n
        previous_t = t

f = open('datafile.dat')

for sample in process_data(f):
    print sample 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T14:46:42.460

O(1) 内存，以防您可以多次迭代输入 - 您可以将一个迭代器用于“左”，一个用于“右”。

```
def getAvgValues(makeIter, avgSampleTime):
  leftIter = makeIter()
  leftT, leftV = leftIter.next()
  tot = 0
  count = 0
  for rightT, rightV in makeIter():
    tot += rightV
    count += 1
    while leftT <= rightT - avgSampleTime:
      tot -= leftV
      count -= 1
      leftT, leftV = leftIter.next()
    yield rightT, tot / count 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-23T00:51:54.027

虽然它给出了一个指数衰减的平均值，而不是一个总平均值，但我认为你可能想要我所说的[具有不同 alpha 的指数移动平均值](https://stackoverflow.com/questions/1023860/exponential-moving-average-sampled-at-varying-times)，它实际上是一个单极低通滤波器。这个问题现在有了一个解决方案，它的运行时间与数据点的数量成线性关系。看看它是否适合你。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-21T11:50:55.920

像这样的东西呢，继续存储值直到与上次的时间差> 100，平均并产生这样的值，例如

```
def getAvgValues(data):
    lastTime = 0
    prevValues = []
    avgSampleTime=100

    for t, v in data:
        if t - lastTime < avgSampleTime:
            prevValues.append(v)
        else:
            avgV = sum(prevValues)/len(prevValues)
            lastTime = t
            prevValues = [v]
            yield (t,avgV)

for v in getAvgValues(data):
    print v 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-06-21T14:13:38.657

听起来你需要一个简单的舍入公式。要将任何数字四舍五入到任意间隔：

轮次（次数/间隔）*间隔

您可以用地板或天花板代替圆形来代替“导致”或“因为”影响。它可以用任何语言工作，包括 SQL。

# regex - 匹配 Lua 的“长括号”字符串语法

> ID：1023722
> 
> 赞同：0
> 
> 时间：2009-06-21T11:37:55.133
> 
> 标签：regex, lua, lexer, jflex

我正在为 Lua 编写一个 jFlex 词法分析器，并且在设计正则表达式以匹配语言规范的一个特定部分时遇到问题：

> 文字字符串也可以使用长括号括起来的长格式来定义。我们将第 n 级的左长括号定义为一个左方括号，后跟 n 个等号，然后是另一个左方括号。因此，级别 0 的左长括号写为 [[，级别 1 的左长括号写为 [=[，依此类推。闭合长括号的定义类似；例如，第 4 级的右长括号写为]====]。长字符串以任何级别的左长括号开始，并在同一级别的第一个右长括号结束。这种括号形式的文字可以运行多行，不解释任何转义序列，并忽略任何其他级别的长括号。它们可以包含除适当级别的右括号之外的任何内容。

简而言之，我正在尝试设计一个正则表达式，它将匹配一个开始的长括号、中间的字符串内容和结束的长括号。只有当开始长括号和结束长括号具有相同数量的等号（可以是零或更多）时，才会发生匹配。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-22T05:27:10.647

好吧，恐怕用正则表达式进行标记对这项任务来说还不够好。正则表达式还不够强大。

没有办法在 jFlex 中使用普通的正则表达式来比较 '=' 标记的数量。Perl 会为此提供一个技巧（如上面建议的 \1 ），但我们不是在谈论编程 Perl，而是在谈论 jFlex 词法分析器。

解决方案是使用 \[=*\[ 作为左括号标记，使用 \]=*\] 作为右括号标记，然后在上面的层（解析器）中比较它们的长度是否匹配。

无论如何，您可以查看 llex.c 中的 lua 源代码中的 read_long_string() ，看看他们是如何在完全不使用正则表达式的情况下做到这一点的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T12:07:34.403

```
\[(=*)\[.*?\]\1\] 
```

\1 捕获第一个 ()。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T12:07:59.723

```
\[(=*)\[.*?\]\1\] 
```

# html - 为 WSDL 生成 html 以测试 api？

> ID：1023724
> 
> 赞同：2
> 
> 时间：2009-06-21T11:38:47.223
> 
> 标签：html, web-services

是否有任何工具可以读取 WSDL 文件并根据输入消息定义生成可用于指定输入和调用 api 的 html 页面。我在输入消息中没有很多复杂类型。

我需要它来为服务构建一些测试 UI。

如果我不能转换整个 WSDL，创建 html 标签的 XSD 解析器会很棒

谢谢阿文德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T11:59:10.677

我不知道创建 HTML 页面的任何工具，但如果您想测试 WSDL / SOAP Web 服务，我建议您使用[SoapUI](http://www.soapui.org)。他们有免费版和专业版，甚至免费版已经非常好用了！

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-10T13:27:07.550

只读文档的一个很好的选择是：[http ://tomi.vanek.sk/index.php?page=wsdl-viewer](http://tomi.vanek.sk/index.php?page=wsdl-viewer)

# delphi - 如何列出所有实例化的对象？

> ID：1023727
> 
> 赞同：1
> 
> 时间：2009-06-21T11:39:12.713
> 
> 标签：delphi, memory, delphi-7, fastmm

如何使用 FASTMM4 或默认内存管理器列出所有应用程序中的所有实例化对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T12:59:14.707

您可能可以使用 FastMM4 执行此操作，但这会很复杂。尝试检查过程 ScanForMemoryLeaks 的代码，看看它是如何完成的。

此例程根据预期的内存泄漏列表检查所有分配的堆内存，并报告显示的所有内容，包括计数和对象类名称（如果找到对象）。您要做的是检查所有分配的堆内存并报告您找到的所有对象的计数和对象类名称，因此这是一项非常相似的任务。只需省略注册指针列表检查并过滤掉所有不是对象的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T19:37:13.477

好吧，它不支持也不鼓励，但根据您的情况，您可能能够编辑 TObject 以记录创建和销毁 - 因为所有对象都是 TObject 这可能会奏效。然而，修改 VCL 真的很不受欢迎，所以我想知道你是否可以使用 Helper 对象（我认为自 2006 年以来可用）来做同样的事情。将创建的每个对象的详细信息写入另一个列表等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T08:10:17.510

您可以通过调用 SetMemoryManager 来更改内存管理器。您可以编写自己的 MM，这将是一个简单的存根：它将所有调用重定向到旧 MM（即 FastMM，您可以通过调用 GetMemoryManager 获取）并在某处记录所有内存操作。您可以通过查看调用堆栈来检测对象的创建/销毁：应该从 TObject 的 NewInstance 方法进行调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T05:37:18.427

实现 Tony Allen 建议的一种有趣方式可能是在运行时挂钩对象创建和销毁方法。Google Code 上有一个有趣的库，它是 AsmProfiler 项目的一部分（恕我直言，这是一项非常好的工作），它可能会起到作用。这是完成所有繁重工作的[KOLDetours单元的链接。](http://code.google.com/p/asmprofiler/source/browse/trunk/SRC/KOLDetours.pas)

FWIW 我在 Delphi 4/5 天实现了一个框架，其中包含一个检测基类，该基类可以选择跟踪对象的创建/销毁。这对于追踪对象泄漏等非常有效，但会产生大量信息。如果您只需要知道关闭时泄漏了哪些对象，FASTMM4 是一个更好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-30T23:48:25.473

这是一个应该有所帮助的想法，没有完全尝试过，但它会让你走得更远：

按以下方式编写类助手：

1.  使用构造函数编写一个通用的 Tobject 类助手。

2.  为覆盖其构造函数的类编写自定义/特定类帮助器。

3.  使用自由方法编写通用 Tobject 类助手。

4.  为覆盖其免费方法的类编写自定义/特定类帮助器。

5.  最后检查所有代码是否调用 .Free，如果不将其从 .Destroy 更改为 .Free。如果您希望从列表中删除所有对象。

6.  在您想要列出的每个单元中包含带有类助手的单元。

7.  还要在该单元中创建全局列表。

在构造函数中简单地写

继承创建；

GlobalObjectList.Add（自我）；

在免费方法中写：

GlobalObjectList.Remove（自我）；

继承免费；

这可能不是线程安全的，并且对于使用泛型或泛型方法的某些初始化可能会失败，泛型在这里和那里似乎仍然有些错误，因此您的里程也可能与临界区和/或线程有关。

# jquery - jQuery + 数据列表

> ID：1023730
> 
> 赞同：-2
> 
> 时间：2009-06-21T11:41:41.150
> 
> 标签：jquery, datalist

我对 jquery 不熟悉，并且想获取我在 datalist 中拥有的控件的 ID，以便我可以使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-08-30T20:24:58.857

您需要阅读选择器，并且可以相应地命名您的 html 标签，

从这里开始阅读：

[http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery](http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery)

然后你可以像这样绑定你的控件......

```
$(document).ready(function () {

   $('div[class=whateverClass]').each(function (index) {
      $(this).bind('click', {}, function (event) {
           alert('clicked!');
      }
}); 
```

# prototype - 如何在配置中引用 Spring.Net 的 ObjectFactory？

> ID：1023738
> 
> 赞同：1
> 
> 时间：2009-06-21T11:49:21.367
> 
> 标签：prototype, spring, spring.net, objectfactory

我想使用原型拦截器而不是单例拦截器，这样每个会话都会得到一个新的拦截器实例。

我查看了 HibernateTransactionManager 类，我认为“EntityInterceptorObjectName”和“ObjectFactory”是我必须设置的属性。

虽然 EntityInterceptorObjectName 非常明显，但当它是“ObjectFactories 之母”时，**我不知道如何引用 ObjectFactory**，例如创建 AppContext/HibernateTransactionManager 的同一个 ObjectFactory。

配置的相关部分：

```
 <object id="HibernateTransactionManager" type="Spring.Data.NHibernate.HibernateTransactionManager, Spring.Data.NHibernate20">
    <property name="DbProvider" ref="DbProvider"/>
    <property name="SessionFactory" ref="SessionFactory"/>
    <!-- the name of my non-Singleton EntityInterceptor-->
     <property name="EntityInterceptorObjectName" value="MyPrototypeEntityInterceptor" />
    <!-- What should I put as ref here? -->
    <property name="ObjectFactory" ref="" />
  </object>

  <object id="MyPrototypeEntityInterceptor" type="Hib.EntityInterceptor, Hib.Interceptors" singleton="false">
  </object> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T19:43:09.627

据我了解，您可以使用自己的 IObjectFactory 实现根据给定的名称创建所需的对象。如果您希望能够使用 Spring-ApplicationContext 中定义的对象，您还可以实现 IObjectFactoryAware 以将您的 ObjectFactory 连接到您的 Spring IoC 容器。

这应该使您能够做任何您想做的事情。创建任何类的新实例并使用 IoC 容器中的对象填充其属性（例如 SessionFactory，...）。

```
public class MyObjectFactoryAware : IObjectFactoryAware, IObjectFactory
{
   //this property will be set by the IoC container
   ObjectFactory {get; set;}

   //IObjectFactory implementation
   virtual object GetObject(string objectName)
   {
      MyEntityInterceptor interceptor = new MyEntityInterceptor();
      interceptor.SessionFactory = this.ObjectFactory.getObject("SessionFactory");
      return interceptor;

      //or of course if you just need it for wireing simply:
      //return this.ObjectFactory.getObject(objectName);
   }   
} 
```

和映射：

```
<object id="HibernateTransactionManager" type="Spring.Data.NHibernate.HibernateTransactionManager, Spring.Data.NHibernate20">
  <property name="DbProvider" ref="DbProvider"/>
  <property name="SessionFactory" ref="SessionFactory"/>
  <!-- the name of my non-Singleton EntityInterceptor-->
  <property name="EntityInterceptorObjectName" value="MyPrototypeEntityInterceptor" />
  <!-- and the name of the objectFactory -->
  <property name="ObjectFactory" ref="MyObjectFactory" />
</object>

<object id="MyObjectFactory" type="Hib.MyObjectFactoryAware, Hib.Interceptors">
</object>

<object id="MyPrototypeEntityInterceptor" type="Hib.EntityInterceptor, Hib.Interceptors" singleton="false">
</object> 
```

# css - IE中菜单上的CSS样式损坏

> ID：1023745
> 
> 赞同：0
> 
> 时间：2009-06-21T11:55:08.390
> 
> 标签：css, internet-explorer

我在 wordpress 中建立了一个网站，主页在 IE 中确实搞砸了，但在 FF、Chrome 和 Safari 中运行良好。

我在 5 小时内有一个电话会议，我需要修复它，如果有人能提供帮助，我将不胜感激。

该网站是[http://www.fullygreen.com](http://www.fullygreen.com) 核心问题是：-

1.  第一个菜单项周围的红框
2.  菜单被推到右边并且项目丢失
3.  标签框中的标签都被压扁了
4.  侧边栏出现在选项卡下方而不是侧面

就菜单/标题布局而言，所有其他页面看起来都很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T12:11:19.293

在你的标题中试试这个

```
<!--[if lt IE 8]>
<script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script>
<![endif]--> 
```

它所做的是修复许多 IE 的 CSS 错误和限制。我在我所有的网站上都使用它，它通常可以节省数天的时间来解决 IE 的许多渲染问题。

[IE7-js的主页](http://code.google.com/p/ie7-js/)

如果这解决了您的问题，并且您仍想将其捐赠给脚本背后的人 Dean Edwards：http: [//dean.edwards.name/donate/](http://dean.edwards.name/donate/)

更新：刚刚查看了您的源代码并注意到了这种调皮：

```
<script type="text/javascript" src="http://www.fullygreen.com/wp-content/themes/fully-green/js/jquery-1.2.1.pack.js"></script>
<script type="text/javascript" src="http://www.fullygreen.com/wp-content/themes/fully-green/js/jquery-easing.1.2.pack.js"></script>
<script type="text/javascript" src="http://www.fullygreen.com/wp-content/themes/fully-green/js/jquery-easing-compatibility.1.2.pack.js"></script>
<script type="text/javascript" src="http://www.fullygreen.com/wp-content/themes/fully-green/js/coda-slider.1.1.1.js"></script>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"> 
```

这将导致 IE 进入[hasLayout](http://www.satzansatz.de/cssd/onhavinglayout.html)模式（也称为非标准模式）。将该文档类型放在第一行（前面没有空格或其他标签），否则您将看到各种疯狂的错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T12:39:56.163

要固定导航菜单的位置，请`clear:left`添加`#wrapper1`

```
#wrapper1 {
position:relative;
text-align:left;
padding-top:20px;
padding-left:5px;
clear:left;
} 
```

将所有内部 div 的最高值更改为 0

```
#mnufghome {
position:absolute;
top: 0;
left: 0px;
} 
```

* * *

我刚刚看了你的源码，DOCTYPE 声明必须是 HTML 文件中的第一件事。你有一些 javascript 包括。没有 DOCTYPE 或无效的 DOCTYPE 会使 IE 进入怪癖模式，它会发疯。

您在函数 introshowtabs() 中也有一个 javascript 错误

* * *

在侧边栏中，您的图像从圆角中爆裂出来，因为您的图像宽 250 像素，但包含的 div ( `#sidebarads`) 只有 240 像素宽。IE 将扩展一个容器以适应它所包含的内容。

因为 IE6 处于 quirks 模式，所以您的圆角都没有以灰色为中心。

* * *

这是第一个菜单项周围的红色边框的问题（在 style.css 中的第 546 行附近）：

```
a.current.fghome { width:130px; background: url(images/menu/sel_home.jpg) left top no-repeat; border: 3px red solid; } 
```

去除那个`border: 3px red solid;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T13:17:16.963

以下是对这 4 个问题的一些答案：

问题 1：样式表在 style.css 中包含 3px 边框，就像 Emily 指出的那样，html 代码包含错误，onclick 后双引号位于错误的一侧：>"

```
<a class="fghome" href="/home" title="fg home"alt="fg home" onclick="menuselected(1)>"</a> 
```

问题 2：最好通过将 wrapper1 DIV 移到标题 DIV 之外来稍微更改 HTML 结构。

```
<div class="span-24" id="wrapper">
  <div class="span-24" id="header">
    <div id="headerimage"><img alt="" src="http://www.fullygreen.com/wp-content/themes/fully-green/images/icons/hp_icon.jpg"/></div>
    <div id="logo"><img title="fully green" src="http://www.fullygreen.com/wp-content/themes/fully-green/images/hp_logo.png"/></div>
  </div>
  <div id="wrapper1">
    <div id="mnufghome"> <a onclick="menuselected(1)" alt="fg home" title="fg home" href="/home" class="fghome" /></div>
    <div id="mnufgstory"> <a alt="fg story" title="fg story" href="/story" class="fgstory" /></div>
    <div id="mnufgprojects"> <a alt="fg projects" title="fg projects" href="/projects" class="fgprojects" /></div>
    <div id="mnufgnews"> <a alt="fg news" title="fg news" href="/news" class="fgnews" /></div>
    <div id="mnufgpeople"> <a alt="fg people" title="fg people" href="/people" class="fgpeople" /></div>
    <div id="mnufgabout"> <a alt="fg contact" title="fg contact" href="/contact" class="fgabout" /></div>
  </div>
</div> 
```

style.css 中的一些样式更改：

```
#header {
background: url(images/header.jpg) no-repeat top center;
height: 110px;
}

#mnufgprojects {
float: left;
width: 170px;
}

#mnufgstory {
float: left;
width: 170px;
}

Similarly for the other navigation buttons... 
```

问题 3。

似乎在其他答案的帮助下几乎固定了，比如 JS 的位置包括在内。

问题 4。

无法从您的问题和查看您的网站中发现问题。

希望这个和其他答案将帮助您按时在 IE 中修复问题。祝你好运！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-21T14:22:31.137

因此，您无需执行任何特定于 IE8 的操作，只需在页面中添加兼容性元标记即可：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" > 
```

如果需要，您应该能够使用 EmulateIE6。

# javascript - 这段 Javascript 代码有什么作用？

> ID：1023758
> 
> 赞同：1
> 
> 时间：2009-06-21T12:04:30.527
> 
> 标签：javascript

我在一个内部网站上遇到了这个片段，但我无法理解它：

```
function safeWrap(f) {
  return function() {
    setTimeout.apply(window, [f, 0].concat([].slice.call(arguments)));
  };
} 
```

后来，它是这样使用的：

```
// Set click handler.
(...).click(safeWrap(function() { ... } )); 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-21T12:15:48.600

safeWrap 返回一个函数，该函数在调用时将超时设置为 0 毫秒（触发点击事件）。

如果 safeWrap 函数传递的参数多于 f，它会将这些参数添加到函数 f 的参数列表中。

那只是对提供的代码的解释。所以我不知道它的真正含义是什么......例如，这段代码在哪里使用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-25T07:08:37.087

**这样做的一个原因是让点击处理程序在不冻结页面的情况下运行**。JavaScript 是单线程的。因此，如果单击[处理](http://ejohn.org/blog/how-javascript-timers-work/)`f`程序（单击处理程序完成后，浏览器将执行这些操作。但在那之前，该应用程序将显示对用户没有响应 - 他单击按钮，但似乎没有任何反应。

`setTimeout`有帮助，因为单击处理程序立即返回。回调`f`被添加到事件队列中以在未来轮次运行，使浏览器有机会运行队列中已经存在的任何事件（例如，被按下并重新启动的按钮动画将有机会被处理；如果您有一个长时间运行的单击处理程序，则该按钮将保持按下状态）。

虽然这样更好，但仍然有可能页面在`f`运行时会被冻结。避免这种情况的方法是`f`在小块中完成它的工作，即，做一些事情说 20 毫秒，然后调用 setTimeout 并为其余的工作回调。这样，在这 20 毫秒内堆积的任何其他事件都有机会运行。这样的函数可能如下所示：

```
something.click(safeWrap(function() {

  function part1() { /* do something */ }
  function part2() { /* do something */ }

  part1();

  safeWrap(part2);

})); 
```

**这样做的另一个原因是不要让可能发生在 click 处理程序中的异常冒泡到 click 方法**。也许，该`click`方法会自动捕获异常并将它们显示在屏幕上，在这种特殊情况下，我们希望错误不会被注意到。这是有效的，因为`f`它在事件循环的不同轮次上运行，并且异常不会上升到堆栈，`click`因为调用堆栈`f`从新轮次开始。`click`如果未包装处理程序，则异常将冒泡到该方法，`safeWrap`因为在这种情况下，`f`它将是来自的常规方法调用`click`

**最后，请注意，即使在安全包装之后，单击处理程序也会获取该`click`方法传递给它**的所有参数。*如另一个答案中所指出的，**它不会**将**附加参数传递给`safeWrap`*。这显然是有道理的，因为我们希望点击处理程序不关心处理程序是直接传递还是安全包装。这段代码可能很清楚：

```
(function() {
  console.clear();

  function safeWrap(f) {
    return function() {
      setTimeout.apply(window, [f, 0].concat([].slice.call(arguments)));
    };
  }

  var f = function(a) { console.log(a /* prints 2 */); throw Error("f"); };

  function click(f) {
    f(2);
  }

  click(safeWrap(f, 1));

})(); 
```

# java - Java 是否有基于推送/非阻塞的 XML 解析器？

> ID：1023759
> 
> 赞同：17
> 
> 时间：2009-06-21T12:05:06.560
> 
> 标签：java, xml, nonblocking

我正在寻找一个 XML 解析器，而不是从 InputStream 或 InputSource 进行解析，而是允许将文本块推送到解析器中。例如，我想要以下内容：

```
public class DataReceiver {
    private SAXParser parser = //...
    private DefaultHandler handler = //...

    /**
     * Called each time some data is received.
     */
    public void onDataReceived(byte[] data) {
        parser.push(data, handler);
    }
} 
```

原因是我想要一些可以与 NIO 网络库配合使用的东西，而不是必须恢复到支持阻塞 InputStream 所需的每个连接模型的线程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-08-31T05:44:45.183

令人惊讶的是，没有人提到一个实现非阻塞（“异步”）解析的 Java XML 解析器：[Aalto](http://www.cowtowncoder.com/hatchery/aalto/index.html)。部分原因可能是缺乏文档（以及活动水平低）。Aalto 实现了基本的 Stax API，但也实现了一些小的扩展以允许推送输入（这部分尚未最终确定；功能存在但 API 尚未最终确定）。有关更多信息，您可以查看相关[讨论组](http://tech.groups.yahoo.com/group/aalto-xml-interest/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T20:09:12.197

编辑：现在我明白了。您以块的形式接收 XML，并且希望将其提供给适当的 XML 解析器。所以你需要一个对象，一端是队列，另一端是 InputStream？

您可以将接收到的字节数组聚合到 ByteArrayOutputStream 中，将其转换为 ByteArrayInputStream 并将其提供给 SAXParser。

或者您可以查看 PipedInputStream/PipedOutputStream 对。在这种情况下，您需要在另一个线程中进行解析，因为 SAX 解析器使用当前线程来发出事件，从而阻塞了您的 receive()。

**编辑**：根据我建议采取聚合路线的评论。您将块收集到 ByteArrayOutputStream 中。要了解您是否收到了 XML 的所有块，请检查当前块或 ByteArrayOutputStream 的内容是否包含 XML 根节点的结束标记。然后，您可以将数据传递到 SAXParser 中，该 SAXParser 现在可以在当前线程中运行而不会出现问题。为了避免不必要的数组重新创建，您可以实现自己的非同步简单字节数组包装器或寻找这样的实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-25T20:37:26.317

这是来自 Xerces J-Users 邮件列表的（2009 年 4 月）帖子，其中原始发帖人遇到了完全相同的问题。给出了“杰夫”的一个可能非常好的回应，但没有跟进原始发布者的回应：

[http://www.nabble.com/parsing-an-xml-document-chunk-by-chunk-td22945319.html](http://www.nabble.com/parsing-an-xml-document-chunk-by-chunk-td22945319.html)

它可能足够新，可以进入列表，或者至少有助于搜索。

**编辑**

找到另一个有用的链接，提到了一个名为 Woodstox 的库，并描述了基于 Stream 与 NIO 的解析器的状态以及一些模拟流的可能方法：

[http://markmail.org/message/ogqqcj7dt3lwkbov](http://markmail.org/message/ogqqcj7dt3lwkbov)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T20:04:20.263

检查openfire[的](http://www.igniterealtime.org/projects/openfire/index.jsp)XMLLeightweightParser 以及由于 NIO 它如何从单个块生成 XML 消息。整个项目是有关 NIO 和 XMPP 问题的答案的重要来源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T09:47:54.690

添加另一个答案，因为这个问题对于相关的 Google 搜索仍然很高 - [aalto-xml](https://github.com/FasterXML/aalto-xml) 0.9.7（2011 年 3 月）具有异步 XML pasing。这允许您传递任意大小的文档块以继续解析，并使用新的 StaX 事件类型`EVENT_INCOMPLETE`来指示输入缓冲区已用尽并且文档仍然不完整。

这是[Tatu Salorant](http://www.cowtowncoder.com/blog/archives/2011/03/entry_451.html)（作者）的示例：

```
 byte[] msg = "<html>Very <b>simple</b> input document!</html>".getBytes();
      AsyncXMLStreamReader asyncReader = new InputFactoryImpl().createAsyncXMLStreamReader();
      final AsyncInputFeeder feeder = asyncReader.getInputFeeder();
      int inputPtr = 0; // as we feed byte at a time
      int type = 0;

      do {
        // May need to feed multiple "segments"
        while ((type = asyncReader.next()) == AsyncXMLStreamReader.EVENT_INCOMPLETE) {
          feeder.feedInput(msg, inputPtr++, 1);
          if (inputPtr >= msg.length) { // to indicate end-of-content (important for error handling)
            feeder.endOfInput();
          }
        }
        // and once we have full event, we just dump out event type (for now)
        System.out.println("Got event of type: "+type);
        // could also just copy event as is, using Stax, or do any other normal non-blocking handling:
        // xmlStreamWriter.copyEventFromReader(asyncReader, false);
      } while (type != AsyncXMLStreamReader.END_DOCUMENT); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-09T19:51:42.523

NioSax 与 ByteBuffers 一起使用

[http://blog.retep.org/2010/06/25/niosax-sax-style-xml-parser-for-java-nio/](http://blog.retep.org/2010/06/25/niosax-sax-style-xml-parser-for-java-nio/)

我能找到的最新版本（2010 年的 10.6）的源代码位于 Sonatype Maven 存储库中：

[https://oss.sonatype.org/content/repositories/releases/uk/org/retep/](https://oss.sonatype.org/content/repositories/releases/uk/org/retep/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-25T23:34:20.063

对不起，我没能解决这个问题。我找不到像我需要的那样的解析器。但是我想自己写一篇。一个非常简单的问题：就像可裂性研究一样，但足以解决我的问题，也可以解决你的问题。不幸的是，我一直很忙，接下来的两周我会出去，但也许七月份我会开始工作。一旦我有工作，我会尽快通知你。

公吨

# primes - 阿特金筛法的解释

> ID：1023768
> 
> 赞同：23
> 
> 时间：2009-06-21T12:13:35.360
> 
> 标签：primes, sieve-of-eratosthenes, sieve-of-atkin

我目前正在做一个项目，我需要一种有效的方法来计算素数。我使用过[Eratosthenes 的筛子，](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)但我一直在四处寻找，发现[Atkin 的筛子](http://en.wikipedia.org/wiki/Sieve_of_Atkin)是一种更有效的方法。我发现很难找到这种方法的解释（我已经能够理解！）。它是如何工作的？示例代码（最好是 C 或 python）会很棒。

*编辑：*感谢您的帮助，我唯一仍然不明白的是伪代码中 x 和 y 变量所指的内容。有人可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-21T12:17:53.697

[wiki 页面](http://en.wikipedia.org/wiki/Sieve_of_atkin)始终是一个很好的起点，因为它完整地解释了算法并提供了注释伪代码。（注意有很多细节，而且由于 wiki 网站是可靠的，我不会在这里引用它。）

对于您提到的特定语言的参考资料：

*   [C 实现](http://cr.yp.to/primegen.html)（优化）
*   [Python 实现](https://github.com/mccricardo/sieve_of_atkin)

希望有帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-03T09:28:26.350

[维基百科文章](http://en.wikipedia.org/wiki/Sieve_of_atkin#Explanation)有一个解释：

*   *“该算法完全忽略任何可被二、三或五整除的数字。所有具有偶数模 60 余数的数都可被二整除而不是素数。所有模数为 60 余数可被三整除的数也能被三整除，而不是素数。所有模 60 余数可被 5 整除的数都可被 5 整除，而不是素数。所有这些余数都被忽略。”*

让我们从著名的开始

```
primes = sieve [2..] = sieve (2:[3..])   
  -- primes are sieve of list of 2,3,4... , i.e. 2 prepended to 3,4,5...
sieve (x:xs) = x : sieve [y | y <- xs, rem y x /= 0]   -- set notation
  -- sieve of list of (x prepended to xs) is x prepended to the sieve of 
  --                  list of `y`s where y is drawn from xs and y % x /= 0 
```

让我们看看它是如何进行几个第一步的：

```
primes = sieve [2..] = sieve (2:[3..]) 
                     = 2 : sieve p2     -- list starting w/ 2, the rest is (sieve p2)
p2 = [y | y <- [3..], rem y 2 /= 0]     -- for y from 3 step 1: if y%2 /= 0: yield y 
```

`p2`是不包含*2*的倍数。IOW 它只包含与*2*互质的数字——其中没有数字以`p2`2*作为*其因数。要找到`p2`我们实际上不需要测试每个数字除以*2*`[3..]`（即*3*及以上，*3,4,5,6,7,...* ），因为我们可以提前枚举*2*的所有倍数：

```
rem y 2 /= 0  ===  not (ordElem y [2,4..])     -- "y is not one of 2,4,6,8,10,..." 
```

`ordElem`就像[`elem`](https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:elem)（即*is-element*测试），它只是*假设*它的 list 参数是一个有序的、递增的数字列表，因此它可以安全地检测不存在以及存在：

```
ordElem y xs = take 1 (dropWhile (< y) xs) == [y]   -- = elem y (takeWhile (<= y) xs) 
```

普通`elem`不假设任何东西，因此必须检查其列表参数的每个元素，因此无法处理无限列表。`ordElem`能够。那么，那么，

```
p2 = [y | y <- [3..], not (ordElem y [2,4..])]  -- abstract this as a function, diff a b =
   = diff      [3..]                 [2,4..]    --       = [y | y <- a, not (ordElem y b)]
   -- 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
   -- . 4 . 6 . 8 . 10  . 12  . 14  . 16  . 18  . 20  . 22  .
   = diff [3..] (map (2*)            [2..] )  --  y > 2, so [4,6..] is enough
   = diff [2*k+x | k <- [0..],  x <- [3,4]]   -- "for k from 0 step 1: for x in [3,4]:
          [2*k+x | k <- [0..],  x <- [  4]]   --                            yield (2*k+x)"
   = [     2*k+x | k <- [0..],  x <- [3  ]]   -- 2 = 1*2 = 2*1
   = [3,5..]                                  -- that's 3,5,7,9,11,... 
```

`p2`只是*2*以上所有赔率的列表。好吧，我们*知道*。下一步呢？

```
sieve p2 = sieve [3,5..] = sieve (3:[5,7..]) 
                         = 3 : sieve p3
p3 = [y | y <- [5,7..], rem y 3 /= 0]
   = [y | y <- [5,7..], not (ordElem y [3,6..])]           -- 3,6,9,12,...
   = diff [5,7..] [6,9..]         -- but, we've already removed the multiples of 2, (!)
   -- 5 . 7 . 9 . 11 . 13 . 15 . 17 . 19 . 21 . 23 . 25 . 27 .
   -- . 6 . . 9 . . 12  . . 15 . . 18  . . 21 . . 24  . . 27 .
   = diff [5,7..] (map (3*) [3,5..])                       -- so, [9,15..] is enough
   = diff [2*k+x | k <- [0..], x <- [5]] (map (3*)
          [2*k+x | k <- [0..], x <- [    3]] )
   = diff [6*k+x | k <- [0..], x <- [5,7,9]]               -- 6 = 2*3 = 3*2
          [6*k+x | k <- [0..], x <- [    9]] 
   = [     6*k+x | k <- [0..], x <- [5,7  ]]               -- 5,7,11,13,17,19,... 
```

而接下来，

```
sieve p3 = sieve (5 : [6*k+x | k <- [0..], x <- [7,11]])
         = 5 : sieve p5
p5 = [y | y <-        [6*k+x | k <- [0..], x <- [7,11]], rem y 5 /= 0]
   = diff [ 6*k+x | k <- [0..], x <- [7,11]]   (map   (5*)
          [ 6*k+x | k <- [0..], x <- [                  5,       7]]) -- no mults of 2 or 3!
   = diff [30*k+x | k <- [0..], x <- [7,11,13,17,19,23,25,29,31,35]]  -- 30 = 6*5 = 5*6
          [30*k+x | k <- [0..], x <- [                 25,      35]]
   = [     30*k+x | k <- [0..], x <- [7,11,13,17,19,23,   29,31   ]] 
```

这是阿特金筛子的工作顺序。*其中不存在2、3*或*5*的倍数。Atkin 和 Bernstein以*60*为模工作，即它们将范围加倍：

```
p60 = [ 60*k+x | k <- [0..], x <- [1, 7,11,13,17,19,23,29,31, 37,41,43,47,49,53,59]] 
```

接下来，他们使用一些复杂的定理来了解每个数字的一​​些属性，并相应地处理每一个。*整个过程以60*的周期重复（a-la “轮子”）。

*   *“所有模数为 60 余数为 1、13、17、29、37、41、49 或 53 (...) 的数 n 当且仅当`4x^2 + y^2 = n`解数为奇数且数为无平方数时为素数。”*

这意味着什么？如果我们知道这个方程的解的数量对于这样的数字是奇数，那么*如果*它是无平方的，它就是素数。这意味着它没有重复的因子（如*49、121*等）。

Atkin 和 Bernstein 使用它来减少整体操作的数量：对于每个素数（从*7及以上），我们枚举（并标记删除）**其平方*的倍数，因此它们比 Eratosthenes 的筛子相距更远，因此在给定范围内它们的数量较少。

其余规则如下：

*   *“所有模六十余`3x^2 + y^2 = n`数为 7、19、31 或 43 (...) 的数 n 当且仅当解数为奇数且数为无平方数时为素数。”*

*   *“所有模六十余`3x^2 − y^2 = n`数为 11、23、47 或 59 (...) 的数 n 当且仅当解数为奇数且该数为无平方数时为素数。”*

这会处理`p60`.

另请参阅：[找到素数的最快算法是哪个？](https://stackoverflow.com/questions/453793/which-is-the-fastest-algorithm-to-find-prime-numbers#comment30490245_453800)

* * *

Eratosthenes 筛产生高达*N*的素数的时间复杂度为*O(N log log N)*，而 Atkin 筛的时间复杂度为*O(N)*（撇开`log log N`不能很好扩展的额外优化）。但公认的观点是，阿特金筛子中的常数因子要高得多，因此它可能只会在高于 32 位数字 ( *N > 2 ^(32) )*的情况下得到回报，[如果有的话](https://stackoverflow.com/questions/19388106/sieve-of-atkins/20572948#20572948)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-20T18:39:13.007

> 编辑：我唯一不明白的是伪代码中的 x 和 y 变量指的是什么。有人可以为我解释一下吗？

有关维基百科页面伪代码（或阿特金筛的其他更好实现）中“x”和“y”变量的常见用法的基本解释，您可能会发现[我对另一个相关问题的回答](https://stackoverflow.com/questions/1569393/c-how-to-make-sieve-of-atkin-incremental/18342305#18342305)很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-20T14:14:38.830

这是阿特金斯筛子的 C++ 实现，可能对您有所帮助...

```
#include <iostream>
#include <cmath>
#include <fstream>
#include<stdio.h>
#include<conio.h>
using namespace std;

#define  limit  1000000

int root = (int)ceil(sqrt(limit));
bool sieve[limit];
int primes[(limit/2)+1];

int main (int argc, char* argv[])
{
   //Create the various different variables required
   FILE *fp=fopen("primes.txt","w");
   int insert = 2;
   primes[0] = 2;
   primes[1] = 3;
   for (int z = 0; z < limit; z++) sieve[z] = false; //Not all compilers have false as the       default boolean value
   for (int x = 1; x <= root; x++)
   {
        for (int y = 1; y <= root; y++)
        {
             //Main part of Sieve of Atkin
             int n = (4*x*x)+(y*y);
             if (n <= limit && (n % 12 == 1 || n % 12 == 5)) sieve[n] ^= true;
             n = (3*x*x)+(y*y);
             if (n <= limit && n % 12 == 7) sieve[n] ^= true;
             n = (3*x*x)-(y*y);
             if (x > y && n <= limit && n % 12 == 11) sieve[n] ^= true;
        }
   }
        //Mark all multiples of squares as non-prime
   for (int r = 5; r <= root; r++) if (sieve[r]) for (int i = r*r; i < limit; i += r*r) sieve[i] = false;
   //Add into prime array
   for (int a = 5; a < limit; a++)
   {
            if (sieve[a])
            {
                  primes[insert] = a;
                  insert++;
            }
   }
   //The following code just writes the array to a file
   for(int i=0;i<1000;i++){
             fprintf(fp,"%d",primes[i]);
             fprintf(fp,", ");
   }

   return 0;
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-12T06:48:43.170

```
// Title : Seive of Atkin ( Prime number Generator) 

#include <iostream>
#include <cmath>
#include <vector>

using namespace std;

int main()
{
    ios_base::sync_with_stdio(false);
    long long int n;
    cout<<"Enter the value of n : ";
    cin>>n;
    vector<bool> is_prime(n+1);
    for(long long int i = 5; i <= n; i++)
    {
        is_prime[i] = false;
    }
    long long int lim = ceil(sqrt(n));

    for(long long int x = 1; x <= lim; x++)
    {
        for(long long int y = 1; y <= lim; y++)
        {
            long long int num = (4*x*x+y*y);
            if(num <= n && (num % 12 == 1 || num%12 == 5))
            {
                is_prime[num] = true;
            }

            num = (3*x*x + y*y);
            if(num <= n && (num % 12 == 7))
            {
                is_prime[num] = true;
            }

            if(x > y)
            {
                num = (3*x*x - y*y);
                if(num <= n && (num % 12 == 11))
                {
                    is_prime[num] = true;
                }
            }
        }
    }
    // Eliminating the composite by seiveing
    for(long long int i = 5; i <= lim; i++)
    {
        if(is_prime[i])
            for(long long int j = i*i; j <= n; j += i)
            {
                is_prime[j] = false;
            }
    }
    // Here we will start printing of prime number
   if(n > 2)
   {
       cout<<"2\t"<<"3\t";
   }
   for(long long int i = 5; i <= n; i++)
   {
         if(is_prime[i])
         {
             cout<<i<<"\t";
         }
    }
    cout<<"\n";
    return 0;
} 
```

# iphone - 如何在 Xcode for iPhone 中创建 Core Data 模型后创建类

> ID：1023769
> 
> 赞同：60
> 
> 时间：2009-06-21T12:13:40.803
> 
> 标签：iphone, core-data

我在 Xcode 中创建了我的模型、实体、属性和关系。我的实体的类是如何创建的？我必须手动创建它们吗？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2010-03-04T13:01:48.930

您可以在完全不离开 Xcode 的情况下执行此操作（请参阅 Xcode 4 说明的答案结尾）：

*   打开您的数据模型，使其在编辑器窗格中可见
*   单击组和窗格窗格中的类文件夹
*   现在单击图表窗格中的任意位置。
*   按 ⌘N 调出此对话框：

![替代文字](../Images/34f9c197e236a888f21a83c6eee231ab.png)

*   完成向导为一个或多个类生成代码。注意：您可以在向导的后续步骤中选择要为其生成的类 - 此处未显示。

[我在更多 iPhone 3 开发](https://rads.stackoverflow.com/amzn/click/com/143022505X)的第 143 页上选择了这个

## 2010 年 12 月 6 日更新：

或者，您可以只选择实体列表中的一个或多个实体，如下所示： ![替代文字](../Images/3c0583273ab71c9c2d229254c145974d.png)

然后按 ⌘N 调出上面显示的新建文件对话框。如果您接受使用此替代方法的默认位置，则生成的类将放在您的 .xcdatamodel 下。将它们手动拖到类中（参考：[斯坦福，为 iOS 开发应用程序：第 12 页。核心数据和表格视图](http://itunes.apple.com/us/podcast/12-core-data-table-views-october/id395605774?i=88872489)）。

## 2011 年 3 月 26 日更新（Xcode 4）：

对于 Xcode 4，只需打开新建文件对话框 (⌘N) 并从 Core Data 中选择 NSManagedObject 子类。向导将询问您应该为哪些实体创建类。

![在此处输入图像描述](../Images/150a2f698b82bb354ad8ab04bde79e16.png)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-04-22T11:34:01.613

使用 Xcode 4.3+，您可以：

*   点击你的型号
*   单击编辑器菜单
*   单击创建 NSManagedObject 子类
*   将文件保存在您想要的位置

它完成了！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-17T13:48:34.230

您也可以使用[mogenerator](http://rentzsch.github.com/mogenerator/)。它现在包括 Xmo'd，它将 mogenerator 无缝集成到 Xcode 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-12T14:47:48.843

你也可以试试[MotoSwift](https://github.com/Igor-Palaguta/MotoSwift)。

*   很简单
*   支持[Stencil](https://github.com/kylef/Stencil)模板语言
*   包含类似于 XCode 生成和 mogenerator 生成的 swift 模板

# emacs - 在 Emacs 中自动关闭大括号？

> ID：1023770
> 
> 赞同：28
> 
> 时间：2009-06-21T12:13:41.130
> 
> 标签：emacs, typing

我见过一个名为[AutoClose](http://www.vim.org/scripts/script.php?script%5Fid=1849)的 Vim 插件（从[这篇](https://stackoverflow.com/questions/1023002/how-to-minimize-use-of-arrow-keys-when-typing-code/1023699#1023699)文章中发现），它在键入 '('、'{' 等时会自动添加右大括号。

例如; 当我输入以下内容时（`|`是光标）：

```
int main(| 
```

我希望`)`自动为我插入关闭：

```
int main(|) 
```

有谁知道 emacs 的类似功能 - 谷歌这次让我失望了！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-21T12:21:17.543

是的，[这种模式叫做电动](http://www.gnu.org/software/emacs/manual/html_node/emacs/Electric-C.html)。您可以将电气行为与这个简单的宏结合起来以获得最大的舒适度：

```
(defun electric-pair ()
  "If at end of line, insert character pair without surrounding spaces.
   Otherwise, just insert the typed character."
  (interactive)
  (if (eolp) (let (parens-require-spaces) (insert-pair)) 
    (self-insert-command 1))) 
```

然后通过在您喜欢的编程模式中将适当的字符绑定到它来启用它。例如，对于 PythonMode：

```
(add-hook 'python-mode-hook
          (lambda ()
            (define-key python-mode-map "\"" 'electric-pair)
            (define-key python-mode-map "\'" 'electric-pair)
            (define-key python-mode-map "(" 'electric-pair)
            (define-key python-mode-map "[" 'electric-pair)
            (define-key python-mode-map "{" 'electric-pair))) 
```

CPerl 模式将其作为内置提供：

```
;; from my .emacs
(add-hook 'cperl-mode-hook
  (lambda ()
    (setq cperl-hairy nil
      abbrev-mode t     ;; automatic keyword expansion
      cperl-highlight-variables-indiscriminately t
      cperl-auto-newline t
      cperl-auto-newline-after-colon t
      cperl-regexp-scan nil
      cperl-electric-keywords t 
      cperl-electric-linefeed t  
      cperl-electric-parens nil) ;; <------ electric parens! 
```

其他模式可以提供类似的东西。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-21T14:37:40.840

还有[`'paredit`](http://www.emacswiki.org/emacs/ParEdit)。[备忘单](http://www.emacswiki.org/emacs/PareditCheatsheet)显示了所有可用的命令。碰巧比另一个答案中建议的电动模式更喜欢它。虽然 paredit 仅适用于 ()，但它可能无法满足您的需求。

但是，老实说，括号周围有一堆包。wiki 将它们全部[列在这里](http://www.emacswiki.org/emacs/CategoryParentheses)。解决您的问题的模式是：

*   [平衡的](http://www.emacswiki.org/emacs/BalancedEl)
*   [电动点和破折号](http://www.emacswiki.org/emacs/ElectricDotAndDash)
*   [通用闭包](http://www.emacswiki.org/emacs/UniversialCloseParen)
*   [电对](http://www.emacswiki.org/emacs/ElectricPair)
*   [骨骼](http://www.emacswiki.org/emacs/SkeletonMode#PairInsertion)
*   [插入语](http://www.emacswiki.org/emacs/parenthesis.el)
*   [自动配对](http://www.emacswiki.org/emacs/AutoPairs)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-27T01:19:33.323

我将删除这个线程并提供另一种选择。最近开始了一个新项目，它处理自动插入对、区域包装、围绕平衡表达式的导航等等。功能列表太长，无法在此处提供，因此我将仅链接到[smartparens github 存储库](https://github.com/Fuco1/smartparens)，您可以在其中阅读详细的自述文件。

它是前面提到的 AutoPair 的超集，并提供了 paredit 的大部分核心功能（并扩展到各种不同的对，而不仅仅是那些被 emacs 语法表识别的对）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-21T18:59:25.440

cmarcelo使用骨架模式[写了一篇关于此的精彩文章。](http://cmarcelo.wordpress.com/2008/04/26/a-little-emacs-experiment/)他还展示了如果删除左括号，如何删除平衡括号，以及如何处理不小心键入右括号的情况。（顺便说一下，这两种行为都复制了 TextMate）。

更新：

自从我发布了这个答案后，我发现[Autopair](http://code.google.com/p/autopair/)对于这个用例来说是一个非常完美的系统。我一直在使用它并且很喜欢它。

# wcf - 具有二进制数据的 WCF 服务

> ID：1023772
> 
> 赞同：2
> 
> 时间：2009-06-21T12:15:18.680
> 
> 标签：wcf, soap, post, binary, request

我有一个独特的问题，我希望能够处理包含任意二进制数据的传入 HTTP POST 请求。

我目前可以使用标准的 ASP.NET 页面处理程序或在 ASP Web 服务中处理这些数据，但我想知道是否可以在 WCF 服务中处理传入的二进制数据？我可以深入到 WCF 处理堆栈以绕过 SOAP 处理并在我自己的代码中处理原始消息吗？

我知道这违反了 WCF 的“合同”发布（无论是 WSDL），但我并不真正关心这一点。

-杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T12:19:22.570

您可以使用流式[MSDN](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T00:52:57.567

考虑使用 MTOM。MTOM 是一种将带有 SOAP 消息的大型二进制附件作为原始字节传输的机制，允许使用更小的消息。详情见：

[http://msdn.microsoft.com/en-us/library/aa395209.aspx](http://msdn.microsoft.com/en-us/library/aa395209.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T12:17:41.140

只要我知道你可以配置服务绑定： [http ://www.c-sharpcorner.com/UploadFile/pjthesedays/bindwcf05032009012251AM/bindwcf.aspx](http://www.c-sharpcorner.com/UploadFile/pjthesedays/bindwcf05032009012251AM/bindwcf.aspx)

使用 netTcpBinding

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-17T02:28:44.723

在这个问题上花了几个星期之后，我有了一个明确的答案：

你能用 WCF 的自定义二进制序列化替换 XML/SOAP 吗？

简短的回答：没有

长答案：是的，但是您必须重写几乎所有的传输层接口，因此您不妨创建一个自定义 IHttpHandler 并一起避免 WCF。

微软试图遵循 SOAP 标准（我认为该标准是造成这个问题的原因）打破了简单的编程规则之一 -> 层中的职责分离。WCF/SOAP 可能看起来是一个优雅的分层协议和传输，但实际情况是，层之间存在错综复杂的连接。这意味着 WCF 是一个极其复杂的通信协议，它提供了传输、安全性、可靠性、发布、序列化和其他在某种程度上都相互依赖的特性。如果您只需要一个传输通道，那么 WCF/SOAP 会增加大量的复杂性。

我确信我可以开始对 SOAP 是/否大肆咆哮，但我终于意识到 WCF/SOAP 不是我的应用程序所需要的。

-杰夫

# database-design - 这个应该怎么设计？

> ID：1023778
> 
> 赞同：0
> 
> 时间：2009-06-21T12:18:57.843
> 
> 标签：database-design, optimization

我正在做一个项目，让用户选择一些科学作者和专栏作家并跟踪他们的活动。用户可以通过以下方式跟踪作者活动：

1.  明确选择作者，然后跟踪他
**或者**

3.  选择一个频道（一些其他用户跟踪的作者列表）并跟踪整个频道

[数据库模型 http://img526.imageshack.us/img526/7278/dbmodel.png](http://img526.imageshack.us/img526/7278/dbmodel.png)
这种设计应该没问题，以防用户点击作者逐个作者跟踪，插入快速进入数据库，UI动画（使用Ajax通过 Jquery) 指示该过程的成功或失败。但是，如果用户选择一个频道，情况会有所不同。这是我想出的，当用户选择一个频道时，我会从该频道中提取所有作者，然后在 Users_Authors 表中插入新条目。现在假设频道包含 1000 个或更多用户，插入需要一些时间，并且动画 GUI 不会像期望的那样快。那么，有人会推荐任何其他方法来改进这一点（即使我不得不改变整个设计）。
谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T12:31:27.820

您需要问自己的一件事是：

如果用户选择了一个有 100 个作者的频道并且该频道发生了变化，这些变化是否应该传递给用户？该问题的答案将在很大程度上决定设计。

如果您想要自动流程，则不要在用户选择频道时复制作者。该设计需要适应频道订阅。

在 OO 术语中，用户有零个或多个 Subscribables，它是 Author 或 Channel 的父类。频道与作者具有一对多的关系。实体表示基本相同。您只需要将订阅的内容设为两个实体的父级。

如果您不想进行更改，则需要对频道进行版本控制或执行您正在做的事情：将作者从频道复制到用户的订阅中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T12:29:01.443

您可以将频道视为元作者，即订阅频道的处理方式与订阅作者非常相似。这给您带来了两个好处： 1\. 当新作者加入频道时，该频道的所有用户都会自动订阅该作者。2\. 也许用户订阅了艾萨克牛顿。然后她还订阅了“物理学家”频道，但后来又取消了订阅。从用户那里删除“物理学家”订阅也会删除艾萨克牛顿，这可能是不希望的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T12:28:14.330

我会建议一个不同的表示。

简而言之，您想要管理“订阅”。订阅有两种类型：“个人作者”和“频道”。

因此，您可以定义一个名为 Subscription 的基类和两个子类，分别为“Author”和“Channel”。“频道”行应该能够与作者保持 1:N 的关系。

然后在前端，所有的订阅都会在一个固定的时间内完成。

此外，这种设计还会在频道中的构成作者发生变化时出现数据维护问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T12:34:17.813

我的方法是让 People 表同时包含 Users 和 Authors，而 Author 表只包含 Authors 的 People 键。然后 Authors 将创建一个与您的链接表类似的 Members 表。

# windows - 使用 Perl，如何检查具有给定名称的进程是否正在运行？

> ID：1023781
> 
> 赞同：2
> 
> 时间：2009-06-21T12:22:14.217
> 
> 标签：windows, perl, process

使用 Perl，我如何检查特定的 Windows 进程是否正在运行？基本上，我想使用“exec”启动一个进程，但只有在它尚未运行时才应该这样做。

那么如何知道具有特定名称的进程是否正在运行呢？是否有提供此功能的 Perl 模块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T12:47:53.107

请看下面使用[Win32::OLE](http://search.cpan.org/~jdb/Win32-OLE/lib/Win32/OLE.pm)模块的示例。它允许您搜索名称与给定正则表达式匹配的正在运行的进程。

```
#! perl

use warnings;
use strict;

use Win32::OLE qw(in);

sub matching_processes {
  my($pattern) = @_;

  my $objWMI = Win32::OLE->GetObject('winmgmts://./root/cimv2');
  my $procs = $objWMI->InstancesOf('Win32_Process');

  my @hits;
  foreach my $p (in $procs) {
    push @hits => [ $p->Name, $p->ProcessID ]
      if $p->Name =~ /$pattern/;
  }

  wantarray ? @hits : \@hits;
}

print $_->[0], "\n" for matching_processes qr/^/; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T12:28:55.420

您可能正在寻找[Proc::ProcessTable](http://search.cpan.org/dist/Proc-ProcessTable)（假设您使用的是 Unix！）。它使您可以访问进程列表，并且您可以查询其字段以查找具有名称的进程。有相关的软件包可让您获得各个流程，具体取决于您想要做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T15:39:23.913

也许您无法控制第二个进程，但如果您这样做了，一个好的方法是让进程将其 pid ( `$$`) 写入已知位置的文件中。然后您可以读取该文件并使用 . 查看该 pid 是否存在`kill($pid, 0)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T20:59:55.917

您真正想要的是一种在进程已经运行时停止运行的方法（如果您有两个具有相同名称的不同程序，或者决定将您的程序命名为 explorer.exe 怎么办？）这在 Linux 上适用于我：

```
use Fcntl ':flock';

open SELF, '<', $0 or die 'I am already running...';
flock SELF, LOCK_EX | LOCK_NB  or exit; 
```

在我的测试中，该代码不想出现在任何块中。

（[来源](http://perl.plover.com/yak/flock/samples/slide006.html)）

# jquery - jquery 图片幻灯片

> ID：1023782
> 
> 赞同：0
> 
> 时间：2009-06-21T12:23:34.137
> 
> 标签：jquery, slide

这是测试页面

[http://www.studioteknik.com/html/test-portfolio.html](http://www.studioteknik.com/html/test-portfolio.html)

我没有错误，但没有悬停滑动效果......

任何线索任何人？

* * *

更新，molf 已经解决了这个问题，那是绝对位置的伎俩.. 但是，现在，当文本出现时，下面的链接是不可点击的

* * *

更正的页面在这里： http: [//www.studioteknik.com/html/test-portfolio3.html](http://www.studioteknik.com/html/test-portfolio3.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T12:34:47.453

您应该更新您的 CSS，确保`.image img`绝对定位：

```
.image img {
    position: absolute; // added
    height: 100%;
    width: 100%;
} 
```

这将使幻灯片工作。但是，图像将显示在周围环境之外`div`。要解决此问题，请将`overflow: hidden`属性添加到`.image`：

```
.image {
    // ...
    overflow: hidden; // added
} 
```

* * *

**更新：**考虑到在上面的解决方案中，您最终会看到*后面*的文本`.image div`（即带有不可点击的链接），您最好滑动*它*而不是图像。代替上述方法，请执行以下操作：

```
.box {
    // ...
    overflow: hidden; // added
} 
```

在你的 javascript 中：

```
$('div.box').hover(function() {
    $(this).find(".image").animate({top:'200px'},{queue:false,duration:500});
}, function() {
    $(this).find(".image").animate({top:'0px'},{queue:false,duration:500});
}); 
```

请注意，我们现在正在跟踪 上的`hover`事件`div.box`，并向下滑动`div.image`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T12:57:15.707

它适用于

```
position:relative; 
```

也可以，但您需要将 JS 更改为：

```
$('div.webpreview').hover(....); 
```

因为您的页面中没有“图像”类的 div :)

对于可点击的链接：

风格：

```
.webpreview  img {
    height: 100%;
    position:relative;
    overflow:hidden;
    width: 100%;
    z-index:100;//note this
}

.box .linkDiv{
       top:-300px;
       position:absolute;
       overflow:hidden;
       z-index:200;
} 
```

JS：

```
$(document).ready(function() {
$('div.box').hover(
        function(){
             $('div.webpreview',$(this)).find("img").animate(
                      {top:'200px'},{queue:false,duration:1000});
            $("div.linkDiv", $(this)).animate({top:'0px'},
                      {queue:false, duration:500});
        },

        function(){
            $('div.webpreview',$(this)).find("img").animate(
                         {top:'0px'},{queue:false,duration:1000});
            $("div.linkDiv",$(this)).animate({top:'-300px'},
                         {queue:false, duration:500});
        }
        );
}); 
```

HTML：

```
<div class="box">
 <div class="linkDiv">
    <strong>Client :</strong> Sous le charme des Ã©rables<strong><br>
      Manda : </strong>Conception et rÃ©alisation<br>
      <strong>Adresse : <a href="http://www.souslecharme.ca/" 
           target="_blank">www.souslecharme.ca</a></strong>
</div>
  <div class="webpreview"><img src="test-portfolio_files/souslecharme.jpg"></div>
</div> 
```

您也可以通过更改包含链接的 div 的**z-index来做到这一点：**

```
 $('div.box').hover(
        function(){
            $('div.webpreview',$(this)).find("img").animate(
                        {top:'200px'},{queue:false,duration:1000});
            $("div.linkDiv", $(this)).css("z-index","200");
        },

        function(){
            $('div.webpreview',$(this)).find("img").animate(
                       {top:'0px'},{queue:false,duration:1000});
            $("div.linkDiv", $(this)).css("z-index","50");
        }); 
```

# php - PHP过滤非标准字符

> ID：1023784
> 
> 赞同：2
> 
> 时间：2009-06-21T12:24:24.463
> 
> 标签：php, javascript, utf-8

我将文本作为用户输入，并且在文本中的某处没有标准字符。

文本存储到数据库中。一切都在 UTF-8 中，它运行良好，只是它为非标准字符显示奇怪的符号。

如何在 PHP 中过滤这些字符？

* * *

我发现带有错误字符的文本“正确”地存储在数据库中。当文本将显示在静态 UTF-8 编码的 HTML 页面上时，将显示损坏的字符。但是当通过 AJAX 加载文本时，它会崩溃并且加载操作失败。所以我认为这仍然是一个 AJAX 编码问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T12:34:59.327

Unicode（和 UTF-8 等编码）包含的字符比大多数操作系统所能显示的要多得多，这仅仅是因为典型用户不需要所有可能的可用字符。

这可能意味着您的一位用户拥有他们系统上的输入字符，但您的系统上没有；UTF-8 不关心你能看到什么，只关心它需要存储什么。例如，如果某人有一个匈牙利名字，如 Paul Erdős（注意 O 上的时髦斜线），则该字符可能并非在所有系统上都可用。

因此，正如另一个答案所说，您可能需要追踪这些符号的来源，以查看您的客户是否真的需要显示它们，或者您需要将它们翻译成其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-25T12:24:08.063

您使用哪种“类型”的 AJAX，以及使用哪个库（如果有）？您是加载 XML 文件或 HTML 文件以显示还是仅加载 div.innerHTML = myRequestetContent 的简单字符串？

如果您使用 XML，那么您可能会在此处遇到不同的问题：XML 声明中没有字符集（因此是错误的字符）和非转义的 xml 实体（如 & 或 < 或 >）可能会使您的 XML 无效并因此破坏 AJAX 函数。

前者可以通过在 xml 文件中的声明中添加正确的字符编码来修复，例如PHP 中`<?xml version="1.0" encoding="UTF-8">`的[htmlspecialcharacters](http://us.php.net/manual/en/function.htmlspecialchars.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-25T15:04:58.680

您绝对应该考虑将 AJAX 响应页面更改为使用 CDATA 将数据作为 XML 格式的结果返回。那么我很确定你是安全的。

如果您不确定 CDATA 是什么，请查看此处：[http ://en.wikipedia.org/wiki/Cdata](http://en.wikipedia.org/wiki/Cdata)

看看这个使用 PHP 的 XMLWriter 对象的例子：http: [//php.net/xmlwriter_write_cdata](http://php.net/xmlwriter_write_cdata)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T12:29:23.830

这些“奇怪的字符”可能源于错误的字符编码（用户输入不是 UTF-8 编码的）或用于表示这些字符的字体中缺少字形。

所以你应该首先找到这些“奇怪字符”的真正原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T10:06:47.120

我使用 PHP 中的一组函数来检查、转换和将字符转换为 UTF-8。我很久以前从网上的某个地方获得了这些功能，所以遗憾的是不能为它们提供任何功劳，但希望它们有所帮助。

[用于将字符转换为大约 UTF-8 的 PHP 函数](http://gist.github.com/174613)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-21T12:59:51.710

使用功能：

```
$htmlEntitiesString = htmlentities($inputString); 
```

它会将 é í ä 等所有字符转换为 HTML 实体，确保您不会遇到像 'é' 变成 'Á@' 或类似的问题。

# linux - 适用于 Linux/Windows 的轻量级 SQL 服务器？

> ID：1023785
> 
> 赞同：4
> 
> 时间：2009-06-21T12:24:59.783
> 
> 标签：linux, database, windows, sqlite

SQLite 作为单一访问数据库很好，但如果一次由多个用户使用，它就会有风险。MySQL、Firebird、PostgreSQL 等更难部署，而且对我的使用来说太过分了。

理想情况下，我想要一个紧凑的单 EXE 服务器，旨在运行在低规格硬件（例如 128MB RAM、256MB 闪存 RAM）上，它与 SQLite 一样易于使用，并且可用于 Linux（和 Windows ，所以我可以在客户端使用相同的代码，以防客户更喜欢普通 PC。）

您知道符合这些要求的应用程序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T07:26:31.210

试试[火鸟](http://www.firebirdsql.org/)。它是跨平台且轻量级的。数据库由单个文件组成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-18T12:45:20.047

试试 H2，它是一个基于 Java 的 SQL 数据库引擎.....

*   非常快，开源，JDBC API
*   嵌入式和服务器模式；内存数据库
*   基于浏览器的控制台应用程序
*   占用空间小：大约 1.5 MB jar 文件大小

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T12:36:48.683

您可以尝试查看 Apache Derby ( [http://db.apache.org/derby/](http://db.apache.org/derby/) )。它是 Java，所以它是可移植的，而且绝对是轻量级的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-05T12:08:19.297

另一种选择是[HSQLDB](http://hsqldb.org/)。它是轻量级、完全 Java 和多线程的。我在个人项目中使用效果非常好。

# java - 审计大型 java/j2ee Web 应用程序的最佳方法是什么

> ID：1023786
> 
> 赞同：15
> 
> 时间：2009-06-21T12:25:30.950
> 
> 标签：java, jakarta-ee, audit

我必须审核一个已经发展了几年的大型 Web Java/J2ee 应用程序。它是由其他公司编写的，而不是我正在工作的公司。在目前的状态下，它已经变得难以发展和维护，新功能难以添加，并且经常导致有时会出现在生产中的错误。似乎有一些复制/粘贴的代码导致代码重复。当前的应用程序是某种在线购物，到处都有一些类似 cms 的内容。在代码的较新部分中主要是 Struts 和一些 Spring，也许是一些 ejbs 投入了很好的衡量。有一些可用的单元测试，但不是很多。这些是我被告知的事情，我还没有看到实际的代码。

我的公司将提议重写此应用程序的部分内容，以降低复杂性、提高质量和模块化，并使其能够添加更简单的新功能而不会出现回归。在做出任何承诺之前，他们希望对现有代码的质量有所了解，并评估其中有多少可以重用，以便对必须要做的事情有更多的猜测——完整重写或部分重写。

问题是我必须在很短的时间内（几天）内完成这项工作，所以我正在努力制定一个在这么短的时间内可以完成的计划。我在想的是：

*   查看“基本”内容 - 异常处理、日志记录
*   查看分层级别（视图、控制器、dao 层）
*   测量单元测试的实际覆盖率
*   也许在项目上运行一些 Checkstyle、Findbugs 和 PMD
*   ...

所以实际的问题是我应该考虑/检查/测量/等哪些其他事情？

我不确定我能从中得到什么样的数字，如果它真的意味着什么，我觉得管理层的要求是一种错误的方法，所以第二个问题是：有没有人有更好的主意？

我将不胜感激任何想法，建议，对此发表评论。

编辑：我将添加两个死码检测器：[UCD](http://www.ucdetector.org/)和[DCD](https://dcd.dev.java.net/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T18:28:55.113

我有两个与您具有相似设置的 Web 应用程序。我停止使用 FindBugs 和 Checkstyle，因为它们显示了超过 10.000 个问题点。应用程序使用 JDBC 级别的数据访问、用于表示的 JSP 和用于请求分派的自定义框架。对我来说幸运的是，这些低级设置使我能够在中等难度下进行扩展和修复。在 3 年的项目中，只有大约 20% 的原始代码保持原样。迟早，其他一切都需要更改、替换或删除（最后我能够使用 FindBugs 和 Checkstyle）。

我们也面临着完全重写的困境。但是，有几个因素不利于它：

*   不确定客户是否会为完全重写付费。
*   缺乏功能和技术文档使得进行完全重写存在风险。
*   完全理解完整应用程序的工时太高了。客户希望尽快进行请求的更改。
*   习惯于演示和页面行为的用户。似乎很难说服用户为旧功能使用新界面。
*   如果我们进行完全重写，我们需要提供完整的文档。对于更新，我们只需要记录我们的部分。
*   如果程序有效（或多或少），很难说服管理层（自己和客户的）重写
*   该公司有自己的 PMD 规则，代码没有通过。更简单的说法是，新零件通过测试就足够了。

它归结为您实际上想要做的事情。

你想重写，尽管很复杂？

*   把重点放在代码错误上。带有大量红色的大饼图令人信服。
*   解释程序属性以及它们如何不符合公司愿景。
*   显示超出当前要求的增强选项，并描述当前版本如何无法应对挑战。
*   采访真实的用户。他们可能会指出当前版本的重要问题。
*   便宜但很好的估算器。您可能会将一些成本推迟到维护阶段。

你不想重写？

*   强调成本，尤其是客户重新测试所有东西所需的工时。
*   指出破坏功能的潜在麻烦。
*   要求一个全职的文件编写者。

如果您想品尝代码，请尝试添加 Hello World！应用程序的功能/屏幕。这说明了您实施新事物的难度和速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T23:44:37.800

事实上，他们不会为完全重写付费，因为：

*   这是经济衰退，你从头开始重写的成本会很高

*   他们可能正试图尽快出售公司

*   管理层对软件开发一无所知

我首先要了解一些简单的事实：

*   使用工具显示项目的SLOC
*   按照您的计划运行 FindBugs 并最终运行 PMD，只是为了估计缺陷
*   进行快速分析会议
*   检查不同的图层
*   查看资源是否普遍关闭（Streams、Hibernate 或 JDBC 连接等）
*   查看是否在不适用的地方使用了技术（EJB、Web 服务等）
*   了解他们如何处理异常和日志记录
*   看看是否有太多或没有足够的抽象
*   看看你是否可以添加一些基类来减少代码重复

如果他们没有为您提供有关它的文档，请尝试绘制应用程序架构的快速图表。

收集一些统计数据和一些事实，写一份报告并发送给公司。他们会希望将成本降到最低，并且会要求您避免修复未损坏的代码。你从统计数据开始，然后是事实和一个带有时间/受影响代码的近似百分比/定价的命题。

通常遗留的 Struts 应用程序是一个需要维护的皮塔，一直在那里。如果这不是你工作的一部分，我会说放手。如果您遇到“独立”页面，这些页面不涉及很多模板并且会进行很多更改，建议您使用其他技术重写它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T13:44:57.093

我非常喜欢你的清单。我认为你有一个很好的进攻计划开始。

我会着眼于对 Spring 或 EJB 3.0 进行标准化，但不会同时对两者进行标准化。

我自己没看过，不知道 Michael Feathers 的书[《Working Effectively With Legacy Code》](https://rads.stackoverflow.com/amzn/click/com/0131177052)有什么好的想法吗？

更新：

也许您可以通过将它们置于自动化构建和持续集成中来帮助它们——Cruise Control、Hudson 或 Team City。如果您必须进行任何重构，它会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-21T15:29:00.830

您关注的是可维护性和可扩展性。

我会补充一下重新启动项目需要多长时间。他们使用源代码控制吗？他们是否有用于集成和用户验收测试的单独环境？有构建服务器吗？

当您必须在第一个改进出现之前花费两个月的时间时，有人需要预先管理客户的期望。

# asp.net - 如何在 Web 窗体应用程序中使用 System.Web.Abstractions？

> ID：1023787
> 
> 赞同：2
> 
> 时间：2009-06-21T12:27:57.310
> 
> 标签：asp.net, webforms, system.web.abstractions

我正在开发一个 Web 表单应用程序，该应用程序打算移植到 MVC 以用于其 vNext +1 版本。但目前它是一个 .NET 3.5 SP1 Web 表单应用程序。

我想要有我们自己的*上下文*，它在标准 HttpContext/ HttpRequest/ HttpResponse/ 等对象之上提供了一些帮助。另外，我希望将 HttpContext 类与上下文分离。

因为打算使用 MVC，所以我认为让我们的自定义上下文与 System.Web.Abstractions 程序集中附带的 HttpContextBase（和相关类）一起工作是个好主意。

我不想设计一个解决方案来解决目前的一些问题，但需要重新编写以在 MVC 中实现可测试性（并且在 MCV 中毫无用处）但我到目前为止所取得的成就似乎并不是有用。

问题是我找不到任何好的例子来说明如何实现这一点，如何扩展`HttpContextWrapper`，或者`HttpContextBase`你可以保持关注点分离。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T17:42:09.743

为HttpContext写一些扩展方法还不够吗？我已经在我当前的应用程序中做到了这一点，并且效果很好。我想这取决于您希望自定义 HttpContext 类有多复杂，以及它是否旨在表示与标准 HttpContext 所表示的内容根本不同的东西。不过，我真的想不出一个场景。也许您可以详细说明您的自定义 HttpContext 的外观？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T00:28:29.997

您不需要重写 HttpContextWrapper 或 HttpContextBase 来实现此目的，而是让您的自定义上下文与 HttpContextBase 对象一起工作，这样您就可以单独测试您的自定义上下文。

```
public class MyContext
{

    // helper methods work with this context
    HttpContextBase _ctx;

    public MyContext(HttpContextBase context)
    {
        _ctx = context;
    }

} 
```

当您在实际应用程序中创建自定义上下文时，只需使用初始化

```
new MyContext(new HttpContextWrapper(HttpContext.Current)); 
```

# php - zend 不使用列，并选择所有内容

> ID：1023789
> 
> 赞同：7
> 
> 时间：2009-06-21T12:28:24.563
> 
> 标签：php, zend-framework, zend-db

我有以下代码

```
$result = $handle->select()->from('store_details')
                               ->where('store_details.store_id=?', $id)
                               ->columns('store_details.store_name');
                               //->query(ZEND_DB::FETCH_OBJ); 
```

但是，当我运行它时，会选择整行，而不仅仅是我想要的列。这是 __toString 的输出

```
SELECT `store_details`.*, `store_details`.`store_name` 
FROM `store_details` WHERE (store_details.store_id=8) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-21T12:30:12.597

该`columns()`方法用于*将*列添加到现有的**from**或**join**。构建查询的正确方法是：

```
$result = $handle->select()->from('store_details','store_details.store_name')->where('store_details.store_id=?', $id); 
```

您需要将所需的列指定为 from() 方法的第二个参数，如果它只是一列，则指定为字符串，或者指定为多列的数组。来自[`Zend_Db_Select docs`](http://framework.zend.com/manual/en/zend.db.select.html)：

> 在 from() 方法的第二个参数中，您可以指定要从相应表中选择的列。如果不指定列，则默认为“*”，即“所有列”的 SQL 通配符。
> 
> 您可以在一个简单的字符串数组中列出列，或者作为列别名到列名的关联映射。如果您只有一列要查询，并且不需要指定列别名，则可以将其列为纯字符串而不是数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T22:16:53.687

如果您已经有了 select 对象（意味着`from()`之前调用过），您应该像在示例中那样使用`$select->reset(Zend_Db_Select::COLUMNS);`然后调用。`columns()`

# c# - C# 和参数化 SQLite，无需通过 ADO.NET

> ID：1023792
> 
> 赞同：0
> 
> 时间：2009-06-21T12:29:02.880
> 
> 标签：c#, sqlite, parameterized

是否有可能，如果可以，如何... 使用 SQLite 进行参数化查询，而无需通过 ADO.NET。我被要求使用 SQLite 对需要进行零管理安装的项目进行一些测试......即：没有特殊权限，添加到 Windows 注册表的东西等。我怀疑使用 ADO.NET 会需要这样，即使 SQLite 只是位于项目目录中的 DLL。

是的，我确实理解参数化查询的重要性以及如果不安全处理可能由 SQL 注入引起的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T12:31:53.560

是什么让您认为 ADO.NET 需要注册表项等？它没有。您只需要安装 .NET 和适当的提供程序程序集。

现在，您将不需要*所有*ADO.NET - 例如，如果您愿意自己使用适当的类型，您可能不需要`DataTable`/支持- 但同样，如果您*确实*想使用它们（甚至强烈键入的版本）您不需要任何特殊设置。`DataSet``DataReader`

 *当然， SQLite 提供程序*可能*对注册表有自己的要求，但我*非常*怀疑。这将违背我的“正常”ADO.NET 提供程序体验，以及违背 SQLite 的正常使用。

我希望有各种 SQLite 提供程序。例如，这里有[一个](http://sqlite.phxsoftware.com/)结合了 .NET 部分*和*SQLite 本身的本机代码，因此据我所知，只有一个 DLL 可以与您的应用程序一起部署。没有比这更简单的了。*

# palm-os - NSBasic/Palm 4.4 教程

> ID：1023810
> 
> 赞同：1
> 
> 时间：2009-06-21T12:42:51.370
> 
> 标签：palm-os, garnet-os

有人可以向我推荐一个非常好的 NSBasic 4.4 教程（请发布链接）。我来自 Handheld Basic 背景，然后我最近使用了一个朋友的另一个 IDE，它有一个 NSBasic 版本，但我的朋友在 Handheld Basic 中开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T23:54:32.367

对于 NSBasic，如果有帮助，请检查[技术](http://www.nsbasic.com/desktop/info/technotes/)说明。或者这个巴西[网站](http://tutomania.com.br/livro/apostila-de-ns-basic--palm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-14T05:24:00.030

有一本关于 NSBasic/Palm 的好书，名为[NS Basic Programming for Palm OS](https://rads.stackoverflow.com/amzn/click/com/0969584466)。这可能是关于核心语言和 UI 设计器的最佳教程。它的印刷量并不大，因此在亚马逊和 half.com 上使用的副本仍然在 25-30 美元的范围内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-03T15:34:46.230

NS Basic/Palm 7 是当前版本。它带有完整的教程菜单。另外，请查看技术说明。

如果您下载演示，您将在帮助菜单下看到教程。

NS Basic/Palm 4.4 已经有好几年了。

# python - 如何在 Perl 中有变量断言？

> ID：1023813
> 
> 赞同：7
> 
> 时间：2009-06-21T12:45:21.193
> 
> 标签：python, perl, debugging, assertions

如何检查变量在 Perl 中是否具有特定值？是否有停止脚本执行以查找其中一些变量的命令？

我想知道我是否可以使用 Pythonic 的插入实践：

```
 assert 0, (foo, bar) 
```

以无调试器的方式调试脚本？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T12:58:04.723

快速 CPAN 搜索建议[Carp::Assert](https://metacpan.org/pod/Carp::Assert)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-21T12:58:05.330

见[鲤鱼::断言](http://metacpan.org/pod/Carp::Assert)：

> ```
> use Carp::Assert;
> 
> $next_sunrise_time = sunrise();
> 
> # Assert that the sun must rise in the next 24 hours.
> assert(($next_sunrise_time - time) < 24*60*60) if DEBUG;
> 
> # Assert that your customer's primary credit card is active
> affirm {
>     my @cards = @{$customer->credit_cards};
>     $cards[0]->is_active;
> }; 
> ```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-21T13:44:06.503

[Smart::Comments](http://search.cpan.org/perldoc?Smart::Comments) are nice.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-21T12:54:23.903

[PerlMonks](http://www.perlmonks.org/?node_id=391780)有一个脚本，它介绍了一种快速断言方法。

速度很重要，因为 Perl 被解释并且任何内联检查都会影响性能（例如，与简单的 C 宏不同）

* * *

我不确定这些东西是否可以直接使用。

*   默认安装中有[Test::Harness](http://search.cpan.org/perldoc?Test::Harness)。这[是一个入门教程](http://tomacorp.com/perl/harness/index.html)。最新的模块是[TAP::Harness](http://search.cpan.org/perldoc?TAP::Harness)
*   按照您所说的方式，较慢的版本是[Sub::Assert](http://search.cpan.org/perldoc?Sub::Assert)

* * *

好的！这就是我一直在寻找的[——PDF 警告：Test-Tutorial.pdf](http://www.wgz.org/chromatic/perl/Test-Tutorial.pdf)。`Test::Harness`用于编写 Perl 模块测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T13:51:18.873

```
$var_to_check =~ /sometest/ or die "bad variable!"; 
```

I tend to throw things like this in my code, and later use a find and replace to get rid of them (in production code).

Also, '[eval](http://perldoc.perl.org/functions/eval.html)' can be used to run a section of code and capture errors and can be used to create exception handling functionality. If you are asserting that a value is not 0, perhaps you want to throw an exception and handle that case in a special way?

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-14T17:50:37.030

```
if ( $next_sunrise_time > 24*60*60 ) { warn( "assertion failed" ); } # Assert that the sun must rise in the next 24 hours. 
```

如果您无权访问[Carp::Assert](http://search.cpan.org/perldoc?Carp%3a%3aAssert)所需的 Perl 5.9，则可以执行此操作。

# silverlight - Silverlight 数据绑定选择？

> ID：1023814
> 
> 赞同：2
> 
> 时间：2009-06-21T12:45:42.377
> 
> 标签：silverlight, data-binding

任何人都可以解释silverlight/wpf数据绑定实际上是如何确定在集合中设置为selectedItem的正确项目，如下面的片段

```
<ComboBox SelectedItem="{Binding Mode=TwoWay, Path=Province}" 
           ItemsSource="{StaticResource ProvinceCollection}" /> 
```

ProvinceCollection 只是一个静态字符串数组。

在此示例中，项目是字符串，因此值类型非常简单，但是当集合包含更复杂的内容（例如在运行时加载的对象实例）时，它如何知道将什么设置为选定项目。(Datacontext).Province 的对象引用和 ProvinceCollection 中的项目不会相同，即使我认为它们应该相同。

我打算这样做，让数据绑定从集合中选择一个项目，其中当前数据上下文的项目不在集合中（即没有具有相同对象引用的项目）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T15:47:08.843

我自己也遇到过这个讨厌的问题，不幸的是，在 Silverlight 2 中它使用了 Object.ReferenceEquals（在反射器中检查），所以它实际上必须是同一个对象。这非常令人恼火。恐怕你无能为力:(

这已在 Silverlight 3（至少是 Beta 版）中修复，它现在使用 Equals，因此您可以使用覆盖 Equals 方法的技巧。

# java - 用 Java 实现的 Bittorrent Peer Wire 协议

> ID：1023816
> 
> 赞同：6
> 
> 时间：2009-06-21T12:46:14.670
> 
> 标签：java, p2p, bittorrent, peer-wire-protocol

我有几个关于 Bittorrent Peer Wire 协议的问题。我正在尝试使用[此规范](http://wiki.theory.org/BitTorrentTrackerProtocol)在 Java 中实现它。

在 Peer Wire Protocol 部分中，它说所有整数都是四字节大端值。AFAIK java使用大端。这是否意味着说如果我想发送窒息消息

扼流圈：<len=0001><id=0>

我只是写到sokcet 1，然后写0吗？

至于我的第二个问题。当请求一块时，我认为多个文件是一个大的连续文件吗？还是考虑单个文件？因为片段长度不会与文件对齐​​，所以一个索引可以同时包含一个文件的结尾和另一个文件的开头？

至于我的最后一个问题，当我打开与对等方的连接并发送我的握手时，我是继续请求片段还是请求然后等待一段时间，看看它是否会向我们请求一些东西？谈话是如何进行的？我主要完成了 http 类型的网络编程，我要求一些东西等待响应。但如果我一直要求件，我将如何发送件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-22T21:51:26.920

## 问题 1

坚持简单的方法，如果您使用基于流的 I/O，则在编写基本类型（例如**byte**、**int**、**long**等）时使用[DataInputStream](http://java.sun.com/javase/6/docs/api/java/io/DataInputStream.html)和[DataOutputStream ：](http://java.sun.com/javase/6/docs/api/java/io/DataOutputStream.html)

 ******```
Socket s; // assume this is already connected
DataOutputStream out = new DataOutputStream( s.getOutputStream );
out.writeByte( 1 );
out.writeInt( 0 );
out.flush(); // optional 
```

如果您使用的是非阻塞 I/O（例如 java.nio 包中的类），则使用[ByteBuffer](http://java.sun.com/javase/6/docs/api/java/nio/ByteBuffer.html) s：

```
Socket s; // assume this is already connected
SocketChannel = s.getChannel();
ByteBuffer buf = ByteBuffer.allocate(8); // two 4-byte integers
buf.put( 1 ).putInt( 0 );
buf.flip();
c.write( buf ); // assuming channel is writable :) 
```

这些方法中的每一个都将代表您处理字节排序问题。

## 问题2

（请注意，通常您在电线上传输**块**，它们是碎片的碎片。我会在这里掩饰它:)）

发送/接收片段时，最好将文件（或文件）视为连续的，就像你说的那样。.torrent 文件在信息字典中包含有关文件边界的信息。在[多文件情况下](http://wiki.theory.org/BitTorrentSpecification#Info_in_Multiple_File_Mode)，每个文件都有路径和长度；[单个文件案例](http://wiki.theory.org/BitTorrentSpecification#Info_in_Single_File_Mode)有一个可选的名称和长度。由于您知道片段大小、片段数量和总内容长度（全部来自 .torrent 文件），因此您可以在收到片段时将片段“放在正确的位置”。

一个简单的事情是创建一个与 torrent 大小相等的文件。当您收到一个片段时，将其写入该单个文件（有时称为“.downloading”文件）中的正确字节偏移量。例如，考虑一个包含两个文件的种子：

```
a/b/file1.txt [100 bytes]
a/b/file2.txt [200 bytes]

piece size (pz) = 50 bytes
total size (tz) = 100+200 = 300 bytes
number pieces (np) = 300/50 = 6
file = my_torrent.downloading 
```

假设我们从零开始对片段和字节偏移进行编号。假设您收到了第 1 部分的所有内容。它在 my_torrent.downloading 中的（开始）字节偏移量是多少？它位于 (1*pz) = (1*50) = **50**。第 0 块去哪儿了？在 (0*pz) = (0*50) = **0**处。等等...

我敢打赌，现在您可以弄清楚如何将此 .downloading 文件转换为种子中的“真实”内容。

## 问题 3

加入 BitTorrent swarm 时，您将**同时**向多个对等方上传和下载片段。想一想那个。在您向某个同伴请求一块的同时，另一个同伴可能正在向您做同样的事情。正如您已经指出的，与 HTTP 的语义完全不同。因此，要直接回答您的问题，其他同行会要求您提供他们感兴趣的数据。:)

只是为了确保，在您向对等方请求片段之前，请确保对等方拥有您想要的片段（检查[位域并有消息](http://wiki.theory.org/BitTorrentSpecification#Messages)）并且您已经尊重正确的[窒息/感兴趣](http://wiki.theory.org/BitTorrentSpecification#Choking_and_Optimistic_Unchoking)的行为。**鉴于此，您通常想要做的是以最稀有的第一**顺序从已知对等点列表（跟踪器或 DHT 告诉您的）请求数据。规范谈到了这一点，这里有很多优化和礼貌考虑。（例如，以牙还牙的行为。）您可能会注意到[规范](http://wiki.theory.org/BitTorrentSpecification)并没有详细说明这一点。这是因为 BitTorrent 客户端的许多秘诀都在于这部分实现。:)

我希望这对你有所帮助！******

# php - ExtJS：PHP 中的解码值

> ID：1023817
> 
> 赞同：1
> 
> 时间：2009-06-21T12:47:39.317
> 
> 标签：php, extjs, decode

有什么方法可以让我也享受`decodeValue()`PHP 中的功能吗？我将这些编码值值发布到 PHP 文件中，我需要在 PHP 中将它们作为数组使用。

我怎样才能得到一个 PHP 数组或 Ext 中编码状态的东西？或者，有没有其他方法可以让我处理编码值以便能够在 PHP 中轻松读取它们？这是功能代码：

```
decodeValue : function(cookie){
        var re = /^(a|n|d|b|s|o)\:(.*)$/;
        var matches = re.exec(unescape(cookie));
        if(!matches || !matches[1]) return; // non state cookie
        var type = matches[1];
        var v = matches[2];
        switch(type){
            case "n":
                return parseFloat(v);
            case "d":
                return new Date(Date.parse(v));
            case "b":
                return (v == "1");
            case "a":
                var all = [];
                var values = v.split("^");
                for(var i = 0, len = values.length; i < len; i++){
                    all.push(this.decodeValue(values[i]));
                }
                return all;
           case "o":
                var all = {};
                var values = v.split("^");
                for(var i = 0, len = values.length; i < len; i++){
                    var kv = values[i].split("=");
                    all[kv[0]] = this.decodeValue(kv[1]);
                }
                return all;
           default:
                return v;
        }
    } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T13:58:08.283

下面是我对 PHP 的移植。我使用 DateTime 类代替 Date 因为它是最接近的 PHP 等价物，但您也可以使用 strftime() 来获取 Unix 时间戳，或任何您喜欢的方法。此外，对于 'o' 类型，我返回一个数组而不是一个对象，由对象的参数名称键入。

这是代码：

```
function decodeValue($cookie) {
    $cookie = urldecode($cookie);
    $re = '/^(a|n|d|b|s|o)\:(.*)$/';
    $matches = array();
    preg_match($re, $cookie, $matches);
    if(!$matches || !$matches[1]) return; // non state cookie
    $type = $matches[1];
    $v = $matches[2];
    switch ($type){
        case "n":
            return floatval($v);
        case "d":
            return new DateTime($v);
        case "b":
            return ($v == "1" ? true : false);
        case "a":
            $all = array();
            $values = explode('^', $v);
            $len = count($values);
            for ($i = 0; $i < $len; $i++) {
                $all.push(decodeValue($values[$i]));
            }
            return $all;
       case "o":
            $all = array();
            $values = explode('^', $v);
            $len = count($values);
            for($i = 0; $i < $len; $i++){
                $kv = explode('=', $values[$i]);
                $all[$kv[0]] = decodeValue($kv[1]);
            }
            return $all;
       default:
            return $v;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-16T20:19:18.510

修复了代码中的一个错误。现在二级/三级数组应该可以正常工作。

```
function decodeValue($cookie) {
    $cookie = urldecode($cookie);
    $re = '/^(a|n|d|b|s|o)\:(.*)$/';
    $matches = array();
    preg_match($re, $cookie, $matches);
    if(!$matches || !$matches[1]) return $cookie; // non state cookie
    $type = $matches[1];
    $v = $matches[2];

    switch ($type){
        case "n":
            return floatval($v);
        case "d":
            return new DateTime($v);
        case "b":
            return ($v == "1" ? true : false);
        case "a":
            $all = array();
            $values = explode('^', $v);
            $len = count($values);
            for ($i = 0; $i < $len; $i++) {
                $all.array_push(decodeValue($values[$i]));
            }
            return $all;
       case "o":
            $all = array();
            $values = explode('^', $v);
            $len = count($values);
            for($i = 0; $i < $len; $i++){
                $kv = explode('=', $values[$i],2);
                if(count($kv)==1){
                    $all[] = decodeValue($kv[0]);
                }else{
                    $all[$kv[0]] = decodeValue($kv[1]);
                }
            }
            return $all;
       default:
            return $v;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-23T02:06:11.147

```
$all.array_push(decodeValue($values[$i])); 
```

需要替换为

```
$all[] = decodeValue($values[$i]); 
```

# php - 第二次或第三次出现符号

> ID：1023820
> 
> 赞同：1
> 
> 时间：2009-06-21T12:49:10.153
> 
> 标签：php, regex

在 PHP 中

```
$regex = '/ ([$]) *(\d+(:?.\d+)?)/';
preg_match($regex, $str, $matches);

print_r($matches[2]); 
```

`$`这个正则表达式让我第一次出现在网页中第一次登录之后的数字。

现在我想要一个正则表达式，它可以在第二个符号之后给我数字，`$`也可能是第三个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T12:58:59.510

您正在寻找的是*[preg_match_all](http://php.net/preg_match_all)*函数。

```
preg_match_all('/([$])*(\d+(:?.\d+)?)/', $str, $result, [flags]); 
```

*$result按照**flags*指定的顺序包含数组中的所有匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T13:32:34.497

Second result should be $result[1](http://us2.php.net/preg_match_all), third $result[2] and so on.

Edit*

You don't want to actually use [flags], but one of the "flags" found [here](http://us2.php.net/preg_match_all).

You probably want something along the lines of:

```
<?php
// The \\2 is an example of backreferencing. This tells pcre that
// it must match the second set of parentheses in the regular expression
// itself, which would be the ([\w]+) in this case. The extra backslash is
// required because the string is in double quotes.
$html = "<b>bold text</b><a href=howdy.html>click me</a>";

preg_match_all("/(<([\w]+)[^>]*>)(.*)(<\/\\2>)/", $html, $matches, PREG_SET_ORDER);

foreach ($matches as $val) {
    echo "matched: " . $val[0] . "\n";
    echo "part 1: " . $val[1] . "\n";
    echo "part 2: " . $val[3] . "\n";
    echo "part 3: " . $val[4] . "\n\n";
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T13:04:08.737

preg_match 只匹配第一次出现的正则表达式，如果你使用[preg_match_all](http://php.net/preg_match_all)，你会得到你想要的数组。

# c# - C# 通过参数解析字符串 Domain="LESSING",Name="Admin"

> ID：1023825
> 
> 赞同：1
> 
> 时间：2009-06-21T12:51:57.293
> 
> 标签：c#, string, parsing

我有像 \LESSING\root\cimv2:Win32_UserAccount.Domain="LESSING",Name="Admin" 这样的字符串 如何使用框架将其转换为 LESSING\Admin？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T13:00:51.347

如果您确定语法，也许是正则表达式......虽然正则表达式经常被过度使用，但它似乎适合这次：

```
string input = @"\LESSING\root\cimv2:Win32_UserAccount.Domain=""LESSING"",Name=""Admin""";
string output = Regex.Replace(input, @"^.*Domain=""([^""]*)"",Name=""([^""]*)"".*$", @"$1\$2"); 
```

# silverlight - 使用 Silverlight 做广告

> ID：1023832
> 
> 赞同：1
> 
> 时间：2009-06-21T12:55:18.707
> 
> 标签：silverlight, ads, adsense

让我们假设我们有一个完全写在 Silverlight 上的网站。所有导航都发生在 SL 应用程序内部，数据来自服务。

我想在应用程序中添加广告，该广告将在应用程序中的每个导航上发生变化（最终广告应该与当前内容相关）。

**那么如何在这样的网络应用程序中添加广告呢？**

这样做有两个主要问题，我是对的吗？

1.  在 Silverlight 中渲染 html 广告。
2.  **支持相关性（在Google AdSense**等相关广告的情况下）。

AFAIK，有silverlight控件解决了第一点。

我会欣赏任何想法。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T14:47:01.150

我会分割页面的一部分以用于[这样](http://charette.com/journalist/)的广告，或者您可以使用这样的原生 Silverlight 广告轮播[器](http://code.msdn.microsoft.com/SilverlightAdRotator)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T14:43:53.020

以下是使用 Visual WebGUI 在 Silverlight 应用程序上覆盖 HTML 的示例：

[如何在 Visual WebGui Silverlight 应用程序中嵌入 HTML](http://weblogs.asp.net/visualwebgui/archive/2008/07/31/how-to-embed-html-inside-a-visual-webgui-silverlight-application.aspx)

# java - 为什么我会从此 Java 代码中得到空指针异常？

> ID：1023835
> 
> 赞同：1
> 
> 时间：2009-06-21T12:56:11.310
> 
> 标签：java, jdbc

我有一个方法......我找不到错误：

```
 public String getUsernameforID(int id) {
    String statment = "SELECT USERNAME  FROM `BENUTZER` WHERE `ID` = ? ;";
    String username = null;
    try {
        PreparedStatement ps = dbCommunicator.getStatment(statment);  // HERE : NULL POINTER EXECTION
        ps.setInt(1, id);
        ResultSet rs = dbCommunicator.readFromDB(ps);

        if (rs.first()) {
            username = rs.getString("USERNAME");
        }
    } catch (SQLException ex) {
        Logger.getLogger(DBManager.class.getName()).log(Level.SEVERE, null, ex);
    }
    return username; 
```

我认为这是声明......但我怎样才能找到这个呢？我得到一个空指针异常。

编辑：我的 getStatment 方法：

```
 public PreparedStatement getStatment(String st) {
    connect();
    PreparedStatement ps = null;
    try {
        ps = (PreparedStatement) connection.prepareStatement(st);
    } catch (SQLException ex) {
        Logger.getLogger(DBCommunicator.class.getName()).log(Level.SEVERE, null, ex);
    }
    return ps;
    } 
```

例外：

```
Exception in thread "main" java.lang.NullPointerException
    at test.DBCommunicator.getStatment(DBCommunicator.java:107)
    at test.database.DBManager.getUsernameforID(DBManager.java:359)
    at dbtestdrive.Main.main(Main.java:25) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T15:57:08.033

虽然这个问题可能已经解决，但这里有一点关于如何在给定堆栈跟踪的情况下进行调试。

在这种情况下，堆栈跟踪如下：

```
Exception in thread "main" java.lang.NullPointerException
    at test.DBCommunicator.getStatment(DBCommunicator.java:107)
    at test.database.DBManager.getUsernameforID(DBManager.java:359)
    at dbtestdrive.Main.main(Main.java:25) 
```

这表明在该`test.DBCommunicator.getStatment`方法中，a`NullPointerException`被抛出在 的第 107 行的位置`DBCommunicator.java`。

此外，该`getStatment`方法是从该方法中的第 358 行调用`DBManager.java`的`DBManager.getUsernameforID`。

因此，首先应该检查的地方是第 107 行发生了什么`DBCommunicator.java`。

尽管给出的代码片段中没有行号，但可以假设 a`NullPointerException`发生在以下行中：

```
ps = (PreparedStatement) connection.prepareStatement(st); 
```

关于 s 有一件相当普遍的事情`NullPointerException`——它们通常在对`null`引用执行方法调用时出现。在不存在的对象上调用方法将抛出`NullPointerException`.

在上面的代码中，可以预期`connection`变量实际上是`null`，而不是`Connection`.

这应该会导致尝试找出`connection`变量存在的原因，`null`而不是与已初始化的数据库建立有效连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T13:00:58.383

这可能是因为您的查询失败，请尝试将其更改为：

```
String statment = "SELECT USERNAME  FROM `BENUTZER` WHERE `ID` = ?"; 
```

您的原始查询有一个尾随分号，这是非法的。这可能会导致在稍后阶段抛出空指针异常，我建议您发布异常的内容。

编辑：

```
dbCommunicator.getStatment(statment); 
```

应该：

```
dbCommunicator.getStatement(statment); 
```

您将 'statement' 拼写为 'statment'，这对于变量名很好，但在引用方法时则不然：)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T13:01:18.897

```
//Ending ";" inside the string, is not neccessary.
String statment = "SELECT USERNAME  FROM `BENUTZER` WHERE `ID` = ? ;"; 
```

代替：

```
PreparedStatement ps = dbCommunicator.getStatment(statment);

PreparedStatement ps = dbCommunicator.prepareStatement(statment); 
```

这就是我使用 oracle 所拥有的。

# c# - 检索 SQL Server 表中特定范围的行

> ID：1023841
> 
> 赞同：7
> 
> 时间：2009-06-21T12:58:31.523
> 
> 标签：c#, .net, sql-server-2008, ado.net

我有一个像 (OrderID [uniqueidentifier], OrderDescription [nvarchar]) 这样的表结构，我使用的是 ADO.Net + C# + VSTS 2008 + SQL Server 2008。表很大，我想让客户端给我两个输入，开始范围索引和结束范围索引，我将返回范围内的表的特定行（在开始范围索引和结束范围索引之间）。

比如客户端给我输入50，100，我想返回第50行直到第100行。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-21T13:04:28.517

您可以`ROW_NUMBER`在 TSQL（2005 年以后）中使用来执行此操作：

```
SELECT  ID, Foo, Bar
FROM     (SELECT  ROW_NUMBER() OVER (ORDER BY ID ASC) AS Row,
          ID, Foo, Bar
FROM    SomeTable) tmp
WHERE   Row >= 50 AND Row <= 100 
```

或者使用 LINQ-to-SQL 等：

```
var qry = ctx.Table.Skip(50).Take(50); // or similar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T13:01:23.780

基本上，您在 SQL Server 2005 和 2008 中的最佳选择是 CTE - 公用表表达式 - 其中包含 ROW_NUMBER() 函数 - 如下所示：

```
WITH MyOrders AS
(
  SELECT
    OrderID,
    OrderDescription,
    ROW_NUMBER() OVER (ORDER BY OrderID) as 'RowNum'
  FROM YourOrders
)
SELECT * FROM MyOrders
WHERE RowNum BETWEEN 50 AND 100 
```

但这需要一个有用且合适的`ORDER BY`子句，按 GUID 排序确实不是一个好主意。DATETIME 或不断增加的 ID 是最好的。

马克

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T13:07:41.770

试试这个，结果将按**OrderID**列排序。用您的表更改**MyTable 。**

```
SELECT * 
FROM ( SELECT *, ROW_NUMBER() OVER (ORDER BY OrderID) AS row FROM MyTable) a 
WHERE row > 50 AND row <= 100 
```

选定的行是从**50**到**100**，但请注意第 50 行不包含在结果中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T13:02:50.207

SELECT * FROM (SELECT *, ROW_NUMBER() OVER (ORDER BY OrderId) as row FROM Orders) a WHERE row > 5 and row <= 10

# php - 回传从 PHP 脚本调用 pmwiki 页面进行验证

> ID：1023847
> 
> 赞同：2
> 
> 时间：2009-06-21T13:00:37.823
> 
> 标签：php, validation, pmwiki

我在 PMWiki 中设置了一个表单。该操作将其发送到一个 php 脚本，该脚本获取信息并执行几个不同的操作。php 脚本需要验证来自 PMWiki 页面的信息。我知道如何做到这一切。但是，如果其中一个字段未通过验证，我想重新加载 PMWiki 页面，其中所有信息仍然填写，但带有错误消息。我的第一个想法是将所有字段发布回起始页面，但我无法做到这一点。我对任何允许我继续以 PMWiki 为基础的解决方案持开放态度，这意味着我无法在自我验证的 PHP 页面中执行表单（我已经为其他站点做过）。如果没有验证，我不想在 PMWiki 之外提供单独的表单。理想情况下，我想要像 header(' 位置：mysite.com/MyPMWikiPage'）；但这将是一个可以将所有字段都发回的帖子。抱歉，如果这看起来很具体，但我知道如何解决这个问题，我想学习如何直接解决这个问题，除非那是不可能的。PMwiki.org 建议进行服务器端验证，但我一直无法找到失败时如何回发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-29T08:03:59.627

您的自定义表单验证与 PmWiki 在处理编辑提交时所做的看起来并没有太大不同。

从[PmWiki/AvailableActions](http://www.pmwiki.org/wiki/PmWiki/AvailableActions)开始，你可以看看它是如何设计的，并研究食谱代码（例如[Cookbook/HtpasswdForm](http://www.pmwiki.org/wiki/Cookbook/HtpasswdForm)），你会看到其他人是怎么做的。

# command-line - 如何抑制特定的 MSBuild 警告

> ID：1023858
> 
> 赞同：108
> 
> 时间：2009-06-21T13:05:05.817
> 
> 标签：command-line, msbuild

从命令行运行 MSBuild 时，有什么方法可以禁用特定的 MSBuild 警告（例如 MSB3253）？我的构建脚本通过以下方式调用 msbuild.exe：

```
msbuild.exe MySolution.sln /t:Rebuild /p:Configuration=Release 
```

我发现我可以使用 msbuild.exe 的另一个参数来抑制 C# 警告（例如 CS0618）：

```
msbuild.exe MySolution.sln /t:Rebuild /p:Configuration=Release /p:NoWarn=0618 
```

但是，此方法不适用于 MSBuild 警告。也许还有另一个魔法属性要设置？

我正在使用 .NET 3.5 和 VS2008。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2011-04-21T09:03:25.137

我已经设法抑制警告级别`/p:WarningLevel=X`

```
msbuild.exe MySolution.sln /t:Rebuild /p:WarningLevel=0 /p:Configuration=Release
                                      ^^^^^^^^^^^^^^^^^
Warning  
Level    Meaning
-------- -------------------------------------------
      0  Turns off emission of all warning messages.

      1  Displays severe warning messages

      2  Displays level 1 warnings plus certain, less-severe warnings, such
         as warnings about hiding class members

      3  Displays level 2 warnings plus certain, less-severe warnings, such 
         as warnings about expressions that always evaluate to true or false

      4  (the default) Displays all level 3 warnings plus informational warnings 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-06-26T08:15:23.250

对于 MSB3253，您只需在项目文件 (*.csproj) 中设置会导致此类警告。

```
 <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <!-- some code goes here -->
    <ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
        None
    </ResolveAssemblyWarnOrErrorOnTargetArchitectureMismatch>
    <!-- some code goes here -->
  </PropertyGroup> 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-06-21T13:26:46.833

According to [this](http://social.msdn.microsoft.com/Forums/en-US/tfsbuild/thread/96b3ea2e-92ed-4483-bbfe-a4dda3231eb9) thread in the MSDN Forum MSBuild warnings can't be suppressed.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-11-29T15:01:52.463

对于那些现在在谷歌上搜索的人（比如我）：即将推出的 MSBuild 15.0（我认为将与 Visual Studio 2017 一起发布）最终将[实现抑制特定警告的`/NoWarn`选项](https://github.com/jeffkl/msbuild/commit/3899b962eec6aca680bc20119dcae065e4ea9232)（以及`/WarnAsError`将特定警告或所有警告视为错误） .

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-09-03T13:30:25.117

最新版本的 MSBuild 通过命令行（[如 EM0 所述](https://stackoverflow.com/a/40869090)）或属性支持此功能：

```
<PropertyGroup>
    <MSBuildWarningsAsMessages>$(MSBuildWarningsAsMessages);MSB3253</MSBuildWarningsAsMessages>
</PropertyGroup> 
```

有关详细信息，请参阅[此评论](https://github.com/dotnet/msbuild/issues/68#issuecomment-343279073)。

我没有找到有关此的官方文档，但在[任务文档](https://docs.microsoft.com/en-us/visualstudio/msbuild/verifyfilehash-task)[中提到了它`VerifyFileHash`](https://docs.microsoft.com/en-us/visualstudio/msbuild/verifyfilehash-task)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2020-11-22T06:50:11.713

替代方案：将其添加到 .csproj。

```
<PropertyGroup>
  <NoWarn>$(NoWarn);MSB3253</NoWarn>
</PropertyGroup> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-20T21:56:55.943

在发布这篇文章时（2021 年），[微软文档](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/errors-warnings)推荐`DisabledWarnings`，这对我有用：

```
<PropertyGroup>
    <DisabledWarnings>3568</DisabledWarnings>
</PropertyGroup> 
```

请注意，省略了“MS”前缀

# math - 在不同时间采样的指数移动平均线

> ID：1023860
> 
> 赞同：54
> 
> 时间：2009-06-21T13:05:56.517
> 
> 标签：math, signal-processing, average, digital-filter

我有一个连续值，我想计算一个[指数移动平均线](http://en.wikipedia.org/wiki/Exponential_moving_average#Exponential_moving_average)。通常我会为此使用标准公式：

*   S [n] = αY + (1-α)S [n-1]

其中 S [n]是新的平均值，α 是 alpha，Y 是样本，S [n-1]是之前的平均值。

不幸的是，由于各种问题，我没有一致的采样时间。我可能知道我最多可以采样一次，例如每毫秒一次，但由于我无法控制的因素，我可能无法一次采样几毫秒。然而，一个可能更常见的情况是，我稍微早一点或晚一点地进行简单采样：而不是在 0、1 和 2 毫秒进行采样。我在 0、0.9 和 2.1 ms 采样。我确实预计，无论延迟如何，我的采样频率都会远远高于奈奎斯特极限，因此我不必担心混叠。

我认为我可以根据自上次采样以来的时间长度，通过适当地改变 alpha 以或多或少合理的方式处理这个问题。

我认为这会起作用的部分原因是 EMA 在前一个数据点和当前数据点之间“线性插值”。如果我们考虑以间隔 t 计算以下样本列表的 EMA：[0,1,2,3,4]。如果我们使用区间 2t，我们应该得到相同的结果，其中输入变为 [0,2,4]，对吧？如果 EMA 假设，在 t [2时，该值自 t] [0]以来一直为 2 ，那将与在 [0,2,2,4,4] 上计算的间隔 t 计算相同，但它没有这样做。或者这完全有意义吗？

有人可以告诉我如何适当地改变 alpha 吗？“请展示你的作品。” 即，向我展示证明您的方法确实在做正确的事情的数学。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-22T15:21:44.417

这个答案基于我对低通滤波器的良好理解（“指数移动平均线”实际上只是一个单极点低通滤波器），但我对你正在寻找的东西的理解模糊。我认为以下是您想要的：

首先，您可以稍微简化您的方程式（看起来更复杂，但在代码中更容易）。我将使用“Y”作为输出，“X”作为输入（而不是 S 作为输出，Y 作为输入，就像你所做的那样）。

Y [n] = αX + (1-α)Y [n-1] → Y [n] = Y [n-1] + α(X - Y [n-1] )

哪些代码：

```
 Y += alpha * (X-Y); 
```

其次，这里的 α 值“等于” 1-e ^(-Δt/τ)其中 Δt 是采样之间的时间，τ 是低通滤波器的时间常数。我在引号中说“相等”，因为当 Δt/τ 与 1 相比较小并且 α = 1-e ^(-Δt/τ) ≈ Δt/τ 时，这很有效。（但不能太小：您会遇到量化问题，除非您采用一些奇特的技术，否则您通常需要在状态变量 S 中额外增加 N 位分辨率，其中 N = -log [2] (α)。） Δt/τ 的值，过滤效果开始消失，直到你到达 α 接近 1 的点，你基本上只是将输入分配给输出。

这应该适用于不同的 Δt 值（只要 alpha 很小，Δt 的变化并不是很重要，否则你会遇到一些相当奇怪的奈奎斯特问题 / 混叠 / 等等），如果你正在使用处理器如果乘法比除法便宜，或者定点问题很重要，请预先计算 ω = 1/τ，并考虑尝试逼近 α 的公式。

如果你真的想知道如何推导出公式

α = 1-e ^(-Δt/τ)

然后考虑它的微分方程源：

Y + τ dY/dt = X

其中，当 X 是单位阶跃函数时，其解 Y = 1 - e ^(-t/τ)。对于较小的 Δt 值，导数可以近似为 ΔY/Δt，产生

Y + τ ΔY/Δt = X

ΔY/Δt = (XY)/τ

ΔY = (XY)(Δt/τ) = α(XY)

^(并且 α = 1-e -Δt/τ)的“外推”来自尝试将行为与单位阶跃函数情况相匹配。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-08-08T08:22:33.873

看看这里： http: [//www.eckner.com/research.html](http://www.eckner.com/research.html)

看第二个链接：《不均匀时间序列的算法：移动平均线和其他滚动算子》

我认为，该文档准确地描述了您需要的编程算法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T14:21:53.727

这不是一个完整的答案，但可能是一个开始。这是我在一个小时左右的比赛中得到的。我将其发布为我正在寻找的示例，也许是对解决该问题的其他人的启发。

我从 S [0]开始，它是由先前的平均值 S [-1]和在 t [0]处采集的样本 Y [0]得出的平均值。(t [1] - t [0] ) 是我的采样间隔，α 设置为适合该采样间隔和我希望平均的时间段的任何值。

我考虑过如果我错过了 t [1]的样本，而不得不处理在 t [2采集的样本 Y] [2]会发生什么？好吧，我们可以从扩展方程开始，看看如果我们有 Y [1]会发生什么：

*   S [2] = αY [2] + (1-α)S [1]，其中 S [1] = αY [1] + (1-α)S [0]

替代：

*   S [2] = αY [2] + (1-α)(αY [1] + (1-α)S [0] )
*   S [2] = αY [2] + (1-α)αY [1] + (1-α)(1-α)S [0]
*   S [2] = αY [2] + (1-α)αY [1] + (1-α) ² S [0]

我注意到该系列似乎以这种方式无限扩展，因为我们可以无限期地替换右侧的 S [n ：]

*   S [2] = αY [2] + (1-α)αY [1] + (1-α) ² (αY [0] + (1-α)S [-1] )
*   S [2] = αY [2] + (1-α)αY [1] + (1-α) ² αY [0] + (1-α) ³ S [-1]
*   等等

好的，所以它不是一个真正的多项式（我真傻），但是如果我们将初始项乘以 1，我们就会看到一个模式：

*   S [2] = (1-α) ⁰ αY [2] + (1-α)αY [1] + (1-α) ² αY [0] + (1-α) ³ S [-1]

嗯：这是一个指数级数。*奎尔惊喜！*想象一下，从等式中得出指数移动平均线！

所以无论如何，我有这个 x ⁰ + x ¹ + x ² + x ³ + ... 事情发生了，我确定我闻`e`到了，或者这里有一个自然对数，但我不记得我在哪里在我没时间之前前往下一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T15:08:33.400

对这个问题的任何答案，或任何对此类答案正确性的证明，都在很大程度上取决于您正在测量的数据。

如果您的样本是在 t [0] =0ms 、t [1] =0.9ms 和 t [2] =2.1ms 时采集的，但您对 α 的选择是基于 1-ms 间隔，因此您需要一个局部调整的 α [n]，证明选择的正确性意味着知道 t=1ms 和 t=2ms 的样本值。

这就引出了一个问题：您能否合理地插入您的数据，以合理地猜测中间值可能是什么？或者你甚至可以插入平均值本身吗？

如果这些都不可能，那么据我所知，中间值 Y(t) 的逻辑选择是*最近计算的平均值*，即 Y(t) ≈ S [n]其中 n 是最大值，使得 t [n] <t。

这个选择有一个简单的结果：不管时间差是多少，不要管 α。

另一方面，如果可以对您的值进行插值，那么这将为您提供平均的恒定间隔样本。最后，如果甚至可以插入平均值本身，那将使这个问题变得毫无意义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T15:53:28.203

假设我们想在一个连续函数上做一个指数衰减平均值。但是，我们没有该函数的所有值，只有几个样本。这个公式将对我们确实拥有的样本和它们在连续平均值中的权重进行加权平均。

乘数[n] = Alpha^(时间[n] -时间[n-1])

总和[n] =值[n] + 总和[n-1] *乘数[n]

计数[n] = 1 + 计数[n-1] *乘数[n]

平均[n] = 总和[n] /计数[n]

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-21T22:08:12.550

通过使用一个稍微不同的 α，它等于（[问题中的]1-α ），将新值 Y 添加到 S [0]的现有平均值的基本公式如下所示：

> S(Y,S [0] ) =
> 
> (1-α)Y + αS [0] =
> 
> Y - αY + αS [0] =
> 
> Y + α(S [0] -Y)

如果我们现在添加时间间隔 t 的长度并假设只有 α 取决于 t，那么该公式如下所示：

> S(Y,t,S [0] ) = Y + α [t] (S [0] -Y)

现在假设 t = t [1] + t [2]。如果通过将时间间隔 t [1]和 t [2]的两个 Y 值相加来创建平均值，则生成的平均值如下所示：

> S(Y,t [2] , S(Y,t [1] ,S [0] )) =
> 
> Y + α [t [2]] (S(Y,t [1] ,S [0] ) - Y) =
> 
> Y + α [t [2]] ((Y + α [t [1]] (S [0] -Y)) - Y) =
> 
> Y + α [t [2]] α [t [1]] (S [0] -Y)

如果该平均值应该与一次添加整个 t 区间相同，则得出 α [t] = α [t [1]] α [t [2]]。满足此要求的 α 定义为：

> α [x] := A ^x     （对于某个常数 A）

因为：

> α [T] = A ^T = A ^(T [1] + T [2]) = A ^(T [1]) A ^(T [2]) = A [T [1]] A [T [2]]

这导致以下平均函数：

> S(Y,t,S [0] ) = Y + A ^t (S [0] -Y)

我还没有真正测试过这个，但是如果我做出的假设适合你的场景，这看起来像是一个平均函数，可以很好地处理采样间隔的变化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-21T13:35:06.177

我将不理会该`alpha`值，并填写缺失的数据。

由于您不知道在无法采样期间会发生什么，您可以用 0 填充这些样本，或者保持之前的值稳定并将这些值用于 EMA。或者，一旦有了新样本，就进行一些反向插值，填充缺失的值，然后重新计算 EMA。

我想要得到的是你有一个`x[n]`有洞的输入。没有办法解决您丢失数据的事实。`x[n]`因此，您可以使用零阶保持，或将其设置为零，或在和之间进行某种插值`x[n+M]`，其中`M`是缺失样本的数量，而 n 是间隙的开始。甚至可能使用之前的值`n`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-21T13:35:40.950

这类似于我的待办事项列表上的一个未解决的问题。我在某种程度上制定了一个方案，但还没有数学工作来支持这个建议。

更新和总结：希望保持平滑因子（alpha）独立于补偿因子（我在这里称为 beta）。杰森在这里已经接受的出色答案对我很有用。

第一步。

*   如果您还可以测量自上次采样以来的时间（以恒定采样时间的四舍五入倍数 - 因此自上次采样以来的 7.8 毫秒将是 8 个单位），则可用于多次应用平滑。在这种情况下，应用公式 8 次。您有效地使平滑更偏向当前值。

第二步。

*   为了获得更好的平滑效果，我们需要在前一种情况下应用公式 8 次时调整 alpha。

这种平滑近似会遗漏什么？

*   在上面的例子中它已经错过了 7 个样本
*   这是在第 1 步中近似的，将当前值**扁平化**重新应用了 7 次
*   如果我们定义一个将与**alpha**一起应用的近似因子**beta**（作为 alpha*beta 而不仅仅是 alpha），我们将假设 7 个丢失的样本在先前样本值和当前样本值之间平滑变化。

# perl - 如何对我事先不知道名称的多个变量执行替换？

> ID：1023864
> 
> 赞同：1
> 
> 时间：2009-06-21T13:09:04.827
> 
> 标签：perl, variables, configuration-files

我正在编写一个 Perl 脚本，其中用户在脚本的开头添加了许多设置变量，所有变量都以 为前缀`$XX`，如下所示。然而，用户设置的变量需要通过一个简短的转换函数来清理它们。

有没有办法在所有带有`$XX`前缀的变量上运行 sub？

```
my $XXvar1 = "something";
my $XXvar2 = "something";
my $XXvar3 = "something";
my $XXvar4 = "something";

sub processVar {
    my $fixVar = $_[0];
    # Do stuff
    return $fixVar;
}

# This obviously doesn't work. Use some kind of loop or something? How...
$XXvar* = processVar($XXvar*); 
```

**编辑：** 根据谷歌的一些建议，我现在正在尝试使用哈希来执行此操作：

```
my %XX;

$XX{var1} = "something 1";
$XX{var2} = "something 2";
$XX{var3} = "something 3";
$XX{var4} = "something 4"; 
```

然后我可以使用`for`or`while`循环中的键和值。但是，如何在循环中将每个变量重新分配给转换后的变量？

**再次编辑：** 知道了。此`for`循环成功处理所有变量：

```
for my $key ( keys %XX ) {
    $XX{$key} = processVar($XX{$key});
} 
```

不过，我现在肯定会尝试制作一个配置文件，如下所示。现在我只需要弄清楚:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-21T13:38:39.133

与其让用户编辑源代码并提供奇怪的变量名称，不如使用配置文件。每个用户都可以获得自己的配置文件。[CPAN](http://search.cpan.org)上有几个模块可以处理几乎任何格式的配置文件，我在[Mastering Perl](http://oreilly.com/catalog/9780596527242)的一章中讨论了配置 Perl 程序的方法。这肯定比您神奇地获取这些变量名所需的技巧要容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T13:43:24.680

阅读 MJD 的：

1.  [为什么“使用变量作为变量名”是愚蠢的](http://perl.plover.com/varvarname.html)
2.  [第2部分](http://perl.plover.com/varvarname2.html)
3.  [第 3 部分](http://perl.plover.com/varvarname3.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T13:20:56.970

```
#!/usr/bin/perl

use strict;
use warnings;

my $XXvar1 = "something";
my $XXvar2 = "something";
my $XXvar3 = "something";
my $XXvar4 = "something";

my @values;
for ( 1 .. 4 ) {
    push @values, eval '$XXvar' . $_;
}

processVar(@values);

sub processVar {
    print "@_";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T14:43:16.663

就是图个好玩儿。但不要这样做是邪恶的:-)

```
use PadWalker qw(peek_my peek_our peek_sub closed_over);
my $XXvar1 = "something1a";
my $XXvar2 = "something2b";
my $XXvar3 = "something3c";
my $XXvar4 = "something4d";
my $noXXvar = "something5e";

#remove last character
sub clean {
  my $h = peek_my(1);
  while(my ($key, $value) = each(%$h)) {
    if ($key =~ /^\$XXvar.+/) {
       chop ${$h->{$key}}
    }
  }
}
clean();

print "$XXvar1\n";  //something1
print "$XXvar2\n";  //something2
print "$XXvar3\n";  //something3
print "$XXvar4\n";  //something4
print "$noXXvar\n"; //something5e 
```

我的 Perl 有点生疏，所以它有一个更短/更干净的版本。

# jquery - jQuery ajax XML Http 请求不起作用

> ID：1023867
> 
> 赞同：10
> 
> 时间：2009-06-21T13:14:57.530
> 
> 标签：jquery, ajax

由于 jQuery 中的 Ajax 请求，存在未定义的错误。但它在本地工作。在 jquery1.3.2.js @ 3633 行中引用错误

```
xhr.send(s.data); 
```

我的代码是：

```
$.ajax({
    type: "POST",
    url: 'index.php',
    data: "action=showpath&type=images&path=&default=1",
    cache: false,
    dataType: "html",
    success: function (data) {
        $('#addr').html(data);
    },
    error: function (xhr, ajaxOptions, thrownError) {
        alert(xhr.status);
        alert(thrownError);
    }
}); 
```

代码中的警报向我显示 (0, 'undefined');

我做错了什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-08-13T00:25:29.053

如果您的 ajax 请求在完成之前被取消，则可能会发生这种情况。当用户通过刷新、单击链接或更改浏览器中的 URL 离开页面时，jQuery 会引发错误事件。您可以通过为 ajax 调用实现错误处理程序并检查 xmlHttpRequest 对象来检测这些类型的错误：

```
$.ajax({
    /* ajax options omitted */
    error: function (xmlHttpRequest, textStatus, errorThrown) {
         if(xmlHttpRequest.readyState == 0 || xmlHttpRequest.status == 0) 
              return;  // it's not really an error
         else
              // Do normal error handling
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T13:21:26.360

不能随便告诉你，但它可能是 index.php 中服务器端的东西。最好的判断方法是使用 http 调试器查看原始响应。[Firebug](http://getfirebug.com) firefox 扩展有一个相当不错的扩展，fiddler2[是](http://www.fiddler2.com/fiddler2/)一个强大的选择。

# java - 如何解析html和css来理解页面的布局（java）

> ID：1023874
> 
> 赞同：2
> 
> 时间：2009-06-21T13:19:15.663
> 
> 标签：java, translation, html-parsing

我需要设法解析 html 和 css 布局，以便能够将其转换为能够理解简单 html 的属性语言，每个 html 元素上都有内联 css 我如何处理这样的任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T13:40:48.117

您需要阅读有关使用 Java 进行 DOM 解析的内容，并支持解析 HTML 文档。一个这样的例子是[Xerces](http://xerces.apache.org/xerces2-j/)。

阅读更多 Java HTML DOM 解析，这里还有一个非常全面的可用解析器列表：

[http://java-source.net/open-source/html-parsers](http://java-source.net/open-source/html-parsers)

# html - 阻止表格在 HTML 中变长

> ID：1023879
> 
> 赞同：0
> 
> 时间：2009-06-21T13:22:18.450
> 
> 标签：html, html-table

我有以下表格。我想要它，所以当我制作更多的盒子表时。如果桌子上没有更多空间，请在其他空间下方并继续使桌子变长。

```
<table width="417" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="413" height="179">
      <table width="141" border="1" align="left" cellpadding="0" cellspacing="0">
        <tr>
          <td width="137" height="89">Box1</td>
        </tr>
      </table>
      <table width="141" border="1" align="left" cellpadding="0" cellspacing="0">
        <tr>
          <td width="137" height="89">Box2</td>
        </tr>
      </table>
    </td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T16:58:50.423

您应该对布局使用 css 样式，而不是表格。表格用于显示数据行，而不是用于弥补布局。

考虑一下：

```
<style type="text/css">

    .wrapper
    {
        padding:10px;
        overflow:auto;
        background-color:#888;
    }

    #box
    {
        float:left;
        width:150px;
        padding:10px;
        background-color:#aaa;
    }

</style>

<div class="wrapper">

    <div id="box">Box 1</div>

    <div id="box">Box 2</div>

    <div id="box">Box 3</div>

    <div style="clear:both;"></div>

</div> 
```

只需将此代码复制到 html 文件并使用浏览器的窗口来查看它是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T17:13:42.150

你的问题很难阅读，但我会试一试。

我假设您有一个不希望高于 179 像素的主表。在此表格中放置的框不应使表格高于 179 像素，即使有超过 4 个框。要解决这个问题，您需要样式溢出：隐藏以阻止表格变得太大。不幸的是，这不适用于表格单元格，因此您需要在表格单元格中添加一个具有溢出：隐藏样式的 DIV 元素。

表格内有一个额外的 DIV 元素的解决方案如下所示：

```
<table width="417" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td width="413" height="179">
      <div style="height: 179px; overflow: hidden;" >
        <table width="141" border="1" align="left" cellpadding="0" cellspacing="0">
          <tr>
            <td width="137" height="89">Box1</td>
          </tr>
        </table>
        <table width="141" border="1" align="left" cellpadding="0" cellspacing="0">
          <tr>
            <td width="137" height="89">Box2</td>
          </tr>
        </table>
      </div>
    </td>
  </tr>
</table> 
```

当然，正如 niteriter 指出的那样，您最好在布局中使用 DIV 标签。在您的情况下，这也会导致更清晰的 HTML/CSS 代码。

```
<style>
div.wrapper { height: 179px; width: 413px; overflow: hidden; }
div.box { float: left; height: 89px; width: 137px; }
</style>
<div class="wrapper" >
  <div class="box" > Box1 </div>
  <div class="box" > Box2 </div>
  <div class="box" > Box3 </div>
</div> 
```

# c++ - Ruby 块，C++ 中的 java 闭包

> ID：1023881
> 
> 赞同：3
> 
> 时间：2009-06-21T13:22:55.157
> 
> 标签：c++, stl, iterator, closures

我正在开发一个程序，我发现自己经常这样做：

```
void Model::SetCollideMode( const std::string &m )
{
  Body *body;

  std::map<std::string, Body* >::iterator iter;

  for (iter=this->bodies.begin(); iter!=this->bodies.end(); iter++)
  {
    body = iter->second;

    body->SetCollideMode( m );
  }
} 
```

我在几个对象中有几个类似的方法，它们基本上将一个属性应用于它的所有子对象。来自 Ruby 世界，我渴望做类似的事情：

```
for_all_bodies{ body->SetCollideMode(m) } 
```

有没有办法让这段代码更像闭包或者以其他方式改进它？

我知道 C++ 是如何工作的，它是基于堆栈的，并且没有上下文信息来创建类似功能的完美闭包（这需要 VM？），但至少改进了当前重复此代码 100 次的编程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T13:25:49.067

在 C++0x 中，是的。[看这里。](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)正如您所猜到的，它们是以 C++ 特有的方式完成的，即，如果您不小心关闭了堆栈变量，然后让 lambda 对象的生存时间比堆栈长，那么您就会有未定义的行为。这是一种让你的程序崩溃的全新方法！但这是不公平的——在许多方面，它们比许多其他语言中的 lambdas 更复杂，因为您可以声明它们被允许改变状态的程度。

在那之前，[一直有人尝试效仿同样的事情](http://www.boost.org/doc/libs/1_39_0/doc/html/lambda.html)，但它们可能带来的麻烦多于其价值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T13:54:49.913

BOOST_FOREACH（或新的基于范围的循环）可能是要走的路，但这是我在当前标准中通常使用 tr1 绑定处理 lambda 的方式：

```
#include <algorithm>
#include <functional>
using namespace std;

void Model::SetCollideMode( const std::string &m )
{
  for_each(bodies.begin(),bodies.end(),
           tr1::bind(&Body::SetCollideMode,
                     tr1::bind(&pair<std::string, Body*>::second, _1), m));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T13:57:44.900

有几种方法，没有一个是完美的。

首先，“常规”方法是定义一个仿函数来做你需要的事情：

```
struct SetCollideModeFunc {
  SetCollideModeFunc(const std::string& m) : m(m) {}
  void operator()(std::pair<std::string, Body*>& p) {
    Body* b = p.second;
    b->SetCollideMode(m);
  }

  const std::string& m;
};

void Model::SetCollideMode( const std::string &m )
{
  std::for_each(bodies.begin(), bodies.end(), SetCollideModeFunc(m));
} 
```

这不会为您节省大量代码，但它确实允许您将迭代与要应用的操作分开。如果需要多次设置collidemode，当然可以复用functor。

Boost.Lambda 库可以使用更短的版本，它允许您定义内联函子。我不记得确切的语法，因为我不经常使用 Boost.Lambda，但它会是这样的：

```
std::for_each(bodies.begin(), bodies.end(), _1.second->SetCollideMode(m)); 
```

在 C++0x 中，您可以获得对 lambdas 的语言支持，允许使用与此类似的语法，而无需引入第三方库。

最后，Boost.ForEach 可能是一个选项，允许这样的语法：

```
void Model::SetCollideMode(const std::string &m)
{
  BOOST_FOREACH ((std::pair<std::string, Body*> p), bodies) // note the extra parentheses. BOOST_FOREACH is a macro, which means the compiler would choke on the comma in the pair if we do not wrap it in an extra ()
  {
    p.second->SetCollideMode(m);
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-21T13:39:26.060

您可以使用[Boost.Foreach](http://www.boost.org/doc/libs/1_39_0/doc/html/foreach.html)：

```
#include <boost/foreach.hpp>

void Model::SetCollideMode(const std::string &m)
{
  typedef pair<std::string, Body*> body_t;
  BOOST_FOREACH (body_t& body, bodies)
  {
    body.second->SetCollideMode(m);
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T20:55:36.080

C++ 还不支持 lambda。我有时会使用这种解决方法：

```
#include <boost/bind.hpp>
void Model::SetCollideMode( const std::string &m )
{    
  typedef std::map<std::string, Body* > Bodies;
  struct Helper
  {
      static SetCollideMode(const std::pair<std::string, Body*> & value,
                            const std::string & m)
      {
          value.second->SetCollideMode(m);
      }
  };

  for_each(bodies.begin(),
           bodies.end(),
           boost::bind(Helper::SetCollideMode,_1, m));
} 
```

只是我的2美分..

# linux - Linux: How to debug a SIGSEGV? How do I trace the error source?

> ID：1023882
> 
> 赞同：11
> 
> 时间：2009-06-21T13:23:37.340
> 
> 标签：linux, debugging, trace, dump, segmentation-fault

My firefox started crashing since today. I haven't changed anything on the system or on firefox config.

I use
**`strace -ff -o dumpfile.txt firefox`**
to trace the problem. It's not a big help.

I see the segfault, in two of the generated process dumps, but how I can **trace** them to their cause?

After running for 10 seconds and crashing, 22MB of data is generated by strace.

This is a snippet of the output, where you can see actual SIGSEGV in the middle.:

```
read(19, "\372", 1)                     = 1
gettimeofday({1245590019, 542231}, NULL) = 0
read(3, "\6\0[Qmy\26\0\3\1\0\0Y\0\200\2\0\0\0\0\323\3A\0\323\3(\0\20\0\1\0", 4096) = 32
read(3, 0xf5c55058, 4096)               = -1 EAGAIN (Resource temporarily unavailable)
gettimeofday({1245590019, 542813}, NULL) = 0
poll([{fd=4, events=POLLIN}, {fd=3, events=POLLIN}, {fd=8, events=POLLIN|POLLPRI}, {fd=12, events=POLLIN|POLLPRI}, {fd=13, events=POLLIN|POLLPRI}, {fd=14, events=POL
read(3, 0xf5c55058, 4096)               = -1 EAGAIN (Resource temporarily unavailable)
gettimeofday({1245590019, 543161}, NULL) = 0
gettimeofday({1245590019, 546672}, NULL) = 0
gettimeofday({1245590019, 546761}, NULL) = 0
read(3, 0xf5c55058, 4096)               = -1 EAGAIN (Resource temporarily unavailable)
gettimeofday({1245590019, 546936}, NULL) = 0
poll([{fd=4, events=POLLIN}, {fd=3, events=POLLIN}, {fd=8, events=POLLIN|POLLPRI}, {fd=12, events=POLLIN|POLLPRI}, {fd=13, events=POLLIN|POLLPRI}, {fd=14, events=POL
poll([{fd=3, events=POLLIN|POLLOUT}], 1, 4294967295) = 1 ([{fd=3, revents=POLLOUT}])
writev(3, [{"5\30\4\0006\21\200\2\266\n\200\2\17\0]\3\230\4\5\0007\21\200\0026\21\200\2\317\0\0\0"..., 1624}, {NULL, 0}, {"", 0}], 3) = 1624
poll([{fd=3, events=POLLIN}], 1, 4294967295) = 1 ([{fd=3, revents=POLLIN}])
read(3, "\1\30\224Q\17\17\0\0\0\0\0\0\0\0\0\0000\235\273\0\0\0\0\0o\264Q\0\0\0\0\0"..., 4096) = 4096
read(3, "\375\240f\0\376\242j\0\377\261\200\0\271a+\0\271a+\0\377\261\200\0\376\252w\0\376\250s\0"..., 11356) = 11356
read(3, 0xf5c55058, 4096)               = -1 EAGAIN (Resource temporarily unavailable)
poll([{fd=3, events=POLLIN|POLLOUT}], 1, 4294967295) = 1 ([{fd=3, revents=POLLOUT}])
writev(3, [{"\230\32\7\0\1\21\200\2?\21\200\2\377\377\377\377\377\377\377\377\0\0\0\0\17\0\1\0015\10\4\0"..., 956}, {NULL, 0}, {"", 0}], 3) = 956
poll([{fd=3, events=POLLIN}], 1, 4294967295) = 1 ([{fd=3, revents=POLLIN}])
read(3, "\1\30\256Q\17\17\0\0\0\0\0\0\0\0\0\0000\235\273\0\0\0\0\0o\264Q\0\0\0\0\0"..., 4096) = 4096
read(3, "\375\240f\0\376\242j\0\377\261\200\0\271a+\0\271a+\0\377\261\200\0\376\252w\0\376\250s\0"..., 11356) = 11356
read(3, 0xf5c55058, 4096)               = -1 EAGAIN (Resource temporarily unavailable)
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
unlink("/home/userrrr/.mozilla/firefox/mvbnkitl.default/lock") = 0
rt_sigaction(SIGSEGV, {SIG_DFL, ~[HUP INT QUIT ABRT BUS FPE KILL PIPE CHLD CONT TTOU URG XCPU WINCH RT_1 RT_2 RT_3 RT_4 RT_8 RT_11 RT_14 RT_17 RT_22], SA_NOCLDSTOP},
rt_sigprocmask(SIG_BLOCK, ~[ILL ABRT BUS FPE SEGV RTMIN RT_1], ~[KILL STOP RTMIN RT_1], 8) = 0
open("/home/userrrr/.mozilla/firefox/mvbnkitl.default/minidumps/56b30367-5ee2-0495-32646b7f-59dc87e9.dmp", O_WRONLY|O_CREAT|O_EXCL, 0600) = 63
clone(child_stack=0xf5bfffe4, flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_UNTRACED) = 18929
waitpid(18929, NULL, __WALL) = 18929
open("/proc/18913/task", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_CLOEXEC) = 64
fstat64(64, {st_mode=S_IFDIR|0555, st_size=0, ...}) = 0
getdents64(64, /* 12 entries */, 1024)  = 368
ptrace(PTRACE_DETACH, 18913, 0, SIG_0)  = -1 ESRCH (No such process)
close(64)                               = 0
ftruncate(63, 91256)                    = 0
close(63)                               = 0
rt_sigprocmask(SIG_SETMASK, ~[KILL STOP RTMIN RT_1], ~[KILL STOP RTMIN RT_1], 8) = 0
time(NULL)                              = 1245590020
open("/home/userrrr/.mozilla/firefox/Crash Reports/LastCrash", O_WRONLY|O_CREAT|O_TRUNC, 0600) = 63
write(63, "1245590020", 10)             = 10

```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-21T19:45:25.677

Ivan，你真正的问题是“我如何调试 SIGSEGV？”

**strace**在这里很少有很好的帮助。SIGSEGV 表示应用程序试图取消引用（访问）内存中尚未分配的位置（或由于各种其他原因不允许取消引用）。它与 strace 正在捕获的系统调用活动无关的可能性很高。为了发现崩溃的原因，首先要了解取消引用的地址以及尝试执行此操作的函数。调试器是完成此任务的正确工具。

这是您需要做的：

```
 gdb <your_app_name> <your_coredump_file> 
```

在那里，分析最后执行的指令并使用“信息寄存器”你会看到有问题的地址。使用“bt”命令，您将看到调用堆栈。通过向上遍历调用堆栈，您会发现如何计算不正确的地址。此地址计算中涉及的步骤之一是您的问题的原因。

调试很有趣，这是一个深入研究它的好机会。一本好书或一些在线文章可以帮助你。谷歌离开，祝你好运！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-22T02:22:45.343

您可以使用以下命令在调试模式下启动 firefox：firefox -d gdb

这将在 gdb 中启动 Firefox。

您可以发出 gdb 命令“运行”并在 Firefox 崩溃时获取回溯。这可能很困难，因为 Firefox 附带了剥离的库，它只显示代码所在的库和偏移量，而不是函数名。

另一种选择是在安全模式下启动 firefox：firefox -safe-mode 并关闭您可能已安装的所有插件，直到它不再崩溃。

最后一种选择是启用 firefox 的开发者模式，并允许它发送 firefox 崩溃会话到 mozilla 服务器。然后您可以访问 mozilla 站点并查看失败的 Firefox 会话的详细回溯。

# php - blog post content via url parameters (meta) in wordpress

> ID：1023884
> 
> 赞同：3
> 
> 时间：2009-06-21T13:24:40.583
> 
> 标签：php, wordpress, parameters, meta-tags

I am trying to create an URL which will set the blog post like `./wp-admin/post-new.php?post_title=title`

I know that post_title, content and excerpt will work for this, but I don't know how to set meta tags.

I need this to create a new posting when clicking on a map (openlayers) and automaticaly set longitude and latitude in meta tags.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T21:11:31.977

我想，对于自动后期创建，您应该首先挖掘[XML-RPC 接口](http://codex.wordpress.org/XML-RPC_Support)。这个工具并不难掌握，而且非常强大。

# django - CSS 文件中的 Django 媒体 URL

> ID：1023888
> 
> 赞同：37
> 
> 时间：2009-06-21T13:25:35.090
> 
> 标签：django, django-templates

在 django 模板中，通常执行以下操作：

```
<img src="{{ MEDIA_URL }}/img/someImage.jpg"> 
```

您将如何在不用作模板的 CSS 文件中完成此操作？

```
.someClass {
    /* can't do this this */
    background: url("{{ MEDIA_URL }}/img/someImage.jpg");        
    /* either this */
    background: url("http://media.domain.com/img/someImage.jpg");
    /* or this */
    background: url("/django_static_media/img/someImage.jpg");
    /* can't do both... what to do? */
} 
```

我需要能够从媒体子域或在离线工作期间提供我的文件并将它们直接作为 django 静态视图提供服务。但是 CSS 文件是个问题，因为它们没有作为模板处理，而且我不能使用`MEDIA_URL`上下文变量。

解决方案是什么？

**编辑：**我应该注意到问题的出现是因为我的静态媒体文件实际上位于一个单独的媒体子域上，~~因此否定了相对路径的使用。~~知道了谢谢！

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-06-21T13:48:59.223

您的 css 文件是从哪里提供的？作为常见的媒体结构，这通常不是问题，例如：

```
media/
    images/
    css/
    js/ 
```

（或类似的）允许图像的相对文件路径，例如：

```
background: url('../images/foo.png'); 
```

如果您不准备更改媒体文件夹结构以适应相对文件路径，您可能别无选择，只能在模板内覆盖 css 声明，在离线时使用辅助 css 文件：

```
{% if DEBUG %}
    <link rel="stylesheet" href="{{ MEDIA_URL }}css/offline-mode.css" />
{% endif %} 
```

当然，第一个选项更整洁。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-24T01:51:10.243

对不起，你不会喜欢这个答案。

我有同样的问题：

使用静态提供的 CSS 文件没有简单的方法可以做到这一点。

我做什么：

*   调试服务器，本地工作，本地服务的媒体
*   生产服务器托管在 Amazon S3 上带有媒体的商业位置
*   settings.py 文件通过主机名检查自动设置 MEDIA_URL（DEBUG 等）（以区分生产与本地/家庭/调试）
*   HTML 文件都有带有 {{MEDIA_URL}} 的 css 链接（视图的 +RequestContext 上下文）
*   我喜欢绝对路径名，因此“update_s3”脚本： **(1)**更改每个 css 文件是暂时将 'url("/media' 修复为 'url("s3.mydomain.com/media' 和 **(2)**更新/将我的 /media 目录上传到 Amazon S3

然后我去生产并进行 svn 更新并触摸 WSGI 文件并验证

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T13:50:09.250

在您的 CSS 文件中使用相对路径（用于图像文件）对您来说不是一个可行的选择吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T14:08:56.420

如果您想在文件中使用模板指令，为什么不通过模板提供服务？

# c# - Populating reports/letters by using Word instead of Crystal Reports in a C# application?

> ID：1023899
> 
> 赞同：0
> 
> 时间：2009-06-21T13:32:43.093
> 
> 标签：c#, crystal-reports, ms-word, reporting

I'll preface by saying that these reports are generated through a C# application;

I have customers who send me a template (Word-document) for a letter or report which they wish to populate with data (text, images, etc) from their database (which is used by their CRM system). Usually I will have to re-design these in Crystal Reports and add all necessary tags and fields. Which is a time-consuming job, and not really what I should be focusing on.

So what I'm wondering about is, can I use the Word-document directly to setup a report which can be filled with data? (Possibly in a C# service/application?)

Considering that at any given time there are many users trying to generate letters and reports, is this an efficient method of generating reports?

And finally, if this isn't a practical option, are there any other good alternatives to Crystal Reports?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T21:51:12.713

我以前做过。我为一个 ASP.NET 应用程序将写入的州机构维护了一个 Word 文档存储库。

您需要的是 MS Word 文档中的书签。您可以以编程方式填充书签。

您可能没有使用 ASP.NET，但[这里有一个示例可以向您展示一些 C# 和 MS Word 文档书签交互。](http://forums.asp.net/t/1425380.aspx)

希望这可以让您了解这是否值得。

您的另一个选择是使用 Sharepoint。如果目前没有安装，不推荐这条路线！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T21:33:24.370

我不知道如何将 Word 文档用作 Crystal Report 的模板。

我能想到的最佳选择是使用 Word 中的邮件合并功能，它允许您设置从数据库动态填充的字段。

如果您希望为最终用户提供一种简单的方法来运行这些报告，这可能不是最佳解决方案，但它是您迄今为止获得的最佳答案。哈哈 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-27T06:54:03.273

我知道这个问题现在很老了，但我不禁注意到与我之前回答的另一个问题的相似之处：[Crystal Reports to Word Template](https://stackoverflow.com/questions/5260916/crystal-reports-to-word-template)。所以我在这里也提到了这个解决方案，以防它帮助未来偶然发现的搜索者。

您的问题与我们（教育部）遇到的问题非常相似。业务分析师有许多用作报告的 Word 文档。在“旧时代”，他们会手动编辑它们并自己插入数据，但现在它必须全部来自中央数据库等。在其他项目中，我们使用了 iReport 和 Jasper，只要你有时间修补，它们就会产生良好的结果输出的格式和布局。但是，最终，当 BA 想要对输出（而不是数据）进行布局或格式更改时，它有点失败了。然后，开发人员将不得不从他们当前的项目中撤出，重新进入报表定义并对其进行调整以适应新的外观。泰迪欧 S。

在我们最新的项目中，我们使用[了 Docmosis](http://www.docmosis.com)，它是一个基于服务的报告生成器，它获取带有命名字段的实际 Word 文档，数据需要去往哪里。它获取您的数据并使用您的数据重新生成文档，并将其以 Word、PDF 或 HTML 的形式传回给您。因为输入只是 Word，所以 BA 可以自己编辑和维护原始模板。

我们在内部服务器上运行我们自己的 Docmosis 进程，但他们现在有一个基于云的版本，应该更容易使用，无需太多配置。当然，它会发布到网络上，但如果您无法托管自己的服务器或者您正在从移动平台访问，那么这可能就是您想要的。

我们有多个用户访问它，一年中的某些时候它会受到一些打击，到目前为止还不错。不是免费的，但为了钱和时间，它可以为我们的开发人员节省它自己的钱。

# bit-manipulation - 使用位图存储多个值的快速备忘单

> ID：1023901
> 
> 赞同：8
> 
> 时间：2009-06-21T13:33:47.570
> 
> 标签：bit-manipulation

当我要使用位图来存储多个标志时，我总是感到困惑。例如，如果一个对象有 10 个可能的属性（全部是或否），我使用无符号整数和基于属性的前 10 位（来自 LSB）。现在如何设置和取消设置特定位以及如何检查是否设置了位？

如果我想取消设置第 5 位，我使用： bitand (flag, 2^5 - 1)

但我不清楚使用什么来检查第 5 位是否已设置。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-21T13:44:53.850

检查是否设置了第 n^位：

```
(flags & (1 << n)) != 0 
```

设置第 n^位：

```
flags |= (1 << n) 
```

清除第 n^位：

```
flags &= ~(1 << n) 
```

切换第 n^位：

```
flags ^= (1 << n) 
```

# python - 可以用正则表达式匹配字符重复吗？如何？

> ID：1023902
> 
> 赞同：18
> 
> 时间：2009-06-21T13:33:53.810
> 
> 标签：python, regex

**问题：**
是否可以使用正则表达式匹配在不同位置包含相同字符的单词？

**条件：**
所有单词的长度相同，你知道重复字符的字符位置（例如第1个、第2个和第4个），但你不知道它是什么。

**示例：**
使用小写的 6char 单词我想匹配第 3 个和第 4 个字符相同的单词。

```
parrot <- match for double r
follia <- match for double l 
carrot <- match for double r
mattia <- match for double t
rettoo <- match for double t
melone <- doesn't match 
```

我不能使用量词 [\d]{2} 因为它匹配任何连续的两个字符，如果我说第 2 和第 4 位而不是第 3 和第 4 位怎么办？

可以用正则表达式做我想做的事吗？如果是，我该怎么做？

**编辑：**
在评论中询问，我正在使用 python

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-21T13:38:33.503

您可以使用反向引用来执行此操作：

```
(.)\1 
```

这将匹配任何字符的连续出现。

* * *

**编辑**   这是一些 Python 示例：

```
import re

regexp = re.compile(r"(.)\1")
data = ["parrot","follia","carrot","mattia","rettoo","melone"]

for str in data:
    match = re.search(regexp, str)
    if match:
        print str, "<- match for double", match.group(1)
    else:
        print str, "<- doesn't match" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-21T13:42:59.187

对于这种情况，您需要使用反向引用。我不确定您使用的是哪种语言，我在我的 VI 编辑器中尝试了以下示例来搜索任何重复的字母。 **模式正则表达式：** `\([a-z]\)\1`

如果您看到该示例，则 [az] 是您要搜索的模式，并将其括在括号内（括号应在某些语言中进行转义）。一旦有了括号，它就是一个组，可以使用 \1 在正则表达式中的任何位置再次引用。如果有多个组，您可以使用 \1、\2 等。\1 将替换为第一组中匹配的任何内容。

谢谢阿文德

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-21T13:42:34.807

`/(\b\w*?(\w)\2.*?\b)/`

将匹配至少在字符重复 $1 是单词 $2 第一次重复的任何单词。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T15:43:40.520

是的，您可以使用反向引用构造来匹配双字母。

正则表达式`(?<char>\w)\k<char>`使用命名组和反向引用来搜索相邻的配对字符。当应用于字符串“I'll have a small coffee”时，它会在单词“I'll”、“small”和“coffee”中找到匹配项。元字符`\w`查找任何单字字符。分组构造`(?<char>)`包含元字符以强制正则表达式引擎记住子表达式匹配（在这种情况下，它将是任何单个字符）并将其保存在名称“char”下。反向引用构造`\k<char>`使引擎将当前字符与存储在“char”下的先前匹配的字符进行比较。

# visual-studio-2008 - Debugger problem at C# Express - 2008

> ID：1023903
> 
> 赞同：0
> 
> 时间：2009-06-21T13:34:19.550
> 
> 标签：visual-studio-2008, debugging

I'm living a debugger problem at C# Express Edition - 2008\. After modifying in code, I run the debugger. Unfortunately, the last modification are not be processed. After I exit C# and then run again it, when I load the code and run the debugger, the last modification are processed by the debugger. Where is the problem at ?

Thanks in advance.

Cemo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T13:45:05.877

Are you sure that there are no errors in your code? I know this sounds like a stupid (and potentially insulting) question, but the only time I've had this sort of problem is when the code hasn't compiled and I haven't noticed.

Other things to possibly check (in the absence of more information):

*   Is the exe still in use when you build and hence not overwritten the first time?
*   Do you have a post build step that's failing (possibly because a file is in use)?

# java - 使用 Spring JDBC 的简单事务？

> ID：1023907
> 
> 赞同：10
> 
> 时间：2009-06-21T13:35:42.510
> 
> 标签：java, spring, jdbc, transactions, rollback

我正在开发一个使用 Spring [IoC](https://en.wikipedia.org/wiki/Inversion_of_control)和 JDBC 模板类的 Java 应用程序。我有一个 DAO 类，它有 4 个方法：m1() 到 m4()。m1 在表 t1 上执行多次插入和更新，在表 t2 上执行 m2，在 t3 上执行 m3 等。

DAO 方法使用如下：

```
while(true)
{
  //process & generate data

  dao.m1(data1);
  dao.m2(data2);
  dao.m3(data3);
  dao.m4(data4);

  //sleep
} 
```

我希望 4 个连续方法调用下的 db 操作是原子的，要么所有 4 个表都成功更新，要么没有。因此，如果在 m3() 中执行操作时出现错误，我想回滚在 m2 和 m1 中执行的所有更改（更新和插入）。

那么 spring 是否允许您按照以下方式进行操作？

```
while (true)
{
  //process & generate data

  transaction = TransactionManager.createNewTransaction();

  transaction.start()

  try
  {
    dao.m1(data1);
    dao.m2(data2);
    dao.m3(data3);
    dao.m4(data4);
  }
  catch(DbUpdateException e)
  {
    transaction.rollBack();
  }

  transaction.end();

  // sleep 
```

}

或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-21T13:41:31.717

是的，Spring 允许您以[编程方式控制事务](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html)。

就个人而言，我更喜欢使用注释的[声明性事务，如下所示：](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html)

```
public void runBatchJob() {
  while (true) {
    // generate work
    doWork(unitOfWork);
  }
}

@Transactional
private void doWork(UnitOfWork work) {
  dao.m1(data1);
  dao.m2(data2);
  dao.m3(data3);
  dao.m4(data4);
} 
```

定义DAO函数的地方：

```
@Transactional
public void m1(Data data) {
  ...
} 
```

这需要在您的*applicationContext.xml*中：

```
<tx:annotation-driven/> 
```

声明性事务可以声明为需要一个事务、需要一个新事务、支持事务等。当一个带有注释的块`@Transactional`抛出一个`RuntimeException`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-21T15:13:22.733

为了完整起见，程序化解决方案将是：

```
private TransactionTemplate transactionTemplate;

public setTransactionManager(PlatformTransactionManager transactionManager) {
  this.transactionTemplate = new TransactionTemplate(transactionManager);
}

...

while (true) {

  transactionTemplate.execute(new TransactionCallbackWithoutResult() {
    protected void doInTransactionWithoutResult(TransactionStatus status) {
      try {
        dao.m1(data1);
        dao.m2(data2);
        dao.m3(data3);
        dao.m4(data4);
      } catch(DbUpdateException e) {
        status.setRollbackOnly();
      }
    }
  });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T13:39:52.470

是的，您可以将这些调用放在一个方法中，并以[声明](http://static.springframework.org/spring/docs/2.0.8/reference/transaction.html)方式指定您的事务。

您不需要添加该代码 - Spring 可以为您完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-22T09:18:07.630

Spring 可以按照说明使用 @Transactional 为您处理这一切，如果您愿意，也可以在 XML 中处理。

正确的导入是您想要的 **事务传播**类型，这完全取决于您的应用程序。

默认情况下，如果一个事务不存在，则会启动一个事务，如果一个事务已经启动，则会重新使用现有事务。如果您希望所有 4 个 DAO 都是原子的，这就是您想要的行为。

将@Transactional 放在一个将管理名为（MyService）的DAO 方法的类上——该层之下的任何东西现在都将参与该事务边界。

IE：

```
@Transactional
public void m1(Data data) {
 ...
}

@Transactional
public void m2(Data data) {
 ...
} 
```

在代码中这样做是完全没有必要的。

请参阅[此处了解更多信息](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html#tx-propagation)

# scala - Scala中的聚合列表值

> ID：1023908
> 
> 赞同：12
> 
> 时间：2009-06-21T13:37:18.450
> 
> 标签：scala, functional-programming, scala-collections

从包含两个参数 notional 和 currency 的对象列表开始，如何汇总每种货币的总名义值？

鉴于：

```
case class Trade(name: String, amount: Int, currency: String)

val trades = List(
  Trade("T150310", 10000000, "GBP"),
  Trade("T150311", 10000000, "JPY"),
  Trade("T150312", 10000000, "USD"),
  Trade("T150313", 100, "JPY"),
  Trade("T150314", 1000, "GBP"),
  Trade("T150315", 10000, "USD")
) 
```

我怎样才能得到：

```
Map(JPY -> 10000100, USD -> 10010000, GBP -> 10001000) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-22T22:22:28.680

如果您使用后备箱，机器已经在那里。groupBy 是在 Traversable 上定义的，并且 sum 可以直接应用于列表，您不必编写折叠。

```
scala> trades groupBy (_.currency) map { case (k,v) => k -> (v map (_.amount) sum) }
res1: Iterable[(String, Int)] = List((GBP,10001000), (JPY,10000100), (USD,10010000)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-21T13:53:53.457

我编写了一个简单的 group-by 操作（实际上是 a`Groupable` `trait`与 an 的隐式转换`Iterable`），它允许您按以下方式对您的交易进行分组`currency`：

```
trait Groupable[V] extends Iterable[V] {
  def groupBy(f: V => K): MultiMap[K, V] = {
    val m = new mutable.HashMap[K, Set[V]] with mutable.MultiMap[K, V]
    foreach { v => m add (f(v), v) } //add is defined in MultiMap
    m
  }
}
implicit def it2groupable(it: Iterable[V]): Groupable[V] = new Groupable[V] {
  def elements = it.elements
} 
```

因此`Groupable`，只需提供一种方法来从 an 中的每个项目中提取*密钥*`Iterable`，然后将具有相同密钥的所有此类项目分组。所以，在你的情况下：

```
//mm is a MultiMap[Currency, Trade]
val mm = trades groupBy { _.currency } 
```

您现在可以执行一个非常简单的`mapElements`( `mm`is a `Map`) 和 a `foldLeft`（或`/:`- 非常值得理解该`foldLeft`运算符，因为它可以对集合进行极其简洁的聚合）来获得总和：

```
val sums: Map[Currency, Int] = mm mapElements { ts => 
    (0 /: ts) { (sum,t) => sum + t.notional } 
} 
```

抱歉，如果我在最后一行中犯了一些错误。`ts`是 的值`mm`，它们是（当然）`Iterable[Trade]`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-03T21:46:41.790

开始`Scala 2.13`，大多数集合都提供了[groupMapReduce](https://www.scala-lang.org/api/2.13.x/scala/collection/immutable/List.html#groupMapReduce[K,B](key:A=%3EK)(f:A=%3EB)(reduce:(B,B)=%3EB):scala.collection.immutable.Map[K,B])方法，它（顾名思义）等效于（更有效）a和 reduce 步骤`groupBy`：`mapValues`

```
trades.groupMapReduce(_.currency)(_.amount)(_ + _)
// immutable.Map[String,Int] = Map(JPY -> 10000100, USD -> 10010000, GBP -> 10001000) 
```

这：

*   `group`s 元素基于其货币（**组**MapReduce 的组部分）

*   `map`s 分组值到它们的数量（映射组**Map** Reduce 的一部分）

*   `reduce`s 值 ( `_ + _`) 通过对它们求和（减少 groupMap **Reduce**的一部分）。

这是一次通过以下列表[执行](https://github.com/scala/scala/blob/v2.13.0-M5/src/library/scala/collection/Iterable.scala#L604)的等效版本：

```
trades.groupBy(_.currency).mapValues(_.map(_.amount).reduce(_+_)) 
```

# scripting - grep'ing 来自不断更新的输出的输出

> ID：1023914
> 
> 赞同：1
> 
> 时间：2009-06-21T13:40:26.387
> 
> 标签：scripting, grep, darwin

我正在尝试围绕 Lame 编写一个简单的脚本，以针对我的特定用途自定义程序。我想做的只是从 Lame 输出中解析出完整性百分比。

这是这条线现在的样子：

```
./lame --nohist ~/Desktop/Driver.wav ~/Desktop/Driver.mp3 2>&1| egrep -o "\([0-9\%]+\)" 
```

但这没有任何回报。下面是 Lame 的输出：

```
    LAME 3.99 (alpha 1, Jun 4 2009 19:42:31) 32bits (http://www.mp3dev.org/)
    警告：alpha 版本应仅用于测试
    使用多相低通滤波器，过渡带：16538 Hz - 17071 Hz
    编码 /Users/jkubicek/Desktop/Driver.wav
        到 /Users/jkubicek/Desktop/Driver.mp3
    编码为 44.1 kHz j-立体声 MPEG-1 Layer III (11x) 128 kbps qval=3
    框架 | CPU 时间/估计 | 实时/估计 | 播放/CPU | 预计到达时间
    1500/8765 (17%)| 0:02/ 0:15| 0:03/ 0:17| 14.654x| 0:14
```

最后一行代码随着文件的转换而动态更新。当我将这个确切的文本复制/粘贴/回显/管道到我的 grep 中时，它发现 17% 就好了，但是当我真正运行它时，它发现了 zilch。

编辑：当我将 lame 的输出放入文本文件时，结果如下所示：

[![lameout.txt](../Images/85baf3554acc7cd5d05b922d0634baf4.png)](https://i.stack.imgur.com/zMLVN.gif)

看起来我可以将输出推送到一个临时文件并从那里读取完成的百分比，但这感觉很尴尬，就像应该有一种更优雅的方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T13:45:31.680

我怀疑你可能无法做到这一点。百分比输出可能会通过[curses](http://en.wikipedia.org/wiki/Curses_%28programming_library%29)进入终端（以允许就地动态更新），因此通过 stdout 的输出将是有限的。

可能值得将输出重定向到文件并查看那里写入的内容。IE

```
lame > /tmp/lame.log 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T13:46:54.377

lame 在未连接到终端时可能不会以相同的方式输出此信息。尝试在末尾使用“> output.txt”运行您的蹩脚命令，并查看它在附加到另一个进程时打印的内容。

另一个很可能的可能性是“17%”实际上从未打印出来。打印的可能是：

%, 向左移动, 1, 向左移动, 2, 向左移动 3, ... 向左移动, 向左移动, 1, 7, 向左移动 8, 等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-16T22:35:32.607

我最终使用`NSScanner`来解析输出。中的每一行都`NSTask`发送到此方法：

```
- (NSNumber *)parseOutputString:(NSString *)output {
  NSScanner *scanner = [NSScanner scannerWithString:output];
  NSString *endString = @"% complete";
  NSInteger percentComplete;
  BOOL didFindNumber = NO;

  while (![scanner scanString:endString intoString:nil]) {
        [scanner scanUpToCharactersFromSet:[NSCharacterSet decimalDigitCharacterSet] intoString:nil];
        didFindNumber = [scanner scanInteger:&percentComplete];

        if ([scanner isAtEnd]) {
              didFindNumber = NO;
              break;
        }
  }

  if (didFindNumber) {
        return [NSNumber numberWithInteger:percentComplete];
  } else {
        return [NSNumber numberWithInt:0];
  }
} 
```

# c# - 仅表单不透明度

> ID：1023924
> 
> 赞同：1
> 
> 时间：2009-06-21T13:43:30.543
> 
> 标签：c#, .net, winforms

首先，我将向您展示我试图在纯 NET 中重新创建的图像。

[图片](http://img221.imageshack.us/img221/456/7sw5.jpg)

我重新创建了“库存”窗口，唯一剩下的是蓝色不透明窗口，它显示了信息。

如果我使用 opacity 属性，那么该表单上的所有内容都具有不透明度，但在图片上，文本没有不透明度。

如何仅在表单上设置不透明度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T14:25:25.217

该`Opacity`属性仅存在于表单上，因此无法在其中包含的控件上覆盖它。

我确实认为稍微透明的背景图像可能会产生您想要的效果 - 但我刚刚尝试过，它似乎没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T14:00:11.227

不确定这是否有帮助，但我唯一能想到的不使用 WPF 就是使用 TransparencyKey 和表单的背景色。只需确保您的 TransparencyKey 未设置为默认控件或灰色，表单的背景颜色可能为红色或其他。如果您正在寻找部分透明度，您可能最终不得不使用 WPF。就我个人而言，我从来没有在实际表单上尝试过使用 WPF 的不透明度，所以你“可能”得到相同的结果，但是......

编辑： WPF 导致相同的情况。表单下的所有控件都随表单变得透明。可能是因为它们固有的表单属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-06T16:14:27.080

你可以使用这个：

```
 using System.Drawing.Drawing2D;

    private void Form1_Paint(object sender, PaintEventArgs e)
    {
        var hb = new HatchBrush(HatchStyle.Percent50, this.TransparencyKey);

        e.Graphics.FillRectangle(hb, this.DisplayRectangle);
    } 
```

等待帮助你..再见

# html - absolute href 可以在生产站点上使用吗？

> ID：1023929
> 
> 赞同：2
> 
> 时间：2009-06-21T13:45:11.197
> 
> 标签：html, apache, mod-rewrite, url-rewriting

由于我正在处理的项目中的一些 apache 重写规则，通常将 href 和链接设置为绝对值很方便，因为这样可以确保浏览器能够找到该链接后面的文件，无论 URL 是什么。

例子：

```
<img src="http://localhost/project/gfx/abc.jpg"></img> 
```

代替

```
<img src="gfx/abc.jpg"></img> 
```

前者会比后者慢，还是以任何方式不如后者？

这不像我认为这是优化；我想无论如何我都会使用绝对 URL（除非有很好的*理由*不这样做），但我很想知道使用绝对 URL 是否可以。

请注意，这将适用于所有链接/路径（超链接、css 和 javascript 包括、AJAX 调用等）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T13:48:30.597

它不会有什么不同。你可能更喜欢这样做：

```
<img src="/project/gfx/abc.jpg" /> 
```

浏览器将为您找出域。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-21T13:48:04.047

相对路径之所以有用有多种原因，其中很多归结为：

*   您可以将整个站点移动到新域，而不必修改每个文件。

如果站点处于活动状态，这不仅适用于更改域，而且当您部署站点时也从测试转移到生产。如果您有绝对路径，则必须从以下位置更改所有引用：

```
<a href="http://localhost/...">...</a> 
```

到：

```
<a href="http://www.truedomain.com/...">...</a> 
```

我*认为*这不会对性能产生任何影响——但我敢肯定，如果我错了，比我更有知识的其他人很快就会纠正我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T13:56:10.707

浏览器将找出任何 URL 的完整 URL，并尽可能重用连接，无论如何它都需要完整的 URL 来请求文件。

考虑使用不带域名的绝对 URL（如 Samir 建议的那样）。如果您对同一站点使用具有不同域名的完整 URL（例如 www.mysite.com 和 mysite.com），浏览器将无法重用该连接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T14:17:55.967

最大的问题是您没有使您的网站“可移植”。这意味着您可以将其从开发转移到暂存到生产，而无需修改。您是否考虑过使用 html base href 标记？然后你只需要在一个地方改变它。

基本标签有一些变体，例如基本目标，也可能有用。这是一个旧标签，因此可以在任何浏览器中使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T13:55:23.220

相对 URL 使用较少的带宽：P

但是你真的应该被 ChrisF 和 Samir 的回答所吸引。如果你不能相信你的 Apache 服务器不会错误地重写东西，我建议你考虑解决这个问题，而不是用绝对的东西来覆盖所有东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T13:56:26.120

我会推荐“/path/from/document_root”格式。正如您在评论中提到的那样，动态生成它们的唯一优势是，如果您将媒体移动到具有不同域/IP 的某种 CDN。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-21T13:58:03.713

AFAIK，无论是使用绝对路径还是相对路径，都应该在浏览器渲染上具有相同的性能。每种解决方案都有其自身的优点和缺点。

例如，当您必须在不同的域上部署应用程序并且您无法自动调整主机名时，相对路径会更好。如果您使用服务器端编程语言管理您的网站，这个问题实际上并不存在。

另一方面，绝对链接具有某种优势。例如，许多低质量的提要阅读器和解析器在解析您的网站甚至您的提要时不会解析到资产的路径。使用绝对路径可确保与所有类型的外部解析器更好地兼容。

# wpf - 在 WPF 中实现 WYSIWYG 文档编辑器？

> ID：1023933
> 
> 赞同：2
> 
> 时间：2009-06-21T13:47:19.273
> 
> 标签：wpf, wysiwyg

您将如何在 WPF 中实现 WYSIWYG 文档编辑器？

这个编辑器将与所见即所得的 html 编辑器非常相似，但后端数据结构不必是 html。目前，我有一个基于用 c++ 实现的 mshtml 控件的工作版本（这很像 MS InfoPath）。我正在寻求从此工具中删除 mshtml 依赖项，因此使用 WPF WebBrowser 控件是我想要避免的选择。

支持的基本功能：

1.  流式文档
2.  支持一组基本控件（TextBox、DropDown、ListBox、DatePicker 等）
3.  支持基本样式
4.  支持表格（调整大小、合并单元格、拆分单元格等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-26T00:26:34.637

可能不完全是您所追求的，但您可能想调查 WPF 中内置的 FlowDocument 支持，因为它支持您所要求的很多内容：[https ://docs.microsoft.com/en-us/dotnet/framework/ wpf/高级/流文档概述](https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/flow-document-overview)

# workflow - Speed up workflow with Automator

> ID：1023934
> 
> 赞同：0
> 
> 时间：2009-06-21T13:47:20.880
> 
> 标签：workflow, automator

I noticed that every time that I restart my computer I have to do the following tasks:

*   open Terminal
*   type 'cd sites/mysite'
*   open another tab in Terminal
*   type 'cd sites/mysite'
*   type 'script/server --debugger'
*   open Safari
*   go to '[http://localhost:3000/](http://localhost:3000/)'
*   open TextMate
*   Open -> mysite

Is it possible to automatize this process using Automator? If no, there are any alternatives to speed up this process?

I tried to register this process with Automator, but would be better to use commands directly.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T13:56:34.073

You probably can with Automator, and I would start by trying recording it in Automator (Workflow>Record; it will tell you about the special sysPreference you need to turn on).

If Automator can't record it easily, then Applescript would probably be much easier. Automator shines when one piece needs to flow into another (a real "workflow"). When it's just a bunch of independent steps, then shell scripts or applescripts are easier (except in cases where Automator can record it for you).

Some tips:

In a shell script, "open http://..." will open the page in your preferred browser.

osascript lets you run small Applescripts within a shell script.

Automator can run both shell scripts and applescripts

Applescripts can run shell scripts.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T14:07:48.203

好吧，您实际上并不需要 Automator 来完成大多数这些任务 - 只需为终端和 Safari 设置良好的默认值即可。

使用终端，您可以进入设置并定义几个终端窗口以在启动时运行特定脚本。然后，您可以随意排列这些窗口（选项卡、窗口或两者的组合）并将结果保存为窗口组。然后，您可以使该窗口组在终端打开时自动启动。

最后，您可以进入系统偏好设置并将 Safari 和终端设置为登录项（在帐户下）。

要让 Texmate 打开特定的项目，您可以使用 Textmate 的命令行选项（mate mysite）。

# visual-studio-2008 - How to Paste a pre-formated text in the cursor position in VS2008?

> ID：1023938
> 
> 赞同：0
> 
> 时间：2009-06-21T13:49:07.430
> 
> 标签：visual-studio-2008, text, copy, paste

I'm creating an application to help with e-mail replying, so I got a few sample mensages I want to Paste into the e-mail text page, starting from the cursor position.

Imagine, I got this app with Button1,2,3,4 etc, and associated to each button is a pre-formated text, so when I hit Button1 it will Paste the text, starting the cursor location.

Is it possible? And what's the code to do it?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T13:53:04.707

You can use a Rich Textbox for the control. If the pre-formatted text is in your clipboard it should just be a matter of pasting in the rich textbox. Rich Textbox's will hold formatted for RTF. I'm assuming your using C# or VB.NET.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T13:08:11.107

我正在使用 Visual Studio 2008 Pro，主要使用 VB 语言。在 MSDN 中进行了长时间的研究后，我检查了一些使用剪贴板操作的例程，但我不知道如何正确使用它们。

首先，假设我想在带有换行符的剪贴板格式文本中“插入”......我只设法插入了一个字符串，没有任何换行格式。我真的不需要使用 RTF，Unicode 很适合我，但是......带有换行符。

在那之后是最困难的工作......如何将剪贴板副本自动写入记事本/Word/任何文本光标。我知道这要求太多，但如果我可以将格式化的文本自动“插入”到剪贴板中，然后自己制作粘贴，我会很高兴。

非常感谢您的帮助！

# vector - 将法线向量旋转到轴平面上

> ID：1023948
> 
> 赞同：11
> 
> 时间：2009-06-21T13:54:50.037
> 
> 标签：vector, geometry, rotation, trigonometry

我在 3D 空间中有一组数据点，它们显然都落在一个特定的平面上。我使用 PCA 来计算平面参数。PCA 的第三个分量给了我平面的法向量（最弱的分量）。

我接下来要做的是将所有点转换到所述平面上并在 2D 中查看它。

我的想法是执行以下操作：

*   在平面上找一个中心点（平均点）
*   从所有数据点中减去它以将它们排列在原点周围
*   旋转法线使其变为 (0,0,-1)
*   将此旋转应用于所有数据点
*   使用正交投影（基本上，跳过z轴）

现在我一直在寻找正确的旋转操作。我尝试使用 acos 或 atan 并设置两个旋转矩阵。似乎这两种方法（使用 acos，使用 atan）都给了我错误的结果。也许你可以在这里帮助我！

Matlab代码如下：

```
b = atan(n(1) / n(2));
rotb = [cos(b) -sin(b) 0; sin(b) cos(b) 0; 0 0 1];
n2 = n * rotb;
a = atan(n(1) / n(3));
rota = [cos(a) 0 sin(a); 0 1 0; -sin(a) 0 cos(a)];
n3 = n2 * rotaows: 
```

我希望`n2`y 分量为零。但是，对于向量（-0.6367、0.7697、0.0467），这已经失败了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-21T14:45:32.540

如果你有一个平面，你就有一个法线向量和一个原点。我根本不会做任何“轮换”。你离你的答案只有几个向量操作。

*   让我们将平面的法向量称为新的 z 轴。
*   您可以通过将旧的 x 轴与新的 z 轴（您的平面的法线）相交来生成新的 y 轴。
*   通过将新 z 与新 y 相交来生成新的 x 轴。
*   将所有新的轴向量变成单位向量（长度为 1）。
*   对于您拥有的每个点，创建一个从新原点到该点的向量（点的向量减法 - plane_origin）。只需点上新的 x 和新的 y 单位向量，就可以得到一对 (x,y) 可以绘制！

如果您已经有交叉和点积功能，这只是几行代码。我知道它有效，因为我编写的大多数 3D 视频游戏都是这样工作的。

技巧：

*   注意你的向量指向的方向。如果他们指向错误的方向，则否定结果向量或更改叉积的顺序。
*   如果您的平面法线与原始 x 轴完全相同，您将遇到麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T14:27:11.050

怎么样：

将法线向量分解为 XY 平面中的向量和 Z 向量。然后围绕 Z 轴应用旋转以将 XY 向量与其中一个轴对齐。然后找到法线与 Z 轴的点积，并沿着您对齐的 X、Y 中的任何一个旋转。

这个想法是将法线向量与 Z 对齐，通过这样做，您的平面现在是 XY 平面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-16T15:41:28.863

这是用 Python 做出的公认答案：

```
import numpy as np

def rotate(points, normal, around):
  # Let's rotate the points such that the normal is the new Z axis
  # Following https://stackoverflow.com/questions/1023948/rotate-normal-vector-onto-axis-plane
  old_x_axis = np.array([1, 0, 0])

  z_axis = normal
  y_axis = np.cross(old_x_axis, z_axis)
  x_axis = np.cross(z_axis, y_axis)

  axis = np.stack([x_axis, y_axis, z_axis])

  return np.dot(points - around, axis.T)

points = np.array([
    [0, 1, 1],
    [0, 1, 0.2],
    [1, 0, -7]
])

v1 = points[1] - points[0]
v2 = points[2] - points[0]

normal = np.cross(v1, v2)
print("rotated points", rotate(points, normal, points[0])) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T15:13:04.840

虽然还有其他有趣的回应，但这是我们在等待答案时想出的解决方案：

```
function roti = magic_cosini(n)
    b = acos(n(2) / sqrt(n(1)*n(1) + n(2)*n(2)));
    bwinkel = b * 360 / 2 / pi;
    if (n(1) >= 0)
        rotb = [cos(-b) -sin(-b) 0; sin(-b) cos(-b) 0; 0 0 1];
    else
        rotb = [cos(-b) sin(-b) 0; -sin(-b) cos(-b) 0; 0 0 1];
    end
    n2 = n * rotb;
    a = acos(n2(3) / sqrt(n2(2)*n2(2) + n2(3)*n2(3)));
    awinkel = a * 360 / 2 / pi;
    rota = [1 0 0; 0 cos(-a) -sin(-a); 0 sin(-a) cos(-a)];
    roti = rotb * rota; 
```

（它返回一个希望正确的双旋转矩阵）

我们之前遇到的并在这里修复的缺陷是 esp。处理余弦计算中未涵盖的 X 分量的符号。这使我们以错误的方向旋转一次（旋转 180° - 角度）。

我希望我也能抽出时间尝试 Nosredna 的解决方案！避免三角函数总是好的。

# c# - 共享内存并运行可执行文件的多个副本

> ID：1023950
> 
> 赞同：4
> 
> 时间：2009-06-21T13:55:37.807
> 
> 标签：c#

我有一个运行多次的应用程序（winform exe）。这是否意味着我有共享程序集或者每个实例都有自己的程序集副本？当我运行该应用程序时，它使用了大约 30MB（在任务管理器中），而当我运行该应用程序的另一个副本时，它又使用了 30MB。

我如何计算出它使用了多少内存，如果我运行多个实例，我是否可以减少内存的过度使用？

问候JD。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T15:26:00.213

情况很复杂。

首先阅读我最近关于虚拟内存的文章。

[http://blogs.msdn.com/ericlippert/archive/2009/06/08/out-of-memory-does-not-refer-to-physical-memory.aspx](http://blogs.msdn.com/ericlippert/archive/2009/06/08/out-of-memory-does-not-refer-to-physical-memory.aspx)

好的，现在您对虚拟内存的工作原理有了一些了解，您可以了解操作系统如何将 DLL 加载到内存中。假设您有两个进程都需要 Foo.DLL 的特定页面。操作系统会将该页面加载到*物理*内存一次，然后将该物理页面映射到两个进程的虚拟空间中。因此，正在使用的物理内存量是 4KB 页。但是这 4KB 出现在两个进程中。您的 30MB 中的大部分很可能是共享物理内存。

找出答案的方法是更复杂地了解您对任务管理器的使用。您想在那里添加一些列并查看“工作集”和“私有工作集”。“工作集”是该进程当前使用的私有和共享页面的总数。“私人工作集”是那些不共享的数量。

为了降低您的内存使用量——首先，首先要了解您关心的原因。这些天机器有足够的内存，而 30MB 是一个相对较小的内存量。除非你能找到一个令人信服的以客户为中心的理由来解决这个问题，否则就去做其他事情，比如让你的程序更快或添加更多功能。假设您确实有理由关心，请为自己准备一些工具——尤其是内存分析器。.NET 内存分析器可以告诉您所有分配在哪里以及它们有多大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T14:07:54.550

如果您没有静态资源，您可以在应用程序启动并且它的实例已经存在时添加一个新线程，而不是使用第二个进程。这就是 Firefox 所做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T14:00:55.203

当您注意到运行应用程序的第二个副本使用另外 30MB 内存时，我认为您已经回答了自己的问题。

您的应用程序的每个实例都将在其自己的进程空间中运行，并且不会与应用程序的任何其他实例共享内存或非文件资源。

在不知道您的应用程序做什么的情况下，我能想到的（目前）减少它使用的内存量的唯一方法是将数据写入磁盘。当这些对象超出范围时，这将释放内存 - 但是当您从磁盘读回数据时显然会被重用。

# c - 信号不能通过 execv() 正确重新启用

> ID：1023955
> 
> 赞同：6
> 
> 时间：2009-06-21T13:57:05.790
> 
> 标签：c, linux, signals

我正在为我正在开发的 Linux 发行版编写一个系统关键程序。它需要在接收到某些信号时自行重启，以避免崩溃。问题是，重新启动后，我无法重新启用该信号。即，信号不能被接收两次。在 execv()'ing 自身之后，当新进程调用 signal() 来设置信号时，返回 SIG_DFL。每次。即使我连续两次调用它——表明它从来没有被设置在首位。是否从原始过程中继承了一些奇怪的标志？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-21T21:17:25.273

您实际上是在尝试递归处理信号这一事实。

当`signal()`用于注册信号处理程序时，该信号编号被阻塞，直到信号处理程序返回 - 实际上，内核/libc 在调用信号处理程序时阻塞该信号编号，并在信号处理程序返回后解除阻塞。由于您永远不会从信号处理程序返回（而是您`execl`是一个新的二进制文件），`SIGUSR1`因此会保持阻塞状态，因此不会第二次被捕获。

这可以通过检查`/proc/</pid>/status`您发送第一个之前和之后看到`SIGUSR1`。

前：

```
$ cat /proc/<pid>/status | grep -E "Sig(Cgt|Blk)"
SigBlk: 0000000000000000
SigCgt: 0000000000000200 
```

后：

```
$ cat /proc/<pid>/status | grep -E "Sig(Cgt|Blk)"
SigBlk: 0000000000000200
SigCgt: 0000000000000200 
```

请注意，`SigCgt`表示信号 10 已注册（数字是位域；第 10 位已设置，相当于 SIGUSR1，请参阅`man signal(7)`数字）。`SigBlk`在发送到您的进程之前为空`SIGUSR`，但在发送它包含的信号之后`SIGUSR1`。

你有两种方法可以解决这个问题：

一种）。在`SIGUSR`调用之前手动解除阻塞：`execl``sighandler`

```
sigset_t sigs;
sigprocmask(0, 0, &sigs);
sigdelset(&sigs, SIGUSR1);
sigprocmask(SIG_SETMASK, &sigs); 
```

乙）。`sigaction`与`SA_NODEFER`标志一起使用，而不是`signal`注册信号处理程序。这将防止`SIGUSR1`在信号处理程序内部被阻塞：

```
struct sigaction act;
act.sa_handler = signalhandler;
act.sa_mask = 0;
act.sa_flags = SA_NODEFER;
sigaction(SIGUSR1, &act, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T14:28:50.967

信号处理程序不会被继承，`exec`因为它会`exec`覆盖您的整个地址空间，并且任何未重置的信号处理程序都将指向错误的位置。唯一不重置的情况是它是否设置为，例如，`SIG_IGN`这不依赖于预处理的地址空间`exec`。

# wpf - 键绑定 RelayCommand

> ID：1023960
> 
> 赞同：27
> 
> 时间：2009-06-21T13:58:49.173
> 
> 标签：wpf, mvvm, key-bindings

我在我的应用程序中使用[RelayCommand](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)。将代码放在视图模型中非常棒，但是如何将击键绑定到我的命令？

RoutedUICommand 有它的 InputGestures 属性，当我按下按键时，它会自动调用该命令。（作为一个额外的好处，它甚至可以在 MenuItem 中显示击键。）不幸的是，RoutedUICommand 的额外属性没有可重用的接口，因此我无法制作具有相同魔力的 RelayUICommand。

我已经尝试过使用 InputBindings：

```
<Window.InputBindings>
    <KeyBinding Key="PageUp" Command="{Binding SelectPreviousLayerCommand}"/>
</Window.InputBindings> 
```

但这给了我一个运行时异常，因为 KeyBinding.Command 不是依赖属性。（实际上，它抱怨的是 KeyBinding 甚至不是 DependencyObject。）由于我的 RelayCommand 是我的 ViewModel 上的一个属性（与 RoutedUICommand 设计的静态字段相反），数据绑定是我知道的唯一方法从 XAML 中引用它。

你们是怎么解决这个问题的？将击键绑定到 RelayCommand 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-21T14:47:16.530

出于您所描述的原因，我认为您不能从 XAML 执行此操作。

我最终在代码隐藏中完成了它。虽然它是代码，但它只是一行代码，而且还是相当声明性的，所以我可以忍受它。但是，我真的希望在下一版本的 WPF 中解决这个问题。

这是我的一个项目中的示例代码行：

```
this.InputBindings.Add(new KeyBinding(
    ((MedicContext)this.DataContext).SynchronizeCommand,
    new KeyGesture(Key.F9))); 
```

在这种情况下，SynchronizeCommand 是 RelayCommand 的一个实例，并且（显然）F9 会触发它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-10-05T11:37:32.190

KeyBinding 类的 Command 属性不支持数据绑定。这个问题将在 .NET 4.0 中得到解决，您应该能够在即将到来的 .NET 4.0 Beta 2 版本中看到它。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-09-28T23:45:03.607

您可以继承 KeyBinding，添加一个`CommandBinding`设置 Command 属性的依赖项属性，然后像任何其他输入绑定一样将其添加到 XAML。

```
public class RelayKeyBinding : KeyBinding
{
    public static readonly DependencyProperty CommandBindingProperty =
        DependencyProperty.Register("CommandBinding", typeof(ICommand), 
        typeof(RelayKeyBinding),
        new FrameworkPropertyMetadata(OnCommandBindingChanged));
    public ICommand CommandBinding
    {
        get { return (ICommand)GetValue(CommandBindingProperty); }
        set { SetValue(CommandBindingProperty, value); }
    }

    private static void OnCommandBindingChanged(
        DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var keyBinding = (RelayKeyBinding)d;
        keyBinding.Command = (ICommand)e.NewValue;
    }
} 
```

XAML：

```
<Window.InputBindings>
    <RelayKeyBinding 
        Key="PageUp" 
        CommandBinding="{Binding SelectPreviousLayerCommand}" />
</Window.InputBindings> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-11T08:05:57.690

您可以使用 CommandReference 类。

非常优雅的代码，就像一个魅力。

看一看：[如何在 Composite WPF 中将按键与 DelegateCommand 相关联？](https://stackoverflow.com/questions/1468362/how-do-i-associate-a-keypress-with-a-delegatecommand-in-composite-wpf)

它与 RelayCommands 的工作方式相同，但它不会更新您的 CanExecutes，因为 CommandReference 不使用 call`CommandManager.RequerySuggested` 实现自动`CanExecute`重新评估所需要做的就是在 CommandReference 类中进行以下更改

```
public event EventHandler CanExecuteChanged
{
     add { CommandManager.RequerySuggested += value; }
     remove { CommandManager.RequerySuggested -= value; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-25T00:54:17.993

我在我的视图模型中创建了一个键绑定，它像这样链接命令和键

```
 this.KeyBinding = new KeyBinding();
        //set the properties
        this.KeyBinding.Command = this.Command;
        this.KeyBinding.Key = this.Key;
        //modifier keys may or may not be set
        this.KeyBinding.Modifiers = this.ModifierKeys; 
```

然后我在我的视图模型根中创建一个 InputBinding 项的集合，并将它们添加到我窗口代码后面的窗口 InputBindings

```
 foreach (var item in applicationViewModel.InputBindingCollection) {
        this.InputBindings.Add(item);
     } 
```

我知道在后面的代码中做东西的形式不好，但我还不知道如何进行绑定，但我仍在努力。:) 这没有给我的唯一的东西是菜单中的一个关键命令修改器列表，但这即将到来。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-07-13T14:02:55.690

假设您的 RoutedCommands 是静态定义的：

```
#region DeleteSelection

    /// <summary>
    /// The DeleteSelection command ....
    /// </summary>
    public static RoutedUICommand DeleteSelection
        = new RoutedUICommand("Delete selection", "DeleteSelection", typeof(ChemCommands));

    #endregion 
```

因此在 XAML 中绑定：

```
<Canvas.InputBindings>
    <KeyBinding Key="Delete" Command="{x:Static Controls:ChemCommands.DeleteSelection}" />
</Canvas.InputBindings> 
```

问候，

蒂姆·豪顿

# iis - iis 7 handler error

> ID：1023961
> 
> 赞同：0
> 
> 时间：2009-06-21T13:59:31.493
> 
> 标签：iis

The resource you are looking for does not have a handler associated with it.

This is the error that i get when trying to load an asp file from iis 7.0

I am using windows vista home basic

I got to know that the solution for this is to enable the static file handler

also, there is no file handler installed in vista home basic ........Can anyone help to get rid of this please

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-21T14:14:55.177

我不认为默认情况下会安装 IIS7 的 ASP 功能，因此如果您还没有安装和配置它，您可能需要安装和配置它。

这些链接解释了在 IIS7 中设置 ASP 支持需要做什么：

1.  [在 IIS7 上配置 ASP](http://www.alexthissen.nl/blogs/main/archive/2008/02/18/running-classic-asp-on-iis-7.aspx)
2.  [IIS7 上的 ASP 提示](http://blogs.iis.net/bills/archive/2007/05/21/tips-for-classic-asp-developers-on-iis7.aspx)

# actionscript-3 - What exactly is garbage collection and how do you do it in ActionScript 3.0?

> ID：1023962
> 
> 赞同：4
> 
> 时间：2009-06-21T13:59:37.983
> 
> 标签：actionscript-3, actionscript, garbage-collection

I've been programming in ActionScript for about 6 years now but never heard of the term 'garbage collection' until AS3 came out. Why do we have to worry about it now, and never before? And what, precisely, is it? From what I've read/heard, it has something to do with memory management/leaks, etc. -- and even *that* I don't understand much of, other than it has something to do with performance.

I recently launched a site for an artist friend of mine, and it was done in AS3\. I am noticing that it takes up a LOT of resources. Obviously this is something I'd like to improve. I'm guessing it has something to do with the fact that there is no garbage collection going on?! Unfortunely, I haven't the slightest idea on where to begin in regards to that, as I feel I need a better undestanding of what it is and how to go about doing it specifically in AS3\.

For the curious, here is the URL: [http://www.jeffperrott.com](http://www.jeffperrott.com)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T14:27:39.957

垃圾收集器是清理未使用内存的运行时部分（在您的情况下是 Flash 或 AIR 播放器）。像所有脚本语言（例如 javascript、perl、ruby 等）一样，ActionScript 一直都有垃圾收集功能，您只是没有看到它对 AS 进行了太多讨论。

基本思想是创建的每个对象都占用一些内存，并且您的变量保持对这些对象的引用。一个对象的内存不会“释放”回可用内存池中，直到不再有对它的引用。垃圾收集器跟踪哪些对象引用了它们，并在不同的时间间隔回收那些引用为零的对象的内存（即没有变量指向它，所以甚至没有代码可以找到它来使用它）。如果有任何引用*，则无法回收对象的内存，以防您的代码的某些部分决定将来使用它。

如果您的程序似乎正在泄漏内存（不断增长，大小从未稳定或缩小），那么您可能将对象放置在散列或数组或其他一些集合对象中。这个对象显然维护了对其内容的引用，所以这些东西永远不会被删除。

请注意，在 ActionScript 中，使用闭包作为事件处理程序很容易创建“泄漏”。如果您的处理程序可以访问已分配但从不为空的变量，则这些变量会保留其引用，并且只要注册了事件处理程序，它们指向的对象就不会被垃圾回收。

```
function registerHandler(neverReleased:Object) {
    ...
    addEventHandler(function (e:Event) {
            ...
        });
} 
```

直接调用垃圾收集器几乎总是一件坏事（tm），Flash/Flex 中的垃圾收集器非常好。首先找出你的对象被存放在哪里，然后释放它们，让 GC 按照自己的时间表工作。

*除了[循环引用](http://en.wikipedia.org/wiki/Circular_reference)，这有点超出了这个答案的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T17:13:47.440

Every time you use the "new" keyword to create an object, you're staking your claim on a piece of memory [1]. So let's say you're making a uint by writing `var exampleUint:uint = new uint();`. ActionScript says to the computer "hey... I need like... four bytes of memory.", to which the computer replies "ok cool, use the four bytes starting at [some memory address, like 0x7B3208C1]"[2]. So when you say `var someString:String = "blah";` you claim a space in memory, fill it with some information (in this case, it's `"blah"`), create a label (in this case, it's `someString`), and [bind](http://en.wikipedia.org/wiki/Binding_(computer_science)) the label to that space in memory.

Now the label doesn't actually associate to the data itself, it associates to the spot in memory containing the data. That should seem confusing, because it is, but it makes a whole shit-ton of sense for certain reasons. All objects in ActionScript are [reference](http://en.wikipedia.org/wiki/Reference_(computer_science)) types, which means that the object contains the memory address of some piece of data, not the data itself. This is in contrast to objects that are [value](http://en.wikipedia.org/wiki/Value_(computer_science)) types, where a label associates to the data itself. Don't fret about the details on value types because it's not in ActionScript so for your purposes I'm including it strictly for contrast. OK, confused? You probably should be, because this whole paragraph is needlessly specific and probably even unnecessary, but try to keep it in the back of your head because it *may* have something to do with your problem.

Now, when that label is gone (e.g., it goes out of [scope](http://en.wikipedia.org/wiki/Scope_(computer_science)), so now `someString` is meaningless), only the label `someString` is removed. So for this example, if you say `someString = null;`, the string `"blah"` is actually still in memory, but the label `someString` doesn't reference that piece of information, it references the memory address of [the null object](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/statements.html#null)(again, details). We need a way to specify to the computer "you know the [whateverSize] piece of memory I claimed starting at [whateverAddress]? Well I'm done with it now so somebody else can use that piece of memory". [Gabage collection](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)) is an automatic process for reclaiming memory that you've claimed without having to worry about it yourself. In languages without garbage collection, `new` has a complement keyword that specifically frees the memory associated to an object [3], but ActionScript doesn't have that; you just take a piece of memory and forget about it.

Somewhere along the lines, you may have created another variable and referenced that piece of data, `var someOtherString:String = someString;`, so we can't just say "ok, the label `someString` is gone, so let's get rid of the data that it references", because we don't know for sure that `someString` is the only reference to that data. The method in which this is done varies between languages and garbage collection systems, but the basic deal in ActionScript is this: every now and then (especially if Flash is currently taking up a lot of memory), the garbage collector looks at all of the objects in the current SWF and finds all of the objects that don't have any reference [4]. So for our previous example, if `someString` was the only thing that referenced the string `"blah"` and `someString` goes out of scope, then `"blah"` isn't associated to any label and is therefore totally unreachable by Flash. The next time the garbage collector runs, it will find that and then report back to the system that it's done with that piece of memory.

Now, the specific details of your particular problem would be hard to say without looking at the source, but I can tell you that one of the things that often causes problems is event listeners. Sometimes you might create a function and add it as an event listener. Now *the event itself* has a reference to that function [5], so if the function goes out of scope, there's still a reference to it and the function does not get picked up by the garbage collector (remember, functions are objects in ActionScript). You can either remove event handler manually by calling removeEventListener (I wouldn't recommend it), or set the `useWeakReference` parameter in you calls to [addEventListener()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/IEventDispatcher.html#addEventListener()) to `true`. A weak reference is not recognized by the garbage collector, so setting `useWeakReference` to `true` prevents the situation where you have a function that *should be* picked up by the garbage collector, but it doesn't because someone is referencing it as an event listener. Judging by the sheer number of mouseEvent listeners in your project, this could be the culprit. If you have Flex Builder, you can use the profiler to see how many method closures you have; if they're going up and never coming down, that's probably your problem.

[1]: Keep in mind that this also applies to situations where you create an object without using the `new` keyword, like if you were to write `var exampleInt:int = 5;`.
[2]: I chose uint because all uints are the same size, so I can say with confidence that I know it will be four bytes. Strings are different; they take up an amount of memory proportional to the number of characters they contain, so it would be a little more ambiguous to use String for both examples.
[3]: The ActionScript keyword `delete` is not for this purpose, so don't try to use it in this way, even though that would make perfect logical sense and it would be very useful.
[4]: Flash uses a [mark-and-sweep](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Naive_mark-and-sweep) style strategy, the more specific details of which can be read [here](http://www.adobe.com/devnet/flashplayer/articles/garbage_collection.html). [5]: Actually, that's a boldface lie because the addEventListener method uses [closures](http://en.wikipedia.org/wiki/Closure_(computer_science)), but I have a pretty weak understanding of that to begin with so I can't really boil it down into normal person English.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T10:47:50.523

只是为了帮助您理解为什么您以前没有听说过这个，在以前的 AS 版本中，GC 与显示列表有很深的联系。一旦您从场景中移除了一个对象，它就不再存在（连同任何子对象），并且对它们的任何引用都变为 null。正如您可能已经知道的那样，这种行为在 AS3 中完全相反。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T14:05:22.950

我对 AP3 的实现一无所知，但必须有人发布这个:)

[http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))

基本上，您使用指向数据的指针（嗯，引用）。超出范围的引用将被删除。只要没有引用指向数据，数据就会被标记为垃圾回收。您的 GB 线程（进程或守护进程）将及时释放用于分配标记数据的所有资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-21T14:16:25.767

通常，您或您的开发运行时必须在某个时候手动处理内存，即为您的应用程序数据在内存中创建空间或在应用程序完成后清除内存使用。如果运行时中没有 GC（垃圾收集器），您需要手动处理应用程序中变量和对象的内存空间的创建和删除。

一个例子是原生 C++。在 C++ 程序员可以真正对应用程序做很多事情之前，他们必须做好自己处理内存的基础工作。他们向操作系统请求内存，他们添加分配，他们将对象和数据添加到内存，他们稍后删除对象和数据，他们取消分配内存，他们清理它并再次将其释放给操作系统。

使用 GC，GC 会为您完成所有工作。您所做的只是告诉 GC（通常通过实例化一个对象）您计划使用内存，然后 GC 计算出您需要多少内存，向操作系统询问它，分配并添加您的数据。然后它会不时检查您的应用程序是否仍在使用该对象。如果不是，那么它会删除对象、取消分配、清理它并释放回操作系统。所有这些都是为您完成的，因此您，程序员，可以专注于您的程序。这方面的一个例子是 VB 6.0 和 C#/VB.NET。

编辑：这是一个非常简化的解释。实际上还有更多内容，但这个答案应该回答这里提出的基本问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T14:46:53.803

添加到查德威克​​的答案：

如果在图片中添加EventHandler，但在图片不再显示时不removeerEventHandler，则图片占用的内存无法被垃圾回收器回收。

# c# - ObjectQuery 和“var”有什么区别？

> ID：1023966
> 
> 赞同：1
> 
> 时间：2009-06-21T14:00:32.070
> 
> 标签：c#, asp.net, linq, entity-framework

请看下面两种代码之间的区别。是否有任何性能差异或其他什么？

**第一密码**

```
 ObjectQuery departmans = staffContext.Departman;
                GridView1.DataSource = departmans;
                GridView1.DataBind(); 
```

```
 **Second Codes**

var departmans = staffContext.Departman;
   GridView1.DataSource = departmans;
                GridView1.DataBind(); 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T14:03:52.017

输出代码的有效差异取决于 Departman 的类型。如果 Departman 的类型是 ObjectQuery，那么代码是等效的。

“var”关键字只是告诉编译器，请将此变量的类型设置为与分配给它的表达式相同的类型。在这种情况下，它是 Departman 的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T14:04:35.243

没有区别（假设 staffContext.Departman 的类型是 ObjectQuery 而不是 ObjectQuery 的某个子类）。编译器只是根据赋值的右侧推断类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T15:49:38.467

关键字所代表的类型`var`必须在编译时知道，因此只要在两种情况下类型实际上相同，可执行代码就会相同。

类型是根据右手边的类型推断出来的，所以在某些情况下你需要指定类型才能得到你想要的结果。例如：

```
Stream s = File.OpenRead(fileName); 
```

这当然会给你一个类型的变量`Stream`。另一方面：

```
var s = File.OpenRead(fileName); 
```

这会给你一个类型的变量`FileStream`。

作为一般规则，如果右侧的类型不明显，则根本不应该使用`var`关键字。

# ruby-on-rails - Sphinx 排序：最后是 nil/NULL 值

> ID：1023967
> 
> 赞同：2
> 
> 时间：2009-06-21T14:00:32.413
> 
> 标签：ruby-on-rails, sphinx, thinking-sphinx

在 Rails 项目中，我将 Sphinx 与 Thinking Sphinx 插件一起使用。我索引一个带有属性 :foo 的表，它是一个浮点数。

对列 :foo 进行排序时，我想要的行为是 nil 值总是出现在列表的末尾，例如

```
id; foo (order foo desc)
-------
1; 5
2; 3
3; -4
4: -5
5: nil
6: nil

id; foo (order foo asc)
-------
4: -5
3; -4
2; 3
1; 5
5: nil
6: nil 
```

如果它是普通的 sql，我会排序：

```
:order => "(foo IS NULL) ASC, foo DESC" 
```

但这似乎是不可能的，因为我认为 NULL 值被转换为 0（这是真的吗？）。使用 sphinx 排序表达式似乎无法正确排序我的浮点数。

有没有人解决了这个问题或知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T22:50:53.570

您提供的解决方案就是我的建议 - 是的，您是对的，Sphinx 将 NULL 视为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T14:24:58.340

同时我想出的一个解决方案是索引一个额外的属性，如下所示：

```
define_index do 
  indexes foo, :sortable => true
  has "foo IS NULL", :as => :foo_nil, :sortable => true
end 
```

是什么让我这样订购

```
:order => "foo_nil ASC, foo DESC" 
```

这有点笨拙，特别是因为我有很多我想像这样订购的属性。

# web-services - 基于 URL 的 API 密钥限制：验证如何工作？

> ID：1023971
> 
> 赞同：4
> 
> 时间：2009-06-21T14:03:34.060
> 
> 标签：web-services, api, key, api-key

我很想知道基于 URL 的 api 密钥限制是如何工作的，例如谷歌用来保护其谷歌地图服务的那个。

根据我从这篇文章“[限制对 Ajax 服务的访问](http://www.oracle.com/technetwork/articles/javaee/usingapikeys-137290.html)”的理解，这涉及到两个部分：首先，服务使用单向哈希函数为给定域创建特定密钥；其次，服务根据 Referer 标头验证密钥。

虽然这篇文章的解释性很强，但我仍然无法理解验证方法的安全性。我的意思是，如果只针对引用者检查密钥，这不是很容易伪造吗？我认为主机文件中的简单“127.0.0.1 www.mydomain.com”足以欺骗验证，并认为引用者是 www.mydomain.com 。

我可能误解了一些事情，一些澄清将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T15:24:57.297

您引用的文章的“限制”部分特别提到了欺骗引荐来源网址的可能性。

更改主机文件可能确实足以伪造您的推荐人，但仅当您*从自己的计算机*访问该站点时。这意味着您只能在本地测试时滥用许可证。这不是很有趣的滥用。

为了发布您的应用程序，您需要在*每个人的*浏览器上欺骗引荐来源网址，除非您使用本地运行的可执行文件中的 API，在这种情况下，您可能完全控制所有标头。

# security - 同态加密算法的实际应用？

> ID：1023981
> 
> 赞同：32
> 
> 时间：2009-06-21T14:07:49.153
> 
> 标签：security, encryption, cryptography, privacy, voting

密码学中似乎发生了一些有趣的事情：最近出现了第一个**[同态加密](http://en.wikipedia.org/wiki/Homomorphic_encryption)**[方案（解释](http://www.mail-archive.com/cryptography@metzdowd.com/msg10571.html)，[HT](http://avva.livejournal.com/2099972.html)）。粗略地说，它是一种编码方式，即使您无法轻松恢复`x`and （对于 也是如此），您也可以轻松`f(x)`计算。`f(x+y)``f(x)``f(y)``x``y``f(x*y)`

这种类型的方案有哪些实际应用（一旦建立了安全性）？对我来说，它们似乎可以使编写用于操作私人数据的算法变得更加容易。

这是**我的想法**：

1.  电子投票
2.  检查私人数据的完整性
3.  是否有机会总体上有助于保护隐私？

**示例**：我在 A、B、C 银行有账户。实体 X 想确认我的总金额超过 1000 美元；它会很乐意接受银行 A、B、C 或 D 的对帐单，但不幸的是，我在任何一个帐户中都没有足够的钱。A银行用我的公钥加密了我500美元的信息；同样，银行 B 和 C 分别加密了我有 200 美元和 300 美元的信息。他们将这些数据发送给 X，X 将它们添加到某个数字上，我证明这个数字实际上是加密的 1000 美元（通过用我的公钥加密 1000 美元并证明结果是相同的）。我已经证明了一些事情，但没有透露`X`我每个账户里有多少钱。

**另一个例子**：好公民 X_1, ... , X_n 正在联手选择两名候选人中的一名，其中一名是喝拿铁的自由人**A** l，另一名是持**圣经**的枪支爱好者（所有名字都是虚构的）。他们决定他们希望投票是私密但快速的。他们将投票以`(1, vote_A, vote_B, vote_None)`加密的矢量格式发送给选举委员会，选举委员会公开添加它们并以表格形式获得结果`(count, count_A, count_B, count_None)`。查完之后`count = count_A + count_B + count_None`，官员宣布其中一名候选人获胜，之后法官因某种与电子投票无关的原因宣布选举无效，并在接下来的 10 年里在法庭上进行斗争，但是，嘿，那不是我的反正问题。

**注意**： - 我相信这些特定的例子甚至在以前也可以使用 RSA，因为它只需要一个操作中的同态性。希望我们可以通过更多的操作得到更有趣的东西——所以，拿出例子！

*   我特别希望看到包含代码和/或开发框架的答案，它们有可能在实践中使用，原因是 SO 不是理论计算机科学讨论板。

*   同态算法，重复下面在评论中所说的内容，允许创建一个在不知道数据的情况下管理数据的程序。`if (x=0) ...`不幸的是，程序的类型有些有限：因为是加密的，所以你不能拥有`x`，而且每一步都很慢（涉及一些格子）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-07-03T02:15:13.737

这是黑暗中的狂野镜头：

我们正在考虑保护明文免受对其进行计算的人的影响。但是，如果目标是保护明文和算法呢？

以 MRI 机器为例。MRI机器最昂贵的部分是机器分析磁共振数据的算法。因此，它们受到旨在破坏程序的硬件设备的严格保护，然后才允许不受信任的一方（或任何人）对其进行检查。

如果 MRI 制造商可以集中 MRI 数据计算，那将大大降低丢失算法的风险。但是，法律禁止他们访问私人患者数据。

所以！同态加密允许在患者数据和算法都受到保护的情况下发生这种情况。“完全”同态加密（即在加密数据上引入环同态）允许对数据进行更有效和稳健的计算集。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-04T04:48:36.480

同态加密的最大应用是数据挖掘，恕我直言。该算法的使用可以同时解决隐私和趋势发现的问题。例如，假设您的公司在某个 SAS 提供商上托管其销售信息。现在，该提供商可以为您提供复杂的数据挖掘服务，而无需您实际透露您的真实信息。基本上，您可以将数据发送给计算提供商，让他利用他的 CPU 周期代表您进行计算，然后将加密数据发回给您。对于希望迁移到基于云的系统但又因隐私/IP 问题而无法迁移的公司而言，这真是太棒了。

另一个潜在的应用，在较低和更个人的层面上，将是处理各种财务数据。ilya 的扩展示例适用于您的会计师提交纳税申报表，而无需实际查看您的财务信息、信用卡处理等。

但是，在该方案经过严格测试并被认为安全之前，我会保持兴奋。加密算法有一个臭名昭著的习惯，即未能通过第一次测试，进行修订并重复循环，直到它们得到某些政府机构的“认证”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-23T21:12:50.307

作为一个 PKI 极客，如果同态密码函数也是一个非对称密钥系统，那么您在签名世界中有一些非常有趣的可能性。签名者可能会对消息进行签名，而接收者可以将消息的一部分和密文的相应部分重新传输*给*第三方。

在函数符号中，这将是：

**用户标志：**

符号（明文，私钥）= 密文

并传输：

发送（明文、密文、证书）

**应用程序获取段：**

明文 = 所需明文 + 其他明文

并使用以下方法计算相同的密文转换：

if ciphertext::plaintext then ??::desiredPlaintext

找到想要的密文

**应用程序仅将所需内容转发给外部服务：**

发送（desiredPlaintext，desiredCiphertext，证书）

并且服务可以验证此消息，就好像用户直接发送了它一样。

这取决于用于压缩明文的哈希算法也是同态的。如果没有，这将不起作用......或者没有应用哈希算法。

如果您希望外部服务响应签名的用户请求，但您不想公开用户发送到该外部服务的所有内容，这可能非常有用。

一个例子是一个简单的包裹订购系统——我向一个网络应用程序发送一个购买一系列物品的请求。为了超级安全，我签署了一份采购订单，确认我想要（并承诺支付）一些物品，在某个特定日期之前运送到某个特定地点，并附上一些特定的付款信息。现在.. web 应用程序将希望发生几件事：

*   财务需要向我的帐户收费，并开始从我这里获得付款
*   库存需要从库存中提取物品，或处理任何缺货问题
*   运输需要从库存中接收并将东西移动到我的地址

Inventory 或 Shipping 没有理由知道我如何支付账单。而且财务部门可能没有理由知道我的收货地址……在每种情况下，desiredPlaintext 和desiredCiphertext 都会发生变化，具体取决于接收者是谁。这在像 Amazon.com 旧书这样的系统中更加有效，我从（亚马逊）购买的实体与提供物品的实体（旧书卖家）不同。

阅读有关格密码学的论文，听起来更像是一个对称密钥系统……这对签名消息不太有利。

关于“永不言败”的概念，我并不是说将其用于隐私应用程序是不合理的。但是，您可以找到多种从密文到明文的方法，这似乎很麻烦。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-09T13:06:22.113

您可能有兴趣查看 Bruce Schneier 对同态加密的负面看法：

[http://www.schneier.com/blog/archives/2009/07/homomorphic_enc.html?nc=11](http://www.schneier.com/blog/archives/2009/07/homomorphic_enc.html?nc=11)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-04T18:25:27.423

我不知道`f(x) + f(x)`计算会有多昂贵，但也许它可以用作实现加密数据库的一种方式。

您可以存储 100 万行一些加密为`f(x_1)`, `f(x_2)`, ...的数据`f(x_n)`。你可以做

```
SELECT SUM(x)
FROM Foo
WHERE y = 'some value' 
```

这可以通过先做`SUM(f(x))`然后解密它来计算`SUM(x)`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-10T14:40:32.810

有了这个，你可以执行一个任意的有界深度的非递归电路，所以给定一个对数密钥长度，你可以执行一个 NC1 算法（基本上是一个前馈布尔电路）。

那么，你怎么能使用它呢？

让我们看一下在一组输入上映射/减少电路和减少方案。

先上数据：

我们可能不希望客户端必须对我们要搜索的所有数据进行加密，因此您可以向服务器提供加密的 1 和加密的 0，并让它使用环结构构造任意加密整数对我们来说，或者我们可以直接将它们用作位。这样，服务器可以提供我们正在搜索的部分或全部数据。对于整数，它可以通过农民算术构造它们（双精度或双精度并为每个位加 1），对于位，它只提供适当的加密位。

我们可以在我们的设计中混合和匹配布尔值和整数值，通过评估 cond * then + (1 - cond) * else 获得 if/then/else（需要评估两个分支 SIMD 样式），使用 1 为真，0 为假在条件下，因此您可以使用环的内置算术来使您的电路更浅。

另一方面，我们也可能已经对一些数据进行了预加密，但是由于您必须不断回收相同的密钥集才能使用它，因此要正确处理这件事变得非常棘手。

所以，现在我们有了服务器提供的数据。现在，加密您不希望服务器知道的内容，例如您正在搜索的内容，并让他们在正确的点将其馈送到电路中，例如作为地图功能的额外输入。

我们应该能够在每个输入上映射一个任意的类似 NC1 的电路，以提取一个字段，将一些值相乘，然后通常将其映射成一种可以廉价减少的形式。

然后使用更小的电路减少这些片段，例如对于具有良好大小限制结果的简单幺半群。（即，您映射以获得指示您是否找到匹配的位，然后通过使用小型加法器电路计算这些位来减少）

由于您只需要在逻辑上构建电路并在同态环中的这些加密位上模拟其执行，因此您可能可以使用小型 DSL 相对快速地实现它，例如 Haskell 中的 Lava，假设您直接获得了同态加密片段。

另外，请记住，每个门的执行成本都*非常高。*

所以，总结一下，

1.  为服务器提供加密的 1 和 0 以及任何用于 map 和 reduce 函数的加密元信息。
2.  对于每个数据点，将其编码到同态环中，为您的地图电路提供输入和元信息，以获得适合归约的值。
3.  在平衡二叉树（或其他平衡排列以最小化树高）中，将归约操作应用于电路的输出和任何加密的映射元信息。
4.  将结果交给客户端解密

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-25T19:45:42.053

现有同态加密算法的问题是你只能用它执行一个多对数 (NC1) 电路，这几乎排除了任何有趣的算法。

另外，编码的复杂性似乎并没有低于自己执行多对数电路的复杂性，所以你乍一看还没有得到任何免费的工作，除非你用它做一些特别棘手的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-04T07:33:01.900

SETI@Home、蛋白质折叠项目等分布式计算非常受欢迎，因为它们利用了数千名用户捐赠的 CPU 时间和电力。更有趣的是一种模式，人们可以通过为商业项目提供这些资源而获得报酬。但是，没有一家负责任的公司愿意将其数据发送到数千台匿名计算机进行处理。如果您可以有效地将算法应用于加密数据，则可以将处理委托给没有受信任关系的任何人。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-27T14:36:11.847

电子投票确实是同态加密的一个实际应用，即[http://heliosvoting.org/](http://heliosvoting.org/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-07-06T07:38:21.113

在同态加密的帮助下，一些银行应用程序可能会变得更快。

他们可以在云上使用加密数据执行操作，而不是将其从云传输到本地再放到云上。也不需要加密-解密-执行操作-加密管道，加密-执行操作就可以了。

# delphi - 您如何使用图形文件对 Delphi 组件进行皮肤处理？

> ID：1023984
> 
> 赞同：2
> 
> 时间：2009-06-21T14:08:18.403
> 
> 标签：delphi, components, skinning

就像在 Web 应用程序中使用 CSS 一样，我们是否可以在不处理`TCanvas`或开发新组件的情况下使用从剪贴画到皮肤按钮、编辑和表单组件的图形？是否有任何**完全免费**的库可以与现有组件一起使用？（**没有**第 3 方 TSkinnedEdit 等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T00:43:45.653

一个**完全免费的图书馆**——我不知道。但我强烈推荐 VCL Skin ( [http://www.link-rank.com](http://www.link-rank.com) )。那里有一个皮肤生成器工具——当与 VCL 皮肤组件一起使用时——可以使用图形图像来为各种控件设置皮肤。VCL Skin 的一个非常好的地方是它可以与现有的 Delphi 组件和许多第 3 方组件一起使用，并且无需修改组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T16:22:34.157

您必须更改大多数组件的默认绘图。所以，AFAIK，你必须处理 TCanvas 来改变控件的绘制方式......对于表单，你可以使用 TImage 来覆盖它。

因此，使用支持皮肤的套件比使用默认组件更容易。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-25T05:07:01.643

Delphi 有一个免费的皮肤库：[SpTBXLib](http://www.silverpointdevelopment.com/sptbxlib/index.htm)。它适用于 TB2K 和其他 Delphi 标准组件。对我来说，没有什么能比得上 DevExpress 皮肤库。我是 VCLSkin 的注册用户，但一旦我获得 DevExpress 的 VCL 订阅，我就再也没有回头。

# c# - 请推荐一个Mono（即C#）音频阅读库

> ID：1023988
> 
> 赞同：0
> 
> 时间：2009-06-21T14:10:07.667
> 
> 标签：c#, .net, audio, mono

我正在尝试编写一个在频域中显示音频文件内容的小应用程序。我正在寻找一个兼容 Mono 的库，它可以读取音频文件并以物理上有意义的方式为我提供内容。任何人都可以提出任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T09:54:19.553

从对我[半年前提出的](https://stackoverflow.com/questions/35896/how-can-i-play-compressed-sound-files-in-c-in-a-portable-way)问题的回答来看，目前除了对某些二进制库的 DllImport 调用之外别无他法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-22T13:41:25.773

我建议也许看看[Banshee 源代码](http://banshee-project.org/download/)。

您可能知道，Banshee 是一个在 Mono 上运行的 Linux 开源媒体库和播放器。有可能你可以在其中使用一些源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-10T00:44:45.190

Banshee 使用 gtkstreamer 库，有一个名为 gtkstreamer 的单声道实现#

这可能会有所帮助：

[如何使用 monodevelop/xamarin 构建 gstreamer-sharp？](https://stackoverflow.com/questions/21577733/how-to-build-gstreamer-sharp-with-monodevelop-xamarin)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-02T13:06:01.173

您还可以在 MacOS X 上使用包含 CoreAudio 绑定的 MonoMac 绑定。

# c# - 如何通过单击选择行 om gridview？

> ID：1023990
> 
> 赞同：0
> 
> 时间：2009-06-21T14:11:26.183
> 
> 标签：c#, asp.net, gridview

如何通过单击在 gridview 中选择行。但我想在会话中添加选择 ID（来自数据库，例如主 ID）。请听我不想要 javascript 属性方法。像那样

```
session["selectedrow"] = gridview1.selectedrow[" which id? "] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-24T15:24:58.393

像这样设置数据键：

```
grdTestData.DataSource = GetDataTable();
grdTestData.DataKeyNames = new string[] { "Dataset_ID" };
grdTestData.DataBind(); 
```

获取密钥（从命令按钮）：

```
int iRow = Convert.ToInt32(e.CommandArgument);
Session["key"] = grdTestData.DataKeys[iRow] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T14:38:05.270

```
Session["selectedrow"]= gridview1.SelectedDataKey.Value(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T14:03:58.237

```
 protected void Unnamed1_SelectedIndexChanged(object sender, EventArgs e)
    {
        Session["key"] = ((GridView)sender).SelectedDataKey.Value;
    }

   <asp:GridView ID="Unnamed1" runat="server" 
                onselectedindexchanged="Unnamed1_SelectedIndexChanged" ></asp:GridView> 
```

未经测试，但我不明白为什么这不起作用。

# wpf - 显示更多 GUI 的 MVVM 和命令

> ID：1023995
> 
> 赞同：6
> 
> 时间：2009-06-21T14:14:22.387
> 
> 标签：wpf, mvvm

我喜欢 ViewModel 公开的[RelayCommand](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)的 MVVM 理念。对于无需进一步用户输入即可完成的操作，这很好而且很优雅。简单的。可测试。

但是，并非所有操作都是无 UI 的。有些需要确认（“您确定要删除吗？”）。其他人还需要更多信息。打开文件可能需要从文件打开对话框到成熟的导入向导中的任何内容。

在 MVVM 应用程序中，编写需要用户输入的命令的最佳方式是什么？是否有一种通过依赖注入来解决这个问题的既定模式？我应该在代码隐藏中编写一个 KeyDown 处理程序，并让它显式执行事件吗？我应该退回到 RoutedUICommand，并将所有“显示下一个 GUI”代码放在我的视图中吗？或者有什么明显的东西我完全错过了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-21T14:23:46.483

我通常使用依赖注入来注入某种抽象的 IShowTheInterface 东西，然后从 Command 中调用抽象上的方法。然后，这些方法应该为您提供确定是否继续执行该操作以及用户提供了什么输入所需的答案。

[我最近在一篇有一点不同主题](http://blog.ploeh.dk/2009/06/05/TestabilityIsReallyTheOpenClosedPrinciple.aspx)的博客文章中使用了这个作为示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T19:48:42.690

这种东西（确认对话框、文件打开对话框等）通常在应用程序之间共享。所以我的偏好是根本不把它们放在 ViewModel 中。

ViewModel 是特定于应用程序的，无限期地扩展 ViewModelBase 并不是一个好主意。相反，创建可重用的行为来扩展视图。[Expression Blend Gallery](http://gallery.expression.microsoft.com/en-us/site/items/behaviors)中有很多行为示例

编辑：

行为可以具有属性，您不仅可以使用这些属性指定行为特征，还可以获取一些反馈：

```
<Button Content="Open Document">
    <i:Interaction.Behaviors>
        <local:FileOpenBehavior 
            FileNameTarget="{Binding ElementName=tbDocName}"/>
    </i:Interaction.Behaviors>
</Button> 
```

在上面的示例中，可以隐藏 tbDocName - 或者您可以绑定到 ModelView 的属性。