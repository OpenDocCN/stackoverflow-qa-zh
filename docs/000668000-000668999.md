# StackOverflow 问答 000668000-000668999

# php - 是否可以从 GMail 的收件箱中获取所有电子邮件？

> ID：668005
> 
> 赞同：1
> 
> 时间：2009-03-20T21:06:32.867
> 
> 标签：php, email, curl, gmail

是否可以从您的 GMail 收件箱中获取我所有的电子邮件，而不仅仅是未读的电子邮件？我当前的 PHP 脚本只会收到未读的电子邮件，但我想要整个收件箱。

我正在使用 PHP 和 CURL。首先，是否有可能做到这一点？

如果是这样，有人可以给我一些关于如何实现这一目标的提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T21:08:59.477

使用 IMAP API。

请参阅：[通过 python 或 php 从 gmail 获取附件](https://stackoverflow.com/questions/312284/fetching-attachments-from-gmail-via-either-python-or-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T20:45:28.117

您还可以查看 ryan grove 的落叶松项目：

[http://wonko.com/post/larch-syncs-messages-from-one-imap-server-to-another](http://wonko.com/post/larch-syncs-messages-from-one-imap-server-to-another)

它用于同步 imap 帐户，但会让您了解如何将 imap 与 ruby​​ 一起使用。（其他语言类似。）

# jquery - ajax 结果中的登录屏幕 - Asp.net Mvc

> ID：668011
> 
> 赞同：5
> 
> 时间：2009-03-20T21:09:25.497
> 
> 标签：jquery, asp.net-mvc

当您使用 asp.net 会员资格并且您在控制器/操作上有 [Authorize] 标记时，有时当您从喝咖啡/散步回来时，您已退出该站点。当您单击调用 Ajax 调用的按钮或链接时，返回的 html 不是您请求的内容，而是登录屏幕，然后将呈现在页面的某个位置（如果您使用*$("placeholder").html(result)*） .

无论如何在 jQuery 中检测到这一点？由于它是合法的 html，因此您不会收到错误消息，但这不是您希望发生的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T21:30:16.070

您可以做的一件事是客户端会话超时检测。设置一个计时器，该计时器将在您的实际会话到期前不久到期。让计时器弹出一个对话框，指示会话即将到期并让用户有机会更新它（发回 AJAX 请求以刷新会话计时器）。在对话中设置另一个计时器，该计时器将在实际会话剩余时间用完之前到期。如果此计时器触发，则将页面的 href 重置为注销 url 并将用户注销。显然，计时器需要通过页面上的用户活动来重置——ajax 请求等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-21T10:21:53.470

tvanfosson 的客户端会话超时方法效果很好，实际上——午餐后我返回的几个站点给我留下了深刻的印象，发现它们已经自动重定向回登录页面。

另一种方法可能如下：

你向（比如说）/Account/Details 发送了一个 Ajax 请求，但是你的登录 cookie 已经过期，所以你不能看到它；控制器返回 /Security/Login 。

如果您的控制器返回登录视图而不是请求的页面，您是否考虑将响应代码设置为**[401 Not authorized](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2)**而不是**200 OK**？

然后您需要修改您的 Ajax 回调以检查 Ajax 响应的状态代码，如果它是 401 未授权，您可以做出相应的响应 - 重定向到登录页面，显示一个弹出登录框，或者只是一个错误消息说“对不起，您需要重新登录”

# php - PEAR::DB 错误，未找到扩展

> ID：668022
> 
> 赞同：3
> 
> 时间：2009-03-20T21:13:57.653
> 
> 标签：php, mysql, pear

我正在尝试在我们的网络服务器上安装 phpBugTracker。当我尝试在安装屏幕上测试数据库连接时，我收到一个错误屏幕，显示“DB Test Failure... DB Error: extension not found”。错误是从以下函数引发的：

```
function test_database(&$params, $testonly = false) {
    // PEAR::DB
    define('PEAR_PATH', ''); // Set this to '/some/path/' to not use system-wide PEAR
    // define('PEAR_PATH', 'inc/pear/'); // use a locally installed Pear (phpBT v0.9.1)
    if (!@include_once(PEAR_PATH.'DB.php')) {
        $error_message = translate("Failed loading Pear:DB");
        $error_info = translate("Please check your Pear installation and the defined PEAR_PATH in install.php");
        $error_info .= " <a href='http://pear.php.net/'>http://pear.php.net/</a>";
        include('templates/default/install-dbfailure.html');
        exit;
    }
    // execution gets this far without a problem...
    $dsn = array(
        'phptype' => $params['db_type'],
        'hostspec' => $params['db_host'],
        'database'  => $params['db_database'],
        'username'  => $params['db_user'],
        'password'  => $params['db_pass']
        );
    $db = DB::Connect($dsn);

    // Simple error checking on returned DB object to check connection to db
    if (DB::isError($db)) {
       // $db go boom...
        $error_message = isset($db->message) ? $db->message : '';
        $error_info = isset($db->user_info) ? $db->user_info : '';
        include('templates/default/install-dbfailure.html');
        exit;
    } else {
        if ($testonly) {
            include('templates/default/install-dbsuccess.html');
            exit;
        } else {
            return $db;
        }
    }
} 
```

我使用的是 MySQL 5.0.45 版、PHP 4.47 版，并且我有 PEAR::DB 1.7.6 版稳定版。我已经验证我可以使用我创建的登录名连接到我正在使用的数据库。至于安装了哪些模块，我完全受制于托管公司。

关于可能导致错误的任何想法？

**编辑：** *db_type*设置为“mysqli”。当我使用“mysql”作为类型时，我得到一个“连接失败”错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-18T20:40:14.600

好吧，我觉得很傻，但是在这个特定的服务器上 MySQL 的路径是不同的，我只是假设 localhost。这与 mysql 与 mysqli 无关。固定路径，它连接得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T21:24:21.170

使用 phpinfo() 验证`db_type`您正在使用的扩展是否已安装并激活。也许您正在尝试使用“ **mysqli** ” `db_type`，而您应该使用“ **mysql** ” **（不带“i”）**？

MySQL **i**默认情况下不附带 PHP4。

# c# - 是否可以使用 Linq to SQL 运行任意查询？（C＃）

> ID：668024
> 
> 赞同：2
> 
> 时间：2009-03-20T21:14:14.547
> 
> 标签：c#, .net, linq-to-sql

我将如何使用 Linq to SQL 编写以下查询？

```
UPDATE [TB_EXAMPLE] SET [COLUMN1] = 1 
```

（我的实际目标比这更复杂）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T21:29:30.893

DataContext 类有两个查询方法，ExecuteCommand 和 ExecuteQuery。

ExecuteQuery 方法返回 LINQ to SQL Entities，因此您需要将类型传递给它：

```
[VB.Net]
MyDataContext.ExecuteQuery(Of Product)("SELECT * FROM PRODUCTS")

[C#]
MyDataContext.ExecuteQuery<Product>("SELECT * FROM PRODUCTS"); 
```

但是，ExecuteCommand 不需要类型，您可以将此方法用于您的 UPDATE 查询 因为您只需要一个 String 来编写查询，您可以使用反射为您的 DAL 创建一个真正通用的 UPDATE 方法。

```
MyDataContext.ExecuteCommand("UPDATE Products WHERE ProductID = {0}",1) 
```

或者

```
MyDataContext.ExecuteCommand("UPDATE Products WHERE ProductID = 1") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T21:19:26.097

是的。[DataContext](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)有一个[ExecuteCommand](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executecommand.aspx)方法，允许您执行任意（希望是参数化的）SQL。

引用上面 DataContext 链接上的评论：

> 此方法是一种直通机制，适用于 LINQ to SQL 无法充分提供特定场景的情况。
> 
> 该命令的语法与用于创建 ADO.NET DataCommand 的语法几乎相同。唯一的区别在于如何指定参数。具体来说，您可以通过将参数括在大括号 ({…}) 中来指定参数并从 0 开始枚举它们。参数与参数数组中相同编号的对象相关联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T21:17:55.100

```
foreach(var TB_EXAMPLE ex dbDataContext.TB_EXAMPLES)
{
   ex.COLUMN1 = 1;
}

dbDataContext.SubmitChanges(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T21:19:05.287

假设一个 DataContext 连接，您可以使用 DataContext 对象的 ExecuteCommand 方法来执行不返回对象的 SQL 命令。

[http://msdn.microsoft.com/en-us/library/bb386906.aspx](http://msdn.microsoft.com/en-us/library/bb386906.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T21:20:15.533

```
var row = (from t in dataContext.table
            where t.id==1
            select t).Single();
row.columnName = 1;
dataContext.SubmitChanges(); 
```

edt，哎呀慢了；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T21:18:51.667

您可以直接更新对象，然后调用保存更改。

```
using (var ctx = new MyDataContext())
{
  var customer = ctx.Customers.First();
  customer.Name = "New Name";
  ctx.SaveChanges();
} 
```

如果您正在寻找执行此操作的实际 SQL 命令，那么 Scott Guthrie 在[http://weblogs.asp.net/scottgu/archive/2007/08/27/linq有一篇很棒的帖子演示了如何使用 ExecuteQuery 和 ExecuteCommand 方法-to-sql-part-8-executing-custom-sql-expressions.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/27/linq-to-sql-part-8-executing-custom-sql-expressions.aspx)

# php - 如何获取PDF中某个点的X，Y坐标

> ID：668031
> 
> 赞同：3
> 
> 时间：2009-03-20T21:17:10.173
> 
> 标签：php, pdf

我有一个 PDF 模板文件。它有一堆我需要使用 PHP 编写的字段。如何轻松确定文件中字段的 xy 坐标？现在我正在使用 xy 位置，但反复试验非常耗时。有一个更好的方法吗？甚至是获取pdf文件中某个点的xy坐标的简单方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-04-07T13:54:47.657

按照我的喜好顺序：

**Mac** : *Skim* - 选择一个文本框。查看右下角的 X、Y 以及框的高度和宽度。

*预览*（包含在 OSX 中），选择一个文本框：工具 -> 显示检查器 -> 选择有一个小标尺图标的第 4 个选项卡。这给出了坐标，但具有左上角的原点（网络标准原点，但不是 pdf 约定）

**Linux 和 Unix**：不知道，但试试... *GSView* *xpdf* *evince* *gnome-gv*

**Windows** : *GSView*现在是我的最爱：快速、方便的永远在线坐标显示，免费

*Foxit Reader*，免费阅读坐标（见“属性”框），如果你想保存文件修订版，100 美元。

*Foxit Phantom*（130 美元）不显示坐标。

*PDF-Xchange*也可以免费进行，但 Y 原点是左上角，而不是左下角，因此您必须从页面高度中减去每个 Y。并且必须通过读取边缘刻度来解释坐标，这很难准确地做到。

*Adobe Acrobat* - 我提交的销售和技术支持票说 700 美元的阅读器会做到这一点。我没有检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T01:40:01.820

您问题的填表部分似乎与[此问题有关](https://stackoverflow.com/questions/77873/filling-pdf-forms-with-php/112712#112712)。至于坐标，我对 PHP 无能为力，但我有一个很好的 Perl 解决方案。这里有[两个](https://stackoverflow.com/questions/620470/how-can-i-get-the-width-and-height-of-a-text-string-with-campdf) [关于](https://stackoverflow.com/questions/196788/how-do-i-get-character-offset-information-from-a-pdf-document/203553#203553)计算文本 X,Y 坐标的问题。CAM::PDF 有一个[fillformfields.pl](http://search.cpan.org/dist/CAM-PDF/bin/fillpdffields.pl)实用程序可以提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-30T11:31:57.617

我想迟到总比不回答要好：

Foxit PDF Editor (now incorporated into Foxit PhantomPDF Standard or Business) will display the coordinates of any object in a PDF file. The only problem you have to go through every object individually - manually click on the object and read off the coordinates. I haven't found an automatic way to extract the coordinates and pipe them into a PHP script.

# ruby - 这种串联的操作顺序是什么？

> ID：668032
> 
> 赞同：2
> 
> 时间：2009-03-20T21:17:39.673
> 
> 标签：ruby, string, symbols, operator-precedence

```
x = "hello" " world".to_sym
puts x.class 
```

这有效，并允许我将两个字符串连接成一个符号，产生输出：

```
Symbol 
```

但是，如果我稍微更改它以使用 + 而不是分隔 hello 和 world 字符串的空格，我会收到一个错误：

```
x = "hello" + " world".to_sym
puts x.class 
```

这会产生以下错误 - 我认为这是因为它试图将“world”.to_sym 回调“投射”回一个字符串，然后再将其连接到“hello”字符串上：

```
in `+': can't convert Symbol into String (TypeError) 
```

我想知道**是什么让第一个示例有效**？有谁知道这里的操作顺序是什么？我怀疑这两个字符串实际上被视为一个字符串，它们之间的空格被忽略了，并且在调用 to_sym 方法之前将它们连接起来。实际上，我本来希望它的工作方式与第二个示例没有什么不同，因为我认为在尝试加入“hello”和“world”的内容之前，会在“world”字符串上调用 to_sym。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T21:31:50.513

第一个例子是语法糖，通常你会看到这样写：

```
x = "Here is a string that " \
    "I want to split across " \
    "several lines..." 
```

所以这首先发生，在 之前`to_sym`。在第二个示例中，您实际上是在调用：

```
x = "hello".+( "world".to_sym ) 
```

这显然是行不通的，因为`String#+`不能用符号作为参数做任何有用的事情。

简而言之，不要做第一个，如果你想做`"hello world".to_sym`并且你不能因为任何原因就这样写，那么只需使用括号：`("hello" + " world").to_sym`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T21:35:39.537

两个或多个并排放置的字符串**文字**立即被视为单个字符串文字。当 Ruby 解释器将您的代码转换为标记时，它会将

```
"hello" " world" 
```

到单个令牌`string "hello world"`，它转换

```
"hello" + " world" 
```

到三个标记：`string "hello"`、`method +`和`string " world"`。然后在实际执行代码时将字符串连接在一起。

# iphone - 这是对 Objective-C 指针的有效使用吗？

> ID：668034
> 
> 赞同：6
> 
> 时间：2009-03-20T21:18:31.357
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

这是一个初学者级别的问题，我很好奇这是否是在语句中有效使用指针，例如：

```
 NSMutableDictionary *foo = [bar mutableCopy]; 
```

当它有效与我需要执行以下操作时，我感到困惑：

```
NSMutableDictionary *foo = [[NSMutableDictionary alloc] initWithCapacity:0];
foo = [bar mutableCopy];
// use foo
[foo release]; 
```

两者都有效吗？什么时候使用一个而不是另一个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T00:16:02.223

猜测您可能会感到困惑的原因，我想解释一下第二个代码示例的实际作用（以及为什么没有必要）。

```
NSMutableDictionary *foo = [[NSMutableDictionary alloc] initWithCapacity:0]; 
```

我认为您对这条线感到困惑，因为这条线通常被描述为“初始化 foo”。这有点误导。从技术上讲，这里更改了 2 个不同的实体——`NSMutableDictionary`创建了新对象，并为“foo”变量分配了它的地址。

该行实际上`NSMutableDictionary`在堆（您的应用程序的动态内存区域）上创建了一个新对象。我将其称为“字典 1”。这样可以在堆上找到这个新的“字典1”对象，它的内存地址存储在“foo”中。“foo”的作用是充当索引，所以我们可以找到“Dictionary 1”。

虽然我们经常说：“foo 是一本字典”，但那是因为我们很懒——这种说法在技术上是错误的。正确：“堆上有一个字典， foo 存储它的内存地址，以便我们可以找到它并使用它”。

然后当您运行该行时：

```
foo = [bar mutableCopy]; 
```

您正在使用“bar”中的地址在堆中查找不同的对象（我将其称为“字典 2”），并在堆上创建另一个具有相同值的对象（“字典 3”）。如果您继续计数，那么现在存在 3 个对象。

“字典 3”制作完成后，其内存地址将存储在“foo”变量中。这种存储到“foo”中会覆盖现有的内存地址（指向“Dictionary 1”的那个）。这意味着我们没有剩余的指向“字典 1”的指针，因此将永远无法再次找到它。这就是为什么我们说“字典1”已经泄露。

我希望您能从这种情况中看出为什么永远不需要“字典 1”（您只打算使用“foo”来访问副本“字典 3”）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T21:37:18.363

您永远不需要在第二个示例中编写代码。除了`[[NSMutableDictionary alloc] initWithCapacity:0]`泄漏内存之外什么都不做。

在第二个示例中，您创建一个 NSMutableDictionary 并将其分配给`foo`. 然后在下一行中，将另一个 NSMutableDictionary 的副本分配给`foo`，这意味着`foo`指向的原始字典现在只是漂浮在堆上的某个位置，永远无法释放。

`foo`但是，正如[Objective-C 内存管理指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/index.html)中所述，无论哪种情况，您都需要释放。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T21:21:10.287

第一个是正确的，第二个泄漏内存，因为您分配了两次（复制计为一个）并且只释放一次。

完成后不要忘记释放 foo

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T21:39:43.537

赋值操作会覆盖该变量持有的先前值。例如：

```
x = 3
x = 4 
```

x 在第二行开头保存的值是 3，但在这行代码执行后，它是 4。 语法：

```
int x = 0; 
```

真的只是这个的简写：

```
int x;
x = 0; 
```

作为指针的变量也不例外。因此，如果变量的第一个引用只是简单地分配给它，您不需要首先初始化它，因为您初始化它的任何值都将被丢弃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T06:57:41.573

第一个是正确的方法。copy 和 alloc 都会为你的变量分配内存。因此，使用第二个选项会将变量的保留计数增加到 2。

# datetime - 这是什么日期时间格式？

> ID：668048
> 
> 赞同：6
> 
> 时间：2009-03-20T21:20:23.363
> 
> 标签：datetime, format

我有一个旧数据格式的 DateTime 结构，我无权访问它的任何规范。有一个字段指示数据的日期时间，但它不是我认识的任何格式。它似乎存储为一个 32 位整数，每天递增 20。有没有人遇到过这样的事情？

编辑：

示例：1088631936 DEC = 80 34 E3 40 00 00 00 00 HEX = 09/07/2007

编辑：

首先，抱歉耽搁了。我曾希望在周末做一些事情，但无法做到。

其次，这种日期格式比我最初想象的要奇怪。它似乎是某种指数或对数方法，因为日期不会以增加的速度变化。

第三，我用于解释这些值的已失效应用程序仅显示日期部分，所以我不知道时间部分是什么。

示例数据：（十六进制值是大端，日期是 mm/dd/yyyy）

0x40000000之后= 01/01/1900
0x40010000 = 01/01/1900
0x40020000 = 01/01/1900
0x40030000 = 01/01/1900
0x40040000 = 01/01/1900
0x40050000 = 01/01/1900
0x40060000 = 01/01/1900
0x40070000 = 01/01/1900
0x40080000 = 1900年1月2日
0x40090000 = 1900年1月2日
0x400A0000 = 1900年1月2日0x400B0000 = 1900年1月2日0x400C0000 = 1900年1月2日
0x400D0000 = 1900年1月2 日
0x400E0000 = 01/02/1900 0x400F0000 = 01/02/1900 0x40100000 = 01/03/1900 0x40110000 = 01/03/1900 0x40120000 = 01/01/03/1900 03/1900 0x40130000013000003/03/03/03/1403/140403/140403/140403 / 140404040404040404040X4040X4040X4040X4040X4040X4040X4040X4040X4040X4040X4040X4040X4000转/04/1900 0x40160000 = 01/04/1900

0x40170000 =
1900年1月
4日0x40180000
= 1900年1月5日
0x40190000 = 1900年1月5日0x401A0000 = 1900年1月5日0x401B0000 = 1900年1月5日0x401C0000 = 1900年1月6日
0x401D0000 = 1900
年1月6日
0x401E0000 = 01/06/1900
0x401F0000 = 01/06/1900
0x40200000 = 01/07/1900
0x40210000 = 01/07/1900
0x40220000 = 01/08/1900 = 0x40230000 =
01/08/10000
....
01/08/10000 /1901
0x40810000 = 06/27/1901
0x40820000 = 07/29/1901
....
0x40D00000 = 11/08/1944
0x40D10000 = 08/29/1947

编辑：我终于想通了，但由于我已经放弃了赏金积分，我将推迟解决方案，以防有人想试一试。

顺便说一句，这没有时间组件，它纯粹是为了存储日期。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T05:33:53.330

它不是整数，它是一个 32 位浮点数。我还没有完全确定格式，它不是 IEEE。

编辑：明白了。1 位符号，11 位指数，偏移量为 0x3ff，20 位尾数，隐含位在左侧。在 C 中，仅假设正数：

```
double offset = pow(2, (i >> 20) - 0x3ff) * (((i & 0xfffff) + 0x100000) / (double) 0x100000); 
```

这会产生 0x40000000 = 2.0，因此开始日期必须是 1899 年 12 月 30 日。

**再次编辑：**既然你很友善地接受了我的回答，而且你似乎担心速度，我想我会稍微改进一下。您不需要实数的小数部分，因此我们可以仅使用按位运算将其直接转换为整数。这次在 Python 中完成测试结果。为了更好的可读性，我包含了一些中间值。除了没有负数的限制之外，这个版本在指数超过 19 时可能会出现问题，但这应该让你在 3335 年之前保持良好状态。

```
>>> def IntFromReal32(i):
        exponent = (i >> 20) - 0x3ff
        mantissa = (i & 0xfffff) + 0x100000
        return mantissa >> (20 - exponent)

>>> testdata = range(0x40000000,0x40240000,0x10000) + range(0x40800000,0x40830000,0x10000) + [1088631936]
>>> from datetime import date,timedelta
>>> for i in testdata:
        print "0x%08x" % i, date(1899,12,30) + timedelta(IntFromReal32(i))

0x40000000 1900-01-01
0x40010000 1900-01-01
0x40020000 1900-01-01
0x40030000 1900-01-01
0x40040000 1900-01-01
0x40050000 1900-01-01
0x40060000 1900-01-01
0x40070000 1900-01-01
0x40080000 1900-01-02
0x40090000 1900-01-02
0x400a0000 1900-01-02
0x400b0000 1900-01-02
0x400c0000 1900-01-02
0x400d0000 1900-01-02
0x400e0000 1900-01-02
0x400f0000 1900-01-02
0x40100000 1900-01-03
0x40110000 1900-01-03
0x40120000 1900-01-03
0x40130000 1900-01-03
0x40140000 1900-01-04
0x40150000 1900-01-04
0x40160000 1900-01-04
0x40170000 1900-01-04
0x40180000 1900-01-05
0x40190000 1900-01-05
0x401a0000 1900-01-05
0x401b0000 1900-01-05
0x401c0000 1900-01-06
0x401d0000 1900-01-06
0x401e0000 1900-01-06
0x401f0000 1900-01-06
0x40200000 1900-01-07
0x40210000 1900-01-07
0x40220000 1900-01-08
0x40230000 1900-01-08
0x40800000 1901-05-26
0x40810000 1901-06-27
0x40820000 1901-07-29
0x40e33480 2007-09-07 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T06:03:51.437

您确定这些值对应于 2007 年 9 月 7 日吗？

我问是因为 1088631936 是自 Linux（等）零日期以来的秒数：01/01/1970 00:00:00 到 06/30/2004 21:45:36。

在我看来，自这个通常的零日期以来，该值是秒数，这似乎是合理的。

编辑：我知道这很可能不是正确的答案。这只是一种方法（一种有效的方法），但我认为需要更多信息（见评论）。编辑这个（再次）将问题带到前面，希望其他人回答它或给出想法。我：具有公平、运动和分享的精神：D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T19:01:13.283

我会说 vmarquez 很接近。

以下是日期 2009-3-21 和 2009-3-22 作为 unix epochtime：

```
In [8]: time.strftime("%s", (2009, 3, 21, 1, 1, 0, 0,0,0))
Out[8]: '1237590060'

In [9]: time.strftime("%s", (2009, 3, 22, 1, 1, 0, 0,0,0))
Out[9]: '1237676460' 
```

在这里它们是十六进制的：

```
In [10]: print("%0x %0x" % (1237590060, 1237676460))
49c4202c 49c571ac 
```

如果您只取前 5 位数字，则增长为 21。哪种格式符合您的格式，是否？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T16:40:06.063

一些上下文会很有用。如果您的数据文件在字面上或至少在比喻上看起来像这个文件，那么 vmarquez 就赚钱了。

[](http://www.slac.stanford.edu/comp/net/bandwidth-tests/eventanalysis/all_100days_sep04/node1.niit.pk)[http://www.slac.stanford.edu/comp/net/bandwidth-tests/eventanalysis/all_100days_sep04/node1.niit.pk](http://www.slac.stanford.edu/comp/net/bandwidth-tests/eventanalysis/all_100days_sep04/node1.niit.pk)

该引用是由可用带宽估计工具 (ABwE) 生成的数据——奇怪的是它实际上包含 1088631936 值以及上下文。那个例子

```
 date     time       abw     xtr   dbcap   avabw   avxtr  avdbcap      rtt    timestamp
06/30/04 14:43:48  1.000   0.000   1.100   1.042   0.003    1.095  384.387   1088631828
06/30/04 14:45:36  1.100   0.000   1.100   1.051   0.003    1.096  376.408   1088631936
06/30/04 14:47:23  1.000   0.000   1.100   1.043   0.003    1.097  375.196   1088632043 
```

似乎与建议的 21:45:36 时间值有 7 小时的偏移。（可能是斯坦福本地的，在夏令时运行。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T04:59:47.250

好吧，您只向我们展示了您的程序如何使用 8 位数字中的 2 位，所以我们必须假设其他 6 位被忽略（因为您的程序可以使用其他数字做任何它想做的事情）。

因此，我们可以说输入格式是：40mn0000，其中 m 和 n 是两个十六进制数字。

然后，输出为： **01/01/1900 + floor((2^(m+1)-2) + n*2^(m-3)) 天**

解释：

1.  在每个示例中，请注意将 n 增加 1 会使天数增加 2^(m-3)。
2.  请注意，每次 n 从 F 变为 0 时，m 都会递增。

使用这两个规则，并玩弄数字，你会得到上面的等式。（除了由于输出不显示小数天数而添加的 floor）。

我想您可以通过将两个单独的十六进制变量 m 和 n 替换为单个 2 位十六进制数 H 来重写此代码。但是，我认为这会使等式变得更加丑陋。

# delphi - Delphi Adding Items to ComboBox Speed

> ID：668054
> 
> 赞同：8
> 
> 时间：2009-03-20T21:23:13.107
> 
> 标签：delphi, combobox, performance

I have a fairly complex and large application that hands loads and loads of data. Is there a speedy way to add items to ComboBox that doesn't take so long? On my P3 3.2ghz, the following snippet takes just under a second to add around 32,000 items. (MasterCIList is a StringList with strings typically 20 - 30 bytes long).

```
with LookupComboBox do
 begin
  Items.BeginUpdate;
  Items.Clear;
  for i := 0 to MasterCIList.Count - 1 do
   Items.Add(MasterCIList[i]);
  Items.EndUpdate;
 end; 
```

Drilling down into the VCL, it appears that in `TComboBoxStrings.Add`, there is a call to

```
Result := SendMessage(ComboBox.Handle, CB_ADDSTRING, 0, Longint(PChar(S))); 
```

I'm guessing this is really taking up time (okay, I know it is). Is there another way to populate the Items that is speedier? Any high-speed combo boxes available? I have the TMS components but they seem to be extensions of TComboBox.

For instance, I have the PlusMemo which seems to be a total rewrite of a TMemo. I can easily add a million line in a second to a PlusMemo. A TMemo, I don't think so.

Thank you so much for your time!

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-20T21:35:09.100

对不起，如果我很讨厌，但我怀疑一个包含 32,000 个项目的 TComboBox 甚至远程“可用”——我想说它速度慢是有原因的：它从来没有打算这样做:)

是否有可能过滤数据，只加载一个子集？更具体地说，在我一直在研究的一个特定数据库应用程序中，用户可以搜索一个人。我们让用户输入至少 3 或 4 个字符的名称，然后才开始在列表框中返回结果。这大大提高了搜索表单的可用性，也大大加快了整个过程。

你能遵循类似的方法吗？

或者，以完全不同的方式，也许您可​​以看一下[VirtualTreeView](https://github.com/Virtual-TreeView/Virtual-TreeView)组件 --- 直接使用或获得灵感。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T01:29:15.170

我同意组合框中的 32K 项目是一个荒谬的数量......话虽如此，您可以尝试先将项目添加到 TStringList，然后使用 Begin/EndUpdate 和 AddStrings 的组合：

```
SL := TStringList.Create;
try
  // Add your items to the stringlist
  ComboBox.Items.BeginUpdate;
  try
    ComboBox.Items.AddStrings(YourStringList);
  finally
    ComboBox.Items.EndUpdate;
  end;
finally
  SL.Free;
end; 
```

代码可以编译，但我没有进一步测试它；我从来没有觉得需要向组合框或列表框添加几十个项目。如果可能需要更多的项目，我会在填充列表之前找到一种过滤方法，这样项目就会更少。

只是出于好奇，您希望用户如何对这么多项目进行分类来做出决定？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-07T00:01:29.663

```
var
  Buffer: TStringList;
begin
  Buffer := TStringList.Create;

  try
    // --> Add items to Buffer here <--

    ComboBox.Items := Buffer;
  finally
    FreeAndNil(Buffer);
  end;
end; 
```

这是我们发现更新视觉控件的最快方法。

VCL 在内部执行 BeginUpdate、Clear 和 EndUpdate。

如果您不相信我，请简要介绍一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T08:11:47.860

use [backgroundworker](http://www.delphiarea.com/products/delphi-components/backgroundworker/) for adding MasterCIList items.after complete adding items use only AddStrings.

```
procedure TForm2.BackgroundWorker1Work(Worker: TBackgroundWorker);
var
  I: Integer;
begin
  MasterCIList.BeginUpdate;
  try
    MasterCIList.Capacity := 32 * 1024; // if derminate  count of items
    for I := 1 to 32 * 1024 do
    begin
      MasterCIList.Add(IntToStr(I));
      { if need progess }
      if I mod 300 = 0 then
        Worker.ReportProgress((I * 100) div MasterCIList.Capacity);
      { if need cancelable }
      if (I mod 100 = 0) and Worker.CancellationPending then
        Break;

    end;

  finally
    MasterCIList.EndUpdate;
  end;

end;

procedure TForm2.BackgroundWorker1WorkComplete(Worker: TBackgroundWorker;
  Cancelled: Boolean);
begin

  LookupComboBox.Items.AddStrings(MasterCIList );

// AddStrings use beginupdate..endupdate in itself

 end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T21:35:02.750

也许 cmb.Items.Assign(myStringList) 会有所帮助。

这是一个疯狂的想法：我还没有尝试过，但您可以检查是否有一种方法可以通过设置项目数量然后所有者绘图来虚拟加载组合框。请原谅这个疯狂的想法，但我想我听说过这可以通过某种方式获得。无关：这就是它在 Palm OS 中的完成方式……加载组合框的更快方法是不全部加载……;-)

> 不是一个答案，但你到底为什么要在一个组合框中包含 32,000 个项目？这是存储这么多数据的糟糕方式。

我同意; 这是一个不好的做法...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-21T03:05:28.697

又是我。我要添加 32,000 个项目，因为我需要。这是我的应用程序中具有“大量”项目的众多控件之一。我需要有那么多东西。它工作得很好。事实上完美。我只是想优化一些东西。用户发现事情很好，因为它们是按照一定的逻辑顺序排列的。

到目前为止，我对 Assign 和 AddStrings 的看法是，它们最终会通过 SendMessage 调用添加到 Add 中。所以我会继续寻找。

感谢您的反馈。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-13T08:57:11.930

也许你可以试试这个？

“加快向组合框或列表框添加项目” [http://blogs.msdn.com/b/oldnewthing/archive/2004/06/10/152612.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2004/06/10/152612.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-14T02:26:00.640

我以不同的方式实现这一点。首先，我删除了组合框控件并获取文本框控件并将其自动完成分配给自定义源字符串集合为**32k**项的自定义源。我从控件验证的新查询中获取所选值。

因此它可以取代组合框功能。大多数人不滚动大约**32k**项，但他们不断输入击键，并被我们的自定义自动完成源捕获。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-21T09:01:01.120

也许您可以在后端使用数据库引擎并使用数据感知组件。然后事情会变得更快**和**更有用。也许如果您尝试描述您要完成的工作，我们将进一步帮助您。无论如何，你的 UI 设计是*奇怪*的。为此，[Embarcadero 论坛](https://forums.codegear.com)可能会为您提供更好的帮助。

# regex - Regex to match domain

> ID：668055
> 
> 赞同：0
> 
> 时间：2009-03-20T21:23:13.200
> 
> 标签：regex

Having trouble figuring this out and feeling quite stupid...

I have many urls like this /imagebuilder-ptop.asp?imgCode=166 all I need is a regex that will match /imagebuilder-(ANTHING WHATSOEVER)

If is it /imagebuilder-lkd fa;lsdfh adhf alkdfhdfh I want to match it...anything.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T21:24:58.000

`/imagebuilder-(.*)` would do it.

# asp.net - Is there a way to rebuild/repair ASP.Net personalization tables without losing the data inside?

> ID：668056
> 
> 赞同：0
> 
> 时间：2009-03-20T21:23:14.637
> 
> 标签：asp.net, web-parts, personalization

I inherited an Asp.Net app that uses ASP.Net membership services. I am trying to add web parts with personalization to the site, and am getting a lot of errors. It looks like the tables generated by Aspnet_regsql.exe have been changed - probably copied at some point in the past using "select into" causing them to lose all their indexes and primary keys.

How can I repair these tables without losing all the data inside?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T11:38:55.630

1.  备份数据库（以防万一！）
2.  重命名现有数据库
3.  重新创建 aspnetdb
4.  将重命名的数据库中的数据批量复制到新创建的数据库中。（可能与 BCP）

我知道 BCP 是一个旧工具......但它仍然有效。也许有一种更简单的方法可以做到这一点，但这就是我的做法。

# c# - 显示 C# 1 数据类型的通用等效项的表

> ID：668057
> 
> 赞同：2
> 
> 时间：2009-03-20T21:23:49.673
> 
> 标签：c#, generics, reference

前段时间，我遇到了一个表格，其中列出了 C# 1 数据类型的通用等效项。这将是一个方便的参考。谁能指出我这一点？

例如，代替 Hashtable 使用 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T21:26:58.620

[这是吗？](http://en.csharp-online.net/CSharp_Generics_Recipes%E2%80%94Replacing_the_Hashtable_with_Its_Generic_Counterpart)

[或者我发现了这个](http://msdn.microsoft.com/en-us/library/ms379564(VS.80).aspx)

哪个有这张桌子

[表 http://img14.imageshack.us/img14/3601/tablemyr.jpg](http://img14.imageshack.us/img14/3601/tablemyr.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T21:29:32.890

看看[“何时使用泛型集合”](http://msdn.microsoft.com/en-us/library/ms172181.aspx)

# php - 多用户应用程序记录锁定 - 最好的方法？

> ID：668063
> 
> 赞同：3
> 
> 时间：2009-03-20T21:25:21.137
> 
> 标签：php, mysql, locking, records, multi-user

我正在开发一个处理多个同时用户的 php / mysql 应用程序。我正在考虑对当前正在查看/编辑的记录进行锁定/警告时采取的最佳方法。

要避免的情况是两个用户查看记录，一个进行更改，然后另一个执行相同的操作 - 一个更改可能会覆盖以前的更改。

在最新版本的 WordPress 中，他们使用某种方法来检测这一点，但它似乎并不完全可靠——通常会返回误报，至少在我的经验中是这样。

我假设必须使用某种形式的 ajax 来“ping”应用程序并让它知道记录仍在被查看/编辑（否则，用户可能会简单地关闭他们的浏览器窗口，然后应用程序将如何知道这一点）。

我可以看到的另一个解决方案是检查提交记录以供更新时的最后更新时间，以查看在此期间它是否已在其他地方更新 - 然后为用户提供继续或放弃他们自己的更改的选择。

也许我在解决方案方面提出了错误的建议-人们实现此（必须是相当普遍的）要求的经验是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T21:32:50.417

我会这样做：将上次修改的时间存储在编辑表单中。将此提交时间与存储在数据库中的时间进行比较。如果它们相同，则锁定表，更新数据（连同修改时间）并解锁表。如果时间不同，请通知用户并询问下一步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T21:30:14.697

请参阅：[我可以做些什么来防止 wiki 风格的网站上的写-写冲突？](https://stackoverflow.com/questions/624186/what-can-i-do-to-prevent-write-write-conflicts-on-a-wiki-style-website)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T21:29:22.220

时间戳比较的好主意。它的实施成本很低，而且在生产中运行也是一种成本低廉的操作。您只需要编写逻辑将状态消息发送回用户，即他们的写入/更新没有发生，因为有人打败了他们。

也许考虑将每次更新的用户名存储在一个名为“LastUpdateBy”之类的字段中，然后将其返回给抢占更新的用户。对用户来说只是一点点好处。在企业意义上很好，也许不是在一个可能不合适的环境中。

# .net - 读取文件夹中的多个文本文件

> ID：668064
> 
> 赞同：2
> 
> 时间：2009-03-20T21:25:45.677
> 
> 标签：.net, vb.net

我在一个文件夹中有很多文本文件。我现在可以做的是一次阅读一个文本并将其插入数据库。我的小应用程序在调试时会读取一个文本文件。所以，我需要多次运行它来读取所有这些文本文件并将它们导入数据库。

我的问题是如何一次读取文件夹内的多个文本文件。这是我的代码，它工作正常，但一次只能读取一个文本文件。

```
Private Sub btnRead_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRead.Click

        Dim filelocation As String
        filelocation = "F:\txtfiles\ch25.txt"
        Dim chid As Integer
        chid = 25

        'read from file'
        Dim MyStream As New StreamReader(Path.Combine(Application.StartupPath, filelocation))
        Dim vArray() As String = MyStream.ReadToEnd.Split(CChar("$"))
        MyStream.Close()

        Dim count As Integer

        'insert text to table'
        For d As Integer = 0 To vArray.Length - 1 Step 1

            If d = vArray.Length - 1 Then
                Exit For
            End If

            InsertKh(chid, d + 1, vArray(d))
            count = d + 1
        Next

       MsgBox ("Done Inserting")

End Sub 
```

显然，我需要一种方法来遍历文件夹并检查是否有文本文件。但我无法正确处理。谁能给我一些代码或链接？我正在使用 VB.NET、.NET 3.5

非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T21:35:00.677

查看[Directory.GetFiles](http://msdn.microsoft.com/en-us/library/system.io.directory.getfiles.aspx)。

您可以使用指定的搜索模式（如“*.txt”）调用它来查找特定类型的文件。像这样的东西：

```
 Dim fileEntries As String() = Directory.GetFiles(targetDirectory,"*.txt")
    ' Process the list of .txt files found in the directory. '
    Dim fileName As String
    For Each fileName In fileEntries
        ProcessFile(fileName) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T21:32:35.877

我会考虑使用[ThreadPool.QueueUserWorkItem](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)。基本上，您需要读取文件夹中的所有文件并将每个文件排入队列以进行处理。您必须构建一个可以将每个文件单独处理为自己的子例程的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T21:36:24.200

```
Private Sub btnRead_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRead.Click

Dim di As New DirectoryInfo("F:\txtfiles")
Dim s As String

ForEach s In di.GetFiles("*.txt")
    Private Sub btnRead_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRead.Click
        Dim filelocation As String
        filelocation = s ''"F:\txtfiles\ch25.txt"
        Dim chid As Integer
        chid = 25

        'read from file'
        Dim MyStream As New StreamReader(Path.Combine(Application.StartupPath, filelocation))
        Dim vArray() As String = MyStream.ReadToEnd.Split(CChar("$"))
        MyStream.Close()

        Dim count As Integer

        'insert text to table'
        For d As Integer = 0 To vArray.Length - 1 Step 1

            If d = vArray.Length - 1 Then
                Exit For
            End If

            InsertKh(chid, d + 1, vArray(d))
            count = d + 1
        Next

      '' MsgBox ("Done Inserting")

    End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T21:44:54.273

使用 Directory.GetFiles 方法查找文件夹中的所有文本文件：

```
Private Sub btnRead_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRead.Click

   Dim files As String() = System.IO.Directory("F:\txtfiles\", "*.txt")

   Dim count As Integer = 0

   ForEach filelocation As String in files

      Dim chid As Integer = 25

      'read from file'
      Dim MyStream As New StreamReader(filelocation)
      Dim vArray() As String = MyStream.ReadToEnd.Split("$"C)
      MyStream.Close()

      'insert text to table'
      For d As Integer = 0 To vArray.Length - 2
         InsertKh(chid, d + 1, vArray(d))
         count = count + 1
      Next

   Next

   MsgBox ("Done Inserting")

End Sub 
```

注意：
当第二个参数是完整路径时使用 Path.Combine 只是返回第二个参数，所以在这种情况下它是没有用的。
除了将字符串转换为 char 之外，您还可以像这样编写 char 文字`"$"C`：
不要在最后一项时跳出循环，只需让循环提前结束一项即可。
由于您有嵌套循环，因此您必须增加循环中的计数器而不是分配循环变量，否则您将只能获得最后一个文件中的项目数。（如果你真的要使用柜台做任何事情。）

# iphone - iPhone：-[NSConcreteMutableData fastEncoding]：无法识别的选择器

> ID：668066
> 
> 赞同：2
> 
> 时间：2009-03-20T21:26:40.167
> 
> 标签：iphone, nsstring

我正在尝试这样做：

```
self.somestring = [@"hardcodedstring" stringByAppendingString:someotherstring]; 
```

但我不断得到：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[NSConcreteMutableData fastestEncoding]: unrecognized selector sent to instance 0x1fb930' 
```

我没有在任何地方调用此方法，但我看到 stringByAppendingString: 在我的堆栈中调用它：

```
Stack: (
808221155,
806100816,
808224837,
807957033,
807851552,
812064725,
812064413,
18085, <== -[NSString stringByAppendingString:] + 109 in section LC_SEGMENT.__TEXT.__text of /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.2.1.sdk/System/Library/Frameworks/Foundation.framework/Foundation
817945012,
821160740,
821157652,
821149552,
807852041,
812070519,
807836299,
807834407,
827752032,
816118388,
816157144,
8381,
8244 
```

) 我将如何解决这个问题，以便它附加字符串，就像它应该做的那样。谢谢，
艾萨克
**编辑**：要访问一些字符串，我这样做：

```
@property (nonatomic,retain) NSString *somestring; 
```

在我的 ViewController.h 和：

```
@synthesize somestring; 
```

在我的 ViewController.m 中。
**编辑**： someotherstring 来自这里：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)img editingInfo:(NSDictionary *)editInfo {
    self.somestring = [@"hardcodedstring" stringByAppendingString:[UIImagePNGRepresentation(img) encodeBase64]]; //encodeBase64 encodes it to base64
} 
```

**更多编辑**：我分手了：

```
2009-03-20 15:14:21.389 myproject[3467:20b] *** -[NSConcreteMutableData getCharacters:range:]: unrecognized selector sent to instance 0x1fa630
2009-03-20 15:14:21.403 myproject[3467:20b] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[NSConcreteMutableData getCharacters:range:]: unrecognized selector sent to instance 0x1fa630'
2009-03-20 15:14:21.412 myproject[3467:20b] Stack: (
808221155,
806100816,
808224837,
807957033,
807851552,
807660389,
807733601,
807733297,
807891629,
812155873,
812293801,
18081,
817945012,
821160740,
821157652,
821149552,
807852041,
812070519,
807836299,
807834407,
827752032,
816118388,
816157144,
8381,
8244
)
terminate called after throwing an instance of 'NSException'
(gdb) info symbol 18081
-[InternalChoicesController imagePickerController:didFinishPickingImage:editingInfo:] + 73 in section LC_SEGMENT.__TEXT.__text of /Users/isaacwaller/Documents/myproject/build/Debug-iphoneos/myproject.app/myproject
(gdb) info symbol 812293801
NSLog + 25 in section LC_SEGMENT.__TEXT.__text of /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS2.2.1.sdk/System/Library/Frameworks/Foundation.framework/Foundation 
```

所以我认为编码Base64数据有问题吗？我正在使用的代码是：

```
static const char encodingTable[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

@implementation NSData (Base64)

- (NSString *)encodeBase64;
{
if ([self length] == 0)
    return @"";

char *characters = malloc((([self length] + 2) / 3) * 4);
if (characters == NULL)
    return nil;
NSUInteger length = 0;

NSUInteger i = 0;
while (i < [self length])
{
    char buffer[3] = {0,0,0};
    short bufferLength = 0;
    while (bufferLength < 3 && i < [self length])
        buffer[bufferLength++] = ((char *)[self bytes])[i++];

    //  Encode the bytes in the buffer to four characters, including padding "=" characters if necessary.
    characters[length++] = encodingTable[(buffer[0] & 0xFC) >> 2];
    characters[length++] = encodingTable[((buffer[0] & 0x03) << 4) | ((buffer[1] & 0xF0) >> 4)];
    if (bufferLength > 1)
        characters[length++] = encodingTable[((buffer[1] & 0x0F) << 2) | ((buffer[2] & 0xC0) >> 6)];
    else characters[length++] = '=';
    if (bufferLength > 2)
        characters[length++] = encodingTable[buffer[2] & 0x3F];
    else characters[length++] = '=';    
}

return [[[NSString alloc] initWithBytesNoCopy:characters length:length encoding:NSASCIIStringEncoding freeWhenDone:YES] autorelease];
}

@end 
```

谢谢，艾萨克·沃勒

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T00:57:04.233

我会检查代码是否有错别字。该错误非常清楚地表明 NSMutableData 的实例正在使用 NSString 预期。似乎 encodeBase64 以某种方式返回`self`，或者原始 UIImagePNGRepresentation(img) 被传递给`stringByAppendingString:`.

如果不明显，只需将其分解并在每个步骤中检查。（我在这个例子中使用了 NSLog，但是使用调试器也可以正常工作，当然。）

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)img editingInfo:(NSDictionary *)editInfo {
    NSData *rep = UIImagePNGRepresentation(img);
    NSLog(@"Rep: %@", rep);
    NSString *base64 = [rep encodeBase64];
    NSLog(@"Base 64 is a %@", NSStringFromClass([base64 class]));
    self.somestring = [@"hardcodedstring" stringByAppendingString:base64]; //encodeBase64 encodes it to base64 
```

}

我最好的猜测是你不小心传入了原始的 NSData 而不是 NSString ——但是如果失败了，上面的代码应该可以正常工作或者准确地显示出问题的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T21:31:29.827

~~`@"Some String"`不是一个对象，它是一个字符串文字。您无法向其发送消息。您将需要做其他事情来加入这些字符串。~~

就像是：

```
 [NSString stringWithFormat:@"%@%@", @"String 1", @"String 2"]; 
```

~~显然，这是不正确的。字符串文字被视为对象。~~

 ~~如评论中所述，您也可能有问题`self.somestring`。如果您没有声明属性或合成`somestring`，那么通过它访问它`self.`是不正确的。你应该只使用

```
somestring = [NSString stringWithFormat:@"%@%@", @"String 1", @"String 2"]; 
```

如果您已经完成：

```
@interface myClass {
  NSString *somestring;
}
@property(nonatomic, retain) NSString *somestring;
@end 
```

和：

```
@implementation myClass
@synthesize somestring;
@end 
```

然后您可以使用 访问变量`self.somestring`，这实际上只是 . 的语法糖`[self somestring]`。

同样重要的是要注意，`@property`并且`@synthesize`实际上是语法糖位本身。他们最终会做类似的事情。

```
@interface myClass {
  NSString *somestring;
}

-(NSString *)somestring;
-(void)setSomestring:(NSString *)value;
@end 
```

和：

```
@implentation myClass
-(NSString *)somestring {
  return somestring;
}
-(void)setSomestring:(NSString *)value {
  somestring = value;
}
@end 
```

因此，如果您尚未将其声明`somestring`为属性并对其进行合成，那么您就没有这些方法来回答正在传递的消息。

# xcode - 如何指定我可以在 MacOS 上的 XCode 中使用哪个 GDB

> ID：668069
> 
> 赞同：1
> 
> 时间：2009-03-20T21:27:58.227
> 
> 标签：xcode, macos

如何指定我可以在 MacOS 上的 XCode 中使用哪个 GDB（带有完整路径）？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-30T08:57:14.737

您可以为 Xcode 设置*PBXGDBPath*用户默认值，以指定不同版本的 GDB 供 Xcode 使用。

```
defaults write com.apple.Xcode PBXGDBPath <path/to/your/gdb> 
```

[http://developer.apple.com/documentation/DeveloperTools/Reference/XcodeUserDefaultRef/100-Xcode_User_Defaults/UserDefaultRef.html#//apple_ref/doc/uid/TP40005535-CH3-SW54](http://developer.apple.com/documentation/DeveloperTools/Reference/XcodeUserDefaultRef/100-Xcode_User_Defaults/UserDefaultRef.html#//apple_ref/doc/uid/TP40005535-CH3-SW54)

# c# - 我可以在 AfterLabelEdit 期间将节点插入 TreeView 而不开始编辑它们吗？

> ID：668078
> 
> 赞同：5
> 
> 时间：2009-03-20T21:30:21.063
> 
> 标签：c#, winforms, .net-2.0, treeview

我有一个`System.Windows.Forms.TreeView`手动“绑定”到一组分层数据的子类。我希望用户能够编辑树的标签，并将更改反映回数据。所以我设置`LabelEdit`为 true 并覆盖`OnAfterLabelEdit`到：

```
protected override void OnAfterLabelEdit(NodeLabelEditEventArgs e)
{
    base.OnAfterLabelEdit(e);

    TreeNode node = e.Node;

    if (PassesSomeValidation(e.Label))
    {
        MyDataNode dataNode = node.Tag as MyDataNode;
        dataNode.SomeBoundValue = e.Label;

        int oldIndex = node.Index;
        int newIndex = RepositionChangedDataNode(dataNode);

        TreeNode parent = node.Parent;
        parent.Nodes.RemoveAt(oldIndex);
        parent.Nodes.Insert(newIndex, node);
    }
    else
    {
        e.CancelEdit = true;
    }
} 
```

`RepositionChangedDataNode()`重新排序数据并返回排序后更改节点移动到的索引。我希望我可以简单地移动编辑过的节点来反映这一举动。

问题是这会导致节点*保持在编辑模式*！我尝试过调用`EndEdit()`，在插入之前克隆节点，设置`LabelEdit`为 false 并返回 true，将更改包装在`BeginUpdate()`/`EndUpdate()`中，以及这些想法的各种组合，但它们都没有任何效果。

罪魁祸首似乎是插入。即使我尝试插入一个*全新的*节点，它也会立即进入编辑模式。

**那么，有什么办法可以让`TreeView`你不这样做吗？如果没有，是否有一个好的解决方法？**

我考虑过的一些想法：

1.  设置自定义 TreeViewNodeSorter。不过，宁愿不必对我的数据进行两次排序。
2.  设置一个标志并将删除-插入步骤延迟到 AfterLabelEdit 之后的某个时间点。它可以在 WndProc 期间完成，但这感觉就像一个很大的杂物，很可能会以某种方式失败。
3.  用于`BeginInvoke()`将 remove-insert 步骤推回消息队列，如下所示：

    ```
    BeginInvoke(new MethodInvoker(delegate(
    {
        parent.Nodes.RemoveAt(oldIndex);
        parent.Nodes.Insert(newIndex, node);
    })); 
    ```

    这很有效，对我来说似乎比 #2 更干净，但我知道这可能不是`BeginInvoke()`预期的使用方式，并且它可能会产生我对消息泵的非常有限的知识无法预测的影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-03T13:06:57.337

如果设置`LabelEdit`为`TreeView`to `false`，新添加的节点将不会处于编辑模式。

您只需要处理用户想要编辑标签的情况：为 的`MouseClick`事件创建一个处理程序`TreeView`，您可以在其中按位置获取单击的节点。设置`LabelEdit`并`true`调用`BeginEdit()`。在事件处理程序结束时（以及在适当的时间点`AfterLabelEdit`调用之后），再次设置为。`EndEdit(...)``LabelEdit``false`

这对我有用，而使用 BeginInvoke 的解决方案只更改了最后哪个节点处于编辑模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T11:12:57.487

尝试创建一个全局变量，假设：

```
private bool _allowEdit; 
```

将其初始化为`true`,

在您的`OnAfterLabelEdit`方法中将其设置为`false`更改后：

```
... int oldIndex = node.Index;
    int newIndex = RepositionChangedDataNode(dataNode);

    TreeNode parent = node.Parent;
    parent.Nodes.RemoveAt(oldIndex);
    parent.Nodes.Insert(newIndex, node);
    **_allowEdit = false;**
}
else ... 
```

然后像这样捕获`OnBeforeLabelEdit`事件：

```
 protected override void OnBeforeLabelEdit(NodeLabelEditEventArgs e)
    {
        base.OnBeforeLabelEdit(e);
        e.CancelEdit = !_allowEdit;
        _allowEdit = true;
    } 
```

我注意到在“AfterLabelEdit”被触发之后，“BeforeLabelEdit”被重新触发。这就是为什么你必须在那里停止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T21:59:48.527

如果您正在使用数据绑定，对数据源 (SomeBoundValue) 的更新不应该触发节点的刷新吗？也许您可以强制货币管理器重新填充树视图....如果您担心性能，您可以使用一种排序算法，该算法适用于几乎已经排序的数据（例如，不是快速排序 - 合并或堆排序来去提醒）

或者您可以完全放弃数据绑定并手动处理重新定位，因为您已经使用 RepositionChangedDataNode()... 完成了一半。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-19T20:41:37.103

您可以尝试在添加新节点之前取消挂钩 OnEdit 处理程序并在之后重新挂钩。我以前见过这种行为，这就是我处理它的方式。

# java - 如何从 Java 中的日历对象构建天、月、年的列表？

> ID：668083
> 
> 赞同：3
> 
> 时间：2009-03-20T21:31:41.980
> 
> 标签：java, forms, date, calendar

我想为一个表单构建一个日期小部件，它有一个包含月、日、年的选择列表。由于列表根据月份和年份而有所不同，因此我无法将其硬编码为 31 天。（例如，二月有 28 天而不是 30 或 31，有些年份甚至 29 天）我如何使用日历或[joda](http://www.joda.org/joda-time/)对象来构建这些列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T21:39:41.273

我*强烈*建议您避免使用 Java 中的内置日期和时间 API。

相反，请使用[Joda Time](http://www.joda.org/joda-time/)。这个库类似于将（希望！）进入 Java 7 的库，并且比内置 API 更易于使用。

现在，您想知道特定月份的天数是基本问题吗？

编辑：这是代码（带有示例）：

```
import org.joda.time.*;
import org.joda.time.chrono.*;

public class Test   
{
    public static void main(String[] args)
    {        
        System.out.println(getDaysInMonth(2009, 2));
    }

    public static int getDaysInMonth(int year, int month)
    {
        // If you want to use a different calendar system (e.g. Coptic)
        // this is the code to change.
        Chronology chrono = ISOChronology.getInstance();
        DateTimeField dayField = chrono.dayOfMonth();        
        LocalDate monthDate = new LocalDate(year, month, 1);
        return dayField.getMaximumValue(monthDate);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T21:42:01.377

[Calendar](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html)对象将告诉您当前月份的天数，使用`getActualMaximum(Calendar.DAY_OF_MONTH)`. [请参阅此处](http://www.exampledepot.com/egs/java.util/GetDaysInMonth.html)的示例。

从那里您可以在每次更改时更新您的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T08:13:17.770

有许多用于 java 的日期选择器实现，可以通过 swing 或 web ui 使用。我会尝试重用其中一个并避免自己编写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-06T19:53:55.870

以下是创建月份列表的示例：

```
String[] months = new DateFormatSymbols().getMonths();
    List<String> allMonths = new ArrayList<String>();
    for(String singleMonth: months){
        allMonths.add(singleMonth);
    }
    System.out.println(allMonths); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-06T21:15:13.893

# sql - SQL Server - OPENXML如何获取属性值

> ID：668087
> 
> 赞同：0
> 
> 时间：2009-03-20T21:32:38.030
> 
> 标签：sql, sql-server, sql-server-2005

我有以下 XML：

```
<Field FieldRowId="1000">
    <Items>
        <Item Name="CODE"/>
        <Item Name="DATE"/>
    </Items>
</Field> 
```

我需要使用 OPENXML 获取 FieldRowId。我到目前为止的SQL：

```
INSERT INTO @tmpField
      ([name], [fieldRowId])
SELECT [Name], --Need to get row id of the parent node
 FROM OPENXML (@idoc, '/Field/Items/Item', 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T21:56:17.723

编辑：我向 xml 添加了一个根节点。并演示了抢ID。我假设您在 xml 中有多个字段元素。这是假设您有起始 XML；您是否给了一个项目并且必须向上遍历？

```
DECLARE @T varchar(max) 
SET @T = 
'<root>
    <Field FieldRowId="1000">
        <Items>
            <Item Name="CODE"/>
            <Item Name="DATE"/>
        </Items>
    </Field>
    <Field FieldRowId="2000">
        <Items>
            <Item Name="CODE"/>
            <Item Name="DATE"/>
        </Items>
    </Field>
</root>'

DECLARE @X xml

SET @X = CAST(@T as xml)
SELECT Y.ID.value('../../@FieldRowId', 'int') as FieldID, 
       Y.ID.value('@Name', 'varchar(max)') as "Name"
FROM @X.nodes('/root/Field/Items/Item') as Y(ID) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-23T20:49:17.487

使用节点是要走的路。`OPENXML`每次使用时占用 SQL Server 内存的 1/8。虽然`OPENXML`和节点通常会具有相同的查询性能。

# c# - Silverlight：从 silverlight 控件创建图像

> ID：668090
> 
> 赞同：2
> 
> 时间：2009-03-20T21:33:25.297
> 
> 标签：c#, silverlight

是否可以从 silverlight 控件生成图像，以便控件将自身及其内容呈现到图像，以便我可以对图像进行 sime 像素操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T06:13:38.620

在 Silverlight 2 中没有办法实现这一点。我看到人们通过将 XAML 发布到服务器来解决此限制，该服务器将使用 WPF 将其呈现为位图（使用 RenderTargetBitmap）并返回图像。

但是，刚刚发布的 Silverlight 3 Beta 包含一个 WritableBitmap 类，可用于将 Silverlight UIElement 呈现为像素。然而，在测试版中有一个限制；一旦将元素渲染到位图中，就无法访​​问其像素。这个限制应该在最终版本中有所放宽。

Silverlight 3 Beta 还包括像素着色器，因此您可以在 HLSL 中编写自定义着色器并将其应用于任何 UIElement - 这可能是您的最佳解决方案。本教程视频应该让您开始在 Silverlight 3 Beta 中编写和使用像素着色器。[http://silverlight.net/learn/learnvideo.aspx?video=187303](http://silverlight.net/learn/learnvideo.aspx?video=187303)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T21:59:14.957

在搜索 Silverlight 论坛后，尽管有很多请求，但似乎此功能尚不可用。虽然，Silverlight 3 测试版本周刚刚发布，但我不确定该版本在此问题上的状态。

*   [http://silverlight.net/forums/p/12240/39427.aspx](http://silverlight.net/forums/p/12240/39427.aspx)
*   [http://silverlight.net/forums/t/17109.aspx](http://silverlight.net/forums/t/17109.aspx)
*   [http://silverlight.net/forums/p/18438/62854.aspx](http://silverlight.net/forums/p/18438/62854.aspx)

# oracle - 有没有办法在 Oracle Designer 中指定超类型子类型关系？

> ID：668100
> 
> 赞同：0
> 
> 时间：2009-03-20T21:35:58.707
> 
> 标签：oracle, database-design

我想知道是否可以在 Oracle Designer 中创建超类型子类型关系。我想创建这样的东西：

[![替代文字](https://i.stack.imgur.com/dTkIg.gif)](https://i.stack.imgur.com/dTkIg.gif)
[（来源：[Temple.edu](http://ww2.cis.temple.edu/cis109friedman/CIS%20109%20-%20Lecture%20Set%20III%20-%20ERD%20and%20EERDs%20and%20Modeling/Emp-super.gif)）]

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T12:31:29.070

在实体关系图中，子类型是通过在现有实体中创建新实体来创建的，例如[InformIT.com](http://www.informit.com/articles/article.aspx?p=101586&seqNum=7)中的以下示例：

[![ERD 图](https://i.stack.imgur.com/Bn9Tw.gif)](https://i.stack.imgur.com/Bn9Tw.gif)
[（来源：[informit.com](http://www.informit.com/content/images/chap3_0130282286/elementLinks/03fig28.gif)）]

这表明 ORDER 具有子类型 PURCHASE ORDER 和 SALES ORDER，即每个 ORDER**要么**是 PURCHASE ORDER**要么**是 SALES ORDER。

子类型可以嵌套到任何深度。

尽管此示例未显示任何内容，但子类型也可以具有自己的属性和关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T13:38:51.777

请注意，如果您在物理模型上的设计编辑器中工作，则必须将其实现为实际表。

但是请查看外键属性“Arc”的文档，这可能会有所帮助。您可以设置它，以便几个外键中的 1 个可以具有值。

例如，您可以设置从超类型表到每个子类型表的 FK。然后通过使用该属性并为表生成 TAPI 来强制确保一个可以具有值。（缺点是您必须在超类型之前插入子类型信息。）

# c++ - 如何告诉编译器不要优化某些代码？

> ID：668103
> 
> 赞同：3
> 
> 时间：2009-03-20T21:36:27.023
> 
> 标签：c++, optimization, templates, compiler-construction, function

有没有办法告诉编译器（在我的例子中是 g++）**不要**优化某些代码，即使该代码不可访问？我只想要目标文件中的那些符号。

示例：这是一个简单的函数，我确实希望编译这个函数，即使它从未被调用过。

```
void foo(){
  Foo<int> v;
} 
```

如果没有官方的编译器指令，是否有技巧让编译器认为它是一个重要的功能？或者至少让它认为它不能被安全地忽略？我试过这样的事情：

```
extern bool bar;
void foo(){
  if(bar){
    Foo<int> v;
  }
} 
```

但这似乎没有做到。

（如果你真的想知道我到底为什么会想要那个 - 它与[这个](https://stackoverflow.com/questions/555330/templates-use-forward-declarations-to-reduce-compile-time)问题有关，在哪里，而不是显式模板实例化，`template class Foo<int>`我只是希望能够编写`Foo<int> v`，因为在许多情况下这更容易，因为它隐含实例化所有需要的函数，它在调试模式下工作正常，没有优化......）

**更新：**

这是我想做的（作为一个可编译的迷你示例）：

**foo.h**（这些文件是给我的，不可更改）

```
template<class T>
struct Foo {
  T val_;
  Foo(T val) : val_(val) {
      // heavy code, long compile times
  }
}; 
```

**foo-instantiation.cpp**

```
#include "foo.h"
void neverCalled() {
  Foo<int> f(1);
}

// The standard way to instantiate it is this:
// template class Foo<int>;
// but in reality it is often hard to find out 
// exactly what types I have to declare.
// Usage like Foo<int> f(1); will instantiate all
// dependent types if necessary. 
```

**foo-decl.h**（我从 foo.h 中提取的接口）

```
template<class T>
struct Foo {
  T val_;
  Foo(T val); // no heavy code, can include anywhere and compile fast
}; 
```

**主文件**

```
#include <iostream>
#include "foo-decl.h"

int main(int argc, char** argv){
  Foo<int> foo(1);
  return 0;
} 
```

**编译（无优化）**

```
g++ -c main.cpp
g++ -c foo-instantiation.cpp
g++ main.o foo-instantiation.oo 
```

**编译（优化）**

```
g++ -O2 -c main.cpp
g++ -O2 -c foo-instantiation.cpp
g++ main.o foo-instantiation.oo
main.o(.text+0x13): In function `main':
: undefined reference to `Foo<int>::Foo(int)'
collect2: ld returned 1 exit status 
```

*   我尝试了预编译的头文件，但是模板实例化方法使编译速度更快。
*   没有优化的编译`foo-instantiation.cpp`不是那么理想，因为这样库代码（`foo.h`和其他代码）会运行得更慢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T22:37:54.113

您遇到了单一定义规则。在一个文件中，您有一个定义：

```
template<class T>
struct Foo {
  T val_;
  Foo(T val) : val_(val) {
      // heavy code, long compile times
  }
}; 
```

在另一个不同的定义中：

```
template<class T>
struct Foo {
  T val_;
  Foo(T val); // no heavy code, can include anywhere and compile fast
}; 
```

这在 C++ 中是明确不允许的（仅允许一个相同的定义），如果您违反规则，您的代码有时似乎可以正常工作，但您实际上拥有的是可怕的“未定义行为”——任何事情都可能发生，具体取决于月亮（但更有可能是编译器在某些关键时刻的内部状态）。

基本上，你不能写那样的代码——抱歉。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T22:14:46.383

**编译器**无法优化函数体，无论您是否将其声明为extern **，**因为它无法知道该函数不是从另一个编译单元调用的。**如果您将其声明为static** ，它可以优化它，但我不相信任何编译器实际上会这样做。

编译器*可以*优化远离函数调用：

```
while(false) {
  foo();
} 
```

在上面对 foo() 的调用可以省略。

OTOH，如果未调用链接器，则**链接器可以从最终可执行文件中删除函数体。**

由于上述和其他原因，我们确实需要查看一些真实代码才能诊断您的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T21:55:33.717

**搜索#pragma**主题下的文档。此定义是一种逃生舱口，允许您指定各种属性。gcc 支持，所以很有可能 g++ 也会支持。请注意，这些可能不是可移植的，这可能会或可能不会影响您的项目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T10:59:13.113

编译器正在优化一个从未使用过的变量，它无法优化一个函数，因为它不会被使用，因为它可以从不同的编译单元中使用。您可以尝试强制编译器考虑使用类似于以下内容的变量：

```
void instantiation()
{
   Foo<int> f;
   f; // mark the variable as if it is used.
}

// or:
Foo<int>* instantiation()
{
   Foo<int> *p = new Foo<int>();
   return p; // The compiler cannot know if p will be used, it must compile
} 
```

如果需要，更好的解决方案是显式实例化模板：

```
// .h
template <typename T>
class Foo
{
public:
   Foo( T const & value );
   void set( T const & ); // whatever else
private:
   T value_;
};

// template implementation another file, not included from .h
// instantiation.cpp??
template <typename T>
Foo<T>::Foo<T>( T const & value ) : value_(value) {}

template <typename T>
void Foo<T>::set( T const & v )
{
   value_ = value;
}

// explicit instantiation
template class Foo<int>;
template class Foo<double>;

// test.cpp
#include "header.h"
int main()
{
    Foo<int> f(5);
    f.set( 7 );

    Foo<char> f2; // linker error Foo<char>() not defined
} 
```

用户代码只会看到标题并知道存在哪些方法，而不是真正的实现。该实现将在一个编译单元中编译，其中显式模板实例化发生。

请注意，如果您忘记显式实例化一种类型，这将是链接器错误，而不是编译错误。

**单一定义规则**

c++ 中的单一定义规则规定每个符号或类只能有一个定义。对于常规符号，可以很容易地检测到多个定义（如果定义两个`void f() { }`，链接器将检测到重复的符号），但使用模板有点棘手。使用模板会比较棘手，因为它们通常在头文件中声明和定义。编译器在每个编译单元 [1] 中生成使用的符号，链接器通常会找到多个等效符号（std::vector::push_back() 被编译到每个具有 std::vector 并调用 push_back 的编译单元中）

编译器将模板化代码标记为“弱”符号，表示虽然在这里定义了符号，但它也可以在另一个编译单元中定义，并且链接器可以自由地丢弃该符号而不会产生链接错误。如果您想链接使用相同 STL 工具的不同编译单元（例如，具有相同类型），则这是一项要求。

在 gcc 4.2 之前，gcc linux 链接器会丢弃除一个弱符号之外的所有弱符号，而无需进一步检查。一些链接器（Linux 中的 gcc 链接器将在不久的将来，而不是 4.2，不知道 4.3 或 4.4 可能已经存在）确实检查不同的“弱”符号实际上是否相同并提供错误/警告给用户。

您的代码*破坏*了 ODR，因为您在不同的地方重新声明了模板。您应该声明一次模板并在外部实现上述方法。无论如何，如果两个定义都是兼容的（因为它们在您发布的代码段中）：所有成员方法和属性都完全相同并且具有相同的限定符（虚拟/常量...），它应该被编译器接受只是模板的一个定义（唉，重复了）。

[1] 只有那些在代码中实际调用的方法才会被编译：

```
template <typename T>
struct Test
{
   void f() { std::cout << "f()" << std::endl; }
   void g() { std::cout << "g()" << std::endl; }
};
int main()
{
   Test<int> t;
   t.f(); // compiler generates Test<int>::f, but not Test<int>::g
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T22:58:08.603

这通常由编译器指令完成。在 C 中它将是一个#pragma，而在 Delphi Pascal 中它是 {$O-}, {$O+} 围绕有问题的代码。精确的语法和方法是特定于实现的，因此这是一个检查文档以了解您使用的任何系统的问题。

不优化函数非常简单，但是我曾经见过一次或两次需要告诉编译器不要优化特定代码的情况。这是*非常*罕见的，我很长一段时间都没有遇到过，但偶尔会发生。它的情况通常是针对一些旧的遗留代码进行编译的，这些代码是在后来的 cpu 技术开发之前构建的——超线程就是一个典型的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T22:42:31.107

我不确定。也许[预编译的头文件](http://gcc.gnu.org/onlinedocs/gcc/Precompiled-Headers.html)会解决这个问题？

只是稍微修改一下，显然这无助于在代码中使用较小的模板头的问题，但它可能有助于解决编译时问题（从而消除对模板的需求）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T06:36:44.457

将变量声明为 volatile：

```
volatile Foo<int> v; 
```

通常，它会阻止任何优化。我已经使用 Intel C++ Compiler 和 Microsoft Visual Studio 2008 对其进行了检查。

# javascript - Jquery排队动画

> ID：668104
> 
> 赞同：11
> 
> 时间：2009-03-20T21:36:37.567
> 
> 标签：javascript, jquery, queue

我有几个动画要在 dom 中的不同对象上执行。

我希望它们按顺序发生。

我不想这样做：

```
$('#first').show(800, function () 
{ $('#second').show(800, function () {...etc...}); 
```

我想将我所有的动画（和 CPU 密集型功能）添加到某种队列对象中，以确保它们按顺序执行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T21:42:30.940

我不确定您为什么不想使用您描述的方法。如果纯粹从组织的角度来看，您不必使用匿名函数

```
function showFirst() {
  $('#first').show(800, showSecond);
}

function showSecond() {
  $('#second').show(800, showThird);
}

function showThird() {
  $('#third').show(800);
}

function startAnimation() {
  showFirst();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T21:47:53.797

查看 jQuery 效果的[文档](http://docs.jquery.com/Release:jQuery_1.2/Effects)。关于[排队](http://docs.jquery.com/Release:jQuery_1.2/Effects#.queue.28.29_.2F_.dequeue.28.29)的东西应该做你需要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T05:00:20.060

我刚刚使用了这个插件[http://plugins.jquery.com/project/timers](http://plugins.jquery.com/project/timers)，前几天做了类似的事情。您基本上遍历所有匹配的 dom 元素，然后在索引 * 您的毫秒数时每个执行一个动画。

代码是这样的：

**HTML：**

```
<div id="wrapper">
   <div>These</div>
   <div>Show</div>
   <div>In</div>
   <div>Order</div>
</div> 
```

**jQuery**

```
$("#wrapper div").foreach( function(i) {
    i = i + 1;
    $(this).oneTime(800 * i, "show", function()  {
        $(this).show();
    });
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-06-04T13:55:52.757

这也行。

```
 $('#first').show(800);
            setTimeout("$('#second').show(800)", 800);
            setTimeout("$('#third').show(800)", 1600);
            setTimeout("$('#forth').show(800)", 2400); 
```

我知道它不是纯粹的顺序，但我发现它易于阅读，并允许您以更灵活的方式启动动画。

注意：您必须引用要执行的代码。我在前面的代码中没有使用任何双引号，但如果你这样做了，你会像下面这样对它们进行转义。

```
 $('#first').animate({"width":"100px"}, 500);
            setTimeout("$('#second').animate({\"width\":\"100px\"}, 500)", 800);
            setTimeout("$('#third').animate({\"width\":\"100px\"}, 500)", 1600);
            setTimeout("$('#forth').animate({\"width\":\"100px\"}, 500)", 2400); 
```

您通常可以通过交替使用哪些引号来避免这种情况，但值得一提。

更新：这是另一种选择，也值得[在这里查看 jquery 承诺](http://api.jquery.com/promise/)

```
 $('#first').show(800);
            $('#second').delay(800).show(800);
            $('#third').delay(1600).show(800);
            $('#forth').delay(2400).show(800); 
```

# sql - SQL Server 批处理错误处理问题

> ID：668112
> 
> 赞同：1
> 
> 时间：2009-03-20T21:38:40.777
> 
> 标签：sql, sql-server, tsql, error-handling, transactions

如何让这批 SQL 到达最后的 RollBack Transaction 部分？SQL 只是停止在错误的代码行上停止脚本执行。我知道我可以使用 try/catch 构造，但我更感兴趣的是在 SQL 添加 try/catch 之前这是如何处理的。

```
BEGIN TRAN

CREATE TABLE TempTable (c1 INT NULL)

INSERT INTO TempTable (c1) SELECT 1

INSERT INTO TempTable (c1) SELECT 'ABS'

IF (@@ERROR = 0) 
BEGIN
    PRINT 'no error'
    COMMIT TRAN
END
    ELSE
BEGIN
    PRINT 'error' -- Why does it never get here???????
    ROLLBACK TRAN
END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-21T00:05:34.340

在这种情况下，您的“ABS”正在批量中止，因为它是 CAST 错误。在这里解释，在[Erland Sommarskog 的优秀文章](http://www.sommarskog.se/error-handling-I.html#statementbatch)

你必须阅读这篇文章。比您需要了解的更多关于 SQL 错误处理的知识。

此外，您必须测试每个语句。如果第一个 INSERT 失败，你仍然会继续执行（除非你有 XACT_ABORT ON.

```
BEGIN TRAN

CREATE TABLE TempTable (c1 INT NULL)

INSERT INTO TempTable (c1) SELECT 1
IF @@ERROR <> 0
    GOTO errhandler

INSERT INTO TempTable (c1) SELECT 'ABS'
IF @@ERROR <> 0
    GOTO errhandler

PRINT 'no error'
COMMIT TRAN
GOTO exitpoint

errhandler:
PRINT 'error' -- Why does it never get here???????
ROLLBACK TRAN

exitpoint: 
```

如果您有 SQL Server 2000，那么除了添加更多检查、ISNUMERIC 等之外，您没有太多选择。

如果您有 SQL Server 2005，那么您应该真正使用新技术。几乎所有代码和执行错误都被干净地捕获。

```
BEGIN TRY
    BEGIN TRAN

    CREATE TABLE TempTable (c1 INT NULL)

    INSERT INTO TempTable (c1) SELECT 1

    INSERT INTO TempTable (c1) SELECT 'ABS'

    PRINT 'no error'
    COMMIT TRAN
END TRY
BEGIN CATCH
    PRINT 'error' --It will get here for SQL 2005
    ROLLBACK TRAN
END CATCH 
```

# asp.net - 在 ASP.NET AJAX 应用程序中使用 Windows 工作流

> ID：668115
> 
> 赞同：1
> 
> 时间：2009-03-20T21:40:11.927
> 
> 标签：asp.net, workflow, workflow-foundation

我在 ASP.NET 应用程序中使用 Windows 工作流作为类库的一部分。我已经阅读了有关在 ASP.NET 中设置 WWF 和使用 ManualWorkflowSchedulerservice 的所有建议，但是，我不确定这对我的应用程序是否有意义。

我的工作流程都是顺序的，没有持久性；他们很火，然后忘记了。客户端发出请求并稍后返回查看结果（或在应用程序上等待）。到目前为止，我一直在使用 AJAX Web 服务类来完成这项工作。

```
function DoWebserviceJob()
{
   MywebService.DoJob(onComplete, onFailed);
}

[WebMethod]
public DoJob()
{
   //code from library
} 
```

如果客户还在，他会收到通知，如果没有，那也没关系。现在我使用 WWF 而不是直接从库中编码。我知道这行得通（因为我已经这样做了），但我想知道是否有一些我不知道的副作用或其他问题。我的新代码如下所示：

```
[WebMethod]
public DoJob()
{
     WorkflowRuntime runtime = Application["RUNTIME"] as WorkflowRuntime;
     MyWorkflowManager.DoJob(runtime);
} 
```

我的类库：

```
public void DoJob(WorkflowRuntime runtime)
{
   WorkflowInstance instance = runtime.CreateWorkflow(typeof(MyWorkflow));
   instance.Start();
} 
```

这有点简化，但整个过程都在这里。现在效果很好，有什么我应该关注的问题吗？如果它是线程（这似乎是被引用最多的问题），这与在不同线程上触发的 web 服务不同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T12:24:02.393

很难给你一个好的答案，因为有很多未知数，但无论如何我都会给出它。

ASP.NET 和 WF 最常听到的问题是它们都使用 ThreadPool 并且彼此不了解。此问题主要取决于您的 ASP.NET 站点，默认情况下 WF 仅使用 ThreadPool 中的几个线程（每个 proc 4 个线程用于执行工作流，另一个用于运行时）。该问题通常通过使用手动 WF 调度程序来解决，因为 WF 然后使用主机线程，即 ASP.NET 使用的线程。现在根据您的需要，这可能是好是坏。首先，ThreadPool 的大小一直在增长，现在每个 proc 最多 250 个线程，因此 ThreadPool 饥饿不太可能成为问题，除非它是一个高负载网站。使用手动调度程序的一个缺点是所有请求，即 instance.Start()，都变得同步。如果您需要工作流中的某些内容来完成请求，但如果它被触发并忘记您的 ASP。NET 请求现在正在等待工作流完成或达到某个空闲状态。因此，在某些情况下，使用 ASP.NET 应用程序中的默认调度程序会更好，这完全取决于您在做什么和服务器负载。

要记住的一件事是，IIS 将在特定时间后回收 AppDomain，我相信默认为 25 小时或请求数。发生这种情况时，WF 运行时将被销毁，并且在我假设的下一个请求中，会在另一个 AppDomain 中重新创建。如果您不使用持久性，您的所有工作流状态都将丢失，现有工作流将被终止。根据工作流程花费的时间，这可能是一个问题，也可能不是，我很难说。

# wix - 如何从 MSI“文件”表中提取数据（文件计数）

> ID：668122
> 
> 赞同：10
> 
> 时间：2009-03-20T21:43:10.047
> 
> 标签：wix, windows-installer, wix3, orca

在我们的构建过程中，目前有可能将非代码文件（例如图像文件）添加到我们的 Web 项目中，但不包含在 WiX 构建的 MSI 安装程序中。

为了帮助防止这种情况，我想在我们的 WiX 项目的 AfterBuild 目标中执行以下操作：

*   获取构建的所有文件的计数（来自 Web 部署项目的输出）
*   获取 MSI 中内置的所有文件的计数（来自 MSI 中的“文件”表）
*   比较计数，如果不匹配则构建失败

如果我启动 Orca，我可以很容易地看到 File 表和计数，但我不知道如何从 MSBuild 自动执行此操作。是否有一些 API 或其他机制可以从 MSI 中获取这些信息？

我不介意编写自定义 MSBuild 任务来提取 MSI 文件表计数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-21T18:44:32.887

创建一个新的Visual Studio项目，添加引用`c:\windows\system32\msi.dll`并使用以下代码读取msi文件中的文件数：

```
Type installerType = Type.GetTypeFromProgID("WindowsInstaller.Installer");
var installer =
   (WindowsInstaller.Installer)Activator.CreateInstance(installerType);
var msi = installer.OpenDatabase(@"path\to\some\file.msi", 0);
var fileView = msi.OpenView("SELECT FileName FROM File");
fileView.Execute(null);
int fileCount = 0;
while (fileView.Fetch() != null)
{
   fileCount++;
}
Console.WriteLine(fileCount); 
```

此代码使用`WindowsInstaller.Installer`COM 对象，它是 Windows 安装程序自动化 API 的入口点。查看[完整的参考文档](http://msdn.microsoft.com/en-us/library/aa367810(VS.85).aspx)。

**编辑**：显然 wix 带有`C:\program files\Windows Installer XML v3\sdk`包装 msi.dll 的托管程序集（在）。我想这就是 Rob 在他的回答中所指的“DTF”。使用 Microsoft.Deployment.WindowsInstaller 程序集和命名空间中的类型可以将代码示例简化为：

```
var database = new Database(@"\path\to\some\file.msi");
var list = database.ExecuteQuery("SELECT FileName FROM File");
Console.WriteLine(list.Count); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-21T17:44:50.753

MSI 文件是带有自定义 SQL 引擎的小型数据库。您只需要运行查询：

```
SELECT `File` FROM `File` 
```

并计算返回的行数。集成到 MSBuild 任务中的最简单方法可能是使用 WiX 的 DTF，它为所有 MSI API 提供托管包装器。

一旦所有工具都到位，解决方案将非常简单。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T14:46:45.500

由于有多种方法可以实现这一点，我正在用我现在使用的结果来回答我自己的问题，这要感谢 wcoenen 和 Rob 的回答。

这是自定义 MSBuild 任务：

```
public class VerifyMsiFileCount : Task
{
    [Required]
    public string MsiFile { get; set; }

    [Required]
    public string Directory { get; set; }

    public override bool Execute()
    {
       Database database = new Database(MsiFile, DatabaseOpenMode.ReadOnly);
        IList msiFiles = database.ExecuteQuery("SELECT FileName FROM File", new Record(0));
        IList<string> files = new List<string>(
            System.IO.Directory.GetFiles(Directory, "*", SearchOption.AllDirectories));
        return compareContents(msiFiles, files);
    }

    bool compareContents(IList msiFiles, IList<string> files)
    {
        // Always false if count mismatch, but helpful to know which file(s) are missing
        bool result = msiFiles.Count == files.Count;

        StringBuilder sb = new StringBuilder(msiFiles.Count);
        foreach (string msiFile in msiFiles)
        {
            sb.AppendLine(msiFile.ToUpper());
        }
        string allMsiFiles = sb.ToString();

        // Could be optimized using regex - each non-matched line in allMsiFiles
        string filename;
        foreach (string file in files)
        {
            filename = file.ToUpper();
            // Strip directory as File table in MSI does funky things with directory prefixing
            if (filename.Contains(Path.DirectorySeparatorChar.ToString()))
            {
                filename = filename.Substring(file.LastIndexOf(Path.DirectorySeparatorChar) + 1);
            }
            if (!allMsiFiles.Contains(filename))
            {
                result = false;
                MSBuildHelper.Log(this, file + " appears to be missing from MSI File table",
                    MessageImportance.High);
            }
        }
        return result;
    }
} 
```

需要注意的几点：

*   为简洁起见，我省略了文档。
*   MSBuildHelper.Log 只是 ITask.BuildEngine.LogMessageEvent 的一个简单包装器，用于捕获运行单元测试的 NullReferenceException。
*   仍有改进的空间，例如使用 ITaskItem 而不是字符串作为属性，正则表达式进行比较。
*   比较逻辑可能看起来有点奇怪，但是 File 表做了一些带有目录前缀的时髦的东西，而且我还想避免可能删除文件并添加新文件的边缘情况，因此文件计数是正确的，但是微星内容错误:)

这是相应的单元测试，假设您的测试项目中有*Test.msi*，它被复制到输出目录。

```
[TestFixture]
public class VerifyMsiFileCountFixture
{
    VerifyMsiFileCount verify;

    [SetUp]
    public void Setup()
    {
        verify = new VerifyMsiFileCount();
    }

    [Test]
    [ExpectedException(typeof(InstallerException))]
    public void Execute_ThrowsInstallerException_InvalidMsiFilePath()
    {
        verify.Directory = Environment.CurrentDirectory;
        verify.MsiFile = "Bogus";
        verify.Execute();
    }

    [Test]
    [ExpectedException(typeof(DirectoryNotFoundException))]
    public void Execute_ThrowsDirectoryNotFoundException_InvalidDirectoryPath()
    {
        verify.Directory = "Bogus";
        verify.MsiFile = "Test.msi";
        verify.Execute();
    }

    [Test]
    public void Execute_ReturnsTrue_ValidDirectoryAndFile()
    {
        string directory = Path.Combine(Environment.CurrentDirectory, "Temp");
        string file = Path.Combine(directory, "Test.txt");
        Directory.CreateDirectory(directory);
        File.WriteAllText(file, "Temp");
        try
        {
            verify.Directory = directory;
            verify.MsiFile = "Test.msi";
            Assert.IsTrue(verify.Execute());
        }
        finally
        {
            File.Delete(file);
            Directory.Delete(directory);
        }
    }

    [Test]
    public void Execute_ReturnsFalse_NoFileDefined()
    {
        string directory = Path.Combine(Environment.CurrentDirectory, "Temp");
        Directory.CreateDirectory(directory);
        try
        {
            verify.Directory = directory;
            verify.MsiFile = "Test.msi";
            Assert.IsFalse(verify.Execute());
        }
        finally
        {
            Directory.Delete(directory);
        }
    }

    [Test]
    public void Execute_ReturnsFalse_IncorrectFilename()
    {
        string directory = Path.Combine(Environment.CurrentDirectory, "Temp");
        string file = Path.Combine(directory, "Bogus.txt");
        Directory.CreateDirectory(directory);
        File.WriteAllText(file, "Temp");
        try
        {
            verify.Directory = directory;
            verify.MsiFile = "Test.msi";
            Assert.IsFalse(verify.Execute());
        }
        finally
        {
            File.Delete(file);
            Directory.Delete(directory);
        }
    }

    [Test]
    public void Execute_ReturnsFalse_ExtraFileDefined()
    {
        string directory = Path.Combine(Environment.CurrentDirectory, "Temp");
        string file1 = Path.Combine(directory, "Test.txt");
        string file2 = Path.Combine(directory, "Bogus.txt");
        Directory.CreateDirectory(directory);
        File.WriteAllText(file1, "Temp");
        File.WriteAllText(file2, "Temp");
        try
        {
            verify.Directory = directory;
            verify.MsiFile = "Test.msi";
            Assert.IsFalse(verify.Execute());
        }
        finally
        {
            File.Delete(file1);
            File.Delete(file2);
            Directory.Delete(directory);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T01:16:43.997

WinRAR 将 MSI 标识为自解压 CAB 存档（在为其提供 .rar 扩展名之后）。我想你可以将文件复制到某个地方，重命名它，用 WinRAR 解压缩，然后计算文件。但是，这些文件不会有它们的原始名称。

[这](http://msdn.microsoft.com/en-us/library/ms974336.aspx)似乎有点过时了，我不知道它是否有任何帮助。

# php - PHP - 评估 IF 语句的最佳实践

> ID：668123
> 
> 赞同：3
> 
> 时间：2009-03-20T21:43:12.047
> 
> 标签：php, if-statement

考虑以下

```
if(!count($_POST)) { echo 'something'; }
if(empty($_POST)) { echo 'something'; }
if(!$_POST) { echo 'something'; } 
```

上面的每一行几乎都做同样的事情。我并没有特别关注我使用哪一个。我应该更具体吗？真的有关系吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T21:48:54.310

我会用这个：

```
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    // POST request
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T22:08:19.207

我一直更喜欢使用`empty()`，因为如果参数变量未设置或设置但计算结果为 False（空数组将），它会返回 True。这在我的脑海中节省了一步，并取代了`if(!isset($_POST) || !$_POST) { echo 'something'; }`刚才提到的混乱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T01:53:27.497

如果您想测试请求是否是使用 POST 请求发出的，那么检查 $_SERVER['request_method'] 是要走的路。

如果你想知道一个数组是否为空，有一些区别：

*   空的（）

Empty 将检查变量是否为“空”。PHP 认为以下值是空的：

```
*  "" (an empty string)
* 0 (0 as an integer)
* "0" (0 as a string)
* NULL
* FALSE
* array() (an empty array)
* var $var; (a variable declared, but without a value in a class) 
```

Empty 是一种语言结构，这意味着您不能将其用作回调，因此以下操作将失败：

```
$var = array(); call_user_func('empty', $var); 
```

它也只检查变量，因此以下操作也会失败并出现致命错误：

```
if (empty(array()) { // do something } 
```

它也比 count 快，但这不应该让你考虑它而不是其他人。

*   数数（）

Count 是一个“普通”函数，它首先将参数转换为一个数组，并检查它是否为空。我个人会用它来检查空数组。

*   if ($value) { // 做某事 }

这和 count 有点不同，因为这里的 $value 会被强制转换为布尔值，并且因为空数组会被强制转换为 false，所以它会得到与 count 相同的结果。

由于铸造，涉及一个非常大的问题：

```
$var = ''; // empty string
var_dump(empty($var)); // returns true
var_dump(count($var)); // returns false 
```

# c# - 使用命名空间和加载

> ID：668124
> 
> 赞同：3
> 
> 时间：2009-03-20T21:43:21.250
> 
> 标签：c#

在名称空间或外部添加导入有什么区别。加载程序集的方式有区别吗？

```
Using System;
namespace test
{

}
VS
namespace test
{
using System;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T21:45:03.787

将 using 语句放在命名空间内使其成为该命名空间的本地，在命名空间之外意味着文件中的任何内容都可以引用它。编译器总是首先搜索最里面的命名空间。

Stylecop 提倡将“using”语句放在命名空间中，微软声称将 using 语句放在命名空间中允许 CLR 在运行时延迟加载。然而，有许多测试对此提出了[质疑](http://www.hanselman.com/blog/BackToBasicsDoNamespaceUsingDirectivesAffectAssemblyLoading.aspx)。

```
Using System;
namespace test
{
  //Can Ref System
}

namespace test2
{
    using System2;
    //can Reference anything from test2, System2 and System   
    //will look for a reference in test, then System2 then System

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T21:45:02.273

没有。`using`指令绝对是编译时的事情。无论如何，它*不会*影响运行时行为。它只是帮助您不要编写长的完全限定类型名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T01:03:01.457

这只是一种获得反对意见的方法。如果您开始遇到冲突，您甚至可以重命名一些内容：

```
/// buncha assys.
namespace Foo.Bar.Interfaces { interface Iface { }; }
namespace Foo.Baz.Interfaces { interface Iface { }; }
namespace Foo.Bat.Interfaces { interface Iface { }; } 
```

在另一个地方..

```
using Barfaces = Foo.Bar.Interfaces;
using Batfaces = Foo.Bar.Interfaces;

class A : Barfaces.Iface { } 
```

# c# - 在什么情况下 C# 中的赋值不能改变变量的值？

> ID：668128
> 
> 赞同：1
> 
> 时间：2009-03-20T21:44:53.727
> 
> 标签：c#, visual-studio, debugging

这种行为太奇怪了，我什至不知道如何最好地问这个问题。

给定以下 C# 代码片段：

```
public class Foo {
  private bool _value = true;

  // ...

  protected void Method()
  { 
    _value = true;
    if(!_value) {
      throw new Exception("What the...?!?!");
    }
  }
} 
```

将 Visual Studio 调试器附加到执行此代码版本并逐步执行`Method()`（使用 step into 或 step over）的应用程序，`if`评估块并引发异常。在变量上设置监视`_value`，我可以看到 的值`_value`在`false`方法的开头，并且在我跨步/进入赋值语句时不会改变。更有趣的是，如果我继续执行 (F5)，则*不会*引发异常，尽管事情仍然无法正常工作。

当我试图弄清楚为什么在 Visual Studio 中使用 ReSharper 运行 NUnit 测试用例时，我遇到了这个问题，但在 NUnit GUI 中运行时却失败了。我将调试器附加到 NUnit GUI，在意外失败的测试上设置了一些断点，找到了没有正确设置变量的地方，这些地方应该根据上述`_value`变量进行设置，这有点像一个标志，指示是否有东西是否脏），因此注意到`_value`没有改变的奇怪行为（后来添加了异常抛出的东西，并验证我使用的是正确的编译程序集！）。

那么，怎么样？什么可以解释上述行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T21:53:46.340

看看是否有任何属性 getter 发生变化`_value`。调试器将评估属性，因此您的值可能会改变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T21:53:11.227

由于在某些情况下实际上并未引发异常，我认为这是调试器查看错误源或错误版本的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T21:52:11.417

另一个线程可能会影响竞争条件中的字段值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T21:58:07.923

尝试重新构建您的解决方案（在 Visual Studio 菜单中选择：构建 -> 重新构建解决方案），然后重试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T21:51:52.930

我曾经在工作中遇到过类似的情况。有一个值绝对是错误的，和你一样，我有一个 if(value){...} 并且 if 块被执行。在拉了很多头发之后，结果证明这是一个版本问题。直到今天我还不完全明白发生了什么，但是在从我的应用程序中删除对该程序集的引用后，将其从 gac 中取出，重建它，重新 gac-ing 然后将引用重新添加回我的项目，它按预期工作。我不知道这在您的情况下是否可行，但请试一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T21:52:21.913

我能想到的唯一解释是另一个线程正在修改该值。如何调用 Method()？

# php - 使用正则表达式匹配部分 URI

> ID：668136
> 
> 赞同：0
> 
> 时间：2009-03-20T21:47:08.243
> 
> 标签：php, regex, uri

我想将此 url /Real_estate_Listing_Detail.asp?PropID=245 与除了 PropID 编号的能力相匹配...

换句话说，

匹配 /Real_estate_Listing_Detail.asp?PropID=ANY NUMBER HERE，除了 286,289,290,180

在此先感谢...这不应该像我做的那么难...

这是一个 wordpress 插件，所以需要单行表达式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T21:54:35.170

如果您使用的语言支持[环视断言](http://www.regular-expressions.info/lookaround.html)，则可以使用：

```
^/Real_estate_Listing_Detail\.asp\?PropID=(?!(?:286|289|290|180)$)\d+$
^/Real_estate_Listing_Detail\.asp\?PropID=\d+(?<!=(?:286|289|290|180))$ 
```

第一个是前瞻断言，第二个是后瞻断言。

否则使用两个表达式：一个匹配模式，一个排除特定值：

```
^/Real_estate_Listing_Detail\.asp\?PropID=\d+$
^/Real_estate_Listing_Detail\.asp\?PropID=(286|289|290|180)$ 
```

所以第一个表达式必须匹配，而第二个不能匹配。

# apache - 让 Apache 通过单个服务多个目录

> ID：668150
> 
> 赞同：5
> 
> 时间：2009-03-20T21:52:47.467
> 
> 标签：apache, virtualhost

我在为大量虚拟主机提供服务时遇到问题，我想知道是否有更有效的做事方式。

我目前正在使用 Location 指令为来自不同部门的大量项目提供服务，总共来自 19 个部门的 300 多个项目。除了提供文件的目录之外，每个 Location 指令的结构都是相同的。我目前拥有的是一个看起来像这样的大文件：

```
<VirtualHost *> 
   ServerName www.myserver.com 

   <Location /departmentA/project1> 
      AuthType Basic 
      AuthName "By Invitation Only" 
      AuthUserFile /usr/local/departmentA/project1/passwords 
      Require valid-user 
   </Location> 

   <Location /departmentA/project2> 
      AuthType Basic 
      AuthName "By Invitation Only" 
      AuthUserFile /usr/local/departmentA/project2/passwords 
      Require valid-user 
   </Location> 

   <Location /departmentB/project1> 
      AuthType Basic 
      AuthName "By Invitation Only" 
      AuthUserFile /usr/local/departmentA/project1/passwords 
      Require valid-user 
   </Location> 
</VirtualHost> 
```

如您所见，除了路径之外，所有这些结构都是相同的。我想要的当然是我可以为部门和项目名称使用变量并只维护一个 Location 指令。我认为这对服务器和内存的影响也较小。

```
<VirtualHost *> 
   ServerName www.myserver.com 

   <Location /$1/$2> 
      AuthType Basic 
      AuthName "By Invitation Only" 
      AuthUserFile /usr/local/$1/$2/passwords 
      Require valid-user 
   </Location> 
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-16T20:59:04.427

您是否尝试过[<LocationMatch> 指令](http://httpd.apache.org/docs/2.2/mod/core.html#locationmatch)？

它采用正则表达式而不是路径。根据您的路径及其相关的子选项，您可以将数百个指令减少到更易于管理的少数指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T22:07:18.507

我不知道有什么具体方法可以做到这一点，因为我认为不`AuthUserFile`接受动态论证。用您选择的语言编写一个小脚本可能是最简单的，该脚本采用`<Location>`块模板并为您要保护的每个目录重复它。例如，在 Python 中：

```
#!/usr/bin/python
import sys
print '<VirtualHost *:80>'
print '   ServerName www.myserver.com'
for path in sys.stdin:
    print '   <Location /%s>' % path.strip()
    print '      AuthType Basic'
    print '      AuthName "By Invitation Only"'
    print '      AuthUserFile /usr/local/%s/passwords' % path.strip()
    print '      Require valid-user'
    print '   </Location>'
print '</VirtualHost>' 
```

对于它在标准输入上读取的“departmentA/project1”表单的每一行，它都会打印出相应的`<Location>`部分。

# java - CLASSPATH 中的茉莉花

> ID：668153
> 
> 赞同：0
> 
> 时间：2009-03-20T21:53:33.970
> 
> 标签：java, classpath, jasmin

我已经从[http://sourceforge.net/project/showfiles.php?group_id=100746下载了 jasmin.jar](http://sourceforge.net/project/showfiles.php?group_id=100746)

我已将 CLASSPATH 更改为以下内容：

```
echo %CLASSPATH%
C:\Program Files\Java\jre6\lib\ext\QTJava.zip;C:\Sun\SDK\lib;C:\Sun\SDK\jdk\lib\jasmin\jasmin.jar; 
```

以下命令可以正常工作：

```
java -jar C:\Sun\SDK\jdk\lib\jasmin\jasmin.jar -g Greeter.j 
```

但以下不起作用：

```
java Jasmin -g Greeter.j 
```

我想知道我做错了什么以及如何修复它，所以我可以轻松地从命令行运行 Jasmin 并将 jasmin 代码转换为 .class。

我没有在以下位置找到任何有用的信息：http: [//jasmin.sourceforge.net/guide.html](http://jasmin.sourceforge.net/guide.html) 其中说：

> jasmin.jar 文件是运行 Jasmin 的可执行 JAR 文件。例如：
> 
> ```
> java -jar jasmin.jar myfile.j 
> ```
> 
> 或者
> 
> ```
> java Jasmin myfile.j 
> ```
> 
> （如果 jasmin.jar 已经在你的类路径中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-14T19:38:02.507

我不确定自该文档编写以来主类是否已更改，但我只是查看了实际的主类是什么。

如果查看jar文件的manifest，可以看到主类其实是jasmin.Main

如果您的 CLASSPATH 中有 jar 文件，您应该能够执行以下操作：

java jasmin.Main -g Greeter.j

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:04:53.973

原来 jasmin.jar 不在你的类路径中。

-jar 选项告诉解释器执行指定 jar 文件中的 Main 类（它是 Jasmin ）

在第二个中，您说的是，使用此参数执行名为“Jasmin”的类，但解释器 ( java.exe ) 不知道该文件在哪里。

您可以执行以下操作：

1）在环境变量CLASSPATH中的windows中的类路径中设置jasmin.jar（你提到已经存在，但没有提到你是如何放置它的）可能是通过命令提示符窗口并试图在其他窗口中使用它？

2) 从命令行指定类路径

```
 java -classpath C:\a\b\c\jasmin.jar Jasmin -g Greejer.j 
```

那应该行得通。

例如，有时我在类路径中的空白处遇到问题

C:\Progrma 文件....;C:\My\Jar.jar

并没有奏效。你是如何设置你的 CLASSPATH 环境变量的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T06:52:52.613

更改您的类路径

```
C:\Program Files\Java\jre6\lib\ext\QTJava.zip;C:\Sun\SDK\lib;C:\Sun\SDK\jdk\lib\jasmin\jasmin.jar; 
```

至

```
"C:\Program Files\Java\jre6\lib\ext\QTJava.zip";C:\Sun\SDK\lib;C:\Sun\SDK\jdk\lib\jasmin\jasmin.jar; 
```

本质上，在任何有空格的路径周围加上引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T16:43:06.080

打电话`jasmin.jar yourFile.j`

# vb.net - Microsoft VB.NET 命名约定

> ID：668157
> 
> 赞同：13
> 
> 时间：2009-03-20T21:55:36.993
> 
> 标签：vb.net, naming-conventions

VB.NET 是否有任何标准命名约定？

根据您的编程经验，愿意分享您对 VB.NET 的命名约定吗？

[除了Patterns & practice](http://www.codeplex.com/Wiki/View.aspx?ProjectName=guidanceExplorer) Guidance Explorer 和[Guidance Share](http://www.guidanceshare.com/wiki/Main%5FPage)之外，是否有这种良好实践的指南？

谢谢。周末愉快。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-20T22:08:55.540

正如 Mehrdad 所说，VB.NET 遵循[通用 .NET 命名约定](http://msdn.microsoft.com/en-us/library/ms229002.aspx)。更具体地说：

*   类型、事件、只读静态字段、方法、命名空间、属性：PascalCase
*   参数：camelCase
*   两个字符的首字母缩写词：DB，Id 和 Ok 除外
*   三个或更多字符的首字母缩写词：Html 或 html，取决于上下文，但绝不是 HTML
*   复合词：Hashtable，不是HashTable，除了一些常用的术语如FileName
*   不要在单词之间使用连字符 (-) 或下划线 (_) 等分隔符
*   不要使用匈牙利符号

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T22:03:51.247

我在“网络命名约定和编程标准 - 最佳实践”中使用本指南：http: [//10rem.net/articles/net-naming-conventions-and-programming-standards---best-practices](http://10rem.net/articles/net-naming-conventions-and-programming-standards---best-practices "http://10rem.net/articles/net-naming-conventions-and-programming-standards---best-practices")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T22:02:55.163

VB.NET 共享 .NET Framework 的命名约定。PascalCase 用于类型和公共内容，camelCase 否则。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T05:46:04.850

启用 Visual Studio“代码分析”以根据多个 Microsoft 认可的命名约定检查您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T22:06:44.780

看看[这个问题](https://stackoverflow.com/questions/306894/naming-conventions-in-c)。这本质上是关于 C# 的相同问题，但是提供的大多数链接和答案都适用于两种语言。

# agile - 结对编程意味着每个开发人员的双倍成本。值那个钱吗？

> ID：668158
> 
> 赞同：40
> 
> 时间：2009-03-20T21:55:38.847
> 
> 标签：agile, methodology, pair-programming

敏捷中的结对编程要求我们将支付给单个程序员的薪水增加一倍。当然，使用这种方法，代码的质量要好得多，bug 会更早发现等等，但这仍然值得那笔钱吗？也许我们应该把第二个开发者的薪水付给少数测试员（后者通常比合格的程序员便宜得多）？有没有人有这种比较的经验？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-20T22:03:16.520

你怎么知道你的未配对程序员更有效率？有时我觉得单/双可以媲美兔子和乌龟的古老童话。

结对并不会变成适得其反的工作。我不知道有多少次我看到开发人员花费数周时间来开发后来被更简单的东西所取代的东西。“在区域内”的单一程序员经常做愚蠢的事情。当您想要用更少的代码获得更多的冲击力时，生成*太多的*代码太容易了。

而在后人中，当尘埃落定时，你会发现成百上千行代码，因为有人*不了解*库 X 或技术 Y ，所以可能*没有编写。配对**改善了*这个问题，但并没有消除它。它鼓励个人和两人在陷入盲目的代码兴奋之前做更多的研究。

 **我希望我能够配对更多......

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-20T21:59:25.377

我们在我们的公司中使用这种方法，但仅用于困难的任务，或者当您不确定其他人已经完成的工作时，我认为这些工作非常有效。它可以避免您陷入困境，并能够在必要时从人们那里获得想法，同时仍然能够独立地完成大多数简单的任务。

我也相信它比代码审查更有益，这是我们在我工作的地方所做的其他事情。在没有提供重要上下文的情况下，通常很难在进行代码审查时完全了解发生了什么，此时您并不总是有时间考虑所有的进出。结对编程从一开始就为您提供了上下文，并允许您花更多时间思考可能会或可能不会导致问题的边缘情况。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-20T22:30:20.230

尽管我同意迄今为止关于结对编程是一件好事的大多数回应，但我会扮演魔鬼的拥护者并争辩说它并不总是有意义的。

当你配对时，你不会得到一个拥有两倍大脑的程序员。你会得到一个程序员，它是你们两个大脑的结合**。**所以基本上任何时候我搞砸了，我的搭档抓住或找到更好的方法，这是一个加号。但是，任何时候我自己编写正确的代码都是浪费钱，因为不需要我的合作伙伴。

基本上，您需要评估您正在处理的代码。简单的任务通常不值得花钱请人坐在肩膀上并确保你正确地编写了你的​​ for 循环。然而，在某个阈值上，这些任务足够复杂，以至于结对编程的投资回报率是合理的。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-20T22:20:16.137

通过结对编程，您可以结合：

*   更高质量的代码
*   更好地分布内部知识
*   更有团队精神

你不会比这更容易获得那么多的投资回报。

再说一次，您不应该将它用于所有任务。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-20T21:59:54.097

如果花费的时间少于使用一个开发人员所花费的时间的 1/2，这并不意味着成本会增加一倍。我认为这对困难或低级任务会有所帮助。我发现这是值得的，因为有人会说“不，不要那样做！” 早在它最终出现在生产代码中之前，它真的会花费你的时间和金钱。

我写过操作系统和类似性质的东西，有人坐在我旁边仔细检查我的逻辑是非常宝贵的。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-20T22:07:05.670

在工作中，我们一直使用结对编程。诀窍是要知道哪些任务应该成对完成，如果由两个开发人员完成，那将是“浪费时间”。经验法则是更面向研究的任务（即 POC 和尖峰）应该成对完成，同时开发新功能（这样知识就会存在于不止一个头脑中）。更普通的任务，例如 CI 服务器安装或替换插件图标，由单个开发人员完成。另一个因素是团队成员的当前可用性以及该迭代中要完成的当前任务。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-04-30T17:52:29.700

很难说——我花了很多时间在强制配对环境和配对可选环境中工作。我见过的最高质量的代码*不在*配对环境中。这可能更多地与各个开发人员的能力和纪律有关。有时你会从配对中得到你的钱，特别是在一些编码器不是顶级的情况下。但是，如果所有编码员都是经验丰富、训练有素的编码员，那么如果他们一直在配对，那你就是在浪费你的*钱*。

我曾多次经历的一种经历对我的编码学科和我生产的产品质量产生了巨大影响：携带寻呼机。当我必须支持我编写代码的系统时，它会改变我编写代码的方式。也就是说，我以这样一种方式编码，以防止该寻呼机关闭。结果是质量更好的产品，通常也有更好的代码质量。我见过的从未携带寻呼机的编码器产生的代码更脆弱。在他们得到支持之前，他们甚至无法理解和改进。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-20T22:16:13.540

越早发现错误/缺陷，修复的成本就越低，因此使用这笔钱雇佣更多的 QA 人员而不是其他开发人员，将花费你更多的时间/金钱，因为从 DEV 到 QA 的旅行次数。

话虽如此，结对编程并不适合每个人，一些开发人员不能很好地结对，他们会分散对方的注意力，把所有的时间都花在打架上等等。

如果您有可以结对编程的开发人员，从长远来看，当您添加更多可维护的代码、减少缺陷从而减少 QA 时间，以及最重要的是，如果其中一位开发人员被公共汽车撞到，从长远来看，这可能会更有益不必等待某人加快项目进度，然后才能完成更多工作。

如果您的开发人员无法配对程序，请不要强迫他们加入，您要做的就是浪费时间和金钱。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-03-20T23:12:16.497

不，你没有。每个程序员仍然只能得到一份薪水。

如果您不将其称为“结对编程”，您是否认为您的程序员不会互相交谈？你认为编程是完全可并行化的吗？

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-03-21T20:17:47.843

结对编程可以非常有效，但是您不应该结对雇用程序员。您不能强迫开发人员配对程序。只有当两个开发人员点击并决定他们可以互相学习并一起构建一些很棒的东西时，它才有效。我的建议是聘请尽可能多的最聪明的开发人员，并将他们安置在自然而然地鼓励兼职结对编程的环境中。开发人员需要能够单独编写代码，还需要与团队中的其他人讨论它。

找到适合您和您的公司的正确组合将更像是一门艺术而不是科学，当然不是盲目地遵循某些已发布方法的要求就可以做到的事情。

也就是说，在它们被检入之前，你压制的错误越多，从长远来看，你节省的越多。让另一个开发人员在您构建某些东西时进行观察总是比之后让测试人员黑箱更有效。我会称之为钱花得值。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-05-01T19:45:25.863

结对编程的第一个假设是故事卡的开发成本是其两倍。假设是错误的。这是为什么？

*   **提高质量**：一对活跃的程序员在同一张故事卡上工作，完成卡时缺陷更少
*   **提高生产力**：在解决问题时，如果没有完全阻塞，则一对不太可能放慢速度。此外，当您与合作伙伴一起工作时，更难通过电子邮件或网络度假……您不想让合作伙伴失望。成对工作时，您将通过更简洁的设计和更少的代码行来解决问题
*   **消除知识孤岛**：通过轮换对，您将在整个团队中学习应用程序和领域业务知识。该团队不太可能被阻止，因为 Sue 在度假时没有其他人知道她的代码。
*   **知识转移：**当他们一起工作时，轮换的人会互相传授新的技能（工程和领域）。每个人的团队水平都会提高，知识会通过团队传播。
*   **团队自我选择：**团队学习一个花药的技能，并迅速淘汰表现不佳的人。

根据实际经验，我们已经看到缺陷显着下降。可以在不减慢团队速度的情况下添加新团队成员（尝试使用非配对团队）。在一次试验中，一个团队估计了一组故事卡的工作，就好像六个单独的开发人员将分别完成代码一样。然后让六位开发人员配对。他们按时高质量地完成了工作。如果您不配对，您将花费大量时间来交付低质量的产品，您无法扩展，并且您拥有太多的专业知识孤岛。

在第二个示例中，我们估计要在要求的时间内完成工作，我们需要将一个团队从 4 对增加到 7 对。我们给了自己 1 个月的时间来加入新的配对。我们将一位新开发人员与一位经验丰富的开发人员配对，并在故事卡中轮换配对。团队在计划的时间内按质量完成了所有可交付成果。如果没有配对，就不可能将 6 名开发人员添加到 8 名开发人员的团队中并达到目标！

最重要的是，您将通过配对节省资金。您将花费大约相同的时间，以更高的质量交付，提高团队的绩效、技能和知识，并清除死木。您的节省将伴随着可持续的步伐和显着减少拖慢团队速度的缺陷。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-10-29T21:27:43.800

结对编程不会使成本加倍——它只是将打字量减半。打字不是编程。完成软件中的功能就是编程。是解决问题。你不能只用输入的代码行来衡量它。一些程序员会使用更好的算法，因此他们最终会减少打字。

**您如何定义物有所值？**从开始编码到完成实时工作功能之间可能经过的总时间？

**不配对的成本通常不会被正确计算：**问题是大多数人没有衡量缺陷的数量或修复最初没有正确完成的工作所花费的额外时间——他们只是衡量首先是“把工作扔过栅栏”所花费的时间。

在配对时有一些衡量生产力的尝试，但不幸的是，它有点与“交付的代码行数”联系在一起——这是一个虚假的指标。

**您可能会发现这项研究相关：** [http ://collaboration.csc.ncsu.edu/laurie/Papers/XPSardinia.PDF](http://collaboration.csc.ncsu.edu/laurie/Papers/XPSardinia.PDF)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-20T22:44:04.550

前提是您的生产力翻倍以上。部分收益立即实现（例如，在签入代码之前），部分收益在错误和故障较少时进一步实现。

当我教有两个学期经验的学生时，*对于大多数配对来说*，他们的生产力翻了一番以上，因为他们互相提问，他们学习和完成的速度更快。但这并不是普遍正确的。一对不匹配的对可能需要更长的时间，并且比技术更熟练的一半做得更差。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-25T16:54:22.027

其他许多行业的质量管理经验告诉我们，从长远来看，*缺陷预防*比*缺陷检测*（也称为 QA）和后续修复更便宜。

他们还了解到，大多数情况下的*长期*范围为 1 到 2 年，这意味着您的投资在此之后会得到回报。考虑到这种规模的投资通常预计在 4 年后达到收支平衡，这非常好！

问题在于，其他行业花了几十年的时间积累了足够的数据来*证明*他们的情况。你可以很容易地找到数据来支持他们的结论，并以此类比为软件得出结论，但截至今天，还没有软件业务的证据。

话虽如此，我相信类似的结论是有效的：一对开发人员和一个测试人员比一个开发人员和两个测试人员更有效率。

如果您在向管理层证明坐在一台计算机前的两名昂贵的开发人员有问题时，还有许多其他有助于预防缺陷的事情，但对管理层来说并不那么明显（因此令人恼火）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-05-01T19:49:33.047

当我在朋友的船上编程时，我们并不总是有时间，因为我们中的一个人在航行，而另一个人在编码。但是，当我们锚定或在平静的水中时，我们可以进行结对编程并且效果很好。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-04-30T16:52:31.403

没门！在我工作的公司中，我们练习了很多结对编程！它可以非常快速且非常有效地完成工作！试一试！你稍后会评估它！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-04-30T17:19:39.780

来自北卡罗来纳州的 Laurie Williams 教授是学术界关于结对编程有效性的主要权威，她对此进行了大量研究。

如果您想要“官方词”，请访问她的[出版物](http://collaboration.csc.ncsu.edu/laurie/publications.html#PairProgramming)列表。

她的文章：“加强结对编程的案例”非常有名。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-04-30T17:39:01.603

这取决于开发人员。不幸的是，您不能仅仅将任何两个开发人员粘在一起并期望及时、高质量的结果。不是每个人都适合配对编程，甚至不适合在敏捷开发环境中工作。关于配对编程，我认为值得的两件事是：（1）开发人员之间的交叉培训；(2) 实时同行评审。交叉培训将有助于加强整个团队的技能，实时同行评审可以消除对正式同行评审的需要。这些年来，我从同龄人那里学到的东西比我在技术培训中学到的还要多。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-26T22:14:27.960

除非您是一家很小的商店，否则您可能*已经*支付了两个程序员的薪水。结对编程只是（理论上）在相同时间内从这两者中获得更多调试和工作软件的一种方式。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-04-30T17:12:52.447

结对编程的概念不是非黑即白的东西，也不是任何类型的灵丹妙药。

由于各种原因，结对编程通常非常有效，但如果做得好，也会非常累人（在我看来，无论如何）——这意味着一个好的结对可能每天最多结对编程几个小时。当然，这应该被鼓励，但不是强制性的，尤其是在 100% 的时间里不是强制性的，因为这似乎很难管理（以持续的效率和无论如何都没有啤酒）。

所以，结对编程只是解决问题的一种方式，我发现很难从问题的角度来看待它。这不像您需要为此雇用两倍的开发人员。这就像想知道是否值得雇用一个消息男孩/女孩让同一部门的两名员工相互交谈......当明显的解决方案是让他们直接相互交谈而不需要额外的信使时。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-04-20T04:42:26.857

我还没有完成统计数据——我怀疑你很难进行统计上有效的研究——但请记住生成*工作、无错误*代码的表面目标——而不仅仅是代码数量。一对好的组合应该能够创建至少与两个单独工作的程序员一样多的*正确代码。*

# c# - 程序集和命名空间

> ID：668161
> 
> 赞同：5
> 
> 时间：2009-03-20T21:56:02.933
> 
> 标签：c#, .net

单个命名空间中的所有内容都编译成自己的程序集吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-20T21:58:23.037

不。

一个程序集中可以有多个命名空间，并且可以在不同的程序集中使用相同的命名空间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-20T21:58:26.440

不，您可以在一个程序集中拥有多个命名空间。在 VS 术语中，您可以将程序集视为一个项目。解决方案中的每个项目都被编译成它自己的程序集。但是，在一个程序集中，您可以有多个命名空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T22:17:19.717

程序集和命名空间彼此无关，只是有一个普遍使用的约定，即程序集中的类的全名将匹配程序集名称（以某种方式）。

这是一种严格的命名约定——正如[Guffa 所说](https://stackoverflow.com/questions/668161/assemblies-and-namespace/668167#668167)，程序集可以为多个命名空间定义类，并且命名空间中存在的类可以来自多个程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T21:59:28.417

如果您询问每个命名空间是否导致单独的程序集，那么没有。一个程序集可以包含多个命名空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-15T11:48:58.060

> 类在命名空间中组织只是为了保持命名分离和组织。将命名空间视为包含一个或多个类的“文件夹”，并且可能在一个或多个程序集 (DLL) 中定义。

更多信息：[https ://stackoverflow.com/a/20056937/579381](https://stackoverflow.com/a/20056937/579381)

# c# - USB 备份应用程序 - 最佳方法

> ID：668162
> 
> 赞同：1
> 
> 时间：2009-03-20T21:56:11.233
> 
> 标签：c#, backup

我有兴趣编写一个小应用程序来从 USB 备份文件，以帮助我的妻子并在她认为她丢失了东西时减轻她的压力水平！

我试图找出最好的方法，我想要一些非常简单的东西，但喜欢备份更改文件的想法（有点像 SVN）。所以我想出了以下想法，但我想知道是否有人可以提出更好的方法。

*   带有以后台线程开头的“备份”按钮的小型表单应用程序。
*   Thread 使用 USB 驱动器上的递归搜索或类似方法获取所有 FileInfo，并带有一组要扫描的文件类型。
*   使用此信息，它将与以前的信息进行比较，删除、添加和更新备份文件夹中的文件。

我只想备份不同的文件以提高速度。我不确定扫描备份目录并获取 FileInfo 进行比较是否是最好的方法（显然使用相对路径），或者从上次备份中收集 FileInfo，这些文件会保存到一些 XML 文件或类似文件中。

或者，可能有更好的方法来做到这一点！有人有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T22:03:19.423

好吧，对于 linux，您可以使用 rsync 之类的东西。 [http://samba.anu.edu.au/rsync/](http://samba.anu.edu.au/rsync/)或 rsnapshot [http://www.rsnapshot.org/](http://www.rsnapshot.org/)

对于windows，我相信微软有SyncToy：

[http://www.microsoft.com/downloads/details.aspx?amp;displaylang=en&familyid=E0FC1154-C975-4814-9649-CCE41AF06EB7&displaylang=en](http://www.microsoft.com/downloads/details.aspx?amp;displaylang=en&familyid=E0FC1154-C975-4814-9649-CCE41AF06EB7&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:18:23.563

好吧，经过多年亲爱的和孩子们以某种方式破坏个人电脑后，我选择了带有 Raid 1 的 1TB NAS（< 400 美元）。我创建了一个应用程序，可以在预定日期 xcopy 选择的文件夹/文件。我现在休息得更轻松了。

# c# - 如何从网络流中同步读取数据？

> ID：668164
> 
> 赞同：1
> 
> 时间：2009-03-20T21:56:45.180
> 
> 标签：c#, networking, polling

我想用 C# 从网络流中读取数据。

我有一个定期轮询的客户端列表，但是当我开始从一个客户端读取数据时，我必须阅读整个 xml 消息，然后继续到下一个客户端。如果接收数据有一些延迟，我不应该去下一个客户。我应该等待一段时间并获取数据。另外，我不应该无限期地等待。只需超时并在 x 秒后继续下一个客户端....

```
if(s.Available > 0)
{
//read data till i get the whole message.
//timeout and continue with other clients if I dont recieve the whole message 
//within x seconds.
} 
```

有没有办法在 C# 中优雅地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T22:03:48.923

据我所知，没有办法做到这一点，所以你很可能最终会使用多个线程。恕我直言，每个客户端使用一个线程首先是一个更清洁的解决方案，然后您可以在流上调用 Read() ，它可以根据需要花费任意时间，而其他线程对其他客户端执行相同操作.

线程一开始可能有点吓人，特别是如果您使用的是 Windows 窗体（无处不在的委托！）而不是控制台应用程序，但它们非常有用。如果使用得当，它们可以提供很大帮助，尤其是在网络领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:03:14.213

```
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;

public class SynchronousSocketClient {

    public static void StartClient() {
        // Data buffer for incoming data.
        byte[] bytes = new byte[1024];

        // Connect to a remote device.
        try {
            // Establish the remote endpoint for the socket.
            // This example uses port 11000 on the local computer.
            IPHostEntry ipHostInfo = Dns.Resolve(Dns.GetHostName())
            IPAddress ipAddress = ipHostInfo.AddressList[0];
            IPEndPoint remoteEP = new IPEndPoint(ipAddress,11000);

            // Create a TCP/IP  socket.
            Socket sender = new Socket(AddressFamily.InterNetwork, 
                SocketType.Stream, ProtocolType.Tcp );

            // Connect the socket to the remote endpoint. Catch any errors.
            try {
                sender.Connect(remoteEP);

                Console.WriteLine("Socket connected to {0}",
                    sender.RemoteEndPoint.ToString());

                // Encode the data string into a byte array.
                byte[] msg = Encoding.ASCII.GetBytes("This is a test<EOF>");

                // Send the data through the socket.
                int bytesSent = sender.Send(msg);

                // Receive the response from the remote device.
                int bytesRec = sender.Receive(bytes);
                Console.WriteLine("Echoed test = {0}",
                    Encoding.ASCII.GetString(bytes,0,bytesRec));

                // Release the socket.
                sender.Shutdown(SocketShutdown.Both);
                sender.Close();

            } catch (ArgumentNullException ane) {
                Console.WriteLine("ArgumentNullException : {0}",ane.ToString());
            } catch (SocketException se) {
                Console.WriteLine("SocketException : {0}",se.ToString());
            } catch (Exception e) {
                Console.WriteLine("Unexpected exception : {0}", e.ToString());
            }

        } catch (Exception e) {
            Console.WriteLine( e.ToString());
        }
    }

    public static int Main(String[] args) {
        StartClient();
        return 0;
    }
} 
```

（取自“msdn 上的同步客户端套接字示例）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T08:35:07.950

不，没有办法做到这一点。TCP 不保证所有内容都立即到达，因此您需要知道 XML 的大小才能知道是否所有内容都已到达。而你不知道。正确的？

使用异步方法是可行的方法（并使用 XML 构建字符串）

# regex - 正则表达式匹配带有偶数个引号的字符串

> ID：668179
> 
> 赞同：2
> 
> 时间：2009-03-20T22:03:28.423
> 
> 标签：regex

我想出了：`([^"]*["][^"]*["][^"]*)*`

它适用于除空字符串之外的所有情况。我认为它会起作用，因为最后一颗星与前一个标记匹配**零**次或多次。

有任何想法吗？

另外，如果有更好的方法，请告诉我并详细解释。

**该解决方案必须是一个正则表达式，因为它将使用它的地方是一个需要正则表达式的钩子。**

**它也必须匹配不带引号的字符串，因为零是偶数**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T22:08:41.733

试试这个表达式：

```
^(?:[^"]+|"[^"]*")*$ 
```

它匹配一个序列，该序列由除引号 ( ) 以外的任何字符组成，`[^"]+`或由一对引号与除引号 ( ) 之间的任何字符组成的序列组成`"[^"]*"`。并且`*`量词将空字符串考虑在内。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T22:27:03.937

您的正则表达式*应该*匹配完全空的字符串，但不能匹配由单个空格组成的字符串，因为您的正则表达式指出如果字符串不是*完全空*的，它需要包含至少一个双引号。这是因为正则表达式中的 ["] 标记后面没有 *.

考虑所需正则表达式的正确方法如下：您要匹配 (不带双引号的字符串) 后跟 (双引号) 加上 (不带双引号的字符串) 后跟 (双) 引号后跟 (不带双引号的字符串)，然后从第一个 'followed by' 开始无限重复。没有双引号的字符串是 [^"]*，所以你得到（为了可读性添加了空格）：

```
[^"]* (" [^"]* " [^"]*)* 
```

If you compare this with your regular expression, the first [^"]* has been moved **out** of the repetition.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T22:07:51.423

似乎正则表达式不是这项工作的正确工具。编辑：但是，您似乎仅限于此。鉴于该限制，这并不能回答您的问题，但如果没有它，它将很好地工作。

只需遍历您的字符串并计数。C 示例：

```
bool hasEvenNumberOfQuotes(const char *str)
{
    bool even = true;

    while(*str != '\0')
    {
        if(*str == '"')
            even = !even;

        ++str;
    }

    return even;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T22:19:23.020

根据您的正则表达式：

```
([^"]*["][^"]*["][^"]*)* 
```

添加线锚：

```
^([^"]*["][^"]*["][^"]*)*$ 
```

添加匹配非的可能性`"`：

```
^([^"]*["][^"]*["][^"]*|[^"]?)*$ 
```

最后一步不允许匹配任何内容或消耗字符。`"`这允许匹配缺少 a 的字符串。请注意，需要行锚，否则子字符串将与此匹配。

奖励：防止组反向引用（命名/编号组可能会稍微减慢正则表达式引擎）：

```
^(?:[^"]*["][^"]*["][^"]*|[^"]?)*$ 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-20T22:15:05.853

```
import re

def hasPairedQuotes(s):
    stripped = re.sub('[^"]', "", s)
    return len(stripped) % 2 == 0

>>> hasPairedQuotes("")
True
>>> hasPairedQuotes('""')
True
>>> hasPairedQuotes('"""')
False
>>> hasPairedQuotes('"Hello world!""')
False
>>> hasPairedQuotes('"Hello world!"')
True 
```

* * *

很好，你想要一个正则表达式，这是一个正则表达式：`^[^"]*("[^"]*")*[^"]*$`......但我认为易读性和可维护性的差异不言而喻。

```
>>> re.match(r'^[^"]*("[^"]*"[^"])*$', 'Hello ""')
<_sre.SRE_Match object at 0xb7cc0ce0>
>>> re.match(r'^[^"]*("[^"]*"[^"])*$', 'Hello "" "')
>>> 
```

# logging - 在长期运行的进程中跟踪警告/错误的最佳实践是什么？

> ID：668182
> 
> 赞同：5
> 
> 时间：2009-03-20T22:04:08.237
> 
> 标签：logging, monitoring

我们的团队有许多流程，我们手动运行，但可能会运行很多天。这些进程对大量实体（网页、数据库行、图像、文件等）执行各种操作。显然，有时会出现故障，我们必须设计或流程来优雅地处理这些故障并继续前进，这样整个工作才不会被拖垮。

根据所讨论的特定过程，失败的速率、严重性和紧迫性会有所不同。在某些情况下，我们会在发生罕见但重要的错误时发送电子邮件，在其他情况下，我们只是记录它并继续，等等。

问题是我们到处都有不同的错误处理代码，而且当我们“记录并继续”时，往往没有人回头阅读日志，所以没有人知道发生了什么问题。我们不能默认使用电子邮件解决所有问题，因为电子邮件太多了。

这些是长时间运行的进程，但不是守护进程，SNMP 或 Nagios 之类的东西可能感觉很合适。当然这是一个相当普遍的问题，但我似乎无法在网上找到很多解决方案。我听说人们在谈论使用 log4j（或其他类似的日志记录包）来登录数据库等，这似乎是朝着正确方向迈出的一步，但现在肯定有更复杂的解决方案...... ? 我正在想象您的记录器将事件写入数据库，并且有一个类似 Nagios 的 Web 界面，可让您实时查看哪些进程发生了哪些错误以及为特定模式配置电子邮件警报等。

这样的事情存在吗？如果没有，您使用了哪些方法来成功处理类似问题？

（因为我们的大部分代码库都在 python 中是值得的，但我想这个想法的任何体面的实现在很大程度上都是非语言特定的，显然任何概念性的解决方案也是如此）。

更新：我刚刚花了一些时间查看 Chainsaw，这正是我正在寻找的东西，但我希望它是一个 web 应用程序而不是桌面应用程序，并具有警报功能。

更新：我刚刚发现了[hoptoadapp](http://hoptoadapp.com/)和[exception](http://getexceptional.com/)，它们都与我的想法有些相似，尽管它们都专门针对 Rails。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T23:01:28.847

好吧，似乎可行的解决方案是消化错误日志。每个晚上都有一个过程检查错误日志并汇总当天的错误/警告/等，然后将它们放入电子邮件中。如果您愿意，您甚至可以按严重性和/或应用程序对它们进行分组。

最后，您每天只收到一封电子邮件，所有信息都触手可及。不是“快速”甚至优雅的解决方案，但从长远来看可能非常可行。

这也不提供任何实时选项。但是，您可以将其发展为更实时的解决方案。编写一个监控日志文件的更改然后根据最后一条错误消息触发一些规则的进程并不难。解析变得棘手。;） 祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:22:16.783

我认为您在这里需要的东西太具体了，无法找到已经构建的非常适合您需求的东西。但...

您对 log4j 的描述对我来说似乎很棒：一旦您将错误记录到数据库中，一个简单的网络应用程序会让您查看它们，过滤并设置模式以触发电子邮件，例如来自特定应用程序的错误，错误级别阈值，包含一些正则表达式的消息等。

此外，您将需要一些小的 cronjob 来连接到数据库，搜索与电子邮件条件匹配的新记录（基于上次检查）并将它们发送出去。

编写所有这些代码最坏的情况应该不会超过几天，而且，对于它的价值，您最终将拥有一个 100% 的自定义工具。

# flash - Flash 播放器可以从 url 播放 .wav 文件吗？

> ID：668186
> 
> 赞同：6
> 
> 时间：2009-03-20T22:06:43.267
> 
> 标签：flash

假设我在 url 上有一个 wav 文件：

```
http://hostname.com/mysound.wav 
```

我正在尝试使用声音类加载 wav 文件，例如：

```
var url:String = "http://hostname.com/test.wav";
var urlRequest:URLRequest = new URLRequest(url);
var sound:Sound = new Sound();
sound.load(urlRequest);
sound.play(); 
```

但是，这似乎不起作用。flash player 可以播放 wav 文件，还是只是 mp3？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T22:17:29.670

[Sound 类的 ActionScript 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html)声明仅支持 MP3 文件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-10-17T11:48:47.667

这里是一个简单的类，用于使用开源 popforge 库从 flash 中的 url 加载和播放 wav 文件：[http ://code.google.com/p/popforge/](http://code.google.com/p/popforge/)

干杯！

```
 public class WavURLPlayer
     {

      public static function PlayWavFromURL(wavurl:String):void
      {
       var urlLoader:URLLoader = new URLLoader();
        urlLoader.dataFormat = URLLoaderDataFormat.BINARY;
        urlLoader.addEventListener(Event.COMPLETE, onLoaderComplete);
        urlLoader.addEventListener(IOErrorEvent.IO_ERROR, onLoaderIOError);

       var urlRequest:URLRequest = new URLRequest(wavurl);

       urlLoader.load(urlRequest);
      }

      private static function onLoaderComplete(e:Event):void
      {
       var urlLoader:URLLoader = e.target as URLLoader;
        urlLoader.removeEventListener(Event.COMPLETE, onLoaderComplete);
        urlLoader.removeEventListener(IOErrorEvent.IO_ERROR, onLoaderIOError);

       var wavformat:WavFormat = WavFormat.decode(urlLoader.data);

       SoundFactory.fromArray(wavformat.samples, wavformat.channels, wavformat.bits, wavformat.rate, onSoundFactoryComplete);
      }

      private static function onLoaderIOError(e:IOErrorEvent):void
      {
       var urlLoader:URLLoader = e.target as URLLoader;
        urlLoader.removeEventListener(Event.COMPLETE, onLoaderComplete);
        urlLoader.removeEventListener(IOErrorEvent.IO_ERROR, onLoaderIOError);

       trace("error loading sound");

      }

      private static function onSoundFactoryComplete(sound:Sound):void
      {
       sound.play();
      }

 } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T22:58:06.483

直接你不能，但由于 ByteArray 有一些解决方法；)

**看一下这个 ：**

[http://richapps.de/?p=97](http://richapps.de/?p=97)

> 编辑：
> 
> 上一个链接有点老了，我认为您还应该看看 Andre 和 Joa 的神话般的**PopForge** 库。实际上那里也有一个 wav 解码器类。
> 
> [http://code.google.com/p/popforge/source/browse/#svn/trunk/flash/PopforgeLibrary/src/de/popforge/format/wav](http://code.google.com/p/popforge/source/browse/#svn/trunk/flash/PopforgeLibrary/src/de/popforge/format/wav)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-17T16:37:00.913

是的你可以。我制作了 Wav/Au Flash 播放器，它可以播放流 wav，以 G.711 或 PCM 编码，具有任何比特长度和采样率。在 GPLv2 下获得许可，此处：[http ://blog.datacompboy.ru/2009/10/15/wav-au-flash-player/](http://blog.datacompboy.ru/2009/10/15/wav-au-flash-player/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-17T07:26:27.173

Flash 本身不支持播放 .wav 文件。Flash/Flex Builder 将它直接编译成一个可在您的脚本中播放的 Sound 对象，但对于外部 .wav 声音，Flash SDK 无法帮助您。

您将需要自己读取 .wav 数据并让 Flash 播放，或者：周围有几个第三方库可以为您执行此操作。上面的帖子使用了 popforge，这里的教程演示了 as3wavsound 从 URL 播放外部 .wav 文件：

[http://active.tutsplus.com/tutorials/media/quick-tip-play-external-wav-files-in-as3/](http://active.tutsplus.com/tutorials/media/quick-tip-play-external-wav-files-in-as3/)

# c# - .NET 应用程序的链接器状态（又名“请先生，我可以有一个链接器”2009 年版）

> ID：668188
> 
> 赞同：71
> 
> 时间：2009-03-20T22:07:04.750
> 
> 标签：c#, .net, vb.net, mono, linker

这里的许多人可能都熟悉[Joel Spolsky](http://www.joelonsoftware.com/)最受欢迎的博客文章之一，[请先生，我可以有一个链接器吗](http://www.joelonsoftware.com/articles/PleaseLinker.html)，他在其中大声疾呼要一种方法来消除对 .NET 框架的依赖，以便可以开发和开发独立的应用程序卖。

当时，Visual Studio 开发团队的[Jason Zander回答](http://blogs.msdn.com/jasonz/)[了他对该主题的看法](http://blogs.msdn.com/jasonz/archive/2004/01/31/65653.aspx)，认为该主题有些没有实际意义——在运行时修复安全问题的能力（以及其他点）是他们主要关心的问题。总的来说，小小的开销是值得的。

快进到 2009 年。现在有几个小组声称拥有 C# 链接器。（Jason Zander 甚至自己说，实现一个并不需要太多。）我们现在拥有一个 200-300 mb 的跨平台完整 .NET 3.5 安装程序，而不是可爱的、几十兆的 .NET 1.0 下载包含适用于 x86、x64 和 ia64 的 .NET 版本。Microsoft 减少运行时大小的建议包括：

*   解压可再发行组件，删除不需要的目标平台，然后将其重新组合在一起
*   使用只为您的平台下载库的网络引导程序
*   使用具有有限库且仅适用于 x86 的客户端配置文件安装程序（2008 年末新增）

更糟糕的是，据我所知（如果我错了，请纠正我）客户端配置文件甚至没有在 Windows 上注册为安装了 .NET 3.5。这意味着如果在计算机上安装了多个 .NET 3.5 客户端应用程序，则不会互相看到，并且运行时将一次又一次地重新安装！

我真的不知道微软在这里是怎么想的。即使假设最坏情况下的安装将是针对一个目标平台（例如 x64）并且只需要包含那些库，您仍然会在应用程序上看到超过 60 mb 的开销。[即使是最著名的 .NET 应用程序之一，Paint.NET，由于大量的 .NET 依赖项，安装应用程序](http://blog.getpaint.net/2008/08/24/the-paintnet-install-experience-part-1-version-3xx/)也充满了困难。 如果他们在分发免费应用程序时遇到问题，那么世界其他地方呢？最后，他们必须[制作一个安装了 Microsoft Installer 3.1 的引导程序、.NET 运行时引导程序和所有其他依赖库，](http://blog.getpaint.net/2008/08/25/the-paintnet-install-experience-part-2-version-40/)然后才能安装自己的应用程序。

那么怎么样。一个链接器。是否存在任何好的工具 - 或者是一种工具，它可以简单地构建 C# 应用程序而无需用户安装大量的 .NET 运行时？

更新：所以，看起来有几个选项：

单核细胞增多症：

*   [Mono 有自己的链接器](http://www.mono-project.com/Linker)。从下面的答案来看，它看起来效果很好。

。网：

*   [Xenocode](http://www.xenocode.com/)似乎是一种可用且有效的方法。
*   [Thinstall](http://www.thinstall.com/)是另一个被推荐的，它是由 VMware 推荐的。
*   [Remotesoft 还有另一个链接器](http://www.remotesoft.com/linker/)。他们将其称为“混淆器”。有什么想法吗？
*   [Rustemsoft 发现了另一个名为 Skater .NET Obfuscator](http://www.skaterpro.net/linking-net-dlls.html)。有熟悉他们的人吗？
*   [还建议使用 Microsoft 的 ILmerge](http://research.microsoft.com/en-us/people/mbarnett/ILMerge.aspx)；这看起来只执行部分任务（即合并库，而不是剥离未使用的位）。

看起来 Mono 工具正在被使用；基于 .NET 的工具怎么样？与他们有任何其他经验，还是我们只需要等待 Microsoft 将其 3.5 推出给所有人？想到 .NET 4.0 需要多长时间才能推出，我不寒而栗……

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-29T13:36:35.213

[Mono Linker](http://mono-project.com/Linker)的情况。

我不能过多谈论这里列出的其他软件，但作为 Mono Linker 的作者，我可以知道它做什么和不做什么。

Mono 链接器只是一个托管链接器，因此根据定义，它需要程序集，并删除程序运行不需要的内容。它不会将所有程序集合并在一起，也不会用它们制作本机程序。

ILMerge 有一个 Mono.Merge 克隆，但它并不完整，它的作者也没有维护它。为了生成包含 Mono 运行时和程序集的本机程序，Mono 提供了[mkbundle 工具](http://www.mono-project.com/Guide:Running_Mono_Applications#Bundles)。

此外，由于它只是一个托管工具，它正在更改程序集，如果您为其提供强命名程序集，并且您没有私钥来签名它们，那么您将在运行这些程序集时遇到麻烦。

我写了几篇关于链接器的博客文章：

*   [链接器的介绍](http://evain.net/blog/articles/2006/08/21/link-to-link)
*   [链接器和 mkbundle 的组合使用](http://evain.net/blog/articles/2006/08/22/linking-all-the-way-down)

关于我们使用 Linker 的经验。链接器目前用于 Mono 项目的两个部分。它用于生成我们分发的程序集，供人们嵌入我们的 C# 编译器 Mono.CSharp.dll。您可以在 PDC上观看[Miguel 的演示，其中描述了我们如何做到这一点。](http://channel9.msdn.com/pdc2008/PC54/)它非常简单，它是 Linker 的基本用法，它是一个可定制的工具，并且为它编写自定义步骤非常容易。

Linker 的一个更复杂的用途是[我们创建 Moonlight 程序集](http://www.mono-project.com/MoonlightNotes#Assemblies)的方式。Moonlight 是我们的 Silverlight 实现，程序集是桌面程序集的子集。所以我们链接我们的桌面程序集以减小它们的大小，并使用自定义步骤，我们正在转换公共 API 以匹配 Silverlight 的。

所以是的，链接器有一些非常粗糙的边缘，例如命令行界面，或者你必须真正知道你在做什么的事实，或者你最终可能会得到一些奇怪的程序集，但总而言之，它对我们非常有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T22:36:42.853

FWIW

Mono 有[一个链接器](http://www.mono-project.com/Linker)已经有一段时间了。

这是一个如何使用 mkbundle的[示例。](https://stackoverflow.com/questions/558707/mono-mkbundle-tool-unable-to-create-binary-with-complaint-that-output-file-is-una)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T04:55:40.277

[http://www.xenocode.com/](http://www.xenocode.com/)

这就是我们使用的。到目前为止，经过一年或有限的使用（可能在野外安装了 500 个），零问题。

而且它的价格相当合理。他们有一些更昂贵的全虚拟化软件（将您的应用程序与其他应用程序甚至操作系统捆绑在一起）。但我们并不需要所有这些。大约一年前我们的成本是 400 美元。我认为它现在有点贵，但比 Thinstall 便宜得多。

他们有很棒的演示，你可以下载，比如[IE 8。不需要安装。](http://www.xenocode.com/start/?a=IE8 "在不安装的情况下运行 IE 8")

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T12:59:26.410

客户端配置文件向 Windows 注册，但以特殊方式注册，因为您不想将仅具有客户端配置文件的机器与具有完整 .net 3.5 的机器混淆

客户简介：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\DotNetClient\v3.5\Install 
```

完整的.net 3.5：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5\Install 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T22:35:57.643

这是我很久以前在 .NET Rocks 上听到的主要内容。不过，我从来没有真正改变过尝试

[http://www.remotesoft.com/linker/](http://www.remotesoft.com/linker/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T18:17:59.687

从来没有用过，但我听说你可以用[.NET Reactor做类似的事情](http://www.eziriz.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T04:51:55.747

在乔尔写那篇文章之前，我一直在[争论（以我的笔名“类比先生”）](http://discuss.joelonsoftware.com/default.asp?joel.3.98498.41)需要在乔尔的论坛上建立一个链接器。链接器的扩散似乎证明了我的担忧（可悲）。

[http://www.thinstall.com/](http://www.thinstall.com/)

从与我交谈过的人看来，它的评价相当不错，尽管我上次检查许可是繁重的（每个应用许可每年 2000 美元）。他们似乎针对的是 IT 商店而不是软件开发人员。您在他们的网站上找不到定价的事实表明（对我而言）它很昂贵。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T13:50:38.050

CodeProject 上有一篇很棒的文章讨论了一些“链接器”以及它们是如何工作的。

[http://www.codeproject.com/KB/dotnet/internals_native.aspx](http://www.codeproject.com/KB/dotnet/internals_native.aspx)

# mysql - MySQL 语法和“或”性能

> ID：668210
> 
> 赞同：2
> 
> 时间：2009-03-20T22:17:05.943
> 
> 标签：mysql

这个 MySQL 查询工作得很好

```
SELECT o.id 
FROM descriptions_programs d, titles_programs t, programs o
WHERE (d.object_id=o.id 
        AND MATCH (d.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND d.current=1)
AND   (t.object_id=o.id 
        AND MATCH (t.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND t.current=1) 
```

但如果我用 OR 替换 AND，查询会运行很长时间。（我必须杀了它。）：

```
SELECT o.id 
FROM descriptions_programs d, titles_programs t, programs o
WHERE (d.object_id=o.id 
        AND MATCH (d.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND d.current=1)
OR    (t.object_id=o.id 
        AND MATCH (t.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND t.current=1) 
```

为什么是这样？不要沉迷于 +china 的简单性。为了调试，我只是简化了这个。此外，如果我只使用 MATCH AGAINST 测试之一，它工作正常，所以两者都可以。我感觉我无意中通过使用 OR 导致了一个巨大的连接，但我就是不明白。我之前在两个子选择的 UNION 上使用了一个 IN 测试，这个测试有效，但这也应该有效。对？

**更新：**根据 bobince 的要求。[它不是超级慢，但在大约 500 毫秒时，它并不像这里讨论](https://stackoverflow.com/questions/668371/mysql-fulltext-search-across-1-table)的使用 UNION 那样快。

```
mysql> explain SELECT o.id
    -> FROM programs o
    -> JOIN titles_programs t ON t.object_id=o.id
    -> JOIN descriptions_programs d ON d.object_id=o.id
    -> WHERE MATCH (d.text) AGAINST ('+china' IN BOOLEAN MODE) AND d.current=1
    -> OR MATCH (t.text) AGAINST ('+china' IN BOOLEAN MODE) AND t.current=1
    -> ;
+----+-------------+-------+-------+

----------------+----------------+---------+----------------------+--------+-------------+
| id | select_type | table | type  | possible_keys  | key            | key_len | ref                  | rows   | Extra       |
+----+-------------+-------+-------+----------------+----------------+---------+----------------------+--------+-------------+
|  1 | SIMPLE      | o     | index | PRIMARY        | PRIMARY        | 4       | NULL                 | 148666 | Using index | 
|  1 | SIMPLE      | d     | ref   | object_current | object_current | 4       | haystack.o.id        |      1 |             | 
|  1 | SIMPLE      | t     | ref   | object_current | object_current | 4       | haystack.d.object_id |      1 | Using where | 
+----+-------------+-------+-------+----------------+----------------+---------+----------------------+--------+-------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T01:32:02.977

杰森的回答很到位。此外，我会尝试使用更现代的 ANSI 连接语法来减轻 WHERE 子句的负担，从而减轻那里的混乱：

```
SELECT o.id
FROM programs o
JOIN titles_programs t ON t.object_id=o.id
JOIN descriptions_programs d ON d.object_id=o.id
WHERE MATCH (d.text) AGAINST ('+china' IN BOOLEAN MODE) AND d.current=1
OR MATCH (t.text) AGAINST ('+china' IN BOOLEAN MODE) AND t.current=1 
```

这将阻止无意的交叉连接导致组合爆炸；除非数据库真的很大，否则我希望它能够在合理的时间内运行。

如果没有，您可以发布上述 EXPLAIN SELECT 的结果吗？大概没有使用全文索引中的一个或两个。我当然可以想象查询优化器无法使用第二个全文索引，方法是尝试“填充”与第一个全文查询不匹配的行，而不是直接进入索引或其他方式。

通常，当您想对两列组合进行全文索引时，您会在两列上创建一个索引。无论如何，这会快得多。但是，这意味着您必须将标题和描述放在同一个表中。这可能不是那么困难：因为全文仅适用于 MyISAM 表（并且您通常不希望 MyISAM 表中的规范数据）您可以将数据的最终副本保存在正确规范化的 InnoDB 表中，并带有一个额外的 MyISAM 表仅包含剥离和词干搜索诱饵。

如果这些都不好......好吧，我想我会回到你提到的 UNIONing ，再加上一个应用程序级过滤器来删除重复的 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T22:38:35.640

`o`您的问题是and`d`和 and之间的连接`t`需要在所有情况下发生。也就是说，您需要：

```
SELECT o.id 
FROM descriptions_programs d, titles_programs t, programs o
WHERE d.object_id=o.id AND t.object_id=o.id AND
(
        MATCH (d.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND d.current=1
) OR (  MATCH (t.text) AGAINST ('+china' IN BOOLEAN MODE) 
        AND t.current=1
) 
```

为什么？因为在您的第一个查询中，您可以忽略这些括号——所有内容都被`AND`编辑在一起，并且表连接得很好。在您的第二个查询中，这是不正确的。

考虑一下数据库实际上在做什么：它采用“t 中的所有行”并将其与“d 中的所有行”交叉，因此是`t*d`行。通常，您使用连接（就像我所做的那样）将其限制为有效行的线性列表。

但是在您的`OR`查询中，您允许*任*一行匹配`o`而不是*两者都*匹配`o`，因此对于一个匹配的表中的每一行，您还选择*了另一个表中的所有行*。

# visual-studio - 如何使用 Visual Studio 构建内核映像？

> ID：668216
> 
> 赞同：7
> 
> 时间：2009-03-20T22:18:49.760
> 
> 标签：visual-studio, kernel, osdev, multiboot

我想使用 Visual C++ 为 x86 机器构建嵌入式内核。我有一些 C 和汇编代码文件要编译，我想以与 GRUB 等 Multiboot 引导加载程序兼容的方式将它们链接在一起。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-21T05:43:26.570

OSDev[在 Visual Studio 上有一个 wiki 条目](http://wiki.osdev.org/Visual_Studio)，它可能会提供一些见解，尤其是指向 Kaushik Srenevasan 的关于 PE 内核主题的[博客](http://ksrenevasan.blogspot.com/2005/10/writing-multiboot-pe-kernels-using.html) [条目](http://ksrenevasan.blogspot.com/2005/10/writing-multiboot-pe-kernels-using_03.html)的链接，该主题旨在由基于多重引导的引导加载程序（如 GRUB）加载。

您应该知道的一些大而广泛的事情：

*   在 multiboot 标头中，您需要使用 AOUT kludge。
*   您需要为链接器指定 /BASE:0x100000 参数，因此最终的二进制代码基于引导加载程序将其放置的位置。
*   您的内核的入口点（通常称为“ `kmain`”）需要`__declspec(noreturn)`在其上，并且您需要执行 an`__asm { hlt }`而不是返回。

# .net - 谜语：三个相等的日期什么时候不相等

> ID：668217
> 
> 赞同：2
> 
> 时间：2009-03-20T22:19:08.807
> 
> 标签：.net

从三个变量开始，都是System.DateTime。

```
a: 10/2/2009 2:30:00 PM
b: 10/2/2009 2:30:00 PM
c: 10/2/2009 2:30:00 PM 
```

将它们相互比较。

```
a=b: True
b=c: True
c=a: True 
```

好的，我们已经确定所有三个日期都是相等的。因此，当我们将它们全部转换为世界时，我们将得到相同的结果。对？

```
a.ToUniversalTime: 10/2/2009 9:30:00 PM
b.ToUniversalTime: 10/2/2009 9:30:00 PM
c.ToUniversalTime: 10/2/2009 2:30:00 PM 
```

所以发生了什么事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T22:26:47.727

从[http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx)：

> 从 .NET Framework 2.0 版开始，ToUniversalTime 方法返回的值由当前 DateTime 对象的 Kind 属性确定。

*   Kind == Utc - 不执行转换
*   Kind == Local or Unspecified - 根据当地时区进行转换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:20:05.810

我敢打赌，这与 c 处于与 a 和 b 不同的时区有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T22:58:44.237

我同意，c 在不同的时区。

```
 Dim a As DateTime = #10/2/2009 2:30:00 PM#
    Dim b As DateTime = #10/2/2009 2:30:00 PM#
    Dim c As DateTime = #10/2/2009 2:30:00 PM#

    If Not (a = b AndAlso b = c AndAlso c = a) Then Stop
    a = a.ToUniversalTime
    b = b.ToUniversalTime
    c = c.ToUniversalTime

    If Not (a = b AndAlso b = c AndAlso c = a) Then Stop
    'reach here no problem, so one of them was in a different timezone 
```

# visual-studio-2005 - 如何从 Visual Studio 禁用即时调试器

> ID：668218
> 
> 赞同：3
> 
> 时间：2009-03-20T22:19:16.047
> 
> 标签：visual-studio-2005, debugging

从添加/删除程序中卸载了 Visual Studio 及其所有组件。但是现在每次发生崩溃时，它都会弹出即时调试器，这似乎是视觉工作室的剩余部分......

卸载VS后如何删除它？

发现可以通过删除以下键来禁用弹出窗口

```
 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug\Debugger

  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\DbgManagedDebugger 
```

但这不会将其从系统中删除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-21T18:47:19.493

**回答：** 显然，删除上面的 regkeys 是否完全“删除”了 VS 即时调试器，我发现重新启用 windows 默认值，watson 博士解决了我的程序由于 VS 卸载后离开调试器而崩溃的问题。

这可以通过遵循[microsoft 的这些说明](http://support.microsoft.com/kb/188296)来完成。

向下滚动到“**启用 Dr. Watson** ”

# python - 有人可以解释 Gtk2 包装吗？

> ID：668226
> 
> 赞同：2
> 
> 时间：2009-03-20T22:24:32.477
> 
> 标签：python, ruby, pygtk, packing, gtk2

我需要将 Gtk2 用于一个项目。我将为此使用 python/ruby。问题是包装对我来说似乎有点神秘。我尝试使用 VBox，以便在我的窗口中有以下小部件（按以下顺序）：

*   菜单栏
*   工具栏
*   文本视图/编辑器控制

我已经设法“猜测”了我的方式`pack_start`并获得了我需要的布局，但我希望能够理解它。[Ruby Gtk2](http://ruby-gnome2.sourceforge.jp/)上的文档似乎太不直观了（python 也是如此，因为它是相同的，只为 python 编写），你能解释一下吗？

此外，`set_size_request`当我使用`pack_start`. 这是为什么 ？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-21T09:29:09.557

盒子包装*真的很*简单，所以也许你没有理解它是因为你想象它比它更复杂。

布局要么是垂直的（像一堆砖头），要么是水平的（像一群人）。该布局中的每个元素都可以扩展或不能扩展。

水平（HBox）

```
[widget][widget][widget][widget] 
```

垂直（VBox）

```
[widget]
[widget]
[widget]
[widget] 
```

例如，一个带有两个按钮的水平布局（HBox），代码如下：

```
import gtk
box = gtk.HBox()
b1 = gtk.Button('button1')
b2 = gtk.Button('button2')
box.pack_start(b1)
box.pack_start(b2) 
```

现在，由于包装的默认设置是 have `expand=True`，添加到框中的两个按钮都将展开，它们将各自占据一半的区域。不管容器大小。我认为这是“有弹性的”。

扩展小部件：

```
[[    widget    ][    widget    ]] 
```

因此，如果您希望其中一个按钮不展开，您可以这样打包：

```
box.pack_start(b1, expand=False) 
```

非扩展小部件：

```
[[widget][        widget        ]] 
```

然后按钮将只占用它需要绘制自己的空间：文本 + 边框 + 阴影 + 图像（如果有）等。另一个按钮将扩展以填充剩余区域。通常，按钮不需要展开，因此更真实的情况是您希望展开以填充窗口的 TextArea。

另一个可以传递`pack_start`的参数是填充参数，通常可以忽略。在这里说 if `expand=False`then`fill`参数被完全忽略就足够了（因为在那种情况下它没有意义）。

你提到的另一件事是`set_size_request`。我通常会说这不是一个好主意。我说一般，因为在某些情况下您需要使用它。但是对于刚开始打包 GTK+ 用户界面的人，我强烈建议不要使用它。一般来说，让盒子和其他容器为您处理您的布局。`set_size_request`并不完全符合您的预期。它不会改变小部件的大小，而只会改变它需要多少空间。它可能会使用更多，甚至可以拉伸以填充更大的空间。它很少会小于请求，但同样因为它只是一个“请求”，所以不能保证请求会被满足。

# ios - Objective-C 中的字符串替换

> ID：668228
> 
> 赞同：282
> 
> 时间：2009-03-20T22:26:39.147
> 
> 标签：ios, objective-c, iphone, nsstring

如何替换一个字符是Objective-C中的字符串？

* * *

## 回答 #1

> 赞同：799
> 
> 时间：2009-03-20T22:39:50.410

您可以使用该方法

```
- (NSString *)stringByReplacingOccurrencesOfString:(NSString *)target 
                                        withString:(NSString *)replacement 
```

...获取替换子字符串的新字符串（请参阅[`NSString`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/20000154-SW25)其他人的文档）

示例使用

```
NSString *str = @"This is a string";

str = [str stringByReplacingOccurrencesOfString:@"string"
                                     withString:@"duck"]; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-20T22:39:32.283

`NSString`对象是不可变的（它们不能更改），但是有一个可变的子类 ，[`NSMutableString`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSMutableString_Class/Reference/Reference.html#//apple_ref/occ/cl/NSMutableString)它为您提供了几种替换字符串中字符的方法。这可能是你最好的选择。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-09-18T13:25:18.507

如果要替换多个字符串：

```
NSString *s = @"foo/bar:baz.foo";
NSCharacterSet *doNotWant = [NSCharacterSet characterSetWithCharactersInString:@"/:."];
s = [[s componentsSeparatedByCharactersInSet: doNotWant] componentsJoinedByString: @""];
NSLog(@"%@", s); // => foobarbazfoo 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-09-24T16:20:32.063

它还可以用 stringByReplacingCharactersInRange:withString 替换字符串：

```
for (int i = 0; i < card.length - 4; i++) {

    if (![[card substringWithRange:NSMakeRange(i, 1)] isEqual:@" "]) {

        NSRange range = NSMakeRange(i, 1);
        card = [card stringByReplacingCharactersInRange:range withString:@"*"];

    }

} //out: **** **** **** 1234 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-02T06:23:03.463

问题存在于 iOS 上的旧版本中。最近，从右到左的效果很好。我所做的如下：

首先我检查iOS版本：

```
if (![self compareCurVersionTo:4 minor:3 point:0]) 
```

比：

```
// set RTL on the start on each line (except the first)  
myUITextView.text = [myUITextView.text stringByReplacingOccurrencesOfString:@"\n"
                                                           withString:@"\u202B\n"]; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-04-18T10:37:05.550

```
NSString *stringreplace=[yourString stringByReplacingOccurrencesOfString:@"search" withString:@"new_string"]; 
```

# mysql - MySQL 中的自定义 XPath

> ID：668231
> 
> 赞同：2
> 
> 时间：2009-03-20T22:27:16.790
> 
> 标签：mysql, database, xpath

我想知道是否有人构建了一个自定义脚本或存储过程来接受一个字段和一个 XPath 表达式来返回。即使真的很笨拙，我也会接受。

像这样的东西：

```
FindByXPath(fieldName, query); 
```

我会给出值：

```
FindByXPath([xmlContent], '/root/customer/country[@attribute]'); 
```

我只需要基本的节点和属性选择。我正在使用 MySQL 5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T22:28:01.173

升级到 MySQL 5.1。它支持[ExtractValue(xml_frag, xpath_expr)](http://dev.mysql.com/doc/refman/5.1/en/xml-functions.html#function_extractvalue)

# jquery - jQuery 和原型冲突

> ID：668232
> 
> 赞同：1
> 
> 时间：2009-03-20T22:27:20.333
> 
> 标签：jquery, prototypejs, conflict

我正在尝试同时使用 jQuery 和 Prototype。

我花了几个小时寻找解决方案来解决这个问题。我发现的最常见的方法是这个[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)。但是，无论我如何放置“jQuery.noConflict()”代码，它都不起作用。

谁能帮我这个？

提前致谢

这是我的代码

```
<script type="text/javascript" src="/js/swfobject.js">
</script>
<script type="text/javascript" src="/js/layerswitch.js">
</script>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
    _uacct = "UA-2351815-2";
    urchinTracker();
</script>
<script type="text/javascript" src="/js/jquery-1.3.2.min.js">
</script>
<script type="text/javascript" src="/js/fadeLinks.js">
</script>
<script>
    jQuery.noConflict();
    jQuery(document).ready(function($){
      $("#example").autocomplete(options);
    });
</script>
<script src="js/prototype.js" type="text/javascript">
</script>
<script src="js/scriptaculous/scriptaculous.js" type="text/javascript">
</script>
<script src="js/recommended_items.js" type="text/javascript">
</script>
<script type="text/javascript">
//<![CDATA[
Event.observe(window, 'load', function() {
    var recommended_items = new RecommendedItems('recommended_items', <?="$store_id, $gift_registry_id" ?>);
    recommended_items.setBaseURL('<?=$site_server . SITE_STANDARD ?>');
<?php   if (THIS_PAGE == PRODUCT_PHP) { ?>
    recommended_items.setProduct(<?="$product_id, $category_id" ?>);
<?php   }                               ?>
    recommended_items.fetchItems();
});
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T22:35:23.340

像这样包装你的 jQuery 代码

```
(function($) {

//$.noConflict(); // I don't below this is needed following this pattern

$(function() // shorthand for $(document).ready()
{
    $("#example").autocomplete(options);
});

})(jQuery); 
```

本质上`$`是指`jQuery`函数内部的对象

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T22:42:01.873

您可以将您对 jQuery.noConflict() 的调用分配给一个变量，然后在您想要使用 JQuery 时始终使用该变量。所以：

```
 <script>
    var $$ = jQuery.noConflict();
    jQuery(document).ready(function($){
      $$("#example").autocomplete(options);  //jQuery selector
      alert($("#example".val());  //prototype selector
    });
</script> 
```

# python - ffmpeg 作为视频静止提取的 cli 工具的替代品？

> ID：668240
> 
> 赞同：0
> 
> 时间：2009-03-20T22:31:43.707
> 
> 标签：python

我需要从视频文件中提取静止图像。目前我正在使用 ffmpeg，但我正在寻找一个更简单的工具以及我的同事可以安装的工具。无需从 svn checkout 编译它。

有什么提示吗？一个python接口会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T01:58:31.213

您的要求“cli 工具”和“python 接口”并不完全兼容。你要哪个？

以下媒体库都具有 Python 绑定：[GStreamer](http://www.gstreamer.org/)、[libVLC](http://www.videolan.org/)（[pyvlc](http://code.google.com/p/pyvlc/)提供 w32 二进制文件）、[Xine](http://www.xine-project.org/)（通过[Pyxine](http://pyxine.sourceforge.net/)）。不过，我很确定它们都不会比使用[ffmpeg](http://www.ffmpeg.org/)或[mplayer](http://www.mplayerhq.hu/)命令行工具更容易。

关于ffmpeg：为什么不止一个人需要从svn checkout（或tarball，因为他们最近发布了[0.5](http://www.ffmpeg.org/releases/ffmpeg-0.5.tar.bz2)版本）编译？获取或制作一个二进制包，让每个人都使用它。

# iphone - UITouch 移动速度检测

> ID：668247
> 
> 赞同：11
> 
> 时间：2009-03-20T22:37:31.103
> 
> 标签：iphone, objective-c

我正在尝试检测触摸移动的速度，但我并不总是得到我期望的结果。***（补充：速度飙升太多）***如果我在做一些时髦的事情，任何人都可以发现或提出更好的方法吗？

```
 - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    self.previousTimestamp = event.timestamp;
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:self.view];
    CGPoint prevLocation = [touch previousLocationInView:self.view];
    CGFloat distanceFromPrevious = distanceBetweenPoints(location,prevLocation);
    NSTimeInterval timeSincePrevious = event.timestamp - self.previousTimestamp;
    CGFloat speed = distanceFromPrevious/timeSincePrevious;
    self.previousTimestamp = event.timestamp;
    NSLog(@"dist %f | time %f | speed %f",distanceFromPrevious, timeSincePrevious, speed);

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-21T02:46:34.857

您可以尝试（在 touchesBegan 中将 distanceSinceStart 和 timeSinceStart 归零）：

```
distanceSinceStart = distanceSinceStart + distanceFromPrevious;
timeSinceStart = timeSincestart + timeSincePrevious;
speed = distanceSinceStart/timeSinceStart; 
```

这将为您提供自您开始触摸以来的平均速度（总距离/总时间）。

或者你可以做一个速度的移动平均线，也许是指数移动平均线：

```
const float lambda = 0.8f; // the closer to 1 the higher weight to the next touch

newSpeed = (1.0 - lambda) * oldSpeed + lambda* (distanceFromPrevious/timeSincePrevious);
oldSpeed = newSpeed; 
```

如果你想给最近的值更多的权重，你可以将 lambda 调整为接近 1 的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T11:36:06.670

主要问题是速度计算在非常小时（几毫秒）时会非常*不准确。*`timeSincePrevious`要看到这一点，假设`timeSincePrevious`是 1ms。如果 为 0，则计算的速度将为`distanceFromPrevious`0，如果为 1，则计算速度为 1000 `distanceFromZero`。

出于这个原因，我建议使用以下 lambda 值：

> ```
> const float labmda = (timeSincePrevious>0.2? 1: timeSincePrevious/0.2); 
> ```

也就是说，当 较小时，我们使用一个很小的 ​​lambda `timeSincePrevious`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T12:30:23.893

过滤器建议可能没问题，但它不能解决问题：峰值将被平滑，但仍然存在。

如果您注销了触摸事件，这些峰值将看起来像与之前（0.001215 ms）相比具有非常小的时间增量的触摸，然后是具有较大时间增量的触摸。

```
距离 = 17.269917，时间增量 = 0.016132，速度 = 1070.504639
距离 = 15.206906，timeDelta = 0.017494，速度 = 869.251709
距离 = 15.882380，timeDelta = 0.017583，速度 = 903.297546
distance = 14.983324, timeDelta = 0.030101, speed = 497.771088 //低峰值
distance = 15.435349, timeDelta = 0.001215, speed = 12703.991211 //高峰值！
距离 = 15.882380，timeDelta = 0.017343，速度 = 915.795898
距离 = 15.890248，timeDelta = 0.016302，速度 = 974.742249
距离 = 16.560495，timeDelta = 0.016468，速度 = 1005.606445
距离 = 16.101242，timeDelta = 0.017291，速度 = 931.201050

```

我所做的是计算最近触摸事件之间的平均时间增量，如果有一个具有异常时间增量（±30%）的触摸，我忽略它的速度（保持上一个事件的速度）

# email - Excel 宏发送电子邮件

> ID：668255
> 
> 赞同：3
> 
> 时间：2009-03-20T22:39:50.567
> 
> 标签：email, excel, vba

我有一份报告，我想通过 excel 发送。它将包括收件人、主题和正文中的信息。实际上它可以复制有问题的单元格。到目前为止我所做的是创建一个按钮并使用以下代码为其分配一个宏：

```
Private Sub CommandButton1_Click()
 Application.Dialogs(xlDialogSendMail).Show arg1:=Sheets("Sheet1").Range("E3"), _
                      arg2:=Sheets("Sheet1").Range("E7")

End Sub 
```

问题是此命令将工作簿作为附件发送。

有人可以帮助我编写允许我执行此操作的代码。

太感谢了！

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T18:50:43.043

设置对“Microsoft Outlook xx.x 对象库”的引用，您可以将此代码用作构建或发送电子邮件的示例：

因为它只会显示电子邮件而不发送。您可以注释掉 .display 行并取消注释 .send 以发送它。

```
Sub EmailFromExcel()
    On Error GoTo PROC_EXIT
    Dim OL As New Outlook.Application

    Dim olMail As Outlook.MailItem
    Set olMail = OL.CreateItem(olMailItem)

    Dim SrcSheet As Excel.Worksheet
    Set SrcSheet = Sheets("Sheet1")

    With olMail
        .To = SrcSheet.Range("E3").Text
        .Subject = SrcSheet.Range("E7").Text
        .Body = SrcSheet.Range("E12").Text
        .Display vbModal
        '.Send
    End With

 PROC_EXIT:
    On Error GoTo 0
    OL.Quit
    Set OL = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:00:26.320

添加对outlook com库的引用；然后您可以将所需的值复制/粘贴到新工作表中并将其格式化，然后将其复制到 Outlook 邮件中。

# python - Python：简单的异步下载 url 内容？

> ID：668257
> 
> 赞同：9
> 
> 时间：2009-03-20T22:40:42.233
> 
> 标签：python, asynchronous

我有一个响应各种用户请求的 web.py 服务器。其中一个请求涉及下载和分析一系列网页。

有没有一种简单的方法可以在 web.py 中设置基于异步/回调的 url 下载机制？低资源使用率尤其重要，因为每个用户发起的请求都可能导致下载多个页面。

流程看起来像：

用户请求 -> web.py -> 并行或异步下载 10 个页面 -> 分析内容，返回结果

我认识到 Twisted 是一种很好的方法，但我已经在 web.py 中，所以我对可以放入 web.py 的东西特别感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-19T16:31:56.113

这是一段有趣的代码。我自己没有使用它，但它看起来不错；）

[https://github.com/facebook/tornado/blob/master/tornado/httpclient.py](https://github.com/facebook/tornado/blob/master/tornado/httpclient.py)

低级 AsyncHTTPClient：

“一个支持 pycurl 的非阻塞 HTTP 客户端。示例用法：”

```
import ioloop

def handle_request(response):
    if response.error:
        print "Error:", response.error
    else:
        print response.body
    ioloop.IOLoop.instance().stop()

http_client = httpclient.AsyncHTTPClient()
http_client.fetch("http://www.google.com/", handle_request)
ioloop.IOLoop.instance().start() 
```

" fetch() 可以接受字符串 URL 或 HTTPRequest 实例，它提供更多选项，例如执行 POST/PUT/DELETE 请求。

AsyncHTTPClient 构造函数的关键字参数 max_clients 确定可以在每个 IOLoop 上并行执行的同时 fetch() 操作的最大数量。"

还有一个新的实现正在进行中： [https](https://github.com/facebook/tornado/blob/master/tornado/simple_httpclient.py) ://github.com/facebook/tornado/blob/master/tornado/simple_httpclient.py “没有外部依赖的非阻塞HTTP客户端......这个类仍在开发中尚未推荐用于生产用途。”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T05:02:48.447

一种选择是将工作发布到某种队列中（您可以使用像[ActiveMQ](http://activemq.apache.org/)这样的 Enterprisey和[pyactivemq](http://code.google.com/p/pyactivemq/)或[STOMP](http://stomp.codehaus.org/)作为连接器，或者您可以使用像[Kestrel](http://github.com/robey/kestrel/tree/master)这样的轻量级的东西，它是用 Scala 编写的，并且使用与 memcache 相同的协议，所以您可以只使用 python memcache 客户端与之交谈）。

设置好队列机制后，您可以创建订阅队列的尽可能多或尽可能少的工作任务，并根据需要执行实际的下载工作。您甚至可以将它们安装在其他机器上，这样它们就不会影响您网站的服务速度。当工作人员完成后，他们将结果发布回数据库或网络服务器可以获取它们的另一个队列。

如果您不想管理外部工作进程，那么您可以在运行 Web 服务器的同一个 python 进程中创建工作线程，但显然它将有更大的潜力影响您的网页服务性能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-23T08:56:24.027

您也许可以使用[`urllib`](http://docs.python.org/library/urllib.html)下载文件和[`Queue`](http://docs.python.org/library/queue.html)模块来管理多个工作线程。例如：

```
import urllib
from threading import Thread
from Queue import Queue

NUM_WORKERS = 20

class Dnld:
    def __init__(self):
        self.Q = Queue()
        for i in xrange(NUM_WORKERS):
            t = Thread(target=self.worker)
            t.setDaemon(True)
            t.start()

    def worker(self):
        while 1:
            url, Q = self.Q.get()
            try:
                f = urllib.urlopen(url)
                Q.put(('ok', url, f.read()))
                f.close()
            except Exception, e:
                Q.put(('error', url, e))
                try: f.close() # clean up
                except: pass

    def download_urls(self, L):
        Q = Queue() # Create a second queue so the worker 
                    # threads can send the data back again
        for url in L:
            # Add the URLs in `L` to be downloaded asynchronously
            self.Q.put((url, Q))

        rtn = []
        for i in xrange(len(L)):
            # Get the data as it arrives, raising 
            # any exceptions if they occur
            status, url, data = Q.get()
            if status == 'ok':
                rtn.append((url, data))
            else:
                raise data
        return rtn

inst = Dnld()
for url, data in inst.download_urls(['http://www.google.com']*2):
    print url, data 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T05:11:00.283

我只是在twisted 中构建一个服务，该服务执行并发获取和分析，并从web.py 作为一个简单的http 请求访问它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-26T11:05:13.290

Nowadays there are excellent Python libs you might want to use - [urllib3](http://urllib3.readthedocs.org/) (uses thread pools) and [requests](http://docs.python-requests.org/) (uses thread pools through urllib3 or non blocking IO through [gevent](http://www.gevent.org/))

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-23T08:24:40.720

使用使用 asynchat 和 asyncore 的 async http 客户端。 [http://sourceforge.net/projects/asynchttp/files/asynchttp-production/asynchttp.py-1.0/asynchttp.py/download](http://sourceforge.net/projects/asynchttp/files/asynchttp-production/asynchttp.py-1.0/asynchttp.py/download)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-21T00:39:24.883

我不确定我是否理解你的问题，所以我会给出多个部分答案。

*   如果您担心 web.py 必须从某个地方下载数据并在响应之前分析结果，并且您担心在结果准备好之前请求可能会超时，您可以使用 ajax 来拆分工作。立即返回一个容器页面（保存结果）和一些 javascript 来轮询服务器以获取结果，直到客户端拥有所有结果。因此客户端从不等待服务器，尽管用户仍然必须等待结果。
*   如果您担心的是捆绑服务器等待客户端获得结果，我怀疑这是否真的是一个问题。您的网络层不应该要求您等待写入
*   如果您担心服务器在客户端从其他地方下载静态内容时等待，那么 ajax 或巧妙地使用重定向应该可以解决您的问题

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-21T00:53:59.450

我不知道这是否真的有效，但它看起来可能：[EvServer：Python 异步 WSGI 服务器](http://code.google.com/p/evserver/)有一个[web.py 接口](http://code.google.com/p/evserver/source/browse/trunk/evserver/examples/framework_webpy.py)，可以向浏览器客户端进行彗星式推送。

如果这不正确，也许您可​​以使用[Concurrence HTTP 客户端](http://opensource.hyves.org/concurrence/http.html)异步下载页面，并弄清楚如何通过 ajax 或 Comet 将它们提供给浏览器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-21T03:08:26.787

按照 MarkusQ 的回答，MochiKit[是](http://mochikit.com/)一个不错的 JavaScript 库，具有受 Twisted 启发的强大异步方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-21T04:09:41.787

实际上，您可以将twisted 与web.py 集成。我不太确定我是怎么做的，因为我只用 django 完成了它（与它一起使用扭曲）。

# algorithm - 算法问题：需要随着时间从 00FF00 动态递增到 FF0000，C#/Java

> ID：668263
> 
> 赞同：5
> 
> 时间：2009-03-20T22:42:48.877
> 
> 标签：algorithm, colors, hex

我想随着时间的推移（240 小时）将颜色从亮绿色更改为深红色。我能看到的最好方法是将十六进制组合从 00FF00 更改为 FF0000。

我不知道如何在我的一生中从 00FF00 动态地计数到 FF0000。我正在查看超过 10 天的时间段，因此很可能需要超过 240 小时才能增加。

谁能帮我吗？

我从来没有上过算法课，所以我认为这可能与这个问题有关。

如果您有更好的方法来做到这一点，请告诉我。

我在这里寻找某种代码。多谢你们。它可以是任何语言，但不可避免地会转换为 C#。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-21T19:01:29.197

如果您按照十六进制值的建议从亮色变为亮色，那么您可能希望在[HSV 空间](http://en.wikipedia.org/wiki/HSL_color_space)而不是 RGB 空间中进行插值。HSV 空间近似于我们对颜色的看法——色调、饱和度和值。RGB 空间近似于我们眼睛中光敏细胞的工作方式。

上梯度是从 FF0000 到 00FF00 的线性 RGB 插值。它的中间值为7f7f00，一种泥褐色。

中间梯度是 HSV 空间中的线性插值。由于 FF0000 和 00FF00 都完全饱和并且具有相同的值（亮度），因此插值始终保持相同的亮度和饱和度，因此中心值是亮黄色 ffff00。

第三种选择是 RGB 空间中的矢量旋转，这意味着中间值为 B4B400，（B4 hex = 180 dec = 255 / sqrt(2)），介于两种效果之间。这是通过计算每个端点的大小来完成的，然后缩放 RGB 线性插值的结果，使其具有相同的大小，有效地扫过两种颜色和原点平面中的弧线中的向量。由于我们实际上并没有对不同颜色的亮度进行同等加权，或者线性观察，这并不精确，但它的扫描强度确实相当均匀，而 HSV 在中间稍微轻一点，因为它有两个值100%。

*删除了死的Imageshack链接*

* * *

在 Java 中，如果您有 HSB 支持，算法很简单 - 获取最终值的 HSB，像在其他 RGB 答案中一样对它们进行线性插值，然后使用 h、s、v 值转换创建颜色：

```
static Color hsvInterpolate ( float mix, Color c0, Color c1 ) {
    float[] hsv0 = new float[3];
    float[] hsv1 = new float[3];

    float alt = 1.0f - mix;

    Color.RGBtoHSB( c0.getRed(), c0.getGreen(), c0.getBlue(), hsv0 );
    Color.RGBtoHSB( c1.getRed(), c1.getGreen(), c1.getBlue(), hsv1 );

    float h = mix * hsv0 [ 0 ] +  alt * hsv1 [ 0 ];
    float s = mix * hsv0 [ 1 ] +  alt * hsv1 [ 1 ];
    float v = mix * hsv0 [ 2 ] +  alt * hsv1 [ 2 ];

    return Color.getHSBColor ( h, s, v );
} 
```

我不相信 C# 具有内置的转换功能，因此代码实际上并没有多大用处。

```
static Color vectorInterpolate ( float mix, Color c0, Color c1 ) {
    float alt = 1.0f - mix;

    double x0 = c0.getRed();
    double y0 = c0.getGreen();
    double z0 = c0.getBlue();

    double x1 = c1.getRed();
    double y1 = c1.getGreen();
    double z1 = c1.getBlue();

    double mag0 = sqrt( x0*x0 + y0*y0 + z0*z0 );
    double mag1 = sqrt( x1*x1 + y1*y1 + z1*z1 );

    double x = mix * x0 + alt * x1;
    double y = mix * y0 + alt * y1;
    double z = mix * z0 + alt * z1;

    double mag  = mix * mag0 + alt * mag1;
    double scale = mag / sqrt( x*x + y*y + z*z );

    return new Color ( 
        clamp ( x * scale ),
        clamp ( y * scale ),
        clamp ( z * scale ) );
}

static int clamp ( double value ) {
    int x = (int) round ( value );

    if ( x > 255 ) return 255;
    if ( x < 0 ) return 0;
    return x;
} 
```

您可能希望找到向量与 RGB 立方体边缘的交点，而不是简单地夹紧它，但在这种情况下，这两种方式都无关紧要。

* * *

作为附录，还值得考虑 HSY 空间，它更接近于感知亮度，如[Dave Green 的立方体螺旋](https://www.mrao.cam.ac.uk/~dag/CUBEHELIX/)颜色插值所示。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-20T22:45:41.037

只需从组件的角度考虑它。尽管它看起来像一个大的十六进制数，但它实际上是三个并排的。

开始时红色为 0，绿色为 255（FF），蓝色为 0。
最后，红色为 255，绿色为 0，蓝色为 0。

因此，每（您拥有的时间量 / 255），红色加 1，绿色减 1。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T22:51:10.493

time_remaining（值从 0 到 239 不等）

绿色 = 255 * (time_remaining / 239)
红色 = 255 - 绿色
蓝色 = 0

颜色 =（红、绿、蓝）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-08T15:53:17.530

这是一个从红色到绿色的快速java答案（你可以更改它）值是当前`value`时间，`all`是时间的总和......

```
public static String progressiveColor(int value, int all){

    int red = 255 - (int)((float)(value*255)/(float)all);
    int green = (int)((float)(value*255)/(float)all);
    return String.format("#%06X", (0xFFFFFF & Color.argb(255, red, green, 0)));

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-25T06:23:12.067

这是 Pete 翻译成 C# 的 Java 代码，以防万一有人在寻找它。它非常适合我的目的（黑色到深红色和背面）。

```
 static Color VectorInterpolate(float mix, Color c0, Color c1)
    {
        float alt = 1.0f - mix;

        double x0 = c0.R;
        double y0 = c0.G;
        double z0 = c0.B;

        double x1 = c1.R;
        double y1 = c1.G;
        double z1 = c1.B;

        double mag0 = Math.Sqrt(x0 * x0 + y0 * y0 + z0 * z0);
        double mag1 = Math.Sqrt(x1 * x1 + y1 * y1 + z1 * z1);

        double x = mix * x0 + alt * x1;
        double y = mix * y0 + alt * y1;
        double z = mix * z0 + alt * z1;

        double mag = mix * mag0 + alt * mag1;
        double scale = mag / Math.Sqrt(x * x + y * y + z * z);

        return Color.FromRgb(Clamp(x * scale), Clamp(y * scale), Clamp(z * scale));
    }

    static byte Clamp(double value)
    {
        var x = (int)Math.Round(value);

        if (x > 255) return 255;
        if (x < 0) return 0;
        return (byte) x;
    } 
```

# .net - .Net ThreadPool 线程的异常

> ID：668265
> 
> 赞同：4
> 
> 时间：2009-03-20T22:43:30.247
> 
> 标签：.net, exception, threadpool, unhandled-exception

重复： [如何从 ThreadPool.QueueUserWorkItem 中捕获异常？](https://stackoverflow.com/questions/753841)

* * *

我在 .Net ThreadPool 上为大量独立的远程调用排队多个委托，这些调用本身调用多个数据库和其他离线资源。通过在 ThreadPool 上排队这些调用，我可以同时运行它们并最小化整体延迟。

```
private void CompleteAndQueuePayLoads(IEnumerable<UsagePayload> payLoads)
{
    List<WaitHandle> waitHndls = new List<WaitHandle>();
    foreach (UsagePayload uPyLd in payLoads)
    {
        ManualResetEvent txEvnt = new ManualResetEvent(false);
        UsagePayload uPyLd1 = uPyLd ;
        ThreadPool.QueueUserWorkItem(
            delegate
                {
                    if (!uPyLd1 .IsComplete)
                        // IEEDAL.GetPayloadReadings is long running DB call
                        try { IEEDAL.GetPayloadReadings(uPyLd1 ); }
                        catch (IEEAccessException iX)
                        {
                            log.Write(log.Level.Error,
                                  "IEEWSDAL.CompleteAndQueuePayLoads " + 
                                   " Delegate Failed " +
                                  iX.Message, iX);
                            txEvnt.Set();
                            throw;  // this causes parent thread to crash!
                            // was going to try Thread.Abort next ...
                            // Thread.CurrentThread.Abort();
                        }
                    UsageCache.PersistPayload(uPyLd1 );
                    SavePayLoadToProcessQueueFolder(uPyLd1 );
                    txEvnt.Set();
                });
        waitHndls.Add(txEvnt);
    }
    util.WaitAll(waitHndls.ToArray()); //To waitone on > 64 waithandles
} 
```

但是整个批处理需要事务处理，IE，只有在所有子线程都成功的情况下，才需要允许父线程的输出继续进行。我已经将子线程编码为在失败时引发自定义异常，但我发现这会导致父线程崩溃，因为这些异常不能在父线程中“捕获”......

我已经阅读了发生这种情况时 CLR 抛出的 UnHandledExceptionEvent 的信息，但是我需要在这些子线程排队和产生的方法中“处理”这个异常，以根据孩子的成功控制立即的下游处理threeads... 我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T22:58:02.567

如果线程失败，您可以在 CompleteAndQueuePayLoads 函数的局部变量中标记至少发生一次失败，并添加异常/失败变量以供稍后检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T01:04:29.470

我在当前的项目中经常这样做。我采用的方法是制作自己的调度程序来接收委托，将其添加到我自己的队列中，然后运行它们以在最后处理同步等。

我在这种情况下使用的“技巧”是不要直接在线程池上调用委托，而是在我的调度程序中调用一个方法来包装委托并更优雅地处理异常。这样，实际的内部方法调用总是以适当的（对我而言）方式处理。

当异常发生时，我的调度程序会收到通知并停止调度未来的任务（这是一个很好的奖励），但也会告诉调用者有一个异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-29T05:31:55.537

您可能会查看 3.5 的并行库扩展。您可以在代码块上使用 Parallel.Invoke 来完成您正在尝试的操作。

# c# - C# - 处理 html 标签属性

> ID：668267
> 
> 赞同：0
> 
> 时间：2009-03-20T22:44:17.233
> 
> 标签：c#, .net, html, regex

我从远程服务器获取一些 html 数据，在应用程序的 UI 中显示它之前，我需要进行一些更改，即删除计数器、替换链接等。删除一些带有内容的标签并更改特定链接并不是什么大问题，但是当涉及到一些高级处理时，我遇到了一些问题。需要替换（删除）一些 html 标记属性（不是标记本身 - 互联网上有很多关于此的示例）。例如：从按钮中删除所有 onmouseover 处理程序。我知道 XPath 非常适合解决此类问题，但我根本不知道，虽然我的信息是 XHTML 投诉的，但它存储在字符串变量中并且不可查询:(。所以我正在尝试使用正则表达式来解决这个问题，目前没有成功。我猜这是模式的错误......

```
public string Processing (string Source, string Tag, string Attribute)
{    
return System.Text.RegularExpressions.Regex.Replace(Source, string.Format(@"<{0}(\s+({1}=""([^""]*)""|\w+=(""[^""]*""|\S+)))+>", Tag, Attribute), string.Empty);
}

...

string before = @"<input type=""text"" name=""Input"" id=""Input"" onMouseOver=""some js to be eliminated"">";
string after = Processing(before,"input","onMouseOver");
// expected : <input type="text" name="Input" id="Input">" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T05:25:09.843

这是一种有趣的方法，但就像 bobince 所说，每次匹配只能处理一个属性。此正则表达式会将所有内容与您感兴趣的属性相匹配：

```
@"(<{0}\b[^>]*?\b){1}=""(?:[^""]*)""" 
```

然后，您使用“$1”作为替换字符串来插入除属性之外的所有内容。

这种方法要求您对每个目标标记/属性对的字符串进行单独的传递，并且在每次传递的开始，您必须创建和编译正则表达式。效率不是很高，但如果字符串不是太大应该没问题。一个更大的问题是它不会捕获重复的属性。如果一个按钮上有两个“onmouseover”属性，你只会抓住第一个。

如果我在 C# 中执行此操作，我可能会使用正则表达式来匹配目标标记，然后使用 MatchEvaluator 一次删除所有目标属性。但说真的，如果字符串真的是格式良好的 XML，那么没有理由不使用特定于 XML 的工具来处理它——这就是 XML 的*发明*目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:23:40.900

我觉得你的方法太简单了。使用正则表达式解析 HTML 可能比您想象的要困难得多。我建议你[看看这个问题。](https://stackoverflow.com/questions/100358/looking-for-c-html-parser)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T23:51:01.113

> 我知道 XPath 非常适合此类问题

这么。或者任何其他基于 XML 解析器的技术，例如 DOM 方法。

学习这真的不是一件难事：将您的字符串填充到[XmlDocument.LoadXml()](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.loadxml.aspx)方法中，然后使用类似 '//tagname[@attrname]' 的方式调用它的[selectNodes()以获取具有不需要的属性的元素列表。](http://msdn.microsoft.com/en-us/library/hcebdtae.aspx)皮斯。

> 我正在尝试使用正则表达式来解决这个问题，但没有成功

正则表达式是什么？即使他们知道这是错误的事情，人们仍然继续使用它们，即使它们经常难以理解并且难以正确（正如无休止的“为什么我的正则表达式不起作用？”问题证明）。

那么这些该死的东西有什么吸引人的地方呢？SO上每天都有几个关于用正则表达式解析[X][HT]ML的问题，都回答“不要使用正则表达式，正则表达式不足以解析HTML”。但不知何故，它永远不会通过。

> 估计是模式错误...

好吧，该模式似乎试图匹配整个标签以替换为空字符串，这不是您想要的。相反，您希望只针对属性，然后确保只计算“<tag ...>”内的属性，您必须使用否定的lookbehind 断言——“(?!<tag )”。但是你通常不能有一个可变长度的lookbehind断言，你需要允许其他属性出现在标签名称和目标属性之间。

此外，您的 '\S+' 子句可能会吞噬大量意外内容。由于您拥有格式良好的 XHTML，因此可以保证正确引用的属性，因此无论如何您都不需要它。

但错误不是模式。它是正则表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T10:36:02.420

所以，重写的代码是：

```
public static string Process(string Source, string Tag, string Attribute)
{
        return Regex.Replace(Source, string.Format(@"(<{0}\b[^>]*?\b)({1}=""(?:[^""]*)"")", Tag, Attribute), "$1");                  
} 
```

我已经测试过了，它工作正常。

```
string before = @"<input type=""text"" name=""Input"" id=""Input"" onMouseOver=""some js to be eliminated1""/>"
        + "\r\n" + @"<input type=""text"" name=""Input2"" id=""Input2"" onMouseOver=""some js to be eliminated2"">"
        + "\r\n" + @"<input type=""text"" name=""Input3"" id=""Input3"" onMouseOver=""some js to be eliminated3"">";            
string after = Process(before, "input", "onMouseOver");
//<input type="text" name="Input" id="Input" />
//<input type="text" name="Input2" id="Input2" >
//<input type="text" name="Input3" id="Input3" > 
```

现在问题已经解决了。我会尝试使用与 xml 相关的解决方法，但似乎在创建 XmlDocument 之前我需要再次修改输入 html，因为根据 w3c 验证器它有错误。它开始如下

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
    <HTML xmlns="http://www.w3.org/1999/xhtml">
    <HEAD>
    <TITLE>page title</TITLE> 
```

在 LoadXml 上，我得到“关于 '>' 标记的 System.Xml.XmlException 是不可接受的 - 第 1 行位置 63。添加文档类型定义会导致相同的异常，但这次关于 '--' 标记不正确，需要 '>'。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/strict.dtd"> 
```

有任何想法吗 ？还是放手？）

# winforms - 解决方案文件夹和工具箱项目不兼容？

> ID：668271
> 
> 赞同：1
> 
> 时间：2009-03-20T22:47:06.370
> 
> 标签：winforms, visual-studio-2005

在 Visual Studio 2005 中，我最近将一个包含 30 多个项目的解决方案重新组织到 5 个解决方案文件夹中。但是，自从我这样做之后，我的程序集中的所有自定义控件和用户控件都从 WinForms 工具箱中消失了。

有没有人经历过这个？有解决方法吗？这在 Visual 2008 中修复了吗？我试图重置工具箱，但它仍然无法正确填充工具箱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-14T21:56:35.833

幸运的是，这个问题在 VS2008 中得到了修复。包含您的控件的项目可以放在解决方案文件夹中，它们的控件仍会出现在工具箱中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:54:06.820

您可以右键单击工具箱来添加自定义程序集和命名空间。在您重新构建项目之后，您的工具箱引用的程序集可能会移动？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-16T18:14:19.463

自从您重组解决方案后，您是否构建了解决方案？当您构建控件时，它会快速添加到工具箱中。当您删除构建的输出时（例如通过清理），它会被删除。顺便说一句，快速添加不使用任何 ToolboxItem 类/属性。所以不要指望图标是正确的，等等。

# php - 无法使用php连接到mysql

> ID：668275
> 
> 赞同：12
> 
> 时间：2009-03-20T22:50:20.887
> 
> 标签：php, mysql, xampp, wamp

我似乎无法使用 php 脚本连接到 mysql，即使我可以使用 phpmyadmin 正常连接。我创建了一个带有密码的用户，并为它提供了数据库的适当权限，但每次连接时它都会死，说访问被拒绝。我在 windows xp 盒子上使用 xampp。防火墙都被禁用了，我检查了用户名和密码是否正确。这是代码：

```
$conn=mysql_connect('localhost','westbrookc16','megadots') || die (mysql_error()); 
```

用户名是否必须采用特定格式或其他形式？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-20T23:07:44.930

我有一种预感，这里的问题是您授予它的主机，尽管这实际上只是一个有根据的猜测。如果您授予访问权限 myuser@'127.0.0.1' 或服务器的实际 IP 地址，则不允许您使用 localhost 作为主机进行连接。这是因为当“localhost”被指定为主机时，php 将假定您想要使用 unix 套接字而不是网络套接字，并且在该上下文中 127.0.0.1 与 localhost 不同。

[从mysql_connect()](http://se2.php.net/mysql_connect)的手册条目中：

> 注意：每当您指定“localhost”或“localhost:port”作为服务器时，MySQL 客户端库将覆盖它并尝试连接到本地套接字（Windows 上的命名管道）。如果要使用 TCP/IP，请使用“127.0.0.1”而不是“localhost”。如果 MySQL 客户端库尝试连接到错误的本地套接字，您应该在 PHP 配置中将正确的路径设置为运行时配置，并将服务器字段留空。

希望这不是完全多余的。:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-21T00:26:59.140

我以前见过这种情况，一个 mysql 用户通过 php 登录，而另一个没有。有时用户甚至使用命令行而不是 php。

这一直是埃米尔提到的两个。mysql 用户实际上是用户/主机对。所以用户 megadots@localhost 和用户 megadots@mycoolhost 在 mysql.user 表中作为两个单独的记录列出。

如果您可以从命令行登录，请运行此查询。

```
SELECT user, host FROM mysql.user 
```

您应该会看到用户及其主机的完整列表。

如果您认识正在工作的 phpMyAdmin 用户，请查看可能是您要使用的主机的主机列。

重置主机运行这些查询（！小心使用特权表进行整个mysql安装）

```
update mysql.user set host = 'hostname' 
where user = 'username' and host = 'oldhostname';

flush privileges; 
```

如果您看到一条以用户名和 % 作为主机的记录将优先于其他所有内容，如果该用户有多个记录，并且其中一个以 % 作为主机，则以 % 作为主机的用户名可能有密码错误，无论您重置 username@localhost 的密码多少次，它都是无效的，因为它会在登录时与 username@% 进行比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-19T21:27:01.010

如果您使用的是 Linux，请使用 synaptic 包管理器来查找和下载 PHP 和 MySQL 需要的所有库和模块，以便它们都可以连接。我的问题是单独运行的 PHP 脚本在服务器端工作，但是当我尝试使用 PHP 脚本连接到 MySQL 时，它无法连接，我只会看到一个纯白页面。然后我注意到我没有 PHP 用来连接 MySQL 的 MySQL 客户端库。我只有 MySQL 服务器库。一旦我安装了客户端库并重新启动了 apache 服务器，我的 PHP 脚本连接就没有问题了。默认情况下，PHP 5 不随 MySQL 客户端库一起安装。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-14T21:19:39.530

就我而言，我已经删除了用于创建我正在使用的数据库的用户。通常这应该给出错误“用户指定的定义器不存在”，但由于某种原因，它只是返回了对我的 PHP 代码的更一般的访问被拒绝。我不确定为什么我仍然可以通过命令行和其他界面登录。为了纠正我的问题，我重新创建了被删除的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T23:01:22.233

> 并赋予它适当的数据库权限

如何？授予用户时，您为用户使用了什么主机？

这是通常的做法：

```
GRANT ALL ON mydb.* TO 'someuser'@'somehost' identified by 'password';
FLUSH privileges; 
```

在您的情况下，“somehost”可能应该是“localhost”或“127.0.0.1”（参见其他帖子）

语法参考：[http ://dev.mysql.com/doc/refman/5.1/en/grant.html](http://dev.mysql.com/doc/refman/5.1/en/grant.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T23:03:29.997

这可能是一个错字，或者您没有授予权限。有时很难发现这些。

我建议不要使用 phpmyadmin，而是下载一份[SQLYOG](http://www.webyog.com/en/)（免费社区版很棒）并尝试通过它与您的用户登录。诊断出问题后，将用户名/密码复制/粘贴回您的脚本。

顺便说一句，phpmyadmin 很好，但是像 sqlyog 这样的程序通常更方便，所以无论如何都值得一试——我相信你会被转换的。如果 sqlyog 不太符合您的口味，还有其他几种免费和商业替代品。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-02T19:30:04.250

在遇到类似问题后，我发现将 '127.0.0.1' 替换为 'localhost' 可以解决问题（尽管我能够使用 'localhost' 通过终端成功连接）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-25T21:43:12.940

1.  确保您已使用 MySQL 扩展配置 PHP。在 MacPorts 上，您需要单独安装它：

```
me@lastdance Sites % sudo port search php | grep mysql
php-mysql-xdevapi @8.0.17 (php, devel)
php52-mysql @5.2.17 (php, databases)
a PHP interface to MySQL databases, including the mysql, mysqli and pdo_mysql extensions
php53-mysql @5.3.29 (php, databases)
a PHP interface to MySQL databases, including the mysql, mysqli and pdo_mysql extensions
php54-mysql @5.4.45 (php, databases)
a PHP interface to MySQL databases, including the mysql, mysqli and pdo_mysql extensions
php55-mysql @5.5.38 (php, databases)
a PHP interface to MySQL databases, including the mysql, mysqli and pdo_mysql extensions
php56-mysql @5.6.40 (php, databases)
a PHP interface to MySQL databases, including the mysql, mysqli and pdo_mysql extensions
php70-mysql @7.0.33 (php, databases)
a PHP interface to MySQL databases, including the mysqli and pdo_mysql extensions
php71-mysql @7.1.32 (php, databases)
a PHP interface to MySQL databases, including the mysqli and pdo_mysql extensions
php71-mysql-xdevapi @8.0.17 (php, devel)
php72-mysql @7.2.23 (php, databases)
a PHP interface to MySQL databases, including the mysqli and pdo_mysql extensions
php72-mysql-xdevapi @8.0.17 (php, devel)
php73-mysql @7.3.10 (php, databases)
a PHP interface to MySQL databases, including the mysqli and pdo_mysql extensions
php73-mysql-xdevapi @8.0.17 (php, devel)
me@lastdance Sites % sudo port install php73-mysql
--->  Computing dependencies for php73-mysql
--->  Cleaning php73-mysql
--->  Scanning binaries for linking errors
--->  No broken files found.
--->  No broken ports found.
me@lastdance Sites % 
```

2.  确保在 php.ini 文件中正确指定了 localhost mysql 套接字。看到[我的数据库用户存在，但我仍然得到一个（HY000/2002）：没有这样的文件或目录](https://stackoverflow.com/questions/20073168/my-database-user-exists-but-i-still-get-an-hy000-2002-no-such-file-or-direct)

在我的系统上，我必须编辑文件`/opt/local/etc/php73/php.ini`并添加以下内容：

```
; Default socket name for local MySQL connects.  If empty, uses the built-in
; MySQL defaults.
; http://php.net/mysqli.default-socket
mysqli.default_socket = /opt/local/var/run/mysql8/mysqld.sock 
```

# css - 从 Richfaces 控件中删除渐变

> ID：668279
> 
> 赞同：2
> 
> 时间：2009-03-20T22:51:56.763
> 
> 标签：css, jsf, richfaces, skins

我想使用richfaces 面板，因为它基本上是正确的形状并且是可换肤的，所以我可以更改字体、颜色等。但是，作为默认皮肤的一部分，包含标题的水平条具有渐变。我的设计有一个简单的颜色，没有任何渐变。

如何停止 Richfaces 添加渐变？

如果可能的话，我想从 CSS 中彻底删除对渐变的所有提及，以避免膨胀和额外的 HTTP 图像请求。即我要渲染：

背景颜色：黑色；

什么都没有。

我正在使用插件和皮肤。

* * *

似乎[像这个问题一样](https://stackoverflow.com/questions/622891/how-do-i-stop-richfaces-adding-borders-to-panels-and-calendars)，答案是如果不改变richfaces，它可能是不可能的。感谢您的输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-09-01T14:03:58.013

我意识到我回答这个问题有点晚了，但我想我会提出解决这个问题的方法。

我正在为我的项目使用 RichFaces Plug-n-Skin，并且我可以通过禁用 RichFaces 的控件皮肤来删除所有渐变和预定义样式。这是我的 web 项目的 web.xml 中的一个简单更改。

```
...
<context-param>
    <param-name>org.richfaces.SKIN</param-name>
    <param-value>PlugNSkinName</param-value>
</context-param>

<!-- Suppress stylesheets -->
<context-param>
    <param-name>org.richfaces.CONTROL_SKINNING</param-name>
    <param-value>disable</param-value>
</context-param>

<context-param>
    <param-name>org.richfaces.CONTROL_SKINNING_CLASSES</param-name>
    <param-value>disable</param-value>
</context-param>
... 
```

根据您的需要，这可能有点矫枉过正，但无论如何我都会覆盖我所有 RichFaces 组件上的几乎所有内容。这允许我在我的 Plug-n-Skin 中指定我想要的所有样式，并且不会加载任何我不需要的不必要的默认 RichFace 样式/图像。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T17:02:43.337

[Richfaces 网站](http://www.jboss.org/community/docs/DOC-11860)上有一个示例可以为带有 CSS 的 dataTables 执行此操作。[Rich:panel](http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/devguide/en/html/panel.html)的文档说标题的类是rich-panel-header，所以我认为 CSS 应该是：

```
.rich-panel-header {
     background-image:none;
     background-color:transparent;
} 
```

编辑：值得注意的是，包含这些 mod 的 CSS 必须在加载 Richfaces 皮肤后加载，因为在此之后加载的任何 CSS 都可能使其过载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T15:49:20.577

添加到您的 web.xml 文件中。

```
<context-param>
  <param-name>org.richfaces.SKIN</param-name>
  <param-value>plain</param-value>
</context-param> 
```

然后您可以使用您的插件-n-skin 对其进行修改。

编辑：

RichFaces 有一个内置的皮肤系统，称为 Skinnablity。Skinnability 是标准 CSS 的高级扩展。您可以创建自己的皮肤文件以在您的应用程序中使用（[jboss 文档](http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/devguide/en/html/ArchitectureOverview.html#CreatingAndUsingYourOwnSkinFile)）。

在richfaces-impl jar 中，文件夹/META-INF/skins 包含所有皮肤文件（.skin.properties）。复制一个并重命名它，修改你想要的。您将不得不重建 jar。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-23T15:13:19.447

为什么不用普通的皮肤？看看这个[http://livedemo.exadel.com/richfaces-demo/richfaces/panel.jsf?s=plain](http://livedemo.exadel.com/richfaces-demo/richfaces/panel.jsf?s=plain)

如您所见，我已将皮肤设置为“普通”类型，这看起来就像您想要的组件一样。

# c - 在 C 数组中进行按位运算的最有效方法是什么

> ID：668280
> 
> 赞同：10
> 
> 时间：2009-03-20T22:52:04.047
> 
> 标签：c, performance, micro-optimization

我有一个 C 数组，如：

```
char byte_array[10]; 
```

另一个充当面具的角色：

```
char byte_mask[10]; 
```

我想在每个字节上使用按位运算得到另一个数组，该数组是第一个数组加上第二个数组的结果。

最有效的方法是什么？

谢谢你的回答。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-20T22:53:38.350

```
for ( i = 10 ; i-- > 0 ; )
    result_array[i] = byte_array[i] & byte_mask[i]; 
```

*   向后预加载处理器缓存线。
*   在比较中包含减量可以节省一些指令。

这适用于所有阵列和处理器。但是，如果您知道您的数组是字对齐的，那么更快的方法是转换为更大的类型并执行相同的计算。

例如，让我们说`n=16`而不是`n=10`. 那么这会更快：

```
uint32_t* input32 = (uint32_t*)byte_array;
uint32_t* mask32 = (uint32_t*)byte_mask;
uint32_t* result32 = (uint32_t*)result_array;
for ( i = 4 ; i-- > 0 ; )
    result32[i] = input32[i] & mask32[i]; 
```

（当然，你需要一个正确的类型`uint32_t`，如果`n`不是 2 的幂，你需要清理开头和/或结尾，以便对齐 32 位内容。）

变化：这个问题特别要求将结果放在一个单独的数组中，但是几乎可以肯定的是，就地修改输入数组会更快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T22:55:58.080

如果你想让它更快，请确保 byte_array 的长度是 4 的倍数（在 64 位机器上为 8），然后：

```
char byte_array[12];
char byte_mask[12];
/* Checks for proper alignment */
assert(((unsigned int)(void *)byte_array) & 3 == 0);
assert(((unsigned int)(void *)byte_mask) & 3 == 0);
for (i = 0; i < (10+3)/4; i++) {
  ((unsigned int *)(byte_array))[i] &= ((unsigned int *)(byte_mask))[i];
} 
```

这比逐字节执行要快得多。

（请注意，这是就地突变；如果您还想保留原始的 byte_array，那么您显然需要将结果存储在另一个数组中。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T01:05:08.597

```
\#define CHAR_ARRAY_SIZE    (10)
\#define INT_ARRAY_SIZE     ((CHAR_ARRAY_SIZE/ (sizeof (unsigned int)) + 1)

typedef union _arr_tag_ {

    char          byte_array [CHAR_ARRAY_SIZE];
    unsigned int  int_array [INT_ARRAY_SIZE]; 

} arr_tag; 
```

现在 int_array 用于掩蔽。这可能适用于 32 位和 64 位处理器。

```
arr_tag arr_src, arr_result, arr_mask;

for (int i = 0; i < INT_ARRAY_SIZE; i ++) {
    arr_result.int_array [i] = arr_src.int_array[i] & arr_mask.int_array [i];
} 
```

试试这个，代码可能看起来也很干净。

# .net - 基于 .NET 的类库 - 执行特定任务的多种方法 - 什么是顶级 X 与 Y 文章和书籍

> ID：668284
> 
> 赞同：4
> 
> 时间：2009-03-20T22:53:36.087
> 
> 标签：.net

很少有书籍和文章详细介绍 a) 为什么提供多种方法来完成特定场景中的特定任务以及 b) 开发人员在选择方法时应考虑哪些因素。

我的具体例子是简单地打开一个文本文件（任何 IO 章节的经典第一部分）。大多数书籍/文章只是说“嘿，这是打开文本文件的方法：带有文件路径的 StreamReader。Tada 和部分结尾！”

有些确实至少列出了一个事实，即有多个类允许您执行此操作，例如：

*   文件类
*   文件信息类
*   文件流类
*   StreamReader 类
*   等等等等等等

很少有人讨论有更多的重载，因此您可以以几种不同的方式使用每个类。

甚至更少的人甚至尝试就如何为手头的任务选择最佳方法进行任何讨论。（当然有一些，当有人发布关于“最佳”书籍的类似民意调查的问题时，这些通常会排在前三名。）

这种缺乏讨论让我发疯。我觉得我应该扔硬币。

这个问题的共同目的是：

*   首先找出是否有人认为这是一个有价值的话题
*   让人们有机会列出专门用于此类讨论的任何有趣的文章或书籍

我把它做成了一个wiki，因为其他类似的问题也被做成了wiki。如果人们觉得这个问题没有任何价值，我道歉并随时投票结束。

**另一个例子**

我目前正在阅读有关 BinaryWriter 和 BinaryReader 的信息。最近 20 篇我使用 google 找到的文章和至少 5 本书关于 O'Reilly Safari 向我展示了如何编写一个整数并将其读回。一对夫妇提供了一个如何使用 WriteString 和 ReadString 的示例。正是 ONE 让我知道 WriteString() 和 ReadString() 使用特殊的编码含义，如果你执行 WriteString() 和 ReadChar() 你会得到一个前缀。有很多方法可以使用这些类。为什么很少有文章讨论这个？

**多一个**

我的意思的另一个例子是，当一本书或文章从 MSDN 逐字列出班级成员和描述时，没有增加任何价值。我不需要班级成员列表，因为我可以从 MSDN 获得。从作者那里，我需要经验，现实世界的知识，即可以扩展我作为开发人员的东西。不是我可以在五秒钟内查到的东西。世界上所有的成员列表和简单的 i-don't-do-anything-有用的例子都不会真正帮助任何想要学习他们的东西的人。

**最后一个 - 我保证**

只是阅读有关 StringWriter 和 StringReader 的信息。一样。许多文章和书籍给出了简单的我不做任何有用的例子。如果我想将字符写入底层缓冲区，至少有些人会说一些模糊的东西，比如我可能想使用 StringWriter。我怎么知道我是否想这样做？什么样的现实世界场景需要它？我可以通宵达旦。

**好吧，所以我撒谎了……**

[这个问题](https://stackoverflow.com/questions/668361/fastest-implementation-of-a-true-random-number-generator-in-c)有来自 Merhdad 和 jalf 的答案，它们都解释了如何在两种生成随机数的方法之间进行选择，并展示了（我认为）我正在谈论的信息类型。jalf 说，类似于“在大多数情况下使用选项 A。但是在这种特定情况下，当您尝试实现结果 X 时，请使用选项 B。顺便说一下，这将产生负面影响 M。”

**X vs Y 文章**

我发现我可以通过搜索 X 与 Y 文章来获得我想要的东西，例如[这篇](http://www.aspfree.com/c/a/C-Sharp/A-Look-at-C-Sharp-Directory-and-DirectoryInfo-Classes/)讨论如何在 Directory 和 DirectoryInfo 类（以及 File 和 FileInfo 类）之间进行选择的文章。

所以现在这个问题是：

你能列出任何有用的 X vs Y 文章吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T23:00:41.343

在某些情况下，可以使用重复的方式来执行某些任务，因为它们在后续版本中进一步抽象了它。想想我认为是在 .Net 2.0 中引入的 WebClient 类。它基本上包含了您过去必须使用几个不同的类（HttpWebRequest、HttpWebResponse、StreamReader 等）来完成的许多常见任务。如果您需要做一些不同的事情并且为了向后兼容，旧的类显然仍然存在，但是如果您需要做的只是从 Web 下载资源作为字符串，那么您就有了 WebClient.DownloadString。

此外，您通常使用 .Net，因为您不会在 cpu 周期上分心，因此如果您不关心性能，那么代码量最少的解决方案是首选方法。如果您正在编写一个服务器任务，其中没有用户将“等待”进程，并且您需要打开一个文件并将其读入字符串，请使用静态方法，让您在一行中完成整个操作.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T06:09:13.967

如果您正在寻找一些印刷中的“为什么”，您可能会选择 Bill Wagner 最近的*《更有效的 C#》*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T23:10:24.110

我花了一段时间才弄清楚的一个例子是异步执行代码的不同方法。有BackgroundWorkers、Delegate.BeginInvoke/EndInvoke和手动线程操作。在那种情况下，我发现使用 Delegates 可以很好地平衡易于实施和控制；但是，使用手动线程可以为您购买额外的控制权，而无需做更多的工作——但要权衡的是创建新线程（而不是在线程池中使用回收的线程）是额外的开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T23:01:44.633

我想一个相当明显的例子是字符串连接。

当只连接少量字符串时，您不妨只使用 + 运算符或 String.Concat。不仅如此，出于性能原因，您应该真正考虑使用 StringBuilder。

你在想的是那种东西吗？

# javascript - 检测 Chrome 中被阻止的弹出窗口

> ID：668286
> 
> 赞同：104
> 
> 时间：2009-03-20T22:53:39.880
> 
> 标签：javascript, google-chrome, popup

我知道用于检测弹出窗口是否在其他浏览器中被阻止的 javascript 技术（如[该问题的答案](https://stackoverflow.com/questions/2914/how-can-i-detect-if-a-browser-is-blocking-an-popup)中所述）。这是基本测试：

```
var newWin = window.open(url);

if(!newWin || newWin.closed || typeof newWin.closed=='undefined')
{
    //POPUP BLOCKED
} 
```

但这在 Chrome 中不起作用。当弹出窗口被阻止时，永远不会到达“POPUP BLOCKED”部分。

当然，测试在一定程度上是有效的，因为 Chrome 实际上并没有阻止弹出窗口，而是在右下角的一个最小化窗口中打开它，其中列出了“被阻止”的弹出窗口。

我想做的是能够判断弹出窗口是否被 Chrome 的弹出窗口阻止程序阻止。我尽量避免浏览器嗅探以支持特征检测。有没有办法在没有浏览器嗅探的情况下做到这一点？

**编辑**：我现在尝试使用`newWin.outerHeight`,`newWin.left`和其他类似属性来完成此操作。当弹出窗口被阻止时，谷歌浏览器将所有位置和高度值返回为 0。

不幸的是，即使弹出窗口实际上打开了未知的时间，它也会返回相同的值。经过一段神奇的时间（在我的测试中几秒钟），位置和大小信息作为正确的值返回。换句话说，我还没有更接近弄清楚这一点。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-07-07T00:12:49.450

好吧，您所说的“神奇时间”可能是弹出窗口的 DOM 已加载时。否则可能是所有内容（图像、外部 CSS 等）都已加载时。您可以通过在弹出窗口中添加一个非常大的图形来轻松测试这一点（首先清除缓存！）。如果您使用 jQuery 之类的 Javascript 框架（或类似的东西），您可以使用 ready() 事件（或类似的东西）等待 DOM 加载，然后再检查窗口偏移量。这样做的危险在于 Safari 检测以一种冲突的方式工作：弹出窗口的 DOM 在 Safari 中永远不会是 ready() 因为它会给你一个有效的句柄来处理你试图打开的窗口——无论它是实际打开还是不是。（事实上​​，我相信您上面的弹出式测试代码不适用于 safari。）

我认为您可以做的最好的事情是将测试包装在 setTimeout() 中，并在运行测试之前给弹出窗口 3-5 秒来完成加载。它并不完美，但它至少应该在 95% 的时间内工作。

这是我用于跨浏览器检测的代码，没有 Chrome 部分。

```
function _hasPopupBlocker(poppedWindow) {
    var result = false;

    try {
        if (typeof poppedWindow == 'undefined') {
            // Safari with popup blocker... leaves the popup window handle undefined
            result = true;
        }
        else if (poppedWindow && poppedWindow.closed) {
            // This happens if the user opens and closes the client window...
            // Confusing because the handle is still available, but it's in a "closed" state.
            // We're not saying that the window is not being blocked, we're just saying
            // that the window has been closed before the test could be run.
            result = false;
        }
        else if (poppedWindow && poppedWindow.test) {
            // This is the actual test. The client window should be fine.
            result = false;
        }
        else {
            // Else we'll assume the window is not OK
            result = true;
        }

    } catch (err) {
        //if (console) {
        //    console.warn("Could not access popup window", err);
        //}
    }

    return result;
} 
```

我所做的是从父级运行此测试并将其包装在 setTimeout() 中，给子窗口 3-5 秒的加载时间。在子窗口中，需要添加一个测试函数：

功能测试（） {}

弹出窗口拦截器检测器测试以查看“测试”功能是否作为子窗口的成员存在。

2015 年 6 月 15 日添加：

我认为处理这个问题的现代方法是使用 window.postMessage() 让孩子通知父母窗口已经加载。方法类似（孩子告诉父母它已加载），但沟通方式有所改进。我能够从孩子做这个跨域：

```
$(window).load(function() {
  this.opener.postMessage({'loaded': true}, "*");
  this.close();
}); 
```

父母使用以下方法侦听此消息：

```
$(window).on('message', function(event) {     
  alert(event.originalEvent.data.loaded)
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-02-25T11:29:52.197

仅对 InvisibleBacon 的片段进行了一项改进（在 IE9、Safari 5、Chrome 9 和 FF 3.6 中测试）：

```
var myPopup = window.open("popupcheck.htm", "", "directories=no,height=150,width=150,menubar=no,resizable=no,scrollbars=no,status=no,titlebar=no,top=0,location=no");
if (!myPopup)
    alert("failed for most browsers");
else {
    myPopup.onload = function() {
        setTimeout(function() {
            if (myPopup.screenX === 0) {
                alert("failed for chrome");
            } else {
                // close the test window if popups are allowed.
                myPopup.close();  
            }
        }, 0);
    };
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-30T20:35:09.007

以下是弹出窗口拦截器检查的**jQuery**解决方案。它已在 FF (v11)、Safari (v6)、Chrome (v23.0.127.95) 和 IE (v7 & v9) 中进行了测试。更新 _displayError 函数以处理您认为合适的错误消息。

```
var popupBlockerChecker = {
        check: function(popup_window){
            var _scope = this;
            if (popup_window) {
                if(/chrome/.test(navigator.userAgent.toLowerCase())){
                    setTimeout(function () {
                        _scope._is_popup_blocked(_scope, popup_window);
                     },200);
                }else{
                    popup_window.onload = function () {
                        _scope._is_popup_blocked(_scope, popup_window);
                    };
                }
            }else{
                _scope._displayError();
            }
        },
        _is_popup_blocked: function(scope, popup_window){
            if ((popup_window.innerHeight > 0)==false){ scope._displayError(); }
        },
        _displayError: function(){
            alert("Popup Blocker is enabled! Please add this site to your exception list.");
        }
    }; 
```

用法：

```
var popup = window.open("http://www.google.ca", '_blank');
popupBlockerChecker.check(popup); 
```

希望这可以帮助！:)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-11-08T16:48:38.707

Rich 的回答不再适用于 Chrome。看起来 Chrome 现在实际上在弹出窗口中执行任何 Javascript。我最终检查了 screenX 值为 0 以检查是否有被阻止的弹出窗口。我还认为我找到了一种方法来保证这个属性在检查之前是最终的。这仅适用于您域上的弹出窗口，但您可以添加一个 onload 处理程序，如下所示：

```
var myPopup = window.open("site-on-my-domain", "screenX=100");
if (!myPopup)
    alert("failed for most browsers");
else {
    myPopup.onload = function() {
        setTimeout(function() {
            if (myPopup.screenX === 0)
                alert("failed for chrome");
        }, 0);
    };
} 
```

正如许多人所报告的那样，“screenX”属性有时会为失败的弹出窗口报告非零值，即使在 onload 之后也是如此。我也遇到过这种行为，但是如果您在零毫秒超时后添加检查，则 screenX 属性似乎总是​​输出一致的值。

让我知道是否有办法让这个脚本更健壮。似乎为我的目的工作。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-06-05T23:18:43.733

这对我有用：

```
 cope.PopupTest.params = 'height=1,width=1,left=-100,top=-100,location=no,toolbar=no,menubar=no,scrollbars=no,resizable=no,directories=no,status=no';
    cope.PopupTest.testWindow = window.open("popupTest.htm", "popupTest", cope.PopupTest.params);

    if( !cope.PopupTest.testWindow
        || cope.PopupTest.testWindow.closed
        || (typeof cope.PopupTest.testWindow.closed=='undefined')
        || cope.PopupTest.testWindow.outerHeight == 0
        || cope.PopupTest.testWindow.outerWidth == 0
        ) {
        // pop-ups ARE blocked
        document.location.href = 'popupsBlocked.htm';
    }
    else {
        // pop-ups are NOT blocked
        cope.PopupTest.testWindow.close();
    } 
```

outerHeight 和 outerWidth 用于 chrome，因为上面的 'about:blank' 技巧不再适用于 chrome。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-02-07T05:27:23.847

我将复制/粘贴此处提供的答案：[https](https://stackoverflow.com/a/27725432/892099) ://stackoverflow.com/a/27725432/892099 by DanielB。适用于 chrome 40，非常干净。没有肮脏的黑客或等待涉及。

```
function popup(urlToOpen) {
  var popup_window=window.open(urlToOpen,"myWindow","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=yes, width=400, height=400");            
  try {
    popup_window.focus();   
  }
  catch (e) {
    alert("Pop-up Blocker is enabled! Please add this site to your exception list.");
  }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-10-01T06:58:00.780

方法怎么样`Promise`？

```
const openPopUp = (...args) => new Promise(s => {
  const win = window.open(...args)
  if (!win || win.closed) return s()
  setTimeout(() => (win.innerHeight > 0 && !win.closed) ? s(win) : s(), 200)
}) 
```

你可以像经典一样使用它`window.open`

```
const win = await openPopUp('popuptest.htm', 'popuptest')
if (!win) {
  // popup closed or blocked, handle alternative case
} 
```

您可以更改代码，使其不符合承诺而不是返回`undefined`，我只是认为这`if`比`try / catch`这种情况更容易控制流程。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-20T23:01:59.627

检查窗口相对于父窗口的位置。Chrome 使窗口*几乎*在屏幕外出现。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-07-07T03:52:19.210

我在 Chrome 中没有打开弹出窗口时遇到了类似的问题。我很沮丧，因为我并没有试图做一些鬼鬼祟祟的事情，比如 onload 弹出窗口，只是在用户点击时打开一个窗口。我很沮丧，因为从 firebug 命令行运行包含 window.open() 的函数有效，而实际上单击我的链接却没有！这是我的解决方案：

错误的方式：从事件监听器运行 window.open() （在我的例子中，dojo.connect 到 DOM 节点的 onclick 事件方法）。

```
dojo.connect(myNode, "onclick", function() {
    window.open();
} 
```

正确方法：将函数分配给调用 window.open() 的节点的 onclick 属性。

```
myNode.onclick = function() {
    window.open();
} 
```

当然，如果需要，我仍然可以为同一个 onclick 事件做事件侦听器。通过此更改，即使 Chrome 设置为“不允许任何站点显示弹出窗口”，我也可以打开我的窗口。喜悦。

如果任何在 Chrome 方面有智慧的人可以告诉我们其他人为什么它会有所作为，我很想听听，尽管我怀疑这只是试图关闭恶意程序弹出窗口的大门。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-21T18:18:28.340

这是当前在 Chrome 中运行的版本。与 Rich 的解决方案稍有不同，尽管我也添加了一个处理时间的包装器。

```
function checkPopupBlocked(poppedWindow) {
 setTimeout(function(){doCheckPopupBlocked(poppedWindow);}, 5000);
}

function doCheckPopupBlocked(poppedWindow) {

    var result = false;

    try {
        if (typeof poppedWindow == 'undefined') {
            // Safari with popup blocker... leaves the popup window handle undefined
            result = true;
        }
        else if (poppedWindow && poppedWindow.closed) {
            // This happens if the user opens and closes the client window...
            // Confusing because the handle is still available, but it's in a "closed" state.
            // We're not saying that the window is not being blocked, we're just saying
            // that the window has been closed before the test could be run.
            result = false;
        }
        else if (poppedWindow && poppedWindow.outerWidth == 0) {
            // This is usually Chrome's doing. The outerWidth (and most other size/location info)
         // will be left at 0, EVEN THOUGH the contents of the popup will exist (including the
         // test function we check for next). The outerWidth starts as 0, so a sufficient delay
         // after attempting to pop is needed.
            result = true;
        }
        else if (poppedWindow && poppedWindow.test) {
            // This is the actual test. The client window should be fine.
            result = false;
        }
        else {
            // Else we'll assume the window is not OK
            result = true;
        }

    } catch (err) {
        //if (console) {
        //    console.warn("Could not access popup window", err);
        //}
    }

    if(result)
     alert("The popup was blocked. You must allow popups to use this site.");
} 
```

要使用它，只需这样做：

```
var popup=window.open('location',etc...);
checkPopupBlocked(popup); 
```

如果弹出窗口被阻止，警报消息将在 5 秒宽限期后显示（您可以调整它，但 5 秒应该是相当安全的）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-11-02T08:33:44.173

这个片段包含了以上所有内容——出于某种原因——StackOverflow 排除了下面代码块中的第一行和最后一行代码，所以我写了一篇关于它的博客。有关完整说明和其余（可下载）代码，请查看 [我在 thecodeabode.blogspot.com 上的博客](http://thecodeabode.blogspot.com/2010/11/window-open-popup-blocker-detect-for.html)

```
var PopupWarning = {

    init : function()
    {

        if(this.popups_are_disabled() == true)
        {
            this.redirect_to_instruction_page();
        }
    },

    redirect_to_instruction_page : function()
    {
        document.location.href = "http://thecodeabode.blogspot.com";
    },

    popups_are_disabled : function()
    {
        var popup = window.open("http://localhost/popup_with_chrome_js.html", "popup_tester", "width=1,height=1,left=0,top=0");

        if(!popup || popup.closed || typeof popup == 'undefined' || typeof popup.closed=='undefined')
        {
            return true;
        }

        window.focus();
        popup.blur();

        //
        // Chrome popup detection requires that the popup validates itself - so we need to give
        // the popup time to load, then call js on the popup itself
        //
        if(navigator && (navigator.userAgent.toLowerCase()).indexOf("chrome") > -1)
        {
            var on_load_test = function(){PopupWarning.test_chrome_popups(popup);};     
            var timer = setTimeout(on_load_test, 60);
            return;
        }

        popup.close();
        return false;
    },

    test_chrome_popups : function(popup)
    {
        if(popup && popup.chrome_popups_permitted && popup.chrome_popups_permitted() == true)
        {
            popup.close();
            return true;
        }

        //
        // If the popup js fails - popups are blocked
        //
        this.redirect_to_instruction_page();
    }
};

PopupWarning.init(); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-08-28T23:31:09.923

哇，这里肯定有很多解决方案。这是我的，它使用从[当前接受的答案](https://stackoverflow.com/a/1089792/141881)中获取的解决方案（在最新的 Chrome 中不起作用并且需要在超时中包装它），以及[这个线程](https://stackoverflow.com/a/13652829)上的相关解决方案（实际上是 vanilla JS，而不是 jQuery） .

我的使用回调架构，将`true`在弹出窗口被阻止时发送，`false`否则。

```
window.isPopupBlocked = function(popup_window, cb)
{
    var CHROME_CHECK_TIME = 2000;       // the only way to detect this in Chrome is to wait a bit and see if the window is present

    function _is_popup_blocked(popup)
    {
        return !popup.innerHeight;
    }

    if (popup_window) {
        if (popup_window.closed) {
            // opened OK but was closed before we checked
            cb(false);
            return;
        }
        if (/chrome/.test(navigator.userAgent.toLowerCase())) {
            // wait a bit before testing the popup in chrome
            setTimeout(function() {
                cb(_is_popup_blocked(popup_window));
            }, CHROME_CHECK_TIME);
        } else {
            // for other browsers, add an onload event and check after that
            popup_window.onload = function() {
                cb(_is_popup_blocked(popup_window));
            };
        }
    } else {
        cb(true);
    }
}; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-21T00:21:01.387

杰森的回答也是我能想到的唯一方法，但是像那样依靠位置有点狡猾！

这些天来，你真的不需要问“我的主动弹出窗口被阻止了吗？”，因为答案总是“是”——所有主要浏览器都默认打开了弹出窗口阻止程序。最好的方法是只响应 window.open() 以响应直接点击，这几乎总是被允许的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-05-18T11:14:57.880

你好

我稍微修改了上面描述的解决方案，并认为它至少适用于 Chrome。我的解决方案是在打开主页时检测弹出窗口是否被阻止，而不是在打开弹出窗口时检测，但我相信有些人可以修改它。:-) 这里的缺点是显示弹出窗口当没有弹出窗口阻止程序时，持续几秒钟（可能会缩短一点）。

我把它放在我的“主”窗口的部分

```
<script type="text/JavaScript" language="JavaScript">

 var mine = window.open('popuptest.htm','popuptest','width=1px,height=1px,left=0,top=0,scrollbars=no');
 if(!mine|| mine.closed || typeof mine.closed=='undefined')
  {
    popUpsBlocked = true       
    alert('Popup blocker detected ');
    if(mine)
      mine.close();
 }
 else
 {
    popUpsBlocked = false    
    var cookieCheckTimer = null;
    cookieCheckTimer =  setTimeout('testPopup();', 3500);
 }

function testPopup()
{
  if(mine)
  {
    if(mine.test())
    {
       popUpsBlocked = false;
    }
    else
    {
        alert('Popup blocker detected ');
         popUpsBlocked = true;
     }
    mine.close();
}

} 
</script> 
```

弹出测试看起来像这样：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Popup test</title>
<script type="text/javascript" language="Javascript">
   function test() {if(window.innerHeight!=0){return true;} else return false;}
</script>
</head>

<body>
</body>
</html> 
```

当我在 3500 毫秒后在弹出页面上调用测试功能时，Chrome 已正确设置了内部高度。

我使用变量 popUpsBlocked 来了解弹出窗口是否显示在其他 javascript 中。IE

```
function ShowConfirmationMessage()
{
if(popUpsBlocked)
 { 
  alert('Popups are blocked, can not display confirmation popup. A mail will be sent with the confirmation.');
 } 
 else
 { 
  displayConfirmationPopup();
 }
 mailConfirmation();
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-04-13T09:20:21.543

```
function openPopUpWindow(format)
{   
    var win = window.open('popupShow.html',
                          'ReportViewer',
                          'width=920px,height=720px,left=50px,top=20px,location=no,directories=no,status=no,menubar=no,toolbar=no,resizable=1,maximize:yes,scrollbars=0');

    if (win == null || typeof(win) == "undefined" || (win == null && win.outerWidth == 0) || (win != null && win.outerHeight == 0) || win.test == "undefined") 
    {
        alert("The popup was blocked. You must allow popups to use this site.");  
    }
    else if (win)
    {
        win.onload = function()
        {          
            if (win.screenX === 0) {
                alert("The popup was blocked. You must allow popups to use this site.");
                win.close();
            } 
        };
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-08-02T11:45:15.433

据我所知（根据我的测试），Chrome 返回一个位置为“about:blank”的窗口对象。因此，以下内容应该适用于所有浏览器：

```
var newWin = window.open(url);
if(!newWin || newWin.closed || typeof newWin.closed=='undefined' || newWin.location=='about:blank')
{
    //POPUP BLOCKED
} 
```

# .net - 请帮我解决我的 W3C 验证 API 超时问题

> ID：668301
> 
> 赞同：1
> 
> 时间：2009-03-20T22:59:49.023
> 
> 标签：.net, web-services, multithreading, backgroundworker, w3c

我正在使用 W3C 验证服务来检查我在 TextBox 中键入的文本是否是有效的标记。

[![有效的](https://i.stack.imgur.com/gXnuh.gif)](https://i.stack.imgur.com/gXnuh.gif)

它几乎可以工作了。但是，在特定条件下，我的输入会导致错误，然后是无休止的超时异常。我必须关闭重新打开程序才能让它再次工作。

请浏览我的代码并帮助我解决这个问题。

我有一个带有 TextBox 和 StatusBar 的非常简单的 WPF 应用程序。当我输入时，状态栏会更新，让我知道我输入的标记是否有效。因此，我不会敲击服务，仅在没有击键的情况下经过一秒钟或更长时间后才会进行验证。

[无效 http://img9.imageshack.us/img9/3788/invalidr.gif](http://img9.imageshack.us/img9/3788/invalidr.gif)

它的状态栏可能会显示：“正在验证...”、“有效”、“无效”，或者——如果有的话——异常的消息。

[验证 http://img7.imageshack.us/img7/5842/validating.gif](http://img7.imageshack.us/img7/5842/validating.gif)

以下验证成功：

## XHTML 输入

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xml:lang="en">
    <head>
        <title>Test</title>
    </head>
    <body>
        <h1>Test</h1>
        <p>This is a test</p>
    </body>
</html> 
```

如果我像这样打破我的段落，`<p>This is a test</`那么在尝试处理响应 XML 时会出现此异常：

> 名称不能以 '"' 字符开头，十六进制值 0x22。第 86 行，位置 40。

[XML 异常 http://img11.imageshack.us/img11/3066/namecannotbegin.gif](http://img11.imageshack.us/img11/3066/namecannotbegin.gif)

如果验证连续两次失败，那么我似乎不能只修复我的段落标签并像往常一样继续。由于某种原因，每个后续验证都会失败，并出现以下异常：

> 操作已超时

[超时 http://img21.imageshack.us/img21/7600/timedout.gif](http://img21.imageshack.us/img21/7600/timedout.gif)

这很奇怪。

很抱歉发布我的整个项目，但我不知道我的问题来自哪里。可能是我的线程、Web 服务通信、异常处理......我似乎找不到它。我是否正确关闭了我的 StreamWriter、HttpWebRequest 和 ResponseStreams？

## XAML

```
<Window x:Class="Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="W3C Validation"
        Height="300"
        Width="300"
        Name="Window1">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <TextBox Grid.Row="0"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 VerticalScrollBarVisibility="Visible"
                 FontFamily="Consolas"
                 TextChanged="TextBox_TextChanged" />
        <StatusBar Grid.Row="1">
            <StatusBarItem>
                <TextBlock x:Name="TextBlockResult" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window> 
```

## 视觉基础

```
Imports System.ComponentModel
Imports <xmlns:env="http://www.w3.org/2003/05/soap-envelope">
Imports <xmlns:m="http://www.w3.org/2005/10/markup-validator">

Class Window1

    Private WithEvents Worker As BackgroundWorker
    Private _WorkerArgument As String

    Private Sub Window1_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
        InitializeWorker()
    End Sub

    Private Sub InitializeWorker()
        Worker = New BackgroundWorker
        Worker.WorkerSupportsCancellation = True
        AddHandler Worker.DoWork, AddressOf Worker_DoWork
        AddHandler Worker.RunWorkerCompleted, AddressOf Worker_RunWorkerCompleted
    End Sub

    Private Sub TextBox_TextChanged(ByVal sender As System.Object, ByVal e As System.Windows.Controls.TextChangedEventArgs)
        TryToWork(DirectCast(sender, TextBox).Text)
    End Sub

    Sub TryToWork(ByVal Argument As String)

        If _WorkerArgument IsNot Nothing Then
            _WorkerArgument = Argument
            Exit Sub
        End If

        If Not Worker.IsBusy Then
            TextBlockResult.Text = "Validating..."
            Worker.RunWorkerAsync(Argument)
            Exit Sub
        End If

        _WorkerArgument = Argument
        Worker.CancelAsync()
        Dim RetryTimer As New Windows.Threading.DispatcherTimer
        AddHandler RetryTimer.Tick, AddressOf RetryTicker
        RetryTimer.Interval = New TimeSpan(1) '1 tick'
        RetryTimer.Start()

    End Sub

    Sub RetryTicker(ByVal sender As Object, ByVal e As System.EventArgs)
        If Not Worker.IsBusy Then
            DirectCast(sender, Windows.Threading.DispatcherTimer).Stop()
            TextBlockResult.Text = "Validating..."
            Worker.RunWorkerAsync(_WorkerArgument)
            _WorkerArgument = Nothing
        End If
    End Sub

    Private Sub Worker_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)
        'wait for one second'
        Dim StartTime As DateTime = DateTime.Now()
        While Now.Subtract(StartTime) < New TimeSpan(0, 0, 1)
            If DirectCast(sender, BackgroundWorker).CancellationPending Then
                e.Cancel = True
                Exit Sub
            End If
            System.Threading.Thread.Sleep(New TimeSpan(0, 0, 0, 0, 100)) 'tenth of a second'
        End While
        'then validate'
        e.Result = Validate(DirectCast(e.Argument, String))
    End Sub

    Private Function Validate(ByVal Text As String) As String
        Try
            Dim Url As String = "http://validator.w3.org/check"
            Dim Post As String = "&fragment=" + Web.HttpUtility.UrlEncode(Text) + "&output=soap12"
            Dim ResponseDocument As XDocument = XDocument.Load(New Xml.XmlTextReader(Communicate(Url, Post)))
            If ResponseDocument.Root.<env:Body>.<m:markupvalidationresponse>.<m:validity>.Value = "true" Then
                Return "Valid"
            Else
                Return "Invalid"
            End If
        Catch ex As Exception
            Return ex.Message
        End Try
    End Function

    Private Function Communicate(ByVal Url As String, ByVal Post As String) As System.IO.Stream
        Dim Writer As System.IO.StreamWriter = Nothing
        Dim Request As System.Net.HttpWebRequest = System.Net.WebRequest.Create(Url)
        Request.Method = "POST"
        Request.ContentLength = Post.Length
        Request.ContentType = "application/x-www-form-urlencoded"
        Request.Timeout = 2000 '2 seconds'
        Try
            Writer = New System.IO.StreamWriter(Request.GetRequestStream())
            Writer.Write(Post)
        Catch
        Finally
            If Not Writer Is Nothing Then
                Writer.Close()
            End If
        End Try
        Return Request.GetResponse.GetResponseStream()
    End Function

    Private Sub Worker_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs)
        If Not e.Cancelled Then
            TextBlockResult.Text = DirectCast(e.Result, String)
        End If
    End Sub

End Class 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T23:15:20.247

乍一看，我建议不要在每次更改文本时都尝试验证。这可以而且确实会让人有点不知所措。我担心这就是这里发生的事情。使它异步的工作做得很好，因为这样可以防止它阻塞，但我也怀疑它隐藏了你的问题。

尝试让 TextChanged 事件设置一个标志来执行验证器，然后让 DoWork 方法在紧密（ish）循环中运行检查该标志。这将使它有时间完成并且不会感到困惑。可能需要一两秒钟才能获得正确的数据，但不应锁定。

祝你好运。

# jquery - 使用“提交”回调和 $.ajax 发布时多次提交的表单

> ID：668314
> 
> 赞同：22
> 
> 时间：2009-03-20T23:07:31.763
> 
> 标签：jquery, ajax, forms

我一直在使用以下代码观察一些奇怪的行为：

```
$.fn.submit_to_remote = function() {
  // I use .each instead of the .submit directly so I can save
  // the 'submitEnabled' variable separately for each form
  jQuery.each($(this), function() {
    $(this).submit(function() {
      form = $(this);
      if (form.data('submitEnabled') == false) { alert('disabled'); return false; }
      form.data('submitEnabled', false);
      $.ajax({type: 'POST', url: 'url', data: data, dataType: 'script',
        success: function(script) {
          alert('success')
        }
      })
      return false;
    })
  })
}
$('.submit_to_remote').submit_to_remote(); 
```

因此，基本上，在表单上调用 submit_to_remote 时，它​​将禁用它的正常提交，然后发出 AJAX POST 请求。

奇怪的是，表单被多次发布，因为“禁用”警报会显示。如您所见，我通过使用保存在表单对象上的“变量”来防止这种情况发生，并检查该变量以查看表单是否已提交。

经过进一步测试，罪魁祸首似乎是 AJAX 调用返回的脚本。让我解释一下我在做什么，这样会更清楚。

表单被发布到服务器，并返回一个脚本。该脚本再次显示表单，但这次显示某些字段的错误消息。请注意，该表单已完全替换。

该脚本在显示新表单后执行以下操作：

```
$('.submit_to_remote').submit_to_remote(); 
```

我必须这样做，否则，当您再次单击提交按钮时，表单会正常提交，没有 AJAX。

因此，假设用户提交表单并返回相应的错误（未显示“禁用”警报）。然后他再次提交；这次“禁用”警报显示一次。现在他又提交了一次，这次警报显示了两次！等等...

因此，似乎每个请求都会一次又一次地附加 .submit 回调，但为什么呢？

难道是通过使用 .html() 原始表单被保留为幽灵或其他东西？

谢谢！

PS：如果相关，这里是 $.ajax 调用返回的脚本：

```
replace_content_with = 'the form and other stuff here';
$('.page-content').html(replace_content_with);
$('.submit_to_remote').submit_to_remote(); 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-26T20:05:37.800

是的，我同意 Seb，这是一个很好的做法，我认为在绑定之前始终取消绑定，除非您确定当前没有您想要的元素绑定。您可以通过简单地使用“.submit”、“.click”、“.mouseover”等功能来双重绑定您的东西。

养成这样做的习惯（对我来说永远不会失败）：

```
$('.some_element').unbind('submit').bind('submit',function() {
    // do stuff here...
}); 
```

... 代替：

```
$('.some_element').submit(function() {
    // do stuff here...
}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-12-30T14:21:13.937

解除绑定对我不起作用。这做到了：

```
$(document).off('submit');
$(document).on('submit',"#element_id",function(e){
    e.preventDefault();
    //do something
}); 
```

我希望它有帮助...

实际上 unbind() 如果在提交之前进行一些验证和返回，可能会给您带来一些麻烦。例子：

```
$(document).on('submit',"#element_id",function(e){
    e.preventDefault();
    $(document).unbind('submit');
    var name = $(this).children('input[name="name"]').val();
    if( name == 'wrong name')
        return;

    //do something
}); 
```

在这种情况下，如果您输入的是“错误名称”，则不会提交表单，之后，当您输入“正确名称”时，不会触发 $(document).on('submit'..，也不会触发e.preventDefault(); 并且您的表单将以常规方式提交。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T23:28:00.390

不确定这种奇怪的行为，但似乎取消绑定提交事件就可以了。

因此，在运行 $.ajax 调用返回的脚本之前，请运行以下命令：

```
$('.submit_to_remote').unbind("submit"); 
```

那应该删除以前的绑定，只留下新的绑定。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-14T19:55:19.787

更简单的是：

```
$(".some-class").off().submit(function() {
    //Do stuff here
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-10T19:23:38.210

请记住，jQuery submit() 事件 `<input type="submit">, <input type="image">, or <button type="submit">`在表单 ( [http://api.jquery.com/submit/](http://api.jquery.com/submit/) ) 中查找：。一些框架默认 type 属性为“submit”，因此如果您试图覆盖默认值，请将 type 属性更改为其他属性，这样它就不会多次提交。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-17T01:18:25.587

发生 OpenCart 双重提交是因为`common.js`.

**通过对不**匹配的表单使用 id 模式来避免这种情况`"form-"`。

示例：`<form id="myform" >`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-08T09:10:10.323

您可以使用此代码来解决：

```
$(this).submit(function() {
.
.
.
});

$(this).unbind("submit"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-16T14:16:12.233

我有同样的问题，并使用点击修复如下。

```
 $('.submit_to_remote').on('click', function(){
//Some validation or other stuff
$(this).submit();
}); 
```

# c# - 将 void 传递给泛型类

> ID：668316
> 
> 赞同：5
> 
> 时间：2009-03-20T23:08:59.530
> 
> 标签：c#, generics, delegates

我正在尝试创建一个表单，该表单将在处理特定任务时为某些东西设置动画（作为委托传递给构造函数）。它工作正常，但我遇到的问题是，如果我要执行的特定方法的返回类型为 void，我无法实例化我的泛型类的副本。

我知道这是设计使然，但我想知道是否有针对此类情况的已知解决方法。

如果它有帮助，我的 Windows 窗体看起来像这样（为简洁起见）：

```
public partial class operatingWindow<T> : Form
{
    public delegate T Operation();
    private Operation m_Operation;

    private T m_ReturnValue;
    public T ValueReturned { get { return m_ReturnValue; } }

    public operatingWindow(Operation operation) { /*...*/ }
} 
```

我称之为：

```
operatingWindow<int> processing = new operatingWindow<int>(new operatingWindow<int>.Operation(this.doStuff));
processing.ShowDialog();

// ... 
private int doStuff()
{
    Thread.Sleep(3000);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T23:33:06.243

不，你需要创建一个重载来做到这一点。

例如

```
public operatingWindow(Action action) 
{ 
    m_Operation=() => { action(); return null; }
} 
```

此外，您不需要定义自己的委托，您可以使用`Func<T>`和操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T00:34:47.500

我会稍微重新考虑你的设计。

如果您在基类中实现了处理，则可以使用 2 个几乎可以互换的替代方案对其进行子类化。

第一个可能像你的一样，它需要一个返回值的操作。（不过，我会重新设计它以使用它`Func<T>`而不是拥有自己的委托类型。

第二个可以只采取一个简单的动作而不提供返回值。两者都可以使用相同的动画/显示/等。例程，但提供不同的工作方式。您还可以使用基类将其传递给其他方法，这将提供很大的灵活性。

使用这种方法，您可以这样称呼：

```
private void DoSleep()
{
    Thread.CurrentThread.Sleep(5000);
}
private int ReturnSleep()
{
    Thread.CurrentThread.Sleep(5000);
    return 5000;
}
...
{
    var actionWindow = new OperatingWindowAction(this.DoSleep);
    actionWindow.Execute();
    var funcWindow = new OperatingWindowFunc<int>(this.ReturnSleep);
    funcWindow.Execute();
    int result = funcWindow.Result;
} 
```

这看起来像：

```
public abstract partial class OperatingWindowBase : Form
{
    public void Execute()
    {
        // call this.OnExecute(); asyncronously so you can animate
    }
    protected abstract void OnExecute();
}

public class OperatingWindowFunc<T> : OperatingWindowBase
{
    Func<T> operation;
    public T Result { get; private set; }
    public OperatingWindowFunc<T>(Func<T> operation)
    {
        this.operation = operation;
    }
    protected override OnExecute()
    {
        this.Result = operation();
    }
}

public class OperatingWindowAction
{
    Action operation;
    public OperatingWindow(Action operation)
    {
        this.operation = operation;
    }
    protected override OnExecute()
    {
        operation();
    }
} 
```

# .net - 在招聘信息中，什么是 .NET 编程？

> ID：668317
> 
> 赞同：8
> 
> 时间：2009-03-20T23:09:18.377
> 
> 标签：.net

我最近的合同项目在几周前成功结束，我一直在寻找新工作的工作地点。*自从我上次真正*查看这些网站以来已经六七年了，所以“.NET 程序员”或变体这句话可能已经有了一些含义。但是，如果我知道什么，那就危险了！

我的主要语言是 C#。在开发 Web 功能时，我将其与 ASP.NET、JavaScript、HTML 和 CSS 一起使用。因此，从我的角度来看，我作为“.NET 程序员”拥有超过六年的经验。然而，雇主，或者至少是他们的人力资源部门，并不这么看。

在最初的电话中，为了回应我有多少 .NET 经验，我会说六年的 C# 和 ASP.NET。在大多数情况下，面试官会回答：“是的，但是有多少直接 .NET 编程？” 那时，我知道我不会接受实质性面试，因为筛选员和我说的语言不同。

对我来说，.NET 包括框架和公共语言运行时。当我使用某种语言（在我的例子中是 C#）来使用框架来创建应用程序、实用程序或某些 Web 功能时，我正在做 .NET 编程。而且，我编写的代码在 CLR 中运行。如果“.NET 编程”的含义超出此范围，那么我会考虑开发/更新框架类和 CLR。然而，据我所知，这项工作是 MS 的专有领域。（当然，不是说继承、扩展、覆盖等）

那么，如果不是 C#（或 VB、J# 等）和 ASP.NET，“.NET 编程”是什么意思呢？

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-20T23:19:20.380

C# 编程 + asp.net 显然是 .net 编程的一部分。

我不明白为什么你要与系统作斗争，卡在过程的错误部分。

当他们说“是的，但是有多少直接 .NET 编程？”时，根据您的经验，您会说：“我在 .Net 编程方面有超过六年的经验”。

**更新：**如果你一直这样，你为什么不直接从第一个问题“我在 .net 编程方面有超过六年的经验”说出来，如果他们问你告诉“c#”哪种语言。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-20T23:17:07.950

你比他们要求的更精确。他们需要熟悉语言或框架，而您则专注于目的或任务。

换个角度来看，“ANSI-C编程”。这意味着您已经使用了该语言，仅此而已。没有什么说你是在 *nix 或 Windows 中做的，或者你写了硬件控制器或商业应用程序。

人力资源部通常有一个他们正在检查的清单。他们需要（想要）听到符合该列表中项目的关键字。“.NET 编程？检查。” 一旦你在面试中，你就可以详细说明。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T23:17:27.047

对我而言，.NET 编程可以是任何使用 .NET 框架的语言（ASP.NET、C#、VB.NET、J#.. 等）。我认为这是因为需要开发人员的人对负责雇用可能几乎没有编程知识的开发人员的人员不够具体。也许您可以说“我使用带有 C# 的 .NET 框架”？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T23:19:14.467

根据我的经验，人力资源部门除了人力资源法规和规则、保险信息和公司政策之外，很少有任何线索。就拥有真正的技术知识而言，我还没有与人力资源部门中真正了解当前编程技术的任何人交谈，因此他们必须依赖所在部门给他们的流行语和要求。员工的需要。有时经理们也不是那么在意。

也就是说，你的第一个目标是获得面试（与那些实际上对你的技能有既得利益的人的面试），所以如果他们问你是否有 .NET 经验，那么我会说（考虑到你'已经写在这里）你做的。人力资源部门经常为具有多种工作类型的公司工作，我不希望他们了解每种类型的来龙去脉。我怀疑有时他们只是检查与提供的技能清单相匹配的东西。

一旦你接受了技术人员的面试，你可以谈论你的经验，他们会明白的——或者他们应该明白！人力资源部门必须处理各种各样的简历，在当前的环境下，我相信候选人的质量差异很大。最近有很多人来我店面试。好在我们“人事部”也成天吊码，所以他有线索。;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T23:24:37.823

当涉及到计算机术语时，其中一些筛选人员非常密集。最好的办法就是告诉他们他们想听什么，然后继续进行真正的面试，在那里你可以与至少对你所谈论的内容有基本了解的人交谈

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T06:33:34.913

那是一个毫无头绪的招聘人员。我想说忽略他们的无知，并通过向他们提供您使用任何 .NET 语言或技术的总年数来回答这个问题。不值得给他们讲课。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T23:11:07.467

我通常认为它是指在 .NET 框架上编程，即：在 .NET CLR 上运行的任何东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T23:48:53.913

好。

您应该直接向 SCREEENER 询问。因此，当然以非常礼貌的方式询问诸如“作为我未来的雇主对您而言，.net 编程是什么”之类的问题是值得的。

我们不知道非技术人员对一些技术性话题的看法。

有时进行筛选面试的人没有头绪。

我见过这样的职位发布：

```
Java Programmer,  required: EJV's, JSP, PHP and Visual Basic. 
```

呵呵

# c# - 图片调整大小 C#,VB.NET 开源库

> ID：668318
> 
> 赞同：1
> 
> 时间：2009-03-20T23:10:10.637
> 
> 标签：c#, .net, imaging

关于如何将 jpg 图像大小调整为特定大小（文件大小和像素大小，例如 148 x 72 像素，300 KB）的任何人都指向我。

为了实现这一点，可以调整图像质量。

它可能是一个 .NET 库/代码，但它应该可以免费用于商业用途/开源。

我希望它在 C# 或 VB.NET 中作为库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T23:20:09.580

您可以使用[Graphics.DrawImage](http://msdn.microsoft.com/en-us/library/yws82c40.aspx)来调整图像的大小。然后，您可以通过将参数传递给 Bitmap.Save 方法来调整质量（[更多信息](http://weblogs.asp.net/despos/archive/2004/01/12/57752.aspx#57762)）。我不知道如何从文件大小获取正确的压缩参数。您总是可以尝试多个压缩参数，直到文件大小符合您的需要。

# asp.net-mvc - 使用 LinkBuilder.BuildUrlFromExpression

> ID：668319
> 
> 赞同：1
> 
> 时间：2009-03-20T23:10:32.833
> 
> 标签：asp.net-mvc, url-routing

我正在尝试在 ActionFilter 中使用 Microsoft.Web.Mvc 中的 LinkBuilder.BuildUrlFromExpression 并且想知道这是否是使用强类型参数获取 url 的最佳方法：

```
LinkBuilder.BuildUrlFromExpression<HomeController>(
    filterContext.RequestContext,
    RouteTable.Routes,
    x => x.Login()
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-03T00:09:41.700

[这](http://forums.asp.net/t/1263007.aspx)可能会有所帮助。

还有[另](http://www.jacopretorius.net/2009/06/generating-strongly-typed-content-links.html)一种使用 T4 的方法。

[另一个](http://haacked.com/archive/2009/06/02/alternative-to-expressions.aspx)，使用 MVC Futures（可能是最好的套件）。

我现在正在寻找相同的东西，不想引用 Microsoft.Web.Mvc。:) [Asp.Net Mvc 2](http://aspnet.codeplex.com/Wiki/View.aspx?title=Road%20Map&referringTitle=Home)
中会有这个功能

# powershell - 如何使用 PowerShell Get-Member cmdlet

> ID：668321
> 
> 赞同：15
> 
> 时间：2009-03-20T23:11:18.247
> 
> 标签：powershell

一个新手问题：

命令：

```
[Math] | Get-Member 
```

返回 的所有成员`System.RuntimeType`。这是为什么？

还有命令：

```
Get-Member -InputObject [Math] 
```

返回 的所有成员`System.String`。如果`[Math]`在这里被解释为字符串，我怎样才能使它成为一个数学对象？

另外，是否`Get-member`需要任何位置参数？我怎么知道？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-20T23:41:20.107

您从 [Math] 获得了 System.RuntimeType，因为它就是这样。它是一个 Class 类型，而不是该特定类型的对象。您实际上还没有构造一个 [Math] 对象。如果您键入以下内容，您将获得相同的输出：

```
[String] | gm 
```

但是，如果您从 String 类型构造一个字符串对象，您将获得字符串成员：

```
PS C:\> [String]("hi") | gm

   TypeName: System.String

Name             MemberType            Definition
----             ----------            ----------
Clone            Method                System.Object Clone()
CompareTo        Method                System.Int32 CompareTo(Object value), System.Int32 CompareTo(String strB)
Contains         Method                System.Boolean Contains(String value)
CopyTo           Method                System.Void CopyTo(Int32 sourceIndex, Char[] destination, Int32 destinationIn...
etc... 
```

由于 System.Math 只有静态成员，因此不能构造它的对象。要查看它的成员，您可以使用 System.RuntimeType 的 GetMembers() 函数：

```
[Math].GetMethods() 
```

您可以使用 format-* cmdlet 之一来格式化输出：

```
[Math].GetMethods() | format-table 
```

**编辑：**哦，我应该添加，调用静态成员之一，你会这样做：

```
[Math]::Cos(1.5) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-21T21:47:49.297

我刚刚写了[一篇关于使用 PowerShell 探索类的静态成员的博客文章](http://blog.usepowershell.com/2009/03/exploring-the-net-framework-with-powershell-static-members-part-4/)，这可能会有所帮助。

当您通过管道将 [Math] 传递给 Get-Member 时会发生什么，您正在传入一个 System.RunTimeType 对象，并且它确实返回了该类型的成员。

Get-Member 有一个开关参数，可让您检查类的所有静态成员：

```
[Math] | get-member -static 
```

如果您需要查找实例成员，则需要创建该类的一个实例并将其通过管道传递给 Get-Member。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T23:25:43.623

> 此外，Get-member 是否接受任何位置参数？我怎么知道？

如果参数名称包含在 '[]' 中，则名称是可选的，因此参数是位置参数。例如对于 Get-Member（定义如下），Name 是位置的，但 InputObject 不是。

> 获取成员 [[-Name] ] [-Force] [-InputObject ] [-MemberType {AliasProperty | 代码属性 | 物业 | 注意属性 | 脚本属性 | 属性 | 属性集 | 方法 | 代码方法 | 脚本方法 | 方法 | 参数化属性 | 会员集 | 活动 | 全部}] [-静态] [-查看{扩展| 改编 | 基地 | 全部}] []

对于第 2 个问题，您似乎希望它们表现得像对象，但您正在输入名称空间/类。如果您执行“1 | gm”或“gm -inputobject 1”，您将看到更像您想要/期望的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-06T14:16:30.823

1.  使用 get-help get-member 命令，您将获得此输出

NAME 获取成员

SYNOPSIS 获取对象的属性和方法。

语法 Get-Member [[-Name] ] [-Force] [-InputObject ] [-MemberType {AliasProperty | 代码属性 | 物业 | 注意属性 | 脚本属性 | 属性 | 属性集 | 方法 | 代码方法 | 脚本方法 | 方法 | 参数化属性 | 会员集 | 活动 | 全部}] [-静态] [-查看{扩展| 改编 | 基地 | 全部}] []

描述 Get-Member cmdlet 获取对象的“成员”（属性和方法）。

```
To specify the object, use the InputObject parameter or pipe an object to Get-Member. To retrieve information about
 static members (members of the class, not of the instance), use the Static parameter. To get only certain types of
 members, such as NoteProperties, use the MemberType parameter. 
```

相关链接 在线版本： http: [//go.microsoft.com/fwlink/](http://go.microsoft.com/fwlink/?LinkID=113322) ?LinkID= 113322 Add-Member Get-Help Get-Command Get-PSDrive

备注 要查看示例，请键入：“get-help Get-Member -examples”。有关详细信息，请键入：“get-help Get-Member -detailed”。有关技术信息，请键入：“get-help Get-Member -full”。

1.  从上面的语句可以看出，get-member 只接受对象而不接受类。您使用 -Static 查看对象的静态成员。

2.  当您使用不带 -Static 参数的 [String] 时，您是在告诉 powershell 您正在放置 [String] 类型的对象，但是，您尚未从任何语句中创建 String 对象，因此它假定 [String] 是表示 String 类的 System.Runtime 对象。如果您使用 [Int] 或 [Boolean] 和其他类类型，则类似。

3.  但是，如果您使用 -Static 参数，powershell 解释器现在知道您需要字符串对象的静态成员。

# windows - 将 GNUMake 与包含空格的文件名一起使用的最可靠方法是什么？

> ID：668322
> 
> 赞同：7
> 
> 时间：2009-03-20T23:12:11.440
> 
> 标签：windows, filenames, space, gnu-make

我想使用 GNUMake 运行基于规则的 makefile，它在目录结构中（在 Windows 文件系统上）构建一组 C 文件。

根目录、一些子目录和一些文件包含空格。

示例文件：`"C:\Documents and Settings\<username>\My Documents\Test Dir\Build Me.c"`

当文件路径包含空格时，GNUMake 并不能真正工作。我已经阅读了解决此问题的可能方法（从我的文件名中删除空格，使用 8.3 格式，用`?`or替换空格`\\`等），但它们都不是完美的（或者它们是完美的吗？）

有没有灵丹妙药可以解决这个问题？

*顺便说一句，我坚持使用 GNUMake，我不能使用不同的 make 工具。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T00:49:06.577

最简单的事情确实是修复文件名。

但是，如果做不到这一点，请编写命令以在文件名周围加上双引号。最简单、最安全的做法是将所有文件名放入宏中；诀窍是你必须转义双引号，否则 Make 会想吃掉它自己。

所以： FN="\"C:\My Documents\myfiles.c\"" FN2="C:\My Documents\myfile2.c"

或使用 $(CC) $(CFLAGS) "$(FN2)"

这里的技巧是用 echo 回显你的命令行

```
echo $(CC) $(CFLAGS) "$(FN2)" 
```

或用于`make -d`获取 make 尝试做的所有细节。

您可能需要稍微修改一下，特别是，您可能需要加倍转义

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T23:21:07.490

您也许可以转义 makefile 中的空格，即：

```
$(CC) $(CFLAGS) 'C:\Documents\ and\ Settings\<username>\My\ Documents\Test\ Dir\Build Me.c' 
```

我添加了单引号以防万一，但我不知道如果您使用的是 Windows 终端（而不是 cygwin 等），这是否有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-11T19:20:04.420

[我在http://www.mail-archive.com/help-make@gnu.org/msg05201.html](http://www.mail-archive.com/help-make@gnu.org/msg05201.html)找到了一个很好的灵感，这让我开始前进。我自己的测试应用程序包含一个从 YouTube 下载的 WW2 时代 Jazz FLV 文件的目录和一个音频子目录，我想在其中存储每个文件的 OGA 音频版本。当然，文件名包含空格。然后我想运行 ffmpeg2theora 到

这是我一起破解的 GNUMake Makefile。感谢本网站以及上面引用的网站上的所有提示！

```
sq = $(subst $(sp),?,$1)
qs = $(subst ?,$(sp),$1)

e :=
sp := $(e) $(e)

FLVS := $(foreach file,var,$(call sq,$(wildcard *.flv)))
FLVS := $(subst .flv?,.flv ,$(FLVS))

AUDIOS := $(patsubst %.flv,audio/%.oga,$(FLVS))

.PHONY: audios show

audios: $(AUDIOS)

$(AUDIOS) : $(FLVS)
    ffmpeg2theora --novideo -o "$(call qs,$@)" "$(call qs,$(notdir $(patsubst %.oga,audio/%.flv,$@)))"

show:
    echo $(FLVS)
    echo $(AUDIOS) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T19:51:26.703

我通常使用 Dana the Sane 的答案和 Brian Yoder 的答案的组合。

您只需使用该`$(subst)`函数将所有出现的空格替换为转义空格。例如：

```
empty := 
space := $(empty) $(empty)
program_files := $(subst $(space),\$(space),$(ProgramFiles)) 
```

（请注意，在 Windows 上使用一些旧版本的 make 您还需要使用另一个`$(subst)`将路径反斜杠更改为斜杠）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T01:33:09.730

如果空格仅在路径名的“根”部分，则可以将该目录挂载在不带空格的路径上。有多种方法可以做到这一点：从命令行（“net use”或“subst”）或从资源管理器（工具 > 映射网络驱动器）。所以 C:\Documents and Settings\\My Documents\Test Dir" 可能会变成 X:\BuildMe.c

但是，如果文件名或“根”构建目录下的目录中有空格，则可能没有任何完美的解决方案。我已经使用了您提到的其他建议（8.3 名称，用不同的字符替换空格）并且这些工作但它们有自己的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-23T04:07:45.300

我只是在有问题的字符串周围添加“单引号”：- '$(TARGET_DIR)'

示例：（这帮助我让**erlang.mk**在 Windows 上正常工作！）

```
app:: $(C_SRC_ENV)
    @mkdir -p priv/
    $(c_src_verbose) $(CC) $(CFLAGS) $(C_SRC_DIR)/*.c -fPIC -shared -o $(C_SRC_OUTPUT) \
        -I '$(ERTS_INCLUDE_DIR)' $(C_SRC_OPTS) 
```

`'$(ERTS_INCLUDE_DIR)'`现在正确扩展为 `'c:/Program Files/erl7.0/erts-7.0/include/'`

using`make -d`还有助于揭示无效路径

# c++ - SwapBuffers 让我的程序崩溃！

> ID：668325
> 
> 赞同：5
> 
> 时间：2009-03-20T23:13:36.930
> 
> 标签：c++, winapi, opengl

我有一个 OpenGL 程序，可以在我的所有计算机上运行，​​但只有一台。它是具有 Vista 64 和 Radeon HD4850 的台式机。问题似乎出在我对 SwapBuffers(hdc) 的调用中。

它编译得很好，然后给了我一个例外：

Program.exe 中 0x00000000 处的未处理异常：0xC0000005：访问冲突。

在调用 SwapBuffers 之前使用 VC++ 中断显示 hdc 的值为：

0xfe011734 {unused=???} CXX0030：错误：无法评估表达式

有人知道会发生什么吗？SwapBuffers 是否会从一台 PC 更改为另一台 PC？我已经让它在 XP32、XP64 和（不同的）Vista64 上工作。

```
while (!quit)
    {
        if (PeekMessage(&msg, NULL, NULL, NULL, PM_REMOVE))
        {
            if (msg.message == WM_QUIT)
                quit = true;

            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }

        renderFrame();  //draws the scene

        SwapBuffers(hdc);

        if (GetAsyncKeyState(VK_ESCAPE))
            shutdown();

        think();        //calculates object positions, etc.
    } 
```

有问题的系统 (HD4850) 上的驱动程序是最新的。我已经在另一个带有 Radeon HD4870 的 Vista64 系统上运行并编写了该程序，该系统也带有最新的驱动程序。据我所知，这两张卡的驱动程序几乎与 HD48xx 系列相同。出于这个原因，GPU 导致问题似乎很奇怪。

无论如何，我错了还是这是内存问题？（访问冲突）

此外，如果我删除对 SwapBuffers(hdc) 的调用，程序看起来运行得很好，虽然没有绘制任何内容，当然，因为帧缓冲区从不交换。但它至少是稳定的。

调用堆栈（-> 是堆栈 ptr）：

```
 ATKOGL32.dll!6aef27bc()     
    opengl32.dll!665edb2d()     
    opengl32.dll!665f80d1()     
    gdi32.dll!75e14104()    
->   MyProg.exe!WinMain(HINSTANCE__ * hinstance=0x009a0000, HINSTANCE__ * hprevinstance=0x00000000, char * lpcmdline=0x003b4a51, int nshowcmd=1)  Line 259 + 0xe bytes
    MyProg.exe!__tmainCRTStartup()  Line 578 + 0x35 bytes
    MyProg.exe!WinMainCRTStartup()  Line 400
    kernel32.dll!7641e3f3()     
    ntdll.dll!777dcfed()    
    ntdll.dll!777dd1ff() 
```

下面是程序集（-> 是要执行的下一条指令）：

```
 SwapBuffers(hdc);
    009B1B5C  mov         esi,esp 
    009B1B5E  mov         eax,dword ptr [hdc (9BF874h)] 
    009B1B63  push        eax  
    009B1B64  call        dword ptr [__imp__SwapBuffers@4 (0E1040Ch)] 
->  009B1B6A  cmp         esi,esp 
    009B1B6C  call        @ILT+780(__RTC_CheckEsp) (9B1311h) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T23:28:54.630

看起来您可以在窗口被破坏后访问 HDC，如果您在获得 WM_QUIT 后立即跳出循环，问题会消失吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T22:41:12.130

无论 hdc 设置为什么，它看起来都不是一个合适的值。是否在此调用之前创建了窗口？此应用程序是否涉及任何可能损害 hdc 的多线程？

尝试在 hdc 本身的地址上创建一个监视，并查看该值何时更改为无效位置，这可能会提示您更改的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T06:00:49.440

这几乎肯定是驱动程序中的错误。您看不到 hdc 值的原因是因为崩溃的顶部堆栈帧实际上是在 ATKOGL32.dll 中，但是由于没有符号，因此调试器会向您显示您的代码。据我所知，ATKOGL32.dll 实际上是 ASUS 驱动程序的 ASUS 包装器，这就是崩溃发生的地方。您可能想从 amd.com 安装库存的 ATI 驱动程序，看看崩溃是否仍然存在。

虽然无论您进行什么系列的 OpenGL 调用，驱动程序都不应崩溃，但根据我的经验，崩溃通常是您的程序进行的某种无效调用的结果。从技术上讲，这应该被忽略并设置错误状态，但这并不总是会发生。您可以使用 gDebugger 之类的程序轻松检查任何无效的 OpenGL 调用。

# asp.net - 如何在 ASP.NET MVC 中呈现活动报表 WebViewer

> ID：668328
> 
> 赞同：13
> 
> 时间：2009-03-20T23:16:53.210
> 
> 标签：asp.net, asp.net-mvc, reporting, activereports

我今天早些时候在 DataDynamics 论坛上问了这个问题。我想也许我会在这里得到某种回应。

我正在尝试在我的 ASP.NET MVC 应用程序中启动并运行 WebViewer。我正在尝试在控制器（webViewer.RenderControl(htmlTextWriter) 中呈现 webviewer，然后将结果放入 ViewData 并在我的视图中显示报告。我什至不知道这是否是正确的方法。任何帮助将不胜感激。

**控制器代码：**

```
 public ActionResult Display()
    {

        CurrentReport = new DetailedReport { ReportData = new DetailedData() { Repository = _repository } };

        var webViewer = new WebViewer();
        CurrentReport.Run();
        webViewer.ID = "WebViewer1";
        webViewer.Visible = true;
        webViewer.ViewerType = ViewerType.HtmlViewer;
        webViewer.Width = Unit.Percentage(100);
        webViewer.Report = CurrentReport;

        var stringWriter = new StringWriter();
        var htmlTextWriter = new HtmlTextWriter(stringWriter);
        webViewer.RenderBeginTag(htmlTextWriter);
        webViewer.RenderControl(htmlTextWriter);
        webViewer.RenderEndTag(htmlTextWriter);

        ViewData["WebViewer"] = stringWriter.ToString();

        return View();
    } 
```

**显示.aspx 代码：**

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Admin.Master" Inherits="System.Web.Mvc.ViewPage" %>
<%@ Register assembly="ActiveReports.Web, Version=5.2.1013.2, Culture=neutral, PublicKeyToken=cc4967777c49a3ff" namespace="DataDynamics.ActiveReports.Web" tagprefix="ActiveReportsWeb" %>
<%@ Import Namespace="xxxx.Core"%>

<asp:Content ID="Content1" ContentPlaceHolderID="ClientAdminContent" runat="server">
    <%=ViewData["WebViewer"] %>
</asp:Content> 
```

**错误：**

你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。

源错误：

第 60 行： var htmlTextWriter = new HtmlTextWriter(stringWriter); 第 61 行：webViewer.RenderBeginTag(htmlTextWriter); 第 62 行：webViewer.RenderControl(htmlTextWriter); 第 63 行：webViewer.RenderEndTag(htmlTextWriter); 第 64 行：

源文件：C:\Projects\xxxx\xxxx\app\xxxx.Web.Controllers\ReportsController.cs 行：62

****更新：****

根据 scott 的回答（谢谢），我的控制器现在看起来像这样：

```
 public ActionResult Display()
    {
        ViewData["Report"] = new DetailedReport { ReportData = new DetailedReport { ReportData = new DetailedData() { Repository = _repository } };
        return View();
    } 
```

我的观点是这样的：（我的观点没有文件背后的代码）。

```
<%
    var report = (ActiveReport3) ViewData["Report"];
    report.Run();
    WebViewer1.Report = report;
%>
<ActiveReportsWeb:WebViewer ID="WebViewer1" runat="server" Height="100%" Width="100%" ViewerType="AcrobatReader" /> 
```

我看着它通过调试器，它似乎正确地通过了详细信息部分，将值放入我的字段中。但完成后，我收到消息**“未指定报告”。** 我希望我真的不必在我的视图中使用代码隐藏文件，因为我没有在其他任何地方使用它们。我还调试以验证 report.Document.Pages.Count > 0。我已将代码块放在 WebViewer 控件的上方和下方（认为这并不重要）。有什么额外的想法吗？

****更新#2：****

我最终使用了此处找到的答案：[Alternative to using the OnLoad event in an ASP.Net MVC View?](https://stackoverflow.com/questions/566902) 结合下面斯科特的出色回答。生成报告并将其绑定到控件是一个时间问题。所以我的视图最终看起来像这样......（其中 Model.Report 是 ActiveReport3）

```
<script runat="server">
    private void Page_Load(object sender, EventArgs e)
    {
        var report = Model.Report;
        report.Run();
        WebViewer1.Report = report;
    }
</script>

<asp:Content ID="Content1" ContentPlaceHolderID="ClientAdminContent" runat="server">
    <ActiveReportsWeb:WebViewer ID="WebViewer1" runat="server" Height="100%" Width="100%" ViewerType="AcrobatReader" />
</asp:Content> 
```

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T15:51:47.060

我们在内部对此进行了调查，并找到了以下解决方案。您可以正常将 WebViewer 添加到 View 中。您的示例中不需要复杂的低级交互代码。相反，只需将 WebViewer 添加到您的 aspx 视图中即可。在我们的示例中，WebViewer 添加如下：

```
<ActiveReportsWeb:WebViewer ID="WebViewer1" runat="server" Height="100%" Width="100%" ViewerType="AcrobatReader" /> 
```

这足以让 WebViewer 在视图上工作。

在控制器中，我们指定了一个 ActiveReport，如下所示：

```
ViewData["Report"] = new SampleReport(); 
```

在视图的代码隐藏中，我们将报告挂钩到视图：

```
WebViewer1.Report = ViewData["Report"] as ActiveReport3; 
```

然后棘手的部分开始了。在 ASP.NET 下运行时，ActiveReports 使用了一些 IHttpHandler，用于某些查看器类型，例如 AcrobatReader / PDF。为确保我们的处理程序正常工作，您必须获得 ASP.NET MVC 路由以允许它们正常处理。幸运的是，这样做很容易。只需将以下代码行添加到 Global.asax.cs 文件中：

```
routes.IgnoreRoute("{*allarcachitems}", new { allarcachitems = @".*\.ArCacheItem(/.*)?" }); 
```

那将忽略路线。请注意，根据我的阅读可能会出现问题，因为 ASP.NET 路由似乎只允许像这样的单个“catch all”路由。因此，如果您有多个 IgnoreRoute 命令，或者您对 .axd 文件有任何问题，则需要修改约束字典参数以适应 .axd 和 .ArCacheItem。

有关详细信息，请参阅以下文章：[http ://haacked.com/archive/2008/07/14/make-routing-ignore-requests-for-a-file-extension.aspx](http://haacked.com/archive/2008/07/14/make-routing-ignore-requests-for-a-file-extension.aspx)

您可以从我们的论坛下载完整示例，网址为[http://www.datadynamics.com/forums/ShowPost.aspx?PostID=121907#121907](http://www.datadynamics.com/forums/ShowPost.aspx?PostID=121907#121907)

Scott Willeke
数据动态 / GrapeCity

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-28T23:27:27.047

对于遇到此问题并使用 IIS7 的其他任何人，请确保在`<handlers>`not 部分下添加 Active 报告处理程序`<httpHandlers>`。

```
<add name="RPX" verb="*" path="*.rpx" type="DataDynamics.ActiveReports.Web.Handlers.RpxHandler, ActiveReports.Web, Version=6.1.2814.0, Culture=neutral, PublicKeyToken=cc4967777c49a3ff"/>
            <add name="ActiveReport" verb="*" path="*.ActiveReport" type="DataDynamics.ActiveReports.Web.Handlers.CompiledReportHandler, ActiveReports.Web, Version=6.1.2814.0, Culture=neutral, PublicKeyToken=cc4967777c49a3ff"/>
            <add name="ArCacheItem" verb="*" path="*.ArCacheItem" type="DataDynamics.ActiveReports.Web.Handlers.WebCacheAccessHandler, ActiveReports.Web, Version=6.1.2814.0, Culture=neutral, PublicKeyToken=cc4967777c49a3ff"/> 
```

我以为我的 IgnoreRoute 设置不正确，因为我遇到了 404 错误。但是，我遵循 ActiveReports 提供的教程，该教程将它们放在 IIS6 部分而不是 IIS7 中。

# file-io - 独立于平台的文件锁定？

> ID：668336
> 
> 赞同：8
> 
> 时间：2009-03-20T23:19:21.410
> 
> 标签：file-io, concurrency, locking, d, samba

我正在执行一项计算量非常大的科学工作，时不时地吐出结果。这项工作基本上只是模拟同一件事一大堆时间，所以它被分配给几台使用不同操作系统的计算机。我想将所有这些实例的输出定向到同一个文件，因为所有计算机都可以通过 NFS/Samba 看到同一个文件系统。以下是约束：

1.  必须允许安全的并发追加。如果另一台计算机上的其他实例当前正在附加到文件，则必须阻止。
2.  性能**不算**。每个实例的 I/O 每分钟只有几个字节。
3.  简单确实很重要。这样做的全部意义（除了纯粹的好奇心）是这样我就可以停止让每个实例写入不同的文件并手动将这些文件合并在一起。
4.  不能依赖于文件系统的细节。必须在 NFS 或 Samba 挂载上使用未知文件系统。

我使用的语言是 D，以防万一。我看过，标准库中似乎没有任何东西可以做到这一点。特定于 D 的和一般的、与语言无关的答案都是完全可以接受和赞赏的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T23:53:42.293

通过 NFS，您会遇到一些客户端缓存和过时数据的问题。我以前写过一个独立于操作系统的锁模块来工作在 NFS 上。创建 [datafile].lock 文件的简单想法不适用于 NFS。解决它的基本思想是创建一个锁定文件 [datafile].lock，如果存在则意味着文件未锁定，并且想要获取锁定的进程将文件重命名为不同的名称，例如 [datafile].lock。[主机名].[pid]。重命名是一个足够原子的操作，在 NFS 上运行良好，可以保证锁的排他性。其余的基本上是一堆故障安全、循环、错误检查和锁检索，以防进程在释放锁并将锁文件重命名回 [datafile].lock 之前死亡

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T00:03:29.353

经典的解决方案是使用锁定文件，或者更准确地说是锁定目录。在所有常见的操作系统上，创建目录是一个原子操作，所以例程是：

*   尝试在固定位置创建具有固定名称的锁定目录
*   如果创建失败，请等待一秒钟左右，然后重试 - 重复直到成功
*   将您的数据写入真实数据文件
*   删除锁定目录

多年来，CVS 等应用程序已在许多平台上使用它。唯一的问题发生在极少数情况下，即您的应用程序在写入时和移除锁之前崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T00:15:32.723

**扭转锁定文件**

就像其他答案提到的那样，最简单的方法是在与数据文件相同的目录中创建一个锁定文件。

由于您希望能够通过多台 PC 访问同一个文件，因此我能想到的最佳解决方案是仅包含当前写入数据文件的机器的标识符。

所以写入数据文件的顺序是：

1.  检查是否存在锁定文件

2.  如果有一个锁定文件，通过检查它的内容是否有我的标识符来查看我是否是拥有它的人。
    如果是这种情况，只需写入数据文件，然后删除锁定文件。
    如果不是这种情况，只需等待一秒钟或一小段随机时间，然后再次尝试整个循环。

3.  如果没有锁定文件，请使用我的标识符创建一个并再次尝试整个循环以避免竞争条件（重新检查锁定文件是否真的是我的）。

除了标识符，我会在锁定文件中记录一个时间戳，并检查它是否早于给定的超时值。
如果时间戳太旧，则假设锁定文件已过时并删除它，因为这意味着写入数据文件的 PC 之一可能已崩溃或其连接可能已丢失。

**另一种解决方案**

如果你在控制数据文件的格式，可以在文件的开头保留一个结构来记录它是否被锁定。
如果您只是为此目的保留一个字节，您可以假设，例如，这`00`意味着数据文件没有被锁定，而其他值将代表当前写入它的机器的标识符。

**NFS 的问题**

好的，我要添加一些内容，因为 Jiri Klouda 正确地指出[NFS 使用客户端缓存](http://nfs.sourceforge.net/#faq_a8)，这将导致实际的锁定文件处于未确定状态。

解决这个问题的几种方法：

*   `noac`使用or`sync`选项挂载 NFS 目录。这很容易，但不能完全保证客户端和服务器之间的数据一致性，因此可能仍然存在问题，尽管在您的情况下它可能没问题。

*   `O_DIRECT`使用、`O_SYNC`或`O_DSYNC`属性打开锁定文件或数据文件。这应该完全禁用缓存。
    这会降低性能，但会确保一致性。

*   您*可能*可以使用`flock()`锁定数据文件，但其实现参差不齐，您需要检查您的特定操作系统是否实际使用 NFS 锁定服务。否则它可能什么都不做。
    如果数据文件被锁定，那么另一个打开它进行写入的客户端将失败。
    哦，是的，它似乎不适用于 SMB 共享，所以最好还是忘记它。

*   不要使用 NFS，而只使用 Samba：有[一篇关于该主题的好文章](http://www.time-travellers.org/shane/papers/NFS_considered_harmful.html)以及为什么 NFS 可能不是您使用场景的最佳答案。
    您还将在本文中找到锁定文件的各种方法。

*   Jiri 的解决方案也不错。

基本上，如果您想保持简单，请不要将 NFS 用于在多台机器之间共享的频繁更新的文件。

**有些不同**

使用小型数据库服务器将数据保存到并完全绕过 NFS/SMB 锁定问题，或者保留当前的多个数据文件系统，只需编写一个小实用程序来连接结果。
它可能仍然是解决您的问题的最安全和最简单的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T02:33:44.797

为什么不建立一个简单的服务器，它位于文件和其他计算机之间？

然后，如果您想更改数据格式，您只需修改服务器，而不是所有客户端。

在我看来，构建服务器比尝试使用网络文件系统要容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T23:35:27.143

我不知道 D，但我认为使用互斥文件来完成工作可能会奏效。以下是一些您可能会觉得有用的伪代码：

```
do {
  // Try to create a new file to use as mutex.
  // If it's already created, it will throw some kind of error.
  mutex = create_file_for_writing('lock_file');
} while (mutex == null);

// Open your log file and write results
log_file = open_file_for_reading('the_log_file');
write(log_file, data);
close_file(log_file);

close_file(mutex);
// Free mutex and allow other processes to create the same file.
delete_file(mutex); 
```

因此，所有进程都会尝试创建互斥文件，但只有获胜的进程才能继续。编写输出后，关闭并删除互斥锁，以便其他进程可以执行相同操作。

# python - 程序化登录和使用不支持 api 的 Google 服务

> ID：668350
> 
> 赞同：4
> 
> 时间：2009-03-20T23:25:41.847
> 
> 标签：python, curl, gdata-api

Google 为他们的许多服务提供 API，并为多种语言提供绑定。但是，并非所有内容都受支持。所以这个问题来自于我对 wget、curl 和各种 Web 编程库等东西的不完全理解。

1.  如何以编程方式向 Google 进行身份验证？

2.  是否可以利用现有 API 访问 Google 不受支持的部分？

一旦我通过了身份验证，我如何使用它来访问我的受限页面？似乎可以使用 API 进行登录并获取令牌，但我不明白*接下来我应该做什么*来获取受限网页。

具体来说，我正在使用 Android 并想编写一个脚本来每天一次或两次从 Android Market 获取我的应用程序使用统计信息，以便制作漂亮的图表。我最有可能的目标是 python，但任何说明非 API 使用 Google 服务的语言的代码都会有所帮助。谢谢各位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T23:46:27.663

您可以使用 mechanize 之类的东西，甚至 urllib 来实现这类事情。作为教程，您可以[在此处](http://ssscripting.wordpress.com/2009/03/17/how-to-submit-a-form-programmatically/)查看我关于以编程方式提交表单的文章。进行身份验证后，您可以使用 cookie 访问受限页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T06:44:20.573

[您可以通过针对https://www.google.com/accounts/ClientLogin](https://www.google.com/accounts/ClientLogin)对特定服务进行身份验证来获取身份验证令牌

例如

```
curl -d "Email=youremail" -d "Passwd=yourpassword" -d "service=blogger" "https://www.google.com/accounts/ClientLogin" 
```

然后，您可以在访问服务时传递身份验证令牌和 cookie。您可以使用 firebug 或 temp data firefox 插件来查找参数名称等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T13:43:46.217

CLientLogin 现已弃用：[https ://developers.google.com/accounts/docs/AuthForInstalledApps](https://developers.google.com/accounts/docs/AuthForInstalledApps)

我们如何使用 OAuth2 以编程方式向 Google 进行身份验证？

我在 CLientLogin 中找不到带有用户和密码参数的请求示例:(

有解决办法吗？

# c# - 使用反射设置结构中字段的值，该字段是结构数组的一部分

> ID：668356
> 
> 赞同：3
> 
> 时间：2009-03-20T23:31:36.573
> 
> 标签：c#, arrays, reflection, struct, field

目前，我的代码使用反射成功地设置了对象的字段/属性/数组的值，给定了从根对象到字段/属性的路径。

例如

```
//MyObject.MySubProperty.MyProperty
SetValue('MySubProperty/MyProperty', 'new value', MyObject); 
```

上面的示例将“MyObject”对象的“MyProperty”属性设置为“新值”

我无法使用反射在结构中设置字段的值，该结构是结构数组的一部分，因为该结构是值类型（在数组内）。

这是一些测试类/结构......

```
public class MyClass {
        public MyStruct[] myStructArray = new MyStruct[] {
            new MyStruct() { myField = "change my value" } 
        };
        public MyStruct[] myOtherStructArray = new MyStruct[] {
            new MyStruct() { myOtherField = "change my value" }, 
            new MyStruct() { myOtherField = "change my other value" } 
        };
}

public struct MyStruct { public string myField; public string myOtherField; } 
```

下面是我如何成功设置列表中普通属性/字段和道具/字段的值...

```
public void SetValue(string pathToData, object newValue, object rootObject)
{
    object foundObject = rootObject;
    foreach (string element in pathToData.Split("/"))
    {
        foundObject = //If element is [Blah] then get the
                      //object at the specified list position
        //OR
        foundObject = //Else get the field/property
    }

    //Once found, set the value (this is the bit that doesn't work for
    //                           fields/properties in structs in arrays)
    FieldInf.SetValue(foundObject, newValue);
}

object myObject = new MyClass();
SetValue("/myStructArray/[0]/myField", "my new value", myObject);
SetValue("/myOtherStructArray/[1]/myOtherField", "my new value", myObject); 
```

之后我想要 myObject.myStructArray[0].myField = ''my new value" 和 myObject.myOtherStructArray[1].myOtherField = ''my new value"

我所需要的只是替换“FieldInf.SetValue(foundObject, newValue);” 线

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T01:11:36.897

获取数组对象（不是特定元素）的 FieldInfo。

如果它是一个数组，则将其转换为 System.Array 并使用 Array.SetValue 设置对象的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-17T16:04:16.817

由于装箱/拆箱，对于任何类型的结构成员，以下内容应该完全符合您的要求：

```
var property = this.GetType().GetProperty(myPropertyName, BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Public);
ValueType vthis = this;
property.SetValue(vthis, myValue, null); // myValue is the value/object to be assigned to the property.
this = (UnderlyingsList)vthis; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T23:39:41.453

如果我不得不猜测，该错误是您省略的代码的一部分，特别是我怀疑：

```
 foundObject = //If element is [Blah] then get the
                  //object at the specified list position 
```

是（无意地）设置`foundObject`为指定列表位置的对象的*副本*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T00:08:58.340

我的问题继续...

我发现的类似问题的唯一解决方案是在作为字段的结构中设置字段/属性是使用...

```
//GrandParentObject is myObject
//GrandParentType is typeof(MyClass)
//FieldIWantedToSet is the field info of myStruct.FieldIWantedToSet
FieldInfo oFieldValueTypeInfo = GrandParentType.GetField("myStruct");
TypedReference typedRefToValueType = TypedReference.MakeTypedReference(GrandParentObject, new FieldInfo[] { oFieldValueTypeInfo });
FieldIWantedToSet.SetValueDirect(typedRefToValueType, "my new value"); 
```

问题是如何在结构的数组/列表上使用 SetValueDirect，我猜我上面的旧方法在结构位于数组中时将不起作用，因为我无法获取结构的 FieldInfo（因为它在数组中）？

# python - PyGame中的中文unicode字体

> ID：668359
> 
> 赞同：9
> 
> 时间：2009-03-20T23:33:33.357
> 
> 标签：python, unicode, pygame, cjk

PyGame中如何显示汉字？什么是用于此目的的好的免费/自由字体？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-21T02:10:27.923

pygame 使用 SDL_ttf 进行渲染，因此您应该在渲染过程中保持良好状态。

[unifont.org](http://www.unifont.org/fontguide/)似乎有一些关于开源字体的大量资源，用于一系列脚本。

我抓取了 Cyber​​bit pan-unicode 字体并提取了包含的 ttf。以下“在我的机器上工作”是 Windows Vista Home Basic 和 Python 2.6：

```
# -*- coding: utf-8 -*-

import pygame, sys

unistr = u"黒澤 明"
pygame.font.init()
srf = pygame.display.set_mode((640,480))
f = pygame.font.Font("Cyberbit.ttf",20)
srf.blit(f.render(unistr,True,(0,0,0)),(0,0))
pygame.display.flip()

while True:
    srf.blit(f.render(unistr,True,(255,255,255)),(0,0))
    for e in pygame.event.get():
        if e.type == pygame.QUIT:
            pygame.quit()
            sys.exit() 
```

只要您只是显示 unicode 文本，您的状态就应该很棒。然而，如果你想真正从用户那里读取 unicode 输入，情况就更加惨淡了。Pygame 没有任何类型的输入法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T02:08:56.243

据我所知——我自己还没有尝试过——当你向 PyGame 传递一个包含中文字符的 Unicode 字符串时，它应该可以正常工作，例如。你'\u4e2d\u56fd'。

[请参阅http://www.unifont.org/fontguide/](http://www.unifont.org/fontguide/)下的“东亚”，了解相当多的合适的开放许可字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-13T16:34:32.370

`pygame`以下是可以呈现中文的内置字体列表：

```
arialms
fzshuti
fzyaoti
lisu
malgungothic
microsoftjhengheimicrosoftjhengheiui
microsoftjhengheimicrosoftjhengheiuibold
microsoftjhengheimicrosoftjhengheiuilight
microsoftyaheimicrosoftyaheiui
microsoftyaheimicrosoftyaheiuibold
microsoftyaheimicrosoftyaheiuilight
msgothicmsuigothicmspgothic
simsunnsimsun
stcaiyun
stfangsong
sthupo
stkaiti
stliti
stsong
stxihei
stxingkai
stxinwei
stzhongsong
youyuan
yugothicmediumyugothicuiregular
yugothicregularyugothicuisemilight
yugothicyugothicuilight
yugothicyugothicuisemiboldyugothicuibold 
```

上述每一种字体都适用于汉字。这是一个例子`"stsong"`：

```
import pygame

text = "中文"
font = "stsong"

pygame.font.init()
wn = pygame.display.set_mode((500, 500))
font = pygame.font.SysFont(font, 190)
wn.blit(font.render(text, True, (255, 255, 255)), (50, 50))
pygame.display.update() 
```

输出：

[![在此处输入图像描述](https://i.stack.imgur.com/le8K3.png)](https://i.stack.imgur.com/le8K3.png)

# c# - C#中真随机数生成器的最快实现

> ID：668361
> 
> 赞同：11
> 
> 时间：2009-03-20T23:34:46.160
> 
> 标签：c#, performance, random

我正在阅读有关“适合创建随机密码的加密安全随机数”的[Random.Next() MSDN 建议](http://msdn.microsoft.com/en-us/library/system.random.aspx)[RNGCryptoServiceProvider 类](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)

什么速度处罚？有什么最快的方法可以得到真正的随机数？

*编辑：使用 Random.Next() 我得到一个新的随机数。与...*

```
byte[] randomNumber = new byte[1];
RNGCryptoServiceProvider Gen = new RNGCryptoServiceProvider();
Gen.GetBytes(randomNumber);
int rand = Convert.ToInt32(randomNumber[0]); 
```

*我得到一个“加密安全的随机数”我想知道上面的代码是否比**“Random.Next()”**快，如果有一些快速的方法可以获得相同的结果，好吗？*

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-21T00:37:51.970

回答您的问题的最简单方法可能是将您的问题颠倒过来。

*假设*CryptoServiceProvider 实现具有所有优势。它和 Random.Next 一样快，并且使用的内存一样少。

*那么为什么两种实现都存在*呢？为什么我们甚至在框架中*有Random.Next？*

看看我们对每个实现的了解。一个生成加密安全的随机数，另一个不做任何承诺。

哪个更简单？生成足够随机的随机数以用于密码学，或者生成简单“看起来”随机但不保证其他任何东西的数字？如果生成加密安全的随机数没有成本，那么*每个*随机数生成器都会这样做。

您通常可以假设标准库函数旨在按照包装盒上所说的去做并且做得很好。*Random.Next 旨在尽可能高效地为*您获取伪随机数序列中的下一个随机数。

CryptoServiceProvider 旨在生成足够强大的随机数以用于密码学，并尽可能高效地执行*此操作。*如果有一种方法可以像 Random.Next 一样有效地做到这一点，那么 Random.Next 也会使用*它*。

您的问题似乎假设框架设计者的脑损伤 - 他们以某种方式设计了一个不必要的缓慢函数来生成加密安全随机数，即使有更快的方法。

生成密码安全随机数的最快方法最有可能调用专家设计的函数来生成密码安全随机数。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-20T23:36:04.503

关于安全和密码学的经验法则：

# *永远不要*自己写。

采用标准的做法，避免危险的优化。

### 编辑以解决更新的问题：

`Random.Next`当您需要在安全敏感代码和安全敏感代码中未使用的统计随机数时使用`RNGCryptoServiceProvider`。它没有那么快，`Random.Next`但它具有可接受的性能。您应该进行基准测试以查看实际差异。为了性能而牺牲安全性通常是没有意义的。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-21T00:15:24.473

您的示例代码生成的“加密安全随机数”只会介于 0 到 255 之间！

如果要返回所有可能的`Int32`值，则应使用 4 个随机字节。您的代码应如下所示：

```
RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
byte[] rndBytes = new byte[4];
rng.GetBytes(rndBytes);
int rand = BitConverter.ToInt32(rndBytes, 0); 
```

在我的（老式）机器上进行的快速基准测试表明，`Random.Next`它比使用`RNGCryptoServiceProvider`.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-21T00:50:21.020

您首先应该做的是学习[RNG](http://en.wikipedia.org/wiki/Random_number_generator)、[PRNG](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)和[CSPRNG](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)之间的基本区别。

只有在此之后，您才应该决定您真正需要什么以及可能的实现方式。但是，作为一般规则，您应该只接受已经建立并证明是正确实施的内容。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-20T23:43:13.520

在硬件中获得*真正*随机数的唯一已知方法很慢。如果你试图加快速度，你的头发会变白，掉成一团，NRC 会派机器人来清理你的服务器机房。

在这个问题上我和 Mehrdad 一致：不要试图自己动手。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-21T01:16:32.593

一个附带但有趣的问题是您在问题中使用“true”。硬件或软件中不存在真正的随机数。它们存在于“现实生活”中，如放射性衰变或线路上的噪声，但不能由程序生成。因此，请注意 jalf 对“伪”的使用并检查 jcinacio 到维基百科的链接。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-21T01:22:10.567

AFAIK 一个真正的随机生成器永远不会在 C# 中实现。这只能在硬件的帮助下完成吗？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-12-29T17:51:09.353

还有一点没有提到：

给定相同的初始种子值，PRNG 将产生可预测的结果。CSPRNG 不会——它没有种子价值。这使得 PRNG（在某种程度上）适用于密码流算法。给定相同初始化向量（用作一个或多个 PRNG 的种子值）的两台计算机可以使用纯文本字节的异或结果和使用的种子 PNG 的输出有效地私下相互通信。

当然，我并不是说这样的实现一定是加密安全的。只是这样的实现需要 CSPRNG 不提供的 PRNG 的可预测性。

# .net - 将参数绑定到 Windows 工作流实例并忽略未使用的参数

> ID：668365
> 
> 赞同：0
> 
> 时间：2009-03-20T23:36:15.377
> 
> 标签：.net, workflow-foundation

我在 a 中有一堆命名值参数`Dictionary<string, object>`，我想将它们传递到不同的工作流程中。问题是每个工作流只需要字典中属性的一个子集，而且我事先不知道哪个工作流需要哪些属性。

问题是，当我使用要绑定的字典调用 WorkflowRuntime.CreateWorkflow 时，它失败了：

```
The activity '<workflow name>' has no public writable property named '<property name>' 
```

我知道这意味着什么。未定义工作流中的属性，因为此特定工作流不需要该特定属性（其他工作流可能）。

无论如何将字典绑定到工作流属性，以及未在工作流中定义的 IGNORE 属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T07:43:48.413

为什么不将字典传递到工作流实例中？然后，您的工作流定义只需要具有该字典的属性。

```
var inputs = Dictionary<string, YOUR_CUSTOM_TYPE>();
// ...
// fill your dictionary according to the context
// ...
var inputParams = new Dictionary<string, object>();
inputParams["WF_PROP_NAME"] = inputs;
var wfInstance = wfRuntime.CreateWorkflow(WF_TYPE, inputParams); 
```

这样，您的工作流程就可以从字典中获取感兴趣的字典项目。

# mysql - MySQL FULLTEXT 搜索 >1 表

> ID：668371
> 
> 赞同：4
> 
> 时间：2009-03-20T23:41:59.950
> 
> 标签：mysql, full-text-search

作为[这个问题](https://stackoverflow.com/questions/668210/mysql-syntax-and-or-performace)的更一般情况，因为我认为更多人可能会感兴趣......在两个表上执行全文搜索的最佳方法是什么？假设有三张表，一张用于程序（带有submitter_id），一张用于标签和描述，带有object_id：外键引用程序中的记录。我们想要在标签或描述中包含特定文本的程序的 submitter_id。我们必须使用 MATCH AGAINST 原因我不会在这里讨论。不要挂在这方面。

```
programs
  id
  submitter_id
tags_programs
  object_id
  text
descriptions_programs
  object_id
  text 
```

以下工作并在 20 毫秒左右执行：

```
SELECT p.submitter_id
FROM programs p
WHERE p.id IN
    (SELECT t.object_id
    FROM titles_programs t
    WHERE MATCH (t.text) AGAINST ('china')
UNION ALL
    SELECT d.object_id
    FROM descriptions_programs d
    WHERE MATCH (d.text) AGAINST ('china')) 
```

但我尝试将其重写为 JOIN，如下所示，它运行了很长时间。我必须在 60 秒后杀死它。

```
SELECT p.id 
FROM descriptions_programs d, tags_programs t, programs p
WHERE (d.object_id=p.id AND MATCH (d.text) AGAINST ('china'))
OR    (t.object_id=p.id AND MATCH (t.text) AGAINST ('china')) 
```

只是出于好奇，我用 AND 替换了 OR。这也可以在几毫秒内运行，但这不是我需要的。上面的第二个查询有什么问题？我可以使用 UNION 和子选择，但我想了解。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T23:45:18.163

在过滤器之后加入（例如加入结果），不要尝试加入然后过滤。

原因是您失去了对全文索引的使用。

对评论的澄清：我在这里一般使用join这个词，而不是作为`JOIN`merge或combine的同义词。

我本质上是说你应该使用第一个（更快的）查询，或者类似的东西。它更快的原因是每个子查询都足够整洁，数据库可以使用该表的全文索引非常快速地进行选择。加入两个（可能要小得多）结果集（用`UNION`）也很快。这意味着整个过程很快。

慢速版本最终会遍历大量数据来测试它是否是您想要的，而不是快速筛选数据并仅搜索您可能真正想要的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T00:10:49.630

以防万一您不知道：MySQL 有一个名为[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)的内置语句，可用于查看表面下发生的情况。有很多关于此的文章，所以我不会详细介绍，但对于每个表，它提供了它需要处理的行数的估计值。如果您查看第二个查询的 EXPLAIN 结果中的“行”列，您可能会看到行数非常大，而且肯定比第一个查询大很多。

网络上充斥着关于在 MySQL 中使用子查询的警告，但事实证明，很多时候开发人员比 MySQL 优化器更聪明。在许多情况下，在加入之前以某种方式过滤结果会导致性能大幅提升。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T23:46:57.613

如果你加入两个表，你最终会有很多记录要检查。举个例子，如果两个表都有 100,000 条记录，则完全连接它们会为您提供 10,000,000,000 条记录（100 亿！）。

如果您通过 AND 更改 OR，那么您允许引擎从 table descriptions_programs 中过滤掉所有与“china”不匹配的记录，然后才*加入*titles_programs。

无论如何，这不是你所需要的，所以我建议坚持使用 UNION 方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T23:48:55.767

工会是正确的方法。连接将同时拉入两个全文索引，并且可以将实际执行的检查次数增加几倍。

# deployment - 更新网站的最佳实践

> ID：668374
> 
> 赞同：3
> 
> 时间：2009-03-20T23:42:38.357
> 
> 标签：deployment, web, sysadmin

目前我的工作流程如下：

在本地机器上，我在我正在处理的每个网站上维护一个 git repo，当需要发布一些东西时，我压缩文件夹并通过 ssh 将这个单个文件上传到生产服务器，然后我解压缩，测试更改并移动更改到 live 文件夹，我摆脱了 .git 文件夹。

我想知道在实时服务器上使用 git repo 是否是一个好主意，一开始似乎是这样，但如果与本地开发机器相比，生产服务器上的更改看起来不一样，这可能会出现问题...这可能会引发火灾...如何在生产服务器上的某个文件夹上创建一个裸仓库然后从那里克隆到公用文件夹，从而将更新从本地计算机推送到裸仓库并从公用文件夹上的裸仓库中提取生产服务器的...可能有人请提供一些反馈。

后来我读到了 capistrano [http://capify.org](http://capify.org)但我没有使用这个软件的经验......

根据您的经验，完成网站部署/更新的最佳实践/方法是什么？

提前感谢您的反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T00:00:35.273

我不认为我们的方法可以称为最佳实践，但它对我们很有帮助。

我们的应用程序有几个大型数据库（20gb+），因此在每台开发人员计算机上维护本地副本从来都不是真正的选择，即使我们不针对实时数据库进行开发，我们确实需要针对数据库进行开发这是尽可能接近真实的东西。

因此，我们也使用了一个中央 Web 服务器，并在其上保留了我们的 subversion 主干的开发分支。通常我们不会同时在系统的同一部分工作，但是当我们确实需要这样做时，或者有人正在做很多实质性的改变时，我们会分支主干并在开发服务器上创建一个新的虚拟主机。

我们还检查了生产服务器上的代码，所以在我们完成测试后，我们只需在生产服务器上进行 svn 更新。我们已经实现了一个脚本，它使用 ssh 在所有服务器上执行更新命令。这非常方便，因为我们的代码库很大并且需要很长时间才能上传。Subversion 只会复制实际已更改的文件，因此速度要快得多。

这对我们来说非常有效，唯一需要注意的是直接在生产服务器上进行更改（当然从一开始就禁止这样做），因为它可能会在更新时引起冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:53:01.373

我从没想过在服务器上有一个存储库副本。看完后觉得可能很酷……不过，不做测试直接在live环境中更新文件并不是什么好主意。

您应该始终更新与实时环境（网络服务器 + 数据库版本，如果有的话）*完全*匹配的辅助环境并在那里进行测试。如果一切顺利，则将实时站点置于维护状态，更新文件，然后重新启动。

所以我不会让实时站点成为存储库的副本，但您可以使用测试环境来做到这一点。您将节省 SSH + 压缩时间，此外，您还可以查看您想要测试的任何特定版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T00:21:30.120

卡皮斯特拉诺很棒。默认配方 文档参差不齐，但邮件列表是活跃的，而且设置起来非常容易。你在运行 Rails 吗？它为 Rails 应用程序提供了一些简洁的内置内容，但也经常与其他类型的 web 应用程序一起使用。

还有[Webistrano](http://blog.innerewut.de/2008/11/3/webistrano-1-4-released)，它基于 Capistrano 但有一个 Web 前端。自己没用过。至少在 Rails 用户中，另一个似乎正在获得一些牵引力的部署系统是[Vlad the Deployer](http://rubyhitsquad.com/Vlad_the_Deployer.html)。

# javascript - 如何从 javascript 启动 Flash 视频？

> ID：668377
> 
> 赞同：1
> 
> 时间：2009-03-20T23:43:26.437
> 
> 标签：javascript, flash, playback

是否可以通过使用 javascript 代码开始在 Flash 播放器中播放文件？如果是这样，我会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T23:54:12.307

尝试使用[swfObject](http://blog.deconcept.com/swfobject/)，您可以使用 javascript 使任何 actionscript 函数可见，`ExternalInterface`并将它们声明为 javascript。`play()`因此，您可以从您的 javascript 代码中使用（或您想要的任何其他代码）触发 actionscript 函数。

这是一个例子：

动作脚本：

```
import flash.external.ExternalInterface;

ExternalInterface.addCallback( "methodName", this, method );
function method() {
   trace("called from javascript");
} 
```

Javascript：

```
function callAS() {
   swf.methodName(); 
} 
```

其中 methodName 是 js 用来从 actionscript 调用方法的标识符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T23:55:57.343

看看[SWFObject](http://blog.deconcept.com/swfobject/)。有很多关于如何做到这一点的例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T23:54:37.267

是的。可以从js中引用flash影片对象，控制页面中的flash组件。不幸的是，您这样做的方式不能跨浏览器移植。看到这个：

[http://www.permadi.com/tutorial/flashjscommand/](http://www.permadi.com/tutorial/flashjscommand/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-02T21:59:54.663

如果您必须从 Javascript 中执行此操作，请考虑打开自动播放参数，如下所示：

假设您已经获取了对象/嵌入的父级（ vidParent ）：

```
if( document.all) {
  // toggle the object code (IE)
  vidParent.innerHTML = vidParent.innerHTML.replace(/0\" name=\"autoplay/gi,'1\" name=\"autoplay');
} else {
  // toggle the embed code
  vidParent.innerHTML = vidParent.innerHTML.replace(/autoplay=0/gi,'autoplay=1'); 
} 
```

这将使用 autoplay = 1 重新加载 Flash（此示例适用于 YouTube 播放器）。

我必须这样做才能对视频播放进行一些跟踪。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-07T14:25:45.353

这里建议了一个有趣的方法：[http ://www.permadi.com/tutorial/flashjscommand/](http://www.permadi.com/tutorial/flashjscommand/)

为我工作！

这个想法是`embed`使用

```
function getFlashMovieObject(movieName)
{
  if (window.document[movieName]) 
  {
      return window.document[movieName];
  }
  if (navigator.appName.indexOf("Microsoft Internet")==-1)
  {
    if (document.embeds && document.embeds[movieName])
      return document.embeds[movieName]; 
  }
  else // if (navigator.appName.indexOf("Microsoft Internet")!=-1)
  {
    return document.getElementById(movieName);
  }
} 
```

并在之后调用它的`Play()`方法。

```
getFlashMovieObject('MyMovie').Play() 
```

支持其他几种方法，请参阅上面的链接。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T23:56:07.077

您可以从 JavaScript 调用 Flash 中的任何自定义函数，这需要您同时编写 Javascript 和 Flash。

有关示例，请参见此处：http: //kb.adobe.com/selfservice/viewContent.do?externalId= [tn_15683](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_15683)。

此外，在从 JavaScript 处理 Flash 时，使用[SwfObject也有很大帮助。](http://code.google.com/p/swfobject/)

# c# - 如何在.Net中获得最大允许的文件大小？

> ID：668380
> 
> 赞同：2
> 
> 时间：2009-03-20T23:46:17.600
> 
> 标签：c#, .net, filesize

有谁知道如何（本机）获取给定驱动器/文件夹/目录的最大允许文件大小？至于 Fat16，它大约是 2gb，Fat32 是 4gb，据我记得，对于较新的 NTFS 版本，它远远超出了这个范围……更不用说 Mono 和底层操作系统了。

有什么我可以读出/检索到的可以给我提示的吗？基本上我 - 知道 - 可能应用程序会产生比 2gb 更大的单个文件，我想在用户设置相应的输出路径时检查它......

干杯和感谢，-J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T00:11:40.440

如何使用 System.Info.DriveInfo.DriveFormat 检索驱动器的文件系统（NTFS、FAT 等）？这应该至少让您了解支持的文件大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T00:17:53.810

这可能不是理想的解决方案，但无论如何我都会提出以下建议：

```
// Returns the maximum file size in bytes on the filesystem type of the specified drive.
long GetMaximumFileSize(string drive)
{
    var driveInfo = new System.IO.DriveInfo(drive)

    switch(driveInfo.DriveFormat)
    {
        case "FAT16":
            return 1000; // replace with actual limit
        case "FAT32":
            return 1000; // replace with actual limit
        case "NTFS":
            return 1000; // replace with actual limit
    }
}

// Examples:
var maxFileSize1 = GetMaximumFileSize("C"); // for the C drive
var maxFileSize2 = GetMaximumFileSize(absolutePath.Substring(0, 1)); // for whichever drive the given absolute path refers to 
```

[Wikipedia 上的此](http://en.wikipedia.org/wiki/Comparison_of_file_systems#Limits)页面包含一个非常全面的列表，其中列出了各种文件系统的最大文件大小。根据您要在`GetMaximumFileSize`函数中检查的文件系统的数量，您可能希望使用 Dictionary 对象甚至是简单的数据文件，而不是 switch 语句。

现在，您*可能*会直接使用 WMI 甚至可能是 Windows API 来检索最大文件大小，但这些解决方案当然只能与 Windows 兼容（即与 Mono/Linux 不兼容）。然而，我认为这是一个相当不错的纯托管解决方案，尽管使用了查找表，并且具有在所有操作系统上可靠工作的好处。

希望有帮助。

# c# - WPF：XAML 自定义命名空间

> ID：668384
> 
> 赞同：0
> 
> 时间：2009-03-20T23:47:45.833
> 
> 标签：c#, wpf, xaml, namespaces

> **可能重复：**
> [WPF：XAML 自定义命名空间](https://stackoverflow.com/questions/669560/wpf-xaml-custom-namespace)

好的，所以我在 WPF 中有一个窗口。我在其中添加以下行：

```
xmlns:controls="clr-namespace:mCubed.Controls" 
```

这编译并运行得很好，但是 Visual Studio 设计器给了我这个错误：

> 无法加载文件或程序集“mCubed，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

当我从窗口中删除这一行时，它编译并运行得很好，Visual Studio 设计器就像一个魅力！

我很困惑为什么那一行会破坏设计师？***如果我将以下行***放在 XAML 文档的正文中，就会发生这种情况。

```
<controls:MyControl/> 
```

# .net - 为 WCF 配置传输安全性

> ID：668385
> 
> 赞同：1
> 
> 时间：2009-03-20T23:48:27.097
> 
> 标签：.net, wcf

我有一个托管 WCF 服务的 Windows 服务，以及作为客户端的另一台机器上的 Web 服务。我将 nettcpbinding 设置为使用 Windows 身份验证传输安全性。我是否正确假设运行 web 服务的 Windows 用户必须有权访问另一台机器上的 WCF 服务？如果 web 服务在 NetworkService 下运行，是否可以使用它或者我需要设置一个新用户才能使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T00:15:29.527

是的，您需要设置另一个用户。网络服务是本地用户，不会存在于 WCF 主机上。（确实如此，但它有一个不同的密码，因此不共享）

您有几个选择 - 如果两台机器都在域中，您可以作为域用户运行 Web 应用程序池，或者如果您在工作组中，您可以在两台机器上创建相同的用户名/密码组合并配置 Web在该帐户下运行的网站。在任何一种情况下，您都需要通过发出

```
aspnet_regiis -ga MachineName\AccountName 
```

如果您在域和 kerberos 身份验证中，那么您还需要为新用户帐户设置 SPN

```
setspn -A HTTP/webservername domain\customAccountName
setspn -A HTTP/webservername.fullyqualifieddomainname domain\customAccountName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T23:58:54.450

有关网络服务的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms684272(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms684272(VS.85).aspx)。将会发生的情况是，您的 WCF 客户端将尝试以 domain\computername$ 身份对托管服务的计算机进行身份验证。我个人更喜欢有一个特定的身份用于审计目的。

# c# - 从 C# 调用 CreateProcessAsUser

> ID：668389
> 
> 赞同：12
> 
> 时间：2009-03-20T23:49:05.207
> 
> 标签：c#, winapi, process, privileges, createprocessasuser

我一直在尝试使用`CreateProcessAsUser`Windows API 的功能在特定用户的上下文中创建一个新进程，但似乎遇到了一个相当讨厌的安全问题......

在我进一步解释之前，这是我当前用于启动新进程的代码（控制台进程 - 具体来说是 PowerShell，尽管它不重要）。

```
 private void StartProcess()
    {
        bool retValue;

        // Create startup info for new console process.
        var startupInfo = new STARTUPINFO();
        startupInfo.cb = Marshal.SizeOf(startupInfo);
        startupInfo.dwFlags = StartFlags.STARTF_USESHOWWINDOW;
        startupInfo.wShowWindow = _consoleVisible ? WindowShowStyle.Show : WindowShowStyle.Hide;
        startupInfo.lpTitle = this.ConsoleTitle ?? "Console";

        var procAttrs = new SECURITY_ATTRIBUTES();
        var threadAttrs = new SECURITY_ATTRIBUTES();
        procAttrs.nLength = Marshal.SizeOf(procAttrs);
        threadAttrs.nLength = Marshal.SizeOf(threadAttrs);

        // Log on user temporarily in order to start console process in its security context.
        var hUserToken = IntPtr.Zero;
        var hUserTokenDuplicate = IntPtr.Zero;
        var pEnvironmentBlock = IntPtr.Zero;
        var pNewEnvironmentBlock = IntPtr.Zero;

        if (!WinApi.LogonUser("UserName", null, "Password",
            LogonType.Interactive, LogonProvider.Default, out hUserToken))
            throw new Win32Exception(Marshal.GetLastWin32Error(), "Error logging on user.");

        var duplicateTokenAttrs = new SECURITY_ATTRIBUTES();
        duplicateTokenAttrs.nLength = Marshal.SizeOf(duplicateTokenAttrs);
        if (!WinApi.DuplicateTokenEx(hUserToken, 0, ref duplicateTokenAttrs,
            SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation, TOKEN_TYPE.TokenPrimary,
            out hUserTokenDuplicate))
            throw new Win32Exception(Marshal.GetLastWin32Error(), "Error duplicating user token.");

        try
        {
            // Get block of environment vars for logged on user.
            if (!WinApi.CreateEnvironmentBlock(out pEnvironmentBlock, hUserToken, false))
                throw new Win32Exception(Marshal.GetLastWin32Error(),
                    "Error getting block of environment variables for user.");

            // Read block as array of strings, one per variable.
            var envVars = ReadEnvironmentVariables(pEnvironmentBlock);

            // Append custom environment variables to list.
            foreach (var var in this.EnvironmentVariables)
                envVars.Add(var.Key + "=" + var.Value);

            // Recreate environment block from array of variables.
            var newEnvironmentBlock = string.Join("\0", envVars.ToArray()) + "\0";
            pNewEnvironmentBlock = Marshal.StringToHGlobalUni(newEnvironmentBlock);

            // Start new console process.
            retValue = WinApi.CreateProcessAsUser(hUserTokenDuplicate, null, this.CommandLine,
                ref procAttrs, ref threadAttrs, false, CreationFlags.CREATE_NEW_CONSOLE |
                CreationFlags.CREATE_SUSPENDED | CreationFlags.CREATE_UNICODE_ENVIRONMENT,
                pNewEnvironmentBlock, null, ref startupInfo, out _processInfo);
            if (!retValue) throw new Win32Exception(Marshal.GetLastWin32Error(),
                "Unable to create new console process.");
        }
        catch
        {
            // Catch any exception thrown here so as to prevent any malicious program operating
            // within the security context of the logged in user.

            // Clean up.
            if (hUserToken != IntPtr.Zero)
            {
                WinApi.CloseHandle(hUserToken);
                hUserToken = IntPtr.Zero;
            }

            if (hUserTokenDuplicate != IntPtr.Zero)
            {
                WinApi.CloseHandle(hUserTokenDuplicate);
                hUserTokenDuplicate = IntPtr.Zero;
            }

            if (pEnvironmentBlock != IntPtr.Zero)
            {
                WinApi.DestroyEnvironmentBlock(pEnvironmentBlock);
                pEnvironmentBlock = IntPtr.Zero;
            }

            if (pNewEnvironmentBlock != IntPtr.Zero)
            {
                Marshal.FreeHGlobal(pNewEnvironmentBlock);
                pNewEnvironmentBlock = IntPtr.Zero;
            }

            throw;
        }
        finally
        {
            // Clean up.
            if (hUserToken != IntPtr.Zero)
                WinApi.CloseHandle(hUserToken);

            if (hUserTokenDuplicate != IntPtr.Zero)
                WinApi.CloseHandle(hUserTokenDuplicate);

            if (pEnvironmentBlock != IntPtr.Zero)
                WinApi.DestroyEnvironmentBlock(pEnvironmentBlock);

            if (pNewEnvironmentBlock != IntPtr.Zero)
                Marshal.FreeHGlobal(pNewEnvironmentBlock);
        }

        _process = Process.GetProcessById(_processInfo.dwProcessId);
    } 
```

为了这里的问题，忽略处理环境变量的代码（我已经独立测试了该部分，它似乎工作。）

现在，我得到的错误如下（在调用之后的行中抛出`CreateProcessAsUSer`）：

> “客户端未持有所需的权限”（错误代码 1314）

（错误消息是通过从 Win32Exception 构造函数中删除 message 参数发现的。诚然，我这里的错误处理代码可能不是最好的，但这有点无关紧要。但是，如果您愿意，欢迎您对此发表评论。 ) 对于这种情况下这种模糊错误的原因，我真的很困惑。MSDN 文档和各种论坛帖子只给了我这么多建议，尤其是考虑到此类错误的原因似乎多种多样，我不知道我需要修改哪段代码。也许这只是我需要更改的一个参数，但我可能会做出错误/不足的 WinAPI 调用，就我所知。让我非常困惑的是，以前版本的代码使用了普通的`CreateProcess`函数（除用户令牌参数外等效）工作得非常好。据我了解，只需要调用 Logon 用户函数来接收适当的令牌句柄，然后复制它，以便它可以传递给`CreateProcessAsUser`.

非常欢迎对代码修改和解释提出任何建议。

## 笔记

我主要指的是 MSDN 文档（以及用于 C# 函数/strut/enum 声明的[PInvoke.net ）。](http://pinvoke.net)特别是以下页面似乎在备注部分中有很多信息，其中一些可能很重要并且我无法理解：

*   [CreateProcessAsUser 函数](http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx)
*   [登录用户功能](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)
*   [DuplicateTokenEx 函数](http://msdn.microsoft.com/en-us/library/aa446617(VS.85).aspx)

# 编辑

我刚刚尝试了 Mitch 的建议，但不幸的是，旧的错误刚刚被一个新的错误所取代：“系统找不到指定的文件。” （错误代码 2）

之前的调用`CreateProcessAsUser`已替换为以下内容：

```
retValue = WinApi.CreateProcessWithTokenW(hUserToken, LogonFlags.WithProfile, null,
    this.CommandLine, CreationFlags.CREATE_NEW_CONSOLE |
    CreationFlags.CREATE_SUSPENDED | CreationFlags.CREATE_UNICODE_ENVIRONMENT,
    pNewEnvironmentBlock, null, ref startupInfo, out _processInfo); 
```

请注意，正如 MSDN 文档所暗示的那样，此代码不再使用重复的令牌，而是使用原始令牌。

这是使用`CreateProcessWithLogonW`. 这次的错误是“登录失败：未知用户名或密码错误”（错误代码1326）

```
retValue = WinApi.CreateProcessWithLogonW("Alex", null, "password",
    LogonFlags.WithProfile, null, this.CommandLine,
    CreationFlags.CREATE_NEW_CONSOLE | CreationFlags.CREATE_SUSPENDED |
    CreationFlags.CREATE_UNICODE_ENVIRONMENT, pNewEnvironmentBlock,
    null, ref startupInfo, out _processInfo); 
```

我还尝试以 UPN 格式（“Alex@Alex-PC”）指定用户名并将域作为第二个参数独立传递，但都无济于事（相同的错误）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-22T17:59:04.423

啊……似乎我已经被 WinAPI 互操作编程中最大的陷阱之一抓住了。此外，在这种情况下，发布我的函数声明的代码将是一个明智的主意。

无论如何，我需要做的就是向指定函数的 DllImport 属性添加一个参数`CharSet = CharSet.Unicode`。这对`CreateProcessWithLogonW`和`CreateProcessWithTokenW`函数都起到了作用。我想我终于意识到函数名称的 W 后缀指的是 Unicode，我需要在 C# 中明确指定它！如果有人感兴趣，下面是*正确的函数声明：*

```
[DllImport("advapi32", CharSet = CharSet.Unicode, SetLastError = true)]
public static extern bool CreateProcessWithLogonW(string principal, string authority,
    string password, LogonFlags logonFlags, string appName, string cmdLine,
    CreationFlags creationFlags, IntPtr environmentBlock, string currentDirectory,
    ref STARTUPINFO startupInfo, out PROCESS_INFORMATION processInfo);

[DllImport("advapi32", CharSet = CharSet.Unicode, SetLastError = true)]
public static extern bool CreateProcessWithTokenW(IntPtr hToken, LogonFlags dwLogonFlags,
    string lpApplicationName, string lpCommandLine, CreationFlags dwCreationFlags,
    IntPtr lpEnvironment, string lpCurrentDirectory, [In] ref STARTUPINFO lpStartupInfo,
    out PROCESS_INFORMATION lpProcessInformation); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T23:52:42.327

从[这里](http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx)：

> 通常，调用 CreateProcessAsUser 函数的进程必须具有 SE_ASSIGNPRIMARYTOKEN_NAME 和 SE_INCREASE_QUOTA_NAME 权限。如果此函数因 ERROR_PRIVILEGE_NOT_HELD (1314) 而失败，请改用 CreateProcessWithLogonW 函数。CreateProcessWithLogonW 不需要特殊权限，但必须允许指定的用户帐户以交互方式登录。通常，最好使用 CreateProcessWithLogonW 创建具有备用凭据的进程。

请参阅此博客文章[如何在 .NET 中调用 CreateProcessWithLogonW 和 CreateProcessAsUser](http://blogs.msdn.com/alejacma/archive/2007/12/20/how-to-call-createprocesswithlogonw-createprocessasuser-in-net.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-03T16:54:28.503

Jonathan Peppers 提供了这段很棒的代码来解决我的问题

[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/0c0ca087-5e7b-4046-93cb-c7b3e48d0dfb?ppud=4](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/0c0ca087-5e7b-4046-93cb-c7b3e48d0dfb?ppud=4)

# wpf - TreeViewItem.Header 里面有网格

> ID：668393
> 
> 赞同：2
> 
> 时间：2009-03-20T23:50:21.787
> 
> 标签：wpf, treeviewitem

我试图让“Img”出现在 TreeViewItem.Header 的末尾（靠近 TreeView 控件的右侧），但无论我尝试什么，标题宽度总是小于 TreeView 大小，当然“Img”出现在某处在控件的中间。这可能是一个非常新的问题；我刚开始学习WPF。

```
<TreeView Grid.Row="1" Grid.ColumnSpan="2" Margin="3,3,3,3" Name="treeView1" Width="300">
    <TreeViewItem HorizontalAlignment="Stretch">
        <TreeViewItem.Header>
            <Grid HorizontalAlignment="Stretch">
                <Grid.RowDefinitions>
                    <RowDefinition  />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="30" />
                </Grid.ColumnDefinitions>

                <Label Grid.Column="0" Grid.Row="0">General</Label>
                <Label Grid.Column="1" Grid.Row="0">Img</Label>
            </Grid>
        </TreeViewItem.Header>
    </TreeViewItem>
</TreeView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T00:15:56.763

为此，您需要使用 TreeView 的 ItemContainerStyle 更改 TreeviewItem 的 Control 模板（这是应用于树视图根目录中任何项目的样式）。

默认的 TreeViewItem 没有被拉伸，因此它不会一直向右延伸。当您设置 Header 时，它位于 TreeViewItem 内，因此不能超出它。

我不会发布整个样式，因为它太长了。

这是在 Blend 中要做的事情：选择您的 TreeViewItem，右键单击并选择“编辑控制部件/编辑副本”。将样式保存在您想要的任何位置。

现在，在模板中，展开这些东西并找到“Bd”元素，它是一个边框。将其 RowSpan 属性更改为“2”。

最后，将项目的“Horizo​​ntalContentAlignment”属性设置为“Stretch”（如果需要将其应用于多个节点，可以在项目上或通过样式）。

您的项目现在应该是正确的宽度。现在，这仅适用于您选择的项目。如果您希望它适用于添加到树视图的任何项目，则需要将树视图的“ItemContainerStyle”更改为新创建的样式，并删除 Blend 放置在 TreeViewItem 上的样式。

最后但并非最不重要的一点是，您需要将 TreeViewItem 的 ItemContainerStyle 设置为相同的样式，以便其子项也一直延伸，依此类推。

所以最后，用你的例子和第一项上的子节点：

```
<Grid x:Name="LayoutRoot">
<TreeView Margin="3,3,3,3" Name="treeView1" Width="300" ItemContainerStyle="{DynamicResource TreeViewItemStyle1}">
<TreeViewItem HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" ItemContainerStyle="{DynamicResource TreeViewItemStyle1}">
    <TreeViewItem.Header>
        <Grid HorizontalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition  />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="30" />
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Grid.Row="0">General</Label>
            <Label Grid.Column="1" Grid.Row="0">Img</Label>
        </Grid>
    </TreeViewItem.Header>
    <TreeViewItem>
     <TreeViewItem.Header>
        <Grid HorizontalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition  />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="30" />
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Grid.Row="0">General</Label>
            <Label Grid.Column="1" Grid.Row="0">Img</Label>
        </Grid>
    </TreeViewItem.Header>
</TreeViewItem>
</TreeViewItem> 
```

“TreeViewItemStyle1”是 Blend 为您创建的样式。

编辑

根据要求，这是由混合和修改生成的完整样式。它很长，因为它基本上是对内置样式进行了少量修改的副本。

```
<Style x:Key="TreeViewItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <PathGeometry x:Key="TreeArrow" Figures="M0,0 L0,6 L6,0 z"/>
        <Style x:Key="ExpandCollapseToggleStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Width" Value="16"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Width="16" Height="16" Background="Transparent" Padding="5,5,5,5">
                            <Path Fill="Transparent" Stroke="#FF989898" x:Name="ExpandPath" Data="{StaticResource TreeArrow}">
                                <Path.RenderTransform>
                                    <RotateTransform Angle="135" CenterX="3" CenterY="3"/>
                                </Path.RenderTransform>
                            </Path>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Stroke" TargetName="ExpandPath" Value="#FF1BBBFA"/>
                                <Setter Property="Fill" TargetName="ExpandPath" Value="Transparent"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="RenderTransform" TargetName="ExpandPath">
                                    <Setter.Value>
                                        <RotateTransform Angle="180" CenterX="3" CenterY="3"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Fill" TargetName="ExpandPath" Value="#FF595959"/>
                                <Setter Property="Stroke" TargetName="ExpandPath" Value="#FF262626"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="TreeViewItemStyle1" TargetType="{x:Type TreeViewItem}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="Padding" Value="1,0,0,0"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
            <Setter Property="FocusVisualStyle" Value="{StaticResource TreeViewItemFocusVisual}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MinWidth="19" Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <ToggleButton x:Name="Expander" Style="{StaticResource ExpandCollapseToggleStyle}" ClickMode="Press" IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <Border x:Name="Bd" SnapsToDevicePixels="true" Grid.Column="1" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" Grid.ColumnSpan="2">
                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" x:Name="PART_Header" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" ContentSource="Header"/>
                            </Border>
                            <ItemsPresenter x:Name="ItemsHost" Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="1"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="false">
                                <Setter Property="Visibility" TargetName="ItemsHost" Value="Collapsed"/>
                            </Trigger>
                            <Trigger Property="HasItems" Value="false">
                                <Setter Property="Visibility" TargetName="Expander" Value="Hidden"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="true">
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="true"/>
                                    <Condition Property="IsSelectionActive" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T03:01:07.443

有关两个示例，请参见这篇文章。我今天刚刚创建了这些。

[在 WPF 中突出显示整个 TreeViewItem 行](https://stackoverflow.com/questions/664632/highlight-whole-treeviewitem-line-in-wpf)

# version-control - 管理来自 3rd 方 API 的代码更改

> ID：668396
> 
> 赞同：2
> 
> 时间：2009-03-20T23:51:59.037
> 
> 标签：version-control

我正在使用作为源代码分发的第 3 方 API。这很棒，因为我可以自己解决问题，但我也收到了来自第 3 方的大量更新。

我的代码库有我自己的 svn 存储库，其中包括我的 API 版本。我通过从 3rd 方的 svn 存储库中检查一个版本来获得官方 API 更新。

合并更改是一个痛苦的过程。有一个更好的方法吗？使用分布式源代码控制系统会更容易吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T23:55:42.117

问题是您将自己与 API 耦合。如果可以的话，找到一种方法来扩展 API 而不是修改它。将其放在单独的模块或其他编译输出（即.JAR、.DLL、.SO 文件）中。尝试将自己与它脱钩。

如果你不能做到这一点，那么你几乎会被困在每个版本的合并中。

当然，如果 API 是开源的，您可能会考虑*提交*您的更改...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T23:55:46.640

我认为分布式版本控制系统在您的场景中不会有太大帮助，因为您似乎将成为合并到您自己的存储库的人。如果合并的本质是 API 和依赖于该 API 的代码，那么没有什么可以帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T00:04:04.360

从您的代码中抽象出 API。您可以使用许多设计模式（外观、代理等），它们将帮助您使代码免受 API 更改的影响。如果 API 发生更改，请更改与其交互的代码，而不是 API 本身。每次他们更新代码时，您仍然需要对代码进行更改，但至少它会是最小的并且被隔离在一个地方。

# vim - 粘贴到 Vim 时如何避免出现额外的括号

> ID：668406
> 
> 赞同：6
> 
> 时间：2009-03-20T23:55:55.597
> 
> 标签：vim, mapping

我在编码时使用了一些地图：

```
imap ( ()<C-[>i
imap [ []<C-[>i
imap { {}<C-[>i 
```

因此，当我输入 "(" 时，它会写入 "()" （对于 "[" 和 "{" 也是如此）。问题是当我将某些内容粘贴到 Vim 时：

```
for (i = 0; i < count; i++) {
tab[i] = something()
} 
```

我明白了

```
for (i = 0; i < count; i++) {
tab[i] = something()
}  
)]}) 
```

是否可以避免额外的括号？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T23:59:09.707

你想要这个`'paste'`选项；用`:set paste`. 它禁用插入模式映射、缩写和其他自动格式化选项。

另一件事是有多种粘贴方式：

*   `"+p`
*   `:set mouse=a`然后中键单击
*   插入模式，`<C-R>+`
*   `:a!`然后使用终端的粘贴命令

所有这些都将正确粘贴。唯一让 vim 感到困惑的是，当您使用终端的“粘贴”命令而没有事先警告它时。

# .net - 通过串行端口以编程方式打印天平

> ID：668409
> 
> 赞同：0
> 
> 时间：2009-03-20T23:56:26.873
> 
> 标签：.net, compact-framework, serial-port

如何？我正在使用 SerialPort.Write 函数，它看起来大部分时间都可以工作，但突然停止工作。

我还注意到，每次我发送打印命令时（即使我遵循手册，P 和回车），我都会得到包含“ES”的字符串 - 根据手册，即使重量被捕获，这也意味着错误。然后突然，秤完全停止对打印命令做出反应。

这是我的代码：

```
 //send the print command to the balance:
                 Byte[] bytes = {80, 13}; //50 0D

                _sp.Write(bytes,0,bytes.Length); 
```

_sp 是 SerialPort 类的一个实例。我正在使用 OHAUS CD-11 天平；应用程序是用 c# 在紧凑框架 2.0、hp 瘦客户端、WinCE 5.0 上编写的

任何想法表示赞赏。应该很简单，但显然不是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T00:29:38.277

您确定您的波特率/停止位等是否正确（参见手册第 12 和 13 页）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T12:41:18.143

即使手册建议这样做，也许只是 CR 不起作用？即你试过了吗

```
Byte[] bytes = {80, 13, 10}; //50 0D 0A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-08T14:30:18.577

在 OHAUS Valor 7000 上返回给我的 ES 字符串时，我遇到了同样的问题。

我正在使用 ctrl-j 使用腻子进行测试以发送 CRLF 并不断返回 es。我最终击中了大写锁定并开始工作。

在我的代码中，发送 0x50 不起作用，但发送十进制 80 最终会像上面的建议一样工作，这很奇怪，因为 0x50 = 80。

# sql - .Net 中用于构建 SQL 语句的 DOM 库

> ID：668410
> 
> 赞同：0
> 
> 时间：2009-03-20T23:58:02.937
> 
> 标签：sql, sql-server-2005, dom, .net-2.0

## 是否有任何用于构建 sql 语句的 .Net 库？

（顺便说一句，我已经了解 ADO.NET SqlCommand、SqlParameter 类）

我目前正在开发一个库来做到这一点，但现在想知道是否已经有一些可能更好的东西。

**编辑：**

在这一点上，我只对返回一个 DataTable 对象感兴趣，因为我正在开发一个报告功能，因此我对 LINQ 不太感兴趣（如果你认为我被误导了，请纠正我）。

我的主要目标是使用户能够从 CheckBoxList 中选择报告的字段名称，并能够添加/删除过滤表达式（即编辑 WHERE 子句）。添加字段可能意味着包括子选择，而不仅仅是在 select 子句中包括字段名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T00:05:17.397

您正在寻找[LINQtoSQL](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)，它是 .NET Framework 3.5 中附带的**关系映射实现**，允许您使用 .NET 类对关系数据库进行建模。

**编辑-**

由于您使用 .NET 2.0 和[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)，您将能够使用 C# 3.0 编译器的全部功能编写本地**LINQ to Objects 查询**，而您的程序将只需要 .NET 2.0。

# objective-c - NSMutableArray 作为@property 只读

> ID：668418
> 
> 赞同：4
> 
> 时间：2009-03-21T00:01:45.863
> 
> 标签：objective-c

假设我有这样的事情：

```
@property (readonly) NSMutableArray *someArray; 
```

即使 @property 设置为只读，我可以修改 [obj someArray] 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-21T00:06:38.800

是的，您可以修改其内容。readonly 仅适用于指针本身 - 这样，它*不像*C++ 的`const`.

基本上，说“只读”只是意味着“不要翻译`a.someArray = foo`成`[a setSomeArray:foo]`”。也就是说，没有创建setter。

（当然，如果你想防止修改，你只需使用 an`NSArray`代替。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T00:14:39.437

someArray 的内容是可修改的，尽管属性不是（即调用不能通过`someArray`分配给属性来更改实例变量的值）。请注意，这与 C++ 的语义不同`const`。如果您希望该数组实际上是只读的（即读者无法修改），您需要使用自定义访问器包装它。在`@interface`（假设您的`someArray`财产）

```
@property (readonly) NSArray *readOnlyArray; 
```

并且在`@implementation`

```
@dynamic readOnlyArray;

+ (NSSet*)keyPathsForValuesAffectingReadOnlyArray {
  return [NSSet setWithObject:@"someArray"];
}
- (NSArray*)readOnlyArray {
  return [[[self someArray] copy] autorelease];
} 
```

请注意，调用者仍然能够改变数组中对象的状态。如果你想防止*这种*情况发生，你需要使它们在插入时不可变或在`readOnlyArray`访问器中执行数组的 depp-copy。

# php - php mod重写

> ID：668419
> 
> 赞同：0
> 
> 时间：2009-03-21T00:02:51.337
> 
> 标签：php, apache, mod-rewrite

我有一个规则：

```
重写规则 ^cat_ap~([^~]+)~(.*)\.htm$ /urban/cat_ap.php?$1=$2 [L]

```

转到 cat_ap.php?nid=xxxxxxx

现在我必须添加一些其他支持。

```
cat_ap~pnid~290~nid~96666~posters~Sports.htm

```

需要解析为 cat_ap.php?pnid=290&nid=96666 （我不关心链接的结尾，尽管我确实需要它来处理传统的付费搜索流量）。

另外，我需要从链接中获取 page_num 来计算分页。

```
cat_ap~PageNum_GetProduct~10~nid~290.htm 需要解析为 cat_ap.php?PageNum_GetProduct=10&nid=290

```

我有点需要将所有这些场景包含在单个或多个规则中。

有任何想法吗？我现在正在阅读此内容，但被卡住了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T00:27:42.663

在这种情况下，我建议使用规则**RewriteRule ^cat_ap(~.*).htm$ /urban/cat_ap.php?$1 [L]**以捕获所有可能的组合并分解您的 php 应用程序中的字符串.

这样调试参数会更容易，因为 apache 有时会很混蛋。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T00:28:28.513

这是一个将遍历 URL 中的键/值对的解决方案：

```
RewriteRule ^cat_ap~([^~]+)~([^~]+)(.*)\.htm$ cat_ap$1?$1=$2 [N,QSA]
RewriteRule ^cat_ap(.*)\.htm$ /urban/cat_ap.php [L] 
```

*它从 URL 中获取第一对，然后将其重写为没有*该对的完全相同的 URL，将这对添加到查询字符串 ( `[QSA]`) 并重新开始重写过程 ( `[N]`)。当 URL 中不再有键/值对时，它会将其重写到脚本的位置并终止重写 ( `[L]`)。

```
cat_ap~pnid~290~nid~96666~posters~Sports.htm => /urban/cat_ap.php?posters=Sports&nid=96666&pnid=290
cat_ap~PageNum_GetProduct~10~nid~290.htm => /urban/cat_ap.php?nid=290&PageNum_GetProduct=10 
```

（请注意，参数的顺序是颠倒的；这仅在同一个参数出现多次时才有意义。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T00:26:27.410

试试这两种情况：

```
RewriteRule ^cat_ap~([^~]+)~([0-9]+)~([^~]+)~([0-9]+)(.*)\.htm$ /urban/cat_ap.php?$1=$2&$3=$4 [L] 
```

# c# - 如何：项目组织和输出

> ID：668429
> 
> 赞同：0
> 
> 时间：2009-03-21T00:10:12.677
> 
> 标签：c#, ide, namespaces

我现在正在开发一个相当不错的项目，但是我需要根据它们预期的运行时“环境”来分离一些组件。

例如：

MyNameSpace.MyProductName.Admin（父类 - 助手类） MyNameSpace.MyProductName.Admin.Terminal（子类 - 最终用户的 UI：消费者） MyNameSpace.MyProductName.Admin.Database（子类 - 数据库管理员和监控的 UI） MyNameSpace。 MyProductName.Admin.Management（子类 - 最终用户的 UI：管理）

有没有办法在 IDE 中将这些逻辑分开，输出将产生以下结构？

MyNameSpace\MyProductName\Admin\MyProductName.*.dlls

MyNameSpace\MyProductName\Admin\Terminal\MyProductName.*.dlls, MyProductName.Terminal.exe

MyNameSpace\MyProductName\Admin\Database\MyProductName.*.dlls, MyProductName.Database.exe

MyNameSpace\MyProductName\Admin\Management\MyProductName.*.dlls, MyProductName.Management.exe

还是我需要为每个 UI 创建单独的项目？

提前致谢，

E.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T00:12:34.870

AFAIK，一个项目只能产生1个o/p，所以你需要将这些作为项目组织在一个解决方案中，并将带有exe的项目添加为启动项目进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T00:33:12.887

我能够在“MyNameSpace”解决方案文件夹下添加另一个解决方案文件夹。

这允许我将 UI 项与应用程序项分开。

再次感谢！

# javascript - Facebook 如何在加载不同页面时保持页眉和页脚固定？

> ID：668431
> 
> 赞同：15
> 
> 时间：2009-03-21T00:11:00.740
> 
> 标签：javascript, html, ajax, facebook, navigation

浏览 Facebook 页面时，页眉和固定页脚部分在页面加载之间保持可见，并且地址栏中的 URL 会相应更改。至少，这是我得到的错觉。

从技术上讲，Facebook 是如何做到这一点的？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-21T00:28:32.757

请参阅 Mark Brittingham 的回答以了解如何设置它的样式，尽管我认为这不是您在这里要问的。我将为您提供有关它如何工作的技术细节（以及为什么它相当出色）。

当您将鼠标悬停在标题中的“个人资料”链接上时，请查看状态栏...

> [http://www.facebook.com/profile.php?id=514287820&ref=profile](http://www.facebook.com/profile.php?id=514287820&ref=profile)

这就是 <a> 标签所指向的地方。现在单击地址栏时查看它...

> [http://www.facebook.com/home.php#/profile.php?id=514287820&ref=profile](http://www.facebook.com/home.php#/profile.php?id=514287820&ref=profile)

注意“#”[片段标识符/哈希](http://en.wikipedia.org/wiki/Number_sign#Other_uses)？这基本上证明你没有离开页面，并且之前的请求是用 AJAX 发出的。他们正在拦截这些链接上的点击事件，并用他们自己的东西覆盖默认功能。

要使用 Javascript 实现这一点，您所要做的就是为这些链接分配一个点击事件处理程序，就像这样......

```
var header = document.getElementById('header');
var headerLinks = header.getElementsByTagName('a');

for(var i = 0, l = headerLinks.length; i < l; i++) {
  headerLinks[i].onclick = function() {
    var href = this.href;

    //Load the AJAX page (this is a whole other topic)
    loadPage(href);  

    //Update the address bar to make it look like you were redirected
    location.hash = '#' + href;

    //Unfocus the link to make it look like you were redirected
    this.blur();

    //Prevent the natural HTTP redirect
    return false;
  }
} 
```

这种方法的一个绝妙的好处是它允许后退按钮发挥作用（加上一点技巧），这在传统上一直是长期使用 AJAX 的痛苦副作用。我不是 100% 确定这个诡计是什么，但我敢打赌它能够以某种方式检测浏览器何时修改片段标识符（可能通过每 ~500 毫秒检查一次）。

作为旁注，将散列更改为在 DOM 中找不到的值（通过元素 ID）会将页面一直滚动到顶部。看看我在说什么：从 Facebook 顶部向下滚动大约 10 个像素，露出顶部菜单的一半。单击其中一项，它会在片段标识符更新后立即将其跳回页面顶部（没有*任何*窗口重绘/重绘延迟）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T00:19:48.190

提供看起来不变的页眉和页脚的一种方法是通过 CSS - 这是一个固定页脚的示例（注意“位置：固定;”）：

```
#Footer  { 
  font-size:xx-small; 
  text-align:left; 
  width:100%; 
  bottom:0px; 
  position:fixed; 
  left:0px; 
  background-color: #CCCCCC; 
  border-top: 1px solid #999999; 
  padding:4px; 
  padding-right:20px; 
  color:#666666; 
} 
```

您需要确保将一些 Margin-Bottom 添加到页面 div（填充页面主要部分的那些），以便为固定页脚留出空间（与使用 Margin-Top 的页眉相同）。

这实际上并*没有*留在页面上，但是，因为定位是如此紧密和不变，除非您的页面加载时间过长，否则它看起来好像确实如此。我不知道这是否是 FaceBook 所做的，但它会给你带来几乎相同的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T00:19:55.617

嗯，完成这样的事情的方法是通过 AJAX，但据我所知，facebook 实际上并没有这样做......我刚刚检查过，它像大多数网站一样刷新标题......

编辑：当我第一次回答这个问题时，我正在使用谷歌浏览器（2.0）查看 Facebook，无论出于何种原因，它实际上并没有这样做——>当我从主页点击我的个人资料时，它给了我这个在地址栏中：[http ://www.facebook.com/profile.php?id=1304250071&ref=profile](http://www.facebook.com/profile.php?id=1304250071&ref=profile)

因此刷新了整个页面......奇怪

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T00:29:38.853

使用 CSS 绝对/固定定位，包含页眉和页脚的 div 标签可以位于 HTML 中的任何位置。就像在顶部！

在大多数当前的浏览器上，我相信 Firefox 会有四分之一秒的渲染延迟，因此页面不会在快速闪烁中显示部分渲染的内容，并且会在网络数据进入时浪费大量时间绘制。

所以可能发生的情况是新页面快速返回包含样式和页眉和页脚的 HTML。浏览器可以立即呈现此内容，因此当它显示下一页时，看起来好像这些内容没有改变。

如果页面正在生成动态内容，一个好的技巧是将所有静态信息放在顶部，输出并刷新数据缓冲区。然后进行动态数据库查询等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T07:36:52.157

补充[乔什斯托多拉的](https://stackoverflow.com/users/54420/josh-stodola)回答：据我了解，[YUI 书签管理](http://developer.yahoo.com/yui/history/)器正是完成这项工作。

# c# - 在 IDisposable 类层次结构中正确处理 ObjectDisposedException

> ID：668440
> 
> 赞同：12
> 
> 时间：2009-03-21T00:15:21.320
> 
> 标签：c#, .net, idisposable

在正确实现 IDisposable 时，包括框架指南在内的大多数实现都建议包含一个`private bool disposed;`成员，以便安全地允许多次调用`Dispose()`，并在适当时`Dispose(bool)`抛出[ObjectDisposedException 。](http://msdn.microsoft.com/en-us/library/system.objectdisposedexception.aspx)

这适用于单个类。但是，当您从一次性资源中进行子类化，并且子类包含自己的本机资源和独特的方法时，事情会变得有些棘手。大多数示例显示如何`Dipose(bool disposing)`正确覆盖，但不要超出处理`ObjectDisposedException`。

在这种情况下，我有两个问题。

* * *

第一的：

子类和基类都需要能够跟踪处置状态。我知道有几个主要选项 -

*   1) 声明 private bool 已处理；在两个班级。每个类都跟踪自己的 this.disposed，并根据需要抛出。

*   2) 使用受保护的 bool Disposed { get; 私人套装；} 而不是一个字段。这将让子类检查处置状态。

*   3) 提供一些受保护的辅助方法来检查已释放状态，如果对象已释放，则通过反射拉出当前类型名称来抛出。

我看到的每个选项的优点和缺点是：

*   1）这对我来说“闻起来”，因为它包含重复的布尔值，但似乎工作正常。在子类化其他代码时，我经常使用它。

*   2）这取出了重复的布尔值，但不是设计指南书籍的编写方式，等等。不过，这是我通常使用的，因为它保持它的单点状态。

*   3）这对我来说似乎是最干净的选择，但没有出现在标准指南中。与班级用户的其他方法相比，这种方法的期望可能会少一些。

我曾经尝试过使用所有这三种方法。我想知道这三种方法的优缺点，以及任何其他更清洁、更好的处理方法的想法。在处理这个问题时你会做出什么选择，为什么？

* * *

第二：

抛出时`ObjectDisposedException`，你用什么来做 name 参数？我知道“典型”的方法调用是：

```
`throw new ObjectDisposedException(GetType().FullName);` 
```

`[Microsoft 员工在此页面上](http://msdn.microsoft.com/en-us/library/system.objectdisposedexception.aspx)有一条评论，建议实现具体类的全名是适当的用法。`

 `在上面的第三个选项中，这将是唯一有意义的选择。但是，如果该类自己实现了抛出，您可能会返回定义所调用方法的类的名称。（即：基类可以返回基类的名称，而不是具体的子类）

我认为这不是一个好主意 - 但我在其他人编写的一些代码上遇到了这个问题。返回实现方法的类的名称有优点还是缺点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-21T00:27:58.093

我通常实现第一个选项。事实上，这似乎是设计指南所建议的。原因不是很明显，但我仍然认为这是一个很好的原因：该类的任何实现者都应该对对象作为一般消费者处理的情况具有相同的保护。换句话说，最好不要*假设*任何实现派生类的人都知道他们何时可以调用某个方法，其成功执行可能取决于对象是否已经被释放（尽管理想情况下这应该是无论如何通过 XML 注释记录）。

关于您的第二个问题，我将再次坚持建议的传递做法`GetType().FullName`，特别是因为它用于核心 .NET 框架中。即使您认为替代方法更合适，我认为最好还是坚持使用 .NET 框架中使用的方法，以保持一致性。

总结：与所有指南一样，您希望如何实现某个设计功能显然取决于您，但除非您有特别好的理由，否则强烈建议您坚持使用它们。在这两种情况下，使用您在帖子中建议的一些替代方案可能不会造成太大的伤害，只要它们始终如一地使用并且最好记录给用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T00:29:58.150

> 声明私有 bool 已处理；在两个班级。每个类都跟踪自己的 this.disposed，并根据需要抛出。

当您无法修改基类时，这是实用的解决方案。

> 使用受保护的 bool Disposed { get; 私人套装；} 而不是一个字段。这将让子类检查处置状态。

为什么不将其公开并称为 IsDisposed 呢？然后您将执行与 System.Windows.Forms.Control 相同的操作。当您可以修改基类时，这是一个很好的解决方案。

> 您可能会返回定义该方法的类的名称

不，您引用的示例代码使用了“GetType().FullName”。这始终是最派生类型的名称，而不是实现特定方法的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-16T20:01:31.023

我的倾向是让基类声明一个整数 IsDisposed 标志，然后让外部“Dispose()”方法互锁。在开始处理之前将其交换为“1”（如果在交换之前它不为零，请跳过处置）。要支持 Finalize，事情需要稍微复杂一些，但是实现 Finalize 的类不应该从 Object 以外的类派生，并且 - 除了像 SafeHandle 这样的专用或实用类 - 不应该继承自。

# lucene - 优化 Lucene 性能

> ID：668441
> 
> 赞同：24
> 
> 时间：2009-03-21T00:15:24.190
> 
> 标签：lucene, lucene.net

优化 Lucene 性能的各种方法是什么？

我应该使用缓存 API 来存储我的 lucene 搜索查询，以便节省再次构建查询的开销吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-21T00:20:22.260

你有没有看过

[Lucene 优化提示：重用 Searcher](http://nileshbansal.blogspot.com/2007/04/lucene-optimization-tip-reuse-searcher.html)

[使用 Lucene 进行高级文本索引](http://www.onjava.com/pub/a/onjava/2003/03/05/lucene.html?page=1)

[是否应该在 Lucene 中的增量索引之后优化索引？](https://stackoverflow.com/questions/119994/should-an-index-be-optimised-after-incremental-indexes-in-lucene)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-21T06:44:54.660

快速提示：

*   保持索引的大小很小。在不需要时消除规范、术语向量。仅在必须时才为字段设置存储标志。
*   明显但经常重复的错误。只创建一个 Searcher 实例并重用。
*   保存在快速磁盘上的索引中。RAM，如果你是偏执狂。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-21T00:56:54.450

欺骗。使用[RAMDirectory](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/store/RAMDirectory.html)将整个索引加载到内存中。之后，一切都在飞速发展。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-12-22T10:16:56.117

这里有很多死链接。

这些（有点官方的）资源是我要开始的地方：

[http://wiki.apache.org/lucene-java/ImproveIndexingSpeed](http://wiki.apache.org/lucene-java/ImproveIndexingSpeed)

[http://wiki.apache.org/lucene-java/ImproveSearchingSpeed](http://wiki.apache.org/lucene-java/ImproveSearchingSpeed)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-21T05:03:40.863

我发现性能问题的最佳答案是对其进行分析。指南很棒，但是有很多变量会影响性能，例如数据集的大小、正在执行的查询类型、数据类型等。

获取[Netbeans 分析器](http://profiler.netbeans.org/)或类似的东西并尝试不同的方式。使用 Mitch 链接的文章，但要确保你真正测试了哪些有帮助，哪些（通常令人惊讶）有害。

*与代码中的性能改进相比，您*从 Lucene 获得的任何性能差异也很有可能很小。分析器也会指出这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-26T09:55:23.560

对于 64 位机器，使用[MMapDirectory](http://lucene.apache.org/core/4_3_0/core/org/apache/lucene/store/MMapDirectory.html)而不是[RAMDirectory](https://lucene.apache.org/core/4_3_1/core/org/apache/lucene/store/RAMDirectory.html) ，正如Lucene 的核心提交者之一在[此处](http://blog.thetaphi.de/2012/07/use-lucenes-mmapdirectory-on-64bit.html)很好解释的那样。

# c# - Global.asax 中的 ASP.NET C# Application_Error 无法访问会话变量

> ID：668447
> 
> 赞同：4
> 
> 时间：2009-03-21T00:17:40.053
> 
> 标签：c#, session, global

我有我的错误处理设置来跟踪所有异常并将我们需要的信息写入数据库并通过电子邮件发送给需要了解错误以便修复它的开发人员。我遇到的问题是在页面完全加载之前发生错误。在这种情况下，我要跟踪的会话变量在 Application_Error 中不可用。所以我做了以下事情，这样我的错误处理就不会出错，但必须有更好的方法。此外，如果页面加载并且在提交表单时发生错误，则会话变量可用。

```
try
{
    user_name = System.Web.HttpContext.Current.Session["User_Name"].ToString();
    user_number = System.Convert.ToInt32(System.Web.HttpContext.Current.Session["User_Number"].ToString());
}
catch (Exception ex)
{
    user_number = 0; 
    user_name = "N/A";     
} 
```

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T03:46:01.550

你的所作所为并没有错，尽管

```
if ( null != System.Web.HttpContext.Current.Session ) 
```

会比你的 try-catch 块更“外科手术”。

会话在 AcquireRequestState 事件之前不会初始化，因此在此之前发生的任何错误都不会有会话变量可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T03:40:58.970

这是你需要做的。用户可以通过书签或知道 URL 来访问任何页面。因此，用户可能会在设置任何值之前检索该页面。所以这就是您需要做的以确保代码不会中断。

# perl - 你如何在 Moose 中创建子类型？

> ID：668452
> 
> 赞同：10
> 
> 时间：2009-03-21T00:19:59.703
> 
> 标签：perl, types, moose

我刚开始使用[Moose](http://www.iinteractive.com/moose/)。

我正在创建一个简单的通知对象，并想检查输入是否属于“电子邮件”类型。（暂时忽略简单的正则表达式匹配）。

从文档中我认为它应该类似于以下代码：

```
# --- contents of message.pl --- #
package Message;
use Moose;

subtype 'Email' => as 'Str' => where { /.*@.*/ } ;

has 'subject' => ( isa => 'Str', is => 'rw',);
has 'to'      => ( isa => 'Email', is => 'rw',);

no Moose; 1;
#############################
package main;

my $msg = Message->new( 
    subject => 'Hello, World!', 
    to => 'coolkids@example.com' 
);  
print $msg->{to} . "\n"; 
```

但我收到以下错误：

```
在 message.pl 第 5 行，“subtype 'Email'”附近的操作员预期的位置找到字符串
    （你需要预先声明子类型吗？）
在 message.pl 第 5 行，“as 'Str'”附近的操作员预期的位置找到字符串
    （您需要预先声明为吗？）
message.pl 第 5 行的语法错误，靠近“子类型‘电子邮件’”
错误后 BEGIN 不安全——编译在 message.pl 第 10 行中止。

```

有人知道如何在 Moose 中创建自定义电子邮件子类型吗？

Moose 版本：0.72 perl 版本：5.10.0，平台：linux-ubuntu 8.10

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-21T01:03:15.933

我也是 Moose 的新手，但我认为对于[subtype](http://search.cpan.org/perldoc?Moose::Util::TypeConstraints)，您需要添加

```
use Moose::Util::TypeConstraints; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-21T11:22:01.437

这是我之前从食谱中偷来的一个：

```
package MyPackage;
use Moose;
use Email::Valid;
use Moose::Util::TypeConstraints;

subtype 'Email'
   => as 'Str'
   => where { Email::Valid->address($_) }
   => message { "$_ is not a valid email address" };

has 'email'        => (is =>'ro' , isa => 'Email', required => 1 ); 
```

# java - 导入模块中的隐形构造函数？

> ID：668456
> 
> 赞同：1
> 
> 时间：2009-03-21T00:21:28.967
> 
> 标签：java, import, jar

我有一个使用组件来构建程序的 Java 作业。老师给了我们一个 JAR，我们将用它来使用 Eclipse 构建计算器。JAR 有 2 个类。我们必须导入 JAR 并使用它的类。

我导入 JAR：

```
import SWEB401_HW1.NumericOperation; 
```

但是当我尝试为该类创建一个对象时，它给了我一个错误，因为构造函数不可见。如何使用类“ `NumericOperation`”来构建计算器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T00:36:57.603

有了你提供的信息——考虑到这是一项任务——我只能给你一些关于寻找什么的提示。

假设您的项目设置正确，并且您仍然无法创建 NumericOperation 实例，...

*   ... NumericOperation 中可能有静态工厂方法。
*   ...“其他类”可以充当 NumericOperation 实例的工厂
*   ... NumericOperation 实际上可能是您需要实现的接口或抽象类

编辑：不想全部放弃，所以我会保持模糊。由于 NumericOperation 确实似乎是一个抽象类，请尝试编写如下所示的类，看看您必须做什么才能停止 IDE 抱怨：

```
public class MyNumericOperation extends NumericOperation {} 
```

您还可以在[此处查看](http://java.sun.com/docs/books/tutorial/java/concepts/inheritance.html)Java 教程的继承部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T01:15:24.063

如果构造函数不可见，那么您正在尝试调用非公共构造函数。查看 NumericOperation 类的代码或 java 文档，找到一个公开的构造函数。很可能您正在调用无参数构造函数，并且该类专门隐藏了它，因为您需要一个初始值。

例如：

```
public class MyClass {
  private MyClass() {
    // Don't let callers instantiate me without args!
  }

  public MyClass(int initialValue) {
    // create a new object with initialValue
  }
} 
```

如果调用代码尝试这样做：

```
MyClass obj = new MyClass(); 
```

你会得到你发布的错误。您需要改为调用 new MyClass(int) 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T02:43:53.803

如果您得到的错误是说 onstructor 不是“可见的”，那么它是在谈论 java 中的可见性（公共、provate、protected 和 package）。

这很好——这意味着你已经成功地导入了这个类并且它在你的类路径中。忽略所有其他关于愚弄你的类路径的答案 - eclipse 正在为你处理它，好吧。

*猜测一下*，你的老师~~搞砸了~~，没有在你需要使用的构造函数上放一个“公共”声明。

要解决此问题，您正在编写的类需要位于 SWEB401_HW1 包中。

eclipse 中最简单的方法是在导航器中右键单击 java 文件，然后通过将其“移动”到包 SWEB401_HW1 中来“重构”它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T00:26:18.720

如果我正确理解你的问题，你不需要导入任何东西。这不是您访问 JAR 文件中的类的方式。相反，您需要将 JAR 文件的路径添加到 Java 的类路径中；你如何做到这一点取决于你的操作系统。或者，您可以将 JAR 文件提取到您自己程序的类文件所在的目录中。JAR 文件只是具有不同扩展名的 ZIP 文件，因此您可以使用通常用于打开 ZIP 文件的任何内容来提取它，或者您可以使用`jar`JDK 附带的工具：

```
jar xf SWEB301_HW1.jar 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T00:29:58.993

没有必要提取任何东西。您需要通过将 JAR 添加到类路径中来在项目中使用它。

你在使用 Eclipse 吗？如果是这样，您可以转到项目属性 -> java 构建路径 -> 库 -> 添加外部 JAR -> 搜索您的 jar 并添加它们。

这样，您将获得项目中的所有 JAR 类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-21T02:52:33.987

如果讲师给您 Javadocs、API 列表或源代码，请查找以下内容：

*   公共静态 NumericOperation ()
*   公共数字操作（）
*   公共数值运算 ()

第一个可以在任何类中，但很可能在 NumericOperation 类中。

第二个是带参数的 NumericOperation 类中的构造函数。请记住，如果类提供了构造函数，编译器不会为您生成无参数的构造函数。

最后一个将在另一个类中（因为您需要一个实例来调用该方法）。

将来发布编译器吐出的确切错误消息比粗略陈述它所说的内容更有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-21T02:59:10.803

与一些较早的答案一致，您需要通过类路径获得 jar，因此当您运行或编译时

```
 java(c) -cp myjar.jar:. etc 
```

我通常包含当前目录，这样它就不会忘记我的代码在路径中。

导入时，必须使用 java 包名。在 zip 程序中打开 jar 并将路径归档到您需要的类文件，然后输入“import path;” 您将文件夹分隔符替换为“。”

# winapi - 如何在 Windows 上重新加载崩溃的进程

> ID：668460
> 
> 赞同：2
> 
> 时间：2009-03-21T00:24:55.073
> 
> 标签：winapi, process, crash, reload

如何在 Windows 上重新加载崩溃的进程？当然，我可以运行自定义监控Win服务进程。但是，例如火狐：它似乎没有安装这样的东西，但它仍然可以在崩溃时自行重启。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T00:29:23.080

在 Vista 及更高版本上，您可以使用[RegisterApplicationRestart API](http://msdn.microsoft.com/en-us/library/aa373347.aspx)在崩溃或挂起时自动重启。

在 Vista 之前，您需要有一个顶级异常过滤器来执行重新启动，但请注意，在受感染进程内运行代码并不完全安全或可靠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T00:29:05.703

每次您打开选项卡或单击链接或执行某些其他操作时，Firefox 都会不断地将其状态保存到硬盘上。它还保存了一个标志，表明它已安全关闭。

在启动时，它会读回所有内容，并能够根据该信息“恢复”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T01:20:25.237

*   [结构化异常处理 (SEH)](http://msdn.microsoft.com/en-us/library/ms680657(VS.85).aspx)允许您捕获程序崩溃并在它发生时执行某些操作。
    请参阅： __try[和 __except](http://msdn.microsoft.com/en-us/library/s58ftw19.aspx)
    SEH 可能非常危险，并且可能导致您的程序挂起。请参阅[这篇文章](http://blogs.msdn.com/larryosterman/archive/2004/09/10/228068.aspx)了解更多信息。

*   如果您将程序编写为 NT 服务，那么您可以将第一次、第二次和随后的失败操作设置为“重新启动服务”。

*   对于 Windows 2008 服务器和 Windows Vista 和 Windows 7，您可以使用 Win32 API [RegisterApplicationRestart](http://msdn.microsoft.com/en-us/library/aa373347(VS.85).aspx)

有关处理不同类型的程序崩溃的更多信息，请[在此处查看我的答案。](https://stackoverflow.com/questions/224163/capturing-r6025-pure-virtual-call)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T00:51:25.243

如果我没记错的话，Windows 至少实现了 POSIX 的某些子集，因此“必须”具有信号接口（如 SIGKILL、SIGSEGV、SIGQUIT 等）。

我从来没有这样做过，但在 linux 上，但你可以尝试使用 signal() (signal.h) 设置意外终止陷阱。从文档的快速扫描看来，在处理信号时可以做的事情很少，甚至有可能启动一个新进程也在禁止列表中。

既然我已经考虑过了，我可能会选择主/工作者模式，非常简单的父线程，除了产生工作者之外什么都不做（它会做所有的 UI / 其他事情）。如果它没有设置特定的“我现在要死了”位但仍然死了（父进程总是收到消息/通知说生成的进程死了）然后主重生工人。主题是保持大师非常简单，并且由于自己的错误而难以死去。

# iphone - Safari iPhone - 如何检测缩放级别和偏移量？

> ID：668462
> 
> 赞同：21
> 
> 时间：2009-03-21T00:25:51.700
> 
> 标签：iphone, safari

我正在寻找有关在 iPhone 上的 Safari 中查看时如何跟踪用户在页面上缩放和平移的选项。Safari 公开了移动和手势事件，所以理论上我可以保持平移和缩放操作的运行记录，但这似乎有点矫枉过正，因为浏览器必须在内部跟踪它。

此信息是否通过文档对象模型公开？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-06-24T14:19:45.053

当您放大时，`window.innerWidth`会调整，但`document.documentElement.clientWidth`不会调整，因此：

```
var zoom = document.documentElement.clientWidth / window.innerWidth; 
```

（我测试过iOS4，没有`viewport` `<meta>`）。

但是，我不会在任何重要的事情上依赖它。移动浏览器中的 DOM 视口大小/像素大小[是一团糟](http://www.quirksmode.org/m/widths.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-21T11:08:59.267

在 Mobile Safari 和 Android 上，这是衡量页面缩放程度的准确方法。

在这里尝试：http: [//jsbin.com/cobucu/3](http://jsbin.com/cobucu/3) - 更改缩放然后单击测量。

技术是添加一个顶级 div：

```
<body>
<div id=measurer style="position:absolute;width:100%"></div> 
```

并使用计算：

```
function getZoom(){
    return document.getElementById('measurer').offsetWidth / window.innerWidth;
} 
```

唯一的问题是找到一种整洁的方法来检测用户是否更改了缩放（捏合、双击等）。选项：

*   webkitRequestAnimationFrame：非常可靠，但如果使用动画可能会导致卡顿（由于性能损失）
*   setInterval：可靠但非常丑陋
*   触摸事件：寻找两根手指或双击：丑陋，可能难以做到 100% 可靠
*   window.onresize + window.onorientationchange + window.onscroll：简单但完全不可靠（编辑：和 onscroll 可能会导致 WKWebView 或 Mobile Safari 8 或更高版本中的性能问题）。

PS：Windows Phone 需要不同的解决方案（pinch-zoom 不会更改视口 - Windows 上的 pinch-zoom 有其*自己的*独立视口，对 javascript 不可见）。

编辑：Android Visual Viewport 调整大小和滚动事件可能有帮助吗？请参阅[https://developer.mozilla.org/en-US/docs/Web/API/VisualViewport#Events](https://developer.mozilla.org/en-US/docs/Web/API/VisualViewport#Events)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-21T21:42:02.043

According to the [Safari Web Content Guide](http://tuvix.apple.com/safari/library/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html), zoom events (double tap) are not exposed, so I'm not sure how you can track this.

I do not believe this information is exposed through the DOM.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-11T01:47:06.573

实际上，我认为自从史蒂夫的回答以来，事情可能已经发生了一些变化，因为查看他提供的内容指南链接，我可以看到有关[处理多点触控事件](https://developer.apple.com/library/mac/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW22)和[处理手势事件](https://developer.apple.com/library/mac/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW23)的部分。

还没有尝试过，但它们看起来很有希望。一旦我检查了它们并有可用的演示链接，我将提供更新......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-31T20:20:17.547

我以这种方式测量缩放（仅适用于 iOS）：

```
screenOrientedWidth = screen.width;
if (window.orientation == 90) {
    screenOrientedWidth = screen.height;
}
return screenOrientedWidth / window.innerWidth; 
```

它不取决于内容的广泛性。

但是，在 iOS 中，Safari`window.innerWidth`在处理程序中是不正确的`gestureend`。您应该推迟此类计算以供以后执行。在 GWT 中，我使用`scheduleDeferred`，但我不能说如何在纯 JavaScript 中实现它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-30T23:31:26.857

如果您使用任何带有 location:fixed 的元素，这可能会变得复杂，因为 location:fixed 坐标是相对于未缩放的窗口，而窗口坐标是相对于缩放的视口。更多信息：[缩放时如何在 IOS 浏览器上定位固定位置元素？](https://stackoverflow.com/questions/52085998/how-to-position-a-fixed-location-element-on-ios-browser-when-zoomed/)

# php - 如何在 drupal 中打印单个评论？

> ID：668466
> 
> 赞同：2
> 
> 时间：2009-03-21T00:26:55.443
> 
> 标签：php, drupal, drupal-comments

我想根据评论 ID 在 drupal 中打印单个评论。我怎样才能做到这一点？谷歌和其他来源没有给我任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T00:57:27.803

```
功能打印评论（$cid）{
  $sql = "SELECT * FROM {comments} WHERE cid = %d";
  if ($comment = db_fetch_object(db_query($sql, $cid))) {
    $node = node_load($comment->nid);
    返回主题（'comment'，$comment，$node）；
  }
}

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T13:32:32.683

如果您需要像 core 那样显示评论，包括来自节点的信息，伊顿的建议很好（除了它`{comments}`，不是）。`{comment}`除了默认的 theme_comment 实现`modules/comment/comment.tpl.php`不使用 $node。

但是，我的做法会稍有不同，因为如果您需要提取单个评论，使用 提供的正常内容格式显示它`comment.tpl.php`可能是不合适的。

```
function print_comment($cid) {
  $sql = "SELECT * FROM {comment} c WHERE c.cid = %d";
  if ($comment = db_fetch_object(db_rewrite_sql(db_query($sql, $cid), 'c'))) {
    return theme('my_special_comment_formatting', $comment);
  }
} 
```

当然，在你的模块`hook_theme()`实现中定义这种特殊的注释格式，灵感来自于做什么`comment.tpl.php`。

2014 年 2 月更新：请注意，这是 2009 年的问题/答案。在 Drupal 8 中，您只是不想访问假设的底层 SQL 数据库（无论如何也不会这样做，而是使用 DBTNG），而只需使用类似的东西：

```
if ($comment = entity_load('comment', $cid)) {
  return entity_view($comment, $view_mode);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-28T22:26:43.380

没有理由使用任何 sql 来执行此操作，只需调用两个 drupal api 函数即可。

```
function print_comment($cid) 
{
    $comment = _comment_load($cid);
    return theme('comment',$comment);
} 
```

# json - 从 Newtonsoft 的 JSON 序列化器解析 JSON 日期时间

> ID：668488
> 
> 赞同：38
> 
> 时间：2009-03-21T00:48:57.963
> 
> 标签：json, datetime, parsing, json.net

我已经使用 Newtonsoft 的 JSON 序列化器序列化了一个对象，并且 DateTime 已经通过：

```
/Date(1237588418563+0000)/ 
```

当我使用 $.evalJSON() 时，它是一个对象，但我找不到任何正常的 Date 方法，例如 toUTCString 。

有什么想法我能用这个做什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-30T06:26:25.060

使用 Json.NET 附带的其中一个 JsonConverter 来处理日期以获得更好的格式。JavaScriptDateTimeConverter 会自动给你一个 JavaScript 日期。

```
public class LogEntry    
{    
  public string Details { get; set; }    
  public DateTime LogDate { get; set; }
}

[Test]
public void WriteJsonDates()
{    
  LogEntry entry = new LogEntry    
  {    
    LogDate = new DateTime(2009, 2, 15, 0, 0, 0, DateTimeKind.Utc),    
    Details = "Application started."    
  };    

  string defaultJson = JsonConvert.SerializeObject(entry);    
  // {"Details":"Application started.","LogDate":"\/Date(1234656000000)\/"}     

  string javascriptJson = JsonConvert.SerializeObject(entry, new JavaScriptDateTimeConverter());    
  // {"Details":"Application started.","LogDate":new Date(1234656000000)}

  string isoJson = JsonConvert.SerializeObject(entry, new IsoDateTimeConverter());    
  // {"Details":"Application started.","LogDate":"2009-02-15T00:00:00Z"}    
} 
```

文档：[**使用 Json.NET 在 JSON 中序列化日期**](http://james.newtonking.com/projects/json/help/index.html?topic=html/DatesInJSON.htm)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-15T11:45:18.137

我想出了一种不同的方法，可能对某些人有用。基本上我创建了我自己的*CustomDateConverter*，我需要它时调用它。转换器采用 2 个参数，一个日期格式，例如`yyyy-MM-dd HH:mm:ss`和一个 TimeZoneInfo，它允许我将日期从 UTC 转换为用户的时区：

```
public class JSONCustomDateConverter : DateTimeConverterBase
{
    private TimeZoneInfo _timeZoneInfo;
    private string _dateFormat;

    public JSONCustomDateConverter(string dateFormat, TimeZoneInfo timeZoneInfo)
    {
        _dateFormat = dateFormat;
        _timeZoneInfo = timeZoneInfo;
    }
    public override bool CanConvert(Type objectType)
    {
        return objectType == typeof(DateTime);
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        throw new NotImplementedException();
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        writer.WriteValue(TimeZoneInfo.ConvertTimeFromUtc(Convert.ToDateTime(value), _timeZoneInfo).ToString(_dateFormat));
        writer.Flush();
    } 
```

你可以像这样使用它：

```
 var jsonString = JsonConvert.SerializeObject(myObject, Formatting.None, new JsonSerializerSettings { NullValueHandling = NullValueHandling.Ignore, Converters = new List<JsonConverter>() { new JSONCustomDateConverter("yyyy-MM-dd HH:mm:ss", loggedUser.Timezone) } }); 
```

显然，如果您只想要自定义日期格式，则可以删除与时区相关的任何内容。让我知道这有帮助！

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-12T08:43:05.143

从 Newtonsoft Json.Net 4.5r5 版开始，您使用 JsonPropertyAttribute Class 类并设置其 ItemConverterType Property 属性。用法：

```
// class to be serialized
public class MyClass
{
    [JsonProperty(ItemConverterType = typeof(JavaScriptDateTimeConverter))]
    public DateTime? DateTime1;
    public DateTime? DateTime2;
} 
```

正如我所观察到的，这将为此类中的所有属性设置 DateTimeConverter，而不仅仅是之前声明的属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-11T13:04:59.877

遇到同样的问题，并根据 Adam 的链接找到了解决方案：

```
new Date(yourDate.substr(yourDate.indexOf("(") + 1, 13) - 0)); 
```

它看起来像一个 Unix 时间戳，javascript 很容易将其转换为日期对象。这`- 0`只是让javascript将`substr`输出视为整数......我想你也可以`Number()`，如果你不喜欢它的外观`- 0`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-04T23:42:56.643

JSON 对象包含如下内容：

```
var data = {"CreatedDate":"/Date(1327572000000-1000)/"});

 ///
var oddDateTimeZone = data.CreatedDate;
var utcDateTime = oddDateTimeZone.substr(oddDateTimeZone.indexOf("(")+1, 13);
var utcZone = oddDateTimeZone.substr(oddDateTimeZone.indexOf("-")+1, 4);
var utcDateTimeZone = new Date(Number(utcDateTime)-(Number(utcZone))); 
```

但是，最好还是修复 JSON 对象，以便在不使用类似 eval() 或 window[] 的情况下触发日期函数。也许在 jQuery 中。没有把握。

不要忘记偏移量可能`+`不仅仅是`-`偏移量！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-09-09T15:45:43.243

抱歉，我简化了一点@James Newton-King

```
string date = Newtonsoft.Json.JsonConvert.SerializeObject(DateTime.Now); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-02-04T15:36:17.807

```
ObjectMapper mapper = new ObjectMapper();

mapper.registerModule(new JavaTimeModule());

mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false); 
```

这对我有用

# linux - 免费/开放 h.264 视频解码库？（非 GPL）

> ID：668494
> 
> 赞同：15
> 
> 时间：2009-03-21T00:51:25.790
> 
> 标签：linux, video, h.264, decoding, codec

主要播放器似乎是x264和xvid，并且都是GPL。这意味着我们无法将解码功能集成到播放应用程序中，除非获得 GPL 许可，因此我们也不能使用。

首选目标平台是 Linux。任何非病毒开放许可证都可以，我们非常乐意提供我们对库所做的任何更改的来源，而不是我们的整个应用程序。

有没有什么？或者我们现在应该在开发过程中使用 GPL 作为测试，并计划在发货前用商业许可的编解码器替换它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T20:10:24.873

ffmpeg H.264 解码器是 LGPL。只有编码器是 GPL，x264 不提供解码器。

与 Framewave 和 IPP 相比，它还具有实际可用的优势。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-12T03:52:00.767

Cisco 发布了一个 BSD 许可的 h264 库，用于编码和解码。

我希望你只使用 GPL，但是当有答案时我不会告诉你这样做。

[http://www.openh264.org/](http://www.openh264.org/)
和 GitHub 页面：
[https ://github.com/cisco/openh264](https://github.com/cisco/openh264)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-21T01:36:42.640

IANAL，但是如果您要在任何强制执行软件专利的地方发货，您不仅需要为 h.264 解码支付 MPEG LA 版税，而且[许可证](http://www.mpegla.com/avc/AVC_TermsSummary.pdf) *可能会*阻止您使用开源解码器。我听说过适用于其他编解码器的类似烦恼。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-21T02:51:42.927

PocketVideo 的 OpenCore 现在在 Apache 2.0 许可下开源，作为 Android 操作系统的一部分： [https ://github.com/android/platform_external_opencore](https://github.com/android/platform_external_opencore)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-21T01:01:19.137

源自 AMD 性能库[Framewave](http://developer.amd.com/cpu/libraries/framewave/Pages/default.aspx)的项目现在具有支持 h.264 解码的视频组件。

许可证是“Apache 2.0 许可证”

你可以在[Sourceforge SVN上查看](http://framewave.svn.sourceforge.net/viewvc/framewave/trunk/Framewave/domain/fwVideo/src/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-21T02:11:50.650

伊纳尔。

如果您发布从未经修改的 GPL 源创建的未经修改的二进制文件，并且您的应用程序只是调用它们，我相信您的整个应用程序不必是 GPL。您可能必须包含 GPL 文档和/或捆绑的 GPL 应用程序的源代码，但如果您没有对 GPL 代码进行任何修改或链接，您的代码应该不受影响。

就 MPEG 标准而言，这可能完全是另一包蠕虫......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-21T01:01:40.727

好的，FFMpeg 似乎可以处理 h.264。我相信其中大部分是 LGPL。

仍然希望听到它的经验（好或坏）或其他选择，谢谢。

-- 更正，我刚刚测试的版本似乎是用“--enable-gpl”编译的，这让我相信它正在使用 GPL 许可的编解码器。啊！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T10:29:50.797

看看[英特尔 IPP 库](http://software.intel.com/en-us/intel-ipp)。它们不是免费的，但非常便宜（一次性支付一百美元或其他东西）。您还可以获得免费评估以进行测试。许可证是非常开放的，据我所知，一旦你购买它，你就可以在你的应用程序中无限分发。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-21T01:05:19.937

我已经使用 FFmpeg 完成了一些工作，尽管它仅限于 libavformat（编解码器部分称为 libavcodec）。我发现 API 出奇地简单易用。它们在标准源代码分发中提供了一些非常有用和启发性的示例。

一般来说，图书馆的质量相当高，但似乎缺少一些模块，所以我不能保证 h264 部分。不过，我听说过关于编码器的好消息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-28T06:07:02.907

请注意，VLC 及其大部分库现在都是 LPGL

VLC 引擎重新授权给 LGPL - [http://www.videolan.org/press/lgpl-libvlc.html](http://www.videolan.org/press/lgpl-libvlc.html)

VLC 播放模块重新授权给 LGPL - [http://www.videolan.org/press/lgpl-modules.html](http://www.videolan.org/press/lgpl-modules.html)

# c - 是否有任何具有通用数据结构的开源 C 库？

> ID：668501
> 
> 赞同：122
> 
> 时间：2009-03-21T00:59:13.353
> 
> 标签：c, data-structures

我正在寻找一个具有常见可重用数据结构（如链表、哈希表等）的 C 库。类似于[通过 Kyle Loudon 的 Mastering Algorithms with C (Paperback)](http://www.amazon.ca/Mastering-Algorithms-C-Kyle-Loudon/dp/1565924533/ref=sr_1_19?ie=UTF8&s=books&qid=1237597047&sr=1-19)分发的源代码。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-21T01:43:13.403

BSD [queue.h](http://openbsd.su/src/sys/sys/queue.h)有：

*   SLIST = 单链表
*   LIST = 双向链表
*   SIMPLEQ = 单链队列
*   TAILQ = 双链队列

BSD [tree.h](http://openbsd.su/src/sys/sys/tree.h)有：

*   RB - 红黑树
*   SPLAY - 展开树

有关详细信息，请参见[queue(3)](http://www.openbsd.org/cgi-bin/man.cgi?query=queue)和[tree(3)](http://www.openbsd.org/cgi-bin/man.cgi?query=tree)手册页。我真的很喜欢它们，因为它们是没有依赖关系的纯 C 宏（甚至不是 libc）。加上 BSD 许可证，您不必担心任何公司对 GPL 的限制。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-21T01:00:33.927

Gnome 为此提供了一个出色的库，称为[Glib](http://developer.gnome.org/glib/stable/)，其中包含许多有用的数据结构和其他实用程序。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-03-21T01:18:40.747

[gnulib](http://www.gnu.org/software/gnulib/)，gnu 可移植性库。

它作为源代码分发。该列表来自其[模块列表](http://www.gnu.org/software/gnulib/MODULES.html)，其中包括大量其他内容。一个有趣的是“c-stack：堆栈溢出处理，导致程序退出”。

*   列表
*   数组列表
*   数组列表
*   链表
*   avltree 列表
*   rbtree 列表
*   链表
*   avltreehash 列表
*   rbtreehash 列表
*   子列表（由另一个列表支持的顺序列表数据类型。）
*   oset（抽象有序集。）
*   数组集合
*   avltree-oset
*   rbtree-oset

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-21T05:46:04.130

[SGLIB](http://sglib.sourceforge.net/)是一个优秀的通用数据结构库。该库目前提供以下通用实现：
排序数组
链表
排序链表
双链表
红黑树
散列容器

它非常快，比 glib 更快。它的灵感来自标准模板库。[在这里下载](http://freshmeat.net/projects/sglib)

另一种解决方案是[Attractive Chaos 软件](http://attractivechaos.wordpress.com/programs/)。C 宏库：
kbtree.h：C 中的高效 B-tree 库。
khash.h：C 中的快速和轻量级哈希表库。
kvec.h：C 中的简单向量容器。

Sglib 和 Attractive Chaos 软件是 C 宏库。使用 void* 在 C 中实现通用容器可能效率低下。C 宏模仿 C++ 模板，与 C++ 模板一样高效

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-21T04:25:12.843

GDSL 库可能是一件值得考虑的好事情：

[http://home.gna.org/gdsl/](http://home.gna.org/gdsl/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-18T02:27:36.650

Apache 便携式运行时。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-04-12T13:56:24.057

[CLIB](http://code.google.com/p/cstl/)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-21T06:36:54.383

AT&T 的[软件工具](http://www.research.att.com/software_tools)。

# iphone - 有没有人参加过 Pragmatic Studio iPhone 课程，如果有，值得吗？

> ID：668512
> 
> 赞同：3
> 
> 时间：2009-03-21T01:06:26.457
> 
> 标签：iphone

我正在考虑去实用的工作室 iphone 课程，但由于价格原因有点谨慎。我目前从事合同工作，因此除了我的以外，没有一家公司可以为我支付课程费用。

在旅行、食物、酒店和货币转换之后，课程达到 3500 多个。

这值得么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-21T01:28:32.970

老实说，就成本/收益而言，我不喜欢编码训练营或短期课程。

如果钱不是问题，我会说去吧，但既然你以自己的方式支付并提出了金钱方面的问题，我会假设在放弃 3500 美元之前至少必须考虑一些因素。

我发现我可以诚实地通过简单地阅读一本书并自己尝试练习或小项目来吸收更多的材料和更深入的内容。当然，有一些提示和技巧可以通过实际指导传授给您，您可能不会立即从自学中收集到，但这些东西不会是您必须学习的大部分知识。

这些计划让我想起了短期认证训练营：昂贵且内容很少。你必须现实一点，你在那里呆了4天。您将学习如何设置开发环境，展示了一些您遵循的罐头示例，并说明了加速度计、照片和其他 iPhone 基础知识的基础知识。

这对你来说真的值得吗？对我来说，一个严肃的专业开发人员会简单地坐下来阅读一些可可/iPhone 书籍，然后开始在他们的休息时间敲打一些章节。

所以，在我看来，给自己省点钱，花 90 美元买些[书](https://stackoverflow.com/questions/449101/iphone-development-books)，然后请几天假。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T02:55:45.087

我对 BigNerd Ranch 训练营犹豫不决，并决定反对它。

教室很棒，你真的可以学到很多东西，但我认为我会从*现在*的 iPhone*高级*训练营中受益更多，而不是新手到支持他们的平台。

 *了解事物的工作原理可以更容易地了解类似事物的工作原理。有关于核心多线程、UI 最佳实践、各种网络模式和深入的 CoreAnimation 的课程……这是一个你可以出售视频的训练营，更不用说现在打包到椽子上了。

我发现做真正的项目并尝试制作比课堂环境更能教给你的东西，而且速度更快。弄脏你的手，开始犯错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T01:23:03.937

我个人没有去过，但我听说比尔·杜德尼很棒。这听起来很贵，但也许你可以出于税收目的把它改掉，只要你有机会学习一些东西，就可以这么说，这可能是值得的。如果你认为你想制作商业 iPhone 应用程序，并且你认为这样做至少可以赚到 3500 美元，那么我说去做吧。如果您认为您只是将这样做作为一种爱好，或者您认为您的收入将低于 3500 美元，那么我完全同意 Simucal 的观点。

PS 也许你可以在此之后写一个关于如何制作 iPhone 应用程序的教程。网络部分看起来也很有趣！

# batch-file - 用于打开最新 Malwarebytes 的反恶意软件日志的批处理文件

> ID：668513
> 
> 赞同：0
> 
> 时间：2009-03-21T01:07:13.413
> 
> 标签：batch-file, cmd

在 Vista 中，我想根据上次修改日期或文件名中的日期运行批处理脚本来打开最近的文件。它用于 %username&/appdata/roaming/Malwarebytes/Malwarebytes 的 Anti-Malware/Logs 文件夹中的 Malwarebytes 的 Anti-Malware 日志。

日志文件在这里是这种格式

> mbam-log-2009-03-21 (00-20-21).txt
> 
> mbam-log-2009-03-21 (09-42-40).txt
> 
> mbam-log-2009-03-21 (11-02-43).txt
> 
> mbam-log-2009-03-21 (11-12-01).txt
> 
> mbam-log-2009-03-21 (12-01-42).txt
> 
> mbam-log-2009-03-21 (12-04-49).txt
> 
> mbam-log-2009-03-21 (14-01-41).txt

所以它的 24 小时格式。我在这里阅读了另一页，并在此处获取了此脚本..

```
@echo off
dir *.txt /b /on > systext.bak 
FOR /F %%i in (systext.bak) do set sysRunCommand=%%i 
call %sysRunCommand%
del systext.bak /y 
```

但它不喜欢文件名中的空格..总是出错。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T03:57:40.087

您实际上在脚本中有三个问题。第一个是 %%i 可能被设置为带有文件名的单词 - 这可以通过`"delims="`在`for`语句中使用来修复。

第二个是您需要在`call`语句中引用空格文件名。

第三是我不知道 的`/y`选项`del`，也许你的意思是`del /f`。

Amyway，试试这个：

```
@echo off
dir *.txt /b /on > systext.bak 
FOR /F "delims=" %%i in (systext.bak) do set sysRunCommand=%%i 
call "%sysRunCommand%"
del /f systext.bak 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T01:13:24.597

以下一行批处理文件将打开最近修改的文件：

```
for /f "usebackq delims=" %%i in (`dir /b /o-d`) do @start "%%i"&goto :eof 
```

使用`dir`比试图剖析文件名中的日期更简单。您也可以按文件名排序（因为日期格式有点 ISO-8601-ish 排序好）。

只是为了`goto :eof`确保只打开最近的文件，而不是按日期/时间顺序打开所有文件。

至于您的空间问题，通常用引号将文件名括起来应该可以解决这个问题，但有时很难知道它们必须在哪里。此外，`for`默认情况下，在空格处对其输入进行标记，这就是为什么我`delims=`在其中包含基本上说“将所有内容放入变量中并且不进行任何标记”的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-21T19:02:53.117

我知道这是一个旧帖子，我并不是要恢复它 - 我有另一种方法来解决这个问题。

Malwarebytes 的 Anti-Malware 包括将日志文件重新路由到备用位置（文件夹或指定文件）的能力。

您可以运行“%programfiles%\malwarebytes' anti-malware\mbam.exe”/logtofile c:\logs\bob-mbam-log.txt。/logtofolder 也可以。（上述命令假设您使用的是 32 位系统。）

指定文件时，mbam 追加而不是覆盖。因此，这可能会使日志更难以解析。

# language-agnostic - 使用云的理由？

> ID：668516
> 
> 赞同：0
> 
> 时间：2009-03-21T01:08:37.183
> 
> 标签：language-agnostic

我目前正在编写一个大型 ASP.Net Web 应用程序。

我不知道的事情之一是如何证明何时使用云的合理性。例如，我什么时候应该使用 google app engine/azure？

另外，我什么时候想在标准 dbms（如 Sql Server）上使用 bigtable？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T01:15:26.387

云计算是关于可扩展性的。它允许您扩大和缩小规模，而无需重新设计您的设计。

它适用于小型站点，因为您只需为使用的资源付费，但如果您需要扩大规模，它会自动发生（前提是您的应用程序是为云设计的）。

此外，理论上还有更好的工具来维护云中的正常运行时间和可靠性。例如，系统升级可以在不停止您的服务的情况下发生，因为云计算平台可以自动启动或关闭服务器来为您的应用程序提供服务。

Azure 开发人员对此进行了很多讨论。

* * *

此外，使用云可能有经济动机。使用托管云架构可能比管理传统站点所需的多个服务器（数据库、Web 等）成本更低，至少在前期是这样。随着使用量的增加，成本随之而来，但从理论上讲，它可能更具成本效益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T01:15:54.827

这个问题与今天提出的另一个问题密切相关：“[你什么时候不应该使用关系数据库？](https://stackoverflow.com/questions/667141/when-shouldnt-you-use-a-relational-database/667355#667355) ”

关系数据库和非关系数据库（如 BigTable）满足不同的需求。不仅在规模和性能方面，而且在数据的结构和使用方面。

据我了解，“云”主要是关于可扩展性。也就是说，架构是指以可扩展的方式增加容量的能力。

此外，云经常用于指代软件即服务 (SaaS) 模型，由其他人负责服务器，但这是云架构的独立问题。即，您可以在云架构中操作自己的一组服务器。

* * *

因此，使用云架构的理由是您的应用程序对计算能力的需求是可变的。因此，让 N 台服务器专门用于匹配您的峰值活动水平将是过度的。随着您的活动水平随着时间的推移而增加（和减少），云允许您改变对服务器的使用。

使用 SaaS 模型的理由是您不想从事运营数据中心的业务。您愿意放弃一些控制权并为服务付费，这样您就可以将操作细节留给该技术的专家。他们处理备份、硬件故障、升级、24x7 操作等。您处理您的应用程序和业务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T01:21:02.707

除了应用程序引擎和 EC2 之外，我对其他任何东西都不太熟悉。

我将尝试在之前的答案中添加一些内容：

应用引擎最好的一点是它是免费的，直到您吸引了一定数量的用户并且您为应用程序使用的内容付费，空闲时间不收费。

大表可能与 rdbms 架构不同，但从使用它的开发人员的角度来看，它并没有那么不同。

另一个好处是支持python。坏事是标准库被削弱了。

此外，您无法完全控制云（appengine）上的数据，我的意思是您不能完全限制来自谷歌的人偷看您存储在那里的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T01:23:26.523

我建议您订阅并阅读[High Scalability 博客](http://highscalability.com/blog)，尤其是一些访问量最大的帖子，例如有关各种大型网站架构的帖子，因为您将从中学到很多东西，可能会帮助您做出决定。关于何时应该或不应该使用云服务或从关系数据库迁移到像 BigTable 这样的键值系统，没有硬性规定。

无论如何，云服务的一个优点是，如果您使用它们构建应用程序，它将立即可扩展，并且如果您需要这种性能，则以后需要的返工少得多。但是，考虑到过早的优化，在决定在这样的平台上构建应用程序之前，确保您需要这种可扩展性是明智的。

在使用像 BigTable 这样的数据存储系统时，也有几个概念需要考虑，例如不能像在关系数据库中那样猛烈写入，并且必须预先计算大量数据而不仅仅是做这基于来自数据库的信息。

虽然同样，您可以从阅读上述博客和有关 Youtube、Plentyoffish、Google 等的相关文章中学到很多东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T04:59:38.313

您说您“当前正在编写一个大型 ASP.NET 应用程序”。如果您在这方面取得了重大进展，那么您已经通过了可以证明使用 Google 应用程序引擎或 Azure 的地步。由于语言支持、数据库差异和成熟度，两者都需要与使用传统应用程序构建的架构截然不同的架构。

Google App Engine 只是 Python，因此切换到它需要完全重写

大表不是关系数据库，需要非常不同的编码模式。SQL Data Services 最初也宣布是非关系型的，但正在变得更加关系型。我还没有看到它目前与标准 MSSQL 数据库有多接近。

到目前为止，我认为谷歌应用引擎是一个相对不成熟的平台。数据库功能有限，您无法运行后台进程，分析和性能调整工具充其量是有限的。Azure 目前处于有限的社区预览阶段，因此今天甚至无法发布产品。

虽然使用云架构有很多非常正当的理由，但迁移到它需要截然不同的架构。想想改变该架构（并可能等待平台可用性）会对您的发布日期产生什么影响。

如果您处于项目的早期阶段，那么云与非云是一个很好的问题。如果你进展顺利，我认为交付代码和利用你已经投入的工作的重要性应该胜过你可能看到的云计算带来的任何好处。

# c# - 如何获得按钮而不是提交

> ID：668520
> 
> 赞同：1
> 
> 时间：2009-03-21T01:10:46.773
> 
> 标签：c#, asp.net

在这里，我再次提出另一个看似简单的问题，但我找不到答案。我想使用输入 type="button" 但 asp:Button 总是给我一个 type="submit"。

```
<asp:Button runat="server" bla bla bla /> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-21T01:16:23.967

使用以下

```
<asp:Button ID="Button1" runat="server" Text="Button" UseSubmitBehavior="False" /> 
```

我对其进行了测试，它呈现出`<input type="button" />`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T01:16:08.210

**默认情况下**，**asp 按钮**设置为在单击页面时将页面返回到服务器，这就是为什么它被呈现为提交按钮的原因。

 **如果您不想要回发，则无需使用**asp:button 控件**

***常规*的 html 按钮应该可以完成这项工作**：

```
 <input type="button" value="My Button"/> 
```

您仍然可以在服务器上格式化 html 控件

```
<input ID="MyButton" runat="server" type="button" value="My Button"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T01:12:35.863

你想用这个按钮做什么？

您可能应该只使用 HTML 按钮，而不是 ASP 按钮。

# asp.net-mvc - asp.net mvc Controller.RedirectToAction

> ID：668525
> 
> 赞同：2
> 
> 时间：2009-03-21T01:13:28.047
> 
> 标签：asp.net-mvc

```
protected internal RedirectToRouteResult RedirectToAction(
    string actionName,
    string controllerName); 
```

意味着我不能做

```
public static ActionResult RedirectToErrorAction(this Controller controller)
{
    // redirect to custom error page
    return controller.RedirectToAction("error", "support");
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T02:30:08.313

您可能需要考虑返回自定义的共享错误视图，但如果您确实需要这样做，您可能需要考虑使用反射来调用内部方法。前者可以在成为所有控制器基础的基本控制器中实现。

第一个例子：

```
public class BaseController : Controller
{ 
    private ActionResult CreateErrorResult( string message )
    {
         ViewData["message"] = message;
         ...
         return new View( "CustomError" );
    }
} 
```

第二个示例（如果通过反射获取内部属性有效）：

```
public static ActionResult RedirectToErrorAction(this Controller controller)
{
    MethodInfo info = typeof(Controller).GetMethod( "RedirectToAction",
                            BindingFlags.NonPublic|BindingFlags.Instance,
                            null,
                            new Type[] { typeof(string), typeof(string) },
                            null );
    return info.Invoke( controller, new object[] { "error", "support" } )
               as ActionResult;
} 
```

# php - RSS 函数导致某些属性的语法错误

> ID：668543
> 
> 赞同：1
> 
> 时间：2009-03-21T01:23:00.237
> 
> 标签：php, mysql, html, rss

我有一个用 PHP 构建 rss 提要的功能：

```
function createRSS() {
    $currentDate = time();
    $sql = "SELECT * FROM ". ADS_TABLE ." WHERE expires > $currentDate ORDER BY enterd DESC LIMIT 0,400";
    $results = myExec($sql);
    // open a file pointer to an RSS file
    $fp = fopen ("mexautosrss.xml", "w");
    if (!$fp) {
    // Can't write to a file
    return;
    }

    fwrite ($fp, "<?xml version='1.0' encoding='iso-8859-1' ?>\n");
    //ERROR:  fwrite ($fp, "<rss version='2.0' xmlns:atom="http://www.mexautos.com/mexautosrss.xml"><channel>\n");
    fwrite ($fp, "<title>MexAutos.com</title>\n");
    //ERROR:  fwrite ($fp, "<atom:link href="http://www.mexautos.com/mexautosrss.xml" rel="self" type="application/rss+xml" />\n");
    fwrite ($fp, "<link>http://www.mexautos.com/</link>\n");
    fwrite ($fp, "<description>Anuncios de Autos y Camionetas Usados en Mexico.</description>\n");
    fwrite ($fp, "<language>es-mx</language>\n");
    fwrite ($fp, "<docs>http://www.mexautos.com/mexautosrss.xml</docs>\n");
    fwrite ($fp, "<image>\n");
    fwrite ($fp, " <title>Mexautos.com</title>\n");
    fwrite ($fp, " <url>http://www.mexautos.com/images/logo_top_es.gif</url>\n");
    fwrite ($fp, " <link>http://www.mexautos.com</link>\n");
    fwrite ($fp, "</image>\n");

    while ($row = mysql_fetch_array($results)) {
        $makeId = $row['make'];
        $makeSQL = "SELECT name FROM ". CAR_MAKES_TABLE ." WHERE pkMakeID=$makeId";
        $makeResults = myExec($makeSQL);
        $make = mysql_fetch_row($makeResults);
        $modelId = $row['model'];
        $makeSQL = "SELECT name FROM ". CAR_MODELS_TABLE ." WHERE pkModelID=$modelId";
        $makeResults = myExec($makeSQL);
        $model = mysql_fetch_row($makeResults);
        $stateId = $row['state'];
        $makeSQL = "SELECT name FROM ". STATES_TABLE ." WHERE pkStateID=$stateId";
        $makeResults = myExec($makeSQL);
        $state = mysql_fetch_row($makeResults);
        $title = $make[0]." ".$row['make_other']." ".$model[0]." ".$row['model_other']." '".$row['model_year'];
        $content = "$".$row['price']." mil pesos ".$row['color']." Clima: ".$row['clima']." ".$row['milage']." mil kms Puertas: ".$row['doors']." ".$row['transmission']." ".$row['comment']." Tel: ".$row['tel_num']." (".$state[0].")";
        $search = array(
            '@<script[^>]*?>.*?</script>@si', // Strip out javascript
            '@<[\/\!]*?[^<>]*?>@si', // Strip out HTML tags
            '@([\r\n])[\s]+@', // Strip out white space
            '@&(quot|#34);@i', // Replace HTML entities
            '@&(amp|#38);@i',
            '@&(lt|#60);@i',
            '@&(gt|#62);@i',
            '@&(nbsp|#160);@i',
            '@&(iexcl|#161);@i',
            '@&(cent|#162);@i',
            '@&(pound|#163);@i',
            '@&(copy|#169);@i',
            '@&(acento|#0027);@i',
            '@&#(\d+);@e'
        ); // evaluate as php
        $replace = array(
            '',
            '',
            '\1',
            '"',
            '&',
            '<',
            '>',
            ' ',
            'chr(161)',
            'chr(162)',
            'chr(163)',
            'chr(169)',
            'chr(\1)'
        );
        $content = preg_replace($search, $replace, $content);
        $title = preg_replace("/&/", 'y', $title);
        $content = preg_replace("/&/", 'y', $content);
        fwrite ($fp, "<item>\n");
        fwrite ($fp, " <title>$title</title>\n");
        fwrite ($fp, " <description>$content</description>\n");
        fwrite ($fp, " <link>http://www.mexautos.com/</link>\n");
        fwrite ($fp, "<guid>http://www.mexautos.com</guid>\n");
        fwrite ($fp, "</item>\n");
    }
    fwrite ($fp, "</channel></rss>\n");
    fclose ($fp);
} 
```

问题是如果我不注释掉这些`atom:link`行，我会得到一个错误，它显示：

```
Parse error: syntax error, unexpected T_STRING 
```

有人可以指出错误在哪里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T01:25:07.130

如果您在 PHP（或几乎任何其他语言）中的双引号字符串中包含双引号字符，则需要转义这些文字双引号字符。

```
fwrite ($fp, "<rss version='2.0' xmlns:atom=\"http://www.mexautos.com/mexautosrss.xml\"><channel>\n"); 
```

或者使用单引号，这通常在 HTML 中可以互换：

```
fwrite ($fp, "<rss version='2.0' xmlns:atom='http://www.mexautos.com/mexautosrss.xml'><channel>\n"); 
```

在此处查看引用类型的规范以分隔 HTML/SGML 属性：http: [//www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.2](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.2)

> 默认情况下，SGML 要求使用双引号（ASCII 十进制 34）或单引号（ASCII 十进制 39）分隔所有属性值。当值由双引号分隔时，可以在属性值中包含单引号，反之亦然。

最后一句适用于包含引号的 HTML 属性字符串，这不是您的方案。但是您确实有 PHP 代码带有包含引号的带引号的字符串，并且 PHP 支持关于引号的相同策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T01:28:45.093

您需要正确转义字符串：

```
fwrite ($fp, "<rss version='2.0' xmlns:atom=\"http://www.mexautos.com/mexautosrss.xml\"><channel>\n"); 
```

# c# - 圆括号与否？有什么不同？

> ID：668557
> 
> 赞同：3
> 
> 时间：2009-03-21T01:33:39.010
> 
> 标签：c#, asp.net, class, conventions

我最近看到了这两件事，我有点困惑。

```
var blah = new MyClass() { Name = "hello" } 
```

和

```
var blah = new MyClass { Name = "hello" } 
```

有什么不同？为什么它们都起作用？

**更新：** 这是否意味着如果我在构造函数中有一些东西，我必须调用第一个计算？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-21T01:37:54.400

据我所知，它们是完全等价的。只要您使用大括号（即[对象初始化器](http://msdn.microsoft.com/en-us/library/bb384062.aspx)的语法），C# 规范（或至少 Microsoft 的实现）允许您在使用默认构造函数（无参数）时省略 ( )。请注意，对象初始值设定项对这里的构造函数没有影响——该`new MyClass`位仍然被单独解释为对默认构造函数的调用。就个人而言，我建议您始终包含圆括号 () 以保持一致性 -当您没有跟随对象初始值设定项时，您*需要它们。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T01:49:23.200

没有区别，第一种形式只是指出您*也在*调用构造函数：

```
class Ö {
    public string Ä { get; set; }
    public string Å { get; set; }
    public Ö() { Å = "dear";}
    public Ö(string å) { Å = å; }    
}

Console.WriteLine(new Ö { Ä = "hello" }.Å);
Console.WriteLine(new Ö("world") { Ä = "hello" }.Å); 
```

将导致：

```
dear
world 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T02:09:57.940

要添加到上述评论，添加额外的绝对有助于澄清正在调用的构造函数或 init 方法。绝对是造型方面也......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T02:14:31.627

我猜他们保留了对象初始值设定项的 () 形式，因为一些用户喜欢 () 用于调用构造函数的清晰性，但是 iirc、C++（或第一个版本）允许在没有括号的情况下调用构造函数。我的第二个猜测是，他们（语言设计者）倾向于使 C# 具有类似 JSON 的结构，这有点整洁，所以他们便于在没有 () 的情况下调用构造函数。我赞成第二种形式。

没有区别，就像 VB.NET 的属性（尽管如此糟糕）允许您以两种形式分配变量： button1.Height = 100 button1.Height() = 1000 有点蹩脚，如果你问的话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-21T13:48:04.643

实际上，在您处理没有默认空构造函数的类型之前，它们并没有太大区别。在这种情况下，您可以编写类似“new SomeClass(MandatoryArgument) { Prop1 = 1, Prop2 = 2 }”

# oracle - 使用 Oracle Designer 有什么好处？

> ID：668573
> 
> 赞同：1
> 
> 时间：2009-03-21T01:49:11.237
> 
> 标签：oracle, svn, designer

为什么我要使用*Oracle Designer*而不是简单地维护 SQL 脚本并将它们存储在诸如*Subversion*之类的版本控制系统中？

我需要决定是否值得将现有数据库逆向工程到*Designer*中。
似乎将*DDL*脚本与应用程序源代码一起存储在*subversion*中会更容易。

我组织的政策是使用*Designer*管理所有数据库模式。如果有某种*ROI*，我完全支持合规性，但我无法通过将现有数据库逆向工程到*Designer来了解如何产生任何**ROI*。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T12:21:17.537

使用 Designer 的一些好处：

*   易于浏览表定义、约束等。
*   显示表格及其关系的图形工具
*   影响分析工具
*   为新的/更改的表定义生成 DDL

这是否值得使用取决于您的组织在多大程度上利用了这些好处。我的组织使用 Designer 来管理一个非常大（数千个表）的数据库；对于较小的数据库，好处可能会更小。

# objective-c - Linux 上的 Objective-C 是否被垃圾收集？

> ID：668576
> 
> 赞同：3
> 
> 时间：2009-03-21T01:53:24.503
> 
> 标签：objective-c, gcc, garbage-collection, g++

Objective-C v2.0（这是 mac 使用的）有一个新功能，垃圾收集。我是 Linux PC 上的孩子（如果你想知道的话，我是 Ubuntu）。所以我的问题是，使用 gcc/g++ 编译器是 Objective-C Garbage Collected 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-10-12T16:27:49.017

上面的回复是错误的。至少从 gcc 2.95 开始，垃圾收集[一直是 gcc 实现 Objective-C 的一部分](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/objc-features_1.html#SEC5)。最新版本是 gcc 4.4.1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T02:02:50.690

如果您指的是 Gnustep Objective-C。我认为您必须在启用 gc 并链接到某些 gc 库的情况下构建 gnustep。但是，如果您执行 apt-get install 它就是这样构建的。

# java - MVC 和 Java 与更严格的 MVC 语言的比较

> ID：668587
> 
> 赞同：5
> 
> 时间：2009-03-21T02:06:05.487
> 
> 标签：java, cocoa, model-view-controller

有人告诉我，Java 不是遵循 MVC 架构的最佳选择。我相信我已经看到了一些 Java 框架解决方案来缓解这个障碍。但是，我有点困惑为什么会这样。更具体地说，为什么 Java 在 MVC 上的尝试经常被嘲笑为一种“想要的”方法。我来自 ObjC 背景（当然是 Cocoa），并且很想听听经验丰富的程序员关于为什么说 MVC 与 Java 的不足之处。

欣赏它！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-21T02:33:35.280

你说你来自 Cocoa 背景，所以我假设你不是在谈论 web 框架 MVC。大多数声称他们使用 MVC 的 web 框架实际上都使用了一种称为 Front Controller 的不同模式，这与普通的 MVC 有点不同，因为您需要大量的管道才能使其工作。因此，Web 世界中的所有 MVC 框架，最初 MVC 是基于窗口的应用程序的模式。对于这些应用程序，您无需框架即可使 MVC 工作。

MVC 是一种可以用任何面向对象语言实现的模式。没有理由不能在 Java 中做到这一点。我能想到人们为什么将 Java 上的 MVC 称为“想要的”方法的唯一原因是，Java 上的 UI 库（如 Swing）实际上并不需要您执行 MVC。他们只是为您提供实现视图的工具。您必须自己创建控制器和模型类。

无论如何，关于什么是“真正的 MVC”的讨论通常并不具有建设性。MVC 是大约 30 年前为 smaltalk 开发的一种模式。现在使用的实现不再完全相同，许多实现都是改进。你有不同的风格，称为 MVP、MVVM、Document-View 等。它们在某些情况下都很有用。重要的是，将 UI 逻辑与应用程序逻辑分开是一个好主意。Java 可以做到这一点，大多数其他语言也可以。声称不这样的人可能只是害怕看到他们熟悉的语言之外的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-21T02:35:52.840

从根本上讲，MVC 是一种编程模型。我认为它与平台和语言无关。我曾经在 C++ 中遵循 MVC 原则，所以我不确定为什么任何语言在遵循这些原则方面都会被视为“不足”。诚然，这些天我是一个 .NET 人，但我认为只要稍加努力，它们就可以应用于 Java。有关一些想法，请参阅[Java 模型视图控制器](http://leepoint.net/notes-java/GUI/structure/40mvc.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-21T13:09:59.320

> 很想听听经验丰富的程序员为什么说 MVC 与 Java 不足。

它没有。用几乎任何语言实现 MVC 绝对没有错。这是一种模式，而不是语言特征。此外，我以前从未听过任何人说“Java 中的 MVC 不足”——我的猜测是，这句话要么是断章取义，要么是发表该声明的人对 Java 没有什么经验，或者有其他意图。

您不必仅仅为了编写 Cocoa 应用程序就使用 Cocoa 中的 MVC 相关类*。*很高兴他们在那里，并且在工具（如 Interface Builder）中有各种强大的支持来使用它们，并且可能很少有你*不会*使用它们的情况，但没有什么是目标的基础-C 语言使 MVC 实现比用 Java 编码的 MVC 实现“更好”。此外，正如 Cocoa 框架通过各种 Controller 和 View 类为 MVC 提供各种强大的支持一样，也有许多优秀的 Java 框架为实现 MVC 提供支持。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-21T03:24:00.137

我觉得 MVC 模式作为动态的、数据驱动的 Web 应用程序的框架似乎需要更少的冗长，因此使用 Python 和 Ruby 等动态语言的代码更少，这是一件好事。

动态语言可以轻松避免 M、V 和 C 之间的依赖关系，这是该模式的目的之一。例如，在 Python 中，您可以将模型对象传递给视图，而视图不需要依赖模型类型，它只关心传入具有相同属性的任何类型。一旦您开始在视图中使用模板语言，就像在 Django 中一样，当属性不存在时，它甚至不会导致脚本错误。

为了避免强类型语言中的这些依赖关系，您经常开始传递以文字字符串作为键的字典，这意味着强类型语言的大部分好处都丢失了（即，您的编译器不会告诉您将键命名为“人”然后尝试使用关键“人员”找到它，这将在运行时发现）

此外，鉴于 MVC 模式通过允许单独测试 M、V 和 C 来进行测试，因此使用强类型编译语言的优势较小，因为测试可用于验证您的应用程序是否正常工作。

# asp.net-mvc - 如何在 ASP.net MVC 中将项目添加到 SelectList

> ID：668589
> 
> 赞同：118
> 
> 时间：2009-03-21T02:07:17.153
> 
> 标签：asp.net-mvc, selectlist

基本上，我希望在 SelectList 的开头插入一个项目，默认值为 0，文本值为“--Select One--”

就像是

```
SelectList list = new SelectList(repository.func.ToList());
ListItem li = new ListItem(value, value);
list.items.add(li); 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-03-21T02:16:28.923

除非您坚持将值设为 0，否则实际上没有必要这样做。HtmlHelper DropDownList 扩展允许您设置一个选项标签，该标签显示为带有空值的选择中的初始值。只需使用具有选项标签的 DropDownList 签名之一。

```
<%= Html.DropDownList( "DropDownValue",
                       (IEnumerable<SelectListItem>)ViewData["Menu"],
                        "-- Select One --" ) %> 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2010-04-29T00:23:45.497

我通过填充一个 SelectListItem、转换为一个列表并在索引 0 处添加一个值来实现这一点。

```
List<SelectListItem> items = new SelectList(CurrentViewSetups, "SetupId", "SetupName", setupid).ToList(); 
items.Insert(0, (new SelectListItem { Text = "[None]", Value = "0" }));
ViewData["SetupsSelectList"] = items; 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-06-05T15:20:36.960

这个有可能。

```
//Create the select list item you want to add
SelectListItem selListItem = new SelectListItem() { Value = "null", Text = "Select One" };

//Create a list of select list items - this will be returned as your select list
List<SelectListItem> newList = new List<SelectListItem>();

//Add select list item to list of selectlistitems
newList.Add(selListItem);

//Return the list of selectlistitems as a selectlist
return new SelectList(newList, "Value", "Text", null); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-06-01T20:31:35.550

我喜欢@AshOoO 的回答，但就像@Rajan Rawal 一样，我需要保留选定项目的状态（如果有的话）。所以我将我的自定义添加到他的方法中`AddFirstItem()`

```
public static SelectList AddFirstItem(SelectList origList, SelectListItem firstItem)
{
    List<SelectListItem> newList = origList.ToList();
    newList.Insert(0, firstItem);

    var selectedItem = newList.FirstOrDefault(item => item.Selected);
    var selectedItemValue = String.Empty;
    if (selectedItem != null)
    {
        selectedItemValue = selectedItem.Value;
    }

    return new SelectList(newList, "Value", "Text", selectedItemValue);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-11-29T19:41:15.740

这里为您提供 html 助手

```
public static SelectList IndividualNamesOrAll(this SelectList Object)
{
    MedicalVarianceViewsDataContext LinqCtx = new MedicalVarianceViewsDataContext();

    //not correct need individual view!
    var IndividualsListBoxRaw =  ( from x in LinqCtx.ViewIndividualsNames 
                                 orderby x.FullName
                                 select x);

    List<SelectListItem> items = new SelectList (
                               IndividualsListBoxRaw, 
                              "First_Hospital_Case_Nbr", 
                              "FullName"
                               ).ToList();

    items.Insert(0, (new SelectListItem { Text = "All Individuals", 
                                        Value = "0.0", 
                                        Selected = true }));

    Object = new SelectList (items,"Value","Text");

    return Object;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-02-06T10:16:58.287

```
private SelectList AddFirstItem(SelectList list)
        {
            List<SelectListItem> _list = list.ToList();
            _list.Insert(0, new SelectListItem() { Value = "-1", Text = "This Is First Item" });
            return new SelectList((IEnumerable<SelectListItem>)_list, "Value", "Text");
        } 
```

这应该可以满足您的需要，只需发送您的选择列表，它将返回一个选择列表，其中包含索引 0 中的项目

您可以自定义需要插入的项目的文本、值甚至索引

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-03T17:04:53.030

.ToList **().Insert(..)**方法将一个元素放入您的列表中。可以指定任何位置。在 ToList 之后添加*.Insert(0, "- - First Item - -")*

**你的代码**

```
SelectList list = new SelectList(repository.func.ToList()); 
```

**新代码**

```
SelectList list = new SelectList(repository.func.ToList().Insert(0, "- - First Item - -")); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-03T04:00:36.467

听起来可能不太优雅，但我通常会这样做：

```
 var items = repository.func.ToList();
    items.Insert(0, new funcItem { ID = 0, TextValue = "[None]" });
    ViewBag.MyData = new SelectList(items); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-21T23:37:06.713

好的，我喜欢干净的代码，所以我将此作为扩展方法

```
static public class SelectListHelper
{
    static public SelectList Add(this SelectList list, string text, string value = "", ListPosition listPosition = ListPosition.First)
    {
        if (string.IsNullOrEmpty(value))
        {
            value = text;
        }
        var listItems = list.ToList();
        var lp = (int)listPosition;
        switch (lp)
        {
            case -1:
                lp = list.Count();
                break;
            case -2:
                lp = list.Count() / 2;
                break;
            case -3:
                var random = new Random();
                lp = random.Next(0, list.Count());
                break;
        }
        listItems.Insert(lp, new SelectListItem { Value = value, Text = text });
        list = new SelectList(listItems, "Value", "Text");
        return list;
    }

    public enum ListPosition
    {
        First = 0,
        Last = -1,
        Middle = -2,
        Random = -3
    }
} 
```

用法（举例）：

```
var model = new VmRoutePicker
    {
     Routes =
     new SelectList(_dataSource.Routes.Select(r => r.RouteID).Distinct())
     };                                     
  model.Routes = model.Routes.Add("All", "All", SelectListHelper.ListPosition.Random);
//or
  model.Routes = model.Routes.Add("All"); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-15T21:39:48.793

由于此选项可能需要许多不同的方式，我得出结论来开发一个对象，以便它可以在不同的场景和未来的项目中使用

首先将此类添加到您的项目中

```
public class SelectListDefaults
{
    private IList<SelectListItem> getDefaultItems = new List<SelectListItem>();

    public SelectListDefaults()
    {
        this.AddDefaultItem("(All)", "-1");
    }
    public SelectListDefaults(string text, string value)
    {
        this.AddDefaultItem(text, value);
    }
    public IList<SelectListItem> GetDefaultItems
    {
        get
        {                
            return getDefaultItems;
        }

    }
    public void AddDefaultItem(string text, string value)
    {        
        getDefaultItems.Add(new SelectListItem() { Text = text, Value = value });                    
    }
} 
```

现在在控制器动作中你可以这样做

```
 // Now you can do like this
    ViewBag.MainCategories = new SelectListDefaults().GetDefaultItems.Concat(new SelectList(db.MainCategories, "MainCategoryID", "Name", Request["DropDownListMainCategory"] ?? "-1"));
    // Or can change it by such a simple way
    ViewBag.MainCategories = new SelectListDefaults("Any","0").GetDefaultItems.Concat(new SelectList(db.MainCategories, "MainCategoryID", "Name", Request["DropDownListMainCategory"] ?? "0"));
    // And even can add more options
    SelectListDefaults listDefaults = new SelectListDefaults();
    listDefaults.AddDefaultItme("(Top 5)", "-5");
    // If Top 5 selected by user, you may need to do something here with db.MainCategories, or pass in parameter to method 
    ViewBag.MainCategories = listDefaults.GetDefaultItems.Concat(new SelectList(db.MainCategories, "MainCategoryID", "Name", Request["DropDownListMainCategory"] ?? "-1")); 
```

最后在 View 中，您将像这样编写代码。

```
@Html.DropDownList("DropDownListMainCategory", (IEnumerable<SelectListItem>)ViewBag.MainCategories, new { @class = "form-control", onchange = "this.form.submit();" }) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-29T05:20:19.507

一种解决方法是使用@tvanfosson 的答案（选择的答案）并使用 JQuery（或 Javascript）将选项的值设置为 0：

```
$(document).ready(function () {
        $('#DropDownListId option:first').val('0');
    }); 
```

希望这可以帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-18T18:40:10.890

尝试类似以下代码：

```
MyDAO MyDAO = new MyDAO();    
List<MyViewModel> _MyDefault = new List<MyViewModel>() {
                new MyViewModel{
                    Prop1= "All",
                    Prop2 = "Select all"
                }
            };
            ViewBag.MyViewBag= 
                new SelectList(MyDAO
                .MyList().Union(
                    _MyDefault
                    ), "Prop1", "Prop2"); 
```

* * *

## 回答 #13

> 赞同：-5
> 
> 时间：2010-01-19T19:10:21.000

如果其他人有更好的选择，我不...

```
<% if (Model.VariableName == "" || Model.VariableName== null) { %>
   <%= html.DropDpwnList("ListName", ((SelectList) ViewData["viewName"], "", 
        new{stlye=" "})%>
<% } else{ %>
<%= html.DropDpwnList("ListName", ((SelectList) ViewData["viewName"], 
        Model.VariableName, new{stlye=" "})%>
<% }> 
```

# python - 为什么 Beautiful Soup 会截断此页面？

> ID：668591
> 
> 赞同：2
> 
> 时间：2009-03-21T02:08:30.893
> 
> 标签：python, screen-scraping, beautifulsoup

我正在尝试从我的学校图书馆订阅的资源列表中提取资源/数据库名称和 ID 列表。有些页面列出了不同的资源，我可以使用 urllib2 来获取页面，但是当我将页面传递给 BeautifulSoup 时，它会在列表中第一个资源的条目结束之前截断它的树。问题似乎出在用于将资源添加到搜索集中的图像链接中。这是事情被切断的地方，这是HTML：

```
<a href="http://www2.lib.myschool.edu:7017/V/ACDYFUAMVRFJRN4PV8CIL7RUPC9QXMQT8SFV2DVDSBA5GBJCTT-45899?func=find-db-add-res&amp;resource=XYZ00618&amp;z122_key=000000000&amp;function-in=www_v_find_db_0" onclick='javascript:addToz122("XYZ00618","000000000","myImageXYZ00618","http://discover.lib.myschool.edu:8331/V/ACDYFUAMVRFJRN4PV8CIL7RUPC9QXMQT8SFV2DVDSBA5GBJCTT-45900");return false;'>
    <img name="myImageXYZ00618" id="myImageXYZ00618" src="http://www2.lib.myschool.edu:7017/INS01/icon_eng/v-add_favorite.png" title="Add to My Sets" alt="Add to My Sets" border="0">
</a> 
```

这是我的python代码：

```
import urllib2
from BeautifulSoup import BeautifulSoup
page = urllib2.urlopen("http://discover.lib.myschool.edu:8331/V?func=find-db-1-title&mode=titles&scan_start=latp&scan_utf=D&azlist=Y&restricted=all")
print BeautifulSoup(page).prettify 
```

在 BeautifulSoup 的版本中，开头会`<a href...>`显示，但`<img>`不会，并且`<a>`会立即关闭，其他打开的标签也是如此，一直到`</html>`.

对于这些“添加到集合”图像，我看到的唯一显着特征是它们是唯一具有 name 和 id 属性的图像。不过，我不明白为什么这会导致 BeautifulSoup 立即停止解析。

注意：我对 Python 几乎是全新的，但似乎完全理解它。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-03T04:09:12.610

您可以尝试使用 html5lib 而不是内置解析器的漂亮汤。

```
BeautifulSoup(markup, "html5lib") 
```

html5lib 更宽松，通常会解析内置解析器截断的页面。[请参阅http://www.crummy.com/software/BeautifulSoup/bs4/doc/#searching-the-tree](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#searching-the-tree)上的文档

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T06:34:15.967

我使用的是 Firefox 的“视图选择源”，它显然为我清理了 HTML。当我查看原始来源时，这是我看到的

```
<img name="myImageXYZ00618" id="myImageXYZ00618" src='http://www2.lib.myschool.edu:7017/INS01/icon_eng/v-add_favorite.png' alt='Add to My Sets' title='Add to My Sets' border="0"title="Add to clipboard PAIS International (CSA)" alt="Add to clipboard PAIS International (CSA)"> 
```

通过在属性后放置一个空格`border="0"`，我可以让 BS 解析页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T19:19:48.760

我强烈推荐使用 html5lib + lxml 而不是美汤。它使用真正的 HTML 解析器（与 Firefox 中的解析器非常相似），lxml 提供了一种非常灵活的方式来查询结果树（css-selectors 或 xpath）。

BeautifulSoup 中存在大量错误或奇怪的行为，这使得它不是您无法信任的许多 HTML 标记的最佳解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T03:59:26.617

如果我没记错的话，BeautifulSoup 在它的树中使用“名称”作为标签的名称。在这种情况下，“a”将是锚标记的“名称”。

但这似乎不应该打破它。你使用的是什么版本的 Python 和 BS？

# c++ - 将 Qt 添加到 Xcode 项目？

> ID：668604
> 
> 赞同：2
> 
> 时间：2009-03-21T02:14:09.163
> 
> 标签：c++, xcode, qt

我有一个相当复杂的 Xcode 项目，我想在其中添加 Qt。我知道我可以使用创建一个*新*项目，`qmake -spec macx-xcode project.pro`但我不想在自动生成的 Qt 项目上手动配置我的旧项目。还有其他选择吗？

[在下面更一般的问题中编辑]

似乎简单地使用 qmake 作为我的构建系统会更容易。因此，将我的旧项目构建过程添加到*.pro*文件并使用它来生成新的*.xcodeproj*？如果我可以全面配置 .pro 文件，我只会这样做，这样我就不必手动配置*.xcodeproj* - 这是可行的吗？我真的不想每次运行 qmake 时都必须手动配置*.xcodeproj 。*

本质上，qmake（或一般的元构建）是正常构建系统的有效替代品，这样我就不需要调整 qmake 生成的构建系统？

除了奇趣科技提供的[手册](http://doc.trolltech.com/4.5/qmake-manual.html)和[教程](http://doc.trolltech.com/4.5/qmake-tutorial.html)，还有更好的资源吗？我担心[维基百科](http://en.wikipedia.org/wiki/Qmake)说 qmake 主要供内部使用并且没有很好的记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T12:28:08.050

使用 qmake 构建一个空的 xcode 项目，并将编译器设置从生成的 Makefile 合并到您现有的项目中。当然，如果您使用 Qt 特定的扩展，则必须设置现有项目以运行 qmake 作为预构建步骤。

> 您认为将已建立的项目与 Qt 集成的最简单方法是什么？

这取决于你的工作性质。我希望我能在这里给出更具体的答案，但我真的不能。另外，您使用的是 Qt 专业版吗？在这种情况下，您可以获得支持（至少在 3.3 中，当我最后一次为任何生产质量工作时，情况就是这样）。如果您只关心 Qt 的图形部分，我会说不要费心更改您的构建系统，而是确保您获得编译和链接并运行良好的代码。但是，如果您要使用信号和插槽以及不使用的东西 - 考虑移动。

> 你会建议我做我问过的 xcodeproj 合并，你回答过，还是应该像我编辑一个问题一样从头开始使用 qmake？

再次，看看你的项目的规模。假设一个相当复杂的项目，我敢猜测您有大约 2/3 人日的工作量来重写构建系统？这个项目是一个严肃的项目，需要一段时间的维护吗？这是跨平台吗？你会一直使用 Qt 吗？

如果有一个霸道的理由觉得 Qt 是前进的方向，我建议你开始使用他们的构建系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T19:41:41.787

使用 Qt 的要点之一是 Gui 的可移植性。只有通过使用 qmake 并允许用户/开发人员生成他们想要使用的任何构建系统（make、visualstudio、xcode）来将此功能扩展到您的构建过程才有意义。

不，qmake 没有很好的文档记录，更令人痛心的是，没有像 make 那样的多种示例。但是，它类似于 make 并且应该是直观的。为什么不吸收开销来学习它并将好处传递给您的用户/开发人员？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-13T06:48:57.287

拥有一个可在您编写的所有平台上运行的单一 IDE 和调试器真的非常非常好，但我发现只使用本机工具也非常好。

一旦您花时间学习每个构建系统，就很容易将项目维护到非常精确的程度。

# c# - 创建菜单堆栈

> ID：668607
> 
> 赞同：1
> 
> 时间：2009-03-21T02:15:22.327
> 
> 标签：c#, menu, stack

我正在尝试创建一个菜单系统，允许您在将最终选择的数据返回给调用方法时前后移动。

举个例子，orderFood() 方法显示可以订购的食物类型的菜单。如果有人选择海鲜，一个海鲜（）方法将运行并查询可以订购哪些类型的海鲜，然后显示它

如果用户选择了 fishsticks，fishsticks 将返回到调用 order food 的方法。同样，这个菜单系统将允许用户返回到前一个菜单。

我在想（使用 C#）我必须使用反射和不安全的代码（指针）来获得这种效果，但我很肯定有一种更简单的方法可以做到这一点。有什么建议么？

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T02:31:11.587

与其将菜单视为堆栈，不如尝试将它们视为一棵树。

如果你这样做，在你需要实现你的堆栈方法时，在树上上下“走动”应该是相当容易的。

这将相当容易从文件或数据库中读取（尤其是从 XML 中非常容易），而且上下走动也不应该太难。

这实际上并没有任何需要不安全代码或反射的东西——这一切都可以通过 C# 中的标准集合来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T02:21:15.950

只要您在编译时就知道，您可以轻松地做您所描述的事情，而无需不安全的代码，方法是使其成为数据驱动的。与其将菜单视为执行这些操作的例程，不如将菜单视为执行这些操作的一类对象。嗯。

即使您在编译时不了解所有内容（例如，您需要从文件中读取选项），您仍然可以根据文件的内容在运行时构建代表您的菜单的对象嵌套来做到这一点。

# c# - 在 SQL 2008 CLR UDF 中使用 HttpWebrequest 解决不稳定行为

> ID：668617
> 
> 赞同：0
> 
> 时间：2009-03-21T02:22:57.567
> 
> 标签：c#, .net, sql-server, clr, user-defined-functions

我们目前正在尝试实施 sql server 2008 udf 来扩展缩短的 url。我们让它对大多数主要的 URL 缩短服务都非常有效。但是，在看似随机的时间，它会“挂起”并拒绝针对某个域（例如 bit.ly）工作，而随后对其他服务的调用（例如 tinyurl.com）将继续成功。

我们最初认为这是由于 url 缩短提供程序的某种阻塞，但停止并重新启动 dbserver 服务会导致后续请求成功。会不会是 SQL 服务器以某种方式汇集了传出的 http 连接？

这是代码...

```
using System;
using System.Data;
using System.Net;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;

public partial class UserDefinedFunctions
{
    [Microsoft.SqlServer.Server.SqlFunction]
    public static SqlString UrlExpander(string url)
    {
            // Set up the Webrequest
            HttpWebRequest wr = (HttpWebRequest)HttpWebRequest.Create(url);
            try
            {

            // Set autoredirect off so the redirected URL will not be loaded
            wr.AllowAutoRedirect = false;

            // Get the response
            HttpWebResponse wresp = (HttpWebResponse)wr.GetResponse();

            return new SqlString(wresp.Headers["Location"].ToString());
        }
        catch (Exception ex)
        {
            wr.Abort();
            throw ex;

        }

    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T02:27:37.197

您缺少 wresp.Close()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T16:10:42.040

鉴于 Jesse 的反馈以及我们希望拥有一个返回正确扩展的 url 或 NULL 的函数，我们提出了以下方法，它似乎可以处理 1000 多个缩小的 URL，而没有进一步的问题：

```
[Microsoft.SqlServer.Server.SqlFunction]
public static SqlString UrlExpander(string url)
{
    // Set up the Webrequest
    try
    {
        HttpWebRequest wr = (HttpWebRequest)HttpWebRequest.Create(url);
        try
        {
            // Set autoredirect off so the redirected URL will not be loaded
            wr.AllowAutoRedirect = false;

            // Get the response
            HttpWebResponse wresp = (HttpWebResponse)wr.GetResponse();
            wresp.Close();

            if (wresp != null)
                return new SqlString(wresp.Headers["Location"].ToString());
        }
        finally
        {
            if (wr != null)
                wr.Abort();
        }
    }
    catch
    {
    }

    return null;

} 
```

# mysql - 对文件的查询输出给出拒绝访问错误

> ID：668618
> 
> 赞同：14
> 
> 时间：2009-03-21T02:27:15.653
> 
> 标签：mysql, sql, mysql-error-1045, into-outfile

我正在尝试使用以下查询将 MySQL 中的 SQL 查询的输出捕获到文本文件中。

```
select count(predicate),subject from TableA group by subject into outfile '~/XYZ/output.txt'; 
```

我收到以下错误。

> ERROR 1045 (28000): Access denied for user 'username'@'%' (using password: YES)

任何想法，我哪里错了？这是一些与许可相关的问题吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-21T03:26:26.447

Outfile 是 mysql 自己的权限。

如果你有 ALL 它包括在内。

但是，如果您只有一个安全的集合，例如 SELECT、INSERT、UPDATE、DELETE、DROP、CREATE，但没有 OUTFILE，则“into outfile”在查询中将不起作用。

这样做的原因是，从 MySQL 内部访问文件，即使是出于写入目的，也存在一定的安全风险，因为如果从 mysql 访问文件，则可以访问 mysql 用户有权访问的任何文件，从而绕过基于用户的文件权限。

为了解决这个问题，您可以将查询直接运行到您用来运行 sql 的任何 shell/语言的输出中。

这是一个 *nix 示例

```
>$ echo "select count(predicate),subject from TableA group by subject"  | mysql -u yourusername -p yourdatabasename > ~/XYZ/outputfile.txt 
```

但是在没有“\”的情况下在一行上完成所有操作，或者使用“\”来转义换行符。

这里发生的情况是，您正在向 mysql 客户端运行查询并且它正在吐出结果，然后您将输出定向到文件。所以这个文件永远不会从 mysql 中调用，它是在 mysql 运行后调用的。

因此，使用 mysql 获取信息，然后将数据从您自己的用户 shell 转储到文件中，您会没事的。

或者找到一种方法让自己获得 outfile mysql 权限，无论哪种方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-21T15:24:15.853

如果它是您的系统（您是管理员），并且您知道如何保护它，这就是您启用这些权限的方式。

```
USE mysql;
UPDATE user SET File_priv = 'Y' WHERE User = 'db_user';
FLUSH PRIVILEGES; 
```

# eclipse - 日蚀 PDT

> ID：668623
> 
> 赞同：0
> 
> 时间：2009-03-21T02:31:19.730
> 
> 标签：eclipse, eclipse-pdt

我下载了eclipse pdt，好像只支持php项目？？可以让它支持php和java吗？我不想安装 2 个单独的版本

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T02:34:59.783

您可以安装 Eclipse for [Java Developers 版本](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/ganymede/SR2/eclipse-java-ganymede-SR2-macosx-carbon.tar.gz)（Mac OS 版本），然后使用 Eclipse 中的“软件安装...”选项使用[这三个位置](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/ganymede/SR2/eclipse-java-ganymede-SR2-macosx-carbon.tar.gz)安装 PDT （同样，对于 Mac OS）。前往基础站点选择您的平台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T02:36:25.880

帮助 | 软件更新 | 可用软件选项卡

选择 Ganymede 更新站点或 Eclipse 项目更新站点（您可以添加其他站点）

将列出各种可用的插件和插件，以支持各种编程项目

# mysql - 这个mysql查询怎么做？（如何在 1 行中获取 n 个字段）

> ID：668624
> 
> 赞同：0
> 
> 时间：2009-03-21T02:32:29.667
> 
> 标签：mysql

继上一个问题（[如何在 Mysql 中执行此查询？](https://stackoverflow.com/questions/652484/how-to-do-this-query-in-mysql)）

假设我有一条消息：

```
Id: 1, Message: This is a message 
```

2个科目：

```
Id:1, Subject: Math
Id:2, Subject: Science
Id:3, Subject: Numbers 
```

并且有 2 个 message_subject_rel 条目：

```
Id: 1, message_id: 1, subject_id: 1
Id: 2, message_id: 1, subject_id: 2
Id: 3, message_id: 1, subject_id: 3 
```

我想做一个查询来选择以数学和科学作为我最终使用的主题的消息：

```
SELECT m.*
FROM messages m
 JOIN message_subject_rel ms1 ON (m.id = ms1.message_id)
 JOIN subjects s1 ON (ms1.subject_id = s1.id AND s1.subject = 'Math')
 JOIN message_subject_rel ms2 ON (m.id = ms1.message_id)
 JOIN subjects s2 ON (ms2.subject_id = s2.id AND s2.subject = 'Science'); 
```

现在，很明显我想显示消息（因为它确实有这 2 个主题）并且还告诉用户它不仅有这 2 个主题，但它实际上有 3 个，而且不仅如此.. . 我想打印 3 个主题（当然，我有很多消息并且想实际列出它们，它们各自的主题仅在 1 个查询中）。我似乎无法理解仅通过一个查询是否真的可行，因为我会得到 n 个“主题”字段作为返回。

知道这是否可以通过一个查询来完成，如果可以，怎么做？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T02:51:09.760

有关一种解决方案，请参见[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)。但是，我不知道这种方法的效率如何。

```
select message.Id as id, Message, group_concat(Subject separator ';') as subjects
from message,subject,message_subject_rel
where message.Id=message_subject_rel.message_id
  and subject.Id=message_subject_rel.subject_id
group by message.Id
having subjects like '%Math%' and subjects like '%Science%'; 
```

由此，我得到：

```
+------+---------+----------------------+
| id   | Message | subjects             |
+------+---------+----------------------+
|    1 | Message | Math;Science;Numbers | 
+------+---------+----------------------+ 
```

显然，你可以做得比我的 ';' 更好。分隔符和我的类似子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T02:42:42.917

你试过[`GROUP_CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)吗？

# database-design - 任何离线在线同步的开源示例？

> ID：668627
> 
> 赞同：7
> 
> 时间：2009-03-21T02:34:59.393
> 
> 标签：database-design, web-applications

是否有任何开源应用程序展示**了数据库**[在线-离线同步](https://stackoverflow.com/questions/271610/strategy-for-offline-online-data-synchronization) 的良好技术，例如[Remember The Milk](http://www.rememberthemilk.com)使用他们的 iPhone 应用程序、Google Gears 离线模式等？

 *** * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-21T23:39:43.893

[Unison 文件同步器](http://www.cis.upenn.edu/~bcpierce/unison/)是一个很棒的工具，但它的源代码不适合胆小的人。你没有要学术论文，但我写[了一篇我引以为豪的论文](http://www.cs.tufts.edu/~nr/pubs/sync-abstract.html)。有一些 perl 代码与那个一起使用，但我不确定它是否有任何用处。如果你想要它给我发电子邮件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T02:40:02.363

google gears 本身是开源的。您需要查看 localserver 模块。

查看主要开发者站点的[code.google.com/p/gears和](http://code.google.com/p/gears/)[LocalServer 源代码](http://code.google.com/p/gears/source/browse/#svn/trunk/gears/localserver)。虽然 gears 是一个复杂的软件，因为它有很多组件（浏览器插件接口、与 javascript 的集成、SQLite 集成等），但它的因素相当好，因此 LocalServer 源代码很容易理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T07:51:38.870

我有使用[SymmetricDS](http://symmetricds.codehaus.org/)的经验，它真的很棒。它可以处理很多场景。它是开源的，因此可以针对某些特殊情况进行修改或扩展。正如作者所说，它是为现实生活中的项目开发的，因此您可以确定它确实可以正常工作（而且它也适用于我）。

就一件事。SymmetricDS 依赖于数据库触发器，因此您的数据库必须支持触发器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T09:36:04.617

[关于Operational Transform](http://en.wikipedia.org/wiki/Operational_transformation)的 Wikipedia 文章引用了四个开源应用程序 - Ace、Gobby、Subetheredit 和 So6。也许其中之一可以用作您的起点。

虽然它们可能无法直接与您选择的 DBMS 一起使用，但值得考虑将 Operation Transform 作为同步的基础。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-03T13:40:40.807

[使用 CouchDB 在移动和固定设备上创建离线 Web 应用程序](http://www.ibm.com/developerworks/web/library/wa-couchdb/)一文描述了一个简单的库存管理应用程序。与源代码。它使用 CouchDB 的[复制支持](http://wiki.apache.org/couchdb/Replication)。虽然 CouchDB 是一个 NoSQL 数据库（更具体地说，是面向文档的）。如果您正在寻找 RDBMS 的解决方案，Microsoft Sync 框架中的[数据库同步提供程序](http://msdn.microsoft.com/en-us/sync/bb887608)利用了 SQL Server 2008 中内置的更改跟踪机制。Microsoft 还在其 Smart Client Offline Application Block 的文档中描述[了一种面向服务的方法](http://msdn.microsoft.com/en-us/library/ff650489.aspx)。在某些情况下，这种方法比在面向数据的方法中使用合并复制更灵活。

# wpf - WPF Datagrid 缩放问题

> ID：668632
> 
> 赞同：2
> 
> 时间：2009-03-21T02:38:19.777
> 
> 标签：wpf, datagrid, wpftoolkit, zooming

我正在使用 WPFToolkit 中的 WPF DataGrid，但在尝试缩放整个数据网格时遇到了问题。我最初的想法是它会非常简单，我只需对网格应用缩放变换，并在用户单击按钮时为 ScaleX、ScaleY 属性设置动画。但是这不起作用，因为滚动条被放大使其变大。我需要数据网格上的固定标题和固定列，所以我不能简单地使用数据网格之外的滚动查看器来处理滚动。我尝试的第二件事是仅缩放网格中的字体大小，但这失败了，因为在缩小字体大小时，列保持在原始宽度并且不会缩小。

最后，我认为我可以通过使用以下代码使其工作，该代码进入数据网格的视图树，并向 Scroll Content Presenter 添加比例变换。（此代码中也未显示，我以相同的方式将转换应用于标题的可视树项，以便它也可以缩放）。在我测试缩放后的水平滚动之前，我认为这很好用。（垂直滚动效果很好。）在缩放之前水平滚动很好，但是在缩放之后，当我水平滚动时，显示会变坏。很难确切地说出它在做什么，但看起来从屏幕左侧滚动的内容正在“折叠”并从左侧返回。也许它只是在左侧粉碎。有没有人有任何想法我怎么能得到这个工作，

```
 ScrollContentPresenter sp = (ScrollContentPresenter)
VisualTreeHelper.GetChild(
VisualTreeHelper.GetChild(
VisualTreeHelper.GetChild(VisualTreeHelper.GetChild(dgMatrix,     0), 0), 0),2);
ScaleTransform st = new ScaleTransform(1, 1);
sp.LayoutTransform = st;
DoubleAnimation a = new DoubleAnimation();
a.By = 1.5;
a.AutoReverse = false;
a.Duration = new Duration(TimeSpan.Parse("0:0:0.25"));
st.BeginAnimation(ScaleTransform.ScaleXProperty, a);
st.BeginAnimation(ScaleTransform.ScaleYProperty, a); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-06T14:55:13.743

我想出了一个解决办法。不知道这是否与您的操作方式相同：

```
<toolkit:DataGrid.CellStyle>
    <Style TargetType="{x:Type toolkit:DataGridCell}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type toolkit:DataGridCell}">
                    <ContentPresenter>
                        <ContentPresenter.LayoutTransform>
                            <ScaleTransform ScaleX="{Binding Path=Value, ElementName=ZoomFactor}"
                                            ScaleY="{Binding Path=Value, ElementName=ZoomFactor}" />
                         </ContentPresenter.LayoutTransform>
                     </ContentPresenter>
                 </ControlTemplate>
             </Setter.Value>
         </Setter>
     </Style>
 </toolkit:DataGrid.CellStyle> 
```

其中 ZoomFactor 是一个滑块：

```
<Slider x:Name="ZoomFactor"
        Value="1"
        Minimum=".25"
        Maximum="5"
        Width="180" Margin="0,0,5,0"/> 
```

# c - 使用 linux 中的其他库创建共享库

> ID：668634
> 
> 赞同：0
> 
> 时间：2009-03-21T02:39:06.357
> 
> 标签：c, linux, linker

我有一个共享库说“libeval.so”。我在我的项目中使用它来创建更多名为“lidpi.so”的共享库。名为“libdpi.so”的库由工具使用。现在，该工具无法看到除“libdpi.so”之外的任何其他库。我正在使用“libeval.so”中存在的几个函数调用，而“libdpi.so”中不存在这些函数调用。gcc中是否有任何开关，或者有什么可以克服的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T02:49:35.023

如果`libdpi.so`被设计成可以打开`libeval.so`，那么你的程序只需要了解一下`libdpi.so`。

具体来说，`libdpi.so`应该有一些调用的函数[`dlopen`](http://linux.die.net/man/3/dlopen)，大概是这样的：

```
dlopen("path/to/libdpi.so", RTLD_LAZY); 
```

然后中的其他功能`libdpi.so`可以与`libeval.so`.

**编辑**：要构建共享库，请使用以下命令：

```
gcc -shared -o libdpi.so [list of object files to go in libdpi.so] 
```

注意：构建对象时，请使用`-fPIC`gcc 的命令参数，如下所示：

```
gcc -fPIC -o foo.o foo.c 
```

# java - 您认为 Terracotta 是成熟的产品吗？

> ID：668640
> 
> 赞同：5
> 
> 时间：2009-03-21T02:46:08.993
> 
> 标签：java, terracotta

我只是不知道。我的意思是，有一些话题让我不相信这些。

例如，最新的稳定版本（3.0.0-stable）有一个损坏的 Eclipse 插件，根本无法工作。此外，尝试在版本之间进行升级是一个巨大的麻烦，因为所有服务器都与所有版本号不完全相同的客户端不兼容。

我还没有完全描述，但似乎 Terracotta 很快就会成为一个容易的瓶颈。

你有什么想法，StackOverflow？您是否成功地使用了 Terracotta，或者您是否也觉得它有点……不成熟？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-22T22:59:41.267

仅供参考，

您提到的版本 - 3.0.0-stable0 - 是 3.0 系列的第一个里程碑版本。这是尚未发布的当前正在进行的版本。当前的稳定版本是 2.7（当前版本：2.7.3）。

如果您正在寻找稳定、成熟的产品，您的意见应该基于 2.7.x，而不是 3.0。拥有“前沿”产品和稳定发布产品的做法非常普遍。可能是术语误导了您。有关 Terracotta 使用的发布命名的更多信息，请查看[Buildology](http://www.terracotta.org/web/display/orgsite/Buildology)页面。

关于版本号，这是令人遗憾的，但也是必要的。为了产品的改进，网络协议和底层存储格式的变化不时发生。发生这些更改时，该产品与以前的版本不兼容。Terracotta 团队没有承诺一些不可能的事情（向后兼容性），而是选择禁止不同的版本相互通信。

在 3.0 版本中，引入了稳定 Terracotta API 的概念，这将为 dot 版本之间的一些兼容性奠定基础，例如 3.0.0 -> 3.0.1。

HTH。

问候，

Taylor Gautier 产品经理，兵马俑

# javascript - 在学习 jQuery 之前学习 JavaScript 是个好主意吗？

> ID：668642
> 
> 赞同：73
> 
> 时间：2009-03-21T02:48:54.323
> 
> 标签：javascript, jquery

在学习 jQuery、Prototype 等 JavaScript 框架库之前学习 JavaScript 是不是一个好主意？

有时我发现自己在苦苦挣扎，因为我觉得我对 JavaScript 的了解并不如我应该了解的那样。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-21T02:52:06.873

一个强调的**“是”**。学习时间不会像您担心的那样长，而且回报将是值得的。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-21T02:51:33.193

> 有时我发现自己在苦苦挣扎，因为我觉得我对 Javascript 的了解并不如我应该的那样？

我想你回答了你自己的问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-21T04:00:48.283

我会反对说，虽然理想情况下你会在学习 jQuery**之前**精通 JavaScript ，但通过使用该库进行编码，你可能会在这两个方面取得很大进步。

jQuery 的优势之一是它可以更轻松地在浏览器中执行某些操作。您可以通过剪切、粘贴和改编其他人的代码来完成很多实际工作，那么为什么不开始这样做呢？当你去的时候，当你遇到一个你不太理解的成语时，四处挖掘并找出它的含义或它是如何工作的。

随着时间的推移，您将成为 JavaScript 和 jQuery 的大师。

如果你有任何编程背景，Douglas Crockford 的*JavaScript: The Good Parts 是一本可以帮助你快速掌握 JavaScript 的好书。*

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-21T02:51:26.330

只要你[在 Javascript 中学习 BASICS](http://www.learn-javascript-tutorial.com/)；HTML文档遍历、事件处理等……学习jquery应该没问题。

然后通过学习基础知识，您将了解**Jquery**如何帮助您完成 javascript 可以做的事情，**但工作量更少**。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-21T07:05:36.000

你的问题的答案是肯定的。jQuery、Prototype 和其他工具可以解决跨浏览器的难题并简化 AJAX、UI 行为、DOM 操作等。如果您只是复制/粘贴代码片段或对 Javascript 没有真正的了解，您最终会得到一些非常糟糕的代码。

作为一个试金石，您应该能够遵循这篇[精彩的 Javascript 重新介绍中](https://developer.mozilla.org/en/A_re-introduction_to_JavaScript)所说的一切。这是编写好代码的最低要求，您可能需要更多的谷歌搜索。只有这样，您才应该阅读 Willison[对 jQuery 的同样出色的介绍](http://simonwillison.net/2007/Aug/15/jquery/)。

这应该为您提供一个良好的开端。然后，如果您愿意，可以开始消化 Crockford（从[Douglas Crockford 开始 — JavaScript：The Good Parts](http://developer.yahoo.com/yui/theater/)）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-08-21T13:00:51.820

是的，这是一个好主意，因为 jQuery 为您提供了一些方法和效果的快捷方式。通过学习 JavaScript，您可以全面了解 jQuery 的工作原理。它将帮助您在将来处理项目时解决错误和问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-21T17:00:07.163

称我为老式，但我认为最好先学习一种工具的基础知识，然后再学习它的高级表亲——就像在使用圆锯之前熟练掌握手锯一样。

如果你在挣扎，你已经回答了你自己的问题。我觉得一旦你熟悉了 JavaScript，你就会更好地利用 JQuery。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-21T03:05:36.047

当我开始从 VBScript 切换到 JavaScript 时，我立即被 Jquery 迷住了。不久之后，我开始真正了解 JavaScript 和 Jquery 是如何相互作用的，我变得有点困惑和沮丧。我的问题是希望使用 Jquery 的简单性，但我觉得我没有先学习 JavaScript 是在欺骗自己。

原来我是同时学的。当我编写 JQuery 例程时，我发现需要学习 JavaScript 以了解为什么事情会以它们的方式工作，并帮助使某些 Jquery 例程正常工作。

我仍在学习 JavaScript 和 Jquery，但我不太关心成为 JavaScript 大师，因为我知道我的理解会随着需要而增长。对 JavaScript 有一些基本的了解肯定会有所帮助，但我想说你应该专注于学习如何完成特定任务，而不是在 JQuery 之前学习 JavaScript ......

我的价值 0.02 美元。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-21T03:05:50.087

在某种程度上，但不要像在 java 世界中那样沉迷于面向对象的编程（在 javascript 中它无论如何都是原型设计）。从长远来看，有助于更好地理解闭包/匿名函数以及如何使用特殊变量“this”（特别是关于点击等事件）以及“应用”等函数如何工作。我还要确保你真正理解 CSS 选择器，因为它们是 jQuery 和几乎所有其他 JS 框架的核心特性。

您还需要熟悉如何使用 firebug 的全部功能。

我还假设您对 DOM 的工作原理有基本的了解或知识。

这就是修补 Javascript 的开始。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-21T03:21:21.233

在我看来，jQuery 只不过是一个让你的生活更简单的框架。jQuery 本身是用 javascript 编写的。所以它有助于学习javascript。

请注意，您不必成为大师，但应该能够做出必要的更改/解决方法，当您仅使用 jQuery 所做的还不够时。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-21T17:24:13.720

jQuery（或任何其他框架）的价值主张不仅仅来自它对 javascript 所做的事情。它还建立在 DOM、HTML 和许多与语言无关的模式之上。而且您无需深入了解所有内容即可找到有用的框架。当然，如果你知道所有的部分，你会更好，但我们都需要从更少的东西开始。

我同时学习了 jQuery 和 javascript，这样对我来说效果很好。

我认为问题不在于先学习哪个，而更重要的是，您需要期望越来越熟悉所有部分以及它们如何协同工作。

对我来说，这与您在开始使用 WebForms 之前需要了解的问题有些（不完全）相同。当然，如果您已经熟悉 C#（以及相同的 DOM 和 html）会更好，但是使用 WebForms 作为您的教育工具是合法的。框架也可以这样说。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-21T18:55:44.153

假设您应该了解以下有关 Javascript 的知识：

1.  如何计算浏览器 IE6-IE8、FireFox、Opera、Safari 的绝对/相对定位 DIV 的 X 和 Y 元素偏移量（对于这种特殊情况，每个浏览器都有不同的模型）。

2.  什么是闭包以及如何创建它。

3.  如何在上面列出的浏览器中创建 onLoad 事件。

4.  有一个 HTML/Javascript 代码示例，其中您有纯 HTML 代码，例如

<a href="" rel="remove">删除</a>

以及使用“rel”属性在自动模式下为 A 标记添加特殊处理程序的 javascript 代码。

在你熟悉了这个之后，你可以使用 jQuery 库来隐藏这个的复杂性:)

问候， 帕维尔

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-05-24T09:02:51.917

我认为学习事件文档对象模型和 JavaScript 表单编程足以开始使用 jQuery。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-21T03:47:31.967

当然，这是不言而喻的。如果您不先学习 JavaScript，如何使用 jQuery？毕竟，jQuery 只不过是一个 JavaScript 库。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-08T18:42:12.187

是的。

你显然不需要学习*所有*关于 JS 的知识。但至少要学习基础知识，并尝试学习一些最佳实践。

对我来说，关于 Javascript 最棘手的部分是它在不同浏览器中的所有不同实现。但是您可以做一些事情来帮助自己避免其中一些问题。例如，通常首选使用 document.getElementById() 来访问 DOM 中的元素，因为它在所有现代浏览器中的工作方式基本相同。此外，几乎总是最好使用特征检测而不是浏览器检测。诸如此类的小事情在以后避免特定浏览器中出现问题方面大有帮助。

幸运的是，JQuery 在跨浏览器兼容性方面写得很好，但有时您可能不想直接使用它，您可能不得不依赖您的 JS 技能。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-08T18:57:36.317

浏览器中的 JavaScript 实际上有两个不同的方面。首先是 JavaScript 语言，其次是 HTML DOM，它允许您使用 JavaScript 语言操作页面。

也就是说，是的，你应该花时间学习 JavaScript 语言。我推荐[阅读 Douglas Crockford 的“JavaScript: The Good Parts”](https://rads.stackoverflow.com/amzn/click/com/0596517742)。

现在到第二部分，HTML DOM。如果您打算使用像 jQuery 这样的框架，您真的不需要过多地关注学习 HTML DOM 的来龙去脉。只需按照“jQuery 方式”做事，然后在此过程中尽可能多地获取 HTML DOM。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-21T17:59:41.077

足以调试您的代码。否则，您将永远无法弄清楚什么是行不通的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-23T14:18:34.217

学习 JS 将使编写 JQuery 的工作更轻松，但我不明白为什么你必须先学习它。你最终只需要学习它。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-05-24T09:15:24.030

我的第一个想法是学习新东西总是好的，而且 Javascript 正变得无处不在（现在也在[**服务器端**](http://nodejs.org)）。

似乎您还没有为您和 AFAIK 确定最佳答案，这个问题是在 3 月 21 日之前发布的……我看到有足够的时间来阅读至少[**这**](http://mdn.beonex.com/en/A_re-introduction_to_JavaScript)是一个非常有才华的人写的这篇文章。

如果您学习 javascript，您将永远不会问这样的问题：

> 这在我的代码片段竞赛中意味着什么关键字**？**

但是如果你总是很匆忙，没有时间改进你的代码，如果你永远不必构建 jQuery 插件，那就不用 Javascript。

# iphone - (iPhone) selectedRange 用于不可编辑的 UITextView （或其他点击处理方法？）

> ID：668652
> 
> 赞同：2
> 
> 时间：2009-03-21T02:53:40.207
> 
> 标签：iphone, cocoa, cocoa-touch, selection, uitextview

我正在使用一个`UITextView`来保存静态内容（中文，这意味着字符都是固定宽度的）。我想让用户点击文本中的一个字符并显示该字符的字典信息。我知道所有与缺少复制和粘贴相关的问题，但我希望有一种方法可以做到这一点，而无需等待 iPhone 3.0 固件。

起初，我考虑使用`UITextView`s`selectedIndex`属性。不幸的是，当'`UITextView`不可编辑时，`UITextView`' 中的以下代码总是返回整个文本块的长度：

```
NSRange touchPoint = self.selectedRange;
NSLog(@"Selection: %d", touchPoint.location); 
```

我想这是有道理的，因为不可编辑`UITextView`的没有办法选择插入点，但这对我没有任何帮助。:)

另一种方法是计算，使用中文文本是固定宽度的事实，点击到达的位置以及当时应该在该位置下的文本，但这会因标点符号而变得复杂，这可能导致行提前换行，带来前一行的字符。

是否有另一种方法可以知道我缺少的触摸事件下的文本是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T05:56:59.423

在询问之前拨打以下电话`selectedRange`：

```
[[textView webView] updateSelectionWithPoint:point]; 
```

注意：`-webView`和`-updateSelectionWithPoint:`都是私有 API。您还可以通过切换可编辑、成为第一响应者和发送假触摸事件来执行等效行为，但这需要更多的工作

# c++ - 如何在 C 中使用按位或其他有效代码实现逻辑含义？

> ID：668653
> 
> 赞同：11
> 
> 时间：2009-03-21T02:55:36.647
> 
> 标签：c++, c, performance, logic, algebra

我想实现一个尽可能高效的逻辑操作。我需要这个真值表：

```
p    q    p → q
T    T      T
T    F      F
F    T      T
F    F      T 
```

根据维基百科，这被称为“[逻辑含义](http://en.wikipedia.org/wiki/Logical_implication)”

我一直试图弄清楚如何在不使用条件的情况下使用 C 中的按位运算来实现这一点。也许有人对此有一些想法。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-21T02:59:33.110

```
!p || q 
```

很快。说真的，别担心。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-21T03:00:25.557

```
~p | q 
```

对于可视化：

```
perl -e'printf "%x\n", (~0x1100 | 0x1010) & 0x1111'
1011 
```

在紧凑的代码中，这应该比“！p || q”更快，因为后者有一个分支，这可能会由于分支预测错误而导致 CPU 停顿。位版本是确定性的，作为奖励，在 32 位整数中的工作量是布尔版本的 32 倍！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-21T03:52:28.367

仅供参考，使用 gcc-4.3.3：

```
int foo(int a, int b) { return !a || b; }
int bar(int a, int b) { return ~a | b; } 
```

给出（来自 objdump -d）：

```
0000000000000000 <foo>:
   0:   85 ff                   test   %edi,%edi
   2:   0f 94 c2                sete   %dl
   5:   85 f6                   test   %esi,%esi
   7:   0f 95 c0                setne  %al
   a:   09 d0                   or     %edx,%eax
   c:   83 e0 01                and    $0x1,%eax
   f:   c3                      retq   

0000000000000010 <bar>:
  10:   f7 d7                   not    %edi
  12:   09 fe                   or     %edi,%esi
  14:   89 f0                   mov    %esi,%eax
  16:   c3                      retq 
```

因此，没有分支，但指令数量增加了一倍。

更好的是`_Bool`（感谢@litb）：

```
_Bool baz(_Bool a, _Bool b) { return !a || b; } 
```

```
0000000000000020 <baz>:
  20:   40 84 ff                test   %dil,%dil
  23:   b8 01 00 00 00          mov    $0x1,%eax
  28:   0f 45 c6                cmovne %esi,%eax
  2b:   c3                      retq 
```

因此，使用`_Bool`代替`int`是一个好主意。

由于我今天更新，我已经确认 gcc 8.2.0 产生了类似但不完全相同的结果`_Bool:`

```
0000000000000020 <baz>:
  20:   83 f7 01                xor    $0x1,%edi
  23:   89 f8                   mov    %edi,%eax
  25:   09 f0                   or     %esi,%eax
  27:   c3                      retq 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-21T07:05:04.410

您可以阅读[从真值表派生布尔表达式](http://www.bbc.co.uk/dna/h2g2/A3868671)（另见[规范形式](http://en.wikipedia.org/wiki/Canonical_form_(Boolean_algebra))），了解如何将任何真值表表示为布尔基元或函数的组合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-16T11:51:27.130

C布尔值的另一种解决方案（有点脏，但有效）：

`((unsigned int)(p) <= (unsigned int)(q))`

它按照 C 标准工作，`0`表示 false，任何其他值 true（`1`由布尔运算符返回 true，`int`类型）。

“肮脏”是我使用布尔值（`p`和`q`）作为整数，这与一些强类型策略（例如 MISRA）相矛盾，嗯，这是一个优化问题。你可能总是`#define`把它当作一个宏来隐藏脏东西。

对于正确的布尔值`p`和`q`（具有任一`0`或`1`二进制表示形式），它可以工作。否则`T->T`可能无法生成`T`if`p`并且`q`具有任意非零值来表示真。

如果您只需要存储结果，从 Pentium II 开始，就有`cmovcc`（条件移动）指令（如 Derobert 的答案所示）。然而，对于布尔值，即使是 386 也有一个无分支选项，即`setcc`指令，它在结果字节位置（字节寄存器或内存）中产生`0`或产生。`1`您还可以在 Derobert 的回答中看到这一点，并且此解决方案还编译为涉及 a `setcc`( `setbe`: Set if below or equal) 的结果。

Derobert 和 Chris Dolan 的`~p | q`变体对于处理大量数据应该是最快的，因为它可以单独处理所有位的`p`含义`q`。

请注意，即使`!p || q`解决方案也无法编译为 x86 上的分支代码：它使用`setcc`指令。`p`如果或`q`可能包含表示真的任意非零值，那是最好的解决方案。如果您使用该`_Bool`类型，它将生成很少的指令。

在为 x86 编译时，我得到了以下数字：

```
__attribute__((fastcall)) int imp1(int a, int b)
{
 return ((unsigned int)(a) <= (unsigned int)(b));
}

__attribute__((fastcall)) int imp2(int a, int b)
{
 return (!a || b);
}

__attribute__((fastcall)) _Bool imp3(_Bool a, _Bool b)
{
 return (!a || b);
}

__attribute__((fastcall)) int imp4(int a, int b)
{
 return (~a | b);
} 
```

组装结果：

```
00000000 <imp1>:
   0:   31 c0                   xor    %eax,%eax
   2:   39 d1                   cmp    %edx,%ecx
   4:   0f 96 c0                setbe  %al
   7:   c3                      ret    

00000010 <imp2>:
  10:   85 d2                   test   %edx,%edx
  12:   0f 95 c0                setne  %al
  15:   85 c9                   test   %ecx,%ecx
  17:   0f 94 c2                sete   %dl
  1a:   09 d0                   or     %edx,%eax
  1c:   0f b6 c0                movzbl %al,%eax
  1f:   c3                      ret    

00000020 <imp3>:
  20:   89 c8                   mov    %ecx,%eax
  22:   83 f0 01                xor    $0x1,%eax
  25:   09 d0                   or     %edx,%eax
  27:   c3                      ret    

00000030 <imp4>:
  30:   89 d0                   mov    %edx,%eax
  32:   f7 d1                   not    %ecx
  34:   09 c8                   or     %ecx,%eax
  36:   c3                      ret 
```

使用该`_Bool`类型时，编译器清楚地利用它只有两个可能的值（`0`false 和`1`true），产生与`~a | b`解决方案非常相似的结果（唯一的区别是后者对所有位执行补码，而不仅仅是最低位）。

为 64 位编译给出了几乎相同的结果。

Anyway, it is clear, the method doesn't really matter from the point of avoiding producing conditionals.

# mysql - 在数据库中添加新行时，必须调用外部命令行程序

> ID：668666
> 
> 赞同：4
> 
> 时间：2009-03-21T03:12:36.543
> 
> 标签：mysql, database-design

当新行添加到数据库中的一个表时，MySQL 数据库是否可以调用外部 exe 文件？

我需要监控数据库中的变化，所以当发生相关的变化时，我需要在数据库之外做一些批处理作业。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-22T08:27:45.373

Chad Birch 有一个使用[MySQL 触发器和用户定义函数](http://dev.mysql.com/doc/refman/6.0/en/faqs-triggers.html#qandaitem-23-5-1-10)的好主意。[您可以在MySQL CREATE TRIGGER 语法](http://dev.mysql.com/doc/refman/6.0/en/create-trigger.html)参考中找到更多信息。

但是您确定在插入行时需要立即调用可执行文件吗？看起来该方法很容易失败，因为 MySQL 可能会同时生成多个可执行文件实例。如果您的可执行文件失败，那么将不会记录哪些行已处理，哪些行尚未处理。如果 MySQL 正在等待您的可执行文件完成，那么插入行可能会非常慢。此外，如果 Chad Birch 是正确的，那么将不得不重新编译 MySQL，所以听起来很困难。

我不会直接从 MySQL 调用可执行文件，而是使用触发器来简单地记录行被插入或更新的事实：将该信息记录在数据库中，或者使用现有表中的新列，或者使用名为 say 的全新表`database_changes`。然后制作一个外部程序，定期从数据库中读取信息，对其进行处理，并将其标记为已完成。

您的具体解决方案将取决于外部程序实际需要的参数。

如果您的外部程序需要知道插入了哪一行，那么您的解决方案可能是这样的：创建一个名为`database_changes`fields `date`、`table_name`和的新表`row_id`，并为所有其他表创建一个触发器，如下所示：

```
CREATE TRIGGER `my_trigger`
AFTER INSERT ON `table_name`
FOR EACH ROW BEGIN
  INSERT INTO `database_changes` (`date`, `table_name`, `row_id`)
  VALUES (NOW(), "table_name", NEW.id)
END; 
```

然后你的批处理脚本可以做这样的事情：

1.  选择 database_changes 表中的第一行。
2.  处理它。
3.  去掉它。
4.  重复 1-3 直到`database_changes`为空。

使用这种方法，您可以更好地控制数据处理的时间和方式，并且可以轻松检查数据是否实际得到处理（只需检查`database_changes`表是否为空）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T04:10:55.937

1.  你可以做复制所做的事情：挂在“二进制日志”上。将您的服务器设置为“主服务器”，而不是添加“从服务器”，运行`mysqlbinlog`. 您将获得修改数据库的每个命令的流。

    *   进入客户端和服务器“之间”：检查[MySQLProxy](http://forge.mysql.com/wiki/MySQL_Proxy)。您将其指向您的服务器，并将您的客户端指向代理。它允许您插入 Lua 脚本来监视、分析或转换任何 SQL 命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T03:23:54.380

我认为这将需要添加一个用户定义的函数，我认为这需要重新编译：

[MySQL 常见问题解答 - 触发器：触发器可以通过 UDF 调用外部应用程序吗？](http://dev.mysql.com/doc/refman/5.0/en/faqs-triggers.html#qandaitem-23-5-1-10)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T11:37:52.547

我认为对表进行一些外部进程轮询更改并执行外部程序确实是一个更好的主意-您还可以有一个包含此外部程序运行状态的列（例如“待定”、“失败”、“成功”) - 只需选择该列“待定”的行。

这取决于批处理作业需要多长时间运行。如果它需要“迟早”运行并且可能会失败并需要重试，那么肯定有一个应用程序轮询表并根据需要运行它们。

# asp.net - 用户通知 ASP.NET（希望能够从服务器和客户端触发）

> ID：668668
> 
> 赞同：0
> 
> 时间：2009-03-21T03:13:52.373
> 
> 标签：asp.net, javascript, jquery, user-interface

我在这里看到了几个[类似的问题](https://stackoverflow.com/questions/31465/stackoverflow-style-notifications-in-asp-net-ajax)，但我想做的有点不同。

我想有一种方法可以为用户提供一些关于他们可以从**客户端和服务器端**控制的操作的反馈。

我已经构建了一个带有标签的 UserControl（标签的文本属性已公开）和一些在 Page_Load 事件后不久隐藏标签的 JS。这适用于服务器端，但我无法使用 JS（来自父页面）设置标签的文本。

问题归结为以下两点：

1.  有没有办法用JS在子用户控件上设置公共属性？
2.  在 ASP.NET 中是否有更好的用户通知实现（客户端和服务器端）

### 编辑

最终将 bugus 类添加到标签中以在子用户控件中找到它，这不是最佳解决方案 - 但它现在有效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T04:48:25.597

看起来您动态设置子控件的 ID？如果是这样，你要么必须给它一个唯一的 CSS 类，你可以稍后根据我的示例代码找到它，或者你可以稍微遍历 dom 来找到它。像：

```
$("div div span.theControl").html("Hey there"); 
```

也许我不明白这个问题，但这不起作用吗？

```
$(".theControl").html('Look users, you did something cool'); 
```

根据您的评论，我认为解决您问题的关键不是您如何找到您的子控件，而是您可以为您的子控件提供什么样的值或类，以便您的 jQuery 可以找到它。

# c# - 在远程 Windows 服务中调用方法

> ID：668672
> 
> 赞同：0
> 
> 时间：2009-03-21T03:19:10.037
> 
> 标签：c#, windows-services

我正在为我们公司的软件开发一个新的许可系统。我们使用 DeployLX 进行许可，一般来说，它满足我们的需求。我们想要提供的选项之一是并发许可证，客户端可以在服务器上安装我们的软件，用户通过 RDP 连接使用我们的产品。如果他们购买了 10 个许可证，我们将允许运行我们软件的 10 个实例（在服务器上）

我们在 C# 中创建了一个并发监视器来控制许可证，如果我们只需要在一台服务器上运行我们的软件，它就可以正常工作。但是，我们的许多客户在服务器场配置中使用负载平衡，因此我们需要在一台服务器上安装配置监视器，并在所有其他服务器上安装我们的软件。这些服务器将需要连接到这台服务器以联系并发监视器并验证许可证（这是针对并发监视器持有的，而不是我们的软件）。

* * *

### 问题：

目前，并发监视器是安装在服务器（服务器 1）上的 Windows 服务。那么，我如何将联系人编码为来自我们在其他服务器（例如服务器 2 和 3）上的软件产品的并发监视器中的方法？

我尝试使用 .NET ServiceController，虽然我可以连接到 Windows 服务，但我不知道如何（或者即使我可以）调用我在服务中编写的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T03:48:24.053

我不确定您是否可以在服务中调用方法。但是，您可以通过其他方式实现上述目标。

一世。让每台服务器将其正在处理的连接数写入标准位置。并发监视器需要读取此值。

ii.将服务实现为远程客户端，以便并发监视器可以调用该函数。

iii. 对 Concurrent Monitor 进行服务调用以在连接数发生变化时更新它。

您可以选择此方法或替代方法，具体取决于容易适应的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T03:49:05.817

您最好通过 WCF 或 .net 远程处理来公开该方法（我更喜欢较早的）

# java - 在 java 中播放 wav 文件 - 如何扩展或连接播放的声音？

> ID：668677
> 
> 赞同：1
> 
> 时间：2009-03-21T03:25:49.663
> 
> 标签：java, audio, wav

是否可以创建一个包含 wav 文件“循环”的临时文件？

或者是否可以操纵发送到流读取器/写入器的流？

基本上我想播放一些 wav 文件一段时间，如果该时间大于 wav 文件提供的时间长度，我想循环播放。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T03:55:05.940

```
 AudioInputStream audioIn = AudioSystem.getAudioInputStream(url);
     Clip clip = AudioSystem.getClip();
     clip.loop((int)(Math.ceil(timeRequested / audioIn.getFrameLength()))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T20:18:19.197

我不确定我是否理解您实施解决方案的确切限制，但似乎最干净的方法是在您第一次播放文件时将音频数据存储在缓冲区中。然后，如果用户需要更多迭代（全部或部分），只需将缓存的数据重写回 SourceDataLine 所需的次数。

这是一个示例声音文件播放器 (PCM) 的[链接](http://www.javafaq.nu/java-example-code-483.html)，它的代码应该很容易修改（或只是从中学习）。我还修改了一些（注意：未经测试）代码，这些代码仅显示了我上面描述的逻辑：（您可能还想修改我在下面的内容以符合仅写入大小为倍数的数据块的规则帧大小。）

```
public void playSoundFile(SourceDataLine line, InputStream inputStream, AudioFormat format, long length, float times)
{
    int index = 0;
    int size = length * format.getFrameSize();
    int currentSize = 0;
    byte[] buffer = new byte[size];
    AudioInputStream audioInputStream = new AudioInputStream(inputStream, format, length);
    while (index < size)
    {
        currentSize = audioInputStream.read(buffer, index, size - index);
        line.write(buffer, index, currentSize);
        index += currentSize;
    }

    float currentTimes = 1.0;
    while (currentTimes < times)
    {
        float timesLeft = times - currentTimes;
        int writeBlockSize = line.available();
        index = 0;

        if (timesLeft >= 1.0)
        {
            while (index < size)
            {
                currentSize = ((size - index) < writeBlockSize) ? size - index : writeBlockSize;
                line.write(buffer, index, currentSize);
                index += currentSize;
            }
            currentTimes += 1.0;
        }
        else
        {
            int partialSize = (int)(timesLeft * ((float) size) + 0.5f);
            while (index < partialSize)
            {
                currentSize = ((partialSize - index) < writeBlockSize) ? partialSize - index : writeBlockSize;
                line.write(buffer, index, currentSize);
                index += currentSize;
            }
            currentTimes += timesLeft;
        }
    }
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:42:48.593

我想我会使用音频输入流中的每秒帧数和帧大小信息来解决这个问题。其他有用的信息在 SourceDataLine 对象的 getMicrosecondPosition() 方法中，以确定到目前为止播放的时间/持续时间。

这与音频输入流中的标记和重置方法一起可能会处理这一切。

# c# - 在 WinForms 应用程序中放置功能代码的位置

> ID：668680
> 
> 赞同：3
> 
> 时间：2009-03-21T03:28:43.913
> 
> 标签：c#, winforms

我是 C# 新手，我正在使用 VS08，我已经创建了一个表单，但是我应该在哪里放置我的功能代码？

现在我有 2 个文件：
program.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
} 
```

form1.cs - 包含我的表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T03:33:08.037

您的代码应该包含在构成您的域功能的类中。Program.cs 创建表单的一个实例（建议您将 from 重命名`form1`为更具描述性的名称），然后您的表单应该实例化它需要的类。

如果您正在使用数据绑定，请将一个或多个绑定源添加到您的表单，设置它们的数据源并在表单加载期间进行绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T03:36:21.150

我建议您在放置所有功能代码时创建一个新类。在 form1.cs 中使用此类的实例（适当重命名）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-09T16:46:22.903

如果您对[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)感兴趣，您希望将[属性注入或构造函数注入](https://stackoverflow.com/questions/1503584/dependency-injection-through-constructors-or-property-setters)表单中，而不是将其紧密耦合到您的功能类。

另请参阅[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)以了解一般注入

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T16:50:03.353

Winforms 的理想设计模式是 Model View Presenter。

[Martin Fowler http://martinfowler.com/eaaDev/ModelViewPresenter.html](http://martinfowler.com/eaaDev/ModelViewPresenter.html)将其分为两个变体

# benchmarking - 在进行基准测试时，是什么导致 CPU 时间和“经过的实时”之间存在延迟？

> ID：668682
> 
> 赞同：3
> 
> 时间：2009-03-21T03:31:09.447
> 
> 标签：benchmarking

我正在使用内置的基准测试模块进行一些快速而肮脏的测试。它给了我：

*   CPU时间
*   系统 CPU 时间（实际上，我运行的代码从来没有得到任何结果）
*   用户和系统 CPU 时间的总和（在我的情况下总是与 CPU 时间相同）
*   经过的实时时间

我什至不知道我需要所有这些信息。

我只想比较两段代码，看看哪一段需要更长的时间。我知道一段代码可能比另一段代码进行更多的垃圾收集，但我不确定它会产生多大的影响。

我应该查看哪个指标的任何想法？

**而且，最重要的是，有人可以解释为什么“经过的实时时间”总是比 CPU 时间长 - 是什么导致两者之间的滞后？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-21T03:38:03.673

除了运行 Ruby 代码之外，您的系统中还发生了很多事情。已用时间是所用的总实际时间，不应用于基准测试。您需要系统和用户 CPU 时间，因为这些时间是您的进程实际拥有 CPU 的时间。

例如，如果您的流程：

*   使用 CPU 运行代码一秒钟；然后
*   使用 CPU 运行 OS 内核代码一秒钟；然后
*   在另一个进程运行时被换出七秒钟；然后
*   使用 CPU 多一秒钟来运行你的代码，

你会看到：

*   十秒过去的时间，
*   两秒的用户时间，
*   一秒系统时间，
*   三秒的总 CPU 时间。

三秒是您需要担心的，因为这十秒完全取决于进程调度的变幻莫测。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-21T03:33:33.793

多任务操作系统，等待 I/O 时的停顿，以及其他代码不活跃的时刻。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-21T07:42:42.103

You don't want to totally discount clock-on-the-wall time. Time used to wait w/o another thread ready to utilize CPU cycles may make one piece of code less desirable than another. One set of code may take some more CPU time, but, employ multi-threading to dominate over the other code in the real world. Depends on requirements and specifics. My point is ... use all metrics available to you to make your decision.

Also, as a good practice, if you want to compare two pieces of code you should be running as few extraneous processes as possible.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T07:42:34.100

也可能是代码执行时的 CPU 时间不计算在内。

一个极端的例子是一个实时系统，其中计时器触发了一些总是比计时器滴答声更短的活动。然后可能永远不会计算该活动的 CPU 时间（取决于操作系统如何进行记帐）。

# html - 编写灵活的 HTML 运动括号

> ID：668694
> 
> 赞同：6
> 
> 时间：2009-03-21T03:40:49.877
> 
> 标签：html, css

我正在尝试使用 HTML 创建一个括号系统。但是，我发现了其他解决方案，大多数都需要大量绝对/相对定位或表格。

我正在寻找一种使其灵活的方法，因此我可以更改 HTML 以将其从 16 人支架更改为 64 人支架。

[404 - 链接已删除]

现在，我认为我当前的示例没有太大问题，但是，我只是好奇是否有人对改进或完全改变我的工作方式提出了一些建议。

我宁愿远离桌子，也绝对远离任何形式的定位（这是为了灵活）。

如果您有任何想法，那就太好了。:)

谢谢，

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T04:54:43.850

这实际上看起来相当不错。我要做的改进是将逻辑封装在一些 Javascript 中，以某种文本格式提供括号信息，并让 Javascript 解析文本格式以尽可能深入地生成括号。

# iphone - DidfinshLoad for imageData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:srcAddres]];？

> ID：668702
> 
> 赞同：1
> 
> 时间：2009-03-21T03:47:06.290
> 
> 标签：iphone

```
imageData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:srcAddres]]; 
```

将 jpeg 下载到我的图像数据会花费一些时间，例如：2 秒，所以我想显示一个活动指示器，直到下载完成。我怎么知道下载何时完成？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T04:31:34.997

使用这个版本的方法：

```
- (id)initWithContentsOfURL:(NSURL *)aURL options:(NSUInteger)mask error:(NSError **)errorPtr 
```

确保在调用之前通过声明一个 NSError 指针来传递：

```
NSError *error 
```

...然后将错误传递为：

```
&error 
```

如果错误不是零，那么你就有问题了。然后，您可以检查错误以提供适当的用户反馈。我不会在这里进入面具。 [您可以在文档中阅读有关此方法的所有信息](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html#//apple_ref/doc/uid/20000172-BCIBCEBC)。

# javascript - 如何移动窄输入元素中的可见文本以在末尾看到光标？

> ID：668720
> 
> 赞同：3
> 
> 时间：2009-03-21T04:03:41.833
> 
> 标签：javascript, html, firefox, w3c

我遇到的问题是，给定一个 maxlength 比元素宽度宽得多的输入元素（如在其样式中设置的那样），并且，给定一个比元素宽度宽的值，我怎样才能让元素“滚动”到文本的末尾。在 IE 中很容易，我创建了一个 textRange 对象，将它的开始和结束位置放在文本的末尾，在该范围上调用 select，然后 bam，光标放在文本的末尾并且文本被移动了显示结束。在 Firefox、Chrome、Safari 中，尝试使用输入元素的 setSelectionRange 将光标设置在正确的位置，但文本没有移动，所以我看到它的结尾，而是开始。有谁知道我可以将光标放在文本末尾并移动文本以便我可以看到光标的方法？

谢谢！

谢恩

* * *

```
<html>
  <head>
    <title>input cursor position</title>
    <script language='javascript'>
      function setCursor()
      {
         var objInput = document.getElementById( 'testinputbox' );
         var nLength = objInput.value.length;

         objInput.focus();
         objInput.setSelectionRange( nLength, nLength );
      }
    </script>
  </head>
  <body onload='setCursor();'>
    <input id='testinputbox' maxlength='200' value='some very very very very very long text' style='width: 100px;'></input>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-21T06:20:03.113

我怀疑这是一个很棒的跨浏览器解决方案，但它似乎可以在 Firefox 中解决。我最初通过模拟右箭头键按下来尝试它，但没有任何运气。

```
function setCursor(id)
{
    var elem = document.getElementById(id);

    elem.focus();
    elem.setSelectionRange(elem.value.length, elem.value.length);

    // Trigger a "space" keypress.
    var evt = document.createEvent("KeyboardEvent");
    evt.initKeyEvent("keypress", true, true, null, false, false, false, false, 0, 32);
    elem.dispatchEvent(evt);

    // Trigger a "backspace" keypress.
    evt = document.createEvent("KeyboardEvent");
    evt.initKeyEvent("keypress", true, true, null, false, false, false, false, 8, 0);
    elem.dispatchEvent(evt);
} 
```

有关 initKeyEvent 的更多信息，请[点击此处](https://developer.mozilla.org/en/DOM/event.initKeyEvent)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T13:34:09.030

这是一个kludge，但它的工作原理：

编辑：进一步kludged实际工作：

```
<html>
  <head>
    <title>input cursor position</title>
    <script language='javascript'>
function setatend() {
    var save = document.getElementById("mytextbox").value;
    mytextbox.focus(); 
    mytextbox.value = save; 
}
function setfocus() {
    var box = document.getElementById("mytextbox");
    box.focus();    
}
</script>
  </head>
      <body onload='setfocus();'>
    <input onfocus='setatend();' id='mytextbox' maxlength='200' value='some very very very very very long text' style='width: 100px;'></input>
  </body>
</html> 
```

# delphi - 通过 Prism & Com Interop 公开功能

> ID：668729
> 
> 赞同：1
> 
> 时间：2009-03-21T04:14:25.083
> 
> 标签：delphi, com, com-interop, oxygene

如何通过 COM Interop 公开一个用 Prism 编写的类？例如，给定以下接口：

```
TYPE
  IFoo = public interface
    property bar: string; read;
  end;

  FooImpl = class( IFoo )
  private
    function GetBar : string;
  public
    property bar: string; read GetBar;
  end; 
```

在此示例中，假设 IFoo 通过 TLBIMP 导入并链接到项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T15:04:44.317

使用 ComVisible 属性使程序集和/或类公开。使用 tlbexp.exe（.NET SDK 的一部分）时，您将获得作为 COM 接口的接口和作为 IFoo 的 CoClass 的类。或者，您可以使用 Guid 属性为您的接口和（co）类设置特定的 guid。

# objective-c - Emacs、Objective-C 和自动完成

> ID：668732
> 
> 赞同：16
> 
> 时间：2009-03-21T04:19:15.587
> 
> 标签：objective-c, emacs, autocomplete

我最近切换到 emacs 进行代码编辑，而且它大部分都运行良好。

但是，对于 Objective-C，我发现自己缺少 Xcode 的自动完成功能，因为我无法记住长函数名称，例如

```
- (id)initWithContentRect:(NSRect)contentRect styleMask:(NSUInteger)windowStyle backing:(NSBackingStoreType)bufferingType defer:(BOOL)deferCreation screen:(NSScreen *)screen; 
```

有没有办法在 emacs 上获得 Xcode 样式的自动完成功能？

另外，我应该有什么好的包来帮助 Cocoa 或 Objective-C？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-09-01T02:35:36.303

I wrote a script to export function definitions in Cocoa SDK as yasnippet snippets: [http://github.com/zegal/yasobjc](http://github.com/zegal/yasobjc)

With the help with ETAGS and auto-complete, the completion experience is very close to XCode. You can have a try.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-29T19:17:26.370

[在clang svn](http://clang.llvm.org/get_started.html#build)`clang-completion-mode.el`中找到了一个有点错误和 hacky，但非常好的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-21T05:36:04.467

我没有使用过 XCode，但是 emacs 带有几种自动完成模式。

看：

*   内置 dabbrev-expand（M-/ 运行命令 dabbrev-expand “自动完成”部分写入的文本）
*   [自动完成](http://www.emacswiki.org/emacs/AutoComplete)
*   [嬉皮展开](http://www.emacswiki.org/emacs/HippieExpand)

也[cedet](http://cedet.sourceforge.net/)用于更复杂的东西 - 但不幸的是我认为它不适用于objective-c。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-15T03:57:04.320

我还没有尝试过，但是 company-mode 有一个 xcode 后端，可能会很有帮助：

[http://nschum.de/src/emacs/company-mode/](http://nschum.de/src/emacs/company-mode/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-13T02:51:55.207

编辑文件`auto-complete.el`（当然，在您安装*“自动完成”*包的文件夹中查找它）：

转到第 165 行，我保证您已经知道该怎么做。:)

# oracle - 如何将数据从Excel复制到oracle？

> ID：668734
> 
> 赞同：2
> 
> 时间：2009-03-21T04:22:23.957
> 
> 标签：oracle, excel

如何将数据从Excel复制到oracle？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-21T05:39:50.323

```
有很多不同的方法，取决于
根据数据量，重复性
过程和编程量
我愿意投资。

首先，创建 Oracle 表，使用
SQL CREATE TABLE 语句定义表的
列的长度和类型。这是一个示例
sqlplus 'CREATE TABLE' 语句：

创建表 SPECIES_RATINGS
（物种VARCHAR2（10），
数数，
评级 VARARC2(1));

然后使用以下任何方法加载数据
方法或您发明的全新方法：

------------------------------------------

第一种加载方法：

我使用 SQL*Loader 方法。
您需要保存电子表格的副本
CSV 或 PRN 等文本格式。

CSV 文件的 SQL*Loader 控制文件：

加载数据
 infile 'c:\data\mydata.csv'
 进入表emp
 以“，”结尾的字段可选地用“”'括起来          
 (empno, empname, sal, deptno)

有一些 GUI 有向导引导您完成
流程（企业管理器 -> 维护 -> 数据移动 ->
移动行数据 -> 从用户文件加载数据）
临时进口。Toad for Oracle 有一个 SQL*Loader 向导作为
出色地。（DBA -> 数据导入/导出 -> SQL*Loader 向导）

如果您是，您可以将 Excel 数据保存为 PRN 格式
计划在您的
控制文件。

PRN 文件的 SQL*Loader 控制文件：

加载数据
 infile 'c:\data\mydata.prn'
 代替
 进入表部门
 ( 部门位置 (02:05) char(4),
    部门名称位置 (08:27) char(20) )

Position(02:05) 将给出第 2 到第 5 个字符

完成 EM 或 Toad 向导后，我会保存
控制文件，在文本编辑器中根据需要对其进行调整，
并在 SQL*Plus 脚本中重用它。

SQL*Loader 也很方便，因为它允许您
跳过某些数据并调用过滤功能（即
本机函数，如 DECODE() 或 TO_DATE() 或
用户定义的函数）在您的控制 .ctl 文件中。

您可以从提供的多个输入文件中加载
他们通过重复使用相同的记录格式
INFILE 子句。这是一个例子：

加载数据
  INFILE file1.prn
  INFILE file2.prn
  INFILE 文件 3.prn
  附加
  INTO TABLE emp
  ( empno POSITION(1:4) 外部整数，
    命名位置（6:15）字符，
    deptno POSITION(17:18) 字符，
    经理位置(20:23) 外部整数
  )

您还可以指定多个“INTO TABLE”子句
在 SQL*Loader 控制文件中加载到多个
表。

加载数据
 INFILE 'mydata.dat'
 代替
 INTO TABLE emp
      当 empno != ' '
 ( empno POSITION(1:4) 外部整数，
   命名位置（6:15）字符，
   deptno POSITION(17:18) 字符，
   经理位置(20:23) 外部整数
 )
 INTO表项目
      当项目！=''
 ( projno POSITION(25:27) 外部整数，
    empno POSITION(1:4) 外部整数
 )

使用 SQL*Loader，您可以选择性地仅加载
您需要的记录（参见 WHEN 子句），跳过
加载数据时的某些列（请参阅 FILLER
列）并加载多行记录（请参阅
连接和继续）

创建控制文件后，您需要
从命令行启动 sql loader，如下所示：
sqlldr 用户名/密码@connect_string control=ctl_file.ctl log=log.log

您可以创建一个批处理文件来调用 sqlldr。

有关更多示例，请参阅
http://examples.oreilly.com/orsqlloader/

多功能的 SQL*Loader 就是这样。

------------------------------------------

第二种加载方式：

在这种情况下，我可以完全控制
电子表格，但对数据的控制较少，因为
用户将带有数据的电子表格发回给我。

我在同一个 Excel 中创建另一个工作表
文件，该文件已锁定 INSERT 语句
参考数据表。什么时候
我收到电子表格，我复制并粘贴
将语句直接插入 SQL*Plus，或
间接地将它们暂存在 SQL 脚本中。

Excel是一个很好的动态组合工具
动态的 SQL 语句。（见 Excel 函数）

------------------------------------------

第三种加载方式：

如果您需要一个实用程序将 Excel 数据加载到
Oracle，从 sourceforge 下载快速加载
http://sourceforge.net/projects/quickload

------------------------------------------

第四种加载方式：

从理论上讲，这应该有效。

配置通用数据库连接（异构数据库 HS）
通过 ODBC 从 Oracle 连接到 Excel 电子表格。
描述它（参见 DESC 命令）或
从 ExcelTable 中选择 col1、col2 创建表
制作副本并查看 Oracle 分配的数据类型
默认情况下的列。

http://www.e-ammar.com/Oracle_TIPS/HS/configuring_generic_database_con.htm

------------------------------------------

参考：

http://209.85.173.132/search?q=cache:GJN388WiXTwJ:www.orafaq.com/wiki/SQL*Loader_FAQ+Oracle+control+file+columns&cd=3&hl=en&ct=clnk&gl=us

http://forums.oracle.com/forums/thread.jspa?threadID=305918&tstart=0

http://techrepublic.com.com/5208-6230-0.html?forumID=101&threadID=223797&messageID=2245485

http://examples.oreilly.com/orsqlloader/

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T06:49:08.427

一位 DBA 曾经向我展示了一个简单的技巧：

在另一张纸之类的地方，创建一个公式，例如：

```
INSERT INTO my_table (name, age, monkey) VALUES ('" & A1 & "', " & B1 & ", '" & C1 & "');" 
```

将其复制/粘贴到适当的行中（Excel 会自动将您的公式更改为 A2、A3 等）

然后将结果复制/粘贴到 sqlplus 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T04:36:19.307

我能想到的最简单的方法是将 Access 放在中间。附加到 Excel（或将数据导入 Access）；然后附加到目标 Oracle 表并复制。Access Export 工具也运行良好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T13:06:11.407

使用[外部表](http://www.orafaq.com/node/848)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-21T04:32:13.670

也许是[DBD::Oracle](http://search.cpan.org/dist/DBD-Oracle/)、[DBD::Excel](http://search.cpan.org/dist/DBD-Excel/)和[DBIx::Copy](http://search.cpan.org/perldoc?DBIx::Copy)的某种组合？但肯定有更简单的方法......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-21T04:51:49.393

如果它是一次性的或罕见的，并且您可以导出到 csv，那么 Application Express 或 SQL Loader 工具就可以正常工作。如果这是一个常规的事情，那么克里斯的建议就是我会去的。

# php - 打印后使用 PHP 格式化 DATETIME 列

> ID：668735
> 
> 赞同：0
> 
> 时间：2009-03-21T04:22:40.837
> 
> 标签：php, mysql

嘿，我正在为我的数据库列使用 DATETIME。我正在尝试找到使用 PHP 格式化该行中保存的日期的最佳方法。我尝试使用 date() 但这只会打印当前日期。我的行看起来像：

```
$row['date_added'] 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T04:28:31.040

几个选项。

1.  使用 MySQL 的[DATE_FORMAT](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)函数对其进行格式化。
2.  使用 MySQL 的[UNIX_TIMESTAMP](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_unix-timestamp)函数获取时间戳 PHP 的[date](http://php.net/date) () 函数可以玩。
3.  [通过 PHP 的strtotime](http://php.net/strtotime) () 函数运行 MySQL DATETIME得到一个时间戳 PHP 的 date() 函数可以玩。

作为＃3的示例：

```
print date('<format string>', strtotime($row['date_added'])); 
```

只需按照 date() 上的文档构建您喜欢的格式字符串并将其换入即可。

# msbuild - 有人在使用 MsBuild 进行安装吗？

> ID：668736
> 
> 赞同：5
> 
> 时间：2009-03-21T04:23:59.430
> 
> 标签：msbuild, installation, cruisecontrol.net

我注意到诸如[Msbuild Extension Pack](http://www.codeplex.com/MSBuildExtensionPack "Msbuild 扩展包")和[MsBuild Community Tasks](http://msbuildtasks.tigris.org/ "MsBuild 社区任务")之类的项目使 msbuild 能够安装程序集、sql 和设置 IIS。这些功能似乎是面向安装而不是构建。

所以我想知道有多少人在使用 msbuild，也许与 Cruise Control.Net 一起在登台环境中进行安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T08:29:52.303

我使用 MsBuild 进行构建，构建过程的一部分运行 Wix 以创建用于部署到生产的安装程序（MSI）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-14T23:37:23.030

我用 msbuild 为不同的目标环境编写了一些模板配置示例：http: [//blog.privosoft.com/2010/10/msbuild-environment-sandboxing.html](http://blog.privosoft.com/2010/10/msbuild-environment-sandboxing.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T20:40:21.533

我们使用 CC.NET 和 MSBuild 进行构建，然后发布到我们的开发和舞台环境，但是我们没有在 CruiseControl.NET 上实时推送，我们手动运行 MSBuild。我们只是认为用一个按钮来实时发布是一种诱人的方式；）可能需要 2 或 3 次修改才能正确设置我们的 MSBuild。但是现在一切都在一个文件中，一切都基于 Targets 和 Properties 来完成所有工作。大约 6 个月前，应该是最后一次更新，那是一次多服务器推送，因此我们已准备好扩大规模。我们现在可以将任何部件组合推送到任何服务器组合。因此，如果我们想要 5 个数据库服务器、3 个内容服务器和 2 个 Web 服务器，我们就有这种能力。无需使用其他任何东西。MSBuild 可以做到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-03T12:27:17.373

我创建了一个部署系统，其中中央协调员可以：

```
- identify the right target server for a given component (e.g Windows service goes to a given server, web services go to another, etc.)
- perform a PsExec of a deployment MSBuild script on the target server
- the deployment MSBuild script is responsible for:
    a) downloading the right component package (in my case a .zip)
    b) backing up previous versions of the component
    c) extracting the package to the right place
    d) tailoring the installation steps to the type of component to deploy (e.g. needs to perform an Exec task of installutil.exe on a Windows service )
    e) logging the result of the deployment 
```

该系统是使用以下组合构建的：

```
- core MSBuild tasks
- [Tigris MSBuild community tasks][1]
- [MS SDC tasks][2]
- and custom tasks 
```

该系统允许我们跨由虚拟服务器组成的分区环境（例如 DEV、QA、UAT 等）执行复杂应用程序的一致部署。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-13T15:13:53.270

我使用 MSBuild 构建一个相当大的客户端/服务器应用程序。我使用 InstallShield 2008 创建单独的客户端和服务器安装集。

通过将自定义目标添加到构建过程中，您可以将安装程序的创建合并到构建中。

我建议您在尝试将两者集成之前分别创建和测试构建和安装程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-13T01:17:20.600

我知道这是一个老问题......但是......

我目前正在使用 MSBuild 和 MSBuild 扩展包 (http://msbuildextensionpack.codeplex.com) 来完成我的整个部署。数据库部分由 VS 数据库命令行工具（vsdbcmd.exe - [http://msdn.microsoft.com/en-us/library/dd193283.aspx](http://msdn.microsoft.com/en-us/library/dd193283.aspx)）处理。这个扩展包非常棒，让我可以构建网站、应用程序池、Windows 服务、更新配置等等。

我还在测试服务器上放置了 Team City 代理，因此我可以将其部署为构建链的一部分（在 Team City 版本 7 中引入）。从 Team City 运行我的部署 MSBuild 脚本非常简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-13T14:29:09.240

我以前用的是 MSBuild，现在我用的是 PowerShell。MSBuild 是一种构建语言。编写脚本很痛苦。我想做的很多事情很困难，有时甚至是不可能的。

在过去的一年中，我创建了一个类似于 MSBuild 扩展包的 PowerShell 模块，名为[Carbon](http://get-carbon.org)。

我强烈、强烈鼓励大家学习和使用 PowerShell。

# macos - 将 Mac 的用户设置移至其他用户

> ID：668740
> 
> 赞同：0
> 
> 时间：2009-03-21T04:28:46.547
> 
> 标签：macos, user-controls

我的 Mac 新增了三个管理员用户：Math、CS 和 Fun。

我想将我的用户设置（例如用户 Masi 中的键盘布局和其他配置文件）移动到其他用户。

我主要使用终端软件。

**如何在 Mac Leopard 中将用户设置从一个用户移动到其他用户？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T05:11:37.490

大多数程序将首选项存储在 ~/Library 的子文件夹中。只需复制相应的文件夹，但要小心，你可能会破坏一些东西。

# .net - ADO.NET MVC 教程（使用 LINQ to SQL）关于架构更改的问题

> ID：668741
> 
> 赞同：0
> 
> 时间：2009-03-21T04:28:57.063
> 
> 标签：.net, linq-to-sql, model-view-controller, ado.net, schema

因此，我正在阅读新的 scottgu wrox 书籍，并创建了几个表格。然后（根据教程）我使用 linq to sql 来构建我的模型、DataCONtext、存储库等。（很明显，LINQ to SQL 似乎是从模式生成模型和类似类的“微软方式”。）

然后我发现我忽略了在其中一个表中包含其中一列，所以我调出表设计器并添加它。

从 LINQ 到 SQL 的产品似乎都没有注意到，而且我找不到任何明显的方法（右键单击、属性等）来使事情重新对齐 - F5 只是告诉我我缺少一个属性（课程）。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T04:32:17.537

我相信您必须从 linqtosql 设计器中删除该表并重新添加它。

# javascript - 用于匹配 HTML 片段中的数字和单位的正则表达式？

> ID：668750
> 
> 赞同：0
> 
> 时间：2009-03-21T04:38:34.090
> 
> 标签：javascript, html, regex, parsing

我正在尝试制作一个匹配数字的正则表达式，不包括某些 html 标签内的其他单词或数字的一部分的数字。匹配数字的部分效果很好，但我不知道如何在 html 中找到数字。

当前代码：

```
//number regexp part
var prefix = '\\b()';//for future use
var baseNumber = '((\\+|-)?([\\d,]+)(?:(\\.)(\\d+))?)';
var SIBaseUnit = 'm|kg|s|A|K|mol|cd';
var SIPrefix = 'Y|Z|E|P|T|G|M|k|h|ia|d|c|m|µ|n|p|f|a|z|y';
var SIUnit = '(?:('+SIPrefix+')?('+SIBaseUnit+'))';
var generalSuffix = '(PM|AM|pm|am|in|ft)';
var suffix = '('+SIUnit+'|'+generalSuffix+')?\\b';
var number = '(' + prefix + baseNumber + suffix + ')';

//trying to make it match only when not within tags or inside excluded tags
var htmlBlackList = 'script|style|head'
var htmlStartTag = '<[^(' + htmlBlackList + ')]\\b[^>]*?>';
var reDecimal = new RegExp(htmlStartTag + '[^<]*?' + number + '[^>]*?<'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T05:38:20.327

```
<script>
   var htmlFragment = "<script>alert('hi')</script>";
   var style = "<style>.foo { font-size: 14pt }</style>";
   // ...
</script>
<!-- turn off this style for now
  <style> ... </style>
 --> 
```

祝你好运得到一个正则表达式来解决这个问题。

您正在使用 JavaScript，所以我猜您可能正在浏览器中运行。这意味着您可以访问 DOM，从而可以访问浏览器功能强大的 HTML 解析器。*用它。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T05:17:01.017

[^] 正则表达式修饰符仅适用于单个字符，不适用于 (script|style|head) 等复合表达式。你要的是什么？！：

```
var htmlStartTag = '<(?!(' + htmlBlackList + ')\\b)[^>]*?>'; 
```

`(?! ... )`表示“后面没有...”，但`[^ ... ]`表示“不在...中的单个字符”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T14:57:35.287

> 我正在尝试制作一个匹配数字的正则表达式，不包括某些 html 标签内的其他单词或数字的一部分的数字。

正则表达式无法解析 HTML。不要使用正则表达式来解析 HTML。不要通过围棋。不要收取 200 英镑。

要“仅匹配不在其他内容内的内容”，您需要一个否定的后向断言（“（？<！”），但 JavaScript 正则表达式不支持后向，并且大多数其他正则表达式实现不支持复杂的可变长度后向你需要有任何匹配上下文的希望，比如在标签内。即使你确实有可变长度的lookbehind，这仍然不能可靠地解析HTML，因为如前所述，每天都会多次提到，正则表达式无法解析HTML .

使用 HTML 解析器。浏览器 HTML 解析器将能够消化部分输入而不会抱怨。

# java - 使用下一步按钮显示一系列图像

> ID：668754
> 
> 赞同：0
> 
> 时间：2009-03-21T04:47:44.303
> 
> 标签：java

每次用户单击下一步按钮时，如何一张一张地显示一系列图像？我几乎没有存储在数组中的图像。我使用旁边的按钮从图像转到图像。如何对按钮进行编程？我使用了动作监听器，但我只是不知道如何返回数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T07:11:15.720

我知道我在这里很懒，没有编写整个代码，但无论如何都可以。

```
class whatEver implements ActionListener{
    JButton btnNext = new JButton();
    static int fileNumber = 0;
    static int totalFiles;

   void functionLoadInterface ()  //Function with
    {
        btnNext.addActionListener(this); 
        //Initialize array ImageArray with file paths.
    }

   public void cycleImage()
    { 
         String file = ImageArray[fileNumber%totalFiles];
         //Code to load the image wherever follows
    } 

   public void actionPerformed(ActionEvent e) 
    {
         filenumber++;
         this.cycleImage();
    } 
```

# asp.net - ASP .NET MVC 默认路由问题 RTW 1.0

> ID：668759
> 
> 赞同：0
> 
> 时间：2009-03-21T04:55:54.657
> 
> 标签：asp.net, asp.net-mvc, routing, asp.net-mvc-routing

我刚刚安装了 MVC 框架的 RTW 1.0。我过去使用 RC2 来完成教程。我现在遇到了一个问题，即基本路由不起作用，而我在 RC2 中没有。

如果我在 VS 2008 中创建一个新的 MVC 应用程序，则主页的路由不能开箱即用。

由于某种原因，以下 URL 的工作

```
http://mydomain/
http://mydomain/Home/Index/1 
```

但是以下不起作用并给出 404 错误。

```
http://mydomain/Home
http://mydomain/Home/Index 
```

我的 RegisterRoutes 方法是默认的，看起来像这样

```
public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            );

        } 
```

我的 HomeController.cs 看起来像这样

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace MyNamespace.Controllers
{
    [HandleError]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewData["Message"] = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            return View();
        }
    }
} 
```

并且索引视图只是生成的默认值

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>

<asp:Content ID="indexTitle" ContentPlaceHolderID="TitleContent" runat="server">
    Home Page
</asp:Content>

<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">
    <h2><%= Html.Encode(ViewData["Message"]) %></h2>
    <p>
        To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
    </p>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T10:01:41.770

我已经设法找出问题所在。我在一个旧网站项目的 IIS 7 中托管它。一定有一些时髦的设置（虽然它被设置为集成模式）。所以我所做的只是创建一个新的网站和应用程序池，它首先运行:) 虽然花了我几个小时！！！

# c# - 后增量运算符重载

> ID：668763
> 
> 赞同：17
> 
> 时间：2009-03-21T05:00:18.687
> 
> 标签：c#, operator-overloading

我在尝试重载 C# 中的后增量运算符时遇到问题。使用整数，我们得到以下结果。

```
int n;

n = 10;
Console.WriteLine(n); // 10
Console.WriteLine(n++); // 10
Console.WriteLine(n); // 11

n = 10;
Console.WriteLine(n); // 10
Console.WriteLine(++n); // 11
Console.WriteLine(n); // 11 
```

但是，当我使用类尝试它时，看起来对象被交换了。

```
class Account
{
    public int Balance { get; set; }
    public string Name { get; set; }

    public Account(string name, int balance)
    {
        Balance = balance;
        Name = name;
    }

    public override string ToString()
    {
        return Name + " " + Balance.ToString();
    }

    public static Account operator ++(Account a)
    {
        Account b = new Account("operator ++", a.Balance);
        a.Balance += 1;
        return b;
    }

    public static void Main()
    {
        Account a = new Account("original", 10);

        Console.WriteLine(a); // "original 10"

        Account b = a++;

        Console.WriteLine(b); // "original 11", expected "operator ++ 10"
        Console.WriteLine(a); // "operator ++ 10", expected "original 11"
    }
} 
```

调试应用程序时，重载的运算符方法返回具有旧值 (10) 的新对象，而通过引用传递的对象具有新值 (11)，但最终交换了对象。为什么会这样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-21T05:10:58.537

我的第一个想法是指出 ++ 的正常语义是*就地修改*。如果你想模仿你会写：

```
public static Account operator ++(Account a)
{
    a.Balance += 1;
    return a;
} 
```

而不是创建一个新对象。

但后来我意识到你是在试图模仿帖子增量。

所以我的第二个想法是“不要那样做”——语义根本不能很好地映射到对象上，因为“使用”的值实际上是一个可变的存储位置。但是没有人喜欢被一个随机的陌生人告诉“不要这样做”，所以我会让[微软告诉你不要这样做](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=243943)。我担心他们在这些问题上的承诺是最终的。

PS 至于*为什么*要这样做，您实际上是在覆盖 preincrement 运算符，然后像使用 postincrement 运算符*一样*使用它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-21T05:30:29.473

关键是要理解这条线是如何`Account b = a++;`工作的。鉴于您的代码是如何编写的，这一行相当于：

```
Account b = a;
a++; 
```

这就是它将执行的顺序。有效的分配（1）发生在增量之前。所以，这一行的第一个效果是*a*和*b*都引用了原始对象*a*。

现在将评估 ++ 部分。在 operator 方法内部，我们增加`Balance`了原始对象的 。此时*a*和*b*都指向原来的，a`Balance`为11，*b*会继续这样做。

但是，您已经在 operator 方法中创建了一个新对象，并将其作为 operator 的输出返回。*a*现在将更新为指向新创建的对象。

因此，*a*现在指向一个新对象，而*b*继续指向原来的对象。这就是 WriteLine 输出出现交换的原因。

正如@MarkusQ 指出的那样， ++ 运算符旨在进行就地修改。通过生成一个新对象，你打破了这个假设。对象上的运算符重载是一个棘手的问题，这是一个很好的例子，说明为什么在大多数情况下最好避免它。

* * *

1 -*为了准确起见，在处理对象上的运算符时，赋值实际上并没有发生在增量之前，但在这种情况下最终结果是相同的。其实就是复制原始对象引用，对原始对象进行操作，然后将复制的引用赋值给左边的变量。如果您假装首先发生分配，则更容易解释。*

真正发生的是：

```
Account b = a++; 
```

由于 ++ 运算符对对象的工作方式，导致了这一点：

```
Account copy = a;

Account x = new Account("operator ++", a.Balance);
a.Balance += 1; // original object's Balance is incremented
a = x; // a now points to the new object, copy still points to the original

Account b = copy; // b and copy now point at the same, original, object 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T05:18:08.240

您应该始终返回更改后的值。C# 将此用作新值，并根据运算符返回旧值或新值。

# php - imagecreatefromjpeg 正在静默终止脚本

> ID：668770
> 
> 赞同：6
> 
> 时间：2009-03-21T05:10:30.970
> 
> 标签：php, gd, thumbnails

像我之前的许多人一样，我正在编写一个 PHP 脚本来做一些图像缩略图。该脚本已获得 WOMM（在我的机器上工作）认证，但是当我将其移动到我的主机（1&1 Basic）时，出现了一个问题：无法处理超过特定文件大小的图像。我已将所有操作移至文件系统，以确保这不是一些潜在`POST`问题。以下是相关代码：

```
 function cropAndResizeImage( $imageLocation )
{
  //
  // Just to be certain
  //
  ini_set('display_errors','on');
  error_reporting(E_ALL);
  ini_set('memory_limit','128M'); 
  ini_set('max_execution_time','300');  

  $image_info   = getimagesize($imageLocation);
  $image_width  = $image_info[0];
  $image_height = $image_info[1];
  $image_type   = $image_info[2];

  switch ( $image_type )
  {
    // snip...
    case IMAGETYPE_JPEG:
      $image = imagecreatefromjpeg($imageLocation);
      break;

    default:
      break;
  }

  // snip...
} 
```

使用我神秘的`println`调试能力，我已经能够确定它`imagecreatefromjpeg`没有返回；事实上，脚本到达它时会完全停止。一些事实：

*   这与文件大小相关。低于 1MB 的图像看起来还不错（经过抽查），但 3MB 左右的图像就不行了。不过，不知道精确的截止值是多少。
*   这不是由于服务器超时；`wget`在 3MB 图像上以 <1 秒的速度返回，在“适当小的”图像上显着延长（表示不处理大图像）。
*   为函数调用添加前缀`@`以抑制错误无效。这与脚本没有抛出错误的事实非常吻合，它只是默默地终止了这个函数调用。

如果我不得不猜测，可能有一些我不知道（或无法访问）的 GD 参数限制 1&1 的服务器上的输入文件大小 - 配置变量猜测是由于它立即 barfs 的事实，并且没有'不会出现（启发式地）对图像进行任何实际加载或计算。

有什么建议么？谢谢您的帮助。

**更新（[@Darryl 的](https://stackoverflow.com/users/5441/darryl-hein)评论提供）：**调用`phpinfo`表明 PHP 正在正确更新`max_execution_time`and`memory_limit`变量。这并不一定意味着这些资源正在被分配，只是它们似乎按预期运行。

**更新 2：**根据 Google 的一些参考资料，我尝试优化 JPEG（质量从 3MB 降低到 200KB），但没有成功，所以这不是图像文件大小问题。然后我尝试减少原始 3888x2592 图像的像素数，第一个成功的尺寸是 1400x2592（1401x 和 1402x 都导致半解析和错误指示“格式错误的 JPEG”，除非整个图像没有多大意义没有被加载）。通过进一步减小到 1300x2592，我可以实例化我实际正在寻找的 400x300 缩略图；在 1400x2592，`imagecreatetruecolor`我用来处理该任务的调用以与`imagecreatefromjpeg`.

至于为什么会这样，我有点不确定。1400 * 2592 == 3.5MB 没有什么特别的意义，但我不得不想象这是 GD + PHP 将处理的像素数的限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T05:41:05.407

请在 php 网站上查看有关内存使用情况的说明[。](http://pt.php.net/manual/en/function.imagecreatefromjpeg.php#76968)

*“使用 imagecreatefromjpeg() 加载图像所需的内存是图像尺寸和图像位深度的函数，乘以开销。

可以从这个公式计算：

字节数 = 宽度 * 高度 * 每个像素的字节数 * 开销软糖因子"*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T05:16:47.523

我猜 1&1 不允许您更改脚本`memory_limit`或`max_execution_time`，因此它可能内存不足。你试过跑步`phpinfo()`看看有什么限制吗？

# asp.net - 使用 Asp.Net 进行 CSS/JS GZip 压缩

> ID：668774
> 
> 赞同：12
> 
> 时间：2009-03-21T05:11:52.997
> 
> 标签：asp.net, javascript, iis, compression, gzip

我目前在托管的虚拟服务器上，我想为我的 Asp.Net 3.5 站点启用 GZip 压缩，我该如何开始？

我曾尝试使用“打包”的 JS 文件，但它们不起作用，我假设这是因为它们没有被正确处理......？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-21T05:27:56.920

**GZIP 应该由 IIS 处理**，你运行的是什么版本的 IIS？

客户端负责向服务器请求 GZiped 版本。服务器会找两个东西，请求是http 1.1，一个是Accept-Encoding: gzip的header。查找这些标头的一种简单方法是使用[firebug](http://getfirebug.com/)

**IIS6** - 可以使用 iis 管理单元启用 GZip。[Microsoft 的 MSDN 主题关于 Gzip 和 IIS6](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/25d2170b-09c0-45fd-8da4-898cf9a7d568.mspx?mfr=true)

**IIS7** - GZip 可以通过 web.config 使用 httpCompression xml 标签启用[Nick Berardi 的 Getting IIS 7 to Compress JavaScript](http://www.coderjournal.com/2008/04/iis-7-compress-javascript-gzip/)

通过压缩和打包 javascript 文件，您可以通过删除空格和缩短变量名称来减小 JavaScript 的总大小。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-21T05:57:56.660

我首选的方法是使用像[YUI Compressor](http://developer.yahoo.com/yui/compressor/)这样的压缩工具并将其作为构建过程的一部分（缩小后，压缩比不会那么高。或者你可以同时使用两者。重点是你应该'错过了下面给出的更大的性能问题）。

IIS 压缩的主要问题之一是它不会将所有 JS/CSS 文件打包到一个文件中。因此，如果您的网站有 7 个 JS 文件和 20 个 CSS（令人惊讶的是，这很常见），则需要 27 个 HTTP 往返来获取您的数据。编写一个 HTTP 处理程序来执行此操作对于共享主机的人来说是一个好主意。

一个简单的构建算法是在 JS/CSS 根目录中有一个*make文件*

```
If(build.config == release) {
Add your js file in order to the make files.
    e.g. jQuery.js jQuery.form.js  jQuery.container.js custom.js 
Split and pass it as params to YUI
Compress
O/P to site.js 
Delete all the above files.
} 
```

在发布模式下，您的页面管理员应该只引用 site.js

**编辑**：这是一个让 YUI 和 nant 集成的[链接。](http://codeclimber.net.nz/archive/2007/08/22/How-to-use-YUI-JS-Compressor-inside-a-NAnt-build.aspx)
**编辑**：Justin Etheredge 发布了一个很棒的工具来组合和压缩名为[SquishIt](http://www.codethinked.com/post/2010/05/26/SquishIt-The-Friendly-ASPNET-JavaScript-and-CSS-Squisher.aspx)的 css/js 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T05:50:51.797

我认为 IIS 是配置它的地方。如果您不能直接更改 IIS，您可以将处理程序添加到检查 Accept-Encoding: gzip 或 deflate 设置的所有请求。然后你使用[SharpZipLib](http://wiki.sharpdevelop.net/Default.aspx?Page=SharpZipLib_MainPage&AspxAutoDetectCookieSupport=1)之类的东西进行正确的压缩。然而，这很快就会变得笨拙。

您会发现手动 gzip 压缩静态文件（如 css 或 js）的成功有限。假设您在 html 中包含`styles.css.gz`和`scripts.js.gz`，并且您将 gz 扩展名映射到 gzip 压缩文本的 mimetype（是`application/x-gzip`吗？）很多浏览器（即 firefox、safari，也许是 chrome）都可以很好地处理它。但是有些浏览器不会，而且您将它们排除在外（链接，也许是旧歌剧）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-16T15:13:21.567

我一直在使用一个方便的小型服务器控件来进行 CSS 缩小，称为 StyleManager。它在引擎盖下使用 YUI Compressor。

添加到您的站点比手动添加 YUI C 更容易，而且它的用法很像 asp.net 的 ScriptManager，所以很快就习惯了。

最重要的是——它也结合了你的 CSS 文件。因此，与其下载 10 个 CSS 文件，不如将其下载为 1 个，这些文件也将被压缩等。

看看 - [gStyleManager.com](http://www.gstylemanager.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-18T09:24:33.907

我会考虑使用“deflate”，因为它比 GZip 更有效。我已经为两者添加了代码。

要将其添加到您的站点，请创建一个文本文件并将未提供的代码复制粘贴到该文件中，然后将其另存为 Global.asax。现在，将此文件添加到站点的根目录。

```
<%@ Application Language="C#" %>
<%@ Import Namespace="System.IO" %>
<%@ Import Namespace="System.IO.Compression" %>
<script runat="server">
void Application_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        HttpApplication app = sender as HttpApplication;
        string acceptEncoding = app.Request.Headers["Accept-Encoding"];
        Stream prevUncompressedStream = app.Response.Filter;

        if (!(app.Context.CurrentHandler is Page ||
            app.Context.CurrentHandler.GetType().Name == "SyncSessionlessHandler") ||
            app.Request["HTTP_X_MICROSOFTAJAX"] != null)
            return;

        if (acceptEncoding == null || acceptEncoding.Length == 0)
            return;

        acceptEncoding = acceptEncoding.ToLower();

    if (acceptEncoding.Contains("deflate") || acceptEncoding == "*")
        {
        // defalte
            app.Response.Filter = new DeflateStream(prevUncompressedStream,
                CompressionMode.Compress);
            app.Response.AppendHeader("Content-Encoding", "deflate");
        }
        else if (acceptEncoding.Contains("gzip"))
        {
            // gzip
            app.Response.Filter = new GZipStream(prevUncompressedStream,
                CompressionMode.Compress);
            app.Response.AppendHeader("Content-Encoding", "gzip");
        }
    }
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-01T13:41:00.160

您还可以使用代码对脚本进行 GZip。它的工作方式是使用 ASP.NET 页面来传递压缩文件以及正确的标题（告诉浏览器该流已压缩）。我写了一篇文章如何利用 GZip 压缩以及缩小（使用 YUI）和捆绑脚本（减少到服务器的往返次数），您可以在[http://www.codeproject.com/KB/custom找到它-controls/smartinclude.aspx](http://www.codeproject.com/KB/custom-controls/smartinclude.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-03T05:26:08.203

上一篇文章适用于 aspx 页面，但不适用于 css 和 js 文件。在压缩中包含`css`和文件的技巧是：`js`

1.  `.css`将您的和`.js`文件的文件扩展名更改为`.css.aspx`和`.js.aspx`
2.  在和文件中插入`<%@ Page ContentType="text/css" %>`和`<%@ Page ContentType="text/javascript" %>``.css.aspx``.js.aspx`
3.  在页面中包含`.css.aspx`and`.js.aspx`文件而不是`.css`and文件`.js`

# drupal-6 - 在 drupal 中创建指向特定节点类型的菜单链接

> ID：668777
> 
> 赞同：1
> 
> 时间：2009-03-21T05:14:03.193
> 
> 标签：drupal-6

所以，我创建了一个内容类型“车辆”。基本上我创建了一个提交表单，允许用户提交车辆信息。所以，我想创建一个名为“车辆”的菜单链接，它会将我带到列出所有“车辆”帖子的页面。有没有办法做到这一点？

我知道这是[view module](http://drupal.org/project/views)的工作。[但是当我在这个站点上](http://drupal.org/node/244281)运行指令时，它似乎与我下载的[drupal 6](http://drupal.org/drupal-6.0)和[视图模块不太匹配。](http://drupal.org/project/views)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-30T09:43:50.447

使用节点视图模块，您可以查看所有帖子

# benchmarking - 在进行基准测试时，什么会使经过的 CPU 时间少于用户 CPU 时间

> ID：668779
> 
> 赞同：1
> 
> 时间：2009-03-21T05:15:35.657
> 
> 标签：benchmarking

跟进我之前提出的一个[问题](https://stackoverflow.com/questions/668682/when-benchmarking-what-causes-a-lag-between-cpu-time-and-elapsed-real-time)：

我最终得到了一个用户 CPU 时间和总 CPU 时间，其持续时间比实际经过的时间长约 4%。根据对我之前的问题的接受回答，我不明白怎么会是这样。谁能解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T05:20:11.213

多核上的多线程代码可以使用超过 100% 的 CPU 时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T05:22:49.897

因为如果我在 10 分钟内以 100% 的速度使用两个 CPU，我已经使用了 20 分钟的 CPU 时间（即其中一个 CPU 被禁用，我的操作需要 20 分钟才能完成）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T05:23:30.783

基准测试偏差很小的一种可能性是由于不正确的计时器分辨率。

有很多方法可以确定这些值（时间、滴答声、CPU 频率、OS API 等），因此并非所有基准测试程序都是 100% 可靠的。

# java - Android java.lang.VerifyError？

> ID：668788
> 
> 赞同：101
> 
> 时间：2009-03-21T05:24:20.050
> 
> 标签：java, android, gdata, verifyerror

在我的 Android 应用程序中，我总是得到 VerifyErrors！我不知道为什么。每当我包含一个外部 JAR 时，当我尝试启动我的应用程序时总是会收到 VerifyErrors（除了一次，当我包含 Apache Log4j 时。）

我通常通过获取库的源代码并将其添加到我的项目来解决这个问题，但我正在尝试放置[GData 客户端库](http://code.google.com/p/gdata-java-client/)。

我可以在源代码中得到它，但它的依赖项（mail.jar、activation.jar、servlet-api.jar）我不能，所以我得到验证错误。我想一劳永逸地找到这个问题的根源。我在网上看了，但他们似乎都在谈论不完整的类文件？我不知道。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2010-02-04T20:17:18.140

查看 LogCat 并查看导致验证错误的原因。这可能是您使用的 android SDK 级别不支持的 java.lang 类中的某些方法（例如，String.isEmpty()）。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2010-08-23T15:37:26.510

来自[安卓开发者](http://www.mail-archive.com/android-developers@googlegroups.com/msg15325.html)：

“adb logcat”的输出指示找不到的类以及具有错误引用的类。该位置被识别到特定的 Dalvik 指令。诀窍是查看异常上方的日志。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-21T07:22:05.383

Android 使用不同的类文件格式。您是否通过 Android SDK 附带的“dx”工具运行第 3 方 JAR 文件？

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-11-29T08:21:42.900

要使其工作，您需要将库的 jar 添加到源文件夹之一（即使您已经将其添加为 eclipse 库，您仍然需要将其添加为源）。

1.  在您的项目中创建一个目录（例如“libs”）并将库 jar 放在那里。
2.  通过（单击文件夹上的右键并选择“构建路径”->“用作源文件夹”）将目录添加到构建类路径。
3.  重建你的项目。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-05-11T17:04:10.597

它现在发生在我身上。该错误是因为我使用了我的设备具有的较新 SDK 中的方法。

Android 1.5 设备使用以下方式安装了一个 apk：

```
<uses-sdk android:minSdkVersion="3" android:targetSdkVersion="4"/> 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-09-19T19:19:03.537

我发现了一个有趣的案例。我用：

```
<uses-sdk
   android:minSdkVersion="9"
   android:targetSdkVersion="18" /> 
```

所以一些新的 Android 4 功能没有在 Android 2.3 中实现，例如`ImageView.setLayerType`. 为了避免运行时错误，只需：

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
   setLayerType(View.LAYER_TYPE_SOFTWARE, null);
} 
```

这种方法也应该与异常处理一起使用：

```
} catch (NetworkOnMainThreadException nomte) {
   // log this exception
} catch (SocketTimeoutException socketTimeoutException) {
   // log this exception
} 
```

`NetworkOnMainThreadException`未在 Android 2.3 中实现，因此在**加载类**时（而不是之前！）会发生异常`java.lang.VerifyError`。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-03-23T13:11:43.497

如果您使用的是 Retrolambda，您可能已将静态方法添加到接口（仅在 Java 8 中允许）。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-07-30T14:08:51.287

这也可能是因为 Lollypop 以下版本的引用限制错误，其中限制为最大 65K 大小

上述问题的可能解决方案

第1步：`Add android-support-multidex.jar to your project. The jar can be found in your Android SDK folder /sdk/extras/android/support/multidex/library/libs`

第 2 步：使用 MultiDexApplication 扩展您的应用程序，例如

```
public class MyApplication extends MultiDexApplication 
```

第三步：覆盖 attachBaseContext

```
protected void attachBaseContext(Context base) {
 super.attachBaseContext(base);
 MultiDex.install(this);
} 
```

Step4：下一步是将以下内容添加到您的应用程序 build.gradle 的 android 部分

```
 dexOptions {
      preDexLibraries = false
   } 
```

第 5 步：最后，按照您的应用程序 build.gradle 的一般部分

```
afterEvaluate {
   tasks.matching {
      it.name.startsWith('dex')
   }.each { dx ->
      if (dx.additionalParameters == null) {
         dx.additionalParameters = ['--multi-dex']
      } else {
         dx.additionalParameters += '--multi-dex'
      }
   }
} 
```

详情请查看

[https://developer.android.com/tools/building/multidex.html](https://developer.android.com/tools/building/multidex.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-03-14T08:20:05.677

就我而言，它发生在我从 Eclipse Indigo 更新到 Eclipse Juno 时：我不确定真正的原因是什么，但是，我长期从事的 Android 项目由于该异常而停止工作。

经过**几个**小时的尝试解决这个问题，我找到了适合我的解决方案。

在我的 Android 项目中，我使用位于同一工作区中的其他项目（例如“MyUtils”）。所以，我需要做以下事情：

右键单击Android项目->构建路径->配置构建路径

现在，转到“订购和导出”选项卡并选中“MyUtils”。就是这样：我摆脱了这个烦人的异常。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-12-15T04:46:24.197

我将 gradle 版本从 2.0.0-alpha2 降级到 1.5.0 解决了这个问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-02-17T13:30:48.850

该问题也可能是由两个 androids 项目之间的不匹配引起的。例如，如果您使用包“com.yourcompany”开发了一个 android 库，那么您的主应用程序项目使用与基本包相同的包。然后假设您想更改主应用程序的版本，因此您更改清单文件的值：版本代码和版本名称。如果您在不更改库的这些值的情况下运行您的应用程序，则在对库中的对象的任何方法调用时都会收到验证错误。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-01T16:07:42.023

我遇到过同样的问题。我正在使用 2.1 r1 构建并使用新的 adt 17 更新到 2.1 r3。我在 javamail 的 mail.jar 上验证了错误，这让我发疯了。这是我解决问题的方法：

1.  创建了一个 libs/ 文件夹并添加了罐子。
2.  右键单击>添加为源文件夹

我尝试了重建，但失败了。我删除了 libs/ 目录作为源文件夹，并删除了构建路径中 3 个 jar 文件的引用。然后我再次添加了 libs/ 文件夹，并将 libs/ 文件夹中的每个 jar 添加到构建路径中。现在它按预期工作。这是一个奇怪的解决方法，但它对我有用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-09-23T07:08:36.463

中`Eclipse 4.x`，如果您遇到此问题，请尝试以下操作：

1.  将所有包含的第 3 方 jar 迁移到 User-Libaray
2.  在 android lib 之前上移 user lib 并在 Order and Export 选项卡中检查它
3.  清理并重建以运行

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-11-20T15:23:20.890

我在 SDK 更新后遇到了这个问题。编译器对我的外部库有问题。我这样做了：右键单击项目，然后“android工具>添加支持库...”这个安装在我的项目库“android-support-v4.jar”上。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-02-18T12:31:04.183

`java.lang.VerifyError`意味着您编译的字节码指的是Android在运行时找不到的东西。此 verifyError 仅向我**发出 kitkat4.4 和较小版本**的问题，即使我在两个设备中运行相同的版本，也不在上述版本中。当我使用旧版本的杰克逊 json 解析器时，它显示`java.lang.VerifyError`

```
compile 'com.fasterxml.jackson.core:jackson-databind:2.2.+'
compile 'com.fasterxml.jackson.core:jackson-core:2.2.+'
compile 'com.fasterxml.jackson.core:jackson-annotations:2.2.+' 
```

然后我将依赖关系更改为**最新版本 2.2 到 2.7**，没有**核心库**（当我包含 core2.7 时，它给出了 verifyError），然后它就可以工作了。这意味着**core**的 Methods 和其他内容被迁移到最新版本的**Databind2.7**。这解决了我的问题。

```
compile 'com.fasterxml.jackson.core:jackson-annotations:2.7.0-rc3'
compile 'com.fasterxml.jackson.core:jackson-databind:2.7.0-rc3' 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-03-21T14:21:14.333

我也得到了 VerfiyError ......找不到真正的原因。它有助于将新的代码行包装到一个方法中（Eclipse，'Extract Method...'）。所以在我的情况下，原因不是不受支持的方法。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-01-08T12:29:33.830

我有非常相似的问题。我添加了**Apache POI** jar，当我更新到 android SDK 22.3 时出现了问题。

我检查了 Android Private Libraries，所以这不是 android SDK 的常见问题。我取消选中所有**Apache POI** jar 并一一添加。我发现**poi-3.9-20121203.jar**应该在**poi-ooxml-3.9-20121203.jar**之前。否则它将无法正常工作。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-07-26T13:57:32.493

如果您有测试，请尝试从文件中注释掉这一行`build.grade`：

```
testCoverageEnabled = true 
```

对我来说，这会导致使用 Java 1.7 功能的类出现 VerifyError 异常，尤其是字符串 switch 语句。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2014-10-23T12:41:07.193

进行 git pull 后我遇到了同样的问题。

解决方案：构建 -> 清理项目。

希望这可以帮助。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-02-22T09:21:43.633

我发现了另一个案例。

条件：

*   使用 Retrolambda（不确定是否有必要）；
*   **在接口中创建一个静态方法。**

结果是繁荣！尝试访问使用该接口的类时出现 java.lang.VerifyError。看起来 Android（在我的例子中是 4.4.*）不喜欢接口中的静态方法。从接口中删除静态方法会使 VerifyError 消失。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-01-26T15:00:29.790

我也有这个问题，就像我在用户库中的罐子一样......

我解决这个问题的方法是将它们添加到lib文件夹中，然后将它们添加到eclipse的构建属性中......

我第一次这样做时它不起作用，但后来我删除它们并再次读取它们并开始工作......

有点奇怪！但现在一直在工作。

祝你好运

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-02-08T19:24:31.533

我编写了 SDK 2.1 中的 Android API 方法/类，并试图在 Android 1.6 模拟器上运行它。所以我得到了那个错误。

**解决方案：** 将其更改为正确的模拟器版本。

*这对我**有用**..*谢谢。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-04-15T20:53:23.337

对于后代，我刚刚收到此错误，因为我使用`Arrays.copyOf()`的不是 Java 1.5 支持的方法，它对应于 Android 4 级。因为我正在运行包括在 1.6 下开发的库，它们编译得很好。当我将有问题的课程移到我的 Android 项目时，我只看到了问题——然后突出显示了错误。

```
Uncaught handler: thread main exiting due to uncaught exception
java.lang.VerifyError: com.j256.ormlite.dao.BaseDaoImpl$DaoConfigArray
  at com.j256.ormlite.dao.BaseDaoImpl$1.initialValue(BaseDaoImpl.java:71)
  at com.j256.ormlite.dao.BaseDaoImpl$1.initialValue(BaseDaoImpl.java:1)
  at java.lang.ThreadLocal$Values.getAfterMiss(ThreadLocal.java:429)
  at java.lang.ThreadLocal.get(ThreadLocal.java:66) 
```

在那条线上，我试图做一个`new DaoConfigArray`，而那个类有以下几行：

```
// copyOf is only supported in Java >= 1.6
doArray = Arrays.copyOf(daoArray, newLength); 
```

更复杂的是，第 71 行指向一个`ThreadLocal`初始化，我最初认为这是问题的原因。

```
private static final ThreadLocal<DaoConfigArray> daoConfigLevelLocal
    = new ThreadLocal<DaoConfigArray>() {
    @Override
    protected DaoConfigArray initialValue() {
        return new DaoConfigArray();
    }
}; 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-11-07T15:58:06.160

我不得不删除依赖项目，而是编译依赖项目是 jar 并将它们包含在 libs 文件夹中。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-07-15T21:04:28.707

我确定我的原因与您的不同，但由于这是搜索“Android java.lang.VerifyError”时最热门的结果之一，我想我会在这里记录下来以备后人。

我有一些课程如下：

```
public class A { ... }
public class B extends A { ... }
public class C extends A { ... } 
```

还有一种方法：

```
A[] result = null;
if (something)
    result = new B[cursor.getCount()];
else
    result = new C[cursor.getCount()];

// Fill result
... 
```

只要此代码存在于文件中，我就会在第一次加载包含此方法的类时收到一个 VerifyError。将它分成两种单独的方法（一种只处理 B，另一种只处理 C）解决了这个问题。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-01-08T03:27:15.517

就我而言，发生此错误是因为我的**google-play-service 不是最新的**。

如果您的项目不支持 .jar 中的某些类，则会发生此错误（例如 ImageView.setLayerType、 AdvertisingIdClient 等）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-08-18T12:57:58.123

我刚刚确定了它发生的另一种情况，不仅是由于 libs not *dx* 'ed。我有一个非常长的 doInBackground 方法的 AsyncTask。由于某种原因，这种超过 145 行的方法开始失效。它发生在 2.3 应用程序上。当我只是将一些部分封装到方法中时，它工作得很好。

因此，对于那些找不到未正确*dx*编辑的类的人，请尝试减少方法的长度。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-09-14T18:12:44.393

对我来说，问题最终实际上是我在类中的某处使用了 multi-catch 子句，这是 Java 7 功能（和 API 19+）。所以它会`VerifyError`在所有 19 之前的设备上崩溃。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-03-11T21:20:56.810

对我来说，compileSdkVersion 和 buildToolsVersion 之间存在关联。我有：

```
compileSdkVersion 21
buildToolsVersion '19.1.0' 
```

我将其更改为：

```
compileSdkVersion 21
buildToolsVersion '21.1.2' 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-08-26T01:45:46.120

对我来说，这是 compileSdkVersion 的问题。当我在特定的 android 应用程序（[https://github.com/android10/Android-AOPExample](https://stackoverflow.com/questions/668788/android-java-lang-verifyerror//)）中使用 API 级别 21 时：

```
compileSdkVersion 21 
```

java.lang.verifyerror 发生了。所以我把 compileSdkVersion 改成了 19

```
compileSdkVersion 19 
```

它运作良好。我认为这可能是SDK buildTools的问题，API级别<21时似乎可以。

# language-agnostic - 避免处理器中的时序问题

> ID：668792
> 
> 赞同：3
> 
> 时间：2009-03-21T05:27:10.697
> 
> 标签：language-agnostic, cpu

我正在编写一个（非常缓慢和原始的）处理器的模拟。

例如：假设时钟速度是恒定的 1 hz。我假设这意味着每秒可以/将处理 1 条指令。有些指令比其他指令需要更长的时间。添加 1 + 0 比 1 + 7 花费更少的时间。（后者会导致进位位的波动，这需要非零的时间量。）

只有在所有其他指令完成后，我才需要能够执行指令。

我需要：

1.  time 最长指令需要多长时间并将时钟速度设置为大于该时间？
2.  创建一个有状态的观察者，在前一个指令完成之前不允许执行未来的指令
3.  我完全误解了这个问题吗？

在＃1中，似乎我仍然冒着在下一个开始之前指令不完整的竞争条件的风险。在 #2 中，似乎我冒着不可预测/可变时钟速度的风险，这可能会导致我以后出现问题。

我该如何解决这个问题？有没有关于真正的处理器如何处理这个问题的提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T05:44:05.947

你熟悉[指令流水线](http://en.wikipedia.org/wiki/Instruction_pipeline)吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T06:00:14.707

首先，处理器每个时钟周期执行一组微指令，这些通常涉及诸如将总线切换到寄存器或 ALU（算术逻辑单元）之类的事情，下一条微指令可能会为寄存器或 ALU 计时以处理数据在一辆公交车上。大多数汇编级指令都是由一系列微指令组成的。一条加法指令只需要几条微指令，但除法可能需要更多。大多数微控制器记录每个汇编级指令需要多少个周期。

对于更复杂的微控制器，还有一条指令管道（如 cat 所述），这意味着处理器可以在前一条指令完成之前开始执行下一条指令的一部分。对于预测分支等概念，这可能会变得非常复杂。

通常，当您模拟数字电子设备时，您会使用基于事件的模型，因为电子系统是并发的，但也有需要建模的传播延迟。我记得在 Uni 使用 PSpice 和 MicroSim 等工具做得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T06:03:05.930

实际处理器如何处理时序与处理器仿真如何处理时序之间存在许多差异。而且，没有一种方法可以让实际的处理器处理时序！

既然你说它是一个简单而原始的处理器，你就不必担心缓存、流水线、乱序执行、分支预测等（尽管了解这些会很好）。

您可以简单地将时钟间隔设置为最长指令的间隔。或者，您可以将所有较短的指令集中在一组中，找到该组中最长的指令，并将时钟间隔设置为该值。现在，可以为剩余的长指令分配一个等于时钟间隔倍数的间隔。

再说一遍，没有一种方法可以解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T06:01:22.643

(1) 时钟是什么。你不应该有竞争条件；执行一次加法需要 x ns；时钟是 y ns。x < y。因此，添加总是首先完成（好吧，只要 y 足够大，以至于由于例如温度变化而导致的时序变化不会使 x<y 为假）。

当然，如果你把 y 设置得太小，就会发生不好的事情。但这很现实。当您超频芯片时会发生这种情况。随着时钟频率的上升，它们变得不稳定。

# .net - 我可以根据 XML 模式验证 XPath 表达式吗？

> ID：668805
> 
> 赞同：7
> 
> 时间：2009-03-21T05:42:18.307
> 
> 标签：.net, xml, xpath, xsd

您可以根据 XML 文档验证 XPath 表达式以对其进行验证，但是是否有一种简单的方法可以根据该文档的*架构*验证相同的 XPath 表达式？

假设我有一个这样的 XSD 架构：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" ... etc>
  <xsd:element name="RootData">
    <xsd:complexType>
      <xsd:sequence minOccurs="0">
        <xsd:element name="FirstChild">
          <xsd:complexType>
            <xsd:sequence minOccurs="0">
              <xsd:element name="FirstGrandChild">
... etc etc 
```

是否有一种简单或内置的方法来验证 XPath：

```
/RootData/FirstChild/FirstGrandChild 
```

对可能基于该模式的任何 XML 文档是否有效？（**编辑**：我想我的意思是*可能有效*；*实际*的XML 文档可能不包含这些元素，但 XPath 仍然可以被认为对模式有效。而比如说，`/RootData/ClearlyInvalidChild/ThisElementDoesntExistEither`显然是无效的。）

当然，我只能期望这适用于规范的 XPath 表达式，而不是任意复杂的表达式，但这很好。

我特别考虑.NET，但很好奇其他实现是否可以实现。我想自己动手并不是那么重要，例如，我真的不想编写自己的代码来将该 XPath 表达式转换为另一个表达式，例如：

```
/xsd:schema/xsd:element[@name='RootData']/xsd:complexType/xsd:sequence/xsd:element[@name='FirstChild']/...etc... 
```

......虽然我知道如果我真的必须这样做，我可以这样做。

干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-08T10:01:17.333

实际上，我们对此进行了一个研究项目，并在 2000 年左右的某个时候实现了 XPath 验证器。这是针对 XPath 1 的。我不知道您可以使用任何当前可用的库来执行此操作。

如果你想自己去实现它，这里有一些提示：

*   您将无法像上面那样将实例文档上的路径转换为架构上的路径。例如，`/a//b`不会转换为`/xsd:element[@name='a']//xsd:element[@name='b']`，因为元素 b 可能定义在模式的顶层，而不是在 b 之下。

*   请记住，虽然 XML 文档是树，但模式是图。如果你搜索像 //a 这样的后代路径，你将不得不决定何时终止搜索，否则它可能会永远继续下去（例如，想象一个包含“b”的元素“a”，其中包含“a”）

*   有些路径将无法确定或至少很难确定。例如`//*[starts-with(@name, 'foo')]`

If you're still up for it, I suggest using a library like eclipse's [XSD](http://www.eclipse.org/xsd/) or the .NET schema loading classes to load the schema into memory and do your checking in code.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T12:26:33.560

在设计时，您可以使用一个工具来生成一个示例 XML 文档并针对该示例执行您的 XPath。Altova XML Spy 与 SOAP UI 一样具有此功能。

SOAP UI 实际上是开源的 (Java)，所以也许您可以看一看它是如何生成示例的。在运行时情况下（即如果模式和 XPath 都是运行程序的输入），那么您必须确保生成了足够的可选组件和示例数据以避免误报，并且可能需要生成多个示例文件。

我不会尝试直接针对模式评估 XPath，因为各种 Axes 会使完整的解决方案变得非常复杂。我很确定这是可以做到的，但它给我的印象是核心数学。我建议生成样本作为捷径。

# c# - 最小化自定义函数的命名空间

> ID：668806
> 
> 赞同：0
> 
> 时间：2009-03-21T05:42:28.117
> 
> 标签：c#, asp.net

我在 CommonFunctions 项目中有一个 StringUtilities.cs 文件，其中包含一个 UppercaseFirst 函数，该函数将字符串中的第一个单词大写。当前在使用此功能的单独项目（在同一解决方案中）中的 .aspx.cs 中，使用**MyProject.CommonFunctions.StringUtilities.UppercaseFirst("hello world");**

是否可以将其缩短为**UppercaseFirst("hello world");** ? 可读性会好很多。

CommonFunctions 项目中的 StringUtilities.cs：

```
namespace MyProject.CommonFunctions
{
    public class StringUtilities
    {
        public static string UppercaseFirst(string s)
        {//blah code}
    }
} 
```

默认.aspx.cs

```
using MyProject.CommonFunctions;
...
protected void Page_Load(object sender, EventArgs e)
{
     MyProject.CommonFunctions.StringUtilities.UppercaseFirst("hello world");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T20:14:29.393

如果您使用的是 c# 3.0 (.NET 3.5)，您可以使用扩展方法：

```
namespace MyProject.CommonFunctions
{
    public static class StringUtilities
    {
        public static string UppercaseFirst(this string s)
        {//blah code}
    }
} 
```

一旦你在适当的文件中设置了你的使用，你就可以去：

```
using MyProject.CommonFunctions;
...
protected void Page_Load(object sender, EventArgs e)
{
     "hello world".UppercaseFirst();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T05:48:48.727

您不能一直将其缩减为仅方法名称，但鉴于您已经准备好该`using MyProject.CommonFunction;`行，您可以将其缩短为：

```
StringUtilities.UppercaseFirst("hello world"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T05:59:09.340

不在 C# 中；VB.NET（和 C++/CLI）有不同的查找规则。

在 C# 中，您可以使用`using`别名，如下所示：

```
using StrUtil = MyProject.CommonFunctions.StringUtilities; 
```

这将允许你然后写

```
protected void Page_Load(object sender, EventArgs e)
{
     StrUtil.UppercaseFirst("hello world");
} 
```

无论封闭的命名空间如何。

# c# - 从表单类方法访问另一个表单对象

> ID：668807
> 
> 赞同：1
> 
> 时间：2009-03-21T05:42:52.453
> 
> 标签：c#, winforms

我有这个表单类

```
public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        private void button1_Click(object sender, System.EventArgs e)
        {
            //This is where I'm working
        }
    } 
```

从 button1_Click 方法内部如何访问表单上的其他元素？
我试着这样做

```
private void button1_Click(object sender, System.EventArgs e)
{
    statusStrip1.Text = "You pressed the button.";
} 
```

但这行不通。在 PHP 中我会使用 $this->otherObject = 'text';。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T05:58:12.200

使用 this 关键字获取对类上可用属性、方法和可用事件的智能感知访问。例如，如果您需要访问文本框名称 CustomerName，您可以这样做：

```
private void button1_Click(object sender, System.EventArgs e)
{
  this.CustomerName.Text = "Your Name";
  // is the same as
  CustomerName.Text = "Your Name";
} 
```

**更新** 您添加的此更新代码应该可以工作。右键单击 InitializeComponent 方法并选择 Go To Definition 以查看 Designer 生成的代码。也许您的 statusStrip 不受保护，如果是这样，请更新您的问题或添加评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T05:58:41.840

我对c#不熟悉，但一般来说，当你初始化表单时，我认为你将对各个部分的引用存储为类的实例变量，然后类的方法可以访问它们。我不确定这是否适合您...

# javascript - 你如何设置 javascript/css 的最大年龄？

> ID：668810
> 
> 赞同：3
> 
> 时间：2009-03-21T05:45:47.207
> 
> 标签：javascript, css, http

我刚刚运行了[Pagetest](http://webpagetest.org/)，它说我需要为我的 JS/CSS 设置一个 max-age。我怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-21T05:56:39.083

听起来像是在谈论 HTTP 标头。基本上，您需要添加几个 HTTP 标头以与您的 Javascript 和 CSS 文件（以及图像也是一个好主意）一起发送，看起来像这样：

```
Cache-Control: max-age=86400
Expires: Sat, 28 Mar 2009 16:00:00 GMT 
```

第一个给出了浏览器在从服务器再次下载之前保留内容（JS 或 CSS 文件）的最长时间（以秒为单位）；第二个给出了浏览器应该重新下载内容的日期和时间。是的，这是同一件事的两种说法，但`Cache-Control`标题有点新，我不确定它是否得到普遍支持；指定两者确实没有害处。（如果有冲突`Cache-Control`优先。）`Expires`

至于您如何实际配置服务器以发送这些标头：这取决于您正在运行的 Web 服务器。如果您使用的是 Apache，请查看[mod_expires](http://httpd.apache.org/docs/2.2/mod/mod_expires.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-29T16:11:48.740

向服务器发出的每个请求（对于图像，还包括 CSS）都是单独发出的。在 global.asax 中部署事件处理程序可以让您侦听这些请求，因此您可以在那里修改响应标头并添加您需要的其他设置。

以下是各种事件： http: [//msdn.microsoft.com/en-us/library/system.web.httpapplication_events (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.web.httpapplication_events(v=vs.71).aspx)

HTH。

# .net - Linq to Sql：条件顺序影响的地方

> ID：668813
> 
> 赞同：0
> 
> 时间：2009-03-21T05:47:36.717
> 
> 标签：.net, linq-to-sql, where-clause

使用 LINQ-TO-SQL linq 查询 - 生成的 SQL 是否遵守“Where 条件”顺序？

例如：

```
int[] result = (from r in DB.Accounts 
                where r.AccountID > 10 && r.Name == "Harry").ToArray(); 
```

如果有数千行，并且Name列上有Index，SQL会先按Indexed列查询吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T06:37:36.237

没关系 - SQL Server 会处理这个问题。

# java - 会话和请求的对象

> ID：668814
> 
> 赞同：0
> 
> 时间：2009-03-21T05:47:46.793
> 
> 标签：java, jsp, web-applications, jakarta-ee, struts

在struts中，会话对象在哪里创建&哪个类或方法创建它？同样，请求对象在哪里创建以及哪个类或方法调用它？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T07:19:00.243

请求对象是在您的 servlet 容器（tomcat/jetty/whatever）中创建的。

会话基本上是由首先在[HttpServletRequest](http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/http/HttpServletRequest.html#getSession(boolean))上调用 getSession 的人创建的。通常 web 框架只有在有人真正声明他们需要会话时才会这样做。如果您想知道何时发生这种情况，我建议您在 IDE 中使用“转到实现”并设置断点并运行应用程序（注意有两个重载）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-09T23:38:22.937

```
import com.opensymphony.xwork2.ActionSupport;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.SessionAware;

public class MyAction extends ActionSupport implements SessionAware,ServletRequestAware
{
    Map<String,Object> session;
    HttpServletRequest servletRequest;

    public void setSession(Map<String, Object> session) {

        this.session = session;
    }

    public void setServletRequest(HttpServletRequest hsr) {
       this.servletRequest=hsr;
    }

    public String execute()
    {
       return SUCCESS;
    }
} 
```

每当调用此操作时，首先调用 setServletRequest，然后调用 setSession()。

请求和会话的对象由您正在使用的 Web 容器创建并传递给相应的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-08T11:11:33.823

在 Struts 中，**ActionForm**实例可以存储在**HttpSession**或**HttpServletRequest**中。

它取决于**struts-config.xml**文件内的**action**标记中定义的**范围。**

 ******ActionForm**通常使用在 action-form 标签中定义的名称来**存储**。

# c# - 如何使用 LINQ to XML 从两个 Atom 提要创建聚合 Atom 提要

> ID：668820
> 
> 赞同：2
> 
> 时间：2009-03-21T05:54:54.517
> 
> 标签：c#, linq

刚刚尝试从两个单独的 Atom 提要创建聚合提要 - 按发布日期降序排序...

更新：感谢 Martin Honnen (MVP) 在[http://social.msdn.microsoft.com/Forums/en-US/categories/](http://social.msdn.microsoft.com/Forums/en-US/categories/) - 结合安全 XElement.Load(url) 帮助器（和迭代器块）.. . 我认为下面的代码是聚合 Xml 文档的一种很好的方法（在这种情况下聚合站点地图 - 尽管这很容易适应 Atom 或 RSS 提要）。

下面的命名空间转换助手只转换元素而不转换属性（尽管也可以添加）。

```
static void Main(string[] args)
{
    XDocument feed = MergeSiteMaps(new List<string>() { "http://www.58bits.com/blog/googleSitemap.ashx", "http://www.58bits.com/otherblog/googleSiteMap.ashx",  "http://www.58bits.com/photos/sitemap.xml"});

    XNamespace sm = "http://www.sitemaps.org/schemas/sitemap/0.9";

    foreach (XElement location in feed.Root.Elements(sm + "url").Elements(sm + "loc")) 
    {
        Console.WriteLine((string)location); 
    } 
}

public static XDocument MergeSiteMaps(IEnumerable<string> urls)
{
    XNamespace sm = "http://www.sitemaps.org/schemas/sitemap/0.9";
    XNamespace xsi = "http://www.w3.org/2001/XMLSchema-instance";
    XNamespace xsd = "http://www.w3.org/2001/XMLSchema";
    string schemaLocation = "http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd";

    //Our container sitemap document
    return new XDocument(
        new XDeclaration("1.0", "utf-8", "yes"),
        new XElement(sm + "urlset",
            new XAttribute(XNamespace.Xmlns + "xsi", xsi),
            new XAttribute(XNamespace.Xmlns + "xsd", xsd),
            new XAttribute(xsi + "schemaLocation", schemaLocation),

            new XElement(sm + "url",
                new XElement(sm + "loc", "http://www.58bits.com/"),
                new XElement(sm + "lastmod", DateTime.Now.ToString("yyyy-MM-dd")),
                new XElement(sm + "changefreq", "monthly"),
                new XElement(sm + "priority", "1.0")),

            new XElement(sm + "url",
               new XElement(sm + "loc", "http://www.58bits.com/default.aspx"),
               new XElement(sm + "lastmod", DateTime.Now.ToString("yyyy-MM-dd")),
               new XElement(sm + "changefreq", "monthly"),
               new XElement(sm + "priority", "1.0")),

            GetElements(sm, urls, "url"))
        );
}

private static IEnumerable<XElement> GetElements(XNamespace ns, IEnumerable<string> urls, string elementLocalName)
{
    XElement source;

    foreach (string url in urls)
    {
        try
        {
            source = XElement.Load(url);
        }
        catch (Exception ex)
        {
            //TODO: Log the Url that failed
            string message = ex.Message;
            continue;
        }

        XNamespace defaultNamespace = source.GetDefaultNamespace();
        bool differentNamespace = (ns != defaultNamespace);
        foreach (XElement element in source.Elements(defaultNamespace + elementLocalName))
        {
            if (differentNamespace)
                ChangeNamespace(ns, element);
            yield return element;
        }
    }
}

private static void ChangeNamespace(XNamespace ns, XElement entry)
{
    foreach (XElement e in entry.DescendantsAndSelf())
    {
        if (e.Name.Namespace != XNamespace.None)
        {
            e.Name = ns.GetName(e.Name.LocalName);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T06:06:22.460

我会研究[SyndicationFeed](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx)类。这是使用此生成提要的示例。

```
private static SyndicationFeed CreateFeed(List<SyndicationItem> items)
{
    // Create the list of syndication items. These correspond to Atom entries
    SyndicationFeed feed;

    // create the feed containing the syndication items.
    feed = new SyndicationFeed()
    {
        // The feed must have a unique stable URI id
        Id = "http://example.com/MyFeed",
        Title = new TextSyndicationContent("My Feed"),
        Items = items
    };
    feed.AddSelfLink(WebOperationContext.Current.IncomingRequest.GetRequestUri());
    return feed;
}

private static SyndicationItem CreateItem()
{
    var item = new SyndicationItem()
       {
           // Every entry must have a stable unique URI id
           Id = id.ToString(),
           Title = new TextSyndicationContent(title),
           // Every entry should include the last time it was updated
           LastUpdatedTime = startDate,
           // The Atom spec requires an author for every entry. If the entry has no author, use the empty string
           Authors = 
               { 
                   new SyndicationPerson() 
                       {
                           Name = author.Name,
                           Email = author.EmailAddress,
                           Uri = author.Website
                       }
               },
           // The content of an Atom entry can be text, xml, a link or arbitrary content. In this sample text content is used.
           Content = new TextSyndicationContent(description),
       };

    return item;
} 
```

# c# - LinQ to Entities：用四张表查询 JOIN

> ID：668821
> 
> 赞同：2
> 
> 时间：2009-03-21T05:54:57.683
> 
> 标签：c#, linq-to-entities

我有四张桌子：

```
- Client with PK ClientID.
- Destination with PK DestinationID.
- Language with PK LanguageID.
- DestinationDetail with PK DestinationID.
- RL-Client-Destination with PKs ClientID and DestinationID. 
```

客户端可能有零个或 n 个目的地。一个目的地有 n 个 DestinationDetails，每个 DestinationDetail 都有一种语言。

行。我需要检索给定客户端和给定语言的所有 DestinationDetails。

我开始写这个：

 ````
try
   {
      ObjectQuery clientes = 
          guiaContext.Cliente;
      ObjectQuery destinos =
          guiaContext.Destino;
      ObjectQuery idiomas =
          guiaContext.Idioma;
      ObjectQuery detalles =
          guiaContext.DetalleDestino;

      IQueryable detalleQuery =
          from cliente in clientes
          from destino in destinos
          from idioma in idiomas
          from detalleDestino in detalles
          where destino.
          select detalleDestino;

   }
   catch
   {
   }
} 

```

有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T07:38:24.377

它沿着这条线：

```
var detalleQuery =
          from client in guiaContext.Clients
          where client.ID == 1
          from destination in cliente.Destinations
          from destinationDetail in destination.DestionationDetails
          where destinationDetail.Language.Iso2Code == "es"
          select destinationDetail; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T07:05:50.163

您是否尝试过进行 linq 连接：

[使用 LINQ 从多个表中选择](https://stackoverflow.com/questions/32433/linq-select-with-multiple-tables)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T09:13:56.580

我的答案：

```
 var db = new PracticeEntities();
            var destinations = db.DestinationDetails.
                Where(dd => dd.Language.Lang == "en-US" &&
                dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com")); 

```

谢谢！

# assembly - x86 是否有一个原子增量来保留存储的值？

> ID：668830
> 
> 赞同：4
> 
> 时间：2009-03-21T05:59:37.110
> 
> 标签：assembly, x86, atomic

我发现`lock inc addr`，但这并没有保留存储值的副本，甚至在同一个线程中立即读取也可能发生在竞争写入之后。

我发现的最佳解决方案是`load`//循环`inc`。[`cas`](http://en.wikipedia.org/wiki/Compare_and_swap)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-21T06:13:34.953

`lock xadd`是你的朋友。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-18T12:36:09.427

有关更多 x86/x86_64 原子原语和用法，请参阅[atomic_impl.h](http://code.google.com/p/effocore/source/browse/trunk/devel/effo/codebase/addons/inl/include/impl/atomic_impl.h)。

# asp.net - asp.net 2.0 上的 asp.net mvc + ajax 扩展 1.0 + win 2k3 服务器上的 iis 6

> ID：668831
> 
> 赞同：0
> 
> 时间：2009-03-21T06:00:03.177
> 
> 标签：asp.net, asp.net-mvc, ajax, iis-6, url-rewriting

我在 asp.net 2.0 Web 应用程序上的 url 重写和 ajax 扩展 1.0 有很多问题。

我正在考虑使用 asp.net mvc。

它对我有用吗，因为我在 win2k3 服务器上使用 asp.net 2.0、ajax 扩展 1.0 + ajax 控制工具包、iis 6？

我的开发机器是带有 iis 7 的 windows vista

请指教。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T06:07:28.620

mvc 需要 3.5 框架 “ASP.NET MVC 1.0 在现有 ASP.NET 3.5 运行时之上提供了一个新的模型-视图-控制器 (MVC) 框架。”

[http://www.microsoft.com/downloads/details.aspx?FamilyID=53289097-73ce-43bf-b6a6-35e00103cb4b&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=53289097-73ce-43bf-b6a6-35e00103cb4b&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T08:45:46.150

在博客[http://alejandrovidalquiroga.blogspot.com/](http://alejandrovidalquiroga.blogspot.com/)中有针对 ASP.NET 2.0 的 ASP.NET MVC 的部分实现。

# linux - Linux 对点击式许可证的支持

> ID：668838
> 
> 赞同：1
> 
> 时间：2009-03-21T06:06:34.160
> 
> 标签：linux, licensing, eula

我想为不同的 Linux 发行版发布一些软件，使用常规的 Linux 打包格式（rpm、deb、yast 等）。我的包裹需要点击许可协议。哪些 Linux 工具和包格式支持在安装软件之前向用户显示的包中的许可证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T06:09:24.027

.deb 肯定可以；来自 Debian non-free 的 sun-java* 软件包有一个。

请记住，在 Linux（和其他 Unix 系统）上，通常由管理员安装软件，但实际使用它的人却不同。您可能希望在每个用户第一次运行该软件时显示您的点击许可。

（嗯，实际上， dpkg 是基于文本的，所以它不是*点击*，而是打字，但是......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T06:32:14.177

正如 derobert 所说，在 Unixy 系统上，安装软件的通常不是最终用户，因此要求安装程序/管理员同意许可可能不是您想要的（取决于软件的目的和许可文本，我猜测）。

多年来，点击式（或收缩包装，略有不同但原理基本相同）许可证一直是争论的焦点，因为虽然用户“接受”但很难证明是用户接受了许可证，并且用户在使用该软件之前实际阅读了呈现给他们的内容。

举个例子，让你的 lcoal mom+pop 电脑维修店安装/升级 Windows；他们通常单击许可证页面，以便将捆绑的所有其他垃圾软件安装到 PC 上，而实际所有者没有机会阅读或同意许可证。

值得在您的管辖范围内查找该类型许可证的合法性以及您打算定位的用户的管辖范围。

我也不会依赖包管理来为您执行此操作。我肯定会将它作为您的应用程序代码的一部分。如果需要，您可以为几乎任何包管理器获取安装后脚本来运行点击程序，但我认为最好将其作为每个用户运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T17:55:59.307

不应使用 RPM 的安装脚本来提示问题，因为不能保证代码在脚本中运行。（它可以从 GUI 安装，而且人们不希望脚本在大型安装事务中暂停）。您可以命名 RPM 使用的许可协议，并在首次运行时向用户展示，或者从他们的下载站点或通过在说明中添加注释来显示。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-23T04:53:34.473

您可能不想通过打包机制执行此操作，但不能保证点击。相反，您可能会考虑在第一次运行应用程序时提供这样的许可证。不要依赖基于诅咒的窗口提示，一些软件包安装程序只会将它们重定向，您的安装将永远挂起。

一些应用程序现在这样做是为了维护商标政策，而另一些应用程序则更深入一些。大多数 Linux 用户**不**喜欢 EULA 协议，但我猜任何安装您的软件的人都会期待一个。

# asp.net-mvc - 如何在 ASP.NET MVC 中创建几个单选框？

> ID：668842
> 
> 赞同：2
> 
> 时间：2009-03-21T06:09:16.463
> 
> 标签：asp.net-mvc, radio-button

是的:(简单的问题**脸红**

让我们想象一下我有以下枚举： -

```
string[] languages = new string[]
                     {
                         "en (uk)", // English (colour)
                         "en (us)", // English (color)
                         "fr", // French
                         "es" // Spanish
                     };

ViewData["Languages"] = languages;
ViewData["UserLanguage"] = "en (uk)"; 
```

有了这个，我将如何在视图中显示单选按钮？这样做是枚举所有语言值并呈现 RadioBox 的唯一方法吗？

例如。伪代码...

```
<% foreach(string language in ViewData["Languages"] as string[])
{
  response.write Html.RadioBox(... not sure what to set in here ...)
}%> 
```

干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T06:31:10.403

又快又脏：

```
<% foreach(string language in ViewData["Languages"] as string[]) { %>
  <%= Html.RadioBox(language,language,language == ViewData["UserLanguage"].ToString()) %>
<% } %> 
```

问题是您在该视图数据中分配了魔术字符串。我会做的是这样的：

1.  创建一个类：用户窗体

    ```
    class UserForm {

         IList<string> _languages;
         string _selectedL;

         public UserForm (IList<string> languages, string selectedLanguage)
         {
           _languages = languages;
           _selectedL = selectedLanguage;
         }

         IEnumerable<SelectedListItem> UserLanguages {
             get {
                  return from l in _languages
                          select new SelectedListItem {
                              Text = l,
                              Value = l,
                              Selected = (l == _selectedL)
                          };
             }
         }
    } 
    ```

2.  视图应该是强类型的并且是类型： UserForm 然后你可以像这样渲染它：

    ```
    <%= Html.RadioButtonList("userLanguages",ViewData.Model.UserLanguages) %> 
    ```

3.  从控制器你会：

    ```
    return View(new UserForm(listOfLanguages, selectedLanguage)); 
    ```

HTH。

**编辑：** 好的，找到了——这`RadioButtonList`是命名空间中的一个扩展方法`Microsoft.Web.Mvc`（MVCFutures 项目）——你可以从这里得到它：[MVCFutures](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)

# asp.net - 如何将 Flash (.swf) 文件嵌入 asp.net？

> ID：668846
> 
> 赞同：7
> 
> 时间：2009-03-21T06:12:48.327
> 
> 标签：asp.net, flash

如何在 asp.net 中显示 flash (.swf) 文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-21T06:21:51.253

从 YouTube 得到这个

```
<object width="425" height="344">
    <param name="movie" value="http://www.youtube.com/v/Xt5t9BO6xkA&hl=en&fs=1"></param>
    <param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param>
    <embed src="http://www.youtube.com/v/Xt5t9BO6xkA&hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed>
</object> 
```

你只需要这个：

```
<object width="425" height="344">
  <embed src="PATH_TO_YOUR_FILE" type="application/x-shockwave-flash" width="425" height="344"></embed>
</object> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T20:15:50.833

使用 SWF 对象 javascript 帮助 [程序 http://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

*   这是行业标准
*   它隐藏了浏览器之间 Flash 初始化的差异
*   它允许您以独立于浏览器的方式指定 Flash 变量
*   它允许您指定所需的 Flash 播放器版本

请参阅下面的示例

```
<script type="text/javascript">
var flashvars = {
playlistURL: "playlist.xml",
skinURL: "skin-transp-grey.swf",
width: "400", 
height: "300",
continuous : "true"
};

var params = {
allowscriptaccess: "always",
allowfullscreen: "true",
};

var attributes = {
id: "mediaplayer1",
name: "mediaplayer1"
};

swfobject.embedSWF("mediaplayer.swf", "video", "400", "300", "9.0.0", "expressInstall.swf", flashvars, params,attributes);
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-21T07:15:47.583

我会考虑使用[**FlashEmbed**](http://flash.flowplayer.org/)，这是一种 JavaScript 工具，可用于将 Flash 对象嵌入到您的网站。

它使用简单，有很多优点：

*   这很简单：只需使用`flashembed("flash10", "/swf/flash10.swf")`例如，如果您不需要任何特别的东西，您就不必学习太多。
*   网站上有很多演示如何配置工具
*   jQuery 支持：flashembed 专为脚本编写者而设计，具有优美的编程 API 以及对 jQuery 选择器的支持。
*   JSON 配置：为 Flash 对象提供配置时，值可以是具有数组、字符串、函数和其他对象的复杂 JavaScript 对象。
*   大小：缩小后的插件重量约为 5 kb。

如果您愿意，您可以编写一个**ASP.NET 服务器控件**，它会在该页面上呈现您需要的 HTML：

1.  包括使用的外部脚本资源链接`ScriptManager.RegisterScriptResource(...)`（每页一次）
2.  使用渲染 flashebmed 脚本`ScriptManager.RegisterClientScript(...)`（对于您要嵌入页面的每个闪存）
3.  写一些有用的属性，如 src、name 等。

然后，以这种方式在您的页面中使用控件，例如：

```
<myControls:FlashEmbed runat="server" id="Flash1" Name="Clock" Src="/swf/clock.swf" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T06:30:55.100

嵌入是通过您在 HTML 中输出的内容来处理的——ASP.NET 没有任何具体的内容。

换句话说，与输出任何其他 HTML`<B>, <I>`等的方式相同，您可以输出如下内容：

```
<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/IZKl4nA5cmM&hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/IZKl4nA5cmM&hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T09:42:00.683

在所有现代浏览器中单独使用 HTML5 嵌入标签就可以解决问题。

```
<embed src="FILE" type="application/x-shockwave-flash" width="X" height="Y" /> 
```

# ssl-certificate - 更新证书时公钥会改变吗？

> ID：668849
> 
> 赞同：22
> 
> 时间：2009-03-21T06:13:56.793
> 
> 标签：ssl-certificate

您好，当我更新 SSL 证书时，公钥会更改还是与过期证书相同？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-21T06:21:40.817

如果您重复使用相同的证书请求，则密钥不会更改。如果您生成一个新请求，通常（默认情况下）会生成一个新密钥；重用有时很有用，例如添加另一个备用域名。

如果您的证书颁发机构不需要证书请求，那么他们必须重新使用旧的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T06:22:35.603

证书与密钥无关。本质上，证书只是您的公钥的签名。您继续重复使用相同的密钥（除非您的旧公钥已过期）。

# rss - 创建 RSS/Atom 提要：模板语言还是 XML 库？

> ID：668851
> 
> 赞同：0
> 
> 时间：2009-03-21T06:15:29.427
> 
> 标签：rss, templating, atom-feed

我正在为我的网站创建一个 RSS（和/或 Atom）提要。现在，我可以立即想到两种方法来做到这一点：

1.  使用我用来生成 HTML 的相同模板系统（如果有人想知道， [Clearsilver](http://www.clearsilver.net)），基本上只是将 RSS 提要视为碰巧在 RSS+XML 中而不是 XHTML 中的任何其他网页
2.  在我选择的编程语言 (Python) 中使用 XML 库或 RSS 库以编程方式创建提要，然后将其写出

是否有特别的理由选择一种方法而不是另一种方法？从最初的印象来看，我倾向于选项 1，主要是因为它更容易理解。

*编辑*：所以我从比尔那里得到了一个很好的答案。但在这种特殊情况下，RSS 提要字段的所有值都已格式化为格式正确、正确转义的 XHTML……还有其他意见吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T06:18:56.050

两种方式都完成后，我更喜欢＃2。它会根据需要更好地转义实体，确保生成格式良好的 XML 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T20:47:38.410

模板通常更快更容易，但如果你想确保生成有效的 xml 和 rss/atom，那么你应该使用 xml 库。如果您编写一个测试来验证您的模板生成的 xml，那么您应该没问题。

# mysql - 强制 mySQL 加入一个表（做一个未优化的查询，我需要）

> ID：668854
> 
> 赞同：1
> 
> 时间：2009-03-21T06:17:16.083
> 
> 标签：mysql, sql-match-all

这有点奇怪。我有下一个查询：

```
SELECT * , GROUP_CONCAT( x.tag
SEPARATOR ',' ) AS tags
FROM tag AS t, tag AS x, tag_message_rel AS r, message m
INNER JOIN `user` AS u ON m.user_id = u.id
WHERE t.tag
IN (
'kikikiki', 'dsa'
)
AND m.id = r.message_id
AND t.id = r.tag_id
AND x.id = r.tag_id
GROUP BY m.id
HAVING COUNT( * ) >=2
ORDER BY m.created_at DESC
LIMIT 0 , 20 
```

如您所见，我使用 t 加入查找我想要的消息，另一方面我使用 x 打印消息的标签。我删除了这条线：

```
AND x.id = r.tag_id 
```

我会得到我想要的消息，但标签将在标签表中包含用逗号分隔的所有标签。如果我把线路留在那里，我只会得到这 2 个标签。如果我使用解释我得到：

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra
1   SIMPLE  u   system  PRIMARY     NULL    NULL    NULL    1   Using temporary; Using filesort
1   SIMPLE  t   range   PRIMARY,tag     tag     252     NULL    2   Using where
1   SIMPLE  x   eq_ref  PRIMARY     PRIMARY     4   verse.t.id  1    
1   SIMPLE  r   ALL     NULL    NULL    NULL    NULL    180     Using where; Using join buffer
1   SIMPLE  m   eq_ref  PRIMARY     PRIMARY     4   verse.r.message_id  1   Using where 
```

现在我不是这方面的专家，但我认为问题在于它拒绝在优化查询的过程中重新加入表。

你怎么看？有什么快速解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T03:38:15.520

问题是您尝试加入`tag`表两次，但您确实需要加入`tag_message_rel`表两次，并从每个表中加入表中的相应行`tag`。

将“表别名”视为表中的*一行*，而不是表本身。这个想法帮助我更好地理解了复杂的连接。

这是我编写该查询的方式：

```
SELECT m.*, u.*, GROUP_CONCAT(DISTINCT x.tag) AS tags
FROM message m
 JOIN `user` u ON (u.id = m.user_id)
 JOIN tag_message_rel r1 ON (m.id = r1.message_id)
 JOIN tag t ON (t.id = r1.tag_id)
 JOIN tag_message_rel r2 ON (m.id = r2.message_id)
 JOIN tag x ON (x.id = r2.tag_id)
WHERE t.tag IN ('kikikiki', 'dsa')
GROUP BY m.id
HAVING COUNT(DISTINCT t.tag) = 2
ORDER BY m.created_at DESC
LIMIT 0 , 20; 
```

您应该养成`JOIN`始终如一地使用语法的习惯。混合`JOIN`和逗号样式的连接可能会导致一些微妙的问题。

这是一个替代查询，它将一些连接拉入一个不相关的子查询中，因此您可以避免 and 之间的笛卡尔积`t`，`x`并消除`DISTINCT`组函数中的修饰符。

```
SELECT m.*, u.*, GROUP_CONCAT(x.tag) AS tags
FROM message m
 JOIN `user` u ON (u.id = m.user_id)
 JOIN tag_message_rel r ON (m.id = r.message_id)
 JOIN tag x ON (x.id = r.tag_id)
WHERE m.id = ANY (
    SELECT m2.id 
    FROM message m2 
     JOIN tag_message_rel r2 ON (m2.id = r2.message_id)
     JOIN tag t ON (t.id = r2.tag_id)
    WHERE t.tag IN ('kikikiki', 'dsa') 
    GROUP BY m2.id 
    HAVING COUNT(t.tag) = 2)
GROUP BY m.id
ORDER BY m.created_at DESC
LIMIT 0 , 20; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T06:32:56.093

你只会得到这两个标签，因为：

1.  t.tag IN（'kikikiki'，'dsa'）。2 t.id IN (id-for-kikikiki, id-for-dsa)
2.  t.id = r.tag_id
3.  r.tag_id = x.id
4.  结合 3 和 4，t.id = x.id
5.  结合一切，x.tag IN ('kikikiki', 'dsa')

我想你想要的是加入第二个`tag_message_rel`。加入`t`第一个；加入`x`第二个；加入他们俩`message`。不完全确定这是您想要的，因为您实际上并没有说...

# java - JSF 1.2 自定义组件 - 来自 Backing Bean 的正文内容

> ID：668862
> 
> 赞同：2
> 
> 时间：2009-03-21T06:29:02.203
> 
> 标签：java, jsf, jakarta-ee, custom-component

我正在使用 JSF 1.2 开发一个自定义组件。我的标签类扩展`UIComponentELTag`并具有类型变量`ValueExpression`。这些值是从标签的相应属性（使用`setProperties`函数）中设置的，例如

```
<sr:show name="#{backingBean.name}" ...> #{backingBean.mainContent}</sr:show> 
```

当我尝试将标签的 bodyContent 作为绑定值时，我被卡住了。这就是我的进展：

```
public int doAfterBody() throws JspException{
    if(bodyContent!=null) {
        String body = bodyContent.getString();
        FacesContext context = FacesContext.getCurrentInstance();
        UIComponent component = super.findComponent(context);
        MyComp myComp= (MyComp) component;
        myComp.setMain(body);
    }
    bodyContent.clearBody();
    return SKIP_BODY;
} 
```

如果标记的主体不包含绑定值，则此代码可以正常工作。我想检查主体是否具有绑定值，然后从 bean 设置值。

在 JSF 1.1 中，我使用`isValueReference(body)`. 我如何在 JSF 1.2 中实现这一点？我在任何地方都找不到任何将正文内容作为绑定值的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T12:01:15.680

为什么不简单地添加另一个变量，例如“内容”并将其绑定到您要呈现的正文？

```
<sr:show name="#{backingBean.name}" text="#{backingBean.mainContent}" /> 
```

或者简单地说：

```
<sr:show bean="#{backingBean} /> 
```

并渲染整个地段。

# c# - 如何在 WPF textBlock 控件中滚动文本？

> ID：668869
> 
> 赞同：3
> 
> 时间：2009-03-21T06:36:56.410
> 
> 标签：c#, wpf

嗨
，我是 WPF 新手，我正在寻找一种在 WPF 应用程序中滚动文本的解决方案，
我尝试了一些动画，但我遇到了剪辑问题
，我在以下位置找到了可能解决我的问题的方法：

[http://social.msdn.microsoft.com/forums/en-US/wpf/thread/8330696e-7715-479e-8027-8d9925579a17/](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/8330696e-7715-479e-8027-8d9925579a17/)

但我不清楚变量 TranslateTransformName、scrollfactor 和 tt 应该是什么。
有人可以看看代码并帮我弄清楚吗？
谢谢

沃利

这是那里的代码：代码块

```
<p class=MsoNoSpacing>&lt;
    <span class=SpellE>Viewbox</span>
    <span class=SpellE>OpacityMask</span> =&quot;{x
    <span
class=GramE>:Null</span> }&quot;
    <span class=SpellE>HorizontalAlignment</span> =&quot;Center&quot;
    <span class=SpellE>VerticalAlignment</span> =&quot;Stretch&quot;
Width=&quot;Auto&quot; Height=&quot;Auto&quot;
    <span class=SpellE>RenderTransformOrigin</span> =&quot;0.5,0.5&quot;
x:Name=&quot;container&quot; Stretch=&quot;Uniform&quot;
    <span class=SpellE>StretchDirection</span> =&quot;Both&quot;&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;
    <span
class=SpellE>Viewbox.RenderTransform</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;
    <span
class=SpellE>TransformGroup</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>ScaleTransform</span>
    <span class=SpellE>ScaleX</span> =&quot;1&quot;
    <span class=SpellE>ScaleY</span> =&quot;1&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>SkewTransform</span>
    <span class=SpellE>AngleX</span> =&quot;0&quot;
    <span class=SpellE>AngleY</span> =&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>RotateTransform</span> Angle=&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>TranslateTransform</span> X=&quot;640&quot;
Y=&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;/
    <span
class=SpellE>TransformGroup</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;/
    <span
class=SpellE>Viewbox.RenderTransform</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;
    <span
class=SpellE>TextBlock</span>
    <span class=SpellE>RenderTransformOrigin</span> =&quot;0.5
    <span
class=GramE>,0.5</span> &quot;
    <span class=SpellE>HorizontalAlignment</span> =&quot;Center&quot;
x:Name=&quot;
    <span class=SpellE>tb</span> &quot;
    <span class=SpellE>VerticalAlignment</span> =&quot;Center&quot;
Width=&quot;Auto&quot; Height=&quot;Auto&quot;
    <span class=SpellE>FontSize</span> =&quot;50&quot;
    <span class=SpellE>TextWrapping</span> =&quot;
    <span class=SpellE>NoWrap</span> &quot;
Background=&quot;{x:Null}&quot; Foreground=&quot;#FFFFFFFF&quot;
Padding=&quot;0,0,0,10&quot; Text=&quot;0&quot;&gt;
</p>

<p class=MsoNoSpacing></p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;
    <span
class=SpellE>TextBlock.RenderTransform</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>TransformGroup</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>ScaleTransform</span>
    <span class=SpellE>ScaleX</span> =&quot;1&quot;
    <span class=SpellE>ScaleY</span> =&quot;1&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>SkewTransform</span>
    <span class=SpellE>AngleX</span> =&quot;0&quot;
    <span class=SpellE>AngleY</span> =&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>RotateTransform</span> Angle=&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;
    <span class=SpellE>TranslateTransform</span> X=&quot;640&quot;
Y=&quot;0&quot;/&gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'>
    </span> &lt;/
    <span class=SpellE>TransformGroup</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;/
    <span
class=SpellE>TextBlock.RenderTransform</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;/
    <span
class=SpellE>TextBlock</span> &gt;
</p>

<p class=MsoNoSpacing>
    <span style='mso-spacerun:yes'></span> &lt;/
    <span
class=SpellE>Viewbox</span> &gt;
</p>

<p class=MsoNoSpacing>
    <o:p>&nbsp;</o:p>
</p>

<p class=MsoNoSpacing>
    <o:p>&nbsp;</o:p>
</p>

<p class=MsoNoSpacing>
    <o:p>&nbsp;</o:p>
</p>

<p class=MsoNoSpacing>
    <o:p>&nbsp;</o:p>
</p> 
```

代码块 private void StartAnimation(object sender, EventArgs e) { tb.Text = news;

```
 MainWindow.UpdateLayout();

        Double timeToTake = (MainWindow.Width + tb.ActualWidth) / scrollfactor;

        this.tb.RenderTransform = tt;
        Storyboard sb = new Storyboard();

        DoubleAnimation daX = new DoubleAnimation(MainWindow.Width, (0.0 - tb.ActualWidth), new Duration(TimeSpan.FromSeconds(timeToTake)));
        daX.RepeatBehavior = RepeatBehavior.Forever;

        Storyboard.SetTargetName(daX, TranslateTransformName);
        Storyboard.SetTargetProperty(daX, new PropertyPath(TranslateTransform.XProperty));
        sb.Children.Add(daX);
        sb.Begin(this.tb);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T07:50:29.497

这是一个完整的示例 - 已验证它有效。我修改[了 Philipsh 在此处发布的源代码](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7a391faa-8607-4c2b-84d4-4ee3bf55a679/)（对控件布局进行了细微更改以使其更美观）

我跳过了 Programming WPF 中的动画章节。所以我无法解释它是如何工作的......这本书不在手边。如果我尝试发布答案，我充其量只是猜测..

XAML

```
<Window x:Class="transforms.Window1" 
    Title="Window2" SizeToContent="WidthAndHeight">
    <DockPanel>
        <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal">
            <TextBox x:Name="txtTexttoScroll">Enter some text to marquee</TextBox>
            <Button x:Name="button1" Click="button1_Click">Start Scrolling</Button>
        </StackPanel>
        <Canvas Name="canvas1" Height="32" ClipToBounds="True" Background="AliceBlue" Width="200">
            <TextBlock Canvas.Left="0" Canvas.Top="0" Height="31" Name="textBlock1" Width="{Binding ElementName=canvas1, Path=ActualWidth}" Text="Have a nice day!" FontSize="18.6666666666667" TextWrapping="NoWrap" VerticalAlignment="Center">  
                <TextBlock.RenderTransform> 
                    <TransformGroup> 
                        <ScaleTransform ScaleX="1" ScaleY="1"/>  
                        <SkewTransform AngleX="0" AngleY="0"/>  
                        <RotateTransform Angle="0"/>  
                        <TranslateTransform x:Name="rtTTransform"/>  
                    </TransformGroup> 
                </TextBlock.RenderTransform> 
            </TextBlock>
        </Canvas>
    </DockPanel>
</Window> 
```

按钮单击事件处理程序

```
private void button1_Click(object sender, RoutedEventArgs e)  
{  
  double textBoxWidth = 10;  

  double pixelXFactor;  
  double canvaswidth = this.canvas1.Width;  
  double negXOffSet = 0;  
  double fromSecValue = 0;  
  double equSlope = 0.022546419;  
  double offSetY = 10.96286472;  
  double stringSize;  

  int textLen = txtTexttoScroll.Text.Length;  

  //Set the width of the text box according to the width (not length) of the text in it.  
  System.Globalization.CultureInfo enUsCultureInfo;  
  Typeface fontTF;  
  FormattedText frmmtText;  
  if (textLen > 0)  
  {  
    enUsCultureInfo = System.Globalization.CultureInfo.GetCultureInfo("en-us");  
    fontTF = new Typeface(this.textBlock1.FontFamily, this.textBlock1.FontStyle, this.textBlock1.FontWeight, this.textBlock1.FontStretch);  
    frmmtText = new FormattedText(txtTexttoScroll.Text, enUsCultureInfo, FlowDirection.LeftToRight, fontTF, this.textBlock1.FontSize, this.textBlock1.Foreground);  

    stringSize = frmmtText.Width;  

    if (stringSize < 100)  
      pixelXFactor = 1.02;  
    else 
      pixelXFactor = 1.01;  

    textBoxWidth = stringSize * pixelXFactor;  

    this.textBlock1.Width = textBoxWidth;  
    negXOffSet = textBoxWidth * -1;        

    fromSecValue = (stringSize * equSlope) + offSetY;             

    this.textBlock1.Text = txtTexttoScroll.Text;  

    Storyboard _sb = new Storyboard();  
    Duration durX = new Duration(TimeSpan.FromSeconds(fromSecValue));  
    DoubleAnimation daX = new DoubleAnimation(canvaswidth, negXOffSet, durX);  
    daX.RepeatBehavior = RepeatBehavior.Forever;  

    Storyboard.SetTargetName(daX, "rtTTransform");  
    Storyboard.SetTargetProperty(daX, new PropertyPath(TranslateTransform.XProperty));  

    _sb.Children.Add(daX);  
    _sb.Begin(this.textBlock1);  
  }  
  else 
  {  
    textBoxWidth = 1;  
    stringSize = 0;  
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T07:45:09.117

[http://jobijoy.blogspot.com/2008/08/wpf-custom-controls-marquee-control.html](http://jobijoy.blogspot.com/2008/08/wpf-custom-controls-marquee-control.html)

您可以检查此 Marquee 控件背后的想法。当您说要滚动 textBlock 内的文本时，请考虑在选取框控件内滚动一个长文本块。这个控件是一个 ContentControl，它可以滚动里面的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-14T21:50:43.067

您可以使用以下代码滚动文本块：

```
 <ScrollViewer Name="myScroll" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Hidden" HorizontalAlignment="Right" Width="414.403" Height="226.645" VerticalAlignment="Bottom">
        <Grid Name="Grid">
            <TextBlock Name="txbReceta" TextWrapping="Wrap"
                       MaxWidth="{Binding ElementName=Grid, Path=ActualWidth}" FontSize="20">
                Twitter is useless. Twitter is useless.
                Twitter is useless. Twitter is useless.
                Twitter is useless. Twitter is useless.
                Twitter is useless. Twitter is useless.
            </TextBlock>

        </Grid>
    </ScrollViewer> 
```

在这种情况下，垂直滚动条被隐藏，您可以放置​​自定义按钮来上下滚动您的文本块。

```
private void btnUp_Click(object sender, RoutedEventArgs e)
{
     myScroll.LineUp();
     myScroll.LineUp();
} 
```

# asp.net-mvc - 哪个更好？asp.net 2.0 坚持使用 isapi 重写或升级到 3.5 并使用 mvc？

> ID：668871
> 
> 赞同：2
> 
> 时间：2009-03-21T06:37:48.000
> 
> 标签：asp.net-mvc, ajax, url-rewriting, asp.net-2.0

我有一个运行 ajax 1.0 扩展和 isapi rewrite 的 asp.net 2.0 web 应用程序。

我有一些错误，我正在考虑是否升级到 3.5 并改用 asp.net mvc。

请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T00:04:16.580

将您的框架版本升级到 .NET 3.5 SP1。使用 System.Web.Routing 命名空间，您将获得 MVC 的 URL 路由功能。您不需要从 WebForms 完全切换到 MVC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T23:59:02.897

如果你喜欢重写你的整个项目，因为一些新的 geewiz 技术出现了，那就去吧（我知道我是）。如果没有，坚持你所拥有的。MVC 框架很棒，但重写代码几乎总是会给你带来更多问题，然后修复你现有的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T07:01:50.737

我会升级到 WebForms 3.5 (.NET 3.5 SP1)。路由已融入 .NET 3.5 SP1。之后，如果你发现你想使用 MVC 的其他一些特性，那么你可以升级。这是一篇[MSDN 杂志文章](http://msdn.microsoft.com/en-us/magazine/2009.01.extremeaspnet.aspx)，可以帮助您入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T12:21:27.707

100% Asp.Net MVC 比 WebForms 好，无论 2.0 还是 3.5。试试看，你就会明白我的意思：）

# php - 服务器日志中出现错误...如何停止？

> ID：668874
> 
> 赞同：0
> 
> 时间：2009-03-21T06:44:52.587
> 
> 标签：php, arrays, foreach, invalid-argument

我遇到了一个错误，我用谷歌搜索了我能想到的所有东西，几乎没有任何见解。也许你可以用一双新的眼睛来帮忙。

我有一个返回对象数组的函数。调用这个函数的代码然后循环遍历这个数组并对每个对象执行它需要做的事情。当它吐出 HTML 时，它似乎在视觉上工作，但服务器日志仍然给出错误“为 foreach() 提供的参数无效”。是的，它在技术上很好用，但我不想再出现这个错误。想法？

```
<?php

// The class whose method returns an array of library_Label objects
class library_Label
{
  public $id = null;
  public $name = null;

  public function getChildren()
  {
    // $children is declared earlier
    return $children;
  }
}

// main code
$columns = new library_Label(1);
foreach ($columns->getChildren() as $label) echo $label->Name;

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T06:49:07.287

你没有说你使用的是什么语言，但这看起来像是一个 PHP 错误。如果是这样，请查看 PHP 的[错误报告级别](http://cn2.php.net/manual/en/function.error-reporting.php)。不过，您可能实际上应该更改 php.ini 中的值，以免将其他错误转储到服务器日志中。

当然，无论如何，您都想知道为什么会抛出该错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T08:02:06.067

`"Invalid argument supplied for foreach()"`当您尝试对`foreach`不是数组的变量执行 a 时，会发生警告。

您需要检查实际的返回值`getChildren()`是否*是*一个数组。

我们无法从您的上下文中看出这一点，因为您既没有提供构造函数源代码，也没有提供实际创建的代码`$children`。如果那即将到来，那么帮助您可能会更容易。

`foreach`您可以尝试的一件事是在执行, with之前打印出返回值`"print_r($columns->getChildren())"`。这应该清楚地表明它是否是一个数组。

我还建议检查数组是否为空，使用`empty()`或`count()`- 网络上的某些站点指出空数组也会导致此警告，但我家里没有 PHP 环境来测试它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T08:29:20.977

这很常见，我的解决方案总是改变它：

```
foreach ($columns->getChildren() as $label) echo $label->Name; 
```

到

```
$children = $columns->getChildren();
if (is_array($children)) foreach ($children as $label) echo $label->Name; 
```

它应该涵盖所有情况。

您也可以将其扩展为带有大括号的完整 if 语句，然后如果您愿意，可以包含一个 else 块来处理孩子为空时的情况。

# vb.net - 代码页值

> ID：668880
> 
> 赞同：1
> 
> 时间：2009-03-21T06:50:42.820
> 
> 标签：vb.net, codepages

除了 1252 之外，vb.net 中的 getencoding() 还可以使用哪些其他代码页值？

System.Text.Encoding.GetEncoding(1252).Getstring()

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-21T06:55:44.307

好吧，您的系统支持的任何代码页。例如，437 是旧的 DOS 代码页之一，而 28591 是 ISO-Latin-1。

这是来自 Microsoft[的代码页列表列表](http://msdn.microsoft.com/en-gb/goglobal/bb964653.aspx)，但您应该使用 Encoding.GetEncodings 来查看您自己的计算机上可用的内容。我怀疑它并不全面——我很确定其中一种 EBCDIC 编码有一个代码页，但我看不到它在那里列出。

通常，尽管您应该知道传入数据所在的代码页，因此您通常不需要知道还有哪些其他代码页可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T06:52:52.787

这取决于平台。请参阅[Encoding.GetEncodings](http://msdn.microsoft.com/en-us/library/system.text.encoding.getencodings.aspx)。

# delphi - Delphi - 在 Windows 中枚举 SATA IO 端口号

> ID：668885
> 
> 赞同：0
> 
> 时间：2009-03-21T06:53:35.310
> 
> 标签：delphi, io, port, pascal, sata

给你一个新的。我准备帮助另一个程序员将​​他的程序从 C# 移植到 Delphi。我不能真正阅读 C#，他也没有在这一点上给我发送实际的源代码，所以从讨论中我认为我将在一个时间点从一个函数处理大部分问题。

我需要能够获取连接到系统的所有 SATA 设备（我相信我的意思是设备）的 IO 端口号。我知道 WMI 不会这样做，所以我不知道从哪里开始。我知道这个应用程序的 C# 版本使用基本上解析注册表的 C# 类。我一直很讨厌直接从注册表中读取。如果可能的话，我觉得从 windows api 或相关信息获取信息在 windows 版本之间更可靠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T07:40:57.053

如果原件正在读取注册表，而您正在移植该功能，那么读取注册表对我来说似乎是一个完全有效的解决方案？

顺便说一句，Delphi 有来自单元 registry.pas 的类 TRegistry。您可以使用它来读取和写入注册表。默认情况下，您要求获得 vista 上的所有权限（读/写..），这可能是一个问题，因此如果您打算只读，请务必打开只读。

关键值：

```
KEY_READ
KEY_WRITE 
KEY_EXECUTE
KEY_ALL_ACCESS 
```

这些实际上是由基本值组成的集合：

```
KEY_QUERY_VALUE       
KEY_SET_VALUE         
KEY_CREATE_SUB_KEY    
KEY_ENUMERATE_SUB_KEYS
KEY_NOTIFY     
KEY_CREATE_LINK
KEY_WOW64_32KEY
KEY_WOW64_64KEY
KEY_WOW64_RES 
```

# c# - 端口启用和禁用

> ID：668889
> 
> 赞同：2
> 
> 时间：2009-03-21T06:58:29.667
> 
> 标签：c#

如何启用和禁用 USB 端口。我需要在不使用 devcon.exe 的情况下实现这一目标

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T07:04:58.747

1.  [如何禁用和启用 USB 端口](http://technofriends.in/2008/02/11/how-to-disable-and-re-enable-usb-storage-devices/)。本文教您如何弄乱注册表以进行启用和禁用，因此您只需要为此[编写 C# 脚本](http://www.switchonthecode.com/tutorials/csharp-snippet-tutorial-editing-the-windows-registry)。

# xml - MSXML4 线程安全吗？

> ID：668890
> 
> 赞同：1
> 
> 时间：2009-03-21T06:58:40.867
> 
> 标签：xml, msxml

我想知道如果我在一个线程中创建 Msxml2.FreeThreadedDOMDocument.4.0 的实例，我可以使用原始指针从不同的线程安全地操作该实例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T17:10:00.767

是的。这就是 FreeThreadedDOMDocument 的重点。

引用：[IXMLDOMDocument/DOMDocument](http://msdn.microsoft.com/en-us/library/ms756987(VS.85).aspx)

> 如果您正在编写单线程应用程序（或一次只有一个线程访问 DOM 的多线程应用程序），那么您应该使用租用线程模型（Msxml2.DOMDocument.3.0、Msxml2.DOMDocument.4.0 或 Msxml2 .DOMDocument.6.0)。如果您正在编写一个应用程序，其中多个线程访问将同时访问一个 DOM，那么您应该使用自由线程模型（Msxml2.FreeThreadedDOMDocument.3.0、Msxml2.FreeThreadedDOMDocument.4.0 或 Msxml2.FreeThreadedDOMDocument.6.0）。

# php - 如何添加登录/注销功能并在没有sql的情况下注册

> ID：668892
> 
> 赞同：0
> 
> 时间：2009-03-21T06:59:23.580
> 
> 标签：php

我正在学习 PHP，主要关心的是向我的网站添加活动，但我不知道 SQL。有没有办法在没有 SQL 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T07:22:54.163

您可能可以使用平面文件 - 唯一关心的可能是并行添加新帐户。但是如果你想深入挖掘网站开发，SQL 绝对是不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T07:23:58.030

对于快速而肮脏的解决方案，您可以将用户凭据存储在数组中，例如：

```
$creds = array( 
               array( 'username' => 'john123',
                      'password' => 'hello'),
               array( 'username' => 'lucyliu',
                      'password' => 'dieblackmamba')
                   //more sub arrays like above here
         ); 
```

然后，您可以匹配用户的输入，例如：

```
$username = $_POST['username'];
$password = $_POST['password'];

$match = false;
for($i=0;$i<count($creds);$i++) {
    if(strcmp($username,$creds[$i]['username']) == 0) {
        if(strcmp($password,$creds[$i]['password']) == 0) {               
            // start session and set something to indicate that user is logged in
            session_start();
            $_SESSION['authenticated'] = true;
            $_SESSION['username'] = $creds[$i]['username'];
            $match = true;    
        }
    }
}

if($match) echo 'Login successful: welcome ' . $creds[$i]['username'];
    else echo 'Invalid credentials'; 
```

编辑：在随后的页面调用中，您可以通过阅读 $_SESSION 来检查用户是否仍然登录

```
session_start();
if($_SESSION['authenticated'] === true) {
     echo 'User ' . $_SESSION['username'] . ' is logged in.';
} 
```

要注销用户，您可以执行以下代码：

```
 $_SESSION = array();
    // If it's desired to kill the session, also delete the session cookie.
    // Note: This will destroy the session, and not just the session data!
    if (isset($_COOKIE[session_name()])) {
        setcookie(session_name(), '', time()-42000, '/');
    }
    // Finally, destroy the session.
    session_destroy(); 
```

[阅读有关 php会话](http://php.net/session)和[数组](http://php.net/array)的信息会对您有所帮助，如果我是您，我会咬紧牙关尝试进入 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T07:50:41.460

检查会话处理的工作原理[http://us.php.net/session](http://us.php.net/session)，这样你可以保存你的用户对象。

只需将会话保存在单服务器环境中即可，在多服务器环境中，您需要将会话保存到数据库等公共位置，但对于更简单的页面和学习，只需保存到会话即可

# windows - Windows 相当于 Unix 上的文件 .netrc？

> ID：668894
> 
> 赞同：4
> 
> 时间：2009-03-21T07:02:20.343
> 
> 标签：windows, unix, ftp

在 Unix 上，我们可以在 ~/.netrc 文件中指定 ftp 用户名/密码，下一次以后，只要该机器的凭据存在于 ~/.netrc 文件中，就不需要在 ftp 到任何机器时指定用户名/密码。

这非常有帮助，特别是如果您需要登录多台机器，可以说是出于监控目的。

任何人都可以建议在 Windows 上是否有任何等价物？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T07:25:51.503

如果您可以摆脱 FTP 并改用 SFTP，那么您可以使用[公钥身份验证](http://sial.org/howto/openssh/publickey-auth/)并将您的公钥（位于`~/.ssh/id_rsa.pub`）存储在`~/.ssh/authorized_keys`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-21T07:28:05.073

我不知道 Windows FTP 客户端具有与 UNIX .netrc 文件类似的功能（虽然我以前错了，只是问妻子 :-)。

我一直让我的脚本将用户名和密码存储在一个安全文件中，并使用`-n`and`-s`选项即时构建一个同样安全的命令脚本`ftp`，例如：

```
ftp -n -sgo.ftpcmds machine.com 
```

并且 go.ftpcmds 包含（具有适当的`<username>`和值`<password>`）：

```
user <username> <password>
ascii
get myfile.txt
quit 
```

这使我可以自动执行各种 FTP 任务。如果您想为交互式任务自动登录，只需`quit`在最后去掉 - 它会让您保持登录状态。

我不确定我是否理解您对使用 FTP 登录和监控日志文件的评论——您肯定会使用 telnet 及其兄弟登录，而不是为此目的使用 FTP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-01T01:18:48.377

这是Windows自带的FTP客户端的一个缺点。还有很多其他适用于 Windows 的 FTP 客户端允许您保存密码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-04T09:08:24.717

Windows 在 %HOME% 环境中使用 _netrc。只需将文件名从 .netrc 更改为 _netrc。

# asp.net - 如何在 asp.net flash control 中显示 swf 文件？

> ID：668906
> 
> 赞同：1
> 
> 时间：2009-03-21T07:19:08.713
> 
> 标签：asp.net

我已经使用 asp.net flash control 在 asp.net 中显示 flash 文件，但它对我不起作用。

这是我使用的代码：

```
<ASPNetFlash:Flash ID="Flash1" runat="server" PlayerVersionAutoDetect="true"    
                                                  MovieURL="flash/cube.swf">
     <HTMLAlternativeTemplate>
                    <asp:ImageButton ID="ImageButtonGetFlashPlayer" runat="server"     PostBackUrl="http://www.adobe.com/go/getflashplayer" ImageUrl="http://www.aspnetflash.com/images/get_flash_player.gif" />
     </HTMLAlternativeTemplate>
</ASPNetFlash:Flash> 
```

我使用的flash文件是版本9，但是flash control却试图显示版本10。有什么问题吗？否则，你能建议最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T07:32:21.847

一个例子

```
 <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0"
                                        width="200" height="100">
                                        <param name="movie" value="<% =swfFileName%>" />
                                        <param name="quality" value="high" />
                                        <embed src="<% =swfFileName%>" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer"
                                            type="application/x-shockwave-flash" width="200" height="100"></embed> 
```

# c# - 如何从 C# 中的文本文件中删除一行？

> ID：668907
> 
> 赞同：52
> 
> 时间：2009-03-21T07:19:30.880
> 
> 标签：c#, text-files

我有一个问题：如何从 C# 中的文本文件中删除一行？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-03-21T07:29:25.210

对于*非常*大的文件，我会做这样的事情

```
string tempFile = Path.GetTempFileName();

using(var sr = new StreamReader("file.txt"))
using(var sw = new StreamWriter(tempFile))
{
    string line;

    while((line = sr.ReadLine()) != null)
    {
         if(line != "removeme")
             sw.WriteLine(line);
    }
}

File.Delete("file.txt");
File.Move(tempFile, "file.txt"); 
```

**更新**我最初是在 2009 年写的，我认为更新可能会很有趣。[今天你可以使用LINQ 和延迟执行](http://blogs.msdn.com/b/charlie/archive/2007/12/09/deferred-execution.aspx)来完成上述任务

```
var tempFile = Path.GetTempFileName();
var linesToKeep = File.ReadLines(fileName).Where(l => l != "removeme");

File.WriteAllLines(tempFile, linesToKeep);

File.Delete(fileName);
File.Move(tempFile, fileName); 
```

上面的代码与第一个示例几乎完全相同，逐行读取，同时在内存中保留最少量的数据。

但是，免责声明可能是正确的。由于我们在这里讨论的是文本文件，因此您很少需要将磁盘用作中间存储介质。如果您不处理非常大的日志文件，那么将内容读入内存应该没有问题，并且避免处理临时文件。

```
File.WriteAllLines(fileName, 
    File.ReadLines(fileName).Where(l => l != "removeme").ToList()); 
```

请注意，`.ToList`此处对于强制立即执行至关重要。另请注意，所有示例都假定文本文件是 UTF-8 编码的。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-21T07:24:12.443

读取文件，删除内存中的行并将内容放回文件（覆盖）。如果文件很大，您可能希望逐行读取它，并创建一个临时文件，然后替换原始文件。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-21T07:26:30.177

我同意 John Saunders 的观​​点，这并不是 C# 特定的。但是，要回答您的问题：您基本上需要重写文件。有两种方法可以做到这一点。

*   将整个文件读入内存（例如使用`File.ReadAllLines`）
*   删除有问题的行（在这种情况下，将字符串数组转换为 a`List<string>`然后删除该行可能是最简单的）
*   写回所有其余的行（例如使用`File.WriteAllLines`） - 可能`List<string>`再次使用将其转换为字符串数组`ToArray`

这意味着你必须知道你有足够的内存。替代：

*   打开输入文件和新的输出文件（作为`TextReader`/ `TextWriter`，例如使用`File.OpenText`and `File.CreateText`）
*   读取一行 ( `TextReader.ReadLine`) - 如果您不想删除它，请将其写入输出文件 ( `TextWriter.WriteLine`)
*   当你读完所有行时，关闭阅读器和作者（如果你`using`对两者都使用语句，这将自动发生）
*   如果您想用输出替换输入，请删除输入文件，然后将输出文件移动到位。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-05-29T09:42:58.927

要从文本文件中删除项目，首先将所有文本移动到列表中，然后删除您想要的任何项目。然后将存储在列表中的文本写入文本文件：

```
List<string> quotelist=File.ReadAllLines(filename).ToList();
string firstItem= quotelist[0];
quotelist.RemoveAt(0);
File.WriteAllLines(filename, quotelist.ToArray());
return firstItem; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-04-14T15:06:22.047

我扩展了 Markus Olsson 的建议，并提出了这个添加多个搜索字符串和几个事件的类：

```
public static class TextLineRemover
{
    public static void RemoveTextLines(IList<string> linesToRemove, string filename, string tempFilename)
    {
        // Initial values
        int lineNumber = 0;
        int linesRemoved = 0;
        DateTime startTime = DateTime.Now;

        // Read file
        using (var sr = new StreamReader(filename))
        {
            // Write new file
            using (var sw = new StreamWriter(tempFilename))
            {
                // Read lines
                string line;
                while ((line = sr.ReadLine()) != null)
                {
                    lineNumber++;
                    // Look for text to remove
                    if (!ContainsString(line, linesToRemove))
                    {
                        // Keep lines that does not match
                        sw.WriteLine(line);
                    }
                    else
                    {
                        // Ignore lines that DO match
                        linesRemoved++;
                        InvokeOnRemovedLine(new RemovedLineArgs { RemovedLine = line, RemovedLineNumber = lineNumber});
                    }
                }
            }
        }
        // Delete original file
        File.Delete(filename);

        // ... and put the temp file in its place.
        File.Move(tempFilename, filename);

        // Final calculations
        DateTime endTime = DateTime.Now;
        InvokeOnFinished(new FinishedArgs {LinesRemoved = linesRemoved, TotalLines = lineNumber, TotalTime = endTime.Subtract(startTime)});
    }

    private static bool ContainsString(string line, IEnumerable<string> linesToRemove)
    {
        foreach (var lineToRemove in linesToRemove)
        {
            if(line.Contains(lineToRemove))
                return true;
        }
        return false;
    }

    public static event RemovedLine OnRemovedLine;
    public static event Finished OnFinished;

    public static void InvokeOnFinished(FinishedArgs args)
    {
        Finished handler = OnFinished;
        if (handler != null) handler(null, args);
    }

    public static void InvokeOnRemovedLine(RemovedLineArgs args)
    {
        RemovedLine handler = OnRemovedLine;
        if (handler != null) handler(null, args);
    }
}

public delegate void Finished(object sender, FinishedArgs args);

public class FinishedArgs
{
    public int TotalLines { get; set; }
    public int LinesRemoved { get; set; }
    public TimeSpan TotalTime { get; set; }
}

public delegate void RemovedLine(object sender, RemovedLineArgs args);

public class RemovedLineArgs
{
    public string RemovedLine { get; set; }
    public int RemovedLineNumber { get; set; }
} 
```

用法：

```
TextLineRemover.OnRemovedLine += (o, removedLineArgs) => Console.WriteLine(string.Format("Removed \"{0}\" at line {1}", removedLineArgs.RemovedLine, removedLineArgs.RemovedLineNumber));
TextLineRemover.OnFinished += (o, finishedArgs) => Console.WriteLine(string.Format("{0} of {1} lines removed. Time used: {2}", finishedArgs.LinesRemoved, finishedArgs.TotalLines, finishedArgs.TotalTime.ToString()));
TextLineRemover.RemoveTextLines(new List<string> { "aaa", "bbb" }, fileName, fileName + ".tmp"); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-03-19T16:02:29.183

我写了一个从文件中删除行的方法。

该程序使用`using System.IO`.

查看我的代码：

```
void File_DeleteLine(int Line, string Path)
{
    StringBuilder sb = new StringBuilder();
    using (StreamReader sr = new StreamReader(Path))
    {
        int Countup = 0;
        while (!sr.EndOfStream)
        {
            Countup++;
            if (Countup != Line)
            {
                using (StringWriter sw = new StringWriter(sb))
                {
                    sw.WriteLine(sr.ReadLine());
                }
            }
            else
            {
                sr.ReadLine();
            }
        }
    }
    using (StreamWriter sw = new StreamWriter(Path))
    {
        sw.Write(sb.ToString());
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-21T08:17:09.040

我很简单：

*   打开文件进行读/写
*   阅读/查找它，直到您要删除的行的开头
*   将写指针设置为当前读指针
*   通读到我们要删除的行尾并跳过换行符分隔符（计算我们走的字符数，我们称之为 nline）
*   逐字节读取并将每个字节写入文件
*   完成后将文件截断为 (orig_length - nline)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-08-31T14:55:39.997

我意识到这已经很长时间了，但这对我有帮助，所以我想改进它。Leonhard 的回答对我非常有用。但是，如果您的文本文件真的像我的一样大，StringBuilder 将给出内存不足错误。所以我改为这样使用它。创建一个新文件并写入其中。然后，您可以根据需要删除第一个文件。请注意， Line 变量确定文件将被删除到哪一行。您可以对其进行修改以指定要删除的行的间隔。

```
void File_DeleteLine(int Line, string Path, string newPath)
{
    StreamReader reader = new StreamReader(Path);
    StreamWriter writer = new StreamWriter(newPath);
    int Countup = 0;
    while (!reader.EndOfStream)
    {
        Countup++;
        if (Countup > Line)
        {

            writer.WriteLine(reader.ReadLine());

        }
        else
        {
            reader.ReadLine();
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-11T01:49:42.397

```
string fileIN = @"C:\myTextFile.txt";
string fileOUT = @"C:\myTextFile_Out.txt";
if (File.Exists(fileIN))
{
    string[] data = File.ReadAllLines(fileIN);
    foreach (string line in data)
        if (!line.Equals("my line to remove"))
            File.AppendAllText(fileOUT, line);
    File.Delete(fileIN);
    File.Move(fileOUT, fileIN);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-16T15:14:56.450

**从多个文件中删除一段代码**

为了扩展@Markus Olsson 的答案，我需要从多个文件中删除一段代码。我在核心项目中遇到瑞典字符问题，因此我需要安装 System.Text.CodePagesEncodingProvider nuget 包并使用 System.Text.Encoding.GetEncoding(1252) 而不是 System.Text.Encoding.UTF8。

```
 public static void Main(string[] args)
    {
        try
        {
            var dir = @"C:\Test";
            //Get all html and htm files
            var files = DirSearch(dir);
            foreach (var file in files)
            {
                RmCode(file);
            }
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
            throw;
        }

    }

    private static void RmCode(string file)
    {
        string tempFile = Path.GetTempFileName();

        using (var sr = new StreamReader(file, Encoding.UTF8))
        using (var sw = new StreamWriter(new FileStream(tempFile, FileMode.Open, FileAccess.ReadWrite), Encoding.UTF8))
        {
            string line;

            var startOfBadCode = "<div>";
            var endOfBadCode = "</div>";
            var deleteLine = false;

            while ((line = sr.ReadLine()) != null)
            {
                if (line.Contains(startOfBadCode))
                {
                    deleteLine = true;
                }
                if (!deleteLine)
                {
                    sw.WriteLine(line);
                }

                if (line.Contains(endOfBadCode))
                {
                    deleteLine = false;
                }
            }
        }

        File.Delete(file);
        File.Move(tempFile, file);
    }

    private static List<String> DirSearch(string sDir)
    {
        List<String> files = new List<String>();
        try
        {
            foreach (string f in Directory.GetFiles(sDir))
            {
                files.Add(f);
            }
            foreach (string d in Directory.GetDirectories(sDir))
            {
                files.AddRange(DirSearch(d));
            }
        }
        catch (System.Exception excpt)
        {
            Console.WriteLine(excpt.Message);
        }

        return files.Where(s => s.EndsWith(".htm") || s.EndsWith(".html")).ToList();
    } 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-05-31T21:09:04.223

为什么不能用这个？首先，创建一个数组：

```
string[] lines = File.ReadAllLines(openFileDialog1.FileName); 
```

然后查找您需要删除的行并将其替换为 "" ：

```
lines[x].Replace(lines[x], ""); 
```

完毕！

# php - 通过常规网页链接传递变量和数据？

> ID：668920
> 
> 赞同：6
> 
> 时间：2009-03-21T07:36:20.153
> 
> 标签：php, javascript, html

我正在处理一个页面，当点击链接时我试图提交数据。我已经知道如何使用 javascript 按钮使用 POST 和 GET 来执行此操作，但是当我使用 HTML 链接时如何获得相同的效果？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-21T07:45:50.410

如果您有一个普通链接，您可以将它们作为链接上的查询参数传递（这是一个 GET 操作）

```
<a href="/myapp/somecontroller.php?id=17&name=fred">Save</a> 
```

如果您有一个没有 javascript 的纯 HTML 表单来处理按钮按下，您可以将内容放在隐藏字段中

```
<form name="theform" method="post" action="/myapp/somecontroller.php">
<input type="hidden" name="id" value="17">
<input type="hidden" name="name" value="fred">
 ...
</form> 
```

这不需要任何javascript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T08:03:44.503

您可以使用**GET**或**POST**将数据传递到另一个页面。

请注意，在传递数据时，您必须考虑其目的。如果传递数据不会导致您的应用程序发生任何变化，您应该使用**GET**。否则，您应该使用**POST**。

例如，如果您有一个用户管理页面。当您只显示用户详细信息时，您应该使用**GET**因为它没有进行任何类型的更改：`http://www.mywebsite.com/user.php?user=10`.

但是，如果用户更改了他们的详细信息，您应该使用**POST**，因为它正在更改用户的数据：

```
<form name="userDetails" method="post" action="saveChanges.php">
   <input type="text" name="firstName" value="" />
   <input type="submit" value="save"/>
</form> 
```

或者，您也可以使用**Cookies**。您可以将数据保存到可在整个 Web 应用程序中使用的 cookie 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T00:18:09.153

我不完全清楚你在问什么，但这听起来像：

您知道如何使用 POST 和 GET（也称为 HTML 表单）在页面之间传递数据。您正在使用 Javascript 按钮。

“Javascript 按钮”有两种解释：

你在做类似的事情

```
(1) <input type="submit" onclick="doSomething();" value="Save my data" />
(2) <input type="button" onclick="doSomething();" value="Save my data"  />
(3) <button onclick="doSomething();">Save my data</button> 
```

或者类似的东西

```
(4) <input type="submit" value="Save my data" /> 
```

1、2 和 3 是使用 javascript 使按钮执行操作的示例。（“Javascript 按钮”）。4 是一个标准的 HTML FORM 按钮——没有使用 Javascript；标准的 HTML 表单行为将导致按钮将数据提交到 FORM 标记中指定的任何页面（类似于`<form method="get" action="datacollection.php">`）。

现在，要了解的是 POST/GET 是在网页之间（在浏览器和服务器之间）发送数据的方式。发送数据的过程可以由 HTML（`<a>`链接）、Javascript（调用 URL 或触发 FORM 提交的函数）或 FORM 元素等触发`<input type="submit" />`。

我无意冒犯，但您提出问题的方式让我认为您并没有试图找出不同的格式来将数据传输到接收页面（正如其他海报所讨论的那样），并弄清楚如何解析cookie 值或遍历您的表单字段以创建查询字符串将非常具有挑战性。

所以这里有一些选择：

1.  如果您的表单已经使用 Javascript 提交表单（上面的案例 1、2 或 3），您只需将相同的 onclick 部分添加到 HTML 链接：

    保存我的数据

函数 submitMyForm 可能看起来像这样：

```
function submitMyForm() {
  // Get the form object -- you can also do this with the document.form array
  var myForm = document.getElementById( 'userdata' );
  // use the submit method of the form object
  myForm.submit();

} 
```

因此，总而言之，您将向普通的 HTML 锚链接添加一个 javascript 行为（“事件处理程序”）。一个注意事项——一般来说，用户期望规则“链接去地方，按钮做事”。这不是一个硬性规定，但是当按钮用于提交表单数据之类的事情时，人们通常会更快乐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T07:43:56.283

您可以添加一个查询字符串： 像这样的东西：

```
<a href="page.php?id=1&display=asdf">text</a> 
```

这样，您可以将其作为查询字符串变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T23:52:21.790

如果要将数据值从一个普通的 .html 页面传递到另一个页面，可以使用以下技术：

*   将数据值存储在 cookie 中*   将值存储在可重写属性 window.name 中*   将值作为查询字符串附加到目标页面的 URL*   将值存储在另一个框架的 JavaScript 变量中（如果您使用框架）

    上述技术的一个很好的演示在 JavaScript FAQ 集合中 - 请参阅将 [参数传递到页面](http://www.javascripter.net/faq/passingp.htm)。

# sql - 外键是指跨多个表的主键？

> ID：668921
> 
> 赞同：96
> 
> 时间：2009-03-21T07:36:42.850
> 
> 标签：sql, foreign-keys, primary-key

我有两个表，即employees_ce 和employees_sn 数据库employees 下。

它们都有各自唯一的主键列。

我有另一个名为 deductions 的表，我想引用employees_ce 和employees_sn 的主键的外键列。这可能吗？

例如

```
employees_ce
--------------
empid   name
khce1   prince

employees_sn
----------------
empid   name
khsn1   princess 
```

那么这可能吗？

```
deductions
--------------
id      name
khce1   gold
khsn1   silver 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-03-21T09:13:14.367

假设我已经正确理解了您的情况，这就是我所说的*正确*方法：

从您的数据库的更高级别描述开始！您有员工，员工可以是“ce”员工和“sn”员工（无论是什么）。在面向对象的术语中，有一个类“employee”，有两个子类，分别称为“ce employee”和“sn employee”。

然后将这个更高级别的描述转换为三个表`employees`：`employees_ce`和`employees_sn`：

*   `employees(id, name)`
*   `employees_ce(id, ce-specific stuff)`
*   `employees_sn(id, sn-specific stuff)`

由于所有员工都是员工（呃！），因此每个员工都会在`employees`表格中占一行。“ce”员工在`employees_ce`表中也有一行，“sn”员工在表中也有一行`employees_sn`。`employees_ce.id`是 的外键`employees.id`，就像`employees_sn.id`是一样。

要提及任何类型的员工（ce 或 sn），请参阅该`employees`表。也就是说，您遇到问题的外键应该引用该表！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-21T07:46:38.007

您可能可以添加两个外键约束（老实说：我从未尝试过），但它会坚持父行存在于两个表中。

相反，您可能希望为您的两个员工子类型创建一个超类型，然后将外键指向那里。（当然，假设您有充分的理由将这两种员工分开）。

```
 employee       
employees_ce     ————————       employees_sn
————————————     type           ————————————
empid —————————&gt; empid <——————— empid
name               /|\          name
                    |  
                    |  
      deductions    |  
      ——————————    |  
      empid ————————+  
      name 
```

`type`在员工表中将是`ce`或`sn`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-01-10T16:48:18.480

其实这是我自己做的。我有一个名为“评论”的表，其中包含其他 3 个表中记录的评论。这两种解决方案实际上都无法处理您可能想要的所有内容。在你的情况下，你会这样做：

**解决方案1：**

1.  在employees_ce 和employees_sn 中添加一个tinyint 字段，该字段的默认值在每个表中都不同（该字段表示“表标识符”，因此我们将它们称为tid_ce & tid_sn）

2.  使用表的 PK 和表 id 字段在每个表上创建唯一索引。

3.  在您的“扣除”表中添加一个 tinyint 字段以存储外键的后半部分（表 ID）

4.  在您的“扣除”表中创建 2 个外键（您不能强制执行参照完整性，因为一个键将是有效的，或者另一个键是有效的......但绝不是两者都有效：

    ```
    ALTER TABLE [dbo].[Deductions]  WITH NOCHECK ADD  CONSTRAINT [FK_Deductions_employees_ce] FOREIGN KEY([id], [fk_tid])
    REFERENCES [dbo].[employees_ce] ([empid], [tid])
    NOT FOR REPLICATION 
    GO
    ALTER TABLE [dbo].[Deductions] NOCHECK CONSTRAINT [FK_600_WorkComments_employees_ce]
    GO
    ALTER TABLE [dbo].[Deductions]  WITH NOCHECK ADD  CONSTRAINT [FK_Deductions_employees_sn] FOREIGN KEY([id], [fk_tid])
    REFERENCES [dbo].[employees_sn] ([empid], [tid])
    NOT FOR REPLICATION 
    GO
    ALTER TABLE [dbo].[Deductions] NOCHECK CONSTRAINT [FK_600_WorkComments_employees_sn]
    GO

    employees_ce
    --------------
    empid    name     tid
    khce1   prince    1

    employees_sn
    ----------------
    empid    name     tid 
    khsn1   princess  2

    deductions
    ----------------------
    id      tid       name  
    khce1   1         gold
    khsn1   2         silver         
    ** id + tid creates a unique index ** 
    ```

**解决方案 2：** 此解决方案允许维护引用完整性： 1\. 在“Deductions”表中创建第二个外键字段，允许两个外键中的 Null 值，并创建普通外键：

```
 employees_ce
    --------------
    empid   name
    khce1   prince 

    employees_sn
    ----------------
    empid   name     
    khsn1   princess 

    deductions
    ----------------------
    idce    idsn      name  
    khce1   *NULL*    gold
    *NULL*  khsn1     silver 
```

仅当列不为空时才检查完整性，因此您可以保持引用完整性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-04-28T18:04:32.050

我知道这是一个长期停滞的话题，但如果有人在这里搜索，我会如何处理多表外键。使用这种技术，您没有任何 DBA 强制级联操作，因此请确保您`DELETE`在代码中处理此类。

```
Table 1 Fruit
pk_fruitid, name
1, apple
2, pear

Table 2 Meat
Pk_meatid, name
1, beef
2, chicken

Table 3 Entity's
PK_entityid, anme
1, fruit
2, meat
3, desert

Table 4 Basket (Table using fk_s)
PK_basketid, fk_entityid, pseudo_entityrow
1, 2, 2 (Chicken - entity denotes meat table, pseudokey denotes row in indictaed table)
2, 1, 1 (Apple)
3, 1, 2 (pear)
4, 3, 1 (cheesecake) 
```

SO Op 的示例看起来像这样

```
deductions
--------------
type    id      name
1      khce1   gold
2      khsn1   silver

types
---------------------
1 employees_ce
2 employees_sn 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-21T07:42:31.107

技术上可行。您可能会在扣减和employees_sn 中引用employees_ce。但是为什么不合并employees_sn 和employees_ce？我看不出你有两张桌子的理由。没有一对多的关系。并且（不在此示例中）许多列。

如果您对一列进行两次引用，则员工**必须**在两个表中都有一个条目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-21T07:43:41.400

对的，这是可能的。您将需要为第三张桌子定义 2 个 FK。每个 FK 指向一个表的必填字段（即每个外部表 1 个 FK）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-10T21:42:03.807

假设由于某种原因您必须为两种员工类型提供两个表，我将扩展 vmarquez 的答案：

架构：

```
employees_ce (id, name)
employees_sn (id, name)
deductions (id, parentId, parentType, name) 
```

扣减数据：

```
deductions table
id      parentId      parentType      name
1       1             ce              gold
2       1             sn              silver
3       2             sn              wood
... 
```

这将允许您将扣除项指向架构中的任何其他表。数据库级约束 IIRC 不支持这种关系，因此您必须确保您的应用程序正确管理约束（如果您有多个不同的应用程序/服务访问同一个数据库，这会变得更加麻烦）。

# flash - 如何访问在 for 循环内创建的动态剪辑内的文本字段/电影剪辑？

> ID：668923
> 
> 赞同：0
> 
> 时间：2009-03-21T07:38:50.070
> 
> 标签：flash, actionscript-2

我正在创建一个从特定源读取 XML 文件的 Flash 应用程序。XML 文件最多包含 5 个节点，每个节点包含名称、描述和图像 URL。

为了表示每个节点中的数据，我创建了一个包含另一个影片剪辑（从 url 加载图像）、一个短动态文本框（用于名称）和一个长动态文本框（用于描述）的影片剪辑。

在代码中，我可以通过 -

new_mc.myname.text = "一些文字"; new_mc.image_mc.loadMovie("path_to_image");

只要我使用 duplicateMovie() 并使用实例名称“new_mc”就可以了

我的问题从循环开始......

因为我可以在 for 循环中读取 XML 节点，所以我想我只是动态地创建影片剪辑并访问其中的所有对象。

因此，在 for 循环中，我创建了一个实例，例如-

```
 myform.duplicateMovie("new_mc"+i,i) 
```

但我无法访问使用实例名称 =“new_mc”+ i 创建的电影

如何访问新创建的影片剪辑实例，如 new_mc0、new_mc1、new_mc3、...

以便我可以访问其中的对象？

由于您有足够的经验，因此解决方案可能对您来说足够简单，但我是这里的新手，请求帮助:)

祝大家有美好的一天！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T14:01:37.887

我几乎从未在 AS2 中使用过 duplicateMovie() 方法，但如果这是您的选择，您可以像这样访问它们：

```
this["new_mc"+i]; 
```

否则，一个好的做法是始终引用您的实例以更好地控制它：

```
var forms:Array = new Array();

for(...)
   forms[i] =  myform.duplicateMovie("new_mc"+i,i);

...

forms[2].myname.text = "hello"; 
```

*   首先我会建议你使用 AS3，但你仍然使用 AS2 可能是有原因的......
*   第二件事，在 AS2 中创建实例，在库中定义 MovieClips 并使用 attachMovie(); 会更加顺畅。创建实例的方法。

# testing - 您是否可以在不明确使用“assertEquals”的情况下编写 Junit 样式单元测试，异常未通过测试

> ID：668933
> 
> 赞同：1
> 
> 时间：2009-03-21T07:45:13.097
> 
> 标签：testing, junit, mocking

我注意到一些单元测试，比如在你设置对象和测试但没有明确使用断言方法的 spring 框架中。

从本质上讲，您是否有例外。

这是单元测试吗？这是要避免的吗？例如，这里有一些来自 Spring 框架的测试。没有断言子句，只是一个测试。

```
public void testNeedsJoinPoint() {
    mockCollaborator.needsJoinPoint("getAge");
    mockControl.replay();
    testBeanProxy.getAge();
    mockControl.verify();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T07:54:22.623

您展示的测试充满了期望，但它们是用模拟对象表示的。

有些测试可能完全没有断言，但我仍然可以接受，例如一个简单地加载 spring 上下文并（隐式）断言其有效性的测试。我真的认为问题应该是它是否是一个*好的*测试。有时它可能是，有时它只是你能得到的最好的。它可能往往比没有好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T07:26:48.100

每个异常都让测试失败。因此，您可以使用自己的异常来破坏您的单元测试。
如果您阅读源代码，a`assertXXX`将向 TestRunner 抛出异常。所以单元测试是建立在异常之上的。

嘲讽绝对是无可避免的。这很好，因为它*可能会*鼓励隔离您的测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T17:53:19.133

如果您担心，请尝试破解代码以确保测试有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T09:34:07.607

我称之为“冒烟测试”并且经常这样做。

这就像运行你的引擎并断言没有烟雾，即没有抛出异常。就个人而言，我认为这种风格很好（但是，嘿，我也是提倡依赖测试的人：）

# asp.net - 自定义 ASP.net 服务器控件 - 渲染

> ID：668936
> 
> 赞同：2
> 
> 时间：2009-03-21T07:48:18.783
> 
> 标签：asp.net, controls

我目前正在 ASP.net 中编写自定义服务器控件。我的想法是创建某种可折叠的面板控件（顺便说一句，这是我正在编写的第一个服务器控件）。所以我想要的是用户在页面中以这种方式定义我的控件：

```
<myCtrl:CollapsiblePanel id="myCollapsiblePanel" runat="server">
   <asp:Label id="lblTest" runat="server" Text="Test Label:"/>
   <asp:TextBox id="txbTest" runat="server"/>
</myCtrl:CollapsiblePanel> 
```

然后控件应呈现在最终页面上，如下所示：

```
<div id="myCollapsiblepanel">
   <input type="submit" name="btnExpand" value="Expand/Collapse" id="btnExpand" />
    <div id="pnlContent"> 
       <span id="lblTest">Title:</span> 
       <input name="txbTest" type="text" id="txbTest" /> 
    </div>
</div> 
```

提交按钮“btnExpand”在控件上有一个事件处理程序，它隐藏/显示面板“pnlContent”。我的第一种方法是创建一个继承自 Panel 的服务器控件。在 CollapsiblePanel 控件中，我创建了另一个面板“pnlContent”。在 OnInit 我做了如下的事情：

```
protected override void OnInit(EventArgs e)
{
   for (int i = 0; i < base.Controls.Count; i++)
   {
       Control control = base.Controls[i];
       content.Controls.Add(control);
   }
   base.Controls.Clear();

   base.Controls.Add(button);
   base.Controls.Add(content);
} 
```

我基本上采用了当前存在于我的控件中的所有控件，并将它们添加到内部创建的 Panel pnlContent 的控件列表中。此外，我添加了一个按钮，该按钮然后执行 pnlContent 的扩展/折叠。我的问题是渲染无法正常工作。按钮和 pnlContent 正确呈现，只是 pnlContent 内的控件未显示。输出如下

```
<div id="myCollapsiblepanel">
   <input type="submit" name="btnExpand" value="Expand/Collapse" id="btnExpand" />
    <div id="pnlContent"> </div>
</div> 
```

pnlContent 是空的......有人可以建议我解决这个问题和/或我在渲染中做错了什么。我没有覆盖我继承的面板的默认呈现，因为我认为这不应该是必要的，因为我在 OnInit 中修改了它的控制结构，所以它应该呈现我的修改..

目前我找到了解决方案。我基本上按照 Microsoft Ajax Control 工具包中最常见的方式进行操作。我创建了一个所谓的“扩展器”，它不会呈现自身，而只是添加行为。所以现在我将要折叠的面板的 id 添加到我的 CollapsiblePanelExtender 控件中，然后它会完成折叠/展开的工作。也许这也是更好、更清洁的解决方案，但我仍然想知道我之前描述的第一种方法出了什么问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T20:10:40.463

发生这种情况是因为在任何给定时刻，控件只能属于一个父级。当您将控件从一个集合添加到另一个集合时，它会自动从第一个集合中删除。在你的情况下：

```
for (int i = 0; i < Controls.Count; i++)
{
   //obtain a reference
   Control control = Controls[i];
   //The control is removed from Controls collection 
   //and added to content.Controls. All remaining controls get shifted left.
   //This means that next control will get skipped.
   content.Controls.Add(control);
} 
```

考虑执行以下操作（顺便说一下，在这种情况下您可能不需要使用*base*）：

```
Control[] controls = new Control[Controls.Count];
Controls.CopyTo(controls, 0); //create a snapshot of controls

for (int i = 0; i < controls.Length; i++)
    content.Controls.Add(controls[i]); 
```

或使用反向加法：

```
Control[] controls = new Control[Controls.Count];
for (int i = Controls.Count - 1; i >= 0; i--) //walk backwards
    controls[i] = Controls[i];

for (int i = 0; i < controls.Length; i++)
    content.Controls.Add(controls[i]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T09:14:06.657

弄乱 Controls 集合，尤其是在 Control 容器之间删除和交换控件并不总是有效。

您是否特别不想在回发之前呈现内容？为什么不渲染控件并将它们包装在 CSS 上带有 a 的 div 中`display:none`，然后可以使用 jQuery 之类的简单工具在客户端交换？

例如

```
<myCtrl:CollapsiblePanel id="myCollapsiblePanel" runat="server" Text="Panel title">
   <asp:Label id="lblTest" runat="server" Text="Test Label:"/>
   <asp:TextBox id="txbTest" runat="server"/>
</myCtrl:CollapsiblePanel> 
```

您可能应该在 CreateChildControls 重载中创建应用它：

```
protected override CraeteChildControls() 
{
    Controls.Add(new LiteralControl("<"+"h1>"+Text+"<a onclick=\"expandPanel\">[+]</a></h1>"));    
    Panel panel=new Panel();
    // add controls in collapsable panel to panel here
    Controls.Add(panel);
} 
```

翻译为：

```
<div id="ctl00_etc_myCollapsiblePanel">
   <h1>Panel title <a onclick="expandPanel">[+]</a></h1>
   <div id="childPanel" style="display:none">
      <label id="ctl_00_etc">Test Label</label>
      <input ... />
   </asp:Panel>
</div> 
```

和一些 jQuery（或类似的）附加到`<a>`：

```
function expandPanel() {
    $('<%=childPanel.ClientID %>').css('display','block');
} 
```

当然，所有这些都是伪代码。

# windows - windows下添加或扩展文件系统支持

> ID：668940
> 
> 赞同：1
> 
> 时间：2009-03-21T07:55:37.360
> 
> 标签：windows, filesystems, driver, wdk

我已经看到[Mac Drive 7](http://www.mediafour.com/products/macdrive/)为硬盘和 CD 的 Windows 添加了 HFS+ 和 HFS 支持，其中包括处理诸如 mac 分区格式之类的问题。显然，这一定意味着 Windows 中的文件系统支持可以以某种方式扩展，即使速度很慢。那么有人可以从哪里开始为 Windows 编写一个简单（或不）的文件系统驱动程序？我在谷歌上搜索时遇到了很多麻烦，因为这些是常用词。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-21T08:16:56.157

您需要[Windows 驱动程序工具包](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)(WDK)。作为 WDK 一部分的可安装文件系统工具包应该可以帮助您入门[。](http://www.microsoft.com/whdc/devtools/ifskit/default.mspx)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T06:43:28.217

IFS 实际上主要允许您编写文件系统过滤器驱动程序。它不直接包含对新文件系统的支持。这样做是*必要*的，但您需要从第三方获取大量额外的、复杂的、难以找到的有关 Windows 文件系统的信息。

请注意，文件系统驱动程序是您可以在 Windows 内核中执行的最复杂、未记录的操作。如果您之前没有内核经验，但您说有十年的 C 操作系统编程经验，那么您正在寻找两到三年的全职工作来制作文件系统驱动程序。

# delphi - D2010 Beta：支持多核的完美方式

> ID：668943
> 
> 赞同：3
> 
> 时间：2009-03-21T08:00:59.253
> 
> 标签：delphi, parallel-processing, delphi-2010, multicore

在我之前[关于](https://stackoverflow.com/questions/665143/delphi-2010-beta-whats-on-your-wishlist)新 D2010 的预期功能的问题中，评分最高的答案之一是“多核支持”。

好吧，众所周知，Delphi 自 D2 (IIRC) 以来就支持线程编程，并且在某些领域被大量使用。更具体地说，在您看来，哪一种是在 Delphi 中支持并行编程的完美方式？（但不仅如此——我们不要把这个问题完全与德尔福联系起来）。

就我个人而言，我倾向于看到一种组合方法会起作用，具体取决于情况：线程（无论如何我们都有）、actor 模型和基于任务的方法（实际上接近于 actor 模型）。

此外，恕我直言，研究一种视觉建模工具来描述演员之间的互动会非常有趣。

也非常欢迎使用可视化调试器（可能与上述工具相同）。

一些参考资料：

*   [关于多核编程的一般性讨论](https://stackoverflow.com/questions/121674/multi-core-and-concurrency-languages-libraries-and-development-techniques)

*   [关于并行编程的讨论](https://stackoverflow.com/questions/79999/what-parallel-programming-model-do-you-recommend-today-to-take-advantage-of-the)

*   [Allen Bauer 谈德尔福并行库](http://blogs.embarcadero.com/abauer/category/parallel-programming)

你的意见会是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T09:09:19.430

至少在语法上使其与 Delphi Prism 中的异步调用兼容。

# asp.net-mvc - ASP.NET MVC：使用编辑操作时如何获取实际对象？

> ID：668944
> 
> 赞同：1
> 
> 时间：2009-03-21T08:01:34.023
> 
> 标签：asp.net-mvc

我刚开始玩asp.net mvc，我有一个非常基本的问题：

如果我有一个显示有关信息的视图，`System.Web.Mvc.ViewPage<Foo>`当将表单值传递给我的 FooController 上的编辑操作时，如何获取实际对象？默认情况下，我得到了 Edit 操作的这个实现：

```
public ActionResult Edit(int id, FormCollection collection) 
```

有什么办法可以让我再次像这样超载吗？

```
public ActionResult Edit(int id, Foo myObject) 
```

谢谢。

编辑：

对不起，伙计们，只是多一点背景知识，所以你明白我在想做什么......因为我有自己的框架来重播我对实体所做的更改，我不需要重新查询我的实体和使用 UpdateModel() 方法。我最终做的只是有一个这样的方法：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(Foo myObject)
{
} 
```

我不知道，但这工作得很好。感谢导致我发表这篇文章的答案：[http ://www.haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://www.haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T08:57:37.073

您可能会编写一些疯狂的类型转换器，但是有一些辅助方法可以将 FormCollection 中的值映射到您的 Foo 对象。

编辑：我认为它实现为扩展方法，称为 UpdateFrom(..)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T11:12:39.073

实现编辑方法的最简单方法是使用已包含在 Controller 基类中的 UpdateModel 方法，如下所示：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, FormCollection collection)
{

    LinqEntity entity = MyRepository.GetEntity(id);
    UpdateModel(entity);

    //validate and save your entity here

} 
```

编辑：我也刚刚开始学习 ASP.NET MVC，发现[ScottGu 的 MVC Walkthrough](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)非常有用。它展示了如何实现一个简单的 MVC 网站（您可以在 nerddinner.com 上看到它），并涵盖了许多像上面一样的普通主题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T12:04:43.830

相关问题：
[如何使用 json 将复杂类型传递给 ASP.NET MVC 控制器](https://stackoverflow.com/questions/267707/how-to-pass-complex-type-using-json-to-asp-net-mvc-controller)

这可能会满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T12:11:43.550

如果您需要查看操作方法，请访问[nerddinner.com](http://nerddinner.com)并下载源代码。该站点由 Scott Gu、Phil Haack 和其他人开发，用于展示如何进行 MVC...

# java - 用逗号分隔列表的最简单方法？

> ID：668952
> 
> 赞同：106
> 
> 时间：2009-03-21T08:06:29.160
> 
> 标签：java, pretty-print

在 Java 中用逗号分隔列表的最清晰方法是什么？

我知道几种方法，但我想知道最好的方法是什么（“最好”意味着最清晰和/或最短，而不是最有效的。

我有一个列表，我想遍历它，打印每个值。我想在每个项目之间打印一个逗号，但不是在最后一个之后（也不在第一个之前）。

```
List --> Item ( , Item ) *
List --> ( Item , ) * Item 
```

示例解决方案 1：

```
boolean isFirst = true;
for (Item i : list) {
  if (isFirst) {
    System.out.print(i);        // no comma
    isFirst = false;
  } else {
    System.out.print(", "+i);   // comma
  }
} 
```

示例解决方案 2 - 创建子列表：

```
if (list.size()>0) {
  System.out.print(list.get(0));   // no comma
  List theRest = list.subList(1, list.size());
  for (Item i : theRest) {
    System.out.print(", "+i);   // comma
  }
} 
```

示例解决方案 3：

```
 Iterator<Item> i = list.iterator();
  if (i.hasNext()) {
    System.out.print(i.next());
    while (i.hasNext())
      System.out.print(", "+i.next());
  } 
```

这些特别对待第一项；可以改为特殊对待最后一个。

顺便说一下，这是`List` `toString` *Java* 1.6 中的实现方式（继承自`AbstractCollection`）：

```
public String toString() {
    Iterator<E> i = iterator();
    if (! i.hasNext())
        return "[]";

    StringBuilder sb = new StringBuilder();
    sb.append('[');
    for (;;) {
        E e = i.next();
        sb.append(e == this ? "(this Collection)" : e);
        if (! i.hasNext())
            return sb.append(']').toString();
        sb.append(", ");
    }
} 
```

它提前退出循环以避免最后一项之后的逗号。顺便说一句：这是我记得第一次看到“（这个集合）”；这是激发它的代码：

```
List l = new LinkedList();
l.add(l);
System.out.println(l); 
```

我欢迎任何解决方案，即使他们使用了意想不到的库（正则表达式？）；以及除 Java 之外的其他语言的解决方案（例如，我认为 Python/Ruby 有一个*intersperse*函数——它是如何*实现*的？）。

*澄清*：我所说的库是指标准的 Java 库。对于其他库，我认为它们与其他语言一起使用，并且有兴趣了解它们是如何实现的。

*EDIT*工具包提到了一个类似的问题：[Java 中增强 for 循环的最后一次迭代](https://stackoverflow.com/questions/285523/last-iteration-of-for-loop-in-java)

另一个： [循环中的最后一个元素是否值得单独处理？](https://stackoverflow.com/questions/156650/does-the-last-element-in-a-loop-deserve-a-separate-treatment)

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-03-21T11:44:02.320

# Java 8 及更高版本

使用[`StringJoiner`](https://docs.oracle.com/javase/8/docs/api/java/util/StringJoiner.html)类和[`forEach`](https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html#forEach-java.util.function.Consumer-)方法：

```
StringJoiner joiner = new StringJoiner(",");
list.forEach(item -> joiner.add(item.toString());
return joiner.toString(); 
```

使用[`Stream`](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html), 和[`Collectors`](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html):

```
return list.stream().
       map(Object::toString).
       collect(Collectors.joining(",")).toString(); 
```

# Java 7 及更早版本

另请参阅[#285523](https://stackoverflow.com/questions/285523/last-iteration-of-for-loop-in-java/285628#285628)

```
String delim = "";
for (Item i : list) {
    sb.append(delim).append(i);
    delim = ",";
} 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-03-21T08:31:12.127

```
org.apache.commons.lang3.StringUtils.join(list,","); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-09-02T13:26:32.183

Java 8 提供了几种新方法来做到这一点：

*   上的[`join`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.CharSequence...-)方法`String`。
*   来自类的流的[`joining`](http://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html#joining--)收集器。`Collectors`
*   [`StringJoiner`](http://docs.oracle.com/javase/8/docs/api/java/util/StringJoiner.html)班级。

例子：

```
// Util method for strings and other char sequences
List<String> strs = Arrays.asList("1", "2", "3");
String listStr1 = String.join(",", strs);

// For any type using streams and collectors
List<Object> objs = Arrays.asList(1, 2, 3);
String listStr2 = objs.stream()
    .map(Object::toString)
    .collect(joining(",", "[", "]"));

// Using the new StringJoiner class
StringJoiner joiner = new StringJoiner(", ", "[", "]");
joiner.setEmptyValue("<empty>");
for (Integer i : objs) {
  joiner.add(i.toString());
}
String listStr3 = joiner.toString(); 
```

使用流的方法假设`import static java.util.stream.Collectors.joining;`.

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-08-31T01:11:07.763

```
Joiner.on(",").join(myList) 
```

[细木工](http://guava-libraries.googlecode.com/svn/tags/release09/javadoc/com/google/common/base/Joiner.html)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-21T16:10:07.860

如果您使用 Spring 框架，则可以使用[StringUtils](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/util/StringUtils.html)：

```
public static String arrayToDelimitedString(Object[] arr)
public static String arrayToDelimitedString(Object[] arr, String delim)
public static String collectionToCommaDelimitedString(Collection coll)
public static String collectionToCommaDelimitedString(Collection coll, String delim) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-21T11:04:34.803

基于 Java 的 List toString 实现：

```
Iterator i = list.iterator();
for (;;) {
  sb.append(i.next());
  if (! i.hasNext()) break;
  ab.append(", ");
} 
```

它使用这样的语法：

```
List --> (Item , )* Item 
```

通过基于最后而不是基于第一个，它可以使用相同的测试来检查跳过逗号以检查列表末尾。我认为这个非常优雅，但我不确定清晰度。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-05-09T13:49:18.600

使用 Java 8 有一个很好的方法来实现这一点：

```
List<String> list = Arrays.asList(array);
String joinedString = String.join(",", list); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-21T08:25:36.620

```
for(int i=0, length=list.size(); i<length; i++)
  result+=(i==0?"":", ") + list.get(i); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-27T16:42:05.740

```
String delimiter = ",";
StringBuilder sb = new StringBuilder();
for (Item i : list) {
    sb.append(delimiter).append(i);
}
sb.toString().replaceFirst(delimiter, ""); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-10-26T20:41:11.423

foreach 循环的一种选择是：

```
StringBuilder sb = new StringBuilder();
for(String s:list){
  if (sb.length()>0) sb.append(",");
  sb.append(s);
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-21T08:12:48.693

```
StringBuffer result = new StringBuffer();
for(Iterator it=list.iterator; it.hasNext(); ) {
  if (result.length()>0)
    result.append(", ");
  result.append(it.next());
} 
```

**更新**：正如 Dave Webb 在评论中提到的，如果列表中的第一项是空字符串，这可能不会产生正确的结果。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-21T12:38:00.617

我通常这样做：

```
StringBuffer sb = new StringBuffer();
Iterator it = myList.iterator();
if (it.hasNext()) { sb.append(it.next().toString()); }
while (it.hasNext()) { sb.append(",").append(it.next().toString()); } 
```

虽然我想我会根据 Java 实现从现在开始进行这项检查；）

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-21T15:53:40.940

如果您可以使用 Groovy（在 JVM 上运行）：

```
def list = ['a', 'b', 'c', 'd']
println list.join(',') 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-21T19:32:44.580

[（从这里](https://stackoverflow.com/questions/285523/last-iteration-of-for-loop-in-java/669806#669806)复制我自己的答案。）恕我直言，这里描述的许多解决方案都有些过头了，尤其是那些依赖外部库的解决方案。有一个很好的干净、清晰的习惯用法来实现我一直使用的逗号分隔列表。它依赖于条件 (?) 运算符：

**编辑**：原始解决方案正确，但根据评论不是最佳的。第二次尝试：

```
int[] array = {1, 2, 3};
StringBuilder builder = new StringBuilder();
for (int i = 0 ;  i < array.length; i++)
       builder.append(i == 0 ? "" : ",").append(array[i]); 
```

就这样，在 4 行代码中，包括数组的声明和 StringBuilder。

**第二次编辑**：如果您正在处理迭代器：

```
 List<Integer> list = Arrays.asList(1, 2, 3);
    StringBuilder builder = new StringBuilder();
    for (Iterator it = list.iterator(); it.hasNext();)
        builder.append(it.next()).append(it.hasNext() ? "," : ""); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-21T08:16:42.210

我通常使用类似于版本 3 的东西。它运行良好 c/c++/bash/...：P

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-21T13:17:55.463

这很短，很清楚，但给我的感觉带来了令人毛骨悚然的恐惧。适应不同的分隔符也有点尴尬，特别是如果是字符串（不是字符）。

```
for (Item i : list)
  sb.append(',').append(i);
if (sb.charAt(0)==',') sb.deleteCharAt(0); 
```

灵感来源：[Java 中增强 for 循环的最后一次迭代](https://stackoverflow.com/questions/285523/last-iteration-of-for-loop-in-java/669221#669221)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-22T05:57:42.503

我没有编译它......但应该可以工作（或接近工作）。

```
public static <T> String toString(final List<T> list, 
                                  final String delim)
{
    final StringBuilder builder;

    builder = new StringBuilder();

    for(final T item : list)
    {
        builder.append(item);
        builder.append(delim);
    }

    // kill the last delim
    builder.setLength(builder.length() - delim.length());

    return (builder.toString());
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-23T00:42:00.443

```
StringBuffer sb = new StringBuffer();

for (int i = 0; i < myList.size(); i++)
{ 
    if (i > 0) 
    {
        sb.append(", ");
    }

    sb.append(myList.get(i)); 
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-23T15:18:36.517

我有点喜欢这种方法，这是我前段时间在博客上发现的。不幸的是，我不记得博客的名称/网址。

您可以创建一个如下所示的实用程序/帮助程序类：

```
private class Delimiter
{
    private final String delimiter;
    private boolean first = true;

    public Delimiter(String delimiter)
    {
        this.delimiter = delimiter;
    }

    @Override
    public String toString()
    {
        if (first) {
            first = false;
            return "";
        }

        return delimiter;
    }
} 
```

使用辅助类很简单，如下所示：

```
StringBuilder sb = new StringBuilder();
Delimiter delimiter = new Delimiter(", ");

for (String item : list) {
    sb.append(delimiter);
    sb.append(item);
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-02-10T13:15:35.957

我喜欢这个解决方案：

```
String delim = " - ", string = "";

for (String item : myCollection)
    string += delim + item;

string = string.substring(delim.length()); 
```

我认为它也可以使用 StringBuilder 。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-02-10T13:21:09.197

因为您的分隔符是“,”，所以您可以使用以下任何一种：

```
public class StringDelim {

    public static void removeBrackets(String string) {
        System.out.println(string.substring(1, string.length() - 1));
    }

    public static void main(String... args) {
        // Array.toString() example
        String [] arr = {"Hi" , "My", "name", "is", "br3nt"};
        String string = Arrays.toString(arr);
        removeBrackets(string);

        // List#toString() example
        List<String> list = new ArrayList<String>();
        list.add("Hi");
        list.add("My");
        list.add("name");
        list.add("is");
        list.add("br3nt");
        string = list.toString();
        removeBrackets(string);

        // Map#values().toString() example
        Map<String, String> map = new LinkedHashMap<String, String>();
        map.put("1", "Hi");
        map.put("2", "My");
        map.put("3", "name");
        map.put("4", "is");
        map.put("5", "br3nt");
        System.out.println(map.values().toString());
        removeBrackets(string);

        // Enum#toString() example
        EnumSet<Days> set = EnumSet.allOf(Days.class);
        string = set.toString();
        removeBrackets(string);
    }

    public enum Days {
        MON("Monday"),
        TUE("Tuesday"),
        WED("Wednesday"),
        THU("Thursday"),
        FRI("Friday"),
        SAT("Saturday"),
        SUN("Sunday");

        private final String day;

        Days(String day) {this.day = day;}
        public String toString() {return this.day;}
    }
} 
```

如果您的分隔符是其他任何东西，那么这对您不起作用。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-11-22T19:53:58.420

在我看来，这是最容易阅读和理解的：

```
StringBuilder sb = new StringBuilder();
for(String string : strings) {
    sb.append(string).append(',');
}
sb.setLength(sb.length() - 1);
String result = sb.toString(); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-03-21T08:11:46.277

在 Python 中很容易

",".join(你的名单)

在 C# 中，String 类有一个静态方法

String.Join(",", yourlistofstrings)

抱歉，不确定Java，但当您询问其他语言时，我想我会尽力而为。我敢肯定Java中会有类似的东西。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-03-21T09:32:42.730

您也可以无条件地添加分隔符字符串，并在循环结束后删除多余的分隔符。然后开头的“如果列表为空则返回此字符串”将允许您避免最后的检查（因为您无法从空列表中删除字符）

所以问题真的是：

“给定一个循环和一个 if，你认为将它们组合在一起最清晰的方法是什么？”

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-03-22T07:31:12.747

```
if (array.length>0)          // edited in response Joachim's comment
  sb.append(array[i]);
for (int i=1; i<array.length; i++)
  sb.append(",").append(array[i]); 
```

基于[逗号分隔列表（Java）的最清晰方式？](https://stackoverflow.com/questions/668952/clearest-way-to-comma-delimit-a-list-java/669831#669831)

使用这个想法： [循环中的最后一个元素是否值得单独处理？](https://stackoverflow.com/questions/156650/does-the-last-element-in-a-loop-deserve-a-separate-treatment)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-09-07T18:53:35.007

```
public static String join (List<String> list, String separator) {
  String listToString = "";

  if (list == null || list.isEmpty()) {
   return listToString;
  }

  for (String element : list) {
   listToString += element + separator;
  }

  listToString = listToString.substring(0, separator.length());

  return listToString;
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2011-11-22T15:39:35.077

```
public String toString(List<Item> items)
{
    StringBuilder sb = new StringBuilder("[");

    for (Item item : items)
    {
        sb.append(item).append(", ");
    }

    if (sb.length() >= 2)
    {
        //looks cleaner in C# sb.Length -= 2;
        sb.setLength(sb.length() - 2);
    }

    sb.append("]");

    return sb.toString();
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-03-12T20:36:49.893

到目前为止，没有一个答案使用递归......

```
public class Main {

    public static String toString(List<String> list, char d) {
        int n = list.size();
        if(n==0) return "";
        return n > 1 ? Main.toString(list.subList(0, n - 1), d) + d
                  + list.get(n - 1) : list.get(0);
    }

    public static void main(String[] args) {
        List<String> list = Arrays.asList(new String[]{"1","2","3"});
        System.out.println(Main.toString(list, ','));
    }

} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-10-28T14:02:32.553

```
private String betweenComma(ArrayList<String> strings) {
    String united = "";
    for (String string : strings) {
        united = united + "," + string;
    }
    return united.replaceFirst(",", "");
} 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2016-09-29T05:47:10.847

## 方法

```
String join(List<Object> collection, String delimiter){
    StringBuilder stringBuilder = new StringBuilder();
    int size = collection.size();
    for (Object value : collection) {
        size --;
        if(size > 0){
            stringBuilder.append(value).append(delimiter);
        }
    }

    return stringBuilder.toString();
} 
```

## 用法

给定数组 [1,2,3]

```
join(myArray, ",") // 1,2,3 
```

# java - Java嵌入式小程序页面安全，如何满足要求？

> ID：668958
> 
> 赞同：1
> 
> 时间：2009-03-21T08:11:42.267
> 
> 标签：java, security, connection, localhost

如果我在网页中嵌入了一个小程序，并且我希望它连接到服务器端软件（也是用 Java 编写的），我该如何在运行本地主机的 Windows 机器上正确执行此操作？我是否必须从`localhost`目录中运行 java 应用程序并从浏览器（即`localhost/applet.html`）访问 applet HTML？

据我了解，如果您没有正确设置所有内容，由于 Java 的安全要求，您将无法连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T08:49:19.103

您必须运行一个网络服务器（一个[非常简单](http://en.wikipedia.org/wiki/Tiny_web_servers)的服务器）并通过它访问带有小程序的页面。

# startup - 面试前给候选人面试问题

> ID：668960
> 
> 赞同：6
> 
> 时间：2009-03-21T08:12:25.683
> 
> 标签：startup

在接下来的几个月里，我将面试一个由创意/开发人员组成的小团队。我正在考虑让每个候选人根据我们的想法进行简短的介绍，这样我就知道他们得到了我们想要实现的目标。当然，我们会在实际面试之前传达所有这些信息，并给他们一周左右的时间来准备。

有没有人从雇主或候选人的角度有过这方面的经验，什么有效，什么无效。请注意，面试过程的这一部分不是技术性的，而是关于了解我们业务的大局。

为了加强这个问题的编程性质，你如何确保你的新编码员工得到企业想要实现的目标？技术技能很重要，但在我们的情况下，他们还需要了解我们的市场和产品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-21T08:52:16.960

你需要的不是一个了解你的市场/产品/大局的人，你需要的是*能够理解它的人*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-21T09:51:36.490

我实际上认为这是一个很好的问题。有几种看待这个的方法。

首先，这可能是负面的，原因有一个：在正常的采访中，你可以做的一件事是从谷壳中挑选小麦，问问他们对你的公司和行业了解多少。优秀的候选人——那些热衷于为你工作并且通常渴望和好奇的人——会查找你并至少访问你的网站（如果你有的话）并找出你在做什么。因此，通过提前询问他们，您将失去了解他们采取多少主动性的机会。当然，您可以在其他领域弥补这一点，例如通过询问一个理性的人可能已经查过的书外问题。

另一个潜在的负面因素是，通常很难从外部了解一个行业、业务或产品。例如，我从事股票经纪工作，直到你到达这样的地方，你才能看到所有不同的团队（例如新客户、合规、结算、客户、呼叫中心等），并了解他们的工作以及他们为什么这样做。如果不参与其中，了解文化也很困难。

所以 Brann 是对的，因为你需要一个能够理解它的人，而不是真正能理解它的人。您可能会排除会很快接手您的业务的优秀潜在员工。

话虽如此，我喜欢你提出的问题。强迫候选人考虑这样的事情是个好主意。也许您可以将焦点缩小到业务的单个方面，这在通常长达一小时的采访中更容易消化。这也将使您有机会了解他们在原始问题范围之外采取了多少举措。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-03T08:07:26.287

您的方法有几点好处：

1.  你给他们的任务就像他们需要做的一样。
2.  你不是在寻找廉价的方法来摆脱人。
3.  你给他们一些具体的准备。

你可以用出人意料的问题来测试候选人，以了解他们的个性，但在实际工作中，他们似乎总是有时间想出答案，所以现场的才华并不是一项重要的技能。

在解释他们的答案时，我会提防一个陷阱：通过寻找与您“了解”的人“在同一页上”，您可能会鼓励集体思考。更多地考虑他们构成“好”推销的标准 - 不一定是在直觉上打击*你*，而是表现出独创性或文字方式等。

关于您问题的最后一句话，还有其他需要考虑的地方。*任何人都*应该不难了解您的业务。电梯里的陌生人应该在五秒钟内理解你的音调。因此，如果那些拼命关注你的人没有得到它，那就需要努力了。

最后一件事：就像 Cletus 所说，“得到它”可能会随着时间的推移而出现。如果你能在个人层面上与开发人员相处，他们对业务的看法可能会成熟。两个月后，他们“啊哈！” 时刻给你一个重要的洞察力。试着弄清楚他们是否是那种*可能*对你的业务目标感兴趣的人，而不是他们是否擅长伪装。

# gcc - gcc -ggdb 和 gcc -g 有什么区别

> ID：668962
> 
> 赞同：110
> 
> 时间：2009-03-21T08:13:01.953
> 
> 标签：gcc, gdb

当我使用 gcc 编译 C 程序时，我通常使用`-g`将一些调试信息放入 elf 文件中，以便 gdb 可以在需要时帮助我。

但是，我注意到有些程序使用`-ggdb`, 因为它应该使调试信息对 gdb 更友好。

它们有何不同，推荐使用哪个？

* * *

*注意：*调试程序或 GCC 选项的链接，[http ://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Debugging-Options](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Debugging-Options)

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-02-11T11:58:41.337

`-g`并且`-ggdb`相似但有一些*细微*差别，我[在这里](http://gcc.gnu.org/ml/gcc-help/2009-02/msg00130.html)读到：

> `-g`以操作系统的本机格式（stabs、COFF、XCOFF 或 DWARF 2）生成调试信息。
> 
> `-ggdb`生成专门用于 gdb 的调试信息。
> 
> `-ggdb3`产生额外的调试信息，例如：包括宏定义。
> 
> `-ggdb`本身没有指定级别默认为`-ggdb2`（即，gdb 为级别 2）。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-21T08:40:37.550

可能没有区别 - 取决于操作系统本机格式以及您希望调试信息的可移植性。请参阅 GCC 手册[调试选项](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Debugging-Options.html#Debugging-Options)。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-07-09T20:54:00.410

我至少有一个例子，其中 -ggdb 对我来说比我们使用的另一种调试选项更好：

```
amitkar@lohgad:~> cat > main.c
#include <stdio.h>

int main(int argc, char **argv)
{
        printf("Args :%d\n", argc);
        for ( ;argc > 0;)
                printf("%s\n", argv[--argc]);

        return 0;
}
amitkar@lohgad:~> gcc -gstabs+ main.c -o main

amitkar@lohgad:~> file main
main: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), for GNU/Linux 2.6.4, dynamically linked (uses shared libs), not stripped
amitkar@lohgad:~> /usr/bin/gdb ./main
GNU gdb 6.6.50.20070726-cvs
Copyright (C) 2007 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "x86_64-suse-linux"...
Using host libthread_db library "/lib64/libthread_db.so.1".
(gdb) break main
Breakpoint 1 at 0x400577: file main.c, line 5.
(gdb) run
Starting program: /home/amitkar/main

Breakpoint 1, main (argc=Cannot access memory at address 0x8000df37d57c
) at main.c:5
5               printf("Args :%d\n", argc);
(gdb) print argc
Cannot access memory at address 0x8000df37d57c
(gdb) 
```

注意：这只发生在 x86-64 机器上，并且在使用 -ggdb 编译时会消失。但即使使用 -gstabs+，较新版本的调试器也能正常工作

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-21T08:17:38.103

一件事是“-g”是可移植的（例如在注定要在非GNU平台上执行的Makefile中）。我最近在 AIX 机器上遇到了关于 -g 与 -ggdb 的可移植性问题，这就是我提出它的原因。

不过，不知道 -ggdb 在可用性方面增加了什么。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-02-25T21:29:20.233

这是官方的解释： http: [//gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Debugging-Options](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Debugging-Options)

只有几个确凿的事实，但无论如何都很有趣。

# c# - 从 C# 获取数据到 Excel 03/07

> ID：668965
> 
> 赞同：1
> 
> 时间：2009-03-21T08:15:11.387
> 
> 标签：c#, .net, excel, interop

我有大量使用 C# 应用程序处理的实时数据的文件。处理数据后，它使用特定模板在 Excel 中呈现。

今天使用 Interop 解决了这个问题。我必须说我并没有完全对整个互操作情况感到震惊。我是否必须以某种方式在每个最终用户终端上手动安装互操作功能？它如何处理 2003/2007 版本的混合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T09:10:27.527

如果您知道 Excel 文档的结构（并且假设您不想要 Excel 文档中的复杂宏/函数/等），您可以使用 Excel XML 格式生成 XML。**我不是指 OpenXML，我指的是 Excel 在 2007 年之前使用的 XML 格式。**

我在这里介绍如何做到这一点：[http ://www.aaron-powell.com//blog/september-2008/linq-to-xml-to-excel.aspx](http://www.aaron-powell.com//blog/september-2008/linq-to-xml-to-excel.aspx)

Interop 的问题在于它并不是真正为生成硬核文档而设计的。如果您尝试进行大量文档处理，您可能会遇到锁

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T08:35:51.493

我一直使用[FileHelpers](http://filehelpers.sourceforge.net/)。您不必对 Excel 安装做任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T08:38:43.280

我们使用运行良好的[SyncFusion](http://www.syncfusion.com/products/xlsio/backoffice/default.aspx)。也很容易使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T06:20:36.123

不知道你在做什么，但你可以通过 ADO.NET 读写 Excel 文件。这不是互操作，也不是 XML 文件处理。 [例子](http://cheeso.members.winisp.net/srcview.aspx?dir=data&file=excel-adonet.cs)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-26T15:54:18.410

如果您可以使用 Excel 2007 格式使用[Office Open XML SDK ，您可以在](http://www.microsoft.com/downloads/details.aspx?FamilyID=c6e744e5-36e9-45f5-8d8c-331df206e0d0&DisplayLang=en)[此处](http://msdn.microsoft.com/en-us/library/bb508943.aspx)找到示例。我用于一些开发，如果你必须从头开始创建文件，一开始有点棘手，但如果你有一个模板，那么它就更容易了。它速度很快，不需要在服务器中安装 excel。

# python - 扩展 Python 的问题（链接错误）？

> ID：668971
> 
> 赞同：0
> 
> 时间：2009-03-21T08:23:00.213
> 
> 标签：python, c, visual-studio, visual-studio-2008, linker

我已经安装了 Python 3k(C:\Python30) 和 Visual Studio Professional Edition 2008。

我正在研究**[这个](http://en.wikibooks.org/wiki/Python_Programming/Extending_with_C)。**

这里有一个问题：

```
C:\hello>dir
 Volume in drive C has no label.
 Volume Serial Number is 309E-14FB

 Directory of C:\hello

03/21/2009  01:15 AM    <DIR>          .
03/21/2009  01:15 AM    <DIR>          ..
03/21/2009  01:14 AM               481 hellomodule.c
               1 File(s)            481 bytes
               2 Dir(s)  10,640,642,048 bytes free

C:\hello>cl /LD hellomodule.c /Ic:\Python30\include c:\Python30\libs\python30.lib /link/out:hello.
dll
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

hellomodule.c
c:\hello\hellomodule.c(26) : warning C4716: 'inithello' : must return a value
Microsoft (R) Incremental Linker Version 9.00.21022.08
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:hellomodule.dll
/dll
/implib:hellomodule.lib
/out:hello.dll
hellomodule.obj
c:\Python30\libs\python30.lib
   Creating library hellomodule.lib and object hellomodule.exp
hellomodule.obj : error LNK2019: unresolved external symbol _Py_InitModule referenced in function
_inithello
hello.dll : fatal error LNK1120: 1 unresolved externals

C:\hello> 
```

问题是什么？请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T08:27:59.077

如果 Python 安装在 中`c:\python30`，您为什么要在中搜索库`c:\Python24\libs\python30`？

现在你已经改变了问题来解决这个问题:-)，

我认为不再`Py_InitModule`可用，您必须使用`PyModule_Create`（这可能自 Py3k 的早期测试版以来发生了变化，这是我最后一次查看）。

根据您的评论，David，我建议您避免使用官方 Python 文档之外的 HowTo 网站（我怀疑它们已经过时了）。在 3.0 级别的扩展界面上进行了大量工作，最好的查看位置是[3.0 文档](http://docs.python.org/3.0/extending/extending.html)或[3.1 alpha 文档](http://docs.python.org/dev/3.0/extending/extending.html)。

具体的 Windows 构建说明在[此处](http://docs.python.org/3.0/extending/windows.html)。

# model-view-controller - Web MVC 应用程序的推荐数据结构/格式？

> ID：668980
> 
> 赞同：1
> 
> 时间：2009-03-21T08:34:02.510
> 
> 标签：model-view-controller, web-applications

什么是用于 MVC Web 应用程序的好的数据结构，用于将数据传递到视图中以确保标准化并尽可能保持视图对非编码器友好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T08:39:20.783

使用自定义模型类并使其尽可能对编码器不友好:)
如何构建模型类很大程度上取决于特定页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T08:41:16.767

为了保持简单，你可以只传递一个带有字符串键和值的字典。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T08:41:26.830

我喜欢 django 结构。它非常灵活。例子：

```
project/
       apps/
            app1/
                 models.py
                 views.py
                 forms.py
                 templates/ #or into root templates path
                 url.py #to dispatch
                 etc..
       templates/
                app1/
                    templates 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T06:00:42.313

在为每个 M、V、C... 创建类之后，最好使用一个数据结构类，其成员字段包含要在视图中显示的数据。最好为每个实体拥有单独的数据结构类。但是在您的情况下，即在视图的情况下，如果您的视图由不同的部分组成，则使用单独的数据结构类。实例化视图时，还要创建数据结构的对象。然后使用 getter 获取数据并将其传递给视图对象的 getter 或构造函数本身。

# c# - LinQ to Entities：做相反的查询

> ID：668997
> 
> 赞同：1
> 
> 时间：2009-03-21T08:55:36.127
> 
> 标签：c#, entity-framework, linq-to-entities

我写了这个：

```
 var destinations = db.DestinationDetails.
    Where(dd => dd.Language.Lang == "en-US" &&
        dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com")); 

```

如何检索电子邮件 abc@yahoo.com 的客户没有的 destinationDetails？

这不起作用：

```
 var destinations = db.DestinationDetails.
    Where(dd => dd.Language.Lang == "en-US" &&
        dd.Destination.Client.Any(c => c.Email != "abc@yahoo.com")); 

```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-21T09:01:32.960

我认为您想使用 All 而不是 Any：

```
dd.Destination.Client.All(c => c.Email != "abc@yahoo.com") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T09:04:12.097

尝试

```
var destinations = db.DestinationDetails.
    Where(dd => dd.Language.Lang == "en-US" &&
        !dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T06:33:25.620

```
var destinations =(db.DestinationDetails.
    Where(dd => dd.Language.Lang == "en-US" &&
    dd.Destination.Client.Any(c => c.Email != "abc@yahoo.com")).Select c).ToList(); 
```

试试这个，你可能会得到结果...

# xml - XML 版本控制算法

> ID：668998
> 
> 赞同：5
> 
> 时间：2009-03-21T08:56:58.010
> 
> 标签：xml, algorithm, versioning

我正在寻找一种有效的方法来比较和获取两个基于 XML 的解析树之间的差异。

您认为存储这些差异的最佳方式是什么？我会这样做：

XML A：

```
<w:p>
  <w:pPr>
    <w:spacing w:after="1"/>
  </w:pPr>
  <w:r>
    <w:t>World</w:t>
  </w:r>
</w:p> 
```

XML B：

```
<w:p>
  <w:pPr>
    <w:spacing w:after="1"/>
  </w:pPr>
  <w:r>
    <w:t>ASDF</w:t>
  </w:r>
</w:p> 
```

该算法确定“World”已更改为“ASDF”，然后存储：

```
div: <w:p><w:r><w:t>World</w:t> -> <w:p><w:r><w:t>ASDF</w:t> 
```

这足以涵盖所有可能发生的情况吗？

有人知道这样做的好方法吗？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T09:08:31.930

可能会变得更难。看这个例子：

```
<w:p>
  <w:pPr>
    <w:spacing w:after="1"/>
  </w:pPr>
  <w:r>
    <w:t>World</w:t> <-- Case 1: this changes to <w:t>ASDF</w:t>
    <w:t>World</w:t> <-- Case 2: this changes to <w:t>ASDF</w:t>
  </w:r>
</w:p> 
```

为了能够识别这两种情况，您必须将其中一种存储为

```
 div: <w:p><w:r><w:t>World</w:t> -> <w:p><w:r><w:t>ASDF</w:t> 
```

另一个为

```
 div: <w:p><w:r><w:t>World</w:t><w:t>World</w:t> -> <w:p><w:r><w:t>World</w:t><w:t>ASDF</w:t> 
```

或类似的东西（您可能还想为它们添加“w:p”结束标记以使它们成为有效的 XML 子树）。

通常，此类程序可能会变得非常复杂，因此我不建议您创建全新的东西，而是使用一些现有的差异算法（即使不解析 XML 结构，大多数也足够好）或修改其中一个以适合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T09:35:07.777

[XML 差异](http://msdn.microsoft.com/en-us/library/aa302294.aspx)：

> 说明如何使用 XML Diff and Patch 工具，该工具比较两个 XML 文件并生成差异的 XML 输出，方法是利用读者可以应用于自己的应用程序的典型场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T16:13:29.350

对公共部分进行简单的深度优先搜索怎么样？也就是说，进行深度优先搜索，一旦遇到差异就存储它并开始回溯。构建输出的上下文部分所需的附加信息可以很容易地存储在“回溯堆栈”中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-21T19:16:18.660

当您想比较两棵树之间的差异并以某种方式从比较中产生“差异”时，您基本上是在查看*树编辑距离*问题的变体。首先，请查看[这篇论文](http://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf)。

一个更常见的“编辑距离”问题是字符串的编辑距离问题。版本控制软件（如 CVS 或 SVN）使用“增量编码”来存储对文件所做的*更改*，使用字符串编辑距离算法的变体来计算增量。树木的情况不太常见，但绝对很有趣。`**********`**~~