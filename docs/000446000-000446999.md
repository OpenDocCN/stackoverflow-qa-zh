# StackOverflow 问答 000446000-000446999

# c++ - 调整由 IE 中的资源管理器栏托管的 Web 浏览器控件的大小

> ID：446000
> 
> 赞同：2
> 
> 时间：2009-01-15T08:19:32.697
> 
> 标签：c++, windows, internet-explorer, webbrowser-control

我有一个托管 webbrowser 控件的自定义资源管理器栏（带​​对象）。我可以正确初始化 WebBrowser 控件并让它显示网页。

但是，我注意到，当我调整资源管理器栏**的大小时，webbrowser 控件不会适当**地调整到栏的大小：

## 调整大小之前：

![调整大小之前](https://farm4.static.flickr.com/3347/3198030477_abd73d020b.jpg)

## 调整大小后：

![调整大小后](https://farm4.static.flickr.com/3482/3198030475_952eceb19d.jpg)

我不确定我需要处理哪些事件以及什么可以调整浏览器控件的大小。我在 .NET 编程方面有一些经验，但在 Windows 编程方面却没有。

如果您想进一步了解它，我还在[这里包含了我的源代码。](http://rapidshare.com/files/183531789/ExplrBar.Cpp)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T07:07:21.343

通常，当承载 OLE 控件的容器调整大小时，它会查询嵌入对象的 IOleInPlaceObject 接口，并使用该接口上的 SetObjectRects() 来告诉控件其新大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T22:23:50.427

*这个“答案”与原始问题没有直接关系，但我在尝试为一个非常相似的问题寻找解决方案时遇到了这个页面。*

每当我移动分离器时，它总是会回到原来的位置。事实证明，`DESKBANDINFO`模式标志对于垂直侧边栏的命名并不是特别好。我在`DBIMF_NORMAL`应该使用的时候使用`DBIMF_VARIABLEHEIGHT`。

示例代码：

```
STDMETHODIMP CMyExplorerBar::GetBandInfo(DWORD dwBandID,
                                         DWORD dwViewMode,
                                         DESKBANDINFO* pdbi)
{
    if(pdbi)
    {
        m_dwBandID = dwBandID;
        m_dwViewMode = dwViewMode;

        if(pdbi->dwMask & DBIM_MINSIZE)
        {
            pdbi->ptMinSize.x = 30;
            pdbi->ptMinSize.y = 30;
        }

        if(pdbi->dwMask & DBIM_MAXSIZE)
        {
            pdbi->ptMaxSize.x = -1;
            pdbi->ptMaxSize.y = -1;
        }

        if(pdbi->dwMask & DBIM_INTEGRAL)
        {
            pdbi->ptIntegral.x = 1;
            pdbi->ptIntegral.y = 1;
        }

        if(pdbi->dwMask & DBIM_ACTUAL)
        {
            pdbi->ptActual.x = 500;
            pdbi->ptActual.y = 0;
        }

        if(pdbi->dwMask & DBIM_TITLE)
        {
            StringCchCopy(pdbi->wszTitle, 256, L"My Sidebar");
        }

        if(pdbi->dwMask & DBIM_MODEFLAGS)
        {
            pdbi->dwModeFlags = DBIMF_VARIABLEHEIGHT;
        }

        if(pdbi->dwMask & DBIM_BKCOLOR)
        {
            pdbi->dwMask &= ~DBIM_BKCOLOR;
        }

        return S_OK;
    }

    return E_INVALIDARG;
} 
```

# flash - 初学者：在 Haxe/ActionScript3 中动态地将帧插入到 MovieClip

> ID：446003
> 
> 赞同：2
> 
> 时间：2009-01-15T08:22:20.320
> 
> 标签：flash, actionscript-3, dynamic, haxe

假设我有一个资源文件，其中导出`mc1`4 帧。我想创建一个新的`MovieClip`并插入这样的框架：

```
mc2:flash.display.MovieClip = new flash.display.MovieClip()

mc1.gotoAndStop(2);
mc2.gotoAndStop(1);
mc2.currentFrame = mc1.currenctFrame
mc1.gotoAndStop(1);
mc2.gotoAndStop(2);
mc2.currentFrame = mc1.currenctFrame
mc1.gotoAndStop(2);
mc2.gotoAndStop(3);
mc2.currentFrame = mc1.currenctFrame
mc1.gotoAndStop(4);
mc2.gotoAndStop(4);
mc2.currentFrame = mc1.currenctFrame 
```

### [编辑] 更多细节

我没有使用 Flash IDE。我在用：

*   Inkscape（用于 SVG 生成）
*   swfmill（创建资产文件）
*   Haxe（创建动画）

在这一点上，我不是在尝试构建游戏或任何交互的东西。我设法创建了一个简单的动画，其中背景精灵正在旋转（就是这样）。我用`TimerEvent`s 来实现这一点。但相反，我真的希望能够构建一个 MovieClip 并在其上附加单个帧，然后循环播放。

或者，我可以创建一个 MovieClip 并以编程方式逐帧绘制它。（然后当然循环播放）

基本上我想使用 ActionScript 来生成内容而不是 swfmill 的 XML（不是`simple`方言，`simple`很好）。由于我是初学者，我不知道我可以给你什么其他信息。所以请告诉我是否可以提供任何其他详细信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T09:53:14.647

如果没有 Flash IDE，使用 gotoAndStop() 等就没有什么意义了。

由于您无法在不同的框架上添加不同的资产，您应该使用 addChild(assetToAdd) 将它们全部添加为图层，并将除一个之外的所有资源设置为可见 = false。然后添加一个简单的函数，如下所示：

```
function showFrame(num:int):void
{
    for (var i:int = 0; i < numChildren; i++)
    {
       if (i == num)
       {
          getChildAt(i).visible = true;
       }
       else
       {
          getChildAt(i).visible = false;
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T08:58:41.870

我不知道有一种方便的方法来做你想做的事情。您的示例不起作用，因为 currentFrame 是一个只读属性，它返回的只是一个表示帧号的整数，而不是构成实际帧的数据。

如果您需要动态重新排列帧，我的建议是将特定的 MovieClip 包装在一个自定义类中，该类将 gotoAndPlay(x) 转换为您想要的任何数字。

但是，根据您要实现的目标，这可能不是很有用，但是如果您稍微澄清一下您的问题，我相信我们可以提出适当的建议。

# c# - .Net CCW 没有使用免注册 COM 的事件！

> ID：446013
> 
> 赞同：2
> 
> 时间：2009-01-15T08:28:32.507
> 
> 标签：c#, .net, com, interop, regfreecom

我有一个从 VB6 程序中使用的 COM Callable Wrapper，但除非注册 CCW，否则该程序不会接收 COM 事件。否则，CCW 工作正常，在我删除程序的清单文件并使用“regasm /tlb /codebase theccw.dll”注册 CCW 之前没有任何事件。这是在 WinXP SP3 中。

可能是什么问题呢？

也许我的 CCW 构建错误，无法用作“早期绑定”VB6 对象。这是我的声明：

```
[ComVisible(false)]
public delegate void AnEventDelegate(int arg1);

[
ComVisible(true),
GuidAttribute("XXXX-XXXX-XXXX-XXXX"),
InterfaceType(ComInterfaceType.InterfaceIsIDispatch)
]
public interface IComEvents
{
    void AnEvent(int arg1);
}

[
ComVisible(true),
Guid("YYYY-YYYY-YYYY-YYYY"),
ClassInterface(ClassInterfaceType.None), 
ComSourceInterfaces(typeof(IComEvents))
]
public class TheComClass: IComContract
{
    public TheComClass(){}

    // Implicit implementation of IComContract.
    // Implicit implementation of IComEvents.
    // 
    // eg. public event AnEventDelegate AnEvent;
}

[
ComVisible(true),
Guid("ZZZZ-ZZZZ-ZZZZ-ZZZZ")
]
public interface IComContract
{
    [ComVisible(true)]
    string AProp{ get; set; }

    [ComVisible(true)]
    void AMethod();
} 
```

我刚刚意识到的一件事。我在 TheComClass 内的公共事件声明中没有 [ComVisible(true)] 属性。我认为这不是问题，因为我确实在注册事物时收到了事件，但我们会看到......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T08:44:07.530

在 COM 事件中没有早期绑定。.NET 中的事件只是委托的一种特殊用法，最终只是函数调用，而 COM 事件则涉及更多。

您将需要为事件注册的组件才能工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-06T21:37:39.270

我有同样的问题，并想出了如何解决它。

使您的类派生自 System.Windows.Forms.UserControl。

我得到了一个 C# 编写的 COM 服务器来使用来自 VB6 的事件，即使是免注册的 COM。

显然 UserControl 实现了 IOleObject，这在某些情况下是必需的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-12T17:11:21.593

我发现的唯一答案是这不起作用，我必须注册 CCW。

# asp.net - 如何从 bat 文件中使用 aspnet_compiler？

> ID：446015
> 
> 赞同：3
> 
> 时间：2009-01-15T08:28:40.197
> 
> 标签：asp.net, visual-studio

我需要从我维护的 bat 文件中执行 aspnet_compiler，以便从 CruiseControl.NET 中自动发布 ASP.NET 应用程序。

如果我手动打开 Visual Studio 命令提示符，aspnet_compiler 运行良好，但如果我打开正常的 cmd.exe，则不会运行。

我应该采取哪些步骤来使 aspnet_compiler 可以通过普通的 cmd.exe 访问？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T08:35:31.917

对于 Visual Studio 2008：

```
call "%VS90COMNTOOLS%\vsvars32.bat" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T08:35:26.003

靠近批处理文件的顶部：

```
CALL "C:\Program Files\Microsoft Visual Studio 8\VC\vcvarsall.bat" 
```

这将正确设置您的路径。

您计算机上 VS.NET 的安装位置可能不同。要找到正确的路径，请为“Visual Studio nnn 命令提示符”快捷方式选择“属性”。

或者您可以在批处理文件中包含 aspnet_compiler 的完整路径。

# build-process - 流行的构建文件夹结构

> ID：446017
> 
> 赞同：25
> 
> 时间：2009-01-15T08:29:19.637
> 
> 标签：build-process, directory

我想知道在项目中组织构建资产和源代码的流行或最佳方式是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T10:45:39.860

我有

```
/src    - source files (test files are within a package 'test' here, or 'test' subpackage of what is being tested)
/lib    - required libraries
/doc    - text documentation and development notes
/build  - where we build (each separate build item within a subfolder here)
/conf   - configurations (each config, production, test, developer, etc gets a folder in here, and when building Jars and Wars the correct set is copied across)
/extras - other stuff
/extras/resources - resources that should be included within generated Jars, e.g., icons 
```

和

```
/websites - Web related content and configurations (each website in its own folder here)
/websites/$site/webcontent - All the web content here
/websites/$site/conf - website related configuration files here (instead of /conf)
/websites/$site/build.xml - ANT build script for website that creates a war, etc

(remember you might have an admin site and a public site for a single project, hence the multi-site configuration within a single project, or even site v1 and site v2, etc) 
```

最后，您必须根据项目本身以及您使用的是 ANT 还是 Maven 有点灵活。我使用 ANT，或者将 ANT 脚本放在 /build 中，但它们已经出现在某些项目的其他地方（例如在 /websites/ 中）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-15T08:45:13.317

一般来说：

```
src/      - source files
src/tests - unit tests
doc/      - documentation
res/      - static resources (textures, locale database, level definitions etc)
build/    - tools needed to build the system
            project specific libraries and compilers
Makefile  - the makefile (make, test, clean etc) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-15T08:39:23.860

例如，我将以下内容用于我的 .Net 风格项目；

```
/build/reports  - reports and logs from the build process
/build/artifacts  - all output of the build process is copied here
/src/  - all solution source code
/lib/  - 3rd party or other build dependencies
/tools/...  - all other helper tools used in the build process
/tools/nant  - example tool
/tools/nunit  - example tool
/myProject.sln  - visual studio solution file (or other IDE)
/default.build  - nant build file 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-15T08:43:12.277

由于我只处理 Java 项目，并且它们都是“Mavenized”，因此我使用[Maven 为项目结构定义的约定](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)。

基本上：

```
project
  src/main/java        --> source files
  src/main/resources   --> resources files (*.xml, *.properties, etc.)
  src/test/java        --> source files for tests.
  src/test/resources   --> resources files for tests. 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T10:49:05.127

此文件夹组织代表[xLim 概念](http://rabdullin.com/journal/2008/1/12/organization-of-xlim-solutions-development-svn-and-integrati.html)的演变。

[您可以在这个开源项目](http://rabdullin.com/shared-libraries/)中查看它。

```
Build           - ignored from version control
  Artifact      - build artifacts (grabbed by CC.NET from here)
  Package       - generated zip or install packages
  Test          - all assemblies for unit tests
  Help          - autogenerated documentation
Resource
  Build         - plugins and extensions for NAnt/MSBuild
  Library       - 3rd party dependencies
  Tool
    FxCop
    ILMerge          
    NCover
    NCoverExplorer
    NUnit
    SHFB
    Wix
Samples
  SampleProject1
  SampleProject2  
Source
  Project1
  Project2

  GlobalAssemblyInfo.cs
  VersionAssemblyInfo.cs   - integration server updates this one

Test
  Project1.Tests
  Project2.Tests        

Solution.build        - primary build file
Solution.ccnet        - CruiseControl adapter for the build file
Solution.sln          - Visual Studio

go.cmd                - shortcut for launching the build file locally
readme.txt            - licenses and overview
SharedKey.snk         - for strong naming 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T08:46:22.270

我个人使用

```
/client/projectname/trunk/source/Solution Name.sln
/client/projectname/trunk/source/Project.One
/client/projectname/trunk/source/Project.Two
/client/projectname/trunk/source/Project.Three
/client/projectname/trunk/source/SQL/
/client/projectname/trunk/source/SQL/SomeScript.sql
/client/projectname/trunk/libraries
/client/projectname/trunk/resources/Nunit
/client/projectname/trunk/resources/LLBLGEN
/client/projectname/trunk/documentation
/client/projectname/trunk/builds 
```

它对我们来说很好，但我认为这不是最好的。**如果是关于 .net**，您还可以查看[treesurgeon](http://www.codeplex.com/treesurgeon)他们将其描述为：

> 你有没有花几天时间建立一个新的开发树？你有没有花几天时间设置几个开发树？您是否甚至花了数周时间尝试使用一组最佳实践来完善您的所有开发树？
> 
> 如果上述任何一个答案的答案是“是”，那么您会喜欢 Tree Surgeon！
> 
> Tree Surgeon 是一个 .NET 开发树生成器。只需给它您的项目名称，它就会在几秒钟内为您建立一个开发树。不仅如此，您的新树还内置了多年积累的构建工程经验。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T10:27:14.780

我喜欢[Netbeans](http://www.netbeans.org/) IDE 组织项目的方式。只需启动一个新项目，它就会设置一个默认的开发树和一个 ant 脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-13T15:44:26.803

对我来说，这取决于项目规模。对于小型项目，我发现具有单个 Makefile、/src 和 /include 目录的项目目录效果很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-05T09:52:17.953

对于 .NET 项目，请查看[ProjectScaffold](https://github.com/fsprojects/ProjectScaffold)并在此[要点](https://gist.github.com/davidfowl/ed7564297c61fe9ab814)下进行讨论。

# java - 在java应用程序中跟踪IO？

> ID：446023
> 
> 赞同：5
> 
> 时间：2009-01-15T08:35:23.587
> 
> 标签：java, io, trace

我试图找出为什么 Apache CXF 在第一次初始化 Web 服务时会做“某事”。“某事”可能是某种 IO，我猜它正在尝试解析某种外部地址/模式/DTD。

所以我试图找到某种可以监控所有 IO 的钩子。在虚拟机级别或操作系统级别（我可以在 linux 和 windows 上运行，但我不允许运行 wireshark，理论上它可能是文件 IO）。

关于如何追踪正在发生的事情的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T09:06:05.990

如果您真的想知道发生了什么，一种方法是在 apache 进程上运行“strace”或“ltrace”。这里有一个简短的[介绍](http://tldp.org/LDP/LGNET/132/vishnu.html)。有趣的是 strace 应该阻止某个调用，即如果您的假设正确，则等待 i/o。

要检查某个进程正在使用哪些文件（和网络套接字），请查看“lsof”。例如，要检查某个进程打开了哪些文件：

```
lsof -p process_id  # by PID
lsof -c httpd       # by a process name 
```

要检查一般的网络连接，请尝试“netstat”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T19:44:13.627

除了从操作系统级别监视应用程序的 strace 和 filemon 之外，您可能还想试一试交互式分析器。像 Sun 的免费[VisualVM](https://visualvm.dev.java.net/)这样的工具可以显示各种方法的调用频率，以及生成和查看线程转储的简单方法。这样，您可以查看应用程序是否在您自己的代码中旋转，或者线程是否正在阻塞等待一些永远不会完成的 IO。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T21:56:29.040

它很可能正忙于解析 WSDL、解析它、处理它等等......

实际上，第一次，它还处理所有涉及加载模式和验证等的 spring 配置文件。

你也可以运行类似wireshark的东西来跟踪所有的网络流量，看看它是否会得到任何东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T08:53:26.683

在 Windows 上，您可以使用[filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)，它会列出所有文件访问并允许您过滤它们，以便您只看到您感兴趣的进程。

看起来对于更新版本的 windows [Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)是前进的方向。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-19T22:15:35.890

[您可以使用InTrace](http://mchr3k.github.com/org.intrace/)在 JVM 级别跟踪您的应用程序。这将允许您识别在启动期间正在执行的 Java 代码。这使用 Java 代理在加载类时将检测添加到类，因此可以为所有正在使用的类生成方法进入/退出调用。

# python - Django：您如何提供媒体/样式表并在模板中链接到它们

> ID：446026
> 
> 赞同：45
> 
> 时间：2009-01-15T08:35:50.730
> 
> 标签：python, css, django, django-templates, media

有人问过这个问题的变体，但是当我的模板被渲染时，我仍然无法让我的样式表正确加载。

我正在尝试在开发过程中从 Django 进程中提供静态媒体 - 我知道，在生产中强烈建议不要这样做。我将发布我的配置和模板，希望有人可以帮助我了解我哪里出错了。

请注意，我确实尝试遵循 Django 项目网站上的示例，但是它没有提到如何从模板中引用您的样式表。我还尝试了同一事物的许多不同变体，因此我的代码/设置可能与描述的有所不同。

设置.py

```
MEDIA_ROOT = 'D:/Dev Tools/django_projects/dso/media'
MEDIA_URL = '/media/'
ADMIN_MEDIA_PREFIX = '/media/' 
```

网址.py

```
from django.conf.urls.defaults import *
from django.conf import settings
from django.contrib import admin

admin.autodiscover()

urlpatterns = patterns('',
    (r'^admin/(.*)', admin.site.root),
    (r'^ovramt/$', 'dso.ovramt.views.index'),
)

if settings.DEBUG:
    urlpatterns += patterns('',
        (r'^media/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
    ) 
```

在我的模板中：

```
<head> 
<title> {% block title %} DSO Template {% endblock %} </title> 
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<link rel="stylesheet" type="text/css" href="../media/styles.css">
</head> 
```

我向您保证，文件（模板/媒体）位于我的文件系统上的正确目录中。如果我需要提供任何额外的信息，请发表评论。

* * *

编辑：

我遇到的问题之一是在我的链接前面使用了“/”。如果添加了正斜杠，则从站点的根目录打开链接。如果没有正斜杠，则在当前级别打开链接。一个例子：

www.example.com/application/ 有一个链接“/app2/”和一个链接“app3/”。
app2 将在 www.example.com/app2/ 打开，app3 将在 www.example.com/application/app3/ 打开.我想这让我很困惑。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-15T18:56:51.770

我只需要自己弄清楚这一点。

设置.py：

```
MEDIA_ROOT = 'C:/Server/Projects/project_name/static/'
MEDIA_URL = '/static/'
ADMIN_MEDIA_PREFIX = '/media/' 
```

网址.py：

```
from django.conf import settings
...
if settings.DEBUG:
    urlpatterns += patterns('',
        (r'^static/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
    ) 
```

模板文件：

```
<link rel="stylesheet" type="text/css" href="/static/css/style.css" /> 
```

文件位于此处：

```
"C:/Server/Projects/project_name/static/css/style.css" 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-26T10:49:00.467

Django 已经有 MEDIA_URL 的上下文过程，请参阅[Django 的文档](http://docs.djangoproject.com/en/dev/ref/templates/api/#django-core-context-processors-media "在 django 的文档中")。

它应该在 RequestContext 中默认可用（除非您自定义了 CONTEXT_PROCESSORS 并忘记添加它）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T18:40:22.227

我通常制作自己的模板简单标签，因为 Django 不提供 CSS/JavaScript 文件。Apache 这样做，所以我的媒体网址通常是[http://static.mysite.com](http://static.mysite.com)。

**你的应用程序/模板标签/media_url.py：**

```
from django.template import Library
from yourapp.settings import MEDIA_URL
register = Library()

@register.simple_tag
def media_url():
    return MEDIA_URL 
```

**在我的模板文件中：**

```
{% load media_url %}
<link href="{{ media_url }}css/main.css" rel="stylesheet" type="text/css"> 
```

您还可以制作[自己的上下文预处理器](https://stackoverflow.com/questions/433162/can-i-access-constants-in-settings-py-from-templates-in-django#433209)以在每个模板中添加 media_url 变量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T09:27:23.293

我只是使用绝对命名。除非您在很深的路径中运行该站点（或者即使您是），否则我会放弃`..`并选择以下内容：

```
<link rel="stylesheet" type="text/css" href="/media/styles.css"> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T09:15:37.060

我有几个想法，我不知道其中一个对我有用:)

> 确保使用尾部斜杠，并使其与 MEDIA_URL 设置不同（因为相同的 URL 不能映射到两组不同的文件）。

那来自[http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix](http://docs.djangoproject.com/en/dev/ref/settings/#admin-media-prefix)

其次，可能是您将文件系统上的目录与 url 路径混淆了。尝试使用绝对网址，然后细化它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T15:04:57.437

只是以为我会很快插话。虽然这里的所有建议都很好，而且我在开发时确实使用了 Ty 的示例，但是一旦您投入生产，您可能希望选择通过直接 Apache 或您正在使用的任何其他服务器来提供文件。

我所做的是在完成开发后设置一个子域，并替换所有指向静态媒体的链接。例如：

```
<link rel="stylesheet" type="text/css" href="http://static.mydomain.com/css/style.css" /> 
```

这样做的原因有两个。首先，在不需要时让 Django 处理这些请求似乎会更慢。其次，由于大多数浏览器实际上可以同时从 3 个不同的域下载文件，因此为静态文件使用第二个子域实际上会加快用户的下载速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-10T16:51:58.710

要添加的另一件事是，如果您在子域/不同域上有单独的媒体服务器，您可以禁用静态媒体的 cookie。节省一点处理和带宽。

# mysql - MySQL 5.0 社区版能否扩大规模以满足庞大的用户群？

> ID：446027
> 
> 赞同：2
> 
> 时间：2009-01-15T08:36:57.670
> 
> 标签：mysql

我需要创建一个社交网络应用程序，该应用程序将吸引相当多的用户使用它，并且需要高可扩展性能力。我更喜欢开源解决方案并考虑到 MySQL。但我需要知道 MySQL 是否会给我我想要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T08:39:53.873

是的。

[您可以使用Replication](http://dev.mysql.com/doc/refman/5.0/en/replication.html)将 MySQL 扩展到具有冗余、故障转移和良好性能的大量服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T08:44:57.140

当然，您可以使用复制（1 个写入/许多读取器）和/或 NDB 集群。你也可以试试[红杉](http://www.continuent.com/community/sequoia)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T08:45:45.157

MySQL 将应对大量使用。

更重要的是，您的系统应该以这样一种方式构建，即您将最小的负载放在数据库上，以便您可以在需要时更改数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T10:47:55.410

两个大型 OSS DB（MySQL 和 PostgreSQL）都可以扩展到非常大的站点。诀窍是从一开始就进行计划，以便可以将数据分解（“分片”）到多个数据库服务器中，您可以快速找出需要访问的服务器。

例如：昵称为 AG 的用户转到 server1，HO 转到 server2 等。这样您几乎可以无限扩展，因为当服务器达到限制时，您可以将其拆分为更小的部分。

# visual-studio-2008 - 如何让 Visual Studio 自动在 .aspx 文件中添加所需的 Import 元素？

> ID：446029
> 
> 赞同：0
> 
> 时间：2009-01-15T08:37:58.900
> 
> 标签：visual-studio-2008

我有一个类“消息”。

在我的 .aspx 文件视图 (ASP.NET MVC) 中，我正在键入一行代码并使用“消息”。

```
<h1>Messages</h1>
<ul>
    <% foreach(Message %>
</ul> 
```

我得到一个有用的气泡，上面写着“找不到类型或命名空间消息”，并给了我一个下拉列表来添加它，但只是这样做：

```
<h1>Messages</h1>
<ul>
    <% foreach(DataTestProject.Models.Message %>
</ul> 
```

我真正想要的是让它自动在顶部弹出导入语句，如下所示：

```
<%@ Import Namespace="DataTestProject.Models" %> 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-24T16:25:30.070

[ReSharper](http://www.jetbrains.com/resharper/features/asp_net_editor.html)将为您做到这一点

它能够自动导入命名空间和注册用户控件，此外还有其他对 ASP.NET 开发人员有用的功能

# .net - 支持 Compact Framework 的 IoC/DI 容器

> ID：446033
> 
> 赞同：7
> 
> 时间：2009-01-15T08:39:40.240
> 
> 标签：.net, compact-framework, dependency-injection, inversion-of-control

他们的任何 IoC 控制器是否可以在 .NET Compact Framework 上运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T08:43:13.680

*   [http://code.google.com/p/compactcontainer/](http://code.google.com/p/compactcontainer/)
*   [http://ninject.org/](http://ninject.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T20:03:46.120

[OpenNETCF IoC 框架](http://ioc.codeplex.com)支持 Compact Framework（作为一等公民）、完整的桌面框架、Android Mono、MonoTouch 和 Windows Phone。它仍然处于活动状态，仍在应用更新和修复，这对于所有其他“支持 CF 的”框架都不能说。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T08:43:55.923

[Ninject](http://ninject.org/)是一个依赖注入框架，具有紧凑的框架版本。

但是，在受限环境中，我会避​​免使用框架，而是在我的代码中实现控制原则的反转。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T02:18:25.497

这是一个新的：[Funq](http://funq.codeplex.com/)。还可以查看[制作的](http://www.clariusconsulting.net/blogs/kzu/archive/2009/02/02/116399.aspx)截屏视频。

# javascript - 如何在javascript中验证日期时间值？

> ID：446035
> 
> 赞同：0
> 
> 时间：2009-01-15T08:39:49.863
> 
> 标签：javascript, datetime

如何在 javascript 中验证日期时间值以确保为年、月、日、小时、分钟和秒输入的值构成有效的 Datetime 对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T09:32:25.453

也许是这样的：

```
function ValidateDate(y, mo, d, h, mi, s)
{
  var date = new Date(y, mo - 1, d, h, mi, s, 0);
  var ny = date.getFullYear();
  var nmo = date.getMonth() + 1;
  var nd = date.getDate();
  var nh = date.getHours();
  var nmi = date.getMinutes();
  var ns = date.getSeconds();
  return ny == y && nmo == mo && nd == d && nh == h && nmi == mi && ns == s;
} 
```

经测试：

```
"OK"
ValidateDate(2001, 2, 28, 10, 35, 42)
ValidateDate(2001, 12, 29, 10, 35, 42)
ValidateDate(2000, 2, 29, 10, 35, 42)
ValidateDate(2004, 2, 29, 10, 35, 42)
ValidateDate(1970, 1, 2, 3, 4, 5)
ValidateDate(2008, 1, 15, 10, 25, 44)
"KO"
ValidateDate(2001, 2, 29, 10, 35, 42)
ValidateDate(2001, 11, 32, 10, 35, 42)
ValidateDate(2001, 15, 2, 10, 35, 42)
ValidateDate(2001, 1, 2, 25, 35, 42)
ValidateDate(2001, 5, 2, 1, 61, 42)
ValidateDate(2001, 5, 2, 1, 1, 70)
ValidateDate(2001, 0, 2, 1, 1, 1)
ValidateDate(2001, 2, 0, 1, 1, 1) 
```

# python - 如何在使用新语言功能的程序中检查 Python 版本？

> ID：446052
> 
> 赞同：245
> 
> 时间：2009-01-15T08:45:28.090
> 
> 标签：python, version

如果我有一个至少需要特定版本的 Python 的 Python 脚本，那么当使用早期版本的 Python 启动脚本时，优雅地失败的正确方法是什么？

如何尽早获得控制权以发出错误消息并退出？

例如，我有一个程序使用三元运算符（2.5 中的新功能）和“with”块（2.6 中的新功能）。我写了一个简单的小解释器版本检查程序，这是脚本首先调用的……除了它没有那么远。相反，脚本在 python 编译期间失败，甚至在我的例程被调用之前。因此，脚本的用户会看到一些非常模糊的语法错误回溯——这几乎需要专家来推断这只是运行错误版本的 Python 的情况。

我知道如何检查 Python 的版本。问题是某些语法在旧版本的 Python 中是非法的。考虑这个程序：

```
import sys
if sys.version_info < (2, 4):
    raise "must use python 2.5 or greater"
else:
    # syntax error in 2.4, ok in 2.5
    x = 1 if True else 2
    print x 
```

在 2.4 下运行时，我想要这个结果

```
$ ~/bin/python2.4 tern.py 
must use python 2.5 or greater 
```

而不是这个结果：

```
$ ~/bin/python2.4 tern.py 
  File "tern.py", line 5
    x = 1 if True else 2
           ^
SyntaxError: invalid syntax 
```

（为同事通灵。）

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-15T08:50:17.690

您可以使用以下方法进行测试`eval`：

```
try:
  eval("1 if True else 2")
except SyntaxError:
  # doesn't have ternary 
```

此外，在 Python 2.5`with` *中*`from __future__ import with_statement`可用，只需添加.

编辑：为了尽早获得控制，您可以将其拆分为不同`.py`的文件并在导入之前检查主文件中的兼容性（例如在`__init__.py`包中）：

```
# __init__.py

# Check compatibility
try:
  eval("1 if True else 2")
except SyntaxError:
  raise ImportError("requires ternary support")

# import from another module
from impl import * 
```

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-01-15T09:26:51.143

在您的程序周围有一个包装器，它执行以下操作。

```
import sys

req_version = (2,5)
cur_version = sys.version_info

if cur_version >= req_version:
   import myApp
   myApp.run()
else:
   print "Your Python interpreter is too old. Please consider upgrading." 
```

您也可以考虑使用`sys.version()`，如果您打算遇到使用 2.0 之前的 Python 解释器的人，但是您需要做一些正则表达式。

并且可能有更优雅的方法来做到这一点。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-01-15T08:55:44.357

尝试

```
进口平台
platform.python_version()

```

应该给你一个像“2.3.1”这样的字符串。如果这不是您想要的，那么可以通过“平台”内置提供丰富的数据集。你想要的东西应该在某个地方。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2010-06-28T12:38:59.043

进行此版本比较的最佳方法可能是使用`sys.hexversion`. 这很重要，因为比较版本元组不会在所有 python 版本中为您提供所需的结果。

```
import sys
if sys.hexversion < 0x02060000:
    print "yep!"
else:
    print "oops!" 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-06-25T13:39:04.657

```
import sys    
# prints whether python is version 3 or not
python_version = sys.version_info.major
if python_version == 3:
    print("is python 3")
else:
    print("not python 3") 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-11-16T13:31:45.263

> 来自 AskUbuntu 的[Nykakin](https://askubuntu.com/questions/505081/what-version-of-python-do-i-have)的回答：

您还可以使用`platform`标准库中的模块从代码本身检查 Python 版本。

有两个功能：

*   `platform.python_version()`（返回字符串）。
*   `platform.python_version_tuple()`（返回元组）。

* * *

## Python 代码

> 例如创建一个文件`version.py`：）

检查版本的简单方法：

```
import platform

print(platform.python_version())
print(platform.python_version_tuple()) 
```

您还可以使用以下`eval`方法：

```
try:
  eval("1 if True else 2")
except SyntaxError:
  raise ImportError("requires ternary support") 
```

* * *

在命令行中运行 Python 文件：

```
$ python version.py 
2.7.11
('2', '7', '11') 
```

通过 Windows 10 上的 WAMP 服务器输出带有 CGI 的 Python：

[![Suriyaa Kudo 截屏 2016-11-16 14.39.01](https://i.stack.imgur.com/LFg39.png)](https://i.stack.imgur.com/LFg39.png)

* * *

## 有用的资源

*   [https://askubuntu.com/questions/505081/what-version-of-python-do-i-have](https://askubuntu.com/questions/505081/what-version-of-python-do-i-have)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-15T09:43:38.877

Sets 成为 Python 2.4 中核心语言的一部分，以保持向后兼容。我当时这样做了，这也对你有用：

```
if sys.version_info < (2, 4):
    from sets import Set as set 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-10-04T01:52:20.950

尽管问题是： *如何尽早获得控制权以发出错误消息**并退出**？*

我要回答的问题是： *如何**在启动应用程序之前***尽早获得控制以发出错误消息？

我可以以与其他帖子不同的方式回答它。到目前为止，似乎答案正试图从 Python 中解决您的问题。

我说，在启动 Python 之前进行版本检查。我看到你的路径是 Linux 或 unix。但是我只能为您提供一个 Windows 脚本。我想把它适应 linux 脚本语法不会太难。

这是 2.7 版的 DOS 脚本：

```
@ECHO OFF
REM see http://ss64.com/nt/for_f.html
FOR /F "tokens=1,2" %%G IN ('"python.exe -V 2>&1"') DO ECHO %%H | find "2.7" > Nul
IF NOT ErrorLevel 1 GOTO Python27
ECHO must use python2.7 or greater
GOTO EOF
:Python27
python.exe tern.py
GOTO EOF
:EOF 
```

这不会运行应用程序的任何部分，因此不会引发 Python 异常。它不会创建任何临时文件或添加任何操作系统环境变量。由于版本语法规则不同，它不会使您的应用程序出现异常。这是三个不太可能的安全访问点。

`FOR /F`线是关键。

```
FOR /F "tokens=1,2" %%G IN ('"python.exe -V 2>&1"') DO ECHO %%H | find "2.7" > Nul 
```

对于多个 python 版本，请查看网址： [http ://www.fpschultze.de/modules/smartfaq/faq.php?faqid=17](http://www.fpschultze.de/modules/smartfaq/faq.php?faqid=17)

还有我的破解版：

[MS 脚本；Python 模块的 Python 版本检查预启动] [http://pastebin.com/aAuJ91FQ](http://pastebin.com/aAuJ91FQ)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-05-24T05:26:49.613

```
import sys
sys.version 
```

会得到这样的答案

> '2.7.6（默认，2016 年 10 月 26 日，20:30:19）\n[GCC 4.8.4]'

这里**2.7.6**是版本

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-09-13T02:27:02.737

如上所述，语法错误发生在编译时，而不是运行时。虽然 Python 是一种“解释型语言”，但 Python 代码实际上并不是直接解释型的；它被编译成字节码，然后被解释。导入模块时会发生一个编译步骤（如果没有 .pyc 或 .pyd 文件形式的已编译版本），那是您收到错误的时候，而不是（非常准确地）什么时候您的代码正在运行。

您可以推迟编译步骤并在运行时为单行代码执行此操作，如果您愿意，可以使用 eval，如上所述，但我个人更喜欢避免这样做，因为它可能会导致 Python 执行不必要的运行时编译，一方面，另一方面，它让我感觉代码混乱。（如果您愿意，您可以生成生成代码的代码 - 并且从现在开始的 6 个月内有一个绝对美妙的时间来修改和调试它。）所以我推荐的是更像这样的东西：

```
import sys
if sys.hexversion < 0x02060000:
    from my_module_2_5 import thisFunc, thatFunc, theOtherFunc
else:
    from my_module import thisFunc, thatFunc, theOtherFunc 
```

..即使我只有一个使用较新语法的函数并且它很短，我也会这样做。（事实上​​，我会采取一切合理的措施来最小化此类函数的数量和大小。我什至可以编写一个像 ifTrueAElseB(cond, a, b) 这样的函数，其中包含一行语法。）

可能值得指出的另一件事（我有点惊讶没有人指出）是虽然早期版本的 Python 不支持像

```
value = 'yes' if MyVarIsTrue else 'no' 
```

..它确实支持像这样的代码

```
value = MyVarIsTrue and 'yes' or 'no' 
```

那是编写三元表达式的旧方法。我还没有安装 Python 3，但据我所知，这种“旧”方式至今仍然有效，所以你可以自己决定是否值得有条件地使用新语法，如果你需要支持使用旧版本的 Python。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-23T11:19:29.907

将以下内容放在文件的最顶部：

```
import sys

if float(sys.version.split()[0][:3]) < 2.7:
    print "Python 2.7 or higher required to run this code, " + sys.version.split()[0] + " detected, exiting."
    exit(1) 
```

然后继续使用普通的 Python 代码：

```
import ...
import ...
other code... 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-15T08:51:22.290

我认为最好的方法是测试功能而不是版本。在某些情况下，这是微不足道的，在其他情况下则不然。

例如：

```
try :
    # Do stuff
except : # Features weren't found.
    # Do stuff for older versions. 
```

只要您在使用 try/except 块方面足够具体，您就可以覆盖大部分基础。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-05-09T16:11:57.753

我在尝试自己解决问题的同时快速搜索后发现了这个问题，并且我根据上面的一些建议提出了一个混合体。

我喜欢 DevPlayer 使用包装器脚本的想法，但缺点是你最终会为不同的操作系统维护多个包装器，所以我决定用 python 编写包装器，但使用相同的基本“通过运行 exe 获取版本”逻辑并想出了这个。

我认为它应该适用于 2.5 及更高版本。到目前为止，我已经在 Linux 上的 2.66、2.7.0 和 3.1.2 以及 OS X 上的 2.6.1 上对其进行了测试。

```
import sys, subprocess
args = [sys.executable,"--version"]

output, error = subprocess.Popen(args ,stdout = subprocess.PIPE, stderr = subprocess.PIPE).communicate()
print("The version is: '%s'"  %error.decode(sys.stdout.encoding).strip("qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLMNBVCXZ,.+ \n") ) 
```

是的，我知道最终的解码/剥离线很糟糕，但我只是想快速获取版本号。我要完善它。

这对我来说已经足够好了，但如果有人可以改进它（或告诉我为什么这是一个糟糕的想法），那也很酷。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-07-15T21:40:57.273

对于*独立*的 python 脚本，以下模块文档字符串技巧来强制执行 python 版本（这里是 v2.7.x）有效（在 *nix 上测试）。

```
#!/bin/sh
''''python -V 2>&1 | grep -q 2.7 && exec python -u -- "$0" ${1+"$@"}; echo "python 2.7.x missing"; exit 1 # '''

import sys
[...] 
```

这也应该处理丢失的 python 可执行文件，但依赖于 grep。有关背景，请参见[此处](https://stackoverflow.com/questions/17458528/why-does-this-snippet-with-a-shebang-bin-sh-and-exec-python-inside-4-single-q)。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-12-11T23:57:43.587

我正在扩展 akhan 的出色答案，它甚至在编译 Python 脚本*之前打印了一条有用的消息。*

如果要确保脚本是在 Python 3.6 或更高版本上运行的，请将这两行添加到 Python 脚本的顶部：

```
#!/bin/sh
''''python3 -c 'import sys; sys.exit(sys.version_info < (3, 6))' && exec python3 -u -- "$0" ${1+"$@"}; echo 'This script requires Python 3.6 or newer.'; exit 1 # ''' 
```

（注意：第二行以*四个*单引号开头，以*三个*单引号结尾。这可能看起来很奇怪，但不是错字。）

此解决方案的优点是，如果使用早于 3.6 的 Python 版本，类似代码`print(f'Hello, {name}!')`不会导致错误。`SyntaxError`您将看到这条有用的消息：

```
This script requires Python 3.6 or newer. 
```

当然，此解决方案仅适用于类 Unix 的 shell，并且仅在直接调用脚本（例如`./script.py`：）并且设置了正确的执行权限位时才有效。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-01-27T19:26:55.413

您可以使用`sys.hexversion`或检查`sys.version_info`。

`sys.hexversion`不是很人性化，因为它是一个十六进制数。`sys.version_info`是一个元组，所以它更人性化。

检查 Python 3.6 或更新版本`sys.hexversion`：

```
import sys, time
if sys.hexversion < 0x30600F0:
    print("You need Python 3.6 or greater.")
    for _ in range(1, 5): time.sleep(1)
    exit() 
```

检查 Python 3.6 或更新版本`sys.version_info`：

```
import sys, time
if sys.version_info[0] < 3 and sys.version_info[1] < 6:
    print("You need Python 3.6 or greater.")
    for _ in range(1, 5): time.sleep(1)
    exit() 
```

`sys.version_info`更人性化，但需要更多字符。我会推荐`sys.hexversion`，即使它不那么人性化。

我希望这对你有帮助！

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2009-09-14T22:00:06.313

这个怎么样：

```
import sys

def testPyVer(reqver):
  if float(sys.version[:3]) >= reqver:
    return 1
  else:
    return 0

#blah blah blah, more code

if testPyVer(3.0) == 1:
  #do stuff
else:
  #print python requirement, exit statement 
```

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2010-04-09T19:31:02.303

问题很简单。您检查了版本是否***小于***2.4，不小于***或等于***. 所以如果Python版本是2.4的话，是不会低于2.4的。你应该有的是：

```
 if sys.version_info **<=** (2, 4): 
```

， 不是

```
 if sys.version_info < (2, 4): 
```

# java - 我可以在同一个 Swing 应用程序中使用两种不同的外观吗？

> ID：446056
> 
> 赞同：8
> 
> 时间：2009-01-15T08:47:42.687
> 
> 标签：java, swing, look-and-feel, substance

我正在使用 Flamingo 功能区和 Substance Office 2007 外观。

当然，现在**每个**控件都具有这种外观和感觉，即使是对话框上的控件。

我想要的是类似于 Office 2007 中的功能，其中功能区具有 Office 2007 的外观，但其他控件保持其原生 Vista/XP 外观。

是否可以为某些控件分配不同的外观和感觉？也许使用某种链接或代理外观？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-05T10:15:16.117

我刚刚发现：从[Substance 5.0](https://substance.dev.java.net/release-info/5.0/release-info.html)开始，[SKIN_PROPERTY](https://substance.dev.java.net/docs/clientprops/SkinProperty.html)可用。

它允许将不同的皮肤分配给不同的（`JRootPanes`即`JDialog`，，`JFrame`）`JInternalFrame`

一个小技巧：我重写`JInternalFrame`以删除额外的边框和标题窗格，使其看起来就像一个无边框的面板。这样就可以产生一种印象，即表单/对话框的不同部分具有不同的外观。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T09:48:13.360

这是一个会自动更改外观的库。我不确定这是否会以不同的方式为每个组件完成，但你应该看看它。[pbjar.org](http://www.pbjar.org/dynamicloca.html)

如果您想深入了解外观和感觉[/java-look-and-feel-design-guidelines-second-edition，这本书应该很有用](http://2020ok.com/books/29/java-look-and-feel-design-guidelines-second-edition-37029.htm)

我很高兴看到一些代码示例，如果有人可以编写它，请随时开始。

**编辑：**

在这个论坛线程[线程](http://forums.java.net/jive/thread.jspa?messageID=236002&tstart=0)中，我发现了以下描述

> Swing 使用外观和感觉（PLAF）。PLAF 不附加在每个 JFrame 级别上。它们附加在每个 VM 级别上。在一个应用程序中混合 PLAF 几乎是不可能的。我见过几次尝试，都失败了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T14:23:17.423

不幸的是，Swing 在幕后做了很多“伪全局”的事情。AFAIK，始终如一的唯一方法是使用私有`AppContext`API。每个`AppContext`都有自己的事件调度线程和其他“伪全局”。

# html - CSS 两个相邻的 div

> ID：446060
> 
> 赞同：255
> 
> 时间：2009-01-15T08:49:12.217
> 
> 标签：html, css

我想把两个`<div>`s放在一起。右边`<div>`大约200px；左边`<div>`必须填满屏幕宽度的其余部分？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：464
> 
> 时间：2009-01-15T09:01:04.640

您可以使用**[flexbox](https://devdocs.io/css/css_flexible_box_layout)**来布置您的项目：

```
#parent {
  display: flex;
}
#narrow {
  width: 200px;
  background: lightblue;
  /* Just so it's visible */
}
#wide {
  flex: 1;
  /* Grow to rest of container */
  background: lightgreen;
  /* Just so it's visible */
}
```

```
<div id="parent">
  <div id="wide">Wide (rest of width)</div>
  <div id="narrow">Narrow (200px)</div>
</div>
```

这基本上只是刮了 flexbox 的表面。Flexbox 可以做一些非常了不起的事情。

* * *

对于较旧的浏览器支持，您可以使用 CSS**浮动**和**宽度**属性来解决它。

```
#narrow {
  float: right;
  width: 200px;
  background: lightblue;
}
#wide {
  float: left;
  width: calc(100% - 200px);
  background: lightgreen;
}
```

```
<div id="parent">
  <div id="wide">Wide (rest of width)</div>
  <div id="narrow">Narrow (200px)</div>
</div>
```

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2010-06-02T06:38:47.987

我不知道这是否仍然是当前问题，但我刚刚遇到了同样的问题并使用了 CSS`display: inline-block;`标签。将它们包装在一个 div 中，以便它们可以适当地定位。

```
<div>
    <div style="display: inline-block;">Content1</div>
    <div style="display: inline-block;">Content2</div>
</div> 
```

请注意，内联样式属性的使用仅用于本示例的简洁性，当然这些用于移动到外部 CSS 文件。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-15T08:52:46.030

不幸的是，对于一般情况，这不是一件容易解决的事情。最简单的方法是添加一个 CSS 样式的属性“float:right;” 但是，对于您的 200px div，这也会导致您的“主”-div 实际上是全宽，并且其中的任何文本都会漂浮在 200px-div 的边缘周围，这通常看起来很奇怪，具体取决于内容（几乎在所有情况下，除非它是浮动图像）。

**编辑：** 正如 Dom 所建议的，包装问题当然可以用边距来解决。傻我。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-15T09:05:08.800

@roe 和@MohitNanda 建议的方法有效，但是如果正确的 div 设置为`float:right;`，那么它必须在 HTML 源中排在第一位。这会破坏从左到右的阅读顺序，如果页面在关闭样式的情况下显示，这可能会造成混淆。如果是这种情况，最好使用包装器 div 和绝对定位：

```
<div id="wrap" style="position:relative;">
    <div id="left" style="margin-right:201px;border:1px solid red;">left</div>
    <div id="right" style="position:absolute;width:200px;right:0;top:0;border:1px solid blue;">right</div>
</div> 
```

证明：

左右

**编辑：**嗯，有趣。预览窗口显示格式正确的 div，但呈现的帖子项目不显示。很抱歉，您必须自己尝试一下。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-11-03T10:02:45.160

我今天遇到了这个问题。基于上述解决方案，这对我有用：

```
<div style="width:100%;"> 
    <div style="float:left;">Content left div</div> 
    <div style="float:right;">Content right div</div> 
</div> 
```

只需使父 div 跨越整个宽度并浮动其中包含的 div。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-06-25T11:23:34.907

**更新**

如果需要将元素排成一行，可以使用[Flex Layout](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)。这里有另一个[Flex 教程](https://scotch.io/tutorials/a-visual-guide-to-css3-flexbox-properties?mc_cid=2fb2e2d2fa&mc_eid=7ed215d0c6)。这是一个很棒的 CSS 工具，尽管它不是 100% 兼容，但它的[支持](http://caniuse.com/#feat=flexbox)每天都在变得更好。这很简单：

HTML

```
<div class="container">
    <div class="contentA"></div>
    <div class="contentB"></div>
</div> 
```

CSS

```
.container {
    display: flex;
    width: 100%;
    height: 200px;
}

.contentA {
    flex: 1;
}

.contentB {
    flex: 3;
} 
```

你在这里得到的是一个总大小为 4 个单位的容器，它与它的孩子以 1/4 和 3/4 的比例共享空间。

我在 CodePen 中做了一个例子来解决你的问题。我希望它有所帮助。

[http://codepen.io/timbergus/pen/aOoQLR?editors=110](http://codepen.io/timbergus/pen/aOoQLR?editors=110)

**很老**

也许这只是胡说八道，但是您是否尝试过使用桌子？它不直接使用 CSS 来定位 div，但它工作正常。

您可以创建一个 1x2 表格并将其放入`divs`其中，然后使用 CSS 格式化表格以将它们放置在您想要的位置：

```
<table>
  <tr>
    <td>
      <div></div>
    </td>
    <td>
      <div></div>
    </td>
  </tr>
</table> 
```

**笔记**

如果你想避免使用表格，如前所述，你可以在下面的元素中使用`float: left;`and `float: right;`，不要忘记添加一个`clear: left;`，`clear: right;`或`clear: both;`，以便清理位置。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-12-02T22:25:48.427

```
div1 {
    float: right;
} 
div2 {
    float: left;
} 
```

只要您`clear: both`为分隔这两个列块的元素设置，这将正常工作。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-08-21T21:09:58.680

我遇到了同样的问题，Mohits 版本有效。如果你想在 html 中保持左右顺序，试试这个。在我的例子中，左边的 div 正在调整大小，右边的 div 保持在 260px 的宽度。

**HTML**

```
<div class="box">
<div class="left">Hello</div>
<div class="right">World</div>
</div> 
```

**CSS**

```
.box {
    height: 200px;
    padding-right: 260px;
}    

.box .left {
    float: left;
    height: 200px;
    width: 100%;
}

.box .right {
    height: 200px;
    width: 260px;
    margin-right: -260px;
} 
```

诀窍是在主框上使用右填充，但通过再次使用margin-right放置右框来再次使用该空间。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-08-13T14:55:43.510

我混合使用了 float 和 overflow-x:hidden。最少的代码，总是有效的。

[https://jsfiddle.net/9934sc4d/4/](https://jsfiddle.net/9934sc4d/4/) - 另外你不需要清除你的浮动！

```
.left-half{
    width:200px;
    float:left;
}
.right-half{
    overflow-x:hidden;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-15T09:48:12.893

正如每个人都指出的那样，您可以通过`float:right;`在 RHS 内容上设置 a 并在 LHS 上设置负边距来做到这一点。

但是.. 如果您不在`float: left;`LHS 上使用 a （如 Mohit 所做的那样），那么您将获得步进效果，因为 LHS div 仍将消耗布局中的边距空间。

但是.. LHS 浮动将收缩包装内容，因此如果不可接受，则需要插入定义宽度的子节点，此时您也可以在父节点上定义宽度。

但是.. 正如大卫指出的那样，您可以更改标记的读取顺序以避免 LHS 浮动要求，但这具有可读性和可能的​​可访问性问题。

然而..这个问题可以用浮点数来[解决，给定一些额外的标记](http://alanwho.com/layouts/2col-liquid.html)

*（警告：我不赞成该示例中的 .clearing div，有关详细信息，请参见[此处](https://stackoverflow.com/questions/407420/what-is-the-benefit-of-tableless-design-if-you-need-clearing-blocks-everywhere)）*

考虑到所有因素，我想我们大多数人都希望有一个非贪婪的宽度：保留在 CSS3 中......

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-09-30T07:02:40.687

这不是每个人的答案，因为 IE7- 不支持它，但您可以使用它，然后使用 IE7- 的替代答案。它是 display: table, display: table-row 和 display: table-cell。请注意，这不是使用表格进行布局，而是对 div 进行样式设置，这样事情就可以很好地排列，而不会出现上面的所有麻烦。我的是一个 html5 应用程序，所以效果很好。

本文展示了一个示例：[http ://www.sitepoint.com/table-based-layout-is-the-next-big-thing/](http://www.sitepoint.com/table-based-layout-is-the-next-big-thing/)

这是您的样式表的样子：

```
 .container {
    display: table;
    width:100%;
 }

 .left-column {
    display: table-cell;
 }

 .right-column {
    display: table-cell;
    width: 200px;
 } 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-15T09:03:12.360

套用我做类似事情的一个网站：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <style TYPE="text/css"><!--

.section {
    _float: right; 
    margin-right: 210px;
    _margin-right: 10px;
    _width: expression( (document.body.clientWidth - 250) + "px");
}

.navbar {
    margin: 10px 0;
    float: right;
    width: 200px;
    padding: 9pt 0;
}

  --></style>
 </head>
 <body>
  <div class="navbar">
  This will take up the right hand side
  </div>
  <div class="section">
  This will fill go to the left of the "navbar" div
  </div>
 </body>
</html> 
```

* * *

## 回答 #13

> 赞同：-6
> 
> 时间：2011-02-19T05:47:36.860

只需使用 z-index，一切都会很好。确保将位置标记为固定或绝对。那么什么都不会像浮动标签那样移动。

# wpf - WPF 中的凸版印刷

> ID：446063
> 
> 赞同：0
> 
> 时间：2009-01-15T08:50:34.570
> 
> 标签：wpf, .net-3.5

如何在 .NET WPF 中实现文本的凸版印刷效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T18:48:38.607

在您的文本和容器上使用斜角位图效果。一个组合就可以达到凸版印刷的效果。

# asp.net - 使用编码字符代替正确的字符

> ID：446073
> 
> 赞同：1
> 
> 时间：2009-01-15T08:53:52.363
> 
> 标签：asp.net, html, iframe, character-encoding

我有一个小问题，我希望你能帮我解决这个烦人的问题。

我需要在管理面板中使用 iFrame 来让用户使用选择服务，在 HTML 中我有：

```
<iframe scrolling="yes" runat="server" title="Par Selection" id="iFrame"
    frameborder="0" enableviewstate="true" width="100%" height="490" /> 
```

在我的代码隐藏文件中，我有：

```
iFrame.Attributes.Add("src", String.Format(
            "https://www.parurval.se/urval/?username={0}&password={1}",
            parSettings.GetSettings(parSettings.SettingsType.PARSelection, parSettings.SectionType.Username),
            parSettings.GetSettings(parSettings.SettingsType.PARSelection, parSettings.SectionType.Password))); 
```

输出是这样的：

```
<iframe id="tcMain_tabPARSelection_iFrame" scrolling="yes" title="Par Selection" 
   frameborder="0" width="100%" height="490" 
   src="https://www.parurval.se/urval/?username=myUsername&amp;password=myPassword">
</iframe> 
```

请**注意**在传递用户名和密码时**`&amp;`**改为登录 src 地址**`&`**

我怎样才能防止这种情况？

我尝试使用 HttpUtility.Decode(myCompleteUrl) 但取得了相同的成就:(

*最糟糕的是*，如果 src 代码只有地址

```
... src="https://www.parurval.se/urval/" ... 
```

我无法输入用户/密码，我看到表单并且可以输入文本，但它什么也没做，它只刷新 iframe 内页，在一个完整的窗口中执行此操作，工作正常。

在该管理面板中，我有一个文本框给用户添加用户名和密码，以便进入管理页面，我将直接跳转到 iFrame 中的服务，因此用户无需每次都输入用户/密码登录，这就是我试图动态添加这些值的方式。

有任何想法吗？

**补充：** 如果我将正确的 URL 地址（带有用户和密码）放在 HTML 端的 iFrame src 属性中（不是动态的），一切正常:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T09:02:18.210

& 的存在 实际上在那里是正确的。大多数浏览器都足够宽容，不会因为看到 & 就窒息，但这在技术上是不正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T09:02:47.073

“&” 是 HTML 中的特殊字符（更具体地说是 SGML），因此对其进行编码是正确的做法。是的，即使在链接 URL 中也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T12:14:02.147

[HTML 4.01 规范](http://www.w3.org/TR/REC-html40/charset.html#h-5.3.2)指出：

> 作者应使用“&” （ASCII 十进制 38）而不是“&”以避免与字符引用的开头混淆（实体引用打开分隔符）。作者还应该使用“&” [在属性值中，因为在CDATA](http://www.w3.org/TR/REC-html40/types.html#type-cdata)属性值中允许字符引用。

因此编码`&`as`&amp;`是正确的行为，因为`src`属性值（[CDATA 数据类型](http://www.w3.org/TR/REC-html40/types.html#type-cdata)）的解释被描述为：

> **CDATA**是来自文档字符集的字符序列，可能包括字符实体。用户代理应该如下解释属性值：
> 
> *   用字符替换字符实体，
> *   忽略换行，
> *   用一个空格替换每个回车符或制表符。

否则，`src`属性值 like`/foo?bar&sect=123`将是模棱两可的，因为它们可以按字面意思解释为`/foo?bar&sect=123`或（替换[`sect`实体](http://www.w3.org/TR/html4/sgml/entities.html#h-24.2.1)）为`/foo?bar§=123`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-15T09:00:23.863

这似乎是您可以利用 URL 编码来隐藏 &，绕过 XML 编码的情况。& 是 U+0025，因此您可以将其编码为 %25：[https](https://www.parurval.se/urval/?username=) ://www.parurval.se/urval/? username= {0}%25password={1}

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-15T09:02:09.367

你应该使用

```
 HttpUtility.HtmlEncode(String.Format("https://www.parurval.se/urval/?username={0}&password={1}",            
parSettings.GetSettings(parSettings.SettingsType.PARSelection, parSettings.SectionType.Username),            
parSettings.GetSettings(parSettings.SettingsType.PARSelection, parSettings.SectionType.Password))); 
```

# iphone - iPhone 开发 - 限制用户与应用程序的交互并显示进度指示器

> ID：446077
> 
> 赞同：6
> 
> 时间：2009-01-15T08:56:05.807
> 
> 标签：iphone, navigation, progress

我有一个案例，我从服务器中提取信息。我的应用程序同时具有标签栏和导航按钮。我希望应用程序显示进度指示器并禁用所有其他控件，以便用户在从服务器提取数据时不能跳来跳去。我怎样才能做到这一点？

我想到的一种方法是显示带有进度窗口的透明视图（很像消息警报窗口 - 它只允许用户与消息警报窗口交互）。我需要帮助来实施这种方法。

目前，当从服务器中提取信息/数据时，我将 UIActivityView 添加到子视图并开始对其进行动画处理。但这并不限制用户导航到应用程序的其他部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T10:39:35.210

Stephan 建议将 UIAlertView 与 UIProgressView 或 UIActivityIndi​​catorView 一起使用。这个解决方案对我有用，但正如与 iPhone 开发者社区的其他一些成员所讨论的那样，不推荐这种方法。

推荐的方法是使用一个新视图并将其透明度值设置为 alpha 7 或 8，将其背景设置为黑色，并在此视图中添加 UIProgressView 或 UIActivityIndi​​catorView 并使用此新视图来显示进度。使用此技术不涉及任何黑客攻击。同时，如果将 UIActivityIndi​​catorView 添加到 UIAlertView，您实际上会执行未记录的操作（不推荐）。

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:23:31.383

只需创建一个没有按钮的 UIAlertView，它将阻止任何用户交互。

如果需要，您可以将 UIProgressView 或 UIActivityIndi​​catorView 添加到警报中。

# visual-studio - 将任意设置移动到 Visual Studio 中的工具栏

> ID：446080
> 
> 赞同：2
> 
> 时间：2009-01-15T08:57:20.827
> 
> 标签：visual-studio, visual-studio-2005, ide-customization

我希望能够直接从工具栏修改 Visual Studio 的某个设置。具体来说，并行构建的数量（工具 | 选项 | 项目和解决方案 | 构建和运行 | 并行项目构建的最大数量）。它可以是工具栏上的一个编辑框，也可以是两个将其设置为特定值的按钮。

我使用 Visual Studio 2005。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T09:04:55.693

编写将修改这两个设置的宏，然后使用“Cusomtize”将宏放在工具栏上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T10:42:49.090

（几乎）任何 VS 命令或属性都有一个相应的可编写脚本的对象，您可以在宏中调用该对象。

执行 Alt-F11，进入宏编辑器，打开对象模型窗口并开始嗅探。您可以使用搜索来查找给定属性的相关类/函数（例如构建数）。找到它后，只需编写几行 VBA 行来更改它，然后按照[Ilya 的建议](https://stackoverflow.com/questions/446080/moving-an-arbitrary-setting-to-a-toolbar-in-visual-studio/446102#446102)，将该宏放在工具栏中。

顺便说一句，应该可以在工具栏中放置一个编辑框来获取值；但是仅仅调用 InputBox 或其他东西来询问用户输入可能会容易得多。

# spring - 我需要什么来抵消使用 Spring 框架引起的性能挫折？

> ID：446099
> 
> 赞同：1
> 
> 时间：2009-01-15T09:03:53.637
> 
> 标签：spring

我正在使用 Spring 和 Hibernate 来创建企业应用程序。

现在，由于框架对底层 J2EE 体系结构的抽象，我的应用程序显然会受到运行时性能的影响。

我需要知道的是一组我需要考虑的因素，以决定运行 RedHat Linux 3+ 并致力于运行的应用程序的单个主机服务器所需的最低规格（Proc 速度 + RAM 等）仅此应用程序，如果同时访问用户群每月增加 100，则效率得分为 10 分中的 8 分。

不使用聚类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T18:32:03.693

无意冒犯，但我敢打赌，性能问题更可能是由于您的应用程序代码而不是 Spring。

如果您查看他们编写源代码的方式，您会发现他们非常注重质量。

知道的唯一方法是分析您的应用程序，查看花费的时间，分析以确定根本原因，纠正它，冲洗，重复。那是科学。其他的都是猜测。

我已经在一个生产应用程序中使用了 Spring，它运行了三年并且还在不断增加。没有内存泄漏，没有丢失的连接，没有服务器反弹，没有性能问题。它就像黄油一样运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T00:27:57.080

Spring 通常用于在应用程序启动后不久创建长期存在的对象。在整个过程的生命周期中几乎没有性能成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T15:59:33.610

I've never heard that Spring creates any type of runtime performance hit. Since it uses mainly POJOs I'd be surprised if there was something wrong with it. Other than parsing a lot of XML on startup maybe, but that's solved by using annotations.

Just write your app first and then tune accordingly.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T10:15:20.390

As toolkit, I don't see Spring itself affecting the performance after initialization, but I think Hibernate will. How big this effect is, depends on a lot of details like the DB-Schema and how much relational layout differs from the OO layer and of course how DB-access is organized and how often DB-access happens etc. So I doubt, there is a rule of thumb to this. Just try out by developing significant prototypes using alternative applications servers or try a own small no-ORM-use-JDBC-version.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T09:13:08.533

我严重怀疑使用 Spring 会显着影响您的性能。

您预计 Spring 的哪些特定方面会导致性能问题？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T09:19:54.493

这里有很多变数，唯一的答案是“吸一口，看看”，但是，以科学的方式。

您需要构建一个服务器而不是对此进行基准测试。从一些“商品”设置开始，比如 4 核 cpu 和 2 gig ram，然后运行基准脚本来查看它是否满足您的需求。（很可能会！）。

如果它没有，您应该能够从基准测试中获得的 nulbers 计算所需的服务器大小 - 或者 - 修复性能问题，使其在您拥有的硬件上运行。

重要的是要确定是什么限制了你的表现。您是使用所有内核的服务器还是您的进程卡在单个内核上，您的 JVM 是否获得了足够的内存，您是 IO 绑定还是数据库绑定。

一旦您了解了限制因素，就很容易制定解决方案——要么提高程序的效率，要么购买更多合适的硬件。

使用 J2EE 需要注意两件事——大多数 JVM 具有过去十年的默认堆大小，确保你的 JVM 有足够的堆和堆栈（每个至少 1G！）——所有 JIT 编译都需要时间，对象缓存、模块加载等以安定下来——在开始基准测试之前至少锻炼你的系统一个小时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T10:31:20.480

哪个性能受挫？与什么有关？你在使用框架之前测量过性能吗？

如果 Spring 框架导致无法接受的性能问题，显而易见的解决方案是不使用它。

# video - 多重描述编码

> ID：446100
> 
> 赞同：4
> 
> 时间：2009-01-15T09:04:09.800
> 
> 标签：video, encoding, streaming, h.264

如何将 h264 视频编码为 MDC（多描述编码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-12T11:33:22.147

# 你不能（但是......）

今天不可能只选中现有软件上的一个框，流式传输编码为[h264](http://en.wikipedia.org/wiki/H264) MDC 的视频，对其进行解码并在浏览器中播放。没有 h264 MDC 配置文件。（如果没有您的意图的更多细节，我假设一般基于网络的流媒体视频。）

请注意，MDC 与“[比特率剥离](http://en.wikipedia.org/wiki/Bitrate_peeling)”不同，后者可以在 Real 的 SureStream 中找到。这基本上是将多个单独的流打包到一个媒体文件中进行播放。客户端和服务器协商发送哪个流。这与 MDC 有着根本的不同。

也就是说，MDC 还处于早期阶段，而且它仍然主要是学术性的。它没有标准（还没有），没有生产完整的源->编码器->解码器->目标路径实现（如果有的话）。

如果您想对 h264 MDC 进行编码（显然是流式传输然后解码），您将不得不跳入学术界并可能自己编写它。

# c# - 如何获取 ControlPaint 绘制的边框宽度？

> ID：446104
> 
> 赞同：2
> 
> 时间：2009-01-15T09:05:34.337
> 
> 标签：c#, .net, winforms

我正在使用 System.Windows.ControlPaint.DrawBorder3D 绘制边框，并希望在边框内绘制矩形。如何获得边框的宽度，以便在其中找到矩形？

更新：使用默认主题，边框顶部和左侧为 2px，但底部和右侧只有 1px，因此 SystemInformation.Border3DSize 还不够。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T09:26:20.487

这两个“朋友”可以帮助你吗？

*   SystemInformation.Border3DSize.Height
*   SystemInformation.Border3DSize.Width

# asp.net - 无空格黑白文本的正则表达式

> ID：446108
> 
> 赞同：5
> 
> 时间：2009-01-15T09:06:25.457
> 
> 标签：asp.net, regex

请告诉我如何检查正则表达式中没有空格的黑白文本。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-15T10:35:24.297

如果您的意思是“检查字符串中没有空格的正则表达式是什么”，则以下模式将起作用：

```
^[\S]*$ 
```

这将找到任何仅包含非空格（空格、换行符、制表符等）的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:36:41.310

I don't know if it is the regular expression you are looking for but, `[:space:]` will match any whitespace character, while `[:blank:]` will match space and tab characters only.

Both are used inside square brackets, e.g. `[[:space:]]`

# linq - LINQ to SQL 插入

> ID：446109
> 
> 赞同：2
> 
> 时间：2009-01-15T09:06:57.453
> 
> 标签：linq, linq-to-sql

我正在使用 LINQ To SQL 通过 db.table.InsertOnSubmit() 执行插入。我想知道是否有一种方法可以将“不存在的地方（选择等）开始插入等结束”的 T-SQL 版本作为一个查询来重现？谢谢，马丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T09:55:02.597

LINQ has an extension method called Contains which allows for this functionality. This can be seen in the following example:

```
NorthwindDataContext dc = new NorthwindDataContext();
dc.Log = Console.Out;
var query =
    from c in dc.Customers
    where !(from o in dc.Orders
            select o.CustomerID)
           .Contains(c.CustomerID)
    select c;
foreach (var c in query) Console.WriteLine( c ); 
```

Note the negation on the where clause!

This example was from the website [here](http://programminglinq.com/blogs/marcorusso/archive/2008/01/14/the-not-in-clause-in-linq-to-sql.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T09:24:47.933

据我所知，没有任何内容，我们将不得不使用 where 手动查找行，而不是插入。

在此类查询中可能存在种族代码。看看这个线程以获得详细的解决方案：

[http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/b1a0eb5b-d5d3-41af-829f-bbbac47b7383/](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/b1a0eb5b-d5d3-41af-829f-bbbac47b7383/)

# .net - 在 TLBIMP-ed dll 之后手动生成 ActiveX 包装器？

> ID：446121
> 
> 赞同：3
> 
> 时间：2009-01-15T09:19:15.837
> 
> 标签：.net, com, activex, tlbimp

我有几个需要从 C# 项目访问的 ActiveX 组件。

我可以通过 Visual Studio 的添加引用对话框导入它们，该对话框还将自动生成包装器类。（即`ABCLib`和`AxABCLib`）

我知道我可以通过`TLBIMP /primary`在每个单独的 OCX 文件上运行来手动生成主互操作程序集，但我找不到生成 ActiveX 包装器的方法，除非我通过 Visual Studio 用户界面执行此操作。

是否有在 .NET SDK 中生成 ActiveX 包装器的命令行版本？

我想`AxABCLib`从手动从 TLBIMP 获得的 PIA 生成版本。（即设置命名空间、输出 dll 文件名等）有可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T09:25:15.857

哦……看了TLBIMP所属的文件夹后找到了。

它被称为`AxImp`。

`C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\AxImp.exe`

所以基本上，要在您自己的自定义命名空间中生成 PIA DLL：

1.  注册您的 OCX

    `regsvr32 abc.ocx`

2.  通过运行为您的 ocx 生成一个强名称密钥对

    `sn -k`

3.  运行 TLBIMP 并指定所需的命名空间

    `tlbimp abc.ocx /primary /keyfile:abc.snk /out:abc.dll /namespace:MyNamespace`

4.  在 ocx 上运行 AXIMP 并使用`rcw`开关来使用您自己手动生成的 PIA DLL。

    `aximp abc.ocx /source /rcw:abc.dll`

那应该这样做。

然而，古代 TLB 的进口存在一些问题。我还不确定如何解决这个问题。

# nhibernate - 如何在 Code Smith 中合并 XML 文件？

> ID：446125
> 
> 赞同：2
> 
> 时间：2009-01-15T09:20:02.887
> 
> 标签：nhibernate, codesmith

我正在使用 CodeSmith 在我的项目中生成文件。它具有使用插入区域和保留区域策略合并 C#/VB 和 SQL 文件的功能。

如何扩展这些以合并我正在创建的 XML 文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T19:48:24.563

实际上，CodeSmith 支持合并 XML 文件，就像它使用区域合并 C# 和 VB 文件一样。您只需要使用 <!-- region Some Region Name --> 和 <!-- endregion --> 来标记和命名您的代码区域。

这有帮助还是您需要更多信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-04T11:33:41.807

对于 T-SQL，您的代码需要如下所示：

RegionNameRegex 应该设置为 ^[ \t] *[ \s]* "?(?i:Custom)"?; 语言应设置为“T-SQL”；

您的区域应如下所示：

--region 自定义参数

--endregion

我创建了一个示例模板，位于[此处](http://community.codesmithtools.com/forums/p/10847/41407.aspx#41407)。

谢谢-布莱克·涅米斯基

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-28T16:58:54.183

为 SQL 保留区域的语法是什么？是吗：

--region 一些区域名称
--endregion

或者是其他东西？

# regex - 正则表达式匹配和分组

> ID：446126
> 
> 赞同：1
> 
> 时间：2009-01-15T09:20:23.277
> 
> 标签：regex

这是一个示例字符串，我想对其进行正则表达式

```
101-nocola_conte_-_fuoco_fatuo_(koop_remix) 
```

“101”中的第一位数字是光盘编号，接下来的 2 位数字是轨道编号。如何匹配曲目编号并忽略光盘编号（第一位）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T09:25:19.383

就像是

```
/^\d(\d\d)/ 
```

将匹配字符串开头的一位数字，然后捕获以下两位数字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:25:50.193

```
^\d(\d\d) 
```

您可能需要`\`在前面`(`取决于您打算将正则表达式运行到哪个环境（如`vi(1)`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T09:28:18.847

你的意思是你不介意磁盘号是什么，但你想匹配，比如轨道号 01 ？

在 perl 中，你会像这样匹配它：“^[0-9]01.*”
或更简单的“^.01.*”——这意味着你甚至不介意第一个字符不是数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T09:30:25.487

哪种编程语言？对于 shell，使用 egrep 的东西可以完成这项工作：

```
echo '101-nocola_conte_-_fuoco_fatuo_(koop_remix)' | egrep -o '^[0-9]{3}' | egrep -o '[0-9]{2}$' 
```

# c# - Windows 窗体中的默认按钮点击（试图找到最佳解决方案）

> ID：446147
> 
> 赞同：9
> 
> 时间：2009-01-15T09:30:27.483
> 
> 标签：c#, .net, windows, winforms

问题是：如何使默认按钮专注于表单焦点并响应“Enter”命中，但当插入符号位于文本框中且多行属性设置为 true 时不聚焦？..我知道我可以做一些例外在代码中，但也许有一些我现在不知道的“最佳实践”:(谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-15T09:40:52.720

也许我误会了你，但我会做的是：

1.  将表单的“AcceptButton”设置为您要在“Enter”上响应的按钮
2.  将多行文本框的“AcceptsReturn”设置为 true

瞧瞧

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T09:43:19.127

[（编辑-这里](https://stackoverflow.com/questions/446147/default-button-hit-in-windows-forms-trying-to-find-the-best-solution#446177)的答案非常适合`TextBox`；这种模式可能对其他缺少`AcceptsReturn`或等效的控件很有用）

您可以使用`GotFocus`和`LostFocus`事件来`AcceptButton`相当容易地更改，例如：

```
[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    TextBox multi, single;
    Button btn;
    using(Form form = new Form {
            Controls = {
                (multi= new TextBox { Multiline = true, Dock = DockStyle.Fill}),
                (btn = new Button { Text = "OK", Dock = DockStyle.Bottom,
                    DialogResult = DialogResult.OK}),
                (single = new TextBox { Multiline = false, Dock = DockStyle.Top}),
            }, AcceptButton = btn                
        })
    {
        multi.GotFocus += delegate { form.AcceptButton = null; };
        multi.LostFocus += delegate { form.AcceptButton = btn; };
        btn.Click += delegate { form.Close(); };
        Application.Run(form);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T09:42:08.723

Windows 窗体有两个属性：AcceptButton 和 CancelButton。您可以将这些设置为引用表单上的按钮控件。AcceptButton 告诉当用户按下回车键时应该点击哪个按钮，而 Cancel 按钮告诉当用户按下退出键时应该点击哪个按钮。

通常，您会将 AcceptButton 的 DialogResult 设置为 DialogResult.OK 或 DialogResult.Yes，将 CancelButton 设置为 DialogResult.Cancel 或 DialogResult.No。这确保您可以轻松地检查在您以模态方式显示表单时单击了哪个按钮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T09:50:18.257

或者您可以在文本框的焦点事件中执行此操作，如

```
_targetForm.AcceptButton = _targetForm.btnAccept; 
```

然后用多行将其合并到另一个文本框中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-02T08:08:17.863

在 Form_Load 上，设置

```
this.AcceptButton = buttonName; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-15T14:26:09.967

执行以下操作：

```
private void Login_Load(object sender, EventArgs e)
{
    this.AcceptButton = btnLogin;
} 
```

# php - 纯 PHP rrdtool

> ID：446148
> 
> 赞同：2
> 
> 时间：2009-01-15T09:30:40.480
> 
> 标签：php, rrdtool

有谁知道rrdtool的纯php实现？我用谷歌搜索了这个问题，但只找到了有关连接 PHP 和 rrd 的答案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T01:42:23.070

我认为这可能会破坏目的。虽然我看到了用一种可以调整/编辑的语言拥有如此有用的工具的吸引力，但我认为 RRDtool 令人难以置信的用处来自它在 C++ 中的使用——因此非常快速和可扩展。在 PHP 中实现同样的功能当然是可能的，但会很麻烦。

正如你所说，除了接口之外，还没有找到任何 PHP 替代品。也许使用 Cacti 之类的东西来处理所有数据，然后编写一个自定义绘图器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T03:06:20.947

我没见过像你描述的那样。我发现的几乎所有东西都是包装器或接口。主要的 RRDTool 网站有一个包含这些类型项目的小目录，它们只有关于各种包装器/接口的信息。

# c# - 通过 Javascript ASP.Net 修改后在服务器上访问 ListBox 值

> ID：446149
> 
> 赞同：1
> 
> 时间：2009-01-15T09:31:21.227
> 
> 标签：c#, asp.net, listbox

我有一个列表框，我正在通过 javascript 操作其值，例如将新项目添加到列表中。现在，当我尝试从服务器访问此列表框时，它仅向我显示 PageLoad 中最初属于列表框的值。新添加的项目不可访问。

如何在服务器上访问那些新添加的项目

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:11:46.540

您需要使用 Request.Params["YourListBoxID'] 来读取添加的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:23:25.330

我会看看你在哪里填充列表，看看你是在每次页面加载时填充它还是仅在`!Page.IsPostBack`. 如果您在每次页面加载时加载列表的内容，您将使用原始数据清除来自客户端的任何更改。

你会想做这样的事情：

```
if (!Page.IsPostBack)
{
    // load your list up
} 
```

这意味着在随后的回发中，您的列表不会从您的数据源中刷新，也不会覆盖任何客户端更改。

# language-agnostic - 在给定范围内生成均匀随机偏差

> ID：446153
> 
> 赞同：0
> 
> 时间：2009-01-15T09:32:56.090
> 
> 标签：language-agnostic, random

我想在给定范围内生成均匀分布的随机整数。我使用的解释型语言有一个内置的快速随机数生成器，它返回 0（含）到 1（含）范围内的浮点数。不幸的是，这意味着我不能使用[在另一个 SO 问题中看到的标准解决方案](https://stackoverflow.com/questions/363681/java-generating-random-number-in-a-range#363732)（当 RNG 返回 0（包括）到 1（不包括）之间的数字时）在给定范围内生成均匀分布的随机整数：

```
result=Int((highest - lowest + 1) * RNG() + lowest) 
```

目前我能看到的唯一合理的方法是在极少数情况下随机数生成器返回 1 只是要求一个新数字。

但如果有人知道更好的方法，我会很高兴听到它。

抢

注意：将现有的随机数生成器转换为这种语言会导致速度非常慢，所以恐怕这不是一个可行的解决方案。

编辑：链接到实际的 SO 答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:23:02.253

大概你对速度非常感兴趣，否则你会在每次 RNG 调用时都接受条件测试。无论如何，任何其他选择都可能比分支慢......

...除非您确切知道 RNG 的内部结构是什么。特别是，它的返回值是多少？如果它们不是 IEEE-754 浮点数或双精度数，我表示同情。如果是，它们中有多少真正的随机性？您会期望浮点数为 24，双精度数为 53（尾数位数）。如果这些是天真的生成的，您可以使用移位和掩码从它们中破解一个普通的旧随机整数生成器，然后在您的函数中使用它（取决于您的范围的大小，您可以使用如果您有这样的生成器，则需要更多的班次和掩码以避免任何分支）。如果您有一个高质量的生成器，它可以生成完整的 24 位或 53 位随机数，那么通过一次乘法，您可以将它们从 [0,1] 转换为 [0,1)：只需乘以小于 1 的最大可生成浮点数，您的范围问题就消失了。如果尾数没有完全填充随机位，这个技巧仍然有效，但你需要做更多的工作才能找到正确的乘数。

您可能想查看[Mersenne Twister 的 C 源代码，](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/CODES/mt19937ar.c)以了解他们对类似问题的处理。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-15T09:48:44.310

我不明白为什么`+ 1`需要。如果随机数生成器在 [0,1] 区间内提供均匀分布的值，则...

```
result = lowest + (rng() * (highest - lowest)) 
```

应该给你一个最低值之间的不均匀分布

`rng() == 0, result = lowest + 0 = lowest`

和最高

`rng() == 1, result = lowest + highest - lowest = highest`

包括 + 1 表示生成数的上限可以高于最高

`rng() == 1, result = lowest + highest - lowest + 1 = highest + 1`.

由此产生的值分布将与随机数的分布相同，因此均匀性取决于随机数生成器的质量。

根据您在下面的评论，您正确地指出 Int() 将是尾部不平衡分布的来源。最好使用 Round() 到最接近的整数或脚本语言中的任何等效值。

# asp.net-mvc - 为什么 ASP.NET MVC URL 路由找不到我的控制器？

> ID：446179
> 
> 赞同：1
> 
> 时间：2009-01-15T09:43:00.923
> 
> 标签：asp.net-mvc, routing

在 RegisterRoutes 方法的 Global.asax.cs 文件中，我把

```
routes.MapRoute("messages", 
    "Message/{id}", 
    new { controller = "Archive", action = "Message", id = 0 }); 
```

然后我创建了这个控制器：

```
namespace TestingApp.Controllers
{
    public class ArchiveController : Controller
    {
        public string Message(int id)
        {
            return "testing: you will receive the message: " + id.ToString();
        }
    }
} 
```

但是在我的浏览器中，当我去：

```
http://.../Message/34 
```

我得到一个404。

我还需要定义什么才能让路由找到我的控制器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T10:31:54.100

尝试在默认路由之前定义您的特定路由：

```
routes.MapRoute(
    "messages",
    "Message/{id}",
    new { controller = "Archive", action = "Message", id = 0 });

routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = "" }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T10:38:26.317

我认为您的 Message 方法应该返回一个 ActionResult 实例：

```
public ActionResult Message(int id)
{
    return new ContentResult {
        Content = "testing: you will receive the message: " + id.ToString()
    };
} 
```

# c# - 如何在 ASP.NET MVC 中进行分页？

> ID：446196
> 
> 赞同：88
> 
> 时间：2009-01-15T09:50:20.890
> 
> 标签：c#, asp.net, asp.net-mvc

在 ASP.NET MVC 中进行分页的最首选和最简单的方法是什么？即，将列表分解为几个可浏览页面的最简单方法是什么。

例如，假设我从数据库/网关/存储库中获取元素列表，如下所示：

```
public ActionResult ListMyItems()
{
    List<Item> list = ItemDB.GetListOfItems();
    ViewData["ItemList"] = list;

    return View();
} 
```

为简单起见，我只想为我的操作指定一个页码作为参数。像这样：

```
public ActionResult ListMyItems(int page)
{
   //...
} 
```

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-01-15T10:11:49.117

那么，数据源是什么？您的操作可能需要一些默认参数，即

```
ActionResult Search(string query, int startIndex, int pageSize) {...} 
```

在路由设置中默认设置，因此 startIndex 为 0，pageSize 为（例如）20：

```
 routes.MapRoute("Search", "Search/{query}/{startIndex}",
                        new
                        {
                            controller = "Home", action = "Search",
                            startIndex = 0, pageSize = 20
                        }); 
```

要拆分提要，您可以很容易地使用 LINQ：

```
var page = source.Skip(startIndex).Take(pageSize); 
```

（如果您使用“pageNumber”而不是“startIndex”，则进行乘法运算）

使用 LINQ-toSQL、EF 等 - 这也应该“组合”到数据库。

然后，您应该能够使用操作链接到下一页（等）：

```
<%=Html.ActionLink("next page", "Search", new {
                query, startIndex = startIndex + pageSize, pageSize }) %> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-01-15T14:35:30.027

我也想在前端介绍一种简单的方法：

**控制器：**

```
public ActionResult Index(int page = 0)
{
    const int PageSize = 3; // you can always do something more elegant to set this

    var count = this.dataSource.Count();

    var data = this.dataSource.Skip(page * PageSize).Take(PageSize).ToList();

    this.ViewBag.MaxPage = (count / PageSize) - (count % PageSize == 0 ? 1 : 0);

    this.ViewBag.Page = page;

    return this.View(data);
} 
```

**看法：**

```
@* rest of file with view *@

@if (ViewBag.Page > 0)
{
    <a href="@Url.Action("Index", new { page = ViewBag.Page - 1 })" 
       class="btn btn-default">
        &laquo; Prev
    </a>
}
@if (ViewBag.Page < ViewBag.MaxPage)
{
    <a href="@Url.Action("Index", new { page = ViewBag.Page + 1 })" 
       class="btn btn-default">
        Next &raquo;
    </a>
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-15T11:52:22.580

我遇到了同样的问题，并为 Pager Class 找到了一个非常优雅的解决方案

[http://blogs.taiga.nl/martijn/2008/08/27/paging-with-aspnet-mvc/](http://blogs.taiga.nl/martijn/2008/08/27/paging-with-aspnet-mvc/)

在您的控制器中，调用如下所示：

```
return View(partnerList.ToPagedList(currentPageIndex, pageSize)); 
```

在您看来：

```
<div class="pager">
    Seite: <%= Html.Pager(ViewData.Model.PageSize, 
                          ViewData.Model.PageNumber,
                          ViewData.Model.TotalItemCount)%>
</div> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-11-29T11:31:38.910

这是一个帮助我解决这个问题[的链接。](https://docs.microsoft.com/en-us/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application#add-paging-to-the-students-index-page)

它使用 PagedList.MVC NuGet 包。我将尝试总结步骤

1.  **安装 PagedList.MVC NuGet 包**

2.  **构建项目**

3.  **添加** `using PagedList;` **到控制器**

4.  **修改您的操作以设置页面** `public ActionResult ListMyItems(int? page) { List list = ItemDB.GetListOfItems(); int pageSize = 3; int pageNumber = (page ?? 1); return View(list.ToPagedList(pageNumber, pageSize)); }`

5.  **在视图底部添加分页链接** `@*Your existing view*@ Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount @Html.PagedListPager(Model, page => Url.Action("Index", new { page, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter }))`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-12T06:59:34.613

控制器

```
 [HttpGet]
    public async Task<ActionResult> Index(int page =1)
    {
        if (page < 0 || page ==0 )
        {
            page = 1;
        }
        int pageSize = 5;
        int totalPage = 0;
        int totalRecord = 0;
        BusinessLayer bll = new BusinessLayer();
        MatchModel matchmodel = new MatchModel();
        matchmodel.GetMatchList = bll.GetMatchCore(page, pageSize, out totalRecord, out totalPage);
        ViewBag.dbCount = totalPage;
        return View(matchmodel);
    } 
```

商业逻辑

```
 public List<Match> GetMatchCore(int page, int pageSize, out int totalRecord, out int totalPage)
    {
        SignalRDataContext db = new SignalRDataContext();
        var query = new List<Match>();
        totalRecord = db.Matches.Count();
        totalPage = (totalRecord / pageSize) + ((totalRecord % pageSize) > 0 ? 1 : 0);
        query = db.Matches.OrderBy(a => a.QuestionID).Skip(((page - 1) * pageSize)).Take(pageSize).ToList();
        return query;
    } 
```

显示总页数的视图

```
 if (ViewBag.dbCount != null)
    {
        for (int i = 1; i <= ViewBag.dbCount; i++)
        {
            <ul class="pagination">
                <li>@Html.ActionLink(@i.ToString(), "Index", "Grid", new { page = @i },null)</li> 
            </ul>
        }
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-21T04:03:34.480

我认为在 ASP.NET MVC 应用程序中创建分页的最简单方法是使用 PagedList 库。

以下 github 存储库中有一个完整的示例。希望它会有所帮助。

```
public class ProductController : Controller
{
    public object Index(int? page)
    {
        var list = ItemDB.GetListOfItems();

        var pageNumber = page ?? 1; 
        var onePageOfItem = list.ToPagedList(pageNumber, 25); // will only contain 25 items max because of the pageSize

        ViewBag.onePageOfItem = onePageOfProducts;
        return View();
    }
} 
```

演示链接：[http ://ajaxpagination.azurewebsites.net/](http://ajaxpagination.azurewebsites.net/)

源代码：[https ://github.com/ungleng/SimpleAjaxPagedListAndSearchMVC5](https://github.com/ungleng/SimpleAjaxPagedListAndSearchMVC5)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-14T10:57:05.657

实体

```
public class PageEntity
{
    public int Page { get; set; }
    public string Class { get; set; }
}

public class Pagination
{
    public List<PageEntity> Pages { get; set; }
    public int Next { get; set; }
    public int Previous { get; set; }
    public string NextClass { get; set; }
    public string PreviousClass { get; set; }
    public bool Display { get; set; }
    public string Query { get; set; }
} 
```

HTML

```
<nav>
    <div class="navigation" style="text-align: center">
        <ul class="pagination">
            <li class="page-item @Model.NextClass"><a class="page-link" href="?page=@(@Model.Previous+@Model.Query)">&laquo;</a></li>
            @foreach (var item in @Model.Pages)
            {
                <li class="page-item @item.Class"><a class="page-link" href="?page=@(item.Page+@Model.Query)">@item.Page</a></li>
            }
            <li class="page-item @Model.NextClass"><a class="page-link" href="?page=@(@Model.Next+@Model.Query)">&raquo;</a></li>
        </ul>
    </div>
 </nav> 
```

分页逻辑

```
public Pagination GetCategoryPaging(int currentPage, int recordCount, string query)
{
    string pageClass = string.Empty; int pageSize = 10, innerCount = 5;

    Pagination pagination = new Pagination();
    pagination.Pages = new List<PageEntity>();
    pagination.Next = currentPage + 1;
    pagination.Previous = ((currentPage - 1) > 0) ? (currentPage - 1) : 1;
    pagination.Query = query;

    int totalPages = ((int)recordCount % pageSize) == 0 ? (int)recordCount / pageSize : (int)recordCount / pageSize + 1;

    int loopStart = 1, loopCount = 1;

    if ((currentPage - 2) > 0)
    {
        loopStart = (currentPage - 2);
    }

    for (int i = loopStart; i <= totalPages; i++)
    {
        pagination.Pages.Add(new PageEntity { Page = i, Class = string.Empty });

        if (loopCount == innerCount)
        { break; }

        loopCount++;
    }

    if (totalPages <= innerCount)
    {
        pagination.PreviousClass = "disabled";
    }

    foreach (var item in pagination.Pages.Where(x => x.Page == currentPage))
    {
        item.Class = "active";
    }

    if (pagination.Pages.Count() <= 1)
    {
        pagination.Display = false;
    }

    return pagination;
} 
```

使用控制器

```
public ActionResult GetPages()
{
    int currentPage = 1; string search = string.Empty;
    if (!string.IsNullOrEmpty(Request.QueryString["page"]))
    {
        currentPage = Convert.ToInt32(Request.QueryString["page"]);
    }

    if (!string.IsNullOrEmpty(Request.QueryString["q"]))
    {
        search = "&q=" + Request.QueryString["q"];
    }
    /* to be Fetched from database using count */
    int recordCount = 100;

    Place place = new Place();
    Pagination pagination = place.GetCategoryPaging(currentPage, recordCount, search);

    return PartialView("Controls/_Pagination", pagination);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-12T06:58:50.040

```
public ActionResult Paging(int? pageno,bool? fwd,bool? bwd)        
{
    if(pageno!=null)
     {
       Session["currentpage"] = pageno;
     }

    using (HatronEntities DB = new HatronEntities())
    {
        if(fwd!=null && (bool)fwd)
        {
            pageno = Convert.ToInt32(Session["currentpage"]) + 1;
            Session["currentpage"] = pageno;
        }
        if (bwd != null && (bool)bwd)
        {
            pageno = Convert.ToInt32(Session["currentpage"]) - 1;
            Session["currentpage"] = pageno;
        }
        if (pageno==null)
        {
            pageno = 1;
        }
        if(pageno<0)
        {
            pageno = 1;
        }
        int total = DB.EmployeePromotion(0, 0, 0).Count();
        int  totalPage = (int)Math.Ceiling((double)total / 20);
        ViewBag.pages = totalPage;
        if (pageno > totalPage)
        {
            pageno = totalPage;
        }
        return View (DB.EmployeePromotion(0,0,0).Skip(GetSkip((int)pageno,20)).Take(20).ToList());     
    }
}

private static int GetSkip(int pageIndex, int take)
{
    return (pageIndex - 1) * take;
}

@model IEnumerable<EmployeePromotion_Result>
@{
  Layout = null;
}

 <!DOCTYPE html>

 <html>
 <head>
    <meta name="viewport" content="width=device-width" />
    <title>Paging</title>
  </head>
  <body>
 <div> 
    <table border="1">
        @foreach (var itm in Model)
        {
 <tr>
   <td>@itm.District</td>
   <td>@itm.employee</td>
   <td>@itm.PromotionTo</td>
 </tr>
        }
    </table>
    <a href="@Url.Action("Paging", "Home",new { pageno=1 })">First  page</a> 
    <a href="@Url.Action("Paging", "Home", new { bwd =true })"><<</a> 
    @for(int itmp =1; itmp< Convert.ToInt32(ViewBag.pages)+1;itmp++)
   {
       <a href="@Url.Action("Paging", "Home",new { pageno=itmp   })">@itmp.ToString()</a>
   }
    <a href="@Url.Action("Paging", "Home", new { fwd = true })">>></a> 
    <a href="@Url.Action("Paging", "Home", new { pageno =                                                                               Convert.ToInt32(ViewBag.pages) })">Last page</a> 
</div>
   </body>
  </html> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-24T06:24:43.123

可以创建可重用的分页。我们需要的是：

*   部分视图以存储页面数量和指向它们的链接
*   包含分页逻辑的可重用方法`IQueryable`

[可以在此处查看带有源代码的完整示例。](https://www.codeproject.com/Articles/5309671/Reusable-Pagination-in-ASP-NET-MVC)

所以我们的代码是这样的：

人表。我使用过 SQL Server：

```
IF NOT EXISTS 
(
    SELECT 1
    FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Person'
    AND TABLE_SCHEMA = 'dbo'
)
BEGIN
    CREATE TABLE dbo.Person 
    (
          ID                 INT                 IDENTITY(1, 1) NOT NULL PRIMARY KEY
        , CreateDate         DATETIME            NOT NULL DEFAULT GETDATE()
        , Creator            VARCHAR(100)        NOT NULL
        , ModifyDate         DATETIME            NULL
        , Modifier           VARCHAR(20)         NULL

        , FirstName          VARCHAR(150)        NOT NULL
        , LastName           VARCHAR(1000)       NOT NULL        
    )
ON [PRIMARY]
END
GO 
```

我使用了 DatabaseFirst 方法。这是实体框架生成的类。

```
public partial class Person
{
    public int ID { get; set; }
    public System.DateTime CreateDate { get; set; }
    public string Creator { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public Nullable<System.DateTime> ModifyDate { get; set; }
    public string Modifier { get; set; }
} 
```

这是一个包含数据和分页信息的类：

```
public class DataResultViewModel<T>
{
    /// <summary>
    /// Data items
    /// </summary>
    public IEnumerable<T> Items { get; set; }

    /// <summary>
    /// Pagination
    /// </summary>
    public Pagination Pagination { get; set; }
} 
```

这是包含有关人员信息的类。

```
public class PersonViewModel
{
    public int ID { get; set; }

    public string FirstName { get; set; }

    public string LastName { get; set; }
}

/// <summary>
/// What route should be requested while paging
/// </summary>
public class RouteInfo
{
    /// <summary>
    /// Name of controller
    /// </summary>
    public string ControllerName { get; set; }

    /// <summary>
    /// Name of action
    /// </summary>
    public string ActionName { get; set; }
} 
```

和分页类：

```
public class Pagination
{
    /// <summary>
    /// Total count of items
    /// </summary>
    public int TotalItems { get; set; }

    /// <summary>
    /// Count of items at the page
    /// </summary>
    public int PageSize { get; set; } = 5;

    /// <summary>
    /// Current page
    /// </summary>
    public int Page { get; set; }

    /// <summary>
    /// Sorted by field name
    /// </summary>
    public string SortBy { get; set; }

    /// <summary>
    /// Is this an ascending sort?
    /// </summary>
    public bool IsSortAscending { get; set; }

    /// <summary>
    /// Information about what page should be requested
    /// </summary>
    public RouteInfo RouteInfo { get; set; }
} 
```

以及进行分页的类。基本上，`Skip()`Take`()`是进行分页的方法，所以我们需要对所有`IQueryable`. C# 有一个非常简洁的特性，叫做扩展方法。扩展方法允许重用代码：

```
public static class IQueryableExtension
{
    public static IQueryable<T> UseOrdering<T, TResultSelector>(this IQueryable<T> query, 
        Pagination pagination,
             Expression<Func<T, TResultSelector>> field)
    {
        if (string.IsNullOrWhiteSpace(pagination.SortBy) 
            || string.IsNullOrEmpty(pagination.SortBy))
            return query;

        return pagination.IsSortAscending ?
            query.OrderBy(field) :
            query.OrderByDescending(field);
    }

    public static IQueryable<T> UsePagination<T>(this IQueryable<T> query, 
        Pagination pagination)
    {
        if (pagination.Page <= 0)
            pagination.Page = 1;

        if (pagination.PageSize <= 0)
            pagination.PageSize = 10;

         return query.Skip((pagination.Page - 1) * pagination.PageSize)
             .Take(pagination.PageSize);
    }
} 
```

这是一类服务层：

```
public class PersonService
{
    public DataResultViewModel<PersonViewModel> GetWithPagination(Pagination pagination,
        Expression<Func<Person, DateTime>> fieldName)
    {
        var result = new DataResultViewModel<PersonViewModel>();

        using (var db = new MiscellaneousEntities())
        {
            var persons = db.Person.AsQueryable();

            result.Pagination = pagination;
            result.Pagination.TotalItems = persons.Count();
            result.Pagination.RouteInfo = new RouteInfo() 
            {
                ActionName = "Index", 
                ControllerName = "Person"
            };

            if (pagination.SortBy == null)
                pagination.SortBy = "CreateDate";
            persons = persons.UseOrdering(pagination, fieldName);
            persons = persons.UsePagination(pagination);

            result.Items = persons
                .Select(s => new PersonViewModel()
                {
                    ID = s.ID,
                    FirstName = s.FirstName,
                    LastName = s.LastName
                })
                .ToList();

             return result;
        }
    }
} 
```

人和控制人：

```
public class PersonController : Controller
{
    PersonService _personService;

    public PersonController()
    {
        _personService = new PersonService();
    }

    // GET: Person
    public ActionResult Index(int? page, int? pageSize, string sortBy,
        bool? isSortAscending)
    {
        return View
            (_personService.GetWithPagination(new Pagination()
                {
                    Page = page ?? 1,
                    PageSize = pageSize ?? 3,
                    SortBy = sortBy,
                    IsSortAscending = isSortAscending ?? false
                },
                v => v.CreateDate
                )
            );
    }
} 
```

然后我们应该创建视图。

这是一个应该分页的人物视图：

```
@model  OnlyPagination.ViewModel.DataResultViewModel<OnlyPagination.ViewModel.PersonViewModel>

<div class="d-flex justify-content-center">
    <div>
        @foreach (var item in Model.Items)
        {
            <div>
                <p>Id is @item.ID</p>
                <p>FirstName is @item.FirstName</p>
                <p>LastName is @item.LastName</p>
            </div>
            <hr />
        }
    </div>
</div>

<div class="d-flex justify-content-center">
    @{
        @Html.Partial("Pagination", Model.Pagination)
    }
</div> 
```

它是一个可重用的分页局部视图：

```
@model OnlyPagination.Extensions.Query.Model.Pagination

@{
    var pagesCount = Math.Ceiling((decimal)Model.TotalItems / (decimal)Model.PageSize);
    var pages = new List<int>();

    for (var i = 1; i <= pagesCount; i++)
    {
        pages.Add(i);
    }
}

<div>
    <p class="d-flex justify-content-center">Page @Model.Page of @pagesCount</p>

    <ul class="pagination">
        <li class="page-item @( Model.Page == 1 ? "disabled" : "" )">
            <a aria-label="Previous" class="page-link"
                href="@Url.Action
                (Model.RouteInfo.ActionName, Model.RouteInfo.ControllerName,
                new { page = Model.Page - 1, pageSize = Model.PageSize })">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        @for (int pageNumber = 1; pageNumber <= pages.Count; pageNumber++)
        {
            <li class="page-item @( Model.Page == pageNumber ? "active" : "" )">
                <a class="page-link"
                    href="@Url.Action(Model.RouteInfo.ActionName, 
                        Model.RouteInfo.ControllerName,
                        new { page = pageNumber, pageSize = Model.PageSize })"> 
                        @pageNumber </a>
                </li>
            }

        <li class="page-item @(Model.Page == pages.Count ? "disabled" : "")">
            <a aria-label="Next" class="page-link"
                href="@Url.Action
                      (Model.RouteInfo.ActionName, Model.RouteInfo.ControllerName,
                      new { page = Model.Page + 1, pageSize = Model.PageSize })">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</div> 
```

就这样！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-03T11:23:07.197

在 ASP .NET 应用程序中插入页面分页，首先需要从项目的 NuGet 包中安装 Paged List 和 PagedList.MVC。

然后我包含了从数据库返回书籍列表的示例方法。我包括页面分页以在每页中显示 4 个项目。

```
public ActionResult Books(int? i)
    {
        IEnumerable<Books> BooksList;
        HttpResponseMessage response = GlobalVariables.webApiClient.GetAsync("Tbl_Books").Result;
        BooksList = response.Content.ReadAsAsync<IEnumerable<Books>>().Result;
        return View(BooksList.ToList().ToPagedList(i ?? 1, 4));
    } 
```

在“查看”页面中，这应该包括在内。

```
@Html.PagedListPager(Model, i => Url.Action("Books", "Library", new { i })) 
```

# calculated-columns - Hiding columns when running a query

> ID：446198
> 
> 赞同：-1
> 
> 时间：2009-01-15T09:51:56.350
> 
> 标签：calculated-columns

I am looking at a macro which would hide columns for a particular range every time I run the query.

For example: For the first time when I run the query, I would need Columns A to D to be hidden, like wise the next time I run the query, I would need columns E to H to be hidden.

Its basically a query that would generalize the column hiding pattern.

I request your expertise in this regard.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-14T11:49:53.527

如果传递的 RunCount 值为 1，下面的过程将隐藏列 A 到 D，如果传递值 2，则隐藏列 E 到 H，如果传递值 3，则隐藏列 I 到 L，依此类推。 .

```
Public Sub HideColumns(RunCount As Integer, TargetSheet As Worksheet)
  Dim rngHide As Range
  Dim ColOffset As Integer

' Initialise rngHide to columns A to D of the target worksheet.
  Set rngHide = TargetSheet.[A:D]

' Calculate the offset from column A to the first column _
  that needs to be hidden, update rngHide if required.
  ColOffset = (RunCount - 1) * 4
  If ColOffset > 0 Then
    Set rngHide = rngHide.Offset(0, ColOffset)
  End If

' Hide the columns.
  rngHide.ColumnWidth = 0
End Sub 
```

如果您决定只想隐藏某些列，只需更改该行：

```
Set rngHide = TargetSheet.[A:D] 
```

* * *

例如，仅隐藏第一列和最后一列（A 列*和*D 列、E 列*和*H 列等）：

```
Set rngHide = TargetSheet.[A:A, D:D] 
```

仅隐藏前两列：

```
Set rngHide = TargetSheet.[A:B] 
```

# c# - How do I look at remote processes in C#?

> ID：446204
> 
> 赞同：2
> 
> 时间：2009-01-15T09:56:25.887
> 
> 标签：c#, asp.net, sql-server, c#-3.0

I want to know if a process is running in the current machine as a part of my application ,but my application is deployed in another machine.

I'm using `System.Diagnostics.Getprocessbyname` but it looks for processes on the machine the application is deployed to. I want to know whether the process is running on *my* machine.

Is there a way to do this?

**Note:** This is edited by someone other than the question asker in an attempt to make it easier to understand. I have may not correctly captured their question..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T10:11:54.453

You can use

```
System.Diagnostics.Process.GetProcessesByName("processname", "mymachine"); 
```

# c++ - 从 std::multimap<> 中删除项目后，我可以继续使用迭代器吗？

> ID：446205
> 
> 赞同：2
> 
> 时间：2009-01-15T10:00:07.830
> 
> 标签：c++, stl, multimap

即使在调用 multimap::erase() 之后，我还能继续使用 multimap 迭代器吗？例如：

```
Blah::iterator iter;
for ( iter = mm.begin();
      iter != mm.end();
      iter ++ )
{
    if ( iter->second == something )
    {
        mm.erase( iter );
    }
} 
```

应该期望它正确运行，还是迭代器在调用擦除后失效？[像http://www.cplusplus.com/reference/stl/multimap/erase.html](http://www.cplusplus.com/reference/stl/multimap/erase.html)这样的参考网站在迭代器的生命周期或构造/破坏方法对迭代器的影响这个话题上出奇地安静。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-15T10:34:23.143

[http://www.sgi.com/tech/stl/Multimap.html](http://www.sgi.com/tech/stl/Multimap.html)

```
Multimap has the important property that inserting a new element
into a multimap does not invalidate iterators that point to existing
elements. Erasing an element from a multimap also does not invalidate
any iterators, except, of course, for iterators that actually point to
the element that is being erased. 
```

所以它应该是这样的：

```
Blah::iterator iter;
for ( iter = mm.begin();iter != mm.end();)
{
    if ( iter->second == something )
    {
        mm.erase( iter++ );
        // Use post increment. This increments the iterator but
        // returns a copy of the original iterator to be used by
        // the erase method
    }
    else
    {
        ++iter;   // Use Pre Increment for efficiency.
    }
} 
```

另请参阅： [如果在从头到尾迭代时在地图元素上调用 erase() 会发生什么？](https://stackoverflow.com/questions/263945/what-happens-if-you-call-erase-on-a-map-element-while-iterating-from-begin-to-e)

和

[删除地图中的特定条目，但迭代器必须指向删除后的下一个元素](https://stackoverflow.com/questions/268898/delete-a-specific-entry-in-the-map-but-the-iterator-must-point-to-the-next-elemen#269717)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T10:03:40.007

C++ 标准 23.1.2.8：

> 插入成员不应影响迭代器和对容器的引用的有效性，而擦除成员应仅使迭代器和对被擦除元素的引用无效。

这是所有关联容器的共同要求，std::multimap 就是其中之一。

# java - 独立 Java 应用程序

> ID：446208
> 
> 赞同：0
> 
> 时间：2009-01-15T10:02:08.683
> 
> 标签：java, compilation, executable

有没有办法使用高质量的免费软件将 java 文件编译成可执行文件，而无需使用可执行的 JAR 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T10:10:06.063

有[几种方法](http://www.excelsior-usa.com/articles/java-to-exe.html)可以做到这一点。但是您通常应该避免仅仅因为您不喜欢双击 JAR 文件而使 Java 应用程序在一个平台上可执行。这违背了 Java 的互操作性的目的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T10:14:10.140

[Javalobby](http://www.javalobby.org/articles/java2exe/)上有一个不错的页面，其中详细讨论了这一点，并介绍了您可能想要执行此操作的几种不同样式并提供指向适当工具的链接（分为免费和商业）。

一些免费的 EXE 生成工具是

1.  [jstart32](http://jstart32.sourceforge.net/)
2.  [启动4j](http://launch4j.sourceforge.net/)
3.  [JS平滑](http://jsmooth.sourceforge.net/)

虽然我从来不需要其中之一，所以不能就它们的有效性发表我的看法，但它们似乎都很好地完成了这项简单的任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T10:12:37.023

有几个包装器可用。我对他们没有经验，但您可以尝试以下方法或谷歌了解更多：

*   [http://www.regexlab.com/en/jar2exe/](http://www.regexlab.com/en/jar2exe/)
*   [http://jsmooth.sourceforge.net/](http://jsmooth.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T10:10:54.377

换句话说，你想从你的 JAR 文件创建一个 EXE 文件？有一些软件可以做到这一点，例如[JSmooth](http://jsmooth.sourceforge.net)或[Launch4J](http://launch4j.sourceforge.net/)

# python - 来自 sys.platform 的可能值？

> ID：446209
> 
> 赞同：90
> 
> 时间：2009-01-15T10:02:59.540
> 
> 标签：python, cross-platform

以下命令的可能返回值是什么？

```
import sys
print sys.platform 
```

我知道有很多可能性，所以我主要对“主要”的（Windows、Linux、Mac OS）感兴趣

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-12-14T07:49:05.650

```
┍━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━┑
│ System              │ Value               │
┝━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━┥
│ Linux               │ linux or linux2 (*) │
│ Windows             │ win32               │
│ Windows/Cygwin      │ cygwin              │
│ Windows/MSYS2       │ msys                │
│ Mac OS X            │ darwin              │
│ OS/2                │ os2                 │
│ OS/2 EMX            │ os2emx              │
│ RiscOS              │ riscos              │
│ AtheOS              │ atheos              │
│ FreeBSD 7           │ freebsd7            │
│ FreeBSD 8           │ freebsd8            │
│ FreeBSD N           │ freebsdN            │
│ OpenBSD 6           │ openbsd6            │
┕━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━┙ 
```

(*) 在 Python 3.3 之前，任何 Linux 版本的值总是`linux2`; 之后，它是`linux`。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-15T10:03:16.997

Mac OS X（10.4、10.5、10.7、10.8）：

```
darwin 
```

Linux（2.6 内核）：

```
linux2 
```

Windows XP 32 位：

```
win32 
```

括号中的版本已经过检查 - 其他/较新的版本可能相同。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-15T10:04:52.330

> 正如其他人所指出的，sys.platform 源自系统供应商为其系统提供的名称。但是，Python 也将 plat- 添加到 sys.path，因此您可以查看 Python 发行版中的所有 plat-* 目录。
> 
> 这给了你列表
> 
> aix3 aix4 atheos beos5 darwin freebsd2 freebsd3 freebsd4 freebsd5 freebsd6 freebsd7 generic irix5 irix6 linux2 mac netbsd1 next3 os2emx riscos sunos5 unixware7
> 
> 当然，当 Python 在没有创建平台特定目录的系统上编译时， sys.platform 可以有额外的值。

从[这里](http://mail.python.org/pipermail/python-list/2006-August/405454.html)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-15T10:06:02.390

FreeBSD 7.0 `freebsd7`：. FreeBSD8，但构建在以前的版本上执行，相同的答案。

因此请注意，您获得了用于构建的平台，而不一定是您正在运行的平台。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-29T16:13:55.257

截至 2013 年 12 月 29 日，OS X 10.9.1 Mavericks 仍被标记为 Darwin。

# .net - 我可以在 .NET 中避免 JIT 吗？

> ID：446211
> 
> 赞同：5
> 
> 时间：2009-01-15T10:03:35.560
> 
> 标签：.net, jit

假设我的代码是否总是要在特定处理器上运行，如果我在安装过程中有这些信息 - 我有机会避免 JIT 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T10:04:27.930

使用[NGEN](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)：

> 本机映像生成器 (Ngen.exe) 是一种提高托管应用程序性能的工具。Ngen.exe 创建本机映像，这些文件包含已编译的特定于处理器的机器代码，并将它们安装到本地计算机上的本机映像缓存中。运行时可以使用缓存中的本机图像，而不是使用即时 (JIT) 编译器来编译原始程序集...
> 
> 有关使用 Ngen.exe 和本机映像服务的其他信息，请参阅本[机映像服务](https://msdn.microsoft.com/en-us/library/ms165074(v=vs.80).aspx)...

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-11T04:49:51.730

NGEN 是显而易见的答案，但我要指出的是，JIT 编辑的代码可以更快，因为它在运行时“知道”NGEN 无法做到的事情。我们利用这个事实在运行时根据我们的 .config 文件中的设置将代码行放在地板上：

```
static readonly bool _EnableLogging = LoadFromConfigFile("EnableLogging");
if (_EnableLogging && log.IsDebugEnabled)
{
   //Do some logging
} 
```

在此示例中，NGEN 必须在代码中保留 if 语句，因为它不知道 _EnableLogging 字段的值是什么。但是，JIT 确实知道*此*运行的值，如果它为 false，则永远不会处理 if 语句，并且 JIT 会从它生成的机器代码中逐字省略整个 if 语句，从而导致代码库更小，因此更快的代码库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T10:54:10.200

如果您在安装时有 CPU 信息，则不必避免 JIT。

如果您使用 /platform:[x86/x64/IA64] 开关编译模块，编译器将在生成的 PE 文件中包含此信息，以便 CLR 将代码 JIT 到适当的 CPU 本机代码并为此优化代码CPU 架构。

您可以使用[NGEN](http://msdn.microsoft.com/en-us/library/6t9t5wcf%28VS.80%29.aspx)，是的，但前提是您想改善应用程序的启动，因为正在运行的进程中的工作集减少，而不是因为您会避免 JITting。您需要将 NGEN 文件的性能与非 NGEN 文件的性能进行实际比较，以确保 NGEN 文件更快。

NGEN 不能像 JIT 编译器那样对执行环境做出尽可能多的假设，因此会产生未优化的代码。

例如：它为静态字段访问添加了间接访问，因为静态字段的实际地址仅在运行时才知道。

# c++ - I need a background program C++

> ID：446218
> 
> 赞同：0
> 
> 时间：2009-01-15T10:06:31.950
> 
> 标签：c++, background

I have created this program:

```
//Includes....
int main()
{
   ifstream readfile("File.txt");
   string str;
   while(1)
   {
      getline(readfile,str);
      system("cls");
      Sleep(10000);
   }
} 
```

It's just a program that reads every 10 seconds a line from the file "File.txt"

I want to make it work on background,how can I do that?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T14:35:32.313

此示例为您隐藏控制台窗口：

```
 #include "windows.h"
#include fstream 
#include string
#include stdio.h

using namespace std;

int main()
{
    WCHAR path[260];

    GetModuleFileName(NULL,path,260);

    HWND console = FindWindow(L"ConsoleWindowClass",path);

    if(IsWindow(console))

    ShowWindow(console,SW_HIDE); // hides the window

    //---------------------------------------------------

    ifstream readfile("File.txt");
    string str;
    while(1)
    {
        getline(readfile,str);
        system("cls");
        Sleep(10000);
    }

    //----------------------------------------------------

    if(IsWindow(console))

        ShowWindow(console,SW_SHOW); // shows the window

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T10:51:57.537

如果这是 UNIX，您可以从 shell 运行程序，并在程序名称后添加一个与号“&”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T10:18:29.290

Platform dependent. But I think you are using windows because of the "cls" command. Why cant you just start a new command prompt and execute the correct .exe file. Then just minimize the program and do what you are supposed to do. If want to automate the startup phase (like cron in linux/unix) use the built in scheduler for windows.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:58:26.767

如果您想要一个完全不使用控制台窗口或任何其他窗口的（非服务）程序，请将 main() 更改为 winmain()。不过，获取命令行参数有点复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T13:39:13.347

如果你从 Dos 控制台启动你的程序，你可以使用 command `start \B myprogram.exe`，它或多或少等同于 unix & 符号。但是，您需要保持控制台打开以保持程序运行。

另一种解决方案是将您的应用程序转换为 Windows 服务，但随后您必须重写（或包装）您的应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T13:44:47.517

如果您想要这样做，因为您正在记录某种输出并想要查看更改，您可以使用 TextPad 等编辑器，它会在文件更改时自动重新加载文件。

但是，您尚未指定为什么要这样做，因此这可能不适合您的情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T10:20:16.680

I'm sorry, but I'm not sure I know what you mean... as far as I know (please correct me if I'm wrong) there is no way to run a simple C(++) program without a console window. However if you want it to "sleep" in a way that uses near no resources, then that can be achieved by checking current time and compering it with the time when you completed your last read.

Sleep function usually uses more resources than this, however it works just as well, so if resource cap isn't very very important then it will do just as well.

Hope this helped.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-15T23:53:23.047

正确的方法是使用 Windows 服务，Google 上有足够的信息来说明如何做到这一点。

# workflow - MS Workflow problem with custom activities member variable state

> ID：446219
> 
> 赞同：1
> 
> 时间：2009-01-15T10:07:11.327
> 
> 标签：workflow, workflow-activity

I have a simple custom activity with a private member variable (integer).

When i put it inside a sequence activity which is inside a while activity and start iterating i have a problem:

**My member variable is zeroed in each iteration even though i increment it by one every time the activity is executed.**

What am i doing wrong?

Thanks,

Adi Barda

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:27:21.403

没有看到代码很难说，但是当您在 While 活动中工作时，您必须小心如何修改子活动的状态。While 活动产生多个执行执行上下文，并将从模板克隆您的活动（换句话说 - 您没有多次执行相同的活动，工作流会创建自定义活动的多个实例）。请参阅：http: [//blogs.msdn.com/advancedworkflow/archive/2006/03/21/557121.aspx](http://blogs.msdn.com/advancedworkflow/archive/2006/03/21/557121.aspx)和[http://msdn.microsoft.com/en-us/magazine/cc163414.aspx](http://msdn.microsoft.com/en-us/magazine/cc163414.aspx)

# database - 是否有任何模式或重构技巧来拆分 Enum 和 DBDictionary 数据重复

> ID：446221
> 
> 赞同：2
> 
> 时间：2009-01-15T10:07:21.280
> 
> 标签：database, design-patterns, refactoring, enums

我们的项目中有一个臭代码。在 biz 逻辑中使用的许多值有 2 个存储位置：我们在 DB 中有字典表（用于 FK 关系），其中存储了 MessageDirectionInfo 前的值：

0|未知

1|在

2|输出

我们的 Enum 具有完全相同的数据： MessageDirectionEnum{Unknown=0,In=1,Out=2} 在整个代码中，我们有很多“switch”和“if”，其中 enum 用于条件逻辑。但是当我们保存到数据库时 - 我们应该“转换”（实际上是“盲选”，情况下它选择除了结果对象类型之外的完全相同的数据）枚举值到 Dictionary 类实例。我可以理解 Enums 用于清除代码逻辑和用于在外键中引用的 DB 数据，但实际上我不喜欢这样。

是否有任何模式可以消除这种行为或任何方式来清除这种“臭味”？或者也许我只是瞎了眼，这是获得这两种好处的唯一明确方法-DB FKs和带有枚举的更清晰的代码逻辑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T10:12:06.307

保留表格但用类替换枚举......？ [http://www.refactoring.com/catalog/replaceTypeCodeWithClass.html](http://www.refactoring.com/catalog/replaceTypeCodeWithClass.html)

# python - 如何使用 Python 反转 Unicode 分解？

> ID：446222
> 
> 赞同：6
> 
> 时间：2009-01-15T10:08:25.020
> 
> 标签：python, unicode

使用 Python 2.5，我将一些文本存储在 unicode 对象中：

> Dinis e Isabel, uma difı´cil relac¸a~o conjugal e polı´tica

这似乎是被[分解的 Unicode](http://www.unicode.org/reports/tr15/#Decomposition)。Python中是否有一种通用的方法来反转分解，所以我最终得到：

> Dinis e Isabel, uma difícil relação conjugal e politica

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T10:33:47.497

我想你正在寻找这个：

```
>>> import unicodedata    
>>> print unicodedata.normalize("NFC",u"c\u0327")
ç 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T14:55:26.470

> 不幸的是，我的文本中似乎实际上有（例如） \u00B8 （cedilla）而不是 \u0327 （combining cedilla）。

呃，恶心！您仍然可以自动执行此操作，尽管该过程不会完全无损，因为它涉及兼容性分解 (NFKD)。

将 U+00B8 归一化为 NFKD，你会得到一个空格，然后是 U+0327。然后，您可以扫描字符串以查找任何空格后跟组合字符的情况，然后删除空格。最后重构为 NFC 将组合字符放在前一个字符上。

```
s= unicodedata.normalize('NFKD', s)
s= ''.join(c for i, c in enumerate(s) if c!=' ' or unicodedata.combining(s[i+1])==0)
s= unicodedata.normalize('NFC', s) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T10:18:38.823

我真的不能给你一个明确的答案来回答你的问题，因为我从来没有尝试过。但是标准库中有一个[unicodedata 模块](http://docs.python.org/library/unicodedata.html)。它有两个功能`decomposition()`，`normalize()`在这里可能会对您有所帮助。

编辑：确保它确实是分解的 unicode。有时有一些奇怪的方法可以编写无法直接用编码表达的字符。就像`"a`它意味着由人类或某些专门程序在心理上解析为`ä`.

# .net - Binding IDataErrorInfo to window IsEnabled button property

> ID：446229
> 
> 赞同：3
> 
> 时间：2009-01-15T10:11:30.070
> 
> 标签：.net, wpf, validation, binding, isenabled

I have a WPF sub window with some input controls that the user has to correctly fill before pressing Ok button.

I have already implemented the interface **IDataErrorInfo** to validate all properties bound to UI Controls.

Now I would like that the **IsEnabled** property of Ok button is **True** only if ALL controls are valid, otherwise it has to be set to **False**.

It should be easy but I cannot find the correct solution. Do you have any suggestion?

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T13:27:40.157

再见 ;-）

我认为您可以通过转换为的 IValueConverter （您必须实现）将按钮的属性绑定到（例如）数据的属性（`IsEnabled`例如，如果值 if比 return ）。`IDataErrorInfo.Error``string``bool``String.Empty``true`

另一种解决方案是使用`Command`s 并将此逻辑包含在`CanExecute`: 中，这样您只需将`Command`与您的`Button`. 高温高压

# ruby-on-rails - 在 Linux 上部署的 Rails 项目中是否可以使用 CRLF 行？

> ID：446244
> 
> 赞同：1
> 
> 时间：2009-01-15T10:15:10.123
> 
> 标签：ruby-on-rails, linux, git, deployment, newline

我有一个 Git 存储库（最初是 CVS，然后是 SVN，现在是 Git），其中包含一个已在 Linux 上部署一段时间的 Rails 项目。一切似乎都运行良好。

现在我已经转换为 git，我看到**存储库中的许多文件都包含[`CRLF`](http://en.wikipedia.org/wiki/Newline)行尾**。我希望它保持一致（ ），但不会以丢失每个具有行尾`LF`的文件的编辑历史为代价。`CRLF`

**你能想到我不能让文件保持原样的任何原因吗？** 我似乎记得 shell 脚本或 cron 文件或响应`CRLF`不太好的东西存在问题。

另外，我知道所有关于 Git 选项的信息`core.autocrlf`，`core.safecrlf`但是有没有办法让它在结帐时**将所有文本文件转换`CRLF`为`LF`结帐时（对于 linux 端）** ......即 core.autolf 选项或类似的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T21:02:57.743

如果您可以重写存储库的历史记录（请参阅[重写历史记录的问题](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#problems-With-rewriting-history)），您可以使用 git filter-branch 将 CRLF 转换为 LF：

```
git filter-branch --tree-filter 'find . -path './.git' -prune -o -type f -exec dos2unix \{} \;' HEAD 
```

请注意，如果您的存储库中有二进制文件，则必须改进 find 命令以排除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-22T11:12:13.430

对davitenio 的回答和 Daniel Beardsley 的评论的评论[；](https://meta.stackexchange.com/questions/23211/how-do-i-add-a-comment-to-an-answer)我相信您可以使用这个小程序作为 dos2unix 的包装器：

```
#!/bin/sh
for f in $@; do
    if [ $(file -b -n -i -m /dev/null $f | grep -c "text") -gt 0 ]; then
        dos2unix $f
    fi
done 
```

尽管可能仍有一些极端情况会失败。

# apache-flex - Flex 和 AIR 在彼此之间传递数据

> ID：446253
> 
> 赞同：0
> 
> 时间：2009-01-15T10:18:16.110
> 
> 标签：apache-flex, flash, air

我正在寻找一些示例/教程/一般指针来执行以下任一操作。

1) 创建一个 AIR 应用程序，该应用程序可以加载实时 flex 应用程序并将其用于测试。所以我们有一个实时的应用程序，如果我可以将它加载到可以编辑配置文件的 AIR 应用程序中，然后使用实时 swf 但在 AIR 应用程序内部测试该配置文件，以确保 if 不会破坏 flex应用程序在为实时应用程序上传新配置之前。

2) 或者我听说能够将数据从 AIR 应用程序拖到 flex 应用程序中。如果是这样，那么 AIR 应用程序可以将测试数据传递给 flex 应用程序，它会刷新，我们可以看到它是否有效。

我现在已经对此进行了一些研究，它看起来像是使用剪贴板，而一些 javascript 似乎是前进的方向。从 AIR 应用程序将数据保存在剪贴板中，然后使用 javascript 读取剪贴板并发送到 flex 应用程序。有没有人在 AIR 和 flex 之间传输数据的任何其他方式。

此外，“您不能跨沙箱边界访问共享对象。” 来自 Adob​​e 文档，我推测这意味着 AIR 应用程序不能与 flex 应用程序共享相同的“flash cookie”。它是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:20:00.780

> *有没有人在 AIR 和 flex 之间传输数据的任何其他方式。*

[`flash.net.LocalConnection`](http://livedocs.adobe.com/flex/3/langref/flash/net/LocalConnection.html)是执行此操作的标准方法，虽然它有其怪癖，但效果很好。这是我用来将数据从 Flex 应用程序（在浏览器中运行，尽管它在浏览器插件或独立 Flash Player 中运行）传输到 AIR 应用程序的方法。

# asp.net - LINQ 排序

> ID：446262
> 
> 赞同：0
> 
> 时间：2009-01-15T10:21:13.357
> 
> 标签：asp.net, linq

我正在将 GridView 绑定到任何类型。

```
protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
{
    List<object> lb = (List<object>)ReturnAnony(); // Not working
    // ?? What to write here
}

object ReturnAnony()
{
    var anony = // I create the ananymous type and return    
    return anony;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T10:29:26.990

不太确定你想要什么。

如果你要创建一个匿名类型的 List，你可以使用 currying 函数来帮助你：

```
public List<T> makeAList<T>(T x)
{
    var l = new List<T>();

    l.Add(x);
    return l;
} 
```

那是你要的吗？

否则，您不能在其范围之外引用匿名类型，除非您创建一条将类型信息桥接到您的代码的*路径*……最终您应该创建一个新类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T10:29:40.703

你想用lb做什么？

一般来说，匿名类型并不适合从方法中返回，因为你无法表达返回类型。

您是否考虑过将匿名类型扩展为普通的命名类型？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T10:35:40.537

如果你想在 GrideView EventHandler 中访问你的数据项，你真的不应该使用匿名类型。匿名类型仅在它们定义的方法范围内可用，因此当您到达另一个范围时它才被称为对象。然后访问您需要使用反射的属性。

但是为了进行排序，你可以让它有点疯狂，请参阅我在这个问题中所做的响应：[如何在通用扩展方法中使用字符串列名在 IQueryable 上应用 OrderBy？](https://stackoverflow.com/questions/307512/how-do-i-apply-orderby-on-an-iqueryable-using-a-string-column-name-within-a-gener#307600)

它看起来如何动态地执行 OrderBy 语句，但您可以将这些原则应用于任何类型的 LINQ 过滤器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T10:36:22.967

如果要对[ASP.NET GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)进行排序，则只需在事件 args 对象的[SortExpression](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewsorteventargs.sortexpression.aspx)属性中将要排序的字段指定为字符串。

```
protected void GridView1_Sorting(object sender, GridViewSortEventArgs e)
{
    e.SortExpression = "FieldABC";
}

object ReturnAnony()
{
    var anony = new object { FieldABC = 123 };
    return anony;
} 
```

这应该允许您对匿名类型的任何字段进行排序。

您无需创建任何列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T11:07:31.143

关于您的其他问题，方法如下：

```
var l = new List<Employee>();

l.Sort((x, y) => (x.FirstName.CompareTo(y.FirstName))); 
```

请编辑问题或只是问另一个问题。

# visual-studio - Visual Studio：通过 .VCPROJ 或 .SLN 文件改变选项卡宽度/选项？

> ID：446268
> 
> 赞同：14
> 
> 时间：2009-01-15T10:24:53.380
> 
> 标签：visual-studio, tabs

我们的一些项目需要默认的 Visual Studio 选项卡选项（宽度 4；保留选项卡）；有些人要求宽度为 3；使用空格。不要问。

除了全局设置这些，我是否可以在每个解决方案或每个项目甚至（emacs 样式）每个文件上设置它？

Visual Studio 2005 和 2008。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-11-12T12:36:36.693

我知道的最方便的解决方案是创建一组 Visual Studio 宏来切换到您想要的设置。

去`Tools > Macros > Macros IDE`。在那里，在左侧的树中，右键单击`MyMacros`并选择`Add > Add Module`。为模块命名，例如`TabSize`. 在此模块中，创建潜艇以更改您想要的设置。例如：

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics

Public Module TabSize

    Sub Tab3()
        SetTabAndIndentation(3)
    End Sub

    Sub Tab4()
        SetTabAndIndentation(4)
    End Sub

    Function SetTabAndIndentation(ByVal value As Integer)
        DTE.Properties("TextEditor", "AllLanguages").Item("TabSize").Value = value
        DTE.Properties("TextEditor", "AllLanguages").Item("IndentSize").Value = value
    End Function

End Module 
```

我所知道的字符串参数没有有用的文档。如果您需要设置其他选项，例如“保留标签”，最简单的方法是手动进行这些更改（unter `Tools > Options`）。然后，使用`Tools > Import and Export Settings`将这些设置保存为 vssettings 文件。这将创建一个 XML 文件，其结构与方法调用所需的结构相同。

最后，您可以通过 将这些宏链接到命令按钮或键盘快捷键`Tools > Customize`。为每个宏提供键盘快捷键可以让您在设置之间快速切换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T09:12:54.730

我有一个类似的问题：我的新项目需要使用**keep tabs**设置，而我的其他项目是使用**插入空格**选项开发的。

由于这是一个严格的 Visual Studio 设置，我没想到会找到任何可以支持此功能的每个项目的信息（如果有人为此目的使用特定的加载项）。

所以我最终得到了类似 eclipse 的设置：有两个 Visual Studio 的快捷方式，每个都有不同的设置。

根据 MSDN，可以使用[/ResetSettings](http://msdn.microsoft.com/en-us/library/ms241273.aspx)开关在启动时更改 Visual Studio 设置。您现在需要的是具有这种格式的两个快捷方式：

```
devenv.exe /ResetSettings "d:\your-settings.vssettings" 
```

启动时间长了 5-10 秒（因为它在每次启动时都会应用更改设置），但每次都比手动操作更方便、更省力。

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-26T01:08:50.407

您还可以使用这些属性来完成 Daniel 的示例：

```
DTE.Properties("TextEditor", "AllLanguages").Item("InsertTabs").Value
DTE.Properties("TextEditor", "AllLanguages").Item("IndentStyle").Value 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-07T17:32:41.770

我知道我玩游戏有点晚了：自 Visual Studio 2017 以来，[`.editorconfig`](https://docs.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options)IDE 中的文件支持基于每个目录。

# vim - 我可以在 VIM 中使用 SPACE 作为地图领导者吗？

> ID：446269
> 
> 赞同：96
> 
> 时间：2009-01-15T10:25:18.607
> 
> 标签：vim, configuration, mapping, keyboard-shortcuts, customization

从[http://items.sjbach.com/319/configuring-vim-right](http://items.sjbach.com/319/configuring-vim-right)我知道你应该能够`Space`在 vim 中用作 mapleader。我试过了，但它似乎不起作用。任何人使它工作？

试过：

```
let mapleader = <space> 
```

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-01-15T10:33:51.070

请尝试以下操作：

```
let mapleader=" " 
```

并记住在此之前写下以下行，以确保空格键事先没有任何映射：

```
nnoremap <SPACE> <Nop> 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-03-06T05:55:52.463

Mapleader 是一个 Vim 字符串变量。要将空格用作领导者，您必须转义特殊字符。

```
let mapleader="\<Space>" 
```

有关更多信息，请参阅，

[http://vimdoc.sourceforge.net/htmldoc/eval.html#expr-quote](http://vimdoc.sourceforge.net/htmldoc/eval.html#expr-quote)

**编辑：**

这在我的 Vim 版本中不再适用于我。即使在评论中建议通过运行在正常模式下取消映射空格键`nnoremap <SPACE> <Nop>`。

我最终选择了下面答案中给出的解决方案。

```
map <Space> <Leader> 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-07-21T13:39:37.523

上述解决方案很棒，但是右下角的命令角没有显示任何内容。`\`如果您对密钥 没有任何用处，请尝试使用`map <SPACE> <leader>`，`\`它将显示在命令角。正如上面推荐的那样，您不必先取消映射空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-17T01:45:26.483

nnoremap <空格> <nop>
nnoremap <nowait> <空格> /

# plsql - 在 PL/SQL 块中出现“无效参数”错误

> ID：446272
> 
> 赞同：0
> 
> 时间：2009-01-15T10:26:46.107
> 
> 标签：plsql

以下 PL/SQL 将不会执行，只会返回“无效参数”作为错误。我已经把每一行都注释掉了，我可以改变我收到的错误，但我无法让 proc 运行，因为我无法确定错误所在的位置，它很可能在于权限或执行用户但是任何帮助将不胜感激。这是过程

```
DECLARE
    ind NUMBER;             -- Loop index 
    h1 NUMBER;              -- Data Pump job handle 
    percent_done NUMBER;    -- Percentage of job complete 
    job_state VARCHAR2(30); -- To keep track of job state 
    le ku$_LogEntry;        -- For WIP and error messages 
    js ku$_JobStatus;       -- The job status from get_status 
    jd ku$_JobDesc;         -- The job description from get_status 
    sts ku$_Status;         -- The status object returned by get_status 
BEGIN
    h1 := DBMS_DATAPUMP.OPEN('EXPORT','SCHEMA',NULL,'SQL_INSTALLER_01152009_1014','LATEST');
    DBMS_DATAPUMP.ADD_FILE(h1,'SQL_INSTALLER_01152009_1014.dmp','ORACLE_SCRIPT_RUNNER_BACKUP',NULL,1);
    DBMS_DATAPUMP.ADD_FILE(h1,'SQL_INSTALLER_01152009_1014.log','ORACLE_SCRIPT_RUNNER_BACKUP',NULL,3);
    DBMS_DATAPUMP.METADATA_FILTER(h1, 'SCHEMA_LIST','''speccs_web_test''', NULL, NULL);
    DBMS_DATAPUMP.START_JOB(h1);

    percent_done := 0;
    job_state := 'UNDEFINED';
    while (job_state != 'COMPLETED') and (job_state != 'STOPPED') loop 
        dbms_datapump.get_status(
            h1,
            dbms_datapump.ku$_status_job_error +
            dbms_datapump.ku$_status_job_status +
            dbms_datapump.ku$_status_wip,
            -1,
            job_state,
            sts);

        js := sts.job_status;
        if js.percent_done != percent_done then 
            percent_done := js.percent_done;
        end if;

        if (bitand(sts.mask,dbms_datapump.ku$_status_wip) != 0) then 
            le := sts.wip;
        else 
            if (bitand(sts.mask,dbms_datapump.ku$_status_job_error) != 0) then 
                le := sts.error;
            else 
                le := null;
            end if;
        end if;

        if le is not null then 
            ind := le.FIRST;
            while ind is not null loop 
                ind := le.NEXT(ind);
            end loop;
        end if;
    end loop;
    dbms_datapump.detach(h1); 
END; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T11:02:41.433

我发现了一些东西：

见这里： http: [//petermag.blogspot.com/2008/01/export-datapump-how-to-do-via-plsql.html](http://petermag.blogspot.com/2008/01/export-datapump-how-to-do-via-plsql.html)

当转储文件已存在时，您会收到无效参数错误错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T10:38:24.523

您可以下载 SQL Developer 并使用它的调试器（它是免费的）。

见这里：[http ://www.oracle.com/technology/software/products/sql/index.html](http://www.oracle.com/technology/software/products/sql/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:20:12.410

谢谢那里的家伙。我继续调试并将其确定为一行..

DBMS_DATAPUMP.METADATA_FILTER(h1, 'SCHEMA_LIST','''speccs_web_test''', NULL, NULL);

这是一个。把它评论出来，一切都很好。该错误表明其中一个值无效，我会冒险猜测它看起来很奇怪'''speccs_web_test'''，但搜索似乎表明这是正确的，这是因为该参数是一个列表并且可以是' (''名字'', ''名字''); 这将转换为 ('name', 'name') IN 列表的有效格式。

我可能会在一两分钟内把它整理好，但你认为我会在几个小时前搞定它:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T15:32:45.957

对于这个特殊问题，这是因为 schema_name speccs_web_test 不是大写的。SPECCS_WEB_TEST 很好，proc 现在正在运行；）

# c++ - Is there a 'catch' with FastFormat?

> ID：446276
> 
> 赞同：16
> 
> 时间：2009-01-15T10:27:28.087
> 
> 标签：c++, fastformat

I just read about the [FastFormat C++ i/o formatting library](http://www.fastformat.org/), and it seems too good to be true: Faster even than printf, typesafe, and with what I consider a pleasing interface:

```
// prints: "This formats the remaining arguments based on their order - in this case we put 1 before zero, followed by 1 again"
fastformat::fmt(std::cout, "This formats the remaining arguments based on their order - in this case we put {1} before {0}, followed by {1} again", "zero", 1);

// prints: "This writes each argument in the order, so first zero followed by 1"
fastformat::write(std::cout, "This writes each argument in the order, so first ", "zero", " followed by ", 1); 
```

This looks almost too good to be true. Is there a catch? Have you had good, bad or indifferent experiences with it?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-10-07T09:24:15.377

> FastFormat 有什么“陷阱”吗？

上次我检查时，有一个烦人的问题：

您只能使用*此*库的窄字符串版本*或*宽字符串版本。（`wchar_t`和的功能`char`相同——使用哪种类型是编译时开关。）

使用 iostreams、stdio 或 Boost.Format，您可以同时使用它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-14T16:56:23.707

找到了一个“捕获”，尽管对于大多数人来说它*永远不会*显现出来。从项目页面：

> **原子操作。** 它不会像 IOStreams 那样一次写出一个语句元素，因此没有原子性问题

我可以看到这种情况发生的唯一方法是，如果它本身缓冲整个`write()`调用的输出，然后将其写入`ostream`一步。这意味着它需要分配内存，如果传入`write()`调用的对象产生大量输出（几兆字节或更多），它可以在内部缓冲区中消耗多达两倍的内存（假设它使用增长缓冲区-通过将其大小每次加倍的技巧）。

如果您只是将它用于日志记录，而不是转储大量 XML，那么您将永远不会看到这个问题。

我看到的唯一其他“捕获”是：

> **高度便携。**它适用于所有优秀的现代 C++ 编译器；它甚至适用于 Visual C++ 6！

因此它不适用于旧的 C++ 编译器，例如`cfront`，而`iostreams`向后兼容 80 年代后期。同样，如果有人对此有任何疑问，我会感到惊讶。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T02:38:56.063

尽管 FastFormat 是一个很好的库，但它存在许多问题：

*   有限的格式支持，特别是不支持以下功能：
    *   前导零（或任何其他非空格填充）
    *   八进制/十六进制编码
    *   运行时宽度/对齐规范
*   该库对于相对较小的格式化任务来说相当大，并且具有更大的依赖性（STLSoft）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-15T16:43:56.193

它看起来确实很有趣！无论如何都是好的提示，为此+1！

我已经玩了一段时间了。我看到的主要缺点是 FastFormat 支持的输出格式选项较少。我认为这是实现更高类型安全性的直接结果，并且根据您的情况进行了很好的权衡。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T14:25:05.750

如果您详细查看他的性能基准页面，您会注意到优秀的旧 C`printf`系列函数在 Linux 上仍然胜出。事实上，唯一表现不佳的测试用例是应该是静态字符串连接的测试用例，我认为`printf`这是浪费的。此外，GCC 提供了对 -style 函数调用的静态类型检查`printf`，因此减少了类型安全的好处。所以： *如果*您在 Linux 上运行并且*需要*绝对最佳性能，FastFormat 可能不是最佳解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-20T12:26:17.383

[如docs](http://www.fastformat.org/documentation/index.html)中所述，该库依赖于几个环境变量。

这对某些人来说可能没什么大不了的，但我希望我的代码尽可能独立。如果我从源代码管理中检查它，它应该可以工作并编译。如果它需要您设置环境变量，它不会。

# sql - 需要概述 .NET 的非企业数据库

> ID：446282
> 
> 赞同：0
> 
> 时间：2009-01-15T10:29:32.373
> 
> 标签：sql, database

对于只允许查看或需要少量在线编辑的小型网站，SQL Server 2008、Oracle 和 MySQL 是多余的。

在 PHP 世界中，我经常使用 SQLite，它是一个例如 100K 的文件，其中包含数百条记录，您可以使用标准 SQL 处理这些记录。

在 .NET 世界中，我们有哪些选择，我见过：

*   SQL Server 2008 Express（免费，但文件臃肿 2-10MB，只有几条记录）
*   SQL Server Compact 3.5（看起来很有趣）
*   Vista.db（不是免费的？）
*   使用 .NET 的 SQLite 怎么样，你们中有人在这方面取得了成功吗？
*   还有其他适用于 .NET 的小型、严肃的 SQL 数据库吗？

我对 SQLite 之类的东西特别感兴趣，但它支持 CLR 类型系统和 LINQ。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T11:23:58.223

也许[这个 Wikipedia RDBMS 比较](http://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems)可能会帮助您做出选择。

*   SQLite与 .NET 配合[得很好。](http://sqlite.phxsoftware.com/)
*   我赞同 Edoode 对 Firebird 的建议——这对我很有用。
*   在多线程应用程序中使用 SQL Server CE 时[要非常小心。](http://social.msdn.microsoft.com/forums/en-US/sqlce/thread/c39ae613-7513-4608-9572-9afa556e1699/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T11:43:14.970

我在工作中不得不使用 Interbase，所以我来到了[Firebird](http://www.firebirdsql.org)。首先我必须使用它，现在我喜欢它。

有一个[.NET 数据提供程序](http://www.firebirdsql.org/index.php?op=files&id=netprovider)（ADO、DDEX）。

你甚至可以在不设置服务器的情况下使用它，就像使用 SQLite 一样（直接访问数据库文件）。

It's actively developed and "open source".

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T11:08:28.910

我认为没有任何数据库支持 CLR 类型系统，甚至 SQL server 也使用自己的类型。

除了已经提到的替代品之外，还有[Firebird](http://www.firebirdsql.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T12:11:42.150

You can also have a look at [db4o](http://www.db4o.com) which is not SQL but a fully managed object store for java and .NET.

# php - 使用正则表达式从输入字段验证 sprintf 格式

> ID：446285
> 
> 赞同：5
> 
> 时间：2009-01-15T10:30:56.393
> 
> 标签：php, validation

我有一个输入字段，可以输入常规文本和 sprintf 标签。

例子：`some text here. %1$s done %2$d times`

如何验证 sprintf 部件，使其不可能像错误一样`%$1s`？文本是 utf-8，据我所知，正则表达式只匹配 latin-1 字符。

www.regular-expressions.info 没有`/u`在任何地方列出，我认为这是用来告诉字符串是 unicode 的。

最好的方法是搜索整个输入字段字符串，`%`或者`$`如果找到任何一个，然后应用正则表达式来验证 sprintf 部分？

我认为正则表达式是：`/%\d\$(s|d|u|f)/u`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-01-18T18:35:21.177

我最初使用 Gumbo 的正则表达式来解析 sprintf 指令，但在尝试解析 %1.2f 之类的内容时我立即遇到了问题。我最终回到 PHP 的 sprintf 手册并根据其规则编写了正则表达式。到目前为止，我不是正则表达式专家，所以我不确定这是否是最干净的编写方式：

```
/%(?:\d+\$)?[+-]?(?:[ 0]|'.{1})?-?\d*(?:\.\d+)?[bcdeEufFgGosxX]/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T11:06:33.187

除非您在模式中使用 UTF-8，否则不需要 UTF-8 修饰符。除了[`sprintf`格式](http://www.php.net/manual/en/function.sprintf.php)更复杂之外，请尝试以下

```
/%(?:\d+\$)?[dfsu]/ 
```

这将匹配`%s`和`%1$s`格式。

但是，如果您想检查每次出现`%`以及是否遵循有效`sprintf()`格式，则正则表达式不是一个好的选择。顺序解析器会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:47:31.610

这就是我最终得到的结果，以及它的工作原理。

```
// Always use server validation even if you have JS validation
if (!isset($_POST['input']) || empty($_POST['input'])) {
  // Do stuff
} else {
  $matches = explode(' ',$_POST['input']);
  $validInput = true;

  foreach ($matches as $m) {
    // Check if a slice contains %$[number] as it indicates a sprintf format
    if (preg_match('/[%\d\$]+/',$m) > 0) {
      // Match found. Now check if its a valid sprintf format
      if ($validInput === false || preg_match('/^%(?:\d+\$)?[dfsu]$/u',$m)===0) {   // no match found
        $validInput = false;
        break; // Invalid sprintf format found. Abort
      }
    }
  }

  if ($validInput === false) {
    // Do stuff when input is NOT valid
  }
} 
```

感谢 Gumbo 提供的正则表达式模式，无论有无订单标记都匹配。

**编辑**：我意识到搜索 % 是错误的，因为如果忘记/遗漏，将不会检查任何内容。以上是新代码。

"$validInput === 假 ||" 可以在最后一个 if 语句中省略，但为了完整起见，我将其包括在内。

# multithreading - 多线程练习的示例问题

> ID：446288
> 
> 赞同：7
> 
> 时间：2009-01-15T10:31:56.330
> 
> 标签：multithreading, language-agnostic

我将要解决我认为是一个难题的问题，我想。我需要多线程生产者和消费者的管道。

所以我想从小处着手。有哪些不同难度的练习题对多线程练习有好处？（而不是你在非并发书籍中看到的人为的、不切实际的例子）。

您会推荐哪些专注于并发并给出深入问题和案例的书籍或参考资料？

（我宁愿不专注于我想解决的问题。我只是想寻求好的参考和示例问题。这对其他用户会更有用。我不会*卡*在这个问题上。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-21T16:30:35.713

[The little book of semaphores](http://www.greenteapress.com/semaphores/) is a good free book. The author takes a unique approach of first asking a problem and then presenting hints before answering. The problems increase in difficulty level gradually, and the book isn't written for any language in particular but covers general multithreading concepts.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T10:45:59.390

大多数教科书问题，如读者-作者、生产者-消费者或餐饮哲学家都是互斥体的例证。我更愿意建模一个原型，它是一个简单的近似更大的问题，然后继续。

我有时会看到需要避免死锁并且正在使用死锁预防措施的情况。分析银行家的算法是否适合这种情况总是一个好主意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T11:00:56.273

如果您有足够的时间进行投资，我会推荐 Jeff Magee 和 Jeff Kramer，John Wiley&Sons 2006 年出版的“Concurrency: State Models & Java Programs, 2nd Edition”一书

如果您使用其他语言，则可以忽略 Java 部分

有一种用于建模进程和并发进程的语言称为 FSP。为了精通语言，需要投入一些时间和精力。有一个工具（LTSA，两者都是免费的，并且由 Eclipse 插件或独立应用程序支持）可以验证您的模型并让您非常确定您的模型从并发执行的角度来看是正确的。

将这些模型转换为您的语言结构只是编程技术和一些设计模式的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T18:12:05.950

完全无视您的要求，我建议您将[SEDA](http://en.wikipedia.org/wiki/Event_Driven_Architecture)（分阶段事件驱动架构）视为一种考虑建立生产者和消费者的多线程管道的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T11:20:15.407

我不确定你在找什么。但在现实世界的企业情况下，我们通常在处理生产者消费者的事情时使用某种消息传递框架。通常在 Java 中，这就是[JMS](http://java.sun.com/products/jms/)。你可以使用优秀的[Spring Framework](http://static.springframework.org/spring/docs/2.5.x/reference/jms.html)来帮助你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T15:25:19.797

如果您完全使用 Java（甚至可能没有），那么您绝对应该阅读[Java Concurrency In Practice](http://jcip.net/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T11:56:30.480

老实说，许多现实世界的多线程程序所做的只是读取/写入一些值（无论是字符串还是整数）——循环缓冲区（网络连接可能需要）、日志文件的读取器/写入器等。

事实上，我想说的是，如果你实现（或找到）一个可靠的（通用的）循环缓冲区，然后通过这些缓冲区作为唯一的接触点运行所有线程到线程的通信，那将覆盖一个非常大的您可能需要做的任何多线程同步的一部分。（除非您在符合流行语的环境中工作，并且需要在流行语列表中添加“企业”、“消息传递”或其他任何内容……或者您正在编写数据库或操作系统。）

（请注意，“循环缓冲区”是一个相当以 C 为中心的术语，植根于对内存块的相对直接操作。Python 的 Queue 类以以列表为中心的方式实现了相同的基本原理，我相信很多其他语言在概念上具有相似的结构，但名称略有不同...）

# html - Opera 中的非标准标签行为

> ID：446289
> 
> 赞同：0
> 
> 时间：2009-01-15T10:32:46.267
> 
> 标签：html, tags, opera

我正在使用使用自定义标签的发布系统。这些在服务器上进行解释。问题是，当在本地查看时，它们会给 Opera 带来很大的问题（不会解释自定义标签）。

Opera 处理这些标签的方式与其他浏览器不同。看起来它正在关闭文档末尾的标签（即使标签包含右斜杠）。我只是想知道，如果这种行为被认为是错误或功能。

另外，如果您知道如何破解此类代码，以便我可以在本地调试 Opera 的 HTML+CSS（无需解释的自定义标签），请告诉我。谢谢你。

尝试以下代码以查看它的实际效果（[现场示例](http://fczbkk.com/bordel/opera-tag.html)）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Non-standard tag behavior in Opera</title>

    <style type="text/css" media="all">
        div { background: yellow; padding: 1em; }
        nonstandardtag { border: 1px solid red; }
    </style>

</head>

<body>

<div>
    <nonstandardtag>content of non-standard tag</nonstandardtag>
    main tag content
</div>

<div>
    <nonstandardtag />
    main tag content
</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T10:51:08.087

我使用歌剧超过 5 年。最接近标准的是浏览器。大多数在 Opera 中看起来很糟糕的网站都针对 IE 进行了“优化”。

但一个明显的问题是，为什么需要使用非标准标签？您可以将 div 和 span 标签用于几乎任何非标准解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T20:50:54.660

Short: it's not a bug. Despite the DOCTYPE, [your page is not interpreted as XHTML](http://hixie.ch/advocacy/xhtml) (and this is [intentional](http://lists.w3.org/Archives/Public/www-html/2000Sep/0024.html)).

HTML simply doesn't support the self-closing tag syntax the same way as XML.

In HTML, in practice `<foo />` is the same as `<foo>` or `<foo /="">`. In theory it's same as `<foo></foo>&gt;`.

You need to tell browser to interpret page as X[HT]ML. DOCTYPE is not enough. To do this locally, file has to have `.xml` or `.xhtml` extension. When you serve file over HTTP, you **must** set `Content-Type` header to `application/xhtml+xml` or similar XML type (for static files usually `.xhtml` file extension does the job).

Your live example is served as `text/html`, so it won't be interpreted as XHTML, and won't work as you expect.

BTW: XHTML doesn't allow non-standard elements. *If* you want to add your own elements anyway, you should at least use your own namespace.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T13:58:43.997

This seems to be fixed in [Opera 10](http://www.opera.com/browser/next/). So I guess it was not a feature.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T18:25:32.037

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T21:37:55.983

Short answer: there are no guarentees or requirements on what a User Agent may do if you feed it malformed data.

# svn - 个人版本控制器

> ID：446292
> 
> 赞同：13
> 
> 时间：2009-01-15T10:33:50.663
> 
> 标签：svn, version-control

我想知道是否有任何个人源控制器，我想在我的机器上拥有一个存储库而无需设置服务器，我也使用 TeX 文件而不是任何特定语言，我想拥有以子版本的方式备份我的文件

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-15T10:36:35.667

如果您安装[TortoiseSVN](http://tortoisesvn.net/)，您的 Windows 资源管理器中包含了 Subversion 支持。您不需要安装 SVN，因为它所需的一切都包含在设置中。您可以在文件系统中所需的任何位置创建存储库。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-15T10:35:48.257

[Git](http://git.or.cz/)创建不需要中央服务器的存储库。此外，您当然可以恢复任何以前版本的跟踪文件，这当然是源代码控制系统的全部内容。:)

编辑：还有其他分散的版本控制系统，例如[Mercurial](http://www.selenic.com/mercurial/)和[Bazaar](http://bazaar-vcs.org/)。它们都提供或多或少完全相同的功能，因此这主要取决于个人品味。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T10:44:36.477

我不确定你所说的 svn 备份是什么意思。也许你应该试试[mercurial](http://www.selenic.com/mercurial/) (hg)。

*   您的本地文件和存储库在同一个地方（它是一个分布式系统）
*   您可以轻松地移动本地文件/存储库
*   使用拉/推与另一个父存储库同步（即在外部硬盘驱动器上进行备份）
*   不需要服务器
*   易于与他人合作，即使只是使用电子邮件和 mercurial bundels ...
*   具有比 svn 更多的功能，例如，如果您更改某些内容（在新分支中或使用 mercurial-queues）然后一次性切换到这些更改，您将拥有更多控制权。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T10:45:18.957

如果您在 Windows 机器上工作并且不想设置 Subversion 服务器和服务，我可以推荐[Mercurial和](http://www.selenic.com/mercurial)[TortoiseHg](http://tortoisehg.sourceforge.net/)一起使用。

TortoiseHg 是 Mercurial 的图形用户界面，就像 TortoiseSVN 用于 Subversion 一样。因此，如果您有 Subversion 经验，您将很容易切换到 Mercurial。

Mercurial 不需要特殊的服务器，甚至不需要存储库位置，您可以在项目目录中设置存储库。然后，您可以移动或复制包括存储库在内的项目目录，例如将其复制到笔记本电脑。之后，您可以合并项目目录的两个副本。所以你总是随身携带你的存储库。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-22T17:05:43.773

如果您对 SVN 或 tortoiseSVN 感兴趣，请澄清：

您可以使用以下命令创建本地 svn-repository：

```
svnadmin create c:\my_folder\new_repo 
```

或适当的 TortoiseSVN 命令**“在此处创建存储库”**

您可以使用众所周知的文件 URL 签出您的存储库：

```
svn checkout file:///c:/my_folder/new_repo 
```

或者通过使用 Tortoise SVN 的结帐对话框并使用这个 File-URL。请注意，后面需要 3 个斜杠

```
file: 
```

并且所有 Windows 反斜杠（“\”）必须转换为普通斜杠（“/”）

然后你有一个 Subversion 工作副本启动并运行，你可以随意使用它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-15T10:37:09.097

> 我想以子版本的方式备份我的文件

你去吧，你只是回答了你自己的问题。使用 subversion，您可以将其安装为本地存储库，甚至可以将存储库保存在闪存/USB 磁盘上。我就是做这个的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T11:02:05.287

我使用[DropBox](http://www.getdropbox.com/)，因为我的文件在我使用的多台计算机之间自动同步，文件可以从任何具有用户名和密码的 PC 获得，并且它会自动备份任何以前版本的上传文件。

它可能并不完美，我会三思而后行地将它用于任何有安全问题的项目，但对于我自己的工作，尤其是与工作无关的工作，我喜欢它。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-15T11:08:58.907

我使用 Tortoise SVN，并将我的存储库保存在我的 pendrive 上。这样我就可以将它插入我正在使用的任何机器上，无论它是在线还是离线，windows 或 linux 等；检查我的工作空间；并且相当有信心我可以保持同步。

当然，总是有丢失 pendrive 的危险，但我并不太担心，因为我倾向于拥有几台机器，其中的所有内容都是最新版本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T11:02:01.107

另一种选择是使用[Fossil](http://fossil-scm.hwaci.com/index.html/doc/tip/www/index.wiki)。这个小应用程序将你所有的东西保存在 SQLite 数据库中，同一个应用程序是一个问题跟踪器，因此你可以跟踪你的 TeX、代码等，甚至是你需要处理的任务。对于一个小项目，我觉得这很酷，因为我可以把它放在 U 盘上。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-02T06:40:30.447

不，你不需要去颠覆或 Git，如果它是一个人的项目，没有理由让它变得那么复杂。如果您想在没有服务器且配置最少的计算机上使用本地的东西，我会选择[History Explorer之类的东西](http://www.exendo.se/ScreenCast.html)

它使您可以轻松查看已更改的文件并回退到任何时间点。它也不需要您签入文件。它是自动的。

# c++ - 我在哪里可以获得“有用的”C++ 二分搜索算法？

> ID：446296
> 
> 赞同：120
> 
> 时间：2009-01-15T10:34:46.217
> 
> 标签：c++, algorithm, stl, binary-search

我需要一个与 C++ STL 容器兼容的二进制搜索算法，类似于`std::binary_search`标准库的`<algorithm>`标头中的内容，但我需要它返回指向结果的迭代器，而不是告诉我元素是否存在的简单布尔值。

（顺便说一句，标准委员会在为 binary_search 定义 API 时到底在想什么？！）

我主要关心的是我需要二进制搜索的速度，所以虽然我可以使用其他算法找到数据，如下所述，但我想利用我的数据已排序的事实来获得二进制的好处搜索，而不是线性搜索。

到目前为止`lower_bound`，`upper_bound`如果缺少基准，则失败：

```
//lousy pseudo code
vector(1,2,3,4,6,7,8,9,0) //notice no 5
iter = lower_bound_or_upper_bound(start,end,5)
iter != 5 && iter !=end //not returning end as usual, instead it'll return 4 or 6 
```

**注意：**只要它与容器兼容，我也可以使用不属于 std 命名空间的算法。比如说，`boost::binary_search`。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-01-15T10:45:11.030

没有这样的功能，但您可以使用[`std::lower_bound`](http://en.cppreference.com/w/cpp/algorithm/lower_bound),[`std::upper_bound`](http://en.cppreference.com/w/cpp/algorithm/upper_bound)或编写一个简单的功能[`std::equal_range`](http://en.cppreference.com/w/cpp/algorithm/equal_range)。

一个简单的实现可能是

```
template<class Iter, class T>
Iter binary_find(Iter begin, Iter end, T val)
{
    // Finds the lower bound in at most log(last - first) + 1 comparisons
    Iter i = std::lower_bound(begin, end, val);

    if (i != end && !(val < *i))
        return i; // found
    else
        return end; // not found
} 
```

另一种解决方案是使用 a `std::set`，它保证元素的顺序并提供一种`iterator find(T key)`将迭代器返回给给定项目的方法。但是，您的要求可能与使用集合不兼容（例如，如果您需要多次存储相同的元素）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-15T10:39:08.203

你应该看看`std::equal_range`。它将返回一对迭代器到所有结果的范围。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T10:41:28.743

其中有一组：

[http://www.sgi.com/tech/stl/table_of_contents.html](http://www.sgi.com/tech/stl/table_of_contents.html)

搜索：

*   [下限](http://www.sgi.com/tech/stl/lower_bound.html)
*   [上限](http://www.sgi.com/tech/stl/upper_bound.html)
*   [相等范围](http://www.sgi.com/tech/stl/equal_range.html)
*   [二进制搜索](http://www.sgi.com/tech/stl/binary_search.html)

单独说明：

他们可能认为搜索容器可以得出多个结果。但是在您只需要测试是否存在的奇怪情况下，优化版本也会很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-03T12:58:50.777

如果您不喜欢 std::lower_bound 太低级，您可能需要检查[boost::container::flat_multiset](http://www.boost.org/doc/libs/1_51_0/doc/html/container/non_standard_containers.html#container.non_standard_containers.flat_xxx)。它是使用二进制搜索实现为排序向量的 std::multiset 的直接替代品。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-09-25T12:26:27.050

最短的实现，想知道为什么它没有包含在标准库中：

```
template<class ForwardIt, class T, class Compare=std::less<>>
ForwardIt binary_find(ForwardIt first, ForwardIt last, const T& value, Compare comp={})
{
    // Note: BOTH type T and the type after ForwardIt is dereferenced 
    // must be implicitly convertible to BOTH Type1 and Type2, used in Compare. 
    // This is stricter than lower_bound requirement (see above)

    first = std::lower_bound(first, last, value, comp);
    return first != last && !comp(value, *first) ? first : last;
} 
```

来自[https://en.cppreference.com/w/cpp/algorithm/lower_bound](https://en.cppreference.com/w/cpp/algorithm/lower_bound)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-12T19:50:43.283

```
int BinarySearch(vector<int> array,int var)
{ 
    //array should be sorted in ascending order in this case  
    int start=0;
    int end=array.size()-1;
    while(start<=end){
        int mid=(start+end)/2;
        if(array[mid]==var){
            return mid;
        }
        else if(var<array[mid]){
            end=mid-1;
        }
        else{
            start=mid+1;
        }
    }
    return 0;
} 
```

例子：考虑一个数组，A=[1,2,3,4,5,6,7,8,9] 假设你要搜索3的索引 最初start=0 and end=9-1=8 现在, 因为开始<=结束; 中=4；(array[mid] which is 5) !=3 现在，3 位于 mid 的左侧，因为它小于 5。因此，我们只搜索数组的左侧因此，现在 start=0 和 end=3; mid=2。由于数组[mid]==3，因此我们得到了要搜索的数字。因此，我们返回等于 mid 的索引。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T11:02:20.357

检查此功能[qBinaryFind](http://qt-project.org/doc/qt-5.1/qtcore/qtalgorithms.html#qBinaryFind)：

> ```
> RandomAccessIterator qBinaryFind ( RandomAccessIterator begin, RandomAccessIterator end, const T & value ) 
> ```
> 
> 对范围 [begin, end) 执行二分搜索并返回 value 出现的位置。如果没有出现 value，则返回 end。
> 
> [begin, end) 范围内的项目必须按升序排序；参见 qSort()。
> 
> 如果多次出现相同的值，则可以返回其中任何一个。如果您需要更精细的控制，请使用 qLowerBound() 或 qUpperBound()。
> 
> 例子：
> 
> ```
> QVector<int> vect;
>  vect << 3 << 3 << 6 << 6 << 6 << 8;
> 
>  QVector<int>::iterator i =
>          qBinaryFind(vect.begin(), vect.end(), 6);
>  // i == vect.begin() + 2 (or 3 or 4) 
> ```

该函数包含在作为[Qt](http://en.wikipedia.org/wiki/Qt_toolkit)库`<QtAlgorithms>`一部分的头文件中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T10:43:51.127

std::lower_bound() :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-15T21:56:35.507

返回范围内位置的解决方案可能是这样的，只使用迭代器上的操作（即使迭代器不算术它也应该工作）：

```
template <class InputIterator, typename T>
size_t BinarySearchPos(InputIterator first, InputIterator last, const T& val)
{       
    const InputIterator beginIt = first;
    InputIterator element = first;
    size_t p = 0;
    size_t shift = 0;
    while((first <= last)) 
    {
        p = std::distance(beginIt, first);
        size_t u = std::distance(beginIt, last);
        size_t m = p + (u-p)/2;  // overflow safe (p+u)/2
        std::advance(element, m - shift);
        shift = m;
        if(*element == val) 
            return m; // value found at position  m
        if(val > *element)
            first = element++;
        else
            last  = element--;

    }
    // if you are here the value is not present in the list, 
    // however if there are the value should be at position u
    // (here p==u)
    return p;

} 
```

# c# - 关于类聚合关系的 linq orderby 帮助

> ID：446303
> 
> 赞同：2
> 
> 时间：2009-01-15T10:36:27.053
> 
> 标签：c#, linq-to-objects

我有点困惑，需要一些帮助。上这两个课

```
public class Comment
{
     public string Message {get; set;}
     public DateTime Created {get; set;}
}

public class Post
{
    public int PostId {get; set;}
    public string Content {get; set;}
    public IList<Comment> Comments {get; set;}
} 
```

我想编写一个 linq 查询，它返回一个帖子，但按评论创建日期排序。

所以我开始构建我的 linq 查询如下：

```
var query = from p in _repository.GetPosts()
                        where p.PostId == id
                        orderby p.Comments.Select(x => x.Created)
                        select p;

            return query.Single(); 
```

但是 orderby 语句似乎不起作用！它只是以默认排序顺序返回我的列表。关于如何使这项工作的任何建议？？？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T10:45:56.303

*在哪个*评论日期订购？首先？最后？你可以尝试：

```
orderby p.Comments.Max(x=>x.Created) 
```

例如。

另外-您`Single`建议您只期望**一行**，在这种情况下，对其进行排序没有多大意义。你的意思是`First()`？

* * *

或者你的意思是你想要排序`Comments`？在这种情况下，获得第`Post`一个；

```
Post post = ... 
```

现在......排序`Comments`有点棘手，因为你`IList<T>`- 如果你不介意它有点低效，这很简单：

```
post.Comments = post.Comments.OrderBy(x=>x.Created).ToList(); 
```

当然，如果`Comments`是`List<T>`，你可以这样做：

```
post.Comments.Sort((x, y) => (x.Created.CompareTo(y.Created))); 
```

您还可以采取一些技巧来制作表单的扩展方法：

```
post.Comments.Sort(x=>x.Created); 
```

IE

```
public static void Sort<TSource, TKey>(
    this List<TSource> source,
    Func<TSource, TKey> selector)
{
    var comparer = Comparer<TKey>.Default;
    source.Sort((x, y) => comparer.Compare(selector(x), selector(y)));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T10:46:05.600

您的 orderby 投影返回`IEnumerable<DateTime>`- 这听起来不太可能是您想要的。

一个帖子有很多评论 - 您希望哪一个作为使用创建日期进行订购的评论？我的猜测是第一个：

```
var query = from p in _repository.GetPosts()
                    where p.PostId == id
                    orderby {
                        Comment comment = p.Comments.FirstOrDefault();
                        return comment == null ? DateTime.MinValue : comment.Created;
                    }
                    select p; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T10:46:45.660

这将返回一个 IEnumerable 集合，它不是一个可比较的值：

```
p.Comments.Select(x => x.Created) 
```

试试这个：

```
p.Comments.Max(x => x.Created) 
```

返回最新评论的日期

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T10:51:14.107

如果您想对评论的结果列表进行排序，您可以在获取帖子后执行以下操作：

```
p.Comments = p.Comments.OrderBy(x => x.Created).ToList(); 
```

.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T10:54:49.233

问题是您试图按评论创建日期列表对帖子列表进行排序，而不是对评论列表进行排序。

如果我正确阅读了您的问题，我假设您想发布单个帖子，然后对该帖子中的评论进行排序。尝试以下方法来做到这一点：

```
var query = from p in _repository.GetPosts()
            where p.PostId == id
            orderby p.Comments.Select(x => x.Created)
            select p;

var ret = query.Single();
ret.Comments = ret.Comments.OrderBy(x => x.Created).ToList();
return ret; 
```

# java - 我应该在 Java 1.5 中使用哪个 XPathAPI？

> ID：446315
> 
> 赞同：1
> 
> 时间：2009-01-15T10:40:18.357
> 
> 标签：java, xpath, xpath-api

我一直在使用 com.sun.org.apache.xpath.internal.XPathAPI 一段时间，它似乎工作正常。最近我尝试在 Eclipse 中使用 TPTP 分析器，但找不到 XPathAPI 类。

我还没有想到这个问题，但它确实让我想知道我是否应该在“内部”包中使用一个类？我应该使用 Xalan 库吗？要不然是啥？？

（我目前正在为这个项目使用 JRE 1.5.0_06）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T11:15:27.210

com.sun 包下的所有类都是内部实现细节。你永远不应该直接引用它们。

JDK 中 xPath 的基础是[javax.xml.xpath](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/xpath/package-frame.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T11:43:26.437

使用包`XPathFactory.newInstance()`中的方法`javax.xml.path`。

我认为这是在 Java 1.5 中引入的。如果您必须恢复到 Java 1.4 或更早版本，我认为您必须使用这些`com.sun`包，这从来都不是一个好主意（但有时是不可避免的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T12:11:11.217

如果性能是任何问题，无论您做什么，都不要为此使用 Xalan。Xalan XPathAPI 接口非常慢。我们包装 Jaxen 以提供类似 XPathAPI 的接口。那要快得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-07T20:49:22.740

我放入 Xalan jar (2.7.0) 并在导入中使用 org.apache.xpath.XPathAPI 并且弃用消息消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T11:03:47.373

我们使用 jdom，但 apache commons 始终是一切的好选择。

# delphi - 在 dbaware 文本字段中显示时用空格填充的值

> ID：446316
> 
> 赞同：1
> 
> 时间：2009-01-15T10:40:18.590
> 
> 标签：delphi, data-binding, textbox

我正在使用 ADO 组件连接到访问数据库。在定义为宽度为 50 的文本的列中，数据感知文本字段始终显示 50 个字符，即使实际字符串值包含较少字符也是如此。该值用空格填充，如果文本字段不够宽，则看起来它是空的。

有人有任何线索吗？

谢谢，-素食主义者

编辑：我正在使用 Delphi 2007。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:33:15.977

问题来自于在创建表时使用 Char(50) 而不是 Varchar(50)。

我仍然认为应该有一种显示未填充值的方法，但是切换到 varchar 是可以的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T10:54:56.673

哪个版本的德尔福？

而且不能是access数据库中的字段设置吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T18:32:37.530

您使用的是查询还是表格组件？如果您使用的是查询，那么只需将列名嵌入到*Trim()*中。如果没有，则使用相关字段上的 OnGetText 事件输入以下代码

```
 Text := Trim(Text); 
```

# c# - C# 编译器和局部变量缓存

> ID：446320
> 
> 赞同：2
> 
> 时间：2009-01-15T10:43:18.180
> 
> 标签：c#, optimization, compiler-construction

**编辑：**哎呀——正如正确指出的那样，没有办法知道所讨论的类的构造函数是否对调用它的时间或次数敏感，或者对象的状态是否在方法期间发生变化，所以它每次都必须从头开始创建。忽略字典，只考虑在方法过程中内联创建的委托:-)

* * *

假设我有以下方法，使用 Dictionary of Type to Action 局部变量。

```
void TakeAction(Type type)
{
    // Random types chosen for example.
    var actions = new Dictionary<Type, Action>()
    {
        {typeof(StringBuilder), () =>
            {
                // ..
            }},
         {typeof(DateTime), () =>
            {
                // ..
            }}
    };

    actions[type].Invoke();
} 
```

调用该方法时，字典总是相同的。C# 编译器能否注意到这一点，只创建一次并将其缓存在某处以供将来调用该方法时使用？还是每次都只是从头开始创建？我知道它可能是包含类的一个字段，但对我来说，将这样的东西包含在使用它的方法中似乎更整洁。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T10:50:16.467

C# 编译器应该如何知道它每次都是“相同的”字典？您每次都显式地创建一个新字典。C# 不支持静态局部变量，因此您必须使用字段。即使没有其他方法使用该字段，这也没有什么问题。

如果 C# 编译器做这样的事情会很糟糕。如果变量的构造函数使用随机输入怎么办？:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T10:56:41.773

简短的回答：没有。

稍微长一点的答案：我相信它会缓存从 lambda 表达式创建委托的结果，该表达式不捕获任何内容（包括“this”），但这是一个非常特殊的情况。

更改代码的正确方法：为字典声明一个私有静态只读变量。

```
private static readonly Dictionary<Type,Action> Actions = 
    new Dictionary<Type, Action>()
{
    { typeof(StringBuilder), () => ... },
    { typeof(DateTime), () => ... },
}

void TakeAction(Type type)
{
    Actions[type].Invoke();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T11:36:39.930

对于任何能够做到这一点的编译器，它必须有某种方式来保证以下问题：

*   以完全相同的方式构造两个对象会以任何方式产生相同的对象，除了它们在内存中的位置。*这意味着第二次构造的对象与第一次构造的对象没有什么不同，而不是说缓存 Random 类型的对象。*
*   与对象交互不会改变其状态。*这意味着缓存对象是安全的，不会改变后续调用的行为。例如，这将排除以任何方式修改字典。*

这样做的原因是编译器必须能够保证它第一次构造的对象在下一次同样可用，而不必重新创建它。

现在，C# 和 .NET 没有做出这些保证的机制可能不是编译器不支持这种优化的原因，但必须首先实现这些。编译器可能还需要其他这样的保证才能做到这一点，这是我不知道的。

Jon Skeet 建议的更改基本上是说*我知道这两个保证适用于我的代码*，因此您可以自己控制情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T10:56:39.947

每次都会重新创建该字典；否则，例如，您可以将其他内容放入字典中，并且意图将丢失。

# asp.net - ASP.NET 中的全局资源与本地资源

> ID：446321
> 
> 赞同：37
> 
> 时间：2009-01-15T10:43:30.410
> 
> 标签：asp.net, localization, resx

我们使用 resx 文件来本地化我们的 Web 应用程序。当只有一个页面使用某个短语时，我们通常会创建本地 resx 文件（映射到特定页面），而当多个页面需要该短语时，我们会创建全局 resx 文件。
但是全局 resx 文件的好处是它们是一个类，您可以像调用类的属性一样调用这些短语：

资源.UI.iNotFound

所以我在想 - 为什么有本地 resx 文件？为什么不为整个应用程序使用一个全局 resx 文件，这样可以避免调用不存在的短语导致运行时错误？

我敢肯定有一个很好的答案，我只是不知道它是什么......

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-29T11:25:52.890

我一直在寻找指导方针，并在[MSDN](http://msdn.microsoft.com/en-us/library/ms227427.aspx)中找到了这个：

> **在全局和本地资源文件之间进行选择**
> 
> 您可以在 Web 应用程序中使用全局和本地资源文件的任意组合。通常，当您希望在页面之间共享资源时，您将资源添加到全局资源文件中。当您想以编程方式访问文件时，全局资源文件中的资源也是强类型的。
> 
> 但是，如果您在其中存储所有本地化资源，全局资源文件可能会变得很大。如果多个开发人员在不同的页面上工作但在一个资源文件中，则全局资源文件也可能更难管理。
> 
> 本地资源文件使管理单个 ASP.NET 网页的资源变得更加容易。但是您不能在页面之间共享资源。此外，如果您有许多必须本地化为多种语言的页面，您可能会创建许多本地资源文件。如果站点很大，包含许多文件夹和语言，本地资源可以快速扩展应用程序域中的程序集数量。
> 
> 当您更改本地或全局默认资源文件时，ASP.NET 会重新编译资源并重新启动 ASP.NET 应用程序。这可能会影响您网站的整体性能。如果添加附属资源文件，它不会导致重新编译资源，但 ASP.NET 应用程序将重新启动。

因此，似乎真的要由编程团队来权衡每种方法的优缺点，然后选择对他们有利的方法。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-06T00:39:41.967

Joe90 - 我不得不说，根据我的经验，我不能同意管理分散在整个项目中的大量本地资源文件比管理一个全局资源文件更容易。没有什么可以阻止一次又一次地重复相同的翻译，而且它们很难追踪。访问全局资源文件非常容易在团队内进行协调，多个用户可以一眼看出他们所需的翻译是否已经完成。

我从与 Lea 完全相同的策略开始 - 即从本地资源文件开始，然后将其移动到全局资源文件，如果它被多次引用。这很快就变成了管理的麻烦，我现在每次都使用全局资源文件。

微软似乎没有关于最佳实践是什么，甚至这两种方法是如何实现的明确指导方针，因此我们可以冒险猜测！

我*猜*比较/回报是本地资源文件只需要重新编译它们相关的文件，而更改全局资源文件似乎需要重新编译整个网站 - 会话状态等的固有损失。因此需要在更新期间使站点脱机以确保安全。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-02-05T10:41:04.670

我的开发团队至少有 10 名开发人员开发一个产品，我们为每个站点使用一个全局 resx。

在我看来，合并这个大 resx 文件的问题应该不是问题。

如果您有 10 个开发人员自己在网站上设置语言，您如何在网站上获得统一的表达方式？开发人员往往擅长代码而不是语法表达。（我自己就是一名开发人员。）

语言专家应该编辑 resx 文件并为开发人员锁定它！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-03T04:47:50.657

全球资源文件是最好的翻译方法。关键是使用命名约定，例如字符串名称的前几个字母的页面名称缩写，以便您可以轻松地在每个网页的基础上找到资源。试图在多个页面中重复使用许多短语会给翻译者带来更多的困惑。

您可以根据需要定义可重复使用的短语，例如 Yes、No、BTN_OK、BTN_Cancel、QTN_AreYouSure 等，方法是使用缺少页面命名约定（前几个字母没有页面名称缩写）。您的大部分 RESX 行将特定于每个页面，您不应专注于尝试尽可能多地重用。在需要时使用文本查找/替换可以在几分钟内小心地更改整个文件中的一个短语。

# sql - Sql Server 忽略更新错误

> ID：446322
> 
> 赞同：0
> 
> 时间：2009-01-15T10:43:45.213
> 
> 标签：sql

我继承了一个非常旧的数据库，需要更新一些数据。每行都有一列，其 UniqueID 看起来像 C0042-45-39612。代码的最后 3 个数字是类别 ID（在本例中为 612）。

我需要进行仅针对某些类别的更新，并且我正在使用此 SQL 语句

```
UPDATE WebbikesProducts SET Price = Price * 1.05 WHERE Convert( Integer, SubString( UniqueID, 3, 3 )) = 125 
```

这里明显的问题是，如果唯一代码末尾没有 3 个数字怎么办？好吧，这正是我遇到的问题，因为并非所有项目都被分类或具有唯一编号，例如 C0049-307-1CHROME。

我没有访问数据库的权限（我从一个asp页面调用它），所以我不想创建一个存储过程。数据库是 SQL 2000。

有没有办法忽略有错误的行并继续更新其他行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T11:00:50.437

我不确定您为什么要麻烦转换为 int。为什么不只对最后三位数字进行字符串比较。此外，您正在做 - substring(id, 3, 3)。

我假设您已经简化了上面的代码片段以使其更易于阅读，并且您已经先提取了 39612？

我建议如下：

```
where UniqueID like '%612' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T11:01:56.333

试试这个：

```
UPDATE WebbikesProducts 
SET Price = Price * 1.05 
WHERE ISNUMERIC(SubString( UniqueID, 3, 3 )) = 1
AND Convert( Integer, SubString( UniqueID, 3, 3 )) = 125 
```

甚至更简单：

```
UPDATE WebbikesProducts 
SET Price = Price * 1.05 
WHERE SubString( UniqueID, 3, 3 ) = '125' 
```

-江户

# javascript - 阻止在 Firefox 中选择/复制到剪贴板

> ID：446334
> 
> 赞同：0
> 
> 时间：2009-01-15T10:47:31.713
> 
> 标签：javascript, firefox

我需要防止用户使用 java 脚本在浏览器 Mozilla Firefox 中选择文本（全选或选择部分文本）。我已经使用 Internet Explorer 完成了此操作，但它似乎不适用于 Mozilla。

有什么提示吗？网址？样本？

TIA。

编辑：

实际上，这个荒谬的问题是我们的客户要求的。是的，我们已经向他们解释了还有一千种其他方法可以获取文本。但他们回答说他们知道这一点，他们只是想阻止业余用户这样做。

我已经做了一些谷歌搜索，并在[这里](http://forums.mozillazine.org/viewtopic.php?f=8&t=168887)找到了与解决方案类似的问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-15T10:51:11.363

如果您真的想防止人们复制粘贴，请将文本渲染为图像。Javascript 技巧总是可以被禁用和/或解决。

当然，防止人们复制文本的最好方法是根本不显示它——他们可能会阅读并重新输入！;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T14:10:31.833

没有办法完全保护您发布的内容，除非 DRM 方案的普及程度不足以对网站有用。但是为了防止简单的复制和粘贴，有几种方法，每种方法都对您的用户来说非常烦人。

`DIV`一种简单的方法是使用 CSS 定位用另一个元素（例如 a ）覆盖文本。这意味着当用户尝试单击`DIV`以选择文本时，将没有文本可供选择。应该在任何支持 CSS 的浏览器和不支持 CSS 的浏览器中工作，它可能完全不可见。单击页面并按`CTRL`+ `A`（或其他快捷键）无论如何都可能选择文本，并且可能无法阻止所有可以获取文本的键和鼠标事件。但是这种`DIV`“盖子”方法至少不显眼且易于概括。但是，通过查看 HTML 源代码可以轻松解决这个问题。通过关闭 CSS（在 Firefox 中很容易做到，而且许多 Firefox 用户已经足够老练可以做到），它并没有那么容易被打败。

一种更强大的方法是将文本呈现为图形，使用常规图像文件或 PDF 之类的文件。但是图形可以进行 OCR 处理。有免费的工具。

最后，您可以将文本放入 Flash 或 Java 小程序中，这些小程序将从服务器下载文本。有人可能会窃取您的小程序，但由于同源安全策略（注意：这也可以解决），因此难以使其与您的网络服务器通信。这种方法并不比 PDF 方法好多少，只是它使抓取整个文档变得更加困难，因为小程序一次只会显示文档的一部分。为了使用 OCR 解决这个问题，攻击者必须进行屏幕截图。或者他们可以对您的小程序进行逆向工程并制作一个新的小程序（甚至是常规程序），该程序可以从您的服务器下载所有内容。

所有这些方法都只是最基本的用途，我怀疑你会发现它们根本没有帮助。您可能会在构建有用功能而不是这个方面获得更多投资回报。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T10:51:25.683

不可能，据我所知。

此外，用户始终可以从选项页面禁用 Javascript。因此，您不能真正依赖使用 Javascript 来保护您的数据。

在 IE 和 Firefox 中，用户都可以选择查看 HTML 页面的源代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T11:00:24.853

我只能建议不要试图阻止用户在网站上选择文本。怀着恶意想要复制文本的用户总会找到方法，但你会激怒那些只想复制链接或想要复制一些文本以便将其舒适地粘贴到搜索框中的用户。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-09T22:03:51.033

为什么大家都假设防止选择的目的一定是因为你想保护文本。如果测试是在你的 UI 中某个不需要复制文本的地方，而意外选择只是烦人的怎么办。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T10:58:18.150

谷歌图书似乎在防止复制文本/图像内容方面做得很好。不过，我不知道他们是如何做到这一点的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T14:19:05.233

您还可以将文本呈现到嵌入式 Flash 对象。这是一种相当简单的技术，通常用于博客模板

# .net - 从 C# 应用程序将文件发送到 Symantec AV Scan Engine

> ID：446335
> 
> 赞同：2
> 
> 时间：2009-01-15T10:47:32.553
> 
> 标签：.net, antivirus

我们需要使用 Symantec AV Scan Engine 从我们的 .Net 应用程序上传文件时对其进行扫描，该应用程序支持[ICAP](http://en.wikipedia.org/wiki/Internet_Content_Adaptation_Protocol)
任何有关如何进行此操作的指示都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T19:38:54.350

与扫描引擎下载捆绑在一起的扫描引擎 SDK 有一个不错的 C、Java 和 C# 中的 icap 包装器。亲切的问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T13:05:31.503

通常，企业级部署支持 ICAP 端点，但不支持您在百思买购买的 39 美元的东西。您的部署方案是什么？

# web-services - 将摘要标记添加到生成的 Web 服务代理类的最佳方法是什么？

> ID：446350
> 
> 赞同：0
> 
> 时间：2009-01-15T10:53:08.580
> 
> 标签：web-services, proxy, comments, service-reference

阿罗哈

我在我的 .NET 2.0 应用程序中引用了一个外部 Web 服务。添加服务引用为我生成了一个不错的代理类。我想为此添加`///<summary>`样式文档。如果更新了服务参考，我所有闪亮的评论都消失了。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T10:58:54.513

您可以围绕生成的代理类创建一个包装类，并在那里记录方法。然后，您总是使用包装类，而不是直接使用生成的代理。例如：

```
public class MyWebServiceWrapper
{
  private MyWebService _service = null;

  public MyWebServiceWrapper()
  {
    _service = new MyWebService();
  }

  ///<summary>
  /// doc goes here
  ///<summary>
  public int MethodOne()
  {
    return _service.MethodOne();
  }
} 
```

这种方法允许您在需要时重新生成代理类。

当然这意味着，每当 Web 服务的接口发生变化时，您都必须（手动）更新包装类。另一方面，包装类还允许您添加一些集中的错误处理等。

# xslt - XSLT 中的动态变量

> ID：446354
> 
> 赞同：4
> 
> 时间：2009-01-15T10:56:05.453
> 
> 标签：xslt, libxml2

我将一堆键值对作为参数传递给 XSL（日期 ->“1 月 20 日”，作者 ->“Dominic Rodger”，...）。

这些在我正在解析的一些 XML 中被引用 - XML 看起来像这样：

```
<element datasource="date" /> 
```

目前，我不知道如何从这些中获得 1 月 20 日，除非有一个可怕的`<xsl:choose>`声明：

```
<xsl:template match="element">
  <xsl:choose>
    <xsl:when test="@datasource = 'author'">
      <xsl:value-of select="$author" />
    </xsl:when>
    <xsl:when test="@datasource = 'date'">
      <xsl:value-of select="$date" />
    </xsl:when> 
    ...
  </xsl:choose>
</xsl:template> 
```

我想使用类似的东西：

```
<xsl:template match="element">
  <xsl:value-of select="${@datasource}" />
</xsl:template> 
```

但我怀疑这是不可能的。我开始使用外部函数调用，但希望避免在我的 XSL 中枚举所有可能的映射键。有任何想法吗？

谢谢，

多姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:03:30.807

**这是一种可能的解决方案**，但是我建议将所有参数分组到一个单独的 XML 文件中并使用[**`document()`**](http://www.w3.org/TR/xslt#function-document)函数访问它们：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
 exclude-result-prefixes="ext"
 >
 <xsl:output method="text"/>

 <xsl:param name="date" select="'01-15-2009'"/>
 <xsl:param name="author" select="'Dominic Rodger'"/>
 <xsl:param name="place" select="'Hawaii'"/>
 <xsl:param name="time" select="'midnight'"/>

 <xsl:variable name="vrtfParams">
   <date><xsl:value-of select="$date"/></date>
   <author><xsl:value-of select="$author"/></author>
   <place><xsl:value-of select="$place"/></place>
   <time><xsl:value-of select="$time"/></time>
 </xsl:variable>

 <xsl:variable name="vParams" select="ext:node-set($vrtfParams)"/>

    <xsl:template match="element">
      <xsl:value-of select=
       "concat('&#xA;', @datasource, ' = ',
               $vParams/*[name() = current()/@datasource]
               )"
       />
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**：

```
<data>
  <element datasource="date" />
  <element datasource="place" />
</data> 
```

**产生正确的结果**：

日期 = 01-15-2009

地方=夏威夷

请注意使用该[**`xxx:node-set()`**](http://dpawson.co.uk/xsl/sect2/nodeset.html)函数（此处使用[**EXSLT**](http://exslt.org/exsl/functions/node-set/index.html)函数）将 RTF（[**结果树片段**](http://www.w3.org/TR/xslt#section-Result-Tree-Fragments)）转换为常规 xml 文档（临时树）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T14:22:36.587

如果您的@datasource 始终与参数名称匹配，您可以尝试“评估”功能。注意：此代码未经测试。

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:exslt-dynamic="http://exslt.org/dynamic"
>

<xsl:param name="date"/>

<xsl:template match="element">
  <xsl:value-of select="exslt-dynamic:evaluate('$' + @datasource)"/>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-15T11:36:14.343

怎么样

```
<xsl:template match="date-element">
  <xsl:text>${date}</xsl:text>
</xsl:template> 
```

即不使用属性，而是使用不同的元素名称进行匹配。

如果您无法更改源 XML，请通过将属性转换为正确元素名称的小型 XSLT 运行它。

一种不同的解决方案是将 xsl:param 元素放入不同的 XML 文档中（或尝试使 XSLT 模板再次读取自身）。然后您可以使用 xsl:key 和 key() 来引用它们。

[编辑] 将 xsl:value-of 替换为 xsl:text。我手边没有 XSLT 实用程序，所以我无法对此进行测试。如果这也不起作用，请发表评论。

# image - 存储大量图像

> ID：446358
> 
> 赞同：52
> 
> 时间：2009-01-15T10:57:43.097
> 
> 标签：image, tree, filesystems

我正在考虑开发我自己的基于 PHP 的画廊来存储大量图片，可能有数万张。

在数据库中，我将指向图像的 url，但问题是：我知道让它们都位于服务器的同一目录中是不切实际的，因为它会减慢爬网的访问速度，所以，你会怎么做全部存储？某种基于 jpeg/png 名称的树？

你会向我推荐什么分割图像的规则？

（它将专注于在cheapo dot coms 中使用，因此不可能与服务器发生冲突）

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-15T11:18:07.640

我们过去也遇到过类似的问题。并找到了一个不错的解决方案：

*   给每个图像一个独特的指南。
*   为每个图像创建一个数据库记录，其中包含子图像的名称、位置、guid 和可能的位置（缩略图、缩小尺寸等）。
*   使用 guid 的第一个（一个或两个）字符来确定顶级文件夹。
*   如果文件夹中的文件太多，请再次拆分。更新参考资料，您就可以开始了。
*   如果文件数量和访问量太大，您可以将文件夹分布在不同的文件服务器上。

我们已经体验过，使用指南，您会获得或多或少的统一划分。它就像一个魅力。

可能有助于生成唯一 ID 的链接：

*   [http://en.wikipedia.org/wiki/Universally_Unique_Identifier](http://en.wikipedia.org/wiki/Universally_Unique_Identifier)
*   [http://en.wikipedia.org/wiki/Sha1](http://en.wikipedia.org/wiki/Sha1)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-15T13:07:20.400

几年前我在一个电子文档管理系统上工作，我们几乎按照 Gamecat 和 wic 的建议做了。

也就是说，为每个图像分配一个唯一的 ID，并使用它来导出图像文件的相对路径。我们使用了类似wic建议的MOD，但是我们允许每个级别1024个文件夹/文件，有3个级别，所以我们可以支持1G文件。

但是，我们从文件中删除了扩展名。数据库记录包含 MIME 类型，因此不需要扩展。

我不建议将完整的 URL 存储在数据库记录中，只存储图像 ID。如果您存储 URL，您将无法在不转换数据库的情况下移动或重组您的存储。相对 URL 可以，因为这样您至少可以移动图像存储库，但如果您只存储 ID 并派生 URL，您将获得更大的灵活性。

此外，我不建议允许从网络直接引用您的图像文件。相反，提供一个服务器端程序（例如，Java Servlet）的 URL，并在 URL 查询 ( `http://url.com/GetImage?imageID=1234`) 中提供图像 ID。

servlet 可以使用该 ID 来查找 DB 记录、确定 MIME 类型、导出实际位置、检查安全限制、日志记录等。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T12:38:02.737

我通常只使用数字数据库 id (auto_increment)，然后使用模数 (%) 运算符来确定文件的放置位置。简单且可扩展。例如，可以像这样创建 id 为 12345 的图像的路径：

```
12345 % 100 = 45
12345 % 1000 = 345 
```

结束于：

```
/home/joe/images/345/45/12345.png 
```

或类似的东西。

如果您使用的是 Linux 和 ext3 以及文件系统，则必须注意目录中可以拥有的目录和文件的数量是有限的。dirs 的限制是 32000，因此您应该始终努力保持较低的 dirs 数量。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-08-18T09:58:19.063

> 我知道将它们全部放在服务器中的同一目录中是不切实际的，因为它会减慢对爬网的访问。

这是一个假设。

我设计了一个系统，我们将数百万个文件平放在一个目录中，效果很好。它也是最容易编程的系统。大多数服务器文件系统都毫无问题地支持这一点（尽管您必须检查您使用的是哪一个）。

[http://www.databasesandlife.com/flat-directories/](http://www.databasesandlife.com/flat-directories/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-07-28T19:50:57.493

保存与 auto_increment id 关联的文件时，我使用类似以下的内容，它创建三个目录级别，每个级别由 1000 个目录组成，每个第三级目录中有 100 个文件。这支持约 1000 亿个文件。

如果 $id = 99532455444 那么以下返回 /995/324/554/44

```
function getFileDirectory($id) {
    $level1 = ($id / 100000000) % 100000000;
    $level2 = (($id - $level1 * 100000000) / 100000) % 100000;
    $level3 = (($id - ($level1 * 100000000) - ($level2 * 100000)) / 100) % 1000;
    $file   = $id - (($level1 * 100000000) + ($level2 * 100000) + ($level3 * 100));

    return '/' . sprintf("%03d", $level1)
         . '/' . sprintf("%03d", $level2)
         . '/' . sprintf("%03d", $level3)
         . '/' . $file;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-10T12:26:08.097

查看 XFS 文件系统。它支持无限数量的文件，Linux 支持它。 [http://oss.sgi.com/projects/xfs/papers/xfs_usenix/index.html](http://oss.sgi.com/projects/xfs/papers/xfs_usenix/index.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T11:41:58.250

您可以在表格中有一个 DateTime 列，然后将它们存储在以月、年甚至月、日、年命名的文件夹中，并将图像添加到表格中。

例子

1.  2009
2.  -01
3.  --01
4.  --02
5.  --03
6.  --31

这样，您最终的文件夹深度不会超过 3 个。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-05T00:39:59.073

我目前正面临这个问题，而 Isaac 所写的内容让我对这个想法产生了兴趣。我的功能有点不同。

```
function _getFilePath($id) {
    $id = sprintf("%06d", $id);
    $level = array();
    for($lvl = 3; $lvl >= 1; $lvl--)
        $level[$lvl] = substr($id, (($lvl*2)-2), 2);
    return implode('/', array_reverse($level)).'.jpg';
} 
```

我的图片只有数千张，所以我最多只能有 999999 的限制，所以它会将其拆分为 99/99/99.jpg 或 43524 拆分为 04/35/24.jpg

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T11:02:01.590

使用文件系统的层次结构。使用 001/002/003/004.jpg 之类的东西来识别您的图像会非常有帮助。不过，分区是另一回事。可以是随机的、基于内容的、基于创建日期的等等。这真的取决于你的应用程序是什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T11:05:30.507

您可以查看 Apple iPod 用于存储其多媒体内容的策略。有一层深度的文件夹和具有相同宽度标题的文件。我相信苹果公司的人投入了大量时间来测试他们的解决方案，因此它可能会给你带来一些立竿见影的好处。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-15T11:30:45.527

如果您处理的图片是数码照片，您可以使用 EXIF 数据对它们进行排序，例如按拍摄日期。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-15T11:35:54.517

您可以将图像作为 blob 存储在数据库中（对于 mssql为[varbinary ）。](http://msdn.microsoft.com/en-us/library/ms188362.aspx)这样您就不必担心存储或目录结构。唯一的缺点是您不能轻松浏览文件，但无论如何这在平衡的目录树中都很难。

# asp.net-mvc - ASP.NET MVC 项目架构

> ID：446359
> 
> 赞同：6
> 
> 时间：2009-01-15T10:58:13.533
> 
> 标签：asp.net-mvc, architecture

我对**ASP.NET MVC**项目架构感到很*困惑。*在 ASP.NET WebForm 中，我通常使用以下项目模式进行中小型项目

 ****DAL <-- 通过*DTO/reader/dataset*进行通信--> BL <--> UI**

我认为在 MVC 应用程序中应该像

**DAL <-- 通过*DTO/reader/dataset*通信--> BL*是 Model* <--controller --> UI*是 View***

```
 OR 
```

**DAL <--通过*DTO/reader/dataset*通信--> BL <--通过*Model*通信-->控制器<--> UI是*View***

其中 Model 是一些业务对象

如果有人能够（包括*[stackoverflow](http://stackoverflow.com)***的Jeff**制造商）提供任何使用 ASP.NET MVC 的生产级经验，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-21T08:08:51.863

将传统的 3 层**ASP.NET Web App**与**ASP.NET MVC**进行比较，以下成为相应的元素：

**业务逻辑层**和**数据访问层**一起是**模型**

**ASPX**文件是**视图**

**代码隐藏**(ASPX.CS) 是**控制器**

查看这些链接以获取有关 SO 同一主题的更多讨论：

[ASP.NET MVC Web 应用程序与 ASP.NET Web 应用程序](https://stackoverflow.com/questions/276211/asp-net-mvc-web-application-vs-asp-net-web-application)

[MVC 模式与 DAL/BLL 设计模式有何不同（如果有的话）？](https://stackoverflow.com/questions/267924/how-does-the-mvc-pattern-differ-if-at-all-from-the-dal-bll-design-pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:09:41.120

我已经开始了一个 ASP.Net MVC 项目。在我的架构中，层几乎和你的一样。

有一个实体层对应于您的数据访问层和业务层作为一个单独的项目，以便轻松插入对应于您的业务层的另一个项目。在 MVC 应用程序的模态部分中有模态层访问器。

[这](http://quickstarts.asp.net/previews/mvc/mvc_Overview.htm)是来自 Asp.Net Mvc 文档的参考，它提供了一些关于应用程序结构的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T00:11:52.777

如果您不想费心从头开始创建架构，您应该考虑使用[Neos-SDI MVC4 模板](http://www.mvctemplate.com)，这将是一个非常好的开始。它是 Visual Studio 2010 和 2012 的模板，该网站将帮助您安装和使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T05:02:50.950

检查[Nido 框架](https://nidoframework.codeplex.com/)

Nido 是在 .NET 框架 4.0、实体框架 6.0 和一些其他附加库上编写的代码框架（一个通用项目，架构模式），以鼓励您（我们开发人员）开发我们遵循良好架构原则的系统。

链接：[https ://nidoframework.codeplex.com/](https://nidoframework.codeplex.com/)

# struts - Struts html html:text 不关闭输入 type="text" 标签

> ID：446376
> 
> 赞同：3
> 
> 时间：2009-01-15T11:06:13.500
> 
> 标签：struts, struts-html

我使用 struts-html 生成表单字段。

例如：

```
<%@ taglib prefix="html" uri="/WEB-INF/taglibs/struts-html.tld" %>

<html:text property="email" styleId="email" size="44"/> 
```

生成：

```
<input type="text" name="email" size="44" value="" id="email"> 
```

如上所示，生成的输入标签没有关闭。这会导致我的 html 无效。

struts-html.tld 包括：

```
<tlibversion>1.2</tlibversion>
<jspversion>1.1</jspversion>
<shortname>html</shortname>
<uri>http://struts.apache.org/tags-html</uri> 
```

有谁知道为什么生成的输入没有关闭？有更新的版本吗？在哪里可以下载？

我尝试使用：

```
<html:html xhtml="true"> 
```

呈现为：

```
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"> 
```

但是，我的输入标签一直呈现未关闭状态。

* * *

解决方案：

使用标签：

```
<html:xhtml/> 
```

**注意：**如果您像我一样使用 Tiles，请直接在包含的 jsp 中使用它。它不是从您的基本模板文件继承的。

**注意：**在 xhtml 模式下，您不能在 html:form 标签内使用 sytleId。这不是问题，因为 id 属性是自动生成的以存储您的 bean 的名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T11:18:43.583

你不能只用[`<html:xhtml/>`](http://struts.apache.org/1.x/struts-taglib/tlddoc/html/xhtml.html)吗？

> 在页面中使用这个标签告诉所有其他 html taglib 标签将自己呈现为 XHTML 1.0

或者，您可以使用`<html:html xhtml="true">`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T11:10:35.817

`input`标签不必在 HTML 中关闭，所以我猜 Struts 不知道您正在尝试生成 XHTML。可悲的是，我的 Struts-fu 太古老了，我不知道如何修复它。也许你应该回到 HTML 而不是 XHTML；XHTML 只有在您使用其他名称空间（例如 SVG 或 MathML）时才会真正发挥作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T11:18:43.757

必须有一个支持 Java 代码来执行实际的生成。获取库的源代码，因为它已经开源，并检查代码在附加结束标记括号“>”时是否参考了一些参数。如果它根本不这样做，您可以修改库，使用补丁版本并贡献补丁。

# delphi - Delphi 2009 COM/ActiveX 类型库支持稳定性

> ID：446379
> 
> 赞同：9
> 
> 时间：2009-01-15T11:06:58.630
> 
> 标签：delphi, com, activex, delphi-2009, typelib

提到[TLB和维护问题](https://stackoverflow.com/questions/16897/delphi-and-com-tlb-and-maintenance-issues)...

**我对使用Delphi 2009中**[新的 COM/ActiveX 类型库支持](http://chrisbensen.blogspot.com/2008/07/tiburn-sneak-peek-com_23.html)的人们（经常）提出的问题： 实现的稳定性如何？

 **特别是，我感兴趣的是：添加/删除类，更改 GUID，重命名方法/属性，重新排序方法/属性，大型类型库（50 多个类），...

它是像 Delphi 2007（一场噩梦）还是 Delphi 7（相当不错，但有时您必须从 SVN 恢复 TLB 文件）或超稳定（如...呃，....记得任何德尔福版本）？

**编辑：**是的，当然，文本 RIDL 是一个好主意，但我的问题是： TLB 支持
的（新）**实现**是否稳定（尤其是 RIDL 文件与可视化 TLB 编辑器和实现类的同步）我上面描述的任务）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-07T01:42:24.457

好吧，再一次，我有偏见，但我们的内部测试表明，新的解决方案要稳定得多、得多得多。

当然，它的设计初衷。COM/ActiveX 对象的所有“智能”现在都是基于文本的。由于它是基于文本的，它完全在您的控制之下。既然它在你的控制之下，你可以让它做你想做的事。没有更多的黑匣子。这个过程是透明的。至于导入大而多毛的类型库，我们成功地导入了整个 MS Office 类型库和 ActiveX 控件，这些都是相当多毛的。

因此，从我们的角度来看，您的问题的答案是：是的，它非常稳定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T17:38:19.417

我的理解是 RIDL 存储为文本并根据需要进行编译，因此不再需要直接维护 TLB 文件。这是 CodeGear 团队大幅提高稳定性的绝妙举措。

它会处理你的大型类型库吗？很难说，因为我没有任何接近那么大的东西……但我看不出它没有的原因。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-15T11:51:20.163

看看[类型库在德尔福](https://stackoverflow.com/questions/443226/type-libraries-in-delphi)

# c# - 如何在 C#.NET 中替换现有 XML 文件的内容？

> ID：446380
> 
> 赞同：2
> 
> 时间：2009-01-15T11:07:11.877
> 
> 标签：c#, .net, xml, file, locking

当尝试用如下代码段替换 C#.NET 中 XML 文件的内容时：

```
string file = Path.GetTempFileName(); // pretend this is a real file
string tmpFile = Path.GetTempFileName();

using (var writer = XmlWriter.Create(File.Create(tmpFile)))
{
    writer.WriteStartElement("root");
    for (int i = 0; i < 100; i++)
    {
        writer.WriteElementString("test", null, 
            "All work and no play makes Jack a dull boy");
    }
    writer.WriteEndElement();
}

File.Delete(file);
File.Move(tmpFile, file); 
```

...我收到 System.IO.IOException 声称该文件已被另一个进程打开。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T11:15:51.890

由于某种原因，XmlWriter 类显然没有为临时文件处理底层流。将流放在它自己的“使用”子句中可确保正确关闭流。将代码更改为

```
string file = Path.GetTempFileName(); // pretend this is a real file
string tmpFile = Path.GetTempFileName();

using (var stream = File.Create(tmpFile))
using (var writer = XmlWriter.Create(stream))
{
    writer.WriteStartElement("root");
    for (int i = 0; i < 100; i++)
    {
        writer.WriteElementString("test", null, 
            "All work and no play makes Jack a dull boy");
    }
    writer.WriteEndElement();
}                
File.Delete(file);
File.Move(tmpFile,file); 
```

... 使 IOException 消失并按预期工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T15:13:06.420

using 语句可以被链接。稍微修改您的代码：

```
string file = Path.GetTempFileName(); // pretend this is a real file
string tmpFile = Path.GetTempFileName();

using (var stream = File.Create(tmpFile))
using (var writer = XmlWriter.Create(stream))
{
    writer.WriteStartElement("root");
    for (int i = 0; i < 100; i++)
    {
        writer.WriteElementString("test", null, 
            "All work and no play makes Jack a dull boy");
    }
    writer.WriteEndElement();
}                
File.Delete(file);
File.Move(tmpFile,file); 
```

如果您在同一范围内处理多个一次性实体（这种情况并不罕见），这可以避免令人讨厌的深度嵌套。:)

# eclipse - 如何使用 scala 编写 eclipse rcp 应用程序？

> ID：446389
> 
> 赞同：15
> 
> 时间：2009-01-15T11:11:30.510
> 
> 标签：eclipse, scala, eclipse-plugin, osgi, eclipse-rcp

Scala Eclipse 插件页面说： * 支持 Eclipse 插件和 OSGi 开发，包括从 plugin.xml 和清单文件超链接到 Scala 源代码。

这种支持如何运作？没有制作 Scala 插件的向导。我没有找到关于如何在 Eclipse 插件/RCP 应用程序中使用 Scala 的文档。甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T14:59:54.603

对的，这是可能的。事实上，Scala Eclipse 插件本身就是用 Scala 编写的。

我自己从未创建过 Scala RCP 应用程序，但我猜您需要做的是通常使用您选择的向导创建项目。一旦项目在您的工作区中，右键单击并选择“添加 Scala Nature”（或类似的效果）。结果将是一个 Scala 项目，其中包含 RCP 应用程序的所有常规陷阱。完成这些设置步骤后，您应该能够在项目中使用 Java 和 Scala。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-19T11:32:32.040

这是一个老问题；但更新可能对某人有帮助。

我可以说我已经使用 scala 2.8.0 beta 版本成功创建了一个 Scala RCP 应用程序。改进是显着的。我按照[此处](http://lampsvn.epfl.ch/trac/scala/wiki/EclipsePluginsWithScala)描述的步骤进行操作。这比我最初想象的要容易。

为了更好地衡量，然后我将 Java 代码翻译成 Scala ......一次一个文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-03T08:20:39.993

用 Scala 编写的插件代码不能与 RCP 一起使用的原因仅仅是在构建插件 jar 时没有导出 .class 文件。但是您可以使用一种解决方法：使用 Plug-In Manifest Editor 打开 plugin.xml，选择 Runtime 选项卡并为类路径添加一个新条目“bin”。然后在 Build 选项卡上的 Binary Build 树中，选择 bin 文件夹。然后在导出产品时将工作区中编译的类文件导出到插件 jar 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-12T11:11:37.287

本教程应该会有所帮助：

[http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=blog:using_scala_to_create_eclipse_rcp_applications](http://www.coconut-palm-software.com/the_new_visual_editor/doku.php?id=blog:using_scala_to_create_eclipse_rcp_applications)

我试过了，它对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-10T05:35:59.393

Scala Nature 调用 JDT 编译器并使 Java 类可用于 Scala 编译器。我遇到了一个问题，我同时启用了 Scala Nature 和 Java Nature。确保您**没有启用 Java Nature**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T22:35:00.833

将 Scala Nature 添加到插件项目后，不要忘记在插件的依赖项中包含**scala.library**（并更新相应的运行和产品配置）！（另外，如果在添加 Scala Nature 时构建路径中出现了另一个 JRE 系统库，您可以安全地删除它以避免出现 RequiredExecutionEnvironment 警告。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T16:11:07.137

有没有人让它作为一个实际的出口产品工作？我很高兴开发我的 scala 插件，它在 Eclipse 中运行良好，但是当我尝试导出产品时，构建过程失败，说它无法将我的 scala 对象解析为类型。我发现了这个错误报告：

[http://lampsvn.epfl.ch/trac/scala/ticket/1919](http://lampsvn.epfl.ch/trac/scala/ticket/1919)

# c# - 如何使用 C# 检测 IIS 版本？

> ID：446390
> 
> 赞同：37
> 
> 时间：2009-01-15T11:12:32.457
> 
> 标签：c#, iis

如何使用 C# 检测 IIS 版本？

更新：我的意思是来自一个winapp（实际上这个场景是开发一个自定义安装程序，它想要检查已安装的 IIS 的版本以调用适当的 api）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-11-09T09:23:00.307

在这里找到答案：[链接文本](http://forums.iis.net/p/1162404/1923867.aspx#1923867) fileVersion 方法在 Windows 2008 上不起作用，我猜 inetserv exe 在其他地方。

```
public Version GetIisVersion()
{
    using (RegistryKey componentsKey = Registry.LocalMachine.OpenSubKey(@"Software\Microsoft\InetStp", false))
    {
        if (componentsKey != null)
        {
            int majorVersion = (int)componentsKey.GetValue("MajorVersion", -1);
            int minorVersion = (int)componentsKey.GetValue("MinorVersion", -1);

            if (majorVersion != -1 && minorVersion != -1)
            {
                return new Version(majorVersion, minorVersion);
            }
        }

        return new Version(0, 0);
    }
} 
```

我测试了它，它在 Windows XP、7 和 2008 上完美运行

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-15T11:17:47.003

您可以从`SERVER_SOFTWARE`变量中获取此信息。它将返回以下内容：

`Microsoft-IIS/5.0 (Windows 2000)`
`Microsoft-IIS/5.1 (Windows XP)`
`Microsoft-IIS/6.0 (Windows 2003 Server)`

等等

如果您使用的是 ASP.NET，则可以通过以下方式获取此字符串

```
Request.ServerVariables["SERVER_SOFTWARE"]; 
```

编辑：您似乎必须查询注册表才能获取此信息。看看[这个页面](http://www.codeproject.com/KB/cs/iisdetection.aspx)，看看如何。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-15T12:26:53.837

我就是这样做的。

```
FileVersionInfo verinfo = FileVersionInfo.GetVersionInfo(System.Environment.SystemDirectory + @"\inetsrv\inetinfo.exe");

//Tip... look at verinfo.MajorVersion. 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-15T11:20:37.823

你可以在注册表中找到它。

直到 IIS 版本 6，您都可以在此处找到它：

HKLM\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters

从这里的第 7 版开始：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp

主要版本次要版本

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-15T11:27:53.207

使用 System.Web.HttpRequest.ServerVariables("SERVER_SOFTWARE")。返回值是格式名称/版本的字符串。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-08-04T15:28:40.560

在 .NET 4.5 中

```
HttpRuntime.IISVersion 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-15T11:23:10.017

据我所知，它通常出现在响应的 http 标头中。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-04-08T08:32:38.290

您可以使用以下代码

```
public static bool IisInstalled()
        {
            try
            {
                using (RegistryKey iisKey = Registry.LocalMachine.OpenSubKey(@"Software\Microsoft\InetStp"))
                {
                    return (int)iisKey.GetValue("MajorVersion") >= 6;
                }
            }
            catch
            {
                return false;
            }
        } 
```

更多信息请访问：[http ://www.java2s.com/Code/CSharp/Windows/IIShelperisIISInstalledIISstateIISversion.htm](http://www.java2s.com/Code/CSharp/Windows/IIShelperisIISInstalledIISstateIISversion.htm)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-12-22T02:59:36.437

对于具有自定义操作的安装程序：在自定义操作视图中，您可以通过自定义操作属性中的“CustomActionData”属性将数据传递给客户安装程序类，如下所示：/iisv="[IISVERSION]"

查看：

[http://johnbarshinger.wordpress.com/2006/10/27/how-to-modify-the-vs2005-installer-to-set-the-asp-net-version-and-create-application-pools/](http://johnbarshinger.wordpress.com/2006/10/27/how-to-modify-the-vs2005-installer-to-set-the-asp-net-version-and-create-application-pools/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-18T08:30:26.300

我只想检查操作系统的版本：xp 有 IIS 5.1，Server 2003 有 IIS 6，vista/Server 2008 有 IIS 7。

[这是检查操作系统版本的方法](https://stackoverflow.com/questions/545666/how-to-translate-ms-windows-os-version-numbers-into-product-names-in-net)。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-01-15T11:22:49.723

检查 X-Powered-By 标头： [http ://www.http-stats.com/X-Powered-By](http://www.http-stats.com/X-Powered-By)

在那里你可以找到可能的值......

# c# - System.Net.Mail.MailMessage 原始内容/垃圾邮件刺客

> ID：446393
> 
> 赞同：4
> 
> 时间：2009-01-15T11:14:25.730
> 
> 标签：c#, .net, email, email-spam

我想要做的是将外发电子邮件的原始内容传递给 spamassassin 以计算垃圾邮件分数。我被困在如何获取电子邮件的原始内容上。

我的 C# 代码目前只是构造 MailMessage 并将其传递给 SmtpClient 的 Send() 方法。在发送之前，有没有办法获取邮件消息的原始版本（正如协议可能看到的那样），以便我可以将其传递给 spamassassin 工具进行垃圾邮件评估？

如果我没有很好地解释，请告诉我，我会尽力解释得更好。

提前致谢，

马丁。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T12:28:11.463

我已经为我的问题制定了解决方案。

SmtpClient 类有两个可以设置的属性，它们会导致电子邮件存储到 EML 文件而不是实际发送。这样做的最初目的是使电子邮件可以使用 SmtpClient 生成，但实际上是由另一个 SMTP 服务器接收和发送的。

```
SmtpClient.DeliveryMethod
SmtpClient.PickupDirectoryLocation 
```

如果 SmtpClient.DeliveryMethod 设置为 SmtpDeliveryMethod.SpecifiedPickupDirectory 并且 SmtpClient.PickupDirectoryLocation 设置为机器上某个目录的完整路径，则调用 SmtpClient.Send(mailMessage); 导致它被保存。

反过来，新创建的 EML 文件可以直接在命令行上传递给 spamassassin 以获得我需要的垃圾邮件分数。

希望此信息可以帮助其他人解决此问题。

亲切的问候，

马丁。

# .net - .NET 资源层次结构与文化无关

> ID：446396
> 
> 赞同：3
> 
> 时间：2009-01-15T11:16:10.343
> 
> 标签：.net, resources, customization

我有一些字符串资源，例如用户欢迎字符串。默认情况下它应该是“Hello”，但对于客户 X，它应该是“Greetings”。

我想使用[.NET 的资源实现](http://msdn.microsoft.com/en-us/library/f45fce5x.aspx)，并将字符串放在常量或文件中或我喜欢的任何地方，再加上层次模型符合我的需要：客户 X 的资源覆盖用户欢迎字符串。

唯一的问题——.NET 的资源似乎是面向 i18n 的，它们根据当前文化从层次结构中进行选择。

现在，我将为每个客户保留平面资源并自己映射层次结构，但有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T13:01:04.050

确实没有什么可以阻止您拥有多个 ResourceManager，但正如您所说，它是为 l18n 设计的。就我个人而言，我在 resx 方面遇到了很多麻烦，尤其是在 GAC 和部署的卫星组件方面。我遇到的另一个问题是这个系统的僵化，如果你需要一个新的字符串，你需要重新编译一个 dll 并使用 xml 乱七八糟，你的客户在修复东西方面没有灵活性，这确实会占用支持时间。

resx 的基于层次结构的解决方案意味着它将从“en-US”回退到“en”，最后回到不变，你没有比这更多的回退，你不能定义两个不同的“en-US”同一字符串的一个资源文件。您可以破解此解决方案，对客户 X 使用“en-US”，对客户 Y 使用“en-AU”，然后作为一种资源发货，但这太麻烦了。

您可以为每个客户编译不同的附属程序集，并以某种方式使其工作。

就个人而言，我更喜欢使用 sqlite 或 mssql 进行本地化的数据库支持解决方案，并确保在初始字符串查找后执行一些缓存。

# jquery - jQuery 是否对方法链接采取了向后的方法？

> ID：446399
> 
> 赞同：2
> 
> 时间：2009-01-15T11:17:23.617
> 
> 标签：jquery, method-chaining

只有我发现以下代码本质上是向后的吗？

我使用[这篇文章](http://blog.pengoworks.com/index.cfm/2007/10/26/jQuery-Understanding-the-chain)作为参考。

```
// create the inner div
var $inner = $("<div>inner</div>")

   // append it to a new outer div
   .appendTo("<div>outer</div>")

   // next change the jQuery chain to the "outer" div 
   .parent()

      // append the outer div to the body
      .appendTo("body")

   // finally, go back to the last destructive command, 
   // giving us back a pointer to the "inner" div
   .end(); 
```

我最初的方法是抓住**body**，然后将**外部**附加到主体，然后将**内部**附加到外部。

向后接近它，然后用类似的东西在层次结构中跳跃，这`parent ()`让我有点好奇......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T11:24:49.017

你也可以用另一种方式来做：

```
$('body').append('<div>outer</div>').append('<div>inner<div>'); 
```

但这会让你`body`

最终`inner`你需要：

```
$('body').append('<div>outer</div>').append('<div>inner<div>')
.find('div:contains(inner)'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T11:21:13.563

jQuery 的特点是，你可以用它做你喜欢的事。如果该特定样式不适合您，则不必使用它。

我发现方法链接在很多情况下都有帮助，但是在您提出的特定情况下，我会做一些不同的事情-我同意这不是很清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T11:20:44.563

并非如此，这完全取决于您之后希望链接的内容，使用 appendTo 可以让您访问新元素而不是附加到的元素。

# ios - 根据文本调整 UILabel 高度

> ID：446405
> 
> 赞同：322
> 
> 时间：2009-01-15T11:19:13.507
> 
> 标签：ios, cocoa-touch, uikit, uilabel

考虑我在`UILabel`（一长行动态文本）中有以下文本：

> 由于外星军队的数量远远超过团队，玩家必须利用世界末日后的世界来发挥自己的优势，例如在垃圾箱、柱子、汽车、瓦砾和其他物体后面寻找掩护。

我想调整`UILabel's`高度以使文本适合。我正在使用以下属性`UILabel`来使文本在其中换行。

```
myUILabel.lineBreakMode = UILineBreakModeWordWrap;
myUILabel.numberOfLines = 0; 
```

如果我没有朝着正确的方向前进，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：415
> 
> 时间：2009-01-15T15:01:19.127

`sizeWithFont constrainedToSize:lineBreakMode:`是使用的方法。如何使用它的示例如下：

```
//Calculate the expected size based on the font and linebreak mode of your label
// FLT_MAX here simply means no constraint in height
CGSize maximumLabelSize = CGSizeMake(296, FLT_MAX);

CGSize expectedLabelSize = [yourString sizeWithFont:yourLabel.font constrainedToSize:maximumLabelSize lineBreakMode:yourLabel.lineBreakMode];   

//adjust the label the the new height.
CGRect newFrame = yourLabel.frame;
newFrame.size.height = expectedLabelSize.height;
yourLabel.frame = newFrame; 
```

* * *

## 回答 #2

> 赞同：247
> 
> 时间：2009-08-20T04:45:20.967

你正朝着正确的方向前进。您需要做的就是：

```
myUILabel.numberOfLines = 0;
myUILabel.text = @"Enter large amount of text here";
[myUILabel sizeToFit]; 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2013-11-04T21:14:05.210

在 iOS 6 中，Apple 向**UILabel**添加了一个属性，该属性极大地简化了标签的动态垂直调整大小：**preferredMaxLayoutWidth**。

将此属性与*lineBreakMode = NSLineBreakByWordWrapping*和*sizeToFit*方法结合使用，可以轻松地将 UILabel 实例的大小调整为可容纳整个文本的高度。

来自 iOS 文档的引用：

> **preferredMaxLayoutWidth** 多行标签的首选最大宽度（以磅为单位）。
> 
> **讨论** 当对标签应用布局约束时，此属性会影响标签的大小。在布局期间，如果文本超出此属性指定的宽度，则附加文本将流动到一个或多个新行，从而增加标签的高度。

一个样品：

```
...
UILabel *status = [[UILabel alloc] init];
status.lineBreakMode = NSLineBreakByWordWrapping;
status.numberOfLines = 5; // limits to 5 lines; use 0 for unlimited.

[self addSubview:status]; // self here is the parent view

status.preferredMaxLayoutWidth = self.frame.size.width; // assumes the parent view has its frame already set.

status.text = @"Some quite lengthy message may go here…&quot;;
[status sizeToFit];
[status setNeedsDisplay];
... 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2016-04-26T10:52:51.350

在不添加单行代码的情况下完美地检查这项工作。（使用自动布局）

我根据您的要求为您制作了一个**演示。**从下面的链接下载它，

[自动调整 UIView 和 UILabel](https://github.com/badalpub1991/AutolayoutForUILabel)

**分步指南：-**

**第 1 步：-**将约束设置为 UIView

1) 领先 2) 前 3) 尾随（来自主视图）

[![在此处输入图像描述](https://i.stack.imgur.com/M6Ck5.gif)](https://i.stack.imgur.com/M6Ck5.gif)

**第 2 步：-**将约束设置为标签 1

1）领先 2）前 3）尾随（来自它的超级视图）

[![在此处输入图像描述](https://i.stack.imgur.com/FeBFW.gif)](https://i.stack.imgur.com/FeBFW.gif)

**第 3 步：-**将约束设置为标签 2

1）领先 2）尾随（来自它的超级视图）

[![在此处输入图像描述](https://i.stack.imgur.com/GLCVp.gif)](https://i.stack.imgur.com/GLCVp.gif)

**第 4 步：-** **最棘手**的是从 UIView 给 UILabel 按钮。

[![在此处输入图像描述](https://i.stack.imgur.com/WcjmM.gif)](https://i.stack.imgur.com/WcjmM.gif)

**第 5 步**：-（可选）将约束设置为 UIButton

1) 领先 2) 底部 3) 尾随 4) 固定高度（从主视图）

[![在此处输入图像描述](https://i.stack.imgur.com/CYwZG.gif)](https://i.stack.imgur.com/CYwZG.gif)

**输出 ：-**

[![在此处输入图像描述](https://i.stack.imgur.com/zaM0A.gif)](https://i.stack.imgur.com/zaM0A.gif)

**注意：-**确保您在标签属性中设置了行数 =0。

[![在此处输入图像描述](https://i.stack.imgur.com/g3w1L.png)](https://i.stack.imgur.com/g3w1L.png)

我希望这些信息足以理解 Autoresize UIView 根据 UILabel 的高度和 Autoresize UILabel 根据文本。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2015-06-18T19:08:10.583

而不是以编程方式执行此操作，您可以在设计时在 Storyboard/XIB 中执行此操作。

*   在属性检查器中将 UIlabel 的**行数**属性设置为**0 。**
*   然后根据要求设置宽度约束/（或）前导和尾随约束。
*   然后用**最小值****设置高度约束**。最后选择您添加的高度约束，然后在属性检查器旁边的尺寸检查器中，**将**高度约束的**关系**从**等于 - 更改为**-**大于**。

 ******* * *

## 回答 #6

> 赞同：15
> 
> 时间：2010-11-23T17:20:47.997

谢谢大家的帮助，这是我尝试过的代码，它对我有用

```
 UILabel *instructions = [[UILabel alloc]initWithFrame:CGRectMake(10, 225, 300, 180)];
   NSString *text = @"First take clear picture and then try to zoom in to fit the ";
   instructions.text = text;
   instructions.textAlignment = UITextAlignmentCenter;
   instructions.lineBreakMode = NSLineBreakByWordWrapping;
   [instructions setTextColor:[UIColor grayColor]];

   CGSize expectedLabelSize = [text sizeWithFont:instructions.font 
                                constrainedToSize:instructions.frame.size
                                    lineBreakMode:UILineBreakModeWordWrap];

    CGRect newFrame = instructions.frame;
    newFrame.size.height = expectedLabelSize.height;
    instructions.frame = newFrame;
    instructions.numberOfLines = 0;
    [instructions sizeToFit];
    [self addSubview:instructions]; 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2014-02-24T10:16:11.973

**iOS7之前和iOS7以上的解决方案**

```
//
//  UILabel+DynamicHeight.m
//  For StackOverFlow
//
//  Created by Vijay on 24/02/14.
//  Copyright (c) 2014 http://Vijay-Apple-Dev.blogspot.com. All rights reserved.
//

#import <UIKit/UIKit.h>

#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v)  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)

#define SYSTEM_VERSION_LESS_THAN(v)                 ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedAscending)

#define iOS7_0 @"7.0"

@interface UILabel (DynamicHeight)

/*====================================================================*/

/* Calculate the size,bounds,frame of the Multi line Label */

/*====================================================================*/
/**
 *  Returns the size of the Label
 *
 *  @param aLabel To be used to calculte the height
 *
 *  @return size of the Label
 */

-(CGSize)sizeOfMultiLineLabel;

@end

//
//  UILabel+DynamicHeight.m
//  For StackOverFlow
//
//  Created by Vijay on 24/02/14.
//  Copyright (c) 2014 http://Vijay-Apple-Dev.blogspot.com. All rights reserved.
//

#import "UILabel+DynamicHeight.h"

@implementation UILabel (DynamicHeight)
/*====================================================================*/

/* Calculate the size,bounds,frame of the Multi line Label */

/*====================================================================*/
/**
 *  Returns the size of the Label
 *
 *  @param aLabel To be used to calculte the height
 *
 *  @return size of the Label
 */
-(CGSize)sizeOfMultiLineLabel{

    NSAssert(self, @"UILabel was nil");

    //Label text
    NSString *aLabelTextString = [self text];

    //Label font
    UIFont *aLabelFont = [self font];

    //Width of the Label
    CGFloat aLabelSizeWidth = self.frame.size.width;

    if (SYSTEM_VERSION_LESS_THAN(iOS7_0)) {
        //version < 7.0

        return [aLabelTextString sizeWithFont:aLabelFont
                            constrainedToSize:CGSizeMake(aLabelSizeWidth, MAXFLOAT)
                                lineBreakMode:NSLineBreakByWordWrapping];
    }
    else if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(iOS7_0)) {
        //version >= 7.0

        //Return the calculated size of the Label
        return [aLabelTextString boundingRectWithSize:CGSizeMake(aLabelSizeWidth, MAXFLOAT)
                                              options:NSStringDrawingUsesLineFragmentOrigin
                                           attributes:@{
                                                        NSFontAttributeName : aLabelFont
                                                        }
                                              context:nil].size;

    }

    return [self bounds].size;

}

@end 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-11-13T23:40:58.467

由于 sizeWithFont 已被弃用，我改用这个。

这个获得标签特定属性。

```
-(CGFloat)heightForLabel:(UILabel *)label withText:(NSString *)text{

    NSAttributedString *attributedText = [[NSAttributedString alloc] initWithString:text attributes:@{NSFontAttributeName:label.font}];
    CGRect rect = [attributedText boundingRectWithSize:(CGSize){label.frame.size.width, CGFLOAT_MAX}
                                           options:NSStringDrawingUsesLineFragmentOrigin
                                           context:nil];

    return ceil(rect.size.height);
} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2017-10-31T13:00:43.237

基于[此答案](https://stackoverflow.com/a/26920543/3659227)的**Swift 4 及更高版本的 UILabel 扩展**

```
extension UILabel {

    func retrieveTextHeight () -> CGFloat {
        let attributedText = NSAttributedString(string: self.text!, attributes: [NSFontAttributeName:self.font])

        let rect = attributedText.boundingRect(with: CGSize(width: self.frame.size.width, height: CGFloat.greatestFiniteMagnitude), options: .usesLineFragmentOrigin, context: nil)

        return ceil(rect.size.height)
    }

} 
```

可以像这样使用：

```
self.labelHeightConstraint.constant = self.label.retrieveTextHeight() 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-01-15T14:10:57.480

您可以`TableViewController's` `(UITableViewCell *)tableView:cellForRowAtIndexPath` 通过以下方式实现方法（例如）：

```
#define CELL_LABEL_TAG 1

- (UITableViewCell *)tableView:(UITableView *)tableView  cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSString *text = @"my long text";

    static NSString *MyIdentifier = @"MyIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero  reuseIdentifier:identifier] autorelease];
    }

    CGFloat width = [UIScreen mainScreen].bounds.size.width - 50;
    CGFloat height = [self textHeight:text] + 10;
    CGRect frame = CGRectMake(10.0f, 10.0f, width, height);

    UILabel *cellLabel = [[UILabel alloc] initWithFrame:frame];
    cellLabel.tag = CELL_LABEL_TAG;
    cellLabel.textColor = [UIColor blackColor];
    cellLabel.backgroundColor = [UIColor clearColor];
    cellLabel.textAlignment = UITextAlignmentLeft;
    cellLabel.font = [UIFont systemFontOfSize:12.0f];
    [cell.contentView addSubview:cellLabel];
    [cellLabel release];

    return cell;
}

UILabel *label = (UILabel *)[cell viewWithTag:CELL_LABEL_TAG];
label.text = text;
label.numberOfLines = 0;
[label sizeToFit];
return cell; 
```

还可以使用`NSString`'`sizeWithFont:constrainedToSize:lineBreakMode:`方法来计算文本的高度。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-04-10T17:58:02.327

这是一个类别版本：

**UILabel+AutoSize.h** #import

```
@interface UILabel (AutoSize)

- (void) autosizeForWidth: (int) width;

@end 
```

**UILabel+AutoSize.m**

```
#import "UILabel+AutoSize.h"

@implementation UILabel (AutoSize)

- (void) autosizeForWidth: (int) width {
    self.lineBreakMode = UILineBreakModeWordWrap;
    self.numberOfLines = 0;
    CGSize maximumLabelSize = CGSizeMake(width, FLT_MAX);
    CGSize expectedLabelSize = [self.text sizeWithFont:self.font constrainedToSize:maximumLabelSize lineBreakMode:self.lineBreakMode];
    CGRect newFrame = self.frame;
    newFrame.size.height = expectedLabelSize.height;
    self.frame = newFrame;
}

@end 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-07-19T06:02:18.130

我计算 UILabel 动态高度的方法。

```
 let width = ... //< width of this label 
    let text = ... //< display content

    label.numberOfLines = 0
    label.lineBreakMode = .byWordWrapping
    label.preferredMaxLayoutWidth = width

    // Font of this label.
    //label.font = UIFont.systemFont(ofSize: 17.0)
    // Compute intrinsicContentSize based on font, and preferredMaxLayoutWidth
    label.invalidateIntrinsicContentSize() 
    // Destination height
    let height = label.intrinsicContentSize.height 
```

包装到功能：

```
func computeHeight(text: String, width: CGFloat) -> CGFloat {
    // A dummy label in order to compute dynamic height.
    let label = UILabel()

    label.numberOfLines = 0
    label.lineBreakMode = .byWordWrapping
    label.font = UIFont.systemFont(ofSize: 17.0)

    label.preferredMaxLayoutWidth = width
    label.text = text
    label.invalidateIntrinsicContentSize()

    let height = label.intrinsicContentSize.height
    return height
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-08-27T09:18:37.053

对于那些正在迁移到 iOS 8 的用户，这里是 Swift 的类扩展：

```
extension UILabel {

    func autoresize() {
        if let textNSString: NSString = self.text {
            let rect = textNSString.boundingRectWithSize(CGSizeMake(self.frame.size.width, CGFloat.max),
                options: NSStringDrawingOptions.UsesLineFragmentOrigin,
                attributes: [NSFontAttributeName: self.font],
                context: nil)
            self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, rect.height)
        }
    }

} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-05-16T16:43:07.110

对我有用的最简单和更好的方法是将高度约束应用于标签并将**优先级设置为 low**，即故事板中的 (250) 。

因此，借助故事板，您无需担心以编程方式计算高度和宽度。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-07-06T12:21:58.313

更新方法

```
+ (CGFloat)heightForText:(NSString*)text font:(UIFont*)font withinWidth:(CGFloat)width {

    CGSize constraint = CGSizeMake(width, 20000.0f);
    CGSize size;

    CGSize boundingBox = [text boundingRectWithSize:constraint
                                                  options:NSStringDrawingUsesLineFragmentOrigin
                                               attributes:@{NSFontAttributeName:font}
                                                  context:nil].size;

    size = CGSizeMake(ceil(boundingBox.width), ceil(boundingBox.height));

    return size.height;
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-03-07T13:22:03.800

这是使用 Objective-c 获取 UILabel 高度的一行代码：

```
labelObj.numberOfLines = 0;
CGSize neededSize = [labelObj sizeThatFits:CGSizeMake(screenWidth, CGFLOAT_MAX)]; 
```

并使用 .height 您将获得标签的高度，如下所示：

```
neededSize.height 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2018-04-12T10:43:07.160

您可以使用以下代码获取高度

你必须通过

1.  文字 2\. 字体 3\. 标签宽度

    ```
    func heightForLabel(text: String, font: UIFont, width: CGFloat) -> CGFloat {

       let label:UILabel = UILabel(frame: CGRect(x: 0, y: 0, width: width, height: CGFloat.greatestFiniteMagnitude))
       label.numberOfLines = 0
       label.lineBreakMode = NSLineBreakMode.byWordWrapping
       label.font = font
       label.text = text
       label.sizeToFit()

       return label.frame.height
    } 
    ```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-20T22:54:43.137

感谢这篇文章。这对我帮助很大。就我而言，我还在单独的视图控制器中编辑文本。我注意到当我使用时：

```
[cell.contentView addSubview:cellLabel]; 
```

在 tableView:cellForRowAtIndexPath: 方法中，每次我编辑单元格时，标签视图都会不断地呈现在前一个视图的顶部。文本变得像素化，当某些内容被删除或更改时，旧版本在新版本下可见。这是我解决问题的方法：

```
if ([[cell.contentView subviews] count] > 0) {
    UIView *test = [[cell.contentView subviews] objectAtIndex:0];
    [test removeFromSuperview];
}
[cell.contentView insertSubview:cellLabel atIndex:0]; 
```

不再有奇怪的分层。如果有更好的方法来处理这个问题，请告诉我。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-06-27T12:02:20.673

```
UILabel *itemTitle = [[UILabel alloc] initWithFrame:CGRectMake(10.0f, 10,100, 200.0f)];
itemTitle.text = @"aseruy56uiytitfesh";
itemTitle.adjustsFontSizeToFitWidth = NO;
itemTitle.autoresizingMask = UIViewAutoresizingFlexibleWidth;
itemTitle.font = [UIFont boldSystemFontOfSize:18.0];
itemTitle.textColor = [UIColor blackColor];
itemTitle.shadowColor = [UIColor whiteColor];
itemTitle.shadowOffset = CGSizeMake(0, 1);
itemTitle.backgroundColor = [UIColor blueColor];
itemTitle.lineBreakMode = UILineBreakModeWordWrap;
itemTitle.numberOfLines = 0;
[itemTitle sizeToFit];
[self.view addSubview:itemTitle]; 
```

在这里使用它所有属性都在标签上使用，并通过增加 itemTitle.text 中的文本来测试它

```
itemTitle.text = @"diofgorigjveghnhkvjteinughntivugenvitugnvkejrfgnvkhv"; 
```

它会根据您的需要显示完美的答案

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-01-20T12:19:57.467

您也可以将其用作一种方法。@Pyjamasam 非常正确，所以我只是在制作它的方法。可能对其他人有帮助

```
-(CGRect)setDynamicHeightForLabel:(UILabel*)_lbl andMaxWidth:(float)_width{
    CGSize maximumLabelSize = CGSizeMake(_width, FLT_MAX);

    CGSize expectedLabelSize = [_lbl.text sizeWithFont:_lbl.font constrainedToSize:maximumLabelSize lineBreakMode:_lbl.lineBreakMode];

    //adjust the label the the new height.
    CGRect newFrame = _lbl.frame;
    newFrame.size.height = expectedLabelSize.height;
    return newFrame;
} 
```

就这样设置

```
label.frame = [self setDynamicHeightForLabel:label andMaxWidth:300.0]; 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-03-01T13:27:36.450

要在 Swift3 中执行此操作，请使用以下代码：

```
 let labelSizeWithFixedWith = CGSize(width: 300, height: CGFloat.greatestFiniteMagnitude)
            let exactLabelsize = self.label.sizeThatFits(labelSizeWithFixedWith)
            self.label.frame = CGRect(origin: CGPoint(x: 20, y: 20), size: exactLabelsize) 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2017-10-18T22:10:53.950

添加到上述答案：

*这可以通过故事板轻松实现。*

1.  为 UILabel 设置约束。（在我的情况下，我做了顶部、左侧和固定宽度）
2.  在属性检查器中将行数设置**为 0**
3.  在属性检查器中将换行符设置**为 WordWrap 。**

[![UIL标签高度调整](https://i.stack.imgur.com/NZkmJ.png)](https://i.stack.imgur.com/NZkmJ.png)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-16T07:25:17.907

最后，它奏效了。谢谢你们。

我没有让它工作，因为我试图在`heightForRowAtIndexPath`方法中调整标签的大小：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

并且（是的，我很傻），我正在将标签的大小调整为`cellForRowAtIndexPath`方法中的默认值 - 我忽略了我之前编写的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-05-21T06:31:44.597

一行是克里斯的答案是错误的。

```
newFrame.size.height = maximumLabelSize.height; 
```

应该

```
newFrame.size.height = expectedLabelSize.height; 
```

除此之外，这是正确的解决方案。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2012-08-29T07:29:26.613

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    cellIdentifier = @"myCell";
    cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    cell.myUILabel.lineBreakMode = UILineBreakModeWordWrap;        
    cell.myUILabel.numberOfLines = 0;
    cell.myUILabel.text = @"Some very very very very long text....."
    [cell.myUILabel.criterionDescriptionLabel sizeToFit];    
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [self tableView:tableView cellForRowAtIndexPath:indexPath];
    CGFloat rowHeight = cell.myUILabel.frame.size.height + 10;

    return rowHeight;    
} 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-04-29T07:13:24.120

```
NSString *str = @"Please enter your text......";
CGSize lblSize = [str sizeWithFont:[UIFont systemFontOfSize:15] constrainedToSize: CGSizeMake(200.0f, 600.0f) lineBreakMode: NSLineBreakByWordWrapping];

UILabel *label = [[UILabel alloc]init];
label.frame = CGRectMake(60, 20, 200, lblSize.height);
label.numberOfLines = 0;
label.lineBreakMode = NSLineBreakByWordWrapping;
label.font = [UIFont systemFontOfSize:15];
label.text = str;
label.backgroundColor = [UIColor clearColor];
[label sizeToFit];
[self.view addSubview:label]; 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-06-08T06:51:08.397

我的代码：

```
UILabel *label      = [[UILabel alloc] init];
label.numberOfLines = 0;
label.lineBreakMode = NSLineBreakByWordWrapping;
label.text          = text;
label.textAlignment = NSTextAlignmentCenter;
label.font          = [UIFont fontWithName:_bodyTextFontFamily size:_bodyFontSize];

CGSize size = [label sizeThatFits:CGSizeMake(width, MAXFLOAT)];

float height        = size.height;
label.frame         = CGRectMake(x, y, width, height); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2015-11-26T18:51:14.560

**斯威夫特 2：**

```
 yourLabel.text = "your very long text"
    yourLabel.numberOfLines = 0
    yourLabel.lineBreakMode = NSLineBreakMode.ByWordWrapping
    yourLabel.frame.size.width = 200
    yourLabel.frame.size.height = CGFloat(MAXFLOAT)
    yourLabel.sizeToFit() 
```

有趣的行`sizeToFit()`与将 a 设置`frame.size.height`为最大浮点数相结合，这将为长文本留出空间，但`sizeToFit()`会强制它只使用必要的，但**总是**在设置`.frame.size.height`.

我建议设置 a`.backgroundColor`用于调试目的，这样您就可以看到每种情况下渲染的帧。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-04-07T14:00:14.197

这种方法将给出完美的高度

```
-(float) getHeightForText:(NSString*) text withFont:(UIFont*) font andWidth:(float) width{
CGSize constraint = CGSizeMake(width , 20000.0f);
CGSize title_size;
float totalHeight;

title_size = [text boundingRectWithSize:constraint
                                options:NSStringDrawingUsesLineFragmentOrigin
                             attributes:@{ NSFontAttributeName : font }
                                context:nil].size;

totalHeight = ceil(title_size.height);

CGFloat height = MAX(totalHeight, 40.0f);
return height;
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2017-01-21T09:07:58.400

```
myLabel.text = "your very long text"
myLabel.numberOfLines = 0
myLabel.lineBreakMode = NSLineBreakMode.ByWordWrapping 
```

请在情节提要中为 UILable 设置约束，包括左上角右下角

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-01-17T14:55:06.537

此方法适用于 iOS 6 和 7

```
- (float)heightForLabelSize:(CGSize)maximumLabelSize  Font:(UIFont *)font String:(NSString*)string {

if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 7) {
    NSDictionary *stringAttributes = [NSDictionary dictionaryWithObject:font forKey: NSFontAttributeName];

    CGSize adjustedLabelSize = [string maximumLabelSize
                                                                  options:NSStringDrawingTruncatesLastVisibleLine|NSStringDrawingUsesLineFragmentOrigin
                                                               attributes:stringAttributes context:nil].size;
    return adjustedLabelSize.height;
}
else {
    CGSize adjustedLabelSize = [string sizeWithFont:font constrainedToSize:maximumLabelSize lineBreakMode:NSLineBreakByWordWrapping];

    return adjustedLabelSize.height;
}

} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-01-28T08:55:15.723

问题是没有一个提到的函数是可实现的，并且对于某些字符串和字体将返回不正确的高度值。特别是属性文本会失败。

唯一可行的解​​决方案在这里：[https](https://stackoverflow.com/a/4214978/699944) : //stackoverflow.com/a/4214978/699944 关键是使用 CoreText 手动计算每行的高度以获得正确的大小。没有其他已知的方法可以做到这一点。

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2013-11-13T07:51:19.247

根据 iOS7 更新

```
// If description are available for protocol
protocolDescriptionLabel.text = [dataDictionary objectForKey:@"description"];
[protocolDescriptionLabel sizeToFit];
[protocolDescriptionLabel setLineBreakMode:NSLineBreakByWordWrapping];

CGSize expectedLabelSize = [protocolDescriptionLabel
               textRectForBounds:protocolDescriptionLabel.frame
               limitedToNumberOfLines:protocolDescriptionLabel.numberOfLines].size;
NSLog(@"expectedLabelSize %f", expectedLabelSize.height);

//adjust the label the the new height.
CGRect newFrame = protocolDescriptionLabel.frame;
newFrame.size.height = expectedLabelSize.height;
protocolDescriptionLabel.frame = newFrame; 
```

* * *

## 回答 #34

> 赞同：-3
> 
> 时间：2013-10-09T02:07:13.093

启用自动布局后，调整大小不起作用:)

# c++ - 远程过程调用

> ID：446411
> 
> 赞同：4
> 
> 时间：2009-01-15T11:22:25.450
> 
> 标签：c++, windows, rpc

有人知道在 Windows（非 .net）环境中进行远程过程调用的好方法吗？

我找不到太多关于如何做到这一点的信息，而且 msdn 只有 .net 版本。

.

编辑：

感谢您到目前为止的答案。我需要的是与同一台计算机上的服务进行通信，该服务会将进度报告发送回“客户端”。我对 rpc 感兴趣的原因是因为 vistas uac 以及服务如何与普通应用程序通信，除非它们使用 rpc 或管道。查看管道，它们似乎完全基于文本，我的印象是 rpc 可以传递强类型值。

我也会研究 DCOM。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T12:53:03.767

如果您只对同一台机器上的进程之间的对话感兴趣，[boost::interprocess](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess.html)是一种很酷的方式，可以让它们通过一个通道进行对话。

更多特定于 Windows 的解决方案是[共享内存映射文件](http://msdn.microsoft.com/en-us/library/aa365574(VS.85).aspx#base.using_a_file_mapping_for_ipc)和系统全局互斥体/信号或[命名管道](http://msdn.microsoft.com/en-us/library/aa365590(VS.85).aspx)。

[boost::serialize](http://www.boost.org/doc/libs/1_37_0/libs/serialization/doc/index.html)和 google[协议缓冲区](http://code.google.com/intl/sv-SE/apis/protocolbuffers/)是将您在进程之间发送的数据转换为二进制字符串的方法，这些字符串较少依赖于结构打包和其他可能在不同可执行文件之间有所不同的东西。

boost::interprocess、boost::serialize 和协议缓冲区应该独立于平台，因此从技术上讲它也可以在 Linux/Mac 上运行！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T12:23:24.077

[DCOM](http://en.wikipedia.org/wiki/Distributed_Component_Object_Model)具有基于 DCE RPC 的远程过程调用机制。如果您将系统构建为 COM 组件或在要公开的 API 上放置 COM 包装器，则可以使用它。除此之外，您可能希望通过更深入地了解问题的细节来扩展您的问题。我真的不知道这个问题是否有任何可能妨碍使用 DCOM 的方面。

另一种方法是在应用程序周围放置一个 Web 服务包装器。Web 服务（当然是基于 SOAP 或 XML-RPC 的）实际上只是一种使用 HTTP 作为传输协议的 RPC 机制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T01:32:19.930

这里有更多信息：
获取“Microsoft Platform SDK for Windows Server 2003 R2”，在文件夹中安装查看示例 ...\Samples\NetDS\RPC
[sdk_NetDS_RPC.exe](http://www.ime.uerj.br/~alexszt/cursos/topesp_inter/trabs/991/g2/arquivos.html) - 源示例 [soapsdk.exe](http://www.microsoft.com/downloads/details.aspx?familyid=c943c0dd-ceec-4088-9753-86f052ec8450&displaylang=en) - MS 示例
更多链接：
[跟踪 RPC调用并通知您的程序的 COM+ 事件](http://www.codeguru.com/cpp/com-tech/complus/general/article.php/c11627__2/)
[FastRpc](http://plan99.net/~mike/fastrpc/)
[安全 rpc](http://social.msdn.microsoft.com/forums/en-US/windowssdk/thread/6b375936-7bdc-41d0-be9d-2e17f19251bc/)
[基于 XML 和 HTTP 的轻量级 RPC 库。](http://xmlrpc-c.sourceforge.net/sample-code.php)
旧帮助，但有用[RPC.HLP](http://download.prow.pwszjar.edu.pl/Delphi7_Personal/Install/Common/Borland%20Shared/MSHelp/)
[[MS-RPCE]：远程过程调用协议扩展](http://msdn.microsoft.com/en-us/library/cc243560(PROT.10).aspx)
[[MS-RPCH]：基于 HTTP 协议规范的远程过程调用](http://msdn.microsoft.com/en-us/library/cc243950(PROT.10).aspx)
[[MS-COM]：Component Object Model Plus (COM+) 协议规范 DCOM](http://msdn.microsoft.com/en-us/library/cc225390(PROT.10).aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T12:24:37.210

您可以通过一百种不同的方式在 Windows 上远程调用代码；套接字、DCom 等......微软在某一阶段支持 rpcgen（基于 DCE RPC），它允许您定义远程 API 调用，它的编译器将编写胶水代码。这是 DCOM 中的底层。

它与更易于使用和更广泛的标准的 UNIX ONC-RPC 不兼容。如果像 DCOM 这样的东西不适合您，您可能想查看[其中一个 ONC_RPC 工具包。](http://www.onc-rpc-xdr.com/products/rpc/rpc-windows-vc-c-delphi.asp)

托尼

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T01:37:54.117

是的，我同意 Isalamon - 只需使用 MIDL 中已经内置的真实 RPC。您可以获得一本关于 DCE RPC 的 O'Reilly 书籍。如果您在同一台机器上，只需使用 ncalrpc 的绑定主机。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T13:26:15.107

[这](http://msdn.microsoft.com/en-us/library/aa378651(VS.85).aspx)是我们 1996 年在 Cheyenne Software 在 Win NT 上用于 InocuLAN 防病毒软件的东西。这是纯 RPC，没有 OO 层。我希望它在较新的 Windows 中仍然可用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T13:50:51.170

好吧，按照复杂性、开销和反向速度排序，我想到了这些可能性：

*   SOAP（你已经排除了）
*   科尔巴
*   DCOM (DCE)
*   XML 消息的交换
*   ONC-RPC (SunRPC)
*   交换类似 HTTP 的消息
*   交换类似 telnet 的消息（面向线路）

总而言之，您将或多或少地准备好使用（准备受挫）库、包等作为开源。

上面的一些内容可能听起来很奇怪，但实际上，我们确实经常使用 HTTP 或 Telnet 进行 RPC。原因是您不需要花哨的环境来测试，任何大多数外来软件都可以轻松适应它。这些也使您的程序的服务可以轻松地从 WebBrowser、telnet 会话或其他只需打开一个套接字并发送请求的程序中使用。例如，我的大多数程序都包含一个 --scripting 命令行参数，它打开一个 telnet 端口，您可以通过该端口通过类似 JavaScript 的语言发送对整个应用程序对象模型的访问。这也可用于非常轻松地远程控制任何应用程序 - 无需任何努力。如果您曾经编写过这样的框架，则可以将其重用于每个新应用程序（请参阅[此处](http://wiki.expecco.de/index.php5/Starting_expecco_via_Command_Line)的外观）

我不得不承认，我所有的应用程序都是在一个环境中编写的，上面所有的内容都已经包含在内并且可以作为客户端和服务器使用。

总结：用最简单的东西，就行了。您不需要 Corba 或 SOAP，除非您的应用程序需要集成到这样的基础架构中。

# c# - 在 C#/.Net 中创建进程外 COM？

> ID：446417
> 
> 赞同：25
> 
> 时间：2009-01-15T11:25:24.943
> 
> 标签：c#, com

我需要在 C# 中创建一个进程外 COM 服务器 (.exe)，该服务器将由同一个框上的多个其他进程访问。该组件必须是单个进程，因为它将在内存中缓存它提供给消费者的信息。

注意：将访问我的 COM 服务器的进程主要是 Matlab 进程，因此**需要**一个 COM 接口。

[我已经看到有关在堆栈溢出（ Create COM ...](https://stackoverflow.com/questions/186640/create-com-component-and-activex-controls-in-net-c-and-net-framework-3-5) ）和网络上在 .Net 中创建进程内 COM 组件的线程，但是我很难找到一种方法来使用 .Net 创建进程外组件.

这是如何实现的？有什么推荐的参考吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T16:46:46.027

许多年前，我们在 regasm 和将 COM 类作为本地 EXE 服务器运行时也遇到了一些问题。

这有点小技巧，我欢迎任何建议让它更优雅。它是在 .NET 1.0 时代为一个项目实现的，从那时起就没有被触及过！

基本上，每次应用程序启动时它都会执行 regasm 样式的注册（在 COM 容器应用程序中实例化 COM 对象之前，它需要运行一次以创建注册表项）。

我从我们的实现中复制了以下重要部分，并重命名了一些类来说明示例。

从 Form Loaded 事件中调用以下方法来注册 COM 类（`MyCOMClass`本例重命名为）

```
private void InitialiseCOM()
    {
        System.Runtime.InteropServices.RegistrationServices services = new System.Runtime.InteropServices.RegistrationServices();
        try
        {
            System.Reflection.Assembly ass = Assembly.GetExecutingAssembly();
            services.RegisterAssembly(ass, System.Runtime.InteropServices.AssemblyRegistrationFlags.SetCodeBase);
            Type t = typeof(MyCOMClass);
            try
            {
                Registry.ClassesRoot.DeleteSubKeyTree("CLSID\\{" + t.GUID.ToString() + "}\\InprocServer32");
            }
            catch(Exception E)
            {
                Log.WriteLine(E.Message);
            }

            System.Guid GUID = t.GUID;
            services.RegisterTypeForComClients(t, ref GUID );
        }
        catch ( Exception e )
        {
            throw new Exception( "Failed to initialise COM Server", e );
        }
    } 
```

对于有问题的类型，`MyCOMObject`, 将需要一些特殊属性才能与 COM 兼容。一个重要的属性是指定一个固定的 GUID，否则每次编译注册表时都会填满孤立的 COM GUID。您可以使用 VisualStudio 中的工具菜单为您创建一个唯一的 GUID。

```
 [GuidAttribute("D26278EA-A7D0-4580-A48F-353D1E455E50"),
  ProgIdAttribute("My PROGID"),
  ComVisible(true),
  Serializable]
  public class MyCOMClass : IAlreadyRegisteredCOMInterface
  {
    public void MyMethod()
    {
    }

    [ComRegisterFunction]
    public static void RegisterFunction(Type t)
    {
      AttributeCollection attributes = TypeDescriptor.GetAttributes(t);
      ProgIdAttribute ProgIdAttr = attributes[typeof(ProgIdAttribute)] as ProgIdAttribute;

      string ProgId = ProgIdAttr != null ? ProgIdAttr.Value : t.FullName;

      GuidAttribute GUIDAttr = attributes[typeof(GuidAttribute)] as GuidAttribute;
      string GUID = "{" + GUIDAttr.Value + "}";

      RegistryKey localServer32 = Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}\\LocalServer32", GUID));
      localServer32.SetValue(null, t.Module.FullyQualifiedName);

      RegistryKey CLSIDProgID = Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}\\ProgId", GUID));
      CLSIDProgID.SetValue(null, ProgId);

      RegistryKey ProgIDCLSID = Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}", ProgId));
      ProgIDCLSID.SetValue(null, GUID);

      //Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}\\Implemented Categories\\{{63D5F432-CFE4-11D1-B2C8-0060083BA1FB}}", GUID));
      //Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}\\Implemented Categories\\{{63D5F430-CFE4-11d1-B2C8-0060083BA1FB}}", GUID));
      //Registry.ClassesRoot.CreateSubKey(String.Format("CLSID\\{0}\\Implemented Categories\\{{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}}", GUID));
    }

    [ComUnregisterFunction]
    public static void UnregisterFunction(Type t)
    {
      AttributeCollection attributes = TypeDescriptor.GetAttributes(t);
      ProgIdAttribute ProgIdAttr = attributes[typeof(ProgIdAttribute)] as ProgIdAttribute;

      string ProgId = ProgIdAttr != null ? ProgIdAttr.Value : t.FullName;

      Registry.ClassesRoot.DeleteSubKeyTree("CLSID\\{" + t.GUID + "}");
      Registry.ClassesRoot.DeleteSubKeyTree("CLSID\\" + ProgId);
    }

  } 
```

`InitialiseCOM`主窗体中的方法`RegistrationServices`用于注册类型。然后，框架使用反射找到标有`ComRegisterFunction`属性的方法，并使用注册的类型调用该函数。

标记的方法，手动为本地 EXE 服务器 COM 对象创建注册表设置，如果您使用并找到有问题的密钥，`ComRegisterFunction`则可以将其与 regasm 进行比较。`REGEDIT`

我已经注释掉了三个`\\Registry.ClassesRoot.CreateSubKey`方法调用，因为这是我们需要自己注册类型的另一个原因，因为这是一个 OPC 服务器，第三方 OPC 客户端使用这些实现的类别来扫描兼容的 OPC 服务器。除非我们自己完成工作，否则 REGASM 不会为我们添加这些内容。

如果在函数开始时在函数上设置断点，您可以轻松地看到它是如何工作的。

我们的实现使用了一个已经向 COM 注册的接口。对于您的应用程序，您将需要：-

1.  扩展上面列出的注册方法，将接口注册到 COM
2.  或者使用接口定义创建一个单独的 DLL，然后将该接口定义导出到类型库并按照您在问题中添加的 StackOverflow 链接中的讨论进行注册。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-09T11:57:31.977

官方答案在知识库文章[如何使用 Visual C++、Visual C# 或 Visual Basic .NET 开发进程外 COM 组件](http://support.microsoft.com/kb/977996)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-15T11:35:17.653

IMO，可以做到这一点的方法之一是根据您在链接中提到的方法创建一个普通的 COM Dll，然后在注册您的 COM dll 后，将其更改为代理 DLL。这可以通过 OLEView 实用程序轻松完成，尽管您也可以通过更改注册表项以及通过[http://msdn.microsoft.com/en-us/library/ms686606(VS.85 ) 中提到的方法手动完成).aspx](http://msdn.microsoft.com/en-us/library/ms686606(VS.85).aspx)。

通过将此作为代理 DLL，它将在自己的 dllhost.exe 中运行，因此将处于进程外。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-10-21T09:49:40.677

[**ActiveX.NET**](https://github.com/avarghesein/ActiveX.NET)是 C#.NET 中真正的 Out-Of-Proc (EXE) COM 服务器实现。[与 Code.MSDN 中发布的原始CSExeCOMServer](https://code.msdn.microsoft.com/windowsapps/CSExeCOMServer-3b1c1054)相比，这个实现更简洁。

**ActiveX.NET**具有使用.NET Message Pump（而不是native）和MEF Plugin模型等特性，使EXE Server解耦，可以在多个COM Plugin之间共享，可以独立开发

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T11:38:57.413

一种选择是[服务组件](http://msdn.microsoft.com/en-us/library/3x7357ez(VS.80).aspx)- 即将它作为 shell exe 托管在 COM+ 中。另请参阅[此处](http://msdn.microsoft.com/en-us/library/ty17dz7h(VS.80).aspx)的操作指南。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-16T20:41:38.047

您可以使用 RegistrationServices.RegisterTypeForComClients，它是 CoRegisterClassObject 的托管等效项 - 有关示例代码，请参见[此处](https://web.archive.org/web/20160704192503/http://www.andymcm.com/blog/2009/10/managed-dcom-server.html)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-27T19:52:18.173

它可以使用 umanaged ATL 框架并使用托管代码来完成（只需将结果项目属性更改为 /clr）。

以下是说明性片段：

```
.H-part:

\#include < vcclr.h >

\#using < MyCSharpModule.dll >

using namespace System;

class ATL_NO_VTABLE MyCSharpProxyServer :
    public CComObjectRootEx< CComMultiThreadModel >,

.....

{

      HRESULT FinalConstruct();

      STDMETHODIMP LoadMyFile(BSTR FileName);
.....
      gcroot<MyCSNamespace::MyCSharpClass^> m_CSClass;

}

.CPP-part:

using namespace System::Collections;

using namespace MyCSNamespace;

HRESULT MyCSharpProxyServer::FinalConstruct()
{

    m_CSClass = gcnew MyCSharpClass();

}

STDMETHODIMP MyCSharpProxyServer::LoadMyFile(BSTR FileName)
{

    try {
       int hr = m_CSClass->LoadFile(gcnew String( FileName));
        return hr;
    }
    catch( Exception^ e )  {
        return E_FAIL;
    }
} 
```

C# 部分（MyCSharpClass 类）位于具有输出类型类库的单独项目中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-01-21T14:14:04.513

您可以在[此处](https://blogs.msdn.microsoft.com/codefx/2010/11/25/all-in-one-com-code-samples/)找到的 Visual Studio 项目“CSExeCOMServer” （All-in-One）给出了一个完整的示例。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-03-18T14:50:25.057

将标志[REGCLS_MULTIPLEUSE](http://msdn.microsoft.com/en-us/library/ms679697%28v=vs.85%29.aspx)与 CoRegisterClassObject() 一起使用以使 coclass 成为多用途类。这里有更多信息： http: [//support.microsoft.com/kb/169321](http://support.microsoft.com/kb/169321)。

# java - Struts 和 AJAX 的问题

> ID：446418
> 
> 赞同：0
> 
> 时间：2009-01-15T11:25:31.870
> 
> 标签：java, ajax, struts

这是我的问题，我正在构建一个模块化应用程序，并且我正在使用 struts-config.xml 中的 SwitchAction 更改为另一个配置文件，问题是当我更改为另一个模块时，然后返回默认配置 xml，我收到一个错误，因为我的页面使用 AJAX 请求从数据库获取一些数据，并且我发现我第一次发送以更改模块的前缀正在返回并返回错误的网址。以下是更好理解的示例：

页面 modulos.vm，访问 new 的链接，new 的链接具有前缀“new”，因此它使用此 URL“/new/new.do”访问“new”模块中的页面，访问 new.vm 没有问题，再次访问 modulos.vm，AJAX 函数应该是“/admin/modulos.do?somedata”，但是返回的 URL 是“/new/admin/modulos.do”，我不知道该怎么办，与e struts 文档“prefix - 控制应该切换到的模块的模块前缀（以“/”开头）。对默认模块使用零长度字符串。适当的 ModuleConfig 对象将存储为请求属性，因此任何后续逻辑都将采用新模块。”

所以有人知道为什么 AJAX 在 URL 中包含“新”吗？或者任何人对如何清除相对路径或可能对我有帮助的东西有任何想法？

差点忘了提我正在使用 JQuery 来调用 AJAX 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T11:31:52.327

您需要使用绝对而不是相对 URL。目前，您的 JavaScript 正在基于当前上下文路径构建相对 URL。

如果你使用 JSP，你可以把它放在你的标题中：

```
<script type="text/javascript">
var CONTEXT_PATH = "<%= request.getContextPath() %>";
</script> 
```

然后当您进行 AJAX 调用时，您需要像这样构建 URL：

```
$.post(CONTEXT_PATH + '/admin/modulos.do'....) 
```

如果我需要将上下文路径导入 JavaScript，这就是我要做的 - 然后只需在需要对服务器进行 AJAX 调用的任何地方使用它。

# c# - 生成的 LINQ 类的动态属性访问

> ID：446422
> 
> 赞同：3
> 
> 时间：2009-01-15T11:28:45.170
> 
> 标签：c#, asp.net-mvc, linq

如何从生成的 LINQ 类中动态访问属性？

因为我希望能够自定义显示的表列，其中 Partner 是从 SQL Server 数据库表生成的 LINQ 类。

```
<table class="grid">
  <thead>
   <tr>
     <% foreach (Column c in (IEnumerable)ViewData["columns"]) { %>
     <th><%= c.Title %></th>    
     <% } %>                               
   </tr>
 </thead>
 <tbody>
 <% foreach (Partner p in (IEnumerable)ViewData.Model) { %>
   <tr>
     <% foreach (Column c in (IEnumerable)ViewData["columns"]) { %>
?????   <th> <%= p.GetProperty(c.Name) %>  </th>  ?????
     <% } %>         
   </tr>       
 <% } %>
  </tbody>
</table> 
```

知道该`p.GetProperty(c.Name)`方法的代码是什么样的吗？

如果问题很简单，请原谅我，但由于我是 C# 和 LINQ 的新手，我真的无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T11:52:48.413

反射应该提供你想要的 - 特别是，

```
typeof(Partner).GetProperty(c.Name).GetValue(p, null) 
```

但是，您可能希望在循环*之前执行此操作：*

```
var columns = (IEnumerable<string>)ViewData["columns"];
var cols = columns.Select(colName =>
      typeof(Partner).GetProperty(colName)).ToList(); 
```

这为您提供了一组可重用的`PropertyInfo`实例，您可以每行使用它们：

```
 foreach (var col in cols) { %>
     <th><%= col.GetValue(p,null) %></th>
 <% } 
```

（顺便说`<th/>`一句，那应该是一个`<td/>`吗？）

这应该比重复查找每个属性更有效。还有[其他方法可以做到这一点](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)（再次更快）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T11:45:08.477

我相信以下将完成您想要的：

```
p.GetType().GetProperty(c.Name).GetValue(p) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T13:07:11.760

反射在这里非常适合，但实际上 - 在编译时一切都是已知的。因此，可以在设计时指定所有内容。

```
public class DataItem
{
  string Title {get;set;}
  object Value {get;set;}
}

public interface IDataItems
{
  IEnumerable<DataItem> Items()
}

//suppose LINQ gives you this:
public partial class Customer
{
  public string Name {get;set;}
  public string Address {get;set;}
  public int Age {get;set;}
}

//then you add this in another file.
//if there's a lot of this, it can be code genned by design-time reflection
public partial class Customer : IDataItems
{
  public IEnumerable<DataItem> IDataItems.Items()
  {
    yield return new DataItem() {"Name", Name};
    yield return new DataItem() {"Address", Address};
    yield return new DataItem() {"Age", Age};
  }
}

//and the foreach loops look like this:
foreach(DataItem d in ViewData.OfType<IDataItems>().First().Items())
{
  d.Title;
}

foreach(IDataItems container in ViewData.OfType<IDataItems>())
{
    foreach(DataItem d in container.Items())
    {
       d.Value;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T19:08:04.363

不，这些不是答案。我刚刚找到了！

这家伙正在通过强制转换匿名类型来使用示例动态类型。不需要类定义或 Linq 的特殊扩展方法！这真是太酷了。

[http://kirillosenkov.blogspot.com/2008/01/how-to-create-generic-list-of-anonymous.html](http://kirillosenkov.blogspot.com/2008/01/how-to-create-generic-list-of-anonymous.html)

这是为匿名类型的动态搜索开辟了一些巨大可能性的日子之一。

```
var anonymousTypeExample = new { startYear = 2000, endYear = 2000, model = "test" };
var list = (new[] { anonymousTypeExample }).ToList();

list.Clear();

list.Add(new{
    startYear = 1990,
    endYear = 2004,
    model = "Honda"
});
list.Add(new
{
    startYear = 1989,
    endYear = 1989,
    model = "KTM"
});
list.Add(new
{
    startYear = 1989,
    endYear = 1989,
    model = "KTM"
});

list = list.OrderBy(l => l.startYear).ToList();

foreach(var l in list)
{
    <div>@l.model @l.startYear - @l.endYear</div>
} 
```

# flash - 在 ActionScript 2 中如何检测鼠标何时离开舞台？

> ID：446423
> 
> 赞同：1
> 
> 时间：2009-01-15T11:28:51.597
> 
> 标签：flash, actionscript-2

我运气不好，不得不将一些 ActionScript 3 代码移植到 ActionScript 2，并且在检测鼠标何时离开舞台时遇到了问题。

在 ActionScript 3 中有一个名为 的事件`Event.MOUSE_LEAVE`，可用于检测鼠标何时离开舞台，但据我所知，在 ActionScript 2 中没有等效的。

您将如何最好地模拟相同的功能？

*侦听鼠标移动并根据舞台边界检查鼠标坐标不起作用，因为当鼠标离开舞台时鼠标坐标停止更新。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T12:13:05.080

我还没有在 AS2 中找到可靠的方法来执行此操作（在某些浏览器上，当鼠标在应用程序之外时，您甚至会不断获取鼠标更新）。所以我通常做的是检查鼠标是否在应用程序的外部 10 或 20 像素边界之外，如果是，我认为这是 MOUSE_LEAVE。最好听 MOUSE_MOVE 而不是每帧都检查这个，因为如果你的帧速率较低，你可能会错过一些更新。

也可以调出上下文菜单，将鼠标移到外面，然后完全绕过上面的整个检查（或者甚至将鼠标快速移过边框），所以我经常添加一个在鼠标没有触发后触发的计时器t 移动了 2-3 秒。

它不是特别强大，但它是我管理过的最好的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-17T16:43:00.360

## 使用数学来估计鼠标*何时*超出范围：

（按照 Theo 的第三个选项的实现。）

```
// Stage rollout detection:
private var mouse_dx:Number;
private var mouse_dy:Number;

private function detectMouseOutOfBounds ():Void {
    mouse_dx = _xmouse;
    mouse_dy = _ymouse;

    var mouseListener:Object = { };
    mouseListener.onMouseMove = Delegate.create(this,
        function () {
            mouse_dx = Math.abs(mouse_dx-_xmouse);
            mouse_dy = Math.abs(mouse_dy-_ymouse);
            var speed:Number = Math.max(mouse_dx, mouse_dy) + 5; // Precautionary buffer added.
            var willBeOutOfBounds:Boolean = (
                _xmouse - speed < 0 || 
                _xmouse + speed > Stage.width ||
                _ymouse - speed < 0 ||
                _ymouse + speed > Stage.height
            );
            if (willBeOutOfBounds) {
                _display._alpha = 10;
            } else {
                _display._alpha = 100;
            }
            mouse_dx=_xmouse;
            mouse_dy = _ymouse;
        }
    );
    Mouse.addListener(mouseListener);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T12:35:32.557

我想我曾经通过在舞台边缘放置隐形按钮并使用它们的滚动功能来解决这个问题。认为只要他们没有移动鼠标太快就可以了！虽然遥远的记忆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-06T17:42:10.587

此问题的解决方案分为三类：

1.  根据舞台边界检查鼠标位置（例如 Mayhew 的回答）。这是一个幼稚的解决方案，如果它有效，我永远不会问这个问题。问题是当鼠标离开舞台时鼠标坐标停止更新，它们将保留它们的最后位置，该位置始终在舞台内。

2.  在舞台周围创建一个边框并检测此边框内的鼠标移动（例如grapefrukt的回答。如果边框非常宽，但您会得到很多误报 - 并且如果鼠标停在边框内然后再次开始移动你得到一个错误的鼠标输入。也遇到与 1 相同的问题，鼠标总是可以移动得足够快，以至于你不会检测到它在边界上移动。

3.  跟踪鼠标的方向和速度，以便当您停止接收鼠标移动事件时，您可以计算鼠标应该在哪里，并查看该点是否在舞台之外。在边缘情况下可能会被愚弄，但比 1 和 2 都好得多。不过需要更多的代码。

# sql-server-2005 - NHibernate：释放 .mdf 文件

> ID：446424
> 
> 赞同：0
> 
> 时间：2009-01-15T11:28:55.217
> 
> 标签：sql-server-2005, nhibernate, c#-2.0

我正在为一个项目使用 NHibernate。该项目打开一个 SQL Server 2005 数据库，然后，在所有工作完成后，它应该备份数据库。问题是 SQL Server 在调用 factory.Close() 后保持句柄打开，因此备份副本失败。如何关闭文件句柄？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-21T09:01:54.830

如果您尝试制作数据库文件的副本，您可以使数据库脱机。

```
ALTER DATABASE AdventureWorks SET OFFLINE

--Copy the data file

ALTER DATABASE AdventureWorks SET ONLINE 
```

要进行联机备份，您可以使用 BACKUP DATABASE 命令。

```
BACKUP DATABASE AdventureWorks 
 TO DISK = 'Z:\SQLServerBackups\AdvWorksData.bak' 
```

# java - tomcat 错误 - “此版本的 Apache Tomcat 已打包以在 J2SE 5.0 上运行”

> ID：446439
> 
> 赞同：0
> 
> 时间：2009-01-15T11:40:38.500
> 
> 标签：java, tomcat

我们在启动 tomcat 时收到此错误（作为服务和通过命令行）：

```
This release of Apache Tomcat was packaged to run on J2SE 5.0
or later. It can be run on earlier JVMs by downloading and
installing a compatibility package from the Apache Tomcat
binary download page. 
```

我们有带有 tomcat5.exe 和 tomcat5w.exe 的版本 - 没有 bat 文件:(

路径上只有 jdk5：

```
Path=f:\Program Files\Java\jdk1.5.0_06\bin;C:\WINDOWS\System32 
```

我们使用的是Tomcat5.5，jdk 1.5.0_06 安装在同一台机器上。

```
java version "1.5.0_06"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)
Java HotSpot(TM) Client VM (build 1.5.0_06-b05, mixed mode, sharing) 
```

JAVA_HOME 也指向相同的版本：

```
F:\Development\Program Files\Apache Software Foundation\Tomcat 5.5\bin>set j
JAVA_HOME=f:\Program Files\Java\jdk1.5.0_06 
```

关于我哪里出错的任何提示？

谢谢克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T11:46:56.633

您可以在 start.bat 文件中配置不同版本的 Java。服务也是如此（但在不同的地方）。

我建议添加一个`echo %JAVA_HOME%`（如果您使用 start.bat）以查看实际发生的情况。

如果您使用该服务，请打开该服务的属性（使用 tomcat 放在系统托盘中的图标）。在“Java”选项卡上，您会找到该服务使用的 JVM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T12:21:46.997

您只有 exe 版本，没有 bat 文件，因为您下载的是 Windows Installer 而不是 zip 文件。bat 文件仅包含在 zip 文件中。您可以下载 zip 并将 bat 文件复制到 bin 目录。无需卸载。

我打赌你有一个PATH问题。检查系统目录中是否有旧版本的 Java。此外，请确保您修改 PATH 系统范围而不是每个命令行会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T11:47:19.797

我希望我没有过度简化，但你检查过你的`PATH`吗？

* * *

**编辑：**只是出于好奇，尝试改变你的`PATH`和你`JAVA_HOME`的`.../jdk1.5.0_06/`**`jre`**`/bin`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T12:14:47.043

我自己没有尝试过，但我在某个地方读到过（对不起，不知道在哪里），有时在安装 java 5 后需要重新安装 tomcat。所以，如果你先安装了 tomcat5，然后再安装了 java5，也许这就是你的问题。

# linux - Linux 上的端口聚合

> ID：446443
> 
> 赞同：0
> 
> 时间：2009-01-15T11:42:44.580
> 
> 标签：linux, networking, port, aggregation

我必须在 Linux 上检测端口聚合配置。

假设 ifcfg-* 文件未更新（仅使用 ifenslave 完成配置），我如何了解哪个 eth？设备是哪个债券的奴隶？设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:14:40.303

找到了：

> ip地址

eth0: mtu 1500 qdisc pfifo_fast **master bond0** qlen 1000

# sharepoint - Sharepoint：更新内容类型时，基于内容类型的列表会发生什么情况？

> ID：446451
> 
> 赞同：9
> 
> 时间：2009-01-15T11:47:18.020
> 
> 标签：sharepoint, content-type, updating

我有一种假设性的问题（至少现在:)）

假设我根据一些自定义内容类型创建列表。我在该列表中添加了大约 1000 个项目（在生产中）。然后客户来了，他说他需要修改那个自定义内容类型。

如果我修改自定义内容类型，列表会发生什么？它会自动更新（我怀疑）吗？那么已经创建的列表项呢？

你们有这方面的经验吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-18T21:49:08.463

所以有几个关于内容类型的问题：

首先，内容类型有两种类型：站点内容类型和列表内容类型。站点内容类型是驻留在图库中的“模板”。当在列表中使用站点内容类型时，该内容类型被实例化为给定列表上的列表内容类型。

其次，您的内容类型可以通过多种方式创建和修改，这将决定您的数据以三种模式中的哪一种出现在数据库中。

如果您已使用 GUI 或通过使用 API 的自定义代码创建了内容类型，那么您的站点内容类型和列表内容类型在数据库中都处于“仅限数据库”状态。这意味着它正在数据库中查找内容类型的定义。

[如果您在CAML](http://en.wikipedia.org/wiki/Collaborative_Application_Markup_Language)中创建了内容类型作为功能，则您的*网站*内容类型在数据库中是幻影（或未自定义，因为我们应该在 v3 中调用它）。这基本上意味着数据库在 12-hive 中的特征 XML 中查找构成内容类型的站点列。所以这应该意味着您可以更新该功能，并且您将在更新内容类型中提供新的站点列，对吗？

不幸的是没有：还记得我们也有列表内容类型吗？令人遗憾的是，这些列表内容类型是使用代码实例化的，因此它们处于“仅数据库”状态。这意味着您的更改只会出现在您的网站内容类型中，而不会出现在使用该内容类型的现有列表中！

有几种方法可以解决此问题，解决方案取决于您的需求以及您正在执行的更改类型（删除字段、添加字段、更改字段）。

例如，您经常希望保留现有的项目元数据，即使内容类型随时间而变化。如果您通过代码推送列表内容类型的更改，您将丢失存储在更改/删除字段中的数据。对此的解决方案是在旧内容类型的基础上添加一个全新的内容类型，但字段已更改。您将添加新内容类型（通过代码或使用功能 XML）并使用功能接收器或类似功能将新内容类型传播到使用旧内容类型的所有列表，然后将旧内容类型标记为隐藏。这样就可以保留旧的元数据，但不能使用新元数据以外的方式添加新项目。

如果您可以直接访问生产环境，并且您的客户治理计划允许，那么该问题的另一个答案中提到的方法将是首选方法。然而，与 SharePoint 中的其他工件一样，建议以结构化方式部署内容类型。以非结构化方式添加新内容类型会影响搜索相关性（托管属性），也可能会影响网站的一般分类（网站栏不被重用等），因此即使可以直接在生产网站，我不会推荐它！

这使我想到了我会推荐的最终方法，至少对于未来的内容类型：使用功能接收器从一开始以编程方式创建您的内容类型！这样您就可以始终了解内容类型的真实状态（仅限数据库），并且您可以采用结构化的方法来管理未来的更改！您可以通过谷歌搜索“以编程方式创建“内容类型”SharePoint”来找到几种方法

为了完整起见：我提到了三种模式。您的内容类型可以使用的最后一种模式是“UnGhosted”。这意味着您的内容类型是使用功能 XML 创建的，但它已与 12 hive 中的原始 XML 源断开连接。

我的朋友 Søren Nielsen 在*[Audit your Content Type Hierarchy](http://soerennielsen.wordpress.com/category/content-types/)*中对 Content Types 有一些很好的看法。上面描述的一些问题可以在 MSDN 文章*[更新内容类型](http://msdn.microsoft.com/en-us/library/aa543504.aspx)*中找到简要提及。Gary Lapointe 也有一个 STSADM 扩展来解决与内容类型有关的一些问题，请参阅*[传播内容类型更改](http://stsadm.blogspot.com/2008/05/propagate-content-type-changes.html)*。

很抱歉咆哮，但这个主题很复杂，需要彻底解释以避免任何误解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:32:32.277

当您更新内容类型时，您可以单击一个复选框来更新子内容类型。通过选中该框，将更新列表内容类型。

请注意，如果您*未*选中更新子内容类型的复选框，则无法在以后强制更新。因此，如果您不更新并且稍后希望子内容类型具有更新，则您首先需要撤消更新并重新执行它。

.b

# django - 围绕另一个模型的查询集平分查询集

> ID：446454
> 
> 赞同：0
> 
> 时间：2009-01-15T11:49:59.590
> 
> 标签：django, django-models

我正在编写一个用户驱动的应用程序，其中包含多个区域。我希望允许用户自定义他们的消息设置，以便他们只收到有关他们关心的部分和操作的电子邮件。我制定了以下内容`Class`：

```
class EmailSetting(models.Model):
    user = models.ForeignKey(User, related_name="%(class)s_related_user")
    key = models.CharField(max_length=50)
    value = models.BooleanField() 
```

这将由名为 的方法使用，该方法`get_users(key, default)`应*返回*用户列表。例如，如果我询问在 a 上被`key="new_post", default=False`替换的用户列表，我应该得到一个用户列表，其中他们有一个 EmailSetting，该键的值为 True。这很简单，因为我可以只使用 EmailSetting 模型。

如果默认值为 True，则事情似乎更难。我从来没有做过比模型的基本查找更复杂的事情，所以我需要帮助。

从完整的用户列表中，我需要删除带有 False EmailSetting 的用户。没有在 EmailSetting 上进行另一个查询以查找 False 条目并迭代地将它们从第一个查询集中删除，我不知道该怎么做......

......但*必须*有另一种方式，因为那很臭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:39:44.233

好吧，我是这样做的：

```
def get_users(key, default):
    if not default:
        return [es.user for es in EmailSetting.objects.filter(key = key, value = True)]
    return User.objects.exclude(pk__in = [es.user.pk for es in EmailSetting.objects.filter(key = key, value = False)]) 
```

当你想到它时，它非常简单！有时一定会喜欢 Python 语法 =)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T12:52:24.050

我在用户字段中更改了您的相关名称，因为我认为您不想引用名称中带有“用户”的 EmailSetting。

```
def get_users(key, default):
    if default:
        return User.objects.exclude(emailsetting__key=key, emailsetting__value=False)
    else:
        return User.objects.filter(emailsetting__key=key, emailsetting__value=True) 
```

# sql-server - 自定义附加软件的数据库对象放置

> ID：446456
> 
> 赞同：0
> 
> 时间：2009-01-15T11:50:19.417
> 
> 标签：sql-server, database-design

对于将自定义附加组件放置到另一个应用程序数据库的数据库对象（表、过程、视图等）的位置，每个人的建议是什么？

他们是否应该像这样分开：

```
ErpInventoryAccountingWare.dbo
CustomIntegratedPortal.dbo 
```

或者，附加组件对象是否可以放置在同一个数据库中。对象将被适当命名，并假定相同的权限。

将对象保存在同一台服务器上但在不同的数据库中对我来说似乎是一个干净的解决方案，只要您准备好更改脚本以适应其他数据库名称。

我正在使用 SQL 2000、SQL 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T13:09:55.560

如果将它们放在不同的数据库中，仅应用程序数据库的备份将丢失它们，因此它为应用程序的操作维护提供了一个陷阱。

在 SQL Server 2005 上，如果应用程序的开发人员决定添加一个名称与您的名称冲突的表，则创建您自己的架构将有助于防止命名空间污染。

在 SQL Server 2000 上，让特定应用程序用户拥有表将为您提供模式的一些好处，同时允许它们在同一数据库中共存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T18:45:49.687

取决于供应商；一些供应商不喜欢在他们的数据库中处理外国的东西；我已经看到供应商代码删除了任何不属于他们的东西。在升级过程中，事情也会消失。

但如果它是一个非常稳定且表现良好的应用程序，那么在我看来，将所有东西放在一起是一个优势。只需为所有内容添加前缀，例如 ABC_MyProc、ABC_MyTable，以便识别它们。

# php - Guide for securing an ajax php webapp

> ID：446467
> 
> 赞同：1
> 
> 时间：2009-01-15T11:56:46.690
> 
> 标签：php, ajax, security

I have a small AJAX application, written in PHP that I did not secure from the start. I would like some recommendations on how to now secure the app, things to implement and check for. I have not found any exhaustive guides on google, and hope that some can be recommended.

It is a small application that connects to and displays records from a mysql database. It is not using any external libraries.

I am unsure about how to protect on passing in variables, such as:

```
if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"]; 
```

Should I simply declare $cmd to something before check isset?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:29:07.203

If you are talking about securing the app (as opposed to the server/ environment it is on - which I am not really qualified to address) then I would consider the following:

1.  Ensure any user inputs are parsed/cleaned to ensure they can't do things such as [SQL injection attacks](http://www.unixwiz.net/techtips/sql-injection.html). This includes any ajax requests where the user input can be stored on the query string. **In fact anything passed into the app from the query string should be validated/cleaned in this manner**.
2.  Do you use any passwords? If so use SSL to stop any packet sniffing. And [hash your passwords in your database with a salt](http://phpsec.org/articles/2005/password-hashing.html)
3.  A quick Google dug up this which looks pretty good: [http://www.securityfocus.com/infocus/1706](http://www.securityfocus.com/infocus/1706)
4.  Some tips on securing user input [http://www.dagondesign.com/articles/writing-secure-php-scripts-part-1/](http://www.dagondesign.com/articles/writing-secure-php-scripts-part-1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T12:29:25.687

The most important rule when handling user input is: *Validate input, escape output*.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:23:41.207

You're looking for the ultimate security manual? Send me a copy when you find it!

The short checklist:

*   SQL vunerabilities?
*   Validate your $_GET and $_POST inputs, and remove anything funny
*   Lose the get_magic_quotes_gpc() (or whatever it's called)

And of course everything your sys-admin is supposed to do:

*   latest version of PHP
*   up to date version of MySQL

I'm not sure having no external components makes you more secure automaticly. I use ADODB for PHP, to handle all my SQL stuff. I know it checks for vunerabilities, so I do not have to do it.

# asp.net - 绑定到 ASP.NET GridView

> ID：446468
> 
> 赞同：0
> 
> 时间：2009-01-15T11:57:19.637
> 
> 标签：asp.net, gridview

我有以下代码：

```
var emp = new List<Employee>
{    
   new Employee{ID=1, EmpFname="matt", EmpLName="Cook"},  
   new Employee{ID=2, EmpFname="mary", EmpLname="John"}
}; 
```

如何按 EmpLName 对 emp 进行排序并将其绑定到 GridView？如何指定 asc 或 desc？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T16:48:13.263

使用 LINQ 的简单方法：

```
var sortedEmpList = ( from e in emp
orderby e.EmpLName
select e).ToList()
); 
```

**您还可以通过在orderby**之后添加更多属性来继续按其他属性排序。

```
orderby e.EmpLName, e.EmpFName  //, ... 
```

然后，如果您愿意，请选择**降序...**

```
orderby e.EmpLName descending 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T12:37:25.250

```
 List<Employee> temp = new List<Employee> { 
            new Employee { ID = 1, EmpFname = "matt", EmpLName = "Cook" }, 
            new Employee { ID = 2, EmpFname = "mary", EmpLName = "John" } };

        temp.Sort(delegate(Employee e1, Employee e2)
        {
            // returns asc
            return e1.EmpLName.CompareTo(e2.EmpLName);
           // returns desc
           //  return e2.EmpLName.CompareTo(e1.EmpLName);

        });

        // no need to use var keyword, just bind the List 
        MyGridView.DataSource = temp;
        MyGridView.DataBind(); 
```

# unicode - 在代码中使用 PDF 注释

> ID：446478
> 
> 赞同：-2
> 
> 时间：2009-01-15T11:59:43.157
> 
> 标签：unicode, acrobat

有人远程使用 Adob​​e PDF 的注释功能吗？例如通过脚本或COM 访问它们？

我无法从 pdf 中获取 UNICODE 信息，想知道是否有人遇到过类似问题？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2009-02-11T22:59:14.663

事实证明，如果我们在 pdf COM 接口中使用 javascript 对象，我们可以正确地使用 unicode 获取注释。

这就是我们现在正在采取的方法。可以在[此处](http://www.adobe.com/devnet/acrobat/pdfs/VBJavaScript.pdf)找到一个基本 (VB) 示例。

# asp.net - GridView对列表排序

> ID：446481
> 
> 赞同：0
> 
> 时间：2009-01-15T12:00:30.613
> 
> 标签：asp.net, gridview

我有以下代码：

```
var emp = new List<Employee>
{    
   new Employee{ID=1, EmpFname="matt", EmpLName="Cook"},  
   new Employee{ID=2, EmpFname="mary", EmpLname="John"}
   // and so on
}; 
```

如何按 EmpLName 对 emp 进行排序并将其绑定到 GridView？如何指定 asc 或 desc？

如果有人可以使用 LINQ/Lambda 表达式来解释它，那将会很有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:23:33.797

您可以使用 OrderBy(Descending) 和 lambda 表达式来选择名称。我在下面的示例中使用“姓氏，名字”作为键。

```
 var ordered = emp.OrderBy( e => e.EmpLName + ", " + e.EmpFName )
                  .ToList();

 var inverse = emp.OrderByDescending(  => e.EmpLName + ", " + e.EmpFName )
                  .ToList(); 
```

要绑定到 GridView，请将 GridView 的 DataSource 设置为有序列表。如果 GridView 将 IEnumerable 作为数据源，您可以跳过 ToList 步骤。我不记得我的头顶支持哪些接口。

# actionscript-3 - AS3 中的重载 [] 运算符

> ID：446482
> 
> 赞同：4
> 
> 时间：2009-01-15T12:00:34.887
> 
> 标签：actionscript-3, collections, operator-overloading

我刚写完自己的collecion 类，我真的很想用for each 或simple for 构造让它可迭代，或者只是用collection[key] 表示法访问元素。

我已经写了一个`getElementAt(index):MyOwnElement`函数，但是使用它并不像使用方括号那样性感，甚至不要让我开始迭代..

有什么办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-15T13:20:24.290

您应该看一下[`mx.utils.Proxy`](http://livedocs.adobe.com/flex/3/langref/flash/utils/Proxy.html)- 从中​​继承您的集合类（并将其设置为动态）可能使您可以访问您想要的一些功能（或者至少是足够接近的功能。）

例如，下面是该方法文档的摘录`nextValue()`：

> *“允许通过索引号枚举代理对象的属性以检索属性值。但是，您不能枚举代理类本身的属性。**此函数支持在对象上实现`for...in`和`for each..in`循环以检索所需的值。”***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:03:39.520

您不能覆盖 AS3 中的运算符。
我认为您可以将 'getElementAt' 更改为一个短名称，例如 'at':) 或将 getElementAt 设置为临时变量....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T19:30:18.037

取决于您收藏的内部结构。如果您的集合存储为数组，那么您可以使用属性来实现方括号效果：

```
 /*** MyCollection class ***/
private var elementHolder : Array;

public function get getElementAt() : Array{
   return elementHolder;
}
/*** Some other class******/
public function main() : void{
   trace("Element at 3: " + myCollection.getElementAt[3] );
} 
```

如果您的集合未存储在数组中，则您可以将其转换为数组（如 java Collection 的 toArray() 方法）。

例如，如果您的集合是一个链表：

```
 /*** MyCollection class ***/

public function get getElementAt() : Array{
   var temp : Array = new Array();
   while( node.next != null{
      temp.push( node );
   }
   return temp;
}
/*** Some other class******/
public function main() : void{
   trace("Element at 3: " + myCollection.getElementAt[3] );
} 
```

# c# - 在方法调用之间缓存了哪些（如果有）本地定义的委托？

> ID：446483
> 
> 赞同：6
> 
> 时间：2009-01-15T12:01:42.313
> 
> 标签：c#, compiler-construction, caching, delegates

我在另一个问题中提到了这一点，我认为将其添加到记录中可能很有用。在下面的程序中，如果有的话，哪些本地定义的委托在调用 Work 方法之间被缓存，而不是每次都从头开始创建？

```
namespace Example
{
    class Dummy
    {
        public int age;
    }

    class Program
    {
        private int field = 10;

        static void Main(string[] args)
        {
            var p = new Program();

            while (true)
            {
                p.Work();
            }
        }

        void Work()
        {
            int local = 20;

            Action a1 = () => Console.WriteLine(field);
            Action a2 = () => Console.WriteLine(local);
            Action a3 = () => Console.WriteLine(this.ToString());
            Action a4 = () => Console.WriteLine(default(int));
            Func<Dummy, Dummy, bool> dummyAgeMatch = (l, r) => l.age == r.age;

            a1.Invoke();
            a2.Invoke();
            a3.Invoke();
            a4.Invoke();
            dummyAgeMatch.Invoke(new Dummy() { age = 1 }, new Dummy(){ age = 2 });
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T12:08:45.900

根据 Reflector 显示的内容，最后两个 (`a4`和`dummyAgeMatch`) 由 MS C#3.0 编译器缓存（在我的特定构建中称为“CS$<>9_CachedAnonymousMethodDelegate5”和“CS$<>9_CachedAnonymousMethodDelegate6”的字段中）。

这些*可以*被缓存，而显然其他的依赖于捕获的变量。

我不相信规范规定了这种行为，但是 Mono 编译器的行为方式几乎相同（使用不同的变量名）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T12:11:26.397

好吧，回答具体问题：最后两个是唯一被缓存的，因为它们不捕获任何东西。您可以在反射器中看到这一点（但它并不漂亮）。当然，您可以通过传入 args来调整它们以*使它们可重用：*

```
Action<Program> a1 = p => Console.WriteLine(p.field);
Action<int> a2 = i => Console.WriteLine(i);
Action<Program> a3 = p => Console.WriteLine(p.ToString());
Action a4 = () => Console.WriteLine(default(int));
Func<Dummy, Dummy, bool> dummyAgeMatch = (l, r) => l.age == r.age; 
```

并传入`this`/ `a1`，`a3`并`local`传入`a2`。因为它们都不再直接捕获任何东西，所以它们都可以被缓存（`CS$<>9__CachedAnonymousMethodDelegate5`至少`CS$<>9__CachedAnonymousMethodDelegate9`对我来说是这样）。当然，他们随后失去了直接重新分配（先前捕获的）变量的能力，但是 FP 倡导者无论如何都不喜欢这样；-p 您始终可以将更新的值作为返回值传回，或者声明一个委托类型带`ref`参数（不过我不推荐它）。

# php - 使光标消失

> ID：446492
> 
> 赞同：0
> 
> 时间：2009-01-15T12:04:18.687
> 
> 标签：php, jquery, css, cursor

我正在为一个小 Web 应用程序构建一个编辑器。我的概念是有一个酒吧，我可以在其中放置所有功能。它会根据内容发生变化。现在我遇到了以下问题。正如您在[图片](http://picasaweb.google.com/lh/photo/FPOOEeEok77eqBod0yOS0A?authkey=DKo-MXLLwDk&feat=directlink)中看到的那样，当我单击按钮时，恰好在单击按钮后该按钮将位于一个新按钮上。我的问题是：是否有可能使光标消失？我们正在使用 PHP 进行编码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T12:12:52.273

你的意思是鼠标光标消失了？如果是这样，您可以使用 css 将任何 gif 用作鼠标光标，甚至是透明的。

因为形象，我想你会说德语？如果您在此处回答了所有问题，请查看[此处](http://www.css4you.de/cursor.html)。

* * *

编辑：我想我用 JQuery 做了你想要的 - 快速而肮脏，虽然......用 IE6 和 FF 3 测试。[在这里下载一个例子](http://cid-a1b54a42419a0b3e.skydrive.live.com/self.aspx/%c3%96ffentlich/cursordisappearexample.7z)

# delphi - 如何在 Delphi 中获取本地化的日期名称？

> ID：446498
> 
> 赞同：8
> 
> 时间：2009-01-15T12:07:10.117
> 
> 标签：delphi, dayofweek

我正在使用标准的 Delphi 常量 DayMonday 等，我想将它们转换为本地化字符串（例如“Lundi”）。是否有一个简单的 RTL 或 VCL 调用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T12:25:57.053

您可以通过以下方式获得不同的语言环境设置：

```
var
  fs : TFormatSettings;
  x  : string;
begin
  GetLocaleFormatSettings(GetThreadlocale, fs);
  x:= FormatDateTime('%mmmm', Now, fs);
  // etc..
end; 
```

GetThreadLocale 提供当前的 LCID，但您可以自己使用另一个数字。

TFormatSettings 记录：

```
TFormatSettings = record
  CurrencyFormat: Byte;
  NegCurrFormat: Byte;
  ThousandSeparator: Char;
  DecimalSeparator: Char;
  CurrencyDecimals: Byte;
  DateSeparator: Char;
  TimeSeparator: Char;
  ListSeparator: Char;
  CurrencyString: string;
  ShortDateFormat: string;
  LongDateFormat: string;
  TimeAMString: string;
  TimePMString: string;
  ShortTimeFormat: string;
  LongTimeFormat: string;
  ShortMonthNames: array[1..12] of string;
  LongMonthNames: array[1..12] of string;
  ShortDayNames: array[1..7] of string;
  LongDayNames: array[1..7] of string;
  TwoDigitYearCenturyWindow: Word;
end; 
```

另请参阅[http://www.microsoft.com/globaldev/reference/lcid-all.mspx](http://www.microsoft.com/globaldev/reference/lcid-all.mspx)以获取完整列表。

您甚至可以自己更改格式设置以创建真正精美的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T12:31:29.647

我*以为*我已经为“当前语言环境”找到了一种简单的方法。

system.pas 中定义了全局数组 LongDayNames[] 和 ShortDayNames[]

所以..

```
 Label.Text = LongDayName[DayMonday]; 
```

应该工作，例如。***除了它返回 "Sunday"***。这是因为 Delphi 内部支持两天编号方案，DayMonday 是 ISO8601 常量 1，而 LongDayName 数组期望星期日为一周的第一天。C++Builder 使事情更加混乱，因为字符串数组从零开始，而不是从一开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-26T19:22:10.123

您可以执行以下操作：

var d1：字符串；

// 法语：

```
 case dayofweek(cxScheduler1.SelStart) of
  1:d1:='Dimanche';
  2:d1:='Lundi';
  3:d1:='Mardi';
  4:d1:='Mercredi';
  5:d1:='Jeudi';
  6:d1:='vendredi';
  7:d1:='Samedi';
 end; 
```

# c# - DataGridViewComboBoxColumn

> ID：446500
> 
> 赞同：0
> 
> 时间：2009-01-15T12:09:22.187
> 
> 标签：c#, datagridview

我有两个`DataGridViewComboBoxColumn`在运行时添加。我需要第一个的项目在 的 `DataGridViewComboBoxColumn`所有行中保持相同，`GridView`但我希望第二个的项目`DataGridViewComboBoxColumn`根据第一个的选定项目而有所不同`DataGridViewComboBoxColumn`。

如果我们说第一个`DataGridViewComboBoxColumn`代表位置，第二个`DataGridViewComboBoxColumn`代表子位置。所以，我希望第二个`DataGridViewComboBoxColumn`项目是第一个选定位置的子位置`DataGridViewComboBoxColumn`。

像这样如果`Canada`被选中

```
Country(comboBoxItems)  |     State/Province(ComboBox Items)
USA                           Quebec
CANADA(selected)              Ontario
ENGLAND                       Manitoba
                              Alberta 
```

那么如果你选择`USA`

```
Country(comboBoxItems)  |     State/Province(ComboBox Items)
USA (Selected)                California
CANADA                        New York
ENGLAND                       Montana
                              Ohio 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:37:51.407

回顾你的问题：

您有一组数据并希望对其进行过滤。

这是一个与此主题[相同的问题的问题。](https://stackoverflow.com/questions/13147049/how-to-apply-a-filter-on-linqtosql-results/13184592#13184592)（具体来说，在 LINQtoSQL IQueriable 对象被触发到数据库之前对其进行过滤。）

我找到了两个可能对我们的问题感兴趣的解决方案。

我找到了一种方法来处理 DataSets (ADO.NET) 中的数据

```
DataTable source { get; set; }
String ValueMember { get; set; }
String DisplayMember { get; set; }
String FilterMember { get; set; }

Object ADOSelect(Object criterium)
{
    if ((source == null) || (criterium == null)) return null;

    return
    (
        from r in source.AsEnumerable()
        where (r[FilterMember] == criterium)
        select new
        {
            Value = r[ValueMember],
            Display = r[DisplayMember]
        }
    ).ToList();
} 
```

还有一个更通用的解决方案。

```
class Record
{
    public object Display { get; set; }
    public object Value { get; set; }
}

IEnumerable<Object> source { get; set; }
String ValueMember { get; set; }
String DisplayMember { get; set; }
String FilterMember { get; set; }

Object DataSelect(Object criterium)
{
    List<Record> result = new List<Record>();
    foreach (var record in source) Parse(sender, record, criterium, result);
    return result;
}

private void Parse(object record, Object criterium, List<Record> result)
{
    MethodInfo DisplayGetter = null;
    MethodInfo ValueGetter = null;
    bool AddRecord = false;

    foreach (PropertyInfo property in record.GetType().GetProperties())
    {
        if (property.Name == DisplayMember) DisplayGetter = property.GetGetMethod();
        else if (property.Name == ValueMember) ValueGetter = property.GetGetMethod();
        else if (property.Name == FilterMember)
        {
            MethodInfo ExternalGetter = property.GetGetMethod();
            if (ExternalGetter == null) break;
            else
            {
                object external = ExternalGetter.Invoke(record, new object[] { });
                AddRecord = external.Equals(criterium);
                if (!AddRecord) break;
            }
        }
        if (AddRecord && (DisplayGetter != null) && (ValueGetter != null)) break;
    }

    if (AddRecord && (DisplayGetter != null) && (ValueGetter != null))
    {
        Record r = new Record();
        r.Display = (DisplayGetter != null) 
            ? DisplayGetter.Invoke(record, new object[] { })
            : null;
        r.Value = (ValueGetter != null) 
            ? ValueGetter.Invoke(record, new object[] { })
            : null;
        result.Add(r);
    }
} 
```

# security - Apache2 未定义字符集 UTF-7 XSS 漏洞

> ID：446501
> 
> 赞同：0
> 
> 时间：2009-01-15T12:09:32.890
> 
> 标签：security, apache, apache2, xss

有谁知道如何在不升级 Web 服务器的情况下修复**Apache 2.2.4中的这个漏洞？**

这是我在[**SecurityReason**](http://securityreason.com/achievement_securityalert/46)的网上找到的。他们建议的修复方法是将其升级到版本 2.2.6。但是服务器是实时的，升级 t 是最后的手段。

> **Apache2 XSS 未定义字符集 UTF-7 XSS 漏洞**
> 
> XSS(UTF7) 存在于[mod_autoindex.c](http://httpd.apache.org/docs/2.0/mod/mod_autoindex.html)中 。Charset 未定义，我们可以通过将 Charset 设置为 UTF-7 来使用 apache 2.2.4 中可用的“P”选项提供 XSS 攻击。
> 
> "P=pattern 仅列出与给定模式匹配的文件"

请为此提出解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:22:52.020

好吧，首先它只会在您使用[mod_autoindex](http://httpd.apache.org/docs/2.0/mod/mod_autoindex.html)时影响您。如果你不是，那么你现在可以停止阅读，因为你正在运行的代码没有漏洞（尽管理想情况下，在你更新服务器之前不要开始使用这个模块）。

否则，攻击者似乎可以利用字符集未明确设置的事实将他们自己的脚本嵌入到给定特制 URL 的页面中。该 URL 将使用“P”参数来指定自动索引的过滤器；可以理解的是，没有给出一个示例漏洞，但推测某些巧妙的文本操作将允许攻击者将他们自己的 Javascript 插入返回的页面。

因此，这是一种标准的[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)（如果您不熟悉其后果，请阅读链接）。

如果您受到影响，我*强烈*建议您进行升级，以获得完全的安全性。用户应该理解将网站关闭一段时间以进行安全升级，这比遭受攻击要好得多。但是，与此同时，一种解决方法是从传入请求中删除任何 P 参数（假设您站点上的其他页面都没有接受这样的参数，并且没有其他页面依赖于将过滤器传递给自动索引页面），甚至只是禁用完全自动索引模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T07:14:59.473

我最终更新到 Apache 2.2.11！

然而，[dtsazza](https://stackoverflow.com/users/45664/dtsazza)的回答是正确的，但我的 VA 测试团队不会买它。:)

# php - 请批评我在 PHP 中第一次尝试 MVC

> ID：446502
> 
> 赞同：15
> 
> 时间：2009-01-15T12:09:53.637
> 
> 标签：php, model-view-controller

好吧，我不是一个庞大的框架人，但我一直很喜欢我所听到的关于整个 MVC 运动的内容，所以我想我会尝试用我选择的语言 (PHP) 创建一个简单的应用程序

所以我想问题是：我哪里出错了？我知道关于控制器/模型应该有多胖有很多争论，所以希望我们可以避免这种情况，但是我特别好奇你对我如何适应数据层的想法。

我还买了一个域来做一些测试，所以如果你想看到它的实际效果，你可以去[www.omgmvc.com](http://www.omgmvc.com/)

首先，这是我的数据库架构：

```
CREATE TABLE `movies` (
  `id` int(11) NOT NULL auto_increment,
  `movie_name` varchar(255) NOT NULL,
  `release_date` date NOT NULL,
  `directors_name` varchar(255) NOT NULL,
  PRIMARY KEY  (`id`)
);

INSERT INTO `movies` VALUES (1,'Star Wars', '1977-05-25', 'George Lucas');
INSERT INTO `movies` VALUES (2,'The Godfather', '1972-03-24', 'Francis Ford Coppola');
INSERT INTO `movies` VALUES (3,'The Dark Knight', '2008-07-18', 'Christopher Nolan'); 
```

这是文件：

**index.php** *（控制器）*

```
<?php

include('datatier.php');
include('models/m_movie.php');

if (isset($_GET['movie']) && is_numeric($_GET['movie']))
{
    $movie = new Movie($_GET['movie']);

    if ($movie->id > 0)
    {
        include('views/v_movie.php');
    }
    else
    {
        echo 'Movie Not Found';
    }
}
else
{
    $movies = Movie::get_all();

    include('views/v_list.php');
}

?> 
```

**datatier.php** *（数据层）*

```
<?php

class DataTier
{
    private $database;

    function __construct()
    {
        $this->connect();
    }

    function __destruct()
    {
        $this->disconnect();
    }

    function connect()
    {
        $this->database = new PDO('mysql:host=localhost;dbname=dbname','username','password');
    }

    function disconnect()
    {
        $this->database = null;
    }

    function get_all_from_database($type)
    {
        $database = new PDO('mysql:host=localhost;dbname=dbname','username','password');

        switch ($type)
        {
            case 'movie':
                $query = 'SELECT id FROM movies';
                break;
        }

        $movies = array();

        foreach ($database->query($query) as $results)
        {
            $movies[sizeof($movies)] = new Movie($results['id']);
        }

        $database = null;

        return $movies;
    }

    function get_from_database($type,$id)
    {
        switch ($type)
        {
            case 'movie':
                $query = 'SELECT movie_name,release_date,directors_name FROM movies WHERE id=?';
                break;
        }

        $database_call = $this->database->prepare($query);
        $database_call->execute(array($id));

        if ($database_call->rowCount() > 0)
        {
            return $database_call->fetch();
        }
        else
        {
            return array();
        }
    }
}

?> 
```

**模型/m_movie.php** *（模型）*

```
<?php

class Movie extends DataTier
{
    public $id;
    public $movie_name;
    public $release_date;
    public $directors_name;

    function __construct($id)
    {
        parent::connect();

        $results = parent::get_from_database('movie',$id);

        if ($results == array())
        {
            $this->id = 0;
        }
        else
        {
            $this->id = $id;
            $this->movie_name = $results['movie_name'];
            $this->release_date = $results['release_date'];
            $this->directors_name = $results['directors_name'];
        }
    }

    function __destruct()
    {
        parent::disconnect();
    }

    static function get_all()
    {
        $results = parent::get_all_from_database('movie');

        return $results;
    }
}

?> 
```

**意见/v_list.php** *（视图）*

```
<html>
    <head>
        <title>Movie List</title>
    </head>
    <body>
        <table border="1" cellpadding="5" cellspacing="5">
            <thead>
                <tr>
                    <th>Movie Name</th>
                    <th>Directors Name</th>
                    <th>Release Date</th>
                </tr>
            </thead>
            <tbody>
<?php foreach ($movies as $movie) { ?>
                <tr>
                    <td><a href="/?movie=<?php echo $movie->id; ?>"><?php echo $movie->movie_name; ?></a></td>
                    <td><?php echo $movie->directors_name; ?></td>
                    <td><?php echo $movie->release_date; ?></td>
                </tr>
<?php } ?>
            </tbody>
        </table>
    </body>
</html> 
```

**意见/v_movie.php** *（视图）*

```
<html>
    <head>
        <title><?php echo $movie->movie_name; ?></title>
    </head>
    <body>
        <h1><?php echo $movie->movie_name; ?></h1>
        <h2>Directed by <?php echo $movie->directors_name; ?></h2>
        <h3>Released <?php echo $movie->release_date; ?></h3>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-15T12:48:16.803

首先，你在保持事物分离方面做得很好。它会在未来得到回报，所以不要放弃。

数据库布局（甚至数据库本身）与 MVC 的本质无关。在大多数情况下，它恰好是关系数据库，但是 MVC 并不明确要求它（您也可以使用 XML 存储或一些网格/云）。对 MVC 来说至关重要的是让 Model 与其他部分分开，您就是这样做的。

您的视图也明显与其他视图分开。类似于 MVC 的 M 部分，视图不仅可以呈现 HTML，还可以呈现任何文本可表示的输出（XML、XML+XSL、RSS、纯文本甚至电子邮件消息），视图可以通过多种方式实现：PHP 包括像你的一样、模板（即 Smarty）或可序列化为文本的成熟对象。我远不能判断哪种策略是最好的，这是个人编码风格和项目要求的问题。

您的控制器令人困惑（它更像是页面控制器而不是应用程序控制器）。这可能是因为 MVC 架构中有一个隐藏的部分。它被称为*Front Controller*或*Dispatcher*。由 Dispatcher 解析输入、实例化控制器（如在应用程序控制器中）和调用请求的方法。如果您想继续使用您的自定义 MVC 实现，我建议您使用一些在 URL 中传递 Controller 类和方法名称的常用方法，即

```
index.php/Movies/list
index.php/Movies/details/35 
```

然后在新的 index.php 中你只需解析 $_SERVER['PATH_INFO']，实例化类`Movies`并调用它的`list`方法，即

```
$args = explode('/', ltrim($_SERVER['PATH_INFO'], '/'));
$className = array_shift($args);
$method = array_shift($args);
require "$className.php";
call_user_func_array(array(new $className(), $method), $args); 
```

然后，您只需将`if-else`块的内容移动到 Movies 类中的两个单独的方法。

```
class Movies { // may extend generic Controller class if you wish

    public function list() {
        $movies = Movie::get_all();
        include 'views/v_list.php';
    }

    public function details($movieId) {
        $movie = new Movie($movieId);
        if ($movie->id > 0) {
            include 'views/v_movie.php';
        } else {
            echo "Movie Not Found";
    }

} 
```

这样你就可以拥有多个控制器，每个控制器都有多个动作。

最后的评论。

*   在数据库方面，使用现有的 ORM 框架之一会很方便。它们将为您节省数天的工作时间，并且可能比手工制作的数据库层表现更好。我还建议处理 PDO 实例的实例化，因为在每个 Model 对象中实例化 PDO 并不是最干净的方式。像`DBFactory::getConnection`会做的事情。

*   您可以考虑返回 HTML 而不是在控制器中回显它。如果您想实现将包装控制器、拦截其输出并对其进行预处理或后处理的*拦截过滤器，这将为您提供极大的灵活性。*拥有一个自动附加 HTML 页眉和页脚的过滤器非常方便。

*   创建自定义框架是非常有趣和宝贵的教育经验，但是我建议使用现有框架之一来完成更严肃的任务。

一切顺利。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-15T18:03:29.337

你做得很好，但我有一些建议：

1.  由于您使用的是 php5，请不要忘记 __autoload 功能。
2.  最好将您的数据层命名为模型。
3.  get_all_from_database 未声明为静态，但您正在静态调用它，这会生成 E_STRICT 级别的警告。设置错误报告（E_ALL | E_STRICT）；你应该看到警告。
4.  get_all() 静态函数应该在 Model 类中（在您的情况下为 Datatier），这样您就不必为每个其他模型重写它。您需要在该函数中进行的唯一更改是替换该行：

    $results = parent::get_all_from_database('movie');

和

```
$results = $this->get_all_from_database(get_class($this)); 
```

这假定模型的名称必须与数据库中表的名称匹配

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-01T08:44:11.357

唯一立即让我感到“奇怪”的事情（尚未提及）是您使用两个 PDO 实例与同一个数据库通信。本身还不错，但是您还要存储用户名、密码和 dsn 的其余部分两次。

这可能只是因为这是发布到网络上的示例代码。

# asp.net - asp.net DataPager，设置 PageIndex

> ID：446517
> 
> 赞同：5
> 
> 时间：2009-01-15T12:15:12.910
> 
> 标签：asp.net

我有一个使用 ListView 显示结果的搜索。我还使用 DataPager 来处理结果的分页。

```
 <asp:DataPager ID="dpProducts" PagedControlID="lvProducts" runat="server" PageSize="12">
                                    <Fields>
                                        <asp:NextPreviousPagerField PreviousPageText="< Prev" NextPageText="" />
                                        <asp:NumericPagerField ButtonCount="10" />
                                        <asp:NextPreviousPagerField NextPageText="Next >" PreviousPageText="" />
                                    </Fields>
                                </asp:DataPager> 
```

这很好用。我的问题是当浏览搜索结果时假设我转到第 3 页。然后我决定进行新的搜索。

现在，显示了新的搜索结果，但我在其中的第 3 页。如果我进行新搜索，我希望 DataPager 的 PageIndex 重置回 0。

有没有办法可以在代码隐藏或 .aspx 页面上执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T20:18:34.977

我想到了。在 _Click 事件中，我必须添加： dpProducts.SetPageProperties(0, int.Parse(ddlNumOfItems.SelectedValue), true);

# svn - Using SVN post-commit hook to update only files that have been committed

> ID：446518
> 
> 赞同：20
> 
> 时间：2009-01-15T12:15:26.607
> 
> 标签：svn, hook, post-commit

I am using an SVN repository for my web development work. I have a development site set up which holds a checkout of the repository.

I have set up an SVN post-commit hook so that whenever a commit is made to the repository the development site is updated:

```
cd /home/www/dev_ssl
/usr/bin/svn up 
```

This works fine but due to the size of the repository the updates take a long time (approx. 3 minutes) which is rather frustrating when making regular commits. What I'd like is to change the post-commit hook to only update those files/directories that have been committed but I don't know how to go about doing this. Updating the "lowest common directory" would probably be the best solution, e.g.

If committing the follow files:

*   /branches/feature_x/images/logo.jpg
*   /branches/feature_x/css/screen.css

It would update the directory: /branches/feature_x/

Can anyone help me create a solution that achieves this?

**Update**:

*   The repository and development site are located on the same server so network issues shouldn't be involved.
*   CPU usage is very low, and I/O should be ok (it's running on hi-spec dedicated server)
*   The development site is approx. 7.5GB in size and contains approx. 600,000 items, this is mainly due to having multiple branches/tags

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T12:36:40.197

You might use **`svnlook dirs-changed`** and **`svn up -N`** to update only the contents of each folder changed:

```
cd /home/www/dev_ssl
svnlook dirs-changed [REPOS] -r [REV] | xargs /usr/bin/svn up -N 
```

Or, if per-file might be better for you (using `sed` to strip action characters):

```
svnlook changed [REPOS] -r [REV] | sed "s/^....//" | xargs /usr/bin/svn up 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-07-30T17:05:14.650

```
#!/bin/bash

REPOS="$1"
REV="$2"

# A - Item added to repository
# D - Item deleted from repository
# U - File contents changed
# _U - Properties of item changed; note the leading underscore
# UU - File contents and properties changed

# Files and directories can be distinguished, as directory paths are displayed with a trailing "/" character.

LOOK=/usr/local/svn/bin/svnlook
SVN=/usr/local/svn/bin/svn
DEV=/var/www/test

cd /var/tmp/svn
  for changes in `$LOOK changed $REPOS | awk '{print $1 "=" $2;}'`;
  do
        len=${#changes}
        idx=`expr index "$changes" =`;
        directory=${changes:$idx};
        action=${changes:0:$idx-1};
        if [ ${changes:len-1} = '/' ]
        then
            case "$action" in
                "A" ) \
                    mkdir --mode=775 -p $DEV/$directory;
                    chown nobody:nobody $DEV/$directory;
                    chmod 775 $DEV/$directory;
                    ;;
                "D" ) \
                    rmdir $DEV/$directory;
                    ;;
            esac
        else
            case "$action" in
                "A"|"U"|"UU" ) \
                    $SVN export --force --non-interactive -r HEAD -q file://$REPOS/$directory;
                    BASE=`basename $directory`;
                    DIR=`dirname $directory`;
                    chown nobody:nobody $BASE;
                    chmod 775 $BASE;
                    mkdir --mode=775 -p $DEV/$DIR;
                    cp -f --preserve=ownership $BASE $DEV/$DIR;
                    unlink $BASE;
                    ;;
                "D" ) \
                    rm -f $DEV/$directory;
                    ;;
            esac
        fi
  done

exit 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T18:17:15.037

For Windows:

```
for /F "eol=¬ delims=¬" %%A in ('svnlook dirs-changed %1 -r %2') do svn export "file:///c:/path/to/repo/%%A" "c:/svn_exports/%%A"  --force 
```

Just copy the above into your post-commit hook batch file (or window for VisualSVN) and you're done - you'll get the updated directory exported to c:\

You could try using %1 instead of c:/path/to/repo above, but I found that it didn't work because VisualSVN give the %1 path with back-slash path separators, and svnlook gives them with forward-slashes. This doesn't seem to work right so I hard-code the repo path (I got "The filename, directory name, or volume label syntax is incorrect" errors)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-25T11:56:31.307

Have a look to this home made script : [http://envrac.blogdns.net/shellscripts/export-automatique-d-un-projet-subversio](http://envrac.blogdns.net/shellscripts/export-automatique-d-un-projet-subversio) !

# sql-server - 存储过程结果表计数

> ID：446519
> 
> 赞同：0
> 
> 时间：2009-01-15T12:16:21.377
> 
> 标签：sql-server

我想知道大量未记录的存储过程中的每一个返回了多少表。

有什么方法可以让我以编程方式获取这些信息？是否有任何统计工具可以为我做到这一点？

编辑 - 明确地说，我正在寻找结果集的数量而不是引用表的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T23:53:12.783

> Is there any way that I can get this information programatically?

Short answer **No**, in SQL server there is no way to get the number of result sets a proc returns because the number of results sets returned by a stored proc can be dynamic and can depend on the values of the parameters passed to the stored procs.

Some stored procs may error out if they receive the wrong inputs.

With that in mind:

*   In pure TSQL there is no way to determine the number of result sets a proc returns, farther more there is no way to capture more than 1 result set using [the insert exec pattern](http://www.sommarskog.se/share_data.html)

*   You could probably fangle something up with SQL CLR that counts the result sets. (You will have to execute the proc with dummy params and rolls back a tran)

*   You could write something in C# or any other client tool that, creates a tran, injects dummy params, executes, counts the result sets and rolls back the transaction.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:47:47.667

我在这里担心的是他要求存储过程返回的表的数量。如果存储过程返回 SQL 选择语句的结果，它很可能会返回来自多个表的数据。在这种情况下，结果集的数量不等于表的数量。

任何可以计算存储过程返回的*表*数量的工具都会非常聪明，因为如果它不想直接执行它们，它可能必须解析存储过程的代码。如果存储过程调用函数或使用 .NET 语言编写，则情况会更加复杂。

一些数据可能被封装在视图中，这将进一步取消对数据的引用（可能甚至更远通过其他视图）。而且（我们都必须不情愿地承认）一些存储过程只是写得不好。

编辑：有趣的是，这个答案一直被否决。它是在问题首次发布时写的，当时他还没有澄清他的问题。当时，我的担忧是有道理的。我不知道他们是否导致他澄清了他的问题，但令人深思的是，人们急于对答案投反对票，却没有提供评论来证明投反对票的合理性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:28:28.123

在 DB2 下：

```
select result_sets from syscat.procedures where procname='...' 
```

给出返回表的估计数量.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T12:28:48.530

您可以构建一个经典的 ADO 包装器来调用存储过程并计算返回的记录集的数量（NextRecordSet 方法）。遍历它们（如果需要，使用数据字典查询来获取列表）并查看。在没有任何其他合适的工具的情况下，您甚至可以在 Excel 中的 VBA 中执行此操作。如果系统上没有安装 ADO 库，请下载并安装适当版本的[MDAC 。](http://www.microsoft.com/downloads/details.aspx?familyid=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T00:12:18.423

The fatal flaw is that the number of result sets returned can be variable based on the logic in the stored procedure.

IF XXXX BEGIN
SELECT xxxx
SELECT xxxx
END
ElSE
BEGIN
SELECT xxxx
SELECT xxxx
SELECT xxxx
SELECT xxxx
END

Side note - if I had written the stored procedures the answer would always be zero or one. I've never found a good design pattern that implemented multiple result sets from one query - it inevitably violates KISS.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T02:50:24.033

```
SET FMTONLY ON 
```

Will probably do what you need.

But this has some limitations - related to temp table usage (the same problems that LINQ and SSIS have when trying to determine what some SPs do).

Remember, there is no 100% reliable way to determine this, since SPs contain code which could mean that the number of result sets is arbitrary (especially if they do a cursor to return subordinate detail result sets based on an initial master result set).

# c# - 如何通过反射代码（c#）设置可空类型？

> ID：446522
> 
> 赞同：23
> 
> 时间：2009-01-15T12:21:16.720
> 
> 标签：c#, reflection

我需要使用反射设置类的属性。

我有一个`Dictionary<string,string>`属性名称和字符串值。

在反射循环中，我需要将字符串值转换为适当的属性类型，同时为每个属性设置值。其中一些属性类型是可为空的类型。

1.  我如何从 PropertyInfo 知道该属性是否为可为空的类型？
2.  如何使用反射设置可为空的类型？

**编辑：** 此博客评论中定义的第一种方法似乎也可以解决问题： [http ://weblogs.asp.net/pjohnson/archive/2006/02/07/437631.aspx](http://weblogs.asp.net/pjohnson/archive/2006/02/07/437631.aspx)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-15T12:31:03.097

1.  一种方法是：

    ```
    type.GetGenericTypeDefinition() == typeof(Nullable<>) 
    ```

2.  只需按照任何其他反射代码设置：

    ```
    propertyInfo.SetValue(yourObject, yourValue); 
    ```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-15T12:31:21.347

为什么你需要知道它是否可以为空？你的意思是“参考类型”还是“ `Nullable<T>`”？

无论哪种方式，对于字符串值，最简单的选择是通过`TypeConverter`，它更容易（更准确）在 上可用`PropertyDescriptor`：

```
PropertyDescriptorCollection props = TypeDescriptor.GetProperties(obj);
// then per property...
PropertyDescriptor prop = props[propName];
prop.SetValue(obj, prop.Converter.ConvertFromInvariantString(value)); 
```

这应该使用正确的转换器，即使设置每个属性（而不是每个类型）。最后，如果你做了很多这样的事情，这允许通过 加速[`HyperDescriptor`](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)，而无需更改代码（除了为类型启用它，只完成一次）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-10-19T13:28:08.257

专门将整数转换为枚举并分配给可为空的枚举属性：

```
int value = 4;
if(propertyInfo.PropertyType.IsGenericType
&& Nullable.GetUnderlyingType(propertyInfo.PropertyType) != null
&& Nullable.GetUnderlyingType(propertyInfo.PropertyType).IsEnum)
{
    var enumType = Nullable.GetUnderlyingType(propertyInfo.PropertyType);
    var enumValue = Enum.ToObject(enumType, value);
    propertyInfo.SetValue(item, enumValue, null);

    //-- suggest by valamas
    //propertyInfo.SetValue(item, (value == null ? null : enumValue), null);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T12:37:19.010

我创建了小样本。如果您对此代码有任何疑问，请添加评论。

**编辑**：根据 Marc Gravell 的精彩评论更新样本

```
class Program
{
    public int? NullableProperty { get; set; }

    static void Main(string[] args)
    {
        var value = "123";
        var program = new Program();
        var property = typeof(Program).GetProperty("NullableProperty");

        var propertyDescriptors = TypeDescriptor.GetProperties(typeof(Program));
        var propertyDescriptor = propertyDescriptors.Find("NullableProperty", false);
        var underlyingType =  
            Nullable.GetUnderlyingType(propertyDescriptor.PropertyType);

        if (underlyingType != null)
        {
            var converter = propertyDescriptor.Converter;
            if (converter != null && converter.CanConvertFrom(typeof(string)))
            {
                var convertedValue = converter.ConvertFrom(value);
                property.SetValue(program, convertedValue, null);
                Console.WriteLine(program.NullableProperty);
            }
        }

    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-06T22:10:04.890

最初，在[MSDN 论坛](http://msdn.microsoft.com/en-us/library/ms366789.aspx)中提到了最佳解决方案。但是，当您需要实现动态解决方案时，如果您不确切知道可以在一个类上声明多少个可为空的字段，最好的办法是检查是否可以将 Nullable<> 类型分配给您通过检查的属性反射

```
protected T initializeMe<T>(T entity, Value value)
{
  Type eType = entity.GetType();
  foreach (PropertyInfo pi in eType.GetProperties())
        {
            //get  and nsame of the column in DataRow              
            Type valueType = pi.GetType();                
            if (value != System.DBNull.Value )
            {
             pi.SetValue(entity, value, null);
            }
            else if (valueType.IsGenericType && typeof(Nullable<>).IsAssignableFrom(valueType)) //checking if nullable can be assigned to proptety
            {
             pi.SetValue(entity, null, null);
            }
            else
            {
             System.Diagnostics.Trace.WriteLine("something here");
            }
            ...
        }
...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-16T13:36:39.907

我使用了以下解决方案，避免使用类型转换器来更好地控制代码。

我写了一个辅助类来支持操作

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Reflection;
using System.Text;

public static class ObjectExtensions
{
    /// <summary>
    /// Enable using reflection for setting property value 
    /// on every object giving property name and value.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="target"></param>
    /// <param name="propertyName"></param>
    /// <param name="value"></param>
    /// <returns></returns>
    public static bool SetProperty<T>(this T target, string propertyName, object value)
    {
        PropertyInfo pi = target.GetType().GetProperty(propertyName);
        if (pi == null)
        {
            Debug.Assert(false);
            return false;
        }

        try
        {
            // Convert the value to set to the properly type
            value = ConvertValue(pi.PropertyType, value);

            // Set the value with the correct type
            pi.SetValue(target, value, null);
        }
        catch (Exception ex)
        {
            Debug.Assert(false);
            return false;
        }
        return true;
    }

    private static object ConvertValue(Type propertyType, object value)
    {
        // Check each type You need to handle
        // In this way You have control on conversion operation, before assigning value
        if (propertyType == typeof(int) ||
            propertyType == typeof(int?))
        {
            int intValue;
            if (int.TryParse(value.ToString(), out intValue))
                value = intValue;
        }
        else if (propertyType == typeof(byte) ||
                propertyType == typeof(byte?))
        {
            byte byteValue;
            if (byte.TryParse(value.ToString(), out byteValue))
                value = byteValue;
        }
        else if (propertyType == typeof(string))
        {
            value = value.ToString();
        }
        else
        {
            // Extend Your own handled types
            Debug.Assert(false);
        }

        return value;
    }
} 
```

**注意：当您设置一个可为空的值（例如 int？，该值需要几乎是整数或可转换类型。您不能在字节上设置 int？所以，您需要正确转换**。请参阅 ConvertValue() 代码，即检查类型 (int) 和相应的可为空类型 (int?) )

这是使用所需数据结构 Dictionary 设置值的代码。

```
 public class Entity
    {
        public string Name { get; set; }
        public byte? Value { get; set; }
    }

    static void SetNullableWithReflection()
    {
        // Build array as requested
        Dictionary<string, string> props = new Dictionary<string, string>();
        props.Add("Name", "First name");
        props.Add("Value", "1");

        // The entity
        Entity entity = new Entity();

        // For each property to assign with a value
        foreach (var item in props)
            entity.SetProperty(item.Key, item.Value);

        // Check result
        Debug.Assert(entity.Name == "First name");
        Debug.Assert(entity.Value == 1);
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T12:30:16.047

检查 Nullable 类型很容易，int？实际上是`System.Nullable<System.Int32>`。因此，您只需检查该类型是否是`System.Nullable<T>`. 设置不应该有所作为，`nullableProperty.SetValue(instance, null)`或者`nullableProperty.SetValue(instance, 3)`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-28T09:52:50.743

这是“可为空”对象类型的最安全解决方案

```
if (reader[rName] != DBNull.Value)

    {
        PropertyInfo pi = (PropertyInfo)d[rName.ToLower()];
        if (pi.PropertyType.FullName.ToLower().Contains("nullable"))
            pi.SetValue(item, reader[rName]);
        else
            pi.SetValue(item, Convert.ChangeType(reader[rName], Type.GetType(pi.PropertyType.FullName)), null);

    } 
```

# .net - ASP.NET MVC 中 runat="server" 标记的状态是什么？

> ID：446533
> 
> 赞同：18
> 
> 时间：2009-01-15T12:24:38.710
> 
> 标签：.net, asp.net-mvc, runatserver

ASP.NET MVC 上的一些文本声明“没有 runat 服务器标签”，甚至这篇 MSDN 文章也这么说，当在该语句的正上方有一个代码示例，其中 HEAD 元素中有一个 runat 服务器标签：

*   [http://msdn.microsoft.com/en-us/magazine/cc337884.aspx](http://msdn.microsoft.com/en-us/magazine/cc337884.aspx)

在我阅读的 StackOverflow 对话中

> “您想要使用“runat=server”控件的事实意味着您应该使用传统的 ASP.NET 应用程序。

当然，在 Site.Master 页面中，ContentPlaceHolders 中有 runat 服务器属性。

就 runat 服务器而言，我看到的 ASP.NET MVC 中唯一缺少的是每个 .aspx 页面/视图上无处不在的 FORM runat="server" 标记。

但是 ASP.NET MVC 中的其余 runat 服务器标签呢，人们说 ASP.NET MVC 没有这些是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T11:06:53.890

如果您在任何元素（例如 DIV）上使用 runat="server" 标记，它将将该代码呈现为已编译页面中的单独**方法**。

如果您要转换“遗留”代码，最好先删除所有 runat 标签，否则您最终会遇到如下代码给您错误的情况。

```
<% foreach (var cat in cats) { %>
    <div runat="server">
         <span class="name"> <%= cat.name %> </span> is a
         <span class="breed"> <%= cat.breed %> </span>
    </div>
 <% } %> 
```

此代码将无法告诉您一些关于`'cat'`超出范围的疯狂。最终，当您查看完整生成的代码时，您会看到它`<div>`已作为其完整的方法生成 - 这当然是一个不同的范围，看不到猫。

回到 MVC 应用程序的默认模板：

您将看到当前模板为您提供了以下内容`head`：

```
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title><%= Html.Encode(ViewData["Title"]) %></title>
    <link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head> 
```

这让我想知道——如果我们使用 <%= 语法将标题直接写入`title`标签——那么我们为什么需要让它运行呢？

事实证明，我怀疑代码隐藏`head`在标题标签内查找现有值（这将在此处由 . 输出`<%= Html.Encode(ViewData["Title"]) %>`。如果找到一个（MVC 模板中的所有示例视图都是这种情况），那么它不会做任何进一步的事情。如果不存在标题（如果 ViewData["Title"] 为 null 或为空），它将默认为您视图中由`Title`属性定义的任何内容：

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/RRMaster.Master" 
Title="View Products" AutoEventWireup="true" CodeBehind="ViewProduct.aspx.cs"
Inherits="RR_MVC.Views.Products.ViewProduct" %> 
```

在我的母版页中，我会删除该`runat='server'`标签 - 因为我认为我永远不想从视图的`Title`属性中填充我的页面标题。但是我暂缓执行 Phil 承诺的关于该主题的博客文章 - 以防 runat 服务器也为我的 CSS 和 JS 提供任何有用的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T12:29:49.260

它们并不意味着您不能使用 runat="server"，而是通常在 MVC 中没有必要使用服务器端控件。如果您发现您需要一个服务器端控件并在代码隐藏中使用它，这表明该应用程序正在回归 Web 表单。通常在您的代码隐藏中发生的所有事情现在都应该在您的控制器或视图逻辑本身中处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T12:48:33.247

只需阅读本教程：

[http://www.asp.net/learn/mvc/tutorial-12-cs.aspx](http://www.asp.net/learn/mvc/tutorial-12-cs.aspx)

你需要

```
<head runat="server"> 
```

能够在您的视图中轻松定义页面标题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-19T21:12:51.227

MVC 只是 Web 表单之上的一层。我的自定义 webforms 控件还要求 head 标签可以在服务器端访问以进行脚本注册。这些自定义控件在客户端呈现，不使用视图状态或服务器端事件。因此，它们也可以在带有 ASPX 视图引擎的 MVC 中使用。

# build-process - 软件发布自动化

> ID：446536
> 
> 赞同：3
> 
> 时间：2009-01-15T12:25:59.500
> 
> 标签：build-process, build-automation

我每天都在更新代码并在每种情况下提交所有更改，因此服务器上始终有可用的新代码。

我想简化的是构建自动化和版本控制。目前我建立一个项目并在每次老板需要时编辑它的名称版本（项目名称vx.xx），这不是时间有效的。

有谁知道保持最新软件版本和相应版本号始终可用的最佳方法是什么？

对于开发，我使用 VS 2008 和颠覆 Tortoise SVN。我尝试将 nant 用于构建自动化，但没有任何经验，也不知道如何在 VS 中编辑版本号或将 Tortoise 的修订号传递给 nant，以便它可以生成带有版本号的项目名称。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T12:55:21.953

使用 subversions 版本号不是最优的。我试过一次，但它失败了，因为变更集编号仅与在该特定变更集中更改的文件有关。

无论如何，我建议为此使用 CruiseControl，因为它能够跟踪与颠覆分开的内部版本号。CC 将一些属性传递给构建脚本，其中包括构建标签，称为“${label}”。在您的 nant 脚本中使用它。

花时间学习 (n)ant 和 CC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:39:16.287

首先，不要尝试使用[SVN 关键字替换](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)来执行此操作。如果您将 $rev$ 关键字放在文件中并使用 svn:keywords 属性启用关键字替换，您将得不到您想要的。您将获得影响包含关键字的文件的最后一个修订，而不是影响项目任何部分的最后一个修订。

正确的方法是使用**svnversion**命令的输出。您可能需要编写一个小脚本来调用此命令，捕获输出，然后使用修订号在某处更新项目文件或源代码文件。

如果您可以依赖正在安装的 TortoiseSVN，一个更简单的替代方法是使用**SubWCRev.exe**实用程序，如下所示：

```
SubWCRev.exe . VersionInfo.template VersionInfo.cs 
```

对于 C# 项目，VersionInfo.template 看起来像这样：

```
using System.Reflection;

[assembly: AssemblyVersion("2.0.0.$WCREV$")]
[assembly: AssemblyFileVersion("2.0.0.$WCREV$")] 
```

警告：Windows 版本号由 4 个数字组成，每个数字限制为 16 位。**Subversion 版本号很容易变得比这更大。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:41:35.553

我正在自己自动化这个过程。仍在探索选项，但这似乎简单可靠：

*   在全局 VC 6.0 工作区中创建一个名为“_FULL_BUILD_”的“实用程序”项目。

*   _FULL_BUILD_ 没有自己的文件，但它依赖于所有其他项目，确保它们都得到（重新）正确构建。

*   一个早期依赖项是另一个实用程序项目，它使用[http://sourceforge.net/projects/unxutils](http://sourceforge.net/projects/unxutils)中的 sed.exe来增加版本，该版本存储在自己的文件中，必要时：

    *   对于调试版本，只需增加版本号。
    *   对于发布版本，增加版本号的最后一部分。
    *   主要/次要版本需要手动编辑。

“魔法”是空的实用程序项目，它还允许您创建自定义构建规则，（例如）可能会将整个项目复制到您的 QA 团队的放置点。

如果您找到更好的解决方案，请告诉我们。

祝你好运！

# web-services - 使用 Windows 凭据的 B2B Web 服务？

> ID：446537
> 
> 赞同：0
> 
> 时间：2009-01-15T12:26:15.490
> 
> 标签：web-services, windows-authentication

这是明智的，您可能会遇到哪些潜在问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T17:53:00.350

你需要更具体一点。这个问题相当笨拙，需要做出很多假设才能给你一个直接的答案。

您是在谈论使用 LDAP 或 AD 管理身份验证/授权吗？

或者您是在谈论使用登录时生成的 kerberos 密钥对 Web 应用程序进行身份验证，并且该 Web 应用程序使用该密钥传递给 Web 服务？

# c# - 在具有已定义命名空间的“项目”中使用公共静态类

> ID：446539
> 
> 赞同：1
> 
> 时间：2009-01-15T12:27:24.523
> 
> 标签：c#, asp.net, static

过去，我并没有真正使用过命名空间，但在这个项目中，我使用的是 SourceSafe，它需要一个项目，它将所有内容都放在命名空间中......

过去，我只能在 App_Code 文件夹中创建一个公共静态类并从我的应用程序中的任何位置访问它，但现在我似乎无法这样做。

例如，我的 default.aspx.cs 如下所示：

```
namespace Personnel_Database
{
    public partial class _default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
              utils.someFunction();//this does not work 
```

我的 utils.cs 类看起来像这样：

```
namespace Personnel_Database.App_Code
{
    public static class utils
    { 
```

我怎样才能拥有它，以便我可以在我的默认值中调用**util.someMethod() ？**假设这是一个命名空间问题，我错了吗？我只希望**utils.cs在命名空间****Personnel_Database**中全局可用

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T12:31:48.867

您可以使用 using 指令包含命名空间：

```
using Personnel_Database.App_Code;
// now you can use everything that is inside the Personnel_Database.App_Code namespace
namespace Personnel_Database
{
  ... 
```

或者您使用 utils 类的完全限定名称（包括其命名空间），例如：

```
 protected void Page_Load(object sender, EventArgs e)
  {
    Personnel_Database.App_Code.utils.someFunction();
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T12:32:00.363

您只需要添加：

```
 using Personnel_Database.App_Code; 
```

到代码隐藏文件的顶部。如果您需要在标记中访问它，您可以使用以下命令导入它：

```
 <%@ Import Namespace="Personnel_Database.App_Code" %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T12:32:10.067

您需要 Personnel_Database Personnel_Database 类文件中的 using 语句，即

```
using Personnel_Database.App_Code; 
```

Google/MSDN 用于 using 声明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T12:33:15.073

我错了，如果我改为使用 Utils 类：

```
namespace Personnel_Database
{
    public static class utils    
    { 
```

它确实有效，但在智能感知中没有显示，我怎样才能让它做到这一点？

# sql - sql参数保护你免受什么影响？

> ID：446551
> 
> 赞同：3
> 
> 时间：2009-01-15T12:30:19.930
> 
> 标签：sql, database, security, parameters

参数用于保护您免受恶意用户输入的影响。

但是如果参数需要一个字符串，是否可以编写将被解释为 sql 的输入，以便恶意用户可以使用诸如 'DROP'、'TRUNCATE' 之类的东西......？

asp、asp.net、java等中的参数保护有区别吗？

* * *

另请参阅：[参数真的足以防止 SQL 注入吗？](https://stackoverflow.com/questions/306668/are-parameters-really-enough-to-prevent-sql-injections)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-15T12:35:01.933

如果参数化查询是幕后的字符串，则参数化查询通常会引用该参数，以便正常的 SQL 运算符不会被解释为这样。这意味着即使用户输入了潜在的恶意数据，它也会被简单地视为字符串输入，而不是解释为 SQL 运算符/命令。

它在各种框架中的实现方式可能存在技术差异，但基本思想（和结果）是相同的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-15T12:40:22.373

你需要小心你的定义。“参数”可能意味着很多东西；例如，存储过程的参数本身并不能保护您。以 Java 为例：

```
sql = "exec proc_SearchForUser '" + userNameToSearch + "'"; 
```

不比生的好或差

```
sql = "SELECT * FROM Users WHERE userName = '" + userNameToSearch + "'"; 
```

并且同样容易受到用户名的影响

```
';DROP TABLE users;-- 
```

另一方面，参数化查询是安全的。他们可能看起来像

```
PreparedStatement statement = con.prepareStatement("SELECT * FROM Users WHERE userName = ?"); 
```

或者确实

```
PreparedStatement statement = con.prepareStatement("exec proc_SearchForUser ?"); 
```

这是安全的原因是因为当您填写值时......使用，比如说，

```
statement.setString(1, userName); 
```

那么字符串——即使是像“';DROP TABLE users;--”这样的字符串——将被数据库引擎正确转义并呈现无害。

仍然有可能把它搞砸——例如，如果你的存储过程只是在内部构建一个 SQL 字符串并执行它，信任输入——但是带有参数的准备好的语句意味着没有未转义的数据将完全到达数据库服务器切断该攻击向量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T12:35:06.723

不会。任何 SQL 数据库中的任何语言都可能发生 SQL 注入攻击。您所指的攻击类型是程序员在其源代码中使用动态 SQL，例如“USER_NAME = sName”，并且用户可以为用户名输入无限的文本，以便他们可以附加注释，然后键入任何新的 SQL 语句，例如“删除”、“截断”等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T12:37:52.287

您通过 BindWhatever() 调用作为参数输入的任何内容都不能作为 SQL 执行。

在绑定 ht 变量数据之前，SQL 已经被解析和评估，因此这些数据根本不可能被误认为是 SQL。

当然，当数据库将忠实地存储并可能在其他人的浏览器上执行时，仍然有人可以向您传递一些 JavaScript！

因此，您仍然需要摆脱输入（或至少转义）任何 ({[]})\ 类型的字符；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T12:33:02.297

不作为参数。SQL 注入依赖于将恶意代码连接到 SQL 字符串中，然后从该字符串执行 SQL 语句。无论内容如何，​​准备好的语句都带有参数。使用准备好的语句，SQL 语句本身的实际文本永远不会改变。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T12:33:53.167

唯一的风险是如果您`exec`对参数化字符串执行 an 。

在所有其他情况下，参数化查询是安全的。

# c++ - 抛出异常时获取堆栈跟踪

> ID：446565
> 
> 赞同：4
> 
> 时间：2009-01-15T12:34:49.187
> 
> 标签：c++, visual-studio-2008, debugging

我现在正在调试一个使用许多不同线程的程序。

有一个不时抛出的异常。问题是没有办法知道是什么线程导致了问题......

有谁知道抛出异常后获取堆栈跟踪的简单方法？我想过简单地编写一个调试消息，但这将是一个巨大的:-)我想有比这个更好的技术......

我正在使用 Visual Studio 2008 - 本机 C++ 项目....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T12:51:21.930

除非我大错特错，否则您需要知道哪个线程触发了异常才能使用 Visual Studio 调试器的调用堆栈视图，这显然是您目前所处的 catch-22 情况。

我会尝试的一件事是查看是否可以在抛出异常时让调试器中断（使用调试>异常）。您必须显式启用此功能，但如果您知道抛出什么类型的异常，这可能会让您找出它在哪里抛出。

除此之外，在异常的构造函数中放置一个断点（如果它是您自己的）也应该允许您确定它是从哪里触发的。

如果这些方法对您不起作用，我会按照您的建议查看调试消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T17:20:38.347

使用Microsoft 免费的[WinDBG](http://www.microsoft.com/whdc/devtools/debugging/default.mspx "微软：Windows 调试工具")可以轻松实现这一点。如果您还没有符号，您还需要为您的[Windows](http://www.microsoft.com/whdc/devtools/debugging/symbolpkg.mspx#d "Microsoft：Windows 的符号包")版本安装符号。

只需将 WinDBG 设置为您的故障转储工具。我使用此注册表设置：（*您可能希望编辑路径*）

### 样品`CrashDumpSettings.reg`：：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug]
"Auto"="1"
"Debugger"="C:\\progra~1\\debugg~1\\cdb.exe -p %ld -e %ld -g -y SRV*c:\\mss*http://msdl.microsoft.com/download/symbols -c \"$<c:\\Dumps\\CrashDump.cdbscript\"" 
```

这是你的`CrashDump.cdbscript`样子：（*这基本上是我使用的......根据需要编辑路径。*）

### 样品`CrashDump.cdbscript`：：

```
.sympath+ c:\windows\symbols;c:\some\path\to\symbols\for\your\project

as /c CrashFirstModule .printf "%mu", @@c++((*(ntdll!_LDR_DATA_TABLE_ENTRY**)&@$peb->Ldr->InLoadOrderModuleList.Flink)->BaseDllName.Buffer) 

.logopen /t c:\dumps\${CrashFirstModule}_process.log
.kframes 100
!analyze -v
~*kv
lmv
.logclose

.dump /mhi /u /b c:\dumps\${CrashFirstModule}_mini.cab
.dump /mhia /u /b c:\dumps\${CrashFirstModule}_full.cab

q 
```

当 WinDBG 发生异常时，您会得到一个不错的日志文件和一些转储，您可以使用这些转储来查看进程的状态。日志文件将对发生的错误进行分析，包括导致错误的代码行。它还将列出每个线程的调用堆栈。在调用堆栈列表中，`#`编号旁边的线程是导致异常的线程。这些文件中有大量信息。我建议选择John Robbins[的 Microsoft .Net 和 Microsoft Windows 调试应用程序。](https://rads.stackoverflow.com/amzn/click/com/0735615365 "亚马逊：为 Microsoft .Net 和 Microsoft Windows 调试应用程序")这是一本关于调试的好书，即使它是几年前的。您可以以大约 20.00 美元的价格从亚马逊购买它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T13:54:28.170

这个库看起来很符合要求：

[http://www.codeproject.com/KB/threads/StackWalker.aspx](http://www.codeproject.com/KB/threads/StackWalker.aspx)

Jochen Kalmbach 看起来在包装低级 dbghelp.dll 接口的复杂性方面做得非常彻底。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T16:13:28.403

您可以在异常构造函数中放置一个断点（即您将要抛出的对象）。

这当然假设您有一个共同的异常层次结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T12:54:12.410

您可以使用异常对话框（`Debug`|`Exceptions...`菜单项，或`Ctrl+Alt+E`，`Ctrl+D E`取决于您的键盘绑定）在抛出特定异常时将正在运行的代码中断为调试吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T14:24:31.867

如果你不能让调试器捕捉正在发生的事情......并且你不能 printf 堆栈跟踪和线程......

我的猜测是，您将不得不投入一些好的肘部油脂和辛勤工作。从了解系统开始。了解系统后，尝试将系统分成两半。有效的部分和无效的部分。然后继续尝试这样做，直到您深入解决问题。

当您深入研究时，尝试使用 try/catch... 包围可疑代码...希望您可以使用调试器停止执行并查看发生了什么。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-15T12:50:52.667

异常本身具有 StackTrace... 属性，因此您只需要返回 ToString()。

但我相信您的问题更像是如何捕获随机异常。如果是这样，我所做的就是将所有主要代码放在 try/catch 中。我真的不太确定是否在其他线程中引发了异常，这种技术是否可行。

您还应该捕获一个 ApplicationExeption，它不是从 Exception 派生的。

# c# - 是否可以定义 在依赖 dll 的应用程序配置中

> ID：446570
> 
> 赞同：2
> 
> 时间：2009-01-15T12:36:01.680
> 
> 标签：c#, configuration, configsection

我有一个用于应用程序的自定义 .NET 插件，我正在尝试为插件的配置文件创建 configSections。问题是如果使用 OpenMapperExeConfiguration/OpenExeConfiguration 加载配置，我无法阅读该部分。

这是我的配置文件（MyTest.dll.config）

```
<configuration>
  <configSections>
    <section name="test" type="MyTest, Test.ConfigRead"/>
    </configSections>
    <test>
            ..Stuff here
        </test>
    <appSettings>
        <add key="uri" value="www.cnn.com"/>
    </appSettings>
</configuration> 
```

这是我访问测试configSection的代码示例

```
ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();  
fileMap.ExeConfigFilename = Assembly.GetExecutingAssembly().Location + "config";    
Configuration applicationConfig = ConfigurationManager.OpenMappedExeConfiguration(fileMap,ConfigurationUserLevel.None);
//Using OpenExeConfiguration doesnt help either.
//Configuration applicationConfig = ConfigurationManager.OpenExeConfiguration(Assembly.GetExecutingAssembly().Location);
//Accessing test section
applicationConfig.GetSection("test");

//Accessing AppSettings works fine.
AppSettingsSection appSettings = (AppSettingsSection)applicationConfig.GetSection("appSettings");
appSettings.Settings["uri"].Value; 
```

如图所示 appsettings 值可以很好地读取。除了主应用程序的配置文件之外，是否可以在任何其他配置中包含 configSections？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-28T02:23:58.057

你错过了一个'。分隔符？

```
fileMap.ExeConfigFilename = Assembly.GetExecutingAssembly().Location + "config"; 
```

添加“。”：

```
fileMap.ExeConfigFilename = Assembly.GetExecutingAssembly().Location + ".config"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:04:54.540

配置设置适用于应用程序（app.config 位于应用程序的根目录中，用于 .EXE，Web 根目录用于 Web 应用程序）和机器（machine.config 位于 [System Root]\Microsoft.NET\Framework[CLR Version]\CONFIG）级别.

唯一使用的其他配置文件是策略配置文件，它用于创建程序集版本控制策略并通过使用 AL 工具链接到程序集。这显然是你不想做的。

尝试将插件的配置部分合并到当前应用程序的配置部分中，以创建一个应用级别的配置文件，或者将它们放在 machine.config 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-19T20:44:32.957

正如您在问题中提到的那样，这不起作用。

您可能会觉得您能够加载 DLL.Config 文件，但应用程序并未加载该文件，但它可能工作正常，因为您在应用程序 app.config 中有相同的 appsettings 部分。默认情况下，每个 appdomain 都有一个配置文件，并且大多以 exe 命名（因此名称将是**applicationname.exe.config**。

默认情况下，这是 .net 框架加载的用于读取配置的文件。因此，我不建议维护 .dll.config 文件

现在您有两种选择来实现您想要实现的目标：

**选项 1：您可以为每个 ConfigurationSection 维护单独的配置文件**

从 ConfigurationSection 继承的每个类都有一个名为“configSource”的属性。在主 application.exe.config 中，您可以指定自定义部分，如下所示：

```
<CustomSection configSource="{relative file name}" />
<appSettings file = "relative file name" /> 
```

这样，您可以将配置部分拆分为多个配置文件，并且您仍然可以使用常规 system.configuration 语法访问它们。

有关更多详细信息，请参阅[此](http://www.tomdupont.net/2015/05/split-appconfig-into-multiple-files.html)。

**选项 2：更改默认 exe**

默认配置文件名为 application.exe.config。可以使用以下语法进行更改

```
AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", path); 
```

这样，您可以将任何其他 xml 文件设置为程序的配置文件。
请注意，您必须在首次调用配置类之前调用​​此 SetData 方法（即在系统读取配置文件之前）。您可以将 .dll.config 设置为应用程序配置文件，并且可以从那里读取所有配置部分。有关选项 2 的更多详细信息，请参阅[此内容。](https://www.codeproject.com/Tips/385064/Making-a-component-dynamically-load-the-config-fil)

希望这能提供足够的信息。

# apache - 在单个 Windows 2003 机器上安装多个 Apache 实例

> ID：446571
> 
> 赞同：4
> 
> 时间：2009-01-15T12:36:25.003
> 
> 标签：apache

在我的服务器上，我安装了一个带有 Apache 服务包的 Web 应用程序。因此，所有与 apache 相关的 dll 都位于应用程序文件夹的子目录中（例如，C:\Program Files\MyWebApp\apache2）。似乎当 Windows 2003 服务器启动时，所有请求都将由该 apache 服务提供服务。

现在我想将另一个 Apache 和 MYSQL、PhP 实例安装到默认程序文件夹（例如 C:\Program Files\Apache Service Foundation 等），但是在安装时我无法配置它——没有办法得到第二个 Apache 服务启动并运行。

当我安装第二个 Apache 时，我将网络域名设置为“pm2”，并选择端口 8080 选项。但是，当 apache 安装完成后，当我输入[http://pm2:8080](http://pm2:8080)时，我得到一个页面无法显示的错误。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-17T09:37:19.883

原来的网站还能用吗？如果是这样，则 apache 的第二次安装可能会尝试将自身安装为与第一个实例同名的服务，因此失败。

要将 apache 安装为第二个服务，请使用：

```
httpd -k install -n "Apache Instance 2" -f "C:\Program Files\Apache Service Foundation\path\to\your\conf file.conf" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-02T19:08:35.113

我知道这是一个老问题，但通常你不需要启动 Apache 的第二个**进程**，更不用说**安装**程序的第二个副本了。查看 Apache 手册，特别是在**Listen**和**VirtualHost**中了解详细信息。

*如果服务器端*的某些要求存在版本冲突，那么这可能不适用于您的情况，您的帖子中并不清楚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T09:52:12.833

几个想法：

*   您是否在您的 DNS 服务器或主机文件中添加了一个条目以确保 PM2 将访问正确的服务器？
*   尝试从命令行启动第二个 Apache 实例，这样您将在控制台上显示错误消息，以便您查看是否有任何错误阻止它正常启动。

# .net - Ftp GetFileSize 随机抛出 FTP 错误 503（错误的命令序列）

> ID：446574
> 
> 赞同：2
> 
> 时间：2009-01-15T12:37:06.390
> 
> 标签：.net, ftp, size

要获取文件列表中每个文件的文件大小，我使用以下代码：

```
foreach (String f in files)
{
  UriBuilder ftpUri = new UriBuilder("ftp", ftpServer, -1, ftpPfadZuLogDateien + "/" + f);
  FtpWebRequest ftpclientRequest1 = (FtpWebRequest)WebRequest.Create(ftpUri.Uri);
  ftpclientRequest1.Method = WebRequestMethods.Ftp.GetFileSize;
  ftpclientRequest1.Credentials = new NetworkCredential(ftpLoginName, ftpPassword);
  FtpWebResponse response1 = (FtpWebResponse)ftpclientRequest1.GetResponse();
  long filesize = response1.ContentLength;
  response1.Close();
  // store the file size somewhere
} 
```

如果列表中只有几个文件，这通常有效。但是在这些请求中的一些（有时是 10 个，有时是 100 个）连续之后，GetResponse() 会抛出错误 503（Bad Sequence of Commands）。

这个错误想告诉我什么？我查询太快了吗？忘记清理任何资源？
我能做些什么呢？

附加信息：
在连接上设置 KeepAlive=false 使其在第二次请求时失败，错误为 550（找不到文件/访问被拒绝？）。
设置 UsePassive=false 并没有改变任何东西。
设置 UseBinary=true 并没有改变任何东西。
在键盘上敲击我的头并没有改变任何东西。

[更新] beckr.org 提供了一个答案 - 因为它隐藏在链接和大量文本后面，这里是简短版本：我更改了源代码，所以我会重用 NetworkCredentials：

```
NetworkCredential myCredentials = new NetworkCredential(ftpLoginName, ftpPassword);
foreach (String f in files)
{
  UriBuilder ftpUri = new UriBuilder("ftp", ftpServer, -1, ftpPfadZuLogDateien + "/" + f);
  FtpWebRequest ftpclientRequest1 = (FtpWebRequest)WebRequest.Create(ftpUri.Uri);
  ftpclientRequest1.Method = WebRequestMethods.Ftp.GetFileSize;
  ftpclientRequest1.Credentials = myCredentials;
  FtpWebResponse response1 = (FtpWebResponse)ftpclientRequest1.GetResponse();
  long filesize = response1.ContentLength;
  response1.Close();
  // store the file size somewhere
} 
```

这样，一切都像它应该的那样工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T11:21:09.547

使用 Wireshark 进行跟踪 - 状态码是 503，但消息很可能是不同的。在我的例子中，FtpWebRequest 每隔 3 个左右就使用 USER xyz 重新验证一次，这导致服务器 (ProFTPD) 回复“503 You are already logged in”，这导致 FtpWebRequest 退出。请参阅 Microsoft 的反馈，了解为什么会发生这种情况，网址为[http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/9f0510f9-fa39-4aa4-8bd5-afb926282144/](http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/9f0510f9-fa39-4aa4-8bd5-afb926282144/)。如果微软会（正确地）开源东西，我不会有这个错误的问题，因为我可以自己修复它，提供一个补丁，它很可能会进入进一步的版本。但这不是微软的工作方式。现在查看[http://sourceforge.net/projects/dotnetftpclient/](http://sourceforge.net/projects/dotnetftpclient/)。

# c - C 编程入门

> ID：446589
> 
> 赞同：9
> 
> 时间：2009-01-15T12:41:53.777
> 
> 标签：c

我来自基于 PHP 的背景，我的新年决心是听 Joel 并学习 C。

我正在使用基于 Windows 的 PC，虽然我将从控制台应用程序开始，但我不介意稍微关注 Windows 方面的编程。

*   我可以使用什么编译器，为什么？
*   我可以使用什么 IDE，为什么？
*   还有哪些其他工具对初学者 C 程序员有用？
*   有免费的在线指南吗？

我试图寻找 SO 问题，但 C 标签在 Hot list 上没有好的问题，但如果您知道一些与此相关的好的 SO 问题，请不要犹豫，在下面添加它。

所以帖子

*   [**在 K&R 之外学习 C 有哪些好的资源**](https://stackoverflow.com/questions/257416/what-are-some-good-resources-for-learning-c-beyond-kr)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-15T13:06:19.530

我将按顺序回答您的问题：

*   **我可以使用什么编译器，为什么？**- 一般来说，Unix世界上的gcc，既然你说你不介意Windows，最新版本的MSVC（2008）。虽然它不支持C99。（记得更改项目设置以编译为 C。）
*   **我可以使用什么 IDE，为什么？**- 我听说过关于 Eclipse 的好消息，但自从我在 Windows 上之后，我从来没有深入了解它，而且 Windows 的 gcc 选项......不是很出色。MSVC 2008 不错，但 Intellisense 不如 C#，尽管它在 C 中不如在 C++ 中重要。我听说他们正在为 2010 年解决这个问题。
*   **还有哪些其他工具对初学者 C 程序员有用？**- 将警告级别调高到编译器支持的最大值。（达到合理的标准。）这将帮助您保持良好的编码实践。
*   **有免费的在线指南吗？**- 是的。我不知道有什么非常好的。获取[K&R 第 2 版。](https://rads.stackoverflow.com/amzn/click/com/0131103628)这是该语言的创造者写的一本很棒的书，而且也很短。

还有一点建议：首先尝试坚持并学习标准 ANSI C，远离专有扩展。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-15T12:50:18.203

您可以尝试使用[Visual Studio Express C++ Edition](http://www.microsoft.com/express/vc/)。您可以轻松编写 C 代码并使用 C++ 编译器对其进行编译。我会买一份 K & RC 并完成它。

编辑：作为 Visual Studio 的替代方案，您可以查看[MinGW。](http://www.mingw.org/) 这是一个基于GCC的Win32开发系统。这一点在 Visual Studio 上的主要声名是，以 unix 为中心的 C 资源在这方面会比在 Win32 上工作得更好，因为它具有许多主要 Unix 库的端口或克隆，这些库可能在 Visual Studio 中可用也可能不可用，或者如果没有一些移植工作，可能无法完全兼容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T12:46:18.167

有关C 编程的书籍和在线资源列表，当然还有[K&R](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book)) ，请参阅[此 stackoverflow 帖子。](https://stackoverflow.com/questions/257416/what-are-some-good-resources-for-learning-c-beyond-kr)- 这实际上是一本很好的书，而且很短。Win32 上的经典 C 作品是 Petzold 的[Programming Windows](http://www.charlespetzold.com/pw5/)。

**编辑：**根据我对 tvanoffsson 帖子的补充，[MinGW](http://www.mingw.org/)套件非常适合控制台应用程序。另外，我的一个朋友在几年前写了一篇[C 编程教程](http://web.ift.uib.no/Fysisk/Teori/KURS/OTHER/newzealand.html)，这在当时非常有名，并且偶尔会出现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T13:01:40.617

我会在 Windows 上启动 MinGW（或 Cygwin），或者在 *nix 上启动 Gcc。如果你想学习 C 编程，IDE 可以让你远离编译的重要过程。

学习像 C 这样的语言就像其他所有语言一样。从几个简单的“Hello, World”程序开始并理解它们。转移到你需要实现的小事情上。您将很快熟练掌握核心语言；它非常小，在您刚开始时，您只需要真正了解几件事（指针<=>数组对偶性就是其中之一）。

了解开发的预处理、编译和链接阶段。对于你好世界，它很简单

```
gcc hello_world.c 
```

但是在任何大型程序中，您都会执行单独的编译/链接阶段。像 MSVC 这样的 IDE 会为您处理这个问题，但您仍然需要注意这一点。

无论如何，要找到一个具有良好语法高亮显示的好 IDE，但一开始只使用编辑器功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T17:02:42.330

> *   我可以使用什么编译器，为什么？

我必须同意，首先手动创建和运行程序（没有 IDE 的帮助）将是有益的，即使它只是用于您最初的几个小程序。如上所述，GCC 是非常标准的。

> *   我可以使用什么 IDE，为什么？

我开始使用 DevC++（它很容易使用）。然后，根据您的方向，您将需要选择更复杂的 IDE（例如 Visual Studio）。

> *   还有哪些其他工具对初学者 C 程序员有用？

**您的 IDE 调试器！**与其到处放置“printf”语句（就像许多初级 c 程序员所做的那样），不如学习如何使用 IDE 的调试器。从长远来看，它将为您节省很多时间:)

> *   有免费的在线指南吗？

吨。快速谷歌搜索“c 编程”将返回大量数据。**但是，如果您真的想深入了解，我建议您搜索常见的 C 编程大学课程前缀（例如 COP3223）。**如果您稍微窥探一下，您将能够找到一些非常有益的很棒的讲义！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T13:27:59.563

在 K&R（又名我 CS 课上的圣经）之后，我会推荐这本书：[link text](https://rads.stackoverflow.com/amzn/click/com/0131774298 "专家 C 编程") 它涵盖了 C 的一些棘手部分，并且写得很好。您甚至可以获得结业证书。你怎么能打败它！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-26T09:15:23.413

> 我可以使用什么编译器，为什么？

GCC，因为它是通用的：您可以在 Windows、OS X、Linux、Solaris、Haiku 以及您提到的任何东西上以及任何类型的 CPU（即架构）上以及*任何*类型的 CPU 上运行它。GCC 永远不会让您的编译器特定技能过时。

对于 Windows，那就是 MinGW。

> 我可以使用什么 IDE，为什么？

Emacs。按 tab 一次，emacs 会自动以正确的方式缩进。使用 Ctrl*字母*和 Alt*字母*可以毫不费力地在文本中移动，而不是将您的手一直移动到箭头键或向上/向下翻页（尽管您确实有该选项）。是的，这听起来很奇怪，但是一旦你掌握了窍门，这将是一个福音。颜色看起来很漂亮，也很容易阅读（不像 vim 的深蓝黑色注释）。

您可能喜欢[ecb-minor-mode](http://ecb.sourceforge.net/)，它与[window-numbering](http://www.emacswiki.org/emacs/window-number.el)配合得很好。此外，在 irc.freenode.net 上还有一个很棒的 IRC 频道 #emacs。

> 还有哪些其他工具对初学者 C 程序员有用？

一个调试器。请注意，gdb 需要一些时间来学习，但是非常好。

另外：瓦尔格林。对于检查程序中有关动态分配内存的错误非常有用。对于查找线程错误（如果需要）也非常有用。

> 有免费的在线指南吗？

他们来来去去。我踢了这个，让谷歌给出答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T12:54:40.193

MicroSofts Visual Studio Express（现在是一些 .net 包的一部分）是一个出色的 IDE/编译器工具集，几乎可以免费下载！

我还推荐 Kernigen 和 Ritchies “The C programming language”，这是 C++ 之前关于 C 的权威书籍，也是有史以来最好的技术著作之一。

避免使用 Bjarne Soustrups “C++”一书，这是一本非常难读的书，更多地是关于如何/为什么定义编程语法，而不是如何使用语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T12:56:12.170

[使用 C++ 编译器](https://stackoverflow.com/questions/446589/getting-started-in-c-programming#446610)的唯一问题是它不是直接的 C，但我建议学习 C++ 只是作为 C 学习的好方法。我建议无论 Joel 说什么都学习 C++....因为他可能认为他们一样。指针，指针，指针……

如果你偏向于直接 C，我会推荐[这本 C 书。](https://stackoverflow.com/questions/257416/what-are-some-good-resources-for-learning-c-beyond-kr#258003)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-15T13:14:52.663

如果您将使用 K&R C（您应该这样做），您将要使用的编译器选项是 gcc。您可以通过[Cygwin](http://www.cygwin.com//)做到这一点，如果您还没有对 *nix 有基本的熟悉程度，这也将帮助您提高 Unix 技能。

对于初学者来说，在这里使用 IDE 绝对是矫枉过正。因此，我建议学习使用 vi、emacs、pico 或 joe。Cygwin 也提供所有这些，您选择哪一个应该是个人喜好问题。每个都有自己的学习曲线。稍后，您可能会发现您更喜欢其中一个编辑器而不是 Visual Studio（或任何其他 IDE）。

学习在没有 IDE 的情况下完成所有这些是一个很好的练习。

然而，最后，最重要的不是您担心平台，而是您拿起工具并开始使用它们。没有其他的学习方法。

# javascript - 使用 jQuery 中止 Ajax 请求

> ID：446594
> 
> 赞同：1928
> 
> 时间：2009-01-15T12:45:18.527
> 
> 标签：javascript, jquery, ajax

是否有可能使用 jQuery，我**取消/中止**尚未收到响应的 Ajax 请求？

* * *

## 回答 #1

> 赞同：1818
> 
> 时间：2009-01-15T12:56:49.923

大多数 jQuery Ajax 方法返回一个 XMLHttpRequest（或等效的）对象，因此您可以只使用`abort()`.

请参阅文档：

*   [中止方法](http://msdn.microsoft.com/en-us/library/ms535920%28VS.85%29.aspx)( [MSDN](http://en.wikipedia.org/wiki/Microsoft_Developer_Network) )。取消当前的 HTTP 请求。
*   [中止（）](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort)（[MDN](http://en.wikipedia.org/wiki/Mozilla_Developer_Network)）。如果请求已经发送，此方法将中止请求。

```
var xhr = $.ajax({
    type: "POST",
    url: "some.php",
    data: "name=John&location=Boston",
    success: function(msg){
       alert( "Data Saved: " + msg );
    }
});

//kill the request
xhr.abort() 
```

**更新：** 从 jQuery 1.5 开始，返回的对象是名为 jqXHR 的原生 XMLHttpRequest 对象的包装器。这个对象似乎暴露了所有的本地属性和方法，所以上面的例子仍然有效。请参阅*[jqXHR 对象](http://api.jquery.com/jQuery.ajax/#jqXHR)*（jQuery API 文档）。

**更新 2：** 从 jQuery 3 开始，ajax 方法现在返回一个带有额外方法的承诺（如 abort），因此上述代码仍然有效，尽管返回的对象不再是一个`xhr`。请参阅[此处的 3.0 博客](http://blog.jquery.com/2016/01/14/jquery-3-0-beta-released/)。

**更新 3**：`xhr.abort()`仍然适用于 jQuery 3.x。不要假设*更新 2*是正确的。[有关 jQuery Github 存储库的更多信息](https://github.com/jquery/jquery/issues/2084#issuecomment-308173243)。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-01-15T12:55:31.767

您无法撤回请求，但您可以设置超时值，之后将忽略响应。有关 jquery AJAX 选项，请参阅此[页面](http://docs.jquery.com/Ajax/jQuery.ajax#options)。我相信如果超过超时期限，您的错误回调将被调用。每个 AJAX 请求已经有一个默认超时。

您也可以在请求对象上使用[abort()](https://developer.mozilla.org/en/DOM/XMLHttpRequest#abort%28%29)方法，但是虽然它会导致客户端停止侦听事件，但它~~可能~~不会阻止服务器处理它。

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2009-01-15T12:56:22.997

这是一个**`asynchronous`**请求，这意味着一旦它被发送，它就在那里。

如果您的服务器由于`AJAX`请求而启动非常昂贵的操作，您可以做的最好的事情是打开您的服务器以侦听取消请求，并发送一个单独的`AJAX`请求通知服务器停止它正在做的任何事情。

否则，只需忽略`AJAX`响应。

* * *

## 回答 #4

> 赞同：77
> 
> 时间：2012-03-28T11:34:27.030

将您所做的调用保存在一个数组中，然后在每个调用上调用 xhr.abort()。

巨大的警告：您可以中止请求，但这只是客户端。服务器端可能仍在处理请求。如果您将 PHP 或 ASP 之类的东西用于会话数据，则会话数据将被锁定，直到 ajax 完成。所以，要让用户继续浏览网站，就必须调用**session_write_close** ()。这将保存会话并将其解锁，以便其他等待继续的页面继续进行。没有这个，几个页面可能会等待锁被移除。

* * *

## 回答 #5

> 赞同：69
> 
> 时间：2014-01-18T12:55:07.040

AJAX 请求可能不会按照它们开始的顺序完成。您可以选择*忽略*除最新响应之外的所有 AJAX 响应，而不是中止：

*   创建计数器
*   发起 AJAX 请求时增加计数器
*   使用计数器的当前值来“标记”请求
*   在成功回调中，将标记与计数器进行比较以检查它是否是最近的请求

粗略的代码大纲：

```
var xhrCount = 0;
function sendXHR() {
    // sequence number for the current invocation of function
    var seqNumber = ++xhrCount;
    $.post("/echo/json/", { delay: Math.floor(Math.random() * 5) }, function() {
        // this works because of the way closures work
        if (seqNumber === xhrCount) {
            console.log("Process the response");
        } else {
            console.log("Ignore the response");
        }
    });
}
sendXHR();
sendXHR();
sendXHR();
// AJAX requests complete in any order but only the last 
// one will trigger "Process the response" message 
```

[jsFiddle 上的演示](http://jsfiddle.net/vyy3mn9x/)

* * *

## 回答 #6

> 赞同：47
> 
> 时间：2013-03-06T14:29:03.377

我们只需要解决这个问题并测试三种不同的方法。

1.  确实按照@meouw 的建议取消了请求
2.  执行所有请求，但只处理最后一次提交的结果
3.  只要另一个请求仍然未决，就阻止新请求

```
var Ajax1 = {
  call: function() {
    if (typeof this.xhr !== 'undefined')
      this.xhr.abort();
    this.xhr = $.ajax({
      url: 'your/long/running/request/path',
      type: 'GET',
      success: function(data) {
        //process response
      }
    });
  }
};
var Ajax2 = {
  counter: 0,
  call: function() {
    var self = this,
      seq = ++this.counter;
    $.ajax({
      url: 'your/long/running/request/path',
      type: 'GET',
      success: function(data) {
        if (seq === self.counter) {
          //process response
        }
      }
    });
  }
};
var Ajax3 = {
  active: false,
  call: function() {
    if (this.active === false) {
      this.active = true;
      var self = this;
      $.ajax({
        url: 'your/long/running/request/path',
        type: 'GET',
        success: function(data) {
          //process response
        },
        complete: function() {
          self.active = false;
        }
      });
    }
  }
};
$(function() {
  $('#button').click(function(e) {
    Ajax3.call();
  });
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id="button" type="button" value="click" />
```

在我们的例子中，我们决定使用方法#3，因为它为服务器产生的负载更少。但我不能 100% 确定 jQuery 是否保证调用 .complete() 方法，这可能会产生死锁情况。在我们的测试中，我们无法重现这种情况。

* * *

## 回答 #7

> 赞同：42
> 
> 时间：2014-10-15T09:14:27.473

做这样的事情。

```
var $request;
if ($request != null){ 
    $request.abort();
    $request = null;
}

$request = $.ajax({
    type : "POST", //TODO: Must be changed to POST
    url : "yourfile.php",
    data : "data"
    }).done(function(msg) {
        alert(msg);
    }); 
```

但是如果你检查一个 if 语句来检查 ajax 请求是否为空，那就更好了。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2015-05-28T09:17:53.430

只需调用 xhr。**abort()**无论是 jquery ajax 对象还是原生 XMLHTTPRequest 对象。

例子：

```
//jQuery ajax
$(document).ready(function(){
    var xhr = $.get('/server');
    setTimeout(function(){xhr.abort();}, 2000);
});

//native XMLHTTPRequest
var xhr = new XMLHttpRequest();
xhr.open('GET','/server',true);
xhr.send();
setTimeout(function(){xhr.abort();}, 2000); 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2014-02-03T18:43:27.820

正如线程上的许多人所指出的，仅仅因为请求在客户端被中止，服务器仍将处理该请求。这会在服务器上造成不必要的负载，因为它正在做我们已经停止在前端收听的工作。

我试图解决的问题（其他人也可能遇到）是当用户在输入字段中输入信息时，我想触发对 Google Instant 类型感觉的请求。

为了避免触发不必要的请求并保持前端的敏捷性，我做了以下事情：

```
var xhrQueue = [];
var xhrCount = 0;

$('#search_q').keyup(function(){

    xhrQueue.push(xhrCount);

    setTimeout(function(){

        xhrCount = ++xhrCount;

        if (xhrCount === xhrQueue.length) {
            // Fire Your XHR //
        }

    }, 150);

}); 
```

这实际上将每 150 毫秒发送一个请求（您可以根据自己的需要自定义一个变量）。如果您无法理解这里到底发生了什么，请在 if 块之前记录`xhrCount`并到控制台。`xhrQueue`

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2018-05-18T13:17:35.670

您可以使用此中止任何连续的 ajax 调用

```
<input id="searchbox" name="searchbox" type="text" />

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
     var request = null;
        $('#searchbox').keyup(function () {
            var id = $(this).val();
            request = $.ajax({
                type: "POST", //TODO: Must be changed to POST
                url: "index.php",
                data: {'id':id},
                success: function () {

                },
                beforeSend: function () {
                    if (request !== null) {
                        request.abort();
                    }
                }
            });
        });
</script> 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2013-12-04T14:43:33.223

我正在做一个实时搜索解决方案，需要取消可能比最新/最新请求花费更长的时间的待处理请求。

就我而言，我使用了这样的东西：

```
//On document ready
var ajax_inprocess = false;

$(document).ajaxStart(function() {
ajax_inprocess = true;
});

$(document).ajaxStop(function() {
ajax_inprocess = false;
});

//Snippet from live search function
if (ajax_inprocess == true)
{
    request.abort();
}
//Call for new request 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2013-11-08T08:07:21.373

只需使用 ajax.abort() 例如，您可以在发送另一个这样的请求之前中止任何待处理的 ajax 请求

```
//check for existing ajax request
if(ajax){ 
 ajax.abort();
 }
//then you make another ajax request
$.ajax(
 //your code here
  ); 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2015-06-17T18:44:24.853

没有可靠的方法可以做到这一点，一旦请求正在进行，我什至不会尝试；做出合理反应的*唯一方法是**忽略*响应。

在大多数情况下，它可能发生在以下情况下：用户过于频繁地点击一个按钮触发许多连续的 XHR，在这里你有很多选择，要么阻止按钮直到 XHR 返回，或者甚至不触发新的 XHR，而另一个正在运行提示用户向后倾斜 - 或丢弃任何未决的 XHR 响应，但最近的。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2016-01-04T13:35:37.147

以下代码显示了启动和中止 Ajax 请求：

```
function libAjax(){
  var req;
  function start(){

  req =    $.ajax({
              url: '1.php',
              success: function(data){
                console.log(data)
              }
            });

  }

  function stop(){
    req.abort();
  }

  return {start:start,stop:stop}
}

var obj = libAjax();

 $(".go").click(function(){

  obj.start();

 })

 $(".stop").click(function(){

  obj.stop();

 }) 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="button" class="go" value="GO!" >
   <input type="button" class="stop" value="STOP!" > 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2013-07-25T12:44:11.167

我遇到了轮询问题，一旦页面关闭，轮询就会继续，所以在我的原因中，用户会错过更新，因为在页面关闭后的接下来 50 秒内设置了 mysql 值，即使我终止了 ajax 请求，我想通了，使用 $_SESSION 设置一个 var 不会在轮询中更新它的自身，直到它结束并且一个新的已经开始，所以我所做的是在我的数据库中设置一个值 0 = offpage ，而我轮询我查询该行并返回 false；当它为 0 时，轮询中的查询显然会为您提供当前值...

我希望这有帮助

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2016-10-23T11:56:31.433

如果 `xhr.abort();` 导致页面重新加载，

然后可以设置`onreadystatechange`before abort 来防止：

```
// ↓ prevent page reload by abort()
xhr.onreadystatechange = null;
// ↓ may cause page reload
xhr.abort(); 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-02-12T05:25:10.803

我分享了一个[演示](http://jsfiddle.net/e3ok3s6e/)，演示如何取消 AJAX 请求——如果在预定义的等待时间内没有从服务器返回数据。

**HTML：**

```
<div id="info"></div> 
```

**JS代码：**

```
var isDataReceived= false, waitTime= 1000; 
$(function() {
    // Ajax request sent.
     var xhr= $.ajax({
      url: 'http://api.joind.in/v2.1/talks/10889',
      data: {
         format: 'json'
      },     
      dataType: 'jsonp',
      success: function(data) {      
        isDataReceived= true;
        $('#info').text(data.talks[0].talk_title);        
      },
      type: 'GET'
   });
   // Cancel ajax request if data is not loaded within 1sec.
   setTimeout(function(){
     if(!isDataReceived)
     xhr.abort();     
   },waitTime);   
}); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-02-24T16:08:33.957

这是我基于上述许多答案的实现：

```
 var activeRequest = false; //global var
  var filters = {...};
  apply_filters(filters);

  //function triggering the ajax request
  function apply_filters(filters){
        //prepare data and other functionalities
        var data = {};
        //limit the ajax calls
        if (activeRequest === false){
          activeRequest = true;
        }else{
          //abort if another ajax call is pending
          $request.abort();
          //just to be sure the ajax didn't complete before and activeRequest it's already false
          activeRequest = true;        
        }

        $request = $.ajax({ 
          url : window.location.origin + '/your-url.php',
          data: data,
          type:'POST',
          beforeSend: function(){
            $('#ajax-loader-custom').show();
            $('#blur-on-loading').addClass('blur');
          },            
          success:function(data_filters){

              data_filters = $.parseJSON(data_filters);

              if( data_filters.posts ) {
                  $(document).find('#multiple-products ul.products li:last-child').after(data_filters.posts).fadeIn();
              }
              else{ 
                return;
              }
              $('#ajax-loader-custom').fadeOut();
          },
          complete: function() {
            activeRequest = false;
          }          
        }); 
  } 
```

# c# - 如何用不同的数据填充每个 DataGridViewComboBoxCell？

> ID：446600
> 
> 赞同：3
> 
> 时间：2009-01-15T12:47:46.960
> 
> 标签：c#, datagridview, combobox

我有两个在运行时添加的 DataGridViewComboBoxColumn 我需要第一个 DataGridViewComboBoxColumn 的项目在 gridview 的所有行中保持相同，但我希望第二个 DataGridViewComboBoxColumn 的项目根据所选的行与另一个不同第一个 DataGridViewComboBoxColumn 的项

如果我们说第一个 DataGridViewComboBoxColumn 代表位置，第二个 DataGridViewComboBoxColumn 代表子位置。所以我希望第二个 DataGridViewComboBoxColumn 项目是第一个 DataGridViewComboBoxColumn 中所选位置的子位置

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-20T15:15:10.793

一种选择是在单元级别更改子位置的数据源。

假设网格被命名`grid`并且两个网格列分别被`locationsColumn`命名`subLocationsColumn`：

```
private void Form1_Load(object sender, EventArgs e)
{
    locationsColumn.DataSource = new string[] { "Location A", "Location B" };
} 
```

然后，在网格`CellEndEdit`事件中：

```
private void grid_CellEndEdit(object sender, DataGridViewCellEventArgs e)
{
    if(locationsColumn.Index == e.ColumnIndex)
    {
        DataGridViewComboBoxCell subLocationCell = 
            (DataGridViewComboBoxCell)(grid.Rows[e.RowIndex].Cells["subLocationsColumn"]);

        string location = grid[e.ColumnIndex, e.RowIndex].Value as String;

        switch (location)
        {
            case "Location A":
                subLocationCell.DataSource = new string[] {
                    "A sublocation 1",
                    "A sublocation 2",
                    "A sublocation 3" 
                };
                break;
            case "Location B":
                subLocationCell.DataSource = new string[] { 
                    "B sublocation 1",
                    "B sublocation 2",
                    "B sublocation 3" 
                };
                break;
            default:
                subLocationCell.DataSource = null;
                return;
        }
    }
} 
```

当现有行的位置发生变化时，需要进行一些额外的处理，但这是基本思想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-11T15:46:32.583

看看这个，我认为它概述了你需要什么：

[http://www.timvw.be/2007/01/17/exploring-datagridviewcomboboxcolumn-databinding/](http://www.timvw.be/2007/01/17/exploring-datagridviewcomboboxcolumn-databinding/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T10:34:38.447

一种想法是为“SubLocations”列使用辅助绑定源。此 BindingSource 可以通过在“Locations”列中选择的 LocationId 进行过滤。执行此操作的关键是使用网格的 EditingControlShowing 和 CellValueChanged 事件在所选位置更改时对 SubLocations 列设置适当的过滤。

[这里](http://groups.google.com/group/microsoft.public.dotnet.general/msg/5f318fb8fafc6249)有一个例子。

# sql-server - 从 Microsoft Analysis Services 获取元数据/架构信息

> ID：446607
> 
> 赞同：0
> 
> 时间：2009-01-15T12:49:27.003
> 
> 标签：sql-server, schema, metadata, ssas, cubes

我知道您可以通过以下方式从 Microsoft SQL Server 2005+ 中的关系存储中获取元数据和架构信息：

*   [INFORMATION_SCHEMA](http://msdn.microsoft.com/en-us/library/ms186778.aspx)
*   [对象目录视图](http://msdn.microsoft.com/en-us/library/ms189783.aspx)

Microsoft Analysis Services 中的等效项是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:05:33.773

您可以使用 XLMA [Discover 查询](http://technet.microsoft.com/en-us/library/ms186653.aspx)来检索有关多维数据集的架构信息。此外，AMO（[分析管理对象](http://msdn.microsoft.com/en-us/library/ms124924.aspx)）API 有一个对象模型，允许您通过 .Net 客户端查询多维数据集元数据。它在后台将 XMLA 命令发送到 OLAP 服务器。

# xml - 如何修复 XSD 验证错误？

> ID：446608
> 
> 赞同：2
> 
> 时间：2009-01-15T12:50:08.593
> 
> 标签：xml, xsd

我有一个元素为 0 的 XML 表单，该表单格式正确但无效。当我尝试验证它 XMLSpy 时，我收到以下错误：空元素“隐藏”内不允许任何内容。以下是我的架构：

```
<xs:element name="hidden">
    <xs:complexType>
        <xs:attribute name="datatype" type="xs:string" use="optional"/>
        <xs:attribute name="alias" type="xs:string" use="optional"/>
        <xs:attribute name="source" type="xs:string" use="optional"/>
        <xs:attribute name="name" type="xs:string" use="required"/>
        <xs:attribute name="lookup" type="xs:string" use="optional"/>
    </xs:complexType>
</xs:element> 
```

我需要在上述架构中添加什么来修复此错误？谢谢毫升

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T13:03:33.747

您的“隐藏”元素被定义为空，因为架构中没有任何内容明确允许子元素。我假设你想要类似的东西

```
<hidden *[attributes]*>
   <some_other_element/>
</hidden> 
```

但是根据[http://www.w3schools.com/Schema/schema_complex_empty.asp](http://www.w3schools.com/Schema/schema_complex_empty.asp)你已经隐式地将“隐藏”定义为空。您需要定义哪些元素可以出现在“隐藏”中。有很多方法可以做到这一点，我建议从阅读[http://www.w3schools.com/Schema/schema_complex.asp](http://www.w3schools.com/Schema/schema_complex.asp)开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T14:19:03.097

正如 welbog 所指出的，您定义了一个复杂的空元素。假设您只想要隐藏标签中的文本，您可以按照这些线编写一个模式：

```
<xs:element name="hidden">
  <xs:complexType>
    <xs:simpleContent>
      <xs:extension base="xs:integer">
        <xs:attribute name="datatype" type="xs:string" use="optional"/>
        <xs:attribute name="alias"    type="xs:string" use="optional"/>
        <xs:attribute name="source"   type="xs:string" use="optional"/>
        <xs:attribute name="name"     type="xs:string" use="required"/>
        <xs:attribute name="lookup"   type="xs:string" use="optional"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:element> 
```

这样，您就可以拥有这样一段 XML：

```
<hidden datatype="foo" name="bar">0</hidden> 
```

这里发生的事情是我将“隐藏”定义为*扩展*（`xs:integer`顺便说一下，你可以让它扩展你想要的任何类型），这意味着“隐藏”元素就像整数元素，但有额外的约束，或者在这种情况下具有附加属性。

# pdf - 如何在某个时间点以编程方式打开 pdf？

> ID：446614
> 
> 赞同：12
> 
> 时间：2009-01-15T12:52:45.907
> 
> 标签：pdf

我已经看到一些应用程序将 pdf 文件加载为文档，但在 pdf 文件中的某个位置。他们是怎么做到的？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-15T13:00:53.783

在 URL 上设置页面参数或命名目标。[请参阅有关打开参数](http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf)的文档：

> ## 在 URL 中指定 PDF 打开参数
> 
> 您可以在单个 URL 中指定多个 PDF Open 参数。每个参数都使用与号 (&) 或井号 (#) 字符与其他参数分隔。操作在 URL 命令行上出现时从左到右进行处理和执行。因为所有指定的动作都会被执行，后面的动作可能会覆盖之前动作的效果，所以了解顺序很重要。例如，页面操作应该出现在缩放操作之前。命令不区分大小写（命名目标的值除外）。URL 行中不能有空格。
> 
> ## 网址示例
> 
> ```
> http://example.org/doc.pdf#nameddest=Chapter6
> http://example.org/doc.pdf#page=3
> http://example.org/doc.pdf#page=3&zoom=200,250,100
> http://example.org/doc.pdf#zoom=50
> http://example.org/doc.pdf#page=72&view=fitH,100
> http://example.org/doc.pdf#view=fitb&nameddest=Chapter3
> http://example.org/doc.pdf#pagemode=none
> http://example.org/doc.pdf#pagemode=bookmarks&page=2
> http://example.org/doc.pdf#page=3&pagemode=thumbs
> http://example.org/doc.pdf#collab=DAVFDF@http://review_server/Collab/user1
> http://example.org/doc.pdf#page=1&comment=452fde0e-fd22-457c-84aa-2cf5bed5a349
> http://example.org/doc.pdf#fdf=http://example.org/doc.fdf 
> ```

# delphi - 在图中查找闭合轮廓

> ID：446617
> 
> 赞同：0
> 
> 时间：2009-01-15T12:53:56.607
> 
> 标签：delphi, graph-theory

我有图，不知何故我需要在图中找到不包含图的任何其他边的所有闭合轮廓。

我在搜索谷歌，但只给了我图表:)

是否有任何库，或者您是否知道此类算法的名称。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T18:35:17.883

[EFG's](http://www.efg2.com/Lab/Library/Delphi/MathFunctions/)是德尔福数学相关信息的好站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T18:53:18.190

看看索引：[http ://www.amazon.com/Algorithms-C-Part-Graph-Pt-5/dp/0201361183](https://rads.stackoverflow.com/amzn/click/com/0201361183)

如果您关心的话，这本书的出版目标是不同的编程语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T13:23:53.653

感谢您的回复，我想我有解决方案，例如，如果您从一个节点移动到下一个连接节点，您可以通过测量边缘之间的角度来选择下一个节点。

# html - 表格单元格宽度 - 固定宽度、换行/截断长字

> ID：446624
> 
> 赞同：39
> 
> 时间：2009-01-15T12:56:20.003
> 
> 标签：html, css, user-interface, html-table

我有一个包含不同长度文本的单元格的表格。所有表格单元格必须具有相同的宽度。如果这意味着截断长词或强制中断长词，那没关系。

我想不出任何办法让它发挥作用。

这适用于内部客户端应用程序，因此只需要在 IE6 和 IE7 中工作。

下面是一个示例页面。包含的单元格`onereallylongword`是有问题的单元格。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <style type="text/css">
        td { width: 30px; }
    </style>
</head>
<body>
    <table border="2">
        <tr>
            <td>word</td>
            <td>two words</td>
            <td>onereallylongword</td>
        </tr>
    </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-15T13:21:52.773

只要您固定表格本身的宽度并设置表格布局属性，这非常简单：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <style type="text/css">
        td { width: 30px; overflow: hidden; }
        table { width : 90px; table-layout: fixed; }
    </style>
</head>
<body>

    <table border="2">
        <tr>
            <td>word</td>
            <td>two words</td>
            <td>onereallylongword</td>

        </tr>
    </table>
</body>
</html> 
```

我已经在 IE6 和 7 中对此进行了测试，它似乎工作正常。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-04-28T07:07:12.113

如果您想在新行中正确包装长文本，那么在您的表 id 调用中使用 css 属性，`table-layout:fixed;`否则简单地 css 无法打破新行中的长文本。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-15T13:05:27.580

Stack Overflow 通过使用 DIV 并拥有`overflow-x:auto`. CSS 不能为你分解单词。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-07-21T12:32:38.183

试试这个：

```
text-overflow: ellipsis; 
overflow: hidden; 
white-space:nowrap; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-01T12:14:41.677

```
<style type="text/css">
td { word-wrap: break-word;max-width:50px; }            
</style> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-18T17:10:51.127

我意识到你需要一个 IE6/7 的解决方案，但我只是把它扔给其他人。

如果你不能使用`table-layout: fixed`并且你不关心 IE < 9 这适用于所有浏览器。

```
td {
    overflow-x: hidden;
    overflow-y: hidden;
    white-space: nowrap;
    max-width: 30px;
} 
```

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2009-04-14T08:55:54.833

尝试`td {background-color:white}`

它只适用于我不想被前一列的长文本践踏的专栏。

# outlook - 重新安装 Outlook 2003 并使用 BCM2007，或者以任何方式在 Exchange 服务器上使用 BCM2003？

> ID：446627
> 
> 赞同：-1
> 
> 时间：2009-01-15T12:57:29.580
> 
> 标签：outlook, exchange-server, office-2007

我目前在我的新笔记本电脑上安装了带有 BCM 的 Office 2007，而且 Outlook 2007 似乎经常崩溃，这很烦人，这似乎是因为我在家工作并且与服务器的数据连接不稳定。

我的两个问题是：a) 有没有办法将 BCM2007 与旧版本的 Office 一起使用，b) 当您的邮件连接是通过 Exchange 服务器时，有没有办法使用 BCM2003

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T15:45:53.277

对于其他有同样问题的人，在微软网站上找到一个允许 BCM2003 在 Exchange 环境中工作的补丁后，我降级到 MSO2003（通过完全卸载）。

# .net - 没有 LINQ 或其他 ORM 的存储库模式？

> ID：446629
> 
> 赞同：3
> 
> 时间：2009-01-15T12:58:46.113
> 
> 标签：.net, mysql, mono, repository

在不使用 LINQ 或其他 ORM 的情况下使用存储库模式是否有意义？我正在用 MONO 编写一个应用程序并使用 MySQL，正在考虑使用存储库模式，但无法处理 IQueryable。我正在考虑在存储库上公开更多方法，以明确过滤将在数据库端通过存储库调用进行。如果这是对设计或任何其他设计理念的有效使用，有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:07:35.080

存储库与 IQueryable 完全无关。您正在考虑的是 Rob Conory .net 3.5 采用存储库模式，这实际上更像是一种数据代理模式。

存储库负责返回对象，并处理数据访问，以便您的应用程序的其余部分可以保持对它的无知。

[您可以在Martin Fowlers](http://martinfowler.com/eaaCatalog/repository.html)网站上看到非常高级别的描述

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T13:26:37.383

这是绝对可能的。但是您应该将查询移至存储库站点并为每个类实现一个存储库。例如：

```
public abstract class GenericRepository : IRepository {
    public virtual T Get<T>(Identity id) where T : PersistentDocument {
        using (IDbConnection connection = GetConnection())
        using(IDbCommand command = CreateGetCommand(id, connection)) {
            using (IDataReader reader = command.ExecuteReader()) {
                var mapper = DaHelper.GetMapper<T>();
                return mapper.Map(reader);
            }
        }
    }

    protected virtual IDbCommand CreateGetCommand(Identity id, IDbConnection connection) {
        IDbCommand command = connection.CreateCommand();
        command.CommandText = String.Format("SELECT * FROM {0} e WHERE e.id = ?", TableName);
        command.Parameters.Add(id.ToGuid());
        return command;
    }

    protected abstract string TableName { get; }
}

public class UserRepository: GenericRepository<User>, IUserRepository
{
    protected override string TableName { get { return "users"; } }

    public User GetByEmail(string email)
    {
        using (IDbConnection connection = GetConnection())
        using (IDbCommand command = connection.CreateCommand())
        {
            command.CommandText  = String.Format("SELECT * FROM {0} e WHERE e.email = ?", TableName);
            command.Parameters.Add(email);
            using (var reader = command.ExecuteReader())
                return DaHelper.GetMapper<T>().Map(reader);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T13:41:16.883

当然。存储库只是 linq 使用的一种模式。您可以通过它提供任何类型的数据访问。我从事的一个项目使用处理强类型数据集的存储库。

# c# - Microsoft Enterprise Library 3.1 - 验证 - 来自 resx 的消息

> ID：446634
> 
> 赞同：0
> 
> 时间：2009-01-15T13:01:25.203
> 
> 标签：c#, .net, asp.net, validation, enterprise-library

我正在尝试使用 Enterprise Library 3.1 验证块在新项目中验证我的对象。这个应用程序是多语言的，因此需要能够将我的错误消息放入 resx 文件中。你会怎么做呢？您会在对象本身上使用配置部分或属性吗？如何指定要使用的 resx 文件？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T09:09:52.303

您应该使用**Message Template Tokens**。
看看下面的链接：

*   [验证应用程序块消息模板令牌和资源文件](http://www.pnpguidance.net/Post/ValidationApplicationBlockMessageTemplateTokensResourceFiles.aspx)

您将在 Enterprise Library 文档中找到更多信息。

# xml - 在 delphi 中使用 msxml 进行架构验证

> ID：446635
> 
> 赞同：7
> 
> 时间：2009-01-15T13:01:37.417
> 
> 标签：xml, delphi, xsd, dtd, msxml

我正在尝试根据它引用的模式验证 XML 文件。（使用 Delphi 和 MSXML2_TLB。）（相关部分）代码如下所示：

```
procedure TfrmMain.ValidateXMLFile;
var
    xml: IXMLDOMDocument2;
    err: IXMLDOMParseError;
    schemas: IXMLDOMSchemaCollection;
begin
    xml := ComsDOMDocument.Create;
    if xml.load('Data/file.xml') then
    begin
        schemas := xml.namespaces;
        if schemas.length > 0 then
        begin
            xml.schemas := schemas;
            err := xml.validate;
        end;
    end;
end; 
```

这会导致缓存被加载`schemas.length > 0`（

我该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-19T14:32:21.853

我想出了一种似乎可行的方法。我首先显式加载模式，然后将它们添加到模式集合中。接下来我加载 xml 文件并将 schemacollection 分配给它的 schemas 属性。解决方案现在看起来像这样：

```
uses MSXML2_TLB  
That is:  
// Type Lib: C:\Windows\system32\msxml4.dll  
// LIBID: {F5078F18-C551-11D3-89B9-0000F81FE221}

function TfrmMain.ValidXML(
    const xmlFile: String; 
    out err: IXMLDOMParseError): Boolean;
var
    xml, xsd: IXMLDOMDocument2;
    cache: IXMLDOMSchemaCollection;
begin
    xsd := CoDOMDocument40.Create;
    xsd.Async := False;
    xsd.load('http://the.uri.com/schemalocation/schema.xsd');

    cache := CoXMLSchemaCache40.Create;
    cache.add('http://the.uri.com/schemalocation', xsd);

    xml := CoDOMDocument40.Create;
    xml.async := False;
    xml.schemas := cache;

    Result := xml.load(xmlFile);
    if not Result then
      err := xml.parseError
    else
      err := nil;
end; 
```

使用 XMLSchemaCache40 或更高版本很重要。早期版本不遵循 W3C XML Schema 标准，而仅根据 MicroSoft 规范 XDR Schema 进行验证。

此解决方案的缺点是我需要显式加载架构。在我看来，应该可以自动检索它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:41:01.843

虽然 BennyBechDk 可能走在正确的轨道上，但他的代码存在一些问题，我将在下面更正：

```
uses Classes, XMLIntf, xmlDoc, SysUtils;

function IsValidXMLDoc(aXmlDoc: IXMLDocument): boolean;
var
  validateDoc: IXMLDocument;
begin
  result := false;  // eliminate any sense of doubt, it starts false period.
  validateDoc := TXMLDocument.Create(nil);
  try   
    validateDoc.ParseOptions := [poResolveExternals, poValidateOnParse];
    validateDoc.XML := aXmlDoc.XML;
    validateDoc.Active := true;
    Result := True;
  except
    // for this example, I am going to eat the exception, normally this
    // exception should be handled and the message saved to display to 
    // the user.
  end;
end; 
```

如果您希望系统只引发异常，那么首先没有理由让它成为一个函数。

```
uses Classes, XMLIntf, XMLDoc, SysUtils;

procedure ValidateXMLDoc(aXmlDoc: IXMLDocument);
var
  validateDoc: IXMLDocument;
begin
  validateDoc := TXMLDocument.Create(nil);
  validateDoc.ParseOptions := [poResolveExternals, poValidateOnParse];
  validateDoc.XML := aXmlDoc.XML;
  validateDoc.Active := true;
end; 
```

因为 validateDoc 是一个接口，它会随着函数/过程的退出而被正确的处理掉，不需要自己去处理。如果您调用 ValidateXmlDoc 并且没有收到异常，那么它是有效的。就我个人而言，我喜欢第一次调用 IsValidXMLDoc，如果有效则返回 true，否则返回 false（并且不会在自身之外引发异常）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-14T14:35:16.307

我研究了 Miel 的解决方案来解决这个缺点。我打开 xml 两次，一次是为了获取命名空间，另一次是在创建架构集合后验证文件。这个对我有用。似乎 IXMLDOMDocument2，一旦打开，不接受设置模式属性。

```
function TForm1.ValidXML2(const xmlFile: String;
  out err: IXMLDOMParseError): Boolean;
var
  xml, xml2, xsd: IXMLDOMDocument2;
  schemas, cache: IXMLDOMSchemaCollection;
begin
  xml := CoDOMDocument.Create;
  if xml.load(xmlFile) then
    begin
    schemas := xml.namespaces;
    if schemas.length > 0 then
      begin
      xsd := CoDOMDocument40.Create;
      xsd.Async := False;
      xsd.load(schemas.namespaceURI[0]);
      cache := CoXMLSchemaCache40.Create;
      cache.add(schemas.namespaceURI[1], xsd);
      xml2 := CoDOMDocument40.Create;
      xml2.async := False;
      xml2.schemas := cache;
      Result := xml2.load(xmlFile);
      //err := xml.validate;
      if not Result then
        err := xml2.parseError
      else
        err := nil;
      end;
    end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T08:18:23.777

我之前使用以下代码验证了 XML 文档：

```
Uses
  Classes, 
  XMLIntf, 
  SysUtils;

Function ValidateXMLDoc(aXmlDoc: IXMLDocument): boolean;
var
  validateDoc: IXMLDocument;
begin
  validateDoc := TXMLDocument.Create(nil);

  validateDoc.ParseOptions := [poResolveExternals, poValidateOnParse];
  validateDoc.XML := aXmlDoc.XML;

  validateDoc.Active := true;
  Result := True;
end; 
```

# nhibernate - 有没有办法告诉 NHibernate 从模式导出中排除特定表？

> ID：446639
> 
> 赞同：3
> 
> 时间：2009-01-15T13:03:27.007
> 
> 标签：nhibernate

我正在使用 NHibernate 的 SchemaExport 创建我的数据库模式。我有 1 个无法使用 Schema Export 重新创建的旧 ref 表，因为它已与使用相同数据库的其他应用程序一起使用。有没有办法映射这个表，但告诉 NHibernate 在运行 SchemaExport 时跳过它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T18:10:51.297

此功能最近被添加到 NHibernate 主干中（请参阅NHibernate 开发邮件列表中的[此消息](http://groups.google.com/group/nhibernate-development/browse_thread/thread/d500e30bae29ae48/cee532fb4622e992?lnk=gst&q=schemaexport)）。因此，如果您使用的是主干，您可以使用“schema-action”属性来控制 SchemaExport() 的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T00:51:43.787

尝试改用 SchemaUpdate() 吗？它应该看到表已经存在并且不发出 CREATE 语句

# cocoa-touch - 触发方法在单独的线程中运行

> ID：446646
> 
> 赞同：2
> 
> 时间：2009-01-15T13:05:02.153
> 
> 标签：cocoa-touch, multithreading

我想知道如何在单独的线程中运行方法？类和方法参考。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T15:04:34.190

另一种选择是

```
[someObject performSelectorInBackground:@selector(someSelector:) 
        withObject:nil]; 
```

克里斯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T13:48:21.287

找到了答案（您可以使用这些语句中的任何一个来实现这一点）：

```
[NSThread detachNewThreadSelector:@selector(myThreadMainMethod:) toTarget:self withObject:nil]; 
```

或者

```
NSThread *myThread = [[NSThread alloc] initWithTarget:self
                     selector:@selector(myThreadMainMethod:) 
                     object:nil]; 
[myThreadstart]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T21:40:52.657

如果您已经创建了一个`NSThread`并持有该`NSThread`对象，则可以随后使用以下命令发送更多消息以在该线程上执行：

```
–[NSObject performSelector:onThread:withObject:waitUntilDone:] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T08:33:17.883

找到了我自己的问题的答案：

> 当我在单独的线程中启动新方法时，为什么我需要在该方法中使用 NSAutoreleasePool 对象？如果我不添加它，我会在日志中得到一个池堆栈。

自动释放池和线程（来自 Apple.com 的 MemoryMgmt.pdf）：

> Cocoa 应用程序中的每个线程都维护自己的 NSAutoreleasePool 对象堆栈。当一个线程终止时，它会自动释放与其关联的所有自动释放池。自动释放池是在基于 Application Kit 的应用程序的主线程中自动创建和销毁的，因此您的代码通常不必在那里处理它们。但是，如果您在 Application Kit 的主线程之外进行 Cocoa 调用，则需要创建自己的自动释放池。如果您正在编写仅 Foundation 应用程序或分离线程，就会出现这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T14:48:34.590

您需要一个新的自动释放池来处理该线程中的所有自动释放。主线程有一个由框架在您开始编写代码之前自动创建的。

还要确保如果您正在进行任何界面更新，您将其委派回主线程。如果您不这样做，更新可能会或可能不会起作用

```
[self performSelectorOnMainThread:@selector(someSelector:) 
               withObject:passedInObject waitUntilDone:NO]; 
```

克里斯。

# asp.net - 在 asp.net 中为数据制作重复模板的好方法

> ID：446660
> 
> 赞同：2
> 
> 时间：2009-01-15T13:09:17.510
> 
> 标签：asp.net, templates

我正在构建一个网页，在该网页的首页上显示*n 个*最新的新闻帖子，这是获取帖子并将它们返回到 .aspx 文件的方法。我使用 asp:substitution-control 将字符串插入网页。

我认为我这样做的方式有点凌乱和丑陋，如果我想对模板做些小改动，也不是很灵活。在将模板本身放在单独的 .aspx 或 .ascx 文件中时，我有什么方法可以实现我想要的吗？我已经尝试过，但无法想出一种将数据传递到模板文件的智能方法。

另外，当（如果？）我将模板放在一个单独的文件中时 - 我如何在另一个 .aspx 文件中重复它（在 contentplaceholder 中，如果这很重要。布局由母版页控制）不同每个实例的值？

```
public static string getShortPosts(int postNumber)
{
    DbConnection d = new DbConnection();
    DataTable tbl = d.selectQuery("SELECT TOP (" + postNumber + ") news.id, news.title, news.newsContent, news.excerpt, news.date, news.userid, news.urlTitle, " +
                                    "news.isPublished, users.firstName, users.lastName FROM news INNER JOIN users ON news.userid = users.userid " +
                                    "ORDER BY id DESC;");
    DataTableReader r = tbl.CreateDataReader();

    StringBuilder s = new StringBuilder("");

    while (r.Read())
    {
        /* THIS */ 
        s.Append(
            "<div class=\"newsBox\">" + System.Environment.NewLine +
            "<h2>" + r["title"]+ "</h2>" + System.Environment.NewLine +
            "<p>" + r["excerpt"] + "</p>" + System.Environment.NewLine +
            "</div>" +System.Environment.NewLine+System.Environment.NewLine
            );
    }

    return s.ToString();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T13:38:24.300

有趣的问题。

我认为您可以构建和 .xslt 转换文件，应用于 xml 源将生成您需要的 html。

因此，在您的页面中，您必须只有一个 asp:Xml 控件：

```
<asp:Xml ID="xmlMyControl" runat="server" /> 
```

在后面的代码中，您必须应用转换加载正确的 xslt 文件：

```
XslTransform xslt = new XslTransform();
xslt.Load(Server.MapPath("~/myTransformationFile.xslt"));

xmlMyControl.Transform = xslt;

xmlMyControl.DocumentContent = myMethodToRetrieveXML(); // Your source data, return xml as a string
xmlMyControl.DataBind(); 
```

我从您的代码中看到您有一个 DataTable 作为数据源，但我认为将其转换为 xml 字符串是没有问题的。

通过这种方式，您将只有一个模板（.xslt 文件），您对其应用的所有更改都会自动反映在您使用它的任何地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T13:43:28.893

我建议使用模板化的用户控件。网上有很多教程；这是一篇关于此事的 msdn 文章：http: [//msdn.microsoft.com/en-us/library/aa478964.aspx](http://msdn.microsoft.com/en-us/library/aa478964.aspx)

> 在本文中，我们研究了如何创建一个使用模板的非数据绑定自定义 ASP.NET 服务器控件。意识到可以扩展控件以提供多个模板，就像 DataList 如何提供多个模板一样。我们通过处理以下步骤添加了模板支持：
> 
> *   在 DisplayStats 控件类中创建 ITemplate 类型的私有成员变量。
> *   为模板创建了公共读写属性语句。
> *   创建了一个从 Control 类间接派生的类 (StatsData)，该类提供了我们希望允许页面开发人员通过数据绑定语法在模板中访问的属性。
> *   覆盖 CreateChildControls() 方法。该方法清空Controls集合，创建StatsData实例，然后在模板中实例化StatsData实例，最后将StatsData实例添加到Controls集合中。
> *   覆盖 DataBind() 方法，该方法调用 CreateChildControls() 方法。

使用模板化控件，您可以拥有自己的设置，类似于带有中继器项目的中继器。您可以在其中公开 DataItem 并在前端编写所有标记。它也是相当设计师友好的。然而，巨大的成本是增加的复杂性。我肯定会将它保留用于重要或高度可重用的控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T13:18:11.190

如果是我，我会创建一个用户控件，专门用于在列表中创建单个条目。用户控件只需要一个参数（它负责的帖子编号）。页面本身只需要维护这些用户控件的数组（或列表或任何您喜欢的结构）并将它们添加到需要动态显示的任何面板中。

用户控件将包含一个带有“newsBox”类的面板、一个标题标签和另一个面板（或者可能只是一个常规的 HTML 段落）的内容，因此它的输出将与您正在构建的内容相同例子。不同之处在于它将使用 ASP 和 HTML 对象而不是字符串来创建。

另外，如果是我，我不会有一个用户控件负责从数据库中查询自己的数据。DAL 在这里确实很有用，因为您可以拥有一个函数“GetNewsDetails(int postNumber)”，如果最近查询过新闻帖子，它可以缓存新闻帖子，并且可以在必要时被其他用户控件重用。

# java - 在 Java 中定义错误代码/字符串的最佳方法？

> ID：446663
> 
> 赞同：131
> 
> 时间：2009-01-15T13:11:25.603
> 
> 标签：java, enums

我正在用 Java 编写 Web 服务，并**试图找出定义错误代码及其相关错误字符串的最佳方法**。我需要将数字错误代码和错误字符串组合在一起。错误代码和错误字符串都将发送到访问 Web 服务的客户端。例如，当发生 SQLException 时，我可能想要执行以下操作：

```
// Example: errorCode = 1, 
//          errorString = "There was a problem accessing the database."
throw new SomeWebServiceException(errorCode, errorString); 
```

客户端程序可能会显示以下消息：

> “发生错误 #1：访问数据库时出现问题。”

我的第一个想法是使用`Enum`错误代码并覆盖`toString`返回错误字符串的方法。这是我想出的：

```
public enum Errors {
  DATABASE {
    @Override
    public String toString() {
      return "A database error has occured.";
    }
  },

  DUPLICATE_USER {
    @Override
    public String toString() {
      return "This user already exists.";
    }
  },

  // more errors follow
} 
```

**我的问题是：**有没有更好的方法来做到这一点？我更喜欢代码中的解决方案，而不是从外部文件中读取。我在这个项目中使用 Javadoc，能够在线记录错误代码并让它们在文档中自动更新会很有帮助。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-01-15T13:17:00.443

那么肯定有更好的枚举解决方案实现（通常非常好）：

```
public enum Error {
  DATABASE(0, "A database error has occurred."),
  DUPLICATE_USER(1, "This user already exists.");

  private final int code;
  private final String description;

  private Error(int code, String description) {
    this.code = code;
    this.description = description;
  }

  public String getDescription() {
     return description;
  }

  public int getCode() {
     return code;
  }

  @Override
  public String toString() {
    return code + ": " + description;
  }
} 
```

您可能想要覆盖 toString() 以仅返回描述 - 不确定。无论如何，要点是您不需要为每个错误代码单独覆盖。另请注意，我已明确指定代码而不是使用序数值 - 这使得更改顺序和稍后添加/删除错误更容易。

不要忘记这根本没有国际化 - 但是除非您的 Web 服务客户端向您发送语言环境描述，否则您无论如何都无法轻松地将其国际化。至少他们会有错误代码在客户端用于 i18n ......

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-15T13:20:11.560

就我而言，我更喜欢将错误消息外部化到属性文件中。如果您的应用程序国际化（每种语言一个属性文件），这将非常有用。修改错误消息也更容易，并且不需要重新编译 Java 源代码。

在我的项目中，通常我有一个包含错误代码（字符串或整数，它并不关心）的接口，其中包含此错误的属性文件中的键：

```
public interface ErrorCodes {
    String DATABASE_ERROR = "DATABASE_ERROR";
    String DUPLICATE_USER = "DUPLICATE_USER";
    ...
} 
```

在属性文件中：

```
DATABASE_ERROR=An error occurred in the database.
DUPLICATE_USER=The user already exists.
... 
```

您的解决方案的另一个问题是可维护性：您只有 2 个错误，并且已经有 12 行代码。因此，想象一下您的 Enumeration 文件将有数百个错误需要管理！

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-15T13:18:06.073

重载 toString() 似乎有点恶心——这似乎有点像 toString() 的正常使用。

关于什么：

```
public enum Errors {
  DATABASE(1, "A database error has occured."),
  DUPLICATE_USER(5007, "This user already exists.");
  //... add more cases here ...

  private final int id;
  private final String message;

  Errors(int id, String message) {
     this.id = id;
     this.message = message;
  }

  public int getId() { return id; }
  public String getMessage() { return message; }
} 
```

对我来说似乎更干净......而且不那么冗长。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-15T18:56:18.310

在我的上一份工作中，我对枚举版本进行了更深入的研究：

```
public enum Messages {
    @Error
    @Text("You can''t put a {0} in a {1}")
    XYZ00001_CONTAINMENT_NOT_ALLOWED,
    ...
} 
```

@Error、@Info、@Warning 保留在类文件中并在运行时可用。（我们还有一些其他注释来帮助描述消息传递）

@Text 是一个编译时注解。

我为此编写了一个注释处理器，它执行以下操作：

*   验证没有重复的消息编号（第一个下划线之前的部分）
*   语法检查消息文本
*   生成包含文本的 messages.properties 文件，以枚举值作为键。

我编写了一些实用程序来帮助记录错误，将它们包装为异常（如果需要）等等。

我正试图让他们让我开源它……——斯科特

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T14:22:57.533

我建议您看一下 java.util.ResourceBundle。你应该关心 I18N，但即使你不关心它也是值得的。将消息外部化是一个非常好的主意。我发现能够向业务人员提供电子表格是很有用的，这样他们就可以输入他们想要看到的确切语言。我们编写了一个 Ant 任务来在编译时生成 .properties 文件。它使 I18N 变得微不足道。

如果您还使用 Spring，那就更好了。他们的 MessageSource 类对这类事情很有用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-11-11T21:38:22.347

只是为了继续鞭打这个特殊的死马——当向最终客户显示错误时，我们很好地使用了***数字错误代码***，因为他们经常忘记或误读实际的错误消息，但有时可能会保留并报告一个可以给出的数字值你对实际发生的事情有一个线索。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-09-04T09:31:10.600

有很多方法可以解决这个问题。我首选的方法是有接口：

```
public interface ICode {
     /*your preferred code type here, can be int or string or whatever*/ id();
}

public interface IMessage {
    ICode code();
} 
```

现在您可以定义任意数量的提供消息的枚举：

```
public enum DatabaseMessage implements IMessage {
     CONNECTION_FAILURE(DatabaseCode.CONNECTION_FAILURE, ...);
} 
```

现在您有几个选项可以将它们转换为字符串。您可以将字符串编译到代码中（使用注释或枚举构造函数参数），也可以从配置/属性文件或数据库表或混合中读取它们。后者是我的首选方法，因为您总是需要一些可以很早就变成文本的消息（即，*当*您连接到数据库或读取配置时）。

我正在使用单元测试和反射框架来查找实现我的接口的所有类型，以确保每个代码都在某处使用，并且配置文件包含所有预期的消息等。

使用可以解析 Java 的框架，例如[https://github.com/javaparser/javaparser](https://github.com/javaparser/javaparser)或[来自 Eclipse 的](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html)框架，您甚至可以检查枚举的使用位置并找到未使用的枚举。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-15T13:56:55.513

我（和我公司的其他团队）更喜欢引发异常而不是返回错误代码。错误代码必须到处检查，传递，并且当代码量变大时往往会使代码不可读。

然后错误类将定义消息。

PS：实际上也关心国际化！
PPS：如果需要，您还可以重新定义 raise-method 并添加日志记录、过滤等（至少在环境中，异常类和朋友是可扩展/可更改的）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-15T08:11:38.347

有点晚了，但我只是在为自己寻找一个漂亮的解决方案。如果您有不同类型的消息错误，您可以添加简单的自定义消息工厂，以便您可以指定更多详细信息和稍后想要的格式。

```
public enum Error {
    DATABASE(0, "A database error has occured. "), 
    DUPLICATE_USER(1, "User already exists. ");
    ....
    private String description = "";
    public Error changeDescription(String description) {
        this.description = description;
        return this;
    }
    ....
}

Error genericError = Error.DATABASE;
Error specific = Error.DUPLICATE_USER.changeDescription("(Call Admin)"); 
```

编辑：好的，在这里使用枚举有点危险，因为您永久更改特定的枚举。我想最好改成类并使用静态字段，但你不能再使用'=='了。所以我想这是一个很好的例子，不做什么，（或者只在初始化期间做）:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-29T03:06:12.510

错误代码/消息定义的枚举仍然是一个不错的解决方案，尽管它有 i18n 问题。实际上我们可能有两种情况：代码/消息显示给最终用户或系统集成商。对于后一种情况，不需要 I18N。我认为网络服务很可能是后一种情况。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-02T04:22:22.483

使用`interface`作为消息常量通常是一个坏主意。它将作为导出 API 的一部分永久泄漏到客户端程序中。谁知道，后来的客户端程序员可能会将错误消息（公共）解析为他们程序的一部分。

您将永远被锁定以支持这一点，因为字符串格式的更改将/可能会破坏客户端程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-08T08:39:37.997

请按照以下示例进行操作：

```
public enum ErrorCodes {
NO_File("No file found. "),
private ErrorCodes(String value) { 
    this.errordesc = value; 
    }
private String errordesc = ""; 
public String errordesc() {
    return errordesc;
}
public void setValue(String errordesc) {
    this.errordesc = errordesc;
} 
```

};

在您的代码中将其称为：

```
fileResponse.setErrorCode(ErrorCodes.NO_FILE.errordesc()); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-16T04:28:46.417

我使用 PropertyResourceBundle 在企业应用程序中定义错误代码来管理区域设置错误代码资源。当错误代码的数量巨大且结构化时，这是处理错误代码而不是编写代码（可能适用于少数错误代码）的最佳方法。

查看 java 文档以获取有关 PropertyResourceBundle 的更多信息

# webforms - 在 switch case 语句中使用枚举值

> ID：446677
> 
> 赞同：1
> 
> 时间：2009-01-15T13:18:31.113
> 
> 标签：webforms

我正在使用`enum`关键字来定义我从数据库表中读取的一组值。

我不相信这些值会在数据库中保持不变，并且在`switch` `case`声明中我们需要给出不变的值。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T13:21:47.300

如果这些值不应该是常量，它们应该驻留在数据库表中，并且您应该使用连接来检索实际值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:54:19.690

I would use some kind of unique identifier for the database row. Not the identity field or the smart key but rather some type of abstract value or abbreviation. Then just reference that abstract value in the case statement instead of the value that will change.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:01:00.097

If your application its the main access point to the database, or if you have others application that shared the same data access logic, you can use the enum values as contants in the switch statement, and store in the database the int values of the enum. So, when you retrieve the values from the db, you parsed them to get the enum value.

# c# - 如何识别可重新排序的代码？代码重新排序问题 (.NET)

> ID：446684
> 
> 赞同：1
> 
> 时间：2009-01-15T13:20:32.357
> 
> 标签：c#, .net

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc817398.aspx)指出：

> 处理器可以自由地重新排序此代码

```
internal static volatile int s_x = 0;
internal static volatile int s_y = 0;
internal static volatile int s_ya = 0;

void ThreadA() {
    s_x = 1;
    s_ya = s_y;
} 
```

我担心是否可以重新排序任何代码，并且我知道如何识别可重新排序的代码。特别是关于我的这段代码：

```
Processing.Add(ItemNumber, null);
AsyncTask.Begin(InternalRequestCallback, Remove, ItemNumber); 
```

它必须以指定的顺序发生，否则它会失败。我应该放一个 Thread.MemoryBarrier(); 在这些陈述之间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:27:08.130

短版：没有。

您的代码只需执行两次调用；运行时保证这些方法将按顺序执行（至少在单个线程上）。

文章的复杂性集中在**2 个**线程访问共享状态的复杂性上（您需要`ThreadB`示例的方法才有意义）。我很确定，您粘贴的代码不可重新排序 - 尤其是因为这是同一线程上的连续指令（基于相关数据）。

你需要比我理解的更深入才能进入完整的细节。但是除非你用无锁的线程编程做一些复杂的事情，否则这不太可能咬你。

# python - 如何在不安装解释器的情况下部署 Perl/Python/Ruby 脚本？

> ID：446685
> 
> 赞同：22
> 
> 时间：2009-01-15T13:21:14.040
> 
> 标签：python, ruby, perl

我想写一个本质上是一个正则表达式数据清理器的软件。我将在 CSV 中获取联系人列表，并从该人的姓名中删除所有非单词字符等。

这个项目到处都是 Perl，但我的客户群基本上是非技术性的，在 Windows 上安装 Perl 对他们来说不值得。

关于如何使用 Perl/Python/Ruby 类型语言而无需在他们的计算机上安装解释器的所有想法有什么想法吗？

考虑了一下网络，但出于商业原因它不起作用。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-15T13:37:12.353

您可以获得所有三种语言的 Windows 可执行文件。

*   与 Perl 一样，有不止一种方法可以做到这一点：
    *   [PAR Packer](http://search.cpan.org/perldoc?pp)（免费/开源）
    *   [perl2exe](http://www.indigostar.com/perl2exe.htm)（共享软件）
    *   [PerlApp](http://community.activestate.com/products/PerlDevKit)（ActiveState 的 Perl Dev Kit 的一部分，商业）
*   Python
    *   [py2exe](http://www.py2exe.org/)
    *   [PyInstaller](http://www.pyinstaller.org/)
*   红宝石
    *   [RubyScript2Exe](http://www.erikveen.dds.nl/rubyscript2exe/)
    *   [奥克拉](http://ocra.rubyforge.org/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-15T13:28:05.163

您可以使用[Perl Archive Toolkit](http://search.cpan.org/perldoc?PAR)带来最小的 perl 核心 + 所需的模块 + 您的 Perl 程序。

您甚至可以使用[PAR Packer](http://search.cpan.org/perldoc?pp)将其转换为 Windows exe 文件，从最终用户的角度来看，该文件将像任何其他程序一样运行。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-16T03:58:59.523

使用[PAR，Perl Aachiver](http://search.cpan.org/perldoc?PAR)已经在其他答案中提到过，是一个很好的解决方案。去年作为[Perl Tip发布了一个关于](http://perltraining.com.au/tips/)[使用 PAR 构建可执行文件](http://perltraining.com.au/tips/2008-05-23.html)的简短教程。

在大多数情况下，如果您的构建系统上已经安装了[PAR::Packer](http://search.cpan.org/perldoc?PAR::Packer)，您可以创建一个没有外部依赖项或要求的独立可执行文件：

```
pp -o example.exe example.pl 
```

在大多数情况下，PAR 会为您完成确定模块依赖项的所有艰苦工作，但如果出现任何错误，您可以使用其他命令行选项来确保它们被包含在内。有关详细信息，请参阅[pp 文档。](http://search.cpan.org/perldoc?pp)

祝一切顺利，

*保罗*

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T16:12:22.167

你确定是头疼？只需点击几下鼠标，[ActivePerl](http://www.activestate.com/)和[Strawberry Perl就很容易在 Windows 上安装。](http://www.strawberryperl.com)据我所知，Python 很容易安装。

您是否尝试过安装其中的任何一个，看看它有多容易？如果这些对您的客户来说很难，我看不出给他们一个运行脚本会变得多么容易。

或者，也许您可[​​以为 Perl 使用 Docker 映像](https://hub.docker.com/_/perl/)之类的东西，或者将其作为 Web 服务而不是应用程序提供。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T13:29:53.193

您可以将脚本转换为可执行文件。在 Python 和 Windows 中，您可以使用[py2exe](http://www.py2exe.org/)轻松完成此操作。Perl 和 Ruby 也有类似的解决方案，但我相信 py2exe 既免费又可靠。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T14:11:45.530

非技术观众？您还需要某种基本的用户界面，可能是“图形”类型。你可以试试[wxPython](http://www.wxpython.org)，它可以用[py2exe打包成一个 Windows 可执行文件，用](http://wiki.wxpython.org/index.cgi/DistributingYourApplication)[py2app](http://wiki.wxpython.org/Optimizing%20for%20Mac%20OS%20X)打包成一个 Mac 应用程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T15:46:01.593

[鞋子](http://hackety.org/2008/06/19/stampingExesAndDmgs.html)也可以为其他平台制作 exe 和二进制文件，并且您可以获得集成的 GUI。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-20T17:12:11.217

Ruby 有一个[OCRA](http://ocra.rubyforge.org/)程序，可以将所有内容打包成一个漂亮的 .EXE 文件。不再维护 RubyScript2EXE 程序，因此这将是更好的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T15:32:55.007

“在 Windows 上安装 Perl 对他们来说不值得” 真的吗？有那么复杂吗？

Python 有一个简单的 .MSI，它可以整齐地自行安装，没有任何麻烦或大惊小怪。

一个简单的应用程序只是几个 .py 文件，所以我看不出有什么大的痛苦因素。

你最了解你的客户。

我发现以下内容还不错。 **而且**它更容易支持，因为您的升级将只是一个带有简单、易于使用的源代码的 .MSI。

1）双击这个.MSI文件安装Python（或Perl或其他）

2）双击这个其他.MSI安装好东西

# c# - SQL 到 L2S 翻译帮助

> ID：446687
> 
> 赞同：1
> 
> 时间：2009-01-15T13:21:47.937
> 
> 标签：c#, sql, linq, linq-to-sql

所以这是原始查询

SELECT SUM(PickQty)、SUM(ReqQty)、AssignmentID、StopID 从 PickRequest GROUP BY AssignmentID、StopID

在 LINQ 中

```
from a in dbReqs
group a by new { a.AssignmentID, a.StopID }
into pr
select new
{
Assignment = pr.Key,
StopID = pr.Select(s=> s.StopID),
PickQty = pr.Sum(p=> p.PickedQty),
Count = pr.Sum(c => c.ReqQty)
} 
```

我一定是做错了什么，因为 LINQ 版本需要很长时间，而且结果似乎有点不对劲。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T13:34:55.960

尝试：

```
from a in dbReqs
group a by new { a.AssignmentID, a.StopID }
into pr
select new
{
  AssignmentID = pr.Key.AssignmentID,
  StopID = pr.Key.StopID,
  PickQty = pr.Sum(p=> p.PickedQty),
  Count = pr.Sum(c => c.ReqQty)
} 
```

请注意，您可以很容易地监控 LINQ-to-SQL 的功能：

```
ctx.Log = Console.Out; // or some other writer 
```

# windows - 如何从命令行创建 Windows EventLog 源？

> ID：446691
> 
> 赞同：174
> 
> 时间：2009-01-15T13:22:48.153
> 
> 标签：windows, command-line, event-log

我正在创建一个 ASP.NET 应用程序，它将一些内容记录到 Windows EventLog 中。为此，必须首先创建事件源。这需要管理权限，因此我无法在 ASP.NET 应用程序中执行此操作。

是否有与 Windows 捆绑在一起的现有命令行应用程序可以创建事件日志源，还是我必须推出自己的？

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2009-06-24T02:17:03.547

# 尝试“eventcreate.exe”

一个例子：

```
eventcreate /ID 1 /L APPLICATION /T INFORMATION  /SO MYEVENTSOURCE /D "My first log" 
```

这将在event *log*下创建一个名为event *type*的新事件*源*。`MYEVENTSOURCE``APPLICATION`*`INFORMATION`*

 **我认为这个实用程序仅从 XP 开始包含。

### 进一步阅读

*   Windows IT Pro：[JSI 技巧 5487。Windows XP 包括用于创建自定义事件的 EventCreate 实用程序。](http://windowsitpro.com/windows/jsi-tip-5487-windows-xp-includes-eventcreate-utility-creating-custom-events)

*   输入[`eventcreate /?`](http://www.robvanderwoude.com/allhelpw8pro_en.php#EVENTCREATE)CMD 提示符

*   Microsoft TechNet：Windows 命令行参考：[Eventcreate](https://technet.microsoft.com/en-us/library/cc755240)

*   SS64：Windows 命令行参考：[Eventcreate](http://ss64.com/nt/eventcreate.html)

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2011-08-22T23:29:47.823

# 尝试 PowerShell 2.0 的 EventLog cmdlet

将其用于 PowerShell 2.0 及更高版本：

*   运行[`New-EventLog`](https://technet.microsoft.com/library/hh849768)一次以注册事件源：

    ```
    New-EventLog -LogName Application -Source MyApp 
    ```

*   然后使用[`Write-EventLog`](https://technet.microsoft.com/library/hh849847)写入日志：

    ```
    Write-EventLog 
        -LogName Application 
        -Source MyApp 
        -EntryType Error 
        -Message "Immunity to iocaine powder not detected, dying now" 
        -EventId 1 
    ```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2010-02-19T22:53:33.007

您还可以通过以下命令使用 Windows PowerShell：

```
if ([System.Diagnostics.EventLog]::SourceExists($source) -eq $false) {
    [System.Diagnostics.EventLog]::CreateEventSource($source, "Application")
} 
```

在调用 CreateEventSource 之前一定要检查源不存在，否则会抛出异常。

欲了解更多信息：

*   [http://msdn.microsoft.com/en-us/library/9t766zhb.aspx](http://msdn.microsoft.com/en-us/library/9t766zhb.aspx)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-10-05T21:12:21.650

**[eventcreate2](http://code.google.com/p/eventcreate2/)**允许您创建自定义日志，而*eventcreate*则不允许。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-11-26T12:14:26.473

如果有人感兴趣，也可以通过添加一些注册表值来手动创建事件源。

将以下行保存为 .reg 文件，然后通过双击将其导入注册表：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\eventlog\Application\YOUR_EVENT_SOURCE_NAME_GOES_HERE]
"EventMessageFile"="C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\EventLogMessages.dll"
"TypesSupported"=dword:00000007 
```

这将创建一个名为 的事件源`YOUR_EVENT_SOURCE_NAME_GOES_HERE`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T16:41:52.617

或者只使用命令行命令：

事件创建

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-10T14:09:19.683

但是，cmd/batch 版本可以工作，当您想要定义高于 1000 的 eventID 时，您可能会遇到问题。对于 eventID 为 1000+ 的事件创建，我将使用如下所示的 powershell：

```
$evt=new-object System.Diagnostics.Eventlog(“Define Logbook”)
$evt.Source=”Define Source”
$evtNumber=Define Eventnumber
$evtDescription=”Define description”
$infoevent=[System.Diagnostics.EventLogEntryType]::Define error level
$evt.WriteEntry($evtDescription,$infoevent,$evtNumber) 
```

样本：

```
$evt=new-object System.Diagnostics.Eventlog(“System”)
$evt.Source=”Tcpip”
$evtNumber=4227
$evtDescription=”This is a Test Event”
$infoevent=[System.Diagnostics.EventLogEntryType]::Warning
$evt.WriteEntry($evtDescription,$infoevent,$evtNumber) 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2014-05-31T14:58:24.190

您可以使用 diagnostics.Event 日志类创建自己的自定义事件。打开一个 Windows 应用程序并在一个按钮上单击执行以下代码。

```
System.Diagnostics.EventLog.CreateEventSource("ApplicationName", "MyNewLog"); 
```

“MyNewLog”是指您想为您的登录事件查看器提供的名称。

有关更多信息，请查看此链接 [ [http://msdn.microsoft.com/en-in/library/49dwckkz%28v=vs.90%29.aspx]](http://msdn.microsoft.com/en-in/library/49dwckkz%28v=vs.90%29.aspx%5d)

# java - 您如何开发 JSF 应用程序？

> ID：446694
> 
> 赞同：4
> 
> 时间：2009-01-15T13:23:05.457
> 
> 标签：java, eclipse, jsf

我第一次在一个需要构建一个大量使用 JSF（尤其是 ICEfaces）的 web 应用程序的项目上工作。有很多东西需要编码，包括 CSS、HTML、JSP/Java，当然还有 JSF。

我在 Eclipse btw 中完成所有这些工作，并使用 eclipse 负责启动的本地 tomcat 服务器来运行应用程序。

无论如何，我注意到这一切都非常缓慢。当我更改一个 JSF 时，我必须重新启动网络服务器，以便查看新结果。通常我只是对布局和停止、重新启动、刷新所需的 10 到 15 秒以上的时间感兴趣，这让我发疯。我每天重启 Tomcat 一百次——啊！我需要更快的周转！

难道我做错了什么？这是所有 Web 开发人员的自然状态吗​​？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T13:30:54.910

我正在使用几乎相同的配置在 JSF 中开发我的应用程序（Tomcat 5.5 由我的 Eclipse 3.3 和 JBoss Tools 运行）。我也在使用 Facelets for JSF，并且我可以在 web.xml 中设置一个重要的上下文参数，以便能够通过自动刷新修改我的 XHTML 文件（即我不需要重新启动 Tomcat 来查看我的变化）。所以，在我的 web.xml 中，我有这个：

```
<context-param>
    <param-name>javax.faces.FACELETS_REFRESH_PERIOD</param-name>
    <param-value>1</param-value>
</context-param> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T18:19:27.947

我正在使用 eclipse 和 maven 开发 JSF 应用程序。当对程序进行更改并保存该更改时，它会自动重新加载。更改任何配置文件时都必须重新启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T08:47:44.287

您不必重新启动 Tomcat 即可看到您的更改。只需复制 $CATALINA_HOME/webapps 中的 WAR 即可使应用程序自行重新部署。不过，这需要几秒钟。

有多种部署方式，请参阅 Tomcat 6 的此文档：[http ://www.mbaworld.com/docs/appdev/deployment.html](http://www.mbaworld.com/docs/appdev/deployment.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T12:13:40.513

我使用 Jboss Developer Studio (v2.0) 并将我的项目设置为热部署。这意味着除了实体、EJB 和消息包之外的任何更改我都没有重新启动。非常适合大多数 POJO 项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-14T10:05:43.573

我曾经有同样的问题。使用 JavaRevel 即时重新部署代码的快速解决方案（免费用于非商业用途，如果您想在公司中使用它，则需要花费几美分） [http://www.zeroturnaround.com/javarebel/](http://www.zeroturnaround.com/javarebel/)

希望这可以帮助，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T16:09:52.500

您可以通过直接将更新的标记文件复制到适当的 webapp 目录中来解决这个问题，至少对于布局/标记位。

查看分解的 WAR 文件并找到您的标记文件所在的位置。您可以直接更改它，也可以将更新的文件移到那里。稍后刷新浏览器，您的标记应该更改！

您可以通过添加 ANT 命令来更快地完成此操作。我正在使用 Netbeans，但我对 ANT 不是很好（而且我的截止日期没有给我时间弄清楚），所以我制作了一个小 shell 脚本，将我的所有文件 cp 到爆炸的 WAR 目录中。

但是，如果您更改 Java 或配置文件，则需要重新部署 WAR。我不确定您正在运行什么版本的 Tomcat，但要在我的 Tomcat 6 实例上执行此操作，只需将 WAR 文件移动到 webapps 目录中，就会导致 Tomcat 将其拾取并重新部署。

不过要小心！Tomcat 6 的热部署功能运行良好，但它不能正确释放先前部署使用的 PermGen 内存。因此，经过几次热部署后，Tomcat 开始抛出“PermGen 错误：内存不足”异常，您唯一的办法就是重新启动。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-18T16:29:44.887

如果您只是在玩 CSS，那么使用[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)之类的东西就地编辑它，然后当您满意时，您可以将它全部复制并粘贴到 Eclipse 中。同上 HTML；事实上，当您知道 JSF 组件的去向时，只需制作一个虚拟页面，然后在[快速 Web 开发 IDE](https://stackoverflow.com/questions/515199/what-free-web-development-ides-do-people-use)中对其进行编辑。

Web 开发通常不需要频繁重启 Tomcat :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T15:37:18.710

我曾经在没有任何设计工具的情况下自己在 Eclipse 中开发 JSF 页面（我不喜欢它们）。使用设计器工具很难制作复杂的 UI 布局 - 工具仅适用于简单的布局。当您有很多 DHTML、CSS 时，您应该自己编写页面。

关于服务器重启：如果你以正确的方式配置你的 Tomcat，更改 JSP 页面不会导致服务器重启（热部署或类似这样的事情）。如果您更改 bean 中的方法签名，当然您必须重新启动。

# xsd - 是否有任何已定义的原子联合 xml 架构？

> ID：446700
> 
> 赞同：17
> 
> 时间：2009-01-15T13:25:59.257
> 
> 标签：xsd, syndication, syndication-feed, atom-feed

是否有任何已定义的原子联合 xml 架构？

[RFC 4287](https://www.rfc-editor.org/rfc/rfc4287)在附录 B 中仅包含一个 Relax NG 紧凑模式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T13:27:32.653

[http://www.kbcafe.com/rss/atom.xsd.xml](https://web.archive.org/web/20150307045002/http://www.kbcafe.com/rss/atom.xsd.xml)（一个 Web 存档版本，因为原始版本不再可用）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-08-31T10:47:39.477

# 什么不起作用

不应使用[http://www.kbcafe.com/rss/atom.xsd.xml](https://web.archive.org/web/20150307045002/http://www.kbcafe.com/rss/atom.xsd.xml)`<id>` ，因为它甚至不会检测到丢失的标签。

[https://tools.oasis-open.org/version-control/browse/wsvn/cmis/trunk/SchemaProject/schema/ATOM.xsd](https://tools.oasis-open.org/version-control/browse/wsvn/cmis/trunk/SchemaProject/schema/ATOM.xsd)坏`xmllint`了，使用时报错：

> 复杂类型“atomPersonConstruct”：内容模型不是确定性的。

# 有什么作用

RFC 包含一个放松 ng 紧凑规范：[https ://validator.w3.org/feed/docs/rfc4287.html#rfc.section.B](https://validator.w3.org/feed/docs/rfc4287.html#rfc.section.B)

借助该`trang`文件`.rnc`可以从紧凑格式转换为基于 XML 的`.rng`文件。这又可以用于`xmllint`：

```
$ xmllint --noout --relaxng atom.rng feed.atom
feed.atom:4: element feed: Relax-NG validity error : Expecting an element updated, got nothing
feed.atom:16: element entry: Relax-NG validity error : Invalid sequence in interleave
feed.atom:16: element entry: Relax-NG validity error : Element feed failed to validate content
feed.atom fails to validate 
```

# c# - .NET/C# - 对数据表进行排序，然后手动处理行

> ID：446702
> 
> 赞同：3
> 
> 时间：2009-01-15T13:26:29.443
> 
> 标签：c#, .net

在 C#/ASP.NET 3.5 中，我有一个从数据库中提取行的 DataTable。我想动态地将排序过滤器应用于数据表（可能是数据视图），然后对排序数据的“行”进行循环以将每一行用于某些指标。

我非常希望不要每次都点击数据库进行自定义排序，但我不确定如何从原始数据表中获取排序数据表。

我确定我忘记/错过了一些简单的事情，但我不记得如何做到这一点！

我想在“排序”列表中执行此操作。它目前正在我查询的绑定列表中执行此操作。

```
 foreach (DataRow dr in dtTags.Rows)
            {
                LinkButton lbTag = new LinkButton();
                lbTag.CssClass = "UserTagNoHover";
                lbTag.ID = "hlUserTag" + dr["UserTagRID"].ToString();
                lbTag.Text = dr["Name"].ToString();
                //lbTag.Click += new System.EventHandler(this.Tag_OnClick);
                lbTag.CommandName = "User_Click";
                lbTag.CommandArgument = "hlUserTag" + dr["UserTagRID"].ToString();
                lbTag.ToolTip = "Total uses: " + dr["TotalCount"].ToString();

                Boolean bAlreadyExists = false;
                foreach (LinkButton lbTest in pnlTags.Controls)
                {
                    if (lbTest.ID == lbTag.ID)
                    {
                        bAlreadyExists = true;
                    }
                }
                if (bAlreadyExists == false)
                {
                    pnlTags.Controls.Add(lbTag);
                }
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T13:30:48.077

DataTable.Select() 函数完全符合您的要求。它的第二个String参数是一个排序字符串，其语法与SQL相同：*[Column Name]* ASC、*[Other column name]* DESC等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T13:32:37.557

```
 DataTable table = ...
        DataView view = table.DefaultView;
        view.Sort = ...
        view.RowFilter = ... 
```

*   MSDN：[DataView.Sort](http://msdn.microsoft.com/en-us/library/system.data.dataview.sort.aspx)
*   MSDN：[DataView.RowFilter](http://msdn.microsoft.com/en-us/library/system.data.dataview.rowfilter.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T13:36:12.900

鉴于您使用的是 .NET 3.5，我会使用 LINQ to DataSet。强类型数据表更好，但是：

```
var rows = from row in dataTable.AsEnumerable()
                  orderby row.Field<int>("Age") // or whatever
                  select new
                  {
                        UserTagID = row.Field<string>("UserTagID"),
                        TotalCount = row.Field<int>("TotalCount")
                        // etc
                  }; 
```

然后，您可以以更简单的方式遍历行 - 无论如何，在我看来。

# c# - 获取基本异常信息

> ID：446706
> 
> 赞同：1
> 
> 时间：2009-01-15T13:27:22.513
> 
> 标签：c#, exception

我正在记录错误并向自己发送异常日志！像下面的代码

```
 private void ExceptionForm_Load(object sender, EventArgs e)
    {
        Type exceptionType = _exception.GetType();

        txtErrorMessage.Text = _exception.ToString();

        if (exceptionType == typeof(Sybase.DataWindow.DbErrorException))
        {
             _exception = (Sybase.DataWindow.DbErrorException)_exception;

            txtErrorMessage.Text += "Exception SQL data:" +  exception;
        }

    } 
```

现在的问题是这样的。if (exceptionType == typeof(Sybase.DataWindow.DbErrorException)) then _exception 有额外的属性，例如出错的 SqlSyntax（例如从表中更新某些内容） 问题是如何显示该数据。它不是我的例外，所以看起来。exceptiontype = DbErrorException 但我似乎无法将我的 _exception 转换为它。或者这是不好的做法？还是我应该删除所有内容并从 MS 安装异常处理应用程序块？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T13:32:10.867

问题不在于演员阵容——而是你的 _exception 变量（大概）是异常类型。您需要声明一个正确类型的新变量。另外，你有什么理由使用 GetType() 而不是“as”或“is”吗？派生异常呢？试试这个：

```
private void ExceptionForm_Load(object sender, EventArgs e)
{
  DbErrorException specificException = _exception as DbErrorException;
  if (specificException != null)
  {
     txtErrorMessage.Text += "SqlSyntax=" + specificException.SqlSyntax;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T13:37:11.073

看起来像乔恩！不知道“as”和“is”。我的 _exception 确实属于 Exception 类型（因为我将所有异常都发送到此“日志表单”）。如果我想要所有数据，是否必须将我的异常所有数据转换为特定的异常类型？（例如 webexception、socketexception）

# url - 如何使用 ActionScript 2 找到 SWF 文件的 URL？

> ID：446713
> 
> 赞同：3
> 
> 时间：2009-01-15T13:28:42.573
> 
> 标签：url, flash, actionscript-2

我正在寻找一种使用 ActionScript 2 找出 SWF 的 URL 的方法。

在 ActionScript 3 中，这是通过 using 完成的`root.loaderInfo.loaderURL`，但我在 ActionScript 2 中没有找到任何等效项。

*请注意，我不是在寻找嵌入 SWF 的页面的 URL，而是实际 SWF 的 URL，并且使用 ActionScript 3 不是一个选项（尽管我希望它是）。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T13:36:02.887

每个 MovieClip 中都有可用的 _url 属性。

示例：跟踪（_url）；

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T13:32:23.160

我自己找到了：

```
_root._url; 
```

非常简单！

# iphone - 如何为 cocos2d 创建倒数计时器？

> ID：446717
> 
> 赞同：20
> 
> 时间：2009-01-15T13:30:07.967
> 
> 标签：iphone, objective-c, cocos2d-iphone

我正在使用 cocos2d 开发 2D iPhone 游戏。我需要一个倒数计时器。如何在 cocos2d 中创建倒数计时器？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-03T08:54:17.793

没有足够的代表来支持汤姆，但他是绝对正确的。在这个问题的背景下， NSTimer 是错误的解决方案。Cocos2d 框架提供了一个调度程序，它与其他游戏功能（如暂停/恢复）集成在一起（并且很可能在后台使用 NSTimer）。

来自上述链接的示例：

```
-(id) init
{
    if( ! [super init] )
        return nil;

    // schedule timer
    [self schedule: @selector(tick:)];
    [self schedule: @selector(tick2:) interval:0.5];

    return self;
}

-(void) tick: (CCTime) dt
{
    // bla bla bla
}

-(void) tick2: (CCTime) dt
{
    // bla bla bla
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-19T09:28:48.830

[http://www.cocos2d-iphone.org/wiki/doku.php/prog_guide:best_practices](http://www.cocos2d-iphone.org/wiki/doku.php/prog_guide:best_practices)

> *   尽量**不要**使用 Cocoa 的 NSTimer。而是使用 cocos2d 自己的调度器。
> *   如果你使用 cocos2d 调度器，你将拥有：
>     *   自动暂停/恢复。
>     *   当Layer（Scene、Sprite、CocosNode）进入舞台时，定时器会自动激活，离开舞台后会自动关闭。
>     *   您的目标/选择器将以增量时间调用...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-26T13:18:29.467

在 cocos 2d 中，定时器有默认的更新部分。

试试这个：

```
[self schedule:@selector(update:)];
- (void)update:(ccTime)dt {
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-06T07:12:02.880

对于那些想要使用 NSTimer 而不是“schedule”方法的人，您可以创建一个如下所示的类：

ZIMCountdownTicker.h

```
#import <Foundation/Foundation.h>

extern NSString * const ZIMCountdownTickerTickAction;
extern NSString * const ZIMCountdownTickerResetAction;

@protocol ZIMCountdownTickerProtocol;

/*!
 @class             ZIMCountdownTicker
 @discussion        This class creates a countdown ticker.
 @updated           2011-03-05
 */
@interface ZIMCountdownTicker : NSObject {

    @private
        NSTimer *_timer;
        id<ZIMCountdownTickerProtocol> _delegate;
        NSTimeInterval _interval;
        double _period;
        double _value;

}

/*!
 @method                initWithDelegate:withTimeInterval:forTimePeriod:
 @discussion            This method instantiate an instance of this class with the specified parameters.
 @param delegate        A reference to a class that has implemented ZIMCountdownTickerProtocol.
 @param interval        The time interval in seconds to be used when running the countdown ticker.
 @param period          The time period in seconds for which countdown ticker will run.
 @updated               2011-03-05
 */
- (id) initWithDelegate: (id<ZIMCountdownTickerProtocol>)delegate withTimeInterval: (NSTimeInterval)interval forTimePeriod: (double)period;
/*!
 @method                start
 @discussion            This method will start the countdown ticker.
 @updated               2011-03-05
 */
- (void) start;
/*!
 @method                stop
 @discussion            This method will stop the countdown ticker.
 @updated               2011-03-05
 */
- (void) stop;
/*!
 @method                reset
 @discussion            This method will reset the countdown ticker.
 @updated               2011-03-06
 */
- (void) reset;
/*!
 @method                value
 @discussion            This method will return the countdown ticker's current value; however, using this method will cause
                    the ticker to stop.
 @return                The countdown ticker's current value.
 @updated               2011-03-05
 */
- (double) value;

@end

@protocol ZIMCountdownTickerProtocol <NSObject>

@optional
/*!
 @method                countdownTicker:didUpdateValue:withAction:
 @discussion            This method will notify the delegate with the current value.
 @param ticker          A reference to tiggering ticker.
 @param value           The current value.
 @param action          The action that tiggered this method.
 @updated               2011-03-05
 */
- (void) countdownTicker: (ZIMCountdownTicker *)ticker didUpdateValue: (double)value withAction: (NSString *)action;
/*!
 @method                countdownTickerDidFinish:
 @discussion            This method will notify the delegate that the countdown ticker finished.
 @param ticker          A reference to tiggering ticker.
 @updated               2011-03-05
 */
- (void) countdownTickerDidFinish: (ZIMCountdownTicker *)ticker;

@end 
```

ZIMCountdownTicker.m

```
// Ziminji Classes
#import "ZIMCountdownTicker.h"

NSString * const ZIMCountdownTickerTickAction = @"ticker.tick";
NSString * const ZIMCountdownTickerResetAction = @"ticker.reset";

/*!
 @category          ZIMCountdownTicker (Private)
 @discussion        This category defines the prototypes for this class's private methods.
 @updated           2011-03-05
 */
@interface ZIMCountdownTicker (Private)
    /*!
     @method            countdown:
     @discussion        This method is called by the timer to decrement the counter's value and will send
                    the delegate the updated value.
     @param timer       The timer currently in use.
 @updated           2011-03-06
    */
    - (void) countdown: (NSTimer *)timer;
@end

@implementation ZIMCountdownTicker

- (id) initWithDelegate: (id<ZIMCountdownTickerProtocol>)delegate withTimeInterval (NSTimeInterval)interval forTimePeriod: (double)period {
    if (self = [super init]) {
        _delegate = delegate;
        _interval = interval;
        _period = period;
        _value = period;
        _timer = nil;
    }
    return self;
}

- (void) start {
    if (_timer == nil) {
        _timer = [NSTimer scheduledTimerWithTimeInterval: _interval target: self selector: @selector(countdown:) userInfo: nil repeats: YES];
    }
}

- (void) stop {
    if (_timer != nil) {
        [_timer invalidate];
        _timer = nil;
    }
}

- (void) reset {
    [self stop];
    _value = _period;
    if ((_delegate != nil) && [_delegate respondsToSelector: @selector(countdownTicker:didUpdateValue:withAction:)]) {
        [_delegate countdownTicker: self didUpdateValue: _value withAction: ZIMCountdownTickerResetAction];
    }
}

- (double) value {
    [self stop];
    return _value;
}

- (void) countdown: (NSTimer *)timer {
    _value -= 1;
    if ((_delegate != nil) && [_delegate respondsToSelector: @selector(countdownTicker:didUpdateValue:withAction:)]) {
        [_delegate countdownTicker: self didUpdateValue: _value withAction: ZIMCountdownTickerTickAction];
    }
    if (_value <= 0) {
        [self stop];
        if ((_delegate != nil) && [_delegate respondsToSelector: @selector(countdownTickerDidFinish:)]) {
            [_delegate countdownTickerDidFinish: self];
        }
    }
}

- (void) dealloc {
    if (_delegate != nil) {
        [_delegate release];
    }
    if (_timer != nil) {
        [_timer invalidate];
    }
    [super dealloc];
}

@end 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-01-16T05:59:16.693

看看 NSTimer，它很可能提供任何需要的计时器功能。

[NSTimer 类参考](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html)

* * *

## 回答 #6

> 赞同：-13
> 
> 时间：2009-01-19T08:58:36.537

```
-(id) init
{
    if( ! [super init] )
        return nil;

    // schedule timer
    [self schedule: @selector(tick:)];
    [self schedule: @selector(tick2:) interval:0.5];

    return self;
}

-(void) tick: (ccTime) dt
{
    //some function here
}

-(void) tick2: (ccTime) dt
{
    //some function here
} 
```

# evaluation - 必须为开发人员设定目标，即使目标不起作用

> ID：446720
> 
> 赞同：85
> 
> 时间：2009-01-15T13:31:50.710
> 
> 标签：evaluation

人们[普遍](http://www.joelonsoftware.com/news/20020715.html)认为，为软件开发人员[设定可衡量的目标是](http://www.inc.com/magazine/20081001/how-hard-could-it-be-sins-of-commissions.html)[行不通](https://stackoverflow.com/questions/324399/what-is-a-fair-productivity-measurement-technique-for-programmers#324441)的，因为过分关注目标会导致与组织目标背道而驰的行为（所谓的“[衡量功能障碍](http://csdl.ics.hawaii.edu/techreports/96-16/96-16.html)”）。

但是，在我的公司，我们需要为所有员工设定目标，并受到人力资源部的鼓励，使他们变得[SMART](http://en.wikipedia.org/wiki/SMART_(project_management))。过去，我和我的一级经理（团队领导）同事尝试了多种方法：

1.  设定正常工作之外的可衡量目标，例如“对技术 X 进行培训”、“为无人理解的代码 Y 创建文档”等等。当谈到年度绩效评估时，不是根据书面目标来评价开发人员，而是根据我对他们正常工作的不可估量价值的看法，因为这实际上是公司关心的。
2.  设定非常具体的目标，例如“任务管理系统记录的工作天数”、“引入的错误数量”、“导致的生产发布数量”。这导致了夸大的估计和错误的错误分类，以便获得更好的“分数”。有趣的是，即使是那些在这个系统上得分很高的开发人员也不喜欢它，因为团队内部的内在信任被破坏了，他们并不总是觉得自己配得上这个高职位。
3.  设定模糊的目标，这些目标是“做好你的正常工作”的变体。当谈到年度评估时，他们的评级确实反映了目标的绩效，但目标本身是不可衡量或可实现的，这是不受欢迎的。

这些都不是理想的。如果您遇到过类似的情况，必须为软件开发人员创建有意义的、可衡量的目标，尽管有证据证明这些目标的有效性，**那么哪种方法最适合您？**

* * *

我发现的相关问题并不能完全解决同一点：

*   [软件工程师有哪些好的绩效目标？](https://stackoverflow.com/questions/51629/what-are-suitable-performance-indicators-for-programmers)
*   [为开发人员设定性能目标](https://stackoverflow.com/questions/210329/setting-performance-goals-for-developers)
*   [适合程序员的性能指标是什么？](https://stackoverflow.com/questions/51629/what-are-suitable-performance-indicators-for-programmers)
*   [对于程序员来说，什么是公平的生产力测量技术？](https://stackoverflow.com/questions/324399/what-is-a-fair-productivity-measurement-technique-for-programmers#324441)
*   [我需要一些明年的职业“目标”](https://stackoverflow.com/questions/317836/i-need-some-career-goals-for-the-next-year)

* * *

**更新**（2009 年 11 月 18 日）：我的问题有 10 个赞成票，而评分最高的答案只有 4 个赞成票（包括我每个人的赞成票）。我认为这告诉我们一些事情：也许 Joel 和其他人是对的，stackoverflow 的综合智慧无法为开发人员提供*任何*令人信服的、可衡量的目标，而这些目标无法在不影响他们真正（不可衡量的）价值的情况下被玩弄。工作。不过感谢您的尝试！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-15T14:07:09.547

> 哪种方法最适合您？

只有一个目标：**通过代码检查/同行评审，我作为审阅者，没有我发现任何错误或有任何其他批评，这让我要求你重做一些事情。**

笔记：

*   我没有衡量新员工快速完成工作的能力，也没有鼓励他们：我希望人们学习如何完成工作（因为如果做得不好，那就没有完成）
*   人们学到了我在代码审查中寻找的东西：所以这是一个学习机会**和**质量控制措施，而不仅仅是一个管理目标
*   我的评论将分为两类：
    1.  这是一个错误：您必须在签入前修复此问题
    2.  作为一个建议，我会做某事
*   过了一段时间，我对一个人的代码的审查将停止发现任何“必须修复”的项目（此时我不再需要审查他们的工作）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-29T21:51:37.783

我个人尝试设定两种目标：

*   以业务为中心的目标（这就是我们获得报酬的原因）。例如，“在 2009 年 6 月 1 日之前完成项目 X”）。这些目标通常在团队的几个成员之间共享（他们知道这一点）。团队可以通过提早引入项目或超出所需的功能来超越目标。个人可以通过产生更多功能、减少针对他们的错误或指导和支持团队的其他成员来超越目标。

*   个人成长目标，例如完成一个涉及开发人员想要添加到他们技能中的技术的项目，更好地了解用户的领域，获得领导经验等。

我觉得重要的是：

*   目标很聪明
*   目标与业务需求保持一致
*   您确实在目标中包含“正常工作”，实际上这些是最重要的目标！
*   员工有一些机会超越你设定的目标

最后，我会远离作为目标的软件指标——它们太容易玩弄，可能不会给你你需要的东西。我只会使用我想指导某人进入或退出特定行为的指标。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-15T13:41:48.833

这一切都归结为“一级管理”这一事实，大多数管理人员都不了解他们的员工。SMART 之类的东西并没有成为实际日常规划和开发的一部分。如果经理们要花更多的时间与实际工作的人在一起，那么这些都不需要。

就个人而言，我更喜欢在敏捷环境中工作，在这种环境中，开发人员在生产力和质量意识方面的表现是*显而易见的。*真正的敏捷方法不仅需要开发人员，还需要设计人员、测试人员、客户和产品经理参与到流程中。从经理的角度来看，这自然会带来更好的洞察力。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-15T13:43:09.097

到目前为止我看到的可衡量的目标：

*   通过证书考试
*   研究技术 X 并举行关于它的演讲
*   提交的构建重大更改数
*   关于内部知识管理的 wiki 文章数量

直接询问您的开发人员是否有一些个人发展的想法，然后可以用于目标？

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-15T14:26:35.530

> 必须为开发人员设定目标，即使他们不工作

如果您的开发人员不工作，也许某些目标*正是*他们需要激励的？;-)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-15T13:35:59.313

“确保至少 n% 的代码通过合适的单元测试进行测试” 使用覆盖率工具来证明这一点，并让其他人检查测试质量。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-15T13:50:15.633

我认为预先制定非常具体的目标，即 SMART（也许我们实际上在同一个地方工作），在实践中似乎是一个好主意，但对于大多数团队来说并不是很实用。

问题确实是我们的增量目标发生了变化。业务发生变化，作为开发人员，我们需要在合理的时间范围内做出适当的反应和反应。

考虑设定与您的团队或小组在组织中的目的相关的目标。如果你的团队没有达到一个目的——一个宏观目的，你的团队就不会得到资助。拥有贯穿整个团队并与业务保持一致的集体目标。赋予人们责任，让人们承担责任。庆祝他们的成功和失败（如果我们有时不失败，我们可能不会尝试，这就是您希望人们提供的）。高温高压

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-15T15:28:55.297

我们有许多在程序员工作时收集的指标，例如：

*   更改/添加的 SLOC 数量
*   在流程的各个阶段（同行评审、同行评审后、发布后）注入的错误/错误数量
*   变更请求已完成/拒绝
*   正式文件（软件版本说明、设计文档等）

所有这些都是有形的，我发现它们在管理和软件质量保证的演示中很有用。但我从来没有发现它们在实际评估人们的表现时非常有用——这就是你列出的几个链接的意义所在。我发现 Joel 的观点[是](http://www.joelonsoftware.com/news/20020715.html)有道理的——指标永远不会促进良好的团队氛围。

不幸的是，我们都生活在一个其他人（管理、质量保证、外部承包商等）需要指标的世界中。我发现需要一种平衡行为——提供这些指标，但也提供无形资产的证据——无形资产是每个程序员已经完成的，不一定要跟踪。例如，我有一位程序员花费大量时间研究其他人不想接触的遗留代码。尽管那段时间他的指标很低，但这种努力是无价的。

我发现包含此类内容的唯一方法是推动创建一个额外的无形类别，并赋予其与其他指标同等的权重。通常这足以平衡特定程序员的平衡。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-15T14:01:17.187

其中一个问题似乎是，作为一个部门/部门，IT 组织没有可衡量的战略目标。如果他们这样做，为个人设定目标会更容易。

例如，如果有一个部门主动减少提出的问题工单的数量，那么您可以根据与他们所关注的软件相关的工单数量来设定个人目标。

由于软件开发在很大程度上是一种协作，因此在团队层面设定目标会更有意义，然后根据个人对团队的贡献对他们进行评分。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-23T16:56:39.190

确定如何使个人发展与正在完成的项目保持一致是我认为的一个关键点。让开发人员分析自己以发现弱点，同时对他人提供反馈，这可能是一种找到可以改进的地方，然后找到衡量它的方法。例如，我可能会发现我很少记录已完成的项目等我的年度目标，我可以声明我想要改进这一点，并且我制作的文档数量可以衡量这一点。它可能会起作用，也可能适得其反，这取决于我如何真正遵循它。一方面，我可能会担心我如何改进我的工作并做可能被视为正确的事情，而消极的攻击性或幼稚的观点会产生大量的文档，如果不是的话。

定义一个有效的开发人员是另一个要素。是最好的修复错误的人吗？新工作最快吗？新工作是否完成了测试和文档，即使它没有快速完成？你说什么是**有效** 的，因为这里应该澄清**“它取决于”标准响应。**

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-15T21:47:22.363

我喜欢的一个目标是：

征求项目客户对您参与项目的 N 项正面评价。

这很有帮助，因为从客户（内部或外部）那里获得一些书面的正面反馈总是好的。它不难获得，它是相关的，它是一个简单但并非毫无意义的勾选。

# sql-server - SQL Server 2005：读取提交事务隔离级别中的键范围锁？

> ID：446729
> 
> 赞同：3
> 
> 时间：2009-01-15T13:33:21.207
> 
> 标签：sql-server, locking, deadlock

我正在帮助解决使用 SQL Server 2005 的 .NET 应用程序中的一些死锁问题。我有来自下面跟踪的 XML 数据。

`PK_Exp_Experience_PriorFirm`真正让我困惑的是当事务隔离级别被读取提交时RangeX-X 锁定。

我读过的所有内容都表明您使用事务隔离级别“可序列化”只会获得一个键范围锁。到目前为止，我在我们的应用程序中找不到将隔离级别设置为读取提交以外的任何位置，并且下面的 XML 也表明我们正在使用读取提交。

但是，如果我们使用已提交读，我不明白跟踪如何显示存在键范围锁。有没有人知道如何发生这种情况？

```
<deadlock-list>
  <deadlock victim="processc2f438">
    <process-list>
      <process id="processc2f438" taskpriority="0" logused="13488" waitresource="KEY: 120:72057594583646208 (8201498b6efe)" waittime="484" ownerId="693258089" transactionname="user_transaction" lasttranstarted="2009-01-06T16:33:27.817" XDES="0xa71ce370" lockMode="U" schedulerid="1" kpid="9112" status="suspended" spid="53" sbid="0" ecid="0" priority="0" transcount="2" lastbatchstarted="2009-01-06T16:33:27.863" lastbatchcompleted="2009-01-06T16:33:27.863" clientapp=".Net SqlClient Data Provider" hostname="CHQAPT3" hostpid="6464" loginname="AppUser" isolationlevel="read committed (2)" xactid="693258089" currentdb="120" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
        <executionStack>
          <frame procname="adhoc" line="1" stmtstart="108" sqlhandle="0x0200000015d9962978fc6206b09e4c872150511b455e8923">
            UPDATE Exp_Experience_PriorFirm SET RelatedGuid = @newGuid WHERE RelatedGuid = @oldGuid
          </frame>
          <frame procname="mssqlsystemresource.sys.sp_executesql" line="1" sqlhandle="0x0400ff7fbe80662601000000000000000000000000000000">
            sp_executesql
          </frame>
          <frame procname="MyDb.dbo.Contact_MergeRelationships" line="74" stmtstart="4754" stmtend="4976" sqlhandle="0x0300780036a608461ed8af00669b00000100000000000000">
            EXEC sp_executesql @sql,
            N'@oldGuid uniqueidentifier, @newGuid uniqueidentifier',
            @oldGuid, @newGuid
          </frame>
          <frame procname="MyDb.dbo.Contact_Company_MergeRelationships" line="8" stmtstart="312" sqlhandle="0x03007800b271a129c8ccaf00669b00000100000000000000">
            EXEC Contact_MergeRelationships @oldGuid, @newGuid, 'Contact_Company', @excludedTableNames
          </frame>
        </executionStack>
        <inputbuf>
          Proc [Database Id = 120 Object Id = 698446258]
        </inputbuf>
      </process>
      <process id="processeb5d68" taskpriority="0" logused="14212" waitresource="KEY: 120:72057594594066432 (7c02a3a5890e)" waittime="2312" ownerId="693243114" transactionname="user_transaction" lasttranstarted="2009-01-06T16:33:20.957" XDES="0x8cdb9450" lockMode="S" schedulerid="2" kpid="9000" status="suspended" spid="73" sbid="0" ecid="0" priority="0" transcount="2" lastbatchstarted="2009-01-06T16:33:29.770" lastbatchcompleted="2009-01-06T16:33:29.770" clientapp=".Net SqlClient Data Provider" hostname="CHQAPT3" hostpid="6464" loginname="AppUser" isolationlevel="read committed (2)" xactid="693243114" currentdb="120" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
        <executionStack>
          <frame procname="MyDb.dbo.Contact_Company_Delete" line="27" stmtstart="1128" sqlhandle="0x03007800b0e5761877cbaf00669b00000100000000000000">
            DELETE FROM Contact WHERE GUID = @Guid;
          </frame>
        </executionStack>
        <inputbuf>
          Proc [Database Id = 120 Object Id = 410445232]
        </inputbuf>
      </process>
    </process-list>
    <resource-list>
      <keylock hobtid="72057594583646208" dbid="120" objectname="MyDb.dbo.Exp_Experience_PriorFirm" indexname="PK_Exp_Experience_PriorFirm" id="lockd1d43f80" mode="RangeX-X" associatedObjectId="72057594583646208">
        <owner-list>
          <owner id="processeb5d68" mode="RangeX-X"/>
        </owner-list>
        <waiter-list>
          <waiter id="processc2f438" mode="U" requestType="wait"/>
        </waiter-list>
      </keylock>
      <keylock hobtid="72057594594066432" dbid="120" objectname="MyDb.dbo.Contact_PersonCompanyLocation" indexname="PK_Contact_PersonCompanyLocation" id="lockd20c4380" mode="X" associatedObjectId="72057594594066432">
        <owner-list>
          <owner id="processc2f438" mode="X"/>
        </owner-list>
        <waiter-list>
          <waiter id="processeb5d68" mode="S" requestType="wait"/>
        </waiter-list>
      </keylock>
    </resource-list>
  </deadlock>
</deadlock-list> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T09:54:59.440

PK_Exp_Experience_PriorFirm 上的 RangeX-X 锁定被视为级联删除的一部分。

SQL Server 会自动将某些操作（例如级联删除）的隔离级别升级为可序列化。

此处对此进行了更详细的描述：[Conor vs. Isolation Level Upgrade on UPDATE/DELETE Cascading RI](https://docs.microsoft.com/en-us/archive/blogs/conor_cunningham_msft/conor-vs-isolation-level-upgrade-on-updatedelete-cascading-ri)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T14:50:13.190

正如您所料，您正在使用 READ COMMITTED。

如果 UPDATE 获取聚集索引上的排他键锁并修改行，并且该锁阻止了 SELECT 在聚集索引上的书签查找，则可能会发生此类死锁。

这种性质的锁通常可以通过创建一个覆盖的非聚集索引来消除。

您可以使用的另一个选项是`READ_COMMITTED_SNAPSHOT ON`为数据库设置。这改变了 SELECT 语句读取已提交数据的方式；它们不采用共享锁，而是读取在 SELECT 语句开始时开始的事务更改的任何数据的先前版本（快照）。不过，这并不是完全免费的。成本是增加的活动`tempDB`。[READ COMMITTED SNAPSHOT 模式下的触发器也可能出现问题。]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T05:13:31.313

另一个常见的解释可能与 IGNORE_DUP_KEY 选项设置为 ON 的 UNIQUE 索引有关。

From BOL - 此选项指定当插入操作尝试将重复的键值插入唯一索引时的错误响应。IGNORE_DUP_KEY 选项仅适用于创建或重建索引后的插入操作。该选项在执行 CREATE INDEX、ALTER INDEX 或 UPDATE 时无效。默认值为关闭。

**ON** 将重复键值插入唯一索引时将出现警告消息。只有违反唯一性约束的行才会失败。

**OFF** 将重复的键值插入唯一索引时将出现错误消息。整个 INSERT 操作将被回滚。

他们在这里没有提到的是，当启用此选项时，在 INSERTS 期间会强制执行 SERIALIZABLE 隔离。我个人还没有掌握这样做的内在要求，因为一些插入的行可能会被丢弃，仅此而已，但事实就是如此。让 SQL 开发团队在这里插话……

这种行为很容易证明；

首先创建一个具有典型 PK 的新表：

```
CREATE TABLE [dbo].[Test_RC_TIL_RangeLocks](
    [RID] [int] IDENTITY(1,1) NOT NULL,
    [Col1] [int] NOT NULL,
    [Col2] [int] NOT NULL,
    [Col3] [int] NOT NULL
) ON [PRIMARY] 
```

接下来，我们要在 IGNORE_DUP_KEY ON 的情况下在 Col1 和 Col2 上添加一个 UNIQUE 索引：

```
CREATE UNIQUE NONCLUSTERED INDEX [UIX_Test_RC_TIL_RangeLocks] ON [dbo].[Test_RC_TIL_RangeLocks](
    [Col1] ASC,
    [Col2] ASC
)WITH (
    PAD_INDEX  = OFF, 
    STATISTICS_NORECOMPUTE  = OFF, 
    SORT_IN_TEMPDB = OFF, 
    IGNORE_DUP_KEY = ON, --<<**THE OFFENDER**>>
    DROP_EXISTING = OFF, 
    ONLINE = OFF, 
    ALLOW_ROW_LOCKS  = ON, 
    ALLOW_PAGE_LOCKS  = ON) 
ON [PRIMARY] 
```

接下来我们将添加 5 行，看看会发生什么......

```
SET TRANSACTION ISOLATION LEVEL READ COMMITTED
DECLARE @C int
SELECT @C=5
BEGIN TRANSACTION
WHILE @C>0
BEGIN
    INSERT Test_RC_TIL_RangeLocks(Col1,Col2,Col3)
    VALUES (@C,@C+1,2*@C + 100)
    SET @C=@C-1
END
SELECT * FROM Test_RC_TIL_RangeLocks
EXEC sp_lock @@SPID
COMMIT 
```

正如预期的那样，我们添加了五行：

```
RID Col1    Col2    Col3
1   5       6       110
2   4       5       108
3   3       4       106
4   2       3       104
5   1       2       102 
```

我们感兴趣的锁是：

```
sid ObjId     IndId Type Resource                  Mode
53  0             0 DB                             S
53  0             0 DB                             S
53  402100473     1 KEY (8194443284a0)             X
53  402100473     2 KEY (550e0a2a4b96)             RangeX-X
53  402100473     2 KEY (ffffffffffff)             RangeS-U
53  1131151075    0 TAB                            IS
53  402100473     1 PAG 1:744                      IX
53  402100473     2 PAG 1:748                      IX
53  402100473     1 KEY (98ec012aa510)             X
53  402100473     1 KEY (a0c936a3c965)             X
53  402100473     2 KEY (ec04ac4bee1f)             RangeX-X
53  402100473     0 TAB                            IX
53  402100473     2 KEY (0207a0a08e23)             RangeX-X
53  402100473     2 KEY (7112ec63c430)             RangeX-X
53  402100473     1 KEY (59855d342c69)             X
53  402100473     1 KEY (61a06abd401c)             X
53  338100245     0 TAB                            IX 
```

啊，可怕的 SERIALIZABLE 键范围锁在简单插入的 READ COMMITTED 隔离级别下调用！

所以当 BOL 说；在发生键范围锁定之前，必须满足以下条件：

• 事务隔离级别必须设置为SERIALIZABLE。

请记住，这并不总是正确的......

ps 作为设计说明，盲目地消除可能具有唯一行值的重复键通常是不好的做法。更好的做法是确保您没有尝试在 INSERT 语句中插入重复的键...

干杯...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T14:47:50.917

根据 SQL Docs，不知何故，您的事务（或其他一些事务）在可序列化级别上运行。

[此处](http://technet.microsoft.com/en-us/library/ms191272%28v=sql.105%29.aspx)的键范围锁定文档。第一句话是：

*键范围锁保护隐式包含在由 Transact-SQL 语句读取的记录集中的一系列行，同时使用可**序列化**事务隔离级别。*

# facebook - 使用 Facebook API 创建和管理群组

> ID：446753
> 
> 赞同：3
> 
> 时间：2009-01-15T13:41:16.043
> 
> 标签：facebook

我是 Facebook 应用程序开发的新手，我正在寻找一种使用 Facebook API 创建和管理组的方法。有一个获取和获取列表调用，但我还没有找到管理组的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T16:08:46.900

看起来 API 已经发布： [https ://developers.facebook.com/docs/reference/api/app-game-groups/](https://developers.facebook.com/docs/reference/api/app-game-groups/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T17:20:56.483

在撰写本文时，还没有用于创建群组的 Facebook API 方法。但是，可以使用一些方法来获取特定组的详细信息。

有关更多信息，请参阅 API 文档，

[http://wiki.developers.facebook.com/index.php/API](http://wiki.developers.facebook.com/index.php/API)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-27T09:55:10.390

Facebook 表示，“在不久的将来”，开发者还可以通过 API 创建群组和管理群组成员资格。</p>

（2010 年 10 月 11 日）[http://www.insidefacebook.com/2010/10/11/groups-api-details-apotential/](http://www.insidefacebook.com/2010/10/11/groups-api-details-apotential/)

# c# - 如何在 .NET (C#) 中使用现有的 C++ 代码

> ID：446758
> 
> 赞同：3
> 
> 时间：2009-01-15T13:42:11.330
> 
> 标签：c#, c++, code-migration

我想创建一个 C# 项目并实现现有的本机 (C++) 代码。有谁知道任何关于它的好教程？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T13:44:45.457

您可以使用 P/Invoke 并且可以调用非托管方法。我会给你一些例子： [这](http://msdn.microsoft.com/en-us/library/aa288468.aspx)是对 MSDN 官方文档的参考。 [这](http://www.pinvoke.net/)是一个社区托管网站，其中包含大多数常见的 Windows 非托管库以及方法签名和示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T13:48:57.477

如果您的 C++ 代码是托管的（如您所说），那么我建议您将其保留为 C++ *，除非*您有充分的理由——未来的 C#（等）程序集应该能够按原样引用它'。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-18T16:28:27.957

我假设通过*实现现有代码*意味着您想从 C# 调用它，而对 C++ 代码的更改最少。

I'm a fan and recent purchaser of the book [C++/CLI in Action](http://www.manning.com/sivakumar/) which has a couple of useful sample chapters online.

This [intro on CodeProject](http://www.codeproject.com/KB/mcpp/quickcppcli.aspx) is a good starting point.

The author of C++/CLI in Action has a number of articles on CodeProject, scroll down to the C++/CLI section on [his index](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=20248).

The [Wikipedia article on P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services) has a number of reasons why you might not want to use that approach, with which I agree:

*   loss of typing support by the compiler
*   possible data type or alignment issues as you have to map types by hand
*   need to pin garbage-collected objects

The best starting point on MSDN is the [summary article](http://msdn.microsoft.com/en-us/library/ms235282.aspx).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T13:46:07.217

您为什么不尝试为您的 C++ 代码使用托管包装器。

[http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vcmxspec/html/vcmg_accessingcodefromframeworkobjects.asp](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vcmxspec/html/vcmg_accessingcodefromframeworkobjects.asp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T13:50:14.480

可能最简单的方法是创建一个 C++/CLI 项目，这将使您能够混合托管和非托管 C++。然后，您可以使用 C# 代码可以直接调用的托管 .Net 包装器来包装现有的非托管 C++ 类。MSDN 杂志有[一篇](http://msdn.microsoft.com/en-us/magazine/cc163681.aspx)关于 C++/CLI 的很好的介绍性文章。

互操作只会对调用 C 风格的函数真正有用。您不能真正使用它与纯 C++ 类进行交互。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T13:50:34.340

我通过这样做学到了这一点，所以我没有一个好的教程，但有几件事你需要注意 - 托管 C++ 和 C++/CLI 都与非托管代码集成，几乎没有难看的接缝。这不是 C# 的情况。在托管 C++ 中，很可能执行以下操作：

```
dotNetForm->Text = S"My Project"; // regular managed code
::SetWindowText(dotNetForm->Handle, "Your Project"); // mixed managed/unmanaged 
```

而在 C# 中，您必须 P/Invoke 到 SetWindowText 中——并不是您真的会这样做：这只是一个简单的示例，但您需要注意托管 C++ 编译器是一个奇怪的组合，它透明地为您执行大量互操作同时什么也不为你做（即，它不会做任何隐含的编组）。

# ruby-on-rails - 如何使用 flex 在 Rails 上提交多个模型？

> ID：446760
> 
> 赞同：0
> 
> 时间：2009-01-15T13:42:54.697
> 
> 标签：ruby-on-rails, apache-flex

我正在尝试使用具有多个模型的 flex 向 Rails 提交创建和更新请求。例如，假设我们有一篇博文和多条评论。

用户来更新帖子和一些评论，当他点击提交时，我想发送所有更新。

如果我发送类似：

```
var params:Object = new Object();
params["post[text]"] = myPostText;
params["post[userid]"] = myPostUserId; 
```

然后我可以发送一个带有评论的数组：

```
var ar:Array = ["comment 1", "comment 2"];
params["post[comments]"] = ar; 
```

这项工作没有问题（避免具有相同名称的多个属性的问题）。

但我的问题是，对于我需要提交多个属性的评论，假设对于我需要提交排名的每条评论，我尝试这样做（伪代码）：

```
var ar:Array = new Array();
for each comment c {
   ar.push({"text":c.text, "rank":c.rank});
}
params["post[comments]"] = ar; 
```

这不起作用，因为对于每个评论，rails 端的哈希参数将包含字符串“[object Object]”。

有谁知道将 flex 上的多个模型提交到 rails 的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-11T01:12:03.140

其实我有。忘记使用那些参数对象而只使用 XML，它比那些参数对象更容易，并且您可以有一种方法来序列化您的 flex 对象。

使用 XML，您只需要使用嵌套的对象来构建它（就像 rails 为您所做的那样）。

唯一的问题是你不能在 flex 中使用太多的 REST，因为 flex 不支持所有 HTTP 操作，所以为了进行更新，我做了一个解决方法，并在 application_controller 上创建了一个 flex_update 方法，在更新期间使用 POST 调用，这个方法很简单调用默认更新方法，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-05T01:33:10.357

您是否尝试过[**RubyAMF**](http://code.google.com/p/rubyamf/)而不是 XML？

# c# - ASP.NET MVC 中的 values 参数是怎么回事？

> ID：446765
> 
> 赞同：1
> 
> 时间：2009-01-15T13:44:00.467
> 
> 标签：c#, asp.net-mvc

我看到有，`Controller.RedirectToAction(string actionName, string controllerName, object values)`但我从来没有让*values*参数起作用。考虑我想在控制器中执行以下操作重载：

```
public ActionResult Read() 
{
    return RedirectToAction("ReadPage", "MyController", 1);
}

public ActionResult ReadPage(int page)
{
    // Doing the actual stuff 
} 
```

…当我尝试去`Read`行动时，我得到了例外。也是如此`Html.ActionLink`。

那是怎么回事？你可以在 MVC 中完全不用浏览器就将值传递给控制器​​吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:46:12.583

尝试使用：

```
return RedirectToAction("ReadPage", "MyController", new {page = 1}); 
```

它需要知道你指的是哪个参数（在更一般的情况下，你可以有很多参数），它可以从上面推断出来。

匿名类型模式（上图）在 ASP.NET MVC 中非常常见，尽管在很多情况下我相信您也可以给它一个填充字典来表示相同的含义。

另外 - 在这种情况下不需要两个动作；您可以设置路线以提供默认值；这是我之前发布的一些内容：

```
 public ActionResult Search(string query, int startIndex, int pageSize)
    {
        ...
    } 
```

路线：

```
 routes.MapRoute("Search", "Search/{query}/{startIndex}",
             new {
                controller = "Home", action = "Search",
                startIndex = 0, pageSize = 20
             }); 
```

现在，如果我不提供 startIndex，它会默认将 0 传递给我的搜索。所以我可以导航到“/Foo”进行默认搜索，或者导航到“/Foo/100”从 100 开始进行相同的搜索。或者，参数可以在查询字符串上，并且仍然会使用来自的值默认匿名类型。

# language-agnostic - 你会从什么单元测试开始？

> ID：446777
> 
> 赞同：5
> 
> 时间：2009-01-15T13:48:11.443
> 
> 标签：language-agnostic, testing, tdd

当您对系统的一部分应该如何工作提出总体设计/想法时，您如何决定在进行 TDD 时从哪里开始，或者更确切地说，您如何决定从第一个测试开始？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T13:59:32.073

假设我正在编写一个名为`Oven`烘焙我的美味`Pie`对象的类。这就是我逐步完成单元测试顺序的方式：

1.  我需要做什么来实例化对象？在这种情况下，我想这很可能是`Oven oven = new Oven();`没有测试。
2.  如何准备对象以供使用？`oven.turnOn(int degrees)`听起来不错，我会这样做的。我该如何检查？更好地制作`oven.getTemperature()`. 有一个明显的测试。
3.  好的，烤箱现在足够热了，我想烤我的`Pie`。为此，我需要`oven.bake(Pie p)`，所以我会做到的。但现在呢？我想检查馅饼是否准备好了，而不是让`oven.isPieReady()`我认为`oven.pastryStatus()`返回“烤箱里什么都没有”、“生”、“几乎完成”、“煮熟”和“烧焦”之类的东西听起来不错，总的来说应该更多可扩展比`oven.isPieReady()`所以我会这样做。

等等等等。因此，我将进行测试，以便我期望使用对象来完善规范。最后，我通常会得到相当简单但功能强大的 API，它可以满足我的需求。在对我的 API 进行单元测试后，我对我的代码运行覆盖以查看我错过了什么，然后为这些添加额外的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T09:09:55.257

当面对要实施的测试列表时，您将拥有类别

1.  微不足道的测试，但你确定你可以完成这项工作。
2.  不平凡，但你有足够的信心完成它。
3.  不平凡但困难 - 绝对没有完成它的线索。

在这种情况下，请从 Category2 存储桶中选择一个，因为它将提供每单位投入时间的最大知识/学习。此外，它还会让您滚动并增强信心，以应对更困难的类别 3 测试。

我想我是从[TDD By Example](https://rads.stackoverflow.com/amzn/click/com/0321146530) - Kent Beck 那里得到的。有时间的话可以看看。推荐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T09:36:21.570

我在内部教授 TDD 课程已经有一段时间了，很多参与者都是从测试所有错误案例开始的。尽管它们可能相关，但这不是启动 imo 的最佳方式。

从设置测试开始，这些测试很容易实现，并且仍然会告诉您在尝试实现的功能方面是否朝着正确的方向前进。因此，如果您正在构建堆栈，请确保在测试错误案例之前验证 push 和 pop。

请记住，测试的目标不仅是验证行为，还要让您使用被测类型的接口。如果编写测试感觉不对，您可能需要更改界面。

一个好主意是向后执行每个测试用例。所以从编写 Assert 语句开始。这是本次测试的验证目标。然后添加任何必要的步骤以达到您可以执行 Assert 所做的事情的程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T13:54:31.227

我将为最独立/最低级别的功能构建一组单元。一旦你让这些类通过了每一个测试，你就可以继续前进，假设它们在被更多依赖的功能调用时可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T13:55:28.183

这些是我认为对单元测试优先级有用的通用指南：

1) 识别边界对象（Win/WebForms、CustomControls 等）。

2）识别控制对象（业务层对象）

3) 只为边界对象调用的控制对象公共方法编写单元测试。这样您就可以确保您涵盖了应用程序的主要功能方面。

您可以使用这些规则来确定单元测试的优先级——然后，如果您需要对其他内容进行微测试，您也可以根据自己的需要进行操作。

# python - 摆脱 Python 中的函数

> ID：446782
> 
> 赞同：9
> 
> 时间：2009-01-15T13:48:51.737
> 
> 标签：python, exception, function

我想在发生异常时退出函数。我想使用“return”以外的其他方法

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-15T13:54:39.883

如果你捕获一个异常然后想重新抛出它，[这个模式](http://nedbatchelder.com/blog/200711/rethrowing_exceptions_in_python.html)非常简单：

```
try:
    do_something_dangerous()
except:
    do_something_to_apologize()
    raise 
```

当然，如果您想首先*引发*异常，那也很容易：

```
def do_something_dangerous(self):
    raise Exception("Boo!") 
```

如果这不是您想要的，请提供更多信息！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T13:54:31.443

除了a）返回，b）抛出异常或c）终止程序的执行之外，想不出另一种方法来“退出”函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T13:56:27.867

异常本身将终止函数：

```
def f():
    a = 1 / 0  # will raise an exception
    return a

try:
    f()
except:
    print 'no longer in f()' 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-15T22:36:33.137

正如其他人指出的那样，异常将使您退出该方法。你不应该因为例外而感到羞耻或尴尬；异常表示**错误**，但这不一定与**错误**相同。

例如，假设我正在编写阶乘函数。没有为负数定义阶乘，所以我可以这样做：

```
def factorial(n):
  if n < 0:
    raise ValueError
  if n == 0:
    return 1
  return n*factorial(n-1) 
```

然后我会寻找异常：

```
n = raw_input('Enter a number.')
try:
  print factorial(n)
except ValueError:
  print 'You entered a negative number.' 
```

通过定义我自己的异常，我可以使异常比 ValueError 提供更多信息：

```
class NegativeInputError(Exception):
  pass

# in the function:
if n < 0:
  raise NegativeInputError 
```

！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-15T13:57:05.760

假设您想在该方法内部“停止”执行。你可以做几件事。

1.  **不要捕获异常。**这会将控制权返回给最初调用它的方法。然后你可以用它做任何你想做的事情。
2.  **sys.exit(0)**这个实际上退出了整个程序。
3.  **return**我知道你说过你不想回来，但听我说完。Return 很有用，因为根据您返回的值，这将是让您的用户知道出了什么问题的好方法。

# sql-server - 将列值生成为 CSV T-SQL 2000

> ID：446783
> 
> 赞同：2
> 
> 时间：2009-01-15T13:48:53.220
> 
> 标签：sql-server

嘿，假设我们有一个查询，它生成城市名称列表作为输出。

1.印度 2.美国

现在，如果我们想让这些数据看起来像 CSV 即

印度、美国

那么我们将如何在 MS SQL 2000 中生成它

在 2005 年，我使用 XM Path 完成了这项工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T14:01:35.440

假设您的查询位于名为 Table 的表中，其中包含名为 Nation 的字段：

```
DECLARE @rval varchar(5000)
SELECT @rval = COALESCE(@rval + ',','') + Nation FROM Table
SELECT @rval 
```

如果你有印度，还有美国……它会回来：印度，美国

# visio - 功能类似于 MS VISIO 的免费工具

> ID：446786
> 
> 赞同：6
> 
> 时间：2009-01-15T13:49:32.423
> 
> 标签：visio

有没有提供类似于 MS Visio 功能的免费工具或软件包？

我正在寻找可以创建数据库、大多数 UML 和应用程序流程图的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T13:59:56.847

看看[DIA](http://www.gnome.org/projects/dia/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-11T22:13:05.693

Gliffy 看起来不错，而且价格便宜，有免费选项：[http ://www.gliffy.com](http://www.gliffy.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T14:22:21.093

这里有很多有趣的程序：[http ://www.osalt.com/visio](http://www.osalt.com/visio)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T03:33:42.203

结帐[FreelyDraw](http://freelydraw.com)。它是一个专业的、易于使用的图表工具，与 visio 相比体积小，但功能仍然齐全，值得一试。现在它支持 Windows 和 MacOS。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T13:54:57.950

[Argo UML](http://argouml.tigris.org/)不是 visio，但可以用来制作 UML 绘图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T14:18:53.377

[开放式办公室抽奖](http://www.openoffice.org/product/draw.html)有带有粘性连接器的盒子，我觉得在那些时候我觉得可以，我只想要一个简单的快速简单的图表，几乎没有形式主义。Argo UML 在形式上稍微正确一些，但您并不总是在形式上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-15T15:15:14.293

针对不同的目的，不同的方案。

应用程序流比手绘更好。Graphviz dot 非常适合它。然后，您可以键入以下内容：

```
digraph{
  step1 -> step2;
  step2 -> step3;
  step2 -> step4 [label="optional"];
} 
```

一种用于有向图的简单领域特定语言。它有据可查，并具有跨平台实现。它也适用于生成类图，但你可能不想直接为它使用它的 DSL（只需编写一个小程序来生成它）

对于数据库，我使用了 Fabforce DbDesigner。还有一个支持 SQL-server 的版本。

[http://www.fabforce.net/dbdesigner4/](http://www.fabforce.net/dbdesigner4/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-15T15:28:42.767

[StarUML](http://staruml.sourceforge.net/en/)看起来不错，只是它没有任何数据库图表功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-16T16:21:33.610

[Dia](http://projects.gnome.org/dia/)非常适合我，无论是简单的绘图还是 UML。我知道它并不完美，但它确实可以完成这项工作。对于思维导图（它们很有用），我使用[freemind](http://freemind.sourceforge.net/wiki/index.php/Main_Page)。

不要让丑陋的网站欺骗你，它们都是很棒的软件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-12T12:43:27.387

[ARIS Express](http://www.ariscommunity.com/aris-express)是 Visio 的免费替代方案。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-04-27T09:06:42.150

[可可](http://www.cacoo.com)非常好。它是一个基于 Flash 的 Web 应用程序，非常像一个更友好的 Visio。大约有 20 套形状可供选择，从电子电路到办公室布局再到 UML。甚至 iPhone 和 Android UI 形状。它是免费的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-08-16T07:08:31.707

您也可以尝试[my.origramy](http://my.origramy.com/index.html) - 它是用于构建图表、方案等的免费在线服务。它基于 Flash 编辑器/查看器组件。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-07-03T05:20:16.640

这取决于您所说的功能。在我看来，Visio 与其说是一种绘图，不如说是一种数据处理和可视化工具。在表面之下，所有元素都由专门的计算表制成，可以处理形状的外观和行为。有明显更好的绘图工具，但没有一个具有如此复杂的计算能力。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-12-01T17:42:01.657

查看[LucidChart](http://www.lucidchart.com)。它非常快速且易于使用。他们有一个有限的免费账户，他们的付费账户是合理的。

# c# - 我想自动生成代码

> ID：446791
> 
> 赞同：-1
> 
> 时间：2009-01-15T13:50:48.923
> 
> 标签：c#, asp.net, asp.net-ajax

我有一个大型 SQL Server 数据库，我想从数据库中自动生成 ASP.NET 和 AJAX 代码。

我可以使用任何免费工具（请只告诉免费工具）吗？

我还希望该工具仅生成 C# 代码。任何关于该工具的文章/白皮书都值得赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:57:56.210

您看过文本模板转换工具包 (T4) 吗？

[这篇文章](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)有很多关于它的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T13:54:28.277

你看过[MyGeneration](http://www.mygenerationsoftware.com/portal/default.aspx)吗？

@Viks 对 ASP.NET 动态数据的建议是一个很好的建议，但您应该检查它是否已准备好用于生产版本：

[http://weblogs.asp.net/scottgu/archive/2007/12/14/new-asp-net-dynamic-data-support.aspx](http://weblogs.asp.net/scottgu/archive/2007/12/14/new-asp-net-dynamic-data-support.aspx)

[http://www.asp.net/dynamicdata/](http://www.asp.net/dynamicdata/)

[http://www.codeplex.com/aspnet/Wiki/View.aspx?title=Dynamic%20Data&referringTitle=Home](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=Dynamic%20Data&referringTitle=Home)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:02:42.550

我建议使用来自：**System.CodeDom**命名空间的类，并结合：System.Web.Compilation.BuildProvider 类。如需综合教程，请参阅：[Microsoft .NET CodeDom 技术 - 第 1 部分，作者：Brian J. Korzeniowski](http://www.15seconds.com/Issue/020917.htm)

# winforms - 在具有可能为空属性的对象图上的 Windows 窗体中的数据绑定？

> ID：446792
> 
> 赞同：1
> 
> 时间：2009-01-15T13:50:49.347
> 
> 标签：winforms, data-binding

如果我有这样的对象图：

```
class Company {
  public Address MainAddress {...}
}

class Address {
  public string City { ... }
}

Company c = new Company();
c.MainAddress = new Address();
c.MainAddress.City = "Stockholm"; 
```

并使用以下方法将数据绑定到控件：

```
textBox1.DataBinding.Add( "Text", c, "MainAddress.City" ); 
```

一切都很好，但如果我绑定到：

```
Company c2 = new Company(); 
```

`c2`使用相同的语法它崩溃，因为`MainAddress`属性为空。我想知道是否有一个自定义 Binding 类可以在此处为所有可能的路径设置侦听器，并在/如果我稍后在应用程序中设置`MainAddress`属性时动态绑定到实际对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-07T02:35:13.763

您应该更改属性 MainAddress 的 getter 以执行此 null 检查，并返回“空 MainAddress”

# com - iTunes COM/AppleScript - 播客 RSS

> ID：446798
> 
> 赞同：3
> 
> 时间：2009-01-15T13:52:10.093
> 
> 标签：com, rss, applescript, itunes

我需要从 iTunes 获取 RSS 订阅列表。我正在使用 Apple 提供的用于控制 iTunes 的 COM 接口，并且在 Windows 和 Mac 上都尝试过。

例如

```
tell application "iTunes"
    repeat with a_track in tracks of playlist "Podcasts"
        get artist of a_track
        get album of a_track
        get name of a_track
        get rating of a_track
    end repeat
end tell 
```

我可以获得播客剧集的列表，但不能获得它们对应的 RSS URL。iTunes 似乎将所有剧集作为曲目放在“播客”播放列表中，但似乎没有任何类型的分组，正如您对窗口中显示的内容所期望的那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T20:45:09.960

不幸的是，iTunes 似乎没有提供这些信息（如果它甚至使用 RSS 提要来处理播客）。没有通过 AppleScript 公开的 URL，也没有存储在 ID3 标签或 iTunes 音乐库 XML 文档中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T20:17:28.467

在尝试找到相同的信息之前，我已经在 iTunes 上进行了一番探索。

**我也没有设法找到实际播客提要的 URL，但您可以在address**属性下获取尚未下载的曲目的 URL 。

如果曲目已下载到磁盘，则该曲目将没有**地址属性，但在其****位置**属性下将具有文件的别名。

# jquery - 如何将 jquery 与 asp.net ajax 一起使用

> ID：446816
> 
> 赞同：2
> 
> 时间：2009-01-15T13:56:55.713
> 
> 标签：jquery, asp.net-ajax

你能告诉我使用 ajax 的 jquery 示例吗？

我可以将 UpdatePanel 和 jQuery 行为结合起来吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T14:22:27.083

我正在将 jQuery 与 ASP.NET Ajax 结合使用一段时间，但从未使用过 jQuery.NoConflict() 方法。它彼此相邻工作正常。

Matt Berseth 有一些关于一起使用它们的文章（以及许多其他很棒的文章）

[http://mattberseth.com/blog/2008/06/getting_jquery_goodness_into_a.html](http://mattberseth.com/blog/2008/06/getting_jquery_goodness_into_a.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T14:12:14.980

如果你可以`jQuery.noConflict();`足够快地调用，你可以停止它绑定到`$`.

这意味着您必须将 jQuery 称为`jQuery`. 您也可以使用 return of`noConflict`将其设置为另一个名称：

```
$jq = jQuery.noConflict();
$jq('#div-id').whatever... 
```

这不一定对您有帮助，但它*应该*停止存在冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T14:27:11.333

如果您不知道，[Microsoft 正计划进一步支持 jQuery](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)，并且他们已经允许 Intellisense 与 jQuery 一起工作。

我不确定为什么你需要停止与 jQuery 的冲突，但它们似乎彼此相邻工作正常。我在工作中开发这两种技术都没有问题。

所以答案是肯定的，但这取决于你想做什么；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T13:59:58.733

您可能可以使用 jquery 来执行本地 DHTML 操作，但 AFAIK、jQuery 和 ASP.NET（常规）不能成为很好的伙伴。但是，jQuery 和 ASP.NET MVC 可以**非常**整齐地协同工作。常规 ASP.NET 中的视图状态等使它有点混乱，我会坚持使用 MS 产品与常规 ASP.NET 与服务器通信。

# php - 将 IMG 拉入 PHP 文件

> ID：446819
> 
> 赞同：0
> 
> 时间：2009-01-15T13:57:24.747
> 
> 标签：php, image, gd

我在同一目录中有一个 PHP 文件和一个图像。我怎样才能让 PHP 文件将其标题设置为 jpeg 并将图像“拉”到其中。所以如果我去 file.php 它会显示图像。如果我将 file.php 重写为 file_created.jpg 并且它需要工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-15T14:15:49.687

与其按照另一个答案的建议使用[file_get_contents ，不如使用](http://php.net/file_get_contents)[readfile](http://php.net/readfile)并输出更多 HTTP 标头以正常播放：

```
 <?php
    $filepath= '/home/foobar/bar.gif'
    header('Content-Type: image/gif');
    header('Content-Length: ' . filesize($filepath));
    readfile($file);
   ?> 
```

readfile 从文件中读取数据并直接写入输出缓冲区，而 file_get_contents 将首先将整个文件拉入内存然后输出。如果文件非常大，使用 readfile 会有很大的不同。

如果你想变得更可爱，你可以输出最后修改时间，并检查传入的 http 头中的[If-Modified-Since](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.25)头，并返回一个空的 304 响应告诉浏览器他们已经有了当前版本....这是一个更完整的示例，展示了您如何做到这一点：

```
$filepath= '/home/foobar/bar.gif'

$mtime=filemtime($filepath);

$headers = apache_request_headers(); 
if (isset($headers['If-Modified-Since']) && 
    (strtotime($headers['If-Modified-Since']) >= $mtime)) 
{
    // Client's cache IS current, so we just respond '304 Not Modified'.
    header('Last-Modified: '.gmdate('D, d M Y H:i:s', $mtime).' GMT', true, 304);
    exit;
}

header('Content-Type:image/gif');
header('Content-Length: '.filesize($filepath));
header('Last-Modified: '.gmdate('D, d M Y H:i:s', $mtime).' GMT');
readfile($filepath); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T14:06:56.240

应该很容易：

```
<?php
    $filepath= '/home/foobar/bar.jpg';
    header('Content-Type: image/jpeg');
    echo file_get_contents($filepath);
?> 
```

您只需要弄清楚如何确定正确的 mime 类型，这应该很简单。

# c# - 网格视图组合框

> ID：446825
> 
> 赞同：1
> 
> 时间：2009-01-15T13:59:13.323
> 
> 标签：c#, datagridview, datagridviewcombobox

如何将项目添加到数据网格视图组合框

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T15:36:31.787

[你在这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcomboboxcolumn.aspx)有一个很好的例子。基本上，组合框的创建和填充独立于数据绑定。

这是一个非常笼统的问题。如果您有更具体的问题，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-28T22:13:10.397

首先使用这样的模板字段将广告下拉列表添加到您的 gridview 确保将 OnRowCreated 事件添加到您的 gridview

```
<asp:GridView ID="GridView1" runat="server" OnRowCreated="GridView1_RowCreated">
<Columns>
                        <asp:TemplateField HeaderText="Prerequisite Course">
                            <ItemStyle HorizontalAlign="Center" />
                            <ItemTemplate>
                                <asp:DropDownList ID="ddlPrerequisiteCourseCode" runat="server">
                                </asp:DropDownList>
                            </ItemTemplate>
                        </asp:TemplateField>
</Columns>
  </asp:GridView> 
```

接下来在后面的代码中将 GridView1_RowCreated 事件添加到您的 GridView

```
protected void GridView1_RowCreated(object sender, GridViewRowEventArgs e)
        {

                if (e.Row.RowType == DataControlRowType.DataRow)
                {
                    // Bind drop down to PrerequisiteCourseCodes
                    DropDownList ddl = (DropDownList)e.Row.FindControl("ddlPrerequisiteCourseCode");
                    ddl.DataSource = PrerequisiteCourseCodeList;
                    ddl.DataBind();
                }

        } 
```

# c# - 如何检测 jpeg 是否包含 cmyk 颜色配置文件？

> ID：446834
> 
> 赞同：8
> 
> 时间：2009-01-15T14:02:55.343
> 
> 标签：c#, jpeg

我有一些代码可以缩放用户上传的图像。它在大多数情况下都能完美运行，但有时他们会上传包含 cmyk 信息的 jpeg。

谷歌搜索了一下，似乎带有 cmyk 值的 jpeg 无效，但由于它们在 Windows 中工作，用户认为这是我的应用程序的问题，所以我需要能够处理这些情况。问题：

如何检测 jpeg 是否包含 cmyk 信息？（它可以让我通知用户为什么它不起作用）。

如何将其转换为普通的 jpeg？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-06T16:28:53.307

在 ASP.NET 中，您可以借助 System.Drawing.Imaging.ImageFlags 枚举确定是否使用 CMYK 配置文件保存 JPG，

[http://msdn.microsoft.com/en-us/library/system.drawing.imaging.imageflags(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.imageflags(VS.80).aspx)

假设您有一个基本的 aspx 页面，用户在其中上传文件，您需要告诉，

1）它是jpg吗？2）它使用RGB吗？

你的 aspx 可能是这样的，

```
<form id="form1" runat="server" enctype="multipart/form-data">
<asp:FileUpload ID="myUpload" runat="server" />
<asp:Button ID="submitButton" runat="server" Text="Submit" OnClick="Click_submitButton" />      
<br /><br />     
<asp:Literal ID="feedback" runat="server" />
</form> 
```

然后对于您的代码（C#），您可以这样做，

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Click_submitButton(object sender, EventArgs e)
    {
        if (myUpload.HasFile && isUploadAJpeg(myUpload.PostedFile))
        {
            System.Drawing.Bitmap uploadedImage = new System.Drawing.Bitmap(myUpload.PostedFile.InputStream);
            if (isFileACMYKJpeg(uploadedImage))
            {
                feedback.Text = "The file is a CYMK jpg";
            }
            else
            {
                feedback.Text = "This is a RGB jpg";
                //it is a rgb jpg --> do something with it
            }
        }
        else
        {
            feedback.Text = "You did not upload a jpg";
        }
    }

    protected bool isUploadAJpeg(HttpPostedFile someFile)
    {
        if (someFile.ContentType == "image/jpg" || someFile.ContentType == "image/jpeg" || someFile.ContentType == "image/pjpeg")
        {
            return true;
        }
        return false;
    }

    protected bool isFileACMYKJpeg(System.Drawing.Image someImage)
    {
        System.Drawing.Imaging.ImageFlags flagValues = (System.Drawing.Imaging.ImageFlags)Enum.Parse(typeof(System.Drawing.Imaging.ImageFlags), someImage.Flags.ToString());
        if (flagValues.ToString().ToLower().IndexOf("ycck") == -1)
        {
            return false;
        }
        return true;
    }
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T14:16:01.090

Jpeg 是一种标准，它支持比特流内任意数量的编码平面（它们相互独立压缩），因此具有 cmyk 配置文件的 jpeg 是完全有效的。大多数 jpeg 文件使用 jfif 容器 ( [http://en.wikipedia.org/wiki/JFIF](http://en.wikipedia.org/wiki/JFIF) ) 进行编码，该容器最初仅支持灰度图像、YCbCr 或 sRGB，但它是可扩展的，并且 Adob​​e 有一个自定义标签来支持 cmyk 配置文件.

查看此链接以获取解决方法 [http://www.jroller.com/greenhorn/entry/adobe_photoshop_and_jpeg_cmyk](http://www.jroller.com/greenhorn/entry/adobe_photoshop_and_jpeg_cmyk)，它在 java 中，但您可以轻松地将其移植到 c#。

# c# - 在 C# 中，两个问号一起意味着什么？

> ID：446835
> 
> 赞同：1868
> 
> 时间：2009-01-15T14:03:13.423
> 
> 标签：c#, null-coalescing-operator

跑过这行代码：

```
FormsAuth = formsAuth ?? new FormsAuthenticationWrapper(); 
```

两个问号是什么意思，是不是某种三元运算符？在 Google 中很难查找。

* * *

## 回答 #1

> 赞同：2454
> 
> 时间：2009-01-15T14:04:33.797

它是空合并运算符，非常类似于三元（立即如果）运算符。又见[?? 运营商 - MSDN](https://docs.microsoft.com/en-in/dotnet/csharp/language-reference/operators/null-coalescing-operator)。

```
FormsAuth = formsAuth ?? new FormsAuthenticationWrapper(); 
```

扩展为：

```
FormsAuth = formsAuth != null ? formsAuth : new FormsAuthenticationWrapper(); 
```

进一步扩展为：

```
if(formsAuth != null)
    FormsAuth = formsAuth;
else
    FormsAuth = new FormsAuthenticationWrapper(); 
```

在英语中，它的意思是“如果左边的不是空的，就用那个，否则就用右边的。”

请注意，您可以按顺序使用任意数量的这些。以下语句将分配第一个非空值`Answer#`（`Answer`如果所有答案都为空，`Answer`则为空）：

```
string Answer = Answer1 ?? Answer2 ?? Answer3 ?? Answer4; 
```

* * *

另外值得一提的是，虽然上面的扩展在概念上是等价的，但每个表达式的结果只计算一次。例如，如果表达式是具有副作用的方法调用，这一点很重要。（感谢@Joey 指出这一点。）

* * *

## 回答 #2

> 赞同：310
> 
> 时间：2009-01-15T14:07:52.727

只是因为还没有人说出神奇的话：它是**空合并运算符**。[它在C# 3.0 语言规范](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/CSharp%20Language%20Specification.doc)的第 7.12 节中定义。

它非常方便，特别是因为它在表达式中多次使用时的工作方式。形式的表达：

```
a ?? b ?? c ?? d 
```

`a`如果它是非空的，将给出表达式的结果，否则为 try `b`，否则为 try `c`，否则为 try `d`。它在每一点短路。

此外，如果 的类型`d`不可为空，则整个表达式的类型也不可为空。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2009-01-15T14:05:32.733

它是空合并运算符。

[http://msdn.microsoft.com/en-us/library/ms173224.aspx](http://msdn.microsoft.com/en-us/library/ms173224.aspx)

是的，除非你知道它叫什么，否则几乎不可能搜索到！:-)

编辑：这是另一个问题的一个很酷的功能。你可以把它们串起来。

[C#的隐藏特性？](https://stackoverflow.com/questions/9033/hidden-features-of-c#15765)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-01-15T14:09:36.267

谢谢大家，这是我在 MSDN 网站上找到的最简洁的解释：

```
// y = x, unless x is null, in which case y = -1.
int y = x ?? -1; 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-12-16T10:30:05.330

![在此处输入图像描述](https://i.stack.imgur.com/LHdqP.png)

两个问号 (??) 表示它是一个 Coalescing 运算符。

合并运算符从链中返回第一个 NON-NULL 值。你可以看到[这个 youtube 视频](http://www.youtube.com/watch?v=YJGGmTNHPeo)，它实际上展示了整个事情。

但是，让我在视频中添加更多内容。

如果您看到合并的英文意思，它表示“合并在一起”。例如下面是一个链接四个字符串的简单合并代码。

所以 if `str1`is`null`它会尝试`str2`， if `str2`is`null`它会尝试`str3`等等，直到它找到一个非空值的字符串。

```
string final = str1 ?? str2 ?? str3 ?? str4; 
```

简单来说，Coalescing 运算符从链中返回第一个 NON-NULL 值。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-15T14:05:07.913

`??`当值为空时，是否为可空类型提供值。因此，如果 formsAuth 为空，它将返回新的 FormsAuthenticationWrapper()。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2009-01-15T14:05:35.853

这是三元运算符的简写。

```
FormsAuth = (formsAuth != null) ? formsAuth : new FormsAuthenticationWrapper(); 
```

或者对于那些不做三元的人：

```
if (formsAuth != null)
{
  FormsAuth = formsAuth;
}
else
{
  FormsAuth = new FormsAuthenticationWrapper();
} 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-06-30T17:16:22.673

如果你熟悉 Ruby，我觉得它`||=`类似于 C# `??`。这是一些红宝石：

```
irb(main):001:0> str1 = nil
=> nil
irb(main):002:0> str1 ||= "new value"
=> "new value"
irb(main):003:0> str2 = "old value"
=> "old value"
irb(main):004:0> str2 ||= "another new value"
=> "old value"
irb(main):005:0> str1
=> "new value"
irb(main):006:0> str2
=> "old value" 
```

在 C# 中：

```
string str1 = null;
str1 = str1 ?? "new value";
string str2 = "old value";
str2 = str2 ?? "another new value"; 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-01-15T14:05:52.373

合并算子

相当于

```
FormsAuth = formsAUth == null ? new FormsAuthenticationWrapper() : formsAuth 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2013-03-21T21:13:32.677

这没有什么危险的。事实上，它是美丽的。如果需要，您可以添加默认值，例如：

**代码**

```
int x = x1 ?? x2 ?? x3 ?? x4 ?? 0; 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2016-10-30T02:43:50.683

正如许多答案中正确指出的那样，“空合并运算符”（**??**），说到它，您可能还想查看它的表亲“空条件运算符”（**?.**或**?[**），它是一个运算符很多时候它与**？？**

[空条件运算符](https://msdn.microsoft.com/en-us/library/dn986595.aspx)

> 用于在执行成员访问 ( **?.** ) 或索引 ( **?[** ) 操作之前测试 null。这些运算符可帮助您编写更少的代码来处理空值检查，尤其是在下降到数据结构时。

例如：

```
// if 'customers' or 'Order' property or 'Price' property  is null,
// dollarAmount will be 0 
// otherwise dollarAmount will be equal to 'customers.Order.Price'

int dollarAmount = customers?.Order?.Price ?? 0; 
```

没有的旧方式**？**和**??** 这样做是

```
int dollarAmount = customers != null 
                   && customers.Order!=null
                   && customers.Order.Price!=null 
                    ? customers.Order.Price : 0; 
```

这更加冗长和繁琐。

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2009-01-15T14:31:04.023

仅供娱乐（知道你们都是 C# 人 ;-)。

我认为它起源于 Smalltalk，它已经存在很多年了。它在那里定义为：

在对象中：

```
? anArgument
    ^ self 
```

在 UndefinedObject（又名 nil 的类）中：

```
? anArgument
    ^ anArgument 
```

有评估（？）和非评估版本（？？）。
它经常出现在惰性初始化私有（实例）变量的 getter 方法中，在真正需要之前将其保留为 nil。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2017-03-14T18:48:21.200

# *笔记：*

我已经阅读了整个这个线程和许多其他线程，但我找不到像这样彻底的答案。

通过它我完全理解了“为什么使用？？以及何时使用？？以及如何使用？？”。

# *来源：*

Craig McMurtry 发起的 Windows 通信基础 ISBN 0-672-32948-4

# *可空值类型*

有两种常见的情况，人们想知道一个值是否已分配给一个值类型的实例。第一种是当实例表示数据库中的值时。在这种情况下，人们希望能够检查实例以确定数据库中是否确实存在值。与本书的主题更相关的另一种情况是，实例表示从某个远程源接收的数据项。同样，人们想从实例中确定是否收到了该数据项的值。

.NET Framework 2.0 合并了一个泛型类型定义，该定义提供了类似这样的情况：人们希望将 null 分配给值类型的实例，并测试该实例的值是否为 null。该泛型类型定义是`System.Nullable<T>`，它将可以替代 T 的泛型类型参数限制为值类型。构造自的类型的实例`System.Nullable<T>`可以赋值为 null；实际上，它们的值默认为空。因此，构造自的类型 `System.Nullable<T>`可以称为可空值类型。 `System.Nullable<T>`有一个属性 Value，如果该实例的值不为 null，则可以通过该属性获得分配给从它构造的类型的实例的值。因此，可以写：

```
System.Nullable<int> myNullableInteger = null;
myNullableInteger = 1;
if (myNullableInteger != null)
{
Console.WriteLine(myNullableInteger.Value);
} 
```

C# 编程语言为声明从`System.Nullable<T>`. 该语法允许缩写：

```
System.Nullable<int> myNullableInteger; 
```

到

```
int? myNullableInteger; 
```

编译器将阻止人们尝试以这种方式将可空值类型的值分配给普通值类型：

```
int? myNullableInteger = null;
int myInteger = myNullableInteger; 
```

它阻止了人们这样做，因为可空值类型可能具有 null 值，在这种情况下它实际上会具有该值，并且该值不能分配给普通值类型。虽然编译器会允许这段代码，

```
int? myNullableInteger = null;
int myInteger = myNullableInteger.Value; 
```

第二条语句将导致抛出异常，因为`System.Nullable<T>`如果构造自的类型没有被分配有效的 T 值，则任何访问 .Value 属性的尝试都是无效操作`System.Nullable<T>`，在这种情况下没有发生这种情况。

# *结论：*

将可空值类型的值分配给普通值类型的一种正确方法是使用`System.Nullable<T>`.HasValue 属性来确定 T 的有效值是否已分配给可空值类型：

```
int? myNullableInteger = null;
if (myNullableInteger.HasValue)
{
int myInteger = myNullableInteger.Value;
} 
```

另一种选择是使用以下语法：

```
int? myNullableInteger = null;
int myInteger = myNullableInteger ?? -1; 
```

通过它为普通整数 myInteger 分配可空整数“myNullableInteger”的值，如果后者已被分配一个有效的整数值；否则，myInteger 被赋值为 -1。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2014-05-12T02:44:24.770

此处使用合并获取值的一些示例效率低下。

你真正想要的是：

```
return _formsAuthWrapper = _formsAuthWrapper ?? new FormsAuthenticationWrapper(); 
```

或者

```
return _formsAuthWrapper ?? (_formsAuthWrapper = new FormsAuthenticationWrapper()); 
```

这可以防止每次都重新创建对象。与私有变量保持为空并在每个请求上创建一个新对象不同，这确保了在创建新对象时分配私有变量。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2020-03-10T15:37:38.463

其他人已经描述`Null Coalescing Operator`得很好。在需要对 null 进行单个测试的情况下，缩短的语法`??=`可以增加可读性。

旧版空测试：

```
if (myvariable == null)
{
    myvariable = new MyConstructor();
} 
```

使用空合并运算符可以写成：

```
myvariable = myvariable ?? new MyConstructor(); 
```

也可以用缩短的语法编写：

```
myvariable ??= new MyConstructor(); 
```

有些人觉得它更易读、更简洁。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-02-06T11:17:02.613

该`??`运算符称为空合并运算符。如果操作数不为空，则返回左侧操作数；否则返回右手操作数。

```
int? variable1 = null;
int variable2  = variable1 ?? 100; 
```

如果不为空，则设置`variable2`为 的值；否则，如果，则设置为 100。`variable1``variable1``variable1 == null``variable2`

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-12-08T14:37:59.077

它是一个空值合并运算符，其工作方式类似于三元运算符。

```
 a ?? b  => a !=null ? a : b 
```

另一个有趣的点是， *“一个可为空的类型可以包含一个值，或者它可以是未定义的”*。因此，如果您尝试将可空值类型分配给不可空值类型，则会出现编译时错误。

```
int? x = null; // x is nullable value type
int z = 0; // z is non-nullable value type
z = x; // compile error will be there. 
```

所以要使用 ?? 操作员：

```
z = x ?? 1; // with ?? operator there are no issues 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-03-31T21:22:46.037

```
FormsAuth = formsAuth ?? new FormsAuthenticationWrapper(); 
```

相当于

```
FormsAuth = formsAuth != null ? formsAuth : new FormsAuthenticationWrapper(); 
```

但它很酷的一点是你可以像其他人所说的那样把它们锁起来。没有提到的一点是您实际上可以使用它来引发异常。

```
A = A ?? B ?? throw new Exception("A and B are both NULL"); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-04-03T17:34:59.070

以最简单的方式，两个问号称为“合并运算符”，它从链中返回第一个非空值。

例如，如果您从一个可以为空的对象中获取一个不可为空的变量中的值，那么您可以使用此运算符。IE

整数a = 1；
诠释？b = 空；
a = b??0;

上述等式的结果将为零，因为 b 为空并且我们使用了 ?? 运算符与零一起，这意味着当且仅当 b 为空时它将返回 0。

整数a = 1；
诠释？b = 15;
a = b??0;

在上面的等式中，a 将得到值“15”，因为 b 具有有效值并且不为空。还有，你不能用？？非可空对象上的运算符。

在上面的例子中，我使用了 ?? 0，但是在 ?? 之后也可以使用一个完整的新方程。操作员。

比如
a = b ?? ( x==1 ? 10 : 15)
我希望它能解决你的问题。

# c# - C# 将组合框的内容写入注册表的最佳方法是什么？

> ID：446847
> 
> 赞同：1
> 
> 时间：2009-01-15T14:07:06.020
> 
> 标签：c#, registry

我有一个组合框，在单击按钮时在运行时填充（从数据库中读取大约 6 个项目），我想将这些组合框项目写入注册表，以便在程序加载时将它们读回，因此组合框是已经填充而无需从数据库中重新读取它们。

我的问题是将这些写入注册表的最佳方法是什么，以及如何将 selectedItem 写入注册表，以便在程序加载时它是 selectedItem？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-15T14:10:16.797

您没有说为什么要避免使用数据库，但我猜这是延迟，也许是 UI 检索数据时的暂停？

在这种情况下，也许您应该考虑在 Application Data 文件夹中缓存本地数据，而不是写入注册表？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-15T14:13:04.590

在我看来，最好的方法是不污染注册表并将这些信息保存到纯文本文件中。此外，当您的程序被加载时，数据库中的数据可以更改，因此您应该检查这种优化是否值得。无论如何，如果您仍想将此数据写入注册表，您可以使用[Registry](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.aspx)类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:23:03.617

一种方法是[序列化](http://msdn.microsoft.com/en-us/library/7ay27kt9(VS.71).aspx)ComboBox 的 Items 属性——在这种情况下，XML 序列化可能是最简单的。[然后，您可以使用RegistryKey](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx)类将生成的文本保存到文件、[独立存储](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.aspx)或注册表中- 只要序列化数据不太大，对于 6 个项目就可以了。然后只需在应用启动时将数据反序列化回组合框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T17:02:16.183

保存到配置文件，并在表单关闭时使用字典，然后在加载时将它们读出并返回到组合框中。[http://msdn.microsoft.com/en-us/library/cc221360(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc221360(VS.95).aspx)

# schema - T4 和架构信息帮助

> ID：446849
> 
> 赞同：0
> 
> 时间：2009-01-15T14:07:36.287
> 
> 标签：schema, t4

我正在尝试使用 t4 和 C# 创建数据访问层。我希望能够提供一个可以访问任何数据库的 DAL。我遇到的问题是一些架构信息。我能够检索一些信息，如列名和表名，但我还想要其他信息，如主键字段的名称、主键值。这样做最有效的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T14:35:59.083

如果您的目标是 Microsoft SQL Server，则服务器管理对象 ( [SMO](http://msdn.microsoft.com/en-us/library/ms162169.aspx) ) 是最佳选择。这是一个[例子](http://www.olegsych.com/2008/01/how-to-use-t4-to-generate-crud-stored-procedures/)。

# asp.net-ajax - CollapsiblePanelExtender 设置已折叠

> ID：446856
> 
> 赞同：6
> 
> 时间：2009-01-15T14:08:37.237
> 
> 标签：asp.net-ajax, ajaxcontroltoolkit

我在 AjaxToolkit 3.5 中使用 CollapsiblePanelExtender 来显示/隐藏搜索过滤器选项。

我希望在页面首次加载时展开 CollapsiblePanelExtender，!Page.IsPostBack。

之后，我希望折叠 CollapsiblePanelExtender，因为这意味着他们要么提交了一些过滤器选项，要么将转到搜索结果中的另一个页面。无论哪种情况，我都希望 CollapsiblePanelExtender 被折叠。

有没有办法我可以做到这一点？

在按钮提交处理程序的代码隐藏中，我尝试添加：

CollapsiblePanelExtenderID.CollapsedSize = 0 CollapsiblePanelExtenderID.Collapsed = true

但这似乎不起作用。我还将它添加到处理分页的 lv​​Products_PagePropertiesChanging 处理程序中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T03:53:32.517

我又想通了。

我需要添加这个：

```
 if (!Page.IsPostBack)
    {
        // do something
    }
    else
    {
        cpFilter.Collapsed = true;
        cpFilter.ClientState = "true";
    } 
```

感谢这个链接：[http ://www.dotnetcurry.com/ShowArticle.aspx?ID=230&AspxAutoDetectCookieSupport=1](http://www.dotnetcurry.com/ShowArticle.aspx?ID=230&AspxAutoDetectCookieSupport=1)

# c++ - Boost::multi_array 性能问题

> ID：446866
> 
> 赞同：27
> 
> 时间：2009-01-15T14:12:05.560
> 
> 标签：c++, performance, boost, boost-multi-array

我正在尝试使用以下测试程序将 boost::multi_array 的性能与本机动态分配的数组进行比较：

```
#include <windows.h>
#define _SCL_SECURE_NO_WARNINGS
#define BOOST_DISABLE_ASSERTS 
#include <boost/multi_array.hpp>

int main(int argc, char* argv[])
{
    const int X_SIZE = 200;
    const int Y_SIZE = 200;
    const int ITERATIONS = 500;
    unsigned int startTime = 0;
    unsigned int endTime = 0;

    // Create the boost array
    typedef boost::multi_array<double, 2> ImageArrayType;
    ImageArrayType boostMatrix(boost::extents[X_SIZE][Y_SIZE]);

    // Create the native array
    double *nativeMatrix = new double [X_SIZE * Y_SIZE];

    //------------------Measure boost----------------------------------------------
    startTime = ::GetTickCount();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                boostMatrix[x][y] = 2.345;
            }
        }
    }
    endTime = ::GetTickCount();
    printf("[Boost] Elapsed time: %6.3f seconds\n", (endTime - startTime) / 1000.0);

    //------------------Measure native-----------------------------------------------
    startTime = ::GetTickCount();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                nativeMatrix[x + (y * X_SIZE)] = 2.345;
            }
        }
    }
    endTime = ::GetTickCount();
    printf("[Native]Elapsed time: %6.3f seconds\n", (endTime - startTime) / 1000.0);

    return 0;
} 
```

我得到以下结果：

```
[Boost] Elapsed time: 12.500 seconds
[Native]Elapsed time:  0.062 seconds 
```

我不敢相信 multi_arrays 慢得多。谁能发现我做错了什么？

我认为缓存不是问题，因为我正在写入内存。

编辑：这是一个调试版本。根据 Laserallan 的建议，我做了一个发布版本：

```
[Boost] Elapsed time:  0.266 seconds
[Native]Elapsed time:  0.016 seconds 
```

更近了。但是 16 比 1 对我来说似乎仍然很高。

好吧，没有明确的答案，但我将继续前进，暂时将我的真实代码保留为本机数组。

接受 Laserallan 的回答，因为这是我测试中最大的缺陷。

谢谢大家。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-11-19T00:07:42.590

在我的机器上使用

```
g++ -O3 -march=native -mtune=native --fast-math -DNDEBUG test.cpp -o test && ./test 
```

我明白了

```
[Boost] Elapsed time:  0.020 seconds
[Native]Elapsed time:  0.020 seconds 
```

但是改变`const int ITERATIONS`为`5000`我得到

```
[Boost] Elapsed time:  0.240 seconds
[Native]Elapsed time:  0.180 seconds 
```

然后`ITERATIONS`回到`500`but`X_SIZE`和`Y_SIZE`set to`400`我得到一个更显着的差异

```
[Boost] Elapsed time:  0.460 seconds
[Native]Elapsed time:  0.070 seconds 
```

最后为案例反转内部循环，`[Boost]`所以它看起来像

```
 for (int x = 0; x < X_SIZE; ++x)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        { 
```

和保持`ITERATIONS`,`X_SIZE`和`Y_SIZE`,我得到`500``400``400`

```
[Boost] Elapsed time:  0.060 seconds
[Native]Elapsed time:  0.080 seconds 
```

`[Native]`如果我也为这种情况反转内部循环（所以这种情况的顺序错误），不出所料，我得到，

```
[Boost] Elapsed time:  0.070 seconds
[Native]Elapsed time:  0.450 seconds 
```

我`gcc (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5`在 Ubuntu 10.10 上使用

所以总而言之：

*   通过*适当的优化*boost::multi_array 可以按预期完成工作
*   您访问数据的顺序很*重要*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-15T15:50:38.123

**你的测试有缺陷。**

*   在 DEBUG 构建中，boost::MultiArray 缺少它急需的优化通道。（比原生数组要多得多）
*   在 RELEASE 构建中，您的编译器将查找可以直接删除的代码，并且**您的大部分代码都属于该类别**。

您可能会看到优化编译器的结果，即可以删除大部分或全部“本机数组”循环。你的 boost::MultiArray 循环在理论上也是如此，但 MultiArray 可能足够复杂，足以打败你的优化器。

**对你的测试平台做这个小改动，**你会看到更真实的结果：`= 2.345`用“ `*= 2.345`”改变“”的出现，然后用优化再次编译。这将防止您的编译器发现每个测试的外循环是多余的。

我做到了，速度比较接近 2:1。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-15T14:17:18.543

您是在构建发布版还是调试版？

如果在调试模式下运行，boost 数组可能会非常慢，因为它们的模板魔法没有正确内联，从而在函数调用中产生大量开销。我不确定多数组是如何实现的，所以这可能完全关闭:)

也许存储顺序也存在一些差异，因此您可能将图像逐列存储并逐行写入。这会导致缓存行为不佳，并可能减慢速度。

尝试切换 X 和 Y 循环的顺序，看看是否有任何收获。这里有一些关于存储排序的信息：http: [//www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html)

编辑：由于您似乎正在使用二维数组进行图像处理，因此您可能有兴趣查看 boosts 图像处理库[gil](http://www.boost.org/doc/libs/1_37_0/libs/gil/doc/index.html)。

它可能具有开销较小的数组，非常适合您的情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T21:54:03.180

考虑改用 Blitz++。我试用了 Blitz，它的性能与 C 风格的数组相当！

使用下面添加的 Blitz 查看您的代码：

* * *

```
#include <windows.h>
#define _SCL_SECURE_NO_WARNINGS
#define BOOST_DISABLE_ASSERTS 
#include <boost/multi_array.hpp>
#include <blitz/array.h>

int main(int argc, char* argv[])
{
    const int X_SIZE = 200;
    const int Y_SIZE = 200;
    const int ITERATIONS = 500;
    unsigned int startTime = 0;
    unsigned int endTime = 0;

    // Create the boost array
    typedef boost::multi_array<double, 2> ImageArrayType;
    ImageArrayType boostMatrix(boost::extents[X_SIZE][Y_SIZE]);

    //------------------Measure boost----------------------------------------------
    startTime = ::GetTickCount();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                boostMatrix[x][y] = 2.345;
            }
        }
    }
    endTime = ::GetTickCount();
    printf("[Boost] Elapsed time: %6.3f seconds\n", (endTime - startTime) / 1000.0);

    //------------------Measure blitz-----------------------------------------------
    blitz::Array<double, 2> blitzArray( X_SIZE, Y_SIZE );
    startTime = ::GetTickCount();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                blitzArray(x,y) = 2.345;
            }
        }
    }
    endTime = ::GetTickCount();
    printf("[Blitz] Elapsed time: %6.3f seconds\n", (endTime - startTime) / 1000.0);

    //------------------Measure native-----------------------------------------------
    // Create the native array
    double *nativeMatrix = new double [X_SIZE * Y_SIZE];

    startTime = ::GetTickCount();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                nativeMatrix[x + (y * X_SIZE)] = 2.345;
            }
        }
    }
    endTime = ::GetTickCount();
    printf("[Native]Elapsed time: %6.3f seconds\n", (endTime - startTime) / 1000.0);

    return 0;
} 
```

* * *

这是调试和发布的结果。

调试：

```
Boost  2.093 secs 
Blitz  0.375 secs 
Native 0.078 secs 
```

释放：

```
Boost  0.266 secs
Blitz  0.016 secs
Native 0.015 secs 
```

为此，我使用了 MSVC 2008 SP1 编译器。

我们现在可以和 C-stlye 数组说再见了吗？=p

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-19T22:30:18.290

我想知道两件事：

1) 边界检查：在应用程序中包含 multi_array.hpp 之前定义 BOOST_DISABLE_ASSERTS 预处理器宏。这将关闭边界检查。不确定这是否在 NDEBUG 被禁用时被禁用。

2）基数索引：MultiArray可以从不为0的基数索引数组。这意味着multi_array存储一个基数（在每个维度中）并使用更复杂的公式来获取内存中的确切位置，我想知道这是否是关于那。

否则我不明白为什么多数组应该比 C 数组慢。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-09T06:31:38.600

我在看这个问题，因为我有同样的问题。我有一些想法要进行更严格的测试。

1.  正如[rodrigob](https://stackoverflow.com/a/4220976/1695375)指出的那样，循环顺序存在缺陷，因此您最初附加的代码中的任何结果都会产生误导性数据
2.  此外，还有一些相当小的数组正在使用常量进行设置。编译器可能会优化循环，而实际上编译器不会知道数组的大小。数组的大小和迭代次数应该是运行时输入以防万一。

在 Mac 上，以下代码被配置为给出更有意义的答案。这里有4个测试。

```
#define BOOST_DISABLE_ASSERTS
#include "boost/multi_array.hpp"
#include <sys/time.h>
#include <stdint.h>
#include<string>

uint64_t GetTimeMs64()
{
  struct timeval tv;

  gettimeofday( &tv, NULL );

  uint64_t ret = tv.tv_usec;
  /* Convert from micro seconds (10^-6) to milliseconds (10^-3) */
  ret /= 1000;

  /* Adds the seconds (10^0) after converting them to milliseconds (10^-3) */
  ret += ( tv.tv_sec * 1000 );

  return ret;

}

void function1( const int X_SIZE, const int Y_SIZE, const int ITERATIONS )
{

  double nativeMatrix1add[X_SIZE*Y_SIZE];

  for( int x = 0 ; x < X_SIZE ; ++x )
  {
    for( int y = 0 ; y < Y_SIZE ; ++y )
    {
      nativeMatrix1add[y + ( x * Y_SIZE )] = rand();
    }
  }

  // Create the native array
  double* __restrict const nativeMatrix1p = new double[X_SIZE * Y_SIZE];
  uint64_t startTime = GetTimeMs64();
  for( int i = 0 ; i < ITERATIONS ; ++i )
  {
    for( int xy = 0 ; xy < X_SIZE*Y_SIZE ; ++xy )
    {
      nativeMatrix1p[xy] += nativeMatrix1add[xy];
    }
  }
  uint64_t endTime = GetTimeMs64();
  printf( "[Native Pointer]    Elapsed time: %6.3f seconds\n", ( endTime - startTime ) / 1000.0 );

}

void function2( const int X_SIZE, const int Y_SIZE, const int ITERATIONS )
{

  double nativeMatrix1add[X_SIZE*Y_SIZE];

  for( int x = 0 ; x < X_SIZE ; ++x )
  {
    for( int y = 0 ; y < Y_SIZE ; ++y )
    {
      nativeMatrix1add[y + ( x * Y_SIZE )] = rand();
    }
  }

  // Create the native array
  double* __restrict const nativeMatrix1 = new double[X_SIZE * Y_SIZE];
  uint64_t startTime = GetTimeMs64();
  for( int i = 0 ; i < ITERATIONS ; ++i )
  {
    for( int x = 0 ; x < X_SIZE ; ++x )
    {
      for( int y = 0 ; y < Y_SIZE ; ++y )
      {
        nativeMatrix1[y + ( x * Y_SIZE )] += nativeMatrix1add[y + ( x * Y_SIZE )];
      }
    }
  }
  uint64_t endTime = GetTimeMs64();
  printf( "[Native 1D Array]   Elapsed time: %6.3f seconds\n", ( endTime - startTime ) / 1000.0 );

}

void function3( const int X_SIZE, const int Y_SIZE, const int ITERATIONS )
{

  double nativeMatrix2add[X_SIZE][Y_SIZE];

  for( int x = 0 ; x < X_SIZE ; ++x )
  {
    for( int y = 0 ; y < Y_SIZE ; ++y )
    {
      nativeMatrix2add[x][y] = rand();
    }
  }

  // Create the native array
  double nativeMatrix2[X_SIZE][Y_SIZE];
  uint64_t startTime = GetTimeMs64();
  for( int i = 0 ; i < ITERATIONS ; ++i )
  {
    for( int x = 0 ; x < X_SIZE ; ++x )
    {
      for( int y = 0 ; y < Y_SIZE ; ++y )
      {
        nativeMatrix2[x][y] += nativeMatrix2add[x][y];
      }
    }
  }
  uint64_t endTime = GetTimeMs64();
  printf( "[Native 2D Array]   Elapsed time: %6.3f seconds\n", ( endTime - startTime ) / 1000.0 );

}

void function4( const int X_SIZE, const int Y_SIZE, const int ITERATIONS )
{

  boost::multi_array<double, 2> boostMatrix2add( boost::extents[X_SIZE][Y_SIZE] );

  for( int x = 0 ; x < X_SIZE ; ++x )
  {
    for( int y = 0 ; y < Y_SIZE ; ++y )
    {
      boostMatrix2add[x][y] = rand();
    }
  }

  // Create the native array
  boost::multi_array<double, 2> boostMatrix( boost::extents[X_SIZE][Y_SIZE] );
  uint64_t startTime = GetTimeMs64();
  for( int i = 0 ; i < ITERATIONS ; ++i )
  {
    for( int x = 0 ; x < X_SIZE ; ++x )
    {
      for( int y = 0 ; y < Y_SIZE ; ++y )
      {
        boostMatrix[x][y] += boostMatrix2add[x][y];
      }
    }
  }
  uint64_t endTime = GetTimeMs64();
  printf( "[Boost Array]       Elapsed time: %6.3f seconds\n", ( endTime - startTime ) / 1000.0 );

}

int main( int argc, char* argv[] )
{

  srand( time( NULL ) );

  const int X_SIZE = std::stoi( argv[1] );
  const int Y_SIZE = std::stoi( argv[2] );
  const int ITERATIONS = std::stoi( argv[3] );

  function1( X_SIZE, Y_SIZE, ITERATIONS );
  function2( X_SIZE, Y_SIZE, ITERATIONS );
  function3( X_SIZE, Y_SIZE, ITERATIONS );
  function4( X_SIZE, Y_SIZE, ITERATIONS );

  return 0;
} 
```

1.  一个只有一维数组，使用带有整数数学和双循环的 []

2.  一个使用指针递增的具有相同一维数组的

3.  多维 C 数组

4.  提升多数组

所以从命令行运行，运行

```
./test_array xsize ysize iterations" 
```

并且您可以很好地了解这些方法将如何执行。这是我使用以下编译器标志得到的结果：

```
g++4.9.2 -O3 -march=native -funroll-loops -mno-avx --fast-math -DNDEBUG  -c -std=c++11

./test_array 51200 1 20000
[Native 1-Loop ]    Elapsed time:  0.537 seconds
[Native 1D Array]   Elapsed time:  2.045 seconds
[Native 2D Array]   Elapsed time:  2.749 seconds
[Boost Array]       Elapsed time:  1.167 seconds

./test_array 25600 2 20000
[Native 1-Loop ]    Elapsed time:  0.531 seconds
[Native 1D Array]   Elapsed time:  1.241 seconds
[Native 2D Array]   Elapsed time:  1.631 seconds
[Boost Array]       Elapsed time:  0.954 seconds

./test_array 12800 4 20000
[Native 1-Loop ]    Elapsed time:  0.536 seconds
[Native 1D Array]   Elapsed time:  1.214 seconds
[Native 2D Array]   Elapsed time:  1.223 seconds
[Boost Array]       Elapsed time:  0.798 seconds

./test_array 6400 8 20000
[Native 1-Loop ]    Elapsed time:  0.540 seconds
[Native 1D Array]   Elapsed time:  0.845 seconds
[Native 2D Array]   Elapsed time:  0.878 seconds
[Boost Array]       Elapsed time:  0.803 seconds

./test_array 3200 16 20000
[Native 1-Loop ]    Elapsed time:  0.537 seconds
[Native 1D Array]   Elapsed time:  0.661 seconds
[Native 2D Array]   Elapsed time:  0.673 seconds
[Boost Array]       Elapsed time:  0.708 seconds

./test_array 1600 32 20000
[Native 1-Loop ]    Elapsed time:  0.532 seconds
[Native 1D Array]   Elapsed time:  0.592 seconds
[Native 2D Array]   Elapsed time:  0.596 seconds
[Boost Array]       Elapsed time:  0.764 seconds

./test_array 800 64 20000
[Native 1-Loop ]    Elapsed time:  0.546 seconds
[Native 1D Array]   Elapsed time:  0.594 seconds
[Native 2D Array]   Elapsed time:  0.606 seconds
[Boost Array]       Elapsed time:  0.764 seconds

./test_array 400 128 20000
[Native 1-Loop ]    Elapsed time:  0.536 seconds
[Native 1D Array]   Elapsed time:  0.560 seconds
[Native 2D Array]   Elapsed time:  0.564 seconds
[Boost Array]       Elapsed time:  0.746 seconds 
```

所以，我认为可以肯定地说 boost multi_array 的表现相当不错。没有什么比单循环评估更好的了，但是根据数组的维度，boost::multi_array 可能会击败具有双循环的标准 c 数组。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T14:24:49.277

要尝试的另一件事是使用迭代器而不是 boost 数组的直接索引。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-15T15:29:42.953

我本来希望多阵列同样有效。但是我在使用 gcc 的 PPC Mac 上得到了类似的结果。我还尝试了 multiarrayref，这样两个版本都使用相同的存储，没有区别。很高兴知道这一点，因为我在一些代码中使用了多数组，并且只是假设它类似于手动编码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-15T15:37:14.047

我想我知道问题是什么……也许吧。

为了使 boost 实现具有如下语法：matrix[x][y]。这意味着 matrix[x] 必须返回对对象的引用，该对象的作用类似于一维数组*column*，此时 reference[y] 为您提供元素。

这里的问题是您以**行主要**顺序进行迭代（这在 c/c++ 中很典型，因为本机数组是行主要 IIRC。在这种情况下，编译器必须为每个 y 重新执行 matrix[x]。如果您在使用 boost 矩阵时的列主顺序，您可能会看到更好的性能。

只是一个理论。

编辑：在我的 linux 系统上（有一些小的改动）我测试了我的理论，并且通过切换 x 和 y 确实显示*了一些*性能改进，但它仍然比本机数组慢。这可能是编译器无法优化临时引用类型的简单问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-15T19:17:22.463

在发布模式下构建，使用 objdump，然后查看程序集。他们可能正在做完全不同的事情，您将能够看到编译器正在使用哪些优化。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-01T15:13:27.963

在这里提出并回答了类似的问题：

[http://www.codeguru.com/forum/archive/index.php/t-300014.html](http://www.codeguru.com/forum/archive/index.php/t-300014.html)

简短的回答是编译器最容易优化简单数组，而不是优化 Boost 版本那么容易。因此，特定的编译器可能不会为 Boost 版本提供所有相同的优化优势。

编译器的优化程度和保守程度也会有所不同（例如，使用模板代码或其他复杂情况）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-01T09:13:10.133

我在 Snow Leopard Mac OS 上使用`gcc 4.2.1`

```
Debug:
[Boost] Elapsed time:  2.268 seconds
[Native]Elapsed time:  0.076 seconds

Release:
[Boost] Elapsed time:  0.065 seconds
[Native]Elapsed time:  0.020 seconds 
```

这是代码（修改后可以在 Unix 上编译）：

```
#define BOOST_DISABLE_ASSERTS
#include <boost/multi_array.hpp>
#include <ctime>

int main(int argc, char* argv[])
{
    const int X_SIZE = 200;
    const int Y_SIZE = 200;
    const int ITERATIONS = 500;
    unsigned int startTime = 0;
    unsigned int endTime = 0;

    // Create the boost array
    typedef boost::multi_array<double, 2> ImageArrayType;
    ImageArrayType boostMatrix(boost::extents[X_SIZE][Y_SIZE]);

    // Create the native array
    double *nativeMatrix = new double [X_SIZE * Y_SIZE];

    //------------------Measure boost----------------------------------------------
    startTime = clock();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                boostMatrix[x][y] = 2.345;
            }
        }
    }
    endTime = clock();
    printf("[Boost] Elapsed time: %6.3f seconds\n", (endTime - startTime) / (double)CLOCKS_PER_SEC);

    //------------------Measure native-----------------------------------------------
    startTime = clock();
    for (int i = 0; i < ITERATIONS; ++i)
    {
        for (int y = 0; y < Y_SIZE; ++y)
        {
            for (int x = 0; x < X_SIZE; ++x)
            {
                nativeMatrix[x + (y * X_SIZE)] = 2.345;
            }
        }
    }
    endTime = clock();
    printf("[Native]Elapsed time: %6.3f seconds\n", (endTime - startTime) / (double)CLOCKS_PER_SEC);

    return 0;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-06-03T17:01:20.903

查看 g++ 4.8.2 生成的程序集，`-O3 -DBOOST_DISABLE_ASSERTS`使用并使用`operator()`和`[][]`访问元素的方式，很明显，与原生数组和手动索引计算相比，唯一的额外操作是添加基数。不过我没有衡量这个成本。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-01-04T13:28:58.517

我在 Visual Studio 2008 v9.0.21022 中修改了上述代码，并应用了 C 和 C++ 的数值配方例程中的容器例程

[http://www.nrbook.com/nr3/](http://www.nrbook.com/nr3/)分别使用他们的许可例程 dmatrix 和 MatDoub

dmatrix 使用过时的语法 malloc 运算符，不推荐使用... MatDoub 使用 New 命令

以秒为单位的速度在发布版本中：

提升：0.437

原生：0.032

数字配方 C：0.031

数值配方 C++：0.031

所以从上面的闪电战看来是最好的免费替代品。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-13T13:04:11.630

我已经在 VC++ 2010 下编译了代码（稍作修改），并启用了优化（“最大化速度”以及内联“任何合适的”函数和“偏爱快速代码”），得到的时间为 0.015/0.391。我已经生成了装配清单，虽然我是一个糟糕的装配菜鸟，但在 boost-measuring 循环中有一行对我来说看起来不太好：

```
call    ??A?$multi_array_ref@N$01@boost@@QAE?AV?$sub_array@N$00@multi_array@detail@1@H@Z ; boost::multi_array_ref<double,2>::operator[] 
```

[] 运算符之一没有内联！被调用的过程再次调用，这次是`multi_array::value_accessor_n<...>::access<...>()`：

```
call    ??$access@V?$sub_array@N$00@multi_array@detail@boost@@PAN@?$value_accessor_n@N$01@multi_array@detail@boost@@IBE?AV?$sub_array@N$00@123@U?$type@V?$sub_array@N$00@multi_array@detail@boost@@@3@HPANPBIPBH3@Z ; boost::detail::multi_array::value_accessor_n<double,2>::access<boost::detail::multi_array::sub_array<double,1>,double *> 
```

总之，这两个过程是相当多的代码，用于简单地访问数组中的单个元素。我的总体印象是该库是如此复杂和高级，以至于 Visual Studio 无法按照我们的意愿对其进行优化（使用 gcc 的海报显然得到了更好的结果）。

恕我直言，一个好的编译器真的应该对这两个过程进行内联和优化——两者都非常简短和直接，不包含任何循环等。很多时间可能只是浪费在传递它们的参数和结果上。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-19T15:04:28.193

正如 rodrigob 所回答的，激活适当的优化（GCC 的默认值为 -O0）是获得良好性能的关键。此外，我还使用[Blaze DynamicMatrix](https://bitbucket.org/account/user/blaze-lib/projects/BLAZE)进行了测试，它使用完全相同的优化标志产生了额外的 2 倍性能提升。[https://bitbucket.org/account/user/blaze-lib/projects/BLAZE](https://bitbucket.org/account/user/blaze-lib/projects/BLAZE)

# python - 在python中为** https **连接指定具有用户名和密码的代理的最佳方法是什么？

> ID：446869
> 
> 赞同：3
> 
> 时间：2009-01-15T14:12:21.113
> 
> 标签：python, authentication, proxy, https

我在某处读到当前 urllib2 不支持经过身份验证的 https 连接。我的代理仅使用基本身份验证，但如何通过它打开基于 https 的网页。请帮我。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:13:27.103

“urllib2 不支持经过身份验证的 https 连接”错误。

```
 # Build Handler to support HTTP Basic Authentication...
    basic_handler = urllib2.HTTPBasicAuthHandler()
    basic_handler.add_password(realm, self.urlBase, username, password)
    # Get cookies, also, to handle login
    self.cookies= cookielib.CookieJar()
    cookie_handler= urllib2.HTTPCookieProcessor( self.cookies )
    # Assemble the final opener
    opener = urllib2.build_opener(basic_handler,cookie_handler) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T15:12:19.150

您可以使用[httplib2](http://code.google.com/p/httplib2/)，它解决了 urllib2 的一些限制，包括这个限制。[这里](http://code.google.com/p/httplib2/wiki/Examples)有一个如何在 https 连接上进行基本身份验证的示例。

# html - VB.NET 替换 HTML 标记之间的空格

> ID：446874
> 
> 赞同：0
> 
> 时间：2009-01-15T14:15:33.167
> 
> 标签：html, vb.net, string, replace, whitespace

VB.NET 中是否有任何方法可以删除 HTML 中标签之间的所有空格？

说，我有这个：

```
<tr>
    <td> 
```

我构建的字符串是一个完整的 HTML 文档，它会将这些标记之前的所有内容都视为合法空间，因此我需要将其修剪掉。那里有我可以用来执行此操作的 reg ex 或函数吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T14:19:29.647

根据文档的复杂性，您可能只需要在文档中使用替换正则表达式...例如：

RegexObj.Replace(">[\s\n]*<","><")

[您可以在此处](http://www.regular-expressions.info/dotnet.html)阅读有关 .NET 和正则表达式的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:44:24.073

上面的解决方案是一个好的开始，但是代码稍有错误，正则表达式超出了它的需要。在这种情况下，您需要做的最低限度是：

```
Dim RegexObj As New Regex(">[\s]*<")

NewText = RegexObj.Replace(OldText, "><") 
```

这`\n`是不必要的，因为 .Net 在空白字符集中包含回车符和换行符`(\s)`。不确定其他语言。如果没有，您还需要包含该`\r`字符，因为 Windows 换行符`\r\n`位于正则表达式中，而不仅仅是`\n`.

# compiler-construction - 最佳编译器目的地

> ID：446883
> 
> 赞同：11
> 
> 时间：2009-01-15T14:17:32.803
> 
> 标签：compiler-construction, llvm

作为口译员，我一直在构建几种语言。当我准备好采取“下一步”时，哪些选项最适合非本机编译格式......每个选项的优缺点是什么？

我一直在考虑编译到 CLR 或 LLVM，并考虑过 C-midcompile 几次，但我并不完全确定。

我希望能够移植的一些功能如下：

1.  REPL - 我正在构建的一种语言在运行时支持块级评估。
2.  健壮的宏 - 我正在构建的语言之一需要能够在标记化之前单独过滤代码，以及在标记化和解析之间的中间步骤。

好吧，不是真的“几个”，只有两个。我喜欢认为我可以将我的语言支持的任何其他功能移植到“任何东西”。

我最好的选择是什么，它们的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-17T02:28:51.340

代码生成是我的事:-)

对几个选项的评论：

*   CLR：

    *   优点：工业支持
    *   缺点：你必须完全接受他们的类型系统；取决于你想对类型做什么，这可能无关紧要
    *   缺点：只有 Windows 平台才是真正的黄金时间质量
*   LLVM：

    *   优点：热情的用户社区和有魅力的领导者
    *   优点：Apple 的大力支持
    *   优点：许多有趣的性能改进
    *   缺点：有点复杂的界面
    *   缺点：工程漏洞的历史；随着 LLVM 的成熟，期望通过增加接口的复杂性来填补工程中的漏洞
*   [C -](http://www.cminusminus.org/)

    *   优点：目标是一种实际的书面语言，而不是 API；您可以轻松地检查、调试和编辑您的 C 代码
    *   优点：设计相当成熟且相当干净
    *   Pro：支持准确的垃圾回收
    *   优点：大多数用户报告它非常易于使用
    *   缺点：非常小的开发团队
    *   缺点：截至 2009 年初，仅支持三个硬件平台（x86、PPC、ARM）
    *   缺点：不附带垃圾收集器
    *   缺点：项目没有未来
*   C 作为目标语言

    *   优点：看起来很简单
    *   缺点：几乎不可能获得体面的表现
    *   缺点：从长远来看会让你发疯；询问那些尝试使用这种技术编译 Haskell、ML、Modula-3、Scheme 等的人。在某些时候，这些人中的每一个人都放弃了并构建了自己的本机代码生成器。

总结：**除了 C 以外**的任何东西都是合理的选择。对于灵活性、质量和预期寿命的最佳组合，我可能会推荐 LLVM。

全面披露：我隶属于 C-- 项目。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-15T14:48:45.767

优点/缺点：

*   CLR：

    *   pro：CLR环境一应俱全；很多东西要绑定
    *   con: 绑定到 CLR (;-); 针对某些系统将很难或不可能（嵌入式、大型机等。CLR impl。在非 MS 系统上可能不太成熟）
*   LLVM：

    *   pro：独立于MS。
    *   缺点：针对某些系统可能涉及移植 LLVM（？）；与 DOT-net、Java 等接口可能很麻烦（可能需要 FFI）
*   C 作为目标语言：

    *   pro：几乎所有可能的目标；简单的代码生成
    *   缺点：您将不得不将一些 VM 东西实现为运行时库（GC、dynload、dyn 编译等）；有些事情在 C 中很难做到（延续、回溯、堆栈跟踪、异常）；在 C 语言中，有些事情很难高效且可移植（GC、动态类型、堆栈布局依赖）。
*   Java ByteCode 作为目标：

    *   pro：可能是最大的一组可能的目标平台（甚至是手机和嵌入式产品）；周围有很多现有的工具；与现有库的轻松接口
    *   缺点：有些事情很难实现或很难有效地实现（动态类型、延续、回溯）

综上所述，我认为以 Java ByteCode 为目标可能最适合您。

编辑：实际上是对评论的回答，但 300chars 是不够的。

JByteCode 不确定 - 我同意（作为 Smalltalker，JBytecode 对我来说太有限了）。

在 VM 方面，我认为作为 JVM 可以获得相对广泛的性能，从纯慢字节码解释器到高端复杂的 JITting VM (IBM)。我想，CLR VM 会迎头赶上，因为 MS 迟早会窃取和整合所有创新，并且发布了加速动态翻译的技术（例如，阅读 Self 论文）。LLVM 的进展可能会慢一些，但谁知道呢。使用 C，您将免费受益于更好的编译器，但是动态重新翻译等内容很难以 C 作为目标来实现。我自己的系统混合使用了预编译代码和动态编译代码（在一个内存空间中包含所有：慢速字节码解释器、JITter 和预编译静态 C 代码）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T14:32:33.770

LLVM 似乎很有希望。该团队声称在 gcc 上的运行时性能比原生的更好。从 AST 编译的能力真的很有趣（看一下教程）。它可以在运行时编译和优化，这是动态的必须的。它也可以作为纯解释器运行。

我考虑在一个涉及创建类似 Tcl 的语言的项目中使用 LLVM。Tcl 是高度动态的，所以在这个阶段我不知道这意味着什么，但我相信我会获得比当前基于字节码的内核更好的性能。

# sharepoint - 打开 Office CMS？

> ID：446891
> 
> 赞同：3
> 
> 时间：2009-01-15T14:19:42.627
> 
> 标签：sharepoint, content-management-system, openoffice.org

是否有类似于 Share point/MS Office 的 CMS 集成到 Open Office 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T14:33:35.953

[Alfresco](http://www.alfresco.com/)有一个Open Office[插件](http://forge.alfresco.com/frs/?group_id=157&release_id=295)。任何一个团队都不支持它，但它具有您在 SharePoint 中看到的应用程序内集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T02:39:19.050

我听说还有来自 Sun 的更正式的 Alfresco 集成——不知道那是什么状态。Alfresco 最近还实现了 SharePoint 协议，允许使用带有 Alfresco 作为后端的 MS Office，而无需安装任何插件（即 MS Word 认为它正在与 SharePoint 对话）

# javascript - 如何在 JavaScript 或调试中找到 DOM 节点上的事件侦听器？

> ID：446892
> 
> 赞同：976
> 
> 时间：2009-01-15T14:19:44.420
> 
> 标签：javascript, events, dom

我有一个页面，其中一些事件侦听器附加到输入框和选择框。有没有办法找出哪些事件侦听器正在观察特定的 DOM 节点以及什么事件？

使用以下方法附加事件：

1.  [原型](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework) `Event.observe`;
2.  DOM `addEventListener`;
3.  作为元素属性`element.onclick`。

* * *

## 回答 #1

> 赞同：532
> 
> 时间：2010-08-06T17:48:47.433

如果您只需要检查页面上发生的事情，您可以尝试使用[Visual Event](http://www.sprymedia.co.uk/article/Visual+Event)小书签。

**更新**：[Visual Event 2](http://www.sprymedia.co.uk/article/Visual+Event+2)可用。

* * *

## 回答 #2

> 赞同：526
> 
> 时间：2013-05-14T13:40:20.527

Chrome、Firefox、Vivaldi 和 Safari`getEventListeners(domElement)`在他们的开发者工具控制台中支持。

对于大多数调试目的，可以使用它。

下面是使用它的一个很好的参考： [https ://developers.google.com/web/tools/chrome-devtools/console/utilities#geteventlisteners](https://developers.google.com/web/tools/chrome-devtools/console/utilities#geteventlisteners)

* * *

## 回答 #3

> 赞同：386
> 
> 时间：2009-01-15T15:13:51.503

这取决于事件的附加方式。为了说明，假设我们有以下点击处理程序：

```
var handler = function() { alert('clicked!') }; 
```

我们将使用不同的方法将它附加到我们的元素上，有些方法允许检查，有些则不允许。

方法 A) 单事件处理程序

```
element.onclick = handler;
// inspect
console.log(element.onclick); // "function() { alert('clicked!') }" 
```

方法 B) 多个事件处理程序

```
if(element.addEventListener) { // DOM standard
    element.addEventListener('click', handler, false)
} else if(element.attachEvent) { // IE
    element.attachEvent('onclick', handler)
}
// cannot inspect element to find handlers 
```

方法 C): jQuery

```
$(element).click(handler); 
```

*   1.3.x

    ```
     // inspect
     var clickEvents = $(element).data("events").click;
     jQuery.each(clickEvents, function(key, value) {
         console.log(value) // "function() { alert('clicked!') }"
     }) 
    ```

*   1.4.x（将处理程序存储在对象内）

    ```
     // inspect
     var clickEvents = $(element).data("events").click;
     jQuery.each(clickEvents, function(key, handlerObj) {
         console.log(handlerObj.handler) // "function() { alert('clicked!') }"
         // also available: handlerObj.type, handlerObj.namespace
     }) 
    ```

*   1.7+（非常好）

    使用[此评论](https://stackoverflow.com/questions/446892/how-to-find-event-listeners-on-a-dom-node-when-debugging-or-from-the-javascript#comment32914567_447106)中的知识制作。

    ```
     events = $._data(this, 'events');
     for (type in events) {
       events[type].forEach(function (event) {
         console.log(event['handler']);
       });
     } 
    ```

^(（见[`jQuery.fn.data`](https://api.jquery.com/data/)和[`jQuery.data`](https://api.jquery.com/jQuery.data/)）)

方法D）：原型（凌乱）

```
$(element).observe('click', handler); 
```

*   1.5.x

    ```
     // inspect
     Event.observers.each(function(item) {
         if(item[0] == element) {
             console.log(item[2]) // "function() { alert('clicked!') }"
         }
     }) 
    ```

*   1.6 到 1.6.0.3，包括在内（这里非常困难）

    ```
     // inspect. "_eventId" is for < 1.6.0.3 while 
     // "_prototypeEventID" was introduced in 1.6.0.3
     var clickEvents = Event.cache[element._eventId || (element._prototypeEventID || [])[0]].click;
     clickEvents.each(function(wrapper){
         console.log(wrapper.handler) // "function() { alert('clicked!') }"
     }) 
    ```

*   1.6.1（稍微好一点）

    ```
     // inspect
     var clickEvents = element.getStorage().get('prototype_event_registry').get('click');
     clickEvents.each(function(wrapper){
         console.log(wrapper.handler) // "function() { alert('clicked!') }"
     }) 
    ```

单击控制台中的结果输出（显示函数的文本）时，控制台将直接导航到相关 JS 文件中函数声明的行。

* * *

## 回答 #4

> 赞同：96
> 
> 时间：2011-01-17T07:39:55.283

Chrome 或 Safari 浏览器中的 WebKit Inspector 现在可以执行此操作。当您在“元素”窗格中选择它时，它将显示 DOM 元素的事件侦听器。

* * *

## 回答 #5

> 赞同：81
> 
> 时间：2011-06-22T04:32:42.230

**可以在 JavaScript 中列出所有事件侦听器**：这并不难；您只需要破解`prototype`HTML 元素的 ' 方法（*在*添加侦听器之前）。

```
function reportIn(e){
    var a = this.lastListenerInfo[this.lastListenerInfo.length-1];
    console.log(a)
}

HTMLAnchorElement.prototype.realAddEventListener = HTMLAnchorElement.prototype.addEventListener;

HTMLAnchorElement.prototype.addEventListener = function(a,b,c){
    this.realAddEventListener(a,reportIn,c); 
    this.realAddEventListener(a,b,c); 
    if(!this.lastListenerInfo){  this.lastListenerInfo = new Array()};
    this.lastListenerInfo.push({a : a, b : b , c : c});
}; 
```

现在每个锚元素 ( `a`) 都将有一个`lastListenerInfo`包含其所有侦听器的属性。它甚至可以用于移除带有匿名函数的监听器。

* * *

## 回答 #6

> 赞同：60
> 
> 时间：2014-03-19T09:30:04.310

**在Google Chrome**中使用 getEventListeners ：

```
getEventListeners(document.getElementByID('btnlogin'));
getEventListeners($('#btnlogin')); 
```

* * *

## 回答 #7

> 赞同：44
> 
> 时间：2012-10-22T19:04:27.930

（重写[这个问题](https://stackoverflow.com/questions/2382994/how-to-check-if-any-javascript-event-listeners-handlers-attached-to-an-element-d/13017468#13017468)的答案，因为它在这里是相关的。）

调试时，如果您只想查看事件，我建议...

1.  [视觉事件](http://www.sprymedia.co.uk/article/Visual+Event+2)
2.  Chrome 开发者工具的*Elements*部分：选择一个元素并在右下角查找“Event Listeners”（在 Firefox 中类似）

如果您想在代码中使用事件，并且您使用的是 jQuery *1.8 之前的版本*，您可以使用：

```
$(selector).data("events") 
```

获取事件。**从 1.8 版开始，不再使用 .data("events")**（请参阅[此 bug 票证](http://bugs.jquery.com/ticket/10589)）。您可以使用：

```
$._data(element, "events") 
```

另一个例子：将某个链接上的所有点击事件写入控制台：

```
var $myLink = $('a.myClass');
console.log($._data($myLink[0], "events").click); 
```

（有关工作示例，请参见[http://jsfiddle.net/HmsQC/ ）](http://jsfiddle.net/HmsQC/)

不幸的是，**不推荐使用 $._data** ，除了调试之外，因为它是一个内部 jQuery 结构，并且在未来的版本中可能会发生变化。不幸的是，我知道没有其他简单的方法可以访问这些事件。

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2014-04-03T15:08:07.893

1：`Prototype.observe`使用Element.addEventListener（见[源码](https://github.com/sstephenson/prototype/blob/ecacc02/src/prototype/dom/event.js#L759)）

2：您可以覆盖`Element.addEventListener`以记住添加的侦听器（方便的属性`EventListenerList`已从 DOM3 规范提案中删除）。在附加任何事件之前运行此代码：

```
(function() {
  Element.prototype._addEventListener = Element.prototype.addEventListener;
  Element.prototype.addEventListener = function(a,b,c) {
    this._addEventListener(a,b,c);
    if(!this.eventListenerList) this.eventListenerList = {};
    if(!this.eventListenerList[a]) this.eventListenerList[a] = [];
    this.eventListenerList[a].push(b);
  };
})(); 
```

通过以下方式阅读所有事件：

```
var clicks = someElement.eventListenerList.click;
if(clicks) clicks.forEach(function(f) {
  alert("I listen to this function: "+f.toString());
}); 
```

并且不要忘记覆盖`Element.removeEventListener`以从自定义中删除事件`Element.eventListenerList`。

3：`Element.onclick`这里的属性需要特别注意：

```
if(someElement.onclick)
  alert("I also listen tho this: "+someElement.onclick.toString()); 
```

4：不要忘记`Element.onclick`内容属性：这是两个不同的东西：

```
someElement.onclick = someHandler; // IDL attribute
someElement.setAttribute("onclick","otherHandler(event)"); // content attribute 
```

所以你也需要处理它：

```
var click = someElement.getAttribute("onclick");
if(click) alert("I even listen to this: "+click); 
```

Visual Event 小书签（在最流行的答案中提到）仅窃取自定义库处理程序缓存：

> 事实证明，W3C 推荐的 DOM 接口没有提供标准方法来找出哪些事件侦听器附加到特定元素。虽然这似乎是一个疏忽，但有人提议在 3 级 DOM 规范中包含一个名为 eventListenerList 的属性，但不幸的是在后来的草案中被删除了。因此，我们不得不查看单独的 Javascript 库，它们通常维护附加事件的缓存（以便以后可以删除它们并执行其他有用的抽象）。
> 
> 因此，为了让 Visual Event 显示事件，它必须能够从 Javascript 库中解析事件信息。

元素覆盖可能是有问题的（即，因为有一些特定于 DOM 的功能，例如实时集合，无法在 JS 中编码），但它提供了对 eventListenerList 的原生支持，并且它适用于 Chrome、Firefox 和 Opera（不适用于 IE7 ）。

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2015-11-06T17:49:11.477

您可以通过将其放在您的顶部来包装用于管理事件侦听器的本机 DOM 方法`<head>`：

```
<script>
    (function(w){
        var originalAdd = w.addEventListener;
        w.addEventListener = function(){
            // add your own stuff here to debug
            return originalAdd.apply(this, arguments);
        };

        var originalRemove = w.removeEventListener;
        w.removeEventListener = function(){
            // add your own stuff here to debug
            return originalRemove.apply(this, arguments);
        };
    })(window);
</script> 
```

H/T @les2

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2020-07-22T14:22:29.777

将页面上的所有 eventListener 与元素一起打印

```
Array.from(document.querySelectorAll("*")).forEach(e => {
    const ev = getEventListeners(e)
    if (Object.keys(ev).length !== 0) console.log(e, ev)
}) 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2015-01-14T15:33:29.240

Firefox 开发人员工具现在可以做到这一点。通过单击每个元素显示右侧的“ev”按钮来显示事件，包括[jQuery](http://en.wikipedia.org/wiki/JQuery)和[DOM](http://en.wikipedia.org/wiki/Document_Object_Model)事件。

![检查器选项卡中 Firefox 开发人员工具的事件侦听器按钮的屏幕截图](https://i.stack.imgur.com/E1AXv.png)

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2010-01-07T22:52:00.507

如果您有[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)，您可以使用`console.dir(object or array)`在任何 JavaScript 标量、数组或对象的控制台日志中打印一棵漂亮的树。

尝试：

```
console.dir(clickEvents); 
```

或者

```
console.dir(window); 
```

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2015-06-27T10:47:52.027

基于[Jan Turon 回答的](https://stackoverflow.com/a/22841712/78054)完全有效的解决方案- 行为类似于`getEventListeners()`控制台：

（有一个重复的小错误。无论如何它不会破坏太多。）

```
(function() {
  Element.prototype._addEventListener = Element.prototype.addEventListener;
  Element.prototype.addEventListener = function(a,b,c) {
    if(c==undefined)
      c=false;
    this._addEventListener(a,b,c);
    if(!this.eventListenerList)
      this.eventListenerList = {};
    if(!this.eventListenerList[a])
      this.eventListenerList[a] = [];
    //this.removeEventListener(a,b,c); // TODO - handle duplicates..
    this.eventListenerList[a].push({listener:b,useCapture:c});
  };

  Element.prototype.getEventListeners = function(a){
    if(!this.eventListenerList)
      this.eventListenerList = {};
    if(a==undefined)
      return this.eventListenerList;
    return this.eventListenerList[a];
  };
  Element.prototype.clearEventListeners = function(a){
    if(!this.eventListenerList)
      this.eventListenerList = {};
    if(a==undefined){
      for(var x in (this.getEventListeners())) this.clearEventListeners(x);
        return;
    }
    var el = this.getEventListeners(a);
    if(el==undefined)
      return;
    for(var i = el.length - 1; i >= 0; --i) {
      var ev = el[i];
      this.removeEventListener(a, ev.listener, ev.useCapture);
    }
  };

  Element.prototype._removeEventListener = Element.prototype.removeEventListener;
  Element.prototype.removeEventListener = function(a,b,c) {
    if(c==undefined)
      c=false;
    this._removeEventListener(a,b,c);
      if(!this.eventListenerList)
        this.eventListenerList = {};
      if(!this.eventListenerList[a])
        this.eventListenerList[a] = [];

      // Find the event in the list
      for(var i=0;i<this.eventListenerList[a].length;i++){
          if(this.eventListenerList[a][i].listener==b, this.eventListenerList[a][i].useCapture==c){ // Hmm..
              this.eventListenerList[a].splice(i, 1);
              break;
          }
      }
    if(this.eventListenerList[a].length==0)
      delete this.eventListenerList[a];
  };
})(); 
```

用法：

`someElement.getEventListeners([name])`- 返回事件侦听器列表，如果设置了名称，则返回该事件的侦听器数组

`someElement.clearEventListeners([name])`- 删除所有事件侦听器，如果设置了名称，则仅删除该事件的侦听器

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2013-11-28T16:30:26.807

Opera 12（不是基于最新的 Chrome Webkit 引擎）[Dragonfly](http://www.opera.com/dragonfly/)已经有一段时间了，并且显然显示在 DOM 结构中。在我看来，它是一个出色的调试器，也是我仍然使用基于 Opera 12 的版本的唯一原因（没有 v13、v14 版本并且基于 v15 Webkit 的版本仍然缺少 Dragonfly）

![在此处输入图像描述](https://i.stack.imgur.com/Lwfo6.png)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-01-17T17:28:55.190

原型1.7.1方式

```
function get_element_registry(element) {
    var cache = Event.cache;
    if(element === window) return 0;
    if(typeof element._prototypeUID === 'undefined') {
        element._prototypeUID = Element.Storage.UID++;
    }
    var uid =  element._prototypeUID;           
    if(!cache[uid]) cache[uid] = {element: element};
    return cache[uid];
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2018-06-28T09:21:07.613

我最近在处理事件，想查看/控制页面中的所有事件。在查看了可能的解决方案后，我决定走自己的路，创建一个自定义系统来监控事件。所以，我做了三件事。

首先，我需要一个用于页面中所有事件侦听器的容器：这就是`EventListeners`对象。它具有三个有用的方法：`add()`、`remove()`和`get()`。

接下来，我创建了一个`EventListener`对象来保存事件的必要信息，即：`target`、`type`、`callback`、`options`、`useCapture`、`wantsUntrusted`，并添加了一个`remove()`删除侦听器的方法。

最后，我扩展了 native`addEventListener()`和`removeEventListener()`方法以使它们与我创建的对象（`EventListener`和`EventListeners`）一起工作。

用法：

```
var bodyClickEvent = document.body.addEventListener("click", function () {
    console.log("body click");
});

// bodyClickEvent.remove(); 
```

`addEventListener()`创建一个`EventListener`对象，将其添加到`EventListeners`并返回该`EventListener`对象，以便以后可以将其删除。

`EventListeners.get()`可用于查看页面中的监听器。它接受一个`EventTarget`或一个字符串（事件类型）。

```
// EventListeners.get(document.body);
// EventListeners.get("click"); 
```

* * *

**演示**

假设我们想知道当前页面中的每个事件监听器。我们可以做到这一点（假设您使用的是脚本管理器扩展，在本例中为 Tampermonkey）。以下脚本执行此操作：

```
// ==UserScript==
// @name         New Userscript
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  try to take over the world!
// @author       You
// @include      https://stackoverflow.com/*
// @grant        none
// ==/UserScript==

(function() {
    fetch("https://raw.githubusercontent.com/akinuri/js-lib/master/EventListener.js")
        .then(function (response) {
            return response.text();
        })
        .then(function (text) {
            eval(text);
            window.EventListeners = EventListeners;
        });
})(window); 
```

当我们列出所有的监听器时，它会说有 299 个事件监听器。“似乎”有一些重复，但我不知道它们是否真的重复。并非每种事件类型都是重复的，因此所有这些“重复”可能是一个单独的侦听器。

[![列出此页面中所有事件侦听器的控制台屏幕截图](https://i.stack.imgur.com/KhLvq.png)](https://i.stack.imgur.com/KhLvq.png)

代码可以在我的[存储库中找到。](https://raw.githubusercontent.com/akinuri/js-lib/master/EventListener.js)我不想在这里发布它，因为它很长。

* * *

**更新：**这似乎不适用于 jQuery。当我检查 EventListener 时，我看到回调是

```
function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0} 
```

我相信这属于 jQuery，而不是实际的回调。jQuery 将实际回调存储在 EventTarget 的属性中：

```
$(document.body).click(function () {
    console.log("jquery click");
}); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/gpidb.jpg)](https://i.stack.imgur.com/gpidb.jpg)

要删除事件侦听器，需要将实际回调传递给该`removeEventListener()`方法。因此，为了使这与 jQuery 一起工作，它需要进一步修改。我将来可能会解决这个问题。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-05-19T08:33:11.133

我试图在 jQuery 2.1 中做到这一点，并且使用 " `$().click() -> $(element).data("events").click;`" 方法它不起作用。

我意识到只有 $._data() 函数适用于我的情况：

```
 $(document).ready(function(){

		var node = $('body');

        // Bind 3 events to body click
		node.click(function(e) { alert('hello');  })
			.click(function(e) { alert('bye');  })
			.click(fun_1);

        // Inspect the events of body
		var events = $._data(node[0], "events").click;
		var ev1 = events[0].handler // -> function(e) { alert('hello')
		var ev2 = events[1].handler // -> function(e) { alert('bye')
		var ev3 = events[2].handler // -> function fun_1()

		$('body')
			.append('<p> Event1 = ' + eval(ev1).toString() + '</p>')
			.append('<p> Event2 = ' + eval(ev2).toString() + '</p>')
			.append('<p> Event3 = ' + eval(ev3).toString() + '</p>');        

	});

	function fun_1() {
		var txt = 'text del missatge';	 
		alert(txt);
	}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<body>
</body>
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-02-28T15:13:15.370

存在不错的**[jQuery 事件扩展](https://chrome.google.com/webstore/detail/jquery-debugger/dbhhnnnpaeobfddmlalhnehgclcmjimi)** ：

[![在此处输入图像描述](https://i.stack.imgur.com/HITS4.png)](https://i.stack.imgur.com/HITS4.png) （话题[来源](https://stackoverflow.com/questions/11065358/find-attached-bound-events-of-an-element-using-chrome-development-tools-fire)）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-04-18T14:57:18.800

更改这些函数将允许您记录添加的侦听器：

```
EventTarget.prototype.addEventListener
EventTarget.prototype.attachEvent
EventTarget.prototype.removeEventListener
EventTarget.prototype.detachEvent 
```

阅读其余的听众

```
console.log(someElement.onclick);
console.log(someElement.getAttribute("onclick")); 
```

# performance - 有没有办法确定 iSeries 上的单个作业内存消耗？

> ID：446893
> 
> 赞同：1
> 
> 时间：2009-01-15T14:19:45.763
> 
> 标签：performance, memory, ibm-midrange

我们混合了 .Net 应用程序，它们通过 ODBC 和 DB2 Connect 连接到 V5R4 的 iSeries LPAR。我们还有一些在机器上本地运行的批处理作业（主要是 COBOL、RPG 和直接 CL）。在一天中的某些时段，我们会遇到严重的页面错误，并试图确定哪些应用程序可能会导致问题。

无需购买市场上数十种昂贵工具（即 iDoctor）中的任何一种，有没有办法查看每个作业消耗的内存量。我们的大多数作业都用完了池 2，当我们向该池添加内存时，我们确实看到性能有所提高，而仅仅查看 wrksyssts 并没有多大帮助。我们想隔离有问题的作业，看看是否可以进行一些修改以提高性能并减少不必要的内存使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:14:03.770

如果您不介意 Java 或其 jvm 或做一些编码......

获取以下内容（全部适用于 Windows、Linux、AIX、Solaris 等……Mac？）：

*   [Groovy](http://groovy.codehaus.org)因为我有点讨厌 Java 的冗长
*   [JTOpen ，它是 IBM 的](http://jt400.sourceforge.net/)[IBM Toolbox for Java](http://www.ibm.com/servers/eserver/iseries/toolbox)的开源版本，随[System i Access](http://www-03.ibm.com/systems/i/software/access/)一起提供，您应该随服务器一起收到

请记住，JTOpen 只是一个普通的旧 Java 库，因此您可以使用**任何可以访问普通 Java 库的 jvm 语言**。我正在使用 Groovy，因为我对此有兴趣。别担心，Groovy 很好。

开始。

```
 import com.ibm.as400.access.*

 // how many seconds to run  
 secs = 20 

 sys = new AS400("theserver", "paulg", "dotnet4evah")   
 job = new Job(sys, "jobname", "jobusername", "jobnumber")

 job.load()
 println "Stats for ${job.toString()}"  
 // this might look horrible
 println "total CPU time\tpage faults/sec\tdisk IO ops/sec"
 while (secs--) {
   job.loadStatistics()
   print "${job.getCPUUsed()/1000}\t\t" 
   print "${job.getValue(Job.ELAPSED_PAGE_FAULTS)}\t\t"
   println "${job.getValue(Job.ELAPSED_DISK_IO)}"
   job.resetStatistics()
   Thread.sleep(1000)
 }

 sys.disconnectAllServices() 
```

就是这样。还有许多其他工作价值可以[发挥](http://publib.boulder.ibm.com/infocenter/systems/scope/i5os/index.jsp?topic=/rzahh/javadoc/com/ibm/as400/access/Job.html)。我从来不用担心这些工作统计数据，所以我不知道重置统计数据是否正确。

为了创建 Job 对象，实际知道作业编号和有关作业的其他详细信息是一件痛苦的事情。这就是[JobList](http://publib.boulder.ibm.com/infocenter/systems/scope/i5os/topic/rzahh/javadoc/com/ibm/as400/access/JobList.html)如此出色的原因。如果有用，您还可以从脚本[运行 CL 命令。](http://publib.boulder.ibm.com/infocenter/systems/scope/i5os/topic/rzahh/javadoc/com/ibm/as400/access/CommandCall.html)

我认为 IBM 使用这个库来构建 Ops Navigator，所以也许您已经使用它一段时间了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:41:24.627

这似乎有点帮助：

-- 在 iSeries Navigator 中，展开我的连接 > 连接 > 工作管理 > 内存池 > 活动池或共享池。-- 右键单击​​要使用的内存池，然后单击作业。-- 自定义视图以包含 Page Faults 列

至少我可以看到哪些工作存在错误问题。下次出现问题时，我们会看看它是否有助于找到有问题的应用程序。

# asp.net - 为什么我应该在 ASP.NET 中使用 JSON？

> ID：446894
> 
> 赞同：7
> 
> 时间：2009-01-15T14:20:36.790
> 
> 标签：asp.net, json

为什么我应该在 ASP.NET 中使用 JSON？你能举一个实际的例子吗？我读过文章，但不是很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T14:25:07.640

**从 Web 服务返回数据**时怎么样？以下是适用于 .Net 2.0 的两种方法，它们采用 DataTable 或 DataRow 参数，并返回要从 Web 服务发送到客户端的 JSON 格式字符串：

```
public string GetJson(DataRow r)
    {
        int index = 0;
        StringBuilder json = new StringBuilder();
        foreach (DataColumn item in r.Table.Columns)
        {
            json.Append(String.Format("\"{0}\" : \"{1}\"", item.ColumnName, r[item.ColumnName].ToString().Replace("\"","\\\"")));
            if (index < r.Table.Columns.Count - 1)
            {
                json.Append(", ");
            }
            index++;
        }
        return "{" + json.ToString() + "}";
    }

public string GetJson(DataTable t)
{
    int index = 0;
    StringBuilder json = new StringBuilder();
    foreach (DataRow currRow in t.Rows)
    {
        json.Append(GetJson(currRow));
        if (index < t.Rows.Count - 1)
        {
            json.Append(", ");
        }
    }
    return "[" + json.ToString() + "]";
} 
```

然后可以在客户端上发送和评估结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T14:26:05.983

JSON 非常适合添加[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)功能。例如，您可以使用返回 JSON 对象的 Ajax 请求返回的一些值填充 ComboBox 的内容。

ASP.NET Ajax 在内部使用 JSON。如果您正在使用另一个框架，例如 jQuery，您可以自己完成客户端和服务器端。

JSON 易于人类和计算机阅读，并且引入的开销很小。JavaScript 客户端代码可以原生解析 JSON。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T14:29:34.167

使用 JSON 是因为它在浏览器中很容易解析 - 只需调用即可`eval()`完成。

只要我们将 DataTable 共享到 JSON 实现：

```
 public static string DataTableToJSON(DataTable dt)
    {
        string rowDelimiter = "";

        StringBuilder result = new StringBuilder("[");
        foreach (DataRow row in dt.Rows)
        {
            result.Append(rowDelimiter);
            result.Append(DataRowToJSON(row));
            rowDelimiter = ",";
        }
        result.Append("]");

        return result.ToString();
    }

    public static string DataRowToJSON(DataRow row)
    {
        DataColumnCollection cols = row.Table.Columns;
        string colDelimiter = "";

        StringBuilder result = new StringBuilder("{");       
        for (int i = 0; i < cols.Count; i++)
        { // use index rather than foreach, so we can use the index for both the row and cols collection
            result.AppendFormat("{0}\"{1}\":{2}",
                    colDelimiter, cols[i].ColumnName,
                    PrepJSONValue(row[i], cols[i].DataType));

            colDelimiter = ",";
        }
        result.Append("}");
        return result.ToString();
    }

    // possible types:
    // http://msdn.microsoft.com/en-us/library/system.data.datacolumn.datatype(VS.80).aspx
    private static Type[] numeric = new Type[] {typeof(byte), typeof(decimal), typeof(double), 
                                     typeof(Int16), typeof(Int32), typeof(SByte), typeof(Single),
                                     typeof(UInt16), typeof(UInt32), typeof(UInt64)};

    private static long EpochTicks = new DateTime(1970, 1, 1).Ticks;

    private static string PrepJSONValue(object value, Type DataType)
    {
        // null
        if (value == DBNull.Value) return "null";

        // numeric
        if (Array.IndexOf(numeric, DataType) > -1)
            return value.ToString(); // TODO: eventually want to use a stricter format

        // boolean
        if (DataType == typeof(bool))
            return ((bool)value) ? "true" : "false";

        // date -- see http://weblogs.asp.net/bleroy/archive/2008/01/18/dates-and-json.aspx
        if (DataType == typeof(DateTime))       
            return "\"\\/Date(" + new TimeSpan(((DateTime)value).ToUniversalTime().Ticks - EpochTicks).TotalMilliseconds.ToString() + ")\\/\"";

        // TODO: add Timespan support
        // TODO: add Byte[] support

        // string/char
        return "\"" + value.ToString().Replace(@"\", @"\\").Replace(Environment.NewLine, @"\n").Replace("\"", @"\""") + "\"";
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T14:44:58.410

有很多用途、API、Web 服务，而且它的开销比 XML 少得多。作为实际示例，您可以通过几行代码使用 JSON 数据填充[ExtJs树或网格。](http://www.extjs.net/products/extjs/)

如果您使用的是 ASP.NET MVC，那么从控制器返回 JSON 非常容易，如下所示：

```
// this method return JSON directly
public JsonResult GetData() {

    data = LoadData(); // load the data from a database or a service
    return Json(data); // will serialize your data object as JSON

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T15:24:32.823

返回 JSON 对象的 Ajax 调用可以很简单地转换为 JavaScript 对象，例如

```
var jsObject = eval( "(" + ajaxCallReturningJson(whatever) + ")" ); 
```

这使得将复杂数据传递给客户端变得非常方便，而无需进行自定义表示或使用 XML/XSLT 胡闹。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-15T14:24:55.220

JSON 比 XML 更容易解析，并且有很多选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T14:27:05.810

这是一种将 javascript 对象直接注入到您的网页中的方法，该对象可以在您的所有其他客户端脚本中使用 OOP 表示法访问，而无需在客户端进行解析或处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-15T14:30:11.310

你有什么选择？XML 比 JSON 更重，因此它使用更多带宽（但对于验证和转换数据非常强大），YAML 需要缩进和换行，使其成为通过 Http 发送的次优格式（但适合存储日志、数据和配置）。JSON 是原生 javascript，而且很轻，所以它在客户端和通过 Http 传输非常棒

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-24T08:10:51.813

这是一篇非常好的文章，介绍了为什么 JSON 是发送和接收数据的首选方法。

[http://robtiffany.com/windows-phone-7/windows-phone-7-line-of-business-app-dev-building-a-wcf-rest-json-service](http://robtiffany.com/windows-phone-7/windows-phone-7-line-of-business-app-dev-building-a-wcf-rest-json-service)

# c# - 使用 C# 安装时如何从注册表获取应用程序版本

> ID：446896
> 
> 赞同：1
> 
> 时间：2009-01-15T14:21:29.673
> 
> 标签：c#

我想在安装应用程序时检查 PC 套件版本（在用户机器中）。

我想要的是：

1）当用户按下 setup.exe 时，我想检查 pc 套件版本，如果它比特定版本旧，我想通知他应用程序将下载新版本，然后继续安装（继续安装我的应用程序）。

2）我也不想检查用户是否有.net framework 2，它不像以前那样我想从网站下载它。

我做了什么 ：

1）我将安装项目添加到我的 sulition 中，当我构建它时，我有 2 个文件 setup.exe 和 myApplication.msi。现在 setup.exe 会检查我想要的先决条件，但它会像用户安装它一样正常安装，我可以在不让用户完成默认安装过程的情况下使这一步工作（不要让他选择接受，. 。 ETC）

2）我可以在安装后添加选项“你想启动myApplication”吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T21:02:49.267

如果您使用的是 Visual Studio 安装项目，则可以检查用户是否使用[.NET Framework Launch Condition](http://msdn.microsoft.com/en-us/library/xxyh2e6a.aspx)安装了特定版本的 .NET Framework 。如果未安装该版本，则会提示用户下载它并停止安装。

根据您在系统中检查软件早期版本的方式，您可能可以使用不同[启动条件](http://msdn.microsoft.com/en-us/library/ay12wede(VS.71).aspx)的组合来停止安装。但是，如果您希望您的安装程序可执行文件向用户显示自定义提示，然后自动下载新版本，您可以创建一个标准的 Windows 窗体应用程序，该应用程序：

*   检查当前安装的软件版本
*   如果需要，下载更新的安装程序
*   执行 MSI 安装程序

可以使用标准 Visual Studio 安装项目创建 Windows 窗体应用运行的 MSI 安装程序。

# linux - 从小任务中唤醒_up_interruptible() 是否安全？

> ID：446902
> 
> 赞同：1
> 
> 时间：2009-01-15T14:22:49.500
> 
> 标签：linux, kernel

我有一个内核模块，它通过 read() 向用户态进程提供数据。在数据可用之前，该进程会阻塞读取。我通过 read 方法中的 wait_event_interruptible() 实现了这一点。

数据来自一个中断处理程序，它把它吸入内存，然后安排一个小任务来处理它。原始代码调度 tasklet，然后调用 wake_up_interruptible() 重新激活被阻塞的读取。但是，这会导致竞争条件，因为在读取尝试将数据提供给用户进程之前，tasklet 可能尚未完成处理数据。

所以问题是，将我对 wake_up_interruptible() 的调用移到 tasklet 的末尾是否安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:01:26.880

是的，tasklet 完成后调用它是安全`wake_up_interruptible()`的。有关示例，请参见[http://www.xml.com/ldd/chapter/book/ch09.html 。](http://www.xml.com/ldd/chapter/book/ch09.html)

# web-services - Reporting Services 不断擦除我的数据集参数

> ID：446906
> 
> 赞同：0
> 
> 时间：2009-01-15T14:23:12.730
> 
> 标签：web-services, reporting-services, parameters

我正在使用网络服务，每次我更改数据集上的某些内容时，它都会删除我的所有参数。

奇怪的是，我可以从数据选项卡执行 Web 服务调用，它会提示输入我的所有参数，但是如果我单击编辑数据，则列表为空，或者如果我尝试预览报告，它会爆炸，因为参数是失踪。

只是想知道是否有其他人经历过这种情况，以及是否有办法防止这种行为。

这是数据集的副本，我认为这并不重要。这必须是有史以来最烦人的错误（如果它是错误的话）。如果不删除我的参数列表，我什至无法从设计器执行数据集。当您有大约 10 个参数并且您正在对新报告进行各种更改时，不断地一遍又一遍地重新输入相同的列表变得非常乏味。

如果有的话，工作室至少应该能够预先填充服务要求的参数。*叹息*我的压力球在哪里...

```
<Query>
   <Method Namespace="http://www.example.com/" Name="TWRPerformanceSummary"/>
   <SoapAction>http://www.example.com/TWRPerformanceSummary</SoapAction>   
       <ElementPath IgnoreNamespaces="true">
            TWRPerformanceSummaryResponse/TWRPerformanceSummaryResult/diffgram/NewDataSet/table{StockPerc,RiskBudget,Custodian,ProductName,StartValue(decimal),EndValue(decimal),CostBasis(decimal)}
       </ElementPath>
</Query> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T16:12:16.757

问题来自网络服务内部。我将 sessionID（它的 GUID）作为字符串传递给报告，然后从报告传递给 Web 服务。在 Web 服务中，我获取该字符串并将其转换回 Guid 并将其传递给我们的 SecurityTicket 对象。

这就是问题发生的地方。显然这个电话：

```
Guid passedGuid = new Guid(sessionID); 
```

报告服务数据集不喜欢。Microsoft 支持升级工程师正在与我一起验证到底发生了什么，如果有修复，将是修复等...我将为我的代码解决一个问题，这不需要要传递给 SecurityTicket 的 GUID。

**编辑 - 解决方案**
本质上，每次您在数据选项卡上进行更改时，都会触发对发送空参数的 Web 服务数据集的调用。如果您的 Web 服务无法处理空参数，则删除所有参数时会出错。

为了轻松克服这个问题，我们 Web 服务的第一行检查空参数并设置一些默认值。然后如果返回的数据集是空的，我们添加一个虚拟行：

```
private static void addDummyRow(DataTable dt) {
        var row = dt.NewRow();

        for (int i = 0; i < dt.Columns.Count; i++) {
            if (dt.Columns[i].DataType == typeof(string)) {
                row[i] = dt.Columns[i].ColumnName;
            }
            else if (dt.Columns[i].DataType == typeof(DateTime)) {
                row[i] = new DateTime(1900, 1, 1);
            }
            else {
                row[i] = 0;
            }
        }

        dt.Rows.Add(row);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T19:20:30.513

我明白了，这很烦人。如果您是从 VS 开发的，只需单击 Refresh fields 按钮，通常就可以解决问题。如果查询仍然抛出错误，则您的 SQL 很可能有错误（至少根据我的经验，如果“刷新字段”不起作用，我犯了一些愚蠢的语法错误，例如“SELECT Field1 Field2 ...”或其他东西像那样）。您也可以单击“运行查询”按钮。

# python - python web-services：使用 ZSI 从服务器返回故障

> ID：446912
> 
> 赞同：2
> 
> 时间：2009-01-15T14:24:18.547
> 
> 标签：python, web-services, fault, zsi

我有兴趣为 web 服务编写一个 python 客户端，并且为了测试目的，拥有一个简单的存根服务器也会非常有趣。我正在使用 python 2.3 和 ZSI 2.0。

我的问题是我无法从服务器返回异常。

如果我在 wsdl 中引发用于肥皂故障的类型的异常，我会得到 TypeError '异常必须是类、实例或字符串（已弃用），而不是 EmptyStringException_Def'。我认为这意味着错误对象不是 Exception 的子类，但是以这种方式修改生成的代码并没有帮助——当然，不必修改生成的代码会好得多:)

如果我将故障对象作为响应的一部分返回，它就会被忽略。

我在 ZSI 中找不到任何有关故障处理的文档。有什么提示吗？

下面是一个非常简单的服务服务器的示例代码，它只有一个方法，spellBackwards，如果输入字符串为空，它应该返回一个肥皂错误：

```
#!/usr/bin/env python
from ZSI.ServiceContainer import AsServer
from SpellBackwardsService_services_server import *
from SpellBackwardsService_services_types import *
class SpellBackwardsServiceImpl(SpellBackwardsService):
    def soap_spellBackwards(self, ps):
        response = SpellBackwardsService.soap_spellBackwards(self, ps)
        input = self.request._in
        if len(input) != 0:
            response._out = input[::-1]
        else:
            e = ns0.EmptyStringException_Def("fault")
            e._reason = "Empty input string"

            # The following just produces an empty return message:
            # response._fault = e

            # The following causes TypeError
            # raise e

        return response

AsServer(port=8666, services=[SpellBackwardsServiceImpl(),]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T09:22:07.783

我在这本[ZSI Cookbook](http://pywebsvcs.sourceforge.net/cookbook.pdf)中找到了答案，作者 Chris Hoobs，链接在[ZSI 主页](http://pywebsvcs.sourceforge.net/)的底部：

> 5.4 异常
> 一个棘手的问题是如何在服务器上产生故障。使用提供的 ZSI v2.0 代码，这是不可能的。

我认为这是正确的，因为该论文是从项目主页链接的。
本文还提出了一种解决方法，其中包括修补 ZSI 发行版中的 Fault.py 文件。
我测试了解决方法，它按承诺工作；修补库对我来说是可接受的解决方案，因为我需要生成一个服务器仅用于测试目的（即我不需要分发修补的库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:58:21.703

抱歉无法回答问题。

我和 ZSI 吵了一阵子。

我现在使用 SUDS：[https](https://fedorahosted.org/suds/wiki) ://fedorahosted.org/suds/wiki ，一切都变得简单多了。

# c# - 如何将填写的pdf保存回Web服务器

> ID：446926
> 
> 赞同：1
> 
> 时间：2009-01-15T14:26:59.617
> 
> 标签：c#, asp.net, pdf, webforms

我需要能够在 ASP.Net 表单中查看嵌入的 pdf，以及将文档打印并保存回 Web 服务器。pdf 文档允许填写各种字段，并且我还需要在表单上的打印和保存按钮，该按钮不在 pdf 默认查看器中。

所以场景是用户在 asp.net 网络表单中打开一个 pdf 文档，填写表单，然后单击打印按钮或保存按钮。打印按钮应该激活 pdf 查看器中的打印，但是保存按钮应该自动获取 pdf 文档中提交的更改并将它们保存到 Web 服务器。我不能让用户打开一个单独的“另存为”对话框并将其保存到他的计算机上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T17:30:09.357

如果您想使用“嵌入”或“对象”来内联您的 pdf ( [http://blog.flashcolony.com/?p=244](http://blog.flashcolony.com/?p=244) )，您可以在可填写的 pdf 上放置一个按钮并让该按钮使用“submitForm”将“cSubmitAs”设置为 PDF，将 cURL 设置为您要发布到的 http。

我发现您可以使用“cURL”的相对路径 - 可以使用 /someApp/someController/someAction 而不是[http://www.somecompany.com/someApp/someController/someAction](http://www.somecompany.com/someApp/someController/someAction)

（更多[http://www.adobeforums.com/webx/.59b7911e](http://www.adobeforums.com/webx/.59b7911e)）。

然后在您发布到的服务器端，使用任何语言从 http 请求中选择应用程序/pdf 并执行您需要的操作。

我不认为有办法重载阅读器功能（保存、打印）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T14:40:19.543

如果我理解正确，您想消除 pdf 查看器的“保存”功能并将其替换为您自己的功能，以便用户无法在本地保存但文件被发送回服务器....

如果是这样，那么您可能需要使用所需的选项构建自己的 PDF 查看器；删除“保存”按钮或使其将文档发布到服务器。而且我不确定这是多么可行，因为我还没有尝试过。

您应该创建一个 Web 表单，要求用户输入所需的数据并在服务器中构建 pdf。此时，您可以将其保存在服务器端，然后为用户提供打印功能；不使用表单查看器。有很多 PDF API 可以让您执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:01:12.753

您可以将 javascript 嵌入到将信息发布回服务器的表单中，您可以在其中创建所需的表单。

看看John Deubert的书*用 Javascript 扩展 Acrobat 表单。*它会告诉你你需要的一切。

# wpf - 你如何调试 wpf relativesource 在加载时抛出错误？

> ID：446931
> 
> 赞同：1
> 
> 时间：2009-01-15T14:28:51.733
> 
> 标签：wpf, exception, binding, listbox, relativesource

我正在使用一个包含`ListBox`. 列表框可以显示“图标”和“列表”视图。为了实现这一点，我们使用 `ListBoxItem`了动态应用于 的样式，`ListBox`以及一对对应`ItemsPanelTemplate`的 s。照原样，它显示得很漂亮。但是，在加载此对话框时，我们会遇到几十个绑定错误，例如：

System.Windows.Data 错误：4：找不到与引用'RelativeSource FindAncestor，AncestorType='System.Windows.Controls.ItemsControl'，AncestorLevel='1''的绑定源。绑定表达式：路径=垂直内容对齐；数据项=空；目标元素是'ListBoxItem'（名称=''）；目标属性是“VerticalContentAlignment”（类型“VerticalAlignment”）

我们的理论是样式和模板在 之前加载`ListBox`，并且无法使用以下代码找到它们绑定的属性：

```
<Setter Property="VerticalContentAlignment" Value="{Binding 
        Path=VerticalContentAlignment, RelativeSource={RelativeSource 
        AncestorType={x:Type ItemsControl}}}"/> 
```

`ListBox`这似乎在初始化和应用样式和模板之前发生了一次或多次。对话框完成初始化后，错误停止。

有没有人遇到过这个？任何人都可以提出我们可能忽略的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T14:54:10.670

看起来这里已经介绍过了：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/db050ce6-d084-41ad-9a31-c01831687683](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/db050ce6-d084-41ad-9a31-c01831687683)

应该是一个“已知”的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-01T21:01:20.423

我在这里找到了解决方法：

[http://blog.jtango.net/2009/05/08/using-a-grid-as-the-itemspanel-for-a-listbox-in-wpf-binding-errors/](http://blog.jtango.net/2009/05/08/using-a-grid-as-the-itemspanel-for-a-listbox-in-wpf-binding-errors/)

您`ItemContainerStyle`使用`ListBox`.

# full-text-search - 使用 DB4O 进行全文搜索

> ID：446933
> 
> 赞同：3
> 
> 时间：2009-01-15T14:29:22.747
> 
> 标签：full-text-search, db4o

在我的 DB4O 数据库中，我有大量 Book 对象

```
Book
  +string: Title
  ... 
```

在我的表单中输入标题（字符串）时，我想建议现有的标题。目前我使用一个简单的

```
book.Title.Contains(titlePart) 
```

但是，如果我可以推荐书名与输入标题匹配的书籍，即使它有多个非连续匹配的单词，并按相关顺序给出匹配，那将是一个很好的补充。简而言之：对它们进行全文搜索。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T20:34:20.993

您必须挂钩 Lucene 或 Lucene.NET 才能索引您的文本字段。使用 Lucene 进行全文搜索会非常快。

# gpgpu - ATI Stream 与 NVidia/CUDA 的比较

> ID：446962
> 
> 赞同：4
> 
> 时间：2009-01-15T14:35:36.137
> 
> 标签：gpgpu

为了使这个问题成为一个可以回答的问题，而不仅仅是一个民意调查，我会这样问：

是否有任何第三方报告将 ATI 的 Stream 框架与 NVidia 的 CUDA 框架进行比较（即，不是来自 ATI 或 NVidia 的自言自语）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T00:48:05.800

Tom's Hardware 有一篇文章，[ATI Stream: Final, CUDA Has Competition](http://www.tomshardware.com/reviews/amd-stream-gpgpu,2335.html) (2009-06-15)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T14:46:42.773

我不知道这样的比较，但我会添加一些个人经验。也许在这里的用户之间，我们可以进行体面的比较/优点/缺点/经验/教训。

英伟达：

1.  Linux 支持（只需使用二进制 blob 并处理它）
2.  编译器支持，GCC 4.1 和 4.2。4.3还有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-16T19:19:25.687

从软件的角度来看，这不是苹果与苹果的比较，因为两者的编程模型非常不同，

应用程序可以有效地映射到 Brook+ 而不是 CUDA，反之亦然。通过编写好的代码优化硬件的使用会产生很大的不同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-22T06:33:12.237

这种直接比较将需要有人构建一个独立于 API 并在 CUDA 和 ATi Stream 上运行的计算测试套件。人们已经尝试过，但还没有独立于平台的解决方案。可能是 GPU 基准测试强国之一可以完成这项工作。还有其他项目，如 MAGMA 或 GPUlib，它们在 Nvidia 的指导下蓬勃发展。GPGPU 的世界确实非常党派。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T20:53:51.540

LAMMPS 是最成功的基于 GPU 的分子动力学模拟器之一。主要开发人员 Axel Kohlmeyer[在帖子附件中的此页面上](http://lammps.sandia.gov/threads/msg24562.html)报告了他们的实验结果。这些结果是公平和有用的。

# javascript - 如何找到浏览器中断一段文本的位置

> ID：446966
> 
> 赞同：5
> 
> 时间：2009-01-15T14:36:35.743
> 
> 标签：javascript, html

我需要在浏览器自然在一段文本中添加换行符的位置添加换行符。

例如：

<p>这是一段很长的文本**\n**，跨越段落中的多行。</p>

这是浏览器选择在**\n的位置中断的段落**

我需要找到这个位置并插入一个 <br />

有谁知道任何能够做到这一点的 JS 库或函数？

到目前为止，我发现的唯一解决方案是从段落中删除标记并观察 clientHeight 属性以检测元素高度的变化。我没有时间完成这个，想找一些已经测试过的东西。

**编辑：** 我需要这样做的原因是我需要准确地将 HTML 转换为 PDF。Acrobat 呈现的文本比浏览器更窄。这会导致文本在不同位置中断。我需要在转换后的 PDF 中具有相同的参差不齐的边缘和相同的行数。

**编辑：**

@dtsazza：感谢您深思熟虑的回答。生成一个几乎完全复制我编写的 99% 的 HTML 的布局编辑器并非不可能；）

我正在开发的应用程序允许用户通过拖动“磁贴”来创建产品目录。磁贴是固定宽度、绝对定位的包含图像和文本的 div。所有元素都有样式，因此字体大小是固定的。我在段落中查找 \n 的解决方案在 80% 的情况下都可以，当它与给定的段落一起使用时，生成的 PDF 非常接近屏幕上的版本，因此差异并不重要。段落的高度相同（到像素），图像被高分辨率版本替换，所有位图作品都被替换为服务器端生成的 SVG。

我的 HTML 和 PDF 之间唯一的*细微*差别是 Acrobat 呈现的文本稍微更窄，这导致行的行长略短。

Diodeus 添加跨度并找到它们的坐标的解决方案是一个非常好的解决方案，应该给我 BR 的位置。请记住，用户永远不会看到插入了 BR 的 HTML - 添加这些 BR 是为了使 PDF 转换产生一个大小完全相同的段落。

有很多人似乎认为这是不可能的。我已经有一个可以工作的应用程序，它为我们的文档创建了*极其*准确的 HTML->PDF 转换——我只需要一个更好的添加 BR 的解决方案，因为我的解决方案有时会错过一个 BR。顺便说一句，当它起作用时，我的段落与 HTML 等价物的高度相同，这是我们所追求的结果。

如果有人对我正在转换的文档类型感兴趣，那么您可以查看此截屏视频：

[http://www.localsa.com.au/brochure/brochure.html](http://www.localsa.com.au/brochure/brochure.html)

**编辑：**非常感谢 Diodeus - 你的建议是正确的。

解决方案：对于我的情况，将单词包装在跨度而不是空格中更有意义。

var text = paragraphElement.innerHTML.replace(/ /g, '</span> <span>');

text = "<span>"+text+"</span>"; //包装第一个和最后一个单词。

这将每个单词包装在一个跨度中。我现在可以查询文档以获取所有单词，迭代并比较 y 位置。当 y pos 改变时添加一个 br。

这完美无瑕，并为我提供了我需要的结果 - 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T14:40:49.900

我建议将所有空格包装在一个跨度标签中并找到每个标签的坐标。当 Y 值发生变化时，您将处于新的一行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T14:43:53.763

如果有的话，我认为不会有一个非常干净的解决方案。浏览器将流动一个段落以适应可用空间，并在需要时换行。考虑一下，如果用户调整浏览器窗口的大小，所有段落都将被重新呈现，并且几乎肯定会改变它们的中断位置。如果用户更改页面上文本的大小，段落将使用不同的换行点重新呈现。如果您（或您页面上的某些脚本）更改页面上另一个元素的大小，这将更改可用于浮动段落的空间量，并再次更改 - 不同的换行点。

此外，更改页面的实际标记以模仿浏览器为您所做的事情（并且做得很好）似乎是您所做的任何事情的错误方法。您要在这里解决的*实际问题是什么？*可能有更好的方法来实现它。

**编辑**：好的，所以你想渲染为与“屏幕版本”相同的 PDF。您是否提名了特定的最终屏幕版本 - 在浏览器窗口尺寸、用户样式表、字体偏好和调整后的字体大小方面？ **HTML 的关键在于它故意不指定特定的布局**。它简单地描述了页面上的内容，它们是什么以及它们彼此之间的关系。

我之前看到过几次错误的尝试来生成一些 HTML，这些 HTML 将完全复制印刷的广告素材，设计在类似于 DTP 应用程序的东西中，其中明确的绝对布局是必不可少的。由于 HTML 的性质，这些努力注定要失败，而反过来（正如您尝试的那样）这样做会*更糟*，因为您甚至没有确定的工作起点。

假设这一切都超出了您的掌控，并且*无论如何*您都必须这样做，我的建议是放弃修改 HTML 的想法。查看 PDF 转换软件 - 如果它有任何好处，它应该为您提供一些字体字距调整和类似设置的选项。在这里玩弄细节应该会让你得到一些近似于浏览器中字体渲染的东西，从而在相同的地方换行。

如果做不到这一点，我所能建议的就是截取浏览器的屏幕截图并用 OCR 解析这些屏幕以找出断行的位置（它不应该需要非常准确的 OCR，因为无论如何你都知道原始文本是什么，它基本上只需要计算空格）。或者，如果文本搜索/选择不是什么大问题，也许只是将屏幕截图嵌入 PDF 中。

最后手工完成可能是最终可靠地完成这项工作的唯一方法。

但实际上，这仍然是*错误*的，任何修改要求的尝试都会更好。继续往上走一步 -*为什么*PDF 必须具有与某些任意浏览器渲染完全相同的参差不齐的边缘？你能以另一种（更好的）方式实现*这个目的吗？*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:45:25.290

当您考虑到用户设置的字体大小、MS Windows 可访问性模式和数百种不同的移动设备时，这听起来是个坏主意。让浏览器来做这件事——试图对渲染进行精确控制只会让你感到沮丧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T14:51:44.823

我认为如果不嵌入 Gecko/WebKit/Trident 或基本上重新创建它们，您将无法以任何准确度做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T15:42:49.697

也许另一种选择：自己完成所有换行符，而不是依赖浏览器。将所有文本放在前置标签中，并添加您自己的换行符。现在至少您不必弄清楚浏览器将它们放在哪里。

# asp.net - ASP.NET Ajax 脚本注册

> ID：446971
> 
> 赞同：0
> 
> 时间：2009-01-15T14:38:39.500
> 
> 标签：asp.net, ajax, scripting

什么时候应该使用 ScriptManager 来注册脚本，什么时候可以使用 Page.ClientScript？都有些什么样的规矩？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T14:55:15.970

目的是让 ScriptManager 与特定于 ASP.NET AJAX 的脚本一起使用，因为它应该确保事情以正确的顺序放置，并且预先注册了正确的依赖项，以便 ASP.NET AJAX 控件和脚本正常工作。

ClientScriptManager (Page.ClientScript) 一般用于 JavaScript，例如任何不直接绑定到 ASP.NET AJAX 的东西。

（根据 MSDN： http: [//msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx，http](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx) : [//msdn.microsoft.com/en-us/library/system.web。 ui.clientscriptmanager.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.aspx) )

# asp.net - ASP.NET Cookie Expires 值在 Response.Redirect 上重置？

> ID：446981
> 
> 赞同：3
> 
> 时间：2009-01-15T14:40:48.950
> 
> 标签：asp.net, vb.net, cookies

我有一个脚本可以读取表单并将一些信息放入 cookie：

```
Dim oCookie as HttpCookie
oCookie = New HttpCookie("authInfo")
Select Case oResult
Case "No ClientID", "No Password", "No PracType", "No Encrypt", "CRC Mismatch"
    oCookie.Values.Add("LoggedIn", "False")
    oCookie.Values.Add("OnSupport", "False")
Case "Client Can Update"
    oCookie.Values.Add("LoggedIn", "True")
    oCookie.Values.Add("OnSupport", "True")
Case "Client Cannot Update"
    oCookie.Values.Add("LoggedIn", "True")
    oCookie.Values.Add("OnSupport", "False")
End Select
oCookie.Expires = DateTime.Now.AddHours(2)
HttpContext.Current.Response.Cookies.Add(oCookie)
HttpContext.Current.Response.Redirect("default.aspx") 
```

在重定向之前正确设置了时间，但是当我尝试以这种方式打印出该值时（我也尝试过`Dim oCol as HttpCookieCollection = Request.Cookies`，但我得到了相同的结果）：

```
Response.Output.WriteLine(Request.Cookies("authInfo").Expires.ToString) 
```

时间总是被重置`"01/01/0001 12:00:00 AM"`。我是否遗漏了阻止 cookie 保持其`Expires`价值的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-15T14:47:11.010

Request.Cookies 和 Response.Cookies 以及通用 cookie 对象的使用构成了一个直观的习惯用法，但实际上 Request cookie 和 Response cookie 是完全不同的。

当您在响应中分配 Cookie 时，Set-Cookie 标头会添加到输出中，并且不仅包含值，还包含路径和到期值。

但是，当浏览器在另一个请求中将 cookie 发送回服务器时，它只包含 cookie 名称和值。它不发送路径或过期信息。

因此，这些属性在使用 Request.Cookies 集合时毫无意义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-07T06:44:37.697

我知道这是一个老话题，可能@Anders 已经从这里转向更大更好的事情了。尽管如此，我在尝试在我当前的 HttpContext 中保留 Office 365 身份验证 cookie 时遇到同样的问题后碰巧偶然发现了这一点。可以说，@AnthonyWJones 的回答澄清了我对 cookie 的很多直觉。这适用于像我这样必须遇到此线程的人，尽管交换了信息，但无法找出维持 cookie 到期日期的回旋处。这是我最终尝试的： 1\. 在将 cookie（其到期日期是必要的）添加到 HttpResponse 之前，我将其到期日期和域保存在我的数据库中。2\. 然后可以将 cookie 添加到 Response 中，其基本属性不变，例如“Name”和“Value”。3\. 从请求中检索到 cookie 后，我构造了一个新的 cookie，其中包含从数据库中获取的域和到期日期以及其余属性。然后我就可以使用这些 cookie 向目标站点发起进一步的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:50:53.080

当初始请求来自不同的域时，我遇到了这样的问题。
确保您还添加了 cookie 的域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T14:42:16.810

如果要检查过期日期，可以将其添加到 cookie 值集合中。然后检索它并进行检查。

# php - 跨不同计算机的 Actionscript 2 中的 LoadVars.sendAndLoad 出现问题

> ID：446986
> 
> 赞同：2
> 
> 时间：2009-01-15T14:41:11.117
> 
> 标签：php, flash, security, scripting, actionscript-2

我正在编写一个非常简单的 Flash 应用程序 (AS 2) 来为用户注册电子邮件通讯；它的工作方式是它使用 LoadVars 通过带有用户电子邮件地址的 POST 访问（相同域）PHP 脚本。然后，PHP 脚本通过 curl 将信息传递到另一个域（时事通讯邮件 URL）以注册用户。

到目前为止，一切都很好，它可以在大约 70% 的经过测试的计算机上运行（它是从网站上实时测试的，而不是本地测试）。但是，在某些计算机上，似乎并未进行 LoadVars.sendAndLoad 调用，因为从这些计算机发送的电子邮件地址未显示在订阅者列表中。我知道 PHP 脚本仍然可以在这些计算机上运行，​​因为我已经制作了一个准系统 HTML 表单，它的行为方式与 Flash 应用程序完全相同（使用相同的变量发送到相同的 PHP 脚本等）并且它适用于所有计算机。

这是相关的AS：

```
submit_btn.onRelease = function(){
    submitOutAnimation();
    this.enabled = false;
    var sendvar_lv:LoadVars = new LoadVars();
    var loadvar_lv:LoadVars = new LoadVars();
    loadvar_lv.onLoad = function(success:Boolean){
        gotoAndStop("successful");
    }
    sendvar_lv.email = entryField_mc.myAdd.text;
    sendvar_lv.sendAndLoad("http://notmyrealdomainname.com/passthrough.php?ck="+new Date().getTime(),loadvar_lv,"POST");
} 
```

这可能是 Flash 客户端设置的安全问题吗？你还有其他建议吗？我的印象是，假设它们具有相同的 Flash 播放器版本，不同计算机之间的 Flash 播放（除了性能）没有太大差异，而这种体验正在打破这种幻想......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T14:52:23.043

如果您尝试访问不在同一域（甚至是子域）中的脚本，则必须将跨域策略文件放在服务器根目录（crossdomain.xml）中

阅读更多： http://kb.adobe.com/selfservice/viewContent.do?externalId= [tn_14213](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14213)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T15:00:42.903

这可能取决于用户是否输入“www”前缀，因为它将被视为一个单独的子域。如果 Flash 位于同一台服务器上，为什么不删除“ [http://notmyrealdomainname.com](http://notmyrealdomainname.com) ”并使用 passthrough.php 的相对路径？

# c++ - 用于控制对“所有用户\应用程序数据”中文件的访问的 Windows 服务

> ID：446987
> 
> 赞同：2
> 
> 时间：2009-01-15T14:41:13.550
> 
> 标签：c++, windows, mfc

**这是我的情况：**

我有一个使用配置文件的应用程序。配置文件适用于系统的所有用户，所有用户都可以对配置进行更改。

我决定将配置文件放在“All Users\Application Data”文件夹中。

问题是该文件只能由创建它的用户写入。

**这是我的临时解决方案：**

创建文件时，应用程序设置其安全选项，以便系统的所有用户都可以写入。

但是，[我认为这是一个 hack](http://blogs.msdn.com/oldnewthing/archive/2004/11/22/267890.aspx)，我认为我必须创建一个服务来管理对文件的访问。

我的应用程序是用 C++ (MFC) 编写的，我不是所有 .Net 方面的专家。所以我的第一个想法是编写一个带有 COM 接口的 Windows C++ 服务，该服务将被应用程序调用。

**我的问题：**

*   我的想法是个好主意还是有人知道更好的方法？
*   有没有比普通的 C++ 和 COM 在 Windows 中提供服务的新方法？

**编辑：**

我知道为所有用户设置写权限很容易。

回到 Windows XP，在“程序文件”下编写文件和在“HKLM”下编写注册表项也很容易，用户受限。但是现在，如果您希望应用程序获得 Vista 徽标认证，则不能写信到这些位置（如果虚拟商店可以“拯救”您）。

也许我的最终解决方案将是“使其对所有用户都可写”，但我的问题确实是：“我的解决方案好还是您有另一个更简单的解决方案，它不依赖于破解微软修复的行为”。

我真的很抱歉没有从一开始就说清楚。

非常感谢，

网卡

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T21:22:52.350

这不是正确的做法。如果您将文件放在所有用户\应用程序数据中，那么它应该可以被所有用户写入。创建它时，为所有用户创建具有写入权限的它。设置创建权限并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T00:49:45.833

Raymond Chen 的文章有趣且详细，但通常过于教条和不切实际。除非这是一个有被篡改危险的关键任务系统，否则我会用一大堆 NaCl 来看待他的观点。

您的用户会直接打开和修改文件吗？如果不是，只需使文件全局可写并在您的应用程序界面中强制执行合理的更改。对于大多数类别的应用程序，不值得花时间和精力来保护多用户系统免受篡改。

或者，使用数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T15:12:47.980

我什至不会打扰COM。您的服务的命名管道也可以正常工作，并且使用 ACL 保护这些管道要容易得多。该服务将非常简单，我什至不会使用 MFC 或 .NET，纯 C++ 应该没问题。所有繁重的工作都由您的真实应用程序完成；该服务仅检查通过管道输入的请求是否合理。（即不要太大等）

# asp.net - 具有复杂类型验证的 Asp.net MVC 模块绑定

> ID：446989
> 
> 赞同：2
> 
> 时间：2009-01-15T14:41:24.453
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-beta1, model-binders

我正在 asp.net mvc 中构建一个问卷应用程序，但我在使用模块绑定器时遇到了复杂类型列表的问题。

首先：我无法让 Questionnaire.IList<QuestionGroup>.IList<Question> 对象图与活页夹一起使用。所以在下面的示例代码中，我只使用了一级 IList。

第二：我很想将我的存储库/工厂而不是类传递给活页夹，这样我就可以放弃表单问题和数据库问题之间的映射，只处理一组对象。或者至少比这段代码更漂亮一点；）。

有人为我指明了正确的方向吗？

控制器：

```
public class QuestionnaireController : Controller
{
    #region Constructors

    public QuestionnaireController(IRepositoryWithTypedId<QuestionGroup, string> questionnaireRepository)
    {
        repository = questionnaireRepository;
    }

    #endregion

    public ActionResult Create(string Id)
    {
        if (!string.IsNullOrEmpty(Id))
        {
            QuestionGroup questionnaire = repository.Get(Id);
            return View(questionnaire);
        }
        else return RedirectToAction("Index");
    }

    [Transaction]
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(string Id, QuestionGroup questionGroup)
    {
        QuestionGroup dbQuestionGroup = repository.Get(Id);

        //Map Questions in form to Questions from db
        foreach (var question in dbQuestionGroup.Questions)
        {
            Question persQuestion =
                    (from item in questionGroup.Questions where item.QuestionID.Equals(question.ID) select item)
                    .SingleOrDefault();
            if (persQuestion != null)
            {
                question.Answer = persQuestion.Answer;
            }
        }

        //Validate Questions(db)
        bool valid = true;
        foreach (var question in dbQuestionGroup.Questions)
        {
            if (!question.IsValid())
            {
                foreach (var item in question.ValidationMessages)
                {
                    ViewData.ModelState.AddModelError("questionGroup.Questions[" + question.ID + "]." +
                        item.PropertyName,
                        item.Message);
                }
                valid = false;
            }
        }

        //Return the same form with validation info appended
        if (!valid)
        {
            return View(dbQuestionGroup);
        }

        //Persist to db and redirect to Complete
        else
        {
            repository.SaveOrUpdate(dbQuestionGroup);
            return RedirectToAction("Complete");
        }
    }
    private IRepositoryWithTypedId<QuestionGroup, string> repository;
} 
```

部分视图（主视图只是对 QuestionGroup 中的问题进行 foreach 并为每个问题呈现此视图）

```
<div class="Question">
    <div class="QuestionTitle">
        <%=ViewData.Model.Description %>
    </div>
    <input name="questionGroup.Questions.Index" value='<%=ViewData.Model.ID %>' type="hidden" />
    <input name='<%="questionGroup.Questions[" + ViewData.Model.ID + "].QuestionID" %>' value='<%=ViewData.Model.ID %>' type="hidden" />
    <div class="QuestionText">
        <%switch (ViewData.Model.Type.ToLower())
    {
        case QuestionType.Text:%>
        <%=Html.TextBox("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <% break;
              case QuestionType.Number:%>
        <%=Html.TextBox("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <%= Html.ValidationMessage("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <% break;
                          case QuestionType.PhoneNumber:%>
        <%=Html.TextBox("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <% break;
                          case QuestionType.Email:%>
        <%=Html.TextBox("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <%= Html.ValidationMessage("response.Questions[" + ViewData.Model.ID + "].Answer")%>
        <% break;
                          case QuestionType.Date:%>
        <%=Html.TextBox("questionGroup.Questions[" + ViewData.Model.ID + "].Answer")%>
        <% break;
                          case QuestionType.YesNo:%>
        <%=Html.RadioButton("questionGroup.Questions[" + ViewData.Model.ID + "].Answer", "0", true)%>Ikke valgt<br />
        <%=Html.RadioButton("questionGroup.Questions[" + ViewData.Model.ID + "].Answer", "true", false)%>Ja<br />
        <%=Html.RadioButton("questionGroup.Questions[" + ViewData.Model.ID + "].Answer", "false", false)%>Nei<br />
        <% break;
                          case QuestionType.Alternative:%>
        <%=Html.DropDownList("questionGroup.Questions[" + ViewData.Model.ID + "].Answer", new SelectList(ViewData.Model.Alternatives, "ID", "Description"))%>
        <% break;
          }%>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T19:08:40.173

I have written how to do this with MvcContrib.FluentHtml:

*   [Editing a Variable Length List Of Items With MvcContrib.FluentHtml](http://lunaverse.wordpress.com/2009/01/02/editing-a-variable-length-list-of-items-with-mvccontribfluenthtml/)
*   [Editing a Variable Length List Of Items With MvcContrib.FluentHtml - Take 2](http://lunaverse.wordpress.com/2009/01/13/editing-a-variable-length-list-of-items-with-mvccontribfluenthtml-take-2/)

One problem I see is that you are setting the value of your indexer of your Question list item to the Questionaire ID, which is two levels up. The value should be the ID of the question, if it exists, or some proxy value (such as a negative number) that tells you it's a new instance.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T15:47:24.213

You can always write your own custom ModelBinder which would require you to write about two methods. See the UpdateCollection method [here](http://www.codeplex.com/aspnet/SourceControl/changeset/file/view/17272/266460). You could then passs your repository to your custom ModelBinder.

# .net - 是否有任何提供 .Net（或 COM）API 的防病毒产品？

> ID：446999
> 
> 赞同：3
> 
> 时间：2009-01-15T14:44:10.737
> 
> 标签：.net, antivirus

我们需要将上传的文件从我们的 CMS 网站作为 POC 发送到任何防病毒产品。是否有任何提供 .Net/COM API 的 AV 产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T23:54:01.667

[Clam AntiVirus有一个在 GNU GPL 下可用的 API，您可能可以用](http://www.clamav.net/)[SWIG](http://www.swig.org/)打包它。

如果出于某种原因您不希望他们的代码出现在您的进程中，您还可以使用他们的（非常简单的）套接字协议：打开一个套接字并发送它 SCAN *filename*，或者发送它 STREAM 并且它会发回一个端口号然后您可以发送一个字节流进行扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T19:47:34.987

您可以查看[Microsoft 的防病毒 API](http://msdn.microsoft.com/en-us/library/ms537365(VS.85).aspx)。我相信它为应用程序与已安装的防病毒软件集成提供了一种方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:45:51.750

通常你使用 AntiVirus API 不会有任何运气，因为它们都受到了很好的保护，并且代码和方法都被上帝锁定了，但是有像[OPSWAT](http://www.opswat.com/antivirussdk.shtml)这样的方法，你可以使用系统中已经安装的 AntiVirus 并且有种类'一个控制，请阅读网站了解更多信息。**************