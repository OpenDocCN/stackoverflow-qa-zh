# StackOverflow 问答 000452000-000452999

# javascript - 在它发生之前取消/杀死 window.setTimeout()

> ID：452003
> 
> 赞同：229
> 
> 时间：2009-01-16T21:05:27.857
> 
> 标签：javascript, jquery

例如，我有几个地方使用下面的行来清除状态。我有一些会挂出 10 秒或更长时间，如果用户点击周围的动作可能会以不正确的时间间隔发生。

```
window.setTimeout(function() { removeStatusIndicator(); }, statusTimeout); 
```

是否可以使用一些 jQuery 或 JavaScript 代码取消或终止它，所以我没有这个过程？

* * *

## 回答 #1

> 赞同：434
> 
> 时间：2009-01-16T21:06:16.123

```
var timer1 = setTimeout(function() { removeStatusIndicator(); }, statusTimeout);

clearTimeout(timer1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-23T12:47:54.050

`window.clearTimeout()`应该做你想要达到的目标。

# c# - C# ConfigurationManager.GetSection 无法加载文件或程序集

> ID：452004
> 
> 赞同：16
> 
> 时间：2009-01-16T21:06:02.893
> 
> 标签：c#, configurationmanager, configsection

我被困住了！这看起来真的很愚蠢，但我看不出我哪里出错了。我正在创建一个 2.0 C# ASP.NET 网站。我正在尝试使用 web.config 文件中的自定义部分：

```
DatabaseFactorySectionHandler sectionHandler = ConfigurationManager.GetSection("DatabaseFactoryConfiguration") as DatabaseFactorySectionHandler; 
```

对于 Bailey.DataLayer 命名空间中的对象，我有一个单独的 DLL。但是当我运行 test.aspx 页面时，出现以下错误：

```
System.Configuration.ConfigurationErrorsException was unhandled by user code

Message="An error occurred creating the configuration section handler for DatabaseFactoryConfiguration: Could not load file or assembly 'Bailey.DataLayer' or one of its dependencies. The system cannot find the file specified. (C:\\Documents and Settings\\Administrator.PIP\\My Documents\\Visual Studio 2005\\WebSites\\bailey\\web.config line 13)"
Source="System.Configuration" 
```

我想要获得的课程如下：

```
namespace Bailey.DataLayer
{
    public sealed class DatabaseFactorySectionHandler : ConfigurationSection
    {
        [ConfigurationProperty("Name")]
        public string Name
        {
            get { return (string)base["Name"]; }
        }

        [ConfigurationProperty("ConnectionStringName")]
        public string ConnectionStringName
        {
            get { return (string)base["ConnectionStringName"]; }
        }

        public string ConnectionString
        {
            get
            {
                try
                {
                    return ConfigurationManager.ConnectionStrings[ConnectionStringName].ConnectionString;
                }
                catch (Exception excep)
                {
                    throw new Exception("Connection string " + ConnectionStringName +
                                        " was not found in web.config. " + 
                                        excep.Message);
                }
            }
        }
    }
} 
```

Web 配置文件包含以下部分：

```
<configSections>
  <section name="DatabaseFactoryConfiguration" 
           type="Bailey.DataLayer.DatabaseFactorySectionHandler, Bailey.DataLayer" />
</configSections> 
```

我已经在控制台应用程序中做到了这一点，没有任何问题，但除了在网页中之外看不到任何差异。

**编辑**

它全部编译并在运行时抛出错误，所以我只能假设它找到了程序集，因为它在 test.aspx.cs 页面中被引用。

我在 test.aspx.cs 页面的顶部有以下 using 语句：

```
using Bailey.DataLayer; 
```

这是整个 web.config 文件，所以没有混淆：

```
<configuration>
   <configSections>
      <section name="DatabaseFactoryConfiguration" type="Bailey.DataLayer.DatabaseFactorySectionHandler, Bailey.DataLayer" />
   </configSections>
    <appSettings/>
   <connectionStrings>
      <add name="BaileyMDFConString" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\bailey.mdf;Integrated Security=True;User Instance=True"  providerName="System.Data.SqlClient" />
    </connectionStrings>
     <DatabaseFactoryConfiguration Name="System.Data.SqlClient" ConnectionStringName="BaileyMDFConString" />
   <system.web>         
      <compilation debug="true"/>       
      <authentication mode="Windows"/>  
   </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-16T21:53:04.827

要么您使用了错误的名称（即它不叫 Bailey.DataLayer.dll），要么它没有在构建时被复制到 bin 目录中。然而，最后一个似乎不太可能。

（请参阅我对问题的评论以进行澄清）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-18T15:27:04.153

好的......我有同样的问题。以上解决方案都没有帮助。在我的情况下，我的配置文件与 web.config 在同一个 dll 中。我只是从配置部分中删除了命名空间，这解决了我的问题。

**不工作**

```
<configSections>
<section name="authorizedServerSection" type="ProjectName.ClientApi.Filters.AuthorizedServerSection, ProjectName.ClientApi.Filters" requirePermission="false"/> 
```

**在职的**

```
<configSections>
<section name="authorizedServerSection" type="ProjectName.ClientApi.Filters.AuthorizedServerSection" requirePermission="false"/> 
```

一旦我删除了命名空间`, ProjectName.ClientApi.Filters`，它就开始工作了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T21:14:00.117

您需要配置文件中的两个条目，一个在 configSections 元素上声明自定义配置部分，另一个 - 实际的自定义配置部分本身。两个都加了吗？

例如：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>

  <configSections>
    **<section name="Connections"
             type="System.Configuration.DictionarySectionHandler" />**
  </configSections>

  <Connections 
        <add key="myServer" value="serverName" />
        <add key="myPort"   value="8080" />
        <add key="myURI"    value="RequestUri" />
        <add key="UserId"   value="joebob" />
        <add key="password" value="$^%^&%$^&@%" />        
   />

</configuration> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-03T09:30:22.893

您可能想查看[http://www.primaryobjects.com/CMS/Article81.aspx](http://www.primaryobjects.com/CMS/Article81.aspx)，其中几乎逐行包含您上面显示的代码，包括来自 web.config 文件的示例。

# c# - 在wince中打开2个数据库

> ID：452006
> 
> 赞同：0
> 
> 时间：2009-01-16T21:06:09.040
> 
> 标签：c#, database, compact-framework, windows-ce

是否可以在 WinCE 中打开 2 个以上的数据库？

我使用 Sql CE 3.5。我可以获得打开 2 个连接的示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T00:33:43.223

你将不得不给我们更多的东西才能继续下去。什么样的数据库？SQLCE？MySQL？通过 SqlClient 的 SQL Server？教育局？db4o? 还有什么？

一般来说，从一个应用程序同时打开多个数据库是没有问题的——你只需要为每个数据库设置一个单独的连接对象。您还可以与同一个数据库建立多个连接，前提是您使用的数据引擎支持它（SQL CE 3.5 支持，早期不支持，SQL Server 支持，不知道 MySQL 是否支持）。

编辑：例如，要与 SQL CE 数据库建立 2 个单独的连接，只需使用相同的连接字符串创建两个不同的 SqlCeConnection 对象。

# mysql - mysql集群中基于磁盘的存储

> ID：452013
> 
> 赞同：2
> 
> 时间：2009-01-16T21:07:12.050
> 
> 标签：mysql, partitioning, cluster-computing

我一直在尝试找出是否可以在 MySQL Cluster 中使用基于磁盘的表进行表分区。我想在磁盘上存储一个大表，并对表进行范围分区。我有一种感觉，答案是否定的。

感谢您提供的任何信息。

麦克风。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T00:22:54.960

任何未编入索引的列都可以使用 MySQL Cluster 存储到磁盘（我认为大约是一年前）。

[http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-disk-data.html](http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-disk-data.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:25:16.757

Looks like only partitioning by key is supported for cluster, whether in memory or on disk: [http://dev.mysql.com/doc/refman/5.1/en/partitioning-limitations-storage-engines.html](http://dev.mysql.com/doc/refman/5.1/en/partitioning-limitations-storage-engines.html)

Range partitioning (and Hash, and List) are possible if MySQLD is started with the --new option, so data can be stored on disk, partitioned by range, . Cluster

# sql-server - SQL Server 2005 复制调试建议

> ID：452016
> 
> 赞同：1
> 
> 时间：2009-01-16T21:07:31.503
> 
> 标签：sql-server, sql-server-2005, replication

我有一个复制设置，它昨天启动并运行，现在我无法连接到分销商，我不知道为什么。

*   发布者在域上并通过 VPN 与订阅者（不在域上）对话。
*   我可以从订阅者 ping 发布者，反之亦然。
*   我可以从订阅者登录到发布者上的 MSSQL。
*   发布者处于错误状态，因为没有从订阅者记录任何活动。
*   订阅者无法连接到分发者。
*   Tracer 令牌为分发者报告一个时间，但只为订阅者等待。
*   假设第三方更改数据库可能会造成麻烦，我删除了订阅和发布并重新创建了它们。
*   我可以确认昨天使用相同的表/用户帐户/服务器等复制正在工作并复制数据。

如果您有任何建议来尝试缩小问题所在，我们将不胜感激。

**问题解答：**

*   我正在使用一种方式的事务复制
*   分发者与发布者在同一台机器上。
*   发布者和订阅者都是 2003 SP2

**似乎又开始工作了**

我仍然不知道为什么原来的工作设置停止工作。但是当我重新订阅时，其中一个连接的凭据错误。通过纠正该问题，复制再次正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T04:52:53.147

可以双向执行 T-SQL 吗？你说订阅者无法连接到分发器，但是分发器可以看到两者吗？分发器是在您的网络上还是在远程网络上？我只是想知道分发器上的事情是否正在批量处理，并且那里与您的订阅者之间断开连接，或者断开连接是发布者 - >分发器，特别是如果这三个都在不同的服务器上。

只是从某个地方开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:25:22.660

我从来不需要调试日志阅读器的问题，但经常不得不调试订阅者的问题。我要做的是运行分发代理（我记得它被称为 distrib.exe ......那是因为我经常输入它！）设置了大量的调试标志日志（我只是在BOL 并查看一个参数 OutputVerboseLevel。我不直接记住该参数名称，但它看起来很合理）。

您可以通过查找复制向导设置的作业定义来确定要向代理提供什么样的参数。其中一个步骤应该是“运行外部命令”，这将有一堆参数名称和值。

一旦我找到了合适的调用，我将它保存在一个批处理文件中，然后在出现无法从 GUI 调试的问题时从 DOS 提示符运行它。

pjjH

# python - Python 和蓝牙/OBEX

> ID：452018
> 
> 赞同：2
> 
> 时间：2009-01-16T21:08:16.087
> 
> 标签：python, bluetooth

是否有任何 Python 库可以让我使用 OBEX（OBject EXchange）发送文件并且可以跨平台（Windows、OS X、Linux）工作？我找到了 Lightblue，它适用于 Linux 和 OS X，但不适用于 Windows。

如果不存在这样的库，是否有任何仅适用于 Windows 的像样的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-31T20:12:45.577

PyOBEX 可能会工作，但它只在 Linux 蓝牙堆栈上进行了测试：

[http://pypi.python.org/pypi/PyOBEX/0.10](http://pypi.python.org/pypi/PyOBEX/0.10)

很高兴知道它是否在 Windows 和 Mac OS X 上正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T16:59:45.317

[PyBluez - Windows](http://org.csail.mit.edu/pybluez/)

# php - php图像包含问题

> ID：452019
> 
> 赞同：1
> 
> 时间：2009-01-16T21:08:53.293
> 
> 标签：php, html

我在我的网站中使用这个 php 文件作为标题。我的问题是我已经包含了一个图像，但它没有显示是什么问题？这是我的代码

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>

<h2><center><img src="../../../../Users/sermed/Desktop/Manar's New web site/Harbourheader.gif" /></center></h2>
<center><b><font color="#000000">You logged in as : <? echo "<font color=#000000>$user1</font>";?></b></center>
<hr width=500>
<center><a href="main.php" class=links><font color="#000000">Home</font></a> | <a href="yachts.php" class=links><font color="#000000">Yachts</font></a> | <a href="buy.php" class=links><font color="#000000">Buy</font></a> | <a href="ret.php" class=links><font color="#000000">View History</font></a> | <a href="report.php" class=links><font color="#000000">Report</font></a> | <a href="help.php" class=links><font color="#000000">Help</font></a> | <a href="logout.php" class=links><font color="#000000">Logout</font></a><center>
<hr width=750>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:13:34.017

`img src`必须引用可以下载图像的 URL，而不是其在本地磁盘上的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:14:52.207

您不能只访问您想要的硬盘驱动器上的任何文件。如果它位于 WebServer 基础的目录之上（例如 localhost/ 或 mysite.com/），则不能使用 .. 进入文件系统的更高位置。我猜这就是你的问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T21:58:37.220

一般来说，img 标签不会在 HTML 文件中“包含”图像。img 标签告诉浏览器向服务器发出另一个请求以获取文件。这都是客户端，而不是服务器端。

因此，src 必须引用浏览器可访问的资源。正如其他人所说，它应该是一个 URL。在它看起来不像 URL 的示例中（例如 /images/Harbourheader.gif），这是因为浏览器会在前面添加相同的服务器名称来获取它用来获取原始页面的 img。

--
bmb

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T21:15:54.763

在我看来，您使用的是机器上的路径而不是服务器路径，并且它位于您的 Web 根目录之外。

将图像移动到您网站中的图像目录并使用绝对路径引用它。

```
<img src="/images/Harbourheader.gif" /> 
```

# asp.net - IE6中使用AlphaImageLoader的动态透明图片

> ID：452039
> 
> 赞同：0
> 
> 时间：2009-01-16T21:13:57.463
> 
> 标签：asp.net, internet-explorer-6, png, transparent

当我在 IE6 中有想要透明的图像时，以下代码可以正常工作。

`<img src="image.png" style="width: 100px; height: 100px; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='image.png', sizingMethod='scale')" />`

但是以下没有。在此示例中，我使用的是动态生成的 PNG 文件。

我假设它是因为过滤器不知道图像实际上是 PNG

`<img src="/dynimg/createImg.aspx?id=123" style="width: 100px; height: 100px; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='dynimg/createImg.aspx?id=123', sizingMethod='scale')" />`

有没有其他方法可以应用“过滤器”并强制它假设我的图像实际上是 PNG。

注意：非动态情况下的image.png文件实际上是我的动态aspx页面生成的——所以动态创建的图片没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T21:37:29.617

事实证明，当您使用 IMG 控件时，IMG.src 图像显示在过滤后的图像（透明图像）之上。

我假设上述方法有效，但实际上并没有。由于我所做的事情的顺序，我欺骗自己认为它有效。

它是否动态实际上并不重要。

# wpf - WPF 网格与 Stackpanel

> ID：452045
> 
> 赞同：15
> 
> 时间：2009-01-16T21:15:03.907
> 
> 标签：wpf, silverlight, grid, stackpanel

对于 WPF/Silverlight 布局，使用具有大量行和列的 Grid 还是使用大量 Stackpanel 更好？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-16T21:56:49.657

如果您需要将事物水平和垂直排列，则应该使用网格。当这些东西不需要与其他任何东西对齐时，使用 StackPanel 创建一行或一列。

但是，不要将自己限制在这两个选项中。特别是，看看 DockPanel。它比 StackPanel 稍微复杂一些，但它的标记并不像 Grid 那样混乱。这是 DockPanel 上的一篇好文章：

[在 Silverlight 2 中使用 DockPanel](http://web.archive.org/web/20131115062922/http://www.silverlightshow.net/items/Using-the-DockPanel-in-Silverlight-2.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T21:41:37.410

您使用的容器应该基于内容，而不是一种方法是否优于另一种方法。如果你需要水平和垂直排列的东西，你真的应该使用网格。但除此之外，这实际上取决于您打算显示的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T21:47:22.140

我认为网格是一个更好的主意。我通常使用 Grid 设置总体布局，并在这里和那里使用一些堆栈面板来做一些特定的事情。我也有一种感觉，网格的性能更好，而且网格通常会给你更多的灵活性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T16:42:45.983

我不认为 Grid 是一个更好的主意。

例如，如果您想在现有的 Grid 布局文档中插入一行（在中间）

现有行是 1,2,3,4 ，那么要求是在 1 和 2 之间插入新行。

然后您必须将 2,3,4 更改为 3,4,5 （查找所有标记更改....）

想想如果一行有 3 - 5 列......重新排序所有数字是一项肮脏的工作。！！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-15T05:22:10.410

我更喜欢 StackPanel，因为我发现在插入新元素、行或列时更容易进行更改。使用网格，您需要阅读行号和列号以找出您的位置。使用 StackPanel，您只需跟随嵌套，这比网格更容易且不那么混乱。

例如，在 XAML 页面中，我使用像父网格一样的水平堆栈面板，然后如果我需要一个列，我会嵌套一个单独的“垂直”堆栈面板。这样，水平堆栈面板变成了“网格”，嵌套的垂直堆栈面板变成了列。我发现这更容易阅读和修改网格中的行和列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-23T15:13:48.383

两者都有力量（网格/堆栈面板）。Grid 的问题是线条重组。Stackpanel 的问题是没有表结构（固定列宽）。所以我认为这是解决这个问题的好方法:-)

定义样式

```
<Page.Resources>
    <Style x:Key="LabelCol1" TargetType="Label">
        <Setter Property="Width" Value="200" />
    </Style>
    <Style x:Key="EditCol2" TargetType="TextBox">
        <Setter Property="Width" Value="250" />
        <Setter Property="TextWrapping" Value="Wrap" />
        <Setter Property="Margin" Value="3" />
    </Style>
    <Style x:Key="ButtonCol3" TargetType="Button">
        <Setter Property="Width" Value="120" />
        <Setter Property="Margin" Value="3" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
    </Style>
</Page.Resources> 
```

并在 Stackpanel 中使用样式

```
<StackPanel>
    <StackPanel Orientation="Horizontal">
        <Label Style="{StaticResource LabelCol1}" Content="Solution path"  />
        <TextBox Style="{StaticResource EditCol2}" />
        <Button Style="{StaticResource ButtonCol3}" Content="Open..." />
    </StackPanel>
    <StackPanel Orientation="Horizontal">
        <Label Style="{StaticResource LabelCol1}" Content="Solution name"  />
        <TextBox Style="{StaticResource EditCol2}" />
    </StackPanel>
</StackPanel> 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-01-16T21:30:42.953

我对这种布局没有经验，但我敢打赌，与许多嵌套的堆栈面板相比，网格更容易渲染。

# sql-server - 在 SQL 2005 中使用模式的最佳实践？

> ID：452048
> 
> 赞同：2
> 
> 时间：2009-01-16T21:16:50.250
> 
> 标签：sql-server, sql-server-2005, schema

我们计划将 SQL 2000 数据库迁移到 SQL 2005，我熟悉 2005 年在各种所有者/模式下创建表或其他对象的能力。

我们在 SQL 2000 中并没有真正具备这种能力，所以我想知道我的指南/最佳实践将用于创建/管理多个模式。

我应该为所有对象创建一个模式吗？我应该如何划分它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T22:00:45.903

我尝试使用它来划分数据库内的责任区域。

我将有一个 util/utils/tools 模式，它在数据库之间非常可移植，并且有一个数字表、UDF、SP 和帮助处理数据库的东西。这些过程不引用 utils 架构之外的任何内容。

然后我将有一个临时/工作/临时模式，我可以在其中执行 SELECT INTO 并创建我想要一个真实表而不是临时#table 的表。这里基本上只有表格，但表格上也可能有一些视图。

我有一个完全独立的用于验证导入和测试结果的数据库，但如果你没有，我可能有一个导入、导出和测试/测试结果模式，其中包含那些是 ETL 的东西或回归测试的已知良好结果反对。

那么其他一切都只会出现在几个模式中 - 或者可能只是一个。在大型系统中，每个子系统都可能是一个模式。其中的代码可以引用其他模式，但在引用模式之外的任何内容时都应该非常仔细地查看。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-16T21:21:32.100

在设置新的测试服务器时，我对所有事情都使用了一个巨大的模式，我只有一个要运行的文件，我知道它包含所需的一切。

一些 ORM 会为每个对象生成一个文件，这可能有助于跟踪更改？但我没有看到手动执行此操作的目的。

# sql-server - LINQ to SQL 支持哪些版本的 SQL Server？

> ID：452050
> 
> 赞同：7
> 
> 时间：2009-01-16T21:17:01.000
> 
> 标签：sql-server, linq, linq-to-sql

SQL Server 2000 可以用作 LINQ to SQL 的数据库吗？

LINQ to SQL 是否依赖于特定版本的 Microsoft SQL Server？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-16T21:21:17.653

是的，LINQ to SQL 可与 SQL Sever 2000 一起使用，但有一个例外：您确实需要 ROW_NUMBER() 函数，该函数仅在 SQL Server 2005/2008 中可用，以支持高效的服务器端分页。没有它，分页功能（正如 Mehrdad 指出的）是使用经典的 Top N 策略提供的——当您在数据集中进一步分页时效率*非常*低，因为您最终会从第三页开始丢弃大部分选择的记录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T21:19:19.047

是的你可以。

LINQ to SQL 调整生成的查询以使用 2000。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-30T15:40:58.950

*从 VS 2010 开始，在任何情况下都不*支持SQL Server 2000 的 L2S （尽管一些第三方工具添加了支持）。

# javascript - javascript中需要正则表达式帮助

> ID：452054
> 
> 赞同：0
> 
> 时间：2009-01-16T21:19:11.230
> 
> 标签：javascript, regex

这里的第一个问题，所以请友好:)

我对正则表达式知之甚少，但我在当前项目中使用一个从字符串中删除特殊字符的正则表达式。看起来像这样...

```
newWord = newWord.replace(/[^0-9A-Za-z ]/g, ""); 
```

它工作得很好，但我需要稍微修改一下，这样它就不会删除 £ (GBP) 字符。

我已经尝试了几件事，但是从一开始就没有学习正则表达式，我只是在猜测，但都没有奏效。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T21:23:42.437

```
newWord = newWord.replace(/[^0-9A-Za-z£ ]/g, "") 
```

或使用 Unicode 转义

```
newWord = newWord.replace(/[^0-9A-Za-z\u00a3\u0020]/g, "") 
```

您使用此正则表达式所做的是删除不在您提供的列表中的任何字符。该`minus`字符用于表示一个范围，因此任何不在 0-9 (0,1,2,3,..9) AZ 和 az 中的字符都被替换为空 ("")。通过添加 £，它将不再用任何内容代替它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T21:26:48.280

```
newWord = "10 -+-sdf£";
newWord = newWord.replace(/[^0-9A-Za-z £]/g, "");
WScript.StdOut.WriteLine(newWord); 
```

# visual-studio-2008 - 如何将 Visual Studio 的默认 xml 编码更改为“utf-16”

> ID：452056
> 
> 赞同：1
> 
> 时间：2009-01-16T21:19:33.007
> 
> 标签：visual-studio-2008, visual-studio-2005

有什么方法可以将*Visual Studio 2005/2008*的默认新`xml/xsl/xsd`文件设置`utf-8`为`utf-16`

我做了一些寻找，但我只是找不到一个好的网站来参考..我也看过所有的选项，但我没有看到它......

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-26T20:35:16.440

由于您无法在选项中设置默认值，您可以考虑以下替代方案： http: [//devblog.ailon.org/devblog/post/2007/11/05/File-Encoding-in-Visual-Studio.aspx](http://devblog.ailon.org/devblog/post/2007/11/05/File-Encoding-in-Visual-Studio.aspx)

默认编码基于 Windows 设置的语言。但是，您也许可以改变这一点。在 Visual Studio 中，单击选项 > 环境 > 国际设置。如果可以，请设置为“英语”。这就是我的 VS 设置的内容，我的新 XML 文件默认为 utf-8。

此外，您始终可以在保存文件时更改编码，即使这并不是您问题的真正解决方案。单击文件 > 高级保存选项，然后选择 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T01:51:57.240

显然这是不可能的...... :(

# iphone - 堆叠的 UIView 层不移动

> ID：452057
> 
> 赞同：2
> 
> 时间：2009-01-16T21:19:38.997
> 
> 标签：iphone, cocoa-touch

我正在开发一个基于加速度计在其他 UIView 层之间移动 UIView 层的 iPhone 应用程序。

如果最顶层是根据加速度计移动的那一层，那没问题。如果我在它上面添加一个 UIView ，移动就会非常延迟。如果我在其上添加第二个 UIView，则移动停止。

updateInterval 为 60，我使用 UIView 的 drawAtPoint: 方法来移动图层。

我的问题：是否需要启用 UIView 属性，例如 opaque、clipsToBounds 等，以使夹层 UIView 发生基于加速度计的准确移动？

提前感谢您提供的任何帮助。

### 更新：

底层是不透明的，上面的层是透明的 PNG。

我在访问 UIView 的 frame 属性时遇到了困难。这是我`Object2D`班上的一些代码：

```
- (id)initWithImage:(NSString*)imageName
{
    if (self = [super init])
    {
        position = [[Point2D alloc] init];
        vector = [[Vector2D alloc] init];
        imagePath = [[NSBundle mainBundle] pathForResource:imageName ofType:@"png"]; 
        myImageObj = [[UIImage alloc] initWithContentsOfFile:imagePath]; 
        size.width = myImageObj.size.width;
        size.height = myImageObj.size.height;
    }

    return self;
} 
```

`draw:`这是从类中调用的类的原始方法`ViewController`：

```
- (void)draw
{
    [myImageObj drawAtPoint:CGPointMake( position.X, position.Y ) ];
    [ self setNeedsDisplay ];
} 
```

我尝试了各种方法来访问框架属性，但无济于事：

```
myImageObj.frame = CGRectMake(position.X, position.Y, size.width, size.height);
myImageObj.CGImage.frame.y = position.Y; 
```

查看 API 文档表明第一种方法会起作用，但它不会。

你知道如何访问 UIView 的 frame 属性吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T02:17:43.180

您不能直接设置单个帧参数。您必须创建一个新的 CGRect 并将框架设置为该 CGRect。创建 CGRect 后，有多种方法可以更改其参数。

```
CGRect myNewFrame = someView.frame;

myNewFrame.origin.x = 1.0;

myNewFrame.size = CGSizeMake(100.0f, 50.0f);

someView.frame = myNewFrame; 
```

这个想法是按照你想要的方式设置 CGRect，然后将视图的 frame 属性设置为那个 CGRect，然后你就可以了。

至于 UIView... 你可能有一些问题。首先，如上所述，drawAtPoint 方法很昂贵。其次，也许更糟的是，你有几个透明图像。透明度是 iPhone 上最昂贵的操作之一，事实上，Instruments 中有一个测试就是为了这个。您应该不惜一切代价避免透明度。一些在旋转期间全部重绘的透明 PNG 很可能会给您的应用程序带来麻烦。

我的下一个建议是考虑是否需要在透明胶片中间放置视图，也许另一层可以完成这项工作。如果您需要触摸功能，可以使用层层次结构根部的视图来处理触摸。换句话说，从后到前你有这个：
UIView CALayer UIView CALayer CALayer

但你可以这样： UIView (now handle all touches) CALayer CALayer (previously a view) CALayer CALayer

这也将有所帮助，因为 CALayers 的开销比 UIViews 少。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T20:35:31.787

每次使用 drawAtPoint: 时，都会强制将 UIView 重新渲染到图形层中。这是昂贵的。

UIView 已经有一个 -frame 属性来定义它的位置和大小。仅更新位置允许图形硬件移动已经合成的图层。

我不确定您所说的“三明治”是什么意思，但我假设它将图层放置在不同的 z 索引处？如果是这样，我假设中间层（您正在移动的层）和顶层必须是透明的，而底层应该是不透明的才能发挥作用。

如果这不是您想要的，请告诉我……</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T02:32:51.587

我认为您误解了 UIViews 的工作原理。首先，您要创建 UIImageViews 来托管您的 UIImages。然后，您想使用其 addSubview: 方法将它们添加到一个超级视图中。最后，您想要更改中间 UIImageView 的 frame 属性（如果您希望它平滑地动画，则在 beginAnimations / commitAnimations 块内）以使其移动到您的新位置。

如果将 UIImage 放在封装的 UIImageView 中，它会作为纹理缓存在 GPU 上，并且 UIImageView 位置的任何变化都将通过硬件加速。drawAtPoint:，正如 Dan 指出的那样，非常昂贵，如果可以的话，应该避免使用。你的 myImageObj.frame = CGRectMake 代码走在正确的轨道上，它只需要应用于 UIImageView，而不是 UIImage。

对于一个简单的三层结构，除非你有大量的图像，否则即使是透明度很高的图像也能流畅地动画。我已经为几十个透明的 UIViews（它们只是 CALayers 周围的非常轻的包装器）做了这个，没有性能障碍。

顺便说一句，如果您的 Point2D 和 Vector2D 类只是 2-D 坐标的包装器，您可能希望考虑用 CGPoint 结构替换它们。围绕这种轻量级数据类型有很多支持功能。

# algorithm - 代码应该有多复杂？

> ID：452059
> 
> 赞同：38
> 
> 时间：2009-01-16T21:20:00.900
> 
> 标签：algorithm, maintainability, cyclomatic-complexity, code-complexity

我正在研究可以帮助我编写更小但更复杂的代码的算法。与其编写 150 行 if-else 语句，我可以设计一个算法，用 20 行来完成。问题是很多这些算法可能很复杂，需要大量的数学才能理解它们。我也是这里唯一了解他们的人。

为了代码的可维护性，像其他人一样编写代码会更好，还是使用算法更好？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-16T21:28:18.137

正如爱因斯坦所说：

> 让一切尽可能简单，但不要更简单。

它适用于代码和物理。

使用您的判断 - 它会变得更容易维护吗？通常通过将大的 if/else 混乱减少到更小的东西，您可以删除不需要存在的极端情况，从而防止将来可能出现的错误。当然，通过将一组明确的条件简化为一个模糊的布尔逻辑扭曲，这种逻辑只会碰巧起作用，当某些事情发生变化时，您可能会使事情变得更加难以维护。

编辑：
对于您引用的案例，如果该公式可行，那么它可能是更好的选择-您甚至可以引用源代码发表评论。不过，完全有可能该公式以前存在，但被删除以允许解决特定情况。这是版本控制存储库中的注释应该提供帮助的那种事情。

由于还没有人发布链接，这里是他所指[的 PID 算法的描述。](http://en.wikipedia.org/wiki/PID_controller)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-16T21:35:13.117

代码写一次，读十次。因此，您应该尽量使其易于理解。

此外，调试比编写代码要困难得多。那么，当您已经将所有的脑力都用于编写复杂的代码时，您怎么能调试您的代码呢？

试着遵循[软件开发的三定律](http://martin.ankerl.com/2007/01/05/three-laws-of-software-development/)：

1.  开发人员必须编写能够创造价值的代码。
2.  开发人员必须使他们的代码易于维护，除非此类支出与第一定律相冲突。
3.  开发人员必须将他们的代码减少到可能的最小大小，只要这种减少不与前两条定律相冲突。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-01-16T21:25:48.237

Robert C. Martin 用这部漫画作为他的书*Clean Code*的介绍：

[![代码质量的唯一有效度量：WTFs/minute](https://i.stack.imgur.com/WQYtD.jpg)](https://i.stack.imgur.com/WQYtD.jpg)
[（来源：[osnews.com](http://www.osnews.com/images/comics/wtfm.jpg)）]

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-16T21:22:28.073

请记住，代码应该主要由人类理解......编译器负责让计算机理解。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-01-16T21:25:00.873

“复杂”的程度在这里可能有点冒险，但只要算法不需要数学博士来解决，

我会说继续使用算法。确保提供有关算法名称的适当级别的文档，并且可能是对其工作原理的简短描述或对有关它的文档的引用。

它将减少代码量，有望为应用程序提供一些额外的性能，并有望鼓励您周围的一些程序员学习一些新东西以添加到他们的曲目中。另外，知道这些事情的程序员总是有可能以后不会进来。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-16T21:38:02.657

好旧的报价....

> 任何傻瓜都可以编写计算机可以理解的代码。优秀的程序员编写人类可以理解的代码

*   马丁·福勒

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-17T00:54:28.033

我无法相信有人会认为 150 行的任何东西都比 20 行的东西简单。

使用 20 条线，并按以下方式保护您的同事：

*   记录每个数据结构不变量和每个非平凡循环不变量。记录这些不是在注释中，而是在检查不变量的实际代码中。可以在生产过程中关闭检查。

*   如果您在代码中使用数学公式或在代码中派生，请在注释（或静态字符串）中**包含引用。**理想情况下包括两份参考资料：一份可能会在几秒钟内获得的网络参考资料和一份可能会长期印刷并在大学图书馆中找到的广受好评的教科书。

如果理解你的代码需要特殊的专业知识（理解偏微分方程、物理学学位、伽罗瓦理论，等等），那么为了保护自己，你可能希望去找你的管理人员说“我有这种特殊的专业知识，这使它我可以编写更小的代码（因此更快、更可靠、更易于维护），但是当您必须替换我时，您将不得不雇用具有类似专业知识的人。您希望我做什么？ " 如果你能告诉你的管理层是多么容易获得这样的专业知识，那将会很有帮助。例如，很多拥有工程学位的人可以学习偏微分方程，但伽罗瓦理论家却相当薄弱。

PS这是一个爱好项目的示例评论，以便我以后可以调试自己的代码：

```
/* 
 * Compute the position of a point partially along the geodesic from 
 * pt1.lat,pt1.lon to pt2.lat,pt2.lon
 * 
 * Ref: http://mathworld.wolfram.com/RotationFormula.html
 */ 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-16T23:06:02.107

这实际上取决于复杂的含义。如果你的“简单”算法是 150 行几乎相同的代码，我的眼睛会发呆，我将无法理解它。如果您将这些条件放在矩阵或其他东西中，那么您的代码就是一个读取矩阵并做出决策的循环，即使循环可能不如一堆 if/else 语句“简单”，我也会更好地理解它。

如果基本上你谈论的是一个 Perl 程序，你在一行中做所有事情，大量使用默认变量 $_ 我会说坚持使用更长更详细的版本。

如果有一个公认的公式来做某事，那么您可以使用公认的公式。如果有一个需要 3 或 4 行的简单代数公式，并且有一个需要 1 行的复杂微分方程，则应该使用简单代数公式。在评论中提到的情况下，我认为 PID 算法比 150 行 if/else 代码“简单”。我不认为你使用算法来掩盖任何东西，而是你在问题领域使用标准技术。只要确保很好地评论它，甚至可能包括一个指向描述公式的网页的链接。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-16T21:24:42.170

尽可能复杂，仅此而已。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-16T23:29:25.193

找到通过 100 行 if/else 语句的方法通常（在我看来）比花同样时间理解更好的算法（应该在评论中解释或链接）并最终验证20 行的实现确实执行了那个。它还具有工作教育的好处，这使得它变得更加有趣（从积极的意义上说），并且通常还有更好的执行概况（更少的资源使用）。

您应该避免的聪明之处在于滥用语言而没有实际好处的“聪明的黑客”形式。您应该接受的聪明之处在于始终使用最好的算法来完成这项工作。

*编辑：*关于 PID 示例：我发现很难想象 PID 的功能可以被一堆 if-else 语句合理地替代。if-else 解决方案总是会工作得更糟（不太平滑的过渡），很难维护，也很难调整（调整 PID 部分对于获得所需的行为非常重要）。我想补充一点，理解 PID 并不难，即使你不知道数学，也可以很容易地查到。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-16T21:43:26.237

Python之[禅](http://www.python.org/dev/peps/pep-0020/)很好地解决了这个问题：

> ...
> 
> 简单胜于复杂。
> 
> 复杂胜于复杂。
> 
> ...
> 
> 如果实现很难解释，那就是个坏主意
> 
> ...

换句话说（正如其他人所说），在强加的约束（时间、内存等）下*完成工作的最简单算法是最好的算法。*显然，一个无法完成工作的更简单的算法还不够好。如果你的代码因为使用了复杂的想法而变得更短，那么它就是复杂的。如果没有其他人能够理解您的代码，那么它就很复杂，而且如果您很难向他们解释它（即使他们拥有数学博士学位也能理解），**这是一个坏主意**。

> ...
> 
> 特殊情况不足以打破规则。
> 
> 虽然实用胜过纯洁。
> 
> ...

通常有很多特殊情况代码在其生命周期内潜入最初的“纯”代码。您应该与这种建筑复杂性作斗争，但在必要时接受它。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-16T21:22:03.877

越简单通常越好。请记住，其他人可能有一天必须维护它。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-16T21:22:12.347

以对编写代码的普通程序员来说最容易维护和理解的方式编写代码。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-16T21:37:16.747

有趣的是，代码复杂度最常见的衡量标准之一是嵌套深度。您的“If-then-else”解决方案很可能被自动代码分析器归类为比您的公式化解决方案*更复杂。*

然而，我已经看够了“WTF？” 您描述的编码我通常会采用 if-then-else 方法。但是考虑一下；是否可以使用您更复杂、更公式化的方法，但将特别困难的组件分解为命名良好的方法？如果您可以这样做（甚至可能进行重构以消除冗余），您可能能够避免算法中最糟糕的方面，同时也可以避免多级 if-then-else 结构。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-16T21:25:07.787

不必要的复杂性总是不好的。是的，编写一个完成 200 行功能的出色的单行器可能会很有趣。但请记住，您应该维护代码。简短的复杂代码很难维护。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-16T23:41:33.283

我见过非常优化的代码运行得很慢，而未优化的代码运行得很快，这是因为编译器知道计算机想要如何工作，而编译器编写者首先关注的是易于优化的代码。

可能是您的 150 行算法在运行时编译成比您的 20 行版本快得多的东西。您的 20 行算法最终可能会变慢，因为编译器不知道如何优化它。

我还建议您可能希望将 if-else 版本放在 20 行算法版本上方的注释块中（反之亦然），以便维护人员可以了解您的复杂版本正在尝试做什么。将它们都包含在代码中也可以轻松地对两者进行性能测试（一旦您将它们都输入，就没有理由删除另一个）。这也将允许轻松迁移到其他语言/平台/编译器。您可能没有预料到，但如果代码有效，它可能会存在数十年并看到许多不同的编译器和平台。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-16T23:44:14.540

尝试在您编写完“更复杂”的版本几周后，让其他人对其进行审核。判断您阅读并向他人解释它的难度以及他们对代码的反应的复杂性。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-16T21:36:06.717

使代码更简单的另一个风险是你会陷入一堆普通的编码人员中。您要查找的行是可读/不可读的代码。如果您可以在一周内回来并且仍然可以轻松阅读代码，那么我会说它已经足够简单了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-16T23:38:09.890

如果你能在 20 行上做到这一点，然后正确地评论那些行，我会说去吧。您不仅通过减少需要维护的代码使维护变得更容易，而且还有助于使您的程序员同事变得更聪明。

预优化和巧妙的破解是一回事，但智能算法一直是公平的游戏。

但是让这些算法在它们自己的函数中隔离，并记住解释输入和输出变量！

强制性报价：

> “控制复杂性是计算机编程的本质。” （布赖恩·克尼根）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-28T19:50:10.217

我认为将领域复杂性与底层技术复杂性分开是很重要的。

您希望使用计算机实现的某些特定领域的功能本质上是复杂的，而有些则不然。例如，会计问题充满了奇怪的规则，但大多数计算都相当简单。另一方面，根据类型评估金融证券，可能包括非常复杂的数学公式和大量的模拟。大多数计算机系统实际上只是在收集大量数据，但其中许多系统都有一些底层的复杂算法。

另一方面，技术往往会带来其自身的复杂性。用 C++ 为 PC 编写一个大程序可能是一个挑战。为 Internet 编写基于 Web 的应用程序可能会更糟。试图确保容错性、性能或安全性通常会导致大量增加的复杂性。每种不同的技术都会帮助或阻碍系统。

我们真正想做的，是以最接近其固有领域或技术规范的最简单的形式表达代码。如果您正在编写操作系统，那么 C 是一种更易于使用的语言。如果您正在计算保险的复杂风险概率，那么像 APL 这样的面向矩阵的语言可能更合适。如果您只是创建大量报告，那么最好选择具有面向报告的简单语法的东西。

因此，如果你的 150 行 if/else 内容“匹配”了问题的表达方式，远远好于 20 行巧妙的代码，那么它就是一段更易于维护和消耗的代码。如果您从长远的角度来看，编写运行代码很容易，保持这种方式才是真正的挑战......

保罗。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-16T21:29:09.510

让它变得复杂的风险是没有其他人会理解它。在这种情况下，请清楚地评论它并引用一些有助于其他人学习和理解的资源。

把它简单化的风险是有人不想理解它，因为它很长。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-16T21:32:32.700

我认为问题是 - 复杂的代码更好吗？它更快、更可靠吗？目标是编写最好的程序，如果复杂的代码是最好的解决方案，那么您只需要编写更好的注释，以便您的继任者将来可以管理代码。原则上，代码在任何给定情况下都应该尽可能简单。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-16T23:33:03.987

对我来说，复杂并不一定意味着更多或更少的代码行。

完美的系统从来都不是第一次构建的。 **你所能做的就是尽量不要做出太多复杂的决定，让你以一种方式做事。**

出于这个原因，我喜欢在任何项目的初始版本中保持较低的复杂性。您构建某些东西的原因（新的灵活性）受到了严重影响。如果你让它尽可能复杂，那么一开始就会有更少的人理解它。这可能是好事也可能是坏事。

如果你让它太简单（并且代码增加 50% 到 70%），它可能会出现性能问题。

随着系统的老化和成熟，复杂性似乎是通过重构来实现的。到那时，您可能会达到某些代码可能永远不会再被触及的地步，如果您曾经这样做，由于触摸它的频率较低，了解复杂性的成本将会降低。

我喜欢用简单的步骤解决复杂的问题。在不可能的情况下，复杂性会相应增加。关于知道何时“足够好”的另一个问题有一点。有时，更多的代码（5-20​​%）可以显着抵消复杂性，这可能会让某人重新学习或理解成本更高。

需要一个更好的算法通常是一个好问题，因为这意味着你的东西正在被使用并且有新的需求需要处理。

对我来说，这与适用于数据库抽象的复杂性相同，您必须知道何时使其更灵活，何时保持简单，最好通过构建它来学习，并在编写之前大量废弃它任何东西的单行。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-01-16T23:40:16.390

只有在实际需要速度或空间提升时，复杂的算法才是好的。不要费心编写一个在 O(1) 中运行的花哨的阶乘算法，因为基本上不会使用大约 25 的阶乘。但是，如果代码在最内层循环中，并且此代码中 25% 的加速将使整个应用程序提高 20%，那么就去做吧。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-01-16T21:38:32.563

好吧，如果代码足够大（参见大多数 Java 代码），代码可能会因为数量庞大而变得非常难以理解和维护。如果所有其他（性能等）都相同，并且简单算法和复杂算法之间的长度差异非常大，那么我总是会选择复杂但简洁而优雅的算法，而不是简单但冗长的算法。假设这两种算法都被证明是正确的，那么 if 语句较少且整体代码较少的算法不太可能出现细微的实现错误，因此不太可能需要维护。如果我是一名维护者，我宁愿花时间学习一种新算法，也不愿学习某人如何实现一些可笑的冗长但无聊的算法。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-01-16T21:55:04.870

要看。我不想维护 150 行 if-then-else 语句组成一个函数，尤其是在决策树很密集的情况下。20 行复杂的数学可能会更好，也可能不会更好。理解可能需要时间，但更长的解决方案可能需要更长的时间来验证。

理想情况下，您会找到一种方法，用更少和更简单的行来完成它，但并非所有功能都以这种方式工作。

如果您确实使用了 20 行，请使用保存在注释中的 130 行中的一些来解释您正在使用什么算法。如果你不能很好地解释它，请使用 150 行的解决方案。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-01-23T10:14:46.367

我承认自己了解并喜欢数学和算法，但对我来说，150 行 if/else 的混乱比任何可以用 20 行清晰表达的东西都要复杂和难以维护。正确记录代码并引用论文、书籍或维基百科。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-16T21:26:27.440

它需要尽可能复杂。不能是复杂的，大不同的。

# vb.net - 我可以以编程方式为 DirectCast 命令设置对象类型吗？

> ID：452060
> 
> 赞同：0
> 
> 时间：2009-01-16T21:20:42.303
> 
> 标签：vb.net, casting, directcast

我正在帮助一位同事为他的应用程序的某些控件开发“包罗万象”类型的错误处理程序。他想要做的是传递有错误的对象，以及该对象的类型，例如 TextBox 或 ComboBox，然后在他的处理程序中调用 DirectCast 方法以正确处理其中的 Text 属性。通常，该方法如下所示：

```
Protected Sub SpecialErrorHandler(ByVal TargetControl As Object, ByVal ControlType As String)

   MessageBox.Show("Bad Juice: " & DirectCast(TargetControl, ControlType(ObjType)).Text)

End Sub 
```

到目前为止，任何在 DirectCast 方法中进行类型转换的尝试（因为它需要通用签名中的对象）甚至传递正确设置的 Type 对象都不起作用。

这里有任何想法，或者这是那些“铸造不起作用”中的一个。类型场景？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T21:30:50.207

`DirectCast()`在编译时需要一个真实的类型，所以它知道调用的结果是什么样的。您在这里所能期望的最好的结果是为您期望的每个对象转换为一个通用的基本类型。在这种情况下，您很幸运，因为您有一个相当有用的基本类型： `Control`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:40:25.507

您可以使用反射来提取属性。此外，如果您知道对象始终是 Control，为什么不将其转换为 Control，然后获取控件的 Text 属性呢？

```
Control errorObject = (Control)TargetControl;
MessageBox.Show("Error..."+errorObject.Test)); 
```

（对不起C#代码，对VB不太熟悉，但应该差不多。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T16:14:40.663

请注意，如果没有超类，就像`Control`在这种情况下，您要查找的内容几乎与在运行时才确定类的`Option Strict Off`版本相同。`TargetControl.Text`

# forms - 具有多个同名隐藏控件元素的 HTML 表单

> ID：452066
> 
> 赞同：49
> 
> 时间：2009-01-16T21:22:11.630
> 
> 标签：forms, hidden-field

拥有一个具有多个同名“隐藏”控制元素的 HTML 表单是否合法？我希望在服务器上获得所有这些元素的值。如果合法，各大浏览器是否正确实现了该行为？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-16T21:41:10.653

浏览器没问题。但是，应用程序库如何解析它可能会有所不同。

程序*应该*将同名的项目组合在一起。虽然 HTML 规范没有明确说明这一点，但在[有关 checkboxes 的文档](http://www.w3.org/TR/REC-html40/interact/forms.html#checkbox)中隐含地说明了这一点：

> 一个表单中的多个复选框可以共享相同的控件名称。因此，例如，复选框允许用户为同一属性选择多个值。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-16T21:27:42.787

不同的服务器端技术会有所不同。使用 PHP，您可以对名称使用数组样式的语法来强制在服务器端创建集合。如果发布到服务器，`$_POST['colors']`将是一个包含两个值的数组，`#003366`并且`#00FFFF`：

```
<input type="hidden" name="colors[]" value="#003366" />
<input type="hidden" name="colors[]" value="#00FFFF" /> 
```

一般来说，您需要使用不带方括号的标准*名称。*大多数服务器端技术将能够解析结果数据，并提供某种类型的集合。Node.js 通过以下方式提供有用的功能[`querystring.parse`](https://nodejs.org/api/querystring.html#querystring_querystring_parse_str_sep_eq_options)：

```
const querystring = require('querystring')

querystring.parse('foo=bar&abc=xyz&abc=123') // { foo: 'bar', abc: ['xyz', '123'] } 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-16T21:28:36.733

如果你有这样的事情：

```
<input type="hidden" name="x" value="1" />
<input type="hidden" name="x" value="2" />
<input type="hidden" name="x" value="3" /> 
```

您的查询字符串将看起来像`x=1&x=2&x=3`... 根据您用于解析查询字符串的服务器软件，这可能无法正常工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-16T21:37:35.500

是的，大多数应用程序服务器会收集匹配的元素并用逗号将它们连接起来，这样的形式如下：

```
<html>
<form method="get" action="http://myhost.com/myscript/test.asp">
<input type="hidden" name="myHidden" value="1">
<input type="hidden" name="myHidden" value="2">
<input type="hidden" name="myHidden" value="3">
<input type="submit" value="Submit">
</form>
</html> 
```

... 将解析为一个 URL（在 GET 情况下 - POST 会以相同的方式工作），如下所示：

> [http://myhost.com/myscript.asp?myHidden=1&myHidden=2&myHidden=3](http://myhost.com/myscript.asp?myHidden=1&myHidden=2&myHidden=3)

...并且会以这样的代码向您公开：（例如，遵循类似 Response.Write(Request.QueryString("myHidden")):

1、2、3

因此，要获取这些值，您只需拆分字符串并将它们作为数组（或您选择的任何可比较的语言）访问。

（应该澄清：在 PHP 中，它略有不同（正如 Johnathan 指出的那样，括号表示法将项目作为数组公开给 PHP 代码），但 ASP、ASP.NET 和 ColdFusion 都将值公开为逗号分隔的列表. 所以是的，重复的命名是完全有效的。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-01T21:41:58.383

**HTML5**

非规范部分[4.10.1.3 配置表单以与服务器通信](https://www.w3.org/TR/html5/forms.html#configuring-a-form-to-communicate-with-a-server)明确表示它是有效的：

> 多个控件可以具有相同的名称；例如，这里我们为所有复选框赋予相同的名称，并且服务器通过查看使用该名称提交的值来区分哪个复选框被选中 - 就像单选按钮一样，它们也被赋予具有 value 属性的唯一值。

规范的版本很简单，它在任何地方都没有被禁止，并且表单提交算法准确地说明了应该生成什么请求：

*   没有违反约束：[https ://www.w3.org/TR/html5/forms.html#constraints](https://www.w3.org/TR/html5/forms.html#constraints)
*   多个名称一个接一个地添加到“表单数据集”中：[https ://www.w3.org/TR/html5/forms.html#constructing-form-data-set](https://www.w3.org/TR/html5/forms.html#constructing-form-data-set)
*   像循环“表单数据集”这样的编码`application/x-www-form-urlencoded`并吐出多个`key=val` [https://www.w3.org/TR/html5/forms.html#url-encoded-form-data](https://www.w3.org/TR/html5/forms.html#url-encoded-form-data)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-07-08T15:57:09.480

特别是对于 PHP，我在隐藏输入中使用数组名称进行了一些测试，并在这里分享我的结果：

```
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Post Hidden 2D Arrays</title>
  </head>
  <body>
    <form name="formtest" method="POST" target="_self">
      <input type="hidden" name="elem['name'][]" value="first">
      <input type="hidden" name="elem['name'][]" value="second">
      <input type="hidden" name="elem['name'][]" value="third">
      <input type="hidden" name="elem['name'][]" value="fourth">
      <input type="hidden" name="elem['type'][]" value="normal">
      <input type="hidden" name="elem['type'][]" value="classic">
      <input type="hidden" name="elem['type'][]" value="regular">
      <input type="hidden" name="elem['type'][]" value="basic">
      <input type="hidden" name="elem['size'][]" value="4">
      <input type="hidden" name="elem['size'][]" value="7">
      <input type="hidden" name="elem['size'][]" value="3">
      <input type="hidden" name="elem['size'][]" value="6">
      <input type="hidden" name="elem['form'][]" value="triangle">
      <input type="hidden" name="elem['form'][]" value="square">
      <input type="hidden" name="elem['form'][]" value="hexagon">
      <input type="hidden" name="elem['form'][]" value="circle">
      <input type="submit" name="sendtest" value="Test">
    </form>
    <xmp>
<?php
    print_r($_POST);
?>
    </xmp>
  </body>
</html>
```

提交表单会生成下一个结果：

```
Array
(
[elem] => Array
    (
        ['name'] => Array
            (
                [0] => first
                [1] => second
                [2] => third
                [3] => fourth
            )
        ['type'] => Array
            (
                [0] => normal
                [1] => classic
                [2] => regular
                [3] => basic
            )
        ['size'] => Array
            (
                [0] => 4
                [1] => 7
                [2] => 3
                [3] => 6
            )
        ['temp'] => Array
            (
                [0] => triangle
                [1] => square
                [2] => hexagon
                [3] => circle
            )
    )
[sendtest] => Test
) 
```

查看此结果后，我进行了更多测试，以寻找更好的数组值排列并以此结束（我将仅显示新的隐藏输入）：

```
 <input type="hidden" name="elem[0]['name']" value="first">
    <input type="hidden" name="elem[1]['name']" value="second">
    <input type="hidden" name="elem[2]['name']" value="third">
    <input type="hidden" name="elem[3]['name']" value="fourth">
    <input type="hidden" name="elem[0]['type']" value="normal">
    <input type="hidden" name="elem[1]['type']" value="classic">
    <input type="hidden" name="elem[2]['type']" value="regular">
    <input type="hidden" name="elem[3]['type']" value="basic">
    <input type="hidden" name="elem[0]['size']" value="4">
    <input type="hidden" name="elem[1]['size']" value="7">
    <input type="hidden" name="elem[2]['size']" value="3">
    <input type="hidden" name="elem[3]['size']" value="6">
    <input type="hidden" name="elem[0]['temp']" value="triangle">
    <input type="hidden" name="elem[1]['temp']" value="square">
    <input type="hidden" name="elem[2]['temp']" value="hexagon">
    <input type="hidden" name="elem[3]['temp']" value="circle"> 
```

提交表单后得到这个结果：

```
Array
(
[elem] => Array
    (
        [0] => Array
            (
                ['name'] => first
                ['type'] => normal
                ['size'] => 4
                ['temp'] => triangle
            )
        [1] => Array
            (
                ['name'] => second
                ['type'] => classic
                ['size'] => 7
                ['temp'] => square
            )
        [2] => Array
            (
                ['name'] => third
                ['type'] => regular
                ['size'] => 3
                ['temp'] => hexagon
            )
        [3] => Array
            (
                ['name'] => fourth
                ['type'] => basic
                ['size'] => 6
                ['temp'] => circle
            )
    )
[sendtest] => Test
) 
```

我希望这对一些人有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-12T01:42:15.620

我相信这是合法的，至少在单选按钮和复选框的情况下是这样。当我必须在 XSLT 中动态添加文本框输入时，我给它们都赋予了相同的名称；在 ASP.NET 中，Request.Form["whatever_name"] 是所有这些值以逗号分隔的字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-08T09:46:00.767

我刚刚尝试对几个 SELECT 输入使用相同的控件名称counties[]，以便英格兰、苏格兰、威尔士和爱尔兰的县都作为相同参数的值传递。PHP 处理得很好，但 HTML 验证器会发出警告。我不知道是否所有浏览器都会以同样的方式处理这个问题。

# c# - 使用 Microsoft.SqlServer.Management.Smo 从 StoredProc 获取结果列而不执行它

> ID：452071
> 
> 赞同：4
> 
> 时间：2009-01-16T21:23:32.283
> 
> 标签：c#, .net, sql, sql-server, sql-server-2005

我想获得我可以从 SP 获得的结果集和列的列表。我已经能够获得参数、脚本......但我不知道从哪里获得结果集和列名。

```
using Microsoft.SqlServer.Management.Smo;

using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["mydbconn"].ConnectionString))
        {
            conn.Open();
            Server sv = new Server(new Microsoft.SqlServer.Management.Common.ServerConnection(conn));
            Database db = sv.Databases["mydb"];

            foreach (StoredProcedure sp in db.StoredProcedures)
            {
                string[] columns = sp.??????
            }

        } 
```

有没有办法到达列？我最终试图编写一个代码生成器来自动化我编写数据访问对象。谢谢！

编辑：“另一个解决方案是，如果您可以获得 ScalarResult 的值，您可以将其转换为有用的东西，您可以从中派生列。” : 任何想法如何得到？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T21:27:28.187

这是一个众所周知的困难领域。一些系统通过在启用的情况下执行存储过程来尝试这样做`SET FMTONLY ON`，但这有一系列问题（即它仍然会执行一些代码，这可能很糟糕）。众所周知，获取非平凡查询的模式也很困难（例如，不同的分支执行不同的选择）。

如果您**知道**这些程序是无副作用的，并且不在`SELECT`分支中，那么请尝试这个`SET FMTONLY ON`技巧 - 但至少了解可能的影响。

对于查询，在某些方面表值函数 (UDF) 可能更实用，因为模式是形式化的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T21:49:05.227

浏览 MSDN 上的 StoredProcedure 成员页面 ( [http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.storedprocedure_members.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.storedprocedure_members.aspx) ) 后，我看到了两种可能的解决方案。

一，您可以使用 GetTextBody 获取存储过程的实际脚本。之后，您可以以某种方式解析存储过程。假设它们是由您或您的开发团队成员（假设您有一个）创建并且可以修改的，那么这可能会更容易一些。如果不是，那么它会变得非常混乱，非常快并且不会 100% ......所以我真的不建议这样做。

另一种解决方案是，如果您可以获取 ScalarResult 的值，则可以将其转换为有用的东西，您可以从中派生列。

编辑：如果您只想获取 SP 的参数，那将相对容易。有（根据上一个链接）您可以访问一个名为 Parameters 的集合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T20:07:17.410

我知道马克很久以前就回答了这个问题。但是随着 Visual Studio 11 的出现，SMO 也有了很大的发展。

SMO 中的每个 StoredProcedure 对象现在都有一个称为参数的列表。

来自 MSDN：

> 参数 表示 StoredProcedureParameterCollection 对象的集合。每个 StoredProcedureParameter 对象代表一个为存储过程定义的参数。

[MSDN 链接在这里](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.storedprocedure.parameters.aspx)

谢谢并恭祝安康

加根

# python - 使用reportlab在PDF文件中创建渐变填充

> ID：452074
> 
> 赞同：12
> 
> 时间：2009-01-16T21:24:12.873
> 
> 标签：python, pdf, gradient, reportlab

[是否可以使用ReportLab](http://www.reportlab.org/) (python)在 PDF 中创建渐变填充？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-13T13:43:04.843

ReportLab 现在支持 PDF 渐变。

2012 年 8 月 6 日，Peter Johnson将一个梯度支持补丁[发布到 ReportLab 邮件列表](http://two.pairlist.net/pipermail/reportlab-users/2012-August/010465.html)，并在第二天[添加到源中。](https://bitbucket.org/rptlab/reportlab/commits/494980a689ff55a8457f30b6ca4fbdf80aa2828e)我无法在[ReportLab 2.6 的发行说明中](http://www.reportlab.com/software/documentation/relnotes/26/)发现任何内容，但自从 2012 年 10 月 1 日发布以来，它大概就在那里。它肯定存在于 2.7 中。

可以指定具有多个停止的线性和径向渐变。在文档中搜索术语*梯度*并没有发现任何东西。但是，[第一个版本补丁的消息](http://two.pairlist.net/pipermail/reportlab-users/2012-August/010459.html)有几个示例，这些示例是[ReportLab 源代码中一些测试](https://bitbucket.org/rptlab/reportlab/src/0a60388157ba061f3ef37436b0b60bb545bd5589/tests/test_pdfgen_general.py?at=default#cl-876)的基础。基于此，我编写了一个快速演示脚本：

```
from reportlab.pdfgen.canvas import Canvas
from reportlab.lib.colors import red, yellow, green
from reportlab.lib.units import mm

c = Canvas("gradient.pdf")

# Linear gradient with the endpoints extending over the page.
c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow))
c.drawString(5*mm, 290*mm, "c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow))")
c.line(105*mm, 200*mm, 180*mm, 100*mm)
c.showPage()

# Linear gradient constrained within the endpoints.
c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow), extend=False)
c.drawString(5*mm, 290*mm, "c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow), extend=False)")
c.line(105*mm, 200*mm, 180*mm, 100*mm)
c.showPage()

# Linear gradient with multiple stops.
c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow, green), (0, 0.8, 1), extend=False)
c.drawString(5*mm, 290*mm, "c.linearGradient(105*mm, 200*mm, 180*mm, 100*mm, (red, yellow, green), (0, 0.8, 1), extend=False)")
c.line(105*mm, 200*mm, 180*mm, 100*mm)
c.line(141*mm, 102*mm, 189*mm, 138*mm)
c.showPage()

# Radial gradient with the endpoint extending over the page.
c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow))
c.drawString(5*mm, 290*mm, "c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow))")
c.circle(105*mm, 200*mm, 60*mm)
c.showPage()

# Radial gradient constrained within the circle.
c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow), extend=False)
c.drawString(5*mm, 290*mm, "c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow), extend=False)")
c.circle(105*mm, 200*mm, 60*mm)
c.showPage()

# Radial gradient with multiple stops.
c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow, green), (0, 0.8, 1))
c.drawString(5*mm, 290*mm, "c.radialGradient(105*mm, 200*mm, 60*mm, (red, yellow, green), (0, 0.8, 1))")
c.circle(105*mm, 200*mm, 48*mm)
c.circle(105*mm, 200*mm, 60*mm)
c.showPage()

c.save() 
```

这将输出六个页面，其中包含各种渐变以及渐变方法调用和显示端点和停止位置的线条/圆圈：

![在页面上延伸的基本线性渐变](https://i.stack.imgur.com/35oABm.png) ![限制在端点内的线性梯度](https://i.stack.imgur.com/HZTSRm.png) ![具有多个停靠点的线性渐变](https://i.stack.imgur.com/J7xcam.png) ![在页面上延伸的基本径向渐变](https://i.stack.imgur.com/HyoL4m.png) ![径向梯度限制在半径内](https://i.stack.imgur.com/Nn2zqm.png) ![具有多个停靠点的径向渐变](https://i.stack.imgur.com/nwIIIm.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-09T21:21:49.817

**[我的答案不再正确，Reportlab 中现在可以使用渐变，有关详细信息，请参阅此页面上的其他答案。]**

很抱歉重新提出这个问题，但我偶然发现它并没有得到正确的回答。

答案是否定的，截至今天，当前版本的 ReportLab 不支持渐变。然而，PDF 支持渐变。如果您查看 ReportLab 的 Canvas 类，您会发现它的许多方法都是围绕底层 PDF 代码生成的相对较小的包装器。要在 RL 中访问渐变，您需要扩展 Canvas 类并添加其他方法来生成正确的 PDF 代码。这是可行的，但显然不是微不足道的，这意味着您必须阅读 PDF 规范。

有两种选择。首先将渐变生成为光栅图像并使用它，其次通过绘制一系列不同颜色的矩形来生成渐变。

```
start_color = (1,0,0)
end_color = (0,1,0)
for i in range(100):
    p = i * 0.01
    canvas.setFillColorRGB(*[start_color[i]*(1.0-p)+end_color[i]*p for i in range(3)])
    canvas.rect(i, 0, 2, 100) 
```

例如。不幸的是，让渐变平滑需要很多矩形，这会导致 PDF 很大并且渲染缓慢。你最好使用光栅方法。

最后，您可能会考虑使用 PyCairo。这对许多图形元素有更好的支持，并且可以呈现为 PDF 或 PNG。但是，它缺少 reportlabs 更高级别的结构（例如页面布局）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-12T14:58:32.143

您想用渐变而不是纯色填充矩形（或其他路径）？

没问题。使用剪辑将渐变绑定/限制到路径。请记住在设置渐变*之前设置剪辑路径。*（并将其包裹在`saveState()`/`restoreState()`之后重置剪辑和渐变。）

```
c = canvas.Canvas (filename)
#c.translate (8*cm, 8*cm)  # use this to move the rectangle
p = c.beginPath()
p.rect (0,0 , 5*cm,5*cm)
c.clipPath (p, stroke=0)
c.linearGradient (0,0 , 5*cm, 5*cm , (red, yellow)) 
```

`extend`对于径向渐变，将关键字参数设置为 可能就足够了`False`。

# css - ASP.NET MVC 控件和 CSS

> ID：452075
> 
> 赞同：2
> 
> 时间：2009-01-16T21:24:15.713
> 
> 标签：css, asp.net-mvc

我正在尝试使用常规的 html 选择列表 css 在我的 html.dropdownlist 上应用 css。谁能告诉我如何去做这件事以及我在哪里做错了

这就是我现在所拥有的..

```
<div id="container">
   Months &nbsp; <%=Html.DropDownList("dllMonths", new SelectList(new List<string>() { "January", 
    "Feburary", "March", "April", "June", "July", "August", "September", "October", "November", "December"}, ViewData["Month"]), new { onchange = "this.form.submit();" })%>

    Events &nbsp;<%=Html.DropDownList("dllEvents", new SelectList(new List<string>() { "Camp Events", 
    "Weekly Events", "All Events"}, ViewData["Event"]), new { onchange = "this.form.submit();" })%>

</div> 
```

这是我试图应用的 css [http://www.emblematiq.com/projects/niceforms/demo/](http://www.emblematiq.com/projects/niceforms/demo/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T21:37:24.673

您使用匿名对象设置 html 属性的代码部分，将其更改为：

```
new { onchange = "this.form.submit();", @class="selectlist" } 
```

@ 符号允许您使用作为保留字的属性名称。如果你想要内联样式，你也可以添加 style="" （但你可能不需要）。

此外，您不需要新建 SelectList，Html.DropDownList() 上有一个重载，可让您传递相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:52:22.723

在我看来，您需要的只是包含在您的站点管理员的头部中。这两个条目：-

```
<script language="javascript" type="text/javascript" src="../../Scripts/niceforms.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="../../Content/niceforms-default.css" /> 
```

然后在代码所在的表单元素上放置属性`class="niceform"`。

当然，这假设您使用标准的内容文件夹来存储 css 和 Scripts 文件夹来存储 JS 文件。

除非您使用的是 Html.BeginForm，否则我在这里看不到特定的 MVC 问题。
在这种情况下，您需要：-

```
Html.BeginForm("action", "controller", FormMethod.Post, new {@class="niceform"}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T21:54:08.617

嘿，如果有人需要知道以供将来参考..我就是这样做的..

```
%using (Html.BeginForm("Calendar", "Calendar", FormMethod.Post, new { @class = "niceform" }))
  { %>
<div id="container">
   Months &nbsp; <%=Html.DropDownList("dllMonths", new SelectList(new List<string>() { "January", 
    "Feburary", "March", "April", "June", "July", "August", "September", "October", "November", "December"}, ViewData["Month"]), new { onchange = "this.form.submit();", @class = "width_320" })%>

    Events &nbsp;<%=Html.DropDownList("dllEvents", new SelectList(new List<string>() { "Camp Events", 
    "Weekly Events", "All Events"}, ViewData["Event"]), new { onchange = "this.form.submit();", @class = "width_320" })%>
    &nbsp;<%=Html.SubmitImage("SearchAll", "~/imagens/imgsearch.jpg")%>
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-10T23:52:54.843

请参考这篇文章，如何将 css 类应用到 MVC 下拉列表中：

[http://www.altafkhatri.com/Technical/Assign_css_class_to_MVC_dropdownlist](http://www.altafkhatri.com/Technical/Assign_css_class_to_MVC_dropdownlist)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-15T18:49:42.513

```
 @Html.DropDownList("ddl-id", Model.SomeListForDDl, new {@class="className"}) 
```

# .net - 在 .Net 中设置屏幕分辨率

> ID：452076
> 
> 赞同：3
> 
> 时间：2009-01-16T21:24:23.793
> 
> 标签：.net, pinvoke, screen

有谁知道是否有任何托管包装库允许我设置屏幕分辨率，这样我就不必自己做 p/invoke 的事情了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T21:30:48.850

这是一个看起来可能有用的帖子：[http ://dotnet.mvps.org/dotnet/faqs/?id=setscreenresolution&lang=en](http://dotnet.mvps.org/dotnet/faqs/?id=setscreenresolution&lang=en)

这是来自[代码项目的第二个示例](http://www.codeproject.com/KB/cs/csdynamicscrres.aspx)

# ruby-on-rails - 将 Rails 应用程序与慢速 Web 服务集成的最佳方法

> ID：452081
> 
> 赞同：1
> 
> 时间：2009-01-16T21:25:35.880
> 
> 标签：ruby-on-rails, ruby, web-services, soap

我需要在 Rails 应用程序中实现 Web 客户端。现有的 Web 服务是 SOAP，通常需要几秒钟来响应请求。使用 SOAP4R，请求阻塞。

直接从 Rails 控制器调用这些阻塞方法是否可以接受？如果不是，rails 控制器是否应该使用一个单独的服务来缓冲命令，该服务将处理 SOAP 命令和回复。还有第三种更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:44:17.233

这取决于——它们是否需要实时处理（例如，当用户点击 GO 时它应该实际触发？）。如果您使用的是 mongrel，请记住，任何正在做“某事”的 mongrel 都会阻塞，从并发的角度来看这是很严重的（除非您周围有大量的 mongrel）。如果您正在使用乘客，那么如果您也打开了备用乘客实例，那么长时间运行的控制器操作的命中并不是什么大问题。

对于可以带外发生的事情（并且有一些延迟，例如报告处理或视频转换），我有一个名为“JOBS”的模型，然后使用脚本/运行程序（与 cron 结合）调用 Jobs.process_jobs一会儿。

或者，您可以创建一个小脚本并将其放入 script/yourscript 并每隔几分钟调用一次。

还有第三种选择，使用 drb 进程，但是——根据我的经验——我发现它比简单地每隔几分钟触发一次 cron （甚至只是让控制器动作触发）更“移动部分”所以我倾向于避免它，除非我真的需要（例如雪貂）。

# python - 值得使用 Python 的 re.compile 吗？

> ID：452104
> 
> 赞同：565
> 
> 时间：2009-01-16T21:31:57.617
> 
> 标签：python, regex

在 Python 中对正则表达式使用 compile 有什么好处吗？

```
h = re.compile('hello')
h.match('hello world') 
```

对比

```
re.match('hello', 'hello world') 
```

* * *

## 回答 #1

> 赞同：504
> 
> 时间：2009-01-16T21:42:57.920

我有很多运行编译正则表达式 1000 次而不是即时编译的经验，并且没有注意到任何可察觉的差异。显然，这是轶事，当然不是*反对*编译的好论据，但我发现差异可以忽略不计。

编辑：在快速浏览了实际的 Python 2.5 库代码后，我发现无论何时使用 Python 都会在内部编译并缓存正则表达式（包括`re.match()`调用根本不会节省很多时间 - 只是检查缓存所需的时间（内部`dict`类型的键查找）。

从模块 re.py （评论是我的）：

```
def match(pattern, string, flags=0):
    return _compile(pattern, flags).match(string)

def _compile(*key):

    # Does cache check at top of function
    cachekey = (type(key[0]),) + key
    p = _cache.get(cachekey)
    if p is not None: return p

    # ...
    # Does actual compilation on cache miss
    # ...

    # Caches compiled regex
    if len(_cache) >= _MAXCACHE:
        _cache.clear()
    _cache[cachekey] = p
    return p 
```

我仍然经常预编译正则表达式，但只是为了将它们绑定到一个漂亮的、可重用的名称，而不是为了任何预期的性能提升。

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2009-01-17T16:49:07.670

对我来说，最大的好处`re.compile`是能够将正则表达式的定义与其使用分开。

即使是一个简单的表达式，例如`0|[1-9][0-9]*`(integer in base 10 withoutleading zeros) 也可能足够复杂，以至于您不必重新输入它，检查是否有任何拼写错误，然后在开始调试时重新检查是否有拼写错误. 另外，使用 num 或 num_b10 之类的变量名比使用`0|[1-9][0-9]*`.

当然可以存储字符串并将它们传递给 re.match; 但是，这*不太*可读：

```
num = "..."
# then, much later:
m = re.match(num, input) 
```

与编译相比：

```
num = re.compile("...")
# then, much later:
m = num.match(input) 
```

尽管它相当接近，但在重复使用时，第二行的最后一行感觉更自然和简单。

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2009-01-16T21:42:37.627

FWIW：

```
$ python -m timeit -s "import re" "re.match('hello', 'hello world')"
100000 loops, best of 3: 3.82 usec per loop

$ python -m timeit -s "import re; h=re.compile('hello')" "h.match('hello world')"
1000000 loops, best of 3: 1.26 usec per loop 
```

因此，如果您要经常使用*相同*的正则表达式，那么这样做可能是值得的`re.compile`（尤其是对于更复杂的正则表达式）。

`re.compile`反对过早优化的标准论点适用，但如果您怀疑您的正则表达式可能成为性能瓶颈，我认为您不会真正失去太多的清晰度/直截了当。

**更新：**

在 Python 3.6（我怀疑上述时间是使用 Python 2.x）和 2018 硬件（MacBook Pro）下，我现在得到以下时间：

```
% python -m timeit -s "import re" "re.match('hello', 'hello world')"
1000000 loops, best of 3: 0.661 usec per loop

% python -m timeit -s "import re; h=re.compile('hello')" "h.match('hello world')"
1000000 loops, best of 3: 0.285 usec per loop

% python -m timeit -s "import re" "h=re.compile('hello'); h.match('hello world')"
1000000 loops, best of 3: 0.65 usec per loop

% python --version
Python 3.6.5 :: Anaconda, Inc. 
```

我还添加了一个案例（注意最后两次运行之间的引号差异），它显示`re.match(x, ...)`字面上 [大致] 等同于`re.compile(x).match(...)`，即似乎没有发生编译表示的幕后缓存。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2012-11-30T07:24:30.053

这是一个简单的测试用例：

```
~$ for x in 1 10 100 1000 10000 100000 1000000; do python -m timeit -n $x -s 'import re' 're.match("[0-9]{3}-[0-9]{3}-[0-9]{4}", "123-123-1234")'; done
1 loops, best of 3: 3.1 usec per loop
10 loops, best of 3: 2.41 usec per loop
100 loops, best of 3: 2.24 usec per loop
1000 loops, best of 3: 2.21 usec per loop
10000 loops, best of 3: 2.23 usec per loop
100000 loops, best of 3: 2.24 usec per loop
1000000 loops, best of 3: 2.31 usec per loop 
```

重新编译：

```
~$ for x in 1 10 100 1000 10000 100000 1000000; do python -m timeit -n $x -s 'import re' 'r = re.compile("[0-9]{3}-[0-9]{3}-[0-9]{4}")' 'r.match("123-123-1234")'; done
1 loops, best of 3: 1.91 usec per loop
10 loops, best of 3: 0.691 usec per loop
100 loops, best of 3: 0.701 usec per loop
1000 loops, best of 3: 0.684 usec per loop
10000 loops, best of 3: 0.682 usec per loop
100000 loops, best of 3: 0.694 usec per loop
1000000 loops, best of 3: 0.702 usec per loop 
```

*因此，即使您只匹配一次*，这种简单案例的编译速度似乎也更快。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2010-04-14T04:40:24.393

我自己试过这个。对于从字符串中解析数字并将其求和的简单情况，使用编译的正则表达式对象的速度大约是使用方法的两倍`re`。

正如其他人指出的那样，这些`re`方法（包括`re.compile`）在先前编译的表达式的缓存中查找正则表达式字符串。因此，在正常情况下，使用这些`re`方法的额外成本只是缓存查找的成本。

但是，检查[代码](http://www.google.com/codesearch/p?hl=en#1IKf2ZWr9OM/tools/third_party/python_26/Lib/re.py&q=lang:python%20re.py&sa=N&cd=4&ct=rc)，显示缓存仅限于 100 个表达式。这就引出了一个问题，缓存溢出有多痛苦？该代码包含正则表达式编译器的内部接口，`re.sre_compile.compile`. 如果我们调用它，我们会绕过缓存。事实证明，对于基本正则表达式（例如`r'\w+\s+([0-9_]+)\s+\w*'`.

这是我的测试：

```
#!/usr/bin/env python
import re
import time

def timed(func):
    def wrapper(*args):
        t = time.time()
        result = func(*args)
        t = time.time() - t
        print '%s took %.3f seconds.' % (func.func_name, t)
        return result
    return wrapper

regularExpression = r'\w+\s+([0-9_]+)\s+\w*'
testString = "average    2 never"

@timed
def noncompiled():
    a = 0
    for x in xrange(1000000):
        m = re.match(regularExpression, testString)
        a += int(m.group(1))
    return a

@timed
def compiled():
    a = 0
    rgx = re.compile(regularExpression)
    for x in xrange(1000000):
        m = rgx.match(testString)
        a += int(m.group(1))
    return a

@timed
def reallyCompiled():
    a = 0
    rgx = re.sre_compile.compile(regularExpression)
    for x in xrange(1000000):
        m = rgx.match(testString)
        a += int(m.group(1))
    return a

@timed
def compiledInLoop():
    a = 0
    for x in xrange(1000000):
        rgx = re.compile(regularExpression)
        m = rgx.match(testString)
        a += int(m.group(1))
    return a

@timed
def reallyCompiledInLoop():
    a = 0
    for x in xrange(10000):
        rgx = re.sre_compile.compile(regularExpression)
        m = rgx.match(testString)
        a += int(m.group(1))
    return a

r1 = noncompiled()
r2 = compiled()
r3 = reallyCompiled()
r4 = compiledInLoop()
r5 = reallyCompiledInLoop()
print "r1 = ", r1
print "r2 = ", r2
print "r3 = ", r3
print "r4 = ", r4
print "r5 = ", r5
</pre>
And here is the output on my machine:
<pre>
$ regexTest.py 
noncompiled took 4.555 seconds.
compiled took 2.323 seconds.
reallyCompiled took 2.325 seconds.
compiledInLoop took 4.620 seconds.
reallyCompiledInLoop took 4.074 seconds.
r1 =  2000000
r2 =  2000000
r3 =  2000000
r4 =  2000000
r5 =  20000 
```

'reallyCompiled' 方法使用绕过缓存的内部接口。请注意，在每次循环迭代中编译的版本仅迭代 10,000 次，而不是 100 万次。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-07-29T16:55:09.937

我同意 Honest Abe 的观点，即`match(...)`在给定的例子中是不同的。它们不是一对一的比较，因此结果各不相同。为了简化我的回答，我对那些有问题的函数使用 A、B、C、D。哦，是的，我们正在处理 4 个函数`re.py`而不是 3 个。

运行这段代码：

```
h = re.compile('hello')                   # (A)
h.match('hello world')                    # (B) 
```

与运行此代码相同：

```
re.match('hello', 'hello world')          # (C) 
```

因为，当查看 source 时`re.py`， (A + B) 意味着：

```
h = re._compile('hello')                  # (D)
h.match('hello world') 
```

(C) 实际上是：

```
re._compile('hello').match('hello world') 
```

因此，（C）与（B）不同。事实上，(C) 在调用 (D) 之后调用 (B)，这也被 (A) 调用。换句话说，`(C) = (A) + (B)`. 因此，在循环内比较 (A + B) 与在循环内比较 (C) 具有相同的结果。

乔治`regexTest.py`为我们证明了这一点。

```
noncompiled took 4.555 seconds.           # (C) in a loop
compiledInLoop took 4.620 seconds.        # (A + B) in a loop
compiled took 2.323 seconds.              # (A) once + (B) in a loop 
```

大家的兴趣是，2.323秒的结果如何得到。为了确保`compile(...)`只被调用一次，我们需要将编译后的正则表达式对象存储在内存中。如果我们使用一个类，我们可以存储对象并在每次调用函数时重用。

```
class Foo:
    regex = re.compile('hello')
    def my_function(text)
        return regex.match(text) 
```

如果我们不使用课程（这是我今天的要求），那么我没有意见。我还在学习在 Python 中使用全局变量，我知道全局变量是一件坏事。

还有一点，我相信使用`(A) + (B)`方法有优势。以下是我观察到的一些事实（如果我错了，请纠正我）：

1.  调用 A 一次，它将在`_cache`后面进行一次搜索`sre_compile.compile()`以创建一个正则表达式对象。调用 A 两次，它将进行两次搜索和一次编译（因为缓存了正则表达式对象）。

2.  如果`_cache`在两者之间刷新，则正则表达式对象将从内存中释放，Python 需要再次编译。（有人建议 Python 不会重新编译。）

3.  如果我们使用 (A) 保留 regex 对象，regex 对象仍将进入 _cache 并以某种方式被刷新。但是我们的代码在它上面保留了一个引用，并且正则表达式对象不会从内存中释放出来。那些，Python 不需要再次编译。

4.  George 的测试编译循环与编译的 2 秒差异主要是构建 key 和搜索 _cache 所需的时间。这并不意味着正则表达式的编译时间。

5.  George 的真正编译测试表明，如果它真的每次都重新编译会发生什么：它会慢 100 倍（他将循环从 1,000,000 减少到 10,000）。

以下是（A + B）优于（C）的唯一情况：

1.  如果我们可以在类中缓存正则表达式对象的引用。
2.  如果我们需要重复调​​用（B）（在循环内或多次），我们必须在循环外缓存对正则表达式对象的引用。

（C）足够好的情况：

1.  我们无法缓存引用。
2.  我们只偶尔使用一次。
3.  总的来说，我们没有太多的正则表达式（假设编译过的永远不会被刷新）

只是一个回顾，这里是ABC：

```
h = re.compile('hello')                   # (A)
h.match('hello world')                    # (B)
re.match('hello', 'hello world')          # (C) 
```

谢谢阅读。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2020-05-04T23:30:30.913

这是一个示例，根据[要求](https://stackoverflow.com/questions/452104/is-it-worth-using-pythons-re-compile#comment108948583_452104)`re.compile`，使用速度提高了 50 倍以上。

这一点与我在上面的评论中所做的相同，即`re.compile`当您的使用无法从编译缓存中受益时，使用可能是一个显着的优势。这至少发生在一种特殊情况下（我在实践中遇到过），即当以下所有情况都成立时：

*   您有很多正则表达式模式（超过`re._MAXCACHE`，其[默认](https://github.com/python/cpython/blob/9d74658f0a6e8a9b8d6dcf199dda886f35c6ad68/Lib/re.py#L288)值当前为 512），并且
*   您多次使用这些正则表达式，并且
*   您对同一模式的连续使用之间的分隔比`re._MAXCACHE`其他正则表达式要多，因此每个正则表达式都会在连续使用之间从缓存中刷新。

```
import re
import time

def setup(N=1000):
    # Patterns 'a.*a', 'a.*b', ..., 'z.*z'
    patterns = [chr(i) + '.*' + chr(j)
                    for i in range(ord('a'), ord('z') + 1)
                    for j in range(ord('a'), ord('z') + 1)]
    # If this assertion below fails, just add more (distinct) patterns.
    # assert(re._MAXCACHE < len(patterns))
    # N strings. Increase N for larger effect.
    strings = ['abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz'] * N
    return (patterns, strings)

def without_compile():
    print('Without re.compile:')
    patterns, strings = setup()
    print('searching')
    count = 0
    for s in strings:
        for pat in patterns:
            count += bool(re.search(pat, s))
    return count

def without_compile_cache_friendly():
    print('Without re.compile, cache-friendly order:')
    patterns, strings = setup()
    print('searching')
    count = 0
    for pat in patterns:
        for s in strings:
            count += bool(re.search(pat, s))
    return count

def with_compile():
    print('With re.compile:')
    patterns, strings = setup()
    print('compiling')
    compiled = [re.compile(pattern) for pattern in patterns]
    print('searching')
    count = 0
    for s in strings:
        for regex in compiled:
            count += bool(regex.search(s))
    return count

start = time.time()
print(with_compile())
d1 = time.time() - start
print(f'-- That took {d1:.2f} seconds.\n')

start = time.time()
print(without_compile_cache_friendly())
d2 = time.time() - start
print(f'-- That took {d2:.2f} seconds.\n')

start = time.time()
print(without_compile())
d3 = time.time() - start
print(f'-- That took {d3:.2f} seconds.\n')

print(f'Ratio: {d3/d1:.2f}') 
```

我在笔记本电脑上获得的示例输出（Python 3.7.7）：

```
With re.compile:
compiling
searching
676000
-- That took 0.33 seconds.

Without re.compile, cache-friendly order:
searching
676000
-- That took 0.67 seconds.

Without re.compile:
searching
676000
-- That took 23.54 seconds.

Ratio: 70.89 
```

我没有打扰，`timeit`因为差异是如此明显，但我每次都得到质量相似的数字。请注意，即使没有`re.compile`，多次使用相同的正则表达式并继续使用下一个也不是那么糟糕（仅比使用 慢 2 倍左右`re.compile`），但是以另一种顺序（循环通过许多正则表达式），它明显更糟，正如预期的那样。此外，增加缓存大小也很有效：只需`re._MAXCACHE = len(patterns)`在`setup()`上面设置（当然我不建议在生产中做这样的事情，因为带有下划线的名称通常是“私有的”）将 ~23 秒降低到 ~0.7 秒，这也符合我们的理解。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-02-21T07:16:00.130

大多数情况下，是否使用*re.compile*几乎没有区别。在内部，所有功能都是根据编译步骤实现的：

```
def match(pattern, string, flags=0):
    return _compile(pattern, flags).match(string)

def fullmatch(pattern, string, flags=0):
    return _compile(pattern, flags).fullmatch(string)

def search(pattern, string, flags=0):
    return _compile(pattern, flags).search(string)

def sub(pattern, repl, string, count=0, flags=0):
    return _compile(pattern, flags).sub(repl, string, count)

def subn(pattern, repl, string, count=0, flags=0):
    return _compile(pattern, flags).subn(repl, string, count)

def split(pattern, string, maxsplit=0, flags=0):
    return _compile(pattern, flags).split(string, maxsplit)

def findall(pattern, string, flags=0):
    return _compile(pattern, flags).findall(string)

def finditer(pattern, string, flags=0):
    return _compile(pattern, flags).finditer(string) 
```

此外， re.compile() 绕过了额外的间接和缓存逻辑：

```
_cache = {}

_pattern_type = type(sre_compile.compile("", 0))

_MAXCACHE = 512
def _compile(pattern, flags):
    # internal: compile pattern
    try:
        p, loc = _cache[type(pattern), pattern, flags]
        if loc is None or loc == _locale.setlocale(_locale.LC_CTYPE):
            return p
    except KeyError:
        pass
    if isinstance(pattern, _pattern_type):
        if flags:
            raise ValueError(
                "cannot process flags argument with a compiled pattern")
        return pattern
    if not sre_compile.isstring(pattern):
        raise TypeError("first argument must be string or compiled pattern")
    p = sre_compile.compile(pattern, flags)
    if not (flags & DEBUG):
        if len(_cache) >= _MAXCACHE:
            _cache.clear()
        if p.flags & LOCALE:
            if not _locale:
                return p
            loc = _locale.setlocale(_locale.LC_CTYPE)
        else:
            loc = None
        _cache[type(pattern), pattern, flags] = p, loc
    return p 
```

除了使用*re.compile*带来的小速度优势之外，人们还喜欢命名潜在复杂的模式规范并将它们与应用的业务逻辑分离所带来的可读性：

```
#### Patterns ############################################################
number_pattern = re.compile(r'\d+(\.\d*)?')    # Integer or decimal number
assign_pattern = re.compile(r':=')             # Assignment operator
identifier_pattern = re.compile(r'[A-Za-z]+')  # Identifiers
whitespace_pattern = re.compile(r'[\t ]+')     # Spaces and tabs

#### Applications ########################################################

if whitespace_pattern.match(s): business_logic_rule_1()
if assign_pattern.match(s): business_logic_rule_2() 
```

请注意，另一位受访者错误地认为*pyc*文件直接存储编译模式；然而，实际上，每次加载 PYC 时它们都会重新构建：

```
>>> from dis import dis
>>> with open('tmp.pyc', 'rb') as f:
        f.read(8)
        dis(marshal.load(f))

  1           0 LOAD_CONST               0 (-1)
              3 LOAD_CONST               1 (None)
              6 IMPORT_NAME              0 (re)
              9 STORE_NAME               0 (re)

  3          12 LOAD_NAME                0 (re)
             15 LOAD_ATTR                1 (compile)
             18 LOAD_CONST               2 ('[aeiou]{2,5}')
             21 CALL_FUNCTION            1
             24 STORE_NAME               2 (lc_vowels)
             27 LOAD_CONST               1 (None)
             30 RETURN_VALUE 
```

上面的反汇编来自 PYC 文件，其中`tmp.py`包含：

```
import re
lc_vowels = re.compile(r'[aeiou]{2,5}') 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-03-20T03:39:09.557

使用 re.compile() 还有一个额外的好处，就是使用 re.VERBOSE 向我的正则表达式模式添加注释

```
pattern = '''
hello[ ]world    # Some info on my pattern logic. [ ] to recognize space
'''

re.search(pattern, 'hello world', re.VERBOSE) 
```

虽然这不会影响运行代码的速度，但我喜欢这样做，因为这是我评论习惯的一部分。当我想要进行修改时，我完全不喜欢花时间试图记住我的代码背后的逻辑 2 个月。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-03-21T15:36:10.920

根据 Python[文档](https://docs.python.org/2/library/re.html)：

序列

```
prog = re.compile(pattern)
result = prog.match(string) 
```

相当于

```
result = re.match(pattern, string) 
```

但是`re.compile()`，当表达式将在单个程序中多次使用时，使用并保存生成的正则表达式对象以供重用会更有效。

所以我的结论是，如果你要为许多不同的文本匹配相同的模式，你最好预编译它。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-03-18T22:13:45.850

一般来说，我发现使用标志更容易（至少更容易记住如何），例如`re.I`在编译模式时比使用内联标志。

```
>>> foo_pat = re.compile('foo',re.I)
>>> foo_pat.findall('some string FoO bar')
['FoO'] 
```

对比

```
>>> re.findall('(?i)foo','some string FoO bar')
['FoO'] 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-03-10T23:03:59.430

使用给定的示例：

```
h = re.compile('hello')
h.match('hello world') 
```

上例中的*匹配*方法与下面使用的不一样：

```
re.match('hello', 'hello world') 
```

[re.compile()](http://docs.python.org/3.3/library/re.html?highlight=re.sub#re.compile)返回一个[正则表达式 object](http://docs.python.org/3.3/library/re.html?highlight=re.sub#regular-expression-objects)，这意味着`h`是一个正则表达式对象。

regex 对象有自己的[*match*](http://docs.python.org/3.3/library/re.html?highlight=re.sub#re.regex.match)方法，带有可选的*pos*和*endpos*参数：

[`regex.match(string[, pos[, endpos]])`](http://docs.python.org/3.3/library/re.html?highlight=re.sub#re.regex.match)

**位置**

> 可选的第二个参数*pos*给出了搜索开始的字符串中的索引；它默认为 0。这并不完全等同于对字符串进行切片；模式字符在`'^'`字符串的真正开头和换行符之后的位置匹配，但不一定在搜索开始的索引处。

**末端位置**

> 可选参数*endpos*限制搜索字符串的距离；就好像字符串是*endpos 个*字符一样长，所以只有从*pos*到的字符`endpos - 1`会被搜索匹配。如果*endpos*小于*pos*，将找不到匹配项；否则，如果*rx*是已编译的正则表达式对象，`rx.search(string, 0, 50)`则等价于`rx.search(string[:50], 0)`.

regex 对象的*search*、*findall*和*finditer*方法也支持这些参数。

[`re.match(pattern, string, flags=0)`](http://docs.python.org/3.3/library/re.html?highlight=re.sub#re.match)如您所见，它不支持它们，
它的*search*、*findall*和*finditer*对应物也不支持。

[匹配对象](http://docs.python.org/3.3/library/re.html?highlight=re.sub#match-objects)具有补充这些参数的属性：

**匹配.pos**

> 传递给正则表达式对象的 search() 或 match() 方法的 pos 的值。这是 RE 引擎开始寻找匹配的字符串的索引。

**匹配.endpos**

> 传递给正则表达式对象的 search() 或 match() 方法的 endpos 的值。这是 RE 引擎不会超出的字符串索引。

* * *

一个[正则表达式对象](http://docs.python.org/3.3/library/re.html?highlight=re.sub#regular-expression-objects)有两个独特的、可能有用的属性：

**正则表达式组**

> 模式中的捕获组数。

**正则表达式.groupindex**

> 将 (?P) 定义的任何符号组名称映射到组编号的字典。如果模式中没有使用符号组，则字典为空。

* * *

最后，[匹配对象](http://docs.python.org/3.3/library/re.html?highlight=re.sub#match-objects)具有以下属性：

**匹配.re**

> 其 match() 或 search() 方法生成此匹配实例的正则表达式对象。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-01-11T12:28:19.097

除了表演。

使用`compile`帮助我区分
*1\. module(re)* ,
*2\. regex object*
*3\. match object*
当我开始学习 regex 时

```
#regex object
regex_object = re.compile(r'[a-zA-Z]+')
#match object
match_object = regex_object.search('1.Hello')
#matching content
match_object.group()
output:
Out[60]: 'Hello'
V.S.
re.search(r'[a-zA-Z]+','1.Hello').group()
Out[61]: 'Hello' 
```

作为补充，我制作了一份详尽的模块备忘单`re`供您参考。

```
regex = {
'brackets':{'single_character': ['[]', '.', {'negate':'^'}],
            'capturing_group' : ['()','(?:)', '(?!)' '|', '\\', 'backreferences and named group'],
            'repetition'      : ['{}', '*?', '+?', '??', 'greedy v.s. lazy ?']},
'lookaround' :{'lookahead'  : ['(?=...)', '(?!...)'],
            'lookbehind' : ['(?<=...)','(?<!...)'],
            'caputuring' : ['(?P<name>...)', '(?P=name)', '(?:)'],},
'escapes':{'anchor'          : ['^', '\b', '$'],
          'non_printable'   : ['\n', '\t', '\r', '\f', '\v'],
          'shorthand'       : ['\d', '\w', '\s']},
'methods': {['search', 'match', 'findall', 'finditer'],
              ['split', 'sub']},
'match_object': ['group','groups', 'groupdict','start', 'end', 'span',]
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-07-11T16:00:03.003

除了性能差异之外，使用 re.compile 和使用已编译的正则表达式对象进行匹配（无论与正则表达式相关的操作）使 Python 运行时的语义更清晰。

我在调试一些简单的代码时有过一些痛苦的经历：

```
compare = lambda s, p: re.match(p, s) 
```

后来我会使用比较

```
[x for x in data if compare(patternPhrases, x[columnIndex])] 
```

其中`patternPhrases`应该是包含正则表达式字符串`x[columnIndex]`的变量，是包含字符串的变量。

我遇到了`patternPhrases`与某些预期字符串不匹配的问题！

但如果我使用 re.compile 形式：

```
compare = lambda s, p: p.match(s) 
```

然后在

```
[x for x in data if compare(patternPhrases, x[columnIndex])] 
```

Python 会抱怨“字符串没有匹配的属性”，如通过位置参数映射 in `compare`，`x[columnIndex]`被用作正则表达式！，当我真正的意思是

```
compare = lambda p, s: p.match(s) 
```

就我而言，使用 re.compile 更明确了正则表达式的目的，当它的值对肉眼隐藏时，我可以从 Python 运行时检查中获得更多帮助。

所以我的教训的寓意是，当正则表达式不仅仅是文字字符串时，我应该使用 re.compile 让 Python 帮助我断言我的假设。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-06-02T01:05:00.597

作为替代答案，正如我看到之前没有提到的那样，我将继续引用[Python 3 文档](https://docs.python.org/3/howto/regex.html#performing-matches)：

> 您应该使用这些模块级函数，还是应该获取模式并自己调用它的方法？如果您在循环中访问正则表达式，预编译它将节省一些函数调用。在循环之外，由于内部缓存，没有太大区别。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-20T18:06:57.443

有趣的是，编译对我来说确实更有效（Win XP 上的 Python 2.5.2）：

```
import re
import time

rgx = re.compile('(\w+)\s+[0-9_]?\s+\w*')
str = "average    2 never"
a = 0

t = time.time()

for i in xrange(1000000):
    if re.match('(\w+)\s+[0-9_]?\s+\w*', str):
    #~ if rgx.match(str):
        a += 1

print time.time() - t 
```

按原样运行上述代码一次，然后将两`if`行注释相反，编译的正则表达式的速度是原来的两倍

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-01-17T21:22:18.633

在偶然发现这里的讨论之前，我运行了这个测试。但是，运行它后，我想我至少会发布我的结果。

我偷了 Jeff Friedl 的“掌握正则表达式”中的示例并将其混为一谈。这是在运行 OSX 10.6（2Ghz intel core 2 duo，4GB ram）的 macbook 上。Python 版本是 2.6.1。

**运行 1 - 使用 re.compile**

```
import re 
import time 
import fpformat
Regex1 = re.compile('^(a|b|c|d|e|f|g)+$') 
Regex2 = re.compile('^[a-g]+$')
TimesToDo = 1000
TestString = "" 
for i in range(1000):
    TestString += "abababdedfg"
StartTime = time.time() 
for i in range(TimesToDo):
    Regex1.search(TestString) 
Seconds = time.time() - StartTime 
print "Alternation takes " + fpformat.fix(Seconds,3) + " seconds"

StartTime = time.time() 
for i in range(TimesToDo):
    Regex2.search(TestString) 
Seconds = time.time() - StartTime 
print "Character Class takes " + fpformat.fix(Seconds,3) + " seconds"

Alternation takes 2.299 seconds
Character Class takes 0.107 seconds 
```

**运行 2 - 不使用 re.compile**

```
import re 
import time 
import fpformat

TimesToDo = 1000
TestString = "" 
for i in range(1000):
    TestString += "abababdedfg"
StartTime = time.time() 
for i in range(TimesToDo):
    re.search('^(a|b|c|d|e|f|g)+$',TestString) 
Seconds = time.time() - StartTime 
print "Alternation takes " + fpformat.fix(Seconds,3) + " seconds"

StartTime = time.time() 
for i in range(TimesToDo):
    re.search('^[a-g]+$',TestString) 
Seconds = time.time() - StartTime 
print "Character Class takes " + fpformat.fix(Seconds,3) + " seconds"

Alternation takes 2.508 seconds
Character Class takes 0.109 seconds 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-09-12T08:57:31.993

这个答案可能会迟到，但这是一个有趣的发现。如果您计划多次使用正则表达式，使用 compile 可以真正节省您的时间（这也在文档中提到）。下面你可以看到，当直接调用 match 方法时，使用编译的正则表达式是最快的。将已编译的正则表达式传递给 re.match 会使它变得更慢，并且将带有模式字符串的 re.match 传递在中间的某个位置。

```
>>> ipr = r'\D+((([0-2][0-5]?[0-5]?)\.){3}([0-2][0-5]?[0-5]?))\D+'
>>> average(*timeit.repeat("re.match(ipr, 'abcd100.10.255.255 ')", globals={'ipr': ipr, 're': re}))
1.5077415757028423
>>> ipr = re.compile(ipr)
>>> average(*timeit.repeat("re.match(ipr, 'abcd100.10.255.255 ')", globals={'ipr': ipr, 're': re}))
1.8324008992184038
>>> average(*timeit.repeat("ipr.match('abcd100.10.255.255 ')", globals={'ipr': ipr, 're': re}))
0.9187896518778871 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-03-14T12:31:47.157

我真的尊重以上所有答案。在我看来是的！当然值得使用 re.compile 而不是编译正则表达式，一次又一次，每次。

> 使用**re.compile**使您的代码更加动态，因为您可以调用已经编译的正则表达式，而不是一次又一次地编译。在以下情况下，这件事对您有利：

1.  处理器的努力
2.  时间复杂度。
3.  使正则表达式通用。（可用于查找、搜索、匹配）
4.  并使您的程序看起来很酷。

***例子 ：***

```
 example_string = "The room number of her room is 26A7B."
  find_alpha_numeric_string = re.compile(r"\b\w+\b") 
```

# 在 Findall 中使用

```
 find_alpha_numeric_string.findall(example_string) 
```

# 在搜索中使用

```
 find_alpha_numeric_string.search(example_string) 
```

> > 同样，您可以将其用于：**匹配和替换**

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-16T21:44:59.883

这是一个很好的问题。你经常看到人们无缘无故地使用 re.compile。它降低了可读性。但是肯定有很多时候需要预编译表达式。就像您在循环中重复使用它时一样。

这就像关于编程的一切（实际上是生活中的一切）。应用常识。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-07-06T10:13:44.493

（几个月后）很容易在 re.match 周围添加自己的缓存，或者其他任何事情——

```
""" Re.py: Re.match = re.match + cache  
    efficiency: re.py does this already (but what's _MAXCACHE ?)
    readability, inline / separate: matter of taste
"""

import re

cache = {}
_re_type = type( re.compile( "" ))

def match( pattern, str, *opt ):
    """ Re.match = re.match + cache re.compile( pattern ) 
    """
    if type(pattern) == _re_type:
        cpat = pattern
    elif pattern in cache:
        cpat = cache[pattern]
    else:
        cpat = cache[pattern] = re.compile( pattern, *opt )
    return cpat.match( str )

# def search ... 
```

一个wibni，如果：cachehint( size= ), cacheinfo() -> size, hits, nclear ...

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-01-04T13:20:09.083

> 我有很多运行编译正则表达式 1000 次而不是即时编译的经验，并且没有注意到任何可感知的差异

对已接受答案的投票导致假设@Triptych 所说的对所有情况都是正确的。这不一定是真的。一个很大的区别是当您必须决定是否接受正则表达式字符串或编译的正则表达式对象作为函数的参数时：

```
>>> timeit.timeit(setup="""
... import re
... f=lambda x, y: x.match(y)       # accepts compiled regex as parameter
... h=re.compile('hello')
... """, stmt="f(h, 'hello world')")
0.32881879806518555
>>> timeit.timeit(setup="""
... import re
... f=lambda x, y: re.compile(x).match(y)   # compiles when called
... """, stmt="f('hello', 'hello world')")
0.809190034866333 
```

如果您需要重用它们，最好编译您的正则表达式。

请注意，上面 timeit 中的示例模拟了在导入时创建编译的正则表达式对象一次，而不是在匹配需要时“即时”创建。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-01-16T21:36:28.230

正则表达式在使用第二个版本时被编译。如果您要多次执行它，最好先编译它。如果不是每次匹配一次都进行编译就可以了。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-02-25T18:22:58.890

### 易读性/认知负荷偏好

对我来说，主要收获是我只需要记住和阅读复杂的正则表达式 API 语法的一种形式——形式**而**`<compiled_pattern>.method(xxx)`不是那个**和**`re.func(<pattern>, xxx)`形式。

这`re.compile(<pattern>)`是一个额外的样板，真的。

但就正则表达式而言，额外的编译步骤不太可能是认知负荷的主要原因。事实上，对于复杂的模式，您甚至可以通过将声明与您随后调用的任何正则表达式方法分开来获得清晰。

我倾向于首先在 Regex101 之类的网站中调整复杂模式，甚至在单独的最小测试脚本中调整，然后将它们引入我的代码中，因此将声明与其使用分开也适合我的工作流程。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-07-16T09:30:40.880

尽管这两种方法在速度方面相当，但您应该知道，如果您处理数百万次迭代，仍然*存在一些可忽略不计的时间差异，这可能是您关心的问题。*

以下速度测试：

```
import re
import time

SIZE = 100_000_000

start = time.time()
foo = re.compile('foo')
[foo.search('bar') for _ in range(SIZE)]
print('compiled:  ', time.time() - start)

start = time.time()
[re.search('foo', 'bar') for _ in range(SIZE)]
print('uncompiled:', time.time() - start) 
```

给出这些结果：

```
compiled:   14.647532224655151
uncompiled: 61.483458042144775 
```

编译的方法在我的 PC（使用 Python 3.7.0）上始终快 4 倍左右。

如[文档](https://docs.python.org/3/howto/regex.html#module-level-functions)中所述：

> 如果您在循环中访问正则表达式，预编译它将节省一些函数调用。在循环之外，由于内部缓存，没有太大区别。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2010-11-06T20:03:49.357

我想激励预编译在概念上和“文学”（如“文学编程”中）都是有利的。看看这个代码片段：

```
from re import compile as _Re

class TYPO:

  def text_has_foobar( self, text ):
    return self._text_has_foobar_re_search( text ) is not None
  _text_has_foobar_re_search = _Re( r"""(?i)foobar""" ).search

TYPO = TYPO() 
```

在你的应用程序中，你会写：

```
from TYPO import TYPO
print( TYPO.text_has_foobar( 'FOObar ) ) 
```

这在功能方面尽可能简单。因为这个例子太短了，所以我把把`_text_has_foobar_re_search`所有东西都放在一条线上的方法混为一谈。`TYPO`这段代码的缺点是无论库对象的生命周期如何，它都会占用一点内存；这样做的好处是，在进行 foobar 搜索时，您将摆脱两个函数调用和两个类字典查找。缓存了多少正则表达式`re`以及该缓存的开销在这里无关紧要。

将此与更常见的样式进行比较，如下所示：

```
import re

class Typo:

  def text_has_foobar( self, text ):
    return re.compile( r"""(?i)foobar""" ).search( text ) is not None 
```

在应用程序中：

```
typo = Typo()
print( typo.text_has_foobar( 'FOObar ) ) 
```

我欣然承认，我的风格对于 python 来说是非常不寻常的，甚至可能值得商榷。然而，在与python的主要使用方式更接近的示例中，为了进行单次匹配，我们必须实例化一个对象，进行三个实例字典查找，并执行三个函数调用；此外，`re`当使用超过 100 个正则表达式时，我们可能会遇到缓存问题。此外，正则表达式隐藏在方法体中，这在大多数情况下并不是一个好主意。

可以说，措施的每个子集——有针对性的、别名的导入语句；适用的别名方法；减少函数调用和对象字典查找——有助于降低计算和概念复杂性。

* * *

## 回答 #27

> 赞同：-5
> 
> 时间：2009-01-16T21:38:12.393

我的理解是这两个例子实际上是等效的。唯一的区别是，在第一个中，您可以在其他地方重用已编译的正则表达式，而不会再次编译它。

这是给你的参考：http: [//diveintopython3.ep.io/refactoring.html](http://diveintopython3.ep.io/refactoring.html)

> 使用字符串“M”调用编译模式对象的搜索函数与使用正则表达式和字符串“M”调用 re.search 完成相同的事情。只是快得多。（实际上，re.search 函数只是简单地编译正则表达式并为您调用生成的模式对象的搜索方法。）

# html - SharePoint Designer 即时重新格式化 HTML，能否禁用？

> ID：452113
> 
> 赞同：3
> 
> 时间：2009-01-16T21:36:12.770
> 
> 标签：html, sharepoint, sharepoint-designer

在我撕掉剩下的头发之前，我一直在尝试修改 SharePoint Designer 中的一些母版页，并且每当我更改 HTML 标记时，它都会根据需要重新设置它们的格式。例如，我试图使代码可读，所以我将项目移动到它们自己的行等。一旦我保存它，就会将所有内容移回一行代码。

这是我在 VS2003 和 VS2005 中遇到的问题，直到 VS2005 SP1。不幸的是，这使得阅读或破译 HTML 标记是什么变得非常麻烦。有谁知道如何在 SharePoint Designer 中禁用这种 HTML 的自动重新格式化？

我的替代方法是使用 VS2008，但在尝试加载 SharePoint 网站时，我收到 Visual Web Developer 无法打开 SharePoint 网站的错误。所以显然这是不行的。SharePoint Designer 是否有任何替代方案，或者您是否坚持使用它并让它在闲暇时修改您的标记？

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T01:56:10.553

只有当我想立即查看更改（例如母版页）的效果时，我才使用 SharePoint Designer，而不必为了这样做而撤回/部署解决方案。

虽然这需要更长的时间，但我在 Visual Studio 中创作了所有 HTML，并在需要时粘贴到 SharePoint Designer。我从不将 SharePoint Designer 中的内容粘贴回 Visual Studio，因为该工具往往会破坏 HTML 并将其添加到其中，以便它可以打开它。

话虽如此，了解何时（以及何时不）使用 SharePoint Designer 很重要。您应该为所有资产（例如母版页和 CSS 文件）创建 SharePoint 解决方案。

如果您在 SharePoint Designer 中打开并编辑其中之一，请记住您正在取消托管/自定义它们。这意味着该文件现在位于内容数据库中，而不是在磁盘上。这可能会影响您网站的性能。

另请记住，SharePoint Designer 不理解服务器端代码。因此，如果您的页面布局背后有代码，则在 SharePoint Designer 中对其进行编辑会破坏它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T08:40:57.130

您可以通过[SharePoint Developer Explorer](http://spdevexplorer.codeplex.com)绕过大部分使用 SharePoint Designer ，特别是[此处的更新](http://spdevexplorer.codeplex.com/WorkItem/View.aspx?WorkItemId=7799)。我还没有尝试过，但看起来您可以直接从 Visual Studio 中编辑母版页和页面布局。此外，从事它工作的人（最初是“The Kid”和更新的 Serge van den Oever）知道他们的东西，所以这对你来说应该是一个不错的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T20:45:10.213

唯一的答案是不使用 SharePoint 设计器。

您可以使用 Visual Studio，但您必须使用 Web 界面上传文件，而不是让 SharePoint Designer 执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T07:51:35.760

正如 Alex 已经指出的那样，我正在努力开发一个由“ [The Kid](http://blog.thekid.me.uk) ”发起的名为[SharePoint Developer Explorer](http://spdevexplorer.codeplex.com/)的项目。它是一个 Visual Studio 插件，用于编辑 SharePoint 中的文件。我对原始项目进行了很多错误修复和增强。有关更改的详细信息以及从何处获取最新版本，请参阅[我的博客。](http://weblogs.asp.net/soever/archive/tags/SPDevExplorer/default.aspx)

因为一张图片说了一千多个字： ![使用 Visual Studio 编辑 SharePoint 文件](https://weblogs.asp.net/blogs/soever/image_30699A10.png) ![EFile 动作](https://weblogs.asp.net/blogs/soever/image_6A389162.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T21:46:38.490

我认为，这是使用工具生成 HTML 的无休止的问题——您将受制于它们生成的内容。我意识到这是一个非答案，但是......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T21:59:10.463

可悲的是，我完全从头开始重写它，它仍然这样做。我什至不必切换回设计视图来更改标记，这是以前的 VS 实例中的触发器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T21:24:09.013

您要么全心投入基于 gui 的设计，要么完全投入手工编辑所有代码。根据我的经验，微软开发产品没有中间地带。共享点设计器中的代码编辑器令人难以忍受。

我想，如果你是一个受虐狂，有可能只使用 scite、notepad++、emacs、vi 等文本编辑器，然后完全手动编写一个共享点站点。我已经做到了。我不能说它令人愉快，但它并不比使用共享点设计器差。

# latex - 参考文献的章节标题和实际引用在 LaTeX 中被挤压在一起

> ID：452114
> 
> 赞同：3
> 
> 时间：2009-01-16T21:36:15.423
> 
> 标签：latex, publish, publishing

这一定是一个常见问题，因为我在许多已发表的论文中都看到了它，但用谷歌搜索似乎很棘手。您可以像这样插入参考书目

```
\bibliographystyle{plain}
\bibliography{foo} 
```

并且一切都按预期工作，除了有时（我不知道是什么情况导致这种情况——对我来说似乎是随机的）部分标题（例如，“7\. References”）和实际引用的开头之间没有空格。章节标题和第一个引文看起来都挤在一起了。这并不是完全令人震惊，但在我看来，这无疑是排版中的一个缺陷。

多年来我一直在忍受它，但一定有人在某个地方注意到了这一点，并且有足够的强迫症来追踪它并找出导致它的原因以及如何纠正它。

我认为这将是记录解决方案的好地方。让我知道您是否可以想办法使这更易于谷歌搜索。

添加：这是一个展示问题的示例文档：http: [//yootles.com/outbox/squish/](http://yootles.com/outbox/squish/)。（另请参阅下面的解决方法。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T20:46:09.473

事实证明，如果 LaTeX 试图避免文档溢出到额外的页面，它有时会删除参考部分标题和实际参考开始之间的空格。

因此，一种解决方法是延长或缩短文档，这样它就不会溢出到附加页面的边缘。

一个相关的解决方法（感谢 bluebrother 的回答）是明确告诉 LaTeX 允许以引用开头的页面有一点额外的垂直空间（稍微吃掉底部边距）。这可以在“ `\bibliographystyle{plain}`”之前使用以下命令完成：

```
\enlargethispage{\baselineskip} 
```

另一个似乎有效的解决方法：

1.  更改为 \bibliographystyle{amsalpha}
2.  重新编译
3.  改回 \bibliographystyle{plain}
4.  重新编译
5.  （不要重新编译，否则它会重新压缩它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-31T21:02:25.103

不确定这是否是原因，但如果通过删除您可以尝试使用的空间，书目可以适合页面`\enlagethispage{someamount}`

# c# - 如何制作通用类型转换方法

> ID：452120
> 
> 赞同：2
> 
> 时间：2009-01-16T21:37:21.787
> 
> 标签：c#, .net

我想做的是：

```
bool Convert( out Object output, Object source)
{
   // find type of output.
   // convert source to that type if possible
   // store result in output.

   return success
} 
```

是否可以？

显然，有一个强大的大规模“if”构造可以工作，但这需要为每种可能的数据类型编写一个 if 块。即使假设我们将其限制为原语和字符串，它仍然是一大块代码。我正在考虑一些更具反思性的事情。

顺便说一句：在浏览 api 时，我遇到了 Convert.IsDBNull() 方法，这将为我节省很多

```
 if ( !databasefield.GetType().Equals( DBNull.Value ) ) 
```

为什么以 Gd 的名义在 Convert 中？为什么不 DBNull.IsDBNull() ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:54:44.683

这是我使用的一个示例，您可以通过注册其他类型转换器将其他复杂的转换注入其中。

```
public static class Converter
{
    public static T Convert<T>(object obj, T defaultValue)
    {
        if (obj != null)
        {
            if (obj is T)
            {
                return (T)obj;
            }

            TypeConverter converter = TypeDescriptor.GetConverter(typeof(T));

            if (converter.CanConvertFrom(obj.GetType()))
            {
                return (T)converter.ConvertFrom(obj);
            }
        }

        return defaultValue;
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T22:10:39.457

一位开发人员正是编写了这个函数，我们发现它非常有用。

本质上，它使用反射来搜索两种类型之间的隐式转换（搜索“op_Implicit”以获取更多信息）。

如果做不到这一点，它会搜索将源类型作为参数的目标类型的构造函数，并调用它。

如果做不到这一点，它会搜索可以将一种类型解析为另一种类型的 Parse 方法。这将找到诸如 Int32.Parse 之类的东西以从 String 转换为 Int，或 IPAddress.Parse 以从 String 转换为 IPAddress。

作为性能优化，一旦找到一次转换，它就会将其保存在 [type,type] <==> [conversion MethodInfo] 的字典中，以便后续调用不必经过广泛的反射搜索。

这可以很好地处理几乎所有的类型转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T21:44:20.680

我已经多次遇到你的问题。我一直发现构建和使用转换函数的时间抵消了它节省的时间。最终会出现精度和舍入等问题，您仍然必须处理特殊情况。

为了检查 dbnull... 我使用 typeof (object) is DbNull ...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T22:37:11.400

这是一个有趣的小练习！我刚刚写了这个，所以如果它不起作用，请不要挂我，但在这里我尝试使用我现在能想到的不同方法进行转换。

```
public static class Converter
{
    public static bool TryConvert<T>(object o, out T result)
    {
        if (o == null && typeof(T).IsClass)
        {
            result = default(T);
            return true;
        }

        var convertible = o as IConvertible;
        if (convertible != null && ConvertibleHandlesDestinationType<T>())
        {
            result = (T)Convert.ChangeType(convertible, typeof(T));
            return true;
        }

        if (o != null)
        {
            if (typeof(T).IsAssignableFrom(o.GetType()))
            {
                result = (T)o;
                return true;
            }

            var converter = TypeDescriptor.GetConverter(o);
            if (converter.CanConvertTo(typeof(T)))
            {
                result = (T)converter.ConvertTo(o, typeof(T));
                return true;
            }
        }

        result = default(T);
        return false;
    }

    private static bool ConvertibleHandlesDestinationType<T>()
    {
        return 
            typeof(T).Equals(typeof(Boolean)) ||
            typeof(T).Equals(typeof(Byte)) ||
            typeof(T).Equals(typeof(char)) ||
            typeof(T).Equals(typeof(DateTime)) ||
            typeof(T).Equals(typeof(Decimal)) ||
            typeof(T).Equals(typeof(Double)) ||
            typeof(T).Equals(typeof(Int16)) ||
            typeof(T).Equals(typeof(Int32)) ||
            typeof(T).Equals(typeof(Int64)) ||
            typeof(T).Equals(typeof(SByte)) ||
            typeof(T).Equals(typeof(Single)) ||
            typeof(T).Equals(typeof(string)) ||
            typeof(T).Equals(typeof(UInt16)) ||
            typeof(T).Equals(typeof(UInt32)) ||
            typeof(T).Equals(typeof(UInt64));
    }
} 
```

由于输出参数的类型是 T，我们可以使用类型推断，这样调用看起来像：

```
int number;
if (Converter.TryConvert("123", out number))
{
    Debug.WriteLine(number);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T21:55:27.443

即使使用 Convert.IsDBNull，也有一种更好的检查方法：

```
if (!databaseField is DBNull) 
```

另请注意，您可以在 Type 上使用 == ，因为特定类型只有一个 Type 实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T21:40:28.533

尝试使用泛型。这样，您就不必进行所有原本必须做的运行时类型检查（而是在编译时完成）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T22:00:00.587

你见过这个功能吗？：

```
Microsoft.VisualBasic.CType() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T21:32:25.383

我在博客[Working with DataTables/Datarows上写了一篇关于如何从 DataRow 管理类型转换的博文](http://dotnetchris.wordpress.com/2009/01/16/working-with-datatablesdatarows/)

```
///<summary>
/// Extension methods for manipulating DataRows
///</summary>
public static class DataRowUserExtensions
{
    /// <summary>
    /// Determines whether [is null or empty string] [the specified data row].
    /// </summary>
    /// <param name="dataRow">The data row.</param>
    /// <param name="key">The key.</param>
    /// <returns>
    ///   <c>true</c> if [is null or empty string] [the specified data row]; otherwise, <c>false</c>.
    /// </returns>
    public static bool IsNullOrEmptyString(this DataRow dataRow, string key)
    {
        if (dataRow.Table.Columns.Contains(key))
            return dataRow[key] == null || dataRow[key] == DBNull.Value || dataRow[key].ToString() == string.Empty;

        throw new ArgumentOutOfRangeException(key, dataRow, "does not contain column");
    }

    /// <summary>
    /// Gets the specified data row.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="dataRow">The data row.</param>
    /// <param name="key">The key.</param>
    /// <returns></returns>
    public static T Get<T>(this DataRow dataRow, string key)
    {
        if (dataRow.Table.Columns.Contains(key))
            return dataRow.IsNullOrEmptyString(key) ? default(T) : (T) ChangeTypeTo<T>(dataRow[key]);

        throw new ArgumentOutOfRangeException(key, dataRow, "does not contain column");
    }

    /// <summary>
    /// Changes the type to.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="value">The value.</param>
    /// <returns></returns>
    private static object ChangeTypeTo<T>(this object value)
    {
        if (value == null)
            return null;

        Type underlyingType = typeof (T);
        if (underlyingType == null)
            throw new ArgumentNullException("value");

        if (underlyingType.IsGenericType && underlyingType.GetGenericTypeDefinition().Equals(typeof (Nullable<>)))
        {
            var converter = new NullableConverter(underlyingType);
            underlyingType = converter.UnderlyingType;
        }

        // Guid convert
        if (underlyingType == typeof (Guid))
        {
            return new Guid(value.ToString());
        }

        // Do conversion
        return underlyingType.IsAssignableFrom(value.GetType()) ?
              Convert.ChangeType(value, underlyingType)
            : Convert.ChangeType(value.ToString(), underlyingType);
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-17T22:37:58.077

没有皈依的圣杯。对于 m 类型，您需要 m*(m-1) 转换例程来涵盖所有排列。

对于原始类型，使用 Convert.ChangeType

如果一个类型可转换为原始类型，则它可以实现 IConvertable 接口并从 Convert 类中使用。

对于其他一切，@Brian Rudolfs 的答案是最好的。为您需要的每个排列注册一个显式转换方法。

# entity-framework - 实体框架：使用事务和回滚......可能吗？

> ID：452129
> 
> 赞同：18
> 
> 时间：2009-01-16T21:39:04.590
> 
> 标签：entity-framework, transactions

问题：（使用 Sql 2005）

*   **事务启动时如何查询数据库？（因为它锁定了桌子）**
*   **如何使事务回滚然后关闭自身以允许查询表？**

所以我发现了这么多：

```
[TestMethod]
public void CreateUser()
{
    TransactionScope transactionScope = new TransactionScope();

    DataContextHandler.Context.AddToForumUser(userToTest);
    DataContextHandler.Context.SaveChanges();

    DataContextHandler.Context.Dispose();
} 
```

DataContextHandler 只是一个简单的单例，它为我的实体公开上下文对象。这似乎正如你所想的那样工作。它创建用户，保存，然后在程序结束时回滚。（IE测试结束）

问题：如何强制事务回滚并杀死自己，以便查询表？

原因：出于测试目的，我想确保用户：

*   已保存
*   可以正确查询证明其存在
*   已删除（垃圾数据）
*   可以查询以确保它已被删除。

截至目前，如果测试结束，我只能让事务回滚，并且我无法弄清楚如何查询事务：

```
[TestMethod]
public void CreateUser()
{
    ForumUser userToTest = new ForumUser();

    TransactionScope transactionScope = new TransactionScope();

    DataContextHandler.Context.AddToForumUser(userToTest);
    DataContextHandler.Context.SaveChanges();     

    Assert.IsTrue(userToTest.UserID > 0);

    var foundUser = (from user in DataContextHandler.Context.ForumUser
                    where user.UserID == userToTest.UserID
                    select user).Count();  //KABOOM Can't query since the 
                                           //transaction has the table locked.

    Assert.IsTrue(foundUser == 1);

    DataContextHandler.Context.Dispose();

    var after = (from user in DataContextHandler.Context.ForumUser
                 where user.UserID == userToTest.UserID
                 select user).Count(); //KABOOM Can't query since the 
                                       //transaction has the table locked.

    Assert.IsTrue(after == 0);
} 
```

**更新这适用于回滚和检查，但仍然无法在 using 部分中查询：**

```
using(TransactionScope transactionScope = new TransactionScope())
{
    DataContextHandler.Context.AddToForumUser(userToTest);
    DataContextHandler.Context.SaveChanges();
    Assert.IsTrue(userToTest.UserID > 0);
    //Still can't query here.

}

var after = (from user in DataContextHandler.Context.ForumUser
            where user.UserID == userToTest.UserID
            select user).Count();

Assert.IsTrue(after == 0); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-26T19:49:02.623

来自[MSDN](http://msdn.microsoft.com/en-us/library/bb336792.aspx)；

> “SaveChanges 在事务中运行。如果任何脏 ObjectStateEntry 对象无法持久化，SaveChanges 将回滚该事务并引发异常。”

所以似乎没有必要通过`TransactionScope`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-12-17T11:40:16.943

在我的情况下，我通过普通 SQL 从表中删除所有记录，因为 EF 不为此提供功能。之后我添加了一些新实体——但是当它失败时，表不应该为空。对我来说似乎不可能使用 MSDTC（TransactionScope）。我将事务减少到数据库：

我的代码：

```
using (var transaction = context.Connection.BeginTransaction())
{
      // delete all
      base.DeleteAll<TESTEntity>(context);

      // add all
      foreach (var item in items)
      {
           context.TESTEntity.AddObject(item);
      }

      try
      {
           context.SaveChanges();
           transaction.Commit();
           return true;
      }
      catch (Exception ex)
      {
           Logger.Write("Error in Save: " + ex, "Error");
           transaction.Rollback();
           return false;
      }
} 
```

这里是辅助功能

```
 protected void DeleteAll<TEntity>(ObjectContext context) where TEntity : class
    {
        string tableName = GetTableName<TEntity>(context);
        int rc = context.ExecuteStoreCommand(string.Format(CultureInfo.InvariantCulture, "DELETE FROM {0}", tableName));
    }

    protected string GetTableName<TEntity>(ObjectContext context) where TEntity : class
    {
        string snippet = "FROM [dbo].[";

        string sql = context.CreateObjectSet<TEntity>().ToTraceString();
        string sqlFirstPart = sql.Substring(sql.IndexOf(snippet) + snippet.Length);
        string tableName = sqlFirstPart.Substring(0, sqlFirstPart.IndexOf("]"));
        return tableName;
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-28T14:41:37.423

我已经能够使用此代码片段解决非常类似的问题：

```
var connection = new EntityConnection("name=MyEntities");
connection.Open();
var tran = connection.BeginTransaction(System.Data.IsolationLevel.ReadUncommitted);

try
{
    var dataContext = new MyEntities(connection);

    //CRUD operation1

    //CRUD operation2

    //CRUD operation3 ...

    Assert.AreEqual(expected, actual);
}
catch
{
    throw;
}
finally
{
    tran.Rollback();
    connection.Close();
} 
```

`MyEntities`EF 数据模型在哪里。关键部分是事务的设置：`System.Data.IsolationLevel.ReadUncommitted`.
使用此隔离级别的 SQL 查询可以读取您在事务中所做的更改。此外，您需要像我在第一行和第二行中那样显式创建一个连接。`TransactionScope`不幸的是，我无法使用它。

# history - 桌面软件开发时间表

> ID：452134
> 
> 赞同：-1
> 
> 时间：2009-01-16T21:40:30.313
> 
> 标签：history

影响桌面软件开发的最重要事件是什么？我正在尝试制定一个好的时间表，但我知道我错过了一些重要事件：

1.  个人电脑的介绍（70年代后期？）
2.  发布 VisiCalc (1980)
3.  1986 年的 WordPerfect 4.2
4.  视窗 3.1 (1992)
5.  视觉基础
6.  视窗 95...

Java、X11、.NET、Delphi、PowerBuilder、QT？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T21:51:22.383

虚拟机，这里是[Wikipedia Timeline](http://en.wikipedia.org/wiki/Virtualization_Development)。选择你的重要事件:-)

这里还有一个非常详细的[时间表。](http://www.islandnet.com/~kpolsson/comphist/mini.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:42:58.343

老鼠的发明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T21:44:13.113

*   老鼠
*   图形用户界面
*   显示器（他们并不总是有显示器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T21:56:22.403

没有电脑就没有桌面应用程序。这是普通人第一次只能拥有一台电脑。

在此之前，如果你幸运的话，你只有一个终端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T22:00:05.860

这是一张浓密的[树状图，展示了](http://www.digibarn.com/stories/desktop-history/bushytree.html)[Xerox PARC](http://www.parc.com/)的研发工作及其对个人计算机技术的深远影响。艾伦·凯( [Alan Kay](https://stackoverflow.com/users/48710/alan-kay) ) 是在那里进行的研究中的关键人物。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T22:09:02.737

Borland 的[Turbo Pascal](http://en.wikipedia.org/wiki/Turbo_Pascal)：我听说以闪电般快速的编译时间而闻名。

# visual-studio - 如何阻止 Visual Studio 自动创建解决方案文件

> ID：452135
> 
> 赞同：7
> 
> 时间：2009-01-16T21:40:57.490
> 
> 标签：visual-studio, projects-and-solutions

我们的项目通常存储为单个项目，而不是更大解决方案的一部分。当我打开一个项目时，Visual Studio 会在我的文件夹中创建一个解决方案 (sln) 和解决方案选项 (suo) 文件。我想停止这种自动 sln 和 suo 创建，有人知道该怎么做吗？

编辑：我们有几十个单独的项目，当我与源代码管理进行比较以找到需要添加/签入的项目时，这两个项目总是在列出每个项目的列表。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-16T22:14:14.597

查看选项 -> 项目和解决方案 -> 常规下是否选中了“始终显示解决方案”。如果是这样，请取消选中它。

我相信这在默认情况下是未选中的。我记得打开它是因为我希望始终创建解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T22:00:00.477

如果您使用的是颠覆，将“svn:ignore”属性添加到文件夹以忽略 *.sln 和 *.suo 似乎是一个不错的解决方案。其他版本控制系统也有类似的功能。请查阅特定 VCS 的文档。

至于实际上阻止它发生，我不知道，但我怀疑这是不可能的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T22:06:58.777

我通常只是取消选中“为解决方案创建目录”，以便将 SLN 文件放在同一个文件夹中，然后在我第一次关闭项目时手动删除它们。除非您做一些值得解决的事情（例如，添加第二个项目），否则 VS 不会重新创建它们。

没有本地方法可以避免生成它们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-16T21:44:33.143

为什么要费心去阻止呢？只需将每个解决方案保留在一个项目中，然后忽略 .sln/.suo 文件并照常打开您的项目文件。

# c - 编写固件：汇编还是高级？

> ID：452139
> 
> 赞同：19
> 
> 时间：2009-01-16T21:41:45.957
> 
> 标签：c, assembly, embedded, firmware

相关：

*   [测试固件](https://stackoverflow.com/questions/451984/testing-firmware)
*   [启动微控制器模拟器/仿真器](https://stackoverflow.com/questions/448513/starting-a-microcontroller-simulator-emulator)
*   [解释汇编代码](https://stackoverflow.com/questions/448580/interpreting-assembly-code)

如果您正在为[微控制器](http://www.sparkfun.com/commerce/product_info.php?products_id=707#)编写代码，如果您使用汇编或 C 或其他高级语言编写代码，是否有真正的区别？如果您编写 C 代码，您将如何编译它？

谢谢

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-16T23:25:42.520

几条评论：

1) 除非性能或优化限制允许，否则绝对**不**组装。以下指标随组装一起飞速发展：

*   是时候编码了
*   是时候调试它了
*   是时候测试它了
*   是时候记录它了
*   是时候弄清楚（1 年后）你在编写代码时在做什么
*   犯错的机会

*2) 我的偏好是 C++ 而不是 C，因为它的命名空间封装及其对编译时*面向对象实践的促进。C 有太多的机会出现全局变量和命名空间冲突。（实时Java会很好，但据我了解它的要求仍然很高）

或者更确切地说是 C++ 的一个子集：排除异常、虚函数、运行时类型识别，以及大多数情况下的动态内存分配——基本上是在编译时未指定的任何内容，因为它通常在运行时需要大量额外资源。这就是 C++ 的“膨胀”。

我已经将 TI 和 IAR 的 C++ 编译器用于 TMS320 和 MSP430 微控制器（分别），并且通过适当的优化设置，它们在减少 C++ 的开销方面做得非常出色。（特别是如果你通过明智地使用`inline`关键字来帮助它）

我什至使用模板来实现它们的一些编译时优势，从而促进良好的代码重用：例如编写单个源代码文件来处理 8 位、16 位和 32 位 CRC；和[编译时多态性](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)，允许您指定一个类的通常行为，然后重用它但覆盖它的一些函数。同样，TI 编译器通过适当的优化设置具有极低的开销。

我一直在为 Microchip PIC 寻找 C++ 编译器；我发现唯一一家生产的公司是 IAR。（$$$ 一直是个障碍，但我希望有一天能买一份）Microchip C18/C30 编译器相当不错，但它们是 C，而不是 C++。

3）关于编译器优化的一个特殊警告：它可以/将使调试变得非常困难；通常不可能单步执行优化的 C/C++ 代码，并且您的监视窗口可能会显示与您认为它们应该包含的未优化代码无关的变量。（一个好的调试器会警告你一个特定的变量已经被优化到不存在或进入一个寄存器而不是一个内存位置。许多调试器没有。>:(

此外，一个好的编译器可以让您通过#pragmas 在函数级别选择/选择优化。我使用的那些只允许您在文件级别指定优化。

4) 将 C 代码连接到汇编：这通常很困难。最简单的方法是制作一个具有您想要的签名的存根函数，例如`uint16_t foo(uint16_t a, uint32_t b) {return 0; }`，其中`uint16_t`= unsigned short，我们通常将位数设为显式。然后编译它并编辑它生成的程序集（只需确保保留代码的开始/退出部分）并**注意**不要破坏任何寄存器而不在完成后恢复它们。

除非您正在做一些*非常*简单的事情，例如启用/禁用中断，否则内联汇编通常会出现问题。

我最喜欢的方法是编译器内在函数/“扩展 ASM”语法。Microchip 的 C 编译器基于 GNU C 编译器，它具有“[扩展 ASM](http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html) ”，可让您编写内联汇编的代码，但您可以给它很多提示，告诉它您正在引用哪些寄存器/变量，它会处理所有的保存/恢复寄存器以确保您的汇编代码与 C 语言“配合得很好”。TI 的 TMS320 DSP 编译器不支持这些；它确实有一组有限的内在函数，它们有一些用处。

我使用汇编来优化一些经常执行的控制循环代码，或者计算 sin()、cos() 和 arctan()。但否则我会远离汇编并坚持使用高级语言。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-16T21:45:31.300

大多数微控制器制造商都提供某种交叉编译器，您可以在其中编译 PC 上的代码，然后将其传输到微控制器。

**为什么选择 C？**
C 的一个优点是您的代码将来更容易移植到其他微控制器。计算的历史表明，代码通常比硬件实现更持久。
第二个优点是控制结构（if、for、while）使代码更具可读性和可维护性。

**为什么是汇编语言？**
您可以手工优化。

**结论**
与这类问题的常见情况一样，权衡取舍很大程度上取决于具体用途。
请注意，通常可以通过在 C 代码中进行汇编调用来混合两者，这样您就可以找到适合您项目的平衡点。

**特定于 PIC 硬件**
似乎大多数 PIC 硬件[都](http://www.voti.nl/picfaq/index_1.html#Where%20can%20I%20get%20a%20GCC%20for%20PICs?)没有 GCC 选项。另一方面，正如评论者所指出的，用于 16 位 PIC24 和 dsPIC33 的 Microchip C30 编译器是 gcc。[SDCC](http://sdcc.sourceforge.net/)
也不支持 PIC 。***新信息：根据评论，SDCC 对 PIC 有可行的支持。*** 还有一些其他的开源[选项](http://en.wikipedia.org/wiki/PIC_microcontroller#Open_Source)，但我没有使用它们的经验。

 ** * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-16T21:53:36.840

最好的选择可能是用 C 编写代码，然后对于极少数需要手动优化并且可以比编译器做得更好的实例，您应该将程序集编写到 c 文件中。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-13T21:06:16.523

汇编编码对于 PC 来说已成为过去，但在嵌入式领域却非常重要。

在嵌入式中编写程序集不同于在 PC 上编写程序集。PC 编译器在生成优化指令方面“比人类更好”。嵌入式系统通常具有怪异的架构，并且它们的优化编译器不如 PC 优化编译器成熟。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-16T21:55:30.830

我在为微控制器编写程序集时遇到的一个问题是需要*非常*小心你的代码是如何布局的。让一个跳转表跨越内存边界，并导致你的代码跳转到非常奇怪的地方是相当令人不安的。用 C 编码，编译器会为您覆盖该基础。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-16T21:59:20.197

我肯定会选择 C。它更快，并且创建更可靠的软件。大会提供的东西很少，而且在稀缺的场合。请记住，在 C 中：

*   您将能够轻松地从现有平台（甚至是 PC）移植代码。
*   您可以在不影响执行速度或代码大小的情况下使用高级语言进行开发。如果有一个高质量的编译器可用（PIC18 有很多选择），这些使用 C 语言很可能比手工汇编更好。
*   调试、测试和维护代码要容易得多。C 生成更可靠的代码。

另一件与 PIC18 有特别关系的事情。您不必处理非直观的 PIC 架构和内存库之类的东西。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-16T22:04:23.260

过去，我对 8051 的[IAR](http://www.iar.com) C 编译器有很好的经验。

我最近的方法一直是这样的：-

使用良好的优化编译器用 C 语言编写它，只有在大小或速度存在问题时，才考虑在汇编程序中重写某些部分。

但是，自从采用这种方法以来，我从来**不需要**编写一行汇编程序......

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-21T15:48:16.630

去 c ！

我曾在一家大型 CE 制造商工作。我最后一次看到汇编是在 1996 年左右，在一些小型中断服务例程中，用于 RC5 和 RC6 解码和电视调谐算法。之后总是使用 c 和 C++（只使用类，没有 stl、异常或 rtti）。对于 8051 的旧 KEIL 编译器、greenhills 编译器 (MIPS) 和 VxWorks 工具集（基于 PowerPC），我有很好的经验。

正如 Roddy 所说，首先用 C 编写，然后在汇编中优化（如果需要）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-16T21:45:13.627

在许多情况下，组装可以更快；当您在台式机上时，编译器往往会优化到手动组装很少需要的程度，但在 uC 世界中，通常是这样。此外，如果您需要编写中断处理例程之类的东西，您通常无法在 C 中完成。

至于编译，请为您的目标搜索 C 编译器。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-13T20:58:34.360

肯定是 C，除非当

*   程序内存非常有限。说在经过艰苦的手工优化您的汇编代码之后，您设法将您的程序安装在这 1024 字节的闪存中，剩下 0 字节。在这种情况下，没有 C 编译器会有任何好处。

*   你想拥有绝对的时序控制。如果任何数量的中断延迟太长，您将不得不依赖汇编程序。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-06-22T18:12:35.090

现在的问题是嵌入式可以是任何东西，从具有 6 个引脚和几个字节 RAM 的 ATTiny 到运行嵌入式操作系统的多核 SBC，这会让一些人的台式计算机感到羞耻。

因此，语言/开发环境的选择需要考虑到您需要的效率与系统的复杂程度。

首先 - C 在任何地方都可以工作并且可以很好地扩展，你走得越高，你最终会调用外部库等来处理复杂性。

对于非常小的 micros（以字节为单位测量 flash/ram），您最好使用 ASM，当您达到 kb 范围时，可以使用 C 或任何其他传统语言，因为您不需要计算每个字节。一旦你有兆字节可以使用，你就有能力并且越来越可能需要使用 RTOS 来处理所有事情并缩短开发时间。当你拥有硬件时，你可以在其上运行一个完整的操作系统，你可能可以将自己从硬件中抽象出来，只需将所有内容写在像 Java 或类似的填充单元中，而不必过多担心这一切是多么的浪费以及你是如何的不再是真正的程序员了... ;)

上述情况的例外是当您需要从硬件中获得的所有性能时，您可能需要降低一两个级别以保持效率。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-22T20:54:59.770

这是底线，如果您使用 C，您可以稍后手动优化，我不会使用 C 或汇编程序以外的任何东西（没有 C++ 等）。

如果您使用的是 PIC 甚至 8051，关键是微控制器指令集，我只会使用汇编程序。如果它是编译器友好的 isa，如 arm 或 avr 或 msp430，则使用 C 来节省一些输入，但由于各种原因，您可能会在汇编程序中有一些例程。同样，您可能希望避免使用 C 库，即使 newlib 也可能过于庞大，请从它们那里借用代码或想法，但不要只链接其中一个。哦，回到问题，再次查看可用于目标的 C 编译器arm 和 avr 你不会有任何问题。可能 msp 也可以。仅仅因为 Keil 或 Iar 会向您出售编译器并不意味着您应该购买或使用它，付费编译器和免费编译器的输出可能是可怕的。

底线（另一个底线），没有全局答案（避免任何高于 C 的东西都是全局答案）它总是取决于平台是什么你的资源是什么你的任务是什么性能要求是什么便携性要求是（如果它真正嵌入在微控制器上，其中大部分是不可移植的）编译器、调试器、jtag 等可用，即使您正在开发的主机操作系统可能是一个重要因素。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-30T19:14:30.003

还有一次可能需要用汇编语言编写：如果您需要进行一些低级 RAM 测试或类似的测试，这需要绝对控制数据的存储位置。

例如，确认[SIL](http://en.wikipedia.org/wiki/Safety_Integrity_Level) -2（安全完整性等级）及以上的软件可能需要对 RAM 进行持续检查，以检测任何可能的数据损坏。您正在检查的 RAM 区域在检查时不能更改，因此在汇编程序中编写测试可以确保这是真的，例如通过将任何局部变量存储在特定寄存器或 RAM 的另一个区域中. 在 C 语言中，这将是困难的，如果不是不可能的话。

将 RAM 清零并初始化非零静态变量的启动代码也可以用汇编程序编写，尽管通常会提供这种代码。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-07T04:57:49.100

如果您编写的代码高度依赖于特定于设备的外设，并且您使用的工具链没有提供有效利用它们的必要内在函数（例如蹩脚的飞思卡尔 DSP563CC 编译器），那么请使用汇编。

除此之外，我认为使用汇编与高级语言的不成文规则与桌面软件开发的潜规则或多或少相同：保持代码干净、可维护，并使用机器语言优化热代码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-06-06T23:30:01.743

汇编语言的代码非常快且占用空间小，但是用汇编语言编写的代码不是可重用的代码。代码的这种可重用特性是软件设计最重要的特性。例如，如果您有 x86 处理器的汇编程序项目代码，它只能用于 x86 处理器，不能用于 ARM 处理器。但是，如果您有 x86 处理器的项目 C/C++ 代码，则可以将此代码用于 ARM 处理器。因此，最好避免使用汇编程序进行软件开发。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-09T21:58:07.160

太糟糕了，到目前为止还没有人提到 Forth 或 Scheme。两者都适用于小型环境，并且可以带来令人印象深刻的生产力提升。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-01T21:43:52.193

普通 C 或 Pascal，Modula2。但是由于编译器的可用性，这意味着 C.

额外的 C++ 和类似的东西只是出于风格的原因才有趣，因为动态分配和程序大小通常非常有限。

如果您的应用程序变得紧张，更复杂的运行时也会很痛苦。

汇编器也很有用，但前提是您销售的数量非常大，并且较小的固件意味着更小、更便宜的芯片（更少的闪存）并且程序的大小是可监督的（阅读：有一些机会你会及时得到它没有错误)

# css - 如何为以编程方式绘制的 TextField 使用预定义的 CSS 样式？

> ID：452140
> 
> 赞同：0
> 
> 时间：2009-01-16T21:42:15.817
> 
> 标签：css, apache-flex

我有一个将文本呈现到 BitmapData 的图形应用程序——现在它被硬编码为使用特定的字体，这对于测试来说很好，但对于生产来说，我真的需要它能够样式化。

应用程序的其余部分使用特定的字体，我希望能够只使用样式名（字体的样式）来创建一个 TextFormat 对象以传递给文本精灵嵌入的 TextField 对象。

所以现在的顺序大致如下：

```
 var format:TextFormat = new TextFormat();
        format.font = "Arial";
        format.color = 0xFF0000;
        format.size = 12;
        // tf is a previously instantiated TextField()
        tf.defaultTextFormat = format;
        tf.autoSize = TextFieldAutoSize.LEFT;

        tf.text = _text; 
```

然后，它只是简单地绘制：

```
 bmpData.fillRect(srcRect,0x00000000);
        bmpData.draw(tf); 
```

现在这很讨厌，那么如何从我的应用程序 css 定义中获取 StyleSheet 或 TextFormat 呢？我查看了 StyleManager、CSSStyleDeclaration，似乎没有什么很合适。这里的顺序是什么，有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T22:33:18.787

基本上，您可以将`[style]`元数据标签添加到您的自定义类以定义您的自定义样式属性，在您的 css 中为这些属性指定值，并`getStyle("myCustomStylePropertyName")`在您的代码中使用以获取在 css 中设置的值。

有关详细信息，请参阅[Flex 3 帮助：示例：创建样式属性](http://livedocs.adobe.com/flex/3/html/help.html?content=skinstyle_3.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T09:38:21.230

您可以尝试以下内容

如果您在 CSS 文件中设置了一些名为 TextFormat.

```
var css:CSSStyleDeclaration = StyleManager.getStyleDeclaration("TextFormat")
yourComponent.setStyle("textAlign", getStyle("headerTextAlign"));
yourComponent.setStyle("fontFamily", getStyle("fontFamily")); 
```

这应该可以满足您的需求。

# php - 对象和三元运算符 PHP

> ID：452161
> 
> 赞同：3
> 
> 时间：2009-01-16T21:46:53.310
> 
> 标签：php, object

我想对一个对象使用三元运算符。

```
if($msg == 'hello'){
    $o->setHello('hello');
else
    $o->setHello('bye'); 
```

我怎么能那样做？

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-16T21:51:17.640

```
$o->setHello($msg == 'hello' ? 'hello' : 'bye'); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-16T21:51:53.333

怎么样？

```
$o->setHello($msg == 'hello' ? 'hello' : 'bye'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T21:50:46.283

试试这个：

```
($msg == 'hello') ? $o->setHello('hello') : $o->setHello('bye'); 
```

# ruby-on-rails - 是否有可以从闪存驱动器运行的独立 Ruby（和 Rails）解决方案？

> ID：452175
> 
> 赞同：3
> 
> 时间：2009-01-16T21:49:50.060
> 
> 标签：ruby-on-rails, ruby

在不久的将来，我可能会在一所艺术学院为本科生教授 Ruby 编程课程。可以肯定的是，学生几乎没有编程经验。该课程将在计算机实验室教授，但他们对实验室计算机没有任何管理权限。

理想情况下，我希望学生能够在实验室和家里的计算机上通过闪存驱动器运行 Ruby。更好的是，如果它可以在 Mac 和 Windows 计算机上相对透明地完成（我假设 Linux 用户可能知道如何设置 Ruby）。更好的是，如果他们可以运行 Ruby on Rails 和/或使用闪存驱动器上的 Ruby 安装来安装 gem。

这是完全不现实的还是有直接的方法来做到这一点？这些将是非程序员，艺术学生，所以他们的设置越少越好。

编辑：

我应该提到我知道一些不同的用于 Ruby 和 Rails 的一键式安装程序。我想我想知道是否有一种方法可以为学生提供已经配置好的安装，该安装可以从闪存驱动器运行，并允许他们运行 Ruby 脚本，甚至可能安装 gem。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T00:30:06.257

首先，您需要在 USB 驱动器上安装两份 Ruby：一份用于 Windows，一份用于 Mac OS X。

然后，您需要在每个脚本中创建一个脚本，以将 Ruby 添加到路径并打开一个终端。

我会这样构造它：

*   红宝石
    *   视窗
        *   bin，lib等...
        *   开始.bat
    *   苹果电脑
        *   bin，lib等...
        *   启动.sh

**视窗**

内容`start.bat`

```
@echo off
set PATH=%CD%\bin;%PATH%
start cmd 
```

`start.bat`使用工作目录创建快捷方式`ruby/windows`

**Mac OS X**

`start.sh`（不确定等效脚本文件的内容）

```
... 
```

然后创建一个快捷方式来执行脚本。

现在，不是正常启动终端，而是使用快捷方式，Ruby 将从 USB 驱动器运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T22:18:08.943

[InstantRails](http://instantrails.rubyforge.org/wiki/wiki.pl)听起来像是您所需要的。它目前仅在 Windows 上，但他们确实计划移植它。

它使用 Rails 运行 Apache 和 MySql，并带有语法高亮文本编辑器和其他一些零碎的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T22:22:39.213

[RubyStack](http://bitnami.org/stack/rubystack)可能会工作。它还提供了一个平台独立的[JRuby 版本](http://bitnami.org/stack/jrubystack)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T12:25:42.413

您可能想要检查[RubyStack](http://bitnami.org/stack/rubystack)，正如前面提到的海报之一。虽然它不是从 U 盘运行，但安装程序包含您开始所需的一切（包括难以配置/编译的东西，如 ImageMagick）。由于它们与[BitRock](http://bitrock.com)安装程序一起打包，因此不需要管理员权限。您没有提到具体的操作系统，但 Rubystack 可在 Windows、Mac 和 Linux 上运行，因此您的学生无论在家中拥有什么都可以依赖相同的确切配置。它也是完全免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-02T16:48:43.507

这不是您所要求的，但您可以使用[http://herokugarden.com/](http://herokugarden.com/)，这是一个完整的 Ruby on Rails 环境，可**通过浏览器**托管和访问，让学生可以在课堂和在家中工作。

据我了解，ThoughtBot（一家著名的 Rails 咨询/培训商店）正是出于这个原因在他们的培训课程中使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T22:50:21.093

我推荐[Locomotive](http://locomotive.sourceforge.net/)在 OS X 上运行 Ruby/Rails。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T00:36:06.527

AFAIK。Ruby 和 Rails 是最近 Mac OSX 构建的一部分。我不知道版本或这种情况持续了多长时间。

我不明白为什么你不能将 ruby​​ 安装到闪存驱动器上，然后安装所有相关的 gem（rails，显然加上一些更新，比如 gem 系统和最新的 rake，我想我会选择 mongrel 而不是网里克）。在 Windows 中，之后您需要的只是路径上的 ?:\ruby\bin ，这可能很容易通过驱动器上的 CMD 文件实现（可能需要一点聪明才能获取驱动器号对）。在那之后，它应该可以工作。我想 Mac 也是如此，尽管可能只需要 gem update rails。

# javascript - 使用 jQuery 的 each() 在 JavaScript 中更干净（嵌套）的闭包

> ID：452182
> 
> 赞同：6
> 
> 时间：2009-01-16T21:51:55.563
> 
> 标签：javascript, jquery, jquery-ui, closures

我想知道是否有一种更简洁（更简洁）的方式来执行`each()`以下 JavaScript 代码中的操作。

```
$(".moreinfodialog")
    .before('<a href="#">Click for more info.</a>')
    .each(function() {
        var temp = this;
        $(this).prev("a").click(function() {
            $(temp).dialog("open");
            return false;
        });
    })
    .dialog({ autoOpen: false, modal: true }); 
```

请注意，最后一次调用对 dom 元素重新排序，因此`.moreinfodialog`类不再位于 href 旁边。

顺便说一句：这个源使用 jquery/jquery-ui 对话框来隐藏带有`.moreinfodialog`类的 div 中的任何文本，并将其替换为`Click for more info.`文本。单击该文本时，将显示一个对话框，其中包含原始 div 内的文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T22:05:21.527

**编辑：** 这个答案与旧版本的 jQuery 相关。在较新的版本中`$.map`，工作方式不同。

查看[$.map()](http://api.jquery.com/jQuery.map/)函数，该函数用于对数组的每个元素执行相同的操作。

```
$('.moreinfodialog').map(function(idx, element) {
    $(this).prev("a").click(function() {
            $(element).dialog("open");
            return false;
    });
}); 
```

# hash - 非常低成本的哈希函数

> ID：452186
> 
> 赞同：9
> 
> 时间：2009-01-16T21:53:08.570
> 
> 标签：hash, lookup

我需要一个查找表的散列函数，所以如果我的值是从 0 到 N，我需要一个散列函数给我一个从 0 到 n 的值，即 n << N。另一条信息是我已经提前知道N。

我一直在研究不同的低成本哈希函数，但我发现只有这个：

```
h = z mod n  range(z) - 0 to N, range(h) - 0 to n 
```

我的哈希函数需要在硬件中实现，所以它需要有一个非常低的成本。除了那个简单的东西之外，任何人都可以推荐任何其他公式或算法吗？当我说硬件时，我的意思是真正的硬件实现，而不是微处理器中的指令。

谢谢你。

**更新解决方案**

感谢所有答案，我不会选择最喜欢的一个，因为根据目标应用程序的特性，它们都同样有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T22:20:46.863

它的规范形式是`h(x) = (a*x + b) mod n`，其中 a 和 b 是常量， n 是哈希表的大小。你想制作`n`一个素数，以获得最佳（ish）分布。

请注意，这对某些类型的分布很敏感——例如，只是做`x mod n`主要依赖于低位的随机性；如果它们在您的集合中不是随机的，您将获得相当大的偏差。

Bob Jenkins 设计了几个非常好的散列函数；这是一个专门设计为易于在硬件中实现的：http: [//burtleburtle.net/bob/hash/nandhash.html](http://burtleburtle.net/bob/hash/nandhash.html)

有关许多不同的哈希函数、设计讨论等，请参阅站点的其余部分：http: [//burtleburtle.net/bob/hash/](http://burtleburtle.net/bob/hash/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T22:12:36.690

CRC？

对此也已经有很多硬件支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T22:22:21.117

我相信这是解决这个问题的最佳哈希值（比模数更快，分布更好），因为你在 0..N 中的所有数字都具有相同的概率：

```
h = z * n / N; 
```

所有值都是整数，所以你有一个整数除法。这样，0..N 之间的每个值都映射到 n 中完全相同数量的值。

例如，当 n=3 和 N=7（值 3 和 7 不包括在范围内）时，哈希是这样的：

```
z * n / N = hash
----------------
0 * 3 / 7 = 0
1 * 3 / 7 = 0
2 * 3 / 7 = 0
3 * 3 / 7 = 1
4 * 3 / 7 = 1
5 * 3 / 7 = 2
6 * 3 / 7 = 2 
```

因此，每个哈希值的使用频率相同，仅相差 1。请注意`n*(N-1)`不要溢出。

如果 N 是 2 的幂，则可以通过移位替换除法。例如，如果 N=256：

```
h = (z * n) >> 8; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T22:56:29.020

如果您真正谈论的是硬件（相对于软件，或软件的硬件实现），并且您的哈希桶数 n 可以写为 n = 2 ^m - 1，那么最简单的可能是最大长度[线性反馈移位寄存器](http://en.wikipedia.org/wiki/Linear_feedback_shift_register)（ LFSR），其中 CRC 是一个实例。

这是您可以使用 m 位移位寄存器创建数据包哈希的一种方法（确保所有数据一致地表示为 K 位字符串，如果您有较短的字符串，则用零填充一端）：

1.  初始化 LFSR 的状态（CRC-32 使用全 1；全零可能不好）
2.  转移数据位
3.  （可选）移动额外的 j 个零（j 在 m 和 2m 之间可能是一个不错的选择）；这增加了一些额外的散列以减少输入/输出位之间的直接相关性
4.  使用 m 位移位寄存器的内容作为散列值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T21:55:41.373

`log2(n)`以随机顺序重新连接位并取低位

`log2(n)`或者，如果您的数据分布均匀，则只需使用较低的位。

# wcf - WCF 验证错误

> ID：452222
> 
> 赞同：2
> 
> 时间：2009-01-16T22:02:09.847
> 
> 标签：wcf, enterprise-library, wcf-faults

我正在使用[验证应用程序块 - 企业库](http://msdn.microsoft.com/en-us/library/cc309334.aspx)来验证发送到我的 WCF 服务操作的参数。例如，某个操作要求参数为 1 或 6，如下所示：

```
[OperationContract(Name="GetEmployeesByRegion")]
[FaultContract(typeof(ValidationFault))]
List<Employees> GetEmployeesByRegion([DomainValidator(1,6)]int regionId); 
```

这工作得很好，即发生验证错误，但是当客户端调用服务时，会抛出通用 System.ServiceModel.FaultException。一条消息表明：*“此故障的创建者未指定原因。”*

现在，我可以在服务校准之前自己检查参数并引发自定义错误，但这似乎违背了使用验证应用程序块对参数进行基于属性的验证的目的。是否有自定义验证错误返回的错误？我也有可能做错了什么。我只想让调用者知道他/她应该在异常消息中传入 1 或 6。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T04:32:46.953

实际上，故障中存在一个集合，其中包含您要查找的所有消息：

```
foreach (ValidationDetail detail in fault.Detail.Details)
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-03T19:13:06.657

所以这是古老的，但我遇到了同样的问题并且确实找到了答案。

对我来说，问题是我在客户端中创建了对服务的引用*后*添加了 [ValidationBehavior] 和 [FaultContract<ValidationFault>)] 属性。为了让它工作，我不得不刷新参考。

其他一些可能需要检查的事项：

1) 这是在 Enterprise Library 6 中修复的错误。我不确定那个错误，但发现一些提到 EntLib 的代码修复类似问题。确保您使用的是最新版本的 EntLib。

2) 您正在为验证错误消息使用 ErrorMessage 参数，而不是 MessageTemplate。

# sql - 尝试为复杂的搜索场景构建 SQL 语句

> ID：452230
> 
> 赞同：1
> 
> 时间：2009-01-16T22:04:43.837
> 
> 标签：sql, sql-server-2005, tsql, search

我正在尝试为以下搜索场景构建 SQL 语句：

我试图根据表 B 中状态列的值返回表 A 的单个记录的所有列。表 A 中的每条记录在表 B 中可以有多行，使其成为一对多关系。状态列可以为整数，数据类型为空。

以下是表 B 中状态的可能值：

*   NULL = 待处理，
*   1 = 已批准，
*   2 = 拒绝，
*   6 = 强制批准，
*   7 = 强制拒绝

最终用户可以搜索以下场景：

*   已批准 - 所有表 B 记录的状态值必须为 1 或 6。
*   拒绝 - 一个表 B 记录的值必须为 2 或 5。任何其他记录都可以有 1,6 或 null。
*   待定 - 所有表 B 记录的值都可以是 1,6 或 null。一条记录必须为空，因为它未被视为已完成。

**更新**
我咨询了我们的一位 DBA，他开发了以下解决方案：

得到正式认可的：

```
SELECT a.* FROM TableA a INNER JOIN TableB ON b.id = a.id
WHERE
(b.status in (1,6) and b.status IS NOT NULL) AND
b.id NOT IN (SELECT id from TableB  WHERE status IS NULL)
AND b.id NOT IN (SELECT id from TableB WHERE status in (2,7)) 
```

拒绝：

```
SELECT a.* FROM TableA a INNER JOIN TableB ON b.id = a.id
WHERE
(b.status in (2,7)) 
```

待办的：

```
SELECT a.* FROM TableA a INNER JOIN TableB ON b.id = a.id
WHERE
(b.status IN (1,6) OR b.status IS NULL)
AND b.id NOT IN (SELECT b.id FROM TableA a INNER JOIN TableB b ON b.id = a.id WHERE (b.status IN (1,6) AND b.status IS NOT NULL) AND b.id NOT IN (SELECT id from TableB WHERE status IS NULL))
AND b.id NOT IN (SELECT id FROM TableB WHERE status IN (2,7)) 
```

**更新 2：**
@Micth Wheat - 我将如何使用 EXIST/NOT EXIST t-sql 关键字重构以下解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T22:26:40.173

作为“已批准”的示例：

```
select 
    * 
from 
    A 
where
    (select count(*) from B where B.parent_id = A.id and B.status in (1,6)) > 0
and (select count(*) from B where B.parent_id = A.id and B.status not in (1,6)) = 0 
```

重构为使用*exists*和*not exists*：

```
select 
    * 
from 
    A 
where
    exists (select * from B where B.parent_id = A.id and B.status in (1,6)) 
and not exists (select * from B where B.parent_id = A.id and B.status not in (1,6)) 
```

如果你传入了一个条件，你可以像这样将它全部打包在一个查询中，如果这样更方便的话：

```
select 
    * 
from 
    A 
where     
    (@Criteria = 'Approved'
and (select count(*) from B where B.parent_id = A.id and B.status in (1,6)) > 0
and (select count(*) from B where B.parent_id = A.id and B.status not in (1,6)) = 0
    )
or  (@Criteria = 'Denied'
and (select count(*) from B where B.parent_id = A.id and B.status in (2,7)) > 0
    )
or  (@Criteria = 'Pending'
and (select count(*) from B where B.parent_id = A.id and B.status not in (2,7)) = 0
and (select count(*) from B where B.parent_id = A.id and B.status is null) > 0
    ) 
```

请注意，根据您的示例数据，我将 Denied 示例更改为 2 和 7 的值，而不是 2 和 5。

编辑：你也可以使用*exists*和*not exists*，正如 Joe 所建议的那样。

编辑：使用 max(case ...) 的方法，通常也被视为 sum(case ...) 用于计数值，在某些情况下确实表现更好（主要取决于您的数据量，性能提升是否明显 - 有时这可能会有很大的不同）。我个人觉得子查询更具可读性，所以我从它们开始，如果需要更好的性能，我会对这两种方法进行基准测试，如果 max(case ...) 效果更好，我会切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T12:13:33.373

从我读到的 Chris Teixeira 和 hova 使用基本相同的逻辑，但是；
- Hova 只解析表格一次
- Chris Teixeira 多次解析表格
=> 首选 Hova 的技术（在我看来）

然而，Hova 做的有点不对……

逻辑应该是：

```
- If Any 2 or 7 records   => DENIED
- ElseIf Any NULL records => PENDING
- Else                    => ACCEPTED 
```

这给出了以下代码...

```
SELECT
    [main].id,
    CASE WHEN MAX(CASE WHEN [status].value IN (2,7) THEN 1 ELSE 0 END) = 1 THEN 'DENIED'
         WHEN MAX(CASE WHEN [status].value IS NULL  THEN 1 ELSE 0 END) = 1 THEN 'PENDING'
         ELSE 'ACCEPTED' END
FROM
    [main]
INNER JOIN
    [status]
        ON [main].id = [status].main_id
GROUP BY
    [main].id 
```

此外，使用 MAX 而不是 SUM（Hova 使用的）意味着查询引擎只需找到一个匹配项，而不是多个匹配项。此外，优化器更容易在 [status] 表上使用适当的索引。（在这种情况下，索引将按 [status] 表上的顺序为 (main_id, value)。

民主党。

编辑：

类似的事情可能如下。我在这里没有要测试的 SQL 实例，所以我不能告诉你它是否更快，但我认为它可能是......

```
SELECT
    [main].id,
    MIN(CASE WHEN [status].value IN (2,7) THEN -1        -- Denied
             WHEN [status].value IS NULL  THEN  0        -- Pending
             ELSE                               1  END)  -- Accepted
FROM
    [main]
INNER JOIN
    [status]
        ON [main].id = [status].main_id
GROUP BY
    [main].id 
```

编辑：

另一种选择只是加入映射表而不是使用 CASE 语句。

```
DECLARE @map TABLE (
   status_value   INT,
   status_result  INT
   )

INSERT INTO @map VALUES (1,    1)
INSERT INTO @map VALUES (2,   -1)
INSERT INTO @map VALUES (6,    1)
INSERT INTO @map VALUES (7,   -1)
INSERT INTO @map VALUES (NULL, 0)

SELECT
    [main].id,
    MIN([map].status_result)
FROM
    [main]
INNER JOIN
    [status]
        ON [main].id = [status].main_id
INNER JOIN
    @map AS [map]
        ON [status].value = [map].status_value
        OR ([status].value IS NULL AND [map].status_value IS NULL)
        -- # This has been faster than using ISNULLs in my experience...
GROUP BY
    [main].id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T22:16:48.057

看起来您想使用一些**存在**语句。

对于所有值都必须是某个值的那些，那么您将针对其他可能的值添加**不存在。**

- 得到正式认可的

```
exists(select 1 from B where A.id = B.id and status in (1,6))
and not exists(select 1 from B where A.id = B.id and (status is null or status not in (1,6))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T23:10:28.447

也许像这样

```
select CASE WHEN SUM(CASE WHEN ISNULL(b.status, 0) IN (1,6) THEN 1 ELSE 0 END) = COUNT(*) THEN 'Approved'
            WHEN SUM(CASE WHEN ISNULL(b.status, 0) IN (2,5) THEN 1 ELSE 0 END) > 0 THEN 'Denied'
            WHEN SUM(CASE WHEN ISNULL(b.status, 0) IN (1,0,6) THEN 1 ELSE 0 END) = COUNT(*)
                AND SUM(CASE WHEN b.status IS NULL THEN 1 else 0 END) > 0  THEN 'Pending'
            ELSE '???' END as Status, <a column list>
FROM A 
INNER JOIN b ON a.id = b.id
group by <a column list> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T16:47:57.953

您还询问了如何利用 EXISTS 来解决查询。我仍然没有任何东西可以测试这个，但我会尝试类似下面的东西......

得到正式认可的：

```
SELECT
    a.*
FROM
    TableA a
WHERE
    NOT EXISTS (SELECT * FROM TableB b WHERE b.id = a.id AND b.status IN (NULL,1,6)) 
```

拒绝：

```
SELECT
    a.*
FROM
    TableA a
WHERE
    EXISTS (SELECT * FROM TableB b WHERE b.id = a.id AND b.status IN (1,6)) 
```

待办的：

```
SELECT
    a.*
FROM
    TableA a
WHERE
    EXISTS (SELECT * FROM TableB b WHERE b.id = a.id AND b.status IS NULL)
    AND NOT EXISTS (SELECT * FROM TableB b WHERE b.id = a.id AND b.status IN (1,6)) 
```

# php - Zend_Form 单选元素

> ID：452237
> 
> 赞同：8
> 
> 时间：2009-01-16T22:08:18.870
> 
> 标签：php, zend-framework, zend-form

下面是在 Zend_Form 中创建带有是/否选项的单选按钮元素的示例代码。关于如何将所需答案设置为“是”的任何想法，因此如果选择“否”，验证将失败？下面的代码将接受是或否。

```
 $question= new Zend_Form_Element_Radio('question');
    $question->setRequired(true)
        ->setLabel('Are you sure?')
        ->setMultiOptions(array('Yes', 'No')); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T22:23:16.857

不确定这是否是最好的方法，但它对我有用：

```
$questionValid = new Zend_Validate_InArray(array('Yes'));
$questionValid->setMessage('Yes is required!');

$question = new Zend_Form_Element_Radio('question');
$question->setRequired(true)
    ->setLabel('Are you sure?')
    ->setMultiOptions(array('Yes'=>'Yes', 'No'=>'No'))
    ->addValidator($questionValid); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:59:25.470

一种更快的方法，尽管这不适用于其他情况：

```
$question = new Zend_Form_Element_Radio('question');
$question->setRequired(true)
    ->setLabel('Are you sure?')
    ->setMultiOptions(array('Yes'=>'Yes', 'No'=>'No'))
    ->addValidator('StringLength', false, array('min' => 3, 'messages' => "You must be sure.")); 
```

由于“否”少于 3 个字符，因此除非选择“是”，否则这将失败。这有点“hacky”，但我喜欢这种方式，因为它使用更少的代码并且还利用了内置的验证器。

# sql - Hiberate问题，jdbc IDENTITY_INSERT设置为OFF

> ID：452238
> 
> 赞同：9
> 
> 时间：2009-01-16T22:08:50.583
> 
> 标签：sql, sql-server, hibernate, jdbc

尝试通过休眠向 SQL Server 提交时出现 JDBC 错误

> 当 IDENTITY_INSERT 设置为 OFF 时，无法在表“报告”中插入标识列的显式值

我正在使用由 netbeans 生成的映射，其中包含，

```
<class name="orm.generated.Report" table="Report" schema="dbo" catalog="DatabaseName">
    <id name="id" type="int">
        <column name="ID" />
        <generator class="assigned" />
    </id> 
```

在我看来，它应该正确地进行身份插入。

关于如何解决这个问题的任何想法？

编辑：
一些文档链接，供后代使用，
[http](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/mapping.html#mapping-declaration-id-generator)
[://www.hibernate.org/hib_docs/v3/reference/en-US/html/mapping.html#mapping-declaration-id-generator http://www.roseindia .net/hibernate/hibernateidgeneratorelement.shtml](http://www.roseindia.net/hibernate/hibernateidgeneratorelement.shtml)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T05:39:26.243

除非“IDENTITY_INSERT”设置为“ON”，否则不能插入到 SQL Server 中的标识列。由于您的生成器类是“已分配的”，Hibernate 假设您在保存对象之前在 Java 中为“id”设置了一个显式值，并且 Hibernate 可以直接将该值插入到数据库中。您需要：

1.  选择不同的生成器类，例如“native”
2.  将 IDENTITY_INSERT 设置为“开”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-02T15:58:51.640

尝试将生成器类的类型从“分配”更改为“身份”，它对我有用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T20:45:18.547

最好使用像 Integer 这样的包装类而不是原始 int。

以你的代码为例

```
<class name="orm.generated.Report" table="Report" schema="dbo" catalog="DatabaseName">
<id name="id" type="java.lang.Integer">
    <column name="ID" />
    <generator class="assigned" />
</id> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T14:20:01.927

这是对我有用的东西。根据需要进行调整。

```
@SuppressWarnings("deprecation")
public static void saveWithOverwrittenId(Session session, Object entity) {
    String tableName = entity.getClass().getSimpleName();
    boolean identityInsertSetToOn = false;
    try {
        session.connection().createStatement().execute("SET IDENTITY_INSERT "+tableName+" ON");
        identityInsertSetToOn = true;
        session.beginTransaction();
        session.saveOrUpdate(entity);
        session.getTransaction().commit();
    } catch (SQLException e) {
        session.getTransaction().rollback();
        throw new RuntimeException(e);
    } finally {
        if (identityInsertSetToOn) {
            try {
                session.connection().createStatement().execute("SET IDENTITY_INSERT "+tableName+" OFF");
            } catch (SQLException e) {
                throw new RuntimeException(e);
            }
        }
    }
} 
```

在我的例子中，SQL Server 表与 Entity 类同名。对你来说，这可能不是真的。那么，一种解决方案是将表名作为参数询问。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-10T09:42:31.243

更改生成器类的类型

前

```
<id name="id" type="long">
        <column name="Id" />
        <generator class="assigned" />
    </id> 
```

后

```
<id name="id" type="long">
        <column name="Id" />
        <generator class="native" />
    </id> 
```

现在这将起作用！

# grails - 如何将 Grails 中由组合框表示的字段设为可选？

> ID：452241
> 
> 赞同：1
> 
> 时间：2009-01-16T22:09:36.120
> 
> 标签：grails, groovy, constraints, grails-orm

我正在使用 Grails 进行第一次实验，并且正在寻找一种方法让组合框表示的字段（例如一对一的域关联和具有窄范围约束的数字）是可选的，即应该有一个空的在组合框中输入。

如何做到这一点？我已经尝试`nullable:true`在静态属性中添加约束和列出字段`optionals`，但都没有产生所需的结果。

这些是我的域类：

```
class Customer {
    String name
}
class Book {
    static optionals = ['year','loanedTo','loanedSince']
    static constraints = {
    title(blank:false)
    author(blank:false)
    year(range:1900..new Date().getAt(Calendar.YEAR), nullable:true)
    loanedTo(nullable:true)
    loanedSince(min:new Date())
    }

    String title;
    String author;
    Integer year;
    Customer loanedTo;
    Date loanedSince;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T22:24:46.840

我发现`nullable:true`约束实际上确实产生了预期的效果——但是，它不会立即生效；您必须重新启动 Grails 才能看到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T03:06:58.033

如果您已经生成了脚手架代码，您还必须重新生成它，以便该选项存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T15:23:47.930

我认为`optionals`仍然不支持：http: [//jira.codehaus.org/browse/GRAILS-472](http://jira.codehaus.org/browse/GRAILS-472)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T13:52:35.263

该标签还有一个默认的“未选择”值属性：noSelection。您可以像这样使用它来将下拉菜单默认为“---”而不是常规值： noSelection="${['':'---']}"

在控制器中，默认值显示为空字符串，如值的第一部分中所指定。

# f# - 在 f# 中标记字符串

> ID：452258
> 
> 赞同：4
> 
> 时间：2009-01-16T22:18:34.840
> 
> 标签：f#

如果我有一个 f# 函数，它接受一个包含一个句子的字符串，那么将该字符串分解为一个字符串列表的最佳方法是什么，每个单词一个字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T22:24:02.223

在这种情况下，最简单的答案可能只是使用标准的 System.String.Split() 函数。

```
let split (value:System.String) = value.Split([|' '|]) 
```

# vb.net - VB.NET：检测文本文件是否打开

> ID：452267
> 
> 赞同：0
> 
> 时间：2009-01-16T22:21:37.953
> 
> 标签：vb.net, text-files

有什么方法可以确定文本文件当前是否在文本编辑器中打开？或者更好的是，有没有办法在打开文本文件（从任何程序）时触发事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T22:24:23.780

使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)组件，您可以静态检测 Changed、Created、Deleted 和 Renamed 事件。

如果要检测 Last Access，则需要手动设置[NotifyFilter](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.notifyfilter.aspx)以包含[LastAccess](http://msdn.microsoft.com/en-us/library/system.io.notifyfilters.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T22:58:11.217

当大多数编辑器打开文件时，他们通常会遵循一套策略：
1\. 打开文件
2\. 将全部内容读入缓冲区 3\. 关闭
文件

然后*你的*程序运行。由于文件已经关闭，任何打开它的尝试当然都会成功。使用`FileSystemWatcher`this 可以检测文件是否打开或关闭。但是，您将无法在程序运行*之前检测文件是否已打开。*

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-16T22:29:47.093

我想我会做一个计时器来检查文件的最后修改时间......当程序启动时，它会得到最后修改时间。

# .net - 使用 IDisposable 取消订阅事件

> ID：452281
> 
> 赞同：54
> 
> 时间：2009-01-16T22:26:22.763
> 
> 标签：.net, events, idisposable, unsubscribe

我有一个处理来自 WinForms 控件的事件的类。根据用户正在做的事情，我正在推迟该类的一个实例并创建一个新实例来处理相同的事件。我需要先从事件中取消订阅旧实例 - 很简单。如果可能的话，我想以非专有的方式来做这件事，这似乎是 IDisposable 的工作。但是，大多数文档仅在使用非托管资源时才建议使用 IDisposable，这在此处不适用。

如果我实现 IDisposable 并取消订阅 Dispose() 中的事件，我是否会歪曲它的意图？我应该提供一个 Unsubscribe() 函数并调用它吗？

* * *

**编辑：**这是一些显示我在做什么的虚拟代码（使用 IDisposable）。我的实际实现与一些专有数据绑定有关（长话短说）。

```
class EventListener : IDisposable
{
    private TextBox m_textBox;

    public EventListener(TextBox textBox)
    {
        m_textBox = textBox;
        textBox.TextChanged += new EventHandler(textBox_TextChanged);
    }

    void textBox_TextChanged(object sender, EventArgs e)
    {
        // do something
    }

    public void Dispose()
    {
        m_textBox.TextChanged -= new EventHandler(textBox_TextChanged);
    }
}

class MyClass
{
    EventListener m_eventListener = null;
    TextBox m_textBox = new TextBox();

    void SetEventListener()
    {
        if (m_eventListener != null) m_eventListener.Dispose();
        m_eventListener = new EventListener(m_textBox);
    }
} 
```

在实际代码中，“EventListener”类涉及的比较多，每个实例都具有唯一意义。我在一个集合中使用它们，并在用户单击时创建/销毁它们。

* * *

**结论**

我接受[gbjbaanb 的回答](https://stackoverflow.com/questions/452281/using-idisposable-to-unsubscribe-events#452321)，至少现在是这样。我觉得使用熟悉的界面的好处超过了在不涉及非托管代码的情况下使用它的任何可能的缺点（这个对象的用户怎么会知道这一点？）。

如果有人不同意 - 请发布/评论/编辑。如果可以针对 IDisposable 提出更好的论据，那么我将更改已接受的答案。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-16T22:43:51.247

是的，去吧。尽管有些人认为 IDisposable 仅适用于非托管资源，但事实并非如此 - 非托管资源恰好是最大的胜利，也是实施它的最明显理由。我认为它获得了这个想法是因为人们想不出任何其他理由来使用它。它不像终结器，这是一个性能问题，GC 也不容易处理好。

将任何整理代码放入您的 dispose 方法中。与试图记住撤消您的引用相比，它会更清晰，更清洁并且更有可能防止内存泄漏和该死的视线更容易正确使用。

IDisposable 的目的是让您的代码更好地工作，而无需您进行大量手动工作。利用它的力量对你有利，克服一些人为的“设计意图”胡说八道。

我记得当 .NET 刚问世时，要说服微软相信确定性终结的有用性已经够难的了——我们赢得了战斗并说服他们添加它（即使当时它只是一种设计模式），使用它！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-16T22:34:12.280

我个人的投票是有一个 Unsubscribe 方法，以便从事件中删除该类。IDisposable 是一种用于确定性释放非托管资源的模式。在这种情况下，您不管理任何非托管资源，因此不应实施 IDisposable。

IDisposable 可用于管理事件订阅，但可能不应该。例如，我将您指向 WPF。这是一个充斥着事件和事件处理程序的库。然而几乎没有 WPF 中的类实现 IDisposable。我认为这表明事件应该以另一种方式管理。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-10-26T10:16:43.887

使用模式取消订阅事件让我感到困扰的一件事`IDisposable`是完成问题。

`Dispose()`函数 in`IDisposable`应该由开发人员调用，但是，如果开发人员未调用它，则可以理解 GC 将调用此函数（`IDisposable`至少按照标准模式）。但是，在您的情况下，如果您不调用`Dispose`任何其他人，则该事件仍然存在，并且强引用使 GC 无法调用终结器。

`Dispose`在我看来，GC 不会自动调用 ()的事实足以在这种情况下不使用 IDisposable 。也许它需要一个新的应用程序特定接口，该接口表明这种类型的对象必须具有调用的**Cleanup**函数以由 GC 处理。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-08-05T15:16:04.730

我认为一次性适用于 GC 无法自动处理的任何事情，并且事件引用在我的书中很重要。这是我想出的一个助手类。

```
public class DisposableEvent<T> : IDisposable
    {

        EventHandler<EventArgs<T>> Target { get; set; }
        public T Args { get; set; }
        bool fired = false;

        public DisposableEvent(EventHandler<EventArgs<T>> target)
        {
            Target = target;
            Target += new EventHandler<EventArgs<T>>(subscriber);
        }

        public bool Wait(int howLongSeconds)
        {
            DateTime start = DateTime.Now;
            while (!fired && (DateTime.Now - start).TotalSeconds < howLongSeconds)
            {
                Thread.Sleep(100);
            }
            return fired;
        }

        void subscriber(object sender, EventArgs<T> e)
        {
            Args = e.Value;
            fired = true;
        }

        public void Dispose()
        {
            Target -= subscriber;
            Target = null;
        }

    } 
```

这使您可以编写此代码：

```
Class1 class1 = new Class1();
            using (var x = new DisposableEvent<object>(class1.Test))
            {
                if (x.Wait(30))
                {
                    var result = x.Args;
                }
            } 
```

一个副作用是，您不能在事件上使用 event 关键字，因为这会阻止将它们作为参数传递给辅助构造函数，但是，这似乎没有任何不良影响。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-17T08:49:33.940

另一种选择是使用[弱委托](http://blogs.msdn.com/greg_schechter/archive/2004/05/27/143605.aspx)或[WPF 弱事件](http://msdn.microsoft.com/en-us/library/aa970850.aspx)之类的东西，而不必显式取消订阅。

PS [OT] 我认为只提供强大的代表的决定是 .NET 平台的一个最昂贵的设计错误。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-01-05T01:23:54.563

从我读到的关于一次性用品的所有内容中，我认为它们实际上主要是为了解决一个问题而发明的：及时释放非托管系统资源。但是我发现的**所有示例**仍然不仅集中在非托管资源的主题上，而且还有另一个共同点： **调用 Dispose 只是为了加快一个进程，否则稍后会自动发生**（GC -> 终结器 ->处置）

然而，调用取消订阅事件的 dispose 方法永远不会自动发生，即使您将添加一个会调用您的 dispose 的终结器。（至少只要事件拥有对象存在 - 如果它被调用，您将不会从取消订阅中受益，因为事件拥有对象也会消失）

所以主要区别在于事件以某种方式构建了一个无法收集的对象图，因为事件处理对象突然被您只想引用/使用的服务引用。您突然*被迫*调用 Dispose - 不可能*进行自动*处理。因此，Dispose 将获得一个微妙的其他含义，而不是在所有示例中发现的含义，其中 Dispose 调用 - 在肮脏的理论中;) - 不是必需的，因为它会被自动调用（在某些时候）......

反正。由于一次性模式已经非常复杂（处理难以正确处理的终结器和许多准则/合同），更重要的是，在大多数情况下与事件反向引用主题无关，我会说它会是通过不使用该隐喻来表示可以称为“从对象图取消根”/“停止”/“关闭”的东西，更容易在我们的脑海中分离出来。

我们想要实现的是禁用/停止某些行为（通过取消订阅事件）。如果有一个像 IStoppable 这样带有 Stop() 方法的标准接口，那就太好了，根据合同，它只专注于

*   让对象（+它自己的所有可停止对象）与它不是自己创建的任何对象的事件断开连接
*   这样它就不会再以隐式事件样式的方式被调用（因此可以被视为已停止）
*   一旦对该对象的任何传统引用消失，就可以收集

让我们调用唯一执行取消订阅的接口方法“Stop()”。您会知道停止的对象处于可接受的状态，但只是停止了。也许拥有一个简单的属性“已停止”也是一个不错的选择。

如果您只是想暂停将来肯定会再次需要的某个行为，或者存储一个已删除的历史中的模型对象以供以后撤消恢复。

毕竟写作我不得不承认刚刚在这里看到了一个 IDisposable 的例子：http: [//msdn.microsoft.com/en-us/library/dd783449%28v=VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd783449%28v=VS.100%29.aspx) 但无论如何，直到我了解 IObservable 的每一个细节和最初的动机我会说它不是最好的用例示例

*   因为它是一个非常复杂的系统，我们这里只有一个小问题
*   并且可能是整个新系统的动机之一是首先摆脱事件，这将导致与原始问题有关的某种堆栈溢出

但似乎他们走在了正确的轨道上。无论如何：他们应该使用我的界面“Istoppable”；）因为我坚信在

*   处置：“您*应该*调用该方法，否则*如果*GC 发生迟到，*可能会*泄漏” ....

 *和

*   停止：“你*必须*调用这个方法来*停止某种行为*”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-16T22:39:03.190

IDisposable 坚定地关乎资源，我认为问题的根源在于不会进一步搅浑水。

我也在为您自己的界面上的取消订阅方法投票。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-16T23:20:32.140

一种选择可能是根本不取消订阅——只是为了改变订阅的含义。如果事件处理程序可以变得足够聪明，可以根据上下文知道它的含义，那么您首先不需要取消订阅。

在您的特定情况下，这可能是一个好主意，也可能不是一个好主意——我认为我们真的没有足够的信息——但值得考虑。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-21T17:19:57.413

不，您并没有阻止 IDisposable 的意图。IDisposable 旨在作为一种通用方式，以确保在您使用完一个对象后，您可以主动清理与该对象相关的所有内容。它不必只是非托管资源，它也可以包括托管资源。事件订阅只是另一个托管资源！

实践中经常出现的类似情况是，您将在您的类型上实现 IDisposable，纯粹是为了确保您可以在另一个托管对象上调用 Dispose()。这也不是变态，它只是整洁的资源管理！

# python - 如何在 Mac 上安装 Beautiful Soup 模块？

> ID：452283
> 
> 赞同：51
> 
> 时间：2009-01-16T22:26:45.803
> 
> 标签：python, macos, module, installation

我读了这篇文章但没有找到解决方案： http: [//docs.python.org/install/index.html](http://docs.python.org/install/index.html)

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-01-16T22:37:30.150

“正常”的方法是：

*   访问 Beautiful Soup 网站，[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)
*   下载包
*   打开包装
*   在终端窗口中，`cd`到结果目录
*   类型`python setup.py install`

另一种解决方案是使用`easy_install`. 转到[http://peak.telecommunity.com/DevCenter/EasyInstall](http://peak.telecommunity.com/DevCenter/EasyInstall)），使用该页面上的说明安装软件包，然后在终端窗口中键入：

```
easy_install BeautifulSoup4
# for older v3:
# easy_install BeautifulSoup 
```

`easy_install`将负责下载、解包、构建和安装包。使用的好处`easy_install`是它知道如何搜索许多不同的 Python 包，因为它查询[PyPI](http://pypi.python.org/)注册表。因此，一旦您`easy_install`在您的机器上安装了许多不同的第三方软件包，只需在 shell 中通过一个命令即可。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-06-12T07:08:25.930

我认为目前正确的做法是通过`pip`Pramod 的评论

```
pip install beautifulsoup4 
```

由于 Python 的最后一次更改，请参阅[此处](https://stackoverflow.com/questions/3220404/why-use-pip-over-easy-install)的讨论。过去并非如此。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-16T22:41:46.773

布赖恩也打败了我，但因为我已经有了成绩单：

[简易安装](http://peak.telecommunity.com/DevCenter/EasyInstall)

```
aaron@ares ~$ sudo easy_install BeautifulSoup
Searching for BeautifulSoup
Best match: BeautifulSoup 3.0.7a
Processing BeautifulSoup-3.0.7a-py2.5.egg
BeautifulSoup 3.0.7a is already the active version in easy-install.pth

Using /Library/Python/2.5/site-packages/BeautifulSoup-3.0.7a-py2.5.egg
Processing dependencies for BeautifulSoup
Finished processing dependencies for BeautifulSoup 
```

..或正常无聊的方式：

```
aaron@ares ~/Downloads$ curl http://www.crummy.com/software/BeautifulSoup/download/BeautifulSoup.tar.gz > bs.tar.gz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 71460  100 71460    0     0  84034      0 --:--:-- --:--:-- --:--:--  111k

aaron@ares ~/Downloads$ tar -xzvf bs.tar.gz 
BeautifulSoup-3.1.0.1/
BeautifulSoup-3.1.0.1/BeautifulSoup.py
BeautifulSoup-3.1.0.1/BeautifulSoup.py.3.diff
BeautifulSoup-3.1.0.1/BeautifulSoupTests.py
BeautifulSoup-3.1.0.1/BeautifulSoupTests.py.3.diff
BeautifulSoup-3.1.0.1/CHANGELOG
BeautifulSoup-3.1.0.1/README
BeautifulSoup-3.1.0.1/setup.py
BeautifulSoup-3.1.0.1/testall.sh
BeautifulSoup-3.1.0.1/to3.sh
BeautifulSoup-3.1.0.1/PKG-INFO
BeautifulSoup-3.1.0.1/BeautifulSoup.pyc
BeautifulSoup-3.1.0.1/BeautifulSoupTests.pyc

aaron@ares ~/Downloads$ cd BeautifulSoup-3.1.0.1/

aaron@ares ~/Downloads/BeautifulSoup-3.1.0.1$ sudo python setup.py install
running install
<... snip ...> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-18T13:05:00.700

下载包并解压。在终端中，转到包的目录并键入

```
python setup.py install 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-20T10:02:07.133

```
sudo yum remove python-beautifulsoup 
```

或者

```
sudo easy_install -m BeautifulSoup 
```

可以删除旧版本 3

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-10-08T20:09:28.767

根据[http://for-ref-only.blogspot.de/2012/08/installing-beautifulsoup-for-python-3.html](http://for-ref-only.blogspot.de/2012/08/installing-beautifulsoup-for-python-3.html)的建议，我使用了 Windows 命令提示符：

```
C:\Python\Scripts\easy_install c:\Python\BeautifulSoup\beautifulsoup4-4.3.1 
```

其中 BeautifulSoup\beautifulsoup4-4.3.1 是下载并解压的 beautifulsoup4-4.3.1.tar 文件。有用。

# windows - 创建双 Mac/Win Autorun CD

> ID：452289
> 
> 赞同：10
> 
> 时间：2009-01-16T22:31:32.270
> 
> 标签：windows, macos, installation

如何创建在 Mac 上打开“将此图标拖到应用程序文件夹进行安装”并在 Windows 上自动运行安装程序的 CD？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T22:43:04.523

您可以使用[hdiutil](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man1/hdiutil.1.html)

例如。

```
hdiutil makehybrid -o [output-file] [input-folder] -iso -hfs -hide-iso [mac-only-file] -hide-hfs [windows-only-files] 
```

您要做的是从 HFS 分区中隐藏特定于 Windows 的文件，并从 ISO 中隐藏仅 Mac 的文件。

然后，您将像在 Windows 上一样使用自动运行文件。

在 Mac 端，您可以购买许多应用程序来创建看起来以某种方式的 Finder 窗口，但所有这些更改都可以在 finder 中进行。然后您需要将 DS_Store 文件复制到 CD 上，Finder 将自动应用您所做的任何更改。

同样使用 -hfs-openfolder 将导致它在插入到 mac 时自动打开。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T22:43:05.087

Jordan Brough 在他的博客上写了一篇非常好的文章：

[http://jordan.broughs.net/archives/2008/03/creating-cross-platform-windows-and-mac-installer-cds](http://jordan.broughs.net/archives/2008/03/creating-cross-platform-windows-and-mac-installer-cds)

对于它的价值，这是从相当简单的谷歌搜索返回的第一个结果......

# shell - 如何在 shell 中拆分 NUL

> ID：452290
> 
> 赞同：3
> 
> 时间：2009-01-16T22:31:55.920
> 
> 标签：shell, zsh

我正在使用 zsh 作为外壳。

我想执行 unix find 命令并将结果放入 shell 数组变量中，例如：

```
FILES=($(find . -name '*.bak')) 
```

这样我就可以用类似的东西迭代这些值

```
for F in "$FILES[@]"; do echo "<<$F>>"; done 
```

但是，我的文件名至少包含空格，也许还有其他时髦的字符，所以上面的方法不起作用。起作用的是：

```
IFS=$(echo -n -e "\0"); FILES=($(find . -name '*.bak' -print0)); unset IFS 
```

但这很丑陋。这已经有点超出我对 zsh 语法的舒适限制了，所以我希望有人能指出一些我从不知道但应该知道的基本功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T22:38:12.990

我倾向于使用`read`它。一个快速的谷歌搜索显示我 zsh 似乎也支持这一点：

```
find . -name '*.bak' | while read file; do echo "<<$file>>"; done 
```

这不会以零字节拆分，但它将使其适用于包含除换行符以外的空格的文件名。如果文件名出现在要执行的命令的最后，您可以使用`xargs`，也可以使用文件名中的换行符：

```
find . -name '*.bak' -print0 | xargs -0 cp -t /tmp/dst 
```

将找到的所有文件复制到目录`/tmp/dst`中。xargs 方法的缺点是您当然没有变量中的文件名。所以这并不总是适用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-15T23:46:39.300

~~我想出的唯一方法是使用 eval：~~

 ~~```
(zyx:~/tmp) % F="$(find . -maxdepth 1 -name '* *' -print0)"
(zyx:~/tmp) % echo $F | hexdump -C
00000000  2e 2f 20 10 30 00 2e 2f  d0 96 d1 83 d1 80 d0 bd  |./ .0../........|
00000010  d0 b0 d0 bb 20 c2 ab d0  a1 d0 b0 d0 bc d0 b8 d0  |.... ...........|
00000020  b7 d0 b4 d0 b0 d1 82 c2  bb 2e d0 9c d0 b8 d1 82  |................|
00000030  d1 8e d0 b3 d0 b8 d0 bd  d0 b0 20 d0 9e d0 bb d1  |.......... .....|
00000040  8c d0 b3 d0 b0 2e 20 d0  93 d1 80 d0 b0 d0 bd d0  |...... .........|
00000050  b8 20 d0 be d1 82 d1 80  d0 b0 d0 b6 d0 b5 d0 bd  |. ..............|
00000060  d0 b8 d0 b9 2e 68 74 6d  6c 00 2e 2f 0a 20 0a 6e  |.....html../. .n|
00000070  00 2e 2f 20 7b 5b 5d 7d  20 28 29 21 26 7c 00 2e  |../ {[]} ()!&|..|
00000080  2f 74 65 73 74 32 20 2e  00 2e 2f 74 65 73 74 33  |/test2 .../test3|
00000090  20 2e 00 2e 2f 74 74 74  0a 74 74 0a 0a 74 20 00  | .../ttt.tt..t .|
000000a0  2e 2f 74 65 73 74 20 2e  00 2e 2f 74 74 0a 74 74  |./test .../tt.tt|
000000b0  0a 74 20 00 2e 2f 74 74  5c 20 74 0a 74 74 74 00  |.t ../tt\ t.ttt.|
000000c0  2e 2f 0a 20 0a 0a 00 2e  2f 7b 5c 5b 5d 7d 20 28  |./. ..../{\[]} (|
000000d0  29 21 26 7c 00 0a                                 |)!&|..|
000000d6
(zyx:~/tmp) % echo $F[1]
.
(zyx:~/tmp) % eval 'F=( ${(s.'$'\0''.)F} )'
(zyx:~/tmp) % echo $F[1]
./ 0 
```~~ 

${(s.\0.)...} 和 ${(s.$'\0'.)...} 不起作用。您可以使用功能：

```
function SplitAt0()
{
    local -r VAR=$1
    shift
    local -a CMD
    set -A CMD $@
    local -r CMDRESULT="$($CMD)"
    eval "$VAR="'( ${(s.'$'\0''.)CMDRESULT} )'
} 
```

~~用法：`SplitAt0 varname command [arguments]`~~

我应该使用`${(ps.\0.)F}`，而不是`${(s.\0.)F}`：

```
% F=${(ps.\0.)"$(find . -maxdepth 1 -name '* *' -print0)"}
% echo $F[1]
./ 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T00:03:20.047

我试过了

```
F=(*) 
```

它甚至可以处理文件名中带有换行符的文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T03:07:43.913

或者，由于您使用的是 zsh，因此您可以使用 zsh 的扩展通配语法来查找文件，而不是使用 find 命令。据我所知， find 的所有功能都存在于通配语法中，并且它可以正确处理带有空格的文件名。有关更多信息，请参见`zshexpn(1)`手册页。如果您全职使用 zsh，那么学习语法是非常值得的。

# object - 如何使用 MS Roles & Membership 设计用户对象模型

> ID：452295
> 
> 赞同：3
> 
> 时间：2009-01-16T22:35:31.950
> 
> 标签：object, model, asp.net-membership

我想为一个有点典型的 Web 应用程序构建一个“用户”对象模型……但是我无法决定如何最好地设计对象模型和角色系统。

基本上我计划有大约 4 种用户类型……它们对应于会员提供者中的用户“角色”。

这些类型将是： • 工人 • 雇主 • 访客 • 管理员

超级类型是： • 用户

此外，用户有时可能既是“工人”又是“雇主”。

我想使用 MS Roles & Membership 提供程序并设置导航 UI 以响应用户角色。

我的问题是：我怎样才能最好地将这些用户设计为灵活（用户可以是工人和雇主）。如何处理登录/角色程序？

（我正在考虑一个拥有“行为”对象工厂的用户（工人行为，雇主行为））

For Login-User logins in ... 找到它的角色并转换到它的子类型。

这是应该怎么做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T23:56:15.763

事实证明，仅使用角色的概念本身就足够了。它没有提供足够低的粒度来控制权限。例如，您可能有一个工人角色和一个管理员角色，然后在代码中您使用 principal.IsInRole("Admin") 来检查他们的角色以确定他们是否可以修改某些值（比如薪水）。然后有人改变了主意，说主管可以改变薪水，但仍然不是管理员。现在您必须更改您的访问检查以添加另一个角色检查。痛苦而例行公事。

所以我要做的是列出应用程序中的所有功能，然后让它们与数据库中的所有角色相关联。我的访问检查看起来像 principal.HasPermission("CHANGESALARY")。我根据用户登录时所附加的角色加载用户权限。这样，企业可以创建他们想要的任意数量的功能组并为其命名。然后可以将它们应用于任何用户。

我创建了一个自定义主体对象并将其附加到线程，以便我可以在整个页面生命周期的任何代码中使用它。该对象具有从数据库加载权限的代码和检查权限的方法。

我通常发现框架中的“提供者”适用于一小部分应用程序，但无法满足大多数需求。等到你完全按照自己的意愿来写它们时，从头开始写会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T17:30:26.257

老实说，这可能不是一个很好的解决方案，但它可能有助于产生其他一些想法。

我的角色是所有可能的权限组合：

```
Worker, Employee, Guest, Admin, WorkerEmployee, etc 
```

在我的代码中，我有一个单独权限的枚举

```
[Flags]
public enum RolePermissions
{
    Guest = 1,
    Worker = 2,
    Employee = 4,
    Admin = 8
} 
```

我有一个与数据库中的角色相对应的枚举。整数值是权限的按位或：

```
public enum AvailableRoles
{
    None = 0,
    Guest = RolePermissions.Guest, //1
    Worker = RolePermissions.Worker, // 2
    Employee = RolePermissions.Employee, // 4
    WorkerEmployee = RolePermissions.Worker | RolePermissions.Employee, // 6
    Admin = RolePermissions.Admin, // 8
} 
```

然后有一组方法可以用来查找权限等等：

```
// Used to determine if the currently logged in user has a particular permission (Guest, Worker, Employee, Admin)
public static bool UserHasPermission( RolePermissions rolePermssion )
{
    foreach( string role in Roles.GetRolesForUser() )
    {
        AvailableRoles availableRole = Parse( role );

        if( ( (RolePermissions)availableRole & rolePermssion ) == rolePermssion )
            return true;
    }

    return false;
}

// Used to determine whether the currently logged in user is in a specific role
public static bool UserIsInRole( AvailableRoles requestedRole )
{
    return UserIsInRole( Membership.GetUser().UserName, requestedRole );
}

// Used to determine whether a specific user is in a specific role
public static bool UserIsInRole( string username, AvailableRoles requestedRole )
{
    foreach( string role in Roles.GetRolesForUser( username ) )
    {
        AvailableRoles actualRole = Parse( role );

        if( actualRole == requestedRole )
            return true;
    }

    return false;
}

// Helper method to parse enum
private static AvailableRoles Parse( string role )
{
    return (AvailableRoles)Enum.Parse( typeof( AvailableRoles ), role );
} 
```

如果您想出更好的方法或进行改进，请告诉我，以便我可以将其合并到我自己的代码中。:-)

# c# - Linq 查询的数据库响应时间异常缓慢

> ID：452296
> 
> 赞同：1
> 
> 时间：2009-01-16T22:35:48.563
> 
> 标签：c#, sql-server, linq

我已经编写了我认为非常可靠的 Linq 语句，但是执行时需要 2 到 5 秒的等待时间。有人对如何加快速度有想法吗？

```
 t.states = (from s in tmdb.tmZipCodes
                        where zips.Contains(s.ZipCode) && s.tmLicensing.Required.Equals(true)
                        group s by new Licensing { 
                            stateCode = s.tmLicensing.StateCode,
                            stateName = s.tmLicensing.StateName,
                            FIPSCode = s.tmLicensing.FIPSCode,
                            required = (bool)s.tmLicensing.Required,
                            requirements = s.tmLicensing.Requirements,
                            canWorkWhen = s.tmLicensing.CanWorkWhen,
                            appProccesingTime = (int) s.tmLicensing.AppProcessingTime 
                        }
                            into state
                            select state.Key).ToList(); 
```

我已将其更改为两阶段查询，该查询通过执行不同的查询以使我的分组工作几乎立即运行，但在我看来，运行速度比单个查询快得多有点违反直觉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T22:42:34.323

我不确定为什么要花这么长时间，但看看[LINQPad](http://www.linqpad.net/)可能会有所帮助，它会向您展示正在生成的实际查询并帮助优化。

此外，它可能不是需要很长时间的实际查询，它可能是查询生成。我发现最长的部分是 linq 被转换为 sql 语句的时候。

您可以使用已编译的查询来加快 sql 生成过程。可以在[3devs](http://www.3devs.com/?p=3)上找到一些信息。我不是想推广我的博客条目，但我认为它适合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T23:17:50.850

我希望这无关紧要，但是

```
s.tmLicensing.Required.Equals(true) 
```

看起来很多（对我来说）像：

```
s.tmLicensing 
```

假设它是一个布尔属性。

鉴于您知道这是真的，我也不认为将它放在分组中没有多大意义。

说了这些话，John Boker 在这两点上都是绝对正确的：找出是 SQL 还是 LINQ，然后攻击相关位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T14:38:00.040

您似乎没有使用该组，只是在最后选择了密钥。那么，这是否与您想要的相同？

```
t.states = (from s in tmdb.tmZipCodes
            where zips.Contains(s.ZipCode) && s.tmLicensing.Required.Equals(true)
            select new Licensing { 
                stateCode = s.tmLicensing.StateCode,
                stateName = s.tmLicensing.StateName,
                FIPSCode = s.tmLicensing.FIPSCode,
                required = (bool)s.tmLicensing.Required,
                requirements = s.tmLicensing.Requirements,
                canWorkWhen = s.tmLicensing.CanWorkWhen,
                appProccesingTime = (int) s.tmLicensing.AppProcessingTime 
            }).Distinct().ToList(); 
```

还要记住，LINQ 在必须执行查询之前不会执行查询。因此，如果您在两个语句中构建查询，则在调用 ToList 之前，它将不会针对数据上下文（在本例中为 SQL Server）执行该查询。当查询运行时，它会将多个查询合并为一个查询并执行该查询。

# code-completion - 代码完成/智能感知选项

> ID：452298
> 
> 赞同：1
> 
> 时间：2009-01-16T22:37:04.287
> 
> 标签：code-completion

因此，我多年来一直在使用 Visual Studio，并且已经完全习惯了 Intellisense。然而，在我的新工作中，我一直在使用 Xcode，它做了一些 Intellisense 没有做的事情。

例如，Xcode 在检查之前会扩展宏，所以（好吧，我在这里仅使用单例进行演示）

```
#define INST class::getInstance()

INST->method(); 
```

`method()`将被 Xcode 正确检测，但不能被 VS 检测到。

所有这一切都是为了：最好的代码完成工具是什么？它在什么程序上运行（VS、Emacs、Eclipse...）？是什么让它如此方便？而且，如果它是一个插件，从哪里得到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T22:40:36.447

我见过的最好的 C++ 代码完成是[Visual Assist X](http://www.wholetomato.com/)附带的，它是 Visual Studio 的一个插件（不幸的是不是免费的）。我尝试了其他一些类似的 VS 插件，但没有一个完全符合标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-15T20:42:56.293

我将不得不使用 Visual Studio 2010 Beta 2。*这*是一些令人印象深刻的 C++ IntelliSense。

# python - Python object.__repr__(self) 应该是一个表达式？

> ID：452300
> 
> 赞同：77
> 
> 时间：2009-01-16T22:37:18.077
> 
> 标签：python

我正在查看[Python 文档](http://docs.python.org/reference/datamodel.html#objects-values-and-types)中的内置对象方法，并且对`object.__repr__(self)`. 它是这样说的：

> 由 repr() 内置函数和字符串转换（反引号）调用，以计算对象的“官方”字符串表示。如果可能的话，这应该看起来像一个有效的 Python 表达式，可用于重新创建具有相同值的对象（给定适当的环境）。如果这不可能，则应返回 <...一些有用的描述...> 形式的字符串。返回值必须是字符串对象。如果一个类定义了**repr** () 但没有定义**str** ()，那么当需要该类实例的“非正式”字符串表示时，也会使用**repr ()。**
> 
> 这通常用于调试，因此表示信息丰富且明确是很重要的

对我来说最有趣的部分是...

> 如果可能的话，这应该看起来像一个有效的 Python 表达式，可用于重新创建具有相同值的对象

...但我不确定这到底是什么意思。它说它应该*看起来*像一个可以用来重新创建对象的表达式，但这是否意味着它应该只是你可以使用的那种表达式的一个例子，或者它应该是一个可以执行的实际表达式（eval等..）重新创建对象？或者......是否应该只是为了纯粹的信息目的而对所使用的实际表达进行重新设计？

总的来说，我对我应该在这里放什么感到有点困惑。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-16T22:41:37.180

```
>>> from datetime import date
>>>
>>> repr(date.today())        # calls date.today().__repr__()
'datetime.date(2009, 1, 16)'
>>> eval(_)                   # _ is the output of the last command
datetime.date(2009, 1, 16) 
```

输出是一个字符串，可以由 python 解释器解析并产生一个相等的对象。

如果这不可能，它应该以 . 的形式返回一个字符串`<...some useful description...>`。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-16T22:42:22.420

它应该是一个 Python 表达式，当 eval'd 时，它会创建一个具有与此完全相同的属性的对象。例如，如果您有一个`Fraction`包含两个整数、一个分子和一个分母的类，您的`__repr__()`方法将如下所示：

```
# in the definition of Fraction class
def __repr__(self):
    return "Fraction(%d, %d)" % (self.numerator, self.denominator) 
```

假设构造函数采用这两个值。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-17T14:42:03.183

**指南：**如果您可以简洁地提供*精确的表示*，**请将其格式化为 Python 表达式**（这意味着它可以在正确的上下文中进行评估和直接复制到源代码中）。如果提供*不精确的表示*，请**使用`<...>`format**。

任何值都有许多可能的表示形式，但 Python 程序员最感兴趣的一种是重新创建值的表达式。请记住，**了解 Python 的人是目标受众**——这也是为什么不精确的表示应该包含相关上下文的原因。即使是 default `<XXX object at 0xNNN>`，虽然几乎完全没用，但仍然提供类型，`id()`（以区分不同的对象），并指示没有更好的表示可用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-17T03:16:28.247

“但这是否意味着它应该只是你可以使用的那种表达式的一个例子，或者它应该是一个实际的表达式，可以执行（eval 等）来重新创建对象？或者......它应该是只是为了纯粹的信息目的而对实际使用的表达进行了重新设计？”

哇，这真是令人费解。

1.  “您可以使用的那种表达式的示例”不会是特定对象的表示。那不可能是有用的或有意义的。

2.  “可以......重新创建对象的实际表达式”和“用于[创建对象]的实际表达式的重新定义”之间有什么区别？两者都是创建对象的表达式。这些之间没有实际区别。repr 调用可以生成新表达式或原始表达式。在许多情况下，它们是相同的。

请注意，这并不总是可能的、实际的或可取的。

在某些情况下，您会注意到 repr() 提供的字符串显然*不是*任何类型的表达式。您定义的任何类的默认 repr() 都不能用作表达式。

在某些情况下，对象之间可能存在相互（或循环）引用。那种错综复杂的层次结构的 repr() 是没有意义的。

在许多情况下，对象是通过解析器增量构建的。例如，来自 XML 或 JSON 之类的。代表会是什么？原始 XML 还是 JSON？显然不是，因为它们不是 Python。它可能是一些生成 XML 的 Python 表达式。但是，对于一个巨大的 XML 文档，可能无法编写一个与解析 XML 功能等效的 Python 表达式。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-13T01:39:20.697

“repr”表示代表。首先，我们创建一个类坐标的实例。

```
x = Coordinate(3, 4) 
```

然后如果我们将 x 输入到控制台，输出是

```
<__main__.Coordinate at 0x7fcd40ab27b8> 
```

如果你使用 repr()：

```
>>> repr(x)
Coordinate(3, 4) 
```

输出与 'Coordinate(3, 4)' 相同，除了它是一个字符串。您可以使用它来重新创建坐标实例。

总之，repr() 方法是打印出一个字符串，它是对象的表示。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-03-28T03:20:13.373

要查看 repr 在类中的工作方式，请运行以下代码，首先使用 repr 方法，然后不使用**repr**方法。

```
class Coordinate (object):
    def __init__(self,x,y):
        self.x = x
        self.y = y

    def getX(self):
        # Getter method for a Coordinate object's x coordinate.
        # Getter methods are better practice than just accessing an attribute directly
        return self.x
    def getY(self):

        # Getter method for a Coordinate object's y coordinate
        return self.y

    def __repr__(self):  #remove this and the next line and re-run
        return 'Coordinate(' + str(self.getX()) + ',' + str(self.getY()) + ')' 

>>>c = Coordinate(2,-8)
>>>print(c) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-22T09:44:21.217

我认为这里的混乱源于英语。我的意思是`__repr__()`；我猜测的值的“表示”的缩写，就像@S.Lott 说的那样

> ““一个可以……重新创建对象的实际表达式”和“对用于[创建对象]的实际表达式的重新定义”之间有什么区别？两者都是创建对象的表达式。没有“

但在某些情况下，它们可能会有所不同。例如; 坐标点，您可能想要`c.coordinate`返回：`3,5`但`c.__repr__`要返回`Coordinate(3, 5)`. 希望这更有意义...

# python - 使用 Python 进行 Web 编程有什么好处？

> ID：452305
> 
> 赞同：10
> 
> 时间：2009-01-16T22:38:56.420
> 
> 标签：python, programming-languages

是什么让 Python 在 Web 开发中脱颖而出？有哪些在网络上非常成功地使用 Python 的例子？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-16T22:45:56.920

[恕我直言， Django](http://www.djangoproject.com/)是使用 Python 的主要好处之一。为你的领域建模，为你的类编码，瞧，你的 ORM 就完成了，你可以专注于 UI。使用内置的模板语言（或您也可以使用的许多其他模板语言中的一种）添加模板的易用性，并且立即启动有效的 Web 应用程序变得*非常*容易。投入内置的管理界面，这很容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T22:42:54.697

当然，在网络上成功使用 Python 的一种方法是[Google App Engine](http://code.google.com/appengine/)。网站作者使用 Python（稍微受限的子集）编写代码，然后由 App Engine 服务器以分布式和可扩展的方式执行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T23:26:08.133

[关于 Python 的名言](http://www.python.org/about/quotes/)：

> “对于我们的网站来说，Python 的速度足够快，并且允许我们用最少的开发人员在创纪录的时间内生成可维护的功能，” [YouTube.com](http://youtube.com)软件架构师 Cuong Do 说。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T14:35:02.310

YouTube 使用了大量 Python，并且可能是 Python 成功故事的最佳示例。

Django 成功故事的一个很好的例子是华盛顿邮报，它最近分享了他们开发的应用程序的大列表：

[http://push.cx/2009/washington-post-update](http://push.cx/2009/washington-post-update)

[www.lawrence.com](http://www.lawrence.com/)和[www.ljworld.com](http://www.ljworld.com/)是最早使用 Django 的两个站点（甚至在开源之前）。

[djangositeoftheweek.com](http://djangositeoftheweek.com/)有很多很好的案例研究。

[www.everyblock.com](http://www.everyblock.com/)是另一个很好的例子。

最后，[http://www.djangosites.org/](http://www.djangosites.org/)链接到近 2,000 个其他 Django 支持的站点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T23:52:11.030

简短的回答：随时可用的工具的多样性和选择的自由。

这听起来像是一个简单的问题，但实际上并非如此。[虽然 Python 非常适合 Web 开发，而著名的Google App Engine](http://code.google.com/appengine/)、[Plone](http://plone.org/)和[Django](http://www.djangoproject.com/)已经证明了这一点。必须指出的是，Python 的开发方式比[PHP](http://www.php.net/)需要更多的开发人员，但它也为混合提供了更多。

实际生产某些东西的入门水平更高。这是因为有很多不同的工具可以使用 Python 进行 Web 开发。对于没有经验的开发人员来说，选择 Web 开发框架可能是一个艰难的决定。

拥有许多不同的工具是一把两刃剑。在某种程度上，它给你带来了选择你可能想要的一个的自由，但是你又如何真正知道哪一个对你正在做的事情有好处。这让我明白了我的观点。Python 因没有标准或事实上的 Web 开发库而脱颖而出。虽然这几乎违背了只有一种简单的处理方式的原则，但它也为我们带来了具有不同设计选择的各种不同的工具。起初这可能会让人感到非常沮丧，因为如果有人为您做出选择会容易得多，但现在您必须做出选择，您实际上可能不得不考虑您正在做什么以及适合什么。......或者你可能最终会选择一个并在你之后吹掉你的头' 已经意识到你做出了错误的选择。无论如何，你最终，你已经做出了选择，没有其他人。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-19T10:18:39.967

此外，

Python 在网络、数据分析和机器学习方面都很强大。例如 scikit、sci-py 和 numpy 都非常强大。在某些情况下，将这两个元素放在同一台服务器上可能会非常有趣。

例如[http://rankmytweet.com 经常](http://rankmytweet.com)使用这个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-16T22:47:28.197

[trac](http://trac.edgewall.org/) (bug tracker) 和[moinmoin](http://moinmo.in/) (wiki) 都是基于网络的 Python 工具，我觉得它们非常宝贵。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-16T22:59:52.820

GNU Mailman 是另一个用 python 编写的项目，它获得了广泛的成功。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-17T01:12:28.200

正如许多人所指出的，Django 是使用 Python 的一个很好的理由......所以为了弄清楚为什么 Python 非常适合 Web 开发，最好的办法是看看它为什么是构建像 Django 这样的框架的好语言.

恕我直言，Python 结合了任何语言中最简洁的元编程模型，或者至少是其中一种最简洁的元编程模型，以及非常纯粹的面向对象。这不仅使编写易于使用的极其通用的抽象成为可能，而且还允许抽象与其他抽象相对干净地组合。这在采用基于代码生成的元编程方法的语言（例如 Ruby）中更难做到。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-16T22:59:19.390

由于开发速度快，动态语言通常对 Web 应用程序有利。与大多数 Python 相比，Python 尤其具有两个优点：

*   “包括电池”意味着*许多*可用的库
*   姜戈。对我来说，这是我使用 Python 而不是 Lua（我更喜欢它）的唯一原因。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-16T23:16:55.143

除了框架...

*   Python 对 Unicode 的普遍支持应该使 i18n 更加流畅。
*   一个健全的命名空间系统使调试变得更好，因为它通常更容易找到定义事物的位置。
*   Python 无法作为独立的模板语言运行应该会阻止 HTML 与模型代码的混合
*   很棒的标准库

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-16T23:22:47.003

Python 网站的其他示例包括 Reddit 和 YouTube。

# asp.net - Web 服务器更改名称，url 返回错误的主机名

> ID：452322
> 
> 赞同：0
> 
> 时间：2009-01-16T22:44:13.383
> 
> 标签：asp.net, iis, hostname

在我们的 Web 应用程序 (asp.net) 中，选项卡是动态链接。链接是这样构建的：

```
finalUrl = "https://" + Request.Url.Host + "/home.aspx"; 
```

该链接最终如下：

```
https://server0/home.aspx 
```

问题是 Web 服务器的名称是 server0，但现在它已更改为 server1。旧的服务器名称仍然出现。谁能帮忙指出我们错过的地方？

（etc/hosts 设置正确）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T23:15:20.857

我可以假设您不使用[相对 URL](http://www.webreference.com/html/tutorial2/3.html)是有充分理由的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T23:05:44.243

如果使用 asp.net 作为标记，您不会考虑使用**HttpRequest.ApplicationPath**吗？（使用 System.Web）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T23:07:30.217

该网站是否仍可通过旧 URL 访问？该属性基于输入的 URL，而不是它所在的服务器的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T23:13:34.010

鸽子，我做了一些简化。该选项卡将指向同一台机器上的另一个虚拟目录。

约翰，不，它不能通过旧主机名访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T23:47:48.653

使用类似 FireBug for FireFox 的程序来查看请求标头。然后打开您的网络浏览器并转到您的应用程序。打开 FireBug 上的 Net 选项卡以查看请求值。例如，在这个网站上，我可以看到：

```
Host stackoverflow.com
User-Agent Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.5) Gecko/2008120122 Firefox/3.0.5 (.NET CLR 3.5.30729)
Accept text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
... 
```

因此，我希望 Request.Url.Host 将是“stackoverflow.com”。

作为旁注，您绝对应该考虑使用 ~/ 绝对路径选项，一个简短的示例：

```
string finalUrl = "~/home.aspx";
Response.Redirect(finalUrl); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T00:13:12.003

不使用相对 url 可能有充分的理由。我不是最初的开发者。只是代码在任何地方都可以工作，包括生产服务器，但只有这台机器。只是想深入了解它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T17:56:38.417

在引用“Request.Url.Host”时，主机名已经改回旧服务器。

我发现问题出在 Metabase.xml 中，如果使用相对 url，则从中提取主机。那么后面对“Request.Url.Host”的引用就会体现出这个值。

# pdf-generation - 支持渐变填充的 PDF 生成库

> ID：452323
> 
> 赞同：0
> 
> 时间：2009-01-16T22:45:35.080
> 
> 标签：pdf-generation

是否有任何库（python、.net、c++ 等）可以生成 PDF 库，其中还包括渐变着色等功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T23:29:55.257

[iText](http://www.lowagie.com/iText/) [可以](http://itextdocs.lowagie.com/tutorial/directcontent/colors/index.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:18:27.197

有几种不同类型的渐变填充：线性、径向等。

你希望达到什么样的效果？

快速 PDF 库仅支持线性（轴向）渐变： [http ://www.quickpdflibrary.com/help/quickpdf/NewRGBAxialShader.php](http://www.quickpdflibrary.com/help/quickpdf/NewRGBAxialShader.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T22:54:08.603

[PDFSharp http://www.pdfsharp.com/](http://www.pdfsharp.com/)似乎有能力。请参阅[示例 pdf](http://pdfsharp.com/PDFsharp/images/stories/samples/PDFs/Graphics.pdf)：

# asp.net - 免费的asp.net颜色选择器控件

> ID：452325
> 
> 赞同：9
> 
> 时间：2009-01-16T22:46:14.550
> 
> 标签：asp.net, color-picker, web-controls

任何人都可以为 asp.net webforms 推荐一个免费的颜色选择器 web 控件吗？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-05-28T01:21:51.597

并非所有浏览器都[支持](http://caniuse.com/#feat=input-color)它，但您可以使用 HTML 5 颜色输入：

```
<input type="color" name="favcolor" value="#ff0000">
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-16T23:09:45.593

使用任意数量的 jQuery 插件来填充文本框。这里有两个：

*   [法宝](http://acko.net/dev/farbtastic)
*   [选色器](http://www.eyecon.ro/colorpicker/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T23:10:33.453

这个不错：[http ://www.karpach.com/ColorPickerDemo.aspx](http://www.karpach.com/ColorPickerDemo.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-16T22:10:42.657

```
@Html.EditorFor(model => model.Color, new { htmlAttributes = new { @class = "form-control", required = "required", type = "color", style = "width:40px;padding:0;" } }) 
```

# c# - 停止监听 Socket 的正确方法

> ID：452327
> 
> 赞同：22
> 
> 时间：2009-01-16T22:47:03.657
> 
> 标签：c#, sockets

我有一个监听套接字连接的服务器：

```
public class Server
{
    private Socket _serverSocket;

    public Server()
    {
        _serverSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        _serverSocket.Bind(new IPEndPoint(IPAddress.Any, 1234));
        _serverSocket.Listen(1);
    }

    public void Start()
    {
        _serverSocket.BeginAccept(HandleAsyncConnectionMethod, null);
    }

    public void Stop()
    {
        //????? MAGIC ?????
    }

    //... rest of code here
} 
```

关闭套接字的正确（干净）方法是什么？

是否足以调用：

```
_serverSocket.Disconnect(true); 
```

在 Stop() 方法中？还是需要进行其他工作才能干净地关闭连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T23:20:44.870

TCP 连接终止正确地涉及四次握手。您希望两端都通知对方他们正在关闭，然后确认对方的关闭。

维基百科解释了这个过程：[http ://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination)

这篇文章解释了如何在 C# 中实现它：http: [//vadmyst.blogspot.com/2008/04/proper-way-to-close-tcp-socket.html](http://vadmyst.blogspot.com/2008/04/proper-way-to-close-tcp-socket.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-10T17:53:50.843

2种方法来正确关闭它，没有例外

1）创建临时连接套接字并将其连接到侦听套接字，以便它可以触发其处理程序，然后使用正常的 EndAccept 完成它，然后关闭两者。

2）只是关闭（0）监听套接字，这将导致对其回调的错误拍摄，如果你再查看你的监听套接字，你会看到它的状态是“关闭”和“处置”。这就是调用 EndAccept 会导致异常的原因。你可以忽略它，不要调用 EndAccept。侦听套接字将立即关闭而不会超时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T23:03:50.113

由于您正在侦听传入的 TCP 连接，因此您可以使用[System.Net.Sockets.TcpListener](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)，它确实具有 Stop() 方法。但是它没有异步操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-19T10:30:47.340

立即让 Accept 呼叫中断的最简洁方法是调用 _serverSocket.Dispose(); 对 Shutdown 或 Disconnect 等方法的任何其他调用都会引发异常。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-17T00:23:08.707

首先，您需要确保跟踪在 BeginAccept 过程中创建的所有客户端套接字。首先使用 Socket.Shutdown() 和 Socket.Close() 方法关闭它们。一旦这些都被关闭，然后在监听套接字本身上做同样的事情。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-16T22:58:09.253

那*应该可以*处理它......但是如果你需要绝对确定，你总是可以用火杀死它：

[不适用于套接字，但同样的想法也适用。](http://www.codinghorror.com/blog/archives/001211.html)，也就是以各种可能的方式关闭它，然后最后将套接字设置为空。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-16T23:23:08.920

您应该使用[Socket.Shutdown()](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.shutdown.aspx)然后[Socket.Close()](http://msdn.microsoft.com/en-us/library/wahsac9k.aspx)。Socket.Disconnect() 通常仅在您打算重新连接同一个套接字时使用。

# user-interface - 如何在 Qt 中保持小部件的纵横比？

> ID：452333
> 
> 赞同：35
> 
> 时间：2009-01-16T22:50:35.803
> 
> 标签：user-interface, qt, widget, aspect-ratio

如何在 Qt 中保持小部件的纵横比以及如何使小部件居中？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-07-21T17:08:48.103

您不必实现自己的布局管理器。您可以继承`QWidget`和重新实现

```
int QWidget::heightForWidth( int w ) { return w; } 
```

保持方正。但是，`heightForWidth()`它不适用于 X11 的顶级窗口，因为显然 X11 协议不支持它。至于居中，可以`Qt::AlignCenter`作为 的第三个参数`QBoxLayout::addWidget()`或 的第五个参数传递`QGridLayout::addWidget()`。

**注意：**至少在 Qt 的较新版本中， QWidget 不再具有`heightForWidth`or `widthForHeight`（因此它们不能被覆盖），因此`setWidthForHeight(true)`or`setHeightForWidth(true)` [仅对 QGraphicsLayout 的后代有影响](http://doc.qt.io/qt-5/qsizepolicy.html#setWidthForHeight)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-18T19:29:50.197

正确的答案是创建您的自定义布局管理器。这可以通过[继承 QLayout](http://doc.trolltech.com/qlayout.html)来实现。

## 子类化 QLayout 时实现的方法

[void addItem(QLayoutItem* item);](http://doc.trolltech.com/qlayout.html#addItem)

将项目添加到布局。

[int count() 常量；](http://doc.trolltech.com/qlayout.html#count)

返回项目计数。

[QLayoutItem* itemAt(int index) const;](http://doc.trolltech.com/qlayout.html#itemAt)

返回索引处的项目引用，如果没有则返回 0。

[QLayoutItem* takeAt(int index);](http://doc.trolltech.com/qlayout.html#takeAt)

从索引的布局中获取并返回项目，如果没有则返回 0。

[Qt::方向扩展方向（）常量；](http://doc.trolltech.com/qlayout.html#expandingDirections)

返回布局扩展方向。

[bool hasHeightForWidth() 常量；](http://doc.trolltech.com/qlayoutitem.html#hasHeightForWidth)

告诉布局是否处理宽度计算的高度。

[QSize minimumSize() 常量；](http://doc.trolltech.com/qlayout.html#minimumSize)

返回布局的最小尺寸。

[void setGeometry(const QRect& rect);](http://doc.trolltech.com/qlayoutitem.html#setGeometry)

设置布局的几何形状和其中的项目。在这里，您必须保持纵横比并进行居中。

[QSize sizeHint() 常量；](http://doc.trolltech.com/qlayoutitem.html#sizeHint)

返回布局的首选大小。

## 进一步阅读

*   [在 Qt 中维护一个小部件的方形形式 @诺基亚论坛](http://wiki.forum.nokia.com/index.php/CS001309_-_Maintaining_square_form_for_a_widget_in_Qt)
*   [在 Qt @ Forum Nokia 中实现布局管理器](http://wiki.forum.nokia.com/index.php/CS001308_-_Implementing_a_layout_manager_in_Qt)
*   [编写自定义布局管理器@Qt 文档](http://doc.trolltech.com/layout.html#writing-custom-layout-managers)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-17T00:13:34.437

`resize()`从内部调用`resizeEvent()`对我来说从来都不是很好 - 充其量它会导致闪烁，因为窗口被调整了两次（就像你一样），最坏的情况是无限循环。

我认为保持固定纵横比的“正确”方法是创建自定义布局。您只需要重写两个方法，`QLayoutItem::hasHeightForWidth()`并且`QLayoutItem::heightForWidth()`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-05-04T10:19:41.860

我也试图达到要求的效果：一个保持固定纵横比的小部件，同时保持在其分配空间的中心。起初我尝试了这个问题的其他答案：

*   实施`heightForWidth`并`hasHeightForWidth`按照 marc-mutz-mmutz 的建议对我根本不起作用。
*   我简要地研究了实现一个自定义布局管理器，但是 Bleadof 的所有链接都失效了，当我找到[文档](https://doc.qt.io/qt-5/qlayout.html#details)并通读它时，它看起来对我想要实现的目标来说太复杂了。

我最终创建了一个自定义小部件，该小部件响应[`resizeEvent`](https://doc.qt.io/qt-5/qwidget.html#resizeEvent)并用于[`setContentsMargin`](https://doc.qt.io/qt-5/qwidget.html#setContentsMargins)设置边距，以便剩余内容区域保持所需的比例。

我发现我还必须将小部件的大小策略设置为`QSizePolicy::Ignored`双向，以避免因子小部件的大小请求而导致奇怪的大小调整问题——最终结果是我的小部件接受其父级分配给它的任何大小（然后设置其边距如上所述，以在其内容区域中保持所需的纵横比）。

我的代码如下所示：

```
from PySide2.QtWidgets import QWidget, QSizePolicy

class AspectWidget(QWidget):
    '''
    A widget that maintains its aspect ratio.
    '''
    def __init__(self, *args, ratio=4/3, **kwargs):
        super().__init__(*args, **kwargs)
        self.ratio = ratio
        self.adjusted_to_size = (-1, -1)
        self.setSizePolicy(QSizePolicy(QSizePolicy.Ignored, QSizePolicy.Ignored))

    def resizeEvent(self, event):
        size = event.size()
        if size == self.adjusted_to_size:
            # Avoid infinite recursion. I suspect Qt does this for you,
            # but it's best to be safe.
            return
        self.adjusted_to_size = size

        full_width = size.width()
        full_height = size.height()
        width = min(full_width, full_height * self.ratio)
        height = min(full_height, full_width / self.ratio)

        h_margin = round((full_width - width) / 2)
        v_margin = round((full_height - height) / 2)

        self.setContentsMargins(h_margin, v_margin, h_margin, v_margin) 
```

（显然，这段代码是用 Python 编写的，但用 C++ 或您选择的语言表达应该很简单。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-09-29T15:58:10.663

在我的情况下，覆盖 heightForWidth() 不起作用。而且，对于某些人来说，获得使用调整大小事件的工作示例可能会有所帮助。

首先子类 qObject 来创建过滤器。[有关事件过滤器的更多信息。](http://doc.qt.io/qt-5/eventsandfilters.html#event-filters "Qt 文档。")

```
class FilterObject:public QObject{
public:
    QWidget *target = nullptr;//it holds a pointer to target object
    int goalHeight=0;
    FilterObject(QObject *parent=nullptr):QObject(parent){}//uses QObject constructor
    bool eventFilter(QObject *watched, QEvent *event) override;//and overrides eventFilter function
}; 
```

然后是eventFilter函数。它的代码应该在 FilterObject 定义之外定义以防止警告。[感谢这个答案。](https://stackoverflow.com/q/28786473/8366223 "没有离线的虚拟方法定义")

```
bool FilterObject::eventFilter(QObject *watched, QEvent *event) {
    if(watched!=target){//checks for correct target object.
        return false;
    }
    if(event->type()!=QEvent::Resize){//and correct event
        return false;
    }

    QResizeEvent *resEvent = static_cast<QResizeEvent*>(event);//then sets correct event type

    goalHeight = 7*resEvent->size().width()/16;//calculates height, 7/16 of width in my case
    if(target->height()!=goalHeight){
        target->setFixedHeight(goalHeight);
    }

    return true;
}; 
```

然后在主代码中创建 FilterObject 并将其设置为目标对象的 EventFilter 侦听器。[感谢这个答案。](https://stackoverflow.com/a/22785594/8366223 "在 QT 中安装事件过滤器")

```
FilterObject *filter = new FilterObject();
QWidget *targetWidget = new QWidget();//let it be target object
filter->target=targetWidget;
targetWidget->installEventFilter(filter); 
```

现在过滤器将接收所有 targetWidget 的事件并在调整大小事件时设置正确的高度。

# apache-flex - Flex：确定组件是否正在显示

> ID：452344
> 
> 赞同：11
> 
> 时间：2009-01-16T22:56:50.720
> 
> 标签：apache-flex, flash, events, components

确定 Flex/Flash 中的组件是否显示在用户屏幕上的最佳方法是什么？我正在寻找 Java 的[Component.isShowing()](http://web.archive.org/web/20100604045251/http://java.sun.com:80/j2se/1.4.2/docs/api/java/awt/Component.html)方法的类似物。

和事件触发可见性`show`，`hide`这似乎适用于 ViewStack 组件的第一个后代，但不适用于显示树的下方。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T20:28:11.723

...或避免递归：

```
public static function isVisible(obj:DisplayObject):Boolean
{
    while (obj && obj.visible && obj !== Application.application)
    {
        obj = obj.parent;
    }
    return obj && obj.visible;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T06:22:27.617

您想检查组件属性 visible 是否为真，这适用于 DisplayList 中组件的所有父项，对吗？

```
public static function isVisible(c : UIComponent) : Boolean {
    if (c == null) return false;
    if (c is Application) return c.visible;
    return c.visible && isVisible(c.parent);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T23:46:20.513

UIComponent.visible 不一定对可见 = false 的对象的子对象有效。从文档：

“在任何一种情况下，对象的孩子都不会发出显示或隐藏事件，除非该对象专门编写了一个实现来这样做。”

我编写了一个示例应用程序来确认这是真的。你可以做的是在显示列表中检查 parent 上的 visible 是否为假。基本上“可见”会给出误报，但不应给出误报。这是我整理的一个快速实用程序：

```
package
{
    import flash.display.DisplayObject;

    import mx.core.Application;

    public class VisibilityUtils
    {
        public static function isDisplayObjectVisible(obj : DisplayObject) : Boolean {
            if (!obj.visible) return false;
            return checkDisplayObjectVisible(obj);
        }

        private static function checkDisplayObjectVisible(obj : DisplayObject) : Boolean {
            if (!obj.parent.visible) return false;
            if (obj.parent != null && !(obj.parent is Application))
                return checkDisplayObjectVisible(obj.parent);
            else
                return true;
        }
    }
} 
```

我没有做任何比这更琐碎的测试，但它应该让你开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T23:51:41.733

看起来很奇怪，既然你提到了它，我不相信有一个简单的测试来确定组件在 Component.isShowing() 所暗示的意义上是否真的在屏幕上可见。

默认情况下显示和隐藏事件也不会冒泡，因此如果您想在 ViewStack 容器的后代中收到可见性更改的通知，您需要明确地监听它们。实现细节会根据你所追求的行为而有所不同，但举个简单的例子：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">
    <mx:VBox>
        <mx:HBox>
            <mx:Button id="btn1" click="vs.selectedIndex = 0" label="Show 1" />
            <mx:Button id="btn2" click="vs.selectedIndex = 1" label="Show 2" />
        </mx:HBox>
        <mx:ViewStack id="vs" selectedIndex="0">
            <mx:Panel id="panel1">
                <mx:Label id="label1" text="Label 1" show="trace('showing label 1')" hide="trace('hiding label 1')" visible="{panel1.visible}" />
            </mx:Panel>
            <mx:Panel id="panel2">
                <mx:Label id="label2" text="Label 2" show="trace('showing label 2')" hide="trace('hiding label 2')" visible="{panel2.visible}" />
            </mx:Panel>
        </mx:ViewStack>
    </mx:VBox>
</mx:Application> 
```

...一旦它们的可见属性绑定到它们的父面板，你就会看到每个标签的显示和隐藏事件。希望这能说明这一点；您可以扩展它，但最适合您的应用程序。祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-15T12:14:03.760

我试图以可重用的方式获得相同的东西。我几乎找到了一种使用 getObjectsUnderPoint() 的方法 - 这会返回一个特定点下的对象，z-ordered（即使它们不是兄弟姐妹，例如 ViewStack、Popups、ecc .)。

基本上，我在舞台的特定点下获得最顶层的显示对象，然后在显示对象层次结构中向上查找测试对象。如果我找到它，则该对象是可见的（层次结构中不可见的对象应该已经被 getObjectsUnderPoint 调用过滤掉了）。

这里的问题是您必须使用对象的不透明点（在我的情况下，由于边框更圆，我使用了 5 个像素的偏移量），否则此函数将不会拾取它。

有什么改进它的想法吗？

科斯玛

```
public static function isVisible(object:DisplayObject):Boolean  {
    var point:Point = object.localToGlobal(new Point(5, 5));
    var objects:Array = object.stage.getObjectsUnderPoint(point);
    if (objects.length > 0) {
        if (isDescendantOf(object, objects[objects.length - 1] as DisplayObject)) {
            return true;
        }
    }
    return false;
}

public static function isDescendantOf(parent:DisplayObject, child:DisplayObject):Boolean  {
    while (child.parent != null) {
        if (child.parent === parent) {
            return true;
        } else {
            child = child.parent;
        }
    }
    return false;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-22T17:21:36.890

这就是你真正需要的。“Application.application”检查是徒劳的。

```
 /**
         * Returns `true` if this component is actually shown on screen currently. This could be false even with
         * "visible" set to `true`, because one or more parents could have "visible" set to `false`.
         */
        public static function isShowing (c : DisplayObject) : Boolean {
            while (c && c.visible && c.parent) {
                c = c.parent;
            }
            return c.visible;
        } 
```

# php - WordPress：用于构建用户手册的有用插件？

> ID：452355
> 
> 赞同：0
> 
> 时间：2009-01-16T22:59:32.370
> 
> 标签：php, wordpress, documentation

有哪些推荐的 WordPress 插件可以使构建在线用户手册更有效？我一直在浏览插件目录，但想知道是否有人已经走过这条路并可以提出一些建议。

编辑：哇！直到收到这些回复，我才想到使用 wiki！我开始使用 WordPress 建立一个网站，似乎我有点“隧道视野”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T00:11:45.797

dokuwiki 等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T00:08:07.037

MediaWiki 非常易于使用，我认为这将为用户手册提供一个比 wordpress 更好的平台。Wordpress 可能擅长作为前端 CMS，但它根本不能很好地处理广泛的页面网络。

**编辑**- 我运行了几个不同的 MediaWiki 安装，它们与 Wordpress（我用于我的博客）一样容易维护，甚至更容易维护

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T00:02:48.373

使用博客软件制作用户手册似乎非常不合常规。您是否考虑过改用 wiki 软件？例如，MediaWiki，它也是用 PHP 编写的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T00:15:00.500

我同意 thaBadDawg 的观点。WordPress 使用单个下拉列表来允许您为当前页面选择父页面（因此是层次结构）。这很好......直到很多页面开始堆积。Wiki 相对更适合处理您需要的结构类型。

# mysql - MySQL GROUP_CONCAT 转义

> ID：452357
> 
> 赞同：14
> 
> 时间：2009-01-16T23:02:53.110
> 
> 标签：mysql, escaping, group-concat

（注意：这个问题不是关于转义查询，而是关于转义结果）

我正在使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)将多行组合成一个逗号分隔的列表。例如，假设我有两个（示例）表：

```
CREATE TABLE IF NOT EXISTS `Comment` (
`id` int(11) unsigned NOT NULL auto_increment,
`post_id` int(11) unsigned NOT NULL,
`name` varchar(255) collate utf8_unicode_ci NOT NULL,
`comment` varchar(255) collate utf8_unicode_ci NOT NULL,
PRIMARY KEY  (`id`),
KEY `post_id` (`post_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=6 ;

INSERT INTO `Comment` (`id`, `post_id`, `name`, `comment`) VALUES
(1, 1, 'bill', 'some comment'),
(2, 1, 'john', 'another comment'),
(3, 2, 'bill', 'blah'),
(4, 3, 'john', 'asdf'),
(5, 4, 'x', 'asdf');

CREATE TABLE IF NOT EXISTS `Post` (
`id` int(11) NOT NULL auto_increment,
`title` varchar(255) collate utf8_unicode_ci NOT NULL,
PRIMARY KEY  (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=7 ;

INSERT INTO `Post` (`id`, `title`) VALUES
(1, 'first post'),
(2, 'second post'),
(3, 'third post'),
(4, 'fourth post'),
(5, 'fifth post'),
(6, 'sixth post'); 
```

我想列出所有帖子以及对帖子发表评论的每个用户名的列表：

```
SELECT
Post.id as post_id, Post.title as title, GROUP_CONCAT(name) 
FROM Post 
LEFT JOIN Comment on Comment.post_id = Post.id
GROUP BY Post.id 
```

给我：

```
id  title   GROUP_CONCAT( name )
1   first post  bill,john
2   second post     bill
3   third post  john
4   fourth post     x
5   fifth post  NULL
6   sixth post  NULL 
```

这很好用，除了如果用户名包含逗号，它将破坏用户列表。MySQL 是否有一个函数可以让我转义这些字符？（请假设用户名可以包含任何字符，因为这只是一个示例模式）

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-03-07T11:51:09.503

实际上，有`ascii control characters`专门设计用于分离数据库字段和记录：

```
0x1F (31): unit (fields) separator

0x1E (30): record separator

0x1D (29): group separator 
```

阅读更多：[关于 ascii 字符](http://www.lammertbies.nl/comm/info/ascii-characters.html)

您永远不会在用户名中使用它们，而且很可能永远不会在`non-binary data`数据库中的任何其他用户名中使用它们，因此可以安全地使用它们：

```
GROUP_CONCAT(foo SEPARATOR 0x1D) 
```

`CHAR(0x1D)`然后以您想要的任何客户端语言拆分。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-16T23:33:02.100

如果用户名中有其他非法字符，您可以使用鲜为人知的语法指定不同的分隔符：

```
...GROUP_CONCAT(name SEPARATOR '|')... 
```

...您要允许管道吗？或任何字符？

转义分隔符，可能使用反斜杠，但在此之前转义反斜杠本身：

```
group_concat(replace(replace(name, '\\', '\\\\'), '|', '\\|') SEPARATOR '|') 
```

这会：

1.  用另一个反斜杠转义任何反斜杠
2.  用反斜杠转义分隔符
3.  将结果与分隔符连接起来

要获得未转义的结果，请按相反的顺序执行相同的操作：

1.  在前面没有反斜杠的情况下，用分隔符分割结果。实际上，这有点棘手，您想将其拆分到前面没有*奇数个*黑斜线的地方。此正则表达式将匹配：
    `(?<!\\)(?:\\\\)*\|`
2.  用文字替换所有转义的分隔符，即替换 \| 与 |
3.  用单反斜杠替换所有双反斜杠，例如用 \ 替换 \\

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T23:14:05.757

[`REPLACE()`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_replace)

例子：

```
... GROUP_CONCAT(REPLACE(name, ',', '\\,')) 
```

请注意，您必须使用双反斜杠（如果您用反斜杠转义逗号），因为反斜杠本身很神奇，并且`\,`变得简单`,`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T20:43:28.530

我建议使用 GROUP_CONCAT(name SEPARATOR '\n')，因为 \n 通常不会出现。这可能会更简单一些，因为您不需要逃避任何事情，但可能会导致意想不到的问题。nick 提出的编码/正则表达式解码当然也不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T01:26:00.687

如果您要在应用程序中进行解码，也许只需使用`hex`：

```
SELECT GROUP_CONCAT(HEX(foo)) ... 
```

或者您也可以将长度放入其中：

```
SELECT GROUP_CONCAT(CONCAT(LENGTH(foo), ':', foo)) ... 
```

也不是我测试过:-D

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T23:51:24.853

尼克说的是真的，通过增强 - 分隔符也可以是多个字符。

我经常用

```
GROUP_CONCAT(name SEPARATOR '"|"') 
```

用户名包含“|”的可能性 我会说相当低。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T01:18:38.580

您正在进入那个灰色区域，在 SQL 世界之外对它进行后处理可能会更好。

至少这就是我要做的：我只是 ORDER BY 而不是 GROUP BY，并循环遍历结果以将分组处理为以客户端语言完成的过滤器：

1.  首先初始化`last_id`为 NULL
2.  获取结果集的下一行（如果没有更多行，请转到步骤 6）
3.  如果行的 id 不同于`last_id`开始一个新的输出行：

    一种。如果`last_id`不是 NULL 则输出分组的行

    湾。设置新的分组行 = 输入行，但将名称存储为单个元素数组

    C。设置`last_id`为当前 ID 的值

4.  否则（id 与 相同`last_id`）将行名称附加到现有的分组行上。

5.  返回第 2 步
6.  否则你已经完成了；如果`last_id`不是 NULL，则输出现有的组行。

然后，您的输出最终会包括以数组形式组织的名称，然后您可以决定如何处理/转义/格式化它们。

您使用什么语言/系统？php？珀尔？爪哇？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T01:31:09.707

Jason S：这正是我正在处理的问题。我正在使用 PHP MVC 框架，并且正在处理您所描述的结果（每个结果多行，并且代码将结果组合在一起）。但是，我一直在为我的模型实现两个功能。一个返回重新创建对象所需的所有必要字段的列表，另一个是一个函数，它给定一行包含第一个函数的字段，实例化一个新对象。这让我可以从数据库中请求一行并轻松地将其转回对象，而无需了解模型所需数据的内部结构。当多行代表一个对象时，这不会很好，所以我试图使用 GROUP_CONCAT 来解决这个问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T01:30:55.793

> 现在我允许任何角色。我意识到管道不太可能出现，但我想允许它。

一个控制字符怎么样，无论如何你都应该从应用程序输入中去掉它？我怀疑你需要例如。名称字段中的制表符或换行符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-31T02:47:23.563

只是为了扩展一些答案，我在 PHP 中实现了@derobert 的[第二个建议](https://stackoverflow.com/a/452621/664741)，并且效果很好。给定 MySQL，例如：

```
GROUP_CONCAT(CONCAT(LENGTH(field), ':', field) SEPARATOR '') AS fields 
```

我使用以下函数对其进行拆分：

```
function concat_split( $str ) {
    // Need to guard against PHP's stupid multibyte string function overloading.
    static $mb_overload_string = null;
    if ( null === $mb_overload_string ) {
        $mb_overload_string = defined( 'MB_OVERLOAD_STRING' )
                && ( ini_get( 'mbstring.func_overload' ) & MB_OVERLOAD_STRING );
    }
    if ( $mb_overload_string ) {
        $mb_internal_encoding = mb_internal_encoding();
        mb_internal_encoding( '8bit' );
    }

    $ret = array();
    for ( $offset = 0; $colon = strpos( $str, ':', $offset ); $offset = $colon + 1 + $len ) {
        $len = intval( substr( $str, $offset, $colon ) );
        $ret[] = substr( $str, $colon + 1, $len );
    }

    if ( $mb_overload_string ) {
        mb_internal_encoding( $mb_internal_encoding );
    }

    return $ret;
} 
```

我最初还使用@Lemon Juice 的分隔符之一实施了@ʞɔıu 的建议。它工作得很好，但除了它的复杂性之外它更慢，主要问题是 PCRE 只允许固定长度的lookbehind，因此使用建议的正则表达式进行拆分需要捕获分隔符，否则字符串末尾的双反斜杠将丢失。因此，给定 MySQL，例如（注意 4 PHP 反斜杠 => 2 MySQL 反斜杠 => 1 真正的反斜杠）：

```
GROUP_CONCAT(REPLACE(REPLACE(field, '\\\\', '\\\\\\\\'),
    CHAR(31), CONCAT('\\\\', CHAR(31))) SEPARATOR 0x1f) AS fields 
```

拆分功能是：

```
function concat_split( $str ) {
    $ret = array();
    // 4 PHP backslashes => 2 PCRE backslashes => 1 real backslash.
    $strs = preg_split( '/(?<!\\\\)((?:\\\\\\\\)*+\x1f)/', $str, -1, PREG_SPLIT_DELIM_CAPTURE );
    // Need to add back any captured double backslashes.
    for ( $i = 0, $cnt = count( $strs ); $i < $cnt; $i += 2 ) {
        $ret[] = isset( $strs[ $i + 1 ] ) ? ( $strs[ $i ] . substr( $strs[ $i + 1 ], 0, -1 ) ) : $strs[ $i ];
    }
    return str_replace( array( "\\\x1f", "\\\\" ), array( "\x1f", "\\" ), $ret );
} 
```

# php - 如何使 DOMDocument 在 PHP 中编写独立 = 是？

> ID：452361
> 
> 赞同：8
> 
> 时间：2009-01-16T23:04:05.200
> 
> 标签：php, xml, domdocument

我正在使用 PHP5 创建 XML 文件。我有这样的代码：

```
$doc = new DOMDocument();
...
$xml_content = $doc->saveXML(); 
```

问题是创建的 XML 代码以这样的根节点开始：

```
<?xml version="1.0"?> 
```

但我希望它是这样的：

```
<?xml version="1.0" standalone="yes" ?> 
```

我想我需要在 $doc 上调用一些函数，但我不知道是哪一个？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-16T23:33:55.263

你想设置

```
$doc->xmlStandalone = true; 
```

它不是类的函数，它是一个属性，因此在文档中很难找到。你可以在[这里](http://uk.php.net/manual/en/class.domdocument.php)阅读。

# c# - 为什么存在小写和大写版本的字符串，我应该使用哪个？

> ID：452368
> 
> 赞同：106
> 
> 时间：2009-01-16T23:07:47.097
> 
> 标签：c#

好的，这可能是一个愚蠢的问题，但我无法找到任何相关信息。

String.Empty 和 string.Empty 一样吗？我总是发现自己倾向于使用大写版本 (String.Empty)，因为我更喜欢 IDE 中它的颜色和外观，而不是小写版本 (string.Empty)...

是否有一种“正确”的方式来使用这些不同的方式，或者完全取决于个人喜好？我的假设是它们都是相同的，但老实说，我从来没有考虑过，直到今天出于某种原因我想知道“如果它们都存在，它们一定都存在是有原因的”。

*有*没有人知道的原因？如果是这样，它是什么？任何人都可以启发我吗？

PS“完全重复”只回答了一半的问题——“哪个是对的？”，而不是“为什么它们都存在？”

* * *

**完全重复**：[C# 中的字符串和字符串有什么区别？](https://stackoverflow.com/questions/7074/in-c-what-is-the-difference-between-string-and-string)

**完全重复**：[C# 中的字符串与字符串](https://stackoverflow.com/questions/215255/string-vs-string-in-c)

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-16T23:09:01.773

在 C# 中，小写类型名称是类型名称的别名`System.xxx`，例如`string`equals`System.String`和`int`equals `System.Int32`。

为了一致性起见，最好将这些语言别名用于类型名称，而不是使用它们的等效框架。所以你做错了。;-)

至于它们都存在的原因，.NET 类型的存在是因为它们是在称为 CTS（通用类型系统）的 .NET 库的独立于语言的标准中定义的。为什么 C# 定义这些别名超出了我的理解（VB 做了一些非常相似的事情）。我想这两个原因是

1.  习惯。通过为某些基本类型提供相同的类型名称，让所有这些 C 和 Java 程序员使用 C#。
2.  懒惰：你不必导入`System`命名空间来使用它们。

**编辑**由于许多人似乎更喜欢其他表示法，让我指出这绝不是不合理的。实际上可以为使用 CTS 类型名称而不是 C# 的关键字提供一个很好的案例，并且在其他答案中提供了一些表面上很好的论点。从纯度/风格的角度来看，我可能会同意。

但是，请考虑这是否值得打破有助于跨项目统一代码的既定惯例。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-16T23:09:57.013

它在概念上类似于这样的东西：

```
using int=System.Int32 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-16T23:10:07.137

string 映射到 String 类 AFAIK，所以它们是相同的。

例如 int 和 Int32 也是如此。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-16T23:11:32.877

他们都是一样的。

我个人更喜欢使用小写字符串“blue one”，使用 C# 关键字而不是 .NET 类名，原因与我使用 int 而不是 Int32 的原因相同。此外，小写的不需要包含系统命名空间......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-17T01:09:19.643

就个人而言，我更喜欢使用 String，因为 String 和 Object 都是引用，而所有其他基本类型都是值类型。在我看来，这是最清晰的分离。

# php - 在 PHP 中检测 HTTPS 请求

> ID：452375
> 
> 赞同：20
> 
> 时间：2009-01-16T23:10:37.120
> 
> 标签：php, apache, https

我遇到的问题与需要保留受 HTTPS 保护的网站的一些 url 和其余的踢到 HTTP 的需要有关。

通常，您拥有`$_SERVER['HTTP_HTTPS']`或`$_SERVER['HTTPS']`（取决于您的 Apache 风格）。您还可以检查端口 - 正常流量为 80，HTTPS 为 443。

我的问题是**证书位于负载均衡器上**，所有这些变量都不可用，并且网络服务器在端口 80 上看到[http://www.foo.com](http://www.foo.com)。解决此问题的一种方法是告诉负载均衡器发送流量一个不同的端口，但我想知道是否有其他方法可以检测来自负载均衡器的 HTTPS？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-01-27T10:26:59.490

如果有人在 Amazon AWS Elastic Load Balancer 背后遇到同样的问题，解决方案很简单，因为`$_SERVER`变量将包括：

```
[HTTP_X_FORWARDED_PORT] => 443
[HTTP_X_FORWARDED_PROTO] => https 
```

因此，要获取协议，您可以使用：

```
function getRequestProtocol() {
    if(!empty($_SERVER['HTTP_X_FORWARDED_PROTO']))
        return $_SERVER['HTTP_X_FORWARDED_PROTO'];
    else 
        return !empty($_SERVER['HTTPS']) ? "https" : "http";
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-16T23:23:23.663

如果负载均衡器是 SSL 连接的另一端，则您无法获得比负载均衡器明确提供的更多信息。我会去添加一个 http 标头，它可能已经这样做了，转储所有 HTTP 标头并查看。

作为另一种解决方案，您可以根据 URL 在负载均衡器上进行重定向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-26T11:04:48.473

$_SERVER['HTTP_X_FORWARDED_PROTO'] 对于 joomla 用户来说似乎是一个很好的解决方案，因为如果您的负载均衡器进行重定向并且您将 force_ssl 设置设置为 1 或 2，那么您将在无限循环中结束，因为 joomla 总是看到 http：

# java - 你更喜欢哪种 Java ORM，为什么？

> ID：452385
> 
> 赞同：291
> 
> 时间：2009-01-16T23:17:21.537
> 
> 标签：java, orm

这是一个非常开放的问题。我将开始一个新项目，并正在研究不同的 ORM 以与数据库访问集成。

你有什么最爱吗？你有什么建议远离吗？

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-09-27T11:22:13.577

我已经停止使用 ORM。

原因不是这个概念有任何重大缺陷。休眠运行良好。相反，我发现查询的开销很低，我可以将大量复杂的逻辑放入大型 SQL 查询中，并将我的大量处理转移到数据库中。

所以考虑只使用 JDBC 包。

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2009-09-27T11:25:35.533

没有，因为拥有 ORM 会带走太多的控制权，而收益却很小。当您必须调试因使用 ORM 导致的异常时，所节省的时间很容易被浪费掉。此外，ORM 不鼓励开发人员学习 SQL 以及关系数据库的工作原理以及使用它来谋取利益。

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2010-11-17T19:10:23.210

许多 ORM 都很棒，您需要知道为什么要在 JDBC 之上添加抽象。我可以向你推荐[http://www.jooq.org](http://www.jooq.org/ "约克")（免责声明：我是 jOOQ 的创建者，所以这个答案是有偏见的）。jOOQ 包含以下范例：

*   SQL 是个好东西。很多东西都可以用 SQL 很好地表达。不需要完全抽象 SQL。
*   关系数据模型是个好东西。它已被证明是过去 40 年来最好的数据模型。不需要 XML 数据库或真正面向对象的数据模型。相反，您的公司运行多个 Oracle、MySQL、MSSQL、DB2 或任何其他 RDBMS 实例。
*   SQL 具有结构和语法。不应使用 JDBC 中的“低级”字符串连接来表示它 - 或 HQL 中的“高级”字符串连接 - 两者都容易出现语法错误。
*   在处理主要查询时，变量绑定往往非常复杂。那是应该抽象的东西。
*   POJO 在编写处理数据库数据的 Java 代码时非常有用。
*   POJO 很难手动编写和维护。代码生成是要走的路。您将拥有包括数据类型安全在内的编译安全查询。
*   数据库是第一位的。虽然数据库顶部的应用程序可能会随着时间而改变，但数据库本身可能会持续更长时间。
*   是的，您的旧数据库中确实有存储过程和用户​​定义类型 (UDT)。您的数据库工具应该支持这一点。

还有许多其他好的 ORM。尤其是 Hibernate 或 iBATIS 有一个很棒的社区。但是，如果您正在寻找一种直观、简单的方法，我会说试试 jOOQ。你会喜欢的！:-)

查看此示例 SQL：

```
 // Select authors with books that are sold out
  SELECT * 
    FROM T_AUTHOR a
   WHERE EXISTS (SELECT 1
                   FROM T_BOOK
                  WHERE T_BOOK.STATUS = 'SOLD OUT'
                    AND T_BOOK.AUTHOR_ID = a.ID); 
```

以及如何在 jOOQ 中表达：

```
 // Alias the author table
  TAuthor a = T_AUTHOR.as("a");

  // Use the aliased table in the select statement
  create.selectFrom(a)
        .whereExists(create.selectOne()
                           .from(T_BOOK)
                           .where(T_BOOK.STATUS.equal(TBookStatus.SOLD_OUT)
                           .and(T_BOOK.AUTHOR_ID.equal(a.ID)))))); 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2009-01-16T23:22:51.060

Hibernate，因为它基本上是 Java 中的事实标准，并且是创建 JPA 的驱动力之一。它在 Spring 中得到了很好的支持，几乎每个 Java 框架都支持它。最后，GORM 是一个非常酷的包装器，它使用 Groovy 进行动态查找器等。

它甚至被移植到 .NET (NHibernate)，所以你也可以在那里使用它。

* * *

## 回答 #5

> 赞同：55
> 
> 时间：2009-11-25T17:59:14.443

休眠，因为它：

*   稳定 - 存在这么多年，它没有任何重大问题
*   规定了 ORM 领域的标准
*   实施标准（JPA），除了口述它。
*   在互联网上有大量关于它的信息。教程很多，常见问题解决方法等
*   功能强大 - 您可以将非常复杂的对象模型转换为关系模型。
*   它支持任何主要和中型 RDBMS
*   很容易上手，*只要你学得好*

关于为什么（以及何时）使用 ORM 的几点：

*   您使用系统中的对象（如果您的系统设计良好）。即使使用 JDBC，您最终也会制作一些转换层，以便将数据传输到对象。但我敢打赌，hibernate 在翻译方面比任何定制的解决方案都要好。
*   它不会剥夺你的控制权。您可以控制非常小的细节，如果 API 没有一些远程功能 - 执行本机查询就可以了。
*   如果目标是可维护的，任何中型或更大的系统都无法承受大量查询（无论是在一个地方还是分散在各处）
*   如果性能不重要。Hibernate 增加了性能开销，在某些情况下不能忽略。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2009-11-25T18:57:03.623

我会推荐使用[MyBatis](http://www.mybatis.org/)。它是 JDBC 之上的一个薄层，很容易将对象映射到表并且仍然使用纯 SQL，一切都在您的控制之下。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-09-27T11:58:45.533

在编写中型 JavaSE 应用程序时，我对[Avaje Ebean](https://ebean-orm.github.io/)的体验非常好。

它使用标准的 JPA 注释来定义实体，但公开了一个更简单的 API（没有 EntityManager 或任何附加/分离的实体废话）。它还允许您在必要时轻松使用 SQL 查询或事件纯 JDBC 调用。

它还有一个非常好的流畅且类型安全的查询 API。您可以编写如下内容：

```
List<Person> boys = Ebean.find(Person.class)
                                  .where()
                                       .eq("gender", "M")
                                       .le("age", 18)
                                  .orderBy("firstName")
                                  .findList(); 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-01-16T23:28:03.013

[SimpleORM](http://www.simpleorm.org/)，因为它直接且没有魔法。它在 Java 代码中定义了所有元数据结构，并且非常灵活。

> SimpleORM 通过将关系数据库中的数据映射到内存中的 Java 对象来提供与 Hibernate 类似的功能。可以根据 Java 对象指定查询，对象标识与数据库键对齐，维护对象之间的关系，并使用乐观锁自动将修改的对象刷新到数据库。
> 
> 但与 Hibernate 不同的是，SimpleORM 使用了非常简单的对象结构和架构，避免了复杂的解析、字节码处理等。SimpleORM 小而透明，打包在大小只有 79K 和 52K 的两个 jar 中，只有一个小且可选依赖（Slf4j）。（Hibernate 超过 2400K 加上大约 2000K 的依赖 Jar。）这使得 SimpleORM 易于理解，从而大大降低了技术风险。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-09-25T17:01:32.367

[Eclipse Link](http://www.eclipse.org/eclipselink/)，有很多原因，但值得注意的是，我觉得它比其他主流解决方案的臃肿少（至少不像你的脸膨胀）。

哦，Eclipse Link 已被选为 JPA 2.0 的参考实现

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-04-12T18:22:56.243

虽然我对用 Java 替代自由格式的 SQL 查询表示担忧，但我确实认为批评 ORM 的人之所以这样做是因为应用程序设计通常很糟糕。

真正的 OOD 是由类和关系驱动的，而 ORM 为您提供了不同关系类型和对象的一致映射。如果您使用 ORM 工具并最终以 ORM 框架支持的任何查询语言（包括但不限于 Java 表达式树、查询方法、OQL 等）编写查询表达式，那么您肯定做错了，即您的类模型很可能不以应有的方式支持您的要求。干净的应用程序设计实际上并不需要应用程序级别的查询。我一直在重构许多项目，人们开始使用 ORM 框架的方式与他们在代码中嵌入 SQL 字符串常量的方式相同，最后每个人都对匹配后整个应用程序变得多么简单和可维护感到惊讶使用使用模型建立您的类模型。当然，对于搜索功能等，您需要一种查询语言，但即便如此，查询也受到很大限制，以至于创建一个更复杂的 VIEW 并将其映射到只读持久类比构建表达式更易于维护和查看在您的应用程序代码中使用某种查询语言。VIEW 方法还利用了数据库功能，并且通过物化，在性能方面比 Java 源代码中的任何手写 SQL 都要好得多。所以，我看不出任何不平凡的应用程序不使用 ORM 的理由。但即便如此，查询也受到很大限制，以至于创建一个更复杂的 VIEW 并将其映射到只读持久类比在应用程序代码中以某种查询语言构建表达式要好得多。VIEW 方法还利用了数据库功能，并且通过物化，在性能方面比 Java 源代码中的任何手写 SQL 都要好得多。所以，我看不出任何不平凡的应用程序不使用 ORM 的理由。但即便如此，查询也受到很大限制，以至于创建一个更复杂的 VIEW 并将其映射到只读持久类比在应用程序代码中以某种查询语言构建表达式要好得多。VIEW 方法还利用了数据库功能，并且通过物化，在性能方面比 Java 源代码中的任何手写 SQL 都要好得多。所以，我看不出任何不平凡的应用程序不使用 ORM 的理由。

# c++ - 组织类层次结构的最佳方式，包括可覆盖的“更新”功能

> ID：452390
> 
> 赞同：1
> 
> 时间：2009-01-16T23:21:23.057
> 
> 标签：c++

我有一个基类“Foo”，它有一个 Update() 函数，我想为该类的每个实例每帧调用一次。给定一个名为“foo”的类的对象实例，然后每帧调用一次 foo->Update()。

我有一个从我的基类派生的类“Bar”，它也需要更新每一帧。

我可以给派生类一个 Update() 函数，但是我必须记住调用它的 base::Update() 函数 - 没有什么强制我要求调用 base::Update() 函数，因为我已经覆盖了它，并且很容易忘记（或选择不）调用 base:Update 函数。

因此，作为替代方案，我可以为基类提供一个受保护的 OnUpdate() 函数，该函数可以被覆盖，并从 base::Update() 函数中调用它。这消除了我记住从派生更新函数调用 base::Update() 的责任，因为我不再覆盖它。一个名为“bar”的 Bar 实例将调用 bar->Update()；这将首先调用基类的 Update() 方法，然后调用重写的 OnUpdate() 函数，执行派生类的必要更新。

这解决了一切。除了。如果我想派生另一个可更新的类，这一次是从“Bar”类派生的。

Baz（派生自 Bar）也有更新要求。如果我把它们放在 Baz 的 OnUpdate() 函数中，我又回到了原来的问题，因为我必须记住告诉 Baz 的 OnUpdate() 函数调用 Bar 的 OnUpdate() 函数，否则 Bar 的 OnUpdate() 函数不会不会被调用。

所以真的，我希望 Bar 的 OnUpdate() 函数是不可覆盖的，而是让它在完成它需要做的任何事情后调用一个可覆盖的函数，也许称为 OnUpdate2()...

如果我想派生另一个类？OnUpdate3? OnUpdate4? 更新后？

有没有更好的办法？

* * *

更多信息：

我的具体问题领域是 3d 世界。我已经决定我的基类是一个“定位器”（一个具有位置和方向的对象）。

我的第一个派生类是“PhysicsObject”——一个定位器，它也有质量、速度、碰撞信息等。

我的下一个派生类是“相机”——它派生自 PhysicsObject。除了位置和速度，它还包含有关视口、景深等的信息。

* * *

MattK 建议简化层次结构 - 如果从未引用过 Locator，请将其合并到 PhysicsObject 中。

我也在考虑如何将布局颠倒过来并使用组合而不是继承。

也许相机具有物理属性。也许一个 PhysicsObject 有一个位置。

我将不得不考虑更多关于这个问题。

* * *

我喜欢 Uri 的做法：“遵守合同”。这是规则 - 请遵守它。Uri 是对的，无论我尝试采取何种保护措施，任何人都可以绕过它们，所以在这种情况下，也许最简单的解决方案是最好的。我所有的 update() 函数都需要调用它们的 base::update() 函数。

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T23:25:17.217

听起来你想要组合而不是继承。如果有一个接口 IUpdateable，而 Foo 持有一组 IUpdateable 对象，并在每个滴答声中对每个对象调用一个 Update 方法会怎样？然后 Bar 和 Baz 就可以实现 Update；您唯一担心的是如何最好地向 Foo 注册它们。

根据您的进一步信息：您可能希望考虑您的主要对象类似于您的物理对象，并使用组合来包含实现特定行为的对象，例如相机对象的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T23:30:49.153

这是一个很好的问题，我遇到过很多次了。

不幸的是，目前没有我熟悉的语言机制可以让 C++ 等主流语言做到这一点，尽管我希望（至少在未来）Java 会有一些带有注释的东西。

我使用了多种技术，包括您建议的技术，每种技术都有优缺点。令人费解的方法并不总是值得付出代价。

我今天的观点是，如果你真的需要使用继承（而不是组合），就像这里所说的那样，那么最好采用优雅的解决方案并遵守书面合同。我承认，这很危险，但其他方法也存在风险。

一般来说，人们阅读重写方法的文档比阅读他们正在使用的方法的文档更加仔细。换句话说，虽然您希望避免“让您的班级用户感到惊讶”，并且不能指望他阅读文档，但在继承的情况下您可以多指望一点，特别是如果您是唯一的用户.

如果您正在提供一个 API 函数，并且您希望许多其他人覆盖您的子类，您可以进行各种健全性检查以确保调用该方法，但最终，您必须依赖合约，就像这样许多标准库类都可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T01:20:21.337

我认为使用类层次结构不容易实现您想要的。

一种可能的解决方案是使用处理信号/插槽的库（我使用 sigslot [http://sigslot.sourceforge.net/](http://sigslot.sourceforge.net/)）。

在基类中声明一个信号。

```
class Base : has_slots<> {
  public:
    Base() { SignalUpdate.connect(this, &Base::OnUpdate); }
    void Update() { SignalUpdate.emit(); }
    void OnUpdate() { cout << "Base::OnUpdate" << endl; }
  private:
    signal0<> SignalUpdate;
}; 
```

现在在每个“派生”类上，您将此类信号与您自己的方法连接起来

```
class Derived : public Base {
  public:
    Derived() { SignalUpdate.connect(this, &Derived::OnDerivedUpdate); }
    void OnDerivedUpdate() { cout << "Derived::OnDerivedUpdate" << endl; }
}; 
```

（请注意，此类不再需要从 Base 派生）。

现在每次调用 Update 时，所有连接的方法都会被调用。

还有其他实现类似行为的框架：boost 信号、qt 插槽、libsigc++。您应该尝试查看这些内容，看看它们是否符合您的需求。

# perl - 如何使用 Mail::Sender 发送没有“收件人”地址的电子邮件？

> ID：452404
> 
> 赞同：3
> 
> 时间：2009-01-16T23:26:09.773
> 
> 标签：perl, email

是否可以使用 Mail::Sender 发送只有**cc**或**bcc**收件人的电子邮件？当我尝试发送没有“收件人”地址的电子邮件时，我得到了预期的返回码：

> -8 = 参数 $ 为空

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T23:50:43.967

在“to”字段中使用空字符串`''`不起作用。使用空间就像一种魅力。

```
use Mail::Sender;

my $sender = Mail::Sender->new();
my $mail   = {
    smtp                 => 'mailserver',
    from                 => 'example@example.com',
    to                   => ' ',
    bcc                  => 'example@example.com',
    subject              => 'test',
    ctype                => 'text/plain; charset=utf-8',
    skip_bad_recipients  => 1,
    msg                  => 'test'
};

my $ret =  $sender->MailMsg($mail);

print $ret; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T23:30:03.040

参数是否`fake_to`有效：

> fake_to
> 
> => 将在标题中显示的收件人地址。如果未指定，我们使用“to”的值。
> 
> 如果您要将消息发送到的地址列表很长，或者如果您不希望收件人看到彼此的地址，请将 fake_to 参数设置为一些信息丰富但虚假的地址或您的邮寄/分发列表的地址。

[http://metacpan.org/pod/Mail::Sender](http://metacpan.org/pod/Mail::Sender)

查看源代码，您似乎仍然需要将`to`参数设置为某个值。也许`" "`会成功？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-16T23:27:45.790

您是否尝试过使用 '' ？

# javascript - JavaScript 和 Flash 如何进行跨域通信？

> ID：452415
> 
> 赞同：8
> 
> 时间：2009-01-16T23:30:16.877
> 
> 标签：javascript, flash, security, actionscript, cross-domain

***如何打开“跨域安全”，以便页面上的 JavaScript 可以与 SWF 自由通信，即使它托管在另一个域上？***

我确定这个函数通信在默认情况下被阻止，但是通过使用一个名为“crossdomain.xml”的文件和 actionscript 3 函数：system.Security.allowDomain("*")。不过，我并没有完全成功，而且我没有洞察力知道哪个是开放的。

在这种情况下，我是否需要考虑其他隐藏的安全层？

我是否通过执行此设置以某种方式为潜在的黑客开放了我的代码？

（如果您想知道：是的，我**必须**在一个场景中进行这项工作，其中 html 托管在一个域上，JavaScript 是从另一个域外部添加的，而 SWF 是由来自第三个域的 JavaScript 嵌入的- 不要问为什么，解释起来太复杂了 - 我也希望我可以将整个东西托管在一个域中）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-16T23:53:39.607

在 SWF 中使用`Security.allowDomain("www.example.com")`将允许来自 www.example.com 的页面中的 JS 调用在 SWF 中使用`ExternalInterface.addCallback()`. 域和子域必须完全匹配。使用`"*"`将允许任何域与 SWF 通信，但如果您有一个特定的域，最好使用它。

在 HTML 嵌入代码中设置`allowScriptAccess`为`always`将允许 SWF 调用 JavaScript 函数。

吸引许多开发人员的一件事是，在 SWF 加载完成之前，JavaScript 将无法调用 SWF 上的函数。不幸的是，没有基于 JS 的事件可以告诉您 SWF 何时准备就绪（至少我发现）。为了解决这个问题，我通常会在 SWF 完成加载后立即从 SWF 调用 JS 函数，以通知页面 SWF 已准备好。

这里和那里都有一些抽象，但是如果你看一下[YUI Charts](http://developer.yahoo.com/yui/charts/)的源代码，你可能会弄清楚 Yahoo! 让跨域 JS/SWF 通信正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T22:50:03.627

我要在上一个答案中添加一件事：如果您尝试上述代码但它不起作用，请检查您的网站地址是否包含“www”。如果我把它写成，我的没有，也没有工作

```
Security.allowDomain("www.jeremy-knight.com"); 
```

我需要把它写成：

```
Security.allowDomain("jeremy-knight.com"); 
```

# c# - 摆脱 ASP.NET MVC 中的 /Home 路径名

> ID：452418
> 
> 赞同：1
> 
> 时间：2009-01-16T23:32:25.547
> 
> 标签：c#, asp.net-mvc

我才刚刚开始使用 ASP.NET MVC，而且我有一个小问题：似乎每个控制器都有一个附加的类似文件夹的路径，所以我的站点变成了 mydomain.net/Home/something。是否有可能以某种方式摆脱 /Home 部分，以便 Home 控制器成为我的网站的“默认”，并且可以只使用 mydomain.net/something 代替？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T00:12:25.077

当然，只需像这样定义一条路线：

```
routes.MapRoute("{action}/{id}", new {controller="Home", action="Index", id=""}); 
```

唯一的问题是对其他控制器的请求呢？例如，是

/产品/Foo

请求 HomeController.Product("Foo") 或 ProductController.Foo()？

您可能需要使用约束来明确区分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-15T11:40:59.313

我写了一篇关于处理这个问题的简单方法的博客文章。我创建了一个路由约束，它选择了一个您要用于站点根目录的控制器。 [如果您有兴趣，这里是博客文章。](http://sonerdy.com/post/2011/01/15/getting-rid-of-home-in-aspnet-mvc.aspx)

# c# - ASP.NET 异步调用的问题，等待处理程序返回

> ID：452425
> 
> 赞同：1
> 
> 时间：2009-01-16T23:34:19.723
> 
> 标签：c#, asp.net, asp.net-ajax

我正在尝试为我的开发人员遇到的问题找到答案。我自己对这个还不够了解...

我们正在使用带有 C# 的 ASP.NET。

当用户按下页面上的按钮时，我们调用处理程序将会话变量保存到表单的当前视图状态（一些使用的 ID）。

然后，我们调用具有其他功能的 GreyBox 窗口。

因为这是异步的，greybox 不会等待处理程序响应。

在许多情况下，灰盒在会话变量保存到视图状态之前加载，在这种情况下，灰盒没有必要的 ID。

在本地主机上，它足够快，以至于我们从未意识到这个问题。在生产中，这是一个问题。

这里的正确解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T00:01:04.100

为保存会话而对服务器的异步调用将向客户端返回响应。在服务器成功回复之前不要启动灰盒。如果只有一件事导致您的表单出现异步回发，那么您可以通过执行以下操作插入回复：

```
<script type="text/javascript">
    //<![CDATA[
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_endRequest(endRequest);
    function endRequest(sender, e) {
        // Do stuff
    }
    //]]>
</script> 
```

有关更复杂的场景，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/bb398976.aspx)上有关此主题的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T08:59:10.903

您需要确保您的附加代码在 AJAX 请求的回调方法中运行。

如果您手动调用 Web 服务或页面方法，则该`Sys.Net.WebServiceProxy.invoke`方法需要回调：http: [//msdn.microsoft.com/en-au/library/bb383814.aspx](http://msdn.microsoft.com/en-au/library/bb383814.aspx)

我感觉 David 建议的 PageRequestManager 仅在您使用 UpdatePanel 执行 AJAX 请求时才有效。

# python - 如何测试我是否成功安装了 Python 模块？

> ID：452430
> 
> 赞同：3
> 
> 时间：2009-01-16T23:36:04.887
> 
> 标签：python, installation, module

我试图安装beautifulsoup。我收到这样的错误：
<-- snip -->

```
raise MissingSectionHeaderError(fpname, lineno, line)
ConfigParser.MissingSectionHeaderError: File contains no section headers.
file: /Users/Sam/.pydistutils.cfg, line: 1
'install_lib = ~/Library/Python/$py_version_short/site-packages\n' 
```

当我在 vim 中运行我的 Python 代码时，我遇到了类似的错误：:!python %

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T23:40:46.560

您可以像这样测试模块是否安装：

```
$ python
>>> import modulename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T23:41:29.693

我会尝试以下方法：

1.  打开 Python 外壳
2.  类型`import <moduleName>`
3.  解析结果（无错误、ImportError 或某些模块加载错误）
4.  尝试从导入的模块调用任何函数（查看模块是否正确初始化）。

你需要更复杂的东西吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-12T10:24:02.037

try: from prettytable import **PrettyTable** except: try: print "\033[31mPython-prettytable Module [Not Available]\033[0m" os.system('sudo apt-get install python-setuptools') os.system('sudo easy_install prettyTable') print "\033[33mPython-prettytable Module [Installed]\033[0m" except: print "PrettyTable Python Module Installation failed." print "\033[32mPython-prettytable 模块 [可用]\033[0m"

# c++ - 有没有办法以编程方式在 osx 上隐藏碳应用程序？

> ID：452435
> 
> 赞同：0
> 
> 时间：2009-01-16T23:38:12.213
> 
> 标签：c++, macos, macos-carbon

我有一个碳 C++ 应用程序，我想以编程方式执行与我的应用程序的应用程序菜单中可用的 Command-H 等效（隐藏应用程序）。我已经探索了 TransitionWindow 和 HideWindow 的 carbon API，虽然它们可以隐藏我的窗口，但它们并不相当于 Command-H。我临时查看了需要创建 AppleEvent 的 AppleEvent 参考，但我没有看到用于隐藏应用程序的参考。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T23:50:41.737

很抱歉回答我自己的问题，但 ShowHideProcess() API 似乎可以满足我的要求。如果有更好的解决方案，我很想听听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T00:00:32.167

请注意：隐藏窗口与隐藏应用程序非常不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T23:26:28.787

如果您愿意，您还可以从 Carbon 事件管理器发送一个 kHICommandHide ('hide') 命令事件（这是该菜单项的作用，并且在处理时调用 ShowHideProcess()），例如，如果您希望此操作被一个事件具体化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T00:11:03.880

> 我临时查看了需要创建 AppleEvent 的 AppleEvent 参考，但我没有看到用于隐藏应用程序的参考。有什么想法吗？

我不是专家，但您可以使用 AppleEvent 将`visible`进程的属性设置为`false`- 至少它适用于 AppleScript

```
tell application "System Events"
    set visible of process "xyz" to false
end tell 
```

另一方面，您的 API 似乎是最直接的方式，上面的代码可能也只是使用它。

# sql-server - SQL 抱怨没有安装管理工具，但它们是

> ID：452449
> 
> 赞同：0
> 
> 时间：2009-01-16T23:45:20.717
> 
> 标签：sql-server, sql-server-2005, installation

当我尝试在 SQL Server 中创建新的维护计划时，我收到以下警告：

> 您尝试在 SQL Server 的远程实例上执行的操作失败，因为该操作需要远程计算机上未安装的 SQL Server 组件。要继续，请在远程计算机上安装 SQL Server 2005 管理工具，然后重试。有关详细信息，请参阅 SQL Server 2005 联机丛书中的“如何：安装 SQL Server 2005（安装）”，或在 [http://go.microsoft.com/fwlink/?LinkID=57083](http://go.microsoft.com/fwlink/?LinkID=57083)上找到 MSDN 上的文章 。（对象浏览器）

但是，已安装工具，AFAIK。我正在连接到本地机器。这是 SQL Server 旁边的错误消息的屏幕截图，告诉我它不会安装管理工具，因为它们已经在那里。

![替代文字](https://farm4.static.flickr.com/3399/3202696116_96acddb58a.jpg?v=0)

[（此处](http://www.flickr.com/photos/lianza/3201848963/)为上一步）

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T00:23:33.900

啊 - 没关系。响应只是有点误导。它只是抱怨我要求安装的**部分内容。**当我决定进步时，它实际上确实安装了一些东西。

# .net - MS Access + IIS + 模拟 = '未指定的错误'？

> ID：452451
> 
> 赞同：1
> 
> 时间：2009-01-16T23:46:54.863
> 
> 标签：.net, ms-access, iis-7

我有一个 ASP .NET (2.0) 应用程序，它使用 IIS 中的模拟和基本身份验证通过网络共享连接到 Access 数据库。直到今天，当我开始收到奇怪的“未指定错误”错误消息时，一切都运行良好。我最终进行了 IIS 重置以解决问题，但我试图弄清楚为什么它可能首先发生。

有任何想法吗？这是我的连接字符串：provider=Microsoft.Jet.OLEDB.4.0;Data Source = \REMOTESERVER\LocalDatabases$\database.mdb;Jet OLEDB:Database Password=password"

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T20:01:21.823

我不了解 OLEDB，但对于 ODBC，通常情况下 OD​​BC 返回一个以上的错误，最后一个是您收到的所有通知，直到您专门检查 ODBC 错误集合。也许 OLEDB 返回的错误不止一个，而错误集合中的其他错误之一可能更具启发性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T06:29:26.907

如果直到今天一切正常，那一定是发生了一些变化。如果没有人更改 IIS 的代码或配置，那么它一定是服务器（或网络共享）上的其他东西。

鉴于我们刚刚通过了周二补丁，我怀疑有人更新了网络服务器或网络服务器。看看有没有可以回滚的补丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T23:40:57.430

检查您是否在例程结束时正确关闭了数据库。这最终会导致这些消息。

再见！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-07T19:07:46.427

我在配置新服务器时看到“未指定错误”。我试图冒充域用户来访问位于网络驱动器中的数据库。

为了解决这个问题，我将域用户添加到本地管理员组。这为我解决了这个问题。

# datetime - How do I subtract dates?

> ID：452463
> 
> 赞同：0
> 
> 时间：2009-01-16T23:52:17.053
> 
> 标签：datetime

Let's say that guy register's to my site for 5$ for 30 days. So how do I make code that automaticly after 30 days delete's his account?

Thanks for answers and sorry for poor english Respectfully, Tom

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-16T23:55:48.137

Use the date handling functions of your preferred programming language. Do not attempt to implement it yourself. It's harder than you think.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T00:03:44.237

I'd suggest simply noting the account's expiration date in its record, rather than having some sort of scheduled process to delete expired accounts.

For a .Net example: when you receive the $5 payment, set the account's expiration date to DateTime.Now.AddDays(30), and reject login on an account where expirationDate < DateTime.Now.

In Java, you'd need to pour the Date into a Calendar in order to add days, then pour it back into a Date when you're done.

However, what facilities are available to handle dates are determined by your environment.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T00:00:56.893

If you can, convert the registration date and the current time to UNIX timestamps. Then subtract their registration time from the current time and check if the result is greater than the number of seconds in 30 days. (60 seconds * 60 minutes * 24 hours * 30 days = 2592000 seconds.)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T23:59:45.680

Most likely you would run a cron job every day or so and check and see if an account's last payment was 30 days ago, and then delete the user. However, manipulating the date is difficult to explain unless we know what language you are using. Since you specified DateTime I'm going to assume that you mean the .NET DateTime object and then you can just do DateTime.addMonths(-1); or DateTime.addDays(-30) respectively.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T00:01:17.020

If you just have to count 30 days you can count them as 30 * 24 * 60 * 60 = 2592000 seconds and simply subtract the unix timestamps.

Anything more complex than this is a PITA to implement yourself and yuo should follow recursive's advice.

# sql - 如何从 Oracle 中的表中获取列名？

> ID：452464
> 
> 赞同：202
> 
> 时间：2009-01-16T23:53:00.937
> 
> 标签：sql, database, oracle

我需要查询数据库以获取*列名*，不要与表中的数据混淆。例如，如果我有一个名为的表`EVENT_LOG`，其中包含`eventID`、`eventType`、`eventDesc`和`eventTime`，那么我想从查询中检索这些字段名称，而不是其他任何东西。

我发现如何做到这一点：

*   [微软 SQL 服务器](https://stackoverflow.com/q/1054984/419956)
*   [MySQL](https://stackoverflow.com/q/193780/419956)
*   [PostgreSQL](https://dba.stackexchange.com/q/22362/5089)

但我需要知道：如何在***Oracle*****中做到这一点？**

 ** * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-01-16T23:57:18.960

您可以查询 USER_TAB_COLUMNS 表以获取表列元数据。

```
SELECT table_name, column_name, data_type, data_length
FROM USER_TAB_COLUMNS
WHERE table_name = 'MYTABLE' 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-01-17T02:25:40.050

在 SQL 服务器中...

```
SELECT [name] AS [Column Name]
FROM syscolumns
WHERE id = (SELECT id FROM sysobjects WHERE type = 'V' AND [Name] = 'Your table name') 
```

视图类型 = 'V' 表格类型 = 'U'

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-01-16T23:55:32.240

你可以这样做：

```
describe EVENT_LOG 
```

或者

```
desc EVENT_LOG 
```

注意：仅当您知道表名并且专门针对 Oracle 时才适用。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-08-23T15:16:48.400

对于 SQL Server 2008，我们可以使用 information_schema.columns 来获取列信息

```
SELECT *
FROM   information_schema.columns
WHERE  table_name = 'Table_Name'
ORDER  BY ordinal_position 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-04-25T22:00:30.043

对于 SQLite，我相信您可以使用以下内容：

```
PRAGMA table_info(table-name); 
```

来自 sqlite.org 的解释：

此编译指示为命名表中的每一列返回一行。结果集中的列包括列名、数据类型、列是否可以为 NULL，以及列的默认值。对于不属于主键的列，结果集中的“pk”列为零，对于属于主键的列，它是主键中的列的索引。

另见：[Sqlite.org Pragma 表信息](http://www.sqlite.org/pragma.html#pragma_table_info)

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-01-16T23:56:36.483

该信息存储在`ALL_TAB_COLUMNS`系统表中：

```
SQL> select column_name from all_tab_columns where table_name = 'DUAL';

DUMMY 
```

或者，`DESCRIBE`如果您使用 SQL*PLUS，您可以使用该表：

```
SQL> desc dual
Name                               Null?    Type
----------------------------------------------------- -------- ---------------------- -------------
DUMMY                               VARCHAR2(1) 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-01-17T02:10:17.257

其他答案足以回答这个问题，但我想我会分享一些额外的信息。其他人则描述“DESCRIBE table”语法以获取表信息。如果您想以相同格式获取信息，但不使用 DESCRIBE，您可以执行以下操作：

```
SELECT column_name as COLUMN_NAME, nullable || '       ' as BE_NULL,
  SUBSTR(data_type || '(' || data_length || ')', 0, 10) as TYPE
 FROM all_tab_columns WHERE table_name = 'TABLENAME'; 
```

可能没多大关系，但我之前写过它，它似乎很合适。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-02-07T10:19:48.157

对于甲骨文

```
SELECT column_name FROM user_tab_cols WHERE table_name=UPPER('tableName'); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-03-01T06:24:14.810

```
describe YOUR_TABLE; 
```

在你的情况下：

```
describe EVENT_LOG; 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-02-25T15:58:39.027

即使这也是我们可以使用它的一种方式

```
select * from product where 1 != 1 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-10-06T08:38:40.560

```
select column_name,* from information_schema.columns
 where table_name = 'YourTableName'
order by ordinal_position 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-01-21T18:23:54.203

对于 MySQL，使用

```
SELECT column_name 
FROM information_schema.columns 
WHERE 
table_schema = 'Schema' AND table_name = 'Table_Name' 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-04-16T13:28:57.717

对于 SQL Server：

```
SELECT [name] AS [Column Name]
FROM syscolumns
WHERE id = object_id('TABLE_NAME') 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-05-27T11:35:22.943

```
SELECT COLUMN_NAME 'all_columns' 
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME='user'; 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-01-18T23:16:45.713

你也可以试试这个，但它可能比你需要的信息多：

```
sp_columns TABLE_NAME 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-10-25T19:30:44.563

```
SELECT A.COLUMN_NAME, A.* FROM all_tab_columns a 
WHERE table_name = 'Your Table Name'
AND A.COLUMN_NAME = 'COLUMN NAME' AND a.owner = 'Schema' 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-09-21T08:08:47.097

mysql

```
SHOW COLUMNS FROM a_table_named_users WHERE Field REGEXP 'user_id|user_name|user_pass' 
```

这将返回如下结果：

```
Field     |  Type        |   Null   |   Key   |   Default   |   Extra  
user_id      int(8)          NO         PRI       NULL          auto_increment
user_name    varchar(64)     NO         MUL       NULL
user_pass    varchar(64)     NO                   NULL 
```

然后提取值，您可以简单地

```
fetch row[0] 
```

这对于动态传递输入也很有用，因为 REGEXP 需要 '|' 用于多个输入，但也是一种保持数据分离并易于存储/传递给类/函数的方法。

为了安全起见，尝试在发送时也加入虚拟数据，并比较接收到任何错误时返回的内容。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-09-06T09:03:17.470

在 Oracle 中，有两个视图来描述列：

*   DBA_TAB_COLUMNS 描述了数据库中所有表、视图和集群的列。

*   USER_TAB_COLUMNS 描述了当前用户拥有的表、视图和集群的列。此视图不显示
    OWNER 列。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-07-09T15:39:45.740

答案在这里：[http](http://php.net/manual/en/function.mysql-list-fields.php) ://php.net/manual/en/function.mysql-list-fields.php 在您的情况下，我将使用以下代码：

```
$result = mysql_query("SHOW COLUMNS FROM sometable");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
$fields = array();
if (mysql_num_rows($result) > 0) {
    while ($row = mysql_fetch_assoc($result)) {
        $fields[] = $row['Field'];
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-10-17T07:24:31.360

**你可以运行这个查询**

```
SELECT t.name AS table_name,
SCHEMA_NAME(schema_id) AS schema_name,
c.name AS column_name
FROM sys.tables AS t
INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
WHERE c.name LIKE '%%' --if you want to find specific column write here 
ORDER BY schema_name, table_name; 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-04-24T13:09:30.807

只需从表中选择第一行，对于 oracle ：`select * from <table name> where rownum = 1;`

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2014-07-03T09:24:15.700

遇到这个问题，寻找对 Teradata 上列名的访问权限，所以我将添加他们对 SQL 的“风味”的答案：

```
SELECT ColumnName
FROM DBC.Columns
WHERE DatabaseName='DBASE_NAME'
AND TableName='TABLE_NAME'; 
```

信息存储在 DBC 数据库中。

获取数据类型有点复杂： [Get column type using teradata system tables](https://stackoverflow.com/questions/21587034/get-column-type-using-teradata-system-tables)

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2014-07-09T10:45:51.267

试试这个

```
select * from sys.all_columns c join sys.objects o on c.object_id=o.object_id where o.name = 'TABLENAME' and c.name like '%COLUMN NAME%' 
```

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2013-09-22T11:51:47.100

我是这样做的

```
SELECT 
    TOP 0
    *
FROM
    Posts 
```

它甚至在我不知道其服务表的[http://data.stackexchange.com中也有效！](http://data.stackexchange.com)

* * *

## 回答 #25

> 赞同：-4
> 
> 时间：2014-12-14T01:08:14.667

```
SELECT COLUMN_NAME 
FROM YourDatabase.INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME = 'YourTableName' 
```

# .net - Managment Studio 和 TableAdapter 之间存储过程的执行时间差异很大

> ID：452467
> 
> 赞同：2
> 
> 时间：2009-01-16T23:54:45.127
> 
> 标签：.net, sql-server, stored-procedures, timeout, tableadapter

存储过程如何通过 Management Studio 在 10 秒内运行，但通过 TableAdapter 需要 15 分钟才能获得相同的输入？它是可重复的，这意味着我在每个环境中至少运行了 3 次，而 Management Studio 始终快 100 倍左右。

我正在使用 .net 2.0 和 SQL Server 2000

在 SQL Server Management 中，我是这样执行的：

```
EXEC    [dbo].[uspMovesReportByRouteStep]
    @RouteStep = 12000,
    @RangeBegin = N'12/28/08',
    @RangeEnd = N'1/18/9' 
```

在 TableAdapter 中，我使用`StoredProcedure` `CommandType`and`dbo.uspMovesReportByRouteStep`作为`CommandText`. 我正在从 ASP.NET 页面调用表适配器，尽管如果我也尝试在本地“预览数据”它会在 30 秒内超时。

提供存储过程是不切实际的，因为它有超过 100 行长，并且依赖于许多其他 UDF 以及同一数据库和其他数据库上的视图。

使用任何一种方法，所有其他存储过程似乎都在大约同一时间运行。这怎么可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T00:04:38.150

这很可能是由于“参数嗅探”和缓存的查询计划不适合您调用它的参数的特定值。这是怎么发生的？好吧，当您第一次使用一组值调用 SP 时，将生成、参数化和缓存查询计划。如果使用另一组可能导致不同查询计划的参数值再次调用 SP，但它使用缓存的查询计划，则性能可能会受到影响。

这通常是因为统计数据已过时。您可以通过将估计执行计划与实际执行计划进行比较来确定是否是这种情况；如果不同，则统计数据很可能已过时。

我会首先尝试重建数据库的索引，或者至少更新它的统计信息（询问您的 DBA）。重建索引的一种方法（应该适用于 SQL Server 上的所有版本）：

```
exec sp_msforeachtable "dbcc dbreindex ('?')" 
```

如果仍然存在问题，请尝试暂时将语句添加`WITH RECOMPILE`到存储过程定义中。如果问题消失了，那么看看 using `OPTIMIZE FOR`，在[这篇](http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)博文中描述。

# sql - 在分组结果集上执行 count(*)

> ID：452472
> 
> 赞同：3
> 
> 时间：2009-01-16T23:56:14.533
> 
> 标签：sql, tsql

我正在尝试在存储过程中执行一个不错的 SQL 语句。

我查看了查看两个日期之间事件发生的天数的问题。我的例子是销售订单：这个月，我们有多少天有销售订单？

假设这个设置：

```
CREATE TABLE  `sandbox`.`orders` (
  `year` int,
  `month` int,
  `day` int,
  `desc` varchar(255) 
) 

INSERT INTO orders (year, month, day, desc)  
VALUES (2009,1,1, 'New Years Resolution 1')
      ,(2009,1,1, 'Promise lose weight')
      ,(2009,1,2, 'Bagel')
      ,(2009,1,12, 'Coffee to go') 
```

对于这个数据，结果应该是 3，因为已经有三天的销售。我找到的最佳解决方案如下。

但是，制作一个临时表，然后将其删除似乎多余。它“应该”在一个声明中是可能的。

有人比我有“更好”的解决方案吗？

/L

```
SELECT [Year], [Month], [Day]
INTO #Some_Days
FROM Quarter
WHERE Start >= '2009-01-01' AND [End] < '2009-01-16'
GROUP BY [Year], [Month], [Day]

SELECT count(*) from #Some_Days 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-17T00:28:37.963

如果我误解了这个问题，我深表歉意，但也许你可以做这样的事情，作为一种选择：

```
SELECT COUNT(*) FROM
    (SELECT DISTINCT(SomeColumn)
       FROM MyTable
      WHERE Something BETWEEN 100 AND 500
      GROUP BY SomeColumn) MyTable 
```

...绕过临时表的创建和处置？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T00:29:06.213

我可以看到两个基本选项。一种是将所有内容分组到一个子查询中，然后计算那些不同的行（Christian Nunciato 的回答）。第二个是组合多个字段并计算该组合值的不同值。

在这种情况下，以下公式将三个字段转换为单个日期时间。

```
DATEADD(YEAR, [Quarter].Year, DATEADD(MONTH, [Quarter].Month, DATEADD(DAY, [Quarter].DAY, 0), 0), 0) 
```

因此， COUNT(DISTINCT [formula]) 将给出您需要的答案。

```
SELECT
    COUNT(DISTINCT DATEADD(YEAR, [Quarter].Year, DATEADD(MONTH, [Quarter].Month, DATEADD(DAY, [Quarter].DAY, 0), 0), 0))
FROM
    Quarter
WHERE
    [Quarter].Start >= '2009-01-01'
    AND [Quarter].End < '2009-01-16' 
```

我通常使用子查询路线，但是根据您在做什么，索引，表的大小，公式的简单性等，这可以更快...

民主党。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T23:59:00.313

怎么样：

```
SELECT COUNT(DISTINCT day) FROM orders 
WHERE (year, month) = (2009, 1); 
```

实际上，我不知道 TSQL 是否支持元组比较，但你明白了。

`COUNT(DISTINCT expr)`是标准 SQL，应该可以在任何地方使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-22T08:36:48.320

您应该使用嵌套的 Select 语句。内部的应该包含 group by 子句，外部的应该计算它。我认为“Christian Nunciato”已经帮助了你。

```
Select Count(1) As Quantity
From
(    
    SELECT [Year], [Month], [Day]
    INTO #Some_Days
    FROM Quarter
    WHERE Start >= '2009-01-01' AND [End] < '2009-01-16'
    GROUP BY [Year], [Month], [Day]
) AS InnerResultSet 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T00:44:30.380

```
SELECT [Year], [Month], [Day]
FROM Quarter
WHERE Start >= '2009-01-01' AND [End] < '2009-01-16'
GROUP BY [Year], [Month], [Day]
COMPUTE COUNT(*) 
```

# oracle - 如何通过 HTTP Post 事务将 XML 检索到 Oracle PL/SQL？

> ID：452475
> 
> 赞同：2
> 
> 时间：2009-01-16T23:57:18.133
> 
> 标签：oracle, web-services, plsql, mod-plsql

我正在尝试使用 BloggerAPI 将 Flickr 的“blog this”功能实现到基于 pl/sql 的 CMS。

当 Flickr 向我发送发布事务时，HTTP 事务如下所示：

```
POST /pls/website/!pkg.procAPI HTTP/1.1
Host: www.mydomain.com
Accept: */*
User-Agent: Flickr
Content-Type: text/xml; charset=utf-8
Content-Length: 1220
Expect: 100-continue

<?xml version="1.0" encoding="utf-8"?>
<methodCall>
    <methodName>blogger.newPost</methodName>
    <params>
        <param><value><string>NO_APP_KEY</string></value></param>
        <param><value><string>1</string></value></param>
        <param><value><string>markj</string></value></param>
        <param><value><string>markj</string></value></param>
        <param><value><string>This is a test post from &lt;a href=&quot;http://www.flickr.com/r/testpost&quot;&gt;&lt;img alt=&quot;flickr&quot; src=&quot;http://www.flickr.com/images/flickr_logo_blog.gif&quot; width=&quot;41&quot; height=&quot;18&quot; border=&quot;0&quot; align=&quot;absmiddle&quot; /&gt;&lt;/a&gt;, a fancy photo sharing thing.</string></value></param>
        <param><value><boolean>1</boolean></value></param>
    </params>
</methodCall> 
```

但是我的服务器响应 HTTP-400 错误请求，错误消息是“签名不匹配或缺少 '='”，而我的 pl/sql 程序永远没有机会处理该请求。我怀疑在查看消息时灵活的参数传递会变得很糟糕，但我不知道还有什么办法

获取可用博客的过程似乎工作正常，但请求的内容没有将所有 html 实体作为消息的一部分：

```
 POST /pls/website/!pkg.procAPI HTTP/1.1
Host: www.mydomain.com
Accept: */*
User-Agent: Flickr
Content-Type: text/xml; charset=utf-8
Content-Length: 304

<?xml version="1.0" encoding="utf-8"?>
<methodCall>
    <methodName>blogger.getUsersBlogs</methodName>
    <params>
        <param><value><string>NO-APP-KEY</string></value></param>
        <param><value><string>mark</string></value></param>
        <param><value><string>markj</string></value></param>
    </params>
</methodCall> 
```

有没有办法直接从http请求的正文中获取xml数据？还是我正在寻找的其他方法？

谢谢，马克。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-18T16:41:44.620

我向 Oracle 打开了一个服务请求，他们确认 mod_plsql 不支持检索 httpheader 变量。以下是我对 SR 的讨论：

## 问题分析

我需要确认它，但到目前为止，Mark 的结论对我来说是正确的，即 MOD_PLSQL 总是调用和处理 PLSQL 过程，并且无法读取原始 HTTP 请求，因为 MOD_PLSQL 解析请求并检查是否存在 PLSQL 过程此名称以及是否有要传递的参数。如果没有要传递的参数，但我们提供了 XML 文档之类的其他内容，MODPLSQL 会感到困惑，并认为这是一对新的参数和值，而实际上并非如此。

# 回答

不，这是不可能的，因为 MOD_PLSQL 只处理带有参数的请求，这些参数可以被解析和翻译为带有多个参数的 PLSQL 过程调用。MOD_PLSQL 没有包含整个请求的“httprequest”变量的概念，就像 java 拥有 HTTPRequest 对象一样

## 问题分析

得到确认，除非我们将它作为参数传递，否则我们无法从 MOD_PLSQL 中读取它。换句话说，如果我们在 HTTP 请求正文中传递 XML 页面，我们需要使用类似 java 的东西，我们可以在原始模式下处理请求，并且我们可以读取任何 HTTP 标头和 http 正文而不受任何限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-18T16:48:27.427

xml可以作为文件附件发送吗？换句话说，改变：

`Content-Type: text/xml; charset=utf-8`

到

`Content-Type: multipart/form-data, boundary=AaB03x`

然后在xml之前添加：

`--AaB03x content-disposition: form-data; name="xmlfile"; filename="myfile.xml"
Content-Type: text/xml` 

 `这在xml之后：

`--AaB03x--`

现在，您设置了文件上传的过程，如本文所述： [使用 Web PLSQL 进行文件、上传和下载](http://www.smdi.com/employee/JohnF/articles/Files,%20Uploads%20and%20Downloads%20with%20Web%20PLSQL.zip)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T00:09:11.403

**使用 UTL_HTTP**

您可以使用 UTL_HTTP 包来执行此操作。

```
UTL_HTTP.read_text(
   r     IN OUT NOCOPY resp,
   data  OUT NOCOPY VARCHAR2,
   len   IN PLS_INTEGER DEFAULT NULL); 
```

*“UTL_HTTP 包支持 HTTP 1.1 分块传输编码。当响应正文以响应标头中指示的分块传输编码格式返回时，包会自动解码块并以去分块格式返回响应正文。”*

[http://download.oracle.com/docs/cd/B10500_01/appdev.920/a96612/u_http.htm](http://download.oracle.com/docs/cd/B10500_01/appdev.920/a96612/u_http.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T15:20:42.027

我遇到了与 MojoMark 相同的问题（尽管使用不同的外部应用程序）。MojoMark 的后续评论是正确的，read_text 信息没有回答问题。

像 MojoMark 一样，我正在尝试从外部实体接收 POST。我正在尝试编写的 PLSQL 是接收该 POST 并存储它。

我能够毫无问题地编写出站 POST XML，但无法设置接收它的过程。

问题似乎是 PLSQL 过程需要一个变量名，即： [http://server/modplsql/testload](http://server/modplsql/testload)， POST "data='data'"

但是，POST 的主体只是一个 XML 数据流，没有“=”为参数赋值，因此该函数得到“不匹配或缺少 '='””错误。

似乎应该有一种方法可以告诉 MODPLSQL 只接受像“典型”函数调用一样接受发布数据，但我认为我遗漏了一些明显的东西。

我试图用来接收帖子的基本功能是：procedure testload ( DATA in clob ) as BEGIN htp.print('Input POST stream was ' || DATA )
end testload;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-19T21:28:56.487

我可以看到这两个请求之间的唯一显着区别是“期望：100-继续”业务。这似乎是 HTTP 1.1 规范中的一个条款，它允许客户端将请求一分为二。基本上，客户端将标头发送给服务器，服务器必须做出选择。如果它对标头“满意”，它将给出 HTTP 100 响应以指示将接受消息的其余部分。

由于您从 Flickr 获取数据，因此我不确定您对客户端发出的 http 请求的控制级别。从服务器端，可能需要对 Apache 进行配置更改，或者它可能是 mod_plsql 中的一个错误，弹出“！” 灵活的参数标记。

不管怎样，现在的博主api都不是这样的。您可能应该迁移到新的 GData API。

# algorithm - 是否有确定网格中连续彩色区域的算法？

> ID：452480
> 
> 赞同：10
> 
> 时间：2009-01-16T23:58:10.347
> 
> 标签：algorithm, cellular-network

给定一个基本网格（如一张方格纸），其中每个单元格都随机填充了 n 种颜色中的一种，是否有一种经过验证的真实算法可以告诉我哪些连续区域（相同的单元格组侧面连接的颜色）有吗？假设 n 是合理的，比如 5。

我有一些想法，但他们都觉得非常低效。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T00:02:47.280

最好的算法是 O（细胞数），与颜色的数量无关。

这可以通过遍历单元格来实现，每次访问尚未标记为已访问的单元格时，进行图遍历以找到该区域中的所有连续单元格，然后继续迭代。

编辑：

这是一个简单的深度优先搜索伪代码示例，这是一个易于实现的图遍历：

```
function visit(cell) {
    if cell.marked return
    cell.marked = true
    foreach neighbor in cell.neighbors {
        if cell.color == neighbor.color {
            visit(neighbor)
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T00:35:47.400

除了递归的递归答案，如果递归太慢，您可以使用堆栈：

```
function visit(cell) {
    stack = new stack
    stack.push cell

    while not stack.empty {
        cell = stack.pop
        if cell.marked continue
        cell.marked = true
        foreach neighbor in cell.neighbors {
            if cell.color == neighbor.color {
                stack.push neighbor
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T00:01:33.257

您可以尝试在每个方格上进行洪水填充。随着洪水的蔓延，将网格正方形记录在数组或其他东西中，并将它们涂上未使用的颜色，例如-1。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T00:07:58.127

关于洪水填充的维基百科文章可能对您有用：[http ://en.wikipedia.org/wiki/Flood_fill](http://en.wikipedia.org/wiki/Flood_fill)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T00:57:32.693

[Union-find](http://en.wikipedia.org/wiki/Union-find "不相交集数据结构")也可以在这里工作。实际上，您可以将您的问题表述为关于图的问题：顶点是网格单元，如果两个顶点的网格单元具有相同的颜色，则它们是相邻的。您正在尝试查找连接的组件。

使用 union-find 数据结构的方式如下：首先创建一个 union-find 数据结构，其中包含与单元格一样多的元素。然后遍历单元格，`union`如果它们具有相同的颜色，则遍历两个相邻的单元格。最后，`find`在每个单元上运行并存储响应。具有相同颜色的单元格`find`位于相同的连续彩色区域中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T20:13:06.363

如果您想要更细粒度的控制，您可能会考虑使用[A*](http://en.wikipedia.org/wiki/A*)算法并使用启发式方法来包含类似颜色的图块。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-18T17:12:16.163

您遍历扫描线中的区域，从左到右从上到下。对于每个单元格，您创建一个单元格列表，这些单元格在单元格之间共享为相同的内存对象。对于每个单元格，您将当前单元格添加到列表中（与其共享或创建）。然后，如果右侧或下方的单元格颜色相同，您将与该单元格共享该列表。如果该单元格已经有一个列表，则合并列表并将列表中列出的每个单元格中对列表对象的引用替换为新的合并列表。

然后位于每个单元格中的是对包含该单元格的每个连续单元格的列表的引用。这恰当地结合了每个单元之间的填充工作。而不是为每个单元格重复它。由于您有列表用合并的数据替换数据，因此只是迭代列表。它将是 O(n*c)，其中 n 是单元格的数量，c 是图形连续性的度量。一个完全脱节的网格将是 n 次。一个完全连续的 1 颜色图，为 n^2/2。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-05T06:39:49.947

我在视频中听到了这个问题，也在这里找到了它，我想出了我在搜索中看到的最佳方法。以下是算法的基本步骤：

*   从左上角到右下角循环遍历数组（假设颜色网格表示为二维数组）。
*   当你浏览第一行时，只需检查左边的颜色，看看它是否是相同的颜色。当您遍历所有后续行时，检查上方的单元格和左侧的单元格 - 这比每次检查顶部、底部、左侧和右侧更有效。不要忘记检查左侧单元格是否超出范围。
*   创建一个类型的字典，`<int,Dictionary<int,Hashset<cell>>>`用于在这些颜色中存储颜色和组。Hashset 包含单元格位置（具有 2 个属性的单元格对象：int 行、int 列）。
*   如果单元格没有在顶部或左侧连接到相同颜色的单元格，则创建一个新的字典条目，在该条目中创建一个新的颜色组，并将当前单元格添加到该组（哈希集）。否则它*连接*到另一个相同颜色的单元格；将当前单元格添加到包含它所连接的单元格的颜色组。
*   如果在某个时候您遇到一个在顶部和左侧具有相同颜色的单元格，如果它们都属于相同的颜色组，那么这很容易，只需将当前单元格添加到该颜色组即可。否则检查左上角的小猫角单元格。如果它与当前单元格的颜色不同，并且顶部的单元格和左侧的单元格属于不同的颜色组 --> 将 2 个颜色组合并在一起；将当前单元格添加到组中。
*   最后，遍历所有 Hashset 以查看哪个具有最高计数 - 这将是返回值。

这是我制作的带有视觉和完整解释的视频的链接： [https ://d.tube/#!/v/israelgeeksout77/wm2ax1vpu3y](https://d.tube/#!/v/israelgeeksout77/wm2ax1vpu3y)

PS 我在 GeeksForGeeks 上找到了这篇文章[https://www.geeksforgeeks.org/largest-connected-component-on-a-grid/](https://www.geeksforgeeks.org/largest-connected-component-on-a-grid/)

他们方便地以多种语言发布了这个问题的源代码！但是我尝试了他们的代码和我的代码，我的运行时间大约是 1/3。

# c++ - 什么时候调用构造函数？

> ID：452498
> 
> 赞同：5
> 
> 时间：2009-01-17T00:04:59.960
> 
> 标签：c++, multithreading, locking

如果我在函数的中途定义一个类的局部变量实例而不使用指针和 new，构造函数是否在进入函数时被调用或在哪里定义？

如果我在文件中全局定义一个类的另一个实例，那么在首次加载可执行文件时会调用该构造函数吗？如果多个线程正在访问 .dll 怎么办？

最后，您在 .dll、.so、.exe 和 linux 可执行文件中的答案是否相同？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T00:07:55.133

> 如果我在函数的中途定义一个类的局部变量实例而不使用指针和 new，构造函数是否被调用或进入函数或定义它的位置？

当它被定义时。

> 如果我在文件中全局定义一个类的另一个实例，那么在首次加载可执行文件时会调用该构造函数吗？

是的。

> 如果多个线程正在访问 .dll 怎么办？

DLL 通常只为整个应用程序加载一次——事实上，DLL 也有一个入口点，由应用程序的线程调用，但全局变量初始化在此之前发生并且只加载一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T13:45:36.403

> 如果我在函数的中途定义一个类的局部变量实例而不使用指针和 new，构造函数是否在进入函数时被调用或在哪里定义？

此类变量具有局部范围。它们的构造函数在定义时被调用。对于局部静态，构造函数只被调用一次，因为静态将在多次函数调用和返回中存活下来。顺序很重要，是定义的顺序：

```
void foo() {
    ....
    if(cond) {
        ...
        // called here: first for f, then for b
        static Foo f;
        static Bar b;
    }

    ...
    Foo f; // not static: called here, in every invocation of foo.
} 
```

> 如果我在文件中全局定义一个类的另一个实例，那么在首次加载可执行文件时会调用该构造函数吗？

是的，据说这样的变量具有静态存储持续时间和命名空间范围。它的构造函数在程序启动时被调用。顺序是它在文件中定义的顺序。也就是说，稍后定义的变量将在稍后调用其 ctor。未定义在不同翻译单元中定义的变量的顺序（注意*静态初始化顺序 fiasco*）。但是它们都在程序开始时被调用。

> 如果多个线程正在访问 .dll 怎么办？

所有的赌注都取消了。该变量仅构造一次。之后，当您启动线程并访问它时，变量必须是线程安全的，或者线程在访问变量时必须进行适当的锁定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T17:18:41.067

对于 .dll，它取决于编译器和 C 运行时 (CRT)。对于随 Visual Studio 2008 SP1 发布的 MSVC，.dll 的 CRT 将在时间初始化全局对象并在`DLL_PROCESS_ATTACH`时间销毁它们`DLL_PROCESS_DETACH`，假设在 .dll 期间没有发生任何可怕的事情`DLL_PROCESS_ATTACH`。

# sql - 查询最大同时事件数

> ID：452499
> 
> 赞同：5
> 
> 时间：2009-01-17T00:06:27.727
> 
> 标签：sql, mysql, postgresql

我有一个简单的事件表：

```
event_id | start_time | end_time 
```

如何查询最大同时事件数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T11:40:24.360

我的答案与哈利的第一个答案非常相似。不过，我会尝试进行稍微不同的性能优化...跳到最后以避免对原因的漫无边际的解释...

哈利的第一个答案（核心逻辑）

```
SELECT MAX(overlapAtEnd)
FROM
(
    SELECT 
        COUNT(1) AS overlapAtEnd                        
    FROM 
        your_table AS t1, 
        your_table AS t2
    WHERE 
        t1.end_time BETWEEN t2.start_time AND t2.end_time
    GROUP BY t1.event_id
) AS foo 
```

处理时间最长的地方是连接。

对于表中的每条记录，您选择 (t1.end time)。然后，您再次在表中搜索 (t1.end_time >= start_time) 和您搜索的所有匹配记录 (t1.end_time <= t1.end_time)

现在，您可以很容易地在 start_time 上创建索引。这使得第一次检查 (t1.end_time >= start_time) 更快；
- 索引是用于极快搜索的搜索树
- 这使得找到第一个匹配记录非常快速
- 索引本质上是有序的
- 这意味着它知道“第一个匹配后的所有内容也匹配”

最后一部分是关键，因为这意味着......即使在使用索引进行第一次检查（t1.end_time >= start_time）之后，我们仍然可以留下很多记录来进行第二次检查（t1\. end_time <= t1.end_time)

[在索引中包含 end_time 在这里没有帮助，很快就会讨论]

```
0, '10:00', '10:04'   COUNT(*) WHERE '10:04' >= start_time  ==  4
1, '10:01', '10:06'   COUNT(*) WHERE '10:06' >= start_time  ==  4
2, '10:02', '10:09'   COUNT(*) WHERE '10:09' >= start_time  ==  5
3, '10:04', '10:07'   COUNT(*) WHERE '10:07' >= start_time  ==  4
4, '10:08', '10:12'   COUNT(*) WHERE '10:12' >= start_time  ==  6
5, '10:12', '10:17'   COUNT(*) WHERE '10:17' >= start_time  ==  7
6, '10:15', '10:18'   COUNT(*) WHERE '10:18' >= start_time  ==  8
7, '10:18', '10:22'   COUNT(*) WHERE '10:22' >= start_time  ==  10
8, '10:19', '10:24'   COUNT(*) WHERE '10:24' >= start_time  ==  10
9, '10:22', '10:25'   COUNT(*) WHERE '10:25' >= start_time  ==  10

=> leaves 68 rows to check the second condition; (t1.end_time <= t1.end_time) 
```

假设事件的分布相对平滑，每条记录将（大约和平均）与一半的表匹配。这意味着您正在 (n*n/2) 检查其中 n 是表中的记录数。即使有 100 条记录，这也会提供 5000 次检查。在 2000 条记录中，您进行了大约 200 万次检查！

自然倾向于将 end_time 字段添加到索引中。然而，这无济于事。(start_time, end_time) 的索引创建一个搜索树，直到每个唯一的 start_time，然后在每个唯一的 start_time 下都有一个用于 end_times 的单独搜索树。

在我上面的示例中，每个 start_time 都是唯一的。这意味着您仍然需要进行所有 68 次 end_time 检查。只有 start_time 检查受益于索引。

我们需要做的是尝试使用单个“start_time”索引来做更多的事情。我们需要为查询引擎提供更多信息。

一个例子是使用“最大事件持续时间”。例如，我们可能会发现没有事件持续时间超过 8 分钟。这会给我们以下查询......

```
SELECT MAX(overlapAtEnd)
FROM
(
    SELECT 
        COUNT(1) AS overlapAtEnd                        
    FROM 
        your_table AS t1, 
        your_table AS t2
    WHERE 
            t1.end_time >= t2.start_time
        AND t1.end_time <= t2.end_time
        AND t1.end_time <= t2.start_time + [max_event_duration] 
    GROUP BY t1.event_id
) AS foo 
```

在我上面给出的示例中应用 8 分钟持续时间的示例，我们将 68 次 end_time 检查减少到 34 次。

```
0, '10:00', '10:04'   COUNT(*) WHERE '10:04' BETWEEN start_time AND start_time + 8 == 4
1, '10:01', '10:06'   COUNT(*) WHERE '10:06' BETWEEN start_time AND start_time + 8 == 4
2, '10:02', '10:09'   COUNT(*) WHERE '10:09' BETWEEN start_time AND start_time + 8 == 4
3, '10:04', '10:07'   COUNT(*) WHERE '10:07' BETWEEN start_time AND start_time + 8 == 4
4, '10:08', '10:12'   COUNT(*) WHERE '10:12' BETWEEN start_time AND start_time + 8 == 3
5, '10:12', '10:17'   COUNT(*) WHERE '10:17' BETWEEN start_time AND start_time + 8 == 2
6, '10:15', '10:18'   COUNT(*) WHERE '10:18' BETWEEN start_time AND start_time + 8 == 3
7, '10:18', '10:22'   COUNT(*) WHERE '10:22' BETWEEN start_time AND start_time + 8 == 4
8, '10:19', '10:24'   COUNT(*) WHERE '10:24' BETWEEN start_time AND start_time + 8 == 3
9, '10:22', '10:25'   COUNT(*) WHERE '10:25' BETWEEN start_time AND start_time + 8 == 3

=> leaves 34 rows to check the second condition; (t1.end_time <= t1.end_time)
=> thats half the original 68, and on bigger tables the benefit increases... 
```

即使我们不知道事件永远不会超过 8 分钟，我们也可以通过检查 10 条记录找到它。超过 10 条记录的 MAX(end_time - start_time) 仍然比超过 34 条记录组合的检查 (t1.end_time <= t1.end_time) 快。

并且随着桌子大小的增加，收益也会增加。事实上，在 [max_event_duration] 明显小于表所涵盖的整个时间跨度的情况下，您可以将 (n *n/2) 平方定律更改为更类似于 (n* x + n) 的线性定律。

民主党。

```
SELECT
   MAX(overlapAtEnd)
FROM
(
    SELECT 
        COUNT(1) AS overlapAtEnd                        
    FROM 
        your_table AS t1, 
        your_table AS t2
    WHERE 
            t2.start_time <= t1.end_time
        AND t2.start_time >= t1.end_time - (SELECT MAX(end_time - start_time) FROM your_table)
        AND t2.end_time   >= t1.end_time
    GROUP BY t1.event_id
) AS foo 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T00:48:53.583

[正如其他答案所指出的，这可能与此问题](https://stackoverflow.com/questions/419122/logging-user-logins-for-the-purpose-of-reporting-that-the-client-is-exceeding-num)非常相似，具体取决于您的意思。

不幸的是，我提出的解决方案（这是公认的答案）需要你重新设计你的桌子。但是，它可以让您通过检查“SessionCount”（或类似名称）列轻松确定最大同时事件数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T00:28:49.303

我会多次这样做，这是一个非常缓慢的解决方案~~但可能没有一种非常快速的方法可以做到这一点。~~并且基于 Daniel Paull 的答案的解决方案会快得多。

按开始时间对您的活动进行排序。循环遍历事件并找到没有事件的间隙，将这些间隙之间的事件分组。循环遍历每个组中的每个时间（以记录您的时间的任何分辨率）并查询当时正在进行的事件。根据您的编程语言的速度与 DB 查询的速度，您可能会查看重叠事件并向前跳到其中一个重叠事件的第一个 end_time。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T02:09:19.710

由于您的高峰时间总是在 end_time 结束，您可以像 Sparr 建议的那样检查这些时间。因此，请执行查询以两次连接同一个表，并计算事件在每个 end_time 重叠的行数。然后取其最大值。

这会给你你的答案，但缓慢：

```
SELECT MAX(overlapAtEnd)
FROM
(
    SELECT 
        COUNT(1) AS overlapAtEnd            
    FROM 
        your_table AS t1, 
        your_table AS t2
    WHERE 
        t1.end_time BETWEEN t2.start_time AND t2.end_time
    GROUP BY t1.event_id
) AS foo 
```

把它分成更小的组（比较少），然后让这些更小的组中的最大值显着加快它：

```
SELECT MAX(maxOLP)
FROM
(
    SELECT MAX(olp) AS maxOLP
    FROM
    (
        SELECT 
            MAX(overlapAtEnd) AS maxOLP,
            EXTRACT(HOUR FROM t1.end_time)  AS hr
        FROM
        (
            SELECT 
                COUNT(1) AS overlapAtEnd            
            FROM 
                your_table AS t1, 
                your_table AS t2
            WHERE 
                t1.end_time BETWEEN t2.start_time AND t2.end_time
            GROUP BY t1.event_id
        ) AS foo
        GROUP BY t1.event_id, EXTRACT(HOUR FROM t1.end_time)
    ) AS foo
    GROUP BY hr
) AS foo2 
```

这种更快的方法有一个小缺点......如果您的事件通常跨越一个多小时，那么在下一小时结束的事件可能仍然重叠但不会被计算在内。要解决此问题，只需按较大的时间间隔（例如一天或一周）进行分组。有点毛茸茸，但效果很好，并且很快就会为您提供听起来像您正在寻找的结果。

# service - 此实体存储库服务示例是否适合领域驱动设计？

> ID：452517
> 
> 赞同：0
> 
> 时间：2009-01-17T00:13:29.710
> 
> 标签：service, model, domain-driven-design, entity, repository-pattern

我想知道您是否发现以下模式在域驱动设计中有意义。

领域层由模型和存储库组成。应用层由处理来自用户界面或模型-视图-控制器模式中控制器的查询的服务组成。

结构细节：

```
// 装配模型：
公开课短语
{
    公共 int PhraseId { 获取；私人套装；}
    公共字符串 PhraseText { 获取；私人套装；}

    公共短语（字符串短语文本）{ this.PhraseText = 短语文本；}

    public void SetId(int phraseId) { this.PhraseId = phraseId; }
}

// 程序集存储库（引用程序集模型）：
公共接口 IPhraseRepository
{
    短语 SavePhrase(短语短语);
    短语 GetPhrase(int phraseId);
}

// 装配服务（引用装配模型和存储库）：
公共类 PhraseService
{
    私有IPhraseRepository _phraseRepository；
    公共短语服务（IPhraseRepository 短语存储库）
    {
        _phraseRepository = 短语存储库；
    }
    公共短语 SavePhrase（字符串短语文本）
    {
        短语短语 = _phraseRepository.SavePhrase( new Phrase(phraseText) );
        // 做其他事情，如发送邮件、日志记录等。
        // ...
        返回短语；
    }
}

```

特别是，将方法移动到 Phrase 实体类中是否有意义？那样的话，怎么称呼？

编辑：

上面的示例在 moffdub 的回答和 Adeel Ansari 的评论后进行了修改。更改**突出显示**。

我想问一下添加的 IPhraseRepository.GetPhrase(phraseId) 以及如何包含它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T00:48:54.987

存储库应该接受一个短语，而不是一个字符串。我也不确定为什么 SavePhrase 方法返回一个短语。我倾向于使这些方法无效。

此外，请注意不要让域模型中的每个属性都具有公共 getter 和 setter。这可能会导致您陷入贫乏的领域模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T10:11:15.167

只是一些想法：

SetId(int phraseId) 不应公开

Phrase 可以实现不会暴露 SetId(..) 的 IPhrase（或 IPhraseAggregate）

如果对短语实体的引用在保存后保持“有效”，则 SavePhrase(Phrase phrase) 可以（应该？）返回 void：

```
public void SavePhrase(string phraseText)
{
    Phrase phrase = new Phrase(phraseText); // NOTE: keep a reference to phrase
    this._phraseRepository.SavePhrase(phrase); // NOTE: returns void

    return phrase; // NOTE: assume the repository sets the phrase.PhraseId
} 
```

# python - wxPython 的 SuggestBox？

> ID：452520
> 
> 赞同：4
> 
> 时间：2009-01-17T00:14:24.840
> 
> 标签：python, search, wxpython, suggestbox

是否有类似Google Web Toolkit 中的[SuggestBox的 wxPython 小部件？](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/index.html)它基本上是一个神奇的文本框，可以调用一些代码来提出与用户迄今为止输入的内容相关的建议。就像谷歌网页上的搜索框一样。

如果这样的小部件还没有浮出水面，我会很感激我如何用现有的小部件实现它的草图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T13:42:08.353

你可能想看看[Combo Box that Suggests Options](http://wiki.wxpython.org/Combo%20Box%20that%20Suggests%20Options)。

我希望这是你的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-29T14:38:40.370

几年前，我通过继承 TextCtrl 制作了一个这样的控件。它支持 HTML 格式的建议。[干得好。](http://bitbucket.org/raz/wxautocompletectrl)

# perl - 如何在 Perl 中迭代/取消引用一组子例程 refs？

> ID：452529
> 
> 赞同：4
> 
> 时间：2009-01-17T00:19:20.960
> 
> 标签：perl, function, iterator

我试图弄清楚如何迭代一组子程序参考。

这种语法有什么问题？

```
use strict;
use warnings;

sub yell { print "Ahh!\n"; }
sub kick { print "Boot!\n"; }
sub scream { print "Eeek!\n"; }

my @routines = (\&yell, \&kick, \&scream);
foreach my $routine_ref (@routines) {
  my &routine = &{$routine_ref};
  &routine;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T01:00:05.590

在您的`foreach`循环中，以下是语法错误：

```
my &routine; 
```

您的变量`$routine_ref`已经引用了子例程，所以此时您需要做的就是调用它：

```
for my $routine_ref (@routines) {
    &{$routine_ref};
} 
```

与 Perl 一样，“有不止一种方法可以做到这一点”。例如，如果这些子例程中的任何一个带有参数，您可以将它们传递到括号中，如下所示：

```
for my $routine_ref (@routines) {
  $routine_ref->();
} 
```

另请注意，我使用`for`了而不是，这是[Damian Conway 在 Perl Best Practices 中](http://oreilly.com/catalog/9780596001735/)`foreach`提出的最佳实践。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T00:41:20.870

```
foreach my $routine_ref (@routines) {
        $routine_ref->();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T00:30:27.303

试试这个：

```
use strict;
use warnings;

sub yell { print "Ahh!\n"; }
sub kick { print "Boot!\n"; }
sub scream { print "Eeek!\n"; }

my @routines = (\&yell, \&kick, \&scream);
foreach my $routine_ref (@routines) {
  &$routine_ref ();
} 
```

# cocoa - 如何判断 QTMovie 何时开始播放？

> ID：452530
> 
> 赞同：3
> 
> 时间：2009-01-17T00:20:52.487
> 
> 标签：cocoa, quicktime, qtkit

`QTMovie`有，`QTMovieDidEndNotification`但没有`QTMovieDidStartNotification`。`QTMovie`开始播放时如何通知我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T03:54:13.583

回答我自己的问题：`QTMovieRateDidChangeNotification`电影开始播放时激活。当然，文档实际上并没有记录这一点。呸。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T03:55:56.110

Quicktime 将开始和暂停视为速率分别更改为 100% 和 0%。QTMovieRateDidChangeNotification 是您想要的，并检查适当的费率。

# python - 这个 Python 消息是什么意思？

> ID：452532
> 
> 赞同：-1
> 
> 时间：2009-01-17T00:22:25.713
> 
> 标签：python, macos, installation, beautifulsoup, easy-install

```
ho-fe3fdd00-12:~ Sam$ easy_install BeautifulSoup
Traceback (most recent call last):
  File "/usr/bin/easy_install", line 8, in <module>
    load_entry_point('setuptools==0.6c7', 'console_scripts', 'easy_install')()
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/setuptools/command/easy_install.py", line 1670, in main
    with_ei_usage(lambda:
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/setuptools/command/easy_install.py", line 1659, in with_ei_usage
    return f()
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/setuptools/command/easy_install.py", line 1674, in <lambda>
    distclass=DistributionWithoutHelpCommands, **kw
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/core.py", line 125, in setup
    dist.parse_config_files()
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/dist.py", line 373, in parse_config_files
    parser.read(filename)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/ConfigParser.py", line 267, in read
    self._read(fp, filename)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/ConfigParser.py", line 462, in _read
    raise MissingSectionHeaderError(fpname, lineno, line)
ConfigParser.MissingSectionHeaderError: File contains no section headers.
file: /Users/Sam/.pydistutils.cfg, line: 1
'install_lib = ~/Library/Python/$py_version_short/site-packages\n' 
```

我正在尝试安装beautifulsoup。~/.pydistutils.cfg 中的前两行：

```
install_lib = ~/Library/Python/$py_version_short/site-packages
install_scripts = ~/bin 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T01:17:03.497

BeautifulSoup 是一个纯 Python 模块，您可以通过获取 BeautifulSoup.py 文件（例如，从标准 .tar.gz 发行版内部）并将其放在 PythonPath 上的某个位置来安装它 - 例如。在 /Users/Sam/Library/Python/2.5/site-packages 中，如果错误消息中提到的路径是准确的。

无需繁琐且容易出错的安装程序，这会使问题过于复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T00:26:07.483

配置文件 .pydstutils.cfg 有语法错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T01:10:25.833

尝试在顶部添加该行`~/.pydistutils.cfg`：

```
[easy_install] 
```

# sql-server - SSAS 立方体设计、半加法测量和运行总计

> ID：452550
> 
> 赞同：1
> 
> 时间：2009-01-17T00:36:49.787
> 
> 标签：sql-server, ssas, business-intelligence, cubes

我的 SSAS 多维数据集对我来说有点棘手的设计问题。这个问题与一般会计实践有关，我有一个包含金融交易（即分类帐）的事实表，并且每笔交易都标有交易日期和期间。该时期与一天或一系列天没有直接关系。如果用户完成了几个月的工作，他们可能会在一天中关闭一段时间。

我需要能够按日期和期间报告应收帐款 (AR)。我没有使用 SSAS 企业版，因此​​我无法使用时间智能半加法选项，即使它们是它们也只允许一个时间维度使用非标准聚合，我相信在这种情况下我需要两个允许这个。

Accounts Receivable 是一个运行总计，它应该是最新选择的分类帐项目及其之前的所有项目的总和。我知道如何在 MDX 中针对单个时间维度进行此计算，但是如何允许它与两个时间维度、交易日期和期间结束一起使用？在这种情况下，周期关闭是否甚至被视为“时间”维度？它确实具有时间方面，我确实想要从所有时期到当前的总和。

我对如何将两个时间维度与单个事实表相关联并为每个维度使用不同的聚合感到困惑。也许这里最好的解决方案是有两个定期快照表（而不是试图从 FactLedger 表中聚合此信息），一个按交易日期汇总，一个按期间汇总，这是我目前倾向于的解决方案，但我希望能再观点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T13:45:01.917

你当然可以在一个多维数据集中拥有多个时间维度，在这种情况下，我实际上只是创建一个公共时间维度，并让它扮演两个角色，交易日期和期间结束。要角色扮演一个维度，只需在多维数据集设计器的维度使用选项卡中再次将其添加到多维数据集并重命名它。适当地设置您的引用以关闭两个不同的事实列。

或者也许我没有正确理解这个问题。这听起来很简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:41:26.223

您可以使用句点创建自己的时间表，并且可以更改 fact_table 的日期时间格式以匹配您的时间表。那么一维就足够了。

# asp.net - 自包含的基于 Web (ASP.NET) 的画廊查看器

> ID：452551
> 
> 赞同：0
> 
> 时间：2009-01-17T00:40:10.387
> 
> 标签：asp.net, image-gallery

我需要在我的网站上添加一个画廊，以显示网站和应用程序的屏幕截图。

我运行 IIS。

我正在寻找一些相当独立且无需大量工作即可集成的东西。我想通过目录中的一堆图像，然后放手。

我会喜欢一些不错的效果来浏览画廊。

你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T01:22:37.383

您可能想查看用于 ASP.NET 2.0的[nGallery 。](http://chrison.net/nGalleryUpdatedForASPNET20.aspx)我支持使用旧版本的应用程序。但是，没有使用此特定版本的经验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T17:23:02.203

考虑 Gallery Server Pro ( [www.galleryserverpro.com](http://www.galleryserverpro.com) )。它是一个基于 ASP.NET 的免费开源 Web 画廊，已经存在好几年了。使用自包含的 ascx 用户控件可以轻松集成到现有站点中。

免责声明：我是创作者和首席开发者。

# c# - C# vs VB.NET 在工具支持方面？

> ID：452552
> 
> 赞同：-1
> 
> 时间：2009-01-17T00:41:00.043
> 
> 标签：c#, vb.net

虽然在大多数情况下您可以生成相同的 MSIL，但在工具方面肯定存在差异。 例如，[PEX与 C# 一起工作要容易得多。](http://research.microsoft.com/en-us/projects/Pex/)

哪些 Microsoft 或 3rd 方工具不能同样适用于两种语言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T01:03:35.223

我想这个答案取决于你所说的工具支持是什么意思。

例如，在 IDE 支持方面，VB 比 C# 做得更多。它只是有一个更好的IDE。

它具有非常好的背景编译和非常好的智能。

在支持 MS 研究项目或 XBox 等“新”平台时，VB 可能会落后于 C#。

对于 MS 开发部门或 Office 所做的事情，您应该期望两种语言之间或多或少平等的支持。

对于其他小组，例如您提到的 MS 研究项目，多语言平等通常不是优先事项。在这些情况下，他们似乎倾向于将 C# 作为默认选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T02:58:47.800

Ektron CMS 400 绝对比 C# 更 VB。但如果你使用 Ektron，你有更大的问题需要担心......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T03:04:48.537

在代码分析方面，Re-sharper 对 C# 的支持比对 VB 的支持更多。

[这里](http://www.jetbrains.com/resharper/features/index.html)有 VB 和 C# .NET 之间差异的完整列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T11:21:31.833

VB.NET 的一大缺失是[StyleCop](http://code.msdn.microsoft.com/sourceanalysis "风格警察")，我希望他们的开发团队也能提供 VB.NET 版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T17:00:02.633

**更好地支持 C#**

*   风格警察
*   PEX
*   再锐化

**更好地支持 VB.NET**

*   智能感知

（这是维基...请添加更多）

# rss - RSS 提要股票

> ID：452553
> 
> 赞同：-1
> 
> 时间：2009-01-17T00:41:11.477
> 
> 标签：rss, feed, stocks

直到今天我才意识到您无法获取股票报价的 RSS 提要。有人可以向我建议如何从服务中提取特定股票报价的数据吗？它应该包括有关股票等的信息。谢谢。我将在.NET 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T01:06:46.403

雅虎！提供股票数据的 CSV 提取。

[http://www.gummy-stuff.org/Yahoo-data.htm](http://www.gummy-stuff.org/Yahoo-data.htm)

# .net - ASP.net 3.0 的 MVC 框架？

> ID：452556
> 
> 赞同：2
> 
> 时间：2009-01-17T00:42:10.180
> 
> 标签：.net, asp.net

我目前坚持使用 ASP.net 3.0，这意味着我不能使用 ASP.net MVC 和 ADO.net EF。虽然我可以用 Subsonic 或 ActiveRecord 替换 EF，但我想知道你们为 MVC 推荐什么？我对漂亮的 URL 以及 View 和 Controller 之间的分离感兴趣，这是我在 Webforms 中一直很难找到的两件事。

现在，我会给[Castle MonoRail](http://www.castleproject.org/monorail/index.html)一个旋转，但如果你有更多的建议，我也会很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T04:36:52.717

[Castle MonoRail](http://www.castleproject.org/monorail/index.html)似乎确实是 .net 2.0/3.0 的唯一严肃的 MVC 框架，所以我将继续使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T04:41:30.557

有一个 hacky、非官方、不受支持的解决方法，允许您在 .NET 2.0（可能还有 .NET 3.0）上部署 ASP.NET MVC。

[http://www.hanselman.com/blog/DeployingASPNETMVCONASPNET20.aspx](http://www.hanselman.com/blog/DeployingASPNETMVCOnASPNET20.aspx)

# c# - C# 枚举属性 null vs. 0

> ID：452560
> 
> 赞同：2
> 
> 时间：2009-01-17T00:46:56.677
> 
> 标签：c#, web-services, serialization, enums, null

我正在使用 IIS/asmx 来支持 Flash 客户端。我的一些服务层数据传输对象具有枚举值属性。在某些情况下，这些属性应该为空。

当将此类枚举属性的值为空的对象呈现给soap时，我收到此错误：

```
System.InvalidOperationException: There was an error generating the XML document. ---> System.InvalidOperationException: Instance validation error: '0' is not a valid value for NameSpaceX.Model.NodeType.
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write1_NodeType(NodeType v)
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write4_PackageDTO(String n, String ns, PackageDTO o, Boolean isNullable, Boolean needType)
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write15_ArrayOfPackageDTO(Object o)
   at Microsoft.Xml.Serialization.GeneratedAssembly.ListOfPackageDTOSerializer1.Serialize(Object objectToSerialize, XmlSerializationWriter writer)
   at System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter, Object o, XmlSerializerNamespaces namespaces, String encodingStyle, String id)
   --- End of inner exception stack trace ---
   at System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter, Object o, XmlSerializerNamespaces namespaces, String encodingStyle, String id)
   at System.Xml.Serialization.XmlSerializer.Serialize(TextWriter textWriter, Object o, XmlSerializerNamespaces namespaces)
   at System.Xml.Serialization.XmlSerializer.Serialize(TextWriter textWriter, Object o)
   at System.Web.Services.Protocols.XmlReturnWriter.Write(HttpResponse response, Stream outputStream, Object returnValue)
   at System.Web.Services.Protocols.HttpServerProtocol.WriteReturns(Object[] returnValues, Stream outputStream)
   at System.Web.Services.Protocols.WebServiceHandler.WriteReturns(Object[] returnValues)
   at System.Web.Services.Protocols.WebServiceHandler.Invoke() 
```

有没有更好的解决方案来创建一个值为 0 的枚举成员（例如 [0，“null”]？我怀疑我在这里缺乏基本知识。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T00:53:28.550

我的第一个倾向是给你指出`Nullable<T>`类型。但是，在四处寻找有关`Nullable<T>`SOAP 的文档后，似乎它可能不受支持。您可能想进一步探索这一点。

也就是说，Enums 声明一个`NotSet = 0`成员是很常见的。

# ruby-on-rails - 运行 rake rails:update 后的细微细节

> ID：452561
> 
> 赞同：2
> 
> 时间：2009-01-17T00:47:47.080
> 
> 标签：ruby-on-rails

我使用`rake rails:update`. 这更新`config/boot.rb`了原型和 .scriptaculous 文件`public/javascripts`。

然后我创建了两个新的 Rails 应用程序，每个版本的 Rails 一个。

比较这两个应用程序，我注意到有更多不同的文件（`production.rb`、`new_rails_defaults.rb`、`database.yml`等）

我是否应该在升级的应用程序中手动更新这些文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T08:03:28.340

*   `database.yml`包含您的数据库配置。只要您的数据库连接正常，就不要更新它。
*   `new_rails_defaults.rb`包含在新 Rails 版本中更改的新默认设置。通常，您不必复制它们，它们甚至可能会破坏您当前的应用程序。但是，您可以查看这些设置，查看它们，看看新的默认设置是否也对您的应用程序有用。
*   同样适用于`production.rb`：查看差异并仅在它们对您有用时才应用它们，并且不要破坏您的应用程序。

# asp.net-mvc - 如何访问视图中的 ViewData 属性？

> ID：452567
> 
> 赞同：3
> 
> 时间：2009-01-17T00:49:25.160
> 
> 标签：asp.net-mvc

我正在构建我的第一个基于 ASP.Net MVC 的应用程序，并且在我的一个视图中访问 linq to sql 查询的结果时遇到问题。

这是我的控制器：

```
 public ActionResult Details(int id)
    {
        var dataContext = new BuffetSuppliersDBDataContext();
        var supplier = from m in dataContext.BO_Suppliers
                        where m.SupplierID == id
                        select m;

        return View(supplier);
    } 
```

如何在我的视图页面中访问supplier.SupplierName 属性，我已经看到使用foreach 循环并将ViewData.Model 转换为IEnumerable 的示例，但是使用循环并没有多大意义，因为我只返回一行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T01:05:55.000

选择第一个对象，然后将其用作您的模型。强类型视图（例如，ViewPage<Supplier>）将使访问模型属性变得微不足道。

```
 var dataContext = new BuffetSuppliersDBDataContext();
    var supplier = (from m in dataContext.BO_Suppliers
                    where m.SupplierID == id
                    select m).FirstOrDefault();

    ViewData.Model = supplier;

    return View(); 
```

视图页面定义为

```
 public class Details : ViewPage<Supplier>
    {
    } 
```

并在视图中使用

```
 <label for="SupplierName" class='details-label'>Supplier Name:</label>
    <span class='details-data'> <%= ViewData.Model.Name %> </span> 
```

# c# - 当使用准备好的语句中的 TransactionLevel.ReadUncommitted 从 c# 将行插入 MS Access 时，排序似乎不正确

> ID：452568
> 
> 赞同：0
> 
> 时间：2009-01-17T00:49:26.017
> 
> 标签：c#, ms-access, transactions, oledb

我在 c# 中有一些代码，它使用准备好的语句将信息（逐行）写入访问数据库。我正在使用 OleDb 和 TransactionLevel.ReadUncommitted，因为有时我需要在提交之前查看数据。

问题似乎是在 7 个不同表中的 1 个上，我从数据库中检索记录的顺序与我放入它们的顺序不同。这种情况大约每 4 次我尝试使用它就会发生 1 次，所以我似乎无法调试它。

*编辑* *这里排序很重要的原因是我们将表格转储到一个与那里已经存在的数据相匹配的 Excel 工作表中。Order by 可能会取得一些进展，但是有一个列是按无法与工作表上的数据匹配的移动（即 N-NW）排序的。*

我倾向于它是准备好的语句的插入命令的竞争条件（即有太多的访问权限一次处理，所以它们变得混乱）。

有人对此有任何想法吗？以下是我正在做的一些片段：（对不起长度，我试图尽可能多地剪掉，但仍然把主要组件拿出来）

```
protected override void PopulateTmpTable()
  {
    OleDbCommand objComm = null;
    try
    {
      objComm = new OleDbCommand("", mDbconn);
      ...
      //Begin SQL Transaction
      mTr = mDbconn.BeginTransaction(System.Data.IsolationLevel.ReadUncommitted);
      objComm.Transaction = mTr;
      //Start Populating Temp Table
      for (int i = 1; i <= mNrows; i++)
      {
        ...
        ProcessNode(objComm, node, approaches);
        ProcessNodeSummary(objComm, node);
      }
      ProcessSummary(objComm);
    }
    catch (Exception e) { }
    finally
    {
      if (mTr != null) mTr.Commit();
      if (objComm != null) objComm.Dispose();
    }
  }  //End Method PopulateTmpTable

  private void ProcessNode(OleDbCommand objComm, string node, List<string> approaches)
  {
    try
    {
      ...
      OleDbCommand objComm2 = new OleDbCommand("", mDbconn, mTr);
      for (int k = 0; k < MaxLegs; k++)
      {
        ...
            total = ProcessIterations(objComm, node, turning[m], m);
          }
          objComm.ExecuteNonQuery();
        }  //End if
      }  //End for
    }
    catch { }
  }  //End Method ProcessNode

private List<double> ProcessIterations(OleDbCommand objComm, string node, string turn, int m)
  {
    try
    {
      OleDbCommand objComm2 = new OleDbCommand("", mDbconn, mTr);
      OleDbDataReader objRead;
      objComm.Parameters["parameter"].Value = //Stuff (x2)
        for (int j = 0; j < mIterations; j++)
        {
          ...
          objComm2.CommandText = "SELECT ROUND(AVG(Delay),1), COUNT(VehNo) FROM [TABLE] WHERE NodeNo=" + node + " AND Movement='" + turn + "' AND Iteration=" + mIterationValue[j] + mFilter[1];
          objRead = objComm2.ExecuteReader();
          objRead.Read();
          try
          {
              objComm.Parameters["more parameters"].Value = objRead[0];
              ...
          }
          catch { }
          objRead.Close();
        }//End for
        ...
        objComm.ExecuteNonQuery();
        objComm2.CommandText = "UPDATE " + mTmptable + " SET ave=" + avg + ",minimum=" + mMini[m] + ",maximum=" + mMaxi[m] + ",dev=" + stDev + " WHERE node='" + node + "' AND movement = '" + temp + "';";
        objComm2.ExecuteNonQuery();
      }
    }
    catch{}
    return mTotal;
  }  //End Function ProcessIterations 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T00:56:34.397

在您的 PopulateTmpTable() 方法中，即使发生错误，您也正在提交事务。那是你的意图吗？

在 ProcessNode() 中，您传入一个命令对象，创建一个新对象，然后使用传入的那个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T09:12:30.970

在 Jet 中，表的聚集索引（物理排序）由 PRIMARY KEY 确定，或者在没有 PK 的情况下，由引擎选择（随机？）另一个键。但是，物理排序仅在压缩数据库文件（.mdb、.mde、.accdb）时发生。在压缩之后（或在第一个压缩之前）插入的行按日期/时间顺序插入。现在，Jet 的 DATETIME 数据类型支持的最小时间粒度是一秒，尽管在幕后该值存储为双浮点数，因此我想知道粒度是否不足以满足您的目的。但是，为什么要依赖旧引擎的记录不充分的功能……？

如果您知道插入行的顺序，则在数据库中对其进行*建模*，例如使用 INTEGER 列来存储您的应用程序负责为其提供值的序列号。并在列上放置一个 UNIQUE 约束，只是为了确定。然后只需在查询中按您的序列列排序。

# eclipse - Eclipse中的外部工具启动配置在哪里

> ID：452571
> 
> 赞同：11
> 
> 时间：2009-01-17T00:50:41.490
> 
> 标签：eclipse, configuration, launch, external-tools

我通常为了好玩而安装和卸载不同版本的 Eclipse。我不想安装很多插件。我更喜欢从全新安装开始测试 IDE。

当我必须配置我一直使用的所有外部工具（例如运行 jconsole）时，问题就出现了。

我还想备份我的启动配置。

你知道 Eclipse 在哪里保存这个启动配置吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-17T01:02:52.790

正如我在这个问题“[哪些 eclipse 文件属于版本控制](https://stackoverflow.com/questions/337304)”中所说，.launch xml 文件（启动器定义）位于

```
[eclipse-workspace]\.metadata\.plugins\org.eclipse.debug.core\.launches 
```

您实际上可以**将它们移动到您的项目目录**中：
当您的项目刷新时，这些配置将显示在“运行配置”对话框中。这样，这些启动参数文件也可以在您的其他项目文件中管理到 VCS 中，而不是隐藏在工作区元数据区域中。

警告：**在“运行/启动/启动配置”首选项面板中取消选中“删除关联资源时删除配置”选项**：通常软删除项目以便再次将其导入，以强制重新初始化 Eclipse元数据，...但是如果选中此选项，将删除您的详细启动参数！）

# asp.net - ASP.NET 线程切换

> ID：452576
> 
> 赞同：3
> 
> 时间：2009-01-17T00:55:26.393
> 
> 标签：asp.net, multithreading

我在某处（我不记得在哪里）读到，在某些情况下，有可能在线程池线程之间处理 ASP.NET 响应时切换 - 有时在执行方法的中间。

这是真的？如果是这样，这是如何实现的？如果不是，作者可能是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T01:08:02.623

在执行方法的中间？我从来没有听说过……但是在执行页面的中间；是的：

当使用 AddOnPreRenderCompleteAsync(...) 或 RegisterAsyncTask(...) 执行异步操作时，可能会发生这种情况。

这些方法将执行异步调用，并在等待响应时释放当前线程。得到响应后，页面实例将在可用线程上继续。

# model-view-controller - 如何在 MVC 模式中表示域聚合？

> ID：452581
> 
> 赞同：2
> 
> 时间：2009-01-17T00:58:14.097
> 
> 标签：model-view-controller, domain-driven-design, aggregates

我应该为聚合中的每个对象创建一个单独的类，还是这些对象应该是单个聚合类的嵌套类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T01:08:53.153

如果聚合对象是可分离的，即它们可以单独出现，也可以在聚合中出现，那么我将为每个对象创建一个单独的类，并使用类型化集合来表示聚合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T01:34:03.413

这取决于对象及其包含的对象的紧密耦合程度。如果你有一个 Person 类，并且那个人有零对多的电话号码，你通常希望 PhoneNumber 是一个单独的类，因为许多不同类型的对象可能有电话号码（例如企业、学校等） ）。但是如果对象是自然紧密耦合的东西，例如 Person 对象可能有 Toes，那么内部类可能是有意义的。

您可能想问自己的一些问题是： 1\. 聚合对象是否需要访问包含类的私有部分？如果是这样，内部类是一个不错的选择。2\. 聚合的对象是否永远只属于一个对象，所属的对象永远不会改变？如果不是，那么您可能不想要内部类。3\. 聚合对象在聚合对象的上下文之外是否有意义？如果是这样，它可能不应该是一个内部类。

如有疑问，通常最好使用单独定义的类，如果没有其他原因导致它不断耦合并且您的源文件更小。

也不是说这不一定是非此即彼的事情。您始终可以定义一个单独的类或接口，然后在聚合类中子类化/实现它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T01:15:29.803

不确定 MVC 与域聚合有什么关系，因为可以在没有 UI 的情况下使用后者。

我通常更喜欢将聚合的各个部分制作为单独的类，因为这些部分可以单独具有业务意义。当外部类必须在内部类之前加载或者当你不能公开内部类（至少这些东西适用于 Java）时，嵌套类是有意义的。

# ruby-on-rails - 铁路对应用程序模型和管理级控制器犹豫不决

> ID：452601
> 
> 赞同：-1
> 
> 时间：2009-01-17T01:12:39.167
> 
> 标签：ruby-on-rails, ruby

我刚刚安装了 railroad 并尝试运行几个简单的示例运行。我有一个应用程序模型和控制器导致它有些烧心。

没有真正的应用程序表 - 该模型用于加载（包含）诸如身份验证系统之类的东西。控制器设置 helper_methods 等。

我还有许多控制器，它们位于许多模型的子目录管理员中。

当我运行时： railroad -o models.dot -M 我得到： /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1833:in `method_missing': undefined method`helper_method' 用于应用程序（表不存在）：类（NoMethodError）

当我运行时： railroad -o controllers.dot -C 我得到 /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:445:in `load_missing_constant': uninitialized常量 CoverageAmountsController (NameError)

coverage_amounts.rb 控制器（Admin::CoverageAmountsController < AdminController 类）位于 app/controllers/admin 中 - 如果我将其移出，它会在 admin 目录中的下一个控制器上给出它 - 所以它看起来不像 admin 文件夹中的控制器.

我能做些什么来解决这些问题？我可以在铁路或我的应用程序中做些什么来使其正常工作吗？我想用这样的东西来看看它是否能满足我的需要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T08:39:01.233

不要使用 application 作为模型的名称，因为这会导致与应用程序控制器混淆 - 也称为 application.rb。请参阅 rails wiki 中的此线程： [http ://wiki.rubyonrails.org/rails/pages/ReservedWords#fn2](http://wiki.rubyonrails.org/rails/pages/ReservedWords#fn2)

注意这个问题应该在边缘导轨中解决：http: [//github.com/rails/rails/commit/fcce1f17eaf9993b0210fe8e2a8117b61a1f0f69](http://github.com/rails/rails/commit/fcce1f17eaf9993b0210fe8e2a8117b61a1f0f69)

ActiveRecord 还假设您的班级有一个相应的表格（我认为）。您可能希望将身份验证系统包含在应用程序控制器中，除非您有充分的理由不这样做。

您可能会发现进行此更改可以解决您遇到的其他控制器问题。让我知道任何一种方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T18:15:25.243

谢谢回复...

我在应用程序模型中发生了一些事情。这些都可以转移到应用程序控制器并给出相同的结果吗？

```
class Application < ActiveRecord::Base

  include AuthenticatedSystem
  # this gives all model access to current_user
  before_filter { |c| User.current_user = c.current_user }

  # some miscellanous modules
  require HashExtensions
  require LiquidExtensions

end 
```

# python - 如何创建 lambda 列表（在列表理解/for 循环中）？

> ID：452610
> 
> 赞同：52
> 
> 时间：2009-01-17T01:19:13.867
> 
> 标签：python, lambda, scope, closures, list-comprehension

我想从 Python 中的常量列表创建一个 lambda 对象列表；例如：

```
listOfNumbers = [1,2,3,4,5]
square = lambda x: x * x
listOfLambdas = [lambda: square(i) for i in listOfNumbers] 
```

但是，当我运行它们时，这将创建一个 lambda 对象列表：

```
for f in listOfLambdas:
    print f(), 
```

我希望它会打印

```
1 4 9 16 25 
```

相反，它打印：

```
25 25 25 25 25 
```

似乎所有 lambdas 都被赋予了错误的参数。我做错了什么，有没有办法解决它？我认为我在 Python 2.4 中。

编辑：多一点尝试的东西等等想出了这个：

```
listOfLambdas = []
for num in listOfNumbers:
    action = lambda: square(num)
    listOfLambdas.append(action)
    print action() 
```

打印从 1 到 25 的期望方格，然后使用前面的 print 语句：

```
for f in listOfLambdas:
    print f(), 
```

仍然给我所有`25`的s。这两个打印调用之间现有的 lambda 对象是如何变化的？

相关问题：[为什么 map() 和列表理解的结果不同？](https://stackoverflow.com/questions/139819/why-results-of-map-and-list-comprehension-are-different)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-17T01:51:59.027

你有：

```
listOfLambdas = [lambda: i*i for i in range(6)]

for f in listOfLambdas:
    print f() 
```

输出：

```
25
25
25
25
25
25 
```

你需要咖喱！除了好吃之外，使用这个默认值“hack”。

```
listOfLambdas = [lambda i=i: i*i for i in range(6)]

for f in listOfLambdas:
    print f() 
```

输出：

```
0
1
4
9
16
25 
```

注意`i=i`. 这就是魔法发生的地方。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-17T01:37:51.473

我猜您在列表推导中创建的 lambda 绑定到变量 i 最终以 5 结束。因此，当您在事后评估 lambda 时，它们都绑定到 5 并最终计算25\. 在你的第二个例子中，同样的事情发生在 num 上。当您在循环内评估 lambda 时，它的 num 没有改变，因此您得到了正确的值。循环后，num 为 5...

我不太确定您要做什么，所以我不确定如何提出解决方案。这个怎么样？

```
def square(x): return lambda : x*x
listOfLambdas = [square(i) for i in [1,2,3,4,5]]
for f in listOfLambdas: print f() 
```

这给了我预期的输出：

```
1
4
9
16
25 
```

另一种思考方式是 lambda 在创建时“捕获”其词法环境。所以，如果你给它**num**它实际上并没有解析该值，直到它被调用。这既令人困惑又强大。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-17T11:13:42.747

当函数语句被执行时，它们被绑定到它们的（词法上的）封闭范围。

在您的代码段中，lambda 绑定到全局范围，因为`for`套件不是作为 Python 中的独立范围单元执行的。在`for`循环结束时，`num`被绑定在封闭范围内。演示：

```
for num in range(1, 6):
    pass
assert num == 5 # num is now bound in the enclosing scope 
```

`for`因此，当您在循环中绑定标识符时，您实际上是在操纵封闭范围。

```
for num in range(1, 6):
    spam = 12
assert num == 5 # num is now bound in the enclosing scope
assert spam == 12 # spam is also bound in the enclosing scope 
```

列表推导的相同处理：

```
[num for num in range(1, 6)]
assert num == 5 
```

令人兴奋，我知道。任何人，根据我们新发现的知识，我们可以确定您正在创建的 lambda 是指`num`绑定在封闭范围内的（单个）标识符。这应该更有意义：

```
functions = []
for number in range(1, 6):
    def fun():
        return number
    functions.append(fun)
assert all(fun() == 5 for fun in functions)
assert all(fun() is number for fun in functions) 
```

这是最酷的部分，它更能证明这一点：

```
# Same as above -- commented out for emphasis.
#functions = []
#for number in range(1, 6):
#    def fun():
#        return number
#    functions.append(fun)
#assert all(fun() == 5 for fun in functions)
#assert all(fun() is number for fun in functions)
number = 6 # Rebind 6 in the scope and see how it affects the results.
assert all(fun() == 6 for fun in functions) 
```

因此，解决方案当然是为每个`number`要绑定的对象创建一个新的封闭范围。在 Python 中，您可以使用模块、类和函数创建新的封闭范围。使用一个函数来为另一个函数创建新的封闭范围是很常见的。

在 Python 中，*闭包*是一个**返回另一个函数的函数**。有点像函数构造函数。请查看`get_fun`以下示例：

```
def get_fun(value):
    """:return: A function that returns :param:`value`."""
    def fun(): # Bound to get_fun's scope
        return value
    return fun

functions = []
for number in range(1, 6):
    functions.append(get_fun(number))
assert [fun() for fun in functions] == range(1, 6) 
```

既然`get_fun`是一个函数，它就有自己的内部作用域。每次`get_fun`使用值调用时，都会创建一个小表来跟踪其中的绑定；即它说，“在这个范围内，`value`标识符指向被传递的东西。” 该范围在函数执行结束时消失，除非有理由让它徘徊。

如果您要从范围内返回一个函数，那么这就是“范围表”的一部分存在的一个很好的理由——当您稍后调用它时，您返回的函数可能会引用该范围表中的内容。出于这个原因，在Python`fun`中创建的when 会告知' 范围表，以便在需要时方便使用。`get_fun``fun``get_fun``fun`

[你可以在Python docs on the execution model](http://docs.python.org/reference/executionmodel.html)中阅读更多关于细节和技术术语（我稍微软化了一点）的信息。您还可以使用 来查看函数引用的封闭范围的部分`print fun.__closure__`。在上面，我们看到了对 的引用`value`，它恰好是一个 int：

```
# Same as before, commented out for emphasis.
#functions = []
#for number in range(1, 6):
#    functions.append(get_fun(number))
#assert [fun() for fun in functions] == range(1, 6)
print functions[0].__closure__
# Produces: (<cell at 0x8dc30: int object at 0x1004188>,) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-15T18:58:02.863

尝试使用 () 而不是 []：

```
listOfLambdas = (lambda: square(i) for i in listOfNumbers) 
```

你会得到：

```
1
4
9
16
25 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T01:52:49.790

```
listOfLambdas = [lambda i=i: square(i) for i in listOfNumbers] 
```

或者

```
listOfLambdas = map(lambda i: lambda: square(i), listOfNumbers) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T01:46:37.633

我有时发现为函数对象定义实际的类可以更容易理解发生了什么：

```
>>> class square(object):
...   def __init__(self, val):
...     self.val = val
...   def __call__(self):
...     return self.val * self.val
...
>>> l = [1,2,3,4,5]
>>> funcs = [square(i) for i in l]
>>> for f in funcs:
...   print f()
...
1
4
9
16
25
>>> 
```

诚然，它比使用 lambda 或闭包要冗长一些，但是当我尝试用函数做一些不明显的事情时，我发现这更容易理解。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-21T12:54:35.697

这将解决您的问题：

```
import copy

listOfNumbers = [1,2,3,4,5]
square = lambda x: x * x
listOfLambdas = [lambda num=copy.deepcopy(i): square(num) for i in 
listOfNumbers]

for f in listOfLambdas:
    print( f()) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-14T04:15:05.690

你也可以这样做：

```
>>> def squares():
...     for i in [1,2,3,4,5]:
...         yield lambda:i*i
... 
>>> print [square() for square in squares()]
[1, 4, 9, 16, 25] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-10T08:02:39.067

作为补充评论，我想概述从 sympy 矩阵生成 lambda 函数列表的可能性（我不知道这是否是最好的方法，但我就是这样做的，我觉得它很方便）：

```
import sympy as sp
sp.var('Ksi')
# generate sympy expressions for Berstein's polynomials
B_expr = sp.Matrix([sp.binomial(3, i) * Ksi**i * (1 - Ksi)**(3-i) for i in range(4)])
# lambdify them 
B = [sp.lambdify((Ksi), B_expr[i]) for i in range(4) ] 
```

# c# - 空引用异常

> ID：452613
> 
> 赞同：0
> 
> 时间：2009-01-17T01:21:41.817
> 
> 标签：c#, .net, nullreferenceexception, oledbparameter

此代码生成空引用异常。异常出现在初始化参数数组的行。可能是什么问题？我不知道如何跟踪堆栈跟踪并对其进行任何逻辑处理。提前致谢。

```
DAL dal = new DAL();

    string SQL = @"INSERT INTO Assets ([AssetName],[AssetType],[Model],[Description],
                                                          [PurchaseValue],[SalvageValue],[Currency],[DateAcquired,[DateRetire],[ImagePath],
                                                          [InUse])
                                                          VALUES (?,?,?,?,?,?,?,?,?,?,?)";

    OleDbParameter[] par = new OleDbParameter[]{ 
    new OleDbParameter("@assetname",name.Text),
    new OleDbParameter("@assettype",assettypes.SelectedValue.ToString()),
    new OleDbParameter("@model",model.Text),
    new OleDbParameter("@description",description.Text),
    new OleDbParameter("@purchasevalue",purchaseval.Value),
    new OleDbParameter("@salvagevalue",salvageval.Value),
    new OleDbParameter("@currency",currencies.SelectedIndex),
    new OleDbParameter("@dateacquired",purchasedate.Value),
    new OleDbParameter("@dateretire",purchasedate.Value.AddYears((int)lifetime.Value)),
    new OleDbParameter("@imagepath","N/A"),
    new OleDbParameter("@addedby",MDIParent1.User.ID)
    }; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T01:26:53.383

您可能有一个或多个没有值的可空类型（可能是您的日期？），尽管也可能没有 SelectedValue。在调试器中的语句之前检查所有参数是否非空，以查看哪个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T01:27:48.483

您查询的对象之一似乎很可能为空。

我建议将它们打印到标准输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T01:33:27.533

其中一行包含一个空引用：

```
new OleDbParameter("@assetname",name.Text),
new OleDbParameter("@assettype",assettypes.SelectedValue.ToString()),
new OleDbParameter("@model",model.Text),
new OleDbParameter("@description",description.Text),
new OleDbParameter("@purchasevalue",purchaseval.Value),
new OleDbParameter("@salvagevalue",salvageval.Value),
new OleDbParameter("@currency",currencies.SelectedIndex),
new OleDbParameter("@dateacquired",purchasedate.Value),
new OleDbParameter("@dateretire",purchasedate.Value.AddYears((int)lifetime.Value)),
new OleDbParameter("@imagepath","N/A"),
new OleDbParameter("@addedby",MDIParent1.User.ID) 
```

查看调试器中的属性值，对于您提供的代码，我们真的无能为力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T02:01:11.130

实际上，您似乎是直接从用户那里获取输入，而没有先验证或清理它。我的建议（这可能会解决您的 NRE）是在将每个用户输入的值发送到数据库之前对其进行验证。这将允许您在使用错误查询收集数据库之前捕获输入中的任何错误。

请不要将变量命名为与对象相同的名称。我是说

```
DAL dal = new DAL(); 
```

至少强调本地变量或使用不同的名称。

```
DAL _dal = new DAL();
DAL dataAccessLayer = new DAL(); 
```

# java - JPA java代码生成

> ID：452627
> 
> 赞同：29
> 
> 时间：2009-01-17T01:28:39.463
> 
> 标签：java, jpa, autocomplete, templates, code-generation

我正在专门寻找 JPA 代码生成技术

首先，有哪些项目可以生成符合 JPA 的代码？（例如 HibernateTools）

其次，我还想自定义代码生成实用程序，因为它必须符合我们的公司标准。

如果不是，那么所有可用于使用反射生成 java 代码的框架是什么？所以我可以从头开始写。

注意：我使用 eclipse 生成 JPA 代码并反复重构以使其兼容。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-29T17:53:15.877

我也很难理解这个问题，但我会尝试改写：

*   您在数据库中有大量数据并希望通过 JPA 访问它
*   您不想手动编写类来访问不同的数据库/表
*   目前所有/大部分模型类都是从 Eclipse 中生成的
*   这些模型具有 JPA 注释
*   模型类（或注释）不符合公司标准

当您说“JPA java 代码生成”时，我理解从提供的 DB 连接生成 JPA 注释模型类。大多数框架通常将此称为逆向工程。

现在你有两个问题：

1.  可以推荐哪些代码生成器来生成 JPA 注释类？
2.  是否可以自定义这些框架的输出，以及以何种方式？

要回答第一个问题：

*   [Hibernate Tools](http://tools.hibernate.org) - 问题中已经提到过，但我更喜欢这个
*   [EclipseLink](http://www.eclipse.org/eclipselink/)
*   [网豆](http://wiki.netbeans.org/BestPracticesWithJPAAndBeansBinding)

我真的很喜欢 Netbeans 代码生成，尤其是当您向不熟悉 JPA 的人展示结果时。

在定制级别上，我只能分享我使用 Hibernate Tools 的经验。特别是对于可重现的结果，尽量使用[基于 ant 的任务](http://docs.jboss.org/tools/3.0.0.CR1/en/hibernatetools/html_single/index.html#ant)。您可以轻松地将一些目标添加到您的构建中，并且可以在两个级别上完成代码生成：

*   [使用属性](http://docs.jboss.org/tools/3.0.0.CR1/en/hibernatetools/html_single/index.html#d0e3669)配置导出器
*   提供自定义[freemarker模板](http://freemarker.sourceforge.net/)

使用这些模板，您应该能够涵盖大多数公司标准。查看`pojo`hibernate-tools 包的目录。自定义代码生成的最简单方法是复制和调整模板，并将它们放在用于创建 pojo 的 ant 任务中的 hibernate-tools.jar 之前。

正如在另一条评论中已经指出的那样，之后可能很难修改生成的代码。我希望以下提示可以帮助您：

*   尝试将生成的和自定义的源文件分开放在不同的文件夹中。
*   考虑使用`[@MappedSuperclass](http://java.sun.com/javaee/5/docs/api/javax/persistence/MappedSuperclass.html)`您可能希望在手动步骤中调整的类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-20T16:00:50.860

JPA 代码生成的另一个有效解决方案是“ **Telosys Tools** ”

从现有数据库（“数据库优先”方法）使用**可定制模板**的**Eclipse 插件**。由于其轻量级模型和 Velocity 模板（在 GitHub 上共享），该解决方案比 Dali 更灵活

 **见网站：[http ://www.telosys.org/](http://www.telosys.org/)

Eclipse Marketplace 上的插件：[http ://marketplace.eclipse.org/content/telosys-tools](http://marketplace.eclipse.org/content/telosys-tools)

原理简述：http: [//labs.sogeti.com/code-generation-can-it-be-simple-and-pragmatic/](http://labs.sogeti.com/code-generation-can-it-be-simple-and-pragmatic/)

对于**JPA 生成**，请使用GitHub 上提供的**JPA 模板：** [https ://github.com/telosys-templates-v3](https://github.com/telosys-templates-v3)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-08T16:12:45.073

我使用了[Dali Persistence Eclipse Plugin](http://www.eclipse.org/webtools/dali/)，该工具可通过[Indigo Java EE SR1 更新站点](http://download.eclipse.org/releases/indigo/)下载。

安装插件后，要对您的数据库进行逆向工程，您需要创建一个新的 JPA 项目，设置数据库连接，启动 JPA 运行时的自动下载（在我的情况下为 Eclipse Link），然后开始生成过程。

在代码生成过程中，您需要提供有关表映射和生成的类的详细信息。在生成结束时，代码是干净的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-29T17:30:53.477

[Minuteproject](http://minuteproject.wikispaces.com/)是一个生成器工具，可以生成 JPA1/ [JPA2](http://minuteproject.wikispaces.com/JPA2)以及类似休眠 ORM 的工件。它基于数据库的逆向工程。您可以指示生成器为您的 Java 代码应用不遵循 DB 约定的约定，但映射将是正确的。（示例去除数据库名称前缀；以 ADMIN_ 开头的表，例如 ADMIN_ENVIRONMENT 是作为 java 类的环境（不带管理员））目前有[20 多种约定](http://minuteproject.wikispaces.com/Configuration)可以帮助您重塑模型以减少数据库外观Java-OO 友好的。

另一个有趣的功能是[可更新代码](http://minuteproject.wikispaces.com/Updatable_Generated_Code)，可以修改生成的代码和您的模型**，**并且下一代**您的修改将被保留！**生成器进行合并。

这些模板是开源的，并且可以使用速度，附加一个轨道来为您的框架制作特定的轨道是“非常”容易的（例如与您的组织相关的安全方面）。您可以将模板范围限定为字段级别、实体（表或视图）、包（实体组）、模型、提供灵活性的应用程序，并且由于轨道的模板通过元数据相互了解，因此很容易从其他模板中引用模板并通过配置将它们与命名约定相关联。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-14T08:58:08.960

Lombok 项目似乎允许您生成基本的命名查询，这是在编译时使用注释和代码生成的另一种方法。

看：

*   [http://groups.google.com/group/project-lombok/browse_thread/thread/a8c01b2226c081cb](http://groups.google.com/group/project-lombok/browse_thread/thread/a8c01b2226c081cb)
*   [http://projectlombok.org](http://projectlombok.org)

hibernate 论坛上的一个人似乎使用 Hibernate 工具的传统代码生成方法： [https ://forum.hibernate.org/viewtopic.php?f=9&t=962223&p=2315766&hilit=named+queries+generate#p2315766](https://forum.hibernate.org/viewtopic.php?f=9&t=962223&p=2315766&hilit=named+queries+generate#p2315766)

我同意 cletus 的观点，即您无法生成所有命名查询，但我想我们可以想象生成基本的命名查询，例如基于对象的一个​​或多个字段的查找器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-11T06:58:47.413

查看[JPM2java](https://jpm2java.java.net/)，它是 JPA 的代码生成器。唯一的问题是它不会从 SQL 文件或表中生成 JPA 代码，您需要一个 orm.xml 文件。如果您正在寻找直接从表生成代码的工具，您可能想尝试 Netbeans。它具有直接从表生成 JPA 代码的选项

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-01T15:30:16.970

用于 jpa 代码反向生成的理想工具/eclipse 插件是 Hibernate Tools。这现在已成为 JBoss 工具的一部分。所以，在你的 Eclipse 中，从安装 JBoss Tools 开始。

然后创建一个 JPA 项目。该项目将充当与反向生成项目相关的所有代码/配置的持有者。首先安装 JBoss 工具可以让您的 Hibernate 配置（Hibernate 工具的一部分）与您的 JPA 项目一起创建。

下一步是使用 Hibernate 工具实际反向生成与您的数据库表相对应的 JPA POJO 实体。

要详细了解 JPA POJO 反向生成的步骤，您可以查看以下教程... [http://www.javabrahman.com/j2ee/how-to-do-reverse-code-generation-of-hibernatejpa -pojo-entities-using-jboss-tools-eclipse-plugin/](http://www.javabrahman.com/j2ee/how-to-do-reverse-code-generation-of-hibernatejpa-pojo-entities-using-jboss-tools-eclipse-plugin/)

上面的教程还包含创建 JPA 项目以及在 Eclipse 安装中安装 JBoss 工具的教程链接，这两者都是 JPA POJO 实体反向代码生成的先决条件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-15T05:22:38.207

开源图形工具，用于生成 JPA 类、可视化和修改数据库、对现有源代码进行逆向工程以及从现有数据库中导入模型。

对于 NetBeans： http: [//jpamodeler.github.io/](http://jpamodeler.github.io/)
对于 Eclipse：[https ://www.eclipse.org/webtools/dali/](https://www.eclipse.org/webtools/dali/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-04-23T11:13:26.597

请看一下JOOQ。

[http://www.jooq.org/](http://www.jooq.org/)

开源是可用的......

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2009-01-17T02:08:29.010

好的，基本上你有错误的方式：`JPA is the generation tool`.

我这样说是因为您唯一可以从中生成 JPA 实体的是 SQL，而 JPA 的全部意义在于以相反的方式做事。您首先定义您的对象模型，然后您可以生成您的表和查询。

例如，我见过一些项目使用 Hibernate 来定义他们的实体，然后他们有一个 ant 构建脚本，可以从 Hibernate 实体模型创建数据库。

JPA 实体定义——尤其是使用注释完成的——并不十分繁琐。它们确实是您最好的选择，而不是成为其他事物的产物。

此外，另一个工具不会帮助您编写命名查询、定义正确的关系级联选项等。如果您已经生成了代码，您将如何处理之后的修改？

这不是正确的方法。

# java - 如何从 Unix 中找到 Active Directory 域控制器的 IP？

> ID：452628
> 
> 赞同：1
> 
> 时间：2009-01-17T01:30:38.460
> 
> 标签：java, active-directory

我可以通过 Windows 机器上的 NSLOOKUP 获取名称服务器，并通过 WMI VBS 脚本获取 AD DC，但我不能使用来自 Unix 服务器的 VBS 脚本（它可以 ping 名称服务器）。我想使用 Java 从 Unix 机器中获取所有 Active Directory 域控制器。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T16:08:32.247

如果可以查询 DNS 服务器，难道不能查询其服务记录以发现可以充当域控制器的计算机吗？

这就是 Windows 工作站找到候选域控制器的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T01:33:55.413

我建议您查看 java.net 包，其中包含各种类，如 INetAddress、URLConnection 和您可能会发现有用的各种套接字类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T01:35:52.133

是的，您可以像标准 LDAP 一样连接到它。您可以使用 OpenLDAP 库：

[http://www.openldap.org/jldap/](http://www.openldap.org/jldap/)

# java - 建议一个 JPA 单元测试框架

> ID：452630
> 
> 赞同：7
> 
> 时间：2009-01-17T01:31:27.383
> 
> 标签：java, unit-testing, jpa

如何对 JPA 代码进行单元测试？有没有办法自己生成单元测试用例？

注意：我很懒，对单元测试代码很陌生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T02:50:07.210

看看这个，[Unitils](http://www.unitils.org/summary.html)。这是一个[相关的讨论](http://www.theserverside.com/news/thread.tss?thread_id=50487)，带有一些示例代码。

这是一个示例，同时显示了[DBUnit、Spring 和 OpenJPA](http://bill.dudney.net/roller/bill/entry/20070428)。您可能不会全部使用，但我相信，如果您想使用[DBUnit ，这可以带您到某个地方。](http://www.dbunit.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T20:10:49.067

我正在为我正在进行的项目尝试 OpenEJB ( [http://openejb.apache.org/ )。](http://openejb.apache.org/)它是一个支持 EJB 3.0（和部分 3.1）的可嵌入容器。我对它的第一印象还不错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-01T21:45:08.690

最近我遇到了一个测试问题：

1.  在 JPA 实体上运行的业务逻辑
2.  复杂的 JPQL 查询与业务逻辑混合。

我使用了[JPA-Unit](http://code.google.com/p/jpa-unit)，它解决了我所有的问题。

# java - JPA 的单元测试用例值得吗？无论如何它只是要访问数据库，我们为什么需要它？

> ID：452631
> 
> 赞同：0
> 
> 时间：2009-01-17T01:32:34.557
> 
> 标签：java, unit-testing, jpa

JPA 的单元测试用例值得吗？无论如何它只是要访问数据库，我们为什么需要它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T06:19:45.673

到目前为止，我不同意大多数答案。对于大多数企业应用程序，大部分业务逻辑都嵌入在数据库查询中，如果您使用 JPA，大部分业务逻辑都嵌入在 JPQL 中，有些可能非常复杂。那是您正在编写的代码，因此您应该对其进行测试。

如果查询很简单——没有复杂的连接或条件——那么就没有那么大的问题了，但根据我的经验，这些应用程序很少见，而且您可能不需要像 JPA 那样强大的东西来构建它们。对于那些天真地试图保持其持久层不受“业务逻辑”影响的应用程序，您将为可扩展性付费。

对于大多数 JPA 应用程序，测试在容器外部运行是您正常、持续集成构建的一部分，这一点至关重要。典型的方法是使用内存数据库，如 HSQLDB 或 H2。

Java EE 与 Rails 和 Django 等框架竞争，这些框架期望开发人员针对专门为此目的的真实数据库对代码进行单元测试。JPA 开发人员应该期待不少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T01:01:43.200

您可以使用嵌入式数据库，例如[HSQLDB](http://hsqldb.org/ "数据库")或[H2 数据库](http://www.h2database.com/html/main.html "H2 数据库")，并且：

*   测试 Annotation Mapping 是否“正确”（如在 SessionFactory 中可以启动）
*   使用一些“小” schema.sql 来测试约束（例如字符串长度、外键）
*   尽早查看 SQL 语句以发现一些奇怪的映射

和/或使用集成数据库（远程或使用生产备份在本地构建）和：

*   进行一些性能或真实数据测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T01:38:31.613

我从来没有为 JPA 实体做过单元测试。我对业务逻辑进行单元测试，您可以直接使用 JPA 实体/查询，也可以模拟查询。

任何合理的 IDE 都会验证 JPA 模型，以确保所有表名和列名都是正确的。一旦完成，还有什么可做的？单元测试查询的问题是您必须能够期望某些数据来验证测试，而我从来都不喜欢为了通过测试而创建假数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T02:20:14.383

您可以使用 DbUnit 通过 JPA 测试数据库，如果您有非常复杂的查询，那么您可以测试它是否适用于真实的 db（dbunit 使用超音速进行测试）。然而，设置测试数据需要一些时间，因此它的编写速度比使用模拟的单元测试要慢得多。这可能是矫枉过正，但你应该尝试一下，看看你喜欢它。我认为它不值得。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T10:28:35.117

我对我工作的应用程序进行单元测试的经验使我最初创建访问我们的 ORM 的“单元测试”，需要在后台运行数据库。显然，这比您真正想要的单元测试要重得多，并且设置/拆卸需要通过 ORM 创建和删除数据以及访问数据库，这确实是一个集成测试，但这没有理由不这样做. 我这样做是因为我们在数据库中有很多逻辑，这是使用每个人都可以理解的代码访问它的一种非常简单的方法，在您的情况下，我想您需要询问是否有您自己的代码，您实际上会通过这样做进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T22:07:32.800

单元测试通常用于

*   **你**写的东西（不是库/框架）
*   可能经常破裂的东西
*   属于*应用程序逻辑*代码的东西

JPA 代码

*   是别人写的，不是你写的
*   如果您使用好的库（hibernate/toplink），代码已经成熟
*   持久性*不是*业务逻辑

恕我直言，您不应该为 JPA 进行单元测试。对于极端情况，请使用前面提到的 DbUnit。

# java - Java 方法分派如何与泛型和抽象类一起工作？

> ID：452635
> 
> 赞同：7
> 
> 时间：2009-01-17T01:35:30.353
> 
> 标签：java, generics, overloading

我今天遇到了一种情况，Java 没有调用我期望的方法——这是最小的测试用例：（很抱歉，这似乎是做作的——“现实世界”的场景要复杂得多，而且更有意义从“你为什么要这样做？”的*角度*来看。）

我对为什么会发生这种情况特别感兴趣，我不在乎重新设计的建议。我感觉这是在 Java Puzzlers 中，但我手边没有我的副本。

请参阅下面 Test<T>.getValue() 中的特定问题：

```
public class Ol2 {  

    public static void main(String[] args) {  
        Test<Integer> t = new Test<Integer>() {  
            protected Integer value() { return 5; }  
        };  

        System.out.println(t.getValue());  
    }  
}  

abstract class Test<T> {  
    protected abstract T value();  

    public String getValue() {  
        // Why does this always invoke makeString(Object)?  
        // The type of value() is available at compile-time.
        return Util.makeString(value());  
    }  
}  

class Util {  
    public static String makeString(Integer i){  
        return "int: "+i;  
    }  
    public static String makeString(Object o){  
        return "obj: "+o;  
    }  
} 
```

这段代码的输出是：

```
obj: 5 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T01:41:18.113

No, the type of value is not available at compile time. Keep in mind that javac will only compile one copy of the code to be used for all possible T's. Given that, the only possible type for the compiler to use in your getValue() method is Object.

C++ is different, because it will eventually create multiple compiled versions of the code as needed.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T01:42:33.460

Because the decision about what `makeString()` to use is made at compile-time and, based on the fact that T could be anything, must be the `Object` version. Think about it. If you did `Test<String>` it would have to call the `Object` version. As such all instances of `Test<T>` will use `makeString(Object)`.

Now if you did something like:

```
public abstract class Test<T extends Integer> {
  ...
} 
```

things might be different.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-29T21:48:01.910

Josh Bloch 的*Effective Java*有一个很好的讨论，澄清了由于重载和覆盖（在子类中）方法的分派工作方式不同而引起的混乱。*重载*方法的选择——这个问题的主题——是在编译时确定的；*覆盖*方法之间的选择是在运行时完成的（因此可以了解对象的特定类型。）

这本书比我的评论清楚得多：参见“第 41 条：明智地使用重载”

# ruby-on-rails - 有人知道什么 CMS 使用 37signals 来管理网站吗？

> ID：452641
> 
> 赞同：4
> 
> 时间：2009-01-17T01:37:55.233
> 
> 标签：ruby-on-rails, ruby, content-management-system

我需要建立一个简单的网站“一个大页面”，比如 37signals 产品的页面，我正在考虑这个问题。

有人有想法吗？他们是使用 Radiant 还是手动编码？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-17T08:30:10.360

[Signal vs. Noise](http://www.37signals.com/svn)使用我们自己的名为 Blog Cabin 的小引擎运行。它只是做我们需要它做的事情。[产品博客](http://productblog.37signals.com)由 Typepad 提供支持。

我们的营销网站是手动编码和维护的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T01:56:56.253

我要四处走动，猜想他们是用铁轨自己滚的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T03:04:46.757

关于发布静态内容，Ryan 对 Webby 的推荐不错。另一个简单而优秀的 ruby​​ 静态站点生成器是Tom Preston-Werner 的[Jekyll](http://github.com/mojombo/jekyll/tree/master)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T02:59:37.407

我怀疑他们有任何像 CMS 一样正式的东西。我确信他们推出了自己的简单发布机制，该机制使用一些模板和 Rakefile。无论如何，这就是我会做的。

如果您正在寻找有助于发布静态内容的东西，我会推荐[Webby](http://webby.rubyforge.org/)。Mike Clark 有一篇关于 Webby 的文章，即[使用 Webby 构建静态网站](http://clarkware.com/cgi/blosxom/2008/08/06)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T08:20:08.557

他们建立了自己的博客引擎，并将其称为“博客小屋”。这是一篇关于他们何时从 Type Pad 切换的博客文章的链接：[新的（ish）信号与噪声](http://www.37signals.com/svn/posts/37-the-newish-signal-vs-noise)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-17T04:12:21.753

还有[Nanoc](http://nanoc.stoneship.org/)，我想像 Webby 一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-18T03:32:33.207

我认为 webby 也很聪明，尽管我真的希望它有一个内置的邮件程序，用于通过电子邮件发送表单数据。

# vim - 在vim中取消设置忽略大小写？

> ID：452649
> 
> 赞同：63
> 
> 时间：2009-01-17T01:43:27.467
> 
> 标签：vim

`:set ic`忽略此案。你如何取消这个？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-17T01:46:00.303

:set noic 或 :set noignorecase

真的很直观，对吧？:)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-06T20:17:17.097

您还可以使用 :set ic! 切换设置！并使用 :set ic? 查询其值？

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-04-21T09:17:57.243

以“\C”（不带引号）作为搜索字符串的前缀，例如：

```
/\Croot 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-06T20:27:51.173

注意`'smartcase'`选项。`'ignorecase'`如果搜索模式包含大写字符，它将覆盖该选项。

即拥有`'ignorecase'`和`'smartcase'`继续`/foo`会找到`foo`,`Foo`和`FOO`, 但`/Foo`只会找到`Foo`, 不会`foo`.

你也可以通过在搜索模式中的某处使用来告诉 Vim 你想搜索区分大小写，尽管进行了`'ignorecase'`设置。`\C`通过`\c`在搜索模式中使用，你告诉 Vim 在搜索时忽略大小写，尽管`'ignorecase'`设置。

# jquery - GridView 上的样式在分页时丢失

> ID：452658
> 
> 赞同：1
> 
> 时间：2009-01-17T01:51:46.967
> 
> 标签：jquery, gridview

我正在使用绑定到 sqldatasrc（带分页）的 GridView。单击按钮时，我使用 jquery 在几行上应用样式，当我转到第 2 页并返回第 1 页时，我看到样式不再存在。这是由于回发。

当我在页面之间移动时如何保留这些样式。

请用代码支持答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T06:19:05.383

我该如何存储它？让我详细解释一下。用户在第 1 页。他决定在几行上随机应用样式。用户只需单击该行即可应用样式。现在他转到第 2 页。他也在那里应用了这种风格。现在，当他返回第 1 页时，他应该能够看到带有样式的行。

跨页面移动时如何保存行样式的历史记录？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T02:31:14.440

听起来你回答了你自己的问题。您通过单击按钮将样式应用于几行。因此，如果您转到网格上的第 2 页并返回到第 1 页，则需要重新触发该单击事件，或者只运行将样式应用于行的例程。

# asp.net-mvc - 如何从 IHttpModule 获取数据到 ASP.NET MVC RequestContext？

> ID：452662
> 
> 赞同：2
> 
> 时间：2009-01-17T01:54:33.357
> 
> 标签：asp.net-mvc, ihttpmodule

我有一个自定义的 IHttpModule 进行身份验证（对 Facebook、Myspace 等）。它引发了一个可以在 HttpApplication 实例中处理的事件，其中包含有关用户的详细信息。这很像 FormsAuthenticationModule 引发的 OnAuthenticate 事件。

从 HttpApplication 类中，我应该将获得的这些信息放在哪里，以便它可用于 ASP.NET MVC 管道？我曾经把它放在 Context.Items 字典中。但似乎与（更友好的）HttpContextBase 我想把它放在那里以便于模拟/注入并且我没有在我的控制器中使用 HttpContext.Current 。

那么，基本上，我如何最好地将数据从 IHttpModule 获取到 MVC 上下文中？快速浏览一下，我能想到的最好方法是创建一个自定义 IControllerFactory 以从 HttpContext 中提取数据并将其添加到 RequestContext。我回答了我自己的问题吗？有没有侵入性较小的方式（比如我可以处理的事件）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:53:17.810

我的猜测是您的模块在路由之前运行。如果是这样，那么直接将其添加到 RequestContext 还为时过早。

我会尝试将它添加到 HttpContext.Current.Items。路由将使用 HttpContextBase 包装该 HttpContext。然后，您应该能够通过 RequestContext.HttpContext.Items 从任何地方访问它。

# security - 最好的安全/漏洞测试公司？

> ID：452664
> 
> 赞同：7
> 
> 时间：2009-01-17T01:58:57.827
> 
> 标签：security, testing

我负责一个必须非常安全的 Web 应用程序。用户将使用该网站相互提交高度敏感的信息。安全必须是世界级的。

我们相信我们以最大限度地降低安全风险的方式构建站点，并且我们已经在公司范围内实施了许多政策和程序来提高安全性。

我们希望第三方执行详尽且持续的安全测试：自动化测试、应用程序测试等，以检查跨站点脚本问题、服务器错误配置、表单/隐藏字段操作、命令注入、Cookie 中毒、已知平台漏洞等

提供此类服务的最佳公司有哪些？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T04:15:43.650

我不能告诉你哪家公司最好，但我可以提到一类我认为应该避免的非常受欢迎的服务/公司。这些公司针对目标 IP 运行简单的脚本（可能只是 NMAP）并收集表面信息以报告可能的漏洞。此类中一家受欢迎的公司是 Scan Alert 的“Hacker Safe”。

去年我写了一篇关于我在这家特定公司的经历的文章：[你的网站黑客安全吗？](http://robotterror.com/site/blog/robot_terror/is_your_site_hacker_safe)

Scan Alert、McAffee 等的问题在于，它们只是简单地扫描站点以查找版本字符串和已知漏洞。没有考虑到某些服务，如 Red Hat Enterprise Linux，将在保留先前版本标识符的同时向后移植安全修复程序。更糟糕的是，没有尝试实际检测实时漏洞，因此实际的安全漏洞仍然未被检测到，而误报会分散注意力。

如果我真的需要知道我的应用程序或系统是否容易受到攻击，我会保留信誉良好的渗透测试顾问的服务。我不会相信自动化测试，而是会尝试利用我的应用程序/系统可能存在的任何漏洞的实际专家。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T15:15:22.557

我肯定会去： [http](http://www.sectheory.com/) ://www.sectheory.com/ 经常在网络安全上发表博客的人：http: [//ha.ckers.org/blog/](http://ha.ckers.org/blog/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T11:05:05.167

我不熟悉提供此类服务的公司。我们使用[HP 应用程序安全中心](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-201-200_4000_100__)。它是一个自动测试工具，用于在您提到的方面验证您的应用程序安全性。

免责声明：我为惠普软件工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T12:02:03.413

[S21Sec](http://www.s21sec.com/)是一家非常专业的安全公司，拥有许多重要的机构和公司作为客户。

[Tenable](https://products.nessus.org/)是最著名的 VA-Tool Nessus 的创建者，其培训和认证课程也很有用。尽管如此，我不知道他们自己是否提供安全服务。

[Counterpane是由著名的密码分析师](http://bt.counterpane.com/)[Bruce Schneier](http://www.schneier.com/)创立的公司，现在是[BT 集团](http://bt.com/)的一部分，它也提供您正在寻找的那种服务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T21:05:28.983

At this time I will only recommend two firms: Gunnar Peterson of [Artec](http://www.arctecgroup.net) and Nish Bhalla of [Security Compass](http://www.securitycompass.com/).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-30T22:36:15.407

首先，您应该意识到您有几种不同类型的选择：根据您的预算和实际的安全需求，您可能会得到一个自动网络扫描工具（其中很多）很好（足够）服务。但考虑到这些都不是很好，您可以预期多达 30-40% 的漏洞被发现，另一方面，这确实有助于清理脚本小子等将跳入的低悬的果实。

另一方面，也许你需要的不仅仅是渗透测试，而是更全面的安全审计，包括设计审查、代码审查、指南等。这个问题的答案通常与你最初的问题不同，这似乎是针对测试。如果您确实需要这些，请告诉我，我也可以提供帮助。

但是对于您的直接问题，一个好的渗透测试公司 - 取决于您所在的地区。
此外，您的特定需求 - 不仅是您想要的安全性，还有您拥有的技术。有些人在某些事情上比其他人更好。无论如何，您不想要一个特定的名称，您应该询问标准。

同样，根据您所在的地区，有许多本地“精品”类型的公司，但重要的是从***了解*****安全****的客户那里***获得这些参考。在这个令人困惑的领域中，有太多人只是简单地向他们不知情的客户提供一些奇怪的信息，而这些人永远不会知道得更好，直到他们被 scriptkiddies 的一个微不足道的攻击所攻击。*

 *# pdf - 如何从 shell 脚本中判断扫描 PDF 的分辨率？

> ID：452667
> 
> 赞同：10
> 
> 时间：2009-01-17T02:02:19.397
> 
> 标签：pdf, shell

我有大量扫描成 PDF 格式的文档，我希望编写一个 shell 脚本，将每个文档转换为[DjVu](http://djvuzone.org/)格式。一些文档以 200dpi、一些 300dpi 和一些 600dpi 扫描。由于 DjVu 是基于像素的格式，因此我想确保在目标 DjVu 文件中使用与用于扫描的分辨率相同的分辨率。

有谁知道我可以运行什么程序，或者我如何编写程序来确定使用什么分辨率来生成扫描的 PDF？（像素数也可能起作用，因为几乎所有文档都是 8.5 x 11 英寸。）

* * *

回应后的澄清：我知道布雷顿强调的困难，我愿意承认这个问题一般来说是不合适的，但我不是在问*一般的*PDF 文档。我的特定文件来自扫描仪。它们每页包含一个扫描图像，每页具有相同的分辨率。如果我将 PDF 转换为 PostScript，我可以用手四处寻找并轻松找到像素尺寸；我可能会找到更多工作的图像尺寸。如果急需，我可以修改`gs`正在使用的字典堆栈；很久以前，我为 PostScript Level 1 写了一个解释器。

所有这些都是我试图避免的。

* * *

感谢收到的帮助，我在下面发布了一个答案：

1.  使用 提取 PDF 中的边界框`identify`，仅获取第一页的输出，并了解单位将是 PostScript 点，其中有 72 到一英寸。
2.  使用 .从第一页提取图像`pdfimages`。
3.  获取图像的高度和宽度。这次`identify`将给出像素数。
4.  添加图像的总*面积*以获得平方的点数。
5.  要获得分辨率，请以平方英寸为单位计算边界框的面积，将点的平方除以平方英寸，取平方根，然后四舍五入到最接近的 10 倍数。

脚本的完整答案如下。我在实弹中使用它，效果很好。感谢 Harlequin`pdfimages`和 Spiffeah 关于每页多张图片的提醒（这种情况很少见，但我找到了一些）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T13:11:21.400

如果通过扫描创建了 pdf，则应该只有一个图像与每一页相关联。[您可以通过使用iText](http://www.lowagie.com/iText/) (Java) 或[iTextSharp](http://itextsharp.sourceforge.net/) (.net 端口) 库轻松 解析 pdf 来找到每个页面图像的每个图像分辨率。

如果您想使用自己的实用程序来执行此操作，请在 iTextSharp 中执行以下操作：

```
PdfReader reader = new PdfReader(filename);
for (int i = 1; i <= reader.NumberOfPages; i++)
{
PdfDictionary pg = reader.GetPageN(i);
PdfDictionary res = (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));
PdfDictionary xobjs = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
if (xobjs != null) 
{
    foreach (PdfName xObjectKey in xobjs.Keys)
    {
    PdfObject xobj = xobjs.Get(xObjectKey);
    PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(xobj);
    PdfName subtype = (PdfName)PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE));
    if  (subtype.Equals(PdfName.IMAGE))
    {
        PdfNumber width = (PdfNumber)tg.Get(PdfName.WIDTH);
        PdfNumber height = (PdfNumber)tg.Get(PdfName.HEIGHT);
        MessageBox.Show("image on page [" + i + "] resolution=[" + width +"x" + height + "]");
    }
    }
}
}   
reader.Close(); 
```

在这里，对于每个页面，我们读取子类型 Image 的每个 XObject 并获取 WIDTH 和 HEIGHT 值。这将是扫描仪嵌入 pdf 中的图像的像素分辨率。

*请注意，此图像的缩放以匹配页面分辨率（如在 Acrobat 中呈现的页面大小 - A4、Letter 等）是在页面内容流中单独执行的，它表示为 postscript 的子集，还有很多不解析后记更难找到。*

请注意，有些扫描仪会将扫描的图像嵌入为较小图像的网格（我假设用于某种尺寸优化）。因此，如果您看到每页弹出 50 个小图像，这可能就是原因。

如果您必须推出自己的实用程序，希望这在某种程度上有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-18T10:10:44.567

`pdfimages`有一个`-list`以像素为单位给出高度宽度的选项，`y-ppi`还有`x-ppi`.

```
 pdfimages -list tmp.pdf           
page   num  type   width height color comp bpc  enc interp  object ID x-ppi y-ppi size ratio
--------------------------------------------------------------------------------------------
   1     0 image    3300  2550  gray    1   1  ccitt  no       477  0   389   232  172K  17%
   2     1 image    3300  2550  gray    1   1  ccitt  no         3  0   389   232  103K  10%
   3     2 image    3300  2550  gray    1   1  ccitt  no         7  0   389   232  236K  23%
   4     3 image    3300  2550  gray    1   1  ccitt  no        11  0   389   232  210K  20%
   5     4 image    3300  2550  gray    1   1  ccitt  no        15  0   389   232  250K  24%
   6     5 image    3300  2550  gray    1   1  ccitt  no        19  0   389   232  199K  19%
   7     6 image    3300  2550  gray    1   1  ccitt  no        23  0   389   232  503K  49%
   8     7 image    3300  2550  gray    1   1  ccitt  no        27  0   389   232  154K  15%
   9     8 image    3300  2550  gray    1   1  ccitt  no        31  0   389   232 21.5K 2.1%
  10     9 image    3300  2550  gray    1   1  ccitt  no        35  0   389   232  286K  28%
  11    10 image    3300  2550  gray    1   1  ccitt  no        39  0   389   232 46.8K 4.6%
  12    11 image    3300  2550  gray    1   1  ccitt  no        43  0   389   232 55.5K 5.4%
  13    12 image    3300  2550  gray    1   1  ccitt  no        47  0   389   232 35.0K 3.4%
  14    13 image    3300  2550  gray    1   1  ccitt  no        51  0   389   232 26.9K 2.6%
  15    14 image    3300  2550  gray    1   1  ccitt  no        55  0   389   232 66.5K 6.5%
  16    15 image    3300  2550  gray    1   1  ccitt  no        59  0   389   232 73.9K 7.2%
  17    16 image    3300  2550  gray    1   1  ccitt  no        63  0   389   232 47.0K 4.6%
  18    17 image    3300  2550  gray    1   1  ccitt  no        67  0   389   232 30.1K 2.9%
  19    18 image    3300  2550  gray    1   1  ccitt  no        71  0   389   232 70.3K 6.8%
  20    19 image    3300  2550  gray    1   1  ccitt  no        75  0   389   232 46.0K 4.5%
  21    20 image    3300  2550  gray    1   1  ccitt  no        79  0   389   232 28.9K 2.8%
  22    21 image    3300  2550  gray    1   1  ccitt  no        83  0   389   232 72.7K 7.1%
  23    22 image    3300  2550  gray    1   1  ccitt  no        87  0   389   232 47.5K 4.6%
  24    23 image    3300  2550  gray    1   1  ccitt  no        91  0   389   232 30.1K 2.9% 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T06:36:33.383

我猜这些扫描件作为图像包含在 PDF 中，因此您可以`pdfimages`先提取它们。那么，`identify`应该就能找到正确的数据了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-23T07:40:44.947

以下是此答案的要素：

*   `pdfimages`将提取图像以便发现点的数量。
*   `identify`将以 PostScript 点为单位给出图像的大小（72 英寸）
*   由于某些扫描仪可能会将单个页面拆分为多个大小和形状不同的图像，因此关键是将所有图像的*区域相加。*将方点除以平方英寸并取平方根即可得出答案。

下面是一个解决问题的 Lua 脚本。我可能可以使用普通的外壳，但捕获宽度和高度会更麻烦。

```
#!/usr/bin/env lua

require 'osutil'
require 'posixutil'
require 'mathutil'

local function runf(...) return os.execute(string.format(...)) end

assert(arg[1], "no file on command line")

local function dimens(filename)
  local cmd = [[identify -format "return %w, %h\n" $file | sed 1q]]
  cmd = cmd:gsub('$file', os.quote(filename))
  local w, h = assert(loadstring(os.capture(cmd)))()
  assert(w and h)
  return w, h
end

assert(#arg == 1, "dpi of just one file")

for _, pdf in ipairs(arg) do
  local w, h = dimens(pdf)  -- units are points
  local insquared = w * h / (72.00 * 72.00)
  local imagedir = os.capture 'mktemp -d'
  assert(posix.isdir(imagedir))
  runf('pdfimages -f 1 -l 1 %s %s 1>&2', os.quote(pdf),
                                         os.quote(imagedir .. '/img'))
  local dotsquared = 0
  for file in posix.glob(imagedir .. '/img*') do
    local w, h = dimens(file)  -- units are pixels
    dotsquared = dotsquared + w * h
  end
  os.execute('rm -rf ' .. os.quote(imagedir))
  local dpi = math.sqrt(dotsquared / insquared)

  if true then
    io.stderr:write(insquared, " square inches\n")
    io.stderr:write(dotsquared, " square dots\n")
    io.stderr:write(dpi, " exact dpi\n")
    io.stderr:write(math.round(dpi, 10), " rounded dpi\n")
  end
  print(math.round(dpi, 10))
end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T02:57:41.233

太长了无法发表评论，但 ImageMagick 和 GraphicsMagic 都不能胜任这项工作；**每个答案都是错误的**：

```
: nr@yorkie 1932 ; gm identify -format "x=%x y=%y w=%w h=%h" drh*rec*pdf
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792
x=0 y=0 w=612 h=792

: nr@yorkie 1933 ; identify -format "x=%x y=%y w=%w h=%h" drh*rec*pdf   
x=72 Undefined y=72 Undefined w=612 h=792x=72 Undefined y=72 Undefined     w=612 h=792x=72 Undefined y=72 Undefined w=612 h=792x=72 Undefined     y=72 Undefined w=612 h=792x=72 Undefined y=72 Undefined w=612     h=792x=72 Undefined y=72 Undefined w=612 h=792x=72 Undefined y=72     Undefined w=612 h=792x=72 Undefined y=72 Undefined w=612 h=792
: nr@yorkie 1934 ; 
```

本文档的正确参数是每个扫描页面的宽度为 5100 像素，高度为 6600 像素，这并不奇怪，因为这是以 600dpi 扫描的 8.5 x 11。ImageMagic 的输出非常不专业。

没有downvotes，因为您试图提供帮助，但`*Magick`没有工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T03:20:58.130

PDF 是一种独立于分辨率的格式，这是一个无意义的问题。您可能已经以特定分辨率扫描了一些位图，并且这些位图单独嵌入到 pdf 中，但 PDF 本身可能包含多种分辨率的图像，以及与分辨率无关的矢量图形。如果不打开pdf并检查其中的每个对象，就无法知道。

编辑以继续阐述问题：

你可能很幸运，你用来扫描文档的软件嵌入了一些关于这个的元数据，但不要赌它。这样的元数据不太可能是标准的。至于解析 pdf，您需要一个预先编写的库 - 例如 ghostscript。问题是 PDF 与其说是一种格式，不如说它是 PostScript 编程语言的一个指定子集，并且是一种商定的压缩/编译该子集以及一些二进制文件的方式。因此阅读 PDF 比其他类型的图像格式更复杂，因为它涉及编写语言解释器 - 不是那么简单。

最好的方法是要么举手放弃，要么认真研究ghostscript，看看你是否能得到它来告诉你答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-01T21:16:38.340

Apago 的 PDF Spy 将告诉您 PDF 中图像的实际分辨率以及许多其他内容。这是一个商业产品，但有一个 10 天的演示。

# java - 是否有充分的理由使用 XML 而不是通过注释来配置休眠？

> ID：452669
> 
> 赞同：17
> 
> 时间：2009-01-17T02:03:20.220
> 
> 标签：java, xml, hibernate, jpa, annotations

我已经使用 Hibernate 几年了，但只将它与注释一起使用，并在我的代码中设置连接参数。

我是否因为不使用 XML 文件而“遗漏了一些东西”？是否有仅在 XML 中可用的重要功能？是否存在使用 XML 有意义的情况或模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T02:28:51.870

我认为可以肯定地说你没有错过任何东西。

如果 XML 中有任何不能在属性中表示的功能（我相信有一些罕见的情况），那么您仍然可以选择使用 [RawXml] 并将 XML 写入属性中。因此，您不可能错过任何功能。

如果您的团队中有足够多的程序员只是喜欢管理单独的文件，或者如果确实需要即时编辑 xml 映射，那么使用 XML 可能是有意义的。对于非常复杂的映射，XML 映射文件可能更容易操作，并且它们可以包含有用的信息（关于获取策略的评论等）。

还有体系结构的问题，有些人认为将映射分离到 XML 文件中可以更好地分离业务相关代码和关于如何持久化的指令。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T02:20:09.670

注释是快速配置 Hibernate 的好方法。但是像 Hibernate 这样的 OR 映射器的关键特性之一是您可以让您的域模型“不知道持久性”，您的对象不需要知道它们在何处以及如何持久化。有些人可能会争辩说，使用注释会破坏这一点。在持久性只是众多问题之一的情况下，将事情分开是有意义的。

另一个原因可能是域对象在不同情况下的持久化方式不同，您可以让一个应用程序使用多个数据库，甚至多个应用程序使用相同的域模型。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-17T02:11:31.170

Hibernate 不使用 EJB3/JPA 标准注解吗？如果是这样，我至少可以想到一个使用 XML 的理由：那些注解不具备 Hibernate 的所有功能。

示例：Hibernate 可以为 ID 定义“本机”类型。这将在 MySQL 上创建一个自动增量字段，在 Oracle 上创建一个序列。没有办法使用在这两种情况下都有效的 JPA 注释来做到这一点。

此外，XML 是可插入的。注释不是。如果您运送到多个数据库平台并且每个平台都有不同的配置，这可能对您很重要。

XML 已经失去了许多开发人员的青睐，仅出于这个原因，我认为很多人喜欢注释。问题是，无论如何您都有 XML（以 persistence.xml 文件的形式，可能还有其他形式）。这有点像一个六个，另一个六个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T13:48:13.043

在注释中几乎没有什么是您不能在 XML 中做的。我什至想不出任何atm。您可以尝试遵循 JPA，但我发现 JPA API 非常有限。不过，这只是意味着您使用非标准的 Hibernate 特定注释。

有几条评论指出休眠注释会污染您的域模型，但无论如何这些都与您的数据库布局紧密耦合。在任何不是数据库驱动的代码中，无论如何您都需要构建一个中间层。事实上，恕我直言，很多网络应用程序应该使用中间值对象，这些对象只复制表示层所需的数据。相反，许多人在视图反模式中使用开放会话。

最后，虽然 xml 配置很灵活，但通常的做法表明，每当我们编辑 xml 文件时，我们几乎总是在编辑 java 源文件。这只是将配置移近对象的另一个论据，即进入注释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T02:45:22.710

我会提到，我发现注释的唯一缺点是我必须将相关的注释嵌入到我的域模型的类中，因此任何使用域模型的程序都需要访问 API。

但是，由于各种原因，我不直接保留我的域模型，而是有一个类似（但有些不同）的“持久域模型”，它被持久化并且只在服务器中，所以这不是一个大问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T14:42:57.690

不想重复已经说过的任何内容，但我使用 XML 样式配置将其与我的代码分开。这主要是根据我的个人喜好完成的，归根结底，这无关紧要:) 你可以用 XML 做的另一件事是让 hbm2java 为你生成代码，我也喜欢这样做，但它又是一个优势; 可能不是。

所以我想说这只是你喜欢什么的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-08T15:17:08.933

我不知道您是否在配置中包含命名查询，但我倾向于将它们放在 XML 文件中，即使我认为这会增加实体及其查询之间出错的风险。它允许调整查询而无需重新编译整个应用程序。

如果您将实体从业务重用到表示层，使用 XML 代替注释也可以避免 UI 层中的 JPA 依赖，但我不确定该论点是否相关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-07T21:23:43.943

我发现的一件事是，与在 XML 中映射它们相比，注释似乎更容易使用 UUID/GUID 列。但话又说回来，我是 Hibernate 的新手。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-31T14:47:08.167

*   目前无法使用带注释的liquidbase。
*   无法使用注释创建 dabase 对象，您必须使用

    cfg.addAuxiliaryDatabaseObject(new SimpleAuxiliaryDatabaseObject(...sql here...))

为了创建一些特殊的 sql 指令。

# oop - 单一职责原则的实现

> ID：452670
> 
> 赞同：4
> 
> 时间：2009-01-17T02:06:12.990
> 
> 标签：oop, solid-principles, single-responsibility-principle

如果我将我的对象分解为“单一职责”，是否有一个基本的想法是类似的对象应该一起存在还是分开存在，例如，如果我有

```
class Employee_DataProvider() : IEmployee_DataProvider { ... };
class Employee_Details() : IEmployee_Details { ... };
class Employee_Payroll() : IPayroll() { ... };
class Employee_LeaveProcessing() : ILeaveProcessing_Client { ... };
... 
```

将所有这些都存在于内部，但通过接口松散耦合到一个拥有的 Employee 类，是不是很糟糕：

```
class Employee
{
    IEmployee_DataProvider _dataProvider;
    IEmployee_Details _details;
    IPayroll _payroll;
    ILeaveProcessing_Client _leaveProcessing;

    //My functions call the interfaces above

} 
```

还是更多地考虑在代码中将这些类完全分开（或尽可能地分开）？或者这两种方法都是 SRP 的有效用法？

**编辑：**我不想批评示例中给出的对象的可行性，我只是为了说明问题而编造出来的。我同意数据、休假和工资单处理不是员工类的领域。

尽管 SRP 确实要求我从作为现实世界表示的对象转向作为围绕单个功能概念的属性和方法的对象

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T02:41:42.110

回到 OOP 的基础知识：Employee 对象应该有反映它所做的事情的方法，而不是对它做了什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T06:52:54.457

尽管还没有人解决我关于原则本身的实际问题，而不是我给出的有点糟糕的例子，一个 Employee 对象对影响它的过程了解太多，对于那些显然对这个问题感兴趣的人（有 2 '最喜欢的'星）我已经做了更多的进一步阅读，尽管我希望有更多的讨论。

I think what the two current answers are trying to say is that responsibilities separated should be able to be stand alone, and that my example was a perfect example of what not to do. I am more than happy to accept that.

There is a paragraph from [ObjectMentor](http://www.objectmentor.com/resources/articles/srp.pdf) (Uncle Bob's site) that has an example that combines Connection and DataReader objects (two objects previously living in a modem class then separated out) into a ModemImplementation, but states

> However, notice that I have recoupled the two responsibilities into a single ModemImplementation class. This is not desirable, but it may be necessary. There are often reasons, having to do with the details of the hardware or OS, that force us to couple things that we’d rather not couple. However, by separating their interfaces we have decoupled the concepts as far as the rest of the application is concerned.
> 
> We may view the ModemImplementation class is a kludge, or a wart; however, notice that all dependencies flow away from it. Nobody need depend upon this class. Nobody except main needs to know that it exists. Thus, we’ve put the ugly bit behind a fence. It’s ugliness need not leak out and pollute the rest of the application.

I think the line 'notice that all dependencies flow away from it' is an important one here

# macos - 如何使终端的错误消息着色？

> ID：452678
> 
> 赞同：1
> 
> 时间：2009-01-17T02:13:32.150
> 
> 标签：macos, bash, terminal

我希望在我的终端中看到五颜六色的错误，例如：

![在此处输入图像描述](https://i.stack.imgur.com/SU0Vu.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T02:18:48.393

[IPython](http://ipython.scipy.org/moin/)将语法突出显示 Python 代码和堆栈跟踪，如您提供的示例（实际上是 Python 堆栈跟踪）。

您链接到的示例实际上并没有在用户的控制台上突出显示语法，也没有得到他们的 shell 的支持，而是在上传后由 Stack Overflow 网站突出显示。

如果你想要一个对新手友好的 UNIX shell，它可以进行某种程度的通用语法突出显示，我推荐[fish shell](http://www.fishshell.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T07:22:12.790

不幸的是，没有完美的通用解决方案。但是有一些通用的方法可以工作。

[GRC](http://kassiopeia.juls.savba.sk/~garabik/software/grc.html "GRC")代表 Generic Colouriser，用于美化您的日志文件或命令输出。它打包在主要发行版上。我已经用它很好地为我的 make 输出着色。GRC 通常用于具有“grc 命令”等别名的常用命令。还有其他着色器和网站有时有自己独特的着色器。

许多程序使用传统的命令行开关--color=auto。--color=always 即使在非交互式 shell 中也会发生颜色，稍后使用诸如 less -R 之类的终端代码感知命令可以很好地查看记录的命令。

如果你的文本来自任何半途而废的程序，并且曾经被记录或存储在文件中，那么文本编辑器 Vim 或 Emacs 可以对其进行一些非常智能的突出显示。其他编辑器/IDE 也可以，但没有一个是全面的。它们具有配置文件的一般突出显示方案以及非常模糊的特定文件类型，例如“Quake[1-3] 配置文件”。当然，每个编辑器都有很多配色方案来改变编辑器识别的高亮区域的颜色。这可能是最常用于获得非常好的突出显示的方法。

当然，有一些方法可以在终端中手动输入颜色，使用 tput 或实际的转义码，以及 ipython 等单独的程序。你没有问那个问题，但你选择了这样的答案作为你最喜欢的解决方案:(

您可能期望的一般解决方案是在终端中为标准错误着色。不幸的是，由于有很多复杂性，无法做到这一点，例如您的提示被发送到标准错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T03:35:32.717

试试这个示例 Perl 脚本：

```
use Term::ANSIColor;
print "Hello "
  .color("green")
  ."world"
  .color("reset")
  ."\n" 
```

或作为外壳单线：

```
perl -e 'use Term::ANSIColor; print "Hello ".color("green")."world".color("reset")."\n"' 
```

请注意，您需要安装**Term::ANSIColor**模块。

# javascript - 有可用的就地 Javascript 富文本编辑器吗？

> ID：452685
> 
> 赞同：2
> 
> 时间：2009-01-17T02:21:21.993
> 
> 标签：javascript, jquery, text-editor

JS 中有没有像 TinyMCE / FCKEditor 这样支持富文本的就地编辑器？

例如就地编辑（非富文本）： http: [//www.appelsiini.net/projects/jeditable/default.html](http://www.appelsiini.net/projects/jeditable/default.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T13:49:28.843

[我认为NicEdit](http://www.nicedit.com/)是您想要的，网站上有一些演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T03:29:27.923

你能不能只使用 TinyMCE (/whatever)，把它变小，将一些 jQuery 事件处理程序附加到文本并在适当的时候用编辑器替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T03:54:57.110

[jEditable](http://www.appelsiini.net/2008/5/jeditable-and-tinymce)和[TinyMCE](http://sam.curren.ws/index.cfm/2008/6/12/jEditable-TinyMCE-Plugin)一起使用：

[谷歌](http://www.google.com.au/search?q=jeditable+tinymce&sourceid=navclient-ff&ie=UTF-8&rlz=1B3GGGL_enAU216AU217&aq=t)是你的朋友！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T04:01:22.697

我会使用 FCKEditor。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T21:47:53.167

有jWYSIWYG：[http ://projects.bundleweb.com.ar/jWYSIWYG/](http://projects.bundleweb.com.ar/jWYSIWYG/)

# unit-testing - 正确的单元测试：测试没有 [accessible] 状态或返回值的方法

> ID：452689
> 
> 赞同：7
> 
> 时间：2009-01-17T02:27:15.007
> 
> 标签：unit-testing

我对单元测试有些陌生。关于正确测试的一件事（目前）让我感到困惑。

例如，如果 main 方法没有状态且只有控制台输出，你如何测试它？像这样，myServer 方法和状态在哪里是私有的？

```
 public static void main(String[] args)
 {
     Server myServer = new Server()
     if(myServer.start())
          System.out.println("started");
     else
          System.out.println("failed"); 
 } 
```

我不想更改我的代码并公开我的服务器方法和状态以将它们公开。

注意，我不是在问如何测试 myServer.start()，我是在问如何测试 main() 本身。

请告诉我。

谢谢大家，jbu

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T07:25:26.920

主要方法应该很薄，只是让球滚动。因此一般不测试。例如 .net Winforms 应用程序 Main 方法可能包含

```
static void Main()
{
  Application.EnableVisualStyles();
  Application.SetCompatibleTextRenderingDefault(false);
  Application.Run(new MainWindow());
} 
```

如果您的主要方法正在做很多事情，请考虑提取一个方法（如果需要，可以提取一个新类）。例如如下所示......（手边没有JavaIDE......下面的.net代码应该很容易翻译）

```
static void Main()
{
  new MainApp().Run();
} 
```

现在如果可以测试 Run .. Main 也被覆盖了。让我们看看 MainApp。重构了*启动服务器*和*将结果记录*为 2 个方法的 2 个任务。

```
public class MainApp
{
  private Server m_Server;
  public MainApp():this(new Server())
  {}
  public MainApp(Server s)
  {  m_Server = s;      }

  public void Run()
  {  Log(LaunchServer());  }

  private string LaunchServer()
  {  return (m_Server.start() ? "started" : "failed");        }

  protected virtual void Log(string sMessage)
  {  System.Console.WriteLine(sMessage);        }
} 
```

现在让我们看看测试代码......我将使用“子类和覆盖”技巧来缓存结果，如下所示。（你也可以使用 Mocks.. 根据口味）

```
public class FakeApp : MainApp
{
  private string sLastLoggedMessage;

  public FakeApp(Server s) : base(s) { }

  public string getLastLoggedMessage()
  {  return sLastLoggedMessage;        }

  protected override void Log(string sMessage)
  {  sLastLoggedMessage = sMessage;        }
} 
```

测试现在很简单

```
[TestFixture]
public class TestMainApp
{
  [Test]
  public void TestRun()
  {
    Server s = new Server();
    FakeApp f = new FakeApp(s);

    f.Run();

    Assert.AreEqual("started", f.getLastLoggedMessage());
  }
} 
```

如果您不能强制 Server.start() 根据您的意愿成功或失败.. 您可以创建一个 FakeServer.. 子类并覆盖 start() 以返回固定值。

*如果一个方法做某事，它可以被测试。如果没有，它应该不复存在。重构它。*高温高压

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T02:32:24.530

您（通常）不对 main() 方法进行单元测试。在您的情况下，您对 Server 类（可能还有其他类）进行单元测试，即测试它的公共接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T03:53:48.860

由于您的方法仅在一个方向上具有信息流 - 到协作对象（在此示例中：Server 对象），并且不会返回值或引发异常，因此您可以提供一个模拟协作对象（在您的示例中为模拟服务器) 这将配置对从您的 main() 方法接收的方法调用及其参数的期望。

您可以为此使用几个模拟对象框架之一，例如 Easymock。

在单元测试期间，当 main() 方法对其进行的调用与配置的期望不匹配时，模拟对象将引发适当的异常。

当然，为了提供一个模拟对象，你必须在对象实例化方面稍微修改一下方法——使“服务器”成为一个接口，而不是一个具体的类，并使用一个框架（如 Spring）而不是手动实例化您的服务器对象，例如，而不是：

```
Server myServer = new Server(); 
```

你会有这个：

```
Server myServer = applicationContext.getBean("server"); 
```

您将为生产应用程序和单元测试创​​建单独的 Spring 应用程序上下文配置，不同之处在于生产应用程序上下文将使用 XML 文件配置，而单元测试将以编程方式创建并填充来自您的模拟对象测试类的 setUp() 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T06:02:27.007

将代码包装在非主要方法中并对其进行测试；-)

说真的，其他人都说了什么

但是如果你必须...进行单元测试，在 DOS shell 中运行控制台应用程序（参见 Process 对象），并将 STDOUT 重定向到文件，然后读取输出文件的内容以查看它是否显示“已启动”或“失败”，无论你期望什么

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T02:40:16.450

如果您想澄清这个案例 - 以及许多其他案例 - 我可以建议[实用单元测试](https://rads.stackoverflow.com/amzn/click/com/0977616673)系列吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T03:36:02.747

一般来说， main() 不是“单元”，并且很难为其设计单元测试。按照惯例， main() 应该返回一个 int 来指示错误状态。也许这就是你所需要的？

# asp.net-mvc - ASP.NET MVC 母版页

> ID：452698
> 
> 赞同：19
> 
> 时间：2009-01-17T02:35:30.607
> 
> 标签：asp.net-mvc, master-pages, asp.net-3.5

ASP.NET 母版页和 MVC 母版页有什么区别？那么 AJAX 母版页呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-20T11:22:54.747

大多数情况下，它归结为默认控件和继承。

AJAX Master 和 ASP.NET Master 都继承自 System.Web.UI.MasterPage，而 MVC Master 继承自 ViewMasterPage。

显然，这些为您提供了稍微不同的控制 - 正如[John Clayton](https://stackoverflow.com/questions/452698/asp-net-mvc-master-pages#452887)所述，ViewMasterPage 公开了 Ajax/Html/Url 帮助程序等，这些对其他 MasterPages 不可用。

除此之外，默认控件略有不同：

*   ASP.NET 母版页将具有默认的 Form 和两个 ContentPlaceHolder 控件（一个在头部，一个在窗体中。
*   AJAX 母版页还在 Form 控件内添加了一个 ScriptManager 控件。
*   MVC Master（取决于版本 - 我指的是 Beta）将只有两个 ContentPlaceHolder 控件（在头部和身体中）。

“生命周期差异”来自 Page/ViewPage，而不是 MasterPage/ViewMasterPage 控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T06:11:50.703

MVC 中的 ViewMasterPage 只不过是一个母版页，它公开与 ViewPage 相同的帮助器。这使您可以访问 AjaxHelper、HtmlHelper、TempDataDictionary、UrlHelper、ViewContext、ViewData 和 HtmlTextWriter。

与 ViewPage 一样，当您使用 WebFormsViewEngine（默认）时，您应该不惜一切代价抵制任何超载页面生命周期事件的冲动！它们仍然存在，并且它们仍然会运行，因为在页面上仍然调用 ProcessRequest(...)。

您指的是哪个 AJAX 母版页？我不熟悉框架中包含的任何内容......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T03:38:34.037

作为一个快速的猜测，我不得不说答案是“生命周期”。ASP.NET WebForms、MVC 和 AJAX 都有不同的生命周期，它们会影响需要由母版页控件响应的事件。WebForms 母版页需要响应 Load、DataBind、PreRender、Render 等。MVC 母版页可能（对此不确定）只需要 Render 操作。所有其他事件都是多余的，可以在控制器中找到等效代码。最后，AJAX 母版页需要在正常请求之上处理 AJAX 请求。

正如我所说，这有点猜测，因此建议进行更多研究

# jquery - 快速且可接受的 MP3 流媒体解决方案

> ID：452707
> 
> 赞同：7
> 
> 时间：2009-01-17T02:45:48.840
> 
> 标签：jquery, flash, audio, streaming, mp3

我必须在一夜之间完成一项工作，以便为通过 Internet 收听广播频道的用户启用一个非常简单的界面。我想知道流媒体的最佳解决方案是什么。我想到了 QuickTime，但它需要用户安装它，而且我不太确定 Quicktime 是否像 flash 一样普及。所以我倾向于在闪存中实现一些东西。你对一个好的工具有什么建议吗（它可能真的很简单，越简单越好）？

我不想要播放列表和类似的东西。该网站是用 DotNetNuke 构建的，它管理所有的交互。我只想在页面中插入允许用户播放/暂停并拖动到节目的另一部分的小栏。我将传递一个带有文件 URL 的参数，播放器应该管理其余部分。

它不会是实时流媒体，而是托管在服务器中的 MP3 文件的流媒体。

顺便说一句，我发现了这个项目（[http://www.sean-o.com/jquery/jmp3/](http://www.sean-o.com/jquery/jmp3/)），它是一个 jQuery 插件，看起来很有趣。有人知道吗？

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T03:04:26.633

使用 Flash 嵌入式 mp3 播放器。它可以播放 mp3 播放列表或单个文件。

使用 jw 播放器 ( [http://www.longtailvideo.com/players/jw-flv-player/](http://www.longtailvideo.com/players/jw-flv-player/) ) 可以让您轻松创建 xml 播放列表。它已准备好开箱即用。

使用 JW Player，您可以从 URL 指定文件名，这意味着您可以将链接作为 url 变量传递，而不必使用 XML 文件。我记得 XSPF 播放器也可以做到这一点，但我更多地使用 JW Player。

Xspf 播放器是另一个基于 Flash 的免费 mp3 播放器。 [http://musicplayer.sourceforge.net/](http://musicplayer.sourceforge.net/)

如果你想要更多的东西，你可以看看像这样的谷歌搜索。这应该足以让你继续前进。

[http://www.google.ca/search?q=free+flash+mp3+player&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a](http://www.google.ca/search?q=free+flash+mp3+player&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T23:24:42.007

SoundManager 与 JWPlayer 非常相似，但不需要支付许可证：

[http://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T03:05:42.123

[XSPF 播放器](http://musicplayer.sourceforge.net/)非常出色。我在紧急工作中使用了苗条的播放器，大约 10 分钟就可以运行它。

唯一的事情是您需要制作一个包含 MP3 详细信息（如曲目名称）的[XSPF 文件。](http://www.xspf.org/specs/)但是格式很简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T08:32:04.943

niftyPlayer 1.7 是基于 Flash 的最小的 MP3 播放器，目前可以播放单个文件... **优点** 小 (~4kb) 免费、开源 无需 Flash 知识：文件 URL 以 HTML 格式指定 JavaScript 就绪！您甚至可以完全绕过 Flash 界面！自动启动功能 可拖动/可点击的搜索栏 使用播放/暂停和停止按钮进行简单操作 使用进度条进行缓冲 缓冲是可停止的！（通过停止按钮） 音量控制 非常口头 遇到错误时重试 **缺点** 没有播放列表功能（但可以在 JavaScript 中完成！） 没有照片幻灯片或视频功能 声音必须是 MP3（闪存限制）

# winapi - win32 SDK子窗口绘制（C/C++）

> ID：452725
> 
> 赞同：1
> 
> 时间：2009-01-17T03:08:33.163
> 
> 标签：winapi, childwindow

我正在使用 win32 Platform SDK（在 XP Pro 上）创建一个应用程序，该应用程序由一个主窗口和多个子窗口组成。

传递给 CreateWindow 的样式是`WS_OVERLAPPEDWINDOW | WS_VISIBLE`（对于主窗口）和`WS_CHILDWINDOW | WS_VISIBLE`子窗口。

我看到的错误是当另一个应用程序被拖到我的应用程序顶部时，底层窗口不会重绘。强制更新的一种简单（但笨拙）的方法是“摇晃”标题栏。

我猜我错过了一条 Windows 消息或没有正确调用 win32 函数。我的大部分代码直接来自 Petzold 的 95 本书。

如果重要的话，主窗口不需要绘制任何东西：子窗口处理所有显示任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T03:38:00.013

听起来您没有为 WM_PAINT 消息调用 DefWindowProc。

您确定您正在正确处理[WM_PAINT](http://msdn.microsoft.com/en-us/library/ms534841(VS.85).aspx)事件吗？特别要确保对于您正在调用的此 WM_PAINT 消息：

```
DefWindowProc(hwnd,msg,wParam,lParam); 
```

当您的窗口需要重新绘制时，将调用 WM_PAINT。

如果您尝试处理自己的窗口绘制，请确保您在处理程序中调用 BeginPaint 和 EndPaint。

# wpf - Scrolling credits screen in WPF... ideas?

> ID：452726
> 
> 赞同：10
> 
> 时间：2009-01-17T03:08:56.937
> 
> 标签：wpf, animation, 3d, scroll, credits

I'm looking to create a (possibly 3D) scrolling credits screen for my app, that is similar to what you might see at the end of a movie, but should be able to include graphics, animations, etc.

What is the best way to go about doing this? I'm thinking I could create a very tall UserControl that contains the entire content to scroll and then just animate it inside a ScrollViewer, or even just a Canvas and animate the position, but there are obvious performance issues with doing something like that and I'm afraid it would be too slow.

It would be cool if the credits could scroll on a 3D surface, kind of like Star Wars, or with a fisheye effect, but I know squat about 3D in WPF.

I do definitely want some kind of fading/alpha-blending so the credits appear to fade in at the bottom and/or fade out at the top, but I'm also stuck on how to do that.*

**Actually, for that I guess I could overlay some semitransparent gradient, so long as the background was a solid color.*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T00:34:08.677

Well since nobody seems to have any comments, I went ahead and did things how I described and must say the results are quite good. I used a vertical LinearGradientBrush to do the fading, and simply animated a UserControl inside a Canvas for the scrolling (animating Canvas.Top from <ActualHeight of Canvas> to (negative)<ActualHeight of UserControl>). Looks pretty good. :)

Here's the animation (note I had to set DoubleAnimation.To in code to scroller.ActualHeight):

```
<DoubleAnimation
x:Name="scrollAnim"
BeginTime="0:0:30"
Duration="0:0:30"
From="200"
Storyboard.TargetName="scroller"
Storyboard.TargetProperty="(Canvas.Top)" /> 
```

And here's the `scroller` element:

```
<Canvas
ClipToBounds="True"
x:Name="scrollerCanvas">
<Credits:ScrollingCredits
    x:Name="scroller"
    Canvas.Top="200"
    Width="{Binding ElementName=this, Path=ActualWidth}" />
</Canvas> 
```

(There is some other stuff going on, hence why the scrolling starts at 0:0:30.)

Here's the fader:

```
<Border
x:Name="border"
Opacity="0">
<Border.Background>
    <LinearGradientBrush
        StartPoint="0,0"
        EndPoint="0,1">
        <GradientStop
            Offset="0"
            Color="Black" />
        <GradientStop
            Offset="0.2"
            Color="#00000000" />
        <GradientStop
            Offset="0.8"
            Color="#00000000" />
        <GradientStop
            Offset="1"
            Color="Black" />
    </LinearGradientBrush>
</Border.Background>
</Border> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T14:07:19.127

You can use a VisualBrush to "paint" your credits user control on a 3d surface.

# mysql - mysql配置问题

> ID：452735
> 
> 赞同：0
> 
> 时间：2009-01-17T03:22:55.240
> 
> 标签：mysql, mysql-error-1045

从昨晚开始我就一直在尝试。起初它可以工作，但今天早上它又不工作了。我在 vista 机器上安装 mysql 5.0 版。当我尝试配置它时说：安全设置无法应用于数据库，因为连接失败并出现以下错误：错误编号。1045 拒绝用户 'root'@'localhost' 访问（使用密码：是）

如果您的机器上运行了个人防火墙，请确保您已打开 tcp 端口 3306 进行连接。否则没有客户端应用程序可以连接到服务器。打开端口后，请按重试应用安全设置。

如果您在刚刚安装 mysql 服务器后重新安装，请注意数据目录没有自动删除。因此，仍然需要您上次安装的旧密码才能连接到服务器。在这种情况下，请选择立即跳过并从开始菜单重新运行配置向导。

我尝试禁用wirefall，用户帐户但得到同样的错误。谁能给我一些建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T03:41:31.567

我敢打赌你的密码被改了。此错误清楚地表明您正在连接到 mysql 服务器，并且您的端口已打开并且工作正常。不过，您可能连接到错误的 mysql 服务器。尝试重新运行安装脚本以重置密码。如果您没有想要保留的数据，我想说最简单的方法是卸载（并删除整个 mysql 目录）并重新安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-18T12:47:29.113

我以前遇到过这个问题。我重新安装了 MySQL，然后运行**​​MySQL Server Instance Config Wizard**，删除了当前实例，然后再次运行**MySQL Server Instance Config Wizard**以创建一个新实例，一切正常。

# c# - 如何在泛型方法中使用泛型类型

> ID：452743
> 
> 赞同：2
> 
> 时间：2009-01-17T03:37:13.557
> 
> 标签：c#, generics

**编辑**以显示真实示例

如何从传递给函数的泛型类型调用泛型函数？这似乎应该是直观的，但我似乎无法让它工作。

比如下面LocalDataObjectEngine中可以调用cache.ResetCache()函数吗？

我得到的错误是“T 型不能用作参数”

```
public interface ISimpleCache<T1>
{    
    ...
    void ResetCache<T>() where T : T1;
}

internal class LocalDataObjectEngine_Cache : ISimpleCache<IBrokeredDataObject>
{
    ISimpleCache<IBrokeredDataObject> _cache;

    ...

    public void ResetCache<T>() where T : IBrokeredDataObject
    {
        //logic here
    }

    ...
}

public partial class LocalDataObjectEngine : IEngine
{
    ISimpleCache<IBrokeredDataObject> _cache  = new LocalDataObjectEngine_Cache();

    public void ResetCache<T>() where T : IBrokeredDataObject
    {
        _cache.ResetCache<T>();
    }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T03:42:58.740

除非您的定义中有某些内容，否则我不确定发生了什么`IBrokeredDataObject`。您所写的内容看起来正确并且对我来说编译得很好。

[编辑以匹配 OP 中的编辑]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T05:50:30.700

首先，为什么需要在方法中指定泛型类型？该类已经指定了泛型类型，您将可以在您的方法中访问它：

```
public interface ISimpleCache<T1>
{    
    ...
    void ResetCache();
} 
```

这使得实现接口的类更简单：

```
internal class LocalDataObjectEngine_Cache : ISimpleCache<IBrokeredDataObject>
{
    ISimpleCache<IBrokeredDataObject> _cache;

    ...

    public void ResetCache();
    {
        //logic here with access to IBrokeredDataObject if needed
    }

    ...
} 
```

最后一种方法也是如此，只需调用

```
_cache.ResetCache(); 
```

但是，如果您出于某种原因确实需要在方法中指定泛型类型，请执行以下操作

* * *

开始吧：

为什么不在方法中使用 T1 而不是指定 T 应该像 T1？

```
public interface ISimpleCache<T1>
{    
    ...
    void ResetCache<T1>();
} 
```

在你的LocalDataObjectEngine_Cache中，不用再指定T，直接使用IBrokeredDataObject即可（如果你没有实现该方法，在接口名称上右击选择“实现接口”，会写成如下：

```
internal class LocalDataObjectEngine_Cache : ISimpleCache<IBrokeredDataObject>
{
    ISimpleCache<IBrokeredDataObject> _cache;

    ...

    public void ResetCache<IBrokeredDataObject>();
    {
        //logic here
    }

    ...
} 
```

然后从你的最后一堂课中，通过指定你想要 T 的实际类再次调用它：

```
public partial class LocalDataObjectEngine : IEngine
{
    ISimpleCache<IBrokeredDataObject> _cache  = new LocalDataObjectEngine_Cache();

    public void ResetCache<IBrokeredDataObject>()
    {
        _cache.ResetCache<IBrokeredDataObject>();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T08:25:24.160

删除 ...、对 IEngine 的引用并提供一个空的 IBrokeredDataObject 接口后，您的代码编译没有任何问题。

请提供一个简短但完整的示例，该示例*无法*编译。理想情况下，创建一个包含单个文件的新项目，将所有代码放在那里，并使其尽可能简单，同时显示相同的错误。然后只需剪切并粘贴到这里。这样我们就不需要修复“...”等或删除对我们没有声明的接口的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T11:23:39.747

找到了，Jon Skeet 提到删除 IEngine 为我指明了正确的方向，有一个

```
void ResetCache<T>() where T : IDataObject 
```

在 IEngine（IDataObject 是 IBrokeredDataObject 的基础）上，我改为

```
void ResetCache<T>() where T : IBrokeredDataObject 
```

感谢大家容忍我的错误，+1 给你们

# rest - 为什么 WADL 吸收缓慢？

> ID：452750
> 
> 赞同：28
> 
> 时间：2009-01-17T03:41:04.110
> 
> 标签：rest, wadl

我一直在研究 WADL，我想知道为什么它没有被更广泛地采用？

随着 REST 使用率的增长，我很惊讶更多的开发工作没有使用它。

它的设计是否存在根本性缺陷，它与通常围绕 RESTful Web 服务的文化不匹配，还是完全不同？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-17T10:57:27.083

我认为 WADL 没有得到普及的主要原因是它可能使我们在使用 SOAP 和 WSDL 时遇到的所有问题重新焕发生机。对我来说，互操作性方面是 Web 服务最重要的方面。
通过遵循使用纯 HTTP 标准的 RESTful 方式，您可以“免费”获得互操作性。一旦你需要一个文档来描述服务，就会有不同的客户端框架（或不同的服务器框架）以不同的方式解释这个文档。一旦不同的框架从 WADL 自动生成代码，您将不得不再次处理互操作性问题。

缺乏标准是 RESTful 方式的弱点和优势，让我们给简单的方式一个机会。（尽管我们真的很喜欢自动代码生成:-)）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-10T15:40:27.790

Jim Webber、Savas Parastatidis 和 Ian Robinson 的“实践中的 REST：超媒体和系统架构”提到了四个问题：

1.  WADL 预先获取 Web 应用程序的静态视图，其中 Web 使用媒体类型和合同链接
2.  WADL 工具促进了客户端和服务端抽象的紧密耦合。从服务通告的资源成为客户端的域模型。
3.  WADL 没有提供有关与它所宣传的资源的交互顺序的任何线索。
4.  WADL 通常会复制资源中可用的元数据。

第 1 点和第 2 点是关于动态与静态客户端绑定的参数。使用 WADL 时，服务实现者需要注意模式的向后兼容性，因为服务会发生变化。如果没有 WADL，客户端必须灵活地解释响应。

第 3 点涉及工作流程。WADL 没有记录调用 API 的顺序。[如果服务是根据HATEOAS](http://en.wikipedia.org/wiki/HATEOAS)实施的，那么 WADL 和非 WADL 服务响应都提供了通过链接进行排序的线索。

第 4 点假定 HEAD 和 OPTIONS 结果可能与 WADL 定义不一致。在实践中，很少实施或使用这些方法中的任何一种。

许多 REST 实现既快速又肮脏。实现一个只供我使用的 REST 服务很容易。当我必须为不同团队提供的服务创建客户端时，我需要文档。越正式越好。代码可读的文档，例如 WADL，将是最好的。

作为客户实施者，我的担忧是：

1.  如何发现支持的查询参数和标头？
2.  如何找到有关请求或响应媒体类型的文档？即使它是 IANA 注册的媒体类型，我仍然需要请求/响应模式。

# git - 如何获取分配给 git 中文件的所有标签？

> ID：452756
> 
> 赞同：3
> 
> 时间：2009-01-17T03:48:44.423
> 
> 标签：git

我需要知道文件的哪个版本/SHA1 与一个或多个标签相关联。在 CVS 中，可能会得到与此类似的输出：

> **文件**：abc.txt
> *版本*：1.0
> *标签*：R1_0, R1_1
> 
> *版本*：1.1
> *标签*：R1_2

如何使用 git获取**文件的标签历史记录？**

编辑：我经常使用此功能来判断文件的哪个**版本**正在生产中。我知道正在生产的软件版本（标签）。基于此，我想知道给定文件的哪个修订版被标记（以及哪些先前的标签与此文件修订版相关联）。

在我上面的示例中：
R1_1 将投入生产。查询 abc.txt，我可以看出 abc.txt 的 rev1.0 用于 R1_0 和 R1_1。（因此 R1_1 中的**新**错误不太可能是由 abc.txt 引起的，因为它仍然与 R1_0 相同的文件）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T09:33:58.173

我认为您在将概念从一个修订控制系统转换为另一个时过于具体。我会问，“`abc.txt`从那以后发生了什么变化`R1_1`？”

```
git log R1_1.. -- abc.txt 
```

现在你知道了两件事——它已经改变了，以及如何改变。`-p`如果您也想查看更改，请折腾。

## 不太有用，但您要求的是：

完全按照您的要求（我认为这不太有用），并假设您[正确标记](http://www.rockstarprogrammer.org/post/2008/oct/16/git-tag-does-wrong-thing-default/)：

```
git describe `git log --pretty=format:%H -n 1 abc.txt` 
```

这表明您最接近更改文件的最后一次提交的标记名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T17:57:59.340

在 git 中，标签总是与**整个项目**的状态相关联，而不是与单个**文件**的版本相关联。`git diff --name-only R1_0 R1_1`但是，您可以使用“ ”（或更描述性的“ ”）轻松获取在版本之间更改的所有文件的列表`git diff --stat --summary R1_0 R1_1`。您可以使用“”获取触及文件的最后一次提交`git log -1 <file>`。

[**但是如果你想找到一个错误，我认为使用git-bisect**](http://www.kernel.org/pub/software/scm/git/docs/git-bisect.html)命令来查找哪个版本引入了错误要好得多。您不仅会知道哪个文件有错误，而且会知道文件的哪个部分引入了它（是什么更改造成的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T03:54:09.107

你想达到什么目的？SHA1 标识了整个回购在那个时间点的状态。

# ruby-on-rails - Ruby on Rails“link_to_unless_current”的 ASP.NET MVC 版本

> ID：452763
> 
> 赞同：7
> 
> 时间：2009-01-17T03:54:59.870
> 
> 标签：ruby-on-rails, asp.net-mvc

我想在我的 SiteMaster 中包含一个链接（使用 Html.ActionLink），除非我链接到的视图是当前视图。例如，当用户已经看到“注册”视图时，显示“注册”链接是没有意义的。

在 Ruby on Rails 中，我使用[“链接`_`到`_`除非`_`当前”](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html)方法来执行此操作。

如何在 ASP.NET MVC 中复制此行为？我能想到的最好方法是在我的控制器中设置一个布尔值，以指示应该隐藏链接（因为它是当前的）。与 Rails 方法相比，这似乎真的很尴尬，所以我想我一定遗漏了一些东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T09:27:16.580

我不知道 ASP.NET MVC 中的这种辅助方法，但它应该很容易推出你自己的：

```
public static class HtmlExtensions
{
    public static string ActionLinkUnlessCurrent(this HtmlHelper htmlHelper, string linkText, string actionName)
    {
        string currentAction = htmlHelper.ViewContext.RouteData.Values["action"].ToString();
        if (actionName != currentAction)
        {
            return htmlHelper.ActionLink(linkText, actionName);
        }
        return linkText;
    }
} 
```

然后像这样使用它：

```
<%= Html.ActionLinkUnlessCurrent("Link Text", "Index") %> 
```

# c++ - 创建一个类对象数组

> ID：452771
> 
> 赞同：4
> 
> 时间：2009-01-17T04:02:06.737
> 
> 标签：c++

考虑下课

```
class test
{
public:
test(int x){ cout<< "test \n"; }

}; 
```

现在我想创建 50 个类 test 对象的数组。我无法更改班级测试。

对象可以在堆或堆栈上创建。

在这种情况下，不可能在堆栈上创建 obj，因为我们在类中没有默认构造函数

```
test objs(1)[50]; /// Error... 
```

现在我们可能会想到像这样在堆上创建对象..

```
test ** objs = NULL;
objs = (test **) malloc( 50 * sizeof (test *));
for (int i =0; i<50 ; ++ i)
{
   objs[i] = new test(1);
} 
```

我不想使用 malloc 。还有其他方法吗？

如果你们能想到更多的解决方案，请发布它们......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T04:18:31.070

如果没有默认构造函数，则无法创建对象数组，如**Foo foo [N] 。**它是语言规范的一部分。

**要么**做：

```
test * objs [50];
for() objs[i] = new test(1). 
```

你不需要 malloc()。您可以只声明一个指针数组。

```
c++decl> explain int * objs [50]
declare objs as array 50 of pointer to int 
```

但是您可能应该附加某种自动 RAII 类型的破坏。

* * *

**或**公开子类*测试：*

```
class TempTest : public test
{
public:
  TempTest() : test(1) {}
  TempTest(int x) : test(x) {}
  TempTest(const     test & theTest ) : test(theTest) {}
  TempTest(const TempTest & theTest ) : test(theTest) {}
  test & operator=( const     test & theTest ) { return test::operator=(theTest); }
  test & operator=( const TempTest & theTest ) { return test::operator=(theTest); }
  virtual ~TempTest() {}
}; 
```

进而：

```
TempTest  array[50]; 
```

您可以将每个*TempTest*对象视为一个*测试*对象。

注意：operator=() & 复制构造函数不是继承的，所以需要重新指定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T04:15:22.903

为什么需要数组？

```
std::vector<test*> v(50); 
```

或者按照`@j_random_hacker`评论中的建议：

```
std::vector<test> v(50, test(1)); 
```

一个例子：

```
/** g++ -Wall -o vector_test *.cpp && vector_test */
#include <algorithm>
#include <iostream>
#include <iterator>
#include <vector>

struct Test {
  int value;
  Test(int x) : value(x) 
  {
    std::cout << "Test(" << value << ")" << " ";
  }
  operator int() const
  {
    std::cout << "int(" << value << ")" << " ";
    return value;
  }
};

int main()
{
  using namespace std;

  vector<Test> v(5, Test(1));

  cout << endl;
  copy(v.begin(), v.end(), ostream_iterator<int>(cout, " "));
  cout << endl;

  v[1] = 2;
  v[2].value = 3;

  cout << endl;
  copy(v.begin(), v.end(), ostream_iterator<int>(cout, " "));
  cout << endl;

  return 0;
} 
```

输出：

```
Test(1) 
int(1) 1 int(1) 1 int(1) 1 int(1) 1 int(1) 1 
Test(2) 
int(1) 1 int(2) 2 int(3) 3 int(1) 1 int(1) 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T21:11:53.850

与许多人认为的相反，您实际上可以创建一个没有默认构造函数的对象数组。你不能做的是让它为所有构造函数调用使用一组参数。你只需要初始化它的所有元素。也就是说，您可以执行以下操作：

```
#define PRINTT(z, n, initializer) initializer
test objs[50] = {
    BOOST_PP_ENUM(50, PRINTT, 1) // yields 1, 1, 1, .... 1
};
#undef PRINTT 
```

这将用 1 初始化所有 50 个元素。`boost::pp`用于`1`自动连续打印 50 次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T08:29:29.957

我认为其他响应者对这个问题的处理过于字面了。

如果您真正想做的只是创建一个由 50 个对象组成的“组”，您可以将其视为一个数组，那么到目前为止，完成您想要做的事情的最简单和最可维护的方法是：

```
std::vector<test> objs(50, test(1)); 
```

这声明了`vector`50 个对象，每个对象都是`test(1)`. A`vector`基本上是一个 C++ 可增长数组；尽管您可能不需要可增长性，但可以使用复制构造每个元素的 2-arg 构造函数调用它的事实在这里很有用。

您可以或多或少地像使用数组一样使用它——例如，第 5 个元素是`objs[4]`. 性能也是相同的——C++ 标准保证在内部将元素存储在一个连续的数组中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T04:12:18.073

你不需要 malloc()。您也可以`new`用于指针数组：

```
 test **objs = new test* [50]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T12:51:17.683

Boost 的[指针容器](http://www.boost.org/doc/libs/1_37_0/libs/ptr_container/doc/ptr_container.html)库可能会在这里拯救。您可以保存堆分配对象的列表，`boost::ptr_vector<T>`这些对象甚至可以是多态的（虚拟函数），而简单的`std::vector<T>`.

与 不同`std::vector<T>`的是，对象不会存储在后续的内存地址中。然而，诸如调整容器大小之类的事情会更快，因为元素将保留其原始内存地址。最好的好处是，您不需要调用`delete`自己：当`ptr_vector`超出范围时，包含的对象将被销毁。例子：

```
#include <boost/ptr_vector.hpp>
#include <iostream>
class test() {
protected:
    int const i;
public:
    explicit test(int i) : i(i) {}
    virtual void who_am_i() const { std::cout << "I am test " << i << std::endl; }
};
class special_test : public test {
public:
    explicit special_test(int i) : test(i) {}
    virtual void who_am_i() const { std::cout << "I am special_test " << i << std::endl; }
};
int main() {
    boost::ptr_vector<test> objs;
    for (int i=0; i<50; ++i)
        objs.push_back(new test(i)); // NB: constructing to heap here!
    objs.push_back(new special_test(123)); // objs can also hold inherited classes
    objs[13].who_am_i(); // outputs: I am test 13
    objs[50].who_am_i(); // outputs: I am special_test 123
} // all created objects are automatically destroyed here 
```

# iis - 需要帮助在 Vista Home Basic 中使用 ASP.NET 配置 IIS

> ID：452774
> 
> 赞同：0
> 
> 时间：2009-01-17T04:07:52.747
> 
> 标签：iis

我在打开 Windows 功能时检查了以下内容：

IIS、IIS 兼容性和 WWW 下我检查了 .NET 可扩展性。我没有看到要检查的 ASP.NET 选项。这些足以让 IIS 运行还是我遗漏了什么。

当我在浏览器中输入 localhost 时，我没有看到 IIS 页面。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T04:12:21.567

您的 Vista 版本不支持 IIS 上的 ASP。您必须安装 asp 或将您的 Vista 版本升级到：

*   Windows Vista 家庭高级版
*   Windows Vista 专业版
*   Windows Vista 终极版

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T05:02:53.977

如果您正在尝试设置 Web 服务器，可以查看 Microsoft 的[Dreamspark](https://www.dreamspark.com/default.aspx)站点。

如果您是学生并且有能力证明您可以下载 Windows 2003 Server 的副本并将其用于教育目的。

# perl - '@_' 在 Perl 中有什么作用？

> ID：452775
> 
> 赞同：12
> 
> 时间：2009-01-17T04:09:53.663
> 
> 标签：perl, variables

我正在浏览我在 Perl 类中编写的一些代码，我注意到了这一点。

```
my ($string) = @_;
my @stringarray = split(//, $string); 
```

我想知道两件事：变量在括号中的第一行，这是您在声明多个变量时所做的事情，如果我删除了它们，它仍然可以正常工作吗？

第二个问题是@_ 做什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-17T04:43:12.020

该`@_`变量是一个数组，其中包含传递给子例程的所有参数。

`$string`变量周围的括号是绝对必要的。它们指定您正在从数组中分配变量。如果没有它们，`@_`数组将`$string`在标量上下文中分配，这意味着`$string`它将等于传递给子例程的参数数量。例如：

```
sub foo {
  my $bar = @_;
  print $bar;
}

foo('bar'); 
```

这里的输出是 1——在这种情况下绝对不是你所期望的。

或者，您可以不使用数组而是使用函数来分配`$string`变量：`@_``shift`

```
sub foo {
  my $bar = shift;
  print $bar;
} 
```

使用一种方法而不是另一种方法是相当有品味的问题。我问了这个问题，如果您有兴趣[，可以查看。](https://stackoverflow.com/questions/415297/is-there-a-difference-between-perls-shift-versus-assignment-from-for-subrouti "Perl 的 shift 与 @_ 子程序参数的赋值之间有区别吗？")

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-17T09:17:55.537

当您在 Perl 中遇到特殊（或标点符号）变量时，请查看[perlvar 文档](http://perldoc.perl.org/perlvar.html)。它列出了所有这些，为您提供了一个等效的[英语](http://perldoc.perl.org/English.html)，并告诉您它的作用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-17T05:29:18.823

Perl 有两种不同的上下文，标量上下文和列表上下文。数组`'@_`'，如果在标量上下文中使用，则返回数组的大小。

所以给定这两个例子，第一个给出`@_`  数组的大小，另一个给出第一个元素。

```
my  $string   = @_ ;
my ($string)  = @_ ; 
```

* * *

Perl 有三个“默认”变量`$_`、`@_`和 ，具体取决于您询问的对象`%_`。如果您不给它们一个变量来处理，许多操作将使用这些变量。唯一的例外是当前没有默认使用的操作`%_`。

例如，我们有`push`、`pop`、`shift`和`unshift`，它们都将接受一个数组作为第一个参数。如果你不给他们一个参数，他们将使用“默认”变量。所以 ' `shift;`' 和 ' `shift @_;`'一样

子例程的设计方式，您无法正式告诉编译器您想要哪些变量中的哪些值。好吧，只使用“默认”数组变量“ `@_`”来保存参数是有意义的。

所以这三个子程序（几乎）是相同的。

```
sub myjoin{
  my ( $stringl, $stringr ) = @_;
  return "$stringl$stringr";
}

sub myjoin{
  my $stringl = shift;
  my $stringr = shift;
  return "$stringl$stringr";
}

sub myjoin{
  my $stringl = shift @_;
  my $stringr = shift @_;
  return "$stringl$stringr";
} 
```

我认为第一个比其他两个稍快，因为您没有修改`@_`变量。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-17T04:14:06.213

该变量`@_`是一个数组（因此是`@`前缀），其中包含当前函数的所有参数。

# windows - 使用 Eclipse 构建 Windows SDL 项目时，如何防止控制台出现？

> ID：452778
> 
> 赞同：0
> 
> 时间：2009-01-17T04:11:23.910
> 
> 标签：windows, eclipse, console, sdl

当您运行 .exe 时，会出现 SDL 窗口，但也会出现控制台窗口。我如何单独获得 SDL 窗口？

我应该更改什么配置选项？有吗？

我正在使用 MinGW 进行编译并使用 Eclipse Ganymede。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T04:31:16.803

我不得不编译

-Wl,-子系统,windows

作为链接器标志。

嗯，回答我自己的问题。

# video - 那里有哪些视频编码和流媒体服务？

> ID：452782
> 
> 赞同：8
> 
> 时间：2009-01-17T04:13:58.630
> 
> 标签：video, video-streaming, audio-streaming, video-encoding

我正在寻找可以直接嵌入他们的上传器或将视频文件发送到的东西，然后将对视频进行编码并允许我通过“我的”网站上的播放器流式传输视频。

到目前为止，我发现的服务是：

*   [运行中的位](http://www.bitsontherun.com/)
*   [明亮湾](http://www.brightcove.com/)
*   [视频流媒体服务](http://www.videostreamingservices.com/)

该服务不能像 YouTube 那样，视频也会发布在他们的网站上。

还有其他的吗？有没有人有上述任何一种经验？

如果该服务还可以对音频进行编码并通过 Flash 视频进行流式传输，那也将很酷。

**编辑：**从回复的数量来看，这似乎不是一个很常见的任务，尽管你现在访问的大多数网站都有视频。其中很多是 YouTube，但也有不少网站也不使用 YouTube。这些其他网站有什么用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T04:39:56.240

[www.blip.tv](http://www.blip.tv)允许您在页面上嵌入视频。您还可以将它们设为“私有”，这意味着没有人可以在瞬间看到它们，因此必须访问您的站点才能查看它们。Blip 还允许您标记自己的播放器，这比在视频上添加 YOUTUBE 或其他名称的水印更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T02:33:11.923

看看[熊猫](http://pandastream.com/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T20:16:55.047

[www.ooyala.com](http://www.ooyala.com)值得考虑作为另一种选择（我在 Ooyala 视频播放器团队工作，所以我有偏见）。如果您更喜欢使用我们的 UI，我们有很好的 api 用于上传和管理您的内容，以及我们自己的基于 flash 的内容管理系统。我们还可以使用纯 Flash（无插件）进行真正高质量的自适应比特率播放，并让您对谁可以看到/嵌入视频进行强有力的控制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-28T06:06:57.167

注意：某些服务可能允许您使用自己的 CDN。

例如，LongTailVideo 的“ [Bits On the Run](http://www.longtailvideo.com/bits-on-the-run/) ”让您可以根据需要使用亚马逊的 Cloudfront。带宽费用要便宜得多。因此，您无需花费专有 CDN 即可获得编码等优势。

> 我注意到你提到了 Bits on the Run。我们也知道使用 AWS 流媒体的好处，这就是为什么现在很容易在 Run 帐户上设置 Bits 以使用 AWS 而不是我们的 CDN 解决方案。您只需在注册页面上选择“通过您的 AWS 账户流式传输视频”并输入您的 AWS 密钥和密码即可。这样您仍然可以获得 BotR 解决方案为您带来的好处（使用许可播放器、为您创建嵌入代码并处理所有繁重工作的集成系统、自动比特率切换）。如果您使用 AWS 作为您的 CDN，您不会因 Bits on the Run 产生任何流量费用，您只需为我们帮助您管理的 GB 量（原始文件的总文件大小 + 转码视频）付费。

我不为 LongTail 工作——但写这篇文章的人显然可以。不过我确实很喜欢他们的 JWPlayer。

[http://www.miracletutorials.com/s3-streaming-video-with-cloudfront/](http://www.miracletutorials.com/s3-streaming-video-with-cloudfront/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-31T07:29:28.490

另一种可能比 Panda 设置起来更简单的服务：[http ://heywatch.com](http://heywatch.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-07T14:33:12.810

几年前，我参与了一个 Lucozade 活动的项目“Lost your Edge”，我们使用 VideoEgg 来实现媒体托管和转码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-04T11:33:24.743

看看[Ankoder](http://www.ankoder.com/)。这是一种随用随付的编码 API 平台，托管在 Amazon EC2 服务器上。您可以在那里找到完整的文档和代码示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-26T15:35:55.340

我们最近还发布了 Panda 的托管版本，这使得设置变得更加容易： http: [//pandastream.com/](http://pandastream.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-26T23:12:15.043

这是数字资产管理的一个相当常见的过程，它处理内容的编码和分发。有许多托管服务对该服务收费。我没有直接与这些公司合作（我们在编写自己的系统之前确实评估了一些），但它们似乎满足您的需求：

*   综合（我认为 ITX 是他们现成的组件，但我记得他们也提供了基于云的系统）
*   该平台

使用的搜索词包括：资产管理、数字资产管理和内容管理系统；但是有很多噪音，因为你会发现从金钱投资到网络内容管理系统的一切。

# visual-studio-2005 - 注册办公室 2007 PIA

> ID：452785
> 
> 赞同：1
> 
> 时间：2009-01-17T04:14:54.760
> 
> 标签：visual-studio-2005, interop, ms-office

我已经安装了 2007 PIA 并修复了我的 Office 2007 安装。

尽管如此，当我在 VS2005 中添加对 Office 12 对象库的引用时，我只看到 Office.Core 并且无法为 Office.Interop 添加“导入”语句

我检查了 Windows\assembly\gac\ 有互操作 dll。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T08:21:11.517

安装 PIA 后，您必须添加对相应 COM 库的引用——而不是生成自动互操作，而是使用 PIA。

引用[微软的文档](http://msdn.microsoft.com/en-us/library/15s06t57(VS.80).aspx)

> 对于在 Visual Studio Tools for Office 中没有项目的 Microsoft Office 应用程序，您必须手动将对相应应用程序或组件的引用添加到您的项目中。如果程序集安装在全局程序集缓存中，则添加对组件的引用会引用主互操作程序集。可以从“添加引用”对话框的 COM 选项卡访问 Office 应用程序和组件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-17T04:32:50.090

添加浏览参考。无论如何，您必须发送 PIA dll 才能从中获得任何好处。

# .net - 使用 Microsoft .NET 框架编写的程序是否编译/执行本机代码？

> ID：452788
> 
> 赞同：7
> 
> 时间：2009-01-17T04:17:19.467
> 
> 标签：.net, native

新手问题：

使用 Microsoft .NET 框架编写的程序是否编译/执行本机代码？

我并不是说是否有办法不必在机器上安装 .net 框架。简单地说：.net 应用程序是否运行在像 Java（即字节码）这样的另一层上。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-17T04:25:09.060

.NET 应用程序必须在[公共语言运行时](http://en.wikipedia.org/wiki/Common_Language_Runtime)(CLR) 上运行。

CLR 是 Microsoft 对[CLI](http://en.wikipedia.org/wiki/Common_Language_Infrastructure)标准的实现。（除了 Microsoft .NET Framework 之外，还有其他 CLR 实现，例如：[Mono](http://www.mono-project.com/Main_Page)、[Portable.NET](http://www.gnu.org/software/dotgnu/)）。

CLR 执行一种称为通用中间语言 ( [CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language) ) 的字节码。

![CIL](https://upload.wikimedia.org/wikipedia/commons/6/6a/Overview_of_the_Common_Language_Infrastructure.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T04:54:33.043

有点。.NET 编译器将您的源代码编译成 IL（一种中间语言）并将其打包到您部署的程序集（通常是一个 .DLL 或 .EXE 文件）中。在运行时，它由负责执行代码、执行安全规则等的 CLR（公共语言运行时）托管。适用于 Windows 的主桌面 CLR（还有其他类似 Mono 和 Silverlight）不解释 IL，而是在执行方法（函数）之前将 IL 代码“JIT”（只是及时编译）本机代码。

[请注意，即时编译](http://en.wikipedia.org/wiki/Just-in-time_compilation)实际上有一些性能优势。例如，CLR 可以根据它所运行的机器的性能特征（如 CPU 类型、CPU 缓存大小、CPU 数量、RAM 大小等）优化它生成的本机代码。传统编译器无法做到这一点，因为它们不知道他们生成的代码最终会在哪台机器上执行。

此外，可以使用名为 ngen 的工具“预 JITted”程序[集](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)。在这个过程中，在程序集被执行并缓存在磁盘上之前，本地代码是从 IL 编译的。这样，在运行时不会产生 JITting 开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T04:22:53.043

简短回答（对你的第二个问题）：是的。它被称为公共语言运行时 (CLR)。

该框架的简要概述可在 Wikipedia 上找到： [http ://en.wikipedia.org/wiki/.NET_Framework#Architecture](http://en.wikipedia.org/wiki/.NET_Framework#Architecture)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T04:24:42.010

当你编译一个 .NET 程序时，它会被编译成 IL（中间语言）。IL 与汇编语言非常相似。然后，该 IL 在运行时通过 JIT（即时）编译器转换为本机代码。

所以，回答你的问题，是和不是。编译器不发出本机代码，而是在运行应用程序时转换为本机代码的 IL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T04:32:59.823

好吧，至少对于单声道，我知道您可以生成本机代码而不是托管程序集。我认为有适用于 Windows 的开源工具也可以做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T04:34:15.407

我认为您必须小心询问它是否“已编译”并假设这意味着发出的结果必须是“本机代码”。这不是“编译”的意思：

*“当最初的翻译者很简单时，我们通常说一种语言是‘解释的’。如果翻译者很复杂，我们就说这种语言是‘编译的’。这种区别可能会造成混淆，因为‘简单’和‘复杂’是主观术语，并且因为编译器可以生成代码，然后由复杂的虚拟机（解释器）执行......这两个特征 - 彻底的分析和非平凡的转换 - 是编译的标志。”*

来自Michael L. Scott 的*“Programming Language Pragmatics” 。*奇怪的是，这是一本关于编程语言理论的教科书，我今天下午刚好在读到这本书的那一页。

所以，是的，C# 和其他 .NET 语言在 CLR 上运行*并被*编译。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T05:10:03.290

C++ 是一种不必编译成 IL 的 .Net 语言，但如果您选择此选项，则不能从 .Net 获得任何 .NET 引用或代码。

要研究的另一件事是c dragon 指出的-ngen.exe，它可以对许多基于.Net windows/console 的应用程序进行一些显着的改进。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T09:47:48.997

在执行时，编译器生成中间语言代码 IL 代码，然后由 JIT 编译器将代码转换为本地代码

# java - Ant中的字符串更改

> ID：452790
> 
> 赞同：2
> 
> 时间：2009-01-17T04:18:57.717
> 
> 标签：java, ant

给定一个属性：

```
<property name="classes" value="com.package.Class1,com.package.Class2" /> 
```

我正在尝试仅编译指定的类，例如：

```
<javac srcdir="${src.dir}" destdir="${build.dir}">
    <include name="${classes}" />
</javac> 
```

但是，“包含”标签指定要包含的文件名，而不是限定的类名。

有没有一种方法可以创建一个新的属性/包含标记，该标记具有正确格式的“类”中的所有类？IE。

```
"com.package.Class1" -> "com\\package\\Class1.java" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T04:55:47.393

我想到了。在 ant-contrib 之后，我可以执行以下操作之一：

```
<propertyregex property="classes.resolved"
        input="${classes}"
        regexp="\."
        replace="\\\\" /> 
```

# c# - 从泛型方法返回空值

> ID：452794
> 
> 赞同：5
> 
> 时间：2009-01-17T04:30:42.810
> 
> 标签：c#, .net, generics

所以我有这个方法：

```
 internal K GetValue<T, K>(T source, string col) where T : IBaseObject
    {
        string table = GetObjectTableName(source.GetType());
        DataTable dt = _mbx.Tables[table];
        DataRow[] rows = dt.Select("ID = " + source.ID);
        if (rows.Length == 0) return K;

        return (K) rows[0][col];
    } 
```

如果没有找到行，我希望能够返回 null 或某种空值。这样做的正确语法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T04:36:39.757

您可以返回 default(K)，这意味着如果 K 是引用类型，您将返回 null，或者返回 0 表示 int，'\0' 表示 char，依此类推......

然后您可以轻松验证是否返回：

```
if (object.Equals(resultValue, default(K)))
{
    //...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T04:38:37.177

您必须对 K 类型参数使用类泛型约束（因为类 - 与结构相反 - 可以为空）

```
internal K GetValue<T, K>(T source, string col)
        where K : class
        where T : IBaseObject
{
    // ...
    return null;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T04:37:19.863

你可以`return default(K)`。

# opengl - OpenGL中的多个窗口？

> ID：452806
> 
> 赞同：9
> 
> 时间：2009-01-17T04:41:15.987
> 
> 标签：opengl, multi-window

是否可以在 2 个窗口中使用 openGL？如在 2 个不同的窗口中（假设第一个是 640x480，另一个是 1024x768）呈现不同的东西（假设一个窗口是编辑器，另一个是主/普通窗口显示）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T05:01:00.797

如果您使用 GLUT，您可以使用 glutSetWindow() / glutGetWindow() 调用来选择正确的窗口（在使用 glutCreateSubWindow() 创建它们之后）。然而，有时 GLUT 可能不是适合这项工作的工具。

如果您在 Windows 上工作，您需要查看 wglMakeCurrent() 和 wglCreateContext()。在 OS X 上有 aglSetCurrentContext() 等等，而 X11 需要 glXMakeCurrent()。

这些函数激活您可以渲染到的当前 OpenGL 上下文。每个平台特定的库都有自己的方法来创建窗口并将 OpenGL 上下文绑定到它。

在 Windows 上，在为窗口获取 HWND 和 HDC 之后（在 CreateWindow 和 GetDC 调用之后）。您通常会执行以下操作来设置 OpenGL：

```
GLuint l_PixelFormat = 0;

// some pixel format descriptor that I generally use:
static PIXELFORMATDESCRIPTOR l_Pfd = { sizeof(PIXELFORMATDESCRIPTOR), 1, 
    PFD_DRAW_TO_WINDOW + PFD_SUPPORT_OPENGL + PFD_DOUBLEBUFFER, 
    PFD_TYPE_RGBA, m_BitsPerPixel, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 16, 0, 0, PFD_MAIN_PLANE, 0, 0, 0, 0};

if(!(l_PixelFormat = ChoosePixelFormat(m_hDC, &l_Pfd))){
    throw std::runtime_error("No matching pixel format descriptor");
}

if(!SetPixelFormat(m_hDC, l_PixelFormat, &l_Pfd)){
    throw std::runtime_error("Can't set the pixel format");
}

if(!(m_hRC = wglCreateContext(m_hDC))){
    throw std::runtime_error("Can't create rendering context");
}

wglMakeCurrent(m_hDC, m_hRC); 
```

您使用该代码创建多个窗口并将 OpenGL 绑定到它，然后每次要绘制到特定窗口时，您必须在执行任何操作*之前*调用 wglMakeCurrent并传入与该窗口对应的参数。

附带说明一下，OpenGL 允许您在不同的上下文之间共享某些数据，但是根据规范，您可以共享的数据非常有限。但是，大多数操作系统允许您共享比规范中指定的更多的数据。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-17T05:03:11.603

是的，这是可能的。对于每个窗口，您都需要创建一个唯一的设备上下文和渲染上下文。

```
HDC hDC = GetDC( hWnd ); /* get the device context for a particular window */
/* snip */
HGLRC hRC;
hRC = wglCreateContext( hDC ); /* get a render context for the same window */
/* repeat with hDC2 and hRC2 with another window handle*/ 
```

在对窗口进行 GL 调用之前，您必须像这样调用 wglMakeCurrent：

```
wglMakeCurrent( hDC, hRC );
/* GL calls for first window */
wglMakeCurrent( NULL, NULL);

wglMakeCurrent( hDC2, hRC2 );
/* GL calls for second window */
wglMakeCurrent( NULL, NULL); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T12:07:22.170

[在 Windows 上，您可以使用wglShareLists()](http://msdn.microsoft.com/en-us/library/ms537565(VS.85).aspx)共享 OpenGL 对象，例如纹理和着色器。尽管 MSDN 说了什么，但它通常会共享您关心的所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-16T21:06:14.230

我之前在 MFC 应用程序中完成了多个 OpenGL 窗口。这是一个您可能会发现有用的类：由于 UI 线程中一次只能有一个当前渲染上下文，因此我编写了一个类包装器以使其更易于管理。

保存恢复RC.h

`// this class helps to manage multiple RCs using an RAII design pattern`

 ````
class CSaveRestoreRC
{
public:
HDC   oldDC;            
HGLRC oldRC;            

CSaveRestoreRC(HDC hDC, HGLRC hRC);
~CSaveRestoreRC(void);
}; 
```` 

`保存RestoreRC.cpp：`

 ``````
CSaveRestoreRC::CSaveRestoreRC(HDC hDC, HGLRC hRC)
{
ASSERT( hDC );
ASSERT( hRC );

oldDC = wglGetCurrentDC();
oldRC = wglGetCurrentContext();

BOOL result = wglMakeCurrent( hDC, hRC );
ASSERT( result );
}

CSaveRestoreRC::~CSaveRestoreRC(void)
{
if( !oldRC )
    return;
ASSERT( oldDC );
BOOL result = wglMakeCurrent( oldDC, oldRC );
ASSERT( result );    
} 
````  `现在从 CWnd 派生一个类并添加这些成员变量：

 `````
class COpenGLControl : public CWnd
{
    // used to interface OpenGL with Windows
    HDC   hdc;          
    HGLRC hrc;          
// ...

int COpenGLControl::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
if (CWnd::OnCreate(lpCreateStruct) == -1)
    return -1;
// Get device context only once.
hdc = GetDC()->m_hDC;

// ... ChoosePixelFormat, SetPixelFormat, etc. here.

// Create the OpenGL Rendering Context.
hrc = wglCreateContext(hdc);
ASSERT( hrc ); 
````  `然后在您调用任何 OpenGL 命令的每个成员函数中，使用 CSaveRestoreRC 以便您当前的渲染上下文不会搞砸。

 `````
void COpenGLControl::UpdateCamera()
{
CSaveRestoreRC c(hdc, hrc);

// Map the OpenGL device coordinates.
glViewport(0, 0, renderingWindow.Width(), renderingWindow.Height());

// Do your other OpenGL stuff here
// ... 

// the CSaveRestoreRC destructor will automatically put the correct render context back, 
// even if you call other functions. Of course, put another CSaveRestoreRC there too.
} 
````  `* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-03-10T20:27:18.623

如果您只喜欢使用 glut 库，请查看[Eric Stringer 的代码](https://www.opengl.org/discussion_boards/showthread.php/140695-Multiple-windows-with-GLUT-tutor)。

```
// Glutdualwindow.c
// By Eric Stringer 2002
// Simple examples of OpenGL and Glut usage.
// Keyboard input
// 'v' = view ortho/perspective
// 'l' = lighting on/off

#include <windows.h>  // This header file will be needed for some windows compilers
//#include <GL/gl.h>   // gl.h and glu.h also maybe needed for some compilers
//#include <GL/glu.h>
#include <GL/glut.h>  // glut (gl utility toolkit) basic windows functions, keyboard, mouse.
#include <stdio.h>    // standard (I/O library)
#include <stdlib.h>   // standard library (set of standard C functions
#include <math.h>     // Math library (Higher math functions )

// lighting
GLfloat LightAmbient[]= { 0.2f, 0.2f, 0.2f, 1.0f };
GLfloat LightDiffuse[]= { 0.5f, 0.5f, 0.5f, 1.0f };
GLfloat LightPosition[]= { 5.0f, 5.0f, -10.0f, 1.0f };
GLfloat mat_specular[] = { 0.2, 0.2, 0.2, 1.0 };

int window_1, window_2;

static int view_state = 0, light_state = 0;

int spin;

int shape;

// I use this to put text on the screen
void Sprint( int x, int y, char *st)
{
    int l,i;

    l=strlen( st ); // see how many characters are in text string.
    glRasterPos2i( x, y); // location to start printing text
    for( i=0; i < l; i++)  // loop until i is greater then l
        {
        glutBitmapCharacter(GLUT_BITMAP_TIMES_ROMAN_24, st[i]); // Print a character on the screen
    }

}

// This creates the spinning of the cube.
static void TimeEvent(int te)
{

    spin++;  // increase cube rotation by 1
    if (spin > 360) spin = 0; // if over 360 degress, start back at zero.

    glutSetWindow( window_1 );
    glutPostRedisplay();  // Update screen with new rotation data

    glutSetWindow( window_2 );
    glutPostRedisplay();  // Update screen with new rotation data

    glutTimerFunc( 100, TimeEvent, 1);  // Reset our timmer.
}

// Setup our Opengl world, called once at startup.
void init(void)
{

   glClearColor (0.0, 0.0, 0.0, 0.0);  // When screen cleared, use black.
   glShadeModel (GL_SMOOTH);  // How the object color will be rendered smooth or flat
   glEnable(GL_DEPTH_TEST);   // Check depth when rendering
   // Lighting is added to scene
   glLightfv(GL_LIGHT1 ,GL_AMBIENT, LightAmbient);
   glLightfv(GL_LIGHT1 ,GL_DIFFUSE, LightDiffuse);
   glLightfv(GL_LIGHT1 ,GL_POSITION, LightPosition);
   glEnable(GL_LIGHTING);  // Turn on lighting
   glEnable(GL_LIGHT1);    // Turn on light 1

}

// Draw our world
void display_1(void)
{
char *p;

glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);  //Clear the screen

glMatrixMode (GL_PROJECTION);  // Tell opengl that we are doing project matrix work
glLoadIdentity();  // Clear the matrix
glOrtho(-8.0, 8.0, -8.0, 8.0, 0.0, 30.0);  // Setup an Ortho view
glMatrixMode(GL_MODELVIEW);  // Tell opengl that we are doing model matrix work. (drawing)
glLoadIdentity(); // Clear the model matrix

glColor3f(1.0, 1.0, 1.0);
if (shape == 0) Sprint(-3, -7 ,"Solid Cube");
if (shape == 1) Sprint(-3, -7 ,"Solid Cone");
if (shape == 2) Sprint(-3, -7 ,"Solid Sphere");
if (shape == 3) Sprint(-3, -7 ,"Solid Torus");
if (shape == 4) Sprint(-3, -7 ,"Solid Dodecahedron");
if (shape == 5) Sprint(-3, -7 ,"Solid Octahedron");
if (shape == 6) Sprint(-3, -7 ,"Solid Tetrahedron");
if (shape == 7) Sprint(-3, -7 ,"Solid Icosahedron");
if (shape == 8) Sprint(-3, -7 ,"Solid Teapot");

// Setup view, and print view state on screen
if (view_state == 1)
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Perspective view");
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60, 1, 1, 30);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    }else
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Ortho view");
    }

glColor3f( 0.0, 0.0, 1.0);  // Cube color

// Lighting on/off
if (light_state == 1)
    {
    glDisable(GL_LIGHTING);  // Turn off lighting
    glDisable(GL_COLOR_MATERIAL); // Turn off material, which needs lighting to work
    }else
    {
    glEnable(GL_LIGHTING); // Turn on lighting
    glEnable(GL_COLOR_MATERIAL); // Turn on material settings
    glColorMaterial(GL_FRONT, GL_AMBIENT);
    glColor4f(0.65, 0.65, 0.65, 0.4);
    glColorMaterial(GL_FRONT, GL_EMISSION);
    glColor4f(0.10, 0.10, 0.10, 0.0);
    glColorMaterial(GL_FRONT, GL_SPECULAR);
    glColor4f(0.5, 0.5, 0.5, 0.4);
    glColorMaterial(GL_FRONT, GL_DIFFUSE);
    glColor4f(0.85, 0.85, 0.85, 0.4);
    }

gluLookAt( 0, 0, 20, 0, 0, 0, 0, 1, 0);

//glRotatef( 45, 1.0, 1.0, 0.0); // rotate cube
glRotatef( spin++, 1.0, 1.0, 1.0); // spin cube

if (shape == 0) glutSolidCube(10); // Draw a cube
if (shape == 1) glutSolidCone(5,10, 16,16);  // Draw a Cone
if (shape == 2) glutSolidSphere(5, 16,16 );  // Draw a Sphere
if (shape == 3) glutSolidTorus( 2.5, 5, 16, 16);
if (shape == 4)
   {
    glScalef( 3.5, 3.5, 3.5);
    glutSolidDodecahedron();
   }

if (shape == 5)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidOctahedron();
   }
if (shape == 6)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidTetrahedron();
   }

if (shape == 7)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidIcosahedron();
   }
if (shape == 8) glutSolidTeapot( 5 );

glutSwapBuffers();
}

void display_2(void)
{
char *p;

glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);  //Clear the screen

glMatrixMode (GL_PROJECTION);  // Tell opengl that we are doing project matrix work
glLoadIdentity();  // Clear the matrix
glOrtho(-8.0, 8.0, -8.0, 8.0, 0.0, 30.0);  // Setup an Ortho view
glMatrixMode(GL_MODELVIEW);  // Tell opengl that we are doing model matrix work. (drawing)
glLoadIdentity(); // Clear the model matrix

glColor3f(1.0, 1.0, 1.0);
if (shape == 0) Sprint(-3, -7 ,"Wire Cube");
if (shape == 1) Sprint(-3, -7 ,"Wire Cone");
if (shape == 2) Sprint(-3, -7 ,"Wire Sphere");
if (shape == 3) Sprint(-3, -7 ,"Wire Torus");
if (shape == 4) Sprint(-3, -7 ,"Wire Dodecahedron");
if (shape == 5) Sprint(-3, -7 ,"Wire Octahedron");
if (shape == 6) Sprint(-3, -7 ,"Wire Tetrahedron");
if (shape == 7) Sprint(-3, -7 ,"Wire Icosahedron");
if (shape == 8) Sprint(-3, -7 ,"Wire Teapot");

// Setup view, and print view state on screen
if (view_state == 1)
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Perspective view");
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60, 1, 1, 30);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    }else
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Ortho view");
    }

glColor3f( 0.0, 0.0, 1.0);  // Cube color

// Lighting on/off
if (light_state == 1)
    {
    glDisable(GL_LIGHTING);  // Turn off lighting
    glDisable(GL_COLOR_MATERIAL); // Turn off material, which needs lighting to work
    }else
    {
    glEnable(GL_LIGHTING); // Turn on lighting
    glEnable(GL_COLOR_MATERIAL); // Turn on material settings
    glColorMaterial(GL_FRONT, GL_AMBIENT);
    glColor4f(0.65, 0.65, 0.65, 0.4);
    glColorMaterial(GL_FRONT, GL_EMISSION);
    glColor4f(0.10, 0.10, 0.10, 0.0);
    glColorMaterial(GL_FRONT, GL_SPECULAR);
    glColor4f(0.5, 0.5, 0.5, 0.4);
    glColorMaterial(GL_FRONT, GL_DIFFUSE);
    glColor4f(0.85, 0.85, 0.85, 0.4);
    }

gluLookAt( 0, 0, 20, 0, 0, 0, 0, 1, 0);

//glRotatef( 45, 1.0, 1.0, 0.0); // rotate cube
glRotatef( spin++, 1.0, 1.0, 1.0); // spin cube

if (shape == 0) glutWireCube(10); // Draw a cube
if (shape == 1) glutWireCone(5,10, 16,16);  // Draw a Cone
if (shape == 2) glutWireSphere(5, 16,16 );  // Draw a Sphere
if (shape == 3) glutWireTorus( 2.5, 5, 16, 16);
if (shape == 4)
   {
    glScalef( 3.5, 3.5, 3.5);
    glutSolidDodecahedron();
   }

if (shape == 5)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireOctahedron();
   }
if (shape == 6)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireTetrahedron();
   }

if (shape == 7)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireIcosahedron();
   }
if (shape == 8) glutWireTeapot( 5 );

glutSwapBuffers();
}

// This is called when the window has been resized.
void reshape_1 (int w, int h)
{
   glViewport (0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode (GL_PROJECTION);
   glLoadIdentity ();
}

// This is called when the window has been resized.
void reshape_2 (int w, int h)
{
   glViewport (0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode (GL_PROJECTION);
   glLoadIdentity ();
}

// Read the keyboard
void keyboard (unsigned char key, int x, int y)
{
   switch (key)
   {

      case 'v':
      case 'V':
          view_state = abs(view_state -1);
          break;
      case 'l':
      case 'L':
          light_state = abs(light_state -1);
          break;
      case 's':
      case 'S':
          shape++;
          break;
      case 27:
         exit(0); // exit program when [ESC] key presseed
         break;
      default:
         break;
   }

if (shape > 8) shape = 0;

}

// Main program
int main(int argc, char** argv)
{
   glutInit(&amp;argc, argv);
   glutInitDisplayMode (GLUT_DOUBLE | GLUT_RGB);
   glutInitWindowSize (500, 500);
   glutInitWindowPosition (10, 10);
   glutTimerFunc( 10, TimeEvent, 1);
   window_1 = glutCreateWindow (argv[0]);
   glutSetWindowTitle("GlutWindow 1");
   init ();
   glutDisplayFunc(display_1);
   glutReshapeFunc(reshape_1);
   glutKeyboardFunc(keyboard);

   window_2 = glutCreateWindow (argv[0]);
   glutSetWindowTitle("GlutWindow 2");
   init ();
   glutDisplayFunc(display_2);
   glutReshapeFunc(reshape_2);
   glutMainLoop();
   return 0;
}

// Glutdualwindow.c
// By Eric Stringer 2002
// Simple examples of OpenGL and Glut usage.
// Keyboard input
// 'v' = view ortho/perspective
// 'l' = lighting on/off

#include <windows.h>  // This header file will be needed for some windows compilers
//#include <GL/gl.h>   // gl.h and glu.h also maybe needed for some compilers
//#include <GL/glu.h>
#include <GL/glut.h>  // glut (gl utility toolkit) basic windows functions, keyboard, mouse.
#include <stdio.h>    // standard (I/O library)
#include <stdlib.h>   // standard library (set of standard C functions
#include <math.h>     // Math library (Higher math functions )

// lighting
GLfloat LightAmbient[]= { 0.2f, 0.2f, 0.2f, 1.0f };
GLfloat LightDiffuse[]= { 0.5f, 0.5f, 0.5f, 1.0f };
GLfloat LightPosition[]= { 5.0f, 5.0f, -10.0f, 1.0f };
GLfloat mat_specular[] = { 0.2, 0.2, 0.2, 1.0 };

int window_1, window_2;

static int view_state = 0, light_state = 0;

int spin;

int shape;

// I use this to put text on the screen
void Sprint( int x, int y, char *st)
{
    int l,i;

    l=strlen( st ); // see how many characters are in text string.
    glRasterPos2i( x, y); // location to start printing text
    for( i=0; i < l; i++)  // loop until i is greater then l
        {
        glutBitmapCharacter(GLUT_BITMAP_TIMES_ROMAN_24, st[i]); // Print a character on the screen
    }

}

// This creates the spinning of the cube.
static void TimeEvent(int te)
{

    spin++;  // increase cube rotation by 1
    if (spin > 360) spin = 0; // if over 360 degress, start back at zero.

    glutSetWindow( window_1 );
    glutPostRedisplay();  // Update screen with new rotation data

    glutSetWindow( window_2 );
    glutPostRedisplay();  // Update screen with new rotation data

    glutTimerFunc( 100, TimeEvent, 1);  // Reset our timmer.
}

// Setup our Opengl world, called once at startup.
void init(void)
{

   glClearColor (0.0, 0.0, 0.0, 0.0);  // When screen cleared, use black.
   glShadeModel (GL_SMOOTH);  // How the object color will be rendered smooth or flat
   glEnable(GL_DEPTH_TEST);   // Check depth when rendering
   // Lighting is added to scene
   glLightfv(GL_LIGHT1 ,GL_AMBIENT, LightAmbient);
   glLightfv(GL_LIGHT1 ,GL_DIFFUSE, LightDiffuse);
   glLightfv(GL_LIGHT1 ,GL_POSITION, LightPosition);
   glEnable(GL_LIGHTING);  // Turn on lighting
   glEnable(GL_LIGHT1);    // Turn on light 1

}

// Draw our world
void display_1(void)
{
char *p;

glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);  //Clear the screen

glMatrixMode (GL_PROJECTION);  // Tell opengl that we are doing project matrix work
glLoadIdentity();  // Clear the matrix
glOrtho(-8.0, 8.0, -8.0, 8.0, 0.0, 30.0);  // Setup an Ortho view
glMatrixMode(GL_MODELVIEW);  // Tell opengl that we are doing model matrix work. (drawing)
glLoadIdentity(); // Clear the model matrix

glColor3f(1.0, 1.0, 1.0);
if (shape == 0) Sprint(-3, -7 ,"Solid Cube");
if (shape == 1) Sprint(-3, -7 ,"Solid Cone");
if (shape == 2) Sprint(-3, -7 ,"Solid Sphere");
if (shape == 3) Sprint(-3, -7 ,"Solid Torus");
if (shape == 4) Sprint(-3, -7 ,"Solid Dodecahedron");
if (shape == 5) Sprint(-3, -7 ,"Solid Octahedron");
if (shape == 6) Sprint(-3, -7 ,"Solid Tetrahedron");
if (shape == 7) Sprint(-3, -7 ,"Solid Icosahedron");
if (shape == 8) Sprint(-3, -7 ,"Solid Teapot");

// Setup view, and print view state on screen
if (view_state == 1)
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Perspective view");
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60, 1, 1, 30);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    }else
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Ortho view");
    }

glColor3f( 0.0, 0.0, 1.0);  // Cube color

// Lighting on/off
if (light_state == 1)
    {
    glDisable(GL_LIGHTING);  // Turn off lighting
    glDisable(GL_COLOR_MATERIAL); // Turn off material, which needs lighting to work
    }else
    {
    glEnable(GL_LIGHTING); // Turn on lighting
    glEnable(GL_COLOR_MATERIAL); // Turn on material settings
    glColorMaterial(GL_FRONT, GL_AMBIENT);
    glColor4f(0.65, 0.65, 0.65, 0.4);
    glColorMaterial(GL_FRONT, GL_EMISSION);
    glColor4f(0.10, 0.10, 0.10, 0.0);
    glColorMaterial(GL_FRONT, GL_SPECULAR);
    glColor4f(0.5, 0.5, 0.5, 0.4);
    glColorMaterial(GL_FRONT, GL_DIFFUSE);
    glColor4f(0.85, 0.85, 0.85, 0.4);
    }

gluLookAt( 0, 0, 20, 0, 0, 0, 0, 1, 0);

//glRotatef( 45, 1.0, 1.0, 0.0); // rotate cube
glRotatef( spin++, 1.0, 1.0, 1.0); // spin cube

if (shape == 0) glutSolidCube(10); // Draw a cube
if (shape == 1) glutSolidCone(5,10, 16,16);  // Draw a Cone
if (shape == 2) glutSolidSphere(5, 16,16 );  // Draw a Sphere
if (shape == 3) glutSolidTorus( 2.5, 5, 16, 16);
if (shape == 4)
   {
    glScalef( 3.5, 3.5, 3.5);
    glutSolidDodecahedron();
   }

if (shape == 5)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidOctahedron();
   }
if (shape == 6)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidTetrahedron();
   }

if (shape == 7)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutSolidIcosahedron();
   }
if (shape == 8) glutSolidTeapot( 5 );

glutSwapBuffers();
}

void display_2(void)
{
char *p;

glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);  //Clear the screen

glMatrixMode (GL_PROJECTION);  // Tell opengl that we are doing project matrix work
glLoadIdentity();  // Clear the matrix
glOrtho(-8.0, 8.0, -8.0, 8.0, 0.0, 30.0);  // Setup an Ortho view
glMatrixMode(GL_MODELVIEW);  // Tell opengl that we are doing model matrix work. (drawing)
glLoadIdentity(); // Clear the model matrix

glColor3f(1.0, 1.0, 1.0);
if (shape == 0) Sprint(-3, -7 ,"Wire Cube");
if (shape == 1) Sprint(-3, -7 ,"Wire Cone");
if (shape == 2) Sprint(-3, -7 ,"Wire Sphere");
if (shape == 3) Sprint(-3, -7 ,"Wire Torus");
if (shape == 4) Sprint(-3, -7 ,"Wire Dodecahedron");
if (shape == 5) Sprint(-3, -7 ,"Wire Octahedron");
if (shape == 6) Sprint(-3, -7 ,"Wire Tetrahedron");
if (shape == 7) Sprint(-3, -7 ,"Wire Icosahedron");
if (shape == 8) Sprint(-3, -7 ,"Wire Teapot");

// Setup view, and print view state on screen
if (view_state == 1)
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Perspective view");
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60, 1, 1, 30);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    }else
    {
    glColor3f( 1.0, 1.0, 1.0);
    Sprint(-2, 4, "Ortho view");
    }

glColor3f( 0.0, 0.0, 1.0);  // Cube color

// Lighting on/off
if (light_state == 1)
    {
    glDisable(GL_LIGHTING);  // Turn off lighting
    glDisable(GL_COLOR_MATERIAL); // Turn off material, which needs lighting to work
    }else
    {
    glEnable(GL_LIGHTING); // Turn on lighting
    glEnable(GL_COLOR_MATERIAL); // Turn on material settings
    glColorMaterial(GL_FRONT, GL_AMBIENT);
    glColor4f(0.65, 0.65, 0.65, 0.4);
    glColorMaterial(GL_FRONT, GL_EMISSION);
    glColor4f(0.10, 0.10, 0.10, 0.0);
    glColorMaterial(GL_FRONT, GL_SPECULAR);
    glColor4f(0.5, 0.5, 0.5, 0.4);
    glColorMaterial(GL_FRONT, GL_DIFFUSE);
    glColor4f(0.85, 0.85, 0.85, 0.4);
    }

gluLookAt( 0, 0, 20, 0, 0, 0, 0, 1, 0);

//glRotatef( 45, 1.0, 1.0, 0.0); // rotate cube
glRotatef( spin++, 1.0, 1.0, 1.0); // spin cube

if (shape == 0) glutWireCube(10); // Draw a cube
if (shape == 1) glutWireCone(5,10, 16,16);  // Draw a Cone
if (shape == 2) glutWireSphere(5, 16,16 );  // Draw a Sphere
if (shape == 3) glutWireTorus( 2.5, 5, 16, 16);
if (shape == 4)
   {
    glScalef( 3.5, 3.5, 3.5);
    glutSolidDodecahedron();
   }

if (shape == 5)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireOctahedron();
   }
if (shape == 6)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireTetrahedron();
   }

if (shape == 7)
   {
    glScalef( 5.0, 5.0, 5.0);
    glutWireIcosahedron();
   }
if (shape == 8) glutWireTeapot( 5 );

glutSwapBuffers();
}

// This is called when the window has been resized.
void reshape_1 (int w, int h)
{
   glViewport (0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode (GL_PROJECTION);
   glLoadIdentity ();
}

// This is called when the window has been resized.
void reshape_2 (int w, int h)
{
   glViewport (0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode (GL_PROJECTION);
   glLoadIdentity ();
}

// Read the keyboard
void keyboard (unsigned char key, int x, int y)
{
   switch (key)
   {

      case 'v':
      case 'V':
          view_state = abs(view_state -1);
          break;
      case 'l':
      case 'L':
          light_state = abs(light_state -1);
          break;
      case 's':
      case 'S':
          shape++;
          break;
      case 27:
         exit(0); // exit program when [ESC] key presseed
         break;
      default:
         break;
   }

if (shape > 8) shape = 0;

}

// Main program
int main(int argc, char** argv)
{
   glutInit(&amp;argc, argv);
   glutInitDisplayMode (GLUT_DOUBLE | GLUT_RGB);
   glutInitWindowSize (500, 500);
   glutInitWindowPosition (10, 10);
   glutTimerFunc( 10, TimeEvent, 1);
   window_1 = glutCreateWindow (argv[0]);
   glutSetWindowTitle("GlutWindow 1");
   init ();
   glutDisplayFunc(display_1);
   glutReshapeFunc(reshape_1);
   glutKeyboardFunc(keyboard);

   window_2 = glutCreateWindow (argv[0]);
   glutSetWindowTitle("GlutWindow 2");
   init ();
   glutDisplayFunc(display_2);
   glutReshapeFunc(reshape_2);
   glutMainLoop();
   return 0;
} 
```

我在 Windows 7 上运行了示例代码，但我不得不将一行 glutIntit 替换为

```
glutInit(&argc, argv); 
```

# silverlight - 当您在 html 中创建应用程序时，如何将信息从浏览器传递到 Silverlight 应用程序？

> ID：452813
> 
> 赞同：1
> 
> 时间：2009-01-17T04:58:28.090
> 
> 标签：silverlight

当您使用以下命令创建 Silverlight 应用程序时：

```
<asp:Silverlight id="SlApp" runat="server" Source="~/ClientBin/SLApp.xap" MinimumVersion="2.0" /> 
```

有没有办法传入自定义信息（如字符串），以便可以在 Silverlight 应用程序的 C# 代码中访问它？就像在 Silverlight 的 App() 构造函数中一样？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T05:40:21.827

使用 Silverlight ASP.NET Web 控件时，有一个“InitParameters”属性，您可以使用该属性将初始化参数作为键/值对传递...

```
<asp:Silverlight id="SlApp" runat="server" Source="~/ClientBin/SLApp.xap" MinimumVersion="2.0" InitParameters="id=12345,name=john" /> 
```

然后在您的 Silverlight 应用程序中，您可以在应用程序的启动事件中读取这些属性...

```
public partial class App : Application
{
    public App()
    {
        Startup += Application_Startup;
    }

    private void Application_Startup(object sender, StartupEventArgs e)
    {
        string id = e.InitParams["id"];
        string name = e.InitParams["name"];
    }
} 
```

StartupEventArgs 的 InitParameters 属性只是一个通用 IDictionary<string,string>。

# ms-access - 如何使用 Codegear C++ builder (2007) 连接到 MS Access 数据库

> ID：452816
> 
> 赞同：0
> 
> 时间：2009-01-17T05:02:27.380
> 
> 标签：ms-access, c++builder

这似乎是最难获得帮助的事情 - 没有书籍，没有有用的谷歌搜索结果，而且 borland 自己的帮助设施对于我来说很难找到我需要的答案。

我想使用 builder 连接到已经存在的 microsoft access 数据库。

我希望能够添加/删除/读取记录。就这样。

或者失败了。如何使用构建器创建一个简单的数据库/表。如果我有一个应用程序可以创建一个表（如果它不存在），然后从那时起使用该表，那将是理想的。

我想避免创建 DSN。我想从构建器直接访问数据库。

如果您可以为我指明一个好的在线教程的方向，那将是一个开始。如果您真的可以自己提供帮助（即告诉我如何做，而不是给我看一篇文章），那就太好了，我会非常感激的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T21:30:14.763

在葡萄牙语：

[http://www.caloni.com.br/blog/archives/banco-de-dados-no-c-builder](http://www.caloni.com.br/blog/archives/banco-de-dados-no-c-builder)

看看是否适合你的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:50:13.633

你看过 VCL 的 ADO 组件了吗？TADOConnection、TADOCommand 等

# mysql - MySQL 中 IN 和 NOT IN 的大小限制是多少

> ID：452824
> 
> 赞同：10
> 
> 时间：2009-01-17T05:12:44.613
> 
> 标签：mysql

当 IN 或 NOT IN 的条件非常大时，我的应用程序出现内存不足异常。我想知道这样做的限制是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T05:42:01.230

也许你会更好地用另一种方式来完成你的查询？

我建议您将匹配值加载到单列表中，然后将要查询的列内连接到新表中的单列。

而不是

```
SELECT a, b, c FROM t1 WHERE d in (d1, d2, d3, d4, ...) 
```

建立一个有 1 列的临时表，称之为“dval”

```
dval  
----  
 d1  
 d2  
 d3

```

```
SELECT a, b, c FROM t1  
INNER JOIN temptbl ON t1.d = temptbl.dval 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T05:50:02.617

在进行 SQL 查询或数据库设计时必须询问限制是一个很好的指标，表明您做错了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T05:25:51.210

我只在条件非常小时（不到 100 行左右）时才使用 IN 和 NOT IN。它在这些场景中表现良好。当条件很大时，我使用 OUTER JOIN，因为查询不必为每个元组查找“IN”条件。您只需检查您希望所有行来自的表。

对于“IN”，连接条件不为空

对于“NOT IN”，连接条件为 NULL

例如

```
/* Get purchase orders that have never been rejected */
SELECT po.*
FROM PurchaseOrder po LEFT OUTER JOIN 
     (/* Get po's that have been rejected */
     SELECT po.PurchaesOrderID
     FROM PurchaseOrder po INNER JOIN 
         PurchaseOrderStatus pos ON po.PurchaseOrderID = pos.PurchaseOrderID
     WHERE pos.Status = 'REJECTED'
     ) por ON po.PurchaseOrderID = por.PurchaseOrderID
WHERE por.PurchaseOrderID IS NULL    /* We want NOT IN */ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-05T22:53:01.457

我有一个类似的问题，但在我的 IN 子句中只传递了 100 个 3 位 id。当我查看堆栈跟踪时，它实际上切断了 IN 子句中的逗号分隔值。我没有收到错误，我只是不要让所有结果返回。以前有没有人遇到过这样的问题？如果它相关，我正在使用 symfony 框架......我正在检查它是否是推进问题，但只是想看看是否可能是sql

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T06:07:29.790

我使用了相当大的 ID 列表 - 我怀疑内存问题不在查询本身。你如何检索结果？

例如，此查询来自实时站点：

```
SELECT DISTINCT c.id, c.name FROM categories c 
LEFT JOIN product_categories pc ON c.id = pc.category_id 
LEFT JOIN products p ON p.id = pc.product_id 
WHERE p.location_id IN (
955,891,901,877,736,918,900,836,846,914,771,773,833,
893,782,742,860,849,850,812,945,775,784,746,1036,863,
750,763,871,817,749,838,986,794,867,758,923,804,733,
949,808,837,741,747,954,939,865,857,787,820,783,760,
911,745,928,818,887,847,978,852
) ORDER BY c.name ASC 
```

我对代码的第一遍非常幼稚，一个页面上大约有 10 个这样的查询，并且数据库不会闪烁。

当然，您可以运行一个包含 100k 值的列表，这将是一个完全不同的故事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T15:46:15.537

我不知道限制是什么，但我以前也遇到过这个问题。我不得不像这样重写我的查询：

```
select * from foo
  where id in (select distinct foo_id from bar where ...) 
```

# javascript - 对象文字 + document.body.onclick 没有做我期望的事情

> ID：452825
> 
> 赞同：0
> 
> 时间：2009-01-17T05:20:54.970
> 
> 标签：javascript, object-literal

好的，这里的人是我惊人的反重力图书馆。我试图将它定义为一个对象文字，嗯，我读到了所有酷孩子正在做的事情，以便封装他们的库。基本测试表明它工作正常，但我似乎无法从我的对象内部看到 document.body。

应该发生的是，当我单击“它正在工作”页面时应该发出警报。相反，我得到一个 document.body=null 错误。是什么赋予了？我的身体在哪里？为什么我不能为它设置鼠标事件？我浪费了我整个星期五的时间！呸！

```
antigrav={
activate:function(){
    // turn on antigrav
    document.body.onmousedown = antigrav.startPan();
},

startPan:function(event){
    alert('it is working!');
},

}

document.onload=antigrav.activate(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T05:26:58.547

你可能想做

```
document.onload=antigrav.activate; 
```

使用括号，您将设置`document.onload`为运行 antigrav.activate() 的*结果*，而不是表明您希望 antigrav.activate 作为 document.onload 处理程序运行。因此，在加载文档之前，为了进行分配，activate() 正在运行，因此 document.body 尚未定义。

您可能希望对 onmousedown 处理程序分配做同样的事情：

```
document.body.onmousedown = antigrav.startPan; 
```

尝试一下，我还不得不切换到 window.onload ......

此外，请注意对象字面量定义中的尾随逗号。Firefox 对它们没问题，但 IE 会窒息。所以，总的来说：

```
var antigrav={
    activate:function(){
        // turn on antigrav
        document.body.onmousedown = antigrav.startPan;
    },
    startPan:function(event){
        alert('it is working!');
    }
};
window.onload=antigrav.activate; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T06:07:46.497

好的，这是当前状态：

```
var antigrav={
activate:function(){
    // turn on antigrav
    alert('started');
    document.body.onmouseup = antigrav.startPan;
    // make flash shield
},

startPan:function(event){
    alert('dude, you are panning!');
},

}
antigrav.activate();
//document.onload=window.antigrav.startPan; 
```

它达到“alert（'started'），但仍然抛出“error：document.body is null”注释掉的行具有相同的结果......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T16:41:02.243

好吧，人们，我是个傻瓜，但无论如何你们都非常乐于助人。

/real/ 问题，与任何事情无关，并揭示了 body.onclick 行为的奇怪怪癖：

在我的 /HTML/ 中，我试图建立一个大文档来测试我的点击：

```
<html>
<script src="antigrav.js"></script>
<body onload='test()'>
<!--<body onload="antigrav.activate();"  >-->

    yo, fool, this is the body!

    <div style="position:absolute; top:2000px;  left:2000px;">
        it is mad wide and tall!
    </div>

</body>
</html> 
```

为了拉伸身体，我在 2000px、2000px 处放置了一个 div。滚动条在那里，身体一定很大，对吧？实际上，div 之间的所有空间都 / 根本没有 / 在其中 - 包括一个 body 元素，我猜？您必须单击实际文本才能触发 document.body.onclick...

奇怪的是，（这是揭示的“奇怪的怪癖”）如果你给 body 标签一个 onclick="foo()"，那么当你点击页面上的任何地方时会触发 foo()，包括不存在的 body 区域。我不知道为什么会这样，但这实际上是问题所在。感谢您的帮助，您还指出了其他一些好的技术。

# c++ - 为什么锁会起作用？

> ID：452827
> 
> 赞同：4
> 
> 时间：2009-01-17T05:21:47.557
> 
> 标签：c++, multithreading, boost, locking, mutex

如果锁确保一次只有一个线程访问锁定的数据，那么什么控制对锁定功能的访问？

我认为[boost::mutex::scoped_lock](http://www.boost.org/doc/libs/1_37_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.mutex)应该在我的每个函数的开头，这样局部变量就不会被另一个线程意外修改，对吗？如果两个线程试图在非常接近的时间获取锁怎么办？内部使用的锁的局部变量不会被其他线程破坏吗？

我的问题不是特定于提升的，但除非您推荐另一个，否则我可能会使用它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T05:31:58.037

您只需拥有对共享数据的独占访问权限。除非它们是静态的或在堆上，否则函数内部的局部变量对于不同的线程会有不同的实例，无需担心。但是共享数据（例如通过指针访问的东西）应该首先被锁定。

至于锁是如何工作的，它们经过精心设计以防止竞争条件，并且通常具有硬件级别的支持以保证原子性。IE，有一些机器语言结构保证是原子的。信号量（和互斥量）可以通过这些来实现。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-17T05:32:50.000

没错，在实现锁时，您需要某种方式来保证两个进程不会同时获得锁。要做到这一点，您需要使用原子指令——它可以保证在不中断的情况下完成。一个这样的指令是[test-and-set](http://en.wikipedia.org/wiki/Test-and-set)，该操作将获取布尔变量的状态，将其设置为 true，并返回先前检索到的状态。

这样做的目的是让您可以编写不断测试的代码，以查看它是否可以获得锁。假设 x 是线程之间的共享变量：

```
while(testandset(x));
// ...
// critical section
// this code can only be executed by once thread at a time
// ...
x = 0; // set x to 0, allow another process into critical section 
```

由于其他线程不断地测试锁，直到它们进入临界区，这是保证互斥的一种非常低效的方法。但是，使用这个简单的概念，您可以构建更复杂的控制结构，例如更高效的信号量（因为进程没有循环，它们正在休眠）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T06:08:44.420

最简单的解释是，锁在下面，是基于保证是原子的并且不会在线程之间发生冲突的硬件指令。

函数中的普通局部变量已经特定于单个线程。只有静态、全局或其他可以被多个线程同时访问的数据需要锁来保护它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T17:14:34.257

操作锁的机制控制对它的访问。

任何锁定原语都需要能够在处理器之间传达更改，因此它通常在总线操作之上实现，即读取和写入内存。它还需要被结构化，以便两个试图声明它的线程不会破坏它的状态。这并不容易，但您通常可以相信任何操作系统实现的锁都不会被多个线程破坏。

# if-statement - 在 if 语句中编写相等测试

> ID：452828
> 
> 赞同：0
> 
> 时间：2009-01-17T05:22:20.303
> 
> 标签：if-statement

我想看看是否有人可以为我阐明这一点。当我使用 Eclipse 的 Checkstyle 插件时，我在以下语句中收到一条警告消息（不完全是这个，而是这个表单）：

```
if (x != y)
{
   do();
} 
```

为什么这是个问题？

**编辑**：我很抱歉，我应该更清楚我的问题。非常感谢您的回答；他们实际上帮助我解决了一个完全不同的问题。

我收到的警告建议我不要使用“x！= y”形式的测试，而是使用“x = y”形式的测试。我想知道为什么一个会比另一个更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T06:15:25.547

[LeftCurly](http://checkstyle.sourceforge.net/config_blocks.html#LeftCurly)检查器的默认设置是“eol”。这意味着您正在强制执行 if 语句（和类似块）应如下所示的规则：

```
if (x != y) {
    do();
} 
```

如果您更喜欢问题中显示的样式，请使用 Checkstyle 手册的[lcurly 策略](http://checkstyle.sourceforge.net/property_types.html#lcurly)部分中描述的“nl”设置。

您可以像这样修改 Eclipse 中的设置：

1.  从窗口中，选择首选项。
2.  如果需要，创建一个新的检查配置（通常通过复制一个不可修改的原件）并将其设为默认值。
3.  双击新配置，单击块，然后双击左花括号放置。修改并保存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T05:28:42.427

查看 Checkstyle 的检查说明 + 理由： [标准检查](http://checkstyle.sourceforge.net/checks.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-21T07:43:05.440

有“别的”吗？

我想如果你写了这样的东西

```
if (x != y)
{
   do();
}
else 
{
   doSomethingElse();
} 
```

我也会推荐

```
if (x == y)
{
   doSomethingElse();
}
else 
{
   do();
} 
```

# javascript - JavaScript DOM 代码不工作

> ID：452837
> 
> 赞同：2
> 
> 时间：2009-01-17T05:32:12.670
> 
> 标签：javascript, html, dom

我的 HTML 有

```
cell = document.createElement("td");
cell.appendChild(document.createTextNode(contents));
cell.setAttribute('width', '100'); 
```

以下语法不起作用。

```
cell.appendChild(document.createElement('br')).appendChild(document.createTextNode("Another text")); 
```

在单元格的内容之后，我有一个换行符，然后是同一单元格中的另一个小写字母文本。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T05:52:39.180

首先，您将文本节点附加到没有子级的 BR 标记。

尝试将您的线路分成两个电话：

```
cell.appendChild(document.createElement('br'));
cell.appendChild(document.createTextNode("Another text")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T05:52:11.257

看起来你正试图链接你的方法调用......对不起！本机元素没有链接。如果要链接，请尝试[jQuery](http://jquery.com)，否则请尝试：

```
var cell = document.createElement("td");
cell.appendChild(document.createTextNode(contents));
cell.setAttribute('width', '100');

// To make some text smaller you'll need it in a different element like a span
var span = document.createElement('span');
span.className = 'your-class-for-small-text';
span.appendChild(document.createTextNode("Another text"));

cell.appendChild(document.createElement('br'));
cell.appendChild(span); 
```

您必须添加一些 CSS 来设置跨度的样式以具有更小的文本：

```
<style type="text/css">
    .your-class-for-small-text {
        font-size: 12px;
    }
</style> 
```

或者您可以只修改该元素的样式而不是使用类名：

```
var cell = document.createElement("td");
cell.appendChild(document.createTextNode(contents));
cell.setAttribute('width', '100');

// To make some text smaller you'll need it in a different element like a span
var span = document.createElement('span');
span.style.fontSize = '12px';
span.appendChild(document.createTextNode("Another text"));

cell.appendChild(document.createElement('br'));
cell.appendChild(span); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T10:47:20.897

> 如何使另一个文本更小

我猜您正在尝试从[HTML 中的下标文本](https://stackoverflow.com/questions/450424/subscript-text-in-html)应用我的代码：

```
cell.appendChild(document.createElement('sub')).appendChild(document.createTextNode(subdata)); 
```

这是因为 Node.appendChild 返回它刚刚附加的子元素，这是一个子元素。第二个 appendChild 调用将文本节点放入子元素中。这*不适*用于 br 因为 br 是一个空元素，你不能在里面放任何东西。你可以在它后面加上一些东西，但这不是代码正在做的事情。

虽然您可以使用子元素（在附加 br 之后使用上面的行）来完成它，但使用样式化块元素可能会更好：

```
cell.appendChild(document.createElement('div'));
cell.lastChild.className= 'less-important';
cell.lastChild.appendChild(document.createTextNode(subdata)); 
```

在样式表中：

```
.less-important { font-size: 80%; } 
```

# .net - 是否为每个请求创建 AppDomain？

> ID：452845
> 
> 赞同：8
> 
> 时间：2009-01-17T05:40:42.903
> 
> 标签：.net, asp.net, appdomain

在 ASP.NET 3.5（带有 IIS6）中，是否为每个请求创建了 AppDomains？我知道所有应用程序在 w3wp.exe 下都有自己的 AppDomain，但是整个 AppDomain 究竟是如何工作的呢？

今天我和一位同事争论，他试图说服我，如果 ASP.NET 应用程序有一个静态对象（或 Singleton 类），那么这个对象将在所有请求之间共享。我认为这是错误的。我对吗？如何说服我的同事？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T05:56:09.220

我很抱歉地说你的同事是对的。在 ASP.NET 应用程序中，在 IIS 中这样配置的每个应用程序都在其自己的 AppDomain 中运行，这是单例对象的范围。因此，App1 中的单例可用于对 App1 的所有请求（如果不小心处理，可能会成为并发），但 App2 中的请求将无法访问 App1 中的单例。

[![HTTP 管道中的线程和池化](https://i.stack.imgur.com/Bv3MX.gif)](http://msdn.microsoft.com/en-us/magazine/cc164128.aspx)
[（来源：[microsoft.com](http://i.msdn.microsoft.com/cc164128.fig01(en-us).gif)）]

这张来自 MSDN 杂志的图表有助于展示每个应用程序是如何在其自己的 AppDomain 中隔离的。虽然该图显示了 IIS5 工作进程 (aspnet_wp.exe)，但 IIS6 工作进程对于配置为在同一应用程序池中运行的应用程序来说是相似的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T05:48:17.287

单例将存在于 appdomain 的整个范围内。此外，对您的应用程序的所有请求都将转到同一个 appdomain，因此您的同事实际上是正确的。

更新：这个问题是由好奇心引起的，我发现了一个“单例”，你可以在[每个请求的基础上](http://dotnet.org.za/eduard/archive/2004/07/07/2609.aspx)使用它。不过，我实际上并不建议这样做。如果有人需要每个请求的单例，那么他们需要找到更合适的模式。

# php - 我已经安装了 Zend Framework 并且需要在 PHP 中设置包含路径？

> ID：452848
> 
> 赞同：-1
> 
> 时间：2009-01-17T05:46:24.280
> 
> 标签：php, apache, zend-framework

我已将 Zend Framework 文件转储到

**“home/hotbuzz/public_html/include/zend/”**

我的主机：linux

我想将它加载到我的脚本中。每当我加载时，我都会收到此错误。

一些信息：我询问了我的 Zend，托管人说它位于“usr/local/zend”

但我想用这个 home/hotbuzz/public_html/include/zend/

我在我的 PHP 中添加了这些内容：

```
set_include_path(dirname(__FILE__).';'.get_include_path());
require_once 'Zend/Loader.php'; 
```

我收到这个错误

```
Fatal error: require_once() [function.require]: Failed opening required 'Zend/Exception.php' (include_path='/home/hotbuzz/public_html/include;.:/usr/lib/php:/usr/local/lib/php') in /home/hotbuzz/public_html/include/Zend/Loader.php on line 87 
```

我想在我的 PHP 代码中设置包含路径并对其进行配置（.htaccess）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T08:06:30.907

正如我在你之前的问题中所说的那样。不使用 ';' 但使用 PATH_SEPARATOR。这是一个 PHP 常量，代表系统的正确分隔符（windows 上的分号和 linux 上的冒号）

```
set_include_path(dirname(__FILE__).PATH_SEPARATOR.get_include_path()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T11:15:33.570

你做得对。您应该调用`set_include_path`主脚本 (index.php) 的第一行，然后包含/需要 zend 框架文件。请记住将包含 Zend 框架的文件夹重命名为“Zend”（大写 Z）以遵循 ZF 命名转换，然后将 Zend 文件夹放在包含目录中。

```
<?php
$newIncludePath = array();
$newIncludePath[] = '.';
$newIncludePath[] = 'include';
$newIncludePath[] = get_include_path();
$newIncludePath = implode(PATH_SEPARATOR, $newIncludePath);
set_include_path($newIncludePath);
// now include path is setup and we can use zend
require_once 'Zend/Loader.php';
Zend_Loader::registerAutoLoad('Zend_Loader', true);
// the rest of the code
?> 
```

如果你把 Zend 目录放在你的包含路径中，而不是包含目录（包含 Zend 目录），你可能不会使用这个：

```
require_once 'Zend/Loader'; 
```

相反，您应该使用：

```
require_once 'Loader'; 
```

这不是一个好主意。通过使用 Zend/* 模型，您将记住 Zend 框架中包含哪些文件以及您拥有哪些文件。所以只需将包含目录添加到您的包含路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T08:59:55.263

如果您使用 auto_prepend 而不是 include...，您可能会取得更大的成功。

```
php_value include_path /home/hotbuzz/public_html/include/zend/
php_value auto_prepend_file Zend/Loader.php 
```

你在启动和执行时的 apache 日志中得到了什么？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-10-01T05:26:05.113

您可以在 bootstrap.php 的第一行附加以下代码：

```
set_include_path('.' . PATH_SEPARATOR . '../library' . PATH_SEPARATOR . '../application/models/' . PATH_SEPARATOR . get_include_path()); 
```

# sql-server-2005 - 我无法访问 SQL 2005 实例的所有原因

> ID：452850
> 
> 赞同：4
> 
> 时间：2009-01-17T05:48:05.790
> 
> 标签：sql-server-2005, database-connection

我已经在`<computername>/SQLEXPRESS`. 只有一次实例安装。我已经允许远程连接、打开 SQL 身份验证、启用 TCP/IP、命名管道和 VIA，但我仍然无法从另一台计算机访问数据库。我不断得到：

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

我还能寻找什么？我确定我的代码是正确的，因为它在被擦除之前用于连接到同一个系统。我非常有信心连接字符串也是正确的：

```
Server=<computername>\SQLEXPRESS;User Id=<username>;Password=<password>; 
```

两个系统之间也没有防火墙。它们在同一个网段，Windows 防火墙已完全关闭。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T06:02:35.870

SQL Server Browser 是否在计算机上运行？对于命名实例，如 \SQLExpress，SQL 浏览器允许客户端机器识别连接到哪个端口。

默认情况下，只有默认实例在 TCP 1433 上运行。如果客户端无法在默认端口上连接，它会在 UDP 1434 上查询 SQL 浏览器以找到用于给定命名实例的正确端口。

# ruby-on-rails - 如何创建在关联模型上运行的查找器条件

> ID：452857
> 
> 赞同：1
> 
> 时间：2009-01-17T05:54:03.063
> 
> 标签：ruby-on-rails

假设 rails app 有以下模型 song, play, radio_station： song has_many play play has_many radio_stations radio_station 有属性“call_sign”

我想为 Song 创建一个查找，它会为我返回由“WKRP”广播电台播放（歌曲）最后一次播放的所有歌曲

我可以

found = [] Song.find(:all,:include=>[{:plays=>[:radio_station]}]).each do |song| 找到 << 歌曲如果 song.plays.last.radio_station.call_sign == "WKRP" end

但这意味着必须首先从数据库中提取所有歌曲并循环播放...随着歌曲和播放数量的增加，这会变慢。

我怎样才能把它变成一个查找条件？

看起来这应该是可行的——但我不知道怎么做，我也不是一个真正的 SQL 大师......

然后..很想把它挤进一个命名范围，所以我可以这样称呼它：

Song.find_all_last_played_at("WKRP")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T08:21:52.703

这可能无法由 ActiveRecord 查找器完成。您必须使用子查询滚动一些自定义 SQL（需要 MySQL 5）：

```
 SELECT s.* FROM songs s LEFT JOIN plays p
 WHERE p.radio_station_id = [id of WKRP] 
   AND  p.created_at = (SELECT MAX(created_at) FROM plays p2 
                         WHERE p2.song_id = s.id) 
```

使用以下方法加载这些歌曲`find_by_sql`：

```
 Song.find_by_sql('SELECT ...') 
```

`named_scope`如果您愿意，可以使用 a 重构它。

```
 class Song < ActiveRecord::Base
  has_many :plays

  named_scope :last_played_on, lambda { |radio_station| 
    { :conditions => ['plays.created_at = (SELECT MAX(p2.created_at) FROM plays p2 
        WHERE p2.song_id = songs.id) AND plays.radio_station_id = ?', radio_station.id],
      :joins => [:plays] }
  }
end

@wkrp = RadioStation.find_by_name('WKRP') 
Song.last_played_on(@wkrp).each { |song| ... } 
```

请注意，使用子查询可能会很慢。您可能希望将最新`play_id`的歌曲缓存为`songs`表中的一个字段，以使查询更容易和更快。`last_play_id`首先在您的歌曲表中添加一个字段。

```
 class Play < ActiveRecord::Base
  belongs_to :song

  after_create do |play|
    play.song.last_play_id = play.id
    play.song.save!
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T13:22:38.037

Created a named_scope that pulls all the plays for that particular radio station, with order 'created_at DESC' and then chain .last on to the end of the returned query. Along the lines of:

```
Song.played_by('WRXD').last 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T08:41:56.797

对于性能，您可能应该按照 wvangergen 的建议进行操作。但对于合成糖，我认为这可能有效：

```
class Song
  has_many :plays, :order => 'created_at' do
    def last_played
      self.maximum(:created-at)
    end
  end
end

class Play
  named_scope :by, lambda {|call_sign| {:conditions => ["radio_stations.call_sign = ?", call_sign]}}
end 
```

要使用：

```
Song.plays.last_played.by("WKRZ") 
```

我没有测试代码，所以为语法错误道歉=）现在我正在阅读它，我认为它不会起作用，但我希望你能弄明白它或其他什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T08:42:56.437

我认为您可以从您的关联开始执行此操作（请注意，默认的“订单”是“created_at”）：

```
class Song
  has_many :plays
  has_many :radio_staions, :through => :plays, :uniq => true
  has_one  :last_radio_station, :through => :plays, :source => :last_radio_station

  named_scope :last_played_at, lambda {|call_sign| {:include => :last_radio_station, :conditions => ["radio_stations.call_sign = ?", call_sign]}}
end 
```

这期望您的 Play 模型具有：

```
class Play
  has_one :last_radio_station, :class_name => 'RadioStation', :order => 'created_at'
  has_many :radio_stations 
```

然后你可以简单地调用：

```
Song.last_played_at("WKRZ") 
```

我自己没有尝试过，但希望它会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T06:55:33.110

您可能应该查看命名范围。

```
class Song
  named_scope :last_played_by, lambda {|call_sign| {:conditions => ["plays.radio_stations.call_sign = ?", call_sign]}}
end 
```

你会这样使用它

```
Song.last_played_by("WKRZ") 
```

但是，我意识到我不知道您使用什么机制来查找最后一场比赛。但是您可以将其拆分为两个命名范围，如下所示：

```
class Song
  named_scope :played_by, lambda {|call_sign| {:conditions => ["plays.radio_station.call_sign = ?", call_sign]}}
  named_scope :last_play {:conditions => ["MAX(plays.created_at)"]
end 
```

要使用它：

```
Song.last_play.played_by("WKRZ") 
```

我相信这是正确的，但我还没有测试过，而且我对命名范围也不是很熟悉。

# sql - 在单个 SQL 查询中插入多行？

> ID：452859
> 
> 赞同：1867
> 
> 时间：2009-01-17T05:55:54.150
> 
> 标签：sql, sql-server, tsql, insert

我要一次插入多组数据，比如 4 行。我的表有三列`Person`：`Id`和`Office`。

```
INSERT INTO MyTable VALUES ("John", 123, "Lloyds Office");
INSERT INTO MyTable VALUES ("Jane", 124, "Lloyds Office");
INSERT INTO MyTable VALUES ("Billy", 125, "London Office");
INSERT INTO MyTable VALUES ("Miranda", 126, "Bristol Office"); 
```

我可以在一个 SQL 语句中插入所有 4 行吗？

* * *

## 回答 #1

> 赞同：2476
> 
> 时间：2009-01-17T07:14:14.367

在 SQL Server 2008 中，您可以使用单个 SQL INSERT 语句插入多行。

```
INSERT INTO MyTable ( Column1, Column2 ) VALUES
( Value1, Value2 ), ( Value1, Value2 ) 
```

作为参考，请查看 MOC 课程 2778A - 在 SQL Server 2008 中编写 SQL 查询。

例如：

```
INSERT INTO MyTable
  ( Column1, Column2, Column3 )
VALUES
  ('John', 123, 'Lloyds Office'), 
  ('Jane', 124, 'Lloyds Office'), 
  ('Billy', 125, 'London Office'),
  ('Miranda', 126, 'Bristol Office'); 
```

* * *

## 回答 #2

> 赞同：853
> 
> 时间：2009-01-17T06:10:26.447

如果要插入单个表，则可以这样编写查询（可能仅在 MySQL 中）：

```
INSERT INTO table1 (First, Last)
VALUES
    ('Fred', 'Smith'),
    ('John', 'Smith'),
    ('Michael', 'Smith'),
    ('Robert', 'Smith'); 
```

* * *

## 回答 #3

> 赞同：147
> 
> 时间：2009-01-17T06:16:23.593

**注意：**此答案适用于 SQL Server 2005。对于 SQL Server 2008 及更高版本，如其他答案所示，有更好的方法。

您可以将[INSERT 与 SELECT UNION ALL 一起](http://blog.sqlauthority.com/2007/06/08/sql-server-insert-multiple-records-using-one-insert-statement-use-of-union-all/)使用：

```
INSERT INTO MyTable  (FirstCol, SecondCol)
    SELECT  'First' ,1
    UNION ALL
SELECT  'Second' ,2
    UNION ALL
SELECT  'Third' ,3
... 
```

不过，仅适用于小型数据集，这对您的 4 条记录应该没问题。

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2009-04-01T14:07:24.633

`INSERT`使用`VALUES`语法的语句可以插入多行。为此，请包含多个列值列表，每个列表都包含在括号中并用逗号分隔。

**例子：**

```
INSERT INTO tbl_name (a,b,c) VALUES(1,2,3),(4,5,6),(7,8,9); 
```

# python - 处理给 BeautifulSoup 的坏链接的最佳方法是什么？

> ID：452884
> 
> 赞同：1
> 
> 时间：2009-01-17T06:10:41.080
> 
> 标签：python, parsing, beautifulsoup

我正在做一些事情，从美味中提取网址，然后使用这些网址来发现相关的提要。

但是，delicious 中的某些书签不是 html 链接，导致 BS 吐槽。基本上，如果 BS 获取链接并且它看起来不像 html，我想丢弃它。

现在，这就是我得到的。

```
trillian:Documents jauderho$ ./d2o.py "green data center" 
processing http://www.greenm3.com/
processing http://www.eweek.com/c/a/Green-IT/How-to-Create-an-EnergyEfficient-Green-Data-Center/?kc=rss
Traceback (most recent call last):
  File "./d2o.py", line 53, in <module>
    get_feed_links(d_links)
  File "./d2o.py", line 43, in get_feed_links
    soup = BeautifulSoup(html)
  File "/Library/Python/2.5/site-packages/BeautifulSoup.py", line 1499, in __init__
    BeautifulStoneSoup.__init__(self, *args, **kwargs)
  File "/Library/Python/2.5/site-packages/BeautifulSoup.py", line 1230, in __init__
    self._feed(isHTML=isHTML)
  File "/Library/Python/2.5/site-packages/BeautifulSoup.py", line 1263, in _feed
    self.builder.feed(markup)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/HTMLParser.py", line 108, in feed
    self.goahead(0)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/HTMLParser.py", line 150, in goahead
    k = self.parse_endtag(i)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/HTMLParser.py", line 314, in parse_endtag
    self.error("bad end tag: %r" % (rawdata[i:j],))
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/HTMLParser.py", line 115, in error
    raise HTMLParseError(message, self.getpos())
HTMLParser.HTMLParseError: bad end tag: u'</b  />', at line 739, column 1 
```

**更新：**

耶希亚的回答成功了。作为参考，这里有一些获取内容类型的代码：

```
def check_for_html(link):
    out = urllib.urlopen(link)
    return out.info().getheader('Content-Type') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T06:20:54.460

我只是简单地包装我的 BeautifulSoup 处理并查找`HTMLParser.HTMLParseError`异常

```
import HTMLParser,BeautifulSoup
try:
    soup = BeautifulSoup.BeautifulSoup(raw_html)
    for a in soup.findAll('a'):
        href = a.['href']
        ....
except HTMLParser.HTMLParseError:
    print "failed to parse",url 
```

但除此之外，您可以在抓取页面时检查响应的内容类型，并在您尝试解析它之前确保它是类似`text/html`或类似的东西。`application/xml+xhtml`这应该可以避免大多数错误。

# php - 用于制作 PHP 扩展的 SWIG，您尝试过吗？

> ID：452885
> 
> 赞同：3
> 
> 时间：2009-01-17T06:10:43.590
> 
> 标签：php, c, swig, php-extension

我有一些用 C（不是 C++）编写的小型库和包装器，我想通过扩展将它们提供给 PHP。我阅读了几篇关于[编写适当的 PHP 扩展的](http://devzone.zend.com/node/view/id/1021)教程，这似乎并不难，但是我不希望除了库之外维护扩展的麻烦。

我读到[SWIG](http://www.swig.org/)支持构建与 Zend PHP 5 兼容的扩展，这对我来说是完美的。但是，根据 SWIG 文档，支持似乎是测试版。

我的库很常见，作为 C 中使用的元示例：

```
int main(void)
{
    struct libfoo *foo;

    char **tmp;

    foo = foo_init();
    if (foo == NULL) {
        fprintf(stderr, "Could not allocate foo\n");
        return 1;
     }

     tmp = foo_parse(foo, "/foo/foo.txt");
     ......
     foo_finit(foo);
} 
```

有没有人有任何经验可以分享使用 SWIG 使库的扩展如此简单？有谁知道使用 SWIG 将 php 扩展作为构建的可选部分用 C 编写的任何免费/开源项目？

在此先感谢，我希望得到一些反馈。如果它是积极的，我会花一些时间真正了解 SWIG。如果不是，我会花时间手工制作扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T16:25:53.303

几年前，我参与了一个基于 C API 生成原型 Python 模块的项目。我们决定使用 SWIG 来帮助我们开始，因为项目中没有人知道 Python C API。虽然原则上拥有一些自动生成的函数的想法在现实中听起来很棒，但它给我们带来了更多的工作，因为我们需要调整和自定义 SWIG 生成的代码以满足我们的需求。

从 PHP 的角度来看，我维护了一个 PHP C 扩展，并且不相信与 SWIG 一起使用的“简单”C 函数会有所帮助，手动编写代码会更容易。Sara Golemon 的[扩展和嵌入 PHP](https://rads.stackoverflow.com/amzn/click/com/067232704X "扩展和嵌入 PHP")可能值得您阅读或阅读。

# javascript - 使用 Javascript 注册“keydown”事件后，Textarea 滞后

> ID：452895
> 
> 赞同：5
> 
> 时间：2009-01-17T06:20:35.787
> 
> 标签：javascript, html, events, textarea, keydown

如何将一堆代码附加到一个事件中，但又能快速而清晰`onkeydown`地输入文本？`textarea`任何超过几个 IF 语句似乎都会大大减慢它。

**编辑**：我应该补充（不敢相信我忘记了！）这不会影响桌面浏览器。这主要是 iPhone Safari 的问题。其他移动浏览器也可能会受到影响，但我们专注于 iPhone Safari，因为它执行 JS 最好（AFAIK）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T07:37:17.113

考虑到您对此的编辑重点是 iPhone 访问...

iPhone真的没有那么大的力量。最好使用**`onchange`**or**`onblur`**代替**`onkeydown`**.

* * *

* * *

戴夫回答的另一种方法是等待用户暂停（例如 5 秒）：

```
var textarea = document.getElementById('textarea');

function checkTextArea() {
   if (textarea.value /* ... */) {
     /* ... */
   }
}

textarea.keyDownTimeout = null;
textarea.onkeydown = function () {
  if (textarea.keyDownTimeout) clearTimeout(textarea.keyDownTimeout);
  textarea.keyDownTimeout = setTimeout(checkTextArea, 5000);
}; 
```

这应该使用第一次按键设置计时器，为每个连续的按键停止并重新创建计时器。最后在用户停止输入 5 秒后调用。

另外，请注意 . 后面没有括号`checkTextArea`。这将给出`setTimeout`函数的引用与它的`return`.

* * *

您还可以在函数中进行设置，以便更轻松地用于多个元素：

```
function setPauseTimer(element, timeout, callback) {
  var timer = null;
  element.onkeydown = function () {
    if (timer) clearTimeout(timer);
    timer = setTimeout(function(){ callback(element); }, timeout);
  };
}

function checkTextArea(textarea) { /* moved from global to argument */
   if (textarea.value /* ... */) {
     /* ... */
   }
}

setPauseTimer(document.getElementById('textarea'), 5000, checkTextArea); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T07:55:25.453

也许您可以发布“一堆代码”，我们可以讨论那里是否有一些重构（在使用计时器将其复杂化之前）。看起来你可能会先跳到二级优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T08:30:29.253

我想到了计时器方法。我相信`setTnterval`会比 a 更好`setTimeout`，但这似乎不是最佳解决方案，不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T06:50:23.400

好吧，一种方法是不使用 onkeydown，而是使用计时器。您可以设置运行检查 TextArea 内容的函数的间隔并在那里运行您的逻辑。似乎它会绕过大部分开销。无论如何，试一试，我认为它可能会有所帮助。

以下是您将如何使用它：

```
// First param is the function to call, second is 
// time interval in miliseconds
var timer = setTimeout(checkTextArea(), 5000);

function checkTextArea() {
    var text = document.getElementById("textarea").value;
    // logic...
    timer = setTimeout(checkTextArea(), 5000); // we loop it back to 
                                               //the function with the timer
} 
```

# c# - 如何在 C# 中使用迭代器反向读取文本文件

> ID：452902
> 
> 赞同：92
> 
> 时间：2009-01-17T06:27:53.633
> 
> 标签：c#, .net

我需要处理一个大文件，大约 400K 行和 200 M。但有时我必须自下而上处理。我如何在这里使用迭代器（收益回报）？基本上我不喜欢将所有内容都加载到内存中。我知道在.NET 中使用迭代器效率更高。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-01-17T07:35:11.937

除非您使用固定大小的编码（例如 ASCII），否则向后读取文本文件非常棘手。当您使用可变大小编码（例如 UTF-8）时，您将不得不在获取数据时继续检查您是否在字符中间。

框架中没有内置任何内容，我怀疑您必须为每个可变宽度编码进行单独的硬编码。

编辑：这已经过*一些*测试 - 但这并不是说它仍然没有一些微妙的错误。它使用来自 MiscUtil 的 StreamUtil，但我在底部只包含了必要的（新）方法。哦，它需要重构——有一种非常重要的方法，你会看到：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Text;

namespace MiscUtil.IO
{
    /// <summary>
    /// Takes an encoding (defaulting to UTF-8) and a function which produces a seekable stream
    /// (or a filename for convenience) and yields lines from the end of the stream backwards.
    /// Only single byte encodings, and UTF-8 and Unicode, are supported. The stream
    /// returned by the function must be seekable.
    /// </summary>
    public sealed class ReverseLineReader : IEnumerable<string>
    {
        /// <summary>
        /// Buffer size to use by default. Classes with internal access can specify
        /// a different buffer size - this is useful for testing.
        /// </summary>
        private const int DefaultBufferSize = 4096;

        /// <summary>
        /// Means of creating a Stream to read from.
        /// </summary>
        private readonly Func<Stream> streamSource;

        /// <summary>
        /// Encoding to use when converting bytes to text
        /// </summary>
        private readonly Encoding encoding;

        /// <summary>
        /// Size of buffer (in bytes) to read each time we read from the
        /// stream. This must be at least as big as the maximum number of
        /// bytes for a single character.
        /// </summary>
        private readonly int bufferSize;

        /// <summary>
        /// Function which, when given a position within a file and a byte, states whether
        /// or not the byte represents the start of a character.
        /// </summary>
        private Func<long,byte,bool> characterStartDetector;

        /// <summary>
        /// Creates a LineReader from a stream source. The delegate is only
        /// called when the enumerator is fetched. UTF-8 is used to decode
        /// the stream into text.
        /// </summary>
        /// <param name="streamSource">Data source</param>
        public ReverseLineReader(Func<Stream> streamSource)
            : this(streamSource, Encoding.UTF8)
        {
        }

        /// <summary>
        /// Creates a LineReader from a filename. The file is only opened
        /// (or even checked for existence) when the enumerator is fetched.
        /// UTF8 is used to decode the file into text.
        /// </summary>
        /// <param name="filename">File to read from</param>
        public ReverseLineReader(string filename)
            : this(filename, Encoding.UTF8)
        {
        }

        /// <summary>
        /// Creates a LineReader from a filename. The file is only opened
        /// (or even checked for existence) when the enumerator is fetched.
        /// </summary>
        /// <param name="filename">File to read from</param>
        /// <param name="encoding">Encoding to use to decode the file into text</param>
        public ReverseLineReader(string filename, Encoding encoding)
            : this(() => File.OpenRead(filename), encoding)
        {
        }

        /// <summary>
        /// Creates a LineReader from a stream source. The delegate is only
        /// called when the enumerator is fetched.
        /// </summary>
        /// <param name="streamSource">Data source</param>
        /// <param name="encoding">Encoding to use to decode the stream into text</param>
        public ReverseLineReader(Func<Stream> streamSource, Encoding encoding)
            : this(streamSource, encoding, DefaultBufferSize)
        {
        }

        internal ReverseLineReader(Func<Stream> streamSource, Encoding encoding, int bufferSize)
        {
            this.streamSource = streamSource;
            this.encoding = encoding;
            this.bufferSize = bufferSize;
            if (encoding.IsSingleByte)
            {
                // For a single byte encoding, every byte is the start (and end) of a character
                characterStartDetector = (pos, data) => true;
            }
            else if (encoding is UnicodeEncoding)
            {
                // For UTF-16, even-numbered positions are the start of a character.
                // TODO: This assumes no surrogate pairs. More work required
                // to handle that.
                characterStartDetector = (pos, data) => (pos & 1) == 0;
            }
            else if (encoding is UTF8Encoding)
            {
                // For UTF-8, bytes with the top bit clear or the second bit set are the start of a character
                // See http://www.cl.cam.ac.uk/~mgk25/unicode.html
                characterStartDetector = (pos, data) => (data & 0x80) == 0 || (data & 0x40) != 0;
            }
            else
            {
                throw new ArgumentException("Only single byte, UTF-8 and Unicode encodings are permitted");
            }
        }

        /// <summary>
        /// Returns the enumerator reading strings backwards. If this method discovers that
        /// the returned stream is either unreadable or unseekable, a NotSupportedException is thrown.
        /// </summary>
        public IEnumerator<string> GetEnumerator()
        {
            Stream stream = streamSource();
            if (!stream.CanSeek)
            {
                stream.Dispose();
                throw new NotSupportedException("Unable to seek within stream");
            }
            if (!stream.CanRead)
            {
                stream.Dispose();
                throw new NotSupportedException("Unable to read within stream");
            }
            return GetEnumeratorImpl(stream);
        }

        private IEnumerator<string> GetEnumeratorImpl(Stream stream)
        {
            try
            {
                long position = stream.Length;

                if (encoding is UnicodeEncoding && (position & 1) != 0)
                {
                    throw new InvalidDataException("UTF-16 encoding provided, but stream has odd length.");
                }

                // Allow up to two bytes for data from the start of the previous
                // read which didn't quite make it as full characters
                byte[] buffer = new byte[bufferSize + 2];
                char[] charBuffer = new char[encoding.GetMaxCharCount(buffer.Length)];
                int leftOverData = 0;
                String previousEnd = null;
                // TextReader doesn't return an empty string if there's line break at the end
                // of the data. Therefore we don't return an empty string if it's our *first*
                // return.
                bool firstYield = true;

                // A line-feed at the start of the previous buffer means we need to swallow
                // the carriage-return at the end of this buffer - hence this needs declaring
                // way up here!
                bool swallowCarriageReturn = false;

                while (position > 0)
                {
                    int bytesToRead = Math.Min(position > int.MaxValue ? bufferSize : (int)position, bufferSize);

                    position -= bytesToRead;
                    stream.Position = position;
                    StreamUtil.ReadExactly(stream, buffer, bytesToRead);
                    // If we haven't read a full buffer, but we had bytes left
                    // over from before, copy them to the end of the buffer
                    if (leftOverData > 0 && bytesToRead != bufferSize)
                    {
                        // Buffer.BlockCopy doesn't document its behaviour with respect
                        // to overlapping data: we *might* just have read 7 bytes instead of
                        // 8, and have two bytes to copy...
                        Array.Copy(buffer, bufferSize, buffer, bytesToRead, leftOverData);
                    }
                    // We've now *effectively* read this much data.
                    bytesToRead += leftOverData;

                    int firstCharPosition = 0;
                    while (!characterStartDetector(position + firstCharPosition, buffer[firstCharPosition]))
                    {
                        firstCharPosition++;
                        // Bad UTF-8 sequences could trigger this. For UTF-8 we should always
                        // see a valid character start in every 3 bytes, and if this is the start of the file
                        // so we've done a short read, we should have the character start
                        // somewhere in the usable buffer.
                        if (firstCharPosition == 3 || firstCharPosition == bytesToRead)
                        {
                            throw new InvalidDataException("Invalid UTF-8 data");
                        }
                    }
                    leftOverData = firstCharPosition;

                    int charsRead = encoding.GetChars(buffer, firstCharPosition, bytesToRead - firstCharPosition, charBuffer, 0);
                    int endExclusive = charsRead;

                    for (int i = charsRead - 1; i >= 0; i--)
                    {
                        char lookingAt = charBuffer[i];
                        if (swallowCarriageReturn)
                        {
                            swallowCarriageReturn = false;
                            if (lookingAt == '\r')
                            {
                                endExclusive--;
                                continue;
                            }
                        }
                        // Anything non-line-breaking, just keep looking backwards
                        if (lookingAt != '\n' && lookingAt != '\r')
                        {
                            continue;
                        }
                        // End of CRLF? Swallow the preceding CR
                        if (lookingAt == '\n')
                        {
                            swallowCarriageReturn = true;
                        }
                        int start = i + 1;
                        string bufferContents = new string(charBuffer, start, endExclusive - start);
                        endExclusive = i;
                        string stringToYield = previousEnd == null ? bufferContents : bufferContents + previousEnd;
                        if (!firstYield || stringToYield.Length != 0)
                        {
                            yield return stringToYield;
                        }
                        firstYield = false;
                        previousEnd = null;
                    }

                    previousEnd = endExclusive == 0 ? null : (new string(charBuffer, 0, endExclusive) + previousEnd);

                    // If we didn't decode the start of the array, put it at the end for next time
                    if (leftOverData != 0)
                    {
                        Buffer.BlockCopy(buffer, 0, buffer, bufferSize, leftOverData);
                    }
                }
                if (leftOverData != 0)
                {
                    // At the start of the final buffer, we had the end of another character.
                    throw new InvalidDataException("Invalid UTF-8 data at start of stream");
                }
                if (firstYield && string.IsNullOrEmpty(previousEnd))
                {
                    yield break;
                }
                yield return previousEnd ?? "";
            }
            finally
            {
                stream.Dispose();
            }
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return GetEnumerator();
        }
    }
}

// StreamUtil.cs:
public static class StreamUtil
{
    public static void ReadExactly(Stream input, byte[] buffer, int bytesToRead)
    {
        int index = 0;
        while (index < bytesToRead)
        {
            int read = input.Read(buffer, index, bytesToRead - index);
            if (read == 0)
            {
                throw new EndOfStreamException
                    (String.Format("End of stream reached with {0} byte{1} left to read.",
                                   bytesToRead - index,
                                   bytesToRead - index == 1 ? "s" : ""));
            }
            index += read;
        }
    }
} 
```

非常欢迎反馈。这很有趣:)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-06-09T10:18:41.017

> 注意：这种方法不起作用（在编辑中解释）

您可以使用 File.ReadLines 获取行迭代器

```
foreach (var line in File.ReadLines(@"C:\temp\ReverseRead.txt").Reverse())
{
    if (noNeedToReadFurther)
        break;

    // process line here
    Console.WriteLine(line);
} 
```

编辑：

阅读[applejacks01](https://stackoverflow.com/users/4223489/applejacks01)的评论后，我运行了一些测试，*看起来* `.Reverse()`确实加载了整个文件。

我曾经`File.ReadLines()`打印40MB 文件的**第一行- 控制台应用程序的内存使用量为****5MB**。然后，用于`File.ReadLines().Reverse()`打印同一文件的**最后一行**- 内存使用量为**95MB**。

> **结论**
> 
> 无论 `Reverse()' 在做什么，**它都不是**读取大文件底部的好选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-03-29T12:52:09.893

**大文件的快速解决方案**：从 C# 中，使用带有 Tail 参数的 PowerShell 的 Get-Content。

```
using System.Management.Automation;

using (PowerShell powerShell = PowerShell.Create())
{
    string lastLine = powerShell.AddCommand("Get-Content")
        .AddParameter("Path", @"c:\a.txt")
        .AddParameter("Tail", 1)
        .Invoke().FirstOrDefault()?.ToString();
} 
```

所需参考：“System.Management.Automation.dll” - 可能位于“C:\Program Files (x86)\Reference Assemblies\Microsoft\WindowsPowerShell\3.0”之类的地方

使用 PowerShell 会产生少量开销，但对于大文件来说是值得的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T07:27:29.787

要创建文件迭代器，您可以这样做：

编辑：

这是我的固定宽度反向文件阅读器的固定版本：

```
public static IEnumerable<string> readFile()
{
    using (FileStream reader = new FileStream(@"c:\test.txt",FileMode.Open,FileAccess.Read))
    {
        int i=0;
        StringBuilder lineBuffer = new StringBuilder();
        int byteRead;
        while (-i < reader.Length)
        {
            reader.Seek(--i, SeekOrigin.End);
            byteRead = reader.ReadByte();
            if (byteRead == 10 && lineBuffer.Length > 0)
            {
                yield return Reverse(lineBuffer.ToString());
                lineBuffer.Remove(0, lineBuffer.Length);
            }
            lineBuffer.Append((char)byteRead);
        }
        yield return Reverse(lineBuffer.ToString());
        reader.Close();
    }
}

public static string Reverse(string str)
{
    char[] arr = new char[str.Length];
    for (int i = 0; i < str.Length; i++)
        arr[i] = str[str.Length - 1 - i];
    return new string(arr);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-26T14:35:01.000

我将文件逐行放入列表中，然后使用 List.Reverse();

```
 StreamReader objReader = new StreamReader(filename);
        string sLine = "";
        ArrayList arrText = new ArrayList();

        while (sLine != null)
        {
            sLine = objReader.ReadLine();
            if (sLine != null)
                arrText.Add(sLine);
        }
        objReader.Close();

        arrText.Reverse();

        foreach (string sOutput in arrText)
        { 
```

...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-13T08:45:35.883

我还添加了我的解决方案。在阅读了一些答案后，没有什么真正适合我的情况。我从后面逐字节读取，直到找到 LineFeed，然后我将收集的字节作为字符串返回，**而不使用缓冲**。

用法：

```
var reader = new ReverseTextReader(path);
while (!reader.EndOfStream)
{
    Console.WriteLine(reader.ReadLine());  
} 
```

执行：

```
public class ReverseTextReader
{
    private const int LineFeedLf = 10;
    private const int LineFeedCr = 13;
    private readonly Stream _stream;
    private readonly Encoding _encoding;

    public bool EndOfStream => _stream.Position == 0;

    public ReverseTextReader(Stream stream, Encoding encoding)
    {
        _stream = stream;
        _encoding = encoding;
        _stream.Position = _stream.Length;
    }

    public string ReadLine()
    {
        if (_stream.Position == 0) return null;

        var line = new List<byte>();
        var endOfLine = false;
        while (!endOfLine)
        {
            var b = _stream.ReadByteFromBehind();

            if (b == -1 || b == LineFeedLf)
            {
                endOfLine = true;
            } 
            line.Add(Convert.ToByte(b));
        }

        line.Reverse();
        return _encoding.GetString(line.ToArray());
    }
}

public static class StreamExtensions
{
    public static int ReadByteFromBehind(this Stream stream)
    {
        if (stream.Position == 0) return -1;

        stream.Position = stream.Position - 1;
        var value = stream.ReadByte();
        stream.Position = stream.Position - 1;
        return value;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-17T07:40:59.587

您可以一次向后读取文件一个字符并缓存所有字符，直到您到达回车和/或换行符。

然后，您反转收集的字符串并将其作为一条线大喊大叫。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-01T21:00:07.943

这里已经有很好的答案，这是另一个您可以使用的与 LINQ 兼容的类，它侧重于性能和对大文件的支持。它假定一个 "\r\n" 行终止符。

**用法**：

```
var reader = new ReverseTextReader(@"C:\Temp\ReverseTest.txt");
while (!reader.EndOfStream)
    Console.WriteLine(reader.ReadLine()); 
```

**ReverseTextReader 类**：

```
/// <summary>
/// Reads a text file backwards, line-by-line.
/// </summary>
/// <remarks>This class uses file seeking to read a text file of any size in reverse order.  This
/// is useful for needs such as reading a log file newest-entries first.</remarks>
public sealed class ReverseTextReader : IEnumerable<string>
{
    private const int BufferSize = 16384;   // The number of bytes read from the uderlying stream.
    private readonly Stream _stream;        // Stores the stream feeding data into this reader
    private readonly Encoding _encoding;    // Stores the encoding used to process the file
    private byte[] _leftoverBuffer;         // Stores the leftover partial line after processing a buffer
    private readonly Queue<string> _lines;  // Stores the lines parsed from the buffer

    #region Constructors

    /// <summary>
    /// Creates a reader for the specified file.
    /// </summary>
    /// <param name="filePath"></param>
    public ReverseTextReader(string filePath)
        : this(new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read), Encoding.Default)
    { }

    /// <summary>
    /// Creates a reader using the specified stream.
    /// </summary>
    /// <param name="stream"></param>
    public ReverseTextReader(Stream stream)
        : this(stream, Encoding.Default)
    { }

    /// <summary>
    /// Creates a reader using the specified path and encoding.
    /// </summary>
    /// <param name="filePath"></param>
    /// <param name="encoding"></param>
    public ReverseTextReader(string filePath, Encoding encoding)
        : this(new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read), encoding)
    { }

    /// <summary>
    /// Creates a reader using the specified stream and encoding.
    /// </summary>
    /// <param name="stream"></param>
    /// <param name="encoding"></param>
    public ReverseTextReader(Stream stream, Encoding encoding)
    {          
        _stream = stream;
        _encoding = encoding;
        _lines = new Queue<string>(128);            
        // The stream needs to support seeking for this to work
        if(!_stream.CanSeek)
            throw new InvalidOperationException("The specified stream needs to support seeking to be read backwards.");
        if (!_stream.CanRead)
            throw new InvalidOperationException("The specified stream needs to support reading to be read backwards.");
        // Set the current position to the end of the file
        _stream.Position = _stream.Length;
        _leftoverBuffer = new byte[0];
    }

    #endregion

    #region Overrides

    /// <summary>
    /// Reads the next previous line from the underlying stream.
    /// </summary>
    /// <returns></returns>
    public string ReadLine()
    {
        // Are there lines left to read? If so, return the next one
        if (_lines.Count != 0) return _lines.Dequeue();
        // Are we at the beginning of the stream? If so, we're done
        if (_stream.Position == 0) return null;

        #region Read and Process the Next Chunk

        // Remember the current position
        var currentPosition = _stream.Position;
        var newPosition = currentPosition - BufferSize;
        // Are we before the beginning of the stream?
        if (newPosition < 0) newPosition = 0;
        // Calculate the buffer size to read
        var count = (int)(currentPosition - newPosition);
        // Set the new position
        _stream.Position = newPosition;
        // Make a new buffer but append the previous leftovers
        var buffer = new byte[count + _leftoverBuffer.Length];
        // Read the next buffer
        _stream.Read(buffer, 0, count);
        // Move the position of the stream back
        _stream.Position = newPosition;
        // And copy in the leftovers from the last buffer
        if (_leftoverBuffer.Length != 0)
            Array.Copy(_leftoverBuffer, 0, buffer, count, _leftoverBuffer.Length);
        // Look for CrLf delimiters
        var end = buffer.Length - 1;
        var start = buffer.Length - 2;
        // Search backwards for a line feed
        while (start >= 0)
        {
            // Is it a line feed?
            if (buffer[start] == 10)
            {
                // Yes.  Extract a line and queue it (but exclude the \r\n)
                _lines.Enqueue(_encoding.GetString(buffer, start + 1, end - start - 2));
                // And reset the end
                end = start;
            }
            // Move to the previous character
            start--;
        }
        // What's left over is a portion of a line. Save it for later.
        _leftoverBuffer = new byte[end + 1];
        Array.Copy(buffer, 0, _leftoverBuffer, 0, end + 1);
        // Are we at the beginning of the stream?
        if (_stream.Position == 0)
            // Yes.  Add the last line.
            _lines.Enqueue(_encoding.GetString(_leftoverBuffer, 0, end - 1));

        #endregion

        // If we have something in the queue, return it
        return _lines.Count == 0 ? null : _lines.Dequeue();
    }

    #endregion

    #region IEnumerator<string> Interface

    public IEnumerator<string> GetEnumerator()
    {
        string line;
        // So long as the next line isn't null...
        while ((line = ReadLine()) != null)
            // Read and return it.
            yield return line;
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        throw new NotImplementedException();
    }

    #endregion
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-09T19:52:31.063

我知道这篇文章很老了，但由于我找不到如何使用投票最多的解决方案，我终于找到了这个：这是我在 VB 和 C# 中找到的具有低内存成本的最佳答案

[http://www.blakepell.com/2010-11-29-backward-file-reader-vb-csharp-source](http://www.blakepell.com/2010-11-29-backward-file-reader-vb-csharp-source)

希望，我会帮助其他人，因为我花了几个小时才终于找到这篇文章！

[编辑]

这是c#代码：

```
//*********************************************************************************************************************************
//
//             Class:  BackwardReader
//      Initial Date:  11/29/2010
//     Last Modified:  11/29/2010
//     Programmer(s):  Original C# Source - the_real_herminator
//                     http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/9acdde1a-03cd-4018-9f87-6e201d8f5d09
//                     VB Converstion - Blake Pell
//
//*********************************************************************************************************************************

using System.Text;
using System.IO;
public class BackwardReader
{
    private string path;
    private FileStream fs = null;
    public BackwardReader(string path)
    {
        this.path = path;
        fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
        fs.Seek(0, SeekOrigin.End);
    }
    public string Readline()
    {
        byte[] line;
        byte[] text = new byte[1];
        long position = 0;
        int count;
        fs.Seek(0, SeekOrigin.Current);
        position = fs.Position;
        //do we have trailing rn?
        if (fs.Length > 1)
        {
            byte[] vagnretur = new byte[2];
            fs.Seek(-2, SeekOrigin.Current);
            fs.Read(vagnretur, 0, 2);
            if (ASCIIEncoding.ASCII.GetString(vagnretur).Equals("rn"))
            {
                //move it back
                fs.Seek(-2, SeekOrigin.Current);
                position = fs.Position;
            }
        }
        while (fs.Position > 0)
        {
            text.Initialize();
            //read one char
            fs.Read(text, 0, 1);
            string asciiText = ASCIIEncoding.ASCII.GetString(text);
            //moveback to the charachter before
            fs.Seek(-2, SeekOrigin.Current);
            if (asciiText.Equals("n"))
            {
                fs.Read(text, 0, 1);
                asciiText = ASCIIEncoding.ASCII.GetString(text);
                if (asciiText.Equals("r"))
                {
                    fs.Seek(1, SeekOrigin.Current);
                    break;
                }
            }
        }
        count = int.Parse((position - fs.Position).ToString());
        line = new byte[count];
        fs.Read(line, 0, count);
        fs.Seek(-count, SeekOrigin.Current);
        return ASCIIEncoding.ASCII.GetString(line);
    }
    public bool SOF
    {
        get
        {
            return fs.Position == 0;
        }
    }
    public void Close()
    {
        fs.Close();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-14T10:51:47.180

我想做类似的事情。这是我的代码。此类将创建包含大文件块的临时文件。这将避免内存膨胀。用户可以指定她/他是否想要反转文件。因此，它将以相反的方式返回内容。

此类也可用于在单个文件中写入大数据，而不会导致内存膨胀。

请提供反馈。

```
 using System;
        using System.Collections.Generic;
        using System.Diagnostics;
        using System.IO;
        using System.Linq;
        using System.Text;
        using System.Threading.Tasks;

        namespace BigFileService
        {    
            public class BigFileDumper
            {
                /// <summary>
                /// Buffer that will store the lines until it is full.
                /// Then it will dump it to temp files.
                /// </summary>
                public int CHUNK_SIZE = 1000;
                public bool ReverseIt { get; set; }
                public long TotalLineCount { get { return totalLineCount; } }
                private long totalLineCount;
                private int BufferCount = 0;
                private StreamWriter Writer;
                /// <summary>
                /// List of files that would store the chunks.
                /// </summary>
                private List<string> LstTempFiles;
                private string ParentDirectory;
                private char[] trimchars = { '/', '\\'};

                public BigFileDumper(string FolderPathToWrite)
                {
                    this.LstTempFiles = new List<string>();
                    this.ParentDirectory = FolderPathToWrite.TrimEnd(trimchars) + "\\" + "BIG_FILE_DUMP";
                    this.totalLineCount = 0;
                    this.BufferCount = 0;
                    this.Initialize();
                }

                private void Initialize()
                {
                    // Delete existing directory.
                    if (Directory.Exists(this.ParentDirectory))
                    {
                        Directory.Delete(this.ParentDirectory, true);
                    }

                    // Create a new directory.
                    Directory.CreateDirectory(this.ParentDirectory);
                }

                public void WriteLine(string line)
                {
                    if (this.BufferCount == 0)
                    {
                        string newFile = "DumpFile_" + LstTempFiles.Count();
                        LstTempFiles.Add(newFile);
                        Writer = new StreamWriter(this.ParentDirectory + "\\" + newFile);
                    }
                    // Keep on adding in the buffer as long as size is okay.
                    if (this.BufferCount < this.CHUNK_SIZE)
                    {
                        this.totalLineCount++; // main count
                        this.BufferCount++; // Chunk count.
                        Writer.WriteLine(line);
                    }
                    else
                    {
                        // Buffer is full, time to create a new file.
                        // Close the existing file first.
                        Writer.Close();
                        // Make buffer count 0 again.
                        this.BufferCount = 0;
                        this.WriteLine(line);
                    }
                }

                public void Close()
                {
                    if (Writer != null)
                        Writer.Close();
                }

                public string GetFullFile()
                {
                    if (LstTempFiles.Count <= 0)
                    {
                        Debug.Assert(false, "There are no files created.");
                        return "";
                    }
                    string returnFilename = this.ParentDirectory + "\\" + "FullFile";
                    if (File.Exists(returnFilename) == false)
                    {
                        // Create a consolidated file from the existing small dump files.
                        // Now this is interesting. We will open the small dump files one by one.
                        // Depending on whether the user require inverted file, we will read them in descending order & reverted, 
                        // or ascending order in normal way.

                        if (this.ReverseIt)
                            this.LstTempFiles.Reverse();

                        foreach (var fileName in LstTempFiles)
                        {
                            string fullFileName = this.ParentDirectory + "\\" + fileName;
// FileLines will use small memory depending on size of CHUNK. User has control.
                            var fileLines = File.ReadAllLines(fullFileName);

                            // Time to write in the writer.
                            if (this.ReverseIt)
                                fileLines = fileLines.Reverse().ToArray();

                            // Write the lines 
                            File.AppendAllLines(returnFilename, fileLines);
                        }
                    }

                    return returnFilename;
                }
            }
        } 
```

此服务可按如下方式使用 -

```
void TestBigFileDump_File(string BIG_FILE, string FOLDER_PATH_FOR_CHUNK_FILES)
        {
            // Start processing the input Big file.
            StreamReader reader = new StreamReader(BIG_FILE);
            // Create a dump file class object to handle efficient memory management.
            var bigFileDumper = new BigFileDumper(FOLDER_PATH_FOR_CHUNK_FILES);
            // Set to reverse the output file.
            bigFileDumper.ReverseIt = true;
            bigFileDumper.CHUNK_SIZE = 100; // How much at a time to keep in RAM before dumping to local file.

            while (reader.EndOfStream == false)
            {
                string line = reader.ReadLine();
                bigFileDumper.WriteLine(line);
            }
            bigFileDumper.Close();
            reader.Close();

            // Get back full reversed file.
            var reversedFilename = bigFileDumper.GetFullFile();
            Console.WriteLine("Check output file - " + reversedFilename);
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-23T21:13:20.643

万一其他人遇到这个问题，我用下面的 PowerShell 脚本解决了这个问题，只需少量的努力就可以轻松地将其修改为 C# 脚本。

```
[System.IO.FileStream]$fileStream = [System.IO.File]::Open("C:\Name_of_very_large_file.log", [System.IO.FileMode]::Open, [System.IO.FileAccess]::Read, [System.IO.FileShare]::ReadWrite)
[System.IO.BufferedStream]$bs = New-Object System.IO.BufferedStream $fileStream;
[System.IO.StreamReader]$sr = New-Object System.IO.StreamReader $bs;

$buff = New-Object char[] 20;
$seek = $bs.Seek($fileStream.Length - 10000, [System.IO.SeekOrigin]::Begin);

while(($line = $sr.ReadLine()) -ne $null)
{
     $line;
} 
```

这基本上从文件的最后 10,000 个字符开始读取，输出每一行。

# macos - 什么是适用于 MacOS 的优秀图形编辑器？

> ID：452905
> 
> 赞同：5
> 
> 时间：2009-01-17T06:33:34.963
> 
> 标签：macos, editor, graph-theory

我需要某种节点图编辑器，希望它可以在 Mac 和其他平台上运行，以生成用户创建的具有属性的节点集合。然后，图形数据将用于我正在开发的数据驱动的应用程序中，如果应用程序可以以某种易于处理的格式保存图形，则值得称赞。到目前为止，我使用 XML 和树编辑器，但由于图形可以根据要求循环，树编辑器不再剪切它。

其他应用程序的插件也可以！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T06:52:55.160

[GraphViz](http://www.graphviz.org/)的图形绘图软件几乎是最好的，跨平台的，具有非常简单的文件格式和大量的输出格式。它在自动计算图形布局方面特别好。[OS X](http://www.pixelglow.com/graphviz/)的GUI可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T06:40:21.940

看看 Yed ( [http://www.yworks.com/en/products_yed_about.html](http://www.yworks.com/en/products_yed_about.html) )，免费使用，但在所有输出上放置一个徽标。

它带有 Mac OS 二进制文件 .. 并且您可以将它基于的图形引擎包含（需要 $$）到您的项目中。

我用它（成功有限）来 [记录企业数据流](https://stackoverflow.com/questions/258554/how-would-you-display-layout-data-flow-between-enterprise-applications)..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T04:13:11.237

您可能想用 JHotdraw（在 sourceforge）做点什么。它是从 Smalltalk 转换而来的设计模式演示项目之一。它（或者在它被放到科幻小说之前）有很好的文档记录并且易于扩展。Eclipse 中的 GEF 是一个类似（但文档较少）的框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-12T14:26:14.537

你可以看看 OmniGraffle：[http ://www.omnigroup.com/omnigraffle](http://www.omnigroup.com/omnigraffle)

# .net - .Net 中的 Google V8 Javascript 引擎？

> ID：452917
> 
> 赞同：4
> 
> 时间：2009-01-17T06:45:05.847
> 
> 标签：.net, javascript, v8

有没有人能够做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T07:39:56.437

检查这些问题：

*   [将 JavaScript 引擎嵌入 .NET (C#)](https://stackoverflow.com/questions/172753)
*   [从 .NET 应用程序引用 Google 的 V8 引擎](https://stackoverflow.com/questions/356948)

# entity-framework - 有没有办法将 .edmx 图从 VS2008 导出到 Visio？

> ID：452946
> 
> 赞同：32
> 
> 时间：2009-01-17T07:35:58.863
> 
> 标签：entity-framework, linq-to-entities, visio

有些人想看DB结构，没有VS，有没有办法做到这一点？或任何其他方式将其导出到屏幕截图之外（这是一个巨大的图表）。

谢谢你。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-17T07:46:02.947

您可以右键单击设计图面并选择图表 -> 导出为图像，您可以将整个 edmx 模型生成为 bmp

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-08-01T18:02:15.520

这实际上不适用于大型图表。哦，它会导出它，但是在大图上，一旦放大，所有文本都只是像素。这是一个已记录的错误，但目前 Microsoft 不打算修复此问题。

我所做的是下载 pdf 打印机（如 Bullzip 免费版），然后将文档“打印”为 pdf。

对维索来说，没有。我还没有找到将其导出到 Visio 的方法。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-01-19T22:29:40.867

有一个**PDF**生成解决方案*（如果您有大图表，则适用）*：

您可以从 Visual Studio 执行此操作：

1.  `File > Print`
2.  发送到`OneNote`或选择`PDF`。

# cocoa-touch - 限制 UIWebView 中的用户交互

> ID：452961
> 
> 赞同：2
> 
> 时间：2009-01-17T07:58:18.133
> 
> 标签：cocoa-touch

我想限制用户使用 UIWebView 中的链接。因此，只显示一个没有导航的 HTML 页面。

我知道我可以使用 UIWebView 的“用户交互”选项来做到这一点，但我不能使用它，因为它也会禁用滚动，并且用户无法查看完整的页面。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T15:48:46.707

我的情况要求用户真的只能查看页面，而不能进行交互（特别是在复制内容方面——这是一个安全问题）。这是我所做的：

```
for (UIView *thisView in webView.scrollView.subviews)
{
    thisView.userInteractionEnabled = NO;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T08:25:09.467

如果您不介意他们看到链接，您可以使用[UIWebViewDelegate](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIWebViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIWebViewDelegate)来检测页面何时开始加载并取消它。

如果您根本不希望他们看到链接，您可以在呈现之前修改 HTML。使用 libxml 非常[简单](http://welcome.totheinter.net/2008/03/11/adding-the-libxml-framework-to-your-iphone-app/)，它的 htmlparser.h 可能可以满足您的需求。如果您不喜欢这样，[HTML tidy](http://tidy.sourceforge.net/)也可以很好地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-19T02:50:58.797

您可以将 WKWebView 包装在 UIView 中，然后设置`webViewWrapper.isUserInteractionEnabled = false`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-09T18:08:06.580

禁用带有链接的导航

```
 func webView(_ webView: WKWebView, didStartProvisionalNavigation navigation: WKNavigation!) {

    webView.stopLoading()

} 
```

# java - python 是否具有与 Java Class.forName() 等效的功能？

> ID：452969
> 
> 赞同：101
> 
> 时间：2009-01-17T08:10:48.980
> 
> 标签：java, python, class, instantiation

我需要接受一个字符串参数并在 Python 中创建一个以该字符串命名的类的对象。在 Java 中，我会使用`Class.forName().newInstance()`. Python中是否有等价物？

* * *

感谢您的回复。回答那些想知道我在做什么的人：我想使用命令行参数作为类名，并实例化它。我实际上是在 Jython 中编程并实例化 Java 类，因此问题的 Java 特性。 `getattr()`效果很好。非常感谢。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-01-17T08:25:39.370

python中的反射比Java中的反射要容易得多，也灵活得多。

我建议阅读本[教程](http://www.diveintopython.net/power_of_introspection/index.html)

没有直接函数（我知道）它采用完全限定的类名并返回该类，但是您拥有构建它所需的所有部分，并且可以将它们连接在一起。

不过有一点建议：当你在 python 中时，不要尝试用 Java 风格编程。

如果你能解释你正在尝试做什么，也许我们可以帮助你找到一种更 Pythonic 的方式来做这件事。

这是一个可以满足您要求的功能：

```
def get_class( kls ):
    parts = kls.split('.')
    module = ".".join(parts[:-1])
    m = __import__( module )
    for comp in parts[1:]:
        m = getattr(m, comp)            
    return m 
```

您可以像使用类本身一样使用此函数的返回值。

这是一个使用示例：

```
>>> D = get_class("datetime.datetime")
>>> D
<type 'datetime.datetime'>
>>> D.now()
datetime.datetime(2009, 1, 17, 2, 15, 58, 883000)
>>> a = D( 2010, 4, 22 )
>>> a
datetime.datetime(2010, 4, 22, 0, 0)
>>> 
```

**这是如何运作的？**

我们`__import__`用于导入包含该类的模块，这要求我们首先从完全限定名称中提取模块名称。然后我们导入模块：

```
m = __import__( module ) 
```

在这种情况下，`m`只会引用顶层模块，

例如，如果您的类位于`foo.baz`模块中，那么`m`将是模块`foo`
我们可以很容易地获得使用的`foo.baz`引用`getattr( m, 'baz' )`

要从顶级模块到类，必须递归地使用`gettatr`类名的部分

例如，如果您的班级名称是，`foo.baz.bar.Model`那么我们这样做：

```
m = __import__( "foo.baz.bar" ) #m is package foo
m = getattr( m, "baz" ) #m is package baz
m = getattr( m, "bar" ) #m is module bar
m = getattr( m, "Model" ) #m is class Model 
```

这就是这个循环中发生的事情：

```
for comp in parts[1:]:
    m = getattr(m, comp) 
```

在循环结束时，`m`将是对该类的引用。这意味着这`m`实际上是类 itslef，例如，您可以这样做：

```
a = m() #instantiate a new instance of the class    
b = m( arg1, arg2 ) # pass arguments to the constructor 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-17T08:13:05.857

假设课程在您的范围内：

```
globals()['classname'](args, to, constructor) 
```

除此以外：

```
getattr(someModule, 'classname')(args, to, constructor) 
```

编辑：注意，你不能给 getattr 取一个像 'foo.bar' 这样的名字。您需要将其拆分为 . 并从左到右在每个部分上调用 getattr()。这将处理：

```
module, rest = 'foo.bar.baz'.split('.', 1)
fooBar = reduce(lambda a, b: getattr(a, b), rest.split('.'), globals()[module])
someVar = fooBar(args, to, constructor) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-05-05T01:00:38.220

```
def import_class_from_string(path):
    from importlib import import_module
    module_path, _, class_name = path.rpartition('.')
    mod = import_module(module_path)
    klass = getattr(mod, class_name)
    return klass 
```

## 用法

```
In [59]: raise import_class_from_string('google.appengine.runtime.apiproxy_errors.DeadlineExceededError')()
---------------------------------------------------------------------------
DeadlineExceededError                     Traceback (most recent call last)
<ipython-input-59-b4e59d809b2f> in <module>()
----> 1 raise import_class_from_string('google.appengine.runtime.apiproxy_errors.DeadlineExceededError')()

DeadlineExceededError: 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-31T14:41:58.940

又一个实现。

```
def import_class(class_string):
    """Returns class object specified by a string.

    Args:
        class_string: The string representing a class.

    Raises:
        ValueError if module part of the class is not specified.
    """
    module_name, _, class_name = class_string.rpartition('.')
    if module_name == '':
        raise ValueError('Class name must contain module part.')
    return getattr(
        __import__(module_name, globals(), locals(), [class_name], -1),
        class_name) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T15:37:40.733

看来您是从中间而不是从头开始处理的。你真正想做什么？找到与给定字符串关联的类是达到目的的一种手段。

如果你澄清你的问题，这可能需要你自己的精神重构，一个更好的解决方案可能会出现。

例如：您是否尝试根据类型名称和一组参数加载已保存的对象？Python 拼写了这种 unpickling，您应该查看[pickle 模块](http://docs.python.org/library/pickle.html)。即使 unpickling 过程完全按照您的描述进行，您也不必担心它在内部是如何工作的：

```
>>> class A(object):
...   def __init__(self, v):
...     self.v = v
...   def __reduce__(self):
...     return (self.__class__, (self.v,))
>>> a = A("example")
>>> import pickle
>>> b = pickle.loads(pickle.dumps(a))
>>> a.v, b.v
('example', 'example')
>>> a is b
False 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-10T23:54:55.637

这可以在 python 标准库中找到，作为 unittest.TestLoader.loadTestsFromName。不幸的是，该方法继续执行其他与测试相关的活动，但第一个 ha 看起来可重用。我对其进行了编辑以删除与测试相关的功能：

```
def get_object(name):
    """Retrieve a python object, given its dotted.name."""
    parts = name.split('.')
    parts_copy = parts[:]
    while parts_copy:
        try:
            module = __import__('.'.join(parts_copy))
            break
        except ImportError:
            del parts_copy[-1]
            if not parts_copy: raise
    parts = parts[1:]

    obj = module
    for part in parts:
        parent, obj = obj, getattr(obj, part)

    return obj 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-18T10:37:39.730

我需要获取所有现有类的对象`my_package`。所以我将所有必要的类导入到`my_package`'s`__init__.py`中。

所以我的目录结构是这样的：

```
/my_package
    - __init__.py
    - module1.py
    - module2.py
    - module3.py 
```

我的`__init__.py`样子是这样的：

```
from .module1 import ClassA
from .module2 import ClassB 
```

然后我创建一个这样的函数：

```
def get_classes_from_module_name(module_name):
    return [_cls() for _, _cls in inspect.getmembers(__import__(module_name), inspect.isclass)] 
```

在哪里`module_name = 'my_package'`

检查文档：[https ://docs.python.org/3/library/inspect.html#inspect.getmembers](https://docs.python.org/3/library/inspect.html#inspect.getmembers)

# php - 来自 PHP 的二维数组值

> ID：452972
> 
> 赞同：2
> 
> 时间：2009-01-17T08:17:19.950
> 
> 标签：php, javascript, arrays, multidimensional-array

我有一个 PHP 文件，它将用 JavaScript 编写一个二维数组：

```
<?php
    print "<script language='javascript'>";
    print " extra[0][0] = new Array(1,'Bob',12);";
    print " extra[0][1] = new Array(2,'Alice',18);";
      ..
    // Need to assign the extra[1][0], extra[1][1] and so on.
    print "</script>";
 ?> 
```

### 穆.js：

```
 var extra =  new Array();
  ... 
```

如何将二维数组从 PHP 分配给 JavaScript 变量？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-17T08:25:24.613

`json_encode`是你的朋友：[PHP 手册中的 json_encode](http://nl3.php.net/json_encode)

```
 <script type="text/javascript">
  var jsArray = <?= json_encode($my_array) ?>;
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-19T22:04:02.173

是的，wvanbergen 是对的，json_encode 是你的朋友。您可以将数组创建为 JSON：

```
<?php
    $extra = array(
      array(1,'Bob',12),
      array(2,'Alice',18)
      );

    echo "var extra = " . json_encode($extra) . ";";
?> 
```

在您的 javascript 中，它将输出：

```
var extra = [[1,"Bob",12],[2,"Alice",18]]; 
```

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-01-21T09:48:21.817

```
<script type="text/javascript">
 var jsArray = <?php json_encode($my_array); ?>;
</script> 
```

# c# - NUnit2.4.8中range属性属于哪个命名空间

> ID：452983
> 
> 赞同：0
> 
> 时间：2009-01-17T08:25:53.833
> 
> 标签：c#, .net, nunit

NUnit2.4.8中range属性属于哪个命名空间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T16:27:07.340

您所指的属性在 中定义`NUnit.Framework`，这是 NUnit 中测试装置的默认命名空间。

我认为你在这里感到困惑的原因是它`RangeAttribute`是在 NUnit 2.5 版中添加的，所以你不会在 2.4.x 版中找到它。

# asp.net-mvc - 确定简单 ASP.NET MVC 站点所需控制器的最佳实践？

> ID：452987
> 
> 赞同：0
> 
> 时间：2009-01-17T08:29:52.483
> 
> 标签：asp.net-mvc

我正在使用 ASP.NET MVC 框架，试图创建一个简单的站点。

我的模型本质上是：-问题-答案-类别

由于每个问题必须属于一个类别并且每个答案必须属于一个问题 - 将“类别”拆分为它自己的控制器是否正确？

创建 /Question/Category/List 的控制器路径有什么不正确的？

另外，如果我想创建一个搜索 - 我是否创建一个名为“搜索”的控制器并像这样使用：/Search/Question/、/Search/Answer/？还是我使用“/问题/搜索/”？

提前感谢您的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T08:48:20.060

以下是有关分组控制器的阅读内容 [Grouping Conrollers](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)

以上内容与您的问题没有直接关系，但可能有用。

现在关于你的问题，我会这样说..（这只是一种方式）..

我最初对此的看法...

- 用于问题和类别

*   /问题/询问
*   /问题/编辑/{id}
*   /问题/列表
*   /问题/搜索/{条件}

*   /类别/创建

*   /类别/编辑/{id}
*   /类别/列表

- 为答案

*   /问题/答案/{questionid}
*   /问题/答案/搜索/
*   /问题/答案/列表/组/问题

另一种方法是将控制器与管理员和访客功能分开。将所有管理逻辑（如创建/更新/）放在一个控制器中，并将剩余逻辑拆分到其他控制器中。对此可能有 +/- 论据。但这是个人意见。

笔记：

1.  类别可以独立于问题而存在
2.  一个问题与一个或多个类别相关联
3.  答案属于一个问题，不能独立存在。

*** 这个例子突然出现在我的脑海中，可能不是最佳实践，但可能只是给一些思考的要点。:)。随意应用你的想法。

# wpf - 在 WPF 中滑动面板的最佳方法是什么？

> ID：452988
> 
> 赞同：11
> 
> 时间：2009-01-17T08:30:06.163
> 
> 标签：wpf, performance, xaml, animation

我制作了一个相当简单的 UserControl（请原谅我的 Xaml，我只是在学习 WPF），我想将它滑出屏幕。为此，我正在为平移变换设置动画（我还尝试将面板设置为画布的子项，并以相同的结果设置 X 位置的动画），但面板移动非常不稳定，即使在相当快的新计算机上也是如此。什么是滑入和滑出的最佳方法（最好使用 KeySplines 以便它随着惯性移动）而不会产生急动。我的面板上只有8个按钮，所以我认为不会有太大问题。

这是我正在使用的 Xaml，它在 Kaxaml 中运行良好，但非常不稳定和缓慢（以及在 WPF 应用程序中编译运行时非常不稳定和缓慢）。

```
 <UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Width="1002" Height="578">
     <UserControl.Resources>            
        <Style TargetType="Button">
           <Setter Property="Control.Padding" Value="4"/>
           <Setter Property="Control.Margin" Value="10"/>
           <Setter Property="Control.Template">
              <Setter.Value>
                 <ControlTemplate TargetType="Button">
                    <Grid Name="backgroundGrid" Width="210" Height="210" Background="#00FFFFFF">
                       <Grid.BitmapEffect>
                          <BitmapEffectGroup>
                             <DropShadowBitmapEffect x:Name="buttonDropShadow" ShadowDepth="2"/>
                             <OuterGlowBitmapEffect x:Name="buttonGlow" GlowColor="#A0FEDF00" GlowSize="0"/>
                          </BitmapEffectGroup>
                       </Grid.BitmapEffect>
                       <Border x:Name="background" Margin="1,1,1,1" CornerRadius="15">
                          <Border.Background>
                             <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <LinearGradientBrush.GradientStops>
                                   <GradientStop Offset="0" Color="#FF0062B6"/>
                                   <GradientStop Offset="1" Color="#FF0089FE"/>
                                </LinearGradientBrush.GradientStops>
                             </LinearGradientBrush>
                          </Border.Background>
                       </Border>
                       <Border Margin="1,1,1,0" BorderBrush="#FF000000" BorderThickness="1.5" CornerRadius="15"/>
                       <ContentPresenter HorizontalAlignment="Center" Margin="{TemplateBinding Control.Padding}" 
                        VerticalAlignment="Center" Content="{TemplateBinding ContentControl.Content}" 
                        ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"/>
                    </Grid>
                 </ControlTemplate>
              </Setter.Value>
           </Setter>
        </Style>
     </UserControl.Resources>
     <Canvas>
        <Grid x:Name="Panel1" Height="578" Canvas.Left="0" Canvas.Top="0">
           <Grid.RenderTransform>
              <TransformGroup>
                 <TranslateTransform x:Name="panelTranslate" X="0" Y="0"/>
              </TransformGroup>
           </Grid.RenderTransform>
           <Grid.RowDefinitions>
              <RowDefinition Height="287"/>
              <RowDefinition Height="287"/>
           </Grid.RowDefinitions>
           <Grid.ColumnDefinitions>
              <ColumnDefinition x:Name="Panel1Col1"/>
              <ColumnDefinition x:Name="Panel1Col2"/>
              <ColumnDefinition x:Name="Panel1Col3"/>
              <ColumnDefinition x:Name="Panel1Col4"/>
     <!-- Set width to 0 to hide a column-->
           </Grid.ColumnDefinitions>
           <Button x:Name="Panel1Product1" Grid.Column="0" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center">
              <Button.Triggers>
                 <EventTrigger RoutedEvent="Button.Click" SourceName="Panel1Product1">
                    <EventTrigger.Actions>
                       <BeginStoryboard>
                          <Storyboard>
                             <DoubleAnimation BeginTime="00:00:00.6" Duration="0:0:3" From="0" Storyboard.TargetName="panelTranslate" Storyboard.TargetProperty="X" To="-1000"/>
                          </Storyboard>
                       </BeginStoryboard>
                    </EventTrigger.Actions>
                 </EventTrigger>
              </Button.Triggers>
           </Button>
           <Button x:Name="Panel1Product2" Grid.Column="0" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product3" Grid.Column="1" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product4" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product5" Grid.Column="2" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product6" Grid.Column="2" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product7" Grid.Column="3" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
           <Button x:Name="Panel1Product8" Grid.Column="3" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"/>
        </Grid>
     </Canvas>
  </UserControl> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T16:36:56.067

到目前为止，看起来最好的解决方案是使用视觉画笔并在滑入和滑出面板时移动两个静态图像。此博客文章中描述了与此类似的内容：

[在 WPF 应用程序中使用动画导航页面](https://web.archive.org/web/20091231041128/http://www.japf.fr/2008/07/8/comment-page-1/)（切换到 Web 存档，但这是从 2008 年开始的，因此无法保证它是否仍然是最佳技术）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T16:19:21.693

我发现不使用`BitmapEffect`s. 尝试在您的示例中禁用它们。我用带有渐变填充的半透明实体区域替换了我的阴影，并提高了性能。

我还听说一些位图效果在较新的版本（可能是 3.5 SP1？）中提高了性能，因为更多的渲染被推到了硬件上。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T08:43:49.647

如果您使用 WPF 动画的时间足够长，您会发现大面积控件实际上会以您所谓的“生涩”方式移动。即使是需要在屏幕上水平移动的小按钮，我也遇到过这个问题，而且我当然已经放弃了移动任何大的东西（例如，一个窗口）。

# windows - windows中程序文件目录的作用是什么？

> ID：452997
> 
> 赞同：0
> 
> 时间：2009-01-17T08:40:29.747
> 
> 标签：windows, installation

我想知道这是因为我们正在开发一个应用程序，安装后一些文件被复制到程序文件和一些用户配置文件目录。但是，我们在程序文件中发现了一些问题。现在所有文件都安装在当前用户的目录中。即使是谷歌浏览器，也是如此。你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T08:44:28.803

如果您在 10 个不同的帐户上安装给定的应用程序，您真的希望该应用程序在磁盘上存在 10 次吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T08:48:39.357

程序文件目录仅用于此，可执行文件、dll、程序集和其他可执行代码以及与程序关联的不可编辑的配置数据。用户配置文件目录用于存放与个人用户相关的数据和代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T07:10:38.230

Windows 中的**程序**文​​件目录是所有已安装文件所在的位置。但是根据用户需要进行一些自定义。那些进入用户的目录。比如下载文件夹、Mozilla firefox、Winamp等的自定义。

每个用户必须有不同的配置文件才能自定义应用程序。但不需要在每个用户帐户中都安装一个软件的常用文件；因此它们安装在**程序文件中**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T08:48:19.060

自 Vista 以来，Program Files 目录已被标记为禁止访问，因此默认情况下应用程序无法写入该目录，除非获得管理员权限。

这是为了更好的安全性，以阻止其他应用程序操纵现有的已安装应用程序。

这里有一篇关于如何使用 UAC 以及学习编写更安全的应用程序的文章。

[http://msdn.microsoft.com/en-au/magazine/cc163486.aspx](http://msdn.microsoft.com/en-au/magazine/cc163486.aspx)```````***`***