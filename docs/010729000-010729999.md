# StackOverflow 问答 10729000-10729999

# c++ - 内存 DC 上的 SelectObject

> ID：10729004
> 
> 赞同：1
> 
> 时间：2012-05-23T22:57:32.963
> 
> 标签：c++, winapi, gdi

在我的程序中，我有一个我经常绘制的内存 DC，然后作为响应，`WM_PAINT`我迅速`BitBlt`将它显示在屏幕上。我一直都是这样画的，内存DC是为了响应`WM_CREATE`btw而创建的。

```
void Draw()
{
    HFONT hPrevFont = (HFONT)SelectObject(m_hMemDC, m_hFont);
    // draw text
    SelectObject(m_hMemDC, hPrevFont);
} 
```

哪个应该是正确的，我现在也发现我可以使用`SaveDC`并且`RestoreDC`为此（在拥有大量 GDI 对象时特别有用）

```
void Draw()
{
    int nSavedDC = SaveDC(m_hMemDC);
    SelectObject(m_hMemDC, m_hFont);
    // draw text
    RestoreDC(m_hMemDC, nSavedDC);
} 
```

现在我想知道在我创建它之后只保存DC的状态是否可以，并在我删除它时恢复它。像这样：

```
int OnCreate(...)
{
    m_hMemDC = CreateMemDC();
    m_nSavedDC = SaveDC(m_hMemDC);
}

void Draw()
{
    SelectObject(m_hMemDC, m_hFont);
    // draw text
}

void OnDestroy()
{
    RestoreDC(m_hMemDC, m_nSavedDC);
    DeleteMemDC(m_hMemDC);
} 
```

我认为这应该没问题，这不像其他人同时使用我的记忆DC。你怎么看？

哎呀，在这种情况下甚至有必要保存和恢复DC吗？

编辑：是的，我确实意识到我应该在删除字体之前先删除内存 DC（因为否则内存 DC 仍会使用它）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:26:44.697

危险在于，您可能会将选定的对象留在记忆 DC 中，一次只能由一个 DC 使用。传统上，您在绘制周期结束时从 DC 中取消选择对象，以便可以将对象选择到另一个 DC 中。如果您延迟取消选择，那么没有其他人可以使用该对象，因为它仍在您的 DC 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:07:04.203

我认为这没有问题。至于恢复你的 DC，我认为如果你不恢复默认对象，不正确的引用计数可能会造成内存泄漏。这只是基于 Microsoft 文档的猜测。

# sql-server - 获取自定义时间段的第一个或最后一个值

> ID：10729005
> 
> 赞同：3
> 
> 时间：2012-05-23T22:57:36.260
> 
> 标签：sql-server, ssas, mdx, olap, cube

首先，对 SSAS 来说非常陌生。但是我想要完成的事情似乎相当微不足道（我希望如此）。

我有第二个发生的事务数据。我创建了两个时间维度。一维基于使用时间维度向导的标准时间维度。另一个是由我自己的脚本生成的时间维度，我在其中记录了一天中的每一秒。

我已将我的事实表链接到我的维度并正确部署了我的多维数据集。在我的事实数据中，其中一个属性是价格。现在使用最小值和最大值，我已经能够获得在特定时间段内发生的最高价格和最低价格。我想获得的是一段时间内发生的第一个和最后一个价格。我尝试过使用“第一个值”和“最后一个值”，但返回的内容不正确，它似乎是某种聚合。

举个例子。如果我在 1 分钟内的价格是：

1233、1233.85、1300、1250

首先应该返回 1233，最后应该返回 1250。这应该在所有时间段都有效。

添加，对于我的自定义时间维度，我尝试将其类型设置为“时间”，但结果保持不变。我很感激任何建议。我基本上希望获得底层证券的第一个值和最后一个值。

让我了解其中的一部分的示例查询：

```
SELECT NON EMPTY 
     { [Measures].[High]
     , [Measures].[Low]
     , [Measures].[Price Count]
     , [Measures].[Price]
     } ON COLUMNS
     , NON EMPTY
     { [Dim Date].[Year -  Week -  Date].[Date].ALLMEMBERS
     * HEAD( [Dim Time].[Hour - Second].[Second].ALLMEMBERS )
     } ON ROWS 
FROM [Cube] 
```

![在此处输入图像描述](../Images/9dcb2937b983294dec14a3e15faf71ff.png)

请注意，价格计数列有多个记录。我需要这里的第一条记录，我不想要实际的总和。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T08:09:21.723

尝试创建一个新度量来获取时间维度第一秒的价格。例如，如果您想要一天的第一秒，则在行的交叉连接中不需要它，但您可以在计算度量中获取 [Hour - Second] 层次结构的第一秒：

```
with
    member [Measures].[First Price] as
        (head(descendants([Dim Time].[Hour - Second].CurrentMember, Second)), [Measures].[Price])
select
    non empty {
        [Measures].[High],
        [Measures].[Low],
        [Measures].[Price Count],
        [Measures].[Price] 
    } on columns,   
    {
        [Dim Date].[Year -  Week -  Date].[Date].ALLMEMBERS
    } on rows
from
    [Cube] 
```

如果您希望时间段更小，例如按小时，请尝试以下操作：

```
 non empty {
        [Dim Date].[Year -  Week -  Date].[Date].ALLMEMBERS * [Dim Time].[Hour - Second].[Hour]
    } on rows 
```

# c++ - 混合托管和非托管 C++ 代码？

> ID：10729008
> 
> 赞同：2
> 
> 时间：2012-05-23T22:57:46.120
> 
> 标签：c++, c++-cli

关于将托管 C++ 与非托管 C++ 混合使用，我有几个具体问题：

1.  如果我省略`ref`并`value`在类/结构声明中，这是否会自动使类/结构不受管理？还是我还需要包含`#pragma unmanaged`and`#pragma managed`指令？
2.  非托管和托管类型的兼容性如何？例如，我可以在托管类中有一个非托管对象，对吗？我可以将非托管类/结构传递给托管函数（即将 std::string 传递给托管函数）吗？

谢谢你的帮助，

亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:09:07.973

您不能拥有混合类型（包含托管对象的本机类，反之亦然）。可能的做法是在托管类中拥有指向本地类的指针，以及在`gcroot`本地类中使用模板包装的托管句柄​​。这是为了确保垃圾收集器永远不会尝试移动本机数据（这会破坏纯本机代码持有的指针）。

托管类型始终使用托管代码实现。如果原生类型调用托管类型，则它们必须使用托管代码实现。

`#pragma managed(push, off)`是强制将代码编译为本机的方法。这样做的几个原因：来自 C++ 编译器的更好的优化，不能被垃圾收集打断等。或者，您可以使用`/clr:pure`强制所有代码编译为托管，甚至`/clr:safe`做同样的事情，也使它是可验证的。

任何编译为托管的代码都可以接受本机和托管类型作为参数和返回值。并且该代码可以在托管类型、本机类型或自由（全局）函数中。

# perl - 将数组和标量传递给 Perl 子例程

> ID：10729015
> 
> 赞同：37
> 
> 时间：2012-05-23T22:58:26.893
> 
> 标签：perl, reference, subroutine

> **可能重复：** [如何将一个数组和一个字符串作为参数传递给函数？](https://stackoverflow.com/questions/10640982/how-do-pass-one-array-and-one-string-as-arguments-to-a-function)

我有一个函数或子例程，它将第一个参数作为数组接收，将第二个参数作为标量接收。例如，

```
sub calc {
    my @array = $_[0];
    my $scalar = $_[1];
    print @array, $scalar;
} 
```

问题是该函数使数组等于传入数组的第一个值，而标量成为传入数组的第二个值。当我希望第一个数组成为整个数组时，我不需要对数组进行深拷贝。例如，

```
my @array = ('51', 'M');
my $scalar = 21; 
```

和

```
calc(@array, $scalar) 
```

`51 M`将在我需要时打印`51 M 21`。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-05-23T23:03:00.437

您需要将其作为参考传递：

`calc(\@array, $scalar)`

然后访问它：`my @array = @{$_[0]};`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-23T23:07:11.330

要么使用对数组的引用作为第一个参数，要么反转参数，以便标量在前，数组在后：

```
sub reversed_args
{
   my($scalar, @array) = @_;
   # ...
   print @array, $scalar, "\n";
}

my @array = ('51', 'M');
my $scalar = 21;

reversed_args($scalar, @array); 
```

不要尝试[Perl](https://stackoverflow.com/questions/297034/why-are-perl-5s-function-prototypes-bad) [原型](http://www.perlmonks.org/?node_id=861966)（两篇文章，一篇关于 Stack Overflow，一篇关于[PerlMonks](https://en.wikipedia.org/wiki/PerlMonks)）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-23T23:04:58.913

将您的数组作为数组引用传递给 calc 子例程：

```
calc(\@array, $scalar); 
```

然后在您的 calc 子例程中，初始化输入参数，如下所示：

```
sub calc {
  my($array_ref, $scalar) = @_;

  foreach my $item (@$array_ref) {
    # process each item in the array ref
  }
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-05-23T23:04:54.340

您可以将对数组的引用传递给您的函数：

```
calc(\@array, $scalar); 
```

当您需要在子例程中访问 @array 的元素时，您可以这样做：

```
my $array = $_[0];

# access first element of array
print $array->[0]; 
```

编辑：由于这是对原始数组的引用，因此在子例程中所做的任何更改都将反映在原始数组中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T23:02:41.267

Perl 子例程中的参数列表只是一个平面数组。如果要传递不同的数组，则必须将其作为数组引用传递。

# android - Android：使用来自 SDCard 的图像填充图库

> ID：10729018
> 
> 赞同：0
> 
> 时间：2012-05-23T22:58:52.450
> 
> 标签：android, image, file

我正在尝试使用 SD 卡中文件夹中的图像填充图库视图。我在这里阅读了有关 Android Dev 的图库教程：http: [//developer.android.com/resources/tutorials/views/hello-gallery.html](http://developer.android.com/resources/tutorials/views/hello-gallery.html)，并且可以使用我项目的可绘制文件夹中的图像。

我的问题是：如何从 Environment.getExternalStorageDirectory()+File.separator+"MyPictureDirectory 文件夹中获取文件数组，然后将它们显示在图库中？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:19:41.610

试试下面的，

```
File file = new File( Environment.getExternalStorageDirectory()+File.separator+"MyPictureDirectory"+File.separator);
File imageList[] = file.listFiles();
for(int i=0;i<imageList.length;i++)
{
   //Add images in Gallery from imageList
} 
```

从文件路径设置图像：

```
File imgFile = new  File(imagefilepath);
if(imgFile.exists()){

    Bitmap myBitmap = BitmapFactory.decodeFile(imgFile.getAbsolutePath());

    ImageView myImage = (ImageView) findViewById(R.id.imageviewTest);
    myImage.setImageBitmap(myBitmap);

} 
```

# database - 随机选取尚未在连接表中的实体

> ID：10729020
> 
> 赞同：1
> 
> 时间：2012-05-23T22:59:08.403
> 
> 标签：database, performance, optimization

这似乎很有趣。

假设三个表 ,`users`和`items`一个连接表`users_items`。后者将`users.id`s 链接到`items.id`s。当表中有一行包含对 ( , )时，我们说用户`U`拥有项目。`I``users_items``U.id``I.id`

现在：我将如何随机选择特定用户**尚未拥有的**项目？

最可行的解决方案似乎是：

1.  收集所有项目`id`。
2.  收集`id`用户拥有的物品`U`。
3.  `id`从 #1 中生成的集合中删除步骤 #2中的所有s
4.  从结果集中选择随机元素（微不足道）

这是唯一理智的方法吗？是最优的吗？让我们假设这将是一个被大量使用的功能。而且每个表中的元素数量巨大。

有什么有趣的想法、想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:07:16.527

您可以使用左连接来生成用户当前不拥有的项目 ID 列表：

```
SELECT i.id
FROM items i 
LEFT JOIN users_items ui ON ( i.id = ui.item_id AND ui.users_id = 2 )
WHERE ui.item_id IS NULL; 
```

从这里，您可以从结果集中随机选择一个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:07:18.237

为什么不随机化 sql 以便在一个查询中完成。我不确定您使用的是 mysql、tsql 还是其他东西，但[这个问题](https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql)提到了使用`ORDER BY RAND() LIMIT 1`. 像这样的东西怎么样：

```
select i.itemName
from users as s
left join items as i
    on i.id not in 
        (select ui.itemID from users_items as ui where ui.userID = u.id)
order by rand()
limit 1 
```

# python - 使用 MongoDB 更正数据库结构

> ID：10729023
> 
> 赞同：2
> 
> 时间：2012-05-23T22:59:23.503
> 
> 标签：python, mongodb, pymongo

我有一个相当直接的数据库结构，我想用 MongoDB 创建。我的结构如下所示：

```
 {url: value,
     users: {user_id: value}} 
```

示例文档可能如下所示：

```
{'url': 'http://stackoverflow.com/', users: {'billy': 12, 'tommy': 2}} 
```

我正在使用 PyMongo 更新我的数据库并添加文档，如上所示。我可以成功地将数据添加到我的数据库中，但我似乎无法复制上述数据结构。

```
 for d in data:
        foo.update(
            {'id': d.get('url')}, 
            {'$addToSet' :{'users': {d.get('user'): 'NaN'}}},
            upsert=True) 
```

上面的代码插入但“用户”结构不是我想要的。我想：

```
users: {'billy': 'NaN', 'tommy': 'NaN'} 
```

我得到：

```
users : [ { 'billy' : "NaN" }, { 'tommy' : "NaN" } ] 
```

任何人都可以帮忙吗？谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:32:59.033

根据我上面的评论，我建议不要嵌入文档，而是使用数组。以下将运作良好：

```
{'url': 'http://stackoverflow.com/', 
 'users': [{'user': 'billy', 'value': 12},
           {'user': 'tommy', 'value': 2}} 
```

这样你就可以利用`$push`等`$pull`以及`$addToSet`. 对于后者，您可以像这样添加一个新用户：

```
foo.update({'url': d.get('url')}, {'$addToSet': {'users': {'user': 'john', 'value': 0}}}) 
```

现在假设您只想为给定用户增加一个值，您也可以轻松地做到这一点：

```
foo.update({'url': d.get('url'), 'users.user': 'tommy'}, {'$inc': {'users.$.value': 1}}) 
```

要查看您可以使用我建议的架构做的更多事情，我会阅读[这个](http://www.mongodb.org/display/DOCS/Updating)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:13:58.053

我不太了解 mongo，但`$addToSet`建议有一个用户集合，而您似乎需要将密钥添加到 users 对象。

我不知道在 upsert 示例中是否有对此的 mongo 快捷方式

`foo['users']['billy'] = 'NaN'`

# java - 将图像添加到 JButton

> ID：10729024
> 
> 赞同：0
> 
> 时间：2012-05-23T22:59:30.783
> 
> 标签：java, eclipse, swing, icons, jbutton

我正在尝试将图像添加到 JButton，但我不确定我缺少什么。当我运行以下代码时，按钮看起来与我创建它时没有任何图像属性完全相同。Background.jpeg 位于我的项目文件夹的根目录中。

```
this is the code:

package eg.edu.guc.dvonn.gui;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.TextArea;
import java.awt.TextField;

import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

import eg.edu.guc.dvonn.engine.Board;

public class FirstWindow extends JFrame implements ActionListener {

    JButton Startbutton;
    JPanel welcomePanel;
    JPanel SecondPanel;
    JPanel StandardPanel;
    JPanel custPanel;
    JPanel  panelFill;
    JButton Standard;
    JButton fill;
    JButton put;
    JButton cust;
    JLabel label;
    TextField rows;
    TextField col;
    Board b;
    JButton[][] button;
    int r1;
    int cc;

         public FirstWindow(){

             setSize(800,600);
             setVisible(true);
             setLayout(new BorderLayout());

             setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

              welcomePanel = new JPanel();

            label  = new JLabel("Welcome to Dvonn");
            welcomePanel.add(label);
            welcomePanel.setVisible(true);

             label.setForeground(Color.RED);
             label.setFont(new Font("Serif", Font.PLAIN, 40));

             Startbutton = new JButton ("start");

             Startbutton.setBackground(Color.BLACK);
             Startbutton.setForeground(Color.RED);
             Startbutton.setPreferredSize(new Dimension(120,40));

             welcomePanel.add(Startbutton);
             add(welcomePanel);

             Startbutton.addActionListener(this);

             SecondPanel = new JPanel();
             SecondPanel.setVisible(false);
             SecondPanel.setSize(400,400);
              rows = new TextField();
              col= new TextField();
              SecondPanel.add(rows);
              SecondPanel.add(col);

              fill = new JButton("fill random");
              fill.addActionListener(this);
              fill.setBackground(Color.LIGHT_GRAY);
              fill.setForeground(Color.BLUE);

              put = new JButton("put");
              put.setBackground(Color.LIGHT_GRAY);
              put.setForeground(Color.BLUE);

              Standard = new JButton("Standardised board");
              Standard.setBackground(Color.LIGHT_GRAY);
              Standard.setForeground(Color.BLUE);
              Standard.addActionListener(this);

              cust = new JButton("customized");
              cust.setBackground(Color.LIGHT_GRAY);
              cust.setForeground(Color.BLUE);
              cust.addActionListener(this);

              panelFill = new JPanel();

              panelFill.add(fill);
              panelFill.add(put);
              SecondPanel.add(Standard);
              SecondPanel.add(cust);

              b = new Board(r1,cc);  
                this.r1 =5;
                this.cc = 11;
                button = new JButton [r1][cc];
                StandardPanel = new JPanel();
                StandardPanel.setBackground(Color.WHITE);
                StandardPanel.setLayout(new GridLayout(r1, cc));

                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {
                        button[i][j] = new JButton(); // i want to     add an image to it

                        button[i][j].addActionListener(this);
                    }
                }
                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {

                        button[i][j].setLayout(new FlowLayout());
                        button[i][j].setBackground(Color.WHITE);

                        StandardPanel.add(button[i][j], i, j);

                    }
                }

         }  

         public FirstWindow(int row,int cols){

             setSize(800,600);
             setVisible(true);
             setLayout(new BorderLayout());

             setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

              fill = new JButton("fill random");
              fill.addActionListener(this);
              fill.setBackground(Color.LIGHT_GRAY);
              fill.setForeground(Color.BLUE);

              put = new JButton("put");
              put.setBackground(Color.LIGHT_GRAY);
              put.setForeground(Color.BLUE);

              Standard = new JButton("Standardised board");
              Standard.setBackground(Color.LIGHT_GRAY);
              Standard.setForeground(Color.BLUE);
              Standard.addActionListener(this);

              cust = new JButton("customized");
              cust.setBackground(Color.LIGHT_GRAY);
              cust.setForeground(Color.BLUE);
              cust.addActionListener(this);

              panelFill = new JPanel();
              panelFill.add(fill);
              panelFill.add(put);

            this.r1 = row;
            this.cc = cols;

                 b = new Board(r1,cc);  

                button = new JButton [r1][cc];

                custPanel = new JPanel();
                custPanel.setBackground(Color.WHITE);
                custPanel.setLayout(new GridLayout(r1, cc));

                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {
                        button[i][j] = new JButton(); // i want to     add an image to it
                        button[i][j].addActionListener(this);
                    }
                }
                for (int i = 0; i <= r1 - 1; i++) {
                    for (int j = 0; j <= cc - 1; j++) {

                        button[i][j].setLayout(new FlowLayout());
                        button[i][j].setBackground(Color.WHITE);
                        custPanel.add(button[i][j], i, j);

                    }
                }
                add(custPanel);
                add(panelFill,BorderLayout.SOUTH);

         }
         public static void main  (String [] args){
             FirstWindow window = new FirstWindow();

         }
        @Override
        public void actionPerformed(ActionEvent e) {

            if (e.getSource()==Startbutton){

                this.remove(welcomePanel);
                this.add(SecondPanel);
                SecondPanel.setVisible(true);
                //this.add(SecondPanel);

                JLabel label1 = new JLabel("dvonn");
                label1.setForeground(Color.RED);
                label1.setFont(new Font("Serif", Font.PLAIN, 25));
                SecondPanel.add(label1);

                }

                if(e.getSource()== cust){
                   String rowText = rows.getText();
                   String colText = col.getText();

                   r1 = Integer.parseInt(rowText);
                   cc = Integer.parseInt(colText);
                   this.setVisible(false);
                FirstWindow custom =new FirstWindow(r1, cc);

                 } 
                      if(e.getSource()==Standard){
                         SecondPanel.setVisible(false); // set the second panel invisible
                         this.add(StandardPanel); //to add the panel with the buttons
                         StandardPanel.setVisible(true);

                         add(panelFill,BorderLayout.SOUTH);
                         add(StandardPanel,BorderLayout.CENTER);

                     }

              /* Board b  = new Board(r1,c1);
                    b.fillRandom();*/

                //  }

            }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:02:28.800

您可以使用生成一个`ImageIcon`并将其设置为按钮的图标

```
JButton button; // precondition: not null
ImageIcon icon = new ImageIcon(FirstWindow.class.getResource("/Background.jpeg"));
button.setIcon(icon);
button.setDisabledIcon(icon); // or a grayed-out version 
```

如果这不起作用，请尝试创建一个`eg.edu.guc.dvonn.resources`包并将第二行更改为：

```
ImageIcon icon = new ImageIcon(
    FirstWindow.class.getResource(
    "/eg/edu/guc/dvonn/resources/Background.jpeg")); 
```

确保在运行代码之前刷新 Eclipse 项目（单击项目管理器、空白处或项目名称，然后按 F5 键，或右键单击 → 刷新）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:18:03.230

见这里 [http://docs.oracle.com/javase/tutorial/uiswing/components/button.html](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:05:39.873

我建议简化您正在做的事情并尝试这个基本教程。如果你让它与 gif 一起使用，那么将其更改为你的 jpg。如果可行，那么您可以用更简单的示例替换代码。

Jbutton教程： http: [//www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-JButton.html](http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-JButton.html)

# c# - 管理从 web api 以 json 格式返回的属性名称

> ID：10729031
> 
> 赞同：20
> 
> 时间：2012-05-23T23:00:15.100
> 
> 标签：c#, asp.net, rest, asp.net-web-api

我目前正在使用 ASP.NET web api，在其中我从 REST 操作返回一个 Model 对象，如下所示：

产品特性：`Name, Id, Description, etc.....`

当 this 转换为`JSON`对象时，它会使用上面的属性名称输出它。

为了减少从 web api 操作返回的有效负载，有什么方法可以更改 JSON 对象中的属性，例如`Desc`for `Description`. 我可以更改 Model 对象，但属性名称没有意义！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-14T17:25:56.457

做到这一点的简单方法是通过数据合同。 [这是一篇文章](http://msdn.microsoft.com/en-us/library/ms733127.aspx)，但基本上，它涉及模型上的两个注释。它还允许您忽略任何您不想序列化的内容。

```
[DataContract]
public class Foo {  //Your model class

   [DataMember(Name="bar-none")]  //This also allows you to use chars like '-'
   public string bar {get; set;}

   [IgnoreDataMember]  //Don't serialize this one
   public List<string> fuzz { get; set;}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:19:32.427

您还可以考虑在 asp.net 端使用[http://automapper.org/](http://automapper.org/)将您的完整对象映射到更轻量级的对象。对于一两个小对象来说可能有点过分了，但如果你有一堆东西要做，这可以为你节省一些时间（免费和开源启动）。

# linux - 我可以用 /etc/hosts 映射主机名*和*端口吗？

> ID：10729034
> 
> 赞同：207
> 
> 时间：2012-05-23T23:00:30.387
> 
> 标签：linux, dns, port, hostname

我可以将 IP 地址映射`127.0.0.1`到域名*和*端口吗？

例如，我想映射`127.0.0.1`到`api.example.com:8000`

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2012-05-23T23:03:22.950

不，那是不可能的。端口不是主机名的一部分，因此在`hosts`-file 中没有任何意义。

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2012-05-23T23:05:25.827

如果您确实需要这样做，请使用反向代理。例如，使用 Nginx：

```
server {
  listen       api.mydomain.com:80;
  server_name  api.mydomain.com;
  location / {
    proxy_pass http://127.0.0.1:8000;
  }
} 
```

# ios - iPad Twitter App（弹出导航控制器）中看到的功能

> ID：10729038
> 
> 赞同：1
> 
> 时间：2012-05-23T23:00:41.230
> 
> 标签：ios, uinavigationcontroller, popup

我想知道 twitter 在他们的 iPad 应用程序中使用的功能是如何工作的。当您在左侧选择个人资料时，这是该功能。然后选择“Edit Profile...” 有一个 segue 将 Edit Profile 框弹出到查看区域的中心（而其余部分变暗）。然后，如果您选择编辑名称，则无需更改背景即可转到新屏幕。

我知道这是在导航控制器中，但是他们如何在导航控制器中使用较小的视图，并且您仍然可以在后台看到应用程序的其余部分？当我所有的弹出视图都通过 addSubview 调用时，我可以做到这一点。

我目前有一个导航控制器-> 视图控制器（tableview 填满了整个页面和使用 addSubview 弹出的多个 uiview。我不知道 UIPopOverController 功能是什么。

我试图从我的 VC 中添加另一个导航控制器，但我无法控制大小。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:14:16.343

听起来像你想要的：

```
 UIViewController *mainViewController = your main view controller;
    ...
    UINavigationController *formViewController = whatever you want to appear in the little box;
    formViewController.modalPresentationStyle = UIModalPresentationStyleFormSheet;
    [mainViewController presentViewController:formViewController animated:YES completion:NULL]; 
```

有关 modalPresentationStyle 的更多信息，请参阅文档：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

# c# - 具有多个订阅者和实时更新的实时数据缓存

> ID：10729041
> 
> 赞同：3
> 
> 时间：2012-05-23T23:01:03.213
> 
> 标签：c#, .net, caching, real-time, real-time-updates

我有一个设计问题。我有一个订阅实时系统来显示数据的应用程序。基本上发生的事情是客户端连接到服务器，下载当前时间的数据快照，并订阅实时更新，这些更新会立即显示在 UI 上。

我们遇到的一个问题是我们可以打开多个实时报告，这意味着我们有多个连接和不必要的数据重复。所以我们想建立一个中央数据存储库来保存所有数据并将其提供给报告，这样我们只使用 1 个套接字连接和一组数据通过网络。

我遇到的问题是这个。当报表订阅我的数据存储库时，它会在当前时间检索快照，然后接收实时更新。这意味着我的存储库正在使用来自服务器的实时更新来更新它的内部缓存，并将这些更新发送到订阅的报告。

当另一个报表连接到存储库时，它还需要下载当前数据并订阅更新。但是，如果在下载快照时有更新，报告将遗漏更新。在下载快照时我也无法锁定缓存，因为这会导致报告 1 在报告 2 获取其快照时停止更新。

我如何确保报告 1 继续获得更新，而报告 2 下载不受干扰的快照，然后开始接收它在此期间错过的所有更新以及未来的更新？

对不起，如果这不清楚。我并不总是擅长描述我的问题 :) 传入的数据本质上是表格中的行，然后我将其汇总成一棵树。它们可以通过“行”中的关键字段来识别，我的缓存将存储每个“行”的最新副本

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:16:19.050

如果我理解你是正确的，你的系统有 3 个部分：

1.  写报告信息的实时系统
2.  存储信息的缓存服务器
3.  获取此信息的客户

正确的？

如果是这样，如果我是你，我会为缓存服务器开发一个管理器，并为实时系统和客户端制作 2 个 API，它们将用于与缓存服务器一起工作。我会坚持一条规则，一次写，没人读，或者全部读，没人写。我会排队。一种用于客户请求，一种用于实时。我们需要该队列的同步机制。

我看到了下一个工作方式：

如果实时系统写入新信息：

1.  有正在更新的报告的客户阅读器

    1.1 缓存管理器将所有信息写入第二个存储以获取这些报告

    如果管理器看到有新信息，它会停止新的读取器请求并将它们放入队列中，并等待所有已经开始读取的线程完成并从第二个存储库更新到第一个存储库

2.  没有读者

    2.1。将信息放在已修改的报告上的主存储块读取器

如果您的实时系统是实时的（在实时处理器上工作）并且每次都编写，那么您应该添加用于合并两个存储的超时并在该时间停止阅读器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-22T11:10:18.873

为什么不让每个缓存状态都有一个哈希值。如果我们的散列是不同的散列，所有订阅者都必须向管理器检查当前散列号，然后触发仅下载更新。

我建议您保存更新并允许客户端在订阅更新之前将自己更新到最新版本。您可以将更新存储在多远的位置。

# c++ - 如何使用类似 Java 的 C++ 枚举作为另一个类的成员变量？

> ID：10729046
> 
> 赞同：3
> 
> 时间：2012-05-23T23:01:50.800
> 
> 标签：c++

我正在尝试[在 C++ 中使用类 java 枚举的解决方案](https://stackoverflow.com/a/1965344/79217)。

我的问题是我试图将枚举用作另一个类的成员。所以首先我们从熟悉的 Planet 枚举开始：

```
#ifndef PLANETS_H
#define PLANETS_H

class Planet {
  public:
    static const double G = 6.67300E-11;
    // Enum value DECLARATIONS - they are defined later
    static const Planet MERCURY;
    static const Planet VENUS;
    // ...

  private:
    double mass;   // in kilograms
    double radius; // in meters

  private:
    Planet(double mass, double radius) {
        this->mass = mass;
        this->radius = radius;
    }

  public:

    double surfaceGravity() {
        return G * mass / (radius * radius);
    }
};

// Enum value DEFINITIONS
// The initialization occurs in the scope of the class,
// so the private Planet constructor can be used.
const Planet Planet::MERCURY = Planet(3.303e+23, 2.4397e6);
const Planet Planet::VENUS = Planet(4.869e+24, 6.0518e6);

#endif // PLANETS_H 
```

然后我们有一个`SolarSystem`接受对象的`Planet`对象。

```
#ifndef SOLARSYSTEM_H
#define SOLARSYSTEM_H

#include "Planets.h"
class SolarSystem {
  public:
    SolarSystem(int distance, const Planet& planet) {
        this->distance = distance;
        this->planet = planet;
    }

  private:
    int distance;   // in kilometers
    Planet planet;

};

#endif // SOLARSYSTEM_H 
```

现在，如果我们尝试编译它，我们会得到以下错误：

```
SolarSystem.h: In constructor 'SolarSystem::SolarSystem(int, const Planet&)':
SolarSystem.h:7:53: error: no matching function for call to 'Planet::Planet()'
SolarSystem.h:7:53: note: candidates are:
Planets.h:17:5: note: Planet::Planet(double, double)
Planets.h:17:5: note:   candidate expects 2 arguments, 0 provided
Planets.h:4:7: note: Planet::Planet(const Planet&)
Planets.h:4:7: note:   candidate expects 1 argument, 0 provided 
```

该问题可以通过包含一个空的`Planet()`构造函数来解决。

我想知道这是否是最合适的解决方案，或者是否有不涉及空构造函数的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:06:19.840

您应该`Planet planet`在初始化列表中进行引用并对其进行初始化。否则，C++ 会尝试复制 - 的实例，这`Planet`正是您想要避免的。

```
class SolarSystem {
public:
    SolarSystem(int distance, const Planet& planet)
    :   distance(distance)
    ,   planet(planet) {
    }

private:
    int distance;   // in kilometers
    const Planet& planet;

}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-12T22:03:51.973

如果您使用 c++11，您还可以使用我描述的类似 Java 的 C++ 枚举方法 ( [https://stackoverflow.com/a/29594977/558366](https://stackoverflow.com/a/29594977/558366) )，它基本上是一个围绕 int 变量的包装类，并允许你几乎可以像使用普通枚举类型一样使用 Planet （它支持强制转换，`int`大小与 相同`int`），但仍然具有成员函数，例如`planet.SurfaceGravity()`. 它将允许您的太阳系标头编译（尽管您可以并且应该删除构造函数中 Planet 参数的引用）：

```
class SolarSystem {
  public:
    SolarSystem(int distance, Planet planet) {
        this->distance = distance;
        this->planet = planet;
    }

  private:
    int distance;   // in kilometers
    Planet planet;
}; 
```

# c# - C# 中的列表视图

> ID：10729047
> 
> 赞同：0
> 
> 时间：2012-05-23T23:02:04.307
> 
> 标签：c#, winforms, listview

```
string title = HardwareInfo.GetComputerName().ToString();
        TabPage myTabPage = new TabPage(title);
        // tabControl1.TabPages.Add(myTabPage);

        // Create Column Headers

        ListView listView2 = new ListView();
        ColumnHeader columnA = new ColumnHeader();
        columnA.Text = "adsasd";
        columnA.Width = 185;
        columnA.TextAlign = HorizontalAlignment.Left;
        ColumnHeader columnB = new ColumnHeader();
        columnB.Text = "asd";
        columnB.Width = 185;
        columnB.TextAlign = HorizontalAlignment.Left;
        ColumnHeader columnC = new ColumnHeader();
        columnC.Text = "asdasd";
        columnC.Width = 185;
        columnC.TextAlign = HorizontalAlignment.Left;
        ColumnHeader columnD = new ColumnHeader();
        columnD.Text = "xx";
        columnD.Width = 185;
        columnD.TextAlign = HorizontalAlignment.Left;

      //  Add columns to the ListView:
          listView2.Columns.Add(columnA);
          listView2.Columns.Add(columnB);
          listView2.Columns.Add(columnC);
          listView2.Columns.Add(columnD);

          listView2.Size = new Size(800, 300);
          listView2.Location = new Point(0, 0);
          listView2.GridLines = true;
          listView2.View = View.Details; 
```

在这里，我有一些我的代码的副本，我想做的是在我的下一个工作中获取计算机列表，然后为每台计算机创建选项卡。我把这部分做得很好，但我遇到的问题是，它创建了具有相同名称的列表视图，当我尝试向这些特定列表视图添加信息时，这会导致一个明显的问题。我想知道，例如，我将如何为每个列表视图提供计算机的名称。正如您在我的选项卡中看到的那样，我可以这样做，但是当涉及到列表视图时，如果我尝试执行相同类型的分配字符串标题到它说 Listview listview2 它不会让我编译。我是编程新手，如果这很明显，我深表歉意。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:57:51.797

如果我理解你想要的问题是 name 变量，在这种情况下

```
listView2.name = <name of listview2> 
```

[http://msdn.microsoft.com/en-us/library/system.windows.forms.listview_members(v=vs.71](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview_members(v=vs.71) )

但我认为您应该考虑为这些列构造函数部分使用具有列返回类型的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T10:03:32.507

您希望创建存储字典列表视图部分的变量，这样您就可以通过它们的名称或您想要的任何字符串来查找不同的计算机

```
Dictionary<string, ListView> 
```

[http://msdn.microsoft.com/en-us/library/xfhwa508.aspx](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)

如果您不需要字典的查找部分，则可以使用 List，但可以使用整数作为数组

```
List<ListView> 
```

[http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:05:14.587

听起来您想创建一个`List<ListView>`并将列表视图添加到其中。

根据您的使用方式，您可能需要字典。

# python - 不理解python对三维列表的行为（对子列表的引用是一样的）

> ID：10729049
> 
> 赞同：1
> 
> 时间：2012-05-23T23:02:25.543
> 
> 标签：python

我不明白为什么以下代码的行为方式如此。

```
import numpy as np

nbr_arrays = 4
nbr_fields_per_array = 3
nbr_subfields_per_field = 2

# pre-allocate zeros list
zeros = np.zeros(nbr_subfields_per_field)

data = []
for array in range(nbr_arrays):

    # pre-allocate the subarray 
    empty_array = []
    for empty_array_index in range(nbr_fields_per_array):
        empty_array.append(zeros)

    # append pre subarray to data
    data.append(empty_array)

    # fill up data
    for j in range(nbr_fields_per_array):
        for k in range(nbr_subfields_per_field):
            data[array][j][k] = j*k*array 
```

生成的输出`data`现在显示：

```
[[array([ 0.,  6.]), array([ 0.,  6.]), array([ 0.,  6.])],
 [array([ 0.,  6.]), array([ 0.,  6.]), array([ 0.,  6.])],
 [array([ 0.,  6.]), array([ 0.,  6.]), array([ 0.,  6.])],
 [array([ 0.,  6.]), array([ 0.,  6.]), array([ 0.,  6.])]] 
```

甚至`zeros`读起来完全不同：

```
array([ 0.,  6.]) 
```

如果我查看不同列表的标识，这就是我得到的：

```
id(data[0][0])
Out[72]: 45790208

id(data[1][0])
Out[66]: 45790208

id(data[2][0])
Out[67]: 45790208

id(data[3][0])
Out[68]: 45790208

id(zeros)
Out[69]: 45790208 
```

为什么所有的参考文献都一样？为什么`zero`突然包含非零值？

如果有人**能解释一下这里到底发生了什么**，以及**我必须如何修改我的代码以查看预期的行为**（输出），我将不胜感激。

**编辑：**

不使用`zeros`而是使用`[[0]*nbr_subfields_per_field for x in range(nbr_fields_per_array)]`给了我预期的结果。但为什么？为什么原始代码不起作用？修改后的代码有效：

```
data = []
for array in range(nbr_arrays):
    empty_array = [[0]*nbr_subfields_per_field for x in range(nbr_fields_per_array)]

    ''' this is causing the weird behaviour 
    empty_array = []
    for empty_array_index in range(nbr_fields_per_array):
        empty_array.append(zeros)
    '''

    data.append(empty_array)

    for j in range(nbr_fields_per_array):
        for k in range(nbr_subfields_per_field):
            data[array][j][k] = j*k*array 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:07:20.347

> ```
> # pre-allocate zeros list
> zeros = np.zeros(nbr_subfields_per_field) 
> ```

这将创建一个对象。

> ```
> for empty_array_index in range(nbr_fields_per_array):
>     empty_array.append(zeros) 
> ```

这会不断附加相同的对象。

停止预分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:44:39.540

如果您愿意，Numpy 可以为您设置多维数组。由于您将在创建整个数组后立即对其进行初始化，因此该`empty`方法似乎是最合适的：

```
data = np.empty((nbr_arrays, nbr_fields_per_array, nbr_subfields_per_field)) 
```

# ruby - 两个不同的 .rb 文件可以访问同一个变量吗？

> ID：10729059
> 
> 赞同：-1
> 
> 时间：2012-05-23T23:03:28.793
> 
> 标签：ruby

我在同一台计算机（Win XP）上运行脚本 web.rb（sinatra）和 rufus.rb（使用 rufus gem 的 cron）。两者都在使用我拥有所有功能的 functions.rb 。我有一个数组变量 $webserver_status 我在其中存储 Web 服务器执行/正在执行的命令的历史记录。Web 服务器运行一些 dos 命令和 php 脚本，我想确保一次只运行一个，并让用户了解正在发生的事情。

我曾经通过 http 运行 cron 作业（rufus.rb），所以实际上我从浏览器访问 Web 服务器。因此状态变量已正确更新。现在我开始从 functions.rb 调用相同的代码，因此该变量不再显示正确的服务器状态。

**cron 有什么方法可以直接访问 $webserver_status 变量吗？**

或者我必须通过 http 更新变量？或者磁盘上的某种状态文件？

*   ruby 1.8.7 (2010-08-16 补丁级别 302) [i386-mingw32]
*   网络服务器始终运行
*   我有 cron 代码的生产和测试版本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:10:26.410

请参阅我[在此答案](https://stackoverflow.com/questions/8574206/ruby-how-to-import-a-variable-from-another-file/8576984#8576984)中提出的建议。除非我在您的场景中遗漏了某些东西，否则问题基本上是相同的。根据您的需要，有许多可能的解决方案。

***编辑***：

根据您的评论，我猜您想在两个 ruby​​ 进程之间共享内存或以其他方式在进程之间进行通信。阅读[ruby​​ 中的 IPC](http://jstorimer.com/2012/04/19/intro-to-ruby-ipc.html)以了解如何使 UNIX 套接字满足您的需求。

谈论在两个进程中访问同一个变量是没有意义的——你必须通过某种中介，无论是套接字、数据库还是文件。如果这不是您想要的，那么我建议您澄清情况以及为什么需要共享访问内存而不是类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:36:27.770

我认为你正在寻找这样的东西：

```
#web.rb
require './functions'

print_value("apple") 
```

和

```
#rufus.rb
require './functions'

print_value("not apple") 
```

和

```
#functions.rb

def print_value(value)
  puts value
end 
```

调用 web.rb 返回字符串 Apple。

# checkbox - knockout.js 并监听复选框上的检查事件

> ID：10729060
> 
> 赞同：54
> 
> 时间：2012-05-23T23:04:05.367
> 
> 标签：checkbox, knockout.js

我试图让一个函数在选中或取消选中复选框时执行，以验证所有复选框都未选中但它永远不会被执行。我假设我没有正确执行它。

```
@Html.CheckBox("Subscription", new{ data_bind="disable: Disabled, checked: Checked, click: $parent.allSubscriptionsUnchecked"} ) 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-05-24T01:13:57.267

您可以将 a`checked`和`click`binding 都添加到输入。但是，您可能希望`return true;`从单击处理程序中获取。这将允许执行默认操作（复选框将被选中/取消选中）。

这是一个示例：http: [//jsfiddle.net/rniemeyer/cnkVA/](http://jsfiddle.net/rniemeyer/cnkVA/)

另一种技术是将此逻辑推送到您的视图模型中并订阅对布尔可观察对象的更改并执行您的操作，例如：http: [//jsfiddle.net/rniemeyer/cnkVA/2/](http://jsfiddle.net/rniemeyer/cnkVA/2/)

# java - 没有预期返回类型的返回路径存在时没有编译时错误

> ID：10729061
> 
> 赞同：2
> 
> 时间：2012-05-23T23:04:06.397
> 
> 标签：java, c

我想知道为什么下面的代码在编译过程中不会抛出错误？：

```
#include <stdio.h>
char * func (char *);

int main()
{
    func("TINFO");
    func("INFO");
}

char * func(char * str)
{
    if (str[0] == 'T')
    return str + 1;
} 
```

您会看到函数的返回路径不返回`char *`

不过，类似的 Java 代码会引发编译时错误。

使用的编译器：

```
gcc (Ubuntu 4.4.3-4ubuntu5) 4.4.3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:09:31.947

您所要做的就是提高编译器的“警告”级别。

例子：

```
$ gcc -o x x.c
  <= DEFAULT: No warnings, no errors

$ gcc -Wall -pedantic -o x x.c
x.c: In function `main':
x.c:14: warning: control reaches end of non-void function
x.c: In function `func':
x.c:24: warning: control reaches end of non-void function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T23:21:38.687

根据 C 标准 6.9.1.12，*仅当调用者使用返回值*时，到达函数末尾才是未定义的行为：

> 如果`}`到达终止函数的 ，并且调用者使用函数调用的值，则行为未定义。

这就是编译器必须让这段代码编译的原因。

# javascript - 来自模拟传感器数据的欧拉角 9dof

> ID：10729062
> 
> 赞同：0
> 
> 时间：2012-05-23T23:04:09.217
> 
> 标签：javascript, accelerometer, three.js, gyroscope, euler-angles

我正在寻找基于 javascript 中的模拟传感器数据计算欧拉角。传感器数据包括 3d 中的陀螺仪、加速度计和磁力计数据。数学有点过头了，正在寻找任何帮助或提示。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T10:55:43.963

目前尚不清楚您的要求是什么。您正在尝试实施传感器融合吗？或者你已经有了它并且你想从方向（旋转矩阵或四元数）中得到欧拉角？

我已经根据这份[手稿](http://gentlenav.googlecode.com/files/DCMDraft2.pdf)为[Shimmer 2设备实现了](http://www.shimmer-research.com/products-2/shimmer-revisions)**传感器融合**。我强烈推荐它。

**欧拉角是邪恶的**，不要使用它们。[它们会破坏应用程序的稳定性，](https://stackoverflow.com/a/5578867/341970)并且[不能用于插值](https://stackoverflow.com/a/5580491/341970)。

对于这类任务，JavaScript 似乎有点奇怪。

# linux - Linux中文件的自动合并（一种方式）

> ID：10729064
> 
> 赞同：1
> 
> 时间：2012-05-23T23:04:20.433
> 
> 标签：linux, merge

我正在寻找一个 linux 命令行实用程序，它可以自动合并
两个文件之间的差异（仅一种方式）。

对于仅存在于源文件中的所有差异，该工具应
自动将这些差异应用于目标。
如果存在冲突，该工具应跳过它以进行手动解决。

PS
1\. 这必须超过 100 多个文件，这就是 GUI 工具不适合的原因。
2\. 不能使用源代码控制工具，否则我会使用'p4 resolve'
3\. 我看了'sdiff -o'，但它是交互式的

例子：

## 目标文件

乙 丙丁
_

## 源文件

A
B
C
E

## 合并后，目标文件应该是

A <-- 自动合并
B
C
D <-- 留作手动解析

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:39:11.787

这些文件是否在源代码管理中？源代码控制可以通过这种方式管理差异，因为它们具有从一系列增量构建文件的引擎。当您合并文件时，有明确定义的方法可以根据时间戳或哈希条目顺序遍历增量树并组装最终文件。

如果您使用源代码控制，只需使用它们的合并工具。如果您只有两个内容相似的文件，那么就没有明智的方法来实现这一点。程序如何理解您希望如何合并文件？

简而言之，合并需要三方第一个文件、第二个文件和一个共同的祖先。

# javascript - Google Maps API v3 在 iPad Safari 上禁用双指缩放

> ID：10729067
> 
> 赞同：2
> 
> 时间：2012-05-23T23:04:50.427
> 
> 标签：javascript, ipad, google-maps-api-3

我试图弄清楚如何使用 Javascript 在 Google Maps API V3 上禁用默认的捏缩放功能。我尝试检测文档和嵌套 div 上的 touchstart 事件，但无济于事。任何人都知道如何禁用此功能？

**笔记** 我已经尝试遍历所有 DOM 元素，寻找`ontouchstart`间隔中的事件，寻找一种可能构建黑客的方法，但我似乎无法找到任何（使用我的 iPad），所以我不确定它们是如何正在做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-26T23:08:23.313

我想出了一个解决方案，因为我的项目是全屏的，所以下面的代码可以解决问题。

```
var tblock = function (e) {
    if (e.touches.length > 1) {
        e.preventDefault()
    }

    return false;
}

document.body.addEventListener("touchmove", tblock, true); 
```

# objective-c - Dereference 2D Array Pointer In C

> ID：10729070
> 
> 赞同：0
> 
> 时间：2012-05-23T23:04:55.307
> 
> 标签：objective-c, c, pointers, reference

I am pointing to the address of a 2D array, and I am confused as to how to dereference the pointer to free up the memory again. (I don't use "->" or "*". Is that wrong?)

My code:

```
double array[12][12];
//filled with numbers

double *arrayPtr; //pointer

arrayPtr = &array[0][0]; //pointing to address

multiply(arrayPtr, arrayPtr); //this works fine

//Do I need to do anything further to make sure my memory management is correct?  And if so, why? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:09:33.903

In this case, the answer is no -- since you simply defined `array` (didn't use something like `malloc` to allocate it) you don't have to do anything to free it either. If it was local (defined inside a function) it'll be freed automatically when you exit the function. If you defined it outside any function, it's a global, so it'll exist the entire time the program runs. Either way, you don't have to d any explicit memory management.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T23:09:48.527

```
double array[12][12]; 
```

You're declaring `array` on the stack. It's not dynamically allocated with the heap, so you don't "free up the memory".

```
double *arrayPtr; //pointer
arrayPtr = &array[0][0]; //pointing to address 
```

If you want to point to the first element, this would suffice:

```
double* arrayPtr = array; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:29:40.827

First, there a quite different between C and C++

In C to use memory management you shall use malloc/calloc/realloc and free. In c++ you will use new and delete.

In your code.

```
double array[12][12]; 
```

This is imply to allocate memory in stack. So the memory will be allocated to the scope of this program section so that it will be green when the scope of this variable end.

If you will to use free you will need

```
 double **array;
 array = (double **) malloc(sizeof(double*));
 *array = (double*) malloc (24 * sizeof(double));

free (*array);
free (array); 
```

# android - Android getTextBounds 尾随空格处理（也与 AndEngine Font.getStringWidth 相关）

> ID：10729080
> 
> 赞同：4
> 
> 时间：2012-05-23T23:05:53.387
> 
> 标签：android, fonts, whitespace

做`mPaint.getTextBounds()`或AndEngine的`Font.getStringWidth`时，如果不考虑尾随空格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:05:53.637

这似乎是一个功能，而不是错误，请参阅[http://code.google.com/p/android/issues/detail?id=7527](http://code.google.com/p/android/issues/detail?id=7527)上的讨论，因为边界是视觉边界。

解决方法：在文本中添加一个额外`x`的字符，测量它，然后减去`x`.

# wso2 - WSO2 ESB 示例 440 失败（JSON/XML 代理）

> ID：10729089
> 
> 赞同：2
> 
> 时间：2012-05-23T23:06:34.870
> 
> 标签：wso2, wso2esb

wso2esb-4.0.3

我能够执行其他示例。我确实运行了 ESB 和 StockService。看起来 JSON 转换正在发生，但 jsonclient 无法处理 JSON 响应。

```
ant jsonclient -Daddurl=http://localhost:9000/services/SimpleStockQuoteService -Dtrpurl=http://localhost:8280/services/JSONProxy 
```

产量

```
[java] org.apache.axis2.AxisFault: com.ctc.wstx.exc.WstxUnexpectedCharException: Unexpected character '{' (code 123) in prolog; expected '<'
 [java]  at [row,col {unknown-source}]: [1,1]
 [java]     at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)
 [java]     at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:123)
 [java]     at org.apache.axis2.transport.TransportUtils.createSOAPMessage(TransportUtils.java:67)
 [java]     at org.apache.axis2.description.OutInAxisOperationClient.handleResponse(OutInAxisOperation.java:354)
 [java]     at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:421)
 [java]     at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)
 [java]     at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)
 [java]     at org.apache.axis2.client.ServiceClient.sendReceive(ServiceClient.java:555)
 [java]     at org.apache.axis2.client.ServiceClient.sendReceive(ServiceClient.java:531)
 [java]     at samples.userguide.JSONClient.executeClient(Unknown Source)
 [java]     at samples.userguide.JSONClient.main(Unknown Source) 
```

我不是 Axis2 客户端专家。任何人都可以解决这个例子吗？

从示例中发送带有 JSON 有效负载的 curl 也会产生错误：

```
curl -X POST -H 'Content-type: application/json' -d '{"getQuote":{"request":{"symbol":"IBM"}}}' http://localhost:8280/services/JSONProxy 
```

ESB 控制台：

```
[2012-05-23 16:28:24,079]  INFO - LogMediator To: /services/JSONProxy, MessageID: urn:uuid:fa1489c7-e12e-4a59-8abb-663a35115cce, Direction: request, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><getQuote><request><symbol>IBM</symbol></request></getQuote></soapenv:Body></soapenv:Envelope>
[2012-05-23 16:28:24,087]  WARN - ClientHandler Received an internal server error : Internal Server Error For : 127.0.0.1:9000 For Request : Axis2Request [Message ID : urn:uuid:ce8b27f3-5aea-461c-a1f5-e7d0c6bbac4d] [Status Completed : true] [Status SendingCompleted : true]
[2012-05-23 16:28:24,089]  INFO - LogMediator To: http://www.w3.org/2005/08/addressing/anonymous, WSAction: , SOAPAction: , MessageID: urn:uuid:ce8b27f3-5aea-461c-a1f5-e7d0c6bbac4d, Direction: response, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><faultstring>com.ctc.wstx.exc.WstxEOFException: Unexpected EOF in prolog
 at [row,col {unknown-source}]: [1,0]</faultstring></soapenv:Body></soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T19:07:42.713

当您将消息从 json 转换为soap11 时，请确保将端点格式设置为soap11。您可以通过像这样设置端点地址来做到这一点：`<address uri="http://localhost:9000/services/SimpleStockQuoteService" format="soap11"/>`在突触配置中。

# xml - Scala：值参数与惰性 xml

> ID：10729097
> 
> 赞同：1
> 
> 时间：2012-05-23T23:07:11.967
> 
> 标签：xml, scala, lazy-evaluation

我正在尝试使用 Scala解析来自[last.fm的](http://last.fm)[artist.getInfo](http://www.last.fm/api/show/artist.getInfo)调用。scala 的 Xml API 真的很棒，但是我有一个设计问题（也许是个人风格）。

目前，我正在从伴随对象中的 XML 中解析数据，并将它们交给类的构造函数，如下所示：

```
class ArtistProfile (
                      name: String,
                      musicBrainzId: String,
                      url: String,
                      images: List[Image],
                      streamable: Boolean,
                      listeners: Int,
                      plays: Int,
                      similarArtists:List[SimpleArtist]) 

object ArtistProfile {

def apply(xml: NodeSeq) : ArtistProfile = {
  val root = xml
  val name = SimpleArtist.extractName(root);
  val url = SimpleArtist.extractUrl(root);

  val musicBrainzId = root \ "musicBrainzId" text
  val images:List[Image] = Image.findAllIn(root)
  val streamable = (root \ "streamable" text) eq ("1")

  val listeners = (root \ "stats" \ "listeners").text.toInt
  val plays = (root \ "stats" \ "plays").text.toInt

  new ArtistProfile(
    name,
    url,
    musicBrainzId,
    images,
    streamable,
    listeners,
    plays,
    SimpleArtist.findAllIn(xml \ "similar"))
  }
} 
```

如您所见，这些是很多参数。我的问题是将xml NodeSeq 传递给ArtistProfile 构造函数是否是一种更好的风格（就scala 的功能而言），所以类本身接管解析而不是伴随对象。

我问这个是因为我正在尝试编写自己的 last.fm scala 库（作为 scala 的介绍性项目），并且我希望所有对象的事情都是一致的。

1.  通话中有一些数据可能不是每个人都需要的。使用第二种方法，如果对象列表变得更大，我可以将惰性 val 用于对象列表，否则使用正常的 val。对于程序员来说，这不会有什么不同。
2.  另一方面，创建对象所需的数据解析现在与对象本身分离（如上面的示例）

哪种方法是解决问题的更好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:49:14.187

我不确定这个问题是否有非黑即白的答案。您可以在类中放置辅助构造函数，这样您也可以从 xml 节点创建实例，而无需伴随对象。

但是，有充分的理由支持工厂模式。

1.  ArtistProfile 类可以在不影响用户代码的情况下更改，无论是在其字段中，还是更改为全新的子类
2.  在构造函数中进行大量处理不是一个好主意，因为 JVM 不会对其进行优化
3.  您可以缓存值而不是返回新实例，例如，如果同一配置文件被请求两次
4.  从 OO 的角度来看，构造函数没有多大意义：对象如何构造自己？
5.  它遵循 Scala 集合和案例类的约定，调用更简洁

*正如Effective Java*中提到的，工厂模式的主要缺点（假设您将主构造函数设为私有）是用户无法创建子类。

我会把它们都放在伴生对象中。

# permissions - 拒绝访问文件夹但不访问其中的文件

> ID：10729098
> 
> 赞同：4
> 
> 时间：2012-05-23T23:07:15.730
> 
> 标签：permissions, web, directory

我目前在共享主机上，我的文件和文件夹放在“public_html”中。在此，我有一个文件夹，其中包含更多文件夹以及许多 pdf 文件。所以文件夹看起来像这样：

文件夹/folder1/xyz.pdf

文件夹/folder2/abc.pdf

等等..等等..

我试图找出一种方法来拒绝直接通过浏览器访问该文件夹，但不拒绝访问其中的文件。目前，当有人以 www.mysite.com/FOLDER 的身份访问我的站点时，您可以通过浏览器本身访问该文件夹并查看其内容。但我不想拒绝对该文件夹的完全访问，因为我在我网站上的其他一些页面中有指向其 pdf 文件的链接，例如：单击此处

有人可以指导我吗？我可以限制对文件夹的直接访问，但不能拒绝访问其文件吗？

编辑：我在想，我只是在每个文件夹中创建一个 index.html 文件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:13:54.870

我建议使用 htaccess 并添加 IndexIgnore 命令：

索引忽略 *

将它放在一个文件中并命名为 .htaccess（不是 .htacces.txt，只有 .htaccess）

另一种选择是防止仅对一种文件进行索引：

索引忽略 *.pdf

您可以忽略任何文件类型：“ *.pdf *.zip *.jpg *.png *.html(bad idea! :P )”

我希望这有帮助 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-23T10:00:39.437

更好的解决方案是使用

```
Options -Indexes 
```

**如果目录没有索引**文件，它将**禁止**显示目录的内容。最好的事情是它不会像这样显示目录的标题

 **```
IndexIgnore * 
```

干杯，克里斯**

# android - Android JSON 数组返回 TRANSFORM_ERROR: 103

> ID：10729102
> 
> 赞同：2
> 
> 时间：2012-05-23T23:07:19.923
> 
> 标签：android, json, error-handling

刚开始使用[AndroidQuery](http://code.google.com/p/android-query/)处理 JSON 异步任务，我不熟悉 JSON 响应代码。在使用 AQ 方法之前，我没有收到任何错误，但现在我收到 103 TRANSFORM_ERROR。

下面是 JSON 字符串和我的代码片段。对我可能有什么问题有任何想法吗？谢谢

通过 php 返回的 JSON：

```
{"items":[{"_id":"1","label":"AC","title":"Advisory Circulators","description":"Provides guidance such as methods, procedures, and practices for complying with regulations and requirements.","date":"2008-03-03","gotoURL":null},{"_id":"2","label":"AD","title":"Airworthiness Directives","description":"Legally enforceable rules that apply to aircraft, aircraft engines, propellers, and appliances.","date":"2012-06-08","gotoURL":"javascript:navClickListener('bodyContent', dns + '\/wiki\/index.php\/Airworthiness_Directive #content');"},{"_id":"3","label":"CFR","title":"Code of Federal Regulations","description":"Official Rulemaking documents of the CFR in Title 14 and have been published in the Federal Register","date":"2012-01-31","gotoURL":"javascript:navClickListener('bodyContent',  dns + '\/wiki\/index.php\/Main_Page #content');"},{"_id":"4","label":"PMA","title":"Parts Manufacturer Approvals","description":"Parts Manufacturer Approvals","date":"2012-01-31","gotoURL":null},{"_id":"5","label":"SAIB","title":"Special Airworthiness Info Bulletins","description":"Bulletins issued by manufacturers to provide modification or inspection instructions.","date":"2012-01-31","gotoURL":null},{"_id":"6","label":"SFAR","title":"Special Federal Aviation Regulation","description":"Official Rulemaking documents that have changed the language of the CFR in Title 14 CFR for aviation.","date":"2012-01-31","gotoURL":null},{"_id":"7","label":"STC","title":"Supplemental Type Certificates","description":"Document issued by the Federal Aviation Administration approving a product (aircraft, engine, or propeller) modification","date":"2012-01-31","gotoURL":null},{"_id":"8","label":"TSO","title":"Technical Standard Orders","description":"Minimum performance standards issued by the FAA for specified materials, parts, processes, and appliances used on civil aircraft.","date":"2012-01-31","gotoURL":null},{"_id":"9","label":"TCDS","title":"Type Certificate Data Sheets","description":"Repository of Make and Model information of aircraft, engine or propeller including airspeed, weight, and thrust limitations, etc.","date":"2012-01-31","gotoURL":null}]} 
```

主要活动：

```
public class MainActivity extends Activity implements AnimationLayout.Listener
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        ...
        async_array();
    }

    AQuery aq;
    static JSONArray jArray;
    String json = null;

    public void async_array()
    {
        aq = new AQuery(this);
        String url = "http://192.168.1.11/Andaero/php/regulatory_list.php";
        aq.ajax(url, JSONArray.class, new AjaxCallback<JSONArray>()
    {

        @Override
        public void callback(String url, JSONArray json, AjaxStatus status)
        {

        if (json != null)
        {

        // successful ajax call, show status code, json content
        // jsonListCallback(json);
        Toast.makeText(aq.getContext(), status.getCode() + ":" + json.toString(), Toast.LENGTH_LONG).show();

        }

        switch (status.getCode())

        {

            case AjaxStatus.TRANSFORM_ERROR:
            Toast.makeText(aq.getContext(), "TRANSFORM_ERROR: " + status.getCode(), Toast.LENGTH_LONG).show();
            break;
            case AjaxStatus.NETWORK_ERROR:
            Toast.makeText(aq.getContext(), "NETWORK_ERROR " + status.getCode(), Toast.LENGTH_LONG).show();
            break;
            case AjaxStatus.AUTH_ERROR:
            Toast.makeText(aq.getContext(), "AUTH_ERROR" + status.getCode(), Toast.LENGTH_LONG).show();
            break;
            case AjaxStatus.NETWORK:
            Toast.makeText(aq.getContext(), "NETWORK" + status.getCode(), Toast.LENGTH_LONG).show();
            break;
            default:
            Toast.makeText(aq.getContext(), "OTHER ERROR" + status.getCode(), Toast.LENGTH_LONG).show();
            break;

        }
        }
    });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:25:10.897

我从来没有使用过这个库，但我认为这是因为你得到一个对象而不是数组作为响应。

我会尝试这样的事情：

```
aq.ajax(url, JSONObject.class, new AjaxCallback<JSONObject>() ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T20:53:49.867

是的，你是对的，你不应该使用以下形式：

```
[{"unit_name":" GASPIRIN"},{"item_count":"2.000"},{"warehouse_name":"some_name"},{"unit_name":" GASPIRIN"},{"item_count":"1.000"},{"warehouse_name":"some_name2"}] 
```

相反，您应该使用这种形式的 json：

```
{"unit_name":[" GASPIRIN"," GASPIRIN"],"item_count":["2.000","1.000"],"warehouse_name":["some_name","some_name2"]} 
```

所以，这样你就不会得到 103 转换错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:41:41.150

它不喜欢

> “项目”：[。. . "

场地。我删除了它，现在它可以工作了。

# macros - 如何在列表上映射宏 - 或 - 如何使用宏定义数据类型

> ID：10729106
> 
> 赞同：1
> 
> 时间：2012-05-23T23:07:27.670
> 
> 标签：macros, scheme, read-eval-print-loop, r5rs

我喜欢用我自己的数据类型构建一个 REPL，但我不喜欢一遍又一遍地编写所有相同的模式函数。

所以这是一个坚果，这让我很困扰。

我有自己的一组原始数据类型`(define primitives '("mytrue" "myfalse" "mynumber" ...))`

我也有`(define primitiveTesters (list "mytrue?" "myfalse?" "mynumber?" ... )`

现在的问题是，我只想应用（映射）或宏来获取数据类型？程序，它基本上只是检查记录的汽车是否`(mynumber . ( . ))`存在。

所以最后类似`(mynumber? (car (mynumber.(1.))) => #t`的东西。但为此我需要`(define mynumber? (lambda (...)(...))`

我的定义批处理宏看起来像这样，但我只是没有运气注入`<variable>`.

```
(define-syntax define-batching
(syntax-rules () 
((_ value expr)(define value expr))
((_ value) value)
((_ value1 value2 ...)  (begin (define value1 expr) (define-batching test2...)))
)) 
```

那么我是否已经走到了计划的尽头？

我在 Emacs Lisp 中看到过类似的东西。

我最终要寻找的是：

```
 (define checker '(audi? volkswagen? mercedes?))
 (define datatype '(audi volkswagen mercedes))

 (map define-checker checker datatype )
 or
 (define-checker (car checker) (car datatype)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:12:48.107

如果我正确理解了这个问题，您需要一个宏来定义您自己的类型检查器吗？

这是一种方法：

```
(define-syntax define-checker
  (syntax-rules ()
    [(define-checker name tag)
     (define (name object)
       (and (list? object)
            (not (null? object))
            (eq? (car object) 'tag)))]))

(define-checker my-car? car)

(my-car? '(car audi black))   ; evaluates to #t
(my-car? '(truck ford pink))  ; evaluates to #f 
```

附录：

如果你写

```
(define checker '(audi? volkswagen? mercedes?))
(define datatype '(audi volkswagen mercedes)) 
```

这些值将在运行时可用。因此，您需要采用不同的方法。

例如，您可以编写：

```
(define-checker+datatype (audi? audi) (volkswagen? volkswagen?)) 
```

这是代码：

```
(define-syntax define-checker
  (syntax-rules ()
    [(define-checker name tag)
     (define (name object)
       (and (list? object)
            (not (null? object))
            (eq? (car object) 'tag)))]))

(define-syntax define-checkers+datatype
  (syntax-rules ()
    [(define-checkers+datatype (name tag) ...)
     (begin
       (define-checker name tag)
       ...)]))

(define-checkers+datatype (audi? audi) (wv? wv))

(audi? '(audi black)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:14:26.013

`define-syntax`是卫生的，这意味着它不能影响父环境，这意味着它不能在其中定义符号。您可以尝试使用 er-、ir- 宏转换器，它们允许您显式地重命名符号。

在你的方案文档中谷歌的关键字是“er-macro-transformet”和“ir-macro-transformer”

# hsqldb - HSQLDB - 无效的授权规范

> ID：10729107
> 
> 赞同：3
> 
> 时间：2012-05-23T23:07:39.540
> 
> 标签：hsqldb

在通过 hsqldb-2.2.8 上的 JPA/Hibernate 连接数据库期间，我需要帮助解决问题：

`[AWT-EventQueue-0] ERROR org.hibernate.util.JDBCExceptionReporter - invalid authorization specification - not found: manasouza`

我用一些密码创建了一些用户（manasouza）：

`CREATE USER manasouza PASSWORD 123 ADMIN`

我使用 SQLWorkbench 作为我的数据库可视化工具，使用它我可以正常登录。使用 JPA/Hibernate，我已经尝试了大写的用户名和密码为“123”或密码显示在 SYSTEM_USERS 数据库表的 PASSWORD_DIGEST 列上的值，但根本没有成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T10:07:42.897

使用 时`CREATE USER manasouza PASSWORD 123 ADMIN`，HSQLDB 2.2.8 会引发异常。因此，您必须使用不同的密码。

用户名被转换为全大写，因为它没有被双引号引起来。对于密码，您应该在字符串周围使用单引号。如果您定义的密码不带单引号，则它必须以字母开头并转换为全大写。因此，如果您想要确切的情况，请使用`CREATE USER "manasouza" PASSWORD '123' ADMIN`

# python - 将模块（特别是 pymorph）添加到 Spyder（Python IDE）

> ID：10729116
> 
> 赞同：59
> 
> 时间：2012-05-23T23:08:31.137
> 
> 标签：python, import, module, easy-install, spyder

我已经设法在我的 Mac 上安装并运行了 spyder，但我想添加一些默认情况下不包含的模块（mahotas 和 pymorph）。

我通过终端中的 easy_install 安装了两者，并且似乎都安装了没有任何错误消息。从终端运行 python 并使用*import mahotas*和*import pymorph*工作得很好，没有错误消息。但是，当我从 spyder 中的脚本运行相同的行时，我收到以下错误：

```
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/spyderlib/widgets/externalshell/sitecustomize.py", line 493, in runfile
 execfile(filename, namespace)
File "/Users/Name/Documents/Python/dna.py", line 11, in <module>
 import pymorph
ImportError: No module named pymorph 
```

我现在要做的就是运行导入行，就是这样。我似乎找不到任何关于此的信息。我猜 spyder 使用单独的 python 安装，并且通过终端安装模块仅将它们安装到 python 的系统版本。如何将它们添加到 spyder？

**眼镜：**

Mac OSX 10.7.4

蜘蛛 2.1.9

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-05-24T16:44:18.783

好的，还没有人回答这个问题，但我在 spyder 讨论板上发帖后设法弄清楚并让它工作。对于您要添加的任何未包含在 spyder 的默认搜索路径中的库，您需要进入*工具*并通过 PYTHONPATH 管理器为*每个*库添加路径。然后，您需要从同一菜单更新模块名称列表并在更改生效之前重新启动 spyder。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2015-11-13T13:55:33.633

在 spyder 中的 IPython 控制台上使用`!`允许您使用`pip`. 因此，在示例中，您可以执行以下操作：

```
[1] !pip install pymorph 
```

请注意，这在 ~2.3.3 之前的 Spyder 版本的 Python 控制台上也可用（尽管可能不可靠）。感谢@CarlosCordoba 的澄清。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-08-20T10:48:09.260

1.  在终端中查找模块的位置：

    ```
    $ python # open python

    import pygame # import a module 

    pygame # get the location 
    ```

2.  将模块文件夹复制粘贴到“Spyder.app/Contents/Resources/lib/python2.7”

3.  重新启动 Spyder.app

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-05-18T00:50:52.950

如果您在 Anaconda 包中使用 Spyder...

在 IPython 控制台中，使用

```
!conda install packageName 
```

这也适用于本地。

```
!conda install /path/to/package.tar 
```

注意：！在 Spyder 中使用 IPython 控制台时是必需的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-11-08T16:25:49.677

只需使用“！” 在 spyder 终端中的 pip 命令之前，它会很好

例如：

```
!pip install imutils 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-06-14T14:32:18.800

尝试在 Spyder 中添加 seaborn 模块时，我遇到了同样的问题。我在 ubuntu 14.04 中将 seaborn 安装到我的 anaconda 目录中。如果我添加了包含“seaborn”和 seaborn-0.5.1-py2.7.egg-info 文件夹的整个 anaconda/lib/python2.7/site-packages/ 目录，则会加载 seaborn 模块。问题是这个 anaconda 站点包文件夹还包含许多 Spyder 不喜欢的其他模块。

我的解决方案：我在我的个人主文件夹中创建了一个新目录，命名为“spyderlibs”，我在其中放置了 seaborn 和 seaborn-0.5.1-py2.7.egg-info 文件夹。在 Spyder 的 PYTHONPATH 管理器中添加我的新 spyderlib 目录有效！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-05T15:16:03.330

您可以将标准安装位置添加到 PYTHONPATH 管理器。这样您就不需要为每个模块添加特定路径。仅更新模块名称。

在 Unix 上，这个位置通常是：

> /usr/local/lib/pythonX.Y/site-packages

在 Windows 上：

> C:\PythonXY\Lib\site-packages

请参阅[模块安装文档。](https://docs.python.org/2/install/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-12-05T08:51:35.950

你可以运行：

```
pip install pymorph 
```

但是您需要在环境的 anaconda 终端中运行该命令。例如：

[![在此处输入图像描述](../Images/5379512878c730280b0cd4ef2b2f43ad.png)](https://i.stack.imgur.com/godGW.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-25T13:27:33.577

试试这个..

1.  从 CMD 获取您的 Python 版本 [![在此处输入图像描述](../Images/20216b02c985fb80c597715066cee6c0.png)](https://i.stack.imgur.com/DmE9x.png)

2.  确保您在 Spyder 内核中使用相同的版本 [![在此处输入图像描述](../Images/455f0e4df1937af4849677cc3ab24fdd.png)](https://i.stack.imgur.com/x4rR4.png)

如果版本不同，请从“工具>首选项>Python解释器>”管理安装库的python路径。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-07-30T13:21:24.457

将安装了 python 模块的目录添加到 PYTHONPATH 管理器

单击`Synchronize`按钮，然后重新启动内核，您的程序应该可以工作

[![spyderadd模块](../Images/1e5647f2657e5cdeb89b82d43b35c63a.png)](https://i.stack.imgur.com/830eJ.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-11-05T02:40:03.937

也可以按照以下步骤操作：Spyder -> 工具 -> 打开命令提示符 -> 编写命令“pip install html5lib”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-10T06:34:34.460

这是假设一个 Conda 环境。在高层次上，对我有用的只是在 Spyder 中配置我的 Conda 路径。这是我的做法：

**首先，确定您的环境存在的路径**

1.  创建您的环境

2.  在 Anaconda 导航器中，单击“环境”，然后在要打开的环境上点击播放按钮。

3.  点击“Open with Python”，你应该会得到一个交互式 Python shell

4.  输入“import numpy”（选择任何包）

5.  键入“numpy”并查看如下所示的路径：

```
C:\\Users\My Name\\.conda\\envs\\pytorch-three\\lib\\site-packages\\numpy\\__init__.py 
```

重要的部分是一路向下的路径`site-packages`

为了让 Spyder 能够读取您的包，请在 Spyder 中执行以下操作。

1.  从任何地方打开 Spyder

2.  点击“工具”和“首选项”

3.  在您的 Python 解释器中单击“使用以下 Python 解释器”

4.  从上面的路径中，导航到您的环境并选择 Python 可执行文件。对我来说，它就在这里：`C:\\Users\My Name\\.conda\\envs\\pytorch-three\\python.exe`

5.  最后，将`C:\\Users\\My Name\\.conda\\envs\\pytorch-three\\libs\\site-libs`文件夹添加到路径（将存在于您的环境中）。这可以通过带有“添加到路径”工具提示的小 Python 图标轻松完成

我个人不需要重新启动我的 IDE，但您可能需要。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-11-29T18:38:10.797

这适用于我在 Spyder 控制台中完成的目的

> conda install -c anaconda pyserial

这种格式通常有效，但是 pymorph 如此返回：

> conda install -c anaconda pymorph 正在收集包元数据 (current_repodata.json): ...working... done 求解环境: ...working... 初始冻结求解失败。使用灵活的求解重试。收集包元数据 (repodata.json): ...working... done 求解环境: ...working... 初始冻结求解失败。使用灵活的求解重试。

注意：您可能需要重新启动内核才能使用更新的软件包。

PackagesNotFoundError：当前频道不提供以下软件包：

*   pymorph

当前频道：

*   [https://conda.anaconda.org/anaconda/win-64](https://conda.anaconda.org/anaconda/win-64)
*   [https://conda.anaconda.org/anaconda/noarch](https://conda.anaconda.org/anaconda/noarch)
*   [https://repo.anaconda.com/pkgs/main/win-64](https://repo.anaconda.com/pkgs/main/win-64)
*   [https://repo.anaconda.com/pkgs/main/noarch](https://repo.anaconda.com/pkgs/main/noarch)
*   [https://repo.anaconda.com/pkgs/r/win-64](https://repo.anaconda.com/pkgs/r/win-64)
*   [https://repo.anaconda.com/pkgs/r/noarch](https://repo.anaconda.com/pkgs/r/noarch)
*   [https://repo.anaconda.com/pkgs/msys2/win-64](https://repo.anaconda.com/pkgs/msys2/win-64)
*   [https://repo.anaconda.com/pkgs/msys2/noarch](https://repo.anaconda.com/pkgs/msys2/noarch)

要搜索可能提供您正在寻找的 conda 包的替代频道，请导航至

```
https://anaconda.org 
```

并使用页面顶部的搜索栏。

# jquery - 范围问题：价值丢失

> ID：10729121
> 
> 赞同：0
> 
> 时间：2012-05-23T23:09:03.707
> 
> 标签：jquery, scoping

我正在尝试从方法（pollServiceForInfo）返回一个 JSON 对象，但是当我在方法完成后提醒它时，它似乎“丢失”了。我知道这是一个范围界定问题，但是我对如何继续感到困惑。洞察力将不胜感激。

```
var id=null;
var jsonData = JSON.stringify( {searchRequest:{coordinates: "1,2,3 1,2,3 1,2,3 1,2,3 1,2,3"}} );
$.post("rest/search",jsonData, function(json){
    id = json.searchResponse.id;
})
.error(function(jqXHR, textStatus, errorThrown){
    alert("obj.responseText: "+jqXHR.responseText + "  textStatus: "+textStatus+"  errorThrown: "+errorThrown);
})
.success(function(data, status, obj){
    // process initial request
    var json = pollServiceForInfo(id);  // method below

    alert(json);  // says undefined
});

var pollServiceForInfo = function(id){
    //alert('id in pollServiceForInfo '+id);    
    var jsonResults;
    $.get("rest/poll/"+id,function(data){
        jsonResults = data.pollResponse;

    }).error(function(){ 
        alert('returning error');
        return "error";
    }).success(function(){
        alert('returning data '+jsonResults);
        return jsonResults;  // is lost after it's returned
    });
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:21:50.043

您不能有效地从异步函数返回。改为这样做：

```
var pollServiceForInfo = function(id, callback){
    //alert('id in pollServiceForInfo '+id);    
    var jsonResults;
    $.get("rest/poll/"+id,function(data){
        jsonResults = data.pollResponse;

    }).error(function(){ 
        alert('returning error');
        callback("error");
    }).success(function(){
        alert('returning data '+jsonResults);
        callback(jsonResults);  // is lost after it's returned
    });
};

pollServiceForInfo(id, function(json) {
    alert(json);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:42:41.280

您正试图从成功回调中返回。您想要的是从 pollServiceForInfo() 中返回，如下所示：

```
var pollServiceForInfo = function(id){    
    var jsonResults;
    $.get("rest/poll/"+id,function(data){
        jsonResults = data.pollResponse;
    }).error(function(){ 
        alert('returning error');
        jsonResults = "error";
    }).success(function(){
        alert('returning data '+jsonResults);        
    });

    return jsonResults;
}; 
```

# javascript - Javascript 在不使用 Hashtags 的情况下刷新一次

> ID：10729122
> 
> 赞同：0
> 
> 时间：2012-05-23T23:09:03.983
> 
> 标签：javascript, jquery, html, refresh

我正在使用大量的 javascript 函数和脚本，它们有点冲突。

我有一个页面，该页面已经使用主题标签才能正常运行，但其中一个功能不起作用，除非页面被刷新。

我进行了一些搜索，并找到了几种刷新页面的方法，但它会检查 url 中是否已经有一个主题标签......在我的情况下，我已经这样做了，但它没有帮助。

我希望能够一次刷新页面，仅此而已……无需检查 url 中是否有主题标签。

帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:20:53.900

这可能是您正在寻找的：

```
function doRefreshOnce(){
    if(localStorage["refreshed"]=="false"){
        localStorage["refreshed"]="true"
        location.reload();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:26:10.997

一次是什么意思？

曾经吗？每个用户一次？每次访问一次？如果用户打开同一个页面的两个选项卡怎么办？它应该在这些选项卡之一或两者中刷新吗？

如果您需要**一次**，则需要在服务器端进行处理。

**每个用户**可以使用本地存储或 cookie 处理一次

**每次“访问”**一次（即每组标签一次）可以由 cookie 处理

**每个选项卡/访问**需要由 URL 处理一次，使用片段标识符或查询字符串。

# cordova - 第一次构建应用程序

> ID：10729128
> 
> 赞同：0
> 
> 时间：2012-05-23T23:09:42.453
> 
> 标签：cordova, extjs, dreamweaver, sencha-architect

所以我的问题基本上是网页设计师为网站构建原生应用程序的最佳途径是什么。我想采用 HTML5/jQuery 路线而不是 java/Objective C 路线。

我发现的两件事是PhoneGap 和Sencha Architect。其中之一会是我最好的行动方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:39:33.320

Sencha Architect 是付费 IDE，phonegap 是开源框架。它是两个具有不同功能的不同实体。开始学习或开始我建议采用phonegap方法。它具有良好的开发支持和大量插件来扩展您的应用程序功能。除了 phonegap 的 JS 库之外，设备种类更广泛，无需额外学习。

您可以结合使用 Jquery mobile 或 zeptoJS 以获得更好的 UI 和数据操作。

# c# - 在 ASP.NET 中从客户端更新 SQL 数据库

> ID：10729129
> 
> 赞同：0
> 
> 时间：2012-05-23T23:09:48.130
> 
> 标签：c#, javascript, asp.net, sql, sql-server

我在 Web 开发方面有点新，正在寻找从客户端更新 SQL 数据库的安全方法，或者在其他描述中更新数据库而不刷新网页（如 facebook 按钮）。我搜索了很多，发现可以通过使用 Web 服务并通过 javascript 或使用 javascript direct 或 ajax 调用它来完成，但哪种方法是最好和安全的，还有其他方法吗？谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:40:57.167

您可以使用 ajax 从客户端更新数据库。就像单击网页中的按钮一样，通过 JavaScript 或 jQuery 获取该页面的单击事件，然后通过 ajax 您可以执行数据库更新。请看下面的代码：

对于捕捉事件（比如我的按钮 id 是 button1）：

```
$('#<%=button1.ClientID%>').click(function{ 
      $.ajax({
               type: "POST",
               url: "default.aspx/UpdateDatabase",
               data: "{'textboxvalue':'" + $('<%=textbox1.ClientID%>').val() + "'}'
               contentType: "application/json;charset=utf-8",
               datatype: "json",
               success: UpdateDone
             });
}); 
```

在上面的代码中，您已将 textbox1 中的一个值传递给 Default.aspx 页面中的函数 UpdateDatabse（请将此函数定义为 [WebMethod]）。然后在此函数中进行更新并返回一些字符串或布尔值，以便您可以判断更新已完成，然后成功的值是函数的名称，如果您的函数成功运行，它将运行因此在 JavaScript 或 jQuery 中定义该函数

```
 function UpdateDone(response)
    {
        if(response.d == 'done')
         { alert('Update is done');  }
        else
         { alert('Sorry Update not done'); }
    } 
```

上面的代码不会做任何你看到你的值在数据库中更新的回发。请注意，您在 C# 页面中创建的函数请将其标记为 WebMethod，它将是一个静态方法，只有您的 JavaScript 才能找到该函数。

希望这能解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:20:26.710

您使用的术语 ajax 是正确的，但已经有点老了。该街区的新孩子被称为 SPA，其中 SPA 代表单页应用程序

它将您想要实现的目标做到极致：不再刷新页面。所以这似乎是一个很好的开始方式

[这是 ASP.NET 单页应用程序主页](http://www.asp.net/single-page-application)

我的建议是研究并在其中一个（许多）javascript 框架中投入时间，这将帮助您更快地实现这一目标。手动编码 javascript 并使其跨浏览器工作是太多的工作。ASP.NET 团队选择 upshot.js 来解决您的问题，这似乎是一个不错的选择。

![在此处输入图像描述](../Images/dc6f4577b1457a9e0be2837279b45681.png)

从[这里截屏](http://www.asp.net/single-page-application/an-introduction-to-spa/overview/landingpage)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:29:03.480

我发现使用 ASP.NET MVC 3 使用 JSON 执行 AJAX 是执行 AJAX 请求的最简单方法。然后，您可以使用特定的操作方法来处理请求并通过实体框架（EF）对数据库进行更新。

本质上只传递 JSON 中需要更新的数据。MVC Action 从那里接收 JSON，并使用 EF 查找数据库记录，应用/保存更改。它甚至可以响应一条成功消息，您的 AJAX 可以使用该消息来更新验证数据是否已为用户保存的某些字段（您甚至可以在第一个 ajax 请求和响应。）

这将允许您在不刷新页面的情况下发送请求。您的所有数据库访问代码都将在 Action 方法中位于服务器端。

这个例子展示了你可以如何做一个 json 请求。您可以通过向 Create 方法添加额外的代码来修改它，以与实体框架（或您选择的数据库工具）交互，以根据`Person person`传入的参数更新记录（注意 MVC 在转换 json 数据方面做得非常好进入一个很好的`Person`班级！）

[http://juristr.com/blog/2011/08/posting-json-data-to-aspnet-mvc-3-web/](http://juristr.com/blog/2011/08/posting-json-data-to-aspnet-mvc-3-web/)

如果用户将在 web 表单中输入的数据是敏感数据，则您需要在发送 json 请求之前对其进行加密。我个人只是将网站设置为使用 SSL。您自己制作的任何东西都可能不如 SSL 安全。

添加到 Create 方法的代码可能如下所示：

```
//Find the person that they are attempting to edit
Person currentPerson = db.Persons.Find(person.PersonKey);
//update the database fields based on the submitted data(I would probably actually use AutoMapper for this
currentPerson.Name = person.Name;
currentPerson.DateOfBith = person.DateOfBirth;
//etc.
db.SaveChanges();

//compose a JSON response object indicating success, you would want to combine this with a try catch in the above to reply regarding failures as well 
```

# ruby - 是否有针对大型二维数组的搜索算法？

> ID：10729131
> 
> 赞同：1
> 
> 时间：2012-05-23T23:09:51.757
> 
> 标签：ruby, algorithm, search, multidimensional-array

这不是一个现实生活中的问题，它只是理论制作。

我有一个大数组，它由诸如`[1,140,245,123443]`、所有整数或具有低选择性的浮点数之类的元素组成，并且唯一值的数量是数组大小的十倍。在这种情况下，B*tree 索引并不好。

我也尝试实现位图索引，但在 Ruby 中，二进制操作并没有那么快。

有没有什么好的算法来搜索固定大小向量的二维数组？

而且，主要问题是，如何将向量转换为值，其中转换函数必须是单调的，因此我可以应用范围查询，例如：

```
(v[0]<10, v[2]>100, v[3]=32, 0.67*10^-8<v[4]<1.2154241410*10^-6) 
```

我唯一的想法是为向量的每个组件创建单独的排序索引...然后进行二进制搜索并合并...但这是一个坏主意，因为在最坏的情况下，它将需要 O(N*N) 操作。 ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:25:50.020

假设每个“列”模糊地均匀分布在已知范围内，您可以跟踪每列的一系列存储桶，以及满足存储桶的行列表。每列的桶数可以相同或不同，这完全是任意的。更多的桶更快，但会占用*更多*的内存。

```
my table:
range:    {1to10} {1to4m}    {-2mto2m}
row1:     {7      3427438335 420645075}
row2:     {5      3862506151 -1555396554}
row3:     {1      2793453667 -1743457796}

buckets for column 1:
bucket{1-3} : row3
bucket{4-6} : row2
bucket{7-10} : row1

buckets for column 2:
bucket{1-2m} : 
bucket{2m-4m} : row1, row2, row4

buckets for column 3:
bucket{-2m--1m} : row2, row3
bucket{-1m-0} : 
bucket{0-1m} : 
bucket{1m-2m} : row1 
```

然后，给定一系列标准：`{v[0]<=5, v[2]>3*10^10}`，我们拉出符合该标准的*桶*：

```
 column 1:
v[0]<=5 matches buckets {1-3} and {4-6}, which is rows 2 and 3.
 column 2:
v[2]>3*10^10} matches buckets {2m-4m} and {4-6}, which is rows 1, 2 and 3.
 column 3:
"" matches all , which is rows 1, 2 and 3. 
```

现在我们知道我们要查找的行满足所有三个条件，因此我们列出了桶中匹配所有条件的所有行，在本例中为第 2 行和第 3 行。此时，即使对于*大量*数据，剩余的行数也会很少，具体取决于存储桶的粒度。您只需检查此时剩下的每一行，看看它们是否匹配。在此示例中，我们看到第 2 行匹配，但第 3 行不匹配。

这个算法在*技术上*是O(n)，但在实践中，如果你有大量的小桶，这个算法可以*非常*快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:16:47.400

使用索引:)

基本思想是将二维数组转换为一维排序数组（同时保持原始位置）并在后面应用二进制搜索。

此方法适用于任何 n 维数组，并被数据库广泛使用，可以将其视为具有可变长度的维数组。

# sql-server-2008 - edmx ADO.NET 从表生成，但表未显示

> ID：10729136
> 
> 赞同：0
> 
> 时间：2012-05-23T23:10:22.277
> 
> 标签：sql-server-2008, ado.net, edmx

编辑：我也在使用 MS SQL server 2008 R2。

好吧，在远程服务器上，我在 edmx 的向导中显示了一些表，但是在我的本地数据库中，我创建了一个所有者为 yyyyyy 的数据库。作为那个所有者，我在执行查询中运行了一些相当简单的 DDL 来创建一个像这样的简单表

```
USE [Override]
GO

/****** Object:  Table [dbo].[Errors]    Script Date: 05/18/2012 16:08:19 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Errors]') AND type in (N'U'))
DROP TABLE [dbo].[Errors]
GO

USE [Override]
GO

/****** Object:  Table [dbo].[Errors]    Script Date: 05/18/2012 16:08:19 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Errors](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Code] [int] NOT NULL,
    [Description] [nvarchar](max) NULL,
 CONSTRAINT [PK_Errors] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

在此之后，我右键单击我的 edmx 文件并说从数据库更新并为其提供新连接并使用 yyyyy 用户。好吧，有一个表格复选框，但它下面没有任何内容。就像没有桌子一样。

出于某种原因，我的远程数据库“工作一半”。我在遥控器中创建的任何表都会显示以供生成，但现有表都没有。

注意：然后我尝试使用我的“sa”用户，因为我认为他将拥有至高无上的权力并且肯定会看到表格，但即使这样也无济于事。关于为什么这些东西不起作用的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:16:17.803

在我的头撞到墙上后终于找到了答案。您必须创建一个全新的模型，而不是使用旧模型。如果您更换连接或其他东西，就会出现问题。新模型像这样与您的服务器背道而驰

```
<Server>/<instance>.<Databasename>.dbo 
```

我没想到，因为这是我第一次生成 ADO.NET

# sql - 使用 SQL 显示出现的 NULL 值和总体重复项

> ID：10729137
> 
> 赞同：0
> 
> 时间：2012-05-23T23:10:23.023
> 
> 标签：sql, tsql

使用如下数据，我需要生成一个报告，报告返回 NULL 的记录数和重复数，如果可能，所有这些都使用一个 SQL 查询。

```
DES   |  VAL
--------------
Tango |  32
Zulu  |  [null]
Golf  |  12
Golf  |  12
Bravo |  [null] 
```

该报告将如下所示：

```
NULLS  |  DUPLICATES
---------------------
  2    |    1 
```

我可以使用`SUM(CASE VAL WHEN NULL THEN 1 ELSE 0 END) AS NULLS`, 和单独的重复项来获取空值，但不能作为一个查询，所以我什至不知道这是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:18:42.610

```
SELECT
  (SELECT COUNT(*) FROM table_name WHERE val IS NULL) 
    AS NULLS,
  (SELECT ( COUNT(val) - COUNT(DISTINCT(val)) ) FROM table_name) 
    AS DUPLICATES 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:17:14.627

好吧，如果您有 2 个选择返回标量值，您想将它们组合成一个简单的报告，您可以这样做：

```
SELECT 
2 AS NULLS,
DUPS
FROM (SELECT 1 AS DUPS) D 
```

结果：

```
NULLS       DUPS
----------- -----------
2           1 
```

根据需要替换两个选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T02:24:12.773

假设（？！）您想要计算重复行，这可能接近您想要的：

```
declare @Foo as Table ( DES VarChar(10), VAL Int Null )
insert into @Foo ( DES, VAL ) values
  ( 'Tango', 32 ),
  ( 'Zulu', NULL ),
  ( 'Golf', 12 ), ( 'Golf', 12 ), ( 'Golf', 13 ),
  ( 'Bravo', NULL ),
  ( 'Whiskey', 8388 ), ( 'Whiskey', 8388 ), ( 'Whiskey', 8388 ), ( 'Whiskey', 8388 )

select * from @Foo

select distinct DES, VAL from @Foo

select ( select Count( 42 ) from @Foo where VAL is NULL ) as [NULLS],
  ( select Count( 42 ) from @Foo ) - Count( 42 ) as [DUPLICATES] from ( select distinct DES, VAL from @Foo ) as Elmer 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:53:48.097

不知道你想如何计算你的重复，所以我包括了两个版本。

```
declare @T table
(
  DES varchar(10),
  VAL int
)

insert into @T values
('Tango',   32),
('Zulu',    null),
('Zulu',    null),
('Zulu',    null),
('Golf',    12),
('Golf',    12),
('Bravo',   null)

select sum(case when T.VAL is null then C end) as NULLS,
       sum(case when T.C > 1 then C-1 end) as DUPLICATES1,
       sum(case when T.C > 1 then 1 end) as DUPLICATES2
from (
       select VAL, count(*) as C
       from @T
       group by DES, VAL
     ) T 
```

结果：

```
NULLS       DUPLICATES1 DUPLICATES2
----------- ----------- -----------
4           3           2 
```

# facebook - 在 Facebook 上分享围墙花园后面的链接

> ID：10729148
> 
> 赞同：0
> 
> 时间：2012-05-23T23:12:26.427
> 
> 标签：facebook, hyperlink

我有一个网站，既可以发布到用户的 Facebook 墙上，也可以让他/她通过私人 Facebook 消息分享链接。

我们想要分享的链接可以在有围墙的花园后面，这意味着您必须登录到我们的网站才能看到它们。问题是 Facebook 最终共享重定向链接而不是原始链接。

处理这个用例的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:16:23.287

您需要使用 og 元标记、元刷新、url 标记或带有 document.location 的某些脚本生成“假”页面。此页面不需要登录，并且必须仅包含共享信息。

# eclipse - 在哪里可以找到用于 GlassFish 3.1.2 的 Eclipse JPA Facet 的“用户库”？

> ID：10729149
> 
> 赞同：12
> 
> 时间：2012-05-23T23:12:31.013
> 
> 标签：eclipse, jpa, glassfish

我有 Eclipse (Indigo) 和 GlassFish 3.1.2

“新建 JPA 项目”向导出现错误“必须选择至少一个用户库”。但是列表中没有任何内容。

GlassFish 目录中是否已经有 JPA 实现，我应该创建一个指向它的用户库吗？或者我应该使用下载选项并从网上获取最新版本的 Eclipse Link？

只是想知道使错误消失的“正确”方法是什么。

谢谢，罗伯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-03-29T12:31:00.107

以下对我有用：

单击右侧的“带磁盘向下箭头”图标，然后下载最新的 EclipseLink。

[![在此处输入图像描述](../Images/a5bf8acc21b3477bb30ff9725185fd8c.png)](https://i.stack.imgur.com/xllUt.png)

在屏幕上选择确定，您就准备好了！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-29T13:16:57.500

你需要有很多 JSF2.0 项目的 jars。

您可以使用两种库来实现 JSF2.0：

1) 莫哈拉

2) 我的脸

阅读这个优秀的教程：

[http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.jst.jsf.doc.user%2Fhtml%2Fgettingstarted%2Ftutorial%2FJSFTools_tutorial_JSF20.html](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.jst.jsf.doc.user%2Fhtml%2Fgettingstarted%2Ftutorial%2FJSFTools_tutorial_JSF20.html)

在本教程中，您将了解为什么需要具有 JSF 特定库的用户库。

很好的阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-06T13:03:03.573

Glassfish 确实包含所需的 JPA 实现文件。将以下文件添加到用户库应该可以解决问题。

*   glassfish_dir/glassfish/modules/javax.persistence.jar
*   glassfish_dir/glassfish/modules/org.eclipse.persistence.core.jar
*   glassfish_dir/glassfish/modules/org.eclipse.persistence.jpa.jar

# ios5 - 静态表格视图 - 拨打电话号码的披露指示器

> ID：10729155
> 
> 赞同：0
> 
> 时间：2012-05-23T23:13:36.647
> 
> 标签：ios5, uitableview, uistoryboard

我有一个表视图设置为静态。它有 4 个单元格。前两个单元格映射到另一个视图，以便正常工作，

我希望其他 2 个单元格拨打电话号码或启动电子邮件。我已经有了这两个函数的代码。我只是不知道谁将单元格选择的动作映射到代码中的函数。当我右键单击单元格时，我只看到 segue 的推送操作，但我想在代码中控制它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:59:45.477

打开故事板文件，然后单击 Xcode 右上角的 Assistant Editor 按钮。它应该打开与视图关联的视图控制器的头文件。现在按住 Ctrl 并拖动要挂接代码的单元格并将其拖动到头文件中。这将为您创建一个 IBAction。现在它已连接，您可以调用您创建的方法来处理呼叫或电子邮件。

# c# - 系统地替换命名空间

> ID：10729164
> 
> 赞同：1
> 
> 时间：2012-05-23T23:14:48.343
> 
> 标签：c#, .net, namespaces, refactoring

所以我有一个巨大的 C#/ASP.NET 应用程序，现在它被重新用于其他项目。我想将我们的项目特定名称空间更改为更通用的名称。

在命名空间名称上使用右键单击重构只会全局更改该特定文件的导入。这将是一场巨大的手工考验。有没有比仔细查找和替换更好的方法呢？

此外，我们使用代码隐藏，因此前端的 aspx 页面也必须更改其导入的命名空间。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Read.aspx.cs" Inherits="ProjectSpecificNamespace.Read" %> 
```

当然，cs 文件导入和内联代码页中的任何引用也必须更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:22:30.720

如果您有 ReSharper，您可以更改文件夹名称，然后“调整命名空间” - 如果您想更改整个程序集的默认命名空间，您可以在项目属性中编辑该设置，*然后*调整命名空间。您可以通过这种方式一键调整整个解决方案中的所有命名空间。

# c# - 重命名文件的最佳有效方法

> ID：10729165
> 
> 赞同：1
> 
> 时间：2012-05-23T23:14:55.480
> 
> 标签：c#, wpf

我有一个 wpf 应用程序，并且在该应用程序中使用 Image resizer 作为第三方工具。我正在尝试实现以下场景：

我有文本框（员工姓名），例如“Madona”
我有一个与第三方工具“Image Resizer”链接的图像文本框。

如果我选择图像（例如`Madona123.jpg`：），图像调整器将生成 17 个不同大小的图像并将其放入我的源文件夹（例如`Madona123_80x60.jpg`，`Madona123_150x150.jpg`等）

但我正在尝试更改文件名，例如： `Madona_80x60.jpg`，`Madona_150x150.jpg`

我有两种选择，但不确定哪一种有效

*   从图像所在的源文件夹创建 Temp Dir 并根据“员工姓名”更改名称并将该图像传递给“图像调整器”工具

*   在目标文件夹中生成图像后，更改文件名。

我不确定哪一个是最好的，我还需要注意哪些其他问题，谢谢您的意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:22:20.660

选项 1 有一个额外的复制命令 - 您可以在复制时重命名。但是使用选项 2，您有多个重命名。为了简单起见，我会做 1 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:10:30.933

从您建议的场景中，我会选择选项 2。

*   正如您所说，创建一个额外的临时文件夹可能会导致权限问题，因此如果您不完全确定将使用该应用程序的机器的设置，那么选项 1 可能会导致您的应用程序失败。
*   作为次要（也是非常次要的）原因，选项 2 将，即使它没有在权限上失败，仍然会创建一个额外的文件夹。如果您选择将该临时文件夹作为应用程序的一部分，人们倾向于删除临时文件夹及其内容。或者您可以在每次启动应用程序时创建它，但这也需要一点点编码. （尽管采取了一点，这只是一个次要的原因，而不是真正的原因会倾斜天平..）

我确实同意 Blam 的说法，即选项一会使基础编码更简单一些，但我认为还是要做一些额外的工作，选项 2 会减少失败的可能性。

因此，如果您要在知道目标机器设置的可管理环境中使用它，请使用选项一，如果您要在任何其他类型的环境中使用它，它需要的编码越来越简单，选择选项 2。它会给你最大的成功机会。

# javascript - Javascript 中的 XML 文件，getElementByAttribute

> ID：10729166
> 
> 赞同：1
> 
> 时间：2012-05-23T23:14:56.813
> 
> 标签：javascript, xml, getelementsbytagname

假设我有一个这样的 XML 文件：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<MIDIFile>

  <Event>
    <Absolute>0</Absolute>
    <NoteOn Channel="1" Note="40" Velocity="64"/>
  </Event>
  <Event>
    <Absolute>236</Absolute>
    <NoteOff Channel="1" Note="40" Velocity="0"/>
  </Event>

</MIDIFile> 
```

感谢[一些很棒的教程](http://www.w3schools.com/xml/xml_to_html.asp)，我现在知道如何在我的 javascript 中获取这些值。

例如，我可以遍历所有“事件”标签并获得“绝对”值，如下所示：

```
xmlhttp=new XMLHttpRequest();

xmlhttp.open("GET","test.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;

// make an array with all the events from the xml file
var events = xmlDoc.getElementsByTagName("Event")

for (var i = 0; i<events.length; i++)
console.log(events[i].getElementsByTagName("Absolute")[0].childNodes[0].nodeValue) 
```

这将返回

```
0
236 
```

现在，我怎么能访问“NoteOn”属性并获取它的值？我想遍历 XML 中的所有事件，看看它们是否包含 NoteOn 或 NoteOff 并加载一个包含所有音符、它们的持续时间、速度和通道的数组。

请帮我！`getElementsByTagName("NoteOn")`只是不起作用......如果它可能有帮助，这里有一些截图，如果我会发生什么`console.log(xmlDoc)`

提前非常感谢！

![屏幕](../Images/729f7abd82f5b6097a656331d46937c6.png)

* * *

**编辑以响应答案**。当我尝试这样做时：

```
var noteon = xmlDoc.getElementsByTagName('noteon');
console.log(noteon) 
```

结果就是这个

```
[] 
```

重新编辑：如果我写“NoteOn”而不是“noteon”，它会起作用！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:23:51.610

```
var noteon = xmlDoc.getElementsByTagName('noteon');
var note = new Array;
for(var i = 0; i < noteon.length; i++){
    note[i] = noteon[i].getAttribute('Note'); // or any of the attributes you want to get
} 
```

**编辑：**

如果`noteon = []`那时你有 2 个选项，你可以把整个事情放在一个 try catch 中，而不是在 javascript 中做的最好的事情，或者你可以把它放在一个 if 语句中。像这样的东西应该工作：

```
var noteon = xmlDoc.getElementsByTagName('noteon');
var noteoff = xmlDoc.getElementsByTagName('noteoff');
var note = new Array;

if(noteon != []){
    for(var i = 0; i < noteon.length; i++){
        note[i] = noteon[i].getAttribute('Note'); // or any of the attributes you want to get
} else if(noteoff != []){
    for(var i = 0; i < noteoff.length; i++){
        note[i] = noteoff[i].getAttribute('Note'); // or any of the attributes you want to get
} else{
    return;  //makes sure the function returns to the call even if nothing was found
}
} 
```

# entity-framework - 在一个工作单元上准备多个 EF 上下文 - TransactionScope

> ID：10729171
> 
> 赞同：6
> 
> 时间：2012-05-23T23:15:40.723
> 
> 标签：entity-framework, transactions, transactionscope, unit-of-work

我正在考虑实现单个工作单元来处理多个数据源的选项 - 实体框架。我想出了一个试探性的方法——现在处理一个单一的上下文——但这显然不是一个好主意。

如果我们分析下面的代码，你会认为这是一个糟糕的实现吗？事务范围的生命周期是一个潜在的问题吗？

当然，如果我们用不同的上下文包装事务范围，如果第二个 context.SaveChanges() 失败，我们就会被覆盖......

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Transactions;

    namespace ConsoleApplication2
    {
        class Program
        {
            static void Main(string[] args)
            {
                using(UnitOfWork unitOfWork = new UnitOfWork())
                {

                    var repository = new EmployeeRepository(unitOfWork);

                    var employee = repository.CreateOrGetEmployee("Whatever Name");

                    Console.Write(employee.Id);

                    unitOfWork.SaveChanges();
                }
            }
        }

        class UnitOfWork : IDisposable
        {
            TestEntities _context;
            TransactionScope _scope;
            public UnitOfWork()
            {
                _scope = new TransactionScope();
                _context = new TestEntities();
            }

            public void SaveChanges()
            {
                _context.SaveChanges();
                _scope.Complete();
            }

            public TestEntities Context
            {
                get
                {
                    return _context;
                }
            }

            public void Dispose()
            {
                _scope.Dispose();
                _context.Dispose();
            }
        }

        class EmployeeRepository
        {
            UnitOfWork _unitOfWork;

            public EmployeeRepository(UnitOfWork unitOfWork)
            {
                _unitOfWork = unitOfWork;
            }

            public Employee GetEmployeeById(int employeeId)
            {
                return _unitOfWork.Context.Employees.SingleOrDefault(e => e.Id == employeeId);
            }

            public Employee CreateEmployee(string fullName)
            {
                Employee employee = new Employee();
                employee.FullName = fullName;
                _unitOfWork.Context.SaveChanges();
                return employee;
            }

            public Employee CreateOrGetEmployee(string fullName)
            {
                var employee = _unitOfWork.Context.Employees.FirstOrDefault(e => e.FullName == fullName);
                if (employee == null)
                {
                    employee = new Employee();
                    employee.FullName = fullName;
                    this.AddEmployee(employee);
                }
                return employee;
            }

            public Employee AddEmployee(Employee employee)
            {
                _unitOfWork.Context.Employees.AddObject(employee);
                _unitOfWork.Context.SaveChanges();
                return employee;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T08:17:06.397

为什么从`TransactionScope`构造函数开始？您只需要它来保存更改。

```
public void SaveChanges()
{
    // SaveChanges also uses transaction which uses by default ReadCommitted isolation
    // level but TransactionScope uses by default more restrictive Serializable isolation
    // level 
    using (var scope = new TransactionScope(TransactionScopeOption.Required,
                                            new TransactionOptions { IsolationLevel = IsolationLevel.ReadCommitted }))
    {
        _context.SaveChanges();
        scope.Complete();
    }
} 
```

如果您想拥有具有更多上下文的工作单元，您只需将所有这些上下文包装在同一个工作单元类中。你`SaveChanges`会变得有点复杂：

```
public void SaveChanges()
{
    using (var scope = new TransactionScope(TransactionScopeOption.Required,
                                            new TransactionOptions { IsolationLevel = IsolationLevel.ReadCommitted }))
    {
        _contextA.SaveChanges(SaveOptions.DetectChangesBeforeSave);
        _contextB.SaveChanges(SaveOptions.DetectChangesBeforeSave);
        scope.Complete();
        _contextA.AcceptAllChanges();
        _contextB.AcceptAllChanges(); 
    }
} 
```

此版本将保存操作与重置上下文的内部状态分开。原因是如果第一个上下文成功保存更改但第二个触发异常，则事务将回滚。因此，我们不希望第一个上下文已经将所有更改都清除为已接受（我们将丢失有关已执行更改的信息，并且我们将无法再次保存它们）。

# json - 对象上的 jqGrid JSON 表示法

> ID：10729173
> 
> 赞同：1
> 
> 时间：2012-05-23T23:15:55.430
> 
> 标签：json, jqgrid, notation

那里！
我的 jqGrid 中有一列是空的。
但我检查了 chrome 控制台上的对象，这很好。

**col模型定义**

```
colModel:[
    {name:'id',index:'id', width:55,editable:false,editoptions:{readonly:true,size:10},hidden:true},
    {name:'firstName',index:'firstName', width:100,searchoptions: { sopt: ['eq', 'ne', 'cn']}},
    {name:'lastName',index:'lastName', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
    {name:'books[0].nome',index:'books[0].nome', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
    {"formatter":"myfunction", formatoptions:{baseLinkUrl:'/demo/{firstName}|view-icon'}}
] 
```

**JSON 响应**

```
{
    "total": "10",
    "page": "1",
    "records": "3",
    "rows": [
        {
            "id": 1,
            "firstName": "John",
            "lastName": "Smith",
            "books": [{"nome": "HeadFirst"}]
        },
        {
            "id": 2,
            "firstName": "Jane",
            "lastName": "Adams",
            "books": [{"nome": "DalaiLama"}]
        },
        {
            "id": 35,
            "firstName": "Jeff",
            "lastName": "Mayer",
            "books": [{"nome": "Bobymarley"}]
        }
    ]
} 
```

**chrome 控制台检查对象**

```
rowdata.books[0].nome
"HeadFirst" 
```

有人知道哪里有可能的技巧吗？

谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:15:30.210

您应该仅将可用作 JavaScript 中的属性名称和 CSS id 名称的名称用作属性`name`值。`colModel`所以使用的`name:'books[0].nome'`不是一个好主意。

要解决您的问题，您可以使用`jsonmap`. 例如，您可以使用点名转换：

```
{name: 'nome', jsonmap: 'books.0.nome', ... 
```

在更复杂的情况下，您可以使用函数作为 的值`jsonmap`。例如

```
{name: 'nome', jsonmap: function (item) {
        return item.books[0].nome;
    }, ... 
```

`jsonmap`您可以在其他旧答案中找到更多关于使用的代码示例： [here](https://stackoverflow.com/a/2706620/315935)、[here](https://stackoverflow.com/a/4641118/315935)、[here](https://stackoverflow.com/a/6904980/315935)、[here](https://stackoverflow.com/a/8150904/315935)、[here](https://stackoverflow.com/a/9867370/315935)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:58:41.697

`name`旨在成为行的唯一名称，而不是对 JSON 对象的引用。从[jqGrid colModel 选项文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acolmodel_options)：

> 在网格中为列设置唯一名称。此属性是必需的。除了用作属性/事件名称的其他词外，保留字（不能用于名称）包括 subgrid、cb 和 rn。

您还可以观察`.name`在[grid.base.js](https://github.com/tonytomov/jqGrid/blob/master/js/grid.base.js)中的使用方式- 例如：

```
var nm = {},
...
nm = $t.p.colModel[i].name;
...
res[nm] = $.unformat.call($t,this,{rowId:ind.id, colModel:$t.p.colModel[i]},i); 
```

* * *

无论如何，回到你的问题，我认为通过直接传递书名 - 作为字符串而不是对象 - 并通过名称将其引用为类似`bookName`.

# android - 在 Android 4.0.1 上移除动画后，CSS3 translate3d 会不断重复

> ID：10729175
> 
> 赞同：1
> 
> 时间：2012-05-23T23:16:04.717
> 
> 标签：android, animation, infinite, translate3d

我想要将旋转动画应用于 div，它会不断重复，直到我希望它停止。

我向我的 div 添加了包含动画参数的类“旋转”，然后使用 el.removeClass('spinning') 从 div 中删除了类“旋转”

动画有效，一旦我在 Chrome 和 Safari 中删除类，动画就会停止。但是在我的 Android 测试设备（4.0.1）上，动画不会停止，并且会在删除动画类时不断重复。

这是“旋转”类的代码和我的动画的其余部分：

```
 .spinning {
      @include animate-spinning;
    }

    @mixin animate-spinning {

    // Experimental mixin from Compass - see footnote below **
      @include experimental(animation-name, spinning-animation);
      @include experimental(animation-duration, 2s);
        @include experimental(animation-timing-function, linear);
        @include experimental(animation-iteration-count, infinite);
    }

    @-webkit-keyframes spinning-animation {
      0% {-webkit-transform: translate3d(0,-2432px,0);}
      100% {-webkit-transform: translate3d(0,0,0);}
    }

    ** Experimental mixin
    // This mixin provides basic support for CSS3 properties and
    // their corresponding experimental CSS2 properties when the
    // implementations are identical except for the property prefix. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-09T12:47:34.377

这解决了我的（非常相似的）问题：

```
$el.removeClass('THE_ANIMATION').css('opacity', 0.99);
window.setTimeout(function () {
  $el.css('opacity', 1); 
}, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T08:39:23.287

我不知道你的 CSS，但我遇到了同样的问题 - 我的解决方案是删除 overflow: hidden; 从我的容器元素。仅当容器具有动画子项时才会出现此问题。

请参阅[在 Android 浏览器中难以停止无限的 CSS 动画](https://stackoverflow.com/questions/13057575/difficult-to-stop-infinite-css-animation-in-android-browser/13064630)。

# excel - Excel vba：将范围创建为另一个范围的子范围时可能出现错误

> ID：10729179
> 
> 赞同：2
> 
> 时间：2012-05-23T23:16:25.713
> 
> 标签：excel, vba

我创建了以下 sub 来简单地说明问题。我将活动工作表的范围 A2:E10 分配给范围变量。然后，对于另一个范围变量，我将这个范围的子范围，单元格 (1, 1) 分配给 (3, 3)。

我原以为这将包括 A2 到 C4 的范围（因为 A2 是第一列，较大范围的第一行）。但是，当我调用每个范围的第一个单元格的 .Row 方法时，我会得到不同的结果：较大的范围 r 返回“2”，而较小的范围 rSub 返回“3”。

（.Row 方法返回调用它的范围的绝对行）

我希望这两个调用都返回 2，因为它们都应该引用单元格 A2。谁能解释为什么不是这样？

*编辑：我刚刚更改了 sub 以便它调用每个范围的第一个单元格的 .Column 方法，就像它调用 .Row 方法一样。如您所料，这将为两个范围返回“1”。

```
Sub test()
    Dim r As Range
    Set r = Range("A2:E10")

    MsgBox r.Cells(1).Row     '= 2

    Dim rSub As Range
    With r
        Set rSub = .Range(.Cells(1, 1), .Cells(3, 3))
    End With

    MsgBox rSub.Cells(1).Row     '= 3
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:12:25.697

好奇怪~

我从您的代码中得到了相同的结果。我猜结果来自以下代码：

设置 rSub = .Range(.Cells(1, 1), .Cells(3, 3))

当我在 Range 之前删除点时，我得到了我们预期的结果

设置 rSub = Range(.Cells(1, 1), .Cells(3, 3)))

无论如何，我不知道为什么会这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:25:23.497

这太有趣了。

我认为括号内的 .cells(3,3) 正在解析为一个地址，该地址基本上就像范围内的偏移量。这是一个产生类似结果的更简单的版本：

```
Sub test()
Dim r As Range
Dim rSub As Range

Set r = Range("A2")
Set rSub = r.Range(r.Cells(1).Address) '"A2"
Debug.Print rSub.Cells(1).Address
End Sub 
```

该行 `Set rSub = r.Range(r.Cells(1).Address)`相当于：

`Set rSub = r.Range("A2")`解析为“A3”。

您可以通过这种方式在范围定义中使用地址。例如

```
`? Activesheet.Range("A10:A20").Range("A2").Address` yields `$A$11` 
```

我意识到您没有在代码中的任何地方使用“地址”，但就像我说的，我认为它可以解析为地址。在我的示例中，如果我删除“地址”，则会出现运行时错误。

# cuda - 在 CUDA 扭曲级别减少中删除 __syncthreads()

> ID：10729185
> 
> 赞同：5
> 
> 时间：2012-05-23T23:17:15.097
> 
> 标签：cuda, gpu-warp

以下代码将`32`数组中的每个元素与每个`32`元素组的第一个元素相加：

```
int i = threadIdx.x;
int warpid = i&31;
if(warpid < 16){
    s_buf[i] += s_buf[i+16];__syncthreads();
    s_buf[i] += s_buf[i+8];__syncthreads();
    s_buf[i] += s_buf[i+4];__syncthreads();
    s_buf[i] += s_buf[i+2];__syncthreads();
    s_buf[i] += s_buf[i+1];__syncthreads();
} 
```

我以为我可以消除`__syncthreads()`代码中的所有内容，因为所有操作都是在同一个经线中完成的。但是如果我消除它们，我会得到垃圾结果。它不会对性能产生太大影响，但我想知道为什么我需要`__syncthreads()`这里。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-30T16:32:16.260

我在这里提供一个答案，因为我认为以上两个并不完全令人满意。这个答案的“知识产权”属于 Mark Harris，他在本[演示文稿](http://developer.download.nvidia.com/assets/cuda/files/reduction.pdf)（幻灯片 22）中指出了这个问题，以及 @talonmies，他在上面的评论中向 OP 指出了这个问题。

让我首先尝试恢复 OP 的要求，过滤他的错误。

OP 似乎正在处理减少共享内存的最后一步，即通过循环展开来减少*扭曲。*他正在做类似的事情

```
template <class T>
__device__ void warpReduce(T *sdata, int tid) {
    sdata[tid] += sdata[tid + 32];
    sdata[tid] += sdata[tid + 16];
    sdata[tid] += sdata[tid + 8];
    sdata[tid] += sdata[tid + 4];
    sdata[tid] += sdata[tid + 2];
    sdata[tid] += sdata[tid + 1];
}

template <class T>
__global__ void reduce4_no_synchthreads(T *g_idata, T *g_odata, unsigned int N)
{
    extern __shared__ T sdata[];

    unsigned int tid    = threadIdx.x;                              // Local thread index
    unsigned int i = blockIdx.x*(blockDim.x*2) + threadIdx.x;       // Global thread index - Fictitiously double the block dimension

    // --- Performs the first level of reduction in registers when reading from global memory. 
    T mySum = (i < N) ? g_idata[i] : 0;
    if (i + blockDim.x < N) mySum += g_idata[i+blockDim.x];
    sdata[tid] = mySum;

    // --- Before going further, we have to make sure that all the shared memory loads have been completed
    __syncthreads();

    // --- Reduction in shared memory. Only half of the threads contribute to reduction.
    for (unsigned int s=blockDim.x/2; s>32; s>>=1)
    {
        if (tid < s) { sdata[tid] = mySum = mySum + sdata[tid + s]; }
        // --- At the end of each iteration loop, we have to make sure that all memory operations have been completed
        __syncthreads();
    }

    // --- Single warp reduction by loop unrolling. Assuming blockDim.x >64
    if (tid < 32) warpReduce(sdata, tid);

    // --- Write result for this block to global memory. At the end of the kernel, global memory will contain the results for the summations of
    //     individual blocks
    if (tid == 0) g_odata[blockIdx.x] = sdata[0];
} 
```

正如 Mark Harris 和 talonmies 所指出的，共享内存变量`sdata`必须声明为`volatile`，以防止编译器优化。`__device__`因此，定义上述函数的正确方法是：

```
template <class T>
__device__ void warpReduce(volatile T *sdata, int tid) {
    sdata[tid] += sdata[tid + 32];
    sdata[tid] += sdata[tid + 16];
    sdata[tid] += sdata[tid + 8];
    sdata[tid] += sdata[tid + 4];
    sdata[tid] += sdata[tid + 2];
    sdata[tid] += sdata[tid + 1];
} 
```

现在让我们看看对应于上述两种情况的反汇编代码，即`sdata`声明为非`volatile`或`volatile`（为费米架构编译的代码）。

*不是`volatile`*

```
 /*0000*/         MOV R1, c[0x1][0x100];                          /* 0x2800440400005de4 */
    /*0008*/         S2R R0, SR_CTAID.X;                             /* 0x2c00000094001c04 */
    /*0010*/         SHL R3, R0, 0x1;                                /* 0x6000c0000400dc03 */
    /*0018*/         S2R R2, SR_TID.X;                               /* 0x2c00000084009c04 */
    /*0020*/         IMAD R3, R3, c[0x0][0x8], R2;                   /* 0x200440002030dca3 */
    /*0028*/         IADD R4, R3, c[0x0][0x8];                       /* 0x4800400020311c03 */
    /*0030*/         ISETP.LT.U32.AND P0, PT, R3, c[0x0][0x28], PT;  /* 0x188e4000a031dc03 */
    /*0038*/         ISETP.GE.U32.AND P1, PT, R4, c[0x0][0x28], PT;  /* 0x1b0e4000a043dc03 */
    /*0040*/     @P0 ISCADD R3, R3, c[0x0][0x20], 0x2;               /* 0x400040008030c043 */
    /*0048*/    @!P1 ISCADD R4, R4, c[0x0][0x20], 0x2;               /* 0x4000400080412443 */
    /*0050*/    @!P0 MOV R5, RZ;                                     /* 0x28000000fc0161e4 */
    /*0058*/    @!P1 LD R4, [R4];                                    /* 0x8000000000412485 */
    /*0060*/     @P0 LD R5, [R3];                                    /* 0x8000000000314085 */
    /*0068*/         SHL R3, R2, 0x2;                                /* 0x6000c0000820dc03 */
    /*0070*/         NOP;                                            /* 0x4000000000001de4 */
    /*0078*/    @!P1 IADD R5, R4, R5;                                /* 0x4800000014416403 */
    /*0080*/         MOV R4, c[0x0][0x8];                            /* 0x2800400020011de4 */
    /*0088*/         STS [R3], R5;                                   /* 0xc900000000315c85 */
    /*0090*/         BAR.RED.POPC RZ, RZ, RZ, PT;                    /* 0x50ee0000ffffdc04 */
    /*0098*/         MOV R6, c[0x0][0x8];                            /* 0x2800400020019de4 */
    /*00a0*/         ISETP.LT.U32.AND P0, PT, R6, 0x42, PT;          /* 0x188ec0010861dc03 */
    /*00a8*/     @P0 BRA 0x118;                                      /* 0x40000001a00001e7 */
    /*00b0*/         NOP;                                            /* 0x4000000000001de4 */
    /*00b8*/         NOP;                                            /* 0x4000000000001de4 */
    /*00c0*/         MOV R6, R4;                                     /* 0x2800000010019de4 */
    /*00c8*/         SHR.U32 R4, R4, 0x1;                            /* 0x5800c00004411c03 */
    /*00d0*/         ISETP.GE.U32.AND P0, PT, R2, R4, PT;            /* 0x1b0e00001021dc03 */
    /*00d8*/    @!P0 IADD R7, R4, R2;                                /* 0x480000000841e003 */
    /*00e0*/    @!P0 SHL R7, R7, 0x2;                                /* 0x6000c0000871e003 */
    /*00e8*/    @!P0 LDS R7, [R7];                                   /* 0xc10000000071e085 */
    /*00f0*/    @!P0 IADD R5, R7, R5;                                /* 0x4800000014716003 */
    /*00f8*/    @!P0 STS [R3], R5;                                   /* 0xc900000000316085 */
    /*0100*/         BAR.RED.POPC RZ, RZ, RZ, PT;                    /* 0x50ee0000ffffdc04 */
    /*0108*/         ISETP.GT.U32.AND P0, PT, R6, 0x83, PT;          /* 0x1a0ec0020c61dc03 */
    /*0110*/     @P0 BRA 0xc0;                                       /* 0x4003fffea00001e7 */
    /*0118*/         ISETP.GT.U32.AND P0, PT, R2, 0x1f, PT;          /* 0x1a0ec0007c21dc03 */
    /*0120*/     @P0 BRA.U 0x198;                                    /* 0x40000001c00081e7 */
    /*0128*/    @!P0 LDS R8, [R3];                                   /* 0xc100000000322085 */
    /*0130*/    @!P0 LDS R5, [R3+0x80];                              /* 0xc100000200316085 */
    /*0138*/    @!P0 LDS R4, [R3+0x40];                              /* 0xc100000100312085 */
    /*0140*/    @!P0 LDS R7, [R3+0x20];                              /* 0xc10000008031e085 */
    /*0148*/    @!P0 LDS R6, [R3+0x10];                              /* 0xc10000004031a085 */
    /*0150*/    @!P0 IADD R8, R8, R5;                                /* 0x4800000014822003 */
    /*0158*/    @!P0 IADD R8, R8, R4;                                /* 0x4800000010822003 */
    /*0160*/    @!P0 LDS R5, [R3+0x8];                               /* 0xc100000020316085 */
    /*0168*/    @!P0 IADD R7, R8, R7;                                /* 0x480000001c81e003 */
    /*0170*/    @!P0 LDS R4, [R3+0x4];                               /* 0xc100000010312085 */
    /*0178*/    @!P0 IADD R6, R7, R6;                                /* 0x480000001871a003 */
    /*0180*/    @!P0 IADD R5, R6, R5;                                /* 0x4800000014616003 */
    /*0188*/    @!P0 IADD R4, R5, R4;                                /* 0x4800000010512003 */
    /*0190*/    @!P0 STS [R3], R4;                                   /* 0xc900000000312085 */
    /*0198*/         ISETP.NE.AND P0, PT, R2, RZ, PT;                /* 0x1a8e0000fc21dc23 */
    /*01a0*/     @P0 BRA.U 0x1c0;                                    /* 0x40000000600081e7 */
    /*01a8*/    @!P0 ISCADD R0, R0, c[0x0][0x24], 0x2;               /* 0x4000400090002043 */
    /*01b0*/    @!P0 LDS R2, [RZ];                                   /* 0xc100000003f0a085 */
    /*01b8*/    @!P0 ST [R0], R2;                                    /* 0x900000000000a085 */
    /*01c0*/         EXIT;                                           /* 0x8000000000001de7 */ 
```

行`/*0128*/-/*0148*/`,`/*0160*/`和`/*0170*/`对应于共享内存加载到寄存器和行`/*0190*/`从寄存器到共享内存存储。中间线对应于总和，如在寄存器中执行的那样。因此，中间结果保存在寄存器中（对于每个线程都是私有的），并且不会每次都刷新到共享内存中，从而阻止线程对中间结果具有完全的可见性。

*`volatile`*

```
 /*0000*/         MOV R1, c[0x1][0x100];                          /* 0x2800440400005de4 */
    /*0008*/         S2R R0, SR_CTAID.X;                             /* 0x2c00000094001c04 */
    /*0010*/         SHL R3, R0, 0x1;                                /* 0x6000c0000400dc03 */
    /*0018*/         S2R R2, SR_TID.X;                               /* 0x2c00000084009c04 */
    /*0020*/         IMAD R3, R3, c[0x0][0x8], R2;                   /* 0x200440002030dca3 */
    /*0028*/         IADD R4, R3, c[0x0][0x8];                       /* 0x4800400020311c03 */
    /*0030*/         ISETP.LT.U32.AND P0, PT, R3, c[0x0][0x28], PT;  /* 0x188e4000a031dc03 */
    /*0038*/         ISETP.GE.U32.AND P1, PT, R4, c[0x0][0x28], PT;  /* 0x1b0e4000a043dc03 */
    /*0040*/     @P0 ISCADD R3, R3, c[0x0][0x20], 0x2;               /* 0x400040008030c043 */
    /*0048*/    @!P1 ISCADD R4, R4, c[0x0][0x20], 0x2;               /* 0x4000400080412443 */
    /*0050*/    @!P0 MOV R5, RZ;                                     /* 0x28000000fc0161e4 */
    /*0058*/    @!P1 LD R4, [R4];                                    /* 0x8000000000412485 */
    /*0060*/     @P0 LD R5, [R3];                                    /* 0x8000000000314085 */
    /*0068*/         SHL R3, R2, 0x2;                                /* 0x6000c0000820dc03 */
    /*0070*/         NOP;                                            /* 0x4000000000001de4 */
    /*0078*/    @!P1 IADD R5, R4, R5;                                /* 0x4800000014416403 */
    /*0080*/         MOV R4, c[0x0][0x8];                            /* 0x2800400020011de4 */
    /*0088*/         STS [R3], R5;                                   /* 0xc900000000315c85 */
    /*0090*/         BAR.RED.POPC RZ, RZ, RZ, PT;                    /* 0x50ee0000ffffdc04 */
    /*0098*/         MOV R6, c[0x0][0x8];                            /* 0x2800400020019de4 */
    /*00a0*/         ISETP.LT.U32.AND P0, PT, R6, 0x42, PT;          /* 0x188ec0010861dc03 */
    /*00a8*/     @P0 BRA 0x118;                                      /* 0x40000001a00001e7 */
    /*00b0*/         NOP;                                            /* 0x4000000000001de4 */
    /*00b8*/         NOP;                                            /* 0x4000000000001de4 */
    /*00c0*/         MOV R6, R4;                                     /* 0x2800000010019de4 */
    /*00c8*/         SHR.U32 R4, R4, 0x1;                            /* 0x5800c00004411c03 */
    /*00d0*/         ISETP.GE.U32.AND P0, PT, R2, R4, PT;            /* 0x1b0e00001021dc03 */
    /*00d8*/    @!P0 IADD R7, R4, R2;                                /* 0x480000000841e003 */
    /*00e0*/    @!P0 SHL R7, R7, 0x2;                                /* 0x6000c0000871e003 */
    /*00e8*/    @!P0 LDS R7, [R7];                                   /* 0xc10000000071e085 */
    /*00f0*/    @!P0 IADD R5, R7, R5;                                /* 0x4800000014716003 */
    /*00f8*/    @!P0 STS [R3], R5;                                   /* 0xc900000000316085 */
    /*0100*/         BAR.RED.POPC RZ, RZ, RZ, PT;                    /* 0x50ee0000ffffdc04 */
    /*0108*/         ISETP.GT.U32.AND P0, PT, R6, 0x83, PT;          /* 0x1a0ec0020c61dc03 */
    /*0110*/     @P0 BRA 0xc0;                                       /* 0x4003fffea00001e7 */
    /*0118*/         ISETP.GT.U32.AND P0, PT, R2, 0x1f, PT;          /* 0x1a0ec0007c21dc03 */
    /*0120*/         SSY 0x1f0;                                      /* 0x6000000320000007 */
    /*0128*/     @P0 NOP.S;                                          /* 0x40000000000001f4 */
    /*0130*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*0138*/         LDS R4, [R3+0x80];                              /* 0xc100000200311c85 */
    /*0140*/         IADD R6, R5, R4;                                /* 0x4800000010519c03 */
    /*0148*/         STS [R3], R6;                                   /* 0xc900000000319c85 */
    /*0150*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*0158*/         LDS R4, [R3+0x40];                              /* 0xc100000100311c85 */
    /*0160*/         IADD R6, R5, R4;                                /* 0x4800000010519c03 */
    /*0168*/         STS [R3], R6;                                   /* 0xc900000000319c85 */
    /*0170*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*0178*/         LDS R4, [R3+0x20];                              /* 0xc100000080311c85 */
    /*0180*/         IADD R6, R5, R4;                                /* 0x4800000010519c03 */
    /*0188*/         STS [R3], R6;                                   /* 0xc900000000319c85 */
    /*0190*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*0198*/         LDS R4, [R3+0x10];                              /* 0xc100000040311c85 */
    /*01a0*/         IADD R6, R5, R4;                                /* 0x4800000010519c03 */
    /*01a8*/         STS [R3], R6;                                   /* 0xc900000000319c85 */
    /*01b0*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*01b8*/         LDS R4, [R3+0x8];                               /* 0xc100000020311c85 */
    /*01c0*/         IADD R6, R5, R4;                                /* 0x4800000010519c03 */
    /*01c8*/         STS [R3], R6;                                   /* 0xc900000000319c85 */
    /*01d0*/         LDS R5, [R3];                                   /* 0xc100000000315c85 */
    /*01d8*/         LDS R4, [R3+0x4];                               /* 0xc100000010311c85 */
    /*01e0*/         IADD R4, R5, R4;                                /* 0x4800000010511c03 */
    /*01e8*/         STS.S [R3], R4;                                 /* 0xc900000000311c95 */
    /*01f0*/         ISETP.NE.AND P0, PT, R2, RZ, PT;                /* 0x1a8e0000fc21dc23 */
    /*01f8*/     @P0 BRA.U 0x218;                                    /* 0x40000000600081e7 */
    /*0200*/    @!P0 ISCADD R0, R0, c[0x0][0x24], 0x2;               /* 0x4000400090002043 */
    /*0208*/    @!P0 LDS R2, [RZ];                                   /* 0xc100000003f0a085 */
    /*0210*/    @!P0 ST [R0], R2;                                    /* 0x900000000000a085 */
    /*0218*/         EXIT;                                           /* 0x8000000000001de7 */ 
```

从行中可以看出`/*0130*/-/*01e8*/`，现在每次执行求和时，中间结果都会立即刷新到共享内存中，以实现全线程可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:23:11.807

也许看看马克哈里斯的这些幻灯片。为什么要重新发明轮子。

www.uni-graz.at/~haasegu/Lectures/GPU_CUDA/Lit/reduction.pdf?page=35

每个减少步骤都依赖于另一个。因此，您只能省略最后执行的 warp 中的同步，等于减少阶段的 32 个活动线程。在您需要 64 个线程并因此需要同步之前的一步，因为您使用 2 个 warp，因此无法保证并行执行。

# php - 如何将 youtube 嵌入链接存储在数据库中

> ID：10729186
> 
> 赞同：3
> 
> 时间：2012-05-23T23:17:16.567
> 
> 标签：php, mysql, sql, youtube

当我将 youtube 嵌入 iframe 保存到我的数据库中时，它会在我回忆时添加一堆斜线。就像下面这样。

```
<iframe width=\"560\" height=\"315\" src=\"http://www.youtube.com/embed/ycHXRWRKrdA?rel=0\" frameborder=\"0\" allowfullscreen></iframe> 
```

它以长文本类型存储。当我从数据库中召回斜杠或防止斜杠首先被存储时，什么会删除斜杠

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T23:26:19.237

不要像那样保存 HTML - 只需保存 youtube 唯一 ID，然后吐出 HTML 并插入数据库中的 ID。

[PHP Regex 获取 youtube 视频 ID？](https://stackoverflow.com/questions/3392993/php-regex-to-get-youtube-video-id)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:21:10.170

如果你使用 PHP，你可以使用 stripslashes()。

或者，您可以对代码进行 base64 编码/解码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:39:54.510

一劳永逸地将其添加到您的 .htaccess 中：

```
# disable the automatic-quote-removing from requests
php_value magic_quotes_gpc off 
```

您没有说是否将 youtube url 保存在数据库中的 JSON 中。如果是，请通过以下方式替换可能的引号：

```
str_replace('\"','\\"',$url); 
```

另外，当然最好将 youtube 代码保存为：

```
$eurl = explode("/",$url);
$eurl[sizeof($eurl)-1];     // <-- to database 
```

# objective-c - 使用 Cocos2d 创建 UIProgressView

> ID：10729188
> 
> 赞同：0
> 
> 时间：2012-05-23T23:17:54.480
> 
> 标签：objective-c, xcode, cocos2d-iphone, uiprogressview

我已经查看了所有内容，但找不到如何使用 cocos2d 以编程方式将 uiprogressview 正确放置在 Xcode 中的场景中。显然 cocos2d 不使用界面构建器，所以我基本上是在盲目地构建所有东西，但我想不出一种方法来做类似 `[self add child:progressbar];`or的事情`progressbar.position = cgrectmake(100,100,50,10);`。如何将 uiprogressview 添加到我的场景中？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:17:30.957

您可以使用 CCProgressTimer。你可以在这里读到它。

[http://www.cocos2d-iphone.org/api-ref/0.99.3/interface_c_c_progress_timer.html](http://www.cocos2d-iphone.org/api-ref/0.99.3/interface_c_c_progress_timer.html)

您还可以使用一些动作对其进行动画处理。 [http://www.cocos2d-iphone.org/api-ref/0.99.5/interface_c_c_progress_from_to.html](http://www.cocos2d-iphone.org/api-ref/0.99.5/interface_c_c_progress_from_to.html)

如果你真的想放置 UIKit 进度条，你可以通过在 cocos2d 视图中添加一个子视图来实现。如果您使用的是 Cocos2d 2.0，这会容易得多。请记住，设置 UIKit 从左上角开始的位置，而 Cocos2d 从左下角开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T09:34:58.950

```
[[CCDirector sharedDirector].openGLView addSubview:progressbar]; 
```

如果您使用的是 cocos2d 2.0，则该`openGLView`属性仅称为`view`.

# api - Spotify API 添加到播放列表

> ID：10729190
> 
> 赞同：2
> 
> 时间：2012-05-23T23:18:10.377
> 
> 标签：api, spotify

是否可以通过服务器端功能操作（添加到）Spotify 播放列表？

Web API 似乎仅限于搜索（https://developer.spotify.com/technologies/web-api/），而具有该功能的 JavaScript API 参考似乎仅限于在 Spotify 本身内部构建应用程序......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-01-27T10:46:29.790

是的，您可以，但是您需要一个涉及用户的授权过程，这非常痛苦。

您需要使用正确的 API。

来源： [https ://developer.spotify.com/web-api/console/playlists/](https://developer.spotify.com/web-api/console/playlists/)

例如，要添加曲目，您将需要此端点

> [https://api.spotify.com/v1/users/{user_id}/playlists/{playlist_id}/tracks](https://api.spotify.com/v1/users/) _

这段代码适用于 AppleScript，只是为了证明这个概念：

```
set userID to "XXXXX"
-- your userID can be retrieved with https://developer.spotify.com/web-api/console/get-current-user/#complete

set SelectedPlaylistID to "YYYY"
-- your target playlist can be retrieved with https://developer.spotify.com/web-api/console/get-playlists/#complete

set BearerID to "ZZZZ"
-- ZZZZ can be retrieved manually on page https://developer.spotify.com/web-api/console/post-playlist-tracks/ 

tell application "Spotify"
    set currentSpotifyID to id of current track as string
end tell
set currentlyPlayingTrack to trim_line(currentSpotifyID, "spotify:track:", 0)

set theURL to "'https://api.spotify.com/v1/users/" & userID & "/playlists/" & SelectedPlaylistID & "/tracks?uris=spotify%3Atrack%3A" & currentlyPlayingTrack & "' -H 'Accept: application/json' -H 'Authorization: Bearer " & BearerID & "'"
-- obtenu de https://developer.spotify.com/web-api/console/post-playlist-tracks/#complete

set theCommand to "curl -X POST " & theURL

do shell script theCommand 
```

但是有一个很大的警告：您需要每小时刷新一次 BearerID。

这是需要授权过程的地方，如果您想绕过刷新限制，它会变得复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T07:57:05.030

不幸的是，如果不使用 JS API 在客户端内部构建 Spotify 应用程序或使用 libSpotify 构建独立应用程序，目前这是不可能的。

# css - 任何滑块宽度

> ID：10729193
> 
> 赞同：0
> 
> 时间：2012-05-23T23:18:59.453
> 
> 标签：css

我正在尝试将滑块的宽度设置为 750px，以便它适合 Facebook 画布并且不会显示滚动条。

[http://www.facebook.com/pages/GolfffffffSteadyyyyy/213226708784235?sk=app_315085095232861](http://www.facebook.com/pages/GolfffffffSteadyyyyy/213226708784235?sk=app_315085095232861)

我似乎无法影响“element.style”，当我检查它时，它被设置为 6032px。如何控制/覆盖 element.style？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:29:09.970

检查您的链接，我发现问题是由以下原因引起的`.container`：

**更新到这个 CSS**

```
.container {
    background: none repeat scroll 0 0 #FFFFFF;
    margin: 0 auto;
    overflow: hidden;
    width: 800px;
} 
```

这解决了你的问题。

**另外**，请考虑您将`.container`with设置为`width:900px;`，并将`#contentArea`其插入位置设置为`width: 851px !important;`.

# javascript - "return false;" 是什么意思？做？

> ID：10729198
> 
> 赞同：23
> 
> 时间：2012-05-23T23:19:42.400
> 
> 标签：javascript, jquery, ajax

我编写了一个网页，用户可以在其中输入存储在数据库中的日志条目，然后使用`ajax`. 我还是很`ajax`陌生，想知道是否有人可以向我解释一下`return false;`我的代码末尾做了什么？甚至有必要吗？

如果我把第二个ajax代码放在代码后面就不行了`return false`！你能解释一下为什么吗？

```
//handles submitting the form without reloading page 
$('#FormSubmit').submit(function(e) {
    //stores the input of today's data
    var log_entry = $("#LogEntry").val();
    // prevent the form from submitting normally
    e.preventDefault();

    $.ajax({
        type: 'POST',
        url: 'behind_curtains.php',
        data: {
            logentry: log_entry
        },
        success: function() {
            alert(log_entry);
            //clears textbox after submission
            $('#LogEntry').val("");
            //presents successs text and then fades it out
            $("#entered-log-success").html("Your Entry has been entered.");
            $("#entered-log-success").show().fadeOut(3000);
        }
    });
    //prints new log entries on page upon submittion
    $.ajax({
        type: 'POST',
        url: '/wp-content/themes/childOfFanwood/traininglog_behind_curtains.php',
        data: {
            log_entries_loop: "true"
        },
        success: function(data) {
            alert(data);
            $("#log-entry-container").html("");
            $("#log-entry-container").html(data);
        }
    });
    return false;
});
​ 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-23T23:21:36.807

*我将在这里写的对于**jQuery 事件**是正确的，
对于普通的 javascript 事件，请阅读答案底部的@TJ Crowder 评论*

* * *

`return false`在回调内部防止默认行为。例如，在一个`submit`事件中，它不提交表单。

`return false`也停止冒泡，所以元素的父母不会知道事件发生了。

**`return false`相当于`event.preventDefault()`+`event.stopPropagation()`**

当然，该`return xxx`行之后存在的所有代码都不会被执行。（就像我知道的所有编程语言一样）

也许您觉得这很有帮助：
[停止事件冒泡 - 提高性能？](https://stackoverflow.com/q/9730849/601179)

* * *

一个*“真实”*`return false`的演示来解释和之间的区别`event.preventDefault()`：

**标记：**

```
<div id="theDiv">
    <form id="theForm" >
        <input type="submit" value="submit"/> 
    </form>
</div>​ 
```

**JavaScript：**

```
$('#theDiv').submit(function() {
    alert('DIV!');
});
$('#theForm').submit(function(e) {
    alert('FORM!');
    e.preventDefault();
});​ 
```

现在...当用户提交表单时，第一个处理程序是表单提交，它`preventDefault()`-> 表单不会被提交，但是事件冒泡到 div，触发它的提交处理程序。

[**现场演示**](http://jsfiddle.net/zwY5p/)

现在，如果表单提交的处理程序将取消冒泡`return false`：

```
$('#theDiv').submit(function() {
    alert('DIV!');
});
$('#theForm').submit(function(event) {
    alert('FORM!');
    return false;   
    // Or:
    event.preventDefault(); 
    event.stopPropagation();
});​ 
```

div 甚至不知道有表单提交。

[**现场演示**](http://jsfiddle.net/zwY5p/9/)

* * *

**`return false`vanilla javascript事件有什么作用**

> 从 DOM2 处理程序 ( `addEventListener`) 中返回 false 根本不做任何事情（既不会阻止默认值，也不会停止冒泡；从 Microsoft DOM2-ish 处理程序 ( `attachEvent`) 中，它会阻止默认值但不冒泡；从 DOM0 处理程序 ( `onclick="return ..."`) 中，它会阻止默认值（前提是您在属性中包含返回值）但不冒泡；从 jQuery 事件处理程序中，它两者都做，因为这是 jQuery 的事情。详细信息和现场测试在这里 – **TJ Crowder**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T23:24:03.597

函数中语句后的任何代码`return`都不会被执行。它停止执行函数并使该函数返回值传递（`false`在这种情况下）。您的功能是“提交”事件回调。如果此回调返回`false`，则不会实际提交表单。否则，它将像没有 JavaScript 一样被提交。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T23:22:14.067

在这种情况下，`return false;`阻止默认操作（即表单提交）。

虽然它可能更好用`e.preventDefault();`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T23:22:39.023

由于 ajax，您不希望您的表单以正常方式提交。因此，您必须返回 false 以防止表单的默认行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-30T14:08:32.567

return 语句结束函数执行 这很重要。使用 return 会导致您的代码短路并立即停止执行，从而阻止下一行代码执行

# ms-access - oledb 命令未获取值

> ID：10729200
> 
> 赞同：0
> 
> 时间：2012-05-23T23:19:57.783
> 
> 标签：ms-access, oledbcommand

通过以下查询，我尝试合并三件事`parEmail`，`parEmployeeLogin`和`parStaffID`

现在在一个为 null 的情况下，我得到整个 NameValue null 。

```
SELECT (parFirstname +' '+ parSurname) AS NAME, 
  (parEmail +','+ parEmployeeLogin +','+ parStaffID) AS NameValue 
FROM [tblParticipants] 
where parFirstname Is Not Null 
ORDER BY parFirstname 
```

NameValue 只有在所有三个字段都有数据的情况下才有数据，它正在正确获取 NAME....我正在使用它从 Access 文件中获取数据..应该在这个 oledb 查询中进行哪些更改..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:43:05.517

`NULL`+ 任何东西 = `NULL`。您已阻止`partFirstName`使用`NULL`您的`WHERE`子句，但如果其他两列中的任何一列是`NULL`，则整个结果是`NULL`。

您必须要么使用`IIF`为`NULL`列提供替代值，要么更改您的`WHERE`以处理多个`NULL`列。（未经测试）查询第一个选项（在这台机器上没有访问权限）：

```
SELECT 
  partFirstName + ' ' + IIF(IsNull(parSurName), '<None>', parSurName) as Name,
  IIF(IsNull(parEMail), '<No Mail>', parEMail) + ', ' +
    IIF(IsNUll(parEmployeeLogin), '<No Login>', parEmployeeLogin) + ', ' +
    IIF(IsNull(parStaffID), '<No ID>', parStaffID) as NameValue
FROM 
  [tblParticipants]
WHERE 
  parFirstName IS NOT NULL
ORDER BY 
  parFirstname 
```

# android - 微调器 setOnItemSelectedListener 不触发

> ID：10729208
> 
> 赞同：3
> 
> 时间：2012-05-23T23:21:05.727
> 
> 标签：android, spinner

我有一个视图对象，其中包含一个编辑文本、一个不可见的微调器和一个按钮。我通过 LayoutInflater 加载视图，它显示出来，一切正常。我按下按钮，显示微调器列表，然后选择我想要的项目。我的问题是微调器的 setOnItemSelectedListener 没有触发，因此我无法将 edittext 设置为所选值。

ArrayAdapter 适配器 = new ArrayAdapter(this, android.R.layout.simple_spinner_item, listItems); adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

```
 Spinner spn = (Spinner)sEdit.findViewWithTag("spn"+fieldID);
                        final String spnHolder = "spn"+fieldID;

                        spn.setAdapter(adapter);
                        ImageButton bSpn = (ImageButton)sEdit.findViewWithTag("btn"+fieldID);
                        bSpn.setOnClickListener(new OnClickListener() {

                            @Override
                            public void onClick(View v) {
                                curVw = (EditText)sEdit.findViewWithTag(v.getTag().toString().split("btn")[1]);
                                ((Spinner)sEdit.findViewWithTag(spnHolder)).performClick();
                            }

                        });

                        try {
                            spn.setOnItemSelectedListener(new OnItemSelectedListener() {
                                @Override
                                public void onItemSelected(AdapterView<?> arg0, View arg1,
                                        int arg2, long arg3) {
                                    curVw.setText(((TextView)arg1).getText().toString());
                                }

                                @Override
                                public void onNothingSelected(AdapterView<?> arg0) {
                                    // TODO Auto-generated method stub

                                }
                            });
                        }
                        catch (Exception ex) 
                        {
                            ex.printStackTrace();
                        } 
```

我添加了一个 Try...Catch 以查看它是否只是在该点之后失败，但它从未被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-19T17:16:10.073

而不是使用`SetOnclickListener`请使用：

```
spn.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener(){

   //implements methods and perform your action. This will works definately
}; 
```

# python - 通过熊猫数据框逐行迭代

> ID：10729210
> 
> 赞同：135
> 
> 时间：2012-05-23T23:21:18.343
> 
> 标签：python, pandas

我希望通过 pandas 逐行迭代`DataFrame`。到目前为止，我这样做的方式如下：

```
for i in df.index:
    do_something(df.ix[i]) 
```

有没有更高效和/或更惯用的方法来做到这一点？我知道 apply，但有时使用 for 循环更方便。

# php - 带有foreach的类内的递归函数在不应该更改的地方更改了公共值

> ID：10729211
> 
> 赞同：1
> 
> 时间：2012-05-23T23:21:22.837
> 
> 标签：php, class, recursion, foreach, hierarchical

好吧，我真的很坚持这个。我希望你能帮助我。

我有我的班级，用于管理分层数据。输入是一个具有以下结构的普通数组（只是一个示例）：

```
$list = array(
(object) array('id' => 1, 'nombre' => 'Cámaras de fotos', 'parentId' => null),
(object) array('id' => 2, 'nombre' => 'Lentes', 'parentId' => null),
(object) array('id' => 3, 'nombre' => 'Zoom', 'parentId' => 2),
(object) array('id' => 4, 'nombre' => 'SLR', 'parentId' => 1),
(object) array('id' => 5, 'nombre' => 'Primarios', 'parentId' => 2),
(object) array('id' => 6, 'nombre' => 'Sensor APS-C', 'parentId' => 4),
(object) array('id' => 7, 'nombre' => 'Full-frame', 'parentId' => 4),
(object) array('id' => 8, 'nombre' => 'Flashes', 'parentId' => null),
(object) array('id' => 9, 'nombre' => 'Compactas', 'parentId' => 1)
); 
```

我以这种方式将数据输入到类中：

```
$Hierarchical = new Hierarchical;
$Hierarchical->plain = $list; 
```

然后我有一个公共函数 ( `createTree`) 来创建列表的多维数组表示。它完美地工作。它可以返回结果或将其存储在`$this->tree`.

如您所见，这非常简单。它调用私有函数`iterateTree`，即递归函数。

```
class Hierarchical {

    public $plain = array();
    public $tree = array();

    public function createTree($parentId=0, $return=false) {

    $tree = $this->iterateTree($parentId);

    if(!$return) {
        $this->tree = $tree;
    } else {
        return $tree;
    }

    }

    private function iterateTree($parentId) {

    $resArray = array();

    foreach($this->plain as $item) {

        if($item->parentId == $parentId) {

            $children = $this->iterateTree($item->id);

            if( count($children) > 0 ) {
                $item->children = $children;
            }

            $resArray[] = $item;

        }

    }

    return $resArray;

    } 

} 
```

到目前为止，一切都很好。它工作正常。

**但是......**当我想`$this->plain`在调用后使用时出现问题`createTree()`。它不是返回原始数据集，而是返回原始输入之间的某种混合，并附加所有子数据集（类似于`$this->tree`）。

我无法弄清楚为什么`$this->plain`要更改的内容，在使用的两个函数中我都没有更改它的内容。

我尝试在`foreach`, 之后取消设置变量`foreach`，甚至将原始数组作为参数传递，并且`$this->plain`在递归函数中根本不使用。没有任何效果。

我也**没有**在类中使用任何其他可能改变它的值的函数。

这完全是个谜！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T22:56:58.160

根据道格的回答，正确的功能是：（添加`$itemAux = clone $item`）

```
private function iterateTree($parentId) {

    $resArray = array();

    foreach($this->plain as $item) {

        $itemAux = clone $item;

        if($itemAux->parentId == $parentId) {

            $children = $this->iterateTree($itemAux->id);

            if( count($children) > 0 ) {
                $itemAux->children = $children;
            }

            $resArray[] = $itemAux;

        }

    }

    return $resArray;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:29:20.360

在您的`foreach`循环`$item`中将引用数组中的对象，因此您正在更改该行中的同一对象

```
$item->children = $children; 
```

这将影响原始数组中引用的对象`$list`和`$this->plain`.

一种解决方案可能是`$item`在您的 foreach 循环中进行克隆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:02:34.180

为了补充道格的答案，虽然手册说“对象*不是*通过引用传递”（http://www.php.net/manual/en/language.oop5.references.php），但它可能有助于考虑对象作为一个完全独立的实体与任何可能“包含”它们的变量分开，并且它们实际上通过引用传递到任何地方......

```
class testClass
{
    public $var1 = 1;
}

function testFunc($obj)
{
    $obj->var1 = 2;
}

$t = new testClass;
testFunc($t);
echo $t->var1; // 2 
```

因此，当您这样做时`$item->children = $children;`，您实际上是在影响该`$plain`数组中的每个原始对象。

# ruby - 如何实现与http请求一起独立运行的计时器？

> ID：10729212
> 
> 赞同：0
> 
> 时间：2012-05-23T23:21:26.757
> 
> 标签：ruby, multithreading

我有一个通过 https 触发 php 脚本的 ruby​​ 代码。

*用例：* php 脚本通常在 5 分钟内完成，所以我在 10 分钟后为 https 请求设置了超时。**我需要一个计时器，它会在 https 请求开始后 7 分钟后触发代码。**

我正在考虑使用我在发起 https 请求之前创建的线程。我不确定这是否是解决此问题的正确方法。也许根本不需要使用线程。我正在使用 ruby​​ 1.8.7 (2010-08-16 patchlevel 302) [i386-mingw32]。如果我可以在成功完成 https 请求时“杀死”线程，我现在也不会。

```
uri = URI.parse(url)
start = Time.new
http_read_timeout=60*10

connection = Net::HTTP.new(uri.host, 443)
connection.use_ssl = true
begin   
        response = connection.start() do |http|
            http.open_timeout =  50
            http.read_timeout = http_read_timeout
            http.request_get(uri.request_uri)
            # here I need to place a code that is triggered 
            # in case of custom timeout is reached
        end
rescue Timeout::Error
#  "Connection failed
    time_out_message ="security time out - after #{http_read_timeout} sec"
return time_out_message         

end

puts "finished" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:44:43.737

ruby 1.9.3 实现了具有超时功能的超时模块。[你可以在这里看到](http://apidock.com/ruby/Timeout/timeout)。如果向下滚动，您可以单击显示源并查看超时方法的定义。如果您不想升级到 ruby​​ 1.9.3，可以复制它（我建议升级，因为 1.8.7 与 1.9.3 相比非常慢）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T15:15:38.413

基本结构可能是这样的：

```
seconds_timer = MyDelay
counter = 0

test_thread = Thread.new do
  run_http_php_test
end

while test_thread.alive?
 counter += 1
 if counter > seconds_timer
   handle_custom_timeout_somehow       
   # if you want to halt run_http_php_test: 
   test_thread.kill if test_thread.alive?
   # otherwise:
   break
 end
 sleep 1
end
# the below doesn't apply if you kill the run_http_php_test thread
test_thread.join if test_thread.alive? 
```

...但当然，您可以将其更改`sleep 1`为您喜欢的任何轮询间隔。轮询比仅仅强制您的原始线程休眠更好，因为如果`run_http_php_test`在您达到自定义超时值之前完成，代码将更快地完成。

上面的大部分或全部代码都可以在 run_http_php_test 方法中，或者直接插入......无论你喜欢哪个。

# cocoa - Cocoa：在 NSApp beginSheet 导致主窗口隐藏后显示错误

> ID：10729214
> 
> 赞同：5
> 
> 时间：2012-05-23T23:21:31.763
> 
> 标签：cocoa, nswindow, cocoa-sheet

我把它分解成一个非常小的项目。在应用程序委托中使用以下代码：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    TestingWindowController * testingWindowController = [[TestingWindowController alloc] initWithWindowNibName: @"TestingWindowController"];

    // Begin our sheet
    [NSApp beginSheet: testingWindowController.window
       modalForWindow: self.window
        modalDelegate: self
       didEndSelector: @selector(windowDidEnd:returnCode:contextInfo:)
          contextInfo: NULL];
}

- (void)windowDidEnd:(id)alert returnCode:(NSInteger)returnCode contextInfo:(id) contextInfo
{
    // If the user did not accept, then we really don't care what else they did!
    if (returnCode != NSOKButton) return;

    // We have had an error. Display it.
    [[NSApplication sharedApplication] presentError: nil
                                     modalForWindow: self.window
                                           delegate: nil
                                 didPresentSelector: nil
                                        contextInfo: NULL];
} 
```

以下动作与 Windows 笔尖上的按钮相关联。（请注意，笔尖的窗口也设置为在启动时不可见）。

```
- (IBAction) onClose: (id) sender
{
    [[NSApplication sharedApplication] endSheet: self.window
                                     returnCode: NSOKButton];

    [self.window orderOut: nil];    
} // End of onClose 
```

最终发生的是，一旦我`onClose`运行，所有窗口都消失了，我只剩下错误对话框（主窗口消失了）。![没有主窗口的错误对话框](../Images/e8f10ba0487dd366ba7871ba21aec137.png)

我的代码有问题吗？为什么我的主窗口消失了？

注意：我知道我没有将错误传递给 presentError 方法。我故意留下这个空值，因为我只有很短的时间来编写示例代码。传递实际错误会导致相同的行为。

示例项目可[在此处](http://hankinsoft.com/presentError.zip)获得。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-16T13:51:03.513

看来你还在用旧的api，试试新的

（取消选择 UserLoginWindowController 窗口启动时始终可见）

```
- (IBAction)userButtonPressed:(id)sender {

    UserLoginWindowController * wc = [UserLoginWindowController new];
    // we keep a reference, so the WC doesn't deallocate
    self.modalWindowController = wc;

    [[self window] beginSheet:[wc window] completionHandler:^(NSModalResponse returnCode) {
        self.modalWindowController = nil;
    }];

} 
```

在用户登录窗口控制器中

```
- (IBAction)cancelButtonPressed:(id)sender {

    [[[self window] sheetParent] endSheet:[self window] returnCode:NSModalResponseCancel];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:37:49.220

您正在使用 2 种方法打开窗口，beginSheet:..... 和 runModalForWindow:。你只需要其中之一。如果您想在窗口上附加一张纸，请使用第一种方法，如果您想要一个独立的窗口，请使用第二种方法。同样，在您的 onClose 方法中，您应该使用 endSheet:returnCode: 如果您正在关闭工作表（该方法的参数应该是 testingWindowController.window 而不是 self.window），并且 stopModalWithCode: 如果您正在关闭模式窗口，你不应该两者兼得。

# jquery - 延迟 Colorbox 在另一个动画期间启动

> ID：10729217
> 
> 赞同：0
> 
> 时间：2012-05-23T23:21:39.953
> 
> 标签：jquery, colorbox, delay

我正在尝试延迟打开颜色框，但如果存在延迟，它根本不会运行。我已经尝试了很多东西，但我被卡住了。任何人都知道如何在第一个动画运行时让颜色框暂停？这是 6000 毫秒，但我希望彩盒从 3000 毫秒开始。

谢谢！

这有效：

```
 $(document).ready(function(){
   $('a[data-test]').click(function(){
   var anim = $(this).attr('data-test');
   buttonAnim(anim);
   $.colorbox({href:"contact/index.html"});
;}) 
```

这有效，但延迟为 0ms：

```
 $(document).ready(function(){
   $('a[data-test]').click(function(){
   var anim = $(this).attr('data-test');
   buttonAnim(anim);
   $('a[data-test]').delay(3000).colorbox({href:"contact/index.html"});
;}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:26:40.853

嗯，我不知道彩盒的插件，但也许你可以使用一些技巧，比如：

```
 $(document).ready(function(){
   $('a[data-test]').click(function(){
   var anim = $(this).attr('data-test');
   buttonAnim(anim);
   $("#divOfYourChoice").animate( {'height': $("#divOfYourChoice").height()},3000,
   function($('a[data-test]').colorbox({href:"contact/index.html"});)
   );
;}) 
```

其中 divOfYourChoice 是它的名称如何表示页面上的任何 div。当然，这不是最优雅的解决方案，但无论如何它应该可以工作。希望这可以帮助您解决问题（直到找到更好的解决方案）

您可以选择使用 setTimeout ，例如：

```
 setTimeout(function($('a[data-test]').colorbox({href:"contact/index.html"});),3000); 
```

# string - 从双引号bash脚本中包含的字符串中删除空格

> ID：10729219
> 
> 赞同：3
> 
> 时间：2012-05-23T23:21:47.493
> 
> 标签：string, bash, unix, awk

我一直在使用 sep 来尝试这个，基本上我有一个文本文件，其中包含合理数量的同一行，例如

```
4444 username "some information" "someotherinformation" "even more information" 
```

我需要用下划线替换引号内的空格，所以它看起来像这样

```
4444 username "some_information" "someotherinformation" "even_more_information" 
```

目前我已经能够分离出引用的信息

```
sed 's/"\([^"]*\)"/_/g' myfile.txt 
```

关于如何进行的建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T00:47:59.810

```
sed -r ':a; s/^((([^"]*"){2})*[^"]*"[^" ]*) /\1_/;ta'
4444 username "some_information" "someotherinformation" "even_more_information" 
```

或者

```
sed ':a; s/^\(\(\([^"]*"\)\{2\}\)*[^"]*"[^" ]*\) /\1_/;ta'
4444 username "some_information" "someotherinformation" "even_more_information" 
```

*   `:a`- 为循环标记“a”
*   `s///`- 执行替换
*   `^(`- 将整个搜索字符串锚定在行首
*   `(([^"]*"){2})*`- 捕获（在第 1 组中）两组零个或多个非引号，后跟一个引号（零次或多次）
*   `[^"]*"`- 后跟零个或多个非引号，后跟一个引号
*   `[^" ]*`- 后跟零个或多个不是空格或引号的字符
*   `)`- 结束锚定序列并寻找需要替换的空间
*   `\1`- 将捕获的组和下划线替换为匹配的序列
*   `ta`- 分支（转移执行）标记`:a`是否成功替换（如果没有成功，则继续执行下一条指令 - 在这种情况下，该指令结束这一行的处理并读取下一条，开始新一轮的处理）

这会在最后一个带引号的字符串中找到第一个空格并替换它。然后下一个，如果有的话，直到引用的字符串完成。等等任何额外的空间。

然后下一个包含空格的先前引用的字符串......等等。

`:a`这就是模式空间在...`ta`循环的每一步中的样子：

```
4444 username "some information" "someotherinformation" "even_more information"

4444 username "some information" "someotherinformation" "even_more_information"

4444 username "some_information" "someotherinformation" "even_more_information" 
```

然后它会多走几次以查找行首的任何匹配项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T23:53:47.493

***已编辑***

^(以前的版本会添加不需要的空格。这个版本完全符合 OP 的要求。)

这可能是得到你想要的最简单的方法。

```
awk -F'"' '
  BEGIN {
    OFS="\""
  }
  {
    for (i = 2; i < NF; i += 2) {
      gsub(/[ \t]+/, "_", $i)
    }

    print $0
  }
' file > outputFile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T08:07:03.143

这可能对您有用：

```
echo '4444 username "some information" "someotherinformation" "even more information"' |
sed 's/"[^"]*"/\n&/g;:a;s/\(\n"[^"]*\) /\1_/g;ta;s/\n//g'
4444 username "some_information" "someotherinformation" "even_more_information" 
```

*   将标记 ( `\n`) 添加到引用的字符串。`sed 's/"[^"]*"/\n&/g;`
*   用 .替换引用字符串中的所有空格`_`。`:a;s/\(\n"[^"]*\) /\1_/g;ta`
*   删除标记。`s/\n//g`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T00:01:06.490

我实际上会在 C 中执行此操作，这使得执行逐字符状态机比大多数高级语言更容易。

```
#include <stdio.h>
int main(void)
{
    int inside_quotes = 0;
    int backslash = 0;
    int c;
    while ((c = getchar()) != EOF) {
        switch (c) {
        case ' ':
            if (inside_quotes)
                c = '_';
            break;
        case '"':
            if (!backslash)
                inside_quotes = !inside_quotes;
            break;
        case '\\':
            if (!backslash)
                backslash = 2;
            break;
        default:
            break;
        }
        if (backslash > 0) backslash--;
        putchar(c);
    }
    return 0;
} 
```

未经测试甚至编译。特别是反斜杠处理很可能是错误的。

# android - 为什么当我尝试创建一个新的 android xml 文件时 Eclipse 崩溃

> ID：10729221
> 
> 赞同：1
> 
> 时间：2012-05-23T23:21:54.650
> 
> 标签：android

每次当我尝试创建一个新的 xml 文件或打开 androidanifest.xml 时，eclipse 都会崩溃。我找不到这个问题的解决方案。请问我需要一些帮助

我正在使用 Eclipse SDK 版本：3.7.2 和 android sdk r17 windows

eclipse崩溃后，生成一个.log文件

* * *

Java 运行时环境检测到一个致命错误：

EXCEPTION_ACCESS_VIOLATION (0xc0000005) 在 pc=0x4ebac1f6，pid=6136，tid=5600

JRE 版本：6.0_31-b05 Java VM：Java HotSpot(TM) 客户端 VM（20.6-b01 混合模式 windows-x86） 有问题的框架：C [gdiplus.dll+0x2c1f6]

如果您想提交错误报告，请访问：http: [//java.sun.com/webapps/bugreport/crash.jsp](http://java.sun.com/webapps/bugreport/crash.jsp) 崩溃发生在 Java 虚拟机之外的本地代码中。请参阅有问题的框架以了解报告错误的位置。

……………………………………………………………………………………………………………………

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:14:11.557

您是否确保您的 Eclipse 版本完全是最新的（帮助菜单 -> 检查更新）？

也正如蒂姆所提到的，这以前有过吗？还是安装后出现问题？？

# extjs - 带有卡片布局的 EXT JS 4 中的事件处理程序问题

> ID：10729224
> 
> 赞同：1
> 
> 时间：2012-05-23T23:22:12.870
> 
> 标签：extjs, extjs4

我正在向“卡片布局”面板添加事件处理程序。

我遇到的问题是我在 Google Chrome 控制台中收到以下错误。

```
Uncaught ReferenceError: navigate is not defined 
```

这是我的 EXTJS 代码文件：

```
Ext.define('COMP.app.DailyBulletin', {
extend: 'Ext.panel.Panel',
alias: 'widget.dailybulletin',
height: 300,
width: 200,
layout: 'card',
bodyStyle: 'padding:15px',
activeItem: 0, // index or id
bbar: ['->', {
    id: 'card-prev',
    text: '&laquo; Previous',
    handler: function(btn){
        navigate(btn.up("panel"), "prev");
    },
    disabled: true
},{
    id: 'card-next',
    text: 'Next &raquo;',
    handler: function(btn){
        navigate(btn.up("panel"), "next");
    },
}],
items: [{
    id: 'card-0',
    html: 'page 0'
},{
    id: 'card-1',
    html: 'page 1'
}],

    navigate: function(panel, direction){
        var layout = panel.getLayout();
        layout[direction]();
        Ext.getCmp('card-prev').setDisabled(!layout.getPrev());
        Ext.getCmp('card-next').setDisabled(!layout.getNext());
},
}); 
```

当我在 Google Chrome 开发人员工具中调试 JS 时，我可以看到问题是事件处理程序无法访问导航功能，因为它认为它不存在。如果我只是将代码从导航函数移动到事件处理程序中，并将布局和方向从预期参数更改为直接获取它们，导航就可以正常工作。这告诉我我的问题在于我如何调用导航功能并且我在那里做错了什么。

我是 EXT JS 的新手，非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:09:40.877

尝试这样的事情：

```
Ext.define('COMP.app.DailyBulletin', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.dailybulletin',
    height: 300,
    width: 200,
    layout: 'card',
    bodyStyle: 'padding:15px',
    activeItem: 0, // index or id

    items: [{
        id: 'card-0',
        html: 'page 0'
    }, {
        id: 'card-1',
        html: 'page 1'
    }],

    initComponent: function() {
        Ext.apply(this, {
            bbar: ['->', {
                id: 'card-prev',
                text: '&laquo; Previous',
                scope: this,
                handler: function(btn) {
                    this.navigate(btn.up("panel"), "prev");
                },
                disabled: true
            }, {
                id: 'card-next',
                text: 'Next &raquo;',
                handler: function(btn) {
                    scope: this,
                    this.navigate(btn.up("panel"), "next");
                },
            }]
        });
        this.callParent();
    },

    navigate: function(panel, direction) {
        var layout = panel.getLayout();
        layout[direction]();
        Ext.getCmp('card-prev').setDisabled(!layout.getPrev());
        Ext.getCmp('card-next').setDisabled(!layout.getNext());
    },
}); 
```

# c# - 您将如何在 C# 中实现“特征”设计模式？

> ID：10729230
> 
> 赞同：59
> 
> 时间：2012-05-23T23:22:42.953
> 
> 标签：c#, design-patterns, traits, code-reuse, default-interface-member

我知道 C# 中不存在该功能，但 PHP 最近添加了一个名为[Traits](http://php.net/manual/en/language.oop5.traits.php)的功能，起初我认为它有点傻，直到我开始考虑它。

假设我有一个名为`Client`. `Client`有一个名为 的属性`Name`。

现在我正在开发一个可供许多不同客户使用的可重复使用的应用程序。所有客户都同意客户应该有一个名字，因此它在基类中。

现在客户 A 过来并说他还需要跟踪客户的体重。客户 B 不需要体重，但他想跟踪身高。客户 C 想要同时跟踪体重和身高。

使用特征，我们可以同时创建重量和高度特征特征：

```
class ClientA extends Client use TClientWeight
class ClientB extends Client use TClientHeight
class ClientC extends Client use TClientWeight, TClientHeight 
```

现在我可以满足所有客户的需求，而无需在课堂上添加任何多余的内容。如果我的客户稍后回来说“哦，我真的很喜欢这个功能，我也可以拥有它吗？”，我只需更新类定义以包含额外的特征。

您将如何在 C# 中完成此任务？

接口在这里不起作用，因为我想要属性和任何关联方法的具体定义，并且我不想为每个版本的类重新实现它们。

（“客户”是指雇佣我作为开发人员的字面意义上的人，而“客户”指的是编程课程；我的每个客户都有他们想要记录信息的客户）

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-23T23:36:44.897

您可以使用标记接口和扩展方法获取语法。

前提条件：接口需要定义合约，后续扩展方法使用。基本上，接口定义了能够“实现”特征的合同；理想情况下，您添加接口的类应该已经存在接口的所有成员，因此*不需要*额外的实现。

```
public class Client {
  public double Weight { get; }

  public double Height { get; }
}

public interface TClientWeight {
  double Weight { get; }
}

public interface TClientHeight {
  double Height { get; }
}

public class ClientA: Client, TClientWeight { }

public class ClientB: Client, TClientHeight { }

public class ClientC: Client, TClientWeight, TClientHeight { }

public static class TClientWeightMethods {
  public static bool IsHeavierThan(this TClientWeight client, double weight) {
    return client.Weight > weight;
  }
  // add more methods as you see fit
}

public static class TClientHeightMethods {
  public static bool IsTallerThan(this TClientHeight client, double height) {
    return client.Height > height;
  }
  // add more methods as you see fit
} 
```

像这样使用：

```
var ca = new ClientA();
ca.IsHeavierThan(10); // OK
ca.IsTallerThan(10); // compiler error 
```

**编辑：**提出了如何存储额外数据的问题。这也可以通过做一些额外的编码来解决：

```
public interface IDynamicObject {
  bool TryGetAttribute(string key, out object value);
  void SetAttribute(string key, object value);
  // void RemoveAttribute(string key)
}

public class DynamicObject: IDynamicObject {
  private readonly Dictionary<string, object> data = new Dictionary<string, object>(StringComparer.Ordinal);

  bool IDynamicObject.TryGetAttribute(string key, out object value) {
    return data.TryGet(key, out value);
  }

  void IDynamicObject.SetAttribute(string key, object value) {
    data[key] = value;
  }
} 
```

然后，如果“特征接口”继承自，则特征方法可以添加和检索数据`IDynamicObject`：

```
public class Client: DynamicObject { /* implementation see above */ }

public interface TClientWeight, IDynamicObject {
  double Weight { get; }
}

public class ClientA: Client, TClientWeight { }

public static class TClientWeightMethods {
  public static bool HasWeightChanged(this TClientWeight client) {
    object oldWeight;
    bool result = client.TryGetAttribute("oldWeight", out oldWeight) && client.Weight.Equals(oldWeight);
    client.SetAttribute("oldWeight", client.Weight);
    return result;
  }
  // add more methods as you see fit
} 
```

注意：通过实现[`IDynamicMetaObjectProvider`](http://msdn.microsoft.com/en-us/library/system.dynamic.idynamicmetaobjectprovider.aspx)该对象甚至允许通过 DLR 公开动态数据，从而在与`dynamic`关键字一起使用时使对附加属性的访问变得透明。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-11-23T16:44:18.540

Traits 可以通过使用默认接口方法在 C# 8 中实现。出于这个原因，Java 8 也引入了默认接口方法。

使用 C# 8，您几乎可以写出您在问题中提出的内容。这些特征由 IClientWeight、IClientHeight 接口实现，这些接口为其方法提供默认实现。在这种情况下，它们只返回 0：

```
public interface IClientWeight
{
    int getWeight()=>0;
}

public interface IClientHeight
{
    int getHeight()=>0;
}

public class Client
{
    public String Name {get;set;}
} 
```

`ClientA`并`ClientB`具有特征但不实现它们。ClientC 仅实现`IClientHeight`并返回不同的数字，在本例中为 16 ：

```
class ClientA : Client, IClientWeight{}
class ClientB : Client, IClientHeight{}
class ClientC : Client, IClientWeight, IClientHeight
{
    public int getHeight()=>16;
} 
```

当通过接口`getHeight()`调用时`ClientB`，调用默认实现。`getHeight()`只能通过接口调用。

ClientC 实现了 IClientHeight 接口，因此调用了它自己的方法。该方法可通过类本身获得。

```
public class C {
    public void M() {        
        //Accessed through the interface
        IClientHeight clientB = new ClientB();        
        clientB.getHeight();

        //Accessed directly or through the class
        var clientC = new ClientC();        
        clientC.getHeight();
    }
} 
```

[此 SharpLab.io 示例](https://sharplab.io/#v2:EYLgZgpghgLgrgJwgZwLQBEJinANjASQDsYIFsBjCAgWwAdcIaITYBLAeyIB8ABABgAEvAIwBuALAAoabwDMgtiTKUIgggGFcbFjADqENgHMAFjGkBvaYJuKSgoxH2HTMABQBKALwA+fpKkAX2lZBSVScigqdS0dEgAJFzNLa1twhydE4zNPX39pYJkpeWEAJkFY3RSpW2EFAGUYBCUjQQA5KGZBC0cYMWQnMULC2XLKkgBBQRAK7V0AGhi5kgNsmAtC3jHlmAAhadm4mEXNHazXDdHD3Q0D8eOlo9XXE/vz5KkrGtsS9N739zeHwiABsARGxQUWwq3VSNhKvAALIIALKebq1WxwzEAehxEwoVGQAwAJoIYCYEBw4KZySY1OEVFEINjaqcjgDBBQdrsvEQIAB3a4kXaeMSYrHfCXco67AB0/ySgICrNseIJRNJghJbCQFBguAAnoIOAg6VSaSY6QzlJEqKqbAA3KBmmU3PmC4UwDRiiU2B1cnYaBWZJVi7HDIA==)显示了从此示例生成的代码

[PHP 特性概述中](http://php.net/manual/en/language.oop5.traits.php)描述的许多特性特性都可以使用默认接口方法轻松实现。可以组合特征（接口）。也可以定义*抽象*方法来强制类实现某些要求。

假设我们希望我们的特征具有返回具有高度或重量的字符串的方法`sayHeight()`。`sayWeight()`他们需要某种方法来强制展示类（从 PHP 指南中窃取的术语）来实现返回身高和体重的方法：

```
public interface IClientWeight
{
    abstract int getWeight();
    String sayWeight()=>getWeight().ToString();
}

public interface IClientHeight
{
    abstract int getHeight();
    String sayHeight()=>getHeight().ToString();
}

//Combines both traits
public interface IClientBoth:IClientHeight,IClientWeight{} 
```

客户端现在*必须*实现 thet`getHeight()`或`getWeight()`方法，但不需要了解有关`say`方法的任何信息。

这提供了一种更清洁的装饰方式

[此示例的SharpLab.io 链接](https://sharplab.io/#v2:EYLgZgpghgLgrgJwgZwLQBEJinANjASQDsYIFsBjCAgWwAdcIaITYBLAeyIB8ABABgAEvAIwBuALAAoabwDMgtiTKUIgggGFcbFjADqENgHMAFjGkBvaYJuCowZDARQKMRSUFGI+w6ZgAKAEpJKVtBAGUnJSNBZCgATwNjMyCAXgA+Lx9kgMCAOgAVDkiEaKCQgF9pWQUlUnIXNU1tXQAJXzNLa1t7R2dXdzcs9pzy7psS6NiEkb80zO9ZlPyiyaIjMakqmR35QZVG9S0dEgAhDhgTEGaTmCWYABob3SS/C22a4QAmQWPdLtCtj2axiADkoMxBBYsmJkN4xNsPlJeD8/iQAIKCEC/FokB5HXHZPwAwQASD2ADc2Ah4FBcINPN5XssMgBWSrVZGowmnLE427454ke4koEKKk0uB0hnDDq5DIAdg5u25tw0fLRjwJt2ZWqFdzlopsezqjINo0CGREADYxGFxsJah4srr5jb+HbbA7TQB9Cl0uAQVIeh2U6m0+m8AAssUWcv8pv9uEDlvSfoDQaTgeVslVunQGsJgs150ugiNjplcYtVq+HvtgONTqGTPjqZECvr5a2nL2KN+UNDCmjggAskEoWEvY2pwB6WfoihUZBwgAmgkuCA4cFMG5MajqByoDrC+vuggoPNSRAgAHd+bpTuUp9OXzZL7dTnlZRaQifbPOi7LmugirtSECuLg8SCBwCB7luO4mHuB7KA0x4zmE/pwR+ugaNed4PiQGjPm+/7voSGjftWczBGR3Zvtqj4XEhOEkOg+H3pq6CbAxrEwOgVHmjRnovg6iJAA==)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-23T23:30:36.953

C#*语言*（至少到版本 5）不支持 Traits。

但是，Scala 具有 Traits 并且 Scala 在 JVM（和 CLR）上运行。因此，这不是运行时的问题，而只是语言的问题。

考虑到 Traits，至少在 Scala 意义上，可以被认为是“在代理方法中编译的神奇魔法”（它们*不会*影响 MRO，这与 Ruby 中的 Mixins 不同）。在 C# 中，获得这种行为的方法是使用接口和“大量手动代理方法”（例如组合）。

这个繁琐的过程可以用一个假设的处理器来完成（也许通过模板为部分类自动生成代码？），但这不是 C#。

快乐编码。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-09-02T09:09:22.650

我想指出[NRoles](http://code.google.com/p/nroles/) ，这是一个C# 中的*角色*实验，其中*角色*类似于*traits*。

 **NRoles 使用后编译器来重写 IL 并将方法注入到类中。这使您可以编写如下代码：

```
public class RSwitchable : Role
{
    private bool on = false;
    public void TurnOn() { on = true; }
    public void TurnOff() { on = false; }
    public bool IsOn { get { return on; } }
    public bool IsOff { get { return !on; } }
}

public class RTunable : Role
{
    public int Channel { get; private set; }
    public void Seek(int step) { Channel += step; }
}

public class Radio : Does<RSwitchable>, Does<RTunable> { } 
```

其中类`Radio`实现`RSwitchable`和`RTunable`。在幕后，`Does<R>`是一个没有成员的接口，所以基本上`Radio`编译成一个空类。编译后 IL 重写将`RSwitchable`和`RTunable`into 的方法注入`Radio`，然后可以像真的从两个*角色*（来自另一个程序集）派生一样使用它们：

```
var radio = new Radio();
radio.TurnOn();
radio.Seek(42); 
```

要`radio`在重写发生之前直接使用（即在`Radio`声明类型的同一程序集中），您必须求助于扩展方法`As<R>`（）：

```
radio.As<RSwitchable>().TurnOn();
radio.As<RTunable>().Seek(42); 
```

因为编译器不允许调用`TurnOn`或`Seek`直接在`Radio`类上。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-09-02T09:14:23.183

有一个由伯尔尼大学（瑞士）软件组合小组的 Stefan Reichart 开发的学术项目，它提供了C# 语言*特征的真正实现。*

查看[CSharpT 上的论文 (PDF)，](http://scg.unibe.ch/archive/projects/Reic05a.pdf)了解基于 mono 编译器的他所做工作的完整描述。

以下是可以编写的示例：

```
trait TCircle
{
    public int Radius { get; set; }
    public int Surface { get { ... } }
}

trait TColor { ... }

class MyCircle
{
    uses { TCircle; TColor }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-24T10:57:19.280

这确实是对 Lucero 答案的建议扩展，其中所有存储都在基类中。

为此使用依赖属性怎么样？

当您拥有许多并非总是由每个后代设置的属性时，这将具有使客户端类在运行时轻量级的效果。这是因为值存储在静态成员中。

```
using System.Windows;

public class Client : DependencyObject
{
    public string Name { get; set; }

    public Client(string name)
    {
        Name = name;
    }

    //add to descendant to use
    //public double Weight
    //{
    //    get { return (double)GetValue(WeightProperty); }
    //    set { SetValue(WeightProperty, value); }
    //}

    public static readonly DependencyProperty WeightProperty =
        DependencyProperty.Register("Weight", typeof(double), typeof(Client), new PropertyMetadata());

    //add to descendant to use
    //public double Height
    //{
    //    get { return (double)GetValue(HeightProperty); }
    //    set { SetValue(HeightProperty, value); }
    //}

    public static readonly DependencyProperty HeightProperty =
        DependencyProperty.Register("Height", typeof(double), typeof(Client), new PropertyMetadata());
}

public interface IWeight
{
    double Weight { get; set; }
}

public interface IHeight
{
    double Height { get; set; }
}

public class ClientA : Client, IWeight
{
    public double Weight
    {
        get { return (double)GetValue(WeightProperty); }
        set { SetValue(WeightProperty, value); }
    }

    public ClientA(string name, double weight)
        : base(name)
    {
        Weight = weight;
    }
}

public class ClientB : Client, IHeight
{
    public double Height
    {
        get { return (double)GetValue(HeightProperty); }
        set { SetValue(HeightProperty, value); }
    }

    public ClientB(string name, double height)
        : base(name)
    {
        Height = height;
    }
}

public class ClientC : Client, IHeight, IWeight
{
    public double Height
    {
        get { return (double)GetValue(HeightProperty); }
        set { SetValue(HeightProperty, value); }
    }

    public double Weight
    {
        get { return (double)GetValue(WeightProperty); }
        set { SetValue(WeightProperty, value); }
    }

    public ClientC(string name, double weight, double height)
        : base(name)
    {
        Weight = weight;
        Height = height;
    }

}

public static class ClientExt
{
    public static double HeightInches(this IHeight client)
    {
        return client.Height * 39.3700787;
    }

    public static double WeightPounds(this IWeight client)
    {
        return client.Weight * 2.20462262;
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-03-30T20:05:48.107

基于[Lucero 的建议](https://stackoverflow.com/a/10729336/65387)，我想出了这个：

```
internal class Program
{
    private static void Main(string[] args)
    {
        var a = new ClientA("Adam", 68);
        var b = new ClientB("Bob", 1.75);
        var c = new ClientC("Cheryl", 54.4, 1.65);

        Console.WriteLine("{0} is {1:0.0} lbs.", a.Name, a.WeightPounds());
        Console.WriteLine("{0} is {1:0.0} inches tall.", b.Name, b.HeightInches());
        Console.WriteLine("{0} is {1:0.0} lbs and {2:0.0} inches.", c.Name, c.WeightPounds(), c.HeightInches());
        Console.ReadLine();
    }
}

public class Client
{
    public string Name { get; set; }

    public Client(string name)
    {
        Name = name;
    }
}

public interface IWeight
{
    double Weight { get; set; }
}

public interface IHeight
{
    double Height { get; set; }
}

public class ClientA : Client, IWeight
{
    public double Weight { get; set; }
    public ClientA(string name, double weight) : base(name)
    {
        Weight = weight;
    }
}

public class ClientB : Client, IHeight
{
    public double Height { get; set; }
    public ClientB(string name, double height) : base(name)
    {
        Height = height;
    }
}

public class ClientC : Client, IWeight, IHeight
{
    public double Weight { get; set; }
    public double Height { get; set; }
    public ClientC(string name, double weight, double height) : base(name)
    {
        Weight = weight;
        Height = height;
    }
}

public static class ClientExt
{
    public static double HeightInches(this IHeight client)
    {
        return client.Height * 39.3700787;
    }

    public static double WeightPounds(this IWeight client)
    {
        return client.Weight * 2.20462262;
    }
} 
```

输出：

```
Adam is 149.9 lbs.
Bob is 68.9 inches tall.
Cheryl is 119.9 lbs and 65.0 inches. 
```

它没有我想要的那么好，但也不算太糟糕。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-23T23:59:04.437

这听起来像是 PHP 的面向方面编程的版本。在某些情况下，有一些工具可以提供帮助，例如 PostSharp 或 MS Unity。如果你想自己动手，使用 C# 属性的代码注入是一种方法，或者作为有限情况的建议扩展方法。

真的取决于你想变得多复杂。如果您正在尝试构建复杂的东西，我会查看其中一些工具来提供帮助。**

# javascript - Google MAP API V3 - 街景

> ID：10729234
> 
> 赞同：2
> 
> 时间：2012-05-23T23:24:01.547
> 
> 标签：javascript, google-maps-api-3

我正在尝试将 Google 地图 V3 API 集成到我们的网站中。我需要读取地址并将其设置为 MAP API，以便地图显示该地址的街景。

所以我需要3点帮助。

1.  如何读取地址值。

    示例：（`var streetAddressArray = getElementsByAttribute(parent.document.forms[0], "*", "smokeid", "Address Line 1");`我不确定此功能会做什么，只是粘贴以了解我到底在寻找什么。）

2.  读取设置为 API 类/方法的值后，地图可以显示街景。

3.  将其显示为街景。

这类似于我正在寻找的内容：

*   [https://google-developers.appspot.com/maps/documentation/javascript/examples/streetview-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/streetview-simple)

* * *

我非常感谢您的回复苏维！这是我的程序：

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style type="text/css">      html { height: 100% }      body { height: 100%; margin: 0; padding: 0 }      #map_canvas { height: 100% }    </style>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=KEY_VALUE &sensor=true">
</script>    
<script type="text/javascript">     
  function initialize() {  

   var fenway = new google.maps.LatLng(42.345573,-71.098326);
   var mapOptions = {
     center: fenway,
     zoom: 14,
     mapTypeId: google.maps.MapTypeId.ROADMAP
   };
   var map = new google.maps.Map(
   document.getElementById("map_canvas"), mapOptions);
   var panoramaOptions = {
      position: fenway,
      pov: {
        heading: 34,
        pitch: 10,
        zoom: 1
      }
    };
    var panorama = new  google.maps.StreetViewPanorama(document.getElementById("pano"),panoramaOptions);
   map.setStreetView(panorama);

  }    
</script> 
</head>  
<body onload="initialize()"> 
<div id="map_canvas" style="width:100%; height:100%">
<div id="pano" style="position:absolute; left:410px; top: 8px; width: 400px; height: 300px;"></div>
</div>
</body>
</html> 
```

我面临两个问题，

1.  不知何故，我无法查看全景视图。我的代码有问题吗？
2.  地图地址应来自一堆输入字段（地址行 1 和城市和邮编等）。如何将输入字段地址分配给地图，以便地图直接显示该特定位置？

我正在使用定制产品。我有另一个例子，他们正在使用：

```
var streetAddressArray = getElementsByAttribute(parent.document.forms[0], "*", "smokeid", "LossLocation_Address1"); 
```

* * *

我想我离目标更近了一点，但是我的这个例子不起作用，它没有渲染任何东西。

```
<!DOCTYPE html><html>  <head>    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />    <style type="text/css">      html { height: 100% }      body { height: 100%; margin: 0; padding: 0 }      #map_canvas { height: 100% }    </style>    <script type="text/javascript"    
  src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBweQln0Jf5uBWvkTGSkv8AfkBdt-zZ3dE&sensor=true">    </script>    
<script type="text/javascript">     

  <!-- -->

  var geocoder;  
  var map;
  function initialize() {
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(-34.397, 150.644);
    var myOptions = {      zoom: 8,      center: latlng,      mapTypeId: google.maps.MapTypeId.ROADMAP    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    } 
  function codeAddress() {
    var address = document.getElementById("address").value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({ map: map, position: results[0].geometry.location});
       } 
        else 
       {
        alert("Geocode was not successful for the following reason: " + status);
       }   
      });
     }
 <body onload="initialize()">
 <div id="map_canvas" style="width: 320px; height: 480px;">
 </div>  
<div> 
   <input id="address" type="textbox" value="Sydney, NSW">
   <input type="button" value="Encode" onclick="codeAddress()">
</div>
</body>
  <!-- -->
</html> 
```

你能帮我出什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T16:10:09.317

您的2个问题的答案：

1.  不知何故，我无法查看全景视图。我的代码有问题吗？

发生这种情况是因为关闭`</div>`map_canvas 也包含了全景。它应该直接出现在 map_canvas 的 div 之后，如下所示：

```
<body onload="initialize()"> 
<div id="map_canvas" style="width:100%; height:100%"></div>
<div id="pano" style="position:absolute; left:410px; top: 8px; width: 400px; height: 300px;"></div> 
</body> 
```

此外，请确保在包含 google maps api 脚本标记的标头中包含您的 API 密钥。

* * *

关于你的第二个问题，你可以通过多种方式做到这一点。最简单的方法是使用输入文本字段并使用 jquery 的 .val() 函数来获取文本字段中的值。然后将值传递给地理编码器以执行搜索。

有用的资源：

[https://developers.google.com/maps/documentation/javascript/geocoding](https://developers.google.com/maps/documentation/javascript/geocoding)

[http://api.jquery.com/val/](http://api.jquery.com/val/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:40:45.967

您需要首先初始化 StreetView（代替或绑定到您的地图），请参阅 StreetView 文档以进行设置 (https://developers.google.com/maps/documentation/javascript/streetview)。然后你需要使用谷歌的地理编码服务来查找地址。本文档 (https://developers.google.com/maps/documentation/javascript/geocoding) 将帮助您设置简单的地址搜索，但您必须稍微调整一下，以便在您的街景地图。基本上你必须改变：

```
geocoder.geocode( { 'address': address}, function(results, status) {
 if (status == google.maps.GeocoderStatus.OK) {
  map.setCenter(results[0].geometry.location);
 } 
```

您需要将位置设置为panorama.setPosition(results[0].geometry.location); 而不是map.setCenter。

请记住，街景的视角可能并不总是指向您想要的建筑物，我认为 Google 无法准确判断您正在搜索的建筑物/位置将在街道的哪一侧是。

希望有帮助。

# flash - Flash/AIR Stage3D 纹理格式、浮点纹理？

> ID：10729236
> 
> 赞同：0
> 
> 时间：2012-05-23T23:24:16.887
> 
> 标签：flash, air, 3d, textures, stage3d

可以为纹理设置哪些内部纹理格式以及如何设置？

我有点困惑，因为 flash.display3d.context3d::createTexture() 的在线帮助指出：

```
Note that 32-bit integer textures are stored in a packed BGRA format to match the Flash BitmapData format. Floating point textures use a conventional RGBA format. 
```

那么 - 支持浮点纹理吗？但话又说回来， flash.display3D.Context3DTextureFormat 只有两个常量：

```
BGRA : A texture with colors defined with 8-bit color components in the order: blue, green, red, alpha.
COMPRESSED : A texture in the Adobe Texture Format. 
```

而 Adob​​e 纹理格式似乎是每像素 24 位的压缩格式。

那么 - 是否支持任何浮点纹理（RGBA 为每像素 128 位，深度纹理为 32 位左右），如果支持，如何创建它们？是否可以渲染成浮点纹理？

如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:32:09.193

似乎不可能创建 128 位纹理，因为我们没有适当的常量传递给 context3D.createTexture。您可以在此处阅读更多信息[http://forums.adobe.com/message/3714147](http://forums.adobe.com/message/3714147)。

# mongodb - 吗啡注释

> ID：10729240
> 
> 赞同：0
> 
> 时间：2012-05-23T23:24:46.640
> 
> 标签：mongodb, morphia

我正在将 mongodb 与 java 以及 morphia 一起使用。

对于我的用例，我在运行时获取集合名称。所以我有一个集合名称的枚举，并根据一些值从枚举中获取相应的集合名称。我的实体注释如下

```
@entity(EnumName.getCollectionName()) 
```

但我收到以下错误

```
"The value for annotation attribute Entity.value must be a constant expression" 
```

我实际上只返回一个常量表达式。谁能让我知道问题是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:01:14.420

您不能在注释中使用一些动态的东西，因为这些是“编译”时功能，之后无法更改。所以你只能处理你在那里声明的常量，枚举和类。为此，智能编译器可能会发现您处理的东西可能永远不会改变，但大多数人不会，并且一旦他们看到您正在尝试将某个函数值分配给注释属性，就会简单地出错。

我真的不明白您要做什么，但不知何故，您似乎尝试对几个具体实体使用一个“通用”实体类。我认为这是一个非常糟糕的设计。如果您能说出更多细节，我们或许可以为您的问题提供适当的解决方案。

如果您根本不知道在运行时必须使用什么类，请试试这个。声明你的具体实体并用这些类填充你的枚举。在运行时你可以这样做`Datastore.find(Enum.YOURCLASS)`，morphia 将查询你的适当类。

# c - gcc 中是否有链接器标志来标记 elf 库中的唯一版本？

> ID：10729241
> 
> 赞同：2
> 
> 时间：2012-05-23T23:24:50.013
> 
> 标签：c

我已经生成了一个精灵共享库。我想在精灵标题中标记一个版本（如 1.2.2）。我可以使用 gcc 的链接器标志吗？如果没有，还有其他方法可以标记版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:31:27.847

您可以检查是否有[`ld`](http://linux.die.net/man/1/ld)适合您需要的选项，然后使用 GCC option 传递它[`-Wl`](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#index-Wl-1030)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:28:46.420

对于共享对象，您可以使用`-Wl,-soname,libmyname.so.1.2.3`.

# css - 水平对齐 Div 图像 - Dreamweaver CS5

> ID：10729245
> 
> 赞同：0
> 
> 时间：2012-05-23T23:25:14.523
> 
> 标签：css, html, flash-cs5

```
 <style type="text/css">

      div.imageSub { position: relative; }
      div.imageSub img { z-index: 1; }
      div.imageSub div {
        position: absolute;
        left: 15%;
        right: 15%;
        bottom: 0;
        padding: 4px;
      }
      div.imageSub div.blackbg {
        z-index: 2;
        color: #000;
        background-color: #000;
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
        filter: alpha(opacity=50);
        opacity: 0.5;
      }
      div.imageSub div.label {
        z-index: 3;
        color: white;
      }

     </style>
     <body>
      <div class="imageSub" style="width: 300px;"> <!-- Put Your Image Width -->
        <a href="../../../Downloads/Unnamed Site 2/stem studio.html"><img   
        src="../../../Downloads/Unnamed Site 2/PIC.jpg" alt="Something" width="300" 
        height="437" /></a>
        <div class="blackbg">Hello</div>
        <div class="label"> The Wolf</div>
     </div><br />
    <div class="imageSub" style="width: 300px;"> <!-- Put Your Image Width --><img    
    src="../../../Downloads/Unnamed Site 2/PIC.jpg" alt="Something" width="300" height="437"
      />

        <div class="blackbg">Hello</div>
        <div class="label"> The Wolf</div>

  </div>

  </body>
  </html>
  </body>
  </html> 
```

我正在尝试水平对齐两个 div 图像。

我从这个网站借用了在图像上覆盖文本的代码：

我刚刚添加了一张随机图片和文字，看看这段代码是否有效，它工作得非常好，但它们是垂直出现的。如何水平对齐它们？将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:39:52.383

1.  去除那个`<br/>`

2.  添加css规则

    ```
    .imageSub { float: left;}
    .clear { clear: both; } 
    ```

3.  添加`<div class="clear"/>`到最后。

不要忘记浮动环境中的第 3 步。

[jsfiddle](http://jsfiddle.net/7rswC/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:46:11.687

如果我理解您的问题，您需要将两个图像并排放置。如果是这样，您需要调整`CSS`并`HTML`允许：

请参阅此工作[小提琴示例！](http://jsfiddle.net/zuul/DT8py/)

* * *

**HTML**

```
<div class="imageSub" style="width: 300px;">
  <a href="../../../Downloads/Unnamed Site 2/stem studio.html">
    <img src="../../../Downloads/Unnamed Site 2/PIC.jpg" alt="Something" width="300" height="437" />
  </a>
  <div class="blackbg">Hello</div>
  <div class="label"> The Wolf</div>
</div>
<div class="imageSub" style="width: 300px;">
  <img src="../../../Downloads/Unnamed Site 2/PIC.jpg" alt="Something" width="300" height="437" />
  <div class="blackbg">Hello</div>
  <div class="label"> The Wolf</div>
</div> 
```

*删除了`<br>`*

* * *

**CSS**

```
div.imageSub {
  position: relative;
  float: left;
}
div.imageSub img {
  z-index: 1;
}
div.imageSub div {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 0;
  padding: 4px;
}
div.imageSub div.blackbg {
  z-index: 2;
  color: #000;
  background-color: #000;
  -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
  filter: alpha(opacity=50);
  opacity: 0.5;
}
div.imageSub div.label {
  z-index: 3;
  color: white;
} 
```

*添加`float: left;`到`div.imageSub`*

# 已编辑

一个基于先前修复的工作[小提琴示例，适用于 3x2 视觉呈现。](http://jsfiddle.net/zuul/DT8py/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:05:32.043

这是一个使用浮点数的简单 2 x 3 div 解决方案：http: [//jsfiddle.net/Fb6Jk/](http://jsfiddle.net/Fb6Jk/)

# android - 使用 ViewPager 时如何处理 savedInstanceState？

> ID：10729246
> 
> 赞同：12
> 
> 时间：2012-05-23T23:25:24.880
> 
> 标签：android, android-fragments

我`android.support.v4.view.ViewPager`在应用程序中使用。

当用户旋转屏幕时，Activity 被销毁并重新创建。当前`ViewPager`在`savedInstanceState`.

创建一个新的活动，`FragmentActivity.onCreate(savedInstanceState)`使用片段状态调用，然后使用捆绑包重新创建这三个片段。但是，我`onCreate`还设置了`ViewPager`和`ViewPager`适配器，它们重新创建了自己的片段，从而导致这三个片段中的每一个都有两个。

如何将自动重新创建的片段与我`ViewPager`的适配器关联，而不是从头开始重新创建它们？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T00:40:21.263

没关系。看来我使用`FragmentPagerAdapter`不正确。

正确的使用方法`FragmentPagerAdapter`是在`getItem()`. 我是在适配器的构造函数中实例化所有片段，将它们存储在一个数组中，然后在数组中查找它们并在`getItem()`.

如果您从 实例化您的片段`getItem()`，那么`FragmentPagerAdapter.instantiateItem()`将自动使用回收片段而不是实例化一个新片段。

# linux - apache不接受来自本地主机外部的传入连接

> ID：10729247
> 
> 赞同：60
> 
> 时间：2012-05-23T23:25:28.707
> 
> 标签：linux, apache, webserver, centos

我已经在 rackspace 上启动了一个 CentOS 服务器并执行了`yum install httpd`'d. 然后`services httpd start`。所以，只是准系统。

我可以通过ssh（22）远程访问它的IP地址没问题，所以DNS或任何东西都没有问题（我认为......），但是当我尝试在端口80上连接时（通过浏览器或其他东西）我得到拒绝连接。

但是，从本地主机，我可以使用 telnet (80)，甚至可以在其自身上使用 lynx，并且可以毫无问题地获得服务。从外面（我的房子、我的学校、当地的咖啡店等），telnet 在 22 上连接，但不是 80。

我使用`netstat -tulpn`(<- 我不会撒谎，我不明白这`-tulpn`部分，但这就是互联网告诉我要做的......) 然后看看

```
tcp    0    0 :::80     :::*    LISTEN    - 
```

我相信我应该这样做。`httpd.conf`说`Listen 80`。_

我已经`services httpd restart`很多次了。

老实说，我不知道该怎么做。机架空间不可能对传入的端口 80 请求设置防火墙。我觉得我错过了一些愚蠢的东西，但我现在已经启动了两次准系统服务器，并且已经做了绝对最低限度的工作来获得这个功能，我认为我已经用我的修补把事情搞砸了，但都没有奏效。

任何帮助是极大的赞赏！（对于冗长的帖子感到抱歉......）

**编辑** 我被要求发布`iptables -L`. 所以这里是：

```
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED 
ACCEPT     icmp --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh 
REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited 

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited 

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination 
```

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2013-10-24T14:50:40.827

万一还没有解决。你的 iptables 说：

> 状态相关，已建立

这意味着它只允许传递已经建立的连接......这是由您建立的，而不是由远程机器建立的。然后您可以在接下来的规则中看到例外情况：

```
state NEW tcp dpt:ssh 
```

这仅适用于 ssh，因此您应该为 http 添加类似的规则/行，您可以这样做：

```
state NEW tcp dpt:80 
```

你可以这样做：

```
sudo iptables -I INPUT 4 -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT 
```

（在这种情况下，我选择在第四行添加新规则）

请记住，在编辑文件后，您应该像这样保存它：

```
sudo /etc/init.d/iptables save 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2016-12-13T02:34:27.007

CentOS 7 现在默认使用 firewalld。但是所有的答案都集中在 iptables 上。所以我想添加一个与firewalld相关的答案。

由于 firewalld 是 iptables 的“包装器”，因此使用 antonio-fornie 的答案似乎仍然有效，但我无法“保存”该新规则。因此，一旦防火墙重新启动，我就无法连接到我的 apache 服务器。幸运的是，使用 firewalld 命令进行等效更改实际上要简单得多。首先检查firewalld是否正在运行：

```
firewall-cmd --state 
```

如果它正在运行，则响应将只是一行显示“正在运行”。

要在公共区域临时允许 http（端口 80）连接：

```
sudo firewall-cmd --zone=public --add-service=http 
```

上述内容不会被“保存”，下次重新启动 firewalld 服务时，它会回到默认规则。在继续之前，您应该使用此临时规则进行测试并确保它解决了您的连接问题。

要永久允许公共区域上的 http 连接：

```
sudo firewall-cmd --zone=public --permanent --add-service=http 
```

如果您执行“永久”命令而不执行“临时”命令，则需要重新启动 firewalld 以获取新的默认规则（对于非 CentOS 系统，这可能会有所不同）：

```
 sudo systemctl restart firewalld.service 
```

如果这还没有解决您的连接问题，可能是因为您的界面不在“公共区域”中。以下链接是了解 firewalld 的绝佳资源。它详细介绍了如何检查、分配和配置区域：[https ://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-26T05:26:27.607

SELinux 默认阻止 Apache（以及所有 Apache 模块）进行远程连接。

```
# setsebool -P httpd_can_network_connect=1 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T21:33:18.937

尝试在 iptables.config 表中进行以下设置

```
iptables -A INPUT -p tcp --dport 80 -j ACCEPT 
```

运行以下命令重启iptable服务

```
service iptables restart 
```

将 httpd.config 文件更改为

```
Listen 192.170.2.1:80 
```

重新启动apache。

现在试试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-21T03:50:30.937

如果您使用的是 RHEL/CentOS 7（OP 不是，但我想我会为我的案例分享解决方案），那么您将需要使用 firewalld 而不是其他答案中提到的 iptables 服务。

```
firewall-cmd --zone=public --add-port=80/tcp --permanent
firewall-cmd --reload 
```

然后检查它是否正在运行：

```
firewall-cmd --permanent --zone=public --list-all 
```

它应该列`80/tcp`在`ports`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-09T20:37:01.037

这会起作用： -- 用于 REDHAT ： cat "/etc/sysconfig/iptables"

```
iptables -I  RH-Firewall-1-INPUT -s 192.168.1.3  -p tcp -m tcp --dport 80 -j ACCEPT 
```

其次是

```
sudo /etc/init.d/iptables save 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-23T23:38:54.380

尝试禁用 iptables：service iptables stop

如果可行，请在防火墙规则中启用 TCP 端口 80：从 root 运行 system-config-selinux，并在防火墙上启用 TCP 端口 80 (HTTP)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-23T23:31:33.163

在 apache 配置文件（httpd.conf、apache2.conf、listen.conf、...）中搜索 LISTEN 指令，如果你看到 localhost 或 127.0.0.1，那么你需要用你的公共 ip 覆盖。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-23T01:55:58.243

这就是我们从外部访问 apache 的方法：

```
sudo iptables -I INPUT 4 -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
sudo service iptables restart 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-23T23:34:07.580

将 apache 设置为列表到特定的接口和端口，如下所示：

```
Listen 192.170.2.1:80 
```

还要检查 Iptables 和 TCP Wrappers 条目，这些条目可能会干扰主机与访问该端口的外部主机

[为 Apache 绑定文档](http://httpd.apache.org/docs/2.0/bind.html)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-09-17T15:24:30.430

禁用 SELinux

```
$ sudo setenforce 0 
```

# mysql - 将大型数据集加载到 Rails 应用程序中

> ID：10729248
> 
> 赞同：3
> 
> 时间：2012-05-23T23:25:40.950
> 
> 标签：mysql, ruby-on-rails, activerecord, rails-models, activerecord-import

我正在处理要作为模型加载到 Rails 应用程序中的数百万行数据。我使用 MySQL 作为数据库，我在 Rails 2.3.14 上。

我的一位同事说，绕过 Rails ActiveRecord 系统直接向 MySQL 添加记录是不可取的。他没有具体说明，但要点是当您使用它的 ActiveRecord 系统时，Rails 做了很多“魔术”，如果您在该系统之外输入数据，它会混淆 Rails。有人可以详细说明这是否准确吗？

如果我应该通过 ActiveRecord 将数据加载到 Rails 中，我已经读到[activerecord-import](https://github.com/zdennis/activerecord-import)插件是完成这类工作的方法。

欢迎任何关于将大量数据加载到 Rails 中的最佳方法的反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:14:47.827

我能想到要考虑的六个主要项目，最后五个与 Rails 的“魔法”有关：

1.  **速度**。这是巨大的。Active Record，一次插入每行可能需要一秒钟。因此，对于一百万行来说，这是一百万秒 - 那是 11.5**天**，这将给许多人带来不好的评价！

2.  **验证**。您需要确保数据库强制执行与模型/现有数据中相同的验证。

3.  **时间戳**。如果您想像 rails 一样更新 created_at / updated_at ，您需要手动更新时间戳

4.  **计数器缓存**。您需要手动更新计数。

5.  **ActiveRecord gems**例如，如果您使用acts_as_audited，它可以让您保留对模型记录的数据更改的记录跟踪，如果您在ActiveRecord 之外，您将没有该功能。

6.  **模型层的业务逻辑。** 优秀的程序员尽可能将功能置于模型（或更高）级别。这可能包括更新其他数据、发送电子邮件、写入日志等项目。如果不调用 ActiveRecord，则不会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:39:23.943

直接插入 MySQL 可能会绕过模型观察器、计数器缓存和您的应用程序依赖 ActiveRecord 为您执行的其他功能。如果您决定将数据直接插入 MySQL，请注意这一点，并确保您考虑了 ActiveRecord 将进行的所有更改和验证。无论您编写什么插入脚本，都应该进行相同的更改。

示例：您有`students`和`teachers`表。向其中插入记录`students`可能需要您更新`teachers.students_count`计数器缓存列 ActiveRecord 通常会为您递增。

除此之外，您没有理由不能直接插入数据。除了这些担忧之外，任何担忧都只是毫无根据的 FUD。

使用 ActiveRecord 的真正瓶颈是 ActiveRecord 模型对象的实例化，这是非常复杂的。您可能需要考虑将插入/导入脚本编写为`rake`任务并使用[`arel`](https://github.com/rails/arel)（支持 ActiveRecord 的低级查询接口）或类似[`activerecord-import`](https://github.com/zdennis/activerecord-import/wiki). 请记住，这两种方法都将（或至少可以）跳过正常的验证、观察者、计数器缓存等，因此您仍然需要自定义逻辑来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:34:54.103

不应该直接加载它有几个原因。其中一些可能适用于您，也可能不适用于您。

数据验证——您正在加载尚未验证的数据。您的 rails 应用程序可能对加载的数据做出了某些假设。此外，未经验证的数据在您的应用程序中运行时可能会引发一些有趣的问题。

数据操作——这在某种程度上与数据验证有关，但如果您正在执行任何类型的数据操作（在网络上的数据输入和插入数据库之间），您至少希望在上传时重新创建此操作它。

总的来说，这可能不是最好的主意，但这不是因为 Rails 中的“魔法”，而是因为您的数据内置了假设，即您不会重新创建直接转储。

# java - 这是确保 Java 中只存在一个对象的单个实例的有效方法吗？

> ID：10729249
> 
> 赞同：3
> 
> 时间：2012-05-23T23:26:05.950
> 
> 标签：java, singleton

我在使用 Mongodb 时遇到了一些奇怪的错误，而在 Mongodb 中，您应该维护`Mongo`单例。我只是想确保这实际上是有效的。

```
public class DBManager {
    public static Mongo mongoSingleton = null;

    public static synchronized void getMongo(){
         if(mongoSingleton == null){
              mongoSingleton = new Mongo();
         }
         return mongoSingleton;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T23:31:20.437

您必须将您的公共成员 mongoSingleton 设置为私有并隐藏默认构造函数

所以

```
private static Mongo mongoSingleton = null;

private Mongo() {

} 
```

Mongo 类的实现

```
public class Mongo {
    private static volatile Mongo instance;
    private Mongo() {
        ...
    }

    public static Mongo getInstance() {
        if (instance == null) {
            synchronized (Mongo.class) {
                if (instance == null) { // yes double check
                    instance = new Mongo();
                }
            }
        }

        return instance;
    }
} 
```

用法

```
Mongo.getInstance(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T23:36:58.110

这是典型的 Singleton 模式，但 Java 中的首选方法是创建一个 Enum：

```
public enum DBManager {
    INSTANCE;

    // implementation here
} 
```

然后，您可以通过以下方式引用该实例：

```
DBManager.INSTANCE 
```

请注意，在任何一种情况下（枚举或单例模式），结果都是每个 ClassLoader 一个实例，而不是每个 JVM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:32:53.167

随便用`private static final Mongo mongo = new Mongo()`，甚至`public static final Mongo mongo = new Mongo()`。它更简单并且可能更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T23:27:44.820

不，因为对静态成员的公共访问，您可以将其更改为您想要的任何实例。

更理智的是以下

```
public class DBManager {
    private static Mongo mongoSingleton = new Mongo();

    public static Mongo getMongo(){
       return mongoSingleton;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T23:28:23.870

```
 public static Mongo mongoSingleton = null; 
```

需要是

```
 private static Mongo mongoSingleton = null; 
```

除此之外，看起来不错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-23T23:31:59.767

如果您愿意放弃延迟初始化，那么最便宜的方法是在对象创建时简单地创建单例。

```
public final class DBManager {
    private static final Mongo mongoSingleton = new Mongo();

    private DBManager() {}

    public static Mongo getMongo() {
         return mongoSingleton;
    }
} 
```

这样，您可以避免不必要的同步开销，否则每次调用此方法时都会出现这种开销。只要 Mongo 本身是线程安全的，您的 getMongo() 方法也是线程安全的。

[在此处](http://java.sun.com/developer/technicalArticles/Programming/singletons/)阅读有关单例的 Sun 开发人员文章。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-23T23:52:39.897

单例的延迟初始化被高估了，通常没有必要，并且导致的问题多于好处。制作整个静态 getter 的天真方法是不好的，因为**每次都会**`synchronized`执行同步（这是一个耗时的操作）。

 **有一些更好的方法，例如*双重检查*锁定或*按需初始化持有者*，但最简单且通常最好的方法是 Josh Bloch 的枚举方法。用一个元素制作一个`enum`，你会得到一个防弹单例。

```
public enum Mongo {

    INSTANCE;

    // instance fields, methods etc. as in any other class
} 
```

这在功能上几乎等同于具有`private`构造函数和`public static final`实例的类，但具有更简洁的语法和一些不错的底层特性，这些特性不可动摇地保证不能创建其他实例，即使通过*反射*或*反序列*化也不行。

值得注意的是，这种方法**不一定是急切**的。单曲`INSTANCE`是在`Mongo`类加载到 JVM 之后创建的，它不会在程序启动后立即发生 - 实际上它发生在**第一次引用类时**- 在这种情况下，这意味着第一次`static`字段或方法被访问。

如果除此之外没有其他静态字段`INSTANCE`并且没有静态方法，那么这真的会在第一次`INSTANCE`访问之后发生：

```
Mongo mongo = Mongo.INSTANCE; 
```

换句话说，它**实际上是惰性**的，没有显式同步的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-23T23:29:00.963

是的，但您不希望您的成员变量是公开的。用户必须通过您的同步 getter

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-23T23:32:01.103

如果您想了解更多详细信息，请一步一步 - 您可以点击此链接 - [http://www.javabeginner.com/learn-java/java-singleton-design-pattern](http://www.javabeginner.com/learn-java/java-singleton-design-pattern)

以下是如何正确执行此操作的一个示例。

```
public class DBManager {
private static Mongo mongoSingleton = null;

public static synchronized void getMongo(){
     if(mongoSingleton == null){
          mongoSingleton = new Mongo();
     }
     return mongoSingleton;
} 
```

}**

# svn - 颠覆 - 提交时找不到路径（乌龟）

> ID：10729254
> 
> 赞同：4
> 
> 时间：2012-05-23T23:26:24.547
> 
> 标签：svn, tortoisesvn, commit

我有一个本地文件夹，它曾经被命名为“XYZ”。它现在被称为“ABC”。当我尝试在此目录中提交文件时，我收到“找不到路径”错误，告诉我“XYZ”不存在。果然，当我在存储库浏览器中查看时，“XYZ”目录不存在，但我想知道如何告诉乌龟停止寻找“XYZ”而将其视为“ABC”。

PS - “ABC”目录出现在远程存储库中，所以看起来即使本地名称已更改，它指向的远程路径也没有。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-25T22:57:38.053

这已经有了答案，但是当我遇到错误时，有一种更简单的方法可以解决这个问题。

**重现：**

```
svn mv /dir/subdir newdir/subdir/
svn rm /newdir/subdir --force
svn ci
svn: E160016: Path '/newdir/subdir' not present 
```

**解决：**

```
mkdir /newdir/subdir
svn add /newdir/subdir
svn ci
svn rm /newdir/subdir --force
svn ci 
```

这对我有用，它需要重新创建丢失的目录，欺骗 SVN 认为它正在添加它而不是删除它。然后在中间提交后将其删除。它很脏，但丢失其他更改的风险较小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T23:46:16.993

您需要将文件夹“ABC”添加到存储库。下次提交时，SVN 应该完全删除文件夹“XYZ”并将其中的所有内容添加为新文件夹“ABC”。

# ios - 使用 NSPersistentStoreCoordinator 的要点？

> ID：10729255
> 
> 赞同：13
> 
> 时间：2012-05-23T23:26:34.563
> 
> 标签：ios, core-data

[在 iTunes 上斯坦福 193P](http://www.stanford.edu/class/cs193p/cgi-bin/drupal/) iPhone 课程的 Core Data 讲座中，讲师使用 Core Data 编写了一个示例项目，而没有使用`NSPersistentStoreCoordinator`和加载`NSManagedObjectModel`. 但是在查看其他代码示例和关于 iPhone 开发的 Big Nerd Ranch 书籍时，他们正在创建一个`NSManagedObjectModel`PersistentStoreCoordinator 并以`NSManagedObjectContext`这种方式进行设置。

我的问题是这样做的目的是什么，两种方法的优缺点是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-31T14:51:55.390

我非常密切地关注同一个系列讲座。这个特定的示例从 Flickr 中提取数据（摄影师和照片）并将它们加载到 CoreData。在这个应用程序中使用 CoreData 并不是真的必要，因为它需要在每次应用程序加载时从 flickr 获取新数据，因此持久保存没有意义。教授只是使用上一个演示中的 flickr fetching 应用程序作为起点，因为学生已经熟悉它（让他专注于解释 CoreData）。然而，正如 rickster 所提到的，使用核心数据而不将上下文保存到磁盘有巨大的好处。

正如 Paul 在演示之前的讲座中解释的那样，可以通过以下方式创建一个核心数据库（在 iOS5 中）：

1.  在创建新项目时单击应用模板的“使用核心数据”。
2.  使用 UIManagedDocument

第一种方法背后的想法是 Xcode 将在 AppDelegate 中放置一堆代码来设置您的文档目录/持久存储协调器/和模型。然后它将托管对象 CONTEXT 传递给您的初始视图控制器（它应该在公共 API 中具有 NSManagedObjectContext 属性），并且当您与其他视图控制器进行连接时，您可以从那里像一瓶啤酒一样传递上下文。传递上下文是访问核心数据库的正确过程。

使用 UIManagedDocument 非常相似，只是您的 AppDelegate 是单独的。您使用应用程序文档目录中的 URL 路径创建 UIManagedDocument（可能在初始视图控制器中）（注意：您必须手动检查文件是否已退出、存在但未打开或不存在）。然后你可以像上面一样使用这个文档的上下文。

另一个注意事项：最好在 AppDelegate 中创建指向上下文的指针，以便在应用程序崩溃或终止时显式保存上下文（仅当它准备好时！）。

持久存储协调器会自动为您设置，您可以使用它的 persistentStoreOptions 属性（实际上您需要这样做以持久保存上下文）或通过子类化 UIManagedDocument 并覆盖所需的方法来配置它。

阅读 UIManagedDocument 文档中的概述 [http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIManagedDocument_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIManagedDocument_Class/Reference/Reference.html)

这两种方法的工作方式相同，并为您提供相同的控制和访问。使用 UIManagedDocuments，您可以在多个 sqlite 文件中创建多个数据库，您也可以等待创建/设置数据库，直到需要它。“使用核心数据”选项为您提供了一个在应用程序加载时设置的单一核心数据库，允许您围绕 AppDelegate 集中 CoreData 内容，节省编码时间，并且有利于快速跟踪应用程序。我喜欢 UIManagedDocument。

如果您在没有检查核心数据选项的情况下启动应用程序并希望将其添加到 AppDelegate，只需创建一个检查核心数据的新项目并将所有代码复制到您的 AppDelegate（应该只是 3 个属性及其访问器以及访问文档目录的便捷方法）。您将需要指向您的初始视图控制器、模型等。

更新：只是想增加另一种便利。如果您的托管对象上下文存储在您的 appDelegate 中，您可以在应用程序的任何位置访问它，只需使用

```
NSManagedObjectContext* context = [[(AppDelegate*) [UIApplication sharedApplication] delegate] myManagedObjectContext]; 
```

这否定了必须传递它。

对于任何 CoreData 应用程序，如果您对模型进行任何更改，请确保在再次构建之前手动删除模拟器中的应用程序。否则，您将在下一次构建时收到错误，因为它将使用旧文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T01:14:55.223

如果没有持久存储协调器，您将无法将结果保存到持久区域（数据库、文件等）……因此，如果您想要一个完全无用的持久数据管理器，请忽略 NSPersistentStoreCoordinator。您确定该项目没有使用它吗？教授是如何保存数据的？当你创建一个新的 Core Data 项目时，这个逻辑会自动为你生成。

编辑：我现在明白了，教授正在使用[UIManagedDocument](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIManagedDocument_Class/Reference/Reference.html)，它在内部使用自己的持久存储协调器（基于文件类型），因此无需创建显式协调器（除非您对默认值不满意）。所以，归根结底，这与是否使用协调器无关，而是您是否明确创建它。

# javascript - 为什么 JSON.stringify 不显示作为函数的对象属性？

> ID：10729258
> 
> 赞同：9
> 
> 时间：2012-05-23T23:27:01.073
> 
> 标签：javascript, json, function, object, stringify

为什么 JSON.stringify() 不显示 prop2？

```
var newObj = {
  prop1: true,
  prop2: function(){
    return "hello";
  },
  prop3: false
};

alert( JSON.stringify( newObj ) ); // prop2 appears to be missing

alert( newObj.prop2() ); // prop2 returns "hello"

for (var member in newObj) {
    alert( member + "=" + newObj[member] ); // shows prop1, prop2, prop3
} 
```

JSFIDDLE：http: [//jsfiddle.net/egret230/efGgT/](http://jsfiddle.net/egret230/efGgT/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-23T23:28:59.983

因为[JSON](https://json.org)不能存储函数。根据规范，值必须是以下之一：

[![有效的 JSON 值](../Images/72e9ea6799c4a4c8296b2ec7c9fa6301.png)](https://i.stack.imgur.com/Pw8Sa.gif)
[（来源：[json.org](http://json.org/value.gif)）]

* * *

作为旁注，此代码将使函数注意到`JSON.stringify`：

```
Function.prototype.toJSON = function() { return "Unstorable function" } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-24T11:37:28.070

这是使用 .prototype 的另一种方式。您可以添加一个函数来字符串化

```
JSON.stringify(obj, function(k, v) {
  if (typeof v === 'function') {
    return v + '';
  }
  return v;
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T23:36:46.600

它不应该对方法（或任何函数）进行字符串化 - 特别是因为大多数内置对象的方法（以及任何用户定义对象的原型）都是本机代码。

如果你*真的*需要它来打印你的方法，你可以覆盖你的对象的 .toString 方法，但是当你在字符串化的输出上调用 JSON.parse 时，它​​会将方法当作只是一个字符串，并且能够将其作为您必须使用的功能来调用`eval`- 通常不推荐这种做法。

# ruby-on-rails - 可能不需要数据库的 Rails 模型的实现

> ID：10729261
> 
> 赞同：1
> 
> 时间：2012-05-23T23:27:19.923
> 
> 标签：ruby-on-rails, types, model

我正在尝试在 Rails 中构建一个系统，其中我有一个带有“类型”列的项目模型，我不确定是否应该将类型作为字符串显式存储在项目表中，或者我是否应该应该存储一个 type_id 。问题是，我觉得创建类型模型会很愚蠢；类型不能被创建或销毁，它们的数量只是固定的。但是，如果我不创建模型，我能想到的唯一其他方法是在 /lib 中创建一个具有 get_name(type_id) 方法的 Type 类，这似乎完全是矫枉过正。

如果我决定只存储字符串，我会使用不必要的空间，并且按类型过滤会很奇怪。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T23:42:42.847

如果您确定类型是固定集，您可以在`Project`模型中定义一些数字常量，并将这些数字存储在`projects`表的列中。

这是一个示例（当然未经测试），我调用该列`category_id`以避免使用`type`会导致问题的名称，[如 rjz 所说](https://stackoverflow.com/questions/10729261/implementation-for-rails-model-that-might-not-need-a-database#comment13937377_10729261)：

```
class Project < ActiveRecord::Base
  # Project categories are constants
  CHEAP_PROJECT = 1
  SOUND_PROJECT = 2
  GRAPHIC_PROJECT = 3
  SECRET_PROJECT = 4

  # Force project_category_id to be a valid category identifier
  validates :category_id, :inclusion => {:in => 1..4}

  # At this point you can use the constants
  # Here an example of a scope to get the secret projects
  scope :secret_projects, where(:category_id => SECRET_PROJECT)
end 
```

确保验证`category_id`值是您定义的值之一。一旦你有了这些常量，你甚至可以在其他地方使用`Project::SOUND_PROJECT`.

我认为这是一个非常明确的解决方案，但是如果您的需求发生变化（它们*总是在*变化......），您必须创建一个模型并插入这些项目类别来维护这些标识符。

# variables - 使用 javascript 变量更改全局变量 onclick/img 源更新

> ID：10729265
> 
> 赞同：0
> 
> 时间：2012-05-23T23:27:37.797
> 
> 标签：variables, onclick, global-variables, updates

首先，我对 Javascript 完全陌生，但我有一些 HTML/CSS 经验。我一直在尝试为网站创建一个 html/javascript 图片库；（在 PHP 中可能会容易得多，但出于安全原因，Web 协调器在我们的服务器上禁用了 PHP）。

无论如何，我所拥有的是一个页面，分别在不同的 div 和 2 个 iframe 中显示专辑列表、专辑浏览器和照片查看器。我进行了设置，以便当有人单击专辑列表中的专辑时，会在专辑浏览器部分中打开一个页面（iframe：“***浏览器框架***”显示特定专辑中所有图像的缩略图）。我一直在尝试进行设置，以便当有人在相册浏览器中单击图像时，图像将出现在照片查看器部分（iframe：“***查看器框架***”显示照片本身）。

我不希望***查看器框架***中的照片大于查看器框架的设置尺寸，因此我为***查看器框架***创建了一个页面，该页面将图像放在具有一类设置尺寸的 div 中（定义在样式表）如下：

```
...<body>
<div class="photoview">
<img id="viewed_image" class="large" src="images/album1/1.jpg" />              
</div>
</body>... 
```

然后我创建了一个脚本，将图像 src 更新为一个变量：**image_to_be_viewed**并将其命名为 image-changer.js

```
// JavaScript Document
{
var image_to_be_viewed="images/album1/1.jpg";
document.getElementById("viewed_image").src=image_to_be_viewed;
} 
```

并向查看器框架页面添加了一个脚本，如下所示：

```
...<body>
<div class="photoview">
<img id="viewed_image" class="large" src="images/album1/1.jpg" />
<script src="image-changer.js"></script>              
</div>
</body>... 
```

现在我希望图库能够正常工作，以便在浏览器框架中加载的页面中，每当单击其中一张图片时，全局变量“image_to_be_viewed”的值将更改为单击图像的来源，如下所示：

```
<body>
<div class="photobrowse">
        <img class="medium" src="images/album1/1.jpg" onClick="image_to_be_viewed='images/album1/1.jpg'"/>
        <img class="medium" src="images/album1/2.jpg" onClick="image_to_be_viewed='images/album1/2.jpg'"/>
        <img class="medium" src="images/album1/3.jpg" onClick="image_to_be_viewed='images/album1/3.jpg'"/>
</div>
</body> 
```

它不起作用....

我正在处理的画廊位于[http://ptc.tamu.edu/test/gallery_directory/test_gallery.html](http://ptc.tamu.edu/test/gallery_directory/test_gallery.html) 直到在查看器框架中加载所选图片的所有内容（我正在运行 onlick 事件在***浏览器框架*****页面中默认**加载图片 1、2、3 ）（默认图片 4 和 5 只是将图像加载到 iframe 中，但无法调整大小，它太大并被切断，我不想要那）

 *我已经工作了一整天，我确定我在这里做错了什么，但我无法弄清楚它到底是什么。我感觉这与更改全局变量有关：***浏览器框架***页面中的**image_to_be_viewed**但我想与专家确认，而不是像无头鱼一样四处乱窜。我将继续尝试解决这个问题，但我想也许有一些专家的帮助会加快这个过程。

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:58:43.703

`onclick`触发器应该是一个javascript函数调用。

例如`onclick="changeImg('images/album1/1.jpg')"`

函数本身应该是这样的

```
function changeImg (image_to_be_viewed) {
  document.getElementById("viewed_image").src = image_to_be_viewed;
} 
```

顺便说一句，在做一些真正的事情之前，你可能应该多学一点 javascript。我推荐这[本书](http://eloquentjavascript.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T18:55:15.587

谢谢你，我让它工作了！我认为 changeImg 函数的目标是错误的文档/错误的框架，我通过将 js 脚本更改为：

```
function changeImg (image_to_be_viewed) {
window.parent.viewer_frame.document.getElementById("viewed_image").src = image_to_be_viewed;
} 
```**

# extjs4 - ExtJS 4（MVC）商店不使用我的自定义模型类

> ID：10729273
> 
> 赞同：2
> 
> 时间：2012-05-23T23:29:16.740
> 
> 标签：extjs4, extjs-mvc

我正在使用带有标准 MVC 架构的 ExtJS 4.0.7。我有一个带有自定义`store`和`model`类的网格。数据通过远程加载`store.load()`。我正在使用`ext-dev.js`动态依赖加载进行调试。

该应用程序加载正常，Chrome 控制台中没有错误。但问题是我商店中的记录与我的 AJAX 调用提供的数据完全相同，无论我的模型中有哪些字段。我什至尝试重命名和删除字段，但 Ext 没有注意。

使用控制台浏览我的`store`对象显示所有记录都有自己的自定义运行时生成的模型类，名为`Ext.data.reader.Json-Modelext-gen1141`. 这是我的代码的要点：

我的模型：

```
Ext.define('MyApp.model.FooModel', {
    extend: 'Ext.data.Model',

    idProperty: 'column1',
    fields: [
        {name: 'column1', convert: function(value, record) {
            return value + ' TEST-TEST-TEST';
        }},
        'column2',
        'column3'
    ]
}); 
```

我的店铺：

```
Ext.define('MyApp.store.FooStore', {
    extend: 'Ext.data.Store',
    model: 'MyApp.model.FooModel',
    autoLoad: false,
    proxy: {
        type: 'ajax',
        url: '/blah/blah',
        reader: {
            type: 'json'
        }
    }
}); 
```

我的网格：

```
Ext.define('MyApp.view.FooGrid', {
    extend: 'Ext.grid.Panel',
    alias: 'fooGrid',
    store: 'FooStore',
    columns: [{
        text: 'Column 1',
        dataIndex: 'column1',
        flex: 1
    },{
        text: 'Column 2',
        dataIndex: 'column2',
        flex: 1
    },{
        text: 'Column 3',
        dataIndex: 'column3',
        flex: 1
    }]
}); 
```

我的控制器：

```
Ext.define('MyApp.controller.Foo', {
    extend: 'Ext.app.Controller',
    views: ['FooGridFrame'],
    models: ['FooModel'],
    stores: ['FooStore'],

    init: function() {
        this.control({
            'fooGrid': {
                activate: function(grid) {
                    grid.getStore().load();
                }
            }
        });
    }
}); 
```

我不能说我做错了什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:13:28.760

事实证明，AJAX 后端（由 Ext3 的另一个开发人员编写）通过`metaData`属性提供了一些配置数据。我不知道Ext`Store`对此有任何关注。我的问题已通过更新后端以省略该`metaData`属性来解决。

它可能也可以更新`metaData`以提供我需要的适当配置，但我正在重构以使所有 UI 配置都发生在客户端中。

# php - PHP：如何正确拆分 unicode 韩语字符串？

> ID：10729275
> 
> 赞同：2
> 
> 时间：2012-05-23T23:29:22.537
> 
> 标签：php, character-encoding

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:39:11.887

尝试对 preg 使用 unicode 修饰符 (u)

[http://php.net/manual/en/reference.pcre.pattern.modifiers.php](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)

u (PCRE_UTF8) 此修饰符打开与 Perl 不兼容的 PCRE 的附加功能。模式字符串被视为 UTF-8。此修饰符在 Unix 上的 PHP 4.1.0 或更高版本以及 win32 上的 PHP 4.2.3 中可用。自 PHP 4.3.5 起检查模式的 UTF-8 有效性。

# javascript - How can I get the full object in Node.js's console.log(), rather than '[Object]'?

> ID：10729276
> 
> 赞同：1222
> 
> 时间：2012-05-23T23:29:28.317
> 
> 标签：javascript, node.js, debugging, console.log

When debugging using `console.log()`, how can I get the full object?

```
const myObject = {
   "a":"a",
   "b":{
      "c":"c",
      "d":{
         "e":"e",
         "f":{
            "g":"g",
            "h":{
               "i":"i"
            }
         }
      }
   }
};    
console.log(myObject); 
```

Outputs:

```
{ a: 'a', b: { c: 'c', d: { e: 'e', f: [Object] } } } 
```

But I want to also see the content of property `f`.

* * *

## 回答 #1

> 赞同：1896
> 
> 时间：2012-05-23T23:30:34.900

You need to use `util.inspect()`:

```
const util = require('util')

console.log(util.inspect(myObject, {showHidden: false, depth: null, colors: true}))

// alternative shortcut
console.log(util.inspect(myObject, false, null, true /* enable colors */)) 
```

Outputs

```
{ a: 'a',  b: { c: 'c', d: { e: 'e', f: { g: 'g', h: { i: 'i' } } } } } 
```

See [`util.inspect()` docs](http://nodejs.org/api/util.html#util_util_inspect_object_options).

* * *

## 回答 #2

> 赞同：800
> 
> 时间：2012-05-23T23:42:54.207

您可以使用`JSON.stringify`, 并获得一些不错的缩进以及可能更容易记住的语法。

```
console.log(JSON.stringify(myObject, null, 4)); 
```

* * *

```
{
    "a": "a",
    "b": {
        "c": "c",
        "d": {
            "e": "e",
            "f": {
                "g": "g",
                "h": {
                    "i": "i"
                }
            }
        }
    }
} 
```

第三个参数设置缩进级别，因此您可以根据需要进行调整。

如果需要，请在此处获取更多详细信息：

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)

* * *

## 回答 #3

> 赞同：554
> 
> 时间：2014-12-17T20:57:35.160

^(来自（至少）Node.js `v0.10.33`（稳定）/ `v0.11.14`（不稳定）的许多有用答案的汇编，大概通过（至少）`v7.7.4`（截至此答案的最新更新的最新版本）。向[Rory O'Kane 致敬](https://stackoverflow.com/users/578288/rory-okane)，感谢他的帮助。)

**tl;博士**

要获得问题中示例的所需输出，请使用[`console.dir()`](https://nodejs.org/api/console.html#console_console_dir_obj_options)：

```
console.dir(myObject, { depth: null }); // `depth: null` ensures unlimited recursion 
```

为什么不`util.inspect()`呢？因为它已经是诊断输出的核心：`console.log()`和`console.dir()`Node.js REPL 一样***隐式*****使用`util.inspect()`** *. 一般***不需要*直接`require('util')`**调用`util.inspect()`。*

 *详情如下。

* * *

*   [**`console.log()`**](https://nodejs.org/api/console.html#console_console_log_data_args)（及其别名，[`console.info()`](https://nodejs.org/api/console.html#console_console_info_data_args)）：

    *   **如果第一个参数不是格式字符串**:[`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options)会自动应用于每个参数：
        *   `o = { one: 1, two: 'deux', foo: function(){} }; console.log(o, [1,2,3]) // -> '{ one: 1, two: 'deux', foo: [Function] } [ 1, 2, 3 ]'`
        *   请注意，在这种情况下您**无法传递选项**，`util.inspect()`这意味着 2 个显着限制：
            *   输出的结构**深度****限制为*2 个*级别**（默认）。
                *   因为你不能用 来改变它`console.log()`，你必须改用`console.dir()`: **`console.dir(myObject, { depth: null }`prints with *unlimited* depth** ; 见下文。
            *   您不能打开语法着色。
    *   **如果第一个参数是格式字符串**（见下文）：用于[`util.format()`](https://nodejs.org/api/util.html#util_util_format_format_args)根据格式字符串打印剩余的参数（见下文）；例如：
        *   `o = { one: 1, two: 'deux', foo: function(){} }; console.log('o as JSON: %j', o) // -> 'o as JSON: {"one":1,"two":"deux"}'`
        *   笔记：
            *   *没有用于表示对象* `util.inspect()`样式的占位符。
            *   生成的 JSON`%j`打印不漂亮。
*   [**`console.dir()`**](https://nodejs.org/api/console.html#console_console_dir_obj_options)：

    *   **仅接受*1 个*参数进行检查**，并且始终适用——本质上，默认情况下是无选项[`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options)的包装器；`util.inspect()`例如：
        *   `o = { one: 1, two: 'deux', foo: function(){} }; console.dir(o); // Effectively the same as console.log(o) in this case.`
    *   **Node.js v0.11.14+**：可选的第二个参数指定**选项`util.inspect()`**- 见下文；例如：
        *   `console.dir({ one: 1, two: 'deux'}, { colors: true }); // Node 0.11+: Prints object representation with syntax coloring.`

*   **REPL** :***使用*** **语法着色****隐式打印任何表达式的返回值`util.inspect()`** *；
    即，只需输入一个变量的名称并按 Enter 键将打印其值的检查版本；例如：

    *   `o = { one: 1, two: 'deux', foo: function(){} } // The REPL echoes the object definition with syntax coloring.`* 

 ***[`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options)自动漂亮地打印*对象*和*数组*表示**，但仅在需要时产生***多行*输出**。

*   漂亮的打印行为可以由`compact`可选`options`参数中的属性控制；*无条件*`false`使用多行输出，而完全禁用漂亮打印；它也可以设置为一个*数字*（默认为）来控制有条件的多行行为 - 请参阅[文档](https://nodejs.org/api/util.html#util_util_inspect_object_options)。*`true`*`3`**

***   默认情况下， 无论输出是发送到文件还是终端，输出都包含[大约 60 个字符](https://github.com/nodejs/node/blob/master/lib/util.js#L815)^(，谢谢，[Shrey 。](https://stackoverflow.com/users/2248009/shrey))在实践中，由于*换行只发生在属性边界处*，您通常会得到较短的行，但它们也可以更长（例如，具有较长的属性值）。

    *   在 v6.3.0+ 中，您可以使用`breakLength`选项覆盖 60 个字符的限制；如果将其设置为`Infinity`，则所有内容都将在*一行*上输出。** 

 ****如果您想更好地控制漂亮打印，请考虑使用[`JSON.stringify()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)第三个参数**，但请注意以下几点：

*   *具有*循环引用的对象**失败*，例如`module`在全局上下文中。*
**   *方法*（功能）将被设计为不包括在内。*   您不能选择显示隐藏的（不可枚举的）属性。*   示例调用：
    *   `JSON.stringify({ one: 1, two: 'deux', three: true}, undefined, 2); // creates a pretty-printed multiline JSON representation indented with 2 spaces`*

 ** * *

**[`util.inspect()`](https://nodejs.org/api/util.html#util_util_inspect_object_options)选项对象**（第二个参数）：

可以传递一个可选的*选项*对象来改变格式化字符串的某些方面；*支持的一些*属性是：

^(有关当前完整列表，请参阅[最新的 Node.js 文档](https://nodejs.org/api/util.html#util_util_inspect_object_options)。)

*   `showHidden`

    *   如果`true`，那么对象的不可枚举属性 [那些指定在使用`for keys in obj`or时不显示的属性`Object.keys(obj)`] 也将被显示。默认为`false`.
*   `depth`

    *   告诉检查在格式化对象时递归多少次。这对于检查大型复杂对象很有用。默认为 2。要使其无限期递归，请通过`null`.
*   `colors`

    *   如果为 true，则输出将使用 ANSI 颜色代码进行样式设置。默认为`false`. 颜色是可定制的 [… – 见链接]。
*   `customInspect`

    *   如果`false`，则`inspect()`不会调用在被检查对象上定义的自定义函数。默认为`true`.

* * *

**[`util.format()`](https://nodejs.org/api/util.html#util_util_format_format_args)格式字符串占位符**（第一个参数）

*一些*受支持的占位符是：

^(有关当前完整列表，请参阅[最新的 Node.js 文档](https://nodejs.org/api/util.html#util_util_format_format_args)。)

*   `%s`- 细绳。
*   `%d`– 数字（整数和浮点数）。
*   `%j`– JSON。
*   `%%`– 单个百分号 ('%')。这不会消耗一个论点。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2014-01-15T16:05:42.843

另一个简单的方法是将其转换为 json

```
console.log('connection : %j', myObject); 
```

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2015-10-19T11:05:35.227

尝试这个：

```
console.dir(myObject,{depth:null}) 
```

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2017-01-26T20:32:12.350

从 Node.js 6.4.0 开始，这可以通过以下方式优雅地解决[`util.inspect.defaultOptions`](https://nodejs.org/api/util.html#util_util_inspect_defaultoptions)：

```
require("util").inspect.defaultOptions.depth = null;
console.log(myObject); 
```

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2014-03-02T01:27:02.810

也许`console.dir`就是你所需要的。

[http://nodejs.org/api/console.html#console_console_dir_obj](http://nodejs.org/api/console.html#console_console_dir_obj)

> 在 obj 上使用 util.inspect 并将结果字符串打印到标准输出。

如果您需要更多控制，请使用 util 选项。

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2018-01-11T12:55:25.290

这两种用法都可以应用：

```
// more compact, and colour can be applied (better for process managers logging)
console.dir(queryArgs, { depth: null, colors: true });

// get a clear list of actual values
console.log(JSON.stringify(queryArgs, undefined, 2)); 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2017-04-17T11:37:29.963

检查对象的一个​​好方法是在**Chrome DevTools for Node中使用 node** **--inspect**选项。

 **```
node.exe --inspect www.js 
```

在 chrome 中打开`chrome://inspect/#devices`并单击**Open dedicated DevTools for Node**

现在每个记录的对象都可以在检查器中使用，就像在 chrome 中运行的常规 JS 一样。

[![在此处输入图像描述](../Images/0dcf7e3181270a9b4263212bc320305a.png)](https://i.stack.imgur.com/cBoMu.jpg)

无需重新打开检查器，它会在节点启动或重新启动时自动连接到节点。--inspect和**Chrome DevTools for Node****可能**在旧版本的 Node 和 Chrome 中不可用。

 *** * *

## 回答 #10

> 赞同：20
> 
> 时间：2016-02-14T10:32:20.687

你也可以做

```
console.log(JSON.stringify(myObject, null, 3)); 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2019-06-14T04:28:50.213

我认为这可能对你有用。

```
const myObject = {
   "a":"a",
   "b":{
      "c":"c",
      "d":{
         "e":"e",
         "f":{
            "g":"g",
            "h":{
               "i":"i"
            }
         }
      }
   }
};

console.log(JSON.stringify(myObject, null, '\t'));
```

如[本答案](https://stackoverflow.com/a/5670892)所述：

> `JSON.stringify`的第三个参数定义了漂亮打印的空白插入。它可以是字符串或数字（空格数）。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-09-30T12:47:46.510

您可以简单地`inspect()`向您的对象添加一个方法，该方法将覆盖`console.log`消息中对象的表示

例如：

```
var myObject = {
   "a":"a",
   "b":{
      "c":"c",
      "d":{
         "e":"e",
         "f":{
            "g":"g",
            "h":{
               "i":"i"
            }
         }
      }
   }
};
myObject.inspect = function(){ return JSON.stringify( this, null, ' ' ); } 
```

然后，您的对象将根据需要在 console.log 和节点 shell 中表示

* * *

更新：

object.inspect 已被弃用（[https://github.com/nodejs/node/issues/15549](https://github.com/nodejs/node/issues/15549)）。改用 myObject[util.inspect.custom] ：

```
const util = require('util')

var myObject = {
  /* nested properties not shown */
}

myObject[util.inspect.custom] = function(){ return JSON.stringify( this, null, 4 ); }

console.log(util.inspect(myObject)) 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-02-19T23:56:11.133

# JSON.stringify()

```
let myVar = {a: {b: {c: 1}}};
console.log(JSON.stringify( myVar, null, 4 )) 
```

非常适合深入检查数据对象。这种方法适用于嵌套数组和带有数组的嵌套对象。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-07-27T11:35:47.223

一个简单的技巧是在运行脚本时使用`debug`模块添加为环境变量`DEBUG_DEPTH=null`

前任。

DEBUG=* DEBUG_DEPTH=null 节点 index.js

在你的代码中

```
const debug = require('debug');
debug("%O", myObject); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-09-18T13:50:40.390

最简单的选择：

```
 console.log('%O', myObject);
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-02-11T17:02:16.567

节点 REPL 具有用于覆盖对象显示方式的内置解决方案，请参见[此处](https://nodejs.org/dist/latest-v5.x/docs/api/repl.html#repl_customizing_object_displays_in_the_repl)。

> REPL 模块`util.inspect()`在打印值时在内部使用 , 。但是，`util.inspect`将调用委托给对象的`inspect()` 函数（如果有的话）。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-08-16T11:38:47.640

如果您正在寻找一种方法来显示数组中的隐藏项目，您必须通过`maxArrayLength: Infinity`

```
console.log(util.inspect(value, { maxArrayLength: Infinity })); 
```*********

# c# - Nested objects causing lost memory "leak" in .NET 4 LinkedList

> ID：10729279
> 
> 赞同：0
> 
> 时间：2012-05-23T23:30:09.433
> 
> 标签：c#, .net, memory-leaks, linked-list, dispose

Edit: Please ignore this question, this is a PBCAK programmer error.

**Part 1**

How can I correct the memory leak in this code?

**Part 2**

If the solution includes adding `Dispose` to `SummaryEntity`, how should I dispose of the object if I have a second list (summary-of-summaries) that references it? Assume I want to keep the 10 most recent `SummaryEntities` in the summary-of-summaries

**Code**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections.Concurrent;

namespace TestDoesLinkedListLeak
{
    public class SummaryEntity
    {
        public object PlaceHolder { get; set; }
        /// <summary>
        /// Note: This is a Field instead of a Property to support Interlockd methods
        /// </summary>
        public int ReferenceCount;
        public int Value;
        public int? PreviousValue { get; set; }
    }
    class FrequencyOfMatchedHash : Dictionary<int, SummaryEntity> 
    {
        private object frequencyOfMatchedHashLock;

        public void AddRecordHash(int hashCode, int value, object placeHolder)
        {
            SummaryEntity se = null;
            try
            {
                se = new SummaryEntity();
                se.ReferenceCount = 1;
                se.PlaceHolder = placeHolder;
                se.Value = value;

                lock (this.frequencyOfMatchedHashLock)
                {
                    if (this.ContainsKey(hashCode))
                    {
                        System.Threading.Interlocked.Add(ref this[hashCode].Value, value);
                        System.Threading.Interlocked.Increment(ref  this[hashCode].ReferenceCount);
                    }
                    else
                    {
                        this.Add(hashCode, se);
                    }
                }

                //this.AddOrUpdate(hashCode, se ,
                // (k, v) => 
                //     {
                //         System.Threading.Interlocked.Add(ref v.Value , value);
                //         System.Threading.Interlocked.Increment(ref v.ReferenceCount); 
                //         return v;
                //     });
            }
            finally
            {
                //se.Dispose();

            }
        }
    }
    class LLDateNode //:IDisposable
    {
        public FrequencyOfMatchedHash FrequencyOfMatch { get; set; }
        public DateTime Date { get; set; }

        public override string ToString()
        {
            return Date + " Count:" + FrequencyOfMatch.Count;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                Console.WriteLine("start");
                Console.WriteLine("Total Memory: {0}  Forced Collect: {1}", GC.GetTotalMemory(false), GC.GetTotalMemory(true));
                LinkedList<LLDateNode> tmp = new LinkedList<LLDateNode>();
                for (int i = 0; i < 111111; i++)
                {
                   // Console.Write(".");
                    tmp.AddFirst(new LLDateNode() { Date = DateTime.UtcNow, FrequencyOfMatch = new FrequencyOfMatchedHash() });
                }
                Console.WriteLine();
                Console.WriteLine("Done create, now delete");
                Console.WriteLine("Total Memory: {0}  Forced Collect: {1}", GC.GetTotalMemory(false), GC.GetTotalMemory(true));
                Console.WriteLine();

                for (int i = 0; i < tmp.Count; i++)
                {
                    //Console.Write("x");
                    tmp.RemoveFirst();
                }
                Console.WriteLine();
                Console.WriteLine("End of program");
                Console.WriteLine("Total Memory: {0}  Forced Collect: {1}", GC.GetTotalMemory(false), GC.GetTotalMemory(true));
                Console.ReadLine();
                Console.ReadLine();
                Console.ReadLine();
                Console.ReadLine();

            }
            catch
            {

            }
        }
    }
} 
```

**Output**

```
start
Total Memory: 186836  Forced Collect: 106656

Done create, now delete
Total Memory: 11222752  Forced Collect: 11217844

End of program
Total Memory: 11226036  Forced Collect: 5662320 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:50:34.707

我可能是错的，但是我认为当您调用时`tmp.RemoveFirst()`，尺寸`tmp.Count`会变小，而尺寸会`i`不断增长。所以，你只删除了一半的`Dictionary`. 要么不增加`i`要么 将`tmp.Count`放入变量然后在循环条件中使用它。考虑到您最后一次 Force Collect 的大小约为一半，这看起来可能是您的问题。

# php - wordpress JSONAPI introspector always limits number at 10?

> ID：10729281
> 
> 赞同：3
> 
> 时间：2012-05-23T23:30:14.837
> 
> 标签：php, wordpress

I'm a little new to Wordpress and the JSON API so forgive me if this is a newbie question but i'm trying to get *all* of the posts of a few different custom post types and return them as JSON via my own JSON controller (extending the JSON API)

if I do this:

```
$posts = $json_api->introspector->get_posts(array('post_type' => array('post','tweet','gallery','video','music'), 'post_parent' => 0, 'order' => 'ASC', 'orderby' => 'date', 'numberposts' => 100000000000));
echo count($posts); 
```

I only get "10" posts but there are a lot more in the db. Whereas if I do this:

```
echo count(get_posts(array('post_type' => array('post','tweet','gallery','video','music'), 'post_parent' => 0, 'order' => 'ASC', 'orderby' => 'date', 'numberposts' => 100000000000))); 
```

I get "74", the correct number of posts in the db. Essentially the JSON API is limiting the returned value to only 10 posts. I'm pretty sure I can hack the JSON API plugin to allow more but that seems like it would mess up my code for any API upgrades.

Is there a way to set the JSONAPI->introspector post number to "all"

Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:11:25.363

我正在回答我自己的问题，因为它有时可能对其他人有用。

在阅读了 wordpress 插件目录上有些稀疏的文档后，一无所获。我在 JSON API 代码中发现了一个变量，这是它的工作原理 PS -1 仅表示“全部”：

```
$json_api->query->count=-1;
$posts = $json_api->introspector->get_posts(array('post_type' => array('post','tweet','gallery','video','music'), 'post_parent' => 0, 'order' => 'ASC', 'orderby' => 'date', 'numberposts' => 4));
echo count($posts); 
```

您可以在进行 api 调用之前将计数设置为您想要的任何值。

# algorithm - Convert string to palindrome string with minimum insertions

> ID：10729282
> 
> 赞同：10
> 
> 时间：2012-05-23T23:30:23.460
> 
> 标签：algorithm, dynamic-programming, palindrome, lcs

In order to find the minimal number of insertions required to convert a given string(s) to palindrome I find the longest common subsequence of the string(lcs_string) and its reverse. Therefore the number of insertions to be made is length(s) - length(lcs_string)

What method should be employed to find the equivalent palindrome string on knowing the number of insertions to be made?

For example :

1) azbzczdzez

Number of insertions required : 5 Palindrome string : azbzcezdzeczbza

Although multiple palindrome strings may exist for the same string but I want to find only one palindrome?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T07:18:54.503

Let表示从 index 开始并在 index 结束`S[i, j]`的字符串的子字符串（包括两者），并且是 的最优解。`S``i``j``c[i, j]``S[i, j]`

显然，`c[i, j] = 0 if i >= j`。

一般来说，我们有递归：

![在此处输入图像描述](../Images/3b0767f1c48b1e50e15f11732c79620d.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:37:54.063

为了详细说明 VenomFangs 的答案，有一个简单的动态编程解决方案。请注意，我假设此处允许的唯一操作是插入字符（不删除、更新）。令 S 为 n 个字符的字符串。对此的简单递归函数 P 是：

```
 = P [i+1 .. j-1], if S[i] = S[j] 
```

P[i..j]

```
 = min (P[i..j-1], P[i+1..j]) + 1, 
```

如果您想进一步解释为什么这是真的，请发表评论，我很乐意解释（尽管稍加思考就很容易看到）。顺便说一句，这与您使用的 LCS 功能完全相反，因此验证您的解决方案实际上是最优的。当然这完全有可能是我搞砸了，如果是这样，请有人告诉我！

**编辑：考虑回文本身，这可以很容易地完成如下：** 如上所述， P[1..n] 会给你使这个字符串成为回文所需的插入次数。建立上述二维数组后，您可以通过以下方式找到回文：

从 i=1，j=n 开始。现在，字符串输出 = "";

```
while(i < j)
{
    if (P[i][j] == P[i+1][j-1]) //this happens if no insertions were made at this point
    {
        output = output + S[i];
        i++;
        j--;
    }
    else
    if (P[i][j] == P[i+1][j]) //
    {
        output = output + S[i];
        i++;
    }
    else
    {
        output = S[j] + output;
        j--;
    }
 }
 cout<<output<<reverse(output);
 //You may have to be careful about odd sized palindromes here,
 // I haven't accounted for that, it just needs one simple check 
```

这样会更好阅读吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:57:08.443

该解决方案看起来是一个动态编程解决方案。

您可能可以在以下帖子中找到答案：[如何计算将字符串转换为回文所需的字符数？](https://stackoverflow.com/questions/2237021/how-can-i-compute-the-number-of-characters-required-to-turn-a-string-into-a-pali)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-10-18T09:10:09.147

O(n) 的 PHP 解决方案

```
function insertNode(&$arr, $idx, $val) {
    $arr = array_merge(array_slice($arr, 0, $idx), array($val), array_slice($arr, $idx));
}
function createPalindrome($arr, $s, $e) {
    $i = 0;
    while(true) {
        if($s >= $e) {
            break;
        } else if($arr[$s] == $arr[$e]) {
            $s++; $e--; // shrink the queue from both sides 
            continue;
        } else {
            insertNode($arr, $s, $arr[$e]);
            $s++;
        }
    }
    echo implode("", $arr);
}
$arr = array('b', 'e', 'a', 'a', 'c', 'd', 'a', 'r', 'e');
echo createPalindrome ( $arr, 0, count ( $arr ) - 1 ); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-06-16T15:54:53.550

简单的。见下文 ：）

```
 String pattern = "abcdefghgf";
        boolean isPalindrome = false;
        int i=0,j=pattern.length()-1;
        int mismatchCounter = 0;

        while(i<=j)
        {
            //reverse matching
            if(pattern.charAt(i)== pattern.charAt(j))
                {
                    i++; j--; 
                    isPalindrome = true;
                    continue;
                }

            else if(pattern.charAt(i)!= pattern.charAt(j))
                {
                    i++;
                    mismatchCounter++;
                }

        }
        System.out.println("The pattern string is :"+pattern);
        System.out.println("Minimum number of characters required to make this string a palidnrome : "+mismatchCounter); 
```

# javascript - 在 JavaScript 中设置子类的 .prototype

> ID：10729287
> 
> 赞同：1
> 
> 时间：2012-05-23T23:30:50.480
> 
> 标签：javascript, oop

鉴于这段代码：

```
var SuperClass = function(a, b) {
  this.a = a;
  this.b = b;
};

SuperClass.prototype.getA = function() {
  return this.a;
};

var SubClass = function(a, b, c) {
  SuperClass.call(this, a, b);
  this.c = c;
}; 
```

为了启动`SubClass`原型，大多数建议似乎如下：

```
SubClass.prototype = new SuperClass(); 
```

对我来说创建（实例化）一个新`SuperClass`对象（具有自己的属性`a`和`b`属性）只是为了作为`SubClass`.

这也有效：

```
// anti-pattern
SubClass.prototype = SuperClass.prototype; 
```

但它通过`SuperClass.prototype`引用传递对象，因此您添加到的任何内容`SubClass.prototype`也会添加到`SuperClass.prototype`，因为它们是同一个对象。在大多数情况下，这不是预期的行为。

`SuperClass`问题：有没有一种方法可以在不创建 的实例作为基本原型的情况下实现正确的原型`SubClass`设计？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T23:33:24.523

在现代浏览器下：

```
SubClass.prototype = Object.create( SuperClass.prototype ); 
```

*这使您可以在不*调用父类的“构造函数”方法的情况下创建一个已定义的对象。有关更多详细信息，请继续阅读（包括旧浏览器的 polyfill 实现）。[`__proto__`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/Proto) *[`Object.create`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create)*

 *在行动中看到：

```
function Foo(){ console.log("AHHH!"); }
Foo.prototype.foo = 42;
function Bar(){}
Bar.prototype = Object.create(Foo.prototype);  // Note: no "AHHH!" shown
Bar.prototype.bar = 17;

// Showing that multi-level inheritance works
var b = new Bar;
console.log(b.foo,b.bar); //-> 42, 17

// Showing that the child does not corrupt the parent
var f = new Foo;          //-> "AHHH!"
console.log(f.foo,f.bar); //-> 42, undefined

// Showing that the inheritance is "live"
Foo.prototype.jim = "jam";
console.log(b.jim);       //-> "jam" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T16:09:25.280

旧浏览器的 Polyfill 实现

```
// Create a new instance based on existing object
function object(o) {
  function F() {};
  F.prototype = o;
  return new F();
}

function inherit(subClass, superClass) {
  var prototype = object(superClass.prototype);
  prototype.constructor = subClass;
  subClass.prototype = prototype;
} 
```

虽然通过 superClass.prototype 导致`F.prototype = superClass.prototype`，当对象函数返回时，F 函数不再被访问。结果，您无法获取和更改 F.prototype。

例子：

```
function SuperClass() {};
function SubClass() {};

SuperClass.prototype.say = function() {console.log('super');};

var instance = object(SuperClass.prototype); //instance.__proto__ === SuperClass.prototype
instance.say(); 
```*

# ruby-on-rails - Tableless model with ActiveRecord associations in Rails 3.2

> ID：10729289
> 
> 赞同：4
> 
> 时间：2012-05-23T23:31:09.280
> 
> 标签：ruby-on-rails, activerecord, model

My application configuration includes some values which need to be used in AR relationships. I'm aware this is an odd and potentially criminal thing to attempt, but I need to maintain the configuration as a textfile, and I honestly think I have a good case for a tableless model. Unfortunately I'm having trouble convincing AR (Rails 3.2) not to look for the table. My tableless model:

```
class Tableless < ActiveRecord::Base

  def self.table_name
      self.name.tableize
  end

  def self.columns
    @columns ||= [];
  end

  def self.column(name, sql_type = nil, default = nil, null = true)
    columns << ActiveRecord::ConnectionAdapters::Column.new(name.to_s, default, sql_type.to_s, null)
  end

  def self.columns_hash
    @columns_hash ||= Hash[columns.map { |column| [column.name, column] }]
  end

  def self.column_names
    @column_names ||= columns.map { |column| column.name }
  end

  def self.column_defaults
    @column_defaults ||= columns.map { |column| [column.name, nil] }.inject({}) { |m, e| m[e[0]] = e[1]; m }
  end

  def self.descends_from_active_record?
    return true
  end

  def persisted?
    return false
  end

  def save( opts = {} )
    options = { :validate => true }.merge(opts)
    options[:validate] ? valid? : true
  end
end 
```

This is extended by the actual model:

```
class Stuff < Tableless

  has_many :stuff_things
  has_many :things, :through => :stuff_things

  column :id, :integer
  column :name, :string
  column :value, :string

  def initialize(attributes = {})
    attributes.each do |name, value|
      send("#{name}=", value)
    end
  end
end 
```

This is all based on code found [here on SO](https://stackoverflow.com/questions/7275496/tableless-model-in-rails-3-1) and [elsewhere](https://gist.github.com/1101257), but alas, I get **SQLException: no such table: stuffs:** Any clues any one?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T07:25:09.063

对于 Rails >= 3.2，有[**activerecord-tableless**](http://rubygems.org/gems/activerecord-tableless) gem。它是创建无表 ActiveRecord 模型的宝石，因此它支持验证、关联和类型。

当您在 Rails 3.x 中使用推荐的方式（使用 ActiveModel 而不是 ActiveRecord）时，不支持关联或类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-05T13:53:10.640

对于 Rails >= 4，您还可以通过像这样定义无表类来获得对验证、关联和一些回调（如 after_initialize）的支持：

```
class Tableless < ActiveRecord::Base
    def self.columns() @columns ||= []; end

    def self.column(name, sql_type = nil, default = nil, null = true)
        columns << ActiveRecord::ConnectionAdapters::Column.new(name.to_s, default, sql_type.to_s, null)
    end 

    attr_accessor :id, :name, :value

    has_many :stuff_things
    has_many :things, :through => :stuff_things

end 
```

# haskell - 使用 ResourceT 解决问题

> ID：10729291
> 
> 赞同：1
> 
> 时间：2012-05-23T23:31:13.417
> 
> 标签：haskell, monads, monad-transformers, conduit

我正在调整这个[例子](http://www.yesodweb.com/book/json-web-service)，特别是客户端。我会告诉你我认为问题是什么，遵循代码和它产生的错误。

```
> {-# LANGUAGE OverloadedStrings #-}
> import Network.HTTP.Conduit
> ( http, parseUrl, newManager,def, withManager, RequestBody (RequestBodyLBS)
> , requestBody, method, Response (..)
> )
> import Data.Aeson (Value (Object, String))
> import Data.Aeson.Parser (json)
> import Data.Conduit
> import Data.Conduit.Attoparsec (sinkParser)
> import Control.Monad.IO.Class (liftIO)
> import Control.Monad.Trans.Class (lift)
> import Data.Aeson (encode, (.=), object)

> main :: IO ()
> main = withManager $ \manager -> do
>    value <- makeValue
> -- We need to know the size of the request body, so we convert to a
> -- ByteString
>    let valueBS = encode value
>    req' <- parseUrl "http://10.64.16.6:3000/"
>    let req = req' { method = "POST", requestBody = RequestBodyLBS valueBS }
>    Response status version headers body <- http req manager
>    resValue <- body $$ sinkParser json
>    handleResponse resValue

> -- Application-specific function to make the request value
> makeValue :: ResourceT IO Value
> makeValue = return $ object
>    [ ("foo" .= ("bar" :: String))
>    ]

> -- Application-specific function to handle the response from the server
> handleResponse :: Value -> ResourceT IO ()
> handleResponse foo = do  
>    _ <- lift (print foo)
>    return ()

No instance for (Control.Monad.Trans.Class.MonadTrans ResourceT)
  arising from a use of `lift'
Possible fix:
  add an instance declaration for
  (Control.Monad.Trans.Class.MonadTrans ResourceT)
In a stmt of a 'do' block: _ <- lift (print foo)
In the expression:
  do { _ <- lift (print foo);
       return () }
In an equation for `handleResponse':
    handleResponse foo
      = do { _ <- lift (print foo);
             return () } 
```

这是问题所在，错误说没有 Control.Monad.Trans.Class.MonadTrans ResourceT 的实例

但我认为有，由于这个[文档](http://hackage.haskell.org/packages/archive/conduit/0.4.2/doc/html/Data-Conduit.html#t%3aResourceT)。那么哪里出了问题？

如下所述，有一些 janke 正在发生`Control.Monad.Trans.Resource`

这是`ResourceT`自省的结果。

```
*Main Control.Monad.Trans.Resource> :i ResourceT
newtype ResourceT m a
  = Control.Monad.Trans.Resource.ResourceT (GHC.IORef.IORef
                                              Control.Monad.Trans.Resource.ReleaseMap
                                            -> m a)
    -- Defined in `Control.Monad.Trans.Resource'
instance Monad m => Monad (ResourceT m)
  -- Defined in `Control.Monad.Trans.Resource'
instance Functor m => Functor (ResourceT m)
  -- Defined in `Control.Monad.Trans.Resource'
instance MonadBaseControl b m => MonadBaseControl b (ResourceT m)
  -- Defined in `Control.Monad.Trans.Resource'
instance MonadThrow m => MonadThrow (ResourceT m)
  -- Defined in `Control.Monad.Trans.Resource' 
```

版本`resourcet`是

```
[mlitchard@Boris Boris]$ ghc-pkg list resourcet
WARNING: there are broken packages.  Run 'ghc-pkg check' for more details.
/usr/lib/ghc-7.4.1/package.conf.d
/home/mlitchard/.ghc/x86_64-linux-7.4.1/package.conf.d
   resourcet-0.3.2.1 
```

关于如何进行的任何想法？MonadTrans ResourceT 的实例在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:53:40.623

如果我是一个赌徒，我会说你安装了某个库的多个版本。例如，假设您有 0.2 和 0.3 版本的转换器，并且 resourcet 是针对 0.2 版本构建的。当您编写代码时`import Control.Monad.Trans.Class (lift)`，您正在导入 0.3 版`lift`，但没有涉及它的实例。

测试这一点的最简单方法是对你的代码进行 cabalize。Cabal 将确保您拥有所涉及库的正确版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T23:45:14.033

**编辑：**这个答案不能解决问题，导入仍然不能解决实例，即使它应该。这似乎是 GHC 或其他系统中的错误。

该[`Data.Conduit`](http://hackage.haskell.org/packages/archive/conduit/latest/doc/html/Data-Conduit.html)模块只是为了方便而重新导出[`ResourceT`](http://hackage.haskell.org/packages/archive/resourcet/latest/doc/html/Control-Monad-Trans-Resource.html#t%3aResourceT)；资源单子转换器在单独的包中定义[`resourcet`](http://hackage.haskell.org/package/resourcet)。[`conduit`](http://hackage.haskell.org/package/conduit)因此不会重新导出类实例（显然？）。您需要手动导入[`Control.Monad.Trans.Resource`](http://hackage.haskell.org/packages/archive/resourcet/latest/doc/html/Control-Monad-Trans-Resource.html)才能访问关联的类实例。这当然可以使用以下语法来完成：

```
import Control.Monad.Trans.Resource () -- Only import instances 
```

# ruby-on-rails-3 - Rails validation on content type not working with Paperclip

> ID：10729292
> 
> 赞同：2
> 
> 时间：2012-05-23T23:31:17.593
> 
> 标签：ruby-on-rails-3, content-type

I have a validation in my Rails (3.1.4) model to make sure no one tries to upload anything malicious in leiu of their profile image, but when I try to upload a jpeg, the validation is triggering. I'm using the Paperclip gem and I'm unsure if that is having an impact.

validation in user.rb model

```
validates_attachment_content_type :profile_image, :content_type => ['image/jpeg', 'image/png', 'image/gif'], :message => "Only jpeg, gif and png files are allowed for profile pictures" 
```

When I look at the properties of the jpeg locally (Windows O/S):

*   Item type = JPEG image
*   Type of file: JPEG image (.jpg)

Am I doing something wrong in my validation?

Also, when it triggers, it puts the model and field name before the message. Is there a way to avoid that? ie 'Profile image profile image content type Only jpeg, gif and png files are allowed for profile pictures'

Thank you!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:48:34.127

您应该添加`'image/jpg'`到内容类型数组中，我认为这就是您所缺少的。

# javascript - jqgrid hide() 行问题

> ID：10729296
> 
> 赞同：0
> 
> 时间：2012-05-23T23:31:43.460
> 
> 标签：javascript, jqgrid

我正在使用最新版本的 JqGrid，我在这里了解到现在有内置的 hding 方法。我想出了如何使用隐藏行

```
$("#"+rowid).hide(); 
```

但在这里我遇到了一个非常大的问题。我的 jgrid 被限制为每页显示不超过 10 行，并且经常发生在使用上述代码后，我的项目开始显示在第 10 页。

提前致谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:35:46.747

该[`hide`](http://api.jquery.com/hide/)方法不是 jqGrid 的一部分，而是 jQuery 本身的一部分：

> 隐藏匹配的元素。

所以这可能解释了为什么它没有按您期望的方式工作。你到底想做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T08:42:02.610

jqgrid 允许删除行。[请参阅示例页面](http://trirand.com/blog/jqgrid/jqgrid.html)上的“实时数据操作 - 删除行”示例。

```
$("#dedata").click(function() { 
  var gr = jQuery("#delgrid").jqGrid('getGridParam','selrow'); 
  if( gr != null ) 
    jQuery("#delgrid").jqGrid('delGridRow',gr,{reloadAfterSubmit:false}); 
  else  
    alert("Please Select Row to delete!"); 
}); 
```

另请参阅[delGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#delgridrow)方法文档。

另一种选择是更改数据源（这取决于用于填充表格的方法），从中删除行并重新填充表格。

# ruby-on-rails - 模型范围正在破坏 rake db:migrate - rails 3.2.3 postgres 9.1.3

> ID：10729298
> 
> 赞同：5
> 
> 时间：2012-05-23T23:31:50.670
> 
> 标签：ruby-on-rails, ruby, postgresql, ruby-on-rails-3.2

我在新的 Rails 应用程序（3.2.3）中运行迁移时遇到了问题。我们正在使用 postrgres 9.1.3 和 - pg (0.13.2) -

当我运行 rake db:create，然后 rake db:migrate，我得到 ->

```
1.9.3-p194 (master) rake db:migrate --trace
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
PG::Error: ERROR:  relation "roles" does not exist
LINE 4:              WHERE a.attrelid = '"roles"'::regclass
                                    ^
:             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
          FROM pg_attribute a LEFT JOIN pg_attrdef d
            ON a.attrelid = d.adrelid AND a.attnum = d.adnum
         WHERE a.attrelid = '"roles"'::regclass
           AND a.attnum > 0 AND NOT a.attisdropped
         ORDER BY a.attnum 
```

即使没有定义任何迁移，我也能得到这个，所以我不认为这是迁移本身的问题。当我查看堆栈跟踪时，我看到在我的用户模型中定义的范围正在运行 - 当我将它们注释掉时，迁移运行没有问题。

```
scope :team_leaders, where(role_id: Role.where(name: 'Team Leader').first.try(:id))
scope :area_leaders, where(role_id: Role.where(name: 'Area Leader').first.try(:id))
scope :nation_leaders, where(role_id: Role.where(name: 'Nation Leader').first.try(:id))
scope :employees, where(role_id: Role.where(name: 'Employee').first.try(:id)) 
```

这是rails中的错误，还是我做错了什么？我真的很感谢一些帮助 - 我们可以在整个应用程序中删除这些范围的使用，但这是我们想要避免的事情。

我是否应该将这些范围放在某种条件中，当 Rails 加载到控制台或作为服务器时调用，而不是在迁移期间调用？

非常感谢，

丹·索特

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-26T16:52:12.087

我遇到了完全相同的问题。经过 2 个小时的调试并拔掉我的头发后，这个名叫**Carl Zulauf**的有福的人在评论中发布了答案。

问题是我们在运行迁移时正在评估范围，因此与尚未迁移的另一个表的任何依赖关系都会导致该错误。

只需用 lambda 包装所有作用域。例如：

```
scope :team_leaders, lambda { where(role_id: Role.where(name: 'Team Leader').first.try(:id)) } 
```

对所有范围都这样做。

这应该够了吧。他们需要被惰性评估（就在被调用时），并且没有`lambda`他们被立即评估。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T11:40:13.147

`find_`如果您的范围以like开头，`find_by_foo`那么它们将中断`rake db:migrate`。这是我的情况的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-10T13:19:53.307

我实际上对由默认范围引起的迁移有同样的问题，如下所示：

```
default_scope where(deleted: false) 
```

错误是由这样的代码块引起的：

```
ModelName.all.each_with_index do |m, i|
...
end 
```

这个问题通过取消作用域解决：

```
ModelName.unscoped.each_with_index do |m, i|
...
end 
```

# jquery - 以模态播放视频

> ID：10729299
> 
> 赞同：1
> 
> 时间：2012-05-23T23:31:53.557
> 
> 标签：jquery, html, css, modal-dialog

有没有可以播放youtube、vimeo和上传到网站的视频的模态？我一直在搜索，但找不到很多模态示例

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:39:58.687

**是的，一个例子是[Fancybox](http://fancybox.net/)。**

[这是一堆](http://fancybox.net/vimeo)使用 Vimeo 的示例，您可以轻松更改为 YouTube 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:42:36.000

HTML / JS 中没有内置模式。

然而，要实现一个模态，你只需要一个完整的窗口大小的 div 在你的播放器和背景内容（使用`z-index`style 属性）之间，它可以防止事件到达它下面的元素。

# c# - 并发字典 AddOrUpdate 方法第三个参数？

> ID：10729300
> 
> 赞同：7
> 
> 时间：2012-05-23T23:31:58.033
> 
> 标签：c#, asp.net, .net, asp.net-mvc

```
private readonly ConcurrentDictionary<string, System.Drawing.Color> _colorSet;      

public void BuildColorSet(IList<string> colorNames, string prefix, bool forceLastToGray)
{
    var size = forceLastToGray ? colorNames.Count - 1 : colorNames.Count;

    int nbHue = 6;
    int nbCycle = (int)Math.Ceiling((double)size / nbHue);

    var saturationMax = nbCycle <= 2 ? 1.0 : 1.0;
    var saturationMin = 0.3;
    var luminanceMax = nbCycle <= 2 ? 0.85 : 0.85;
    var luminanceMin = 0.3;
    var maxSaturationShift = 0.30;
    var maxLuminanceShift = 0.15;

    var interval = 1.0 / Math.Min(size, nbHue);

    var saturationShift = (saturationMax - saturationMin) / (nbCycle - 1);
    saturationShift = Math.Min(saturationShift, maxSaturationShift);
    var luminanceShift = (luminanceMax - luminanceMin) / (nbCycle - 1);
    luminanceShift = Math.Min(luminanceShift, maxLuminanceShift);

    var hueShift = 0.0;

    var saturation = saturationMax;
    var luminance = luminanceMax;
    for(var i = 0; i<size; i++)
    {
        if(i > 0 && (i % nbHue == 0)) // Next Cycle
        {
            saturation -= saturationShift;
            luminance -= luminanceShift;
            hueShift = hueShift == 0 ? interval/2 : 0;
        }
        var hue = interval*(i%nbHue) + hueShift;

        System.Drawing.Color color = HSL2RGB(hue, saturation, luminance);

    _colorSet.AddOrUpdate(prefix + colorNames[i], color, ???);
    }
    if(forceLastToGray)
    {
        _colorSet.TryAdd(prefix + colorNames[colorNames.Count - 1], System.Drawing.Color.LightGray);
    }

    _cssDirty = true;
} 
```

如果颜色存在新值，我希望能够更新字典。如果字典中没有颜色，也可以添加到字典中。
我正在使用 AddOrUpdate 但无法获取 AddOrUpdate 方法的第三个参数（形成 lambda 表达式或委托方法）。
知道我的第三个参数会是什么样子吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-23T23:57:23.217

从[文档](http://msdn.microsoft.com/en-us/library/dd287191.aspx)中：

> updateValueFactory 类型：System.Func 用于根据键的现有值为现有键生成新值的函数

如果集合中的值已经存在，这将单独保留它：

```
_colorSet.AddOrUpdate(prefix + colorNames[i], color,
            (key, existingVal) =>
            {
                return existingVal;
            }); 
```

这将用为插入指定的相同值替换集合中的值：

```
_colorSet.AddOrUpdate(prefix + colorNames[i], color,
            (key, existingVal) =>
            {
                return color;
            }); 
```

例如，您可以执行条件逻辑、旧值和新值之间的比较，或更新函数中的原始对象。

```
_colorSet.AddOrUpdate(prefix + colorNames[i], color,
            (key, existingVal) =>
            {
                if (existingVal.Name == "Red")
                    return existingVal;
                else
                    return color;
            }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:52:36.260

根据asawyer给你的网页，需要的是一个功能

```
Func<TKey, TValue, TValue> 
```

在这种情况下，看起来你正在传递一个字符串和一个颜色，但你想如何梳理它们很大程度上取决于你。您需要一个返回 Color 的函数，因此从语法的角度来看，以下内容应该可以工作。

```
(key, oldValue) => oldValue 
```

我不知道你可能会计算谁的新值。例如，您可以使用新颜色

```
_colorSet.AddOrUpdate(prefix + colorNames[i], color, (key, oldValue) => color); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-30T16:50:15.717

看起来您不在乎颜色是否已经存在；你总是想更新字典中的值。在这种情况下，您最好使用普通索引器，例如

```
_colorSet[prefix + colorNames[i]] = color; 
```

# c - 终端挂钩。我可以在终端中运行命令之前调用方法吗？

> ID：10729303
> 
> 赞同：1
> 
> 时间：2012-05-23T23:32:11.247
> 
> 标签：c, bash, shell, command-line, terminal

我想制作一个终端应用程序来存储有关文件/目录的信息。如果文件被移动或重命名，我想要一种方法来保留信息。

我认为我可以做的是在运行任何命令之前执行一个函数。我找到了这个：

[http://www.twistedmatrix.com/users/glyph/preexec.bash.txt](http://www.twistedmatrix.com/users/glyph/preexec.bash.txt)

但我想知道这是否是一个很好的方法。还是我应该做点别的？

我想在输入 mv 时从 C 程序调用该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:53:25.280

如果您要尝试将某种元数据附加到文件中，那么有一种更好的支持方式可以做到这一点——[扩展属性](https://en.wikipedia.org/wiki/Extended_file_attributes)。

另一种解决方案可能是使用文件的 inode 编号作为您自己维护的数据库的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:05:30.050

您也许可以使用[`DEBUG` `trap`](http://tiswww.case.edu/php/chet/bash/bashref.html#IDX86)in Bash。

来自[`man bash`](http://tiswww.case.edu/php/chet/bash/bash.html)：

> 如果 sigspec 是 DEBUG，则命令 arg 在每个简单命令、for 命令、case 命令、select 命令、每个算术 for 命令之前以及在 shell 函数中执行第一个命令之前执行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:45:35.220

你可以给 mv 命令起别名吗？在 .profile 或 .bashrc

```
alias mv=/usr/bin/local/mymv 
```

其中 mymv 是一个编译的可执行文件，它运行您的 C 代码函数并调用 /usr/bin/mv。

precmd 和 preeexec 为每个运行的 bash 脚本增加了一些开销，即使脚本从不调用 mv。alias 的缺点是它需要 /usr/local 中的新代码，如果脚本或用户使用 /usr/bin/mv 而不是 mv 它不会做你想要的。一般来说，做这样的事情通常意味着有更好的方法来处理某种服务（守护程序）或驱动程序的问题。另外，如果您的 C 代码无法正确处理有趣的输入，例如

```
mv somefille /dev/null 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T23:45:50.883

如果您想在终端中执行某些命令后每次运行命令，只需将以下内容放入`~/.bashrc`：

```
PROMPT_COMMAND="your_command;$PROMPT_COMMAND" 
```

如果您希望每次在执行 mv 之前执行命令，请将以下内容放入`~/.bashrc`：

```
alias mv="your_script" 
```

确保您的脚本`mv`在需要时执行。

您可以使用[inotify](http://linux.die.net/man/7/inotify)库来跟踪文件系统更改。这是一个很好的解决方案，但是一旦用户删除文件，它就已经消失了。

# allegro5 - 包括 Allegro 5 期

> ID：10729305
> 
> 赞同：-1
> 
> 时间：2012-05-23T23:32:25.113
> 
> 标签：allegro5

我刚刚从终端安装了 Allegro 5，如下所述：[http](http://wiki.allegro.cc/index.php?title=Install_Allegro5_From_SVN/OSX#Preliminaries) ://wiki.allegro.cc/index.php?title=Install_Allegro5_From_SVN/OSX#Preliminaries 。但是，当我尝试编写程序时，包含 allegro.h 时遇到问题。我试过了：

```
 #include <"allegro5/allegro5.h">
    #include <iostream>
    using namespace std;

    int main () {
        cout<<"foo"<<endl;
    } 
```

但是当我编译（使用 g++）时出现以下错误：

```
foo.cpp:1:33: error: "allegro5/allegro5.h": No such file or directory 
```

我也试过：

```
 #include <"/usr/local/include/allegro5/allegro5.h">
    #include <iostream>
    using namespace std;

    int main () {
        cout<<"foo"<<endl;
    } 
```

但是当我尝试编译时出现以下错误：

```
foo.cpp:1:52: error: "/usr/local/include/allegro5/allegro5.h": No such file or directory 
```

我知道 /usr/local/include/allegro5/allegro5.h 中的文件存在。我已经尝试过 #include <"/usr/local/include/allegro5/allegro.h"> 和 #include <"allegro5/allegro.h"> 以及所有类似的结果。我知道这是一个非常基本的问题，我只想能够编写一个可以成功包含 allegro 的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:05:10.180

双引号错误，文件不正确。它应该是：

```
#include <allegro5/allegro.h> 
```

# c#-4.0 - 更新 Mongo 驱动程序后 Update.Setwrap 中的 Nullreference 异常

> ID：10729306
> 
> 赞同：0
> 
> 时间：2012-05-23T23:32:39.060
> 
> 标签：c#-4.0, mongodb

我在 Mongo-C# 环境中，我们一直在使用 Mongo 1.3.x DLL 对 Mongo 进行编码。最近，我将它更新为 1.4.2，其他一切都很好，直到我遇到一个问题，我注意到以前版本的 Mongo DLL 正在处理

```
update.SetWrapped(property.Name, value); 
```

值为 null 但最新版本不喜欢它时的所有文件，它会引发 nullreference 异常。

这里的问题是我希望它能够接受 Null 值。以前有人遇到过这个问题吗？如果是，您是如何处理的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:54:39.503

引入此功能时发生了重大变化。您需要为此使用 BsonNull.Value 。因此，您的代码将如下所示：

```
update.SetWrapped(property.Name, BsonValue.Create(value) ?? BsonNull.Value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T15:21:39.950

我相信您应该能够将 C# null 传递给 Update.SetWrapped<T> 因为 T 是 POCO 而不是 BsonValue 并且 T 的序列化程序将决定如何序列化 C# null。

我为此创建了一张 JIRA 票证：

[https://jira.mongodb.org/browse/CSHARP-486](https://jira.mongodb.org/browse/CSHARP-486)

请注意，虽然 1.4 之前的 C# 驱动程序版本没有抛出 NullReferenceException，但它们也没有像您预期的那样将属性更新为 BSON null（将 C# null 传递给 SetWrapped 将 SetWrapped 在早期版本中变为无操作）。

C# null 处理的基本规则很明确：

1.  C# null 不是有效的 BsonValue，请改用 BsonNull.Value
2.  C# null 对 POCO 有效，并且可能会被序列化为 BSON null（尽管从技术上讲，POCO 的序列化程序可以选择不同的表示形式）

# php - PHP 比较运算符和 if (!foo()) 形式的语句

> ID：10729307
> 
> 赞同：2
> 
> 时间：2012-05-23T23:32:39.577
> 
> 标签：php, if-statement, boolean, variable-assignment, comparison-operators

这是我的小脚本，通过编写它我了解到我不知道 PHP 如何处理变量......

```
<?php 
$var = 1;

echo "Variable is set to $var <br />";

if (!foo()) echo "Goodbye";

function foo()
{
    echo "Function should echo value again: ";

    if ($var == 1)
    {
        echo "\$var = 1 <br />";
        return true;
    }

    if ($var == 2)
    {
        echo "\$var = 0 <br />";
        return false;
    }
}     
?> 
```

所以，这就是*我认为*这个脚本的解释方式：

*   该语句`if (!foo)`将运行`foo()`。如果函数返回`false`，它也会在最后回显“再见”。

*   该函数`foo()`将检查是否`$var == 1`或`2`（对数据类型不严格）。如果为 1，它将回显“函数应再次回显值：1”，如果为 2，它将回显相同但数字为 2。

由于某种原因，内部的**两个**if 语句`foo()`都被传递（我知道这一点，因为如果我将第一个 if 语句更改`if ($var != 1)`为 ，*即使我声明了* `$var = 1`.

这里发生了什么事？我以为我已经把这一切都放下了，现在我觉得我只是倒退了：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T23:35:13.447

该函数不知道是什么`$var`。您必须将其传入或使其全局化：

```
function foo() {
  global $var;
  /* ... */
} 
```

或者

```
$var = 1;
if ( !foo( $var ) ) echo "Goodbye";

function foo ( $variable ) {
  /* Evaluate $variable */
} 
```

顺便说一句，避免全局变量几乎总是更好。我会鼓励你走后一条路线并将值传递给函数体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:38:17.627

我强烈建议您阅读[可变范围](http://php.net/manual/en/language.variables.scope.php)手册页。`$var`对于函数来说是不可见的`foo()`，所以它内部是未定义的。

# android - Android Eclipse 在特定位置放置文本视图

> ID：10729312
> 
> 赞同：0
> 
> 时间：2012-05-23T23:33:28.297
> 
> 标签：android, xml, eclipse, textview

我在 XML 文件中创建它，并希望将文本视图放置在特定位置。

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginBottom="200dp"
    android:text="Text"
    android:textColor="@color/blue" 
/> 
```

它位于最后一个按钮的下方，因此它位于屏幕中间。我希望它位于屏幕右侧的底部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:45:27.980

如果您使用 RelativeLayout 作为父级，这很容易。

```
android:layout_alignParentRight
android:layout_alignParentBottom 
```

（检查大写，我没有地方可以仔细检查）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T06:36:32.620

如果您要指定每个视图的位置，则使用***RelativeLayout将是完美的。***它是 Android 布局中最灵活的布局。

看看这个[教程](http://www.mkyong.com/android/android-relativelayout-example/)。它讨论了如何在 RelativeLayout 中定位视图。

我希望你能从中得到一些想法来解决你的问题。

# windows-8 - 如何禁用选择 GridView 中的单个项目

> ID：10729315
> 
> 赞同：6
> 
> 时间：2012-05-23T23:33:43.540
> 
> 标签：windows-8, windows-runtime, winrt-xaml

如何禁用 GridView 中的选择单个项目？

我有一个 GridView，它的 ItemsSource 绑定到 IEnumerable<SampleDataItem>。我希望能够以编程方式不允许选择列表中的某些项目，同时允许选择其他项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T10:08:46.233

虽然我没有这样做，但您应该能够在 GridView 上使用 ItemContainerStyleSelector，该方法为您提供容器 (GridViewItem) 和您要绑定的项目。从那里您可以将 GridViewItem 上的 IsEnabled 属性设置为 false ，使其无法选择。

您可能还需要选择自定义样式，因为默认的 GridViewItem 样式将自定义禁用项目的外观。

**更新**DataTemplateSelector 解决方案

```
public class IssueGridTemplateSelector : DataTemplateSelector
{
    protected override DataTemplate SelectTemplateCore(object item, DependencyObject container)
    {
        var selectorItem = container as SelectorItem;

        if (item is Issue)
            return IssueTemplate;

        selectorItem.IsEnabled = false;
        selectorItem.Style = RepositoryItemStyle;

        return RepositoryTemplate;
    }

    public DataTemplate IssueTemplate
    {
        get;
        set;
    }

    public DataTemplate RepositoryTemplate
    {
        get;
        set;
    }

    public Style RepositoryItemStyle
    {
        get;
        set;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T16:48:18.437

奈杰尔的回答很棒。[我刚刚向WinRT XAML 工具包](http://bitly.com/WinRTXamlToolkit)添加了一些附加属性，如果您使用 ItemsSource 属性绑定来填充 GridView，这些属性应该会更简单。

对我来说，修改 GridViewItem 属性的常用方法是使用 GridView.ItemContainerStyle 属性。使用该方法，您需要使用样式指定 IsEnabled 属性，并且样式设置器不支持 WinRT 中的绑定。使用 ItemContainerStyleSelector 可能是一种方法，但它需要定义一个自定义类。

我创建了一个带有 IsEnabled 属性的[GridViewItemExtensions 类](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/13987#280704)，您可以在 GridView.ItemTemplate 中的任何控件上设置该属性，如下所示：

```
xmlns:xyzc="using:Xyzzer.WinRT.Controls"
xyzc:GridViewItemExtensions.IsEnabled="{Binding IsEnabled}" 
```

该属性具有在其祖先可视树中查找 GridViewItem 并保持其 IsEnabled 值与其后代上设置的 GridViewItemExtensions.IsEnabled 值同步的行为。

然后正如奈杰尔所说 - 您仍然需要从 GridViewItem 中提取模板并对其进行修改，以便禁用的项目看起来不合适。

# flash - flash as2 补间循环

> ID：10729319
> 
> 赞同：0
> 
> 时间：2012-05-23T23:34:33.913
> 
> 标签：flash, actionscript-2

我想按顺序制作补间菜单项。我怎样才能在 for 循环中做到这一点？我不想手动操作。

感谢您的回答。

我的代码；

```
var open_menuTween0:Tween = new Tween(_root.menu_tab_mc["menu"+0+"_mc"], "_y", Regular.easeIn, -20,0.05,0.2, true);
open_menuTween0["onMotionFinished"] = function(){
var open_menuAlpha0:Tween = new Tween(_root.menu_tab_mc["menu"+0+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
var open_menuTween1:Tween = new Tween(_root.menu_tab_mc["menu"+1+"_mc"], "_y", Regular.easeIn, 0.05,44.15,0.2, true);
open_menuTween1["onMotionFinished"] = function(){
var open_menuAlpha1:Tween = new Tween(_root.menu_tab_mc["menu"+1+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
var open_menuTween2:Tween = new Tween(_root.menu_tab_mc["menu"+2+"_mc"], "_y", Regular.easeIn, 44.15,88.25,0.2, true);
open_menuTween2["onMotionFinished"] = function(){
var open_menuAlpha2:Tween = new Tween(_root.menu_tab_mc["menu"+2+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
var open_menuTween3:Tween = new Tween(_root.menu_tab_mc["menu"+3+"_mc"], "_y", Regular.easeIn,88.25,132.35,0.2, true);
open_menuTween3["onMotionFinished"] = function(){
var open_menuAlpha3:Tween = new Tween(_root.menu_tab_mc["menu"+3+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
var open_menuTween4:Tween = new Tween(_root.menu_tab_mc["menu"+4+"_mc"], "_y", Regular.easeIn,132.35,176.45,0.2, true);
open_menuTween4["onMotionFinished"] = function(){
var open_menuAlpha4:Tween = new Tween(_root.menu_tab_mc["menu"+4+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
var open_menuTween5:Tween = new Tween(_root.menu_tab_mc["menu"+5+"_mc"], "_y", Regular.easeIn,176.45,220.55,0.2, true);
open_menuTween5["onMotionFinished"] = function(){
var open_menuAlpha5:Tween = new Tween(_root.menu_tab_mc["menu"+5+"_mc"], "_alpha", Regular.easeIn, 0,100,0.2, true);
}   
}   

}   

}   
}               
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:48:27.457

改用[TweenMax 和 TimelineMax](http://www.greensock.com/v12/) - 它们允许排序、连接、反转动画等等

# asp.net - ASP.Net 应用程序的 IIS URL 问题

> ID：10729321
> 
> 赞同：0
> 
> 时间：2012-05-23T23:34:56.813
> 
> 标签：asp.net, iis-7

我的 aspx 上有一个超链接，可以让用户访问

```
http://something/leadoc/FnJavaView.aspx?Library=DefaultIMS:myserver:FileNet&Id=3611376&ObjType=2&Op=View 
```

我在另一个 Web 应用程序上有相同的链接，当用户单击该链接时，它显示如下所示

```
http://something/leadoc/FnJavaView.aspx?Library=DefaultIMS%3amyserver%3aFileNet&Id=3611376&ObjType=2&Op=View 
```

如果您注意到 ':' 被转换为 %3a

因为那个 URL 抛出了一个错误。

能否请你帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:44:24.060

假设错误是从您的 ASPX 使用链接时，您需要对URL 进行URL[编码](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)

```
string url = "http://something/leadoc/FnJavaView.aspx?Library={0}&Id={1}&ObjType={2}&Op={3}";
string library = Server.UrlEncode("Server.UrlEncode");
int id = 3611376;
int objType = 2;
string op = Server.UrlEncode("View");

url = string.Format(url, new object[]{library, id, objType, op}); 
```

任何动态字符串数据都应在查询字符串中进行 URL 编码。

# amazon-s3 - 具有相同 S3 帐户的不同权限的多个 access_keys？

> ID：10729322
> 
> 赞同：9
> 
> 时间：2012-05-23T23:35:00.343
> 
> 标签：amazon-s3

我有一个 S3/AWS 账户。我有几个网站，每个网站都在 S3 上使用自己的存储桶进行读/写存储。我还在 S3 上的其他存储桶上托管了很多个人资料（备份等），这些资料是不可公开访问的。

我不希望这些网站——其中一些可能让其他人访问他们的源代码和配置属性并查看 S3 密钥——访问我的私人数据！

从阅读亚马逊的文档看来，我需要按每个存储桶的 Amazon *USER*划分权限，而不是按每个存储桶的访问密钥。但这行不通。似乎我只得到 2 个访问密钥。我需要一个作为主密钥的访问密钥，以及其他几个具有更多限制权限的访问密钥——仅适用于某些存储桶。

有没有办法做到这一点，或近似的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T07:56:05.453

You can achieve your goal by facilitating [AWS Identity and Access Management (IAM)](http://aws.amazon.com/iam/):

> AWS Identity and Access Management (IAM) enables you to **securely control access to AWS services and resources** for your users. IAM enables you to create and manage users in AWS, and it also enables you to grant access to AWS resources for users managed outside of AWS in your corporate directory. **IAM offers greater security, flexibility, and control when using AWS.** *[emphasis mine]*

As emphasized, using IAM is strongly recommended for all things AWS anyway, i.e. ideally you should never use your main account credentials for anything but setting up IAM initially (as [mentioned by Judge Mental](https://stackoverflow.com/questions/10729322/multiple-access-keys-for-different-privileges-with-same-s3-account/10733367#comment13940830_10729322) already, you can *generate as many access keys as you want* like so).

You can use IAM just fine via the [AWS Management Console](http://aws.amazon.com/console/#iam) (i.e. their is no need for 3rd party tools to use all available functionality in principle).

Generating the required policies can be a bit tricky in times, but the [AWS Policy Generator](http://awspolicygen.s3.amazonaws.com/policygen.html) is extremely helpful to get you started and explore what's available.

For the use case at hand you'll need a *S3 Bucket Policy*, see [Using Bucket Policies](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingBucketPolicies.html) in particular and [Access Control](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingAuthAccess.html) for a general overview of the various available S3 access control mechanisms (which can interfere in subtle ways, see e.g. [Using ACLs and Bucket Policies Together](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingACLsandBucketPoliciesTogether.html)).

Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T16:41:13.943

只需创建一个自定义 IAM 组策略来限制对特定存储桶的访问

**如...**

```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["s3:ListAllMyBuckets"],
      "Resource": "arn:aws:s3:::*"
    },
    {
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource":
      [
        "arn:aws:s3:::my.bucket",
        "arn:aws:s3:::my.bucket/*"
      ]
    }
  ]
} 
```

第一个操作`s3:ListAllMyBuckets`允许用户列出所有存储桶。否则，当用户登录时，他们的 S3 客户端将不会在存储桶列表中显示任何内容。

第二个操作向名为“my.bucket”的存储桶的用户授予完整的 S3 权限。这意味着他们可以自由地在存储桶中创建/列出/删除存储桶资源和用户 ACL。

授予 s3:* 访问权限非常宽松。如果您想对存储桶进行更严格的控制，只需查找您要授予的相关操作并将它们添加为列表。

```
"Action": "s3:Lists3:GetObject, s3:PutObject, s3:DeleteObject" 
```

我建议您将此策略创建为一个组（例如 my.bucket_User），这样您就可以将其分配给需要访问此存储桶的每个用户，而无需任何不必要的复制粘贴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T06:54:10.413

是的，要使用同一个 AWS 账户访问具有不同权限的不同登录账户，您可以使用 AWS IAM。作为 Bucket Explorer 的开发人员，如果您正在寻找该工具为您提供具有不同登录和不同访问权限的 gui 界面，我建议尝试 Bucket Explorer-团队版。阅读[http://team20.bucketexplorer.com](http://team20.bucketexplorer.com)

# javascript - Jquery Fancybox 自动缩放没有按预期工作？

> ID：10729326
> 
> 赞同：1
> 
> 时间：2012-05-23T23:35:20.513
> 
> 标签：javascript, jquery, fancybox

所以在我的 Fancybox 中，我不想显示滚动条，而是使用 autoscale : true 选项。

所以我的设置发生的情况是没有显示滚动条，这很好，但是 div 的内容超出了幻想框的白色 div 并且 div 本身不会增长到内容的大小，而是保持其原始大小.

```
claimLink.fancybox({
        'scrolling' : 'no',
        'overlayShow' : false,
        'autoScale' : true,
        'transitionIn' : 'elastic',
        'transitionOut' : 'elastic',
        'hideOnContentClick' : false,
        'width': 500,
        'height': 590,
        'autoDimensions': false,
        'onCleanup': function (e) {

            var modelClaimFormId = $j(e).attr("href").replace("body", "");
            var modalClaimForm = $j(modelClaimFormId);

            if (!($j(modalClaimForm).valid())) {
                $j(claimForm).remove();
                $j(e).parents("tr").remove();
            }

        }.. 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:07:09.730

做`'autoScale' : true`的是使fancybox适合视口。这是它的预期用途。

如果您想要具有特定固定尺寸的fancybox，在这种情况下`'width': 500`，`'height': 590`然后设置`autoScale`为`false`.

另一方面`autoDimensions`用于从内容本身设置（获取）fancybox 的大小；这样的内容应该有尺寸（例如一个`<div>`with`width`和`height`），否则它会产生意想不到的结果......在这种情况下，您不需要设置任何一个`width`或`height`fancybox API 选项，但是`autoScale`应该设置为`false`在其显示内容全尺寸，否则fancybox将被缩放以适应视口并出现滚动条。

# jquery-mobile - jQuery Mobile 页脚浮动在屏幕中间？

> ID：10729329
> 
> 赞同：1
> 
> 时间：2012-05-23T23:35:45.007
> 
> 标签：jquery-mobile, footer

每当我放入一个简单的页脚栏时，它不会停靠在屏幕底部，而是浮动在屏幕中间的中间位置。我的代码尽可能简单：

```
 <body id="mainBody" onload="initialize()">      

      <div id="mainPage" data-role="page" data-theme="e">
        <div data-role="header">
             <!-- <img src="headerlogo.png" />-->
              <br />
              <p style="text-align:center">To begin searching for samples, select one of the search methods from the following table.</p>
        </div>

      <div data-role="content">
          <a data-role="button" data-theme="a" href="useMyLocation.html">Use My Location</a>
          <a data-role="button" data-theme="a" href="InputCoordinates.html">Input Coordinates</a>
          <a data-role="button" data-theme="a" href="selectRegion.html">Select Region</a>
      </div>

      <div data-role="footer">
          <h1>Hey guys!</h1>
      </div>

    </div>

  </body> 
```

这会产生一个漂亮的标题和三个漂亮的按钮链接，然后是屏幕中间的页脚！为什么它会出现在那里而不是附加到视口的底部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:41:14.937

试试这个

```
 <div data-role="footer" data-position="fixed">
      <h1>Hey guys!</h1>
  </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T10:26:15.753

从 开始`JQM 1.3`，您可以使用`data-position="fixed"`in`footer div`来实现此目的：

```
<div data-role="footer" class="ui-bar" data-position="fixed">
            <h4>I am a fixed footer!!</h4>
</div> 
```

但是，页脚似乎浮动在内容顶部（如全屏背景图像），而不是应用在图像底部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T16:14:32.940

虽然@stay_hungry 也有解决方案，但问题在于内容

```
<div data-role="content">
    <a data-role="button" data-theme="a" href="useMyLocation.html">Use My Location</a>
    <a data-role="button" data-theme="a" href="InputCoordinates.html">Input Coordinates</a>
    <a data-role="button" data-theme="a" href="selectRegion.html">Select Region</a>
</div> 
```

页脚在内容之后应用，并且默认情况下不固定到某个位置，因此如果您的内容没有填满屏幕，您的页脚将出现在屏幕中间的位置。

例子：

*   [http://jsfiddle.net/ZLMQk/](http://jsfiddle.net/ZLMQk/)

现在添加一些内容以将页脚向下推到页面：

*   [http://jsfiddle.net/ZLMQk/1/](http://jsfiddle.net/ZLMQk/1/)

还有更多内容：

*   [http://jsfiddle.net/ZLMQk/2/](http://jsfiddle.net/ZLMQk/2/)

使用固定位置：

*   [http://jquerymobile.com/demos/1.1.0/docs/toolbars/bars-fixed.html](http://jquerymobile.com/demos/1.1.0/docs/toolbars/bars-fixed.html)

或持久选项：

*   [http://jquerymobile.com/demos/1.1.0/docs/toolbars/footer-persist-a.html](http://jquerymobile.com/demos/1.1.0/docs/toolbars/footer-persist-a.html)

也是一个可能适合您的选项

# php - 如何使用 Amazon SDK for PHP 强制从 Amazon S3 下载文件？

> ID：10729331
> 
> 赞同：1
> 
> 时间：2012-05-23T23:36:05.940
> 
> 标签：php, google-chrome, pdf, amazon-s3, amazon-web-services

我有一个使用 Amazon S3 存储文件的应用程序。我遇到了一个问题，即没有使用 chrome 下载大型 PDF。较小的 PDF 效果很好，但较大的 PDF 将不起作用。我不认为这是 PDF 的问题，我怀疑它与文件的大小有关。

在浏览器中查看文件时，这是我正在使用的代码：

```
header("Content-type: $filetype");
header("Content-Disposition: filename=\"".$filename."\"");
$response = $s3->get_object(AMAZON_BUCKET, $filepath);   
echo $response->body; 
```

这对较小的文件很有用，但今天我遇到了一个问题，这个大 PDF 不会显示。我认为文件太大而无法呈现。因此，如果文件太大，我决定尝试强制下载文件而不是在浏览器中查看。所以这是我试图开始工作的代码，但我一定做错了什么，因为它不起作用。

```
 $response = $s3->get_object(AMAZON_BUCKET, $filepath, array(
      'response' => array(
        'content-type' => $filetype,
        'content-disposition' => 'attachment'
       )
    )); 
```

如何使用 Amazon SDK for PHP 强制下载**大**文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:52:21.583

您的方法的问题是您将整个文件从 S3 下载到网络服务器的内存，然后将其发送到用户的浏览器。如果文件很大，这可能会导致超过`memory_limit`甚至`max_execution_time`. （诚​​然，我不知道为什么您的案例是特定于 Chrome 的..）

一种更优雅的方法是重定向用户直接从 S3 下载文件。您甚至可以[将自定义标头设置](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectGET.html?r=8109)为您的请求的一部分，这样您就可以强制下载对话框。使用[`get_object_url()`](http://docs.amazonwebservices.com/AWSSDKforPHP/latest/#m=AmazonS3/get_object_url)而不是`get_object()`.

# c# - 如何在不打开 PDF 的情况下通过电子邮件发送 PDF

> ID：10729332
> 
> 赞同：0
> 
> 时间：2012-05-23T23:36:08.517
> 
> 标签：c#, smtp, pdf-generation, itextsharp

我有这个代码可以创建一个 PDF 文件，然后通过电子邮件发送它。但是，当我运行它时，它会打开并将我的整个页面更改为 PDF。如何停止页面以打开 PDF？

```
 PdfWriter.GetInstance(document, Response.OutputStream);
 Response.ContentType = "application/pdf";
 Response.Cache.SetCacheability(HttpCacheability.NoCache);
 HTMLWorker htmlparser = new HTMLWorker(document);
 MemoryStream memoryStream = new MemoryStream();
 PdfWriter writer = PdfWriter.GetInstance(document, memoryStream);

 document.Open();
 document.Add(mainTable);
 Response.Write(document);
 writer.CloseStream = false;
 document.Close();
 memoryStream.Position = 0;

 EmailPresenter.SkyMail asd = new EmailPresenter.SkyMail();
 asd.SendMail("test@test.com", "This is a test email...", memoryStream, "Test.pdf");
 Response.End(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:48:56.960

我不知道这个 PdfWriter 库。但我的建议是不要将 Response.OutputStream 提供给 PdfWriter。

只需删除前三行，响应流将保持不变。您可能还想使用 Response.End() 方法调用删除最后一行。

# php - 即使图像大小低于upload_max_filesize，文件上传也会返回错误

> ID：10729334
> 
> 赞同：0
> 
> 时间：2012-05-23T23:36:13.760
> 
> 标签：php

当我尝试上传超过 4mb 的图像时，$_FILES['upload']['error'] 返回 1 并且文件不会上传。但是在我的 php.ini 中，我将 upload_max_filesize 设置为 20mb ....

为什么我会收到错误消息？

这是检查错误的php代码

```
if ($_FILES['upload']['error']) {
   array_push($not_uploaded, $_FILES['upload']['name']);
   if ($_FILES['upload']['error'] == 1) {
     trigger_error('Iimage exceeded server php upload limit', E_USER_WARNING);
     array_push($error_msgs, elgg_echo('services:image_mem'));
   } else {
     array_push($error_msgs, elgg_echo('services:unk_error'));
          }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:48:16.703

您还应该检查 php.ini 文件中变量 post_max_size 的配置。

在 PHP 文档中：[常见的陷阱](http://pt.php.net/manual/en/features.file-upload.common-pitfalls.php)

> 如果 post_max_size 设置得太小，则无法上传大文件。确保将 post_max_size 设置得足够大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:29:40.643

正如[php 文档](http://www.php.net/manual/en/features.file-upload.post-method.php)`MAX_FILE_SIZE`所说，您需要在实际文件之前发送一个带有名称的（通常是隐藏的）字段。虽然理论上即使 4MB 没有它也不应该工作，但这可能是一些硬编码的默认值。

使用上述 PHP 文档页面的示例表单作为起点。

# cmake - 带有 SDL 的 CMake 导致错误

> ID：10729339
> 
> 赞同：2
> 
> 时间：2012-05-23T23:36:49.373
> 
> 标签：cmake, sdl

我一直在尝试将 CMake 与我在 SDL 中做的项目一起使用，但遇到了一些问题。我用于库等的 sdl 文件夹位于 C:\SDL\SDL-1.2.14。错误指出：

```
Could NOT find SDL (missing:  SDL_LIBRARY SDL_INCLUDE_DIR)  Could NOT find SDLIMAGE (missing:  SDLIMAGE_LIBRARY SDLIMAGE_INCLUDE_DIR)  CMake Error at C:/Program Files (x86)/CMake
2.8/share/cmake-2.8/Modules/FindPackageHandleStandardArgs.cmake:97 (MESSAGE):   Could NOT find SDL (missing: SDL_LIBRARY SDL_INCLUDE_DIR) Call Stack (most recent call first):   C:/Program Files (x86)/CMake
2.8/share/cmake-2.8/Modules/FindPackageHandleStandardArgs.cmake:288 (_FPHSA_FAILURE_MESSAGE)   C:/Program Files (x86)/CMake
2.8/share/cmake-2.8/Modules/FindSDL.cmake:172 (FIND_PACKAGE_HANDLE_STANDARD_ARGS)   CMakeLists.txt:10 (Find_Package) 
```

这是我的 CMakeLists.txt 文件。

```
Project(SDLExample)
Include(FindSDL)
Include(FindSDL_image)

set(
    SOURCES 
    example.cpp
)

Find_Package(SDL REQUIRED)
Find_Package(SDL_image REQUIRED)

if(NOT SDL_FOUND)
    message( FATAL ERROR "SDL not found!")
endif(NOT SDL_FOUND)

link_libraries(
    ${SDL_LIBRARY}
    ${SDLIMAGE_LIBRARY}
    SDLmain
)

add_executable(
    Example
    WIN32
    MACOSX_BUNDLE
    {$SOURCES}
) 
```

有任何想法吗？

编辑：我现在通过在 Windows GUI 中编辑 SDL 路径的字段来让它工作。问题当然是我找不到将它“反向移植”回 cmake 文件的方法，所以我每次都必须重新编辑它们，生成的 VS10 文件加载到 Visual Studio 中，但没有包含SDL 的路径等已正确加载到项目中，因此它不会编译说它不知道 SDL.h 在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-13T11:12:36.817

您不需要包含`Find<Lib>`文件。`find_package( <Lib> )`自动查找并使用这些文件。

如果您在 Windows 上，我认为您需要将**SDLDIR 环境变量**设置为 SDL`/lib`和文件夹所在的`/include`文件夹。

# javascript - 将文本从当前文档复制到新 window.open("otherdomainURL")

> ID：10729344
> 
> 赞同：0
> 
> 时间：2012-05-23T23:37:14.553
> 
> 标签：javascript, jquery, ruby-on-rails

我想从文档中获取给定文本并将其复制到弹出窗口（window.open），其中包含由服务器端后端（在本例中为 rails）生成的表单，此表单是从不同的当前文档的域，包含要复制的文本。此文本将显示在表单中（由用户查看），然后通过 POST 表单操作提交到服务器。

我最初想使用 document.write() 但这不可能，因为弹出页面将从不同的域加载。

由于字符的限制，在这种情况下查询字符串将无济于事。还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:49:33.470

大多数现代浏览器都支持[window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)，您可以在其中将信息传递到新窗口。

如果您使用的是旧版浏览器，最好的办法是向该域的页面发布一个包含内容的表单，该服务器将读取发布的数据并填写表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:42:50.150

您最好的选择可能是在弹出窗口中有一个脚本调用来自另一个屏幕的文本。而不是尝试将其传递给弹出窗口。

对主页使用 ajax 调用并获取文本字段的文本，并在获取时更新文本字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T11:36:47.170

我认为您应该使用零剪贴板导轨。请参阅[github 上的 zero-clipboard-rails](http://github.com/nragaz/zero-clipboard-rails "https://github.com/nragaz/zero-clipboard-rails")。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-23T23:51:42.937

如果您可以编辑在新窗口中加载的页面，那么您可以使用 JavaScript 执行此操作。在打开新窗口之前，将复制的文本设置为父窗口中的变量。

```
var copiedText = 'text to be copied';  //e.g. $('#some-textarea').val() 
```

然后加载新页面。在新页面中添加对“opener”窗口变量的调用，使用

```
opener.copiedText 
```

并使用它来填充表单元素。

# regex - 密码规则的正则表达式

> ID：10729347
> 
> 赞同：0
> 
> 时间：2012-05-23T23:37:55.630
> 
> 标签：regex

我对密码规则有要求。以下是规则。

密码必须遵循以下准则：

*   至少有八个字符长
*   包含这 4 个选项中的 3 个：小写字母、大写字母、数字或特殊字符
*   当用户指定的密码不符合上述规则时，返回消息说明：

    密码长度必须至少为 8 个字符，并且包含以下 4 个选项中的 3 个：

    *   小写字母 (az)
    *   大写字母 (AZ)
    *   数字 (0-9)
    *   特殊字符 (!@#$%^&')

请帮助我获得一个正则表达式来处理上述条件。

我感谢你所有的帮助。以下是我的要求的解决方案

```
if(password.matches("^(?=.*[0-9]).{1,}$")){
validCount++;
}
if(password.matches("^(?=.*[a-z]).{1,}$")){
validCount++;
}
if(password.matches("^(?=.*[A-Z]).{1,}$")){
validCount++;
}
if(password.matches("^(?=.*[@#$%^&+=]).{1,}$")){
validCount++;
}
return validCount >= 3 ? true : false; 
```

谢谢，拉姆基

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T23:43:33.343

这是，如果你想要一个优雅的正则表达式，尽可能接近

```
^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&'])[^ ]{8,}$ 
```

基本思想是使用一种称为“积极前瞻”的技术：

```
(?=.*PutHereWhatYouWantToAllow) 
```

使用正则表达式很难解决您的额外要求（四分之三），因为您基本上无法使它们计数。您可以写出上述正则表达式的必要排列（告诉我它是否没有意义），但这会使正则表达式很长。您可以做的是写出代码中的排列，以便正则表达式保持可维护性，因为您没有逐字重复这些模式。

如果我告诉我你的语言（C#？），我会试一试，因为这是一个很好的挑战。

**更新 1**

这是匹配至少 3 个要求（也允许 4 个）的正则表达式，只是为了应对它。不要在生产中使用它，而是在注释中提到的带有单个正则表达式的语言循环。

> ^((?=. *[az].* [AZ]. *[\d])|(?=.* [az]. *[\d].* [AZ])|(?=. *[AZ].* [az]. *[\d])|(?=.* [AZ]. *[\d].* [az])|(?=. *[\d].* [az]. *[AZ])|(?=.* [\d] . *[AZ].* [az])|(?=. *[az].* [AZ]. *[!@#$%^&'])|(?=.* [az]. *[!@#$%^& '].* [AZ])|(?=. *[AZ].* [az]. *[!@#$%^&'])|(?=.* [AZ]. *[!@#$%^&'] .* [az])|(?=. *[!@#$%^&'].* [az]. *[AZ])|(?=.* [!@#$%^&']. *[AZ].* [ az])|(?=. *[az].* [\d]. *[!@#$%^&'])|(?=.*[阿兹]。*[!@#$%^&']。*[\d])|(?=. *[\d].* [az]. *[!@#$%^&'])|(?=.* [\d]. *[!@#$%^&'] .* [az])|(?=. *[!@#$%^&'].* [az]. *[\d])|(?=.* [!@#$%^&']. *[\d] .* [az])|(?=. *[AZ].* [\d]. *[!@#$%^&'])|(?=.* [AZ]. *[!@#$%^&'].* [\d])|(?=. *[\d].* [AZ]. *[!@#$%^&'])|(?=.* [\d]. *[!@#$%^&'] .* [AZ])|(?=. *[!@#$%^&'].* [AZ]. *[\d])|(?=.* [!@#$%^&']. *[\d] .* [AZ]))[^]{8,}$

**更新 2**

这是采用java的方法

从我读到的评论中，您正在测试如下

*   小写 "^[az]*$";
*   大写 "^[AZ]*$";
*   数字="^[0-9]*$";

我不认为你在这里是在正确的轨道上。*如果所有*字符都是小写，而不仅仅是一个，小写只会报告成功。其余的也一样。

这些是 4 个单独的正则表达式，其中至少 3 个应该报告匹配

```
[a-z]
[A-Z]
\d
[!@#$%^&'] 
```

这是密码不应该包含空格的测试

```
^[^ ]*$ 
```

至少 8 个字符的测试

```
.{8,} 
```

所以我拆分需求而不是合并它们。这应该使代码更具可读性，特别是如果以正则表达式开头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T00:43:46.267

这是我的做法：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class ValidatePassword
{
    public static void main (String[] args)
    {
        String pw = "abaslkA3FLKJ";

        // create an array with 4 regex patterns

        Pattern [] patternArray = {
            Pattern.compile("[a-z]"),
            Pattern.compile("[A-Z]"),
            Pattern.compile("[0-9]"),
            Pattern.compile("[&%$#]")
        };

        int matchCount = 0;

        // iterate over the patterns looking for matches

        for (Pattern thisPattern : patternArray) {
            Matcher theMatcher = thisPattern.matcher(pw);        
            if (theMatcher.find()) {
                matchCount ++;
            }
        }

        if (matchCount >= 3) {
            System.out.println("Success");
        }

        else {
            System.out.println("Failure: only " + matchCount + " matches");
        }
    }
} 
```

我只在第 4 种模式中添加了一些*特殊字符*……您必须根据需要对其进行修改。您可能需要使用反斜杠转义某些字符。您可能还想添加其他约束，例如检查是否没有空格。我会把它留给你。

# rabbitmq - 如何重启 RabbitMQ 服务

> ID：10729348
> 
> 赞同：56
> 
> 时间：2012-05-23T23:38:14.507
> 
> 标签：rabbitmq, windows-services

我在重新启动rabbitmq 服务时遇到一个奇怪的错误，因此我无法重新启动RabbitMQ 服务。我从 EventViewer 收到了这条消息，并试图通过谷歌搜索找到解决方案，但没有运气......请建议。

> RabbitMQ：Erlang 机器自动停止。由于 OnFail 设置为忽略，服务不会重新启动。

谢谢

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-05-24T17:31:44.367

在现代 Linux 上，您可以像任何其他服务一样重新启动它

```
sudo service rabbitmq-server restart 
```

还有一个特定的控制界面

```
sudo rabbitmqctl "report"
sudo rabbitmqctl "reset" 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2018-04-18T11:55:32.173

根据[RabbitMQ CLI 文档](https://www.rabbitmq.com/rabbitmqctl.8.html "RabbitMQ CLI 文档")的文档，您可以执行以下操作：

```
rabbitmqctl stop
rabbitmqctl start_app 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-05-01T11:03:13.810

如果您重新安装 RabbitMQ 并在将其作为 Windows 服务运行时遇到问题，解决方法可能如下：

在 cmd.exe 中，从 rabbit sbin 文件夹运行：

```
rabbitmq-service.bat remove
rabbitmq-service.bat install
net start rabbitmq 
```

它在 Windows 7 上对我有用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-08-23T07:37:31.880

由于没有一个答案真正回答了这个问题，因此在命令提示符下，键入：

```
net stop rabbitmq
net start rabbitmq 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-11-25T15:34:19.627

在您安装的服务器中首先运行停止命令

```
C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.8\sbin>rabbitmqctl.bat stop 
```

然后启动命令：

```
C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.8\sbin>rabbitmqctl.bat start_app 
```

或通过 GUI windows 服务：右键单击，然后单击重新启动：

[![在此处输入图像描述](../Images/352c38abe0c54ca0f84591acab52e1aa.png)](https://i.stack.imgur.com/qJNZe.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-08-29T11:16:40.333

在我的情况下，通过直接电话帮助开始

```
sudo  /usr/lib/rabbitmq/bin/rabbitmq-server 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-23T07:37:51.380

如果您使用的是 windows 机器并且机器中安装了 RabitMQ，则进入**C:\Program Files\RabbitMQ Server\rabbitmq_server-\sbin>**

并运行以下命令

```
rabbitmqctl stop_app
rabbitmqctl force_reset
rabbitmqctl start_app 
```

它看起来像这样

```
C:\Program Files\RabbitMQ Server\rabbitmq_server-3.9.5\sbin>rabbitmqctl stop_app
Stopping rabbit application on node rabbit@DESKTOP-MQS...

C:\Program Files\RabbitMQ Server\rabbitmq_server-3.9.5\sbin>rabbitmqctl force_reset
Forcefully resetting node rabbit@DESKTOP-MQS...

C:\Program Files\RabbitMQ Server\rabbitmq_server-3.9.5\sbin>rabbitmqctl start_app
Starting node rabbit@DESKTOP-MQS...

C:\Program Files\RabbitMQ Server\rabbitmq_server-3.9.5\sbin> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-09T22:26:11.167

首先转到`C:\Program Files\RabbitMQ Server\rabbitmq_server-3.6.6\sbin`然后运行命令提示符`administrator`并运行`rabbitmq-server restart`

确保转到正确的目录。

# ios - 将 xmlDocPtr 对象传递给选择器

> ID：10729351
> 
> 赞同：0
> 
> 时间：2012-05-23T23:38:36.843
> 
> 标签：ios, selector, libxml2

由于某些 NDA 功能，我不知道我可以对我正在创建的应用程序说多少，即使它可能不是新的我仍然想拯救自己，但我想知道是否有办法通过xmlDocPtr 通过选择器？如果是这样，这怎么可能？我知道我可以获取 char* 并将其转换为 NSString，但是 xmlDocPtr 是否具有相同的转换为 id 类型的能力？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:11:41.290

您是什么意思“通过选择器传递 xmlDocPtr”？鉴于您似乎正在尝试将其转换为 obj-c 对象，我假设您正在尝试使用`-performSelector:withObject:`? 因为如果您只是调用该方法，则对参数类型没有限制。

如果您需要动态调用采用非 obj-c 对象的选择器，您有两种选择。第一种也是推荐的方法是创建一个[`NSInvocation`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSInvocation_Class/).

```
SEL sel = // selector that takes xmlDocPtr
NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:[target methodSignatureForSelector:sel]];
[invocation setSelector:sel];
[invocation setArgument:&xmlDocPtr atIndex:2]; // 0 is self, 1 is _cmd
[invocation invokeWithTarget:target];
// if you need a return value, use
// typeOfReturnValue retVal;
// [invocation getReturnValue:&retVal]; 
```

第二个是转换`objc_msgSend()`为适当的函数类型并调用它，尽管如果涉及浮点值或结构值（作为方法参数或返回值），这会变得更加复杂（并且有点依赖于体系结构）。仅当您习惯使用 obj-c 运行时时，才应该采用这种方法。

# android - Framebuffer FBO渲染到纹理很慢，在Android上使用OpenGL ES 2.0，为什么？

> ID：10729352
> 
> 赞同：6
> 
> 时间：2012-05-23T23:38:53.477
> 
> 标签：android, 2d, opengl-es-2.0, framebuffer, render-to-texture

我正在使用 opengl es 2.0 编写 Android 2d 游戏。在我将精灵绘制到后台缓冲区后，我将灯光绘制到 FBO 并尝试再次将其混合到后台缓冲区。当我将 FBO 绘制到帧缓冲区时，即使是没有任何颜色的透明，三星 Galaxy w 上的帧速率也会从 60 下降到 30（它有一个 adreno 205 作为 gpu）。我到处搜索并尝试了所有方法，即使我在场景中绘制了一个精灵并将一个透明的 FBO 纹理混合到帧速率下降的屏幕上。我在该手机上尝试了其他带有灯光效果的游戏，它们运行良好，几乎所有游戏在该手机上都很好，我相信他们也使用了帧缓冲区。在 Galaxy SII（mali 400 gpu）上运行良好，我对 opengl 很陌生，所以我相信我在某个地方犯了错误，我分享了我的代码。

```
// Create a framebuffer and renderbuffer
GLES20.glGenFramebuffers(1, fb, offset);
GLES20.glGenRenderbuffers(1, depthRb, offset);

// Create a texture to hold the frame buffer
GLES20.glGenTextures(1, renderTex, offset);
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, renderTex[offset]);

GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA,
                    screenWidth, screenHeight, 0,
                    GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE,
                    null);

GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S,
                       GLES20.GL_CLAMP_TO_EDGE);
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T,
                       GLES20.GL_CLAMP_TO_EDGE);
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER,
                       GLES20.GL_LINEAR);
GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER,
                       GLES20.GL_LINEAR);

//bind renderbuffer
GLES20.glBindRenderbuffer(GLES20.GL_RENDERBUFFER, depthRb[offset]);

GLES20.glRenderbufferStorage(GLES20.GL_RENDERBUFFER, GLES20.GL_DEPTH_COMPONENT16,
                             screenWidth, screenHeight);

// bind the framebuffer
GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, fb[offset]);

// specify texture as color attachment
GLES20.glFramebufferTexture2D(GLES20.GL_FRAMEBUFFER, GLES20.GL_COLOR_ATTACHMENT0,
                              GLES20.GL_TEXTURE_2D, renderTex[offset], 0);

// specify depth_renderbufer as depth attachment
GLES20.glFramebufferRenderbuffer(GLES20.GL_FRAMEBUFFER, GLES20.GL_DEPTH_ATTACHMENT,
                                 GLES20.GL_RENDERBUFFER, depthRb[0]);

// Check FBO status.
int status = GLES20.glCheckFramebufferStatus(GLES20.GL_FRAMEBUFFER);

if ( status == GLES20.GL_FRAMEBUFFER_COMPLETE )
{
    Log.d("GLGame framebuffer creation", "Framebuffer complete");
}

// set default framebuffer
GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, 0); 
```

我在表面创建时这样做过一次。不确定是否正确。我保留纹理和帧缓冲区 ID，以便在需要时切换到它们。我的绘图代码：

```
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureId);
ShaderProgram program = glgame.getProgram();

//put vertices in the floatbuffer
mTriangleVertices.put(vertices, 0, len);
mTriangleVertices.flip();

GLES20.glVertexAttribPointer(program.POSITION_LOCATION, 2, GLES20.GL_FLOAT, false,
                             TRIANGLE_VERTICES_DATA_STRIDE_BYTES, mTriangleVertices);

//preparing parameter for texture position
mTriangleVertices.position(TRIANGLE_VERTICES_DATA_UV_OFFSET);
GLES20.glEnableVertexAttribArray(program.POSITION_LOCATION);

//preparing parameter for texture coords
GLES20.glVertexAttribPointer(program.TEXTURECOORD_LOCATION, 2, GLES20.GL_FLOAT,
                             false, TRIANGLE_VERTICES_DATA_STRIDE_BYTES,
                             mTriangleVertices);

//set projection matrix
GLES20.glEnableVertexAttribArray(program.TEXTURECOORD_LOCATION);
GLES20.glUniformMatrix4fv(program.MATRIX_LOCATION, 1, false, matrix, 0);

//draw triangle with indices to form a rectangle
GLES20.glDrawElements(GLES20.GL_TRIANGLES, numSprites * 6, GLES20.GL_UNSIGNED_SHORT,
                      indicesbuf);

//clear buffers
mTriangleVertices.clear();
mVertexColors.clear(); 
```

一切都在屏幕上正确渲染，但是当我绘制 FBO 纹理时性能就被破坏了。非常感谢您的帮助。我为此非常努力，但没有找到解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-15T14:13:41.783

根据 qualcomm docs，您需要在每个 glbindframebuffer 之后进行 glclear，这是与平铺架构相关的问题，如果您正在切换帧缓冲区，则需要将数据从 fastmem 复制到普通内存以保存当前帧缓冲区，并从 slowmem 复制到 fast mem 以获得新绑定帧的内容，以防您在 glbind 之后清除没有数据从 slowmem 复制到 fastmem 并且您可以节省时间，但是您需要经常重新设计渲染管道，这样可以避免在慢速和慢速之间来回读取数据快速内存，因此在每次绑定后尝试执行 glclear 应该会有所帮助，您还可以使用 adreno 分析器来获取有关有问题的调用的其他信息，但我怀疑它对 adreno200 有帮助我正在尝试获取两个用于模糊的缓冲区，我是以10fps结束，如果未清除 bindframebuffer 调用最多可能需要 20 毫秒，如果已清除，则应在 2 毫秒结束。

# python - 将 HTML 表单输入发送到 python 脚本

> ID：10729356
> 
> 赞同：1
> 
> 时间：2012-05-23T23:39:04.533
> 
> 标签：python, html, get, web2py

我正在尝试将 HTML 表单输入从页面发送到 python 脚本。这仅用于测试目的，因此请忽略糟糕的代码。基本上我不知道如何定义`action=`部分来引用`search()`python脚本中的函数。我只需要让基本功能正常工作。我使用 web2py 作为可能相关的框架：

控制器：default.py

```
def index():
    return dict()

def search():
    import urllib
    q=request.vars.q
    result1 = urllib.urlopen('http://www.google.com/search?q=%s' % q)
    return dict(result1=result1) 
```

默认/search.html：

```
{{extend 'layout.html'}}
<form method=get action=???>
<input name=q>
<input type=submit value=search>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:59:45.320

看起来表单本身是通过 search() 函数提供的，因此您只需设置`action=""`，它将提交回 search() 函数。此外，您应该在 HTML 属性值周围加上引号，并且应该添加一些逻辑来检查 request.vars.q 中是否有任何内容，因为当页面第一次加载空表单时，没有要处理的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:00:06.227

你在那里做的事情对`GET`请求是正确的。对于`POST`请求，您需要将字段作为数据参数传递。

```
urllib.urlopen('http://www.google.com/search', data=urllib.urlencode({'q':'FOO'})) 
```

例如，将搜索作为`POST`请求进行。

请参阅[此处](http://docs.python.org/library/urllib2.html)了解更多信息。

# php - “方形调整”图像的功能不适用于 PNG

> ID：10729359
> 
> 赞同：0
> 
> 时间：2012-05-23T23:39:20.433
> 
> 标签：php, gd

嗨，我已经使这个功能真正适用于 jpg，但不适用于 png

这是我的代码：

```
function vignette_carre($src, $dest, $largeur, $src_x, $src_y){ 

   $ext = explode(".", $src);
    $ext = strtolower(end($ext));

       if ($ext == 'jpg' or $ext == 'jpeg') {$im_src=imagecreatefromjpeg($src);} 
    elseif ($ext == 'gif') { $im_src=imagecreatefromgif($src);} 
    elseif ($ext == 'png') {$im_src=imagecreatefrompng($src);}

    if ($im_src=="") return; 
    if($src_x >= $src_y){ 
        $dim=$src_y; $verticale="1"; 
    }
    elseif($src_x <= $src_y){
        $dim=$src_x; $horizontale="1"; 
    }
    else{ 
        $dim=$src_x; 
    }
    if($verticale == "1"){
        $point_x_ref=($src_x/2)-($dim/2); 
        $point_y_ref="0";
    }
    if($horizontale == "1"){
        $point_x_ref="0";
        $point_y_ref=($src_y/2)-($dim/2);
    }
    $im_dest=imagecreatetruecolor($largeur, $largeur);  
    $im_dest= imagecolorallocate($im_dest, 255, 255, 255);  
    imagecopyresampled($im_dest, $im_src, 0, 0, $point_x_ref, $point_y_ref, $largeur, $largeur, $dim, $dim); 
    imagedestroy($im_src); 
           if ($ext == 'jpg' or $ext == 'jpeg') {
    imagejpeg($im_dest, $dest); 
        imagedestroy($im_dest); 
       } 
       elseif ($ext == 'gif') {
    imagegif($im_dest, $dest);
        imagedestroy($im_dest); 
          }
        elseif ($ext == 'png') {

                imagepng($im_dest, $dest);
        imagedestroy($im_dest); 
          } 
} 
```

我在我的错误控制台中得到了这种错误：

[2] imagecolorallocate()：提供的参数不是有效的图像资源 [2] imagecolortransparent()：提供的参数不是有效的图像资源

有什么想法可以解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:44:41.563

您将新创建的**$im_dest**作为参数在**imagecolorallocate**中，然后再次将**INT**返回到**$im_dest 中**？这是错误的。

# android - 反向地理编码问题

> ID：10729368
> 
> 赞同：1
> 
> 时间：2012-05-23T23:40:29.133
> 
> 标签：android, reverse-geocoding

我在我的应用程序中实现了反向地理编码并且它正在工作，但有时它会发生一个非常奇怪的问题。

代码是这样的

```
 List<Address> addresses = geo.getFromLocation(
                    obj.getLatitude(), obj.getLongitude(), 1);

            List<Address> address = geo.getFromLocationName( addresses.get(0).getLocality().getBytes() , 1 );

            Address location = address.get(0); 
```

在第一部分中，我得到了我所在位置的地址对象。我想恢复我所在城市的通用坐标，因为我不想存储我的确切位置的坐标。

这是有效的，但我遇到了一个非常奇怪的问题！使用 fakegps 应用程序尝试该应用程序，我将我的位置设置在“Ñuñoa”，并且正确找到了第一个地址，但是当我尝试获取通用坐标时，我得到的“Nunoa”不在智利，而是在秘鲁！ ！这是没有意义的！为什么这个？

谢谢你帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T14:49:48.380

当然是斯瓦蒂。

```
List<Address> addresses = geo.getFromLocation(msg_r.getLatitude(),
                msg_r.getLongitude(), 1);
        String geoL = addresses.get(0).getLocality() + ", " + addresses.get(0).getAdminArea() + ", " + addresses.get(0).getCountryCode();

                // reverse-reverseGeocoding
                List<Address> address = geo.getFromLocationName(geoL, 1);

                System.out.println("Where I am? " + geoL);
                Address location = address.get(0);

                // generic coordinate for the locality/city/town
                location.getLatitude();
                location.getLongitude(); 
```

# javascript - 使用 Phonegap/WebWorks 的黑莓中线程过多

> ID：10729370
> 
> 赞同：11
> 
> 时间：2012-05-23T23:40:55.003
> 
> 标签：javascript, multithreading, blackberry, cordova, blackberry-webworks

我正在使用[Cordova/PhoneGap](http://phonegap.com/)开发一个黑莓应用程序。我正在从服务器获取几个图像（地图图块）。此外，我每 60 秒向它发送一次位置信息。

但是，时不时地，当我获取图像或发送信息时，我会收到错误消息。如果我在模拟器上（BB 9930，OS 7.0.0.318），我会收到一条`AppError 104: Too many threads`消息并且我的应用程序崩溃。当我在设备（BB 8520，OS 5.0.0.592）上测试我的应用程序时，不仅应用程序崩溃，而且使 BB 重置。

我看过其他有同样问题的帖子（比如[这个](https://stackoverflow.com/questions/1410990/too-many-threads-exception)、[这个](https://stackoverflow.com/questions/7876499/too-many-threads-exception-while-using-custom-list-field-in-blackberry)或[这个](https://stackoverflow.com/questions/3394560/too-many-threads-error-exception)）。但是，在使用 Cordova/PhoneGap (JavaScript) 构建应用程序时，我还没有找到解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T19:21:28.063

我怀疑 phoneGap API 是否会导致这种情况，因为它基本上是一个层。可能你的模拟器有问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-04T16:34:09.973

由于您还在 Blackberry 8520 上进行测试，因此建议您在应用程序的任何时间点保持 MAX 线程数 - 同时运行 -**小于 12**

由于您使用的是 Phonegap，因此它可能正在为您的应用程序启动这些线程。

如果设备已连接到您的系统，请将其连接到 Blackberry JDE 并查看哪些线程处于活动状态以分析您是否可以重新安排任务。

您是否使用 AJAX 来获取地图图块并将位置发送到您的服务器？

如果您使用的是 AJAX，那么您可以在 JavaScript 中保留一个计数器来检查请求。

此外，您是否尝试过**WebWorkers**，它们将使您能够在单个线程本身内完成所有这些工作。

如果一切都失败了，您还可以开发自定义 Phonegap 插件以使用 Java Script 接口 API 执行类似的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T23:07:25.107

这可能不相关，但是当我在 BB Bold 上从本机应用程序发出大量请求时，我确实遇到了类似的问题。收到回复后连接线程没有正常关闭。

尝试以下操作：

*   更改 GET <-> POST。
*   更改 HTTP <-> HTTPS。

如果服务器是您的，请评估更改 API 以将所有图像作为一个返回，并在显示它们时使用偏移/剪辑。您将节省带宽并打开更少的连接。您的应用会加载得更快。

例如： [http ://www.ibloomstudios.com/articles/misunderstood_css_clip/](http://www.ibloomstudios.com/articles/misunderstood_css_clip/)

# actionscript-3 - 带页脚的 DataGrid

> ID：10729376
> 
> 赞同：-1
> 
> 时间：2012-05-23T23:41:26.200
> 
> 标签：actionscript-3, apache-flex, flash-builder, mxml

我搜索了一个使用页脚创建 DataGrid 的解决方案，我发现一些想法可以使用高级 DataGrid 来做到这一点，但它看起来非常困难。

那么您知道 DataGrid 上的页脚的简单解决方案吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-02T20:45:43.243

我昨天在我自己的 dataGrid 页脚问题中遇到了这个问题。从那以后我设法解决了它，并且由于没有答案（我知道这是一个老问题），并且有人可能仍然需要解决方案，所以我会在这里发布。

最终结果应该是这样的：http: [//prntscr.com/5cka32](http://prntscr.com/5cka32)

开始吧：

首先要提供页脚支持，我们需要创建一个扩展 UIComponent 的**DataGridFooterBase**类。添加两个属于 mx_internal 命名空间的属性（visibleColumns:Array 和 footerItemsChanged:Boolean）（我决定只有系统需要能够看到它们）。

```
public class DataGridFooterBase extends UIComponent
{
    mx_internal var visibleColumns:Array;
    mx_internal var footerItemsChanged:Boolean;

    public function DataGridFooterBase()
    {
        super();
    }
} 
```

接下来，我们将创建实际的**DataGridFooter**类，它将扩展**DataGridFooterBase**类。基本上，此类将接收一个*ICollection* dataProvider，其中的对象将显示在页脚中。想象一下这种情况，您有一个网格，其中存在有关发票的信息。您需要在金额*价格列下方显示所有发票的总和。但是，发票可以有不同的货币（欧元和美元），您需要按货币显示总和。这就是为什么我们有一个*ICollection*类型的 dataProvider，它将表示行和列。

```
public class DataGridFooter extends DataGridFooterBase
{
    protected var dataGrid:Grid;
    protected var footerItems:Array=[];
    protected var cachedFooterHeight:Number=0;
    protected var cachedPaddingBottom:Number=0;
    protected var cachedPaddingTop:Number=0;

    private var _dataProvider:Object;

    public var leftOffset:Number=0;
    public var topOffset:Number=0;
    public var rightOffset:Number=0;
    public var bottomOffset:Number=0;

    public function DataGridFooter()
    {
        super();
    }

    public function set dataProvider(value:Object):void
    {
        if (value != null && !(value is ArrayCollection))
            value=new ArrayCollection([value]);
        _dataProvider=value;
        footerItemsChanged=true;
    }

    public function get dataProvider():Object
    {
        return _dataProvider;
    }

    override protected function createChildren():void
    {
        dataGrid=parent as Grid;
    }
} 
```

这是一个基本设置。接下来我们需要实现**measure()**和**updateDisplayList()**方法。他们将确保一切都干净整洁。所以让我们重写这两种方法：

```
override protected function measure():void
{
    super.measure();
    cachedFooterHeight=dataGrid._explicitFooterHeight ? dataGrid.footerHeight : 22;
    cachedPaddingBottom=getStyle("paddingBottom");
    cachedPaddingTop=getStyle("paddingTop");
    measuredHeight=cachedFooterHeight;
}

override protected function updateDisplayList(w:Number, h:Number):void
{
    graphics.clear();
    graphics.beginFill(0xCFCFCF);
    graphics.drawRect(0, 0, unscaledWidth, unscaledHeight);
    graphics.endFill();
    graphics.lineStyle(1, 0x696969);
    graphics.moveTo(0, 0);
    graphics.lineTo(unscaledWidth, 0);
    graphics.endFill();
    updateFooterItemsLayout();
} 
```

如果您想知道**graphics**是什么，我用它来为 Footer 着色，使其与 dataGrid 行不同。之后，我们需要重写**commitProperties()**方法，在该方法中我们检查 dataProvider 是否已更改。如果是，我们需要在更新显示列表之前重新绘制所有的页脚元素（否则会出现性能问题）

```
override protected function commitProperties():void
{
    super.commitProperties();
    if (footerItemsChanged)
    {
        footerItemsChanged=false;
        clearListItems();
        var cols:Array=visibleColumns;
        if ((cols && cols.length > 0 || dataGrid.footerVisible))
        {
            if (_dataProvider != null)
            {
                for (var j:int=0; j < _dataProvider.length; j++)
                {
                    addListItems(j, dataProvider.getItemAt(j));
                }
            }
            else
            {
                addListItems(0, null);
            }
        }
    }
} 
```

让我们继续，到目前为止一切都是准备工作，现在我们需要将*IListItemRenderer*对象添加和删除到我们的新**Footer**的实际方法。所以让我们创建 2 个方法，**addListItems()**和**removeListItems()**

```
private function addListItems(row:int=0, data:Object=null):void
{
    if (footerItems == null)
        return;
    var cols:Array=visibleColumns;
    footerItems[row]=[];
    var rowData:DataGridListData;
    var item:IListItemRenderer;
    var colNum:int=0;
    var column:GridColumn;
    while (cols && colNum < cols.length)
    {
        column=cols[colNum];
        item=ObjectUtil.copy(column.cachedFooterRenderer) as IListItemRenderer;
        if (item == null)
        {
            item=new DataGridItemRenderer();
            item.styleName=column;
            column.cachedFooterRenderer=item;
        }
        var label:String="";
        if (data != null)
        {
            if (column.labelFunction == null)
                label=String(AbcUtils.findValueInObject(data, column.dataField.split(".")));
            else
                label=String(column.labelFunction(data, column));
            if (label == null || label == "null" || label == "NaN")
                label="";
        }
        rowData=new DataGridListData(label, column.dataField, colNum, uid, dataGrid, 0);
        if (item is IDropInListItemRenderer)
            IDropInListItemRenderer(item).listData=rowData;
        item.data=column;
        item.visible=true;
        addChild(DisplayObject(item));
        footerItems[row][colNum]=item;
        colNum++;
    }
}

private function clearListItems():void
{
    if (footerItems == null)
        return;
    for (var rows:int=0; rows < footerItems.length; rows++)
    {
        var cols:Array=footerItems[rows];
        for (var i:int=0; i < cols.length; i++)
        {
            removeChild(DisplayObject(cols[i]));
        }
    }
    footerItems.splice(0, footerItems.length);
} 
```

这两种方法的基本作用是，它们获取所有可见列并为 dataProvider 集合（footerItems[row][column]）中的每个项目创建一个**DataGridItemRenderer**，并将它们添加到我们的 Footer 类的显示列表中，或者删除它们。我们在此类中需要的最后一个方法将确保所有项目都根据它们“所属”的列正确定位。

```
private function updateFooterItemsLayout():void
{
    if (_dataProvider == null || footerItems == null || footerItems.length == 0)
        return;
    for (var row:int=0; row < _dataProvider.length; row++)
    {
        var cols:Array=visibleColumns;
        var item:IListItemRenderer;
        var colNum:int=0;
        var ww:Number=0;
        var xx:Number=0;
        var column:GridColumn;
        while (cols && colNum < cols.length)
        {
            column=cols[colNum];
            item=footerItems[row][colNum];
            item.explicitWidth=ww=column.width;
            UIComponentGlobals.layoutManager.validateClient(item, true);
            item.setActualSize(ww, item.getExplicitOrMeasuredHeight());
            if (row == 0)
                item.move(xx, cachedPaddingTop);
            else
                item.move(xx, item.height * row + cachedPaddingTop);
            xx+=ww;
            colNum++;
        }
    }
} 
```

基本上就是这样。现在我们需要调整我们的 DataGrid 和 DataGridColumn 类来连接我们的新 Footer 类。

* * *

所以让我们继续**DataGrid**类。我们需要创建一个新的 Grid 类来扩展 DataGrid 类。

```
public class Grid extends DataGrid
{
    public function Grid()
    {
        super();
    }

    //==== footer specific stuff =======
    protected var footer:DataGridFooterBase;
    mx_internal var footerClass:Class=DataGridFooter;
    private var _enableFooter:Boolean;
    private var _footerHeight:int=22;
    mx_internal var _explicitFooterHeight:Boolean;

    mx_internal function get dataGridFooter():DataGridFooterBase
    {
        return footer;
    }

    [Bindable("enableFootersChanged")]
    [Inspectable(category="General", defaultValue="false")]
    public function get enableFooters():Boolean
    {
        return _enableFooter;
    }

    public function set enableFooters(value:Boolean):void
    {
        if (value == _enableFooter)
            return;
        _enableFooter=enabled;
        invalidateDisplayList();
        dispatchEvent(new Event("enableFootersChanged"));
    }

    mx_internal function get footerVisible():Boolean
    {
        return enableFooters && (footerHeight > 0) && footer != null;
    }

    [Bindable("resize")]
    [Inspectable(category="General", defaultValue="22")]
    public function get footerHeight():Number
    {
        return _footerHeight;
    }

    public function set footerHeight(value:Number):void
    {
        _footerHeight=value;
        _explicitFooterHeight=true;
        invalidateDisplayList();
    }

    public function setFooterValues(value:Object):void
    {
        if (footer != null)
            DataGridFooter(footer).dataProvider=value;
    }
    //==========================================

    override protected function createChildren():void
    {
        super.createChildren();
        if (enableFooters && footer == null)
        {
            footer=new footerClass();
            addChild(footer);
        }
    }

    override public function invalidateDisplayList():void
    {
        super.invalidateDisplayList();
        if (footer != null)
        {
            footer.invalidateSize();
            footer.invalidateDisplayList();
        }
    }

    override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);
        if (footer != null)
        {
            footer.visibleColumns=visibleColumns;
            footer.invalidateSize();
            footer.validateNow();
        }
        if (footerVisible && verticalScrollBar && verticalScrollBar.visible)
        {
            var maxHeight:Number=this.verticalScrollBar.height - this.footer.height;
            verticalScrollBar.setActualSize(verticalScrollBar.width, maxHeight);
        }
    }

    override protected function adjustListContent(unscaledWidth:Number=-1, unscaledHeight:Number=-1):void
    {
        super.adjustListContent(unscaledWidth, unscaledHeight);
        var refY:Number=header.height;
        var additionalReservedHeight:Number=0;
        additionalReservedHeight+=footerVisible ? footerHeight : 0;
        listContent.setActualSize(listContent.width, listContent.height - additionalReservedHeight);
        refY+=listContent.height;
        if (footerVisible)
        {
            footer.move(listContent.x, refY);
            footer.setActualSize(listContent.width, footerHeight);
            refY+=footer.height;
        }
    }

    override protected function measure():void
    {
        super.measure();
        var additionalReservedHeight:Number=0;
        if (enableFooters)
            additionalReservedHeight+=footerHeight;
        this.measuredHeight=header.getExplicitOrMeasuredHeight() + additionalReservedHeight + (rowHeight * rowCount) + viewMetrics.bottom + viewMetrics.top;
        this.measuredMinHeight=header.getExplicitOrMeasuredHeight() + additionalReservedHeight + (rowHeight * rowCount) + viewMetrics.bottom + viewMetrics.top;
    }
} 
```

我相信这门课或多或少是不言自明的。要将值设置为页脚，您需要使用**setFooterValues()**函数，您可以使用单个对象或对象的*ICollection*。您需要做的另一件事是，如果您希望页脚中有多行，则需要显式设置**footerHeight**属性（或修改Footer 类中的**measure()**方法以根据集合中的项目数自动缩放）。

我们需要做的最后一件事是修改**DataGridColumn类，为***IListItemRenderer*添加一个存储。这里是：

```
public class GridColumn extends DataGridColumn
{
    mx_internal var cachedFooterRenderer:IListItemRenderer;

    public function GridColumn(columnName:String=null)
    {
        super(columnName);
    }
} 
```

就是这样。希望这对某人有所帮助，并且不是 TL；DR；:) 干杯。

# oauth - 获取 twitter 提要并绕过请求限制的最简单方法是什么？

> ID：10729377
> 
> 赞同：0
> 
> 时间：2012-05-23T23:41:31.670
> 
> 标签：oauth, twitter, twitter-oauth

我已经阅读了几个小时关于编写一个查询 twitter API 并使用 OAuth 进行身份验证的应用程序的阅读，但是对于我手头的简单任务来说，它们似乎都太复杂了：

我有几个客户网站，都在主页上显示他们的 twitter 提要，都在同一台服务器上运行。我通过使用他们推文的 RSS 提要并输出他们最新的推文来做到这一点，格式为 HTML。

问题是，随着我获得更多客户，我最终会在接近一小时结束时达到请求限制。

如果我改为为每个客户执行 oauth 身份验证 API 请求，那将使我绕过速率限制，但这似乎有点矫枉过正。我必须让每个客户给我一个 oauth 密钥，只是为了在他们的网站上显示他们的推文？他们甚至可以给我一把永恒的钥匙吗？

我在互联网上看到的所有 oauth 示例都是针对整天执行 oauth 请求的应用程序，将发布到人们的 Twitter 提要的应用程序等。我的需求要简单得多，我希望有人有一个简单的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:38:14.913

最简单的方法是使用预先构建的[Twitter 小部件。](https://twitter.com/about/resources/widgets)

您不需要使用 OAuth - 没有速率限制。

基本代码看起来像

```
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 250,
  height: 300,
  theme: {
    shell: {
      background: '#333333',
      color: '#ffffff'
    },
    tweets: {
      background: '#000000',
      color: '#ffffff',
      links: '#4aed05'
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: false,
    behavior: 'all'
  }
}).render().setUser('edent').start();
</script> 
```

您可以创建和自定义一个小部件，该小部件[直接从 Twitter 网站](https://twitter.com/about/resources/widgets/widget_profile)显示用户的所有推文。

# puppet - 傀儡代理找不到服务器

> ID：10729379
> 
> 赞同：24
> 
> 时间：2012-05-23T23:41:37.263
> 
> 标签：puppet

我是木偶的新手，但很快就学会了。今天，我在尝试运行以下命令时遇到了问题：

```
$ puppet agent --no-daemonize --verbose --onetime

**err: Could not request certificate: getaddrinfo: Name or service not known
Exiting; failed to retrieve certificate and waitforcert is disabled** 
```

代理似乎不知道要连接到哪个服务器。我可以只`--server`在命令行上指定，但是当它在生产中作为守护进程运行时对我没有用，因此，我在 /etc/puppet/puppet.conf 中指定服务器名称，如下所示：

```
[main]
    server = puppet.<my domain> 
```

我*确实*有一个 DNS 条目`puppet.<my domain>`，如果我`dig puppet.<my domain>`，我看到该名称解析正确。

我读过的所有 puppet 文档都指出，代理`puppet`默认尝试连接到 puppet master，您的选项是主机文件欺骗或做正确的事情，在 DNS 中创建一个 CNAME，并相应地编辑 puppet.conf，我有完毕。

那么我错过了什么？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-24T03:13:39.470

哦！需`sudo`要这样做！然后一切正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-15T21:50:33.507

我不得不使用`--server`标志：

```
sudo puppet agent --server=puppet.example.org 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-02T16:55:36.470

我实际上遇到了同样的错误，但我正在使用两个学习 puppet vm 并尝试运行“puppet agent --test”命令。

我通过打开主服务器和代理 vm 上的文件 /etc/hosts 和行解决了这个问题

```
***.***.***.*** learn.localdomain learn puppet.localdomain puppet 
```

ip 地址（星号）最初是一些随机数。我必须在两个 vm 上更改这个数字，使其成为主节点的 IP 地址。

所以我想对于有经验的用户，我的建议是检查 /etc/hosts 文件，以确保这里的主服务器和代理的 IP 地址不仅匹配，而且与主服务器的 IP 地址相同。

对于像我这样的其他菜鸟，我的建议是更清楚地阅读文档。这是“设置代理虚拟机”过程中的一个步骤，我完全错过了 xD

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-09T14:34:35.070

在我的情况下，我遇到了同样的错误，但这是由于证书应该签署到 puppetmaster 服务器上的节点。

检查待处理的证书运行如下：

# 傀儡证书列表

"node.domain.com" (SHA256) 8D:E5:8A:2*****"

将证书签署到节点：

# 傀儡证书签名 node.domain.com

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-22T09:26:07.283

今天在`puppet 2.6`上遇到同样的问题`CentOS 6.4` 我为解决这个问题所做的只是检查主机和 resolv.conf 等常用内容，以确保它们符合预期（与工作服务器相比），然后；

1.  删除 /var/lib/puppet 目录`rm -rf /var/lib/puppet`
2.  清除了人偶大师的证书`puppetca --clean servername`
3.  重启了网络`service network restart`
4.  重跑木偶

即使 resolv.conf 与工作服务器相同，puppet 还是更新了 resolv.conf 并立即重新签署了证书并替换了所有 puppet lib 文件。

之后一切都很好。

# android - 试图找到一个android数据结构

> ID：10729382
> 
> 赞同：1
> 
> 时间：2012-05-23T23:41:54.660
> 
> 标签：android, data-structures, map, queue

我正在尝试实现一个数据结构，它允许我跟踪一个索引（所以我可以盲目地访问数据点）、一个键（需要在那里识别程序其余部分中的数据）和一个价值。

我查看了一张地图，但这不允许我在没有任何密钥的情况下访问数据点。我需要队列和地图的某种组合。这是否存在，我只是想念它？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:45:47.327

我相信您正在寻找的是 LinkedHashMap。它将返回一个有序集合，您可以通过键访问值。

```
LinkedHashMap<Key, Value> myMap = new LinkedHashMap<Key, Value>();

myMap.put(aKey, aValue); //adds to map.
myMap.values(); //returns collection of values
aValue = myMap.get(Key); //returns a value with the given key 
```

# c# - 尝试恢复 Windows 工作流时出错

> ID：10729383
> 
> 赞同：0
> 
> 时间：2012-05-23T23:42:00.413
> 
> 标签：c#, asp.net, workflow-foundation-4, guid

尝试使用以下代码恢复工作流时：

```
 public WorkflowApplication LoadInstance(Guid instanceId)
    {
        if (this.instances.ContainsKey(instanceId))
            return this.instances[instanceId];

        WorkflowApplication instance = new WorkflowApplication(new Tarpon.Workflows.CreateContact());

        //  Create Persistable Workflow           
        SqlWorkflowInstanceStore store = new SqlWorkflowInstanceStore(ConfigurationManager.ConnectionStrings["WorkflowPersistance"].ConnectionString);
        store.HostLockRenewalPeriod = new TimeSpan(0, 0, 5);
        instance.InstanceStore = store;

        //  Load Instance
        instance.Completed += OnWorkflowCompleted;
        instance.Idle += OnIdle;
        instance.PersistableIdle += OnIdleAndPersistable;
        instance.Aborted += OnAborted;
        instance.Load(instanceId);

        //  Save instance in list of running instances
        this.instances.Add(instance.Id, instance);       // ERROR IS THROWN HERE

        return instance;
    } 
```

**我在“ this.instances.Add(instance.Id, instance)** ”这一行得到错误：

```
The execution of an InstancePersistenceCommand was interrupted because the instance '9b9430b6-f182-469d-bcae-0886d546f7ea' is locked by a different instance owner. 
This error usually occurs because a different host has the instance loaded. The instance owner ID of the owner or host with a lock on the instance is '30411662-b9b3-4250-9e2c-5aaa9895b740'. 
```

我试图在上面的代码中降低 HostLockRenewalPeriod，并且还添加了下面的代码以希望禁用实例上的锁定，但无济于事。它似乎也永远不会闯入下面的代码。每次我通过 Load() 方法时，都会出现上述错误。

```
 public PersistableIdleAction OnIdleAndPersistable(WorkflowApplicationIdleEventArgs e)
    {
        instances.Remove(e.InstanceId);
        return PersistableIdleAction.Unload;
    } 
```

这段代码似乎有一半的时间可以工作，但另一半却没有正确恢复它的工作流程。有没有人知道我可以做些什么来正确删除锁，而不必重新编写所有这些功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T10:05:17.630

请查看这篇描述持久性和 instaneStore 配置的[博客文章。](http://msmvps.com/blogs/theproblemsolver/archive/2009/11/19/windows-workflow-foundation-4-and-persistence.aspx)

此代码是从帖子中复制的，我认为它可能会对您有所帮助：“

```
var instanceStore = new SqlWorkflowInstanceStore(connStr); 
var instanceHandle = instanceStore.CreateInstanceHandle();
var createOwnerCmd = new CreateWorkflowOwnerCommand();
var view = instanceStore.Execute(instanceHandle, createOwnerCmd, TimeSpan.FromSecond(30));
instanceStore.DefaultInstanceOwner = view.InstanceOwner; 
// Do whatever needs to be dome with multiple WorkflowApplications 
var deleteOwnerCmd = new    DeleteWorkflowOwnerCommand();
instanceStore.Execute(instanceHandle, deleteOwnerCmd, TimeSpan.FromSeconds(30)); 
```

> 关键是需要在开始时执行的 CreateWorkflowOwnerCommand。并且当您使用 CreateWorkflowOwnerCommand 时，请确保不要忘记 DeleteWorkflowOwnerCommand 否则所有工作流将被所有者锁定并且不能被另一个 SqlWorkflowInstanceStore 重新加载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T21:52:46.077

我没有看到`instance.Run`或`instance.ResumeBookmark`在这里，您需要它来触发任何与执行相关的事件，例如 PersistableIdle。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T11:51:27.493

实际上，当我在开发中看到这个错误时，它只是意味着我需要清理我的持久性数据库。您可以使用已经存在的存储过程来删除持久化的工作流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-17T01:52:36.860

尝试制作一个`WorkflowIdleBehavior`对象并将其设置`TimeToUnload`为零。有关更多详细信息，请参见[此处](http://msdn.microsoft.com/en-us/library/ee816858.aspx)。

# python - 将 Twisted 中的代码推迟到特定线程

> ID：10729386
> 
> 赞同：2
> 
> 时间：2012-05-23T23:42:27.353
> 
> 标签：python, twisted, python-multithreading, pycuda

我正在用 Twisted 和 pyCUDA 编写服务器。CUDA 工作方式的一个限制是我必须在初始化它的同一线程中访问 CUDA 上下文。但是，Twisted 的线程池实现不允许我请求特定线程。

例如，如果我有多个客户端连接到服务器，它们将请求使用 CUDA 完成一些计算。将使用同一个 CUDA 对象请求多个操作（初始化很昂贵）。我想使用 deferToThread 函数，但这不允许我推迟到特定线程，只是“一些”线程。理想情况下，我想做的是使用 deferToThread 之类的机制，但要指定代码运行所在的线程。任何建议将不胜感激，也许 Twisted 是该项目的错误方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:41:37.033

[CUDA Driver API 支持通过使用函数cuCtxPushCurrent()](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDA__CTX_gb02d4c850eb16f861fe5a29682cc90ba.html#gb02d4c850eb16f861fe5a29682cc90ba)和[cuCtxPopCurrent(](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDA__CTX_g2fac188026a062d92e91a8687d0a7902.html#g2fac188026a062d92e91a8687d0a7902) ) 从多线程提交工作到 CUcontext（Driver API ） 。当前适用于许多版本。[在 CUDA 4.0 及更高版本中，CUDA 运行时支持从多个 OS 线程向设备提交工作 (CUcontext)，或使用函数cudaSetDevice()](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDART__DEVICE_g418c299b069c4803bfb7cab4943da383.html#g418c299b069c4803bfb7cab4943da383)从单个 OS 线程向多个设备提交工作。

我不确定这是否通过 pyCUDA 暴露出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T16:12:05.260

对于您使用 CUDA 的特定用例，Greg Smith 的答案可能是最好的。

但是，对于遇到这个问题并在 Twisted 的一个特定线程中寻找一种方法的其他人来说，[Calendar and Contacts Server 具有该功能的实现](http://trac.calendarserver.org/browser/CalendarServer/trunk/twext/internet/threadutils.py)，并且如您所见，它并不太复杂。

# eclipse - ArtifactDescriptorException：无法读取工件描述符 Maven 错误

> ID：10729394
> 
> 赞同：9
> 
> 时间：2012-05-23T23:43:14.810
> 
> 标签：eclipse, maven, jboss, repository

我正在使用最新的 Eclipse for Java EE 并安装了 JBoss 工具，因此包含了 Maven。我将一个现有的 Maven 项目导入到我的工作区并尝试更新依赖项，但我的 POM 中只收到错误错误，即某些参数无效并且无法传输任何工件。实际上有两个不同的错误，也许它们相互依赖？您可以检查：服务器可用，我还尝试重新安装 Eclipse 和 JBoss。那么还缺少什么？

> ArtifactDescriptorException：无法读取 edu.kit.aifb.ai2.sqsclient:sqsclient:jar:1.0.0 的工件描述符：ArtifactResolutionException：无法从 [http传输 edu.kit.aifb.ai2.sqsclient:sqsclient:pom:1.0.0 ://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories/releases](http://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories/releases) 已缓存在本地存储库中，直到 Beehive 的更新间隔结束或强制更新后才会重新尝试解析。原始错误：无法将工件 edu.kit.aifb.ai2.sqsclient:sqsclient:pom:1.0.0 从/到 Beehive ( [http://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories /releases](http://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories/releases) ): 无效参数：getsockname to [http://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories/releases/edu/kit/aifb/ai2/sqsclient/sqsclient/1.0.0/sqsclient-1.0.0.pom](http://eorg-ai2.aifb.kit.edu:8081/nexus/content/repositories/releases/edu/kit/aifb/ai2/sqsclient/sqsclient/1.0.0/sqsclient-1.0.0.pom)

我的存储库文件夹中确实没有任何内容，但 .pom.lastUpdated-files

> 从存储库 [本地 (C:\Users\Gregor.Gregs.m2\repository)、中央 ( [http://repo1.maven. org/maven2)]](http://repo1.maven.org/maven2)]) : 在任何插件存储库中都找不到插件

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-04-04T11:40:33.573

对我来说，这是因为 Eclipse 正在缓存异常（即使在我解决了原始问题之后），所以尝试：

```
right click on project -> maven -> update-project -> force to update snapshot/release -> OK. 
```

对于类似的问题，它对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-06T11:46:00.560

检查你的 Eclipse 设置文件路径是否指向正确的路径。窗口--> 首选项--> Maven--> 用户设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-14T16:05:59.610

右键单击项目-> Maven-> 更新项目-> 强制更新快照/发布-> 确定。

它也对我有用

# python - 如何在 request.POST 中获取文件名？

> ID：10729397
> 
> 赞同：3
> 
> 时间：2012-05-23T23:43:27.233
> 
> 标签：python, django

在我的 request.FILES 变量中：

```
FILES
Variable    Value
script  <InMemoryUploadedFile: landing.jpg (image/jpeg)> 
```

我将如何在这里提取文件名以获得“landing.jpg”？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-23T23:47:09.143

通过[`request.FILES[u'script'].name`](https://docs.djangoproject.com/en/dev/ref/files/file/#django.core.files.File.name).

# actionscript-3 - 我如何使子弹着火？

> ID：10729401
> 
> 赞同：0
> 
> 时间：2012-05-23T23:44:04.887
> 
> 标签：actionscript-3, actionscript

我不知道下一步该做什么。现在，当我单击时，它会添加子弹并将其旋转到正确的角度，但我不知道如何让它开火。我想让子弹射到鼠标指向的地方。谢谢！PS：对不起，如果代码是混乱的。

```
package    
{
    import flash.display.MovieClip;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.TimerEvent;
    import flash.events.KeyboardEvent;
    import flash.utils.Timer;
    import flash.text.Font;
    import flash.events.MouseEvent;
    import flash.text.TextDisplayMode;
    import flash.text.TextExtent;
    import flash.text.TextField;
    import flash.text.TextFormat;
    import fl.motion.easing.Back;
    import flash.display.DisplayObject;

    public class GameEnter extends MovieClip
    {

        public var _bullet:bullet;

        public function GameEnter() 
        {
            stage.addEventListener(MouseEvent.MOUSE_DOWN, shootBullet);
            stage.addEventListener(MouseEvent.MOUSE_UP, removeBullet);
        }

        public function init()
        {
            _bullet = new bullet();
            addChild(_bullet);

            _bullet.x = stage.stageWidth / 2;
            _bullet.y = stage.stageHeight / 2;

            addEventListener(Event.ENTER_FRAME, onEnter);
        }

        public function onEnter(event:Event)
        {
            var dx:Number = mouseX - _bullet.x;
            var dy:Number = mouseY - _bullet.y;
            var angle:Number = Math.atan2(dy,dx) * 180 / Math.PI;

            _bullet.rotation = angle;
        }

        public function shootBullet(event:MouseEvent)
        {
            init();
        }

        public function removeBullet(event:MouseEvent)
        {
            removeChild(_bullet);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:29:43.400

要在基于旋转的方向上移动对象，您需要`cos`和`sin`。

`Math.cos()`并且`Math.sin()`只接受弧度，因此您需要将旋转转换为弧度，就像您`Math.atan2()`在示例中所做的那样。

样本：

```
// Note: Utilising the property 'angle' from your code.
_bullet.x += Math.cos(angle);
_bullet.y += Math.sin(angle); 
```

然后显然将这些值乘以一个值，该值将代表您希望子弹移动的速度，例如：

```
var velocity:Number = 10.5;

_bullet.x += Math.cos(angle) * velocity;
_bullet.y += Math.sin(angle) * velocity; 
```

# php - 将 mp3 上传到服务器 PHP

> ID：10729404
> 
> 赞同：0
> 
> 时间：2012-05-23T23:44:27.483
> 
> 标签：php, file-upload

我正在尝试使用 PHP 通过一个简单的 html 表单上传一个小 mp3。

这是我的html：

```
<html>
<head></head>

<body>

<form action="upload_mp3.php" method="post" enctype="multipart/form-data">

<input type="file" name="mp3" />

<input type="submit"/>
</form>

</body>
</html> 
```

这是我的php：

```
<?php 

$mp3 = ($_FILES['mp3']['name']);

$target = "mp3/"; 
$target = $target . basename( $_FILES['mp3']['name']); 

if(move_uploaded_file($_FILES['mp3']['tmp_name'], $target)) 
 {  header("Status: 200"); } 
 else
 { echo "no";}

?> 
```

代码看起来有什么问题吗？也可能是我的临时文件不可写吗？如果是这样，我可以获得一些关于如何使其可写的说明。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:45:25.893

确保您的表单标签具有`enctype=multipart/form-data`属性集：

```
<form action="upload_mp3.php" method="POST" enctype="multipart/form-data"> 
```

# php - 带有_id的mongo php插入

> ID：10729405
> 
> 赞同：1
> 
> 时间：2012-05-23T23:44:30.710
> 
> 标签：php, mongodb

`_id`将新文档插入我的 Mongo 集合时，我无法分配自己的值。这是我的PHP：

```
$user = array(
'_id'=> new MongoId("4f626fdf1771a8e71a000000"),
'name'=> 'John Smith'
)
try {
    if($col->insert($user)){
        echo 'INSERTED';
    }
} catch(MongoCursorException $e) {
    echo "ERROR: ".$e;
} 
```

这不会显示错误，但也不会将项目插入到集合中。但是，我可以为该`_id`字段分配一个字符串变量而不是 MongoId 类型，然后它会插入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T07:08:05.930

默认情况下，MongoDB 驱动程序在所谓的“不安全模式”下运行命令，当它对请求执行“即发即弃”并且不检查错误时。因此，如果存在重复键错误，您将不知道。

尝试在安全模式下运行插入，如下所示：

```
$col->insert($user, array("safe" => true)); 
```

哦，您当然**可以**制作自己的 ObjectId（与此处的其他答案相反）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T15:02:27.497

Safe 已被弃用，不再使用。为确保您使用正确的命令，请使用写入关注点“w”。

$col->insert($user, array('w'=>true))

见这里： http: [//php.net/manual/en/mongocollection.insert.php](http://php.net/manual/en/mongocollection.insert.php)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-23T23:52:07.850

您不能自行[创建 MongoDB 对象](http://www.mongodb.org/display/DOCS/Object+IDs#ObjectIDs-BSONObjectIDSpecification)ID。因此，有两种方法可以将文档插入到集合中：

*   让 MongoDB 创建 ID（安全！）
*   自行选择 ID，它可以是数组以外的任何东西，并且它必须是唯一的。

参考：[对象 ID](http://www.mongodb.org/display/DOCS/Object+IDs#ObjectIDs-The%5CidField)

我从未使用过 PHP 和 MongoDB 的组合，但尝试简单地为该`_id`字段分配一个字符串。

# java - Android asyncTask 数组返回 null

> ID：10729413
> 
> 赞同：1
> 
> 时间：2012-05-23T23:45:38.290
> 
> 标签：java, android, nullpointerexception, android-asynctask

我试图重写一些代码，因为 android 指定您必须将网络任务放在版本 4.0 中的单独线程上，我有一段代码可以完美运行，但是由于我尝试将它放入异步任务中，我现在无法让它工作根本，我已经设置了我的异步任务以返回一个数组，但它不断返回 null，这里有什么我没有看到的明显的东西吗？

```
package com.imagetest.second;

import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.Toast;

public class ImagetestActivity extends Activity {
// Elements media;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    String url = "http://www.goal.com/en-ca/news/4196/brazil/2012/05/23/3123112/ganso-set-for-knee-surgery";

    new getMainImg().execute(url);

}

private class getMainImg extends AsyncTask<String, Void, Document> {

    @Override
    protected Document doInBackground(String... params) {
        Document doc = null;

        try {
            doc = Jsoup.connect(params[0]).get();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return doc;
    }

    @Override
    protected void onPostExecute(Document result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);

        List<Element> media = new ArrayList<Element>();
        media = result.select("img[src]");

        List<Dog> theImportantUrlArray = new ArrayList<Dog>();
        for (Element src : media) {
            String srcStr = src.attr("src");
            String first7st = srcStr.substring(0, 7);
            if (first7st.equals("http://")) {

                Integer theHeight = getBitmapFromURL(srcStr).getHeight();
                theImportantUrlArray.add(new Dog(srcStr, theHeight));

            }

        }
        Collections.sort(theImportantUrlArray, new Dog());

        Integer thetweetpic = theImportantUrlArray.get(0).getDogAge();
        String theTweetUrl = theImportantUrlArray.get(0).getDogName();

        Toast.makeText(ImagetestActivity.this,
                thetweetpic.toString() + " " + theTweetUrl,
                Toast.LENGTH_LONG).show();
    }

}

public static Bitmap getBitmapFromURL(String src) {
    try {
        URL url = new URL(src);
        HttpURLConnection connection = (HttpURLConnection) url
                .openConnection();
        connection.setDoInput(true);
        connection.connect();
        InputStream input = connection.getInputStream();
        Bitmap myBitmap = BitmapFactory.decodeStream(input);
        return myBitmap;
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
}

public class Dog implements Comparator<Dog>, Comparable<Dog> {
    private String theUrl;
    private int height;

    Dog() {
    }

    Dog(String n, int a) {
        theUrl = n;
        height = a;
    }

    public String getDogName() {
        return theUrl;
    }

    public int getDogAge() {
        return height;
    }

    // Overriding the compareTo method
    public int compareTo(Dog d) {
        return (this.theUrl).compareTo(d.theUrl);
    }

    // Overriding the compare method to sort the age
    public int compare(Dog d, Dog d1) {
        return d1.height - d.height;
    }
}

} 
```

# android - 我应该为 Android 应用程序开发购买什么 Android 设备？

> ID：10729415
> 
> 赞同：7
> 
> 时间：2012-05-23T23:45:50.837
> 
> 标签：android

我正在市场上购买基本的 Android 设备。我买一个的主要原因是学习开发移动应用程序。虽然 Eclipse IDE 提供了用于测试应用程序的虚拟 Android 设备，但它与真正的 Android 设备不同，并且不会让我与 Android 设备用户处于相同的波长。（最明显的例子：在明亮的户外环境中能见度比在室内更差。）

一些问题：

1.  平板电脑是我应该得到的设备类型吗？我的印象是它比其他设备更通用。我不需要智能手机，因为我的哑机很适合我，而且我什至不经常使用它。我讨厌被锁定在特定无线提供商的想法。我对电子书不感兴趣，因为我还是更喜欢纸质书。
2.  我应该使用 Android 2.3 还是 4.0 的设备？一方面，超过 90% 的当前 Android 用户使用的是 2.3.3 或更早版本。另一方面，4.0 更好，将获得市场份额。（现在购买 Android 2.3 设备，以后再购买 Android 4.0 设备是我最好的选择吗？）
3.  除了wifi，我还应该寻找什么？
4.  有没有我应该避免的品牌/型号？我记得听说 Packard Bell PC 是最不可靠的。Yugo是一个可怕的价值。（旧的 Oldsmobile Cutlass 旧车价值更高——至少同样可靠，但买起来便宜得多。）
5.  买二手有什么意义吗？Ebay 和 Google 购物上的列表并没有显示二手平板电脑比新平板电脑便宜多少，而且新平板电脑的数量比二手平板电脑多。

目前 Ebay 列表（2012 年 5 月 23 日）显示 200 多台 Android 2.3 平板电脑售价 55-90 美元： [http ://www.ebay.com/sch/iPads-Tablets-eBook-Readers-/171485/i.html?Operating %2520System=Android%25202%252E3%252Ex%2520Gingerbread&LH_BIN=1&Internet%2520Connectivity=Wi%252DFi%7CWi%252DFi%2520%252B%25203G%7CWi%252DFi%2520%252B%25204G&_nkw_Condition=dmptst=ncLHItem_Condition=dmptst=ncL&_HItem_Condition=dmptst=3&_ 1000](http://www.ebay.com/sch/iPads-Tablets-eBook-Readers-/171485/i.html?Operating%2520System=Android%25202%252E3%252Ex%2520Gingerbread&LH_BIN=1&Internet%2520Connectivity=Wi%252DFi%7CWi%252DFi%2520%252B%25203G%7CWi%252DFi%2520%252B%25204G&_nkw=android+2.3&_dmpt=US_Tablets&rt=nc&LH_ItemCondition=1000)

[目前（2012 年 5 月 23 日）的 Ebay 列表显示了 200 多台 Android 4.0 平板电脑，售价为 83-107 美元： http](http://www.ebay.com/sch/iPads-Tablets-eBook-Readers-/171485/i.html?Operating%2520System=Android%25204%252Ex%2520Ice%2520Cream%2520Sandwich&LH_BIN=1&LH_ItemCondition=1000&Type=Tablet&_pppn=r1&_dmpt=US_Tablets&Internet%2520Connectivity=Wi%252DFi%7CWi%252DFi%2520%252B%25203G%7CWi%252DFi%2520%252B%25204G) ://www.ebay.com/sch/iPads-Tablets-eBook-Readers-/171485/i.html?Operating [%2520System=Android%25204%252Ex%2520Ice%2520Cream%2520Sandwich&LH_BIN=1&LH_ItemCondition=1000&Type=Tablet&_pppn=r1&_dmpt=US_Tablets&Internet%2520Connectivity=Wi%252DFi%7CWi%252DFi%2520%252B%25203G%7CWi%252DFi%2520%252B%25204G](http://www.ebay.com/sch/iPads-Tablets-eBook-Readers-/171485/i.html?Operating%2520System=Android%25204%252Ex%2520Ice%2520Cream%2520Sandwich&LH_BIN=1&LH_ItemCondition=1000&Type=Tablet&_pppn=r1&_dmpt=US_Tablets&Internet%2520Connectivity=Wi%252DFi%7CWi%252DFi%2520%252B%25203G%7CWi%252DFi%2520%252B%25204G)

你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:39:49.317

这个问题可能是题外话。

但这是我的想法：

如果您想了解事实是您应该尝试访问（无论是所有权还是仅访问权）您打算通过您的应用程序支持的任何设备。这当然不是每个人都能做到的，但是有一些方法可以让您在构建设备集合的同时最大化您的价值，目标是使用最大的不同类型设备。

您没有义务被锁定在电话合同（甚至任何服务）中。如果您去运营商商店，您可以以全价购买设备并离开商店而不激活任何服务（一般而言，可能会随您所在的任何商店而变化=）如果您打算通过电话对于全价，预计价格范围为 380-600 美元。从我能告诉你的情况来看，我认为手机是你开始的最佳途径。除了能够从运营商处购买之外，谷歌还不时直接销售一款“Nexus”设备，该设备发布了带有库存（ish）安卓操作系统（无皮肤等）。该系列中的当前设备是[Galaxy通过（前）Android Market 直接销售的 Nexus](https://play.google.com/store/devices/details?id=galaxy_nexus_hspa&feature=corpus_selector)这是一个不错的选择，因为它或多或少是最新一代的硬件和最新的操作系统（这些 Nexus 设备往往比运营商绑定的设备更及时地接收其操作系统更新）。事实上，第一款 Nexus 设备主要面向开发人员推销，该系列手机旨在用于开发。

> 平板电脑是我应该得到的设备类型吗？

如果您打算为平板电脑创建应用程序，那么可以。如果您打算开发手机应用程序，您应该真正在手机上进行测试。

> 我应该使用 Android 2.3 还是 4.0 的设备？

理想情况下，两者都在不同的设备上。如果您必须选择一个，那么这取决于您的预算 4.0 目前仅在最新设备上，因此它们可能会比您可以找到的 2.3 中的某些设备更贵。（虽然 Galaxy Nexus 的 399 美元在价格上可能很难被击败，即使对于一些出售的 2.3 设备也是如此）

> 除了wifi，我还应该寻找什么？

在美国可以轻松购买的手机上，您的选择基本上可以归结为几件事。屏幕尺寸（对于手机来说从很小到非常大），硬件键盘（有几种不同的形状和尺寸），相机（如果你关心的话）。一般来说，大多数其他功能都是相当标准的（即蓝牙、gps、加速度计等。）要考虑的另一件事是“Oomph”，尽管被称为手机，但今天人们随身携带的是小型计算机。它们具有与 PC 相同的 CPU、GPU 和 RAM。电池寿命是最后一个主要除数，电池的预期寿命范围相当广泛（提示，大屏幕和多核需要大量电池）。但是，由于您似乎不想将此设备用作您的手机，因此其中一些东西对您来说可能并不重要。

> 有没有我应该避免的品牌/型号？

您的第一个 ebay 链接列表中的任何内容。一般来说（在美国），主要的手机制造商是：HTC、摩托罗拉、索尼、LG、三星。还有许多其他设备也不错。但这些人通常是那些不断抽出最常用手机的人。理想情况下，您应该瞄准不同制造商制造的设备的传播。他们喜欢在他们的操作系统版本中使用的自定义皮肤和插件往往喜欢额外的测试。拥有其中一个将帮助您帮助最大的用户。

> 买二手有什么意义吗？

不错但略显陈旧的手机有很多优惠。如果你不知道你在看什么，我会远离，很容易被扯掉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:34:06.087

好吧，您似乎不需要非常昂贵的设备。猜猜你可以买谷歌和三星的旧 Nexus S，它不是最新的，但仍然有 android 4，因为它是谷歌的“官方”或其他东西。而且由于它与 2.3 一起推出，您应该能够在某处下载旧版本并将其刷新。那部手机应该更便宜，尤其是二手的。

我的意思是，因为有很多设备具有不同的屏幕尺寸，而你真的找不到一款能够揭示其他设备用户对你的应用程序的看法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:46:20.010

1.  运营商选择应该不是发展的问题。您可以为任何运营商购买任何 Android 手机，包括解锁，这不会影响您的开发灵活性。

2.  获取您可以拥有的最低版本。2.3 和 2.2 目前拥有最多的市场份额。没有理由获得 4.0，*除非*您是*专门*为 Android OS 4.0 及更高版本开发的（这意味着您实际上使用的 API 仅存在于 4.0 及更高版本而不是更低版本）。

3.  您的开发平台也会影响要使用的手机型号。如果您使用 Windows，请购买带有 Windows 驱动程序的手机。购买一个却发现 Windows 无法检测到它是一件很糟糕的事。Mac 和 Linux 不需要驱动程序，因为它们都是基于 UNIX 的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T21:39:16.093

如果您暂时需要一部手机来测试您的应用程序，索尼移动开发者计划在美国和加拿大有一个手机借用计划，您可以在其中借用设备长达 30 天。 [http://developer.sonymobile.com/wportal/devworld/phones/borrow-a-phone](http://developer.sonymobile.com/wportal/devworld/phones/borrow-a-phone)

/Magnus E 索尼移动

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T00:33:30.343

你应该得到一个电话。如果您不想使用它，则不必……但很可能您的大多数用户都在设备上。如果您想要一个始终保持最新并且非常适合测试的设备，我推荐 Galaxy Nexus。

由于大多数 Android 手机用户没有使用最新的操作系统版本，我更喜欢在 2.3 的手机上进行测试

# windows - 需要产生稳定的 10mSec 中断

> ID：10729418
> 
> 赞同：4
> 
> 时间：2012-05-23T23:45:52.303
> 
> 标签：windows, timer, interrupt

我有一个应用程序，我需要在 Windows 7/32 位计算机上以 10 毫秒速率 (100hz) 运行（该计算机也将同时运行其他应用程序）。此中断可能有一些最小延迟 (100uSec) 响应，但不能长时间漂移。我有一个程序，我已加载并使用 NtSetTimerResolution 将计时器设置为 10 毫秒分辨率，然后使用 CreateTimerQueue/CreateTimereQueueTimer 函数创建一个计时器，该函数带有一个回调例程，用于切换 GPIO 引脚（暂时） - 这会产生预期的方波，只要我不对系统做任何其他事情。当我开始其他几个过程时，我的方波的准确性超出了窗口。有什么方法可以在定时器中断上获得更高的优先级（或者我可以使用另一个定时器）来产生更稳定的输出（也许是 SMI）？我的代码在下面，是使用 Windows DDK 的 x86 检查构建环境构建的，并从具有管理员权限的命令 shell 运行：

```
/*

Abstract:

Simple console test app for a 10mSec timer interrupt service

Enviroment:

Administrator Mode

*/

/* INCLUDES */

#include     <windows.h>
#include     <winioctl.h>
#include     <stdio.h>
#include     <string.h>
#include     <stdlib.h>
#include     <conio.h>
#include     <strsafe.h> 

#include     <stdlib.h>
#include     <stdio.h>

#include     <winsock2.h>
#include     <mswsock.h>

#pragma warning(disable:4127)   // condition expression is constant

FARPROC pNtQueryTimerResolution;
FARPROC pNtSetTimerResolution;

static  HANDLE    NTDLLModuleHandle;
static  HINSTANCE hInpOutDll;

typedef         void  (   __stdcall  *lpOut32 )( short , short );
typedef  short        (   __stdcall  *lpInp32 )( short );
typedef  BOOL         (   __stdcall  *lpIsInpOutDriverOpen )( void );

//Some global function pointers (messy but fine for an example)
lpOut32              gfpOut32;
lpInp32              gfpInp32;
lpIsInpOutDriverOpen gfpIsInpOutDriverOpen;

void CALLBACK TimerProc(void* lpParameter,
    BOOLEAN TimerOrWaitFired);

// MAIN

VOID  __cdecl    main( void )
{
    ULONG ulMinRes = 0;
    ULONG ulMaxRes = 0;
    ULONG ulCurRes = 0;

    HANDLE phNewQueue;
    HANDLE phNewTimer;

    phNewQueue        = CreateTimerQueue( );

    NTDLLModuleHandle = LoadLibrary( "NTDLL.DLL" );

    if( NULL == NTDLLModuleHandle )
    {
        return;
    }

    // Get the function pointers,
    pNtQueryTimerResolution = GetProcAddress( NTDLLModuleHandle, "NtQueryTimerResolution" );
    pNtSetTimerResolution = GetProcAddress( NTDLLModuleHandle, "NtSetTimerResolution" );

    if( ( pNtQueryTimerResolution == NULL ) || ( pNtSetTimerResolution == NULL ) )
    {
        printf( "unable to link to ddl\n\n\n\n\n\n" );
        return;
    }

    pNtQueryTimerResolution( &ulMinRes, &ulMaxRes, &ulCurRes );
    printf( "MMR:  %d   %d   %d\n", ulMinRes, ulMaxRes, ulCurRes );

    ulMaxRes = 100000;
    pNtSetTimerResolution( ulMaxRes, TRUE, &ulCurRes );

    pNtQueryTimerResolution( &ulMinRes, &ulMaxRes, &ulCurRes );
    printf( "MMR:  %d   %d   %d\n", ulMinRes, ulMaxRes, ulCurRes );

    //Dynamically load the DLL at runtime (not linked at compile time)
    hInpOutDll = LoadLibrary( "InpOut32.DLL" ); 
    if( hInpOutDll != NULL )
    { 
        gfpOut32 = ( lpOut32 )GetProcAddress( hInpOutDll, "Out32" );
        gfpInp32 = ( lpInp32 )GetProcAddress( hInpOutDll, "Inp32" );
        gfpIsInpOutDriverOpen
            = ( lpIsInpOutDriverOpen )GetProcAddress( hInpOutDll, "IsInpOutDriverOpen" );

        if( gfpIsInpOutDriverOpen( ) )
        {
            gfpOut32( 0xA01, 0x00 );
        }
        else
        {
            printf( "unable to create timer system\n\n\n\n\n\n" );
            return;
        }
    }

    CreateTimerQueueTimer( &phNewTimer, phNewQueue, TimerProc, NULL, 0, 10, 
                       WT_EXECUTEINTIMERTHREAD );

    do
    {
        Sleep( 1 );
    } while( TRUE );
}

void CALLBACK TimerProc(void* lpParameter,
    BOOLEAN TimerOrWaitFired)
{
    WORD wData;    

    UNREFERENCED_PARAMETER  ( lpParameter );
    UNREFERENCED_PARAMETER  ( TimerOrWaitFired );

    wData = gfpInp32( 0xA00 );
    wData++;
    gfpOut32( 0xA00, wData );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:27:45.080

您可以使用[`SetThreadPriority`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686277%28v=vs.85%29.aspx)为关键线程赋予优先级。在这种情况下，您可能需要显式创建一个线程并使用[`CreateWaitableTimerEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682494%28v=vs.85%29.aspx),[`SetWaitableTimerEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd405521%28v=vs.85%29.aspx)和[`WaitForSingleObjectEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687036%28v=vs.85%29.aspx)而不是[`CreateTimerQueueTimer`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682485%28v=vs.85%29.aspx). 确保关键线程在等待之间永远不会花费太长时间执行，否则 Windows 可能会停止正常工作。

如果最大延迟为 100 微秒，这可能还不够。您可能需要使用该[`SetPriorityClass`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686219%28v=vs.85%29.aspx)函数将进程优先级类设置为 REALTIME_PRIORITY_CLASS，但请确保您的程序永远不会长时间占用 CPU，否则 Windows 将停止正常工作。特别是，如果您的程序挂起，整个操作系统都会挂起；在这种情况下，除非关闭电源，否则无法停止程序。

即使这可能还不够。Windows 不是一个实时操作系统，它可能无法按照您的要求进行操作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-01-12T20:30:16.720

我对 Windows 和毫秒的经验是它不可靠。我通过 Nusbio 设备用示波器测量了 Sleep api。而 Sleep(0) 与根本不调用该方法不同。Sleep(5) 和 Sleep(15) 有时会给出不一致的结果，有时等待是相同的。

如果您想要这种精度，您需要一个可以与您的 Windows 应用程序对话的微控制器。

# javascript - 是什么导致 IE8 中出现谷歌地图错误？

> ID：10729421
> 
> 赞同：5
> 
> 时间：2012-05-23T23:46:12.303
> 
> 标签：javascript, google-maps-api-3, internet-explorer-8

我们正在使用谷歌地图并发现了一个似乎只在 IE8 中发生的问题（可能在下面）。该功能在 FF、Chrome、IE9 中正常工作。

发生错误的代码是：

```
google.load("maps", "3.x", { other_params: "sensor=false" });
    var mapdiv = null;
    $(function () {
        mapdiv = document.getElementById("map");
        map = new google.maps.Map( mapdiv, {
            zoom: 1,
            center: new google.maps.LatLng(6, 35),
            disableDefaultUI: true,
            mapTypeId: google.maps.MapTypeId.TERRAIN
        });
        var latlngbounds = new google.maps.LatLngBounds( ); 
```

特别是在这一行：

```
map = new google.maps.Map( mapdiv, {
    zoom: 1,
    center: new google.maps.LatLng(6, 35),
    disableDefaultUI: true,
    mapTypeId: google.maps.MapTypeId.TERRAIN
}); 
```

错误是：

> 对象不支持此属性或方法

我玩过 IE 开发工具，如果我`map =`用类似没有任何错误的东西替换`var x =`，所以这让我相信该`map`对象是缺少某些属性/方法的罪魁祸首。虽然我真的不知道`map`对象来自哪里，但我认为它是从`google.load`调用中加载的。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T02:13:51.403

当线：

```
map = new google.maps.Map(mapdiv, { zoom: 1, center: new google.maps.LatLng(6, 35), disableDefaultUI: true, mapTypeId: google.maps.MapTypeId.TERRAIN }); 
```

执行后，JavaScript 解释器将开始遍历作用域链，查找`map`声明的位置。由于它没有在本地声明，即`var map = ...`，它不会在您的本地范围内找到它，并且最终会被添加到全局范围内。

在您的情况下`map`，已经在全局范围内定义为，因为它是您页面上`window.map`的 a 的 Id 。`div`在所有浏览器中，您都看不到错误消息，`window.map`将其设置为新`google.maps.Map`对象。出于某种原因，无论好坏，IE8 都不允许您创建名称与引用 DOM 元素的现有全局变量冲突的全局变量。

您可以通过几种不同的方式解决此问题：

1.  创建本地`var map`
2.  将您的 div 的 id 从更改`map`为其他内容
3.  如果您必须`map`存在于全局范围内，请使用`window.map =...`

    (3b) 将变量名改为与 不冲突的变量名`window.map`，例如`myMap = new google.maps.Map(...`

# excel - Excel VBA：将范围名称作为函数参数传递

> ID：10729424
> 
> 赞同：3
> 
> 时间：2012-05-23T23:46:22.393
> 
> 标签：excel, vba

我正在编写一个宏来进行复杂的复制/粘贴练习。从概念上讲，这很简单，但我被困在一个地方。所有不同的数据块都用不同的命名范围来标识。我需要遍历这个名称列表，将每个名称作为参数传递给函数（实际上是一个子例程，但想法相同）。数据源位于一个工作簿中，而目标位于另一个工作簿中。

这是我所拥有的（仅用于一个数据块）：

```
Private Sub copyABU()
   copyPaste(ThisWorkbook.Names("myRange1").RefersToRange)
   copyPaste(ThisWorkbook.Names("myRange2").RefersToRange)
   copyPaste(ThisWorkbook.Names("myRange3").RefersToRange)
   //etc
End Sub

Private Sub copyPaste(thisRange As Range)
    Windows(someworkbook).Range(thisRange).Copy
    Range(thisRange).PasteSpecial Paste:=xlPasteValues
End Sub 
```

不幸的是，我得到了一个运行时错误。我认为存在类型不匹配，但我不确定这一点，也无法弄清楚我错过了什么。谁能明白为什么这会失败？（我使用的是 Excel 2010）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:07:56.927

这是我的回答：

```
Sub init()
Windows("Book1.xlsx").Activate
Call copyPaste(2, Range(Cells(1, 1), Cells(10, 10)), "copy")
Windows("Book2.xlsx").Activate
Call copyPaste(1, Range(Cells(1, 1), Cells(10, 10)), "paste")
End Sub

Function copyPaste(wksInt As Integer, thisRange As Range, copyPasteStr As String)
    Dim workSheetRange As Range
    With Worksheets(wksInt)
        Set workSheetRange = thisRange
    End With
    workSheetRange.Select
    If copyPasteStr = "copy" Then
        Selection.Copy
    Else
        Worksheets(wksInt).Paste
    End If
End Function 
```

只要复制和粘贴的范围是相同的维度，这就会起作用。如果尺寸变化，您需要将workSheetRange.Select更改为条件，并且只选择范围的第一个单元格进行粘贴。帕克斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:35:06.683

您的代码将进行一些小的调整。

首先，您需要在对 copyPaste 的调用前加上单词`Call`. （如果您不想这样做，请参阅下面的注释。）

```
Private Sub copyABU()
   Call copyPaste(ThisWorkbook.Names("myRange1").RefersToRange)
   Call copyPaste(ThisWorkbook.Names("myRange2").RefersToRange)
   Call copyPaste(ThisWorkbook.Names("myRange3").RefersToRange)
   ' //etc
End Sub 
```

其次，添加一个`.Address`after `thisRange`。

```
Private Sub copyPaste(thisRange As Range)
    Range(thisRange.Address).Copy
    thisRange.PasteSpecial Paste:=xlPasteValues
End Sub 
```

我不想费心创建`someworkbook`变量，所以我只是删除了那部分。

**注意：**`Call`如果要调用带有括号中的参数列表的过程，则必须使用关键字。[https://stackoverflow.com/a/7715070/138938](https://stackoverflow.com/a/7715070/138938)

如果您不想使用`Call`关键字，请省略括号：

```
copyPaste ThisWorkbook.Names("myRange1").RefersToRange 
```

# c++ - 在 C++ 代码中嵌入文本文件

> ID：10729427
> 
> 赞同：2
> 
> 时间：2012-05-23T23:47:07.903
> 
> 标签：c++, linux, macos, unix

我有以下文本文件：g.dat

```
16
0.0950125098376374401853193354250
0.281603550779258913230460501460
0.458016777657227386342419442983
0.617876244402643748446671764049
0.755404408355003033895101194847
0.865631202387831743880467897713
0.944575023073232576077988415535
0.989400934991649932596154173450

0.189450610455068496285396723209
0.182603415044923588866763667977
0.169156519395002538189312079058
0.149595988816576732081501730116
0.124628971255533872052476277863
0.0951585116824927848099251053810
0.0622535239386478928628438391746
0.0271524594117540948517805723700 
```

以及下面的 C++ 代码来准备它：

```
ifstream In;
  In.open(("g.dat").c_str());
  In>>gaussdim;
  gt = new double[gaussdim];
  gc = new double[gaussdim];
  for(int i=0;i<gaussdim/2;i++)
  {
    In>>gt[i];
    gt[gaussdim-i-1]=-gt[i];
  }
  for(int i=0;i<gaussdim/2;i++)
  {
    In>>gc[i];
    gc[gaussdim-i-1]=gc[i];
  }
  In.close(); 
```

我想将此数据文件嵌入到我的程序中，以便我可以轻松地重新分发它，而不必总是依赖于处理许多不同的文件。我的目标是 linux 和 mac，所以 xxd 可以让我将数据转换为大字符。我需要下一步的帮助，即如何将此字符转换为流或任何更好的解决方案。你有什么建议吗？

编辑：很多好的答案，对我来说，选择的一个优点是对代码的更改很小并且足够通用，我可以在代码的其他类似部分中使用它，其中解析了具有不同结构的几个输入文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:33:19.613

我猜您实际上并不想在代码中嵌入文本文件，因此 Blastfurnace 和 Kyle C 的答案为您的问题提供了更合理的解决方案。

但是，如果您确实*确实*想在代码中嵌入文本文件，然后将其作为流读入，那么最简单的方法就是这样。

首先，将文本文件嵌入为字符串：

```
static const char *gdat="16\n"
"0.0950125098376374401853193354250\n"
"0.281603550779258913230460501460\n"
"0.458016777657227386342419442983\n"
"0.617876244402643748446671764049\n"
"0.755404408355003033895101194847\n"
"0.865631202387831743880467897713\n"
"0.944575023073232576077988415535\n"
"0.989400934991649932596154173450\n"
"\n"
"0.189450610455068496285396723209\n"
"0.182603415044923588866763667977\n"
"0.169156519395002538189312079058\n"
"0.149595988816576732081501730116\n"
"0.124628971255533872052476277863\n"
"0.0951585116824927848099251053810\n"
"0.0622535239386478928628438391746\n"
"0.0271524594117540948517805723700\n"; 
```

然后，您可以使用 stringstream(gdat) 而不是使用 ifstream("g.dat")，并获得一个流，就您的目的而言，它实际上是相同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T23:51:29.447

将其放入您初始化的双精度数组中。一般形式是

双倍 my_values[16] = { 1.234, 2.345, ... 等等 .. };

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T23:55:31.050

```
const double data[] = {
    0.0950125098376374401853193354250,
    0.281603550779258913230460501460 ,
    0.458016777657227386342419442983 ,
    0.617876244402643748446671764049 ,
    0.755404408355003033895101194847 ,
    0.865631202387831743880467897713 ,
    0.944575023073232576077988415535 ,
    0.989400934991649932596154173450 ,                                       
    0.189450610455068496285396723209 ,
    0.182603415044923588866763667977 ,
    0.169156519395002538189312079058 ,
    0.149595988816576732081501730116 ,
    0.124628971255533872052476277863 ,
    0.0951585116824927848099251053810,
    0.0622535239386478928628438391746,
    0.0271524594117540948517805723700
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T05:22:58.087

使用（或编写）一些程序，可能是一个小程序`awk`或脚本，将您的文件转换为*C*文件。`python``ocaml``g.dat`

 *修改您的构建过程（例如您的）以从原始文件`Makefile`中为生成的*C*`g.dat`文件添加依赖项。

编译生成的*C*文件，并将其链接到您的二进制文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T00:51:46.453

这将定义和初始化与您当前代码类似的`gt`和数组。`gc`请注意，这些不是动态分配的，因此您完成后不需要`delete[]`它们。

```
double gt[] =
{
     0.0950125098376374401853193354250, 0.281603550779258913230460501460,
     0.458016777657227386342419442983,  0.617876244402643748446671764049,
     0.755404408355003033895101194847,  0.865631202387831743880467897713,
     0.944575023073232576077988415535,  0.989400934991649932596154173450,
    -0.989400934991649932596154173450, -0.944575023073232576077988415535,
    -0.865631202387831743880467897713, -0.755404408355003033895101194847,
    -0.617876244402643748446671764049, -0.458016777657227386342419442983,
    -0.281603550779258913230460501460, -0.0950125098376374401853193354250
};

double gc[] =
{
    0.189450610455068496285396723209,  0.182603415044923588866763667977,
    0.169156519395002538189312079058,  0.149595988816576732081501730116,
    0.124628971255533872052476277863,  0.0951585116824927848099251053810,
    0.0622535239386478928628438391746, 0.0271524594117540948517805723700,
    0.0271524594117540948517805723700, 0.0622535239386478928628438391746,
    0.0951585116824927848099251053810, 0.124628971255533872052476277863,
    0.149595988816576732081501730116,  0.169156519395002538189312079058,
    0.182603415044923588866763667977,  0.189450610455068496285396723209
}; 
```*

# javascript - 页面加载/单击事件后，从 JS 文件 1 中的函数调用 JS 文件 2 中定义的函数失败

> ID：10729429
> 
> 赞同：0
> 
> 时间：2012-05-23T23:47:12.920
> 
> 标签：javascript, jquery

我有两个 Javascript 文件，我将大大简化以简化手头的问题。

`form.js`

```
function open_action_dialog(){
   // code to open the dialog..

   // If [Return] is pressed when focus is on the #action field, call the action confirmation function defined in the second javascript file.
   $('#action').keypress(function(e){
      var fn_name = "action_confirm";
      if(e.which == 13)
         window[fn_name]();
   });
} 
```

`blog.form.js`

```
$(function (){
   $("#dialog_action_open").click(function() { 
       open_action_dialog(); 
   });

   function action_confirm(){
     alert('action confirmed');
     return;
   }
}); 
```

因此，在我的页面上，我有一个带有 id 的按钮，`dialog_action_open`单击时会打开操作对话框；这是第二个文件中的函数，成功调用了第一个文件中的函数。

在对话框中，有一个带有 id 的输入文本字段`action`，我在其中设置了它，因此如果用户`[Return]`在光标聚焦在该字段上时按下，它应该调用`action_confirm()`第二个文件中定义的函数。它确实拾取了按键事件，但不从第二个文件中调用该函数；在 Google 的代码检查器中，错误是：

> 未捕获的类型错误：对象 [object Window] 的属性“action_confirm”不是函数

所以，我的问题是我需要做什么才能从第一个文件中的函数内部成功调用第二个文件中的函数？请记住，我知道您不能立即调用稍后定义的函数。但是，即使我的 action_confirm() 函数是在从第一个文件调用它的函数之后定义的，考虑到调用是在页面加载之后发生的，更具体地说是在页面上的点击事件之后发生的，这种技术性是否没有意义？

我将不胜感激。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:50:17.603

因为您尝试调用的函数被包装在另一个函数中，所以它对您的其他 JS 中的函数是不可见的。

你可以删除`$(function (){`（它正在关闭`});`）

# java - Java：将 keyListener 添加到已经可见的 JFrame

> ID：10729430
> 
> 赞同：1
> 
> 时间：2012-05-23T23:47:30.257
> 
> 标签：java, multithreading, jframe, sleep, keylistener

再次......我对keyListener 和JFrame 有另一个问题。我希望能够在 JFrame 可见时向 JFrame 添加 keyListener。我的问题是当我尝试这个时，keyListener 没有响应。这是我的代码：

```
public JFrame frame = new JFrame("JFrame Test");

public static void main(String[]args) {
    new JFrameTest();
}

public JFrameTest() {
    frame.setSize(100, 100);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setResizable(false);
    frame.setVisible(true);
    try {
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    frame.add(new space());
    frame.validate();
    frame.repaint();
}

@SuppressWarnings("serial")
public class space extends JPanel {
    public space() {
        setFocusable(true);
        addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
                System.out.println("Mouse Pressed!");
            }

            public void mouseReleased(MouseEvent e) {
                System.out.println("Mouse Released!");
            }
        });
        addKeyListener(new KeyAdapter() {
            public void keyPressed(KeyEvent e) {
                System.out.println("Key Pressed!");
            }

            public void keyReleased(KeyEvent e) {
                System.out.println("Key Released!");
            }
        });
    }
    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.fillRect(0, 0, frame.getWidth() / 2, frame.getHeight() / 2);
        repaint();
    }
} 
```

我延迟添加 keyListener 以表示用户按下按钮所需的时间，该按钮反过来会激活 keyListener。我知道睡眠不是问题，因为在我的大型项目中我有同样的问题，但这是在我等待 x 时间加载游戏空间后按下按钮之后。我不知道我是否正确地重新绘制和验证，但似乎没有人遇到这个问题。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:55:28.617

该问题可能与您使用[焦点子系统](http://docs.oracle.com/javase/tutorial/uiswing/misc/focus.html)的错误有关。

在[这个 StackOverflow 问题](https://stackoverflow.com/questions/2135223/obtaining-focus-on-a-jpanel)中，David 表明尽管面板设置正确，

> ... 小组不要求焦点。尝试使用 myPanel.requestFocus();

另外，[s](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)[上的 Java Tutorial`KeyListener`](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)提到

> 当用户按下或释放键盘键时，键事件由**具有键盘焦点的组件触发**

（强调补充）。

因此，`add(new space())`您应该：

```
space s = new space();
add(s);
s.requestFocus(); 
```

那应该可以解决您的问题。

# java - Mongodb Java Driver偶尔读取数据失败，socket超时

> ID：10729431
> 
> 赞同：4
> 
> 时间：2012-05-23T23:48:21.033
> 
> 标签：java, mongodb, playframework-2.0, socket-timeout-exception

我正在尝试使用 Java 的 Mongodb 驱动程序，我对这个偶尔出现的错误感到非常沮丧，尽管最一致的是，它出现在我第一次尝试连接到数据库时。任何关于在哪里寻找的帮助都会非常有帮助。

设置基本上是这样的：我在 localhost 上启动我的 Play 2.0 应用程序，我尝试在我的应用程序上注册一个用户。当我输入用户名时，会向数据库发送一个查询以检查用户名是否存在，这需要一秒钟（可能是实例化 Mongo 单例和连接到数据库的开销）但似乎有效，我可以成功执行几个查询，例如这个：

```
public static boolean usernameIsAvailable(String username){
    DBCollection users = DBManager.getDB("mojulo").getCollection("users");
    DBCursor cursor = users.find(new BasicDBObject("username", username));
    if(cursor.count() == 0)
        return true;
    return false;
} 
```

然后当我尝试插入用户时出现问题（总共大约 2kb 的数据）：

```
BasicDBObject new_user = new BasicDBObject();
new_user.put("username", username);
...
//connect to the database
DBCollection users = DBManager.getDB("mojulo").getCollection("users");

//check if the email is already registered
DBCursor cursor = users.find(new BasicDBObject("email", email));
if(cursor.count() != 0){
    emailIsRegistered = true;
}

//check if the username is available
if(!usernameIsAvailable(username)){
    usernameIsTaken = true;
}

//if the email or username are taken, return null
if(emailIsRegistered || usernameIsTaken){
    System.out.println("failed to create user:" + username);
    return null;
}
WriteResult result = users.insert(new_user);
if(result.getLastError().ok()){
    System.out.println("successfully created user:" + username);
    return userRandomKey;
}else return null; 
```

这偶尔会失败，但往往`if(result.getLastError().ok())`在线上失败。我真的无法解决这个问题，因为它会随机弹出。以下是堆栈跟踪通常的样子：

```
play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[Network: can't call something : ds033307.mongolab.com/107.20.129.238:33307/heroku_app4620908]]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:82) [play_2.9.1.jar:2.0]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:63) [play_2.9.1.jar:2.0]
at akka.actor.Actor$class.apply(Actor.scala:290) [akka-actor.jar:2.0]
at play.core.ActionInvoker.apply(Invoker.scala:61) [play_2.9.1.jar:2.0]
at akka.actor.ActorCell.invoke(ActorCell.scala:617) [akka-actor.jar:2.0]
at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:179) [akka-actor.jar:2.0]

Caused by: com.mongodb.MongoException$Network: can't call something : ds033307.mongolab.com/107.20.129.238:33307/heroku_app4620908
at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:227) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:305) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DB.command(DB.java:160) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DB.command(DB.java:183) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBCollection.getCount(DBCollection.java:864) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBCollection.getCount(DBCollection.java:835) ~[mongo-java-driver-2.7.3.jar:na]

Caused by: java.net.SocketException: Operation timed out
at java.net.SocketInputStream.socketRead0(Native Method) ~[na:1.6.0_31]
at java.net.SocketInputStream.read(SocketInputStream.java:129) ~[na:1.6.0_31]
at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) ~[na:1.6.0_31]
at java.io.BufferedInputStream.read1(BufferedInputStream.java:258) ~[na:1.6.0_31]
at java.io.BufferedInputStream.read(BufferedInputStream.java:317) ~[na:1.6.0_31]
at org.bson.io.Bits.readFully(Bits.java:35) ~[mongo-java-driver-2.7.3.jar:na] 
```

任何帮助将不胜感激，因为我无法真正弄清楚这里发生了什么，更有经验的人可能知道去哪里找。

一个可能也说明这一点的注意事项是，我尝试将更多数据加载到保存的对象中时，问题发生的频率越高。

谢谢！

# javascript - 运行 Javascript Asyn，这样页面就不会阻塞

> ID：10729440
> 
> 赞同：1
> 
> 时间：2012-05-23T23:49:40.663
> 
> 标签：javascript, html, ajax, jquery

我有一个需要很长时间才能运行的 Javascript 函数。我想显示一个加载图标，直到 javascript 函数返回，但是在函数加载时页面上什么也没有出现；页面是白色的，没有做任何事情。

如果我使用 Chrome 进行调试，我会在调用该函数之前看到我的加载图标，然后在调用它时它会消失。我以为我可以对包含 Javascript 的 PHP 页面进行 AJAX 调用，但 AJAX 响应实际上包含该 javascript...

```
$.ajax({
  type: "POST",
  url: "resources/scripts/loadXML.php",
  data: "datafile="data_file_path,
  success: function(msg){
    alert( "Data Saved: " + msg );
  }
}); 
```

我把它拿回来了。MSG 等于这个（实际上是页面中的脚本）。

```
<script type="text/javascript">

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET",<?php echo json_encode($data_file); ?>,false);
xmlhttp.send();
return xmlhttp;
</script> 
```

我只是不希望我的页面是白色的，它会加载该功能吗......有什么想法！？

**编辑：**

我想异步运行此代码，以免它阻塞我的页面。我想在这个函数运行时看到一个微调器。以前，它在同一页面上，因此我可以轻松地将文件设置为打开，但现在如果我进行异步调用，我需要将它放在另一个文件中。但是，我如何将参数传递给这个文件？！：

```
<script type="text/javascript">

if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.open("GET",**$NEEDTOGETTHEFILENAME**,false);
xmlhttp.send();
return xmlhttp;
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:52:05.263

添加一个`beforeSubmit`加载微调器或其他东西的处理程序，让用户知道页面正在加载。

```
$.ajax({
  type: "POST",
  url: "resources/scripts/loadXML.php",
  data: "datafile="data_file_path,
  beforeSubmit: function(){
        //show a spinner here
  },
  success: function(msg){
    //remove spinner
    alert( "Data Saved: " + msg );
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:00:56.647

由于您正在使用 jquery 进行请求，因此最简单的方法是将请求包装在

```
$(document).ready(function(){
  //show spinner
  //your ajax request here
} 
```

并在请求返回时隐藏或用您的内容替换微调器。

这就引出了一个问题：为什么要执行 1 个 ajax 请求来获取脚本来执行另一个 ajax 请求？你到底想在这里完成什么？

# scala - Scala 在生产环境中启动 Play 服务器

> ID：10729443
> 
> 赞同：7
> 
> 时间：2012-05-23T23:50:31.923
> 
> 标签：scala, playframework, playframework-2.0

我在 EC2 上部署了一个 Play 2.0 应用程序，我启动该应用程序`play start`并在后台运行，我可以点击`Ctrl-D`，该进程将继续在后台运行，但一段时间后它会死掉（15 或 20 分钟？），不知道为什么。我通常在启动应用程序后退出 ssh 会话，我希望这不是原因。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T08:17:19.037

`nohup play start`为我工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-26T17:04:46.947

我正在为我的 Play 应用程序使用以下启动脚本（在 CentOS 上），似乎工作正常，它将它放在后台以及它自己的进程组和会话中，因此它不受挂断等的影响。关于`play stage`并`target/start`来自[Guillaume的提示Bort](https://groups.google.com/forum/?fromgroups=#!topic/play-framework/BlV4c3q8hxE) and 是“正确的做法”。

```
#!/bin/bash
#
# chkconfig: 2345 98 1
# description: MyApp application
#

case "$1" in
start)
  su - apps <<'EOF'
cd /opt/myapp || exit 1
PATH=/opt/play-2.1.1:$PATH
echo "Starting MyApp..."
play stage 
setsid target/start < /dev/null > /dev/null 2>&1 & 
EOF
  ;;
stop)
  su - apps <<'EOF'
cd /opt/myapp || exit 1
PATH=/opt/play-2.1.1:$PATH
echo "Stopping MyApp..."
play stop
EOF
  ;;
esac 
```

您可以通过以下方式验证它是否已隔离：

```
ps -e -o user,pid,ppid,pgrp,sid,command | grep -i play 
```

你会看到类似的东西：

```
apps      2949     1  2949  2949 java -cp target/staged/* play.core.server.NettyServer target/.. 
```

含义`init`(pid `1`) 是它的父进程，它被隔离在自己的进程组 ( `2949`) 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T16:46:34.940

我建议您使用 activator（以前的 play）脚本使用的 stage 命令准备项目部署二进制文件。您可以在后台运行该二进制文件，它可以在下面代码中的第二个命令显示的路径中找到。

```
./activator stage
target/universal/stage/bin/project-name & 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T03:16:55.823

对于 play 2.2.3 ... play "start -Dhttp.port=8080" 为我工作！

# c++ - 获取向量c ++中的字符串计数

> ID：10729444
> 
> 赞同：2
> 
> 时间：2012-05-23T23:50:35.013
> 
> 标签：c++, string, stl, vector, count

我有这个向量

```
vector <string> data

data = ["this is", "data that", "is in", "this is", "vector", "vector", "vector"] 
```

如何获得一个向量（或二维数组）来删除重复项，而是为每个第 i 个条目计数？

IE

```
 results = [("this is", 2), ("data that", 1), ("is in", 1), ("vector", 3)] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T23:59:25.727

直接的解决方案是将唯一值及其计数累积到地图中：

```
std::map<std::string, std::size_t> results;
std::for_each(begin(data), end(data), [&](std::string const& s)
{
    ++results[s];
}); 
```

这具有线性 (n lg n) 时间复杂度，但因为它必须复制每个不同的字符串值，所以它可能相当昂贵。您还可以对列表进行就地排序，然后计算每个值的数量，如果您有一个移动感知的`std::string`.

# ruby - 如何计算 ruby 服务器中正在运行的线程

> ID：10729452
> 
> 赞同：13
> 
> 时间：2012-05-23T23:52:02.563
> 
> 标签：ruby, multithreading, sinatra

我想在 Sinatra Web 服务器的线程中执行“长时间运行”（执行大约需要 0.5 秒）任务。

网络响应大约需要 20 毫秒，所以如果我很忙，那么线程会堆积...

所以我想如果我很忙我会同步..

```
if (running_thread_count > 10)
    stuff_that_takes_a_second()
else
    Thread.new do
        stuff_that_takes_a_second()
    end
end 
```

你如何获得正在运行的线程数（我想要启动的线程数，但尚未完成运行） - 你如何编写 running_thread_count？

```
def running_thread_count
 return Thread.list.count
end 
```

还是我需要检查正在运行的线程？即当一个线程完成运行时，它会停止在 Thread.list 中返回吗？

我不想调用 join ，因为这会破坏目的 - 除非我们有很多线程在工作，否则会快速返回。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-24T05:00:29.923

这将给出处于“运行”状态而不是“睡眠”状态的线程数

```
def running_thread_count
  Thread.list.select {|thread| thread.status == "run"}.count
end 
```

# java - 在Java中，有没有办法合成特定频率的音调？

> ID：10729455
> 
> 赞同：7
> 
> 时间：2012-05-23T23:52:12.847
> 
> 标签：java, javasound, sound-synthesis

我正在做一些[双耳节拍](http://en.wikipedia.org/wiki/Binaural_beats)的工作，并正在尝试构建一个 Java 应用程序，它可以以*稍微*不同的频率播放两种声音......大约 25-30Hz 的差异。

在一个完美的世界里，我想给 Java 两个整数输入，比如 440 和 410，让 Java 播放一个 440Hz 的音调和一个 410Hz 的音调。

鉴于我在`javax.sound.*`课堂上看到的情况，Java 似乎只支持相当于钢琴音符...A4 @ 440Hz，然后是 A-sharp-4 @ 466.164Hz，而在另一个方向上，G-sharp-4 @ 415.305Hz。虽然“相邻”通常在产生双耳节拍的范围内，但我正在尝试对我的音调频率进行更多控制。

由于简单的音频合成只不过是频率、强度和时间长度，在我*看来*，在`javax.sound.*`课程的某个地方，有某种查找说明当我告诉 Java 播放“A4”时，那就是440赫兹。问题变成了是否有办法破解该表以说“A4.1”相当于449Hz。

我一直在搞砸`javax.sound.midi`，还没有探索过`javax.sound.sampled`；看来我需要对我的音调进行采样才能使用这些`sampled`课程；我更喜欢合成。如果我弄错了，请引导我。

我见过的大多数第三方界面都是专门针对音乐制作和操作的，因此，它们使用微音的能力有限。有没有人有解决方案的经验或建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:08:02.027

您可以使用中的类生成样本并将它们发送到声卡`javax.sound.sampled.*`；基本上创建一个软件振荡器。

它需要一些知识，但是当你开始工作时会很有趣；）

当我创建这个时，我正在玩这些分类：http: [//bobusumisu.net/testing/bobusynth-alpha1/](http://bobusumisu.net/testing/bobusynth-alpha1/)

这是让我入门的教程：[http ://www.drdobbs.com/jvm/230500178](http://www.drdobbs.com/jvm/230500178)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T20:44:09.140

这只是为了补充已经提供和接受的答案（我给了+1）。

You can use wavetables as an alternative to running trig functions on the fly--sort of half sampled/half synthesized. I also use a sine wave table with six independent cursors pointing into it for FM synthesis, and have duplicated several Yamaha DX7 patches this way. But this is all done via javax.sound.sampled. Once a soft-synth has been built, you might want to control it with the midi library classes.

Let's say you populate a 1K array with floats for a single sine wave.

If you "play" the wave table by incrementing and looping through it and extracting each array member in turn (to write to the sound card via a SourceDataLine), you will get a pitch directly related to your sample rate. For 44100 samples per second, the 1024-member array will cycle 44100/1024 = 43.066... times in to fill that "second" with data (a very low pitch--roughly 43 Hz). If you skip every second table member, the pitch is twice that, etc. To get the pitch 440, one needs to find the correct "increment" to use to step through the wave table array, which can be found: incr = (size of waveTable * desired pitch) / sample rate

For example (1024 * 440 ) / 44100 gives an increment of: 10.21678... Thus, if the first value from the waveTable is at array location 0, the second value to be used would be in between locations 10 and 11\. To get a value that lies in between two array locations, use linear interpolation.

I use this method, with javax.sound.sampled libraries, for a "Theremin" at this link. There is a keyboard displayed, but you can easily hear/see microtonal control as you move the mouse across the keys.

[http://www.hexara.com/VSL/JTheremin.htm](http://www.hexara.com/VSL/JTheremin.htm)

In the above, the mouse position (called via MouseMotionListener) is used to calculate desired pitch via this function:

```
return Math.pow(2, ((mouseX + tuningLoc) / (octaveWidth))); 
```

where octaveWidth is the number of pixels that covers an octave.

# sql - 结果为空时返回 0

> ID：10729460
> 
> 赞同：0
> 
> 时间：2012-05-23T23:53:10.600
> 
> 标签：sql, sql-server-2008

我有这样的声明：

```
SELECT  COUNT(AccedentId) AS NumberOfAccedentInYear
            FROM         Accident
            GROUP BY DriverId, YEAR(AccedentDate)
            HAVING     (DriverId =@DriverId)<3 
```

当有行时，我得到一个有效的计数，但是当没有行时，结果为空。当没有匹配的行时，我希望结果为 0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T23:57:57.400

也许你想要这个（我保留了明显的语法和拼写错误，如果没有更多信息我无法真正纠正）：

```
SELECT NumberOfAccedentInYear = ISNULL
(
  (SELECT COUNT(AccedentId)
   FROM         Accident
   GROUP BY DriverId, YEAR(AccedentDate)
   HAVING     (DriverId =@DriverId)<3))
   , 0
); 
```

对于任何对 COALESCE 与 ISNULL 讨论以及为什么我将答案更改为使用 ISNULL 感到好奇的人，@kanav 正确地指出 COALESCE 更昂贵。COALESCE 两次评估子查询，正如我在这里解释的那样：[https ://stackoverflow.com/a/10669660/61305](https://stackoverflow.com/a/10669660/61305)

# c# - ImageBox 图形错误

> ID：10729462
> 
> 赞同：0
> 
> 时间：2012-05-23T23:53:16.307
> 
> 标签：c#, visual-studio-2010, graphics

我正在尝试将多边形列表绘制到图像框。到目前为止，我只在屏幕的左上角看到一条对角黑线。要点如下：

20,20 0,20 20,0 40,40

200,100 0,20 20,0 20,20

100, 200 0, 200 200,0 250, 450

150,130 1,20 20,0 10,20

```
 private void pictureBox1_Paint_1(object sender, PaintEventArgs e)
    {
        int jobIndex = 0;
        int trussIndex = 0;

        Graphics g = e.Graphics;
        foreach (Member m in jobArray[jobIndex].trusses[trussIndex].members)
        {
            Point[] pointArray = new Point[m.poly.Points.Count()];
            //m.poly.Points.CopyTo(pointArray, 0);
            int index =0;
            foreach(System.Windows.Point p in m.poly.Points)
            {
                pointArray[index].X = (int)p.X;
                pointArray[index].Y = (int)p.Y;
                index++;
            }
            Pen myPen = new Pen(Color.Black);
            SolidBrush myBrush = new SolidBrush(m.color);

            g.DrawPolygon(myPen, pointArray);
            g.FillPolygon(myBrush, pointArray);

        }
    } 
```

关于为什么多边形没有出现在图像框上的任何想法？颜色不是问题，也不是盒子的大小

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:28:13.360

看起来您使用 Paint 事件来调用此方法，请确保在调用它时您有可用的数据。绘制事件不会经常调用，因此如果添加要绘制的数据，则需要调用 pictureBox1.Invalidate() 方法来强制绘制事件。

我相信您迟早会看到这一点，但您应该创建一个图像（位图）对象并将其分配给 PictureBox 的 Image 属性。然后使用 Graphics.FromImage(_image) 来获取您的图形对象。如果你不这样做，那么如果窗口被覆盖然后又回到焦点，或者你将它拖出屏幕然后再回来，你的图像就不会留下来。

```
private Bitmap _bitMap;
private Graphics _graphic;
Pen myPen;

public Constructor()
{
    _bitMap = new Bitmap(pictureBox1.Width,pictureBox1.Height);
    _graphic = Graphics.FromImage(_bitMap);
    pictureBox1.Image = _bitMap;
    myPen = new Pen(Color.Black);
}
private void DataAdded()
{
    int jobIndex = 0;
    int trussIndex = 0;

    foreach (Member m in jobArray[jobIndex].trusses[trussIndex].members)
    {
        //Pen myPen = new Pen(Color.Black); //Don't instantiate in a loop
        SolidBrush myBrush = new SolidBrush(m.color);
        _graphic.DrawPolygon(myPen, m.poly.Points.ToArray());
        _graphic.FillPolygon(myBrush, m.poly.Points.ToArray());
    }
    pictureBox1.Image = _bitMap; //Don't think you need this, but I don't remember
} 
```

希望这可以帮助

# android - Android广播接收器从短信关键字开始

> ID：10729477
> 
> 赞同：0
> 
> 时间：2012-05-23T23:56:04.527
> 
> 标签：android, text, sms, broadcastreceiver

如何设置关键字以从短信中启动广播接收器？我的广播接收器正常工作，问题是它在接收任何短信时开始活动，我只需要它开始接收 1 或 2 个关键字“酒店和/或房屋”我该怎么做......谢谢。下面是我的代码

-显现- ” ”

-实际接收器类-公共类 SMSReceiver 扩展 BroadcastReceiver {

```
public void onReceive(Context context, Intent intent) {
    Bundle bundle = intent.getExtras();

    Object messages[] = (Object[]) bundle.get("pdus");
    SmsMessage smsMessage[] = new SmsMessage[messages.length];
    for (int n = 0; n < messages.length; n++) {
        smsMessage[n] = SmsMessage.createFromPdu((byte[]) messages[n]);
    }

    //show first message
    Toast toast = Toast.makeText(context, "Received SMS: " + smsMessage[0].getMessageBody(), Toast.LENGTH_LONG);
    toast.show();

    //and then start an activity

    Intent i = new Intent(context,AppActivity.class);
    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(i); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:02:41.047

`BroadcastReceiver`侦听基于`<intent-filter>`. [数据](http://developer.android.com/guide/topics/manifest/data-element.html)过滤器不提供您要求的过滤类型，因为它不过滤`SmsMessage.getMessage()`. 除了收听 SMS 之外，您还可以扫描每条消息中的关键字，然后开始所需的活动。

# windbg - 为 Windbg 的 Open Executable 指定命令行

> ID：10729478
> 
> 赞同：22
> 
> 时间：2012-05-23T23:56:06.413
> 
> 标签：windbg

当我使用 Windbg 的“打开可执行文件...”功能使用 Windbg 来逐步执行可执行文件时，是否可以指定运行可执行文件时要使用的命令行参数？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-24T00:06:14.070

Open Executable 对话框中有一个可用的参数文本框，可以用您想要传递给可执行文件的任何参数填充该文本框。

![在此处输入图像描述](../Images/1650fdb40d2b13de23f730677c6ed845.png)

# java - 业务逻辑等决策树的设计建议

> ID：10729479
> 
> 赞同：0
> 
> 时间：2012-05-23T23:56:08.460
> 
> 标签：java, data-structures

我正在尝试设计数据结构以支持如下所示的数据，例如，根据第一行，如果 X<=15 和 Y<=78.00 和 X>625500 我需要将 Z 填充为某个值。

设计这个以使数据存储和检索高效且优雅的最佳方法是什么？树会起作用吗？

PS 我不想将此数据集存储在数据库中，但更喜欢将其存储在 java 数据结构中

谢谢一堆

    X Y Z
<= 15 <= 78.00 > 625,500
<= 15 <= 78.00 <= 625,500
<= 15 78.01 - 90.00 > 625,500
<= 15 78.01 - 90.00 <= 625,500
<= 15 > 90.00 > 5,500,500
<= 65,500 , <= 6.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T10:16:32.813

由于您的数据不是自定义结构，因此我认为将一行视为一个对象然后创建它的集合会更好。

例如：

```
Class Row{
<variables for X, Y, Z>
<getter setter for X, Y, Z>
}

List<Row> myTable .....

myTable.add(row1);
myTable.add(row2); 
```

现在有了这个，您可以直接访问您想要的任何行，只需执行 myTable.get(3) 即可获得第三行。现在在该对象中访问 XY 以计算 Z 并在该对象中设置。您可以创建 RowUtil.java 来放置 Z 计算的方法。

# c# - C# 多线程委托和事件

> ID：10729481
> 
> 赞同：0
> 
> 时间：2012-05-23T23:56:14.030
> 
> 标签：c#, events, delegates

我在理解从这里去哪里时遇到了一些麻烦——我开发了一个可以访问 SQL Express 数据库并通过 DataSet 操作它的表单。我还开发了一个类，它通过专有协议在多线程 TCP 服务器上侦听来自其他客户端的更新。

我需要做的是将这些更新更新到表单中，其中包含要更新的数据集实例。

我在这里查看了一些事件和委托帮助以及[本指南](http://www.akadia.com/services/dotnet_delegates_and_events.html)，起初看起来很方便，但遇到了许多这些示例所存在的相同问题 - 它们不太擅长准确地表达正在发生的事情，并且结束在两个类中使用相似的变量。

哪个类是“订阅者”，哪个是“发布者”？我真的很讨厌表单编程，并且会完全基于命令行来执行此操作，但它适用于一群计算机文盲，以至于他们可能会因不得不使用提示而遭受创伤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:40:52.683

发布者是其类声明事件的对象。例如，`DataTable`发布`RowChanged`事件。

处理事件的对象是订阅者。例如，具有 _table 字段的类可以订阅 RowChanged 事件（当然，假设存在处理方法）：

```
this._table.RowChanged += this.HandleRowChanged; 
```

有时，一个类可能会订阅它自己的事件。一个例子是 Windows 窗体的 Load 事件。这使用了不必要的开销，并且一些框架提供了虚拟方法以允许子类扩展基类的功能而无需创建事件委托。这就是为什么 Form 的 OnLoad 方法是虚拟的。

# java - Jersey 的依赖注入

> ID：10729482
> 
> 赞同：6
> 
> 时间：2012-05-23T23:56:24.513
> 
> 标签：java, jakarta-ee, dependency-injection, jersey

如果我使用 Jersey 1.12，并且我有多个资源类，并且它们都需要访问一些共享上下文，那么注入依赖项的最佳方法是什么，无论是在资源类的构造函数中还是在处理程序方法中？我需要使用外部 DI 库，还是 Jersey 有内置的东西？

即，Foos 的资源可能如下所示：

```
package com.example.resource;

import javax.ws.rs.GET;
import javax.ws.rs.Produces;
import javax.ws.rs.Path;

@Path("/some/api/path/foo")
public class FooResource
{
    @GET
    @Produces("text/html")
    public String getFoo(@QueryParam("id") String id)
    {
        Foo foo = /* get a Foo from some shared context based on id */
        /* Process foo into a String */
    }
} 
```

对于酒吧：

```
package com.example.resource;

import javax.ws.rs.GET;
import javax.ws.rs.Produces;
import javax.ws.rs.Path;

@Path("/some/api/path/bar")
public class BarResource
{
    @GET
    @Produces("text/html")
    public String getBar(@QueryParam("id") String id)
    {
        Bar bar = /* get a Bar from some shared context based on id */
        /* Process bar into a String */
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-26T06:42:26.810

我最终使用了 Google Guice，这是一个与 Jersey 很好地集成的轻量级 DI 框架。这是我必须做的：

首先，我在 pom.xml 中添加了依赖项：

```
 <dependency>
        <groupId>com.google.inject</groupId>
        <artifactId>guice</artifactId>
        <version>3.0</version>
        <scope>compile</scope>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey.contribs</groupId>
        <artifactId>jersey-guice</artifactId>
        <version>1.12</version>
        <scope>compile</scope>
    </dependency> 
```

我想要一个 DAO 实现为带有接口的单例：

```
public interface MySingletonDao
{
    // ... methods go here ...
} 
```

和一个具体的实现：

```
@Singleton
public class ConcreteMySingletonDao implements MySingletonDao
{
    // ... methods go here ...
} 
```

像这样装饰资源类：

```
@Path("/some/path")
@RequestScoped
public class MyResource
{
    private final MySingletonDao mySingletonDao;

    @Inject
    public MyResource(MySingletonDao mySingletonDao)
    {
        this.mySingletonDao = mySingletonDao;
    }

    @POST
    @Produces("application/json")
    public String post() throws Exception
    {
            // ... implementation goes here ...
    }
} 
```

创建了一个将执行绑定的类：

```
public class GuiceConfig extends GuiceServletContextListener
{
    @Override
    protected Injector getInjector()
    {
        return Guice.createInjector(new JerseyServletModule()
        {
            @Override
            protected void configureServlets()
            {
                bind(MyResource.class);
                bind(AnotherResource.class);
                bind(MySingletonDao.class).to(ConcreteMySingletonDao.class);
                serve("/*").with(GuiceContainer.class);
            }
        });
    }
} 
```

我使用 Jetty 而不是 Glassfish 来实际充当服务器。在我的功能测试中，这看起来像：

```
private void startServer() throws Exception
{
    this.server = new Server(8080);
    ServletContextHandler root =
        new ServletContextHandler(server, "/", ServletContextHandler.SESSIONS);

    root.addEventListener(new GuiceConfig());
    root.addFilter(GuiceFilter.class, "/*", EnumSet.of(DispatcherType.REQUEST));
    root.addServlet(EmptyServlet.class, "/*");

    this.server.start();
} 
```

来自`EmptyServlet`Sunny Gleason 的示例代码作为答案给出：[https](https://stackoverflow.com/a/3296467) ://stackoverflow.com/a/3296467——我最初有

```
root.addServlet(new ServletHolder(new ServletContainer(new PackagesResourceConfig("com.example.resource"))), "/*"); 
```

而不是线

```
root.addServlet(EmptyServlet.class, "/*"); 
```

但这导致 Jersey 尝试执行依赖注入而不是 Guice，这会导致运行时错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T04:58:40.407

您可以使用 SingletonTypeInjectableProvider：http: [//jersey.java.net/nonav/apidocs/1.12/jersey/com/sun/jersey/spi/inject/SingletonTypeInjectableProvider.html](http://jersey.java.net/nonav/apidocs/1.12/jersey/com/sun/jersey/spi/inject/SingletonTypeInjectableProvider.html)

样本：

```
ResourceConfig resourceConfig = new DefaultResourceConfig();
resourceConfig.getSingletons().add(
        new SingletonTypeInjectableProvider<Context, SingletonType>(
               SingletonType.class, new SingletonType()) {});{code} 
```

或者您可以创建 SingletonTypeInjectableProvider 后代，使用 @Provider 对其进行注释将其添加为类。你可以在任何你需要的地方以及标准 Jersey 注入的地方注入提供的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:08:17.020

有一个 jersey-spring 项目支持 Spring 依赖注入。用 SpringServlet 替换您的球衣 ServletContainer，将 ContextLoaderListener 添加到您的 web.xml，然后您可以将 bean 注入您的组件中。这是一个相当不错的设置演练

[http://www.mkyong.com/webservices/jax-rs/jersey-spring-integration-example/](http://www.mkyong.com/webservices/jax-rs/jersey-spring-integration-example/)

编辑

这是一个不需要添加任何依赖项的想法。创建您自己的 ServletContextListener，将您的对象添加到 ServletContext。然后将 ServletContext 注入到您的资源中

```
public class MyContextListener implements ServletContextListener
{

    @Override
    public void contextDestroyed(ServletContextEvent event)
    {
    }

    @Override
    public void contextInitialized(ServletContextEvent event)
    {
        ServletContext context = event.getServletContext();
        context.setAttribute(Foo.class.getName(), new FooImpl());
    }

} 
```

然后在您的资源中

```
@Path("blah")
public class MyResource 
{
   private Foo foo;

   public MyResource(@Context ServletContext context)
   {
      foo = (Foo) context.getAttribute(Foo.class.getName());
   } 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-18T16:37:57.927

除非您愿意，否则您不必使用外部库。有据可查的是，让 CDI 与 Jersey 正常工作目前是一件痛苦的事情。但是，我可以从经验中说，我自己可以做到这一点。自从我跳过这些障碍已经有一段时间了，但我似乎记得我们必须制作我们的资源无状态 EJB 才能让它工作。我可能采取了其他步骤，但我现在不记得了。

当 Jersey 2.0 出现时，这应该会变得容易得多，因为他们将切换到使用 Core CDI 实现而不是他们自己的实现。有关更多信息，请参阅此错误：

[http://java.net/jira/browse/JERSEY-517](http://java.net/jira/browse/JERSEY-517)

# c++ - 库 C 头文件在 Linux 上的去向

> ID：10729484
> 
> 赞同：8
> 
> 时间：2012-05-23T23:56:52.593
> 
> 标签：c++, c, header, apt-get

尴尬的基本问题。 `sudo apt-get install libmemcached6`- .h 和 .o 或 .so 在 Linux 机器 (Ubuntu) 上的典型安装中位于何处？而且，我如何确保 g++ 可以接收它们？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T00:00:06.243

他们去 /usr/include 和 /usr/lib。如果您使用 -l 选项（用于库），它应该从这些标准位置找到它们。如果你包括使用`<file.h>`它也应该从正确的地方得到它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-24T00:10:02.990

在 Ubuntu（和其他 Debian 变体）上，您可以使用该`dpkg`命令进行查找。例如：

```
$ dpkg -L libxml2
/.
/usr
/usr/share
/usr/share/doc
/usr/share/doc/libxml2
/usr/share/doc/libxml2/AUTHORS
/usr/share/doc/libxml2/NEWS.gz
/usr/share/doc/libxml2/TODO.gz
/usr/share/doc/libxml2/copyright
/usr/share/doc/libxml2/README
/usr/share/doc/libxml2/changelog.Debian.gz
/usr/share/doc/libxml2/README.Debian
/usr/lib
/usr/lib/libxml2.so.2.7.8
/usr/lib/libxml2.so.2 
```

如您所见，Debian 软件包通常不包含这些`.h`文件。这些通常在相应的`-dev`包中。所以你可以在这里找到头文件：

```
$ dpkg -L libxml2-dev
/.
/usr
/usr/share
/usr/share/doc
/usr/share/doc/libxml2-dev
/usr/share/doc/libxml2-dev/AUTHORS
/usr/share/doc/libxml2-dev/NEWS.gz
/usr/share/doc/libxml2-dev/TODO.gz
/usr/share/doc/libxml2-dev/copyright
/usr/share/doc/libxml2-dev/README
/usr/share/doc/libxml2-dev/changelog.Debian.gz
/usr/share/aclocal
/usr/share/aclocal/libxml2.m4
/usr/share/man
/usr/share/man/man3
/usr/share/man/man3/libxml.3.gz
/usr/share/man/man1
/usr/share/man/man1/xml2-config.1.gz
/usr/include
/usr/include/libxml2
/usr/include/libxml2/libxml
/usr/include/libxml2/libxml/HTMLtree.h
/usr/include/libxml2/libxml/tree.h
/usr/include/libxml2/libxml/xmlreader.h
/usr/include/libxml2/libxml/xmlschemastypes.h
... 
```

至于`gcc`，[手册](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)解释了它如何搜索头文件。[请注意，这与使用`-l`来指示链接器链接到某个库](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)是不同的并且是分开的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-05T07:22:07.077

在 Linux 和大多数基于 Unix 的系统上，可以在以下两个位置之一找到库：

1.  /usr/lib/
2.  /usr/local/lib/

这两个位置的区别在于后者用于第三方库。因此，如果您已经发布了自己的库或从第三方存储库（例如 ppa）安装了一个库，那么这些文件应该转到`/usr/local/lib`.

头文件的存储可以通过上面的类比来理解。文件夹是：

1.  /usr/包括/
2.  /usr/本地/包括/

# c# - MVC 项目中的 MVC 项目

> ID：10729485
> 
> 赞同：0
> 
> 时间：2012-05-23T23:57:21.737
> 
> 标签：c#, windows, model-view-controller, iis

在 IIS 上，我可以为我的 MVC 项目创建一个站点，称之为 Foo。

设置好后，我可以右键单击它并“添加虚拟目录”栏。

如果我尝试将 Bar 设为虚拟目录，我会收到一条错误消息，提示可能这需要是一个应用程序。

所以我右键单击并使 Bar 成为一个应用程序。还是不行。

问题是 Foo 和 Bar 的 web.config 有冲突，说我的连接字符串之一已经定义。

看来我不能这样做`<location path="." inheritInChildApplications="false">`，因为在配置设置上使用它是无效的。

我唯一的另一个想法是在 Bar 中创建一个 web.release.config 文件，并删除所有与 Foo 冲突的东西。这看起来很乏味并且容易出错。

关于如何让我的网址看起来像我想要的那样有什么建议（www.foo.com/Bar）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:07:53.243

吧只是一个目录？

您需要使用命名空间。一旦定义了命名空间，它们就不会使编译器在对象上发生冲突。然后在 IIS 中，您无需执行任何操作，只需将 foo 设为您的应用程序。

```
namespace BarSpace {

    [classes/code]
}

namespace FooSpace {

 [classes/code]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:22:48.740

我建议在子 web.config 中的`<clear />`任何标签之前添加一个标签。`<add ... />`这将删除所有继承的添加字段，包括清除标记之前的每个添加字段。

这应该适用于 ConnectionStrings、AppSettings 等。基本上所有依赖于`<add ... />`标签的东西。

```
<!--FOO web.config-->
<connectionStrings>
   <add name="DataBase1" connectionString="..." providerName="..." />
   <add name="DataBase2" connectionString="..." providerName="..." />
</connectionStrings>

<!--BAR web.config-->
<connectionStrings>
   <clear />
   <add name="DataBase1" connectionString="..." providerName="..." />
   <add name="DataBase2" connectionString="..." providerName="..." />
</connectionStrings> 
```

# java - 从多个 JAR 动态加载类

> ID：10729496
> 
> 赞同：1
> 
> 时间：2012-05-23T23:58:45.090
> 
> 标签：java, class, dynamic, loading, classloader

考虑以下简单方法（尝试）加载特定名称的所有类，驻留在位于指定路径的 JAR 文件中，即

```
public static List<Class<?>> getAllClasses(String name, String path)
{
    File file = new File(path);

    try
    {
        URL url = file.toURI().toURL();

        URLClassLoader loader = URLClassLoader.newInstance(new URL[] {url});

        JarFile jar = new JarFile(file);

        Enumeration<JarEntry> entries = jar.entries();

        Class<?> type;

        String elementName;

        List<Class<?>> classList = new ArrayList<Class<?>>();

        while (entries.hasMoreElements())
        {
            elementName = entries.nextElement().getName();

            if (elementName.equals(name))
            {
                try
                {
                    type = loader.loadClass(elementName);
                    classList.add(type);
                }
                catch (Exception e)
                {
                }
            }
        }

        return classList;
    }
    catch (Exception e)
    {
    }

    return null;
} 
```

如果路径中有超过 1 个 JAR，每个 JAR 至少有一个类与已加载的类具有相同的规范名称，例如`org.whatever.MyClass`，有没有办法在没有自定义类加载器的情况下加载所有`org.whatever.MyClass`类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:11:57.990

没有类只加载一次，类的键是 Classloader+Fully Qualified Class Name。它将检查缓存和类加载器链，如果找到该类，它将不会尝试再次加载它。选择哪一个是特定于实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:25:59.310

标准类加载器在单个命名空间中加载类。如果您正在从不同版本的实现中寻找相同类的实例，那么您必须使用自定义类加载器。您的代码片段是自定义加载的示例。

您可以参考[***这里***](http://www.devx.com/Java/Article/31614/1954)发表的详细文章。

# javascript - bgColor 未通过 JavaScript 更新

> ID：10729498
> 
> 赞同：2
> 
> 时间：2012-05-23T23:59:00.427
> 
> 标签：javascript

为什么div的背景颜色不更新？

```
Tagger.prototype.mouseDown = function(event) {
  this.element.style.posLeft = event.clientX;
  this.element.style.width = 200 + "px";
  this.element.style.height = 200 + "px";
  this.element.style.position = "absolute";
  this.element.style.zIndex = 10;
  this.element.style.bgColor = "yellow";
  console.log(this.element);
  console.log(this.element.style.bgColor);
} 
```

控制台输出为：

```
<div id="tagbox4" class="tagbox" style="width: 200px; height: 200px; position: absolute; z-index: 10;">
yellow 
```

我可以通过检查浏览器中的元素来选择 div，但它没有背景颜色，即使控制台说它是“黄色”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:00:23.997

它不是 bgColor，这是一种在 CSS 不流行时设置背景颜色的过时方式。

您想设置 CSS 属性[background-color](https://developer.mozilla.org/en/CSS/background-color)。当您使用 JavaScript 设置它时，您删除破折号并使用 camelCase。所以你要设置背景颜色。

```
this.element.style.backgroundColor 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T00:01:02.823

该[css 属性的名称是`backgroundColor`](http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSS2Properties-backgroundColor)，而不是`bgColor`。

您的控制台说`"yellow"`，因为它读取`bgColor`属性 - 这不会影响显示 - 并且也不包含在您使用元素源记录的样式属性中。

# php - is_page() 使用模板文件显示不同的 wordpress 帖子内容

> ID：10729500
> 
> 赞同：0
> 
> 时间：2012-05-23T23:59:15.247
> 
> 标签：php, html, wordpress, templates, customization

我正在尝试使用 *is_page()* 来显示以在单个模板文件中显示 2 个不同的内容。我的代码看起来像

```
<?php

    if ( is_page('news') ) {

        // Insert HTML/PHP for News - code shown below
    }
    else ( is_page('review') ){

         // Insert HTML/PHP for Review - code shown below
    }
?> 
```

这对我不起作用......不知道为什么？我已经显示了我尝试在下面插入的新闻/评论代码

新闻的 HTML/PHP

```
<div class="news">
  <?php query_posts('cat=-89');?>
  <?php while ( have_posts() ) : the_post(); ?>
  <article class="summary">
    <div class="content_wrap cont_page ">
      <header>
        <h2> <a href="<?php echo get_permalink(); ?>"><?php echo get_the_title(); ?> </a></h2>
        <p> <span class="author">
          <?php the_author() ?>
          </span><br />
          <span class="date">
          <?php the_date(); ?>
          </span> 
      </header>
      <div class="entry-content">
        <?php the_excerpt(); ?>
               <?php include('share.php')?> 
      </div>
      <aside class="right">
        <?php the_post_thumbnail(); ?>
      </aside>
    </div>
  </article>
  <?php
  <?php endwhile; ?>
</div> 
```

用于审查的 HTML/PHP

```
<div class="review">
  <?php query_posts('cat=89,246,247,248');?>
  <?php while ( have_posts() ) : the_post(); ?>
  <article class="summary 
  <?php

  // Custom posts stylings
if ( has_post_format( 'video' )) {
    echo 'video';
} elseif ( in_category('orange') ) {
    echo 'orange';
} else {
    echo 'white';}
?>

  ">
    <div class="content_wrap cont_page ">
      <div class="entry-content">
        <?php  if ( has_post_format( 'video' )) {
    // Get the video URL and put it in the $video variable
                        $videoID = get_post_meta($post->ID, 'video_url', true);
                        // Echo the embed code via oEmbed
                        echo '<iframe src="http://player.vimeo.com/video/'.$videoID.'?title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff" width="405" height="285" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'; 
                    //  echo '<iframe src="http://player.vimeo.com/video/'.$videoID.'" width="405" height="285" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';
            }
                else the_post_thumbnail();

 ?>
      </div>
      <aside class="right">
        <header>
          <h2> <a href="<?php echo get_permalink(); ?>"><?php echo get_the_title(); ?> </a></h2>
        </header>
        <div class="entry-content">
          <?php the_excerpt(); ?>
        </div>
        <?php include('share.php')?>
      </aside>
    </div>
  </article>
  <?php

// DISABLED/S default format

// get_template_part( 'content', get_post_format() ); ?>
  <?php endwhile; ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:04:02.767

使用页面 ID 作为 is_page() 的参数更准确。您可能会在某个时候编辑页面名称，然后您的代码将失败。

```
if(is_page(10)) { 
    // do something
  } else if (is_page(20)) {
    // do something
  } else { 
    // do something else
} 
```

我很确定这是一个错字，但下面的行应该是**else if**：

```
else ( is_page('review') ){ 
```

此外，在这两个模板之后，您还有额外的开放式 php 大括号。

# php - php wordpress 通过 id 获取帖子并在每个页面上制作特色部分

> ID：10729510
> 
> 赞同：1
> 
> 时间：2012-05-24T00:00:30.723
> 
> 标签：php, wordpress

我最近刚刚编写了一个特色部分，该部分实际上将拉出它在数组中指定的位置。这是代码

```
<div class="container_24">
<ul id="featured_posts" class="grid_24">

<?php $thePostIdArray = array("13968","14293", "15018", "15512"); ?>
<?php $limit = 4 ?>
<?php if (have_posts()) : ?>
<?php while (have_posts()) : the_post(); $counter++; ?>
<?php if ( $counter < $limit + 1 ): ?>

<?php $post_id = $thePostIdArray[$counter-1]; ?>
<?php $queried_post = get_post($post_id); ?>
 <li class="featured_post">
    <div class="featured_thumbnail"> <a href="<?php echo get_permalink( $post_id ); ?>"><img width="55" height="55" src="<?php echo img_feature($post_id) ?>" class="attachment-featured-small wp-post-image" alt="<?php echo $queried_post->post_title; ?>"></a></div>
    <div class="featured_title">
      <h2><a href="<?php echo get_permalink( $post_id ); ?>"><?php echo $queried_post->post_title; ?></a></h2>
    </div>
  </li>

<?php endif; ?>
<?php endwhile; ?>
<?php endif; ?>

</ul>
</div> 
```

现在这段代码可以完美地运行在任何有循环的页面上`home`，并且它会按预期显示特色帖子，但是它不会在任何其他没有类似循环的页面上显示的问题或任何其他页面就像没有帖子的单页。`archive``post``4``post``single.php``contact page`

我不知道我是否在上面做错了什么，我已经在其中包含了这个`header`，假设显示到所有包含的页面，`header`问题是只显示第一个，而不是其余的就像循环只运行一次并停止。

如果我做错了什么，请指出我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:46:48.303

使用如下的 foreach 循环。

```
<div class="container_24">
<ul id="featured_posts" class="grid_24">

<?php $thePostIdArray = array("13968","14293", "15018", "15512"); ?>
<?php foreach ($thePostIdArray as $post_id) : ?>
    <?php $queried_post = get_post($post_id); ?>
     <li class="featured_post">
        <div class="featured_thumbnail"> <a href="<?php echo get_permalink( $post_id ); ?>"><img width="55" height="55" src="<?php echo img_feature($post_id) ?>" class="attachment-featured-small wp-post-image" alt="<?php echo $queried_post->post_title; ?>"></a></div>
    <div class="featured_title">
        <h2><a href="<?php echo get_permalink( $post_id ); ?>"><?php echo $queried_post->post_title; ?></a></h2>
    </div>
  </li>
 <?php endforeach; ?>

</ul>
</div> 
```

# django - 需要自定义模型字段=ModelForm 上的 False

> ID：10729516
> 
> 赞同：0
> 
> 时间：2012-05-24T00:01:31.313
> 
> 标签：django, django-models, django-forms

我有以下自定义模型字段：

```
script = S3EnabledFileField(bucket=settings.MEDIA_BUCKET, upload_to=...) 
```

在我的 forms.py 中，我使用的是 ModelForm：

```
class CreateProductionForm(ModelForm):
    name = forms.CharField(required=True)

class Meta:
    model = Production
    fields = ('name', 'script') 
```

这使得`script`一个必填的表单字段。我如何使脚本成为可选字段（我不知道如何为自定义模型字段定义表单字段）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:05:13.340

更改模型而不是表单，然后添加`blank=True`：

```
script = S3EnabledFileField(bucket=settings.MEDIA_BUCKET, upload_to=..., blank=True) 
```

# .net - 创建的表单是不可见的

> ID：10729521
> 
> 赞同：0
> 
> 时间：2012-05-24T00:02:43.963
> 
> 标签：.net, winforms

我有一个非常简单的表格。当我在它上面调用 Show() 时，它不会显示。

1.  它位于任务栏中，并在任务栏中停留在它上面，在任务栏弹出窗口中显示窗口。
2.  Location 为 0, 0（以便于查找）。
3.  尺寸是 128、98，所以它有一个尺寸。
4.  如果我在同一个地方创建任何其他表单并在其上调用 Form.Show() - 它可以工作。

这让我发疯了。有任何想法吗？

**更新：**减少了关键代码的示例（对于犯此错误的其他人）：

```
 namespace AutoTagCore.net.windward.autotag.controls.start_here
    {
        partial class TemplatePopUp
        {

            private void InitializeComponent()
            {
...
                this.Opacity = 0D;
...
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:08:37.487

`DevExpress.XtraEditors.LabelControl()`在使用它之前，您是否需要进行某种形式的许可调用。

对于 XCeed 组件，您必须先在主程序启动中调用 Xceed.Grid.Licenser.LicenseKey，然后再尝试使用它们。这可能与您的 DevExpress 东西有关吗？

找到了：

这是你的不透明度。

你有

```
this.Opacity = 0D; 
```

应该

```
this.Opacity = 1D; 
```

# c++ - 为什么提升范围内的指针

> ID：10729522
> 
> 赞同：10
> 
> 时间：2012-05-24T00:02:58.417
> 
> 标签：c++, boost, scoped-ptr

作用域指针的目标是什么？据我了解，作用域指针管理代码块中的内存。如果我想在一个块中声明一个变量，我可以在堆栈上声明它而不用担心清理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:31:05.133

与基于堆栈的数据不同，scoped_ptr 有一个 reset() 成员——换句话说，您可以根据自己的意愿构建/破坏。有了这个，您可以使用空指针（技术上`operator unspecified-bool-type`）作为指示在任何给定时间是否存在构造对象的标志。如果需要，它还允许您独立于变量范围对构造/销毁进行排序。

此外，请考虑您可以将 scoped_ptr 声明为类成员，而不仅仅是作为堆栈变量。[文档](http://www.boost.org/doc/libs/1_36_0/libs/smart_ptr/scoped_ptr.htm#Handle/Body)建议使用scoped_ptr 来实现句柄/主体习语（隐藏类的实现细节）。

最后，为了详细说明 DeadMG 的观点“Not if it's of dynamic type”，您可以使用 scoped_ptr 来实现[多态](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)操作：

```
{
scoped_ptr<Base> a( mode ? new DerivedA : new DerivedB );
a->polymorphic_function();
} 
```

*使用简单*的基于堆栈的分配实际上不可能做到这一点。

* * *

另请参见此处：[C++0x unique_ptr replaces scoped_ptr getting Ownership？](https://stackoverflow.com/questions/3019512/c0x-unique-ptr-replaces-scoped-ptr-taking-ownership)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T00:06:49.383

如果它是动态大小或类型，则不是。此外，作用域指针可以交换，并且在 C++11`unique_ptr`中可以移动，因此它们不是严格作用域的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T00:06:32.793

关键是您可以在某个词法范围内创建和清理指针。`delete`这在各种情况下都很有用，它通过忘记是否显式使用来确保没有内存泄漏，`new`这是不推荐的。

您应该记住，它`boost::scoped_ptr`是**不可复制**的，因此在它的整个生命周期内完全拥有它的资源。这也使它变得更安全`boost::shared_ptr`，因为它避免了复制资源或意外共享它。

```
{ //Some Scope

  boost::scoped_ptr<int> i_ptr;
  // do something with pointer

} // leave scope, pointer is cleaned up 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T00:08:33.023

通常线程堆栈有内存限制（参见线程堆栈大小）。

有时，指针可能已从外部传递给您，需要在此范围内删除（例如，如果抛出异常，则不会执行该行下方的任何删除调用）。所以你需要某种方式自动清理指针

```
void foo(Object*obj)
{
    //this will ensure that object gets cleaned up even if doFoo() throws an exception
    boost::scoped_ptr<Object> objCleaner(obj);
    obj->doFoo();
} 
```

# php - 哪些字符可以作为简码标签，我应该为它们使用什么过滤器？

> ID：10729525
> 
> 赞同：1
> 
> 时间：2012-05-24T00:03:15.197
> 
> 标签：php, wordpress, filter, sanitization, shortcode

我正在开发一个插件，用户可以在其中定义短代码标签。你会建议允许什么，我的想法是只允许 ascii 字符。

另外，你如何清理输入？我在想也许`stip_tags`然后正则表达式只允许`a-z, 0-9`还是有更好的解决方案？也许wordpress过滤器会起作用？或者我可以使用过滤器 wordpress 用于蛞蝓？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:15:20.963

**this-is-a-good-slug** 表示您还必须允许使用连字符 (-)

在此之后，您需要调用以下命令：

```
$string = preg_replace("/[^a-z0-9_\s-]/","",$string);    // strip away everything except a-z,0-9 and hyphen
$string = preg_replace("/[\s-]+/"," ",$string);     // clean multiple dashes or whitespaces
$string = preg_replace("/[\s_]/","-",$string);           // convert whitespaces and underscore to dash 
```

当心; 您还需要将 UTF8 字符更改为 ascii/latin，这意味着您需要将包含此类字符的其他语言[音译](https://stackoverflow.com/questions/1284535/php-transliteration)。

# delphi - OpenGL 快速闪烁问题 - 现在不显示图像

> ID：10729526
> 
> 赞同：3
> 
> 时间：2012-05-24T00:03:15.327
> 
> 标签：delphi, opengl, delphi-xe2, flicker

我在使用 OpenGL 时遇到了一些问题。首先，我有一个正在构建的自定义控件，它封装了 OpenGL。我遇到了快速闪烁的问题，就像它在“闪烁”一样。该控件太大且太复杂，无法在此处发布，因此我制作了一个新的小型演示应用程序来演示和重新创建相同的场景。

现在的问题：我没有得到任何图像。在我的自定义控件中情况会很好，但由于我已经复制了代码并将其剥离到一个小型演示应用程序中，因此它不会显示图像。所以这里我有两个问题：闪烁（或闪烁），现在图像甚至没有显示。闪烁在过去没有发生，但在一些主要的代码修改后，它开始闪烁。代码更改太多，无法解释具体更改了什么，几乎所有内容。

背景显示，所以我知道它正在绘制一些东西（它是彩色的）。出于演示目的，它应该只绘制一个立方体，但我什么也没看到。我不得不将它从大约 1,000 行代码减少到甚至不到 300 行。

这不是您通常所说的闪烁，它实际上更像是一种闪烁或闪烁，想象一下汽车闪光灯的闪烁。这肯定与计时器有关，因为我设置的计时器间隔越长，它闪烁的速度就越慢。

为什么我什么都没看到？一旦解决了这个问题，为什么它会闪烁这么多？

这是一个表单的代码，不需要 DFM：

```
unit uMain;

interface

uses
  Winapi.Windows, Winapi.Messages, Winapi.OpenGL,
  System.SysUtils, System.Variants, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls;

type
  TForm1 = class(TForm)
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure FormResize(Sender: TObject);
  private
    FDrawing: Bool;
    FDC: HDC;
    FRC: HGLRC;
    FDL: glUint;
    FTimer: TTimer;
    procedure Draw;
    procedure SetDC(const Value: HDC);
    procedure SetRC(const Value: HGLRC);
    procedure SetDL(const Value: glUint);
  public
    property DC: HDC read FDC write SetDC;
    property RC: HGLRC read FRC write SetRC;
    property DL: glUint read FDL write SetDL;
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
var
  PixelFormat: glUint;
  pfd: TPIXELFORMATDESCRIPTOR;
begin
  FDrawing := False;
  FDC := GetDC(Handle);
  with pfd do begin
    nSize := SizeOf(TPIXELFORMATDESCRIPTOR);
    nVersion := 1; // The version of this data structure
    dwFlags := PFD_DRAW_TO_WINDOW // Buffer supports drawing to window
      or PFD_SUPPORT_OPENGL // Buffer supports OpenGL drawing
      or PFD_DOUBLEBUFFER; // Supports double buffering
    iPixelType := PFD_TYPE_RGBA; // RGBA color format
    cColorBits := 32; // OpenGL color depth
    cRedBits := 0; // Number of red bitplanes
    cRedShift := 0; // Shift count for red bitplanes
    cGreenBits := 0; // Number of green bitplanes
    cGreenShift := 0; // Shift count for green bitplanes
    cBlueBits := 0; // Number of blue bitplanes
    cBlueShift := 0; // Shift count for blue bitplanes
    cAlphaBits := 0; // Not supported
    cAlphaShift := 0; // Not supported
    cAccumBits := 0; // No accumulation buffer
    cAccumRedBits := 0; // Number of red bits in a-buffer
    cAccumGreenBits := 0; // Number of green bits in a-buffer
    cAccumBlueBits := 0; // Number of blue bits in a-buffer
    cAccumAlphaBits := 0; // Number of alpha bits in a-buffer
    cDepthBits := 16; // Specifies the depth of the depth buffer
    cStencilBits := 0; // Turn off stencil buffer
    cAuxBuffers := 0; // Not supported
    iLayerType := PFD_MAIN_PLANE; // Ignored
    bReserved := 0; // Number of overlay and underlay planes
    dwLayerMask := 0; // Ignored
    dwVisibleMask := 0; // Transparent color of underlay plane
    dwDamageMask := 0; // Ignored
  end;
  PixelFormat := ChoosePixelFormat(FDC, @pfd);
  SetPixelFormat(FDC, PixelFormat, @pfd);
  FRC := wglCreateContext(FDC);
  wglMakeCurrent(FDC, FRC);
  FormResize(nil);
  wglMakeCurrent(FDC, FRC);
  glClearColor(0.8, 0.8, 0.9, 0.0);
  glShadeModel(GL_FLAT);
  glClearDepth(1.0);
  glEnable(GL_DEPTH_TEST);
  glDepthFunc(GL_LESS);
  glEnable(GL_ALPHA_TEST);
  glAlphaFunc(GL_GREATER, 0.4);
  glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
  glEnable(GL_BLEND);
  glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
  glEnable(GL_TEXTURE_2D);
  glNewList(FDL, GL_COMPILE);
    glBegin(GL_QUADS);
      // Front Face
      glTexCoord2f(0.0, 0.0);
      glVertex3f(-2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(-2.0, 1.0, 1.0);
      // Back Face
      glTexCoord2f(2.0, 0.0);
      glVertex3f(-2.0, -1.0, -1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(-2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, -1.0);
      // Top Face
      glTexCoord2f(0.0, 1.0);
      glVertex3f(-2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(-2.0, 1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
      // Bottom Face
      glTexCoord2f(2.0, 1.0);
      glVertex3f(-2.0, -1.0, -1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, -1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(-2.0, -1.0, 1.0);
      // Left Face
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, -1.0);
      glTexCoord2f(1.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(1.0, 1.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
    glEnd();
  glEndList();
  FTimer:= TTimer.Create(nil);
  FTimer.OnTimer:= Timer1Timer;
  FTimer.Interval:= 100;
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  FTimer.Free;
  if (not wglMakeCurrent(FDC, 0)) then
    MessageBox(0, 'Release of DC and RC failed!', 'Error', MB_OK or MB_ICONERROR);
  if (not wglDeleteContext(FRC)) then begin
    MessageBox(0, 'Release of rendering context failed!', 'Error', MB_OK or MB_ICONERROR);
    FRC := 0;
  end;
  if ((FDC > 0) and (ReleaseDC(Handle, FDC) = 0)) then begin
    MessageBox(0, 'Release of device context failed!', 'Error', MB_OK or MB_ICONERROR);
    FDC := 0;
  end;
end;

procedure TForm1.Draw;
var
  I: Integer;
begin
  if not FDrawing then begin
    FDrawing := TRUE;
    try
      glClear(GL_COLOR_BUFFER_BIT or GL_DEPTH_BUFFER_BIT);
      glEnable(GL_NORMALIZE);
      glShadeModel(GL_FLAT);
      glCullFace(GL_BACK);
      glLoadIdentity;
      glPushMatrix();
      glCallList(DL);
      glPopMatrix();
      SwapBuffers(wglGetCurrentDC);
    finally
      FDrawing := False;
    end;
  end;
end;

procedure TForm1.FormResize(Sender: TObject);
begin
  glViewport(0, 0, Width, Height);
  glMatrixMode(GL_PROJECTION);
  glLoadIdentity();
  gluPerspective(45.0, Width / Height, 0.1, 500.0);
  glMatrixMode(GL_MODELVIEW);
  glLoadIdentity();
end;

procedure TForm1.SetDC(const Value: HDC);
begin
  FDC := Value;
end;

procedure TForm1.SetDL(const Value: glUint);
begin
  FDL := Value;
end;

procedure TForm1.SetRC(const Value: HGLRC);
begin
  FRC := Value;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
  Draw;
end;

end. 
```

现在上面的代码与我的原始代码的工作方式有很大不同。原始`Draw`过程通过对象列表进行迭代，每个对象都包含自己的`Draw`过程。所以控件的绘制程序准备好整个场景，然后一个一个地绘制每个“项目”，如下所示：

```
procedure TGLImage.Draw;
var
  X: Integer;
begin
  if not FDrawing then begin
    FDrawing := TRUE;
    try
      glClear(GL_COLOR_BUFFER_BIT or GL_DEPTH_BUFFER_BIT);
      glEnable(GL_NORMALIZE);
      glShadeModel(GL_FLAT);
      glCullFace(GL_BACK);
      glLoadIdentity();

      glRotatef(FElapsedTime / 70, 0, 0, 1);
      glRotatef(90, 0, 1, 0);
      glTranslatef(-FElapsedTime / 400, 0, 0);

      if FInitialized then begin
        for X := 0 to FItems.Count - 1 do begin
          FItems[X].Draw;
        end;
      end;

      SwapBuffers(wglGetCurrentDC);
    finally
      FDrawing := False;
    end;
  end;
end; 
```

这是它绘制的项目之一......

```
constructor TGLBeam.Create(AOwner: TGLItems);
begin
  inherited;
  glNewList(DL, GL_COMPILE);
    glBegin(GL_QUADS);
      // Front Face
      glTexCoord2f(0.0, 0.0);
      glVertex3f(-2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(-2.0, 1.0, 1.0);
      // Back Face
      glTexCoord2f(2.0, 0.0);
      glVertex3f(-2.0, -1.0, -1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(-2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, -1.0);
      // Top Face
      glTexCoord2f(0.0, 1.0);
      glVertex3f(-2.0, 1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(-2.0, 1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(2.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
      // Bottom Face
      glTexCoord2f(2.0, 1.0);
      glVertex3f(-2.0, -1.0, -1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, -1.0, -1.0);
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(2.0, 0.0);
      glVertex3f(-2.0, -1.0, 1.0);
      // Left Face
      glTexCoord2f(0.0, 0.0);
      glVertex3f(2.0, -1.0, -1.0);
      glTexCoord2f(1.0, 0.0);
      glVertex3f(2.0, -1.0, 1.0);
      glTexCoord2f(1.0, 1.0);
      glVertex3f(2.0, 1.0, 1.0);
      glTexCoord2f(0.0, 1.0);
      glVertex3f(2.0, 1.0, -1.0);
    glEnd();
  glEndList();
end;

procedure TGLBeam.Draw;
var
  I: Integer;
begin
  glRotatef(Directions.X, 1.0, 0.0, 0.0);
  glRotatef(Directions.Y, 0.0, 1.0, 0.0);
  glRotatef(Directions.Z, 0.0, 0.0, 1.0);
  for I := 1 to 10 do begin
    //Main Center
    glPushMatrix();
    glTranslatef(I * 4 + Owner.Owner.ClockTime * 4, 0, 0);
    glCallList(DL);
    glPopMatrix();
    //Above
    glPushMatrix();
    glTranslatef(I * 4 + Owner.Owner.ClockTime * 4, 6, 0);
    glCallList(DL);
    glPopMatrix();
  end;
end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:20:52.397

```
glClear(GL_COLOR_BUFFER_BIT or GL_DEPTH_BUFFER_BIT);
glEnable(GL_NORMALIZE);
glShadeModel(GL_FLAT);
glCullFace(GL_BACK);
glLoadIdentity;
glPushMatrix();
glCallList(DL);
glPopMatrix();
SwapBuffers(wglGetCurrentDC); 
```

~~首先将 () 添加到您的调用中`glLoadIdentity`~~

您加载单位矩阵然后推送它然后渲染和弹出它而不实际进行任何转换。

要么删除3行

```
glLoadIdentity;
glPushMatrix();

glPopMatrix(); 
```

或将 移动`glPushMatrix()`到 之前的行`glLoadIdentity()`

我还建议关闭着色和剔除以确保它们不会干扰。Quads 以稍微错误的顺序声明，背面剔除只是剔除它们，即使您不希望它们从前面剔除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T19:47:46.330

已经发现了闪烁的问题，这是一个非常大的错误，我不希望您在没有整个项目的情况下就知道。问题是我创建了**两个**这样的控件，它们互相干扰/争斗。实际上，因为 OpenGL 在逐个线程的基础上工作（或在一个“上下文”内），所以有两个不同的控件试图进行自己的绘图会干扰 - 导致两个控件同时发生相同的事情. 所以闪烁是因为每个控件都试图轮流进行绘图。我提出的关于将这张图放在线程中的新问题将完美地解决这个问题。这是一个愚蠢的错误，我很抱歉浪费了任何人的时间。

# algorithm - 在 MapReduce 范式中可以重铸哪些类型/类别的算法？

> ID：10729528
> 
> 赞同：3
> 
> 时间：2012-05-24T00:03:58.650
> 
> 标签：algorithm, parallel-processing, hadoop, mapreduce

几个“快速问题”：

*   在 MapReduce 范式中可以重铸哪些类型/类别的算法？（例如 k-means 有一个 MR 实现）

*   有没有不能用这种方式表达的？

*   哪些算法特征使它们在 MR 范式中重铸的吸引力/复杂性降低

提前感谢您的帮助。

最大限度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:06:26.813

Map Reduce 范式最适合“令人尴尬地并行”的问题，即任何两个任务之间没有依赖关系。请查看Wikipedia 上的[Embarrassingly Parallel](http://en.wikipedia.org/wiki/Embarrassingly_parallel)文章。

此外，在操作是可交换或关联的情况下，可以轻松优化 MapReduce 程序以获得更好的性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T15:21:48.993

我正在为来自 MPI 世界的大数据算法集合解决这些相同的问题。这是我的看法。

MR 配方的基本管道似乎是扩张/收缩。该映射应用于一个大集合，可能会创建一个更大的集合，然后使用 reduce 对该集合进行排序/组织，以便可以将其聚合成一个合并的数据集，最好是更小的数据集。您需要的 map 和 reduce 的数量是 MR 算法的聪明之处。

作为一种通用的计算方法，您可以使用 MR 解决任何计算问题，但从实际角度来看，MR 的资源利用率偏向于具有高并发 I/O 要求的计算问题。诸如字数统计之类的令人尴尬的并行算法当然适合该法案，但它比这更广泛，例如，您的 k-means 算法是一个约束最小化问题，没有人会将其归类为令人尴尬的并行，但仍然具有有效的 MR 公式。

我目前的正式框架从五个属性方面描述了分布式计算机系统：

1.  处理器性能
2.  内存容量（我们可以忽略内存性能，因为它往往由处理器设计人员构建以支持处理器的性能）
3.  磁盘存储容量
4.  网络带宽性能
5.  网络消息延迟

磁盘性能是我仍在努力干净地整合的东西，因为旋转与 SSD 存储技术具有巨大的性能影响，但前提是 SSD 通过 PCIe 集成。如果通过 SAS 或 SATA 集成，那么您会达到接口限制，并且旋转也很容易使该接口饱和。在这种情况下，只有 SSD 出色的延迟才能有助于性能提升，但这只会有利于具有较小数据记录的较小数据集。所以目前，让我们假设我们有一个真正的大数据问题，需要轮换存储来有效地控制数据成本。

MapReduce 在该扩展/收缩流程中使用上述分布式资源列表：它使用处理器+内存+磁盘来执行映射功能，然后在很大程度上依赖于网络的性能来执行 reduce 功能。由于添加服务器将扩展处理器+内存+磁盘资源，不幸的是，网络性能仅在容量上适度增加，但延迟性能降低。由于网络延迟是分布式系统中极难最小化的性能特征，因此 MR 算法对于以带宽为中心的运营商最为有效：即具有数十亿个独立小数据包的算法。

我正在寻找有关 PDE 求解器和优化算法（例如整数规划）是否存在有效 MR 算法的见解。从做 FutureGrid 的人那里找到了一张很棒的图： ![算法组织领域](../Images/9ea9cb755d67aebf5d8f0ffb59aa50b1.png)

# graph - 找到“最小跨越路径”的算法？

> ID：10729534
> 
> 赞同：5
> 
> 时间：2012-05-24T00:05:20.670
> 
> 标签：graph, graph-algorithm

灵感来自这部漫画[http://xkcd.com/173/](http://xkcd.com/173/)

我知道有很多算法可以找到加权图的最小生成树，但是我一直在努力寻找任何可以找到最小生成“路径”的算法。

对于漫画，如果我们根据每对关系对每条边进行加权，那么社会最优安排将是最小跨越“路径”，即跨越所有顶点的路径。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:27:49.470

寻找最优哈密顿路径（也称为*最优路径覆盖*）是一个难题。（确定是否存在*任何*哈密顿路径是一个 NP 完全问题。）[这篇学术文章](http://www.austms.org.au/Publ/Jamsb/V44P2/pdf/1761.pdf)讨论了最优路径覆盖算法等内容。您可以在网上搜索这些术语以查找其他资源。我不知道任何现成的代码。

顺便说一句，[这个问题](https://stackoverflow.com/questions/7341687/minimal-distance-hamiltonian-path-javascript)（基本上是你的问题）清楚地解释了为什么旅行商问题不是开始的地方。

# c# - 论坛创建或生成

> ID：10729536
> 
> 赞同：0
> 
> 时间：2012-05-24T00:05:26.317
> 
> 标签：c#, asp.net-mvc, winforms, forums

我正计划为特定的视频游戏创建一个论坛网站。有什么东西可以生成一个论坛风格的网站供您付费。这只是网站的一小部分，如果它很容易购买或者更好，免费的，我不想建立这个自定义。

这是问这个问题的正确 StackExchange 网站吗？

编辑：我只是问是否有人在 asp.net 或 mvc 中有过良好的经验

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:00:19.960

可能不是最适合这个网站，如果你想要 CSS 样式去图形设计师或尝试[http://www.monstertemplate.com/search/page1.html?keyword=games](http://www.monstertemplate.com/search/page1.html?keyword=games)

# javascript - 使用通过 ("input").val() 传入的百分比时遇到问题

> ID：10729538
> 
> 赞同：0
> 
> 时间：2012-05-24T00:05:36.787
> 
> 标签：javascript, jquery

老实说，我认为我只需要将值转换为整数，但我已经尝试了很多事情并不断得到“NaN”或类似于“不能在对象上使用此操作”的内容。我想做一些事情，比如使用替换来删除 % 或简单地对其应用数学。我试过 String 和 parseInt() 来尝试转换，但只是得到 NaN。

这个例子给了我一个警告框，上面写着“10%”或“20%”......无论用户输入什么

```
thisInvoiceDiscount = $("#clientSearchInvoiceDiscountTextbox").val(); 
percentPresent = thisInvoiceDiscount.indexOf("%"); 
if (percentPresent == "-1") { 
} 
else { 
  alert (thisInvoiceDiscount);
  //I can't seem to do anything with thisInvoiceDiscount here
} 
```

更新：使用第一个响应：

```
thisInvoiceDiscount = $("#clientSearchInvoiceDiscountTextbox").val();
var numberOnly = $("#clientSearchInvoiceDiscountTextbox").val().replace(/\D/g, '');
percentPresent = thisInvoiceDiscount.indexOf("%");
if (percentPresent == "-1") {
}
else {
    var integerValue =  parseInt(numberOnly, 10);
    alert (integerValue);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:08:36.723

```
var numberOnly = 
        $("#clientSearchInvoiceDiscountTextbox").val().replace(/\D/g, ''); 
```

这将从字符串中删除每个非数字字符。

```
var integerValue =  parseInt(numberOnly, 10); 
```

这会将字符串解析为整数。

当然，您可以`regex`更具体地针对`%`标志：

```
var numberOnly = 
        $("#clientSearchInvoiceDiscountTextbox").val().replace(/%/, ''); 
```

或者仅当它是字符串中的最后一个字符时才`regex`删除：`%`

```
var numberOnly = 
        $("#clientSearchInvoiceDiscountTextbox").val().replace(/%$/, ''); 
```

[**现场演示**](http://jsfiddle.net/RQDtH/1/) [（基于更新）]

* * *

**请注意，**与结果进行比较时，您最好将其与 int 数字进行比较，而不是字符串`indexOf`，它会为您的代码添加（非常小的...）提升，并且如果您与`===`

# hadoop - 洗牌错误：超过 max_failed_unique_matche ：救助

> ID：10729543
> 
> 赞同：2
> 
> 时间：2012-05-24T00:06:28.807
> 
> 标签：hadoop, mapreduce

我是 hadoop 新手，我正在尝试执行 wordcount 示例。我的计算机上有一个由虚拟机组成的 4 个节点的集群。每次作业完成 map 任务但 reduce 任务在大约 16% 时显示此错误：

随机播放错误：超过 MAX_FAILED_UNIQUE_FETCHES；救助。

12/05/24 04:43:12 WARN mapred.JobClient: 读取任务 outputmachine3-VirtualBox 时出错

从站似乎无法从其他从站检索数据。在某些链接上，我发现它可能是由于 /etc/hosts 文件中的不一致造成的。但是我已经交叉检查了它们，它们都是一致的。谁能帮我吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:35:18.833

是否有防火墙阻止公共 hadoop 端口上的集群节点之间的通信（在这种情况下，任务跟踪器为 50060）。通过在端口 50060 上从一个节点到另一个节点的 curl 进行测试，并检查您是否获得了 http 响应代码：

```
curl -I http://node1:50060/ 
```

请务必将上面的“node1”替换为`$HADOOP_HOME/conf/slaves`文件中的每个值

*编辑*所以事实证明这很可能是一个 DNS 问题，这是你应该尝试的：

*   检查`${HADOOP_HOME}/conf/slaves`文件 - 此处的每个条目都需要位于集群中每个节点的 /etc/hosts 文件中，或者您必须将它们放在网络 DNS 服务器中
*   一旦您在集群中的*每个节点*上声明了主机文件（或配置了 DNS 服务器），登录到每个节点并检查您是否可以通过从属文件中的名称 ping 其他集群节点。最后断言您可以将 tasktracker（端口 50060）从每个节点卷曲到其他节点（再次使用从文件中的机器名称）
*   为了安全起见，重启你的 mapreduce 服务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T10:02:49.953

通过在终端中键入 $hostname 检查每个节点中的主机名。确保您获得相同的机器名称（主节点中的主节点和从节点中的从节点）。如果没有，请将 /etc/hostname 更改为您的节点名称（主/从）。然后重新启动系统。它会起作用。

[简单组](http://simplegec.blogspot.in)

# java - 使用java将文件作为字节[]存储在db2中

> ID：10729544
> 
> 赞同：0
> 
> 时间：2012-05-24T00:06:32.263
> 
> 标签：java, jpa, db2

我正在使用开放 JPA（websphere 应用程序服务器）将文件存储在 db2 列中。JPA 实体如下所示：

```
@Lob
@Nullable
private byte[] content; 
```

使用 apache fileupload 将文件存储在数据库中

```
FileItem item = (FileItem) iterator.next();
byte[] fileData = item.get();
attachment.setContent(fileData);
manager.updateAttachments(attachment); 
```

检索文件：

```
ServletOutputStream op = response.getOutputStream();
byte buff[] = new byte[8192];
InputStream input = new FileInputStream(uploadedFile);

response.setHeader("Content-Length",String.valueOf(uploadedFile.length()));
response.setHeader("Content-Disposition", "attachment; filename=\""
                    + uploadedFile.getName() + "\"");
int i = 0;
while ((i = input.read(buff)) > 0) {
    op.write(buff, 0, i);
    op.flush();
} 
```

我尝试上传图像文件。检索它时，firefox 显示以下错误：无法显示图像“http://localhost:9081/SampleFormServlet/retrieveFileServlet”，因为它包含错误。

有人可以指出一个做类似事情的例子吗？

# java - 在 ap:commandButton 动作属性中检索 h:inputHidden

> ID：10729547
> 
> 赞同：1
> 
> 时间：2012-05-24T00:06:44.163
> 
> 标签：java, jsf, primefaces

我有一个 JSF 2.0 + PrimeFaces 应用程序，里面 ah:form 有一个 inputHidden 像这样：

```
<h:inputHidden id="mdid" /> 
```

不幸的是，我们的托管 bean 来自另一个开发团队，他们在 .jar 中部署了一个 bean (@ViewScoped)，其操作方法如下：

```
public void action(Integer id) {
    //Call service layer passing the id.
} 
```

我们的 inputHidden 在客户端发生了变化，我们无法将它与 bean 绑定。

无论如何我可以做到这一点吗？

```
<p:commandButton action="#{ServiceBean.action( mdid )}" 
```

**mdid**应替换为 inputHidden 的值。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T02:31:44.517

将其绑定到视图，以便您也可以在 EL 范围内获取它的值。

```
<h:inputHidden id="mdid" binding="#{mdid}" />
...
<p:commandButton ... action="#{ServiceBean.action(mdid.value)}" /> 
```

# javascript - fancybox 内容调整为 html

> ID：10729550
> 
> 赞同：0
> 
> 时间：2012-05-24T00:07:03.960
> 
> 标签：javascript, jquery, resize, fancybox

我在我正在处理的网页上使用了 fancybox 插件，但现在我正在使用 iframe 来加载我的外部 html 内容。我对 ajax 不太熟悉，但是通过阅读其他帖子，我发现使用 iframe 的效果不如使用 ajax。我将如何使用 jquery 和 ajax 将我的 html 文件加载到 fancybox 内容中，然后将其调整为我拥有的 html 文件内容的宽度和高度。这是我的代码：

```
<html>
<head>
//import all the needed javascript and css files for jquery and plugins
<script type="text/javascript">
$(document).ready(function() {
  $('.fancybox').fancybox({
    openEffect : 'elastic',
    closeEffect : 'elastic'
  });
});
</script>
</head>

<body>
  <a href="sample1.html" class="fancybox">Open Fancybox</a>
</body>
<html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:18:00.520

我认为您需要使用 onComplete 事件（或您自己的事件，例如单击 FancyBox 窗口中的某个链接后），在这种情况下您必须编写代码：

```
$.fancybox.resize 
```

加载很简单：

```
$('#fancybox_content').load('ajax/test.html') 
```

有关 ajax 语法，请参阅 [.load() 调用文档](http://api.jquery.com/load/)

# java - Java Android 从字符串格式比较时间

> ID：10729553
> 
> 赞同：0
> 
> 时间：2012-05-24T00:07:17.280
> 
> 标签：java, android, date, time, compare

我有一个包含以下格式的时间的字符串：

```
"hh:mm tt" 
```

例如，您可以将当前时间表示为“7:04 PM”

如何将其与用户时区中的当前时间进行比较，以查看该时间是小于、等于还是大于当前时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:20:18.873

您可以转换`String`为`Date`.

```
String pattern = "<yourPattern>";
SimpleDateFormat dateFormat = new SimpleDateFormat(pattern);
try {
 Date one = dateFormat.parse(<yourDate>);
 Date two = dateFormat.parse(<yourDate>);

}
catch (ParseException e) {} 
```

它实现了 Comparable 接口，因此您应该能够将它们与`compareTo()`

* * *

**编辑：** 我忘记了，但你知道，但只能肯定 compareTo 返回 -1、1 或 0，所以`one.compareTo(two)`当第一个 ist 在第二个之前返回 -1 等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T00:53:46.370

以下代码详细说明了@Sajmon 的答案。

```
public static void main(String[] args) throws ParseException {
    String currentTimeStr = "7:04 PM";

    Date userDate = new Date();
    String userDateWithoutTime = new SimpleDateFormat("yyyyMMdd").format(userDate);

    String currentDateStr = userDateWithoutTime + " " + currentTimeStr;
    Date currentDate = new SimpleDateFormat("yyyyMMdd h:mm a").parse(currentDateStr);

    if (userDate.compareTo(currentDate) >= 0) {
        System.out.println(userDate + " is greater than or equal to " + currentDate);
    } else {
        System.out.println(userDate + " is less than " + currentDate);
    }
} 
```

# objective-c - Mac OS X 基于文档的应用程序：AppleScript“打开”命令返回“缺失值”而不是打开的文档

> ID：10729568
> 
> 赞同：3
> 
> 时间：2012-05-24T00:09:06.580
> 
> 标签：objective-c, macos, cocoa, applescript

我的设置：Mac OS X 10.7.4 Xcode 4.3.2

我有一个基于 10.6 SDK 的 Mac OS X 基于文档的应用程序。

以前，我总是在 Snow Leopard 上用 Xcode3 构建这个应用程序。

我最近更新了应用程序的项目，让它在 Lion 上的 Xcode4 下构建（尽管我仍在针对 10.6 SDK 构建）。

在 Xcode4/Lion 下构建后，我注意到 AppleScript 行为发生了奇怪的变化，我找不到根本原因。问题是这样的：

**AppleScript 打开文档命令返回`missing value`而不是打开的文档。**

所以这段代码：

```
tell application "MyApp"
    set doc_ to open (get path to desktop as string) & "test.myext"
    doc_ -- prints the return value in the console
end tell 
```

当我的应用程序在 Xcode3/Lion 下构建时，在控制台中打印出以下值：

```
document 1 of application "MyApp" 
```

**但是**当我的应用程序在 Xcode4/Lion 下构建时，会在控制台中打印出以下值：

```
missing value 
```

但是，在这两种情况下，文档都会按预期打开和显示。唯一的问题是 AppleScript`open`命令的返回值。

所以我深入研究了代码，试图找出导致这种变化的原因。我注意到原因似乎与此方法的行为有关：

```
-[NSApplication handleOpenScriptCommand:] 
```

在 Xcode3 下构建时，此方法会阻塞，直到在我的应用程序中创建 NSDocument。这允许 AppleScript`open`命令接收我的新文档作为其返回值。

但是，在 Xcode4 下构建时，此方法在创建 NSDocument 之前不会阻塞。相反，它似乎触发了一些异步调用

```
-[NSDocument openDocumentWithContentsOfURL:display:] 
```

并立即返回。这会导致 AppleScript`open`命令接收`missing value`为它的返回值。

所以我试图弄清楚我做了什么来使这种变化发生。

首先，我怀疑我（错误地）使用了10.6 中引入的**[异步文档打开功能。](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSDocument_Class/Reference/Reference.html#//apple_ref/occ/clm/NSDocument/canConcurrentlyReadDocumentsOfType%3a)**但是，我检查了，我没有覆盖这个方法：

```
+[NSDocument canConcurrentlyReadDocumentsOfType:] 
```

所以我什至尝试覆盖它并返回`NO`。

```
+ (BOOL)canConcurrentlyReadDocumentsOfType:(NSString *)typeName {
    return NO;
} 
```

这并没有解决我的问题。

那么有人可以提供建议吗？我如何破坏 AppleScript`open`命令以使其异步执行（当我真的想要同步时）并返回`missing value`（当我真的想要创建的文档时）？

**更新**

我发现了一件非常令人惊讶的事情！

有问题的应用程序有两个化身：它可以为独立分发或通过 Mac App Store 分发而构建。在我的 Xcode 项目中，每个化身都是一个单独的（但非常相似的）目标。让我们调用目标：

```
MyAppIndie 
```

和

```
MyAppAppStore 
```

我发现这个问题只发生在独立应用程序中。该问题不会发生在应用程序的 AppStore 构建中。

**另外**，我还有*另一个*基于文档的 OS X 应用程序，它同时具有 Indie 和 AppStore 目标，它表现出与此处描述的相同的问题！

我的两个应用程序的 AppStore 版本都可以正常工作。但是这两个应用程序的独立版本都有这个问题。

我原以为两个应用程序中的两个目标之间几乎没有区别，但显然有些不同。我现在正试图找出所有差异并找到罪魁祸首。

人力资源管理系统。越来越近。

# html - HTML5 替代基于 Flash 的 ZeroClipboard 以将数据安全复制到剪贴板？

> ID：10729570
> 
> 赞同：64
> 
> 时间：2012-05-24T00:09:17.907
> 
> 标签：html, clipboard, zeroclipboard

随着闪存在许多环境（iPhone、Android、IE10 等）中的出现，是否有任何新的解决方案出现在任何浏览器中，可以在不安装闪存的情况下将信息安全复制到剪贴板？

到目前为止，我一直在使用[ZeroClipboard](https://github.com/jonrohan/ZeroClipboard)，但我担心更多没有 Flash 的观众，这个功能会被破坏，我希望尽可能不依赖 Flash。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-21T14:49:39.843

原因是自动复制到剪贴板可能非常危险，因此大多数浏览器（IE 除外）* 都会使其变得困难，除非您使用 Flash。

就像您的[ZeroClipboard](http://code.google.com/p/zeroclipboard/)一样，还有[Clipboard LMCButton](http://www.lettersmarket.com/view_blog/a-3-copy_to_clipboard_lmcbutton.html)，它也使用在后台运行的小型 Flash 脚本。

一个常见的解决方案是这样做：

```
 function copyToClipboard (text) {
     window.prompt ("Copy to clipboard: Ctrl+C, Enter", text);
 } 
```

[当其他人在这里问这个问题](https://stackoverflow.com/questions/400212/how-to-copy-to-the-clipboard-in-javascript)时，我从 Jarek Milewski 那里找到了

*是的，我找到了一种适用于 IE 的解决方案，但在大多数现代浏览器中不起作用，[请查看此处](http://www.htmlgoodies.com/beyond/javascript/article.php/3458851/Click-Its-Copied.htm)。

**更新：**

据此：[https](https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand) ://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand Firefox 41+、Chrome 42+ 和 IE 9+ 支持带有 execCommand 的复制命令。对于 firefox 和 chrome，它只有在由用户操作（如点击）触发时才会起作用，对于 IE，它会给用户一个警告对话框，询问他们是否允许复制到剪贴板。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-11-01T18:09:40.533

我知道这个答案来得有点晚，但现在有一个新的现代替代 ZeroClipboard（基于 Flash）。[Clipboard.js](https://github.com/zenorocha/clipboard.js/)是一个**2kB 的纯 JavaScript**替代方案，**没有依赖**项。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-07T01:48:56.253

我创建了一个名为 clip-j 的纯 JavaScript 解决方案。[在这里](https://github.com/Triforcey/clip-j)。基本上，它的作用是利用`document.execCommand('copy');`其他一些命令来实现它，因此您什么都看不到。这是代码：

```
function clip(text) {   
    var copyElement = document.createElement('input');      
    copyElement.setAttribute('type', 'text');   
    copyElement.setAttribute('value', text);    
    copyElement = document.body.appendChild(copyElement);   
    copyElement.select();   
    document.execCommand('copy');   
    copyElement.remove();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-11T18:49:02.493

您可以查看[这篇博](https://www.lucidchart.com/techblog/2014/12/02/definitive-guide-copying-pasting-javascript/)文，深入讨论如何在 HTML5 中使用剪贴板。不幸的是，您仍然无法在单击时便携地复制到剪贴板。但是，对于 chrome 和 firefox，您可以创建一个浏览器扩展程序，可以授予您的站点访问剪贴板的权限，并且我相信 IE 会让您复制到剪贴板，但会提示用户授予权限。

**更新**：

据此：[https](https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand) ://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand Firefox 41+、Chrome 42+ 和 IE 9+ 支持带有 execCommand 的复制命令。对于 firefox 和 chrome，它只有在被点击等用户操作触发时才会起作用，对于 IE，它会给用户一个警告对话框，要求他们允许复制到剪贴板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-14T14:23:16.550

[这个问题](https://stackoverflow.com/questions/22581345/click-button-copy-to-clipboard-using-jquery/30905277#30905277)有很好的答案，我选择使用这个片段：

```
function copyToClipboard(element) {
    var $temp = $("<input>");
    $("body").append($temp);
    $temp.val($(element).text()).select();
    document.execCommand("copy");
    $temp.remove();
} 
```

但是，如果您的页面上有 bootstrap-select，则该`$temp.val($(element).text()).select()`行将引发错误：

> 小部件只能在选择元素上工作

您可以`.trigger('select')`改用，如[.select() 的 jQuery 文档中所述](https://api.jquery.com/select/)，如下所示：

```
$temp.val($(element).val()).trigger('select'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-29T15:42:03.863

要使用 execCommand，您必须首先在页面上选择（）某些内容，因此您不能只是复制最后放入剪贴板的内容。使用这个函数，我将输入文本框的 id 传递给函数并选择（）它，然后执行复制命令。无需添加侦听器或使您的代码进一步复杂化。如果未启用或不支持 document.execCommand() 将返回 false，因此您可以使用 window.prompt 作为备份方法。

```
function copyToClipboard(id) {
    var blnCopied;
    document.getElementById(id).select();
    blnCopied = document.execCommand("copy", false, null);
    if (blnCopied)
        alert('Link copied to clipboard');
    else
        window.prompt ("Copy to clipboard: Ctrl+C, Enter", jQuery("#"+id).val());
} 
```

使用带有 onclick="copyToClipboard('some_id')" 的标准“a”锚标记

# vba - 修改现有 VBA 以在从一个工作表导入到另一个工作表时传递空白值的方法？

> ID：10729575
> 
> 赞同：1
> 
> 时间：2012-05-24T00:10:52.787
> 
> 标签：vba, excel

我一直在寻找一种方法来从“JDH”转换以下答案中的“优秀答案”（VBA 代码）。（我觉得尝试直接联系以获取以下答案的进一步帮助是不合适的）

下面的响应/答案中的 VBA 答案对于我需要的东西来说是 90% 的完美，除非我在源工作簿中阅读了我的 Part# 和 Order Qty 的数据（源可能是多达 5000 行产品并且已经过滤以隐藏具有空白订单数量的行），下面的 VBA 将复制范围内的所有数据，无论它是否被过滤。

（以下是我需要的 90+%） [https://stackoverflow.com/a/7878070/1413702](https://stackoverflow.com/a/7878070/1413702)

我已经修改了代码以适用于我的实例，并且一切正常，直到我不得不阅读不为空白的 Part # & Order Qty 的数据。如果订单数量不是空白，我只想带上零件编号和订单数量，并意识到我可能需要通读 5000 行的整个范围以确保获得所有可能订购的物品。如果它是直接源范围到目标范围，那么上面将是完美的，但是，由于源可能已被过滤，因此范围内有隐藏的行需要检查订单数量空白。此外，此时可能发生的导入次数有一个总体限制，因为订单表仅设置为最多 501 行。300是一般规则，501是保障。然而，我的修订在下面，我没有考虑阅读潜在的 5000 条潜在线路，因为这是事后才想到的，当我尝试检查空白值时，我在拍摄时遇到了一个错误。如果可以，请提供帮助，如果我发布不正确，请再次告知。我将更改任何必要的内容以符合论坛规则。谢谢你，khleisure

我的“JDH”优秀答案的修订代码如下：

```
Private Sub ImportExternalDataToOrderForm_Click()
  '*******Exit Sub - Used to disable command button till sub written/executes properly
  ' Get customer workbook...
Dim customerBook As Workbook
Dim filter As String
Dim caption As String
Dim customerFilename As String
Dim customerWorkbook As Workbook
Dim targetWorkbook As Workbook

     ' Active workbook is the Target Workbook
Set targetWorkbook = Application.ActiveWorkbook

     ' get the customer workbook to use as Source WorkBook
filter = "XLS files (*.xls),*.xls"
caption = "Please Select an input file "
customerFilename = Application.GetOpenFilename(filter, , caption)

Set customerWorkbook = Application.Workbooks.Open(customerFilename)

     ' Ranges vary in Source Workbook to Target Workbook but, applicable data to import      
     ' to Order Form

     'Import data from customer(source) to target workbook(active Order Form)
Dim targetSheet As Worksheet
Set targetSheet = targetWorkbook.Worksheets(2)
Dim sourceSheet As Worksheet
Set sourceSheet = customerWorkbook.Worksheets(1)

targetSheet.Range("B4").Value = sourceSheet.Range("C2").Value ' Works Great
targetSheet.Range("B9").Value = sourceSheet.Range("C8").Value ' Works Great
targetSheet.Range("G9").Value = sourceSheet.Range("C9").Value 'Works Great
targetSheet.Range("N4:N6").Value = sourceSheet.Range("N2:N4").Value ' Works Great
targetSheet.Range("J18:J20").Value = sourceSheet.Range("K7:K9").Value ' Works Great

 ' Below 2 lines work great however, the Source Workbook is filtered to eliminate
 ' blanks in Order Qty Field (Starting Source M13) and the 2 lines of code below bring     
 ' over everything in the overall range of 501 possible occurrences regardless if it's 
 ' filtered or not.  Blank Order Qty fields that have been filtered should not be    
 ' imported.  Max lines to import is defined by range of 501 max

     'below xfers the Part Number from A column range of Source to A column Range of 
     'Target and works great except no function to check for blanks in Order Qty
     ' Below works exactly how it's written to work 

'targetSheet.Range("A27:A527").Value = sourceSheet.Range("A13:A513").Value

     'below xfers the Ordered Qty from M column range of Source to D column Range of 
     'Target and this is where I need to check if a qty has been ordered (or not =       
     'blank) in order to perform the above import and this import.  The 2 are 
     'relational to one another
     ' Below works exactly how it's written to work but, needs to 1st check for blank

'targetSheet.Range("D27:D527").Value = sourceSheet.Range("M13:M513").Value

     '*****My attempt to modify further to account for blank value
     'Need loop to read through each row and import Source Range "A" to Target Range 
     '"A" along with associated Source Range "M" to Target Range "D".  Max 501 lines
     '*****

     ' Need to use loop for Part Number and associated Order Qty
Dim t As Long
Dim s As Long
Dim i As Long
      '*****

t = 27     ' row number on target where Product # (Col A) and Order Qty (Col D) start
s = 13     ' row number on Source where Product # (Col A) and Order Qty (Col M) start
i = 1      ' set counter for total of 501 potential import occurrences Max
           ' Need to establish reading potential Source rows (filtered or not) at 5000 
           ' max rows (most likely range of 3500)
           ' for most factories and their offerings.  (Have not established this 
           ' portion yet)

For i = 1 To 501 Step 1
   If **sourceSheet.Range("M(s)").Value** = "" Then ' Error Here ****************
                                **'Method 'Range' of object '_Worksheet' failed**
     Next i
     Exit Sub
Else
     targetSheet.Range("A(t)").Value = sourceSheet.Range("A(s)").Value ' xfer Part #
     targetSheet.Range("D(t)").Value = sourceSheet.Range("M(s)").Value ' xfer Order Qty
End If
    t = t + 1
    s = s + 1
Next i

    ' Close Customer(Source) workbook[/COLOR]
customerWorkbook.Close

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T23:45:07.613

相信我已经解决了我想要它做的事情。仍在测试，但到目前为止，以下内容正在阅读源，同时确定源“订单数量”是否为空白并继续前进，直到源“订单数量”输入了一个 amt 并分别导入相应的零件编号和订购数量另一个。它还通过或考虑由于订单数量字段为空白而可能已在源上过滤掉的空白订单数量金额或行。如下所述，如果有人可以帮助回答我在尝试对源代码使用不同范围时在代码注释中留下的错误，我们将不胜感激。蒂亚, khleisure

```
Private Sub ImportExternalDataToOrderForm_Click()
'*******Exit Sub - Used to disable command button till sub written
' Get customer workbook...
Dim customerBook As Workbook
Dim filter As String
Dim caption As String
Dim customerFilename As String
Dim customerWorkbook As Workbook
Dim targetWorkbook As Workbook

' Active workbook is the Target Workbook
Set targetWorkbook = Application.ActiveWorkbook

' get the customer workbook to use as Source WorkBook
filter = "XLS files (*.xls),*.xls"
caption = "Please Select an input file "
customerFilename = Application.GetOpenFilename(filter, , caption)

Set customerWorkbook = Application.Workbooks.Open(customerFilename)

' Ranges vary in Source Workbook to Target Workbook but, applicable data to import to Order Form
' Import data from customer(source) to target workbook(active Order Form)
Dim targetSheet As Worksheet
Set targetSheet = targetWorkbook.Worksheets(2)
Dim sourceSheet As Worksheet
Set sourceSheet = customerWorkbook.Worksheets(1)

targetSheet.Range("B4").Value = sourceSheet.Range("C2").Value ' Works Great
targetSheet.Range("B9").Value = sourceSheet.Range("C8").Value ' Works Great
targetSheet.Range("G9").Value = sourceSheet.Range("C9").Value 'Works Great
targetSheet.Range("N4:N6").Value = sourceSheet.Range("N2:N4").Value ' Works Great
targetSheet.Range("J18:J20").Value = sourceSheet.Range("K7:K9").Value ' Works Great

     ' below 2 lines work for fixed range and every line regardless if filtered
     ' and regardless if Order Qty is blank
'targetSheet.Range("A27:A527").Value = sourceSheet.Range("A13:A513").Value
'targetSheet.Range("D27:D527").Value = sourceSheet.Range("M13:M513").Value

'***** LOOP THOUGH PRODUCT AND QTY ORDERED DATA FOR BALANCE OF IMPORT
' Need to Loop through all Rows of overall Source (Starting R#13) to account
' for filtered lines that exist between the lines that remain and have a qty
' in the Order Qty Field (Col M).  If Qty Ordered Blank (filtered) you pass up
' the import of Source A & M to Target A & D and move to next.  If Qty Ordered from
' Source has a Qty entered, you drop through to import accordingly from Source to
' to Target.  Set Currently at Max Source of Range A13:A3000 (Can increase if
' necessary.  Also, counter to limit the number of imports to max 501 per Order
' Form's limit of lines currently.  Have to modify Order Form and loop below if more

Dim t As Long
Dim s As Long
Dim r As Long
'Dim rcount As Long (removed due to error below)
'*****

t = 27 ' Target Starting Row to accept imported data
s = 13 ' Source Starting Row to begin import consideration
r = 13 ' Define Start counter in For/Next below
       ' with Max set to 3000 potential rows currently (can increase if necessary)

'rcount = Workbook(sourceSheet).Cells(RowCount, "a").End(xlUp).Row ' error here
'rcount = customerWorkbook.Worksheets(1).Cells(RowCount, "a").End(xlUp).Row
      'Above Line creates Error 1004 Application-defined or Object-defined Error

' For r = r to rcount Step 1 (removed because of above error)

For r = r To 3000 Step 1

    If t <= 527 Then ' 501 max occurrences that can import data "t" starts at 27

       If sourceSheet.Range("M" & s).Value = "" Then

            If r = 3000 Then
              customerWorkbook.Close
              Exit Sub
            End If

         s = s + 1

       Else

         targetSheet.Range("A" & t).Value = sourceSheet.Range("A" & s).Value
         targetSheet.Range("D" & t).Value = sourceSheet.Range("M" & s).Value
         t = t + 1
         s = s + 1

       End If

    Else
       customerWorkbook.Close
       Exit Sub

    End If

Next r

' Close customer workbook
customerWorkbook.Close

End Sub 
```

# java - Android View 不会通过滑动手势滚动，也不会滚动。将 ListView 与 ArrayAdapter 一起使用

> ID：10729576
> 
> 赞同：2
> 
> 时间：2012-05-24T00:10:54.117
> 
> 标签：java, android, android-listview, android-arrayadapter, swipe

我正在`ArrayAdapter`为我的`ListView`. 我`CheckBox`在左边有一个，右边有两个`TextView`项目`CheckBox`，彼此堆叠。我也在使用自定义`android:listSelector`.

我将 8 个项目插入到我的自定义方法`ListView`中。`MyActivity` `onCreate`

我可以选择列表中的一行以更改颜色，并且我还可以选中和取消选中该复选框。但是，视图不会响应垂直滑动，当我用手指将鼠标悬停在项目上时，它也不会给项目焦点。如果我同时单击该项目并用另一根手指向下滚动，我可以滚动，但这不是我想要的。我是否以某种方式破坏了垂直滑动手势？

我想指出`ScrollView`我的问题中没有对象。那里的大多数帖子都与人们将`ListView`物体放在里面有关`ScrollView`，反之亦然。

我的怀疑是我的布局有问题和/或我在布局和代码中分配焦点的方式有问题。

这是我的主要活动代码：

```
import java.util.ArrayList;    
import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.CheckBox;
import android.widget.ListView;
import android.widget.TextView;

public class MyActivity extends Activity{
    private ListView lv;
    private TextView titleDisplay;
    private TextView locationDisplay;
    private ArrayList<TalkItem> m_talks = null;
    private MyListView m_adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.session_view);

        lv = (ListView) findViewById(R.id.sessionlist);    
        titleDisplay = (TextView) findViewById(R.id.sessiontitle);
        locationDisplay = (TextView) findViewById(R.id.sessionlocation);

        m_talks = new ArrayList<TalkItem>();
        this.m_adapter = new MyListView(this, R.layout.sessionlistitem, m_talks);
        lv.setAdapter(this.m_adapter); 

        lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                //TODO: do something
            }
        });

        //set title and location display
        titleDisplay.setText("TITLE");
        locationDisplay.setText("LOCATION");
        m_talks.add(new TalkItem("first1", "last1", false));
        m_talks.add(new TalkItem("first2", "last2", false));
        m_talks.add(new TalkItem("first3", "last3", false));
        m_talks.add(new TalkItem("first4", "last4", false));
        m_talks.add(new TalkItem("first5", "last5", false));
        m_talks.add(new TalkItem("first6", "last6", false));
        m_talks.add(new TalkItem("first7", "last7", false));
        m_talks.add(new TalkItem("first8", "last8", false));

    }

    public class MyListView extends ArrayAdapter<TalkItem> {

        private ArrayList<TalkItem> items;

        public MyListView(Context context, int textViewResourceId, 
                ArrayList<TalkItem> items) {
            super(context, textViewResourceId, items);
            this.items = items;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {

            TalkItem talkItem = items.get(position);
            CheckBox checkBox;
            TextView topText;
            TextView bottomText;

            if (convertView == null) {
                LayoutInflater vi = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                convertView = vi.inflate(R.layout.sessionlistitem, null);
                checkBox = (CheckBox) convertView.findViewById(R.id.icon);
                topText =  (TextView) convertView.findViewById(R.id.toptext);
                bottomText = (TextView) convertView.findViewById(R.id.bottomtext);

                // Optimization: Tag the row with it's child views, so we don't have to 
                // call findViewById() later when we reuse the row.
                convertView.setTag(new TalkItemViewHolder(checkBox, topText, bottomText));

                // If CheckBox is toggled, update the listitem it is tagged with.
                checkBox.setOnClickListener( new View.OnClickListener() {
                    public void onClick(View v) {
                        CheckBox cb = (CheckBox) v ;
                        TalkItem ti = (TalkItem) cb.getTag();
                        ti.setChecked( cb.isChecked() );
                    }
                });
            }
            // Reuse existing row view
            else {
                // Because we use a ViewHolder, we avoid having to call findViewById().
                TalkItemViewHolder viewHolder = (TalkItemViewHolder) convertView.getTag();
                checkBox = viewHolder.getCheckBox();
                topText = viewHolder.getTopText();
                bottomText = viewHolder.getBottomText();
            }

            // Tag the CheckBox with the Planet it is displaying, so that we can
            // access the planet in onClick() when the CheckBox is toggled.
            if(talkItem!=null){
                if(checkBox!=null){
                    checkBox.setTag(talkItem); 
                    // Display item data
                    checkBox.setChecked( talkItem.isChecked() );
                }
                if(topText!=null)
                    topText.setText(talkItem.getAuthor());
                if(bottomText!=null)
                    bottomText.setText(talkItem.getTitle());
            } 
            convertView.setBackgroundResource(android.R.color.transparent);              
            return convertView;
        }     
    }
    public class TalkItemViewHolder {
        private CheckBox checkBox;
        private TextView topText;
        private TextView bottomText;

        public TalkItemViewHolder(){}
        public TalkItemViewHolder(CheckBox checkBox, TextView topText, TextView bottomText){
            this.checkBox = checkBox;
            this.topText = topText;
            this.bottomText = bottomText;
        }

        public CheckBox getCheckBox(){
            return checkBox;
        }

        public TextView getTopText(){
            return topText;
        }

        public TextView getBottomText(){
            return bottomText;
        }

        public void setCheckBox(CheckBox checkBox){
            this.checkBox = checkBox;
        }

        public void setTopText(TextView topText){
            this.topText = topText;
        }

        public void setBottomText(TextView bottomText){
            this.bottomText = bottomText;
        }

    }

    public class TalkItem {
        private String title;
        private String author;
        private boolean checked = false;

        public TalkItem(){
            title = "";
            author = "";
        }
        public TalkItem(String title, String author, boolean checked){
            this.title = title;
            this.author = author;
            this.checked = checked;
        }

        public String getTitle(){
            return title;
        }

        public String getAuthor(){
            return author;
        }

        public void setTitle(String title){
            this.title = title;
        }

        public void setAuthor(String author){
            this.author = author;
        }

        public boolean isChecked(){
            return checked;
        }

        public void setChecked(boolean checked){
            this.checked = checked;
        }

        public void toggleChecked(){
            checked = !checked;
        }

    }

} 
```

这是我的主视图的父布局，标题为`session_view.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/sessionviewlayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/white"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/sessiontitle"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:gravity="center"
        android:textSize="20dp" />

    <TextView
        android:id="@+id/sessionlocation"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/sessiontitle"
        android:gravity="center"
        android:textSize="16dp" />

    <ListView
        android:id="@+id/sessionlist"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/sessionlocation"
        android:cacheColorHint="@color/transparent"
        android:descendantFocusability="blocksDescendants"
        android:dividerHeight="3.0sp"
        android:drawSelectorOnTop="false"
        android:listSelector="@drawable/list_selector"
        android:minHeight="1in" />

</RelativeLayout> 
```

这是列表中每个项目的布局，标题为`sessionlistitem.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="?android:attr/listPreferredItemHeight"
    android:background="@color/white"
    android:padding="2dip" >

    <CheckBox
        android:id="@+id/icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:button="@android:drawable/btn_star"
        android:focusable="false"
        android:padding="10dp" />

    <LinearLayout
        android:layout_width="0dip"
        android:layout_height="95dp"
        android:layout_weight="0.99"
        android:clickable="false"
        android:focusable="false"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/toptext"
            android:layout_width="wrap_content"
            android:layout_height="0dip"
            android:layout_weight="1"
            android:clickable="false"
            android:focusable="false"
            android:gravity="center_vertical"
            android:singleLine="false"
            android:textColor="@color/black"
            android:textSize="18dp" />

        <TextView
            android:id="@+id/bottomtext"
            android:layout_width="wrap_content"
            android:layout_height="0dip"
            android:layout_weight="1"
            android:clickable="false"
            android:ellipsize="marquee"
            android:focusable="false"
            android:singleLine="false"
            android:textColor="@color/black"
            android:textSize="16dp" />
    </LinearLayout>

</LinearLayout> 
```

我的自定义 listSelector`list_selector.xml`是

```
<?xml version="1.0" encoding="utf-8"?>
<selector
    xmlns:android="http://schemas.android.com/apk/res/android"> 
    <item
        android:state_pressed="true"
        android:drawable="@drawable/list_selector_pressed" />
    <item
        android:state_focused="true"
        android:drawable="@drawable/list_selector_pressed" />
    <item
        android:drawable="@android:color/transparent" />
</selector> 
```

`list_selector_pressed.xml`是

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <solid android:color="@color/blue"/>   
</shape> 
```

`strings.xml`是

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="hello">Hello World!</string>
    <string name="app_name">My APP</string>
    <color name="gray">#aaaaaa</color>
    <color name="white">#ffffff</color>
    <color name="blue">#5BB5D7</color>
    <color name="transparent">#00000000</color>
    <color name="black">#000000</color>
</resources> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T23:34:20.963

添加所有内容`ArrayAdapter`后需要初始化。具体来说，这些行：

```
this.m_adapter = new MyListView(this, R.layout.sessionlistitem, m_talks);
lv.setAdapter(this.m_adapter); 
```

`onCreate`毕竟应该是方法中的最后几行`m_talks.add(...)`。

`xml`布局文件没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:44:57.763

我相信问题是由于在相对布局中将列表视图高度设置为 wrap_content 引起的。这对于列表视图来说没有什么意义，因为它的内容通常大于它的屏幕高度。一种可能的解决方法是将顶部的 RelativeLayout 更改为 LinearLayout，然后列表视图上的高度设置可以是：

```
android:layout_height="0dp"
android:layout_weight="1" 
```

这将使用列表视图的所有剩余空间。

# python - 我需要一个关心订单和其他一般要求的正则表达式

> ID：10729582
> 
> 赞同：0
> 
> 时间：2012-05-24T00:12:47.347
> 
> 标签：python, regex

我一直在网上搜索，找不到一个关心订单和其他一般要求的正则表达式，我的具体需求如下：

1.  以字母开头；
2.  至少6个字符；
3.  至少 1 位数。

我在 python 中工作，我想我知道如何为 2&3 编写正则表达式，但没有找到组合 1 的方法，因为它涉及顺序。同样，我知道如何写 1 但没有找到将其与一般要求正则表达式结合的方法（意思是括号正则表达式......不知道名称）

对于 2 和 3：

```
^(?=.{6,})(?=.*[\d]).*$ 
```

对于 1：

```
^[a-zA-Z].* 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T00:24:17.573

构建匹配 A*和*B*和*C 的“合取”表达式的一般技术是从条件开始，`^`然后将条件列为前瞻组：

```
^(?=A)(?=B)(?=C) 
```

在你的情况下：

```
^(?=[A-Za-z])(?=.{6,})(?=\D*\d) 
```

至于为什么这个 expr 不起作用的问题`$`：

```
^(?=[A-Za-z])(?=.{6,})(?=\D*\d)$ 
```

这是因为它不消耗任何字符，除了虚拟的“输入开始”。当您将 a 附加`$`到它时，它就等同于`^$`，它只能匹配一个空字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T00:24:53.510

> 我的具体需求如下：
> 
> *   以字母开头；
> *   超过6个字符；
> *   至少 1 位数。

那别介意正则表达式。直接测试您想要的属性。

```
len(x) > 6 and x[0].isalpha() and any(c.isdigit() for c in x) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:25:12.963

首先不要假设正则表达式是解决方案。然后考虑其他可用的工具。

以一封信开头：

```
word and word[0].isalpha() 
```

（如果此测试在长度 1 之后进行，则`word and`可以丢弃该位。）

至少六个字符长：

```
len(word) >= 6 
```

至少一位数字：

```
any(letter.isdigit() for letter in word) 
```

不过，最后一个是`O(n)`针对单词长度的，如果您使用 20 个字符而没有数字，由于字符串实例化，它实际上最终会比 RE 解决方案慢；你可以反驳说，如果这个相当冗长的版本会经常出现没有早期数字的长字符串：

```
('0' in word or '1' in word or '2' in word or '3' in word or
'4' in word or '5' in word or '6' in word or '7' in word or
'8' in word or '9' in word) 
```

然后，您可以轻松地将这些组合起来。记住这样的事情，把它放在一个带有适当文档字符串的单独函数中；不要把魔法计算放在其他不相关的事情中间。

```
def word_rule_check(word):
    '''
    Check that the word complies to Rule such-and-such; it must:

    1\. start with a letter,
    2\. be at least 6 characters long, and
    3\. contain at least one digit.
    '''

    return (len(word) >= 6 and
            word[0].isalpha() and
            any(letter.isdigit() for letter in word)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T00:23:55.420

`^(?=.{6,})[a-zA-Z].*\d.*$`是你需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T01:43:14.210

正则表达式在测量长度方面不是很有效，只需使用 python 即可`len()`。至于其他两个条件，试试这个：

```
[a-zA-Z][a-zA-Z0-9]*[0-9][a-zA-Z0-9]* 
```

# jquery - 如果我用 @Html.ActionLink替换 Jmenu jquery 插件将不起作用

> ID：10729586
> 
> 赞同：-1
> 
> 时间：2012-05-24T00:13:32.693
> 
> 标签：jquery, asp.net-mvc-3, jmenu

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:47:34.020

正如评论所说，您应该将“fNiv”类应用于第一级锚。:)

在插件中，它们将所有使用“fniv”类应用的锚点与鼠标悬停事件绑定以显示子菜单。因此，如果您不在父链接上应用“fniv”类，子菜单将永远不会显示。

```
 /* Actions on parents links */
        if(!opts.openClick)
        $('#jMenu li a.fNiv').bind({
            mouseover:function(){
                var $this = $(this);
                var $child = $this.next();
                ULWidth = $.jMenu._returnUlWidth($this);
                $.jMenu._closeList($("#jMenu ul"));
                if($child.is(':hidden'))
                    $.jMenu._showFirstChild($this);
            }
        });
        else
        $('#jMenu li a.fNiv').bind({
            click:function(e){
                e.preventDefault();
                var $this = $(this);
                var $child = $this.next();
                ULWidth = $.jMenu._returnUlWidth($this);
                $.jMenu._closeList($("#jMenu ul"));
                if($child.is(':hidden'))
                    $.jMenu._showFirstChild($this);
            }
        }); 
```

编辑：替换`<a class="fNiv">Home</a>`为这个。 `<%=@Html.ActionLink("Home", "Index", "Home", new { @class="fNiv" })%>` 它应该可以正常工作。

# php - 如何从 Facebook 页面选项卡的内部页面共享内容？

> ID：10729587
> 
> 赞同：4
> 
> 时间：2012-05-24T00:13:37.220
> 
> 标签：php, javascript, facebook

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T05:14:19.087

这不是在 url 中传递变量的正确方法，您需要像这样在 app_data 中传递 Json 对象

```
https://www.facebook.com/pages/PAGENAME/PAGENUMBER?sk=app_PAGETABNUMBER&app_data={"Redirect_Page":"Home.aspx"} 
```

然后，一旦将 app_data 解析为 Json 对象，您就可以在签名请求中获取 app_data，您可以访问 app_data["Redirect_Page"]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:23:52.623

这应该有效，您提供的值`app_data`应该在发布到您应用程序代码的 signed_request 中

# css - 向 wp_nav_menu 添加一个唯一的类

> ID：10729588
> 
> 赞同：0
> 
> 时间：2012-05-24T00:13:37.420
> 
> 标签：css, wordpress, menu

我将如何向使用 wp_nav_menu 生成的主父 ul 元素的直接子 li 元素添加一个唯一类？

**HTML：**

```
<div class="menu_element"></div>
<nav id="access" role="navigation">
  <div class="menu-main-container">
    <ul id="menu-main" class="menu">
      <li id="menu-item-30" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30"><a href="http://www.site/page1-2/">Page1</a>
        <ul class="sub-menu">
          <li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="http://www.site/sub-page1-1/">Sub-Page1-1</a></li>
          <li id="menu-item-49" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-49"><a href="http://www.site/sub-page1-2/">Sub-Page1-2</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav> 
```

**jQuery：**

```
$('#menu-main > .menu-item').mouseenter(function (){
    $('.menu_element').appendTo(this);
    hoverOn();
});
$('#menu-main > .menu-item').mouseleave(function (){
    hoverOff(); 
    $(this).remove($('.menu_element'));
}); 
```

我想将类添加`menu_element`到`li id="menu-item-30"`父 ul 的每个子 li 之后。这可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:25:44.220

当您将选择器用作`.menu-main`(a `class`) 时，您的选择器用于`id`. 你需要：

```
$('#menu-main > .menu-item').mouseenter(function (){
    $('.menu_element').appendTo(this);
    hoverOn();
});
$('#menu-main > .menu-item').mouseleave(function (){
    hoverOff(); 
    $(this).remove($('.menu_element'));
}); 
```

# jquery - 如何使用 jQuery 深入到嵌套数组和对象？

> ID：10729590
> 
> 赞同：0
> 
> 时间：2012-05-24T00:14:01.710
> 
> 标签：jquery, arrays, api, object

我正在尝试使用 Worknik 的 API 通过摆弄 JS 和此处的 API 来迭代给定单词的每个“文本”定义，限制为 3（限制在 URL 参数中）：http: [//jsfiddle.net/p4xF3/ 2/](http://jsfiddle.net/p4xF3/2/)我可以得到我想要控制台登录的对象，但似乎无法使用正确的语法来深入到名为 json 的数组并迭代每个“文本”节点（给定单词的定义）。我想将这些结果附加到代码中的 div 中。这可能几乎没有意义，但我认为如果您查看我上面的 JSfiddle 链接并使用那里的代码针对 Wordnik API 搜索英文单词，我会更清楚。之后检查控制台，您应该明白我的意思。在此先感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:31:32.950

您将返回一个 json 对象数组，因此您必须对其进行迭代并从每个对象中提取“文本”。当您使用 jquery 每个函数时，您基本上已经这样做了，但是您可以将其更改为更传统的循环，如下所示：

```
for (var i = 0; i<cbfunc.query.results.json.json.length; i++)
{
    var textNode = cbfunc.query.results.json.json[i].text;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:02:16.150

最后我觉得很傻，因为这与我钻入对象和数组的方式无关，而是我使用 each() 的方式。我应该这样做：

```
$(cbfunc.query.results.json.json).each(function () {
            var wordl = this.text;
            var tmpl = '<p>' + wordl + '</p>';
            $(tmpl).appendTo(".tryout");
}); 
```

# html - 图像不会完全显示

> ID：10729592
> 
> 赞同：0
> 
> 时间：2012-05-24T00:14:10.650
> 
> 标签：html, css, dreamweaver

下面是我用于我的网站的 CSS 模板。当我尝试将我的 Logo 添加到我的 div 时，我只是遇到了问题`#title`，只显示了一半的图像（高度）。我认为我的边距有问题，但我无法弄清楚为什么无论我如何调整它的大小或更改边距大小，图像都不会显示完整的高度（宽度似乎还可以）。

你能提出解决方案吗？

```
html {
    overflow: hidden;
    height: 99%;
}

body {
    background: $ffffff;
    height: 99%;
    margin: 0;
    padding: 0;
    line-height: 150%;
    text-align: center;
}

* {
    font-size: 8pt; 
    font-family: Tahoma, Verdana, sans-serif; 
    color: #000000;
    text-align: left;
}

/* === Containers === */

#mainContentArea {
    margin: 0 auto 0 auto; 
    display: table; 
    height: 100%;  
    position: relative; 
    overflow: hidden; 
    width: 600px;
}

.link,.linkActive {
    width:75px;
    margin-right:10px;
    float: left;
    margin-top:24px;
    text-align:center;
    font-family:Georgia, "Times New Roman", Times, serif;
    background-image:url(tab.gif);
    position:relative; bottom:0px;
}

.link:hover { background-image:url(tab2.gif); }

a { text-decoration:none; }

.link a {
    font-family:Arial, Helvetica, sans-serif;
    font-size:12px;
    font-weight:bold;
}

#linkGroup {
    margin-right:10px;
    height:40px;
    width:600px;
}

#title {
    width:230px;
    height:40px;
    margin-right:20px;
    margin-top:15px;
    font-family:Verdana, Arial, Helvetica, sans-serif;
    font-size:20px;
    font-weight:bold;
    text-align:center;
    float:left;
}

.contentTitle {
    font-family:Verdana, Arial, Helvetica, sans-serif;
    color:#213E74;
    font-size:19px;
    margin-left:15px;
    margin-right:12px;
    margin-bottom:12px;
    width:573px;
}

.pageContent {
    font-family: Arial, Helvetica, sans-serif;
    color:#000000;
    font-size:12px;
    margin-left:20px;
    margin-right:20px;
    width:560px;
}

#blueBox {
    position: absolute;
    vertical-align: middle;
    background-color:#E7EDF8;
    width:600px;
    clear:both;
}

#header {
    width:600px;
    height:20px;
    background-color:#FFFFFF;
    background-image:url(header.gif);
    background-repeat:no-repeat;
}

#footer {
    width:600px;
    height:20px;
    background-color:#FFFFFF;
    background-image:url(footer.gif);
    background-repeat:no-repeat;
    text-align:center;
    padding-right:10px;
    color:#BDCDEC;
}

#footer a {
    font-size:9px;
    color:#BDCDEC;
}

#contentBox { margin-top:25px; }

html, body { text-align: center; }

p {text-align: left;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:32:37.117

为我工作`margin-top: 15px;`。`#title`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T08:00:15.427

去除

```
 width:230px;
   height:40px; 
```

从CSS并保持

```
<img src="image " width="" height=""></img> 
```

# java - java 检查双嵌套哈希图中的键是否存在

> ID：10729597
> 
> 赞同：4
> 
> 时间：2012-05-24T00:14:32.337
> 
> 标签：java

我有一个哈希映射的双嵌套哈希映射，并且想要检查键是否存在并放置新值。目前我正在嵌套 if 语句以检查每个级别的键是否存在。有没有更有效的编码方式？

```
HashMap<Foo1, HashMap<Foo2, HashMap<Foo3, Double>>> my_map = new HashMap<Foo1, HashMap<Foo2, HashMap<Foo3, Double>>>();

if (my_map.containsKey(foo1key)) {

    if (my_map.get(foo1key).containsKey(foo2key)) {

        if (my_map.get(foo1key).get(foo2key).containsKey(foo3key)) {

             return my_map.get(foo1key).get(foo2key).get(foo3key);
        }
    }
}

double foo3key = getValue();

// do the above steps again to put foo3key into map. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:31:14.103

最有效的方法（假设您的值始终为非空）如下：

```
HashMap<Foo2, HashMap<Foo3, Double>> map2 = my_map.get(foo1Key);
if(map2!=null) {
  HashMap<Foo3, Double> map3 = map2.get(foo2Key);
  if (map3!=null) {
    Double value = map3.get(foo3Key);
    if (value!=null) {
      return (double)value;
    } else {
      // add value to map3, or whatever
    }
  }
} 
```

这利用了以下技术：

*   如果get()返回null，就知道key不存在（因为不允许null值）
*   保存上一次get的返回值，方便下次查找，这样就不需要把gets链在一起了

不过，这有点混乱-如果您经常进行这种操作，那么我建议您将其分解为一个单独的函数，这样您就可以这样做：

```
double value = getNestedValue(my_map,foo1Key,foo2Key,foo3Key); 
```

# vb.net - VB.NET：将包含“姓氏，名字”的字符串转换为“名字姓氏”

> ID：10729605
> 
> 赞同：2
> 
> 时间：2012-05-24T00:15:38.323
> 
> 标签：vb.net, string

我正在尝试将包含某人姓名为“Last, First”的字符串转换为“First Last”。

这就是我现在的做法：

```
name = name.Trim
name = name.Substring(name.IndexOf(",") + 1, name.Length) & " " & name.Substring(0, name.IndexOf(",") - 1) 
```

当我这样做时，我收到以下错误：

> ArgumentOutOfRangeException 未处理
> 
> 索引和长度必须引用字符串中的位置
> 
> 参数名称：长度

有人可以解释为什么我会收到这个错误以及我应该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T00:18:36.877

您对此有错误：

```
name.Substring(name.IndexOf(",") + 1, name.Length) 
```

`name.Length`应该减去*逗号之前的*字符串长度。

最好的方法是拆分字符串。

```
Dim oFullname as string = "Last, First"
Dim oStr() as string = oFullname.split(","c)
oFullname = oStr(1).trim & " " & oStr(0).trim
MsgBox (oFullname) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:22:34.677

简单地说，你只需要拆分字符串

```
Dim originalName As String = "Last,First"
Dim parts = name.Split(","C)
Dim name As String = parts(1) & "  " & parts(0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:23:38.593

for的第二个参数[`String.Substring`](http://msdn.microsoft.com/en-us/library/aka44szs.aspx)是子串的长度，不是结束位置。出于这个原因，如果你`str.Substring(n, str.Length)`使用 n > 0 （这将是子字符串的全部点），你总是会越界。

您需要`name.IndexOf(",") + 1`从`name.Length`第一个子字符串中减去。或者只是拆分字符串，正如其他人所建议的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-10T07:25:21.553

如果你使用的是 Unix 命令行——比如 Mac 上的终端——你可以这样做：

假设您有一个文件，其中包含您的 last-comma-space-first 类型名称，如下所示：

```
Last1, First1
Last2, First2
Last3, First3 
```

好的，现在让我们将其另存为`last_comma_space_first.txt`. 此时，您可以使用我为您的特定问题提出的这个命令：

```
sed -E 's/([A-Za-z0-9]+), ([A-Za-z0-9]+)/\2 \1/g' last_comma_space_first.txt > first_space_last.txt 
```

--->>> 滚动--->>>

你完成了！现在，去检查那个`first_space_last.txt`文件！^_^ 你应该得到以下信息：

```
First1 Last1
First2 Last2
First3 Last3 
```

告诉你的朋友……或者不要……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T16:57:25.143

这将保持海报格式。

```
Name = "Doe,John"
Name = Replace(Name.Substring(Name.IndexOf(","), Name.Length - Name.IndexOf(",")) & " " & Name.Substring(0, Name.IndexOf(",")), ",", "") 
```

结果名称 = "John Doe"

# iphone - 请求成员不是结构或工会 - iOS

> ID：10729607
> 
> 赞同：0
> 
> 时间：2012-05-24T00:16:44.473
> 
> 标签：iphone, objective-c, ios, ios4

我想更改在 MainWindows.xib 中加载的默认视图。所以我为要添加的类添加了一个新的实例变量，这里的视图是.h中的代码

```
 @class Table;
@interface GameUIAppDelegate : NSObject <UIApplicationDelegate> {
UIWindow *window;
Table *viewController; //changed the class
 }
@property (nonatomic, retain) IBOutlet UIWindow *window;
@property (nonatomic, retain) IBOutlet Table *viewController; 
```

然后在 MainWidow.xib 我更改了 UIView 上的类名和 xib

在他们中

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

// Override point for customization after application launch.

// Add the view controller's view to the window and display.
[self.window addSubview:viewController.view]; //error here 
[self.window makeKeyAndVisible];

return YES;
 } 
```

我错过了什么，请解释我为什么会收到此错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:06:53.490

你需要`#import "Table.h"`在你的 .m 文件中。

# ruby-on-rails - Rails：检查has_many中是否存在关联

> ID：10729609
> 
> 赞同：2
> 
> 时间：2012-05-24T00:17:02.350
> 
> 标签：ruby-on-rails, conditional-statements, has-many

是否可以检查 has_many 中是否存在多个关联？在这种情况下，我想检查是否有一本书具有三个标签“a”、“b”和“c”。

（书和标签通过多对多关联。）

```
if Book.all.tags.find("a", "b", "c").any?
  # Yay!
  # There is at least one book with all three tags (a, b & c)
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T00:41:07.610

我认为这可以解决问题（适用于`has_many`）：

```
Book.includes(:tags).where(tags: { name: ['a', 'b', 'c'] }).any? 
```

分解它：

这`includes`告诉 Rails 使用预先加载来加载标签，而不是一次加载一个。这也导致它`tags`在查询中注意并生成更智能的查询。

`where`条件非常简单，传递数组只是将比较`=`转换为`IN ('a', 'b', 'c')`条件。

Rails`any?`对 .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T14:36:45.893

我使用这个查询结构：

```
Book
  .select('distinct books.*')
  .joins(:tags)
  .where('tags.slug' => ['a', 'b', 'c'])
  .group("pages.id")
  .having("count(*) = #{['a', 'b', 'c'].size}") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:13:27.500

我从来没有找到一种优雅的方式来解决这个问题，所以希望其他人能提供更好的答案。

野蛮的方法是下拉到sql。我是在内存不足的情况下写的，所以可能存在语法问题。

Book 模型中的类似内容。表的短名称不会与父查询冲突。

```
def self.with_tag(tag)
    where("EXISTS (SELECT 1 from books_tags bt, tags t where bt.tag_id = t.id 
    and bt.book_id = books.id and t.name = ?)", tag)
end 
```

然后你会调用`Book.with_tag('a').with_tag('b').with_tag('c')`或定义另一个方法。不确定是否需要范围变量。

```
def self.with_all_tags(tags) 
    scope = self.scoped
    tags.each do |t|
        scope = scope.with_tag(t)
    end
end 
```

# java - 提取单词的第一个字符以创建首字母缩略词

> ID：10729611
> 
> 赞同：-1
> 
> 时间：2012-05-24T00:17:22.833
> 
> 标签：java

如何使用 split 或 stringtokenizer 仅获取每个单词的第一个字符来创建首字母缩写词？它还将包括“&”符号。而且它不区分大小写

示例：

*   某种长字符串---> SKOLS
*   另一种长字符串 ---> AKOLS
*   字符串&字符串---> s&s

这样做的原因是因为我有一个填充表的查询，并且由于列名是 3 个或更多单词。它会拉伸表格，即使放置了滚动条，100 多列的长名称也会使它看起来很长。所以我想通过仅使用首字母缩略词并生成图例来减少空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:42:41.963

首先，您需要将`String`at 拆分为“”或“&”。

您可以对字符串使用“拆分”方法。[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split(java.lang.String](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split(java.lang.String) )

正则表达式可以是空格或 & 号。然后，您将使用该`charAt`方法获取索引 0 处的字符。您将连接这些字符以获取首字母缩写词。

# java - 在Java中将字符串颜色（“0x5b9f18”）转换为十六进制颜色

> ID：10729612
> 
> 赞同：1
> 
> 时间：2012-05-24T00:17:39.510
> 
> 标签：java

公共类 Hexcolor {

```
public static void main(String[] args) {
    String a="0x5b9f18";
    String hexColor = String.format("#%06X", a);
    System.out.println(hexColor);
} 
```

}

错误信息

线程“main”中的异常 java.util.IllegalFormatConversionException: x != java.lang.String at java.util.Formatter$FormatSpecifier.failConversion(Unknown Source) at java.util.Formatter$FormatSpecifier.printInteger(Unknown Source) at java .util.Formatter$FormatSpecifier.print(Unknown Source) at java.util.Formatter.format(Unknown Source) at java.util.Formatter.format(Unknown Source) at java.lang.String.format(Unknown Source) at Hexcolor .main(Hexcolor.java:6)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:23:32.690

不知道你在问什么...

```
public static void main(String[] args) {
  int a = 0x5b9f18;
  String hexColor = String.format("#%06X", a);
  System.out.println(hexColor);
} 
```

或者

```
public static void main(String[] args) {
   String a="0x5b9f18";
   String hexColor = "#" + a.substring(2);
   System.out.println(hexColor);
} 
```

# ruby-on-rails - 时间没有在heroku中更新

> ID：10729618
> 
> 赞同：5
> 
> 时间：2012-05-24T00:19:11.160
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, postgresql, heroku

我很困惑可能出了什么问题。

我已登录`heroku run console`并尝试更新数据库上的时间戳。

我跑去`User.find(6)`看到用户有一个`:next_click = 2000-01-01...`我不知道为什么它是那个值，但无论如何，我知道`User.update 6, {:next_click => Time.utc(2015)}`它似乎正确更新说`2015-01-01 00:00:00`，但是当我做另一个`User.find(6)`时，时间似乎已经切换回来，因为它不是`2015-01-01 00:00:00`。

我真的很困惑为什么不是。有什么见解吗？

见附件截图![在此处输入图像描述](../Images/186db627d8db2153a907e1189b19b2d4.png)

```
irb(main):033:0> User.update 6, {:next_click => Time.utc(2015) }
  User Load (34.0ms)  SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 6]]
   (1.8ms)  BEGIN
   (2.2ms)  UPDATE "users" SET "next_click" = '2015-01-01 00:00:00.000000', "updated_at" = '2012-05-24 00:13:26.197358' WHERE "users"."id" = 6
   (2.2ms)  COMMIT
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2015-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 00:13:26">
irb(main):034:0> User.find(6)
  User Load (2.4ms)  SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 6]]
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2000-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 00:13:26"> 
```

`u = User.find(6)` `u.next_click = Time.utc(2013)`然后同样的事情发生`u.save`

```
irb(main):001:0> u = User.find(6)
  User Load (38.8ms)  SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 6]]
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2000-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 00:57:28">
irb(main):002:0> u.next_click = Time.utc(2013)
=> 2013-01-01 00:00:00 UTC
irb(main):003:0> u
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2013-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 00:57:28">
irb(main):004:0> u.save
   (10.9ms)  BEGIN
   (3.7ms)  UPDATE "users" SET "next_click" = '2013-01-01 00:00:00.000000', "updated_at" = '2012-05-24 03:05:46.059530' WHERE "users"."id" = 6
   (2.2ms)  COMMIT
=> true
irb(main):005:0> u
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2013-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 03:05:46">
irb(main):006:0> User.find(6)
  User Load (33.0ms)  SELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT 1  [["id", 6]]
=> #<User id: 6, name: "mazlix", gold: 10, points: 10, next_click: "2000-01-01 00:00:00", created_at: "2012-05-23 23:40:39", updated_at: "2012-05-24 03:05:46"> 
```

**`app/models/user.rb:`**

```
class User < ActiveRecord::Base
  attr_accessible :gold, :name, :next_click, :points
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T07:29:03.130

您已经创建了一个时间列。有点令人困惑的是，即使在 ruby​​ 中`Time`存储时间 + 日期，在数据库世界中，存在纯时间的概念（即只有几小时/分钟/秒），这就是当您添加一列类型 :time 到您的移民。

Ruby 本身没有代表没有日期的时间的类，因此 rails 使用了一个实例`Time`但忽略了日期位。

如果您想要一个同时存储时间和日期的列，请将列更改为 :datetime 列（`Time`在大多数情况下，您仍然会得到一个实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T21:42:54.160

在您的 ActiveRecord 中可以使用数据类型`:timestamp`或`:datetime`存储正确的日期格式。

# javascript - 使用 JavaScript 访问特定于供应商的 CSS 属性

> ID：10729620
> 
> 赞同：4
> 
> 时间：2012-05-24T00:19:56.420
> 
> 标签：javascript, css, dom

我很好奇如何通过本机javascript访问/修改属性`-moz-transition`（或[此列表中](http://peter.sh/experiments/vendor-prefixed-css-property-overview/)的任何属性），即不依赖jQuery`.css('property', 'value');`

例如，要更改元素的元素，`background-color`可以使用`element.style.backgroundColor`.

供应商特定的属性名称是否只是驼峰式命名并变得可操作？我不能这样做，也许它们不再由属性表示`style`并且应该在其他地方进行修改？或者可能根本无法通过 DOM 访问它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:31:48.783

使用大写驼峰式，例如，`el.style.MozTransition`。

示例：http: [//jsfiddle.net/R3y6f/1/](http://jsfiddle.net/R3y6f/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T00:30:20.073

例如：-webkit-box-shadow

```
.style.setProperty("-webkit-box-shadow", "0 0 7px #ccc", null);
.style.removeProperty("-webkit-box-shadow");
.style["-webkit-box-shadow"]; 
```

# android - 井字游戏应用程序使用 android:button

> ID：10729621
> 
> 赞同：0
> 
> 时间：2012-05-24T00:19:56.530
> 
> 标签：android

我正在尝试使用 android:button 构建一个井字游戏应用程序。现在我正在考虑设计它的最佳方法，因为我不确定如何检测彼此相邻的按钮。现在我有硬编码的东西，我如何检测按钮是否彼此相邻？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:27:02.937

将 id 与行/列主要模式/二维按钮数组一起使用，这使得很容易确定相邻的按钮，例如 (3x3) ：

```
00 01 02
10 11 12
20 21 22 
```

或者

```
00 10 20
01 11 21
02 12 22 
```

* * *

这是一个完整的示例：[井字游戏](http://hackingheart.wordpress.com/2012/03/08/how-to-built-android-apps-tic-tac-toe/)，也可以看看[井字游戏 2](http://www.androidadb.com/source/tictactoe4android-read-only/src/com/android/project/TicTacToe.java.html)

# php - Zend 框架中的匹配 url，包括查询字符串

> ID：10729624
> 
> 赞同：1
> 
> 时间：2012-05-24T00:20:11.510
> 
> 标签：php, zend-framework, zend-route

我有一个自定义路由器（实现`Zend_Controller_Router_Route_Interface`），我想要：

*   `/foo?action=bar`要路由到的这个 url`{module->a, controller->b, action->bar}`
*   而 url`/foo`被路由到`{module->a, controller->b, action->c}`

**即** `action`查询字符串中的参数（如果存在）正在确定默认操作。

我正在使用`Zend_Controller_Router_Rewrite`路由器，问题是它只将pathInfo（即没有查询字符串）传递给`match()`路由器的方法。

我可以手动从前端控制器获取请求对象并提取“动作”参数，但是有没有更好的方法来解决这个问题？

# visual-studio-2010 - 无法识别 RelatedTo 属性，即使在安装 Entity Framework 4.1 之后也是如此

> ID：10729627
> 
> 赞同：0
> 
> 时间：2012-05-24T00:20:19.853
> 
> 标签：visual-studio-2010, entity-framework, code-first, asp.net-mvc-4

我正忙于学习 ASP.Net MVC，所以我最近在 Visual Studio 2010 Professional 上安装了 MVC 4。我正在尝试这个例子：

[http://www.luisrocha.net/2010/11/creating-composite-keys-using-code.html](http://www.luisrocha.net/2010/11/creating-composite-keys-using-code.html)

但是Visual Studio 找不到*RelatedTo属性。*[我在这个问题](https://stackoverflow.com/questions/5499969/entity-framework-ctp-5-relatedto-attribute-not-working)上读到这可能是由于未安装 Entity Framework 4.1 造成的。*我检查了System.Data.Entity.dll*的版本号，它给出了版本 4.0.0.0，运行时版本 v4.0.30319。所以在我看来，这似乎是安装在我的计算机上的 EF 4.0 版。我可能在这方面是错的......所以如果我是，请有人纠正我。

[我从这里](http://www.microsoft.com/en-us/download/details.aspx?id=26825)下载了 EF 4.1并安装了它，但*System.Data.Entity.dll*的版本号似乎没有改变，并且*RelatedTo*属性仍然不起作用。任何人都知道安装出了什么问题以及我该如何解决？

**更新：**

[我按照该站点](http://nuget.org/packages/EntityFramework)上的说明使用nuget安装了Entity Framework ，控制台说它安装了*EntityFramework 5.0.0-rc*，但*System.Data.Entity.dll*的版本似乎没有改变。

不，我没有包括*使用 System.Data.Entity*，因为智能感知没有告诉我包括在内。我确实包含了*System.ComponentModel.DataAnnotations*并*使用了 System.ComponentModel.DataAnnotations.Schema*，因为*Key*和*Column*属性需要这些。Intellisense 要求我*“为 'RelatedTo' 生成类”*并*使用 System.Data.Entity*添加并不会改变这一点。

这是我为那些要求它的人提供的代码，尽管它正是我在问题中链接到的教程中的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Data.Entity;

namespace Example
{
    public class PlaylistTrack
    {
        [Key, Column(Order = 1)]
        public int PlaylistId { get; set; }

        [Key, Column(Order = 2)]
        public int TrackId { get; set; }

        [RelatedTo(ForeignKey = "PlaylistId")]
        public Playlist Playlist { get; set; }

        [RelatedTo(ForeignKey = "TrackId")]
        public Track Track { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:10:06.957

Try installing new version of EF using Nuget. It will resolve all dependencies of EF and it will make sure you have the latest version. I don't know what is `RelatedTo` attribute supposed to be doing here. And see [here](http://blogs.msdn.com/b/adonet/archive/2011/03/15/ef-4-1-code-first-walkthrough.aspx) in the data annotations section, the related to attribute is not in the EF4.1 release. But you can do the same thing like this.

```
 [ForeignKey("PlaylistId")] 
      public Playlist Playlist { get; set; }

      [ForeignKey("TrackId")] 
      public Track Track { get; set; } 
```

**EDIT** [RelatedTo attribute is replaced by ForeignKey and InverseProperty attributes in EF 4.1 RC](https://stackoverflow.com/questions/5716528/entity-framework-4-1-inverseproperty-attribute)

# ios - NSDictionary 的不区分大小写的键

> ID：10729628
> 
> 赞同：6
> 
> 时间：2012-05-24T00:20:20.587
> 
> 标签：ios, objective-c, cocoa, ios5, nsdictionary

我正在尝试对 NSDictionary 上的 JSON 响应使用区分大小写的大小写，因为有时我的响应键类型会有所不同，有些是驼峰式，有些是小写或其他混合组合。是否有任何内置功能可以检查这种情况下的不敏感情况？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-23T09:18:42.267

最近我分享了两个可能适合您需求的课程。它们提供不区分大小写的操作（以`NSDictionary`和`NSMutableDictionary`方法命名），同时保留最初插入的键。

试试看：

[https://github.com/keeshux/ios-components/tree/master/Components/Utils/KSCIDictionary](https://github.com/keeshux/ios-components/tree/master/Components/Utils/KSCIDictionary)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T00:48:46.563

最好的方法是将 NSDictionary 的键设置为全部小写或全部大写；

例如，假设我有一个 NSArray 字符串。我可以在使用之前获取 keyName 并使用小写字符串或大写字符串进行转换

```
NSString *itemName = @"lastName"; 
itemName = [itemName lowercaseString]; 
```

这会将字符串更改为姓氏，或者如果我使用大写字符串，它将是 LASTNAME

或者您也可以在添加到字典时更改键名，如下所示：

```
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
[dict setObject:objectToAdd forKey:[key uppercaseString]]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T00:36:07.050

```
- (NSString *)lowercaseString 
```

这是一个默认的 NSString 方法，只需在添加或读取 NSMutableDictionary 时执行 [key lowercaseString]。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-12T04:44:44.687

就我而言，我不需要所有 Dictionary 方法或属性。我只需要不区分大小写的下标访问。我创建了一个自定义类（*不是*NSMutableDictionary 的超类）并实现了允许下标访问并使这些不区分大小写的方法：

```
- (id) objectForKeyedSubscript: (NSString *) key {
    NSMutableDictionary *theData = self->data;
    return theData[[key lowercaseString]];
}

- (void) setObject: (id) newValue forKeyedSubscript: (NSString *) key {
    NSMutableDictionary *theData = self->data;
    theData[[key lowercaseString]] = newValue;
} 
```

另见： [http ://clang.llvm.org/docs/ObjectiveCLiterals.html](http://clang.llvm.org/docs/ObjectiveCLiterals.html)

# sql - 如何根据最小值和最大值生成具有一系列数字的列

> ID：10729630
> 
> 赞同：0
> 
> 时间：2012-05-24T00:20:42.360
> 
> 标签：sql, oracle, plsql

我有一个结构如下的表：

```
fake_id          start          end          misc_data
------------------------------------------------------
1                101            105          ab
1                101            105          cd
1                101            105          ef
2                117            123          gh
2                117            123          ij
2                117            123          kl
2                117            123          mn
3                51             53           op
3                51             53           qr 
```

请注意，fake_id 字段并不是真正的主键，而是重复的次数等于 start 和 end 指定的范围内不同奇数的数量。每条记录的*真实*id 是该范围内的奇数之一。我需要编写一个查询，返回 fake_id、misc_data 和包含这些奇数的另一列以生成真实 id，如下所示：

```
fake_id          real_id          misc_data
------------------------------------------
1                101              ab
1                103              cd
1                105              ef
2                117              gh
2                119              ij
2                121              kl
2                123              mn
3                51               op
3                53               qr 
```

据我所知，不能保证序列中不会有间隙（例如，范围 21-31 可能没有记录）。我如何告诉查询（或过程，但查询更可取）对于具有特定 fake_id 的每条记录，它应该返回开始和结束之间的下一个奇数？

另外，有没有办法让 misc_data 的值属于特定的 real_id？以第二个表为例，我如何告诉查询“ab”属于 real_id 101 而不是 103？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:37:36.007

在这里猜测您打算排序`misc_data`：

```
SELECT "fake_id",
       ((ROW_NUMBER()OVER(PARTITION BY "start"
                        ORDER BY "misc_data")-1)*2)+"start" AS "real_id",
       "misc_data"
FROM t
ORDER BY "misc_data"; 
```

[http://www.sqlfiddle.com/#!4/ae23c/23](http://www.sqlfiddle.com/#!4/ae23c/23)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:37:00.430

很抱歉没有尽快回复或对个别评论作出回应。@John Dewey，我相信当我尝试你的脚本时，它并没有正确地保持起始系列之间的差距，但我有动力去了解更多关于`PARTITION`关键字的信息，我认为我现在更加开明了。

由于这是针对 ETL 任务，我最终编写了代码以在提取（我猜它也算作转换）端的循环中生成真实 ID。

# java - JNA system() 是否避免分叉

> ID：10729632
> 
> 赞同：2
> 
> 时间：2012-05-24T00:21:13.843
> 
> 标签：java, runtime, exec, jna

我正在尝试寻找不使用 fork 的 Java Runtime.exec() 替代方案。问题是我们的 JVM 消耗了大部分内存，并且该进程上的 Runtime.exec 分叉可能会导致内存问题，即使是写入时复制和过度使用（这在 stackoverflow 中经常讨论，请参阅[Java Runtime.getRuntime().exec () 替代品](https://stackoverflow.com/questions/2876964/java-runtime-getruntime-exec-alternatives))。

在另一个 stackoverflow 帖子中，提出了使用 JNA 的解决方案，但是没有对此解决方案的评论，并且评价不高：[如何解决“java.io.IOException：错误= 12，无法分配内存”调用 Runtime#exec( )?](https://stackoverflow.com/questions/1124771/how-to-solve-java-io-ioexception-error-12-cannot-allocate-memory-calling-run)

同样，这里提出了类似的 JNA 解决方案：http: [//sanjitmohanty.wordpress.com/2011/12/20/overcoming-runtime-exec-havoc-with-jna/](http://sanjitmohanty.wordpress.com/2011/12/20/overcoming-runtime-exec-havoc-with-jna/)

我的问题是：使用 JNA 进行系统调用是否会阻止分叉，是否避免了分叉可能导致的后续内存分配问题？这是我正在使用的代码：

```
public class TestJNA {
 private interface CLibrary extends Library {
    CLibrary INSTANCE = (CLibrary) Native.loadLibrary("c", CLibrary.class);
    int system(String cmd);
 }
 private static int exec(String command) {
    return CLibrary.INSTANCE.system(command);
 }
 public static void main(String[] args) {
    exec("ls");
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:24:24.913

[`system`](http://pubs.opengroup.org/onlinepubs/009604499/functions/system.html)不需要做一个[`fork`](http://pubs.opengroup.org/onlinepubs/009604499/functions/fork.html)（或同等的），而 JNA 对此无能为力。

我不认为人们建议您使用 JNA 来调用`system`，而是建议您进行实际的系统调用。例如，该博客给出`chmod`和`chown`作为示例。因此，使用您的示例，而不是使用 JNA 来调用`system('ls')`，调用`opendir`和`readdir`（当然，这同样适用于您真正调用的任何内容）。

您可能必须制作一个 DLL 来包装所需的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T00:26:42.207

可能不是。您正在调用的实现`system()`几乎肯定是在使用`fork()`它自己——C 实现看起来像：

```
int system(const char *cmd) {
    if (fork() == 0) {
        execl("/bin/sh", "-c", cmd);
        _exit(1);
    }
    int result;
    wait(&result);
    return WEXITSTATUS(result);
} 
```

一个更可行的解决方案是保持与一个小型外部进程的通信线路（例如管道），该进程可以为您生成子进程。Android 做了很多类似的事情；外部过程称为“合子”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:24:49.677

没有 fork() 就不可能执行“系统”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-26T10:04:26.503

那么 system() 是如何工作的呢？如果它还在使用叉子？我遇到了这个错误“java.io.IOException：error = 12，无法分配内存”的问题，这为我解决了这个问题：

```
private interface CLibrary extends Library {
            CLibrary INSTANCE = (CLibrary) Native.loadLibrary(("c"), CLibrary.class);
        int system(String cmd);
    }

    private static int exec(String command) {
        return CLibrary.INSTANCE.system(command);
    } 
```

# php - 随机排序的PHP MySQL分页

> ID：10729633
> 
> 赞同：18
> 
> 时间：2012-05-24T00:21:31.847
> 
> 标签：php, mysql

这是在我的网站上订购搜索结果的问题，

进行搜索时，内容页面上会出现随机结果，该页面也包括分页。我将用户作为我的 SQL 查询。

```
SELECT * FROM table ORDER BY RAND() LIMIT 0,10; 
```

所以我的问题是

1.  我需要确保每次用户访问下一页时，他们已经看到的结果不会再次出现（在下一个查询中排除它们，以一种内存有效的方式，但仍按 rand() 排序）

2.  每次访问者进入第一页时，都会有一组不同的结果，是否可以使用分页，或者排序总是随机的。

3.  我可以在 MYSQL 中使用种子，但是我不确定如何实际使用它..

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-05-17T02:01:34.037

**使用 RAND(SEED)**。引用文档：“*如果指定了常量整数参数 N，则将其用作种子值。* ”（[http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_rand](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_rand)）。

在上面的示例中，结果顺序是 rand，但始终相同。您只需更改种子即可获得新订单。

```
SELECT * FROM your_table ORDER BY RAND(351); 
```

您可以在用户每次点击第一个结果页面时更改种子并将其存储在用户会话中。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-24T02:55:10.170

MySQL 中的随机排序是一个棘手的问题。过去，我通常选择尽可能绕过这个问题。通常，用户不会超过一次或两次返回到这样的一组页面。因此，这使您有机会避免所有各种令人作呕的随机顺序实现，而支持几个简单但不是 100% 的随机解决方案。

## 解决方案 1

从已编入索引以供排序的许多现有列中进行选择。这可以包括创建时间、修改时间或您可以排序的任何其他列。当用户第一次访问该站点时，将这些方便地放在一个数组中，随机选择一个，然后随机选择`ASC`或`DESC`。

在您的情况下，每次用户返回第 1 页时，选择新的内容并将其存储在会话中。每个后续页面，您都可以使用该排序来生成一组一致的分页。

## 解决方案 2

您可以有一个额外的列来存储用于排序的随机数。显然，它应该被索引。定期运行以下查询；

> 更新表 SET rand_col = RAND();

这可能不适用于您的规格，因为您似乎要求每个用户每次点击第 1 页时都看到不同的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:30:31.493

首先，您应该停止使用 ORDER BY RAND 语法。这将不利于大量行的性能。

您需要手动确定 LIMIT 约束。如果您仍想使用随机结果并且您不希望用户在下一页看到相同的结果，唯一的方法是将此搜索会话的所有结果保存在数据库中，并在用户导航到下一页时操作此信息。

在网页设计中你应该明白的下一件事——在你的网站上使用任何随机数据块对用户的视觉感知非常、非常、非常不利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T01:01:53.870

的组合

1.  随机排序
2.  分页
3.  HTTP（无状态）

就像它一样丑陋：1\. 和 2\. 一起需要某种“持久随机性”，而 3\. 使这更难实现。最重要的是 1\. 不是 RDBMS 优化的工作。

我的建议取决于您的数据集有多大：

**几行（约<1K）：**

*   在第一个查询中选择所有 PK 值（第一页）
*   在 PHP 中随机播放这些
*   在会话中存储洗牌列表
*   对于每个页面调用，根据存储的 PK 选择数据

**许多行（10K+）：**

这假设，您有一个`AUTO_INCREMENT`唯一的密钥，称为`ID`具有可管理数量的孔。如果需要，使用 amintenace 脚本（高删除率）

*   使用使用会话 ID 等参数化的改组函数来创建函数`rand_id(continuous_id)`
*   如果您需要例如记录 100,000 到 100,009 计算`$a=array(rand_id(100,000), rand_id(100,001), ... rand_id(100,009));`
*   `$a=implode(',',$a);`
*   `$sql="SELECT foo FROM bar WHERE ID IN($a) ORDER BY FIELD(ID,$a)";`
*   要解决您 ID 中的漏洞，请选择过多的记录（并丢弃 exess），循环选择的记录太少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T00:37:11.113

你有几个问题要处理！我建议你一步一步来。

**第一个问题：** ^(*他们已经看到的结果不再出现*)

1.  返回的每个项目，将其存储在一个数组中。^(*（假设`id`示例中的索引）*)
2.  当用户转到下一页时，将[NOT IN](http://dev.mysql.com/doc/refman/5.0/en/any-in-some-subqueries.html)传递给查询：

**MySQL 查询**

```
SELECT * FROM table WHERE id NOT IN (1, 14, 25, 645) ORDER BY RAND() LIMIT 0,10; 
```

*这样做是为了匹配所有`id`不是 1、14、25 或 645 的值。*

* * *

**就性能问题而言：** ^(*以内存有效的方式*)

```
SELECT RAND( )
FROM table
WHERE id NOT
IN ( 1, 14, 25, 645 )
LIMIT 0 , 10 
```

*显示第 0 - 9 行（共 10 行，查询耗时 0.0004 秒）*

**和**

```
SELECT *
FROM table
WHERE id NOT
IN ( 1, 14, 25, 645 )
ORDER BY RAND( )
LIMIT 0 , 10 
```

*显示第 0 - 9 行（共 10 行，查询耗时 0.0609 秒）*

所以，不要使用 ORDER BY RAND()，最好使用 SELECT RAND()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T00:30:43.543

我会让你的 PHP 生成你的随机记录数或行来检索，将它们传递给你的查询，并在用户的客户端上保存一个 cookie，表明他们已经看到了哪些记录。

该用户特定数据没有理由存在于服务器上（除非您正在跟踪它，但无论如何它都是随机的，所以谁在乎）。

# matlab - 图像处理中频域高斯LPF与理想LPF的区别

> ID：10729636
> 
> 赞同：2
> 
> 时间：2012-05-24T00:22:33.563
> 
> 标签：matlab, image-processing, textures, fft

我正在使用相同的图像，我还需要从此链接中发布的图像中删除纹理

[如何使用matlab从图像中删除纹理？](https://stackoverflow.com/questions/6080393/how-can-i-remove-the-texture-from-an-image-using-matlab)

对此进行了讨论，我很困惑真正需要哪个滤波器（高斯 LPF 或理想低通），这背后的原因是什么。哪些频率有助于这种纹理？？？？请有人解释一下！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T01:44:21.013

理想的低通滤波器将保持所有空间频率低于标称空间频率，并去除所有高于它的空间频率。不幸的是，真正的理想低通滤波器具有无限支持（即，具有无限大的非零空间扩展）。即使是对理想低通滤波器的实际近似也有很大的空间支持。

另一方面，高斯在过滤掉哪些频率方面并不理想。空间域中的高斯结果是空间频率域中的高斯。也就是说，它不会产生非常尖锐的空间频率选择性。优点是滤波器的空间支持很小。人们为此使用高斯滤波器，因为它们主要是方便的。与会产生振铃伪影的理想低通滤波器相比，使用高斯滤波往往看起来“自然”。

Lanczos 滤波器（加窗 sinc 滤波器）也是另一种选择，因为它的空间支持较小，并且比高斯滤波器更接近理想滤波器。

但是，哪个更适合您的形象很大程度上取决于您想要做什么。虽然它背后有重要的理论，但在图像处理中这样的定性选择在很大程度上是一门艺术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:15:16.903

您正在寻找的过滤器类型在理想情况下是非线性的：在没有大规模梯度（边缘）的区域进行平滑处理，并且在要保留的边缘附近几乎没有平滑处理。

这里有两种选择：

桑原过滤器：http: [//homepage.tudelft.nl/e3q6n/publications/1999/PAA99DRBDPVLV/PAA99DRBDPVLV.pdf](http://homepage.tudelft.nl/e3q6n/publications/1999/PAA99DRBDPVLV/PAA99DRBDPVLV.pdf)

增强的缩短流程（图 8）在： [http ://www.cs.jhu.edu/~misha/Fall07/Papers/intro-to-scalespace.pdf](http://www.cs.jhu.edu/~misha/Fall07/Papers/intro-to-scalespace.pdf)

在第二个过滤器（增强的缩短流）中，您可以改变比例参数和非线性函数 h(Lw)（第 17 页）。因此，有更多的修整可能性。

理想情况下，滤波器是完全各向同性的（对每个可能的角度都有相同的频率效应）。

迈克尔

# emacs - 在 org-mode 中用标签组织笔记

> ID：10729639
> 
> 赞同：14
> 
> 时间：2012-05-24T00:23:11.673
> 
> 标签：emacs, org-mode

因此，我广泛使用 org-mode 来满足我的日常 TODO 需求。我想知道我是否也可以有效地使用它来做笔记。我基本上想要的是用标签存储笔记，然后想通过标签搜索这些笔记。例如，如果我有这样的事情

```
* Heading 1
** Note 1 :tag1:tag2:
Note 1 details
** Note 2 :tag3:
Note 2 details
* Heading 2
** Note 3
** Note 4 :tag1:
Note 4 details 
```

然后我搜索tag1，我应该有类似的东西-

```
* Heading 1
** Note 1 :tag1:tag2:
Note 1 details
* Heading 2
** Note 4 :tag1:
Note 4 details 
```

我希望能够在不将文件添加到我的议程的情况下执行此操作。（我可能有几个这样的笔记，我只想一次搜索当前文件。）

有没有简单（或不那么简单）的方法来完成这个组织模式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T02:39:11.843

您可以使用标签搜索 ( `C-c / m tag1 <ret>`)。此处的文档：

[http://orgmode.org/manual/Tag-searches.html](http://orgmode.org/manual/Tag-searches.html)

这将创建一个仅显示包含 的标题的稀疏树`:tag1:`，但它不会像您的示例中那样自动显示该标题的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-25T15:18:18.937

以下函数应提供您想要的结果。

```
(defun zin/org-tag-match-context (&optional todo-only match)
  "Identical search to `org-match-sparse-tree', but shows the content of the matches."
  (interactive "P")
  (org-prepare-agenda-buffers (list (current-buffer)))
  (org-overview) 
  (org-remove-occur-highlights) 
  (org-scan-tags '(progn (org-show-entry) 
                         (org-show-context)) 
                 (cdr (org-make-tags-matcher match)) todo-only)) 
```

# postgresql - postgres 触发器根据列值更新另一个表

> ID：10729644
> 
> 赞同：-1
> 
> 时间：2012-05-24T00:23:39.757
> 
> 标签：postgresql

我对存储过程一无所知。但是当表中的布尔列将值从 false 更改为 true 时，迫切需要运行更新 sql。如果有人可以提供一个，将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:23:31.590

这是一个测试表

```
CREATE TABLE test20120524
(
  id integer NOT NULL,
  bool boolean,
  comment_by_trigger text,
  CONSTRAINT pk_test20120524 PRIMARY KEY (id)
)
WITH (
  OIDS=TRUE
); 
```

这是一个示例触发函数。`OLD`并且`NEW`是预先声明的变量，表示更新的行。

```
create or replace function test1() returns opaque as
'
declare
    -- some variables
begin
    if OLD.bool = false and NEW.bool = true then
        NEW.comment_by_trigger = ''affected by trigger'';
    end if;
    return NEW;
end;
' language 'plpgsql'; 
```

然后，创建触发器。

```
CREATE TRIGGER test2
  BEFORE UPDATE
  ON test20120524
  FOR EACH ROW
  EXECUTE PROCEDURE test1(); 
```

存储过程并不难。可以在 PostgreSQL 官方文档中轻松学习：[http ://www.postgresql.org/docs/9.1/interactive/index.html](http://www.postgresql.org/docs/9.1/interactive/index.html)

看

*   36.. 触发器
*   39.. PL/pgSQL - SQL 过程语言（尤其是 39.9 触发过程）

# rest - 是否有基于 REST 的 JPA 提供程序？

> ID：10729645
> 
> 赞同：2
> 
> 时间：2012-05-24T00:23:52.767
> 
> 标签：rest, jpa, provider

一个常见的要求是通过 REST 访问 JPA 数据源。我想要相反的情况，即通过将 HTTP 请求发送到 RESTful 持久性服务来工作的 JPA 提供程序。这样做的好处是，任何针对 JPA API 编写的应用程序都可以轻松地在传统的 JPA 提供者（例如 Hibernate）和基于 REST 的 JPA 提供者之间切换，而无需更改代码。

所以我的问题是是否存在现有的基于 REST 的 JPA 提供程序，如果没有，这样的事情是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T04:31:52.583

首先，JPA 真的是为关系数据库设计的……

其次，没有 RESTful 持久性的标准，因此 JPA-REST 提供程序将特定于该 REST 持久性应用程序。

您*可以使用*[EclipseLink-EIS](http://wiki.eclipse.org/Introduction_to_EIS_Projects_(ELUG))来实现一些东西。您只需要创建 JCA_RestAdapter 实现。

如果您说“RESTful 持久性服务”时指的是 NoSQL 数据库之一，那么可能。其中一些 NoSQL DB 提供基于 REST 的接口，一些 JPA 提供程序开始支持 NoSQL DB。请参阅[http://wiki.eclipse.org/EclipseLink/FAQ/NoSQL](http://wiki.eclipse.org/EclipseLink/FAQ/NoSQL)。

老实说，您最好只实现 DAO 模式并抽象您的 CRUD(L) 操作。这正是 DAO 的用途。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-31T22:59:28.350

Datanucleaus 有一个基于 RESTful json API 的 JPA 实现。但是，您的 REST API 必须遵守他们的约定： [http ://www.datanucleus.org/products/accessplatform_3_0/json/support.html](http://www.datanucleus.org/products/accessplatform_3_0/json/support.html)

他们的 S3 和 GoogleStorage 扩展了 json API。

编辑：在我的原始答案中放入错误产品的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:33:33.213

有几种选择。例如，看一下“JEST”：

> [https://www.ibm.com/developerworks/mydeveloperworks/blogs/pinaki/entry/rest_and_jpa_working_together71?lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/pinaki/entry/rest_and_jpa_working_together71?lang=en)
> 
> REST 不是 API（应用程序编程接口）。它是一种架构风格，规定没有 API 来访问服务的设施。
> 
> ...
> 
> 在无状态频谱的另一端是 JEE 应用程序服务器的原则——服务器维护所有事物的状态，并且存在一个（或多个）API 用于所有事物。JEE 的这种以服务器为中心、有状态、面向 API 的原则导致了几个障碍。
> 
> ...
> 
> 我发现 REST 原则简洁而优雅。我还发现 Java Persistence API (JPA) 提供者在标准化和合理化经典的对象关系阻抗失配方面做得很好。JPA 经常被误解为仅仅是 JDBC 的替代品——但它比 JDBC 甚至比对象关系映射 (ORM) 还要多。JPA 是一种将关系数据作为对象图查看和更新​​的强大方法。此外，核心 JPA 概念（如分离事务或可定制的闭包或持久身份）似乎与 REST 原则完全一致。

更多链接：

*   [http://openjpa.apache.org/jest.html](http://openjpa.apache.org/jest.html)

*   [http://www.ibm.com/developerworks/java/library/j-jest/index.html?ca=drs-](http://www.ibm.com/developerworks/java/library/j-jest/index.html?ca=drs-)

# wordpress - Wordpress - 管理员管理帖子 - 按父类别的多个过滤器

> ID：10729649
> 
> 赞同：0
> 
> 时间：2012-05-24T00:24:08.593
> 
> 标签：wordpress

假设我在 Wordpress 中有以下类别：

产品类别 - Cat A - Cat B - Cat C

服务类型 - 服务 A - 服务 B - 服务 C

在管理端的管理帖子页面上，我希望为产品类别和服务类型设置 2 个下拉过滤器，因此我可以在后端同时进行过滤。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T23:46:08.773

在 wordpress stackexchange 中回答：[https ://wordpress.stackexchange.com/a/53202/8706](https://wordpress.stackexchange.com/a/53202/8706)

# javascript - 使用 jQuery 执行动态传递的函数调用

> ID：10729667
> 
> 赞同：0
> 
> 时间：2012-05-24T00:27:26.927
> 
> 标签：javascript, jquery

我将此函数调用作为字符串传递：

```
var dcall = "tumbsNav(1)"; 
```

是否可以像 SQL 中的 exec 一样动态执行它？

```
exec(dcall) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:29:00.910

`eval`是等价的，但你不应该使用它。

相反，像这样传递函数：

```
var dcall = function() {tumbsNav(1);}; 
```

然后调用它：

```
dcall(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T00:32:39.893

为此，您需要`eval(dcall)`.

**`eval`可以在您的程序中打开[可怕的安全漏洞和性能问题](http://blogs.msdn.com/b/ericlippert/archive/2003/11/01/53329.aspx)**。如果你需要使用它，那通常意味着你设计的程序很糟糕。

相反，您可以保留对要调用的函数的引用并保存参数数组并使用[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)，例如`tumbsNav.apply(null, [1]);`. 我不知道你的代码，所以这是我能提供的最通用的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T00:43:21.127

使用 eval(dcall)。

正如其他人所提到的， eval 被认为是不好的做法。主要原因是

1) 不当使用会使您的代码容易受到注入攻击。

2）维护代码变得更加困难（没有行号，不能使用调试工具）

3) 执行更慢（浏览器无法编译）

4)~~范围变得无法预测。~~

但是，如果您了解所有这些，那么 eval 会很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T01:09:28.347

无论您存储在哪里

```
var dcall = "tumbsNav(1)"; 
```

您可以改为存储

```
var dcall = function() {
   return tumbsNav(1);
}; 
```

无论你在哪里打电话，而不是打电话

```
eval(dcall); 
```

您可以改为致电

```
dcall(); 
```

~~唯一不起作用的情况是如果在调用`tumbsNav`时未定义。`var func = ...`然后你必须存储字符串。如果字符串完全在您的控制之下，则没有安全漏洞，但请注意@Porco 提到的所有问题~~

`tumbsNav`正如 Kolink 所提到的，如果在使用调用 tumbs 的包装匿名函数分配它时未定义我的示例，则不会导致问题。上面的评论只有在示例如下时才有意义：

```
var dcall = tumbsNav, darg = 1;
// later in the code, you can call
dcall(darg) ; 
```

# php - 填充后数组中的每个元素都具有相同的值（PHP）

> ID：10729668
> 
> 赞同：0
> 
> 时间：2012-05-24T00:27:35.540
> 
> 标签：php, arrays, multidimensional-array

我正在为我的公司开发订单处理器，但遇到了一些问题。

对于我们数据库中的每个订单，我正在创建一个 Order 对象，其中包含所述订单的所有信息（例如：订单 ID、客户地址等）。在此之后，我将每个对象放入一个数组中，该数组最终被传递到访问信息的不同页面。

现在，如果我对每个订单对象执行 var_dump，我会得到正确的值。但是，如果我对对象数组（假设大小为 100）执行 var_dump，我只会得到最后一个对象重复 100 次。

所以：

```
 $order = new Order();
    $newOrder = array();

    ... While Loop to fill orders ...
    {

        ... Fill $order with data ...

        $newOrder[] = $order;
    } 
```

如果我 var_dump 或 print_r $newOrder，我会得到我输入的最后一个 $order，n 次。如果我在 while 循环中打印出每个订单，它会正确输出。

提前致谢！任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:09:28.117

$order = 新订单（）；应该在循环中。那解决了它。

谢谢蒂格朗。

# jsf-2 - JSF 2.0 EL 处理资源键的空值

> ID：10729674
> 
> 赞同：2
> 
> 时间：2012-05-24T00:28:21.003
> 
> 标签：jsf-2, tomcat6, myfaces, resourcebundle

只是给你们一个快速的问题。

我有一个资源键，它作为字符串存储在托管 bean 中，我想让它解析为特定映射资源包中的值。

这是我开始的：

```
<h:outputText value="#{msgs[bean.someVal]}"/> 
```

我立即注意到，当 someVal 为空时，我会收到以下异常：

```
javax.el.PropertyNotFoundException: /webpage.xhtml at line 118 and column 188 value="#{msgs[bean.someVal]}": Property '' not found on type java.util.PropertyResourceBundle 
```

所以我尝试建立一个像这样的三元组：

```
<h:outputText value="#{bean.someVal == null ? '' : msgs[bean.someVal]}"/> 
```

但是我只引用了新值就得到了同样的错误。

我在 Tomcat6 上运行 JSF2.0 (Apache)。

有人有什么想法吗？我对这个很困惑..

如果您需要更多信息，请告诉我，我希望这足以继续......我认为这只是我正在做的愚蠢的事情；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:18:44.240

> *未找到属性“”*

你有一个空字符串。空字符串与`null`.

请改用`empty`支票。它将检查该值是否不是`null` **空**字符串。

```
<h:outputText value="#{empty bean.someVal ? '' : msgs[bean.someVal]}" /> 
```

顺便说一句，另一种方法是提供一个自定义`ResourceBundle`实现，`#{msgs}`它不会抛出异常，而是返回`null`或一个空`String`的 on`handleGetObject()`方法。

# c# - Assembly.GetEntryAssembly().CodeBase 排除单元测试

> ID：10729676
> 
> 赞同：0
> 
> 时间：2012-05-24T00:28:25.100
> 
> 标签：c#, unit-testing

> **可能重复：**
> [.NET NUnit 测试 - Assembly.GetEntryAssembly() 为空](https://stackoverflow.com/questions/4337201/net-nunit-test-assembly-getentryassembly-is-null)

我正在写一个日志库。默认情况下，我希望库写入为应用程序命名的公共应用程序数据文件夹中的目录。例如，如果应用程序名为“MyApplication.exe”，我希望将数据保存在“C:\ProgramData\MyApplication”中。

我正在使用此代码来构造路径：

```
 private static string loggingDataPath = 
      Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) +
      Path.DirectorySeparatorChar + 
      Path.GetFileNameWithoutExtension(Assembly.GetEntryAssembly().CodeBase) +
      Path.DirectorySeparatorChar; 
```

这完全符合预期，但有一个问题。我无法对库进行单元测试！

当我尝试运行单元测试时，它们都因 System.NullReferenceException 而失败。如果我用字符串替换“Assembly.GetEntryAssembly().CodeBase”调用，单元测试将再次正常运行。

我想我理解为什么会发生这种情况，但我不知道如何解决这个问题。我希望有人能够让我走上正义的道路。

蒂亚！

更新 (5-24-12)：我不想对“loggingDataPath”的内容进行单元测试。仅存在“Assembly.GetEntryAssembly().CodeBase”调用会导致所有单元测试因上述异常而失败。请注意，“loggingDataPath”是静态的（因为它必须是静态库）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T13:50:41.083

不仅仅是单元测试会导致问题。

鉴于[GetEntryAssembly() 可以在从非托管应用程序加载托管程序集时返回 null](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getentryassembly.aspx)并且[CodeBase 可以包含从 Internet 下载的程序集的 URL，并且没有为从 GAC 加载的程序集设置](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.codebase)，我会避免尝试这个通用日志库的方法。

如果这还不足以说服您，其他问题是 (a) 非特权用户将没有对 CommonApplicationData 的写入权限，以及 (b) 尝试写入同一个日志文件的应用程序的多个实例将是一个问题。

相反，我会在配置中定义日志文件的位置。

> 你会建议我把它放在哪里以避免这个问题？

正如我所说，我会在配置中定义它（例如 app.config 中的 appSetting）。这是最灵活的。如果你想把它放在 CommonApplicationData 下，你可以使用一个环境变量，当你`Environment.ExpandEnvironmentVariables`从配置文件中读取时，你可以使用该方法扩展它。例如：

```
<appSettings>
    <add key="logFile" value="%ALLUSERSPROFILE%\MyApp\MyLogFile.log" />
    ...
</appSettings> 
```

您仍然必须解决授予非特权用户访问权限的问题，并避免从多个实例访问时发生争用。您说您的底层日志库支持并发访问，但请注意，这将产生潜在的性能成本，具体取决于您的日志记录的详细程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:25:58.657

忽略先前答案的明智建议并仅解决我的问题，这是我解决问题的方法：

```
 public static string LoggingDataPath { 
      get { 
         return loggingDataPath.Length > 0 ? loggingDataPath : 
         Environment.GetFolderPath(Environment.SpecialFolder.CommonDocuments) + 
         Path.DirectorySeparatorChar + 
         Path.GetFileNameWithoutExtension(Assembly.GetEntryAssembly().CodeBase) + 
         Path.DirectorySeparatorChar; 
      } 

      set { loggingDataPath = value; } 
   } 
```

此解决方案避免在首次访问静态类时初始化“loggingDataPath”，从而避免调用“Assembly.GetEntryAssembly().CodeBase”。

# eclipse - Eclipse 自动检测多个编译器的包含和宏

> ID：10729677
> 
> 赞同：1
> 
> 时间：2012-05-24T00:28:40.987
> 
> 标签：eclipse, eclipse-cdt

我正在开发一个使用 Eclipse 为多个不同平台构建嵌入式应用程序的项目。现在我已经将它设置为使用不同的构建配置来确定使用哪个编译器来构建，但是我无法让索引正常工作。

问题的核心是我有一些特定于平台的文件，根本无法在其他任何地方编译（例如，为 ARM 设置硬件寄存器在 PowerPC 上不起作用）。构建很容易，因为我使用的是自定义 makefile，因此我可以排除来自不同构建的源。然而，Eclipse 索引器并不知道这一点，因此它会尝试同时索引这两个文件，这会导致问题，因为不同的编译器定义了不同的默认包含目录和宏。我已经想出了如何更改发现选项发现一个编译器或另一个，但我不能让它同时找到两个（除非我手动添加每个包含目录和#define，但如果可能的话我想避免这种情况）。

有没有办法自动发现同一项目中两个不同编译器的包含路径和#defines？或者，是否可以告诉 Eclipse 不要尝试解析构建中未使用的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:07:27.363

我想出了怎么做。在 C/C++ 常规 > 代码分析部分下，您可以选择要排除的某些文件/文件夹。我关闭了关于未解析符号、函数和类型的错误，现在它工作正常。

# java - 用于深度克隆的克隆（）主体？

> ID：10729679
> 
> 赞同：1
> 
> 时间：2012-05-24T00:29:00.513
> 
> 标签：java

很长一段时间以来，我一直坚持这一点。

告诉我以下代码是否克隆？

```
class A
{  
 int i;
    int j;  
    String str;  
    A()  
    {  
      i=10;  
      j=30;  
      str="Hello";  
    }  
    A(A a)  
   {  
      this.i=a.i;  
      this.j=a.j;  
      this.str=a.str;  
   }  
}  
class B
{  
   public static void main(String args[])  
   {
      A a  = new A();  
      A a1 = new A(a);
      /* I want to make clone like this. */  
      } 
} 
```

当我运行此代码并打印 a 和 a1 的哈希码时，它们是不同的。但是有些朋友说这不是克隆的正确方法。你必须实现Cloneable接口，真的有必要吗？在我看来，如果我想在派生引用变量的情况下进行深层复制，这可能是一个好方法。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:37:16.193

您需要实现 Clonable 接口才能克隆对象。您实现的称为复制构造函数。复制构造函数比实现 Clonable 更可取。

您复制的对象与从中复制的对象具有不同的哈希码/等于的原因是因为您没有覆盖 A 类中的哈希码或等于函数，因此它正在检查身份而不仅仅是相等（*完全相同的*对象，不是具有相同值的对象）。通过覆盖 hashcode/equals，您可以让您的类改为比较其属性的值。

# ruby-on-rails - 轨道上的单选按钮条件红宝石

> ID：10729681
> 
> 赞同：0
> 
> 时间：2012-05-24T00:29:01.763
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, rubygems

我对这段代码有一些问题。我正在尝试为我的数据库创建“高级”搜索。请求两种类型的数据（电影和位置）。一个位置完美无瑕，并显示了一个位置附近的所有电影院。但是是否可以通过输入电影的特定名称来做到这一点？

```
Location Controller:
if params[:allcinemas].checked?
  if params[:search].present?
    @locations = Location.near(params[:search], 10, :order => :distance)
    @title = "Search Results:"
  else
    @locations = Location.joins(:cinema).order("cinemas.name").all
    @title = "Locations of Cinemas"   
  end
elsif params[:allmovies].checked?
  if params[:search].present?
    @films = Film.near(params[:search], :order => :title)
  else
    @films = Film.find(:all, :order => "title") 
  end 
```

这是位置的 Show.Html.erb

```
show.html.erb
<p>
 <%= text_field_tag :search, params[:search] %>
 <%= submit_tag "Search Nearby Cinemas", :name => nil %>
 <br><%= radio_button_tag 'allcinemas', 'cinemas', true %> Cinemas
 <br><%= radio_button_tag 'allmovies', 'movies' %> Movies
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:42:57.687

您的 radio_button_tags 应该具有相同的名称，例如：

`<%= radio_button_tag 'radio_input', 'cinemas', true %> Cinemas`
`<%= radio_button_tag 'radio_input', 'movies' %> Movies`

现在，在你的控制器 radio_input.checked 中？将始终返回 true，因为您默认选择一个选中。所以，而不是这个检查：`if params[:allcinemas].checked?`

检查 params[:radio_input] 返回的值：
`if params[:radio_button] == 'cinemas'`
`#your logic to handle cinemas`
`else`
`#your logic for movies`

那应该可以解决您的问题。

# shell - Groovy 脚本可执行文件

> ID：10729682
> 
> 赞同：4
> 
> 时间：2012-05-24T00:29:29.957
> 
> 标签：shell, groovy

我想让我的 groovy 脚本可移植，并在第一行插入：

```
#!/usr/bin/env groovy 
```

当我在其目录之外运行脚本时出现问题，它找不到库。我来自 python 世界，python 中的所有导入都解析了相对脚本的路径。在 groovy 中，我似乎必须指定 -classpath 但我不能在第一个 #! 线。

任何建议如何解决它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T07:49:28.510

If the libraries are stored in a Maven repository that is accessible wherever you want to run it, one solution would be to use [Grape](http://groovy.codehaus.org/Grape) to grab the libraries.

This provides several benefits:

1.  You don't have to worry about the classpath at all
2.  You don't have to distribute the libraries — just make sure Groovy is available on the client
3.  Libraries are downloaded just once, so even if you upgrade the application, you only have to redistribute the `.groovy` file.

A simple example:

```
#!/usr/bin/env groovy

@Grab(group='commons-io', module='commons-io', version='2.3')
import org.apache.commons.io.FileUtils

... use FileUtils like normal ... 
```

There's a lot of existing libraries available on [mvnrepository.com](http://mvnrepository.com/) already.

Even if you have non-public libraries, it's relatively easy to put your own [libraries into a local / private repository](http://groovy.codehaus.org/Grape#Grape-AddyourlocalMaven2repository).

# java - Java数据流解压

> ID：10729685
> 
> 赞同：1
> 
> 时间：2012-05-24T00:30:07.863
> 
> 标签：java, stream, bufferedreader, compression

从套接字（缓冲区）获取数据

```
BufferedReader is = new BufferedReader(new InputStreamReader(download.getInputStream())); 
```

数据解压

```
Inflater decompresser = new Inflater();
decompresser.setInput(buffer.toString().getBytes());
byte[] dataBytes = new byte[8388608];
int resultLength = decompresser.inflate(dataBytes);
decompresser.end();
System.out.println("decompressed" + new String(dataBytes, 0, resultLength)+ " RESULTLENGHT " +resultLength); 
```

发送 1000 字节，压缩 ZLIB 和轮流（800-900 字节）但我不知道发送的确切大小。我需要一次从套接字读取 1 个字节并立即解压缩它，直到解压缩数据的总大小等于 1000 个字节。

要一次读取一个字节，我这样做：

```
StringBuilder buffer = new StringBuilder();
StringBuilder unpackbuffer = new StringBuilder();
do buffer.append((char)is.read());
while(buffer.charAt(buffer.length()-1) != '|' && (byte)buffer.charAt(buffer.length()-1) != -1); 
```

我如何填写这个循环解包缓冲区？并检查它的大小？对不起，我希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:42:52.650

好的，如果您不能将长度添加到要发送的数据中，然后在另一端读入（如果您能够设计协议以允许这样做，这显然是最简单的理想解决方案），那么您可以'逐字节'压缩流。诀窍是创建一个 1 字节的缓冲区作为输入缓冲区。然后代码如下所示：

```
 Inflater infl = new Inflater();
    byte[] buf = new byte[1];
    byte[] outputBuf = new byte[512];
    while (!infl.finished()) {
        while (infl.needsInput()) {
            buf[0] = ...next byte from stream...
            infl.setInput(buf);
        }
        int noUnc = infl.inflate(outputBuf);
       // the first "noUnc" bytes of outputBuf contain the next bit of data
    } 
```

# python - Python Gui 编程和 cpu 使用。如何创建“空闲”或“节流”以使一段代码不消耗 100 个可用 CPU？

> ID：10729689
> 
> 赞同：2
> 
> 时间：2012-05-24T00:30:49.017
> 
> 标签：python, user-interface

当一个朋友在测试我制作的 gui 时，我收到了关于反应迟缓的投诉。果然，看看 Xp 的性能监视器，它运行时会消耗尽可能多的 CPU。在对stackoverflow进行了一些研究之后，这似乎是正常的预期行为。

我的问题是：有没有办法限制或限制程序允许使用的资源量？当我打开一堆程序时，我保持性能监视器可见，并且在大多数情况下，所有“专业”程序（如 photoshop、sublime text 等）似乎都处于“空闲”状态。也就是说，一旦启动，在初始峰值之后，它们的 cpu 使用率就会下降到处理器的一小部分。

如何限制 Python 程序的使用，或者让它只在需要时才获取权力（就像其他程序似乎做的那样）？

我的主循环的略微截断的版本：

```
while True:
            events = pygame.event.get()
            for event in events:
                if event.type == QUIT:
                    if not flags['confirm']:
                        flags['alert'] = 1
                    else:
                        pygame.quit()

                elif event.type == MOUSEBUTTONDOWN:
                    text_box.set_focus(event.button, event.pos)
                    m_numbar.set_focus(event.button, event.pos)
                    # print event.pos 

            if not flags['window_open']:
                screen.blit(combined_bg, (0,0))
                t_button.update(events, screen)

            else:
                screen.blit(combined_blur, (0,0))

            if flags['config']:
                screen.blit(config_window_img, (0,0))
                text_box.update(events)
                text_box.draw(screen)
                m_numbar.update(events)
                m_numbar.draw(screen)
                submit.update(events, screen)
                cancel.update(events, screen)
                check_box.update(events, screen)
            else: 
                text_box.draw(screen)
                m_numbar.draw(screen)

            if flags['alert']:
                flags['window_open'] = True
                screen.blit(alert_dialog, (0,0))
                alert_cancel.update(events, screen)
                alert_confirm.update(events, screen)

            if flags['saving'][0]: 
                if time.time() - flags['saving'][1] < .75:
                    screen.blit(sav_img, (170,170))
                else:
                    flags['window_open'] = False
                    flags['saving'][0] = False

            if flags['currently_doing_thing']:
                if not flags['alert']: 
                    screen.blit(r_tag, (40,10))
                    if check_for_prog():
                        if not flags['prog_open']:
                            makeDir()
                            flags['prog_open'] = True
                            os.startfile("lla_.exe")
                    else:
                        flags['prog_open'] = False
                        if check_for_grab_process():
                            try:
                                os.system("TASKKILL /F /IM lla_.exe")
                            except:
                                pass

            config_button.update(events, screen)
            pygame.display.update() 
```

除了 Gui 编程，是否可以限制“正常”任务的 CPU 使用？例如，`while 1`将以 100% cpu 运行。有没有办法限制这样的简单情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:52:18.730

使用 Pygame 时，您的主循环将如下所示（来自[Python Pygame 简介](http://www.pygame.org/docs/tut/intro/intro.html)）：

```
while 1:
    for event in pygame.event.get():
        if event.type == pygame.QUIT: sys.exit()

    ballrect = ballrect.move(speed)
    if ballrect.left < 0 or ballrect.right > width:
        speed[0] = -speed[0]
    if ballrect.top < 0 or ballrect.bottom > height:
        speed[1] = -speed[1]

    screen.fill(black)
    screen.blit(ball, ballrect)
    pygame.display.flip() 
```

注意`pygame.event.get()`循环顶部的调用。在正常情况下，没有其他任何事情发生，这个函数在调用时会*阻塞*。这意味着您的脚本将等待`event.get()`函数返回，而根本不使用 CPU。该`event.get()`函数仅在您需要处理一些有趣的事情（鼠标移动、按键等）时返回。

您对问题的描述使我相信您没有`pygame.event.get()`按照预期使用。也许你可以展示你的主循环是什么样子的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:40:07.460

总是调用 GUI 循环的空闲回调，除非明确告诉它不要被调用（通过回调本身，通常通过返回 false）。只需在大多数时间保持禁用状态，仅在发生需要它运行的事件时启用它。

# wcf - 无法更改 WCF 中的文化

> ID：10729692
> 
> 赞同：10
> 
> 时间：2012-05-24T00:31:07.723
> 
> 标签：wcf, iis-7, web-config

我在 Windows 2008 服务器上运行。我有一个调用 wcf 服务的 Web 服务。在 WCF 服务中，它尝试投射日期 20/08/2010 失败，因为它认为它是美国格式而不是澳大利亚格式。

到目前为止，我有：

*   在控制面板上将区域更改为英语澳大利亚格式
*   在“管理”选项卡下，我还将系统本地设置为英语（澳大利亚）
*   在默认网站级别的 IIS7 中，我在 .Net 全球化下更改了文化和 UI 文化。
*   我也在 Web 服务和 WCF 节点上完成了这项工作

我已将以下内容添加到 Web 服务和 WCF 应用程序 web.config 文件中

```
<globalization requestEncoding="utf-8" 
               responseEncoding="utf-8"  
               culture="en-AU" 
               uiCulture="en-AU" /> 
```

这最终改变了 Web 服务中的文化，但 WCF 服务仍然是美国文化。

谁能告诉我我还能尝试什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T16:48:22.457

如果您未设置 aspNet 兼容性，WCF 将忽略您的全球化配置：

```
<system.serviceModel>    
   <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
... 
```

要使用该模式，您的服务类必须将属性 AspNetCompatibilityRequirements 设置为 Allowed 或 Required：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class ServiceClass
{
...
} 
```

如果您想从配置文件应用 Culture 和 CultureUI，这可能会起作用。

或者，如果您确定它不会动态更改，您可以尝试在 WCF 服务代码中强制使用文化。例如，在您的服务类构造函数中。请注意，这不是最佳实践，也许您应该使用 Context 初始化程序，但这非常简单。

```
public ServiceClass()
{
    ...
    System.Threading.Thread.CurrentThread.CurrentCulture = new CultureInfo("en-AU");
    System.Threading.Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-AU");
} 
```

更多信息：

[设置cultureinfo-on-wcf-service-calls](https://stackoverflow.com/questions/797259/setting-cultureinfo-on-wcf-service-calls)

[using-call-context-initializers-for-culture](http://blogs.msdn.com/b/drnick/archive/2008/02/26/using-call-context-initializers-for-culture.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T13:34:05.173

问题在于为应用程序池中使用的用户设置的文化。

我找到了以下解决此问题的方法：

1.  如果应用程序池使用 ApplicationPoolIdentity 将其更改为 NETWORKSERVICE（不幸的是我没有找到如何为 ApplicationPoolIdentity 设置区域设置）
2.  在当前用户上设置您需要的区域设置 (en-AU)，然后将它们复制到系统帐户中，如此[处](http://windows.microsoft.com/en-US/windows-vista/Apply-regional-and-language-settings-to-reserved-accounts)所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T18:17:00.410

您可以在`Global.asax.cs`文件中执行此操作，在`Application_Start`文件中：

```
using System.Threading;
using System.Globalization;

public class Global : HttpApplication
{
    protected void Application_Start(object sender, EventArgs e)
    {
        CultureInfo.DefaultThreadCurrentCulture = CultureInfo.DefaultThreadCurrentUICulture = new CultureInfo("en-AU");
    }
} 
```

# ruby-on-rails-3 - Rails 3 - How to Render JS after HTML

> ID：10729698
> 
> 赞同：0
> 
> 时间：2012-05-24T00:32:28.317
> 
> 标签：ruby-on-rails-3

How do I render a js.erb file after HTML in a HTML request?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:31:23.207

I would put a call in a .js or coffee file in the assets/javascripts folder.

```
$(function() {
    $.getScript(location.href);
} 
```

You'd probably want to add some conditional logic unless there's a .js.erb file for every url.

# c++ - Formatting mtime from stat(system call)

> ID：10729708
> 
> 赞同：0
> 
> 时间：2012-05-24T00:33:43.467
> 
> 标签：c++, struct, stat, strftime, time-t

So I'm writing a program to mimic the "find" command in linux. I have everything taken care of, but I cannot figure out how to format the string from ctime, mtime and atime.

I know the arguments are struct time_t, but I can't find to convert it to a formatable string.

Part of what I have is below. it won't work due to the error " error: cannot convert '__time_t' to 'const tm' for argument '4' to 'size_t strftime(char*, size_t, const char*, const tm*)'

Ideally, I want something like this:

```
cout << strftime(mBuf, 18, "%I:%M:%S-%m/%d/%y", (&sb.st_mtime)); 
```

where sb is the stat struct. It should print in the format: HH:MM:SS-MM/DD/YY

I'm sure the answer is something simple, but I cannot figure it out.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:22:00.380

You have to do it in several steps:

```
struct tm *mytm = localtime(&sb.st_mtime);
strftime(mBuf, 18, "%I:%M:%S-%m/%d/%y", mytm);
cout << mBuf; 
```

Of course, the call to `localtime` and `strftime` can be combined into a single call:

```
strftime(mBuf, 18, "%I:%M:%S-%m/%d/%y", localtime(&sb.st_mtime)); 
```

# android - 在继续使用android之前如何获得对话框的结果

> ID：10729709
> 
> 赞同：0
> 
> 时间：2012-05-24T00:33:56.817
> 
> 标签：android, dialog

在我的活动的 onCreate 方法中，我调用了一个名为 getLocProvider() 的方法。它应该将位置提供程序返回给我。我让该方法显示一个警报对话框，这是我的代码：

```
private void getLocProvider(){
    ArrayList<String> providers = new ArrayList<String>();

    List<String> list = locManager.getProviders(true);
    for(int i=0; i<list.size(); i++){
        if(list.get(i).equalsIgnoreCase("gps")){
            providers.add("GPS");
        }
        else if(list.get(i).equalsIgnoreCase("network")){
            providers.add("Network");
        }
    }

    providers.add("Manual");

    final CharSequence[] items = providers.toArray(new CharSequence[providers.size()-1]);

    AlertDialog.Builder dialogBuilder = new AlertDialog.Builder(this);
    dialogBuilder.setTitle("Choose a way of finding your location:");
    dialogBuilder.setItems(items, new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int item) {
           //This is where I'm stuck
        }
    });
    AlertDialog alert = dialogBuilder.create();
    alert.show();} 
```

使用监听器不会让我简单地通过方法返回结果，那么有谁知道我该如何解决这个问题？在谷歌搜索中，人们建议制作另一个在对话框完成时触发的函数，但是我如何将该结果返回到我在 onCreate 方法中所做的事情？

谢谢，扎克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:40:31.090

通常，您会将 UI 的创建与应用程序的状态分开。我建议为您的 UI 创建一个“空”状态，然后在用户单击您的对话框后响应状态更改。这种模式在 C# 中很常见，但在 Android 中并不常见。此外，如果可以完成，则`onCreate()`必须在呈现 UI 之前返回。

# sql-server - SQL Server - 从选择查询中合并插入/更新

> ID：10729715
> 
> 赞同：0
> 
> 时间：2012-05-24T00:35:26.913
> 
> 标签：sql-server, sql-server-2008

我一直在尝试在以下 SQL 查询中引入 Merge 语句，以更新或将记录插入到表快照中，具体取决于是否可以根据 BuildingId 和时间戳找到现有记录的匹配项。

本质上，该查询通过获取基于 BuildingId 的 Snapshot 表中的最新记录，基于一小时时间范围创建记录快照，并将该小时内的所有值求和。

```
-- DECLARE TABLE VARIABLES TO HOLD TEMP DATA
    DECLARE @Output table
    (
      SnapshotId bigint,
      BuildingId bigint,
      [TimeStamp] datetime
    );

-- INSERT ACCUMULATIVE SNAPSHOT DATA INTO BMS_Snapshot TABLE
        ;WITH Snap (BuildingId, Timestamp_Actual, TimestampRange_Start, TimestampRange_End) AS
            (SELECT BMS_Snapshot.BuildingId,  MAX(BMS_Snapshot.Timestamp) AS Timestamp_Actual, 
                dateadd(hh, datediff(hh,0, MAX(BMS_Snapshot.Timestamp)), 0) AS TimestampRange_Start,
                dateadd(mi, +59 , dateadd(hh, datediff(hh,0, MAX(BMS_Snapshot.Timestamp)), 0)) AS TimestampRange_End
                FROM BMS_Snapshot
                GROUP BY BMS_Snapshot.BuildingId)
            INSERT INTO BMS_Snapshot 
                (BuildingId, Timestamp, Emissions, EnergyUse, NABERS, Lighting, Heating,
                    Cooling, InternalEquipment, Fans, WaterSystems, NotClassified, Electricity,
                    Gas, Water, Other, [Range])
            OUTPUT inserted.SnapshotId, inserted.BuildingId, inserted.TimeStamp INTO @Output
            SELECT  [Snapshot].BuildingId,
                MAX(TimestampRange_End) AS Timestamp,
                SUM([Snapshot].Emissions) AS Emissions,
                SUM([Snapshot].EnergyUse) AS EnergyUse,
                AVG([Snapshot].NABERS) AS NABERS,
                SUM([Snapshot].Lighting) AS Lighting,
                SUM([Snapshot].Heating) AS Heating,
                SUM([Snapshot].Cooling) AS Cooling,
                SUM([Snapshot].InternalEquipment) AS InternalEquipment,
                SUM([Snapshot].Fans) AS Fans,
                SUM([Snapshot].WaterSystems) AS WaterSystems,
                SUM([Snapshot].NotClassified) AS NotClassified,
                SUM([Snapshot].Electricity) AS Electricity,
                SUM([Snapshot].Gas) AS Gas,
                SUM([Snapshot].Water) AS Water,
                SUM([Snapshot].Other) AS Other,
                1 AS [Range]
            FROM
                Snap INNER JOIN 
                BMS_Snapshot AS [Snapshot] ON Snap.BuildingId = [Snapshot].BuildingId
            WHERE 
                /* RANGE - FILTER ONLY 10 MINUTE SNAPSHOTS */
                [Snapshot].[Range] = 0 AND
                [Snapshot].[TimeStamp]
                BETWEEN TimestampRange_Start AND TimestampRange_End
            GROUP BY [Snapshot].BuildingId 
```

我已经尝试将合并语句放在一起，但似乎能够使更新与“选择来自...”一起使用

谢谢。

编辑：

经过一番尝试，我现在有以下查询，如果存在则更新正确的记录，但如果不存在则不插入：

```
 -- INSERT ACCUMULATIVE SNAPSHOT DATA INTO BMS_Snapshot TABLE
    ;WITH Snap (BuildingId, Timestamp_Actual, TimestampRange_Start, TimestampRange_End) AS
        (SELECT BMS_Snapshot.BuildingId,  MAX(BMS_Snapshot.Timestamp) AS Timestamp_Actual, 
            dateadd(hh, datediff(hh,0, MAX(BMS_Snapshot.Timestamp)), 0) AS TimestampRange_Start,
            dateadd(mi, +59 , dateadd(hh, datediff(hh,0, MAX(BMS_Snapshot.Timestamp)), 0)) AS TimestampRange_End
            FROM BMS_Snapshot
            GROUP BY BMS_Snapshot.BuildingId)
        MERGE INTO BMS_Snapshot AS t
            USING
                (SELECT [Snapshot].BuildingId,
                    MAX(TimestampRange_End) AS Timestamp,
                    SUM([Snapshot].Emissions) AS Emissions,
                    SUM([Snapshot].EnergyUse) AS EnergyUse,
                    AVG([Snapshot].NABERS) AS NABERS,
                    SUM([Snapshot].Lighting) AS Lighting,
                    SUM([Snapshot].Heating) AS Heating,
                    SUM([Snapshot].Cooling) AS Cooling,
                    SUM([Snapshot].InternalEquipment) AS InternalEquipment,
                    SUM([Snapshot].Fans) AS Fans,
                    SUM([Snapshot].WaterSystems) AS WaterSystems,
                    SUM([Snapshot].NotClassified) AS NotClassified,
                    SUM([Snapshot].Electricity) AS Electricity,
                    SUM([Snapshot].Gas) AS Gas,
                    SUM([Snapshot].Water) AS Water,
                    SUM([Snapshot].Other) AS Other,
                    1 AS [Range]
                FROM
                    Snap INNER JOIN 
                    BMS_Snapshot AS [Snapshot] ON Snap.BuildingId = [Snapshot].BuildingId
                WHERE 
                    /* RANGE - FILTER ONLY 10 MINUTE SNAPSHOTS */
                    [Snapshot].[Range] = 0 AND
                    [Snapshot].[TimeStamp]
                    BETWEEN TimestampRange_Start AND TimestampRange_End
                GROUP BY [Snapshot].BuildingId) As s
            ON t.BuildingId = s.BuildingId
            WHEN MATCHED AND (t.Timestamp = s.Timestamp AND
                t.[Range] = 1) THEN
                    UPDATE SET
                        t.Emissions = s.Emissions,
                        t.EnergyUse = s.EnergyUse,
                        t.NABERS = s.NABERS,
                        t.Lighting = s.Lighting,
                        t.Heating = s.Heating,
                        t.Cooling = s.Cooling,
                        t.InternalEquipment = s.InternalEquipment,
                        t.Fans = s.Fans,
                        t.WaterSystems = s.WaterSystems,
                        t.NotClassified = s.NotClassified,
                        t.Electricity = s.Electricity,
                        t.Gas = s.Gas,
                        t.Water = s.Water,
                        t.Other = s.Other
                WHEN NOT MATCHED BY t THEN
                    INSERT 
                        (BuildingId, Timestamp, EnergyUse, NABERS, Lighting, Heating,
                        Cooling, InternalEquipment, Fans, WaterSystems, NotClassified,
                        Electricity, Gas, Water, Other, [Range])
                    VALUES
                        (s.BuildingId, s.Timestamp, s.EnergyUse, s.NABERS, s.Lighting, s.Heating,
                        s.Cooling, s.InternalEquipment, s.Fans, s.WaterSystems, s.NotClassified,
                        s.Electricity, s.Gas, s.Water, s.Other, 1); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:19:35.330

```
MERGE BMS_Snapshot target USING (SELECT BMS_Snapshot.BuildingID, ...) 
 source(BuildingID,...)
  ON target.BuildingID = source.BuildingID 
  AND target.Timestamp = source.Timestamp 
WHEN MATCHED THEN 
    UPDATE SET Emissions = source.Emissions, ... 
WHEN NOT MATCHED BY target THEN 
    INSERT (BuildingID, ...) 
    VALUES (source.BuildingID, ...); 
```

我为格式道歉，因为我现在在平板电脑上。

根据您的更新，您只在 ON 子句中查看 buildingid，但您还需要您的时间戳。buildingid 匹配，但 WHEN MATCHED 上的过滤器将其从更新中删除。

# sql - 多次加入一个表

> ID：10729719
> 
> 赞同：2
> 
> 时间：2012-05-24T00:36:25.397
> 
> 标签：sql, sql-server-2008, tsql, join

我有三个表：`Account`、`Management`和`ManagementAccountLookup`。

Account 表包含*位置*。Management 表包含*业务层次结构中每个级别的记录*。Management 表还包含一个值 ( *LevelID)* ，该值指示记录位于层次结构中的哪个级别。 ManagementAccountLookup 表是连接它们的查找表。

我在编写查询以获取所有帐户及其两个相关管理记录时遇到问题。

例如：一个 Account 可能有 5 条或更多条与其关联的管理记录，但我只关心 levelID 为 Brand 或 Region 的两个特定管理。另外，我只希望一个帐户在结果网格中显示一次。

结果集应如下所示：

```
AccountID   Brand      Region
---------   --------   ------
account1    Wendys     East US
account2    McDonalds  West US 
```

这似乎是一个简单的问题，但我无法确切地弄清楚如何获得该结果。我已经尝试过自联接、子查询以及我能想到的所有其他方法，但我似乎无法将结果放在一行中。

任何帮助，将不胜感激。

*编辑：ManagementAccountLookup 有两个字段（AccountID、ManagementID）。这些是另外两个表的 PK。
管理层有一列 LevelID，您可以通过它来判断记录是品牌、地区、地区等...

Brand 和 Region 将是 Management 表中的两个单独的行。我需要结果网格将它们放在同一行中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:30:45.403

您需要添加两次 ManagementAccountLookup/Management 组合才能在一行中获取信息。如果需要，我已将`LevelID`标准直接放在 join 中，以减轻可能过渡到 left-joins 的难度。

```
select Account.AccountID,
       m_brand.Name Brand,
       m_region.Name Region
  from Account
 inner join ManagementAccountLookup mal_brand
    on Account.AccountID = mal_brand.AccountID
 inner join Management m_brand
    on mal_brand.ManagementID = m_brand.ManagementID
   and m_brand.LevelID = @Insert_Management_Brand_Level_Here
 inner join ManagementAccountLookup mal_region
    on Account.AccountID = mal_region.AccountID
 inner join Management m_region
    on mal_region.ManagementID = m_region.ManagementID
   and m_region.LevelID = @Insert_Management_Region_Level_Here 
```

**编辑：**如果您需要显示所有帐户，您可以在括号中使用左/内连接组合：

```
select Account.AccountID,
       m_brand.Name Brand,
       m_region.Name Region
  from Account
  left join 
  (
       ManagementAccountLookup mal_brand
       inner join Management m_brand
         on mal_brand.ManagementID = m_brand.ManagementID
        and m_brand.LevelID = @Insert_Management_Brand_Level_Here
 )
   on Account.AccountID = mal_brand.AccountID
 left join 
 (
       ManagementAccountLookup mal_region
       inner join Management m_region
          on mal_region.ManagementID = m_region.ManagementID
         and m_region.LevelID = @Insert_Management_Region_Level_Here
 )
    on Account.AccountID = mal_region.AccountID 
```

为了使其更具可读性，您可以使用 CTE：

```
; with mal_level as (
  select AccountID,
         m.LevelID,
         m.Name
    from ManagementAccountLookup mal
   inner join Management m
      on mal.ManagementID = m.ManagementID
)
select Account.AccountID,
       m_brand.Name Brand,
       m_region.Name Region
  from Account
  left join mal_level m_brand
    on Account.AccountID = m_brand.AccountID
   and m_brand.LevelID = @Insert_Management_Brand_Level_Here
  left join mal_level m_region
    on Account.AccountID = m_region.AccountID
   and m_region.LevelID = @Insert_Management_Region_Level_Here 
```

或[外部应用](http://msdn.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)：

```
select Account.AccountID,
       b.Brand,
       r.Region
  from Account
 outer apply
 (
       select m_brand.Name Brand
         from ManagementAccountLookup mal_brand
        inner join Management m_brand
           on mal_brand.ManagementID = m_brand.ManagementID
          and m_brand.LevelID = @Insert_Management_Brand_Level_Here
        where mal_brand.AccountID = Account.AccountID
 ) b
 outer apply
 (
       select m_region.Name Region
         from ManagementAccountLookup mal_region
        inner join Management m_region
           on mal_region.ManagementID = m_region.ManagementID
          and m_region.LevelID = @Insert_Management_Region_Level_Here
        where mal_region.AccountID = Account.AccountID
 ) r 
```

# java - 如何获取标记 mp3 java 艺术家专辑年份

> ID：10729722
> 
> 赞同：0
> 
> 时间：2012-05-24T00:36:37.270
> 
> 标签：java, mp3, media-player, metadata

我想知道如何从本地 mp3 (C:/music/hello.mp3) 获取信息，我尝试使用 jLayer 和 MyID3，但没有成功！我想要最简单的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:18:32.100

根据[ID3 自己](http://www.id3.org/Implementations)的关于实现的站点，您在 Java 中有三个直接选择：

*   [Entagged](http://entagged.sourceforge.net/developer.php) , 最后更新于 2008 年
*   [mp3agic](https://github.com/mpatric/mp3agic)，积极维护，但很少
*   [Beaglebuddy](http://www.beaglebuddy.com/)，最后一次更新是在 2008 年（似乎）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T01:07:43.823

jid3lib.jar [http://javamusictag.sourceforge.net/download.htm](http://javamusictag.sourceforge.net/download.htm)

# objective-c - 异步数据附加到ios中的文件？

> ID：10729723
> 
> 赞同：3
> 
> 时间：2012-05-24T00:36:50.127
> 
> 标签：objective-c, ios, cocoa-touch, file, save

我想从网络路径下载图像。但是由于存在大文件的风险，我认为将部分 NSdata 块直接写入/附加到文档目录中的文件是一个好主意。这可能吗？我有一个异步 URLConnection 设置。它回调一个委托

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data 
```

方法。在这种方法中，我想将到目前为止下载的“数据”直接附加到磁盘上的文件中。你能帮一点忙吗？如果这在没有低级别 C 的情况下是可行的，那将是完美的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T00:47:08.950

我从来没有试过这个，但从[这个苹果文档](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html)，我建议

```
@property (nonatomic,strong) NSFileHandle *handle;

//somewhere in a init or viewDidLoad
self.handle = [NSFileHandle fileHandleForUpdatingAtPath:filePath]

-(void)connection:(NSURLConnection *)connection 
   didReceiveData:(NSData *)data
{
    [handle seekToEndOfFile];
    [handle writeData:data];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection 
{ 
    [self.handle closeFile]; 
} 
```

注意：filePath 必须是现有文件的有效路径，有很多帖子涉及创建文件。

# netbeans - 使用 NetBeans GUIBuilder 更改 JFrame 中的 JPanel

> ID：10729729
> 
> 赞同：0
> 
> 时间：2012-05-24T00:38:05.790
> 
> 标签：netbeans, jpanel, gui-builder

我正在 NetBeans 中制作一个 GUI 项目。我有一个 JFrame 和 3 个 JPanel。一次只能显示一个 JPanel。应使用菜单选项更改显示的 JPanel（侦听器工作）。

我的问题是，我该如何切换它们？我试过删除旧的 JPanel 并放入新的 JPanel。我已经尝试将第四个 JPanel 添加到 JFrame 中，并且所有三个 JPanel 都存在于第四个中，所以我可以使用`removeAll()`（糟糕的技术，但我很绝望）。我尝试重定向对象引用，使其指向新的 JPanel 而不是旧的。在每种情况下，我都完成了剪断的代码

```
 revalidate();
    repaint(); 
```

无济于事。我看过很多讨论`CardLayout`，`GroupLayout`但我不知道如何使用 NetBeans GUIBuilder 来实现它们。你们中的哪位好人能告诉我如何关闭 JPanel 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:04:49.740

使用分层窗格。30 个字符分钟

# perl - 与 Dist::Zilla 的可选依赖是否可能？

> ID：10729730
> 
> 赞同：5
> 
> 时间：2012-05-24T00:38:13.243
> 
> 标签：perl, dependencies, dist-zilla

我想让[Dist::Zilla](https://metacpan.org/module/Dist%3a%3aZilla)检测到的一些依赖项成为可选的。我怎么能这样做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T07:46:34.617

Dist [::Zilla::Plugin::Prereqs](http://search.cpan.org/dist/Dist-Zilla/lib/Dist/Zilla/Plugin/Prereqs.pm)文档说您可以将它们定义为：

```
[Prereqs / RuntimeRecommends]
Some::Optional::Module = 0 
```

尽管[显然](http://www.nntp.perl.org/group/perl.module-authors/2011/07/msg9293.html)它不受普通客户的支持（或者至少不是去年夏天）。

# c++ - OpenMP 导致 heisenbug 段错误

> ID：10729732
> 
> 赞同：0
> 
> 时间：2012-05-24T00:38:17.910
> 
> 标签：c++, c, openmp

我正在尝试`for-loop`在 OpenMP 中并行化相当庞大的内容。大约 20% 的时间它运行良好，但其余时间它会因各种段错误而崩溃，例如；

```
*** glibc detected *** ./execute: double free or corruption (!prev): <address> ***

*** glibc detected *** ./execute: free(): invalid next size (fast): <address> ***

[2] <PID> segmentation fault ./execute 
```

我的一般代码结构如下；

```
<declare and initialize shared variables here>
#pragma omp parallel private(list of private variables which are initialized in for loop) shared(much shorter list of shared variables) 
{
   #pragma omp for
   for (index = 0 ; index < end ; index++) {

     // Lots of functionality (science!)
     // Calls to other deep functions which manipulate private variables
     // Finally generated some calculated_values

     shared_array1[index] = calculated_value1;
     shared_array2[index] = calculated_value2;
     shared_array3[index] = calculated_value3;

   } // end for
 }

// final tidy up 
```

}

就正在发生的事情而言，每个循环迭代完全独立于其他循环迭代，除了它们从共享矩阵中提取数据（但每次循环迭代的列不同）。在我调用其他函数的地方，它们只是在更改私有变量（尽管偶尔会读取共享变量），所以我认为它们是线程安全的，因为它们只会弄乱特定线程的本地内容？对任何共享变量的唯一写入发生在最后，我们将各种计算值写入一些共享数组，其中数组元素由 for 循环索引索引。这段代码是 C++，虽然它调用的代码是 C 和 C++ 代码。

我一直在试图找出问题的根源，但到目前为止还没有运气。如果我设置 num_theads(1) 它运行良好，就像我将 num_theads(1) 的内容包含`for-loop`在一个

```
#pragma omp for
for(index = 0 ; index < end ; index++) { 
  #pragma omp critical(whole_loop)
  { 
      // loop body
  }
} 
```

这大概会产生相同的效果（即任何时候只有一个线程可以通过循环）。

另一方面，如果我将`for-loop's`内容包含在两个`critical`指令中，例如

```
#pragma omp for
for(index = 0 ; index < end ; index++) { 
  #pragma omp critical(whole_loop)
  { 
      // first half of loop body
  }

 #pragma omp critical(whole_loop2)
  { 
      // second half of loop body
  }

} 
```

我得到了不可预测的段错误。同样，如果我将每个函数调用都包含在`critical`指令中，它仍然不起作用。

我认为这个问题可能与函数调用有关的原因是，当我使用[Valgrind](http://valgrind.org/)（使用`valgrind --tool=drd --check-stack-var=yes --read-var-info=yes ./execute`）以及 SIGSEGing 进行分析时，我得到了*大量*的加载和存储错误，例如；

```
Conflicting load by thread 2 at <address> size <number>
   at <address> : function which is ultimately called from within my for loop 
```

根据[valgrind 手册](http://valgrind.org/docs/manual/drd-manual.html#drd-manual.data-races)，这正是您对比赛条件的期望。当然，这种奇怪出现/消失的问题似乎与竞态条件会给出的非确定性错误的种类一致，但我不明白，如果每个给出明显竞态条件的调用都在关键部分中。

可能是错误但我认为不包括在内的事情；

*   所有 private() 变量都在内部初始化`for-loops`（因为它们是线程本地的）。

*   我检查了共享变量具有相同的内存地址，而私有变量具有不同的内存地址。

*   我不确定同步是否会有所帮助，但鉴于`barrier`指令的进入和退出有隐式指令，`critical`并且我已经尝试了我的代码版本，其中每个函数调用都包含在（唯一命名的）关键部分中，我认为我们可以规定出去。

**任何关于如何最好地进行的想法将不胜感激。**我整天都在用头撞这个。显然，我不是在寻找“哦——这就是问题所在”类型的答案，而是在寻找如何最好地进行调试/解构。

可能是个问题或可能有帮助的事情；

*   代码中有一些 std::Vectors 利用 vector.pushback() 函数添加元素。我记得读过调整向量大小不是线程安全的，但向量只是私有变量，因此不在线程之间共享。我想这会好吗？

*   如果我将整个`for-loop`主体包含在一个`critical`指令中并慢慢缩回代码块的末尾（因此末尾不断增长的区域在`for-loop`临界区之外）它运行良好，直到我暴露一个函数调用，在该函数调用中点段错误恢复。用 Valgrind 分析这个二进制文件显示了许多其他函数调用中的竞争条件，而不仅仅是我公开的那个。

*   其中一个函数调用是对 GSL 函数的调用，根据 Valgrind，它不会触发任何竞争条件。

*   我是否需要在被调用的函数中明确定义私有和共享变量？如果是这样，这似乎对 OpenMP 有所限制——这是否意味着您需要对您调用的任何遗留代码具有 OpenMP 兼容性？

*   并行化一个大的`for-loop`东西是行不通的吗？

*   如果你已经读到这里，谢谢你和 Godspeed。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:05:13.837

所以没有人可以回答这个问题，但是我希望这对某人有所帮助，因为我的系统的行为是如此奇怪。

我最终调用的 ( `my_function`-> `intermediate_function`-> `lower_function`-> `BAD_FUNCTION`) 中的一个 (C) 函数将它的许多变量声明为`static`，这意味着它们保留了相同的内存地址，因此本质上是一个共享变量。有趣的是，静态覆盖了 OpenMP。

我发现了这一切；

*   使用 Valgrid 确定错误发生的位置，并查看所涉及的特定变量。

*   将整个定义`for-loop`为关键部分，然后在顶部和底部公开更多代码。

*   和我的老板说话。更多的眼睛总是有帮助的，尤其是因为你被迫说出问题（最终我打开了罪魁祸首函数并指向声明）

# http - 浏览器通常不支持多部分 HTTP 响应是否存在事实上或既定的原因？

> ID：10729733
> 
> 赞同：20
> 
> 时间：2012-05-24T00:38:18.970
> 
> 标签：http, browser, standards, multipart

HTTP 协议长期以来一直支持多部分响应。我以前曾将它们用于配备适当消费者的 API，但浏览器对它们的支持似乎不是很好，在过去五年中也没有改进。我很难找到很多关于为什么会这样的信息。我希望能够通过发送我知道的 web 应用程序在初始请求时需要的所有资产来减少 HTTP 请求，特别是对于使用像 Backbone.js 这样的客户端框架的应用程序。

是否有任何白皮书、交易文章、失败的实验或其他证据说明为什么浏览器制造商或 Web 性能传播者都没有关注这个长期存在的 HTTP 结构？

*完全清楚，我不是在寻找意见，而是在寻找真正的证据来表明为什么会这样。例如，如果 Mozilla 几年前发布了一些关于此的内容，或者 Firefox 错误跟踪器中有一张已关闭的票证，其中主要开发人员评论了他们为什么不实施此功能。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:57:08.160

实际上，旧版本的 IE 将处理多部分应用程序/八位字节流响应并在下载操作期间保存所有文件，但这最近已被删除（我认为从 IE7 开始）并且仅适用于下载。

我怀疑您是否会找到您正在寻找的“证据”，因为我认为您提出的建议与 HTTP 规范的“精神”不符。我将尝试解释我的意思。HTTP 的基本范式是客户端驱动的请求和服务器对该请求的响应。但是您似乎建议服务器将返回任意文件，并假设客户端知道如何处理它们。

但是，如果您建议客户端首先明确请求多个文件，那么我会说您可能会做一些事情。HTTP 1.1 规范确实允许 Accept client-request 标头指示多部分支持，因此这似乎是 HTTP 设计者设想的这种工作方式。不幸的是，规范对客户端应该如何识别它期望接收的文件保持沉默，如果你在真空中查看 HTTP，这是可以理解的，正如它所定义的那样，而不是通过浏览器和网站的镜头。这是一个由客户端和服务器来解决的实现细节。这是一个适用于不同层的问题——内容是什么以及如何使用它，而不是如何请求和传输它。

当然，很容易想象各种解决方案，但是如果没有可参考的标准，浏览器开发人员的努力似乎就不值得了。我可以想象像微软这样的人（控制着广泛采用的服务器和浏览器）实现这一点，但他们会发明一个规范，人们会抱怨。显然我们已经决定最好等 10 年让 W3C 就某事达成一致……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-01T19:17:59.470

直接来自 W3 组织本身（在[http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.7.2](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.7.2)）：

> 3.7.2 多部分类型
> 
> MIME 提供了许多“多部分”类型——将一个或多个实体封装在单个消息体中。如 RFC 2046 的第 5.1.1 节中所定义，所有多部分类型共享一个通用语法
> 
> [40]，并且必须包含边界参数作为媒体类型值的一部分。消息体本身就是一个协议元素，因此必须只使用 CRLF 来表示正文部分之间的换行符。与 RFC 2046 不同，任何多部分消息的结尾必须为空；HTTP 应用程序不得传输结语（即使原始多部分包含结语）。存在这些限制是为了保持多部分消息体的自定界性质，其中消息体的“结束”由结束的多部分边界指示。
> 
> 一般来说，HTTP 对待多部分消息体与任何其他媒体类型没有区别：严格地视为有效负载。一个例外是“multipart/byteranges”类型（附录 19.2），当它出现在 206（部分内容）响应中时，它会被 13.5.4 和 14.16 节中描述的一些 HTTP 缓存机制解释。在所有其他情况下，HTTP 用户代理应该遵循与 MIME 用户代理在收到多部分类型时相同或相似的行为。多部分消息正文的每个正文部分中的 MIME 标头字段对 HTTP 没有任何意义，超出其 MIME 语义定义的意义。
> 
> 一般来说，HTTP 用户代理应该遵循与 MIME 用户代理在收到多部分类型时相同或相似的行为。如果应用程序接收到无法识别的多部分子类型，应用程序必须将其视为等同于“multipart/mixed”。
> 
> ```
>  Note: The "multipart/form-data" type has been specifically defined
>   for carrying form data suitable for processing via the POST
>   request method, as described in RFC 1867 [15]. 
> ```

# python - Python-fu GIMP 脚本不粘贴图像

> ID：10729734
> 
> 赞同：1
> 
> 时间：2012-05-24T00:38:31.560
> 
> 标签：python, gimp, python-fu

我正在尝试编写一个脚本，将图层切成小块。它运行正确，但没有任何内容粘贴到新图层中。

```
def explode_layer( i, l, dx, dy ):
    T=[]
    for ix,ox in enumerate(range(l.offsets[0], l.offsets[0]+l.width, dx )):
        for iy,oy in enumerate(range(l.offsets[1], l.offsets[1]+l.height, dy)):
            pdb.gimp_rect_select(i, ox, oy, dx, dy, 2, False, 0)
            if not pdb.gimp_edit_copy(l):
                continue
            layer = pdb.gimp_layer_new(i, dx, dy, 1, 
                                       l.name+" %d,%d"%(ix,iy), 100, 0)
            i.add_layer(layer)
            floating_sel = pdb.gimp_edit_paste(layer, True)
            pdb.gimp_layer_set_offsets(floating_sel, *layer.offsets)
            pdb.gimp_floating_sel_anchor(floating_sel)
            T.append(layer)
    return T 
```

我在 Ubuntu 10.04 上使用 gimp 2.6.8。我该如何解决？有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:46:57.473

我现在正在查看您的脚本 - 这是一个很好的方法 - 我发现了问题所在：当您调用 gimp_edit_paste 时，您创建的选择（使用 gimp_rect_select）仍然处于活动状态，并且您的浮动层的内容被剪裁了通过它。（实际上我认为它们只是在“selection_anchor”调用中被剪辑，但这无关紧要）。

因此，在修复您的功能`pdb.gimp_selection_none(i)`之前添加一行：`floating_sel = pdb.gimp_edit_paste(layer, True)`

```
def explode_layer( i, l, dx, dy ):
    T=[]
    for ix,ox in enumerate(range(l.offsets[0], l.offsets[0]+l.width, dx )):
        for iy,oy in enumerate(range(l.offsets[1], l.offsets[1]+l.height, dy)):
            pdb.gimp_rect_select(i, ox, oy, dx, dy, 2, False, 0)
            if not pdb.gimp_edit_copy(l):
                continue
            layer = pdb.gimp_layer_new(i, dx, dy, 1, 
                                       l.name+" %d,%d"%(ix,iy), 100, 0)
            i.add_layer(layer)
            pdb.gimp_selection_none(i)
            floating_sel = pdb.gimp_edit_paste(layer, True)
            pdb.gimp_layer_set_offsets(floating_sel, *layer.offsets)
            pdb.gimp_floating_sel_anchor(floating_sel)
            T.append(layer)
    return T 
```

一种更简单的方法是不显式创建新层（顺便说一句，在图像对象上有一个方便但未记录的“new_layer”方法，它创建和添加一个新层，并且对大多数参数都有合理的默认值 - 所以，`i.new_layer(<name>, <width>, <height>)`就足够了) - 但您可以简单地复制、粘贴，然后他们调用`new_layer = pdb.gimp_floating_sel_to_layer(<floating_sel>)`。

# python - 如何在 Python 图中以弧度设置 y 轴？

> ID：10729737
> 
> 赞同：11
> 
> 时间：2012-05-24T00:38:53.600
> 
> 标签：python, matplotlib, axes, radians

我想将轴的弧度单位写成与以下成比例`\pi`：类似于

```
$\frac{\pi}{4}$, $\frac{\pi}{2}$, ... 
```

代替

```
0.785, 1.5707 ... 
```

有什么标准方法吗？例如，我应该在以下代码中添加什么？

```
from pylab import *

x=arange(-10.0,10.0,0.1)
y= arctan(x)

plot(x,y,'b.')
show() 
```

我找到了这个例子[http://matplotlib.sourceforge.net/examples/units/radian_demo.html](http://matplotlib.sourceforge.net/examples/units/radian_demo.html)但它不起作用，因为我没有 basic_units 模块。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T05:29:13.247

将它们硬编码为分数或接受浮点数

```
import matplotlib.pyplot as plt
import numpy as np

x=np.arange(-10.0,10.0,0.1)
y=np.arctan(x)

fig = plt.figure()
ax  = fig.add_subplot(111)

ax.plot(x,y,'b.')

y_pi   = y/np.pi
unit   = 0.25
y_tick = np.arange(-0.5, 0.5+unit, unit)

y_label = [r"$-\frac{\pi}{2}$", r"$-\frac{\pi}{4}$", r"$0$", r"$+\frac{\pi}{4}$",   r"$+\frac{\pi}{2}$"]
ax.set_yticks(y_tick*np.pi)
ax.set_yticklabels(y_label, fontsize=20)

y_label2 = [r"$" + format(r, ".2g")+ r"\pi$" for r in y_tick]
ax2 = ax.twinx()
ax2.set_yticks(y_tick*np.pi)
ax2.set_yticklabels(y_label2, fontsize=20)

plt.show() 
```

结果是

![在此处输入图像描述](../Images/9a4fec41457fd8a569400aeba58291bc.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-14T22:07:12.963

i wrote a little function, that gives you back a list of labels:

```
import numpy as np
from fractions import Fraction

def create_pi_labels(a, b, step):

    max_denominator = int(1/step)
    # i added this line and the .limit_denominator to solve an 
    # issue with floating point precision
    # because of floataing point precision Fraction(1/3) would be 
    # Fraction(6004799503160661, 18014398509481984)

    values = np.arange(a, b+step/10, step)
    fracs = [Fraction(x).limit_denominator(max_denominator) for x in values]
    ticks = values*np.pi

    labels = []

    for frac in fracs:
        if frac.numerator==0:
            labels.append(r"$0$")
        elif frac.numerator<0:
            if frac.denominator==1 and abs(frac.numerator)==1:
                labels.append(r"$-\pi$")
            elif frac.denominator==1:
                labels.append(r"$-{}\pi$".format(abs(frac.numerator)))
            else:
                labels.append(r"$-\frac{{{}}}{{{}}} \pi$".format(abs(frac.numerator), frac.denominator))
        else:
            if frac.denominator==1 and frac.numerator==1:
                labels.append(r"$\pi$")
            elif frac.denominator==1:
                labels.append(r"${}\pi$".format(frac.numerator))
            else:
                labels.append(r"$\frac{{{}}}{{{}}} \pi$".format(frac.numerator, frac.denominator))

    return ticks, labels 
```

[https://github.com/MaxNoe/python-plotting/blob/master/source/create_pi_labels.py](https://github.com/MaxNoe/python-plotting/blob/master/source/create_pi_labels.py)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-16T12:58:16.803

[您可以在此处](http://matplotlib.org/devdocs/gallery/units/basic_units.html#sphx-glr-gallery-units-basic-units-py)下载 basic_units.py 文件：

之后它应该像这样工作：

```
from pylab import *
from basic_units import radians

x = arange(-10.0,10.0,0.1)
y = map(lambda y: y*radians,arctan(x))
x = map(lambda x: x*radians,x)

plot(x,y,'b.',xunits=radians,yunits=radians)
show() 
```

或者，您可以按照他们在 basic_units.py 中实现 cos 函数的方式来实现 arctan 函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-01T21:31:54.740

我创建了一个[PyPi 包](https://pypi.org/project/matplot-fmt-pi/)，它可以在 pi 的倍数处格式化和放置刻度。

```
"""Show an example of using MultiplePi on the y-axis."""
import matplotlib.pyplot as plt
import numpy as np

from matplot_fmt_pi import MultiplePi

x = np.arange(-10.0, 10.0, 0.1)
y = np.arctan(x)

fig = plt.figure()
ax = fig.add_subplot(111)

ax.set_title("MultiplePi formatting")
ax.plot(x, y, 'b.')

y_pi = y / np.pi
unit = 0.25
y_tick = np.arange(-0.5, 0.5 + unit, unit)

# New way
manager = MultiplePi(4)
ax.yaxis.set_major_locator(manager.locator())
ax.yaxis.set_major_formatter(manager.formatter())

# Other way
y_label2 = [r"$" + format(r, ".2g") + r"\pi$" for r in y_tick]
ax2 = ax.twinx()
ax2.set_yticks(y_tick * np.pi)
ax2.set_yticklabels(y_label2)

plt.savefig("./pi_y_axis.png", dpi=120) 
```

# objective-c - 如何让子类 UIGestureRecognizer 类在视图上调用选择器

> ID：10729739
> 
> 赞同：-1
> 
> 时间：2012-05-24T00:39:39.440
> 
> 标签：objective-c, uigesturerecognizer

我有一个名为 GameViewController 的视图。我没有设置它，但它似乎是一个带有嵌入式 EAGL 视图的 UIKit 视图。

我为 GameViewController 上的点击和滑动设置了手势识别器。它们工作得很好，除了我设置为点击选择器（GameViewController 中的一个函数）的方法在 touchesEnded 上调用，而不是 touchesBegan。

获得 touchesBegan 函数的唯一方法是子类化。

因此，我将 UITapGestureRecognizer 子类化，创建了一个 touchesBegan 函数，并且在着陆时调用其中的 NSLogs。但是，我不能从 UITapGestureRecognizer 子类调用 GameViewController 中的任何函数。（找不到类方法+METHODIWANTTOCALL）。

我意识到我需要来回“参考”，但它们应该是什么？或者这完全是错误的方法？我委托吗？（我是新手）从这个 UITapGesture 子类调用 GameViewController 中的方法的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:50:14.373

看起来您的 GameViewController 是一个单例类（应用程序中只有一个此类的实例）。您可以在 GameViewController 中有一个返回单例实例的类方法。然后您可以定期使用该方法：

在识别器中： `GameViewController* myController = [GameViewController getInstance]; [myController handleTouchBegin];`

或者，如果它不需要知道任何内部状态，您可以将 handleTouchBegin 定义为类方法：

`[GameViewController handleTouchBegin];`

# foursquare - 实时 API 自签名证书

> ID：10729743
> 
> 赞同：0
> 
> 时间：2012-05-24T00:40:18.733
> 
> 标签：foursquare

我在使用foursquare 实时API 和自签名证书时遇到问题。每次我进行测试推送时，我都会返回“您的服务器返回：502 Bad Gateway”，但我 90% 确定它实际上并没有到达我的服务器（我将其设置为在任何地址观看获取和发布，但没有任何通过，如果我获取/发布到服务器上的任何地址，它就可以工作。本地和远程。）自签名证书和推送 api 是否存在某种问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:50:49.970

502 错误听起来像是您这边的配置错误，与您的实际代码或foursquare无关。一般来说，运行自签名证书对于我们的 Push API 来说应该没问题，所以我怀疑这是你的问题。

如果您还不熟悉 502 错误，可以在这里阅读一下它们：http: [//www.checkupdown.com/status/E502.html](http://www.checkupdown.com/status/E502.html)

我知道您说它适用于一般远程连接，但是您的主机可能不喜欢来自foursquare的请求？我们使用 Amazon Web Services，因此原始 IP 来自大量 IP 地址，这些地址有时最终会出现在阻止列表中（如果说，有人也在 Amazon Web Services 上编写了一个行为不端的应用程序）。

# google-app-engine - 无法使生成的密钥增加 1

> ID：10729748
> 
> 赞同：0
> 
> 时间：2012-05-24T00:40:32.167
> 
> 标签：google-app-engine, datanucleus

我将 Java 和 JPA 用于 ORM。

最初我是这样定义实体键的：

```
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Key key; 
```

但这导致 id 增长得非常快且以不可预测的方式（...19,20,22,1003...1007,1014,1015,2004...）

这似乎与文档相矛盾，该[文档](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2)指出“最简单的键字段是一个长整数值，当对象第一次保存到数据存储区时，该值由 JPA 自动填充，该值在该类的所有其他实例中都是唯一的。长整数键使用 @Id 注释和 @GeneratedValue(strategy = GenerationType.IDENTITY) 注释”

所以我找到[了这个](http://code.google.com/p/datanucleus-appengine/source/browse/trunk/tests/org/datanucleus/test/SequenceExamplesJPA.java?spec=svn473&r=473)单元测试，然后我切换到了它在那里完成的方式：

```
@Id
@GeneratedValue(strategy = GenerationType.SEQUENCE)
private Long id; 
```

在更新一些 GQL 语句后迁移得很好，但我仍然看到键每次增加 1000。

我应该使用 GenerationType.TABLE 吗？或者我应该在 Long 而不是 Key 字段上使用 IDENTITY？

我希望在我的实时（测试版）应用程序中不断改变它之前得到一些明确的答案。不幸的是，到目前为止我在开发环境中使用的所有方案都会产生连续的键，所以除了部署之外，真的没有办法测试新方法。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:56:14.297

在 App Engine 上做连续键真的很难。文档从未声明自动生成的密钥是连续的 - 只是它们是唯一的。

应用程序引擎上最简单的解决方案是设计您的密钥，以便您不需要它们是连续的。鉴于 BigTable 的设计方式，如果您确实有连续递增的键，那么每当需要在引擎盖下拆分平板电脑时，您可能会遇到一些性能瓶颈。

# .net - 如何在 Amazon S3 中获取 MIME 类型的对象？

> ID：10729754
> 
> 赞同：5
> 
> 时间：2012-05-24T00:41:22.340
> 
> 标签：.net, amazon-s3, amazon-web-services

有没有办法检索 S3 中对象的 MIME 类型。我正在尝试实现一个解决方案，我将从 S3 获取多个对象。我可以通过某种方式从 Amazon S3 获取 MIME 类型，而不是使用那里的键然后获取子字符串来计算 MIME 类型？我正在使用 cloud berry explorer pro，我知道它可以让您设置 MIME 类型，但我们如何使用适用于 .NET 的 AWS 开发工具包或 REST API 检索此信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T01:02:42.267

REST API为此提供了[HEAD 对象操作，而](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectHEAD.html)[适用于 .NET 的 AWS 开发工具包通过](http://aws.amazon.com/sdkfornet/)[GetObjectMetadata()](http://docs.amazonwebservices.com/sdkfornet/latest/apidocs/html/M_Amazon_S3_AmazonS3Client_GetObjectMetadata.htm)方法方便地封装了相同的功能：

> GetObjectMetadata 操作用于检索有关特定对象或对象大小的信息，而无需实际获取对象本身。**如果您只对对象元数据感兴趣**，并且不想在对象数据上浪费带宽，这很有用。**响应与 GetObject 响应相同，只是没有响应正文。** *[强调我的]*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-07T05:34:35.740

要在同一个请求中获取文件的文件和文件的 mimeType...

```
using (var client = AWSClientFactory.CreateAmazonS3Client(region))
{
    var response = client.GetObject(bucket, key);
    var mimeType = response.Headers.ContentType;
    return new StreamWithMimeType(response.ResponseStream, mimeType); 
} 
```

# c# - 如何为伪RPG玩家装备（字典？）

> ID：10729755
> 
> 赞同：2
> 
> 时间：2012-05-24T00:41:32.027
> 
> 标签：c#

基本上，我正在创建一个伪 RPG 游戏，其中玩家拥有物品清单和角色玩偶（以了解当前装备了哪些物品）。

您建议处理当前装备物品集合的最佳方式是什么？

我目前拥有的是一个 EquipmentSlot 枚举，其中包含玩家装备物品的所有可能位置，我可以将其设置为玩家拥有的每个物品的属性。

```
public enum EquipmentSlot
{
    Head,
    Chest,
    Arms,
    Legs,
    Feet,
    OffHand,
    MainHand
} 
```

然后我有一个字典，其中包含每个枚举作为键，在 Player 构造函数中将它们全部初始化为 null：

```
PlayerEquipment = new Dictionary<EquipmentSlot, Item>(7);
PlayerEquipment.Add(EquipmentSlot.Head, null);
PlayerEquipment.Add(EquipmentSlot.Chest, null);
PlayerEquipment.Add(EquipmentSlot.Arms, null);
PlayerEquipment.Add(EquipmentSlot.Legs, null);
PlayerEquipment.Add(EquipmentSlot.Feet, null);
PlayerEquipment.Add(EquipmentSlot.OffHand, null);
PlayerEquipment.Add(EquipmentSlot.MainHand, null); 
```

但是当我编写这个代码时，我开始意识到它不起作用，因为我无法在我的 Player 的其他方法中将键作为枚举访问，因为它们是在构造函数中添加的。我不确定我还能在哪里添加它们以使它们可供全班其他人使用。

我的字典方法是错误的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:47:02.273

我不确定你的意思是：

> 我无法在我的 Player 的其他方法中将密钥作为枚举访问，因为它们是在构造函数中添加的

但为什么不...

```
public class Player
{
    public Item EquipmentHead { get; set; }
    public Item EquipmentChest { get; set; }
    public Item EquipmentArms { get; set; }
    public Item EquipmentLegs { get; set; }
    public Item EquipmentFeet { get; set; }
    public Item EquipmentOffHand { get; set; }
    public Item EquipmentMainHand { get; set; }
} 
```

PS我不会说您的 Dictionary 实现方式是*错误*的，这只是一种替代方法，您可以更轻松地绕开您的脑袋。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:53:59.853

如果您定义`PlayerEquipment`为类成员而不是局部变量，则可以在类中的任何位置访问它：

```
public class Player
{
     public Dictionary<EquipmentSlot, Item> PlayerEquipment { get; set; }

     public Player()
     {
         PlayerEquipment = new Dictionary<EquipmentSlot, Item>(7);
         PlayerEquipment.Add(EquipmentSlot.Head, null);
         // ...
     }

     // In other methods, you can use this as needed... ie:
     public void DropItem(EquipmentSlot slot)
     {
         this.PlayerEquipment[slot] = null; // Remove the item here...
     }

     //....Rest of class 
```

请注意，如果您定义了类的`enum` *内部*，则在从其他类中使用它时必须完全限定它，即：`Player.EquipmentSlot.Head`. 但是，如果它在类之外定义，则可以只使用`EquipmentSlot.Head`（假设存在相同的命名空间或适当的 using 子句）。

# php - 将音频从php流式传输到flash

> ID：10729765
> 
> 赞同：0
> 
> 时间：2012-05-24T00:43:16.033
> 
> 标签：php, flash, audio-streaming

嗨，我想知道是否有人可以帮我解决这个问题...我已经设法收集了一些有关如何从 Flash 调用 php 以流式传输 mp3 的信息，但是我不确定如何从 Flash 流式传输数据。以下是我目前拥有的代码。

**闪光**

```
function onPlay(e:MouseEvent):void
{
    //Load file to play
    var req:URLRequest = new URLRequest("streamAudio.php");
    var urlData:URLVariables = new URLVariables();
    urlData.id = id;
    req.data = urlData;

    myMusic.load(req); //myMusic is a Sound object
    myChannel = myMusic.play(); //myChannel is a SoundChannel object

    btn_Play.visible = false;
    btn_Pause.visible = true;
} 
```

**PHP**

```
<?php
$ID = $_GET["id"];

if ($ID != 0)
{
    //Code to fetch URL from DB

    $url = $row["url"];
    $file = "/" . $url;

    if(file_exists($file))
    {
        header("Content-type: audio/mpeg, audio/x-mpeg, audio/x-mpeg-3, audio/mpeg3");
        header("Content-Length: " . filesize($file));
        header("Expires: -1");
        header("Cache-Control: no-store, no-cache, must-revalidate");
        header("Cache-Control: post-check=0, pre-check=0", false);

        readfile($file);
    }

    //Close DB
} 
```

感谢所有帮助。提前致谢！！

**编辑**

修改了代码。如果现在直接测试，PHP 脚本就可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:22:34.663

我不知道你为什么要做你正在做的事情......你应该能够非常简单地播放音频：

```
s = new Sound();
s.loadSound("http://someserver/yourscript.php", true); 
```

当然，这首先假设您的 PHP 脚本正在运行。请注意，在许多情况下，您无法在下载远程资源之前获取它的文件大小。首先通过直接点击它来测试您的 PHP 脚本。

# php - 会话变量未传递给 uploadify.php

> ID：10729767
> 
> 赞同：3
> 
> 时间：2012-05-24T00:43:28.747
> 
> 标签：php, session, upload, uploadify

我需要为用户名使用会话变量来指定uploadify（版本3.1）中的上传路径。在 uploadifive.php 中使用以下方法可以正常工作：

```
$uploadDir = 'media/' . $_SESSION["user_name"] . '/'; 
```

但是在uploadify中，当我使用相同的代码时，文件只是上传到媒体文件夹（忽略用户文件夹）。我已经在uploadify.php 中回显了$_SESSION["user_name"] 并使用onUploadSuccess 函数检索了它，并且确实用户名变量没有被传递给uploadify.php，尽管开始了会话。

这似乎很奇怪，这适用于uploadifive 而不是uploadify。我对 PHP 不太了解，很高兴能得到一些帮助。

我在下面包含了完整的 uploadify.php 脚本。

谢谢，

缺口

```
<?php
session_start();
/*
Uploadify
Copyright (c) 2012 Reactive Apps, Ronnie Garcia
Released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
// Define a destination
$targetPath = 'media/' . $_SESSION["user_name"] . '/';

if (!empty($_FILES)) {
    $tempFile = $_FILES['Filedata']['tmp_name'];
    $targetFile = $targetPath . $_FILES['Filedata']['name'];

    // Validate the file type
    $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
    $fileParts = pathinfo($_FILES['Filedata']['name']);

    if (in_array($fileParts['extension'],$fileTypes)) {
        move_uploaded_file($tempFile,$targetFile);
        echo '1';
    } else {
        echo 'Invalid file type.';
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:59:13.860

我也偶然发现了这个问题。

Uploadify flash 文件是调用 PHP 脚本的文件，而不是浏览器，这意味着 PHP 会话不会从浏览器传播到 flash 和服务器，您只需通过 $_GET/ 传递会话 ID $_POST 使问题消失。

在 HTML 文件中：

```
<input type="hidden" id="sessionid" value="<?php echo session_id(); ?>" /> 
```

在 javascript 文件中：

```
$('#image').uploadify({
    'uploader'  : '/uploadify-v2.1.4/uploadify.swf',
    'script'    : '/uploadify.php',
    'cancelImg' : '/uploadify-v2.1.4/cancel.png',
    'folder'    : '/tempfiles',
    'auto'      : true,
    'multi'     : false,
    'scriptData': { 'session': $('#sessionid').val() }
}); 
```

在 PHP 文件中：

```
if ( isset($_REQUEST['session']) && !empty($_REQUEST['session']) ) {
    session_id($_REQUEST['session']);
}
session_start(); 
```

当会话配置设置为 auto_start 时似乎有问题（但我还没有完全测试过）。

[Uploadify](http://www.uploadify.com/documentation/uploadify/using-sessions-with-uploadify/)的文档中也提到了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:48:09.947

我会检查您的登录脚本，以确保您在验证用户时确实将用户名存储在会话数组中。您正在调用`session_start()`，这消除了这种可能性，因此，如果您正在调用`$_SESSION["user_name"]`但*没有*获得值，则只能表示该值不存在，或者您的密钥错误。

# javascript - 如何制作类似于 Blackberry PlayBook 启动时的 HTML5 动画？

> ID：10729768
> 
> 赞同：0
> 
> 时间：2012-05-24T00:43:34.603
> 
> 标签：javascript, animation, html5-canvas, html5-animation

我只是想知道如何使用 HTML5 画布和 JS（带有一些 JS 绘图库？）编写一个动画，就像[在 Blackberry PlayBook 启动时带有大彩色圆圈的动画一样。](http://www.youtube.com/watch?v=WjO3lkqewJc)能达到同样的效果吗？你能给出代码实现的近似值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T10:26:24.683

我正在将 tridentJS 库用于动画[https://github.com/kirillcool/trident-js](https://github.com/kirillcool/trident-js)。它非常简单，易于使用并且有据可查。您还将找到与您的示例相似的示例和方法。

# c# - 当设置了级联保存更新属性时，NHibernate 会不必要地更新对象吗？

> ID：10729771
> 
> 赞同：1
> 
> 时间：2012-05-24T00:43:52.277
> 
> 标签：c#, database, nhibernate

[这个 SO question](https://stackoverflow.com/questions/1994433/nhibernate-cascade)解释了 NHibernate 中级联属性的 save-update 选项，如下所示：

> 保存更新 - 当对象被保存/更新时，检查关联并保存/更新**任何需要它的对象**（包括保存/更新多对多场景中的关联）。

这是否意味着当关联对象触发数据库操作时，NHibernate 会跟踪已修改并需要在数据库中更新的对象，或者 NHibernate 只是简单地更新每个人，而不管对他们进行了修改吗？

我试图找出该句子中**“需要”一词的确切含义。**

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:08:20.113

NHibernate**总是**跟踪修改过的对象；这与级联无关。

*在这种情况下，需要*基本上意味着当引用对象被保存/更新时，被引用的瞬态对象将被保存。

# wix - 默认 UILevel WIX

> ID：10729772
> 
> 赞同：1
> 
> 时间：2012-05-24T00:44:01.187
> 
> 标签：wix, windows-installer, wix3.5

有没有办法为我的 WIX msi 设置默认 UILevel？就像我将 /passive 传递给 msiexec 一样？

我尝试将 UILevel 的属性设置为 2 ......但这当然不起作用。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T11:34:15.430

Use the [`LIMITUI` property](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369759.aspx) to restrict your UI to basic/passive.

# javascript - 仅在第一次点击时实现点击动画？

> ID：10729773
> 
> 赞同：0
> 
> 时间：2012-05-24T00:44:07.083
> 
> 标签：javascript, jquery

我有多个带有`rel="<img src"#"/>"`.

当我单击 any`<a></a>`时，我会在另一个 div 中显示一个大图像，其`rel`值使用淡入效果。

我想要做的是检查大图像是否与锚点相同，如果是则阻止`src`效果。`rel``fadeIn`

```
 $(document).ready(function () {

   $("a.largeimg").click(function () {
     var image = $(this).attr("rel");           
     $('.main-product-image').html('<img src="' + image + '"/>');
     $('.main-product-image img').hide();
     $('.main-product-image img').fadeIn();
     return false;

     if(src == image) {

      $('.main-product-image img').show();

     }

   }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:53:03.893

您可以检查锚的 rel 和图像的 src 是否相同，如果是，则在代码淡入之前转义函数，如下所示：

```
var src = $('.main-product-image img').attr("src");
if (src == image) return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:58:08.460

如果我正确理解您的问题，则在动画之前您需要确认`src`图像的属性是否等于`rel`单击元素的属性，从而阻止动画！

**查询**

```
$(document).ready(function () {

  // use bind when targeting many elements
  $("a.largeimg").bind("click", function () {

    var $target = $('.main-product-image'),         // target element
        src     = $target.find('img').attr("src"),  // src from existent image
        image   = $(this).attr("rel");              // rel from clicked element

    // if src different from image
    if (src != image) {
      $target.html('<img src="' + image + '"/>');   // append new image
      $target.find('img').hide().fadeIn();          // perform the animation
    }

    // prevent the browser from continuing to bubble the clicked element
    return false;
  });
}); 
```

**附言：**

*未经测试，但应该可以正常工作！*

# c++ - Visual Studio 11 的构建问题

> ID：10729777
> 
> 赞同：2
> 
> 时间：2012-05-24T00:44:48.487
> 
> 标签：c++, visual-studio-2012, rc, build-error

我正在 VS 11 Professional beta 版上构建一个简单的程序。

```
#include <iostream>
int main(){
    std::cout << "Hello World" << std::endl;
} 
```

但我收到 RC 错误。

```
1>------ Build started: Project: Stephen, Configuration: Debug Win32 ------
1>Build started 5/23/2012 8:31:30 PM.
1>InitializeBuildStatus:
1>  Touching "Debug\Stephen.unsuccessfulbuild".
1>ClCompile:
1>  Source.cpp
1>RC : fatal error RC1106: invalid option: -ologo
1>  
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:01.67
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

如果我只是单独编译源文件（即不构建项目），它会编译。我用谷歌搜索了这个错误，但没有找到太多有用的信息。我已经看到了编译器和链接器属性。不，在哪里`-ologo`看到选项。我不确定这个无效选项是从哪里来的。

我的系统上安装了 VS 2005、2010。这与此错误有关吗？任何帮助都会受到赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:56:51.580

转到`project`-> `Properties`-> `Configuration Properties`-> `General`。将平台工具集更改为您正在使用的正确工具集。或者只是将[Suppress Startup Banner 更改为 'no'](http://connect.microsoft.com/VisualStudio/feedback/details/499476/c-project-resource-compiler-fails-with-rc-fatal-error-rc1106-invalid-option-ologo)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-04-02T06:00:25.967

如果您将源代码从 32 位迁移到 64 位平台，并且在构建过程中遇到此错误，请执行以下操作：

1.  在解决方案资源管理器中选择您的项目。
2.  从菜单中选择 Project->Properties->Configuration Properties->VC++ 目录
3.  在“可执行目录”上，检查“$(WindowsSdkDir)\bin”是否存在 - 首先通过单击向下箭头->编辑->单击“宏”按钮检查什么是“WindowsSdkDir”，然后查看它指向的位置...通常它位于“C:\Program Files (x86)\Windows Kits\8.1\bin”
4.  检查“C:\Program Files (x86)\Windows Kits\8.1\bin”下是否有可执行文件
5.  如果没有，则“C:\Program Files (x86)\Windows Kits\8.1\bin”下可能有文件夹
6.  转到“C:\Program Files (x86)\Windows Kits\8.1\bin\x86”并检查“RC.exe”是否存在
7.  如果“RC.exe”存在，则返回步骤 1、步骤 2。
8.  在“可执行目录”上，将“$(WindowsSdkDir)\bin”更改为“$(WindowsSdkDir)\bin\x86”
9.  单击“应用”，然后单击“确定”按钮。
10.  重建您的项目，这应该可以解决您的问题。

# authentication - Yii-User 和 Yii-eauth 集成

> ID：10729779
> 
> 赞同：1
> 
> 时间：2012-05-24T00:45:02.780
> 
> 标签：authentication, yii, oauth, widget

我正在尝试使用`yii-user`和`yii-eauth`扩展组合一个应用程序，但我做不到。当我创建一个新的 webapp 并安装 eauth 时，我可以让它正常工作，所以我知道我在这方面没有做错任何事情。我认为问题在于我的网址。这是应该是什么样子的演示：http: [//nodge.ru/yii-eauth/demo/login](http://nodge.ru/yii-eauth/demo/login)。当有人点击说 google 时，它​​应该将您带到 google 登录页面，但在我的应用程序上，我收到一个 404 错误，指出`"The system is unable to find the requested action "login"."`该 url 是`user/user/login/service/google_oauth`，而 url 应该读取`user/login/service/google_oauth`。在手动将其输入浏览器后，我将被重定向到正确的页面。

因此，我查看了该`EAuthWidget.php`课程，看看是否可以找出它从哪里获得了那个额外的“用户”，但我无法弄清楚。我认为这可能与我`/modules/user`在 webapp 目录中的用户模块中有这个事实有关。我也尝试使用`URLManager`指向正确的地址，但没有运气。

有没有人有类似的设置这个经验？或者有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T09:36:16.297

您只需要更改视图中的小部件初始化代码（即更改`action`小部件的属性），有点像这样：

```
<h2>Do you already have an account on one of these sites? Click the logo to log in with it here:</h2>
<?php 
  $this->widget('ext.eauth.EAuthWidget', array('action' => 'login'));
?> 
```

只是要补充一点，请记住，此操作取决于您包含此小部件的视图，如果视图是*protected* */views/site/login.php*（这是 yii 的默认站点登录视图），那么操作应该能够转到yii-user 模块的登录动作，所以它是 : `'action'=>'/user/login'`，但是如果你在 yii-user 的*protected/modules/user/views/user/login.php*中包含这个小部件，那么这个动作将`'login'`如前所述。

# jquery - 将文本区域中的内容复制到输入和修剪字符

> ID：10729780
> 
> 赞同：0
> 
> 时间：2012-05-24T00:45:05.227
> 
> 标签：jquery

第一次来这里 ：）

我有一个 textarea 和一个输入，我希望当在 texarea 中输入某些内容时，它会将其复制到输入 onkeypress。但输入必须限制为 10 个字符。然后我想在输入值的末尾添加5个数字

EG：Textarea 内容：“Hello world，你好吗？” 输入内容：“Hello worl12345”

我已经尝试过[这个](http://jsfiddle.net/bxHQ5/) 和[这个](http://jsfiddle.net/4kS65/523/)
，但是在第二个中，我认为它的代码真的很乱，需要一些“清理”。此外，它缺少最后添加5个数字的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:01:32.577

```
var value = $('#elementId').val();       // returns the element value
var trimmed = $.trim(value);             // trim the value;
var subString = trimmed.substr(0, 10);   // return the first 10 chars.
$('#otherElemetId').val(subString);      // set the substring as the value. 
```

[**现场演示**](http://jsfiddle.net/bxHQ5/72/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:57:15.027

您可以使用 javascript 来获取文本区域的值示例：

```
var str = document.getElementById("text").value;
                          //id of text area needs to be set to "text" 
```

那么你可以使用 substring 函数在 10 个字符后切断字符串

```
var finishedString = str.substring(0,10); 
```

然后，如果您只想将 12345 添加到末尾。

```
finishedString = finishedString + "12345"; 
```

然后使用输入区域的 getElemendById 将其设置为完成的字符串。你可以把这一切都放在一个函数中，然后在按下键时调用它。

# javascript - 使用 javascript 和/或 jquery 访问外部 html 正文的宽度和高度

> ID：10729781
> 
> 赞同：1
> 
> 时间：2012-05-24T00:45:32.477
> 
> 标签：javascript, jquery, html, external, dimensions

我正在使用fancybox 插件在fancybox 弹出窗口中打开一个html 文件。如何使用 javascript/jquery 访问外部 html 文件的宽度和高度。我的外部 html 看起来像这样：

```
<html>
<head>
<style type="text/css">
body {
  width:500px;
  height:500px;
  background-color:red;
}
</style>
</head>

<body>
<p>TEXT_TEXT_TEXT</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:09:43.760

我猜 FancyBox 会在 iFrame 中加载 html 文件，然后它会是这样的：

这将转到您的 html 文件（在 iframe 中使用）：

```
window.myFunction = function(width, height) {
 //change body width
 //change body height
} 
```

就像这样，您可以在 iframe 中访问该功能

```
document.getElementById('YOURFRAMEIDHERE').contentWindow.myFunction(args); 
```

# java - TestNG - 如何从 BeforeClass 获取当前类名

> ID：10729784
> 
> 赞同：4
> 
> 时间：2012-05-24T00:46:00.123
> 
> 标签：java, testng

TestNG - 如何从 BeforeClass 获取当前类名。

我有 A 类扩展 B 类

```
class B {
    @BeforeClass
    public void beforeClass() {
        /* Need test class name 'A' */
    }
}
class A extends B {
    @Test
    public void test() {
        /* do something */
    }
} 
```

在 BeforeClass 中，我尝试了注入的仅有的两个参数：ITestContext 和 XmlTest。但是，在确定如何从中获取类名方面没有运气。

有人有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T01:46:59.670

以下应该可以解决问题：

```
@BeforeClass
public void beforeClass() {
    String className = this.getClass().getName();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T01:42:47.130

怎么样`getClass()`？

（还有几个角色让你开心）

# javascript - Photoshop Javascript 的奇怪行为

> ID：10729785
> 
> 赞同：2
> 
> 时间：2012-05-24T00:46:11.283
> 
> 标签：javascript, photoshop, flash-cs5, photoshop-script

我试图弄清楚我或 CS5 JavaScript 引擎是否有问题。我的 Photoshop 文档有一个名为“A”的图层和一个名为“Group 1”的图层组。

考虑这个例子：

```
var Mess = "";
var Layers = app.activeDocument.layers;
alert(Layers.length);
for (n=0; n<app.activeDocument.layers.length; n++) {
  Mess = Mess + app.activeDocument.layers[n].name + "\r\n";
}
alert(Mess); 
```

这将显示 2 的长度，然后列出图层：
A
Group 1

到目前为止一切都很好。但是如果我们在 foror 循环中使用变量 Layers 来代替，我们会得到不同的结果。

```
var Mess = "";
var Layers = app.activeDocument.layers;
alert(Layers.length);
for (n=0; n<Layers.length; n++) {
  Mess = Mess + app.activeDocument.layers[n].name + "\r\n";
}
alert(Mess); 
```

和之前一样，我们得到长度 2，但现在只列出了一层：
A

这两个代码示例不应该产生相同的结果吗？！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:17:31.540

我认为`Layers`是 Photoshop DOM 中的保留字。[Photoshop CS6 JavaScript 参考](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/products/photoshop/pdfs/cs6/Photoshop-CS6-JavaScript-Ref.pdf)

```
var Mess = "";
var lyrs = app.activeDocument.layers;
alert(lyrs.length);
for (n=0; n<lyrs.length; n++) {
    Mess = Mess + app.activeDocument.layers[n].name + "\r\n";
}
alert(Mess); 
```

更改变量名称后，这似乎现在可以工作。

# jquery - jquery .on() 似乎没有工作

> ID：10729791
> 
> 赞同：3
> 
> 时间：2012-05-24T00:47:05.427
> 
> 标签：jquery

我正在进行轨道模拟，我只是想在 mouseenter 和 mouseexit 事件中添加一些用户交互。[您可以在此处](http://jsfiddle.net/jzaun/Pe87m/)查看一个工作示例。

我的`on`声明是：

```
$('.planet').on({
    'mouseenter': function() {
        pauseAnimation = true;
    },
    'mouseleave': function () {
        pauseAnimation = false;
    },
    'click' : function () {
        alert('click');
    }
}); 
```

但似乎没有任何事件被触发。如果重要的话，我会在 Mac 上使用最新的 Chrome。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T00:59:39.303

这是一个 z-index 问题。添加`z-index: 1;`到`.planet`css 部分。之后小提琴工作正常：http: [//jsfiddle.net/Pe87m/9/](http://jsfiddle.net/Pe87m/9/)

# php - 如何在模态窗口中显示内容？

> ID：10729802
> 
> 赞同：3
> 
> 时间：2012-05-24T00:49:15.890
> 
> 标签：php, javascript, jquery, ajax

我在[这里](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable2.php)有一个简单的应用程序（QandATable2.php），当用户单击加号按钮时，它将打开一个模式窗口并显示存储在另一个页面（previousquestions.php）中的详细信息。

现在我遇到的问题是，如果您在文本框为空白时立即单击“搜索”按钮，您将看到它在自己的页面上加载页面，显示要在搜索短语中输入的消息，它还将以前从模式窗口中的所有功能显示到该页面中。这是不正确的。

我想要它做的是，如果用户点击了搜索按钮，那么当它发布表单并输出消息时，它会在模态窗口中执行它，而不是在它自己的整个页面上。那么有谁知道如何实现这一点？

我使用的模态窗口被称为 SimpleModal，它的网站在[这里](http://www.ericmmartin.com/projects/simplemodal-demos/)

下面是 QandATable2.php 代码，它显示加号按钮并打开模式窗口，将模式窗口的内容链接到 previousquestions.php 页面：

```
<script type="text/javascript">

  function plusbutton()
    {

    $.modal( $('<div />').load('previousquestions.php #previouslink') );            
    return false;
}

</script>

<h1>CREATING QUESTIONS AND ANSWERS</h1>

<table id="plus" align="center">
<tr>
<th>
<a onclick="return plusbutton();">
<img src="Images/plussign.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage"/>
</a>
<span id="plussignmsg">(Click Plus Sign to look <br/> up Previous Questions)</span>
</th>
</tr>
</table> 
```

下面是 previousquestions.php 代码，它在模式窗口中显示详细信息以及存储搜索功能的位置：

```
<?php

      foreach (array('questioncontent') as $varname) {
        $questioncontent = (isset($_POST[$varname])) ? $_POST[$varname] : '';
      }

?>

    <div id="previouslink">
    <button type="button" id="close" onclick="return closewindow();">Close</button>
    <h1>PREVIOUS QUESTIONS</h1>

    <p>Search for a previous question by entering in a phrase in the search box below and submitting the phrase</p>

    <form action="previousquestions.php" method="post">
          <p>Search: <input type="text" name="questioncontent" value="<?php echo $questioncontent; ?>" /></p>
          <p><input id="searchquestion" name="searchQuestion" type="submit" value="Search" /></p>
          </form>

    </div>

    <?php 

    //...connected to DB

                if (isset($_POST['searchQuestion'])) {

                  $questionquery = "SELECT QuestionContent FROM Question
              WHERE(QuestionContent = '".mysql_real_escape_string($questioncontent)."')";

            if (empty($questioncontent)){
        echo "Please enter in a phrase in the text box in able to search for a question";
    }
          ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:12:40.420

你可能想要使用 AJAX，因为你已经在使用 jQuery，你只需要这样的东西：

```
// override the "default" form submitting behavior with a callback function
$("form").submit(

    // this is the callback function for your form submit function.
    function(e)
    {

        // this prevents the page from reloading -- very important!
        e.preventDefault(); 

        // get the search data from the input textbox
        var s = $("input[name='questioncontent']").val();

        // see annotation
        $("#simplemodal-data").html("loading...")
           .load("previousquestions.php #previouslink", 
               { 
                   questioncontent : s,
                   searchQuestion : "Search"
               }
            );
    }); // end submit wrapper 
```

这会将值发送到服务器并将其加载到带有 id 的 div 中`simplemodal-data`

**注解：**

代码的最后一行做了几件事。首先，它将 simplemodal DIV 替换为“正在加载”消息。同时，它会向您的 previousquestions.php 页面发出 POST 请求。这部分`{ questioncontent : s, searchQuestion : "Search"}`是将表单中的数据传递到 PHP 页面的地方，（请记住上面的变量 var 赋值。最后，来自 previousquestions.php 页面的结果应该加载到 simplemodal-data 模式窗口中。

缺少的一件事是在加载方法中添加#previousquestions，以便只有一部分 HTML 文档被插入到模式中。将整个 HTML 页面加载到另一个 HTML 文档中从来都不是一个好主意，“加载”旨在让您只选择要插入的文档的一部分，即 DIV。

我在 php 文件名后添加了“#previouslink”。这就是魔法发生的地方。浏览器知道从您的 PHP 文件中提取该 DIV 并仅在页面上插入该部分，没有`<head> <body>`或任何不需要的标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:18:33.263

您可以通过使用 AJAX 提交表单来实现您正在寻找的内容，而不是使用页面重新加载新内容的默认行为。您不能使用 modal.load 因为您需要在请求中发布数据才能获得适当的响应。

但是，当使用 AJAX 发布数据时，您可以将响应作为 HTML 并将该 HTML 添加到页面上的 DIV，然后在该 DIV 容器上调用 SimpleModal 命令。

首先，修改表单上的提交按钮，使其为 type="button" 而不是 type="submit"。这将阻止表单提交和重定向页面。或者，您可以添加 event.preventDefault(); 并将 false 返回到表单提交单击处理程序（请参阅第二步），但在进行更改时尝试此方法可能更容易：

**第1步：**

```
<!-- change type to button -->
<input id="searchquestion" name="searchQuestion" type="button" value="Search" /> 
```

**第2步：**

为表单按钮创建一个处理程序，该处理程序使用 serializeArray 将表单序列化为字符串，然后将其 POST 到服务器。在成功回调处理程序中，您将获取 HTML 响应并将模式窗口中的内容替换为新的 HTML。这也会捕获错误（如果有），并警告它们并将它们写入控制台：

```
$('form[type="button"]').click(function() {

  var dataString = $('form').serializeArray();

  $.ajax({
    url: "/previousquestions.php?t="+new Date().getTime(),
    type: "POST",
    data: dataString,           
    context: document.body,
    success: function(data){ 
   alert(data); // results from server, either the HTML page, or JSON/XML
       $('simplemodal-data').html(data);  // if HTML, just insert into div#results
    },
    error: function(jqXHR, textStatus, errorThrown) {
    if(window.location.hostname == "localhost") {
        alert("Error submitting the form :: " + textStatus + " : " + errorThrown);                        
    }
    console.error("Error submitting the form :: " + textStatus + " : " + errorThrown);
    }
  });
}); 
```

**第 3 步：**

最后，确保您的`previousquestions.php`代码只返回部分 HTML 文档，而不是完整的 HTML 文档。由于您将 HTML 注入现有页面，因此不需要`<html>`、`<head>`或`<body>`部分。这些只会导致您的页面无法验证，并可能导致旧版浏览器出现不良行为。以下是您的响应的示例：

```
<div id="previouslink">
<button type="button" id="close" onclick="return closewindow();">Close</button>
<h1>PREVIOUS QUESTIONS</h1>

<p>Search for a previous question by entering in a phrase in the search box below and submitting the phrase</p>

<form action="previousquestions.php" method="post">
      <p>Search: <input type="text" name="questioncontent" value="test" /></p>
      <p><input id="searchquestion" name="searchQuestion" type="submit" value="Search" /></p>
      </form>

</div>

     <p>
         Your Search: 'test'     </p>

      <p>Number of Questions Shown from the Search: <strong>0</strong></p><p>Sorry, No Questions were found from this Search</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:39:37.977

我从另一个页面上的答案中发现了一个与此类似的问题，就像 Bergi 所说的那样，使用 iframe 比使用 ajax 更容易将内容显示在模态窗口中。所以这个问题的最佳答案在下面，它显示了 iframe 如何用于上述问题：

```
 function plusbutton() { 
    // Display an external page using an iframe 
    var src = "previousquestions.php"; 
    $.modal('<iframe src="' + src + '" style="border:0;width:100%;height:100%;">');
    return false;
} 
```

# php - 使用 URL 变量从我的 mysql 查询的重写 URL 获取空结果

> ID：10729803
> 
> 赞同：0
> 
> 时间：2012-05-24T00:49:40.367
> 
> 标签：php, mysql, url, rewrite

嗨，我有一个已启动的网站，但我的新闻文章没有显示，我正在使用 url 变量来确定要加载到动态 php 页面上的文章。

我的网站是 www.coverforce.com.au，问题链接是显示在右下角索引页面上的新闻文章。

我的查询代码如下：

```
 $totalRows_variablearticles = "-1";
if (isset($_GET['id'])) {
  $totalRows_variablearticles = $_GET['id']; 
  }
mysql_select_db($database_newsDBconnection, $newsDBconnection);
$query_variablearticles = sprintf("SELECT * FROM NewsArticles, NewsArticleCategories, NewsArticlePhotos, NewsPhotos, NewsCategories WHERE NewsArticles.id = %s AND NewsArticles.id = NewsArticleCategories.newsArticleID AND NewsArticles.id = NewsArticlePhotos.newsArticleID AND NewsArticlePhotos.newsPhotoID = NewsPhotos.id AND NewsArticleCategories.newsCategoryID = NewsCategories.id", GetSQLValueString($totalRows_variablearticles, "int"));
$variablearticles = mysql_query($query_variablearticles, $newsDBconnection) or die(mysql_error());
$row_variablearticles = mysql_fetch_assoc($variablearticles);
$totalRows_variablearticles = mysql_num_rows($variablearticles); 
```

我的 htaccess 代码是

```
Options +FollowSymlinks
RewriteEngine On
RewriteRule ^/?test\.html$ test.php [L]
RewriteRule ^/?index\.html$ index.php [L]
RewriteRule insurance-news/news/(.*)/(.*)/$ insurance-news/news.php?$1=$2

rewritecond %{http_host} ^coverforce.com.au [nc]
rewriterule ^(.*)$ http://www.coverforce.com.au/$1 [r=301,nc] 
```

这是我用来将内容加载到页面上的代码

```
<h1><?php echo $row_variablearticles['headline']; ?></h1>
    <p>Posted:<?php echo $row_variablearticles['publishDate']=substr($row_variablearticles['publishDate'],0,-8); ?></p>
    <p><br /> 
      <?php echo $row_variablearticles['text']; ?></p> 
```

你能提供的任何帮助都会很棒——如果我不尽快修好，我的老板会砍掉我的头，哈哈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:36:28.383

在 .htaccess 中，您有：

```
RewriteRule insurance-news/news/(.*)/(.*)/$ insurance-news/news.php?$1=$2 
```

您的代码正在寻找“id”的获取，因此该行肯定应该是

```
RewriteRule insurance-news/news/(.*)/(.*)/$ insurance-news/news.php?id=$2 
```

做一个 print_r($_GET); （或者如果站点是活动的，则转储到日志文件）并检查它显示的内容。

# asp.net - 在 ASP.net C# 中将文本添加到 JPG 图像并保存到服务器上的文件

> ID：10729805
> 
> 赞同：1
> 
> 时间：2012-05-24T00:50:00.947
> 
> 标签：asp.net, visual-studio, drawstring

我正在使用以下代码（归功于 Dolph Larson）在 ASP.net 服务器上获取位图格式的预制图像文件，在其上绘制一个字符串并将其保存到服务器上的文件中。在原始代码中，他将位图转储到 OutputStream，但我想将其转储到文件中。

下面的代码版本成功创建了新文件，但是当我打开它时，字符串并没有出现在新文件中的图像上。我想我错过了一步——当我使用 bitMapImage.Save("bitmaptest.jpg", ImageFormat.Jpeg) 时，我只是重新保存原始版本而不是修改后的版本吗？

这是代码：

```
 //Load the Image to be written on.
        Bitmap bitMapImage = new
        System.Drawing.Bitmap(Server.MapPath("generic.jpg"));
        Graphics graphicImage = Graphics.FromImage(bitMapImage);
        graphicImage.SmoothingMode = SmoothingMode.AntiAlias;
        graphicImage.DrawString("testing 1 2 3",
        new Font("Arial", 20, FontStyle.Bold),
        SystemBrushes.WindowText, new Point(0, 0));
        Response.ContentType = "image/jpeg";
        bitMapImage.Save("bitmaptest.jpg", ImageFormat.Jpeg);
        graphicImage.Dispose();
        bitMapImage.Dispose(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:03:29.580

你的代码工作得很好；您只需指定要保存图像的路径：

例子：

```
//Load the Image to be written on.
        Bitmap bitMapImage = new
        System.Drawing.Bitmap((@"c:\\foo\\generic.jpg"));
        Graphics graphicImage = Graphics.FromImage(bitMapImage);
        graphicImage.DrawString("testing 1 2 3",
        new Font("Arial", 20, FontStyle.Bold),
        SystemBrushes.WindowText, new Point(0, 0)); 
        bitMapImage.Save("c:\\foo\\bitmaptest.jpg", ImageFormat.Jpeg);
        graphicImage.Dispose();
        bitMapImage.Dispose(); 
```

**注意**在您的情况下， bitMapImage.Save 需要如下所示：`bitMapImage.Save(Server.MapPath("~/Images")+"newImage.jpg",ImageFormat.Jpeg);`因为您试图将图像保存在 asp.net 应用程序上。`~/Images`在我的示例中只是`Images`应用程序中的虚拟目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:01:19.160

是的..您正在保存相同的图像。您必须创建一个新的 wbitmap 并保存它：-

```
Bitmap bitMapNew = Bitmap.FromHbitmap(graphicImage.GetHdc());
bitMapNew.Save("bitmaptest.jpg", System.Drawing.Imaging.ImageFormat.Jpeg); 
```

添加这些行而不是您的 bitMapImage.save

# c# - 使用 C# 图表控件处理数据

> ID：10729808
> 
> 赞同：0
> 
> 时间：2012-05-24T00:50:31.490
> 
> 标签：c#, .net, visual-studio-2010

目前我正在开发一个程序，该程序将同时通过串行端口从激光位移传感器获取测量数据，并将实时绘制数据图表。我从未在 C# 中广泛使用 I/O，更不用说在图表控件中处理大型数据集了。

现在我使用后台工作人员从串行端口连续读取数据并将其移动到一个数组中，并且在从端口读取每个数字后，后台工作人员报告通过进度报告有一个新的可用数字。从报告处理程序中，我在图表上绘制了这个新点，并重新计算了平均值、众数、标准差、控制上限和下限等。其他一些图表和视图端口也使用新数据进行了更新。这应该能够连续进行。

（对于那些想知道的人，我把所有这些信息都记下来只是因为这个网站的随机建议在过去有很大的帮助）

现在这是我的问题：

我想将捕获的数据保存到文本文件中，但不能中断数据捕获或绘图。我最好将采样的数据立即写入文本文件并仅将最近的 500 个点复制到数组中吗？然后我可以每 10 分钟左右开始一个新的文本文件以保持大小限制，然后添加数据捕获的时间和日期以供以后参考。有没有办法将图表绑定到队列之类的东西，然后每次我向队列添加一个值时，它都会丢弃最旧的点？我需要一种方法来处理图表系列中早于 500 个样本的点，因为随着越来越多的点被添加，它似乎会减慢图表控制。

这是我第一次尝试多线程，所以如果我做错了什么，请尽量不要跳到我的喉咙里。

提前感谢您的所有建议！任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:31:18.200

对于您的排队问题，请查看有关有限大小队列的[线程。](https://stackoverflow.com/questions/1292/limit-size-of-queuet-in-net)

对于您的日志记录，您能否编写第二个处理程序，在低优先级线程上运行，记录事物而不是绘制它们？

# cocoa - 如何在可以在该窗口内移动和调整大小的 NSWindow 中创建 QTMovieView？

> ID：10729813
> 
> 赞同：2
> 
> 时间：2012-05-24T00:50:59.493
> 
> 标签：cocoa, osx-lion, qtkit

我正在创建一个 Cocoa NSWindow，其中（通过 IB）是 QTCaptureView、QTMovieView 和各种按钮和文本字段。

以编程方式，我做了以下事情：

创建了一个新的 QTMovie：

```
- (BOOL)readFromURL:(NSURL *)url ofType:(NSString *)typeName error:(NSError **)outError
{
    QTMovie *movie = [QTMovie movieWithURL:url error:outError];
    if (movie){
        [self setMovie:movie];
    }
    return (movie != nil);
} 
```

然后相应地设置 QTMovieView：

```
- (void)windowControllerDidLoadNib:(NSWindowController *)aController
{
    [super windowControllerDidLoadNib:aController];

    [movieView setShowsResizeIndicator:YES];
    [[movieView window] setShowsResizeIndicator:NO];    

    mainWindow = [aController window];
    [[mainWindow contentView] addSubview:movieView];
} 
```

电影播放良好，我的网络摄像头被捕获并显示。我有两个似乎无法解决的问题；

1.  我想根据 QTMovie 纵横比调整 QTMovieView 的大小。我有点在 IB 中执行此操作，但 QTMovieView 窗口的大小保持不变，只有电影以所需的大小播放。

2.  我还想调整 QTMovieView 的大小并将其移动到 NSWindow 周围。

我在网上搜索并没有找到答案，所以很可能这不是无法完成的事情，而是我的代码有问题。

我一直在使用“QTKit 应用程序教程”文档。

**[编辑 25/05/2012]**

从第 28 页开始，它描述了如何将窗口大小调整为电影自然大小属性。我跟着这个，但主窗口调整了大小，而不是 QTMovieView 窗口。

```
[[movieView window] setContentSize:contentSize]; 
```

所以我猜我的理解是不正确的，QTMovieView 窗口是主窗口。QTMovieView 窗口所在的没有其他子窗口，只是我放置的那个！

**[编辑 26/05/2012]**

在 Cocoa 中只有一个窗口并且没有子窗口的概念！要允许拖动 QTMovieView，您必须让它接受鼠标事件。为此，您必须对其进行子类化并覆盖；

```
- (BOOL)acceptsFirstMouse:(NSEvent *)theEvent 
```

基本上阅读苹果的“处理鼠标事件”文档。

至于调整大小，我现在正在努力。

**[结束编辑]**

任何想法将不胜感激。谢谢。

# jquery-plugins - 如何在我的 Jmenu Jquery 插件中更改所选菜单的外观

> ID：10729815
> 
> 赞同：1
> 
> 时间：2012-05-24T00:51:04.547
> 
> 标签：jquery-plugins, jmenu

我正在使用此链接[http://www.myjqueryplugins.com/jMenu](http://www.myjqueryplugins.com/jMenu)中提到的 JMenu Jquery 插件 我正在使用以下脚本填充 Jmenu：-

```
$(document).ready(function(){ 
$("#jMenu").jMenu();
}); 
```

但目前，如果用户点击一级菜单，则无法区分此选定菜单，因为它的大小和外观不会改变，我查看所有可用的 Jmenu 选项，但我找不到如何强制选定菜单具有外观不同？BR

# python - 在python中将数字相加，数字是从dict列表中提取的

> ID：10729816
> 
> 赞同：2
> 
> 时间：2012-05-24T00:51:19.680
> 
> 标签：python, syntax

蟒蛇新手！这是我在 python 中的字典列表：

```
[{'amt': 400, 'name': 'whatever1'}, {'amt': 300, 'name': 'whatever3'}, {'amt': 500, 'name': 'whatever2'}] 
```

我想在不使用完整的 for 循环的情况下将所有“amt”添加在一起。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T00:53:59.383

```
sum(L['amt'] for L in list_of_dicts) 
```

应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:16:29.543

```
from operator import itemgetter
from itertools import imap
sum(imap(itemgetter('amt'), your_list)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:33:59.300

另一种方式：

```
>>> LofD=[{'amt': 400, 'name': 'whatever1'}, {'amt': 300, 'name': 'whatever3'}, {'amt': 500, 'name': 'whatever2'}]
>>> SumofAmt=0
>>> for each in LofD:
...    SumofAmt+=each['amt']
... 
>>> SumofAmt
1200 
```

# r - 将文本放在 R 中的绘图旁边

> ID：10729817
> 
> 赞同：0
> 
> 时间：2012-05-24T00:51:29.007
> 
> 标签：r, plot

我有一个包含许多“线”的情节（使用类型为 l 的点）。

我想在它们旁边放一小段文字。我可以通过各种方式做到这一点，例如使用 mtext，但问题是要自动生成很多图，并且单个图中可能有很多行，所以我希望文本*自动*关闭在一个空的地方排队...

有没有办法做到这一点？

# r - data.table 作为 DT[ ,x:=f(y),by=z] 分组分配的有效替代方案？

> ID：10729820
> 
> 赞同：8
> 
> 时间：2012-05-24T00:51:47.310
> 
> 标签：r, data.table

我正在寻找尚未实施的（据我所知）分配的最佳替代方案，按组在 data.table 中引用。使用 data.table 示例，

```
DT = data.table(x=rep(c("a","b","c"),each=3), y=c(1,3,6), v=1:9)
     x y v
[1,] a 1 1
[2,] a 3 2
[3,] a 6 3
[4,] b 1 4
[5,] b 3 5
[6,] b 6 6
[7,] c 1 7
[8,] c 3 8
[9,] c 6 9 
```

我想添加一个新列 z，其中包含按 x 值分组的 f(y,v)（让我们采用 f(y,v)=mean(y)+v）。请注意，我不想打印或存储此计算的结果，如

```
DT[,mean(y)+v,by=x]
      x        V1
 [1,] a  4.333333
 [2,] a  5.333333
 [3,] a  6.333333
 [4,] b  7.333333
 [5,] b  8.333333
 [6,] b  9.333333
 [7,] c 10.333333
 [8,] c 11.333333
 [9,] c 12.333333 
```

而是我想将结果添加到 DT：

```
 x y v        V1
[1,] a 1 1  4.333333
[2,] a 3 2  5.333333
[3,] a 6 3  6.333333
[4,] b 1 4  7.333333
[5,] b 3 5  8.333333
[6,] b 6 6  9.333333
[7,] c 1 7 10.333333
[8,] c 3 8 11.333333
[9,] c 6 9 12.333333 
```

我的 data.table 有 262 MB，这样

```
DT <- DT[,transform(.SD,mean(y)+v),by=x] 
```

不是一个选项，因为我不能在内存中两次放置 DT（我认为这是复制操作所暗示的）。事实是我从未见过该操作完成。

我有什么选择（直到 data.table 附带 DT[,z:=mean(y)+v,by=x]）？

我刚读到 DT[newDT]。这里有什么问题？

```
newDT <- DT[,mean(y)+v,by=x]
      x        V1
 [1,] a  4.333333
 [2,] a  5.333333
 [3,] a  6.333333
 [4,] b  7.333333
 [5,] b  8.333333
 [6,] b  9.333333
 [7,] c 10.333333
 [8,] c 11.333333
 [9,] c 12.333333 
```

（这是可行的记忆方式。）然后：

```
> DT[newDT]
setkey(DT,x)
setkey(newDT,x)
x y v        V1
a 1 1  4.333333
a 3 2  4.333333
a 6 3  4.333333
a 1 1  5.333333
a 3 2  5.333333
a 6 3  5.333333
a 1 1  6.333333
a 3 2  6.333333
a 6 3  6.333333
b 1 4  7.333333
b 3 5  7.333333
b 6 6  7.333333
b 1 4  8.333333
b 3 5  8.333333
b 6 6  8.333333
b 1 4  9.333333
b 3 5  9.333333
b 6 6  9.333333
c 1 7 10.333333
c 3 8 10.333333
c 6 9 10.333333
c 1 7 11.333333
c 3 8 11.333333
c 6 9 11.333333
c 1 7 12.333333
c 3 8 12.333333
c 6 9 12.333333 
```

但这不是我想要的。这里有什么错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:27:02.913

```
DT[, xm := ave(y, x, FUN=mean) + v] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T07:18:12.570

我会做以下事情：

```
DT[, list(fvy = mean(y)), by="x"][DT][, fvy := fvy + v] 
```

所以基本上，我把它分成两部分：首先，我计算 的平均值`y`并将其添加到 DT，然后我添加`v`到 的平均值`y`。记忆方面，我不确定这是否真的有帮助，但作者很有可能会看看并让我们知道;-)

关于您的问题为什么它不起作用：基本上，您最终会得到两个要合并的 data.tables：`DT`和`newDT`. 两个 data.tables 每个键都有 3 次。所以很明显，当你合并它们时，每个组合都在结果中，这就是你得到一个包含 9 个 a、b 和 c 的 data.table 的原因。

因此，要按照与我的非常相似的方式进行操作，您需要第二把钥匙：

```
newDT <- DT[,list(fvy=mean(y)+v, v),by=x]
setkey(newDT, x, v)
setkey(DT, x, v)
DT[newDT]
      x v y       fvy
 [1,] a 1 1  4.333333
 [2,] a 2 3  5.333333
 [3,] a 3 6  6.333333
 [4,] b 4 1  7.333333
 [5,] b 5 3  8.333333
 [6,] b 6 6  9.333333
 [7,] c 7 1 10.333333
 [8,] c 8 3 11.333333
 [9,] c 9 6 12.333333 
```

# mysql - 如何在 MySQL 中插入 BLOB 和 CLOB 文件？

> ID：10729824
> 
> 赞同：31
> 
> 时间：2012-05-24T00:52:35.127
> 
> 标签：mysql, ubuntu, qt4

我想使用我的软件前端存储图像和 .docx/.doc、.pptx/.ppt、.pdf 文件。我不明白如何实现这一点以及如何将 BLOB 和 CLOB 文件插入表中。请帮忙。

我正在使用 Kubuntu 11.04、MySQL5、Qt 4.7.3。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-24T06:56:03.470

两种方式：

1 - 使用[LOAD_FILE](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_load-file)函数 -

```
INSERT INTO table1 VALUES(1, LOAD_FILE('data.png')); 
```

2 - 将文件插入为十六进制字符串，例如 -

```
INSERT INTO table1 VALUES 
  (1, x'89504E470D0A1A0A0000000D494844520000001000000010080200000090916836000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000001E49444154384F6350DAE843126220493550F1A80662426C349406472801006AC91F1040F796BD0000000049454E44AE426082'); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-08-06T13:52:02.273

```
INSERT INTO MY_TABLE(id, blob_col) VALUES(1, LOAD_FILE('/full/path/to/file/myfile.png') 
```

LOAD_FILE 附加了许多条件。从[MySQL 文档](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_load-file)：

> LOAD_FILE（文件名）
> 
> 读取文件并将文件内容作为字符串返回。要使用此功能，文件必须位于服务器主机上，必须指定文件的完整路径名，并且必须具有 FILE 权限。该文件必须可供所有人读取，并且其大小小于 max_allowed_pa​​cket 字节。如果将secure_file_priv 系统变量设置为非空目录名，则要加载的文件必须位于该目录中。
> 
> 如果文件不存在或由于不满足上述条件之一而无法读取，则该函数返回 NULL。

此外，Linux 中的 LOAD_FILE 也存在错误。有关该错误，请参阅[http://bugs.mysql.com/bug.php?id=38403 ，以及](http://bugs.mysql.com/bug.php?id=38403)[返回 NULL 的 MySQL LOAD_FILE](https://stackoverflow.com/questions/4607486/mysql-load-file-returning-null)以获取解决方法。在 Ubuntu 12.04、MySQL 5.5.32 上，这对我有用：

1.  将文件复制到 /tmp
2.  将所有权更改为 mysql 用户`chown mysql:mysql /tmp/yourfile`
3.  以 mysql root 用户身份登录 mysql，因此您确定您具有 FILE 权限
4.  运行您的插入语句

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-29T14:30:31.187

或者您可以仅使用 MySQL Workbench，选择行、最后一行，插入没有 blob 的行，然后只需右键单击并选择“从文件加载值”。

[![在此处输入图像描述](../Images/56c995da0d7803e33231382e88dfed36.png)](https://i.stack.imgur.com/xzmNL.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-01T23:57:20.107

```
INSERT INTO table1 VALUES(1, LOAD_FILE(data.png)); 
```

不会工作，但

```
INSERT INTO table1 VALUES(1, LOAD_FILE('data.png')); 
```

应该（假设 data.png 存在于本地目录中）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-19T13:05:50.907

对于那些在通过查询保存 Blob 时出现“列'图像'不能为空”错误的人：-

打开您的 MySql 命令行客户端并使用 root 用户登录并输入

```
mysql> SHOW VARIABLES LIKE "secure_file_priv"; 
```

这将向您显示 MySql 用于访问文件的安全路径。就像是

```
+------------------+-----------------------+
| Variable_name    | Value                 |
+------------------+-----------------------+
| secure_file_priv | /var/lib/mysql-files/ |
+------------------+-----------------------+ 
```

您可以将文件粘贴到此文件夹中，也可以将“secure_file_priv”变量值更改为“空字符串”，以便它可以从任何地方读取文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-01T15:47:58.380

如果您使用的是 mysql 工作台，只需右键单击字段（单元格）并选择“从文件加载值”选项，然后浏览到文件并单击打开，然后单击应用。它会自动生成这样的查询

```
UPDATE `dbname`.`tablename` SET `columnname` = ? WHERE (`row` = '1'); 
```

# spring - 控制器的 Spring web annation

> ID：10729828
> 
> 赞同：0
> 
> 时间：2012-05-24T00:53:22.350
> 
> 标签：spring

我需要将 Spring Web 应用程序迁移到注释。

它使用 SimpleUrlHandlerMapping + ParameterMethodNameResolver，所以 url 将是 /myjob.do?cmd=addNew 。将其转换为 Annotation 的最简单方法是什么？是这样的吗？

```
@RequestMapping("/myjob.do?cmd=addNew")
public ModelAndView addNew(....) throws Exception {
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:23:53.027

假设您有多个 cmd 值：

```
@Controller
@RequestMapping("/myjob.do")
public class MyController {

@RequestMapping(params = "cmd=addNew")
public ModelAndView addNew(....) throws Exception {
 }
} 
```

# iphone - 从服务器下载高分辨率图像以进行视网膜显示的策略

> ID：10729829
> 
> 赞同：1
> 
> 时间：2012-05-24T00:53:45.670
> 
> 标签：iphone, ios, image, retina-display

因此，对于 iOS 上的视网膜显示器，根据苹果关于如何进行视网膜显示器的指南，我通常会拥有两倍大小的图像，命名为 @2x。但是这种命名约定仅适用于我无法写入的应用程序包中的图像。

你从服务器上下载高分辨率图像的策略是什么？

我是否应该总是拉下高分辨率图像（对于普通的 60x60 图像来说是 120x120）并将其拍到 uiimageview 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:58:33.330

设置视网膜图像，你应该

```
UIImage *image;  // from download
image=[UIImage imageWithCGImage:[image CGImage] scale:2.0 orientation:UIImageOrientationUp]; 
```

首先检查您是否有视网膜显示器

```
if([[UIScreen mainScreen] respondsToSelector:@selector(scale)])
    BOOL retina = [[UIScreen mainScreen] scale] == 2.0 ? YES : NO; 
```

如果 "retine == YES" ，获取你想要的视网膜图像

# asp.net - 使用 asp.net 应用程序访问扫描仪、条形码、相机

> ID：10729835
> 
> 赞同：1
> 
> 时间：2012-05-24T00:54:07.120
> 
> 标签：asp.net, barcode-scanner

我有从 asp.net 应用程序访问扫描仪、条形码阅读器、相机等的奇怪要求。由于这些是本地资源，我知道这是不可能的。我想知道这个问题是否有其他解决方案。

我正在考虑创建一个将在本地系统上运行的 Windows 服务，并将打开一个端口并监听它并完成所需的工作。我想知道是否有一种方法可以使用 JS 或其他库或 activex 从 asp.net 页面向本地端口发送某种消息。

如果您有完全不同的解决方案，我会全力以赴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:10:37.067

我们通过创建一个小型应用程序（TCL/TK 原创，因为它在 Win/Mac/Lin 上运行良好，但自从 mono 长大后现在是 C#/.NET）解决了一个类似的问题（连接到串行端口的票务打印机），即

*   获取用户/密码
*   使用 Web 请求创建会话。
*   打开浏览器，
*   将 URL 中的会话令牌作为锚点 (http[s]://foo.bar/baz?x=y#sessiontoken)

这样，它永远不会通过网络传输，而是可供客户端中的 JS 代码使用。

助手应用程序启动浏览器后，它使用长轮询和会话令牌（浏览器和助手应用程序都知道）与网络服务器通信 - 作为客户端应用程序，它可以很自然地与外围设备通信。

以这种方式打印的 1000 张门票中有 100 张...

**编辑：** 是的，我知道这会越来越长，但我需要（并且被要求）详细说明。

如果你想避免走我强烈建议的 ActiveX/Silverlight/whatever 路线，你需要 4 名玩家：

1.  网络服务器
2.  浏览器
3.  助手应用程序（“代理”）
4.  设备（票据打印机、条形码扫描仪等）

您的基本问题是，1\. 需要与 4\. 交谈，但不能。因此，您选择了两条并行路径：用于用户的通信在服务器和浏览器之间交换，而用于设备的通信在服务器和代理之间交换，后者将其中继到设备（当然反过来）。

代理是一个非常简单的应用程序，它通过操作系统设施与设备对话（具体如何完成当然取决于设备），并通过 HTTP 请求与网络服务器对话。

根据您需要的信息流方向：

*   为了促进从设备到服务器的信息流，只需让设备上的活动触发网络请求。（输入设备，例如条码扫描仪）
*   为了促进从服务器到设备的信息流，使用长轮询。（输出设备，例如票据打印机）
*   对于两个方向都做（服务器触发的输入设备，例如相机）

现在剩下的问题是，如何将浏览器中的人为操作与设备操作相关联——简而言之：服务器如何将您在浏览器中选择的票发送**到**您**的**票打印机，而不是发送到接下来进行长轮询的任何打印机。

为了解决这个问题，使用会话 ID 是很自然的选择——但它需要让浏览器和代理都知道相同的会话 ID。为此，您需要从一个到另一个进行通信。由于您无法将其从浏览器传递给代理（否则此讨论将没有实际意义），因此您需要以相反的方式进行沟通 - URL 中的锚点是实现此目的的工具。您执行以下操作：

*   用户启动代理（不是浏览器！）并输入他的凭据
*   代理调用向服务器发送登录 Web 请求，并取回会话令牌（请使用一些基本加密或使用 HTTPS）
*   然后代理启动浏览器（例如通过执行`cmd.exe /c start "http[s]://domain.tld/start.aspx?x=y#sessiontoken"`）
*   由于会话令牌是一个锚点，它不会通过网络发送，但可供浏览器端的代码使用……宾果游戏！
*   现在两个并行路径是打开的：人类请求的浏览器，知道会话令牌，代理现在进入上述模式，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:57:13.967

您可以使用 ActiveX 来做到这一点，或者可能使用 Silverlight（或 Flash）来提供有限的支持（至少在我的经验中相机、麦克风和扫描仪）。

但是，鉴于以前与您尝试做的事情相关的经验，我建议您最好购买预构建的 SDK。

成像：

[http://www.viscomsoft.com/](http://www.viscomsoft.com/)

条码：

[http://www.tec-it.com/software/barcode-software/tbarcode/barcode-generator/Default.aspx](http://www.tec-it.com/software/barcode-software/tbarcode/barcode-generator/Default.aspx)

# ruby-on-rails - 带有 JSON 数据的跨域 ajax 帖子以 HTML 格式发送到 Rails 控制器

> ID：10729837
> 
> 赞同：0
> 
> 时间：2012-05-24T00:54:17.463
> 
> 标签：ruby-on-rails, json, jquery

我正在发出跨域 POST 请求，并已在 Rails 3.2 中设置标头以适当地接受请求 - 控制器正确接收 OPTIONS 和 POST 请求。

我发现的问题是 Rails 控制器将 JSON 数据作为 HTML 接收。为什么是这样？如何强制控制器将其视为 JSON？（从客户端这样做会更好）

如果不清楚，请告诉我应该发布哪些消息/代码以获得更好的帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:55:19.993

您可以尝试将`JSON`扩展名添加到您正在向其发出请求的 URL，即`https://your_domain.com/your_url.json`，这应该强制`JSON`格式。

# c - 我以前从未见过加密。这个 C 加密片段有什么作用？

> ID：10729839
> 
> 赞同：1
> 
> 时间：2012-05-24T00:55:02.453
> 
> 标签：c, encryption

几周前，我收到了一些代码，作为我感兴趣的加密工作申请的一部分。他们给我发了一个代码，基本上想看看我是否理解它并可以改进它。

我尽了最大努力，但所有代码对我来说都是全新的，我不知道它做了什么。我最终放弃了它，因为我还有其他事情要做。但是，我仍然对学习它非常感兴趣，只是为了知识。谁能帮我更多地了解这种类型的编程或具体做什么？

我会尽量减少它并给出我的印象。

这是进行实际加密的部分；据我所知，使用 XOR 加密。它是否正确？我也相信 input_2 和 input_1 被错误地切换了。

```
typedef int int32;
typedef char int8;

void change_it(int8 *output, int8 *input_1, const int8 *input_2, int32 length)
{
    int32 i = 0;

    for(i=0; i<length; i++)
    {
        output[i] = (int8)(input_1[i] ^ input_2[i]);
    }
    return;
} 
```

在这里，他们重载了 an`itoa`以将字符串转换为十进制或十六进制数字，尽管我不确定出于什么目的。

```
void itoa( int32 num, int8  *alpha, int32 radix )
{
    if( radix == 10 )
    {
        sprintf(alpha, "%i", num);
    }
    else if( radix == 16 )
    {
        sprintf(alpha, "%X", num);
    }
} 
```

这是 main 调用的主要运行函数。它做了一些奇怪的按位操作，然后调用了 change_it 4 次。这是最让我难过的部分。

```
int8 *modify_it(int32 modifier, const int8  *input_1, int32 length)
{
    int8  leading[3];
    int32 i_leading;
    int8 * temp_string = NULL;
    int8 * ret;
    int32 i = 0;

    itoa(modifier/2, leading, 10);
    i_leading = atoi(leading);

    temp_string = (int8 *) malloc(8);
    ret = (int8 *) malloc(length);
    memset(temp_string, 0, 8);
    temp_string[0] = 0;

    if( (modifier+1)%2 == 0 ) {
        temp_string[0] = (int8)((i_leading<<4) + 8);
    }
    else {
        temp_string[0] = (int8)(i_leading<<4);
    }

    for(i=0; i<(length>>3); i++)
    {
        change_it(ret+i*8, temp_string, input_1+i*8, 8);
    }
    free(temp_string);

    return ret;
} 
```

最后但并非最不重要的一点是启动它的主要功能。

```
int main(int argc, char **argv) {

    int8 data[32];
    memset(data, 0x0A, sizeof(data));

    int8 *resp = modify_it(0xFF, data, sizeof(data));

    free(resp);
    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T01:39:56.287

基本上，它的作用是 - 为了更好的术语 - 混淆输入。

这是一个非常业余的尝试，在保护和存储数据方面都会失败。

有许多错误，例如清除数组（可以在分配期间使用 calloc 完成），然后通过“手动”清除其中的一部分“确保”再次清除它。这有很多很多的问题，这让我既想呕吐又想笑。

如果这不是家庭作业，就把它扔掉。不要试图从中学习。这段代码没有什么是正确或好的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T02:45:06.880

有许多级别可以批评代码。

1.  它没有任何输入或输出，因此功能也可能不存在。
2.  添加输出时，要加密的数据是固定的（32 个换行符）。
3.  “加密”是通过一种微弱的机制完成的（正确完成的 XOR 加密比 ROT-13 强，但强不了多少。
4.  'key' 是基于`0xFF`传入`modify_it()`函数的单个固定字节加上 7 个零字节。
5.  与 0 的异或不会隐藏任何内容，因此每个 8 中只有 1 个字节被代码更改。
6.  它使用最基本的[ECB](http://www.wikipedia.org/wiki/Encryption_modes)（电子密码本）模式，独立加密每个8字节块，而不是任何更复杂的方案（CBC等）。
7.  该代码不演示解密。
8.  该代码并未证明解密加密材料会给您留下原始材料。
9.  它不会错误检查诸如`malloc()`.
10.  格式化`127`为`leading`.
11.  严重的密码代码一旦完成就需要覆盖密钥。

等等。

总的来说，“忽略此代码”的建议是合理的。但是，发送给您的公司可能完全意识到它是垃圾。他们想看看你会想出什么问题，你会如何分析它，如果你提供了补救措施，你会提供什么补救措施。

将其视为一段简单的糟糕 C 代码；如此分析。如果您有知识，请密切关注加密货币，但即使对加密知之甚少，也有很多要批评的地方。

```
Before:
0x0000: 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A   ................
0x0010: 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A   ................
After:
0x0000: F2 0A 0A 0A 0A 0A 0A 0A F2 0A 0A 0A 0A 0A 0A 0A   ................
0x0010: F2 0A 0A 0A 0A 0A 0A 0A F2 0A 0A 0A 0A 0A 0A 0A   ................
Decrypt:
0x0000: 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A   ................
0x0010: 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A 0A   ................ 
```

# google-app-engine - 由于渠道无缘无故过时而不断断开连接

> ID：10729842
> 
> 赞同：4
> 
> 时间：2012-05-24T00:55:40.600
> 
> 标签：google-app-engine

自从几天前的最新版本以来，我们的用户不断被断开连接，因为通道令牌在创建几分钟后就过时了。我们的令牌设置为持续 5 小时，但如果它们持续 5-10 分钟，我们就很幸运了，当频道关闭时，我们甚至无法重新连接新的频道令牌，直到用户刷新。

Javascript 错误触发它的开始。它看起来像这样：

NetworkError: 400 Unknown SID - [http://89.talkgadget.google.com/talkgadget/dch/bind?VER=8&clid=C9C2EFC06C7C5163&gsessionid&prop=data&token=AHRlWrrWl611ZMMDw8Apgi5vdYuS9UslofxEiJI47-2n4rkPgmuu1z0AN-UNQcyNEvhck-AYAMSLPru8Aumooz62hYNNbLTbi1a3lTSAzGEyj6TsXZirJYE&RID=rpc&SID=BEBDEFDA92C6A9F7&CI=0&AID=54&TYPE=xmlhttp&zx= gsjg8mb1i987&t=1](http://89.talkgadget.google.com/talkgadget/dch/bind?VER=8&clid=C9C2EFC06C7C5163&gsessionid&prop=data&token=AHRlWrrWl611ZMMDw8Apgi5vdYuS9UslofxEiJI47-2n4rkPgmuu1z0AN-UNQcyNEvhck-AYAMSLPru8Aumooz62hYNNbLTbi1a3lTSAzGEyj6TsXZirJYE&RID=rpc&SID=BEBDEFDA92C6A9F7&CI=0&AID=54&TYPE=xmlhttp&zx=gsjg8mb1i987&t=1)

然后，在 Firefox Firebug 中，控制台被无限地发送垃圾邮件

频道名称不匹配；消息被忽略

直到发生刷新。

我们的网站是一个带有聊天功能的实时互动网站。我们的用户正在向我们发送电子邮件，因为他们不断断开连接。他们要离开现场。这不仅让我们失去了用户群的善意，还让我们付出了金钱，而且我们无能为力，因为漏洞出在 Google App Engine 上。

请立即修复此问题或回滚到以前的版本，直到您弄清楚为止。最新版本已损坏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:55:25.580

我无法重现此内容，但我仍在查看它。同时：如果您在收到错误后显式调用 socket.close() ，您是否可以创建一个新的 Channel 对象并重新连接？如果这不起作用，您甚至可以尝试手动从 DOM 中删除 id 为“wcs-iframe”的元素本身。执行此操作时，您应该能够使用原始令牌，而不是获取新令牌。

# ruby-on-rails-3 - Rails 中 expires_in cookie 的区别

> ID：10729848
> 
> 赞同：0
> 
> 时间：2012-05-24T00:56:27.727
> 
> 标签：ruby-on-rails-3, cookies

有什么区别：

```
cookies[:login] = { :value => "XJ-122", :expires => 1.hour.from_now } 
```

和

```
cookies[:login] = { :value => "XJ-122", :expires => 1.hour } 
```

这两个时间不是在设置cookie时计算的，因此'from_now'无关紧要吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T03:19:55.753

您可以随时使用“rails 控制台”检查您的理解。

```
$ rails c
Loading development environment (Rails 3.2.3)
1.9.2-p318 :001 > 1.hour
 => 3600 seconds 
1.9.2-p318 :002 > 1.hour.class
 => Fixnum 
1.9.2-p318 :003 > 1.hour.from_now
 => Fri, 25 May 2012 04:16:57 UTC +00:00 
1.9.2-p318 :004 > 1.hour.from_now.class
 => ActiveSupport::TimeWithZone 
```

ActiveSupport::TimeWithZone 是一个“美化”的时间类。

:expires 需要一个 Time 实例。所以，你应该使用 1.hour.from_now

# excel - SSRS 2005 导出到 Excel 交替行颜色问题

> ID：10729860
> 
> 赞同：1
> 
> 时间：2012-05-24T00:59:19.957
> 
> 标签：excel, reporting-services, reportingservices-2005

我有 SSRS 2005 并且我的 RDL 被格式化为具有交替的行颜色。以 HTML 或 PDF 格式呈现报告时，格式正确，但当我尝试导出到 Excel 时，交替的行颜色不显示。我尝试将 SSRS 2008 与 RDL 一起使用，并且不知何故它们工作正常，但尽管我更喜欢使用 SSRS 2008，但客户端使用 SSRS 2005，因此升级到 2008 是不可能的。谁能指出我正确的方向？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:06:21.227

尽管我认为 Jamie F 是对的，并且在导出到 Excel 时这将归结为一个问题，但您可以通过以另一种方式突出显示单元格来解决此问题。

您能否尝试为 tablix 控件中的任何单元格转到*文本框属性，然后在**填充*和填充颜色下输入以下表达式：

```
=iif(RowNumber(Nothing) Mod 2, "#eefafd", "White") 
```

然后，这将突出显示该单元格的行。如果可行并且您可以将其导出到 Excel，那么您也需要将其应用于其他单元格。

希望这能让你越过界限，如果你有任何问题，请告诉我:)

# facebook - Facebook Open Graph 多个对象发布

> ID：10729861
> 
> 赞同：2
> 
> 时间：2012-05-24T00:59:33.643
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

如何在一篇文章中对多个对象应用操作？例如，John Doe 通过 MyApp 购买了“项目 A”和“项目 B”

我在仪表板的操作设置中看到了句子的示例，如果这些句子存在，应该有办法发布它们，但我不知道如何发布。

"用户使用 AppName 拍摄了 {photo1} 和 {photo2}" "用户使用 AppName 拍摄了 {photo1} 和 {photo count other photos}"

我尝试发布到链接：[http://graph.facebook.com/namespace:action/object](http://graph.facebook.com/namespace:action/object)和 object=url_object1 和另一个 object=url_object2 ，尝试过 object={url_object1,url_object2} ，没有任何效果，也没有任何文档facebook 至于如何做到这一点。

ps 认真的吗？不能添加没有声誉的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:36:43.773

您发布了两个单独的操作

```
user brought object1
user brought object2 
```

Facebook 可能会也可能不会将这些聚合成一个故事。

# c# - 用字符串数组修剪

> ID：10729863
> 
> 赞同：0
> 
> 时间：2012-05-24T00:59:44.400
> 
> 标签：c#, trim

我想创建一个简单的程序，我有一个字符串数组，对于每个字符串我想检查它是否包含指定的字符，我想删除它。首先我用空格替换指定的字符，当我尝试修剪时它不起作用的空间这是我的代码

```
char[] arr = new char[] {' '};
for (int i = 0; i < words.Length; i++)
{
    words[i] = words[i].Replace('0', ' ');
    words[i] = words[i].Trim(arr);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:02:54.340

如果要删除所有空格，而不是`words[i] = words[i].Trim(arr);`，可以使用：

```
words[i] = words[i].Replace(" ", string.Empty); 
```

就个人而言，我也会为您的第一次删除 (0) 执行此操作：

```
words[i] = words[i].Replace("0", string.Empty); // Remove all "0" characters
words[i] = words[i].Replace(" ", string.Empty); // Remove all spaces 
```

甚至：

```
words[i] = words[i].Replace("0", string.Empty).Replace(" ", string.Empty); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T01:01:43.637

`Trim()`只删除前导和尾随空格。它不会删除字符串中间的空格。不过，真的没有必要做所有这些工作。您可以`Replace()`通过调用[适当的重载](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)来进行一次调用：

```
for(int i = 0; i < words.Length; i++)
    words[i] = words[i].Replace("0", ""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-18T05:44:24.453

对于喜欢单线的人：

```
words = words.Select(i => i.Replace("0", "").Replace(" ", "")).ToArray(); 
```

# java - 我如何下载Java的包PDF

> ID：10729866
> 
> 赞同：-3
> 
> 时间：2012-05-24T00:59:59.207
> 
> 标签：java, pdf, package

```
public void createPDF( String path ) {  
    // Met deze functie  wordt er een PDF aangemaakt van de huidige factuur  

    try {  
        Document document = new Document();  
        PdfWriter.getInstance(document, new FileOutputStream(path + ".pdf"));  
        document.open();  
        document.add(new Paragraph("Factuurid = " + Integer.toString(this.id)));  
        document.close();  
    } catch (Exception e) {  
        System.out.println(e);  
    }  
}///this shows errors 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:09:38.953

[您可以在此处](http://sourceforge.net/projects/itext/files/)下载 iText，一个 PDF 创建库。您需要解压缩文件，里面会有各种 JAR。

您需要在项目设置中将 itextpdf-5.2.1.jar 引用为外部 JAR。当然，版本号可能会有所不同。

在 Eclipse Indigo 中，您可以通过 Project>Properties>Java Build Path>Libraries>Add external JARs 执行此操作。

有关 iText 在其 [网站](http://itextpdf.com/itext.php)上的更多信息。

# asp.net-mvc-3 - 不显眼的验证和 mvc3 中提供的默认验证有什么区别

> ID：10729871
> 
> 赞同：1
> 
> 时间：2012-05-24T01:01:00.177
> 
> 标签：asp.net-mvc-3, forms, validation

我一直在阅读很多关于不显眼的验证的帖子。我试图了解 Visual Studio 在空 MVC3 模板中提供的内容与包含 jquery.unobtrusive js 文件之间的区别（如果有的话）。目前，这就是我在源代码中的输入的样子

```
 <input class="input-validation-error" data-val="true" data-val-required="The Surname field is required." id="Surname" name="Surname" type="text" value="" /> 
```

这是不显眼的验证吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:06:04.177

使用`data-`HTML 语法中的属性，看起来您的页面已启用不显眼的客户端验证。

使用传统的客户端验证，要验证的控件的 javascript 在服务器端生成，并与响应中的 HTML 一起传递给浏览器。因此，除了 HTML 内容之外，还将嵌入内嵌脚本数据`<![CDATA[ ]]>`

然而，通过不显眼的客户端验证而不是发出内联 javascript，它利用 HTML5 兼容的[数据属性](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-attributes) ASP.NET MVC 3 使用 jQuery 进行不显眼的客户端验证。`data-`属性将由定义在其中的 jQuery 函数进行操作`jquery.unobtrusive js`

默认情况下，在 ASP.NET MVC 3 中不显眼的模式是关闭的。要使用此功能，您需要同时启用客户端验证和不显眼的 javascript 验证。

这可以在 web.config 中设置

```
<configuration>    
  <appSettings>        
    <add key="ClientValidationEnabled" value="true"/>        
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>    
  </appSettings>
</configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:30:21.083

简短的回答是的，看起来您使用了不显眼的验证。要更深入地了解它是什么以及它是如何工作的，请阅读[http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:30:52.067

MVC 输出 data-* 属性，如果查找这些属性，jquery 会提供实际的客户端实现。

[http://completedevelopment.blogspot.com/2011/02/unobstrusive-javascript-in-mvc-3-helps.html](http://completedevelopment.blogspot.com/2011/02/unobstrusive-javascript-in-mvc-3-helps.html)

# facebook - 我怎样才能将电子邮件发送到某人的@facebook.com 地址而不将其登陆“其他消息”文件夹？

> ID：10729873
> 
> 赞同：3
> 
> 时间：2012-05-24T01:01:16.460
> 
> 标签：facebook, email, message, spam

Facebook 将许多消息过滤到“其他消息”文件夹 (http://betabeat.com/2011/12/return-of-laptop-lost-in-taxi-foiled-by-facebooks-obscure-message-folder/)。

有谁知道他们如何将收到的邮件过滤到@facebook.com 电子邮件地址？非朋友可以在@facebook 向用户发送电子邮件吗？应用程序可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:37:23.310

如果用户回复“**其他邮件**”文件夹中的电子邮件，则该电子邮件地址会被列入白名单，随后的电子邮件将最终出现在“**邮件**”文件夹中。

我在某处读到，您只需将消息从“**其他消息**”移动到“**消息**”即可将该消息的发件人列入白名单，但这似乎不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-02T22:41:14.130

根据[这个](https://www.facebook.com/help/398578543552207?sid=01BpJuTM4YqxuPDKJ) facebook 帮助中心帖子：

您将在收件箱中看到大部分来自朋友和您可能认识的人（例如：朋友的朋友）的消息。通常，来自其他人的消息会转到您的“其他”文件夹，而您不会收到有关他们的通知。

有时，您的收件箱中可能会收到来自您未联系的人的消息。这些邮件何时进入您的收件箱的一些示例包括：

*   朋友的朋友在消息中包含您以及您的一些共同朋友
*   您在消息中的群组的成员您或在消息中包含您
*   不在 Facebook 上的朋友使用您的联系信息从 Facebook Messenger 应用程序向您发送消息。

此外，您未在 Facebook 上联系的人可能会付费以确保他们的消息被路由到您的收件箱而不是您的其他文件夹。

# .net - Firebase .NET 访问

> ID：10729878
> 
> 赞同：20
> 
> 时间：2012-05-24T01:02:07.180
> 
> 标签：.net, firebase

如果我现在想在 C# 中从 .NET 使用 Firebase，作为处理回调的最佳方式，您的建议是什么？我看到您当前的客户端库正在使用 WebSockets。你能提供一个如何在 C# 中最好地设置它的小例子吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T01:13:08.447

[现在唯一的选择是通过REST api](http://www.firebase.com/docs/rest-api.html)与 Firebase 交互。这不会为您提供实时数据更新，但您可以读取和写入 Firebase。例如，非常适合 ASP.Net 后端使用 REST API 向使用 JavaScript 客户端的客户端广播数据。

至于与 JavaScript 客户端等效的完整 C# 客户端（能够同步数据和接收实时更新），不幸的是，目前这不可行。WebSocket 中使用的有线协议没有记录或稳定，客户端代码的内容实际上非常粗糙。我们希望在未来发布一个规范，这样人们就可以编写更多的客户端，但是现在它的变化太频繁了。对不起！

# php - 通过查询加入/分组返回奇怪的结果

> ID：10729880
> 
> 赞同：0
> 
> 时间：2012-05-24T01:02:29.363
> 
> 标签：php, mysql

我有一个用户表

```
 id , username
 22 , max
 33 , jack
 44 , joe 
```

和朋友桌

```
id , u1 , u2 , status , reciver 
```

为了提高阅读朋友的速度，我决定为每个友谊在表格中添加两行，所以它是这样的

```
id , u1 , u2 , status , reciver

 1 , 22 , 33 ,  1     ,  22
 2 , 33 , 22 ,  1     ,  22

 3 , 22 , 44 ,  1     ,  22
 4 , 44 , 22 ,  1     ,  22

 5 , 22 , 55 ,  1     ,  22
 6 , 55 , 22 ,  1     ,  22 
```

现在我想获取每个用户的朋友，并计算这两个用户之间的共同朋友，比如 facebook

这是我的朋友列表查询：

```
 $profile_id = $current_user->id;

         $res = $db->query("
            select 
            u.id as firend_id, 
            u.username  as firend_name,
            f.status    as firendship_status,
            COUNT(f3.u2)  as mutual  

            from friends f      
              JOIN users  u on f.u2 = u.id
              LEFT JOIN friends f2 on f.u2 = f2.u1 and f2.u2 != $profile_id
              LEFT JOIN friends f3 on f3.u1 = $profile_id AND f3.u2=f2.u2     
            WHERE  f.u1 = $profile_id
            group by f2.1
           ");

        echo 'friends list : '
        foreach ($res->result() as $r ){

          echo $r->firend_name;
          echo $r->mutual.' friends';

        } 
```

所以我对照friends.u1检查个人资料ID（$profile_id）的所有者并将friends.u2（建立的朋友）加入用户表以获取他的用户名和ID

问题在于计算共同的朋友

我在每个已建立的朋友中加入了自己的朋友表

在纸上看起来没问题，但它返回了一些奇怪的结果

就像用户有 3 个朋友并且没有共同的朋友一样，它只返回 3 个朋友中的一个！

如果有共同的朋友，它会显示所有的朋友，但在大多数情况下，共同的朋友号码是错误的

group by 语句有问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:57:00.590

您不能仅使用 2 个朋友表来执行此操作，您需要第三个：

*   Friends1：选择用户 $profile_id 的朋友（如你所见）
*   Friends2：选择$profile_id的好友的好友（如你所愿）
*   Friends3：计算$profile_id好友的好友与$profile_id好友的共同好友

我没有测试以下内容，它适用于我的样本数据 - 只需仔细检查更大的样本：

```
 select  
        u.id as firend_id,  
        u.username  as firend_name, 
        f.status    as firendship_status, 
        COUNT(f3.u2)  as mutual 

        from friends f       
          JOIN users  u on f.u2 = u.id 
          LEFT JOIN friends f2 on f.u2 = f2.u1 and f2.u2 != $profile_id 
          LEFT JOIN friends f3 on f3.u1 = $profile_id AND f3.u2=f2.u2

        WHERE  f.u1 = $profile_id 
        group by f.u2 
```

# asp.net - 每个用户的 ASP.NET HttpContext 独占值

> ID：10729883
> 
> 赞同：0
> 
> 时间：2012-05-24T01:02:42.797
> 
> 标签：asp.net, asp.net-mvc, httpcontext

我正在使用 ASP.NET MVC 3 创建一个项目。所以现在我需要将一些需要可用的数据传递到整个项目中。

我正在使用 IHttpModule 并在 HttpContext 项中设置值。我的疑问是，我添加到 HttpContext 项目中的值将是每个用户会话的独占值还是相同？

```
public class BaseHttpModule : IHttpModule
{
    context.BeginRequest += context_BeginRequest;

    private void context_BeginRequest(object sender, EventArgs e)
    {
        var application = (HttpApplication)sender;
        var context = application.Context;
        context.Items[Key] = "value1";          
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:53:50.613

这些项目只保留一个请求，因此只要单个用户发出该请求，它们就被限定为特定用户并且独占。

您可能想尝试这样的事情

```
var application = (HttpApplication)sender; 
application.Application["domain"] = "blah"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:31:21.113

这些项目仅在该*单页请求*中保留。服务于`Context`单个请求。

# javascript - Typekit 可以在 Spotify 应用程序中使用吗？

> ID：10729884
> 
> 赞同：1
> 
> 时间：2012-05-24T01:02:50.253
> 
> 标签：javascript, spotify, typekit

Spotify 的集成指南（随便）提到 Typekit 可用于引入网络字体，但其自动生成的文档没有提及需要进行哪些配置。Typekit，开箱即用，拒绝通常的嫌疑人（本地主机，127.0.0.1）等等。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:02:24.277

`sp://your-app-identifier`我相信您的应用程序的来源。此外，请确保您在`RequiredPermissions`清单部分中有用于加载其 JS 等的 TypeKit 域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T22:16:19.860

有人在看这个吗？几个月都没有消息。不仅 TypeKit 失败了，CSS3 font-face 失败了，Google Web Fonts 也失败了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T21:06:47.657

到目前为止，在 Spotify 应用程序中使用自定义字体的唯一方法是使用 SVG。这是我能够使它工作的唯一方法。您应该注意一些权衡，例如不可选择的文本，所以我不确定这种方法有多大好处。

如果你真的，真的在网上挖掘，你可以找到一个关于 Spotify 开发人员删除字体渲染功能并标记未来版本以进行重新集成的单一参考，但那个版本已经消失了。我会说可以安全地假设这不在他们的雷达范围内。*尽管他们的开发人员文档还有很多*不足之处，但我将避免推测他们的雷达上什么是什么，什么不在他们的雷达上。

# ruby-on-rails - Rails：如果调用两次，保存不会更新记录？

> ID：10729885
> 
> 赞同：2
> 
> 时间：2012-05-24T01:02:54.003
> 
> 标签：ruby-on-rails, activerecord

我使用 rails 控制台创建了一个模型记录，然后使用新变量检索并更新一些字段：

```
var = MyModel.new
var.name = "my name"
var.save

var2 = MyModel.last
var2.name = "your name"
var2.save 
```

现在回到旧变量`var.save`只是返回`true`并且不会将`name`字段覆盖为其值：`"my name"`

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:00:27.717

默认情况下， Rails 模型是[“脏”](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html)的，这意味着属性设置功能，`attribute=()`将属性标记为已更改，并告诉 Rails 在下次保存时更新此属性。此信息存储在模型中，而不是数据库中。在 上`var.save`，Rails 只更新它知道已更改的属性。如果 Rails 认为没有任何变化，它不会检查数据库是否存在差异（这在生产环境中会非常慢）。

您可以使用`var.reload`将属性从数据库重新加载到相应的对象中。

编辑：为了澄清上面的评论，你应该`MyModel.last`不在`MyModel.first`你的测试代码中使用。如果您的数据库中有不止一行，`MyModel.first`则不会引用最近保存的对象，因此`var2`会`var`引用完全不同的对象。

# arrays - cakephp 用于创建复选框的字符串字段

> ID：10729889
> 
> 赞同：0
> 
> 时间：2012-05-24T01:03:17.677
> 
> 标签：arrays, cakephp, checkbox

我正在使用 cakephp 2.1，让我告诉你：我就是喜欢它。
在我的表单中，我有一个可以有多个答案的字段（复选框）。
我不想为每个选项创建一个数据库字段，也不想使用 HABTM。

更新：

因为我需要几组标志，所以我采用了 $hasAndBelongsToMany 的方式。（也可以在不修复代码但编辑表格的情况下添加新标志（例如，通过 phpmyadmin）。

1.-为我需要的每组标志制作一个表格/模型：

2.- 在我的主要模型中，声明了与每个模型的关系：

```
var $hasAndBelongsToMany = array('Sample','Format','Report','Openend','Dataproce','Prefield'); 
```

3.- 在我的主控制器中，为每个表填充一个数组以使用：

```
$openends = $this->Project->Openend->find('list', array(
                    //'order' => 'name'
            )); 
```

4.-并在视图中使用数组：

```
echo $this->Form->input('Dataproce', array('label' => false, 'type' => 'select', 'multiple' => 'checkbox', 'size' => 2)); 
```

=== 老问题从这里开始；正确答案仅适用于一组标志 ===

我想保存一个字符串并用它来神奇地创建一组属于单个数据字段的复选框。

我已经在中间了。

我的观点：

```
echo $this->Form->input('pr_reports', array('type' => 'select',
                             'multiple' => 'checkbox',
                             'options' => array('0' => 'Interrnal',
                                                '1' => 'Disposition',
                                                '2' => 'Web Disposition',
                                                '3' => 'Marginal',
                                                '4' => 'Custom'))) 
```

我的控制器添加方法，在保存之前

```
 // Used serialize() to convert the array to string
        $dataString = serialize($this->request->data['Project']['pr_reports']);
        $this->request->data['Project']['pr_reports'] = $dataString; 
```

字符串正在被保存（编码它似乎但没问题：a：5：{i：0;s）

我的问题是在编辑记录以使复选框相应地检查自己时，我将如何进行？也就是说，我在哪里 unserialize() 字符串字段并在编辑视图上处理它？

有没有更好的方法呢？

非常感谢您的帮助。

卡洛斯·加西亚

==== 解决后，有多个字段的不同标志
数据的麻烦只保存一个字段，忽略另一个====

你好;
对于表格上的一个字段，它可以正常工作，如前所述；
我很难使用另一个字段（单独的一组标志）。
似乎只附加了一种行为；我想知道我是否应该以不同的方式附加它们。

我的领域：

```
pr_data_format` tinyint(3) unsigned NOT NULL,
pr_report_format` tinyint(3) unsigned NOT NULL, 
```

我的控制器

```
$this->Project->Behaviors->attach('Bitmasked', array('mappedField'=>'pr_data_formats', 'bits'=>'Project::pr_data_formats'));
$this->Project->Behaviors->attach('Bitmasked', array('mappedField'=>'pr_report_formats', 'bits'=>'Project::pr_report_formats')); 
```

我的模型

```
 const STATUS_ASCII = 1;
        const STATUS_SPSS = 2;
        const STATUS_EXCEL = 4;
        const STATUS_CUSTOM = 8;

        public static function pr_data_formats($value = null) {
            $options = array(
                self::STATUS_ASCII => __('ASCIId'),
                self::STATUS_SPSS => __('SPSSBd'),
                self::STATUS_EXCEL => __('Exceld'),
                self::STATUS_CUSTOM => __('Customd'),
            );
            return parent::enum($value, $options);
        }                    

        const REP_ASCII = 1;
        const REP_SPSS = 2;
        const REP_EXCEL = 4;
        const REP_CUSTOM = 8;

        public static function pr_report_formats($value = null) {
            $options = array(
                self::REP_ASCII => __('ASCIIr'),
                self::REP_SPSS => __('SPSSBr'),
                self::REP_EXCEL => __('Excelr'),
                self::REP_CUSTOM => __('Customr'),
            );
            return parent::enum($value, $options);
        } 
```

我的观点

```
echo $this->Form->input('pr_data_formats', array('options' => Project::pr_data_formats(), 'multiple' => 'checkbox'));
echo $this->Form->input('pr_report_formats', array('options' => Project::pr_report_formats(), 'multiple' => 'checkbox')); 
```

就是想不通，试了下：

```
$this->Project->Behaviors->attach('Bitmasked', array('mappedField'=>'pr_report_formats', 'bits'=>'Project::pr_report_formats'), array('mappedField'=>'pr_data_formats', 'bits'=>'Project::pr_data_formats')); 
```

但没有用，只更新了一个字段。

你能帮我吗？我们将使用大约 4 或 5 个标志集。

非常感谢。

卡洛斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:32:13.133

正确的方法是使用行为。这使您的模型保持干净，只需将其放入模型中即可应用于多个模型：

```
public $actsAs = array('MyBehavior'); 
```

现在，对于序列化，我使用我的 Jsonable 行为： http: [//www.dereuromark.de/2011/07/05/introducing-two-cakephp-behaviors/](http://www.dereuromark.de/2011/07/05/introducing-two-cakephp-behaviors/) 它基本上使您的输入数组在保存时成为可存储的字符串，并将字符串返回到读取数组。您可以轻松地根据自己的需要进行调整。

但是对于您想要对多个复选框执行的操作，甚至还有更好的方法 - 位掩码。我开发了一种所谓的 Bitmasked 行为 - 你需要使用 1,2,4,8,... 但除此之外它是相同的： http: [//www.dereuromark.de/2012/02/26/bitmasked -using-bitmasks-in-cakephp/](http://www.dereuromark.de/2012/02/26/bitmasked-using-bitmasks-in-cakephp/) 我完全用它来做同样的事情。

# perlin-noise - Perlin 噪声梯度函数

> ID：10729891
> 
> 赞同：9
> 
> 时间：2012-05-24T01:03:30.587
> 
> 标签：perlin-noise

我正在寻找使 3D Perlin 噪声算法适应较低维度的方法，但我在使用梯度函数时遇到了问题，因为我不完全理解其中的原因。

原始的 Perlin 梯度函数有四个参数：a`hash`和三维坐标`(x, y, z)`。根据 的值返回函数的结果，`hash mod 16`如下所示。

*   `0`：`x + y`
*   `1`：`-x + y`
*   `2`：`x - y`
*   `3`：`-x - y`
*   `4`：`x + z`
*   `5`：`-x + z`
*   `6`：`x - z`
*   `7`：`-x - z`
*   `8`：`y + z`
*   `9`：`-y + z`
*   `10`：`y - z`
*   `11`：`-y - z`
*   `12`：`y + x`
*   `13`：`-y + z`
*   `14`：`y - x`
*   `15`：`-y - z`

`0`from的返回值`11`构成一种模式，因为每个组合都表示一次。然而，最后四个是重复的。为什么选择它们来拟合最后四个返回值？`(x, y)`二维和一`(x)`维的类似案例是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-27T18:59:01.243

...迟到的答案总比没有好？;-)

“改进的噪声”实现中的`grad`函数计算向量 x、y、z 和伪随机梯度向量之间的点积。

在这个实现中，梯度向量是从 12 个选项中选择的。他们放弃了选择的统一性并将数字 12 添加到 15，因为这样做`hash & 15`比`hash % 12`

对于 2D perlin 噪声，我只使用了 4 个梯度向量，没有任何明显的问题，例如：

```
return ((hash & 1) ? x : -x) + ((hash & 2) ? y : -y); 
```

# objective-c - 通过 Elevated Helper 和 SMJobBless 获得 Root 访问权限

> ID：10729893
> 
> 赞同：8
> 
> 时间：2012-05-24T01:03:42.827
> 
> 标签：objective-c, macos, authentication, nsfilemanager, servicemanager

我正在研究需要定期将文件安装到 /Library 中的文件夹中的东西。

我知道过去我可以使用其中一种 Authenticate 方法，但这些方法在 10.7 中已被弃用。

到目前为止，我从阅读中了解到：

我应该创建一个以某种方式获得身份验证的助手，并让该助手完成所有移动任务。我查看了一些示例代码，包括一些涉及 XPC 和一个名为 Elevator 的代码，但我有点困惑。

其中很多似乎都涉及设置某种客户端/服务器模型，但我不确定这将如何转化为我将文件实际安装到正确的目录中。大多数示例只是传递字符串。

我的问题很简单：如何以编程方式在 /Library 中创建我的文件夹并定期向其中写入文件，同时只提示用户一次输入密码，而不再提示用户输入密码？我真的不确定如何处理这个问题，而且似乎没有太多文档。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T18:41:13.197

你是对的，没有太多的文档。您将基本上编写另一个应用程序，帮助程序应用程序，它将与 SMJobBless() 一起安装。毫不奇怪，这里棘手的部分是代码签名。对我来说最不明显的部分是每个应用程序的 info plist 文件中的**SMAuthorizedClients**和**SMPrivilegedExecutables**条目取决于您用来签署应用程序的身份/证书。编译器/链接器还有一个技巧可以将 info plist 文件编译到帮助工具中，这将是一个可执行文件，而不是一个包。

一旦你启动并运行了帮助应用程序，那么你必须设计一种与之通信的方式，因为这是两个不同的进程。XPC 是一种选择，也许是最简单的选择。XPC 通常与服务器进程一起使用，但您在这里使用的只是 XPC 的通信端。基本上它在两个应用程序之间来回传递字典。为字典创建标准格式。我使用了 @"action"、@"source" 和 @"destination" 以及 3 个不同的操作值，@"filemove"、@"filecopy" 和 @"makedirectory"。这些是我的助手应用程序可以做的 3 件事，如果需要，我可以轻松添加更多内容。

助手应用程序将基本上设置 XPC 连接和事件处理程序并等待连接和命令。这些命令将只是一个字典，因此您可以检查适当的键/值并执行任何操作。

如果您需要更多帮助，我可以提供更多详细信息和代码，但这个问题已有 9 个月的历史，所以我不想浪费时间向您提供您已经弄清楚的详细信息。

# python - 字典中的反转元素

> ID：10729894
> 
> 赞同：1
> 
> 时间：2012-05-24T01:03:52.187
> 
> 标签：python, dictionary, tuples

> **可能重复：**
> [Python 反向/反向映射](https://stackoverflow.com/questions/483666/python-reverse-inverse-a-mapping)

说我有以下。

```
D = {'a':1,'b':2,'c':3} 
```

我将如何反转每个元素，所以我得到

```
inverseD = {1:'a',2:'b',3'c'} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T01:05:46.657

使用 dict 理解（Python`2.7+`和`3.0+`）：

```
D = {'a':1,'b':2,'c':3}
inverse = {v: k for k, v in D.items()}
print(inverse)
# {1: 'a', 2: 'b', 3: 'c'} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T01:07:54.057

对于 Python 2.6 及更早版本（无字典理解）：

```
d = {'a':1,'b':2,'c':3}
inverse_dict = dict((v,k) for k,v in d.items()) 
```

这假设 dict 的值是`d`可散列的，例如，它不适用于此字典：

```
>>> d={'l':[],'d':{},'t':()}
>>> inverse_dict = dict((v,k) for k,v in d.items())
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list' 
```

*如果原始 dict 的值*不是唯一的，您也会遇到问题，例如

```
>>> d={'a': 1, 'c': 3, 'b': 2, 'd': 1}
>>> dict((v,k) for k,v in d.items())
{1: 'd', 2: 'b', 3: 'c'} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T01:12:22.913

如果你有 Python2.7+，你可以使用 mata 的答案，否则使用 mhawke 的答案。

仅当源 dict 的所有值都是唯一且可散列的时，像这样反转 dict 才能正常工作

如果这些值是可散列的，但不是唯一的，您可以使用具有值列表的字典来代替

# r - 从 R 中具有多个文件夹的压缩临时文件中读取 csv 文件

> ID：10729895
> 
> 赞同：1
> 
> 时间：2012-05-24T01:04:09.363
> 
> 标签：r, csv, unzip

我正在尝试读取包含在我从网络上提取的文件中的 csv 文件。问题是压缩文件有多个级联文件夹。我必须为几个不同的单位这样做，所以我正在执行一个循环。循环没有问题，文件名正确，我可以下载文件。但是我收到一条错误消息（我认为是因为 R 无法找到我要求它找到的确切文件）。错误是：

```
Error in open.connection(file, "rt") : cannot open the connection
In addition: Warning message:
In open.connection(file, "rt") :
  cannot locate file 'XXXX.csv' in zip file 'c:\yyy\temp\bla\'

download.file(paste("http://web.com_",units[i],"_",places[j],".zip",
                     sep=""),
                     temp,
                     cacheOK = F )
data <- read.csv2(unz(temp,
                   paste("name_",units[i],"_",places[j],".csv",
                   sep="")),
                   header=F,
                   skip=1)
unlink(temp)
fili<-rbind(X,
            data)

} 
```

如何让 R 找到我想要的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:34:53.203

你有正确的方法，但是（正如警告告诉你的）错误的文件名。

在开始尝试读取其内容之前，值得仔细检查 zip 文件是否存在。

```
if(file.exists(temp))
{
  read.csv2(unz(...))
} else
{
  stop("ZIP file has not been downloaded to the place you expected.")
} 
```

浏览下载的文件（您可能希望先将其解压缩）以确保您在正确的位置查找 CSV 内容也是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T08:11:38.433

看起来您要阅读的文件位于目录中。在这种情况下，您的读数应更改如下：

```
data <- read.csv2(unz(temp,
                   paste("**dirname**/name_",units[i],"_",places[j],".csv",
                   sep="")),
                   header=F,
                   skip=1) 
```

# javascript - Javascript：在替换中替换

> ID：10729896
> 
> 赞同：1
> 
> 时间：2012-05-24T01:04:10.960
> 
> 标签：javascript, regex, replace

我的输入是多行文本，如下所示：

```
a.b.c.d.e (f:g) 
```

我需要把它变成

```
a.b.c.d.e (a/b/c/d/e/f?g) 
```

请注意，虚线部分 ( `a.b.c.d.e`) 可以有不同数量的元素，所以有时它会是`q.r.s.t`，有时`u.v.w.x.y.z`等等。我有一个`replace()`会给我的`(a.b.c.d.e.f?g)`，但我需要的是把所有这些`.`s 变成`/`结果中的 s 。

有没有办法在替换中进行替换？还是我应该在字符串上调用 replace() 两次？

抱歉，如果这个问题措辞不当，我对 javascript 中的正则表达式并不十分精通。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:16:30.777

一种非常疯狂的做法：

```
var str = "a.b.c.d.e (f:g)";
var re = /([^\s]+)\s\(([^:]+):([^\)]+)\)/;
var newStr = str.replace(re, function(a,b,c,d){ return b + " (" + b.replace(/\./g,"/") + "/" + c + "?" + d + ")"; }); 
```

[jsfiddle](http://jsfiddle.net/6wZJa/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T01:15:22.257

您需要将呼叫`replace()`一个接一个地链接起来。

```
var result = source.replace("foo", "bar").replace("oof", "rab"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T01:21:40.257

一种更理智的方式:) [http://jsfiddle.net/smfPU/](http://jsfiddle.net/smfPU/)

```
input = "a.b.c.d.e.w.x.y.z (f:g:h)";
output = input.replace(/:/g, "?");
outputparts = output.split("(");
left = outputparts[0];
middle = left.replace(/\./g, "/").trim();
right = outputparts[1];
output = left + "(" + middle + "/" + right;
document.write(output); 
```

# css - 使用CSS根据容器宽度和图像的原始宽度设置图像宽度？

> ID：10729898
> 
> 赞同：1
> 
> 时间：2012-05-24T01:04:15.103
> 
> 标签：css

有没有办法使用 CSS 获得以下效果？

*   当容器的宽度小于图像的原始宽度时，将图像的宽度设置为容器宽度的 100%。
*   当容器的宽度大于图像的原始宽度时，将图像的宽度设置为其原始宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:16:52.640

也许你可以这样做：

例如：

```
img{
    width:100%;
    height:auto;
    max-width:400px;
} 
```

检查这个[http://jsfiddle.net/aqh2r/](http://jsfiddle.net/aqh2r/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T00:27:36.583

我发现下面的 CSS 代码可以达到目的。但是根据 CSS 标准，当 max-width 的值为百分比时，它是*“相对于生成框的包含块的宽度计算的”*。根据我的理解，将 max-width 设置为 100% 应该没有效果，但似乎是错误的。

```
img{
    width: auto;
    max-width: 100%;
} 
```

该代码在 Firefox 12 和 IE 9 中进行了测试。请参阅[http://jsfiddle.net/EnZEP/](http://jsfiddle.net/EnZEP/)

# netbeans - 将文件拖入 NetBeans 以打开

> ID：10729901
> 
> 赞同：0
> 
> 时间：2012-05-24T01:04:36.803
> 
> 标签：netbeans, drag-and-drop

我将我的 Netbeans 从版本 7.0 更新到了 7.1.2。我注意到的第一件事是我不能再将文件从资源管理器窗口拖到 netbeans 中来打开它。有谁知道为什么我不能再这样做了？或者，如果您知道一个设置或一些东西可以让它像在以前的版本中那样工作，那就太好了。我已经在互联网上搜索了解决方案，但无法找到并回答。

**编辑**

我已经更新了我的 NetBeans 版本，它已经工作了几个星期，但是我不再能够通过将文件拖到 IDE 上来打开它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:25:21.840

讨厌这样说，但在我的 Windows 7 盒子上“它只是工作”。尝试将您的 netbeans 升级到较新的安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:16:10.387

我找到了解决我的问题的方法。看起来如果 NetBeans 以管理员身份运行，那么您将不再能够拖放文件以在 IDE 中打开它们。关闭它为我解决了这个问题。

要在 Windows 7 中执行此操作：右键单击 Netbeans 图标 > 属性 > 兼容性选项卡 > 更改所有用户的设置 > 取消单击“以管理员身份运行此程序”

# ruby-on-rails - 涉及某些参数破坏我的应用程序的奇怪控制器行为

> ID：10729902
> 
> 赞同：0
> 
> 时间：2012-05-24T01:04:50.170
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在我的应用程序中构建了一个功能，允许用户搜索将搜索图像描述、上传图像的成员和图像标签的图像，但我有一个奇怪的问题，如果我搜索名称“jason”，它会中断，但是像“杰西”这样的名字很好用。

这是我的控制器

```
 def search_results
    @tattoos = Tattoo.where("description LIKE ?", "%#{params[:search]}%") | Tattoo.tagged_with("#{params[:search]}", :any => true ) | Member.where("membername LIKE ?", "%#{params[:search]}%").order("created_at DESC").page(params[:page]).per(10)
  end 
```

如果我搜索“杰森”，我的应用程序会中断，给我一个“未定义的方法”错误，如果我搜索“杰西”，控制台会显示一堆未显示的内容。我不完全确定如何表达，但这就是我的意思。

搜索 - 杰森

```
 Started GET "/search_results?utf8=%E2%9C%93&search=jason&commit=search" for 127.0.0.1 at 2012-05-23 20:48:26 -0400
  Processing by IndexController#search_results as HTML
  Parameters: {"utf8"=>"✓", "search"=>"jason", "commit"=>"search"}
  SQL (0.7ms)  SHOW TABLES
  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT `tags`.* FROM `tags` WHERE (name LIKE 'jason')
  Tattoo Load (0.2ms)  SELECT `tattoos`.* FROM `tattoos` WHERE (description LIKE '%jason%')
  Tattoo Load (0.2ms)  SELECT `tattoos`.* FROM `tattoos` WHERE (1 = 0)
  SQL (0.7ms)  SHOW TABLES
  SQL (0.5ms)  SHOW TABLES
  Member Load (0.3ms)  SELECT `members`.* FROM `members` WHERE (membername LIKE '%jason%') ORDER BY fullname asc, created_at DESC LIMIT 10 OFFSET 0
  Member Load (0.3ms)  SELECT `members`.* FROM `members` WHERE `members`.`id` = 7 ORDER BY fullname asc LIMIT 1
  ActsAsTaggableOn::Tag Load (0.3ms)  SELECT `tags`.* FROM `tags` INNER JOIN `taggings` ON `tags`.id = `taggings`.tag_id WHERE ((`taggings`.taggable_id = 43) AND (`taggings`.taggable_type = 'Tattoo')) AND (taggings.context = 'styles' AND taggings.tagger_id IS NULL)
Rendered shared/_image_roll.html.erb (27.5ms)
Rendered index/search_results.html.erb within layouts/application (29.3ms)
Completed 500 Internal Server Error in 523ms
  Processing by ErrorsController#internal_server_error as HTML
  Parameters: {"utf8"=>"✓", "search"=>"jason", "commit"=>"search"}
  SQL (0.7ms)  SHOW TABLES
  SQL (0.5ms)  SHOW TABLES
Rendered shared/_register.html.erb (483.4ms)
  Member Load (0.2ms)  SELECT `members`.* FROM `members` WHERE `members`.`id` = 7 ORDER BY fullname asc LIMIT 1
  MemberRole Load (0.2ms)  SELECT `member_roles`.* FROM `member_roles` WHERE (`member_roles`.member_id = 7) LIMIT 1
  SQL (0.6ms)  SHOW TABLES
  SQL (0.4ms)  SELECT COUNT(*) FROM `tattoos` WHERE `tattoos`.`status` = 'pending'
  SQL (0.2ms)  SELECT COUNT(*) FROM `feedbacks` WHERE `feedbacks`.`approved` = 0
  SQL (0.1ms)  SELECT COUNT(*) FROM `tattoos` WHERE `tattoos`.`status` = 'reported'
Rendered shared/_navbar.html.erb (87.6ms)
Rendered shared/_login_form.html.erb (2.9ms)
Rendered errors/internal_server_error.html.erb within layouts/application (582.4ms)
Completed 500 Internal Server Error in 587ms (Views: 583.9ms | ActiveRecord: 3.5ms)

ActionView::Template::Error (undefined method `member' for #<Member:0x007f0b0ca077b0>):
    1:   <ol class="image_roll">
    2:     <% @tattoos.each do |t| %>
    3:  <li>
    4:         <% unless t.member.nil? %>
    5: 
    6:           <%= link_to image_tag(t.file.url(:small),:alt=>"#{strip_tags(t.description)}, #{t.style_list}, tattoos"), member_tattoo_path(t.member, t)%>
    7:         <% else %>
  app/views/shared/_image_roll.html.erb:4:in `block in _app_views_shared__image_roll_html_erb__3185787815883689760_69842755443480_3152220748446100192'
  app/views/shared/_image_roll.html.erb:2:in `each'
  app/views/shared/_image_roll.html.erb:2:in `_app_views_shared__image_roll_html_erb__3185787815883689760_69842755443480_3152220748446100192'
  app/views/index/search_results.html.erb:10:in `_app_views_index_search_results_html_erb___3497910042066847338_69842586729040__4333294961394575926' 
```

搜索 - 杰西：

```
Started GET "/search_results?utf8=%E2%9C%93&search=jesse&commit=search" for 127.0.0.1 at 2012-05-23 20:48:36 -0400
  Processing by IndexController#search_results as HTML
  Parameters: {"utf8"=>"✓", "search"=>"jesse", "commit"=>"search"}
  ActsAsTaggableOn::Tag Load (0.6ms)  SELECT `tags`.* FROM `tags` WHERE (name LIKE 'jesse')
  Tattoo Load (0.7ms)  SELECT `tattoos`.* FROM `tattoos` WHERE (description LIKE '%jesse%')
  Tattoo Load (0.1ms)  SELECT `tattoos`.* FROM `tattoos` WHERE (1 = 0)
  Member Load (0.5ms)  SELECT `members`.* FROM `members` WHERE (membername LIKE '%jesse%') ORDER BY fullname asc, created_at DESC LIMIT 10 OFFSET 0
Rendered shared/_search.html.erb (0.8ms)
  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT tags.*, taggings.tags_count AS count FROM `tags` JOIN (SELECT taggings.tag_id, COUNT(taggings.tag_id) AS tags_count FROM `taggings` INNER JOIN tattoos ON tattoos.id = taggings.taggable_id WHERE (taggings.taggable_type = 'Tattoo' AND taggings.context = 'styles') AND (taggings.taggable_id IN(SELECT tattoos.id FROM `tattoos`)) GROUP BY taggings.tag_id HAVING COUNT(taggings.tag_id) > 0) AS taggings ON taggings.tag_id = tags.id ORDER BY count DESC LIMIT 40
Rendered index/_tags_list.html.erb (19.7ms)
Rendered layouts/shared/_right_column_std.html.erb (22.3ms)
Rendered shared/_register.html.erb (5.7ms)
  Member Load (0.3ms)  SELECT `members`.* FROM `members` WHERE `members`.`id` = 7 ORDER BY fullname asc LIMIT 1
  MemberRole Load (0.1ms)  SELECT `member_roles`.* FROM `member_roles` WHERE (`member_roles`.member_id = 7) LIMIT 1
  SQL (0.2ms)  SELECT COUNT(*) FROM `tattoos` WHERE `tattoos`.`status` = 'pending'
  SQL (0.1ms)  SELECT COUNT(*) FROM `feedbacks` WHERE `feedbacks`.`approved` = 0
  SQL (0.1ms)  SELECT COUNT(*) FROM `tattoos` WHERE `tattoos`.`status` = 'reported'
Rendered shared/_navbar.html.erb (13.5ms)
Rendered shared/_login_form.html.erb (2.9ms)
Rendered index/search_results.html.erb within layouts/application (54.3ms)
Completed 200 OK in 64ms (Views: 57.9ms | ActiveRecord: 3.0ms) 
```

和观点：

```
<% @tattoos.each do |t| %>
    <% unless t.member.nil? %>

      <%= link_to image_tag(t.file.url(:small),:alt=>"#{strip_tags(t.description)}, #{t.style_list}, tattoos"), member_tattoo_path(t.member, t)%>
    <% else %>
      <%= link_to image_tag(t.file.url(:small),:alt=>"#{strip_tags(t.description)}, #{t.style_list}, tattoos"), tattoo_path(t) %>
    <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:05:31.880

“ `|`vs `||`”问题不是你的问题。这样做：

```
Tattoo.where(...) | Tattoo.tagged_with(...) | Member.where(...) 
```

将产生一个数组，该数组是三个输入结果的并集。切换到`||`：

```
Tattoo.where(...) || Tattoo.tagged_with(...) || Member.where(...) 
```

只会给你，`Tattoo.where(...)`因为那个查询永远不会是`false`or`nil`并且`||`一旦它有非错误的结果就会短路；`Tattoo.where(...)`可能是空的，但空和假是不同的东西。

您的问题是您在一个数组中混合了两种不同的东西：`Tattoo`前两个查询的`Member`实例和最后一个查询的实例。然后，您的 ERB 假定其中的所有内容`@tattoos`都是 a `Tattoo`（或其他响应 的内容`member`）：

```
<% @tattoos.each do |t| %>
  <% unless t.member.nil? %> 
```

如果您`Member.where(...)`发现任何东西，那么您将至少有一个`Member`实例，`@tattoos`并且没有`Member#member`方法，如错误消息所示：

```
ActionView::Template::Error (undefined method `member' for #<Member:0x007f0b0ca077b0>): 
```

停止混合两个不同的课程`@tattoos`，您的问题应该会消失。或者您可以将其重命名为，例如，`@matches`并智能您的视图逻辑，以便能够同时显示`Tattoo`和`Member`实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:41:56.900

我注意到的一件事是你正在使用`|`而不是`||`在

`@tattoos = Tattoo.where("description LIKE ?", "%#{params[:search]}%") | Tattoo.tagged_with("#{params[:search]}", :any => true ) | Member.where("membername LIKE ?", "%#{params[:search]}%").order("created_at DESC").page(params[:page]).per(10)`

也许这可能是问题的一部分？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:10:32.067

我还认为你应该将这个逻辑移到模型中，这样应该更容易测试。

```
# Controller
@search_results = Tattoo.results_for_search(params[:search])
@search_results << Member.results_for_search(params[:search])

# Tattoo Model
def results_for_search(search_term)
  results = where("description LIKE ?", search_term).all
  results << tagged_with(search_term, :any => true)
end

# Member Model
def results_for_search(search_term)
  where("membername LIKE ?", search_term).order("created_at DESC")
end

# Search Results View
<% @search_results.each do |result| %>
  <% if result.is_a?(Tattoo) %>
    ...
  <% elsif result.is_a?(Member) %>
    ...
  <% end %>
<% end %> 
```

# java - Derby DB - 文件大小泄漏

> ID：10729904
> 
> 赞同：2
> 
> 时间：2012-05-24T01:05:11.947
> 
> 标签：java, database, memory-leaks, derby

由于等待表上的事务完成，我们的一个远程部署的带有本地 derby 数据库的 Java 应用程序时不时地被锁定。每隔 24 小时，该应用程序会将这个 derby 数据库与我们庞大的预言机服务器同步，这意味着在交付其内容后，它会清除所有表，然后完全重新填充。

我打开引擎盖，发现其中一张表的 .dat 文件已将自身炸毁到 100Mb。我不确定到底需要多长时间才能达到这一点，因为当事物同步时，用户通常不在身边。直到似乎完全停止，才报告逐渐减速。我目前也不确定逻辑上如何，因为虽然自动提交已关闭，但代码似乎很紧凑。

经过一番谷歌搜索后，我*认为*可能发生的事情是旧事务以某种方式被遗忘，既没有提交也没有回滚 - 清除表并重新填充的未来同步基本上每次同步都会按照原始大小增长文件，因为它跟踪其整个历史回到那个老点。

有什么方法可以确认这一点和/或我是否完全走错了路？是否可以列出旧的或长期运行的交易？如果找到，我该如何清除它们并清除它们会回收磁盘空间？

# javascript - 在 jQuery 中使用输入框对动态表进行排序

> ID：10729905
> 
> 赞同：1
> 
> 时间：2012-05-24T01:05:12.290
> 
> 标签：javascript, jquery

我已经在 jsFiddle 中演示了我正在尝试做的事情：http: [//jsfiddle.net/clowerweb/SbNdb/](http://jsfiddle.net/clowerweb/SbNdb/)

只需单击表格标题进行排序（您可能需要多次单击！）

所以我这里有一个动态表，用于添加和删除可以拥有可变数量条目的参赛者（最终它也可以保存，并随机选择一个获胜者）。

我认为输入参赛者的用户可能还希望能够按字母顺序或条目数量对列表进行排序。我在 SO 上找到了一个不错的表格排序脚本，并将其添加到我的 jQuery 函数中。

**问题是**，它似乎没有读取输入值。它将双向反转表格的顺序并将其恢复为默认值，但实际上不会按输入值对它们进行**排序。**

**这可能是以下两个问题之一：**

1.  最有可能的是它根本没有读取输入值。
2.  它也无法实际看到动态添加的行（尽管它看起来像是在单击时循环遍历表，所以我不怀疑这是问题所在。）

*非常*感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:38:39.350

你得到的`comparator function`是`td`，所以要根据`input`你需要在里面搜索它们`td`并与 比较`text field's values`。所以比较器功能看起来像

```
function(a, b) {                
   return $(a).find('input').val() > $(b).find('input').val() ?
                 inverse ? -1 : 1
                : inverse ? 1 : -1;
} 
```

[工作小提琴](http://jsfiddle.net/joycse06/MwxXj/5/)

# c++ - 我在以下代码中遇到总线错误

> ID：10729906
> 
> 赞同：6
> 
> 时间：2012-05-24T01:05:15.547
> 
> 标签：c++, bus-error

我的代码中出现总线错误。使用此代码，我试图将数字转换为单词，但我知道我的逻辑存在缺陷。但在此之前，当我在[Mac](https://en.wikipedia.org/wiki/Macintosh)上使用 g++ 编译和运行这段代码时，我试图让这段代码按原样运行，但我遇到了总线错误。任何帮助，将不胜感激。

当我运行代码时，我得到以下输出。我有调试消息来跟踪错误发生的位置。

```
    输入号码：1234
    主要1：数字是：234
    功能1：编号为234
    二
    二百
    34Function2：数字是34
    功能3：数字为34
    总线错误：10

```

* * *

```
#include <iostream>
#include <string>

using namespace std;
char *convert_number(int);

char *tens[] = {"", "ten", "twenty", "thirty", "forty",
                "fifty", "sixty", "seventy", "eighty", "ninety"};

char *words[] = {"zero", "one", "two", "three", "four",
                 "five", "six", "seven", "eight", "nine",
                 "ten", "eleven", "twelve", "thirteen", "fourteen",
                 "fifteen", "sixteen", "seventeen", "eighteen", "ninteen"};

char *place[] = {"", "hundred", "thouands", "million", "billion", "trillion"};

int main(int argc, char **argv)
{
    int number, conv_num, places;
    places = 1;
    char *string = new char[1000];
    char *temp_string = new char[100];
    cout << "Enter a number:";
    cin >> number;
    string = " ";
    if (number >= 1000)
    {
        while(number >= 1)
        {
            conv_num = number % 1000;
            cout << "main 1:numbers are:" << conv_num << endl;
            temp_string = convert_number(conv_num);
            string =strcat(string, temp_string);
            string =strcat(string, " ");
            number = 0; // (number-conv_num)/1000;
            cout << "main 2:numbers are:" << endl;
            //cout << conv_num << ":" << number << endl;
        }
    }
    else
    {
        string = convert_number(number);
        string = strcat(string, " ");
    }
    cout<<"Main: The word is :"<<string<<endl;
}

char *convert_number(int number)
{
    int divisor;
    char *word;
    word = new char[100];
    divisor = 10;
    cout << "Function1: Number is " << number << endl;

    if (number >= 100)
    {
        word = strcat(word, words[number/100]);
        cout << word << endl;
        word = strcat(word, " hundred ");
        cout << word << endl;
        number = number%100;
        cout << number;
    }
    cout << "Function2: Number is " << number << endl;

    if (number >= 20)
    {
        word = strcat(word, tens[number/10]);
        word = strcat(word, " ");
        if (number%divisor >= 1)
        {
            word=strcat(word, words[number%divisor]);
            word =strcat(word, " ");
        }
    }
    cout << "Function3: Number is " << number << endl;

    if (number < 20)
    {
        word = strcat(word, words[number]);
        word = strcat(word, " ");
    }
    cout << "Returning word:" << word;
    return word;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:36:28.990

你得到总线错误的原因是因为你试图写入不可写区域（即写入字符常量，并且超过它的末尾）；这是未定义的行为。

```
// Good: allocate 100 bytes to string 
char *string = new char[100];

// Bad! Compiler warns you that assigning character const to char* is wrong.
// It does not tell you that you've just leaked the 100 bytes that you allocated
/// before, but that's also true.
string=" ";

// ... some more code, and then
string = strcat(string,temp_string); // <<== HERE is the problem! 
```

调用`strcat`尝试写入 的终止零`string`，然后继续写入字符串常量的末尾。这是未定义的行为，因此您的程序崩溃。

要解决此问题，您需要复制`" "`到`string`，而不是将其分配给`string`指针。

# python - 将内置函数类型转换为方法类型（在 Python 3 中）

> ID：10729909
> 
> 赞同：18
> 
> 时间：2012-05-24T01:05:57.060
> 
> 标签：python, python-3.x, cython

考虑一个简单的函数，如

```
def increment(self):
    self.count += 1 
```

它通过 Cython 运行并编译为扩展模块。假设现在我想让这个函数成为一个类的方法。例如：

```
class Counter:
    def __init__(self):
        self.count = 0

from compiled_extension import increment
Counter.increment = increment 
```

现在这将不起作用，因为 C 级别的调用约定将被破坏。例如：

```
>>> c = Counter()
>>> c.increment()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: increment() takes exactly one argument (0 given) 
```

但在 Python 2 中，我们可以通过执行以下操作将函数转换为未绑定方法：

```
Counter.increment = types.MethodType(increment, None, Counter) 
```

**我怎样才能在 Python 3 中完成同样的事情？**

一种简单的方法是使用纤薄的包装器：

```
from functools import wraps
def method_wraper(f):
    def wrapper(*args, **kwargs):
        return f(*args, **kwargs)
    return wraps(f)(wrapper)

Counter.increment = method_wrapper(increment) 
```

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-17T10:44:13.963

首先是正确获取名称：

```
>>> def increment(obj):
...     obj.count += 1
...
>>> class A(object):
...     def __init__(self):
...         self.count = 0
...
>>> o = A()
>>> o.__init__
<bound method A.__init__ of <__main__.A object at 0x0000000002766EF0>>
>>> increment
<function increment at 0x00000000027797C8> 
```

所以专有名称是**函数**和**绑定方法**。现在您可以查找如何[*绑定未绑定方法*](https://stackoverflow.com/a/1015405/1149736)，您可能最终会阅读有关[*描述符*](https://docs.python.org/3/howto/descriptor.html)的内容：

> 通常，描述符是具有“绑定行为”的对象属性，其属性访问已被描述符协议中的方法覆盖。这些方法是`__get__`、`__set__`和 `__delete__`。如果为对象定义了这些方法中的任何一个，则称其为描述符。

您可以通过使用不同的调用轻松地将函数转换为方法`__get__`

```
>>> increment.__get__(None, type(None))
<function increment at 0x00000000027797C8>
>>> increment.__get__(o, type(o))
<bound method A.increment of <__main__.A object at 0x00000000027669B0>> 
```

它就像一个魅力：

```
>>> o = A()
>>> increment.__get__(None, type(None))(o)
>>> o.count
1
>>> increment.__get__(o, type(o))()
>>> o.count
2 
```

您可以轻松地将这些*新绑定的方法*添加到对象：

```
def increment(obj):
    obj.count += 1

def addition(obj, number):
    obj.count += number

class A(object):
    def __init__(self):
        self.count = 0

o = A()
o.inc = increment.__get__(o)
o.add = addition.__get__(o)
print(o.count) # 0
o.inc()
print(o.count) # 1
o.add(5)
print(o.count) # 6 
```

或者创建您自己的*描述符*，将*函数*转换为*绑定方法*：

```
class BoundMethod(object):
    def __init__(self, function):
        self.function = function

    def __get__(self, obj, objtype=None):
        print('Getting', obj, objtype)
        return self.function.__get__(obj, objtype)

class B(object):
    def __init__(self):
        self.count = 0

    inc = BoundMethod(increment)
    add = BoundMethod(addition)

o = B()
print(o.count) # 0
o.inc()
# Getting <__main__.B object at 0x0000000002677978> <class '__main__.B'>
print(o.count) # 1
o.add(5) 
# Getting <__main__.B object at 0x0000000002677978> <class '__main__.B'>
print(o.count) # 6 
```

您还可以看到，这与[*函数*/*绑定方法*原则](https://docs.python.org/3/howto/descriptor.html#functions-and-methods)非常一致：

> 类字典将方法存储为函数。在类定义中，方法是使用 def 和 lambda 编写的，它们是创建函数的常用工具。与常规函数的唯一区别是第一个参数是为对象实例保留的。根据 Python 约定，实例引用称为 self 但可以称为 this 或任何其他变量名。
> 
> 为了支持方法调用，函数包括`__get__()`在属性访问期间绑定方法的方法。这意味着所有函数都是非数据描述符，它们返回绑定或未绑定的方法，具体取决于它们是从对象还是类调用。

并且*函数*在实例初始化期间成为*绑定方法：*

```
>>> B.add
# Getting None <class '__main__.B'>
<function addition at 0x00000000025859C8>
>>> o.add
# Getting <__main__.B object at 0x00000000030B1128> <class '__main__.B'>
<bound method B.addition of <__main__.B object at 0x00000000030B1128>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-17T20:47:24.983

像这样导入扩展：

```
import compiled_extension 
```

在你的课堂上，你写道：

```
def increment: return compiled_extension.increment() 
```

这似乎更具可读性并且可能更有效。

# jquery - jQuery flot - 缩放导致绘图缩小，轴标签消失

> ID：10729916
> 
> 赞同：4
> 
> 时间：2012-05-24T01:07:08.107
> 
> 标签：jquery, flot

我已经用 jQuery flot 实现了一些缩放功能，但它工作得并不完全正确。缩放是通过捕获 flot 的“plotselected”事件并使用“ranges”参数重新绘制来修改 xaxis 和 yaxis 最大值和最小值来实现的。

该图在最初绘制时确实显示正确，我可以拖动以进行 xy 选择。重新绘制绘图时，屏幕上轴网格的实际大小会缩小，但会绘制适当的数据范围。此外，每次缩放重新绘制时，轴标签都会从视图中消失，尽管我仍然可以在检查器中看到它们，并且在图的最左上角有一些看起来像轴标签可能已经向上移动的杂物那里并且部分（几乎）可见。我有一些其他代码可以使用不同的数据重新绘制绘图，这些数据也会从视图中删除轴标签，尽管绘图的大小不会缩小（就像缩放时那样），并且再次绘制了适当的数据。我提到这两个问题可能有共同的起源。

我想也许我可以通过在重新绘制之前以某种方式破坏情节或清除画布来解决这些问题，但我还没有找到任何关于如何做到这一点的指导。

以下是一些相关的代码片段。第一个列出了最初渲染绘图并绑定到“plotselected”事件的代码：

```
 o.midGraph = $.plot($("#small-graph-mid"), testData, graphOptions);
                $("#small-graph-mid").unbind("plotselected");
                $("#small-graph-mid").bind("plotselected", function (event, ranges) {
                    graphOptions = o.midGraph.getOptions();
                    testData = o.midGraph.getData();
                    o.midGraph = $.plot($("#small-graph-mid"), testData,
                            self._graphZoomOptions(graphOptions, ranges));
                }); 
```

这是将轴范围设置为新范围的函数：

```
 _graphZoomOptions: function(options, ranges) {
        return $.extend(true, {}, options, {
            xaxis: { min: ranges.xaxis.from, max: ranges.xaxis.to },
            yaxis: { min: ranges.yaxis.from, max: ranges.yaxis.to }
        });
    }, 
```

我认为我需要以某种方式破坏/清除/重置情节/画布是否走在正确的轨道上？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T19:42:57.083

您使用的是 jquery 1.7.2 吗？

如果是这样，请查看[此线程](http://code.google.com/p/flot/issues/detail?id=643#c4)，尤其是注释 #4 中包含的固定导航插件。

经过数小时的混乱，它解决了我使用导航插件的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T10:54:51.763

我遇到了这个问题，通过不使用 plot.getOptions() 解决了它。没有考虑到这个原因，但使用我在启动情节时创建的原始选项对象有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T13:58:10.590

以下是我将 Y 轴设置为某个范围的方法。之后所有 Y 轴都将设置为相同的范围。“每个”循环中的 4 条语句中有 2 条可能是不必要的，我只是不记得哪些。

```
$.each(yaxes, function(_, _yaxis){
    _yaxis.min = _min;
    _yaxis.max = _max;
    _yaxis.options.min=_min;
    _yaxis.options.max=_max;
});

setupGrid();
draw(); 
```

您不需要销毁图表并重新绘制它。setupGrid 和 draw 函数会为您处理该部分。

# python - 如何防止多余的换行符出现在我的正则表达式匹配中？

> ID：10729920
> 
> 赞同：1
> 
> 时间：2012-05-24T01:07:32.280
> 
> 标签：python, regex

我有以下字符串

```
'TOKEN a$dmin\r\n' 
```

我想从中提取价值`'a$dmin'`。我正在使用

```
re.findall("(?i)TOKEN (.*)",string) 
```

但我得到的是`'a$dmin\r\n'`

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T01:11:33.617

要么匹配`str.strip`：

```
re.findall(r"(?i)TOKEN (\S*)", s.strip()) 
```

或更改表达式以仅匹配非空格：

```
re.findall(r"(?i)TOKEN (\S*)", s) 
```

如果您有文字斜杠，例如：

```
s = r'TOKEN a$dmin\r\n' 
```

使用此表达式匹配第一个斜杠之前的所有内容：

```
re.findall(r"(?i)TOKEN (.*?)\\", s) 
```

# java - Java - 理解接口

> ID：10729927
> 
> 赞同：1
> 
> 时间：2012-05-24T01:08:49.843
> 
> 标签：java, android, interface

我已经阅读了 Java 中的接口，现在我想创建一个接口，它允许我创建如下结构：

```
public class MyClass implements View.OnTouchListener {
    //Implementation
    public boolean onTouch(View arg0, MotionEvent arg1) {
       /*SOME CODE*/    
       return true;
    }
} 
```

所以我想创建类似的接口（类）。如果我不知道哪个类实现它，如何从接口调用`onTouch`方法？`OnTouchListener`如果我决定将类与接口（不同的库）分开，我怎么知道哪些类实现了这个接口？希望你明白我的意思。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:11:25.097

任何实现接口的类都必须覆盖接口中列出的方法，因此当您知道一个类是否将为您从接口对象调用的方法提供实现时，您可以高枕无忧。

`onTouch`要从an调用，`onTouchListener`您只需将对象传递给类型的引用`onTouchListener`并从那里开始

```
onTouchListener myOnTouchListener = new MyClass();
myOnTouchListener.onTouch(arg0, arg1); 
```

对于您问题的第二部分，我认为[这个 StackOverflow 问题](https://stackoverflow.com/questions/435890/find-java-classes-implementing-an-interface)应该对您有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:16:46.083

我觉得我理解了你的部分问题。

> 如果我决定将类与接口（不同的库）分开，我怎么知道哪些类实现了这个接口

使用类似的设置

```
MyClass myObject = new MyClass();
if(myObject instanceof myInterface){  //if the object implements the interface
    /*Do Something*/
}
else{
    /*Do Something Else Not Including the Method*/
} 
```

instanceof 保留字会告诉您给定对象是否是该类的实例——无论是通过继承还是实现

David B. 回答了您问题的前半部分——在对象本身上调用 onTouch(arg0, arg1)。

```
myObject.onTouch(arg0,arg1); 
```

刚刚看到你的编辑——如果你使用 instanceof 关键字，你可以检查给定的对象是否实现了接口（这意味着它会有 onTouch 方法）。有关此类实现，请参见上面的代码块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T01:35:03.717

> 如果我不知道哪个类实现它，如何从接口调用`onTouch`方法？`OnTouchListener`

接口不调用方法。正如向我描述的那样，它们在接口和开发人员之间形成了契约，无论什么对象实现了这个接口，它都将具有以下带有以下签名的方法。

在`MyClass`中，您将调用`onTouch`与任何其他函数相同的方式 - 将 a`View`和传递`MotionEvent`给它。

> 如果我决定将类与接口（不同的库）分开，我怎么知道哪些类实现了这个接口？

Javadoc 是您的朋友（作为开发人员）。或者，如果您正在对集合执行某些操作，例如`ArrayList`、`Stack`、`Queue`或包含`Objects`的内容，则可以使用以下语法来保证，无论如何，您使用的集合仅包含实现您的接口的对象：

```
ArrayList<? extends View.OnTouchListener> myArrayList; 
```

# php - MySQL 查询 - 将 BLOB 的结果限制为 blob（行）中的 1 个唯一元素

> ID：10729930
> 
> 赞同：1
> 
> 时间：2012-05-24T01:09:38.463
> 
> 标签：php, mysql

我有一个查询要查找如下所示的废弃购物车：

```
SELECT   c.customerid, 
         c.custconfirstname, 
         c.custconemail, 
         o.ordstatus, 
         o.orddate, 
         GROUP_CONCAT(  'Order Id: ', orderid,  ' | Product name: ', ordprodname,  ' | Quantity: ', ordprodqty,  '<br>' ) AS ordered_items
 FROM    isc_customers c
         LEFT OUTER JOIN isc_orders o ON o.ordcustid = c.customerid
         LEFT OUTER JOIN isc_order_products op ON op.orderorderid = o.orderid
         LEFT OUTER JOIN isc_product_images pi ON pi.imageprodid = op.orderprodid
GROUP BY c.customerid
HAVING   COUNT( DISTINCT o.ordcustid ) >0
             AND o.ordstatus = 0
             AND o.orddate < UNIX_TIMESTAMP( ) -  '18000'
             AND o.orddate > UNIX_TIMESTAMP( ) -  '259200' 
```

对于每个客户（唯一的 customerid），BLOB 将为ordered_items 生成类似的内容：

```
 Order Id: 15256 | Product name: PROD A | Quantity: 1
,Order Id: 15256 | Product name: PROD B | Quantity: 1
,Order Id: 15299 | Product name: PROD A | Quantity: 1
,Order Id: 15301 | Product name: PROD A | Quantity: 1 
```

这基本上可以解释为客户在时间范围内有 3 辆废弃的购物车。由于此查询将用于发送废弃的购物车电子邮件，因此出于各种原因，我不想发送垃圾邮件并发送包含每个废弃购物车中的每个产品的电子邮件（唯一的 orderid），包括在上面的示例中客户已经尝试过将产品 A 放入购物车 3 次超过 3 个订单，因此将在电子邮件中获得该项目 3 次。

那么如何限制查询，使其仅返回每个 customerid 1 个 orderid 的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:25:14.047

在您的查询中添加 DISTINCT 就可以了。

[http://www.w3schools.com/sql/sql_distinct.asp](http://www.w3schools.com/sql/sql_distinct.asp)

# apache-flex - Flex：ActionScript 中的自定义复合组件——percentWidth/percentHeight 的问题

> ID：10729936
> 
> 赞同：0
> 
> 时间：2012-05-24T01:10:57.723
> 
> 标签：apache-flex, actionscript, adobe

我做了大量的研究并阅读了[Adob​​e Live Docs](http://livedocs.adobe.com/flex/3/html/help.html?content=size_position_2.html)，直到我的眼睛流血试图弄清楚这一点。

我在 ActionScript 中构建一个复合自定义组件，并希望子控件水平布局。通过将它们`HGroup`添加到组件中并将 HGroup 添加到组件中，这可以正常工作，问题来自基于百分比的大小调整。

我需要`_horizontalGroup:HGroup`根据容器的大小自行调整大小。

单步执行代码显示每个 UIComponent 的父属性是...

*   _horizo​​ntalGroup.parent = ReportGridSelector
*   ReportGridSelector.parent = grpControls

如果 grpControls 有明确的大小，那么 ReportGridSelector 不应该也有它的大小吗？

自定义组件是这样实现的...
注意：ReportControl 扩展 UIComponent 并且不包含大小调整逻辑

```
public class ReportGridSelector extends ReportControl{

  /*other display objects*/
  private var _horizontalGroup:HGroup;

    public function ReportGridSelector(){
        super();
        percentHeight = 100;
        percentWidth = 100;
    }

    override protected function createChildren():void{

        super.createChildren();

        if(!_horizontalGroup){
            _horizontalGroup = new HGroup();

            //I WANT SIZE BY PERCENTAGE, BUT THIS DOESN'T WORK
            _horizontalGroup.percentWidth = 100;
            _horizontalGroup.percentHeight = 100;

            //EXPLICITLY SETTING THEM WORKS, BUT IS STATIC :-(
            //_horizontalGroup.width = 200;
            //_horizontalGroup.height = 200;
            addChild(_horizontalGroup);
        }
    }
} 
```

使用 MXML 代码

```
<?xml version="1.0" encoding="utf-8"?> 
<s:VGroup id="grpControls" width="200" height="200">
     <ReportControls:ReportGridSelector width="100%" height="100%"/>
</s:VGroup> 
```

如果我明确定义`_horizontalGroup`'s`width`和`height`属性，一切都显示正常。如果我尝试`_horizontalGroup.percentWidth`or `percentHeight`，所有控件都会被压缩在一起。

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:48:11.523

当显示列表从 updateDisplayList 失效时执行布局。

```
override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
{
    super.updateDisplayList(unscaledWidth, unscaledHeight);

    _horizontalGroup.width = unscaledWidth;
    _horizontalGroup.height = unscaledHeight;
} 
```

了解 Flex 组件生命周期：

[http://livedocs.adobe.com/flex/3/html/help.html?content=ascomponents_advanced_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=ascomponents_advanced_2.html)

**创造儿童**

> 创建组件的任何子组件。例如，ComboBox 控件包含一个 TextInput 控件和一个 Button 控件作为子组件。
> 
> 有关更多信息，请参阅实现 createChildren() 方法。

**更新显示列表**

> 根据所有先前的属性和样式设置在屏幕上调整组件子项的大小和位置，并绘制组件使用的任何皮肤或图形元素。组件的父容器决定了组件本身的大小。

# android - Android - 一些代码在手机进入不同的 Activity 后执行

> ID：10729942
> 
> 赞同：0
> 
> 时间：2012-05-24T01:11:55.687
> 
> 标签：android

我这里有一个奇怪的场景。

我有这个代码：

```
// For checking if the person is logged in.
first_time_check();

setContentView(R.layout.main);

// ...next lines of code 
```

first_time_check() 函数检查用户是否是第一次登录。如果他们的 user_id 不在 SharedPreferences 中，我会将他们重定向到登录：

```
public void first_time_check()
{   
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences( ProblemioActivity.this);

    String user_id = prefs.getString( "user_id", null ); // First arg is name and second is if not found.
    String first_time_cookie = prefs.getString( "first_time_cookie" , null );               

    // About setting cookie.  Check for first time cookie
    if ( first_time_cookie == null )
    {
        // This user is a first-time visitor, 1) Create a cookie for them
        first_time_cookie = "1";

        // 2) Set it in the application session.
        prefs.edit().putString("first_time_cookie", first_time_cookie ).commit(); 

        // Make a remote call to the database to increment downloads number
        // AND send me an email that it was a new user.                 
    }        
    else
    {
        // If not first time, get their id.
        // If user_id is empty, make them an account.  
        // If id not empty, call the update login date and be done.         

        if ( user_id == null )
        {
            // User id is null so they must have logged out.                                
            Intent myIntent = new Intent(ProblemioActivity.this, LoginActivity.class);
            ProblemioActivity.this.startActivity(myIntent);
        }
        else
        {               
            // Make a remote call to the database to increment downloads number                                 
        }
    }

return;
} 
```

所以在代码执行之后

```
 Intent myIntent = new Intent(ProblemioActivity.this, LoginActivity.class);
            ProblemioActivity.this.startActivity(myIntent); 
```

它仍然在调用此函数的原始代码下方执行。

知道怎么会发生吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:43:52.950

这摘自[开发指南](http://developer.android.com/guide/topics/fundamentals/activities.html)

> ```
> Shutting Down an Activity
> You can shut down an activity by calling its finish() method.
> You can also shut down a separate activity that you previously
> started by calling finishActivity().
> 
> Note: In most cases, you should not explicitly finish an activity
> using these methods. As discussed in the following section about the
> activity lifecycle, the Android system manages the life of an
> activity for you, so you do not need to finish your own activities.
> Calling these methods could adversely affect the expected user
> experience and should only be used when you absolutely do not want
> the user to return to this instance of the activity. 
> ```

在活动上调用 finish() 在这里似乎是合适的，因为您不希望用户返回此活动。

# sql-server-2008 - 将巨大的数据表传递给存储过程以进行批量插入或一次插入一条记录

> ID：10729947
> 
> 赞同：0
> 
> 时间：2012-05-24T01:12:55.067
> 
> 标签：sql-server-2008, ado.net, datatable

我需要处理表中的记录，并且需要记录每条记录的处理结果。可以将数据表传递给存储过程，而不是使用 ADO.NET SqlDbType.Structured 将它们全部插入（更多信息[在这里](http://www.codeproject.com/Tips/214492/Passing-a-datatable-to-a-stored-procedure-in-Sql-S)）。我需要构建该数据表，然后传递给存储过程。对于 Windows 服务中超过 12k 行（用于数据表），这种方法仍然是最佳的吗？恐怕这可能会在服务器上消耗太多内存？不确定在这种情况下是否可以批量构建数据表并将它们传递给存储过程。

**编辑**：- 在这 12K 行中，每一行都没有大块。每一行都是 guid (Id)、string (status) 和 string(ErrorMessage, If any)。

任何建议或建议都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:46:45.577

表值参数对于 12K 行应该没问题，即使偶尔的状态/错误消息值更长。

当然，您可以随时尝试，因为有很多变量可能会影响性能是否可以接受，而且我们不可能考虑所有这些变量特定于您的环境、应用程序和任何无关的应用程序或过程。

# java - 使用另一个类的方法

> ID：10729949
> 
> 赞同：1
> 
> 时间：2012-05-24T01:13:40.920
> 
> 标签：java

我参加了一个名为`PokerHand`创建扑克手的课程。

现在我想在一个不同的类上使用相同的方法`fiveCardDraw`来为庄家和玩家创建一个完全不同的扑克手，所以我创建了两个数组：

```
PokerHand [] dealer = new PokerHand[5];
PokerHand [] player = new PokerHand[5]; 
```

我将在哪里存储卡片，但我想使用`Pokerhand`类上的方法，例如：

```
addCard()
getCards() 
```

如何将这些方法调用到`fiveCardDraw`类中并将它们存储到我创建的数组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:15:58.343

您可以从类型的对象中调用它们`PokerHand`（我推荐的方法）

```
dealer[i].addCard();
player[i].getCards(); 
```

或者，如果它们适用，您可以将方法转换为，`static`并且可以从`PokerHand.addCard()`.

```
MyClass obj = new MyClass();
obj.foo = PokerHand.addCard(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:17:42.973

如果它们是静态方法，那么您将输入：

```
fiveCardDraw.addCard(); 
```

如果它们不是静态的，那么您将不得不创建和实例（或对象） FiveCardDraw 类 ex：

```
fiveCardDraw cardDraw = new fiveCardDraw(); 
```

然后添加

```
cardDraw.addCard(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T01:27:05.633

你想要什么？

```
class fiveCardDraw {
private PokerHand [] player = new PokerHand[5];
private PokerHand [] dealer = new PokerHand[5]; 
pulic void addPlayerCard(PokerHand [] ph){
do something...
} 
pulic void addDealerCard(PokerHand [] ph){
do something...
} 
public PokerHand [] getPlayerCards()
return player;
}
public PokerHand [] getDealerCards()
return dealer;
} 
```

`

# c# - 未更新的行

> ID：10729953
> 
> 赞同：1
> 
> 时间：2012-05-24T01:14:11.980
> 
> 标签：c#, database, setting

我编写了以下函数来更新我的数据库中的学生：

```
public bool UpdateStudent(Student stu)
{
   Console.WriteLine("StudentManger.UpdateStudent): Called");

   int rowsChanged = 0;

   using (var cnn = new SqlConnection(
          Properties.Settings.Default.universityConnectionString))
   {
      using (var cmd = new SqlCommand("UPDATE Student " +
              "SET FirstName = @FirstName, " +
              "lastName = @LastName, " +
              "birth = @birth " +
              "WHERE id = @id", cnn))
      {
        cmd.Parameters.Add(new SqlParameter("@FirstName", stu.FirstName));
        cmd.Parameters.Add(new SqlParameter("@LastName", stu.LastName));
        cmd.Parameters.Add(new SqlParameter("@id", stu.ID));
        cmd.Parameters.Add(new SqlParameter("@birth", stu.Birth));

        cnn.Open();
        rowsChanged = (int)cmd.ExecuteNonQuery();
        Properties.Settings.Default.Save();
      }
    }
    Properties.Settings.Default.Save();
    return (rowsChanged != 0);
  } 
```

但是当我调用函数时，实际上没有数据被保存到数据库中

有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:32:11.367

[使用您在chat](https://chat.stackoverflow.com/rooms/11666/discussion-between-james-dangelo-and-aahn)中提供的整个解决方案和信息，您的代码就可以了。问题是 .mdf 数据库文件在您的项目中设置为“复制到输出目录”：“始终”。将此属性更改为“如果较新则复制”（或“请勿复制”并自行将其移动到 bin 文件夹），并且在您重新运行应用程序时它不会覆盖您的更改。重要的是，您*不会**在项目根目录*中的 .mdf 数据库文件中看到您在应用程序中所做的更改。它实际上被复制到 /bin 文件夹中，这就是更改保存的地方。因此，如果您不更改“复制到输出目录”属性，那么每次构建时它都会从您的根目录复制到您的 /bin 文件夹。*更改并没有被持久化，而实际上它们是。*

# android - 在 Android 中抓取 VideoToGif 帧

> ID：10729954
> 
> 赞同：1
> 
> 时间：2012-05-24T01:14:23.977
> 
> 标签：android, video, javacv, javacpp

我正在尝试从 android 中的视频文件中抓取帧，唯一的替代方案（已经编译好可供使用）是[videoToGif](http://code.google.com/p/videotogif/)项目。它在 Android 中使用 JavaCV、JavaCpp 和 Java SE！最终的apk真的很大，但我只是在做一个学术项目......

**错误** 我正在使用以下代码：

```
ModifiedFrameGrabber frameGrabber = new ModifiedFrameGrabber(VIDEO_PATH);
IplImage frame = null;

try
{
    frameGrabber.start();
    frame = frameGrabber.grab();
} catch(Exception e){...}

byte[] data = frame.getByteBuffer().array(); 
```

在最后一行我得到错误：

```
Caused by: java.lang.UnsupportedOperationException
    at java.nio.DirectByteBuffer.protectedArray(DirectByteBuffer.java:292)
    at java.nio.ByteBuffer.array(ByteBuffer.java:144)
    at my.package.onCreate(MyClass:x) 
```

任何人都可以帮助我吗？似乎问题出在Java API中......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T13:48:52.150

直接 NIO 缓冲区没有数组。调用`get()`而不是`array()`.

# c# - 访问 ASP.NET Razor 中的特定变量

> ID：10729957
> 
> 赞同：1
> 
> 时间：2012-05-24T01:15:06.517
> 
> 标签：c#, asp.net, url, razor

嘿，我希望这个问题不会太愚蠢。

你如何只访问一个页面的一个值。例如，我的 cshtml 文件中有 3 个变量。

```
@{var number1 = a1;}
@{var number2 = b2;}
@{var number3 = c3;} 
```

但是如果我在我的应用程序中使用 GET 会下载所有信息并且我不能再分开它了。有了这个网址

```
"http://www.myurl.com/numbers.cshtml" 
```

结果是“a1b2c3”。

是否可以仅访问例如 number2 的值？所以结果将是“b2”？我搜索了几个小时，我认为这与网址有关，因此我输入了我的应用程序

```
"http://www.myurl.com/numbers.cshtml?number2" 
```

显然这行不通。我希望你明白我的意思。我真的很感激一些有用的答案:)

问候

亚历克斯

//编辑

嘿，谢谢你的答案。如果我不够清楚，我很抱歉。基本上我想通过 Unity3D（游戏引擎）从我的服务器端文件中获取数据。我希望您在登录游戏后立即下载有关您个人资料的所有信息（姓名、级别、经验等）。问题是，Unity 会下载整个 URL 的内容。我无法访问任何值或变量。它的输出是纯文本。现在我当然可以为每个文本字段编写自己的脚本，但我更喜欢在一个文件中包含某些组。基本上我从我的数据库下载值，然后下载到 Unity3D。因为它下载了我需要的所有东西，所以只下载我现在需要的东西。例如，我只想下载玩家名称，但由于它在同一个文件中，我需要以某种方式告诉 unity 我只想要一个特定的变量。我认为这可以通过使用修改后的 URL 来实现。如果我错了，这完全是胡说八道，我非常抱歉。

//编辑2：

应用程序内的代码：

```
using UnityEngine;
using System.Collections;

public class example : MonoBehaviour {
public string url = "http://localhost:19206/ListProducts.cshtml";

 IEnumerator Start()
    {
        WWW www = new WWW(url);
        yield return www;
        guiText.text = www.text;
    } 
```

不幸的是，像 www.number1.text 这样的东西不起作用。再次感谢你！

//编辑3

最后是我的 asp.net razor 文件的简单基本代码。目前还没有数据库实现，但我想这与它无关。

```
@{ var experience = 3532; }
@{ var playerName = "Player1"; }

Your current experience is: @experience
Your Playername is: @playerName 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:43:02.713

考虑简单地从操作中返回 JsonResult 而不是提供自定义视图。

```
 return JsonResult({number1=42, text1="bla", number2=7}); 
```

在 JavaScript 方面，你会得到 {number1:42, text1:"bla", number2:7} 这对 JavaScript 非常友好。

# django - 如何在 Django 中设置组（子站点）

> ID：10729965
> 
> 赞同：0
> 
> 时间：2012-05-24T01:16:41.120
> 
> 标签：django, django-models, django-admin

我是 Django 的新手，我来自 Drupal 家族。在那里，我们有有[机组](http://drupal.org/project/og)，我们可以使用它们创建内容组和子站点；我如何用 Django 做这样的事情？

假设我正在使用 Django 为我的公司制作这个网站，我公司的每个部门都需要在网站上设置一个私人部分。例如，设计人员有自己的网站部分，后端开发人员无法进入。后端开发人员也会有同样的事情。

我想以这样一种方式构建站点，即我只需登录 Django 管理员并添加一个新的类别或子站点或组（无论 Django 术语是什么），其设置与其他组相同或具有类似设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:41:37.177

这取决于您所说的“私人部分”是什么意思。您可能应该尝试从不同的角度看待它：

Django通过“应用程序”拆分站点的*功能。*每个应用程序都执行其特定的操作，并在数据库中获取一组表。应用程序可以访问彼此的表。例如，其他应用程序访问 Auth 应用程序的用户、组和权限表是很常见的。这就是您所说的“子网站”吗？

至于访问控制，可以将用户分配到组，并且可以为他们分配各种[管理权限](https://docs.djangoproject.com/en/dev/topics/auth/#permissions)。为每个模型（即数据库表）自动生成添加、更改和删除权限。您还可以添加自己的权限。

我认为您无法在 Django 级别将设计人员与后端开发人员分开。您需要做其他事情，例如为每个组维护单独的源存储库并将它们合并以创建可用站点（每个组都对另一个组具有只读访问权限）。这真的取决于你的团队的纪律，因为这些元素可以交织在一起。

Django 建议静态文件由其他东西提供服务，比如直接从您的 Web 服务器，或者从具有简单 HTTP 服务器（无 CGI/WSGI/其他）的另一台机器。这是因为与直接服务相比，Django 只能减慢静态文件的速度。但是，为了进行测试，您可以启用一个静态页面服务器。

鉴于所有这些，静态文件通常相当于 CSS、图像、媒体和 JavaScript。其中，后端人员*可能*想弄乱 JS，但仅此而已，所以这可能在设计师的 repo 中。

Django 树本身具有站点和应用程序的代码。几乎都是后端的东西。例外是 HTML 模板文件，位于每个应用程序的“模板”目录中。这些是由后端视图代码提供的上下文数据填充的文件。我不知道这对你们来说是前端还是后端；如果有很多 CSS 纪律，它可能主要是后端，但我认为这不太可能。

您可以在 Django 中做很多事情，让一方或另一方的生活更轻松。例如，模板标签允许自定义 Python 代码生成 HTML 以插入到页面中。例如，我使用这些来生成标签栏和窗格。

如果没有更好地了解您的需求，我真的无能为力。这个问题仍然很模糊。您最好花一两天时间阅读本教程，了解 Django 的观点是什么，然后确定它如何（或是否！）符合您的需求。

# javascript - jQuery动画左右移动

> ID：10729968
> 
> 赞同：1
> 
> 时间：2012-05-24T01:17:06.267
> 
> 标签：javascript, jquery, css, jquery-ui

使用 jquery`.css()`我正在更改左侧属性值以向左或向右移动 div。我正在寻找一种方法来在这种变化发生时对其进行动画处理。我没有尝试过，我尝试过 jQueryUI 的`.show(slide)`功能，但这会移动整个 div，而不仅仅是我需要的 120px 移动。

这是我当前没有动画的功能：

```
$('#plrt').live("click",function(){
    var lm=$('.plwid').css("left");
    lm = (parseInt(lm) + 120);
    $('.plwid').css("left", lm);    
}); 
```

这是滑动功能，当整个 div 从`display:hide`到时，它不能正常工作`display:show`，而不仅仅是移动像素变化

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T01:22:11.833

尝试`animate()`

```
$('#plrt').on("click",function(){
    $('.plwid').animate({ left: '+=120' }, 400 );
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T01:25:43.267

我举了一个简单的例子来说明我认为你正在努力实现的目标。
你应该看看[jQuery Animate](http://api.jquery.com/animate/)。

```
//note live is deprecated
$('#plrt').on("click", function() {
  //perform custom animation to add 120px to current left CSS position
  $('.plwid').animate({
    left: '+=120'
  });
});
```

```
#plrt{
  position:relative;
  background:red;
  width:100px;
  height:100px;
  cursor:pointer;
}

.plwid{
  position:absolute;
  background:blue;
  width:100px;
  height:100px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<div id="plrt"></div>
<div class="plwid"></div>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T01:24:09.930

试试这个[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

```
$('#plrt').on('click', function() { 
    $('.plwid').animate({ left: '+=120', 5000 });     
}); 
```

# time - 抑制 Makefile 中未来时间的“时钟偏差”警告

> ID：10729972
> 
> 赞同：1
> 
> 时间：2012-05-24T01:17:45.603
> 
> 标签：time, makefile, gnu-make

我有一个 Makefile，如果它在过去一小时内没有发生，它会执行一项任务。它是这样的：

```
 HOUR_FROM_NOW = $(shell perl -e '($$s,$$m,$$h,$$d,$$M)=localtime(time()+3600); printf("%02d%02d%02d%02d\n",$$M+1,$$d,$$h,$$m);')
NOW_FILE      = $(shell mkdir -p .make; touch .make/now; echo .make/now )

.PHONY: externals
externals: $(PROJECTS:%=.make/proj_%)
.make/proj_%: $(NOW_FILE)
     $(MAKE) -s $(*F)
     touch -t $(HOUR_FROM_NOW) $@

.PHONY: $(PROJECTS)
$(PROJECTS): 
     # do stuff, specifically, clone git-repo if not exists, else pull latest 
```

这部分效果很好，除了我现在收到警告：

```
make: Warning: File `.make/proj' has modification time 3.5e+03 s in the future
make: Nothing to be done for `externals'.
make: warning:  Clock skew detected.  Your build may be incomplete. 
```

任何人都知道如何抑制这些警告？（或在生成文件中执行定期任务）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-08-28T16:26:13.623

我遇到的大多数触摸版本都可以进行一些日期时间数学运算，从而允许直接通过`--date`选项设置文件的时间戳。

那以及分配给的变量`:=`仅“评估一次”的事实使这更容易阅读。

```
HOUR_AGO := .make/hour_ago
__UGLY := $(shell mkdir -p .make && touch --date='1hour ago' $(HOUR_AGO))
# The preceding line will be executed once

.make/proj_%: .make/hour_ago | .make
    $(MAKE) -s $(*F)
    @touch $@

.make:
    mkdir -p $@ 
```

我正在使用与此非常相似的东西来定期刷新登录令牌。

如果不是戴夫的回答，永远不会想到它。

* * *

该目录是通过将其指定为[order-only-prerequisite来创建的](http://www.gnu.org/software/make/manual/make.html#Prerequisite-Types)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:36:42.030

我怀疑+ 3600有问题。如果删除它会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:07:21.937

我想了又想，然后愚蠢的明显解决方案击中了我......

我没有使用 HOUR_FROM_NOW 设置未来的时间戳，而是使用实时并与 HOUR_AGO_FILE 进行比较...

```
HOUR_AGO      = $(shell perl -e '($$s,$$m,$$h,$$d,$$M)=localtime(time()-3600); printf("%02d%02d%02d%02d\n",$$M+1,$$d,$$h,$$m);')
HOUR_AGO_FILE      = $(shell mkdir -p .make; touch -t $(HOUR_AGO) .make/hour_ago; echo .make/hour_ago )

.PHONY: externals
externals: $(PROJECTS:%=.make/proj_%)
.make/proj_%: $(HOUR_AGO_FILE)
     $(MAKE) -s $(*F)
     @touch $@ 
```

# php - cronjob 调用 php 函数没有响应

> ID：10729975
> 
> 赞同：0
> 
> 时间：2012-05-24T01:18:17.983
> 
> 标签：php, cron

我有一个调用 php 脚本的 Cronjob。cronjob 正在执行，因为我将它设置为在它执行时向我发送电子邮件。手动执行时，php 脚本可以正常工作。我相信这可能与权限有关，但我不确定如何检查是否是这种情况。我正在使用godaddy。

这是php脚本：

```
$dayOfWeek = date('w');

if($dayOfWeek == 1) $xml = file_get_contents('http://xxxxx.com/mon.xml');
if($dayOfWeek == 2) $xml = file_get_contents('http://xxxxx.com/tues.xml');
if($dayOfWeek == 3) $xml = file_get_contents('http://xxxxx.com/wed.xml');
if($dayOfWeek == 4) $xml = file_get_contents('http://xxxxx.com/thurs.xml');
if($dayOfWeek == 5) $xml = file_get_contents('http://xxxxx.com/fri.xml');
if($dayOfWeek == 6) $xml = file_get_contents('http://xxxxx.com/sat.xml');
if($dayOfWeek == 7) $xml = file_get_contents('http://xxxxx.com/sun.xml');

file_put_contents('Bars.xml', $xml);

mysql_connect("xxxx.hostedresource.com", "user", "userpw") or die(mysql_error());   
mysql_select_db("dbname") or die(mysql_error());

mysql_query("UPDATE mytable SET isWorking='0' WHERE isWorking='1'") or die(mysql_error()); 
```

我收到以下错误消息：

```
 <br />
    <b>Warning</b>:  file_get_contents(http://xxxxxx.com/fri.xml) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: 
HTTP request failed! HTTP/1.0 403 Forbidden
     in <b>/home/content/77/8761477/html/refreshXML.php</b> on line <b>8</b><br /> 
```

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:28:24.767

为什么它失败了？检查以`/var/log/cron`获得更好的错误输出...

检查您的 PHP 命令是否可以从 cronjob 访问。我会尝试将 php 称为`/usr/bin/php`不仅是`php`命令本身。

希望能帮助到你

# git - 使用 TortoiseGit 只推送最后一次提交

> ID：10729979
> 
> 赞同：3
> 
> 时间：2012-05-24T01:19:18.080
> 
> 标签：git, repository, push, commit, tortoisegit

我只想将 TortoiseGit 的最后一次提交推送到 sourceforge 存储库。所有之前的都不会被推送。据说我可以创建一个新分支并推送这个分支[。](https://stackoverflow.com/q/1789017/1179158)但是新分支包含所有以前的提交，而不仅仅是最后一个。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T14:17:57.117

我认为这主要是对 git 工作原理的误解。当你推送一个提交时，如果该提交有一个父级，git 将确保该父级也在远程存储库中。除了稀疏克隆（这可能有助于保留带宽和/或磁盘使用，但对如何与远程存储库交互施加一些限制），git 旨在保持对象数据库的完整性和一致性。如果您可以在其父母不在存储库中的情况下推送提交，则会违反完整性/一致性。因此，按照设计，您不能只推送一个提交而不使用 git 确保保留提交沿袭。

也就是说，有两种特定的方法可以安排只推送一个提交：1）确保您要推送的提交的父级已经在远程数据库中（例如，用于`rebase`将分支上的所有提交压缩到单个提交，并可能在必要时重新定位该分支 - 但这可能不是您的工作流程的最佳选择），或 2）确保您要推送的提交没有父级 - 例如`git checkout -b somebranch --orphan`在最新版本的 git 中，然后创建你的承诺。

# charts - 使用 ExtJS 4 单击网格中的相关数据时突出显示图表中的条形图

> ID：10729980
> 
> 赞同：0
> 
> 时间：2012-05-24T01:19:27.373
> 
> 标签：charts, grid, extjs4, connect, highlight

我的屏幕上有两个对象，一个网格和一个图表，由同一家商店填充。我需要做的是突出显示图表上与我在网格中单击的项目相关的列。

在函数中，我想出了使用 Ext.getCmp('chart').series.get(0) 的一半方法。但是不知道如何获取系列的每个项目并突出显示它，因为 getItemForPoint(x,y) 不断返回空值......

非常感谢，代码如下：

```
// Code for my grid
{
 columnWidth: .25
 ,xtype: 'grid'
 ,hideHeaders: true
 ,border: true
 ,styke: 'padding-top: 60px;'
 ,height: 360
 ,store: participation
 ,columns: [{
      dataIndex: 'ID'
      ,width: 24
 },{
      dataIndex: 'Supplier'
      ,width: 204
}]
 ,listeners: {
      select: function() {
           // function to highlight the column on my chart
      }
 }
}

// Code for my chart
{
 border: false
 ,layout: 'column'
 ,items: [{
    columnWidth: .75
    ,xtype: 'chart'
    ,animate: true
    ,height: 432
    ,shadow: false
    ,id: 'chart'
    ,store: participation
    ,axes: [{
        type: 'Numeric'
        ,position: 'left'
        ,grid: true
        ,fields: 'Participation'
        ,title: 'Share'
        ,label: {
            renderer: Ext.util.Format.numberRenderer('0.00'+"%")
        }
    },{
        type: 'Category'
        ,position: 'bottom'
        ,fields: 'ID'
    }]
    ,series: [{
        type: 'column'
        ,axis: 'left'
        ,highlight: 'true'
        ,xField: 'ID'
        ,yField: 'Participation'
        ,tips: {
            trackMouse: true
            ,width: 312
            ,maxWidth: 360
            ,height: 36
            ,constrainPosition: true
            ,renderer: function(storeItem, item) {
                this.setTitle('Supplier: ' + storeItem.get('Supplier')+'<br/>'+'Share: ' + Ext.util.Format.number(storeItem.get('Share'),"0.00")+'%');
            }
        }
        ,style: {
            lineWidth: 1
            ,stroke: '#666'
        }
    }]
  }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:57:05.760

查看 ExtJS 示例中的[动态表单、网格和图表](http://docs.sencha.com/ext-js/4-1/#!/example/charts/FormDashboard.html)。该示例准确演示了您要实现的目标。请参阅附加到图表和 gridPanel 的侦听器（selectionchange 事件等）。

# javascript - 突出显示 HTML 文本中的单词（但不是标记）

> ID：10729983
> 
> 赞同：5
> 
> 时间：2012-05-24T01:19:59.700
> 
> 标签：javascript, regex

我正在尝试突出显示正文内的所有匹配单词，但不突出显示任何 html 标记内的单词。例如，给出的关键字是“para”。这是段落：

```
<p class="para"> Example of paragraph. Lorem ipsum dolor sit amet. </p> 
```

导致：

```
<p class="para">
Example of <strong>para</strong>graph. Lorem ipsum dolor sit amet.
</p> 
```

我知道这可以通过 JavaScript 实现，`replace()`但我对正则表达式知之甚少。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T01:35:46.633

## 演示：http: [//jsfiddle.net/crgTU/7/](http://jsfiddle.net/crgTU/7/)

```
highlightWord(document.body,'para');

function highlightWord(root,word){
  textNodesUnder(root).forEach(highlightWords);

  function textNodesUnder(root){
    var n,a=[],w=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,null,false);
    while(n=w.nextNode()) a.push(n);
    return a;
  }

  function highlightWords(n){
    for (var i; (i=n.nodeValue.indexOf(word,i)) > -1; n=after){
      var after = n.splitText(i+word.length);
      var highlighted = n.splitText(i);
      var span = document.createElement('span');
      span.className = 'highlighted';
      span.appendChild(highlighted);
      after.parentNode.insertBefore(span,after);
    }
  }
}
​ 
```

您也可以考虑调用类似...</p>

```
function removeHighlights(root){     
  [].forEach.call(root.querySelectorAll('span.highlighted'),function(el){
    el.parentNode.replaceChild(el.firstChild,el);
  });
} 
```

…在你去寻找新​​的亮点之前（从 DOM 中删除旧的亮点）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-19T15:31:13.157

# 为什么使用自制的突出显示功能是个坏主意

从头开始构建自己的突出显示功能可能不是一个好主意，因为您肯定会遇到其他人已经解决的问题。挑战：

*   您需要删除带有 HTML 元素的文本节点以突出显示您的匹配项，而不会破坏 DOM 事件并一遍又一遍地触发 DOM 重新生成（例如，就是这种情况`innerHTML`）
*   如果要删除突出显示的元素，则必须删除 HTML 元素及其内容，并且还必须组合拆分的文本节点以进行进一步搜索。这是必要的，因为每个荧光笔插件都会在文本节点内搜索匹配项，如果您的关键字将被拆分为多个文本节点，它们将不会被找到。
*   您还需要构建测试以确保您的插件在您没有考虑过的情况下工作。我说的是跨浏览器测试！

听起来很复杂？如果您想要一些功能，例如忽略突出显示中的某些元素、变音符号映射、同义词映射、iframe 内搜索、分隔词搜索等，这将变得越来越复杂。

# 使用现有插件

使用现有的、良好实现的插件时，您不必担心上述命名的事情。Sitepoint 上的文章**[10 jQuery text highlighter plugins比较了流行的荧光笔插件。](https://www.sitepoint.com/10-jquery-text-highlighter-plugins/)**

# 看看[mark.js](https://markjs.io/)

[mark.js](https://markjs.io/)就是这样一个用纯 JavaScript 编写的插件，但也可以作为 jQuery 插件使用。它的开发目的是提供比其他插件更多的机会，并提供以下选项：

*   单独搜索关键字而不是完整的术语
*   地图变音符号（例如，如果“justo”也应该匹配“justò”）
*   忽略自定义元素内的匹配项
*   使用自定义突出显示元素
*   使用自定义突出显示类
*   映射自定义同义词
*   也在 iframe 内搜索
*   收到未找到的条款

**[演示](https://markjs.io/configurator.html)**

或者你可以看到[这个 fiddle](https://jsfiddle.net/julmot/vpav6tL1/)。

**用法示例**：

```
// Highlight "keyword" in the specified context
$(".context").mark("keyword");

// Highlight the custom regular expression in the specified context
$(".context").markRegExp(/Lorem/gmi); 
```

它是在 GitHub 上免费开发的开源软件（[项目参考](https://github.com/julmot/mark.js)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T08:08:19.270

您可以使用正则表达式方式，但它不会突出显示多个标签。例如 myhighlight 不会突出显示“我的亮点”。

这是代码：

```
str='<img src="brown fox.jpg" title="The brown fox" />'
    +'<p>some text containing fox. And onother fox.</p>'
var word="fox";
word="(\\b"+ 
    word.replace(/([{}()[\]\\.?*+^$|=!:~-])/g, "\\$1")
        + "\\b)";
var r = new RegExp(word,"igm")
str.replace(/(>[^<]+)/igm,function(a){
    return a.replace(r,"<span class='hl'>$1</span>");
}) 
```

# jquery - 获取每个可见孩子的班级

> ID：10729984
> 
> 赞同：1
> 
> 时间：2012-05-24T01:20:09.010
> 
> 标签：jquery, each, visible

我正在动态创建附加到新输入的跨度。如果标题输入有某些可见的孩子，我希望新的输入孩子也能看到这些类。

我想要类似的东西：

```
var visibleClass = $('#titlediv').children().is(':visible').each('.class');

$('#newinput').children('span').hasClass('.' + visibleClass).show(); 
```

这是创建新输入和 div 的函数的代码示例。在此示例中，“.catsadd”指的是变量 all images，它们都具有类 catadd 并且也具有自己的唯一类：

```
var item = $('<input />');

item.attr({'type':'text', 'size': '33px' , 'class':'inputItem' , 'id':'item' + nextItemId })

.appendTo('#itemDiv' + nextItemId);

    //Create Span for category selections

$('<span />').attr({'class':'dynamiccat' , 'id':'categorydiv' + nextItemId})

.prependTo('#itemDiv' + nextItemId);

$('#categorydiv' + nextItemId).append(allimages);

$('.dynamiccat').hide();

$('.catsadd').hide(); 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:23:43.783

如果我说对了，您想获取可见元素的所有类：

```
var visibleClasses = $('#titlediv :visible[class]').map(function(){
    return this.className.split(\s);
}).get(); 
```

直系子女：

```
var visibleClasses = $('#titlediv > :visible[class]').map(function(){
    return this.className.split(\s);
}).get(); 
```

# javascript - (jquery) .load 函数

> ID：10729989
> 
> 赞同：0
> 
> 时间：2012-05-24T01:21:01.170
> 
> 标签：javascript, jquery, html

是否可以使用 .load 函数加载外部网站？

```
<div id="new"></div>
<script language="JavaScript">
    $(document).ready(function(){
        $("#new").load("http://omn.orgfree.com/");
    })

</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:31:05.963

由于浏览器的[同源限制](http://en.wikipedia.org/wiki/Same_origin_policy)，您无法从其他域加载带有 ajax 的内容。

您可以在 iframe 中显示该内容，也可以使用您自己域中的服务器代理为您获取内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:40:55.133

这取决于您的期望。如果您想保持遍历和操作已加载页面的 DOM 的能力，那么由于跨域安全策略，简短的回答是“否”。

您仍然可以通过使用 iframe 或更兼容的方式来集成内容`<object data="http://omn.orgfree.com/" type="text/html" />`，并且有诸如[window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)之类的协议允许客户端跨域通信。整合必须由双方完成。

同样，假设对方可以协助集成或者您可以直接控制其他域的内容，您可以将[JSONP](http://api.jquery.com/jQuery.getJSON/)与 ajax 请求一起使用——从技术上讲，任何 html 都可以通过这种方式进行序列化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T01:41:06.307

我不这么认为。用户只能加载其目录中的那些网页。但是，此功能可以通过服务器端方法（在 c# 的情况下）来实现。

# c++ - 奇怪的链接器错误

> ID：10729995
> 
> 赞同：0
> 
> 时间：2012-05-24T01:22:39.390
> 
> 标签：c++, linker, cmake, linker-errors

```
#include path
include_directories(
${PROJECT_SOURCE_DIR}/include
${HGE_INCLUDE_DIR}
${IKL_INCLUDE_DIR}
${BOOST_DIRECTORY}
)

#include all files
FILE(GLOB CORE_SRCS source/core/*.cpp)
FILE(GLOB TOOL_SRCS source/tools/*.cpp)
FILE(GLOB GAME_SRCS source/game/*.cpp)

#Making a compiled library
add_library(GAMECORE_LIBRARY ${CORE_SRCS} ${HGE_LIBRARY} ${HGE_HELPER_LIBRARY})

#add executable
add_executable(DemoGame ${GAME_SRCS})

##link executable to HGE lib
TARGET_LINK_LIBRARIES(DemoGame ${HGE_LIBRARY} ${HGE_HELPER_LIBRARY} ${IKL_LIBRARY} GAMECORE_LIBRARY)

if(BUILD_TOOLS)
add_executable(EntityTool ${TOOL_SRCS})
TARGET_LINK_LIBRARIES(EntityTool ${HGE_LIBRARY} ${HGE_HELPER_LIBRARY} ${IKL_LIBRARY} GAMECORE_LIBRARY)
endif(BUILD_TOOLS) 
```

这是我目前的 cmake ..

我收到 hgeGUI 类的奇怪链接器错误，
例如：DemoGame/source/core/GameMainMenu.cpp:74: undefined reference to `hgeGUI::hgeGUI()'

这只发生在我尝试将核心文件编译成静态库时。当我使用 CORE_SRCS 添加可执行文件并删除对当前编译库的依赖项时..它将正常工作..

我还尝试将 hgegui.cpp 文件复制粘贴到我的核心源目录中..并将其更改`#include "..\..\include\hgegui.h"`为`#include "hgegui.h"`

之后我的链接器代码解决了这个问题，但我得到了分段错误，但我猜在上一步中链接文件是不正确的..

这是他们的 .h 文件的链接
[http://trac.assembla.com/snowscape/browser/hge/include/hgegui.h](http://trac.assembla.com/snowscape/browser/hge/include/hgegui.h)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:36:11.490

看起来你在滥用`${HGE_LIBRARY}`and`${HGE_HELPER_LIBRARY}`变量。

在`add_library`调用中，您包含构成该库的所有源文件。

在`target_link_libraries`调用中，您指定链接目标时要使用的库或标志。

因此，如果`${HGE_LIBRARY}`并`${HGE_HELPER_LIBRARY}`指定要指定为依赖项的库的路径，则`GAMECORE_LIBRARY`需要执行以下操作：

```
add_library(GAMECORE_LIBRARY ${CORE_SRCS})
target_link_libraries(GAMECORE_LIBRARY ${HGE_LIBRARY} ${HGE_HELPER_LIBRARY}) 
```

依赖关系是可传递的，因此这意味着当您指定`GAMECORE_LIBRARY`为`DemoGame`and的依赖关系时`EntityTool`，CMake 会识别`${HGE_LIBRARY}`and`${HGE_HELPER_LIBRARY}`也是依赖关系，因此您可以根据需要从`target_link_libraries`调用中`DemoGame`删除它们`EntityTool`。

有关 and 的更多信息`add_library`，请`target_link_libraries`运行：

```
cmake --help-command add_library
cmake --help-command target_link_libraries 
```