# StackOverflow 问答 000846000-000846999

# seo - 我改变了我的文件扩展名，但谷歌没有改变

> ID：846006
> 
> 赞同：0
> 
> 时间：2009-05-10T20:00:33.960
> 
> 标签：seo

好吧，我将文件扩展名更改为 .shtml，谷歌仍然将它们索引为 .html。我尝试将站点地图和其他内容上传到谷歌网站管理员工具，但没有成功。有没有其他方法可以强制谷歌抓取我的网站？我猜那是链接更新的唯一方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T20:22:10.367

您是否设置了从旧的 .html 文件名到新的 .shtml 文件名的重定向？您应该这样做 - Google 会更快地获取您的更改（因为它不必再次发现您的所有页面）并将 PageRank 从旧 URL 转移到新 URL。网上有[一百万条](http://www.google.com/search?q=htaccess+redirect+moved)关于如何做到这一点的描述。

但是话虽如此，难道你不能只保留 .html 文件名并使用 .htaccess （或等效的；你没有说你正在使用哪个 Web 服务器）来使 .html 文件尊重 SSI 指令吗？这：

```
AddType text/html .html
AddHandler server-parsed .html 
```

应该为 Apache 做这件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T20:03:27.373

您可以尝试将更改频率设置为始终或更频繁，以便更快地被索引。不过我不保证。否则，您将不得不像我们其他人一样等待。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T21:24:33.947

如果您的网站获得了一些流量，那么 Googlebot 很可能已经访问过。我的网站不大，每天都会被抓取。您可以确定 Google 已经知道您的新网址。

问题是谷歌每 3-4 周左右才更新一次它的索引。有一些例外情况，例如定期更新的博客和论坛，新线程和帖子会很快被收录。但通常可能需要几周时间，您的新 URL 才会出现在主搜索索引中。

哦，还有一个提示：如果您有重写规则将旧的 .html 地址重定向到新的 .shtml 地址，请确保使用 301 重定向而不是 302 重定向。通过 301 重定向，Google 会将旧 URL 的“链接汁”分配给新 URL。使用 302 重定向它不会这样做，并且您可能会丢失 pagerank。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T20:02:23.630

Google 会定期抓取网页，稍等片刻，它会重新索引您的网站。

# c++ - Qt 中使用的 C++ 语言有多现代？

> ID：846015
> 
> 赞同：10
> 
> 时间：2009-05-10T20:07:54.260
> 
> 标签：c++, api, qt

我听说 Qt API 是用相当过时的 C++ 语言编写的。这是真的吗？
有没有计划让它使用更现代的 C++ 语言？有这方面的官方信息吗？

是否有任何项目旨在用更现代的 C++ 包装当前的 Qt API 结构？

更新
这个问题比模板更重要，这不仅仅是关于当前事态的问题（这就是我用*未来*标签标记它的原因）。

更新
我特别关心 Qt API，因为这是该框架的用户使用的。
在 API 中使用现代 C++ 语言使其**更加健壮、灵活且易于使用**。
在 Qt 中使用什么样的 C++ 对我来说远没有那么重要。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-10T20:17:20.483

众所周知，Qt 不使用模板，这是一项非常有用的现代 c++ 功能。但这并不意味着需要对 Qt 的 API 进行包装。Qt 使用内部预编译器来解决相同的问题。有些人不喜欢这种方法，但 Qt 的 API 非常简单和高效，我认为没有真正需要对其进行现代化改造。特别是，Qt 中一个非常令人印象深刻的特性信号和插槽可以使用模板来实现（参见[boost.signals](http://www.boost.org/doc/libs/1_39_0/doc/html/signals.html)库），但是 Qt 实现它的方式仍然要高效得多。

我会说“别担心，照原样使用 Qt”。

编辑：对不起，我忘记了 Qt 提供的模板容器。但是，Qt 的 API 仍然很少使用模板类。这并不意味着他们不在 Qt 中使用它们，或者他们的编码方式已经过时。

Boost.Signals 可能比 Qt 信号/插槽更强大，但据我所知，没有争论哪个更容易使用。一个非常令人信服的[KISS 原则](http://en.wikipedia.org/wiki/KISS_principle)实施。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-12T06:51:07.973

Qt 使用 C++ 语言的现代变体——目前是 C++98，是的，模板也用于适当的地方。Qt 对 STL 有一些支持。请参阅例如[http://qt-project.org/doc/qt-5.1/qtcore/containers.html](http://qt-project.org/doc/qt-5.1/qtcore/containers.html) - 以及例如 std::string 的便利功能。这一切都在文档中：http: [//qt-project.org/doc/qt-5.1/qtdoc/index.html](http://qt-project.org/doc/qt-5.1/qtdoc/index.html) ;) 关于模板与 moc 的问题是我们经常遇到的问题，我们已将其添加到我们的文档中；[http://qt-project.org/doc/qt-4.8/templates.html](http://qt-project.org/doc/qt-4.8/templates.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-11T14:48:57.503

Qt 源代码仅在 src/corelib 中包含 1280 次模式“模板 <”。我看不出这怎么会被误认为“已知 Qt 不使用模板”

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-13T05:21:42.057

与 Boost.Signals 不同，Qt 的信号/槽实现通过使用排队连接是线程安全的。然而，在 2009 年 5 月 2 日，Boost.Signals2 发布，并带来了非常需要的线程安全性。从开发人员的角度来看，Qt 的信号/槽实现更容易使用，主要是因为它不使用模板。要深入了解为什么 Qt 使用 moc 而不是信号和插槽的模板，[这里是](http://doc.trolltech.com/4.5/templates.html)他们文档中的一个页面。

对于那些想知道为什么 Qt 有自己的容器类集的人，我很确定主要动机是提供隐式共享。所有容器类都是隐式共享的，因此无论何时复制 QList，都只会复制指向数据的指针。有关 Qt 中浅拷贝的更多信息，请参见[此处](http://doc.trolltech.com/4.5/shared.html)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-22T08:00:26.400

为了直接回答您的问题，Qt 的 API 很*全面*。我很确定他们会在某个时候推出 QApp::ParkMyCar() 函数。他们有时会采用多种方式来做同一件事，在效率和易用性方面有不同的立场。查看他们的（优秀的）文档。它同样全面，并且不止一次救了我的屁股。

从我看到的 Qt 源代码来看，该代码非常高效。
查看安装配置中的功能 - 您可以打开/关闭对各种功能（包括 STL、线程甚至 GUI）的支持。此外，当 Trolls 开发 Qt 4 时，他们并没有在功能与代码爵士乐之间进行权衡——他们只是提供了两者的更多功能。鉴于他们的程序员的素质和他们更新主要版本的方式，我认为我们不必担心 Qt（或部分）过时。

Qt 的目标市场（台式机）是制造 Hello Kitty 台式闹钟的 MamaPapa 公司，并且想要*一次编码*并放心它可以在所有“正常”系统上运行——Windows 98 及更高版本、流行的 Linux 发行版和 Mac OS X。这意味着迎合各种系统中所有主要编译器的 LCD。如果这意味着将代码中的模板向导保持在最低限度，那就这样吧。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-11T17:23:44.827

我真的不喜欢 Qt 设法实现其信号/插槽机制的方式。他们的 'moc' 预编译器对我来说真的像 hack，它甚至不支持标准 C++。

我认为如果 Qt 能够自我现代化以至少使用 STL 类，那就太好了。Qt 尽可能使用 Boost（尤其是 Boost.Signals）才是真正棒的事。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-26T21:18:49.033

在 Qt 4.x 的整个生命周期中，我怀疑重写部分 Qt 以使用例如“更现代”的 C++ 是否有意义。这是因为前提是同一 Qt 主要版本中的所有版本仍然应该是[二进制兼容](http://www.qtsoftware.com/developer/faqs/560)的。我们也不能仅仅废弃或弃用客户仍在使用的类（尽管引入新东西是完全可以的，即使对于有限的支持编译器集也是如此）。

如果最后 Qt 5 几乎要问世了，现代 C++ 结构和特性终于可以在目标支持的平台和编译器中使用，这样做将帮助 C++ 开发人员和客户编写更好、更强大的代码，那为什么不呢？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-11T00:24:44.840

我也不喜欢 Qt 向 C++ 添加巫术魔法的方式。它使用了如此多的宏，以至于让我想起了 C。目前，没有任何迹象表明 Qt 将来会对 C++ 特性更友好。我真的很想看到它更像 C++ 而不是它自己的语言（例如，为什么我们需要 std::vector<> 和 QVector<>？或者 Qt 信号、Boost.Signals 和 sigc++？）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-11T05:33:33.400

Qt 是一个库，需要支持广泛的编译器。它仍然支持 MSVC6，例如（我认为 Qt Software 正在逐步取消对此的支持）。这限制了 Qt 能够使用的更现代的 C++ 功能。

但这并不意味着您不能在 Qt 程序中使用它们。

# gdb - GDB断点相同的功能出现更多次

> ID：846017
> 
> 赞同：1
> 
> 时间：2009-05-10T20:08:32.450
> 
> 标签：gdb

使用gdb，我遇到了一个奇怪的问题：有一个方法出现了3次：

```
(gdb) b Logger::Logger
[0] cancel
[1] all
[2] Logger at src/Logger.cpp:52
[3] Logger at src/Logger.cpp:52
[4] Logger at src/Logger.cpp:52 
```

从这三个实例都在文件 Logger.cpp 的第 552 行这一事实可以推断，它们实际上指的是相同的方法。这是什么意思？Logger::Logger 构造函数是否意外进入二进制文件 3 次，或者这是一个 gdb 错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T22:11:15.527

最新版本的 GCC（和许多其他编译器）创建了多个[版本](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=3187#c2)的构造函数和析构函数。

GDB 中有一个错误，它忽略了在所有版本上设置断点，这导致您的断点根本不会触发。现在，修正了 GDB 错误后，您将获得多个断点。

选择`all`，然后执行`info break`，注意这3个断点的地址都是不同的，实际上是在不同的函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T01:25:31.823

该方法被内联是因为`gcc`认为它会执行得更好，或者它被用于以多种方式实例化的模板中。任一路径都可能导致可执行二进制文件中有多个版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-14T03:17:40.380

您可以使用“信息中断”并禁用，启用可能设置为同一行的断点....但是，您还应该知道，step vs. stepi（stepi 将执行单个机器代码指令，而不是按源代码级别，是步骤的作用）。

你也可以c#，继续特定的次数，通过那个断点......所以如果它是循环中的1个断点，正在评估3次，你去c 3，你将通过这个特定的循环。 ..

# php - 如何从 PHP 访问表单的“名称”变量

> ID：846020
> 
> 赞同：27
> 
> 时间：2009-05-10T20:10:43.413
> 
> 标签：php, forms

我正在尝试创建一个 BMI 计算器。这应该允许人们使用公制或英制测量。

我意识到我可以使用隐藏标签来解决我的问题，但这之前一直困扰着我，所以我想我会问：我可以使用`$_POST['variableName']`来查找提交的 variableName field-value; 但是...我不知道或不知道如何验证*用于*提交变量的表单。

我的代码如下（尽管我不确定它是否与问题严格相关）：

```
<?php
    $bmiSubmitted     = $_POST['bmiSubmitted'];

    if (isset($bmiSubmitted)) {
        $height        = $_POST['height'];
        $weight        = $_POST['weight'];
        $bmi        = floor($weight/($height*$height));

        ?>
            <ul id="bmi">
            <li>Weight (in kilograms) is: <span><?php echo "$weight"; ?></span></li>

            <li>Height (in metres) is: <span><?php echo "$height"; ?></span></li>

            <li>Body mass index (BMI) is: <span><?php echo "$bmi"; ?></span></li>

            </ul>
        <?php
    }

    else {
    ?>

    <div id="formSelector">

    <ul>
        <li><a href="#metric">Metric</a></li>
        <li><a href="#imperial">Imperial</a></li>
    </ul>

        <form name="met" id="metric" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post" enctype="form/multipart">

            <fieldset>
                <label for="weight">Weight (<abbr title="Kilograms">kg</abbr>):</label>
                    <input type="text" name="weight" id="weight" />

                <label for="height">Height (<abbr title="metres">m</abbr>):</label>
                    <input type="text" name="height" id="height" />

                <input type="hidden" name="bmiSubmitted" id="bmiSubmitted" value="1" />
            </fieldset>

            <fieldset>
                <input type="reset" id="reset" value="Clear" />

                <input type="submit" id="submit" value="Submit" />
            </fieldset>
        </form>

        <form name="imp" id="imperial" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post" enctype="form/multipart">

            <fieldset>

            <label for="weight">Weight (<abbr title="Pounds">lbs</abbr>):</label>
                <input type="text" name="weight" id="weight" />

            <label for="height">Height (Inches):</label>
                <input type="text" name="height" id="height" /
            <input type="hidden" name="bmiSubmitted" id="bmiSubmitted" value="1" />
            </fieldset>

            <fieldset>
                <input type="reset" id="reset" value="Clear" />
                <input type="submit" id="submit" value="Submit" />
            </fieldset>
        </form>

    <?php
    }
?> 
```

我用度量验证了它的工作原理（尽管目前没有验证-我不想过多地回答我的问题）；我已经添加了表格，但还没有为帝国添加处理。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-10T20:13:37.183

要识别提交的表单，您可以使用：

*   隐藏的输入字段。
*   提交按钮的名称或值。

表单的名称不会作为[POST](https://en.wikipedia.org/wiki/POST_%28HTTP%29)数据的一部分发送到服务器。

您可以使用如下代码：

```
<form name="myform" method="post" action="" enctype="multipart/form-data">
    <input type="hidden" name="frmname" value=""/>
</form> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-19T13:13:04.460

你可以这样做：

```
<input type="text" name="myform[login]">
<input type="password" name="myform[password]"> 
```

检查发布的值

```
if (isset($_POST['myform'])) {
    $values = $_POST['myform'];

    // $login = $values['login'];
    // ...
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-10T20:12:27.247

未提交表单名称。您应该只在每个表单中添加一个隐藏字段并收工。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-08T08:48:22.347

在表单提交按钮中（表单的id方法为`post`）：

```
<input type="submit" value="save" name="commentData"> 
```

在 PHP 文件中：

```
if (isset($_POST['commentData'])){
    // Code
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-18T16:09:21.843

由于某种原因，当使用 Ajax/jQuery 提交时，提交按钮的名称没有传递给超全局[$_POST 。](https://www.php.net/manual/en/reserved.variables.post.php)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-03-28T20:48:56.187

像这样在每个表单的提交按钮上使用唯一值

### 文件*index.html*

```
<form method="post" action="bat/email.php">
    <input type="text" name="firstName" placeholder="First name" required>
    <input type="text" name="lastName" placeholder="Last name" required>
    <button name="submit" type="submit" value="contact">Send Message</button>
</form>

<form method="post" action="bat/email.php">
    <input type="text" name="firstName" placeholder="First name" required>
    <input type="text" name="lastName" placeholder="Last name" required>
    <button name="submit" type="submit" value="support">Send Message</button>
</form> 
```

### 文件*email.php*

```
<?php
    if (isset($_POST["submit"])) {
        switch ($_POST["submit"]) {
            case "contact":
                break;
            case "support":
                break;
            default:
                break;
        }
    }
?> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-08T05:18:32.050

正如[petervandijck.com](https://stackoverflow.com/users/22192/petervandijck-com)指出的那样，如果您将其置于某种登录系统后面或将其嵌入其他代码中，则该代码可能容易受到 XSS 攻击。

为了防止 XSS 攻击，您在其中编写了：

```
<?php echo "$weight"; ?> 
```

你应该改写：

```
<?php echo htmlentities($weight); ?> 
```

甚至可以更好地写成：

```
<?=htmlentities($weight); ?> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-25T11:08:12.133

您可以在表单的操作参数中使用 GET，每当我创建登录/注册组合页面时都会使用该参数。

例如：`action="loginregister.php?whichform=loginform"`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-06-24T12:09:13.693

我有一个类似的问题，这让我想到了这个问题。我查看了所有前面的答案，但最终我找到了自己的解决方案：

```
<form name="ctc_form" id="ctc_form" action='' method='get'>

    <input type="hidden" name="form_nm" id="form_nm">

    <button type="submit" name="submit" id="submit" onclick="document.getElementById('form_nm').value=this.closest('form').name;">Submit</button>

</form> 
```

它无缝且高效地完成了以下任务：

*   **通过隐藏的输入**字段传递表单**名称**属性，而不使用**提交**按钮的错误**值**属性。
*******   适用于[GET](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)和[POST](https://en.wikipedia.org/wiki/POST_%28HTTP%29)方法。*   不需要额外的、独立的 JavaScript。******

 ******* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-10T20:13:02.973

只提交表单字段的名称，但不提交表单本身的名称。但是您可以设置一个隐藏字段，其中包含名称。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-14T01:44:20.860

您可以只为提交按钮命名，然后根据该名称执行需要完成的操作。我在一个页面上有几个表格，我就是这样做的。传递按钮名称，然后如果按钮名称 = 按钮名称做某事。

# xml - 使用 XQuery 获取复杂混合元素的字符串内容

> ID：846035
> 
> 赞同：1
> 
> 时间：2009-05-10T20:23:04.360
> 
> 标签：xml, xquery

例如，有一个xml：

```
<article-list xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="3.xsd">
    <article section="physics">
        Increasing linear dynamic range of commercial digital photocamera
        <author>M. V. Konnik</author>
        <content>
            Methods of increasing linear optical dynamic range
        </content>
    </article> 
```

我的目标是查询`article`元素的字符串内容。IE：

```
Increasing linear dynamic range of commercial digital photocamera 
```

像这样的明显解决方案：

```
<!--xquery-->
{
for $article in doc("name.xml")//article-list/article
    where $article/receiving-date > xs:date("2005-01-01")
    return
        <article>
            {$article}
        </article>
} 
```

返回整个`article`树，而不仅仅是一个字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T20:44:32.967

$article 是一个元素，而不是一个节点。要获取文本（您想要的文本实际上是 $article 节点的文本子节点），您只需要：

```
 {$article/text()} 
```

# python - 将 Python int 转换为大端字节串

> ID：846038
> 
> 赞同：76
> 
> 时间：2009-05-10T20:24:01.317
> 
> 标签：python

我有一个非负整数，我想有效地将​​它转换为包含相同数据的大端字符串。例如，int 1245427（即 0x1300F3）应生成一个长度为 3 的字符串，其中包含三个字节值分别为 0x13、0x00 和 0xf3 的字符。

我的整数是 35 (base-10) 位数。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-10T20:27:59.313

您可以使用[结构](http://docs.python.org/library/struct.html)模块：

```
import struct
print(struct.pack('>I', your_int)) 
```

`'>I'`是一个格式字符串。`>`表示大端，`I`表示无符号整数。检查文档以获取更多格式字符。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-10-12T13:15:51.633

在 Python 3.2+ 中，您可以使用[int.to_bytes](http://docs.python.org/py3k/library/stdtypes.html#int.to_bytes)：

## 如果您不想指定尺寸

```
>>> n = 1245427
>>> n.to_bytes((n.bit_length() + 7) // 8, 'big') or b'\0'
b'\x13\x00\xf3' 
```

## 如果您不介意指定尺寸

```
>>> (1245427).to_bytes(3, byteorder='big')
b'\x13\x00\xf3' 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-10T20:44:32.657

这很快并且适用于小型和（任意）大型整数：

```
def Dump(n): 
  s = '%x' % n
  if len(s) & 1:
    s = '0' + s
  return s.decode('hex')
print repr(Dump(1245427))  #: '\x13\x00\xf3' 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-10T20:42:47.590

可能最好的方法是通过内置的[struct 模块](http://docs.python.org/library/struct.html)：

```
>>> import struct
>>> x = 1245427
>>> struct.pack('>BH', x >> 16, x & 0xFFFF)
'\x13\x00\xf3'
>>> struct.pack('>L', x)[1:]  # could do it this way too
'\x13\x00\xf3' 
```

或者——我通常不会推荐这个，因为它容易出错——你可以通过 shift 和`chr()`函数“手动”完成它：

```
>>> x = 1245427
>>> chr((x >> 16) & 0xFF) + chr((x >> 8) & 0xFF) + chr(x & 0xFF)
'\x13\x00\xf3' 
```

出于好奇，为什么只需要三个字节？通常你会将这样一个整数打包成一个完整的 32 位（a C `unsigned long`），然后使用`struct.pack('>L', 1245427)`但跳过这`[1:]`一步？

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-10T20:43:23.033

```
def tost(i):
  result = []
  while i:
    result.append(chr(i&0xFF))
    i >>= 8
  result.reverse()
  return ''.join(result) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-02-15T09:33:07.600

基于[@pts 答案](https://stackoverflow.com/a/846067/4279)的单源 Python 2/3 兼容版本：

```
#!/usr/bin/env python
import binascii

def int2bytes(i):
    hex_string = '%x' % i
    n = len(hex_string)
    return binascii.unhexlify(hex_string.zfill(n + (n & 1)))

print(int2bytes(1245427))
# -> b'\x13\x00\xf3' 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-20T04:39:56.763

我认为最短的方法如下：

```
import struct
val = 0x11223344
val = struct.unpack("<I", struct.pack(">I", val))[0]
print "%08x" % val 
```

这会将整数转换为字节交换的整数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-21T20:37:12.397

使用[位串](http://code.google.com/p/python-bitstring/)模块：

```
>>> bitstring.BitArray(uint=1245427, length=24).bytes
'\x13\x00\xf3' 
```

请注意，对于此方法，您需要指定正在创建的位串的位长度。

在内部，这与亚历克斯的回答几乎相同，但是如果您想对数据做更多的事情，该模块有很多额外的功能可用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-11-20T00:50:52.687

非常容易使用`pwntools`，为软件黑客创建的工具

（具有讽刺意味的是，我偶然发现了这个线程并在这里尝试了解决方案，直到我意识到 pwntools 中存在转换功能）

```
import pwntools

x2 = p32(x1) 
```

# javascript - Rails在link_to_function部分中转义引号

> ID：846040
> 
> 赞同：0
> 
> 时间：2009-05-10T20:25:42.203
> 
> 标签：javascript, ruby-on-rails

我有一小段 Rails 代码可以让用户输入评论。如果已经写了一篇，它会显示当前评论以及编辑链接。

```
 <div id="text_area">
        <% if @user_rating.review.blank? %>
          <%= render :partial => "reviews/text_area" %>
        <% else %>
          <%= simple_format @user_rating.review %>
          <%= link_to_function "Edit Review" do |page|
            page.replace_html :text_area, :partial => "reviews/text_area"
          end %>
        <% end %>
      </div> 
```

这可以正常工作，除非评论包含双引号字符。这是用户写完评论后生成的 HTML 输出（上面的 else 块）。

```
 <div id="text_area">
          <p>some text with "quotation marks"</p>
          <a href="#" onclick="try {
Element.update(&quot;text_area&quot;, &quot;&lt;form action=\&quot;/pages/iphone-reviews/reviews/new/write\&quot; class=\&quot;edit_rating\&quot; id=\&quot;edit_rating_16\&quot; method=\&quot;post\&quot;&gt;&lt;div style=\&quot;margin:0;padding:0\&quot;&gt;&lt;input name=\&quot;_method\&quot; type=\&quot;hidden\&quot; value=\&quot;put\&quot; /&gt;&lt;input name=\&quot;authenticity_token\&quot; type=\&quot;hidden\&quot; value=\&quot;fSZK30kpWEUtCxOvr4xDF1O+puDiPm87mhaxaLirIT8=\&quot; /&gt;&lt;/div&gt;\n        &lt;textarea cols=\&quot;40\&quot; id=\&quot;rating_review\&quot; name=\&quot;rating[review]\&quot; rows=\&quot;20\&quot; style=\&quot;width:100%;height:150px;\&quot;&gt;some text with &quot;quotation marks&quot;&lt;/textarea&gt;\n&lt;/form&gt;&quot;);
} catch (e) { alert('RJS error:\n\n' + e.toString()); alert('Element.update(\&quot;text_area\&quot;, \&quot;&lt;form action=\\\&quot;/pages/iphone-reviews/reviews/new/write\\\&quot; class=\\\&quot;edit_rating\\\&quot; id=\\\&quot;edit_rating_16\\\&quot; method=\\\&quot;post\\\&quot;&gt;&lt;div style=\\\&quot;margin:0;padding:0\\\&quot;&gt;&lt;input name=\\\&quot;_method\\\&quot; type=\\\&quot;hidden\\\&quot; value=\\\&quot;put\\\&quot; /&gt;&lt;input name=\\\&quot;authenticity_token\\\&quot; type=\\\&quot;hidden\\\&quot; value=\\\&quot;fSZK30kpWEUtCxOvr4xDF1O+puDiPm87mhaxaLirIT8=\\\&quot; /&gt;&lt;/div&gt;\\n        &lt;textarea cols=\\\&quot;40\\\&quot; id=\\\&quot;rating_review\\\&quot; name=\\\&quot;rating[review]\\\&quot; rows=\\\&quot;20\\\&quot; style=\\\&quot;width:100%;height:150px;\\\&quot;&gt;some text with &quot;quotation marks&quot;&lt;/textarea&gt;\\n&lt;/form&gt;\&quot;);'); throw e }; return false;">Edit Review</a>

      </div> 
```

此示例中断，因为评论的文本包含双引号。它适用于单引号和我能想到的任何其他文本。我认为 rails 没有在 javascript 中正确转义双引号。

Firebug 中出现的错误是这样的：

> 缺少 ) 在参数列表后 [打破此错误] \" id=\"rating_review\" name=\"rating[re...n:right;\">\n

我不知道如何解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T19:56:55.823

找到了一个有效的解决方案。我不太确定它为什么起作用，但它确实起作用了。

在上面几次我调用部分来呈现文本区域和表单，用户可以在其中编辑他们的评论，就像这样

```
<%= render :partial => "reviews/text_area" %> 
```

我所要做的就是进去编辑这个部分。表单中的一行如下所示：

```
<%= f.text_area :review %> 
```

我所做的只是将其更改为：

```
<textarea cols="40" id="rating_review" name="rating[review]" rows="20"><%=@user_rating.review%></textarea> 
```

基本上只是手动放入，所以它没有使用 rails 函数来生成文本区域。无论出于何种原因，它现在有效。可能是可以在 rails text_area 函数中改进的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T11:22:28.243

您可以编写一个 javascript 转义助手：

```
def escape_javascript(javascript)
        javascript.gsub!("\r\n", "\\n")
        javascript.gsub!(/\n|\r/, "\\n")
        javascript.gsub(/["']/) {|m| "\\#{m}"} || javascript
end 
```

并在您保存评论时调用它。

# c# - 这个“接口编程”是如何工作的？

> ID：846041
> 
> 赞同：4
> 
> 时间：2009-05-10T20:25:43.200
> 
> 标签：c#, oop, interface, solid-principles

我喜欢“为接口编程”的想法，并避免使用“new”关键字。

但是，当我有两个具有相同接口但设置根本不同的类时，我该怎么办。在不详细介绍我的特定代码的情况下，我有一个带有方法“DoStuff”的接口。两个类实现了这个接口。一个非常简单，不需要初始化。另一个有五个不同的变量需要设置。当它们组合在一起时，当调用 DoStuff 时，它们允许类以数百万种方式工作。

那么我什么时候“新”这些课程呢？我虽然关于使用工厂，但我认为它们不适合这种情况，因为设置存在巨大差异。（顺便说一句：实际上有大约十个不同的类使用该接口，每个类都允许形成复杂管道的一部分，并且每个类都有不同的配置要求）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T20:34:10.067

我认为您可能误解了对接口进行编程的概念。您总是必须`new`在面向对象的语言中使用关键字来创建对象的新实例。仅仅因为您对接口进行编程并不能消除该要求。

对接口进行编程仅仅意味着所有具体类的行为都在接口中定义，而不是在具体类本身中定义。因此，当您定义变量的类型时，您将其定义为接口而不是具体类型。

在您的情况下，只需`DoStuff`在您的具体类中实现，因为每个类都需要实现（无论是简单地实现还是使用其他 10 个初始化对象和设置）。例如，如果您有`IInterface`一个`SomeClass`实现`IInterface`. 你可以`SomeClass`这样声明一个实例：

```
IInterface myInstance = new SomeClass(); 
```

这允许您将此实例传递给其他函数，而不必让这些函数担心该实例类的实现细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T20:43:47.477

那么你真的有3个选择。使用新的、使用工厂或使用 DI 容器。使用 DI 容器，您的五个变量很可能需要位于某种配置文件中。

但老实说，这听起来像是你把自己逼到角落里，让你的生活变得比需要的更艰难。与其按照某种理想进行编码，不如以最有助于解决手头问题的方式进行编码。不是说你应该对它进行破解，而是说你不想使用新的，这真的让你的生活变得比它需要的更难......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T20:31:18.200

不管你使用什么，在某些时候你将不得不构造你的类的实例才能使用它们，这是没有办法的。

如何去做这取决于你想要完成什么，以及这些类的语义。

参加你提到的那些领域的课程。

可以从某个地方读取这些字段吗？一个配置文件，例如？如果是这样，也许您所需要的只是一个默认构造函数，它从这样的配置文件中初始化这些字段。

但是，如果这些字段的内容真的需要从外部传入，那就没有办法了。

也许你应该看看 IoC 容器和依赖注入？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T19:33:13.993

如果您将这么多配置参数传递到您的类中，它可能有太多责任。您应该考虑将其分解为仅具有单一职责的较小类。

避免使用 new 关键字可能很有价值，因为它会产生对实现类的依赖。更好的解决方案是使用依赖注入。

例如

```
public interface IDoStuff
{
    void DoStuff();
}

public class DoStuffService
{
    private IDoStuff doer;

    public DoStuffService()
    {
        //Class is now dependant on DoLotsOfStuff
        doer = new DoLotsOfStuff(1,true, "config string");
    }
}

public class DoStuffBetterService
{
    private IDoStuff doer;

    //inject dependancy - no longer dependant on DoLotsOfStuff
    public DoStuffBetterService(IDoStuff doer)
    {
        this.doer = doer;
    }
} 
```

显然，您仍然必须创建在某处传递的 IDoStuff 对象。控制反转 (IoC) 容器是帮助实现这一点的好工具。如果您有兴趣了解更多信息，这里是[Castle Windsor Container的一个很好的教程。](http://dotnetslackers.com/articles/designpatterns/InversionOfControlAndDependencyInjectionWithCastleWindsorContainerPart1.aspx)（还有很多其他的 IoC 容器，我只是碰巧使用了这个。）

您问题中的示例非常抽象，所以我希望这个答案会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-20T15:58:41.167

如果我理解正确，问题在于不同的初始化。您需要提供两个具有相同接口的类。一个不需要任何东西，另一个需要一些参数并调用一些复杂的初始化。

您应该使用获取 InitializationParameter 的构造函数。两个班级都应该得到它。一个具有简单界面的界面，不需要从中获取任何内容。另一个需要参数并将从中获取它们。

如果您担心初始化，您可以使用工厂，只需向它询问一些提供此 init 参数的接口，工厂将根据您提供的值创建、初始化并返回对象。

如果有什么不清楚 - 请询问。

# c# - 应用程序池错误

> ID：846042
> 
> 赞同：4
> 
> 时间：2009-05-10T20:26:54.260
> 
> 标签：c#, asp.net, wcf, iis-7

在我的 IIS 7 应用程序服务器上收到此错误。

*“为应用程序池 '%1' 提供服务的进程与 Windows 进程激活服务发生了致命的通信错误”*

我该如何解决这个问题？

谢谢阅读。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T20:55:05.493

看起来 IIS 工作进程正在崩溃。如果您有多个站点/应用程序在同一个 AppPool 上运行，我会先将它们一次隔离到单独的 AppPools 中。您可能会以这种方式找到导致问题的原因，这应该为您提供一个开始寻找的地方。

除此之外，我想我会看看使用 adplus 来获取 AppPool 进程的崩溃转储，然后在 WinDBG 中运行它以查看出现了什么。那里有一些很好的资源。应该帮助您入门的两个是[this](http://msdn.microsoft.com/en-us/library/ms954594.aspx)和[this](http://support.microsoft.com/kb/892277)。它们有点过时了，但基本机制应该仍然基本相同。

# c++ - 如何获取 DLL 的文件名？

> ID：846044
> 
> 赞同：6
> 
> 时间：2009-05-10T20:27:23.293
> 
> 标签：c++, windows, dll

我有一个加载多个插件的 C++ Windows 应用程序 myapp.exe。

插件需要找到其 DLL 的路径。我可以为此使用 GetModuleFileName，但它需要插件 DLL 的句柄。我不知道从哪里得到这个手柄。GetModuleHandle(NULL) 返回可执行文件的句柄。

一种选择是使用 GetModuleHandle (GetModuleHandle("myplugin.dll") ) ，但这需要对插件的名称进行硬编码，这是我想避免的。

任何帮助表示赞赏。

保罗

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T20:34:46.447

> 我不知道从哪里得到这个手柄

它作为参数传递给您的 DLLMain() 入口函数。

如果插件不能访问它的DLLMain()入口函数，它可以在它自己的一块内存上使用VirtualQuery函数，并使用填充的MEMORY_BASIC_INFORMATION结构的AllocationBase字段作为它的HMODULE。

# c# - C# 开发人员了解 IIS 有多重要？

> ID：846046
> 
> 赞同：2
> 
> 时间：2009-05-10T20:28:21.700
> 
> 标签：c#, asp.net, iis

C# 开发人员必须在多大程度上了解 IIS？所需的最低领域/知识？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-10T20:32:58.010

这完全取决于上下文。如果您不使用 ASP.NET，那么您真的根本不需要知道它 :)

如果您正在使用 ASP.NET，但您有系统管理员将与您一起找出您的需求并管理所有工作程序池等，那么您不需要知道很多。（尽管我想说了解 AppDomain 回收、会话、横向扩展和向上扩展方面的基础知识很重要。）

如果您要自己部署它，我会看看：

*   工作器池
*   模拟和权限（您将作为谁运行）
*   AppDomain 回收
*   会话管理
*   负载平衡以及它将如何影响您的特定情况
*   其他 IIS 选项，例如压缩

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T21:03:29.880

除了 Jon Skeet 所说的：

[从 IIS7 开始，您可以使用 .NET 编写的模块/处理程序](http://learn.iis.net/page.aspx/366/developing-iis-70-modules-and-handlers-with-the-net-framework/)做比以前更多的事情。[因此，查看IIS7 架构](http://learn.iis.net/page.aspx/101/introduction-to-iis7-architecture/)和[请求处理](http://learn.iis.net/page.aspx/101/introduction-to-iis7-architecture/#Request)可能是一个好主意（我不得不说，我还没有详细查看这些内容，但它在我的列表中）。

# sql - COUNT 在具有多个 JOINS 和 GROUP BY CLAUSE 的查询中

> ID：846047
> 
> 赞同：2
> 
> 时间：2009-05-10T20:28:46.083
> 
> 标签：sql, mysql, join, count

我正在开发一个包含 3 个表的数据库：

1.  公司名单
2.  他们销售的产品表
3.  他们在每个日期提供的价格表

我正在我的 php 中进行这样的查询，以生成在特定日期以特定产品类型提供最低价格的公司列表。

```
SELECT
  a.name AS company,
  c.id,
  MIN(c.price) AS apy
FROM `companies` a
JOIN `company_products` b ON b.company_id = a.id
JOIN `product_prices` c ON c.product_id = b.id
WHERE
  b.type = "%s"
  AND c.date = "%s"
GROUP BY a.id
ORDER BY c.price ASC
LIMIT %d, %d 
```

这为我提供了所需的数据，但为了在 PHP 中实现寻呼机，我需要知道当天提供该产品的公司总数。限制意味着我只看到前几个......

我尝试将 SELECT 子句更改为 SELECT COUNT(a.id) 或 SELECT COUNT(DISTINCT(a.id)) 但这些似乎都没有给我我想要的。我尝试在计数查询中删除 GROUP BY 和 ORDER BY，但这也不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T20:37:20.843

在我看来，你应该这样做`GROUP BY a.id, c.id`——分组`a.id`只意味着你通常会有几个`c.id`s per `a.id`，而你只是得到一个“随机”的其中一个。这似乎是一个基本正确性的问题。一旦你解决了这个问题，一个初始的`SELECT COUNT(*) FROM`etc 等应该肯定会为你提供以下查询将返回的行数，这样你就可以相应地准备你的寻呼机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T20:47:00.623

[这个网站](http://www.arraystudio.com/as-workshop/mysql-get-total-number-of-rows-when-using-limit.html)建议 MySQL 对此有一个特殊的技巧，至少从版本 4 开始：

幸运的是，从 MySQL 4.0.0 开始，您可以在查询中使用 SQL_CALC_FOUND_ROWS 选项，这将告诉 MySQL 计算不考虑 LIMIT 子句的总行数。您仍然需要执行第二个查询才能检索行数，但它是一个简单的查询，并不像检索数据的查询那么复杂。

用法很简单。在主查询中，您需要在 SELECT 之后添加 SQL_CALC_FOUND_ROWS 选项，在第二个查询中，您需要使用 FOUND_ROWS() 函数来获取总行数。查询将如下所示：

```
SELECT SQL_CALC_FOUND_ROWS name, email 
FROM users 
WHERE name LIKE 'a%' 
LIMIT 10;

SELECT FOUND_ROWS(); 
```

唯一的限制是您必须在第一个查询之后立即调用第二个查询，因为 SQL_CALC_FOUND_ROWS 不会在任何地方保存行数。

# objective-c - 为什么“不能将对象用作方法的参数”？

> ID：846052
> 
> 赞同：8
> 
> 时间：2009-05-10T20:32:02.363
> 
> 标签：objective-c

我有以下 ViewController 类

```
#import <UIKit/UIKit.h>

@interface SampleViewController : UIViewController {
    IBOutlet UITextField *field1;
}

@property (nonatomic, retain) UITextField *field1;

- (IBAction) method1:(id)sender; 
@end 
```

当我将 method1:(id)sender 更改为 method1:(UITextField)sender 时，我收到错误“不能将对象用作方法的参数”。

我搜索并发现[这篇文章](http://gcc.gnu.org/ml/gcc-patches/2002-06/msg02149.html)说“*它 [使用对象作为方法参数] 在 Objective-C 中不是一个好主意，因为 Objective-C 不允许静态分配的对象*”。

谁能指出我在哪里可以找到更详细的解释？

谢谢你。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-10T20:38:10.420

您没有传递`UITextField`.

```
method1:(UITextField)sender 
```

应该

```
method1:(UITextField *)sender 
```

当您为对象类型传递非指针时，Objective-C 不喜欢它。

# c# - C# 测试——为什么没有抛出异常时，ExpectedException 标记的方法会通过？

> ID：846056
> 
> 赞同：1
> 
> 时间：2009-05-10T20:36:18.520
> 
> 标签：c#, unit-testing, silverlight-2.0

在过去，我测试过这样的预期异常：

```
[TestMethod]
public void TestThrowsException() {
  try {
    Foo();
    Assert.Fail();
  } catch (MyException ex){//good
  }
} 
```

但是我注意到有一种（更干净的？）方法可以使用 ExpectedException 属性来测试它。为什么这个测试方法在没有抛出异常的情况下会通过？这肯定违背了属性的目的。

```
[TestMethod]
[ExpectedException(typeof(MyException))]
public void TestThrowsException() {
} 
```

[编辑] 我正在使用 Silverlight 2 运行此测试

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T20:39:08.017

我从没见过那个传球——这*真的*是你所拥有的吗？您确定*已将*其标记为`TestMethod`吗？测试运行器是否显示它通过了？你确定有最新的代码吗？

我会仔细检查，但我确信这会失败......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T21:19:57.373

Jon Skeet 实际上是对的，我确实有一个旧版本的测试框架。我在此处更新到 12 月 8 日发布[http://code.msdn.microsoft.com/silverlightut/Release/ProjectReleases.aspx?ReleaseId=1913](http://code.msdn.microsoft.com/silverlightut/Release/ProjectReleases.aspx?ReleaseId=1913)并在使用 ExpectedException 标记时得到了预期的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T21:00:21.740

我实际上经历过 ReSharper 4.5 测试运行程序在 NUnit 2.5 中无法与 ExpectedException 一起使用。...但这看起来像 MSTest ...您能否详细说明您正在使用哪个测试框架以及您正在使用哪个测试运行程序来执行测试？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-19T10:03:34.103

您应该使用带有附加 assert.fail 的“ExpectedException”，以便在未引发异常的情况下测试失败（仍在 VS 2010 中使用 .net 4 和 Microsoft.VisualStudio.QualityTools.UnitTestFramework）：

```
[TestMethod]
[ExpectedException(typeof(MyException))]
public void TestThrowsException() {

    Do.SomethingThatThrowsAnException();
    assert.fail("No exception ;-(");

} 
```

# linux - wc gzip压缩文件？

> ID：846062
> 
> 赞同：16
> 
> 时间：2009-05-10T20:40:07.890
> 
> 标签：linux, unix

我有一个包含未压缩文件和 gzip 文件的目录，并希望`wc -l`在此目录上运行。`wc`将为不准确的压缩文件提供行计数值（因为它似乎在文件的 gzip 压缩版本中计算换行符）。有没有办法创建一个`zwc`类似于`zgrep`检测 gzip 压缩文件并计算未压缩行数的脚本？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-10T20:49:41.803

试试这个*zwc*脚本：

```
#! /bin/bash --
for F in "$@"; do
  echo "$(zcat -f <"$F" | wc -l) $F"
done 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-01-24T13:19:30.393

您也可以`zgrep`用来计算行数（或者更确切地说是行的开头）

```
zgrep -c ^ file.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-28T08:03:13.543

我也使用“cat *file_name* | gzip -d | wc -l”

# iphone - 我可以在我的 iPhone 应用程序中使用 Apple 艺术品吗？

> ID：846080
> 
> 赞同：4
> 
> 时间：2009-05-10T20:50:56.390
> 
> 标签：iphone, icons

在我的应用程序中，我想让用户有机会向列出的项目添加一些评论。我不想显示“添加评论”按钮，而是显示一个小图标。懒惰，而且，使用 Mac 用户的视觉语言，我想使用 TextEdit 应用程序的图标。苹果会怎么想？显然，我可以自己设计一些东西，但那是另一个话题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-10T20:54:32.733

我绝对会远离这个。由于苹果为 iPhone 应用程序运行审批流程，他们可能会拒绝您的应用程序侵犯可能是版权或商标作品的内容。

从视觉的角度来看，我不认为 TextEdit 图标最适合“添加评论”图标。好像太笼统了。我认为你最好的选择是自己设计一些东西或者在网上找到一张免版税的图片。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-10T21:33:36.523

Apple 拒绝了对我的应用程序的更新，因为[这个图标（中心）](http://www.marco.org/98224131)由一位设计师为我绘制，Apple 没有任何版权，描绘的是一部 iPhone。

我不会推你的运气。远离苹果的IP。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-10T20:55:02.140

我认为除非您获得 Apple 的书面许可，否则这将侵犯版权。他们发布了[版权和商标政策](http://www.apple.com/legal/trademark/guidelinesfor3rdparties.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-24T15:24:31.223

是的！！！您可以使用他们的图标，他们鼓励这样做：

[https://developer.apple.com/ios/human-interface-guidelines/graphics/system-icons/](https://developer.apple.com/ios/human-interface-guidelines/graphics/system-icons/)

> 系统图标
> 
> iOS**提供了许多小图标**——代表常见任务和内容类型——<strong>用于导航栏、标签栏、工具栏和主屏幕快速操作。尽可能多地使用这些内置图标是个好主意，因为它们为人们所熟悉。
> 
> 为图标提供替代文本标签。替代文本标签在屏幕上不可见，但它们让 VoiceOver 可以用声音描述屏幕上的内容，让有视觉障碍的人更容易导航。

# asp.net - 为什么我们应该选择 PrincipalPermission 而不是 IsInRole()？

> ID：846087
> 
> 赞同：0
> 
> 时间：2009-05-10T20:55:09.050
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

Q1 - 我不确定我是否理解为什么我们应该更喜欢使用*PrincipalPermission.Union()*（或*PrincipalPermission.Intersect()*）而不是*IsInRole()*？如果有的话，多次调用*IsInRole()比创建多个**PrincipalPermission对象并通过**Union()*（或*Intersect()* ）将它们合并为一个对象需要更少的代码？

Q2 - *PrincipalPermission*对象的一个​​构造函数重载还指定了一个*IsAuthenticated*标志，该标志告诉*Demand()*验证用户是否已通过身份验证。*仅在前两个参数（ name*和*role*）都为空 的情况下使用该标志是否有用？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T21:05:00.000

Q1。- RE：PrincipalPermission 方法与 IPrincipal.IsInRole(..)

这两个函数调用创建了一个 PrincipalPermission，它具有您赋予它的角色的并集或交集。因此，您最终会得到一个具有一组非常具体的要求的委托人，然后您可以对其调用 IsInRole()。请注意，这样做会影响您的角色提供者，它可能是 SQL 服务器或活动目录，因此会涉及延迟，因此您不想一直这样做。

Q2。- RE: PrincipalPermission 认证

Authenticated 表示用户已针对您的提供商登录。如果您只需要审核您的应用程序，您可能需要这样做，确认用户已登录到您的角色提供者将意味着您可以记录他们的身份等。

你说得对，它只在你不关心用户是谁的情况下才有用，只关心他们是否登录。

# estimation - 当我不了解网站的所有功能时，如何估计网站构建（刷新）？

> ID：846090
> 
> 赞同：1
> 
> 时间：2009-05-10T20:55:50.530
> 
> 标签：estimation

我知道这里有几个估算问题，并且我已经阅读了其中的大部分问题，但这个问题略有不同。如果您正在对网站进行刷新，它可能包括可用性增强，从而增加了页面制作和开发的时间。我们永远不会看着一个网站，然后对自己说现在的样子就是未来的样子。如果是这样，那么我们的客户就不会寻找我们的专业知识了。在回复 RFP 或创建正式的工作说明之前，是否总是需要进行团队头脑风暴？如果那些进行头脑风暴的人没有做最后的工作怎么办？我们只能在一定程度上盘点当前站点，我开始认为我们应该只对我们所知道的进行估计，让潜在客户告诉我们我们在哪里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T21:20:25.937

在您的提案中，相当具体地说明您在当前网站上看到的内容（有多少页面/资源？它们是低/中/高复杂吗？您看到的高级功能是什么（即搜索、安全、AJAX、个人资料等），你会考虑添加什么？给出范围，而不是具体的估计。

您在不了解要求的情况下提供的关于所见内容的越详细，将有助于客户相信您不只是通过 RFP 滑槽拍摄提案，并且您对工作是认真的，而不会将您与交付更多产品的承诺联系起来/比你更快。客户确实知道您无法真正做出可靠的估算，但他们越是相信您已经做出了认真的尝试，他们就越有可能花时间帮助您了解制定最终提案和 SOW 的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T21:02:43.563

当你不知道你的估计是什么时，估计估计是不准确的（而且，充其量是近似的）。

陈述你的假设（“如果我们做 Foo，则为 X，如果我们不做，则为 Y”）。

说明您需要什么来减少不确定性（“我们需要花一个小时与客户一起收集需求，然后才能提供任何估算”）。

# msbuild - msbuild的隐藏功能

> ID：846098
> 
> 赞同：8
> 
> 时间：2009-05-10T21:03:15.153
> 
> 标签：msbuild, hidden-features

这周我对 msbuild 很感兴趣。我正在清理许多极其复杂的构建脚本。深入挖掘它的功能让我感到惊讶 - msbuild 本身就是 .NET 编程的一个隐藏特性。

在问题必须有答案的 SO 约定中，在几天或一周内，我会将最有用或最酷的隐藏功能标记为已接受。

```
 let bestAnswer suprise slick useful = (surprise + slick + 2*useful) 
```

有用的定义：我正在更新现有的 msbuild 脚本：打包（zip 文件）网站和实用程序、CC.NET 集成、启动测试（UT + selenium）、构建数据库。我正在添加（新目标，甚至更有用）：部署到 VMWare 虚拟服务器，链式构建（立即快速构建，排队慢速测试）。如果您引用外部库（如[MSBuild 社区任务](http://msbuildtasks.tigris.org/)），最好知道如何获取它。

**我已经发现了一些 msbuild 惊喜。**

*   Hello world 使用[消息](http://msdn.microsoft.com/en-us/library/6yy0yx8d.aspx)任务和属性。
*   使用 msbuild 作为极其复杂的服务器产品的安装程序。[MSB 社区任务](http://msbuildtasks.tigris.org/)管理 IIS 服务器设置。[WriteLinesToFile](http://msdn.microsoft.com/en-us/library/ms164305.aspx)和[XmlUpdate](http://geekswithblogs.net/paulwhitblog/archive/2006/04/11/74844.aspx)任务编写了服务器特定的配置文件。如果您使用过 MSI，您就会知道安装时任何东西都比 MSI 更好。
*   对于新手：CSProj 和 Vbproj 文件与 msbuild "proj" 文件相同。直接编辑：卸载您的 csproj 或 vbproj，然后右键单击项目并选择编辑。这比使用笨重的预构建/构建后事件更好、更强大。
*   MSBuild 附带通用的 .NET 安装。与其他花哨的工具不同，您可以在完全干净的服务器/桌面上使用它。

**这里是msbuild Hello World** ，我写完之后发现了[MSDN hello world](http://msdn.microsoft.com/en-us/library/ms171456.aspx)。

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build;Test" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
       <Who>World</Who>
  </PropertyGroup>
  <Target Name="Hello">
    <Message Text="Hello, $(Who)" Importance="high" ></Message>
  </Target>
  <Target Name="Build" DependsOnTargets="Hello"/>
  <Target Name="Test"/>
</Project> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T22:21:40.610

MSBuild 有许多不错的功能。我喜欢

递归文件规范

```
<Files Include="$(src)\**\*.cs" Exclude="$(src)\**\*test.cs" /> 
```

批处理和项目元数据

```
<ItemGroup>
 <F Include="SampleApplication.t">
    <Version>1</Version>
</F>
 <F Include="SampleApplication2.t">
    <Version>1</Version>
</F>
<F Include="SampleApplication3.t">
   <Version>2</Version>
</F>
</ItemGroup>
<Target Name="Build">
<Touch Files="%(F.FullPath)" AlwaysCreate="True" 
        Condition=" '%(F.Version)' > '1' ">
<Output TaskParameter="TouchedFiles" ItemName="CreatedFiles"/>
</Touch>
<Message Text="Created files = @(CreatedFiles)"/>
<Message Text="%(F.Identity) %(F.Version)"/>
</Target> 
```

目标级别依赖分析

```
<Target Name="Build"
           Inputs="@(MyItems)"
           Outputs="@(MyItems -> '$(MyItems)\%(filename).dll'"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:31:33.330

这并不是一个真正的隐藏功能，但我认为[批处理](http://msdn.microsoft.com/en-us/library/ms171473(VS.80).aspx)在理解后非常强大。

有关更多信息，您可以阅读我的相关博客文章：

*   [MSBuild 批处理第 1 部分](http://www.sedodream.com/PermaLink,guid,5f1e0445-ce3d-4052-ba80-42fd19512d42.aspx)
*   [MSBuild 批处理第 2 部分](http://www.sedodream.com/PermaLink,guid,b721bc22-c375-4e1e-bcc9-512dd64096bb.aspx)
*   [MSBuild 批处理第 3 部分](http://www.sedodream.com/PermaLink,guid,cab57d7f-9d6e-4358-8491-dc033fb3bacc.aspx)
*   [MSBuild RE：在团队构建中强制构建代理](http://www.sedodream.com/PermaLink,guid,096a2e3f-fcff-4715-8d00-73d8f2491a13.aspx)

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T15:20:32.570

使用**/M**命令行参数启用所有可用 CPU 内核的使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T11:52:23.723

*   我发现[MSBuild 扩展](http://msbuildextensionpack.com "MSBuild 扩展包")包非常有用。文档组织得很好，很容易找到您需要的信息。

*   他们有一个为构建文件配置智能感知的部分，可以在[这里找到](http://www.msbuildextensionpack.com/help/3.5.2.0/Configuring%20Intellisense.htm)

*   Attrice 有一个令人难以置信的工具，如果我需要处理构建脚本，我会经常使用它。值得您尝试一下的原因在于，它有一个调试器，当它执行构建脚本时，它会向您显示相关任务，并在运行构建脚本时使用 auto 和 watch 变量。[Microsoft Build Sidekick v2.3](http://www.attrice.info/msbuild/ "MSBuild 助手")

*   将 SVN 设置为安静，我觉得这大大提高了构建过程的速度。将以下内容添加到您的 MSBuild.Community.Tasks.Subversion.SvnExport 将运行构建而不记录它从 SVN 中获取的每个文件

    参数="--force -q"

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T16:15:10.773

您可以从另一个文件中引用一个 msbuild 文件。我们所有的目标，例如用于运行 NCover、SourceMonitor、Duplo 等的目标都在一个公共目标文件中。对于每个项目，我们创建一个带有 PropertyGroup 和 ItemGroup 部分的 msbuild 文件，然后是公共目标的包含。这保证了我们所有的构建都将运行相同的分析任务集并节省我们编写脚本的时间。

# language-agnostic - 运行时与编译时间

> ID：846103
> 
> 赞同：451
> 
> 时间：2009-05-10T21:06:35.273
> 
> 标签：language-agnostic, runtime, compile-time

运行时和编译时有什么区别？

* * *

## 回答 #1

> 赞同：553
> 
> 时间：2009-05-11T01:13:45.150

编译时间和运行时间之间的差异就是头脑敏锐的理论家所说的*[相位差异](https://en.wikipedia.org/wiki/Phase_distinction)*的一个例子。这是最难学习的概念之一，尤其是对于没有太多编程语言背景的人来说。为了解决这个问题，我觉得问一下很有帮助

1.  程序满足哪些不变量？
2.  在这个阶段会出现什么问题？
3.  如果阶段成功，后置条件是什么（我们知道什么）？
4.  如果有的话，输入和输出是什么？

## 编译时间

1.  该程序不需要满足任何不变量。事实上，它根本不需要是一个格式良好的程序。您可以将此 HTML 提供给编译器并观看它...
2.  编译时会出现什么问题：
    *   语法错误
    *   类型检查错误
    *   （很少）编译器崩溃
3.  如果编译成功，我们知道什么？
    *   该程序结构良好——无论使用何种语言，都是一个有意义的程序。
    *   可以开始运行程序。（程序可能会立即失败，但至少我们可以尝试。）
4.  输入和输出是什么？
    *   输入是正在编译的程序，以及任何头文件、接口、库或其他需要*导入*以进行编译的巫术。
    *   输出希望是汇编代码或可重定位的目标代码，甚至是可执行程序。或者如果出现问题，输出是一堆错误消息。

## 运行

1.  我们对程序的不变量一无所知——它们是程序员输入的任何内容。运行时不变量很少由编译器单独强制执行。它需要程序员的帮助。
2.  可能出错的是*运行时错误*：

    *   被零除
    *   取消引用空指针
    *   内存不足

    程序本身也可能检测到错误：

    *   试图打开一个不存在的文件
    *   尝试查找网页并发现所谓的 URL 格式不正确
3.  如果运行时成功，则程序完成（或继续运行）而不会崩溃。
4.  输入和输出完全取决于程序员。文件、屏幕上的窗口、网络数据包、发送到打印机的作业，应有尽有。如果程序发射导弹，这是一个输出，它只发生在运行时:-)

* * *

## 回答 #2

> 赞同：229
> 
> 时间：2009-05-10T21:30:13.283

我从错误的角度来考虑它，以及何时可以捕获它们。

编译时间：

```
string my_value = Console.ReadLine();
int i = my_value; 
```

一个字符串值不能被分配一个int类型的变量，所以编译器*在编译时*就知道这段代码有问题

运行：

```
string my_value = Console.ReadLine();
int i = int.Parse(my_value); 
```

这里的结果取决于 ReadLine() 返回的字符串。有些值可以解析为 int，有些则不能。这只能在*运行时确定*

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2009-05-10T21:08:50.633

**编译时间：**作为开发人员，您正在编译代码的时间段。

**运行时间：**用户运行您的软件的时间段。

你需要更清晰的定义吗？

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-05-10T21:16:23.197

（**编辑**：以下适用于 C# 和类似的强类型编程语言。我不确定这是否对您有帮助）。

例如，在您运行程序之前，编译器（在**编译时**）会检测到以下错误，并会导致编译错误：

```
int i = "string"; --> error at compile-time 
```

另一方面，编译器无法检测到如下错误。**您将在运行时**（程序运行时）收到错误/异常。

```
Hashtable ht = new Hashtable();
ht.Add("key", "string");
// the compiler does not know what is stored in the hashtable
// under the key "key"
int i = (int)ht["key"];  // --> exception at run-time 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-11T02:21:51.637

将源代码翻译成在[屏幕|磁盘|网络]上发生的事情可以（大致）以两种方式发生；称他们为编译和解释。

在已**编译**的程序中（例如 c 和 fortran）：

1.  源代码被输入到另一个程序（通常称为编译器——go figure）中，该程序产生一个可执行程序（或错误）。
2.  运行可执行文件（通过双击它，或在命令行上输入它的名称）

*第一步发生的事情被称为发生在“编译时”，第二步发生的事情被称为发生在“运行时”。*

在**解释**程序中（例如 MicroSoft basic（在 dos 上）和 python（我认为））：

1.  源代码被输入另一个程序（通常称为解释器），该程序直接“运行”它。在这里，解释器充当您的程序和操作系统（或非常简单的计算机中的硬件）之间的中间层。

在这种情况下，编译时间和运行时间之间的差异更难确定，并且与程序员或用户的相关性更小。

Java 是一种混合，其中代码被编译成字节码，然后在虚拟机上运行，​​该虚拟机通常是字节码的解释器。

还有一种中间情况，程序被编译为字节码并立即运行（如在 awk 或 perl 中）。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-05-10T21:09:36.670

基本上，如果您的编译器可以计算出您的意思或“在编译时”的值是什么，它可以将其硬编码到运行时代码中。显然，如果您的运行时代码每次都必须进行计算，它会运行得更慢，所以如果您可以在编译时确定一些东西，那就更好了。

例如。

恒定折叠：

如果我写：

```
int i = 2;
i += MY_CONSTANT; 
```

编译器可以在编译时执行此计算，因为它知道 2 是什么，以及 MY_CONSTANT 是什么。因此，它可以避免每次执行都执行计算。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-05-10T21:09:01.960

嗯，好吧，运行时是用来描述程序运行时发生的事情。

编译时间用于描述在构建程序时发生的事情（通常是由编译器）。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-05-11T00:41:21.770

## 编译时间：

在编译时完成的事情在结果程序运行时（几乎）不会产生任何成本，但在构建程序时可能会产生很大的成本。

## 运行：

或多或少正好相反。构建时成本低，运行程序时成本更高。

从另一边；如果某事是在编译时完成的，它只在你的机器上运行，如果某事是运行时的，它就在你的用户机器上运行。

## 关联

这一点很重要的一个例子是单元携带类型。编译时版本（如[Boost.Units](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_units.html)或[我在 D 中的版本](http://www.dsource.org/projects/scrapple/browser/trunk/units)）最终与使用本机浮点代码解决问题一样快，而运行时版本最终不得不打包有关值所在单位的信息并在每个操作旁边执行检查。另一方面，编译时版本要求值的单位在编译时是已知的，并且无法处理它们来自运行时输入的情况。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2018-02-22T18:48:03.067

作为其他答案的补充，这是我向外行解释的方式：

您的源代码就像一艘船的蓝图。它定义了船的制造方式。

如果您将蓝图交给造船厂，而他们在造船时发现缺陷，他们会在船离开干船坞或接触水之前立即停止建造并向您报告。这是一个编译时错误。这艘船甚至从未真正漂浮或使用过它的引擎。发现错误是因为它甚至阻止了船的制造。

当你的代码编译完成时，就像船正在完成一样。已建成并准备就绪。当你执行你的代码时，这就像在航行中发射船一样。乘客登机，发动机运转，船体在水面上，所以这是运行时间。如果你的船有一个致命的缺陷，导致它在处女航中沉没（或者可能因为额外的头痛而在之后的某次航行），那么它就会遇到运行时错误。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-05-25T05:41:48.813

继之前对问题的类似回答之后，[运行时错误和编译器错误有什么区别？](https://stackoverflow.com/questions/9471837/what-is-the-difference-between-run-time-error-and-compiler-error/30431830#30431830)

**编译/编译时间/语法/语义错误：**编译或编译时错误是由于键入错误而发生的错误，如果我们不遵循任何编程语言的正确语法和语义，编译器就会抛出编译时错误。在您删除所有语法错误或调试编译时错误之前，他们不会让您的程序执行单行。
示例：在 C 中缺少分号或错误键入`int`为`Int`.

**运行时错误：**运行时错误是程序处于运行状态时产生的错误。这些类型的错误会导致您的程序出现意外行为，甚至可能会终止您的程序。它们通常被称为例外。
示例：假设您正在读取一个不存在的文件，将导致运行时错误。

在此处阅读有关所有[编程错误的更多信息](https://codeforwin.org/2015/05/introduction-to-programming-errors.html)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-05-10T21:10:13.737

例如：在强类型语言中，可以在编译时或运行时检查类型。在编译时，这意味着如果类型不兼容，编译器会抱怨。在运行时意味着，您可以很好地编译您的程序，但在运行时，它会引发异常。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-03-07T23:49:21.803

以下是《Java 编程简介》的作者 Daniel Liang 关于编译的引述：

> “用高级语言编写的程序称为源程序或源代码。由于计算机无法执行源程序，因此必须将源程序**翻译**成**机器代码**才能**执行**。翻译可以使用另一种称为解释器或**编译器**。” （Daniel Liang，[“JAVA 编程简介”](https://rads.stackoverflow.com/amzn/click/com/0133761312)，第 8 页）。

...他继续...

> “编译器将整个**源代码**翻译成**机器代码**文件，然后执行机器代码文件”

当我们输入高级/人类可读的代码时，这首先是没有用的！它必须在你的小 CPU 中转化为一系列“电子事件”！第一步是编译。

简单地说：在这个阶段会发生编译时错误，而稍后会发生运行时错误。

**记住：程序编译没有错误并不意味着它会运行没有错误。**

运行时错误将发生在程序生命周期的就绪、运行或等待部分，而编译时错误将发生在生命周期的“新”阶段之前。

**编译时错误示例：**

语法错误 - 如果代码不明确，如何将它们编译成机器级指令？您的代码需要 100% 符合语言的语法规则，否则无法编译为工作[机器代码](https://i.stack.imgur.com/SJoZu.png)。

**运行时错误示例：**

内存不足 - 例如，对递归函数的调用可能会导致给定特定程度的变量的堆栈溢出！编译器怎么能预料到这一点！？这不可以。

这就是编译时错误和运行时错误之间的区别

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-12-22T06:15:16.257

## 在简单的单词差异 b/w 编译时间和运行时间。

编译时：开发人员以.java格式编写程序并转换为字节码，这是一个类文件，在此编译期间发生的任何错误都可以定义为编译时错误。

运行时：生成的 .class 文件被应用程序用于其附加功能&逻辑结果是错误的并抛出一个错误，这是一个运行时错误

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-05-10T21:09:07.203

运行时意味着当你运行程序时会发生一些事情。

编译时间意味着当你编译程序时会发生一些事情。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-04-14T13:08:31.870

想象一下你是老板，你有一个助理和一个女仆，你给他们一个任务清单，助理（编译时）会抓取这个清单并做一个检查，看看这些任务是否可以理解，你没有用任何笨拙的语言或语法写作，所以他知道您想为某人分配工作，因此他为您分配了他，并且他了解您想要喝咖啡，因此他的角色结束了女仆（运行时间）开始运行这些任务，所以她去给你煮咖啡，但突然间她找不到任何咖啡可以煮，所以她停止煮咖啡，或者她采取不同的行动给你泡茶（当程序因为发现错误而采取不同的行动时） ）。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-02-10T04:46:03.120

编译时间：

在编译时完成的事情在结果程序运行时（几乎）不会产生任何成本，但在构建程序时可能会产生很大的成本。运行：

或多或少正好相反。构建时成本低，运行程序时成本更高。

从另一边；如果某事是在编译时完成的，它只在你的机器上运行，如果某事是运行时的，它就在你的用户机器上运行。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2017-12-13T00:32:02.690

恕我直言，您需要阅读许多链接和资源，以了解运行时与编译时之间的区别，因为它是一个非常复杂的主题。我在下面列出了一些我推荐的图片/链接。

除了上面所说的，我想补充一点，有时一张图片价值 1000 字：

1.  这两个的顺序：首先是编译时间然后你运行一个编译好的程序可以被用户打开和运行。当应用程序运行时，它被称为 runtime ：编译时，然后是 runtime1 ![编译时间，然后是 runtime1](https://i.stack.imgur.com/SU0PG.gif)；

CLR_diag 编译时间然后runtime2 ![CLR_diag 编译时间然后runtime2](https://i.stack.imgur.com/PaTwk.png)

```
 from Wiki 
```

[https://en.wikipedia.org/wiki/Run_time](https://en.wikipedia.org/wiki/Run_time) [https://en.wikipedia.org/wiki/Run_time_(program_lifecycle_phase)](https://en.wikipedia.org/wiki/Run_time_(program_lifecycle_phase))

运行时、运行时或运行时可以指：

计算

**运行时间（程序生命周期阶段）**，计算机程序执行的时间段

**运行时库**，一种程序库，旨在实现编程语言中内置的功能

**运行时系统**，旨在支持计算机程序执行的软件

软件执行，在运行时阶段一一执行指令的过程

[![在此处输入图像描述](https://i.stack.imgur.com/3JTqP.png)](https://i.stack.imgur.com/3JTqP.png) [![在此处输入图像描述](https://i.stack.imgur.com/VSeAW.png)](https://i.stack.imgur.com/VSeAW.png)

[![在此处输入图像描述](https://i.stack.imgur.com/GNeYg.gif)](https://i.stack.imgur.com/GNeYg.gif) [![在此处输入图像描述](https://i.stack.imgur.com/PGIWl.png)](https://i.stack.imgur.com/PGIWl.png) [![在此处输入图像描述](https://i.stack.imgur.com/LjqzR.gif)](https://i.stack.imgur.com/LjqzR.gif) [![在此处输入图像描述](https://i.stack.imgur.com/BUgAX.jpg)](https://i.stack.imgur.com/BUgAX.jpg) [![在此处输入图像描述](https://i.stack.imgur.com/WrsD8.png)](https://i.stack.imgur.com/WrsD8.png) 编译器列表 [https://en.wikipedia.org/wiki/List_of_compilers](https://en.wikipedia.org/wiki/List_of_compilers)[![在此处输入图像描述](https://i.stack.imgur.com/a0rVH.png)](https://i.stack.imgur.com/a0rVH.png) [![在此处输入图像描述](https://i.stack.imgur.com/TeRa8.png)](https://i.stack.imgur.com/TeRa8.png)

*   在谷歌上搜索并比较运行时错误与编译错误：

![运行时错误](https://i.stack.imgur.com/vKOmq.jpg)

![编译错误](https://i.stack.imgur.com/eBlH9.png);

3.  在我看来，要知道一件非常重要的事情：3.1 构建与编译和构建生命周期之间的区别 [https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)

3.2 这三件事的区别：编译 vs 构建 vs 运行时

[https://www.quora.com/What-is-the-difference-between-build-run-and-compile](https://www.quora.com/What-is-the-difference-between-build-run-and-compile) Fernando Padoan，一个对语言设计有点好奇的开发人员 2 月 23 日回答我要倒退相关其他答案：

running 正在获取一些二进制可执行文件（或解释语言的脚本），嗯……作为计算机上的新进程执行；编译是解析用某种高级语言（如果与机器代码相比更高）编写的程序，检查它的语法、语义、链接库，可能进行一些优化，然后创建二进制可执行程序作为输出的过程。这个可执行文件可以是机器码的形式，也可以是某种字节码——即针对某种虚拟机的指令；构建通常涉及检查和提供依赖关系、检查代码、将代码编译成二进制文件、运行自动化测试并将生成的二进制文件和其他资产（图像、配置文件、库等）打包成某种特定格式的可部署文件。请注意，大多数过程是可选的，有些过程取决于您构建的目标平台。例如，为 Tomcat 打包 Java 应用程序将输出一个 .war 文件。用 C++ 代码构建 Win32 可执行文件可以只输出 .exe 程序，也可以将其打包到 .msi 安装程序中。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-05-08T19:33:29.653

**编译时间：** 将源代码转换为机器代码以使其成为可执行文件所花费的时间称为编译时间。

**运行时：** 当应用程序运行时，称为运行时。

编译时错误是那些语法错误，缺少文件引用错误。运行时错误发生在源代码被编译成可执行程序之后并且程序正在运行时。例如程序崩溃、意外的程序行为或功能不起作用。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-11-22T16:32:07.117

我一直认为它与程序处理开销以及它如何影响性能有关，如前所述。一个简单的例子是，要么在代码中定义我的对象所需的绝对内存。

定义的布尔值占用 x 内存，然后在编译的程序中并且不能更改。当程序运行时，它确切地知道要为 x 分配多少内存。

另一方面，如果我只是定义一个通用对象类型（即一种未定义的占位符，或者可能是一个指向某个巨型 blob 的指针），那么我的对象所需的实际内存在程序运行之前是不知道的，我给它分配了一些东西，因此必须对其进行评估，然后在运行时动态处理内存分配等（更多的运行时开销）。

然后，如何动态处理将取决于语言、编译器、操作系统、您的代码等。

但是，在那张纸条上，这实际上取决于您使用运行时与编译时的上下文。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2011-05-02T07:19:26.843

这是对“运行时和编译时的区别？”问题的答案的扩展。--与运行时和编译时相关的**开销差异？**

产品的运行时性能通过更快地交付结果来提高其质量。通过缩短编辑-编译-调试周期，产品的编译时性能有助于其及时性。但是，运行时性能和编译时性能都是实现及时质量的次要因素。因此，只有在整体产品质量和及时性的改进证明合理时，才应该考虑运行时和编译时性能的改进。

[在这里](http://developers.sun.com/solaris/articles/CC_perf/content.html)进一步阅读的一个很好的来源：

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-06-07T19:48:17.940

我们可以将它们分类为静态绑定和动态绑定两大类。它基于使用相应值完成绑定的时间。如果引用是在编译时解析的，那么它是静态绑定，如果引用是在运行时解析的，那么它是动态绑定。静态绑定和动态绑定也称为早期绑定和后期绑定。有时它们也被称为静态多态性和动态多态性。

约瑟夫·库兰代‏.

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-11-25T06:04:02.973

运行时和编译时的主要区别是：

1.  如果您的代码中有任何语法错误和类型检查，那么它会抛出编译时错误，其中 - 作为运行时：它在执行代码后进行检查。例如：

`int a = 1 int b = a/0;`

这里第一行末尾没有分号--->在执行操作b时执行程序后编译时错误，结果是无限的--->运行时错误。

2.  编译时不查找代码提供的功能的输出，而运行时查找。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-03-08T15:14:03.907

这是一个非常简单的答案：

运行时和编译时是指软件程序开发的不同阶段的编程术语。为了创建程序，开发人员首先编写源代码，它定义了程序将如何运行。小程序可能只包含几百行源代码，而大程序可能包含数十万行源代码。源代码必须编译成机器码才能成为可执行程序。此编译过程称为编译时间。（将编译器视为翻译器）

编译后的程序可以由用户打开和运行。当应用程序运行时，它被称为运行时。

程序员经常使用术语“运行时”和“编译时”来指代不同类型的错误。编译时错误是阻止程序成功编译的语法错误或缺少文件引用等问题。编译器会产生编译时错误，并且通常会指出源代码的哪一行导致了问题。

如果一个程序的源代码已经被编译成可执行程序，它可能仍然存在程序运行时出现的错误。示例包括不起作用的功能、意外的程序行为或程序崩溃。这些类型的问题被称为运行时错误，因为它们发生在运行时。

[参考资料](http://pc.net/helpcenter/answers/compile_time_vs_runtime)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-09-09T07:37:00.783

看看这个例子：

```
public class Test {

    public static void main(String[] args) {
        int[] x=new int[-5];//compile time no error
        System.out.println(x.length);
    }} 
```

以上代码编译成功，没有语法错误，完全有效。但是在运行时，它会引发以下错误。

```
Exception in thread "main" java.lang.NegativeArraySizeException
    at Test.main(Test.java:5) 
```

就像在编译时检查某些情况一样，在运行时检查某些情况后，一旦程序满足所有条件，您将获得输出。否则，您将收到编译时或运行时错误。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-07-25T04:41:39.713

```
public class RuntimeVsCompileTime {

    public static void main(String[] args) {

        //test(new D()); COMPILETIME ERROR
        /**
         * Compiler knows that B is not an instance of A
         */
        test(new B());
    }

    /**
     * compiler has no hint whether the actual type is A, B or C
     * C c = (C)a; will be checked during runtime
     * @param a
     */
    public static void test(A a) {
        C c = (C)a;//RUNTIME ERROR
    }

}

    class A{

}

    class B extends A{

}

    class C extends A{

}

    class D{

} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-10-24T07:58:54.017

您可以通过阅读实际代码来了解代码编译结构。除非您了解所使用的模式，否则运行时结构并不清晰。

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2009-05-11T02:15:20.133

对于 SO 来说这不是一个好问题（这不是一个特定的编程问题），但总的来说这不是一个坏问题。

如果您认为这是微不足道的：那么读取时间与编译时间呢，什么时候可以做出有用的区分？编译器在运行时可用的语言呢？Guy Steele（不是傻瓜，他）在 CLTL2 中写了 7 页关于 EVAL-WHEN 的内容，CL 程序员可以使用它来控制它。2句话勉强够*定义*，本身就远没有*解释*。

一般来说，这是一个语言设计者似乎试图避免的棘手问题。他们经常只是说“这是一个编译器，它做编译时的事情；之后的一切都是运行时的，玩得开心”。C 被设计为易于实现，而不是最灵活的计算环境。如果您没有在运行时可用的编译器，或者无法轻松控制何时评估表达式，您往往会以语言中的技巧来伪造宏的常见用法，或者用户想出设计模式来模拟拥有更强大的构造。一种易于实现的语言绝对是一个有价值的目标，但这并不意味着它是编程语言设计的终极目标。（我很少使用 EVAL-WHEN，但我无法想象没有它的生活。）

围绕编译时和运行时的问题空间是巨大的，并且在很大程度上仍未被探索。这并不是说 SO 是进行讨论的正确场所，但我鼓励人们进一步探索这个领域，尤其是那些对它应该是什么没有先入为主的概念的人。这个问题既不简单也不愚蠢，我们至少可以为调查官指出正确的方向。

不幸的是，我不知道有什么好的参考资料。CLTL2 讲了一点，但是不太适合学习。

# c# - 返回原始字符串中正则表达式匹配的序数位置

> ID：846107
> 
> 赞同：1
> 
> 时间：2009-05-10T21:08:13.257
> 
> 标签：c#, regex

为了好玩，我正在开发一个实用程序，它将接受输入字符串和正则表达式，并将颜色突出显示原始字符串中正则表达式的所有匹配项，就像 Firefox 或 IE 8 和一些流行浏览器中的 Find 函数一样。

我正在使用 C#。System.Text.RegularExpressions 命名空间的任何成员是否返回原始字符串中匹配项的序号位置？我也需要他们的长度。

有没有办法获取这些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T21:25:07.440

```
var rgx = new Regex("my pattern");
var matches = rgx.Matches("my string");

foreach (Match m in matches)
{
    Console.WriteLine(String.Format("pos: {0}, len: {1}", m.Index, m.Length));
} 
```

# ruby-on-rails - Ruby On Rails 关系 - 一对多

> ID：846114
> 
> 赞同：0
> 
> 时间：2009-05-10T21:10:35.937
> 
> 标签：ruby-on-rails, relational

我是 ROR 的开始，但这就是我想要实现的目标。我有两个要关联的项目：事物和人。每件事可以有很多人。也就是说，我想分别创建人和事，然后再将它们联系起来。

例如，我可以创建：Bill Clinton Barack Obama

我可能会制造问题：全球变暖 反恐战争

我希望能够将用户 Bill Clinton 和 Barack Obama 与这两件事联系起来。有人可以指点我一个可以告诉我如何做到这一点的教程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T22:00:23.297

我认为`has_and_belongs_to_many`现在 RoR 社区越来越少地使用它。虽然仍然受支持，但我认为现在更常见的是有一个中间模型（在您的情况下类似于`PoliticianMatter`）来加入您的`Politician`和`Matter`模型。

然后你的`politician_matter`桌子会有一个PK，一个`politician_id`和一个`matter_id`。

然后你有

```
class PoliticanMatter < ActiveRecord::Base
  belongs_to :politician
  belongs_to :matter
end 
```

这种方法的优点是，如果需要政治家的未来属性-> 物质关系（例如重要性，最后发生的日期），您有一个模型可以提供此功能-`has_and_belongs_to_many`不支持添加这些额外属性。

您还可以像这样直接从 Politician 和 Matter 模型访问多对多关系

```
class Politician < ActiveRecord::Base
  has_many :politician_matters
  has_many :matters, :through => :politician_matters
end

class Matter < ActiveRecord::Base
  has_many :politician_matters
  has_many :politicians, :through => :politician_matters
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T21:13:31.487

您需要在这两个实体之间建立多对多关系。

*   一个问题可以被很多人研究
*   一个人可以研究几件事

Rails 使用`has_and_belongs_to_many`helper 来做到这一点。您可以在文档和许多博客文章中找到更多相关信息！

[has_and_belongs_to_many 帮手](http://www.railsbrain.com/api/rails-2.3.2/doc/index.html?a=M001888&name=has_and_belongs_to_many)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T21:19:21.897

```
class Politician < ActiveRecord::Base
  has_and_belongs_to_many :tasks
end

class Task < ActiveRecord::Base
  has_and_belongs_to_many :politicians
end 
```

你需要的是3个表： `politicians, tasks`和`politicians_tasks`（有两列`politician_id`和`task_id`，没有主键）

希望这有助于 Seb

# css - css：如何格式化联系人输入屏幕

> ID：846115
> 
> 赞同：0
> 
> 时间：2009-05-10T21:12:35.807
> 
> 标签：css, layout, asp.net, html

我正在尝试使用 CSS 在我的 aspx 页面中很好地格式化联系人屏幕。使用以下代码，我无法点击进入 txtEmailAddress。如果我从 txtSubject Span 元素中取出 padding:100px，那么我可以点击进入 txtEmailaddress 并进行编辑。请帮忙...

```
<div>
<span>
Your Email Address :    
</span>
<span style="padding:100px">
<asp:TextBox ID="txtEmailAddress" runat="server"></asp:TextBox>        
</span>

<br />
<span>
                    Subject :    
</span>
<span  style="padding:100px">
                <asp:TextBox ID="txtSubject" runat="server"></asp:TextBox>        
</span>                
<br />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T21:38:55.500

我尝试复制和粘贴并经历了相同的行为，即在主题跨度上填充我无法单击 txtEmailAddress。如果有帮助的话，我会在 vista SP1 上运行 IE8。我还注意到文本框没有对齐。

虽然它没有回答您的问题，但您是否考虑过使用标签标签并对这些标签进行样式设置。通过这种方式，表单将更易于访问。您可以在 alistpart 上找到有关此方法的更多信息[：](http://www.alistapart.com/articles/prettyaccessibleforms)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T03:54:47.820

也许以下内容更适合您的目的：

```
<fieldset>
<legend>Add a heading if you want one</legend>
<div>
<asp:Label id="lblEmail" runat="server" text="Your Email Address:" AssociatedControlID="txtEmailAddress">
</asp:Label>
<asp:TextBox ID="txtEmailAddress" runat="server"></asp:TextBox>        
</div>
<div>
<asp:Label id="lblSubject" runat="server" text="Subject:" AssociatedControlID="txtSubject">
</asp:Label>
<asp:TextBox ID="txtSubject" runat="server"></asp:TextBox>        
</div>
</fieldset> 
```

然后，您可以使用 CSS 将布局添加到字段集、标签和输入元素，例如

```
fieldset label
{
  margin-right: 2em;
  width: 20em;
}

fieldset input
{
  display: inline;
} 
```

或者它的一些变体。

# c++ - C ++在读取文件时在字符串开头添加回车符

> ID：846121
> 
> 赞同：0
> 
> 时间：2009-05-10T21:16:23.930
> 
> 标签：c++, random, fstream

我有两个问题：

1) 为什么我的代码在 selected_line 字符串的开头添加了回车符？
2）你认为我用来从文件中返回随机行的算法足够好并且不会引起任何问题吗？

一个示例文件是：

```
line
number one
#
line number two 
```

我的代码：

```
int main()
{
    srand(time(0));
    ifstream read("myfile.dat");
    string line;
    string selected_line;
    int nlines = 0;
    while(getline(read, line, '#')) {
        if((rand() % ++nlines) == 0)
            selected_line = line;
    }
    // this is adding a \n at the beginning of the string
    cout << selected_line << endl; 
} 
```

**编辑：**好的，你们中的一些人的建议很有意义。该字符串可能被读取为“\nmys​​tring”。所以我想我现在的问题是，我将如何从字符串中删除第一个 \n ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T21:18:56.890

因为您没有指定`\n`为分隔符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T21:20:50.227

您的“随机”选择是完全错误的。事实上，它总是会选择第一行： `rand() % 1`总是 0。

在不知道存在的行数的情况下，无法统一选择随机行。

另外，为什么要使用# 作为分隔符？Getline，默认情况下，获取一行（以 \n 结尾）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T21:25:19.437

换行符可以从您打印的第二行出现。这是因为，该`getline`函数在看到该`#`字符时停止，并在下次从其左侧调用它时恢复，即`#`根据您的输入文件，该字符过去的字符是换行符。阅读[有关](http://c-faq.com/lib/randrange.html)有效使用`rand()`.

一个建议是一次性读取整个文件，将行存储在 a 中`vector`，然后根据需要输出它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T21:38:29.043

你可能想要的是这样的：

```
std::vector<std::string> allParagraphs;
std::string currentParagraph;

while (std::getline(read, line)) {        
    if (line == "#") { // modify this condition, if needed
        // paragraph ended, store to vector
        allParagraphs.push_back(currentParagraph);
        currentParagraph = "";
    else {
        // paragraph continues...
        if (!currentParagraph.empty()) {
            currentParagraph += "\n";
        }
        currentParagraph += line;
    }          
}

// store the last paragraph, as well
// (in case it was not terminated by #)
if (!currentParagraph.empty()) {
    allParagraphs.push_back(currentParagraph);
}

// this is not extremely random, but will get you started
size_t selectedIndex = rand() % allParagraphs.size();

std::string selectedParagraph = allParagraphs[selectedIndex]; 
```

为了获得更好的随机性，您可以选择此选项：

```
size_t selectedIndex 
    = rand() / (double) (RAND_MAX + 1) * allParagraphs.size(); 
```

这是因为返回的最低有效位`rand()`往往表现得根本不那么随机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T21:27:30.887

因为 # 是您的分隔符，所以在该分隔符之后存在的 \n 将成为您下一行的开头，从而使 \n 在您的行前面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T21:29:05.017

1）你没有添加`\n`到`selected_line`. 相反，通过指定`'#'`您根本不会删除`\n`文件中的多余字符。请注意，您的文件实际上看起来像这样：

第一行\n 第一行\n #\n 第二行\n <\pre>

所以第二行实际上是“\n第二行\n”。

2）不。如果你想随机选择一行，那么你需要先确定文件中的行数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T21:38:49.697

在决定使用哪一行后，您可以使用 std::string 类的 substr 方法删除 \n ：

```
if ( line.substr(0,1) == "\n" ) { line = line.substr(1); } 
```

As others have said, if you want to select the lines with uniform randomness, you'll need to read all the lines first and then select a line number. You could also use if (rand() % (++nlines+1)) which will select line 1 with 1/2 probability, line 2 with 1/2*1/3 probability, etc.

# asp.net - MembershipUser 和 IPrincipal 对象之间的关系

> ID：846128
> 
> 赞同：8
> 
> 时间：2009-05-10T21:20:17.853
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

我假设 MembershipUser 对象和实现 IPrincipal 接口的对象在某种意义上是“连接的”，即当其中一个对象中的某些信息发生变化时，另一个对象也会相应地发生变化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T23:09:57.927

不确定我是否理解你的问题，但我相信你的假设是不正确的。

System.Web.Security 使用 MembershipUser 来通过 MembershipProvider 对用户进行身份验证，以便您在 Web 配置中设置。你打电话时...

```
MembershipUser user = Membership.GetUser(username); 
```

您的会员提供者将查询您保存用户信息的数据存储（A Sql 数据库、Active Directory 等），并返回为该用户名搜索的 Memberhsip 数据。

如果您在应用程序中定义了另一个实现 IPrincipal 接口的类，并且您已经实例化了该类型的对象，这并不一定意味着您的 MembershipUser 对象和您的自定义对象共享数据（当然，除非您以编程方式分配了引用）

也许如果您提供了一个代码示例，它将有助于澄清

# asp.net - URL 授权和非 Asp.Net 相关文件类型

> ID：846133
> 
> 赞同：0
> 
> 时间：2009-05-10T21:23:16.383
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication, authorization

URL 授权仅适用于 Asp.Net 相关文件类型？1 但为什么不能也适用于非 Asp.Net 文件类型？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T22:35:40.243

这是因为 ASP.NET 的脚本映射。只有某些扩展被映射到 ASP.NET。其余的由 IIS 直接处理。出于性能原因，这是设计使然。

有两种方法可以处理这个问题。

1.  在 NTFS 文件 ACL 的 web.config 文件中复制您的授权规则（即直接设置文件夹和文件的权限）。确保用户的身份验证方案与用于控制访问的帐户和组匹配...换句话说，如果您使用 SQL 存储用户名令牌，这将不起作用，因为这些令牌不一定会映射回域用户和组/角色。

2.  创建一个[IHttpHandler](http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx)来提供非 ASP.NET 文件。从该方法中，在传入 URL 上`ProcessRequest`调用该方法，然后使用. 您可能需要先设置 ContentType 属性。而且，（这里有个坏消息），您可能仍需要执行声明性或命令式访问检查——仅在 web.config 文件中添加条目可能不起作用。有关编写您自己的处理程序的更多信息，请参阅[使用 HTTP 进行自定义 ASP.NET 处理。](http://msdn.microsoft.com/en-us/library/5c67a8bd(VS.80).aspx)为每种内容类型制作单独的处理程序可能是个好主意。一旦你写了一个，你就会看到它们是多么容易制作。`Server.MapPath(url)``Response.WriteFile(filename)`

您可以*尝试*（我自己没有尝试过）将 <httpHandlers> 元素添加到您有其他 <authorization> 元素的 web.config 文件中 - 使用 <remove> 元素删除继承的 HttpHandler 并在子文件夹中添加另一个水平（也许指向同一个班级？）。我不确定这会奏效，但值得一试。

最后，如果您真的不想完成所有这些工作，您可以简单地在 IIS 中添加更多扩展映射。例如，查看[如何：注册 HTTP 处理程序](http://msdn.microsoft.com/en-us/library/46c5ddfy(VS.80).aspx)，您可以将 .jpg 文件的映射添加到 aspnet_isapi.dll（查看现有的 .aspx 映射等）。您不需要在 web.config 中添加 HttpHandler 元素，因为机器级别的 web.config 已经包含以下条目：

```
<add path="*" verb="GET,HEAD,POST" type="System.Web.DefaultHttpHandler" validate="true"/> 
```

请注意，这可能会给您的网站带来非常严重的性能问题。

# ssis - 安排 SSIS 包执行

> ID：846135
> 
> 赞同：29
> 
> 时间：2009-05-10T21:23:39.783
> 
> 标签：ssis, scheduled-tasks

如何安排 SSIS 在每天给定时间自动执行文件中的包？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-10T21:36:17.330

你有几个选择，但我会给你一些可以让你快速启动和运行的东西......

1.  打开 SQL Server Management Studio 并连接到将运行作业的 SQL Server 的数据库引擎。此 SQL Server 应安装并运行 SQL Server 代理。
2.  展开 SQL Server 代理，展开作业。
3.  右键单击，选择新建作业。
4.  创建包步骤时，对于**Type**选择*SQL Server Integration Services Package*。对于**包源**，选择*文件系统*。然后对于**包**，您可以使用浏览按钮 ( *...* ) 浏览文件系统上的 DTSX 文件。
5.  转到**计划**并像通常为任何其他 SQL Server 代理作业一样创建作业计划。在您的情况下，将**Frequency**设置为*Daily*，并将**Occurs once**的值设置为作业应该运行的任何时间。

有几件事要记住...

*   确保 SQL Server 代理服务帐户（这是默认设置，如果需要，您可以选择备用安全上下文）有权访问文件系统上的 dtsx 包。
*   这仅在您计划作业的服务器*也是*Integration Services 服务器时才有效。如果需要，有很多方法可以处理远程包执行。

有关其他信息，请参阅[https://msdn.microsoft.com/en-us/library/ms191439%28v=sql.105%29.aspx?f=255&MSPPError=-2147217396](https://msdn.microsoft.com/en-us/library/ms191439%28v=sql.105%29.aspx?f=255&MSPPError=-2147217396)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-04T20:28:13.377

我更喜欢上面的 anwser，但也可以使用 windows 任务计划程序并使用[dtexec](https://docs.microsoft.com/en-us/sql/integration-services/packages/dtexec-utility?view=sql-server-2017)启动您的 ssis 包。（仅可能在 SSIS 服务器上）[使用 dtexec 检查执行](https://stackoverflow.com/questions/805424/ssis-package-execution-using-dtexec-utility)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-10T13:02:28.750

第一选择 - 如果可能的话，安排包裹：

1) 将 SQL Server 代理用于标准作业

2）非标准windows任务调度，取决于包在做什么

3) dtexec 可以很好地发挥作用，但这取决于包运行的 ssis 任务

4) ssis 包做的越多，它可能需要的 dtexec 配置就越多，并设置为与 Windows 调度程序很好地配合

[![在此处输入图像描述](https://i.stack.imgur.com/YmWI0.png)](https://i.stack.imgur.com/YmWI0.png)

# c# - 重构 DAL 代码以支持存储过程

> ID：846136
> 
> 赞同：0
> 
> 时间：2009-05-10T21:24:31.500
> 
> 标签：c#, refactoring, data-access-layer

```
 private static readonly string dataProvider = ConfigurationManager.AppSettings.Get("Provider");
    private static readonly DbProviderFactory factory = DbProviderFactories.GetFactory(dataProvider);
    private static readonly string connectionString = ConfigurationManager.ConnectionStrings[dataProvider].ConnectionString;
    /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql)
    {
        using (DbConnection connection = factory.CreateConnection())
        {
            connection.ConnectionString = connectionString;

            using (DbCommand command = factory.CreateCommand())
            {
                command.Connection = connection;
                command.CommandText = sql;

                connection.Open();
                return command.ExecuteNonQuery();
            }
        }
    } 
```

我需要帮助来重写它，以便它可以与存储过程一起使用。（传入存储过程名称和参数）有谁知道我应该怎么做？编辑：我遇到问题的领域是试图找出填写参数的方法。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T21:36:33.040

您已经需要与是否正在实现存储过程无关的参数。

现在，您的代码可以使用类似的查询来调用`SELECT * FROM Table WHERE ID = @ID`，在这种情况下，您已经需要传递一个`Dictionary<string,object> params`. 在担心存储过程之前，让您的代码填写您已经拥有的命令的参数集合，并对其进行测试。

一旦成功，您应该简单地创建一个重载，该重载接受一个表示这是一个存储过程的布尔值，然后使用它来设置命令的 CommandType 属性。

* * *

**编辑：这是我将如何重构它**

*第 1 步：概括更新*

除了名称之外，Update 方法并没有什么特别之处可以防止它被用于其他非查询操作。所以：

```
 /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql)
    {
        return NonQuery(sql);
    }

    public static int NonQuery(string sql)
    {
        using (DbConnection connection = factory.CreateConnection())
        {
            connection.ConnectionString = connectionString;

            using (DbCommand command = factory.CreateCommand())
            {
                command.Connection = connection;
                command.CommandText = sql;

                connection.Open();
                return command.ExecuteNonQuery();
            }
        }
    } 
```

*第 2 步：参数呢？*

您当前的代码甚至无法处理使用参数的 UPDATE 查询，所以让我们开始修复它。首先，确保它在没有指定参数的情况下仍然有效：

```
 public static int NonQuery(string sql)
    {
        Dictionary<string, object> parameters = null;

        if (parameters == null)
        {
            parameters = new Dictionary<string, object>();
        }

        using (DbConnection connection = factory.CreateConnection())
        {
            connection.ConnectionString = connectionString;

            using (DbCommand command = factory.CreateCommand())
            {
                command.Connection = connection;
                command.CommandText = sql;

                foreach (KeyValuePair<string, object> p in parameters)
                {
                    var parameter = command.CreateParameter();
                    parameter.ParameterName = p.Key;
                    parameter.Value = p.Value;

                    command.Parameters.Add(parameter);
                }

                connection.Open();
                return command.ExecuteNonQuery();
            }
        }
    } 
```

一旦可行，将*参数*提升为参数。这不会影响任何现有的调用者`Update`：

```
 /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql)
    {
        return NonQuery(sql, null);
    }

    public static int NonQuery(string sql, Dictionary<string, object> parameters) 
```

此时，使用参数化查询测试 NonQuery。一旦成功，创建一个接受参数的 Update 重载：

```
 /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql)
    {
        return NonQuery(sql, null);
    }

    /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <param name="parameters">Name/value dictionary of parameters</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql, Dictionary<string, object> parameters)
    {
        return NonQuery(sql, parameters);
    } 
```

*第 3 步：考虑存储过程*

在如何处理存储过程方面几乎没有区别。你已经得到的隐含如下：

```
 using (DbCommand command = factory.CreateCommand())
            {
                command.Connection = connection;
                command.CommandText = sql;
                command.CommandType = CommandType.Text; 
```

因此，将 CommandType.Text 提升为重载中的参数：

```
 public static int NonQuery(string sql, Dictionary<string, object> parameters)
    {
        return NonQuery(sql, CommandType.Text, parameters);
    }

    public static int NonQuery(string sql, CommandType commandType, Dictionary<string, object> parameters) 
```

最后，如果您愿意，请更新`Update`：

```
 /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <param name="parameters">Name/value dictionary of parameters</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql, Dictionary<string, object> parameters)
    {
        return Update(sql, CommandType.Text, parameters);
    }

    /// <summary>
    /// Executes Update statements in the database.
    /// </summary>
    /// <param name="sql">Sql statement.</param>
    /// <param name="commandType">CommandType.Text or CommandType.StoredProcedure</param>
    /// <param name="parameters">Name/value dictionary of parameters</param>
    /// <returns>Number of rows affected.</returns>
    public static int Update(string sql, CommandType commandType, Dictionary<string, object> parameters)
    {
        return NonQuery(sql, parameters);
    } 
```

当然，作为读者的最后一个练习，您可以将所有 Update 调用替换为对 NonQuery 的调用，并完全摆脱 Update。

* * *

当然，这种简单的技术不处理输出参数，或者需要指定参数的 DbType 的情况。为此，您需要接受某种 ParameterCollection。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T21:28:35.877

您可以添加 3 个参数：

1.  `string SchemaName` -- 存储数据库模式的名称
2.  `string StoredProcName` -- 存储存储过程的名称
3.  `List<Parameter>`-- 存储过程参数列表

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T21:31:27.913

使用重载，例如

```
public static int Update(string storedProc, Dictionary<string,string> params)
{
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-10T21:49:06.560

我使用接口和泛型做类似的事情。

例子

```
 using System.Data.SqlClient;

public interface IParameter<T> where T : IEntity<T>
{
    void Populate(SqlParameterCollection parameters, T entity);
} 
```

使用 System.Data 实现接口的类；使用 System.Data.SqlClient；

```
public class UserParameter : IParameter<User>
{
    public void Populate(SqlParameterCollection parameters, User entity)
    {
        parameters.Add("@ID", SqlDbType.UniqueIdentifier).Value = entity.Id;
        parameters.Add("@Name", SqlDbType.NVarChar, 255).Value = entity.Name;
        parameters.Add("@EmailAddress", SqlDbType.NVarChar, 255).Value = entity.EmailAddress;
    }
} 
```

然后我们有执行更新的方法

```
 public void Update<T>(string prefix, IParameter<T> parameters, T entity)
        where T : class, IEntity<T>
    {
        using (var connection = this.Connection())
        {
            using (var command = new SqlCommand(string.Format("dbo.{0}_Update", prefix), connection))
            {
                command.CommandType = CommandType.StoredProcedure;

                parameters.Populate(command.Parameters, entity);

                connection.Open();

                command.ExecuteNonQuery();

                connection.Close();
            }
        }
    } 
```

然后我通过做类似的事情来调用它

更新（“用户”，新用户参数（），值）；

从读取器值填充实体时，我也会这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T21:52:50.343

您可能会遇到困难，具体取决于您计划放置它的环境。

如果我理解正确，您希望保留函数签名（单个字符串参数），但如果字符串中的第一个单词不是“UPDATE”，则以不同方式处理它。例如，这个字符串应该执行一个名为 UpdateTable1 的存储过程，它有四个参数：

```
UpdateTable1 NULL, A5KMI, "New description", #5/10/2009# 
```

或类似的东西。

问题是您需要在字符串其余部分的参数之间使用分隔符。为此，您必须将字符串分解为标记，这可能会很棘手。

因此，另一种方法是在整个字符串前面添加命令 EXEC，将整个内容设置为 CommandText 属性，然后调用其中一个 Execute 方法。

What I don't like about this is that it really opens you up with SQL injection vulnerability. If it's at all possible, use overloaded methods like the ones others have answered with, and make the caller split the arguments into a collection of some kind.

# python - Ruby 程序员学习 Python 的最快方法是什么？

> ID：846139
> 
> 赞同：17
> 
> 时间：2009-05-10T21:25:18.407
> 
> 标签：python, ruby

在过去四年左右的时间里，我一直在广泛地编写 Ruby 编程，而且我对这种语言非常熟悉。没有什么特别的原因，我决定这周学习一些 Python。是否有特定的书、教程或参考书非常适合来自几乎相同语言的人，或者我应该只是“潜入 Python”？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-10T21:30:45.577

一个安全的选择是深入研究 python（浏览一些解释语法的教程），然后开始编码。学习任何新语言的最好方法是编写代码，[很多](http://projecteuler.net/index.php?section=problems)。您在 Ruby 方面的经验将使您更容易掌握 Python 的动态概念（对于 Java 程序员来说可能更难习惯）。

尝试[python 教程](http://docs.python.org/tutorial/)或[学习 python 的书](http://www.diveintopython.org/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T21:31:11.003

我从[python 教程](http://docs.python.org/tutorial/)开始学习。它写得很好，很容易理解。然后我开始解决[python挑战](http://www.pythonchallenge.com/)中的问题。这是一种非常有趣的开始方式：）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-10T21:37:33.943

在浏览了一些在线教程（目前发布的那些看起来不错）之后，找到一个您已经完成（或正在处理）的当前 Ruby 项目并用 Python 重新编写它。我已经使用这种技术从各种语言进行转换，并且帮助很大。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-10T21:31:38.820

我建议只是深入研究 Python，它类似于 Ruby，所以你应该没有问题：

[http://www.diveintopython.net/](http://www.diveintopython.net/)

# c# - 应用程序中的 Visual C#“设置编辑器”？

> ID：846144
> 
> 赞同：7
> 
> 时间：2009-05-10T21:28:43.783
> 
> 标签：c#, .net, settings

有没有一种简单的方法可以在`Settings.settings`文件（或任何其他设置文件）周围包裹“首选项面板”？

基本上我有一堆字符串存储在`Settings.settings`，并希望有一个表单，用户可以编辑这些..

我可以添加一堆文本框，并`Properties.blah = this.blahInput.Text; Properties.Save();`为每个文本框设置一个按钮，但这感觉就像在重新发明轮子。

*编辑：* PropertyGrid 控件（如[bassfriend's](https://stackoverflow.com/questions/846144/visual-c-settings-editor-within-application/846163#846163)所建议的）看起来很完美，但我无法弄清楚如何将属性网格的 SelectedObject 绑定到`Properties.Settings.Default`- 当我尝试时出现以下错误：

```
Cannot implicitly convert type 'MyProject.Properties.Settings' to 'object[]' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-10T21:35:38.220

也许您想看看[PropertyGrid Control](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T22:41:50.873

我没有问题：

```
 propertyGrid1.SelectedObject = Properties.Settings.Default; 
```

我确实必须在设置设计器中将可见性更改为公开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T22:45:30.477

也许您需要使用 Settings.Default.Properties 属性？这将返回 SettingsPropertyCollection，它应该可以转换为对象 []。

# prolog - 在 Prolog 中获取谓词的所有解决方案

> ID：846145
> 
> 赞同：5
> 
> 时间：2009-05-10T21:29:00.710
> 
> 标签：prolog

我正在用 Prolog 编写一个文字冒险游戏，并且正在打印房间出口。我有代码：

```
exits_from(Room) :-
  connected(Room, X),
  write(X), write('  '). 
```

其中 connected/2 是：

```
connected(X, Y) :- path(X, Y).
connected(X, Y) :- path(Y, X). 
```

路径是：

```
path(room, hallway).
path(hallway, foyer). 
```

等等。

但是，当我打印房间的出口时，它得到第一个，然后想要一个';' 说我想要另一个解决方案。无论如何，是否有强制谓词完全计算结果，这样玩家就不必继续要求更多的退出？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-10T23:38:31.997

一种方法是做类似的事情

```
print_all_solutions :-
  solution(Sol),
  write(Sol),
  fail. % this causes backtracking
print_all_solutions. % succed 
```

另一种是使用特殊谓词 forall，如下所示：

```
forall(solution(Sol), write(Sol)) 
```

# xml - JSON.Net：将 JSON 字符串从 XML 字符串转换为实例问题

> ID：846155
> 
> 赞同：1
> 
> 时间：2009-05-10T21:31:51.003
> 
> 标签：xml, json.net

我有以下功能：

```
public static T GetInstance<T>(string xmlString)
{
   var xmlDoc = new XmlDocument();
   xmlDoc.Load(new StringReader(xmlString));
   string jsonString = JsonConvert.SerializeXmlNode(xmlDoc.DocumentElement);
   T instance = JsonConvert.DeserializeObject(jsonString, typeof(T)) as T;
   return instance;
} 
```

它适用于普通的 XML 字符串。但是，如果输入 XML 字符串包含以下注释：

```
....
<!-- some comments ... 
-->
.... 
```

那么对 JsonConvert.DeserializeObject() 的函数调用会抛出异常：

```
Newtonsoft.Json.JsonSerializationException was unhandled
Message="Unexpected token when deserializing object: Comment"
Source="Newtonsoft.Json"
StackTrace:
   at Newtonsoft.Json.JsonSerializer.PopulateObject(Object newObject, JsonReader reader, Type objectType)
   .... 
```

要么我必须删除 XML 字符串中的所有注释，要么我可以使用 JsonConvert 中的任何选项设置来忽略注释。

对于第一个选项，如果我必须使用 XmlDocument 删除所有注释，那么 XmlDocument 中是否有任何选项可用于将 XML 字符串转换为仅限节点的 XML 字符串？

对于第二个选项，我更喜欢，如果 Json.Net 中有任何选项可以在反序列化为对象时忽略注释？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T03:51:18.823

我认为现在对我来说最好的方法是首先从 xml 字符串中删除所有注释节点。

```
public static string RemoveComments(
        string xmlString,
        int indention)
{
   XmlDocument xDoc = new XmlDocument();
   xDoc.PreserveWhitespace = false;
   xDoc.LoadXml(xmlString);
   XmlNodeList list = xDoc.SelectNodes("//comment()");

   foreach (XmlNode node in list)
   {
      node.ParentNode.RemoveChild(node);
   }

   string xml;
   using (StringWriter sw = new StringWriter())
   {
      using (XmlTextWriter xtw = new XmlTextWriter(sw))
      {
        if (indention > 0)
        {
          xtw.IndentChar = ' ';
          xtw.Indentation = indention;
          xtw.Formatting = System.Xml.Formatting.Indented;
        }

        xDoc.WriteContentTo(xtw);
        xtw.Close();
        sw.Close();
      }
      xml = sw.ToString();
    }

  return xml;
  } 
```

这是我从 xml 字符串中获取实例的函数：

```
public static T GetInstance<T>(string xmlString)
{
  srring xml = RemoveComments(xmlString);
  var xmlDoc = new XmlDocument();
  xmlDoc.Load(new StringReader(xml));
  string jsonString = JsonConvert.SerializeXmlNode(xmlDoc.DocumentElement);
  T instance = JsonConvert.DeserializeObject(jsonString, typeof(T)) as T;
  return instance;
} 
```

# java - 在 Java 中打开 Microsoft Word

> ID：846157
> 
> 赞同：1
> 
> 时间：2009-05-10T21:32:03.827
> 
> 标签：java, apache, ms-word, apache-poi

我正在尝试在 java 中打开 MS Word 2003 文档，搜索指定的字符串并将其替换为新字符串。我使用 APACHE POI 来做到这一点。我的代码如下所示：

```
public void searchAndReplace(String inputFilename, String outputFilename,
            HashMap<String, String> replacements) {
    File outputFile = null;
    File inputFile = null;
    FileInputStream fileIStream = null;
    FileOutputStream fileOStream = null;
    BufferedInputStream bufIStream = null;
    BufferedOutputStream bufOStream = null;
    POIFSFileSystem fileSystem = null;
    HWPFDocument document = null;
    Range docRange = null;
    Paragraph paragraph = null;
    CharacterRun charRun = null;
    Set<String> keySet = null;
    Iterator<String> keySetIterator = null;
    int numParagraphs = 0;
    int numCharRuns = 0;
    String text = null;
    String key = null;
    String value = null;
        try {
            // Create an instance of the POIFSFileSystem class and
            // attach it to the Word document using an InputStream.
            inputFile = new File(inputFilename);
            fileIStream = new FileInputStream(inputFile);
            bufIStream = new BufferedInputStream(fileIStream);
            fileSystem = new POIFSFileSystem(bufIStream);
            document = new HWPFDocument(fileSystem);
            docRange = document.getRange();
            numParagraphs = docRange.numParagraphs();
            keySet = replacements.keySet();
            for (int i = 0; i < numParagraphs; i++) {
                paragraph = docRange.getParagraph(i);
                text = paragraph.text();
                numCharRuns = paragraph.numCharacterRuns();
                for (int j = 0; j < numCharRuns; j++) {
                    charRun = paragraph.getCharacterRun(j);
                    text = charRun.text();
                    System.out.println("Character Run text: " + text);
                    keySetIterator = keySet.iterator();
                    while (keySetIterator.hasNext()) {
                        key = keySetIterator.next();
                        if (text.contains(key)) {
                            value = replacements.get(key);
                            charRun.replaceText(key, value);
                            docRange = document.getRange();
                            paragraph = docRange.getParagraph(i);
                            charRun = paragraph.getCharacterRun(j);
                            text = charRun.text();
                        }
                    }
                }
            }
            bufIStream.close();
            bufIStream = null;
            outputFile = new File(outputFilename);
            fileOStream = new FileOutputStream(outputFile);
            bufOStream = new BufferedOutputStream(fileOStream);
            document.write(bufOStream);
        } catch (Exception ex) {
            System.out.println("Caught an: " + ex.getClass().getName());
            System.out.println("Message: " + ex.getMessage());
            System.out.println("Stacktrace follows.............");
            ex.printStackTrace(System.out);
        }
} 
```

我用以下参数调用这个函数：

```
HashMap<String, String> replacements = new HashMap<String, String>();
replacements.put("AAA", "BBB");
searchAndReplace("C:/Test.doc", "C:/Test1.doc", replacements); 
```

当 Test.doc 文件包含这样的简单行：“ **AAA EEE** ”时，它可以成功运行，但是当我使用复杂的文件时，它会成功读取内容并生成 Test1.doc 文件，但是当我尝试打开它时，它会给我以下错误：

**Word 无法读取此文档。它可能是腐败的。尝试以下一项或多项操作： * 打开并修复文件。* 使用文本恢复转换器打开文件。(C:\Test1.doc)**

请告诉我该怎么做，因为我是 POI 的初学者，我还没有找到一个好的教程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T21:41:10.550

首先，您应该关闭文档。

除此之外，我建议您将原始 Word 文档重新保存为 Word XML 文档，然后手动将扩展名从 .XML 更改为 .doc 。然后查看您正在使用的实际文档的 XML 并跟踪内容以确保您不会意外编辑十六进制值（AAA 和 EEE 可能是其他字段中的十六进制值）。

如果没有看到实际的 Word 文档，很难说出发生了什么。

根本没有太多关于 POI 的文档，不幸的是对于 Word 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T08:40:14.043

我不知道：可以回答自己，但只是为了分享知识，我会回答自己。

浏览网页后，我找到的最终解决方案是：名为**[docx4j](http://dev.plutext.org/projects.html)**的库非常适合处理 MS docx 文件，虽然它的文档到现在还不够，它的论坛仍处于起步阶段，但总的来说它帮助我做我需要的..

感谢所有帮助我的4..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T07:15:06.883

您可以尝试[OpenOffice API](http://weblogs.java.net/blog/tchangu/archive/2005/12/open_office_jav_1.html)，但没有很多资源可以告诉您如何使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T06:53:26.263

看起来[这](http://support.microsoft.com/kb/889409)可能是问题所在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-19T09:20:14.640

你也可以试试这个：[http ://www.dancrintea.ro/doc-to-pdf/](http://www.dancrintea.ro/doc-to-pdf/)

# c# - 建议用于监控我的 asp.net 应用程序的流量

> ID：846162
> 
> 赞同：4
> 
> 时间：2009-05-10T21:34:59.547
> 
> 标签：c#, asp.net, iis, web-applications

我有一个托管在 IIS 7.0 上的 asp.net 3.5 应用程序。我正在寻找一个全面的系统来监控流量，最低到页面级别。.net 是否有任何特定工具，或者我自己编写更好，或者可以免费使用哪些系统/软件

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-10T22:19:16.260

使用**[谷歌分析](http://www.google.com/analytics)**。它是在标签之前插入的一小段 Javascript 代码。它基于谷歌购买的 Urchin 分析跟踪软件。他们已经这样做了很长时间了。

只要使用完全限定域名引用您的网站，Google Analytics（分析）就可以跟踪您的需求。过滤器机制也有很大的灵活性（让我们根据查询字符串参数等重写 URL）

如果您需要对点击以外的其他内容进行跟踪，那么很多功能和经过深思熟虑的 API 以及非常好的 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T22:12:40.140

如果您有权访问 IIS 日志，则可以使用日志分析器来解释数据。一个例子是免费的 AStats 分析器：

[http://awstats.sourceforge.net/](http://awstats.sourceforge.net/)

另一种选择（也是我推荐的一种）是 Google Analytics（[http://www.google.com/analytics](http://www.google.com/analytics)）。这依赖于您在要跟踪的每个页面中嵌入一小段 Javascript，然后 Google 会为您完成繁重的工作，将结果呈现在一个有吸引力的 Flash 丰富的网站中。

我建议两者都尝试，看看哪个适合您的需求。我绝对建议不要滚动您自己的系统，因为上述解决方案非常成熟且功能强大。祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T22:22:59.733

您需要客户端/javascript 跟踪服务（例如 Google Analytics，但还有其他不错的免费替代品），因为即使用户单击后退按钮并且上一页（在您的网站上）从浏览器缓存而不是服务器。IIS 不会“看到”重新加载，因为没有向它发出请求。

# javascript - 如何将变量与 Jquery 结合起来？

> ID：846167
> 
> 赞同：2
> 
> 时间：2009-05-10T21:37:26.190
> 
> 标签：javascript, jquery, variables

得到以下代码：

```
$(document).ready(function() 
{
   $('a.add-item').click(function()
   {
         if ($(this).parent().find('input').attr('value', '0'))
         {
            $(this).parent().find('input').attr('value', '1')
         }
   });
}); 
```

我想做的是创建一个变量并递增它，然后将其添加到我上面的代码中替换 .attr('value', '0')) **0**

我该怎么办？

谢谢，基思

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T21:44:00.420

你的意思是这样的：

```
$(document).ready(function() 
{
   $('a.add-item').click(function()
   {
         var $item = $(this).parent().find('input');
         var value = parseInt($item.attr('value'), 10);
         if (!value) {
             value = 0;
         }
         $item.attr('value', value + 1);
   });
}); 
```

# java - 在流中搜索字符串的有效方法

> ID：846175
> 
> 赞同：53
> 
> 时间：2009-05-10T21:43:26.617
> 
> 标签：java, algorithm, string, search, stream

假设有一个我想检查特定字符串的文本流（或 Java 中的 Reader）。文本流可能非常大，因此一旦找到搜索字符串，我想返回 true 并尽量避免将整个输入存储在内存中。

天真地，我可能会尝试做这样的事情（在 Java 中）：

```
public boolean streamContainsString(Reader reader, String searchString) throws IOException {
    char[] buffer = new char[1024];
    int numCharsRead;
    while((numCharsRead = reader.read(buffer)) > 0) {
        if ((new String(buffer, 0, numCharsRead)).indexOf(searchString) >= 0)
            return true;
    }
    return false;
} 
```

当然，如果它出现在 1k 缓冲区的边界上，这将无法检测到给定的搜索字符串：

搜索文本：“stackoverflow”
流缓冲区 1：“abc.........stack”
流缓冲区 2：“overflow.......xyz”

如何修改此代码，以便它正确地找到跨越缓冲区边界的给定搜索字符串，但不将整个流加载到内存中？

**编辑：**注意在流中搜索字符串时，我们试图**最小化流中的读取次数**（以避免网络/磁盘中的延迟）并**保持内存使用量不变**，而不管流中的数据量如何。[字符串匹配算法](http://en.wikipedia.org/wiki/String_searching_algorithm)的实际效率是次要的，但很明显，找到一个使用这些算法中更有效之一的解决方案会很好。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-11T04:43:13.280

这里有三个很好的解决方案：

1.  如果您想要一些简单且相当快速的东西，请不要使用缓冲区，而是实现一个简单的非确定性有限状态机。您的状态将是您正在搜索的字符串的索引列表，您的逻辑看起来像这样（伪代码）：

    ```
    String needle;
    n = needle.length();

    for every input character c do
      add index 0 to the list
      for every index i in the list do
        if c == needle[i] then
          if i + 1 == n then
            return true
          else
            replace i in the list with i + 1
          end
        else
          remove i from the list
        end
      end
    end 
    ```

    如果字符串存在，这将找到字符串，并且您将永远不需要缓冲区。

2.  工作量稍大但速度更快：进行 NFA 到 DFA 的转换，提前计算出可能的索引列表，并将每个索引分配给一个小整数。（如果您在 Wikipedia 上阅读了有关字符串搜索的信息，这称为*powerset 构造*。）然后您有一个状态，并且您对每个传入的字符进行状态到状态的转换。您想要的 NFA 只是字符串的 DFA，其前面带有一个不确定地丢弃字符或尝试使用当前字符的状态。您还需要一个明确的错误状态。

3.  如果您想要更快的速度，请创建一个大小至少为两倍的缓冲区`n`，并让用户 Boyer-Moore 从 编译状态机`needle`。您会遇到很多额外的麻烦，因为 Boyer-Moore 的实现并非易事（尽管您会在网上找到代码），而且您必须安排将字符串滑过缓冲区。您必须构建或找到一个可以“滑动”而无需复制的*循环缓冲区；*否则，您可能会回馈您从 Boyer-Moore 获得的任何性能提升。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-21T21:55:33.170

我对部分搜索的 Knuth Morris Pratt 算法做了一些更改。由于实际比较位置总是小于或等于下一个，因此不需要额外的内存。带有 Makefile 的代码也可以在[github](https://github.com/databigbang/stream-oriented-knuth-morris-pratt)上找到，它是用 Haxe 编写的，可以同时针对多种编程语言，包括 Java。

我还写了一篇相关文章：[在流中搜索子字符串：对 Haxe 中 Knuth-Morris-Pratt 算法的轻微修改](http://blog.databigbang.com/searching-for-substrings-in-streams-a-slight-modification-of-the-knuth-morris-pratt-algorithm-in-haxe/)。这篇文章提到了[Jakarta RegExp](http://jakarta.apache.org/regexp/)，现在已经退休并在 Apache Attic 中休息。雅加达正则表达式库“<a href="http://jakarta.apache.org/regexp/apidocs/org/apache/regexp/RE.html#match%28org.apache.regexp.CharacterIterator,%20int%29" rel RE 类中的 ="noreferrer">match" 方法使用 CharacterIterator 作为参数。

```
class StreamOrientedKnuthMorrisPratt {
    var m: Int;
    var i: Int;
    var ss:
    var table: Array<Int>;

    public function new(ss: String) {
        this.ss = ss;
        this.buildTable(this.ss);
    }

    public function begin() : Void {
        this.m = 0;
        this.i = 0;
    }

    public function partialSearch(s: String) : Int {
        var offset = this.m + this.i;

        while(this.m + this.i - offset < s.length) {
            if(this.ss.substr(this.i, 1) == s.substr(this.m + this.i - offset,1)) {
                if(this.i == this.ss.length - 1) {
                    return this.m;
                }
                this.i += 1;
            } else {
                this.m += this.i - this.table[this.i];
                if(this.table[this.i] > -1)
                    this.i = this.table[this.i];
                else
                    this.i = 0;
            }
        }

        return -1;
    }

    private function buildTable(ss: String) : Void {
        var pos = 2;
        var cnd = 0;

        this.table = new Array<Int>();
        if(ss.length > 2)
            this.table.insert(ss.length, 0);
        else
            this.table.insert(2, 0);

        this.table[0] = -1;
        this.table[1] = 0;

        while(pos < ss.length) {
            if(ss.substr(pos-1,1) == ss.substr(cnd, 1))
            {
                cnd += 1;
                this.table[pos] = cnd;
                pos += 1;
            } else if(cnd > 0) {
                cnd = this.table[cnd];
            } else {
                this.table[pos] = 0;
                pos += 1;
            }
        }
    }

    public static function main() {
        var KMP = new StreamOrientedKnuthMorrisPratt("aa");
        KMP.begin();
        trace(KMP.partialSearch("ccaabb"));

        KMP.begin();
        trace(KMP.partialSearch("ccarbb"));
        trace(KMP.partialSearch("fgaabb"));

    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-11T05:01:25.527

[Knuth-Morris-Pratt 搜索算法](http://en.wikipedia.org/wiki/KMP_algorithm)从不备份；这只是您想要用于流搜索的属性。我以前用过它来解决这个问题，尽管使用可用的 Java 库可能有更简单的方法。（当我遇到这个问题时，我在 90 年代使用 C 语言工作。）

KMP 本质上是一种构建字符串匹配 DFA 的快速方法，就像 Norman Ramsey 的建议 #2。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-10T21:53:23.837

此答案适用于问题的初始版本，其中关键是仅在必要时读取流以匹配字符串（如果该字符串存在）。此解决方案不符合保证固定内存利用率的要求，但如果您发现此问题并且不受该约束的约束，则可能值得考虑。

如果您受到常量内存使用约束的约束，Java 将任何类型的数组存储在堆上，因此将引用置空不会以任何方式释放内存；我认为任何涉及循环中数组的解决方案都会消耗堆上的内存并需要 GC。

* * *

对于简单的实现，也许 Java 5 的[Scanner](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)可以接受 InputStream 并使用[java.util.regex.Pattern](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html)来搜索输入，这可能会让您不必担心实现细节。

这是一个潜在实现的示例：

```
public boolean streamContainsString(Reader reader, String searchString)
            throws IOException {
      Scanner streamScanner = new Scanner(reader);
      if (streamScanner.findWithinHorizon(searchString, 0) != null) {
        return true;
      } else {
        return false;
      }
} 
```

我正在考虑正则表达式，因为它听起来像是有限状态自动机的工作，它从初始状态开始，逐个字符地更改状态，直到它拒绝字符串（不匹配）或进入接受状态。

我认为这可能是您可以使用的最有效的匹配逻辑，并且您如何组织信息的读取可以脱离匹配逻辑进行性能调整。

这也是正则表达式的工作方式。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-11T04:49:13.237

不要让缓冲区成为数组，而是使用实现**循环缓冲区**的抽象。您的索引计算将是`buf[(next+i) % sizeof(buf)]`，并且您必须小心一次将缓冲区填满一半。但只要搜索字符串适合缓冲区的一半，您就会找到它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-11T21:28:34.647

我相信这个问题的最佳解决方案是尽量保持简单。请记住，因为我正在从流中读取，所以我想将流中的读取次数保持在最低限度（因为网络或磁盘延迟可能是一个问题），同时保持使用的内存量恒定（因为流可能是尺寸非常大）。字符串匹配的实际效率不是第一目标（因为已经[研究死](http://en.wikipedia.org/wiki/String_searching_algorithm)了）。

根据 AlbertoPL 的建议，这是一个简单的解决方案，将缓冲区与搜索字符串逐个字符进行比较。关键是因为一次只搜​​索一个字符，不需要回溯，因此不需要循环缓冲区或特定大小的缓冲区。

现在，如果有人可以基于[Knuth-Morris-Pratt 搜索算法](http://en.wikipedia.org/wiki/KMP%5Falgorithm)提出类似的实现，那么我们将有一个很好的有效解决方案；）

```
public boolean streamContainsString(Reader reader, String searchString) throws IOException {
    char[] buffer = new char[1024];
    int numCharsRead;
    int count = 0;
    while((numCharsRead = reader.read(buffer)) > 0) {
        for (int c = 0; c < numCharsRead; c++) {
            if (buffer[c] == searchString.charAt(count))
                count++;
            else
                count = 0;
            if (count == searchString.length()) return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-20T18:42:49.517

在 Ujorm 框架的 RingBuffer 类中实现了对流的非常快速的搜索。请参阅示例：

```
 Reader reader = RingBuffer.createReader("xxx ${abc} ${def} zzz");

 String word1 = RingBuffer.findWord(reader, "${", "}");
 assertEquals("abc", word1);

 String word2 = RingBuffer.findWord(reader, "${", "}");
 assertEquals("def", word2);

 String word3 = RingBuffer.findWord(reader, "${", "}");
 assertEquals("", word3); 
```

[SourceForge 上](http://ujoframework.svn.sourceforge.net/viewvc/ujoframework/trunk/project-m2/ujo-core/src/main/java/org/ujorm/core/RingBuffer.java?view=markup)提供了单一类实现：有关更多信息，请参阅[链接](http://ujorm.org/javadoc/org/ujorm/package-summary.html#RingBuffer)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-10T21:47:23.707

实现一个滑动窗口。让你的缓冲区四处走动，将缓冲区中的所有元素向前移动一个，最后在缓冲区中输入一个新字符。如果缓冲区等于您搜索的单词，则包含它。

当然，如果您想提高效率，您可以寻找一种方法来防止移动缓冲区中的所有元素，例如通过使用循环缓冲区和以与缓冲区相同的方式“循环”的字符串的表示确实如此，因此您只需要检查内容平等。这样可以节省移动缓冲区中的所有元素。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-10T21:48:34.983

我认为您需要在缓冲区之间的边界处缓冲少量。

例如，如果您的缓冲区大小为 1024 并且 SearchString 的长度为 10，那么除了搜索每个 1024 字节缓冲区之外，您还需要搜索两个缓冲区之间的每个 18 字节转换（距前一个缓冲区末尾的 9 个字节）与从下一个缓冲区开始的 9 个字节连接）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-10T21:53:05.163

我会说切换到逐个字符的解决方案，在这种情况下，您将扫描目标文本中的第一个字符，然后当您发现该字符增加一个计数器并查找下一个字符时。每次找不到下一个连续字符时，都会重新启动计数器。它会像这样工作：

```
public boolean streamContainsString(Reader reader, String searchString) throws IOException {
char[] buffer = new char[1024];
int numCharsRead;
int count = 0;
while((numCharsRead = reader.read(buffer)) > 0) {
    if (buffer[numCharsRead -1] == searchString.charAt(count))
        count++;
    else
        count = 0;

    if (count == searchString.size())    
     return true;
}
return false; 
} 
```

唯一的问题是当您正在浏览字符时......在这种情况下，需要有一种方法来记住您的计数变量。除了作为整个班级的私有变量之外，我没有看到这样做的简单方法。在这种情况下，您不会在此方法中实例化 count 。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-10T22:30:00.033

如果您不喜欢使用 Reader，那么您可以使用 Java 的 NIO API 来有效地加载文件。例如（未经测试，但应该接近工作）：

```
public boolean streamContainsString(File input, String searchString) throws IOException {
    Pattern pattern = Pattern.compile(Pattern.quote(searchString));

    FileInputStream fis = new FileInputStream(input);
    FileChannel fc = fis.getChannel();

    int sz = (int) fc.size();
    MappedByteBuffer bb = fc.map(FileChannel.MapMode.READ_ONLY, 0, sz);

    CharsetDecoder decoder = Charset.forName("UTF-8").newDecoder();
    CharBuffer cb = decoder.decode(bb);

    Matcher matcher = pattern.matcher(cb);

    return matcher.matches();
} 
```

这基本上是 mmap() 是要搜索的文件，并且依赖于操作系统来执行有关缓存和内存使用的正确操作。但是请注意，对于小于约 10 KiB 的文件，仅将文件读入大缓冲区的 map() 成本更高。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-14T17:48:21.643

您也许可以使用快速傅立叶变换实现一个非常快速的解决方案，如果实现得当，您可以在 O(nlog(m)) 时间内进行字符串匹配，其中 n 是要匹配的较长字符串的长度， m 是较短字符串的长度。例如，您可以在收到长度为 m 的流输入后立即执行 FFT，如果匹配，则可以返回，如果不匹配，则可以丢弃流输入中的第一个字符，等待让一个新字符通过流出现，然后再次执行 FFT。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-10T21:55:45.113

[您可以通过使用一些字符串搜索算法](http://en.wikipedia.org/wiki/String_searching_algorithm)来提高搜索非常大的字符串的速度

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-11T04:00:51.727

如果您正在寻找常量子字符串而不是正则表达式，我建议您使用 Boyer-Moore。互联网上有大量的源代码。

此外，使用循环缓冲区，以避免对缓冲区边界考虑太多。

麦克风。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-07-20T18:20:48.420

我也有类似的问题：从 InputStream 中跳过字节，直到指定字符串（或字节数组）。这是基于循环缓冲区的简单代码。它不是很有效，但可以满足我的需求：

```
 private static boolean matches(int[] buffer, int offset, byte[] search) {
    final int len = buffer.length;
    for (int i = 0; i < len; ++i) {
      if (search[i] != buffer[(offset + i) % len]) {
        return false;
      }
    }
    return true;
  }

  public static void skipBytes(InputStream stream, byte[] search) throws IOException {
    final int[] buffer = new int[search.length];
    for (int i = 0; i < search.length; ++i) {
      buffer[i] = stream.read();
    }

    int offset = 0;
    while (true) {
      if (matches(buffer, offset, search)) {
        break;
      }
      buffer[offset] = stream.read();
      offset = (offset + 1) % buffer.length;
    }
  } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-24T09:59:12.597

这是我的实现：

```
static boolean containsKeywordInStream( Reader ir, String keyword, int bufferSize ) throws IOException{
    SlidingContainsBuffer sb = new SlidingContainsBuffer( keyword );
    char[] buffer = new char[ bufferSize ];
    int read;
    while( ( read = ir.read( buffer ) ) != -1 ){
        if( sb.checkIfContains( buffer, read ) ){
            return true;
        }
    }
    return false;
} 
```

SlidingContainsBuffer 类：

```
class SlidingContainsBuffer{

    private final char[] keyword;
    private int keywordIndexToCheck = 0;
    private boolean keywordFound = false;

    SlidingContainsBuffer( String keyword ){
        this.keyword = keyword.toCharArray();
    }

    boolean checkIfContains( char[] buffer, int read ){
        for( int i = 0; i < read; i++ ){
            if( keywordFound == false ){
                if( keyword[ keywordIndexToCheck ] == buffer[ i ] ){
                    keywordIndexToCheck++;
                    if( keywordIndexToCheck == keyword.length ){
                        keywordFound = true;
                    }
                } else {
                    keywordIndexToCheck = 0;
                }
            } else {
                break;
            }
        }
        return keywordFound;
    }
} 
```

这个答案完全符合任务：

1.  即使在缓冲区之间拆分，实现也能够找到搜索的关键字
2.  由缓冲区大小定义的最小内存使用量
3.  使用更大的缓冲区将最小化读取次数

# visual-studio-2005 - 可以在工程（.vcproj）文件中设置工作目录吗？

> ID：846180
> 
> 赞同：19
> 
> 时间：2009-05-10T21:47:18.480
> 
> 标签：visual-studio-2005, solution, working-directory, vcproj

我有一个为 Visual Studio 2005 生成 .sln 文件和一些 .vcproj 文件的脚本。我需要设置 WorkingDirectory 选项，但它在 .user 文件中指定。我们目前无法生成的文件。我在 msdn 找到了[vcproj 文件定义](http://msdn.microsoft.com/en-us/library/2208a1f2(VS.80).aspx)，但似乎无法从那里设置此选项。

**如何从 .sln 或 .vcproj 文件中指定“配置属性->调试->工作目录”？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-08-25T18:54:18.753

更改设置并关闭 sln 后，您将获得一个用户文件，名称如下：

`Project_Name.vcproj.Domain.user_name.user`

将其更改为： `Project_Name.vcproj.user`并提交。

下一个签出代码的人将使用此用户文件来创建他们的用户特定文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T22:06:15.597

改变我的评论。我确实找到了财产：

[VCDebugSettings.WorkingDirectory](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vcprojectengine.vcdebugsettings.workingdirectory.aspx)

使用 Visual Studio 可扩展性创建调用此方法的加载项或宏。您应该能够挂钩到 BeforeCompile 事件或设置它的东西。

不是一个简单的答案，但可行。

# .net - 如何在 ExecutionContext 中包含自己的数据

> ID：846187
> 
> 赞同：11
> 
> 时间：2009-05-10T21:50:42.517
> 
> 标签：.net, multithreading

我知道，当您通过调用 BeginInvoke() 或 ThreadPool.QueueUserWorkItem(...) 并行运行某些方法时，.NET 框架正在捕获包含代码访问安全信息和其他一些内容的 ExecutionContext 对象。

我想要的是在 ExecutionContext 中包含我的并行方法所需的一些数据，但也必须在排队任务时捕获。

问题是我并不总是可以控制创建这个并行任务的代码，所以我必须在调用这个外部代码之前找到一种方法来存储这些数据。这就是为什么我想到 ExecutionContext 类。

当我并不总是控制在线程之间拆分工作的代码时，有什么方法可以将某些状态传递给并行任务。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-11T08:10:01.507

找到了：

```
CallContext.LogicalSetData(...) 
```

（[文档](http://msdn.microsoft.com/en-ca/library/system.runtime.remoting.messaging.callcontext.logicalsetdata.aspx)）

和

```
CallContext.LogicalGetData(...) 
```

（[文档](http://msdn.microsoft.com/en-ca/library/system.runtime.remoting.messaging.callcontext.logicalgetdata.aspx)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T22:34:41.510

我不知道它与 . 有什么关系`ExecutionContext`，但在过去，我们可以创建上下文绑定对象。请参阅[上下文类](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.contexts.context.aspx)。忽略这个特定的类是用于基础设施的事实 - 这篇文章是了解上下文的起点。

# php - 将照片发送到电子邮件机器人，将照片上传到网站

> ID：846199
> 
> 赞同：5
> 
> 时间：2009-05-10T21:57:31.773
> 
> 标签：php, email, upload, photo, bots

我不断采取以下步骤，并且我知道有一种方法可以自动执行此操作：

1.  将手机中的照片通过电子邮件发送给自己
2.  将这些照片保存到我的电脑
3.  将保存的照片上传到网站

有没有办法编写一个脚本（可能在 PHP 中），它执行以下操作：

1.  收听任何带有 bot 电子邮件附件的电子邮件（例如：bot@site.com）
2.  自动将发送到该电子邮件的任何附件上传到网站？（例如：上传到 www.site.com/photos）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T22:32:25.723

如果您必须在服务器上安装它，有几种方法。

*   PHP 可以[通过 POP3 或 IMAP](http://us2.php.net/manual/en/book.imap.php)检查邮件帐户。您可以运行一个 cron 作业，该作业触发一个 PHP 脚本，每隔几分钟检查一个秘密电子邮件帐户并在那里进行处理。
*   传入的电子邮件也可以直接通过[管道传输](http://www.evolt.org/incoming_mail_and_php)到 PHP 脚本

我只使用 Flickr，他们会给你一个随机的电子邮件地址@flickr.com，你可以发送附件并自动处理它们。如果您同意 Flickr 托管您的照片，那么这是最快和最简单的选择。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-10T22:04:50.450

如果您的手机可以上网，为什么要给他们发电子邮件而不是直接将照片上传到您的网站？许多移动平台都有用于向博客和托管服务（如 Flickr）添加条目和图像的客户端。也许有适合您手机的客户端？

* * *

脚本本身是一个被动的东西。虽然我不熟悉 PHP，但是...如果您有一个 24 小时/天打开的页面，您可以将 JavaScript 在 10 分钟内循环调用一些服务器方法以检查电子邮件，如果有附件则启动异步表单邮政。

如果您可以详细说明以及您可以使用的任何东西，那就太好了。它是您的站点并且您具有管理权限还是您只是一个用户？除了 HTTP POST 之外，是否还有其他 API 可供使用？

我相信，除非它是您自己的站点，否则您将需要在某个地方始终运行 PC，同时打开浏览器窗口或桌面程序。

# hibernate - 使用 Spring 在 Struts 中设置全局变量

> ID：846200
> 
> 赞同：1
> 
> 时间：2009-05-10T21:57:54.097
> 
> 标签：hibernate, spring, struts

在 Struts 中设置 servlet 上下文变量的最佳方法是什么？此变量显示在标题磁贴的每个页面上，并且必须从数据库加载。为此目的，有返回请求值的 Hibernate DAO 和 Spring Service。

我目前的方法是扩展 Struts PlugIn 类并将我的服务注入其中。这不可能直接在 Struts 中完成，但我找到了一个页面（[http://opensource.atlassian.com/confluence/spring/display/DISC/Spring-enabling+Struts+PlugIns](http://opensource.atlassian.com/confluence/spring/display/DISC/Spring-enabling+Struts+PlugIns)），其中 Ulrik Sandberg 创建了一个允许这样的代理功能。这在我部署我的应用程序时有效，但 JUnit 在 java.lang.NullPointerException 上的 servletunit.struts.MockStrutsTestCase.getActionServlet(MockStrutsTestCase.java:331) 某处失败。

我可以采取另一种方法，它不会涉及调试其他人的课程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T00:53:55.570

查看 spring 参考指南和有关 bean 范围的部分 (3.4)。您可以拥有一个在浏览器会话的生命周期内维护的 bean，并将其设置为代理会话 bean。

```
<!-- a HTTP Session-scoped bean exposed as a proxy -->
<bean id="userPreferences" class="com.foo.UserPreferences" scope="session">

      <!-- this next element effects the proxying of the surrounding bean -->
      <aop:scoped-proxy />
</bean> 
```

这来自第 3.4.4.5 节。

# sql - 存储树数据的快速关系方法（例如文章的线程评论）

> ID：846201
> 
> 赞同：15
> 
> 时间：2009-05-10T21:59:45.590
> 
> 标签：sql, database-design, tree, database-agnostic, data-storage

我有一个存储对文章的评论的 cms。这些注释既可以是线程的，也可以是非线程的。尽管从技术上讲，它们是相同的，只是在未线程化时将回复列留空。我的应用程序适用于 sqlLite、MySQL 和 pgsql，所以我需要相当标准的 SQL。

我目前有一个评论表

```
comment_id
article_id
user_id
comment
timestamp
thread (this is the reply column) 
```

我的问题是弄清楚如何最好地表示数据库中的线程评论。也许在一个单独的表格中，它支持没有内容的树集和一个简单的表格来保存文本？也许它已经是这样了？也许是另一种方式？

如果评论没有线程，我可以很容易地按时间戳排序。

如果它们有螺纹，我会这样排序

```
ORDER BY SUBSTRING(c.thread, 1, (LENGTH(c.thread) - 1)) 
```

正如您从 ORDER BY 中看到的那样，注释查询永远不会使用索引作为基于函数的索引，仅真正存在于 Oracle 中。帮助我拥有闪电般的快速评论页面。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-10T22:23:40.293

我真的很喜欢[Drupal](http://drupal.org/)如何解决这个问题。它为每个评论分配一个线程 ID。对于第一条评论，此 id 从 1 开始。如果对此评论添加回复，则会为其`1.1`分配 id。对评论的回复`1.1`给出了线程 id `1.1.1`。注释的兄弟姐妹`1.1`被赋予线程 id `1.2`。你明白了。添加评论时，只需一次查询即可轻松计算这些线程 ID。

当线程被渲染时，属于该线程的所有评论都在一个查询中获取，并按线程 ID 排序。这会按升序为您提供线程。此外，使用线程 ID，您可以找到每个评论的嵌套级别，并相应地缩进。

```
1
1.1
1.1.1
1.2
1.2.1 
```

有几个问题需要解决：

*   如果线程 id 的一个组件增长到 2 位，则按线程 id 排序将不会产生预期的顺序。一个简单的解决方案是确保线程 id 的所有组件都用零填充以具有相同的宽度。
*   按线程 id 降序排序不会产生预期的降序。

Drupal 使用称为 vancode 的编号系统以更复杂的方式解决了第一个问题。至于第二个问题，它是通过在按降序排序时在线程ID后附加一个反斜杠（其ASCII码高于数字）来解决的。[您可以通过查看comments 模块](http://drupalcode.org/project/drupal.git/blob/95b676c8de:/modules/comment/comment.module#l757)的源代码找到有关此实现的更多详细信息（请参阅函数 comment_get_thread 之前的大注释）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-07T08:15:09.513

我知道答案有点晚了，但是对于树数据使用闭包表，这是正确的关系方式。 [http://www.slideshare.net/billkarwin/models-for-hierarchical-data](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)

它描述了 4 种方法：

*   邻接表（简单的父外键）
*   路径枚举（已接受答案中提到的 Drupal 策略）
*   嵌套集
*   闭包表（将祖先/后代事实存储在单独的关系 [table] 中，并带有可能的距离列）

与其他选项相比，最后一个选项具有易于 CRUD 操作的优点。成本是空间，在最坏的情况下，它是数字树节点中的 O(n^2) 大小，但在实践中可能并没有那么糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T22:01:42.903

实际上，我只是自己做的！我使用嵌套集模型来表示关系数据库中的分层数据。

[在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)对我来说是纯金。嵌套集是该文章中描述的第二个模型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-10T22:52:36.567

您可以在邻接集模型和嵌套集模型之间进行选择。[在 MySQL](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)中管理分层数据一文作了很好的介绍。

有关理论讨论，请参阅 Celko 的[Trees and Hierarchies](https://rads.stackoverflow.com/amzn/click/com/1558609202)。

如果您的数据库支持窗口函数，则实现线程列表相当容易。您所需要的只是目标数据库表中的递归引用，例如：

```
create Tablename (
  RecordID integer not null default 0 auto_increment,
  ParentID integer default null references RecordID,
  ...
) 
```

然后，您可以使用递归公用表表达式来显示线程视图。[此处](http://blogs.conchango.com/christianwade/archive/2004/11/09/234.aspx)提供了一个示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-10T23:24:47.120

不幸的是，执行此操作的纯 SQL 方法非常慢。

`NESTED SETS`by 提出的建议`@Marc W`非常优雅，但如果您的树枝达到范围，它们可能需要更新整个树，这可能会很慢。

请参阅我的博客中的这篇文章，了解如何快速完成`MySQL`：

*   [](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)**`Oracle`MySQL 中的[**分层查询**](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)- 模拟`CONNECT BY`**

 **您需要创建一个函数：

```
CREATE FUNCTION hierarchy_connect_by_parent_eq_prior_id(value INT) RETURNS INT
NOT DETERMINISTIC
READS SQL DATA
BEGIN
        DECLARE _id INT;
        DECLARE _parent INT;
        DECLARE _next INT;
        DECLARE CONTINUE HANDLER FOR NOT FOUND SET @id = NULL;

        SET _parent = @id;
        SET _id = -1;

        IF @id IS NULL THEN
                RETURN NULL;
        END IF;

        LOOP
                SELECT  MIN(id)
                INTO    @id
                FROM    t_hierarchy
                WHERE   parent = _parent
                        AND id > _id;
                IF @id IS NOT NULL OR _parent = @start_with THEN
                        SET @level = @level + 1;
                        RETURN @id;
                END IF;
                SET @level := @level - 1;
                SELECT  id, parent
                INTO    _id, _parent
                FROM    t_hierarchy
                WHERE   id = _parent;
        END LOOP;
END 
```

并在这样的查询中使用它：

```
SELECT  hi.*
FROM    (
        SELECT  hierarchy_connect_by_parent_eq_prior_id(id) AS id, @level AS level
        FROM    (
                SELECT  @start_with := 0,
                        @id := @start_with,
                        @level := 0
                ) vars, t_hierarchy
        WHERE   @id IS NOT NULL
        ) ho
JOIN    t_hierarchy hi
ON      hi.id = ho.id 
```

这当然是`MySQL`特定的，但它真的很快。

`PostgreSQL`如果您希望它在和之间可移植`MySQL`，您可以使用`PostgreSQL`'contrib for`CONNECT BY`并将查询包装到两个系统具有相同名称的存储过程中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T22:17:29.463

实际上，它必须在读取和写入之间取得平衡。

如果您可以在每次插入时更新一堆行，那么嵌套集（或等效的）将为您提供简单、快速的读取。

除此之外，父级上的简单 FK 将为您提供超简单的插入，但很可能是检索的噩梦。

我想我会使用嵌套集，但要注意预期的数据量和使用模式（为每个插入更新两个索引列（用于左右信息）上的几个，也许很多行可能是一个问题在某一点）。

# embedded - 如何修复此代码以允许我的 AVR 通过串行端口进行通信？

> ID：846206
> 
> 赞同：4
> 
> 时间：2009-05-10T22:03:04.213
> 
> 标签：embedded, serial-port, avr

我最近一直在努力尝试在我的 STK200 上安装一个 ATmega162，以便通过 RS232 与我的计算机通信。我检查并确保 STK200 包含一个 MAX202CPE 芯片。

我已将芯片配置为使用其内部 8MHz 时钟并将其除以 8。

我试图从数据表中复制代码（并在编译器抱怨的地方进行了更改），但无济于事。

我的代码如下，有人可以帮我解决我遇到的问题吗？

我已经确认我的串口可以在其他设备上工作并且没有故障。

谢谢！

```
#include <avr/io.h>
#include <avr/iom162.h>

#define BAUDRATE 4800

void USART_Init(unsigned int baud)
{
    UBRR0H = (unsigned char)(baud >> 8);
    UBRR0L = (unsigned char)baud;

    UCSR0B = (1 << RXEN0) | (1 << TXEN0);

    UCSR0C = (1 << URSEL0) | (1 << USBS0) | (3 << UCSZ00);
}

void USART_Transmit(unsigned char data)
{
    while(!(UCSR0A & (1 << UDRE0)));

    UDR0 = data;
}

unsigned char USART_Receive()
{
    while(!(UCSR0A & (1 << RXC0)));

    return UDR0;
}

int main()
{

    USART_Init(BAUDRATE);

    unsigned char data;

    // all are 1, all as output
    DDRB = 0xFF;

    while(1)
    {
        data = USART_Receive();

        PORTB = data;

        USART_Transmit(data);

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T23:24:33.707

我对 Greg 的回答发表了评论，但想再补充一件事。对于此类问题，调试的黄金标准方法是首先*了解*异步串行通信，然后获取示波器并查看在线发生的情况。如果正在交换字符并且这只是一个波特率问题，这将特别有用，因为您可以计算您看到的波特率，然后相应地调整除数。

这是一个超级快速入门，毫无疑问，您可以在 Wikipedia 或其他地方找到更全面的内容。

让我们假设 8 位，无奇偶校验，1 个停止位（最常见的设置）。然后，如果正在传输的字符是 0x3f (= ascii '?')，那么该行如下所示；

```
...--+   +---+---+---+---+---+---+       +---+--...
     | S | 1   1   1   1   1   1 | 0   0 | E
     +---+                       +---+---+ 
```

芯片的高（1）电平为+5V，转换为RS232电平后为-12V。

低 (0) 电平在芯片上为 0V，转换为 RS232 电平后为 +12V。

S 是起始位。

然后我们有 8 个数据位，最低有效位在前，所以这里 00111111 = 0x3f = '?'。

E 是停止（e 表示结束）位。

时间从左向右推进，就像示波器显示一样，如果波特率为 4800，那么每个位跨度为 (1/4800) 秒 = 0.21 毫秒（大约）。

接收器通过对线路进行采样并寻找下降沿来工作（静止线路始终只是逻辑“1”）。接收器知道波特率和起始位数（1），因此它测量从下降沿开始的半个位时间以找到起始位的中间，然后连续对线路采样 8 位时间以收集数据位。然后接收器再等待一个位时间（直到停止位的一半）并开始寻找另一个起始位（即下降沿）。同时，读取的字符可供系统的其余部分使用。发送器保证在停止位完成之前不会开始下一个下降沿。可以将发送器编程为始终等待更长的时间（使用额外的停止位），但这是一个遗留问题，

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T22:30:05.540

我手边没有参考资料，但波特率寄存器 UBRR 通常包含一个除数，而不是所需的波特率本身。[快速谷歌搜索](http://www.google.com/codesearch?q=ubrr4800)表明 4800 波特的正确除数可能是 239。所以尝试：

```
divisor = 239;
UBRR0H = (unsigned char)(divisor >> 8);
UBRR0L = (unsigned char)divisor; 
```

如果这不起作用，请查看特定芯片的参考文档以获取正确的除数计算公式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-11T15:38:44.157

对于调试 UART 通信，有两个有用的事情要做：

1）在连接器处进行环回，并确保您可以读回您所写的内容。如果您发送一个字符并准确地返回它，您就知道硬件接线正确，并且至少基本的 UART 寄存器配置集是正确的。

2）重复发送字符0x55（“U”）——二进制位模式01010101可以让你在示波器上快速看到位宽，让你验证速度设置是否正确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T14:34:02.637

在更彻底地阅读数据表之后，我错误地设置了波特率。ATmega162 数据表有一个时钟频率图表，绘制了波特率和相应的误差。

对于 4800 波特率和 1 MHz 时钟频率，误差为 0.2%，这对我来说是可以接受的。诀窍是将 12 传递给 USART_Init() 函数，而不是 4800。

希望这对其他人有所帮助！

# web-services - 如何使用 Delphi 构建独立的 SOAP Web 服务？

> ID：846207
> 
> 赞同：7
> 
> 时间：2009-05-10T22:03:04.243
> 
> 标签：web-services, delphi, soap, indy

如何使用 Delphi 构建独立的基于 SOAP 的 Web 服务？必须与 Delphi 2009 一起使用，但如果它也可以与旧版本一起使用就更好了。

内置的 WebBroker Web 服务创建 CGI 或 ISAPI。最好创建一个我可以从下到上控制的独立可执行文件，尤其是在开发过程中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-10T22:10:44.730

[用于 Delphi (RO/Delphi) 的 RemObjects SDK](http://www.remobjectssdk.com/delphi.aspx)。

> 提供了不同的消息格式，包括我们自己的高效二进制 BinMessage 格式，以及对 SOAP、XML-RPC 和 - 新的 - JSON 编码的支持，以防您想让不使用 RO 的客户端访问您的服务器，或者编写客户端访问他人提供的网络服务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-10T22:05:55.363

[Dave Nottage](http://gp.embarcadero.com/authors/edit/1791.aspx)编写[了使用 Indy 构建独立的 Web 服务](http://edn.embarcadero.com/article/27513)（[源代码](http://cc.embarcadero.com/Item/16364)）。

> 本文解释了如何使 Indy 适应 Delphi 6 的 Web 服务 (SOAP) 支持。

根据页面上的评论，它可以与 Delphi 2009 一起使用，但需要进行一些修改。

**编辑**：[Indy 10 和 IdHTTPWebBrokerBridge 中的人员使用 CBuilder 2009](https://forums.embarcadero.com/thread.jspa?messageID=63725)发布了修改版本。例如，[IdHTTPWebBrokerBridge.pas](https://forums.embarcadero.com/servlet/JiveServlet/download/2-9780-66171-751/IdHTTPWebBrokerBridge.pas)由 Jochanan van der Niet 编写。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T03:52:02.270

应该可以使用 VCL for the Web（以前：Intraweb）构建 Web 服务。它可以选择创建包含以下内容的独立可执行文件：Web 服务器和 Web 应用程序

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-11T06:13:47.907

在 D7 中，我使用了 IdHTTPWebBrokerBridge (Indy 9)。但我不知道它在 D2009 中是否仍然可用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T19:50:33.090

Bob 博士的网站上有一系列[SOAP 文章](http://www.drbob42.com/soap/index.htm)，特别是 RAD Studio 2007 XML、SOAP 和 Web 服务开发手册，但价格为 99 欧元。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-11T02:15:43.863

我过去使用的是[idRunner](http://users.telenet.be/ws36637/)，它是 indy 库的扩展，它允许您开发 ISAPI dll，然后您的应用程序将运行该 dll。这种方法的优点是，您可以部署一个独立的应用程序来运行您的soap 服务，以后可以通过IIS 轻松部署该服务。

对于调试，我强烈建议在同一页面上使用 idDebugger。它使调试 ISAPI 应用程序变得非常容易。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-19T11:42:15.300

这是一个分步解决方案“Delphi 7 Indy Standalone Web Services/SOAP Server”，看起来它对 Delphi 2009 也很有用：

[http://www.digicoast.com/delphi_soap_standalone.html](http://www.digicoast.com/delphi_soap_standalone.html)

更新：

此解决方案使用 IdHTTPWebBrokerBridge，只需稍作改动即可在 Delphi 2009 中使用。

# asp.net - 我如何（或应该）创建自己的 wiki 功能？

> ID：846213
> 
> 赞同：2
> 
> 时间：2009-05-10T22:06:59.433
> 
> 标签：asp.net, wiki

我有一个 ASP.NET 网站，随着时间的推移，它已成为一个越来越多的数据存储库，其中我有许多数据库表，并且该站点只是发送这些数据。

我意识到*wiki*实际上可能开始成为我的网站正在变成的更好的模型。或者至少是其中的一部分，因为它实际上只是添加和更新我正在做的内容。这是我的困境：

网站的某些部分确实需要非 wiki 和完全可定制等。我是否应该在我的网站中构建我自己的 wiki 功能，以便我可以将其作为 wiki 的一部分（在我需要时嵌入）和其余部分常规的 ASP.NET？如果答案是肯定的，是否有任何关于如何构建和托管 wiki 的提示或样板代码？

另一种方法是使用现有的 wiki 软件。我已经尝试了其中的大多数，我的问题是我需要自己在 Windows 上托管它，如上所述，我希望拥有完全的控制权，并且在我的网站内只有一个可编辑的简单 wiki 页面。我曾尝试使用框架等来模拟这一点，但这一切似乎有点骇人听闻。

任何建议：

A. 如果您认为我应该在下面构建我的网站的 wiki 部分，是否有最佳实践，如何快速做到这一点的样板代码？

B. 如果您认为我不应该重新发明轮子，是否有任何现有的 Windows 托管软件可以嵌入到我的站点中而不会失去任何控制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T22:13:37.330

自己动手是浪费时间，除非您对现有系统中不可用的 wiki 功能进行了一些重大更改或添加（即使那样，重新开始通常比分支现有设置更浪费时间）。

我建议使用像[ScrewTurn](http://www.screwturn.eu/)之类的东西，它是开源的和 ASP.NET，它为您提供了一个功能齐全的 wiki，无需开发，并在您确实需要进行更改时为您提供尽可能多的控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T22:22:03.447

我同意 Rex M 的观点。你不需要从头开始。利用已经可用的开源产品并在其上进行构建（如果您也需要）。

这样做的额外好处是从协作的角度来看，当您将一些有趣的功能构建到您的软件版本中，然后与社区共享时。

很有可能，如果您需要构建一些东西并发现其他地方的其他人有接近相同的需求并且会欢迎您的功能和增强功能。

这就是开源的美妙之处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-05T11:43:42.977

看看[dooWikis](http://dooWikis.com)。有了这个，您可以根据需要将 wiki 嵌入到您的站点中，而无需重定向到第三方服务，并限制谁可以进行编辑。

# javascript - 对数滑块

> ID：846221
> 
> 赞同：89
> 
> 时间：2009-05-10T22:16:51.553
> 
> 标签：javascript, slider, logarithm

我有一个值从 0 到 100 的滑块。

我想将它们映射到 100 到 10,000,000 的范围内。

我见过一些散布在网络上的函数，但它们都是用 C++ 编写的。我需要它在 Javascript 中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2009-05-10T22:35:20.633

你可以使用这样的函数：

```
function logslider(position) {
  // position will be between 0 and 100
  var minp = 0;
  var maxp = 100;

  // The result should be between 100 an 10000000
  var minv = Math.log(100);
  var maxv = Math.log(10000000);

  // calculate adjustment factor
  var scale = (maxv-minv) / (maxp-minp);

  return Math.exp(minv + scale*(position-minp));
} 
```

结果值匹配对数刻度：

```
js> logslider(0);
100.00000000000004
js> logslider(10);
316.22776601683825
js> logslider(20);
1000.0000000000007
js> logslider(40);
10000.00000000001
js> logslider(60);
100000.0000000002
js> logslider(100);
10000000.000000006 
```

反向函数将使用与、、和的相同定义`minp`，根据如下值计算滑块位置：`maxp``minv``maxv``scale`

```
function logposition(value) {
   // set minv, ... like above
   // ...
   return (Math.log(value)-minv) / scale + minp;
} 
```

总之，包装在一个类中并作为一个功能代码片段，它看起来像这样：

```
// Generic class:

function LogSlider(options) {
   options = options || {};
   this.minpos = options.minpos || 0;
   this.maxpos = options.maxpos || 100;
   this.minlval = Math.log(options.minval || 1);
   this.maxlval = Math.log(options.maxval || 100000);

   this.scale = (this.maxlval - this.minlval) / (this.maxpos - this.minpos);
}

LogSlider.prototype = {
   // Calculate value from a slider position
   value: function(position) {
      return Math.exp((position - this.minpos) * this.scale + this.minlval);
   },
   // Calculate slider position from a value
   position: function(value) {
      return this.minpos + (Math.log(value) - this.minlval) / this.scale;
   }
};

// Usage:

var logsl = new LogSlider({maxpos: 20, minval: 100, maxval: 10000000});

$('#slider').on('change', function() {
   var val = logsl.value(+$(this).val());
   $('#value').val(val.toFixed(0));
});

$('#value').on('keyup', function() {
   var pos = logsl.position(+$(this).val());
   $('#slider').val(pos);
});

$('#value').val("1000").trigger("keyup");
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

Input value or use slider:
<input id="value" />
<input id="slider" type="range" min="0" max="20" />
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-10T22:31:17.443

要获得您想要的分布，我认为您可以使用以下公式：

```
var value = Math.floor(-900 + 1000*Math.exp(i/10.857255959)); 
```

这是一个独立的页面，它将打印您将为 0-100 滑块获得的值，并通过该公式传递它们：

```
<html><body><script>
for (var i = 0; i <= 100; i++) {
    var value = Math.floor(-900 + 1000*Math.exp(i/10.857255959));
    document.write(value + "<br>");
}
</script></body></html> 
```

这些数字从 100 到 10,000,000 在我的数学生锈的眼睛看来是你想要的分布。8-)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-11-19T16:38:09.130

没有完全回答这个问题，但对于感兴趣的人，最后一行的反向映射是

```
return (Math.log(value)-minv)/scale + min; 
```

只是为了记录。

注意该值必须 > 0。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-06-12T08:04:54.403

真正的对数滑块的问题在于低端，滑块上的多个点可能会导致重复值。

从纯粹的 UI 角度来看，它也没有为用户输入提供非常直观的输出。

我认为更好的选择是使用均匀分布的“阶梯式”变换。

[![在此处输入图像描述](https://i.stack.imgur.com/0N7fP.png)](https://i.stack.imgur.com/0N7fP.png)

换句话说，我们指定了一系列我们想要使用的增量（例如：1、10、100、1000）。然后我们根据我们定义的增量将滑块分成相等的部分。当我们在不同的部分滑动时，滑块输出将按相应的增量递增。

[工作演示](https://expo-step-slider-example.stackblitz.io/)

[反应代码](https://stackblitz.com/edit/expo-step-slider-example)

在上面的示例中，我们定义了`min`, `max`&`intervals`数组。

```
<ExpoStepSlider
  intervals={[1, 2, 5, 10, 100, 1000]}
  min={1}
  max={50000}
/> 
```

然后我们必须找到我们的滑块必须具有的离散值的数量，以便它根据我们定义的间隔分布正确地从最小值变为最大值。

```
let sliderPoints = Math.ceil(
  (max - min) / 
  intervals.reduce((total, interval) => total + interval / intervals.length, 0)
); 
```

在这种情况下`535`。

***注意****：您的滑块点不应超过滑块中的像素数*

最后，我们只是使用上述算法转换我们的输出。代码示例也做了一些工作，因此对于当前步长间隔，输出始终是四舍五入的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-03T11:32:15.177

我正在寻找对**数滑块 For Angular**但找不到任何东西然后我遇到了这个答案，

我已经为 Angular 2+ 创建了它（演示在 Angular 6 中）：**[WORKING DEMO](https://stackblitz.com/edit/angular-logarithmic-slider)**

感谢**@sth**，对于片段：

```
function LogSlider(options) {
   options = options || {};
   this.minpos = options.minpos || 0;
   this.maxpos = options.maxpos || 100;
   this.minlval = Math.log(options.minval || 1);
   this.maxlval = Math.log(options.maxval || 100000);

   this.scale = (this.maxlval - this.minlval) / (this.maxpos - this.minpos);
}

LogSlider.prototype = {
   // Calculate value from a slider position
   value: function(position) {
      return Math.exp((position - this.minpos) * this.scale + this.minlval);
   },
   // Calculate slider position from a value
   position: function(value) {
      return this.minpos + (Math.log(value) - this.minlval) / this.scale;
   }
}; 
```

# delphi - 从 TGraphicControl.Paint 调用 TWinControl.Update 是否安全？

> ID：846229
> 
> 赞同：0
> 
> 时间：2009-05-10T22:22:22.573
> 
> 标签：delphi

我有一个绘制相当缓慢的 TGraphicControl 后代。还有一个 TWinControl 后代，这个画得很快。两个控件都在同一个 TPanel 上。

滚动时，TGraphicControl 比 TWinControl 更频繁地更新，因此它们看起来不同步。此更新由 Windows 和/或 VCL 完成，而不是由我的代码完成。

我可以通过从 TGraphicControl.Paint 方法调用 TWinControl.Update 来解决这个问题，但我有点担心这可能会以某种方式导致问题。

这样做安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T22:48:17.010

只要没有对您的 TWinControl 的回调就可以了。您可能会比严格必要的更频繁地更新 TWinControl，但仅此而已。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T23:05:21.210

这是安全的，只要它们不相关。但它看起来不是一个非常有效的方法。

TGraphic 依赖于父控件的绘制，那也是 TWinControl 的父控件吗？

你可以尝试一下：

a）将基于 TGraphic 的控件更改为 TWinControl（无论如何，TGraphic 并不是那么有用或高效）。也就是说，如果您拥有源代码。

b）将图形控件嵌入特殊（无边框等）TPanel

# ruby-on-rails - Django 还是 Ruby-On-Rails？

> ID：846231
> 
> 赞同：43
> 
> 时间：2009-05-10T22:23:14.523
> 
> 标签：ruby-on-rails, ruby, django

我一直在找工作。大多数公司都需要 RoR 或 Django 经验。我不会任何一种语言。使用 RoR 的组织数量比 Django 多。但我更喜欢 django 因为 python。

你的编码员/招聘人员建议我知道什么？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-10T22:52:06.067

我最好的答案是让你两个都学。

将此视为您的最终目标，而应将您的问题视为“我应该先学习哪个？”

我建议你从 Django 开始，特别是如果你有 Python 经验的话。Django 的方法，就像 Python 本身一样，更有利于学习。一旦您开始涉足，请学习 Ruby on Rails，因为当您进入现代 Web 2.0 员工队伍时，该框架将使您更容易获得现金。

一旦您完全熟悉 Ruby on Rails 并且已经工作了一段时间，请继续学习 Django。重新熟悉基础知识，然后开始学习一些更高级的东西。据说 Django 的内脏比 Rails 更容易剖析。如果您发现自己面临着一个需要实施一个令人惊讶的新颖且具有挑战性的网络平台的职位空缺，那么您会发现您的 Django 知识非常方便。

这是一个项目符号列表：

## 姜戈

*   很棒的文档
*   详尽的教程让您轻松上手
*   一开始需要理解的文件更少（与 Rails 中的脚手架相比）
*   建立在 Python 之上，无论如何你都应该知道
*   更类似于 Java Servlets/JSP 等企业级的东西
*   更容易挖掘它的内脏

## Ruby on Rails

*   这就是热门
*   热意味着更多的工作
*   你想要钱，不是吗？
*   当你想创建一个“传统”的 web 2.0 站点时，它生成的代码可以让你快速完成
*   与 JavaScript 库集成
*   建立在 Ruby 之上，无论如何你都应该知道

**结论**：首先是 Django（做教程），然后是 Rails，然后是 Django

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-12T16:00:23.260

我建议你做一些关于技术趋势和专业需求的研究，你可以使用谷歌工具来做到这一点，比如[谷歌趋势](http://www.google.com/trends/?q=django%20python,ruby%20on%20rails,%20asp.net%20mvc&ctab=0&geo=all&date=all&sort=1) ![在此处输入图像描述](https://i.stack.imgur.com/l6KtR.png)

在此处查看有关[技术研究的](http://podlipensky.com/2012/06/choosing-web-framework-asp-net-mvc-vs-django-python-vs-ruby-on-rails/)更多详细信息。快乐编码！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-10T22:27:23.970

如果您更熟悉 Python，那么您应该使用 Django。[Google App Engine](http://code.google.com/appengine/)是 Django 的大用户，您可以使用它来“磨砺您的锯子”以提高 Django 技能，从而获得免费投资。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-11T12:44:12.537

两者都学。

寻找一家公司，那里的人们（没有关系）在那里工作很开心，并且对那里的工作充满同情心。这比他们正在使用的技术重要得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T09:23:54.073

如果您的时间不多，并且必须选择一个，只需选择您知道如何编程的那个即可。如果你懂 python，就学 django，如果你懂 ruby​​，就学 rails。两者都有出色的教程和参考资料、截屏视频中的 RoR 规则、django 规则文档和教程。如果你手头有很多时间，比如 3-4 个月，那么两个都学。那有什么问题？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-04T02:02:58.237

尝试 ruby​​...我喜欢 ruby​​ 而不是 python，那么我更喜欢 rails 而不是 django...但是如果您尝试 ruby​​ 并且不喜欢它，那么您最好的选择是 django...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-01T01:37:52.527

我认为这取决于您习惯了多少惯例。从 MVC4 到 Django 我喜欢很多东西，但发现我正在编写更多代码，其中 django 需要配置与约定。我发现有很多通用方法可以减少这种情况，所以这对我来说可能是一个学习曲线问题。

# cocoa-touch - 有没有办法在可可触摸中获得或计算真北？

> ID：846235
> 
> 赞同：0
> 
> 时间：2009-05-10T22:25:11.400
> 
> 标签：cocoa-touch, gps, core-location

我想确定从真北开始顺时针移动 x 度的方向。有没有办法让我根据一组经纬度坐标获取或计算真北？

我对实现这种可可触感很感兴趣。我确信这已在许多已经存在的应用程序中使用。任何意见，指针，建议将不胜感激。

谢谢

ldj

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T23:08:01.533

如果你得到一组坐标，然后十秒钟后得到另一组坐标，你就可以算出你行进的方向。（不确定这是否是你想要的）

你必须计算出经度和纬度的变化，然后使用一点三角函数，然后简单地做 arctan(long/lat) （arc tan 是 tan 的反函数）你必须避免在变化时除以 0 in lat 为 0。但是，当 long 或 lat 的变化为 0 时，您知道您已直接向北、向东、向南或向西旅行。

此外，大多数 API 中的 arctan 以弧度输出，因此您必须将其乘以 180 并除以 pi 以获得度数。

**编辑：** 真北不位于任何纬度0吗？虽然我的第一印象是网格北，但我认为由于地球的曲线和经线平行绘制的事实，会产生称为网格北的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T22:29:46.617

你是说磁北吗？

如果是这样，谷歌搜索磁性变化，你就会拥有它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-11T01:00:00.977

不过，Zekian 走在正确的道路上……看起来您需要当前的经纬度和当前的磁极经纬度，以及一些球面几何形状来计算磁推导（“偏角”是一个词弹出很多），然后将该推导应用于您当前的磁北读数。而且由于地球磁场不断移动，您也需要对此进行补偿。或者至少提供磁北的经度/纬度的更新。

这些是我一路上找到的链接，但是在我想出任何聪明的东西之前，我的头开始像驱魔人一样旋转

[http://www.nauticalissues.com/en/math1.html](http://www.nauticalissues.com/en/math1.html)

[http://mathforum.org/library/drmath/view/60398.html](http://mathforum.org/library/drmath/view/60398.html)

[http://mathforum.org/library/drmath/view/55417.html](http://mathforum.org/library/drmath/view/55417.html)

[http://www.ngdc.noaa.gov/geomag/magfield.shtml](http://www.ngdc.noaa.gov/geomag/magfield.shtml)

[http://en.wikipedia.org/wiki/Magnetic_declination](http://en.wikipedia.org/wiki/Magnetic_declination)

# c++ - 用 C++ 做游戏教练？

> ID：846240
> 
> 赞同：1
> 
> 时间：2009-05-10T22:29:06.213
> 
> 标签：c++, memory, pointers

好的，所以我以前玩过游戏，但现在我想做一个教练，唯一的问题是每次我在不同的计算机上玩或重新启动游戏时内存地址都会发生变化。现在我需要找到一个指针，但不知道如何。

那么，我如何使用 CheatEngine 5.4 等内存扫描仪找到指向任何武器的弹药地址的指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T23:29:43.027

*   步骤 1\. 在内存中搜索您要更改的值，并存储所有匹配位置
*   step 2\. 在游戏中做一些事情来改变这个值到一个新的值
*   步骤 3\. 检查所有匹配位置，其中一个应该具有新值。
*   步骤 4\. 将任何您想要的内容写入该位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-27T14:53:29.563

**第 1 步**：使用作弊引擎搜索您要更改的值。

**第 2 步**：如果您找到了正确的地址，请右键单击它并对该地址进行指针扫描。现在你应该得到许多带有一些偏移量的基地址。

**第 3 步**：关闭游戏并重复第 1 步。现在复制新地址并单击重新扫描指针扫描（在从第 2 步打开的窗口中）。将新地址粘贴到重新扫描地址字段并重新扫描。那么你应该只得到正确的基地址+偏移量。

**第 4 步**：要始终找到正确的地址，请执行 readprocessmemory(baseaddress+offset)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T22:36:48.853

[http://forum.cheatengine.org/viewtopic.php?t=26540](http://forum.cheatengine.org/viewtopic.php?t=26540)我在作弊引擎网页上找到了这个，他们有一个专门用于指针的部分，它可能会有所帮助。

# google-maps - 如何在 Google Maps Javascript API 中设置缺失/加载图块的颜色？

> ID：846248
> 
> 赞同：0
> 
> 时间：2009-05-10T22:35:17.000
> 
> 标签：google-maps

我用一个全屏显示谷歌地图的 WebView 制作了这个小 Cocoa 应用程序。一切都很好，但仍在加载的瓷砖是灰色的，非常明亮，这在大型显示器上是一种痛苦。有什么办法可以让它们变黑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T22:52:32.510

弄清楚了：

```
map = new GMap2(document.getElementById("map"), { backgroundColor: "#000000" }); 
```

# google-reader - 了解是否还有更多使用 Google Reader API

> ID：846253
> 
> 赞同：1
> 
> 时间：2009-05-10T22:39:32.327
> 
> 标签：google-reader

我知道在获取原子提要时，您可以指定要返回的项目数，并且这些项目将具有一个延续字段，您可以使用该字段在您已经获取的项目之后的位置开始后续获取。问题是：如何在不实际尝试获取更多内容的情况下确定是否还有更多内容要获取？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T21:27:05.763

如果服务器上有更多信息，您从 Google Reader API 获得的每个原子提要都将提供一个“继续”令牌。如果在 atom 提要中未找到此标记，则没有更多标记。

# objective-c - NSDecimalNumber 的绝对值 (abs) 而不会损失精度

> ID：846254
> 
> 赞同：21
> 
> 时间：2009-05-10T22:39:50.673
> 
> 标签：objective-c

我需要在不损失精度的情况下获得 NSDecimalNumber 的绝对值。如果不转换为十进制或浮点数（精度损失），我似乎无法找到一种方法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-10T23:01:59.593

您可以使用 NSDecimalNumber 类的内置函数将数字与零进行比较，然后根据需要乘以 -1。例如：

```
- (NSDecimalNumber *)abs:(NSDecimalNumber *)num {
    if ([num compare:[NSDecimalNumber zero]] == NSOrderedAscending) {
        // Number is negative. Multiply by -1
        NSDecimalNumber * negativeOne = [NSDecimalNumber decimalNumberWithMantissa:1
                                                                          exponent:0
                                                                        isNegative:YES];
        return [num decimalNumberByMultiplyingBy:negativeOne];
    } else {
        return num;
    }
}
```

由于此方法仅适用于 NSDecimalNumbers，因此不会损失精度。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-10-28T16:58:37.843

答案有一个小错误：negativeOne 应该是一个指针。这是一个修改后的答案：

```
- (NSDecimalNumber *)abs:(NSDecimalNumber *)num {
    if [myNumber compare:[NSDecimalNumber zero]] == NSOrderedAscending) {
        // Number is negative. Multiply by -1
        NSDecimalNumber *negativeOne = [NSDecimalNumber decimalNumberWithMantissa:1
                                                                    exponent:0
                                                                  isNegative:YES];
        return [num decimalNumberByMultiplyingBy:negativeOne];
    } else {
        return num;
    }
} 
```

这是一个适合用作 NSDecimalNumber 上的类别的版本：

```
- (NSDecimalNumber *)abs {
    if ([self compare:[NSDecimalNumber zero]] == NSOrderedAscending) {
        // Number is negative. Multiply by -1
        NSDecimalNumber *negativeOne = [NSDecimalNumber decimalNumberWithMantissa:1
                                                                         exponent:0
                                                                       isNegative:YES];
        return [self decimalNumberByMultiplyingBy:negativeOne];
    } else {
        return self;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-08T18:20:39.463

如果您不想将其相乘，则零减去该值即可。

```
- (NSDecimalNumber *)abs:(NSDecimalNumber *)num {
    if ([num compare:[NSDecimalNumber zero]] == NSOrderedAscending) {
        // negative value
        return [[NSDecimalNumber zero] decimalNumberBySubtracting:num];
    } else {
        return num;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-11-30T10:37:33.113

Swift 4.0 变体：

```
extension NSDecimalNumber {
    func absoluteValue() -> NSDecimalNumber {
        if self.compare(NSDecimalNumber.zero) == .orderedAscending {
            let negativeValue = NSDecimalNumber(mantissa: 1, exponent: 0, isNegative: true)
            return self.multiplying(by: negativeValue)
        } else {
            return self
        }
    }
} 
```

用法

```
let sum = NSDecimalNumber(value: -123.33)

sum.absoluteValue() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-31T20:35:20.043

## 斯威夫特 5

您可以使用 的`magnitude`属性`Decimal`：

```
extension NSDecimalNumber {
    var absValue: Self {
        .init(decimal: decimalValue.magnitude)
    }
} 
```

```
let number = NSDecimalNumber(string: "-123.456")
let absNumber = number.absValue // 123.456 
```

# perl - 如何在 Perl 中删除哈希值的最后七个字符？

> ID：846257
> 
> 赞同：22
> 
> 时间：2009-05-10T22:45:37.310
> 
> 标签：perl, string

我需要截断字符串的最后七个字符（存储在哈希中的字符串）。在 perl 中最简单的方法是什么？提前谢谢了！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-10T22:50:35.913

与[`substr()`](http://perldoc.perl.org/functions/substr.html)：

```
substr($string, 0, -7); 
```

我建议您先阅读 Perldoc 页面`substr()`（我在上面链接到），然后再将其复制并粘贴到您的代码中。它可以满足您的要求，但`substr()`它是一个非常有用且用途广泛的功能，我建议您了解可以使用它的所有内容（通过阅读文档）。

此外，在将来，请考虑在此处询问之前在谷歌上搜索您的问题（或者，对于 Perl，请在 Perldoc 上查找）。您无需在此处提问即可找到有关此类事情的大量资源。不要放下你的问题，但这很简单，我想如果你尝试过，你可以自己找到答案。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-11T06:07:38.163

要删除最后 7 个字符：

```
substr($str, -7) = ''; 
```

或者有些不雅

```
substr($str, -7, length($str), ''); 
```

要获取除最后 7 个字符之外的所有字符：

```
substr($str, 0, -7) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-10T22:53:03.087

使用 perl`substr`函数，但将“长度”参数设为负数。例子：

```
#!/usr/bin/perl

my $string = "string";
$short = substr($string, 0, -3);
printf $short . "\n";
```

这将返回带有换行符的字符串“str”，因为我们指定截断最后三个字符。查看[关于 substr() 的 Perl 文档](http://perldoc.perl.org/functions/substr.html)。

# c++ - C++中的链表数组

> ID：846259
> 
> 赞同：2
> 
> 时间：2009-05-10T22:47:40.600
> 
> 标签：c++, arrays, linked-list

一些上下文代码：

```
class WordTable
{
    public:
        WordTable();
        ~WordTable();

        List* GetListByAlphaKey(char key);
        void AddListByKey(char key);
        bool ListExists(char key);
        bool WordExists(string word);
        void AddWord(string word);
        void IncrementWordOccurances(string word);
        void Print();
    private:     
        List *_listArray[33];
        int _GetIndexByKey(char key);
};

class TableBuilder
{
    public:
    TableBuilder();
    ~TableBuilder();
    void AnalyzeStream(fstream &inputStream);        
    void PrintResults();
    private:
        void _AnalyzeCursor(string data);
        bool _WordIsValid(string data);
        WordTable* _WordTable;        
};

struct Element {
public:
   string Word;
   int Occurances;
   Element* Next;
};

class List
{
    public:
        List();
        ~List();

        Element* AddElement(string word);       
        void DeleteElement(Element* element);       
        void Print();       
        void Delete();
        Element* First;
        bool WordExists(string word);
        void IncrementWordOccurances(string word);      
    private:
        void _PrintElementDetails(Element* element);
}; 
```

**要求**
我必须分析文本，构建链表数组（其中数组包含每个字母的列表；列表包含在文本中找到的每个单词），然后打印出结果。

**问题** 我无法在 WordTable.cpp 中初始化列表数组。我知道我误解了一些东西，但我没有想法和时间。任何人？

*Ps 是的，这是一个家庭作业。请停止给我有关最佳实践的建议... :)*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T22:54:18.560

的初始化`_listArray`如下所示：

```
WordTable::WordTable() {
  for (int i=0; i<33; i++)
    _listArray[i] = new List();
} 
```

您并没有真正说出究竟是什么问题，所以我不确定这是否有帮助......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T22:54:34.223

这是因为您正在创建一个指向列表的指针数组。将其更改为 List _listArray[33]; 或像这样初始化它：

```
for ( int i = 0; i < 33; ++i ) {
    _listArray[i] = new List();
}

// and to access methods
_listArray[i]->AddElement( "word" ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-10T22:55:42.253

看来您正在通过拥有一个数组来优化您的链表，每个单词的第一个字母一个。不要那样做。

使用 std::map。其中字符串是单词，int 是您的计数。

编辑：如果你忽略我的建议......正如已经指出的那样，你的 _listArray 实际上是一个指针数组，而不是一个对象数组。我想你想要一个对象数组。由于数组是固定长度的，并且 List 有一个默认构造函数，最简单的方法就是说

```
List _listArray[33]; 
```

如果你想要动态分配，你可以这样做：

```
List* _listArray; 
```

在构造函数中：

```
_listArray = new List[33]; 
```

在析构函数中：

```
delete[] _listArray; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T14:10:28.690

请不要重新发明轮子（再次）使用 std::list 它可以正常工作，更安全，是标准的。

第二：你有设计问题：列表中的元素属性是公共的，但你有一个私有方法???。

# html - 为什么某些浏览器会将诸如 CRLF 之类的格式化字符呈现为空格？

> ID：846271
> 
> 赞同：3
> 
> 时间：2009-05-10T22:53:09.200
> 
> 标签：html, css, browser, whitespace, doctype

我需要有人向我解释这些额外的填充来自于包含 img 元素的 div。

您可以访问[http://www.dev12.com/CSSTest](http://www.dev12.com/CSSTest)以获取我的两个问题的实时示例。

**问题 #1**：Safari、Firefox 和 Opera 在容器 div 上呈现大约 6 像素的不需要的底部填充。如果我明确地将填充设置为 0px 并不重要。

**问题 #2**：如果我格式化我的代码，使每个图像在我的 html 文件中单独的行上，则额外的 6 个像素的右填充被添加到每个图像。例如，以下代码块在两个图像之间呈现不需要的填充：

```
<div>
    <span><img src="button.gif" /></span>
    <span><img src="button.gif" /></span>
</div> 
```

但是，*此*代码块没有不需要的空间：

```
<div>
    <span><img src="button.gif" /></span><span><img src="button.gif" /></span>
</div> 
```

显然 Safari、Firefox 和 Opera 将我在 span 标签之间的回车呈现为空白。我不记得以前有过这个问题。我正在 Textmate 中编写我的代码。有没有我应该查看的设置来防止这种情况发生？

我总是使用 XHTML 1.0 Strict 文档类型。这让我特别困惑，因为它是如此初级。有人帮我理解这一点！

KN

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-10T22:57:03.237

**#1**这是因为内联图像的默认基线对齐方式 - 您看到的额外空间是为图像周围的文本中的下行字母（低于基线的字母：g、p、q、y 等）保留的。（您没有文本的事实无关紧要 - 仍然为它们保留空间。）

你可以像这样摆脱它：

```
img {  /* Or a suitable class, etc. */
    vertical-align: bottom;
} 
```

**#2**换行符是空格，并显示为空格。如果你有这样的 HTML：

```
<p>This is a sentence
in a paragraph.<p> 
```

您希望浏览器在“句子”和“输入”之间放置一个空格，不是吗？ `<img>`元素是内联块，就像段落中的单词一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T22:57:55.137

如果我没记错的话，HTML 规范说源文件中的所有空格都将呈现为单个空格。

例如，如果您打开一个新的 HTML 文档并键入

```
hello
world 
```

结果将是“hello world”

以下任何一项都会出现相同的结果：

```
hello

world 
```

- - - 或者 - - - - -

```
hello world 
```

- - - 或者 - - - - -

```
hello                                                 world 
```

不管你在“hello”和“world”之间放了多少空格，只有一个会渲染。空格是 CRLF 还是空格字符都没有关系。

# xml - 定义复杂混合元素的 text() 节点的模式

> ID：846283
> 
> 赞同：1
> 
> 时间：2009-05-10T23:00:05.837
> 
> 标签：xml, xsd

这个问题与[那个](https://stackoverflow.com/questions/381782/xml-schema-element-that-can-contain-elements-or-text)问题有关。但有些延长。

假设我们有一个 xml：

```
<field name="test_field_0">
    Some text that is texty text.
    <subfield>Some text.</subfield>
</field> 
```

[相关问题](https://stackoverflow.com/questions/381782/xml-schema-element-that-can-contain-elements-or-text)的方案：

```
<xs:element name="field">
    <xs:complexType mixed="true">
        <xs:sequence>
                <xs:element ref="subfield" minOccurs="0" maxOccurs="unbounded" />
        </xs:sequence>
        <xs:attribute name="name" type="xs:string" />
    </xs:complexType>
</xs:element> 
```

现在的附加要求是元素的`text()`节点`field`应该由某种模式来调节，例如，这个：`\p{Lu}(\p{Ll}\p{P}\p{Z})+`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T08:45:40.627

XML Schema 不允许对包含混合内容的元素的文本施加任何约束。

# objective-c - 带有合理反馈的原子、异步 HTTP 文件 POST？

> ID：846286
> 
> 赞同：8
> 
> 时间：2009-05-10T23:02:21.307
> 
> 标签：objective-c, cocoa, http, macos, upload

我刚刚开始在 Mac 上进行开发，发现 Cocoa 是一个有用且周到的框架，但它的 HTTP 功能让我感到困惑。

我有一个 NSURLConnection 对象，可以使用 HTTP GET 方法从我的网络服务器下载文件。NSURLConnect 的异步连接很棒，我得到了很多反馈，我将每个块作为一个新的 NSData 对象接收，我可以使用它在客户端自动重建文件，重要的是，为用户提供进度报告：[myData length ]。

然而，上传远没有那么整洁。您可以将同步请求粘贴在其自己的线程中，也可以调用异步请求（我相信它会产生自己的线程），但都不会为您提供任何有用的反馈。没有代表请求数据，甚至没有让我知道何时发送数据。大概这将我限制为小于可用内存的文件。

因此，我的问题是，是否有一个简单而优雅的解决方案来使用 Cocoa 上传 HTTP POST 文件，它提供了大量的反馈和逐部分读取文件的能力，而不是一次全部读取？还是我应该从低级网络功能编写自己的课程？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T05:30:49.663

您可能想查看[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/How-to-use)框架。我没有用它来上传，但它看起来有更多的反馈，而且使用非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T03:12:42.117

我决定使用 CFNetwork 函数而不是 NSURLConnection。异步通知和特定功能（例如身份验证）似乎更具灵活性。不幸的是，它有点复杂（例如运行循环让我大吃一惊），所以如果你走这条路，我建议你阅读 CFNetwork 参考指南：

[http://developer.apple.com/documentation/Networking/Conceptual/CFNetwork/Introduction/Introduction.html](http://developer.apple.com/documentation/Networking/Conceptual/CFNetwork/Introduction/Introduction.html)

这是我的 POST 例程 FWIW 中的一段代码：

 `````
// Create our URL
CFStringRef url = CFSTR("Submit");
CFURLRef myURL = CFURLCreateWithString(kCFAllocatorDefault, url, baseUrl);

// Create the message request (POST)
CFStringRef requestMethod = CFSTR("POST");
CFHTTPMessageRef myRequest = CFHTTPMessageCreateRequest(kCFAllocatorDefault, requestMethod, myURL, kCFHTTPVersion1_1);

// Connect the read socket to the HTTP request stream
CFReadStreamRef myReadStream = CFReadStreamCreateForStreamedHTTPRequest(kCFAllocatorDefault, myRequest, readStream);
// TODO: why does this have to be done?
succ &= CFReadStreamSetClient(myReadStream,
  kCFStreamEventOpenCompleted | kCFStreamEventCanAcceptBytes | kCFStreamEventErrorOccurred | kCFStreamEventEndEncountered,
  (CFReadStreamClientCallBack) &MyReadCallBack, &myClientContext);
CFReadStreamScheduleWithRunLoop(myReadStream, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);
succ &= CFReadStreamOpen(myReadStream); 
````  `* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T08:47:17.807

[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest)最初只是为了这个目的而设计的（跟踪 POST 进度），因为在 2.x API 中，这对于 NSURLConnection 是不可能的。它肯定会比使用 CFNetwork 自行集成更容易，并且您可以免费获得许多其他东西（例如跨多个请求的进度跟踪、恢复下载等）。:)

如果您上传的文件很大，请务必查看直接从磁盘流式传输的选项，这样您就不必将数据保存在内存中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T16:37:53.247

您可以[在 github 上查看我的工具包存储库](http://github.com/AlanQuatermain/aqtoolkit/tree/master)的 HTTPMessage 部分，以获取围绕 CFHTTPMessageRef 的简单 ObjC 包装器；除其他外，它会给你一个 NSInputStream 对象，这样你就不用考虑纯 C 回调函数了。

根据您阅读的内容，您可能需要查看 XML（和 HTML）解析器的同一存储库的 StreamingXMLParser 部分，该解析器将代表您直接从所述 NSInputStream 解析数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T14:57:45.507

不幸的是，您说 NSURLConnection 在这里很弱是完全正确的。我推荐的最灵活的方法是[CocoaAsyncSocket](http://code.google.com/p/cocoaasyncsocket/)。这意味着滚动你自己的 HTTP，这很不幸，但在大多数情况下并不那么困难。[CocoaHTTPServer](http://code.google.com/p/cocoahttpserver/)演示了如何在 CocoaAsyncSocket 之上构建一个完整的 HTTP 服务器，并且可能有很多有用的代码可以解决您的问题。我发现这两个都非常有用。

另一种可能值得研究的方法是 WebKit。创建一个不可见的 WebView，然后 loadRequest: 一个 POST。我还没有深入研究estimateChange通知系统是包括上传时间还是只包括下载时间，但值得一试。

# python - 创建 Django 模型时出现“parent_id may not be NULL”

> ID：846298
> 
> 赞同：4
> 
> 时间：2009-05-10T23:19:12.480
> 
> 标签：python, database, django, models

我正在创建自己的`Group`模型；我不是指内置`Group`模型。我希望每个 hroup 成为另一个组的成员（它是父组），但是有一个没有父组的“顶级”组。

管理界面不允许我在不输入父级的情况下创建组。我得到错误`personnel_group.parent_id may not be NULL`。我的`Group`模型如下所示：

```
class Group(models.Model):
    name = models.CharField(max_length=50)
    parent = models.ForeignKey('self', blank=True, null=True)
    order = models.IntegerField()
    icon = models.ImageField(upload_to='groups', blank=True, null=True)
    description = models.TextField(blank=True, null=True) 
```

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T05:48:28.727

我在添加**`blank=True, null=True`**到**`parent`**字段定义之前创建了数据库。syncdb 无法处理这种类型的更改，因此 Django 没有接受我的更改。

我删除了我的数据库并让syncdb创建另一个，它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T10:08:31.583

Django 进化将让你摆脱这种问题，而不会删除你的完整数据库

# mysql - 是否可以在 mySQL 中进行跨机器 JOIN（即位于不同机器上的跨数据库）？

> ID：846299
> 
> 赞同：0
> 
> 时间：2009-05-10T23:19:51.857
> 
> 标签：mysql, database

我知道在 SQL Server 中这可以使用链接服务器。在 mySQL 中是否有一些类似的方法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T23:22:39.760

您可以查看[联合存储引擎](http://dev.mysql.com/doc/refman/5.1/en/federated-storage-engine.html)。我不知道它的稳定性，但它应该支持这样的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-05T18:54:03.070

`Federated Storage`是的，正如 Olafur Waage 在他的回答中所说，发动机是可能的。必须显式调用此存储引擎（通过在启动文件中创建相关条目），但您可以在本地设置要远程查询的“影子”表。但请注意：性能可能不是那么好 - 在最近的测试中，我对远程表（通过我的联合表）在本地执行查询，最终通过网络处理表的全部内容，然后执行查询，显然没有访问远程表上存在的索引（即使它们是在联合表中定义的）。结果是一个简单的远程查询大约需要 10 秒，但在对联合表运行大约一个小时后不得不中止。

# wpf - 如何知道 XAML 元素何时完成加载

> ID：846300
> 
> 赞同：2
> 
> 时间：2009-05-10T23:21:00.683
> 
> 标签：wpf, xaml

我有一个正在开发的自定义控件，其中包含一组项目。向集合中添加项目时，您需要执行以下操作：

```
myCustomControl.BeginAddItems();
  myCustomControl.Items.Add("a");
  myCustomControl.Items.Add("b");
  myCustomControl.Items.Add("c");
myCustomControl.EndAddItems(); 
```

如果在 XAML 中定义，它将是：

```
<MyControl>
  <Items>
    <Item Name="a" />
    <Item Name="b" />
    <Item Name="c" />
  </Items>
</MyControl> 
```

从 XAML 加载时如何`EndAddItems`调用（最好是 BeginAddItems）？XAML 是否可以通过任何方式`MyControl`通知它已完成加载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T08:15:33.103

您可以使用*Loaded*事件

# iphone - 将 int64 转换为 NSData

> ID：846301
> 
> 赞同：3
> 
> 时间：2009-05-10T23:22:14.473
> 
> 标签：iphone, nsdata, typeconverter, int64

我需要将一个 long 值从 int64 转换为 NSData，以便稍后在其上运行哈希算法。我执行：

```
int64_t longNumber = 9000000000000000000L;
NSMutableData *buffer = [NSMutableData dataWithBytes:&longNumber length:sizeof(longNumber)];

NSLog(@"%lld", [buffer bytes]);
NSLog(@"%lld", longNumber); 
```

结果控制台输出是这样的：

6201314301187184 9000000000000000000

为什么 NSData 不能正确存储长数字的值？如果我在循环中运行它，则 NSData 字节会漂移，从 620 开始，然后是 621 等等。我是通过 [buffer bytes] 输出 longNumber 的地址而不是它的值吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T23:30:12.980

您有两个主要问题：首先，您的数字对于您投射的时间来说太大了。而不是`9000000000000000000L`你应该`9000000000000000000LL`指示一个 long long 常数。

其次，您正确回答了您的问题，您正在打印一个地址。将您的 NSLog 行替换为以下行：

```
NSLog(@"%lld", *((int64_t*)[buffer bytes])); 
```

你应该看到你期望的结果。

# .net - T4 模板的问题

> ID：846305
> 
> 赞同：2
> 
> 时间：2009-05-10T23:26:21.613
> 
> 标签：.net, t4

我有以下代码，它与花括号和其他东西有关。

```
<#@ template language="C#" debug="True" hostspecific="True" #>
<#@ output extension=".cs" #>
<#@ assembly name="System.Data" #>

<#@ assembly name="System.xml" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Data.SqlClient" #>

namespace MyProject.Entities 
{   
    public class     
    {
        <#
        string connectionString = 
            "Server=localhost;Database=GridViewGuy;Trusted_Connection=true"; 
        SqlConnection conn = new SqlConnection(connectionString); 
        conn.Open(); 
        System.Data.DataTable schema = conn.GetSchema("TABLES"); 

        foreach(System.Data.DataRow row in schema.Rows) 
        { 

        #> 

        public class <#= row["TABLE_NAME"].ToString() #>            

        {

        }               

        } 

    }   

} 
```

谁能发现问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T23:51:08.733

它不编译的原因是因为`<# #>`标签内的 foreach 块没有相应的右括号。您需要进行以下更改：

```
foreach(System.Data.DataRow row in schema.Rows)                 
{                 
#>                 
  public class <#= row["TABLE_NAME"].ToString()#> 
  {                
  } 
<#
  } //this was missing.
#> 
```

此外，请记住，您的代码将创建一个没有名称的类，然后是带有表名称的嵌套类列表。像这样：

```
public class
{
  public class Table1
  {
  }

  public class Table2
  {
  }
  //... and so on..
} 
```

这可能不是您想要完成的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T23:47:00.830

在您的第一个块中，您启动一​​个代码块

```
 foreach(System.Data.DataRow row in schema.Rows) 
            { 

            #> 
```

但永远不要终止它。在下面的某个地方你需要这个：

```
 <# } #> 
```

*编辑*- 看起来它将是嵌套类定义下方的右花括号

# iphone - 减少 iPhone 应用程序的盗版

> ID：846309
> 
> 赞同：62
> 
> 时间：2009-05-10T23:30:26.333
> 
> 标签：iphone, piracy, piracy-prevention

有哪些公认的方法可以减少 iPhone 应用程序盗版，且不违反 Apple 的评估流程？

如果我的应用程序“打电话回家”提供运行它的唯一设备 ID，我需要收集哪些其他信息（例如，用于购买应用程序的 Apple ID）来创建授权使用该应用程序的有效注册令牌? 同样，我将使用什么代码来访问这些额外数据？

目前，解决这个问题的最佳可用技术方法是什么？

*（请不要回答关于盗版如何不可避免等的**非编程答案**。我知道盗版是不可避免的。我对讨论如何减少盗版**的基于编程的答案**感兴趣。提前感谢您的理解。）*

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-11T01:14:14.743

# 更新

请[访问并阅读](http://thwart-ipa-cracks.blogspot.com/2008/11/detection.html)

感谢评论中的 chpwn。

# 代码太旧了！- 2009 年 5 月 11 日

现在有一种更简单的方法可以检测您的 iPhone 应用程序是否已被盗版破解。这不涉及您根据接受的 ID 列表检查 iPhone 的唯一 ID。

目前，Crackers 做了三件事：

1.  编辑 Info.plist 文件
2.  将 Info.plist 从二进制解码为 UTF-8 或 ASCII
3.  将密钥对添加到 Info.plist{SignerIdentity, Apple iPhone OS Application Signing}

最后一个最容易用这段代码检查：

```
NSBundle *bundle = [NSBundle mainBundle]; 
NSDictionary *info = [bundle infoDictionary]; 
if ([info objectForKey: @"SignerIdentity"] != nil) 
{ /* do something */  } 
```

通常，我们在我们构建的任何 App Store 应用程序中都没有 SignerIdentity，因此检查 nil 然后执行设置指令应该会使破解者和盗版者更加困难。

我对此不以为然，因此请访问[如何阻止 iPhone IPA Crackers。](http://thwart-ipa-cracks.blogspot.com/2008/11/detection.html)那里有大量关于 iPhone 盗版以及如何遏制盗版的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T19:39:07.927

正如 Andrey Tarantsov 在评论中指出的那样，在二进制文件中查找“SignerIdentity”字符串（使用 HexEdit 之类的应用程序）并替换它非常容易。

您可以对该字符串进行编码，但您所要做的就是更改它的一个字符，应用程序将不再查找“SignerIdentity”键，而是查找可能不存在的其他键（因此为 null ）。该密钥为空，应用程序认为它没有被破解（因为如果应用程序没有被破解，SignerIdentity 应该为空）。

相反，我宁愿检查 info.plist 的大小并将其与参考值进行比较。我注意到模拟器和设备构建没有相同的 info.plist 文件大小。调试、发布和分发版本也是如此。因此，请确保使用 Device Distribution Build 的 info.plist 文件大小设置参考值。

如何[在启动](https://stackoverflow.com/questions/903157/get-filesize-of-info-plist-to-prevent-piracy)时查找文件大小：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T08:34:30.027

看起来保存 Plist 的 MD5 校验和并检查 CryptID 应该会做得很好直到一段时间。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-27T16:04:50.740

检查`iTunesMetadata.plist`购买日期，因为有时，当应用程序被破解时，该日期会更改为令人发指的日期。

还要检查购买者姓名字段是否存在。根据我破解个人使用应用程序的经验，这通常会被删除。如果有人知道 Temple Run 的反倾销保护是如何工作的，您可以将其与 poedCrackMod 无法获得的一些保护结合使用（谷歌 poedCrackMod 创建 hackulo.us 帐户，去开发中心寻找 poedCrackMod，将其安装在 iDevice 上） .

Clutch 不会通过 Temple Run 之类的保护来破解东西，它有一个名为 OverDrive 的功能，旨在让应用程序的破解检测静音。poedCrackMod 有 LamestPatch，它不是那么好。poedCrackMod 也是一个可以逆向工程的开源 bash 脚本。回顾一下，您有一个具有复制保护的应用程序，该应用程序无法通过离合器/过载来规避，但可以使用 poedCrackMod 破解。但是 poedCrackMod 无法绕过应用程序的应用内盗版检查。很难手动修补应用程序可执行文件中的完整性检查。所以你的应用很难破解。

# nhibernate - Fluent NHibernate 映射问题

> ID：846311
> 
> 赞同：4
> 
> 时间：2009-05-10T23:30:47.783
> 
> 标签：nhibernate, orm, fluent-nhibernate, mapping

我正在尝试使用 Fluent Nhibernate 映射几个表。我的测试给了我以下错误： NHibernate.Exceptions.GenericADOException: could not initialize a collection: [FluentWeb.Domain.Employees.Orders#1]

我正在尝试映射员工和订单之间的一对多关系。然后 Orders 与 Products (NorthWind) 具有多对多关系。这是我的映射..有人可以帮帮我吗。所有人都在使用 HBM

```
public class EmployeeMap : ClassMap<Employees>
{

    public EmployeeMap()
    {
        Id(x => x.EmployeeID);
        Map(x => x.FirstName);
        Map(x => x.LastName);
        Map(x => x.City);
        Map(x => x.HireDate);
        Map(x => x.Title);
        HasMany(x => x.Orders)
            .AsBag().WithForeignKeyConstraintName("EmployeeID")
            .Inverse()
            .Cascade.All();

    }
}

 public class OrdersMap : ClassMap<Orders>
{
    public OrdersMap()
    {
        Id(x => x.OrderID);
        Map(x => x.OrderDate);
        Map(x => x.RequiredDate);
        Map(x => x.ShippedDate);
        References(x => x.Employee);
        HasManyToMany(x => x.Products)
            .Cascade.All()
            .WithTableName("Order Details");

    }
}

public class ProductsMap : ClassMap<Products>
{
    public ProductsMap()
    {
        Id(x => x.ProductID);
        Map(x => x.ProductName);
        Map(x => x.UnitPrice);
        HasManyToMany(x => x.Orders)
            .Cascade.All()
            .Inverse()
            .WithTableName("Order Details");

    }
} 
```

如果需要更多信息，请告诉我。谢谢您的帮助！

-缺口

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T09:04:19.950

表名中的空格通常是一个非常糟糕的主意。如果您无法删除它们，请尝试将表名括在反引号中，这是 NHibernate 的与数据库无关的转义机制。

```
.WithTableName("`Order Details`'); 
```

# erlang - 崩溃后如何恢复进程状态？

> ID：846312
> 
> 赞同：8
> 
> 时间：2009-05-10T23:34:03.627
> 
> 标签：erlang, crash, state, exit, erlang-supervisor

重新启动崩溃的进程时保持状态的好方法是什么？

我在 OTP 应用程序中有一个主管，负责监视几个“子系统”gen_server。

例如，一个是“天气”子系统，它每 15 分钟生成一个新的天气状态并处理对当前天气状态的查询。（想想柠檬水摊游戏）

如果该 gen_server 崩溃，我希望它重新启动，但它应该以最近的天气状态重新启动，而不是硬编码在`init()`. 仅仅因为坠机，模拟状态突然从“冰雹风暴”变成“轻松愉快”是没有意义的。

由于增加了复杂性，我不愿在每次更新后使用 mnesia 或 ETS 来存储状态；有没有更简单的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T06:48:59.440

只要它必须在运行时，就会建议使用 ETS。价值远远大于复杂性。API 很简单，如果您使用命名表，访问也很简单。您只需在主管启动您的 gen_server 之前创建表。

两个更复杂的替代方案：

*   构建一对进程，一个用于工作，一个用于状态维护。由于第二个的简单性，它将非常可靠。
*   一个真正愚蠢的可能是每次状态发生变化时将主管的子规范与当前状态作为参数进行交换。**（微笑）**不，开玩笑的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T10:35:27.307

> 有没有更简单的方法？

当进程死亡时，它会向主管发送包含进程状态的消息，因此您可以使用此值存储在主管中（在 mnesia 或主管的状态中），并且当您的服务器将启动（在*init*中）时，它必须向主管发送同步调用以获取状态值。我没有真实的例子，但我希望它是有道理的。

无论如何，我真的没有看到将 State 存储在 mnesia 中的问题。

对不起我的英语:)

# security - Windows Media Center 应用程序和 UAC

> ID：846314
> 
> 赞同：1
> 
> 时间：2009-05-10T23:34:40.490
> 
> 标签：security, windows-vista, uac, mediacenter

我目前正在尝试编写一个 Windows Media Center 应用程序 (Vista)，它可以在启用 UAC 的情况下重新启动服务。禁用 UAC 时一切正常，但一旦启用 UAC，我就会收到拒绝访问错误。

我相信这是因为 Window Media Center 应用程序在 Windows Media Center 进程下运行，因此需要以管理员身份启动才能正常工作。有谁知道我如何在启用 UAC 的情况下实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T19:23:24.387

看一下这个。听起来您需要标记该过程以请求 UAC 允许继续：

[http://technet.microsoft.com/en-us/magazine/cc138019.aspx](http://technet.microsoft.com/en-us/magazine/cc138019.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-24T00:51:14.363

You can mark your process as needing to be elevated by adding

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
   <assemblyIdentity version="1.0.0.0"  name="CheckForceElevation" type="win32"/>
      <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
      <security>
         <requestedPrivileges>
            <requestedExecutionLevel level="requireAdministrator"/>
         </requestedPrivileges>
      </security>
   </trustInfo>
</assembly> 
```

To the manifest.

# java - SwingWorker 更新 TreeModel？

> ID：846317
> 
> 赞同：0
> 
> 时间：2009-05-10T23:34:53.797
> 
> 标签：java, swing, concurrency, tree

我的应用程序中有很多 JTree，它们都使用相同自定义 TreeModel 类的不同实例（具有不同选项）。我正在尝试添加一些线程来加快速度，因为 getChildren() 成员需要一段时间才能运行，所以我向 TreeModel 添加了一个 SwingWorker 子类，并在我的 getChildren() 中创建了该工作者的一个实例并执行它，然后返回它的 get() 结果。

我不断收到 ConcurrentModificationExceptions，我知道我应该同步一些东西，但不确定是什么。有人对如何让我的 TreeModel 安全响应有任何建议吗？

谢谢！约书亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T00:43:43.840

首先，我想知道您为什么要尝试使用线程来加快速度。它是受 CPU 限制的操作，还是受网络/磁盘限制的操作？

您的描述看起来好像您`getChildren`在返回之前等待操作完成。这对于多核硬件上的可并行操作可能很有用，但不是通用模型。通常我们（以及做什么`SwingWorker`）是在另一个线程上运行代码块，而事件调度线程可以自由地继续进行，直到它接收到一个事件来处理来自后台线程的数据。

`SwingWorker`没有记录它`ConcurrentModificationException`在任何地方抛出。堆栈跟踪可能会有所帮助。

我一般建议避免`SwingWorker`. 它非常适合创建一个小演示操作，但设计不佳。

线程是困难的，尤其是现在多线程硬件实际上有更多的错误。自由洒水`synchronized`不会让问题消失。一个相对简单的通用方法是避免共享可变对象（或至少改变共享对象）。将一组参数传递到 EDT 中未使用的后台线程。同样，将未修改的参数传回 EDT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T01:47:55.047

当您在两个线程上访问同一个 List 时，会发生 ConcurrentModificationExceptions。您的 TreeModel 可能使用 ArrayLists、Vectors、Hashtables 或类似的东西来存储节点。

我的猜测是发生了两件事之一：

1) 每次渲染时，EDT 线程上的 JTree 都会不断地查询您的 TreeModel。这是不可避免的，也是 Swing 的工作原理。如果您正在访问不同线程上的树模型或底层列表，您有时会在渲染的同时执行此操作，并且列表会引发异常。

2）你有两个摇摆工人在运行，每个人都在自己的线程上。他们同时更新/查询列表。和上面一样的问题。

我同意 Tom 的观点，即使用 SwingWorker 使 TreeModel “异步”是一个非常棘手的问题，应该避免。但是，为了回答您的问题，我将查看以下代码。请注意对树的所有查询和更新操作是如何在“完成”方法中发生的，该方法始终在 EDT 上运行。我的猜测是你在construct() 方法中做gets/sets。

```
 public TreeNode[] getChildren(TreeNode parent){

         // Do all normal work you would do
         ...

         // figure out if this parents children have not been fetched yet
         boolean needToFetch = ....

         if(needToFetch){

          worker = new SwingWorker() {
           public Object construct() {
            // go fetch your children from whatever database, server, file...
            // fetchNewChildren must NOT access the TreeModel or any of the underlying
            // lists, because you will get a modification exception.  This is what
            // Tom meant by "Pass a set of arguments into the background thread 
            // that are not being used in the EDT"

            return fetchNewChildNodes(parent);
          }

          public void finished() {
            List<TreeNode> newNodes = (List<TreeNode>)get();

            // insert the newly fetched nodes into the parent
            // if done correclty, this will fire TreeModelChanged events
            // so the tree should re-render, repaint, etc...
            parent.addChildren(newNodes); 
         }
         };

         worker.start();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T02:10:15.963

[也许尝试将数据存储在CopyOnWriteArrayList](http://java.sun.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)中的 TreeModel 中

# shell - 如何编写一个不会运行的 shellscript 日期检查 除了每月的第 3 周周六、周日和第 4 周周一

> ID：846323
> 
> 赞同：0
> 
> 时间：2009-05-10T23:49:13.947
> 
> 标签：shell, scheduled-tasks

例如，schellscript 将不会在 4 月 18 日、19 日和 20 日运行，然后 for may 是 16、17 和 18 日等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T10:17:57.290

我建议将 cron 用于此类事情，将计划的执行与脚本的**实际**作用分开。

[在这里](http://en.wikipedia.org/wiki/Cron)查看如何使用 cron。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T01:24:06.147

您可以使用 date 命令以数字形式获取工作日`date "+%w"`。周日的输出为 0，周一的输出为 1，以此类推。

您可以使用`date "+%d"`. 从中减去 1 并除以 7；这将为您提供当前月份的完整周数。

从那里开始，它只是一堆简单的 if/then 语句。如果您需要更多帮助来实际实现这一点，请询问。

希望有帮助！

# vb.net - vb.net中的sqlite，即使存在也找不到表

> ID：846324
> 
> 赞同：2
> 
> 时间：2009-05-10T23:50:47.000
> 
> 标签：vb.net, sqlite

我正在使用以下代码（VB.net 中的 System.Data.SQLite）：

```
 Dim SQLconnect As New SQLite.SQLiteConnection()
        Dim SQLcommand As SQLiteCommand
        SQLconnect.ConnectionString = "Data Source=vault.db;"
        SQLconnect.Open()
        SQLcommand = SQLconnect.CreateCommand
        SQLcommand.CommandText = "INSERT INTO entries VALUES ('" & appinput.Text & "','" & userinput.Text & "','" & passinput.Text & "')"
        SQLcommand.ExecuteNonQuery()
        SQLcommand.Dispose()
        SQLconnect.Close()
        Me.Hide() 
```

我收到一条错误消息，说它找不到表“条目”我知道该表存在，因为我可以通过 sqlite 和 Autoit 通过命令行写入它，并且可以在 SQLite 浏览器中查看并编辑它当我打开数据库。我不明白为什么 VB 看不到它（我知道它可以很好地看到并打开数据库文件）。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T02:27:20.910

您的问题很可能与相对路径（目录）有关。

如果它不存在，sqlite 将创建一个数据库文件，因此您将永远不会收到“db file not found 消息”。不正确路径的第一个指示是“表丢失”。

我个人的经验是，尽管这违背了我的程序员本能，但始终为 sqlite 数据库使用绝对（完全限定）路径/文件名。

如果您输入完整的文件位置，例如“/var/myapp/vault.db”，您应该没问题。如果这很可能在商店中移动，则从属性/配置文件中获取文件名——“找不到配置文件”比“找不到表”更容易处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T00:37:56.003

*啊！* 该代码中有3个大问题。请像这样更新它以修复其中两个：

```
Using cn As New SQLite.SQLiteConnection("Data Source=vault.db;"), _
      cmd As New SQLiteCommand("INSERT INTO entries VALUES (@AppInput, @UserInput, @PassInput)", cn)

    cmd.Parameters.AddWithValue("@AppInput", appinput.Text);
    cmd.Parameters.AddWithValue("@UserInput", userinput.Text);
    cmd.Parameters.AddWithValue("@PassInput", passinput.Text);

    cn.Open()
    cmd.ExecuteNonQuery()
End Using 
```

这将通过参数化查询而不是直接替换值来防止 sql 注入，并通过确保正确处理连接来防止数据库锁定问题，即使抛出异常也是如此。

第三个问题是你**永远不**应该在你的数据库（或其他任何地方）中存储纯文本密码。在存储或比较密码之前，请阅读如何在 .Net 中对值进行散列以及对密码进行散列和加盐。

一旦你完成了重新测试你的代码，看看你是否仍然得到和以前一样的错误报告。我们需要确保这没有解决问题或引入新的东西。然后我们可以开始解决缺少表的问题，也许可以通过检查您的[连接字符串](http://sqlite.phxsoftware.com/forums/p/938/4017.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-17T05:57:07.263

SQLite（通过.Net）拒绝相信该表存在，即使直接访问确认它存在，我也有类似的错误。该错误只能在一台单独的机器上产生，而不会在其他机器上产生。硬编码路径似乎并没有解决问题。修复方法是以管理员身份运行程序或更改数据库文件以供所有人使用。显然，当实际问题是访问限制时，.Net 程序集会引发丢失表错误。

# php - 从 XML 外部化对象创建还是从构造函数创建对象更好？

> ID：846326
> 
> 赞同：4
> 
> 时间：2009-05-10T23:52:38.900
> 
> 标签：php, design-patterns, oop

我有一些从 XML 配置创建的 PHP 类。我想知道的是：

我最好（从面向对象的角度）使用工厂方法从 XML 创建这些类，还是将 XML 传递给构造函数来创建类？

工厂方法的优点是将构造与使用分开，并且更容易允许替代实现，但是您需要公开设置器或将一大堆对象传递给构成其状态的构造函数。

另一个微妙之处在于，传入 XML 允许您自上而下地创建对象，而一些较低的对象将需要对它们上方的那些对象的引用。第二种方法将导致更自下而上的结果。

还是有更多的设计模式类型的方式来解决这个问题？

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T12:01:29.597

对于干净的设计，最好将用于从 XML 创建 Foo 的代码完全保留在 Foo 之外，但是在某种工厂中。这样，如果您想添加一种从 JSON、CSV 或任何数据创建它的方法，Foo 可以保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T03:13:20.930

听起来您需要某种依赖注入框架。[这里](http://fabien.potencier.org/article/11/what-is-dependency-injection)有一个很好的 Symphony DI 大纲。一个好的 DI 框架将帮助您设计一个干净且可测试的架构，这可以缓解构造函数需要太多参数等问题。

# jquery - Opera 处理 jQuery 的 animate 方法很奇怪

> ID：846334
> 
> 赞同：3
> 
> 时间：2009-05-10T23:59:22.073
> 
> 标签：jquery, animation, opera

我有一个下拉菜单。它的高度用 jQuery 动画从 5px 到 130px，反之亦然。

菜单在分离元素时运行良好（当我开发它时）但是当另一个元素出现时，Opera 让我们大吃一惊：

[替代文字 http://img12.imageshack.us/img12/9366/menusy.png](http://img12.imageshack.us/img12/9366/menusy.png)

我将第一个状态标记为 1，将第二个状态标记为 2。第三个状态应该与第一个状态相同，但您可以看到它有一个“尾巴”。

UPD：源代码

html:

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 

"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script type="text/javascript" src="js/jquery.js">
    </script>
    <script type="text/javascript" src="js/script.js">
    </script>
    <script type="text/javascript">
      $(function(){
        init();
      });
    </script>
    <link rel="stylesheet" href="css/styles.css"/>
</head>
<body>
  <div id="side" class="side_outer"> 
        <div class="cn tr"> </div>
        <div class="cn tl"> </div>

        <div class="auth">
          <span class="auth_entr">Click me</span> 
          <div class="auth_fields"> 

          </div>
          <div id="auth_separator"> </div>
        </div>
        <div class="side_inner">
            <div class="cn tr"> </div>
            <div class="cn tl"> </div>
                <div class="side_content">
                    Some content
                </div>   
            <div class="cn br"> </div>
            <div class="cn bl"> </div>
        </div>
        <div class="cn br"> </div>
        <div class="cn bl"> </div>  
  </div>
  <div id="header"> Header</div>
  <div id="central"> Center</div>
</body>
</html> 
```

CSS：

```
#header {
  background: red;
  height: 100px;
  margin: 30px 330px 20px 20px;

}

#central {
  background: green;
  height: 150px;
  margin: 20px 330px 20px 20px;
}

#side {
  margin-right: 3%;
  margin-left: 10px;
  margin-top: 30px;
  min-width: 200px;
  float: right;
}

.side_outer {
  padding: 0 10px;
  background: #f2f2cc;
  width: 22%;
  border-bottom-style: dashed;
  border-bottom-width: 2px;
  border-bottom-color: black;
}

.side_inner {
    position:relative;
    overflow:hidden;
    padding: 0 10px;
    background: #accbfa;  
}

.side_outer .cn {
  position: relative;
  width: 20px;
  height: 20px;
}

.side_outer .cn.tr, .side_outer .cn.br {
  float: right;
  left: 10px;
}

.side_outer .cn.tl, .side_outer .cn.bl {
  left: -10px;
}

.auth {
  overflow: hidden;
}

.auth_entr {
  position: relative;
  top: 5px;
  margin-left: 17px;
  padding:  0 5px;
  color:  #1e5ebe;
  cursor: pointer;
}

.auth_fields {
  overflow: hidden;
  height: 5px;
  margin-top: 5px;
}

#auth_separator {
  height: 6px;
  font-size: 2px;
}

.side_content {
  height: 100px;
  padding: 5px 15px;
} 
```

javascript:

```
var auth_state = 1;

function init () {
  $('span.auth_entr').click (function (){
     auth_state = (auth_state + 1) % 2;
     if (auth_state == 1) {
          $('div.auth_fields').animate({height: '5px'},  1000);
     } else {
          $('div.auth_fields').animate({height: '132px'}, 1000);
     }
  });
} 
```

实际上我已经使用一些街头魔术解决了这个问题（我在菜单底部添加了厚厚的白色边框，现在“故事”是透明的）。但我很好奇是什么问题，有什么正常的解决方案吗？

PS 另一个元素实际上是具有固定尺寸和背景的空 div。我的 Opera 版本是 9.5（我知道它很旧，但它仍然在我的观众中流行）。

PPS 我刚刚在 Opera 9.6 中对其进行了测试，并且出现了同样的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T07:46:18.693

我在 IE 7、8 和 FF3 下测试了你的代码，它运行良好。但是，正如您已经指出的那样，在 Opera 中运行动画时确实存在错误。我在 Opera 9.64 中对其进行了测试，并得到了与您相同的结果。

我在 Google 和 Opera 论坛中进行了搜索，但找不到任何有关此特定错误的参考。我能找到的最接近的是：**[jquery-smooth-scroll-bugs](http://www.zachstronaut.com/posts/2009/01/18/jquery-smooth-scroll-bugs.html)**。

您可能需要创建票证才能报告 Opera 的此错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-21T16:58:58.697

您可以在 之后放置一个空 div `<div class="cn bl">`，并将其高度设置为 50px（或任何足够的值），并将其下边距设置为相同但为负值（即 -50px）。

# sql-server - 如何让 SQL Server Management Studio 停止处理错误？

> ID：846336
> 
> 赞同：34
> 
> 时间：2009-05-11T00:01:41.930
> 
> 标签：sql-server, ssms

这似乎是一个非常愚蠢的问题，但我如何让 SQL Server Management Studio 在遇到错误时停止处理 SQL 脚本？

我有一个很长的脚本，如果一开始有错误，SSMS 会报告它，然后盲目地继续，把事情搞砸了。我不能使用事务，因为脚本创建了几个数据库并且它们不能进入事务。有时会失败是数据库创建。

Toad for SQL Server 将在遇到第一个错误时暂停，并询问您是要停止还是继续。这是我正在寻找的行为。它存在于 SSMS 中吗？

我**不是**在问，“我如何编写或修改脚本以使其在出现错误时停止？” 我对修改我的脚本以实现这一点不感兴趣，我只想让 SSMS*在出现错误时停止*。Toad for SQL Server**正是这样做**的，这就是我想要的行为。这也不是[659188](https://stackoverflow.com/questions/659188/sql-server-stop-or-break-execution-of-a-sql-script)的副本，因为这与修改脚本以停止 SSMS 有关。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T02:38:22.967

简短的回答：你不能。

感谢那些提供解决方法的人，但似乎 SSMS 本身无法像 Toad for SQL Server 那样设置为暂停或停止错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-17T01:24:49.910

考虑使用 SQL Server 附带的命令行程序“sqlcmd”，并设置 -b 和 -V 选项。-b 将导致 sqlcmd 在遇到错误时退出。-V 控制被认为是错误的严重性级别。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-11T00:08:40.233

ApexSQL 脚本以您想要的方式生成批处理脚本。举个例子：

```
--Script Header
begin transaction
go

{Statement #1}
go
--Standard Post-Statement Block
if @@error <> 0 or @@trancount = 0 begin
    if @@trancount > 0 rollback transaction
    set noexec on
end
go

{Statement #2}
go
--Standard Post-Statement Block
if @@error <> 0 or @@trancount = 0 begin
    if @@trancount > 0 rollback transaction
    set noexec on
end
go

--Script Footer
if @@trancount > 0 commit transaction
go
set noexec off
go 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-11T00:03:59.850

您需要将 SQL 语句包装在**[Transaction](http://msdn.microsoft.com/en-us/library/ms188929.aspx)**中。

```
BEGIN TRANSACTION
   /* run all your SQL statements */
COMMIT TRANSACTION 
```

如果开始/结束事务中出现错误，所有语句都将回滚。

**编辑：**在开始/结束事务内部包装，将阻止语句提交到数据库，但不会在此时停止它。您需要另外将其包装在 try/catch 块中，如下所示：

```
BEGIN TRY
  BEGIN TRANSACTION
  /* run all your SQL statements */
  COMMIT TRANSACTION
END TRY
BEGIN CATCH
  ROLLBACK TRANSACTION
END CATCH 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-05-25T16:29:14.907

11年后SSMS仍然没有这个功能......

**但！**您可以启用`SQLCMD mode`（菜单/查询/SQLCMD 模式），然后在文本编辑器中定义此选项：

```
:ON ERROR EXIT 
```

在你的 t-sql 脚本之前。现在它将停止执行错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-19T22:36:16.057

哇。这有点垃圾不是吗？我使用 SQL-Workbench，就像 Toad for SQL Server 一样，可以轻松处理这个问题。但与 Toad for SQL Server 不同，它是免费的。

我很惊讶这样的基本功能不是标准工具的一部分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-11T00:06:40.000

将在此处使用 try catch 块帮助。出错时将退出try，在catch中实现错误处理

[http://msdn.microsoft.com/en-us/library/ms179296.aspx](http://msdn.microsoft.com/en-us/library/ms179296.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-04-05T23:26:30.213

这里提到了更多的解决方法：

[SQL Server - 停止或中断 SQL 脚本的执行](https://stackoverflow.com/questions/659188/sql-server-stop-or-break-execution-of-a-sql-script)

和

[SQL Server：如何中止查询分析器中的一系列批处理？](https://stackoverflow.com/questions/927102/sql-server-how-to-abort-a-series-of-batches-in-query-analyzer)

（raiseerror 20 with log, set noexec on, sqlcmd mode :on error exit 等）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T02:06:29.090

如果您不能将脚本放入存储过程并使用 return 语句在错误时退出，那么@Justice 提供的解决方案可能是您最好的选择。其他人都忽略了这一点——你不能从脚本中返回，即使你使用事务或者即使你 raiserror。SSMS 无论如何都会执行下一件事，即使 set xact abort 已打开。

如果您可以将脚本转换为存储过程，那么您可以在检测到错误时从它返回。

# php - 我用PHP制作了一个上传脚本。如何避免覆盖文件？

> ID：846340
> 
> 赞同：3
> 
> 时间：2009-05-11T00:04:32.843
> 
> 标签：php

我已经使用该`move_uploaded_file`功能制作了一个图像上传脚本。此功能似乎用新文件覆盖任何预先存在的文件。所以，我需要检查目标位置是否已经有文件。如果是这样，那么我需要在文件名中附加一些内容（在扩展名之前，以便文件名仍然有效），以便文件名是唯一的。如果可能的话，我希望更改最小，而不是像附加日期时间那样。

我怎样才能用 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-11T00:12:24.517

上传文件时，我几乎总是会重命名它们。通常，该文件会有某种数据库记录。我使用它的 ID 来保证文件的唯一性。有时我什至会将客户的原始文件名存储在数据库中，但我永远不会保留它或临时名称，因为不能保证信息是好的，你的操作系统会支持它或者它是唯一的（这是你的问题）。

因此，只需将其重命名为您自己设计的某种方案。这是我的建议。

如果您没有任何数据库引用，那么您可以为此使用[file_exists()](http://au.php.net/file_exists)但不能保证在检查某些东西是否存在和移动它之间，其他东西不会使用您将使用的相同文件名覆盖。这是一个经典的[比赛条件](http://en.wikipedia.org/wiki/Race_condition)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T00:08:00.920

[http://us3.php.net/manual/en/function.file-exists.php](http://us3.php.net/manual/en/function.file-exists.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T00:39:34.923

不要使用 file_exists() 因为它返回 true （至少在 *nix 系统上，因为目录是专门的文件）如果值是一个目录。使用 is_file() 代替。

例如，说某事失败，你有一个字符串，如：

```
$path = "/path/to/file/" . $file; // Assuming $file is an empty value, if something failed for example
if ( true === file_exists($path) ) { echo "This returns true"; }
if ( true === is_file($path) ) { echo "You will not read this"; } 
```

它在过去给我造成了一些问题，所以我总是使用 is_file() 而不是 file_exists()。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T00:56:40.280

我使用日期和时间函数根据上传时间生成随机文件名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-01T08:26:02.813

假设您正在从一个表单提交一个文件，其中您的输入命名`incomingfile`如下：

```
<input type="file" id="incomingfile" name="incomingfile" /> 
```

首先，我使用“去除”文件名并将其从默认临时目录复制到临时目录。这是处理特殊字符所必需的。当我不采用这种做法时，我遇到了麻烦。

```
$new_depured_filename = strtolower(preg_replace('/[^a-zA-Z0-9_ -.]/s', '_', $_FILES["incomingfile"]["name"]));
copy($_FILES["incomingfile"]["tmp_name"], 'my_temp_directory/'.$new_depured_filename); 
```

使用以下代码检查文件是否存在，如果存在，我会找到一个新名称并最终复制它。例如，如果我想编写一个名为`myimage.jpg`并且它已经存在的文件，我将挂起的文件重命名为`myimage__000.jpg`. 如果这也存在，我将挂起的文件重命名为 myimage__001.jpg 等等，直到找到一个不存在的文件名。

```
$i=0; // A counter for the tail to append to the filename
$new_filename = $new_depured_filename;
$new_filepath='myfiles/music/'.$new_filename;
while(file_exists($new_filepath)) {
    $tail = str_pad((string) $i, 3, "0", STR_PAD_LEFT); // Converts the integer in $i to a     string of 3 characters with left zero fill.
    $fileinfos = pathinfo($new_filepath); // Gathers some infos about the file
    if($i>0) { // If we aren't at the first while cycle (where you have the filename without any added strings) then delete the tail (like "__000") from the filename to add another one later (otherwise you'd have filenames like myfile__000__001__002__003.jpg)
        $previous_tail = str_pad((string) $i-1, 3, "0", STR_PAD_LEFT);
        $new_filename = str_replace('__'.$previous_tail,"",$new_filename);
    }
    $new_filename = str_replace('.'.$fileinfos['extension'],"",$new_filename); // Deletes the extension
    $new_filename = $new_filename.'__'.$tail.'.'.$fileinfos['extension']; // Append our tail and the extension
    $new_filepath = 'myfiles/music/'.$new_filename; // Crea il nuovo percorso
    $i++;
}

copy('my_temp_directory/'.$new_depured_filename, $new_filepath); // Finally we copy the file to its destination directory

unlink('my_temp_directory/'.$new_depured_filename); // and delete the temporary one 
```

使用的函数：
[strtolower](http://php.net/manual/en/function.strtolower.php)
[preg_replace](http://php.net/manual/en/function.preg-replace.php)
[copy](http://php.net/manual/en/function.copy.php)
[file_exists](http://php.net/manual/en/function.file-exists.php)
[str_pad](http://php.net/manual/en/function.str-pad.php)
[pathinfo](http://php.net/manual/en/function.pathinfo.php)
[str_replace](http://php.net/manual/en/function.str-replace.php)
[unlink](http://php.net/manual/en/function.unlink.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T00:11:28.027

要检查文件是否存在，您可以使用该[`file_exists`](http://fr.php.net/manual/fr/function.file-exists.php)功能。

要剪切文件名，您可以使用该[`pathinfo`](http://fr.php.net/manual/fr/function.pathinfo.php)功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T04:15:30.437

我用

```
$file_name = time() . "_" . $uploaded_file_name; 
```

# cocoa - 将非模型节点添加到 NSTreeController

> ID：846341
> 
> 赞同：1
> 
> 时间：2009-05-11T00:06:24.683
> 
> 标签：cocoa, core-data

我有一个管理实体的 NSTreeController 是一个核心数据模型和一个显示此树的 NSOutlineView。

我希望树显示一些与底层核心数据模型中的实体不对应的特殊节点。我该怎么做呢？我应该继承 NSTreeController 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T13:06:32.187

请记住，即使使用 Core Data，您也不必使用 NSTreeController。我一直避免使用它，因为它在 10.4 中的声誉很差，尽管我听说 10.5 有所改进。在任何情况下，使用 NSOutlineView 的数据源方法都可以让您完全控制 UI 中包含的内容。子类化 NSTreeController 可能有效，但它比数组控制器更具挑战性，因为它使用浅代理对象，而不是您的实际核心数据实体。

# python - 快照电影

> ID：846343
> 
> 赞同：1
> 
> 时间：2009-05-11T00:07:07.113
> 
> 标签：python, screenshot, snapshot, movie

我目前正在学习 Python，并参与了几个小项目来帮助学习这门语言。目前是否有任何库（可能是 PythonMagick）能够从 .wmv、.avi、.mpg 或仅使用命令行选项（无 GUI）的其他电影格式中提取快照？如果是这样，任何人都可以提供代码示例的链接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T00:36:22.997

在谷歌快速搜索发现[pymedia](http://pymedia.org/tut/)。它支持 avi, dvd, wma, ...

这是有关如何从视频中获取快照的[示例](http://pymedia.org/tut/src/dump_video.py.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T00:48:18.467

此外，如果 CLI 情况不是强制性的，[Pyglet](http://www.pyglet.org)非常容易用于加载电影、图像等，并且有很好的文档记录。

# sql - 用 XQuery 替换 SQL Server 中的 xml 命名空间前缀

> ID：846354
> 
> 赞同：3
> 
> 时间：2009-05-11T00:19:07.423
> 
> 标签：sql, sql-server, database, sql-server-2005, xquery

我在现有的 SQL Server 2005 数据库表中有一个定义了特定命名空间的 xml 结构，我需要查询 XML 并在此过程中将命名空间前缀更改为默认命名空间。旧 xml 在根节点和子节点上定义了命名空间，我知道如何轻松替换根，但不知道子节点的命名空间。

当前数据：

```
<sg:Settings xmlns:sg="uri:mynamespace">
    <sg:SomeData xmlns:sg="uri:mynamespace"/>
</sg:Settings> 
```

使用 SQL：

```
WITH XMLNAMESPACES 
('uri:mynamespace' as sg)
SELECT 
    settingsNode.query('<Settings xmlns="uri:mynamespace"> { sg:SomeData } </Settings> ')
FROM 
    SettingsTable CROSS APPLY
    SettingsXml.nodes('/sg:Settings') T(settingsNode) 
```

我可以得到以下信息：

```
<Settings xmlns="uri:mynamespace">
    <sg:SomeData xmlns:sg="uri:mynamespace"/>
</Settings> 
```

但我试图得到这个：

```
<Settings xmlns="uri:mynamespace">
    <SomeData/>
</Settings> 
```

有没有办法使用 SQL XQuery 合并命名空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-08T09:38:47.627

## 如果你想用空格替换它

```
update tbl_Archive set XML.modify('delete /*:Document/*:Volume[text()]/@xmlns:sg') 
```

# c++ - 如果 ANSI C++ 不支持多线程，非托管 C++ 应用程序如何实现多线程？

> ID：846355
> 
> 赞同：3
> 
> 时间：2009-05-11T00:19:11.057
> 
> 标签：c++, multithreading, unmanaged, managed

我听说 C++ 不提供对多线程的本机支持。我假设多线程 C++ 应用程序依赖于多线程的托管代码；也就是说，例如，一个 Visual C++ 应用程序使用 MFC 或 .NET 或类似的东西来提供多线程功能。我进一步假设这些托管代码功能中的一些或全部对于非托管应用程序是不可用的。但是我已经阅读了有关非托管多线程应用程序的信息。这怎么可能？我的哪个假设是错误的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T00:22:17.917

为多线程提供支持完全取决于操作系统。在 Windows 上，必要的功能可通过 Win32 API 获得。诸如[MFC](http://msdn.microsoft.com/en-us/library/975t8ks0.aspx)之类的框架提供了对低级线程函数的封装以简化事情，而 .NET/CLR 当然有自己的托管接口来访问 Win32 多线程功能。

[本文](http://www.devarticles.com/c/a/Cplusplus/Multithreading-in-C/)提供了一个很好的解释（*C++ 中的多线程*）。

> **为什么 C++ 不包含对多线程的内置支持？**
> 
> C++ 不包含对多线程应用程序的任何内置支持。相反，它完全依赖于操作系统来提供此功能。鉴于 Java 和 C# 都提供了对多线程的内置支持，很自然地会问为什么 C++ 也不是这种情况。答案是效率、控制以及应用 C++ 的应用范围。让我们逐一检查。
> 
> 由于不支持多线程，C++ 不会尝试定义“一刀切”的解决方案。相反，C++ 允许您直接利用操作系统提供的多线程特性。这种方法意味着您的程序可以以执行环境支持的最有效方式进行多线程处理。由于许多多任务环境为多线程提供了丰富的支持，因此能够访问该支持对于创建高性能、多线程程序至关重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T02:08:15.950

C++ 中的多线程不需要托管代码。

与 C++ 不提供对显示图形或发出声音或从鼠标读取输入的本机支持非常相似，所使用的操作系统将提供 C++ API 来利用这些功能。

这不是 C++ 无法做到的问题。它还没有被写入 C++ 标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T00:24:16.760

你的一些假设并不完全正确。操作系统（我说的是win32，因为你提到了.NET）提供了对线程的支持。有很多好的线程库。它建立在 C++ 中的操作系统功能之上，使多线程“更容易”:)——例如 [pthreads 。](http://sourceware.org/pthreads-win32/)[这是 MSDN 上的更多内容](http://msdn.microsoft.com/en-us/library/y6h8hye8(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T02:26:14.343

编程语言 C++ 的 ISO 标准既没有定义也没有禁止多线程。如果需要，允许实现提供扩展。如果程序愿意，可以使用实现扩展，然后程序将只在提供这些扩展的系统上运行。

相比之下，编程语言 C++ 的 ISO 标准既没有定义也没有禁止使用鼠标。允许程序使用实现扩展，然后它只能在提供这些扩展的系统上运行。作为另一个比较，C++ 的 ISO 标准既没有定义也没有禁止 UTF-8，因此您的程序可以依赖于 Latin-1，然后您的程序将只能在提供 Latin-1 的系统上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T07:46:54.213

本机 C++ 不提供“内置”多线程支持，仅仅是因为它不是有意或实际上不需要的。您的误解是这是一个错误，而实际上它是语言的优势。通过“无视”多线程，C++ 与您的代码将在其上编译和运行的操作系统提供的 MT 支持无缝集成，从而提供比它自己的“MT 包袱”更多的灵活性和效率。您提到 MFC 和 .NET 作为示例 - 请注意，这些库/包装器只是基本 Win32 API 的一层。按预期使用 C++ 将为您提供可在任何操作系统上多线程运行的高效代码，只要您将逻辑与特定于操作系统的 MT API 调用（即线程创建等）分开，以便在操作系统之间移植

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T02:40:06.803

与定义语言结构和 JVM 规范的 Java 不同，C++ 标准忽略了线程（C 也是如此）。就这些语言而言，任何与线程相关的内容都包含对操作系统功能的函数调用。为多线程编译的库只是简单地理解相同的调用，但从语言的角度来看，它们是普通的旧代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T14:03:01.950

下一个 C++ 标准（名为 c++0x）将支持多线程。将包括原子操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-11T07:54:30.847

我认为您误解了“托管”代码的定义。“托管”代码是 Microsoft 特定的术语，意思是使用 .NET 框架的代码，因此受 .NET 各个方面的约束。“非托管”代码是指在其外部运行且不通过 .NET 层运行的代码。MFC 代码是“非托管”的；对于无处不在的 Win32 API（它甚至不是 Windows 上可用的最低级别的 API），它只是一个非常糟糕的包装器。

.NET 库（包括多线程）在某种程度上几乎都是传统“非托管”应用程序使用的更基本系统 API 的接口。一般来说，“托管”代码没有可用的功能，无法通过足够的努力在“非托管”代码中复制，尽管反过来是不正确的（如果您想了解更多信息，这称为抽象惩罚）。虽然在“托管”代码中可能更容易做到，但这只是因为在某个地方，一些“非托管”代码或多或少地为你做这件事。在线程 API 的情况下，它又是操作系统内核的接口，它本身访问处理器的功能以允许进程同时在多个位置运行（如果使用多个内核；如果不是，那么它）

C++ 标准目前没有提供线程的定义（即将到来的 C++1x 标准提供）。有许多不同的线程库可用，包括 Win32 和 MFC 提供的、POSIX 系统上的 pthreads 库和 Boost.Thread，它将使用平台的本地线程库。

# windows - 在 Windows 中生成专业图表

> ID：846358
> 
> 赞同：1
> 
> 时间：2009-05-11T00:21:32.067
> 
> 标签：windows, language-agnostic, graphics, graph

在 Windows 中，我正在研究使用任何主流编程语言（C#、VB.Net、Java、PERL 等）生成专业图形。到目前为止，我发现的最好的免费图表是[Microsoft Chart Controls for .NET](http://social.msdn.microsoft.com/Forums/en-US/MSWinWebChart/threads/)。您还建议使用哪些其他图形控件/模块？

注意：免费添加到要求中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T01:03:29.143

[jFreeChart](http://www.jfree.org/jfreechart/)是 Java 最好的解决方案之一。我完全推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T01:03:35.963

你看过[Zedgraph](http://zedgraph.sourceforge.net/samples.html)吗？它是 LGPL，但相当广泛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T01:10:37.353

那里有几十个商业图表组件。就个人而言，我喜欢 DevExpress 工具。

[XtraCharts](http://devexpress.com/Products/NET/Controls/Charting/)非常好，有据可查，而且相对实惠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T03:30:36.330

[GLE](http://glx.sourceforge.net/)是一种脚本语言，旨在生成专业质量的图表以供发布。它使用 LaTeX 进行排版，因此在图表中包含方程式很容易，而且看起来很棒。Christopher Bishop 将 GLE 用于他的教科书“模式识别和机器学习”中的所有图表，让我告诉你，它们看起来*很棒。* 开源启动！

首先，您编写 GLE 脚本并告诉它接受一个文本文件作为图形输入数据。然后，您可以用您想要的任何语言生成数据集，导出为文本文件，并调用 GLE 脚本来生成图形。

[来自网站的](http://glx.sourceforge.net/)更多信息：

> GLE（图形布局引擎）是一种图形脚本语言，设计用于创建出版质量的图形、绘图、图表、图形和幻灯片。GLE 支持各种图形类型（函数图、直方图、条形图、散点图、等高线、彩色图、曲面图……）... GLE 的输出格式包括 EPS、PS、PDF、JPEG 和 PNG。

# php - 使用 Zend 框架的流行开源项目

> ID：846364
> 
> 赞同：11
> 
> 时间：2009-05-11T00:25:04.667
> 
> 标签：php, zend-framework

我正在尝试查找任何基于 Zend Framework 的开源项目。一些写得很好并且像 WordPress 或 Drupal 一样流行的东西，可以看到 ZF 的实际好处，并可能将其用作示例。

我设法找到的唯一“展示”是[http://framework.zend.com/wiki/pages/viewpage.action?pageId=14134](http://framework.zend.com/wiki/pages/viewpage.action?pageId=14134)。但是对于“官方”PHP 框架，这个列表看起来很混乱。ZF 的统计数据也是如此（[http://framework.zend.com/about/numbers）——400](http://framework.zend.com/about/numbers)个实际项目的 1000 万次下载，用户指南中的示例少于 500 个。雅虎也选择了 Symfony 的书签服务而不是 ZF。

我错过了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-11T00:36:55.537

Magento 是一个电子商务平台，是使用 Zend 框架构建的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-11T00:33:41.440

我个人发现 Zend 框架主要用于构建内部网站，很像 CakePHP 和 Symfony。它们是开源项目，然后被用于构建出色的应用程序。

不是每个人都想让人们知道他们正在使用什么后端，或者他们使用它的目的。Zend 框架和其他框架留在后台，帮助网站的开发人员构建一个伟大的应用程序。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-06-10T14:04:50.513

[TomatoCMS](http://www.tomatocms.com/)一个使用 Zend 框架和 jquery 的开源 CMS [http://www.tomatocms.com/](http://www.tomatocms.com/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-10T08:50:45.387

[Piwik](http://piwik.org/) - 一个开源统计系统。谷歌分析的替代品。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-29T13:20:04.307

这些人使用 ZF 重写了他们的应用程序： [AtMail webclient](http://atmail.com/webmail-client/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T12:59:13.667

除了 Magento，我还发现了另外一个开源项目[——Digitalus CMS](http://digitaluscms.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-10T14:11:47.897

[Pimcore](http://pimcore.org)是一个使用 ZF 和 ExtJS 的漂亮的 cms。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-19T17:21:13.330

[Precurio](http://www.precurio.com)是一个开源的内网门户软件，也使用 Zend Framework

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-29T07:17:55.830

[用 Zend 编写的](https://github.com/centurion-project/Centurion/)一个非常简洁的CMS，称为 Centurion 。我用谷歌搜索了一些组织良好的 Zend 测试项目，所以[在这里](https://github.com/centurion-project/Centurion/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-17T22:14:07.297

efront LMS [http://www.efrontlearning.net/](http://www.efrontlearning.net/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-08-12T21:02:40.487

我不知道任何开源项目，但我发现了两个应用程序，专门用于展示 Zend 框架 - 版本 1.8 和 1.9（我认为应该可以工作）

*   [PASTEBIN](http://weierophinney.net/matthew/archives/189-Pastebin-app-and-conference-updates.html) - 主要展示 dojo 的应用程序，但具有 nicemodel 结构，作者[Mathew - 很棒的博客](http://weierophinney.net/matthew/)
*   [StoreFront](http://www.ohloh.net/p/zfstorefront) - 电子商务应用程序

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-09-08T12:08:26.803

conjoon：www.conjoon.org/，Tine
2.0：www.tine20.org/，Zoolu
：code.google.com/p/zoolu/，ecartcommerce
：code.google.com/p/ecartcommerce/

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-06-10T08:58:52.710

以下是使用 Zend 框架的项目列表，尽管它已过时：[http](http://devzone.zend.com/article/2060) ://devzone.zend.com/article/2060 。

以及在 SourceForge 上使用 ZF 的当前项目列表：http: [//sourceforge.net/search/](http://sourceforge.net/search/?type_of_search=soft&words=zend+framework) ?type_of_search=soft&words=zend+framework 。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-30T10:20:01.550

我们还在我们的项目[renbo.cz](https://www.renbo.cz)上使用 Zend Framework 2 。我不得不说我们对这个选择很满意。ZF2 是模块化的，写得很好，最重要的是 - 非常有据可查。

# objective-c - 填充 NSTableView 后禁用自动选择行

> ID：846365
> 
> 赞同：1
> 
> 时间：2009-05-11T00:27:22.293
> 
> 标签：objective-c, cocoa, cocoa-bindings, key-value-observing

我有两个 NSTableViews 填充了使用绑定链接的核心数据。当在 NSTableView1 中选择一行时，将填充 NSTableView2 并选择其中的第一行。我已经在它的 selectionIndex 上注册了与 NSTableView2 对应的 NSArrayController 和 KVO。这样当在 NSTableView2 中选择一行时，就会运行一个方法。我的问题是，当在 NSTableView1 中选择一行时，选择 NSTableView2 中的第一行来触发该方法。我想要它，以便我可以在 NSTableView1 中选择一行并填充 NSTableView2，而无需在 NSTableView2 中自动选择一行。这是如何实现的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T02:37:09.053

你正在使用 Core Data 在这里并不重要。这严格来说是一个绑定问题。

关闭阵列控制器上的“避免空选择”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-19T09:49:44.857

该解决方案适用于我 Xcode 8.3.3。

我点击了空复选框：

[![在此处输入图像描述](https://i.stack.imgur.com/HfEO5.png)](https://i.stack.imgur.com/HfEO5.png)

# c# - 如何创建 Windows 注册表观察程序？

> ID：846366
> 
> 赞同：13
> 
> 时间：2009-05-11T00:27:42.823
> 
> 标签：c#, .net, vb.net, registry

如何使用 .Net 创建 Windows 注册表观察应用程序，

我希望此应用程序监视所有注册表挂钩并在值更改时触发一个事件，该事件将告诉该值的**旧值和新**值。

那可能吗？如何？只需要想法或从哪里开始

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-11T00:37:19.030

看看[RegistryMonitor - RegNotifyChangeKeyValue 的 .NET 包装类](http://www.codeproject.com/Articles/4502/RegistryMonitor-a-NET-wrapper-class-for-RegNotifyC)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T00:38:12.807

.Net 框架不包含用于监视注册表的嵌入式类。但是您仍然可以使用包装的 WinAPI 调用或 WMI 接口（参见[示例](http://www.codeproject.com/KB/system/WMI_RegistryMonitor.aspx)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-25T19:58:31.603

订阅可以[通过 WMI](https://support.microsoft.com/en-us/kb/2494270)或直接通过在单独的线程中阻塞[RegNotifyChangeKeyValue](https://msdn.microsoft.com/ru-ru/library/windows/desktop/ms724892.aspx)调用来完成，您必须[自己](https://stackoverflow.com/questions/19888347/how-to-tell-which-value-triggered-regnotifychangekeyvalue)监控旧值和新值。[这](http://www.pinvoke.net/default.aspx/advapi32.regnotifychangekeyvalue)是代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T00:37:33.977

[这看起来是个不错的起点](http://www.codeproject.com/KB/system/WMI_RegistryMonitor.aspx)。[注册表](http://msdn.microsoft.com/en-us/library/aa394573(VS.85).aspx)有一个[WMI](http://msdn.microsoft.com/en-us/library/aa393964(VS.85).aspx)类。

# python - 在 Mac OS X 上安装 pyscopg2 时出现问题

> ID：846383
> 
> 赞同：3
> 
> 时间：2009-05-11T00:41:23.643
> 
> 标签：python, database, django, macos

我已经下载了 pyscopg2 的最新版本，并尝试使用提供的说明来构建和安装它。但是我总是得到一个错误，说'w'未声明。有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T00:55:08.970

这是在构建工具找不到您的 Postgresql 库时出现的错误。它意味着以下三件事之一：

1.  您的系统上没有安装 postgresql。如果是这样，请下载并构建 postgres，或为 OS X 下载预构建的 psycopg2 二进制文件。

2.  您的系统上安装了 postgresql，但您是从二进制包安装的，因此没有 psycopg2 所需的必要库。在这种情况下，请下载并构建 postgres。

3.  但是，更常见的是，这意味着您已经在系统上构建了 postgres，并且只需要指示 psycopg2 如何找到`pg_config`二进制文件以便它可以配置编译。任何一个：

    一种。将 pg_config 的路径放在你的 shell 路径中（`/usr/local/pgsql/bin/`如果你使用默认值从源代码构建 postgres，通常是在。

    湾。或者，编辑`setup.cfg`psycopg2 源文件夹中的文件，并在`pg_config`以`pg_config=`. 请务必通过删除前面的井号来取消注释此行。如果您使用默认值构建 postgres，则该行将类似于：

    `pg_config=/usr/local/pgsql/bin/pg_config`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-15T05:03:02.067

在雪豹上使用 MacPorts

```
pg_config=/opt/local/lib/postgresql90/bin/pg_config 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-04T18:00:36.033

我只需要在 virtualenv 中安装 psycopg2 库而不将其添加到根 python，而且我不想在本地机器上完全安装 postgreSQL，所以我想出了这个似乎工作得很好的解决方案。

1.  [从这里](http://postgresapp.com)下载 postgres.app ，然后将应用程序放到 Applications 文件夹中。

2.  在 shell 中，将 postgres.app bin 目录添加到 PATH：

> 导出 PATH=$PATH:/Applications/Postgres.app/Contents/Versions/9.3/bin

3.  激活虚拟环境：

> . myvenv/bin/激活

4.  点安装 psycopg2

我尝试设置 pg_config 变量，但没有奏效。pip install 明确告诉我，我必须将 pg_config 所在的目录放在路径中。

我也有点喜欢这个解决方案，因为如果我想在本地运行 PostgreSQL，我可以轻松地启动应用程序，然后在我完成后关闭它，它就消失了——没有任何东西在后台运行。没有系统配置更改或任何东西。这是运行 PostgreSQL 进行本地开发或快速演示的好方法。

# html - 如何将类分配给列

> ID：846384
> 
> 赞同：2
> 
> 时间：2009-05-11T00:43:32.280
> 
> 标签：html, css

我有 100 行，但我不想单独分配 abc1、abc2、abc3、abc4 类......

是否可以根据列号自动将类分配给 TD，即 Column1 -- abc1 Column2 -- abc2 ..etc

```
<Table>
 <tr class="odd">
   <td class="abc1"> ...</td>
   <td class="abc2"> ...</td>
   <td class="abc3"> ...</td>
   <td class="abc4"> ...</td>
 </tr>

<tr class="even">
   <td class="abc1"> ...</td>
   <td class="abc2"> ...</td>
   <td class="abc3"> ...</td>
   <td class="abc4"> ...</td>
 </tr>

<tr class="odd">
   <td class="abc1"> ...</td>
   <td class="abc2"> ...</td>
   <td class="abc3"> ...</td>
   <td class="abc4"> ...</td>
 </tr>

</table> 
```

任何帮助表示赞赏。

嗯...感谢所有的答案伙计们.. 看起来没有办法通过 CSS 做到这一点。是的，我只是将它添加到服务器 html.. 但我只是在寻找是否可以避免这种情况。

我不想用 javascript 来做这件事。谢谢你们的回答！！！！！！！！！

感谢你的帮助。

谢谢，本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T06:51:07.190

`<colgroup>`在 HTML 和 CSS 中使用and`<col>`标签实际上支持列：请参阅[http://htmldog.com/guides/htmladvanced/tables/](http://htmldog.com/guides/htmladvanced/tables/)
在表格的开头添加：

```
<table>
  <colgroup>
    <col class="class1" />
    <col class="class2" />
    <col class="class3" />
    <col class="class4" />
  </colgroup>
  ...
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T00:47:56.173

您可以使用 Javascript 或[jQuery](http://jquery.com/)之类的框架来做到这一点，但是，我自己已经走上了这条路，我不会。原因是速度：我正在使用 jQuery 进行奇偶行样式设置，加载页面需要 100-500 毫秒（介于这和其他一些事情之间）。对于可以在服务器上完成的事情来说，这是（恕我直言）不可接受的长。

如果你准备好接受它，那就去吧。CSS 有一个 :nth-child(n) 选择器，但 IE6 不支持。就我个人而言，我会将这些类生成为服务器端 HTML 的一部分。

使用 jQuery，您可以这样做：

```
<script type="text/javascript">
$(function() {
  $("table tbody tr :first-child").addClass("abc1");
  $("table tbody tr :nth-child(2)").addClass("abc2");
  // etc
});
</script> 
```

jQuery 的优点是它使用 CSS2.1 和一些 CSS3 和自定义选择器，但它不关心浏览器支持什么，因为它支持浏览器不支持的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T00:47:43.040

如果您想要一个跨浏览器解决方案，则不是，但如果对 Internet Explorer 的支持不是问题，那么您可以使用 :nth-child 规则。见[这里](http://reference.sitepoint.com/css/pseudoclass-nthchild)和[这里](http://www.w3.org/Style/Examples/007/evenodd)。您也可以使用[jQuery](http://jquery.com/)等 JavaScript 库来实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T00:48:39.950

有 col 和 colgroup xhtml 标签。
了解他们。

此外，还有：

```
#your-table tr td:first-child     //will target first td
#your-table tr td:first-child+td //will target the all the second td
#your-table tr td:first-child+td+td //will target the all the thired td 
```

你明白了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T00:53:49.863

是的 - 如果您使用的是 PHP 或 ASP.NET 等服务器端语言。这是 PHP 中的解决方案，假设正好有 100 列：

```
for( $i=0; $i < 100; $i++ )
{
    echo "<td class=\"abc$i\">your content here.</td>";
} 
```

由于 PHP 将解析字符串并插入 PHP 变量的字面值，因此此循环的每次迭代都会将您的类增加 $i 的值，即 abc0、abc1、abc2 等。

这将完成你想要的。然而，我意识到我不知道你在建造什么，但我质疑需要 100 列的设计决策，每个列的样式都必须不同。我很想看看你的最终实现。

KN

# .net - 如何让 DateTimePicker 显示一个空字符串？

> ID：846395
> 
> 赞同：71
> 
> 时间：2009-05-11T00:49:24.580
> 
> 标签：.net, winforms, datetimepicker

我希望能够显示`DateTimePicker`一个默认值为空的，即没有日期。

例如，我有一个任务的开始日期`dtTaskStart`和结束日期`dtTaskEnd`，但结束日期未知，并且最初没有填充。

我`yyyy-MM-dd`为这两个控件指定了自定义格式。

在运行时将值设置为`null`或空字符串会导致错误，那么我该如何完成呢？

我考虑过使用复选框来控制该字段的启用，但仍然存在显示初始值的问题。

*编辑：可以说是问题*[DateTimePicker Null Value (.NET)](https://stackoverflow.com/questions/284364/datetimepicker-null-value-net)
的副本，但我为我的问题找到的解决方案不是该问题的解决方案，所以我认为它应该留在这里供其他人查找..

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2011-12-09T16:23:47.560

只需将属性设置如下：

当用户按下“清除按钮”或“删除键”时

```
dtpData.CustomFormat = " "  'An empty SPACE
dtpData.Format = DateTimePickerFormat.Custom 
```

在`DateTimePicker1_ValueChanged`事件做

```
dtpData.CustomFormat = "dd/MM/yyyy hh:mm:ss" 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-11T01:09:26.373

通过使用属性混淆值`CustomFormat`，使用复选框`cbEnableEndDate`作为标志来指示其他代码是否应该忽略该值：

```
If dateTaskEnd > Date.FromOADate(0) Then
    dtTaskEnd.Format = DateTimePickerFormat.Custom
    dtTaskEnd.CustomFormat = "yyyy-MM-dd"
    dtTaskEnd.Value = dateTaskEnd 
    dtTaskEnd.Enabled = True
    cbEnableEndDate.Checked = True
Else
    dtTaskEnd.Format = DateTimePickerFormat.Custom
    dtTaskEnd.CustomFormat = " "
    dtTaskEnd.Value = Date.FromOADate(0)
    dtTaskEnd.Enabled = False
    cbEnableEndDate.Checked = False
End If 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-06-18T14:48:40.277

这对我来说适用于 c#

```
if (enableEndDateCheckBox.Checked == true)
{
    endDateDateTimePicker.Enabled = true;
    endDateDateTimePicker.Format = DateTimePickerFormat.Short;                
}
else
{
    endDateDateTimePicker.Enabled = false;
    endDateDateTimePicker.Format = DateTimePickerFormat.Custom;
    endDateDateTimePicker.CustomFormat = " ";
} 
```

不错的一个家伙！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-05T19:01:08.840

如果有人在表单加载事件期间将 datetimepicker 控件设置为空白，然后根据需要显示当前日期，这里是一个示例：

确保`CustomFormat = " "`在两种方法中具有相同数量的空格（至少一个空格）

```
Private Sub setDateTimePickerBlank(ByVal dateTimePicker As DateTimePicker)    

    dateTimePicker.Visible = True
    dateTimePicker.Format = DateTimePickerFormat.Custom
    dateTimePicker.CustomFormat = "    " 
End Sub

Private Sub dateTimePicker_MouseHover(ByVal sender As Object, ByVal e As 
                    System.EventArgs) Handles dateTimePicker.MouseHover

    Dim dateTimePicker As DateTimePicker = CType(sender, DateTimePicker)
    If dateTimePicker.Text = "    " Then
        dateTimePicker.Text = Format(DateTime.Now, "MM/dd/yyyy")
    End If
End Sub 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-09T01:41:38.203

当我想显示一个空的日期值时，我会这样做

```
 if (sStrDate != "")
            {
                dateCreated.Value = DateTime.Parse(sStrDate);
            }
            else
            {
                dateCreated.CustomFormat = " ";
                dateCreated.Format = DateTimePickerFormat.Custom;
            } 
```

然后当用户点击控件时，我有这个：

```
 private void dateControl_MouseDown(object sender, MouseEventArgs e)
            {
                ((DateTimePicker)sender).Format = DateTimePickerFormat.Long;    
            } 
```

这允许您显示和使用一个空的日期值，但仍然允许用户能够在他们希望的时候将日期更改为某个值。

请记住，sStrDate 已被验证为有效的日期字符串。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-05-16T16:48:13.963

基本概念与其他人所说的相同。但是当您有多个 dateTimePicker 时，这种方式更容易实现。

```
dateTimePicker1.Value = DateTime.Now;
dateTimePicker1.ValueChanged += new System.EventHandler(this.Dtp_ValueChanged);
dateTimePicker1.ShowCheckBox=true;
dateTimePicker1.Checked=false;

dateTimePicker2.Value = DateTime.Now;
dateTimePicker2.ValueChanged += new System.EventHandler(this.Dtp_ValueChanged);
dateTimePicker2.ShowCheckBox=true;
dateTimePicker2.Checked=false; 
```

值改变事件函数

```
 void Dtp_ValueChanged(object sender, EventArgs e)
        {
            if(((DateTimePicker)sender).ShowCheckBox==true)
            {
                if(((DateTimePicker)sender).Checked==false)
                {
                    ((DateTimePicker)sender).CustomFormat = " ";
                    ((DateTimePicker)sender).Format = DateTimePickerFormat.Custom;
                }
                else
                {
                    ((DateTimePicker)sender).Format = DateTimePickerFormat.Short;
                }
            }
            else
            {
                ((DateTimePicker)sender).Format = DateTimePickerFormat.Short;
            }
        } 
```

未选中时 [![在此处输入图像描述](https://i.stack.imgur.com/9VkxR.png)](https://i.stack.imgur.com/9VkxR.png)

检查时 [![在此处输入图像描述](https://i.stack.imgur.com/W9QGw.png)](https://i.stack.imgur.com/W9QGw.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-04-21T08:31:18.640

听，如果要显示空的 datetimepicker 并在用户未选择日期时获取 null ，请在代码中进行以下更改，否则保存日期。

1.  将 datetimepicker **FORMAT**属性设置为自定义。
2.  将**CUSTOM FORMAT**属性设置为空字符串“”。
3.  默认将其**TAG**设置为 0。
4.  **为 datetimepicker VALUECHANGED注册事件**。

## 现在开始真正的工作

如果用户将与 datetimepicker 交互，则将调用其**VALUECHANGED**事件并将其 TAG 属性设置为 1。

## 最后一步

现在保存时，检查其**TAG**是否为零，然后保存 NULL 日期，否则如果**TAG**为 1，则选择并保存日期时间选择器值。

它就像一个魅力。

现在，如果您希望通过用户交互将其值更改回空，请添加复选框并使用此复选框显示文本“清除”。如果用户想清除日期，只需再次将其**CUSTOM FORMAT**属性设置为空字符串“”，并将其**TAG**设置回 0。就是这样..

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-25T12:25:33.843

最好使用文本框来调用/显示日期，同时保存使用 DateTimePicker。根据要求使可见属性为真或假。

例如：在表单加载期间，在文本框中加载日期并使 DTPIcker 不可见，反之亦然

# wpf - 如何更改 WPF 框架中导航栏上的属性？

> ID：846398
> 
> 赞同：3
> 
> 时间：2009-05-11T00:52:01.707
> 
> 标签：wpf

我正在开发基于页面的 WPF 应用程序，我想更改框架中导航栏的大小。我设置 NavigationUIVisibility="Visible" 以查看导航栏，现在如何更改导航栏上的属性，如它的大小？

谢谢，
罗伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-12T21:56:31.660

导航栏很难更改。我建议你创建你自己的。
创建您自己的按钮，然后使用

```
myFrame.NavigationService.GoBack()
myFrame.NavigationService.GoForward() 
```

例子：

```
Private Sub PreviousPageCommand_Executed(ByVal sender As Object, _
                                     ByVal e As ExecutedRoutedEventArgs)
    MainFrame.NavigationService.GoBack()
End Sub

Private Sub PreviousPageCommand_CanExecute(ByVal sender As Object, _
                            ByVal e As CanExecuteRoutedEventArgs)
    If Not MainFrame Is Nothing Then
        e.CanExecute = MainFrame.NavigationService.CanGoBack
    Else
        e.CanExecute = False
    End If
End Sub

Private Sub NextPageCommand_Executed(ByVal sender As Object, _
                                     ByVal e As ExecutedRoutedEventArgs)
    MainFrame.NavigationService.GoForward()
End Sub

Private Sub NextPageCommand_CanExecute(ByVal sender As Object, _
                                    ByVal e As CanExecuteRoutedEventArgs)
    If Not MainFrame Is Nothing Then
        e.CanExecute = MainFrame.NavigationService.CanGoForward
    Else
        e.CanExecute = False
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T07:01:18.010

有一种方法可以操作默认样式菜单

[样本](http://msdn.microsoft.com/en-gb/library/ms771597%28v=vs.85%29.aspx)

上面链接了一个示例项目，您不仅可以看到导航菜单，还可以看到其他控件。

您基本上创建了一个样式资源来替换默认值。他们给你的例子是一个很好的开始。然后，您可以调整资源以获得您想要的外观。

# security - 中间人攻击 - 如果使用对称密钥，会发生这种攻击吗？

> ID：846402
> 
> 赞同：6
> 
> 时间：2009-05-11T00:55:02.387
> 
> 标签：security, cryptography, man-in-the-middle

如果我们考虑中间人攻击；如果使用对称密钥会发生这种攻击吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T00:59:47.653

当然。您需要做的就是拦截密钥交换。然后，您可以将自己的（假）密钥传递到另一端。您使用您以欺诈方式获得的密钥拦截消息，并使用您的假密钥重新加密并传递到另一端。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-11T01:01:12.363

诀窍是首先就对称密钥达成一致。中间人攻击通常发生在密钥交换阶段（使您与中间人而不是您的真实合作伙伴就密钥达成一致）。

所以通常发生的事情（在 Web 浏览器的 SSL 会话中）是您使用非对称加密来交换对称密钥。但是，这取决于您的合作伙伴的公钥是否真正属于您认为的人。通常，您会使用 Verisign 或（其他一些 CA）的说法。

在某些时候，必须进行安全且经过身份验证的密钥交换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T01:24:38.907

由于 MIM 攻击可能发生在密钥交换期间，因此您可以执行 SSL/TLS 所做的事情。

SSL/TLS 在密钥交换中使用 RSA，因此对称密钥的交换受到 RSA 的 [高度] 保护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T01:25:30.527

上面的答案当然是正确的，但您应该注意，有几种有效的、加密安全的方法可以[安全地](https://www.rfc-editor.org/rfc/rfc4306) [交换](http://en.wikipedia.org/wiki/Diffie-Hellman_key_exchange) [密钥](http://www.ietf.org/rfc/rfc4432.txt)。我认为 wow 使用的是[SRP6](http://srp.stanford.edu/design.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T08:39:39.463

是的。即使您使用对称密钥，您也必须使用身份验证/完整性检查。在没有身份验证/完整性检查的情况下使用对称密钥加密会使您容易受到各种形式的重放攻击或替代攻击。攻击者可以修改您的密文，甚至可能知道他的更改的效果是什么。

# java - 将 Tomcat 5.5 配置为 UTF-8 编码所有 sendRedirect() 重定向？

> ID：846409
> 
> 赞同：2
> 
> 时间：2009-05-11T01:00:17.510
> 
> 标签：java, web-applications, servlets, utf-8, url-encoding

我们正在构建的产品的一个要求是它的 URL 端点在用户的母语中具有语义意义。这意味着我们需要 UTF-8 编码的 URL 来支持所有的字母表。

我们也不希望必须为我们支持的每个应用程序服务器和版本提供安装配置文档，所以如果我们能在代码中完成这个就很好了。这可能是不可能的，因为当 Servlet 收到请求时，它已经被 App 服务器编码，等等。

通过重构请求的路径信息，我已经得到了这个工作（对于我第一个使用 ISO-Latin 非美国 ASCII 字符的用例）：

```
String pathInfoEncoded = new String(httpServletRequest.getPathInfo().getBytes(), "UTF-8"); 
```

然后解析它。

但是，在使用 sendRedirect() 从 POST 重定向到 GET 后，这不起作用。请求的路径已经转义（所以 ö 被编码为 %F6）并且我上面的方法不起作用。

所以我想我的问题是我做错了吗？如果是这样，我的无知的解药是什么？:)

更新：找到解决方案。问题是 Servlet API 在发送重定向之前在 URL 编码方面有一些奇怪的行为。在调用 sendRedirect() 之前，您必须进行 URL 编码（转义 UTF-8 字符）。encodeRedirectURL() 方法不适合你。

本页讨论它： http: [//www.whirlycott.com/phil/2005/05/11/building-j2ee-web-applications-with-utf-8-support/](http://www.whirlycott.com/phil/2005/05/11/building-j2ee-web-applications-with-utf-8-support/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T08:12:36.510

需要调查和试验的几件事：

*   查看您的 ./conf/server.xml 文件并确保连接器的 URIEncoding 属性设置为“UTF-8”。

例如：

```
<Connector port="8080" 
           protocol="HTTP/1.1" 
           URIEncoding="UTF-8"/> 
```

*   使用某种基于浏览器的工具（例如：[TamperData](https://addons.mozilla.org/en-US/firefox/addon/966) for FireFox）来查看您的浏览器正在向服务器发送什么——它很可能会为您转义它。如果是这种情况，您可以在服务器上使用[URL.decode()它。](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLDecoder.html)
*   手动设置标头和响应代码，而不是使用 Response.redirect()。

例如：

```
response.setHeader("Location", myUtf8unencodedUrl);
response.setStatus(response.SC_MOVED_TEMPORARILY); 
```

没有承诺，但如果是我，这就是我会尝试的。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T23:46:30.507

找到了解决方案。问题是 Servlet API 在发送重定向之前在 URL 编码方面有一些奇怪的行为。在调用 sendRedirect() 之前，您必须进行 URL 编码（转义 UTF-8 字符）。encodeRedirectURL() 方法不适合你。

本页讨论它： http: [//www.whirlycott.com/phil/2005/05/11/building-j2ee-web-applications-with-utf-8-support/](http://www.whirlycott.com/phil/2005/05/11/building-j2ee-web-applications-with-utf-8-support/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-17T13:39:31.530

我们在这里遇到了同样的情况，即我们的产品也需要以地球上可能的每种语言向用户显示有意义的 URL。我们所有的工具和技术都支持 UTF-8，所以这没有问题。转义 UTF-8 字符在技术上是可行的，但 IE (7, 8) 显示难看的转义 URL，而 Firefox 取消转义并显示漂亮的 url，即 '/français/Banane.html' 将在 IE 中显示为 '/fran% C3%A7ais/Banane.html'。POST 后的 GET / 表单提交后的重定向根本不起作用，既不发送 UTF-8 url，也不转义 UTF-8 url。我们还尝试使用 XML 样式的数字实体编码，但没有成功。

然而，我们终于找到了一种在 POST 之后成功重定向的方法：使用 ISO-8859-1 对 UTF-8 字符串进行字节编码。无论如何，我们都没有真正理解它是如何工作的（浏览器如何知道如何解码，因为每个 utf-8 字符的字节数可能会有所不同，浏览器如何知道它最初是 utf-8？），但是确实如此。

这是一个简单的 servlet 来尝试：

```
 package springapp.web.servlet;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.io.IOUtils;

public class TestServlet extends HttpServlet {

 private static final long serialVersionUID = -1743198460341004958L;

 /* (non-Javadoc)
  * @see javax.servlet.http.HttpServlet#doGet(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)
  */
 @Override
 protected void doGet(HttpServletRequest req, HttpServletResponse resp)
   throws ServletException, IOException {

  String url = "çöffte.html"; 
  try {
         ServletContext context = req.getSession().getServletContext();
   // read utf8 encoded russian url
            if (context.getResource("/WEB-INF/ru_url.txt") != null){
             InputStream is = context.getResourceAsStream("/WEB-INF/ru_url.txt"); 
             if (is != null){
              url = IOUtils.toString(is, "UTF-8");
              System.out.println(String.format("Redirecting to [%s]", url));
             }
            }
        }
        catch (FileNotFoundException fNFEx) {
         fNFEx.printStackTrace();
        }
        catch (IOException ioEx) {
         ioEx.printStackTrace();
        }

        byte[] utfBytes = url.getBytes("UTF-8");
        String result = new String(utfBytes, "ISO-8859-1");
        resp.sendRedirect(result);

        // does not work:
        //resp.sendRedirect(url);
        //resp.sendRedirect(Utf8UrlEscaper.escapeUtf8(url));
        //resp.sendRedirect(Utf8UrlEscaper.escapeToNumericEntity(url));
 }
} 
```

对于重定向目标，复制并粘贴任何本地语言 url，例如来自 wikipedia 的 utf-8 编码（没有 BOM！）文件，并将其保存在 WEB-INF 目录中。在我们的示例中，我们采用了一个俄语 url ( [http://ru.wikipedia.org/wiki/Заглавная_страница](http://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0) ) 并将其保存在一个名为 'ru_url.txt' 的文件中。

我们创建了一个简单的 SpringMVC 应用程序，将任何 *.abc url 映射到测试 servlet。现在，如果您启动应用程序并输入“localhost:8080/springmvctest/a.abc”之类的内容，您应该被重定向到俄罗斯维基百科站点，并且浏览器（IE 和 Firefox、Safari 或其他可能不会）应该显示一个不错的 utf- 8 位编码的原生俄罗斯网址。

# php - 在 PHP 中迭代 MASSIVE CSV 文件的最佳实践

> ID：846415
> 
> 赞同：7
> 
> 时间：2009-05-11T01:06:47.750
> 
> 标签：php, csv

好的，我会尽量保持简短、甜蜜和中肯。

我们通过将 MASSIVE CSV 文件上传到我们基于 PHP 的 CMS 来对我们的系统进行大规模的 GeoIP 更新。这个东西通常有超过 100k 的 IP 地址信息记录。现在，对这些数据进行简单的导入根本不是问题，但我们必须对我们当前的区域 IP 地址映射进行检查。

这意味着我们必须验证数据，比较和拆分重叠的 IP 地址等。并且必须对每条记录进行这些检查。

不仅如此，我刚刚创建了一个字段映射解决方案，它允许其他供应商以不同的格式实施他们的 GeoIP 更新。这是通过将规则应用于 CSV 更新中的 IP 记录来完成的。

例如，一条规则可能如下所示：

如果 'countryName' == 'Australia' 然后发送到 'Australian IP Pool'

可能需要运行多个规则，并且每个 IP 记录都必须全部应用它们。例如，针对 10 条规则检查 10 万条记录将是 100 万次迭代；不好玩。

我们发现 10 万条记录的 2 条规则最多需要 10 分钟来处理。我完全意识到这里的瓶颈是成功导入必须发生的迭代的剪切量；只是不完全了解我们可能需要加快速度的任何其他选项。

有人建议将文件分成服务器端的块。我不认为这是一个可行的解决方案，因为它为已经很复杂的系统增加了另一层复杂性。该文件必须被打开、解析和拆分。然后脚本也必须遍历这些块。

所以，问题是，考虑到我刚刚写的内容，最好的方法是加快这个过程吗？不幸的是，仅针对此工具升级服务器硬件不是一种选择，但它们从一开始就是相当高端的盒子。

没有我想象的那么短，但是。哈普斯？:(

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-11T01:13:51.123

对数据库执行 BULK IMPORT（我使用的是 SQL Server）。BULK IMPORT 从字面上看只需要几秒钟，而 100,000 条记录对于数据库处理业务规则来说是微不足道的。我经常在一个超过 400 万行的表上执行类似的数据处理，而且不需要您列出的 10 分钟。

编辑：我应该指出，是的，我不为此推荐 PHP。您正在处理原始数据，请使用数据库 .. ：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T02:32:05.770

做到这一点的简单关键是尽可能多地避免内部循环的工作。

简单地说，你在内部循环中所做的任何事情都会“做 100K 次”，所以什么都不做是最好的（但肯定不切实际），所以尽可能少做是下一个最好的选择。

例如，如果您有内存，并且它对应用程序很实用，请将任何“输出”推迟到主处理之后。如果可行，也可以缓存任何输入数据。这最适用于汇总数据或临时数据。

理想情况下，除了读取 CSV 文件外，在主处理期间尽可能少地执行 I/O。

PHP 是否提供对 Unix mmap 设施的任何访问权限，这通常是读取文件（尤其是大文件）的最快方式。

另一个考虑因素是批量插入。例如，可以直接将 INSERT 语句构建为简单字符串，然后将它们以 10、50 或 100 行的块的形式发送到服务器。大多数数据库对 SQL 语句的大小都有一些硬性限制（如 64K 或其他），因此您需要牢记这一点。这将大大减少您到数据库的往返次数。

如果您通过简单的增量创建主键，请大量执行（1000、10000 等块）。这是您可以从内部循环中删除的另一件事。

而且，当然，您应该为每一行一次处理所有规则，而不是为每条规则运行记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T14:25:54.213

10 万条记录并不是一个很大的数字。10 分钟对于单个线程来说并不是一个糟糕的工作处理时间。无论您使用的是 PHP 还是 C，直线完成的原始工作量可能约为 10 分钟。如果您希望它更快，您将需要一个比 while 循环更复杂的解决方案.

以下是我将如何处理它：

1.  使用 map/reduce 解决方案并行运行该过程。Hadoop 可能是矫枉过正。Pig Latin 可以胜任这项工作。你真的只想要 map/reduce 问题的 map 部分。IE：您正在分叉要由子进程处理的文件块。您的减速机可能是`cat`. 一个简单的版本可能是为每个 10K 记录块设置 PHP fork 进程，等待子进程，然后重新组装它们的输出。
2.  使用队列/网格处理模型。将文件的大块排队，然后让一组机器签入、抓取作业并将数据发送到某处。这与 map/reduce 模型非常相似，只是使用了不同的技术，而且您可以通过向网格中添加更多机器来进行扩展。
3.  如果您可以将逻辑编写为 SQL，请在数据库中执行。我会避免这种情况，因为大多数 web 程序员不能在这个级别上使用 SQL。此外，SQL 在执行 RBL 检查或 ARIN 查找之类的操作方面受到限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T02:07:27.357

您可以尝试的一件事是在命令行 PHP 下运行 CSV 导入。它通常提供更快的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T03:22:55.703

如果您使用 PHP 来完成这项工作，请将解析切换到 Python，因为它在这方面比 PHP 快得多，这种交换应该可以将处理速度提高 75% 甚至更多。

如果您使用的是 MySQL，您也可以使用 LOAD DATA INFILE 运算符，但我不确定您是否需要在将数据插入数据库之前检查数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T03:46:15.620

一段时间以来一直在集中研究这个问题。而且，是的，更好的解决方案是在任何时候只读取文件的一部分，解析它，进行验证，进行过滤，然后导出它，然后读取文件的下一部分。我同意这可能不是 php 的解决方案，尽管您可能可以在 php.ini 中做到这一点。只要你有一个seek函数，这样你就可以从文件中的特定位置开始读取。你是对的，它确实增加了更高级别的复杂性，但值得付出一点额外的努力。如果您的数据是纯的，即正确分隔、字符串限定、没有断线等，然后通过各种方式批量上传到 sql 数据库中。否则，您想知道错误发生的地点、时间和原因，并能够处理它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-16T11:51:26.963

我正在做类似的事情。

我正在工作的 csv 文件包含我必须将其转换为 mysql yyyy-mm-dd 的葡萄牙语数据 (dd/mm/yyyy)。葡萄牙货币：R$ 1.000,15 必须转换为 mysql 十进制 1000,15。修剪可能的空格，最后加上斜线。

在插入之前有 25 个变量需要处理。

如果我检查每个 $notafiscal 值（选择表以查看是否存在和更新），php 处理大约 60k 行。但如果我不检查它，php 处理超过 100 万行。

服务器使用 4GB 内存 - 脚本 localhosting（2GB 内存），它在两种情况下都处理半行。

```
mysqli_query($db,"SET AUTOCOMMIT=0");
mysqli_query($db, "BEGIN");
mysqli_query($db, "SET FOREIGN_KEY_CHECKS = 0");
fgets($handle); //ignore the header line of csv file

while (($data = fgetcsv($handle, 100000, ';')) !== FALSE):
 //if $notafiscal lower than 1, ignore the record
 $notafiscal = $data[0];  
 if ($notafiscal < 1):
  continue;
 else:
  $serie = trim($data[1]); 
  $data_emissao = converteDataBR($data[2]);
  $cond_pagamento = trim(addslashes($data[3]));
  //...
  $valor_total = trim(moeda($data[24]));
  //check if the $notafiscal already exist, if so, update, else, insert into table
  $query = "SELECT * FROM venda WHERE notafiscal = ". $notafiscal ;
  $rs = mysqli_query($db, $query);
  if (mysqli_num_rows($rs) > 0):
    //UPDATE TABLE
  else:
    //INSERT INTO TABLE
  endif;
endwhile;

mysqli_query($db,"COMMIT");
mysqli_query($db,"SET AUTOCOMMIT=1");
mysqli_query($db,"SET FOREIGN_KEY_CHECKS = 1");
mysqli_close($db); 
```

# javascript - mouseover() mouseout() jQuery add/removeClass 问题

> ID：846417
> 
> 赞同：7
> 
> 时间：2009-05-11T01:10:13.237
> 
> 标签：javascript, jquery, css, rollover

我正在尝试使用 mouseover、mouseout、addClass 和 removeClass 的组合创建一个简单的鼠标悬停效果。基本上，当用户将鼠标悬停在一个元素上时，我想应用不同的边框（1px 灰色虚线）。初始状态是“1px 纯白”。我有一个名为“highlight”的类，其中只有“border: 1px dashed gray”。我想添加该类 onmouseover 并在 onmouseout 上删除它，但除非我在“highlight”类中使用 !important ，否则我无法获得我想要的效果。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-11T04:20:10.260

听起来好像您的 javascript 工作正常，但这只是[您的 CSS 规则的特殊性的](http://htmldog.com/guides/cssadvanced/specificity/)问题，这就是`!important`使它工作的原因。

您只需使突出显示的 CSS 规则比未突出显示的规则更具体。

```
#someItem ul li { /* Specificity = 102 */
    border-color: white;
}

.highlight { /* Specificity = 10 -- not specific enough! */
    border-color: grey;    
}

#someItem ul li.highlight { /* Specificity = 112 -- this will work */
    border-color: grey;    
} 
```

* * *

**编辑并进一步解释：**
假设您的 HTML 的相关部分如下所示：

```
<div id="someItem">
    <ul>
        <li>Item 1</li>
        <li>Item 2</li>
        <li>Item 3</li>
    </ul>
</div> 
```

你有这个CSS：

```
#someItem ul li {
    border: 1px solid white;
}
.highlight {
    border-color: grey;
} 
```

目前，in 中的所有列表项都`ul`将`#someItem div`具有白色边框，并且没有任何类`highlight`，所以没有任何东西是灰色的。

通过您想要的任何方式（在您的情况下，jQuery 中的悬停事件），您将一个类添加到其中一个项目：

```
$(this).addClass('highlight'); 
```

HTML 现在看起来像这样：

```
<div id="someItem">
    <ul>
        <li>Item 1</li>
        <li class="highlight">Item 2</li>
        <li>Item 3</li>
    </ul>
</div> 
```

到目前为止，您的 Javascript 和 HTML 工作正常，但您看不到灰色边框！问题是你的 CSS。当浏览器试图决定如何为元素设置样式时，它会查看所有以元素为目标的不同选择器以及在这些选择器中定义的样式。如果有两个不同的选择器都定义了相同的样式（在我们的例子中，边框颜色是有争议的），那么它必须决定应用哪个样式以及忽略哪个样式。它通过所谓的“特异性”来做到这一点 - 即选择器的具体程度。正如[HTML Dog 文章](http://htmldog.com/guides/cssadvanced/specificity/)中所述，它通过为选择器的每个部分分配一个值来实现这一点，得分最高的部分获胜。要点是：

*   元素选择器（例如：“ul”、“li”、“table”）= 1 分
*   类选择器（例如：“.highlight”、“.active”、“.menu”）= 10 分
*   id 选择器（例如：“#someItem”、“#mainContent”）= 100 分

还有更多规则，例如：关键字`!important`和内联样式，但这与此无关，呃……“课程”。您应该知道的唯一另一件事是，如果两个选择器具有相同的特异性，则文件中稍后定义的选择器获胜。

回到你的问题，鉴于我们之前的 CSS，我们可以看到为什么它仍然没有灰色边框：

```
#someItem ul li = id + element + element = 100 + 1 + 1 = 102 分
.highlight = 班级 = 10 分

```

如前所述，解决方案是创建一个更具体的选择器：

```
#someItem ul li.highlight
   = id + 元素 + 元素 + 类
   = 100 + 1 + 1 + 10
   = 112 分

```

要在评论中回答您的问题，您无需更改任何 javascript 或 HTML 即可。如果你分解那个选择器，它的意思是：

> 查找 id 为“someItem”的元素，在其中查找 ul 元素，然后查找具有类“highlight”的 li 元素。

...现在，鉴于`.addClass()`您之前所做的简单调用，`li`满足这些条件，所以边框应该变成灰色。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T03:36:58.410

从 Jquery 1.3.3 开始，您将能够更简单地执行此操作。将会有一个[增强版的 .toggleClass()](http://brandonaaron.net/blog/2009/05/6/jquery-edge-enhanced-toggleclass)可用，它会非常强大。

如果您不需要将其分解为一个函数，那么从 1.3.3 开始，您将能够简单地执行以下操作：

```
$(".myclass").hover(function(){ $(this).toggleClass('highlight'); }); 
```

如果您必须包含 !important ，那么您的高亮类可能需要更具体（请参阅[CSS Specificity](http://htmldog.com/guides/cssadvanced/specificity/)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T01:16:03.150

我猜你在元素上使用内联样式作为初始样式：

```
<style type="text/css">
  .hover { border: 1px dashed gray; } /* will never apply */
</style>

...

<!-- this style has priority over class styles! -->
<div style="border: 1px solid white"> 
...
</div> 
```

这将覆盖使用类应用的样式......因此，不要使用内联样式，只需使用不同的初始类来应用初始样式：

```
<style type="text/css">
  .normal { border: 1px solid white; }
  .hover { border: 1px dashed gray; }
</style>

...

<div class="normal">
...
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T02:21:33.947

CSS：

```
div.target {
    border: 1px solid #000000;
}

div.target-hover {
    border-color: #ff0000;
} 
```

JS：

```
$("div.target").hover(
    function () {
        $(this).addClass("target-hover");
    },
    function () {
        $(this).removeClass("target-hover");
    }
); 
```

我通常这样做。（允许更多选择）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T01:16:44.350

您是否考虑过纯 css 方法？

例如：

```
someClass {
    border: 1px solid white;
}

someClass:hover {
    border: 1px dashed gray;
} 
```

伪类将为您提供您想要的`hover`行为：当用户将鼠标悬停在元素上时，它将使用较低的样式，否则将使用第一个样式。

注意：正如有人评论的那样，这不适用于`a`IE 中的非元素。然而，它在 Chrome、Firefox、Safari 和 Opera 中对我有用。

它也适用于 IE8 和 IE7 标准模式下的任何元素。我没有IE6可以测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-30T04:54:30.167

或者您可以使用简单的 CSS 来完成它：

```
#namehere { border: 1px solid #fff; }
#namehere:hover { border: 1px dashed #aaa } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T01:22:02.827

这是我使用过的悬停示例：

```
$(".myclass").hover(jbhovershow,jbhoverhide);

jbhovershow = function () {
            $(this).addClass("jimtest");
          }; 

jbhoverhide = function () {
            $(this).removeClass("jimtest");
          } 
```

您实际上不必将这么简单的东西分解成单独的功能。

我怀疑您的问题可能与 css 中的冲突有关 - 尝试通过硬编码来应用您的突出显示类，或者单击一下，看看它是否真的有效。

希望有帮助

吉姆

# python - Apache HTTP Server 2.2 和 Python 2.6 或 3.0 是否有 mod_python？

> ID：846420
> 
> 赞同：2
> 
> 时间：2009-05-11T01:12:37.587
> 
> 标签：python, apache2, mod-python

我浏览了[mod_python 网站](http://www.modpython.org/)，只找到了适用于 Python 2.5 和更早版本的 Apache HTTP Server 2.2 的文件。我用谷歌搜索了一下，没有很大的运气。有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-11T01:17:51.710

使用 mod_wsgi。

mod_python 已经停滞了一段时间了。python web 应用程序的大部分工作都在 mod_wsgi 上。

# c# - C# 中的循环命名空间

> ID：846434
> 
> 赞同：1
> 
> 时间：2009-05-11T01:18:50.400
> 
> 标签：c#

单个程序集中的循环命名空间依赖项是多么“邪恶”。我知道使用多个程序集会改变一切，并且类似的东西不会编译，但是在单个程序集中这样做的真正风险是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T01:21:38.193

完全没有风险 - 随意在同一个程序集中引用您想要的任何内容。

但是，这种方法会使您的应用程序变得脆弱且难以扩展。更好的方法是尽量保持组件正交。

语言和编译器允许您做的不一定是最适合长期开发需求（错误修复、扩展、新功能等）的事情。你应该争取[松耦合和高内聚](http://c2.com/cgi/wiki?CouplingAndCohesion)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T05:31:20.970

我认为这本身没有任何风险，在某些情况下，这当然是自然的做事方式。`System.Text.StringBuilder`显然使用，如果依次使用命名空间中的*任何内容*`System.String`，我会感到非常惊讶。*`System``StringBuilder`*

 *经常检查您的设计可能是值得的：质疑您是否*应该*能够将功能分离到单独的组件中。很多时候答案是“不”，在这一点上继续前进，没有内疚感:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T01:23:57.677

命名空间是一种为代码提供逻辑组织的方法。它们提供了一种通过在特定上下文中应用名称来重用名称的方法。让两个命名空间中的类相互依赖并没有错。

程序集中的循环依赖要复杂一些。最后我检查了视觉工作室不会直接允许这种类型的关系。

# c++ - C++ 问题...定义不能识别声明中指定的向量

> ID：846444
> 
> 赞同：0
> 
> 时间：2009-05-11T01:23:48.550
> 
> 标签：c++, include, compilation, vector

我正在做一个从小做起的课堂作业，所以我把它全部放在一个文件里。现在它变得更大了，我正在尝试分别编译 main、functions 和 classes（所以所有的类都在一个 .h 和一个 .cpp 中）我有一个类 B，它是很多其他类的父类，并且在文件中排在第一位。由于我正在使用单独的编译，它的一个数据成员现在无法正常工作，这会导致数十个错误。

在.h

```
class A;
class B {
public: 
    B (){}
    A* myptr;
    void whatever();
    vector<A*> myAs; //this one is the problem
}; 
```

在.cpp

```
void B::whatever() {
    vector<A*> newvector; //no problem!
    myptr = &something; //no problem!
    for (vector<A*>::iterator iter = myAs.begin(); iter != myAs.end(); ++iter) {
        //error!
    }
} 
```

我收到错误：“myAs 未在此范围内声明”或“B 类没有成员 myAs”。

正如你在上面看到的，我已经包含了<vector>，前向声明的类A，我绝对记得在.cpp 的顶部包含.h！关于向量或类以及我不理解的单独编译是否有一些东西？这是在 Xcode 中，顺便说一句。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T01:36:00.887

这不仅仅是`vector`。这是`std::vector`因为它位于名为`std`. 这就是编译器抱怨的原因。它不知道什么`vector<A*>`意思。不如说`std::vector<A*>`。

*因此*，不要现在添加`using namespace std;`到标题中。如果您愿意，可以将作业放入 .cpp 文件以节省输入。但是将这样一行放入标题中是一个非常糟糕的主意：因为您不知道将来哪些文件需要您的标题。随着包括标题在内的文件数量随着时间的推移而增长，这种情况很快就会失控。因此，标头应仅包含它真正需要的名称和标头，以便尽可能减少名称冲突 - 而该`using namespace std;`行将使所有名称`std`直接可见。

# c# - 同一个应用程序中的多进程支持？

> ID：846453
> 
> 赞同：3
> 
> 时间：2009-05-11T01:30:39.163
> 
> 标签：c#

Google Chrome 和 IE8 为每个选项卡实现多进程支持。我将如何使用 c# 和 vs2008 实现类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T01:38:17.527

嗯...查找[进程间通信](http://en.wikipedia.org/wiki/Inter-process_communication)。然后让您的进程相互通信（例如传递数据结构、命令等）。您可能还需要一个渲染进程和一个主进程（或将这两者组合成一个渲染/命令进程）。

# ruby-on-rails - 如何在 link/button_to_remote 调用中发送额外参数？

> ID：846454
> 
> 赞同：1
> 
> 时间：2009-05-11T01:32:46.727
> 
> 标签：ruby-on-rails, ajax, prototypejs

Prototype 的 Ajax 接受一个名为“parameters”的参数，该参数带有一个散列数组作为参数（[prototype doc](http://www.prototypejs.org/api/ajax/options)），它会自动作为 GET 或 POST vars 发送，但我找不到如何使用 Rails button_to_remote 方法向该数组添加项目。

我可以将参数添加到发送到该方法的 URL 中，但这感觉很糟糕。有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T14:58:38.967

我实际上找到了解决方案！您可以使用 :with 选项在函数中传递参数，如下所示：

```
<%=button_to_remote "+3", {:url =>task_path(@project, @story, task), :with=>"'actual=3'"}%> 
```

诀窍在于 :with 的值是一个 javascript 表达式，它应该以 URL 格式返回一个键值对，例如“key=value”。这就是为什么在上面相同的值周围有额外的引号。

如有必要，还可以使用函数从页面中提取信息：

```
:with=>"getValuesForPostbackFunction()" 
```

该函数将在提交表单之前进行评估。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T08:32:51.313

使用`button_to_remote`将参数发送到下一个操作的唯一方法是将它们放入 URI。

`button_to_remote`旨在作为 的功能等效项`link_to_remote`，它也没有其他添加参数的方式。

如果您需要更细粒度的控制，则需要构建完整的表单并将其提交给您的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T01:36:22.180

在您调用 button_to_remote 的表单中添加隐藏的输入字段。

```
<input type="hidden" name="name" value="myValue"> 
```

# iphone - iphone动画帧率和帧数

> ID：846458
> 
> 赞同：2
> 
> 时间：2009-05-11T01:36:43.863
> 
> 标签：iphone, animation

我正在开发一个客户想要为大图像 (305x332) 制作动画的应用程序。客户希望在 1.75 秒内循环播放 50 帧动画。我发现应用程序在处理这么多时非常慢。启动、触摸响应和关机都很慢。在 iPhone 本身上，该应用程序经常会崩溃或锁定手机。请参阅下面的代码。我的问题：

1.  我是在做一些导致性能不佳的事情，还是要求 50 帧太多？
2.  动画中的帧数和动画速度是否有最佳实践？
3.  动画中的图像大小是否有最佳实践？

请告诉我。这是代码...

```
NSMutableArray *tempArray = [[NSMutableArray alloc] init];
for(int i = 1; i <= 50; i++)
{

    [tempArray addObject:[UIImage imageNamed:[NSString stringWithFormat:@"%@-%d-%04d.JPG",[constitution getConstitutionWord], constitution.getAnimationEnum, i]]];  
}

backgroundImage.animationImages = tempArray;
[tempArray release];
backgroundImage.animationDuration = 1.75; // seconds 
backgroundImage.animationRepeatCount = 0; // 0 = loops forever 
[backgroundImage startAnimating]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T21:01:02.537

不久前我进行了一些测试。在 UIImageview 动画放弃和失败之前，设法将大约 20K PNG 的大约 40 帧最大化。

如果您需要更多，您可以切换到使用视频或编写自己的动画渲染引擎。渲染引擎非常简单。它会在一个计时器上运行，该计时器从队列的头部获取已经加载的 UIImage，更新视图然后释放图像。一个单独的线程在队列的尾端预先加载几个帧。这样，在任何给定时间，您的内存中最多有 N 帧。您可以对其进行调整，以在计时器延迟和为您的应用程序预加载的帧数之间找到最佳平衡。

我从事的一个项目使用该技术毫无问题地显示数百张大图像。

一些提示：

*   尽可能多地使用 CALayers。

*   显示每一帧时不要进行任何缩放。尝试使每个源图像都具有您想要显示的确切尺寸。

*   尽量不要用其他视图覆盖动画。它会让事情变慢。

*   您可以从捆绑包或通过扫描目录加载图像列表。bundle 的缺点是不更新整个应用程序就无法更新图像。从目录加载的缺点是，在第一次启动时，您必须将图像从包中复制到可写位置，并且您的应用程序在运行时会变大。主要好处是您可以通过网络更新该目录中的媒体。

*   声音同步变得有点冒险。您必须想出自己的方式来指定何时开始/停止声音。如果您有声音并且需要精确（如对口型），则使用视频路线可能更实用。

祝你好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T06:34:23.877

我认为这对 iPhone 来说有点过分了。根据我的 fag 数据包，解压缩后的图像占用大约 21Mb。这可能会导致您的应用程序仅通过内存使用而在手机上终止。将这么多数据转移到帧缓冲区也会导致电话问题。

我认为您需要使用更合适的动画技术。在 305*322 下约 30fps 对我来说听起来像是视频。视频以这样一种方式压缩，您不需要一次将所有解压缩的帧保存在内存中。可悲的是，如果您想在不将整个屏幕交给内置控件的情况下显示视频，您将不得不构建自己的播放器 - VLC 已移植到 iPhone，因此可以作为一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-13T03:31:21.273

向我解释的方式，包括 iPhone OS 在内的 OS X 呈现它的视图的方式，图像将不断地相互堆叠。您可能想要尝试的是包含所有帧的大型精灵图像，一次裁剪为一个并根据需要捕捉到每个帧。这也减少了图像文件开销和渲染速度，就像 CSS 精灵在 Web 应用程序中所做的那样。这在我在 iPhone 上完成的 HTML5/CSS3 动画中效果很好，并且可能在您的背景图像动画中同样成功。

# security - 如何防止 Man in the Browser 攻击？

> ID：846460
> 
> 赞同：7
> 
> 时间：2009-05-11T01:38:30.663
> 
> 标签：security, browser, trojan

一直在阅读有关 MitB 攻击的信息，有些事情让我担心。

来自[维基](http://en.wikipedia.org/wiki/Man_in_the_Browser)：

> 使用强大的身份验证工具只会增加客户和银行双方对交易安全的错误信心。
> 
> 对抗 MitB 攻击的最有效方法之一是通过带外 (OOB) 事务验证过程。这通过验证主机（银行）通过浏览器以外的渠道向用户（客户）接收的交易详细信息来克服 MitB 木马

因此，如果我直截了当地说，唯一真正安全的方法是非浏览器确认方法。（如电话或其他一些外部工具）

电子邮件会算作 OOB 交易吗？或者 MitB 可以发送假电子邮件吗？

有没有办法只用代码来防止 MitB？

编辑：我问这个是因为我们当地的银行系统正在使用[物理注册机系统](http://www.audkenni.is/upimages/lykill_1.gif)，您必须按下该系统以获取一个号码，然后将该号码输入到交易表格中的一个字段中。

我不知道这是否被认为是安全的，因为看起来像 MitB 攻击只是让它看起来你所做的一切都是安全和正确的，但实际发生的是表单数据在提交时被更改，现在正在转移到其他一些银行账户。所以它可以访问这个注册机号码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T01:47:04.517

> 电子邮件会算作 OOB 交易吗？

鉴于像 GMail 这样的 Web 邮件服务的普遍性，我会说不。即使这种攻击的目标*不是*使用 Web 邮件，控制目标浏览器的攻击者也可以像您建议的那样发送假电子邮件.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T01:47:31.913

在该[维基百科文章的主题（并被引用）的文章](http://www2.futureware.at/svn/sourcerer/CAcert/SecureClient.pdf)中，“攻击方法”中的第 1 步表述为：

> 1.  木马会感染计算机的软件，无论是操作系统还是应用程序。

因此，您的问题的答案是“否”：一旦操作系统被感染，那么恶意软件也可以（至少理论上）拦截您的电子邮件。

顺便说一句，一些客户端平台（例如移动电话，更不用说专用的销售点终端）比其他客户端平台更不容易受到感染。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T01:49:14.950

我想您可以将交易信息的关键部分用作二级或三级交易验证步骤的一部分。也就是说，如果我以为我告诉了银行账户#12345，它听到了#54321，因为数据被这种类型的攻击掺假了，那么二次验证将无法通过加密检查。银行也有可能回显一些更难以更改的内容，例如包含相关信息的图像。

这类讨论的问题在于它总是会变得更加复杂。电子邮件在带外是无效的，因为，我不得不想象我有一个 rootkit ......如果我停止它，我不得不想象我的操作系统实际上是一个运行在邪恶虚拟机中的客户操作系统......如果我停止那，我想我必须想象它是矩阵，我不能相信任何东西都可以用 200 美元的可用信用来保护我的签证卡。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T02:48:52.403

一般来说，如果你的机器被感染了，那么无论如何你都是脆弱的。

物理令牌或“带外”令牌旨在解决“身份”问题，并使银行更加确信登录的人就是他们所说的人。这种机制通常涉及使用“一次性代码”技术，因此即使有人正在记录与银行的对话，令牌也不能被重复使用。但是，如果恶意软件是实时拦截的，那么他们可以在您成功登录后恶意控制账户，但银行通常会在您每次尝试从账户中转出资金时都需要一个新的“代码”。因此，恶意软件必须等待您合法地执行此操作，然后修改请求。然而，大多数恶意软件都不是实时的，它们会将数据发送给第三方以供收集和以后使用。使用这些“

要回答您的问题，没有办法仅在代码中对此进行防御。您所做的任何事情都可以在恶意软件中专门解决。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-02T05:16:38.130

这是我对浏览器中的人的看法。浏览器中的人好像：

1.  受害者站起身，离开电脑，背对着电脑，这样他就无法触摸键盘、移动鼠标​​，甚至看不到屏幕。
2.  黑客坐在受害者计算机后面。
3.  如果受害者想使用他的计算机，他**必须**要求黑客为他做这件事。如果他想看到任何结果，他**必须**让黑客读取监视器上的数据。
4.  黑客尽最大努力说服用户他正在做他要求的事情，并重复他所掌握的内容。但尽量不留情面地利用这种情况！

[![浏览器中的人](https://i.stack.imgur.com/eOzB1.jpg)](https://i.stack.imgur.com/eOzB1.jpg)

作为一个简单的案例：

1.  受害者可能会**要求**黑客填写交易表格数据作为*向妈妈转账 500 美元*。
2.  黑客可以**输入** *transfer 10000USD to Jack*。（发送前篡改表单数据）
3.  系统可能会显示，我已将 10000 美元转给杰克，但黑客说 500 美元已转给杰克。（篡改结果 HTML）
4.  受害者要求查看他的账户余额，以确保转账已完成。
5.  黑客可以说帐户余额是正确的（例如，可以通过删除余额表的最后一行并更改 HTML 中的余额金额来完成）

至于电子邮件：

1.  您正在等待一封电子邮件，并询问黑客我是否有来自银行的确认电子邮件。
2.  由于您看不到显示器，他说是的，您有。（从技术上讲，他可以轻松生成假电子邮件）。（即使您坐在另一台干净的计算机上，也可能再次向您发送虚假电子邮件）

图像生成无法防止攻击。

1.  你**问**黑客，我的银行应该给我一张显示转账信息的图片，你能看到吗，上面写着什么。
2.  黑客**回复**：是的，我看到了，上面写着“你正在向妈妈转账 500 美元”（该图像可以很容易地通过 JavaScript 创建或者黑客可以将图像 url 指向服务器，该服务器会生成带有适当数据的动态图像以作弊用户）

当浏览器中的人改变站点的流程时，可能会发生非常危险的情况。在这种情况下，即使是 OTP 或 kegen 系统也无法阻止攻击。例如：

1.  你问黑客你想看看你的余额
2.  黑客进入转帐页面，填写转帐表格将10000USD转给jack（但你根本不知道他在做什么，你只是在等待）他来到一个向他询问密钥的页面。这是你必须给他的钥匙。
3.  现在，黑客**说**：好吧，银行问我是否要查看余额，您必须输入密钥。
4.  你认为，平衡的钥匙似乎很奇怪，但无论如何，让我们把钥匙给我吧，我相信这家伙！！
5.  黑客切换回传输形式并使用密钥进行传输。

如您所见，在浏览器中没有针对 Man 的服务器端解决方案，您可以：

1.  使用带外解决方案向用户通知关键信息。（这就像你拿着手机，虽然你的背仍然是你的电脑，但敏感信息被发送到你的受信任的设备，你可以看到关键信息）
2.  使用强化的浏览器来确保没有人可以改变它的行为。（坐回你的电脑:)）

可以在以下位置找到 MITB 可以完成的良好示例：[http ://www.tidos-group.com/blog/2010/12/09/man-in-the-browser-the-power-of-javascript-以carberp为例/](http://www.tidos-group.com/blog/2010/12/09/man-in-the-browser-the-power-of-javascript-at-the-example-of-carberp/)

# continuous-integration - Hudson 作为服务运行未启动

> ID：846461
> 
> 赞同：1
> 
> 时间：2009-05-11T01:38:34.860
> 
> 标签：continuous-integration, build-automation, hudson

我下载了 Hudson，并尝试将其安装为服务。我按照[此页面](http://wiki.hudson-ci.org/display/HUDSON/Installing+Hudson+as+a+Windows+service)中的步骤操作，但是当我尝试启动服务时，它总是失败。我也没有真正得到任何定义的错误代码。如果我尝试从命令行运行服务（使用 net start），我会收到以下（无用）消息：

无法启动 hudson 服务。

该服务没有报告错误。

安装过程似乎运行良好，因为安装了 hudson 服务，并且所有文件都在新目录中，但该服务无法启动。有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T01:45:16.907

正如该页面上记录的那样，他们有一个注释......

如果由于某种原因重新启动失败，请检查 Hudson 的输出，该输出存储在您指定的安装目录中。

有什么可以表示进一步的错误吗？

# lucene - 关闭索引阅读器

> ID：846464
> 
> 赞同：0
> 
> 时间：2009-05-11T01:41:53.420
> 
> 标签：lucene, lucene.net

我的 Lucene 代码中有一行：

```
try
{
    searcher.GetIndexReader();
}
catch(Exception ex)
{
    throw ex;
}
finally
{
    if (searcher != null)
    {
        searcher.Close();
    }
} 
```

在我的 finally 子句中，当我执行 searcher.Close() 时，它是否也会在幕后执行 searcher.GetIndexReader().Close？

还是我需要显式调用 searcher.GetIndexReader().Close() 方法来关闭 IndexReader？

谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T02:08:40.113

抱歉，很难理解您的代码段中的**搜索**器类型是什么以及它是如何构建的。但是您**不应该使用****searcher.GetIndexReader().Close() 关闭**索引阅读器。**searcher.Close()**将关闭与其关联的所有资源和索引阅读器，如果**searcher 不是使用****IndexSearcher(IndexReader r)**构造的 IndexSearcher 实例。在这种情况下，您必须手动关闭索引阅读器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T08:38:33.830

首先，这样的代码总是一个坏主意：

```
try {
    // Do something
} catch(Exception ex) {
    throw ex;  // WRONG
} 
```

您只是掩盖了异常的来源，并且仍在抛出。最好只是删除这些行。

如果您没有创建`IndexReader`自己，则不需要自己关闭它。您根本不需要使用该方法`getIndexReader`的可能性很高。

此外，除非您在块`searcher`内分配，否则`try`无需检查它是否为空，因为它不可能获得空值。

这是您的代码应如下所示的示例：

```
String myIndexDir = "/my/index/dir";

IndexSearcher searcher = new IndexSearcher(myIndexDir);
try { 
    // Do something with the searcher
} finally { 
    searcher.close(); 
} 
```

# mfc - 如何从 MFC 标题栏中删除关闭按钮

> ID：846466
> 
> 赞同：4
> 
> 时间：2009-05-11T01:42:09.627
> 
> 标签：mfc, mfc-feature-pack

有没有一种简单的方法可以从 MFC 功能包标题栏中删除关闭按钮？

（我不是说窗口标题，我说的是可以出现在这些应用程序的客户区顶部的小信息栏 - 即：CMFCCaptionBar）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T02:15:56.607

想出了一个办法...

```
class CNoCloseCaptionBar : public CMFCCaptionBar
{
public:
    CNoCloseCaptionBar()
    {
    }

    virtual void RecalcLayout()
    {
        __super::RecalcLayout();
        m_rectClose.SetRectEmpty();
    }

}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-08T21:46:42.607

删除位图对我有用。请参阅 Visual C++ 2008 功能包中的 MSOffice2007Demo 示例。

注释掉 CMainFrame:CreateMessageBar() 中的以下行

```
//m_wndMessageBar.SetBitmap(IDB_INFO, RGB(255, 255, 255), FALSE, CMFCCaptionBar::ALIGN_LEFT); 
```

没有关闭按钮的字幕栏 [![在此处输入图像描述](https://i.stack.imgur.com/F6E1X.jpg)](https://i.stack.imgur.com/F6E1X.jpg)

# text-files - 如何在 Windows 上读取大文本文件？

> ID：846475
> 
> 赞同：79
> 
> 时间：2009-05-11T01:47:59.180
> 
> 标签：text-files, text-editor, large-files

我有一个很大的服务器日志文件（~750 MB），我无法用记事本或记事本++打开（他们都说文件太大）。

任何人都可以建议一个程序（适用于 Windows）一次只能将文件的一小部分读入内存吗？

还是我需要编写自己的应用程序来解析这个文件？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-11T01:54:14.380

尝试这个...

[大文本文件查看器](https://www.portablefreeware.com/?id=693)

顺便说一句，它是免费的:)

但是，我认为你应该在 serverfault.com 上问这个[问题](http://serverfault.com)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-03-16T23:00:43.170

如果你只需要一个阅读工具，那么这个东西会立即打开文件**[http://www.readfileonline.com/](http://www.readfileonline.com/)**

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-12-09T06:43:46.453

用[EmEditor](http://emeditor.com)，很不错，我用它打开一个500mb以上的文件

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-08-21T08:50:08.817

[Total Commander](http://www.ghisler.com/)的集成文本**查看器**可以毫无问题地打开大文件（>10GB）进行查看。它还提供不同的视图，例如 Hex-View。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-02T19:01:39.247

绝对**[是 EditPad Lite](http://www.editpadlite.com/download.html)**！

它不仅在打开文件时非常快，而且像“全部替换”、修剪前导/尾随空格或将内容转换为小写等功能也非常快。

它也非常类似于[Notepad++](http://notepad-plus-plus.org/) ;)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-03-11T10:00:39.103

我已经使用[BareTail](http://www.baremetalsoft.com/baretail/)很长一段时间来查看大型日志（一些 GB），它工作得非常好而且速度非常快。有免费版和商业专业版。

他们[说它](http://www.baremetalsoft.com/baretail/index.php)有

*   实时文件
*   **优化的实时查看引擎查看任意大小（> 2GB）的文件**
*   立即滚动到整个文件中的任何点
*   通过网络查看文件
*   可配置的换行
*   可配置的 TAB 扩展
*   可配置的字体，包括间距和偏移，以最大限度地利用屏幕空间

另一种选择是[Far Manager](http://www.farmanager.com/)。查看几 GB 的文件没有问题（内存占用很小），但尝试在编辑模式下打开文本文件可能会占用几 GB 的 RAM，因此请注意这一点。我不知道可以在 Far 中查看/编辑的文件大小限制。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-11T01:55:00.527

[UltraEdit 可以解决问题](http://www.ultraedit.com/support/tutorials_power_tips/ultraedit/large_file_handling.html)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-01-16T12:20:29.783

我只是`less`在[Cygwin](http://cygwin.com/)上使用来读取一个 3GB 的文件，尽管我最终使用`grep`它来找到我需要的内容。

（`less`是`more`，但更好。）

有关更多详细信息，请参阅此答案`less`：[https ://stackoverflow.com/a/1343576/1005039](https://stackoverflow.com/a/1343576/1005039)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-07T09:44:15.357

如果您可以编码，请编写一个控制台应用程序。这是你所追求的c#等价物。你可以对结果做你想做的事情（拆分、执行等）：

```
SqlCommand command = null;
try
{
    using (var connection = new SqlConnection("XXXX"))
    {
        command = new SqlCommand();
        command.Connection = connection;
        if (command.Connection.State == ConnectionState.Closed) command.Connection.Open();
        // Create an instance of StreamReader to read from a file.
        // The using statement also closes the StreamReader.
        using (StreamReader sr = new StreamReader("C:\\test.txt"))
        {
            String line;
            // Read and display lines from the file until the end of 
            // the file is reached.
            while ((line = sr.ReadLine()) != null)
            {
                Console.WriteLine(line);
                command.CommandText = line;
                command.ExecuteNonQuery();
                Console.Write(" - DONE");
            }
        }
    }
}
catch (Exception e)
{
    // Let the user know what went wrong.
    Console.WriteLine("The file could not be read:");
    Console.WriteLine(e.Message);
}
finally
{
    if (command.Connection.State == ConnectionState.Open) command.Connection.Close();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-01T19:08:05.040

用于 Windows 的 GnuUtils 也使这变得简单。该软件包中包含标准的 UNIX 实用程序，例如 cat、ls 等。我正在使用 cat 文件名 | 更多地翻阅 Notepad++ 根本无法打开的巨大文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-01-02T05:20:41.493

虽然大文本文件查看器非常适合仅查看大文件（而且是免费的！），但如果文件是定界文件或固定宽度文件，那么您应该查看[文件查询](http://www.agiledatasoftware.com/products.html)。它不仅可以打开任何大小的文件（我个人打开了一个 280GB 的文件，但它可以变得更大），而且它还可以让您像在数据库中一样查询文件，找出您需要的任何类型的信息可以从中得到。

虽然它不是免费的，所以它更适合经常处理大文件的人，但如果您遇到一次性问题，您可以免费使用 30 天试用版。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-20T20:14:08.580

我讨厌宣传我自己的东西（嗯，不是真的），但[PowerPad](http://quickmediasolutions.com/software/powerpad/)可以打开非常大的文件。

否则，我会推荐一个十六进制编辑器。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-05-11T01:52:15.087

您应该尝试[TextPad](http://www.textpad.com)，它可以读取该大小的文件。

可以免费评估（您可以无限期地评估）

# xml - 在 AS3 中使用 E4X 重命名 XML 节点

> ID：846476
> 
> 赞同：0
> 
> 时间：2009-05-11T01:48:07.323
> 
> 标签：xml, actionscript-3, e4x

我在 AS3 中有一个 XML 对象，其格式如下：

```
<data>
  <nodes>
    <item></item>
    <item></item>
    ...
  </nodes>
  <nodes>
    <item></item>
    <item></item>
    ...
  </nodes>
  ...
</data> 
```

我的问题是我想将节点名称（“nodes”和“item”）重命名为更相关的名称，例如“ *nodes* ”可以是“ *author* ”，“ *item* ”可以是“ *book* ”。

那么在 AS3 中使用 E4X 执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-11T08:12:36.010

您可以使用`setName()`AS3 中的 XML Object 的方法。

例子：

```
 //extract all nodes named "nodes"

    var l:XMLList=data..nodes;
    for each(var n:XML in l){
       n.setName("new_node_name");
    }

    //extract all nodes named "item"

    var l2:XMLList=data..item;
    for each(var n2:XML in l2){
       n2.setName("new_item_name");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T05:47:10.820

据我所知，没有办法在 ActionScript 中本地执行此操作，但是这里有一个简单的函数可以完成此操作。首先，我将其转换为字符串，然后使用简单的正则表达式来查找和替换所有实例。

```
function replaceAll(findTag:String, replaceWith:String, source:XML):XML
    {
        var xmls:String = source.toXMLString();
        var findPattern:RegExp = new RegExp(findTag, "g");
        xmls = xmls.replace(findPattern, replaceWith);
        return new XML(xmls);
    } 
```

希望能帮助到你。

# asp.net - 尝试登录时出现 sql 连接错误

> ID：846479
> 
> 赞同：0
> 
> 时间：2009-05-11T01:50:48.490
> 
> 标签：asp.net, authentication

我有一个在我的本地开发环境中工作的登录页面。当我将站点推送到 Web 服务器时，尝试从 asp.net 登录控件登录时出现此错误。

> 建立与服务器的连接时发生错误。连接到 SQL Server 2005 时，此故障可能是由于在默认设置下 SQL Server 不允许远程连接造成的。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

我无法弄清楚为什么它在服务器上不起作用。我是否需要在 web.config 中添加任何内容或更改某些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T02:00:18.303

[这篇支持文章可能会有所帮助](http://support.microsoft.com/kb/914277)。它也可能是防火墙问题或新设置的身份验证问题（但错误消息使这种可能性降低）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-19T11:25:54.250

要解决 sql server 中的错误 26，您需要执行以下步骤。

在服务器系统 1\. 在表面区域配置管理器下 - 打开远程连接。2.将1433和1434端口号作为n例外添加到防火墙中。3\. 打开路由器的1433端口进行广域网访问。4\. 将客户端计算机 IP 地址作为例外添加到您的防病毒软件或在防病毒软件中允许 LAN 设置。5\. 现在尝试检查客户端和服务器是否相互连接。对于这种类型的“ping远程系统的IP地址”，如果获得回复，则对服务器机器执行相同操作。如果两台机器都收到回复。

打开 Sql 服务器并尝试连接到允许使用其 IP 地址进行远程连接的远程计算机。你肯定会连接到服务器机器

[看这个视频](http://www.techpint.com/programming/error-26-%E2%80%93-error-locating-serverinstance-specified-sql-server)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T02:43:49.917

检查以确保在 SQL Server 上启用了 TCP/IP。无论出于何种原因，命名管道和 TCP/IP 默认是关闭的。还要确保您尝试连接到正确的实例（也许您在本地使用 ./SQLEXPRESS 并且在服务器上 SQL 安装在默认实例上）。最后，确保您尝试连接的数据库存在于服务器上。

# python - 在 Django 中为瑞士锦标赛建模

> ID：846485
> 
> 赞同：3
> 
> 时间：2009-05-11T01:55:17.517
> 
> 标签：python, django, django-models

我正在尝试创建代表[瑞士锦标赛](http://en.wikipedia.org/wiki/Swiss_tournament)的模型，其中包含多轮。每一轮每个人都将与另一名球员配对，除非有一名奇怪的球员出局，此时一名球员将轮空。

我需要跟踪每个配对的结果；即，哪个玩家赢了。另外，我希望以后能够有效地搜索所有曾与给定球员交手过的球员。

显而易见的东西：

```
class Tournament(models.Model):
    name = models.CharField(max_length=80)

class Player(models.Model):
    name = models.CharField(max_length=80) 
```

起初我打算有一个看起来像这样的“TournamentPairing”类：

```
class TournamentPairing(models.Model):
    tournament = models.ForeignKey(Tournament)
    round = models.IntegerKey()
    player1 = models.ForeignKey(Player)
    player2 = models.ForeignKey(Player, null = True) # In case of a bye, this is None.
    outcome = models.CharField(max_length=1) # player1 wins, loses, bye, or tie 
```

但这感觉有点老套，尤其是关于 player2 有时是 None 的部分。另外，我认为它不能很好地促进搜索（因为我们正在寻找的玩家可能在 player1 或 player2 插槽中）。

有没有更好的办法？我怀疑我的 django noob-ness 阻碍了我在这里找到正确的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T05:55:21.477

您可以重构您的 TournamentPairing 类，使其更加以“圆形”为中心，以帮助进行查询。

CHOICES = (('n', 'Normal'), ('b', 'Bye'), )

```
class Round(models.Model):        
    number = models.IntegerField()
    round_type = models.CharField(max_length=1, default="n", choices=CHOICES)
    tournament = models.ForeignKey(Tournament)
    players = models.ManyToManyField(Player, related_name="rounds")
    winner = models.ForeignKey(Player, null=True, related_name="round_winner") 
```

在平局的情况下，将获胜者字段指向名为“平局”的玩家。

然后，对于您的搜索条件，查看给定玩家与之交手的玩家列表：

```
# grab a player 
p = Player.objects.get(name='Tom')

# see what rounds this player played in
rounds_played = p.rounds.all()

# who did this player play against?
[r.players for r in rounds_played]

# to see all rounds this player won
p.round_winner.all() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T02:13:36.317

我认为您应该只有一个玩家列表，而不是将其拆分为 player1 和 player2，它们可以在设置回合时构建。

您的玩家类别可以包括他们玩过的玩家列表，该列表中的最后一位玩家将是他们当前面对的玩家。当您选择下一个必须上场的球员时，将该球员添加到列表中。

```
class Player(Models.model):
  name = models.CharField(max_length=80)
  playersPlayed = [] 
```

在每一轮中，对于单个玩家，只需遍历全局玩家列表并将特定玩家与 playerPlayed 中的每个元素进行比较。如果该元素不存在，则可以播放该人，然后应将该播放器添加到列表中。如果在特定回合中无法找到一名球员，那么该球员将被轮空。

我希望这至少是一个起点。

# .net - 如何让 Uri.EscapeDataString 符合 RFC 3986

> ID：846487
> 
> 赞同：31
> 
> 时间：2009-05-11T01:56:05.580
> 
> 标签：.net, openid, oauth, escaping, uri

Uri 类默认为 RFC 2396。对于 OpenID 和 OAuth，我需要 Uri 转义与 RFC 3986 一致。

从[System.Uri 类文档](http://msdn.microsoft.com/en-us/library/system.uri.aspx)：

> 默认情况下，URI 中的任何保留字符都会根据 RFC 2396 进行转义。如果启用国际资源标识符或国际域名解析，则此行为会发生变化，在这种情况下，URI 中的保留字符会根据 RFC 3986 和 RFC 3987 进行转义。

该文档还指出，激活此 IRI 模式以及因此 RFC 3986 行为意味着将 uri 部分元素添加到 machine.config 并将其添加到您的 app/web.config 文件中：

```
<configuration>
  <uri>
  <idn enabled="All" />
  <iriParsing enabled="true" />
  </uri>
</configuration> 
```

但无论这是否存在于 .config 文件中，对于 .NET 3.5 SP1 应用程序，我都会得到相同的（非 3986）转义行为。 **我还需要做什么`Uri.EscapeDataString`才能使用 RFC 3986 规则？**（特别是转义该 RFC 中定义的保留字符）

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-12T15:45:50.750

由于无法让 Uri.EscapeDataString 承担 RFC 3986 行为，我编写了自己的符合 RFC 3986 的转义方法。它利用 Uri.EscapeDataString，然后将转义“升级”到 RFC 3986 合规性。

```
/// <summary>
/// The set of characters that are unreserved in RFC 2396 but are NOT unreserved in RFC 3986.
/// </summary>
private static readonly string[] UriRfc3986CharsToEscape = new[] { "!", "*", "'", "(", ")" };

/// <summary>
/// Escapes a string according to the URI data string rules given in RFC 3986.
/// </summary>
/// <param name="value">The value to escape.</param>
/// <returns>The escaped value.</returns>
/// <remarks>
/// The <see cref="Uri.EscapeDataString"/> method is <i>supposed</i> to take on
/// RFC 3986 behavior if certain elements are present in a .config file.  Even if this
/// actually worked (which in my experiments it <i>doesn't</i>), we can't rely on every
/// host actually having this configuration element present.
/// </remarks>
internal static string EscapeUriDataStringRfc3986(string value) {
    // Start with RFC 2396 escaping by calling the .NET method to do the work.
    // This MAY sometimes exhibit RFC 3986 behavior (according to the documentation).
    // If it does, the escaping we do that follows it will be a no-op since the
    // characters we search for to replace can't possibly exist in the string.
    StringBuilder escaped = new StringBuilder(Uri.EscapeDataString(value));

    // Upgrade the escaping to RFC 3986, if necessary.
    for (int i = 0; i < UriRfc3986CharsToEscape.Length; i++) {
        escaped.Replace(UriRfc3986CharsToEscape[i], Uri.HexEscape(UriRfc3986CharsToEscape[i][0]));
    }

    // Return the fully-RFC3986-escaped string.
    return escaped.ToString();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-28T17:59:25.520

这实际上已在 .NET 4.5 中修复为默认工作，请参见[此处](http://msdn.microsoft.com/en-us/library/hh367887%28v=vs.110%29.aspx#core)。

我刚刚创建了一个名为[PURify](https://github.com/glennblock/PUrify)的新库（在遇到此问题后），它将通过本文中的方法的变体处理使其适用于 .NET pre 4.5（适用于 3.5）和[Mono](https://stackoverflow.com/questions/781205/getting-a-url-with-an-url-encoded-slash)。Purify 不会更改 EscapeDataString 但它确实让您拥有带有保留字符的 Uris，这些字符不会被转义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-09T20:08:30.187

我意识到这个问题和答案已经有几年的历史了，但是当我[在 .Net 4.5 下难以获得合规性](https://stackoverflow.com/q/41006873/955034)时，我想我会分享我的发现。

如果您的代码在asp.net 下运行，只需将项目设置为目标4.5 并在4.5 或更高版本的机器上运行，您可能仍然会得到4.0 的行为。您需要确保`<httpRuntime targetFramework="4.5" />`在 web.config 中进行了设置。

从[这篇关于 msdn 的博客文章](https://blogs.msdn.microsoft.com/webdev/2012/11/19/all-about-httpruntime-targetframework/)，

> 如果 Web.config 中没有`<httpRuntime targetFramework>`属性，我们假设应用程序需要 4.0 怪癖行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T04:04:42.017

您使用的是什么版本的框架？看起来很多这些更改是在（[来自 MSDN](http://msdn.microsoft.com/en-us/library/bb882600.aspx)）“.NET Framework 3.5\. 3.0 SP1 和 2.0 SP1”时间范围内进行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-21T14:20:54.070

我找不到更好的答案（100% 框架或 100% 重新实现），所以我创造了这个可憎的东西。似乎正在使用 OAuth。

```
class al_RFC3986
{
    public static string Encode(string s)
    {
        StringBuilder sb = new StringBuilder(s.Length*2);//VERY rough estimate
        byte[] arr = Encoding.UTF8.GetBytes(s);

        for (int i = 0; i < arr.Length; i++)
        {
            byte c = arr[i];

            if(c >= 0x41 && c <=0x5A)//alpha
                sb.Append((char)c);
            else if(c >= 0x61 && c <=0x7A)//ALPHA
                sb.Append((char)c);
            else if(c >= 0x30 && c <=0x39)//123456789
                sb.Append((char)c);
            else if (c == '-' || c == '.' || c == '_' || c == '~')
                sb.Append((char)c);
            else
            {
                sb.Append('%');
                sb.Append(Convert.ToString(c, 16).ToUpper());
            }
        }
        return sb.ToString();
    }
} 
```

# c++ - 即使使用 new 和 delete，Functor 构造和开销也为零？

> ID：846488
> 
> 赞同：1
> 
> 时间：2009-05-11T01:58:07.823
> 
> 标签：c++, optimization, compiler-construction, functor

如果我有一个没有状态的仿函数类，但是我使用 new 从堆中创建它，那么典型的编译器是否足够聪明，可以完全优化创建开销？

这个问题是在制作一堆无状态函子时出现的。如果它们被分配在堆栈上，它们的 0 状态类主体是否意味着堆栈真的根本没有改变？看来它必须以防您稍后获取仿函数实例的地址。堆分配也一样。

在这种情况下，仿函数总是在它们的创建中增加一个（微不足道的，但非零的）开销。但也许编译器可以看到该地址是否被使用，如果没有，它可以消除堆栈分配。（或者，它甚至可以消除**堆**分配吗？）

但是作为临时创建的函子怎么样？

```
#include <iostream>

struct GTfunctor 
{
  inline bool operator()(int a, int b) {return a>b; }
};

int main()
{
  GTfunctor* f= new GTfunctor;
  GTfunctor g;

  std::cout<< (*f)(2,1) << std::endl;
  std::cout<< g(2,1) << std::endl;
  std::cout<< GTfunctor()(2,1) << std::endl;
  delete f;
} 
```

所以在上面的具体例子中，三行分别以三种不同的方式调用同一个函子。在此示例中，这些方式之间是否存在效率差异？或者编译器是否能够一直优化每一行，直到成为一个无计算的打印语句？

编辑：大多数答案说编译器永远不能内联/消除堆分配的仿函数。但这也是真的吗？大多数编译器（GCC、MS、Intel）也有链接时间优化，它们确实可以进行这种优化。（但有吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T02:46:52.377

显然，这取决于您的编译器。

我会说

*   *没有*编译器会优化堆上的对象。（这是因为，正如 ChrisW 所说，编译器永远不会优化对 new 的调用，这几乎可以肯定是在另一个翻译单元中定义的。）

*   *一些*编译器会优化掉堆栈上的命名对象。我知道 gcc 经常做这种优化。

*   *大多数*编译器会优化掉堆栈上的未命名对象。这是“标准”C++ 优化之一，尤其是当更高级的 C++ 用户倾向于创建大量未命名的临时变量时。

不幸的是，这些只是经验法则。优化器是出了名的不可预测。真正了解编译器在做什么的唯一方法是读取汇编输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T02:07:54.640

> 典型的编译器是否足够聪明，可以完全优化创建开销？

当您在堆上创建它们时，我怀疑是否允许编译器这样做。海事组织：

*   调用 new 意味着调用 operator new。
*   operator new 是在运行时库中定义的重要函数。
*   不允许编译器决定您并不是真的要调用这样的函数，并决定作为优化它不会默默地调用它。

当您在堆栈上创建它们并且不获取它们的地址时，那么可能......或者可能不是：我的猜测是每个对象都有一个非零大小，以便占用一些内存，以便拥有一个身份，即使对象除了其身份之外没有任何状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T02:31:06.053

我非常怀疑这种优化是允许的，但是如果你的仿函数没有状态，你为什么要在堆上初始化它呢？它应该像临时使用一样容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T02:38:09.647

C++ 对象的大小始终非零。“空基类优化”允许空基类的大小为零，但这不适用于此处。

我没有研究过任何 C++ 优化器，所以我所说的只是推测。我认为 2nd 和 3rd 将很容易内联扩展，不会有任何开销，也不会创建 GTFunctor。然而，函子指针是另一回事。在您的示例中，它可能看起来很简单，并且任何优化器都应该能够消除堆分配，但是在一个不平凡的程序中，您可能会在一个翻译单元中创建函子并在另一个翻译单元中使用它。甚至在编译器/链接器/加载器/运行时系统没有源代码的不同库中，几乎不可能优化。考虑到优化它并不容易，性能的潜在收益并不大，并且在堆中分配空函子的情况可能很少，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T02:38:41.487

编译器无法优化对 new 或 delete 的调用。但是，它可能会优化在堆栈上创建的变量，因为它没有状态。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T11:08:26.223

回答堆问题的简单方法：

```
GTfunctor *f = new GTfunctor; 
```

的值`f`不能为空，那应该是什么呢？你还有：

```
GTfunctor *g = new GTfunctor; 
```

现在 的值`g`不能等于 的值`f`，那么每个应该是什么？

此外，也不`f`或`g`可能不等于从 获得的任何其他指针`new`，除非其他地方的某个指针以某种方式初始化为等于`f`or `g`，这（取决于后面的代码）可能涉及检查程序的整个其余部分所做的事情。

是的，如果通过对代码的本地检查，编译器可以看到您从不依赖这些要求中的任何一个，那么它可以执行重写，这样就不会发生堆分配。问题是，如果您的代码如此简单，您可能会自己重写并最终得到一个更具可读性的程序，例如，您的测试程序看起来像您的基于堆栈的`g`示例。所以真正的程序不会从编译器中的这种优化中受益。

大概你这样做的原因是因为有时仿函数*确实*有数据，这取决于在运行时选择的类型。所以编译时分析在这里不能有效地发挥它的魔力。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T22:08:47.403

C++ 标准规定每个对象（堆上的恕我直言）必须至少有一个字节的大小，因此它可以被唯一地寻址。

使用 new 生成函子会导致两个问题：

1.  结构通常不能优化掉。New 是一个具有复杂副作用的函数 (bad_alloc)。
2.  因为您间接寻址仿函数，编译器可能无法内联该函数。

如果您在堆栈上生成函子，您很可能看不到函子的迹象。

旁注：内联语句不是必需的。在类定义中定义的每个函数都被视为可内联的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-11T10:09:34.837

你的问题的答案有两个方面。

1.  编译器是否优化了堆分配：我强烈怀疑它，但我不是一个标准的人，所以我必须查一下。

2.  编译器可以通过内联对象的 operator() 进行优化吗？是的。只要您不将调用指定为虚拟调用，即使指针取消引用也不会实际执行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T02:33:00.323

编译器可能会发现 operator() 没有使用任何成员变量，并将其优化到最大值。不过，我不会对本地或堆分配的变量做出任何假设。

**编辑：**如有疑问，请打开编译器上的程序集输出选项，看看它实际在做什么。当您可以自己看到真正的答案时，在网络上听一群白痴是没有意义的。

# c# - string.Replace 行为不符合预期

> ID：846496
> 
> 赞同：2
> 
> 时间：2009-05-11T02:05:34.160
> 
> 标签：c#, .net, string

有人可以解释为什么我从这两个陈述中得到不同的结果吗？我认为将值重新分配给同一个变量会导致我在上面的示例中得到的值。我在这里想念什么？

```
_body.Replace("##" + _variableName + "##",
    templateVariables[_variableName]) 
```

**你好可怜##LastName##，**

```
_body = _body.Replace("##" + _variableName.ToUpper() + "##", 
    templateVariables[_variableName]) 
```

**你好##FirstName## ##LastName##，**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-11T02:08:19.960

字符串是不可变的，因此 Replace 函数不会修改调用它的字符串。您需要像在第二个示例中那样再次分配它。

正如其他人所指出的， ToUpper 调用将确保变量名不匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T02:08:24.750

`.ToUpper()`在第二个示例中，您接到了电话。这是导致您看到的行为的原因吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T02:10:20.440

如果我理解正确：您的第一条语句没有分配返回值，因为 replace 返回替换字符串的新实例。

```
_body = _body.Replace("##" + _variableName + "##",
    templateVariables[_variableName]); 
```

应该修复你那里。

在第二个实例中，变量替换更改了 ToUpper() 和包含混合大小写值的实际字符串。

你的字符串应该是

```
Hello ##FIRSTNAME## ##LASTNAME##, 
```

# php - 定位 iframe 中的特定页面

> ID：846510
> 
> 赞同：0
> 
> 时间：2009-05-11T02:11:16.053
> 
> 标签：php, javascript, html

我正在运行 CMS indexhibit，indexhibit 使用 iframe 加载它的内容。

[http://www.therussianfrostfarmers.com/](http://www.therussianfrostfarmers.com/)

我的主页已将 WordPress 加载到此 iframe 中，它工作正常，我遇到了一些滚动条问题，但这是另一个问题。

目前，当人们通过那里的搜索引擎找到 WP 帖子时，用户被重定向到主页，我需要这样做，否则用户将只能查看 WP 内容，而不能查看网站的其余部分。例如； [http://www.therussianfrostfarmers.com/oldspeak/?p=480](http://www.therussianfrostfarmers.com/oldspeak/?p=480)

我需要做的是拆分查询字符串，并将“id”发送到 iframe，这反过来会在 iframe 中加载适当的 WP 页面。

我不知道从哪里开始，我会使用 PHP 来拆分查询字符串吗？和 Javascript 来定位一些 iframe 属性？

....任何帮助将非常感激

谢谢凸轮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T02:31:32.947

您可能不必拆分查询字符串。您可以只使用 PHP 来获取该 GET 变量的值，例如：

```
$_GET["p"] 
```

对于请求[http://www.therussianfrostfarmers.com/oldspeak/?p=480将等于 480](http://www.therussianfrostfarmers.com/oldspeak/?p=480)

然后，您可以只使用 iFrame 的属性来更改它请求的内容。我相信 iFrame 寻找的 URL 是在 HTML 属性中设置的。所以你可以将 iframe URL 设置为

```
http://www.yourwordpresssite.com/?p=<?php echo $_GET["p"]; ?> 
```

或者类似的方法。

# lucene - 使用 IndexReader IsLocked 和 Unlock 方法

> ID：846513
> 
> 赞同：2
> 
> 时间：2009-05-11T02:14:18.280
> 
> 标签：lucene, lucene.net

打电话之前`AddDocument()`,`IndexWriter`我打电话可以吗

```
IndexReader.IsLocked(myDirectory) 
```

如果它返回true，则调用

```
IndexReader.Unlock(myDirectory) 
```

IE

```
if(IndexReader.IsLocked(myDirectory))
{
IndexReader.Unlock(myDirectory);
}

writer = new IndexWriter(myDirectory, _analyzer, true);
writer.AddDocument(doc); 
```

我不断收到“锁定获取超时”。我的代码中的错误。为了克服这个错误，如果可以的话，我计划采用这种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T08:50:53.937

出现“锁定获取超时”错误是一个警告信号，表明您处理索引的方式有问题。如果您对索引进行了多次`IndexWriter`写入，则强制解锁可能会导致您的索引损坏。

但是，根据我的经验，在处理代码时很容易出现这些错误，因为偶尔的崩溃和中断的调试会话可能会使您的索引锁定，即使没有进程再写入它。

如果是这种情况，则可以在进程开始时解锁索引。不要在调用之前每次都调用它`addDocument`，只在创建时调用一次`IndexWriter`。

在任何情况下，请确保在退出进程之前正确关闭所有 IndexWriters。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-13T04:42:37.287

使用 Lucene 时要记住的重要一点，只有一个线程应该更新索引......所以网站上有并发用户，但只有一个用户应该更新。

如果处理不当，您将遇到问题……您可以进行多次读取/查询，但不能进行写入

# interop - GetPhysicalMonitorsFromHMONITOR 返回的句柄始终为空

> ID：846518
> 
> 赞同：8
> 
> 时间：2009-05-11T02:18:35.997
> 
> 标签：interop, unmanaged, structure, intptr

在 Media Foundation SDK 上，有一个[GetPhysicalMonitorsFromHMONITOR](http://msdn.microsoft.com/en-us/library/ms775216(VS.85).aspx)函数，我正在尝试使用 C# 实现该函数，但没有运气......

在返回的 PHYSICAL_MONITOR[] 中，该函数返回监视器的字符串描述，但由于一些神秘的原因，*hPhysicalMonitor*句柄仍为 0。

我已经使用 P/Invoke Interop Assistant 生成了签名，并稍作修改。

PHYSICAL_MONITOR 结构或其他任何东西是否需要进一步调整？

谢谢你。

```
using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using WindowsFormsApplication1;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public enum MC_DISPLAY_TECHNOLOGY_TYPE
        {
            MC_SHADOW_MASK_CATHODE_RAY_TUBE,

            MC_APERTURE_GRILL_CATHODE_RAY_TUBE,

            MC_THIN_FILM_TRANSISTOR,

            MC_LIQUID_CRYSTAL_ON_SILICON,

            MC_PLASMA,

            MC_ORGANIC_LIGHT_EMITTING_DIODE,

            MC_ELECTROLUMINESCENT,

            MC_MICROELECTROMECHANICAL,

            MC_FIELD_EMISSION_DEVICE,
        }

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
        public struct PHYSICAL_MONITOR
        {
            public IntPtr hPhysicalMonitor;

            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 128)] public string szPhysicalMonitorDescription;
        }

        #region Imports

        [DllImport("user32.dll", EntryPoint = "MonitorFromWindow")]
        public static extern IntPtr MonitorFromWindow(
            [In] IntPtr hwnd, uint dwFlags);

        [DllImport("dxva2.dll", EntryPoint = "GetMonitorTechnologyType")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool GetMonitorTechnologyType(
            IntPtr hMonitor, ref MC_DISPLAY_TECHNOLOGY_TYPE pdtyDisplayTechnologyType);

        [DllImport("dxva2.dll", EntryPoint = "GetMonitorCapabilities")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool GetMonitorCapabilities(
            IntPtr hMonitor, ref uint pdwMonitorCapabilities, ref uint pdwSupportedColorTemperatures);

        [DllImport("dxva2.dll", EntryPoint = "DestroyPhysicalMonitors")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool DestroyPhysicalMonitors(
            uint dwPhysicalMonitorArraySize, ref PHYSICAL_MONITOR[] pPhysicalMonitorArray);

        [DllImport("dxva2.dll", EntryPoint = "GetNumberOfPhysicalMonitorsFromHMONITOR")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool GetNumberOfPhysicalMonitorsFromHMONITOR(
            IntPtr hMonitor, ref uint pdwNumberOfPhysicalMonitors);

        [DllImport("dxva2.dll", EntryPoint = "GetPhysicalMonitorsFromHMONITOR")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool GetPhysicalMonitorsFromHMONITOR(
            IntPtr hMonitor, uint dwPhysicalMonitorArraySize, [Out] PHYSICAL_MONITOR[] pPhysicalMonitorArray);

        #endregion

        public Form1() { InitializeComponent(); }

        private void Form1_Load(object sender, EventArgs e)
        {
            // Get monitor handle.
            uint dwFlags = 0u;
            IntPtr ptr = MonitorFromWindow(Handle, dwFlags);

            // Get number of physical monitors.
            uint pdwNumberOfPhysicalMonitors = 0u;
            bool b1 = GetNumberOfPhysicalMonitorsFromHMONITOR(ptr, ref pdwNumberOfPhysicalMonitors);

            if (b1)
            {
                // Get physical monitors.
                uint dwPhysicalMonitorArraySize = 0u;
                dwPhysicalMonitorArraySize = pdwNumberOfPhysicalMonitors;
                PHYSICAL_MONITOR[] pPhysicalMonitorArray = new PHYSICAL_MONITOR[dwPhysicalMonitorArraySize];

                //NOTE : Handles remain null !
                bool b2 = GetPhysicalMonitorsFromHMONITOR(ptr, dwPhysicalMonitorArraySize, pPhysicalMonitorArray);

                if (pPhysicalMonitorArray[0].hPhysicalMonitor
                    == IntPtr.Zero)
                {
                    throw new Exception("ERROR !");
                }

                // Monitor has capabilities to do that ?
                if (b2)
                {
                    uint pdwMonitorCapabilities = 0u;
                    uint pdwSupportedColorTemperatures = 0u;
                    bool b3 = GetMonitorCapabilities(
                        ptr, ref pdwMonitorCapabilities, ref pdwSupportedColorTemperatures);

                    // If yes, get technology type.
                    if (b3)
                    {
                        MC_DISPLAY_TECHNOLOGY_TYPE type = MC_DISPLAY_TECHNOLOGY_TYPE.MC_SHADOW_MASK_CATHODE_RAY_TUBE;

                        bool b4 = GetMonitorTechnologyType(ptr, ref type);
                        if (b4)
                        {
                            // Do work.
                        }
                        else
                        {
                            throw new Exception("Couldn't get monitor technology type.");
                        }
                    }
                    else
                    {
                        throw new Exception("Couldn't get monitor capabilities.");
                    }
                }
                else
                {
                    throw new Exception("The monitor doesn't have the required capabilities.");
                }

                bool b5 = DestroyPhysicalMonitors(dwPhysicalMonitorArraySize, ref pPhysicalMonitorArray);
                if (!b5)
                {
                    throw new Exception("Couldn't destroy physical monitors.");
                }
            }
            else
            {
                throw new Exception("Couldn't get number of physical monitors.");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T02:29:11.000

您的声明：

> 该函数返回监视器的字符串描述，但由于一些神秘的原因，hMonitor 句柄仍为 0。

是正确的。如果您查看[此处](http://msdn.microsoft.com/en-us/library/ms775216(VS.85).aspx)的文档，您会发现 hMonitor 显然是一个`[in]`参数并且不会被更改。

**更新以下评论：**

抱歉，没有意识到您的意思是在结构中返回物理句柄。我能找到的关于该特定问题的所有信息似乎都表明您的显示器可能不完全兼容 DDC/CI（例如，[此处](http://social.msdn.microsoft.com/Forums/en-US/mediafoundationdevelopment/thread/578d37a8-29e9-4a0e-bd6d-2eecc1c97c79)）。

根据 MSDN 上针对该特定调用的文档，您所有的结构定义对我来说都很好。事实上，它*正在*为您填充描述。

`GetNumberOfPhysicalMonitorsFromHMONITOR`从( )返回的物理监视器数量的值是多少`pdwNumberOfPhysicalMonitors`？

另外，您的`PHYSICAL_MONITOR`结构的大小是多少，您是在 32 位还是 64 位运行？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-02T17:57:20.300

hPhysicalMonitor 的值为 0 没关系。但是，在问题的代码示例中，GetPhysicalMonitorsFromHMONITOR 之后的所有调用都应该使用 hPhysicalMonitor 引用而不是 ptr 引用。更新后的 Form_Load 方法应该如下：

```
private void Form1_Load(object sender, EventArgs e)
{
    // Get monitor handle.
    uint dwFlags = 0u;
    IntPtr ptr = MonitorFromWindow(Handle, dwFlags);

    // Get number of physical monitors.
    uint pdwNumberOfPhysicalMonitors = 0u;
    bool b1 = GetNumberOfPhysicalMonitorsFromHMONITOR(ptr, ref pdwNumberOfPhysicalMonitors);

    if (b1)
    {
        // Get physical monitors.
        uint dwPhysicalMonitorArraySize = 0u;
        dwPhysicalMonitorArraySize = pdwNumberOfPhysicalMonitors;
        PHYSICAL_MONITOR[] pPhysicalMonitorArray = new PHYSICAL_MONITOR[dwPhysicalMonitorArraySize];

        //NOTE : Handles remain null !
        bool b2 = GetPhysicalMonitorsFromHMONITOR(ptr, dwPhysicalMonitorArraySize, pPhysicalMonitorArray);

        // Monitor has capabilities to do that ?
        if (b2)
        {
            uint pdwMonitorCapabilities = 0u;
            uint pdwSupportedColorTemperatures = 0u;
            bool b3 = GetMonitorCapabilities(pPhysicalMonitorArray[0].hPhysicalMonitor, ref pdwMonitorCapabilities, ref pdwSupportedColorTemperatures);

            // If yes, get technology type.
            if (b3)
            {
                MC_DISPLAY_TECHNOLOGY_TYPE type = MC_DISPLAY_TECHNOLOGY_TYPE.MC_SHADOW_MASK_CATHODE_RAY_TUBE;

                bool b4 = GetMonitorTechnologyType(pPhysicalMonitorArray[0].hPhysicalMonitor, ref type);
                if (b4)
                {
                    // Do work.
                }
                else
                {
                    throw new Exception("Couldn't get monitor technology type.");
                }
            }
            else
            {
                throw new Exception("Couldn't get monitor capabilities.");
            }
        }
        else
        {
            throw new Exception("The monitor doesn't have the required capabilities.");
        }

        bool b5 = DestroyPhysicalMonitors(dwPhysicalMonitorArraySize, ref pPhysicalMonitorArray);
        if (!b5)
        {
            throw new Exception("Couldn't destroy physical monitors.");
        }
    }
    else
    {
        throw new Exception("Couldn't get number of physical monitors.");
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-11T11:46:47.557

监视器支持此功能，因为使用 softMCCS 和 WinI2C/DDC 等软件，可以正确返回属性。

返回的*pdwNumberOfPhysicalMonitors*值为 1，这是正确的。

如您所见，它的大小是*pdwNumberOfPhysicalMonitors*：

```
PHYSICAL_MONITOR[] pPhysicalMonitorArray = new PHYSICAL_MONITOR[dwPhysicalMonitorArraySize]; 
```

我正在运行 Vista 32。

这有点奇怪，因为它的一半有效，现在大约 4 天我已经完成了，但仍然没有进展......

谢谢你。

# iphone - 在 safari 中关闭后，iphone 离线缓存的应用程序消失了吗？

> ID：846521
> 
> 赞同：3
> 
> 时间：2009-05-11T02:22:27.300
> 
> 标签：iphone, safari, dns, web-applications, offline

我们正在为 ipod touch/iphone 开发一个 html5 离线网络应用程序。我们的清单和一切工作正常，但我们无法弄清楚为什么我们的应用程序在 iphone safari 中的“选项卡”关闭后不会重新打开。

例如，这是有效的：

1) 在 ipod touch 上打开 safari 中启用离线的 html 文件的 url

2）退出safari，关闭wifi

3）回到动态webapp在窗口中的safari，点击刷新

4）应用程序离线工作！

但是，如果我们这样做，离线应用程序就会消失：

5) 将书签添加到应用程序的网址（或主屏幕图标）

6) 关闭 Safari 中的“选项卡”或窗口

7) 打开书签或主屏幕图标

8) 错误信息：“无法打开页面：Safari 无法打开页面，因为它没有连接到互联网。”

我已经在这个问题上搜索了一下，你知道它是怎么回事，我会在点击“发布”后 2 秒找到答案。但无论如何，我的直觉是当前最新的 iphone OS 版本的 safari 正在尝试在 url 上进行 dns 查找并出错，而不是意识到它已经在设备上具有本地存储的应用程序。

有人遇到这个吗？我可以在清单中设置一些标志或解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-14T19:32:49.377

您可能没有正确配置您的服务器。Apple 文档没有说明这一点。

如果您的服务器正在运行 Apache（很可能），您需要编辑此文件：
`/user/local/apache2/conf/mime.types`

将此行添加到末尾：
`text/cache-manifest manifest`

您将需要重新启动 Apache 以使设置生效。可能是
`restart_apache`来自外壳的东西。

这里发生的情况是服务器需要使用正确的内容类型集将缓存文件返回给您。如果您不这样做，该文件可能会以“文本”的形式返回。如果设置正确，它将返回一种“缓存清单”。

要测试文档返回的 MIME 类型，请使用[web-sniffer.net](http://web-sniffer.net/)。输入清单文件的 url - 您将看到 Content-Type 中显示的结果：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-01T22:48:31.180

提示：每当您更改清单中的文件时，请检查是否更改了清单本身中的某些内容以指示需要下载这些文件。并注意可能不会根据过期设置检查更改的缓存文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-05T11:10:47.727

似乎 Safari（以及 iPhone）希望所有文件都列在清单中——甚至是应用程序的主文件。我使用 default.asp 作为我的应用程序的主页，但未将其包含在清单中。我的应用程序是从 mydomain.com/myapp/ 运行的，因此浏览器从未看到“default.asp”。此外，根据 HTML5 规范，主页面不必在清单中，但显然 Safari 对此的看法略有不同。

我的解决方案是避免使用 default.asp 并调用我的应用 app.asp 并将“app.asp”添加到清单中。希望这可以帮助。

# javascript - 在单选按钮选择上提交 Rails 表单

> ID：846526
> 
> 赞同：2
> 
> 时间：2009-05-11T02:27:30.800
> 
> 标签：javascript, ruby-on-rails, ruby

我有以下 rails 表单（有效），但我想删除 submit_tag 并在选择单选按钮后立即提交表单。我怎么做？

```
<% form_tag({ :controller => "votes", :action => "create", :id => @item.id } ) do  %>
  <p>
    <% for i in 1..10 do %>
      <%=  radio_button_tag :rating, i %>&nbsp;<%=h i %>&nbsp;
    <% end %>
  </p>
  <p>
    <%= submit_tag "Create" %>
  </p>
<% end %> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-11T04:09:55.190

所以我找到了精确的解决方案（感谢输入的家伙，它帮助我重新定义了我的谷歌搜索）。每个人都在正确的轨道上，但没有一个是正确的。

所需要的只是将 'false, :onclick => "this.parentNode.submit();"' 添加到 radio_button_tag 表单助手。选不选false，剩下的就很明显了。

正确的解决方案现在看起来像：

```
<% form_tag({ :controller => "votes", :action => "create", :id => @item.id } ) do  %>
    <% for i in 1..10 do %>
      <%=  radio_button_tag :rating, i, false, :onclick => "this.parentNode.submit();" %>&nbsp;<%=h i %>&nbsp;
    <% end %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T02:43:36.143

您需要将 onClick 事件添加到调用 this.formName.submit() 的单选按钮，其中 formName 是您的表单 ID。当您单击单选按钮时，这将触发提交事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-14T15:39:45.967

我正在做类似的事情，所以这个问题真的很有帮助。

在 Ash 的回答之后，我发现上面的 onclick 函数不起作用，我做了一些更改，下面的表格对我来说很好：

```
<% form_tag({ :controller => "votes", :action => "create", :id => @item.id } ) do  %>
    <% for i in 1..10 do %>
      <%=  radio_button_tag :rating, i, false, :onclick => "this.form.submit();" %>&nbsp;<%=h i %>&nbsp;
    <% end %>
<% end %> 
```

希望它会帮助某人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T02:40:06.380

**使用 Javascript**

使用每个单选按钮的 onclick() 事件调用在提交按钮上调用 submit() 的函数。

我对 Rails 中的 RJS 不是很熟悉，但这应该相对容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T03:06:20.690

一个不显眼地实现这一目标的绝妙方法是使用 lowpro 和原型。这样，您可以将所有事件处理程序放入您的 javascript 中，这样它们就不会污染您的视图代码。这是处理 javascript 事件的一种非常巧妙的方式。强烈推荐。

# c# - 永远不要从 MSMQ 中删除可以吗？

> ID：846530
> 
> 赞同：2
> 
> 时间：2009-05-11T02:30:33.807
> 
> 标签：c#, msmq

我继承了一个从 MSMQ 中提取消息的应用程序，对它们进行一些处理，然后根据消息中的内容将一些数据添加到数据库中。消息被我无法控制的第三方应用程序推送到队列中。

虽然我对如何使用 API 有基本的了解，但我对 MSMQ 了解不多。

无论如何，我注意到这些消息永远不会被删除，我们的客户端肯定不会明确删除它们，我可以查看计算机管理并查看消息回到服务器上次重新启动时。

**这是错的吗？**当队列达到某个最大大小时，消息是否会开始自动删除，或者它们会永远堆积在那里，慢慢地占用更多内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T03:12:29.713

处理完消息后，通常会将其从队列中删除（以事务方式或其他方式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T02:50:54.507

我怀疑虽然这不是最佳实践，但队列会在重新启动时被清除，并且只要有足够数量的可用资源，您就永远不会真正遇到问题。

也就是说，我会选择设置一些东西来定期清理队列，这样你就不会压倒服务器。我对 MSMQ 不太熟悉，但是有什么方法可以判断消息是否已被处理？即使它是运行的附加服务，也会检查队列中的消息并查看它们是否已出现在数据库中，如果出现则将其删除？这样，您就不需要修改您继承的代码库，因为它按原样正常工作。

一旦您决定解决方案，请在此处发布更新 - 我很想知道您最终如何处理此问题。谢谢！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T10:56:47.090

*“无论如何，我注意到这些消息永远不会被删除，我们的客户端肯定不会明确删除它们，我可以查看计算机管理并查看消息回到上次重新启动服务器时的消息。”*

如果在上次重新启动之前没有消息，则听起来这些消息是 Express。Express 消息仅存储在 RAM 中，不会持久保存到磁盘，因此重新启动 MSMQ 服务将破坏它们。这可能就是为什么消息量从未达到临界水平的原因。

由于 MSMQ 使用内核内存和磁盘空间进行内存存储，最终两者中的一个会失效并导致您的服务器稳定性问题，因此您的清理过程计划是一个很好的计划。

干杯，约翰·布雷克韦尔 (MSFT)

# javascript - JavaScript 框架和 CSS 框架：JQuery、YUI，两者都不是，还是别的什么？

> ID：846538
> 
> 赞同：4
> 
> 时间：2009-05-11T02:34:05.457
> 
> 标签：javascript, jquery, yui, javascript-framework, css-frameworks

我已经有 6 年没有做过 Web 开发了。我正试图重新进入它，那里有很多新东西。我选择用 Perl 和 Catalyst 编写我的下一个项目。

我不断听到各种 JavaScript 和 CSS 框架。我对这些框架知之甚少，所以这个问题可能过于宽泛和开放式。

各种框架的优势、劣势和受欢迎程度是什么？我应该使用 YUI、JQuery 还是别的什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-11T02:41:12.073

首先，可能值得仔细阅读[哪个 Javascript 框架（jQuery vs Dojo vs ...）？](https://stackoverflow.com/questions/394601/which-javascript-framework-jquery-vs-dojo-vs).

其次，Javascript框架有两大类：

1.  **Rich：**用于创建所谓的 Rich Intenet 应用程序，它们通常旨在创建类似于具有复杂窗口 GUI 的桌面应用程序的体验。这包括但不限于 YUI、Dojo、ExtJS 和 SmartClient；

2.  **补充：**这些更侧重于改善传统的网站体验，而不是完全取代它。其中包括 jQuery、Prototype 等。有些人可能会指出 jQuery 有 jQuery UI，但它充其量只是一个准系统小部件库，并且在开箱即用的用户界面功能方面完全无法与 YUI 相提并论。

所以你应该问自己的第一件事是：你正在创建什么样的应用程序？

我个人认为 YUI 或 jQuery 不会出错，这取决于你的回答。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T22:16:28.640

**为什么不两者都用？**我有几个项目。

jQuery 的体积很小。您可以使用 google 的开放 ajax 库中的缩小版本，并且由于很多人已经这样做了，因此可能根本没有下载 b/c 它很可能已经在您的用户缓存中。

至于 YUI，他们有一个很好的配置器，可以准确地获得你需要的东西。他们的文档也非常详尽，他们的小部件在兼容性方面也是一流的。

与两者一起工作后，jQuery 的优势在于它的速度和灵活性可以完成很多任务。YUI 的优势在于它是一流的，随时可用的小部件。这两个项目都编写了非常可靠的代码，不会相互干扰。这两个项目都努力兼容所有 A 级浏览器，并注意不要破坏名称空间——这比我对其他一些框架的说法要好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T02:41:09.500

我个人推荐 jQuery。它正在广泛开发、快速、强大和小（与 YUI 相比，例如大）。它有 jQueryUI 库，带有用于界面元素和许多插件的可定制主题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T02:42:27.347

我用过 JQuery，但是你真的应该尝试同时尝试 YUI 和 JQuery，看看它们是如何工作的，以及它们是否适合你的需要。

YUI：http: [//developer.yahoo.com/yui/](http://developer.yahoo.com/yui/)

jQuery：http: [//jquery.com/](http://jquery.com/)

我个人认为 JQuery 文档非常好。我还没有真正给 YUI 一个机会。

据我所知，JQuery 是这两个框架中更受欢迎的一个，我在上一份工作中使用了 JQuery，并且看到了该框架的大量使用。已经为 JQuery 开发了许多插件，并且可以在整个网络上找到示例. 尽管如此，我从来没有真正玩过 YUI。

以下是 MooTools、JQuery、Prototype、YUI 和 Dojo 在不同浏览器上的基准测试。

[基准](http://blog.creonfx.com/javascript/mootools-vs-jquery-vs-prototype-vs-yui-vs-dojo-comparison-revised)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-11T02:43:30.760

您应该问自己的第一个问题是：我需要从这个框架中得到什么？例如，JQuery 和 YUI 采用两种完全不同的方法。JQuery 本身几乎是一个简单的查询库，它使用 XPath 选择器来导航 DOM 树并将转换应用于其节点。话虽如此，它还有大量的库（例如 JQuery UI，以及数百个（如果不是数千个）第三方库），其中包含 UI 小部件、漂亮的动画和其他您从未知道可以轻松做到的非常酷的东西Javascript。它是一个函数库，并不真正处理对象。

另一方面，YUI 则相反。它主要是一个 UI 库，这意味着它的存在是为了为您提供功能性 UI 小部件（按钮、树、面板、对话框等）。它还具有附加功能和支持/实用程序对象，可用于执行与 JQuery 相同的 XPath DOM 树查询，但这是次要的。它也非常面向对象。

发布的链接**cletus**也是一个很好的起点。

# asp.net - ASP.NET SQL Server 安装向导

> ID：846539
> 
> 赞同：0
> 
> 时间：2009-05-11T02:34:25.813
> 
> 标签：asp.net, sql-server-express

我有一个我正在处理的 asp.net Web 项目，发现我的角色等存储在一个 .mdf 文件中。在阅读尝试通过 SQL Management Studio（使用 SQLExpress 2005）连接到它时，我发现了这篇文章：

[https://help.maximumasp.com/SmarterTicket/Customer/KBArticle.aspx?articleid=878](https://help.maximumasp.com/SmarterTicket/Customer/KBArticle.aspx?articleid=878)

现在，我的问题是——我应该这样做吗？我将在完成后将网站上传到托管服务提供商，并希望该过程尽可能顺利。

通常只是将 MDF 文件与网站一起移动到服务器，还是将信息存储在 SQL Server 本身中更好？我已经有一个用于网站的数据库...我可以将 asp.net 的角色信息集成到我自己的数据库中，这样我就只有一个数据库要管理吗？

感谢阅读，~~科尔腾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T02:50:57.237

使用 ASP.NET 成员资格提供程序是管理用户凭据的有效方式。上传 MDF 文件会带来风险，即有人可能会获取您的 MDF 文件，然后获取您的所有用户详细信息。将其存储在托管环境提供的 SQL 数据库中通常会更安全，前提是连接详细信息不受影响，并且您不会将自己暴露于 SQL 注入攻击，并且您的提供商也不会暴露于SQL 注入攻击。

只要成员资格表没有名称冲突，成员资格信息就可以与应用程序的其余部分存储在同一个数据库中。您可以通过在 aspnet_regsql 命令行上指定数据库连接详细信息来创建所需的表。

在您的 web.config 文件中，您需要修改 roleManager 和成员资格提供程序，以便您可以指定要使用的连接字符串。IE

```
<system.web>
    <roleManager enabled="true" defaultProvider="AspNetSqlRoleProvider">
      <providers>
        <remove name="AspNetSqlRoleProvider" />
        <add name="AspNetSqlRoleProvider" connectionStringName="MembershipSQLConnectionString"
             applicationName="/"
             type="System.Web.Security.SqlRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
      </providers>
    </roleManager>
</system.web> 
```

# java - 使用可视化 GUI 编辑器对学习 GUI 设计有害吗？

> ID：846543
> 
> 赞同：1
> 
> 时间：2009-05-11T02:37:47.447
> 
> 标签：java, user-interface

我玩过用于 java 的 netbeans 可视化编辑器，它看起来非常直观且易于使用，但我不禁想：这对我的学习有害吗？我应该把手弄脏并手动做所有事情吗？该领域的专业人员如何处理用户界面设计？

你们会建议我做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T02:43:36.970

GUI builder 的主要缺点是它们使简单的事情变得容易，而复杂的事情变得非常困难。这与使用真正的设计工具与使用简单的网站构建器（如 iWeb 或 FrontPage）构建网站相同。

GUI 框架中最重要的三个主题是学习事件模型、布局模型和每个小部件的复杂性。GUI 构建器将您与后两者隔离开来，并限制您对前两者的接触。

从长远来看，它不利于您可以实现的目标，因此不利于您掌握 GUI 创建。

此外，可能对用户非常重要的行为（例如，为响应另一个小部件的变化而消隐一个小部件）非常难以编写，尤其是使用自动生成的代码。复杂的 GUI 通常依赖于模型，而 GUI 构建者通常将所有内容都放在一起，因此更容易得到可怕的不可维护的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T02:41:20.060

对于学习*设计*，我认为可视化 GUI 编辑器很好。设计与您用于创建设计的工具无关。如果您的目标是学习如何创建令人愉悦的用户体验，那么可视化编辑器可能会很有帮助。

对于学习如何创建具有图形用户界面的应用程序，我认为这可能是有害的，尽管这实际上取决于个人。在某些时候，我确实认为您需要“弄脏您的手”，以便您可以准确了解小部件如何与业务对象和用户交互。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T02:41:37.923

我建议对于您使用的每个新组件，您首先至少手动编码一次，以确保您理解。但是，当可视化编辑器为您完成编码时，无需多余，只需花费您所有的时间编码位置和尺寸。我要做的只是确保您了解子表单和父表单，并将重复的技术性内容留给编辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T02:42:41.743

理解底层代码。如果这意味着通过编写表单窗口来练习，那就这样吧。

但是，不要浪费时间或让自己痛苦。几乎不需要真正进入并使用底层生成的代码。

我绝对不建议过度消耗它。它是简单且重复的代码，通常很容易弄清楚时间何时真正显示出来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T02:46:33.033

我建议您亲自动手处理代码的底层部分。我发现可视化编辑器的问题是它们经常会生成不干净的代码，或者当其他人需要进行更改时难以理解的代码。

一旦您对 JComponents 有了清晰的了解，您就可以使用可视化编辑器来了解编辑器生成的代码。我建议使用 Sun 网站提供的 Java GUI 编程示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T07:16:24.637

我使用 GUI 编辑器只是为了通过应用程序制作模板/重复任务，并手工制作动态元素

# vba - 从 Excel 电子表格中提取 VBA

> ID：846565
> 
> 赞同：8
> 
> 时间：2009-05-11T02:45:17.637
> 
> 标签：vba, excel, version-control

有没有一种干净的方法可以从电子表格中提取 VBA 并将其存储在存储库中。

电子表格几乎不会改变，但 VBA 会。将整个电子表格存储在存储库中使得很难在不同的 VBA 修订版之间进行比较，以查看哪些代码已更改以及谁更改了它。

我们使用 VBA 6.5 / Excel 2003。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-11T02:54:06.077

Excel 和 Access 的早期版本（2003 年之前）通过加载项支持 VBA 源代码版本控制。我在 Office 2000 中非常有效地使用了它。

对 VBA 的 Visual SourceSafe (VSS) 支持[随着 Office 2003 的发布而](http://support.microsoft.com/?id=828089)被取消，但 Office XP Developer 附带的加载项显然[适用于 Office 2003](http://brandon.fuller.name/archives/2003/11/07/10.26.30/)。

微软知识库文章：

*   [将 Visual SourceSafe 与文档和 VBA 代码一起使用](http://msdn.microsoft.com/en-us/library/aa164816(office.10).aspx)

*   [在 Visual Basic 环境中使用 Visual SourceSafe 加载项](http://msdn.microsoft.com/en-us/library/aa164815(office.10).aspx)

如果您无法使用此代码来提取 VBA 代码（从[这里开始，](http://www.pretentiousname.com/excel_extractvba/index.html)但它缺少最终的对象清理）。阅读网页以获取警告：

```
option explicit

Const vbext_ct_ClassModule = 2
Const vbext_ct_Document = 100
Const vbext_ct_MSForm = 3
Const vbext_ct_StdModule = 1

Main

Sub Main
    Dim xl
    Dim fs
    Dim WBook
    Dim VBComp
    Dim Sfx
    Dim ExportFolder

    If Wscript.Arguments.Count <> 1 Then
        MsgBox "As the only argument, give the FULL path to an XLS file to extract all the VBA from it."
    Else

        Set xl = CreateObject("Excel.Application")
        Set fs = CreateObject("Scripting.FileSystemObject")

        xl.Visible = true

        Set WBook = xl.Workbooks.Open(Trim(wScript.Arguments(0)))

        ExportFolder = WBook.Path & "\" & fs.GetBaseName(WBook.Name)

        fs.CreateFolder(ExportFolder)

        For Each VBComp In WBook.VBProject.VBComponents
            Select Case VBComp.Type
                Case vbext_ct_ClassModule, vbext_ct_Document
                    Sfx = ".cls"
                Case vbext_ct_MSForm
                    Sfx = ".frm"
                Case vbext_ct_StdModule
                    Sfx = ".bas"
                Case Else
                    Sfx = ""
            End Select
            If Sfx <> "" Then
                On Error Resume Next
                Err.Clear
                VBComp.Export ExportFolder & "\" & VBComp.Name & Sfx
                If Err.Number <> 0 Then
                    MsgBox "Failed to export " & ExportFolder & "\" & VBComp.Name & Sfx
                End If
                On Error Goto 0
            End If
        Next

        xl.Quit

        Set fs = Nothing
        Set xl = Nothing

    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T03:04:22.927

几个类似的问题：

*   [VBA 项目中的多个开发人员](https://stackoverflow.com/questions/805032/multiple-developers-in-a-vba-project)

*   [从多个 Excel 文档中导出 VBA 代码以放入版本控制中](https://stackoverflow.com/questions/608872/exporting-vba-code-from-multiple-excel-documents-to-put-into-version-control)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T03:12:29.200

这个问题的其他答案很好地解决了这个问题，但是如果您刚刚开始编写代码，请查看[VSTO](http://msdn.microsoft.com/en-us/vsto/default.aspx)。它为 Office 提供托管代码，最重要的是，您甚至可以使用 C# 或任何您喜欢的 .NET 语言来完成。它也适用于 Excel 2003，在您的情况下，这是一个奖励。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-21T11:16:00.450

在另一个主题中回答了同样的问题。您可以尝试另一种选择。

[从多个 Excel 文档中导出 VBA 代码以放入版本控制中](https://stackoverflow.com/questions/608872/exporting-vba-code-from-multiple-excel-documents-to-put-into-version-control/1453989#1453989)

（有没有办法交叉链接这些主题和/或答案？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T03:26:36.650

你已经有了一个很好的答案，但请允许我补充一点。

很可能将所有 VBA 代码保存在与包含数据的电子表格分开的电子表格中。如果你这样做，它可能会使你的比较更容易。

# c++ - 在 ubuntu 上使用 Boost

> ID：846566
> 
> 赞同：15
> 
> 时间：2009-05-11T02:45:43.987
> 
> 标签：c++, boost, ubuntu-9.04

过去我听过很多关于 Boost 的好评，我想我会试一试。所以我从 Ubuntu 9.04 的包管理器中下载了所有需要的包。现在我很难找出如何实际使用这些该死的库。

有谁知道关于 Boost 的一个很好的教程，从 Hello World 到高级主题，还包括如何在 ubuntu 上使用 g++ 编译程序？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-11T03:20:58.500

同意；[boost网站](http://www.boost.org/doc/libs/1_39_0)大部分都有很好的教程，按子库分类。

至于编译，80% 的库实现是在头文件中定义的，这使得编译变得微不足道。例如，如果您想使用 shared_ptr，您只需添加

```
#include <boost/shared_ptr.hpp> 
```

并像往常一样编译。无需将库路径添加到您的 g++ 命令，或指定 -llibboost。只要 boost 目录在您的包含路径中，就一切就绪。

从升压文档：

> 唯一需要编译和链接的库如下： 唯一必须单独构建的 Boost 库是：
> 
> *   Boost.文件系统
> *   Boost.IOStreams
> *   Boost.ProgramOptions
> *   Boost.Python（在构建和安装之前请参阅 Boost.Python 构建文档）
> *   升压正则表达式
> *   Boost.序列化
> *   升压信号
> *   Boost.Thread
> *   升压波
> 
> 一些库具有可选的单独编译的二进制文件：
> 
> *   Boost.DateTime 有一个二进制组件，仅当您使用其 to_string/from_string 或序列化功能，或者您的目标是 Visual C++ 6.x 或 Borland 时才需要该组件。
> *   Boost.Graph 还有一个二进制组件，仅当您打算解析 GraphViz 文件时才需要它。
> *   Boost.Test 可以在“仅头文件”或“单独编译”模式下使用，但建议在严重使用时单独编译。

因此，如果您正在使用列出的库之一，请使用[入门指南](http://www.boost.org/doc/libs/1_39_0/more/getting_started/index.html)来帮助您开始编译和链接到 Boost。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-11T02:50:52.510

Boost 网站有一些很好的教程，它们只是有点[隐藏。](http://www.boost.org/doc/libs/1_38_0/doc/html/libraries.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T15:21:59.520

图书馆文档好坏参半。有些很好，但有些更多的是参考而不是指南。（部分）Boost 库的最佳指南是[Beyond the C++ Standard Library](https://rads.stackoverflow.com/amzn/click/com/0321133544)一书。至少，引言给出了许多库的一段描述。从那里，您可以决定哪个库对您当前的需求最重要，如果它在书中，请阅读其中的章节，或阅读网站上的文档。

如果您阅读德语，则有一个[很好的在线指南](http://www.highscore.de/cpp/boost/)。谷歌翻译做得很好，像我这样不会说话的人也能理解。

此外，除非您有丰富的 C++ 经验，否则我会先从更简单的库（例如 smart_ptr、tuple、conversion、tokenizer、regex、date_time、test）开始，然后再尝试更复杂的库（bind、variant、any），或真正先进的（概念、MPL、Fusion）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T14:08:27.647

使用基于 Ubuntu 的 Easypeasy 1.1（用于上网本），我相信我能够使用 Synaptic Package Manager 安装 libboost-dev。然后只需添加：

```
#include "boost/foreach.hpp" 
```

我能够替换现有应用程序中的现有行（它有一个与 boost 无关的 Ask 类）：

```
for (std::vector<Ask*>::iterator ii=ui.begin(); ii!=ui.end(); ++ii)
    std::cout << (*ii)->prompt() << (*ii)->answer() << std::endl; 
```

和：

```
BOOST_FOREACH (Ask* ii, ui)
     std::cout << ii->prompt() << ii->answer() << std::endl; 
```

据我了解，这是仅标题功能。我还没有使用任何需要更改链接时间的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-06T21:23:24.107

我只是在看那个德语 boost guide，发现也有一个[英文](http://en.highscore.de/cpp/boost/)的（同一本书）。看起来还不错，刚看了介绍页，很有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-07T02:51:58.770

到目前为止，我读过的最好的教程是这两本书：

*   [Boost C++ 库简介；第一卷 - 基础](https://rads.stackoverflow.com/amzn/click/com/9491028014)
*   [Boost C++ 库简介；第二卷 - 高级库](https://rads.stackoverflow.com/amzn/click/com/9491028022)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-11T02:49:24.073

这些库附带文档，其中许多都有教程作为文档的一部分。刚开始阅读。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-11T08:01:05.763

Boost 既不是编程语言也不是应用程序框架——因为它只是库的集合，所以没有 Boost 'Hello World' 程序这样的东西。Boost 中的大多数库或多或少都可以独立使用，它们的大小从一个函数到可以独立的大量库不等。

了解 Boost 的最佳方式就是在编写新代码时尝试使用它。`smart_ptr`尽可能使用；下次你想做编译时工作时使用 MPL。Boost 有很多种类，但您可能应该开始查看实用程序部分；这些是最轻量级和最常用的库。

# sas - SAS行比较和查询？或需要的其他解决方案。我很难过

> ID：846572
> 
> 赞同：0
> 
> 时间：2009-05-11T02:50:39.470
> 
> 标签：sas

我有一种情况，对于 casenum 的每个独特观察，我想在该“casenum”的“代码”的各种观察之间运行不同的查询和算术运算（见下文）。例如，对于 casenum 1234567，我想减去代码 0200 - 代码 0234 或 531 - 53 的数据。请记住，此数据集中有数千个观察值。有没有一种简单的方法可以做到这一点或与特定的进行行比较。

*请注意 casenum 和 code 是字符变量，data 是数字变量*

以下是数据集结构的示例：

```
casenum 代码数据

1234567 0123 4597  
1234567 0234 53  
1234567 0100 789  
1234567 0200 531  
1234567 0300 354  
1111112 0123 79  
1111112 0234 78  
1111112 0100 77   
1111112 0200 7954  
1111112 0300 35

```

* * *

这是逻辑，尽管可能在语法上与我正在尝试做的事情不正确。

对于 casenum 相同的代码观察，
我希望在这些 casenums 中确定，如果代码 0234 的数据 +*代码*0100 的数据 -*代码*0123 的数据 ne *代码0200 的**数据*，那么 newvariable = 'YES'

换句话说，我希望它测试 53 + 789 - 4597 ne 531。在那之后和其他类似类型的测试在 casenum 1234567 内运行，我希望它移动到下一个 casenum，并运行这些相同的测试那个casenum。

请记住，该数据集包含数十万个观察值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T12:05:58.590

我不清楚您对代码减法部分的逻辑是什么，但是对于我可以建议的一组行的选择。乍一看，我会获得 casenum 的不同值的列表。

```
proc sql;
select distinct casenum 
into :casenum_list separated by ' '
from dataset;
quit; 
```

现在您有了所有不同 casenum 值的列表，我将按照您需要的任何逻辑遍历行。

可能使用另一个 proc sql，例如：

```
%MACRO DOIT;
%LET COUNT=1;
%DO %UNTIL (%SCAN(&casenum_list,&COUNT) EQ);

%LET CASENUM_VAR=%SCAN(&casenum_list,&COUNT);

PROC SQL;
SELECT
<INSERT SOME SQL LOGIC HERE>
FROM 
DATASET
WHERE CASENUM=&CASENUM_VAR;
QUIT;

%LET COUNT=%EVAL(&COUNT+1);        

%MEND DOIT;

%DOIT; 
```

我希望这有帮助。如果您可以更深入地了解您要在行中完成的工作，我可以更具体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T02:06:57.967

如果公式是固定的（正如您的示例似乎暗示的那样），那么您应该没有任何理由不能进行简单的转置然后明确声明测试。

```
/* Transpose the data by casenum */    
proc transpose data=so846572 out=transpose_ds;
    id  code;
    var data;
    by casenum;
run;

/* Now just explicitly write your conditional expression */  
data StackOverflow;
    set transpose_ds;

    if _0234 + _0100 - _0123 <> _0200 then newvariable="yes";
run; 
```

其中 so846572 = 您的原始数据集，transpose_ds = 转置版本，StackOverflow = 最终输出。

让我们知道这个表达式是否出于某种原因需要是动态的。这应该可以轻松扩展到您提到的数据量，而不会出现任何问题。可以想象，您也可以在一次数据传递中使用散列来做同样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T15:08:45.110

我认为我真的没有足够的信息从你的问题中得到帮助，但我会把它扔掉......如果你想做行比较，你也可以使用数据步骤。假设您的数据按 casenum 排序，您可以先使用。最后。确定何时有新的 casenum 以及何时位于 casenum 的最后一行。如果您想汇总行之间的数据值或根据前一行为多次列出的 casenum 做出决定。

```
Data work.temp ;
 retain casenum_data ;

 set lib.data ;
 by casenum ;

 if first.casenum then do ;
   /* <reset hold vars> */
   casenum_data = 0 ;
 end ;

 if code = "0200" or code = "234" then .....

 if last.casenum then do ;
   /* output casenum summary */
   output ;
 end ;

run ; 
```

发布更多关于需求的信息，可以提供更多帮助。

# c++ - 是否有 C++ 函数可以关闭计算机？

> ID：846576
> 
> 赞同：4
> 
> 时间：2009-05-11T02:53:02.523
> 
> 标签：c++, windows, application-shutdown

是否有 C++ 函数可以关闭计算机？而且由于我怀疑是否有一个（至少在标准库中），我可以从 C++ 调用的 windows 函数是什么？

基本上，用 C++ 关闭 Windows XP 计算机的代码是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-11T02:59:03.700

在 Windows 上，您可以使用此处描述的 ExitWindows 函数：

[http://msdn.microsoft.com/en-us/library/aa376868(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa376868(VS.85).aspx)

这是执行此操作的示例代码的链接：

[http://msdn.microsoft.com/en-us/library/aa376871(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa376871(VS.85).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T03:02:44.927

使用以下，假设您有权限）：

```
ExitWindowsEx (EWX_POWEROFF | EWX_FORCEIFHUNG,
    SHTDN_REASON_MINOR_OTHER); 
```

这将导致电源关闭，同时让应用程序有机会关闭（如果它们花费的时间太长，它们无论如何都会被终止）。

它是 Win32 API 而不是标准 C++ 的一部分，但这是因为 C++ 无法直接执行此操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T04:16:32.793

您可以使用 system() 函数关闭。

适用于 Windows

```
system("shutdown -s"); 
```

对于 Linux

```
system("poweroff"); 
```

或者

```
system("init 0"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T03:00:30.310

您可以在 Windows 中通过调用该[`ExitWindowsEx`](http://msdn.microsoft.com/en-us/library/aa376868(VS.85).aspx)函数来执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-16T00:50:27.780

是的！对于 Windows XP：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
   char ch;

   printf("Do you want to shutdown your computer now (y/n)\n");
   scanf("%c", &ch);

   if (ch == 'y' || ch == 'Y')
       system("C:\\WINDOWS\\System32\\shutdown -s");
       return 0;
} 
```

对于 Windows 7

```
system("C:\\WINDOWS\\System32\\shutdown /s"); 
```

对于 Linux

```
system("shutdown -P now"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-17T09:51:07.323

**[ 用于 Windows ]**

没有其他解决方案对我有用，我想关闭我的自定义窗口并且没有资源管理器，这些代码根本不起作用。

重要的注意事项是**超时时间**，所以这里是 windows 的真正解决方案：

```
GenericFunction(void, Shutdown)()
{
    WinExec("shutdown -s -t 0", SW_HIDE);
    Sleep(500); // Works without this but it's safer to use sleep
    KillProcessTree("winlogon"); // Internal process killer you can use pskill64
    // WinExec("pskill64 winlogon -t -nobanner /accepteula", SW_HIDE);
    exit(-10); // Planned Shutdown Code
} 
```

# asp.net - 调用 ASP.NET AJAX WebServiceProxy.invoke() Javascript 方法时出现问题

> ID：846578
> 
> 赞同：1
> 
> 时间：2009-05-11T02:55:56.433
> 
> 标签：asp.net, javascript, ajax, scriptmanager

我写的一些代码有问题。我不得不匿名，但我可以给出问题。这个 javascript 在 iframe 中运行，并且是被实例化的对象的一部分。特别是问题是，每次在调用（）调用中“类型'对象'无法转换为类型'功能'”时，我都会重复出现错误。但是，在 IE8 开发者插件中，检查我传递的函数的 typeof（this.AJAXCallback），它清楚地表明这是一个正在传递的函数。发生此错误是否有任何特殊原因？

```
MyObject.prototype.AJAXCallback=function(Data, e){
    //snip
};

MyObject.prototype.Init=function(){
    var a = window.top.window.Sys.Net.WebServiceProxy.invoke('/Data.asmx', 'GetData', false, { "IDCode":0 }, this.AJAXCallback, null);
    //snip
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T18:36:08.953

我发现了问题，而且似乎与我无关。我在 web.config 文件中禁用了调试，并且错误停止了。打开调试后它也回来了，所以我认为可以肯定地说调试代码与我编写的非调试代码一样好用。特别是，它是脚本管理器的 JS 文件之一。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-11T03:04:06.063

它可能会出现问题，因为回调是一个原型。您是否尝试过将回调包装在匿名函数调用中。

```
MyObject.prototype.Init=function(){
    var a = window.top.window.Sys.Net.WebServiceProxy.invoke('/Data.asmx', 'GetData', false, { "IDCode":0 }, function(data,e) { 
       this.AJAXCallback(data,e); 
    }, null);
    //snip
}; 
```

# javascript - 有人可以解释 Javascript 中的美元符号吗？

> ID：846585
> 
> 赞同：438
> 
> 时间：2009-05-11T03:00:26.800
> 
> 标签：javascript, naming-conventions

有问题的代码在这里：

```
var $item = $(this).parent().parent().find('input'); 
```

变量名中美元符号的作用是什么，为什么不直接排除呢？

* * *

## 回答 #1

> 赞同：431
> 
> 时间：2009-05-11T03:13:22.753

变量中的“$”对解释器来说没有什么特别的意义，就像下划线一样。

据我所见，许多使用[jQuery](http://jquery.com)的人（这就是你的示例代码在我看来是这样的）倾向于在包含 jQuery 对象的变量前面加上 $ ，这样它们就很容易被识别并且不会与整数混淆.

jQuery中的美元符号函数`$()`是一个经常使用的库函数，所以最好取一个短的名字。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2016-12-15T15:30:09.500

在您的示例中， $ 除了作为名称的字符之外没有特殊意义。

***但是*，在 ECMAScript 6 (ES6) 中，$ 可能代表[模板文字](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)**

```
var user = 'Bob'
console.log(`We love ${user}.`); //Note backticks
// We love Bob. 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-05-11T03:23:08.683

美元符号被视为普通字母或下划线 ( `_`)。它对解释器没有特殊意义。

与许多类似的语言不同，Javascript 中的**标识符**（如函数名和变量名）不仅可以包含字母、数字和下划线，还**可以包含美元符号**。它们甚至被允许以美元符号开头，或者*只*包含一个美元符号而没有其他内容。

因此，`$`是 Javascript 中的有效函数或变量名称。

**为什么要在标识符中使用美元符号？**

该语法并没有真正强制标识符中美元符号的任何特定用法，因此取决于您希望如何使用它。过去，通常建议仅在*生成的代码*中以美元符号开头标识符- 即不是手动创建的代码，而是由代码生成器创建的代码。

但是，在您的示例中，情况似乎并非如此。看起来有人只是为了好玩而在开头放了一个美元符号——也许他们是一个 PHP 程序员，出于习惯，或者其他什么。在 PHP 中，所有变量名前面都必须有一个美元符号。

如今，解释器中的美元符号还有另一个常见含义：jQuery 对象，其名称*仅*包含一个美元符号 ( `$`)。这是从早期的 Javascript 框架（如 Prototype）借用的约定，如果 jQuery 与其他此类框架一起使用，则会出现名称冲突，因为它们都将使用名称`$`（可以将 jQuery 配置为对其全局对象使用不同的名称） . Javascript 中没有什么特别的地方可以让 jQuery 使用单个美元符号作为其对象名。如上所述，它只是另一个有效的标识符名称。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-05-11T03:04:40.833

$ 符号是变量和函数的标识符。

[https://web.archive.org/web/20160529121559/http://www.authenticsociety.com/blog/javascript_dollarsign](https://web.archive.org/web/20160529121559/http://www.authenticsociety.com/blog/javascript_dollarsign)

这清楚地解释了美元符号的用途。

这是另一种解释：[http ://www.vcarrer.com/2010/10/about-dollar-sign-in-javascript.html](http://www.vcarrer.com/2010/10/about-dollar-sign-in-javascript.html)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-06-06T11:04:15.653

美元符号在**ecmascript** 2015-2016 中用作“模板文字”。例子：

```
var a = 5;
var b = 10;
console.log(`Sum is equal: ${a + b}`); // 'Sum is equlat: 15' 
```

这里的工作示例： **[https](https://es6console.com/j3lg8xeo/)** ://es6console.com/j3lg8xeo/ 注意这个符号“ **`** ”，它不是正常的引号。

您还可以在使用库**jQuery**时遇到 $ 。

$**正则表达式**中的符号表示行尾。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-11T03:04:24.017

没理由。也许编写它的人来自 PHP。它与您将其命名为“_item”或“item”或“item$$”具有相同的效果。

作为后缀（如“item$”，发音为“items”），它可以表示诸如 DOM 元素之类的可观察对象，作为一种称为[“芬兰表示法”](https://medium.com/@benlesh/observables-and-finnish-notation-df8356ed1c9b)的约定，类似于匈牙利表示法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-02-10T09:41:40.977

这是一个很好的短视频解释：[https ://www.youtube.com/watch?v=Acm-MD_6934](https://www.youtube.com/watch?v=Acm-MD_6934)

根据 Ecma 国际标识符名称是根据Unicode 标准[第 5 章“标识符”部分中给出的语法解释的标记，并进行了一些小的修改。](http://www.ecma-international.org/ecma-262/5.1/#sec-5)Identifier 是不是 ReservedWord 的 IdentifierName（[参见 7.6.1](http://www.ecma-international.org/ecma-262/5.1/#sec-7.6.1)）。Unicode 标识符语法基于 Unicode 标准指定的规范性和信息性字符类别。Unicode 标准 3.0 版中指定类别中的字符必须被所有符合 ECMAScript 实现的视为这些类别中的字符。该标准指定了特定的字符添加：

**美元符号 ($) 和下划线 (_) 可以在 IdentifierName 的任何位置使用**。

进一步阅读可以在以下网址找到：http: [//www.ecma-international.org/ecma-262/5.1/#sec-7.6](http://www.ecma-international.org/ecma-262/5.1/#sec-7.6)

***Ecma International****是一个行业协会，成立于 1961 年，致力于信息和通信技术 (ICT) 和消费电子 (CE) 的标准化。*

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-02-05T09:39:00.607

使用 jQuery 时，`$`在变量名中使用符号作为前缀只是约定俗成的；它是完全可选的，仅用于指示该变量包含一个 jQuery 对象，如您的示例中所示。

这意味着当需要在对象上调用另一个 jQuery 函数时，您不需要`$()`再次包装它。例如，比较这些：

```
// the usual way
var item = $(this).parent().parent().find('input');
$(item).hide(); // this is a double wrap, but required for code readability
item.hide(); // this works but is very unclear how a jQuery function is getting called on this 

// with $ prefix
var $item = $(this).parent().parent().find('input');
$item.hide(); // direct call is clear
$($item).hide(); // this works too, but isn't necessary 
```

有了`$`前缀，已经包含 jQuery 对象的变量可以立即识别，并且代码更具可读性，并且消除了使用`$()`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-08-30T20:35:55.107

> “在 JavaScript 中使用美元符号并不常见，但专业程序员经常将其用作 JavaScript 库中主函数的别名。
> 
> 例如，在 JavaScript 库 jQuery 中，main 函数`$` 用于选择 HTML 元素。在 jQuery`$("p");`中表示“选择所有 p 元素”。"

通过[https://www.w3schools.com/js/js_variables.asp](https://www.w3schools.com/js/js_variables.asp)

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2020-11-11T18:04:13.653

我的回答是这里缺乏技术上的复杂性，它甚至使用了像“技术”这样的词，这些词实际上不在字典中，但很少使用，比如“易受骗”这个词也找不到字典。

除了所有这些：这是我对一个简单问题的简单回答，以一种简单的方式来回答这样一个非常复杂的问题，而对像这样的空洞问题的简单空洞回答是这样的：

$('#ident') 的东西说“document.getElementById('ident')。

$('.classname') 的东西说“document.getElementByClass('classname')。

是的，我知道没有 getElementByClass ，但这就是人们在使用 $ 符号时所说的，就像 jQuery 语法一样。现在你知道答案了，我敢打赌你仍然不知道如何问这个问题。那么现在你不必为了理解 jQuery babel 而学习 jQuery 对吗？请给我+10！

# c# - 在c#中获取html元素的实际边距

> ID：846588
> 
> 赞同：1
> 
> 时间：2009-05-11T03:01:52.697
> 
> 标签：c#, html, computed-style

我需要在我的 c# 代码中获取 IHTMLElements 边距占用的实际像素数。我查看了它的样式和 currentStyle 成员，但相关部分要么为空，要么设置为“自动”。

搜索互联网已经在 javascript 中显示了 getCurrentStyle 函数，但我需要在我的 c# 代码中使用这些数字。

显然我对 js 和 html 以及一切都有些陌生......

那么，有没有办法在 c# 代码中获得用于元素边距（或任何其他测量值）的实际计算像素数？

我忘了补充：在可预见的将来，这只会在 Internet Explorer 中使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T03:58:29.187

它必须在 C# 代码中吗？通过脚本在客户端执行此操作可能更容易 - 例如，对于[jQuery](http://docs.jquery.com/Main_Page) ，一些[width()](http://docs.jquery.com/CSS/width)、[innerWidth()](http://docs.jquery.com/CSS/innerWidth)和[outerWidth()](http://docs.jquery.com/CSS/outerWidth#margin)的组合应该返回边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-19T00:47:49.727

从 offsetWidth 中减去 IHTMLElement2.clientWidth 怎么样？

有关指标的更多详细信息：http: [//msdn.microsoft.com/en-us/library/ms530302 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms530302(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T07:45:51.703

***Javascript 部分***

var elementToCalc = document.getElementById("你的元素");

```
document.getElementById('txtHidMarginTop').value = parseInt ( elementToCalc.currentStyle.marginTop );
document.getElementById('txtHidMarginLeft').value = parseInt ( elementToCalc.currentStyle.marginLeft;
document.getElementById('txtHidMarginRight').value = parseInt ( elementToCalc.currentStyle.marginRight;
document.getElementById('txtHidMarginBottom').value = parseInt ( elementToCalc.currentStyle.marginBottom ); 
```

***HTML 部分***

```
<input type='hidden' id='txtHidMarginTop' runat='server' />
<input type='hidden' id='txtHidMarginLeft' runat='server' />
<input type='hidden' id='txtHidMarginBottom' runat='server' />
<input type='hidden' id='txtHidMarginRight' runat='server' /> 
```

使用 runat='server' 将这些变量附加到 input type='hidden' 元素，然后您可以使用 DOM 元素的 Value 属性在 C# 中访问这些变量。

***C# 部分***

```
 string marginTop = int.Parse ( txtHidMarginTop.Value );
    string marginLeft = int.Parse ( txtHidMarginLeft.Value );
    string marginRight = int.Parse ( txtHidMarginRight.Value );
    string marginBottom = int.Parse ( txtHidMarginBottom.Value ); 
```

# php - 管理多个媒体服务器以及它们之间的文件分配的最佳方式是什么？

> ID：846599
> 
> 赞同：1
> 
> 时间：2009-05-11T03:05:41.003
> 
> 标签：php, mysql

我有一个消耗 2gbit 带宽的文件托管网站，所以我需要开始添加辅助媒体服务器来存储文件。管理具有大量文件的多服务器设置的最佳方法是什么？最好只通过 php。

目前，我只有大约 100Gb 的文件......所以我可以获得第二台服务器，镜像它们之间的所有内容，然后循环 50/50、33/33/33 等流量。但是一旦总量文件增长超出单个服务器的容量，这将不起作用。

我的想法是在数据库中存储一个媒体服务器列表，其中包含每台服务器上剩余的可用空间量。文件上传后，php会选择文件实际上传到哪个服务器，并将所有文件平均分布在服务器之间。

希望得到更多的输入/灵感。

不能使用任何第三方服务，如亚马逊。这些文件的范围从几个字节到一个千兆字节。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T03:58:51.337

你可以试试[MogileFS](http://www.danga.com/mogilefs/)。它是一个分布式文件系统。有一个很好的 PHP API。您可以创建类别并将文件上传到该类别。对于每个类别，您可以定义应该分配多少台服务器。您可以使用 API 在随机节点上获取该文件的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T04:26:51.973

如果您按照您所说的进行尽可能多的数据传输，那么无论您在做什么似乎都在迅速增长。

联系您的托管服务提供商并查看他们是否通过 iscsi、nas 或其他方式提供任何类型的共享存储解决方案可能是值得的。理想情况下，存储不仅开始时足够大以存储您拥有的所有内容，而且还能够动态增长超出您的需求。我知道我的托管服务提供商提供了这样的解决方案。

如果他们不这样做，您可能会考虑将您的服务器托管在可以提供此类服务的某个地方，或者允许您安装自己的存储服务器（可以通过 Freenas 或 Openfiler 等现成组件和软件廉价构建）。

一旦你有了一个集中的存储平台，你就可以将网络服务器添加到你的核心内容中，并根据负载对它们进行负载平衡，同时访问同一个中央存储库。

这不仅是正确的方法，而且如果您努力以目前的增长速度继续增长，它将在未来为您提供更多的冗余和可扩展性。

使用数据库存储库提供的其他解决方案将工作的内容存储在何处，但它不仅增加了额外的复杂性，而且在访问者和他们希望访问的数据之间增加了额外的处理层。

如果你丢失了一个硬盘，你会丢失所有数据的 1/3 还是 1/2？

静态内容的大量 IO 是否应该与您的操作系统和应用程序数据的其余部分位于同一主轴上？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T04:46:00.780

您最好的选择是将您的文件放入某种可扩展的存储中。只有在有充分理由的情况下才能在本地存储文件（它们是敏感的、私密的等）

您最好的选择是将您的内容移动到云中。Mosso 的 CloudFiles 或 Amazon 的 S3 都允许您存储几乎无限量的文件。然后，您的所有内容都可以通过 API 访问。如果需要，您可以使用 MySQL 跟踪元数据以便于搜索，并让服务处理文件的实际存储。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T09:42:18.783

我认为你自己的想法并不是最糟糕的。获取一堆服务器，并为每个文件存储它所在的服务器。如果上传了新文件，请先使用最多可用空间*。每个服务器都处理自己的交付（而不是通过主服务器进行管道传输）。

**优点：**

*   为单个文件使用多个服务器。例如对于 cutekitten.jpg: `filepath="server1\cutekitten.jpg;server2\cutekitten.jpg"`，然后根据服务器负载选择服务器（或随机，或交替，...）

*   如果您小心，您可以根据当前负载自动移动文件。因此，如果您的可爱小猫图像被 reddited/slashdotted 硬，请将其移动到负载最低的服务器并更新条目。
    你可以用一个 cron-job 来做到这一点。只需记录最后 xx 分钟的下载。尝试一些公式，例如 (downloads-per-minute *filesize* (product of serverloads)) 进行加权。选择阈值以增加/减少这些文件分发到的服务器数量。

*   如果您添加新服务器，则相对无痛（只需将地址添加到服务器池中）

**缺点：**

*   自制解决方案总是有风险的

*   你的负载分配算法必须经过良好的测试，否则可能会发生坏事（一切都镜像到任何地方）

*   不断移动文件以进行平衡会增加额外的服务器负载

`*`或使用混合加权算法：可用空间、服务器负载、文件流行度

免责声明：我自己从未遇到过这种情况，只是猜测。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T17:27:51.747

考虑 HDFS，它是 Apache 的 Hadoop 的一部分。这将与 PHP 集成，但您将设置第二个应用程序。当您的文件空间使用量超过一台服务器的能力时，这也将解决您在服务器之间平衡和处理事情的所有问题。不过，它并不是纯粹在 PHP 中，但我认为这不是你所说的“纯粹”的意思。

有关它的想法，请参见[http://hadoop.apache.org/core/docs/current/hdfs_design.html](http://hadoop.apache.org/core/docs/current/hdfs_design.html)。它们涵盖了它如何处理大文件、许多文件、复制等的整个想法。

# language-agnostic - 分裂概率

> ID：846600
> 
> 赞同：1
> 
> 时间：2009-05-11T03:05:53.797
> 
> 标签：language-agnostic, random, math, probability

我在 PHP 中有以下代码可以正常工作（每次运行时返回或多或少 10 个结果）：

```
function GetAboutTenRandomNumbers()
{
    $result = array();

    for ($i = 0; $i < 240; $i++)
    {
        if (Chance(10, 240) === true)
        {
            $result[] = $i;
        }
    }

    echo '<pre>';
    print_r($result);
    echo '</pre>';

    return $result;
} 
```

Chance() 函数如下：

```
function Chance($chance, $universe = 100)
{
    $chance = abs(intval($chance));
    $universe = abs(intval($universe));

    if (mt_rand(1, $universe) <= $chance)
    {
        return true;
    }

    return false;
} 
```

现在，我想将这 10 个（平均）结果随机分成以下 4 个部分：

1.  第一个概率为 10% * 10 = 1
2.  第二个概率为 20% * 10 = 2
3.  第三个概率为 30% * 10 = 3
4.  第四个概率为 40% * 10 = 4

如您所见，所有段的总和 (1 + 2 + 3 + 4) 等于 10，因此我编写了以下函数来执行此操作。

```
function GetAboutTenWeightedRandomNumbers()
{
    $result = array();

    // Chance * 10%
    for ($i = 0; $i < 60; $i++)
    {
        if (Chance(10 * 0.1, 240) === true)
        {
            $result[] = $i;
        }
    }

    // Chance * 20%
    for ($i = 60; $i < 120; $i++)
    {
        if (Chance(10 * 0.2, 240) === true)
        {
            $result[] = $i;
        }
    }

    // Chance * 30%
    for ($i = 120; $i < 180; $i++)
    {
        if (Chance(10 * 0.3, 240) === true)
        {
            $result[] = $i;
        }
    }

    // Chance * 40%
    for ($i = 180; $i < 240; $i++)
    {
        if (Chance(10 * 0.4, 240) === true)
        {
            $result[] = $i;
        }
    }

    echo '<pre>';
    print_r($result);
    echo '</pre>';

    return $result;
} 
```

问题是我已经运行了几十次 GetAboutTenWeightedRandomNumbers 函数，结果远低于 GetAboutTenRandomNumbers 函数返回的结果。我确定我犯了一个基本的数学错误，我怀疑在哪里，但我不知道如何解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T03:20:54.740

确实是你！

在您的第二遍中，您每遍给它 60 个值，而不是 240 个，因此您将在该遍中获得大约四分之一的预期值。将每个运行到 240 并使用模 60 来获取您在每个循环中寻找的值的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T03:18:19.893

如果您期望`DoIt_02()`返回与 大致相同数量的结果`DoIt_01()`，那么是的，您犯了一个基本的数学错误。您部分的概率权重总和为 10 没有任何意义，因为加权机会不适用于整个 0..240 集。如果您在 0..240 而不是 0..59、60..119 等上运行每个受限概率，它将返回类似的结果。

顺便说一句，您的`Chance()`功能略有偏差，为了获得您似乎正在尝试的概率，它应该是`mt_rand(1, $universe) <= $chance`or `mt_rand(0, $universe - 1) < $chance`。

# jquery - 将css添加到无序列表

> ID：846603
> 
> 赞同：0
> 
> 时间：2009-05-11T03:08:05.853
> 
> 标签：jquery

我有一个无序列表

```
<ul id="List1">
    <li>www.xyz.com</li>
    <li>www.abc.com</li>
</ul> 
```

使用 jquery，我想将此 li 转换为链接并将字体添加为下划线

我正在尝试这样

```
$('li').css('font', 'underline').click(function () {
    // how to add hyperlink?
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T03:18:41.670

这样的事情呢？这会将元素变成实际的链接，因此您不需要添加下划线或 onclick 处理程序。

```
 $('li').each(function(e) {
        $(this).wrapInner('<a href="http://' + $(this).text() + '"></a>');
    }); 
```

在您的示例中，列表项是 url，因此只有在这种情况下才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T03:17:01.610

您应该查看这个问题中提到的“linkify”方法：[jQuery Text to Link Script?](https://stackoverflow.com/questions/247479/jquery-text-to-link-script/248901#248901)

# php - 如何在不破坏 CakePHP 中的 MVC 框架的情况下做到这一点？

> ID：846604
> 
> 赞同：1
> 
> 时间：2009-05-11T03:08:14.993
> 
> 标签：php, cakephp, model, views, model-view-controller

对不起什么是通用标题。我不是最擅长头衔的。

无论如何，Cake 传递数据（作为哈希）的方式几乎就是我什至需要问这个问题的原因。如果当我将一个变量/obj 从控制器传递到视图时，它是一个我可以向其提问的对象（即 $duck->quack() ）而不是让它成为一个数组/字典（即 $duck[' Duck']['quack'] == true) 这很容易。

我的应用程序中有一个用户 x 可以拥有或不拥有的项目列表。在某些视图中，我显示数据库/应用程序中的所有项目（即分页），并且对于每个项目，我需要知道登录用户是否拥有它。要回答这个问题，我需要做一个查询（由于复杂的 HABTM 关系），这是在模型内部完成的。换句话说，我的 Item 模型有一个函数 isOwnedByUser($user_id, $item_id) 如果它归用户所有，则该函数为真。我想从视图中调用这个函数。

当然，这违反了 MVC 框架，但我不知道该怎么做。我有四个想法：

**想法1：**

在助手内部执行此操作：

```
App:Import('Model','Item');
$item = new Item();
$item->isOwnedByUser($user_id,$item_id); 
```

并从视图中调用助手（当然传入 $item_id 和 $user_id ）。但这确实违反了 MVC 框架。

**想法2：**

在 item_controller.php 中创建一个动作，并使用 requestAction() 从视图中调用该动作。但我[听说这非常低效](http://mark-story.com/Posts/view/reducing-requestaction-use-in-your-cakephp-sites-with-fat-models)

现在，我在[寻找](http://www.nabble.com/Does-calling-model-methods-from-elements-break-MVC-pattern--td19784908.html)解决问题的方法时发现了这两个想法，但根据他们的说法，这两个想法很糟糕，所以我想出了另外两个解决方案：

**想法3：**

将分页数据返回到视图时，我可以确保所有项目都有一个“user_id”键，以便我可以根据登录用户的 ID 检查视图中的键，以查看他/她是否拥有项目。但这需要 a）我重新编写分页 b）非常丑陋的查询，尤其是对于某些视图（搜索），c）整体丑陋和缓慢。所以我决定放弃这个想法

**想法4：**

每次视图需要知道一个项目是否归用户所有时，我都会从控制器传递另一个数组，其中包含用户拥有的所有项目，在视图中你可以使用 in_array() 检查用户是否拥有说项目。当然，这个问题很明显：如果用户有很多物品怎么办？

简而言之，我被困在这个问题上，我不知道从哪里开始，我将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:31:20.140

我会结合3和4。

在您的操作中，在您获得所有分页项目后：

```
$items = $this->paginate('Item'); 
```

获取他们的 ID 并将其与用户 ID 结合以获取所有用户的项目。

```
$itemIds = Set::extract('/Item/id', $items);

$usersItems = $this->Item->User->find
    (
        'all',
        array
        (
            'conditions' => array
            (
                'User.id' = $userId,
                'Item.id' => $itemIds
            ),
            'fields' => array('User.id', 'Item.id')
        )
); 
```

现在您可以将 $usersItems 设置为您喜欢的格式，并为视图设置该格式和 $items。这将把你带到你的选项 4 和 in_array()，除了它可能是 Set::extract() 或 Set::check()。

这样的事情应该这样做：

```
if (Set::extract(sprintf('/Item[id=%s]', $itemId), $usersItems))
{
    // user has the item
} 
```

（我是凭记忆写的，所以……你知道如果失败了该怎么办:)）

编辑：

或者，你可以做这样的事情（它应该比上面更快，只要确保移出`Set::extract()`循环）：

```
$usersItemIds = Set::extract('/Item/id', $usersItems);

if (in_array($itemId, $usersItemIds))
{
    // user has the item
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-13T21:33:33.737

我知道这是一个老问题，但似乎 ACL 组件在这里可能是一个不错的选择。

# emacs - 如何使用 Emacs 进行远程开发？

> ID：846608
> 
> 赞同：37
> 
> 时间：2009-05-11T03:12:05.177
> 
> 标签：emacs

几天前我开始使用 emacs 作为我的主要编辑器，我正在收集我需要的所有自定义项。

我给它的主要用途是在远程 Linux 机器（RHEL 5）上开发 C 项目。到目前为止，我使用的是普通的 vim（仅作为文本编辑器）和一堆 shell 脚本，有一天我决定尝试 emacs。到目前为止我喜欢它。

但作为一个缺点，我发现设置运行 emacs 的环境还有很长的路要走，而不是直接在开发机器上使用它（并在我使用的每台机器上设置环境）我会尝试只使用它从我的笔记本电脑上进行远程开发。

我知道 TRAMP，但据我所知，它只编辑远程文件。最大的障碍是在远程机器上通过一个按键运行 shell 命令（我绑定 F5 以在远程机器的 emacs 上运行自定义编译命令）。

你如何用一个 emacs 按键在远程机器上运行 shell 命令？您知道进行完整远程开发的任何其他提示和技巧吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-11T03:59:19.153

TRAMP 支持在远程机器（文件所在的位置）上进行编译和调试。这应该是自动的并且相对无缝。查看[远程进程](http://www.gnu.org/software/tramp/#Remote-processes)的文档。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-11T05:38:29.243

不用担心。你可以在 Emacs 中通过一个按键来运行*任何东西。*其他人已经注意到您可以使用 TRAMP 优雅地做到这一点，但如果这不适合（无论出于何种原因），您也可以使用以下方法编写自己的函数：

```
(defun arbitrary-remote-command ()
  (interactive)
  (shell-command
   "ssh user@remotehost arbitrary-command"))

(global-set-key (kbd "<f5>") 'arbitrary-remote-command) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-11T03:40:19.217

在进行远程开发时，我使用[`screen`](http://gnu.org/software/screen)它提供多个虚拟远程终端，只需按几个键即可。这对我来说是必不可少的。它不仅提供虚拟终端，而且如果您的连接因任何原因断开，您的会话也会保留在服务器上。

有关[开始](https://stackoverflow.com/questions/70614/gnu-screen-survival-guide)使用`screen`.

我通常打开一个终端用于源代码控制操作，一个用于编辑，一个用于编译（我只需切换到它并按向上箭头+Enter），还有一个用于调试。根据我正在处理的环境和应用程序，我可能有更多或更少，但这是一般布局。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-15T03:49:31.290

Trey Jackson 的回答很好，但 Matthew Flaschen 的回答实际上帮助了我更多。

我找不到让 TRAMP 进行编译的方法，但意外地找到了命令[remote-compile](http://marc-abramowitz.com/archives/2006/06/16/remote-compiling-in-emacs/)。

现在我只需将这些行添加到我的 .emacs 中：

```
(setq remote-compile-user "root")
(setq remote-compile-host "localhost -p 3000")  ;This is just when tunneling
(setq compile-command " cd /usr/src/nexus/traffic && ./builder.sh compile ; cat builder.log")
(global-set-key (kbd "<f5>") 'remote-compile) 
```

[在做任何事情之前，使用ControlMaster](http://www.torchbox.com/blog/ssh_tips_2.html)设置 ssh 连接，我不必输入密码。

总结：

*   编辑远程文件：TRAMP
*   多终端保存状态：SCREEN
*   定义 emacs 键绑定以执行远程命令：参见 Matthew Flaschen 响应
*   远程编译：使用 ControlMaster 命令远程编译

我认为这涵盖了进行远程开发的一些重要操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T21:21:37.410

我只需 ssh 进入远程机器并在终端模式下运行 emacs，而不是使用 TRAMP。当您不期望缓慢时，TRAMP 真的很慢，至少根据我的经验。我还看到它以奇怪的方式失败，如何“修复”它并不总是很明显。如果你 ssh 进入，你将无法使用 emacs UI 的东西，比如菜单等，但是因为你习惯了 vi，这对你来说应该不是问题。事实上，您可以将它们关闭，以便您的 ssh emacs 体验与您的本地体验非常相似（如果本地！= 终端模式）（1）。

如果您关心在连接断开的情况下保留会话，则使用 screen 可能很有用 - 除此之外，您可以获得与带有 emacs 缓冲区的虚拟终端类似的功能。例如，您可以打开许多 shell 缓冲区并在 emacs 缓冲区中运行各种 shell 命令。我使用它来运行许多 sqlplus 实例（使用 rename-buffer 为它们提供所有漂亮、友好的名称）。

由于您已通过 ssh 连接到远程机器，因此您无需担心运行“远程”shell 命令。

另一方面，我不确定您所说的“我认为设置环境以运行 emacs 是一个很长的路要走”。如果你有源代码控制，这应该是微不足道的......（我敢打赌你有充分的理由）。

(1) 关闭菜单、工具栏和滚动条：

(if (fboundp 'menu-bar-mode) (menu-bar-mode -1))

(if (fboundp 'tool-bar-mode) (tool-bar-mode -1))

(if (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T20:09:53.920

我以前曾尝试过 TRAMP 来解决像你这样的情况，但我也发现它以奇怪的方式失败，而且总体上很慢。

我现在使用 Emacs 来编辑挂载在 sshfs 挂载上的文件。这对我来说非常有效。

挂载远程文件系统（假设您已正确设置主机`.ssh/config`并设置公钥以无需密码即可连接）

```
$ sshfs remote:dir localdir 
```

并从那时起随心所欲地编辑！

至于编译，请参阅其他答案，它们完全涵盖了这一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T13:49:05.660

假设您不想在远程机器上以终端模式运行 emacs，那么这相当容易。如您所知，您可以使用 TRAMP 编辑远程文件。我只是将 compile-command 设置为 'ssh me@remote "cd /path/to/root && make"' 并完成它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-19T06:33:21.270

关于流浪汉，它可能取决于您使用的流浪汉版本。

就我个人而言，我在使用默认的 tramp 包和 plink 作为后端以连接到远程主机时遇到了很多问题，所以我将 tramp 升级到了更新的版本并解决了许多问题。

实际上，我在 Windows 机器上访问 linux (RH5) 以进行远程编译和浏览目录，读/写一些文件，在远程机器上编译工作正常。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-06-23T02:42:09.947

对我来说，TRAMP 有一个问题，就是远程工具链太旧了，而且经常不在我的控制之下。

所以我写了一个包（[ppcompile](https://github.com/whatacold/ppcompile)）来帮助我在本地开发和远程编译，然后借助`next-error`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-17T13:35:34.490

我从 1994 年左右开始使用的东西：

```
cat <<-EOF >> ~/.emacs
(define-key global-map "\e`" 'compile)
(define-key global-map "\e~" 'remote-compile)
(require 'compile)
(setq remote-shell-program "ssh")
EOF 
```

现在 ESC-` 运行编译，而 ESC-~ 运行 /remote/ 编译。它会询问您的主机名，然后预填充命令。两个编译共享相同的历史缓冲区。

这太容易了。它利用了几十年来一直有效的功能，并且不需要任何其他提升即可工作 - 它只是 ssh 上的文本，因此它对于长、慢或拥挤的链接将非常敏感和高效。我发现这可以防止网络愤怒之拳多一点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-02-25T18:25:37.143

没有人提到的一件事是在远程机器上运行 emacs，并使用与当前显示相对应的有效 $DISPLAY 变量。

显然，您必须为本地显示运行 X 服务器，但这即使在 Windows 上也没什么大不了的[使用 Cygwin 中内置的 X 服务器]。

这通常要求网络延迟 < 50ms。如果你 ping 那个远程盒子并得到 > 50ms 的东西，你会对这种方法感到沮丧。

在此之下，效果很好。

您需要让 SSH 映射 X 端口，那里有很多文档。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-01-07T13:04:38.400

我有同样的需求：运行 Debian 10 的 Windows 上的虚拟机连接到 RHEL7 开发机器。这是我的解决方案。

首先，我使用 sshfs 以保留本地计算机中的路径的方式挂载我的远程家庭：`shfs -o allow_other <remote-user-name>@<remote-host>:/home/<remote-host-home> /home/<remote-host-home>`

其次，我配置了 ssh，这样我就不需要一次又一次地输入密码：我可以按照[这个链接](http://www.linuxproblem.org/art_9.html)中的说明进行操作。

最后，我可以通过 Mx compile 启动编译，编辑命令并输入如下内容：`ssh -C <remote-user-name>@<remote-host> "make -C <build-folder>"`

它的好处是，当它发现编译错误并且源文件自动打开时，您可以单击链接。非常方便。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-05-12T21:48:13.013

两分钱：如果带宽不是一个大问题，我会对 VNC 进行破解。

# java - 如何使用 Eclipse 启动 Web 应用程序

> ID：846614
> 
> 赞同：0
> 
> 时间：2009-05-11T03:13:34.923
> 
> 标签：java, eclipse

我喜欢eclipse和java。我想使用 eclipse 编写我的整个 web 应用程序 .. 从设计 html 文件到 servlet .. 我在开发 web 应用程序方面的经验为零 .. 那么如何为 web 应用程序设置 eclipse 以及如何开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T03:16:58.957

[谷歌甚至自动完成这个问题，所以你知道这是一个流行的查询！](http://www.google.com/#hl=en&q=creating+a+web+application+in+eclipse&btnG=Google+Search&aq=1&oq=creating+a+web+applicati&fp=9XpCdJbaSz4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T03:21:09.013

您提供的信息很少，实际上有使用 Eclipse 和 Java 创建 Web 应用程序的教程。您将希望以 Eclipse 的 JavaEE 版本作为起点。

如果您想尝试使用与 Java 一起工作的 Web 框架，我推荐使用 Struts，尽管如果您想开发小型 Web 应用程序，这可能太大了（而且它并不是最容易开始的东西）。

我还建议安装 Apache Tomcat 作为您的服务器，因为它免费且易于使用。这是一个很好的入门教程：

[http://www.xwt.org/tutorial/eclipse/](http://www.xwt.org/tutorial/eclipse/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T03:25:08.320

首先，确保你有 Java EE eclipse 二进制文件：http: [//www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)

如前所述，关于如何在 Eclipse 下设置、部署和管理 Web 应用程序，有各种 google-able 教程。

# ms-access - 访问报告 - 显示周结束日期

> ID：846615
> 
> 赞同：1
> 
> 时间：2009-05-11T03:14:20.180
> 
> 标签：ms-access, vba

我有一个基于这样的查询的 Access 2000 报告

```
SELECT 
...
FROM Clients AS wc INNER JOIN ...
WHERE ((wo.OfferStatusID)=3) AND 
((DatePart("ww",[wo.StatusTimeStamp]))=DatePart("ww",[Enter Week End Date])) 
AND ((Year([wo.StatusTimeStamp]))=Year(Date()))); 
```

where 子句允许您输入“周末结束日期”，它会查找包含结束日期的周日至周六周的所有记录。

我的问题是我需要在报告中包含周六结束日期，以便标题显示“...... 2009 年 5 月 9 日结束的一周”，如果没有询问我的查询，我无法弄清楚如何获取该日期第二次。

有没有办法强制 Access 将输入的参数作为结果中的另一个字段返回，或者以另一种方式获取该周结束日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T03:27:49.220

继续在查询设计器中四处寻找，我发现我可以将其添加到 SELECT 子句中，并将输入的值添加到每一行：

```
[Enter Week End Date] AS WeekEndDate 
```

这可行，但我仍然愿意接受其他建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T14:48:40.437

您可以堆叠两个查询（使一个成为另一个的来源）。这将是相当 MS Access'y。但是，如果您现在可以使用它，我会坚持使用您所拥有的。它可能更清洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T23:59:50.310

另一种做法是先用表单抓取查询参数，在查询中引用表单控件。例如，在您的示例中，创建一个名为 frmGetDateParam 的表单，并添加一个名为 txtDate 的文本框。将格式更改为日期，也许添加一些验证，没关系。向打开报告的表单添加一个命令按钮。然后，将您的查询更改为如下所示：-

```
SELECT 
...
FROM Clients AS wc INNER JOIN ...
WHERE ((wo.OfferStatusID)=3) AND 
((DatePart("ww",[wo.StatusTimeStamp]))=DatePart("ww",Forms!frmGetDateParam!txtDate)) 
AND ((Year([Forms!frmGetDateParam!txtDate]))=Year(Date()))); 
```

您还可以将 Forms!frmGetDateParam!txtDate 作为报告中的字段引用。

这种方法的唯一缺点是，如果您尝试在未打开参数表单的情况下打开查询/报告，那么查询仍会提示您输入日期值。

# audio - 快速音频输入/输出

> ID：846616
> 
> 赞同：4
> 
> 时间：2009-05-11T03:15:08.803
> 
> 标签：audio, javasound, low-latency

这是我想要做的：

我想让用户给我的程序一些声音数据（通过麦克风输入），然后保持 250 毫秒，然后通过扬声器输出回来。

我已经使用 Java Sound API 完成了这项工作。问题是它有点慢。从发出声音到再次从扬声器中听到声音的时间至少需要 1-2 秒，我什至还没有尝试实现延迟逻辑。理论上应该没有延迟，但确实存在。我知道您必须等待声卡填满其缓冲区或其他任何东西，并且样本大小和采样率与此有关。

我的问题是：我应该继续沿着 Java 路径尝试这样做吗？如果可能的话，我想将延迟降低到 100 毫秒。有没有人有使用 Java 的 ASIO 驱动程序的经验？应该是更快了。。

另外，我是一个 .NET 人。这是否与 .NET 相关？C++呢？我正在寻找合适的技术在这里使用，也许是如何使用您建议的技术平台读/写音频输入/输出流的一个很好的例子。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T03:19:36.223

我过去使用过 JavaSound，发现它非常不稳定（并且它在 VM 版本之间不断变化）。如果您喜欢 C#，请使用它，只需使用 DirectX API。这是一个使用 DirectSound 和 C# 做一些你想做的事情的例子。您可以使用效果插件来执行您的 250 毫秒回声。

[http://blogs.microsoft.co.il/blogs/tamir/archive/2008/12/25/capturing-and-streaming-sound-by-using-directsound-with-c.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/12/25/capturing-and-streaming-sound-by-using-directsound-with-c.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T00:04:50.343

您可能想查看[JACK](http://jackaudio.org)，这是一种专为低延迟声音处理而设计的音频 API。此外，Google 还提供了这个关于将 JACK 与 Java 结合使用的[精彩演示文稿](http://lac.linuxaudio.org/2007/presentations/lac07_slides_gulden1.pdf)[PDF]。

> 理论上应该没有延迟，但确实存在。

那么，零延迟是不可能的。您可以期望的最好结果是不明显的延迟（就人类感知而言）。如果您描述读取和写入声音数据的基本算法可能会有所帮助，以便人们可以识别可能的问题。

使用像 Java 这样的垃圾收集语言的一个潜在问题是 GC 会定期运行，从而在任意时间内中断您的处理。但是，如果它在正常使用中大于 100 毫秒，我会感到惊讶。如果 GC 是个问题，大多数 JVM 都提供了可供您尝试的替代收集算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T20:41:32.863

如果您选择走 C/C++ 路径，我强烈建议您使用 PortAudio ( [http://portaudio.com/](http://portaudio.com/) )。它适用于多个平台上的几乎所有东西，它使您可以对声音驱动程序进行低级控制，而无需实际处理周围的各种声音驱动程序技术。

我在多个项目中使用过 PortAudio，使用起来真的很开心。并且许可证是允许的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-24T19:34:29.713

如果低延迟是您的目标，那么您无法击败 C。

[libsoundio](http://libsound.io/)是一个用于实时音频输入和输出的低级 C 库。它甚至还附带了一个[示例程序](https://github.com/andrewrk/libsoundio/blob/master/example/sio_microphone.c)，可以完全满足您的要求 - 将麦克风输入连接到扬声器输出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-22T04:12:29.923

*使用JavaSound*在 100-150 毫秒的范围内获得端到端延迟当然是可以实现的。

1.  延迟的主要原因是捕获和播放线的缓冲区大小。打开线条时设置大小：

    *   捕获：`TargetDataLine#open(AudioFormat format, int bufferSize)`
    *   回放：`SourceDataLine#open(AudioFormat format, int bufferSize)`

如果缓冲区太大，则会导致延迟过长，但如果缓冲区太小，则会导致播放卡顿。因此，您需要在应用程序需求和计算能力之间找到平衡点。

`DataLine#getBufferSize`调用时可以检查默认缓冲区大小`#open(AudioFormat format)`。默认大小将根据不同而有所不同，`AudioFormat`并且似乎适用于高延迟、无卡顿的播放应用程序（例如互联网流媒体）。如果您正在开发低延迟应用程序，则默认缓冲区大小太大，应该更改。

在我使用 16 位 PCM 进行的测试中`AudioFormat`，1024 字节的缓冲区大小已经非常接近低延迟的理想值。

2.  音频延迟的第二个也是经常被忽视的原因是在捕获或播放线程中执行的任何其他活动。例如，将消息记录到控制台可能会引入 10 毫秒的延迟。把它关掉。

# sql-server - 字符类型的数据库物理存储

> ID：846631
> 
> 赞同：0
> 
> 时间：2009-05-11T03:27:00.987
> 
> 标签：sql-server, encoding, storage, character

对于SQL Server 2005/2008，经过一些自学，我不确定我对字符数据类型如何物理存储的理解是否正确。请帮忙查看和评论。这是我的理解，请查看并随时纠正我。

*   当使用 unicode 字符类型（例如 nvarchar）时，底层字符以 UCS-2 编码存储（即，字符以相关 UCS-2 为字符定义的位序列的形式物理存储）。Collat​​ion 定义了比较和排序，这种情况下没有代码页；

*   当使用非 unicode 字符类型（例如 varchar）时，底层字符物理存储为由排序规则定义的相关代码页中定义的位。所以在这种情况下，排序规则不仅定义了比较/排序，还定义了哪个代码页（字符，位值表示字符，并使用相同的位值将字符存储在数据库物理存储中）。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T06:01:29.593

我认为你是莱特，请参阅链接了解更多信息 [http://www.sql-server-helper.com/faq/data-types-p01.aspx](http://www.sql-server-helper.com/faq/data-types-p01.aspx)

# wcf - 为什么只有使用 silverlight 和 wcf 的 basicHttpBinding？

> ID：846635
> 
> 赞同：1
> 
> 时间：2009-05-11T03:27:55.493
> 
> 标签：wcf, silverlight

一模一样： [为什么 Silverlight 2 只支持 WCF basicHTTP 绑定？](https://stackoverflow.com/questions/661479/why-does-silverlight-2-only-support-wcf-basichttp-binding)

为什么只有使用 silverlight 和 wcf 的 basicHttpBinding？也许您有一个涵盖此内容的链接，您不必进行大量输入：+>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-15T08:21:43.550

几个答案：（1）Silverlight 4 现在使 Net.TCP 绑定可用，当它没有被阻塞时它非常方便，因为它的速度明显更快（有关详细信息，请参阅[此处](http://tomasz.janczuk.org/2009/11/wcf-nettcp-protocol-in-silverlight-4.html)）。很明显，Silverlight 架构中没有任何固有的东西阻止它使用其他绑定。

(2) 至于为什么 Silverlight 不使用其他基于 WS* Http 的绑定，这只是一个猜测，但如果这些绑定以 Silverlight 有限的 HTTP 堆栈的方式使用 HTTP 协议，我不会感到惊讶不支持，可能是出于安全原因。例如，我知道 Silverlight 限制了您可以在 HTTP 请求中放置的内容标头，如果任何 WS-* 协议需要自定义标头或可能代表安全风险的标头，MS 会希望阻止这种情况。

(3) 当然，也有可能是 MS 还没有考虑到它。在过去的几年里，他们在 Silverlight 上做了很多工作——但大概他们必须优先考虑他们的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T03:36:06.073

嗯，我很确定这是重复的，但找不到。我认为简短的回答是 BasicHttpBinding 是唯一适用于部分信任的绑定。

（编辑：找到了 dup，现在有问题的链接）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T03:51:33.690

我为此找到了几个链接，但没有明确的答案。闻起来像 Silverlight 是针对 ASMX Web 服务设计的，用于 Web 服务风格的通信，让 WCF 与期望 ASMX Web 服务的旧客户端一起使用的方法是使用 basicHttp 绑定。

此链接为您提供了一个完整的示例（使用 Silverlight 的 Beta2）。
[http://msdn.microsoft.com/en-us/magazine/cc794260.aspx](http://msdn.microsoft.com/en-us/magazine/cc794260.aspx)

> 只要 Silverlight 应用具有 basicHttpBinding 类型的绑定，Silverlight 应用就可以调用标准 WCF 服务。您必须确保将 WCF 服务的默认绑定从 wsHttpBinding 更改为 basicHttpBinding，或者创建一个 basicHttpBinding 类型的新绑定

该参考资料说了同样的话，但再次没有提供任何解释。 [http://timheuer.com/blog/archive/2008/03/14/calling-web-services-with-silverlight-2.aspx](http://timheuer.com/blog/archive/2008/03/14/calling-web-services-with-silverlight-2.aspx)

> Silverlight 使用 WCF 的 BasicHttpBinding 进行通信

# c - C项目的Git忽略文件

> ID：846639
> 
> 赞同：21
> 
> 时间：2009-05-11T03:30:20.730
> 
> 标签：c, git

我刚刚开始学习 C （使用[Thinking In C](http://mindview.net/CDs/ThinkingInC/beta3)），我想知道我应该在 C 项目的 git 存储库中忽略哪些文件。

没有什么建议太明显了——我完全是个菜鸟。谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-11T03:39:51.293

我想会有一些生成的文件，你不想留在你的仓库中（假设你的构建输出目录在你的 git heirachy 中）：

*   目标文件 (.o, o.obj)
*   库 (.lib)
*   DLL、共享对象（.so、.dll）
*   可执行文件（.exe、a.out ？）

GIT 忽略文件是我倾向于迭代地做的事情。“嘿，我的仓库中不需要这些东西” ...

编辑：重新 dmckee 的评论

是的，你肯定想忽略交换文件、临时文件等。我有以下作为我的 .gitignore 的基线：

*   *.swp
*   *.* ~
*   拇指数据库

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-13T15:53:01.293

您还可以将构建设置为在子目录中进行`build`，然后您可以忽略里面的整个内容`.gitignore`

> 建造/

你完成了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-31T12:28:23.047

我在我的 .gitignore 中使用它但我正在为微控制器构建，所以我不知道它是否对你有很大帮助。

最简单的方法是先做一个 make clean，然后添加所有文件，然后再做一个 make all，看看会出现什么额外的东西。

```
#Some of these are related to eclipse. So i keep them out of my repo
.cproject
.dep/
.project
.settings/

#files being edited
*~

# make and build files
*.lst
*.o
*.eep
*.lss
*.map
*.sym

# I keep these, since I prefer having the reference of the final build
# *.elf
# *.hex 
```

# windows - 以编程方式启动特定联系人的 MSN 或聊天客户端

> ID：846641
> 
> 赞同：1
> 
> 时间：2009-05-11T03:31:07.797
> 
> 标签：windows, msn, msn-messenger

有没有办法以编程方式启动聊天客户端（例如：MSN Messenger）并自动为特定联系人打开聊天窗口？

我希望类似于 ShellExec("mailto:blah@blah.com") 的东西，但用于聊天而不是电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T04:00:36.080

[http://blogdesignhack.blogspot.com/2009/03/adding-im-hyperlinks-to-web-site.html](http://blogdesignhack.blogspot.com/2009/03/adding-im-hyperlinks-to-web-site.html)

检查这个。

# f# - 为什么 F# 不能推断该语句的类型？

> ID：846642
> 
> 赞同：4
> 
> 时间：2009-05-11T03:34:25.357
> 
> 标签：f#, functional-programming, type-inference

```
/// I can't do this
let max =  float n |> sqrt |> int64 |> Math.BigInt

/// But this is allowed
let max =  Math.BigInt(float n |> sqrt |> int64) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T03:43:42.097

类构造函数不能在没有参数的情况下使用。你可以写

```
let max =  float n |> sqrt |> int64 |> (fun x -> Math.BigInt(x)) 
```

如果你喜欢。（不过，我不知道这种限制的原因。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T14:33:59.873

在我的 F# 版本（Mono 上的 1.9.4.19）中，两个版本都失败了：

> `The member or object constructor 'BigInt' takes 0 argument(s) but is here given 1\. The required signature is 'Math.BigInt()'.`

我可以用

```
let max =  float n |> sqrt |> int64 |> Math.BigInt.of_int64 
```

得到一个`bigint`或

```
let max =  float n |> sqrt |> int64 |> Math.BigInt.FromInt64 
```

得到一个`Math.BigInt`.

# database - 如何将数据库置于 git（版本控制）下？

> ID：846659
> 
> 赞同：307
> 
> 时间：2009-05-11T03:49:31.650
> 
> 标签：database, git, version-control, postgresql

我正在做一个 web 应用程序，我需要为一些重大更改创建一个分支，问题是，这些更改需要更改数据库模式，所以我也想将整个数据库放在 git 下。

我怎么做？有没有可以保存在 git 存储库下的特定文件夹？我怎么知道是哪一个？我如何确定我放置了正确的文件夹？

我需要确定，因为这些更改不向后兼容；我不能搞砸了。

我的数据库是 PostgreSQL

### 编辑：

有人建议进行备份并将备份文件而不是数据库置于版本控制之下。老实说，我觉得这真的很难接受。

~~一定有更好的方法。~~

### 更新：

好的，所以没有更好的方法，但我仍然不太相信，所以我会稍微改变一下问题：

我想将整个数据库置于版本控制之下，我可以使用什么数据库引擎，以便将实际数据库置于版本控制之下而不是转储？

sqlite 对 git 友好吗？

由于这只是开发环境，我可以选择我想要的任何数据库。

### 编辑2：

我真正想要的不是跟踪我的开发历史，而是能够从我的“新的根本变化”分支切换到“当前稳定的分支”，并能够修复一些错误/问题等。稳定的分支。这样当我切换分支时，数据库会自动神奇地与我当前所在的分支兼容。我不太关心实际数据。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-05-11T03:52:49.197

进行数据库转储，然后进行版本控制。这样它是一个平面文本文件。

我个人建议您同时保留数据转储和模式转储。通过这种方式，使用 diff 可以很容易地查看架构中从修订到修订的变化。

如果您正在进行重大更改，您应该有一个辅助数据库，您可以对新架构进行更改，并且不要触及旧数据库，因为正如您所说的那样，您正在创建一个分支。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-11T22:37:18.963

我开始想一个非常简单的解决方案，不知道为什么我以前没有想到它！

*   复制数据库（模式和数据）。
*   在 new-major-changes 的分支中，只需更改项目配置以使用新的重复数据库。

这样我就可以切换分支而不用担心数据库模式的变化。

### 编辑：

通过重复，我的意思是创建另一个具有不同名称的数据库（如`my_db_2`）；不做转储或类似的事情。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-02-14T21:38:27.953

使用像[LiquiBase](http://www.liquibase.org)这样的东西可以让您保持对 Liquibase 文件的修订控制。您可以仅为生产标记更改，并让 lb 为生产或开发（或您想要的任何方案）保持您的数据库是最新的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-04-29T08:17:55.580

*   [Irmin](https://irmin.io/)（分支+时间旅行）
*   [Flur.ee](http://flur.ee)（不可变+时间旅行）
*   [Crux DB](https://www.opencrux.com/main/index.html)（时间旅行）
*   [TerminusDB](https://terminusdb.com/)（分支+时间旅行）
*   [DoltDB](https://github.com/dolthub/dolt)（分支+时间旅行）
*   [Quadrable](https://github.com/hoytech/quadrable)（分支+远程状态验证）
*   [EdgeDB](https://www.edgedb.com/)（不是实时旅行，而是由编译器在架构更改后派生的迁移）
*   [Migra](https://github.com/djrobstep/migra)（Postgres 模式/数据的差异。自动生成迁移脚本，自动同步数据库状态）
*   [ImmuDB](https://codenotary.com/technologies/immudb/)（不可变+时间旅行）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-02-25T11:19:38.990

有一个名为 Migrations under Doctrine 的伟大项目就是为此目的而构建的。

它仍处于 alpha 状态并为 php 构建。

[http://docs.doctrine-project.org/projects/doctrine-migrations/en/latest/index.html](http://docs.doctrine-project.org/projects/doctrine-migrations/en/latest/index.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-03-07T10:22:26.163

我遇到了这个问题，因为我遇到了类似的问题，其中一些近似于基于数据库的目录结构，存储“文件”，我需要 git 来管理它。它使用复制在云中分布，因此它的访问点将通过 MySQL。

上述答案的要点似乎同样提出了一个替代解决方案来解决所提出的问题，这有点忽略了使用 Git 管理数据库中的某些内容，所以我将尝试回答这个问题。

Git 是一个系统，它本质上存储了一个增量（差异）数据库，可以重新组合以重现上下文。git 的正常用法假定上下文是一个文件系统，并且这些增量是该文件系统中的差异，但实际上所有 git 都是增量的分层数据库（分层的，因为在大多数情况下，每个增量是一个至少 1父母，安排在一棵树上）。

只要能生成一个delta，理论上git就可以存储。问题通常是 git 期望在其上生成 delta 的上下文是一个文件系统，同样，当您在 git 层次结构中检出一个点时，它期望生成一个文件系统。

如果你想在数据库中管理变更，你有 2 个离散的问题，我会分别解决它们（如果我是你的话）。第一个是模式，第二个是数据（尽管在您的问题中，您说数据不是您关心的东西）。我过去遇到的一个问题是 Dev 和 Prod 数据库，其中 Dev 可以对模式进行增量更改，并且这些更改必须记录在 CVS 中，并传播到实时，以及添加到几个“静态”之一表。我们通过第三个数据库来做到这一点，称为 Cruise，它只包含静态数据。在任何时候都可以比较 Dev 和 Cruise 的模式，我们有一个脚本来获取这两个文件的差异并生成一个包含 ALTER 语句的 SQL 文件，以应用它。同样，任何新数据，可以提炼成包含 INSERT 命令的 SQL 文件。只要只添加字段和表而不删除，该过程就可以自动生成 SQL 语句以应用增量。

git 生成 deltas`diff`的机制以及将 1 个或多个 deltas 与文件组合的机制称为`merge`. 如果你能想出一种从不同的上下文中区分和合并的方法，git 应该可以工作，但正如已经讨论过的，你可能更喜欢为你做这件事的工具。我解决这个问题的第一个想法是[https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#External-Merge-and-Diff-Tools](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#External-Merge-and-Diff-Tools)详细说明了如何替换 git 的内部差异和合并工具。我会更新这个答案，因为我想出了一个更好的问题解决方案，但在我的情况下，我希望只需要管理数据更改，到目前为止，基于数据库的文件存储可能会发生变化，所以我的解决方案可能不是您所需要的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-05-22T11:34:37.553

看看 RedGate SQL 源代码控制。

[http://www.red-gate.com/products/sql-development/sql-source-control/](http://www.red-gate.com/products/sql-development/sql-source-control/)

此工具是一个 SQL Server Management Studio 管理单元，可让您使用 Git 将数据库置于源代码控制之下。

每位用户 495 美元有点贵，但有 28 天的免费试用期。

注意我不以任何方式隶属于 RedGate。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-10-11T09:16:44.590

我想做类似的事情，将我的数据库更改添加到我的版本控制系统中。

我将遵循 Vladimir Khorikov [“数据库版本控制最佳实践”](http://enterprisecraftsmanship.com/2015/08/10/database-versioning-best-practices/)的这篇文章中的想法。总之，我会

*   将其模式和参考数据存储在源代码控制系统中。
*   对于每次修改，我们将创建一个单独的 SQL 脚本，其中包含更改

万一有帮助！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-11T04:47:57.373

没有原子性就无法做到这一点，如果不使用 pg_dump 或快照文件系统，就无法获得原子性。

我的 postgres 实例位于 zfs 上，我偶尔会对其进行快照。它几乎是即时且一致的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-11T05:44:10.137

我认为 X-Istence 走在正确的轨道上，但您可以对这个策略进行一些改进。首先，使用：

```
$pg_dump --schema ... 
```

转储表、序列等并将此文件置于版本控制之下。您将使用它来分离分支之间的兼容性更改。

接下来，为包含应用程序运行*所需*的配置（应该可能跳过用户数据等）的表集执行数据转储，例如表单默认值和其他数据非用户可修改的数据。您可以使用以下方法有选择地执行此操作：

```
$pg_dump --table=.. <or> --exclude-table=.. 
```

这是一个好主意，因为在执行完整数据转储时，当您的数据库达到 100Mb+ 时，repo 会变得非常笨重。一个更好的主意是备份测试应用程序所需的更少量的数据集。但是，如果您的默认数据非常大，这仍然可能会导致问题。

如果您绝对需要在 repo 中放置完整备份，请考虑在源代码树之外的分支中进行。不过，参考匹配的 svn rev 的外部备份系统可能是最好的选择。

此外，我建议使用文本格式转储而不是二进制文件进行修订（至少对于模式），因为这些更容易区分。在签入之前，您始终可以压缩这些以节省空间。

最后，如果您还没有，请查看[postgres 备份文档。](http://www.postgresql.org/docs/8.1/static/backup.html)您评论备份“数据库”而不是转储的方式让我想知道您是否正在考虑基于文件系统的备份（有关注意事项，请参见第[23.2节）。](http://www.postgresql.org/docs/8.1/static/backup-file.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-02-25T15:14:17.997

从本质上讲，您想要的可能是[Post Facto](http://www.post-facto.org/)之类的东西，它将数据库的版本存储在数据库中。检查此[演示文稿](http://www.pgcon.org/2009/schedule/events/158.en.html)。

该项目显然从未真正走到过任何地方，因此它可能不会立即为您提供帮助，但这是一个有趣的概念。我担心正确地做到这一点会非常困难，因为即使是版本 1 也必须正确处理所有细节才能让人们信任他们的工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-07-09T02:55:29.827

我已经发布了一个用于 sqlite 的工具，可以满足您的要求。它使用自定义差异驱动程序，利用 sqlite 项目工具“sqldiff”，将 UUID 作为主键，并保留 sqlite rowid。它仍处于 alpha 阶段，因此非常感谢您的反馈。

Postgres 和 mysql 比较棘手，因为二进制数据保存在多个文件中，如果您能够对其进行快照，甚至可能无效。

[https://github.com/cannadayr/git-sqlite](https://github.com/cannadayr/git-sqlite)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-07-26T15:00:13.313

这个问题已经得到了很好的回答，但我想用一个小建议来补充 X-Istence 和 Dana the Sane 的回答。

如果您需要具有某种程度的粒度的修订控制，例如每天，您可以将表和模式的文本转储与执行增量备份的工具（如[rdiff-backup ）结合起来。](http://www.nongnu.org/rdiff-backup/)优点是无需存储每日备份的快照，您只需存储与前一天的差异即可。

有了这个，您既拥有修订控制的优势，又不会浪费太多空间。

在任何情况下，直接在更改非常频繁的大型平面文件上使用 git 都不是一个好的解决方案。如果您的数据库变得太大，git 将开始在管理文件时遇到一些问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-03-29T08:09:11.800

这是我在项目中尝试做的事情：

*   单独的数据和模式以及默认数据。

数据库配置存储在不受版本控制（.gitignore）的配置文件中

数据库默认值（用于设置新项目）是受版本控制的简单 SQL 文件。

对于数据库模式，在版本控制下创建一个数据库模式转储。

最常见的方法是使用包含 SQL 语句的更新脚本（ALTER Table.. 或 UPDATE）。您还需要在数据库中有一个位置保存当前版本的架构）

看看其他大型开源数据库项目（piwik，或者你最喜欢的 cms 系统），它们都使用 updatescripts (1.sql,2.sql,3.sh,4.php.5.sql)

但这是一项非常耗时的工作，您必须创建和测试更新脚本，并且您需要运行一个通用的更新脚本来比较版本并运行所有必要的更新脚本。

所以理论上（这就是我正在寻找的）你可以在每次更改后转储数据库模式（手动，conjob，git hooks（可能在提交之前））（并且仅在一些非常特殊的情况下创建更新脚本）

之后在您的通用更新脚本中（运行正常的更新脚本，对于特殊情况），然后比较模式（转储和当前数据库），然后自动生成必要的 ALTER 语句。已经有一些工具可以做到这一点，但还没有找到一个好的工具。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-03-03T08:21:28.993

我建议使用 neXtep（链接已删除 - 域被 NSFW 网站接管）来控制数据库的版本，它有一套很好的文档和论坛来解释如何安装和遇到的错误。我已经为 postgreSQL 9.1 和 9.3 测试了它，我能够让它在 9.1 上工作，但对于 9.3 它似乎不起作用。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-05-13T20:18:19.630

我在我的个人项目中所做的是，我将整个数据库存储到 Dropbox，然后指向 MAMP、WAMP 工作流程以从那里直接使用它。这样数据库在我需要进行一些开发时始终是最新的。但这仅适用于开发人员！实时站点正在使用自己的服务器来实现这一点！:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-05-22T05:01:39.193

在 git 版本控制下存储**每个级别的数据库更改**就像在每次提交时推送**整个数据库并在每次拉取时****恢复**整个数据库。如果您的数据库非常容易发生重大更改并且您无法松动它们，您可以只更新您的**pre_commit**和**post_merge**挂钩。我对我的一个项目做了同样的事情，你可以在[这里](http://ben.kulbertis.org/2011/10/synchronizing-a-mysql-database-with-git-and-git-hooks/)找到方向。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-05-16T12:11:35.590

我就是这样做的：

由于您可以自由选择数据库类型，因此请使用基于文件的数据库，例如 firebird。

创建一个模板数据库，其架构适合您的实际分支并将其存储在您的存储库中。

当以编程方式执行您的应用程序时，创建模板数据库的副本，将其存储在其他地方并使用该副本。

这样您就可以在没有数据的情况下将您的数据库模式置于版本控制之下。如果你改变你的架构，你只需要改变模板数据库

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-06-07T20:21:54.887

我们曾经在标准 LAMP 配置上运行社交网站。我们有一个实时服务器、测试服务器和开发服务器，以及本地开发人员机器。所有这些都使用 GIT 进行管理。

在每台机器上，我们都有 PHP 文件，还有 MySQL 服务，以及一个包含用户上传图片的文件夹。Live 服务器增长到大约 100K（！）经常用户，转储大约 2GB（！），Image 文件夹大约 50GB（！）。当我离开的时候，我们的服务器已经达到了它的 CPU、Ram 的极限，最重要的是，并发网络连接的极限（我们甚至编译了我们自己版本的网卡驱动程序来最大化服务器的“lol”）。我们不能（*你也不应该假设你的网站*）在 GIT 中放置 2GB 的数据和 50GB 的图像。

为了在 GIT 下轻松管理所有这些，我们将通过将这些文件夹路径插入 .gitignore 来忽略二进制文件夹（包含图像的文件夹）。我们在 Apache 文档根路径之外还有一个名为 SQL 的文件夹。在那个 SQL 文件夹中，我们会将来自开发人员的 SQL 文件以递增编号（001.florianm.sql、001.johns.sql、002.florianm.sql 等）放置。这些 SQL 文件也由 GIT 管理。第一个 sql 文件确实包含大量 DB 模式。我们不在 GIT 中添加用户数据（例如用户表或评论表的记录），但配置或拓扑或其他站点特定数据之类的数据保存在 sql 文件中（因此由 GIT 维护）。大多数情况下，它的开发人员（最了解代码）决定了 GIT 关于 SQL 模式和数据的维护和不维护的内容。

当它发布时，管理员登录到开发服务器，将开发机器上的所有开发人员和需要的分支合并到更新分支，并将其推送到测试服务器。在测试服务器上，他检查 Live 服务器的更新过程是否仍然有效，然后快速将 Apache 中的所有流量指向一个占位符站点，创建一个 DB 转储，将工作目录从“live”指向“update” '，将所有新的 sql 文件执行到 mysql 中，并将流量重新指向正确的站点。当所有利益相关者在审查测试服务器后同意时，管理员从测试服务器到实时服务器做了同样的事情。之后，他将生产服务器上的 live 分支合并到所有服务器上的 master 分支，并重新设置所有 live 分支。

如果测试服务器出现问题，例如。合并有太多冲突，然后代码被还原（将工作分支指向“live”）并且从未执行过 sql 文件。在执行 sql 文件的那一刻，这在当时被认为是不可逆的操作。如果 SQL 文件不能正常工作，则使用 Dump 恢复 DB（并且开发人员告诉他们，提供经过不良测试的 SQL 文件）。

今天，我们维护了一个 sql-up 和 sql-down 文件夹，具有相同的文件名，开发人员必须在其中测试升级的 sql 文件是否可以同样降级。这最终可以使用 bash 脚本执行，但如果人眼不断监控升级过​​程，这是一个好主意。

这不是很好，但它可以管理。希望这能让您深入了解一个真实的、实用的、相对高可用性的网站。可能有点过时，但仍然遵循。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-06-25T23:01:02.267

我说不要。数据可以随时更改。相反，您应该只在代码、模式和表定义（`create database`和`create table`语句）中提交数据模型以及用于单元测试的示例数据。这有点像 Laravel 的做法，提交数据库迁移和种子。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-08-11T01:16:14.020

使用像 iBatis Migrations（[手册](https://docs.google.com/viewer?url=http://svn.apache.org/repos/asf/ibatis/java/ibatis-3/trunk/doc/en/iBATIS-3-Migrations.pdf)，[简短的教程视频](http://ibatis.apache.org/migrations_video.html)）这样的工具，它允许您在项目的整个生命周期中对数据库所做*的更改进行版本控制，而不是对数据库本身进行版本控制。*

这使您可以有选择地将单个更改应用于不同的环境，保留更改日志以记录哪些更改在哪些环境中，创建脚本以应用更改 A 到 N，回滚更改等。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-02-09T23:42:42.373

> 我想将整个数据库置于版本控制之下，我可以使用什么数据库引擎，以便将实际数据库置于版本控制之下而不是转储？

这不依赖于数据库引擎。Microsoft SQL Server 有很多版本控制程序。我不认为这个问题可以用 git 解决，你必须使用 pgsql 特定的模式版本控制系统。不知道有没有这种东西……

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-08-26T08:06:15.037

**2019 年 8 月 26 日更新：**

[Netlify CMS](https://github.com/netlify/netlify-cms)正在使用 GitHub 执行此操作，可以在此处找到示例实现，其中包含有关他们如何实现它的所有信息[netlify-cms-backend-github](https://github.com/netlify/netlify-cms/tree/master/packages/netlify-cms-backend-github)

# iphone - 精灵使用 cocos 2d-iphone 显示为蓝色，但仅在模拟器中

> ID：846667
> 
> 赞同：1
> 
> 时间：2009-05-11T03:54:26.043
> 
> 标签：iphone, ios-simulator, cocos2d-iphone

我正在运行位于此处的示例代码：

[http://monoclestudios.com/cocos2d_whitepaper.html](http://monoclestudios.com/cocos2d_whitepaper.html)

使用 cocos 2d-iphone 0.7.2，精灵被绘制成蓝色。但这仅发生在模拟器上。在实际设备上，一切看起来都很好。

有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T19:56:05.420

**不要****在模拟器上**测试OpenGL ES 。只是不一样。模拟器的渲染略有不同。**由于 cocos2d-iPhone 大量基于 OpenGL ES，您唯一的选择就是在设备上进行测试！**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T19:41:37.910

不幸的是，模拟器与物理 iPhone 不同。我没有遇到这个特殊的错误，但我确实遇到了声音问题。不能在模拟器上玩，但在设备上运行良好。如果您只是在模拟器上遇到问题，我建议您忽略该错误并继续前进。毕竟模拟器只是为了方便。

如果您有更多类似的问题，请在 freenode 上查看#cocos2d-iphone。

# c++ - 类的结构成员的默认初始值

> ID：846673
> 
> 赞同：0
> 
> 时间：2009-05-11T03:58:06.223
> 
> 标签：c++

下面的片段来自 VC++ 2008 Express Edition。说，我有一个类，它的成员是一个结构。我正在尝试为此类的成员变量定义默认值。为什么这不起作用？

```
struct Country{
    unsigned chart  id;
    unsigned int    initials;
    std::string name;
};

class world{
private:
    Country          _country;
    unsigned int    _population;
public:
    world(){};
    world():
             _country(): 
                 id('1'), initials(0), name("Spain") {};
             _population(543000) {}
    :
    :
    ~world(){};
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T04:17:55.927

初始化国家成员数据有两种方法。像这样 ...

```
struct Country{
    unsigned char   id;
    unsigned int    initials;
    std::string name;
};

class world{
private:
    Country          _country;
public:
     world()
     {
         _country.id = '1';
         _country.initials = 0;
         _country.name = "Spain";
     }
     ~world(){};
}; 
```

...或者，像这样...

```
struct Country{
    unsigned char   _id;
    unsigned int    _initials;
    std::string _name;
    Country(
        unsigned char id,
        unsigned int initials,
        const std::string& name
        )
        : _id(id)
        , _initials(initials)
        , _name(name)
    {}
};

class world{
private:
    Country          _country;
public:
    world()
    : _country('1', 0, "Spain")
    {
    }
    ~world(){};
}; 
```

请注意，在第二个示例中，我发现初始化 Country 实例更容易，因为我将构造函数定义为 Country 结构的成员。

或者，也许你想给 Country 类型一个默认构造函数：

```
struct Country{
    unsigned char   _id;
    unsigned int    _initials;
    std::string _name;
    Country()
        : _id('1')
        , _initials(0)
        , _name("Spain")
    {}
};

class world{
private:
    Country          _country;
public:
    world()
    {
    }
    ~world(){};
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T04:21:58.557

该结构是一种聚合类型。

由于它没有构造函数，因此您无法使用普通括号对其进行初始化，但是您可以像初始化数组一样使用花括号。

# sql - 具有多个连接的 Oracle 视图仅在使用引号时才能识别 - 为什么？

> ID：846678
> 
> 赞同：0
> 
> 时间：2009-05-11T04:00:01.477
> 
> 标签：sql, oracle, view, ora-00942

我在 Oracle 视图上执行 sql 查询时遇到了一个奇怪的行为。该视图包含多个连接。当我键入常规 sql 时：

```
select * from vView - I receive the error that view is not found
select * from "vView" - The query is executed. 
```

我想知道为什么？

下面是我的sql：

```
 CREATE OR REPLACE FORCE VIEW "TMSCODE"."vCountEventsData" ("EV_ID_NUMBER", "SI_ID", "EV_YEAR", "EV_INS_DATE", "EV_REM_DATE", "EV_AADT_TOT", "EV_AADT_DIR1", "EV_AADT_DIR2", "EV_REPORT", "DIRECTION", "CNAME", "STATION_DESC") AS 
SELECT
"TMSCODE"."STC_EVENTS".EV_ID_NUMBER,
"TMSCODE"."STC_EVENTS".SI_ID,
"TMSCODE"."STC_EVENTS".EV_YEAR,
"TMSCODE"."STC_EVENTS".EV_INS_DATE,
"TMSCODE"."STC_EVENTS".EV_REM_DATE,
"TMSCODE"."STC_EVENTS".EV_AADT_TOT,
"TMSCODE"."STC_EVENTS".EV_AADT_DIR1,
"TMSCODE"."STC_EVENTS".EV_AADT_DIR2,
"TMSCODE"."STC_EVENTS".EV_REPORT,
"TMSCODE"."D_DIRECTION".DIRECTION,
"TMSCODE"."D_CONSULTANT".CNAME,
"TMSCODE"."D_STATION_TYPE".STATION_DESC
FROM
"TMSCODE"."STC_EVENTS"
INNER JOIN "TMSCODE"."D_DIRECTION" ON ("TMSCODE"."STC_EVENTS".EV_DIR = "TMSCODE"."D_DIRECTION".ID)
INNER JOIN "TMSCODE"."D_CONSULTANT" ON ("TMSCODE"."STC_EVENTS".EV_CONS = "TMSCODE"."D_CONSULTANT".ID)
INNER JOIN "TMSCODE"."D_STATION_TYPE" ON ("TMSCODE"."STC_EVENTS".EV_STATION_TYPE = "TMSCODE"."D_STATION_TYPE".ID)
WITH READ ONLY 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-11T04:34:19.970

该视图是使用混合大小写名称创建的。如果您发出以下命令（注意对象名称周围没有引号）

```
创建视图 karl.vView
作为
（从 dba_tables 中选择 *）；

```

RDBMS 将创建视图，然后您将在 dba_views（或 user_views，如果您看不到 dba_views）中找到大写名称为 VVIEW 的行。然后 select * from karl.vview 或 ... from KARL.VVIEW 将起作用

但是，如果您引用对象名称保留大小写，则必须再次明确地将其与引号匹配。（这也将允许名称中的空格和其他不良情况。值得知道要避免并在它确实发生时能够解决。

```
SYS@icedev> 创建表 "TestT" (a int);

表已创建。

SYS@icedev> 插入测试值 (1);
插入测试值 (1)
            *
第 1 行的错误：
ORA-00942: 表或视图不存在

SYS@icedev> 插入测试值 (1);
插入测试值 (1)
            *
第 1 行的错误：
ORA-00942: 表或视图不存在

SYS@icedev> 插入“TestT”值（1）；

创建了 1 行。

```

当然要删除此表，我必须使用 Drop table "TestT"；

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T04:35:47.020

在 Oracle 中，除非被引用，否则对象的名称都是大写的。您使用引号创建了一个混合大小写名称的对象，因此您现在必须始终使用带引号的标识符来引用该对象以说“不要将其更改为大写”。

# arrays - 在 VBA 中，如何使用函数返回数组/或写入单元格？

> ID：846682
> 
> 赞同：5
> 
> 时间：2009-05-11T04:01:40.883
> 
> 标签：arrays, excel, vba, function, range

使用这个非常简单的功能：

```
Function WriteArray() as Variant
 Dim array(0 To 2)
 array(0) = "A"
 array(1) = "B"
 array(2) = "C"
 WriteArray = array
End Function 
```

我期待在我的 Excel 电子表格中看到整个数组的结果，但事实并非如此：我只得到第一个字符串。我知道在电子表格中显示整个数组是有技巧的（通过使用公式 + F2 + CTRL+SHIFT+ENTER 选择一系列单元格），但我更喜欢 VBA 来处理这一切。

我还尝试使用 Application.Caller 变量直接在“Caller”范围内写入，但代码中断。

非常感谢你的帮助！

编辑：这是我尝试使用的另一个代码：

```
Function WriteArray() As Variant
     Dim arr(0 To 2)
     arr(0) = "A"
     arr(1) = "B"
     arr(2) = "C"
     WriteArray = arr
     Dim StartRow, i As Integer
     For i = 0 To UBound(arr)
        Range("A" & i).Value = arr(i)
     Next
End Function 
```

它在“Range（“A”＆i）.Value = arr（i）”行处中断。我的 Excel 坏了吗？！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T04:15:18.240

以下代码将数组精美地写入一系列单元格：

```
Function WriteArray() As Variant
    Dim AbcList(0 To 2) as Variant
    AbcList(0) = "A"
    AbcList(1) = "B"
    AbcList(2) = "C"
    WriteArray = AbcList
End Function

Function WriteArrayToSpreadsheet()
    Dim MyArray As Variant
    MyArray = WriteArray()

    Dim StartRow, i As Integer
    StartRow = 1
    For i = 0 To UBound(MyArray)
        Range("A" & i + StartRow).Value = MyArray(i)
    Next
End Function 
```

话虽如此，我希望看到您实际尝试将其放入电子表格的代码部分，而不是您构建数组的位置。那我可以帮你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T08:41:39.083

您不能直接从 Excel 中的工作表函数写入非调用方单元格。

如果要使用数组函数（使用 Shift-Ctrl-Enter），则需要将代码更改为：

```
Function WriteArray() As Variant
    Dim arr(0 To 2, 0 To 1)
    arr(0, 0) = "A"
    arr(1, 0) = "B"
    arr(2, 0) = "C"
    WriteArray = arr
End Function 
```

如果您想在调用单元格之外写入，则需要实现某种形式的回调，该回调将使用自动化来写入其他单元格。这要复杂得多，而且更有可能破坏！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-12T18:50:08.347

秘诀是定义一个二维数组。数组的二维只是需要为数据集定义的范围。第一个数组维度是行偏移量，第二个维度是列偏移量。

在您的示例中，第二个维度只是没有“使用”：

```
 Sub Ente()

   Dim myArray(0 To 3, 0) As String
   myArray(0, 0) = "A"
   myArray(1, 0) = "B"
   myArray(2, 0) = "C"

   Range("B7:B" & UBound(myArray) + 6) = myArray

End Sub 
```

所以，不需要循环！简单快速。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-25T16:32:39.293

到目前为止，我所做的最好的解决方法是创建一个程序来获取您的范围引用和您的数组，并将其用作水平或垂直显示数据的起点......

如下：

```
Sub LoadArray(ByRef oRange, ByRef vArray)
    Dim I
    For I = 0 To UBound(vArray)
        oRange.Offset(I, 0).Value = vArray(I)
    Next
End Sub

'How to call:
Dim anyArray
anyArray = Array(1,2,3)

Call LoadArray(Range("anyRange"), anyArray) 
```

希望能帮助到你。

# python - PyQt 中复选框的 ListView

> ID：846684
> 
> 赞同：10
> 
> 时间：2009-05-11T04:02:36.327
> 
> 标签：python, qt, pyqt, qitemdelegate, qlistview

我想显示一个 QListView ，其中每个项目都是带有一些标签的复选框。复选框应始终可见。我能想到的一种方法是使用自定义委托和 QAbstractListModel。有没有更简单的方法？你能提供最简单的片段吗？

提前致谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-13T03:34:00.600

我最终使用了[David Boddie](https://stackoverflow.com/users/61047/david-boddie)在 PyQt 邮件列表中提供的方法。这是基于他的代码的工作片段：

```
from PyQt4.QtCore import *
from PyQt4.QtGui import *
import sys
from random import randint

app = QApplication(sys.argv)

model = QStandardItemModel()

for n in range(10):                   
    item = QStandardItem('Item %s' % randint(1, 100))
    check = Qt.Checked if randint(0, 1) == 1 else Qt.Unchecked
    item.setCheckState(check)
    item.setCheckable(True)
    model.appendRow(item)

view = QListView()
view.setModel(model)

view.show()
app.exec_() 
```

注意：将`setData`带有检查角色的调用更改为`setCheckState`并使用`setCheckable`而不是标志。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-12T19:49:48.683

如果您正在编写自己的模型，只需`Qt.ItemIsUserCheckable` 在方法的返回值中包含标志`flags()`，并确保您为方法返回`Qt.CheckStateRole`有效值`data()`。

如果您使用`QStandardItemModel`该类，`Qt.ItemIsUserCheckable` 请在传递给每个项目的方法的标志中包含标志，并使用其方法`setFlags()`设置检查状态。`Qt.CheckStateRole``setData()`

在交互式 Python 会话中，键入以下内容：

```
from PyQt4.QtGui import *

model = QStandardItemModel()
item = QStandardItem("Item")
item.setFlags(Qt.ItemIsUserCheckable | Qt.ItemIsEnabled)
item.setData(QVariant(Qt.Checked), Qt.CheckStateRole)
model.appendRow(item)

view = QListView()
view.setModel(model)
view.show() 
```

# eclipse - Eclipse WTP 更新错误。接下来做什么？

> ID：846685
> 
> 赞同：2
> 
> 时间：2009-05-11T04:04:33.373
> 
> 标签：eclipse, eclipse-wtp

我刚刚解压缩了 eclipse ganymede (eclipse 3.4.1) zip 文件（基本平台）并尝试通过其更新站点安装 Webtools (WTP)。但它报告一个错误，如..

```
Cannot complete the request.  See the details.
WST Common UI is already installed, so an update will be performed instead.
WST Common Core is already installed, so an update will be performed instead.
WST XML Core is already installed, so an update will be performed instead.
WST XML User Documentation is already installed, so an update will be performed instead.
Eclipse XML Editors and Tools is already installed, so an update will be performed instead.
Cannot find a solution where both Match[requiredCapability: org.eclipse.equinox.p2.iu/org.eclipse.jpt.doc.isv/[1.1.0.v200812110000,1.1.0.v200812110000]] and Match[requiredCapability: org.eclipse.equinox.p2.iu/org.eclipse.jpt.doc.isv/[1.0.0.v200805220000,1.0.0.v200805220000]] can be satisfied.
Cannot find a solution where both Match[requiredCapability: org.eclipse.equinox.p2.iu/org.eclipse.jpt.feature.feature.jar/[2.1.1.v200902200210-7A79BjDZRDE7GUMQDJGD,2.1.1.v200902200210-7A79BjDZRDE7GUMQDJGD]] and Match[requiredCapability: org.eclipse.equinox.p2.iu/org.eclipse.jpt.feature.feature.jar/[2.0.103.v200901160200-793DyCYQCD5FVHgCMCC,2.0.103.v200901160200-793DyCYQCD5FVHgCMCC]] can be satisfied. 
```

这个列表继续超过 100 条类似的行。我应该怎么做才能恢复 WTP 并将其安装到我的 eclipse ganymede 中 .. ???

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-29T17:55:18.447

您是否还让它同时搜索了 Ganymede 网站？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T04:12:52.940

你已经看过这个了吗？

[http://www.eclipse.org/webtools/faq/GettingSource/](http://www.eclipse.org/webtools/faq/GettingSource/)

将 WTP 放在 Ganymede 上的说明与其他版本的 Eclipse 不同。

# java - 我们可以延迟响应 XMPP 在线状态订阅吗？

> ID：846699
> 
> 赞同：4
> 
> 时间：2009-05-11T04:15:38.020
> 
> 标签：java, xmpp, openfire, smack

我正在使用 PacketListener 接收 XMPP 数据包。

如果我收到以下信息：

```
<presence from="jeanne@belle.com" to="betty@belle.com" type="subscribe"/> 
```

XMPP 服务器是否希望我立即响应？

*   **动机**：我想缓存所有这些订阅请求并允许收件人有选择地接受/拒绝（à la facebook 邀请）。
*   是否有一个 API 可以让我从 openfire 请求所有订阅请求？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T14:17:33.463

您不需要立即回复，甚至不需要在给定的会话中回复；服务器存储您有待处理的入站订阅的事实，并且每次登录时都会重新通知您待处理的订阅。因此，也不需要请求列表。

# c# - 在 Excel 2003 中使用 WCF？

> ID：846704
> 
> 赞同：4
> 
> 时间：2009-05-11T04:18:08.797
> 
> 标签：c#, .net, wcf, excel

有谁知道或可以找到一些示例代码来展示如何使用 Excel 2003 调用 WCF 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T07:23:30.617

如果你想从 Excel2003 调用 WCF Web 服务并且你不想使用 VSTO，你需要一个 COM 兼容的选项（No .Net）。

尽管它已被弃用（并且不酷），但您可以使用服务器上的 basicHttpBinding 和 [Soap Toolkit来实现此目的](http://www.microsoft.com/downloads/details.aspx?FamilyId=C943C0DD-CEEC-4088-9753-86F052EC8450&displaylang=en)

如果您不想这样做，您可以使用 .Net 程序集进行调用，并使用 COM Interop 从 Excel 调用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T04:27:16.363

本文的目标[是使用 Microsoft Office System 的 Visual Studio 工具在 Excel 中访问 Web 服务](http://msdn.microsoft.com/en-au/library/aa168471.aspx)，并且该信息应该同样适用于 WCF 服务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T04:28:41.320

我没有最适合你的赢家，这可能会很困难。Office 2007 的开发变得更好了。但是，鉴于此，您应该查看[Visual Studio Tools for Office](http://msdn.microsoft.com/en-us/vsto/default.aspx)。 [下面是一些将 VSTO 与 Excel 2003 结合使用的示例](http://www.microsoft.com/downloads/details.aspx?familyid=f220681f-fbe5-4ad1-b517-229079a16cb4&displaylang=en)。 [这是一篇](http://msdn.microsoft.com/en-us/magazine/cc163292.aspx)关于如何从 Office 2007 应用程序调用 WCF 的文章。你应该能够成功地采用它。总帐。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-06T06:58:00.270

您可能想查看使用 WCF 服务名字对象，它允许您从 VBA 调用 WCF 服务，而无需在 Excel 客户端计算机上安装任何东西，而不是 .NET Framework。

```
Dim addr As String
addr = "service:mexAddress=""net.tcp://localhost:7891/Test/WcfService1/Service1/Mex"","
addr = addr + "address=""net.tcp://localhost:7891/Test/WcfService1/Service1/"","
addr = addr + "contract=""IService1"", contractNamespace=""http://tempuri.org/"","
addr = addr + "binding=""NetTcpBinding_IService1"",bindingNamespace=""http://tempuri.org/"""

Dim service1 As Object
Set service1 = GetObject(addr)

MsgBox service1.GetData(12) 
```

我已经写了一个[完整的分步示例](http://damianblog.com/2009/07/05/excel-wcf/)。

/达米安

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T17:46:45.273

REST 服务也可以很好地与 Excel 配合使用。
如果您使用“WebHttpBinding”，您可以使用 File -> Open 或通过 Import External data -> Xml 将数据导入 Excel。
虽然 2003 年不是很完美（2007 年好多了）。

# asp.net - 用于将非英文字符存储到 SQL 数据库的 HTML/ASPX 文本框

> ID：846709
> 
> 赞同：2
> 
> 时间：2009-05-11T04:23:31.063
> 
> 标签：asp.net, sql, html, unicode

我在 .aspx 页面上有这个文本框，提交时它将在文本框中输入的任何内容存储到 MS SQL 2005 中的 nvarchar 列中。

它工作正常，直到您尝试输入中文字符。
这些字符在数据库中转换为问号 (?)。

如何将 <input type="text"> 中的非英语字符存储到数据库中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T04:28:24.333

主要是确保管道的每一步都支持国际字符；即 - 你在什么时候第一次看到“？” ? 在aspx代码中？或者只有当它进入数据库表时？

网页应该已经使用了 UTF8 之类的编码，所以应该没问题 - 但是您在数据库中使用的是什么数据类型？它需要是`nchar`// `nvarchar(n)`（`nvarchar(max)`或`ntext`在旧版本的 SQL Server 上）。

# blackberry - BlackBerry 的 BouncyCastle RSA 加密

> ID：846710
> 
> 赞同：5
> 
> 时间：2009-05-11T04:24:13.670
> 
> 标签：blackberry, java-me, rsa

如何为 BlackBerry 应用程序实施 BouncyCastle RSA 加密？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T14:02:30.517

正如@itsteju 指出的那样，您可以使用 BlackBerry 方法获得相同的功能，但这确实需要协议和向 Certicom 支付版税。

[Bouncy Castle 在其发布页面](http://www.bouncycastle.org/latest_releases.html)上维护了一个与 J2ME 兼容的版本。这不是他们的完整 API，但确实支持 RSA 加密。

由于他们提供源代码，因此将他们的 RSA 代码集成到您的项目中的最简单方法是将他们的 .java 源文件添加到您的项目中并进行构建。我记得（我没有现成的源代码）他们在 java.lang 包中提供了一些类（例如 BigInteger）——或者至少他们曾经这样做过。黑莓不会让您的应用程序与这些一起运行，因此您必须重命名包以及您下载的源代码中对它的所有引用。请注意，我上次这样做是几年前，所以事情可能已经改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T09:33:56.317

有一套标准的方法可用于 RSA 加密。检查 API 文档。这些已获得 Certicom 的许可。在使用 RSA 加密之前，您需要获得从 Certicom 购买的密钥。

# bluetooth - 如何设置设备/dev/rfcomm0 的权限？

> ID：846723
> 
> 赞同：0
> 
> 时间：2009-05-11T04:36:14.290
> 
> 标签：bluetooth, kannel

我正在尝试运行 kannel 承载盒，但出现无法写入/读取设备之类的错误。我认为 kannel 没有权限读/写蓝牙设备 /dev/rfcomm0

谢谢阅读。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T05:04:45.303

用root账户做

```
chmod a+rw /dev/rfcomm0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T05:34:50.747

如果您知道哪个程序正在生成错误消息，请运行该程序`strace`并查看哪个系统调用产生了错误。如果是`open`，那么`chmod`Francis 推荐的解决方案应该可以解决问题。如果是`read`或`write`，那么您应该进一步调查：内核或应用程序代码是否存在问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-27T10:40:09.350

可以通过使用 ls -h 检查设备文件组并使用以下命令将当前用户添加到该组来添加访问蓝牙设备的权限：

```
sudo usermod -a -G <rfcomm0 group> $USER 
```

# django-models - 重构我的 django 模型是否安全？

> ID：846727
> 
> 赞同：1
> 
> 时间：2009-05-11T04:43:09.643
> 
> 标签：django-models

我的模型与此类似。这可以吗，还是我应该将公共基类抽象化？这之间有什么区别或使其抽象并且没有额外的表格？现在我已经把东西分解了，现在只有一个主键似乎很奇怪。

```
class Input(models.Model):
        details = models.CharField(max_length=1000)
        user = models.ForeignKey(User)
        pub_date = models.DateTimeField('date published')
        rating = models.IntegerField()

        def __unicode__(self):
            return self.details

    class Case(Input):
        title  = models.CharField(max_length=200)
        views = models.IntegerField()

    class Argument(Input):
        case = models.ForeignKey(Case)
        side = models.BooleanField() 
```

可以排除 intpu 输入的内容吗？我注意到 Cases 和 Arguments 共享一个主键。

像这样：

```
 CREATE TABLE "cases_input" (
        "id" integer NOT NULL PRIMARY KEY,
        "details" varchar(1000) NOT NULL,
        "user_id" integer NOT NULL REFERENCES "auth_user" ("id"),
        "pub_date" datetime NOT NULL,
        "rating" integer NOT NULL
    )
    ;
    CREATE TABLE "cases_case" (
        "input_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "cases_input" ("id"),
        "title" varchar(200) NOT NULL,
        "views" integer NOT NULL
    )
    ;
    CREATE TABLE "cases_argument" (
        "input_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "cases_input" ("id"),
        "case_id" integer NOT NULL REFERENCES "cases_case" ("input_ptr_id"),
        "side" bool NOT NULL
    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T03:16:12.220

来自：[django 网站](http://docs.djangoproject.com/en/dev/topics/db/models/#abstract-base-classes)

当您想将一些公共信息放入许多其他模型中时，抽象基类很有用。您编写基类并将 abstract=True 放在 Meta 类中。该模型将不会用于创建任何数据库表。相反，当它用作其他模型的基类时，它的字段将添加到子类的字段中。

# bash - shell中棘手的大括号扩展

> ID：846730
> 
> 赞同：8
> 
> 时间：2009-05-11T04:44:32.183
> 
> 标签：bash, shell, brace-expansion

使用 POSIX shell 时，以下内容

```
touch {quick,man,strong}ly 
```

扩展到

```
touch quickly manly strongly 
```

哪个会触及文件`quickly`、`manly`和`strongly`，但是否可以动态创建扩展？例如，下面说明了我想做的事情，但由于扩展顺序而不起作用：

```
TEST=quick,man,strong    #possibly output from a program
echo {$TEST}ly 
```

有什么办法可以做到这一点？如果需要，我不介意将自己限制在 Bash 中。我也想避免循环。扩展应该作为任意程序的完整参数给出（即程序不能为每个文件调用一次，它只能为所有文件调用一次）。我知道，`xargs`但我希望这一切都可以以某种方式从外壳完成。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-11T06:26:29.133

...使用`eval`. 您要问的问题只能通过`eval`,**但**您可能**想要**的内容很容易实现，而无需求助于 bash bug-central。

使用数组！每当您需要在*一种数据类型中保留**多个*项目时，您需要（或*应该*使用）一个数组。

 **```
TEST=(quick man strong)
touch "${TEST[@]/%/ly}" 
```

这正是您想要的，没有在此处的其他建议中引入和隐藏的数千个错误和安全问题。

它的工作方式是：

*   `"${foo[@]}"``foo`：扩展通过扩展其每个元素命名的数组，并正确引用。不要忘记引号！
*   `${foo/a/b}`: 这是一种参数扩展，它用 a 替换了第一个`a`in`foo`的扩展`b`。在这种类型的扩展中，您可以使用`%`来表示*扩展值的结束*，有点像`$`正则表达式中的。
*   将所有这些放在一起， "${foo[@]/%/ly}" 将扩展 的每个元素`foo`，将其正确引用为单独的参数，并将每个元素的结尾替换为`ly`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T04:51:49.910

在 bash 中，您可以这样做：

```
#!/bin/bash
TEST=quick,man,strong
eval echo $(echo {$TEST}ly)
#eval touch $(echo {$TEST}ly) 
```

最后一行被注释掉，但会触及指定的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-19T12:16:05.520

Zsh 可以轻松做到这一点：

```
TEST=quick,man,strong
print ${(s:,:)^TEST}ly 
```

变量内容以逗号分隔，然后将每个元素分布到大括号周围的字符串中：

```
quickly manly strongly 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T05:08:11.757

从上面的答案中汲取灵感：

```
$ TEST=quick,man,strong
$ touch $(eval echo {$TEST}ly) 
```

# linq-to-sql - LINQ To SQL - 选择一个常量值

> ID：846735
> 
> 赞同：2
> 
> 时间：2009-05-11T04:48:53.957
> 
> 标签：linq-to-sql

在 SQL 中，您可以选择一个常量值：

```
Select "Constant Text", Column1, Column2 From TableX 
```

从 TableX 返回的每一行都以包含文本“常量文本”的列开头。
关于如何在 LINQ to SQL 中执行此操作的任何想法？
如果我执行上述操作，我会收到错误消息“范围变量名称只能从不带参数的简单名称或限定名称中推断出来。”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T05:00:32.783

实际上，生成的匿名类中的每个属性都需要一个名称，因此在下面的代码中，我们将命名常量 column `ConstantColumn`。第 2 和第 3 属性默认采用查询列的名称，因此它们将分别命名为`Column1`和`Column2`：

```
var query = from x in db.TableX
            select new
            {
                ConstantColumn = "Constant Text",
                x.Column1,
                x.Column2
            }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T04:52:39.940

从 dc.TableX 中的 tx 选择新 {“常量文本”，tx.Column1，tx.Column2 };

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T04:53:05.337

```
var db = new DataContext();

var query = from x in db.TableX
            select new {"Constant Text", x.Column1, x.Column2}; 
```

..我认为是这样的。

# desktop-application - 桌面应用程序的 Adsense 等效项？

> ID：846740
> 
> 赞同：25
> 
> 时间：2009-05-11T04:51:58.833
> 
> 标签：desktop-application, ads, adsense

Jeff 过去曾[提到](https://stackoverflow.fogbugz.com/default.asp?W2434)，直接与广告商打交道是“一个很好的模式，如果你能做到的话”，但我想获得将广告商吸引到桌面应用程序的临界质量将是困难的，并且一些基于广告的资金在临时会很棒。所以对于我的问题：

*   是否有任何适用于桌面应用程序的 Adsense 类型的服务（或正在开发）？
*   关于吸引广告商参与相对较小规模的桌面应用程序项目的任何技巧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-27T02:59:36.237

BSA 似乎为桌面应用程序提供广告

[http://blog.buysellads.com/2010/04/using-bsa-for- sell-ads-in-a-desktop-application/](http://blog.buysellads.com/2010/04/using-bsa-for-selling-ads-in-a-desktop-application/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-06T13:32:12.477

正如我之前发布的：

有很多更好的方法可以让您将现金注入器引导到您的应用程序中。广告注入的应用程序往往不会预成型，而那些不是。

任何您认为比免费更有价值但担心如果不付费可能会导致下载量减少的应用程序至少应该有一种简单的捐赠方式。人们经常忽略这个事实，但我认识的很多人，如果给出解决该问题的应用程序将捐赠 5 美元左右。这听起来可能不是很多，但鉴于没有理由不实施这一点，这基本上是一分钱一分货。

另一种选择是看看你是否可以用你的引导一个类似的应用程序。如果这是以专业的方式完成的，并且用户能够不安装第二个应用程序，那么它可能是一个很好的收入来源，并且没有令人讨厌的广告让用户与之抗衡。

最后一个选择是问自己是否愿意为此付费？许多人放弃了人们愿意花几美元购买的应用程序。考虑一个营销活动，宣传以优惠的价格提供出色的软件。许多人（又是我自己）为运行良好的软件付费。当然，您可能会找到免费的破解版，但很多人尊重人们应该得到报酬的事实。

pinnicale profiler、ultramon 和 regex buddy 是付费软件的一些例子。我已经支付了所有这些费用，并且很乐意为第二轮支付费用。

# java - Android 中的 XML 模式验证

> ID：846748
> 
> 赞同：3
> 
> 时间：2009-05-11T04:54:13.433
> 
> 标签：java, android

我已经创建了一个 XML，我想使用模式进行验证，即 XSD 文件，但是如果我没有错的话，android 没有提供相同的直接类......并且有一个名为的外部 `jaxp1.3`jar不允许我编译代码是因为桌面和android的字节码不同吗？其中有类模式工厂和验证器，它们进行验证......是否有其他选项可用。任何帮助将不胜感激.....拼命寻找答案............

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T18:37:05.390

[这是 Google在这里](http://code.google.com/p/android/issues/detail?id=7395)发布的一个已知问题

解决方案是使用移植到 Android 的 Apache Xerces。[这里](http://code.google.com/p/xerces-for-android/)有一个项目

您必须执行 svn chekout 并将 proyect 导出到 jar 文件以用作您的 android proyect 中的库。

SchemaFactory 实例的代码稍作更改。我给你看一个例子：

```
import mf.javax.xml.validation.Schema;
import mf.javax.xml.validation.SchemaFactory;
import mf.javax.xml.validation.Validator;
import mf.org.apache.xerces.jaxp.validation.XMLSchemaFactory;

SchemaFactory  factory = new XMLSchemaFactory();
Schema esquema = factory.newSchema(".../file.xsd"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-17T22:33:23.457

@iOSDev，我必须使用 Xerces-for-Android 进行验证。以下是我为使其与我的程序一起工作所做的工作的摘要：

1.  创建验证实用程序。
2.  将 xml 和 xsd 都放入 android 操作系统上的文件中，并针对它使用验证实用程序。
3.  使用 Xerces-For-Android 进行验证。

Android确实支持我们可以使用的一些包，我创建了我的xml验证实用程序，基于：[http ://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html)

我最初的沙盒测试使用 java 非常顺利，然后我尝试将其移植到 Dalvik 并发现我的代码不起作用。Dalvik 不支持某些东西，所以我做了一些修改。

我找到了对 android 的 xerces 的引用，所以我修改了我的沙盒测试（**以下不适用于 android，之后的示例可以**）：

```
import java.io.File;

import javax.xml.XMLConstants;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.transform.Source;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamSource;
import javax.xml.validation.Schema;
import javax.xml.validation.SchemaFactory;
import javax.xml.validation.Validator;

import org.w3c.dom.Document;

/**
 * A Utility to help with xml communication validation.
 */
public class XmlUtil {

    /**
     * Validation method. 
     * Base code/example from: http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/validation/package-summary.html
     * 
     * @param xmlFilePath The xml file we are trying to validate.
     * @param xmlSchemaFilePath The schema file we are using for the validation. This method assumes the schema file is valid.
     * @return True if valid, false if not valid or bad parse. 
     */
    public static boolean validate(String xmlFilePath, String xmlSchemaFilePath) {

        // parse an XML document into a DOM tree
        DocumentBuilder parser = null;
        Document document;

        // Try the validation, we assume that if there are any issues with the validation
        // process that the input is invalid.
        try {
            // validate the DOM tree
            parser = DocumentBuilderFactory.newInstance().newDocumentBuilder();
            document = parser.parse(new File(xmlFilePath));

            // create a SchemaFactory capable of understanding WXS schemas
            SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

            // load a WXS schema, represented by a Schema instance
            Source schemaFile = new StreamSource(new File(xmlSchemaFilePath));
            Schema schema = factory.newSchema(schemaFile);

            // create a Validator instance, which can be used to validate an instance document
            Validator validator = schema.newValidator();
            validator.validate(new DOMSource(document));
        } catch (Exception e) {
            // Catches: SAXException, ParserConfigurationException, and IOException.
            return false;
        }     

        return true;
    }
} 
```

上面的代码必须进行一些修改才能与 xerces for android ( [http://gc.codehum.com/p/xerces-for-android/](http://gc.codehum.com/p/xerces-for-android/) ) 一起使用。你需要SVN来获取项目，以下是一些婴儿床笔记：

```
download xerces-for-android
    download silk svn (for windows users) from http://www.sliksvn.com/en/download
        install silk svn (I did complete install)
        Once the install is complete, you should have svn in your system path.
        Test by typing "svn" from the command line.
        I went to my desktop then downloaded the xerces project by:
            svn checkout http://xerces-for-android.googlecode.com/svn/trunk/ xerces-for-android-read-only
        You should then have a new folder on your desktop called xerces-for-android-read-only 
```

使用上面的jar（最终我会把它做成一个jar，直接将它复制到我的源代码中以便快速测试。如果你想这样做，你可以用Ant快速制作jar（[http://ant.apache .org/manual/using.html](http://ant.apache.org/manual/using.html) ))，我能够获得以下内容来进行我的 xml 验证：

```
import java.io.File;
import java.io.IOException;

import mf.javax.xml.transform.Source;
import mf.javax.xml.transform.stream.StreamSource;
import mf.javax.xml.validation.Schema;
import mf.javax.xml.validation.SchemaFactory;
import mf.javax.xml.validation.Validator;
import mf.org.apache.xerces.jaxp.validation.XMLSchemaFactory;

import org.xml.sax.SAXException;

/**
 * A Utility to help with xml communication validation.
 */public class XmlUtil {

    /**
     * Validation method. 
     * 
     * @param xmlFilePath The xml file we are trying to validate.
     * @param xmlSchemaFilePath The schema file we are using for the validation. This method assumes the schema file is valid.
     * @return True if valid, false if not valid or bad parse or exception/error during parse. 
     */
    public static boolean validate(String xmlFilePath, String xmlSchemaFilePath) {

        // Try the validation, we assume that if there are any issues with the validation
        // process that the input is invalid.
        try {
            SchemaFactory  factory = new XMLSchemaFactory();
            Source schemaFile = new StreamSource(new File(xmlSchemaFilePath));
            Source xmlSource = new StreamSource(new File(xmlFilePath));
            Schema schema = factory.newSchema(schemaFile);
            Validator validator = schema.newValidator();
            validator.validate(xmlSource);
        } catch (SAXException e) {
            return false;
        } catch (IOException e) {
            return false;
        } catch (Exception e) {
            // Catches everything beyond: SAXException, and IOException.
            e.printStackTrace();
            return false;
        } catch (Error e) {
            // Needed this for debugging when I was having issues with my 1st set of code.
            e.printStackTrace();
            return false;
        }

        return true;
    }
} 
```

**一些旁注：**

为了创建文件，我制作了一个简单的文件实用程序来将字符串写入文件：

```
public static void createFileFromString(String fileText, String fileName) {
    try {
        File file = new File(fileName);
        BufferedWriter output = new BufferedWriter(new FileWriter(file));
        output.write(fileText);
        output.close();
    } catch ( IOException e ) {
       e.printStackTrace();
    }
} 
```

我还需要写一个我可以访问的区域，所以我使用了：

```
String path = this.getActivity().getPackageManager().getPackageInfo(getPackageName(), 0).applicationInfo.dataDir; 
```

有点hackish，它有效。我确信有一种更简洁的方法可以做到这一点，但是我想我会分享我的成功，因为我没有找到任何好的例子。

# php - Kohana 中的视图可以访问其父视图的变量吗？

> ID：846749
> 
> 赞同：0
> 
> 时间：2009-05-11T04:55:28.267
> 
> 标签：php, kohana

这适用于 Kohana 2.3.2

我最近开始让我的观点更有活力。使用默认模板视图作为基础，现在我在控制器中做

```
$this->template->innerView = new View('article'); 
```

然后，在我的中间`template.php`，我有

```
<?php echo $innerView; ?> 
```

在我的页眉和页脚之间呼应文章视图的“胆量”。这很好用，除了我定义的所有变量`$this->template`都无法从新视图中访问。我知道我可能会做

```
$this->template->innerView->title = 'My Title'; 
```

但是如果有办法让子视图继承父视图的变量，那就太好了。

有没有？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T10:55:02.533

set_global() 方法仅将变量设置为在所有视图中都是全局的。当您在 PHP 中听到“全局”时，这不是您的想法，所以您做对了，这正是您想要使变量在多个视图中可用时应该使用的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-11T05:53:02.197

[http://docs.kohanaphp.com/core/view#set_global](http://docs.kohanaphp.com/core/view#set_global)

我需要这个，因为我使用普通模板中的页面标题（for inside `<title></title>`）以及`<h2></h2>`页面的。

就这么简单

```
$this->template->innerView = new View('article');
$this->template->set_global('title', 'My Title'); 
```

# json - 简单、安全的 API 认证系统

> ID：846752
> 
> 赞同：36
> 
> 时间：2009-05-11T04:56:31.043
> 
> 标签：json, api, rest, key

我有一个简单的 REST JSON API 供其他网站/应用程序访问我网站的一些数据库（通过 PHP 网关）。基本上该服务的工作方式如下：调用 example.com/fruit/orange，服务器返回有关橙子的 JSON 信息。问题是：我只希望我允许访问此服务的网站。使用简单的 API 密钥系统，任何网站都可以通过从授权网站的（可能的）客户端代码中复制密钥来快速获取密钥。我看过 OAuth，但我正在做的事情似乎有点复杂。解决方案？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-06T06:59:00.840

您应该使用 OAuth。

实际上有两种 OAuth 规范，三足版和两足版。三足版是最受关注的，*不是*你想用的。

好消息是 2-legged 版本完全符合您的要求，它允许应用程序通过共享密钥授予对另一个应用程序的访问权限（非常类似于 Amazon 的 Web 服务模型，您将使用 HMAC-SHA1 签名方法）或通过公钥/私钥系统（使用签名方法：RSA-SHA1）。坏消息是，它还没有像 3-legged 版本那样得到很好的支持，所以你现在可能需要做更多的工作。

基本上，2-legged OAuth 只是指定了一种“签名”（计算散列）几个字段的方法，这些字段包括当前日期、一个称为“nonce”的随机数以及您的请求参数。这使得模拟对您的 Web 服务的请求变得*非常困难。*

OAuth 正在缓慢但肯定地成为这类事情的公认标准——如果你接受它，从长远来看，你会得到最好的结果，因为人们可以利用各种可用的库来做到这一点。

它比您最初想要的要复杂得多 - 但好消息是很多人在它上面花了很多时间，所以您知道您没有忘记任何东西。一个很好的例子是，最近 Twitter 发现了社区目前正在努力弥补的 OAuth 安全漏洞。如果您发明了自己的系统，那么您必须自己解决所有这些问题。

祝你好运！

克里斯

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-03-09T09:43:12.503

***OAuth 不是这里的解决方案***。
OAuth 是当您拥有最终用户并希望第 3 方应用程序不处理最终用户密码时。何时使用 OAuth： [http ://blog.apigee.com/detail/when_to_use_oauth/](http://blog.apigee.com/detail/when_to_use_oauth/)

***去简单的 api-key***。
如果需要更安全的解决方案，请采取额外措施。

这是更多信息，[http://blog.apigee.com/detail/do_you_need_api_keys_api_identity_vs._authorization/](http://blog.apigee.com/detail/do_you_need_api_keys_api_identity_vs._authorization/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T05:25:01.963

如果某人的客户端代码被泄露，他们应该获得一个新密钥。如果他们的代码被公开，您将无能为力。

但是，您可以通过要求在您的系统中为给定密钥注册授权服务器的 IP 地址来更加严格。这增加了一个额外的步骤，可能是矫枉过正。

我不确定使用“简单 API 密钥”是什么意思，但您应该使用某种具有私钥的身份验证（仅客户端和服务器知道），然后对数据执行某种校验和算法以确保客户确实是您认为的那个人，并且数据在传输过程中没有被修改。 [Amazon AWS](http://docs.amazonwebservices.com/AmazonSimpleDB/latest/DeveloperGuide/)就是一个很好的例子来说明如何做到这一点。

我认为保证代码没有在您的客户端受到损害可能有点严格。我认为让您的客户对自己的数据安全负责是合理的。当然，这假设攻击者只能弄乱该客户的帐户。

也许您可以记录某个特定帐户的 ip 请求来自哪些日志，如果出现新 ip，标记该帐户，向客户发送电子邮件，并要求他们授权该 ip。我不知道这样的事情可能会奏效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T05:59:28.567

基本上你有两个选择，要么通过 IP 限制访问，要么拥有 API 密钥，这两个选项都有其积极和消极的一面。

IP 限制
这可能是一种方便的方式来限制对您的服务的访问。您可以准确定义哪些 3rd 方服务将被允许访问您的服务，而无需强制它们实施任何特殊的身份验证功能。然而，这种方法的问题是，如果 3rd 方服务是完全用 JavaScript 编写的，那么传入请求的 IP 将不是 3rd 方服务的服务器 IP，而是用户的 IP，因为发出请求由用户的浏览器而不是服务器。因此，使用 IP 限制将无法编写客户端驱动的应用程序，并强制所有请求通过具有适当访问权限的服务器。请记住，IP 地址也可能被欺骗。

API 密钥 API 密钥
的优点是您不必维护已知 IP 的列表，您必须维护 API 密钥列表，但自动化维护更容易。基本上它的工作原理是你有两个密钥，例如一个用户 ID 和一个秘密密码。对您的服务的每个方法请求都应提供一个由请求参数、用户 ID 和这些值的哈希组成的身份验证哈希（其中秘密密码用作哈希盐）。这样，您既可以进行身份​​验证，也可以限制访问。问题在于，如果第 3 方服务被编写为客户端驱动（例如 JavaScript 或 ActionScript），那么任何人都可以从代码中解析出用户 ID 和秘密盐值。

基本上，如果您想确保仅允许您专门定义的少数服务访问您的服务，那么您唯一的选择是使用 IP 限制，从而强制它们通过其服务器路由所有请求。如果您使用 API 密钥，则无法强制执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-05T20:04:23.117

在连接之前，IP 安全性的所有生产似乎都会对用户产生巨大的错误。Symbian 60s 具有在多个用户（应用 Opera Handler UI 6.5、Opera Mini v8 和 10）以及编码 UI 和完全填充的网络设置中留下未追踪、可靠和安全信号的最完整功能。当最终获得可发现的快速链接方法时，为什么要限制其他特征。保持一个更明确的账户，正确监控那个“真实账户”——如果他们在支付账单的轨道上——并知道用户是否有未过期的维持余额，这将创建一个更快的互联网信号链接到流行/签名的移动设备行业。为什么要在将它们带到站点之前制作硬安全功能，每月访问他们的帐户可能会消除所有连接问题？如果他们有未付的账单，所有移动用户都应该没有“连接”的能力。为什么不提供一个“ALL in One” - 注册/应用程序帐户，一个由操作系统修复的程序，（可能是一个电子邮件帐户），而不是提供一个“监控功能”，如果他们支付与否（密码问题问题应该给出到其他部门）。如果“不”完全关闭他们的帐户和其他链接功能。他们每个人都有自己的兴趣每天在哪里上钩，如果您因未付账单而锁定/关闭它们，这可能会促使他们重新订阅并更多地训练他们以成为更负责任的用户，甚至可能过期如果没有维护一个帐户。每月监控或访问已识别的 ' 与网络提供商合作的“真实帐户”可以产生更高的隐私，而不是总是要求用户提供“姓名”和“密码”、“位置”、“权限”来查看他们的数据服务。IP 已经标记了他们的第一个身份或“查找用户的位置”，因此，将其放在浏览器预搜索中似乎是不必要的，为什么不使用“获取数据”或“处理数据”。

# c# - C#：在字符串中查找字符串的实例

> ID：846753
> 
> 赞同：0
> 
> 时间：2009-05-11T04:56:56.300
> 
> 标签：c#, string, matching

假设我有字符串“1 AND 2 AND 3 OR 4”，并且想要创建一个字符串数组，其中包含在字符串中按顺序找到的所有子字符串“AND”或“OR”。

所以上面的字符串会返回一个 {"AND", "AND", "OR"} 的字符串数组。

什么是聪明的写作方式？

编辑：使用 C# 2.0+，

```
string rule = "1 AND 2 AND 3 OR 4";
string pattern = "(AND|OR)";
string[] conditions = Regex.Split(rule, pattern); 
```

给我{“1”，“AND”，“2”，“AND”，“3”，“OR”，“4”}，这不是我想要的。我怎样才能将其简化为 AND 和 OR？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:01:40.160

您可能正在寻找标记器或 Lexer，请查看以下文章：

[C# 正则表达式配方——更好的分词器](http://en.csharp-online.net/CSharp_Regular_Expression_Recipes%E2%80%94A_Better_Tokenizer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T05:09:05.093

这个正则表达式（.NET）似乎做你想做的事。您正在索引 = 1 的组中查找匹配项（多个）：

```
.*?((AND)|(OR))*.*? 
```

**编辑**我已经测试了以下内容，它似乎可以满足您的要求。它比我想要的要多，但它以纯粹的正则表达式方式处理任务（恕我直言，你应该这样做）：

```
 string text = "1 AND 2 AND 3 OR 4";
        string pattern = @"AND|OR";

        Regex r = new Regex(pattern, RegexOptions.IgnoreCase);

        Match m = r.Match(text);
        ArrayList results = new ArrayList();
        while (m.Success)
        {
            results.Add(m.Groups[0].Value);

            m = m.NextMatch();
        }

        string[] matchesStringArray = (string[])results.ToArray(typeof(string)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T05:37:03.083

既然您知道要查找的确切子字符串...为什么不直接使用 [IndexOf(substr, iOffset)](http://msdn.microsoft.com/en-us/library/5xkyx09y.aspx)来了解出现次数（循环直到它返回-1）？

根据您任务的复杂性，它可能比使用正则表达式更简单/更快（因为您没有匹配模式）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T06:24:34.813

```
string rule = "1 AND 2 AND 3 OR 4";
string pattern = "(AND|OR)";
MatchCollection conditions = Regex.Matches(rule, pattern); 
```

使用 Match.Value 获取字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T05:49:59.363

这是我想出的一个愚蠢的方法：

```
string rule = "1 AND 2 AND 3 OR 4";
List<string> andsOrs = new List<string>();
string[] split = rule.Split();
for (int i = 0; i < split.Length; i++)
{
   if (split[i] == "AND" || split[i] == "OR")
   {
       andsOrs.Add(split[i]);
   }
}
string[] conditions = andsOrs.ToArray();
return conditions; 
```

# c# - 用于 ASP.NET 应用程序的可配置工作流引擎

> ID：846754
> 
> 赞同：1
> 
> 时间：2009-05-11T04:57:20.307
> 
> 标签：c#, asp.net, workflow, workflow-activity

我想为 ASP.NET 应用程序使用用户可配置的工作流引擎。工作流引擎应该为最终用户提供一个基于 Web 的图形设计器和一个用于以图形方式集成最终用户设计的工作流的 API。有人对基于 .Net 的开源可配置工作流引擎或商业产品有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:07:22.740

我使用过 Windows Workflow Foundation ( [WF](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx) ) 和[K2.net](http://www.k2.com/en/index.aspx)（我猜他们现在称之为 blackpearl）。两者都很棒，也不是开源的，K2 有点花钱。

# c# - 在 C# 中静态方法的形式参数中使用“this”关键字

> ID：846766
> 
> 赞同：329
> 
> 时间：2009-05-11T05:05:01.777
> 
> 标签：c#, parameters, this

我遇到了几个 C# 代码实例，如下所示：

```
public static int Foo(this MyClass arg) 
```

在这种情况下，我无法找到`this`关键字含义的解释。有什么见解吗？

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2009-05-11T05:08:13.580

这是一种**扩展方法**。请参阅此处了解[说明](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)。

> 扩展方法允许开发人员向现有 CLR 类型的公共协定添加新方法，而无需对其进行子类化或重新编译原始类型。扩展方法有助于将当今动态语言中流行的“鸭子类型”支持的灵活性与强类型语言的性能和编译时验证相结合。
> 
> 扩展方法支持各种有用的场景，并帮助实现真正强大的 LINQ 查询框架......

这意味着你可以打电话

```
MyClass myClass = new MyClass();
int i = myClass.Foo(); 
```

而不是

```
MyClass myClass = new MyClass();
int i = Foo(myClass); 
```

这允许构建[流畅的接口](http://en.wikipedia.org/wiki/Fluent_interface)，如下所述。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2011-03-21T10:54:36.583

[Scott Gu 引用的博客文章](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)很好地解释了这一点。

对我来说，该问题的答案在该帖子的以下声明中：

> 请注意上面的静态方法如何在字符串类型的第一个参数参数之前有一个“this”关键字。这告诉编译器这个特定的扩展方法应该被添加到“字符串”类型的对象中。在 IsValidEmailAddress() 方法实现中，我可以访问调用该方法的实际字符串实例的所有公共属性/方法/事件，并根据它是否为有效电子邮件返回真/假。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-11-12T17:33:21.637

^([除了 Preet Sangha 的解释：](https://stackoverflow.com/a/846773))
Intellisense 用蓝色箭头显示扩展方法（例如在“Aggregate<>”前面）：

![在此处输入图像描述](https://i.stack.imgur.com/9DHYk.png)

你需要一个

```
using the.namespace.of.the.static.class.with.the.extension.methods; 
```

如果扩展方法与使用它们的代码位于不同的命名空间中，则它们可以显示并可用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-11T05:09:29.210

它们是[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。欢迎来到一个全新的[流畅世界](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplex-com-extensionoverflow)。:)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-11T05:08:14.097

前几天我自己才知道这一点：this 关键字定义该方法是执行它的类的扩展。因此，对于您的示例，MyClass 将有一个名为 Foo 的新扩展方法（它不接受任何参数并返回一个 int；它可以与任何其他公共方法一起使用）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-09-08T08:55:13.287

如果您可以巧妙地弹出一个 List<>，即不仅删除第一个元素，而且还返回它，那不是很方便吗？

```
List<int> myList = new List<int>(1, 2, 3, 4, 5); 
```

**没有扩展方法：**

```
public static class ContainerHelper
{
    public static T PopList<T>(List<T> list)
    {
        T currentFirst = list[0];
        list.RemoveAt(0);
        return currentFirst;
    }
} 
```

调用此方法：

```
int poppedItem = ContainerHelper.PopList(myList); 
```

**使用扩展方法：**

```
public static class ContainerHelper
{
    public static T PopList<T>(this List<T> list)//Note the addition of 'this'
    {
        T currentFirst = list[0];
        list.RemoveAt(0);
        return currentFirst;
    }
} 
```

调用此方法：

```
int poppedItem = myList.PopList(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-22T18:10:41.170

"this" 扩展了参数列表中的下一个类

所以在“this”下面的方法签名中扩展了“String”。行作为方法的普通参数传递给函数。public static string[] SplitCsvLine(这个字符串行)

在上面的例子中，“this”类扩展了内置的“String”类。

# javascript - 使用javascript旋转Div

> ID：846769
> 
> 赞同：0
> 
> 时间：2009-05-11T05:07:20.760
> 
> 标签：javascript, html, dhtml

这是一个链接：[http ://www.avineon.com/](http://www.avineon.com/)

打开此链接，请参阅顶部。四个图像正在旋转。

我需要使用 Javascript 类似的东西。

是否可以通过使用Javascript。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T05:14:21.543

如果您尝试在纯 javascript 中执行此操作，我认为您不会有太多运气。使用新兴的画布和 SVG 库（例如[Raphael ）](http://raphaeljs.com/)*可能*是可行的，但您仍然会遇到跨浏览器问题。该站点使用了 Flash，如果您想要这样的效果，我建议您使用它。

......*为什么*你想要在你的网站上是另一个故事......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T05:17:37.123

你可以做类似的事情，但不准确。

透明度 = FF、Safari、IE7+ 支持 更改图像宽度 = 使用此 Css 将图像放置在 div 中

```
.class img {
display: block;
width: 100%;
height: 100%
} 
```

这将使图像拉伸以填充 .class div。然后，您可以使用 JS 使这个 div 像轮播一样变窄，并且包含的​​图像将在 div 内进行动画处理。

然后，您需要跟踪鼠标位置以确定它旋转的速度。

您可以使用使用余弦的方程从远端平滑加速（IIRC）

但是，您将无法反向获取图像，除非您使用服务器端语言创建副本或使用画布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T05:24:39.843

您最好的选择不是尝试在实际 3D 中渲染某些东西，而是使用视觉技巧来近似 3D 效果。也就是说，使用透视图/图像变形让它看起来像一个立方体在旋转，类似于[在这个页面](http://www.kawa.net/works/js/animation/cube-e.html)上实现的，它对所涉及的数学有更好的解释。

但实际上，您最好只使用 Flash。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T15:51:44.993

通过随着时间的推移修改每个图像、和样式，`width`这种`height`效果在 JavaScript 中是可能的。`left`这是一个复杂的脚本，但只需要在每个图像元素上插入这三种样式。

要获得旋转效果，请在移动style 属性时在函数中减少`width`图像的样式。也有轻微的减少。`setInterval``left``height`

每边需要两张图片，正面和反面。当宽度减小到零时，将图像与其翻转版本交换并开始增加宽度。

或者使用[Webkit](http://webkit.org/blog/130/css-transforms/)和[Firefox 的](https://developer.mozilla.org/En/CSS/CSS_transform_functions)transform css 属性。

或者尝试以下看起来相似的封面流组件之一： [Protoflow](http://www.deensoft.com/lab/protoflow/)、 [ImageFlow](http://imageflow.finnrudolph.de/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-09-02T15:14:02.307

```
 <html>
<head>
    <title></title>
</head>
<body>
<script type="text/javascript">

if (document.all || document.getElementById){ //if IE4 or NS6+
 document.write('<style type="text/css">\n');
 document.write('.dyncontent{display: none; width: 728px; height: 90px;}\n');
 document.write('</style>');
}

var curcontentindex=0;
var messages=new Array();

function getElementByClass(classname){
 var inc=0;
 var alltags=document.all? document.all : document.getElementsByTagName("*");
 for (i=0; i<alltags.length; i++){
   if (alltags[i].className==classname)
     messages[inc++]=alltags[i];
 }
}

function rotatecontent(){
 //get current message index (to show it):
 curcontentindex=(curcontentindex<messages.length-1)? curcontentindex+1 : 0;
 //get previous message index (to hide it):
 prevcontentindex=(curcontentindex==0)? messages.length-1 : curcontentindex-1;
 messages[prevcontentindex].style.display="none"; //hide previous message
 messages[curcontentindex].style.display="block"; //show current message
}

window.onload=function(){
 if (document.all || document.getElementById){
   getElementByClass("dyncontent");
   setInterval("rotatecontent()", 5000);
 }
}

</script>
<table width="100%">
        <tr align="center">
            <td>
                <div class="dyncontent" style="display: block">
                first
                </div>
                <div class="dyncontent">
                second
                </div>
                <div class="dyncontent">
                Third
                </div>
            </td>
        </tr>
    </table>

</body>
</html> 
```

# linq-to-objects - 更新 LINQ to Objects

> ID：846772
> 
> 赞同：0
> 
> 时间：2009-05-11T05:08:13.050
> 
> 标签：linq-to-objects

如何在 LINQ to Objects 中进行更新。尝试将 SQL 转换为 Linq

```
Quality
        (
          TransactionID int,
          Quantity float,
          MaterialID int,
          ProductID int,
          ParameterID int,
          ParameterValue float,
          TotalTonnes float
        ) 
```

如何将以下 SQL 转换为 linq：

```
UPDATE  Q1
            SET     TotalTonnes = ( SELECT  SUM(Quantity)
                                    FROM    @Quality Q2
                                    WHERE   Q1.ParameterID = Q2.ParameterID
                                            AND ( ( Q1.MaterialID = Q2.MaterialID )
                                                  OR ( Q1.MaterialID IS NULL
                                                       AND Q2.MaterialID IS NULL
                                                     )
                                                )
                                            AND ( ( Q1.ProductID = Q2.ProductID )
                                                  OR ( Q1.ProductID IS NULL
                                                       AND Q2.ProductID IS NULL
                                                     )
                                                )
                                  )
            FROM    @Quality Q1 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:24:07.410

好吧，我会迫切地进行更新。像这样的东西：

```
foreach (var q1 in Q1)
{
    q1.TotalTonnes = (from q2 in Q2
                      where q1.ParameterID == q2.ParameterID
                        && q1.MaterialID == q2.MaterialID
                        && q1.ProductID == q2.ProductID
                      select q2.Quantity).Sum();
} 
```

请注意，由于在 C# 中处理空比较的方式，不需要双重空检查。（即是真`(null == null)`的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-19T12:16:59.687

为了获得更好的性能和我认为更简洁的代码，您可以使用 ToLookUp 方法。如果 Q2 很大，这将是更好的性能，因为没有嵌套循环。

```
var Q2LookUp = 
    Q2.ToLookUp(q2 => new {q2.ParameterId, q2.MaterialID, q2.ProductId});
foreach (var q1 in Q1)  
{
    q1.TotalTonnes = 
        Q2Lookup[new {q1.ParameterId, q1.MaterialID, q1.ProductId}]
            .Sum(q2 => q2.Quantity);
} 
```

# asp.net - 登录后如何将用户重定向到上一页（会话过期）？

> ID：846775
> 
> 赞同：1
> 
> 时间：2009-05-11T05:08:29.930
> 
> 标签：asp.net, asp.net-mvc, session

我正在维护一个用户登录会话。

考虑一个场景，用户使用他的帐户凭据在 page20 上工作。由于会话变量超时，他处于空闲状态。然后他开始在 page20 上工作并单击 page21 的链接。这里会话已过期，因此他将重定向到登录页面。

成功登录后，用户应重定向到 page21。

那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T06:02:05.350

如果您使用表单身份验证，则有一个内置机制可以做到这一点，就是这样。它会自动将用户重定向到 URL Referrer 页面

```
If (FrameworkManager.Authenticate(username, pwd)) Then        
   System.Web.Security.FormsAuthentication.RedirectFromLoginPage(username, rememberme)
end if 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T05:26:34.550

想到的第一种方法是通过 get/post 变量发送信息。当您在 page21 执行会话检查（我假设）并将用户重定向到登录页面时，您可以将页面名称附加到地址，即重定向到类似 www.xyz.com/login.htm?page21 （或者如果您不希望页面名称可见，请改用 post ）。然后，当用户再次登录时，只需使用该信息将他/她重定向到 page21。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T14:06:10.930

实际上，这取决于您如何使用会话。如果您在会话中保留用户在屏幕 1-20 上输入的所有信息，那么一旦他们的会话到期，您将丢失所有信息，所以无论如何您都不走运。

如果您将每个页面的所有内容存储在数据库或其他某种机制中，那么应该很容易判断用户输入的最后一条信息是什么。或者，您也可以存储用户在数据库中提交的最后一页的 url 或名称。

当他们登录时，确定他们应该在哪个页面上，然后重定向他们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:56:00.287

你会把这段代码放在哪里？

If (FrameworkManager.Authenticate(username, pwd)) Then
System.Web.Security.FormsAuthentication.RedirectFromLoginPage(username, rememberme) end if

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T05:32:35.337

如果您正在对登录页面执行 Server.Transfer，则 Request.Urlreferrer 将是 Page21 的 URL。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-05-01T06:59:45.503

If user wants to login again through another browser then in this situation you must add status column in your database and check if the status is true then you have to redirect this user on last visited page.So save the visited page through cookies and get back page name and redirect on the page.

# oop - 菜鸟问的基本对象关系映射问题

> ID：846777
> 
> 赞同：0
> 
> 时间：2009-05-11T05:08:59.273
> 
> 标签：oop

我知道，为了提高效率，当您查询数据库时，您应该只返回需要的列，而不再返回。

但是考虑到我喜欢使用对象来存储查询结果，这让我进退两难：

如果我只检索在特定情况下需要的列值，我只能部分填充对象。我觉得这使我的对象处于非理想状态，其中只有一些属性和方法可用。后来，如果出现我想重用对象但发现新情况需要返回一组不同但重叠的列的情况，我将面临一个选择。

我是否应该重用现有 SQL 并将新情况所需的附加字段添加到选定列的列表中，以便可以为两者重用相同的查询和对象映射逻辑？或者我应该创建另一种方法来执行稍微不同的 SQL，从而只填充第二个查询返回的那些对象属性？

我强烈怀疑没有神奇的答案，答案真的“取决于”情况，但我想我正在寻找一般性建议。一般来说，我的方法是要么返回查询表中的所有列，要么根据需要向查询中添加额外的列，但要重用相同的 SQL（和映射代码），直到性能成为问题。一般来说，我发现除非您要检索大量行（我通常不会），否则向输出添加额外列的成本不会对性能产生显着影响，并且可以节省开发时间并简化API 结果是一个很好的权衡。

但是，当性能确实成为一个因素时，您如何处理这种情况？您是否创建了类似的方法

Employees.GetPersonalInfo Employees.GetLittleMorePersonlInfoButMinusSalary 等等等等

或者您是否最终以某种方式创建了一个 API，其中您的 API 用户必须指定他想要填充/返回的列/属性，从而增加复杂性并使您的 API 不太友好/易于使用？

假设您想获取员工信息。通常会涉及多少个对象？

1) 一个 Employee 对象 2) 一个Employees 集合对象，其中每个Employee 行返回一个Employee 对象 3) 一个对象，例如EmployeeQueries 返回包含诸如“GetHiredThisWeek”之类的方法，它返回一个Employees 集合，该集合包含0 条或更多条记录。

我意识到所有这些都是非常主观的，但我正在寻找关于你发现最适合你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:37:02.163

我想说先让你的应用程序正确，然后再担心这种情况下的性能。

您可能正在优化您的查询，只是为了意识到您无论如何都不会使用该查询。创建您的整个应用程序可以使用的最通用的查询，然后当您确信一切正常时，如果需要，查找问题区域。

您很可能不会非常需要预先获得巨大的性能。有人说，懒惰的程序员是最好的程序员。不要预先使事情过于复杂，创建一个 Employee 对象。

如果您发现需要优化，您将创建一个方法/类，或者您的 ORM 库会这样做。这应该是规则的一个例外；只有当你有理由这样做时才这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T05:19:35.577

> ...向输出添加额外列的成本对性能没有明显影响...

对。我不太明白会出现什么“新情况”，但无论哪种方式，获取所有列而不是运行多个查询都是一个更好的主意（IMO）。获得比您需要的更多的列并没有太大的性能损失（尽管查询会占用更多的 RAM，但这应该不是一个大问题；此外，硬件很便宜）。此外，您还可以节省大量的开发时间。

至于你问题的第二部分，这完全取决于你。例如，Rails 更多地采用“可用性第一，性能最后”的方法，但这可能不是您想要的。这仅取决于您的需求。如果您愿意为性能牺牲一点可用性，那么一定要去做。我会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T06:00:33.340

如果您在“一次一行”CRUD 类型的应用程序中使用您的对象，那么无论如何将所有列复制到您的对象中，额外的开销是最小的，并且您的对象变得真正可重用于任何需要行的程序访问表。

但是，如果您的 SQL 正在执行复杂的连接或返回大量行，那么请精确地请求并且只请求您想要的。你会在这里得到两个性能损失，一个每次处理每一列都会消耗cpu而没有任何好处，而且，两个大多数 DBMS 系统都有一系列优化查询的技巧（例如仅索引访问），只有在你指定的情况下才能使用这些技巧正是您想要的列。

在大多数情况下没有重用问题，因为扫描/搜索过程往往非常特定于特定用例。

# asp.net - ASP.net 相当于 Rails 的“循环”？

> ID：846780
> 
> 赞同：0
> 
> 时间：2009-05-11T05:09:45.653
> 
> 标签：asp.net, ruby-on-rails

从 Rails 转到 ASP.net 非常痛苦。但我想知道是否有任何大师知道Rails for ASP.net 的“循环”的等效翻译？

[http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#M001721](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#M001721)

基本上能够根据第n次调用有条件地输出第n个参数。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T05:43:05.833

没有内置函数可以实现这一点 - 您必须自己编写代码。您可以使用模数完成同样的事情，但您必须使用 for 循环（或某种索引）：

var colors = new List {"Red", "Green", "Blue"};

```
for (int i=0; i < rows.length; i++) {
    out.write("<p class='" + colours[i % colours.Count] + "'>" + rows[i].Name + "</p>");
} 
```

现在，我相信你会同意这比那些愚蠢的 Ruby 东西要优雅得多；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:51:18.203

您可以使用[yield 关键字](http://msdn.microsoft.com/en-us/library/9k7k7cf0.aspx)自行滚动。这是可以为您提供类似功能的东西。您需要包含此命名空间才能使用 IEnumerable 接口：

```
using System.Collections; 
```

这是一个例子：

```
public static void Main()
{
    string[] myColors = { "red", "green", "blue" };
    // this would be your external loop, such as the one building up the table in the RoR example
    for (int index = 0; index < 3; index++)
    {
        foreach (string color in Cycle(myColors))
        {
            Console.WriteLine("Current color: {0}", color);
        }
    }
}

public static IEnumerable Cycle<T>(T[] items)
{
    foreach (T item in items)
    {
        yield return item;
    }
} 
```

Cycle 方法在上面的代码示例中使用[泛型](http://msdn.microsoft.com/en-us/library/512aeb7t.aspx)以允许使用其他类型。例如，在声明 myColors 的地方，您可以使用：

```
int[] myInts = { 0, 1, 2, 3 };
bool[] myBools = { true, false }; 
```

在循环中，您可以拥有：

```
foreach (int i in Cycle(myInts))
{
    Console.WriteLine("Current int: {0}", i);
}
foreach (bool b in Cycle(myBools))
{
    Console.WriteLine("Current bool: {0}", b);
} 
```

# asp.net - 如何在 PDF 文件中进行搜索

> ID：846783
> 
> 赞同：2
> 
> 时间：2009-05-11T05:10:42.313
> 
> 标签：asp.net, pdf

我必须在 PDF 文件中搜索共享托管环境中即将推出的（ASP.NET MVC）项目。什么是最好的解决方案？有第三方产品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:21:16.273

[Lucene](http://lucene.apache.org/)是一个流行的选择。请参阅有关搜索 pdf 的[Lucene 常见问题解答。](http://wiki.apache.org/lucene-java/LuceneFAQ#head-c45f8b25d786f4e384936fa93ce1137a23b7e422)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T10:37:49.830

Lucene 是一个不错的选择——对于 ASP.NET，使用[Lucene.NET](http://incubator.apache.org/lucene.net/)是最好的选择。Lucene 只是一个索引引擎，这意味着您必须为其提供 PDF 中的文本。如果您可以访问 Web 服务器，您可以为此安装一个[IFilter](http://www.ifilter.org/)（我推荐[Foxit 的](http://www.foxitsoftware.com/pdf/ifilter/)PDF 过滤器）。否则，您将不得不获取一些代码以在您的网站上使用来解析和过滤 PDF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T17:23:51.443

[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)可以帮助完成此类任务。

该库可用于[提取文本](https://bitmiracle.com/blog/extract-text-from-pdf-in-net)（带或不带格式）。提取的文本可用于创建索引。`String.IndexOf`如果您只想知道 PDF 文件是否包含给定文本，您甚至可以使用方法。

该库还可以从 PDF 中检索带有边界矩形[的单词集合。](https://bitmiracle.com/pdf-library/help/extract-text-by-words.aspx)如果您需要知道文件中文本的确切位置，这可能很有用。

免责声明：我为图书馆的供应商工作。

# java - 配置 Hibernate 以使用 Oracle 的 SYS_GUID() 作为主键

> ID：846786
> 
> 赞同：7
> 
> 时间：2009-05-11T05:12:43.543
> 
> 标签：java, oracle, hibernate, guid, uuid

我正在寻找一种`SYS_GUID()`在插入新行时让休眠以使用 oracle 功能的方法。目前我的数据库表具有`SYS_GUID()`默认值，因此如果休眠只是生成省略了该值的 SQL，它应该可以工作。

我一切正常，但它目前正在使用 system-uuid 生成器在代码中生成 UUID/GUID：

```
@Id
@GeneratedValue(generator = "system-uuid")
@GenericGenerator(name = "system-uuid", strategy = "uuid")
@Column(name = "PRODUCT_ID", unique = true, nullable = false)
public String getId() {
    return this.productId;
} 
```

这很好，但我更希望 guid 由数据库生成，因此它们将是连续的并且可能具有更好的性能。另外，我只想知道如何配置它。

我使用注释进行配置，但 xml 配置示例也很棒。

*这是一个示例表定义（以防万一）：*

```
CREATE TABLE SCHEMA_NAME.PRODUCT
(
    PRODUCT_ID RAW(16) DEFAULT SYS_GUID() NOT NULL,
    PRODUCT_CODE VARCHAR2(10 CHAR) NOT NULL,
    PRODUCT_NAME VARCHAR2(30 CHAR) NOT NULL,
    PRODUCT_DESC VARCHAR2(512 CHAR)
) 
```

## 更新：

Mat使用“guid”的解决方案有效，这是生成的sql：

```
Hibernate: 
    select rawtohex(sys_guid()) 
    from dual
Hibernate: 
    insert into PRODUCT
    (PRODUCT_CODE, PRODUCT_DESC, LOB_ID, PRODUCT_NAME, PROVIDER_ID, PRODUCT_ID) 
    values (?, ?, ?, ?, ?, ?) 
```

* * *

**似乎不可能在插入中使用列默认值，因此选择是在应用程序生成的 guid 和数据库往返之间进行选择。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T05:49:31.797

您也许可以使用“guid”生成器。请参阅Hibernate 论坛上的[这篇文章](https://forums.hibernate.org/viewtopic.php?p=2230350&sid=168cb72b4e0f67c1b29561d535aab74e)。看起来他们不久前增加了对 Oracle`SYS_GUID()`的支持，但[文档](http://docs.jboss.org/hibernate/stable/core/reference/en/html/mapping.html#mapping-declaration-id-generator)仍然说他们只支持 SQL Server 和 MySQL。

我还没有使用过 JPA 注释，但这里有一个使用 XML 配置的示例：

```
<id name="PRODUCT_ID">
  <generator class="guid" />
</id> 
```

**编辑：**关于你的第二个问题，我想你是在问为什么 Hibernate 不能做这样的事情：

```
INSERT INTO PRODUCT (PRODUCT_ID, /* etc */)
SELECT SYSGUID(), /* etc */ 
```

原因是 Hibernate 必须知道对象的 ID 是什么。例如，考虑以下场景：

1.  您创建一个新的 Product 对象并保存它。Oracle 分配 ID。
2.  您将产品从 Hibernate 会话中分离出来。
3.  您稍后重新附加它并进行一些更改。
4.  您现在想要保留这些更改。

在不知道 ID 的情况下，Hibernate 无法做到这一点。它需要 ID 才能发出 UPDATE 语句。因此，实现`org.hibernate.id.GUIDGenerator`必须事先生成 ID，然后在 INSERT 语句中重新使用它。

这与如果您使用数据库生成的 ID（包括支持它的数据库上的自动增量），Hibernate 无法进行*任何批处理的原因相同。*在一次插入大量对象时，使用其中一个 hilo 生成器或其他一些 Hibernate 生成的 ID 机制是获得良好性能的唯一方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-11T14:50:01.983

我有与主题启动器相同的任务。感谢**@Matt Solnit 的**建议，我使用了这样的注释：

```
@Id
@NotNull
@Column(name = "UUID")
@GenericGenerator(name = "db-uuid", strategy = "guid")
@GeneratedValue(generator = "db-uuid")
private String uuid;
public String getUuid() { return uuid; }
public void setUuid(String uuid) { this.uuid = uuid; } 
```

`strategy = "guid"`和`String`类型是解决方案的重要组成部分。

在持久化新实体之前，Hibernate 发出 SQL 查询：

```
select rawtohex(sys_guid()) from dual 
```

我的设置：Oracle 11、Hibernate 4.3.4.Final、Spring 3.2.x。如果`raw(16)`您使用`char(32)`.

当我尝试`java.util.UUID`用作 ID 字段类型时，我从 Hibernate 收到关于持久化新实体的错误（它尝试将`String`类型设置为`java.util.UUID`字段）。

我还`javax.xml.bind.DatatypeConverter`用于非 Hibernate 查询（Spring JDBC 帮助程序），用于将转换传递给`byte[]`：

```
String query = "insert into TBL (UUID, COMPANY) values (:UUID, :COMPANY)";
MapSqlParameterSource parameters = new MapSqlParameterSource()
    .addValue("COMPANY", repo.getCompany())
    .addValue("UUID", DatatypeConverter.parseHexBinary(signal.getUuid()));
namedJdbcTemplate.update(query, parameters); 
```

用于提取：

```
ResultSet rs;
sig.id = DatatypeConverter.printHexBinary(rs.getBytes("UUID")); 
```

所有 Web 控制器都获得如下代码：

```
025131763FB19522E050010A106D11E9 
```

没有`{`, `-`,字符（如果你记得的话`}`，UUID 的通常表示是）。`{a-b-c-d-x-y}`这种表示已经 URL 编码干净和安全。您不需要实现或`PropertyEditor`类型：`Convertor``String`

```
@RequestMapping(value = {"/signal/edit/{id}.htm"}, method = RequestMethod.POST)
public String handleEditRequest(
        @PathVariable("id") String id, 
```

与失败的使用尝试相比`jaa.util.UUID`，我需要写：

```
@Component
public static class UUIDPropertyEditor extends PropertyEditorSupport {
    @Override
    public void setAsText(final String str) {
        if (str == null || str.isEmpty()) {
            setValue(null);
            return;
        }
        setValue(UUID.fromString(str));
    }
}
private @Autowired UUIDPropertyEditor juuidPE;

@InitBinder
public void initBinder(WebDataBinder binder) {
    binder.registerCustomEditor(UUIDPropertyEditor.class, juuidPE);
} 
```

为了使用：

```
@PathVariable("id") UUID id, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T05:29:21.503

我认为你可以通过将生成器设置为原生来做到这一点。我不确定如何在 Hibernate 中执行此操作，但在 NHibernate 中，您会在 XML 中执行以下操作：

```
<id column="PRODUCT_ID">
  <generator class="native"/>
</id> 
```

# stored-procedures - 如何使用 vb6 从记录集中检索不是返回值或输出参数的值

> ID：846789
> 
> 赞同：0
> 
> 时间：2009-05-11T05:16:20.883
> 
> 标签：stored-procedures, vb6, ado

我希望与之交互的现有第 3 方应用程序（SQL 2005）上有一个存储过程。

它是一个插入语句，后跟一个选择语句，如下所示；

```

    设置@CustomerId = Cast(SCOPE_IDENTITY() As [int])

    选择@CustomerId

```

使用 VB6 如何访问 @CustomerID 的值？

```
set rs = cmd.Execute 
```

没有按预期返回结果集...

**[编辑]**

*rs.Fields.Count 为 0。*

*任何访问结果记录集的尝试，例如**rs(0).Value**只会导致“未找到项目...”错误。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:29:21.203

我猜你的存储过程返回了多个记录集。

如果是这种情况，您可以使用该[`NextRecordset()`](http://msdn.microsoft.com/en-us/library/ms677539(VS.85).aspx)方法遍历它们。

MSDN：

> *   如果行返回命令执行成功但没有返回记录，则返回的 Recordset 对象将打开但为空。通过验证 BOF 和 EOF 属性都为 True 来测试这种情况。
> *   如果非行返回命令成功执行，则返回的 Recordset 对象将被关闭，您可以通过测试 Recordset 上的 State 属性来验证。
> *   当没有更多结果时，记录集将设置为 Nothing。

这意味着我会建议这样的事情来解决您的问题：

```
Set rs = cmd.Execute

''# fetch the first value of the last recordset
Do Until rs Is Nothing
  If rs.State = adStateOpen Then
    If Not (rs.BOF And rs.EOF) Then
      ''# You can do a different sanity check here, or none at all
      If rs.Fields(0).Type = adInteger Then
        CustomerId = rs.Fields(0).Value
      End If
    End If
  End If
  Set rs = rs.NextRecordSet
Loop

MsgBox CustomerId 
```

# css - 扩展侧边栏向下页面

> ID：846792
> 
> 赞同：4
> 
> 时间：2009-05-11T05:19:28.463
> 
> 标签：css, xhtml

我试图让我的右侧边栏填充以扩展我在此站点上的#wrapper 中的内容的完整长度：http: [//www.starmedianetwork.com/](http://www.starmedianetwork.com/)

我在它周围放了一个红色边框，以尝试查看我的#right 在我的页面上的位置。我尝试过使用：

#right 和其他人的高度：100%。还在谷歌上搜索了明确的修复，但我无法得到它的工作，也在专家交流中遇到了一些解决方案，但那些没有工作。

有什么想法可以让我的侧边栏与背景颜色一起扩展以适应长度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-27T10:05:09.253

您可以使用人造侧边栏实现此目的：

```
<div class="sidebar_back"><.div>
<div class="sidebar">
  <p>The sidebar content</p>
</div> 
```

有了这个CSS：

```
.sidebar_back {
  top: 0;
  left: 0;
  bottom: 0;
  z-index: -1;
  width: 200px;
  background: #444; // the color you want the sidebar to be
  position: absolute;
}

.sidebar {
  float: left;
  width: 180px;
  padding: 10px;
} 
```

将`.sidebar_back`一直延伸到页面底部，因此只需提供您想要的侧边栏颜色，实际的侧边栏 div 将显示为全高。您也可以使用基于百分比的宽度而不是像素。这是一个显示示例的代码笔：http: [//codepen.io/poopsplat/full/jquBv](http://codepen.io/poopsplat/full/jquBv)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T05:33:30.937

您可以尝试这种方法：[http ://www.alistapart.com/articles/multicolumnlayouts/](http://www.alistapart.com/articles/multicolumnlayouts/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T05:59:37.490

你不能让一个 div 来填充它的父级的高度。它可能在一个浏览器中工作，但我遇到了这个问题，它不是简单地通过 height:100% 解决的。

您可以通过创建一个从侧面一直平铺的背景来模拟背景。这不是最优雅的解决方案。

我发现的唯一其他解决方案是使用 javascript。页面加载后，您可以根据要在其中扩展的 div 的高度将 div 的高度精确设置为所需的高度。

可能有一些 javascript 库可以帮助您定位这个麻烦的 div，但我现在无法想出一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-09T19:30:03.923

我用 jQuery 解决了我的管理页面的侧边栏问题，只用了几行代码

```
$('aside').height($(window).height()-($('#header').height()+$('#secondary_bar').height())-2); // Extend sidebar to bottom of viewport
$(window).resize(function(){
    $('aside').height($(window).height()-($('#header').height()+$('#secondary_bar').height())-2); //change size of bar when viewport height changes
    $('#main').height($(window).height()-($('#header').height()+$('#secondary_bar').height())-2); //change size of main content when size of viewport changes
}); 
```

它似乎适用于所有浏览器，但是，当右侧的内容较大时，向下滚动时会出现视口和问题。可以通过一些内容高度检查来修复它，但对我来说没关系。希望可以帮助那里的人=）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T06:36:32.843

我还没有尝试过，但是......感觉它应该可以工作（这当然可能是尝试的死亡之吻）：

```
#wrapper
    {position: fixed;
    top: 0;
    bottom: 0;
    right: 0;
    left: 0;
    display: block;
    width: 100%;
    background-color: #ffa;
        }

#right {position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 15%; /*  this has to be fixed-size so you can account
            for it in the next bit; but can still be kinda
            fluid-ish... */
    display: block;
    background-color: #ccc;
    overflow: auto;
        }

#left   {width: 83%; /*  100 - (15% + 2% (for a gutter)) */
    margin-left: 1%;
        margin-right: 16%; /*   less than 100 - 83, to allow for rounding of % or px */
    display: block;
    background-color: #0ff;
    overflow: auto;
        }

p   {display: block;
    margin: 0.5em;
    padding: 0.2em 0.5em;
        } 
```

...

```
<body>

    <div id="wrapper">

        <div id="left">
            <p>The left-hand content</p>

        </div>

        <div id="right">
            <p>The right-hand content</p>
        </div>

    </div>

</body> 
```

它不是非常漂亮，但它确实有效。虽然我不喜欢使用`position: absolute`（或`fixed`）所以如果有人有更好的建议我会去的=）

顺便说一句，在以下位置有实现的工作演示（添加了“lorem ipsum”优点）：[http://www.davidrhysthomas.co.uk/so/cols.html](http://www.davidrhysthomas.co.uk/so/cols.html)。

（好吧，我撒谎了：我现在显然*已经*尝试过了……）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-23T15:43:30.493

这是我找到解决此问题的方法：

您必须使用四个 div 标签 - 一个包含侧边栏、主要内容和页脚的主容器。

首先，在样式表中添加元素并设置样式：

```
#container {
width: 100%;
background: #FFFAF0;
}

.content {
width: 950px;
float: right;
padding: 10px;
background: #FFFAF0;
}

.sidebar {
width: 220px;
float: left;
padding: 5px;
background: #FFFAF0;
}

#footer {
clear:both;
background:#FFFAF0;
} 
```

您可以随心所欲地编辑不同的元素，只要确保不要更改页脚属性“clear:both” - 这一点非常重要。

然后，只需像这样设置您的网页：

```
<div id=”container”&gt;
<div class=”sidebar”&gt;</div>
<div class=”content”&gt;</div>
<div id=”footer”&gt;</div>
</div> 
```

[我在 [ http://blog.thelibzter.com/how-to-make-a-sidebar-extend-the-entire-height-of-its-container][1]](http://blog.thelibzter.com/how-to-make-a-sidebar-extend-the-entire-height-of-its-container][1])上写了一篇更深入的博客文章. 请让我知道，如果你有任何问题。希望这可以帮助！

# javascript - 如何使用 jquery 删除空间并限制特殊字符？

> ID：846797
> 
> 赞同：1
> 
> 时间：2009-05-11T05:23:51.653
> 
> 标签：javascript, jquery, regex, validation

我正在我的网站上创建一个注册表单。我想用用户名进行一些检查，它们是

*   用户名不能有空格，
*   用户名不能包含点 (.) 以外的任何特殊字符，因为 gmail 在其注册表单中所做的那样。

我在我的应用程序中使用 jQUERY，谁能告诉我如何使用 jquery 实现上面列出的两个检查？我记得这两个主要的用户名检查请建议您是否知道其他？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T05:54:14.240

看看[验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)。

无论您做什么，也要在服务器端验证用户名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T05:57:30.630

您可以使用 javascript 正则表达式检查：

```
if ($('#username').val().match(/^(\w)+[\w\d\.]*/)) {
  // everyting is ok
}else {
  // something is wrong
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T05:43:35.693

首先在 SO 的另一个条目中看到这里，[jquery-validate-how-to-add-a-rule-for-regular-expression-validation](https://stackoverflow.com/questions/280759/jquery-validate-how-to-add-a-rule-for-regular-expression-validation)。

如果您需要其他想法，请[在此处](http://jqueryfordesigners.com/using-ajax-to-validate-forms/)尝试使用 PHP 的示例和使用 jQuery 的 AJAX 调用。

您还可以查看[此](http://www.willjessup.com/sandbox/jquery/form_validator/form_validate.html)页面以获取另一个 jQuery 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T14:57:06.507

我通过研究@Dror 提供的链接（[这个](https://stackoverflow.com/questions/280759/jquery-validate-how-to-add-a-rule-for-regular-expression-validation)）来检查用户名中的错误字符，尝试遵循 jquery 脚本，

```
if (!$('#uname').val().match("^[a-z0-9'.\s]{1,50}$")) {
    //not a correct username
} 
```

谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-22T13:22:01.980

当我检查答案时，我看到空间是允许的。因此，我为其他将阅读此问题的人改进了正则表达式：

你需要这样做：

```
if (!$('#uname').val().match(/^[a-z0-9_-]{3,15}$/)) {
    alert("Please, use standard characters.");
} 
```

正则表达式说明：

> ^ -- 行首
> 
> [a-z0-9_-] -- 匹配列表中的字符和符号，az、0-9、下划线、连字符
> 
> {3,15} -- 长度至少为 3 个字符，最大长度为 15
> 
> $ -- 行尾

# email - 在回复电子邮件中保留标头数据

> ID：846800
> 
> 赞同：3
> 
> 时间：2009-05-11T05:24:16.287
> 
> 标签：email, email-client

我正在尝试确定将信息从原始电子邮件保留到回复的最佳方式。

本质上，它是从原始电子邮件 (c#) 中传递一个 GUID，从而当接收者回复时，该 GUID 也会被发回以供参考。

我尝试设置 MessageID，使用 Outlook，In-Reply-To 值设置为原始 ID，但是使用某些 webclient 电子邮件系统，该值不是在回复时创建的。还有另一种通过电子邮件标题发送此信息的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-11T05:51:40.313

VERP 的一些变化可能是最可靠的......

[http://en.wikipedia.org/wiki/Variable_envelope_return_path](http://en.wikipedia.org/wiki/Variable_envelope_return_path)

具体来说，不要将所有回复都发送到同一个地址，而是将要保留的信息编码到电子邮件的发件人地址中。

例如，在帮助台工单的情况下，您可以使用以下内容：

```
From: Helpdesk <support-ticket-123@example.com>
To: End User <user@example.org>
Subject: Ticket #123 - problem with computer. 
```

这样，无论用户在主题或文本中编辑什么，您都知道接收电子邮件地址所指的工单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T05:30:54.980

我认为您无法仅靠标头做任何完全可靠的事情——必须合作的客户数量是巨大的。

大多数执行此操作的系统通过在发送的电子邮件正文中包含一些内容来识别消息，并包含指示收件人在响应中包含该文本块的文本。您也可以尝试将其包含在主题中（并在正文中包含文本以保持主题不变）。这就是我见过的一些邮件列表管理器的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-23T23:44:53.367

我偶然发现了这个问题，它提供了非常丰富的信息。然而，这给我留下了一个问题：使用 VERP，或者编辑“回复”或“发件人地址”的变体，会导致邮件被锁定在垃圾邮件过滤器中吗？

我读到垃圾邮件发件人经常更改退回地址，以防止他们的服务器因错误的电子邮件地址退回而堵塞。采用这种方法是否存在垃圾邮件风险？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T05:45:58.387

最可靠的方法是将 ID 放在**主题**中，应在整个回复过程中保留该 ID。

（告诉你的用户他们应该保持主题不变，这并没有什么坏处。）

[RT](http://bestpractical.com/rt/)，一个流行的票务系统，就是这样做的。他们使用简单的主题格式，如 " `[Ticket #123]`" 并关闭`123`.

# c - C 中 if 语句和函数末尾的分号

> ID：846804
> 
> 赞同：20
> 
> 时间：2009-05-11T05:25:30.183
> 
> 标签：c

我刚刚遇到了一些过度使用分号的代码，或者将分号用于我不知道的不同目的。

我在 if 语句的末尾和函数的末尾找到了分号。例如：

```
int main (int argc, char * argv[]) {
    // some code

    if (x == NULL) {
        // some code
    };  <-----

    // more code

    return 0;
}; <--- 
```

它是用 cc 编译的，而不是 gcc。这些分号有什么作用？我假设没有区别，因为编译器只会将其视为空语句。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-11T05:32:16.677

他们什么都不做。我怀疑他们是一个不太懂语言的人的标志。

如果这是您名义上“拥有”的源代码，我会删除该代码并尝试与编写它的人进行温和的交谈。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-11T05:32:23.387

那是虚拟的声明。您的样品与

```
if (x == NULL) {
 // some code
 do_something_here();
}

/* empty (dummy statement) here */ ;

// more code
some_other_code_here(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-11T05:32:37.863

你是对的，编译器认为它们是空语句。它们不是必需的，我猜程序员以某种方式认为它们是必需的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T05:39:34.810

第一个分号（在 if 语句之后）只是一个空表达式，什么都不做。我看不出有任何意义。

第二个分号（在函数之后）是一个错误，因为它在任何代码块之外。编译器应该给出警告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T05:32:48.627

不需要这些分号（正如您所说，它们是空语句）。您的代码使用 gcc 编译，前提是定义了“x”（检查[http://www.codepad.org](http://www.codepad.org)）。C 编译器没有理由拒绝编译您的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T06:02:27.113

我认为作者可能一直在追求类似的东西：

```
if(condition for tbd block)
    ;
else {
    //Some code here
} 
```

如果您正在构建代码并且仍然希望它编译，您可能会这样做。正如乔恩所暗示的那样，这很有可能只是一个错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-11T06:07:10.287

正如其他人已经指出的那样，这些分号是无用的。我唯一要补充的是IMO，无论如何这些都被优化了，即编译器不会为这些生成任何真实代码。

# jquery - 如何使用jquery在表中选择一行？

> ID：846805
> 
> 赞同：3
> 
> 时间：2009-05-11T05:25:50.293
> 
> 标签：jquery, select, html-table

我在我的应用程序中创建了一个表格，我想在单击复选框时选择（更改背景颜色）整行，就像 gmail 一样，当我们单击 gmail 中的复选框时，整行变为黄色。

```
<table>
<tbody>
<tr>
<td><input type="checkbox" name="chk" id="chk" /></td>
<td>My Name</td>
<td>Description of the job</td>
</tr>
</tbody>
</table> 
```

请告诉我如何在 jquery 中做同样的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-11T05:28:41.427

```
$(function() {
  $("#chk").click(function() {
    $(this).parents("tr").toggleClass("diffColor");
  });
}); 
```

创建一个 CSS 类（上面称为“diffColor”）并以这种方式添加背景颜色，例如：

```
<style type="text/css">
tr.diffColor td { background-color: yellow; }
</style> 
```

不要直接设置 CSS 属性。尽可能使用类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-11T05:44:11.883

Cletus的回答是对的，但我觉得可以改进一点：

```
$(function() {
    $("#chk").click(function() {
        $(this)
            .parents("tr:first")
            .toggleClass("diffColor", this.checked)
        ;
    });
}); 
```

这里唯一真正的区别是：

1.  它只选择第*一个*父级`<tr>`。...你永远不知道你的代码最终会在哪里结束，而且理论上它会快几个滴答声。
2.  它检查复选框的新值并根据需要添加或删除类。如果不检查这一点，其他一些代码可能会更改行上的“diffColour”类，然后如果您知道我的意思，您的复选框将被反转。

此外，您也可以考虑将该函数绑定到`change`处理程序：

```
$('#chk').bind('click change', function() { // ... etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-09T20:04:31.537

要选择表格行，您可以使用我编写的一个名为**TableRowSelector**的简单类。[在此处](http://www.doublebow.net/articles/javascript/selecting-table-rows-in-javascript-with-tablerowselector)查看示例和示例代码

# windows - 挂钩调用 HeapAlloc 以进行内存跟踪应用程序的僵局

> ID：846807
> 
> 赞同：1
> 
> 时间：2009-05-11T05:26:47.187
> 
> 标签：windows, winapi, memory-management, hook

我正在编写一个内存跟踪应用程序，它使用 IAT 修补机制挂钩对 HeapAlloc 的所有调用。这个想法是捕获对 HeapAlloc 的所有调用并获得一个调用堆栈。

但是，我目前面临使用 DBGHELP API 获取调用堆栈的问题。我发现 dbghelp dll 本身正在链接到 MSVCRT dll，并且这种依赖性会导致递归调用。当我尝试为来自目标应用程序的任何调用获取调用堆栈时，dbghelp 在内部调用来自 MSVCRT 的某些方法，该方法再次调用 HeapAlloc。由于我已经修补了 MSVCRT，它会导致无限循环。

有没有人遇到过这个问题并解决了？有没有办法摆脱这个僵局？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T05:32:40.220

这是函数拦截代码中的标准问题。我们在使用共享内存来存储日志级别信息的日志库中遇到了类似的问题，而共享内存库必须记录信息。

我相信我们修复它的方式可以应用于您的情况。

在您的拦截代码中，维护一个指示您是否处于拦截中间的静态标志。当您的拦截被调用并且未设置标志时，设置标志然后执行您当前执行的操作，包括调用 DbgHelp，然后清除标志。

如果在设置标志时调用了拦截，则仅调用后端 HeapAlloc 代码而不执行任何其他操作（包括调用 DbgHelp 导致无限递归）。

类似于（伪代码）的东西：

```
function MyHookCode:
    static flag inInterceptMode = false
    if inInterceptMode:
        call HeapAlloc
        return
    inInterceptMode = true
    call DbgHelp stuff
    call HeapAlloc
    inInterceptMode = false
    return

function main:
    hook HeapAlloc with MyHookCode
    : : :
    return 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-15T20:02:46.897

您可以使用[Deviare API Hook](http://www.nektra.com/products/deviare-api-hook-windows/)并获得完整的堆栈跟踪，而无需使用存在大量问题的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T05:30:55.150

使用像[GlowCode](http://www.glowcode.com/)这样的真实内存跟踪产品怎么样？

# c++ - 下一个 c++ 标准中即将出现的 R-Value 参考是什么？

> ID：846812
> 
> 赞同：1
> 
> 时间：2009-05-11T05:30:13.797
> 
> 标签：c++, c++11, rvalue-reference

下一个 c++ 标准中即将出现的 R-Value 参考是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T05:40:53.387

它允许您区分调用您传递对 r-value 或 l-value 的引用的代码。例如：

```
void foo(int &x);

foo(1); // we are calling here with the r-value 1\. This would be a compilation error

int x=1;
foo(x); // we are calling here with the l-value x. This is ok 
```

通过使用 r 值引用，我们可以允许传入对临时对象的引用，例如上面的第一个示例：

```
void foo(int &&x); // x is an r-value reference

foo(1); // will call the r-value version

int x=1;
foo(x); // will call the l-value version 
```

当我们想要将创建对象的函数的返回值传递给使用该对象的另一个函数时，这会更有趣。

```
std::vector create_vector(); // creates and returns a new vector

void consume_vector(std::vector &&vec); // consumes the vector

consume_vector(create_vector()); // only the "move constructor" needs to be invoked, if one is defined 
```

移动构造函数的作用类似于复制构造函数，但它被定义为采用右值引用而不是左值 (const) 引用。允许使用 r-value 语义将数据移出临时创建的 in`create_vector`并将它们推送到参数中，`consume_vector`而无需对向量中的所有数据进行昂贵的复制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T05:43:45.863

看看[为什么 C++0x 右值引用不是默认值？](https://stackoverflow.com/questions/844241/why-are-c0x-rvalue-reference-not-the-default)，这很好地解释了它们的实际用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T08:19:33.863

这是Stephan T. Lavavej的一篇很长的[文章](http://blogs.msdn.com/vcblog/archive/2009/02/03/rvalue-references-c-0x-features-in-vc10-part-2.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T05:33:41.263

[http://en.wikipedia.org/wiki/C++0x#Rvalue_reference_and_move_semantics](http://en.wikipedia.org/wiki/C++0x#Rvalue_reference_and_move_semantics)

# sql-server - MS SQL 中未记录的存储过程，为什么？

> ID：846817
> 
> 赞同：1
> 
> 时间：2009-05-11T05:31:18.503
> 
> 标签：sql-server

我开始了解 MS SQL 中未记录的存储过程（例如“sp_MSforeachdb”...等）的一些用途。

这些是什么？为什么他们是“无证的”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T05:48:54.967

+1 险峻。这些过程通常由复制或管理工具使用，它们没有记录，因为开发团队保留随时更改它们的权利。多年来，许多都发生了变化，尤其是在 SQL 2000 Sp3 和 SQL 2005 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T05:41:56.397

我的猜测是因为它们在内部使用并且不受支持，并且可能会改变。[sp_who2](http://blogs.sqlserver.org.au/blogs/greg_linwood/archive/2005/10/02/50.aspx)是另一个我觉得非常方便的。也许管理工作室活动监视器使用那个 - 相同的输出。我是否提到无证可能意味着不受支持？不要依赖这些来坚持或在明年产生相同的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T05:56:05.470

`sp_MSforeachdb`并且`sp_MSforeachtable`不太可能改变。

两者都可以这样使用：

```
EXEC sp_MSforeachtable "print '?'; DBCC DBREINDEX ('?')" 
```

问号在哪里？被表名（或其他 sp 中的数据库名）替换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T09:41:16.863

未记录意味着不受支持，并且 MS 保留随时更改或删除所述命令的权利，恕不另行通知。

任何记录在案的功能在被删除之前都会经过两个弃用阶段。即使在服务包或修补程序中，也可以删除未记录的命令，而无需任何警告或任何公告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T13:54:48.753

很可能其中一位内部 SQl Server 开发人员需要这些存储过程来实现他们正在处理的功能，因此他们开发了它并在他们的代码中使用它。在与技术文档人员合作时，他们涵盖了项目的范围，并且在官方文档中仅包含了适用于客户的项目部分。随着时间的推移，人们发现了额外的存储过程（因为您无法隐藏它们）并开始使用它们。虽然内部 SQl Server 开发人员不想更改这些未记录的过程，但我相信如果他们的下一个项目必须这样做，他们会在两秒钟内更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T14:27:03.773

正如其他人所说，它们是不受支持的功能，不适合一般消费，尽管它们不能阻止您尝试，而且确实，有时它们可​​能非常有用。

但作为内部代码，它们可能会有意想不到的副作用或限制，很可能有一天会在这里，第二天就会消失。

如果您愿意，请谨慎使用它们，但不要完全依赖它们。

# maven-2 - 在 Maven 中继承依赖项

> ID：846833
> 
> 赞同：0
> 
> 时间：2009-05-11T05:36:56.763
> 
> 标签：maven-2

我正在从事 3 个 Maven 项目。它们都是独立的项目，但它们共享一个共同的基础框架。我们将框架 A 及其依赖项称为 B 和 C。

有一个 A 所依赖的库 L。任何使用 A 的包也需要使用 L，并且它需要使用与 A 相同的 L 版本。出于这个原因，我想要一种在 A 的 pom 中并且仅在 A 的 pom 中指定 L 的方法。我不想每次升级 L 时都去编辑 B 和 C 的 pom。

有没有办法做到这一点？没有 A、B 和 C 共享的父 pom。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T05:44:16.813

如果 B 和 C 也直接使用库 L，那么您应该在 B 和 C pom 文件中定义它。由于它是直接依赖关系，因此通过查看 POM 文件应该清楚。

第二种选择是如果库 L 对 A、B 和 C 项目是通用的，那么您应该定义一个父 pom。

# vba - Excel：如何仅在 CSV 文件中为字符串添加双引号

> ID：846839
> 
> 赞同：1
> 
> 时间：2009-05-11T05:39:17.667
> 
> 标签：vba, excel, csv

我想从 Excel 创建一个 CSV 文件，其中字符串值应该用双引号括起来，日期值应该是 MM/dd/yyyy 格式。所有数字和布尔值都应该不带引号。

我该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T02:10:35.950

Excel 不允许您指定格式，这有点吓人。这是一个可能对您也有用的 MrExcel 链接。

[http://www.mrexcel.com/forum/showthread.php?t=320531](http://www.mrexcel.com/forum/showthread.php?t=320531)

这是该站点的代码：

```
Sub CSVFile()

Dim SrcRg As Range
Dim CurrRow As Range
Dim CurrCell As Range
Dim CurrTextStr As String
Dim ListSep As String
Dim FName As Variant
FName = Application.GetSaveAsFilename("", "CSV File (*.csv), *.csv")

If FName <> False Then
  ListSep = Application.International(xlListSeparator)
  If Selection.Cells.Count > 1 Then
    Set SrcRg = Selection
  Else
    Set SrcRg = ActiveSheet.UsedRange
  End If    
  Open FName For Output As #1    
  For Each CurrRow In SrcRg.Rows
    CurrTextStr = ""
    For Each CurrCell In CurrRow.Cells
      CurrTextStr = CurrTextStr & """" & CurrCell.Value & """" & ListSep
    Next
    While Right(CurrTextStr, 1) = ListSep
      CurrTextStr = Left(CurrTextStr, Len(CurrTextStr) - 1)
    Wend    
    Print #1, CurrTextStr    
  Next    
  Close #1    
  End If
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T00:35:07.757

使用 VBA 更容易做到这一点。该对象的`SaveAs`方法`Workbook`只允许您选择预定义的格式，并且`xlCSV`不使用双引号分隔字符串。

要在 VBA 中执行此操作：

```
Dim fileOut As Integer

fileOut = FreeFile
Open "C:\foo.csv" For Output As #fileOut

Write #fileOut, 14, "Stack Overflow", Date, True

Close #fileOut 
```

（NB`Date`是一个 VBA 语句，它返回当前系统日期作为子类型 Date 的 Variant）

如果您随后在记事本中检查该文件：

> 14,"堆栈溢出",#2009-05-12#,#TRUE#

字符串已按要求分隔，日期转换为通用格式，日期和布尔值均用 # 符号分隔。

要读回数据，请使用`Input #`将适当解释所有值的语句。

如果你想写一行的一部分，然后再写完：

```
Write #fileOut, 14, "Stack Overflow";
Write #fileOut, Date, True 
```

产生与原始程序相同的结果。第一条语句末尾的分号可防止开始新行

带有嵌入双引号的字符串会导致问题，因此您需要删除或替换这些字符

# linq-to-sql - Linq to SQL 和 Rob Conery 存储库模式的并发性

> ID：846845
> 
> 赞同：3
> 
> 时间：2009-05-11T05:42:27.427
> 
> 标签：linq-to-sql, concurrency, repository-pattern

我已经使用 Rob Conery 对存储库模式（来自 MVC Storefront 项目）的旋转实现了一个 DAL，其中我使用 Linq 将数据库对象映射到域对象，并使用 Linq to SQL 来实际获取数据。

这一切都很好地让我完全控制了我想要的域对象的形状，但是我遇到了一个我想在这里问的并发问题。我有并发工作，但解决方案感觉它可能是错误的（只是其中一种混乱的感觉）。

基本模式是：

```
private MyDataContext _datacontext
private Table _tasks;

public Repository(MyDataContext datacontext)
{
    _dataContext = datacontext;
}

public void GetTasks()
{
    _tasks = from t in _dataContext.Tasks;

    return from t in _tasks
        select new Domain.Task
        {
            Name = t.Name,
            Id = t.TaskId,
            Description = t.Description                              
        };
}

public void SaveTask(Domain.Task task)
{
    Task dbTask = null;

    // Logic for new tasks omitted...

    dbTask = (from t in _tasks
        where t.TaskId == task.Id
        select t).SingleOrDefault();

    dbTask.Description = task.Description,
        dbTask.Name = task.Name,

    _dataContext.SubmitChanges();
} 
```

因此，通过该实现，由于映射到域任务，我失去了并发跟踪。我通过存储私有表来取回它，这是我在获取原始任务时的任务数据上下文列表。

然后我从这个存储的表中更新任务并保存我更新的内容

这是有效的 - 当存在并发冲突时，我会收到更改冲突异常，就像我想要的那样。

然而，它只是对我尖叫，我错过了一个把戏。

有没有更好的方法来做到这一点？

我已经查看了 datacontext 上的 .Attach 方法，但这似乎需要以与我已经在做的类似的方式存储原始版本。

我也知道我可以通过取消域对象并让 Linq to SQL 生成的对象一直在我的堆栈中来避免这一切——但我不喜欢这一点，就像我不喜欢我处理并发的方式一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T07:46:17.433

我解决了这个问题并找到了以下解决方案。它适用于我（更重要的是，我的测试人员！）能想到的所有测试用例。

我`.Attach()`在 datacontext 和 TimeStamp 列上使用该方法。这在您第一次将特定主键保存回数据库时工作正常，但我发现数据上下文抛出`System.Data.Linq.DuplicateKeyException`“无法添加具有已使用键的实体”。

我创建的解决方法是添加一个字典来存储我第一次附加的项目，然后每次保存时我都会重复使用该项目。

示例代码如下，我想知道我是否错过了任何技巧 - 并发性是非常基础的，所以我跳过的箍似乎有点过分。

希望以下证明有用，或者有人可以指出我更好的实现！

```
private Dictionary<int, Payment> _attachedPayments;

public void SavePayments(IList<Domain.Payment> payments)
    {
        Dictionary<Payment, Domain.Payment> savedPayments =
            new Dictionary<Payment, Domain.Payment>();

        // Items with a zero id are new
        foreach (Domain.Payment p in payments.Where(p => p.PaymentId != 0))
        {
            // The list of attached payments that works around the linq datacontext  
            // duplicatekey exception
            if (_attachedPayments.ContainsKey(p.PaymentId)) // Already attached
            {
                Payment dbPayment = _attachedPayments[p.PaymentId];                    
                // Just a method that maps domain to datacontext types
                MapDomainPaymentToDBPayment(p, dbPayment, false);
                savedPayments.Add(dbPayment, p);
            }
            else // Attach this payment to the datacontext
            {
                Payment dbPayment = new Payment();
                MapDomainPaymentToDBPayment(p, dbPayment, true);
                _dataContext.Payments.Attach(dbPayment, true);
                savedPayments.Add(dbPayment, p);
            }
        }

        // There is some code snipped but this is just brand new payments
        foreach (var payment in newPayments)
        {
            Domain.Payment payment1 = payment;
            Payment newPayment = new Payment();
            MapDomainPaymentToDBPayment(payment1, newPayment, false);
            _dataContext.Payments.InsertOnSubmit(newPayment);
            savedPayments.Add(newPayment, payment);
        }

        try
        {
            _dataContext.SubmitChanges();
            // Grab the Timestamp into the domain object
            foreach (Payment p in savedPayments.Keys)
            {
                savedPayments[p].PaymentId = p.PaymentId;
                savedPayments[p].Timestamp = p.Timestamp;
                _attachedPayments[savedPayments[p].PaymentId] = p;
            }
        }
        catch (ChangeConflictException ex)
        {
            foreach (ObjectChangeConflict occ in _dataContext.ChangeConflicts)
            {
                Payment entityInConflict = (Payment) occ.Object;

                // Use the datacontext refresh so that I can display the new values
                _dataContext.Refresh(RefreshMode.OverwriteCurrentValues, entityInConflict);
                _attachedPayments[entityInConflict.PaymentId] = entityInConflict;

            }
            throw;
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:15:21.913

`.Attach`我会考虑通过传递“原始”和“更新”对象来尝试利用该方法，从而从 LINQ2SQL 实现真正的乐观并发检查。此 IMO 将优先于在 DBML 对象或您的域对象中使用版本或日期时间戳。但是，我不确定 MVC 如何允许这种保留“原始”数据的想法。我一直在尝试调查验证脚手架，希望它存储“原始”数据。但我怀疑它是仅与最近的帖子一样好（和/或验证失败）。所以这个想法可能行不通。

我的另一个疯狂想法是：覆盖所有域对象的 GetHashCode()，其中哈希表示该对象的唯一数据集（当然减去 ID）。然后，手动或使用助手将该哈希埋在 HTML POST 表单中的隐藏字段中，并将其与更新的域对象一起发送回您的服务层 - 在您的服务层或数据层中进行并发检查（通过比较原始使用新提取的域对象的散列散列），但请注意，**您需要自己检查并引发并发异常**. 使用 DMBL 函数很好，但是抽象出数据层的想法是不依赖于特定实现的功能等。因此，完全控制对服务层中域对象的乐观并发检查（例如）似乎喜欢我的好方法。

# python - 在 Windows 上的 Python 2.x 中从命令行参数读取 Unicode 字符

> ID：846850
> 
> 赞同：29
> 
> 时间：2009-05-11T05:44:02.493
> 
> 标签：python, windows, command-line, unicode, python-2.x

我希望我的 Python 脚本能够在 Windows 中读取 Unicode 命令行参数。但似乎 sys.argv 是以某种本地编码而不是 Unicode 编码的字符串。如何阅读完整的 Unicode 命令行？

示例代码：`argv.py`

```
import sys

first_arg = sys.argv[1]
print first_arg
print type(first_arg)
print first_arg.encode("hex")
print open(first_arg) 
```

在为日语代码页设置的 PC 上，我得到：

```
C:\temp>argv.py "PC・ソフト申請書08.09.24.doc"
PC・ソフト申請書08.09.24.doc
<type 'str'>
50438145835c83748367905c90bf8f9130382e30392e32342e646f63
<open file 'PC・ソフト申請書08.09.24.doc', mode 'r' at 0x00917D90> 
```

我相信这是 Shift-JIS 编码的，它对那个文件名“有效”。但它会中断带有不在 Shift-JIS 字符集中的字符的文件名——最终的“打开”调用失败：

```
C:\temp>argv.py Jörgen.txt
Jorgen.txt
<type 'str'>
4a6f7267656e2e747874
Traceback (most recent call last):
  File "C:\temp\argv.py", line 7,
in <module>
    print open(first_arg)
IOError: [Errno 2] No such file or directory: 'Jorgen.txt' 
```

注意——我说的是 Python 2.x，而不是 Python 3.0。我发现 Python 3.0 提供`sys.argv`了正确的 Unicode。但是现在过渡到 Python 3.0 还为时过早（由于缺乏 3rd 方库支持）。

**更新：**

一些答案说我应该根据`sys.argv`编码的任何内容进行解码。问题在于它不是完整的 Unicode，因此某些字符无法表示。

这是让我感到悲伤的用例：我[在 Windows Explorer 中启用了将文件拖放到 .py 文件上](https://stackoverflow.com/q/142844/60075)。我的文件名包含各种字符，包括一些不在系统默认代码页中的字符。当字符在当前代码页编码中不可表示时，我的 Python 脚本在所有情况下都无法通过 sys.argv 获得正确的 Unicode 文件名。

当然有一些 Windows API 可以读取带有完整 Unicode 的命令行（Python 3.0 可以做到）。我假设 Python 2.x 解释器没有使用它。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-11T06:21:59.110

这是我正在寻找的解决方案，调用 Windows`GetCommandLineArgvW`函数：
[Get sys.argv with Unicode characters under Windows](http://code.activestate.com/recipes/572200/) (from ActiveState)

但我做了一些更改，以简化其使用并更好地处理某些用途。这是我使用的：

**`win32_unicode_argv.py`**

```
"""
win32_unicode_argv.py

Importing this will replace sys.argv with a full Unicode form.
Windows only.

From this site, with adaptations:
      http://code.activestate.com/recipes/572200/

Usage: simply import this module into a script. sys.argv is changed to
be a list of Unicode strings.
"""

import sys

def win32_unicode_argv():
    """Uses shell32.GetCommandLineArgvW to get sys.argv as a list of Unicode
    strings.

    Versions 2.x of Python don't support Unicode in sys.argv on
    Windows, with the underlying Windows API instead replacing multi-byte
    characters with '?'.
    """

    from ctypes import POINTER, byref, cdll, c_int, windll
    from ctypes.wintypes import LPCWSTR, LPWSTR

    GetCommandLineW = cdll.kernel32.GetCommandLineW
    GetCommandLineW.argtypes = []
    GetCommandLineW.restype = LPCWSTR

    CommandLineToArgvW = windll.shell32.CommandLineToArgvW
    CommandLineToArgvW.argtypes = [LPCWSTR, POINTER(c_int)]
    CommandLineToArgvW.restype = POINTER(LPWSTR)

    cmd = GetCommandLineW()
    argc = c_int(0)
    argv = CommandLineToArgvW(cmd, byref(argc))
    if argc.value > 0:
        # Remove Python executable and commands if present
        start = argc.value - len(sys.argv)
        return [argv[i] for i in
                xrange(start, argc.value)]

sys.argv = win32_unicode_argv() 
```

现在，我使用它的方式很简单：

```
import sys
import win32_unicode_argv 
```

从那时起，`sys.argv`就是一个 Unicode 字符串列表。Python`optparse`模块似乎很乐意解析它，这很棒。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-11T07:45:24.417

处理编码非常混乱。

我*相信*，如果您通过命令行输入数据，它会将数据编码为您的系统编码是和不是 unicode。（即使复制/粘贴也应该这样做）

所以使用系统编码解码成unicode应该是正确的：

```
import sys

first_arg = sys.argv[1]
print first_arg
print type(first_arg)

first_arg_unicode = first_arg.decode(sys.getfilesystemencoding())
print first_arg_unicode
print type(first_arg_unicode)

f = codecs.open(first_arg_unicode, 'r', 'utf-8')
unicode_text = f.read()
print type(unicode_text)
print unicode_text.encode(sys.getfilesystemencoding()) 
```

运行以下会输出：Prompt> python myargv.py "PC・ソフト申请书08.09.24.txt"

```
PC・ソフト申請書08.09.24.txt
<type 'str'>
<type 'unicode'>
PC・ソフト申請書08.09.24.txt
<type 'unicode'>
?日本語 
```

其中“PC·ソフト申请书08.09.24.txt”包含“日本语”的文字。（我使用 Windows 记事本将文件编码为 utf8，我有点困惑为什么打印时开头有一个“？”。与记事本如何保存 utf8 有关？）

字符串 'decode' 方法或内置 unicode() 可用于将编码转换为 unicode。

```
unicode_str = utf8_str.decode('utf8')
unicode_str = unicode(utf8_str, 'utf8') 
```

此外，如果您处理编码文件，您可能希望使用 codecs.open() 函数代替内置的 open()。它允许您定义文件的编码，然后将使用给定的编码透明地将内容解码为 un​​icode。

所以当你打电话时`content = codecs.open("myfile.txt", "r", "utf8").read()` `content`将是unicode。

codecs.open：http://docs.python.org/library/codecs.html?#codecs.open [_](http://docs.python.org/library/codecs.html?#codecs.open)

如果我对某些事情有误解，请告诉我。

如果您还没有，我建议您阅读 Joel 关于 unicode 和编码的文章：http: [//www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T05:58:33.187

试试这个：

```
import sys
print repr(sys.argv[1].decode('UTF-8')) 
```

也许您必须替换`CP437`或`CP1252`替换`UTF-8`. 您应该能够从注册表项中推断出正确的编码名称`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage\OEMCP`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T05:57:07.793

命令行可能采用 Windows 编码。尝试将参数解码为`unicode`对象：

```
args = [unicode(x, "iso-8859-9") for x in sys.argv] 
```

# java - Java 绑定异常

> ID：846861
> 
> 赞同：2
> 
> 时间：2009-05-11T05:49:56.430
> 
> 标签：java, exception, sockets, bind

即使重用地址设置为 true，什么会导致 TCP 套接字抛出“java.net.BindException：地址已在使用中”？仅当应用程序快速重新启动时才会发生这种情况。在 CentOS 5 linux 操作系统上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T18:46:53.950

这有点解释它：

[http://www.beej.us/guide/bgnet/output/html/singlepage/bgnet.html#bind](http://www.beej.us/guide/bgnet/output/html/singlepage/bgnet.html#bind)

> 有时，您可能会注意到，您尝试重新运行服务器并且 bind() 失败，并声称“地址已在使用中”。这意味着什么？好吧，一个已连接的套接字仍然在内核中徘徊，它占用了端口。您可以等待它清除（一分钟左右），或者向您的程序添加代码允许它重用端口，就像这样
> 
> *（提供 C 代码）*

基本上，在 C 中，您调用一个名为 setsockopt() 的函数，其中一个参数称为 SO_REUSEADDR，它允许您重用该端口。

我在 google 上找到了一些简短的链接，这些链接应该让您开始了解如何在 Java 中设置等效选项：

[http://java.sun.com/j2se/1.4.2/docs/guide/net/socketOpt.html](http://java.sun.com/j2se/1.4.2/docs/guide/net/socketOpt.html)

[http://java.sun.com/j2se/1.4.2/docs/api/java/net/SocketOptions.html](http://java.sun.com/j2se/1.4.2/docs/api/java/net/SocketOptions.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T06:28:40.643

如果您说的是正确的，您应该能够在循环中捕获此异常并在几秒钟后重试。（你不应该这样做，但我听说过关于 CentOS 的一些奇怪的事情）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T13:14:01.713

如果您的端口或 InetAddress 中的任何一个已被使用并且您想再次使用，则会发生 Java 绑定异常。因此，如果正在运行，请释放端口停止程序。否则更改端口

谢谢迪帕克

# python - 在 Python 中解析：抑制/规范化字符串的最有效方法是什么？

> ID：846869
> 
> 赞同：0
> 
> 时间：2009-05-11T05:55:03.740
> 
> 标签：python, string, parsing

我正在解析一个源文件，我想“抑制”字符串。我的意思是将每个字符串（如“bla bla bla +/*”）转换为“字符串”之类的确定性且不包含任何可能混淆我的解析器的字符，因为我不关心字符串。这里的问题之一是使用例如“%s”的字符串格式，请参阅下面我对此的评论。

以下面的伪代码为例，它可能是我正在解析的文件的内容。假设字符串以 " 开头，转义 " 字符由 "" 完成：

```
print(i)
print("hello**")
print("hel"+"lo**")
print("h e l l o "+
"hello\n")
print("hell""o")
print(str(123)+"h e l l o")
print(uppercase("h e l l o")+"g o o d b y e") 
```

应转化为以下结果：

```
print(i)
print("string")
print("string"+"string")
print("string"
"string")
print("string")
print(str(123)+"string")
print(uppercase("string")+"string") 
```

目前，我将其视为代码中的一种特殊情况（即检测字符串的开头，并“手动”运行直到结束，途中有几个子特殊情况）。如果有一个我可以使用的 Python 库函数或一个可以使我的代码更高效的正则表达式，那就太好了。

几点说明：

*   我希望“字符串开头”字符是一个变量，例如“vs”。
*   在这个阶段我没有解析 Python 代码，但我计划这样做，问题显然变得更加复杂，因为字符串可以以多种方式开始，并且必须以与开始相对应的方式结束。我现在不打算处理这个问题，但如果有任何成熟的最佳实践，我想知道它。
*   关于这种“抑制”，最让我困扰的是字符串格式化与“%s”之类的情况，它们是有意义的标记。我目前没有处理这个问题，也没有完全考虑清楚，但是如果你们中的任何人对如何处理这个问题有任何建议，那就太好了。请注意，我对字符串内标记的特定类型或格式不感兴趣，我知道字符串中有标记（有多少）就足够了。此处可能很重要的注释：我的标记器没有嵌套，因为我的目标很简单（我没有编译任何东西......）。
*   我不太确定起始字符串字符的转义。你会说在大多数编程语言中实现这一点的常见方式是什么？重复出现（例如“”）或任何两个字符集（例如“\”'）的假设是否足以转义？我是否需要处理其他情况（想想像 Java、C/C++、PHP、C# 这样的语言)?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T06:01:22.560

选项 1：要清理 Python 源代码，请尝试使用内置的[tokenize](http://docs.python.org/library/tokenize.html)模块。它可以在任何 Python 源文件中正确查找字符串和其他标记。

选项 3：将[pygments](http://pygments.org/languages/)与 HTML 输出一起使用，并将蓝色（等）中的任何内容替换为`"string"`. pygments 支持几十种语言。

选项 2：对于大多数语言，您可以构建自定义正则表达式替换。`"""`例如，以下内容会清理 Python 源代码（但如果源文件包含or则它不起作用`'''`）：

```
import re
sanitized = re.sub(r'(#.*)|\'(?:[^\'\\]+|\\.)*\'|"(?:[^"\\]+|\\.)*"',
    lambda match: match.group(1) or '"string"', source_code) 
```

即使字符串包含反斜杠（`\"`, `\\`, `\n`, `\\`,等都可以正常工作）`\\"`，上面的正则表达式也能正常工作。`\\\"`

在构建正则表达式时，请确保匹配注释（这样您的正则表达式替换不会触及注释中的字符串）和正则表达式文字（例如在 Perl、Ruby 和 JavaScript 中），并注意正确匹配反斜杠和换行符（例如在 Perl 和 Ruby 中，字符串可以包含换行符）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T06:06:40.523

您在任何地方都没有提到您采用了一种使用[lexer](http://en.wikipedia.org/wiki/Lexical_analysis)和[parser](http://en.wikipedia.org/wiki/Parsing)的方法。如果实际上您没有，请查看例如[tokenize](http://docs.python.org/library/tokenize.html)模块（这可能是您想要的），或第 3 方模块[PLY](http://www.dabeaz.com/ply/)（Python Lex-Yacc）。您的问题需要一种系统的方法，而这些工具（和其他工具）提供了它。

（请注意，一旦您对代码进行了标记，您可以将*另一个*专门的标记器应用于字符串的内容，以检测特殊的格式化指令，例如`%s`. 在这种情况下，正则表达式可能会完成这项工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T06:08:02.907

**为每种语言使用专用的解析器**——尤其是因为人们已经为你完成了这项工作。您提到的大多数语言都有语法。

# vim - 删除 GVim 中的工具栏

> ID：846879
> 
> 赞同：24
> 
> 时间：2009-05-11T05:59:34.777
> 
> 标签：vim, toolbar

如何删除 GVim 中的工具栏（具有打开的保存按钮）？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-05-11T06:01:02.793

```
:set guioptions-=T 
```

也可以看看：

```
:help 'guioptions' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T06:02:38.097

最好的方法是使用 -= 运算符（如[@apaid nerd](https://stackoverflow.com/users/102704/a-paid-nerd)[当前接受的答案](https://stackoverflow.com/a/846884/5742)所示）。将此行添加到配置文件 ( )`$MYVIMRC`

```
:set guioptions-=T 
```

为了了解上述行的作用（见下文），除了发出帮助命令外，您还可以在[此处](http://vimdoc.sourceforge.net/htmldoc/options.html#'guioptions')找到它。

* * *

我的 .vimrc 设置如下

```
set guioptions=aegimrLt 
```

每个选项的定义可以通过发布找到

```
:help guioptions 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T13:56:24.303

另一个：

```
:set toolbar=
:help 'toolbar' 
```

# mercurial - 记录水银交易

> ID：846881
> 
> 赞同：0
> 
> 时间：2009-05-11T06:00:27.567
> 
> 标签：mercurial, shell

这是对先前脚本的一个小补充，这次我想记录备份的详细信息。

```
script /tmp/commit-push-log

# add all files to the repository
for REPOSITORY in $@ 
do

    cd $REPOSITORY

    # commit the changes
    hg commit -A -m "Commit changes `date`"

    # push the changes to the remote repository
    if hg push 
    then
        logger hg push completed without failure
    else
        logger hg push fails
    fi

done

exit

cat /tmp/commit-push-log | logger

rm /tmp/commit-push-log 
```

问题是我在日志中看不到任何反复无常的消息。我的脚本有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T09:37:07.713

我现在的版本

```
for REPOSITORY in $@ 
do

    # new temp file
    OUTPUT_LOG=`tempfile`
    echo -n > $OUTPUT_LOG

    # checks whether $REPO is a repo
    if [ ! -d $REPOSITORY/.hg ]; then
      echo "Not a repository: $REPOSITORY"
      exit 1;
    fi

    # change to that dir
    cd "$REPOSITORY"

    logger "Repository: $REPOSITORY"

    # commit the changes
    hg commit -A -m "Commit changes `date`" 2>&1 >> $OUTPUT_LOG

    # push the changes to the remote repository
    if hg push 2>&1 >> $OUTPUT_LOG
    then
    logger hg push completed without failure
    else
    logger hg push fails
    exit 1;
    fi

    # log the contents and delete the tempfile
    cat $OUTPUT_LOG | logger

    rm -f $OUTLOG_LOG

done

exit 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T09:39:47.023

1.  您不应使用静态 tmp 文件名。使用 mktemp，它更安全。
2.  您应该`cd "$REPOSITORY"`代替“cd $REPOSITORY”，否则当 REPOSITORY 包含任何空格或特殊字符时，事情会变得很有趣。
3.  您不应该编写自动提交评论。[有关此主题的精彩文章，请参见此处](http://www.randsinrepose.com/archives/2006/03/23/capturing_context.html)。
4.  **hg**可能会向 stderr 输出错误。使用`hg commit -A -m "$comment" 2>&1`和`hg push 2>&1`

# comments - 在源代码文件顶部的注释中放置什么信息？

> ID：846889
> 
> 赞同：14
> 
> 时间：2009-05-11T06:02:02.993
> 
> 标签：comments

您认为哪些信息值得放在源代码文件开头的注释中？

我能想到的只是作者的名字，也许还有文件的创建日期（尽管我不确定这些信息是否有任何有用的价值）。

**[编辑]**澄清一下，我的意思不是上课前的评论，而是在文件的第一行，包括语句和其他内容之前。像

```
/**
 * Author:    Name
 * Created:   11.05.2009
 * 
 * (c) Copyright by Blub Corp.
 **/ 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-11T06:12:42.370

### 在文件头中放什么：

*   *源代码所属的*库/组件**
**   *版权*详情*   源文件中类的简短而有意义的*描述**

 *### 什么不要放在文件头中：

*   任何复制作为代码本身一部分的低级逻辑的东西。如果源代码更改时未更新，这可能会导致维护问题。

*   *作者姓名*。为什么？

    *   在修订控制系统的世界中，虽然某些代码可能有最初的作者，但最终所有权变得模糊。当代码进入生命周期的维护阶段时尤其如此，所有者可以定期更改。
    *   经过足够的更改后，所有代码最终都成为“社区维基”；-)
    *   您是否希望您的名字永远与所有代码相关联，并且完全清楚您不会对代码负责，直到它死亡？
*   *创建*和*上次更改*日期。这与上面列出的原因类似。修订控制包括这些信息——为什么在标题中复制它，为自己做更多的工作，并且当事情不可避免地发生变化时冒着在评论中留下不准确信息的风险？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-11T06:05:42.943

*   版权
*   原作者
*   许可证（如果它是开源的）
*   单行目的陈述或描述
*   进一步的整体文档和使用示例

*编辑：将**作者*更改为*原始作者*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T06:07:20.367

如果文件将包含一些可以通过合理常识理解的非常常见的类/功能，那么您实际上不需要在描述中添加太多内容，否则如果源代码文件是非常特定于项目的类/功能或包含复杂的逻辑，那么您应该对源代码文件进行高级概述和用途。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T06:12:28.827

文件编码！(UTF-8)

```
# -*- encoding: utf-8 -*- 
```

特别是如果您计划在某个时候与世界其他地方的其他人共享您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-11T07:34:27.197

综上所述，您还可以在该文件中详细说明代码的用途，您认为这也有助于调试和理解功能。这有助于维护和支持。

# vba - 如何使用 vb.net 在 excel 文件的“ThisWorkbook”中添加/删除代码行？

> ID：846894
> 
> 赞同：0
> 
> 时间：2009-05-11T06:04:29.700
> 
> 标签：vba, excel

根据我的应用程序，我想使用 vb.net 在 Excel 文件的“ThisWorkbook”中编写一些行代码，在此之前我们需要检查文件是否存在代码。

请让我知道任何代码或链接以供参考..

谢谢你...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T01:27:39.967

这是可能的，但用户的宏安全设置也很可能会阻止它最初工作。

要调整安全设置（Excel 2003 的所有示例）：

（来自工作簿）：工具 > 宏 > 安全 > 受信任的发布者

您现在需要选中“信任对 Visual Basic 项目的访问”框

阅读代码：

（来自 VBA 编辑器）：工具 > 参考并添加“Microsoft Visual Basic For Applications Extensibility 5.3”（实际文件为 VBE6EXT.OLB）

要确定哪个`VBProject`是哪个，请使用以下`FileName`属性：

```
For Each vbpItem In Application.VBE.VBProjects
   If (vbpItem.FileName = "C:\foo.xls") Then
      Set vbpProject = vbpItem
   End If
Next vbpItem 
```

拥有项目后，您可以按名称引用模块：

`vbpProject.VBComponents("ThisWorkbook")`

你可以检查有多少行是这样的：

`If (vbpProject.VBComponents("ThisWorkbook").CodeModule.CountOfLines <> 147) Then`

使用`CodeModule`对象，您可以读回特定行（通过`Lines`属性）和更改行（使用`ReplaceLine`方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:17:35.637

我能找到的唯一可以做到这一点的是 ThisWorkbook.VBProject.VBComponents.Count 计算您的 VB 解决方案中的模块数量，即 Sheets + ThisWorkbook + 任何其他内容。我找不到任何可以让您对代码进行差异的东西。

您是否正在尝试进行某种安全检查？如果将随机代码插入到您的工作簿中，黑帽不会删除此代码检查吗？为什么不直接使用签名并进行数字签名呢？

# c++ - Windows 7 和缺少 regtlib 的情况

> ID：846899
> 
> 赞同：4
> 
> 时间：2009-05-11T06:06:00.057
> 
> 标签：c++, visual-studio, windows-7, regtlib

**我刚刚发现regtlib.exe 似乎从Windows 7 中丢失**（显然也从Vista 中丢失）。

我刚刚在 VM 中安装了 Windows 7 RC，并且正在尝试在新操作系统上构建我们现有的项目。这些项目基于 c/c++，我使用的是 Visual Studio 2008。为了构建这些项目，我需要注册几个在代码库中引用的 tlb 文件。

有没有人也遇到过这个问题？而且，有没有人设法解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T06:28:58.253

是的，regtlib 已从 vista 及更高版本中删除。据我所知，它所做的只是调用带有`REGKIND_REGISTER`标志的 LoadTypeLibEx ( [http://msdn.microsoft.com/en-us/library/ms221249.aspx](http://msdn.microsoft.com/en-us/library/ms221249.aspx) )。也许你可以写一个简单的替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-05T16:56:08.380

刚刚遇到这个问题（无法在 Win7 上的 VB6 项目中添加任何组件）。这篇文章（[在 VB 6 IDE 中访问系统注册表时出错](https://stackoverflow.com/questions/104383/error-accessing-the-system-registry-in-vb-6-ide)）指向了regtlib（Win7 中缺少该功能）。我只是将 VB6 开始菜单图标设置为“以管理员身份运行”，它可以很好地添加组件，并且还应该解决与更新注册表有关的任何问题。

问候

伊恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-16T06:33:24.973

终于回到尝试在 Windows 7 上构建我们的代码库。无论如何，我回到安装程序中寻找导致我悲伤的依赖项之一。来自安装程序的错误消息没有帮助，但它确实指向了从安装程序内部运行的 regasm。

我从 cmd 提示符运行 regasm 命令并获得了更多信息。您似乎需要管理凭据才能执行此任务，而我们当前的安装程序没有正确执行权限提升。

所以，长话短说，我注册了 dll 并且构建似乎正在工作。

# c# - 在 C# 中，如何更改文本框中新添加的文本的颜色

> ID：846907
> 
> 赞同：0
> 
> 时间：2009-05-11T06:09:06.417
> 
> 标签：c#, visual-studio-2005

考虑我使用 C# VS 2005 构建的 Windows 应用程序在多行文本框中显示某些内容。现在，当我添加一些新文本时，它应该以不同的颜色显示。即我需要区分运行项目时显示的文本和我在文本框中输入的文本。我怎样才能做到这一点。？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T06:11:24.197

普通[`TextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.aspx)控件不支持多种颜色、字体等。

我怀疑你需要使用 a[`RichTextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.aspx)代替。然后，您可以设置该[`SelectionColor`](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.selectioncolor.aspx)属性以更改当前选定文本或在当前插入点插入的文本的颜色。

我应该补充一点，经过几次快速实验后，我发现设置选择颜色然后立即以编程方式附加文本并不像我希望的那样直接。也许另一个答案会解释为什么:)但是，用户输入的文本肯定会立即以新颜色出现......

# c# - 客户端监控键盘记录问题

> ID：846910
> 
> 赞同：2
> 
> 时间：2009-05-11T06:10:02.530
> 
> 标签：c#, multithreading, asynchronous, threadpool

首先，我正在开发的键盘记录器根本不是出于攻击性和破坏性目的。:)

我正在用 C#.NET 开发一个客户端监控应用程序。键盘记录是我的应用程序中的功能之一。虽然我已经开发了键盘记录器的代码，但我无法在我的应用程序中正确实现它。

我的解决方案中有两个项目。UserInterface - 用于服务器端。跟踪器 - 用于客户端 PC。键盘记录模块 Keylogger 位于 Tracker 项目中。

我已经使用辅助类进行套接字编程 - TcpClient、TcpListener 和 NetworkStream 来帮助他们。

另外，我正在使用异步模式进行通信。

我正在发布我面临问题的代码部分：

```
//This code resides on the server-side monitoring interface.When //the administrator hits a btnKeyLog button, a 

message //"StartKeyLog" is sent to the respective client, and the keylogging //is handled on the client. 
```

private void btnKeyLog_Click (对象发送者，EventArgs e) { messageBuffer = new byte[100];

```
 if ( btnKeyLog1.Text == "Start Keylogging" )
    {
        btnKeyLog1.Text = "Stop Keylogging";
        message = "StartKeyLog";

        messageBuffer = Encoding.ASCII.GetBytes ( message );
        try
        {
                //begin writing on the stream.
        clientConnections[0].networkStream.BeginWrite (messageBuffer, 0, messageBuffer.Length, new 

AsyncCallback ( onDataWrite ), null );
        }
        catch ( Exception exc )
        {
            MessageBox.Show ( exc.Message + exc.StackTrace );
        }
    }
    else
    {
        btnKeyLog1.Text = "Start Keylogging";
        message = "StopKeyLog";

        messageBuffer = Encoding.ASCII.GetBytes ( message );
        try
        {
        clientConnections[0].networkStream.BeginWrite ( messageBuffer, 0, messageBuffer.Length, new 

AsyncCallback ( onDataWrite ), null );
        }
        catch ( Exception exc )
        {
            MessageBox.Show ( exc.Message + exc.StackTrace );
        }
    }
} 
```

现在，客户端代码：

```
public void onDataReceived ( IAsyncResult ar )
{
    int nBytesRead = 0;
    try
    {
        nBytesRead = clientConnection.networkStream.EndRead ( ar );
    }
    catch ( Exception exc )
    {
        MessageBox.Show ( exc.Message + exc.StackTrace );
    }
    message = Encoding.ASCII.GetString ( messageBuffer,0, nBytesRead);
    switch (message)
    {
        case "StartKeyLog" :
            MessageBox.Show ( "Keylogger started." );
                       //the following static method wraps the Win32 //implementation of SetWindowsHookEx - all given in Keylogger //module
            KeyboardHook.installHook ( );
                       //after this method is called, the hook is //actually installed; the callback function KeyboardHookProc is also //called.        

    Here, keylogger seems to be working fine, except that the //system slows down considerably when i type keystrokes.
        break;

        case "StopKeyLog":
            MessageBox.Show ( "Keylogger stopped." );
                        // the following method releases the hook
            KeyboardHook.releaseHook ( );
        break;
    }

    try
    {
        messageBuffer = new byte[100];
        clientConnection.networkStream.BeginRead ( messageBuffer, 0, messageBuffer.Length, new AsyncCallback ( onDataReceived ), null );
    }
    catch ( Exception exc )
    {
        MessageBox.Show ( exc.Message + exc.StackTrace );
    }
    //MessageBox.Show ( "Stop" );
//as soon as this function ends, however, the callback function of //the keyboard hook stops being called; keystrokes are not //processed.
//the keystrokes are caught until this function the control is in this //function. i assume that it has to do something with the thread.
} 
```

我试图解释这里的情况。要启动键盘记录，服务器 UI 将向客户端发送消息“StartKeyLog”。客户端收到消息后，会在回调函数“onDataReceived”中进行处理。在这个函数中，消息被处理，

installHook() 方法被调用，它将安装钩子。

当我运行应用程序时，钩子就安装好了；此外，正确调用了 KeyboardHookProc() 回调，并处理了击键。但是这个

只有在 onDataReceived 回调方法有效之前才会出现这种情况。该方法一结束，KeyboardHookProc() 就停止被调用；钥匙

不再处理，就好像从未安装过钩子一样。

另一个问题是，在安装挂钩后，当我按任何键时系统变得相当慢。

我的假设是这两件事都与这里发生的线程有关。但是，我无法得到确切的问题。我已尽力解释情况。不过，欢迎提出任何问题。谁能给我解决方案？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T13:26:04.207

您应该添加 KeyboardHook 的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T12:25:28.840

好吧，我已经设法解决了我的问题。问题是我在我的应用程序的主线程调用的线程上设置了钩子。事实上，我启动那个线程只是为了安装钩子。我只是重组了我的代码，以便将钩子安装在主线程上。它解决了整个问题。:)

# c# - .Net 圆虫

> ID：846911
> 
> 赞同：10
> 
> 时间：2009-05-11T06:11:13.073
> 
> 标签：c#, math, rounding

> **可能重复：**
> [在 C# 中：Math.Round(2.5) 结果是 2（而不是 3）！你在开玩笑吧？](https://stackoverflow.com/questions/977796/in-c-math-round2-5-result-is-2-instead-of-3-are-you-kidding-me)

.Net 3.5 SP1 的 Math.Round 函数似乎将 0.5 舍入为零，而将 1.5 舍入为 2.0。我已经用十进制数字和以下代码对此进行了测试：

```
decimal pos = 0.5m;
decimal neg = -0.5m;

Console.WriteLine("Pos: {0} Rnd: {1}", pos, Math.Round(pos));
Console.WriteLine("Neg: {0} Rnd: {1}", neg, Math.Round(neg));

Console.ReadKey(); 
```

此代码输出以下内容：

Pos: 0.5 Rnd: 0 Neg: -0.5 Rnd: 0

这似乎是一个明显的错误。有没有已知的工作？我已经在 Core2 处理器和 i7 上对此进行了测试，所以它似乎不是硬件。而Reflector只是说decimal.round函数最终调用了一个系统调用。

让我知道是否有其他人看到这个。

# watin - 如何使用 Watin 将多个值传递到 TextField

> ID：846915
> 
> 赞同：3
> 
> 时间：2009-05-11T06:13:03.383
> 
> 标签：watin

我正在使用 WatiN 进行 Web 应用程序测试。有一个名为输入选择的字段，我需要通过按 Enter 键一个接一个地添加 3 个值，即添加第一个值然后按 Enter 键并添加第二个值按 Enter 键，所以请建议我如何使用 WatiN 进行这项工作.

感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T04:59:45.120

这是该问题的另一个答案。当我在那里传递输入键时，它给出了“缺少关键字分隔符”错误，所以我传递了“\r\n”，它工作正常。

WatiN.Core.IE 即 = 新的 WatiN.Core.IE():

TextField txtChoices = ie.TextField(Find.ById("ctl00_ContentPlaceHolder1_TxtChoices"));

txtChoices.TypeText("NotBad");

System.Windows.Forms.SendKeys.SendWait("\r\n");

txtChoices.AppendText("非常好");

System.Windows.Forms.SendKeys.SendWait("\r\n");

txtChoices.AppendText("真棒");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T11:27:05.137

jose 建议的上述方法，我对它为我工作的代码做了一些改动。只需将 TypeText 替换为 AppendText 即可输入第二个值。

WatiN.Core.IE 即 = 新的 WatiN.Core.IE();

TextField txtChoices = ie.TextField(Find.ById("ctl00_ContentPlaceHolder1_TxtChoices"));

txtChoices.TypeText("NotBad");

System.Windows.Forms.SendKeys.SendWait("{ENTER}");

txtChoices.AppendText("非常好");

# linq - 需要一些帮助来订购 Linq 结果

> ID：846921
> 
> 赞同：0
> 
> 时间：2009-05-11T06:15:26.373
> 
> 标签：linq, sql-order-by

我有一些 Linq 代码，可以正常工作。它检索按最新排序的董事会帖子列表。

这里的问题是*按*...排序，按最近的 COMMENTS 排序。因此，如果董事会帖子刚刚获得评论，那么它将位于列表的顶部（即最近的）。

kewl ...但是刚刚创建的新董事会帖子呢？它们被列在底部，因为它们没有评论:(就像我想说“*按最近评论排序..但如果你没有评论，那么它在你的董事会帖子创建日期之前)* ”。

这是我的 linq...

```
boardPostList = (from bp in db.tblBoardPosts.Where(whereClause)
    orderby (from bc in bp.tblBoardComments
    orderby bc.DateModified descending
    select bc.DateModified).First() descending
    select bp).ToPagedList(pageNumber, numberOfResults); 
```

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T06:24:49.807

是否有任何理由您无法在`tblBoardPosts`向其发布评论时更新字段？保留“发布或最后评论”日期，这样您就有了一个*更*简单的查询，并且不需要扫描系统中的每条评论来确定要做什么。

话虽如此，如果您的字段可以为空，则此查询*可能会起作用：*`DateModified`

```
boardPostList = (from bp in db.tblBoardPosts.Where(whereClause)
    orderby ((from bc in bp.tblBoardComments
    orderby bc.DateModified descending
    select bc.DateModified).FirstOrDefault() ?? bp.DateModified) descending
    select bp).ToPagedList(pageNumber, numberOfResults); 
```

如果它只是一个直列`DateTime`，则结果`FirstOrDefault`仍然`DateTime`是不可为空的...您可以尝试：

```
boardPostList = (from bp in db.tblBoardPosts.Where(whereClause)
    let lastComment = bp.tblBoardComments
                        .OrderByDescending(bc => bc.DateModified)
                        .FirstOrDefault()
    let lastModified = (lastComment == null 
                        ? bp.DateModified 
                        : lastComment.DateModified) 
    orderby lastModified descending
    select bp).ToPagedList(pageNumber, numberOfResults); 
```

虽然它非常可怕，并且可能无法正确转换为 SQL。我当然会尝试更改为帖子本身跟踪它的方案。

# ruby - 替换 rdoc 使用

> ID：846923
> 
> 赞同：4
> 
> 时间：2009-05-11T06:17:30.690
> 
> 标签：ruby, ruby-1.9, rdoc

根据[这篇文章](http://osdir.com/ml/ruby-talk/2009-04/msg00063.html)，RDoc::usage 目前在 ruby​​ 1.9 中不可用。有没有好的替代品？

我很想听听标准安装中可用的内容以及 gems 中可用的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T12:18:05.517

我喜欢[OptionParser](http://www.ruby-doc.org/stdlib/libdoc/optparse/rdoc/classes/OptionParser.html)（文章提到`RDoc::usage`的对补充有用的东西）。

看起来任何 1.9 的错误[都已被修补](http://redmine.ruby-lang.org/search/index/ruby-19?q=optparse+1.9&issues=1&changesets=1&wiki_pages=1&all_words=1&titles_only=1&submit=Submit)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-27T01:15:57.433

在[特性请求 2713](http://redmine.ruby-lang.org/issues/show/2713)中，rdoc 维护者声明他不会将 rdoc/usage 或任何类似特性添加回 rdoc，并表示应该使用 OptionParser。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-22T18:48:23.163

我们对所有新脚本都使用 OptionParser，但有大约 100 多个使用 RDoc。我没有重写每一个，而是写了这个方法（BB 是我们公司的命名空间。把它改成你喜欢的任何东西）。它工作得很好。语法略有不同，但它的帮助文本所以我们不介意。希望能帮助到你！

然后我使用 sed 查找所有脚本并更改它们。

```
grep -rl "RDoc::usage" * | xargs sed -i "/rdoc\/usage/ s/RDoc/BB/"
grep -rl "BB::usage" * | xargs sed -i "/rdoc\/usage/ s/rdoc/lib\/bb/" 
```

-

```
module BB
    def BB::usage( exit_code )

        File::open( $0, 'r').readlines.each_with_index do | line, idx |
            next if idx == 0
            if( line =~ /^#/ )
                puts line.gsub(/^#\ ?/,'')
            else
                puts #RDoc adds extra line so we do too
                exit( exit_code )
            end
        end
    end
end 
```

# .net - 将 HTML 转换为文本的 DOT NET 代码

> ID：846925
> 
> 赞同：3
> 
> 时间：2009-05-11T06:17:46.480
> 
> 标签：.net, html-to-text

我正在创建一个小算法来从网站获取文本..然后找到答案（完成后将发布脚本）。

为此，我需要将所有 HTML 代码转换为简单易读的英文文本。

我已经手动删除了所有 html 标签，但有些 css 条目很难摆脱。关于如何将 html 转换为纯英文文本的任何简单想法？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T06:30:18.160

[有人](http://www.codeproject.com/Members/paceman)已经为您完成了[所有工作](http://www.codeproject.com/KB/HTML/HTML_to_Plain_Text.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:28:57.840

我开发了类似的东西来避免正则表达式的性能损失：[strip_tags 等效于 ASP.NET](http://www.codeproject.com/KB/MCMS/htmlTagStripper.aspx)（也可以在桌面 .NET 程序集上运行）

# c# - 是否可以使用 PIA 将 microsoft word 文档编辑器插入到自己的应用程序中

> ID：846927
> 
> 赞同：1
> 
> 时间：2009-05-11T06:20:47.427
> 
> 标签：c#, pia, primary-interop-assembly

如何在自己的应用程序中使用 Office Primary Interop 程序集，如[框中的 Business](http://www.envision-sbs.com/)。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T06:45:09.887

[您可以使用DSO Framer](http://support.microsoft.com/kb/311765)在控件内托管 Microsoft Office 应用程序。您只需：

*   添加对 DSOFramer COM dll 的引用。
*   右键单击 Visual Studio 中的工具箱 -> 选择项 -> COM 组件 -> DSO Gramer 控件对象
*   将新的 DSO 成帧器拖到您的表单或父控件上
*   并调用`framerControl.Open(@"C:\SomeDocument.doc");`- 它会确定要嵌入哪个 Office 应用程序。

* * *

或者，您可以使用 Win32 API[将其他程序嵌入](https://stackoverflow.com/questions/758494/how-can-i-run-another-application-within-a-panel-of-my-c-program/758772#758772)到您自己的应用程序中的 Panel 控件中。

# c# - ADO 实体 SubmitChanges 未提交

> ID：846929
> 
> 赞同：0
> 
> 时间：2009-05-11T06:21:30.420
> 
> 标签：c#, linq, silverlight, ado.net-entity-data-model

我正在使用链接到 Linq-to-Sql 上下文的域服务类。使用它成功添加的断点，

```
context.Company.Add(NewCompany); 
```

我从 Silverlight 调用这个，但保存部分似乎失败了......

```
context.SubmitChanges(); 
```

如中，我没有错误，也没有添加到数据库中。我所有的表都相互关联，例如“公司”与“地址”有关联，我错过了一步吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T09:57:46.230

如果您使用的是文件数据库（mdf、sdf、mdb ...）：

检查数据库项目项的属性，将“复制到输出目录”属性设置为“不复制”或“如果较新则复制”。否则每次编译都会覆盖输出目录下的数据库文件。这很愚蠢，但这是VS中的默认行为......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T11:19:52.540

我终于发现了错误...显然我的连接字符串是错误的，它正在尝试使用我的凭据进行连接。当创建 Linq-To-Sql 对象时，它没有保存凭据...天哪，浪费了一个周末...

# .net - 以编程方式检索 MS SQL 视图的列，包括 .net/C# 中的别名？

> ID：846933
> 
> 赞同：1
> 
> 时间：2009-05-11T06:22:37.937
> 
> 标签：.net, sql-server

如何在 C# 中检索“视图”中涉及的列（包括别名）名称、表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:47:02.250

您可以通过多种方式从 C# 调用以下 sql。我会让你弄清楚使用哪一个;）

> 选择 c.* From sys.all_views v join sys.all_columns c on c.object_id = v.object_id 其中 v.name = 'MyView'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:45:29.290

您可以像查询普通表一样查询它。别名应该像常规列名一样出现。

SqlConnection con = new SqlConnection("MyConnectionString");

数据表 dt = 新数据表（）；

SqlDataAdapter da = new SqlDataAdapter("Select * FROM vw_MyView",con);

da.fill(ds);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T18:49:09.757

连接上的 GetSchema 怎么样，即：

```
Dim conn As New SqlConnection(
"Data Source=YOURMACHINE;initial catalog=YOURDB;Integrated security=true")

conn.Open()

Dim dt As New DataTable

Dim viewName(3) As String
viewName(0) = Nothing
viewName(1) = Nothing
viewName(2) = "YOURVIEWNAME"

dt = conn.GetSchema(SqlClientMetaDataCollectionNames.Views, viewName) 
```

即[http://msdn.microsoft.com/en-us/library/ms136367(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms136367(VS.80).aspx)

# iis - %2B 解码为空格而不是加号

> ID：846934
> 
> 赞同：2
> 
> 时间：2009-05-11T06:23:11.040
> 
> 标签：iis, encoding, asp-classic, isapi

我们在特定服务器中遇到问题。发布到应用程序的所有加号都替换为空格 - 在 POST 和 GET 中以及在该站点的所有页面上。
作为一个测试用例，我有这个小页面（它是一个 ASP 服务器）：

```
<html>
<body>
  <form method="post">
    <input type="text" name="Plus" id="Plus" />
    <input type="submit" />
  </form>
  Previous Value: <%= request("Plus") %><br />
  Query String: <%= request.querystring %>
</body>
</html> 
```

在每台其他服务器上，这都很好，但在一台服务器上，加号被替换为空格。
示例：对于输入“ `1 2+3`”-request(“Plus”) 为“ `1 2 3`”，查询字符串为“ `1+2+3`”。不好。其他字符似乎正确解码。
应该说有人试图“强化”该服务器以抵御攻击，因此可能会打开模糊的 IIS 选项（尽管我们确实删除了 ISAPI 过滤器）。
谢谢。

* * *

更新：原来安装了另一个过滤器，来自[http://www.codeplex.com/IIS6SQLInjection](http://www.codeplex.com/IIS6SQLInjection)的 SQL 注入过滤器 ISAPIClipSQLInjection.dll 。
过滤器有问题 - 它替换了 POST 和 GET 中的有效字符：

1.  加号用空格代替：“1%2B2”->“1+2”，同“1 2”
2.  分号替换为逗号：“hello;” ->“你好”

较新版本的过滤器 (2.0b) 无法解决此问题，但允许排除某些页面。由于它是在生产中安装的，我们决定不删除过滤器，我们使用 javascript 将所有加号更改为`"&#43 "`（带空格而不是分号）。
不是最佳解决方案，但这正是老板想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T16:50:34.943

考虑ASCII码。用它的 ascii 代码代替加号。它将是 chr(43)。asp 和 sql 都会理解这一点。

这是一个包含所有 ascii 代码的表格。 [http://www.asciitable.com/](http://www.asciitable.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-24T02:18:27.933

嗯，这也让我很困惑。直到我看到这篇文章：[Server.URLEncode 开始用加号（“+”）而不是 percent-20（“%20”）替换空白](https://stackoverflow.com/questions/56651033/server-urlencode-started-to-replace-blank-with-plus-instead-of-percent-20)

简而言之：

*   [RFC-1866](https://www.rfc-editor.org/rfc/rfc1866)（大约 1995 年），声明空白“”应该在请求正文中解析为“+”。
*   [RFC-3986](https://www.rfc-editor.org/rfc/rfc3986) (2005, Jan) 声明空白“”应该被解析为“%20”

而在 ASP 框架中，它支持 RFC-1866，有时会混合使用 RFC-3986（似乎），所以参数`%2b`首先转换为`+`（普通 ascii/urldecode 规则，然后再转换为（RFC-1866 规则）

这是我的猜测，我不在乎过时的技术，有关更多详细信息，请参阅

# ruby-on-rails - 将对象从视图传递到控制器

> ID：846936
> 
> 赞同：3
> 
> 时间：2009-05-11T06:23:40.870
> 
> 标签：ruby-on-rails, model-view-controller, forms, link-to-remote

有没有办法将对象（特别是视图中使用的 form_builder 对象）传递给控制器​​中的操作？我正在使用 link_to_remote 并希望更新控制器中的变量，然后通过 render :update 块将新的嵌套表单元素添加到我的表单中。

如果我将它作为参数传递，它会得到转换的字符串，我似乎也无法成功地将本地哈希传递给控制器​​。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T10:14:31.087

不，您不能将对象从视图传递给控制器​​。

您的所有逻辑都应该发生在控制器和模型中，并且在流程结束时，视图会在浏览器或其他地方呈现结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T10:12:52.007

您只能使用参数，无论您需要发送到控制器，都必须在参数内部进行序列化。我确定您不需要发送整个 form_builder 对象，只需发送构建新“子表单”所需的内容即可

顺便说一句，您应该构建您的视图和控制器以在没有任何 ajax 的情况下工作，然后逐步增强您的表单和控制器以支持 ajax。RJS 和 render :update 是不好的做法，应该避免。找一个懂 javascript 的人，而不是用 Rails 的 RJS 写伪代码

# android - 有没有办法在不使用 gdata-java-client 的情况下访问日历的条目？

> ID：846942
> 
> 赞同：3
> 
> 时间：2009-05-11T06:26:28.353
> 
> 标签：android, android-calendar

是否可以从手机离线获取日历条目？似乎唯一的方法是使用[gdata-java-client](http://code.google.com/p/gdata-java-client/)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-10-18T12:07:37.657

Josef 和 Isaac 的日历访问解决方案仅适用于 Android 2.1 及更早版本。Google 已将 2.2 中的基本内容 URI 从“content://calendar”更改为“content://com.android.calendar”。此更改意味着最好的方法是尝试使用旧的基本 URI 获取游标，如果返回的游标为空，则尝试新的基本 URI。

请注意，我从Shane Conder 和 Lauren Darcey 在他们的[Working With The Android Calendar](http://www.developer.com/ws/article.php/3850276/Working-with-the-Android-Calendar.htm)文章中提供的[开源测试代码中获得了这种方法。](http://code.google.com/p/android-calendar-provider-tests/)

```
private final static String BASE_CALENDAR_URI_PRE_2_2 = "content://calendar";
private final static String BASE_CALENDAR_URI_2_2 = "content://com.android.calendar";
/*
 * Determines if we need to use a pre 2.2 calendar Uri, or a 2.2 calendar Uri, and returns the base Uri
 */
private String getCalendarUriBase() {
    Uri calendars = Uri.parse(BASE_CALENDAR_URI_PRE_2_2 + "/calendars");
    try {
        Cursor managedCursor = managedQuery(calendars, null, null, null, null);
        if (managedCursor != null) {
            return BASE_CALENDAR_URI_PRE_2_2;
        }
        else {
            calendars = Uri.parse(BASE_CALENDAR_URI_2_2 + "/calendars");
            managedCursor = managedQuery(calendars, null, null, null, null);

            if (managedCursor != null) {
                return BASE_CALENDAR_URI_2_2;
            }
        }
    } catch (Exception e) { /* eat any exceptions */ }

    return null; // No working calendar URI found
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-27T22:43:57.493

这些答案很好，但它们都涉及硬编码`Calendar URI`（我在不同的 Android 设备上看到了三种不同的化身）。

一个更好的方法`URI`（它硬编码一个类的名称和一个字段）是这样的：

```
Class<?> calendarProviderClass = Class.forName("android.provider.Calendar");
Field uriField = calendarProviderClass.getField("CONTENT_URI");
Uri calendarUri = (Uri) uriField.get(null); 
```

这并不完美（如果他们删除了`android.provider.Calendar`类或`CONTENT_URI`字段，它会中断），但它可以在比任何单个 URI 硬代码更多的平台上工作。

请注意，这些反射方法将抛出`exceptions`需要被调用方法捕获或重新抛出的内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T12:47:38.910

您可以使用日历内容提供程序 ( `com.android.providers.calendar.CalendarProvider`)。例子：

```
 ContentResolver contentResolver = context.getContentResolver();
Cursor cursor = contentResolver.query(Uri.parse("content://calendar/events"), null, null, null, null);

while(cursor.moveToNext()) {
    String eventTitle = cursor.getString(cursor.getColumnIndex("title"));
    Date eventStart = new Date(cursor.getLong(cursor.getColumnIndex("dtstart")));
    // etc.
} 
```

**编辑**：你可能想把它放在一个包装器中（参见[Isaac 的帖子](https://stackoverflow.com/questions/846942/is-there-a-way-to-access-the-calendars-entries-without-using-gdata-java-client/885659#885659)），因为它目前是一个私有 API。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-20T00:20:22.747

目前，如果不使用私有 API，这是不可能的（请参阅 Josef 的帖子。）有一个日历提供程序，但它尚未公开。它可能随时更改并破坏您的应用程序。
不过，它可能不会改变（我认为他们不会从“日历”改变它），所以你也许可以使用它。但我的建议是使用这样的单独类：

```
public class CalendarProvider {
     public static final Uri CONTENT_URI = Uri.parse("content://calendar");
     public static final String TITLE = "title";
     public static final String .... 
```

并直接使用那些而不是字符串。如果/当 API 更改或公开时，这将让您非常轻松地更改它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-03T04:19:33.877

您可以从这里使用 CalendarContract：[https ://github.com/dschuermann/android-calendar-compatibility](https://github.com/dschuermann/android-calendar-compatibility)

它与 Android 4 上可用的 API 类相同，但适用于 Android >= 2.2。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-13T03:43:45.873

Nick 的解决方案涉及 managedQuery，在 Context 类中没有定义。很多时候，当您在后台运行时，您会想要使用上下文对象。这是一个修改后的版本：

公共字符串 getCalendarUriBase() {

返回（android.os.Build.VERSION.SDK_INT>=8）？“内容：//com.android.calendar”：“内容：//日历”；}

此处不应执行对 null 的捕获，因为即使 managedQuery 较早成功，也可能存在更多异常。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-10T17:24:29.720

关于可以更改的 API... 整个 ContentProvider 方法不会很快更改，因此仅通过更新字符串就可以克服很多问题。因此，创建您在整个项目中重用的常量。

```
public static final String URI_CONTENT_CALENDAR_EVENTS = "content://calendar/events";

ContentResolver contentResolver = context.getContentResolver();
Cursor cursor = contentResolver.query(Uri.parse(URI_CONTENT_CALENDAR_EVENTS), null, null, null, null);
    //etc 
```

如果你想要一个适当的私有 API，你必须创建一个 pojo 和一些这样的服务：

```
public class CalendarEvent {
    private long id;
    private long date;
    //etc...
}

public interface CalendarService {

    public Set<CalendarEvent> getAllCalendarEvents();

    public CalendarEvent findCalendarEventById(long id);

    public CalendarEvent findCalendarEventByDate(long date);

} 
```

等等。这样，您只需更新 CalendarEvent 对象和此服务，以防 API 发生更改。

# dynamic - 动态端口

> ID：846948
> 
> 赞同：1
> 
> 时间：2009-05-11T06:30:02.293
> 
> 标签：dynamic, communication, port

动态端口不是一直在变化吗？如果是，这些端口是否会改变并且通信停止？请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:50:35.630

如果我理解你的问题，那么简而言之，不。

当您的 HTTP 客户端（又名 Web 浏览器）打开连接时，操作系统会从动态（或“临时”）范围中选择一个随机端口号。

该连接的所有通信继续使用同一端口。

只有在打开*新*连接时才会选择另一个端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-26T12:54:06.490

To clarify the other end...

Servers of "standard application protocols", like HTTP and FTP have a port assigned to them by a standards body IANA. For example, in the case of HTTP, the default port is "80".

Unless the client selects a non-standard port, web connections are always made to port 80.

The web server is always listening on port 80, it never goes anywhere.

Separately, some protocols use "dynamic protocol assignment", where the protocol number of a service can change, but there is a way to make sure the changing port number is known.

# python - Twisted 是 httplib2/socket 的替代品吗？

> ID：846950
> 
> 赞同：6
> 
> 时间：2009-05-11T06:30:44.587
> 
> 标签：python, networking, sockets, twisted, httplib2

许多 python 库，甚至是最近编写的库，都使用 httplib2 或套接字接口来执行网络任务。

由于它们的阻塞特性，它们显然比 Twisted 更容易编码，但我认为这是将它们与其他代码集成时的一个缺点，尤其是 GUI 代码。如果您希望在避免多线程的同时实现可扩展性、并发性或 GUI 集成，那么 Twisted 是一个自然的选择。

所以我会对这些问题的意见感兴趣：

1.  是否应该使用 Twisted 编写新的网络代码（小型命令行工具除外）？
2.  你会在同一个项目中混合使用 Twisted、http2lib 或 socket 代码吗？
3.  Twisted pythonic 是否适用于大多数库（它比替代品更复杂，引入对非标准包的依赖......）？

**编辑：**请让我换一种说法。您是否觉得使用 Twisted 编写新的库代码可能会阻碍其采用？Twisted 具有明显的优势（尤其是 gimel 所述的可移植性和可扩展性），但它不是核心 python 库这一事实可能被某些人认为是一个缺点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T06:46:53.483

请参阅[asychronous-programming-in-python-twisted](https://stackoverflow.com/questions/80617/asychronous-programming-in-python-twisted)，您必须决定是否依赖非标准（外部）库满足您的需求。注意[@Glyph](https://stackoverflow.com/users/13564/glyph)的回答，他是`Twisted`项目的创始人，可以权威回答任何`Twisted`相关问题。

> 在 Twisted 等库的核心，主循环中的函数不是睡眠，而是一个操作系统调用，如 select() 或 poll()，由 Python select 模块等模块公开。我说“喜欢”选择，因为这是一个在平台之间变化很大的 API，而且几乎每个 GUI 工具包都有自己的版本。Twisted 目前为这个主题的 14 种不同变体提供了一个抽象接口。这种 API 提供的常见功能是提供一种方式来表示“这是我正在等待的事件列表。去睡觉直到其中一个发生，然后醒来告诉我它是哪一个。 "

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:58:25.010

1.  是否应该使用 Twisted 编写新的网络代码（小型命令行工具除外）？
    *   也许。这真的取决于。有时它很容易将阻塞调用包装在他们自己的线程中。Twisted 适用于大规模网络代码。
2.  你会在同一个项目中混合使用 Twisted、http2lib 或 socket 代码吗？
    *   当然。但是请记住 Twisted 是单线程的，并且 Twisted 中的任何阻塞调用都会阻塞整个引擎。
3.  Twisted pythonic 是否适用于大多数库（它比替代品更复杂，引入对非标准包的依赖......）？
    *   有许多 Twisted 狂热者会说它属于 Python 标准库。但是很多人可以使用 asyncore/asynchat 实现不错的网络代码。

# javascript - 使用 jQuery 更改 URL 和重定向

> ID：846954
> 
> 赞同：135
> 
> 时间：2009-05-11T06:31:36.113
> 
> 标签：javascript, jquery, url, redirect

我有一些这样的代码，

```
<form id="abc">
  <input type="text" id="txt" />
</form> 
```

现在我想像这样重定向，

```
var temp = $("#txt").val();
url = "http://example.com/" + temp;
window.location.replace(url);
// or window.location(url); 
```

jQuery中有没有解决这个问题？它仍然让我有`url = http://example.com`。

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2009-05-11T07:53:58.303

正如其他答案中提到的，您不需要 jQuery 来执行此操作；您可以只使用标准属性。

但是，您似乎不知道 和 之间的`window.location.replace(url)`区别`window.location = url`。

1.  `window.location.replace(url)`将地址栏中的当前位置替换为新位置。调用该函数的页面不会包含在浏览器历史记录中。因此，在新位置上，单击浏览器中的后退按钮将使您返回到您在访问包含重定向 JavaScript 的文档之前查看的页面。
2.  `window.location = url`重定向到新位置。在这个新页面上，浏览器中的后退按钮将指向包含重定向 JavaScript 的原始页面。

当然，两者都有自己的用例，但在我看来，在这种情况下，您应该坚持使用后者。

`http:`PS：您可能在 JavaScript 的第 2 行之后忘记了两个斜杠：

```
url = "http://abc.com/" + temp; 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-11T06:34:59.367

告诉你真相，我仍然没有得到你需要的东西，但是

```
window.location(url); 
```

应该

```
window.location = url; 
```

搜索[window.location](https://developer.mozilla.org/en-US/docs/Web/API/Window/location)参考会告诉你。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-11T06:35:33.907

jQuery 没有这个选项，也不应该有一个选项。这是完全有效的 javascript，jQuery 没有理由为此提供包装函数。

jQuery 只是 javascript 之上的一个库，即使您使用 jQuery，您仍然可以使用普通的 javascript。

顺便说一句 window.location 不是一个函数，而是一个属性，你应该像这样设置：

```
window.location = url; 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-01-12T08:33:18.613

```
var temp="/yourapp/";
$(location).attr('href','http://abcd.com'+temp); 
```

试试这个...用作替代品

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-23T03:40:36.243

尝试这个...

```
$("#abc").attr("action", "/yourapp/" + temp).submit(); 
```

这是什么意思：

找到带有`id`“abc”的表单，将其更改`attribute`为“action”，然后提交...

这对我有用... !!!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-27T14:25:53.207

你可以这样做：

```
var url = "http://example.com/" + temp;
$(location).attr('href',url); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-19T07:37:54.420

如果你真的想用 jQuery 来做这个（为什么？）你应该让 DOM window.location 对象使用它的功能：

```
$(window.location)[0].replace("https://www.google.it"); 
```

请注意，[0] 告诉 jQuery 直接使用 DOM 对象，而不是封装 DOM 对象的 $(window.location) jQuery 对象。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-04-14T13:15:02.103

你可以在没有 jquery 的情况下做的更简单

```
location = "https://example.com/" + txt.value 
```

```
function send() {
  location = "https://example.com/" + txt.value;
}
```

```
<form id="abc">
  <input type="text" id="txt" />
</form>

<button onclick="send()">Send</button>
```

# tsql - 如何在我的 sql 数据库中更新此字段？

> ID：846955
> 
> 赞同：0
> 
> 时间：2009-05-11T06:31:39.343
> 
> 标签：tsql, sql-update

我有两张桌子。

```
BoardPosts
BoardPostId INT PK
ModifiedOn DATETIME NULLABLE

BoardComments
BoardCommentId INT PK
BoardPostId INT
CreatedOn DATETIME 
```

董事会帖子有零到多条评论。

如果董事会有评论，我希望将该`ModifiedOn`字段设置为最近的评论日期。否则，只需将其保留为空。

我该怎么做，使用 TSql ？

就像是 ...

```
UPDATE BoardPosts
SET ModifiedOn = CreatedOn
SELECT TOP(1) CreatedOn
FROM BoardPosts a INNER JOIN BoardComments b ON a.BoardPostId = b.BoardPostId 
```

？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T06:42:52.133

我认为这会奏效...

```
UPDATE BoardPosts
SET ModifiedOn = (SELECT MAX(CreatedOn) 
                  FROM BoardComments 
                  WHERE BoardComments.BoardPostId = BoardPosts.BoardPostId) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T06:50:34.303

我决定同时考虑评论和未评论的帖子：

```
update p1 set ModifiedOn = (
select
    max(case when c.CreatedOn is null then p.CreatedOn
    else c.CreatedOn end) as ModDate
from 
    boardposts p
    left outer join BoardComments c on
        p.BoardPostId = c.BoardPostId
where
    p.BoardPostId = p1.BoardPostId
group by p.BoardPostId
)
from
    BoardPosts p1 
```

希望这可以帮助！

# java - 连接到 sonatype nexus 时如何传递凭据（禁用匿名登录）？

> ID：846957
> 
> 赞同：4
> 
> 时间：2009-05-11T06:32:17.423
> 
> 标签：java, maven-2, command-line, nexus, sonatype

在 Eclipse 中，当我构建 maven2 项目时，m2eclipse 插件会提示我输入凭据。它编译得很好。

但是，如果我现在尝试从命令行运行“mvn install”，我会得到一个 artifact not found 错误。如何将用户名/密码添加到我的 pom.xml 中以解决此问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T07:05:10.863

你说的是哪个用户名密码？如果它是在 nexus 存储库中定义的用户名，那么您可以在`settings.xml`定义 nexus 存储库的位置进行定义。

```
<servers>
  <server>
    <id>releases</id>
    <username>xxxxxxxxx</username>
    <password>yyyyyyyy</password>
  </server>
</servers> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T06:40:47.673

据我所知，没有 Maven xml 标签来配置它。当然，您可以尝试在域名前加上用户名和密码，如下所示：

```
http://username:password@yournexusserver/.. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T16:32:33.663

当 Nexus 提示时，Maven 将使用您设置中定义的条目进行身份验证。只需输入与您用于存储库（或镜像，如果使用一个）相同的 ID 的服务器条目，仅此而已。

# javascript - 如何使用javascript setTimout？

> ID：846964
> 
> 赞同：1
> 
> 时间：2009-05-11T06:39:41.530
> 
> 标签：javascript

我有一小段想要使用的 javascript，但在激活之前需要延迟。

```
function sglClick(url) {
    window.setTimeout('location.href="http://'"+url",1500);
} 
```

这不起作用，我真的被困在这里。

* * *

这是我现在拥有的

```
function send(){

}

function sglClick(url) {
//    window.location.href="http://"+url;
    setTimeout(function send() { location.href = "http://" + url; },1500);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T06:42:35.893

试试这个

```
function sglClick(url) {
    setTimeout(function() { location.href = "http://" + url; },1500);
} 
```

这是使用匿名函数来存放您的代码。发射大约需要 1.5 秒。我说大约是因为 JavaScript 是单线程的，而其他函数调用/等实际上可以使间隔在稍微不同的时间触发（但 9/10 这不是问题）

它还假设你正在向函数发送这样的东西

```
sglClick('www.google.com'); 
```

由于您的代码在参数前面加上 http://

我一直将此函数用作简单的 setTimeout()，而不是作为窗口对象的方法。

# delphi - Delphi Array Alignment 设置为 4、8 或 16 字节边界？

> ID：846965
> 
> 赞同：2
> 
> 时间：2009-05-11T06:39:57.363
> 
> 标签：delphi, arrays, alignment

我想使用 Delphi 2009 中的 FFTW C 库并根据此文档；

[http://www.fftw.org/install/fftw_usage_from_delphi.txt](http://www.fftw.org/install/fftw_usage_from_delphi.txt)

为了提高 FFTW 库内部的性能（以便它可以使用 SIMD 扩展），传入的 Single（float）或 Double（double）数组需要在 4 或 8 字节边界处对齐。我发现有关记录结构对齐的文档，但没有关于数组的具体内容。有没有办法在 Delphi 2009 中做到这一点。

所以代码（从上面的文档中复制）看起来像这样；

```
var
      in, out : Array of Single; // Array aligned at 4 byte boundary
      plan : Pointer;

    {$APPTYPE CONSOLE}

    begin

      ...  

      SetLength(in, N);
      SetLength(out, N);

      plan := _fftwf_plan_dft_1d(dataLength, @in[0], @out[0],
                                 FFTW_FORWARD, FFTW_ESTIMATE); 
```

同样在上面的文档中，他们谈到了 8 和 16 字节的边界，但在我看来，它应该是 4 和 8 字节的边界，如果有的话可以明确这一点。

谢谢，布鲁斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T07:16:08.320

请注意，您可以使用您可能需要的任何自定义对齐方式创建数据结构。例如，在 128 字节边界上对齐 FFT 数据：

```
procedure TForm1.Button1Click(Sender: TObject);
type
  TFFTData = array[0..63535] of double;
  PFFTData = ^TFFTData;
var
  Buffer: pointer;
  FFTDataPtr: PFFTData;
  i: integer;
const
  Alignment = 128; // needs to be power of 2
begin
  GetMem(Buffer, SizeOf(TFFTData) + Alignment);
  try
    FFTDataPtr := PFFTData((LongWord(Buffer) + Alignment - 1)
                           and not (Alignment - 1));

    // use data...
    for i := Low(TFFTData) to High(TFFTData) do
      FFTDataPtr[i] := i * pi;

  finally
    FreeMem(Buffer);
  end;
end; 
```

**编辑：**

关于分配两次内存的评论：堆栈变量 FFTData 的类型是 PFFTData，而不是 TFFTData，所以它是一个指针。这不是那么明显，因为语法增强允许省略 ^ 以取消引用指针。内存是使用 GetMem() 分配的，并且使用正确的类型而不是使用类型转换的无类型内存块。我可能应该称它为 FFTDataPtr。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T08:11:02.550

Delphi 无法控制它分配的任何内存的对齐方式。[正如 Mghie 演示的那样](https://stackoverflow.com/questions/846965/delphi-array-allignment-set-to-4-8-or-16-byte-boundaries/847044#847044)，您要么依赖于当前安装的内存管理器的记录行为，要么分配具有一些松弛空间的内存，然后自行对齐。

如果您担心 Delphi 的内存管理器没有为动态数组提供所需的对齐方式，那么您可以继续使用 DLL 提供的内存函数。您引用的注释提到`_fftwf_malloc`and `_fftwf_free`，但随后它给出了某种警告，即从`_fftwf_malloc`“可能无法直接从 Delphi 访问”分配的内存。不过，这不是作者的意思，因为这不是 Windows 中内存的工作方式。作者可能的意思是说`_fftwf_malloc`Delphi 无法释放`FreeMem`分配的内存，而 Delphi 分配的内存`GetMem`无法释放`_fftwf_free`。不过，这没什么特别的。您*总是*需要将内存管理功能配对在一起。

如果你`_fftwf_malloc`用来获取你的数组，那么你可以通过一个普通的指针类型来访问它。例如：

```
var
  dataIn, dataOut: PDouble;
begin
  dataIn := _fftwf_malloc(...);
  dataOut := _fftwf_malloc(...);
  _fftwf_plan_dft_1d(dataLength, dataIn, dataOut,
                     FFTW_FORWARD, FFTW_ESTIMATE); 
```

从 Delphi 2009 开始，您甚至可以对这些指针使用数组语法：

```
dataIn[0] := 3.5;
dataIn[2] := 7.3; 
```

为了启用它，请使用`{$POINTERMATH ON}`编译器指令；除字符指针类型外，默认情况下不启用它。

像这样手动分配数组的缺点是您会丢失范围检查。如果索引超出数组的末尾，您将不再获得易于识别的`ERangeError`异常。相反，您将获得损坏的内存、访问冲突或神秘的程序崩溃。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T07:00:13.587

堆块总是通过 FastMM 对齐到 16 字节边界（旧的 D7 内存管理器对齐到 8）。我不知道sharemem，因为我不使用它。

动态数组是基于堆的结构。OTOH dyn 数组可能会变得未对齐（从 16 到 8），因为有一个长度和引用计数前缀。最简单的就是打印

十六进制的 ptruint(@in[0]) 看看结尾是 0 还是 8。 (*)

请注意，FPC 中有 fftw 标头。（packages/fftw），afaik 它最近甚至被修复为 64 位。

我不知道 Delphi 中的堆栈对齐指令。也许它们会自动“自然”对齐。

(*) ptruint 是 FPC 代表 sizeof(pointer) 大的无符号整数类型。32 位上的基数，64 位上的 qword。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-21T14:02:40.047

这是**mghie**[解决方案](https://stackoverflow.com/a/847044/744588)的另一种可能变体：

```
procedure TForm1.Button1Click(Sender: TObject);
type
  TFFTData = array [0..0] of Double;
  PFFTData = ^TFFTData;
var
  AllocatedBuffer: Pointer;
  AlignedArray: PFFTData;
  i: Integer;
const
  cFFTDataSize=63536;
begin

  GetMem(AllocatedBuffer, cFFTDataSize*SizeOf(Double) + 16);  // e.g 16 Bytes boudaries alignement

  try
    AlignedArray := PFFTData((Integer(AllocatedBuffer) and $FFFFFFF0) + 16);

    // use data...

    for i := 0 to cFFTDataSize-1 do
      AlignedArray[i] := i * Pi;
  finally
    FreeMem(AllocatedBuffer);
  end;
end; 
```

我重构了这段代码，使其更有意义，并使用了类似的手动对齐修复技术。

# php - MySql NOT NULL 约束不起作用

> ID：846974
> 
> 赞同：3
> 
> 时间：2009-05-11T06:43:02.430
> 
> 标签：php, mysql, null, constraints, mysqli

我正在尝试在创建为的客户表中实现 NOT NULL 约束：

```
CREATE TABLE CUSTOMER(
     cust_id INT(5) NOT NULL AUTO_INCREMENT, 
     PRIMARY KEY(cust_id),
     first_name VARCHAR(25) NOT NULL,
     last_name VARCHAR(25) NOT NULL,
     email VARCHAR(25) NOT NULL,
     password VARCHAR(25) NOT NULL,
     gender VARCHAR(1) NOT NULL,
     city VARCHAR(25) NOT NULL,
     dob DATE NOT NULL,
     pin INT NOT NULL); 
```

在此之后，我将传递值并将其插入为：

```
$sql= "INSERT INTO customer(first_name,last_name,email,password,gender,city,dob,pin) VALUES('$first_name','$last_name','$email_add','$password','$gender','$city','$DOB','$pin')"; 
```

但是，如果我传递字段的空白值，Mysql 似乎会插入它们？可能是什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T06:46:08.350

我怀疑这是因为，在真正的 DBMS 中，与 Oracle 相比 :-)，空白值和 NULL 值之间存在区别。

空白字符串对`NOT NULL`字段完全有效。您不应该在`NOT NULL`字段中输入的唯一值是，等等，尝试记住，...... NULL。对，就是那样。无效的。:-)

> 旁白：Oracle 在很多个月前做出了一个决定，将空的 VARCHAR 视为 NULL，但它仍然困扰着它们（或者如果我不是唯一一个因为这个问题而拒绝使用它的人，它会）。

如果您希望您的 PHP 代码像 Oracle 一样工作（其中空白变为 NULL），您将不得不预处理字符串，例如（伪代码）：

```
if $first_name == "":
    $first_name = "NULL"
else:
    $first_name = "'" + $first_name + "'"
: : :
$sql= "INSERT INTO customer(" +
    "first_name," +
    "last_name," +
    "emailpassword," +
    "gender," +
    "city," +
    "dob," +
    "pin" +
    ") VALUES (" + 
        $first_name + "," +
        "'$last_name'" + "," +
        "'$email_add'" + "," +
        "'$password'" + "," +
        "'$gender'" +
        ",'$city'" + "," +
        "'$DOB'" + "," +
        "'$pin'" +
    ")"; 
```

对于其他也可以为 NULL 的字段，依此类推。我只展示了如何为`$first_name`.

这将导致`INSERT`语句中的 first_name 列是由单引号括起来`NULL`的值或值。`$first_name`

请记住，应检查和/或修改所有这些字段以防止 SQL 注入攻击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T06:56:49.800

```
$sql= "INSERT INTO customer(first_name,last_name,email,password,gender,city,dob,pin) VALUES('$first_name',".
($last_name?"'".$last_name."'":"NULL").
", '$email_add','$password','$gender','$city','$DOB','$pin')"; 
```

这将是：

```
VALUES('ahm',NULL,'email@a.ddr' ... 
```

并且由于 NOT NULL 不会插入任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T07:00:00.283

此处文档中的一些附加信息：

[http://dev.mysql.com/doc/refman/5.0/en/problems-with-null.html](http://dev.mysql.com/doc/refman/5.0/en/problems-with-null.html)

# iphone-sdk-3.0 - iphone sdk 3.0 中的 MinimumOSVersion 问题

> ID：846975
> 
> 赞同：2
> 
> 时间：2009-05-11T06:43:21.070
> 
> 标签：iphone-sdk-3.0

我已经安装了最新的 iphone sdk 3.0 beta 5，并尝试从这个 sdk 提交第一个应用程序构建，但是当我上传到 iTunes Connect 时，它给我消息“您上传的二进制文件无效。为密钥提供的值MinimumOSVersion 是不可接受的。” 并且无法上传。因此我在项目中编辑我的 info.plist 文件并将这个键设置为 2.2.1，比如

```
 <key>MinimumOSVersion</key>
 <string>2.2.1</string> 
```

再次上传，但它仍然返回相同的消息，有没有人遇到过同样的问题以及如何摆脱这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-21T11:33:22.157

你不应该在你的 Info.plist 中指定 MinimumOSVersion。从[信息属性列表关键参考](http://developer.apple.com/iphone/library/documentation/General/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html#//apple_ref/doc/uid/TP40009250-SW18)：

> MinimumOSVersion（字符串 - iPhone OS、Mac OS X）。当您构建 iPhone 应用程序时，Xcode 将目标操作系统（由 Base SDK 选择确定）记录为 MinimumOSVersion 属性。**不要**在 Info.plist 文件中自己指定这个属性；它是系统编写的属性。当您将应用程序发布到 App Store 时，商店会根据此属性指示您的应用程序可以在其上运行的 iPhone OS 版本。它相当于 Mac OS X 上的 LSMinimumSystemVersion 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-10T17:49:04.197

您需要做的是更改项目中的部署目标设置。部署目标指定您希望应用程序在其上运行的最低操作系统。这与您构建的 SDK 无关，它应该始终是最新的 SDK，以便您可以确保您的应用程序在可用的最新操作系统版本上正确运行。所以，简而言之：

*   将 Base SDK 设置为可用的*最新操作系统*
*   将部署目标设置为您希望应用运行的*最早操作系统。*

手动编辑 Info.plist 文件实际上只是在愚弄 App Store，让他们认为您的应用程序可以在不是为运行而构建的操作系统上运行，这可能会产生不可预测的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T07:44:47.693

请阅读 iPhone 开发者中心的通知。目前你不能使用 iPhone 3.0 SDK 为 App Store 构建应用程序，即使你为 2.x 操作系统编译它们也是如此。您必须使用 2.x SDK 编译应用程序才能将其提交到 App Store。

您可以并排安装两组开发人员工具。当您进入选择要安装软件包的哪些部分的屏幕时，您可以选择安装的替代目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T07:30:34.550

我有同样的问题。以下是如何解决它！

我的项目叫做 SuperTennis，所以我在 xcode 中单击了该项目，然后单击了 Get Info。在常规选项卡下，将“所有 iPhone 配置的基础 SDK”更改为 iPhone OS 2.0，然后进入构建选项卡，将“基础 SDK”更改为“iPhone OS 2.0”，然后为您的设备构建它。在 finder 中显示应用程序，然后继续上传。如果您需要更多帮助，请通过 gmail.com 的 ryan2925 给我发电子邮件。我希望这对您和其他阅读者有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-06T20:17:12.387

当我最终将东西从 2.2.1 升级到 4.0 SDK 并尝试使用现有项目时，我收到了这个错误。

我不得不：

1.  单击 XCode 中的项目，然后单击 Info。
2.  点击“构建”
3.  注意您正在设置的“配置”。您在尝试调试时是否不小心设置了分发？
4.  将“Base SDK”设置为尽可能高的值。
5.  将“目标设备系列”更改为您正在执行的操作。
6.  将“iPhone OS 部署目标”设置为您设备的操作系统（您可以通过转到 Window > Organizer 进行检查）。

我的主要时间接收器是在尝试调试但没有意识到时设置我的分发设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-17T06:41:57.047

尝试这个：

```
ARMV6: before iPhone 3GS
ARMV7: including and after iPhone 3GS

"Proj." and "Target(s)" right-click, Get Info. Select:-

Base SDK: iPhone 4.0 (latest s greatest)
Standard: ARMV6, ARMV7
Uncheck build for Active Architecture 
Deployment Target: 4.0 (not older ones 3.1.3; you don't have the SDK if you upgrade to 4.0)
Compiler section: Ensure that both ARMV6 and ARMV7 checkboxes are ticked under Generate Code, Thumb section. 
```

二进制输出稍大一些，因为它是支持两种架构的通用代码。

如果您只想支持 ARMV7，请不要在编译器部分检查 ARMV6，选择针对 ARMV7 优化的代码，仅检查活动架构。在中`info.plist`，添加项目。该字段已经存在并且可能具有自动指定的其他系统要求。`armv7``UIRequiredDeviceCapabilities``info.plist`

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-11T06:46:14.747

右键单击您的项目并转到您的构建选项卡。您可以在列表顶部附近指定您的 Base SDK。这是您将编译的最低要求。在此之后，您的构建设置下拉菜单将包含旧版本。当您进行分发时，请确保您没有使用 3.0，因为这会导致您的二进制文件被拒绝（正如您所发现的那样）。

# c# - 如何将 .NET exe 转换为本机 Win32 exe？

> ID：846978
> 
> 赞同：4
> 
> 时间：2009-05-11T06:44:25.093
> 
> 标签：c#, winapi

如何将 .NET exe 转换为 Win32 exe？（我没有代码）目的是使用wine在Linux中运行应用程序。我认为 .NET exe 不能在 wine 中运行，我不想使用单声道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:50:00.653

根据它是什么版本的 .NET 以及它使用的库，您可以尝试在 Mono 下运行它，而无需将 IL 编译为本机代码。

大多数 Linux 发行版都在其包管理系统下提供它。

请参阅：[http](http://www.mono-project.com/Main_Page) ://www.mono-project.com/Main_Page了解更多详情

另一种方法是使用 NGen 进行编译（[http://blogs.msdn.com/clrcodegeneration/archive/2007/09/15/to-ngen-or-not-to-ngen.aspx](http://blogs.msdn.com/clrcodegeneration/archive/2007/09/15/to-ngen-or-not-to-ngen.aspx)）。但我不确定这会在 WINE 下工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T07:02:04.660

根据您的框架版本，它可能适用于 Wine 中的 Wine [.Net Framework 兼容性](http://appdb.winehq.org/objectManager.php?sClass=application&iId=2586)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T07:15:06.930

这对您来说可能是一个困难的解决方案，但为了完整起见，我在这里提到它。

您可以使用 VMWare 的 Thinapp 包装一个 .net 应用程序。我相信这会产生一个 win32 可执行文件。

[https://www.vmware.com/products/thinapp](https://www.vmware.com/products/thinapp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T06:49:47.970

也许它会在单声道下运行？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-30T09:46:35.627

使用带有静态库的提前编译器。**单声道上的又名 mkbundle**

Mono 带有一个用于单声道 JIT 编译器的命令行界面来编译 AOT（提前）。您可以使用它来创建一个静态链接的 .o，然后您可以使用一个简单的包装器运行它，该包装器使用目标文件调用单运行时嵌入器。如果您随后静态链接到单声道库，您将不会对已安装的 .NET 框架有任何外部依赖项。

当然，您将不得不运送所有静态链接的库或最终得到一个huge exe，但是嘿，这就是您所要求的

```
mono --aot=static

          static Create  an  ELF  object file (.o) which can be statically linked into an executable when embedding the mono runtime. When this option is used, the object
                 file needs to be registered with the embedded runtime using the mono_aot_register_module function which takes as its argument the mono_aot_module_<ASSEM‐
                 BLY NAME>_info global symbol from the object file:

                 extern void *mono_aot_module_hello_info;

                 mono_aot_register_module (mono_aot_module_hello_info); 
```

虽然我在 linux 上使用它，但我不完全确定它在 windows 上同样适用。

**更新**记住了**mkbundle**工具：

```
sehe@sehelap:~$ mkbundle --static test.exe -o hello
OS is: Linux
Note that statically linking the LGPL Mono runtime has more licensing restrictions than dynamically linking.
See http://www.mono-project.com/Licensing for details on licensing.
Sources: 1 Auto-dependencies: False
   embedding: /home/sehe/test.exe
Compiling:
as -o temp.o temp.s 
cc -o hello -Wall `pkg-config --cflags mono` temp.c  `pkg-config --libs-only-L mono` -Wl,-Bstatic -lmono -Wl,-Bdynamic `pkg-config --libs-only-l mono | sed -e "s/\-lmono //"` temp.o
Done
sehe@sehelap:~$ ./hello 
hello world

sehe@sehelap:~$ ldd hello 
linux-gate.so.1 =>  (0xb7875000)
libdl.so.2 => /lib/libdl.so.2 (0xb785f000)
libpthread.so.0 => /lib/libpthread.so.0 (0xb7845000)
libm.so.6 => /lib/libm.so.6 (0xb781e000)
libgthread-2.0.so.0 => /usr/lib/libgthread-2.0.so.0 (0xb7819000)
librt.so.1 => /lib/librt.so.1 (0xb7810000)
libglib-2.0.so.0 => /lib/libglib-2.0.so.0 (0xb7741000)
libc.so.6 => /lib/libc.so.6 (0xb75e4000)
/lib/ld-linux.so.2 (0xb7876000)
libpcre.so.3 => /lib/libpcre.so.3 (0xb75af000) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T06:49:33.883

根本不可能。对于托管代码，您需要某种 VM 来运行。在 Linux 中，您可以使用 Mono 或 dotgnuportable.net。也许某些超高级版本的 wine 将能够运行 MS .net 框架？

# c# - C# OO 设计问题

> ID：846979
> 
> 赞同：3
> 
> 时间：2009-05-11T06:44:37.060
> 
> 标签：c#, oop

我有一个用 C# 编写的 Windows 窗体应用程序。main_form 类实例化了一个名为 AccessProcessWorker 的 AccessProcess，它是一个继承自 BackgroundWorker 的类，然后 main_form 使用以下代码初始化 Process

```
 AccessProcessWorker.DoWork += new DoWorkEventHandler(processWorker.worker_DoWork);
        AccessProcessWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(processWorkerCompleted);
        AccessProcessWorker.ProgressChanged += new ProgressChangedEventHandler(processProgressChanged); 
```

此应用程序刚刚从 POC 变为“使其快速运行”。

我编写了这个应用程序来处理 Access 数据库，但现在想让它对抗 MS Sql，但也留下了对抗访问的选项。所以，我可以做一些丑陋的事情，比如根据用户做出的一些 UI 选择来实例化和初始化 SqlProcessWorker 或 AccessProcessWorker。但我想做的是让 main_form 总是创建类似 IProcess 的东西，这样我就不必每次有新的 ProcessWorker 时都向 main_form 添加逻辑。我的设计中的问题是，当我按照我描述的方式进行操作时，初始化会中断。

如果有人有任何想法或需要进一步澄清，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-11T06:54:27.807

您要查找的内容称为“依赖注入”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T06:51:46.110

在某些时候，您需要实例化正确的类型，但[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)通常是转到此处。现在，如果您只有两种类型中的一种来“新建”以获取您的 IProcess 对象，那么这可能有点多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T07:01:07.610

为了保持简单，我实际上只是采用“丑陋”的方法。

您提到了 Access 和 SQL Server 作为当前的两个数据库，但是您实际上认为您的应用程序需要支持多少？以我的经验，应用程序的数据库平台很少更改，而且并非没有经过认真考虑。

如果有大量的数据库平台需要支持，而您无法提前预测，那么解耦设计可能会很有用。否则亲吻。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-11T07:21:27.123

如果两个数据库的布局和结构相同，您可以只使用[EntitySpaces](http://www.entityspaces.net)并更改应用程序的默认连接。也就是说，当涉及到数据访问时，您有一个代码库，然后您只需根据您想要访问数据库还是 SQL 数据库来设置当前连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-11T07:31:00.040

我会将“丑陋”的代码包装在一个单独的方法中，或者最好是一个类，该类负责选择要与哪个 DB 通信以及与实际的 BackgroundWorker 实例同步。这里重要的一点是要坚持 DRY 原则：不要重复自己。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T10:48:40.547

我认为对于一个工作项目，你应该尽可能快地完成它，而不考虑未来的数据库，因为它可能不会发生。

你确定在某个地方没有一个已经可以同时使用 Sql Server 和 MS Access 的类吗？例如，`OleDbConnection`, `OleDbCommand`? 对于简单的 SQL，您只需要更改连接字符串，就可以使用这两个数据库。

如果您还没有编写应用程序的其余部分，您应该花一两天时间寻找一些框架，比较并选择您喜欢的一个。它会让您编写更少的代码，并且在未来的应用程序中，您将省去大部分数据库管道代码。我保证投入的时间将成倍地返还给您（如果您偶尔使用数据库，那就是）。

# vb.net - VB.NET 中的条件 Linq 查询

> ID：846987
> 
> 赞同：1
> 
> 时间：2009-05-11T06:49:00.610
> 
> 标签：vb.net, linq

[我正在尝试做与此处](https://stackoverflow.com/questions/11194/conditional-linq-queries)描述的完全相同的事情，但在 VB.NET 中

我尝试了所有的 C# 到 VB 转换器，但似乎没有人可以使用 LINQ。我对 C# 完全陌生，所以任何帮助将不胜感激！

`public static IQueryable<Type> HasID(this IQueryable<Type> query, long? id) { return id.HasValue ? query.Where(o => i.ID.Equals(id.Value)) : query; }`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T06:58:47.723

尝试这个：

```
Public Module MyModule
    <Runtime.CompilerServices.Extension()> _
    Public Function HasID(ByVal query As IQueryable(Of Type), ByVal id As Long?) As IQueryable(Of Type)
        Return If(id.HasValue, query.Where(Function(o) o.ID.Equals(id.Value)), query)
    End Function
End Module 
```

在 VB.NET 中，您应该创建一个模块来创建扩展方法。还要放置 Runtime.CompilerServices.Extension 属性并从函数定义中删除 static 和 this 。

PS讨厌VB：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T07:38:19.950

你试过哪个转换器？你应该试试[Telerik Converter](http://converter.telerik.com/)。我已将您的代码复制到他们的转换器中并得到了这个：

```
<System.Runtime.CompilerServices.Extension> _
Public Shared Function HasID(query As IQueryable(Of Type), id As System.Nullable(Of Long)) As IQueryable(Of Type)
    Return If(id.HasValue, query.Where(Function(o As ) i.ID.Equals(id.Value)), query)
End Function

'=======================================================
'Service provided by Telerik (www.telerik.com)
'Conversion powered by NRefactory.
'Built and maintained by Todd Anglin and Telerik
'======================================================= 
```

# c# - 如何使用 HTML 敏捷包

> ID：846994
> 
> 赞同：647
> 
> 时间：2009-05-11T06:50:11.247
> 
> 标签：c#, html, html-agility-pack

如何使用[HTML 敏捷包](http://html-agility-pack.net/?z=codeplex)？

我的 XHTML 文档不完全有效。这就是我想使用它的原因。我如何在我的项目中使用它？我的项目在 C# 中。

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2009-05-11T07:19:42.760

首先，将[HTMLAgilityPack](https://www.nuget.org/packages/HtmlAgilityPack/) nuget 包安装到您的项目中。

然后，作为一个例子：

```
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();

// There are various options, set as needed
htmlDoc.OptionFixNestedTags=true;

// filePath is a path to a file containing the html
htmlDoc.Load(filePath);

// Use:  htmlDoc.LoadHtml(xmlString);  to load from a string (was htmlDoc.LoadXML(xmlString)

// ParseErrors is an ArrayList containing any errors from the Load statement
if (htmlDoc.ParseErrors != null && htmlDoc.ParseErrors.Count() > 0)
{
    // Handle any parse errors as required

}
else
{

    if (htmlDoc.DocumentNode != null)
    {
        HtmlAgilityPack.HtmlNode bodyNode = htmlDoc.DocumentNode.SelectSingleNode("//body");

        if (bodyNode != null)
        {
            // Do something with bodyNode
        }
    }
} 
```

（注意：此代码只是一个示例，不一定是最佳/唯一方法。不要在您自己的应用程序中盲目使用它。）

该`HtmlDocument.Load()`方法还接受一个流，该流在与 .NET 框架中的其他面向流的类集成时非常有用。While`HtmlEntity.DeEntitize()`是另一种正确处理 html 实体的有用方法。（感谢马修）

`HtmlDocument`并且`HtmlNode` 是您最常使用的类。与 XML 解析器类似，它提供了接受 XPath 表达式的 selectSingleNode 和 selectNodes 方法。

注意`HtmlDocument.Option??????` 布尔属性。这些控制`Load`和`LoadXML`方法将如何处理您的 HTML/XHTML。

还有一个名为 HtmlAgilityPack.chm 的已编译帮助文件，其中包含每个对象的完整参考。这通常位于解决方案的基本文件夹中。

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2010-04-06T22:59:46.343

我不知道这是否对您有任何帮助，但我已经写了几篇介绍基础知识的文章。

*   *[HtmlAgilityPack 文章系列](http://runtingsproper.blogspot.com/2009/09/htmlagilitypack-article-series.html)*
*   *[HtmlAgilityPack 库简介](http://runtingsproper.blogspot.com/2009/09/introduction-to-htmlagilitypack-library.html)*
*   *[使用 HtmlAgilityPack 从 html 片段中轻松提取链接](http://runtingsproper.blogspot.com/2009/11/easily-extracting-links-from-snippet-of.html)*

下一篇文章已完成 95%，我只需要对我编写的代码的最后几部分进行解释即可。如果您有兴趣，那么我会尽量记住在发布时在这里发布。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2013-07-08T16:17:56.550

HtmlAgilityPack 使用 XPath 语法，尽管许多人认为它的文档记录很差，但我在此 XPath 文档的帮助下使用它没有任何问题：[https ://www.w3schools.com/xml/xpath_syntax.asp](https://www.w3schools.com/xml/xpath_syntax.asp)

解析

```
<h2>
  <a href="">Jack</a>
</h2>
<ul>
  <li class="tel">
    <a href="">81 75 53 60</a>
  </li>
</ul>
<h2>
  <a href="">Roy</a>
</h2>
<ul>
  <li class="tel">
    <a href="">44 52 16 87</a>
  </li>
</ul> 
```

我这样做了：

```
string url = "http://website.com";
var Webget = new HtmlWeb();
var doc = Webget.Load(url);
foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//h2//a"))
{
  names.Add(node.ChildNodes[0].InnerHtml);
}
foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//li[@class='tel']//a"))
{
  phones.Add(node.ChildNodes[0].InnerHtml);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-08-02T07:00:04.850

主要HTMLAgilityPack相关代码如下

```
using System;
using System.Net;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using System.Text.RegularExpressions;
using HtmlAgilityPack;

namespace GetMetaData
{
    /// <summary>
    /// Summary description for MetaDataWebService
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line.
    [System.Web.Script.Services.ScriptService]
    public class MetaDataWebService: System.Web.Services.WebService
    {
        [WebMethod]
        [ScriptMethod(UseHttpGet = false)]
        public MetaData GetMetaData(string url)
        {
            MetaData objMetaData = new MetaData();

            //Get Title
            WebClient client = new WebClient();
            string sourceUrl = client.DownloadString(url);

            objMetaData.PageTitle = Regex.Match(sourceUrl, @
            "\<title\b[^>]*\>\s*(?<Title>[\s\S]*?)\</title\>", RegexOptions.IgnoreCase).Groups["Title"].Value;

            //Method to get Meta Tags
            objMetaData.MetaDescription = GetMetaDescription(url);
            return objMetaData;
        }

        private string GetMetaDescription(string url)
        {
            string description = string.Empty;

            //Get Meta Tags
            var webGet = new HtmlWeb();
            var document = webGet.Load(url);
            var metaTags = document.DocumentNode.SelectNodes("//meta");

            if (metaTags != null)
            {
                foreach(var tag in metaTags)
                {
                    if (tag.Attributes["name"] != null && tag.Attributes["content"] != null && tag.Attributes["name"].Value.ToLower() == "description")
                    {
                        description = tag.Attributes["content"].Value;
                    }
                }
            } 
            else
            {
                description = string.Empty;
            }
            return description;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-12-06T11:33:39.690

```
 public string HtmlAgi(string url, string key)
    {

        var Webget = new HtmlWeb();
        var doc = Webget.Load(url);
        HtmlNode ourNode = doc.DocumentNode.SelectSingleNode(string.Format("//meta[@name='{0}']", key));

        if (ourNode != null)
        {

                return ourNode.GetAttributeValue("content", "");

        }
        else
        {
            return "not fount";
        }

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-24T14:21:07.917

入门 - HTML 敏捷包

```
// From File
var doc = new HtmlDocument();
doc.Load(filePath);

// From String
var doc = new HtmlDocument();
doc.LoadHtml(html);

// From Web
var url = "http://html-agility-pack.net/";
var web = new HtmlWeb();
var doc = web.Load(url); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-29T10:11:16.097

尝试这个

```
string htmlBody = ParseHmlBody(dtViewDetails.Rows[0]["Body"].ToString());

private string ParseHmlBody(string html)
        {
            string body = string.Empty;
            try
            {
                var htmlDoc = new HtmlDocument();
                htmlDoc.LoadHtml(html);
                var htmlBody = htmlDoc.DocumentNode.SelectSingleNode("//body");
                body = htmlBody.OuterHtml;
            }
            catch (Exception ex)
            {

                dalPendingOrders.LogMessage("Error in ParseHmlBody" + ex.Message);
            }
            return body;
        } 
```****``********