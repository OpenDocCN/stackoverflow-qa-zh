# StackOverflow 问答 000689000-000689999

# visual-studio - 能否在 VS2008“添加新项目”对话框中添加自定义 T4 模板？

> ID：689002
> 
> 赞同：2
> 
> 时间：2009-03-27T09:03:16.777
> 
> 标签：visual-studio, visual-studio-2008, t4

我创建了一组要在多个项目中共享的模板。是否可以将模板添加到项目“添加新项目”对话框中，以便当我选择它时，会从模板生成代码文件的实例并添加到项目中？

### 更新

感谢您的建议普雷特。这回答了这个问题，但我想我问错了。再想一想，我现在希望能够自动处理 T4 模板并将参数从用户输入传递给它们。

我现在从一个新的角度来看待这个问题。专门尝试使用`Microsoft.VisualStudio.TextTemplating.Engine`类和 GAX 自己从模板生成代码文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T09:09:36.247

看不出为什么 - 你只是创建一个项目模板。有关更多详细信息，请参见[此处](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2F6db0hwky(VS.80).aspx&ei=dZfMSaraDYmGsQOz_ZWwCg&usg=AFQjCNELGM7uocuw323fxmejmFNroMwNgA&sig2=iC4obPrlGwOJdq72koZTNQ)和[此处](http://www.google.com/url?sa=t&source=web&ct=res&cd=6&url=http%3A%2F%2Fvisualstudiomagazine.com%2Fcolumns%2Farticle.aspx%3Feditorialsid%3D2761&ei=dZfMSaraDYmGsQOz_ZWwCg&usg=AFQjCNEJ1zV4zIeeBFnWf1jUuYAljfT5zw&sig2=UKs_iEFlpV1ilXNjd9gN2w)

# eclipse - 在 Eclipse 中搜索 JavaDoc

> ID：689007
> 
> 赞同：10
> 
> 时间：2009-03-27T09:04:57.163
> 
> 标签：eclipse, search, javadoc

有没有办法只搜索 javadoc 注释（通过 Eclipse）？我只想在 javadoc 注释中查找文本...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T11:39:07.027

我能想到的唯一方法是对所有*.java文件使用***Eclipse 文件搜索对话框**，并使用这个正则表达式作为输入：

 *```
"(?s:/\*\*([^\*]|\*[^/])*?###INPUT###.*?\*/)" 
```

并将###INPUT### 替换为您要搜索的内容。

请参阅有关此正则表达式的[其他问题](https://stackoverflow.com/questions/689354/regex-for-matching-javadoc-fragments)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T10:58:40.493

如果 javadoc 位于工作区中的源文件中，则可以使用“文件搜索”。

# ruby-on-rails - 根据用户权限查找论坛

> ID：689024
> 
> 赞同：2
> 
> 时间：2009-03-27T09:12:15.100
> 
> 标签：ruby-on-rails, ruby

我正在实现一个名为 rBoard 的论坛系统。代码可在[http://github.com/radar/rboard](http://github.com/radar/rboard)查看。我一直在尝试实施的权限代码陷入僵局，我决定求助于无所不知、永远关心的 Stack Overflow 来解决这个问题。

因此，相关信息是：

**类别型号**

```
class Category < ActiveRecord::Base
  has_many :permissions
  has_many :groups, :through => :permissions
  has_many :forums
end 
```

**论坛模式**

```
class Forum < ActiveRecord::Base
  has_many :permissions
  has_many :groups, :through => :permissions
  belongs_to :category
end 
```

**集团模式**

```
class Group < ActiveRecord::Base
  has_many :group_users
  has_many :users, :through => :group_users
  belongs_to :owner, :class_name => "User"
end 
```

**权限模型**

```
class Permission < ActiveRecord::Base
  belongs_to :forum
  belongs_to :category
  belongs_to :group
end 
```

**用户模型**

```
class User < ActiveRecord::Base
  include Rboard::Permissions
  has_many :group_users
  # Note: I am using nested_has_many_through
  has_many :groups, :through => :group_users
  has_many :permissions, :through => :groups
end 
```

**权限模块**

```
module Rboard::Permissions
  THINGS = ['forum', 'category']

  def self.included(klass)

    klass.class_eval do
      # Here we can pass an object to check if the user or any the user's groups
      # has permissions on that particular option.
      def overall_permissions(thing = nil)
        conditions = if thing.nil?
          THINGS.map do |t| 
            "permissions.#{t}_id " + (thing.nil? ? " IS NULL" : "= #{thing.id}") + " OR permissions.#{t}_id IS NULL"     
          end.join(" AND ")
        else
          association = thing.class.to_s.downcase
          "permissions.#{association}_id = #{thing.id} OR permissions.#{association}_id IS NULL"
        end

        permissions.all(:conditions => conditions)
      end

      def can?(action, thing = nil)
        permissions = overall_permissions(thing)
        !!permissions.detect { |p| p.send("can_#{action}") }
      end
    end
  end
end 
```

希望有了这个，您应该能够找出权限表中的字段，`can_see_forum`等等。额外字段为`forum_id`,`category_id`和`default`（默认当前未使用）

我想知道的是，我怎样才能找到一个组可以看到的所有论坛？通常，如果设置了 forum_id，则该权限适用。如果该组只有一个权限而没有指定 forum_id 或 category_id，那么它被视为对所有事物都是全局的。我在这里完全不知所措。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T01:39:11.093

看起来您需要（虚构的）acts_as_permissible 之类的东西。一些可以应用于不同类型对象的 mixin——在这种情况下是组和用户——允许您测试授权。一个可能的用法可能是：

```
 class Group
  include Acts::Permissible
  acts_as_permissible
end

module Acts
  module Permissible
    def self.acts_as_permissible
      begin
        Role.find(:all).each do |role|
          define_method "can_#{role.access_type}?" do
            self.send('has_role?', role.access_type)
          end
        end
      # Since we're possibly running within the scope of Rake, handle the case   
      # where the roles table doesn't exist  
      rescue ActiveRecord::StatementInvalid => e        
        RAILS_DEFAULT_LOGGER.error "Statement invalid while adding Role methods to User. Is the Roles table present in the DB?\n" + e.inspect
      end
    end
  end
end 
```

警告：这是*航空代码*！从未测试过。但是您可以将这样的内容混合到您的用户中，并针对与您的组模型相同的角色进行授权。

# msbuild - 在巡航控制.net 构建服务器中运行 MStest

> ID：689025
> 
> 赞同：6
> 
> 时间：2009-03-27T09:12:25.973
> 
> 标签：msbuild, cruisecontrol.net, mstest

我正在尝试设置 Cruisecontrol.net 来处理我们现有的项目。

这些项目使用 Visual Studio 2008 测试工具（运行为 .net 2.0）。

在实际的构建过程中，我收到了几条错误消息，大多数是：

未定义类型“TestClass”。

我假设这是因为我的构建服务器上没有安装测试框架。

我宁愿不只是从我的开发机器上复制位（这总是感觉有点老套），我也宁愿不在构建服务器上安装 Visual Studio（这似乎有点矫枉过正）。

有谁知道我在哪里可以得到一个独立的安装程序来将这些文件放在我的构建服务器上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-02-06T11:30:13.900

[您可以在“ Visual Studio Agents](http://www.microsoft.com/download/en/details.aspx?id=1334) ”标题下的可再发行磁盘映像上获取 MSTest.exe 和相关库。

指示：

1.  从磁盘下载并运行安装程序
2.  运行测试代理安装程序
3.  无需将代理安装为服务或配置测试代理，因为您只想从命令行运行它。
4.  MSTest 工具现在将安装在“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE”之类的位置，该路径与 Visual Studio 的路径相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T11:09:47.190

MSTest 需要 Visual Studio。您需要将它安装在您的构建机器上（或使用更轻量级的测试框架！）

# delphi - 在 Delphi 中使用嵌入式 DB 进行全文搜索

> ID：689026
> 
> 赞同：10
> 
> 时间：2009-03-27T09:13:43.710
> 
> 标签：delphi, twitter, full-text-search, embedded-database

我们正在创建一个开源**[Twitter 客户端](http://www.delphi.org/2009/03/24-delphi-projects/)**，并正在寻找一个*占用空间最小的嵌入式数据库，该数据库可以*与 Delphi 一起使用，并且非常适合*全文搜索*（我知道占用空间不大）。理想情况下，它也应该是免费或开源的（我知道要求很高）。

我倾向于[SQLite](http://www.sqlite.org/)，但我以前没有使用过它，不知道它是否支持全文搜索，或者它与 Delphi 的工作情况如何。我以前使用过[DBISAM](http://www.elevatesoft.com/prodinfo?action=view&product=dbisam&no=1)，它嵌入了全文搜索，但不是免费的。 [Firebird](http://www.firebirdsql.org/)是我们考虑的另一个选择。

可能有一种组合可以使这项工作。您会使用什么，以及它对 1) 占用空间、2) 全文搜索、3) 免费/开源的评价如何。

**更新：**感谢大家的建议。这么多不错的选择可供选择。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T14:49:02.670

我使用[DiSQLite](http://www.yunqa.de/delphi/doku.php/products/sqlite3/index?DokuWiki=b4kld4f0qh4t2is12gtcn07a91)取得了很大的成功。它具有 FTS 支持和大量其他功能。他们有免费版和专业版。我相信免费版也可以进行 FTS。我已经为 Delphi 尝试了许多 SQLite 实现，这是我见过的最好的。它直接编译到您的应用程序中，因此没有外部 DLL。

我在 Delphi 中查看了很多用于嵌入式数据库的免费库，其中许多不再受支持，从未发布，或者仅在 Delphi5 中工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T18:22:45.517

Sybase [Advantage Database Server](http://www.advantagedatabase.com)具有免版税的本地服务器引擎（多线程和记录级锁定）、出色的 Delphi TDataSet 后代组件（包括源代码）和出色的全文搜索引擎。

Advantage 全文搜索支持 AND、OR、NOT 和 NEAR 运算符。Advantage 还提供 SCORE 和 SCOREDISTINCT 标量函数，它们返回搜索条件中所有单词实例的总数。

Advantage 全文索引在记录更新时维护，这意味着它们不需要任何重建。索引采用压缩格式；因此实际的索引大小可以比物理数据小得多。可以对非索引数据执行全文搜索，但这需要对记录数据进行物理搜索，并且速度可能会慢得多。索引搜索使用位图过滤器以获得最佳性能。

在线帮助包含索引选项等所有详细信息：

[http://tinyurl.com/ctjoqg](http://tinyurl.com/ctjoqg)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T10:14:03.300

我知道firebird有用于全文搜索的[狮身人面像](http://www.firebirdsql.org/index.php?op=files&id=sphinx)插件（尽管根据那里的网站，它'远离真正的“全文搜索”'），它是免费/开源的，但我找不到任何信息来说明它是否适用firebird 的嵌入式版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T11:36:05.287

对于 Firebird 全文搜索，请查看：[http ://www.firebirdfaq.org/faq328/](http://www.firebirdfaq.org/faq328/)

莱昂纳多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T10:11:44.023

我们已经使用 Hydra 将 DotLucene 集成到了我们内部的一个基于 Delphi 的应用程序中（当时，Mike 做了这方面的工作）；如果这是我们想在这里追求的选择，我相信我们可以提取它并使其可用于该项目

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-27T16:43:35.047

继续使用**SQLite**。Delphi 有很多免费的 sqlite 组件。其中一些已不再是活跃的项目。但值得注意的一个组件是[ZeosDB](http://sourceforge.net/projects/zeoslib)。ZeosDB 得到积极维护，它的 sqlite 支持也很完美。如果您需要其他数据库引擎支持，ZeosDB 又是您的选择（它支持 MySQL、PostgreSQL、Interbase、Firebird、MS SQL、Sybase、Oracle 和 SQLite）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-28T04:31:31.150

NexusDB 有一个[免费的嵌入式版本](http://www.nexusdb.com/support/index.php?q=node/539)，当然它是一个原生的 Delphi 产品。

这是它的[全文搜索实现](http://www.nexusdb.com/support/index.php?q=fulltext-implementation)的描述。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-27T16:09:39.763

我建议应该强烈考虑 DBISAM，或者现在可能是他们更新的 ElevateDB。根据您以前的经验，我希望您知道它不会给您的可执行文件增加太多大小，是相当快速、可靠、完美的基于 Delphi 的解决方案，并且具有出色的支持。多年来，他们的 SQL 方言已经改进，因此现在非常好，高度符合 ANSI SQL-2003。

DBISAM/ElevateDB 不是开源的，但许可成本仅针对每个开发人员（而不是每个部署），因此如果只涉及少数开发人员，则成本（在我看来）可以忽略不计。考虑到您在 DBISAM/Elevatesoft 新闻组上获得的支持和响应水平，许可成本尤其合理，主要开发人员/所有者 (Tim Young) 积极参与回答问题和解决问题。除了专有解决方案的成本之外，当然还有对业务是否能够生存以及产品是否会在未来继续开发和支持的担忧。这是你必须自己权衡的事情，但发展似乎一如既往地强大。他们为他们的数据库提供了 .NET 提供程序，并支持使用 FreePascal/Lazarus 进行跨平台开发。

DBISAM 全文搜索的一个优点是它紧密集成到 SQL 中。也就是说，您可以发出一条 SELECT 语句，直接将某些字段的普通 WHERE 条件与其他字段的全文搜索条件结合起来。根据您的需要，这是一个很好的功能，它可以让使用不同的全文解决方案完成一些需要更多工作的事情变得非常简单和快速。我认为大多数附加解决方案，如 Lucene 和其他可能与 Firebird 一起使用的解决方案，并没有与常规 SQL 紧密集成，并且限制您仅检索具有全文标准的一组记录。类似于 Textolution 的 Firebird 专有插件（[http://www.textolution.com/ftsib_example.asp](http://www.textolution.com/ftsib_example.asp)) 看起来它可以容纳构建将应用常规和全文标准的单个复杂（嵌套）查询，但 DBISAM 做得更优雅。无论如何，向开源数据库添加专有插件有点违背了开源的目的。

我认为 DBISAM/ElevateDB 全文搜索的一个缺点是仅支持使用“AND”和“OR”条件，没有任何邻近搜索。

我注意到 SQLite 有一个全文解决方案，[http:](http://www.sqlite.org/cvstrac/wiki?p=FullTextIndex) //www.sqlite.org/cvstrac/wiki?p=FullTextIndex 。我从未使用过 SQLite，但我知道很多人都喜欢它。我很确定 DBISAM/Elevatesoft 具有很大优势的一个领域是在需要强大的锁定功能的多用户应用程序中，尽管这对于单用户桌面应用程序来说并不一定有任何分量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T19:42:37.527

我会使用[Aducom](http://www.aducom.com) Sqlite 组件来使用 Sqlite，它们比 DiSQLite 更容易使用 sqlite，免费并且作为 TDataset 组件工作，我会投票支持 sqlite，因为：

1.  它是非常快速和紧凑的数据库。
2.  占用空间非常小，只有 200kb 左右的 Dll。
3.  与 Aducom 组件一起使用时可以静态链接，因此无需分发 dll。
4.  它内置了对全文搜索的支持。
5.  它在许多免费和商业应用程序中作为外部存储广泛使用和使用。
6.  它具有大部分标准 SQL，因此将使用您的大部分 sql 知识。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-28T19:52:57.160

Sqlite 几乎只是单用户/单连接。执行更新会锁定整个数据库。您可以通过设置等待其他连接的超时值来处理此问题（默认为无超时）。多用户访问可能会变得非常缓慢和/或频繁超时，具体取决于您使用的值。

我使用了来自[http://www.aducom.com/](http://www.aducom.com/)的 Asqlite 组件。免费和开源。目前不支持 d2009 的外观，但它正在开发中。还有许多其他组件集，但我没有使用任何其他组件。

[您可以使用 Rubicon（现在在http://www.href.com/rubicon](http://www.href.com/rubicon)的新管理下）将全文搜索添加到任何 delphi 应用程序。然而，这不是免费的:(

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-27T10:04:40.123

为什么需要全文搜索呢？我不使用 Twitter，但我相信 Twitter 消息最多 140 个字符？这些将适合一个 varchar 字段。您无需全文搜索即可在此类字段中查找内容。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-27T10:07:09.540

还有 DotLucene，它确实需要安装 .NET 框架，但可以通过 .net com api 轻松加载。它是搜索的理想选择，并且具有大多数搜索引擎通用的查询格式。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-18T18:16:50.467

我在这里有一个半工作的 Delphi 解决方案：[http://sourceforge.net/projects/mutis/](http://sourceforge.net/projects/mutis/)，一个到 Lucene 的 Delphi 的端口。

它的大部分工作正常，但不幸的是基于死亡的 Delphi.NET 实现，因此需要更新到本地的工作（是的，采用 .NET 路线是一个大错误:(）

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-03-29T05:20:44.673

一路DBISAM。工作，非常扎实，嵌入式，全文索引效果很好（丰富的个人经验！）

ElevateDB 可能也很棒，但我没有直接的经验。

# mysql - 如何使用 VB.NET 将图像存储在 MySQL 数据库中？

> ID：689027
> 
> 赞同：0
> 
> 时间：2009-03-27T09:14:04.440
> 
> 标签：mysql, vb.net

如何使用 VB.NET 将图像存储在 MySQL 数据库中？您能否展示一些使用该`INSERT`命令的示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:17:41.887

根据您保存的图像数据的大小，您需要使用 BLOB 的一种风格：

我认为它们的最大尺寸是：

BLOB - 最大 64KB

中 BLOB - 最大 16 MB

大块 - 最大 4 GB

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:20:05.660

使用 BLOB 类型。

[http://forums.mysql.com/read.php?38,6172,15703](http://forums.mysql.com/read.php?38,6172,15703)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T12:37:41.787

您可以尝试 AccessImagine ( [http://access.bukrek.net](http://access.bukrek.net) )，您需要做的就是将其绑定到 Properties Inspector 中的某个 BLOB 字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T09:21:40.633

我相信在数据库中存储类似图像的最佳方式是使用 BLOB 字段（二进制大对象），它基本上只是一大块数据。

希望这是一些帮助。

# asp.net - WCF 在 IIS 下运行？

> ID：689029
> 
> 赞同：2
> 
> 时间：2009-03-27T09:14:35.813
> 
> 标签：asp.net, wcf, iis-6

我们有一个包含 ASP.Net（表单）UI 和一些 WCF Web 服务的 Web 项目。这是托管在 IIS 6 中的。UI 和 WCF 服务都使用需要许可证的 PDF 生成工具，该工具存储在`<appSettings>`web.config 文件的部分中。许可证基于网站的域，即 example.com（所有子域都包含在许可证中）。

当调用该工具的 DLL 时，它会检查它是否确实在获得许可的域中运行。当 UI 调用此工具时，一切正常。当 WCF 服务执行相同操作时，该工具以某种方式获取服务器的名称而不是域，因此认为它是未经许可的。

我真的不想专注于该工具，我想知道的是：

如果`.aspx`和`.svc`文件（及其父 DLL）都托管在同一个 IIS 6 网站和虚拟目录中，它们是否应该在相同的帐户/用户/权限集/等下运行？WCF 服务实现（和合同）在单独的 DLL 中是否重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T09:19:35.847

我想知道该工具是如何进行检查的……我希望您可能需要[启用 ASP.NET 兼容模式](http://msdn.microsoft.com/en-us/library/ms752234.aspx)。要尝试的另一件事是在 WCF 配置中使地址显式（而不是相对）。

不，单独的 dll无关紧要，帐户*也*无关紧要（尽管一切皆有可能！）。

编辑：

或在 web.config 中的 system.serviceModel 下：

```
 <serviceHostingEnvironment aspNetCompatibilityEnabled="true" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:52:15.817

打开 ASP.Net 兼容性确实可以解决问题。谢谢马克格拉维尔！但是，值得指出的是，您还需要更改实现服务契约的类 - 类需要以下属性：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)] 
```

它也可以设置为必需。[MSDN 上](http://msdn.microsoft.com/en-us/library/aa702682.aspx)有一张方便的表格。

（我不知道显式寻址是否也可以工作，我们不能使用它，因为该服务位于 SSL 卸载负载平衡器 (F5) 后面。因此 WCF 认为该服务是通过 HTTP 而实际上是通过 HTTPS。）

# asp.net - WebUserControl css 视觉工作室

> ID：689034
> 
> 赞同：0
> 
> 时间：2009-03-27T09:15:31.507
> 
> 标签：asp.net, visual-studio-2008

那么快速的问题有没有办法在 web 用户控件中使用 css 类？

为什么？

好吧，我在 css 中有一些类可以显着改变布局，所以如果我想查看更改的结果，我不想按 f5 并设置页面加载....

ps即时通讯使用visual stuido 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:07:11.560

您想将css直接设置为用户控件吗？不要认为这是一种常见的方法，但如果其他人对此了解更多......

但是，如果页面在 head 部分中设置了特定的 css，您将在包含用户控件的页面上看到更改。更改将自动显示在页面上。

希望对你有所帮助！;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:31:16.210

是的。只需将类属性添加到用户控件中的 html 元素或在整个控件周围放置一个 div 并给该 div 一个类。这取决于您需要对样式进行多少控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T09:44:27.800

您可以在调试时看到对 css 的更改。只需加载您的应用程序，编辑 css 文件，然后按 ctrl f5 即可在您运行的 Web 应用程序中重新加载 css。只有对代码的更改需要重新编译和重新启动。

# database - 是否可以从 Windows Mobile App 连接到服务器数据库

> ID：689036
> 
> 赞同：1
> 
> 时间：2009-03-27T09:16:39.943
> 
> 标签：database, visual-studio, windows-mobile, odbc, adodb

有什么方法可以从 Windows Mobile 应用程序（使用 VS 2008 用 C# 编写）连接到服务器数据库（Oracle、MS SQL、Sybase...）。是否支持说 ODBC 或其他技术？我通过 WLAN 或 UMTS 连接到 LAN。

我不可能安装额外的服务器组件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T12:07:43.493

确保SQL Server 的[System.Data.SqlClient](http://technet.microsoft.com/en-us/library/ms173281.aspx)工作得很好。对于 Oracle，有[OraDirect](http://www.componentsource.com/products/dotconnect-for-oracle/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:57:52.357

似乎没有。 [OdbcConnection 成员](http://msdn.microsoft.com/en-us/library/system.data.odbc.odbcconnection_members.aspx)未使用 Compact Framework 支持标志[http://i.msdn.microsoft.com/6xk89yz6.CFW(en-us,VS.90).gif](http://i.msdn.microsoft.com/6xk89yz6.CFW(en-us,VS.90).gif)

查看[SQL Server Compact](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)：它与其他 Microsoft SQL Server 版本共享一个通用 API。它还包括使用 ADO.NET API 进行数据访问的 ADO.NET 提供程序，以及内置同步功能（来自 WikiPedia）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T12:20:30.373

不，CE 中唯一的直接连接选项是 System.Data.SqlClient，它仅适用于 SQL Server。

我只使用一个专门构建的套接字服务器来完成它——它的好处是使您能够将它变成一个有用的抽象层，但这是一个中等规模的工作。但是，可移植到任何 tcpip 可联网客户端设备。然后，您还可以使其异步，这在移动环境中几乎是必需的。

# .net - MS Velocity 准备好投入生产了吗？

> ID：689041
> 
> 赞同：1
> 
> 时间：2009-03-27T09:20:09.497
> 
> 标签：.net, appfabric, distributed-cache

我想知道是否有人在生产环境中尝试过速度。它现在是 CTP2 版本，我们正在考虑使用它。有人试过吗？如果是，这是一次积极的经历吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T10:04:52.727

[我个人对此的看法是，在Velocity](http://www.microsoft.com/downloads/details.aspx?FamilyId=B24C3708-EEFF-4055-A867-19B5851E7CD2&displaylang=en#Overview)稳定之前，您应该使用[Memcache 。](http://www.danga.com/memcached/)[像Enyim](http://www.codeplex.com/EnyimMemcached)这样的 Memcache .net 客户端已经经受住了时间的考验并被许多人使用。

*   使用提供者独立的 CacheManager
*   为 memcached 实现一个。
*   明天，如果情况发生变化而您仍然想要 Velocity，请更改提供者。

毕竟，这些只是字典，你的域代码应该独立于基础设施。

***相关***：[一个简单的 C# CacheManager 接口](http://dotnetchris.wordpress.com/2008/10/10/critique-pluggable-aspnet-cachemanager/)，
[我对 Windows 上的 Memcache 的回答。](https://stackoverflow.com/questions/351635/memcached-with-windows-and-c/352547#352547)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-08T16:38:56.970

是的！Velocity 1.0 已作为 AppFabric 的一部分发布。[您可以从 Microsoft 下载它](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=467e5aa5-c25b-4c80-a6d2-9f8fb0f337d2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-11T18:18:55.043

我希望我在这里提出的观点可以帮助某人。我们正在我们的系统上部署 AppFabric，并注意到一些需要改进的地方：

*   在大多数情况下，文档已经过时。您会在某些博客上找到详细信息，但通常混合和匹配来自不同站点的内容会为您提供所需的详细信息。仍然对文档标准不太满意。
*   故障排除是另一个问题。90% 的时间，您将处理与安装相关的问题。有些事情应该从一开始就记录下来，以帮助排除故障，但从未因此最终花费比您想象的更多的时间来启动和运行它。
*   就性能而言，我几乎可以肯定它不如 Memcached 快。有人可能会证明我错了，但在那之前，Memcached 是分布式缓存的王者。

现在这里有一些我发现有点麻烦的问题：

*   从缓存集群中动态添加/删除节点
    并不像听起来那么容易。我 在论坛上阅读了许多关于相同问题的
    投诉。
    我还没有尝试过，但你可以在论坛上阅读它。有一些实际问题。

*   节流是另一个问题。在潜在客户缓存
    集群的内存达到高百分比的情况下，缓存就会失败。这给我们带来了一个巨大的问题，因为我们正在使用会话提供程序并且人们开始遇到错误。

    事实证明，SQL Server 和 AppFabric 不应该放在同一个盒子上，因为 SQL Server 确实会占用大量内存。让我感到困惑的是，我有多个节点，但 Lead Cache 存在内存问题，并且没有分发它。在我的例子中，我只有一个节点，而 SQL Server 和 AppFabric 显然在同一个节点上，因为只有一台服务器可用。在这样的场景中，缓存只是失败了。如果您正在运行备份，您会注意到该节点上的缓存将失败，因为该框上的内存使用率非常高。

在我看来，产品的某些方面让我觉得有点匆忙。在 AppFabric 成熟之前，还有其他我们之前使用过的产品，例如 ScaleOut，它们的效果要好得多。

除此之外，我认为 MSFT 在为我们提供可用的东西方面做得足够好。有东西总比没有好，考虑到 Memcached 提供了如此出色的尖端技术。

# templates - MyEclipse 的 Getter/Setter 方法

> ID：689042
> 
> 赞同：2
> 
> 时间：2009-03-27T09:20:27.093
> 
> 标签：templates, myeclipse

我需要知道在 MyEclipse 中用于生成 getter/setter 方法的模板代码中使用的是哪种语言。

1）我想在myeclipse的getter/setter方法模板代码中使用我的静态实用方法。2) 我只想在字段数据类型为字符串时调用我的实用程序方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T18:18:55.557

速度用于所有模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T06:51:16.213

Window > Preferences > Java > Editor > Templates 将允许您为代码添加新模板。您可以在其中创建模板，如果您将其命名为 StringGetterSetter，您所要做的就是输入“str ctrl-space enter”，它会插入方法。

您可以使用 Window > Preferences > Java > Code Style > Code Templates > Code > Getter Body 中的 setter/getter 模板作为复制的基础。

我认为您宁愿调整这些，以便它们自动检测类型何时为字符串，并调整插入的代码。我认为这里没有变量可以告诉您正在设置/获取的字段的类型。elemType 函数在 Editor > Templates 部分中可用，这将允许更复杂的检查。

（我使用 MyEclipse 8.0）

# silverlight - 在 Silverlight 3 的 generic.xaml 中使用 MergedDictionaries

> ID：689044
> 
> 赞同：9
> 
> 时间：2009-03-27T09:21:06.797
> 
> 标签：silverlight, silverlight-3.0, mergeddictionaries, generic.xaml

在 WPF 中，可以通过将标记保存在主题文件夹中的单独 XAML 文件中，然后使用 MergedDictionaries 将它们导入 generic.xaml 来为多个用户控件组织 XAML：

```
<ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="MyFirstControl.xaml" />
        <ResourceDictionary Source="MySecondControl.xaml" />
    </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

随着 Silverlight 3 beta 的推出，引入了合并字典支持，似乎可以对 Silverlight 用户控件进行相同的操作。但是，尽管尝试了对合并字典文件的构建操作的所有组合以及 generic.xaml 中源引用的相应语法，但我似乎无法使其正常工作。

有没有其他人尝试过？有谁知道这是否可能，如果可以，我做错了什么？

* * *

好的 - 所以经过大量的测试项目，在 WPF 中获取工作示例并将 XAML 和 C# 代码移至 Silverlight 3 并且仍然失败，我完全卸载并重新安装了所有 Silverlight 2 位和所有 Silverlight 3 beta 位和终于搞定了。

我只能假设我以某种方式最终安装了错误的测试版 - 我不知道，但似乎我仍在 Silverlight 2 运行时中运行，尽管显然安装了版本 3 运行时。

感谢 Jared 查看并与 SL3 团队核对……感谢[Amy Dullard](http://blogs.msdn.com/amyd/default.aspx)和[Shawn Wildermuth](http://wildermuth.com/2009/04/06/Running_Silverlight_2_and_3_On_Same_Machine_-_Redux!)为在同一台机器上运行 Silverlight 2 和 3 生成了说明和批处理文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-27T15:49:54.863

我刚刚在用户控件中尝试了以下操作，它起作用了：

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="ResourcesA.xaml" />
            <ResourceDictionary Source="ResourcesB.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources>
<StackPanel>
    <Rectangle Width="100" Height="100" Fill="{StaticResource ResAColor}" />
    <Rectangle Width="100" Height="100" Fill="{StaticResource ResBColor}" />
</StackPanel> 
```

但是您特别提到了 generic.xaml。你有什么样的问题？

- 编辑

根据补充意见，我与 SL3 团队进行了交谈，得到了以下答案：

*为我工作，使用作为资源编译的 generic.xaml，并使用完整的资源语法。无法在 generic.xaml (31783) 中使用源的相对 URI 存在错误，但非相对形式应该可以正常工作*

```
<ResourceDictionary Source='/SilverlightClassLibrary1;component/CustomControl.xaml'/> 
```

*在 generic.xaml 中，并将 generic.xaml 和 CustomControl.xaml 的生成操作修改为 Resource。如果还有问题，请告诉我——如果你得到了复制品，我可以看看。*

这有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-14T20:41:37.257

如果`MySecondControl.xaml`使用`MyFirstControl.xaml`您将它们添加到 generic.xaml 的 ResourceDictionary 的顺序中的资源，则无关紧要。您需要冗余地包含`MyFirstControl.xaml`在`MySecondControl.xaml`. `MySecondControl.xaml`应包含：

```
<ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source='/MyControls;component/Themes/MyFirstControl.xaml'/>
</ResourceDictionary.MergedDictionaries>
<!-- ... Contents of MySecondControl.xaml --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-09T01:08:45.260

我刚刚解决了这个问题。ResourceDictionaries 确实支持 MergedDictionaries，但对于使用 Generic.xaml 的自定义模板化控件，Generic.xaml 不支持 MergedDictionaries。所以有两种选择：（1）你要么把所有的模板都堆到 Generic.xaml 中；要么 或 (2) 创建 YourOwnDictionary.xaml，将所有单独的词典合并到 YourOwnDictionary.xaml，并从用户控件和页面引用 YourOwnDictionary.xaml。这似乎是早期 Silverlight 版本不支持合并字典的功能/错误。

# dynamic - 在 PL/SQL 中动态访问用户定义对象的成员

> ID：689055
> 
> 赞同：0
> 
> 时间：2009-03-27T09:25:16.147
> 
> 标签：dynamic, plsql

有没有办法使用变量访问用户定义的记录、对象或引用游标的动态访问成员？例如类似的东西

```
 get_member(my_object, 'member name'); 
```

或许

```
 my_object.$'member name'; 
```

EXECUTE IMMEDIATE 不起作用，因为它不在我的程序范围内运行。

让我简要解释一下我要完成的工作。我有一个映射表 M，它描述了如何将表 A 的记录转换为表 B 的记录。映射必须根据 A 中记录的特定类型（由 A.type 给出）而有所不同。我想执行这样的映射（不完全是，计划将映射逻辑封装在流函数中，但原理仍然相似）：

```
SELECT
  ...   
  CASE 
    WHEN M.field_1_mapping IS NOT NULL THEN
      -- column of A given by value of M.field_1_mapping
    ELSE
      null -- field_1 not filled for record type
  END field_1,
  --- etc.
FROM
  table_a A,
  mapping_table M
WHERE
  A.TYPE = M.TYPE 
```

所以我的问题是我该怎么做。同样，我不能使用动态 SQL，因为它对于每种记录类型都必须不同，但如果可以根据映射字段的值选择列，那么 obovemention sql 将起作用。

我意识到这根本不可能（并且可能违背 PL/SQL 设计理念），在这种情况下，我欢迎您就如何解决这个问题提出任何建议。

PS：我想可以简单地对映射函数进行硬编码，例如：

```
FUNCTION get_field(field_key IN VARCHAR(32), a NOCOPY IN table_a%rowtype) RETURN VARCHAR(2000) IS
  out VARCHAR2(2000)
BEGIN
  -- ...
  IF field_key = 'field_1' THEN
    RETURN a.field_1; END IF;
  -- ..
END; 
```

但这似乎真的很不雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T12:08:43.390

下面是一些将从映射定义构造动态 SQL 的代码。为简单起见，我使用 EMP 表作为表 A，列 DEPTNO 作为类型。

```
declare
   q long;
   rc sys_refcursor;
   first boolean := true;
   l_field1 varchar2(100);
   l_field2 varchar2(100);

   function mapcol (p_field_mapping varchar2) return varchar2
   is
      l_retval varchar2(32);
   begin
      if p_field_mapping is not null then
         l_retval := 'to_char(a.' || p_field_mapping || ')';
      else
         l_retval := 'null';
      end if;
      return l_retval;
   end;
begin
   -- Construct dynamic SQL
   for r_map in (select * from mapping_table)
   loop
      if first then
         first := false;
      else
         q := q || ' union all ';
      end if;
      q := q || 'select ';
      q := q || mapcol(r_map.field_1_mapping) || ', ';
      q := q || mapcol(r_map.field_2_mapping);
      q := q || ' from emp a where a.deptno = ' || r_map.type;
   end loop;

   -- Run SQL and show results
   dbms_output.put_line('SQL = ' || q);
   dbms_output.put_line('');
   dbms_output.put_line('Results');
   dbms_output.put_line('-------');
   open rc for q;
   loop
      fetch rc into l_field1, l_field2;
      exit when rc%notfound;
      dbms_output.put_line(l_field1 || ', ' || l_field2);
   end loop;
end; 
```

然后我创建了这个映射表：

```
SQL> create table mapping_table (type integer,
  2>   field_1_mapping varchar2(30), field_2_mapping varchar2(30));

Table created.

SQL> insert into mapping_table values (10, 'ENAME', 'SAL');

1 row created.

SQL> insert into mapping_table values (20, 'SAL', 'JOB');

1 row created.

SQL> insert into mapping_table values (30, 'JOB', 'HIREDATE');

1 row created.

SQL> commit;

Commit complete. 
```

当我运行它时（在 SQL Plus 中使用 SERVEROUTPUT ON），我得到：

```
SQL = select to_char(a.ENAME), to_char(a.SAL) from emp a where a.deptno = 10
union all
select to_char(a.SAL), to_char(a.JOB) from emp a where a.deptno = 20
union all
select to_char(a.JOB), to_char(a.HIREDATE) from emp a where a.deptno = 30

Results
-------
CLARK, 7450
KING, 10000
TEST,
MILLER, 6500
BINNSY, 100
FARMER, 123
7975, MANAGER
4566, ANALYST
8000, ANALYST
5000, janitor
SALESMAN,
SALESMAN, 22-FEB-1981
SALESMAN, 28-SEP-1981
MANAGER, 01-MAY-1981
SALESMAN, 08-SEP-1981
MANAGER, 19-JUL-2008

PL/SQL procedure successfully completed. 
```

# iphone - 如何确定 iPhone 中的 WiFi 信号

> ID：689056
> 
> 赞同：0
> 
> 时间：2009-03-27T09:26:29.233
> 
> 标签：iphone, objective-c

iPhone可以确定网络中的WiFi站吗？

还有我要检索的那个 WiFi 站的 MAC 地址。

那你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:22:18.943

尝试查看Apple 开发人员中心上的[可达性示例应用程序。](http://developer.apple.com/iphone/library/samplecode/Reachability/index.html#//apple_ref/doc/uid/DTS40007324)

# wpf - 接收事件时闪烁选项卡标题

> ID：689057
> 
> 赞同：2
> 
> 时间：2009-03-27T09:26:34.410
> 
> 标签：wpf

我有一个基于标签的聊天应用程序，用户可以在不同的标签项中与几个人聊天。如果用户正在与接收消息的选项卡以外的其他用户聊天，我想通过闪烁选项卡标题来通知用户传入消息。我如何在 WPF 中实现这一点。一些例子将非常受欢迎。

最好的问候莫尔特萨

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T17:30:13.110

You need to create a style for the header that includes an animation to flash/blink the header foreground. Once you have this you can then apply this when ever needed.

The example below does this. You may want to modify this so set the background instead to make the whole tab flash not just the TabItems text.

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">

    <Window.Resources>
        <Style x:Key="FlashingHeader" TargetType="TabItem">
            <Setter Property="TabItem.HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>

                        <!--Make The Header -->
                         <TextBlock x:Name="header" Foreground ="Black" Text="{Binding}"/>

                        <!--Make The Background Flash-->
                        <DataTemplate.Triggers>
                            <Trigger Property="Visibility" Value="Visible">
                                <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard Storyboard.TargetName="header" AutoReverse="True" RepeatBehavior="Forever" Storyboard.TargetProperty="Foreground.Color">
                                        <ColorAnimation To="Transparent" AutoReverse="True" Duration="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                                </Trigger.EnterActions>
                            </Trigger>
                        </DataTemplate.Triggers>

                    </DataTemplate>

                </Setter.Value>
              </Setter>

        </Style>
    </Window.Resources>

    <StackPanel>

        <TabControl Height="150">
            <TabItem x:Name="one" Header="Page One"></TabItem>
            <TabItem x:Name="two" Header="Page Two"></TabItem>
            <TabItem x:Name="three" Header="Page Three"></TabItem>
        </TabControl> 

        <StackPanel Orientation="Horizontal">

            <Label >Tab Number:</Label>
            <TextBox x:Name="userInput" Width="80">two</TextBox>
            <Button Click="StartFlash_Click">Start Flash</Button>
            <Button Click="StopFlash_Click">Stop Flash</Button>

        </StackPanel> 

    </StackPanel>
</Window> 
```

Then in the c# code you can set the style when ever needed:

```
 private void StartFlash_Click(object sender, RoutedEventArgs e)
        {
            TabItem ti = (TabItem)this.FindName(userInput.Text);

            if (ti != null)
            {
                ti.SetValue(Control.StyleProperty, (Style)this.Resources["FlashingHeader"]);
            }

        }

        private void StopFlash_Click(object sender, RoutedEventArgs e)
        {
            TabItem ti = (TabItem)this.FindName(userInput.Text);

            if (ti != null)
            {
                ti.Style = null;
            }
        } 
```

# asp.net - Crystal Reports 和上传的 PDF 文档

> ID：689059
> 
> 赞同：1
> 
> 时间：2009-03-27T09:29:19.333
> 
> 标签：asp.net, crystal-reports, printing

我有一个建立事件报告的系统。这允许用户填写多个网络表单并上传 PDF 文档、jpeg 图像和 tiff 图像。

我有一份完整的报告，可以打印与事件相关的所有表单数据，但找不到一种快速打印所有数据和 pdf 文档的方法。

首先，是否可以将 pdf 文档和图像作为 cyrstal 报告的一部分，我将这些文档的位置存储在数据库中。

其次，如果这不可能，我可以编写此操作以一键打印所有这些文档和水晶报告。这些文件需要在客户端打印。

我使用的技术是 asp.net2 和 server 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:59:41.973

哪个版本的水晶？更重要的是，检查是否有图片位置公式（右键图片->图片选项卡->图形位置公式）？我相信它在 CR XI 及更高版本上可用。如果你有这个，那么你可以使用你的数据库表来设置你的图像的路径。否则，您将不得不通过将图像填充到数据集中来将图像“推送”到报告中。

我不确定您是否可以在 CR 中显示 pdf。我知道您可以插入 -> OLE 对象并显示指向 pdf 的链接，但我无法让它在 CR 中实际绘制 pdf。

至于用 asp.net 打印，我完全一无所知。我的第一个猜测是将报告导出为 pdf 并将其与静态 pdf 合并并让他们下载。

# linux - xhost 在哪里存储允许的网络地址？

> ID：689061
> 
> 赞同：6
> 
> 时间：2009-03-27T09:30:27.227
> 
> 标签：linux, xserver

xhost 在哪里存储允许的网络地址？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T18:07:32.647

`xhost`只需调用[`XAddHost`etc.](http://www.xfree86.org/current/XAddHost.3.html)，它操作服务器持有的列表。请参阅[`xhost/xhost.c`](http://cgit.freedesktop.org/xorg/app/xhost/tree/xhost.c)客户端和[`xserver/os/access.c`](http://cgit.freedesktop.org/xorg/xserver/tree/os/access.c)服务器端。

如果可能的话，你[真的应该](http://www.acm.uiuc.edu/workshops/cool_unix/xauth.html)尝试使用[`xauth`](http://www.xfree86.org/current/xauth.1.html)而不是[`xhost`](http://www.xfree86.org/current/xhost.1.html)。它保留了一个允许的密钥列表，可以在每个用户、每个客户端的基础上使用，而不是仅仅依赖主机名（在不友好的环境中可以欺骗）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T09:55:04.873

我认为地址存储在 xserver 中。

`xhost`没有任何参数应该打印出当前允许的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T09:34:32.223

```
$ man xhost | grep -A 2 FILES
FILES
       /etc/X*.hosts 
```

所以，我会在 /etc 中查看与该模式匹配的文件。

这里更一般的教训：许多在操作过程中使用某些文件的命令，将在其手册页上记录这些文件。因此，当有人想知道这样的事情时，查看手册是个好主意。FILES 部分通常位于底部，因此快速的“manwhat”后跟“>”（`less`转到文件末尾的命令）通常会显示您要查找的内容。

# c# - 如何在 VB.NET 中使用多线程概念和死锁概念

> ID：689064
> 
> 赞同：0
> 
> 时间：2009-03-27T09:31:29.813
> 
> 标签：c#, vb.net

我将连接来自多台机器的一个数据库。在所有机器中，他们需要将数据插入单个表中。那个时候：如何使用多线程和死锁的概念？使用 MySQL 数据库和 MS Access。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:52:59.680

避免这些问题的最简单方法是使用正确的锁定/编码技术：

例如：

更新字段中的值使用：

```
UPDATE table SET data=data+23 WHERE id=7 
```

并不是

```
@data = SELECT data FROM table WHERE id=7
@data = @data + 23
UPDATE table SET data=@data WHERE id=7 
```

或使用事务，这实际上取决于您要做什么。如果您想稍微扩展您的问题，我可以尝试给您更多示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:35:15.013

如果您谈论的是 SQL 服务器（MySQL），那么线程安全不是您的问题。很难说出你在说什么。多一点信息会很好！

# asp.net-mvc - 有许多孩子的模型时如何分层组织视图和控制器

> ID：689070
> 
> 赞同：2
> 
> 时间：2009-03-27T09:36:40.707
> 
> 标签：asp.net-mvc, project-organization

假设我有一个列出 Persons 的网站，每个 Person 都有多个属性，一些是一对一的（姓名、地址），一些是一对多的（最喜欢的颜色、银行账户等）。

在我的业务层中，它的层次结构很好。

我如何组织这是我的控制器和视图？我应该有 PersonsController、FavoriteColorsController 等吗？都驻留在同一个命名空间和文件夹中？或者我应该只拥有一个具有许多操作的 PersonsController，例如 IndexFavouriteColors、UpdateFavoriteColor 等。这两个选项都不完全正确。第一个没有表明 FavoriteColors 是 Person 的子级，并且只能在人的上下文中使用。第二个将创建一个巨大的 PersonController。

当然，观点也是如此。最好的就是拥有

*   视图/人员/index.aspx
*   视图/人员/details.aspx
*   视图/人/等
*   视图/人员/FavoriteColors/index.aspx
*   视图/人员/FavoriteColors/details.aspx

在这个例子中，我只为 Person 提供了几个一对多的属性，但实际上有很多 (10+)，因此增加了对清晰度的需求。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T14:04:38.033

实际上，我在“区域”中找到了答案，据说 Rails 支持，但 MVC 不支持，尽管有私有实现：

[使用 ASP.NET MVC 对控制器进行分组](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)
[创建 MVC“区域”作为视图下的子文件夹](http://devlicio.us/blogs/billy_mccafferty/archive/2009/01/22/mvc-quot-areas-quot-as-hierarchical-subfolders-under-views.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:42:31.223

```
PersonsController.cs

public ActionResult Index()
{
  return View();
}
public ActionResult Details()
{
  return View();
}
public ActionResult Info()
{
  return View();
} 
```

……

右键单击每个方法并生成视图

在结果中的 Views 文件夹中，您应该有

```
Views
----- Persons
-------------Index
-------------Details
-------------Info
-------------.... 
```

# ruby - 语法高亮

> ID：689071
> 
> 赞同：9
> 
> 时间：2009-03-27T09:36:46.493
> 
> 标签：ruby, syntax, highlighting

我正在寻找一个通用的语法高亮库，以输出到 html。

它用于 ruby​​ 应用程序中，因此 ruby​​ 库会很好，但是可以通过管道输入和输出的优秀实用程序会做

还需要自己猜测合适的语言来突出显示

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-27T09:44:46.630

基于 HTML/CSS/JavaScript 的语法高亮解决方案是最流行的，并且适用于包括 Ruby 在内的不同服务器技术。

*   **[SyntaxHighlighter](http://code.google.com/p/syntaxhighlighter/)**（推荐）在这里帮助开发人员/编码人员轻松地在线发布代码片段并让它看起来很漂亮。它是 100% 基于 Java 脚本的，它不关心你的服务器上有什么。

*   **[Rubyforge.org 上各种语言的语法高亮](http://rubyforge.org/projects/syntax)**库。内置支持将源代码转换为语法高亮的 HTML。

*   **[WordPress 的语法高亮](http://wordpress.org/extend/plugins/syntaxhighlighter/)**。它允许您轻松发布所有语法突出显示的代码，而不会丢失其格式或进行手动更改。

*   **[美化](http://code.google.com/p/google-code-prettify/)**。一个 Javascript 模块和 CSS 文件，允许在 html 页面中突出显示源代码片段的语法。

*   **[GeSHi - 通用语法荧光笔](http://qbnz.com/highlighter/)**。GeSHi 最初的想法是为 phpBB 论坛系统创建一个通用语法荧光笔，但已推广到该项目。GeSHi 旨在成为一个简单但功能强大的高亮类，具有以下目标：（1）支持广泛的流行语言（2）易于添加新的高亮语言（3）高度可定制的输出格式

*   **[JUSH](http://sourceforge.net/projects/jush/)**是一个用 JavaScript 编写的语法高亮组件。它突出显示相互嵌入的 HTML、CSS、JS、PHP 和 SQL 代码。除了语法高亮，它还提供所有支持语言的文档链接。

*   **[CodePlex.com 上适用于 Windows Live Writer](http://www.codeplex.com/wlwSyntaxHighlighter)**的 SyntaxHighlighter（以防万一：）

这里有一些关于这个主题的博客文章：

*   [Ruby 的语法高亮变得非常简单](http://jakescruggs.blogspot.com/2008/05/syntax-highlighting-for-ruby-made-very.html)
*   [Ruby 中的语法高亮](http://www.hokstad.com/syntax-highlighting-in-ruby.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:45:07.127

你看过谷歌的语法高亮吗？我相信SO使用它？

[http://code.google.com/p/syntaxhighlighter/](http://code.google.com/p/syntaxhighlighter/)

编辑：实际上我相信它是 Prettify：

[http://code.google.com/p/google-code-prettify/](http://code.google.com/p/google-code-prettify/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T22:34:40.883

一些选项是：

*   [语法](http://syntax.rubyforge.org/)- 它非常广泛，但我认为它有一些许可问题（语法是 GPL）

*   [Coderay](http://coderay.rubychan.de/) - 我在我的博客上使用它，它非常有限，但很实用

*   [支持多种语言的紫外线](http://ultraviolet.rubyforge.org/)（textmate 可以做的任何事情）

*   如果您愿意桥接 Python，那么[Pygments](http://coderay.rubychan.de/)支持大量语言

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T22:38:52.327

试试[胭脂](https://github.com/jayferd/rouge)。它是纯 ruby​​，与 pygments 兼容，并且正在积极开发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T09:45:12.917

您可能想看看[Colorer](http://colorer.sf.net)。它似乎没有针对 Ruby 的绑定，但有针对 Perl 和 PHP 的绑定，也许可以在此基础上为 Ruby 破解一个绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T09:47:45.373

Scintilla 可以与 C++ 代码一起使用。我不知道有没有办法在 Ruby 中使用 C++ 应用程序。

# c# - 如何检查 DLL 文件是否已注册？

> ID：689072
> 
> 赞同：33
> 
> 时间：2009-03-27T09:37:17.850
> 
> 标签：c#, .net, dllregistration

如何以编程方式查找用 C# 编写的 DLL 文件是否已注册？

我已经尝试过这段代码，但它没有成功。

如果我注册一个 DLL 文件并使用它返回的代码进行检查。如果我取消注册并运行同一段代码，它会再次返回 true。我将 DLL 文件的完整路径作为参数。

[我们用Visual C++](http://en.wikipedia.org/wiki/Visual_C%2B%2B#32-bit_versions)开发了一个简单的 DLL 文件。之后我们注册了它。现在我们要确认它是否已注册。

Bob，你会自己替换那段代码吗，对我来说还是很难吗？

如果我注册一个 DLL 文件，注册表中是否存在条目？我是否应该找到那些条目并判断DLL文件是否已注册？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-27T10:10:39.953

您需要找出 DLL 中定义的 COM 对象的 GUID。然后查看这个注册表项：

```
HKEY_CLASSES_ROOT\CLSID\{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\InprocServer32 
```

将 x 替换为 GUID。

它应该有一个包含 DLL 完整路径的默认值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T09:48:13.643

如果您的意思是在 GAC 中注册，这是我的考虑：要在 GAC 中注册，程序集必须使用强名称（名称中包含**公钥令牌**）进行签名。

所以你可以尝试使用加载它`Assembly.Load(string)`，如果你得到`FileNotFoundException`- 程序集没有在 GAC 中注册。

如果没有错误，但结果`Assembly.GetName().GetPublicKeyToken()`为 null 或为空 - 这意味着您在应用程序目录中找到了程序集，而不是在 GAC 中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-01T16:12:34.110

你可以使用这个：

```
My.Computer.Registry.ClassesRoot.GetSubKeyNames.Contains("gEncrypt.clsEncrypt") 
```

其中“gEncrypt.clsEncrypt”是 ComName.ClassName。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-05T01:12:50.167

如果您知道 COM dll 的 CLSID，您只需检查是否有一个带有该 CLSID 的密钥`HKEY_CLASSES_ROOT\CLSID\{CLSID-of-your-COM-component}`或`HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{CLSID-of-your-COM-component}`（Wow6432Node => 32 位 COM 在 64 位机器上注册）

这是一个例子：

```
private bool IsAlreadyRegistered()
{
    using (var classesRootKey = Microsoft.Win32.RegistryKey.OpenBaseKey(
           Microsoft.Win32.RegistryHive.ClassesRoot, Microsoft.Win32.RegistryView.Default))
    {
        const string clsid = "{12345678-9012-3456-7890-123456789012}";

        var clsIdKey = classesRootKey.OpenSubKey(@"Wow6432Node\CLSID\" + clsid) ??
                        classesRootKey.OpenSubKey(@"CLSID\" + clsid);

        if (clsIdKey != null)
        {
            clsIdKey.Dispose();
            return true;
        }

        return false;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T09:40:39.947

1.  声明一个指向接口的指针
2.  在 CLSID 和 IID 上调用 CoCreateInstance
3.  如果返回值不是 S_OK 则类未注册

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-19T14:52:47.563

```
class TestDll
{
    //Import your tested DLL here
    [DllImport("kernel32")]
    public extern static int LoadLibrary(string lpLibFileName);
}

try
{
    TestDll test = new TestDll();
}
catch(DllNotFoundException ex)
{
    return false;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T09:40:01.290

```
[DllImport("kernel32")]    
public extern static bool FreeLibrary(int hLibModule);

[DllImport("kernel32")]    
public extern static int LoadLibrary(string lpLibFileName);

public bool IsDllRegistered(string DllName)    
{

      int libId = LoadLibrary(DllName);    
      if (libId>0) FreeLibrary(libId);    
      return (libId>0);    
} 
```

# algorithm - 复杂的算法 - 如何将规则与处理代码分开存储？

> ID：689074
> 
> 赞同：0
> 
> 时间：2009-03-27T09:38:20.873
> 
> 标签：algorithm

我正在开发一个项目，该项目将对一些用户提供的输入进行一些复杂的分析。代码将分为 3 部分：

1) 用户提供的输入，例如关键字

2）规则，比如如果关键字1在关键字5中重复了3次，就这样做，等等。

3）以及执行规则并处理用户输入的分析本身，并基于处理生成必要的输出。

这自然会导致处理代码中出现大量的意大利面条式代码和很多很多的 if 语句。我想避免这种情况，并将规则（即 if 语句）与循环通过用户输入并生成输出的代码分开。

我该怎么做，即最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T09:45:45.567

如果您有足够多的规则要外化，您可以尝试使用业务规则引擎，例如Java 中的[Drools](http://jboss.org/drools)。

> 业务规则引擎是在运行时生产环境中执行一个或多个业务规则的软件系统。规则可能来自法律法规（“员工可以因任何原因或无原因被解雇，但不能因非法原因而被解雇”）、公司政策（“一次消费超过 100 美元的所有客户将获得 10% 的折扣”） ) 或其他来源。（[维基百科](http://en.wikipedia.org/wiki/Business_rules_engine)）

根据您要执行的操作，这可能会有点开销。在我的公司中，我们将此类工具用于我们的质量分析工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:42:16.947

将其存储在 XML 中。易于解析和更新。

我设计了一个代码生成器，它可以通过 xml 文件进行控制。对于每个命令，我在 xml 中有一个条目。我正在处理节点以生成该命令的操作码。Node 本身包含获取操作码所需的操作。对于某些命令，我​​必须查看数据库，所有这些东西我都放在这个 xml 文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T10:43:49.547

好吧，我怀疑如果正确应用了多态性，是否有必要使用休 if 语句。

实际上，您的规则需要适当的域模型。这会以某种方式进入命令模式的方向，具体取决于代码的复杂性，可能与状态机模式相结合。

一旦你有了你的模型，定义规则就是正确地实例化它们。

这可以通过一个 xml 定义来完成，该定义被解析并转换为您的模型。但新的现代甚至更奇特的方式将是使用 DSL。如果您使用 Java 编程并且对您的库有一定的自由度，那么这将是使用[Groovy 的嵌入式 DSL](http://docs.codehaus.org/display/GROOVY/Writing+Domain-Specific+Languages)的合适用例。基本上，您需要一个构建模型的构建器，仅此而已。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T09:42:19.380

您始终可以实现将根据传递的参数创建某些策略的工厂。然后您将在代码中使用这些策略，而无需任何 if。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T09:42:54.403

向您的应用程序添加**嵌入式脚本语言**可能会有所帮助。然后，规则将在脚本中表达，由应用程序在处理时执行。

这个想法是脚本易于更改并包含将由您的应用程序详细执行的高级逻辑。

有很多脚本语言可以做到这一点：lua、Python、Falcon、squirrel、angelscript 等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T09:49:04.483

如果它只是检测关键字，有限状态机或类似的。如果它做得更多，那么其他模式匹配系统，例如规则引擎。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T10:47:13.890

看看[规则引擎](http://java-source.net/open-source/rule-engines)！

拉斯的方法也可能是有争议的。

# facebook - 我可以依赖 Facebook Connect 吗？

> ID：689075
> 
> 赞同：7
> 
> 时间：2009-03-27T09:38:27.440
> 
> 标签：facebook, reliability

我一直在考虑将[Facebook Connect](http://en.wikipedia.org/wiki/Facebook_Platform#Facebook_Connect)用于我正在构建的新网站，但是 Facebook API 似乎有点不稳定。

我一直在使用的代码是基本的，但是示例应用程序“therunaround”也遇到了类似的问题。

例如，朋友列表并不总是加载，登录的 Facebook 用户并不总是被检测到。

这些问题纯粹是因为我刚刚开始吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T09:45:11.137

是的，您描述的问题可能只是由于没有正确使用 API。

Facebook Connect 仍然很新，并且偶尔会遇到问题，但总的来说它非常稳定，并且正在被许多主要网站实施。

此开发人员帖子可能与您的问题有关：（来自： http: [//www.facebook.com/developers/message.php](http://www.facebook.com/developers/message.php)）

> 请确保在使用 Facebook Connect JS API 之前加载功能 2009 年 2 月 26 日下午 1:35
> 
> 几乎所有 Facebook Connect 的 JS API 都是在调用 FB.init() 后异步加载的。由于异步特性，JS API 在进行这些调用后不一定立即可用。您应该使用 FB.ensureInit 或 FB.Bootstrap.requireFeatures 来确保在使用之前加载 JS API。
> 
> 我们有一个 wiki 文档更详细地描述了这一点。但是，我们刚刚发现一些 Connect 应用程序在调用 FB.init 后立即调用了 Connect JS API，例如 FB.Connect.* 和 FB.Facebook.*。这种方法会导致间歇性故障，因为函数可能尚未加载。
> 
> 在昨晚的推送之前，我们修复了 FeatureLoader.js.php 中的一个错误，它总是自动盯着 Connect 功能的异步加载。修复错误后，在加载之前调用 JS API 的代码更有可能失败。如果您注意到您的 Connect 应用程序遇到 Connect JS 函数未定义的错误，请检查您的代码以确保在使用它们之前它正在等待功能加载。

# asp-classic - ASP FPDF，插入图像的问题

> ID：689081
> 
> 赞同：0
> 
> 时间：2009-03-27T09:41:06.343
> 
> 标签：asp-classic, vbscript, javascript, fpdf

当我使用 FPDF 库（ASP 端口版本）生成 pdf 时插入图像有一些问题，您可以在此处获取[ASP FPDF](http://www.aspxnet.it)

我试过这段代码（这是 ASP VBScript）：

```
 pdf.Image Server.MapPath("map.jpg"), 10, 10, 800, 400
pdf.Image "map.jpg", 10, 10, 800, 400
pdf.Image "http://localhost/pdf_test/map.jpg", 10, 10, 800, 400 
```

上面的代码都不起作用......它一直抛出一个错误：

```
 Microsoft JScript runtime  error '800a138f'

Object expected

/pdf/libs/fpdf.asp, line 817 
```

从**fpdf.asp 第 817 行**（这是 ASP JScript）：

```
 type=SupposeImageType(xfile); 
```

但是，如果不插入图像（即纯文本 pdf），它可以正常工作。有人可以帮我解决这个问题吗？

谢谢德尔斯
_

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-11T09:49:19.590

对`fpdf/include/images.asp`您的字符集进行这些更改：

```
this.Buffer.CharSet ="ISO-8859-1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-10T18:07:33.867

这是我用来在标题中显示图像的代码。我遇到的问题是我想为图像使用一个变量，当我输入变量名称而不是图像名称时，我得到一个错误：

Microsoft JScript 运行时错误“800a138f”

'undefined' 为 null 或不是对象

/EKtestdb/fpdf/fpdf/includes/Basics.asp，第 121 行

```
 this.Header=function Header()
  {
  this.SetY (10)
  this.SetFont ("Times","",10)
  //this.Cell (45,5, "HEADER", 0, 0, "L")
  this.SetFont ("Times","b",14)
  //this.Cell (190,5, this.title, 0, 0, "C")
  this.Cell (190,20, this.title, 0, 0)
  this.SetFont ("Times","",10)
  this.Image('logoSM1.jpg',165,3,33)
  this.Image( techpic ,165,3,33) 
```

这是 basics.asp 第 121 行的代码：

```
this.strrpos=function strrpos(s,ch){
 res = s.lastIndexOf(ch)
 if (res>0-1){return res}else{return false}
}
this.strpos=function strpos(s,ch,start){
 if (arguments.length<3){start=0}
 res = s.indexOf(ch,start);
 if (res>-1){return res}else{return false}
} 
```

如果您只想显示图像，则此行应该有效：

```
this.Image('logoSM1.jpg',165,3,33) 
```

但是对于使用变量而不是图像名称，有人可以帮忙吗？

# iphone - iPhone SDK：Store Kit：我可以在自己的服务器上托管下载吗？

> ID：689082
> 
> 赞同：3
> 
> 时间：2009-03-27T09:41:17.403
> 
> 标签：iphone

我想制作一个每个项目都是独一无二的应用程序。我找不到关于 iPhone OS 3.0 中的 Store Kit 的太多信息。我必须将所有这些下载项目上传到 App Store 吗？或者可以从我自己的服务器下载吗？

示例：我的应用中有 10 件商品可供人们购买。它们是高度独家的，所以购买物品 X 的人将是唯一拥有该物品的人。购买后它不再可用。

你认为有可能做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T10:09:41.657

我建议在苹果开发者论坛上重新提出这个问题——3.0 API 受保密协议约束，不能在这样的公共论坛上讨论。

也就是说，我认为应用内购买与应用购买保持相同的标准——你出售的每件商品都必须得到 Apple 的批准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T13:58:40.640

我的直觉是商店工具包用于处理交易/购买，但您必须在自己的服务器上托管下载。或者我想另一种方法是在应用程序中包含所有文件以开始（或在应用程序更新中），并且购买东西只是解锁这些数据。我认为 360 的倦怠天堂可以做到这一点。这可能就是有人可以购买汽车以在游戏中使用的方式，而其他人即使没有购买也可以在多人游戏中看到它。

我想我可能会创建一个谷歌应用引擎网站并在那里托管我的下载。这样游戏就可以更加灵活。DLC 内容将不依赖于应用更新批准。

我希望可以选择在应用商店中托管文件。那会很方便。:)

# c# - 为 .NET 和 Java 自动生成单元测试用例

> ID：689087
> 
> 赞同：12
> 
> 时间：2009-03-27T09:42:23.267
> 
> 标签：c#, java, .net, unit-testing, cyclomatic-complexity

给定一个 .NET 或 Java 项目，是否有一个好的工具来生成单元测试用例，它生成的单元测试用例将覆盖几乎 100% 的代码覆盖率。测试用例的数量可能与代码的圈复杂度成正比（循环和条件的嵌套越高圈复杂度越高），圈复杂度越高，生成的测试用例集就越多。我不希望它功能齐全（比如我将构建单元测试并在生成后运行它），但我会说它可以在您要修改的测试用例中具有模板样式适合您预期需求的案例。但它也应该有一个适当的设置和拆卸方法，并且足以检测是否应该使用模拟对象进行单元测试，如果有任何依赖关系。那么，存在这样的工具吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-27T09:46:43.753

对于 .NET，Microsoft 拥有[Pex](http://research.microsoft.com/en-us/projects/pex/)，它有望成为 .NET 4.0 的主流，以及[Code Contracts](http://research.microsoft.com/en-us/projects/contracts/)。我强烈推荐观看第 9 频道的视频。

令我震惊的是，这种东西对于非常数据驱动的类（解析器等）非常有用。我看不出我经常会*从*它开始，但它仍然是一个有用的工具，可以放在你的军械库中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T09:46:55.127

对于 C#（或一般的 .NET），[PEX](http://research.microsoft.com/en-us/projects/Pex/)可能就是那个工具。它在 IL 级别工作，并试图强行进入每个分支。它成功地发现了广泛的错误（在 BCL 等中）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T09:58:35.147

尽管这似乎违反直觉，但您可能也对随机测试生成框架感兴趣。研究证明，正如您所建议的，它在发现错误方面与基于覆盖的系统方法一样有效。

查看.NET 和 Java 的[Randoop 。](http://people.csail.mit.edu/cpacheco/randoop/1.2/doc/)它通过生成或多或少随机的方法调用序列来工作，并检查合同、崩溃等。它是全自动的。

此外，您可能还想查看其他一些基于[QuickCheck](http://en.wikipedia.org/wiki/QuickCheck)的随机测试工具，例如 Java、Scala、F#。更类似于 Pex，即您给出一个规范或参数化单元测试，该工具会检查它是否有许多生成的输入参数。

我发现这种编写单元测试的“参数化”方式实际上在至少 60% 的情况下更加自然，并且发现了更多的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-03T20:45:32.187

对于 Java，您可以查看[EvoSuite](http://www.evosuite.org)，它是开源的并且目前处于活动状态（免责声明，我是它的贡献者之一）。另请参阅相关[问题](https://stackoverflow.com/questions/2131935/automatic-generation-of-unit-tests-for-java?lq=1)以获取更多工具列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-31T17:48:02.510

对于 Java，请尝试[JUnit-Tools](http://junit-tools.org/)。它有自己的 eclipse 插件以及良好的文档。

# wcf - 在 WAS 下托管多个端点

> ID：689090
> 
> 赞同：0
> 
> 时间：2009-03-27T09:42:36.993
> 
> 标签：wcf, binding, was

是否可以在 WAS 下托管具有多个绑定端点的服务。例如具有两个 TCP 端点和两个消息队列端点的服务？

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T16:23:52.443

好没问题。唯一的规则是：你不能有两个具有相同地址和协议的端点，例如你不能在 localhost:8000 上有两个 HTTP 端点。

马克

# flash - 从服务器加载新的 swf

> ID：689092
> 
> 赞同：1
> 
> 时间：2009-03-27T09:43:27.630
> 
> 标签：flash, caching

我有一个主闪存，我从服务器加载另一个 swf 文件。我不时更改第二个 swf 文件并想从服务器加载一个新副本。我从浏览器中清除了缓存，但我的客户不知道该怎么做，给他指路很痛苦。如果我想加载主 swf 的新副本，我只需添加一个“main.swf？**version2** ”，但我无法使用 flash 中的 loadMovie 函数来执行此操作。

有什么想法可以在不更改文件名的情况下从服务器获取新副本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T11:26:09.803

我总是使用随机数

main.swf?version=Math.random()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:50:45.477

您可以尝试以下方法：

```
<meta http-equiv="expires" value="Thu, 16 Mar 2000 11:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" /> 
```

在嵌入文件的 html 页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:42:53.833

您需要为第二个 .swf 提供禁止缓存的标头。有很多方法可以做到这一点，具体取决于您的 Web 服务器。

# legacy - 您如何从遗留代码上的 FxCop 开始？

> ID：689093
> 
> 赞同：9
> 
> 时间：2009-03-27T09:43:40.627
> 
> 标签：legacy, fxcop, legacy-code

有没有人有将 FxCop 引入遗留代码的经验？如果有人引入违反规则的代码，我们希望我们的构建失败。但就目前而言，这是不可能的，因为遗留代码有超过 9000 次违规。

我所知道的抑制错误的唯一方法是通过 SuppressMessage 属性，但这仅适用于方法和 GeneratedCodeAttribute。最后一个可以用于类和命名空间（如果我没记错的话），但不应该用于非生成代码（参见[此处](http://blogs.msdn.com/fxcop/archive/2007/04/27/correct-usage-of-the-compilergeneratedattribute-and-the-generatedcodeattribute.aspx)）。

现在，我们每天都会花一些时间来消除违规行为，但会不断引入新的违规行为，因为我们的构建不会失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T01:45:19.200

我也遇到过类似的情况。前段时间我开始在一个现有项目上使用 FxCop，一开始有很多错误。我所做的是关闭所有规则，然后一次打开一组，边走边解决错误。

安全和性能组是一个很好的起点——他们帮助我发现了我以前没有意识到的问题。有些规则是主观的，可能并不完全适用于您的项目，如果有的话。例如，如果国际化不是问题，则关闭该组。如果有不适用于您的特定规则，例如命名规则，则将其关闭。

如果您设法清除了某个规则的一组错误，则可以将构建设置为在将来违反该规则时失败。所以不会出现新的错误。

如果是某个规模的项目，一次只执行一条规则，查看规则的相关性/重要性，然后修复错误或在规则不适用时将其关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T09:59:53.520

首先问自己：您是否愿意并且能够更改遗留代码以符合 FxCop 规则？或者换一种说法：这是打发时间的最佳方式吗？

如果您愿意花费时间和精力，请从挑选您认为对整体质量最重要的少数规则开始并实施这些规则。如果这有帮助，您可以添加一些规则、修复代码等。

以我的经验，实施 FxCop 规则等没有大爆炸的方法。唯一可行的方法是一次取一小块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T10:05:25.037

您可以为 FxCop 项目中的旧违规添加例外。这样您就不需要向现有代码添加任何属性，并且您将收到有关所有新违规的警告。

为此，请在 FxCop GUI 中创建一个项目，使用您的规则运行分析，然后在结果视图中选择您现在要忽略的违规。右键单击并选择“排除”。选定的警告将移至“项目中排除”选项卡。当您准备好返回并修复它们时，选择并单击“标记为活动”。

这些排除项存储在 .FxCop 文件中。

尽管如此，我还是建议逐步引入规则，以平滑每个人的学习曲线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-24T15:23:49.360

下面的方法怎么样：

1.  使用与您的项目相关的所有规则运行 FXCop
2.  将结果保存为基线
3.  开发新代码
4.  运行 FxCop
5.  从基线中删除所有结果

这将导致 fxcop 检查您的新代码....

# c# - WPF：限制一行中的字符数

> ID：689095
> 
> 赞同：1
> 
> 时间：2009-03-27T09:44:14.417
> 
> 标签：c#, .net, wpf, richtextbox

我想为 WPF RichTextBox 控件设置“每行 80 个字符”。有什么好方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T09:54:47.153

检查[这个](https://stackoverflow.com/questions/639634/wpf-how-to-limit-to-max-83-chars-per-single-line-in-richtextbox)。这可能是您正在寻找的东西。

# xml - 与 DOM 和 SAX 相比，XPath 是否更高效？

> ID：689097
> 
> 赞同：24
> 
> 时间：2009-03-27T09:44:38.470
> 
> 标签：xml, dom, xpath, sax

我需要解析一个 xml 字符串并查找特定文本节点的值、属性值等。我在 javascript 中执行此操作，并且使用 DOMParser 类来实现相同的目的。后来我被告知 DOM 会占用大量内存，而 SAX 是一个更好的选择。

最近我发现 XPath 也提供了一种查找节点的简单方法。

但我不确定这 3 种中哪一种是解析 XML 的最有效方法。请帮助....

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-27T09:57:44.133

SAX 是一个自上而下的解析器，允许对 XML 文档进行串行访问，并且适用于只读访问。另一方面，DOM 更健壮 - 它将整个 XML 文档读入树中，当您想要更改、添加、删除该 XML 树中的数据时非常有效。当您只需要 XML 文档中的几个值并且您知道在哪里可以找到它们（您知道数据的路径，/root/item/challange/text）时，XPath 很有用。

SAX：迭代文档时节省时间，每次迭代都只通过一次

DOM：灵活/性能，为您提供更多处理数据的方法

XPath：当您只需要读取几个值时，节省时间

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-27T10:42:02.157

除非您使用[流式 XPath](http://www.cs.umd.edu/projects/xsq/)的研究原型，否则您的 XPath 引擎很可能正在将所有内容加载到内存中，因此它将具有与 DOM 相似的特性。因此，这取决于您对“效率”的定义。它当然更易于使用，并且 XPath 实现可以更改为更有效，而 DOM 将始终在客户端机器上具有整个文档的某种表示，并且 SAX 总是比 XPath 更难编程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T13:45:32.713

**[这份来自 MSDN 的文档](http://msdn.microsoft.com/en-us/library/ms998559.aspx)提供了有关优化 XML 处理的大量信息**。

特别是，XPathDocument 类被设计为比使用（基于 DOM）XmlDocument 类更有效地评估 XPath 表达式。原因是 XPathDocument 是 XML 文档的只读表示，而 DOM 实现还包括更改文档。

使用 DOM 有一个同样重要的缺点，它通常会导致复杂的、意大利面条式的代码难以理解和维护。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-23T07:04:25.677

请参阅[http://code.google.com/p/jlibs/wiki/XMLDog](http://code.google.com/p/jlibs/wiki/XMLDog)

> 我们为 XMLDog 提供一组 xpath 并要求嗅探一些 XML 文档。它使用 SAX 并通过一次遍历文档来评估所有给定的 XPath。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T09:53:09.510

如果您只需要查找特定文本节点的值，那么 XPath。DOM 占用大量内存的原因是它读取整个 XML 并形成文档树。SAX 是基于事件的。因此，根据您的描述，XPath 最适合您的方案。

# c# - .NET 部署 Office 2003 可再发行主互操作程序集 (o2003pia.msi)

> ID：689106
> 
> 赞同：3
> 
> 时间：2009-03-27T09:46:07.110
> 
> 标签：c#, .net, deployment, ms-office, add-in

有没有人真正成功地为 o2003.msi 创建了先决条件？

有*很多*人问这个问题，但我找不到真正成功的人。我发现了一些极其复杂的解决方案，您需要完成可能提供或不提供源代码的 .cpp 文件。我什至尝试编译其中之一，但在目标机器上出现配置错误...... :-(

如果我不安装 o2003.msi，我的 Office“共享加载项”将抛出异常，因为找不到 office.dll。所以我非常希望将它包含在我的安装程序中。

第二个问题，不管前一个问题的结果如何：一台装有 Office 2007 的机器怎么样？02203.msi 抱怨没有安装 Office 2003，所以我似乎需要完成很多事情才能为“Office 共享加载项”创建一个工作安装程序......其他任何人都经历过同样的事情恶梦？

更新：这似乎是 Office.Core /“office.dll”的 PIA，这是真正可以在 traget 机器上获得的东西。没有一个“复杂”的解决方案（我知道如果我付出一些努力就可以开始工作）谈论如何检测这个特定的文件，只有 Word 和 Excel 的 PIA 等等。无论如何，这些似乎已经到位。如果安装不正确，office.dll 是检查和安装 o2003pia.msi 的重要文件！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T16:28:55.637

这可能为时已晚，但这是我为使用少量 C# 代码安装我们公司的 office 2003 和 2007 插件所做的一个解决方案。也许它对你有用。

我将产品代码用于 o2003pia 和 o2007pia 安装，它们是：

2003：**{91490409-6000-11D3-8CFE-0150048383C9}**

2007: **{50120000-1105-0000-0000-0000000FF1CE}**

然后，通过调用 MSI API，您可以获得每个的安装状态。这是查找 2003 的示例：

```
[DllImport("msi.dll")]
    private static extern MsiInstallState MsiQueryProductState
        (string productGuid);
    [DllImport("msi.dll")]
    private static extern uint MsiGetProductInfo
        (string productGuid, string propertyName, StringBuilder valueBuffer, ref Int32 bufferSize);

    bool IsPia2003Installed()
    {
        MsiInstallState state = MsiQueryProductState("{91490409-6000-11D3-8CFE-0150048383C9}");

        return (state == MsiInstallState.msiInstallStateDefault);
    } 
```

如果您尝试完全在安装项目中完成所有这些工作（我假设您使用的是 Visual Studio？），那么您可以添加一个“Windows Installer Search”启动条件来检查上述产品代码。如果满意，您可以运行安装 PIA 的自定义操作。

有关此解决方案的更多信息，我建议从此处[开始](http://msdn.microsoft.com/en-us/library/f09xywha(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T00:57:48.763

不知道为什么，但我查看了 O2003PIA.MSI 和 O2007PIA.MSI，得到了以下产品代码：

O2003PIAProductCode = "{90409419-0006-3D11-C8EF-10054038389C}"

O2007PIAProductCode = "{00002105-5011-0000-0000-000000F01FEC}"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T15:10:26.767

没有答案？*好吧，这*并不重要——因为 02003pia.msi 和 o2007pia.msi 都可以安装多次而不会出现任何问题，因此检查它是否已经安装并不重要。

# wpf - 如何在 WPF 中播放 .flv 文件？

> ID：689110
> 
> 赞同：4
> 
> 时间：2009-03-27T09:47:12.240
> 
> 标签：wpf, flash

如何在 WPF 中播放 .flv 文件？请任何人帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T10:20:06.157

```
// Create the interop host control.
var host = new WindowsFormsHost();

// Create the ActiveX control.
var axShockwaveFlash = new AxShockwaveFlash();

// Assign the ActiveX control as the host control's child.
host.Child = axShockwaveFlash;

// Add the interop host control to the Grid
// control's collection of child controls.
this.MainGrid.Children.Add(host);

axShockwaveFlash.Location = new System.Drawing.Point(0, 0);
axShockwaveFlash.LoadMovie(0, @"C:\player.swf");
axShockwaveFlash.SetVariable("quality", "Low");
axShockwaveFlash.ScaleMode = 0;
axShockwaveFlash.AllowScriptAccess = "always";

//axShockwaveFlash.FlashVars =  @"file=C:\barsandtone.flv" + 
//&autostart=true&fullscreen=true&controlbar=none&repeat=" +
//"always&stretching=fill";

axShockwaveFlash.CallFunction("<invoke name=\"loadFLV\" " +
    "returntype=\"xml\"><arguments><string>barsandtone.flv</string>" +
    "</arguments></invoke>");

axShockwaveFlash.Play(); 
```

**参考**：

*   [在 WPF 项目中托管 Flash 影片](http://www.infosysblogs.com/microsoft/2008/07/hosting_flash_movie_in_a_wpf_p.html)
*   [在 WPF 中托管 Flash 电影（第 2 部分）](http://www.infosysblogs.com/microsoft/2008/08/hosting_flash_movie_in_wpf_par.html)：一些“请严格使用 Microsoft 技术”选项

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-16T09:05:50.320

如果要使用 DirectShow，则必须使用 WPFMediaKit。

使用[http://www.free-codecs.com/download/K_lite_codec_pack.htm](http://www.free-codecs.com/download/K_lite_codec_pack.htm)就可以了。

马克斯@GoTactile

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-27T09:49:40.877

如果那是使用 DirectShow，那么您可能只需要安装一个编解码器：

[http://www.free-codecs.com/download/K_lite_codec_pack.htm](http://www.free-codecs.com/download/K_lite_codec_pack.htm)

# c# - 64 位窗口上的 DirectX 应用程序

> ID：689111
> 
> 赞同：6
> 
> 时间：2009-03-27T09:47:12.413
> 
> 标签：c#, wpf, 3d, directx

我正在开发一个 WPF 应用程序，其中 3D 部分由 DirectX 9 处理（很多 3d 使用 WPF 运行速度不够快）。

问题是应用程序以“任何 CPU”作为配置发布，当用户在 64 位窗口上运行它时，direcX 部分崩溃（System.BadImageFormatException）。显然，directX 部分包含的 dll 在 64 位窗口上不可用。

这发生在我们在应用程序中使用的其他一些 3:rd 部分 dll 中，但是如果用户在 64 位 Windows 机器上运行，我们通过将运行时中的 dll 更改为为 x64 构建的 dll 解决了这个问题。你们有谁知道我在哪里可以找到 x64 的 DirectX 9 dll 吗？如果它们存在的话。

我需要的是：

*   Microsoft.DirectX.Direct3D
*   Microsoft.DirectX.Direct3DX
*   微软.DirectX

如果它们不存在，是否可以通过其他方式解决问题？我无法将配置更改为 x86，因为应用程序是通过 ClickOnce 发布的，并且配置更改使 ClickOnce 停止工作（配置包含在 ClickOnce 键中）

* * *

让我补充一点，我正在使用由 WPF 应用程序托管的 Winforms 部分，并且 winforms 部分正在使用我所询问的 DirectX dll。与使用 WPF:s 3D 相比，这是一种在 WPF 中呈现大量 3D 网格的更好更快的方法。不幸的是，这个问题反而发生了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T11:02:38.237

您需要的 DLL 用于托管 DirectX。不幸的是，微软不再支持托管 DirectX 和它的继任者，XNA 也不支持 64 位。

SlimDX 是托管 DirectX 的开源替代品，它支持 64 位。另一种选择是用非托管 C++ 编写 DirectX 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T18:03:31.980

您可以将 WPF 应用程序设置为仅作为 32 位应用程序运行。将您的 ClickOnce 问题发布为另一个 SO 问题。这可能是您最好的选择。

`Project Properties -> Build -> Platform Target -> x86`

# regex - VBscript 有模块吗？我需要处理 CSV

> ID：689123
> 
> 赞同：1
> 
> 时间：2009-03-27T09:50:00.360
> 
> 标签：regex, vbscript, csv, module, split

我需要读取一个 CSV 文件，而我唯一可以使用的语言是 VBscript。

我目前只是打开文件并用逗号分割，它工作正常，因为字段中没有任何带引号的逗号。但我知道这是一个非常脆弱的解决方案。

那么，有没有我可以使用的 VBscript 模块之类的东西？在某个地方可以获得一个经过验证的正则表达式，它只会在逗号而不是引号中分割？

任何建议都非常感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T10:27:13.783

VBScript 没有可与 Perl 相媲美的模块系统。[但是，您可以使用ADO](http://msdn.microsoft.com/en-us/library/ms675532(VS.85).aspx)打开 CSV 文件并像访问数据库表一样访问它们。代码会是这样的：

*（有趣的评论只是为了修复 SO 损坏的 VB 语法突出显示）*

```
Dim conn    ''// As ADODB.Connection
Dim rs      ''// As ADODB.RecordSet
Dim connStr ''// As String
Dim dataDir ''// As String

dataDir = "C:\"                         '"
connStr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & dataDir & ";Extended Properties=""text"""

Set conn = CreateObject("ADODB.Connection")
conn.Open(connStr)
Set rs = conn.Execute("SELECT * FROM [data.txt]")

''// do something with the recordset
WScript.Echo rs.Fields.Count & " columns found."
WScript.Echo "---"

WScript.Echo rs.Fields("Col1Name").Value
If Not rs.EOF Then
  rs.MoveNext
  WScript.Echo rs.Fields("Col3Name").Value
End If

''// explicitly closing stuff is somewhat optional
''// in this script, but consider it a good habit
rs.Close
conn.Close

Set rs = Nothing
Set conn = Nothing 
```

创建一个[`schema.ini`](http://msdn.microsoft.com/en-us/library/ms709353.aspx)准确描述您的输入的文件是最佳选择。如果你不这样做，你会强迫文本驱动程序猜测，如果它猜错了，所有的赌注都将被取消。`schema.ini`必须位于数据所在的同一目录中。

我的看起来像这样：

```
[data.txt]
Format=Delimited(;)
DecimalSymbol=.
ColNameHeader=True
MaxScanRows=0
Col1=Col1Name Long
Col2=Col2Name Long
Col3=Col3Name Text
Col4=Col4Name Text 
```

有了这个`data.txt`：

```
a;b;c;d
1;2;"foo bar";"yadayada"
1;2;"sample data";"blah" 
```

我得到这个输出：

```
C:\>cscript -nologo data.vbs
4 columns found.
---
1
sample data

C:\> 
```

在这方面值得一读：MSDN 上[关于文本文件的很多 ADO 。](http://msdn.microsoft.com/en-us/library/ms974559.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:56:14.403

您可以尝试将 Excel ODBC 数据源创建为 CSV（我认为称为 DSN。它在*Control Panel -> Administrative Tools -> ODBC Data Sources*中。然后，您可以使用 SQL 查询它。

我仍然不确定你是否能得到你想要的。我的意思是插入一个带有逗号的字符串作为特定单元格的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:23:33.900

一个正则表达式：

```
'Credits go to http://www.codeguru.com/cpp/cpp/algorithms/strings/article.php/c8153/
r.Pattern = ",(?=(?:[^""]*""[^""]*"")*(?![^""]*""))" 
```

它将找到所有不在引号内的逗号。

或者，您可以使用我刚刚为 vbs 改编的这个函数。

```
call test

Function ParseCSV(StringToParse, Quotes)
  Dim i, r(), QuotedItemStart, prevpos

  ReDim r(0)
  prevpos = 1

  For i = 1 To Len(StringToParse)
    If Mid(StringToParse, i, 1) = "," Then
      If QuotedItemStart = 0 Then
        r(UBound(r)) = Trim(Mid(StringToParse, prevpos, i - prevpos))
        ReDim Preserve r(UBound(r) + 1)
        prevpos = i + 1
      End If
    Else
      If InStr(1, Quotes, Mid(StringToParse, i, 1)) Then
        If QuotedItemStart Then
          r(UBound(r)) = Trim(Mid(StringToParse, QuotedItemStart, i - QuotedItemStart))
          ReDim Preserve r(UBound(r) + 1)
          QuotedItemStart = 0
          prevpos = i + 2
          i = i + 1
        Else
          QuotedItemStart = i + 1
        End If
      End If
    End If
  Next

  If prevpos < Len(StringToParse) Then r(UBound(r)) = Trim(Mid(StringToParse, prevpos))
  ParseCSV = r
End Function

Sub Test()
  Dim i, s

  s = ParseCSV("""This is, some text!"",25,""Holy holes!"", 286", """")

  For i = LBound(s) To UBound(s)
    msgbox s(i)
  Next

  msgbox "Items: " & CStr(UBound(s) - LBound(s) + 1)
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T10:35:04.317

为了回答您问题的另一半，我模糊地记得您可以使用分布在多个 WSF 文件中的 Windows Script Host。我自己从来没有做过，[链接到 MSDN](http://msdn.microsoft.com/en-us/library/15x4407c.aspx)。不是纯粹的 VBS，但它应该在“只是”窗口中工作，如果那是真正的限制的话。

更多链接：

*   [脚本专家](http://blogs.msdn.com/gstemp/archive/2004/02/24/79183.aspx)
*   [维基百科](http://en.wikipedia.org/wiki/Windows_Script_File)
*   '[教程](http://www.herongyang.com/VBScript/WSH-WSF-Windows-Script-File-XML-Format.html)'

# open-source - 使用 Jasperforge 进行数据仓库，我真正需要从哪些包开始？

> ID：689128
> 
> 赞同：1
> 
> 时间：2009-03-27T09:50:48.783
> 
> 标签：open-source, jasper-reports, etl, pentaho

对于一家大型商业在线商店，我的公司需要启动一个商业智能项目。

我们做了网店；可能只有几个数据源，所以我认为集成很容易。

我们正在创建数据仓库数据库，从另一个角度重新审视实际的数据库。

我开始四处寻找一些开源 BI 框架，并提出了 Pentaho 和 JasperForge 作为可能的候选者。

我看过 Jasperforge，但我不明白我需要如何拥有前端的软件/包（如 Pentaho 演示）；有人可以帮我对 Jasper BI Suite 的部署做一个简短的高级简报吗？我不明白它是否使用蒙德里安，它是否包含在内？

我可以将 JasperServer 与 Microsoft SQL Server 一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:57:58.610

如果您已经在 SQL Server 上设置了数据库，则可以使用 SQL Server JDBC 驱动程序通过 JasperReports 连接到它。iReport 是您用来设计报告的图形工具。

JasperServer 与 MySQL 捆绑在一起，并允许进行更高级的报告管理，例如调度。您可以使用 Jasper 连接到 Mondrian，但如果您还没有使用 Mondrian，这听起来会使您的情况变得复杂。

最简单的入门方法是[下载并安装 iReport](http://sourceforge.net/project/showfiles.php?group_id=64348&package_id=263428&release_id=670915)，将[SQL 服务器 JDBC 驱动程序](http://www.microsoft.com/downloads/details.aspx?FamilyID=99b21b65-e98f-4a61-b811-19912601fdc9&displaylang=en)添加到类路径（iReport -> 工具 -> 选项 -> 类路径 -> 添加 JAR），然后将新数据源设置为 '数据库 JDBC 连接”并选择 MS 驱动程序并填写服务器详细信息。看看你是怎么做的，然后看看 JasperReports 包和 JasperServer 的其余部分，看看你是否需要它们提供的任何功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-19T09:38:50.437

您还可以考虑 Pentaho 商业智能套件。它可以运行 Jasper 报告。[Penatho BI 套件主页](http://www.pentaho.com/)

# indentation - 在 Cuddle 和 Allman 缩进样式之间隐藏的脚本？

> ID：689129
> 
> 赞同：0
> 
> 时间：2009-03-27T09:51:04.697
> 
> 标签：indentation, braces

我相信它被称为“拥抱”风格：

```
function foo() {
   // blah
}

function foo() 
{
   // blah
} 
```

有谁知道将通过文件并在一个方向或另一个方向切换的任何脚本？我的目标是通过捆绑包集成 TextMate，但任何语言的任何脚本都应该没问题。我相信我可以通过捆绑将大多数语言与 textmate 挂钩。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T10:36:33.667

您可能会使用[astyle](http://astyle.sourceforge.net/)，尽管它并不特别支持 JavaScript，但它足够松散，可以`astyle -b`正确格式化您的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:09:35.220

[http://www.bierkandt.org/beautify/](http://www.bierkandt.org/beautify/)是我解决这个问题的方法。我在 Textmate 中制作了一个新包

```
/path/to/php ~/Library/Application\ Support/TextMate/beautifyphp/beautify_php -i 5 -v 0 -l -b 0 
```

现在我所做的就是选择我的 php 块，运行 bundle 命令，它会根据我的喜好重新格式化它。它还做了其他好事，比如 align equals 。当然，对齐等于是您已经可以使用 TextMate 中的“源”包执行的操作。

唯一的缺点是它在底部添加了“用 phpBeautify 制作的漂亮”或类似的东西，但它是一个快速删除。我确信我可以将它剥离到捆绑包中，但这项工作并不是我经常做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T10:36:42.840

切换缩进样式是一种漂亮的打印或代码美化的形式。

对于 Javascript，[http://jsbeautifier.org/](http://jsbeautifier.org/)上的在线工具也有可供下载的代码。

对于其他语言，维基百科上有一个完整的代码美化器列表[http://en.wikipedia.org/wiki/Prettyprint](http://en.wikipedia.org/wiki/Prettyprint)

您可以使用 Javascript 编写 TextMate 脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T10:22:18.897

查看 TextMate 中的 CSS 包，因为当您按 Cq 时它会执行非常相似的操作

# redirect - 从主页重定向会影响搜索引擎的抓取吗？

> ID：689139
> 
> 赞同：1
> 
> 时间：2009-03-27T09:55:07.667
> 
> 标签：redirect, seo, http-status-code-301, cname

有一个新域，比如说 va.in。

正在为子域 a.va.in 准备内容

这个想法是 va.in/index 可以包含指向未来某个时间的各个部分的指针（例如，bva.in、c.va.in 等）。到目前为止，拥有这样一个页面是没有意义的，因为只有一个部分 ieava.in

1.  如果我决定暂时将 va.in 重定向到 a.va.in，搜索引擎会跟随重定向并索引该网站吗？

2.  DNS 是进行重定向的最佳位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:04:30.327

使用“301 Moved Permanently”搜索引擎只会索引子域 a.va.in。如果没问题，您可以使用 Web 服务器的配置来执行此操作。

例如在 Apache 中：

```
<VirtualHost va.in www.va.in>
Redirect permanent / http://a.va.in/
</VirtualHost> 
```

* * *

您不能真正使用 DNS 进行重定向，因为在 DNS 中您无法将 CNAME 分配给 @。请参阅：[DNS RFC 是否允许根域 CNAME 到其他域？](https://stackoverflow.com/questions/655235/is-root-domain-cname-to-other-domain-allowed-by-dns-rfc)

有一个与您相关的问题：[301 重定向与 DNS 更改：杀死 301 重定向并更新子域的 DNS 是否安全？](https://stackoverflow.com/questions/681869/301-redirect-vs-dns-change-is-it-ever-safe-to-kill-a-301-redirect-and-update-the)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:56:37.320

是的，如果您使用 HTTP 标头重定向，搜索引擎会遵循重定向

```
header ('HTTP/1.1 301 Moved Permanently');
header ('Location: '.$location); 
```

我不知道 DNS 重定向，但我宁愿不使用它..

您可以[在此处阅读有关如何进行 HTTP 重定向的更多信息](http://www.somacon.com/p145.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:03:43.357

您可以通过两种方式重定向。

1.  正如 evilpenguin 所说，以编程方式
2.  使用网络服务器（示例 iis）

但这两种选择都有一个共同点。如果您想通知搜索引擎 va.in 已永久移至 a.va.in，则重定向必须是永久重定向

如果您不指定永久重定向，爬虫仍然会转到 a.va.in，但在这种情况下，它们不会被告知这是永久重定向。

如果有人为 va.in 添加了书签，并且在第一种情况下（永久重定向），书签将得到更新。但在第二种情况下，书签不会更新。

希望这可以帮助。

# java - 在 Windows 机器上监视（java）进程死亡的最佳方法是什么？

> ID：689143
> 
> 赞同：1
> 
> 时间：2009-03-27T09:56:42.607
> 
> 标签：java, windows, process, trace

我们的 java 进程死亡有一个奇怪的问题。

应用程序不会堆栈跟踪，也不会向日志写入任何内容，进程只是随机死亡。这是一个使用频率很高的应用程序，但这个问题大约每月才会出现一次。

我们目前正在研究使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，但欢迎提出任何其他建议。

**编辑：**

它是一个分布式 Java 应用程序，运行在带有内部 Web 框架的 Weblogic 上（是的，这是一个糟糕的想法，但它已经运行了八年），连接到 Oracle。

-

*记不清？* 根据 Brian Agnew 的说法，我们的日志会捕获 java.lang.OutOfMemoryException。

*将崩溃写入日志？*我认为 Java 永远没有机会，死亡发生在进程级别，而不是 Java 退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T10:44:20.170

你能把它包装在一些捕获日志文件（stdout/stderr）和退出代码（应该给出一些关于它是如何死亡的指示）的shell脚本中吗？在 JVM 退出时，您还可以使用[WMI捕获机器级别的统计信息](http://msdn.microsoft.com/en-us/library/aa394582.aspx)

如果 VM 本身崩溃，它将留下一个 hs_err_pid... 文件，其中包含堆栈跟踪、机器级调试信息。然后，您可以使用它来诊断 VM 问题。有关详细信息，请参阅[此博客条目](http://weblogs.java.net/blog/kohsuke/archive/2009/02/crash_course_on.html)。

如果问题与应用程序的行为有关，则可能值得查看[JConsole](http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html)，尽管从您对问题的描述来看，这听起来更像是低级别的 VM 问题。

（我假设您使用的是 Java 版本号等的最新 VM。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T16:09:34.980

VisualVM is a new tool which makes monitoring Java applications easier:

[https://visualvm.dev.java.net/description.html](https://visualvm.dev.java.net/description.html)

"VisualVM is a tool that provides detailed information about Java applications while they are running. It provides an intuitive graphical user interface that allows you to easily see information about multiple Java applications."

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:30:44.617

您可以使用 Linux NAGIOS 服务器来监控您的 Windows 机器和服务的运行状况！看看：[nagios-monitoring-windows](http://nagios.sourceforge.net/docs/3_0/monitoring-windows.html)。

如果您的 java 应用程序有此类问题！您应该对其进行测试和调试！应用程序不应该消失得无影无踪！寻找日志文件！该应用程序来自哪个供应商？还是自己写的？尝试强制执行另一个 Log4J/Logger/Debug 级别。使用仙人掌等监控您的系统，以减少发生此类崩溃的可能性。与软件供应商交谈。

是否有足够的内存可用？也许应用程序内存不足？它是独立的 java 进程还是来自 tomcat/jboss 服务器的 java 进程？

您是否已将崩溃时间记录到日志中？它们出现在不同的时间片中？或者看起来它们几乎是时间循环的？

# c# - 如果您在任务管理器中结束进程，GC 是否仍会清理？

> ID：689146
> 
> 赞同：4
> 
> 时间：2009-03-27T09:57:59.843
> 
> 标签：c#, garbage-collection

我想我最近在某处读到（甚至可能在 SO 但我找不到问题）在调试会话中，在 VS 中按下停止只会终止进程并且不会发生 GC。但是，关闭应用程序窗口通常会按预期执行 GC。

它是否正确？

另外，当一个（非调试）进程在任务管理器中被杀死时会发生什么 - GC 仍然清理吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-27T10:00:41.023

如果你杀死进程，操作系统会清理进程的内存，但不会发生 .NET 运行时内的 GC，也不会运行终结器。

**编辑：（**只有当你终止进程时，上面才是正确的，而不是如果你使用“结束任务”）

如果您发送“结束任务”，那么它将向程序发送适当的 WM_CLOSE 窗口消息，并且*不会*立即终止进程并且.NET 可以正常关闭。

**编辑：（**又一个附录）

如果停止调试，则大致相当于`TerminateProcess()`，将立即关闭进程。

# sql - 实体框架：检测 DBSchema 以获得许可

> ID：689147
> 
> 赞同：0
> 
> 时间：2009-03-27T09:58:18.330
> 
> 标签：sql, entity-framework

我们正在开发一种产品，该产品可能具有或不具有针对不同数据库的不同许可架构。特别是，较低层的产品将在 SQLExpress 上运行，但我们不希望最终用户能够使用“全脂”SQL 安装——从降价中受益。显然，其他数据库也必须如此，因此 Oracle 可能会比 SQL 要求更高的价格，例如（假设地）。

我们正在使用实体框架。显然，这隐藏了访问核心模式和使用 sp_version 或其他任何东西的所有简洁性。我们宁愿不通过运行一系列 SQL 命令（每个平台一个）来预加载条件并查看返回的内容，因为这会限制我们的数据库选项。但是，如果有必要，我们准备这样做。

那么，是否有可能使用 EF 本身来获得它？DBContext.CONnection.ServerVersion 只返回类似“9.00.1234”的内容（对于 SQL Server 2005）。我会假设（虽然还没有检查 - 需要安装一个实例）SQLExpress 会返回类似的东西 - “假装”它是全脂的。显然，我们没有 Oracle/MySQL/etc。实例因此无法确定是否返回文本“Oracle”或其他内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:26:52.473

我无法评论实体框架本身，但对于 MS SQL Server，您可以使用 T-SQL 函数[SERVERPROPERTY](http://msdn.microsoft.com/en-us/library/ms174396(SQL.90).aspx)来检测与许可证/成本相关的额外信息

```
SELECT
    SERVERPROPERTY('LicenseType'),
    SERVERPROPERTY('NumLicenses'),
    SERVERPROPERTY('EngineEdition'),
    SERVERPROPERTY('Edition') 
```

否则，它根本不会暴露在客户端代码中

# symfony1 - 带有 request->getParameter 值的表单上传等于 null 会使 Web 应用程序崩溃

> ID：689148
> 
> 赞同：0
> 
> 时间：2009-03-27T09:58:34.740
> 
> 标签：symfony1

我想我在 Symfony 中发现了一个奇怪的问题。

这是我的上传案例表格：

```
<?php

class UploadCaseForm extends sfForm {
    public function configure()
     {
        $this->setWidgets ( array ('Documents' => new sfWidgetFormInputFile ( ) ));
        $this->widgetSchema->setNameFormat('UploadCase[%s]');
        $this->setValidators(array(
        'Documents'=>new sfValidatorFile ()
        ));

    }
}
?> 
```

动作类是这样的：

```
public function executeIndex(sfWebRequest $request) {

    if ($this->getRequest ()->getMethod () == sfRequest::GET) {
        $this->form = new UploadCaseForm ( );
    } else if ($this->getRequest ()->getMethod () == sfRequest::POST) {
        $this->form->bind ($request->getParameters('UploadCase'), $request->getFiles ( 'UploadCase' ) );

    }

} 
```

我希望在我上传文件后，`$request->getParameter('UploadCase')`应该返回 NULL，但不会导致 Web 应用程序崩溃。相反，网络应用程序崩溃了。

我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T11:06:49.770

这是[一个错误，我认为](http://forum.symfony-project.org/index.php/t/19946/)。该错误是因为`$request->getParameter('UploadCase')`只有1个文件上传，没有其他字段。所以下面的语句将返回 null。

```
($request->getParameter('UploadCase')); 
```

这将导致声明

```
$this->form->bind ($request->getParameters('UploadCase'), $request->getFiles ( 'UploadCase' ) ); 
```

像没有明天一样崩溃。

# silverlight - 如何在代码后面做silverlight 3模糊效果？

> ID：689150
> 
> 赞同：2
> 
> 时间：2009-03-27T09:58:37.547
> 
> 标签：silverlight, silverlight-3.0

silverlight 3 中的模糊效果很好：

```
<StackPanel HorizontalAlignment="Left">
    <Button x:Name="Button1"
    Content="Click This"
    Click="Button1_Click">
        <Button.Effect>
            <BlurEffect Radius="2"/>
        </Button.Effect>
    </Button>
</StackPanel> 
```

但是我将如何在后面的代码中做到这一点：

```
private void Button1_Click(object sender, RoutedEventArgs e)
{
    Button1.Content = "was clicked";
    //Button1.Effect.bl...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:12:11.260

仅限 Silverlight 3

```
private void Button1_Click(object sender, RoutedEventArgs e)
{
    ((Button)sender).Content = "was clicked";
    ((Button)sender).Effect = new BlurEffect { Radius = 8 };
} 
```

# java - 遇到异常 java.lang.UNIXProcess.forkAndExec

> ID：689151
> 
> 赞同：0
> 
> 时间：2009-03-27T09:58:40.123
> 
> 标签：java, spring, unix

任何人都知道遇到此异常的原因是什么？

处理过程中遇到异常。堆栈轨迹如下：

```
java.lang.UNIXProcess.forkAndExec(Native Method)
java.lang.UNIXProcess.<init>(UNIXProcess.java:53)
java.lang.ProcessImpl.start(ProcessImpl.java:65)
java.lang.ProcessBuilder.start(ProcessBuilder.java:451)
java.lang.Runtime.exec(Runtime.java:591)
java.lang.Runtime.exec(Runtime.java:464)

....

org.springframework.util.MethodInvoker.invoke(MethodInvoker.java:248)
org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean$MethodInvokingJob.executeInternal(MethodInvokingJobDetailFactoryBean.java:198)
org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:90)
org.quartz.core.JobRunShell.run(JobRunShell.java:202)
org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:529) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T12:44:47.040

如果从`start()`方法中抛出异常，则操作系统无法分叉/执行该进程。所以问题不在于子进程死亡，而在于它没有被启动。

那么您是否正确指定了这一点？你依赖`PATH`设置吗？执行权限是否正确？

查看用于初始化`ProcessBuilder`. 即调用参数。

# c# - 打开空数据表时 XmlTextReader 中是否存在错误？

> ID：689153
> 
> 赞同：2
> 
> 时间：2009-03-27T09:59:01.977
> 
> 标签：c#, xml-serialization

在保存不包含任何数据的 DataTables 时，我在 c# 中使用 XmlSerializer 和 XmlTextReader 时遇到了一些问题。这是一个已知问题吗？是否有解决方法？当使用 XMLSerializer 保存空数据表时，会生成以下 XML：

```
 <Values>
        <xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
          <xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="Values" msdata:UseCurrentLocale="true">
            <xs:complexType>
              <xs:choice minOccurs="0" maxOccurs="unbounded">
                <xs:element name="Values">
                  <xs:complexType>
                  </xs:complexType>
                </xs:element>
              </xs:choice>
            </xs:complexType>
          </xs:element>
        </xs:schema>
        <diffgr:diffgram xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1" />
      </Values> 
```

当重新加载包含此内容的 XML 时，XMLTextReader 会静默失败，并且不会加载超出将空数据表写入 XML 的点的内容。此问题似乎是由于 xs:complexType 中缺少 xs:sequence / xs:element 条目引起的。这是一个错误，如果是，解决方法是什么？

以下 c# 程序演示了该问题。由于上述问题，它将输出 dt3 is null：

```
public class Data
{
    private DataTable dt1;
    private DataTable dt2;
    private DataTable dt3;

    public DataTable Dt1
    {
        get { return dt1; }
        set { dt1 = value; }
    }

    public DataTable Dt2
    {
        get { return dt2; }
        set { dt2 = value; }
    }

    public DataTable Dt3
    {
        get { return dt3; }
        set { dt3 = value; }
    }

    public void TestDataTables()
    {
        if(dt1 == null)
            Console.WriteLine("dt1 is null");
        if (dt2 == null)
            Console.WriteLine("dt2 is null");
        if (dt3 == null)
            Console.WriteLine("dt3 is null");
    }
}
class Program
{
    static void Main(string[] args)
    {
        // Create test object
        Data data = new Data();
        data.Dt1 = new DataTable("Test1");
        data.Dt1.Columns.Add("Foo");
        data.Dt2 = new DataTable("Test2");
        // Adding the following line make serialization work as expected
        //data.Dt2.Columns.Add("Foo");
        data.Dt3 = new DataTable("Test3");
        data.Dt3.Columns.Add("Foo");
        data.TestDataTables();

        // Save to XML
        TextWriter filewriter = new StreamWriter("foo.xml");
        XmlTextWriter writer = new XmlTextWriter(filewriter);
        writer.Formatting = Formatting.Indented;
        XmlSerializer s1 = new XmlSerializer(typeof(Data));
        s1.Serialize(writer, data);
        writer.Close();
        filewriter.Close();

        // Reload from XML
        TextReader filereader = new StreamReader("foo.xml");
        XmlTextReader reader = new XmlTextReader(filereader);
        XmlSerializer s2 = new XmlSerializer(typeof(Data));
        Data newData = s2.Deserialize(reader) as Data;
        newData.TestDataTables();

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T10:03:15.853

我倾向于在数据集上使用 write xml 方法，您可以尝试将其作为解决方法。

[http://msdn.microsoft.com/en-us/library/system.data.dataset.writexml.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataset.writexml.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T10:08:41.423

（修改后）

感谢您的示例代码。是的，我同意这是一个错误。对于解决方法...好吧，您可以默认添加一列吗？为避免交叉污染，您可以使用`ShouldSerialize*`：

```
public bool ShouldSerializeDt1() {
    return dt1 != null && dt1.Columns.Count > 0;
}
public bool ShouldSerializeDt2() {
    return dt2 != null && dt2.Columns.Count > 0;
}
public bool ShouldSerializeDt3() {
    return dt3 != null && dt3.Columns.Count > 0;
} 
```

至少那时被省略的是 dt2，而不是 dt3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T15:19:07.993

我刚刚在 MSDN 论坛上发布了这个查询：

> 如何将一个空的 DataTable 序列化为 Session？ [http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/4704d53c-ca3a-4da1-8257-b2b05c2e9e32](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/4704d53c-ca3a-4da1-8257-b2b05c2e9e32)

在我在这里发布一个新主题之前，请问这与您在此处报告的问题相同吗？我不确定，因为我自己没有使用任何显式的序列化，我只是将一个 DataSet（包含一个没有行的 DataTable）放入 Session 中，它在进程外保存/恢复。

# c# - 控制手柄

> ID：689168
> 
> 赞同：0
> 
> 时间：2009-03-27T10:05:19.450
> 
> 标签：c#

如何从 exe 获取特定控件的句柄并将该句柄设置为另一个 exe 中存在的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T11:05:47.183

var controlHandle = YourControl.Handle.ToInt32();

然后您可以使用您最喜欢的进程间通信方法，例如远程将该 int 发送到另一个进程..

# c# - CAPICOM - 验证 SignedCode 来自没有 UI 的受信任的发布者

> ID：689170
> 
> 赞同：8
> 
> 时间：2009-03-27T10:06:07.267
> 
> 标签：c#, digital-signature, authenticode, capicom

我在 .NET 3.0 C# 应用程序中使用 CAPICOM 来检查 exe 文件上的 Authenticode 签名。我需要确保证书被列为受信任的发布者。如果证书尚未受信任，使用`signedCode.Verify(true)`将显示一个对话框，因此用户可以选择是否这样做。但是，`signedCode.Verify(false)`即使签名不是来自受信任的发布者，也会验证签名 - 大概这只是检查证书是否有效。

如何在没有 UI 的情况下检查文件上的签名是否来自有效且受信任的证书？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-04-25T17:58:59.883

首先，**StrongNameSignatureVerificationEx**用于程序集签名验证，而不是 Authenticode 签名验证。因此，这与原始发帖人问题的上下文无关。

关于最初的问题，您可以使用以下代码手动检查签名者证书是否正确链接到受信任的根，无需任何 GUI：

```
ICertificateStatus certStatus = signedCode.Signer.Certificate.IsValid(); 
```

这个想法是检索签名者的证书并告诉 CAPICom 检查它是否具有正确的信任链。

我希望这将有所帮助。干杯，

Mounir IDRASSI，IDRIX，[http://www.idrix.fr](http://www.idrix.fr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-13T03:27:26.810

您可能需要做的是通过[`StrongNameSignatureVerificationEx`](http://msdn.microsoft.com/en-us/library/ms232579.aspx)带有 P/Invoke 的 mscoree.dll 函数使用暴露：

```
[DllImport("mscoree.dll", CharSet=CharSet.Unicode)]
static extern bool StrongNameSignatureVerificationEx(string wszFilePath, bool fForceVerification, ref bool  pfWasVerified); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-05T06:27:10.170

[您可以使用 WinVerifyTrust，如此处](http://www.pinvoke.net/default.aspx/wintrust.winverifytrust)所示。它在 Windows XP/Vista/2008/7 上运行良好。如果您还想检查撤销列表集

```
RevocationChecks = WinTrustDataRevocationChecks.WholeChain; 
```

# shell - 使用文件中的行作为 grep 的文件名？

> ID：689173
> 
> 赞同：3
> 
> 时间：2009-03-27T10:08:27.697
> 
> 标签：shell, grep

我有一个包含文件名（以及它们的完整路径）的文件，我想在所有文件中搜索一个单词。一些伪代码来解释：

```
grep keyword <all files specified in files.txt> 
```

或者

```
cat files.txt > grep keyword
cat files txt | grep keyword 
```

问题是我只能让 grep 搜索文件名，而不是实际文件的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T10:11:21.417

```
cat files.txt | xargs grep keyword 
```

或者

```
grep keyword `cat files.txt` 
```

或（相当于以前但更难误读）

```
grep keyword $(cat files.txt) 
```

应该做的伎俩。

**陷阱：**

*   如果 files.txt 包含带空格的文件名，则任何一种解决方案都会出错，因为“This is a filename.txt”将被解释为四个文件，“This”、“is”、“a”和“filename.txt”。永远不要在文件名中包含空格的一个很好的理由。

    *   有很多方法可以解决这个问题，但没有一个是微不足道的。（find ... -print0 / xargs -0 就是其中之一。）
*   第二个 (cat) 版本可能会导致很长的命令行（超出环境限制时可能会失败）。第一个（xargs）版本自动处理长输入；xargs 提供了几个选项来控制细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T10:23:16.333

DevSolar 的两个答案都有效（在 Linux Ubuntu 上测试），但如果可能有很多文件，xargs 版本更可取，因为它将避免遇到命令行长度限制。

所以：

```
cat files.txt | xargs grep keyword 
```

是要走的路

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T14:59:53.643

```
tr '\n' '\0' <files.txt | LANG=C xargs -r0 grep -F keyword 
```

*   tr 将使用 NUL 字符分隔名称，以便空格不重要（注意 xargs 的相应 -0 选项）。
*   xargs -r 将为“大量”文件启动单个 grep 进程，但如果没有文件，则不会启动任何 grep 进程。
*   LANG=C 表示使用快速例程进行匹配，而不是使用慢速语言环境的例程
*   grep -F 表示使用快速字符串匹配而不是慢速正则表达式匹配

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-02T14:52:42.880

`bash`, `ksh`&`zsh`版本：

```
grep keyword $(<files.txt) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-27T10:10:57.207

上次创建 bash shell 脚本的时间很长，但是您可以将第一个 grep 的结果（查找所有文件名的那个）存储在一个数组中并对其进行迭代，发出更多的 grep 命令。

一个好的起点应该是 bash 脚本指南。

# .net - 适用于所有类型的 Visual Studio 调试可视化工具

> ID：689178
> 
> 赞同：2
> 
> 时间：2009-03-27T10:10:34.040
> 
> 标签：.net, visual-studio, debugging, ide

在开发 Visual Studio (2005) Debug Visualizer 时，您必须指定要可视化的目标类型（即 DataSet Visualizer 将在 TypeOf(DataSet) 处指定其目标）。但是，如果您希望您的 Visualizer 能够可视化任何对象类型怎么办？将目标指定为 TypeOf(Object) 似乎不起作用。

编辑：这是纯粹的托管代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:13:33.893

你不能只是可视化每个对象。关于序列化有某些要求（例如）。我自己从来没有创建过一个复杂的可视化器（只是一个用于自定义邮件对象的可视化器），但这是所有文章都朝着这个方向发展的前提。

**编辑：**

Mole 2010 是一个很棒的可视化工具，可以显示很多东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T04:07:39.443

你不能，这是一种耻辱。对于“object”以外的某个 T，目标类型必须是 typeof(T)。

# php - json_decode 在 webservice 调用后返回 NULL

> ID：689185
> 
> 赞同：65
> 
> 时间：2009-03-27T10:11:48.407
> 
> 标签：php, json

有一个奇怪的行为，`json_encode`我`json_decode`找不到解决方案：

我的 php 应用程序调用 php web 服务。Web 服务返回如下所示的 json：

```
var_dump($foo):
string(62) "{"action":"set","user":"123123123123","status":"OK"}" 
```

现在我喜欢在我的应用程序中解码 json：

```
$data = json_decode($foo, true) 
```

但它返回`NULL`：

```
var_dump($data):
NULL 
```

我用php5。来自网络服务的响应的 Content-Type：（`"text/html; charset=utf-8"`也尝试使用`"application/json; charset=utf-8"`）

可能是什么原因？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2010-02-04T04:23:41.653

Well, i had a similar issue and the problems was the PHP magic quotes in the server... here is my solution:

```
if(get_magic_quotes_gpc()){
  $param = stripslashes($_POST['param']);
}else{
  $param = $_POST['param'];
}
$param = json_decode($param,true); 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-03-27T11:18:42.207

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2010-05-30T23:57:44.317

Print the last json error when debugging.

```
`json_decode( $so, true, 9 );
$json_errors = array(
    JSON_ERROR_NONE => 'No error has occurred',
    JSON_ERROR_DEPTH => 'The maximum stack depth has been exceeded',
    JSON_ERROR_CTRL_CHAR => 'Control character error, possibly incorrectly encoded',
    JSON_ERROR_SYNTAX => 'Syntax error',
);
 echo 'Last error : ', $json_errors[json_last_error()], PHP_EOL, PHP_EOL;` 
```

`Also use the json.stringify() function to double check your JSON syntax.

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2011-10-25T17:24:21.727

None of the solutions above worked for me, but `html_entity_decode($json_string)` did the trick

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-03-27T10:15:49.473

试试这个

```
$foo = utf8_encode($foo);
$data = json_decode($foo, true); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-12-07T14:46:48.317

make sure that if you sent the data by POST / GET, the server has not escape the quotes

```
$my_array = json_decode(str_replace ('\"','"', $json_string), true); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-27T10:31:59.153

```
"﻿{"action":"set","user":"123123123123","status":"OK"}" 
```

开头的这个小撇号 - 它是什么？双引号后的第一个符号。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-01-05T05:28:30.790

I had the similar problem in a live site. In my local site it was working fine. For fixing the same I Just have added the below code

`json_decode(stripslashes($_GET['arr']));`

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-06-08T07:55:16.787

I just put this

```
$result = mb_convert_encoding($result,'UTF-8','UTF-8'); 
    $result = json_decode($result); 
```

and it's working

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-08-08T08:01:42.497

Yesterday I spent 2 hours on checking and fixing that error finally I found that in JSON string that I wanted to decode were '\' slashes. So the logical thing to do is to use stripslashes function or something similiar to different PL.

Of course the best way is sill to print this var out and see what it becomes after json_decode, if it is null you can also use [json_last_error()](http://php.net/manual/en/function.json-last-error.php) function to determine the error it will return integer but here are those int described:

0 = JSON_ERROR_NONE

1 = JSON_ERROR_DEPTH

2 = JSON_ERROR_STATE_MISMATCH

3 = JSON_ERROR_CTRL_CHAR

4 = JSON_ERROR_SYNTAX

5 = JSON_ERROR_UTF8

In my case I got output of json_last_error() as number **4** so it is **JSON_ERROR_SYNTAX**. Then I went and take a look into the string it self which I wanted to convert and it had in last line:

```
'\'title\' error ...' 
```

After that is really just an easy fix.

```
$json = json_decode(stripslashes($response));
if (json_last_error() == 0) { // you've got an object in $json} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-06-23T15:28:20.287

I had such problem with storage json-string in MySQL. Don't really know why, but using htmlspecialchars_decode berofe json_decode resolved problem.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-05-13T17:12:57.583

Non of these solutions worked for me. What DID eventually work was checking the string encoding by saving it to a local file and opening with Notepad++. I found out it was 'UTF-16', so I was able to convert it this way:

```
$str = mb_convert_encoding($str,'UTF-8','UTF-16'); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-21T20:59:44.160

Maybe you use thing as `$` `${`: these chars should be quoted.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-16T17:23:17.453

I was having this problem, when I was calling a soap method to obtain my data, and then return a json string, when I tried to do json_decode I just keep getting null.

Since I was using nusoap to do the soap call I tried to just return json string and now I could do a json_decode, since I really neaded to get my data with a SOAP call, what I did was add ob_start() before include nusoap, id did my call genereate json string, and then before returning my json string I did ob_end_clean(), and GOT MY PROBLEM FIXED :)

EXAMPLE

```
//HRT - SIGNED
//20130116
//verifica se um num assoc deco é valido
ob_start();
require('/nusoap.php');
$aResponse['SimpleIsMemberResult']['IsMember'] = FALSE;
if(!empty($iNumAssociadoTmp))
{
    try
    {
        $client = new soapclientNusoap(PartnerService.svc?wsdl',
         array( 
            // OPTS 
            'trace' => 0,
            'exceptions' => false,
            'cache_wsdl' => WSDL_CACHE_NONE
         )
        );
    //MENSAGEM A ENVIAR
    $sMensagem1 = '
        <SimpleIsMember>
            <request>
                <CheckDigit>'.$iCheckDigitAssociado.'</CheckDigit>
                <Country>Portugal</Country>
                <MemberNumber">'.$iNumAssociadoDeco.'</MemberNumber>
            </request>
        </SimpleIsMember>';
    $aResponse = $client->call('SimpleIsMember',$sMensagem1);
    $aData = array('dados'=>$aResponse->xpto, 'success'=>$aResponse->example);
    }
}
ob_end_clean();
return json_encode($aData); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-03-06T07:52:56.973

I don't know Why? But this work:

```
$out = curl_exec($curl);
    $out = utf8_encode($out);
    $out = str_replace("?", "", $out);
if (substr($out,1,1)!='{'){
    $out = substr($out,3);
}
    $arResult["questions"] = json_decode($out,true); 
```

without utf8_encode() - Don't work

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-08-05T08:53:32.050

Check the encoding of your file. I was using netbeans and had to use iso windows 1252 encoding for an old project and netbeans was using this encoding since then for every new file. json_decode will then return NULL. Saving the file again with UTF-8 encoding solved the problem for me.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-05T08:04:43.927

In Notepad++, select Encoding (from the top menu) and then ensure that "Encode in UTF-8" is selected.

This will display any characters that shouldn't be in your json that would cause `json_decode` to fail.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-11-22T01:53:45.933

Try using json_encode on the string prior to using json_decode... idk if will work for you but it did for me... I'm using laravel 4 ajaxing through a route param.

```
$username = "{username: john}";
public function getAjaxSearchName($username)
{
    $username = json_encode($username);
    die(var_dump(json_decode($username, true)));
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-02-05T12:50:57.520

You should try out [json_last_error_msg()](http://php.net/manual/en/function.json-last-error-msg.php). It will give you the error message and tell you what is wrong. It was introduced in PHP 5.5.

```
$foo = "{"action":"set","user":"123123123123","status":"OK"}";
$data = json_decode($foo, true);
if($data == null) {
    throw new Exception('Decoding JSON failed with the following message: '
                             . json_last_error_msg());
}

// ... JSON decode was good => Let's use the data 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-05-12T09:10:59.960

Before applying PHP related solutions, validate your JSON format. That may be the problem. Try below online JSON format validator. If your JSON format is invalid, correct it first, because PHP doesn't decode invalid JSON strings.

[https://jsonformatter.org/](https://jsonformatter.org/)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-10-29T16:27:11.663

In my case, when I was printing to the screen, json was fine and I copied and decode with `json_deocode()` function. It was working fine. But, when I was trying to put jsonString directly in the function, it was returning null because quotes were coming like these `&quot;`. So I used `htmlspecialchars_decode()` function and now it is working fine. I am new here, so if I am making any mistakes in writing answer then sorry for that. I hope it'll help somebody.

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2021-06-18T04:19:12.773

**Laravel specific answer:** I got the same issue in Laravel. And this did the trick for me

```
$result = json_decode($result->getContent(), true); 
```

* * *

## 回答 #23

> 赞同：-4
> 
> 时间：2010-06-08T14:04:26.320

i had a similar problem, got it to work after adding '' (single quotes) around the json_encode string. Following from my js file:

```
var myJsVar  = <?php echo json_encode($var); ?> ;    -------> NOT WORKING  
var myJsVar = '<?php echo json_encode($var); ?>' ;    -------> WORKING 
```

just thought of posting it in case someone stumbles upon this post like me :)

# .net - 确定 CLR 系统目录

> ID：689189
> 
> 赞同：1
> 
> 时间：2009-03-27T10:13:31.583
> 
> 标签：.net, csc

关于 C# 命令行编译器 /lib 开关的[MSDN 文章指定了以下内容：-](http://msdn.microsoft.com/en-us/library/s5bac5fx(vs.71).aspx)

> 编译器按以下顺序搜索不完全限定的程序集引用：
> 
> *   当前工作目录。这是调用编译器的目录。
>     
>     
> *   公共语言运行时系统目录。
>     
>     
> *   /lib 指定的目录。
>     
>     
> *   LIB 环境变量指定的目录。

您如何以*编程*方式确定 CLR 运行时系统目录在系统上的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-27T23:02:07.347

从 mscoree.dll 本地导出 - GetCORSystemDirectory()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T11:45:59.927

您可以检查 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft.NETFramework\InstallRoot 以找到 .Net 运行时的位置。

[您可以使用Microsoft.Win32.Registry](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.aspx)类访问注册表。

# c# - C# 泛型类型的测试分配

> ID：689192
> 
> 赞同：1
> 
> 时间：2009-03-27T10:14:41.003
> 
> 标签：c#, generics

有什么方法可以测试泛型方法中的泛型参数的实例是否已分配给它可以是值类型还是引用类型？我希望能够在我必须持久化类型的通用方法中执行此操作，其中 T 是实例，K 是该类型的标识符字段的类型（我要持久化的所有对象都具有，因为它们从基类继承类型）。我不想将 K 限制为值类型。代码是这样的：

```
public static bool Save<T, K>(T instance)
{
    // variable to hold object identifer
    K instanceId = default(K);

    PropertyInfo[] properties = typeof(T).GetProperties();

    // loop through properties of the T
    // if property is decorated with a specific attribute then assign to instanceId
    // end loop

    // check that we have a value assigned to instanceId other than default(K)
    // if not return false otherwise continue to persist item
} 
```

因为 K 可以是一个值类型，检查它是否等于 default(K) 会导致错误，因为它依赖于它的可比性。有没有解决的办法？

请注意，在当前情况下，我通过在泛型类型 T 上放置一个条件，它必须从基本类型 BaseObject 继承，因此我的问题是关于泛型和测试分配的一般问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T10:20:30.960

如果您要`instanceId`稍后阅读，则必须从*编译器*的角度明确分配它。我会分配给它`default(K)`并单独有一个标志，说明它是否被赋予了*有用*的价值：

```
public static bool Save<T, K>(T instance)
{
    bool idAssigned = false;
    // variable to hold object identifer
    K instanceId = default(K)

    PropertyInfo[] properties = typeof(T).GetProperties();

    foreach(PropertyInfo property in properties)
    {
        if (SomeCondition(property))
        {
            instanceId = GetId(property);
            idAssigned = true;
        }
    }

    if (!idAssigned)
    {
        return false;
    }
    Persist(whatever);
    return true;
} 
```

编辑：将 的值`instanceId`与*任何*特定值进行比较是不可能的，除非您知道该值永远不会用于明确分配给`instanceId`.

基本上你在这里有两个信息，所以把它们分开保存——标志是要走的路。

# windows - virtualbox ose windows 二进制文件

> ID：689196
> 
> 赞同：4
> 
> 时间：2009-03-27T10:16:42.700
> 
> 标签：windows, licensing, virtualization, gpl, virtualbox

Sun 的 virtualbox windows 二进制文件是在“非商业”许可下，因此不能在任何公司中使用。但源代码是 GPL。网络上是否有任何资源具有为 Windows 编译的虚拟机二进制文件？

添加了赏金，看看我是否可以获得更多反馈。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-04T13:12:37.203

我不知道你究竟打算用 VirtualBox 做什么，但你应该检查一下你是否不能使用个人使用许可证。

来自 [http://www.virtualbox.org/wiki/Licensing_FAQ](http://www.virtualbox.org/wiki/Licensing_FAQ)

**无论您只是将它用于娱乐还是用它来经营数百万欧元的业务都没有关系。**因此，只要您遵循一些关于在您的公司分发安装的规则，您就可以使用商业许可证

> 问：个人使用和评估许可证中的个人使用和学术使用究竟是什么意思？
> 
> 答：个人使用是指您自己在一台或多台 PC 上安装产品并使用它（甚至是您的朋友、姐妹和祖母）。无论您只是将它用于娱乐还是用它来经营数百万欧元的业务都没有关系。此外，如果您将它安装在某个大公司的工作 PC 上，这仍然是个人使用。但是，如果您是管理员并且想要将其部署到您公司的 500 个桌面上，则这不再符合个人使用的条件。好吧，您可以要求您的 500 名员工中的每一个都安装 VirtualBox，但您不认为在这种情况下我们应该得到一些钱吗？我们甚至会帮助您解决您可能遇到的任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T19:00:58.610

vboxwin32.sourceforge.net

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-27T13:27:17.057

这个项目是关于分发 OSE 构建的：

[http://code.google.com/p/osebox/](http://code.google.com/p/osebox/)

（我没试过）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-15T21:17:50.913

**Windows XP 32 位 VBox(Win32) VirtualBox OSE 的要求**

大家好：

我要感谢**nateman1352**，他于 2009 年 4 月 12 日 16:09 在 VirtualBox 论坛上发布了一个链接，您可以在其中下载一个名为**VBox (Win32)**的二进制文件，基于 VirtualBox 开源版 (OSE)。这对于像我这样喜欢在个人和商业环境中部署自由/自由开源软件的人来说非常重要。下面提供了指向我在 VirtualBox 论坛中的帖子的链接，其中我也**感谢 nateman1352**。

我想贡献自己：

根据我在 Windows XP 32 位中安装 VBox (Win32) 的努力，必须在安装 VBox (Win32)**之前**安装 Microsoft Visual C++ 2008 Runtime Libraries 。这些库提供正确安装所需的文件。

显然，VBox (Win32) 是使用 Microsoft Visual Studio 2008 编译的。如果您的计算机中没有安装 Visual Studio 2008，则需要运行时库。此外，可能由于许可和/或专利问题，VBox (Win32)在程序文件夹**中不包含**文件**VBoxGuestAdditions.iso 。**

我要感谢**Petr Dvorak**，他在他的博客中发布了可以下载 VirtualBox Guest Additions ISO 文件的链接。它可以在我在 VirtualBox 论坛中提供的链接之一中下载。按照下面的链接。记得先安装 VBox (Win32)。

以下说明也发布在 VirtualBox 论坛中。

**1)**单击**VirtualBox Guest Additions ISO**链接，该链接可在我在 VirtualBox 论坛的帖子中找到。按照下面的链接。

**2)**一旦你进入**/virtualbox/ 的索引**，你必须点击与你正在使用的**相同版本**的 VBox (Win32) 的文件夹。

**3)**然后下载 VBox Guest Additions ISO 文件。它将具有以下名称**VBoxGuestAdditions_x.xxiso**（其中 x 是版本号）

**4）**将下载的**VBoxGuestAdditions_x.xxiso**复制到文件夹路径里面：

> C:\程序文件\vboxwin32\

在 Windows XP 64 位中，路径可能是：

> C:\Program 文件 (x86)\vboxwin32\

我没有在 Windows XP 64 位中测试过 VBox (Win32)。

**5)**将复制的文件**VBoxGuestAdditions_x.xxiso**重命名为： **VBoxGuestAdditions.iso**。

**6)**当您尝试在虚拟机中安装 Guest Additions 时，VBox (Win32) 将在步骤 #4 中提到的文件夹路径之一中查找文件名**VBoxGuestAdditions.iso 。**

**链接**

要查找我提供的所有链接，请参阅 VirtualBox 论坛中的以下帖子：

[http://forums.virtualbox.org/viewtopic.php?f=6&t=5165&start=15#p146953](http://forums.virtualbox.org/viewtopic.php?f=6&t=5165&start=15#p146953)

我希望这可以帮助很多人。

亲切地，

汤姆 (tmarrero1234)

CompTIA A+ 认证专家

惠普认证平台专家

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-30T19:23:44.883

对于最终在此线程中寻找 Windows 安装程序的 OSE 来宾添加的其他所有人，不愿意从源代码编译他们自己的副本并且不愿意在 OSE 主机中的来宾上使用非 OSE 来宾添加：

[http://code.google.com/p/virtual-box-windows-guest-additions-installer/](http://code.google.com/p/virtual-box-windows-guest-additions-installer/)

花了我一辈子才找到它...

# java - 任意 Java 枚举参数

> ID：689197
> 
> 赞同：2
> 
> 时间：2009-03-27T10:16:54.040
> 
> 标签：java, enums

我对java相当陌生，并且习惯于枚举基本上只是一个命名的整数列表。

现在我正在编写一个实现，其中父类有几个将枚举值作为参数的方法。枚举将在子类中定义，并且会略有不同。由于枚举基本上看起来像类，这并不像我预期的那样工作。每个定义的枚举都将被视为不同类型的对象，父类必须选择一个已定义的枚举作为参数。

有没有一种好方法可以让父类接受在它的子类中定义的任何枚举？还是我必须为此编写一个自定义类？

编辑：这是我的示例，根据 Jon Skeets 的回答修复，适用于稍后研究如何执行此操作的任何人：

```
class Parent {
   protected interface ParentEvent {}
   private HashMap<ParentEvent, String> actions = new HashMap<ParentEvent, String>();

   protected void doStuff(ParentEvent e){

      if(actions.containsKey(e)){
         System.out.println(actions.get(e));
      }

   }
}

class Child extends Parent {
   enum Event implements ParentEvent {EDITED, ADDED, REMOVED}

   public void trigger(){
      doStuff(Event.REMOVED);
   }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T10:22:51.280

你可以让你的枚举实现一个接口，然后给你的父类方法一个该接口类型的参数。

正如你所说，枚举在 Java 中是相当不同的。它们不是命名数字——它们是一组固定的值，但这些值是面向对象的（即它们可以使用多态等）。Java 枚举非常重要，除了一些关于初始化排序的棘手问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T10:25:19.077

如果我对您的理解正确，您希望为您的枚举有一个通用的基类，并希望为子类定义几个不相关的枚举集。这对于 java 的类型安全枚举是不可能的，因为它们不允许您定义基类。

当然，仅仅定义一个枚举并始终扩展其值并不是一种选择，因为这显然违反了开放关闭原则。

对于这样的用例，我对 Josh Bloch 的 Typesafe Enum Pattern 有相当好的经验，他在[Effective Java中描述](http://java.sun.com/developer/Books/effectivejava/Chapter5.pdf)

只需在此处介绍您的超类，并为您的客户端类需要的每个枚举值创建不同的子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:27:32.423

我不确定，但也许这就是你想要的：

```
public abstract class EnumTest<E extends Enum<E>> {
  public abstract void frobnicate(E value);
}

public class Derived extends EnumTest<Derived.DerivedEnum> {
  public void frobnicate(DerivedEnum value) {
    System.out.println(value);
  }

  public static enum DerivedEnum {
    FOO, BAR,
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T10:39:18.607

如果枚举适用于不同的类，您可以在自己的文件中定义枚举。它们不需要嵌套在一个类中。

但是，您不能从另一组扩展一组枚举。

我花了一段时间才摆脱枚举“只是一个整数”的心态。

# c# - 互操作将字符串从 C# 发送到 C++

> ID：689211
> 
> 赞同：2
> 
> 时间：2009-03-27T10:22:51.250
> 
> 标签：c#, c++, string, interop

**[从 C# 到 C++](https://stackoverflow.com/questions/683013/interop-sending-string-from-c-to-c)的互操作发送字符串的重复**

我想将 C# 中的字符串发送到本机 C++ DLL 中的函数。

这是我的代码：

C# 方面：

```
[DllImport(@"Native3DHandler.dll", EntryPoint = "#22", CharSet = CharSet.Unicode)]
private static extern void func1(string str);

public void func2(string str)
{
   func1(str);
} 
```

C++ 方面：

```
void func1(wchar_t *path)
{
    //...
} 
```

我在 C++ 端得到的是一个空字符串，每次，无论我发送什么。帮助？

我之前已经在这里问过了，但我没有得到有效的答案。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T10:59:14.393

你需要

```
[DllImport(@"Native3DHandler.dll", EntryPoint = "#22", CharSet = CharSet.Unicode)]
private static extern void func1 ([MarshalAs (UnmanagedType.LPWSTR)] string str) ; 
```

在这种情况下 ( `wchar_t*`)。正如@danbystrom 建议的那样，请注意调用约定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T15:06:27.793

你读过这个吗？

字符串的默认封送处理

[http://msdn.microsoft.com/en-us/library/s9ts558h(VS.71).aspx](http://msdn.microsoft.com/en-us/library/s9ts558h%28VS.71%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:45:50.400

你应该像这样声明你的 C++ 函数： extern "C" void __stdcall func1(wchar_t *path)

如果这没有帮助，请尝试传递 StringBuilder 而不是字符串。

（免责声明：我实际上从未传递过 Unicode 代码字符串，所以如果上述建议都不起作用，那么只是一个测试，你可以尝试使用“Ansi”来看看会发生什么。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T10:27:28.167

试着放

```
MarshalAs(UnmanagedType.BStr) 
```

对于您传递给方法的字符串类型。

# apache-flex - 是否可以在 Flash 或 Flex 中重视存储 cookie？

> ID：689215
> 
> 赞同：3
> 
> 时间：2009-03-27T10:23:32.917
> 
> 标签：apache-flex, actionscript-3, cookies, flash

在 PHP 中有一个`setcookie`基于函数来存储它。在 Flash 中是否有可能？如果有可能那怎么办？我想存储价值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T10:43:54.023

首先：PHP 在服务器上运行，因此可以发送必要的 HTTP 标头来设置 cookie，而 Flash 在客户端的浏览器中运行，因此不能这样做。

但是，有一种方法可以从 flash/flex 访问和存储 cookie，方法是使用`flash.external.ExternalInterface`和调用 JavaScript 函数来获取和设置 cookie。

我已经开发了一个非常容易做到这一点的类：

```
package de.slashslash.util {

    import flash.external.ExternalInterface;

    /**
     * The Cookie class provides a simple way to create or access
     * cookies in the embedding HTML document of the application.
     * 
     */
    public class Cookie {

        /**
         * Flag if the class was properly initialized.
         */
        private static var _initialized:Boolean = false;

        /**
         * Name of the cookie.
         */
        private var _name:String;

        /**
         * Contents of the cookie.
         */
        private var _value:String;

        /**
         * Flag indicating if a cookie was just created. It is <code>true</code>
         * when the cookie did not exist before and <code>false</code> otherwise.
         */
        private var _isNew:Boolean;

        /**
         * Name of the external javascript function used for getting
         * cookie information.
         */
        private static const GET_COOKIE:String = "cookieGetCookie";

        /**
         * Name of the external javascript function used for setting
         * cookie information.
         */
        private static const SET_COOKIE:String = "cookieSetCookie";

        /**
         * Javascript code to define the GET_COOKIE function.
         */
        private static var FUNCTION_GET_COOKIE:String =
            "function () { " +
                "if (document." + GET_COOKIE + " == null) {" +
                    GET_COOKIE + " = function (name) { " + 
                        "if (document.cookie) {" + 
                            "cookies = document.cookie.split('; ');" + 
                            "for (i = 0; i < cookies.length; i++) {" + 
                                "param = cookies[i].split('=', 2);" + 
                                "if (decodeURIComponent(param[0]) == name) {" + 
                                    "value = decodeURIComponent(param[1]);" + 
                                    "return value;" + 
                                "}" + 
                            "}" + 
                        "}" + 
                        "return null;" + 
                    "};" +
                "}" +
            "}";

        /**
         * Javascript code to define the SET_COOKIE function.
         */
        private static var FUNCTION_SET_COOKIE:String =
            "function () { " +
                "if (document." + SET_COOKIE + " == null) {" +
                    SET_COOKIE + " = function (name, value) { " + 
                        "document.cookie = name + '=' + value;" + 
                    "};" +
                "}" +
            "}";

        /**
         * Initializes the class by injecting javascript code into
         * the embedding document. If the class was already initialized
         * before, this method does nothing.
         */
        private static function initialize():void {
            if (Cookie._initialized) {
                return;
            }

            if (!ExternalInterface.available) {
                throw new Error("ExternalInterface is not available in this container. Internet Explorer ActiveX, Firefox, Mozilla 1.7.5 and greater, or other browsers that support NPRuntime are required.");
            }

            // Add functions to DOM if they aren't already there
            ExternalInterface.call(FUNCTION_GET_COOKIE);
            ExternalInterface.call(FUNCTION_SET_COOKIE);

            Cookie._initialized = true;
        }

        /**
         * Creates a new Cookie object. If a cookie with the specified
         * name already exists, the existing value is used. Otherwise
         * a new cookie is created as soon as a value is assigned to it.
         * 
         * @param name The name of the cookie
         */
        public function Cookie(name:String) {
            Cookie.initialize();

            this._name = name;
            this._value = ExternalInterface.call(GET_COOKIE, name) as String;

            this._isNew = this._value == null;
        }

        /**
         * The name of the cookie.
         */
        public function get name():String {
            return this._name;
        }

        /**
         * The value of the cookie. If it is a new cookie, it is not
         * made persistent until a value is assigned to it.
         */
        public function get value():String {
            return this._value;
        }

        /**
         * @private
         */
        public function set value(value:String):void {
            this._value = value;

            ExternalInterface.call(SET_COOKIE, this._name, this._value);
        }

        /**
         * The <code>isNew</code> property indicates if the cookie
         * already exists or not.
         */
        public function get isNew():Boolean {
            return this._isNew;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T10:37:53.007

是的。Flash 应用程序可以在用户的​​计算机上存储多达 100kb 的数据（默认情况下）。这存储在 Flash cookie 中（与浏览器 cookie 分开）。用户可以通过右键单击 Flash 应用程序并转到设置来调整应用程序可以存储的数量。

这是 AS3 的 SharedObject API：http: [//livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/SharedObject.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/SharedObject.html)

您可以通过谷歌搜索“Flash SharedObject”获取更多信息

确保准备好处理用户不允许您将数据放入 SharedObjects 的情况。这正在成为关注其隐私的精通技术的用户中的流行趋势。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T02:06:43.330

对于一个实际的代码示例：

```
 import flash.net.SharedObject;

// get/create the shared object with a unique name.
// If the shared object exists this grab it, if not
// then it will create a new one
var so: SharedObject = SharedObject.getLocal("UniqueName");

// the shared object has a propery named data, it's
// an object on which you can create, read, or modify
// properties (you can't set the data property itself!)
// you can check to see if it already has something set
// using hasOwnProperty, so we'll check if it has a var
// use it if it does, or set it to a default if it doesn't
if (so.data.hasOwnProperty("theProp"))
{
    trace("already has data! It reads: " + so.data.theProp);
}
else
{
    so.data.theProp = "default value";
    so.flush(); // flush saves the data
    trace("It didn't have a value, so we set it.");
} 
```

将其粘贴到 Flash 中，发布两次，然后查看它是如何存储数据的 :)

# c# - 从后台线程中找到前台线程

> ID：689220
> 
> 赞同：2
> 
> 时间：2009-03-27T10:25:20.230
> 
> 标签：c#, .net

当您处于后台线程的上下文中时。

```
Thread.IsBackground == true 
```

有没有办法找到调用这个后台线程的前台线程？

谢谢你的帮助

更新：创建的线程是后台线程并由线程池（在 Workflow Foundation 运行时内部）处理。我无法在每个后台线程中添加来自主线程的引用。有没有办法从线程池中找到那个前台线程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T10:28:37.023

没有这样的关系。*任何*线程都可以创建一个新线程，包括另一个后台线程。创建新线程后，创建线程与新线程之间没有任何关系。如果您需要知道哪个线程创建了新线程，则需要在`ThreadStart`.

编辑：对于线程池线程，当您的任何代码运行时，我假设它已被您指定为某处的任务，以某种方式。如果您需要一些可用信息（无论是线程 ID 还是其他任何信息），您需要将其放在该任务的上下文中。

# c# - 如何知道我的处理器在 C# 中是 32 位还是 64 位？

> ID：689228
> 
> 赞同：6
> 
> 时间：2009-03-27T10:28:17.087
> 
> 标签：c#

如何知道我的处理器在 C# 中是 32 位还是 64 位？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-13T15:15:06.327

对于使用 .NET 4.0 或更高版本的任何人，有一个内置属性[`System.Environment.Is64BitOperatingSystem`](http://msdn.microsoft.com/en-us/library/system.environment.is64bitoperatingsystem.aspx)可以为您提供此信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T10:31:20.513

本地签入 C# 的最简单方法是：

```
var size = IntPtr.Size; 
```

大小将等于 4 或 8，但更大的问题是你为什么需要知道？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T11:00:02.860

您可以使用以下命令查询[WMI](http://msdn.microsoft.com/en-us/library/aa394582%28v=vs.85%29.aspx)类：[`Win32_Processor`](http://msdn.microsoft.com/en-us/library/aa394373%28VS.85%29.aspx)[`System.Management.ManagementObject`](http://msdn.microsoft.com/en-us/library/system.management.managementobject.aspx)

```
ManagementObject mo;
mo = new ManagementObject("Win32_Processor.DeviceID='CPU0'");
ushort i = (ushort)mo["Architecture"];

switch (i)
{
case 0:
  return "32 Bit";
  break;
case 9:
  return "64 Bit";
  break;
} 
```

查看其他处理器代码[的 MSDN 库描述](http://msdn.microsoft.com/en-us/library/aa394373%28VS.85%29.aspx#properties)。

这样做的一个问题是，运行程序的用户需要查看 WMI 的权限。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T10:46:12.363

您可以从注册表中获取 CPU（以及更多）信息：

```
HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor 
```

有 1 个或多个子键（每个内核一个），称为 0、1、2 等。每个子键包含有关内核的信息，包括包含 x86 或某些 64 位文本的标识符，包括处理器系列和型号。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T10:33:44.360

如果您只想了解当前应用程序是作为 32 位应用程序还是 64 位应用程序运行，只需使用该`IntPtr.Size`属性即可。

```
int bits = IntPtr.Size * 8; 
```

要找出有关实际处理器的信息更加困难。[这是一个](http://www.mentalis.org/soft/class.qpx?id=13)获取一些信息的库，但该页面并没有说明它是否获取了该特定信息。您可以[从注册表中获取一些信息](http://www.java2s.com/Code/CSharp/Windows/RetrievetheCPUTypeandSpeedfromtheRegistry.htm)，我没有检查有多少信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-27T10:38:21.243

您还可以使用 P/Invoke 调用[GetNativeSystemInfo](http://msdn.microsoft.com/en-us/library/ms724340(VS.85).aspx)并获取 SystemInfo 结构。

另一种解决方案如下所示：

```
isWow64 = false;
if (System.Environment.OSVersion.Version.Major >= 5 && 
     System.Environment.OSVersion.Version.Minor >= 1)
{
     var processHandle = GetProcessHandle((uint)
          System.Diagnostics.Process.GetCurrentProcess().Id);
     bool retVal;
     if (!NativeMethods.IsWow64Process(processHandle, out retVal))
     {
     throw (new Win32Exception());
     }
     isWow64 = retVal;
} 
```

替代解决方案（但不推荐）:)

```
public bool Is64bitOS
{
    get
    {
        return Environment.GetEnvironmentVariable("ProgramFiles(x86)")
               != null;
    }
}

public string ProgramFilesX86
{
    get
    {
        string programFiles =
            Environment.GetEnvironmentVariable("ProgramFiles(x86)");
        if (programFiles == null)
        {
            programFiles = Environment.GetEnvironmentVariable(
                           "ProgramFiles");
        }

        return programFiles;
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-27T10:39:05.703

通过 WMI查询[Win32_Processor类](http://msdn.microsoft.com/en-us/library/aa394373(VS.85).aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-13T14:36:04.363

```
[DllImport("kernel32.dll", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool IsWow64Process([In] IntPtr hProcess, [Out] out bool lpSystemInfo);

        public static bool Is64Bit()
        {
            bool retVal;

            IsWow64Process(Process.GetCurrentProcess().Handle, out retVal);

            return retVal;
        } 
```

# c# - 在 .NET 中以编程方式配置网络适配器的最佳方式

> ID：689230
> 
> 赞同：22
> 
> 时间：2009-03-27T10:28:57.973
> 
> 标签：c#, .net, wmi

我有一个用 C# 编写的应用程序，它需要能够在 Windows 中配置网络适配器。我基本上通过 WMI 来解决这个问题，但是我不喜欢该解决方案的一些事情：有时设置似乎不固定，并且当未插入网络电缆时，WMI 会返回错误方法，所以我不知道他们是否真的成功了。

我需要能够通过网络连接配置所有可用的设置 - 属性 - TCP/IP 屏幕。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-17T14:23:39.137

您可以使用`Process`触发[netsh](http://support.microsoft.com/kb/242468)命令来设置网络对话框中的所有属性。

例如：在适配器上设置静态 IP 地址

```
netsh interface ip set address "Local Area Connection" static 192.168.0.10 255.255.255.0 192.168.0.1 1 
```

要将其设置为 dhcp，您将使用

```
netsh interface ip set address "Local Area Connection" dhcp 
```

从 C# 做到这一点将是

```
Process p = new Process();
ProcessStartInfo psi = new ProcessStartInfo("netsh", "interface ip set address \"Local Area Connection\" static 192.168.0.10 255.255.255.0 192.168.0.1 1");
p.StartInfo = psi;
p.Start(); 
```

设置为静态可能需要几秒钟才能完成，因此如果需要，请确保等待进程退出。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-11-08T12:56:26.840

使用我的代码 SetIpAddress 和 SetDHCP

```
 /// <summary>
    /// Sets the ip address.
    /// </summary>
    /// <param name="nicName">Name of the nic.</param>
    /// <param name="ipAddress">The ip address.</param>
    /// <param name="subnetMask">The subnet mask.</param>
    /// <param name="gateway">The gateway.</param>
    /// <param name="dns1">The DNS1.</param>
    /// <param name="dns2">The DNS2.</param>
    /// <returns></returns>
    public static bool SetIpAddress(
        string nicName,
        string ipAddress,
        string subnetMask,
        string gateway = null,
        string dns1 = null,
        string dns2 = null)
    {
        ManagementClass mc = new ManagementClass("Win32_NetworkAdapterConfiguration");
        ManagementObjectCollection moc = mc.GetInstances();

        NetworkInterface[] interfaces = NetworkInterface.GetAllNetworkInterfaces();
        NetworkInterface networkInterface = interfaces.FirstOrDefault(x => x.Name == nicName);
        string nicDesc = nicName;

        if (networkInterface != null)
        {
            nicDesc = networkInterface.Description;
        }

        foreach (ManagementObject mo in moc)
        {
            if ((bool)mo["IPEnabled"] == true
                && mo["Description"].Equals(nicDesc) == true)
            {
                try
                {
                    ManagementBaseObject newIP = mo.GetMethodParameters("EnableStatic");

                    newIP["IPAddress"] = new string[] { ipAddress };
                    newIP["SubnetMask"] = new string[] { subnetMask };

                    ManagementBaseObject setIP = mo.InvokeMethod("EnableStatic", newIP, null);

                    if (gateway != null)
                    {
                        ManagementBaseObject newGateway = mo.GetMethodParameters("SetGateways");

                        newGateway["DefaultIPGateway"] = new string[] { gateway };
                        newGateway["GatewayCostMetric"] = new int[] { 1 };

                        ManagementBaseObject setGateway = mo.InvokeMethod("SetGateways", newGateway, null);
                    }

                    if (dns1 != null || dns2 != null)
                    {
                        ManagementBaseObject newDns = mo.GetMethodParameters("SetDNSServerSearchOrder");
                        var dns = new List<string>();

                        if (dns1 != null)
                        {
                            dns.Add(dns1);
                        }

                        if (dns2 != null)
                        {
                            dns.Add(dns2);
                        }

                        newDns["DNSServerSearchOrder"] = dns.ToArray();

                        ManagementBaseObject setDNS = mo.InvokeMethod("SetDNSServerSearchOrder", newDns, null);
                    }
                }
                catch
                {
                    return false;
                }
            }
        }

        return true;
    }

    /// <summary>
    /// Sets the DHCP.
    /// </summary>
    /// <param name="nicName">Name of the nic.</param>
    public static bool SetDHCP(string nicName)
    {
        ManagementClass mc = new ManagementClass("Win32_NetworkAdapterConfiguration");
        ManagementObjectCollection moc = mc.GetInstances();

        NetworkInterface[] interfaces = NetworkInterface.GetAllNetworkInterfaces();
        NetworkInterface networkInterface = interfaces.FirstOrDefault(x => x.Name == nicName);
        string nicDesc = nicName;

        if (networkInterface != null)
        {
            nicDesc = networkInterface.Description;
        }

        foreach (ManagementObject mo in moc)
        {
            if ((bool)mo["IPEnabled"] == true
                && mo["Description"].Equals(nicDesc) == true)
            {
                try
                {
                    ManagementBaseObject newDNS = mo.GetMethodParameters("SetDNSServerSearchOrder");

                    newDNS["DNSServerSearchOrder"] = null;
                    ManagementBaseObject enableDHCP = mo.InvokeMethod("EnableDHCP", null, null);
                    ManagementBaseObject setDNS = mo.InvokeMethod("SetDNSServerSearchOrder", newDNS, null);
                }
                catch
                {
                    return false;
                }
            }
        }

        return true;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-12T10:48:20.843

在@PaulB 的回答帮助下

```
NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces();
Process p = new Process();
ProcessStartInfo psi = new ProcessStartInfo("netsh", "interface ip set address " + nics[0].Name + " static 192.168." + provider_ip + "." + index + " 255.255.255.0 192.168." + provider_ip + ".1 1");
p.StartInfo = psi;
p.StartInfo.Verb = "runas";
p.Start(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T10:51:47.407

我可以告诉你木马的做法，在清理了几个之后，就是在 HKEY_LOCAL_MACHINE 下设置注册表项。他们设置的主要是 DNS 方法，这种方法绝对可以被任何曾经被感染并且无法再访问 windowsupdate.com、mcafee.com 等的人证明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-24T12:55:36.117

签出这个应用程序。它是设置wifi和以太网ips的完整应用程序

[https://github.com/kamran7679/ConfigureIP](https://github.com/kamran7679/ConfigureIP)

# delphi - 更改 IntraWeb 中必填字段的消息

> ID：689239
> 
> 赞同：1
> 
> 时间：2009-03-27T10:33:49.787
> 
> 标签：delphi, intraweb

在设置 IntraWeb 控件的*Required*属性时，如果我将其留空，我会收到一个漂亮的小消息框，上面写着“Bezeichnung 是必填字段”。

如何更改这些消息的文本？（我的申请是德语）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T11:18:08.610

好吧，我终于在 atozed-Forums 找到了一个提示：

将 IWResourceStrings.pas 复制到我的项目主文件夹并将所需的字符串更改为德语对我有用...

也许有一天其他人也会发现这很有帮助；-)

# .net - .net 4.0 中即将推出的“动态”关键字将如何让我的生活更美好？

> ID：689240
> 
> 赞同：11
> 
> 时间：2009-03-27T10:34:08.197
> 
> 标签：.net, c#-4.0

我不太明白它会让我做什么（或逃脱:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T10:39:56.187

来自查理卡尔弗特的博客：

> 有用的场景
> 
> 对动态查找的新支持将启用三个主要场景：
> 
> 1.  办公自动化和其他 COM 互操作方案
> 2.  使用动态语言编写的类型
> 3.  增强对反射的支持

在此处阅读更多信息：http: [//blogs.msdn.com/charlie/archive/2008/01/25/future-focus.aspx](http://blogs.msdn.com/charlie/archive/2008/01/25/future-focus.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T10:40:43.407

两大领域是：

*   使用方法返回模糊类型的 COM 程序集 - 因此您基本上可以使用后期绑定
*   使用 DLR 类型

其他用途包括：

*   没有界面的鸭子打字
*   Silverlight 与主机页面的 DOM 对话
*   与 xml 文件交谈。

在 C# 本身中，这允许一些事情，例如通用运算符的基本方法：

```
static T Add<T>(T arg1, T arg2) { // doesn't work in CTP
     return ((dynamic)arg1) + ((dynamic)arg2);
} 
```

（当然，我认为[这](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)是一个更好（更有效）的答案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:11:56.157

有一些关于该功能本身以及如何使用它的播客：

*   [C# 4.0 内部：动态类型、可选参数、协变和逆变](http://channel9.msdn.com/shows/Going+Deep/Inside-C-40-dynamic-type-optional-parameters-more-COM-friendly/)
*   [C# 4.0 新特性 - COM 互操作增强](http://channel9.msdn.com/posts/mike+ormond/C-40-New-Features-COM-Interop-Enhancements/)
*   [deCast - Dynamic Xml with C# 4.0](http://channel9.msdn.com/posts/RobBagby/deCast-Dynamic-Xml-with-C-40/) “将说明如何利用 C# 4.0 中启用的动态功能以更自然的方式访问 Xml 数据”

# c# - 通过业务逻辑初始化一个 Linq to Sql 对象

> ID：689241
> 
> 赞同：2
> 
> 时间：2009-03-27T10:35:29.970
> 
> 标签：c#, .net, linq, linq-to-sql, business-logic

我想扩展一个由 Linq To Sql 生成的类，以便在创建新对象 (=row) 时进行初始化。

我想在创建父行时向子表添加行。

我希望使用 Oncreated （部分）方法做这样的事情：

```
partial class Product {
    partial void OnCreated() {
        // Fill default rows for FK relations
        this.Columns.Add(new ProductColumn {
            Name = "Name", ColumnType = 1
        });
        this.Columns.Add(new ProductColumn {
            Name = "Producer", ColumnType = 2
        });
    }
} 
```

每次都从构造函数调用 OnCreated。如果对象将在调用 OnCreated 后从数据库中加载也是如此。而如果对象是从数据库中加载的，则不想执行代码。

那么我在哪里可以在我的模型中添加逻辑来初始化一个对象（-graph）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T20:11:30.437

在 Linq to SQL 生成的类中没有内置的方法。当从数据库调用时，它们会专门调用 OnLoaded，但如果不是，它们不会调用任何东西。我怀疑是因为没有办法确定...

我建议使用 Chris 建议的工厂方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T08:26:01.200

使用 LINQ-to-SQL，实体在*很大程度上*不知道父数据上下文 - 只有像延迟加载的成员`EntitySet<T>`知道这个细节。您可以通过查看`.IsDeferred`（假设它*被*延迟）来识别数据上下文感知实体集 - 如果涉及数据上下文，这将是正确的，否则为错误 - 但还有更多问题：

*   LINQ-to-SQL在构造函数 (and ) 执行**后**附加数据上下文（用于延迟执行）`OnCreated`
*   如果您在`OnCreated`/中手动添加项目`.ctor()`，则会在 LINQ-to-SQL 尝试附加数据上下文时中断
*   LINQ-to-SQL 使用默认构造函数，这意味着泛型/`new()`等也将共享此代码

所以不幸的是；不，我认为你不能`OnCreated`以任何明智的方式做到这一点。你可以：

*   有第二个构造函数用于此用途，它添加了额外的项目
*   使用工厂方法，即`.Create()`正确构建项目的静态方法

（因为 LINQ-to-SQL 本身不会使用上述任何一种）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T14:58:15.993

我认为在这种情况下你最好使用工厂来创建你的实例；因此，您当前在任何地方都有如下代码：

```
Product p = new Product(); 
```

您将拥有：

```
Product p = ProductFactory.CreateProduct(); 
```

你的 CreateProduct() 方法看起来像：

```
public Product CreateProduct()
{
    var p = new Product();
    p.Columns.Add(new ProductColumn {
        Name = "Name", ColumnType = 1
    });
    p.Columns.Add(new ProductColumn {
        Name = "Producer", ColumnType = 2
    });
    return p;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T10:45:51.773

如果您正在使用设计器——我认为您是因为您使用的是部分类——您可以在设计器中添加关联，并且相应的列将自动添加到您的对象中。MSDN 提供了有关[如何](http://msdn.microsoft.com/en-us/library/bb629295.aspx)使用设计器工作表面创建关联的参考。

# silverlight - silverlight 3 工具包 MSI 将 DLL 文件放在哪里？

> ID：689244
> 
> 赞同：2
> 
> 时间：2009-03-27T10:37:18.657
> 
> 标签：silverlight, silverlight-3.0

刚刚下载了[Silverlight 3 Toolkit](http://silverlight.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=20430)并执行了 MSI 文件。

现在我需要参考 Microsoft.Windows.Controls.dll 文件，但不知道 MSI 将它解压到哪里。在 C:\ 或 C:\Program Files 中找不到它。**它可能在哪里？**

*   好的，[这篇文章](http://www.silverlightshow.net/news/The-Silverlight-Toolkit-grows-up-a-little-with-an-install-experience-.aspx)说所有组件都应该在工具箱中，例如 DockPanel，它们适用于 Visual Studio 2008 Professional **，但不适用于 Visual Web Developer 2008 Express**（它有一些控件，但没有 DockPanel）

# 回答：

好的，**答案是：重新启动并重新启动一切**（直到 Silverlight 出现`AG_E_PARSER_BAD_TYPE`错误，并关闭了 Visual Studio 版本和 Firefox）。重新启动一切后，一切正常：控件自动在工具箱中，因此您只需将它们拖入，[不再需要像 Silverlight 2 中那样引用 dll](http://www.tanguay.info/web/index.php?pg=howtos&id=1)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-14T01:06:48.783

它没有自动为我添加 Silverlight Beta 4 Toolkit 和 Visual Studio 2010 Beta 2 的任何内容。

我按照[这些说明](http://shawnoster.com/Blog/Adding-Silverlight-Toolkit-Controls-to-the-Visual-Studio-and-Blend-Toolbox)进行操作。我的工具箱箱位于：

```
 C:\Program Files\Microsoft SDKs\Silverlight\v4.0\Toolkit 
```

此外，我必须为文章中描述的附加工具包项目选择附加 DLL。我还必须选中复选框以表明我确实想要这些项目。

肯定有更好的办法！任何人？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T09:11:46.537

以防万一有人想知道，我是:-)。

有一个名为“Microsoft Silverlight 3 Toolkit March 2009”的开始菜单组，其中包含所有相关信息。工具包程序集位于“C:\Program Files\Microsoft SDKs\Silverlight\v3.0\Toolkit\March 2009\Libraries”中

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-08-02T18:31:52.290

Silverlight Toolkit 的 2009 年 7 月版本在 MSI 设置的末尾添加了“打开欢迎页面”选项。

7 月版本的路径名称也略有不同，但使用欢迎页面（开始菜单中还添加了一个链接），您将始终可以快速找到它们。

选中该框将确保打开一个页面，其中包含有关已安装所有内容的详细信息，包括指向所有二进制文件、主题、文档等的链接。

此外，由于控件都是通过 AssemblyFolderEx 注册表项引用的，因此您可以在 C# 或 VB.NET 项目中添加 GAC 样式的引用...

```
<Reference Include="System.Windows.Controls.Input.Toolkit" /> 
```

只有在使用 Silverlight SDK 的机器上构建时才会起作用。

希望这是朝着正确方向迈出的一步。

# asp.net - 使用同一中继器的 ItemTemplate 中的下一个/上一个按钮重新绑定中继器

> ID：689245
> 
> 赞同：1
> 
> 时间：2009-03-27T10:37:20.013
> 
> 标签：asp.net, vb.net, repeater

抱歉，如果这篇文章看起来很啰嗦。

我有一个带有嵌套中继器的父中继器。

我的问题是我正在尝试使用“下一个”和“上一个”按钮重新绑定我的转发器（rptTabContent），因此也绑定了内部转发器，但是当我尝试在 ItemCommand 事件期间操纵这些链接的状态时，它们被覆盖绑定。

因此，如果在单击“下一个”或“上一个”链接后没有数据，我将无法禁用或启用这些按钮，这是我正在尝试做的。

嵌套的中继器在 7 列中显示了一周的数据。下一个按钮用于显示下一周的数据和前一周的数据。最初，前一个按钮是不活动的。

父中继器再次绑定，因为最初它循环出 4 个 div，每个 div 包含一个数据表。如果在一个中继器上按下一个下一步按钮，则所有表格都必须显示其接下来 7 天的数据。

每个中继器具有完全相同数量的项目。

最初在页面加载时，所有数据都正确绑定。

我知道我的收藏中第一项和最后一项的日期，因此我能够计算我需要绑定到我的父中继器的对象的日期范围。

HTML 如下

```
 <asp:Repeater ID="rptTabContent" runat="server" OnItemCommand="rptTabContent_ItemCommand">
        <ItemTemplate>
            <div id="<%# Eval("SlotTypeUrl") %>" class="delivery-timetable-container">
                <table cellpadding="0" cellspacing="0" border="0">
                    <asp:Repeater ID="rptDeliverySlots" runat="server">
                        <ItemTemplate>
                            <tr class="time-slots">
                                <th><asp:Label id="lblRowTime" runat="server"></asp:Label></th>
                                <asp:Repeater ID="rptDeliverySlot" runat="server">
                                    <ItemTemplate>
                                        <td id="tdDay" runat="server">
                                            <cc1:RepeaterRadioButton id="rptrdoDeliverySlot" groupname="del-times" runat="server" />
                                        </td>           
                                    </ItemTemplate> 
                                </asp:Repeater>                            
                            </tr>
                        </ItemTemplate>
                    </asp:Repeater>
                    <tr>
                        <td colspan="8">&nbsp;</td>
                    </tr>
                    <tr>
                        <td colspan="4">            
                                <div class="eco-rollover">
                                    <div>
                                        <img src="icon.gif" />
                                    </div>
                                </div>
                        </td>
                        <td colspan="4">
                            <asp:LinkButton id="lnkPreviousWeek" enabled="false"  runat="server" commandargument="Previous" cssclass="inactive">&lt; Previous week</asp:LinkButton>|
                            <asp:LinkButton id="lnkNextWeek" runat="server" commandargument="Next" cssclass="active" >Next week &gt;</asp:LinkButton>
                        </td>
                    </tr>
                </table>
            </div>
        </ItemTemplate>
    </asp:Repeater> 
```

我的 ItemCommand 事件在这里：

```
Protected Sub rptTabContent_ItemCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs) 
    If (e.Item.ItemType = ListItemType.Item) Or (e.Item.ItemType = ListItemType.AlternatingItem)
        Dim filteredProposedDeliveries  As New List(Of ProposedDeliverySlotDTO)
        Dim firstDate, lastDate As Date
        Dim startDate, endDate  As Date

        If (Session("FirstDeliveryDate") IsNot Nothing) AndAlso (Session("LastDeliveryDate") IsNot Nothing) Then

            firstDate = CType(Session("FirstDeliveryDate"), Date)
            lastDate  = CType(Session("LastDeliveryDate"),  Date) 

            Select Case e.CommandArgument.ToString()
                Case "Next"    
                    'Get new startDate using firstDate and store to use next time
                    'disable next button if startDate > lastDate
                Case "Previous"
                    'Get new startDate from current displayed date and overright stored startdate
                    'disable previous button if startDate < firstDate
            End Select

            endDate = startDate.AddDays(7)     

        End If

        'filteredProposedDeliveries = Get object between startDate and EndDate

        Dim slots As List(Of SlotType)  = PrepareSlotsForBinding(filteredProposedDeliveries)            

        Dim rptTabContent As Repeater = CType(e.Item.BindingContainer, Repeater)
        rptTabContent.DataSource = slots
        rptTabContent.DataBind()
    End If
End Sub 
```

如何在这些条件下管理我的“下一个”和“上一个”链接。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T14:35:54.323

您确定需要四次下一个/上一个按钮吗？

无论如何，请在 rptTabContent_ItemDataBound 上进行按钮管理。在 ItemCommand 上，您可以获得新的起点，获取数据并进行数据绑定。在 ItemDataBound 上，您将获得 Next 按钮和 Previous 按钮，并根据当前日期启用或禁用它们。作为默认状态（当没有数据时），这两个按钮都应该在标记中被禁用。

这是一个模拟四个项目的数据源的工作示例。

页

```
<asp:Repeater ID="Repeater1" runat="server" onitemcommand="Repeater1_ItemCommand" onitemdatabound="Repeater1_ItemDataBound">
    <ItemTemplate>
        <div>
            Label: <asp:Label ID="itemLabel" runat="server"></asp:Label><br />
            <asp:LinkButton id="lnkPreviousWeek" Enabled="false" runat="server" commandargument="Previous" cssclass="inactive">&lt; Previous week</asp:LinkButton>&nbsp;|&nbsp;
            <asp:LinkButton id="lnkNextWeek" Enabled="false" runat="server" commandargument="Next" cssclass="active" >Next week &gt;</asp:LinkButton>
            <hr />
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

代码

```
private int current = 1;

protected void Page_Load(object sender, EventArgs e)
{
    if (ViewState["current"] == null)
        ViewState["current"] = current;
    else
        current = (int)ViewState["current"];

    if (!IsPostBack)
    {
        Repeater1.DataSource = GetData(current);
        Repeater1.DataBind();
    }
}

private List<int> GetData(int start)
{
    //pseudo data; simulates a page of 2 records
    List<int> ds = new List<int>();
    ds.Add(start);
    ds.Add(start + 1);

    return ds;
}

protected void Repeater1_ItemCommand(object source, RepeaterCommandEventArgs e)
{
    if ((string)e.CommandArgument == "Next")
        current++;
    else if ((string)e.CommandArgument == "Previous")
        current--;

    ViewState["current"] = current;

    Repeater1.DataSource = GetData(current);
    Repeater1.DataBind();
}

protected void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    LinkButton prev = (LinkButton)e.Item.FindControl("lnkPreviousWeek");
    LinkButton next = (LinkButton)e.Item.FindControl("lnkNextWeek");

    //here 1 and 3 are artificial boundaries for data for the sake of example
    if (current > 1)
        prev.Enabled = true;
    if (current < 3)
        next.Enabled = true;

    Label label = (Label)e.Item.FindControl("itemLabel");
    label.Text = e.Item.DataItem.ToString();
} 
```

# php - mysql用php拆分多查询字符串

> ID：689257
> 
> 赞同：0
> 
> 时间：2009-03-27T10:40:54.250
> 
> 标签：php, mysql, multi-query

我想创建一个数据库恢复功能，该功能将解析使用 phpMyAdmin 制作的转储并执行所有查询。

我已经有一个执行查询的 MySQL 类，但它只知道如何执行单个查询。我正在寻找一种将文件内容拆分为单个查询的方法。

我试图玩 preg_split ......但没有设法让它工作。

```
$queries = preg_split('/[(.+);\s*\n/', $content, -1, PREG_SPLIT_NO_EMPTY); 
```

我不太擅长正则表达式。有没有办法可以实现我的目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T11:02:46.800

不要尝试用正则表达式解析 sql。如果`;`sql 字符串中有某个地方怎么办？

我会尝试[http://pear.php.net/package/SQL_Parser](http://pear.php.net/package/SQL_Parser)或任何[其他 php mysql 解析器](http://www.google.com/search?q=php+sql+parser)。另请参阅SO 上的[PHP MySQL SQL 解析器（插入和更新）](https://stackoverflow.com/questions/283087/php-mysql-sql-parser-insert-and-update)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:04:45.077

最终我设法找到了正确的正则表达式：

```
$queries = preg_split('/[.+;][\s]*\n/', $content, -1, PREG_SPLIT_NO_EMPTY); 
```

它在 ; 之后拆分查询 签名并且即使查询分布在多行或查询包含也不会中断；因为它在一行的末尾寻找它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-11T07:58:19.340

我认为当您在 $content.

# jquery - IE7 JQuery、Ajax 和 CSS 的问题

> ID：689260
> 
> 赞同：1
> 
> 时间：2009-03-27T10:42:07.927
> 
> 标签：jquery, ajax, internet-explorer

在一个简单的网页中，我使用*load(url)将一些新的 HTML 加载到***div** 中在大多数浏览器中工作正常，但令人惊讶的是，IE7 的行为不同。所有其他浏览器都将页面 CSS 样式应用于新加载的 HTML，但 IE7 没有。

 *有任何想法吗？

肯

* * *

**更新** 新的 HTML 只是一个代码片段，例如

```
<div class="classname">
blah blah blah
</div> 
```

* * *

**更新**我想我可以称之为好的。这不是我实际上在做的事情，而是一个重现问题的简化版本......

```
.
.
.    
google.load("jquery", "1.3.2"); 
    google.setOnLoadCallback(function() {
       $(document).ready(function() {
         $("#nav-home").click(function() {
           $("#girc-content").load("home.html");
         });
.
.
. 
```

**更新**在进一步调查中，这个问题似乎比我想象的更奇怪。

我尝试了 Steerpike 的建议，因为我最初认为问题在于没有应用 CSS 样式。

但是，现在似乎只应用了一些样式。例如，应用了`<h2>`标签的文本颜色属性，但不应用标签的宽度属性`<div>`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T10:48:19.410

鉴于额外的信息，采取2...

样式是否未在主 HTML 页面或您正在加载的页面中应用？如果它们在您正在加载的页面中，那么 IE 似乎会从 XMLHttpRequest 对象中删除脚本和样式标记。

鉴于事实并非如此，而且我很感兴趣，我构建了一个样本：

```
<html>
<head>
<title>test</title>
<style type="text/css">
#girc-content { border: 1px solid black; width: 100px }
h3 { color: red; }
</style>
<script src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load("jquery", "1.3.2"); 
google.setOnLoadCallback(function() {
  $(document).ready(function() {
    $("#nav-home").click(function() {
      $("#girc-content").load("test2.html");
    });
  });
});
</script>
</head>
<body>
<div id="girc-content">
blah blah blah
</div>
<input type="button" value="click me" id="nav-home">
</body>
</html> 
```

和 test2.html：

```
<html>
<head>
</head>
<body>
<h3>This is a test</h3>
</body>
</html> 
```

这在 IE8 标准和兼容模式下非常适合我（抱歉，不再使用 IE7）。

当我复制您的 google onload 片段时，我确实注意到您缺少一些右括号/括号。这只是剪切和粘贴错误还是您的 Javascript 有问题？它可以解释不一致的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T10:59:35.187

加载后再次尝试“*触摸*”内容。最简单的方法往往是在 innerHTML 中添加一个空字符串

```
$("#nav-home").click(function() {
    $("#girc-content").load("home.html");
    $("#girc-content")[0].innerHTML += '';
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-17T09:01:01.627

该链接帮助了我；本质上，将样式标签添加到头部，甚至是动态地，通过 ie 应用样式。我将此添加到 onready 处理程序的顶部，并且效果很好。

[http://topsecretproject.finitestatemachine.com/2009/09/how-to-load-javascript-and-css-dynamically-with-jquery/](http://topsecretproject.finitestatemachine.com/2009/09/how-to-load-javascript-and-css-dynamically-with-jquery/)

```
$("head").append("<link>");
css = $("head").children(":last");
css.attr({
  rel:  "stylesheet",
  type: "text/css",
  href: "/javascripts/jwysiwyg/jquery.wysiwyg.css"
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-17T12:58:07.090

我有类似的问题 - IE8 有时会在 ajax jQuery 函数加载的内容中应用样式问题。我不知道为什么，但这有帮助：

```
$.ajax({
url: 'content.html',
success: function(data) {
   $('#content').html(data); //styles doeas not appear in ie8
   document.getElementById('content').innerHTML = data; /* ie8 - now it works oO */
} 
```

# frameworks - Web 服务中的语言环境实例

> ID：689262
> 
> 赞同：0
> 
> 时间：2009-03-27T10:42:59.627
> 
> 标签：frameworks, service, local, cxf

如何使用 java.util.Locale 的实例作为参数或生成 web 服务？

我的网络服务使用 Apache CXF。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T16:57:15.730

The only way to do so is to use an XmlTypeAdapter to map the Locale object into something that JAXB can understand. Check the JAXB docs for instructions about the type adapters. CXF also has an example in the java_first_jaxws sample folder for mapping some interface things into stuff that JAXB can understand. Very similar concept here.

# perl - 为什么我对 Perl 5.10、Mason 和 Apache 感到恐慌？

> ID：689276
> 
> 赞同：2
> 
> 时间：2009-03-27T10:46:44.983
> 
> 标签：perl, apache, mod-perl, mason, panic

我正在使用 Perl 5.10、[HTML::Mason](http://www.masonhq.com/)和 apache 2.2 开发应用程序。这是我第一次将 Perl 5.10 用于大型项目。我每隔一段时间就会有一种奇怪的行为。该应用程序因一个非常奇怪的错误而死：

```
panic: attempt to copy value
to a freed scalar b87acf34 at ... 
```

我想我的问题是 Perl 5.10，因为我以前从未经历过这种情况，还是其他一些错误的依赖？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T13:02:44.003

不确定这是否与您的错误有关（可能不是），但 mod_perl+mason+perl5.10 是不行的。Perl 5.10 引入了至少一个在某些情况下会导致分段错误的大错误：[http ://bugs.debian.org/cgi-bin/bugreport.cgi?bug=480480#24](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=480480#24)

# language-agnostic - 一年最多有多少个工作日？你会如何编码？

> ID：689282
> 
> 赞同：7
> 
> 时间：2009-03-27T10:50:37.300
> 
> 标签：language-agnostic, calendar

为了为一年中的每个工作日为数组元素分配足够的空间，我试图计算出我需要的最大行数。这让我想到了如何解决这个问题。

您是否必须计算接下来 n 年每年的天数并继续计算？或者（我怀疑）有没有更优雅的解决方案，涉及数字 365、366、2 和 7？

哪些图书馆会有所帮助？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-27T10:57:11.480

一年中的最大天数是 366，这给了我们 52 整周。在这 52 周中，至少有 52 * 5 = 260 个工作日。

我们剩下 2 天 (52 * 7 = 364)，这 2 天可能是工作日。

所以一年中的最大工作日数是 262。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-27T10:58:16.093

首先要记住的是，一年中只有 14 种可能的日子模式：一周中的每一天有两种（闰年一个，非闰年一个）。

要记住的第二件事是，一年中的前 364 天是无关紧要的，因为那是 7 的倍数（因此前 364 天总是有 5 x 52 = 260 个工作日）。

所以你只关心最后1-2天。

它们都可以是工作日，所以问题的答案是 262。

如果你想要一个快速算法来计算任何给定年份的工作日数，你只需要想出一个公式，将年份变成正确的年份模式。鉴于闰年是可预测的，这应该不会太难。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T11:14:18.927

[cletus](https://stackoverflow.com/questions/689282/what-is-the-maximum-number-of-weekdays-in-a-year-how-would-you-code-it/689304#689304)和[GvS](https://stackoverflow.com/questions/689282/what-is-the-maximum-number-of-weekdays-in-a-year-how-would-you-code-it/689301#689301)的答案 在数学上是正确的，但我想知道你是否付出了太多努力。如果您只需要确保您的阵列足够大，则以 53 周和 5 个工作日计算，即 265 天。由于一年总是 52 周长，所以只要四舍五入到下一个完整整数总是会给你足够的元素。

如果您的数组元素的内存消耗不是很大，那么您可以忍受少量的浪费，因为您永远不会使用这些元素。足够好就是足够好。

您将节省至少 10 分钟的时间来制定确切的解决方案（嗯，这就是我可能至少需要的 ;-)，您可以使用这些解决方案进行编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-01T07:02:15.440

根据这个网站

[http://kalender-365.de/weekdays.php](http://kalender-365.de/weekdays.php)

从 2012 年 2 月 1 日到 2013 年 2 月 1 日，共有 263 个工作日，超过了上述 262 个的最大值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T11:16:34.037

以下是使用 C# (.NET Framework) 计算特定年份的确切工作日数的方法：

```
using System;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            // in which year which should count week days
            var year = DateTime.Now.Year;

            // first day of this year
            var date = new DateTime(year, 1, 1);

            var count = 0;

            // if date is still within our year, proceed
            while (date.Year < year + 1)
            {
                if (date.DayOfWeek == DayOfWeek.Monday ||
                    date.DayOfWeek == DayOfWeek.Tuesday ||
                    date.DayOfWeek == DayOfWeek.Wednesday ||
                    date.DayOfWeek == DayOfWeek.Thursday ||
                    date.DayOfWeek == DayOfWeek.Friday)
                {
                    count++;
                }
                date.AddDays(1);
            }

            Console.Write(count);
        }
    }
} 
```

# javascript - 是否有支持日期对象（标签）的 Javascript 图表 API？

> ID：689283
> 
> 赞同：1
> 
> 时间：2009-03-27T10:50:50.823
> 
> 标签：javascript, date, charts

有人知道 Javascript 图表 API 可以处理两个轴上日期值的缩放和标签吗？如果我想使用 Google Chart API，看起来我必须对标签进行手动客户端计算。

我的数据集在任一轴上的日期可能都很稀疏，因此智能标签计算将为我省去很多麻烦。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T15:42:36.037

您可能希望查看[flot](http://code.google.com/p/flot/)以获取 JavaScript 图表 API。（我不知道它是否会处理您的特定标签问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T21:16:18.730

看看[Google Chart API](http://code.google.com/apis/chart/)。我从未使用过它，但我见过人们使用它。根据[文档中的示例](http://code.google.com/apis/chart/labels.html#chart_legend)，您可以在轴上放置日期标签。

# c# - 替换字符串中的每个字母？

> ID：689286
> 
> 赞同：1
> 
> 时间：2009-03-27T10:52:03.300
> 
> 标签：c#, string

这就是我到目前为止所写的：

```
string omgwut;
omgwut = textBox1.Text;
omgwut = omgwut.Replace(" ", "snd\\space.wav");
omgwut = omgwut.Replace("a", "snd\\a.wav"); 
```

现在，问题是这段代码会变成

```
"snd\space.wav" 
```

进入

```
"snd\spsnd\a.wavce.wsnd\a.wavv" 
```

在第四行。不是我想要的！现在我知道我不擅长 C#，所以这就是我问的原因。

解决方案会很棒！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T10:58:05.800

您仍然需要编写 getSoundForChar() 函数，但这应该可以满足您的要求。不过，我不确定您所要求的是否会执行您想要的操作，即播放相关角色的声音。为此，您最好将它们放在 List<string> 中。

```
StringBuilder builder = new StringBuilder();
foreach (char c in textBox1.Text)
{
    string sound = getSoundForChar( c );
    builder.Append( sound );
}
string omgwut = builder.ToString(); 
```

这是一个开始：

```
public string getSoundForChar( char c )
{
     string sound = null;
     if (sound == " ")
     {
         sound = "snd\\space.wav";
     }
     ... handle other special characters
     else
     {
         sound = string.Format( "snd\\{0}.wav", c );
     }
     return sound;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T10:55:59.237

问题是您正在对数据进行多次传递。尝试在循环中逐步遍历字符串的字符，并将每个 'from' 字符替换为其 'to' 字符串。这样，您就不会返回字符串并重新执行那些已替换的字符。

此外，创建一个单独的输出字符串或数组，而不是修改原来的。理想情况下使用 StringBuilder，并将新字符串（或原始字符，如果不替换此字符）附加到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:01:06.557

我不知道在 C# 中同时替换不同字符的方法。

您可以遍历所有字符并从中构建结果字符串（如果输入字符串可能很长，请使用字符串构建器）。对于每个字符，您将其替换附加到结果字符串（构建器）。

但是你想做什么？我想不出没有任何分隔符的附加文件路径的有用应用程序。

# c# - 使gridview数据源留在界面中而不是向下转换为对象

> ID：689288
> 
> 赞同：4
> 
> 时间：2009-03-27T10:52:28.870
> 
> 标签：c#, asp.net, gridview, datasource

我有一个 C# Web 应用程序，其中有一个带有 List<> 接口的 gridview。列表中存在三种实现接口的对象类型。

我将gridviews 数据源设置为列表并调用databind。当我运行应用程序时，我收到以下错误：

```
{"Property accessor 'Name' on object 'Bailey.Objects.Company' threw the following exception:'Object does not match target type.'"} 
```

我改变了列表中的对象顺序，发现第一个对象类型工作得很好，但是当它找到另一个对象的第一个实例时，它会抛出这个错误。

```
List<IBaileyObject> listToDisplay = listofItems;
GridViewItemList.DataSource = listToDisplay;
GridViewItemList.DataBind(); 
```

我想要的是数据源和绑定保留在接口上，而不是像它看起来正在发生的那样向下转换为对象。

这是因为 List<> 将对象作为它自己而不是接口返回，还是因为它在 gridview 中的某些东西正在向下投射？

还是我走错了路？

我希望有人有办法解决这个问题。

谢谢

乔恩·霍金斯

**编辑**

```
 <asp:TemplateField HeaderText="Selected">
                    <ItemTemplate>
                        <asp:CheckBox runat="server" ID="chkbox" Width="10%" Enabled="true" AutoPostBack="false" />
                    </ItemTemplate>
                </asp:TemplateField>

    <asp:BoundField DataField="ID" HeaderText="ID" Visible="False" />
    <asp:BoundField DataField="Name" HeaderText="Name" />
    <asp:BoundField DataField="TypeName" HeaderText="Type" />
</Columns>
<FooterStyle BackColor="#1C5E55" Font-Bold="True" ForeColor="White" />
<RowStyle BackColor="#E3EAEB" />    

<PagerStyle BackColor="#666666" ForeColor="White" HorizontalAlign="Center" />
<SelectedRowStyle BackColor="#C5BBAF" Font-Bold="True" ForeColor="#333333" />
<HeaderStyle BackColor="#1C5E55" Font-Bold="True" ForeColor="White" />
<EditRowStyle BackColor="#7C6F57" />
<AlternatingRowStyle BackColor="#F8F8F8" /> 
```

该接口公开了 Name、ID 和 TypeName。

" HeaderText="ID" Visible="False" />

给出不能应用索引器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-06T16:01:33.033

我真的很喜欢这个解决方案：http: [//iridescence.no/post/FixingBoundFieldSupportforCompositeObjects.aspx](http://iridescence.no/post/FixingBoundFieldSupportforCompositeObjects.aspx)

它使用自定义 BoundField 类，该类使用 Eval 返回值。比在 ASPX 页面中使用 Eval 好一点...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:34:16.250

你能发布一些你的 GridView 代码（特别是你引用你的 IBaileyObject 属性的地方）吗？

不知道您使用的是什么语法会使事情变得困难，但是您是否尝试过这样做：

```
<%# (((IBaileyObject)Container.DataItem)["PropertyX"]) %> 
```

希望这可以帮助

**发布代码后编辑**

我认为这是因为您使用的是“BoundField” - 他们不够聪明，无法确定您所指的成员来自哪里。我的建议是将您的 BoundFields 转换为数据绑定语法：

要么：`<%# Eval("Id") %>` 要么，`<%# (((IBaileyObject)Container.DataItem)["Id"]) %>`

如果做不到这一点，请遵循[此博客文章](http://iridescence.no/post/FixingBoundFieldSupportforCompositeObjects.aspx)中的建议并创建自定义绑定字段控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-26T03:35:32.120

```
GridViewItemList.DataSource = listToDisplay.Select(x => new 
                              {
                                  Id = x.Id,
                                  Name = x.Name                        
                              })
                              .ToList();
GridViewItemList.DataBind(); 
```

# xml - 如何按顺序引用“下一个”（尚不存在）XML 节点？

> ID：689291
> 
> 赞同：0
> 
> 时间：2009-03-27T10:53:54.623
> 
> 标签：xml, xpath, xquery

所以要展开...

我有一些 XML

```
<root>
    <list>
        <item value="9"/>
        <item value="3"/>
        <item value="1"/>
        <item value="8"/>
        <item value="4"/>
    </list>
</root> 
```

我有一个 XPath“/root/list/item [4]”，我相信它将检索第 5 个“item”元素（其 value 属性为 4）

这表明 XPath "/root/list/item [5]" 将引用（尚不存在的）第 6 项。

**我想要的是一个 XPath 表达式，它将引用“下一个”（尚不存在）“项目”元素，而不管当前有多少项目......**

**我假设这将传递一个表达式（它将计算当前元素的数量）而不是硬编码的数字。**

我知道我会怎么做，但根本找不到我应该怎么做……令人沮丧。

**更新**：澄清......我想返回“最后一个项目节点之后的项目节点”。这些属性只是为了区分现有节点）。我很欣赏这将返回一个空的节点集。

**更新**：嗯，我有我的答案，所以我想这是公平的，我解释了为什么我想要这个:)

基本上xPath被一些.Net代码用作写地址而不是读地址。

我将不存在位置的 xPath 传递给 EnsureNodeExists 例程。（注意：我无法更改此 EnsureNodeExists 例程）代码将迭代 xPath 的每个元素，如果不存在则创建它，然后将其设置为下一次迭代的父级。

因此，我可以使用“/root/list/item[position() = last()]/following-sibling::item[1]” 3 次调用此代码，这将导致创建 3 个项目节点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T11:00:21.330

首先，您的 XPath：

```
/root/list/item[4] 
```

获取第四项（因为`[4]`谓词是 的简写`[position() = 4]`）。

要使用`@value`4 获取项目，请使用：

```
/root/list/item[@value = '4'] 
```

如果你想用`@value`4 获取项目之后的项目，请使用：

```
/root/list/item[@value = '4']/following-sibling::item[1] 
```

这翻译成英语是“从`/root/list/item`with开始`@value = '4'`，查看以下名为 'item' 的兄弟姐妹并取第一个”。

即使没有以下项目，这也有效。在这种情况下，选定的节点集将为空。

编辑：请注意，如果有多个值为 4 的项目，则上述表达式产生的结果可能是意外的。您将获得值 4的项目之后的*所有*项目。这将最多返回一项：

```
/root/list/item[@value = '4'][1]/following-sibling::item[1] 
```

要引用列表中的最后一个节点，请使用：

```
/root/list/item[position() = last()] 
```

可以在此处找到解释[XPath 轴的漂亮视觉效果：http:](http://www.w3.org/TR/xpath#axes) [//nwalsh.com/docs/tutorials/xsl/xsl/graphics/axes.gif](http://nwalsh.com/docs/tutorials/xsl/xsl/graphics/axes.gif)（[较大教程](http://nwalsh.com/docs/tutorials/xsl/xsl/slides.html)的一部分）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T11:28:21.530

如果你只是想让一个表达式返回一个空的节点集，我认为一般要做的事情是类似的`/parent::node()`，因为根没有父母，所以它是空的。

我想你可以做类似的事情`/root/list/item[position() = (last() + 1)]`，但它会给你与任何不返回节点的结果相同的结果。所以我不太确定你实际上想要完成什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T11:02:47.113

尝试以下兄弟表达式

可以在[此处找到有关此类事情的帮助](http://www.w3schools.com/Xpath/xpath_axes.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-04T14:39:49.287

如果您要做的是直接在集合中的最后一个节点之后添加一个新节点，那么在 MSXML 中，您可以在父元素（列表）上使用 appendChild。它将作为父节点的最后一个子节点附加。

# facebook - 如何在 Facebook 上实现共享时将特定图像显示为缩略图？

> ID：689295
> 
> 赞同：99
> 
> 时间：2009-03-27T10:54:49.287
> 
> 标签：facebook, sharethis

我正在尝试实现共享此方法。我使用的代码如下

```
http://www.facebook.com/share.php?u=my_website_url 
```

现在，当 Facebook 显示它时，它会在左侧显示一些缩略图。这些图片来自我的网站。如何选择特定图像作为缩略图或至少停止显示缩略图？

你可以通过我的[博客地址](http://www.facebook.com/share.php?u=http://anothersilverlight.blogspot.com)查看。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2011-01-21T11:30:00.603

根据 Facebook 的规范，使用如下代码：

```
<meta property="og:image" content="http://siim.lepisk.com/wp-content/uploads/2011/01/siim-blog-fb.png" /> 
```

资料来源：[脸书分享](http://developers.facebook.com/docs/share)

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-03-27T11:01:19.130

这篇博文似乎有你的答案： http: ~~[//blog.capstrat.com/articles/facebook-share-thumbnail-image/](http://blog.capstrat.com/articles/facebook-share-thumbnail-image/)~~

具体来说，使用如下标签：

```
<link rel="image_src" 
      type="image/jpeg" 
      href="http://www.domain.com/path/icon-facebook.gif" /> 
```

图像的名称必须与示例中的名称相同。

单击“确保预览有效”

注意：标签可能是正确的，但 Facebook 仅每 24 小时抓取一次，根据他们的文档。使用 Facebook Lint 页面将图像导入 Facebook。

[http://developers.facebook.com/tools/lint/](http://developers.facebook.com/tools/lint/)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2010-12-14T15:52:34.437

根据他们的文档，我的标签是正确的，但 Facebook 每 24 小时才刮一次。使用 Facebook Lint 页面将图像导入 Facebook。

在此处输入您的 URL，FB 将更新您页面中的元数据：

[https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)（更新链接）

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-01-16T23:27:38.460

Facebook 使用[Open Graph Protocol来破译在](https://developers.facebook.com/docs/opengraph/)[共享对话框](https://developers.facebook.com/docs/reference/dialogs/feed/) 或 Facebook 上的新闻提要中 预览您的 URL 时要显示的信息`og:tags`。

包含信息，`og:tags`例如：

*   页面标题
*   页面类型
*   网址
*   网站名称
*   页面描述
*   页面管理员的 Facebook user_id（在 facebook 上）

这是一些示例（取自[facebook 文档](https://developers.facebook.com/docs/opengraph/)）`og:tags`

`<meta property="og:title" content="The Rock"/>`
`<meta property="og:type" content="movie"/>`
`<meta property="og:url" content="http://www.imdb.com/title/tt0117500/"/>`
`<meta property="og:image" content="http://ia.media-imdb.com/rock.jpg"/>`

一旦您实现了正确的标记并设置了它们的值，您就可以使用[Facebook Debugger](https://developers.facebook.com/tools/debug)`og:tags`测试 facebook 如何查看您的 URL 。调试器工具还将突出显示它在页面上发现或缺少的任何问题。 要记住的一件事是，facebook**确实**对此信息进行了一些缓存，因此为了使更改生效，您的页面将不会被*刮掉*，如文档中所述：`og:tags`

 ***> ## 编辑元标签
> 
> 您可以通过更新页面的标签来更新页面的属性。请注意，og:title 和 og:type 最初只能编辑 - 在您的页面收到 50 个赞后，标题变为固定，在您的页面收到 10,000 个赞后，类型变为固定。这些属性是固定的，以避免让已经喜欢该页面的用户感到惊讶。达到这些限制后更改标题或类型标签没有任何作用，您的页面将保留原始标题和类型。
> 
> 要使更改反映在 Facebook 上，您必须强制抓取您的页面。当页面的管理员单击“赞”按钮或将 URL 输入~~Facebook URL Linter~~ [Facebook 调试器](https://developers.facebook.com/tools/debug)时，该页面被抓取...

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-09-15T20:45:18.733

我看到提供的所有答案都是正确的。但是，一个重要的细节被忽略了：图像的大小必须至少为 200 X 200 像素，否则 Facebook 将用符合页面标准的第一个可用图像替换缩略图。另一个事实是，至少需要包含 Facebook 要求的 3 个元数据才能使 og:image 生效：

```
<meta property="og:title" content="Title of the page" />
<!-- NEXT LINE Even if page is dynamically generated and URL contains query parameters -->
<meta property="og:url" content="http://yoursite.com" />
<meta property="og:image" content="http://convertaholics.com/convertaholics-og.png" /> 
```

使用 Facebook 调试器调试您的页面并修复所有警告，它应该像魅力一样工作！ [https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-09-20T01:38:42.010

我遇到了同样的问题，相信我已经解决了。我使用这里提到的链接元标记来指向我想要的图像，但关键是如果你这样做，FB 不会拉出任何其他图像作为选择。此外，如果您的图像太大，您将没有任何选择。

这是我修复网站的方法[http://gnorml.com/blog/facebook-link-thumbnails/](http://gnorml.com/blog/facebook-link-thumbnails/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-11-02T12:06:57.697

以下是这一切的工作原理：

1.  您需要能够访问您正在共享的特定网页上的 HTML。如果您使用通用头文件，它也可能在站点范围内工作。我没有尝试过，但它应该可以工作。如果你这样做，你只会为所有页面获得相同的图像。

2.  您需要将这些 HTML 元标记添加到 . 如果你把它放在 . 确保根据您的 a) 图片、b) 描述、c) URL 和 d) 标题进行自定义。

一个真实的例子。

```
<meta property="og:image" content="http://www.coachesneedsocial.com/wp-content/uploads/2014/12/BannerWCircleImages-1.jpg" />

<meta property="og:description" content="Coaches share their secrets to success so you can rock 2015." />

<meta property="og:url"content="http://www.coachesneedsocial.com/coacheswisdomtelesummit/" />

<meta property="og:title" content="Coaches Wisdom Telesummit" /> 
```

3.  节省
4.  打开一个新的 Facebook 帖子，然后重试您要分享的页面。
5.  如果您遇到问题……您可以使用此 Facebook 工具对其进行调试。它看起来比实际更令人讨厌。当您在 URL 中发布要分享时，它会告诉您 Facebook 看到的内容。

[https://developers.facebook.com/tools/debug/og/object/](https://developers.facebook.com/tools/debug/og/object/)

大提示.. 确保 HTML 中的“引号”是相同的（它们应该看起来像 2 个直线标记，没有曲线……有时程序会将它们更改为不同的字体，这会弄乱代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-24T01:00:49.007

[在 Facebook 上分享：如何通过自定义图像、标题和文本来改进结果](http://rickmanelius.com/article/sharing-facebook-how-improve-your-results-customizing-image-title-and-summary-text#Automatic)

从上面的链接。为了获得最佳共享，您需要在 HTML 中建议 3 条数据：

*   标题
*   简短的介绍
*   图片

这通过以下方式完成，放置在 HTML 的“head”标签内：

*   标题：`<title>INSERT POST TITLE</title>`
*   图片：`<meta property=og:image content="http://site.com/YOUR_IMAGE.jpg"/>`
*   描述：`<meta name=description content="INSERT YOUR SUMMARY TEXT"/>`

如果您的网站是静态 HTML，则您必须使用 HTML 编辑器对每个页面执行此操作。

如果您使用的是 Drupal 之类的 CMS，您可以将其中的大部分自动化（参见上面的链接）。如果您使用 wordpress，您可能可以使用 Drupal 示例作为指导来实现类似的东西。我希望你发现这些有用。

最后，您始终可以手动编辑您的分享帖子。参见[这个带有插图的例子](http://rickmanelius.com/article/sharing-facebook-how-improve-your-results-customizing-image-title-and-summary-text#Manual)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-16T21:20:50.840

我上周在一个[网站](http://www.zoetwithlove.nl/)上也遇到了问题。我实现了一个like box并测试了like box。然后我继续在我的标题中添加一个图像（ob:image 元数据）。我的 Facebook 通知中仍然没有显示正确的图像。

我尝试了所有方法，得出的结论是，每个赞按钮的实现都被缓存了。因此，假设您为 url A 上的 Like 按钮计时，然后在标题中指定一个图像，然后通过再次单击 url A 上的 Luke 按钮对其进行测试。当页面被缓存时，您将看不到图像。当您单击页面 B 上的“Like”按钮时，该图像将显示。

要重置缓存，您必须使用上面提到的 lint 调试器工具，并验证缓存的所有 Url ......这是唯一对我有用的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-15T09:23:18.370

我发现将 Facebook Open Graph 设置为每篇 Joomla 文章的最简单方法是放在 com_content/article/default.php 覆盖中，下一个代码：

```
$app    = JFactory::getApplication();
$path   = JURI::root();

$document = JFactory::getDocument();
$document->addCustomTag('<meta property="og:title" content="YOUR SITE TITLE" />');
$document->addCustomTag('<meta property="og:name" content="YOUR SITE NAME" />');
$document->addCustomTag('<meta property="og:description" content="YOUR SITE DESCRIPTION" />');
$document->addCustomTag('<meta property="og:site_name" content="YOUR SITE NAME" />');
if (isset($images->image_fulltext) and !empty($images->image_fulltext)) : 
    $document->addCustomTag('<meta property="og:image" content="'.$path.'<?php echo htmlspecialchars($images->image_fulltext); ?>" />');
else :
    $document->addCustomTag('<meta property="og:image" content="'.$path.'images/logo.png" />');
 endif; 
```

这会将元 og 标记放在头部，其中包含当前文章的详细信息。

# c# - 以编程方式将 Word 文档插入现有文档 (Word 2007)

> ID：689296
> 
> 赞同：1
> 
> 时间：2009-03-27T10:54:52.483
> 
> 标签：c#, api, insert, word-2007

我有一个 Word 2007 文档，我想在其中插入一个现有的 Word 文档 - 同时保留两个文档的页眉/页脚、图形、边框等。

我正在使用 C# 中的 Word API 执行此操作。

听起来很简单，我的意思是您肯定只使用“InsertFile”方法...除了在 Word 2007 中，“插入文件”功能现在实际上是“从文件中插入文本”，它就是这样做的 - 省略了页面边框, 图形和页脚等。

好吧，我将使用复制和粘贴来代替，就像这样......

```
_Document sourceDocument = wordApplication.Documents.Open(insert the 8 million by ref parameters Word requries)
sourceDocument.Activate(); // This is the document I am copying from 
wordApplication.Selection.WholeStory();
wordApplication.Selection.Copy();
targetDocument.Activate(); // This is the document I am pasting into
wordApplication.Selection.InsertBreak(wdSectionBreakNextPage);
Selection.PasteAndFormat(wdFormatOriginalFormatting);
wordApplication.Selection.InsertBreak(wdSectionBreakNextPage); 
```

它可以满足您的期望，获取源文档，选择所有内容，复制它然后将其粘贴到目标文档中。因为我在粘贴之前添加了分节符，所以它还保留了两个文档的边框、页眉/页脚。

但是 -**现在这是我遇到问题的地方。**如果我粘贴在目标文档的*末尾*，则粘贴*仅*包括边框、标题等。如果我将它粘贴在中间 - 尽管前面有分节符，那么只有文本被粘贴并且标题和边框等会丢失。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:01:27.160

书签功能会起作用吗？InsertFile 包含从中获取的参数，这可能会解决问题。你可能已经考虑过了

[http://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.bookmark.insertfile.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.bookmark.insertfile.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-18T19:04:51.637

这种对我有用。仍在寻找更好的解决方案。请务必添加对 Interop.Word 的引用。我知道这是一个旧线程，我正在使用 Word 2016，但我搜索了很长时间，不得不将解决方案拼凑在一起。

```
using Word = Microsoft.Office.Interop.Word;
var wordApp = new Word.Application();
wordApp.Visible = true;
wordApp.Documents.Add(@"C:\workingtemplate.dotx");
//Open is for an existing document. 
//Add is to use a template.
//Get the range to be able to then collapse and have the correct insertion point
var rng = wordApp.ActiveDocument.Range();
rng.Collapse(Word.WdCollapseDirection.wdCollapseEnd);
rng.InsertBreak(Word.WdBreakType.wdPageBreak);
rng.InsertFile(@"C:\temp.docx"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-31T14:49:01.547

我实际上正在研究类似的东西，奇怪的是发现了一个用 C# 编写的 powershell cmdlet 库，您可能会发现它很有用：

[用于 Open XML 的 Powertools](http://powertools.codeplex.com/)

如果相同的图像位于文档的多个部分，那么继承的页眉和页脚以及无法正确复制图像引用仍然存在一些问题，但是很多结构已经到位。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-04-01T06:38:55.547

将 WORD 文档插入到另一个 WORD 2007 文档中 我发现 WORD 2007 成功的唯一方法是...打开要添加页面的文档，然后转到功能区上的“插入”选项卡，查看“文本”部分（与文本框、艺术字等相同的位置）并选择“对象”，出现下拉菜单，然后选择“文件中的文本”。从这里您只需选择要插入的文档并完成，您可能需要进行一些细微的调整，但它们的格式都正确，请务必将光标放在您要插入新内容的位置。希望这可以帮助

# .net - .Net 托管（灵活的中等信任）

> ID：689300
> 
> 赞同：1
> 
> 时间：2009-03-27T10:56:46.817
> 
> 标签：.net, hosting, medium-trust

对于具有允许使用反射的灵活中等信任规则的廉价 .Net 托管有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T10:59:08.557

*   **[GoDaddy 托管](http://www.godaddy.com)**（[信息](http://www.bizshark.com/company/godaddy.com)）- 非常便宜，每月 5 美元。并且最受欢迎。
*   **[DiscountASP.NET](http://www.discountasp.net)** ( [info](http://www.bizshark.com/company/discountasp.net) ) - 更广泛，每月 10 美元以上。好消息是他们专注于 .NET
*   **[SoftSys Hosting](http://www.softsyshosting.com/)** - 小公司。但它们更灵活。他们还专注于 Windows 托管解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-30T17:33:00.217

[www.gearhost.com](http://www.gearhost.com)为您免费提供 100 个完全信任的 .NET、PHP 站点和 MSSQL 或 MySQL 数据库，无需信用卡。在开发过程中完美，然后在您准备好后扩展到付费（5 美元）。在所有应用程序上具有高可用性和负载平衡的完整云环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-02T20:59:26.333

Register.com 是一个很好的网站

# delphi - 德尔福 - 树视图

> ID：689312
> 
> 赞同：2
> 
> 时间：2009-03-27T10:59:27.947
> 
> 标签：delphi, delphi-2009, delphi-2006

我正在为 delphi 寻找数据感知树视图

什么是最好用的？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-27T12:55:46.017

Virtual TreeView 速度最快，功能最多，最好而且免费！（对于数据知道有它的免费descants，也在下一页）

你会在这里找到它： [softgems 上的虚拟树视图控件](http://www.soft-gems.net/index.php/controls/virtual-treeview)

这是一个教程视频（德语）： [DelphiPraxis Stammtisch Videos](http://www.delphipraxis.net/videos#Stammtisch_2)

德国杂志“entwickler magazin”版本：02/08、03/08 和 04/08 也有一位导师。 [恩特维克勒杂志](http://entwickler-magazin.de/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-27T11:16:26.143

我会推荐[DevExpress](http://www.devexpress.com/Products/VCL/ExQuantumTreeList/) QuantumTreeList。它看起来非常好，速度快并且可以感知数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T12:45:07.383

虚拟树视图

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-30T15:07:42.630

这是（不容易找到）VirtualTreeView SVN 存储库网址：

~~svn://www.soft-gems.net/library/VirtualTreeview~~

**更新：**迈克将来源移至谷歌代码：

[http://virtual-treeview.googlecode.com/svn/trunk](http://virtual-treeview.googlecode.com/svn/trunk)

# sharepoint-2007 - 将超链接格式化为自定义列表架构中的图片

> ID：689317
> 
> 赞同：1
> 
> 时间：2009-03-27T11:01:17.430
> 
> 标签：sharepoint-2007, moss, wss-3.0

在我的自定义列表 XML 中，我添加了一些 URL 字段。其中一个必须显示为图片，就像您在 UI 的字段设置中选择“将 URL 格式设置为：图片”一样。

在 customList 的 schema.xml 中，我没有找到任何地方可以覆盖 URL 类型的 html 标记。

欢迎任何帮助或线索:)谢谢，

teebot

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T02:41:10.447

尝试更改相关字段 xml Schema 的 Format 属性。[获取SharePoint Manager](http://www.codeplex.com/spm)的副本以进行试用。

```
<Field ID="{c29e077d-f466-4d8e-8bbe-72b66c5f205c}" Name="URL"
SourceID="http://schemas.microsoft.com/sharepoint/v3" StaticName="URL" 
Group="Base Columns" Type="URL" DisplayName="URL" ColName="nvarchar3" 
RowOrdinal="0" ColName2="nvarchar4" RowOrdinal2="0" Format="Image" Version="1" /> 
```

# java - 有谁知道如何在 Java J2ME 中使用日历提取日期字段？

> ID：689325
> 
> 赞同：-2
> 
> 时间：2009-03-27T11:03:44.973
> 
> 标签：java, java-me, calendar

如果用户不更改日期/日历字段，我希望能够运行警报。

我的数据是这样设置的

```
StartDate = new DateField("Start Date ", DateField.DATE);
cal1 = Calendar.getInstance();
cal1.set(Calendar.YEAR, 2009);
cal1.set(Calendar.MONTH, 0);
cal1.set(Calendar.DAY_OF_MONTH, 1);
StartDate.setDate(cal1.getTime()); 
```

到目前为止，我有这个

```
else if (strStartDate == "1/1/2009;") {
    AlertNameNotEntered.setString("Please enter a Start Date");
    Display.setCurrent(AlertNameNotEntered);
} 
```

这不起作用，因为这不会运行警报并正常添加日期。我尝试了几个选项，但都没有成功。

任何人都可以通过给我插入 if 语句的代码来提供帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T12:22:20.870

否则 if (StartDate.getDate().equals(cal1.getTime())) {...}

当然，假设您没有更改问题中两段代码之间的 cal1 时间。

java.util.Date.equals() 在毫秒级别检查相等性，因此如果您想要 24 小时粒度，您可能需要手动检查年月和 day_of_month 的相等性。

# linux - 是否可以用 gcc 以外的东西编译 Linux 内核

> ID：689327
> 
> 赞同：21
> 
> 时间：2009-03-27T11:04:27.547
> 
> 标签：linux, gcc, linux-kernel

我想知道是否有人设法用 gcc 以外的其他编译器编译 Linux 内核。或者如果有人曾经尝试过？问题可能看起来很愚蠢或学术性的，但是当我想到以下问题的答案时就出现了：[Are C++ int operations atomic on the mips architecture](https://stackoverflow.com/questions/687813/are-c-int-operations-atomic-on-the-mips-architecture)

似乎某些操作的原子性不仅取决于 cpu 架构，还取决于使用的编译器。所以，我想知道在 Linux 世界中是否存在除 gcc 之外的其他编译器。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-27T11:11:49.387

Linux 明确依赖于一些[gcc 扩展](http://www.ibm.com/developerworks/linux/library/l-gcc-hacks/)，因此在这种情况下，任何其他编译器都必须与所需的扩展兼容。

这不是“否”，因为单独的编译器供应商/开发人员当然不可能跟踪 gcc 的扩展，这只是一个可以帮助您搜索的数据点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-27T16:55:54.737

在某些时候[tcc](http://bellard.org/tcc/)会处理和[运行](http://bellard.org/tcc/tccboot.html)linux 内核源代码。所以那是肯定的，我猜。

::在评论中给ehemient的提示。::

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-15T00:00:19.833

[LLVM](http://llvm.org/)开发人员正在尝试使用 clang 对其进行[编译](http://clang.llvm.org/)。[使用 clang 编译 Linux 内核](http://llvm.org/bugs/show_bug.cgi?id=4068)的元错误有更多细节（该[元错误的依赖关系树](http://llvm.org/bugs/showdependencytree.cgi?id=4068&hide_resolved=1)显示似乎剩下的很少）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-27T11:17:25.860

有一些努力（和[补丁](http://www.pyrillion.org/index.html?showframe=linuxkernelpatch.html)）来编译 2.6 内核的早期版本[`icc`](http://en.wikipedia.org/wiki/Intel_C%2B%2B_Compiler)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-10-25T20:24:39.913

是的。我已经做到了。请参阅[[cfe-dev] Clang 构建一个正常工作的 Linux 内核（使用 SMP、网络和 X 引导到 RL5，自主机）](https://web.archive.org/web/20150907044958/http://lists.cs.uiuc.edu/pipermail/cfe-dev/2010-October/011711.html)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-27T11:17:08.547

IBM 的编译器在某些 Linux 版本之前能够做到这一点，但我现在不确定，我也不确定 IBM 按照指示优化内核的效果如何。我所知道的是，他们得到了建造。

由于 Linux 是自托管的（具有自己的 libc）并且从一开始就使用 gcc（和 gcc 交叉编译器）开发，因此使用其他任何东西有点愚蠢。

我认为主要是，使用预处理器宏和指令优化是最大的障碍（甚至没有脱离gas），因为GNU基本上已经在上面写了这本书，并对其进行了扩展。除此之外，Linux 会调整其优化以使用 gcc，例如，不要在没有非常好的理由的情况下在内核中使用 'volatile'。使用内联并实际上让编译器同意是另一个挑战。

Linus 是第一个将 GCC 称为 &*#$ 漏洞的人，这使得编译器更好。

这就是为什么我们有伟大的 GNU/Linux 辩论。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T00:00:39.823

很多很多很多年前，实际上可以[使用 g++ 编译内核，](http://www.tux.org/lkml/#s15-3)据我所知，部分动机是因为 C++ 具有更强的类型检查，不一定要让 g++ 生成目标文件。但正如 Neil Butterworth 所指出的，Linus[并不是特别](http://lwn.net/Articles/249460/) [喜欢 C++](http://kerneltrap.org/node/2067)，而且这再次成为可能的可能性为零。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-17T14:58:04.020

EKOPath 4 编译器，不是现在。但可能有一些小补丁

[https://github.com/path64/repositories](https://github.com/path64/repositories)

[http://www.pathscale.com/ekopath-compiler-suite](http://www.pathscale.com/ekopath-compiler-suite)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-07T13:27:14.017

我现在正在使用 Open64 为 MIPS 架构编译 Linux 内核，而其他一些人现在正在为使 Open64 可以为 X86 架构构建而工作。现在内核可以部分运行，但仍然有运行失败错误。

但是对于原子问题，至少我还没有想出它。而且我不认为这真的是一个问题。原因是：

1.  Linux内核已经是源代码的集合，可以用GCC成功构建，所以如果不能构建，或者构建的内核运行失败，只是编译器的问题。

2.  编译器要想成功构建Linux内核，就应该遵守GNU C Extension，而这个扩展会明确说明什么是原子操作，所以这样的编译只需要根据这个扩展生成代码即可。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-05-23T11:39:08.267

*我的非技术猜测：* Linux 内核目前（*2009 年*）不能用 GNU 编译器**gcc**以外的任何编译器编译。

我这么说是因为我听过 Richard Stallman 有一定的信念，他说**Linux**应该被称为**GNU/Linux**，因为内核“只是操作系统的一部分”，我猜他不会能够如果内核不依赖于 GNU（例如，大量嵌入式设备在没有任何 GNU 软件的情况下运行 Linux 操作系统），请这样说。

正如我所说，只是一个猜测，如果我错了，请告诉我......

# xslt - 当 xsl:foreach 真的有用时？

> ID：689328
> 
> 赞同：3
> 
> 时间：2009-03-27T11:05:07.420
> 
> 标签：xslt

当 xsl:foreach 真的有用时，有人可以举个例子吗？

我刚刚做了一个项目并得出结论，在任何地方我都可以用适当`<xsl:apply-templates />`的 . `<xsl:if>`有时`<xsl:when/>`会使代码更短，我无法有效地用`<apply-templates/>`功能样式替换它。

无论如何都被`<xsl:foreach>`认为是有害的？

好吧，谢谢大家，我真的无法选择最好的答案。我认为收集不同的案例会更好。

对不起有人拒绝回答 - 这不是我:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T11:32:32.220

这通常是代码风格的问题。如果你正在做一个相当短的for-each，并且需要从父块访问变量，那么在那里做一个for-each可能会更清楚，而不是应用模板并作为参数传入它需要的任何东西.

使用模板肯定会更清晰，使用 for-each 肯定会更清晰。它们都是有用的工具。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T20:56:38.457

**如果确切地知道如何处理 an ，则使用[`<xsl:for-each>`](http://www.w3.org/TR/xslt#element-for-each)绝不是有害的`<xsl:for-each>`**。

问题在于，许多在命令式编程方面有经验的 XSLT 新手`<xsl:for-each>`在他们最喜欢的 PL 中将“循环”代替为“循环”，并认为它允许他们执行不可能的事情——比如增加一个计数器或任何其他修改一个已经定义的`<xsl:variable>`.

一个必不可少的用途`<xsl:for-each>`是更改当前文档——这通常[**是为了能够在文档上使用不同于当前源 XML 文档的 key() 函数**](http://clover.slavic.pitt.edu/~repertorium/plectogram/keys/keys.html)，例如有效地访问驻留的查找表在它自己的 xml 文档中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T13:06:41.153

我也认为这是风格问题。

我见过几乎没有使用 XSLT 样式表`<xsl:apply-templates>`的项目。他们总是使用`<xsl:call-template>`。这与其说是功能性的，不如说是程序性的编码。而这种方法不可避免地会导致你过度使用`<xsl:for-each>`.

就个人而言，我总是更喜欢你在问题中建议的风格。但这是一个团队管理、技能和一致性的问题，会让你更喜欢一种风格或另一种风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T21:08:01.580

我经常使用 for-each，因为我必须构建较大 xml 文件的子集的变量。

```
<xsl:variable name="foo">
  <xsl:for-each select="document('bar.xml')/item">
    <xsl:if test="baz = bax">
      <xsl:copy-of select="."/>
    </xsl:if>
  </xsl:for-each>
</xsl:variable> 
```

用模板可以吗？

可能我是那些看不到原生 XSL 做事方式的程序员之一……

# vb.net - 货币面额

> ID：689330
> 
> 赞同：0
> 
> 时间：2009-03-27T11:05:46.000
> 
> 标签：vb.net

我有工资单数据库，在我的工资单上，我想为每个员工的工资赚钱面额，即如果员工有 759 美元，那么收银员将从银行提取 7 一百美元，1 五十美元，9 十美元请在 vb.net 中给我一个代码

工资一百五十

759 7 1 9

请帮我很多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T11:23:36.847

这是python中的答案：

```
# Target amount
amount = 759

# The denominations to be used, sorted
denoms = [100, 50, 20, 10, 5, 1]

# Take as many of each denomination as possible
for d in denoms:
  count = amount // d
  amount -= count * d
  print "%ix%i" % (count, d) 
```

样本输出：

```
7x100
1x50
0x20
0x10
1x5
4x1 
```

# kml - 将 Google 地球中的功能分组以在缩小时隐藏细节

> ID：689336
> 
> 赞同：2
> 
> 时间：2009-03-27T11:07:45.370
> 
> 标签：kml

我正在尝试生成一个 KML 文件以显示散布在英国各地的一组功能。我希望以更高的缩放级别将功能组合在一起，理想情况下显示为带有功能数量计数的图标，以便用户可以轻松查看功能集群。

本质上，我正在尝试按照[这些思路](http://gmaps-utility-library.googlecode.com/svn/trunk/markermanager/release/examples/weather_map.html)做一些事情，但在 Google 地球中，而不是在地图中。

谁能指出我正确的方向。我是 KML 的新手 :-)

干杯，

RB。

答案：

[我自己的研究表明，我可以使用Regions](http://code.google.com/apis/kml/documentation/kml_21tutorial.html#workingregions)为某些特征定义边界框来做我想做的事情。

也有人建议我应该使用网络链接来执行此操作，我将对其进行调查，因为我认为出于其他原因它也更适合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T11:31:25.283

这是一个独立的 KML 文件吗？还是作为网络链接数据返回的 KML？

在第一种情况下，我不确定这是否可能。我已经看到图层透明度随着“相机高度”的变化而变化，所以也许像这样的东西也可能在特征上？然后您可以将单个要素和组要素添加到同一个 KML 文件中，并根据“到相机的距离”使它们可见？可能是我错过的新 KML 功能，但您可以查看[KML 规范](http://code.google.com/apis/kml/documentation/)。

在第二种情况下，您只需返回与给定网络链接视口信息匹配的 KML。根据您获得的边界框，您可以将该框细分为网格和每个框的集群。如果您在一个框中有一个功能，请返回该功能。如果您在一个框中有多个，则只为该框返回一个“分组功能”。然后，当用户在 Google 地球中四处移动时，聚类将自动更改：在每个摄像头更改后，再次调用您的网络链接 URL，您再次使用给定的边界框视口进行特征选择和聚类。这使您的集群动态化。

这有帮助吗？

# python - Python XML - 从动态嵌套的“节点”元素构建平面记录

> ID：689339
> 
> 赞同：1
> 
> 时间：2009-03-27T11:09:06.303
> 
> 标签：python, xml, elementtree

我需要解析一个 XML 文件并从数据中构建一个基于记录的输出。问题在于 XML 是一种“通用”形式，因为它有多层嵌套的“节点”元素，代表某种数据结构。我需要根据“节点”元素的最深层动态构建记录。一些示例 XML 和预期输出位于底部。

我最熟悉 w/python 的 ElementTree，所以我更喜欢使用它，但我无法理解一种基于动态节点深度动态构建输出记录的方法。另外 - 我们不能假设嵌套节点的深度为 x 级，因此仅对每个级别进行硬编码是不可能的。有没有办法解析 XML 并即时构建输出？

一些附加说明：

*   除了父节点和详细信息（费率、价格等）外，节点名称都是“节点”
*   节点深度不是静态的。所以 - 假设比示例中显示的级别更高
*   每个“级别”可以有多个子级别。所以 - 您需要在每个子“节点”上循环以正确构建每条记录。

任何想法/意见将不胜感激。

```
<root>
   <node>101
      <node>A
         <node>PlanA     
            <node>default
                <rate>100.00</rate>
            </node>
            <node>alternative
                <rate>90.00</rate>
            </node>
         </node>
      </node>
   </node>
   <node>102
      <node>B
         <node>PlanZZ     
            <node>Group 1
               <node>default
                   <rate>100.00</rate>
               </node>
               <node>alternative
                   <rate>90.00</rate>
               </node>
            </node>
            <node>Group 2
               <node>Suba
                  <node>default
                      <rate>1.00</rate>
                  </node>
                      <node>alternative
                      <rate>88.00</rate>
                  </node>
               </node>
               <node>Subb
                  <node>default
                      <rate>200.00</rate>
                  </node>
                      <node>alternative
                      <rate>4.00</rate>
                  </node>
               </node>
            </node>
         </node>
      </node>  
   </node>
</root> 
```

输出将如下所示：

```
SRV  SUB  PLAN   Group    SubGrp  DefRate   AltRate
101  A    PlanA                   100       90
102  B    PlanB  Group1           100       90
102  B    PlanB  Group2   Suba    1         88
102  B    PlanB  Group2   Subb    200       4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T11:34:07.677

这就是为什么你有`find`带有 XPath 的元素树方法的原因。

```
class Plan( object ):
    def __init__( self ):
        self.srv= None
        self.sub= None
        self.plan= None
        self.group= None
        self.subgroup= None
        self.defrate= None
        self.altrate= None
    def initFrom( self, other ):
        self.srv= other.srv
        self.sub= other.sub
        self.plan= other.plan
        self.group= other.group
        self.subgroup= other.subgroup
    def __str__( self ):
        return "%s %s %s %s %s %s %s" % (
            self.srv, self.sub, self.plan, self.group, self.subgroup,
            self.defrate, self.altrate )

def setRates( obj, aSearch ):
    for rate in aSearch:
        if rate.text.strip() == "default":
            obj.defrate= rate.find("rate").text.strip()
        elif rate.text.strip() == "alternative":
            obj.altrate= rate.find("rate").text.strip()
        else:
            raise Exception( "Unexpected Structure" )

def planIter( doc ):
    for topNode in doc.findall( "node" ):
        obj= Plan()
        obj.srv= topNode.text.strip()
        subNode= topNode.find("node")
        obj.sub= subNode.text.strip()
        planNode= topNode.find("node/node")
        obj.plan= planNode.text.strip()
        l3= topNode.find("node/node/node")
        if l3.text.strip() in ( "default", "alternative" ):
            setRates( obj, topNode.findall("node/node/node") )
            yield obj
        else:
            for group in topNode.findall("node/node/node"):
                grpObj= Plan()
                grpObj.initFrom( obj )
                grpObj.group= group.text.strip()
                l4= group.find( "node" )
                if l4.text.strip() in ( "default", "alternative" ):
                    setRates( grpObj, group.findall( "node" ) )
                    yield grpObj
                else:
                    for subgroup in group.findall("node"):
                        subgrpObj= Plan()
                        subgrpObj.initFrom( grpObj )
                        subgrpObj.subgroup= subgroup.text.strip()
                        setRates( subgrpObj, subgroup.findall("node") )
                        yield subgrpObj

import xml.etree.ElementTree as xml
doc = xml.XML( doc )

for plan in planIter( doc ):
    print plan 
```

* * *

**编辑**

给你这个 XML 文档的人需要另找一份工作。这是 A Bad Thing (TM) 并表明对 XML 含义的相当随意的无视。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:48:54.363

我对`ElementTree`模块不太熟悉，但是您应该能够`getchildren()`在元素上使用该方法，并递归解析数据，直到没有更多子元素。这是比任何东西都多的 sudo 代码：

```
def parseXml(root, data):
    # INSERT CODE to populate your data object here with the values 
    # you want from this node
    sub_nodes = root.getchildren()
    for node in sub_nodes:
        parseXml(node, data)

data = {}  # I'm guessing you want a dict of some sort here to store the data you parse
parseXml(parse(file).getroot(), data)
# data will be filled and ready to use 
```

# keyboard - 学习触控打字的最佳方法是什么？

> ID：689341
> 
> 赞同：6
> 
> 时间：2009-03-27T11:10:28.000
> 
> 标签：keyboard, performance, dvorak

### 复制

> [如何提高打字技巧？](https://stackoverflow.com/questions/410880/how-do-i-improve-my-typing-skills).**

我在[http://speedtest.10-fast-fingers.com/](http://speedtest.10-fast-fingers.com/)上进行了测试。我只达到：

> `You type 337 characters per minute You`
> `have 58 correct words and you have 1`
> `wrong words`

如何提高打字速度？你知道哪些免费资源？

我应该学习德沃夏克键盘吗？

![在此处输入图像描述](https://i.stack.imgur.com/ILXCx.jpg)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T11:55:38.377

练习是提高速度的最好方法。我发现[TypeRacer](http://play.typeracer.com/)是一款有趣且易于上手的游戏。使用它，我很快从每分钟大约 55 个单词增加到超过 70 个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T11:41:47.177

我从我的 IBM Model-M 上取下了所有的键帽。由于我看不到字母，我不得不在不看键的情况下学习它们的位置和打字，而不是最初确定我的手的方向。当你不能走捷径时，你往往学得很快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T11:33:09.740

[马里奥](http://www.abandonia.com/en/games/987/Mario+Teaches+Typing.html)教会了我。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T11:37:30.260

我也参加了测试，一个错误达到了 371 个字符。但是，对于编程，我不会认为这是一个糟糕的结果。我更担心如何更好地使用 Intellisense 和代码模板等工具来加快我的编码速度。[绝地编码](http://www.jetbrains.com/resharper/documentation/documentation.html)演示表明，与打字速度加倍相比，这种方式可以获得更高的收益。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T11:13:13.297

无需[根据 XKCD](http://xkcd.com/561/)学习德沃夏克（[这里还有更多](http://blag.xkcd.com/2009/03/27/a-brief-pair-of-notes/)）。

我还记得在[The Design of Everyday Thing](https://rads.stackoverflow.com/amzn/click/com/0385267746)中读到QWERTY 实际上做得很好，或者将常用字母分散在手指上，虽然 Dvorak 键盘比 QWERTY 好一点，但好处不足以证明制作改变。（如果我能找到我的副本，我会尝试提供准确的报价。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T11:16:49.920

你不需要学习德沃夏克。我可以在查询板上输入 600+ 字符/分钟，没问题。

关键是：重复，重复，重复。当你学习打字时，你正在做的是创造新的“高速公路”，从你大脑的拼写中心穿过你的脊椎到你的手指。

因此，一个好的打字员会在他的脑海中拼出一个单词，他的手指会“自动”输入这些字符，因为从他的大脑到手指之间有一条 10 车道的高速公路。就您而言，这是一条适中的 3 车道高速公路。

练习，练习，练习。如果您已经知道如何打字，则可以进行良好的培训：[www.play4traffic.com](http://www.play4traffic.com)

网上也有大量的打字辅导程序，但关键是重复和坚持。

我的母语是荷兰语，所以英语不太好。我试过你给的测试：

```
317 points, so you achieved position 194065 of 2927935 on the ranking list    

You type 476 characters per minute
You have 80 correct words and you have 4 wrong words 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T11:23:52.837

与所有事物一样：熟能生巧。在 StackOverflow 上发帖是一个开始 :)

除非你想赢得打字比赛，否则 Qwerty 或 Azerty 键盘就可以了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T11:47:03.823

为什么？

为什么要打字更快？我很少发现我的手指或打字速度是软件开发的问题。当然，我的速度还不错，但编程不仅仅是打字速度***。***自 1983 年左右以来，我一直在使用 QUERTY 键盘，所以我想重复会有所帮助。

但是学会阻止打字并思考你将要做什么是更有价值的恕我直言。

话虽如此，我希望任何开发人员都能够使用大多数手指或至少比他们的两个食指更快地打字；）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T11:54:18.143

几年前，这个游戏教会了我。

[死者的打字](http://en.wikipedia.org/wiki/The_Typing_of_the_Dead)

我现在可以在不看键盘的情况下快速打字。你需要学会使用正确的手位。然后你必须有良好的纪律，只用正确的手指输入正确的字母。我什至删除了用错误手指输入的正确字符。

这需要时间，在你走得更快之前，你几乎肯定会走得更慢，但这是值得的。

# gdata-api - gData API - 添加到 Google 日历时出现“此提要为只读”错误

> ID：689343
> 
> 赞同：1
> 
> 时间：2009-03-27T11:11:16.187
> 
> 标签：gdata-api, google-calendar-api

我正在**为我的域使用 Google Apps**，并尝试在我的网站上启用对日历的访问。

问题是`This feed is read-only`每次尝试将事件添加到日历时都会出错。这是我发帖的地方：~~[链接](https://www.google.com/calendar/feeds/mydomain.com_oaiat5pq6l6dsfnmrodn8susvc@group.calendar.google.com/private/basic)~~（死链接）

![错误截图](https://i.stack.imgur.com/8Xv76.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T11:30:21.087

您正在使用基本提要，根据[文档](http://code.google.com/apis/calendar/docs/2.0/reference.html#Event_feeds)，它始终是只读的。使用以`private/full`or结尾的提要 URL `private/full-noattendees`。

（免责声明：我为 Google 工作，作为实现[Google Sync](http://www.google.com/mobile/default/sync.html)日历方面的一部分，我有一些使用 GData API 的经验，但我在这里写的任何内容都必须被视为个人的观点，而不是作为谷歌官方政策等:)

# java - 用于匹配 javadoc 片段的正则表达式

> ID：689354
> 
> 赞同：9
> 
> 时间：2009-03-27T11:14:41.500
> 
> 标签：java, regex, javadoc

这个[问题](https://stackoverflow.com/questions/689007/search-javadoc-in-eclipse)让我想到了一个**正则表达式**来匹配包含一些指定文本的*javadoc注释。*

例如，查找所有包含以下内容的*javadoc*片段`@deprecated`：

```
/**
* Method1
* .....
* @deprecated
* @return
*/ 
```

我设法得到表达式`/\*\*.*?@deprecated.*?\*/`，但在某些情况下失败，例如：

```
/**
* Method1
* .....
* @return
*/
public int Method1() { } 

// this method should be @deprecated
public void Method2() { }    

/**
* Method3
* .....
* @return
*/
public int Method3() { } 
```

它匹配从第一个*javadoc*片段到第三个*javadoc*片段的所有代码。

有人可以为此提供**正则表达式吗？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-27T11:28:13.870

试试这个：

```
/\*\*([^\*]|\*(?!/))*?@deprecated.*?\*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T11:26:12.487

method2() 没有 javadoc 注释，因此不推荐使用（尽管注释说明它应该是）。

此外，如果您想从 javadoc 注释中提取信息，我建议您查看[javadoc](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html)工具并编写一个[Doclet](http://java.sun.com/j2se/1.5.0/docs/guide/javadoc/doclet/spec/com/sun/javadoc/Doclet.html)。您可以从那里轻松访问 javadoc 注释中的所有信息。

# c# - MetadataException：无法加载指定的元数据资源

> ID：689355
> 
> 赞同：715
> 
> 时间：2009-03-27T11:15:08.300
> 
> 标签：c#, .net, entity-framework, ado.net

突然间，我一直`MetadataException`在实例化我生成的`ObjectContext`类。App.Config 中的连接字符串看起来是正确的 - 自上次工作以来没有改变 - 我已经尝试从底层数据库重新生成一个新模型（edmx 文件）而没有任何变化。

有人有想法么？

更多细节：我没有更改任何属性，我没有更改任何输出程序集的名称，我没有尝试在程序集中嵌入 EDMX。我从下班到回来只等了10个小时。然后它不再工作了。

我试过重新创建 EDMX。我已经尝试重新创建该项目。我什至尝试从头开始重新创建数据库。没有运气，无论如何。

* * *

## 回答 #1

> 赞同：874
> 
> 时间：2009-03-27T12:02:19.623

这意味着应用程序无法加载 EDMX。有几件事会导致这种情况。

*   您可能已将模型的 MetadataArtifactProcessing 属性更改为复制到输出目录。
*   连接字符串可能是错误的。我知道您说您没有更改它，但是如果您更改了其他内容（例如，程序集的名称），它仍然可能是错误的。
*   您可能正在使用后编译任务将 EDMX 嵌入程序集中，但由于某种原因它不再工作。

简而言之，您的问题中没有足够的细节来给出准确的答案，但希望这些想法能让您走上正轨。

**更新：**我写[了一篇博客文章，其中包含更完整的故障排除步骤](http://www.craigstuntz.com/posts/2010-08-13-troubleshooting-entity-framework-connection-strings.html)。

* * *

## 回答 #2

> 赞同：381
> 
> 时间：2009-07-16T12:12:23.213

这个小小的改变有助于解决这个问题。

我有 3 个项目的解决方案。

```
connectionString="metadata=res://*/Model.Project.csdl|res://*/Model.Project.ssdl|res://*/Model.Project.msl; 
```

改成

```
connectionString="metadata=res://*/; 
```

* * *

## 回答 #3

> 赞同：116
> 
> 时间：2010-02-19T05:41:42.290

当 Edmx 在一个项目中并且您从另一个项目中使用它时，您可能会遇到此异常。

原因是`Res://*/`uri 指向 CURRENT 程序集中的资源。如果 Edm 是在与使用它的代码不同的程序集中定义的，则 res://*/ 将无法工作，因为找不到资源。

您需要提供程序集的全名（包括公钥令牌），而不是指定“*”。例如：

```
res://YourDataAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=abcdefabcedf/YourEdmxFileName.csdl|res://... 
```

构造连接字符串的更好方法是使用 EntityConnectionStringBuilder：

```
public static string GetSqlCeConnectionString(string fileName)
{
    var csBuilder = new EntityConnectionStringBuilder();

    csBuilder.Provider = "System.Data.SqlServerCe.3.5";
    csBuilder.ProviderConnectionString = string.Format("Data Source={0};", fileName);

    csBuilder.Metadata = string.Format("res://{0}/YourEdmxFileName.csdl|res://{0}/YourEdmxFileName.ssdl|res://{0}/YourEdmxFileName.msl", 
        typeof(YourObjectContextType).Assembly.FullName);

    return csBuilder.ToString();
}

public static string GetSqlConnectionString(string serverName, string databaseName)
{
    SqlConnectionStringBuilder providerCs = new SqlConnectionStringBuilder();

    providerCs.DataSource = serverName;
    providerCs.InitialCatalog = databaseName;
    providerCs.IntegratedSecurity = true;

    var csBuilder = new EntityConnectionStringBuilder();

    csBuilder.Provider = "System.Data.SqlClient";
    csBuilder.ProviderConnectionString = providerCs.ToString();

    csBuilder.Metadata = string.Format("res://{0}/YourEdmxFileName.csdl|res://{0}/YourEdmxFileName.ssdl|res://{0}/YourEdmxFileName.msl",
        typeof(YourObjectContextType).Assembly.FullName);

    return csBuilder.ToString();
} 
```

如果仍然遇到异常，请在反射器中打开程序集并检查 .csdl、.ssdl 和 .msl 文件的文件名。当资源的名称与元数据值中指定的名称不同时，它将不起作用。

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2009-12-04T05:55:00.033

我有一个类似的错误。我重新创建了这个项目（长篇大论），并从旧项目中提取了所有内容。我之前没有意识到我的模型在一个名为“Model”的目录中，现在在一个名为“Models”的目录中。一旦我从这里更改了我的 Web.Config 中的连接：

```
<add name="RecipeManagerEntities" connectionString="metadata=res://*/Model.Recipe.csdl 
```

对此：

```
<add name="RecipeManagerEntities" connectionString="metadata=res://*/Models.Recipe.csdl 
```

一切正常（更改`Model`为`Models`）。请注意，我必须更改此字符串中的这三个位置。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2013-11-13T16:57:43.630

还有一种快速检查没有反射器的模型名称的方法....查找目录

> ...obj/{配置输出}/edmxResourcesToEmbed

并检查 .csdl、.msl 和 .ssdl 资源文件是否存在。如果它们位于子目录中，则子目录的名称必须添加到模型名称之前。

例如，我的三个资源文件位于子目录**Data**中，所以我的连接字符串必须是

> metadata=res://*/**数据**.MyModel.csdl|res://*/**数据**.MyModel.ssdl|res://*/**数据**.MyModel.msl;

（相对于元数据=res://*/MyModel.csdl|res://*/MyModel.ssdl|res://*/MyModel.msl;）。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2012-11-27T09:02:33.477

我也遇到了这个问题，这是因为我的 web.config 中的连接字符串与我的 EDMX 所在程序集的 app.config 中的连接字符串略有不同。不知道为什么会改变，但这里有两个不同的版本。

应用程序配置：

```
<add name="SCMSEntities" connectionString="metadata=res://*/Model.SMCSModel.csdl|res://*/Model.SMCSModel.ssdl|res://*/Model.SMCSModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=SANDIEGO\sql2008;initial catalog=SCMS;integrated security=True;multipleactiveresultsets=True;application name=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

网络配置：

```
<add name="SCMSEntities" connectionString="metadata=res://*/Model.SCMSModel.csdl|res://*/Model.SCMSModel.ssdl|res://*/Model.SCMSModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=SANDIEGO\sql2008;initial catalog=SCMS;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

解决它的方法是简单地将 app.config 字符串（注意最后的细微差别 - 而不是“ `App=EntityFramework`”它想要“ `application name=EntityFramework`”）复制到 web.config 中，问题就解决了。:)

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2018-06-25T01:48:56.963

当我在构建新的 .edmx 设计器之前不清理解决方案时，就会发生这种情况。因此，在构建新的 .edmx 设计器之前不要忘记清理解决方案。这有助于我跳过这个问题的更多问题。如果您是 Visual Studio 的新手，请在下方提供导航详细信息。

> 点击->构建->清理解决方案
> 
> 然后点击->构建->重建解决方案

希望这可以帮助。谢谢大家

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2009-12-17T10:11:06.930

当我不小心将 edmx 文件的构建操作（出现在 IDE 的属性下）从“EntityDeploy”切换到“None”时，这发生在我身上。EntityDeploy 为您填充元数据：请参阅[http://msdn.microsoft.com/en-us/library/cc982037.aspx](http://msdn.microsoft.com/en-us/library/cc982037.aspx)

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2018-01-24T16:39:29.910

如果您使用的是来自不同项目的 edmx，则在连接字符串中，更改...

```
metadata=res://*/Data.DataModel.csdl 
```

...到...

```
metadata=res://*/DataModel.csdl 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2010-01-12T16:37:10.807

我刚刚度过了愉快的 30 分钟。我重命名了实体对象，重命名了配置文件中的条目，但还有更多......您还必须更改对 csdl 的引用

很容易错过 - 如果你要重命名，请确保你得到了**一切**......

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-10-12T09:42:25.387

我有同样的问题。我用反射器查看了我编译的 dll，发现资源的名称不正确。我重命名了，现在看起来很好。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-10-02T09:09:32.580

就我而言，它是通过更改 edmx 文件的属性来解决的。

1.  打开.edmx文件
2.  右键单击 EDMX 设计器的任意位置
3.  选择属性
4.  将名为“元数据工件处理”的属性更新为“嵌入输出程序集”

这为我解决了问题。问题是，当容器试图找到元数据时，它找不到它。所以只需在同一个程序集中进行即可。如果您的 edmx 文件位于另一个程序集中，此解决方案将不起作用

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2016-08-21T16:15:03.930

我花了一整天的时间来解决这个错误

如果您正在使用`n-tear architecture`

或者您尝试`separate Models`通过`EDMX`表单 DataAccessLayer生成`DomainModelLayer`

也许你会得到这个错误

1.  第一个故障排除步骤是确保连接字符串在`webconfig (UILayer)`和`appconfig (DataAccessLayer)`是相同的
2.  第二个非常重要的**`connection string`**

    ```
    connectionString="metadata=res://*/Model.csdl|res://*/Model.ssdl|res://*/Model.msl;provid..... 
    ```

    这是问题所在

从地球上我得到的地方`Model`或连接字符串中的任何 .csdl 它们在哪里

这里我我们的解决方案看图

[![在此处输入图像描述](https://i.stack.imgur.com/zUv7L.png)](https://i.stack.imgur.com/zUv7L.png)

希望对你有帮助

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2018-08-06T05:06:31.327

有时我会在我的项目中看到这个错误。我解决了这个问题

1 - 右键单击​​ EDMX 文件

2 - 选择`Run Custom Tool`选项

3 - 重建项目

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2010-08-31T19:31:56.670

我能够在 Visual Studio 2010、VB.net (ASP.NET) 4.0 中解决这个问题。

在实体模型向导期间，您将能够看到实体连接字符串。从那里您可以复制并粘贴到您的连接字符串中。

我唯一缺少的是“App_Code”。在连接字符串中。

```
entityBuilder.Metadata = "res://*/App_Code.Model.csdl|res://*/App_Code.Model.ssdl|res://*/App_Code.Model.msl" 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-07-29T10:27:25.713

经过数小时的谷歌搜索并试图解决建议的解决方案都没有奏效。我在这里列出了几个解决方案。我还注意到对我有用的那个。（我使用的是 EF 版本 6.1.1 和 SQL Server 2014 - 但使用的是较旧的数据库）

1.  重建项目并重试。
2.  关闭并打开 VS - 我不知道这是如何工作的
3.  确保您已将 .EDMX 文件放置在目录中，确保将目录包含在您的 ConnectionString 中。例如我的在 DAL 文件夹中。所以它看起来像这样：（`connectionString="metadata=res://*/DAL.nameModel.csdl|res://*/DAL.nameModel.ssdl|res://*/DAL.nameModel.msl;`这些是文件。要查看它们，您可以在 ~/obj/.. 目录下的解决方案资源管理器中切换显示所有文件）

...以及我尝试过的更多[例如：将 EntityFramework 版本恢复到更高版本（不确定）]

* * *

**什么对我有用：**

从这里的[这篇文章](http://erikej.blogspot.dk/2014/12/a-breaking-change-in-entity-framework.html)，它帮助我解决了我的问题。我刚刚在 EDMX 文件中更改`ProviderManifestToken="2012"`为。`ProviderManifestToken="2008"`去做这个：

解决方案资源管理器

1.  右键单击文件 .edmx
2.  打开用..
3.  编辑器 XML
4.  将 ProviderManifestToken="XXXX" 更改为 2008

我希望这会有所帮助。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-04-20T16:45:44.310

~~最终的解决方案（即使在另外两台机器上重新创建数据库，以及 EDMX 和其他杂项）是不使用实体框架的第一版。期待在 .NET 4.0 中再次对其进行评估。~~

在*再次*遇到同样的问题并到处寻找答案后，我终于找到了遇到同样问题的人。似乎 Visual Studio 的向导未正确生成连接字符串，并且元数据资源的链接缺少重要路径。

[v1.0 BUG?：无法加载指定的元数据资源。脚本 != 模型](http://forums.asp.net/p/1409590/3082930.aspx)

**2013-01-16 更新**：已经过渡到几乎完全使用 EF Code First 实践（即使使用现有数据库），这个问题不再是问题。对我来说，这是一个可行的解决方案，可以减少自动生成的代码和配置造成的混乱，并增加我自己对产品的控制。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2014-09-29T16:23:42.767

我的问题和解决方案，症状是相同的“无法加载指定的元数据资源”，但根本原因不同。我在解决方案中有 2 个项目，一个是 EntityModel，另一个是解决方案。我实际上在 EntityModel 中删除并重新创建了 EDMX 文件。

解决方案是我必须回到 Web 应用程序项目并将这一行添加到配置文件中。新模型更改了一些必须在“其他”项目的 Web.Config 文件中复制的项目。旧配置不再好。

```
 <add name="MyEntities"
     connectionString="metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;
                    provider=System.Data.SqlClient;
                    provider connection string=&quot;
                    data source=Q\DEV15;initial catalog=whatever;
                    user id=myuserid;password=mypassword;
                    multipleactiveresultsets=True;
                    application name=EntityFramework&quot;"
     providerName="System.Data.EntityClient" /> 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-06-23T07:44:40.747

就我而言，此问题与重命名模型的 edmx 文件有关...更正 csdl/ssdl/msl 文件的 app.config 连接字符串解决了我的问题。

如果您使用 EF 4.0 设计器生成 csdl/ssdl/msl，这 3 个“文件”实际上将存储在模型的主 edmx 文件中。在这种情况下，Waqas 的帖子非常符合要求。重要的是要理解他的示例中的“Model_Name”需要更改为模型的 .edmx 文件的当前名称（没有 .edmx）。

此外，如果您的 edmx 文件不在项目的根级别，您需要在 Model_Name 前面加上相对路径，例如

```
res://*/MyModel.WidgetModel.csdl|res://*/MyModel.WidgetModel.ssdl|res://*/MyModel.WidgetModel.msl 
```

将指定 csdl/ssdl/msl xml 存储在模型文件“WidgetModel.edmx”中，该文件存储在名为“MyModel”的文件夹中。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2010-07-06T16:29:24.443

当 ObjectContext 对象在与使用它的项目不同的项目中定义时，我编写了这个帮助类来创建 ObjectContext 对象的实例。我解析配置文件中的连接字符串并用完整的程序集名称替换“*”。

它并不完美，因为它使用反射来构建对象，但它是我能找到的最通用的方法。

希望它可以帮助某人。

```
public static class EntityHelper<T> where T : ObjectContext
{
    public static T CreateInstance()
    {
        // get the connection string from config file
        string connectionString = ConfigurationManager.ConnectionStrings[typeof(T).Name].ConnectionString;

        // parse the connection string
        var csBuilder = new EntityConnectionStringBuilder(connectionString);

        // replace * by the full name of the containing assembly
        csBuilder.Metadata = csBuilder.Metadata.Replace(
            "res://*/",
            string.Format("res://{0}/", typeof(T).Assembly.FullName));

        // return the object
        return Activator.CreateInstance(typeof(T), csBuilder.ToString()) as T;
    }
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2010-08-08T13:53:30.000

对于所有`SelftrackingEntities`用户，如果您已遵循 Microsoft 演练并将 Object 上下文类分离到 wcf 服务项目中（通过链接到上下文 .tt），那么此答案适合您：

这篇文章中显示的部分答案包括如下代码：

```
... = string.Format("res://{0}/YourEdmxFileName.csdl|res://{0}/YourEdmxFileName.ssdl|res://{0}/YourEdmxFileName.msl", 
        typeof(YourObjectContextType).Assembly.FullName); 
```

不会为你工作！原因是`YourObjectContextType.Assembly`现在驻留在不同的程序集中（在 wcf 项目程序集中），

所以你应该替换`YourObjectContextType.Assembly.FullName` 为 -->

```
ClassTypeThatResidesInEdmProject.Assembly.FullName 
```

玩得开心。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-07-12T12:28:08.883

例外是因为编译器指向不存在的元数据，所以只需将`app.config` 连接字符串复制到`Web.config`连接字符串

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2011-05-23T12:29:26.377

我遇到了同样的错误消息。我的问题通过关闭并重新打开 Visual Studio 2010 得到解决。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-03-29T15:28:29.553

有同样的问题，因为我重命名了一个程序集。

我还必须在项目 Properties/AssemblyInfo.cs 中的 AssemblyTitle 和 AssemblyProduct 属性中重命名它，并删除并重新添加对 edmx 文件的引用。

然后它工作得很好。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2013-10-22T13:17:57.673

遇到同样的问题，我从数据库重新创建了 edmx。解决了我的问题。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2010-02-07T04:27:50.777

我也有与 Rick 相同的问题和解决方案，除了我将现有的 .edmx 导入到新项目中，虽然基本命名空间无关紧要，但它被导入到不同的子目录中，所以我还必须更新连接Web.Config 中三个位置的字符串，以包含不同的子目录命名：

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2012-01-13T18:26:03.790

我在解决方案文件夹中包含项目的解决方案遇到了同样的问题，当它们被移动到解决方案根目录时（为了克服由于项目位置而导致的 Mvc3AppConverter 的可疑错误）。

虽然根据需要重新添加了所有*项目引用后编译的解决方案，但在网站启动时抛出了错误。

EDMX 位于被移动的项目之一（“数据”项目）中，但当然，缺少对数据项目的引用不会导致编译错误，只是运行时错误。

只需添加对主项目的缺失引用即可解决此问题，根本无需编辑连接。

我希望这对其他人有帮助。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-11-02T02:59:59.863

至于我，我已经分离了数据访问层和用户界面层。所以我有每一层的实体连接字符串。

在我将这两个单独的连接字符串修改为相同之前，我仍然发现以下错误。

```
Unable to load the specified metadata resource 
```

所以我为这两层（DAL，UI）设置了相同的连接字符串，它工作得很好。

**我的解决方案是使所有连接字符串都相同，无论它们已经出现在哪里**。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2014-03-20T08:21:54.723

我昨天遇到了这个问题，正在调试中查看我的代码和 SQL Profiler 的输出。

在我阅读并理解这篇文章之前，我无法理解的是，为什么 EntityFramework 在调用数据库时会抛出这个错误。我正在查看 SQL Profiler 中的数百行代码，试图找出数据库模型出了什么问题。我找不到任何像我期待的电话一样的东西，老实说，我不确定我在寻找什么。

如果您处于此位置，请检查连接字符串。我的猜测是，在 EntityFramework 创建其 SQL 之前，它会检查模型，在连接字符串的元数据部分中指定。就我而言，这是错误的。EntityFramework 甚至没有达到数据库。

确保名称正确。一旦我把它整理好，我就会在 SQL Profiler 中看到调用，其中 ApplicationName 是“EntityFramework”，而 SQL 调用了预期的表。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2014-04-18T08:27:09.837

一个糟糕的 app.config 或 web.config 文件可以做到这一点。我已将 app.config 连接字符串复制到我的 UI 中的 web.config 并最终输入：

```
<connectionStrings>
    <connectionStrings>
          <add name="name" connectionString="normalDetails"/>
    </connectionStrings>
</connectionStrings> 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2014-06-27T06:18:43.423

我只是没有引用包含 EDMX 文件的类库。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2014-09-15T16:01:25.227

使用[此博](http://blogs.teamb.com/craigstuntz/2010/08/13/38628/)文中的信息：

就像其他人所说的那样， res:\\ 是指向您的资源的指针。要检查并确保您的资源名称正确，您可以使用像[JetBrains 的 DotPeek](http://www.jetbrains.com/decompiler/)这样的反编译器来打开您的 .dll 文件并查看您的资源文件。

或者，您可以在调试时打开监视窗口并粘贴此代码以获取当前执行程序集中的资源名称数组。

```
System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceNames() 
```

话虽如此，元数据路径的格式应该类似于：

*{my-assembly-name}/{possibly-a-namespace}.{class-name}.{csdl or ssdl or msl}*

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2016-02-12T19:31:03.220

只需键入路径而不是 {Path.To.The.}： res:// */{Path.To.The.}YourEdmxFileName.csdl|res://* /{Path.To.The.}YourEdmxFileName.ssdl| res://*/{Path.To.The.}YourEdmxFileName.msl

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2010-02-16T17:10:19.623

我的理论是，如果您有多个同名的 edmx 文件（例如 Model1），它将给出该异常。当我决定将所有 edmx 文件（位于不同项目中）命名为 Model1 时，我遇到了同样的问题，因为我认为它们应该是独立的。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2010-09-29T14:30:35.120

此异常的另一个原因是当您在 ObjectQuery 中包含相关表时，但键入了错误的导航属性名称。

例子：

```
var query = (from x in myDbObjectContext.Table1.Include("FKTableSpelledWrong") select x); 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2011-08-10T15:52:34.133

有时未加载包含模型的程序集：

```
 [TestMethod]
    public void TestOpenWithConfigurationAfterExplicit()
    {
        String dummy = typeof(MallApp).Assembly.FullName;  
        //force the assembly loaded.
        using (DbContext ctx = new DbContext("name=MyContainer))
        {
        }
    } 
```

该类型`MallApp`与实体模型位于同一程序集中。如果没有显式加载，`System.Data.MetadataException`则会抛出 an 。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2013-09-20T10:51:27.607

当我解决元数据问题时，我遇到了一个后续问题，即调用异常无法在 app.config 中找到 XXXEntities 的连接字符串（我的目标是不依赖于 app.config）。幸运的是，我发现在我的单元测试项目中引用 System.Data 清除了最后的障碍。所以总结一下：

1.  使用 nuget 将 Entity Framework 安装到您的单元测试项目中。
2.  确保引用 System.Data.Entity 和 System.Data。
3.  如此处所述，对您的连接字符串进行排序。
4.  将连接字符串传递给您的部分类构造函数。

我现在将我的元数据放在一个可以从参考数据库更新的类库中，并且我可以在运行时将我的应用程序和单元测试指向任何服务器上的任何数据库。

附录：当我将我的 edmx 移动到一个文件夹时，我再次收到错误消息。经过一番研究，我发现您希望您的元数据字符串看起来像：metadata=res://EPM.DAL/Models.EPM.csdl，其中 EPM.DAL 是程序集的名称，EPM.edmx 在模型文件夹。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2014-02-13T13:06:29.793

对我来说类似的问题。我的班级名称与我的文件名不同。生成的连接字符串具有类名而不是文件名。对我来说，解决方案只是重命名我的文件以匹配类名。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2016-02-09T15:05:13.787

当我的 emdx 文件被 prebuild 命令删除时，我收到了这个错误，很简单。我花了一段时间才意识到这很简单。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2017-03-07T17:43:51.827

就我而言，这是因为我正在使用 EntityConnectionStringBuilder 构建连接字符串。确保您的元数据属性使用模型名称（包括命名空间）

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2017-10-05T08:19:51.600

将大型解决方案从源代码管理资源管理器中的一个文件夹移动到另一个文件夹后，我遇到了这个问题。我们不会将包文件夹检入 Team Foundation 中，因此我认为 VS 会自动下载包。这将我的 EF 表单 v6.1.2 升级到了 v6.1.3。

当我降级到原来的 v6.1.2 时问题就消失了。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2018-05-24T19:42:28.520

在我的情况下，列出的答案都没有奏效，所以我发布了这个。

就我而言，在 Visual Studio 上构建并使用 IIS express 运行它运行良好。但是当我使用 Nant 脚本作为独立网站进行部署时，出现了错误。我尝试了上面的所有建议，然后意识到由 nant 脚本生成的 DLL 比 VS 生成的要小得多。然后我意识到 Nant 无法找到 .csdl、.msl 和 .ssdl 文件。那么实际上有两种方法可以解决这个问题，一种是在visual studio生成它们后复制所需的文件并将这些文件包含在构建部署中。然后在 Web.config 中，将路径指定为：

```
"metadata=~/bin/MyDbContext.csdl|~/bin/MyDbContext.ssdl|~/bin/MyDbContext.msl;provider=System.Data.SqlClient;...." 
```

这是假设您已手动将文件复制到您正在运行的网站的 bin 目录中。如果它在不同的目录中，则相应地修改路径。第二种方法是在 Nant 脚本中执行 EdmGen.exe 并生成文件，然后将它们作为资源包含在下面的示例中： [https ://github.com/qwer/budget/blob/master/nant.build](https://github.com/qwer/budget/blob/master/nant.build)

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2019-09-27T04:39:24.013

我在 2019 年 9 月 27 日遇到了同样的问题。

我的 API 在 Dot net core Targeting to .net 框架中。edmx 位于仅在 .net 框架中的不同类库中。

我观察到，当我尝试从 API 调用该 edmx 时 .. 出于某种原因，我收到了该错误。

我所做的是，转到 API 的 obj 文件夹并删除所有内容。然后清理 API 项目并重试，这对我有用。

# c++ - 同一个（Boost）DLL的多个版本可以在同一个进程中共存吗？

> ID：689365
> 
> 赞同：9
> 
> 时间：2009-03-27T11:19:52.797
> 
> 标签：c++, dll, boost, version

我的（C++，跨平台）应用程序大量使用`Boost`库（比如 version `1.x`），我还想链接到第 3 方（供应商）的 SDK（无源），它本身使用`Boost`（但 version `1.y`）。

因此，我们都动态链接到我们自己的`Boost`DLL 版本，CRT 是相同的。因此，在运行时，我的应用程序必须同时加载`Boost 1.x & 1.y`.

有哪些潜在问题和相关问题？

我无法更改供应商的 SDK，但我可以更改我的应用程序。也许我应该尝试静态链接我的`Boost 1.x`?

PS：`Boost`的 DLL 的名称包括它们的版本，所以没有名称冲突，两者都是可识别的。不是通常的 DLL 地狱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T18:01:52.177

This is a big problem. Do a search on DLL hell.

Basically the DLL (or shared libs in Linux) are loaded but not all the names are resolved at load time. What happens is a lazy evaluation, so the names are evaluated on first use. The problem is that if 2 dll have the same name then the location where the name is resolved to depends on the what order the DLL are searched in (which depends on load order).

If you statically link then you will not have problems with method calls as yours will all be resolved at compile time and the third party will be resolved at runtime from the DLL. But what about structures that are created by version-1 boost. If you then pass these to the third party library that then passes it to the version-x boost. Are the structures layed out in the same way?

This is a very tricky area and when problems occur very hard to de-bug. So try and use the same version.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T13:51:27.007

至于使用不同版本的DLL应该没有问题。至少在 Windows 上没有。

如果 SDK 在内部使用 boost，这是真的。如果 SDK 在其接口中使用 boost 构造，例如：它有一个返回 boost::optional 的函数，那么拥有多个版本可能会导致问题。它仍然可以正常工作，具体取决于版本之间的更改，但这肯定会有风险。在这种情况下，我不知道有什么好的解决方案。如果您包含一个包含 boost 头文件的 SDK 头文件，这也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T13:34:43.537

如果你写一个函数`foo`，然后从 F.dll 中导出它，然后从 G.dll 中导出另一个函数`foo`，你会期待问题吗？

当 AF.exe 被链接时，链接器被告知：放一些代码`foo`从 F.dll 加载函数的地址。现在 BG.dll 被链接以`foo`从 G.dll 中检索地址。我仍然认为没有问题。

现在将 AF.exe 替换为您的应用程序，将 BG.dll 替换为您供应商的应用程序，将 F.dll 替换为您的 boost 版本，将 G.dll 替换为供应商的 boost 版本。

结论：如果 dll 名称不同，我认为没有问题。

# database - 与服务器带宽相比，数据库带宽要高得多。普通的？

> ID：689368
> 
> 赞同：1
> 
> 时间：2009-03-27T11:22:42.587
> 
> 标签：database, networking, bandwidth, forums

不久前，我们将我们相当受欢迎的论坛转移到一个新的专用服务器（使用相同的主机），我们注意到一些奇怪的事情。起初，我们使用新服务器仅托管数据库，因为这是最大的问题。后来我们转移了论坛文件并更改了域的 dns。

当我们回顾使用的带宽时，我们会看到服务器发送的字节数：

```
database use: 100k/sec  
whole forum use: 25k/sec 
```

注意：服务器接收的字节自始至终都保持在非常低的水平。

那么论坛数据库使用 4 倍于服务器实际发送回用户的网络流量是否正常？对我来说这听起来非常低效，比如从数据库中请求的内容远远超过所需内容，但这是我们在这里讨论的最新版本的 vBulletin。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T11:30:37.703

众所周知，vBulletin 在网络服务器和数据库之间使用了大量的流量。他们建议您在服务器之间的专用 Gbit-NIC 上运行交叉的 cat6 以太网电缆，因为如果这样的话。

我会说这是一个糟糕的设计（可能是因为在应用程序层中执行的逻辑比在数据库中执行的逻辑更多），他们从中挑选出的数据比实际呈现给客户端的数据多得多。

所以我会说这对 vBulletin 来说是正常的，但在大多数其他软件解决方案中并不正常。

如果你用谷歌搜索这个问题，我相信你会发现很多人都有同样的问题。

例如： [http ://www.vbulletin.org/forum/archive/index.php/t-111191.html](http://www.vbulletin.org/forum/archive/index.php/t-111191.html)

如果您的主机不正确地测量带宽，您最终可能还要为大量的内部流量付费，这并不酷 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T11:40:30.627

听起来像这样的场景，MySQL 被视为平面文件，数据逻辑在 PHP 中，而不是在 SQL 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:34:28.503

这是非常低效的。正确编写的 SQL 应该准确地返回您想要的数据，并且此类传输的协议设计得非常高效。然后，您的应用会添加 HTML、javascript、位图等，因此与数据库相比，它应该产生至少两倍的流量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T11:36:23.320

也许数据库返回 UTF-16 而你显示 UTF-8 页面？

# richtextbox - Javascript 富文本编辑器和关联的类来过滤和清理输入？

> ID：689369
> 
> 赞同：1
> 
> 时间：2009-03-27T11:23:16.423
> 
> 标签：richtextbox, xss, filtering, richtext, antixsslibrary

我意识到有几个用于 jQuery 的富文本编辑器，但我找不到任何具有关联类来执行接受输入到数据库中所需的过滤和清理。

这样的类存在吗？

我对 PHP 库特别感兴趣，但 .NET 也会很有趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T11:31:17.280

如果您使用 FCKeditor，它将允许您获得干净的 HTML 或 XHTML (editor.GetXHTML())，然后您可以将其写入 DB。

实际上，您在 DB 中写入的内容并不那么重要，因为通常您会编写原始 HTML（如果需要，您可以随时从其中删除敏感标签）。为了防止 XSS 攻击，必须在网页上显示内容之前正确编码内容。对于 .NET ，CodePlex.com 上提供了[AntiXSS 库](http://www.codeplex.com/AntiXSS)

对于 PHP，您可能需要查看以下库：

*   [Zend_Filter](http://framework.zend.com/manual/en/zend.filter.html)
*   [HTML 消毒剂](http://www.phpclasses.org/browse/package/3746.html)
*   [PHP 输入过滤器](http://www.phpclasses.org/browse/package/2189.html)

还有这篇文章：

*   [避免对使用 HTML 编辑器的网站的 XSS 安全攻击](http://devzone.zend.com/article/1752-Avoiding-XSS-security-attacks-to-sites-that-use-HTML-editors)

# java - 如何复制 Java 集合列表

> ID：689370
> 
> 赞同：148
> 
> 时间：2009-03-27T11:23:20.963
> 
> 标签：java, list, collections, copy

我有一个`ArrayList`，我想准确地复制它。我尽可能使用实用程序类，假设有人花了一些时间使它正确。所以很自然地，我最终得到了`Collections`包含复制方法的类。

假设我有以下内容：

```
List<String> a = new ArrayList<String>();
a.add("a");
a.add("b");
a.add("c");
List<String> b = new ArrayList<String>(a.size());

Collections.copy(b,a); 
```

这失败了，因为基本上它认为`b`不足以容纳`a`. 是的，我知道`b`尺寸为 0，但它现在应该足够大了，不是吗？如果我必须先填充`b`，那么`Collections.copy()`在我的脑海中就变成了一个完全没用的功能。那么，除了编写一个复制功能（我现在要做的）之外，有没有合适的方法来做到这一点？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-03-27T11:25:22.113

`b`容量为 3，但*大小*为 0。具有某种缓冲区容量的事实是实现细节 - 它不是接口的一部分*，*因此不使用它。特殊情况会很难看。*`ArrayList``List``Collections.copy(List, List)``ArrayList`*

 *正如 tddmonkey 所指出的，在提供的示例中，使用带有集合的 ArrayList 构造函数是方法。

对于更复杂的场景（可能包括您的真实代码），您可能会发现[Guava](https://github.com/google/guava)中的集合很有用。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2009-11-06T03:06:37.020

打电话

```
List<String> b = new ArrayList<String>(a); 
```

`a`创建within的浅表副本`b`。所有元素都将以`b`与它们所在的顺序完全相同的顺序存在`a`（假设它有一个顺序）。

同样，调用

```
// note: instantiating with a.size() gives `b` enough capacity to hold everything
List<String> b = new ArrayList<String>(a.size());
Collections.copy(b, a); 
```

`a`还创建了within的浅表副本`b`。如果第一个参数 ,`b`没有足够的*容量*（不是大小）来包含 的所有`a`元素，那么它将抛出一个`IndexOutOfBoundsException`. 期望是不需要分配[`Collections.copy`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#copy%28java.util.List,%20java.util.List%29)来工作，如果有，那么它会抛出该异常。要求预先分配复制的集合是一种优化`b`（

要创建深层副本，`List`无论通过哪种机制，都必须对底层类型有复杂的了解。在`String`s 的情况下，它在 Java（和 .NET 中）是不可变的，您甚至不需要深拷贝。在 的情况下`MySpecialObject`，您需要知道如何对其进行深层复制，这不是通用操作。

* * *

注意：最初接受的答案是`Collections.copy`谷歌中的最高结果，正如评论中指出的那样，它完全是错误的。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2009-03-27T11:25:11.723

做就是了：

```
List a = new ArrayList(); 
a.add("a"); 
a.add("b"); 
a.add("c"); 
List b = new ArrayList(a); 
```

ArrayList 有一个构造函数，它将接受另一个 Collection 以从中复制元素

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-02-24T16:38:33.410

Stephen Katulka 的答案（已接受的答案）是错误的（第二部分）。它解释说它`Collections.copy(b, a);`做了一个深拷贝，但它没有。两者，`new ArrayList(a);`并且`Collections.copy(b, a);`只做一个浅拷贝。不同之处在于，构造函数分配新内存，而`copy(...)`不是，这使得它适用于可以重用数组的情况，因为它在那里具有性能优势。

Java 标准 API 试图阻止使用深拷贝，因为如果新编码人员定期使用它会很糟糕，这也可能`clone()`是默认情况下不公开的原因之一。

`Collections.copy(...)`可以在第 552 行查看 源代码： [http ://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/Collections-Jar-Zip-Logging-regex/java/util/集合.java.htm](http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/Collections-Jar-Zip-Logging-regex/java/util/Collections.java.htm)

如果你需要一个深拷贝，你必须手动迭代这些项目，在每个对象上使用 for 循环和 clone()。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-27T11:25:42.223

复制 List 最简单的方法是将其传递给新列表的构造函数：

```
List<String> b = new ArrayList<>(a); 
```

`b`将是一个浅拷贝`a`

查看`Collections.copy(List,List)`（我以前从未见过）的来源，它似乎是为了按索引处理元素。因此使用`List.set(int,E)`元素 0 将覆盖目标列表中的元素 0 等等。我不得不承认从 javadocs 中不是特别清楚。

```
List<String> a = new ArrayList<>(a);
a.add("foo");
b.add("bar");

List<String> b = new ArrayList<>(a); // shallow copy 'a'

// the following will all hold
assert a.get(0) == b.get(0);
assert a.get(1) == b.get(1);
assert a.equals(b);
assert a != b; // 'a' is not the same object as 'b' 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-27T11:26:40.147

```
List b = new ArrayList(a.size()) 
```

不设置大小。它设置初始容量（在需要调整大小之前可以容纳多少元素）。在这种情况下，一种更简单的复制方法是：

```
List b = new ArrayList(a); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-04-07T16:37:41.297

正如 hoijui 提到的。Stephen Katulka 的选定答案包含有关 Collections.copy 的评论，该评论不正确。作者可能接受了它，因为第一行代码正在做他想要的副本。对 Collections.copy 的额外调用只是再次复制。（导致复制发生两次）。

这是证明它的代码。

```
public static void main(String[] args) {

    List<String> a = new ArrayList<String>();
    a.add("a");
    a.add("b");
    a.add("c");
    List<String> b = new ArrayList<String>(a);

    System.out.println("There should be no output after this line.");

    // Note, b is already a shallow copy of a;
    for (int i = 0; i < a.size(); i++) {
        if (a.get(i) != b.get(i)) {
            System.out.println("Oops, this was a deep copy."); // Note this is never called.
        }
    }

    // Now use Collections.copy and note that b is still just a shallow copy of a
    Collections.copy(b, a);
    for (int i = 0; i < a.size(); i++) {
        if (a.get(i) != b.get(i)) {
            System.out.println("Oops, i was wrong this was a deep copy"); // Note this is never called.
        }
    }

    // Now do a deep copy - requires you to explicitly copy each element
    for (int i = 0; i < a.size(); i++) {
        b.set(i, new String(a.get(i)));
    }

    // Now see that the elements are different in each 
    for (int i = 0; i < a.size(); i++) {
        if (a.get(i) == b.get(i)) {
            System.out.println("oops, i was wrong, a shallow copy was done."); // note this is never called.
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-10-10T09:29:01.150

这里的大多数答案都没有意识到这个问题，用户想要从第一个列表到第二个列表的元素的副本，目标列表元素是新对象，而不是引用原始列表的元素。（意味着更改第二个列表的元素不应更改源列表的相应元素的值。）对于可变对象，我们不能使用 ArrayList(Collection) 构造函数，因为它会简单地引用原始列表元素并且不会复制。复制时，您需要为每个对象提供一个列表克隆器。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-05-01T01:04:31.187

你为什么不只使用`addAll`方法：

```
 List a = new ArrayList();
         a.add("1");
         a.add("abc");

    List b = b.addAll(listA);

//b will be 1, abc 
```

即使您在 b 中有现有项目，或者您想在其后附加一些元素，例如：

```
List a = new ArrayList();
     a.add("1");
     a.add("abc");

List b = new ArrayList();
     b.add("x");
     b.addAll(listA);
     b.add("Y");

//b will be x, 1, abc, Y 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-27T11:25:59.913

如果要复制 ArrayList，请使用以下命令进行复制：

```
List b = new ArrayList();
b.add("aa");
b.add("bb");

List a = new ArrayList(b); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-04-05T16:42:59.347

字符串可以被深度复制

```
List<String> b = new ArrayList<String>(a); 
```

因为它们是不可变的。不是其他所有对象->您需要自己迭代并进行复制。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-07-27T14:48:41.903

```
private List<Item> cloneItemList(final List<Item> items)
    {
        Item[] itemArray = new Item[items.size()];
        itemArray = items.toArray(itemArray);
        return Arrays.asList(itemArray);
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-11-28T05:57:03.110

不是其他所有对象->您需要自己迭代并进行复制。

为了避免这种情况，请实现 Cloneable。

```
public class User implements Serializable, Cloneable {

    private static final long serialVersionUID = 1L;

    private String user;
    private String password;
    ...

    @Override
    public Object clone() {
        Object o = null;
        try {
          o = super.clone();
        } catch(CloneNotSupportedException e) {
        }
        return o;
     }
 } 
```

……

```
 public static void main(String[] args) {

      List<User> userList1 = new ArrayList<User>();

      User user1 = new User();
      user1.setUser("User1");
      user1.setPassword("pass1");
      ...

      User user2 = new User();
      user2.setUser("User2");
      user2.setPassword("pass2");
      ...

      userList1 .add(user1);
      userList1 .add(user2);

      List<User> userList2 = new ArrayList<User>();

      for(User u: userList1){
          u.add((User)u.clone());
      }

      //With this you can avoid 
      /*
        for(User u: userList1){
            User tmp = new User();
            tmp.setUser(u.getUser);
            tmp.setPassword(u.getPassword);
            ...
            u.add(tmp);               
        }
       */

  } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-10-11T14:56:25.333

如果您使用的是 google guava，那么单线解决方案将是

```
List<String> b = Lists.newArrayList(a); 
```

这将创建一个可变数组列表实例。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-07-30T17:40:33.483

以下输出说明了使用复制构造函数和 Collections.copy() 的结果：

```
Copy [1, 2, 3] to [1, 2, 3] using copy constructor.

Copy [1, 2, 3] to (smaller) [4, 5]
java.lang.IndexOutOfBoundsException: Source does not fit in dest
        at java.util.Collections.copy(Collections.java:556)
        at com.farenda.java.CollectionsCopy.copySourceToSmallerDest(CollectionsCopy.java:36)
        at com.farenda.java.CollectionsCopy.main(CollectionsCopy.java:14)

Copy [1, 2] to (same size) [3, 4]
source: [1, 2]
destination: [1, 2]

Copy [1, 2] to (bigger) [3, 4, 5]
source: [1, 2]
destination: [1, 2, 5]

Copy [1, 2] to (unmodifiable) [4, 5]
java.lang.UnsupportedOperationException
        at java.util.Collections$UnmodifiableList.set(Collections.java:1311)
        at java.util.Collections.copy(Collections.java:561)
        at com.farenda.java.CollectionsCopy.copyToUnmodifiableDest(CollectionsCopy.java:68)
        at com.farenda.java.CollectionsCopy.main(CollectionsCopy.java:20) 
```

完整程序的来源在这里：[Java List copy](http://farenda.com/java/java-list-copy)。但输出足以了解 java.util.Collections.copy() 的行为方式。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-12-14T12:24:42.637

由于 Java 8 是空安全的，您可以使用以下代码。

```
List<String> b = Optional.ofNullable(a)
                         .map(list -> (List<String>) new ArrayList<>(list))
                         .orElseGet(Collections::emptyList); 
```

或使用收集器

```
List<String> b = Optional.ofNullable(a)
                         .map(List::stream)
                         .orElseGet(Stream::empty)
                         .collect(Collectors.toList()) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-27T17:16:14.157

如果您想象将某些值复制到现有集合中的用例，则复制并非无用。即你想覆盖现有元素而不是插入。

一个例子：a = [1,2,3,4,5] b = [2,2,2,2,3,3,3,3,3,4,4,4,] a.copy(b) = [1,2,3,4,5,3,3,3,3,4,4,4]

但是，我希望有一个复制方法可以为源和目标集合的起始索引以及计数参数提供额外的参数。

请参阅 Java 错误[6350752](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6350752)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-04-27T18:48:25.517

要了解为什么 Collections.copy() 会引发 IndexOutOfBoundsException，尽管您已经使目标列表的后备数组足够大（通过对 sourceList 的 size() 调用），请参阅 Abhay Yadav 在此相关问题中的回答： [如何将 java.util.List 复制到另一个 java.util.List](https://stackoverflow.com/questions/14319732/how-to-copy-a-java-util-list-into-another-java-util-list)

# grails - YUI DataTable - 如何只有一个分页器？

> ID：689375
> 
> 赞同：2
> 
> 时间：2009-03-27T11:24:04.113
> 
> 标签：grails, yui-datatable

我在使用 Grails UI 插件 1.0.2（YUI 为 2.6.1）的 Grails 1.1 项目中使用 YUI DataTable。

默认情况下，DataTable 显示 2 个分页器：一个在表格上方，另一个在表格下方。查看 YUI API 文档，我可以看到我可以将一组 YUI 容器作为配置参数传递，但是 - 这些容器的名称是什么？

我尝试使用 Firebug 查看页面的 HTML。包含分页器的 div 的 ID 是：yui-dt0-paginator0（上）和 yui-dt0-paginator1（下）。如果我使用它们为导航器配置容器，那么导航器根本不会显示。这是包含 Datatable 元素的 GSP 页面的相关摘录。

```
 <div class="body">
        <h1>This is the List of Control Accounts</h1>
        <g:if test="${flash.message}">
        <div class="message">${flash.message}</div>
        </g:if>
        <div class="yui-skin-sam">
            <gui:dataTable
            controller="controlAccount" action="enhancedListDataTableJSON"
            columnDefs="[
                [key:'id', label:'ID'],
                [key:'col1', label:'Col 1', sortable: true, resizeable: true],
                [key:'col2', label:'Col 2', sortable: true, resizeable: true]
                ]"
            sortedBy="col1"
            rowsPerPage="20"
            paginatorConfig="[
            template:'{PreviousPageLink} {PageLinks} {NextPageLink} {CurrentPageReport}',
            pageReportTemplate:'{totalRecords} total accounts',
            alwaysVisible:true,
            containers:'yui-dt0-paginator1'
            ]"
            rowExpansion="true"
            />
        </div>
    </div> 
```

有什么帮助吗？

谢谢！

罗洛

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T12:19:07.837

好的，我现在有了。在这里发布它以防有人遇到同样的问题。

因此，您要做的就是通过任何 id 创建一个“容器”（DIV 会做），并将其引用到容器配置项中。例子：

```
<div class="body">
    <h1>This is the List of Control Accounts</h1>
    <g:if test="${flash.message}">
    <div class="message">${flash.message}</div>
    </g:if>
            <div class="yui-skin-sam">
                    <gui:dataTable
                    controller="controlAccount" action="enhancedListDataTableJSON"
                    columnDefs="[
                            [key:'id', label:'ID'],
                            [key:'col1', label:'Col 1', sortable: true, resizeable: true],
                            [key:'col2', label:'Col 2', sortable: true, resizeable: true]
                            ]"
                    sortedBy="col1"
                    rowsPerPage="20"
                    paginatorConfig="[
                    template:'{PreviousPageLink} {PageLinks} {NextPageLink} {CurrentPageReport}',
                    pageReportTemplate:'{totalRecords} total accounts',
                    alwaysVisible:true,
                    containers:'dt-paginator'
                    ]"
                    rowExpansion="true"
                    />
            </div>
            <div id="dt-paginator" class="yui-skin-sam yui-pg-container" style="text-align: right;">
</div> 
```

您只需确保与 div 关联的类是 yui-pg-container。作为额外的奖励，该 div 上的样式将使分页器向右对齐。

罗洛

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-05T22:46:17.680

使用 YUI 2.8.0（也许还有 2.6）有一个更简单的方法。只需添加样式：

```
.yui-skin-sam .yui-dt-paginator {
    text-align:right;
} 

#yui-dt0-paginator1 {
    display:none;
} 
```

这样做的好处是分页器与表格的右边框对齐。如果您想在表格底部进行分页，只需将*yui-dt0-paginator1*更改为*yui-dt0-paginator0*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-17T01:56:49.883

我有几十个 YUI 数据表，不想为每个数据表编写一个选择器，所以这就是我所做的。在每个数据表周围创建一个“容器”div，然后使用第一个子选择器将可见性设置为隐藏，如下所示：

```
.container_div .yui-dt-paginator:first-child {
    visibility:hidden;
} 
```

注意 .container_div 可以任意命名。

感谢 Rollo 和 jm 的灵感，这是两种想法的混搭。

# jquery - 如何更改在 Youtube 嵌入式播放器中播放的视频？

> ID：689376
> 
> 赞同：3
> 
> 时间：2009-03-27T11:24:18.980
> 
> 标签：jquery, youtube

我想制作一个播放列表，单击每个播放列表`<li>`都会更改下面的视频链接。该列表将如下所示：

*   视频1

    ```
    <li><a href="MzfAvHlIVjE&hl=en&fs=1&rel=0&color1=0x3a3a3a&color2=0x999999">">video1</a></li> 
    ```

*   bbbb

*   cccc

* * *

视频播放器在这里

* * *

所以点击 aaaaa 会播放 aaaaa ，点击 bbbbb 会播放 bbbbb 等等。

我想让它成为ajax，无需重绘，只需点击即可播放。

这是要编辑的 youtube 对象

```
<object width="320" height="265">
  <param name="movie" value="http://www.youtube.com/v/MzfAvHlIVjE&hl=en&fs=1&rel=0&color1=0x3a3a3a&color2=0x999999"></param>
  <param name="allowFullScreen" value="true"></param>
  <param name="allowscriptaccess" value="always"></param>
  <embed src="http://www.youtube.com/v/MzfAvHlIVjE&hl=en&fs=1&rel=0&color1=0x3a3a3a&color2=0x999999" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="320" height="265"></embed>
</object> 
```

如何更改在 Youtube 嵌入式播放器中播放的视频？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-07-25T23:52:38.923

查看[jQuery TubePlayer 插件](http://www.tikku.com/jquery-youtube-tubeplayer-plugin)--

该插件为您处理播放器初始化，您将能够完全控制播放器..允许您将`jQuery("#player").tubeplayer("play", "[videoId]")`事件处理程序放在您`li`的..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-21T18:15:47.130

我有一些对我有用的东西：

**在头部：**

```
 <script type="text/javascript" src="../../../Assets/js/jquery-1.4.2.min.js"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            $(".button").click(function() {
            $("#playvideo").html(play(  $(this).find("a").attr("linkattr")));           
            return false; 
            });
        });
    function play(id)   {
           var html  = '';     
           html += '<iframe width="671" height="495" src="'+id+'" frameborder="0" allowfullscreen></iframe>';
           return html;
        };  
    </script> 
```

**体内：**

```
 <h2 class="button"><a linkattr="https://www.youtube.com/embed/uopXg6NxboQ?rel=0&amp;showinfo=0" href="#"> video 1 </a></h2>
    <h2 class="button"><a linkattr="https://www.youtube.com/embed/h-v1c2kNw70?rel=0&amp;showinfo=0" href="#"> video 2 </a></h2>

    <div id="playvideo">
          <iframe width="671" height="495" src="https://www.youtube.com/embed/uopXg6NxboQ?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
    </div> 
```

结果见此页面：[https ://cllccavo.asc.ohio-state.edu/Public/Modules/help/howto.php](https://cllccavo.asc.ohio-state.edu/Public/Modules/help/howto.php)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T11:50:34.940

如果您不喜欢弹出窗口，请摆脱它：

```
function play(id)
    {
       var html  = '';

       html += '<object >';
       html += '<param name="movie" value="http://www.youtube.com/v/'+id+'"></param>';
       html += '<param name="autoplay" value="1">';
       html += '<param name="wmode" value="transparent"></param>';
       html += '<embed src="http://www.youtube.com/v/'+id+'&autoplay=1" type="application/x-shockwave-flash" wmode="transparent" ></embed>';
       html += '</object>';

       return html;
    };

<div id="button1" />
<div id="playvideo" />

$("#button1").click(function() { $("#playvideo").html(play("YOURVIDEOID")); }); 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T14:36:13.823

这是最终的解决方案：

[http://www.studioteknik.com/youtube/index2.html](http://www.studioteknik.com/youtube/index2.html)

这是最终代码：

```
<script type="text/javascript"> 
    $(document).ready( function(){
        $(".button").click(function() {
        console.log($(this).find("a").attr("href"));
        $("#playvideo").html(play($(this).find("a").attr("href"))); 
        return false; 
        });
    });
</script>

</head>

<body>

<div>
  <ul>
    <li class="button"><a href="MzfAvHlIVjE&hl=en&fs=1">Video 1</a></li>
    <li class="button"><a href="uN2OGjsLuY8&hl=en&fs=1">Video 2</a></li>
    <li class="button"><a href="EZOTMcqaH98&hl=en&fs=1">Video 3</a></li>
    <li class="button"><a href="PSTDZEZV72Q&hl=en&fs=1">Video 4</a></li>
    <li class="button"><a href="QYlOaoqgMdw&hl=en&fs=1">Video 5</a></li>
    <li class="button"><a href="GEcBhbXEFz8&hl=en&fs=1">Video 6</a></li>
    <li class="button"><a href="cU6sJ0CQWAc&hl=en&fs=1">Video 7</a></li>
    </ul>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T11:36:01.213

查看 jquery youtube 插件：[http ://saidur.wordpress.com/2007/12/03/jquery-youtube-beta-plugin/](http://saidur.wordpress.com/2007/12/03/jquery-youtube-beta-plugin/)

你在这里有一个演示：

[http://bijon.rightbrainsolution.com/youtube/video.html](http://bijon.rightbrainsolution.com/youtube/video.html)

搜索视频后，与您需要的界面完全相同。（所以你可以摆脱搜索功能）

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T07:53:42.410

```
$('#video-player object embed').attr('src', 'http://www.youtube.com/v/' + id + '&hl=en&fs=1&&autoplay=1'); 
```

这似乎也有效，虽然仍然会导致 Flash 播放器的重绘，doh

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-21T22:27:37.520

Marc-Andre Menard - 您能否修改脚本，以便其中一个视频在页面加载时自动加载？

# python - PyQt4 和 QtWebKit - 如何自动滚动视图？

> ID：689384
> 
> 赞同：0
> 
> 时间：2009-03-27T11:26:12.533
> 
> 标签：python, pyqt, qwebview

我`QtWebKit.QWebView`在 PyQt 应用程序窗口中有一个小部件，用于显示类似聊天的应用程序的文本和内容。

```
 self.mainWindow = QtWebKit.QWebView()
    self.mainWindow.setHtml(self._html) 
```

随着对话变长，会出现垂直滚动条。

我想要得到的是在需要时将显示的视图滚动到底部。我该怎么做？或者，也许，我不应该`QWebView`为此使用小部件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T22:23:18.580

对于 (Py)Qt 4.5，使用框架的滚动位置，例如 self._html.page().mainFrame().setScrollPosition。请参阅[QWebFrame::setScrollPosition()](http://doc.trolltech.com/4.5/qwebframe.html#scrollPosition-prop)函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:22:52.490

kender - QWebView 由 QWebPage 和 QWebFrame 组成。滚动条属性存储在 QWebFrame 中，它有一个 setScrollBarValue() 方法，以及一个返回最大位置的 scrollBarMaximum() 方法。

有关详细信息，请参阅这些链接： [QWebView](http://pyqt.sourceforge.net/Docs/PyQt4/qwebview.html)， [QWebFrame](http://pyqt.sourceforge.net/Docs/PyQt4/qwebframe.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-05T04:54:55.353

也许 JavaScript 是最简单的方法，但您也可以使用以下`evaluateJavaScript`功能`QWebView`：

```
self.page().mainFrame().evaluateJavaScript("window.scrollTo(0, "+str(self.init_ypos)+");") 
```

哪里`self`有课`Browser(QWebView)`（`self.mainWindow`给你）。

# vb.net - 更改 datagridview 行中单个单元格的样式

> ID：689388
> 
> 赞同：3
> 
> 时间：2009-03-27T11:28:32.793
> 
> 标签：vb.net, datagrid, datagridview, windows-forms-designer

是否可以为数据网格视图行中的单个单元格提供不同的样式，例如背景颜色、字体颜色等？

我不是说给整行一个新样式，只是一个特定的单元格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:26:03.083

当然：

`Me.myDatagridview.Rows(0).Cells(0).Style.ForeColor = Color.Aqua`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T11:40:13.233

像这样的东西？

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if (e.Row.RowType == DataControlRowType.DataRow)
  {
      string imageName = e.Row.Cells[0].Text.ToString();
      e.Row.Cells[1].Attributes.Add(“Style”,
        “background-image: url(’images/” + imageName + “‘);”);    
  }
} 
```

# asp.net - 从 IIS 6 中的 url 中删除 www

> ID：689391
> 
> 赞同：0
> 
> 时间：2009-03-27T11:29:52.557
> 
> 标签：asp.net, ssl, iis-6

我为 www.mydomain.com 设置了 SSL 证书。我在 IIS 6 中遇到了一个奇怪的问题。当我导航到 www.mydomain.com 时，一切正常。由于万维网。部分是我的 ssl 证书在我没有问题下注册的内容。但是，我网站中的所有链接都将我带到 mydomain.com/mylink，这会导致证书错误，因为它没有以 www 为前缀。我的网站是 ASP.Net，我所有的链接都是相对于根的（换句话说，我指定了 ~/mylink 而不是对 mydomain.com 部分进行硬编码）。知道为什么 IIS 或 asp.net 会从我的所有链接中删除 www 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T11:46:14.497

您可以专门为非 www 设置另一个网站，并强制它重定向回 www 站点。

然后在不同的位置设置日志，看看是否可以让您找到有问题的页面/链接。

否则，您可能必须使用一些链接检查脚本来查看是否有任何链接不正确。通常，您应该在链接中使用“~”，以便它们被 ASP.NET 解析。这应该给你一个应用程序的相对根目录，它不应该给你这个错误。

所以你可能有一些“http ...”链接。

做不到这一点，我想不出另一个原因！

无论如何，HTH。

# delphi - 如何在 Delphi 中对表单进行子类化？最佳实践？

> ID：689402
> 
> 赞同：0
> 
> 时间：2009-03-27T11:32:10.570
> 
> 标签：delphi, forms, inheritance, delphi-2007

我在 Delphi 2007 中有一个基本表单，我想在另一个项目中重用它，添加一些其他按钮等。

我对非 GUI 对象的子类化很熟悉，但是可以以相同的方式对 Form 进行子类化吗？您可以在设计模式下对子类 Form 进行更改吗？

你如何去做这件事，有什么需要注意的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T11:40:26.803

正如 idursun 所说（他比我快一点）：

将基本表单添加到您的新项目中。然后选择“File\New\More...” 在“Delphi-Projects”分支中选择“Inheritable Elements”，找到您的基本表单并单击“OK”。

（菜单项的实际名称可能会有所不同，因为我使用的是德文版的 Delphi 2009）

然后，您可以对新表单或基本表单进行更改。如果我这样做，我确保在 IDE 中打开这两个表单，因为有时如果我不这样做，Delphi 似乎不会获得所有更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T11:37:39.230

您应该将基本表单添加到新项目中，并且在新表单窗口中应该有一个`Inherit`选项卡，您可以在其中为新表单选择基本表单。

# .net - 是否有支持 Linq 查询的缓存

> ID：689410
> 
> 赞同：1
> 
> 时间：2009-03-27T11:34:57.147
> 
> 标签：.net, linq, caching

是否有缓存最好是具有 Linq 查询支持的分布式缓存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T11:43:21.900

我还不知道，但 Velocity 将支持 Linq。我不确定他们是否会在现在任何一天推出的 ctp3 或 v1 上支持它。

[http://weblogs.asp.net/rchartier/archive/2009/03/13/microsoft-velocity-q-amp-a.aspx](http://weblogs.asp.net/rchartier/archive/2009/03/13/microsoft-velocity-q-amp-a.aspx)

# c# - Linq2SQL 继承类型和 OfType 查询

> ID：689411
> 
> 赞同：1
> 
> 时间：2009-03-27T11:35:18.627
> 
> 标签：c#, linq-to-sql, inheritance, datasource, oftype

我有一个使用 Linq2SQL 继承的设置。为了使查询更容易，我也在 DataContext 中公开了派生类型，如下所示：

```
public IQueryable<Derived> Derivations 
{
  get { return Bases.OfType<Derived>(); } // filter list on type
} 
```

调用它非常有效，我可以看到 SQL 正在正确生成。支持类型是 DataQuery<T>。

当我将此 IEnumerable 分配给数据源（控件或 BindingSource）时，问题就出现了。

从我所见，DataQuery 对象被查询为 IListSource。它很乐意提供这个。然后它继续创建一个 BindingList，由于提供的 2 个参数（IEnumerable<Derived> 和 Table<Base>）的类型参数不匹配，该 BindingList 失败。由于找不到构造函数，它会引发 MissingMethod 异常。

简单的解决方法是在分配给数据源之前在 IQueryable<Derived> 上调用 ToList() ，然后它就可以工作了，但这很累人。

有什么建议可以在不“丢失” IQueryable 的情况下处理这个问题？

谢谢

雷比

**更新：**

该错误现已报告给 MS。更多细节[在这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=427574)。谢谢马克！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T11:46:30.847

确认的。对我来说看起来像一个错误；你应该登录[Connect](https://connect.microsoft.com/VisualStudio/)。该团队[正在修复 LINQ-to-SQL 错误](http://marcgravell.blogspot.com/2009/02/linq-to-sql-not-quite-dead-yet.html)，因此它可能不会被忽略。现在，使用`.ToList()`等。

示例代码：

```
using (var ctx = new MyDataContext())
{
    var qry = ctx.BaseEntities.OfType<DerivedEntity>();
    IListSource ls = (IListSource)qry;
    IList list = ls.GetList(); // boom
    /* Constructor on type
       'System.Data.Linq.Provider.DataBindingList`1[snip]'
       not found.*/
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-25T16:33:23.367

我有同样的问题（仍然没有修复 MS 家伙！）。

为了保持 IQueryable 我`.Cast<object>()`在分配给数据源时做了一个（我用它从我想要在 DynamicData 网站中的任何 L2S 表中输出 xls 文件）。

# visual-studio - 源代码查看器可并排显示同一文件的各个部分

> ID：689412
> 
> 赞同：0
> 
> 时间：2009-03-27T11:35:23.977
> 
> 标签：visual-studio, language-agnostic, ide

是否有任何工具或 IDE 功能允许并排查看*同一文件的不同部分。*

我经常认为这对于分析和重构文件中的重复代码很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T11:41:58.877

任何程序员编辑器都应该支持这一点——vim 肯定支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T11:41:23.200

您也可以使用[Beyond Compare](http://www.scootersoftware.com/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T12:13:21.267

notepad++ -> 视图 -> 克隆到另一个视图

您甚至可以同步滚动同一文件上的两个不同位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T14:42:42.560

我已经使用 Beyond Compare 多年了，这是我发现的最好的。特别是因为你有能力做差异以及只看文件。这个工具也是我发现的最好的二进制比较工具。看看 www.scootersoftware.com

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T11:38:03.863

在 VisualStudio 中：窗口菜单，拆分？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T11:53:54.090

记事本++ ...

它免费且易于使用

# c# - pdb 是否提供有关源文件中类型定义的信息？

> ID：689413
> 
> 赞同：1
> 
> 时间：2009-03-27T11:35:52.370
> 
> 标签：c#, .net, debugging, assemblies, pdb-files

我知道 DIA api，dbghelp。但是我可以使用它们从我的程序集和生成的 pdb 中提取类型定义位置信息，例如文件、begin_line、begin_column、end_line、end_column 吗？

如果答案是肯定的，有人可以指点我那里的简单例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T09:19:47.023

您可以查看 Codeplex 上的[Common Compiler Infrastructure - Metadata](http://ccimetadata.codeplex.com/)项目。它可以读取 pdb 文件，但我无法看到获取类的源位置，只有成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T09:39:52.453

答案是肯定的，看看 Mono.Cecil

# jquery - jQuery sortable - 如何添加排序指示器？

> ID：689422
> 
> 赞同：0
> 
> 时间：2009-03-27T11:38:26.047
> 
> 标签：jquery, sorting, jquery-ui-sortable, draggable, indicator

我已经成功实现了 jQuery sortable() 插件，但想用一个排序指示器来增强它。这将是可拖放项目之间的垂直条。有关示例，请参见下图。这可以通过 sortable() 插件轻松实现吗？

[替代文字 http://www.host2000.be/_temp/sortable.jpg](http://www.host2000.be/_temp/sortable.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:52:47.470

使用仅在一侧显示边框的样式的[放置占位符。](http://jqueryui.com/demos/sortable/#placeholder)

# domain-driven-design - 考虑到领域驱动设计，您如何为角色/关系建模？

> ID：689436
> 
> 赞同：5
> 
> 时间：2009-03-27T11:43:36.593
> 
> 标签：domain-driven-design, entity-relationship

如果我有三个实体，Project、ProjectRole 和 Person，其中一个 Person 可以是不同项目的成员并处于不同的项目角色（例如“项目负责人”或“项目成员”） - 你将如何建模这种关系?

在数据库中，我目前有以下表格：Project、Person、ProjectRole Project_Person，其中 PersonId 和 ProjectId 作为 PK，ProjectRoleId 作为 FK 关系。

我真的很茫然，因为我提出的所有域模型似乎都违反了一些“DDD”规则。这个问题有什么“标准”吗？

我查看了 Streamlined Object Modeling 并且有一个 Project 和 ProjectMember 的示例，但 Project 中的 AddProjectMember() 会调用 ProjectMember.AddProject()。所以 Project 有一个 ProjectMember 列表，并且每个 ProjectMember 作为回报都有一个对该项目的引用。对我来说看起来有点令人费解。

**更新**

在阅读了有关此主题的更多信息后，我将尝试以下操作： 在我的领域中有不同的角色，或者更好的模型关系，它们属于某种**角色类型**。例如，ProjectMember 是一个独特的角色，它告诉我们有关人员在项目中所扮演的关系的一些信息。它包含一个 ProjectMembershipType，它告诉我们更多关于它将扮演的角色。我确实知道人们必须在项目中扮演角色，所以我将模拟这种关系。

可以创建和修改 ProjectMembershipTypes。这些可以是“项目负责人”、“开发人员”、“外部顾问”或其他不同的人。

一个人在一个项目中可以有很多角色，这些角色可以在某个日期开始和结束。这种关系由类 ProjectMember 建模。

```
public class ProjectMember : IRole
{
    public virtual int ProjectMemberId { get; set; }
    public virtual ProjectMembershipType ProjectMembershipType { get; set; }

    public virtual Person Person { get; set; }
    public virtual Project Project { get; set; }
    public virtual DateTime From { get; set; }
    public virtual DateTime Thru { get; set; }
    // etc...
} 
```

ProjectMembershipType：即。“项目经理”、“开发人员”、“顾问”

```
public class ProjectMembershipType : IRoleType
{
    public virtual int ProjectMembershipTypeId { get; set; }
    public virtual string Name { get; set; }
    public virtual string Description { get; set; }

    // etc...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T14:35:31.430

这是我将如何处理它：

```
class Person
{
  string Name { get; set; }
  IList<Role> Roles { get; private set; }
}

class Role
{
  string Name { get; set; }
  string Description { get; set; }
  IList<Person> Members { get; private set; }
}

class Project
{
  string Name { get; set; }
  string Description { get; set; }
  IList<ProjectMember> Members { get; private set; }
}

class ProjectMember
{
  Project Project { get; private set; }
  Person Person { get; set; }
  Role Role { get; set; }
} 
```

**ProjectMember**类将它们组合在一起。该模型使您可以灵活地将同一个人分配给具有不同角色的不同项目（例如，他可能是 ProjectA 的开发人员和 ProjectB 的测试人员）。

请不要创建特定于角色的课程 - 该课程已经学到了。

我创建了一个[示例应用程序](http://www.evolving-software.co.uk/downloads/stack-overflow-689436-roles-relationships-sample.zip)来演示这一点（它也包括关系）：

1.  运行“ *bin\debug\RolesRelationshipsSample.exe* ”
2.  双击库图标以创建实体
3.  拖放它们以分配适当的关系

随意玩代码。希望你觉得它有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:00:44.867

您正在为多对多关系建模：一个项目可以有很多人参与，一个人可以参与多个项目。

您将关系建模为项目角色，它除了作为来自 Person <-> Project 的双向链接之外，还记录了 RoleType 和填充该项目上该 RoleType 的那个人的开始/结束。（注意英语中的“that”是如何代表数据库 FK 或者在代码中是指针/引用？）

由于这些 FK，我们可以在数据库中遵循从 Person 到 Project Role 到 Project 的图表：

```
select a.person_id, b.project_role_id, c.project_id
from person a join project_role b on (a.id = b.person_id)
join project c on (b.project_id = c.id)
where a.person_id = ? 
```

或者我们可以从 Project 的另一个方向跟随它：

```
select a.person_id, b.project_role_id, c.project_id
from person a join project_role b on (a.id = b.person_id)
join project c on (b.project_id = c.id)
where c.project_id = ? 
```

理想情况下，我们希望能够在 C# 代码中做同样的事情。所以是的，我们希望 Person 有一个列表，Project 有一个列表，并且 ProjectRole 引用一个 Person 和一个 Project。

是的，`Project::addPerson( Person& )`应该是`Project::addProjectRole( ProjectRole& )`，除非我们认为这`Project::addPerson( Person& )`是一种方便的形式：

```
void Project::addPerson( Person& p ) {
  this.addProjectRole( new ProjectRole( p, &this, RoleType::UNASSIGNED ) ;
} 
```

ProjectRole 没有列表，它具有对 Person 的引用和对 Project 的引用。它还具有作为值的开始日期、结束日期和 RoleType（它要么是一个枚举，要么是一个模拟枚举值的类实例——也就是说，每个枚举类型只有一个对象，它是无状态、不可变和幂等，因此可以在许多 ProjectRoles 之间共享）。

现在这不应该意味着从数据库中检索一个 Person 应该导致整个数据库在代码中的对象图中被具体化；仅在使用时检索的惰性代理可以使我们摆脱这种情况。然后，如果我们当前只关心 Person，而不是他的角色（和项目，我们可以只检索 Person。（例如，NHibernate，我认为这或多或少是无缝的。）

基本上，我认为：

1）这是表示多对多关系的标准方式；2) 一个关系有额外的数据（什么时候，什么样的）是标准的；3）您的想法几乎是正确的，并且在此处获得反馈时非常认真。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:52:39.223

您不会将角色的“描述”与一个人在项目中的角色混淆吗？添加“RoleDescription”概念（可以说是“角色类”）和指代项目中实际人员的“RoleInstance”对象可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T12:39:43.107

您所拥有的是与附加数据、角色的多对多关系。我们有一个类似的结构，除了在我们的例子中一个人可能在一个项目中扮演多个角色，所以我在同样的问题上挣扎。一种解决方案是创建一个扩展 Person 并添加角色属性的 ProjectPerson 类：

```
public class ProjectPerson : Person
{
    public string Role { get; set; }
} 
```

您的 Project 类现在有一个 ProjectPerson 的集合，但 Person 类有一个 Project 的集合，因为扩展 Project 类以添加角色没有意义。您必须做一些额外的工作（在 ProjectPerson 集合中查找 Person）才能从 Person 的角度找到 Project 中的角色。

第二种解决方案是使用附加数据处理多对多关系的标准方法。创建一个 ProjectRole 类并将其建模为来自 Project 和 Person 的两个一对多关系的多面。也就是说，Project 和 Person 都有一个 ProjectRole 的集合。

重要的是要考虑您的数据访问策略在选择解决方案时对模型的支持程度。您希望避免加载集合需要为集合中的每个对象访问数据库一次或多次的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-29T00:19:25.067

似乎有两个主要实体 - 项目和项目成员。项目成员具有“成员角色”和“成员名称”属性。这些属性中的任何一个都可能属于一个域，即可以在查找表中维护的一组值，既方便又用于搜索。假设有人需要有关执行特定角色/工作的所有项目成员的信息。

笔记。查找表可以添加条目，但通常不会更改条目的值。一旦从查找表中选择了一个值，那么它就被认为是拥有表的永久固定装置 - 在这种情况下是项目成员表。

我不希望在任何业务中看到“人员”实体或表，除了上述情况中作为查找表的便利性。人力资源部门将保留一份员工名单，这些员工拥有工资单等所需的特定信息，但除了企业需要知道的人之外，没有什么基本的信息。注意：定位业务流程以识别实体 - 不要虚构。

# c# - 具有多个结果的 NHibernate 标准

> ID：689439
> 
> 赞同：1
> 
> 时间：2009-03-27T11:44:38.650
> 
> 标签：c#, nhibernate

使用 HQL，您可以构建如下查询，该查询将为通过在 select 子句中使用逗号分隔列表选择的每一行返回一个对象数组：

选择**mother, offspr, mate.Name** from Eg.DomesticCat as mother inner join mother.Mate as mate left outer join mother.Kittens as offspr

您将如何使用 ICriteria 来做到这一点？具体来说，我正在尝试构建一个分页查询，该查询还返回同一查询中的总行数。

Ayende 展示了如何使用 HQL ( [http://ayende.com/Blog/archive/2007/04/27/Paged-data--Count-with-NHibernate-The-really-easy-way.aspx](http://ayende.com/Blog/archive/2007/04/27/Paged-data--Count-with-NHibernate-The-really-easy-way.aspx) ) 做到这一点。我需要使用 ICriteria 来复制它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T18:15:49.193

我认为答案在于预取您想要的关联。这样，您可以一次获取对象图的所需部分。您可以在这样的条件查询中执行此操作。

```
ICriteria query = session.CreateCriteria(typeof (Cat))
.SetFetchMode("Mate", FetchMode.Join)
.SetFetchMode("Kittens", FetchMode.Join);

IList<Cat> results = query.List<Cat>(); 
```

这将为您返回一个预先填充了 Mate 和 Kittens 的猫列表。然后，您可以导航到这些属性而不会产生 N+1 惩罚。如果您需要更扁平的结果，我会使用 linq 来完成，也许像这样。

```
var results = query.List<Cat>()
  .Select((c) => new {mother = c, mate = c.Mate, offspr = c.Kittens}); 
```

这将为您返回具有给定属性的匿名类型的扁平列表。如果您只需要预取对象图，这将起作用。但是，如果您需要预取诸如计数或总和之类的内容，则需要检查 Criteria 查询的 Projections 和 Alias 部分。

还有一件事。如果您尝试完全复制上述查询，您可以这样做。

```
ICriteria query = session.CreateCriteria(typeof (Cat), "mother")
.CreateAlias("Mate", "mate", JoinType.InnerJoin)
.CreateAlias("Kittens", "offspr", JoinType.LeftOuterJoin)
.SetResultTransformer(Transformers.AliasToEntityMap); 
```

这将返回与您的 hql 查询基本相同的结果，但是它不会使用索引列表，而是使用将别名映射到实体的字典。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T19:06:09.390

您可以通过这种方式将您的条件转换为计数条件

```
DetachedCriteria countCriteria = CriteriaTransformer.TransformToRowCount(criteria); // criteria = your criteria
rowCount = countCriteria.GetExecutableCriteria(session).UniqueResult<int>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:17:36.413

Ayende 还添加了多标准支持：[http](http://ayende.com/Blog/archive/2007/05/20/NHibernate-Multi-Criteria.aspx) ://ayende.com/Blog/archive/2007/05/20/NHibernate-Multi-Criteria.aspx 。显然，这是在 2.0 版本中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:49:58.260

您还可以通过在 Criteria 上操作结果集来进行分页：

ICriteria 查询 = session.CreateCriteria(typeof (Cat), "mother")

查询.SetFirstResult(x); // x = 页面开始

query.SetMaxResults(y); // y = 页面大小

列表结果 = query.List();

# xml - XSLT 和命名空间的问题

> ID：689443
> 
> 赞同：3
> 
> 时间：2009-03-27T11:46:06.073
> 
> 标签：xml, xslt

我是 XSLT 的新手，所以这个问题可能已经在其他时候得到了回答。我已经搜索过，但我没有找到任何东西:(

我需要像这样解析 XML

```
<ns1:tagName1>
    <ns2:tagName2>
          This is the content
    </ns2:tagName2>       
</ns1:tagName1> 
```

我为此使用了这个 XSL

```
<xsl:template match="ns1:tagName1">
    <resultns1>
        <xsl:if test="ns2:tagName2">
            <resultns2>
                <xsl:value-of select=".">
            </resultns2>
        </xsl:if>
    </resultns1>
</xsl:template> 
```

我期望的结果是

```
<resultns1>
    <resultns2>
        This is the content
    </resultns2>       
</resultns1> 
```

但我得到的不是它，而是

```
<resultns1/> 
```

如果两个标签使用相同的命名空间，一切都按预期工作，但如果外部标签在 ns1 中，而内部标签在 ns2 中，则不会检测到内部标签。关于为什么会发生这种情况的任何线索？

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T12:01:46.583

这对我来说可以; xml:

```
<?xml version="1.0" encoding="utf-8" ?>
<xml xmlns:ns1="foo" xmlns:ns2="bar">
  <ns1:tagName1>
    <ns2:tagName2>
      This is the content
    </ns2:tagName2>
  </ns1:tagName1>
</xml> 
```

xslt：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:ns1="foo" xmlns:ns2="bar"
    exclude-result-prefixes="ns1 ns2"
>
  <xsl:template match="/xml">
    <xsl:apply-templates select="*"/>
  </xsl:template>

  <xsl:template match="ns1:tagName1">
    <resultns1>
      <xsl:if test="ns2:tagName2">
        <resultns2>
          <xsl:value-of select="."/>
        </resultns2>
      </xsl:if>
    </resultns1>
  </xsl:template>
</xsl:stylesheet> 
```

结果：

```
<?xml version="1.0" encoding="utf-8"?>
<resultns1>
  <resultns2>
    This is the content
  </resultns2>
</resultns1> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T11:50:11.680

XSLT 需要声明与 XML 文件相同的名称空间。也许您的 ns2 声明在两个文件之间略有不同？要特别注意字母的大小写（区分大小写）和斜杠等。命名空间字符串必须完全匹配。

如果这没有帮助，也许您可​​以发布一个完整的 XML 和 XSLT 文件来演示您遇到的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T12:27:52.150

哎哟！

在准备完整的 XML 和 XSLT 时，我意识到两个文件中的命名空间指的是不同的模式 :(

所以尽管它们使用相同的名称，但通过使用不同的模式使它们不同

非常感谢您为我指出正确的方向:)

# algorithm - 使用散列查找浮点数数组的模式

> ID：689446
> 
> 赞同：2
> 
> 时间：2009-03-27T11:46:14.903
> 
> 标签：algorithm, language-agnostic, hash

我最近读到一种涉及散列的方法可能是找到浮点数数组模式的好方法。我对散列或其应用了解不多，文本也没有进一步解释。

有谁知道这种方法会涉及什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T12:02:32.803

不是一个统计专家，这种意义上[的模式](http://en.wikipedia.org/wiki/Mode_%28statistics%29)似乎被定义为“最常出现的值”。

从该描述来看，使用哈希表实现这一点的明显方法似乎是使用数字作为键，并作为存储的值，使用频率计数器。

然后只需遍历每个数字，在 Python 伪代码中，这将类似于：

```
array = [1.0, 1.2, 0.4, ...] # A bunch of numbers
counts = {}
for a in array:
  if a in counts:
    counts[a] += 1
  else:
    counts[a] = 1 
```

然后你需要提取最大值，并找到它对应的键：

```
sorted([(v, k) for k, v in counts.items()])[-1][1] 
```

这将创建（值，键）对的排序列表，按值排序，然后`[1](http://en.wikipedia.org/wiki/Mode_%28statistics%29)`从最后一个（`[-1]`）对中提取键（ ）。

我没有费心使用 defaultdict 或等效的，为了说明，我认为这`if`很有帮助。

**注意：**我不保证这是解决问题的规范方法。如果有人要求我解决问题（并且可能暗示使用哈希是一个好主意），这正是我会做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T17:47:02.227

[**Ĵ**](http://www.jsoftware.com/)

```
 NB. random array of floating-point numbers
   ] y =: 10 (?@$%]) 5
0 0.6 0.2 0.4 0.4 0.8 0.6 0.6 0.8 0
   NB. count occurrences
   ({:,#)/.~ y
  0 2
0.6 3
0.2 1
0.4 2
0.8 2
   NB. order by occurrences
   (\:{:"1)({:,#)/.~ y
0.6 3
  0 2
0.4 2
0.8 2
0.2 1
   NB. pick the most frequent
   {.{.(\:{:"1)({:,#)/.~ y
0.6 
```

我建议不要使用哈希，因为它假设精确的比较——对浮点数从来不是一个好的假设。您总是想做某种[epsilon 比较](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm)。如果您的数组包含一些元素`0.2(00000000)`和`0.2(00000001)`，它们确实应该被认为是相等的，但不是因为它们来自不同的计算？

方便的是，默认情况下，**J**总是进行 epsilon-comparison。太方便了，因为它隐藏在中`/.~`，我必须编写更多代码才能演示如何在 Python 等其他语言中执行此操作......

```
epsilon = 0.0001
def almost_equal(a, b):
    return -epsilon <= a-b <= epsilon

array = [0.0, 0.6, 0.2, 0.4, 0.4, 0.8, 0.6, 0.6, 0.8, 0.0]

# more efficient would be to keep this in sorted order,
# and use binary search to determine where to insert,
# but this is just a simple demo
counts = []
for a in array:
    for i, (b, c) in enumerate(counts):
        if almost_equal(a, b):
            counts[i] = (b, c + 1)
            break
    else:
        counts.append((a, 1))

# sort by frequency, extract key of most frequent
print "Mode is %f" % sorted(counts, key = lambda(a, b): b)[-1][0] 
```

# mysql - 我们如何在 MySQL 5.0 中重命名数据库名称

> ID：689451
> 
> 赞同：12
> 
> 时间：2009-03-27T11:46:54.947
> 
> 标签：mysql

我在用`MySQL 5.0.`

我创建了一个名为 的数据库`accounts`，但现在我想将数据库名称更改为`FinanceAccounts`.

如何更改数据库名称`MySQL 5.0`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-27T11:53:54.853

我认为只有一种方法（除了重命名 MySQL 数据目录中的目录，这对于 InnoDB 表将失败）：

*   创建新数据库（使用新名称）
*   转储旧数据库
*   将转储的数据导入新数据库
*   删除旧数据库

要创建新数据库：

```
mysql> CREATE DATABASE new_database; 
```

要创建旧数据库的转储：

```
mysqldump -u "your_username" -p --lock-tables old_database > old_database_dump.sql 
```

要将转储的数据导入新数据库：

```
mysql -u "your username" -p new_database  < old_database_dump.sql 
```

要删除旧数据库：

```
mysql> DROP DATABASE old_database; 
```

请记住，您对旧数据库的权限也需要删除。有关更多信息，请参见此处： [撤销 MySQL DB 上所有用户的所有权限](https://stackoverflow.com/questions/5287377/revoke-all-privileges-for-all-users-on-a-mysql-db)

MySQL 5.1.7 到 MySQL 5.1.22 有一个`RENAME {DATABASE | SCHEMA} db_name TO new_db_name;`命令，但是这个命令在 MySQL 5.1.23 中因为太危险而被删除了。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-27T11:55:17.893

最好的方法可能是将数据库中的每个表重命名为新名称。例如：

更新：这里有两个步骤

1.  如您所愿，创建一个新的空白数据库“新帐户”

    创建数据库新帐户；

2.  逐个迁移每个表

    将表 account.tablename 重命名为 newaccounts.tablename；

有关详细信息，请参阅 [http://dev.mysql.com/doc/refman/5.0/en/rename-table.html](http://dev.mysql.com/doc/refman/5.0/en/rename-table.html) 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-31T09:52:39.250

在这里，我将 mydb 数据库重命名为 ecommerce，您按照此步骤操作，但使用 phpmyadmin 很容易

```
CREATE DATABASE `ecommerce` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

RENAME TABLE `mydb`.`Articles` TO `ecommerce`.`Articles` ;

RENAME TABLE `mydb`.`Categories` TO `ecommerce`.`Categories` ;

RENAME TABLE `mydb`.`Utilisateurs` TO `ecommerce`.`Utilisateurs` ;

ALTER TABLE `Articles` ADD CONSTRAINT fk_Articles_Categories FOREIGN KEY ( Categorie_id ) REFERENCES Categories( id ) ON DELETE NO ACTION ON UPDATE NO ACTION ;

DROP DATABASE `mydb` ; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-27T15:41:16.903

MySQL对此有点糟糕。唯一可靠的解决方案是使用 phpMyAdmin。

登录>单击方案>单击“操作”>找到“将数据库重命名为：”>写入新名称>单击“开始”。

就如此容易。所有权限都被继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-26T11:28:43.397

要重命名 MySQL 数据库名称，请执行以下步骤：

```
1) Click the database name 

2) Click at Operations from the top menu

3) Type new database name Under Rename database to: 
```

[![请检查屏幕截图](https://i.stack.imgur.com/EHXlL.png)](https://i.stack.imgur.com/EHXlL.png)

# php - 建立一个安全的投票系统

> ID：689453
> 
> 赞同：2
> 
> 时间：2009-03-27T11:47:42.747
> 
> 标签：php, validation

我目前负责建立一个轮询系统（使用 PHP）。

现在，为了尽可能安全和客观，访问者只能投票一次，这一点很重要。我正在考虑通过访问者的 IP 验证民意调查（一个 IP 只能投一票），并且可能会进行验证码测试，以确保一旦由于某种原因通过 IP 验证，没有机器人可以进入.

1.  就是这样，唯一IP验证和验证码。但这足够了吗？单个用户是否有可能通过使用代理或其他我不知道的方式更改他/她的 IP，并使用唯一 IP 多次投票？

2.  有没有更好的方法来做到这一点？最好没有验证码。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T12:17:49.103

当它是一个不需要登录的公共投票系统时，绝对**没有办法确保用户投票过一次。**

出于多种原因，检查 IP 不是一个好主意。正如其他答案中所述，许多网络都在一个 ip 后面，用户可以使用另一台具有不同 ip 的 PC 并再次投票。

**开放标识**

使用 OpenId 来识别用户并检查他们是否已经投票。

**注册用户**

或者，如果用户没有 openid 帐户，您可以允许他们自己注册。

为了实现一个安全的系统，其中会话欺骗，因此多重投票，很难[阅读这个](http://jaspan.com/improved_persistent_login_cookie_best_practice)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T12:08:32.773

您无法创建 100% 安全的投票系统。

*   如果是基于注册/IP/cookie，用户可以创建一个新用户/获取另一台PC/删除所有cookie。

但是您可以尝试使用**自动前置过滤器 + 管理员作为后置过滤**器工作流程：

*   *使用 cookie（或 IP/浏览器属性/等）自动*过滤防止多次投票。
*   在管理员视图中，管理员可以根据 IP 或子网地址*手动解析和删除投票。*这也不是一个完美的解决方案，但是通过一些好的查询（来自相同 IP/子网的相同时间间隔内的相同投票）管理员可以轻松删除可疑投票。

该解决方案的一大缺点是需要管理员。但是 - 我认为 - 没有完美的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T12:17:42.083

除非您需要[CA](http://en.wikipedia.org/wiki/Certificate_authority)验证身份，否则您无法确定每个人只投票一次。当然，这完全是矫枉过正，所以真正的问题是：如何让多票变得更加困难。

*   带有验证码的电子邮件。恕我直言，矫枉过正，但取决于你想成为多么确定。
*   使用 session 检查谁投票。显然不是 100% 安全，但会阻止 99% 的人。
*   使用 cookie 检查谁投票。像上面一样，有些人会知道如何删除 cookie。
*   使用 POST，忽略 GET。
*   使用上述 2 或 3 的组合。

如果您要使用 IP 进行验证，请不要使用 just **`REMOTE_ADDR`**，要与 whole 结合使用**`X-Forwarded-For`**。这样您就不会阻止人们通过同一代理进行连接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T11:59:20.597

不要走唯一IP的方式。在很多情况下，很多用户都拥有相同的 ip（即意大利 isp fastweb、大公司等）。另外，如果用户有动态IP，它可以在每次他喜欢的时候改变它自己的IP地址......

最好的方法之一应该是使用电子邮件地址和 cookie。用户将能够多次投票（您无法避免这种情况），但至少每次投票都需要一些时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T12:02:03.757

对于一个类似的项目，我做了 2 次验证......我放置了一个 cookie 并在服务器上保存了来自用户 ip + 用户代理的哈希值。这似乎非常有效，因为即使有更多的人使用相同的 IP，用户代理的哈希在大多数情况下也会有所不同，因为它对于相同的浏览器会有所不同，具体取决于操作系统和安装的其他扩展。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T12:00:51.263

没有万无一失的方法可以防止多票。检查 cookie 是另一种选择。

关于验证 IP 地址。如果用户来自许多用户使用的网络怎么办？

# mysql - 在一个表中查找重叠（日期/时间）行

> ID：689458
> 
> 赞同：14
> 
> 时间：2009-03-27T11:49:51.867
> 
> 标签：mysql

我有一个表格，它在每一行中存储一个会议，其中包含开始日期/时间和结束日期/时间。

meetingID int
meetingStart datetime
meetingEnd datetime

期望的输出：对于每一对重叠的行，我想输出
meetingID、meetingStart、meetingID、meetingEnd

在 MySQL 中执行此类查询的最有效方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-27T11:54:35.460

```
SELECT  m1.meetingID, m1.meetingStart, m1.meetingEnd, m2.meetingID
FROM    t_meeting m1, t_meeting m2
WHERE   (m2.meetingStart BETWEEN m1.meetingStart AND m1.meetingEnd
        OR m2.meetingEnd BETWEEN m1.meetingStart AND m1.meetingEnd)
        AND m1.meetingID <> m2.meetingID 
```

这将选择每对两次。

如果您希望每对只选择一次，请使用：

```
SELECT  m1.meetingID, m1.meetingStart, m1.meetingEnd, m2.meetingID
FROM    t_meeting m1, t_meeting m2
WHERE   (m2.meetingStart BETWEEN m1.meetingStart AND m1.meetingEnd
        OR m2.meetingEnd BETWEEN m1.meetingStart AND m1.meetingEnd)
        AND m2.meetingID > m1.meetingID 
```

确保您有索引`meetingStart`并且`meetingEnd`查询可以有效地工作。

`MySQL`但是，可能会使用它`INDEX MERGE`来运行此查询，这在当前实现中效率不高。

您也可以尝试使用：

```
SELECT  m1.*, m2.*
FROM    (
        SELECT  m1.meetingID AS mid1, m2.meetingID AS mid2
        FROM    t_meeting m1, t_meeting m2
        WHERE   m2.meetingStart BETWEEN m1.meetingStart AND m1.meetingEnd
                AND m2.meetingID <> m1.meetingID
        UNION
        SELECT  m1.meetingID, m2.meetingID
        FROM    t_meeting m1, t_meeting m2
        WHERE   m2.meetingEnd BETWEEN m1.meetingStart AND m1.meetingEnd
                AND m2.meetingID <> m1.meetingID
        ) mo, t_meeting m1, t_meeting m2
WHERE   m1.meetingID = mid1
        AND m2.meetingID = mid2 
```

，它更复杂，但很可能会运行得更快一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-16T15:40:53.383

尝试使用此查询。Quassnoi 的解决方案被修改为忽略一个预订的结束与另一个预订的开始相同的情况。

```
SELECT  m1.meetingID_id, m1.meetingStart , m1.meetingEnd, m2.meetingID_id
FROM    bookings m1, bookings m2
WHERE   (m2.meetingStart BETWEEN m1.start AND DATE_SUB(m1.meetingEnd, INTERVAL 1 second)
        OR DATE_SUB(m2.meetingEnd, INTERVAL 1 second) BETWEEN m1.meetingStart AND m1.end)
        AND m1.meetingID_id > m2.meetingID_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T11:59:17.133

大概是这样的：

```
SELECT m1.meetingID, m2.meetingID
FROM meeting AS m1, meeting AS m2
WHERE m1.meetingID < m2.meetingID
    AND m1.meetingStart BETWEEN m2.meetingStart AND m2.meetingEnd
    OR m1.meetingEnd BETWEEN m2.meetingStart AND m2.meetingEnd 
```

通过仅选择`m1.meetingID < m2.meetingID`您不会将行与其自身进行比较并且不会重复，因为每行将被连接两次 (m1, m2) 和 (m2, m1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T12:53:27.690

将会议的开始时间和结束时间添加到结果行：

```
SELECT m1.meetingID AS firstID, m1.meetingStart AS firstStart, 
m1.meetingEnd AS firstEnd, m2.meetingID AS secondID, 
m2.meetingStart AS secondStart, m2.meetingEnd AS secondEnd 
FROM meeting AS m1, meeting AS m2 
WHERE (m2.meetingStart BETWEEN m1.meetingStart AND m1.meetingEnd) 
AND (m1.meetingID != m2.meetingID) 
```

这样，m2 将始终是在同一时间或在 m1 之后开始的那个，并且 m1.id!=m2.id 确保它不会包含针对自身的匹配项。

您无需检查会议结束，因为仅通过比较会议开始就可以可靠地检测到重叠。

# delphi - Delphi中Application.MessageBox、Windows.MessageBox和Dialogs.MessageDlg的区别

> ID：689459
> 
> 赞同：6
> 
> 时间：2009-03-27T11:49:52.523
> 
> 标签：delphi, messagebox

在**德尔福**；Application.MessageBox、Windows.MessageBox 或 Dialogs.MessageDlg 之间有什么区别？或者哪个更有效地使用计算机内存？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T13:06:52.587

Windows.MessageBox**是**WinAPI 消息框，Application.MessageBox 是它的包装器。然而 Dialogs.MessageDlg 是一个 VCL 形式。因此，如果您担心内存或线程安全，前两个可能更适合。MessageDlg OTOH 更灵活且更易于使用（当然，恕我直言）。

现在，我会考虑任务对话框（TaskDialogIndirect、TTaskDialog 或其他包装器）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T14:19:53.207

Windows MessageBox 由操作系统本地化（是、否、取消...），MessageDlg 可以手动本地化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T16:53:40.500

如果我没记错的话，Delphi VCL 消息框和 Windows 消息框之间有一个重要区别——您可以指定阻止应用程序消息被服务的标志（例如 MB_SYSTEMMODAL）。这对于显示需要“冻结”应用程序的错误很有用——即使在屏幕上，Delphi MessageDlg 仍会触发计时器事件。看：

[MSDN MessageBox 的东西](http://msdn.microsoft.com/en-us/library/ms645505(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T14:44:32.547

消息框的内存使用不应该是这样的问题。我个人更喜欢 VCL 表单 (Dialogs.MessageBox)，因为我可以从 Consts.pas 单元对其进行本地化。我也喜欢它，因为我可以向它添加自定义控件，例如“不再显示”的复选框和其他类似的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T11:52:59.503

为什么你关心消息框使用的少量内存？在编写 Delphi 应用程序时，您还应该关注许多其他事情。无论如何，据我所知，这些都是围绕 Windows MessageBox API 的瘦包装器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T11:54:06.133

它们都做同样的事情——调用 WinAPI 函数 MessageBox()。如果有的话，资源消耗的差异是最小的。如果您非常关心，您可以直接调用 MessageBox() - 只需包括“使用 Windows”。

# silverlight - 如何在 Silverlight 2.0 中延长 Web 服务的超时时间？

> ID：689472
> 
> 赞同：5
> 
> 时间：2009-03-27T11:53:43.077
> 
> 标签：silverlight, web-services

我正在阅读使用 Silverlight 2.0 的 .NET 2.0 Web 服务。Web 服务请求在 30 秒后超时，这对于大多数查询来说都可以，但有时我会超时。如何将超时时间延长至一分钟？

我试过这个，但没有什么区别。

```
 SilverSearchSoapClient client = new SilverSearchSoapClient();
    client.Endpoint.Address = new EndpointAddress(App.ServiceEndpointUrl);
    client.Endpoint.Binding.OpenTimeout = new TimeSpan(0, 1, 0);
    client.Endpoint.Binding.SendTimeout = new TimeSpan(0, 1, 0);
    client.Endpoint.Binding.ReceiveTimeout = new TimeSpan(0, 1, 0);
    return client; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T12:09:22.570

```
 client.InnerChannel.OperationTimeout = new TimeSpan(0, 1, 0); 
```

# c# - 为什么我们不允许在接口中指定构造函数？

> ID：689474
> 
> 赞同：52
> 
> 时间：2009-03-27T11:53:47.070
> 
> 标签：c#, .net, vb.net, oop

> **可能重复：**
> [定义构造函数签名的接口？](https://stackoverflow.com/questions/619856/interface-defining-a-constructor-signature)

我知道您不能在 .Net 的接口中指定构造函数，但为什么不能呢？

对于我当前的项目来说，能够指定必须使用构造函数传入“引擎”将非常有用，但我不能，我必须对类进行 XML 注释就足够了。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-03-27T11:57:10.790

因为接口描述了行为。构造函数不是行为。如何构建对象是一个实现细节。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-27T11:56:46.017

你会如何调用构造函数？当你使用接口时，你通常会传递一个接口的实例（或者更确切地说，一个引用）。还要记住，如果一个类实现了一个接口，则派生类继承该接口，但可能没有相同的构造函数集。

现在，我可以看到使用我称之为*静态接口*的东西来指定构造函数和其他在泛型方法中使用的本质上是静态的成员。有关更多信息，请参阅[我的博客文章](http://codeblog.jonskeet.uk/2008/08/29/lessons-learned-from-protocol-buffers-part-4-static-interfaces/)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-27T12:12:39.800

不，由于已发布的原因，您不能在接口上使用构造函数。但是，您可以在抽象类上。例如，假设您有这个基类。

```
public abstract class ClassOne
{
    protected int _x;
    protected string _s;

    public ClassOne(int x, string s)
    {
        _x = x;
        _s = s;
    }        
} 
```

请注意，没有不带参数的构造函数（默认构造函数），这意味着从 ClassOne 继承的任何类都必须调用具有 2 个参数的构造函数。

所以这是无效的，不会编译。

```
public class ClassTwo : ClassOne
{
    public ClassTwo() 
    { }
} 
```

但是，这是有效的并且会编译。

```
public class ClassTwo : ClassOne
{
    public ClassTwo(int x, string s) : base(x, s)
    {  }
} 
```

我想在这里指出，在 C# 中，您只能从一个基类继承。这意味着这可能不是针对特定情况的正确解决方案，但需要考虑。

托尼。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-27T13:18:41.297

在已经发布的所有其他原因中，还要记住一个类可以轻松实现多个接口；那么应该使用哪个构造函数呢？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-27T13:38:23.743

其他答案已经指出了为什么在接口上声明构造函数没有意义。但是从您的问题来看，我猜您可能正在寻找[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory)。

根据您的问题举一个例子：您说您想以某种方式声明必须将“引擎”传递给构造函数。您可以通过为这样的构造服务声明一个单独的接口来做到这一点：

```
public interface IGadgetFactory
{
   IGadget CreateGadget(Engine engine);
} 
```

任何必须创建`IGadget`实例的代码都可以使用`IGadgetFactory`实例而不是直接调用任何构造函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T11:56:07.687

因为您不能实例化接口，所以构造函数没有意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T14:21:59.567

除了此处给出的其他解释外，您还必须发明一种新的语法来调用它们，因为如果您在该行的范围内有两个或多个实现：

```
Dim x as new IDoStuff() 
```

调用哪个实现？

# wpf - 如果下拉列表中不存在文本，则 DataGridComboBoxColumn 为空

> ID：689489
> 
> 赞同：0
> 
> 时间：2009-03-27T11:57:13.783
> 
> 标签：wpf, wpftoolkit, datagridcomboboxcolumn

我正在使用绑定到 Person 集合的 WPF Toolkit DataGrid。LastName 由具有众所周知的名称的 ComboBox 表示。

```
<x:Array x:Key="knownLastNames" Type="sys:String">
    <sys:String>Johnson</sys:String>
    <sys:String>Williams</sys:String>
</x:Array> 
```

问题是，如果我将 LastName 设置为“Brown”（在 knownLastNames 中缺失），则 ComboBox 列是空的。

```
<dg:DataGridComboBoxColumn Header="LastName" TextBinding="{Binding LastName}" ItemsSource="{Binding Source={StaticResource knownLastNames}}" /> 
```

如果我使 ComboBox 可编辑，我可以看到“棕色”，但只有在编辑模式下（按 F2）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T19:20:54.390

这是我已经在[论坛](http://wpf.codeplex.com/Thread/View.aspx?ThreadId=46627)中提出并通过电子邮件与文森特（项目协调员）确认的错误。我最终编写了自己的自定义列类型，以便可以进行可编辑的`ComboBox`es。

# java - 修改映射并迭代键集时的Java ConcurentMap keySet（）问题

> ID：689490
> 
> 赞同：6
> 
> 时间：2009-03-27T11:57:56.467
> 
> 标签：java, concurrency, map

快速背景 我有一个并发映射，用于缓存一些经常更改的值（仍然值得从测试中缓存它们）。我想通过检查值中的过期时间定期从我的缓存中逐出项目。我正在使用 keySet() 方法来获取对我所有键的引用，然后检查值，如果过期，我将其删除。在其他线程中，缓存不断被查询和更新（删除）。

从 keySet() 的 javadocs 中提到，如果在我迭代 keyset Set 时地图发生变化，结果是未定义的。显然，我想要一种定义的方式来处理这个问题，所以结果是有效的。将 Set 传递给 HashSet 然后迭代这个集合是否足够，因为我的理解是这个集合不会得到地图的支持，这是一种浪费内存的方式吗？任何想法表示赞赏。

不幸的是，我的 evictor 并不是从并发映射中删除项目的唯一方法，所以我说我需要在迭代之前将 keySet 复制到另一个 Set 是正确的。

提前致谢

编辑：原来我正在阅读 Map keySet() 方法而不是 ConcurrentMap keySet() 的 javadocs。谢谢我的坏:)

> 返回此映射中包含的键的集合视图。集合由地图支持，因此对地图的更改会反映在集合中，反之亦然。如果在对集合进行迭代时修改了映射（通过迭代器自己的删除操作除外），则迭代的结果是不确定的。该集合支持元素移除，即通过 Iterator.remove、Set.remove、removeAll retainAll 和 clear 操作从映射中移除相应的映射。它不支持 add 或 addAll 操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T12:08:51.197

你在使用[Java Concurrent HashMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)吗？从 keySet() 文档来看，它的行为方式似乎很有用。

> 返回此映射中包含的键的集合视图。集合由地图支持，因此对地图的更改会反映在集合中，反之亦然。该集合支持元素删除，即通过 Iterator.remove、Set.remove、removeAll、retainAll 和 clear 操作从此映射中删除相应的映射。它不支持 add 或 addAll 操作。视图返回的迭代器是一个“弱一致”迭代器，它永远不会抛出 ConcurrentModificationException，并保证遍历迭代器构造时存在的元素，并且可能（但不保证）反映构造后的任何修改。

即你可以删除东西，你应该没问题。

如果您不使用此实现，那么您使用的是哪个（以及为什么？不好笑，但知道您为什么做出这样的选择会很有趣）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:08:36.847

如果 LRU 缓存足够满足您的需求，请查看[LinkedHashMap——](http://java.sun.com/javase/6/docs/api/index.html?java/util/LinkedHashMap.html)它使实现 LRU 缓存变得轻而易举，然后您可以通过调用[Collections.synchronizedMap](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#synchronizedMap(java.util.Map))将结果包装成线程安全的。

# c# - 网站的语言设置

> ID：689491
> 
> 赞同：1
> 
> 时间：2009-03-27T11:58:46.760
> 
> 标签：c#, asp.net, .net-2.0

如何制作多语言网站？我想创建一个网站，在主页中我希望客户从英语和阿拉伯语中选择一种语言。然后将整个网站转换为该语言。我应该怎么做才能实现这一目标？我正在用 C# 在 asp.net 2.0 中创建这个网站

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T12:05:06.293

你要的是一个教程，你真的应该尝试谷歌搜索。看看下面的链接，如果有什么特别的，更具体的你不明白 - 在这里提问。

[http://www.beansoftware.com/ASP.NET-Tutorials/Globalisation-Multilingual-CultureInfo.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Globalisation-Multilingual-CultureInfo.aspx)
[http://www.asp.net/learn/Videos/video-40.aspx](http://www.asp.net/learn/Videos/video-40.aspx)
[http://www.about2findout。 com/blog/2007/02/aspnet-multilingual-site_10.html](http://www.about2findout.com/blog/2007/02/aspnet-multilingual-site_10.html)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:10:20.447

ASP.NET 可以使用多种机制来更改语言设置 - 但是您需要自己执行翻译。

您可以查看将资源文件用于您网站的常见元素 - 请参阅此答案[货币、日历更改为所选语言，但不是 ASP.NET 中的标签](https://stackoverflow.com/questions/608226/currency-calendar-changes-to-selected-language-but-not-label-in-asp-net/610314#610314)

但是，对于主要内容，您可能希望对 URL 进行一些处理，以确保正确提供您的内容 - Honsa 提供的链接将是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T11:17:16.380

我使用资源文件添加 global.asax 完成的示例代码

```
 void Application_BeginRequest(Object sender, EventArgs e)
        {
            // Code that runs on application startup
            HttpCookie cookie = HttpContext.Current.Request.Cookies["CultureInfo"];
            if (cookie != null &amp;&amp; cookie.Value != null)
            {
                System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo(cookie.Value);
                System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(cookie.Value);
            }
            else
            {
                System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("en");
                System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en");
            }
        } 
```

[http://satindersinght.blogspot.in/2012/06/create-website-for-multilanguage.html](http://satindersinght.blogspot.in/2012/06/create-website-for-multilanguage.html)

[http://satindersinght.wordpress.com/2012/06/14/create-website-for-multilanguage-support/](http://satindersinght.wordpress.com/2012/06/14/create-website-for-multilanguage-support/)

对于阿拉伯语，您需要从左到右更改方向

# regex - 使用 sed 从大写到小写

> ID：689495
> 
> 赞同：24
> 
> 时间：2009-03-27T11:59:37.913
> 
> 标签：regex, sed

我想更改以下模式：

```
getFoo_Bar 
```

到：

```
getFoo_bar 
```

（注意下b）

既不知道 foo 也不知道 bar，替换模式是什么？

我开始写作

```
sed 's/\(get[A-Z][A-Za-z0-9]*_\)\([A-Z]\)/\1 
```

但我卡住了：我想写“\2 小写”，我该怎么做？

也许 sed 不适应？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-05-04T05:27:03.537

使用 sed 将 getFoo_Bar 更改为 getFoo_bar ：

```
echo "getFoo_Bar" | sed 's/^\(.\{7\}\)\(.\)\(.*\)$/\1\l\2\3/' 
```

大写和小写字母由 处理：

*   `\U`使所有文本为右大写。
*   `\u`仅将第一个字符变为右大写。
*   `\L`使所有文本为右小写。
*   `\l`仅将第一个字符变为右小写。（注意是小写字母L）

该示例只是模式匹配的一种方法，仅基于修改单个文本块。使用示例，getFoo_BAr 转换为 getFoo_bAr，注意 A 没有改变。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-27T12:37:22.767

```
s/\(get[A-Z][A-Za-z0-9]*_\)\([A-Z]\)/\1\L\2/g 
```

测试：

```
$ echo 'getFoo_Bar' | sed -e 's/\(get[A-Z][A-Za-z0-9]*_\)\([A-Z]\)/\1\L\2/g'
getFoo_bar 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-27T12:45:55.540

有点短：

```
echo getFoo_Bar | sed 's/_\(.\)/_\L\1/' 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-04-19T14:04:56.247

我能想到的最短的：

```
echo getFoo_Bar | sed 's/_./\L&/' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T12:40:02.077

您可以为此使用 perl：

```
perl -pe 's/(get[A-Z][A-Za-z0-9]*)_([A-Z])/\1_\l\2/' 
```

\l 是这里的诀窍。

sed 不对匹配的组进行大写/小写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-26T17:00:53.700

如果您想在下划线之后用小写字母编写所有内容，那么这对您有用：

```
echo getFoo_Bar | gawk -F_ '{print tolower($2)}' 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-06-13T13:36:39.540

```
echo getFoo_Bar | sed 's/[Bb]/\L&/g' 
```

# ruby-on-rails - 尝试使用 rails-authorization 将角色与用户关联时出现“列“id”不存在”错误

> ID：689496
> 
> 赞同：0
> 
> 时间：2009-03-27T11:59:48.023
> 
> 标签：ruby-on-rails, rails-authorization

我是第一次探索 Rails，并尝试在我的测试应用程序中添加一些相当简单的基于角色的安全性。一些谷歌搜索似乎表明[rails-authorization](http://github.com/DocSavage/rails-authorization-plugin/tree/master)是解决这个问题的方法。我遵循了[自述文件](http://github.com/DocSavage/rails-authorization-plugin/blob/6a71f147658b12883e18736c744b70db82c482d2/README.rdoc)，一切似乎都很顺利，但现在我试图将 a`User`与 a相关联，但`Role`它失败了。`script/console`这是我会议的片段：

```
>> u = User.find(:first)
=> #<User id: 1, login: "cwhit", name: "", email: "cwhitfield@unica.com", crypted_password: "7ac064547fb8992e8e53e936df31657a40f9c5af", salt: "56671492059f8e40eb3d509940944aaba31ebc72", created_at: "2009-03-26 18:06:04", updated_at: "2009-03-26 18:06:04", remember_token: nil, remember_token_expires_at: nil>
>> r = Role.find(:first)
=> #<Role id: 1, name: "ProjectManager", authorizable_type: nil, authorizable_id: nil, created_at: "2009-03-27 11:02:35", updated_at: "2009-03-27 11:02:35">
>> u.has_role r
ActiveRecord::StatementInvalid: PGError: ERROR:  column "id" does not exist
LINE 1: ....546623', '2009-03-27 11:42:16.546623', 5, 1) RETURNING "id"
                                                                   ^
: INSERT INTO "roles_users" ("created_at", "updated_at", "role_id", "user_id") VALUES('2009-03-27 11:42:16.546623', '2009-03-27 11:42:16.546623', 5, 1) RETURNING "id" 
```

我只是在做一些愚蠢的事情，还是这是一个已知问题？我在插件的 Google Group 中的一个问题中发现[了基本相同的错误](http://groups.google.com/group/rails-authorization-plugin/browse_thread/thread/db2f0f8995bef55a/a31a19c06bff2f18?lnk=gst&q=id+does+not+exist#a31a19c06bff2f18)`rails-authorization`，但没有提供解决方案。

这是我的基本配置：

*   操作系统
*   导轨 2.3.2
*   PostgresSQL
*   插件：
    *   宁静认证
    *   rails-授权

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T18:30:38.700

在我使用“id”以外的主键的模型中遇到了同样的问题。原来我忘记使用“set_primary_key”在模型类定义中声明它。也许你需要做这样的事情：

```
class CulpritClass < ActiveRecord::Base

  set_primary_key :key_field_you_want

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T22:36:18.530

尝试安装`composite_primary_keys`gem [（链接）](http://compositekeys.rubyforge.org/)并将以下内容添加到 RolesUser 控制器：

```
set_primary_keys :user_id, :role_id 
```

由于该表没有 id 字段（并且不需要），`(user_id, role_id)`因此您可以将主键添加到数据库中

```
 ALTER TABLE roles_users ADD PRIMARY KEY (user_id, role_id); 
```

这解决了我的问题，这似乎是 Postgres 特有的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T22:20:35.220

我只是使用了两个主键声明

```
set_primary_key :user_id

set_primary_key :role_id 
```

这适用于我的目的，但请记住，它返回（至少在 sql 中）您定义的第二个主键。在这种情况下，它将是对象的 role_id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-03T23:56:04.530

我遇到了同样的问题，但在销毁（角色）时。我尝试了`composite_primary_keys`gem，但发现它破坏了 Rails 2.3.4 中的其他东西。具体来说，它会导致 Rails`:belongs_to`关联在这种情况下生成错误的属性 id：

```
 belongs_to :inviter, :class_name => 'User' 
```

它生`user_id`成为属性名称而不是`inviter_id`.

最终的解决方案是在roles_users 中添加一个id 列。因为我已经有一个没有代理键的角色用户表，所以我不得不进行这个 lil 迁移：

```
 class AddIdToRolesUsers < ActiveRecord::Migration
    def self.up

      # create new table the way it should be (_with_ a traditional Rails id column)
      create_table :x_roles_users do |t|
        t.belongs_to :role
        t.belongs_to :user
        t.timestamps
      end

      execute 'insert into x_roles_users (user_id, role_id, created_at, updated_at) select * from roles_users'

      drop_table :roles_users

      rename_table :x_roles_users, :roles_users
    end

    def self.down
      remove_column :roles_user, :id
    end
  end 
```

# delphi - Delphi 默默地裁剪字符串文字

> ID：689500
> 
> 赞同：7
> 
> 时间：2009-03-27T12:01:46.003
> 
> 标签：delphi, delphi-2009

德尔福 2009 Win32。

下面的代码尝试将 257 长度的字符串添加到备忘录中。它编译并运行良好，但没有添加到备忘录中。

```
Memo1.Lines.Add('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'); 
```

看起来像一个编译器错误。是吗？因为如果字符串是 256 长，我会得到一个编译器错误并且无法编译应用程序。

当开发人员尝试做这样的事情时，有什么方法可以让应用程序崩溃？

我知道我可以拆分字符串并使这段代码工作，但我的意思是防止开发人员在不注意的情况下使用这个无效代码。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-27T12:57:19.740

这是一个带有字符串文字的 Delphi 2009 错误，它应该引发与 D2007 相同的错误。

尝试最新版本的 Andreas IDE Fix pack，它应该修复这个错误。 [http://andy.jgknet.de/blog/?page_id=246](http://andy.jgknet.de/blog/?page_id=246)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T16:51:47.653

我同意 Gamecat 的观点，但是如果您处理的字符串那么大，我会将其分成多行以帮助阅读/编辑。

如果您确实试图创建 257 个“a”，那么为什么不在 StrUtils 单元中使用 DupeString 函数呢？

```
Memo.Lines.Add( DupeString('a',257) ); 
```

更容易阅读和以后维护。如果您在循环中执行此操作并因此担心性能，则将函数结果分配给局部变量并使用该变量。

```
var
  sLotsOfAs : string;
  ix : integer;
begin
  sLotsOfAs := DupeString('a',257);
  for ix := 0 to 1000000 do
    Memo.Lines.Add( sLotsOfAs );
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T13:05:42.870

字符串文字只能是 255 个字符长。不知道他们为什么保留这个限制。但是您可以使用多个文字来解决它：

```
Memo1.Lines.Add('i have 128 chars' + 'i also have 128 chars'). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T12:07:35.490

我不知道 D2009，但至少在 Delphi 6 下，字符串文字限制为 255 个字符，编译器会诊断错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T12:26:01.907

在 Delphi 2007 中，我得到：

```
[DCC Error] Unit1.pas(29): E2056 String literals may have at most 255 elements 
```

在 Delphi 5 中，我得到：

```
[Error] Unit1.pas(29): String literals may have at most 255 elements 
```

如果 D2009 的行为如您所描述，那么会想到两件事：

1 - 他们扩大了字符串中字符数的限制，但 TMemo 仍然最多只能**接受**255 个字符。

或者

2 - 这是一个普通的老错误

至于防止它，我唯一能想到的就是制作一个正则表达式来搜索您的 .PAS 文件中的这些字符串。

# c# - ObjectDataSourceControl 在导入的命名空间中找不到类型

> ID：689502
> 
> 赞同：0
> 
> 时间：2009-03-27T12:02:01.793
> 
> 标签：c#, asp.net, .net-2.0, namespaces, objectdatasource

我在使用多个 ObjectDataSource 的 ASP.NET 2.0 应用程序中有一个 aspx 页面。它们都绑定到同一个类，如下所示：

```

<asp:ObjectDataSource ID="TitleDataSource" runat="server" OnSelecting="TitleDataSource_Selecting" SelectMethod="GetTitle" TypeName="DropDownDataSource"></asp:ObjectDataSource>

```

这工作正常。然后我做了两个改变

1.  将目录`DropDownDataSource`从`app_code`目录移到单独的程序集
2.  改变了类的命名空间是`com.companyname.ie`，现在`com.companyname.ie.appname`

现在，当我点击页面时，我会收到“找不到'TitleDataSource'的类型名称中指定的类型”错误消息。

我可以通过在`TypeName`. 但是添加具有相同命名空间的指令并不能解决该错误。 ``<%` @import`

我也尝试将我的代码移回`app_code`无济于事。

Intellisense 无需我指定命名空间即可获取类型。

它不是一个大问题，但它非常烦人。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:07:48.907

指定完全限定名称是正确的。否则运行时将只查看当前程序集。

# c# - 如何从 VB.NET 或 C#.NET（Windows 应用程序）在指定路径中运行 exe 文件

> ID：689507
> 
> 赞同：2
> 
> 时间：2009-03-27T12:03:51.337
> 
> 标签：c#, mysql, vb.net

首先，我在路径 C:> 中运行以下命令“mysqldump.exe --user=root --password=root accounts>accounts.sql”进行备份，但它显示错误消息“mysqldump 不是可识别的命令”。

然后我使用 cd 命令将命令提示符中的路径更改为位置“C:\Program Files\MySQL\MySQL Server 5.0\bin>”

现在我正在运行以下命令。

C:\Program Files\MySQL\MySQL Server 5.0\bin> mysqldump.exe --user=root --password=root accounts>accounts.sql

它正在成功工作，但我怎样才能从 VB.NET 或 C#.NET 实现这项工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T12:09:26.127

不太确定您在问什么，但以下是使用您指定的参数运行 mysqldumb.exe。（C＃）

```
Process.Start(@"C:\Program Files\MySQL\MySQL Server 5.0\bin\mysqldump.exe", "--user=root --password=root accounts>accounts.sql") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:11:48.163

你的意思是改变当前路径？这是执行此操作的 C# 代码...

```
Directory.SetCurrentDirectory(@"C:\Program Files\MySQL\MySQL Server 5.0\bin"); 
```

# security - 这是实现“记住我”功能的合理方式吗

> ID：689508
> 
> 赞同：8
> 
> 时间：2009-03-27T12:03:55.890
> 
> 标签：security, authentication, rijndaelmanaged, remember-me

如果用户登录该站点并说“记住我”，我们将获得该用户的唯一标识符，使用 RijndaelManaged 对其进行加密，密钥大小为 256，并将其放入 httponly cookie 中，设置有效期为 120 天，每次对服务器的成功请求都会刷新过期时间。

可选地，我们根据用户代理和部分 ipv4 地址（最后两个八位字节）生成初始化向量。

显然没有内置真正的过期系统，从技术上讲，用户可以永远使用这个加密密钥（假设我们不更改服务器端密钥）..

我考虑到要允许此功能，我需要允许用户能够绕过登录并给我他们的唯一 ID（这是一个 guid），我认为单独的 guid 很难猜出一个真正的用户 guid，但是会使站点容易受到botnots生成guid的攻击（我不知道他们找到合法的guid有多现实）..所以这就是为什么在服务器知道加密密钥的地方进行加密，以及可选的iv特定于浏览器和 ip 部分。

我是否应该考虑另一种方法，让服务器发出与用户关联的票证，这些票证将有一个已知的到期日期，以便服务器控制到期？我真的应该关心到期吗？记住我到底还是记住我？

期待被谦卑；），干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T12:26:27.130

[非常相似的问题。](https://stackoverflow.com/questions/685298/securely-implementing-session-state-and-keep-me-logged-in-feature)

您的问题的解决方案在这篇[博文中](http://jaspan.com/improved_persistent_login_cookie_best_practice)

> “持久登录 Cookie 最佳实践”描述了一种相对安全的方法来为网站实施熟悉的“记住我”选项。在本文中，我提出了一项改进，它保留了该方法的所有优点，但也可以检测持久登录 cookie 何时被攻击者窃取和使用。

正如 Jacco 在评论中所说：有关*安全*身份验证的深入信息，请阅读[网站身份验证权威指南](https://stackoverflow.com/questions/549/the-definitive-guide-to-website-authentication-beta#477580)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:18:03.657

你考虑过像 Open Id 这样的东西吗？正如 SO 使用的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T12:19:17.523

被记住的信息有多重要？如果它不是非常私人或重要的东西，只需在 cookie 中添加一个 GUID。

在计算中包含 IP 地址可能是个坏主意，因为它会使使用公共网络的用户立即被遗忘。

使用蛮力查找 GUID 是荒谬的，因为有 2 ^(128)种可能性。

# c# - 为什么 C# 中的 DateTime 不允许为 null？

> ID：689512
> 
> 赞同：40
> 
> 时间：2009-03-27T12:05:41.987
> 
> 标签：c#, non-nullable

为什么在 C# 中不允许将 null 分配给 DateTime？这是如何实施的？并且可以使用此功能使您自己的类不可为空吗？

例子：

```
string stringTest = null; // Okay
DateTime dateTimeTest = null; // Compile error 
```

我知道我可以`DateTime?`在 C# 2.0 中使用以允许将 null 分配给 dateTimeTest，并且我可以在我的字符串上使用[Jon Skeet 的 NonNullable 类](http://msmvps.com/blogs/jon_skeet/archive/2008/10/06/non-nullable-reference-types.aspx)来获取 stringTest 分配的运行时错误。我只是想知道为什么这两种类型的行为不同。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-27T12:07:43.260

`DateTime`是值类型 ( `struct`)，其中字符串是引用类型 (`class`等)。这是关键的区别。引用可以始终为空；一个值不能（除非它使用`Nullable<T>`- ie `DateTime?`），尽管它可以是零（`DateTime.MinValue`），这通常被解释为与 null 相同的东西（特别是在 1.1 中）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-27T12:08:27.703

DateTime 是一个结构而不是一个类。执行“转到定义”或在对象浏览器中查看。

！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-27T12:31:06.480

ValueTypes 和引用类型之间的重要区别是值类型具有这些“值语义”。DateTime、Int32 和所有其他值类型没有标识，Int32“42”本质上与任何其他具有相同值的 Int32 没有区别。

所有值类型“对象”要么存在于堆栈上，要么作为引用类型对象的一部分存在。一种特殊情况是当您将值类型实例转换为对象或接口时 - 这称为“装箱”，它只是创建一个虚拟引用类型对象，该对象仅包含可以提取回来的值（“未装箱”） .

另一方面，引用类型具有标识。“new Object()”不等于任何其他“new Object()”，因为它们是 GC 堆上的单独实例。一些引用类型提供 Equals 方法和重载运算符，以便它们的行为更像值，例如。一个字符串“abc”等于其他“abc”字符串，即使它们实际上是两个不同的对象。

因此，当您有引用时，它可以包含有效对象的地址，也可以为 null。当值类型对象全为零时，它们只是零。例如。整数零、浮点零、布尔值 false 或 DateTime.MinValue。如果您需要区分“零”和“缺失值/空值”，则需要使用单独的布尔标志，或者更好的是，使用 .NET 2.0 中的 Nullable<T> 类。这只是值加上一个布尔标志。在 CLR 中也有支持，因此使用 HasValue=false 对 Nullable 进行装箱会导致空引用，而不是在使用 false+零的装箱结构中，就像您自己实现此结构一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T12:09:00.263

DateTime 是一个值类型，与 int 相同。只有引用类型（如字符串或 MyCustomObject）可以为空。引用类型确实存储了对堆上对象位置的“引用”。

这是我发现的[一篇文章，可以更好地解释它。](http://www.albahari.com/valuevsreftypes.aspx)这是[关于它的 MSDN 文章](http://msdn.microsoft.com/en-us/library/t63sy5hs(VS.80).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T15:19:04.007

对于一个值为 null 的值类型，它必须有一些值它可以持有，它没有其他合法含义，并且*系统会以某种方式知道应该被视为 "null"*。一些值类型可以满足第一个标准，而不需要任何额外的存储空间。如果 .net 的设计从一开始就考虑到了可空值的概念，它可能有`Object include a virtual`IsLogicalNull `property, and a non-virtual`IsNull tr ​​ue this `which would return`IsLogicalNull struct Nullable Nullable Nullable null`）。`if``is null and, otherwise invoke its``property and return the result. If .net had done this, it would have avoided the need for the quirky boxing behavior and``constraint of``(an empty``could be boxed as an empty``, and still be recognized as`

然而，当决定在 .net 框架 2.0 中提供对可空值类型的支持时，已经编写了很多代码，它们假定像`Guid`和`DateTime`不会被视为`null`. 由于可空类型中的大部分值与其可预测的默认值（即`null`）有关，因此具有具有`null`值但默认为其他值的类型会比值增加更多的混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T12:10:09.463

string 是一个类，而 DateTime 是一个结构。这就是为什么您不能将其设置为 null

# cocoa - Cocoa：[statusItem setView:myView] 无论如何都会制作一个白条菜单项

> ID：689513
> 
> 赞同：4
> 
> 时间：2009-03-27T12:05:42.953
> 
> 标签：cocoa

在我的 Mac OS XI 小应用程序中，在系统菜单栏中显示一些信息。我用

```
statusItem = [
  [[NSStatusBar systemStatusBar]
   statusItemWithLength:NSVariableStatusItemLength]
   retain
]; 
```

它工作得很好，我可以用

```
[statusItem setTitle:[NSString stringWithString:@"Woo-hoo"]]; 
```

但它使用默认菜单字体，这对于我相对不重要的信息来说太大了。所以我决定用自定义视图重新实现它。我在 Interface Builder 中创建了一个视图。

然而不幸的是，当我将它设置为我的菜单项的视图时

```
[statusItem setView:myView]; 
```

它只是在菜单中显示一个白条，而不是我的东西。我试过了

```
[statusItem 
  drawStatusBarBackgroundInRect:[myView frame]
  withHighlight:NO]; 
```

没有成功。

在试图弄清楚问题是视图本身还是我将其分配给菜单栏的方式时，我创建了一个窗口并做了

```
[myTestWindow setContentView:myView]; 
```

这个工作得天衣无缝。这让我觉得我的观点还可以:-)

那么，我还能尝试什么让菜单项显示我自己的视图？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T18:35:38.023

它恰好是 Interface Builder 中窗口视图自动调整大小设置的一些奇怪的副作用（我们称它们为*size-effects*）。在 Inspector 中，您可以设置子视图如何根据父视图大小调整大小。因此，在我的情况下，它以某种方式被破坏了，以至于当窗口变得足够小（menuitem-high）时，我的元素刚刚被绘制在窗口的框架之外。

我在 IB 中重新配置了大小，消除了我不需要的所有自动设置，现在它完美运行：来自 IB 的视图显示在菜单项中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T02:31:31.000

视图框架的高度是多少？也许您的视图比菜单栏高，并且您在它之外绘图。当前菜单栏是 22 像素，但您应该向[systemStatusBar](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSStatusBar_Class/Reference/Reference.html#//apple_ref/occ/clm/NSStatusBar/systemStatusBar)询问它的[粗细](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSStatusBar_Class/Reference/Reference.html#//apple_ref/occ/instm/NSStatusBar/thickness)，以防万一它发生变化。

试着在你的视野周围画一个框架，看看你是否得到了什么。

```
[[NSColor blueColor] set];
NSBezierPath *path = [NSBezierPath bezierPathWithRect:self.bounds];
[path setLineWidth:4.0f];
[path stroke]; 
```

如果您只看到蓝色的“L”形（左下角），则视图太大。如果您得到一个矩形但仍然没有文本，那么您可能没有在视图内绘制文本，请查看您绘制文本的坐标（并查看[View Geometry](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaViewsGuide/Coordinates/Coordinates.html#//apple_ref/doc/uid/TP40002978-CH10-SW1)）。将视图放在窗口中可能会起作用，因为它更大。

有关在状态菜单视图中使用文本的示例，请查看 Matt Gemmell 的[NSStatusItemTest](http://mattgemmell.com/2008/03/04/using-maattachedwindow-with-an-nsstatusitem)项目。

编辑：

抱歉，不知何故我错过了你说你在 IB 中创建视图的地方。我做了一个快速测试，我可以看到你提到的白框。

[NSStatusItem](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSStatusItem_Class/Reference/Reference.html#//apple_ref/occ/cl/NSStatusItem)的setView的文档[：](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSStatusItem_Class/Reference/Reference.html#//apple_ref/occ/instm/NSStatusItem/setView:)状态

> 自定义视图负责绘制自己并提供自己的行为，例如处理鼠标点击和发送动作消息。

状态项视图进入一个名为 NSStatusBarWindow 的特殊（苹果私有）窗口，该窗口可能具有与普通窗口不同的内部行为，并且似乎不支持来自 IB 的视图。

所以是的，我认为您需要创建一个自定义 NSView 子类并在 drawrect 中进行自己的绘图：。

# c - 如何在 C 中跨线程进行动态数据传输和内存管理？

> ID：689514
> 
> 赞同：1
> 
> 时间：2009-03-27T12:06:08.677
> 
> 标签：c, multithreading, arm

平台：ARM9

编程语言 C

要求 - 纯 C，没有外部库，也没有提升。

操作系统 - REX 实时操作系统

我有两个线程在嵌入式平台上运行 -

1.  一种是在驱动程序级别处理所有与硬件的通信和数据传输。
2.  第二个线程运行应用程序，该应用程序使用来自/来自硬件的数据。

这个想法是将应用程序线程与驱动程序线程分离，这样我们就可以在硬件驱动程序线程中更改硬件和实现，但对应用程序线程的影响最小。

我的挑战是从硬件接收的数据可能是动态的，即我们不知道应用程序线程应该为每个发往/来自硬件的请求预留多少内存，因为这是在运行时确定的。

我在想驱动程序线程可以通知应用程序线程有太多数据要读取。然后应用程序线程分配内存并请求驱动程序线程读取数据。然后由应用程序线程相应地处理数据。这样，所有内存管理都在应用程序线程内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T12:20:49.313

想到几个选项：

1）在驱动程序中分配内存，在应用程序中释放它。但是......我们倾向于避免在任何接近实时要求的情况下使用 malloc。如果您可以访问 malloc/free，并且没有“实时”问题或内存碎片问题（即您的堆足够大），那么这是一个相当简单的方法。驱动程序只是通过消息队列将分配的指针发送到应用程序线程，完成后应用程序释放内存。注意内存泄漏。

2) 环形或循环缓冲区。驱动程序完全管理一个固定大小的环形缓冲区，并在缓冲区准备好时简单地向应用程序发送消息。有关详细信息，请参见此处： [循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)。然后应用程序通过驱动程序 API 再次将数据标记为“可用”，这有助于对应用程序线程隐藏环形缓冲区的详细信息。我们将这种方法用于我们的一个驱动程序，该驱动程序具有与您描述的一组非常相似的要求。在这种情况下，您需要关注确定环形缓冲区的“最佳”大小、驱动程序中的溢出处理等。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:14:24.130

您没有指定操作系统，但您以某种方式拥有“线程”。除了其中一个在驱动程序级别（中断处理程序），另一个听起来像一个应用程序（用户空间/内核）。但这也不匹配，因为您的驱动程序和应用程序甚至在数据处理之前就已进行通信。

您的术语令人困惑且不令人鼓舞。这是否是自制（RT）操作系统？

如果你有一个真正的操作系统，那么有一些既定的方法可以编写驱动程序并将数据传递给用户空间。阅读文档或使用现有驱动程序之一作为参考。

如果这是一个自定义操作系统，您仍然可以参考其他开源驱动程序的想法，但您显然不会方便地进行设置。在驱动程序代码中预先分配所有内存，在数据到达时将其填充，然后将其交给应用程序代码。内存量取决于您的应用程序处理数据的速度、您计划接受的最大数据量以及支持您的应用程序需要多少内部数据排队。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T13:13:53.280

这是 C，我最终不得不让应用程序向驱动程序注册一个回调。回调的目的是在驱动程序从设备中读取数据后对其进行处理。驱动程序管理内存，即分配内存、调用回调并最终释放内存。此外，回调仅对内存具有读取权限。因此，理想情况下，应用程序应该只是将缓冲区的内容复制到自己的内存中并立即退出回调。然后，它可以自由地处理数据的时间和方式。

我更新了文档以明确应用程序回调的用途，即假定回调返回时，内存不应再被视为有效。如果以任何其他方式使用回调，则行为未定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T15:10:39.893

我的第一个想法是使用循环缓冲区。这是一些示例代码。随意调整它以适应您自己的用途。您可能不想要全局变量。你可能不想要#defines：

```
#define LENGTH (1024)
#define MASK (LENGTH-1)
uint8 circularBuffer[ LENGTH ];
int circularBuffer_add = 0;
int circularBuffer_rmv = 0;

void copyIn( uint8 * circularBuffer, uint8 * inputBuffer, int n ) {
    int i;
    for( i = 0; i < n; i++ ) {
        circularBuffer[ circularBuffer_add ] = inputBuffer[ i ];
        circularBuffer_add = ( circularBuffer_add + 1 ) & MASK;
    } 
}

void copyOut( uint8 * circularBuffer, uint8 * outputBuffer, int n ) {
    int i;
    for( i = 0; i < n; i++ ) {
        outputBuffer[ i ] = circularBuffer[ circularBuffer_rmv ];
        circularBuffer_rmv = ( circularBuffer_rmv + 1 ) & MASK;
    } 
} 
```

* * *

上面的代码还假设您的数据单位是数据类型“uint8”。您可以更改它以使其使用其他数据类型。或者您甚至可以将其设为通用并使用 memcpy() 复制到循环缓冲区中。

这段代码的主要特点是它如何处理 add 和 rmv ptr。

* * *

一旦你使用上面的代码工作。**我建议在某个时候切换所有从硬件读取的内容，以使用平台的[直接内存访问](http://en.wikipedia.org/wiki/Direct_memory_access)API**。

**切换到直接内存访问**很重要，因为上述代码相对于使用几乎零周期的 DMA 使用了很多周期。

# ruby - 使用 ruby 递归地运行目录中的文件

> ID：689516
> 
> 赞同：11
> 
> 时间：2009-03-27T12:06:54.137
> 
> 标签：ruby, directory, subdirectory

我现在正在编写脚本，它必须在目录及其子文件夹中运行每个 ruby​​ 脚本。

例如

```
run-all.rb
- scripts
  - folder1
    - script1.rb
    - script2.rb
  - folder2
    - script3.rb
    - script4.rb 
```

由于服务器是 Windows 服务器，我通常会使用批处理文件，但负责人坚持一切都必须在 ruby​​ 中完成，因为有些成员有 Mac，可能不理解 Windows 批处理文件。

由于问题可能已经泄露，我对 Ruby 的了解非常基础。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-27T12:34:36.783

取决于您所说的“运行”是什么意思。要在同一个 ruby​​ 进程中执行每个脚本中的代码，这将达到目的：

```
Dir["scripts/**/*.rb"].each{|s| load s } 
```

但是如果你想在它自己的 ruby​​ 进程中运行每个脚本，那么试试这个：

```
Dir["scripts/**/*.rb"].each{|s| puts `ruby #{s}` } 
```

只需将其中任何一个放在命令行的内容中`run-all.rb`并运行即可。`ruby run-all.rb`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:11:11.973

像这样的东西应该可以工作：

```
def process_directory(basedir)
puts basedir
Find.find(basedir.chomp) do |path|
    if FileTest.directory?(path)
        if File.basename(path)[0] == ?.
            Find.prune       # Don't look any further into this directory.
        else
            next
        end
    else
        puts path
    end
end 
```

# algorithm - 在一组项目之间建立排序的算法

> ID：689535
> 
> 赞同：2
> 
> 时间：2009-03-27T12:11:04.953
> 
> 标签：algorithm, sorting, graph-theory

我有一组学生（为了概括起见，在标题中称为项目）。在这些学生中，有些人以粗暴着称。我们被告知一组“我讨厌 j”形式的仇恨关系。“我讨厌 j”并不**意味着**“j 讨厌我”。我们应该将学生排成一排（最前面的一排编号为 1），如果“我讨厌 j”，那么我应该排在编号**严格**小于 j 的排中（换句话说：在j 行前面的某行），这样我就不会向 j 扔任何东西（不允许转身）。找到所需的最小行数（每行不必有相同数量的学生）的有效算法是什么？

我们将做出以下假设：

1）如果我们将其建模为有向图，则图中没有环。最基本的循环是：如果“我讨厌 j”为真，“j 讨厌我”为假。因为否则，我认为订购将变得不可能。

2）小组中的每个学生至少被另一个学生讨厌或至少讨厌另一个学生。当然，也会有学生既被一些学生讨厌，又反过来讨厌其他学生。这意味着没有不属于图表一部分的流浪学生。

**更新：**我已经考虑过用 i --> j if 'i hats j 构建有向图并进行拓扑排序。但是，如果我必须将所有学生排成一行，则一般拓扑排序会更适合。由于这里的行有所不同，我试图弄清楚如何将变化因素考虑到拓扑排序中，这样它就给了我想要的东西。

当您回答时，请说明您的解决方案的复杂性。如果有人提供代码并且您不介意该语言，那么我更喜欢 Java，但当然任何其他语言都一样好。

JFYI 这不适用于任何类型的作业（顺便说一句，我不是学生：））。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T12:16:10.837

在我看来，您需要研究[拓扑排序](http://en.wikipedia.org/wiki/Topological_sort)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T12:28:43.287

这个问题基本上是将[最长路径放入有向图](http://en.wikipedia.org/wiki/Longest_path_problem)问题的另一种方法。行数实际上是路径中的节点数（边数 + 1）。

假设图是[无环](http://en.wikipedia.org/wiki/Directed_acyclic_graph)的，解决方案是[拓扑排序](http://en.wikipedia.org/wiki/Topological_sort)。您的假设 1 的非循环要强一些。不仅 A -> B 和 B -> A 无效。还有 A -> B, B -> C, C -> A 和任何长度的任何循环。

提示：问题是**需要多少行**，而不是哪个学生在哪一行。问题的答案是最长路径的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T12:17:30.430

本质上，假设 #1 中的重要一点是该图中不能有任何循环。如果有任何循环，您将无法解决此问题。

我会先让所有不讨厌任何其他学生的学生坐在后排。然后你可以让讨厌这些学生的学生坐在下排等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T12:42:56.827

它来自项目管理理论（或调度理论，我不知道确切的术语）。那里的任务是关于排序作业（顶点是作业，弧是作业顺序关系）。

显然，我们有一些没有循环的连通图。当且仅当hats时，从顶点`a`到顶点存在弧。假设有一个源（没有传入弧）和目标（没有传出弧）顶点。如果不是这种情况，只需添加虚构的。现在我们想要找到从源到目的地的最长路径的长度（它将是行数 - 1，但请注意假想顶点）。`b``a``b`

我们将顶点等级 ( `r[v]`) 定义为源和该顶点之间的最长路径中的弧数`v`。显然我们想知道`r[destination]`。查找排名的算法：

```
0) r_0[v] := 0  for all verteces v
repeat
t) r_t[end(j)] := max( r_{t-1}[end(j)], r_{t-1}[start(j)] + 1 )  for all arcs j
until for all arcs j r_{t+1}[end(j)] = r_t[end(j)]    // i.e. no changes on this iteration 
```

每一步至少有一个顶点增加它的等级。因此这种形式的复杂度是**`O(n^3)`**。

顺便说一句，该算法还为您提供了行之间的学生分布。只需按学生各自的等级对他们进行分组。

**编辑：**另一个具有相同想法的代码。可能更好理解。

```
# Python
# V is a list of vertex indices, let it be something like V = range(N)
# source has index 0, destination has index N-1
# E is a list of edges, i.e. tuples of the form (start vertex, end vertex)
R = [0] * len(V)
do:
    changes = False
    for e in E:
        if R[e[1]] < R[e[0]] + 1:
            changes = True
            R[e[1]] = R[e[0]] + 1
while changes
# The answer is derived from value of R[N-1] 
```

当然这是最简单的实现。它可以被优化，并且时间估计可以更好。

**Edit2：**明显的优化 - 仅更新与上一步更新的顶点相邻的顶点。即引入一个具有更新等级的顶点的队列。同样对于边缘存储，应该使用邻接列表。有了这样的优化复杂度将是**`O(N^2)`**. 实际上，每个顶点最多可能出现在队列中`rank`。但是顶点等级永远不会超过`N`- 顶点数。因此算法步骤的总数不会超过**`O(N^2)`**。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T17:58:57.627

行数是有向图中最长路径的长度加一。作为一个极限情况，如果没有仇恨关系，每个人都可以坐在同一排。

要分配行，请将不被其他任何人讨厌的每个人放在第一行。这些是图表的“根”。如果 N 是从任何根到那个人的最长路径的长度（这条路径的长度至少为 1），那么其他所有人都被放在第 N + 1 行。

一个简单的 O(N^3) 算法如下：

```
S = set of students
for s in S: s.row = -1        # initialize row field
rownum = 0                    # start from first row below
flag = true                   # when to finish
while (flag):
  rownum = rownum + 1         # proceed to next row
  flag = false
  for s in S:
    if (s.row != -1) continue # already allocated
    ok = true
    foreach q in S:
      # Check if there is student q who will sit
      # on this or later row who hates s
      if ((q.row == -1 or q.row = rownum)
          and s hated by q) ok = false; break
    if (ok):                  # can put s here
      s.row = rownum
      flag = true 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T12:18:02.020

简单答案 = 1 行。

将所有学生放在同一行。

实际上，这可能无法解决上述问题-较少的行，而不是相等的行...

1.  将所有学生放在第 1 行
2.  对于每个仇恨关系，将不讨厌的学生排在讨厌的学生后面
3.  迭代直到你没有活动，或者迭代 Num(relation) 次。

但我确信有更好的算法——看看无环图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-14T03:16:17.423

构造一个关系图，其中 i 讨厌 j 将具有从 i 到 j 的有向边。所以最终结果是一个有向图。它应该是一个 DAG，否则没有解决方案，因为它不可能解决循环仇恨关系船。

现在只需进行 DFS 搜索并在后节点回调期间，意味着一旦所有子节点的 DFS 完成并且在从 DFS 调用返回到该节点之前，只需检查所有子节点的行号并分配这个节点作为孩子的最大行+ 1。如果有人不讨厌任何人，基本上没有邻接列表的节点只需分配他第0行。

处理完所有节点后，反转行号。这应该很容易，因为这只是找到最大值并将行号分配为已分配的最大行号。

这是示例代码。

```
postNodeCb( graph g, int node )
{
    if ( /* No adj list */ )
        row[ node ] = 0;
    else
        row[ node ] = max( row number of all children ) + 1;
}

main()
{
.
.

    for ( int i = 0; i < NUM_VER; i++ )
        if ( !visited[ i ] )
            graphTraverseDfs( g, i );`enter code here`
.
.
} 
```

# vba - 使用 VBA 以编程方式将 ActiveX 控件插入 Word 文档？

> ID：689540
> 
> 赞同：0
> 
> 时间：2009-03-27T12:12:20.830
> 
> 标签：vba, ms-word

可能吗？我找不到任何这样做的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T12:34:49.543

当我想在 Office 中编写宏 (=VBA) 时，我只是从录制宏开始，然后手动执行您想要执行的操作。

录制的宏将为您提供帮助。

这就是我最终的结果：

```
Sub Macro1()
'
' Macro1 Macro
'
'
    Selection.InlineShapes.AddOLEObject ClassType:="WordPad.Document.1", _
        FileName:="", LinkToFile:=False, DisplayAsIcon:=False
End Sub 
```

答案是：使用[AddOLEObject](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.shapes.addoleobject(VS.80).aspx)方法

# c# - 动态地将数据源分配给下拉列表

> ID：689548
> 
> 赞同：0
> 
> 时间：2009-03-27T12:16:23.957
> 
> 标签：c#, dynamic, drop-down-menu

我试图创建一个下拉列表，该列表根据先前从数据库中不同表中的选择获取值。我的一个表有 3 列：ID、名称和第一个条目日期我提供 3 个单选按钮，如果选中第一个单选按钮，那么下拉列表应该显示表中存在的所有 ID，如果选中第二个，那么它应该显示所有名称 n等等..我也希望这个过程继续进行，即一旦从第一个下拉列表中选择了某些内容，我希望另一个下拉列表显示项目，具体取决于先前的选择我真的不知道如何去做，我正在尝试这样做在 asp C# & m 中使用 sql server 2005 数据库，我不擅长这些，请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T12:20:00.423

我假设您将 ADO.NET 数据集用于客户端数据，因此您需要做的就是将 ComboBox 的 .DataSource 属性更改为数据集中的适当表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:24:51.097

对于您问题的第一部分，您可以根据已单击的单选按钮动态更改 datatextfield 和 datavaluefiled。if (radiobutton1.checked) { dropdownlist1.datatextfield = 'id'; dropdownlist1.datavaluefield = 'id'; } else if (radiobutton2.checked) { dropdownlist1.datatextfield = 'name'; dropdownlist1.datavaluefield = 'id'; } ......

为了在下拉列表中唯一标识您选择的项目，请始终使用 id 作为数据值字段。

对于第二部分，您可以为下拉列表添加一个 onchange 事件，并可以获取当前选择的项目，并使用该项目可以设置第二个下拉列表。

希望这可以帮助。

# struts2 - struts2 - optiontransferselect - 将整数列表传递给操作

> ID：689556
> 
> 赞同：1
> 
> 时间：2009-03-27T12:18:12.207
> 
> 标签：struts2

我在表单中有一个 optiontransferselect，但我不知道如何在我的操作中获取 rightlist 中的选定项目。

我需要获取所有访问过的国家/地区 ID 的列表。我尝试在我的操作列表（整数）国家访问 ID；但它返回 nullPointerException。然后我尝试了 Integer id，但它返回 null。

这就是我所拥有的：

s:optiontransferselect

```
 label="Select visited countries"
              name="countriesNotVisitedId"
              leftTitle="Not visited countries"
              rightTitle="Visited Countries"
              list="%{countriesNotVisited}"
              listKey="id"
              listValue="name"
              headerKey="countryNotVisitedId"
              headerValue="--- Please Select ---"

              doubleName="countriesVisitedId"
              doubleList="%{countriesVisited}"
              doubleHeaderKey="countryVisitedId"
              doubleHeaderValue="--- Please Select ---"
              doubleListKey="id"
              doubleListValue="name" /> 
```

如何在我的操作中获取包含访问国家的整数 ID 的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-13T09:48:05.193

我把头撞在墙上，想知道我做错了什么。这很简单

doubleName="fields" 是返回的标签字段

public void setFields(String fields) { 这是你的动作类中需要的。

我没有意识到的是需要选择元素才能被送回。或者在标题中简单地使用 ajax

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T09:16:41.030

这是我尝试过的，效果很好。

第1步：JSP从左边选择国家到右边。

```
<s:optiontransferselect 
 label="Favourite Characters"
 name="leftSide"
 id="left"
 leftTitle="Left Title"
 rightTitle="Right Title"
 list="%{countriesNotVisited)"
 multiple="true"
 headerKey="headerKey"     
 doubleList="{}"
 doubleId="right"
 doubleName="rightSide"
 doubleHeaderKey="doubleHeaderKey"
 doubleMultiple="true" /> 
```

第 2 步：Javascript 代码从右侧自动选择所有数据。

```
 function selectall()
 {
 var list = document.getElementById("right");
 for (var i = 0; i < list.options.length; i++) 
   {
    alert(list.options[i].value)
    list.options[i].selected = true;
   }
 var form = document.getElementById("right");
 form.submit();
      return true;

} 
```

第 3 步：在提交时从 JSP 端调用此函数。

```
<s:submit id="submitid" value="Submit" action="insert" onclick="selectall()"/> 
```

第四步：在action中，让左右两边对象名的getter和setter取字符串而不是字符串数组。

```
private String leftSide;
private String rightSide;

public String getLeftSide() {
    return leftSide;
}

public String getRightSide() {
    return rightSide;
}

public void setRightSide(String rightSide) {
    this.rightSide = rightSide;
}

public void setLeftSide(String leftSide) {
    this.leftSide = leftSide;
} 
```

现在，如果您尝试在操作中打印一个值，您将获得值：

```
System.out.println("right side list " + ad.getRightSide()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T15:33:51.353

在你的行动中：

```
 public void setCountriesVisitedId(String[] countriesVisitedId) {
    this.countriesVisitedId = countriesVisitedId;
 } 
```

# asp.net - 没有角色提供程序的 Asp.Net 角色不起作用？

> ID：689557
> 
> 赞同：0
> 
> 时间：2009-03-27T12:18:53.797
> 
> 标签：asp.net, forms-authentication, membership

你好，我通过使用 Sql Membership Provider、站点地图和启用安全修剪创建了一个带有 Asp.Net 的网站。基于这些，我将 web.config 文件设置到目录中，以便根据用户的角色允许或不允许用户访问。

一段时间后，我删除了 MembershipProvider 并手动创建了“标准”登录过程，该过程创建了票证和身份验证 cookie，并将 GenericPrincipal 设置为 Application_AuthenticateRequest。

这些更改后的问题是，虽然站点地图根据每个不同的用户的角色显示了正确的页面，但当我单击此页面时，系统会将我重定向到“default.aspx”页面，例如不允许用户进入那个页面！

**奇怪的是站点地图和安全修剪正在工作，但实际上我无法进入页面！！！！！！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T12:32:35.073

您可以使用 IIS 管理工具添加用户和角色。这样您就可以避免任何打字错误。

# python - 为 JPEG 构建 Python PIL 看起来不错，但自检失败

> ID：689560
> 
> 赞同：3
> 
> 时间：2009-03-27T12:19:16.120
> 
> 标签：python, jpeg, python-imaging-library, fedora, libjpeg

我在 Fedora Core 6（64 位）上

在“yum install libjpeg-devel”之后，我已经下载并构建了 PIL。它给出了以下信息：

--- JPEG 支持正常

看起来 JPEG 构建得很好，但是在运行 selftest.py 时：

IOError：解码器 jpeg 不可用

为什么它看起来构建正确，但自检失败？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:41:37.517

你可能需要更多的包。安装`libjpeg`其中包括`/usr/lib/libjpeg.so*`并重试。

在我的 Fedora（另一个版本）上，PIL 与`python-imaging`rpm 一起安装：

```
ldd _imaging.so
    linux-gate.so.1 =>  (0x004c6000)
    libjpeg.so.62 => /usr/lib/libjpeg.so.62 (0x00a07000)
    libz.so.1 => /lib/libz.so.1 (0x00b91000)
    libpython2.5.so.1.0 => /usr/lib/libpython2.5.so.1.0 (0x00110000)
    libpthread.so.0 => /lib/libpthread.so.0 (0x00ee8000)
    libc.so.6 => /lib/libc.so.6 (0x00260000)
    libdl.so.2 => /lib/libdl.so.2 (0x003c9000)
    libutil.so.1 => /lib/libutil.so.1 (0x00fcd000)
    libm.so.6 => /lib/libm.so.6 (0x00ad1000)
    /lib/ld-linux.so.2 (0x007a1000) 
```

这意味着 PIL 需要`libjpeg.so`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:42:56.797

事实证明，这可以通过完全删除已安装的 PIL 版本并从头开始重新构建来解决。

# c# - 从 C# 调用可视化 C++ 代码

> ID：689587
> 
> 赞同：2
> 
> 时间：2009-03-27T12:28:37.657
> 
> 标签：c#, visual-c++

我遇到了一个“ref”关键字，该关键字应用于 .cpp 文件中的类。我想访问一个标记为 __clrcall 的方法。你能告诉我在视觉 C++ 代码中使用了什么 ref 关键字吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T12:42:04.457

来自 MSDN：

*一个 ref 类或 ref struct 可以从零个或多个托管接口和零个或一个 ref 类型继承。值类或值结构只能从零个或多个托管接口继承。*

[关联](http://msdn.microsoft.com/en-us/library/6w96b5h7(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:07:08.577

“short short”版本是“ref class”是托管类。在未声明为“ref”的类中不能有托管类型的成员变量（.NET 库对象，如 StringBuilder 或 TCPListener）——也就是说，非托管类不能包含托管对象。

# .net - 资源内的 ControlTemplate 编辑挂起 Visual Studio 2008

> ID：689598
> 
> 赞同：1
> 
> 时间：2009-03-27T12:33:26.117
> 
> 标签：.net, wpf

我在 XP 中使用 Visual Studio 2008 SP1

当我尝试编辑在资源中定义的控件模板时，会发生挂断。（我所有的资源文件都通过 application.xaml 合并）

谷歌搜索这个问题我发现这是微软的一个已知错误，但我似乎找不到修补程序或足够好的解决方案来完成我的工作。

完成我的工作的一种方法是从项目中临时排除资源文件，更改控制模板，然后重新包含并构建项目。但是，即使这似乎每次都不起作用，我每 4-5 次尝试就会挂断大约 1 次..

另一种方法是复制window.resources中的controltemplate，进行所有修改，然后将其复制回资源文件，但实现起来很麻烦。

有人找到更好的方法吗？或解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:25:53.103

如果我没有打开任何其他 XAML 窗口，它通常对我有用。我认为是窗口中的设计者试图使用实际导致崩溃的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T13:26:01.290

终于找到了一个修补程序： [http ://code.msdn.microsoft.com/KB958017](http://code.msdn.microsoft.com/KB958017)

此修补程序已包含在 Visual Studio 2008 SP1 的 Silverlight 工具中，所以我想这就是它不会影响所有人的原因。

# html - html 页面上的 swf 电影（豪华弹出窗口）

> ID：689609
> 
> 赞同：0
> 
> 时间：2009-03-27T12:37:54.513
> 
> 标签：html, flash, popup, loader

我想破解这样的东西：

**[示例](http://www.menlotravel.com/)**>> 只需单击“启动 PicLens Lite 幻灯片 PicLens”。

您是否看到 swf/flash 是如何加载到普通页面之上的？我想这样做**:-D**

如果那里有一些代码**更好**，否则欢迎任何提示或点击。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T12:39:11.733

您可以查看像[Shadowbox](http://mjijackson.com/shadowbox/)这样的 JavaScript 工具，它们可以将任何类型的元素加载到网站上方的框中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:39:21.280

您正在寻找[灯箱效果](http://en.wikipedia.org/wiki/Lightbox_(JavaScript))。只需将您的内容设置为您的 Flash 对象并使用无边框灯箱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T12:45:51.443

如果您使用的是 Mootools 或 jQuery 等框架，我建议使用它们的灯箱克隆（例如，Mootools 的[Milkbox](http://reghellin.com/milkbox/)或[MediaBox Advanced](http://iaian7.com/webcode/mediaboxAdvanced)）。

# entity-framework - 如何捕获文件打开事件

> ID：689611
> 
> 赞同：0
> 
> 时间：2009-03-27T12:38:16.883
> 
> 标签：entity-framework

.NET 框架中是否有一个类可以用来捕获正在打开的文件？FileSystemWatcher 仅在文件更改时触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:53:51.900

[`FileSystemWatcher`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)可以监视对[`LastAccess`](http://msdn.microsoft.com/en-us/library/system.io.notifyfilters.aspx#memberList)（=“文件或文件夹上次打开的日期”）属性的更改-这应该可以满足您的要求。

# css - 为什么 Django 不能在我的 CSS 文件中显示图像？

> ID：689612
> 
> 赞同：0
> 
> 时间：2009-03-27T12:38:37.210
> 
> 标签：css, django

我在 CSS 文件中显示图像时遇到问题。

我有一个带有以下类的css文件：

```
.header
{
 margin-left: auto;
 bla bla
 bla bla
 ...
 background: url(/site_media/header_background.gif) no-repeat top left;
} 
```

当我使用这个 css 执行模板时，没有显示图像，但是当我直接将背景样式注入到我的模板中时，它可以完美地工作。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:53:49.407

您需要提供 header_background.gif 相对于您的 css 文件位置的完整路径才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T12:41:28.950

试着在它周围加上引号。

```
background: url('/site_media/header_background.gif') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T13:03:01.193

对不起大家！我使用了错误的 CSS 文件！它工作正常，即使没有引号！谢谢**sysrqb**

# c# - c# Lambda, LINQ .... 改进这个方法

> ID：689628
> 
> 赞同：5
> 
> 时间：2009-03-27T12:42:49.073
> 
> 标签：c#, linq, lambda

我正在学习更多关于 LINQ 和 Lambda 表达式的信息，但在这个阶段，我根本不会“获取”Lambda 表达式。

是的......我是这些新概念的新手。

我的意思是，我看到的每个示例都说明了如何添加或减去参数。

稍微复杂一点的东西呢？

为了帮助我更好地理解，我为任何希望参与的人发布了一个小挑战。我有以下方法，它将采用任何字符串，并将在任何大写字符与其前面的邻居之间放置空格（如下所示）。

即
“SampleText”=“示例文本”
“DoesNotMatterHowManyWords”=“多少字不重要”

这是代码；

```
public static string ProperSpace(string text)
{
    var sb = new StringBuilder();
    var lowered = text.ToLower();

    for (var i = 0; i < text.Length; i++)
    {
        var a = text.Substring(i, 1);
        var b = lowered.Substring(i, 1);
        if (a != b) sb.Append(" ");
        sb.Append(a);
    }

    return sb.ToString().Trim();
} 
```

我确信上面的方法可以重写以与 LINQ 或 Lambda 表达式一起使用。我希望这个练习能帮助我了解这些新概念。

此外，如果您有任何好的 LINQ 或 Lambda 教程链接，请提供。

* * *

编辑

感谢所有做出贡献的人。尽管当前的方法确实可以完成这项工作，但我很高兴看到它可以被修改为使用 lambda 表达式。我也承认这可能不是 LINQ 的最佳示例。

这是使用 Lambda 表达式的新更新方法（经过测试可以工作）；

```
public static string ProperSpace(string text)
{
    return text.Aggregate(new StringBuilder(), (sb, c) =>
    {
        if (Char.IsUpper(c)) sb.Append(" ");
        sb.Append(c);
        return sb;
    }).ToString().Trim();
} 
```

我也很欣赏其他（类似）主题的许多链接。

尤其是[这个话题](https://stackoverflow.com/questions/689569/overcomplication-to-use-the-latest-features)太真实了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T12:47:37.220

就个人而言，我认为你的方法简单明了，我会坚持下去（我想我什至可能在某个地方写了完全相同的代码）。

更新：

以这个为起点怎么样？

```
public IEnumerable<char> MakeNice(IEnumerable<char> str)
{
  foreach (var chr in str)
  {
    if (char.ToUpper(chr) == chr)
    {
      yield return ' ';
    }
    yield return chr;
  }
}

public string MakeNiceString(string str)
{
  return new string(MakeNice(str)).Trim();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T13:17:03.420

这与原始代码相同，甚至避免了第二个（小写）字符串的生成。

```
var result = text.Aggregate(new StringBuilder(), 
    (sb, c) => (Char.IsUpper(c) ? sb.Append(' ') : sb).Append(c)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T12:52:53.743

像 leppie 一样，我不确定这是否适合 LINQ。当然，你可以强制它，但这不是一个有用的例子。一个小的调整是比较`text[i]`以`lowered[i]`避免一些不必要的字符串 - 并且可能默认 sb 为`new StringBuilder(text.Length)`（或更高的少量）：

```
if (text[i] != lowered[i]) sb.Append(' ');
sb.Append(a); 
```

除此之外 - 我会不管它；

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T12:59:23.823

```
public static string ProperSpace(string text)
{
    return text.Aggregate(new StringBuilder(), (sb, c) =>
        {
            if (Char.IsUpper(c) && sb.Length > 0)
                sb.Append(" ");

            sb.Append(c);
            return sb;
        }).ToString();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T12:52:30.000

在这种情况下，我会使用正则表达式。

```
public static string ProperSpace(string text)
{
  var expression = new Regex("[A-Z]");
  return expression.Replace(text, " $0");
} 
```

如果你想使用 lambda，你可以使用：

```
public static string ManipulateString(string text, Func<string, string> manipulator)
{
    return manipulator(text);
}
// then
var expression = new Regex("[A-Z]");
ManipulateString("DoesNotMatterHowManyWords", s => expression.Replace(text, " $0")); 
```

这与使用匿名代表基本相同

```
var expression = new Regex("[A-Z]");
ManipulateString("DoesNotMatterHowManyWords", delegate(s) {
  return expression.Replace(text, " $0")
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T12:54:59.247

这是一种方法：

```
string.Join("", text.Select((c, i) => (i > 0 && char.IsUpper(c)) ? " " + c : c.ToString()).ToArray()); 
```

但我看不出改进在哪里。只需检查这个[最近的问题](https://stackoverflow.com/questions/689569/overcomplication-to-use-the-latest-features)...

编辑：对于那些想知道的人：是的，我故意选择了一个丑陋的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T12:55:41.523

我很好奇为什么一个简单的正则表达式替换是不够的。我为其他人写了一个正是这样做的：

```
"[AI](?![A-Z]{2,})[a-z]*|[A-Z][a-z]+|[A-Z]{2,}(?=[A-Z]|$)" 
```

我已经在这里的另一个公告板上发布了这个：http: [//bytes.com/topic/c-sharp/answers/864056-string-manupulation-net-c](http://bytes.com/topic/c-sharp/answers/864056-string-manupulation-net-c)。有一个错误需要后正则表达式修剪，我还没有机会解决，但也许其他人可以为此发布修复。

使用替换模式： "$0[space]" 将 [space] 替换为实际空间会极大地减少代码。

它处理一些可能超出您尝试范围的特殊情况，但公告板线程将为您提供这些信息。

**编辑：** PS 开始学习一些 LINQ 应用程序的好方法是查看[GOLF](https://stackoverflow.com/questions/tagged/golf)和[CODE-GOLF](https://stackoverflow.com/questions/tagged/code-golf)标签并查找 C# 帖子。LINQ-to-Objects 有许多不同且更复杂的用途，它们应该可以帮助您识别该技术的一些更有用（？）和有趣的应用程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T12:57:56.510

对于 linq 的有用性（如果您需要说服力），您可以查看[这个](https://stackoverflow.com/questions/21280/am-i-missing-something-about-linq/80709#80709)问题。

我认为第一步是习惯点语法，然后才继续使用“sql”语法。否则一开始只会伤害你的眼睛。我确实想知道微软是否没有通过推动 sql 语法来减慢 linq 的使用速度，这让很多人认为“糟糕，我的 C# 中的 DB 代码”。

至于 lambdas，请先尝试使用匿名委托编写一些代码，因为如果您没有这样做，您将不会真正理解大惊小怪的全部内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T13:05:28.113

我有一个正则表达式解决方案，它只比您当前的循环[1] 慢 8 倍，而且比您的解决方案 [2] 更难阅读。

```
return Regex.Replace(text, @"(\P{Lu})(\p{Lu})", "$1 $2"); 
```

它匹配*unicode*字符组，在这种情况下非大写字母后跟一个大写字母，然后在它们之间添加一个空格。此解决方案比其他仅查找 [AZ] 的基于正则表达式的解决方案效果更好。

[1] 保留我快速编写的测试可能会很糟糕。
[2] 任何人都知道 unicode 字符组而不用谷歌搜索？;)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-27T13:12:48.067

您可以使用现有的 LINQ 函数来完成这项工作，但这可能不是最好的方法。以下 LINQ 表达式可以工作，但效果不佳，因为它会生成大量额外的字符串

```
public static string ProperCase(string text)
{
    return text.Aggregate(
        string.Empty,
        (acc, c) => Char.ToLower(c) != c ? acc + " " + c.ToString() : acc + c.ToString())
        .Trim();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-30T07:23:10.477

你有没有想过使用聚合函数...

例如，假设我有一个名为 routes 的数组，我想将所有 Active 字段设置为 false。这可以按如下方式完成：

routes.Aggregate(false, (value, route) => route.Active = false); - Routes 是表的名称。- 第一个 false 只是种子值，需要与正在设置的值的类型相同。这有点……多余。- 值也是多余的，基本上是第一个值。- route 是聚合值（序列中的每个单独元素）

不再有多余的 foreach 循环......我也不太了解 Lambda 表达式......但我敢肯定那里有 q 天才可以滥用它来做到这一点......

# asp.net-ajax - 如何防止某些控件在 UpdatePanel 中更新？

> ID：689633
> 
> 赞同：1
> 
> 时间：2009-03-27T12:43:47.293
> 
> 标签：asp.net-ajax, updatepanel

我有一个`UpdatePanel`里面有很多对象。刷新面板时如何防止其中一些重新加载？是否有一个标签来实现这一点，从更新中“隔离”一些元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T12:46:04.353

您最好的选择是`UpdatePanels`在布局中使用多个，以便您可以有效地对需要分组的内容进行分组。然后您需要确保将`UpdatePanels`它们设置为，`Conditional`以便您可以控制它们是否会在其他`UpdatePanels`异步回发时进行异步回发。

**编辑**：这是一个演示其中一些功能的[教程](http://www.asp.net/Ajax/Documentation/Live/overview/UpdatePanelOverview.aspx)

# java - 我是否需要担心与 tomcat spring beans 的并发性？

> ID：689637
> 
> 赞同：4
> 
> 时间：2009-03-27T12:44:58.477
> 
> 标签：java, spring, concurrency, javabeans

对 java 的了解不够，我是否需要在列出时担心并发问题，以及在单个服务器 tomcat 应用程序中更改我的 spring java bean 中的 DTO 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T17:01:43.287

简而言之，是的。Spring Beans 通常可以被多个线程共享。请特别注意 Spring Bean 中的成员变量。如果它们是可变的，要么使它们不可变，要么通过锁（例如同步）、ThreadLocal 等来协调访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T16:28:31.357

这是你需要问自己的问题。有没有办法让两个线程访问*同一个*DTO？我想在任何健全的架构中都没有。

Spring bean 本身通常是单例的（如果没有进行其他配置），并且应该是线程安全的。

如果所有 bean 都接收 DTO 作为参数，返回新创建的 DTO，并且这些 bean 的所有客户端都没有保留引用，那么 DTO 应该不是问题。至少从高水平的角度来看。

但是，您应该阅读有关 java 并发的内容。如果有机会，我会推荐[Goetz 的书。](http://jcip.net/)

最后，在过去，我记得 Rod Johnson（springsource 策划者）说 DTO 是邪恶的。请花一些时间在谷歌上搜索“DTO evil”并做出决定。

# web-farm - 网络农场文件分发

> ID：689643
> 
> 赞同：0
> 
> 时间：2009-03-27T12:46:26.227
> 
> 标签：web-farm

我正在寻找一种将文件从我的机器移动到网络场上的多台服务器的方法。

我目前使用超越比较来移动文件；场中的每台服务器一个 BC 会话。我对此很好，因为 BC 速度很快，而且我喜欢我拥有的控制。

我们的业务给了我一个图像文件自动分发的新需求。我已经阅读了一些关于 DFS 的信息，但我不确定这是我想要采取的路线。我希望文件实际上最终出现在服务器上。

任何用于此的工具。也许是一个脚本选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T14:41:57.227

我们使用[Robocopy](http://en.wikipedia.org/wiki/Robocopy)将相同的配置文件复制到 citrix 场中的所有服务器，效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:14:11.323

查看[MSDeploy](http://www.hanselman.com/blog/MSDeployNewIISWebDeploymentTool.aspx)和[MSBuild](http://msdn.microsoft.com/en-us/library/wea2sca5.aspx) [这](http://learn.iis.net/page.aspx/346/web-deployment-tool/)可能是 msdeploy 的较新版本

在我的地方，我认为我们使用[的是 WanSync](http://www.ca.com/us/products/product.aspx?id=8232)，尽管我不能 100% 确定，因为我不在那个部门。

# recursion - 在 SQL*PLus 中创建将多个 rtansaction 行“扁平化”为一行的平面文件

> ID：689645
> 
> 赞同：1
> 
> 时间：2009-03-27T12:48:21.883
> 
> 标签：recursion, plsql, flat-file

正如标题所说，我需要一种将多行扁平化为每个帐户一个 luine 输出的方法。例如表如下所示：

账户交易

12345678 ABC

12345678 DEF

12346578 GHI

67891011 ABC

67891011 JKL

我需要输出为：

12345678|ABC|DEF|GHI

67891011|ABC|JKL

交易金额未知。对于某些帐户，它可能是 1 或 2，一直到 100。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:25:26.770

您可以使用自定义版本的 [Tom Kyte 的 STRAGG 函数](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:2196162600402)来执行此操作，如下所示：

```
select account||'|'||stragg(transaction)
from mytable
where ...
group by account; 
```

给定的函数使用逗号分隔值，但您可以轻松地将其更改为使用“|”。

使用 EMP 的示例（仍然使用逗号）：

```
SQL> select deptno || '|' || stragg(ename) names
  2  from emp
  3  group by deptno;

NAMES
--------------------------------------------------------------------------------
10|CLARK,KING,FARMER,MILLER
20|JONES,FORD,SCOTT
30|ALLEN,TURNER,WARD,MARTIN,BLAKE 
```

# editor - 使用工具栏从编辑器提交 SAS 代码

> ID：689646
> 
> 赞同：1
> 
> 时间：2009-03-27T12:48:25.940
> 
> 标签：editor, toolbar, sas, dm, display-manager

[当通过 SAS 工具栏（例如cmjohns 响应](https://stackoverflow.com/questions/686581/submit-sas-code-or-macro-from-toolbar)）提交 SAS 代码时，编译器知道代码正在“DM'd”并且不会运行某些代码（例如 %window）。

有没有办法让 SAS 相信从工具栏提交的代码来自编辑器，从而允许通过点击触发界面（使用 %window）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:55:26.523

它不是超级干净，但这会做到这一点。唯一的缺点是程序编辑器窗口将在运行后打开。完成后可能有一种方法可以关闭它，但我不知道那是什么。

```
pgm; clear;include "C:\path\code.sas"; submit; 
```

基本上，这意味着打开一个新的程序编辑器窗口并确保其中没有其他代码，然后将 code.sas 的内容包含到编辑器中，然后提交程序编辑器中的所有代码。

作为旁注，除了工具栏按钮之外，我认为您也可以将功能键映射到这样的命令。按 F9 拉出当前映射。尽管没有长路径，但映射到键的命令的长度是有限制的。

# url - request.serverVariables() "URL" 与 "Script_Name"

> ID：689653
> 
> 赞同：6
> 
> 时间：2009-03-27T12:53:48.580
> 
> 标签：url, asp-classic, request.servervariables

我正在维护一个经典的 asp 应用程序，在查看代码时，我遇到了两行类似的代码：

```
Request.ServerVariables("URL")
' Output: "/path/to/file.asp"

Request.ServerVariables("SCRIPT_NAME")
' Output: "/path/to/file.asp" 
```

我不明白...有什么区别？他们都忽略了我设置的将 /path 文件夹作为根文档的 URL 重写（上面的 URL 被重写为“/to/file.asp”）

**更多信息**：该站点部署在 IIS 7 上

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-09-23T10:41:35.917

URL 给出 URL 的基本部分，没有任何查询字符串或额外的路径信息。对于原始 URL，请使用 HTTP_URL 或 UNENCODED_URL。

SCRIPT_NAME 正在执行的脚本的虚拟路径。可用于自引用 URL。

请参阅[http://www.requestservervariables.com/url](http://www.requestservervariables.com/url) 和 /script_name 的定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T21:38:03.700

这可能是 IIS 7 下的错误。

我无法获取`Request.ServerVariables("URL")`并`Request.ServerVariables("SCRIPT_NAME")`返回不同的值。我已经尝试过从包含文件 ( `<!--#include file="file.asp"-->`) 或在`Server.Transfer`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T12:59:42.777

如果是 Server.Transfer，这可能存在吗？

如果你做一个 server.transfer 我*认为*你会得到不同的结果

即 SCRIPT_NAME 将是例如 /path/to.transferredfile.asp 而 URL 将保持为 /path/to/file.asp

# web-services - Web服务的授权/许可

> ID：689663
> 
> 赞同：0
> 
> 时间：2009-03-27T12:57:15.090
> 
> 标签：web-services, authorization

我开发了一个 Web 服务，它接受来自传递给它的 XML 消息的登录凭据。我担心这种方法，因为使用该服务的开发人员可以轻松共享登录凭据，并且可以从使用相同凭据的其他应用程序调用我的服务。
有什么方法可以向某些特定应用程序颁发“许可证”？因此，即使在消费应用程序之间共享凭据，也只有经过授权的应用程序才能成功使用该服务。

PS：我考虑过实施 IP 限制，但这并没有达到目的，因为我们可能在同一台服务器上安装了不同的应用程序（我们确实实现了这样的场景）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T13:03:41.237

您是否考虑在客户端计算机上安装安全证书。Verisign 和其他类似的公司颁发证书，您的客户需要在调用机器上安装这些证书。

这当然是收费的！

# html - 侧边栏在 Opera 中无法正确显示

> ID：689665
> 
> 赞同：1
> 
> 时间：2009-03-27T12:57:24.857
> 
> 标签：html, css, opera

即使在我最好的日子里，我在追踪浏览器显示问题时也非常沮丧。

[在 Opera 中，此页面 ( http://www.taysf.org/about](http://www.taysf.org/about) )的左侧边栏无法正确显示。在其他所有浏览器中，侧边栏都有一个橙色条纹棕褐色块背景，出于某种原因，我无法理解 Opera 中不显示该背景。

你知道为什么吗？你会同情我吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T14:02:27.167

您页面的摘录（已删除空格）：

```
(...)
<input type="hidden" name="log" id="edit-log" value=""  />
</div>
</div></form>

</div>
</div></form>
<ul class="topnav">
(...) 
```

看到那一秒了`</div></form>`吗？您关闭了一个 div 太多（准确地说是 div#page；另外，您试图关闭一个不存在的表单）。Opera 照你说的做，关闭了 div#page，因此 div#content 不在 div#page 内，因此它下面没有显示背景。其他浏览器看到了不匹配的标签并猜出了你的想法（在这种情况下，成功）。

# concurrency - 检测并发问题的工具

> ID：689671
> 
> 赞同：0
> 
> 时间：2009-03-27T12:59:07.037
> 
> 标签：concurrency, thread-safety

我看到了一个工具，它可以告诉您项目中是否存在设计问题，我想知道是否有一个工具可以动态地告诉您项目中是否存在一些并发问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:01:22.523

MS Research 的 Chess 很棒（[http://research.microsoft.com/en-us/projects/chess/](http://research.microsoft.com/en-us/projects/chess/)）它在单元测试的帮助下检测并发错误，重要的是：它们可以用国际象棋重现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-06T16:22:37.293

我想你会发现，通过静态代码分析来检测这种类型的东西，基本上是变相的[停机问题](http://en.wikipedia.org/wiki/Halting_problem)，因此在一般情况下是不可判定的。这样的工具几乎肯定不存在。

与确实存在的证明工具最接近的方法是将计算建模为[“通信顺序过程”，](http://en.wikipedia.org/wiki/Communicating_sequential_processes)可以对其进行正式的数学推理。但是，这不允许您生成可以使用任意语言获取任意程序并为其计算证明的工具。

# c++ - 为什么将未使用的返回值强制转换为 void？

> ID：689677
> 
> 赞同：120
> 
> 时间：2009-03-27T13:00:59.153
> 
> 标签：c++, c, void

```
int fn();

void whatever()
{
    (void) fn();
} 
```

是否有任何理由将未使用的返回值转换为 void，还是我认为这完全是浪费时间？

跟进：

嗯，这似乎很全面。我认为这比注释未使用的返回值要好，因为自记录代码比注释更好。就个人而言，我会关闭这些警告，因为它是不必要的噪音。

如果有虫子因此逃跑，我会吃掉我的话......

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-27T13:12:34.150

大卫的[回答](https://stackoverflow.com/questions/689677/casting-unused-return-values-to-void/689688#689688)几乎涵盖了这样做的动机，明确地向其他“开发人员”展示你知道这个函数返回但你明确地忽略它。

这是一种确保始终处理必要的错误代码的方法。

我认为对于 C++，这可能也是我更喜欢使用 C 风格转换的唯一地方，因为在这里使用完整的静态转换表示法感觉有点矫枉过正。最后，如果您正在审查编码标准或编写一个编码标准，那么明确声明对重载运算符的调用（不使用函数调用表示法）也应该免除此限制也是一个好主意：

```
class A {};
A operator+(A const &, A const &);

int main () {
  A a;
  a + a;                 // Not a problem
  (void)operator+(a,a);  // Using function call notation - so add the cast. 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-27T13:03:49.257

在工作中，我们使用它来确认函数具有返回值，但开发人员已断言忽略它是安全的。由于您将问题标记为 C++，因此您应该使用*static_cast*：

```
static_cast<void>(fn()); 
```

就编译器而言，将返回值强制转换为 void 没有什么意义。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-03-27T13:13:13.510

这样做的真正原因可以追溯到用于 C 代码的工具，称为[lint](http://opengroup.org/onlinepubs/007908775/xcu/lint.html)。

它分析代码以寻找可能的问题并发出警告和建议。如果函数返回了一个未检查的值，`lint`则会发出警告以防意外。`lint`要对此警告保持沉默，请将呼叫发送到`(void)`。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-08-23T12:11:47.997

转换`void`为用于抑制未使用的变量和未保存的返回值或表达式的编译器警告。

标准（2003）在 §5.2.9/4 中说，

> 任何表达式都可以显式转换为类型“cv void”。表达式值被**丢弃**。

所以你可以写：

```
//suppressing unused variable warnings
static_cast<void>(unusedVar);
static_cast<const void>(unusedVar);
static_cast<volatile void>(unusedVar);

//suppressing return value warnings
static_cast<void>(fn());
static_cast<const void>(fn());
static_cast<volatile void>(fn());

//suppressing unsaved expressions
static_cast<void>(a + b * 10);
static_cast<const void>( x &&y || z);
static_cast<volatile void>( m | n + fn()); 
```

所有表格均有效。我通常将其缩短为：

```
//suppressing  expressions
(void)(unusedVar);
(void)(fn());
(void)(x &&y || z); 
```

它也可以。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-12-23T19:36:50.720

从 c++17 开始，我们有了`[[maybe_unused]]`可以用来代替强制转换的属性`void`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-27T13:05:18.240

铸成无效是无成本的。它只是编译器如何处理它的信息。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-27T13:16:41.690

对于您将程序转换为 void 的功能是没有意义的。我还认为你不应该使用它来向正在阅读代码的人发出信号，正如大卫在回答中所建议的那样。如果您想就您的意图传达一些信息，最好使用评论。添加这样的演员只会看起来很奇怪，并会引发有关可能原因的问题。只是我的观点...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-20T20:59:25.897

此外，在验证您的代码是否符合 MISTA（或其他）标准时，LDRA 等自动工具将不允许您调用具有返回类型的函数而不返回值，除非您将返回值显式转换为 (void)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-08T09:09:30.497

**C++17`[[nodiscard]]`**

C++17 用一个属性标准化了“返回值忽略业务”。

因此，我希望兼容的实现总是只在给出时才`nodiscard`发出警告，否则永远不会发出警告。

例子：

主文件

```
[[nodiscard]] int f() {
    return 1;
}

int main() {
    f();
} 
```

编译：

```
g++ -std=c++17 -ggdb3 -O0 -Wall -Wextra -pedantic -o main.out main.cpp 
```

结果：

```
main.cpp: In function ‘int main()’:
main.cpp:6:6: warning: ignoring return value of ‘int f()’, declared with attribute nodiscard [-Wunused-result]
    6 |     f();
      |     ~^~
main.cpp:1:19: note: declared here
    1 | [[nodiscard]] int f() {
      | 
```

以下都避免了警告：

```
(void)f();
[[maybe_unused]] int i = f(); 
```

我无法`maybe_unused`直接在`f()`通话中使用：

```
[[maybe_unused]] f(); 
```

给出：

```
main.cpp: In function ‘int main()’:
main.cpp:6:5: warning: attributes at the beginning of statement are ignored [-Wattributes]
    6 |     [[maybe_unused]] f();
      |     ^~~~~~~~~~~~~~~~ 
```

`(void)`演员工作似乎不是强制性的，但在标准中是“鼓励的”：我[怎样才能故意丢弃 [[nodiscard]] 返回值？](https://stackoverflow.com/questions/53581744/how-can-i-intentionally-discard-a-nodiscard-return-value)

同样从警告消息中可以看出，警告的一个“解决方案”是添加`-Wno-unused-result`：

```
g++ -std=c++17 -ggdb3 -O0 -Wall -Wextra -pedantic -Wno-unused-result -o main.out main.cpp 
```

尽管我当然不建议像这样在全球范围内忽略警告。

C ++ 20 还允许您添加一个原因，`nodiscard`如`[[nodiscard("reason")]]`所述：[https ://en.cppreference.com/w/cpp/language/attributes/nodiscard](https://en.cppreference.com/w/cpp/language/attributes/nodiscard)

**GCC`warn_unused_result`属性**

在 标准化之前`[[nodiscard]]`，对于 C 在他们最终决定标准化属性之前，GCC 实现了与 完全相同的功能`warn_unused_result`：

```
int f() __attribute__ ((warn_unused_result));

int f() {
    return 1;
}

int main() {
    f();
} 
```

这使：

```
main.cpp: In function ‘int main()’:
main.cpp:8:6: warning: ignoring return value of ‘int f()’, declared with attribute warn_unused_result [-Wunused-result]
    8 |     f();
      |     ~^~ 
```

应该注意的是，由于 ANSI C 对此没有标准，因此 ANSI C 没有指定哪些 C 标准库函数具有该属性，因此实现已经自己决定应该用 标记或不标记什么`warn_unuesd_result`。这就是为什么通常您必须使用`(void)`强制转换来忽略对标准库函数的任何调用的返回，以完全避免任何实现中的警告。

在 GCC 9.2.1、Ubuntu 19.10 中测试。

# c# - Request.Url.Host 和 ApplicationPath 一次调用

> ID：689678
> 
> 赞同：18
> 
> 时间：2009-03-27T13:01:04.520
> 
> 标签：c#, asp.net, code-behind, httpcontext

有什么方法可以`HttpContext.Current.Request.Url.Host`一键`HttpContext.Current.Request.ApplicationPath`通话吗？

像“完整的应用程序网址”之类的东西？

编辑：澄清-我需要的是[]中的部分：

```
http://[www.mysite.com/mywebapp]/Pages/Default.aspx 
```

我只是出于好奇而问。

编辑 2：感谢所有回复，但没有一个是我正在寻找的。仅供参考，我以这种方式解决了问题（但我仍然想知道是否有更顺畅的方式）：

```
public string GetWebAppRoot()
{
    if(HttpContext.Current.Request.ApplicationPath == "/")
        return "http://" + HttpContext.Current.Request.Url.Host;
    else
        return "http://" + HttpContext.Current.Request.Url.Host + HttpContext.Current.Request.ApplicationPath;
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-27T14:06:56.390

```
public static string GetSiteRoot()
{
  string port = System.Web.HttpContext.Current.Request.ServerVariables["SERVER_PORT"];
  if (port == null || port == "80" || port == "443")
    port = "";
  else
    port = ":" + port;

  string protocol = System.Web.HttpContext.Current.Request.ServerVariables["SERVER_PORT_SECURE"];
  if (protocol == null || protocol == "0")
    protocol = "http://";
  else
    protocol = "https://";

  string sOut = protocol + System.Web.HttpContext.Current.Request.ServerVariables["SERVER_NAME"] + port + System.Web.HttpContext.Current.Request.ApplicationPath;

  if (sOut.EndsWith("/"))
  {
    sOut = sOut.Substring(0, sOut.Length - 1);
  }

  return sOut;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-09-28T01:53:41.553

这不适用于带有端口号的本地主机，因此进行了较小的修改：

```
 private string GetWebAppRoot()
    {
        string host = (HttpContext.Current.Request.Url.IsDefaultPort) ? 
            HttpContext.Current.Request.Url.Host : 
            HttpContext.Current.Request.Url.Authority;
        host = String.Format("{0}://{1}", HttpContext.Current.Request.Url.Scheme, host);            
        if (HttpContext.Current.Request.ApplicationPath == "/")
            return host;
        else
            return host + HttpContext.Current.Request.ApplicationPath;
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-08-19T13:46:35.097

你真正应该做的是：

```
return String.Format("{0}://{1}/", Request.Url.Scheme, Request.Url.Host); 
```

如果您使用的是 HTTPS（或其他模式！）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T16:06:26.017

感谢所有回复，但没有一个是我想要的。仅供参考，我以这种方式解决了问题（但我仍然想知道是否有更顺畅的方式）：

```
public string GetWebAppRoot()
{
    if(HttpContext.Current.Request.ApplicationPath == "/")
        return "http://" + HttpContext.Current.Request.Url.Host;
    else
        return "http://" + HttpContext.Current.Request.Url.Host + HttpContext.Current.Request.ApplicationPath;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T13:10:37.867

检查[这篇文章](http://blog.veggerby.dk/2009/01/15/getting-an-absolute-url-from-aspnet-webforms/)：

```
public static Uri GetBaseUrl(HttpRequest request)
{
    Uri contextUri = new Uri(request.Url, request.RawUrl);
    UriBuilder realmUri = new UriBuilder(contextUri) { Path = request.ApplicationPath, Query = null, Fragment = null };
    return realmUri.Uri;
}

public static string GetAbsoluteUrl(HttpRequest request, string relativeUrl)
{
    return new Uri(GetBaseUrl(request), VirtualPathUtility.ToAbsolute(relativeUrl)).AbsoluteUri;
} 
```

如果你没有直接从 GetBaseUrl 得到你需要的东西，应该可以这样做：

`GetAbsoluteUrl(HttpContext.Current.Request, "/")`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T13:11:05.870

```
HttpContext.Current.Request.Url.AbsoluteUri 
```

# c# - 我如何确保数据类型实现 IComparable 接口

> ID：689681
> 
> 赞同：2
> 
> 时间：2009-03-27T13:01:58.183
> 
> 标签：c#, interface

我需要确保数据类型实现 IComparable 接口，我想知道在创建对象时是否有任何要求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T13:05:07.663

您也许可以使用泛型来执行此操作，例如：

```
public static T Create<T>() where T : IComparable<T>, new() {
    return new T();
} 
```

或者，如果您的意思是“当您创建类型时”（在代码中），那么不；你只需要记住，也许使用单元测试来验证你已经完成了它。

我建议使用 typed `IComparable<T>`over `IComparable`- 它使生活变得更轻松（并且避免了一些拳击，但这不是问题）。最后，请记住，如果您想对可比较的位进行鸭式输入（例如如何工作） ，可以在代码中使用`Comparer<T>.Default`和。`Comparer.Default``List<T>.Sort()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:06:56.410

对于通用类，您可以执行以下操作：

```
public class MyType<T>
   where T:IComparable<T> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T13:10:08.993

您可能还想查看[Comparer<T>.Default](http://msdn.microsoft.com/en-us/library/azhsac5f.aspx)。据我了解，它首先获取 IComparable<T>，如果找不到，则获取 IComparable 版本，否则将引发异常。

```
double s = 5;
double t = 10;
int result = Comparer<double>.Default.Compare(s, t); 
```

# iphone - 通过 UIView 将触摸传递给 UIScrollView 不起作用

> ID：689684
> 
> 赞同：3
> 
> 时间：2009-03-27T13:03:10.147
> 
> 标签：iphone, cocoa-touch

我有一个从 UIScrollView 控制器派生的视图，我用它来浏览库中的图像。这很好用。

我在右侧覆盖了一个 UIView 来处理快速滚动图像列表的触摸。我的问题是，如果我将触摸传递给“super”或“nextResponder”，它们永远不会到达下面的 UIScrollView 对象。

我的问题是如何强制下面的 UIScrollView 处理我不需要处理的触摸？我将计时器设置为 0.3 秒，在此期间所有触摸都传递给 UIScrollView 进行处理。因此，如果用户开始滑动手势来翻页，它就会发生。

这是 touchesBegan 方法的代码：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
[super touchesBegan:touches withEvent:event];

// Start a timer to trigger the display of the slider and the processing of events.
touchesTimer = [NSTimer scheduledTimerWithTimeInterval:0.3 target:self selector:@selector(showSlider:) userInfo:nil repeats:NO];

// Where are we at right now?
UITouch *touch = [touches anyObject];
CGPoint currentPoint = [touch locationInView:self.view];
lastPage = [self page:currentPoint.y];

// Pass the event though until we need it.
//  [self.nextResponder touchesBegan:touches withEvent:event];
if ([touch.view isKindOfClass:[UIScrollView class]]) 
{
    if (self.nextResponder != nil &&
        [self.nextResponder respondsToSelector:@selector(touchesEnded:withEvent:)]) 
    {
        [self.nextResponder touchesEnded:touches withEvent:event];
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:08:01.137

我会尝试使用常规的 UIViewController 而不是 UIScrollViewController，然后在需要的地方添加滚动视图对象，并将所需的滚动速度更快的视图放在右侧。这样它们是分开的，触摸不会混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T17:15:34.557

这是一个更简单的解决方案，对我来说效果很好：

在 UIScrollview 顶部的 UIView 中，将宽度和高度都设为 0（这样视图在技术上不再位于 UIScrollView 顶部）并设置 clipsToBounds = NO（这样视图的内容仍然显示在顶部UIScrollView）。

```
 self.OverlayView.clipsToBounds = NO;
 CGRect frame = self.OverlayView.frame;
 self.OverlayView.frame = CGRectMake(frame.origin.x, frame.origin.y, 0, 0); 
```

请注意，如果 UIView 包含交互式控件，则它们将不再起作用。您需要将其移动到 UIScrollView 上方的自己的视图中。

# svn - 我在哪里可以找到执行此操作的基于 Web 的 svn 管理应用程序

> ID：689685
> 
> 赞同：0
> 
> 时间：2009-03-27T13:03:34.500
> 
> 标签：svn

我正在寻找一个基于 web 的 svn 管理员，它可以使用 LDAP 用户和组，它可以通过 web 界面创建 repos 添加/修改 repo 的钩子。

例如，您有一个可以访问多个存储库的 LDAP 组。然后，您可以在组中拥有一个用户，该用户可以是该组中所有用户的管理员。

此管理员可以为 AD 用户创建内部/单一存储库组，并为所有用户和存储库组设置对存储库的访问权限。

浏览代码库并不那么重要，因为在开发过程中任何人都可以使用一百万种工具。

是否有用于 svn 的网络管理工具来完成所有这些工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T13:44:56.973

VisualSVN 服务器绝对是要走的路。但是，您无法从 Web 界面管理权限或挂钩。我使用远程桌面来管理我们在服务器上的安装。我也不认为有任何方法可以按照您的要求设置管理员权限。

除非您有不寻常的需求，否则我建议您通过使用单个存储库并设置文件夹权限来使您的 Subversion 结构尽可能简单。这[本书](http://svnbook.red-bean.com/)解释了为什么单一存储库是最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:24:24.510

我所知道的唯一 SVN 实现是 VisualSVN Server。它在[www.visualsvn.com免费](http://www.visualsvn.com)

我不确定您是否可以通过网络管理它；值得研究。但它确实使用 Active Directory 作为身份验证和组的选项。

# ruby - 使用 Ruby 在命令行中包含文件

> ID：689689
> 
> 赞同：6
> 
> 时间：2009-03-27T13:04:58.973
> 
> 标签：ruby, command-line, include

像这样运行 ruby​​ 脚本时

```
ruby some-script.rb 
```

我将如何在其中动态包含文件（例如配置文件）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-27T14:35:23.640

如您所见， -r 选项是您的朋友。它也适用于 IRB：

```
irb -ropen-uri 
```

会做同样的事情`require 'open-uri'`

FWIW，我需要通过命令行包含的最常见的东西是 ruby​​gems。而且由于较新版本的 ruby​​ 带有内置的 gem，我不想编辑该文件，而是将其包含在测试中。幸运的是，创造宝石的人添加了一点别名糖。

您可以执行以下操作：

```
ruby -rubygems myscript.rb 
```

而不是丑陋的：

```
ruby -rrubygems myscript.rb 
```

好的，所以它是一个角色，但认为这是让我更快乐的额外修饰。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T13:06:55.130

其实，我找到了。这是 -r 命令行条目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-13T18:31:51.833

```
 -r <library_name> 
```

这会导致 Ruby 使用 require 加载库。

`-n`与or结合使用时很有用`-p`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T13:10:36.103

您可以使用：

```
require 'some_ruby_file' 
```

在 some-script.rb 中。它将加载 some_ruby_file.rb。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-02-03T15:41:39.627

在调用之前，`require "somefile.rb"`您必须导航到文件所在的文件夹，或者您必须提供完整路径。例如：`require "~/Documents/Somefolder/somefile.rb"`

# objective-c - 是否可以从任何页面进入 rootViewController 页面？

> ID：689696
> 
> 赞同：1
> 
> 时间：2009-03-27T13:06:08.987
> 
> 标签：objective-c, xcode

我正在尝试构建一个 iPhone 应用程序。我正在尝试在基于视图的应用程序中构建它。

假设我已经从 x.xib nib 文件转到 y.xib 文件。x.xib nib 文件来自 root.xib 文件。我想从 y.xib 去 root.xib 文件。

如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-10T13:14:22.807

```
[self.navigationController popToRootViewControllerAnimated:YES] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T16:35:07.313

看一下 UINavigationController 上的 popToRootViewControllerAnimated 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T02:04:39.770

在 didFinishLaunchingWithOptions 中：

_initalStoryboard = self.window.rootViewController.storyboard;

```
- (void)resetWindowToInitialView
{
    for (UIView* view in self.window.subviews)
    {
        [view removeFromSuperview];
    }

    UIViewController* initialScene = [_initalStoryboard instantiateInitialViewController];
    self.window.rootViewController = initialScene;
} 
```

# c++-cli - C++/CLI：实现 IList 和 IList （默认索引器的显式实现）

> ID：689704
> 
> 赞同：5
> 
> 时间：2009-03-27T13:08:21.460
> 
> 标签：c++-cli, indexer, explicit-interface

我正在尝试实现一个同时实现`IList`和的 C++/CLI 类`IList<T>`。

由于它们有重叠的名称，我必须显式地实现其中一个，自然选择应该是 IList。

索引器的隐式实现是：

```
using namespace System::Collections::Generic;
generic<class InnerT> public ref class MyList : public System::Collections::IList, IList<InnerT> {
  // ...
  property InnerT default[int]{
    virtual InnerT get(int index);
    virtual void set(int index, InnerT item);
  }
} 
```

我现在正在尝试为 IList 声明默认索引器。

我的猜测是这样的：

```
 property Object^ System::Collections::IList::default[int]{
    virtual Object^ System::Collections::IList::get(int index);
    virtual void System::Collections::IList::set(int index, Object^ item);
  } 
```

但这只是给了我

> 错误 C2061：语法错误：标识符“默认”

有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T13:50:44.590

[JaredPar 的回答](https://stackoverflow.com/questions/689704/c-cli-implementing-ilist-and-ilistt-explicit-implementation-of-a-default-inde/689773#689773)几乎奏效了。应该改变两点：

*   indexer-property 需要一个不同的名称，因为隐式实现已经采用了“default”。
*   覆盖的规范需要在 set 和 get 方法上完成，而不是在属性本身上。

IE：

```
 property Object^ IListItems[int]{
    virtual Object^ get(int index) = System::Collections::IList::default::get;
    virtual void set(int index, Object^ item)  = System::Collections::IList::default::set;
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T13:31:46.537

没有在 C++/CLI 中完成很多接口，但这似乎涵盖了[C++/CLI 规范](http://www.plumhall.com/C++-CLI%20draft%201.5.pdf)的 8.8.10.1 。我相信您正在寻找的功能是显式覆盖。在这种情况下，您必须像这样在定义之后指定实现的成员。

```
property Object^ default[int] = System::Collections::IList::default {... } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T13:24:16.947

我编译了一个`IList<T>`用 C# 显式编写的类，并用 Reflector 打开它并反汇编为 C++/CLI。

```
T System::Collections::Generic::IList<T>::get_Item(Int32 __gc* index)
{
   //
}

void __gc* System::Collections::Generic::IList<T>::set_Item(Int32 __gc* index, T value)
{
   //
} 
```

但它不编译：`get_Item`，`set_Item`不是`IList<T>`;的成员

# c# - 扩展一个类，编译器抱怨 Microsoft.MapPoint.PlugIns.PlugIn 不包含

> ID：689705
> 
> 赞同：2
> 
> 时间：2009-03-27T13:08:35.283
> 
> 标签：c#, .net, virtual-earth

我正在遵循 Microsoft Virtual Earth SDK 附带的教程，当我尝试创建一个插件时，编译器不会让我这样做。

我正在扩展 Microsoft.MapPoint.PlugIn.PlugIn 类，它有两个我已经实现的抽象方法（本教程没有讨论）。但是，当我编译它时，Visual Studio 说

> “Microsoft.MapPoint.PlugIns.PlugIn”不包含采用“0”参数的构造函数

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:12:26.647

您可能需要添加一个将某些内容传递给*基本*构造函数的构造函数；添加：

```
class Foo : PlugIn {
    public Foo() : base( //****** here
} 
```

当你输入时`base(`，智能感知应该告诉你你需要给基础构造函数什么。

* * *

**从搜索编辑**，您需要：

```
 public Foo (Host host)
        : base(host)
    {
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:14:01.323

如果您有构造函数，则需要确保正在调用存在的基类构造函数。默认情况下，我相信编译器会尝试一对一地对齐构造函数，但如果这不是您想要的功能或构造函数不存在，则需要定义要调用的基类构造函数。

```
public Class()
            : base(/*variables here*/)
        { 

        } 
```

# streaming - 从 Amazon S3 流式传输 MP3

> ID：689723
> 
> 赞同：37
> 
> 时间：2009-03-27T13:15:25.547
> 
> 标签：streaming, mp3, amazon-s3

有没有办法通过嵌入网站的 Flash 小部件或其他方法流式传输存储在 Amazon S3 上的 MP3？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-27T13:17:27.353

是的。首先，您需要在您的 S3 帐户中创建一个全部小写、全局唯一且与 DNS 兼容的存储桶；例如，我创建了一个名为“media.torusknot.com”的存储桶。

然后，为了让这一切看起来不错，您需要创建一个 DNS CNAME 条目以将您站点的子域映射到该 S3 存储桶。这将允许您通过 '<a href="http://media.example.com/somefile.mp3" rel="noreferrer">http://media.example.com 访问您上传到该 S3 存储桶的文件/somefile.mp3'。您只需要在文件和存储桶上设置 ACL 以确保允许公共访问。

最后，如果您想通过 Flash 播放器将视频文件从 S3 流式传输到另一个域，您还必须告诉 Flash 可以从另一个域中提取内容。在存储桶中创建一个名为“crossdomain.xml”的文件，其中包含以下内容：

```
<cross-domain-policy>
<site-control permitted-cross-domain-policies="all"/>
</cross> 
```

这允许从任何地方访问媒体 - 如果需要，您可以更具体，但这是最简单的方法。

相关资源：

*   [使用亚马逊网络服务](http://www.longtailvideo.com/support/tutorials/Using-Amazon-Web-Services)
*   [来自 Amazon S3 的流媒体](http://www.stevestreeting.com/2008/09/29/streaming-media-from-amazon-s3/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-04-11T18:14:57.537

要更新此问题的答案，如果您想真正向客户进行 STREAM，您可以在您的 S3 存储桶之上使用 Amazon Cloudfront（如 Rudolf 所述）。在 Cloudfront 中创建指向您的 S3 存储桶的“流式分发”。

这将通过 RTMP 流式传输（适用于网络和 Android 设备）。您可以使用 JW Player 或类似的播放器来播放流文件。

Cloudfront Streaming uses Adobe Flash Media Server 3.5\.

There is also the ability to play secure content using signed urls.

# jquery - 如何将 Prototype 和 jQuery 与 Scriptaculous 集成？

> ID：689724
> 
> 赞同：2
> 
> 时间：2009-03-27T13:16:27.463
> 
> 标签：jquery, prototypejs, conflict, scriptaculous

我一直在使用[jQuery](http://en.wikipedia.org/wiki/JQuery)，我需要使用[Script.aculo.us](http://en.wikipedia.org/wiki/Script.aculo.us)和[Protoype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)。我尝试使用扩展另一个库的 jQuery 库。我使用以下语法定义它：

```
jQuery.noConflict();
jQuery(document).ready(function() {
}); 
```

我的 jQuery 工作正常，我已经划分了三个模块。我需要将所有三个模块放在同一页面上。我知道使用所有三个不同的库效率不高，但我没有看到其他方法。

*   对于验证，我使用 jQuery 和[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)（例如：validation.js）。

*   我的动画的其余部分使用 Prototype 和 Script.aculo.us（例如：animation.js）。

我已经分离了脚本文件。我的问题是，如果我的动画部分工作正常，那么 Ajax 部分就不能工作。如果 Ajax 部分正常工作，则验证不工作。我正在替换代码，但我仍然无法集成。

### 问题：

1.  jQuery 是否提供了一种简单的方法来完成这项工作？

2.  Prototype 和 Script.aculo.us 是否有不应该与 jQuery 冲突的程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T13:31:00.360

我认为你能做的最好的事情是将你的 AJAX 和验证从 jQuery 切换到 Prototype。那应该可以解决问题。Prototype 也有很好的验证和 AJAX。

[http://prototypejs.org/api/ajax](http://prototypejs.org/api/ajax)

验证只需谷歌“原型验证”。

您还可以将动画部分切换到 jQuery（它具有非常好的动画功能）。
[http://docs.jquery.com/Effects](http://docs.jquery.com/Effects)

我个人会选择后者，因为我更喜欢 jQuery 不干扰 object.prototype 链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T17:37:17.133

你最好选择一组库。jQuery 和 Prototype 都可以处理相同类型的东西，而且它们不太喜欢在同一个沙箱中玩。

# mysql - 如何在 Leopard、Mac OS X 10.5 上安装 MySQL？

> ID：689729
> 
> 赞同：0
> 
> 时间：2009-03-27T13:18:08.723
> 
> 标签：mysql, macos, installation

我按照[本](http://hivelogic.com/articles/view/installing-mysql-on-mac-os-x)教程进行到最后，然后发现它无法正常工作。我想我已经安装了所有东西，但是当我输入

```
mysql -uroot 
```

我只得到

```
-bash: mysql: command not found 
```

**注意：**我没有跳过“设置路径”步骤。第一次运行此命令时：

```
mate ~/.bash_login 
```

这带来了一个空文件。所以我添加了这一行：

```
export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH" 
```

我保存了文件，关闭了TextMate，执行了以下命令：

```
. ~/.bash_login 
```

...并继续本教程。根据您的建议，我认为该文件可能实际上并未保存。所以我运行以下命令再次调出文件：

```
mate ~/.bash_login 
```

...但是文件的内容是应有的。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T13:21:23.053

您的路径中可能没有 mysql 二进制文件。

您发布的链接有一个关于设置路径的部分，标题为“设置路径不要跳过这一步！如果你这样做，其他大多数事情都会失败。”

编辑：作为调试步骤，尝试：

*   首先启动一个新的终端窗口。它现在运行吗？
*   在提示符处键入“echo $PATH”。当您在 bash_profile 中键入路径时，路径是否正确显示？
*   长时间运行：/usr/local/mysql/bin/mysql -u root 应用程序是否运行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T22:27:40.837

两件事情：

*   尝试编辑`~/.profile`（而不是`~/.bash_profile`或`~/.bash_login`）。
*   [您可能会发现直接从 Sun](http://dev.mysql.com/downloads/mysql/5.1.html#macosx-dmg)使用本机 Mac 风格的 .dmg 安装程序更容易。

dmg 安装程序的一个好处是它会自动设置到 /usr/local/mysql 的符号链接（这意味着更少或没有摆弄你的 $PATH）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T13:21:57.403

你有没有按照说的步骤

> 设置路径
> 
> 不要跳过此步骤！如果你这样做，其他大多数事情都会失败。

您是否关闭了终端窗口并在之后重新打开它？

更新：“哪个mysql”说什么？“ls /usr/local/mysql/bin”会说吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T14:43:27.847

And if you're not a command-line person, I highly recommend you also install the MySQL Preference Pane to start/stop the server and install Sequel Pro to create databases and run queries.

[ftp://ftp.mysql.com/pub/mysql/download/gui-tools/MySQL.prefPane-leopardfix.zip](ftp://ftp.mysql.com/pub/mysql/download/gui-tools/MySQL.prefPane-leopardfix.zip)

[http://www.sequelpro.com/](http://www.sequelpro.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T13:24:31.237

另一种选择是使用**[MAMP](http://www.mamp.info)**。

它已打包 Apache、PHP 和 MySQL，无需进一步设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T13:24:46.727

MySQL 通常放在 /usr/local/mysql/bin/

您需要将其添加到您的 PATH，您可以通过将以下行添加到您的 .bash_profile 来做到这一点

```
PATH=$PATH:/usr/local/mysql/bin/
export PATH 
```

.bash_profile 文件位于用户名目录的根目录中。

确保重新启动终端以使设置生效。

# installshield - 回滚时如何执行 Installshield 自定义操作？

> ID：689730
> 
> 赞同：1
> 
> 时间：2009-03-27T13:18:16.540
> 
> 标签：installshield, custom-action, conditional-statements, rollback

我有一个 InstallShield 安装程序，它可以做一些事情。如果安装中断，则开始回滚。我知道我可以为我的自定义操作创建条件以使其仅在安装或卸载期间运行，但我设置哪个条件使其在回滚时运行？

确切地说，我需要回滚和删除。目前，我已经设置了 REMOVE，它在卸载时完美运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T15:57:43.853

通过条件未检测到回滚。而是将自定义操作的脚本内执行设置为回滚选项之一。然后，此操作将仅在调度它的序列之后发生的回滚期间运行，并且仅当其条件在序列中的该点为真时才运行。

# c# - 我可以获取从 SqlDataSource 执行的查询吗？

> ID：689731
> 
> 赞同：5
> 
> 时间：2009-03-27T13:18:19.237
> 
> 标签：c#, asp.net, sqldatasource

我对我的 SqlDataSource 上的 SelectCommand 有一个 sql 查询。它如下所示：

```
SELECT * FROM Books WHERE BookID = @BookID 
```

TextBox 使用 Asp:ControlParameter 提供 @BookID 参数。

当我在单步执行代码时查看 SelectCommand 时，我看到：

```
SELECT * FROM Books WHERE BookID = @BookID 
```

我真正想看到的是，如果这个人在 TextBox 中输入 3，我想看到

```
SELECT * FROM Books WHERE BookID = 3 
```

我不知道如何访问上述内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T13:21:48.823

查看实际查询的一种方法是使用 SQL Profiler。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T13:33:01.137

查询永远不会执行为

```
SELECT * FROM Books WHERE BookID = 3 
```

它实际上是传递参数的参数化查询。

您可以使用相关参数对查询执行“查找/替换”以查看它的外观。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T13:34:34.457

（此答案假定使用 SqlClient 实现。）

不，你看不到执行的 sql 代码。SqlCommand 类调用 sp_execute（具体实现请参见 SqlCommand.BuildExecute 方法），它将查询与参数分开。您需要使用 Sql Profiler 来查看执行的确切查询。

您可以使用提供的 DbCommand（来自 Selecting 事件）来解析您的 CommandText 并将参数替换为它们的实际值。这需要一些逻辑来进行转义，并且它不会是 Sql Server 执行的确切查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T06:20:14.377

```
Public Function GenSQLCmd(ByVal InSqlCmd As String, ByVal p As Data.Common.DbParameterCollection) As String
    For Each x As Data.Common.DbParameter In p
        InSqlCmd = Replace(InSqlCmd, x.ParameterName, x.Value.ToString)
    Next
    Return InSqlCmd
End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T13:27:15.957

我猜您将无法像您希望的那样看到 select 语句，因为该参数在语句中没有被替换为值 3，而是像您将其写入 sql server（使用参数）一样发送。

这实际上很好，因为它可以防止有人在你的文本框中注入一些恶意的 sql 代码，例如。

无论如何，您不能使用以下方法检索传递给参数的值：

`cmd.Parameters(0).Value`

你的 SqlCommand 在哪里 cmd？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-19T02:41:44.110

这是亚当答案的 C# 版本

```
public string GenSQLCmd(string InSqlCmd, System.Data.Common.DbParameterCollection p) {
    foreach (System.Data.Common.DbParameter x in p) {
        InSqlCmd = InSqlCmd.Replace(x.ParameterName, "'" + x.Value.ToString() + "'");
    }
    return InSqlCmd;
} 
```

用法：

```
string DebugQuery = GenSQLCmd(cmd.CommandText, cmd.Parameters); //cmd is a SqlCommand instance 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-28T21:46:45.350

是的，您可以查看该信息，但您需要为此进行一些编码。

1.  创建一个名为**ToSqlStatement的扩展方法**

```
 public static class SqlExtensions
    {
        public static string ToSqlStatement(this IDbCommand cmd)
        {
            var keyValue = new List<string>();
            foreach (SqlParameter param in cmd.Parameters)
            {
                var value = param.Value == null ? "NULL" : "'" + param.Value + "'";
                keyValue.Add($"{param.ParameterName}={value}");
            }
            return $"{(cmd.CommandType == CommandType.StoredProcedure ? "exec " : string.Empty)}{cmd.CommandText} {string.Join(", ", keyValue)}";
        }
    } 
```

2.  将**OnSelecting**事件处理程序添加到页面上的 SqlDataSource 控件
3.  在你的代码后面

```
 protected void sqlDataSource_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
    {
        MyLogger.WriteLine(e.Command.ToSqlStatement());
    } 
```

# linq - linq to Db4O 查询的条件子句？

> ID：689732
> 
> 赞同：0
> 
> 时间：2009-03-27T13:18:32.310
> 
> 标签：linq, db4o

在 linq to sql 中，我可以这样做：

```
var q = db.Colors;
if(! string.IsNullOrEmpty(colorName))
   q = q.Where(c=>c.Name.Equals(colorName));
return q.ToList(); 
```

在 Db4O linq 中我不能这样做，因为我必须从

```
var q = (from Color c in db
         select c);
if(! string.IsNullOrEmpty(colorName))
   q = q.Where(c=>c.Name.Equals(colorName));
return q.ToList(); 
```

这导致

1.  所有颜色的完整枚举
2.  按名称过滤。

这不是我想要的解决方案。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-31T06:37:35.857

这样的东西合适吗？

```
return (from Color c in db
       where !String.IsNullOrEmpty(colorName) && c.Name.Equals(colorName)
       select c).ToList(); 
```

然后，您还可以使用多个参数：

```
return (from Color c in db
       where (!String.IsNullOrEmpty(colorName) && c.Name.Equals(colorName))
          || (!String.IsNullOrEmpty(color1Name) && c.Name.Equals(color1Name))
          || (!String.IsNullOrEmpty(color2Name) && c.Name.Equals(color2Name))
          ...
       select c).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:25:55.287

我不确定你在说什么。您是否担心在第一种情况下某些代码会在服务器端执行，以便您优化返回的值。但是在第二种情况下，枚举是在本地完成的，所以对使用的值没有优化？

如果是这样，则无法使用 LINQ to Objects 来避免这种情况。对象在内存中，因此无法避免枚举它们以进行过滤操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T15:37:53.987

如果你拆分表达式怎么办：

```
IDb4oLinqQuery<Color> q;
if(! string.IsNullOrEmpty(colorName))
{
  q = from Color c in db
      where c.Name.Equals(colorName)
      select c;
}
else
{
  q = from Color c in db
      select c;
}
return q.ToList(); 
```

这样 Db4O 预处理器会看到 2 个不同的 LINQ 查询？缺点当然是这个解决方案更加冗长而且不完全干燥..

# php - 使用 PHP 将二进制数据插入 SQL Server

> ID：689735
> 
> 赞同：6
> 
> 时间：2009-03-27T13:19:49.717
> 
> 标签：php, sql-server, odbc

我在 SQL Server 2005 数据库中有一个 varbinary(MAX) 字段。我试图弄清楚如何使用 PHP 将二进制数据（即图像）插入该字段。我正在使用 ODBC 连接到 SQL Server 数据库。我已经看到了许多解释这个用于 MySql 数据库的示例，但我无法让它与 SQL Server 一起使用。谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-04-04T03:37:48.633

```
function prepareImageDBString($filepath)
{
    $out = 'null';
    $handle = @fopen($filepath, 'rb');
    if ($handle)
    {
        $content = @fread($handle, filesize($filepath));
        $content = bin2hex($content);
        @fclose($handle);
        $out = "0x".$content;
    }
    return $out;
} 
```

用法：

```
$out = prepareImageDBString('/img/myimg.png');
mssql_query("INSERT INTO MyTable(MyImage) VALUES($out) "); 
```

MyImage 是类型为图像的 SQL Server 字段

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-08T07:48:28.047

我不会说这是一个不好的做法，这取决于图像有多大以及您的应用程序如何使用它。

如果文件大小低于 256K，则存储在 db 中效率更高；超过 1 mb，建议存储在文件系统中。

[Storing images in SQL Server?](https://stackoverflow.com/questions/5613898/storing-images-in-sql-server)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-03-27T17:24:08.663

简单的答案是：停止你正在做的事情。

除非您有一些非常具体的安全问题，否则您不想将二进制文件存储在数据库中。相反，您希望存储它们的文件名（可能重命名文件以防止冲突），然后将其存储在数据库中。如果安全是一个问题，则将它们放在非 Web 文件夹中并使用您的代码检索文件，并且仅在用户有权访问该文件时才提供该文件。

将图像或文件存储在数据库中是对文件空间的浪费，是对数据库的误用，并且不让事情做他们最擅长的事情；文件系统知道文件，数据库知道数据。

# ubuntu - 用于重置 Evolution 密码的 shell 脚本

> ID：689736
> 
> 赞同：1
> 
> 时间：2009-03-27T13:20:43.367
> 
> 标签：ubuntu

我在 Ubuntu 论坛上发布了以下问题，但尚未成功。我意识到这与其说是一个编程问题，不如说是一个 Evolution/Ubuntu 问题，但鉴于我想自动化解决方案，在这里发布它似乎并不合适......

这是问题所在。我最近更改了我的 Google 帐户密码，现在 Evolution（Ubuntu 邮件客户端）无法再连接到 Google 通讯录……而且似乎无法通过 Evolution GUI 重置它。删除和重新添加通讯簿不起作用，取消选中我的 Google 邮件帐户的发送/接收选项卡中的“记住密码”复选框也不会重置 Google 通讯簿密码（这是一个很长的镜头，并没有真正使反正感觉）。

我想编写一个脚本——尽管是一个专门的脚本——当用户更改他们的谷歌密码时，它可以在 Evolution 中解决这个问题。关于这个脚本如何工作的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T22:39:49.283

Evolution 将其密码保存在 gnome-keyring 中

应用程序 > 附件 > 密码和加密密钥

从这里，转到密码选项卡，找到正确的密码条目，双击它，展开密码部分，然后单击“显示密码”并在此处更改密码。

# sql-server - 更改列：null 到 not null

> ID：689746
> 
> 赞同：1314
> 
> 时间：2009-03-27T13:24:29.177
> 
> 标签：sql-server, tsql, null, alter-table, alter-column

我有一个有几个可以为空的整数列的表。出于多种原因，这是不可取的，因此我希望将所有空值更新为 0，然后将这些列设置为`NOT NULL`. 除了将 null 更改为 之外`0`，还必须保留数据。

我正在寻找将列（调用它）更改为“ ”的*特定 SQL 语法*。假设数据已更新为不包含空值。`ColumnA``not null`

使用*SQL 服务器 2000*。

* * *

## 回答 #1

> 赞同：2133
> 
> 时间：2009-03-27T13:30:09.223

首先，使所有当前`NULL`值消失：

```
UPDATE [Table] SET [Column]=0 WHERE [Column] IS NULL 
```

然后，更新表定义以禁止“NULL”：

```
ALTER TABLE [Table] ALTER COLUMN [Column] INTEGER NOT NULL 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-06-15T20:45:23.720

我遇到了同样的问题，但是该字段过去默认为null，现在我想将其默认为0。这需要在mdb的解决方案之后再添加一行：

```
ALTER TABLE [Table] ADD CONSTRAINT [Constraint] DEFAULT 0 FOR [Column]; 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-03-27T13:34:29.637

您必须分两步完成：

1.  更新表，使列中没有空值。

```
UPDATE MyTable SET MyNullableColumn = 0
WHERE MyNullableColumn IS NULL 
```

2.  更改表以更改列的属性

```
ALTER TABLE MyTable
ALTER COLUMN MyNullableColumn MyNullableColumnDatatype NOT NULL 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-09-17T21:13:23.727

对于 Oracle 11g，我可以按如下方式更改列属性：

```
ALTER TABLE tablename MODIFY columnname datatype NOT NULL; 
```

否则，阿巴蒂切夫的回答似乎不错。您不能重复更改 - 它抱怨（至少在 SQL Developer 中）该列已经不为空。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-06-05T13:00:20.240

这对我有用：

```
ALTER TABLE [Table] 
Alter COLUMN [Column] VARCHAR(50) not null; 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-03-27T13:26:39.687

只要列不是唯一标识符

```
UPDATE table set columnName = 0 where columnName is null 
```

然后

更改表并将字段设置为非 null 并指定默认值 0

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-11-27T17:13:41.450

万一`FOREIGN KEY CONSTRAINT`……如果主键表的列中不存在“0”，则会出现问题。解决方案是...

**第1步：**

使用此代码禁用所有约束：

```
EXEC sp_msforeachtable "ALTER TABLE ? NOCHECK CONSTRAINT all" 
```

**第2步：**

```
RUN UPDATE COMMAND (as mentioned in above comments)
RUN ALTER COMMAND (as mentioned in above comments) 
```

**第三步：**

使用此代码启用所有约束：

```
exec sp_msforeachtable @command1="print '?'", @command2="ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all" 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-03-04T07:55:36.317

这似乎更简单，但仅适用于 Oracle：

```
ALTER TABLE [Table] 
ALTER [Column] NUMBER DEFAULT 0 NOT NULL; 
```

此外，有了这个，您还可以添加列，而不仅仅是更改它。在本例中，如果值为 null，它会更新为默认值 (0)。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-01-26T19:39:31.710

就我而言，我在发布答案时遇到了困难。我最终使用了以下内容：

```
ALTER TABLE table_name CHANGE COLUMN column_name column_name VARCHAR(200) NOT NULL DEFAULT ''; 
```

更改`VARCHAR(200)`为您的数据类型，并可选择更改默认值。

如果您没有默认值，则在进行此更改时会遇到问题，因为默认值为 null 会产生冲突。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-12-15T03:14:40.910

使列不为空并添加默认值也可以在 SSMS GUI 中完成。

1.  正如其他人已经说过的那样，在所有现有数据都为“非空”之前，您不能设置“非空”，如下所示：

`UPDATE myTable SET myColumn = 0`

2.  完成后，在设计视图中使用表（右键单击表并单击“设计视图”），您可以取消选中*Allow Nulls*列，如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/FYGpD.png)](https://i.stack.imgur.com/FYGpD.png)

3.  仍然在选择列的设计视图中，您可以在下面的窗口中看到 *列属性*，并将默认设置为 0，如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/nX9qS.png)](https://i.stack.imgur.com/nX9qS.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-26T11:58:51.410

举个例子：

```
TABLE NAME=EMPLOYEE 
```

我想将列更改`EMPLOYEE_NAME`为`NOT NULL`. 此查询可用于以下任务：

```
ALTER TABLE EMPLOYEE MODIFY EMPLOYEE.EMPLOYEE_NAME datatype NOT NULL; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-13T00:45:53.163

对于 JDK 中包含的内置 javaDB（Oracle 支持的 Apache Derby 发行版），以下内容对我有用

```
alter table [table name] alter column [column name] not null; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-12T09:03:48.927

您可以使用以下 sql 更改现有 DB 列的定义。

```
ALTER TABLE mytable modify mycolumn datatype NOT NULL; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-30T20:51:19.117

1.  首先确保您更改为没有的列没有空值 select count(*) from table where column's_name is null

2.  估算缺失值。您可以用空字符串或 0 或平均值或中值或插值替换空值。这取决于您的回填策略或前向填充策略。

3.  决定列值是唯一的还是非唯一的。如果它们需要唯一而不是添加唯一约束。否则，请查看性能是否足够或是否需要添加索引。

# asp.net - 通过 javascript 更改的隐藏字段不会在回发中持续存在

> ID：689758
> 
> 赞同：2
> 
> 时间：2009-03-27T13:27:10.887
> 
> 标签：asp.net, javascript, jquery, postback

我有一个带有隐藏字段的网络用户控件。当 javascript 事件（单击）发生时，我试图在隐藏字段中设置一个值，以便可以在回发时保留该值并记住下一次渲染。该控件是一个不会导致回发的可折叠面板扩展器，使用jquery，并且如果回发发生在页面的其他位置，它会记住它是展开还是折叠。

问题是 javascript 执行，但实际上并没有更改隐藏字段中的值。如果我使用dom explorer，隐藏的恶魔仍然设置为默认值，然后在我调试时，在下一次回发中，隐藏字段仍然设置为默认值。

我也尝试过使用久经考验的真实 getElementById ，但没有成功。

不会发生 javascript 错误。

> **ASCX 代码：**

```
<input id="hiddenCurrentState" type="hidden" runat="server" /> 
```

> **代码隐藏：**

```
using System;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text;

public partial class Controls_SubControls_CollapsiblePanelExtender : System.Web.UI.UserControl
{
    public string HeaderControlId { get; set; }

    public string BodyControlId { get; set; }

    public string CollapseAllControlId { get; set; }

    public string ShowAllControlId { get; set; }

    public CollapsedState DefaultState { get; set; }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            hiddenCurrentState.Value = DefaultState.ToString();
        }
    }

    protected override void OnPreRender(EventArgs e)
    {
        BuildJQueryScript();
        base.OnPreRender(e);
    }

    private void BuildJQueryScript()
    {
        StringBuilder script = new StringBuilder();

        script.Append("$(document).ready(function(){\n");

        //toggle based on current state
        script.Append("if ($(\"#" + hiddenCurrentState.ClientID + "\").attr(\"value\")==\"Expanded\")\n");
        script.Append("{\n");
        script.Append("$(\"#" + BodyControlId + "\").show();\n");
        script.Append("$(\"#" + hiddenCurrentState.ClientID + "\").val(\"Expanded\");\n");
        script.Append("}\n");
        script.Append("else\n");
        script.Append("{\n");
        script.Append("$(\"#" + BodyControlId + "\").hide();\n");
        script.Append("$(\"#" + hiddenCurrentState.ClientID + "\").val(\"Collapsed\");\n");
        script.Append("}\n");

        //toggle on click
        script.Append("$(\"#" + HeaderControlId + "\").click(function(){\n");
        script.Append("  $(this).next(\"#" + BodyControlId + "\").slideToggle(500)\n");
        script.Append("  return false;\n");
        script.Append("});\n");

        //collapse all
        if (!String.IsNullOrEmpty(CollapseAllControlId))
        {
            script.Append("$(\"#" + CollapseAllControlId + "\").click(function(){\n");
            script.Append("  $(\"#" + BodyControlId + "\").slideUp(500)\n");
            script.Append("  return false;\n");
            script.Append("});\n");
        }

        //show all
        if (!String.IsNullOrEmpty(ShowAllControlId))
        {
            script.Append("$(\"#" + ShowAllControlId + "\").click(function(){\n");
            script.Append("  $(this).hide()\n");
            script.Append("  $(\"#" + BodyControlId + "\").slideDown()\n");
            //script.Append("  $(\".message_list li:gt(4)\").slideDown()\n");
            script.Append("  return false;\n");
            script.Append("});\n");
        }

        script.Append("});\n");

        Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "CollapsiblePanelScript", script.ToString(), true);
    }
}

public enum CollapsedState
{
    Expanded = 0,
    Collapsed = 1
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T13:37:27.850

我看不到您在哪里设置客户端隐藏字段的值。我希望在您的折叠/显示函数中看到类似于以下内容的行，以在面板折叠/展开时实际更改客户端上的值。

坍塌：

```
 script.Append( "   $(\"#" + hiddenCurrentState.ClientID + "\").val(1);\n" ); 
```

节目：

```
 script.Append( "   $(\"#" + hiddenCurrentState.ClientID + "\").val(0);\n" ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T23:03:28.117

您是否尝试过使用`<asp:HiddenField>`而不是`<input>`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T04:12:33.673

在每次回发时，都会再次呈现整个页面，客户端更改的任何值都不会保留。

我建议您将状态存储在 cookie 中。在您使用`jQuery`时，[COOKIE](http://plugins.jquery.com/project/cookie "曲奇饼")库使这变得轻而易举。

# asp.net - ASP.NET 主题 - 应该使用它们吗？

> ID：689759
> 
> 赞同：28
> 
> 时间：2009-03-27T13:27:13.100
> 
> 标签：asp.net, themes

我一直在阅读我的 ASP.NET 书中的主题，并认为这可能是一个非常方便的解决方案，然后我遇到了一些问题。

*   主题选取文件夹中的每个 CSS 文件
*   如果您想使用重置样式（排序很重要），则不保证导入样式表的顺序
*   您的母版页不会明确指出正在使用什么样式，只有呈现的页面可以告诉您，除非您深入研究 web.config
*   使用主题文件设置 Web 控件样式是……嗯……愚蠢？您可以在样式表中简单地执行此操作。粒度控制应该在 HTML 级别，不是吗？
*   如何在一个样式表中没有所有样式的情况下指定打印样式表？

我想知道它们是否真的值得使用。有什么好处吗？有没有使用它们的主要网站？

**编辑**

只是为了澄清 slolife 的最后一点。如果我有两个样式表，一个叫做 print.css，一个叫做 main.css，并且我使用 ASP.NET 主题，它怎么知道 print.css 是一个打印样式表？在常规 HTML 中，您在标签本身（即`<link rel= ...>`）中使用媒体类型，但主题不会知道这一点，因此它只会作为常规样式表包含在内。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T17:25:22.270

我喜欢使用主题，但正如 Raj 在他的回答中指出的那样，URL 重写可能会导致问题。我寻找一些解决方案是我提出你的问题的原因。但无论如何我都会添加我的意见。

我将从上面讨论您的一些要点，说明为什么我认为主题很好：

*- 主题选取文件夹中的每一个 CSS 文件*

我猜您希望仅将某些样式表文件应用于某些页面。是的，主题在这里采用霰弹枪方法，所以这是一个问题。但是您不必将所有样式表都放在主题文件夹中。把你的专业的放在外面，它们不会自动被包括在内。但我认为自动包含通用/站点范围的功能是一个不错的功能。

*- 如果您想使用重置样式（排序很重要），则不保证导入样式表的顺序*

我认为您可以通过命名文件的方式来保证顺序，因此它们是按数字和字母顺序排列的。也许不是一个优雅的解决方案，但并不可怕。

就个人而言，我有一个构建步骤，它将我的主题文件夹中的所有 *.css 文件组合并压缩到一个单独的 style.css 文件中，并且由于我控制了该构建步骤和文件组合的顺序，所以这不会影响我。

*- 您的母版页不会明确指出正在使用的样式，只有呈现的页面可以告诉您，除非您深入了解您的 web.config*

您可以通过代码和 <%@Page 指令更改主题

*- 使用主题文件设置 Web 控件样式是……嗯……愚蠢？您可以在样式表中简单地执行此操作。粒度控制应该在 HTML 级别，不是吗？*

我同意通过主题将样式属性应用于控件似乎不是最佳实践。但我喜欢这样一个事实，即我可以在主题的皮肤文件中定义图像皮肤，而不必剪切和粘贴我在整个站点中使用很多地方的常见图像的 Width、Height、AlternativeText、Align 属性。如果我改变了其中一张图像，我可以在一个地方修复属性，而不是全部修复。我还可以创建应用了特定 css 类列表的蒙皮控件，这对我来说似乎很方便。

*- 如何指定打印样式表而不在单个样式表中包含所有样式？*

我有一个以@media print 开头的 Print.css 文件，它为我的网站定义了打印样式。为什么需要将它们放在一个样式表中？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T14:56:49.937

IMHO, asp.net themes are absolutely USELESS

try implementing url rewriting with an app which uses themes and see them break straight away

basically, you can achieve the same thing writing few lines of code in asp.net and multiple css folders. i am yet to come across any developer / company who has been using themes

when asp.net 2.0 was launched, there was a big hype around themes but my personal opinion is its simply not worth it :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-03T02:31:55.227

仅使用主题更改控件属性。它们不适合使用 css。

# css - 这对您来说似乎是一个 IE8 浮动错误吗？

> ID：689763
> 
> 赞同：1
> 
> 时间：2009-03-27T13:28:23.457
> 
> 标签：css, internet-explorer, layout, internet-explorer-8

使用 IE8 时，我注意到两个不同站点的奇怪行为。

第一个站点位于我维护[xebra.com](http://www.xebra.com/)的站点中。

第二个网站是谷歌分析。

行为是当地址直接输入到 IE8 的地址栏中时，两个站点都正确显示，

但是，当其中一个站点已经加载，并且您按下刷新按钮或 F5 键时，布局就会变得一团糟：

在此处查看屏幕截图：[此处](http://www.ozoneasylum.com/30923?mode=0&latestPost=true#latestPost)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T13:37:57.990

某些原因导致 IE8 以“怪癖模式”呈现，从而导致损坏。

您可以通过在 IE8 中浏览到您的站点并选择工具 > 开发人员工具 > 文档模式 > 怪癖模式来复制它。

确保您的文档始终以标准模式提供。

**编辑**我原来的答案是“兼容性模式”，应该是“怪癖模式”——两者是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T22:37:27.757

JS.Companion 是导致这个奇怪错误的原因，而不是 IE8。呸！

[http://www.my-debugbar.com/wiki/CompanionJS/HomePage](http://www.my-debugbar.com/wiki/CompanionJS/HomePage)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T11:46:57.403

我整个上午都在试图弄清楚发生了什么，我删除了companion.js，然后我的网站就完美了！谢谢你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T08:46:29.803

这真的很奇怪。我的计算机上安装了 Companion.JS 和[http://www.xebra.com/](http://www.xebra.com/)网页（在 Vista SP1 下）没有问题。

如果您能提供有关该问题的更多信息，我将很乐意更正产生此问题的 Companion.JS 错误。

# colors - 如何更改 zsh 中提示的颜色（不同于普通文本）？

> ID：689765
> 
> 赞同：175
> 
> 时间：2009-03-27T13:29:30.317
> 
> 标签：colors, zsh, prompt

为了更好地识别命令行输出的开始和结束，我想更改提示的颜色，使其与程序输出明显不同。当我使用zsh时，任何人都可以给我一个提示吗？

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2010-03-28T21:37:49.020

把这个放在`~/.zshrc`：

```
autoload -U colors && colors
PS1="%{$fg[red]%}%n%{$reset_color%}@%{$fg[blue]%}%m %{$fg[yellow]%}%~ %{$reset_color%}%% " 
```

支持的颜色：
`red`, `blue`, `green`, `cyan`, `yellow`, `magenta`, `black`, & `white`（来自[这个答案](https://stackoverflow.com/questions/6159856/how-do-zsh-ansi-colour-codes-work)）虽然不同的计算机可能有不同的有效选项。

用 .环绕颜色代码（和任何其他不可打印的字符）`%{....%}`。这是为了使文本换行正常工作。

此外，这里是你如何让它与来自[这里](https://unix.stackexchange.com/a/273567/3268)的目录修剪一起工作。

```
PS1="%{$fg[red]%}%n%{$reset_color%}@%{$fg[blue]%}%m %{$fg[yellow]%}%(5~|%-1~/.../%3~|%4~) %{$reset_color%}%% " 
```

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2010-12-21T00:32:19.847

Zsh 带有内置的彩色提示。尝试

```
autoload -U promptinit && promptinit 
```

然后`prompt -l`列出可用的提示，`-p fire`预览“fire”提示，`-s fire`设置它。

当您准备好添加提示时，在上面的自动加载行下方添加如下内容：

```
prompt fade red 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-03-27T13:41:04.223

以下是如何设置红色提示的示例：

```
PS1=$'\e[0;31m$ \e[0m' 
```

神奇的是`\e[0;31m`（打开红色前景）和`\e[0m`（关闭字符属性）。这些被称为转义序列。不同的转义序列为您提供不同的结果，从绝对光标定位到颜色，再到能够更改窗口的标题栏等等。

有关转义序列的更多信息，请参阅[关于 ANSI 转义码的维基百科条目](http://en.wikipedia.org/wiki/ANSI_escape_code)

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2019-10-25T17:52:34.713

上面 Bryan Oakley 的答案有一个小故障，正如已经指出的那样，而 Andrew Marshall 提供的解决方案虽然没有出现故障，但是对于所使用的颜色进行过多的定制，它并不明显。

由于 macOS Catalina 从现在开始要求 zsh 成为默认 shell，我想更多的人可能想要自定义他们的提示，并且可能会来这里寻求答案。所以，我想我会尝试给出一个更广泛的总结，并触及其他密切相关的概念，这些概念允许更多的定制。

**各种颜色的 3 位代码。** 首先，在这里我们可以找到各种颜色的 3 位数代码：[https](https://unix.stackexchange.com/a/124409/194343) ://unix.stackexchange.com/a/124409/194343 。例如，214 是某种橙色。

**前景和背景。** 另一个关键信息是，对于**F**前景色和后**K底色，可以分别用****F**和**K**定义他们想要的颜色。来源是 zsh 视觉效果手册：http: [//zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html#Visual-effects](http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html#Visual-effects)

因此，例如，以下两个命令

```
autoload -U colors && colors
export PS1="%F{214}%K{000}%m%F{015}%K{000}:%F{039}%K{000}%~%F{015}%K{000}\$ " 
```

用黑色背景的橙色显示主机名，然后是黑色背景的白色冒号，然后是黑色背景的亮蓝色当前工作目录，然后是黑色背景的白色美元符号。

更多相关信息见下文。

**右侧的提示信息。**例如，添加时间戳。请参阅[https://superuser.com/a/1251045/290299](https://superuser.com/a/1251045/290299)。当然，这可以用颜色编码，例如一些浅蓝色/紫色，像这样：

```
RPROMPT="%F{111}%K{000}[%D{%f/%m/%y}|%@]" 
```

**的颜色`ls`。**阅读 ls 的手册后，例如可以`ls`使用以下两个命令激活颜色：

```
export CLICOLOR=1
export LSCOLORS=gafacadabaegedabagacad 
```

最后，作为我没有测试的最后一句话，因为我对我的配置很满意，另一种途径可能是让某人`coreutils`从[MacPorts](https://www.macports.org)安装端口然后使用`gdircolors`（来源：[https ://unix.stackexchange.com/a/174596 /194343](https://unix.stackexchange.com/a/174596/194343)）。（我可能会在未来编辑这最后一部分，因为以上所有内容都是相关的，让日常生活变得更加有趣和更容易应对。）

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2011-04-08T07:54:26.273

我认为`autoload -U colors && colors`不再需要了，可以简单地做：

```
PS1="%{%F{red}%}%n%{%f%}@%{%F{blue}%}%m %{%F{yellow}%}%~ %{$%f%}%% " 
```

达到与[FireDude 的回答](https://stackoverflow.com/questions/689765/how-can-i-change-the-color-of-my-prompt-in-zsh-different-from-normal-text#2534676)相同的结果。有关详细信息，请参阅[ZSH 文档](http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html#SEC59)。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2020-04-11T07:54:36.707

试试我最喜欢的：放入

```
~/.zshrc 
```

这一行：

```
PROMPT='%F{240}%n%F{red}@%F{green}%m:%F{141}%d$ %F{reset}' 
```

不要忘记

```
source ~/.zshrc 
```

测试更改

您当然可以更改颜色/颜色代码:-)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2021-01-10T08:22:14.720

为了不浪费终端中带有特殊字符的信息片段的空间，您可以使用多种颜色来区分信息。

例如。为了获得这种预期的效果：

[![期望的结果](https://i.stack.imgur.com/viu5V.png)](https://i.stack.imgur.com/viu5V.png)

您可以对提示执行以下操作：

```
PROMPT='%F{magenta}${PWD/#$HOME/~} %F{green}${vcs_info_msg_0_} %F{cyan}$%F{reset_color} ' 
```

它的工作方式是每次您使用`$F{myColor}`从该点开始的颜色设置颜色时都会坚持使用该颜色。最后添加很重要，`%{reset_color}`这样输入文本才能恢复到原始颜色（或者如果您愿意，可以将其设置为其他颜色）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-29T10:30:51.673

我发现，使用 zsh5（Debian Jessie 上的默认选项），所有这些解决方案都有效：

*   `$'\e[00m`
*   `$fg[white]`
*   `$fg{white}`

现在，他们遇到了一个问题：他们会移动光标，从而在 Tab 键时产生丑陋的贴花（用于自动完成）。解决方案是简单地将转义序列用`%{FOOBAR%}`. 我花了一段时间才弄清楚这一点。对于第 2 和第 3 解决方案，加载`colors`模块是强制性的。为了保持第一个解决方案的可读性，只需为您使用的颜色定义变量。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-10-13T16:27:22.047

要根据最后一个命令的退出状态获得带有颜色的提示，您可以使用以下命令：

```
PS1='%(?.%F{green}.%F{red})%n@%m:%~%# %f' 
```

只需将此行添加到您的`~/.zshrc`.

[文档](http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html)列出了可能的占位符。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-02-26T17:18:41.727

为了补充上述所有答案，另一个方便的技巧是将彩色提示设置放入 zsh 函数中。在那里你可以定义局部变量来给更长的命令起别名，例如`rc=$reset_color`或者定义你自己的颜色变量。不要忘记将它放入您的`.zshrc`文件并调用您定义的函数：

```
# Coloured prompt
autoload -U colors && colors
function myprompt {
  local rc=$reset_color
  export PS1="%F{cyan}%n%{$rc%}@%F{green}%m%{$rc%}:%F{magenta}%~%{$rc%}%# "
}
myprompt 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-08-16T05:33:21.757

**Debian/Ubuntu/Raspberry Pi OS 风格的 bash 提示符：**

```
autoload -U colors && colors
PS1="%B%F{034}%n@%m%f%b:%B%F{019}%~ %#%f%b " 
```

[![截屏](https://i.stack.imgur.com/7VFNT.png)](https://i.stack.imgur.com/7VFNT.png)

不完全确定是否`autoload -U colors && colors`有必要，但当我使用`$fg[...]`而不是`%F{...}`.
在我的例子中；

*   %F(%f) 开始（停止）前景色 - 我使用了 256COLOR 值，但你也可以使用十六进制，例如，我使用普通绿色`%F{034}`，但`%F{#00aa00}`也可以
*   %B(%b) 开始（停止）粗体
*   %n $用户名
*   %m 短机器名
*   %~ 如果在主目录中，则使用 ~ 登录/工作目录
*   %# 如果是普通用户则显示 % 或 # 如果是 su

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-07-17T16:02:58.643

man zshall 并搜索 PROMPT EXPANSION

在阅读了此处的现有答案后，其中有几个是相互矛盾的。我在运行 zsh 4.2 和 5+ 的系统上尝试了各种方法，发现这些答案相互矛盾的原因是他们没有说明他们针对的是哪个版本的 ZSH。不同的版本为此使用不同的语法，其中一些需要各种自动加载。

因此，最好的选择可能是 man zshall 并搜索 PROMPT EXPANSION 以找出您特定 zsh 安装的所有规则。请注意评论中的“我使用 Ubuntu 11.04 或 10.4 或 OSX”之类的内容并不是很有意义，因为不清楚您使用的是哪个版本的 ZSH。Ubuntu 11.04 并不意味着比 ubuntu 10.04 更新版本的 ZSH。安装旧版本可能有多种原因。就此而言，较新版本的 ZSH 并不意味着在不知道它是哪个版本的 ZSH 的情况下使用哪种语法。

# c# - 带有 XML 数据库字段的 Linq-to-SQL —— 为什么会这样？

> ID：689772
> 
> 赞同：10
> 
> 时间：2009-03-27T13:31:27.397
> 
> 标签：c#, xml, linq-to-sql, .net-3.5

一些背景知识：我有一个数据库，我想使用 linq-to-sql 通过 C# 应用程序进行更新。此表中的一列具有 XML 数据类型。

该表中的所有其他列（不是 XML 数据类型）都更新得很好，但是当我对 XML 字段进行更改时，程序（看似）正确执行，但在我之后该字段始终保留其原始值运行`SubmitChanges()`。

我环顾互联网，发现一些关于 Microsoft Connect 诊断类似问题的帖子，最后在[这里](https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=360433)偶然发现了解决方案：

要强制 XML 字段更新，这不会：

```
XElement tmp = MyLinqObject.XmlField;
MyLinqObject.XmlField = null;
MyLinqObject.XmlField = tmp; 
```

而不是强制 LINQ 更新 XML 列分配一个克隆对象：

```
MyLinqObject.XmlField = new XElement (MyLinqObject.XmlField); 
```

我可以确认这似乎确实有效，但我不确定为什么。我唯一的猜测是 XmlField 属性在堆上有某种唯一标识符，通过克隆，您已经为其分配了一个新的唯一标识符。当 Linq 然后生成查询时，它甚至不会尝试查看该字段是否已更新，因为它有一个新的 id，它只是将值写入数据库。但是，我只是推测并希望其他人可以更好地了解幕后发生的事情。

**编辑**：为了解决 Jon 的帖子，问题的原因（正如 MS Connect 站点上所解释的那样）是“XML 字段没有更新，因为 Linq-to-SQL 不处理 XElement.Changed 事件”。

对于我的实现，有效的代码最终看起来像这样：

```
MyXElementProperty.SetElementValue("Author", author);

MyXElementProperty = new XElement(MyXElementProperty); 
```

供参考（给发现此问题的任何其他人），以下内容也适用：

```
MyXElementProperty = new XElement(MyXElementProperty);

MyXElementProperty.SetElementValue("Author", author); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-27T13:35:20.897

当你把它变成 new`XElement`时，你正在制作一个不同的对象。有可能使用引用相等来检测“陈旧”，这显然会将其视为一个新值。

At what point are you actually making changes to the element? I would *expect* LINQ to SQL to have a cached copy of the original value, and then compare that with the new value. If it's taking that "cached copy" by just copying the reference, then whatever you do to that object, it will always think the two are equal. If instead you create a *new* element, and then change *that*, then the old object will still have the old value, so the comparison will understand that you've made changes. Does that make sense?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-22T21:07:07.703

This was a very 'different' workaround, I spent a while trying to figure out why the XML field on the database, was not uploading. The New XElement(updatedXElement) worked for me also!

# objective-c - Objective C 类定义混淆

> ID：689775
> 
> 赞同：5
> 
> 时间：2009-03-27T13:32:56.690
> 
> 标签：objective-c, cocoa, object

我正在通过 Cocoa 学习 Objective-C（并且喜欢它）。我正在关注一个教程。有一个名为 Menu 的类，界面看起来像这样。

```
@interface Menu: MenuObject {}
@end

@interface MenuLayer : LayerObject {}
-(void) someMethod:(id)sender
-(void) someOtherMethod:(id)sender
@end 
```

并且实现遵循相同的约定

```
@implementation Menu
    -(id)init{
        // blah blah blah
    }
@end

@implementation MenuLayer
    // init, someMethod and someOtherMethod stuff here
@end 
```

对我来说，这看起来像是在同一个文件中定义和实现的两个单独的对象/类。这样做有理由吗？如果我将 .h 和 .m 文件拆分为 Menu.h/.m 和 MenuLayer.h/.m ，结果会相同吗？还是我误解了一些基本的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T13:44:53.120

如果将它们拆分为单独的文件应该没问题。大多数时候，当您看到以这种方式实现的事情时，仅仅是因为这两个类紧密耦合在一起，以至于您真的永远不会在没有另一个的情况下使用其中一个。

所以，这真的只是一种风格。它们都在同一个文件中定义和实现这一事实没有“魔法”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T13:46:40.760

这只是个人喜好问题。您应该能够将它们分开，只要您`#import`在必要时将其中一个标题与另一个标题分开即可。Objective-C 只是让您可以选择将类组合在文件中，而不是 Java 强制您将它们拆分。如果这些类密切相关，则可以更容易地在一个文件中查看整个事物的工作方式，而不必在多个文件之间切换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T13:47:33.270

你的评估是正确的。正在声明和定义两个单独的类。

这样做的可能原因是这两个类都是必需的，以便执行它所做的任何事情`Menu`。将这两个类放在同一个标​​头和源代码中只会使接口更加紧凑。

将其拆分为两个文件仍然有效。

# java - Eclipse JavaEditor 扩展：如何添加正确缩进的行？

> ID：689777
> 
> 赞同：0
> 
> 时间：2009-03-27T13:33:26.190
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, eclipse-3.4

## 需要什么？

我们正在编写eclipse 的 JavaEditor[的扩展。](http://vrapper.sf.net)我们需要一种在光标所在行之前和之后添加一行的方法。

新行上的光标应该在正确的位置（正确地插入）。

## 示例（# 是光标）：

( `I`) 之前：

```
public class Test {
    public static void main#(String[] args) {
        System.out.println("Test!");
    }
} 
```

通缉后（`II`）：

```
public class Test {
    #
    public static void main(String[] args) {
        System.out.println("Test!");
    } 
```

在不想要之后（也就是现在的状态）（`III`）：

```
public class Test {
#
    public static void main(String[] args) {
        System.out.println("Test!");
    } 
```

## 现状：

从`I`to的转换`III`可以通过`IDocument.replace()`, an`InsertEdit`或 via`IDocumentExtension4`的 rewriteSessions 来完成。

问题是如何在从扩展中插入新行后调用 JavaEditor 的缩进函数。或者甚至可以直接缩进正确的行（`I`到`II`）？（缩进的长度**不**应该总是当前行的长度，而是正确的。`internal`如果可能，不应使用包，否则`IndentUtil`将是解决方案。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T19:39:05.843

一种解决方案似乎是不使用`IDocument.replace()`，例如

```
myTextViewer.getDocument().replace(...) 
```

但是`insert()`，例如

```
textViewer.getTextWidget().insert(...) 
```

这可行，但还不是一个完整的解决方案，可以调用 indent 函数而不生成对`org.eclipse.jdt`:-( 的依赖关系。这仍然是需要的。

# operating-system - 程序阶段的高级描述

> ID：689778
> 
> 赞同：1
> 
> 时间：2009-03-27T13:33:43.553
> 
> 标签：operating-system

我试图对程序生命周期中从源代码到执行的不同阶段进行高级描述。

* * *

### 要点：

1.  预处理：在此阶段处理宏、包含文件和编译器指令。
2.  编译：源文件编译成obj文件
3.  链接器：不同的 obj 文件链接到单个可执行文件。在这个阶段，虚拟地址被分配给可执行文件中的函数、变量和数据。对于 32 位机器，每个进程有 4GB 的地址空间。1-2 GB 是为操作系统保留的。所以 2-3 GB 的地址空间可以分配给任何进程。
4.  执行：在程序执行期间，加载程序进入画面。它基本上将程序从虚拟地址空间加载到物理内存地址。因此，当进程开始执行时，操作系统会为进程分配内存并调用其主函数。

* * *

### 问题：

1.  如果程序二进制图像大小为 2MB，那么是否必须将完整的二进制图像加载到物理内存中才能执行程序？我的理解是程序必须完全加载到物理内存中才能执行。不可能在具有 256 MB 物理内存的机器上运行大小为 512MB 的程序。只有当程序的内存需求增长时，虚拟内存和分页才有帮助。

2.  当程序请求更多内存时，即当它使用 new/malloc 分配堆内存时，内存将保留在虚拟地址空间中。在被引用之前它不会被提交。

* * *

请指出您认为我的理解有误的地方。
是否有任何文章或博客可以给我一两页的整个过程的高级描述？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-03T17:16:09.443

DLL 和可执行文件是使用内存映射文件加载的，因此它们实际上并未复制到 RAM，它们仍在磁盘上，只是将它们的字节映射到进程的虚拟地址空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:39:39.233

> 1）因此，如果程序二进制图像大小为 2MB ，那么是否必须将完整的二进制图像加载到物理内存中才能执行程序？根据我的理解，程序必须完全加载到物理内存中才能执行。不可能在具有 256 MB 物理内存的机器上运行大小为 512MB 的程序。只有当程序的内存需求增长时，虚拟内存和分页才有帮助。

不，大多数（全部？）现代操作系统按需加载页面。如果一个页面未被使用，它将不会被加载。

> 2) 当程序要求更多内存时，即当它使用 new/malloc 分配堆内存时，内存被保留在虚拟地址空间中。在被引用之前它不会被提交。

不一定——运行时可以预先请求一大块并立即提交它，然后分配提交的内存。我不知道实际执行此操作的任何内容，但整个区域都取决于实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T13:41:13.037

在第 4 项下，我认为您可能会错过将程序从某些物理存储（例如磁盘或服务器）复制到操作系统内存的位置。这与您所说的不太一样，因为在我看来，物理和虚拟内存是操作系统的一部分。

关于第一个疑问，我认为不一定。考虑一下如果我开始运行一个游戏，它会花费一个初始时间来加载属于同一个可执行文件的一部分的文件，因此会运行一些东西来告诉 O/S 加载文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T13:50:14.513

对我来说，这看起来与语言无关，因为许多语言没有与预处理阶段相对应的任何内容。但是，它一开始是相当准确的。

您似乎将虚拟地址空间与磁盘文件存储混淆了。实际上，它是物理内存的附属物，工作方式相同（性能除外）。它使用磁盘，但与使用文件的方式不同。

你知道物理内存是如何工作的。虚拟内存是一种以通常透明的方式伪造更大内存的方法。文件被分成“页”，页根据需要从磁盘中读入。物理内存被划分为“页框”，物理内存地址与它当前代表的虚拟地址没有任何关系。显然，如果程序使用的内存超过了物理可用的内存，则必须重用页框，因此必须将页框的内容写回（如果从读取时更改），并加载新的页面。

如果程序一次只使用其地址空间的一部分（“工作集”），并且该部分的页面足够少，因此它们可以同时位于物理内存中，那么这很有效。如果它不断地引用超出物理内存容量的页面，则必须不断地从磁盘读取页面（“抖动”），性能急剧下降，并且磁盘处于持续负载状态。

因此，当我编译和链接一个程序时，磁盘上的文件系统中有一个可执行文件。当我执行它时，它被分配了一个地址空间，然后它变得更加复杂。实际上，它被加载到内存中，多少物理内存和多少虚拟内存与用户无关（除非它没有足够的物理内存，它会运行得非常慢）。

因此，可以用 256M 的物理内存运行一个 512M 的程序。

当从堆请求内存时，它被分配到内存位置。至少 C 和 C++ 标准要求它是可用的，除非请求失败，所以“提交”在我看来是一个奇怪的词选择。在使用之前，它不必位于物理内存中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T14:03:09.347

第 2 点不完整。编译器生成组装成二进制文件的程序集。

第 3 点是错误的。内核虚拟内存空间保留与链接器无关。内核空间取决于操作系统。在 Windows 中，它甚至是可配置的（臭名昭著的 /3GB 开关）。

第4点是错误的。可执行映像映射到虚拟内存。它本身实际上并没有“加载”。

您的问题的答案：

1.  程序被映射到虚拟内存，而不是物理内存。然后，虚拟内存管理器 (VMM) 负责确保内存在需要时位于物理内存中。
2.  new/alloc 请求堆内存。堆是对虚拟内存的抽象，以最小化内存分配可能产生的内核切换量。如果堆太小而不能满足分配请求，堆就会增长，导致虚拟内存分配。由堆管理器决定提交一个页面。

# asp.net-mvc - 如何更改 HTML.Label 的样式属性？

> ID：689785
> 
> 赞同：1
> 
> 时间：2009-03-27T13:34:52.287
> 
> 标签：asp.net-mvc

我在 asp.net 中使用 MVC。

我想更改 html.label 控件的字体大小和颜色。

那么我怎样才能使这个助手类呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T13:46:12.307

这是我进行此类扩展的代码。请注意，ParameterDictionary 是我自己的类。我认为 MVC 扩展使用 RouteValueDictionary 代替，但依赖它对我来说似乎是错误的，所以我为此特定目的创建了自己的类。您需要将包含 HtmlExtensions 类的命名空间导入到要使用这些扩展的视图中（如果不在您的 Web 项目中，则添加对包含该类的项目的引用）。

```
public static class HtmlExtensions
{
    public static string Label( this HtmlHelper helper,
                                string labelFor,
                                string value,
                                object htmlAttributes )
    {
        TagBuilder labelBuilder = new TagBuilder( "label" );
        if (!string.IsNullOrEmpty( labelFor ))
        {
            labelBuilder.Attributes.Add( "for", labelFor );
        }
        labelBuilder.MergeAttributes( new ParameterDictionary( htmlAttributes ) );
        labelBuilder.SetInnerText( value );
        return labelBuilder.ToString( TagRenderMode.Normal );
    }    
} 
```

用法：

```
<%= Html.Label( "Name", new { @class = "input-label" } ) %>
<%= Html.TextBox( "Name" ) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T13:46:42.837

难道你不只是在标记中这样做（样式/ css）：

```
<label for="Name" ***here***>Name:</label> 
```

# sql-server - SQL Server 2008 将 VARCHAR(50) 转换为 Uniqueidentifier

> ID：689802
> 
> 赞同：3
> 
> 时间：2009-03-27T13:40:40.807
> 
> 标签：sql-server, tsql, sql-server-2008, type-conversion, uniqueidentifier

我正在尝试将 varchar(50) 列转换为唯一标识符，但此错误一直弹出，我不知道为什么：

```
"Msg 8169, Level 16, State 2, Line 1 Conversion failed when converting from a character string to uniqueidentifier." 
```

列中的数据当前是有效的唯一标识符。

做我想做的事的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T13:43:07.493

您是否有任何包含空字符串的列？即NOT NULL，字符串长度= 0。

或者您是否有任何带有非标准字符的 GUID？即不是0-9，AF？

我的应用程序中有一些非标准的 GUID，这些 GUID 是在我继承它之前创建的......

编辑：

为了将来的帮助，此脚本可以帮助您找到任何无效的行：

```
SELECT    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(GUID, '1', '0'), '2', '0'), '3', '0'), '4', '0'), '5', '0'), '6', '0'), '7', '0'), '8', '0'), '9', '0'), 'A', '0'), 'B', '0'), 'C', '0'), 'D', '0'), 'E', '0'), 'F', '0'), COUNT(*)
FROM TABLE
GROUP BY REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(GUID, '1', '0'), '2', '0'), '3', '0'), '4', '0'), '5', '0'), '6', '0'), '7', '0'), '8', '0'), '9', '0'), 'A', '0'), 'B', '0'), 'C', '0'), 'D', '0'), 'E', '0'), 'F', '0') 
```

任何具有无效 Guid 的行都会显示出来，并且可以通过以下方式找到：

```
SELECT    *, REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(GUID, '1', '0'), '2', '0'), '3', '0'), '4', '0'), '5', '0'), '6', '0'), '7', '0'), '8', '0'), '9', '0'), 'A', '0'), 'B', '0'), 'C', '0'), 'D', '0'), 'E', '0'), 'F', '0')
FROM TABLE
WHERE REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(GUID, '1', '0'), '2', '0'), '3', '0'), '4', '0'), '5', '0'), '6', '0'), '7', '0'), '8', '0'), '9', '0'), 'A', '0'), 'B', '0'), 'C', '0'), 'D', '0'), 'E', '0'), 'F', '0') != '00000000-0000-0000-0000-0000000000' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:49:37.837

在 5000 行中，我有一个包含非十六进制有效字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T05:23:11.637

我知道这已经得到了回答，但是有一种更优雅的方法。您可以使用子句中允许的简单的、[仅包含一个字符的通配符](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/wildcard-character-s-to-match-transact-sql)语法 (ie `[]`)`LIKE`来测试有效的十六进制数字（即 0 - 9 和 A - F）。并且，通过使用`LIKE`带有单字符搜索的子句，您还可以`UNIQUEIDENTIFIER`以更易读的方式强制执行有效 GUID / 的格式，然后该`REPLACE`方法必须首先将所有十六进制数字标准化为 0，然后再与有效格式进行比较。

**设置**

```
SET NOCOUNT ON;
IF (OBJECT_ID('tempdb.dbo.#GUIDs') IS NOT NULL)
BEGIN
  DROP TABLE #GUIDs;
END;

CREATE TABLE #GUIDs (ID INT NOT NULL, TheGUID VARCHAR(50) NULL);

INSERT INTO #GUIDs (ID, TheGUID)
  SELECT tmp.ID, tmp.TheGUID
  FROM  (
      SELECT  1, 'E1A21B62-ACC4-4ACB-B284-0F0233F19EDA' -- valid
      UNION ALL
      SELECT  2, '50178543-11E6-40D2-87F1-9C4676DCF542' -- valid
      UNION ALL
      SELECT  3, '' -- invalid: empty string
      UNION ALL
      SELECT  4, '4EB30267-0EB4-413A-9B05-6EDDB943C7D8' -- valid
      UNION ALL
      SELECT  5, '4EB30267-0EB4-413A-9Z05-6EDDB943C7D8' -- invalid: has a "Z"
      UNION ALL
      SELECT  6, NULL -- invalid: is NULL
      UNION ALL
      SELECT  7, '18EAE6C5-7256-4598-AA0A-837718145001' -- valid
      UNION ALL
      SELECT  8, '18eae6c5-7256-4598-aa0a-837718145001' -- valid (lowercase version of #7)
      UNION ALL
      SELECT  9, '18EAE6C5-7²56-4598-AA0A-837718145001' -- invalid: has superscript "2"
        ) tmp (ID, TheGUID); 
```

**测试**

下面的示例显示`[0-9A-F]`了对 GUID 的每个十六进制数字位置使用 32 组，并`-`在适当的位置使用破折号 ( )。请注意：

*   模式`\`中每一行末尾的反斜杠 ( ) 是[T-SQL 行继续字符](https://sqlquantumleap.com/2017/10/27/line-continuation-in-t-sql/)，并且`LIKE`
*   您应该使用二进制排序规则来确保“0-9”和“AF”的范围不匹配具有该范围内的值但不是特定十进制数字的任何字符。例如，上标“2”字符 ( `²`) 不是十进制 2，但在范围通配符中使用*并*使用 Unicode 比较规则（这是用于所有`NVARCHAR`数据*甚至*`VARCHAR` *IF*排序规则的规则）时，它的值确实为 2是 Windows 排序规则 - 排序规则名称*不*以`SQL_`) 开头。测试行#9 验证了这种情况。但是，进行二进制比较需要制作范围模式`[0-9A-Fa-f]`或将列包装在`UPPER()`函数中。采用`Latin1_General_100_BIN2`除非您使用的是 SQL Server 2000 或 2005，在这种情况下您应该使用`Latin1_General_BIN`.

```
SELECT  ID, TheGUID, CONVERT(UNIQUEIDENTIFIER, TheGUID) AS [Converted]
FROM    #GUIDs
WHERE   UPPER(TheGUID) COLLATE Latin1_General_100_BIN2 LIKE
'[0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F]\
[0-9A-F]';

SELECT  ID, TheGUID AS [BAD]
FROM    #GUIDs
WHERE   UPPER(TheGUID) COLLATE Latin1_General_100_BIN2 NOT LIKE
'[0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F]-\
[0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F][0-9A-F]\
[0-9A-F]'
OR      TheGUID IS NULL; 
```

而且，虽然这个问题是在 SQL Server 2008 的上下文中提出的，但对于使用 SQL Server 2012 或更高版本的任何人来说，[TRY_CONVERT](https://docs.microsoft.com/en-us/sql/t-sql/functions/try-convert-transact-sql)函数使这变得更加容易：

```
SELECT  tmp.ID, tmp.TheGUID AS [BAD]
FROM    #GUIDs tmp
WHERE   TRY_CONVERT(UNIQUEIDENTIFIER, tmp.[TheGUID]) IS NULL;
/*
ID    BAD
3     
5     4EB30267-0EB4-413A-9Z05-6EDDB943C7D8
6     (NULL)
9     18EAE6C5-7²56-4598-AA0A-837718145001
*/ 
```

# c# - C#：DynamicCastHelper 又名将数组移动到结构中的问题

> ID：689806
> 
> 赞同：0
> 
> 时间：2009-03-27T13:41:48.730
> 
> 标签：c#, struct, pointers

前段时间我又问了你一个问题（[点击这里查看问题](https://stackoverflow.com/questions/676207/accessing-structure-members-with-a-pointer)）。

这是我在使用你给我的源文件时遇到的问题：

```
public unsafe struct tPacket_5000_E
{
    public Int16 size;
    public Int16 opcode;
    public byte securityCount;
    public byte securityCRC;
    public byte flag;
    fixed byte blowfish[8];  //Please NOTE THIS
    public Int32 seedCount;
    public Int32 seedCRC;
public fixed Int32 securityseed[19];
}; 
```

由于河豚数组，该结构被标记为“不安全”。我找不到任何其他方法来声明结构内部的数组。

问题：当我将数据包解析为该结构时，该函数没有在河豚[8]中放入任何内容，就好像它不存在一样。而是将字节放入seedCount和seedCRC中，而不是放入河豚或安全种子中。他们总是空的

这是我的代码：

```
 tPacket_5000_E packet = new tPacket_5000_E();
 packet = (tPacket_5000_E)CDynamicCastHelper.CastIntoFields(packet, data2, CastOptions.ReverseDWord | CastOptions.ReverseDWord); 
```

为什么它不适用于数组？是不是因为不安全？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T13:46:25.240

请查看 MarshalAs 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-28T18:30:30.817

DynamicCastHelper 使用属性 DynamicCastHelperSizeAttribute 告诉它数组字段的大小是多少 - 无需将其固定。它使用反射来计算结构/类的字段是什么，上面提到的属性告诉它数组的大小。

您需要在 CDynamicCastHelper.cs 中进行一些更改才能使其工作： (a) 反射告诉您 byte 或 byte[] 分别是 System.Byte 和 System.Byte[]。因此，如果代码正在寻找类型“byte[]”，请将其更改为“System.Byte[]”。System.Byte 相当于*byte*。(b) 在函数 _GenerateFieldsCast 中，它检查每个字段是类还是原始类型。System.Byte[] 的 IsClass 等于 true，因此您需要显式强制 System.Byte[] 作为原始类型处理（以便二进制读取器直接读取它）：

```
if (objField.FieldType.IsClass && objField.FieldType != typeof(System.Byte[])) 
```

使用示例：

```
public class SampleClass2b
{
    public Int16 a;
    [DynamicCastHelperSizeAttribute(5)]
    public byte[] ba; //{ get; set; }
    [DynamicCastHelperSizeAttribute(4)]
    public byte[] bb; //{ get; set; }
    public Int32 c;
}
byte[] data2b = new byte[] { 0, 17, 2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 0, 0, 10 };
SampleClass2b clas2b = new SampleClass2b();
CDynamicCastHelper.CastIntoFields(clas2b, data2b, CastOptions.ReverseDWord | CastOptions.ReverseWord); 
```

# sql-server - SQL Server VS 甲骨文

> ID：689807
> 
> 赞同：40
> 
> 时间：2009-03-27T13:42:51.800
> 
> 标签：sql-server, oracle, comparison

我正在学习 SQL Server，但对 Oracle 了解不多。谁能给我一个公平的比较？我已经阅读了有关 SQL Server 2000 与 Oracle 9i 的比较，但它有点过时了。SQL server 2008 赶上了 Oracle 11g/i 了吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2011-04-01T12:16:58.517

在使用 SqlServer 多年和使用 Oracle 4 个月后，我只需 0.02 美元。

SqlServer 更易于使用，这使您可以专注于您希望数据库做的事情（解决一些业务问题），而不是一直与服务器搏斗。

由于 Oracle 让您配置了如此多的设置，因此有很多方法可以使它们出错。这导致了关于分区、要使用的索引类型等的无休止的讨论。在这些讨论中，没有人考虑业务问题。

打个比方：我曾经有一台奥林巴斯相机，镜头很好，设置也很简单。我用它拍了很多漂亮的照片，所以我升级到带有各种旋钮和转盘的数码单反相机。这样我的照片就没有一半好，因为我专注于相机而不是主题。

对我来说，这就是 Sql 和 Oracle 之间的区别。Sql 更易于使用，因此可以完成更多工作。想法从白板到工作代码的速度要快得多。只有当您推动非常大的数据库时，Oracle 才会占据优势，但我什至不确定。我不认为 Oracle 可以处理 SQL 无法处理的事情。

[编辑：此外，由于上下文切换到 PL/SQL](http://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:60122715103602)，Oracle 在大数据量的数据库内分析方面非常糟糕。因此，如果您想在数据上运行一些复杂的功能，请不要使用 Oracle。另一方面，MS SQL 在这方面大放异彩，因为它不受此问题的影响，并且还具有 .Net 集成。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-03-30T20:00:21.663

I'd say:

*   Oracle has a much better procedural language. T-SQL feels only half finished compared to PL/SQL.
*   SQL Server has a much better optimizer. When I used Oracle, I had to hint every query to make sure that it didn't take forever to finish, SQL Server just works. Might have been that the server was badly configured, though, which takes us to the next point
*   SQL server is a lot easier to work with. You need dedicated DBAs to administer Oracle, but pretty much any bozo can keep SQL server running.
*   Oracle has a better, more predictable and more well-documented concurrency model.
*   Oracle's documentation is superior in most ways.
*   SQL server integrates better with .NET (like the devil Linq2SQL).
*   If you use Oracle you also have to buy TOAD, but the included Manegement Studio will do for SQL Server.
*   Oracle has more cool but hardly necessary features like extensible indexing.

If I were to choose I'd go for SQL server because of the better optimizer. However, I don't really feel safe when multiple people use the same rows in SQL server.

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-27T13:52:12.433

我不知道这是否公平，但这是我与两者合作的经验：

1.  Oracle 似乎更“强大”了一些 SQL Server 还没有完全赶上的漂亮特性。

2.  SQL Server 更易于使用，并且与 Microsoft 产品具有更好的集成（如果您正在进行 .NET 开发）。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-03-27T13:57:41.420

最终现在没有太大的不同。很少有人能做到其他人不能做到，但开箱即用的配置往往会有所不同。

最明显的区别是 Oracle 使用 SEQUENCE，而 SQL Server 使用自增列。各有利弊。有些人更喜欢其中之一。

根据我在 SQL Server 中执行 Top N 查询的经验，似乎比 Oracle 容易一些。

开箱即用的 Oracle 使用 MVCC（未提交的数据不会阻塞其他事务的读取——数据库保持一致的视图）。我最近才发现的 SQL Server 也有这个，但它不是默认选项，并且被称为完全不同的东西。事务隔离级别什么的。

PL/SQL 和 T-SQL 在某些领域的语法有相当大的不同，但概念基本相同。

就我个人而言，我发现 SQL Server management Studio 还可以，但在某些方面却很糟糕，比如它的数据导入/导出无法使用自动增量主键。这是 SQL Server 2005 多年前的一个已知错误。我不知道他们是否在 2008 年修复了它。使用 PL/SQL Developer（不作为 Oracle 的一部分提供；它是一个单独的商业产品），导入和导出变得轻而易举。

Oracle 对 VARCHAR(2) 列有一个恼人的限制：长度限制为 4k。它们在 SQL Server（64k？）中要长得多。

我发现 SQL Server 安全模型很奇怪。默认情况下禁用 TCP（仅限 Windows 身份验证），然后您必须设置登录和用户？我从来没有完全明白这一点。它似乎过于复杂，而在 Oracle 中它只是：

```
CREATE USER blah IDENTIFIED BY password;
GRANT CONNECT TO blah; 
```

完成（尽管授予其他一些特权/角色，如 RESOURCE 很常见）。

我从来没有完全弄清楚管理 tstudio 的备份/恢复。恢复会失败，说有人连接到数据库，但有人是我试图运行恢复。

在任何人对我进行上述操作之前，我完全意识到其中许多源于我缺乏 SQL Server 经验，但老实说，仍然存在一定程度的一致性（抽象）和预期的概念可移植性。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-05-25T03:32:08.833

我是一名软件开发人员。我主要在数据库之上编写软件（或者至少帮助我的团队这样做）。

这就是我对 Oracle 的看法：每次我想做某事时，我过去的经验对理解如何完成当前任务没有帮助。我花了很多时间寻找对神秘错误消息的某种有用解释，只是找到了一些建议 OP 联系 Oracle 支持的帖子。我刚刚发现他们的数据泵导入工具如果你有一个`NOT NULL`Oracle 10g 中对空间列的约束。即使在删除约束之后，我仍然遇到导入挂起什么都不做的问题。说到数据泵，它只能在本地工作。在远程机器上工作的导入/导出工具已被弃用。当您的过程中有错误时，它会告诉您编译失败，但无论如何都会在不可用状态下创建过程对象。然后你必须运行一个命令来获取错误。用户和权限系统很差。用户是 Oracle 中的模式，但是对于所有大量权限，没有允许用户访问模式上的所有对象的权限，并且允许用户终止会话需要授予`ALTER DATABASE`权限（这给用户可能比你想要的更多的权力）。对于空间迷，它无法解析它为 SRID 3857 生成的 WKT（当坐标变得足够大并且无法解析该数字语法时，它会吐出 0.00000e6 形式的数字）。是的，其中很多都是具体的例子，但是遇到这些我不能只做我想做的事情的问题对我来说是一种日常体验，在单个任务中会出现多个问题。

我只有有限的 SQL Server 经验，但我所做的事情对我来说并没有那么粗糙。我能够更轻松地找出问题所在，而且我不记得看到无法帮助我找出问题所在的错误消息。我曾更广泛地使用 SQL Server 的同事报告了类似的经历。

也许只有我一个人，但与 Oracle 合作似乎一直是一个痛苦而乏味的过程，要寻找奇怪的错误并试图解决我需要的功能缺失并留给我自己实现的事实（比如自动递增键） . 我的底线观点是：也许甲骨文可以表现得更好，但前提是你有时间和金钱让甲骨文工作，然后弄清楚如何调整它，还有钱让你的开发人员也学习。Oracle 很难学习和使用。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-03-27T14:15:23.670

我是一个 SQLServer 人，对 Oracle 知之甚少，但在我看来，SQLServer 与 Oracle 是一个宗教论点。不妨问问Windows、Mac还是Linux哪个更好。

SQLServer 和 Oracle 都是具有出色开发人员、运营和 IT 支持故事的企业级数据库。在正确配置和调整大小时，两者都能够处理您想要扔给它的任何数据集，并且在配置和调整不当时都能够停止尖叫。

至于“易用性”，正如我所说，我是一个 SQLServer 人，我发现 SQLServer 真的很容易使用（管理员）。当然，我可能会觉得 Oracle 很痛苦，因为我以 SQLServer 的方式思考。同样，我确信 Oracle 管理员/开发人员发现 Oracle 易于使用，因为他们认为 Oracle 和 SQLServer 对他们来说很陌生。

我认为两者之间的一个真正区别是 Oracle 是跨平台的，而 SQLServer 显然不是。但是，我不认为这有什么大不了的，因为我不打算用 Linux 取代 Windows。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-27T14:33:38.917

我曾在各种项目中使用 SQL Server 和 Oracle。我的想法：

*   SQL Server 与 .NET 配合使用效果更好
*   通常，SQL Server 更易于安装和使用。作为一名开发人员，我很少需要 SQL Server 的 DBA，但似乎总是遇到需要 DBA 才能完成的 Oracle 工作。
*   我非常喜欢 PL/SQL (Oracle) 而不是 T-SQL (SQL Server) 来编写存储过程
*   Oracle 似乎有更重要的硬件要求
*   SQL Server 的默认管理工具比 Oracle 附带的管理工具更易于使用
*   开发商店很少将两者混合

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-30T19:28:14.050

我相信 Oracle 拥有一长串 SQL Server 没有的特性。这并不意味着您不能在 MSSS 中完成相同的任务，不，但这些特性确实意味着 Oracle 在相同的事情上可以更快

表簇。

我们可以在同一个块/页上存储来自多个表的数据。以包含表、列、索引和约束的系统表为例。如果您没有表集群，为了提取表、其所有列、索引和约束，您将查询父表的名称索引，然后转到父表，读取该行的页面/块。然后获取 PK，将该值放入列表 FK 上的索引中，获取 rowid，转到具有这些行的块/页面，对其他两个表重复。呃......这是很多工作。

在 Oracle 中，您可以根据 Table_PK 指定这四个表将位于同一个表集群中。所以阅读看起来像。检查集群索引以获取该表的位置，并使用一个或几个块获取所有 4 个表的数据。瞧。

在这两个系统中，它都是 4 个表，对于应用程序来说看起来**完全一样，但如果最小化读取时间****至关重要**，那么 Oracle 可以更快地做到这一点。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-27T14:16:36.257

最新版本的 SQL Server 和 Oracle 都已为企业做好准备，并且它们的功能大体相似。

它们显然不会以相同的方式工作，但总的来说，您可以在两者中实现的性能和功能大致相当。

如果你想大量参考文章，请在 google 上搜索： [SQL vrs Oracle](http://www.google.co.uk/search?hl=en&q=sql+vrs+oracle&meta=)

话虽如此，我确信许可和支持协议存在差异。

就我个人而言，我们有 Oracle 和 SQL Server，我过去曾在那里工作过，比较这两者，我在 Oracle 中看不到任何我在 SQL Server 中无法做到的事情（我的角色之一是 SQL Server数据库管理员。）。
我相信 Oracle DBA 也有同感。我们有 10 个 SQL Server 和数据库，数据库从很小到数百 GB 不等。Oracle 有多个服务器和数据库，而且它们也很大。

在我看来，这已归结为管理/成本问题，而不是过去的技术/功能问题，此外，某些应用程序更适合一个数据库而不是另一个数据库。

我对 i 和 g 含义的最佳猜测（不查找它们）。
将是，i 已准备好互联网，g 已启用网格。

以下是有关 SQL Server 2010 的一些信息：[Microsoft 制定了 SQL Server 路线图](http://www.infoworld.com/article/08/10/06/Microsoft_lays_out_SQL_Server_roadmap_1.html)

这是微软与甲骨文的比较[：更可扩展 | 更多价值](http://www.microsoft.com/sqlserver/2008/en/us/compare-oracle.aspx)

以下是 Oracle 与 Microsoft 的比较：[Oracle(r) Database 10g 第 2 版在头对头比较中优于 Microsoft SQL Server 2005](http://www.oracle.com/us/corporate/press/016552_EN)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-27T15:03:50.933

Oracle 的优势在于调优方面，在 Oracle 中您几乎可以更改所有内容……我不知道您是否在 SQL Server 中获得了这种级别的自定义。

在工具方面，SQL Server 大放异彩，它非常易于使用（有限制但仍然非常容易）。

集成...这取决于，如果您使用的是 .NET，那么 SQL Server（即使您也可以使用 Oracle）如果您使用的是 Java，那么 Oracle（您也可以使用 Java 连接到 SQL Server）。

如果你问我选择哪一个，我会说没有！因为你得到了与 MySQL 或 PostgreSQL 等免费数据库服务器几乎相同的质量和先进技术（而且因为我使用 Python/Django 和 .NET，它们集成得很好）。

你应该选择哪一个？我不知道，两个都试试！，安装和玩它们不会花费你超过一天的时间 :)。两者都有优点，而且都很酷，我们已经达到了选择哪个 DBMS 无关紧要的程度（4 个大的 DBMS，MySQL、PgSQL、MSSQL 或 Oracle）。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-09-25T15:23:31.903

正如 cletus 所提到的，Oracle 具有与 SQL Server 完全不同的锁定结构：“作者不会阻止读者，读者不会阻止作者”，正如 Tom Kyte（[他的网站是一个极好的免费资源](http://asktom.oracle.com)）喜欢说的那样。SQL Server 2005 内置了类似的东西，但这样做是为了在 tempdb 中实现行版本控制，这听起来并不是特别可扩展。而且默认情况下它是关闭的，所以微软的人似乎并不特别相信它。

Oracle 也有一个非常不同的查询缓存结构，因此使用绑定变量或占位符可以产生巨大的差异：“硬”解析（即数据库检查 SQL 语法，就好像它是第一次看到它一样) 可以保持在最低限度，这意味着只有“软”解析（填充变量）占用开销。从 10g 开始，还提供了绑定“窥视”功能，这样您就可以使用绑定变量而不受数据倾斜的影响。

此外，还有诸如真正高效和简化的全文搜索功能以及行级版本控制之类的东西。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-05-24T22:14:08.610

作为最终用户（非 IT），我对 Oracle 有一种倾向（和偏见）。我在 Oracle 工作了三年，现在已经进入了 MSSS 的世界。就个人而言，我发现 SQL Server 环境不太直观，而且非常“错误”。我不写代码，但我确实需要查询大型数据集，并发现它（OSD）更具可扩展性。

# php - 使用 PHP 将文件上传到 FTP 服务器而不将其存储在文件系统中

> ID：689808
> 
> 赞同：0
> 
> 时间：2009-03-27T13:42:52.830
> 
> 标签：php, ftp

我一直未能成功尝试将加密文件上传到 FTP 服务器，而没有先将其写入文件系统（这具有安全隐患）

我一直在尝试使用`proc_open`，`ftp_fput`但无济于事，我猜是因为创建的流无法`proc_open`使用`fstat`

这是代码

```
<?php
$ciphertext = 'sadfasfasdf90809sf890as8fjwkjlf';

//The Descriptors
$descriptorspec = array( 
  0 => array("pipe", "r"),  // stdin 
  1 => array("pipe", "w"),  // stdout 
  2 => array("pipe", "w")   // error
);

$process = proc_open('cat', $descriptorspec, $pipes);
if (is_resource($process)) {    
fwrite($pipes[0], $ciphertext); 
fclose($pipes[0]);

//Debug test to proce that $pipes[1] is a valid stream     
//while(!feof($pipes[1])) {
//  $content .=  fgets($pipes[1],1024);
//}

//FTP connection etc etc OMMITTED to save space.

$upload = @ftp_fput($conn_id,$dir."/".$ftp_file.$extenstion,$pipes[1],FTP_BINARY);
fclose($pipes[1]);
// Check upload status
echo ('upload '. ($upload ? 'true':' false')); 
}
?> 
```

我希望有人可以提供帮助或建议任何改进或替代方法。

谢谢，

菲尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:51:21.340

永远不要相信服务器管理员！

上面的代码有效，不需要您使用 tmpfile。

谢谢，

菲尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T14:02:04.123

为什么您不想创建文件？仅仅是因为您没有其他选择、安全原因还是其他原因？

我通常将不在文件系统中的文件上传到 FTP 的方式是使用[tmpfile](http://us2.php.net/manual/en/function.tmpfile.php)：

```
<?php

  $fh = tmpfile();
  fwrite($fh, data);

  // do upload

  fclose($fh);

?> 
```

使用临时文件 make 非常干净；你写任何你需要写的东西，上传，然后关闭文件，然后它就神奇地消失了。

现在，我不知道您是否可以将文件以外的其他内容（即内存中的数据）上传到 FTP 服务器……至少我试图找到一种方法但找不到。

# sql - 在 MySQL 语句中使用 datediff

> ID：689819
> 
> 赞同：0
> 
> 时间：2009-03-27T13:46:00.950
> 
> 标签：sql, mysql, sql-server, datediff

这是我使用 datediff 工作的 SQL 语句：

```
SELECT SUM(b134_nettpay) AS Total, b134_rmcid, b134_recdate 
FROM  B134HREC 
WHERE datediff (dd, '2006-05-05', getdate()) > 90
GROUP BY b134_rmcid, b134_recdate 
ORDER BY b134_recdate DESC, b134_rmcid 
```

我需要用 MAX(b134_recdate) 替换硬编码日期“2006-05-05”，如下所示：

```
SELECT SUM(b134_nettpay) AS Total, b134_rmcid, b134_recdate 
FROM  B134HREC 
where datediff (dd, MAX(b134_recdate), getdate()) > 90
GROUP BY b134_rmcid, b134_recdate 
ORDER BY b134_recdate DESC, b134_rmcid 
```

但我收到此错误消息：

> 聚合可能不会出现在 WHERE 子句中，除非它位于 HAVING 子句或选择列表中包含的子查询中，并且被聚合的列是外部引用。

知道如何修复我的 SQL 语句吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T13:51:23.870

尝试

```
SELECT SUM(b134_nettpay) AS Total, b134_rmcid, b134_recdate 
FROM  B134HRE 
where datediff (dd, 
      (select MAX(b134_recdate) from B134HRE)
      , getdate()) > 90
GROUP BY b134_rmcid, b134_recdate 
ORDER BY b134_recdate DESC, b134_rmcid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T13:49:38.147

你有没有试过移动这个：

`datediff (dd, MAX(b134_recdate), getdate()) > 90`

到 HAVING 子句？

sql语句将是：

`SELECT SUM(b134_nettpay) AS Total, b134_rmcid, b134_recdate FROM B134HRE GROUP BY b134_rmcid, b134_recdate ORDER BY b134_recdate DESC, b134_rmcid HAVING datediff (dd, MAX(b134_recdate), getdate()) > 90`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:02:24.687

此代码适用于 sql server

我不确定 MAX 是否适用于整个桌子：

```
DECLARE @MaxDate  datetime
SELECT @MaxDate=MAX(b134_recdate) FROM B134HRE
/* if you don't want time you need to trim it from @maxDate*/

    SELECT
        SUM(b134_nettpay) AS Total, b134_rmcid, b134_recdate 
        FROM  B134HRE 
        where datediff (dd, @MaxDate, getdate()) > 90
        GROUP BY b134_rmcid, b134_recdate 
        ORDER BY b134_recdate DESC, b134_rmcid 
```

或每组：

```
SELECT
    SUM(b.b134_nettpay) AS Total, b.b134_rmcid, b.b134_recdate 
    FROM  B134HRE   b
        INNER JOIN (SELECT
                        b134_rmcid, b134_recdate , MAX(b134_recdate) AS MaxDate
                        FROM B134HRE
                        GROUP BY b134_rmcid, b134_recdate 
                   ) dt ON b.b134_rmcid=dt.b134_rmcid AND b.b134_recdate=dt.b134_recdate
    where datediff (dd, dt.MaxDate, getdate()) > 90
    GROUP BY b.b134_rmcid, b.b134_recdate 
    ORDER BY b.b134_recdate DESC, b.b134_rmcid 
```

但你可以试试这些

# language-agnostic - 进度条等的实际时间估计

> ID：689827
> 
> 赞同：16
> 
> 时间：2009-03-27T13:47:29.603
> 
> 标签：language-agnostic, statistics, progress-bar, machine-learning, estimation

我知道我不是唯一一个不喜欢在软件中给出不切实际估计的进度条或时间估计的人。最好的例子是安装人员在 10 秒内从 0% 跳到 90%，然后花一个小时完成最后的 10%。

大多数时候，程序员只是估计完成任务的步骤，然后将当前步骤*/总*步骤显示为百分比，而忽略了每个步骤可能需要不同时间才能完成的事实。例如，如果您将行插入数据库，则插入时间会随着插入行数的增加而增加（简单示例），或者复制文件的时间不仅取决于文件的大小，还取决于文件的位置。磁盘以及它的碎片程度。

今天，我问自己是否有人已经尝试对此进行建模，并且可能创建了一个**带有可配置的鲁棒估计器的库**。我知道很难给出可靠的估计，因为外部因素（网络连接、用户运行其他程序等）发挥了作用。

也许还有一种解决方案可以使用分析来设置更好的估计器，或者可以使用机器学习方法。

有人知道这个问题的高级解决方案吗？

* * *

与此相关，我发现[重新思考进度条](http://www.chrisharrison.net/projects/progressbars/index.html)的文章非常有趣。它展示了进度条如何改变对时间的感知，以及您如何使用这些见解来创建似乎更快的进度条。

* * *

**编辑**：我可以想办法如何手动调整时间估计，即使使用“估计器库”，我也必须微调算法。但我认为这个问题可以用统计工具来解决。当然，估算器会在此过程中收集数据，以便为后续步骤创建更好的估算。

我现在要做的是取上一步所花费的平均时间（按类型分组的步骤并按例如文件大小、事务大小进行标准化）并将这个平均值作为下一步的估计（再次：计算不同的类型和尺寸）。

现在，我知道**有更好的统计工具**来创建估算器，我想知道是否有人将这些工具应用于这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T14:48:30.283

While an undergrad, [Julian Missig](http://julian.missig.org) and I ran an experiment not unlike the Harrison et al. paper. As you might expect for a class project, we didn't really get enough data to make strong claims, except that for a 5-second interval, showing no progress bar was actually perceived to be *shorter*.

So, if the task is likely to take shorter than say 10 seconds, it's best not to show a progress bar at all. That's not to say that you shouldn't show *any* feedback, but a progress bar is likely to just make it seem slower.

If you're interested, Julian has the [paper](http://missig.org/julian/projects/jmissig%20Progress%20Bar%20Paper.pdf) and [poster](http://missig.org/julian/projects/Progress%20Bar%20Poster.pdf) on his site.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T13:58:29.577

谢天谢地，我不是唯一一个！

我不知道处理估计的库，但我可以亲自担保您的分析想法。我曾经实现了一个进度条，用于报告一个长而复杂的文件操作的进度（几个小文件正在被读取、处理，然后组合成一个更大的文件）。我让软件跟踪读取、写入和处理所花费的时间，然后相应地调整进度条。程序运行几次后，进度条会像丝绸一样平滑。没有停顿，也没有快速闪烁。

只要您的操作所花费的时间很容易测量，这就是有效的。我对在下载进度指示器之类的东西上使用这种方法持怀疑态度，因为网络的速度是完全不确定的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-27T14:04:36.927

我认为问题不在于他们估计的步数太多，而是经常使用错误的“步”定义。在您的安装程序示例中，安装程序在 10 秒内从 0% 到 9%，其余时间为一个小时，我看到当程序员决定计算要复制的文件数而不是字节数时会发生这种情况。

假设有 10 个文件，其中 9 个是 5K（自述文件、许可证、图标等），最后一个是 2Gig ISO，嗯，前 9 个复制速度非常快，最后一个复制速度很慢！计数文件是错误的计数，应该计数字节。问题是，如果要计算字节数，则需要实现自己的复制例程，以便在大文件复制期间提供状态更新。实现自己的复制程序真的值得吗？

另一个问题是安装（像许多其他事情一样）是由可能非常深的例程堆栈组成的。这些例程可以做很多事情，但它们很可能是通用例程，并且其中没有任何东西能够在更高级别上更新一些进度表。您需要重新实现一些常见的例程才能获得良好的进度信息。

至于一个稳健的估计器，我认为这真的很难。可以在配置文件中定义特定步骤，但您需要从安装过程的每个部分进行进度更新。此外，做这些事情的时间显然会因机器而异，所以无论如何你都可能会走得很远。当然，一旦您在特定机器上完成安装，您可能会估计下次在该机器上的安装。;-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T15:58:26.653

使用进度条的问题通常是一个过程需要多个不同的步骤。因此，如果我正在为软件更新制作进度对话框，我不会使用单个进度条，而是使用带有复选标记的任务列表，以便用户可以看到当前正在执行的任务。

如果任务花费的时间超过 10 秒，请在任务旁边放置一个进度条，以便他们可以看到工作正在完成并且他们不会过早中止它。

下载更新
停止运行进程
更新软件
配置软件
重启程序

个别任务很好，因为过去的表现强烈地预示着未来的表现。下载的前 10 秒可能会显示文件的其余部分需要多长时间。与更新本身相同。

较短的进程不需要进度条，因此在任何进程花费 10 秒或更长时间之前，甚至不要在任何进程上显示进度条。这样，快速系统上的用户只会在每个任务上看到一个复选标记，而在慢速系统上，用户会看到复选标记，如果它在任务上停留“太久”，他们会看到带有实际有用信息的进度条。

进度条并没有对后面的任务需要多长时间做出任何承诺。

在底部有一个涵盖所有任务的最佳猜测的总体“估计剩余时间”非常有用，但我不会在进度条上显示。

进度条的问题在于它们是线性移动的。当他们跳跃和口吃时，这对用户来说是非常令人沮丧的——他们实际上用处不大，并且在这种情况下提供了错误的信息。

为工作选择合适的工具。当它实际上是错误的工具时，选择了太多次进度条。

-亚当

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T14:00:41.133

正如您所说，您可能有 100 个步骤，但每个步骤将花费不同的时间，具体取决于它们所做的事情。

一种方法是按照任务的操作（删除、更改注册表值、下载、复制文件等）对任务进行分组，并为每个组分配一些关键属性：

*   适用哪些可监控的指标（复制速度、解包速度等）？
*   该过程的平均最坏情况发生率是多少？

然后你需要建立一个你将要为整个工作做什么的列表，例如：

1.  解压 100meg 文件（组：解压，值：100）
2.  复制出120megs（组：复制，价值：120）
3.  设置注册表值（组：注册表，值：25）
4.  清理（​​组：删除，值：100）

因此，您可以根据预设的平均最坏情况值计算出总体“估计”，但准确性的关键是在您了解*系统*执行每项任务的速度时更新每个指标乘数。

微软花了十年时间才把它弄好，所以如果它一开始不起作用也不要太苦恼=)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-27T15:41:00.470

另一种（也是更简单的方法）是填充估计和用户感知。

大多数进度条更多地用于 UI 响应而不是持续时间预测：用户需要得到反馈以确认程序没有停止 - 但不太关心完成时间。

如果我正在等待一项任务，并且它在 10 秒内完成了 50% - 当我需要另外 20 秒才能完成最后 50% 时，我会感到沮丧。

对于同样的任务，如果它在 30 秒内达到 50%，一直持续到 60% - 然后神奇地跳到 100% - 我很惊讶，但并不恼火。

如果任务真的很短或完全不可预测，一些动画循环也可以工作（浏览器加载图标、iPhone 等待动画等）。

如果您处于真正需要准确性的几种情况 - 那么可能值得花一些时间在代码中以提高条形图的可靠性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-25T23:18:55.003

我正在使用[DREJ](http://www.gregdennis.com/drej/)对历史进展进行非线性最小二乘回归。它工作得很好。

我使用数据库表来存储我的历史数据。我根据表中的最后 100 个条目重新构建我的估算器函数。

我有关于识别速率确定变量的长期运行方法的注释。

YMMV，但下一次估计会考虑到这一点。

# python - 更改现有 Django 项目的时区

> ID：689831
> 
> 赞同：5
> 
> 时间：2009-03-27T13:48:37.277
> 
> 标签：python, django, timezone, database-agnostic, pytz

像个白痴一样，当我第一次构建一个收集日期时间数据的应用程序时，我完全忽略了时区设置。

那时这不是问题，因为我所做的只是“时间以来”的风格比较和排序。现在我需要做完整的报告来显示实际的日期时间，当然，它们都存储在 America/Chicago（可笑的 Django 默认值）。

所以是的。我有一个中型数据库，里面全是这些不正确的日期。我想更改`settings.TIME_ZONE`为，`'UTC'`但这对我现有的数据没有帮助。

将所有模型数据整体转换的最佳（阅读：最简单、最快）的方法是什么？

（所有数据都是过去两个月内的数据，所以还好没有夏令时转换）

这个项目目前在 SQLite 上，但我在 PostgreSQL 上有另一个项目，有一个类似的问题，我可能想在 DST 开始之前做同样的事情......所以理想情况下是一个与 DB 无关的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T14:11:29.670

我会通过在日期时间字段中添加或减去小时数来对数据库表进行大规模更新。

像这样的东西在 SQL Server 中有效，并增加了 2 小时的日期：

```
update tblName set date_field = dateadd("hh", 2, data_field) 
```

# continuous-integration - 通过 CruiseControl 构建时缺少依赖项

> ID：689832
> 
> 赞同：2
> 
> 时间：2009-03-27T13:49:25.200
> 
> 标签：continuous-integration, windows-installer, cruisecontrol.net

问题是，当项目被正常构建和生产而没有任何错误时，最终打包的 msi 缺少依赖程序集，如果有人通过 Visual Studio 构建项目，通常会打包这些依赖程序集。所以发生的事情是应用程序正在正常安装，然后在运行时通过说 xyz dll 丢失而崩溃。

据我所知，它要么在构建安装项目之前不刷新依赖项，要么以某种方式未能包含所有依赖项。

我们使用 devenv 和解决方案文件构建（全部重建）

有没有人遇到过类似的事情，如果是的话，你是如何解决的？

编辑：CruiseControl 运行在与开发不同的机器上。此外，我们发现解决方案中引用的项目会发生这种情况。

IE 在具有 3 个项目的解决方案中，A 一个库，B 一个引用 A 和 C 的应用程序一个设置项目，然后在构建之后发生的事情是 B 缺少 A，尽管构建成功并且生成了 msi。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T19:14:57.290

还有另一个帖子看起来像同样的问题，但我还无法检查它是否有效。您应该能够包含一个执行任务来运行为刷新依赖项而创建的宏。

[https://stackoverflow.com/questions/45593?sort=votes#sort-top](https://stackoverflow.com/questions/45593?sort=votes#sort-top)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T20:01:14.293

当您说它通过 Visual Studio 手动构建时，您的意思是在同一台机器上吗？如果是这样，那么很可能是您的 Cruisecontrol 服务以不同的用户身份运行，因此设置了不同的路径和环境变量，可能它没有访问这些依赖项所在的文件系统的权限。如果您的意思是它在另一台机器上运行良好，那么我会确保这些依赖项确实存在并且服务运行的用户有权访问它们。抱歉，我们从未遇到过这些问题，所以我只是想猜测一些潜在的 CC.NET 设置问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:11:25.007

您可能会检查缺少的 dll 是否在构建机器上的 GAC 中。

几个月前我遇到了一个问题，构建服务器生成的安装文件比任何开发人员框都少一个 dll。事实证明，丢失的 dll 位于构建框的 GAC 中。出于某种未知原因，VS2005 决定不需要包含 dll，因为它在 GAC 中——即使我们在项目中专门引用了 dll 的本地副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T08:55:26.647

这种情况是 MSBUILD 不支持安装项目的结果。所以我们不得不使用 devenv 来构建带有 Cruise Control 的解决方案。

真正的问题是主应用程序引用了同一解决方案中的项目，虽然这在完整的 .NET 设置项目中无法重现，但它确实在 CF 设置项目中反复发生。

我们通过更改 CF 解决方案的架构来**解决**这个问题，将 1 个项目中的所有相关项目作为文件夹，因此只有 1 个 exe 生成并与安装项目打包在一起。

值得注意的是，我们在引用其他 dll 文件时没有丢失程序集，但只有在我们引用存在于同一解决方案中的库项目时才出现。

在谷歌上搜索了这个主题之后，我发现了一些关于这个主题的令人不安的细节，这让我指出这个错误和 msbuild 无法支持安装项目自 2005 年以来就存在于 msdn 论坛报告中，而不仅仅是。

# architecture - 接口依赖的文档化和架构建模

> ID：689835
> 
> 赞同：0
> 
> 时间：2009-03-27T13:50:10.143
> 
> 标签：architecture, interface

我有一个包含数百万个 SLOC、数百个模块和数千个接口依赖项的大型软件系统。基于[StackOverflow](https://stackoverflow.com/questions/489171/discovering-interface-dependencies)中的一个较早的问题，我已经能够开始发现这些接口依赖项实际上是什么。

现在的挑战是以有用的格式提供所有这些信息。数据位于 SQL 数据库中，因此构建报告很容易，但我需要一种方法来对数据进行实际建模，以便用户轻松找到他们正在寻找的内容。

我尝试了像 UML 这样的标准解决方案，但最终依赖线太多，以至于图表看起来像密集的蜘蛛网并且毫无用处。现在我只有一个 40,000 行的 Excel 电子表格，但这不是很实用。

有人对如何管理如此专业的数据有任何想法或示例吗？我曾考虑尝试破解 doxygen（我喜欢 javadoc 样式的输出），但这似乎需要做很多工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-04T01:08:10.857

现在 VSTS 2010 beta 1 已经发布，现在可能是观看[使用 Visual Studio Team System 2010 Architect 进行“自下而上”设计](http://channel9.msdn.com/posts/VisualStudio/Bottom-up-Design-with-Visual-Studio-Team-System-2010-Architect/)视频的好时机。

您甚至可能想在测试版中尝试其中的一些。它作为 VM 发布，因此不会对您的系统造成危险。此外，您可以在不提交平台的情况下使用架构工具，因为您只是试图可视化您的代码，而不是开发更多代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T07:09:15.053

我认为在你解决“我用什么技术创建文档”这个技术问题之前，有一些事情要做。

系统的真正知识和理解超出了实际的接口关系和模块结构。它是对整个系统的理解，以及其中的各个部分如何为整体做出贡献。

我会朝以下方向发展：

1）首先，尝试自**顶向下理解系统。**这意味着首先要了解模块的结构并从上到下创建它们的一些表示。在此过程中，您可能会在当前 Excel 中不存在的模块上找到其他元数据。花点时间添加它，它会在您以后创建自动文档时最有用，因为它会反映系统结构上的“非显而易见”知识。

2) 编写一个简单的程序，**从 excel 生成一组 HTML 文件**。这将帮助您更轻松地浏览和导航信息，作为进一步调查的起点。一开始我不会使用完全成熟的 javadoc 格式。从小处着手，根据需要分阶段发展您的程序\脚本。在此过程中，您还将发现重构的意义所在。

3) 使用您的 HTML 输出来研究几个模块的结构并了解**接口的内部模式。**有命名约定吗？重复模式？您可以推断出的任何内容，并且没有明显记录在 Excel 中。

我会创建一些本地 UML 图，但不会达到无法控制的大小 - 每个模块可能有几个 UML。以不同的方式标记对外部模块的依赖关系。（同样，自动化 UML 的生成不会那么有用，它是在每个图表中手工挑选有意义的接口，这将使文档中最有启发性的 UML。）

我认为一组 HTML 和 UML 的最终结果将是一个很好的最终结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T15:17:10.823

如果它是一个很好的分解系统，那么子系统内应该有相互关联的接口集群，但子系统之间只有少数接口。

如果它不是一个分解良好的系统，那么它在任何表示中都不会看起来很漂亮，并且消除那里的链接的表示会歪曲这种情况。

一种选择是修剪只有一个依赖的接口，这将是图的叶子。重复这样做会将系统侵蚀为具有最紧密链接节点的骨架。

您可能还想执行拓扑排序，这将显示任何循环，并告诉您层的位置。

对于 40,000 个接口的概述，我不赞成 JavaDoc - JavaDoc 非常适合在分层排列的库中查找内容，但它根本不能很好地显示事物之间的联系。

# .net - 为什么接口允许在接口中声明状态？

> ID：689839
> 
> 赞同：4
> 
> 时间：2009-03-27T13:51:02.747
> 
> 标签：.net, interface

根据[为什么我们不允许在接口中指定构造函数的答案？](https://stackoverflow.com/questions/689474/why-are-we-not-allowed-to-specify-a-constructor-in-an-interface/689488#689488),

> 因为接口描述了行为。构造函数不是行为。如何构建对象是一个实现细节。

如果`interface`描述*行为*，为什么`interface`允许声明*状态*？

```
public interface IStateBag
{
    object State { get; }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T13:53:21.743

嗯 - 它不是真正的状态。如果接口允许您声明*字段*，那么这就是状态。由于属性只是 get 和 set 方法的语法糖，因此它是允许的。

这是一个例子：

```
interface IFoo
{
    Object Foo { get; set; }
} 
```

之前的接口被编译为以下 IL：

```
.class private interface abstract auto ansi IFoo
{
    .property instance object Foo
    {
        .get instance object IFoo::get_Foo()
        .set instance void IFoo::set_Foo(object)
    }
} 
```

如您所见，即使是接口也将属性视为方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-27T13:53:14.753

属性不是实现。例如，您不能定义*fields*。属性和事件实际上只是方法的特殊模式；有一个属性，它是“get_”和“set_”，有一个事件“add_”和“remove_”。

所以这只是一种方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T13:58:07.410

属性也是对行为的描述：实现接口的类仍然可以完全自由地决定如何实现属性。

不允许在接口中声明属性只会迫使开发人员手动创建 getter 和 setter：

```
object GetState();
void SetState( object o ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T13:58:39.280

> 如果接口描述行为，为什么接口允许声明状态？

状态是一种行为。将状态指定为行为之一的接口没有任何问题。

我相信你的问题是基于一个错误的论点。我认为您对这句话的理解有点过分了。我认为更清晰的说法是......

> 接口描述特定对象拥有的行为。构造函数是一种创建对象的方法。

# apache-flex - Flex/TextArea：插入标签？

> ID：689847
> 
> 赞同：2
> 
> 时间：2009-03-27T13:53:26.687
> 
> 标签：apache-flex, actionscript-3

我有一个要用于代码输入 (xml) 的 TextArea。如何允许输入选项卡（按选项卡将焦点移动到 nect 控件）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T14:41:37.993

我发现这样做的唯一方法是扩展 TextArea 并捕获它的 keyFocusChange 事件，然后停止该事件并插入选项卡。这是一个例子：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" xmlns="*">

  <mx:Component className="MyTextArea">
    <mx:TextArea width="300" height="300">
      <mx:keyFocusChange>
        event.preventDefault();
        this.textField.replaceSelectedText("\t");
      </mx:keyFocusChange>
    </mx:TextArea>
  </mx:Component>

  <MyTextArea width="300" height="300"/>

  <mx:TextArea width="300" height="300"/>

</mx:Application> 
```

您还可以将 MyTextArea 分解为单独的类文件。但我将它们全部放在一个文件中，因为它更容易测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-06T21:59:17.833

或者

```
<mx:TextArea width="300" height="300" keyFocusChange="event.preventDefault();event.target.replaceSelectedText('\t');"/> 
```

# windows - 处理桌面位置、字体和其他 win32 控制台参数

> ID：689850
> 
> 赞同：1
> 
> 时间：2009-03-27T13:55:31.847
> 
> 标签：windows, winapi, console

是否可以以编程方式设置诸如左上桌面位置、控制台字体、快速插入和鼠标选项选择等 Windows 控制台参数？

不幸的是，我们可以通过调用未记录的 Windows API 来设置一些控制台参数。例如：`SetConsoleFont`, `GetConsoleFontInfo`,`GetNumberOfConsoleFonts`从`KERNEL32.DLL`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T14:03:13.217

为了重新定位控制台，您需要更新底层 HWND。您可以使用 GetConsoleWindow() 函数来获取 HWND 的句柄。从那里你可以调用 GetWindowInfo、SetWindowINfo 等来更新它的位置和大小

[http://msdn.microsoft.com/en-us/library/ms683175(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms683175(VS.85).aspx)

**编辑**下面实际上是用于更新缓冲区。

我相信您正在寻找 SetConsoleWindowInfo 函数。这将允许您控制控制台窗口的定位。

[http://msdn.microsoft.com/en-us/library/ms686125(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms686125(VS.85).aspx)

# wpf - PowerShell WPF DataGrid：提交空行时引发异常

> ID：689852
> 
> 赞同：4
> 
> 时间：2009-03-27T13:56:49.113
> 
> 标签：wpf, powershell, datagrid, wpftoolkit

我在尝试提交*空*DataGrid 行时遇到异常。

```
System.NullReferenceException: Object reference not set to an instance of an object.
   at MS.Internal.Data.PropertyPathWorker.DetermineWhetherDBNullIsValid()
   at MS.Internal.Data.PropertyPathWorker.get_IsDBNullValidForUpdate()
   at MS.Internal.Data.ClrBindingWorker.get_IsDBNullValidForUpdate()
   at System.Windows.Data.BindingExpression.ConvertProposedValue(Object value)
   at System.Windows.Data.BindingExpressionBase.UpdateValue()
   at System.Windows.Data.BindingExpression.Update(Boolean synchronous)
   at System.Windows.Data.BindingExpression.UpdateSource()
   at Microsoft.Windows.Controls.DataGridHelper.UpdateSource(FrameworkElement element, DependencyProperty dp)
   at Microsoft.Windows.Controls.DataGridTextColumn.CommitCellEdit(FrameworkElement editingElement)
   at Microsoft.Windows.Controls.DataGridColumn.CommitEdit(FrameworkElement editingElement)
   at Microsoft.Windows.Controls.DataGridCell.CommitEdit()
   at Microsoft.Windows.Controls.DataGrid.OnExecutedCommitEdit(ExecutedRoutedEventArgs e)
   at Microsoft.Windows.Controls.DataGrid.OnExecutedCommitEdit(Object sender, ExecutedRoutedEventArgs e)
   at System.Windows.Input.CommandBinding.OnExecuted(Object sender, ExecutedRoutedEventArgs e)
   at System.Windows.Input.CommandManager.ExecuteCommandBinding(Object sender, ExecutedRoutedEventArgs e, CommandBinding commandBinding)
   at System.Windows.Input.CommandManager.FindCommandBinding(CommandBindingCollection commandBindings, Object sender, RoutedEventArgs e, ICommand command, Boolean execute)
   at System.Windows.Input.CommandManager.FindCommandBinding(Object sender, RoutedEventArgs e, ICommand command, Boolean execute)
   at System.Windows.Input.CommandManager.OnExecuted(Object sender, ExecutedRoutedEventArgs e)
   at System.Windows.UIElement.OnExecutedThunk(Object sender, ExecutedRoutedEventArgs e)
   at System.Windows.Input.ExecutedRoutedEventArgs.InvokeEventHandler(Delegate genericHandler, Object target)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)
   at System.Windows.Input.RoutedCommand.ExecuteImpl(Object parameter, IInputElement target, Boolean userInitiated)
   at System.Windows.Input.RoutedCommand.Execute(Object parameter, IInputElement target)
   at Microsoft.Windows.Controls.DataGrid.EndEdit(RoutedCommand command, DataGridCell cellContainer, DataGridEditingUnit editingUnit, Boolean exitEditMode)
   at Microsoft.Windows.Controls.DataGrid.CommitEdit(DataGridEditingUnit editingUnit, Boolean exitEditingMode)
   at Microsoft.Windows.Controls.DataGrid.CommitAnyEdit()
   at Microsoft.Windows.Controls.DataGrid.OnEnterKeyDown(KeyEventArgs e)
   at Microsoft.Windows.Controls.DataGrid.OnKeyDown(KeyEventArgs e)
   at System.Windows.UIElement.OnKeyDownThunk(Object sender, KeyEventArgs e)
   at System.Windows.Input.KeyEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)
   at System.Windows.Input.InputManager.ProcessStagingArea()
   at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)
   at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)
   at System.Windows.Interop.HwndKeyboardInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawKeyboardActions actions, Int32 scanCode, Boolean isExtendedKey, Boolean isSystemKey, Int32 virtualKey)
   at System.Windows.Interop.HwndKeyboardInputProvider.ProcessKeyAction(MSG& msg, Boolean& handled)
   at System.Windows.Interop.HwndSource.CriticalTranslateAccelerator(MSG& msg, ModifierKeys modifiers)
   at System.Windows.Interop.HwndSource.OnPreprocessMessage(Object param)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)
   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)
Exception calling "Run" with "1" argument(s): "Object reference not set to an instance of an object." 
```

重现步骤：

*   转到“新行”
*   按 F2
*   按 ENTER

这工作正常：

*   转到“新行”
*   按 F2
*   按 ESC

也：

*   转到“新行”
*   按 F2
*   输入“sdfdsf”
*   按 ENTER

来源可以在[这里](http://cid-0dba2a6e137e8a9a.skydrive.live.com/self.aspx/Public/demo%7C_001.rar)找到。

我发现了两个似乎与此问题有关的帖子：

1.  [.Net 3.5 SP1 中的异常](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361723)
2.  [WPF 数据绑定、类类型、无命名空间异常](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=422093)

另外，我在 C# 中尝试了类似的代码，并且效果很好。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T09:40:30.297

这似乎是 Microsoft WPF DataGrid 中的一个错误。如果您还没有这样做，您绝对应该通过[Microsoft Connect报告它。](https://connect.microsoft.com/default.aspx)

作为一种解决方法，您可以在绑定上使用值转换器，以阻止绑定目标上的 NULL 值传输到绑定源，这将导致**NullReferenceException**。以下是此类转换器的示例：

```
// NullToUnsetConverter.cs    

using System;
using System.Windows;
using System.Windows.Data;
using System.Globalization;

namespace MyProject.Controls.Converters
{
    /// <summary>
    /// Converts <c>null</c> values to <see cref="DependencyProperty.UnsetValue"/>.
    /// <remarks>
    /// This converter is intented for use in situations when the binding target
    /// does not correctly handle <c>null</c> values. This is the case for example
    /// with some WPF UI controls.
    /// </remarks>
    /// </summary>
    public class NullToUnsetConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value == null)
            {
                return DependencyProperty.UnsetValue;
            }
            else
            {
                // No conversion applied
                return value;
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            // No conversion applied
            return value;
        }
    }
} 
```

为了将转换器应用于您的绑定，您必须像这样修改您的 XAML：

```
<Window
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:cnv="clr-namespace:MyProject.Controls.Converters"
  xmlns:sys="clr-namespace:System;assembly=mscorlib"
  xmlns:dg="clr-namespace:Microsoft.Windows.Controls;assembly=WpfToolkit"
  >

  <Window.Resources>
    <x:Array x:Key="people" Type="sys:Object" />
    <cnv:NullToUnsetConverter x:Key="NullToUnsetConverter" />
  </Window.Resources>

  <StackPanel>
    <dg:DataGrid ItemsSource="{DynamicResource people}" CanUserAddRows="True" AutoGenerateColumns="False">
      <dg:DataGrid.Columns>

        <dg:DataGridTextColumn Header="First" Binding="{Binding First, Converter={StaticResource NullToUnsetConverter}}" />
        <dg:DataGridTextColumn Header="Last" Binding="{Binding Last, Converter={StaticResource NullToUnsetConverter}}" />

      </dg:DataGrid.Columns>
    </dg:DataGrid>
  </StackPanel>
</Window> 
```

或者，您可以修改**NullToUnsetConverter.Convert**方法以在输入值为字符串时返回**空字符串，就像您的情况一样。**

# c# - 我是否完全误解了如何使用 Visual Studio 的 2008 探查器？

> ID：689853
> 
> 赞同：4
> 
> 时间：2009-03-27T13:57:02.467
> 
> 标签：c#, visual-studio-2008, profiling, c++-cli

**抱怨{**

当我使用 Visual Studio 2008 的分析器（从分析菜单选项）分析我的代码时，我总是感到非常沮丧。在我看来，它是 VS 设计最差的功能之一，每次需要使用它时我都会畏缩不前。

**}**

关于它的使用我有几个问题，我希望你们能给我一些指示:-)

1.  您是否需要在 Debug 或 Release 中构建您的项目来分析它们？一个对话框（我不知道如何返回）提到我应该在 Release 下进行概要分析。好的 - 我这样做了 - 当我去运行代码时，它告诉我我缺少 PDB 文件。惊人的。所以我回到调试模式，并尝试运行它，它告诉我一半的项目需要重新编译并打开 /PROFILE 开关。
2.  是否可以分析 C++/CLI 项目？打开 /PROFILE 开关后，有一半时间我的 C++/CLI 项目完全没有输出。
3.  为什么在尝试分析 C# 项目时，它们会在“模块”视图名称列表下的“报告”中显示为 0x0000001、0x0000002、0x0000003 等？真的吗，VS？真的吗？你猜不到我的模块名称？
4.  就此而言，为什么函数名称报告为 0x0A000011、0x06000009、0xA0000068 等？
5.  为什么，哦，为什么，VS 会在被分析的可执行文件的依赖树中重建所有内容？如果您的解决方案中有 5-6 个项目，这可能不是问题，但是当您有 70 个项目时，**甚至不用理会分析器几乎更快**。
6.  你能推荐任何关于使用 VS2008 分析器的好的指南吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T14:10:07.617

如果您发现它难以使用，那么有一个非常棒的 .NET 分析器，称为[nprof](http://nprof.sourceforge.net/Site/Description.html)，如果您正在调试非 CLR 项目，AMD 有一个非常出色的统计分析器，称为[Code Analyst](http://www.amd.com/codeanalyst/)。

两者都是免费的（！），并且非常易于使用。一个更好的选择，我希望从你上面的帖子中你已经准备好放弃 VS 内置分析器:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:00:52.287

我对那件事也有同样的感觉。我最终编写了自己的（我想要的只是体面的方法调用时间信息）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T21:09:13.583

> 1.您是否需要在 Debug 或 Release 中构建您的项目来分析它们？

通常您使用发布模式。

> 6.你能推荐任何关于使用VS2008 profiler的好指南吗？

第 1 步，下载[ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm)。

第 2 步，按照易于使用的屏幕说明进行操作。

第 3 步，查看易于阅读的报告。

说真的，与 ANTS 相比，Microsoft 分析器是垃圾。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T12:46:45.420

只是一般性评论。人们建立档案有几个原因。

1.  获取各种计时信息。
2.  找出他们可以修复什么以使他们的程序更快。

这些是非常不同的目标。

如果您的原因是第二个原因，那么使用分析器并不是唯一的方法。[看这里](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

# asp.net - 在文件夹 (asp.net) 中打开默认 index.html 文件

> ID：689856
> 
> 赞同：1
> 
> 时间：2009-03-27T13:58:06.270
> 
> 标签：asp.net, asp.net-2.0

当谈到 asp.net/html 时，我是一个真正的菜鸟。我正在使用 VS 2008 开发一个非常基本的网站。此时它主要是 html 页面 - 没有真正的 ASP.NET

我有一个根 index.html，然后是一组文件夹，如 css/images/ features/

等和其中的 index.html 文件，因此可以将其作为

[http://www.blahblah.com/features](http://www.blahblah.com/features) 和 index.html 打开（它发生在我的 1&1 基本网络主机上）

但是我不能在本地测试这个，因为当 VS 默认 Web 服务器打开我的页面进行测试时，如果我给 /features

它显示目录列表。我希望它打开其中的 index.html...无法弄清楚如何在不使用 ASP.NET 核心功能的情况下制作这些友好的 URL（这很重要 - 我现在不打算使用 ASP.NET）

欢迎任何建议 - 我想要的只是一种在上传到网站之前对其进行测试的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:46:03.363

Thats a behavior I've seen before with the Development web server and something similar with IIS ( in that case you usually get a 403- denied).

unlike the default configuration for many other web servers the 'default page' for IIS is **default.aspx**. In IIS you can configure the default page

(Right click on your virtual directory select `Properties` then on the `Documents` tab you have the option to add/edit default content pages for your site)

but I don't know if a way of doing it for the Visual Studio Development web server.

For your scenario if you take your index.html files and rename them to default.aspx ( you do not need to change their content) you should see your 'index' page instead of the directory listing.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T14:48:29.940

The default file for Cassini (The VS Server) is default.aspx, or the currently selected .aspx file when you click "Run". As far as I know there isn't any way to easily customize the "Default Document" as running in Cassini.

If you are not looking to use ASP.NET and want a simple workaround. Setup your site in IIS, and view items that way.

# php - MySQL查询从字段中提取第一个单词

> ID：689858
> 
> 赞同：41
> 
> 时间：2009-03-27T13:58:13.493
> 
> 标签：php, sql, mysql

我想运行一个只从特定字段返回第一个单词的查询，这个字段有多个用空格分隔的单词，我想我可能需要执行一些正则表达式工作来完成这个？我知道如何在 PHP 中使用几种方法来做到这一点，但这最好在数据库端进行。任何想法都非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-03-27T14:02:29.473

`SUBSTRING_INDEX`：[http ://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substring-index](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substring-index)

```
SELECT SUBSTRING_INDEX(`name`, ' ', 1); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-27T14:03:26.930

干得好 ：）

```
SELECT SUBSTRING_INDEX( `field` , ' ', 1 ) AS `field_first_word`
FROM `your_table` 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T14:05:50.060

```
select 
    substring(test_field, 1, instr(test_field, ' ')) 
from 
    test_table 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T14:04:08.737

```
SELECT
  SUBSTR(field_name, 1, LOCATE(' ', field_name)) AS first_word
FROM
  table 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-03T20:05:41.057

这段代码可以解决问题

```
select regexp_substr("Héctor-99 Eduvijes Uribe Curiel", '[[:graph:]]*')` 
```

输出：Héctor-99

这与其他答案非常相似，但以不同的方式工作，您可以在这里找到更多相关信息！[https://dev.mysql.com/doc/refman/8.0/en/regexp.html](https://dev.mysql.com/doc/refman/8.0/en/regexp.html)

另一个可选的可能是：

```
select regexp_substr("Some name", '[a-z]+') 
```

输出：一些

在括号内你可以放任何你想要的东西，学习一些正则表达式你就能做出伟大的事情。

# c# - .NET 控件事件和页面生命周期

> ID：689871
> 
> 赞同：0
> 
> 时间：2009-03-27T14:02:37.710
> 
> 标签：c#, .net, user-controls, controls

这就是问题所在......我有三个组件......一个页面，其中包含一个用户控件和一个位于用户控件中的服务器端控件。用户控件有一些页面侦听的事件，这些事件会更改服务器端控件的功能。

服务器控件实质上创建了一个 TV-Guide 外观列表，其中包含许多需要事件的较小 ASP.NET 控件。所有这些控件都是动态创建的（显然是服务器端）。填充此服务器端控件需要本质上密集的操作，因此每次回发应该只执行一次。Event1 和 Event2 触发并且基本上会改变有关服务器端控件渲染（排序、过滤等）的内容，因此当它们触发时，我需要确定调用 PopulateControls。

问题是：我找不到调用 PopulateControls 的最佳位置。如果我把它放在 PageLoad 中，它会在任何事件之前触发并绘制列表。然后我的事件必须自己调用 PopulateControls 来响应事件。如果我将调用放在 PreRender 中，则服务器端控件的事件不会触发，因为从我读到的内容来看，它们需要在 PageLoad 之前或期间创建。

那么我应该把这个调用放在哪里，以便我只需要调用它一次，以便它可以响应正确的事件？

这是一些伪代码

```
public class MyPage : System.Web.UI.Page
{
    protected UserControl MyUserControl;

    // Wire up event handlers
    MyUserControl.Event1 += OnEvent1;
    MyUserControl.Event2 += OnEvent2;

    public Page_Load()
    {
    }

    public PreRender()
    {
        PopulateControls();
    }

    private PopulateControls()
    {
        // Do intensive operation to populate controls
    }

    protected OnEvent1()
    {
    }

    protected OnEvent2()
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T15:26:13.673

我可能在这里遗漏了一些东西，但无论如何我都会对此有所了解。您必须创建与初始渲染相同的控件层次结构，以便您的 id 匹配并允许您的事件正确触发。听起来您需要在事件触发后进行一些重新排序，因此您需要创建两次控件。

**编辑：** 您需要能够在回发时重新创建控件和控件层次结构。您应该向客户端发送足够的信息，以便您可以在 Postback 上正确地重新创建控件。如有必要，这可以通过在 ViewState 中保存信息来完成。

您应该只在需要时重新计算控制信息。在你的情况下，因为一些回发事件。

基本流程应该是这样的。在您的 Load 事件中，如果您没有创建控件所需的 ViewState，请调用您的填充方法，否则从 ViewState 创建它们。当回发发生时，Load 事件将创建它们，但它们是从视图状态重建的，所以这应该很便宜。当回发事件触发时，调用填充方法以新顺序或使用新信息重新创建控件，具体取决于发生的事件。

每当我构建一个控件时，我都喜欢考虑如果页面上的某个其他控件发生回发，该控件将如何表现。除非受到回发的影响，否则您的控件应该继续看起来相同，并且应该能够在不进行任何数据访问的情况下重新创建它，但可以使用它在以前的调用中收集的信息。

我编辑了我的答案，希望现在更清楚了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T14:11:16.770

子控件应该在 CreateChildControls 中创建，在控件生命周期的“初始化”阶段调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:16:07.693

在页面或任何子控件上发生任何其他事情之前调用您想要调用的事件的最佳位置是在 PageInit 阶段。

这是一篇不错的文章，讨论了带有用户控件的页面生命周期：http: [//www.codeasp.net/articles/asp.net/20/aspnet-page-lifecycle](http://www.codeasp.net/articles/asp.net/20/aspnet-page-lifecycle)

# seo - 关于 sitemap_index.xml 的困惑

> ID：689872
> 
> 赞同：13
> 
> 时间：2009-03-27T14:02:50.737
> 
> 标签：seo, sitemap

我已经阅读了有关站点地图格式的 Google 文档，但有一件事他们并不清楚：搜索引擎会自动查找并找到 /sitemap_index.xml 还是您必须通过 /robots.txt 或 main 告诉他们/站点地图.xml？你能*没有*/sitemap.xml 并且仍然依赖 /sitemap_index.xml 来被发现和收获吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-27T17:53:28.797

在您的 robots.txt 中，您可以使用相同的语法指向站点地图或站点地图索引文件：

```
Sitemap: <location> 
```

搜索引擎将通过查看文件知道它是什么类型。

值得注意的是，sitemap.xml 和 sitemap_index.xml 只是建议的文件名，您可以使用任何您想要的名称。与 robots.txt 的已知位置不同，搜索引擎不会检查任何位置，例如 sitemap.xml 或 sitemap_index.xml，除非您告诉它该位置有东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-28T17:42:57.877

我已经阅读了很多关于这个问题的讨论，没有人知道谷歌是如何处理这个问题的。

有人说爬虫默认会查找这些文件：

*   /sitemap.xml
*   /sitemap.xml.gz
*   /sitemap.gz

如果您阅读 Google 上关于他们经常谈论这些文件名的 xml-sitemaps 的文章，这是巧合吗？

也许这是真的，但是，我建议遵循 Google 指南并使用 robots.txt + 通过[Google 网站管理员工具](http://www.google.com/webmasters/tools/)提交站点地图。

我认为网站管理员工具被低估了，它很有价值，您可以直接从 Google 接收信息，这些信息可以帮助您改进您的网站。

如果您不想每次都登录网站管理员工具以在站点地图更新时重新提交站点地图，您可以 ping Google 让他们知道更改。

ping Google 的链接：www.google.com/webmasters/tools/ping?sitemap=sitemap_url

更多信息在[谷歌支持](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=34609)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-27T14:13:10.510

最好的方法是在 robots.txt 中指向您的站点地图：

```
Sitemap: <sitemap_location> 
```

[在www.sitemaps.org](http://www.sitemaps.org/protocol.php#informing)上有一个很好的解释

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-29T07:05:15.843

我可以确认，对于我刚刚调查的两个网站，网站管理员工具没有 sitemap_index.xml 或其链接站点地图的记录。

Both the sites I checked have been indexed by google for over a year, do not mention the sitemap in robots.txt, and are WordPress sites with the sitemap_index.xml auto generated by Yoast SEO. I just added the sitemaps manually in webmaster tools.

# django - 如何使用外键 self 检索对象

> ID：689881
> 
> 赞同：4
> 
> 时间：2009-03-27T14:05:32.120
> 
> 标签：django, django-models, foreign-keys

我有一个模型类别，它本身有一个 FK 引用。如何将数据发送到模板并使其看起来像这样

*   第一类
    *   项目清单
    *   项目清单
*   第 2 类
    *   项目清单
    *   项目清单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T13:26:45.197

你可能正在寻找这样的东西：

模型.py

```
from django.db import models

class Category(models.Model):
    name = models.CharField(max_length=100)
    parent = models.ForeignKey('self', blank=True, null=True, related_name='child')
    def __unicode__(self):
        return self.name
    class Meta:
        verbose_name_plural = 'categories'
        ordering = ['name'] 
```

视图.py

```
from myapp.models import Category # Change 'myapp' to your applications name.
from django.shortcuts import render_to_response

def category(request)
    cat_list = Category.objects.select_related().filter(parent=None)
    return render_to_response('template.html', { 'cat_list': cat_list }) 
```

模板.html

```
<ul>
{% for cat in cat_list %}
    <li>{{ cat.name }}</li>
    <ul>
    {% for item in cat.child.all %}
        <li>{{ item.name }}</li>
    {% endfor %}
    </ul>
{% endfor %}
</ul> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T14:23:28.987

看起来您正在尝试在模板中进行递归。这可能会有所帮助： [http ://www.undefinedfire.com/lab/recursion-django-templates/](http://www.undefinedfire.com/lab/recursion-django-templates/)

# perl - 我需要一个便携的、一致的伪随机数生成器

> ID：689889
> 
> 赞同：5
> 
> 时间：2009-03-27T14:07:28.823
> 
> 标签：perl, prng

我正在编写一个[小姐妹加密](http://enfranchisedmind.com/blog/posts/the-kid-sister-crypto-manifesto/)功能，我需要一个 PRNG，它可以在整个操作系统中产生一致的结果（所以没有浮点数学，利用硬件或系统级软件）。这会很好，但不是必需的，因为 PRNG 的周期长于 2 ^(30)。

我目前正在使用 32 位[Xorshift](http://en.wikipedia.org/wiki/Xorshift)：

```
#!/usr/bin/perl

use strict;
use warnings;

{
    use integer; #use integer math
    my $x = 123456789;
    my $y = 362436069;
    my $w = 88675123; 
    my $z = 521288629;

    sub set_random_seed {
        $w = shift;
    }

    sub random { 
        my $t = $x ^ ($x << 11);
        $x = $y;
        $y = $z;
        $z = $w;
        my $rand = $w = ($w ^ ($w >> 19)) ^ ($t ^ ($t >> 8)); 
        return $rand % 256; #scale it back to a byte at a time
    }
}

set_random_seed(5);
print map { random(), "\n" } 1 .. 10; 
```

但我很担心，因为我真的不明白它是如何工作的。例如，原始来源没有设置种子的能力，所以我添加了一个，但我不知道我是否为种子选择了正确的变量。

所以，所有这一切都归结为

1.  你知道 CPAN 上有一个适合我需要的模块吗？
2.  如果没有，您知道适合我需要的算法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T14:09:49.270

[Math::Random::Auto](http://search.cpan.org/search?module=Math%3A%3ARandom%3A%3AMT%3A%3AAuto)是一个 CPAN 模块，实现了著名的[Mersenne twister](http://en.wikipedia.org/wiki/Mersenne_twister) PRNG。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T14:12:25.067

尝试使用 LFSR -[线性反馈移位寄存器。](http://en.wikipedia.org/wiki/Linear_feedback_shift_register). 外部链接上的[第一个](http://www.newwaveinstruments.com/resources/articles/m_sequence_linear_feedback_shift_register_lfsr.htm)链接具有产生任意数量的随机性所需的一切。这样做的好处是它很容易实现，并且可以使用所有整数数学来完成。

我在一个 8051 项目上成功地使用了它。使用 perl，这将是一件轻而易举的事。

**更新：**

这是一个 8 位 LFSR 的快速 perl 实现：

```
use strict;
use warnings;

use List::Util qw(reduce);
use vars qw($a $b);

print 'Taps: ', set_taps( 8, 7, 2, 1 ), "\n";
print 'Seed: ', seed_lfsr( 1 ), "\n";
print read_lfsr(), "\n" for 1..10;

BEGIN {
    my $tap_mask;
    my $lfsr = 0;

    sub read_lfsr {
        $lfsr = ($lfsr >> 1) ^ (-($lfsr & 1) & $tap_mask );

        return $lfsr;
    }

    sub seed_lfsr {
        $lfsr = shift || 0;
        $lfsr &= 0xFF;
    }

    sub set_taps {
        my @taps = @_;

        $tap_mask = reduce { $a + 2**$b } 0, @taps;

        $tap_mask >>= 1;

        $tap_mask &= 0xFF;

        return $tap_mask;
    }
} 
```

这段代码只是一个原型。如果我想在生产中使用它，我可能会将它包装在一个对象中并使寄存器大小可配置。然后我们将摆脱那些讨厌的共享变量。

# c# - 匿名类型是在 LINQ 之外使用的好东西吗？

> ID：689897
> 
> 赞同：3
> 
> 时间：2009-03-27T14:10:29.907
> 
> 标签：c#, .net, linq

在分析一些 ASP.NET MVC 项目时，我发现匿名类型遍布各处。

HTML 助手有它们：

```
<%=Html.TextBox("view.Address", "address", new { Class = "text_field" })%> 
```

许多操作的返回类型都有它们：

```
JsonNetResult jsonNetResult = new JsonNetResult
{
  Formatting = Formatting.Indented,
  Data = new {Something= “”}
} 
```

我知道这来自 LINQ：

```
from p in context.Data
select new { p.Name, p.Age }; 
```

这些真的是现在在 LINQ 之外完成事情的正确方法吗？它们会损害代码的可重用性和可读性吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T14:15:51.033

恕我直言，匿名类型的最大问题源于无法命名它们的类型。也就是说，不可能将匿名类型的类型显式指定为代码中的表达式。这确实让创建通用列表之类的事情变得很尴尬。

```
var list = New List<No way to specify an Ananymous type>(); 
```

通常你必须求助于辅助方法。

```
public List<T> CreateList<T>(T notUsed) {
  return new List<T>();
}
var list = CreateList(new { .Class = "foo" }); 
```

这也有更大的影响，因为您不能使用匿名类型作为返回类型，使强制转换非常尴尬（需要辅助方法）等等......

但这些不是匿名类型设计的操作。在许多方面，它们被设计为在特定定义的函数中使用，并且随后创建了 lambda 表达式。不是作为成熟功能之间的数据通信类型。这当然是设计上的一个限制，有时会让我发疯。但总的来说，我发现它们在语言中是一个非常有用的结构。

如果没有某种形式的它们，LINQ 的许多部分就不可能实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T14:23:22.357

当创建的对象是一个临时对象时，即它会立即被消耗或转换成其他东西，我喜欢匿名类型的想法。它可以防止您在代码中乱扔单用途类，这些类仅用作短期容器。您的示例是它派上用场的典型使用类型，即，在辅助扩展中，它几乎总是立即转换为参数字典，并使用 json 结果进行序列化。如果该类具有领域意义或需要用作第一类对象，那么一定要为它创建一个领域类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:15:48.677

我认为它们是构建字典的更好方法。特别是在您的样品中，有什么替代方案？传递一个 IDictionary<String,Object>？我认为匿名类型更具可读性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T14:14:22.567

我同意

同上传递 lambda 和委托，而不是找到连贯的域级抽象

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T14:25:04.087

我经常使用它们来填充 GridViews 和 DataGridViews，因为它可以节省大量时间来配置 GridView 以仅显示我感兴趣的列。

然而，除了设置 DataSources 之外，我认为它对可读性不利——一个好的抽象可能会更好。

# php - 如何插入数据库中的特定行？

> ID：689898
> 
> 赞同：5
> 
> 时间：2009-03-27T14:10:37.037
> 
> 标签：php, mysql, user-input

好的，所以我的数据库按这个顺序如下：

id (primary - auto_increment), username (unique), password, fname, mail

我有它，以便用户注册用户名和密码，并将其添加到数据库中，首先。没有用户名可以相同，并且当它确实将数据添加到数据库时，它会自动增加 ID。所有这些都有效，但现在我创建了一个帐户设置页面，用户可以在其中更改他们的电子邮件和名字，但它不起作用。我让用户在一个页面上的表单中输入变量，并将他们的名字发布为 ufname（用于更新名字）和 umail（用于更新邮件）。然后在更新数据库的下一页我有这个代码：

```
session_start();
if(!isset($_SESSION['userId'])) {
die("&nbsp;You are not signed in. Please <a href='login.php'>click here</a> to sign in.");
} else {
$changeTXT = $_SESSION['username'];
$changeTXT = strtolower($changeTXT);
$changeTXT = ucfirst($changeTXT);
echo "Account Settings: <font color='red'>" . $changeTXT . "</font><br /><br />";

$ufname = $_POST['ufname'];
$umail = $_POST['umail'];

mysql_connect("localhost", "root", "sp1151") or die(mysql_error());

mysql_select_db("usersys") or die(mysql_error());

mysql_query("INSERT INTO userdb (id, username, password, fname, mail) VALUES('','','','$ufname', '$umail') ");

echo $umail . "<br /><br />";
echo $ufname;

} 
```

哦，我也让用户登录会话。

但是我如何将用户输入的名字和电子邮件插入到他们在数据库中的特定行中？我的数据库名称是 userdb。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-27T14:14:29.507

您需要运行 UPDATE 查询来更改现有行，而不是 INSERT。

```
$sql = "UPDATE userdb SET fname = '$ufname', mail = '$umail' WHERE id = $id";
mysql_query($sql); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-27T14:16:50.610

您需要使用和`UPDATE`声明而不是`INSERT`：

```
UPDATE userdb SET fname = ?, mail = ? WHERE username = ?; 
```

除此之外，您应该认真考虑使用带有查询参数的准备好的语句来防止 SQL 注入攻击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:16:47.957

试试这个`UPDATE`查询：

```
Update 'tableName' set 'columnName' = 'newEntry' where 'rowID' = 'value'. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T14:13:40.417

您是否考虑过使用 SQL`UPDATE`查询？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T14:16:04.793

尝试这个：

```
mysql_query("UPDATE userdb SET fname = '$ufname', umail = '$umail' WHERE id = '$_SESSION['userId']' "); 
```

# java - CXF 无弹簧

> ID：689902
> 
> 赞同：18
> 
> 时间：2009-03-27T14:11:41.060
> 
> 标签：java, web-services, tomcat, cxf

是否可以在没有 Spring 的情况下将 CXF 与 Tomcat 一起使用？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-09-17T15:10:52.473

您可以在没有 Spring 的情况下以编程方式配置 CXF。[请参阅此处](http://cxf.apache.org/docs/servlet-transport.html#ServletTransport-UsingtheservlettransportwithoutSpring)的代码示例。将 Web 应用程序上下文路径与端点扩展（代码示例中的 Greeter）放在一起，将在浏览器中显示一个摘要页面，其中包含指向 WSDL 的链接。

不需要弹簧，使 CXF 占用空间非常小。我发现唯一需要的罐子（对于 CXF 2.2.1）：

*   XmlSchema-1.4.5.jar
*   cxf-2.2.3.jar
*   wsdl4j-1.6.2.jar

我相信 neethi-2.0.4.jar 对于某些配置也可能是必需的，但我不需要它。

玩得开心！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-27T15:07:58.443

我想你的意思是用 CFX 创建一个可以在 Tomcat 中运行的 Web 服务？这是完全可能的，Spring 是可选的。如果您不想使用，则不必使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T15:56:18.750

CXF 旨在与弹簧一起使用。很奇怪你想在没有它的情况下使用它。

您可以尝试 NoSpringServletServer 并使用 ServerFactoryBean 或 JaxWS API。

这是[NoSpringServletServer](http://svn.apache.org/repos/asf/cxf/trunk/systests/transports/src/test/java/org/apache/cxf/systest/servlet/NoSpringServletServer.java)的代码。

但是您*仍然*需要 spring 作为依赖项。基本的 JaxWS 可以在没有 spring 的情况下完成。但是对于几乎任何其他东西，您至少需要 spring-core.jar

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-27T14:18:50.750

我认为在 Tomcat 中完全独立于 spring 使用 CXF 是不可能的。

原因是当我为最低限度的 CXF webservice 做一个 Maven 依赖树列表 (mvn dependency:tree) 时，列出了以下内容（这表明它需要 Spring）

```
 +- org.apache.cxf:cxf-rt-core:jar:2.2.2:compile
[INFO] |  |  +- com.sun.xml.bind:jaxb-impl:jar:2.1.9:compile

[INFO] |  |  +- org.springframework:spring-core:jar:2.5.5:compile

[INFO] |  |  +- org.apache.geronimo.specs:geronimo-javamail_1.4_spec:jar:1.6:compile

    org.apache.cxf:cxf-rt-transports-http:jar:2.2.2:compile
[INFO]    \- org.springframework:spring-web:jar:2.5.5:compile

[INFO]       +- commons-logging:commons-logging:jar:1.1.1:compile 
```

# java - 如何在 websphere 6.1 中为 ear 配置类加载器（特别是 wsdl4j）

> ID：689904
> 
> 赞同：2
> 
> 时间：2009-03-27T14:12:22.307
> 
> 标签：java, ant, websphere

我有一个 war 文件（实际上不是我自己的，它是 Apache ODE 1.2），由于类加载器问题以及与 wsdl4j 的特定不兼容而无法部署到 WAS 6.1。如果我手动编辑 ODE 的类加载器并为 wsdl4j1.6.1 创建一个共享库，一切都很好。

但是，客户回来说这是不可接受的，我应该提供一个独立安装的耳朵，不涉及手动步骤。

我已经能够构建捆绑战争的耳朵文件，但我找不到任何有关如何在耳朵中包含共享库的相关信息 - 并且在类加载器的开头使用它（需要优先考虑wsdl4j 与 WAS 捆绑在一起）。我需要修改ear 文件结构吗？还是application.xml？

任何人都可以提供任何帮助吗？正如您可能猜到的，我来自“tomcat 只需要一个战争文件”背景，努力掌握耳朵文件。

我的 application.xml 只包含： http://java.sun.com/xml/ns/j2ee/application_1_4.xsd"> XXX ODE ode.war ode 等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T17:49:41.300

您只需三个简单的步骤即可完成此操作

1.  将jar文件放在ear中，我们一般会创建一个lib目录，但这不是必须的。
2.  更新战争清单以包含此 jar 文件。
3.  将您耳朵的类加载策略设置为 PARENT_LAST。这是在服务器加载本地类之前加载本地（耳朵）类所必需的。

编辑：作为替代方案，因为您仅使用 EAR 来包装 WAR 而实际上并未共享 jar 文件。

1.  将jar 放在WAR 的lib 目录中。
2.  将您耳朵的类加载策略设置为 PARENT_LAST。这是在服务器加载本地类之前加载本地（耳朵）类所必需的。我通过 RAD 编辑 application.xml 文件来做到这一点。它是 IBM 特定的配置，因此如果您不使用 RAD，您将必须弄清楚要手动更改哪些文件。

这应该会让您在应用服务器之间发生持续的战争。

# sql - SQL：仅检索值已更改的记录

> ID：689912
> 
> 赞同：6
> 
> 时间：2009-03-27T14:14:36.077
> 
> 标签：sql, sql-server

抱歉标题不详。我会在我们进行时进行编辑。

我有一张桌子`RateTable`：

```
| Code   |  Date     |   Rate  |

  B001     2009-01-01   1.05
  B001     2009-01-02   1.05
  B001     2009-01-03   1.05
  B001     2009-01-04   1.05
  B001     2009-01-05   1.06
  B001     2009-01-06   1.06
  B001     2009-01-07   1.06
  B001     2009-01-08   1.07 
```

每天都有一个条目，但费率很少改变。我可以编写一个只返回发生 Rate 更改的行的 SQL 查询吗？我正在使用 SQLServer

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-27T14:18:05.460

如果我没看错的话，您不是在寻找修改后的行，而是在寻找汇率从前一个日期发生变化的行。这个查询或类似的东西应该这样做：

```
SELECT  r1.Code, r1.Date, r1.Rate
FROM    RateTable r1
WHERE   r1.Rate <> (SELECT TOP 1 Rate
                   FROM    RateTable
                   WHERE   Date < r1.Date
                   ORDER BY Date DESC) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T14:49:12.530

如果您的 RDBMS 支持分析函数，那么几乎可以肯定最佳方法是：

```
select code, date, rate, last_rate
from
(
select code,
       date,
       rate,
       lag(rate) over (partition by code order by date) last_rate
from   ratetable
) my_tb
where  my_tb.rate != my_tb.last_rate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:16:28.163

添加一个新列，该列将是 DateTime 并跟踪汇率何时发生变化。然后您可以返回 DateModified >= x...的任何列...其中 x 是您最后一次检查的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T14:16:41.797

我会将 [ModifiedDate] 列添加到您的表中，并在每次插入或更新新记录时更新它的值。然后您将能够根据该列从表中获取数据：

```
SELECT * FROM [YourTable] WHERE [ModifiedDate] > '2008-01-20 10:20' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T14:17:49.517

如果您添加一个新列“LastChangedDate”并跟踪另一个表中的最后一次读取（即 LastReadedValues），那么您可以轻松跟踪更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T14:21:53.813

如果您此时可以控制这一点，我会建议您仅使用正确的预订数据。换句话说，只在汇率发生变化时向表中写入一条记录。然后，您可以假设更改之间的任何数据都将保持不变。这将大大减少您需要存储的数据量。

也就是说，这个查询，或者类似的东西，可以完成你所要求的：

```
select rt.Code, MIN(rt.Date), rt.Rate
from RateTable rt
group by rt.Code, rt.Rate 
```

**编辑**：对不起，将最大值更改为最小值

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T14:26:13.130

这种方法怎么样？

添加一个名为 ChangedSinceLastRead 的位列，每当您更改此表中的值并在您的选择查询中读取“SELECT * FROM Rate WHERE ChangedSinceLastRead = 1”时，将其设置为 1

在此选择查询之后触发另一个查询“UPDATE Rate SET ChangedSinceLastRead = 0”

尽管您必须对此触发 1 个额外的更新查询，但您不必根据选择中的日期进行计算，并且您的表存储占用的空间更少（因为位小于日期时间）

只是解决这个问题的另一种方法;-) 我很想看看这个以及上面建议的日期时间方法的性能影响

# user-interface - UI 元素命名

> ID：689918
> 
> 赞同：0
> 
> 时间：2009-03-27T14:15:30.100
> 
> 标签：user-interface, naming-conventions

您对用户界面元素（包括对话框）使用什么命名约定？

控件：我使用 [描述性名称][控件类型]（例如 OKButton、MainTableLayout）
Windows：我使用 [描述性名称]Window（例如 SearchWindow、CustomerListWindow）

有时，如果控件类型名称仍然清晰易读，我会缩短它（“Grid”而不是“DataGridView”）

你的约定是什么，为什么要使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:21:02.237

我的约定与您的几乎相同。我在名称中包含类型的原因是表明它是我们正在谈论的 UI 对象，而不是有形的东西。例如。UI 按钮不是真实世界的按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:24:02.527

我做的和你差不多，除了我使用 3-4 个字母的缩写，比如 Btn 和 Lbl 来控制。

我使用它们只是为了方便和可维护性，因此当 Intellisense 弹出时，我可以立即选择我想要的选项，例如 FirstNameTbx 而不是属性 FirstName。从长远来看，它并没有节省太多时间，但它仍然有帮助，而且与我一起工作的大多数人都希望它无论如何都是这样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:24:56.190

我使用了匈牙利符号（btnOK、grdCustomers 等）和一个稍微不同的版本，其中一切都只是 ui（uiOK、uiCustomers）。

我喜欢将类型放在前面，因为在使用 IDE 时，您可以快速输入诸如“ui”的“btn”之类的内容，它会过滤到您的 ui 元素。

一方面，我更喜欢“ui”方法而不是匈牙利语，因为我背后的代码不应该真正关心我的元素是什么类型。另外，如果我将 grdCustomers 更改为列表 (lstCustomers)，我必须更改很多代码。

另一方面，为所有内容添加“ui”前缀的缺点是您会得到很多重复项（您有一个用于客户名称的文本框和一个用于该文本框的标签，机器人将类似于 uiCustomer）。

# sql-server - SQL Server 中的 IGNORE_DUP_KEY 选项

> ID：689929
> 
> 赞同：4
> 
> 时间：2009-03-27T14:16:44.947
> 
> 标签：sql-server, ado.net, unique

我在 MSDN 和 Google 中进行了相当多的搜索，但看起来 IGNORE_DUP_KEY 选项的描述非常有限。

我的困惑，

1.  IGNORE_DUP_KEY 选项是列的选项吗？一张桌子？几列？索引（使索引唯一）？

2.  如果将 IGNORE_DUP_KEY 设置为 Yes，当插入一批具有重复键的记录（使用批量插入 WriteToServer ADO.Net 函数）时（例如，我插入一些数据库中已经存在的值），SQL Server 不会抛出错误。批处理作业将成功完成，但不会插入重复的行。将插入所有其他行，SQL Server 将其视为作业成功。我的理解正确吗？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T14:48:56.993

IGNORE_DUP_KEY is an option of CREATE INDEX and only affects inserts of multiple rows:

IGNORE_DUP_KEY = ON

*   all unique rows get inserted, a warning is issued, and the duplicate rows are not inserted

IGNORE_DUP_KEY = OFF

*   an error is issued and no rows are inserted

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T14:21:02.550

1.  IGNORE_DUP_KEY 用于给定的唯一索引。

2.  “取消后，任何当时处于活动状态的事务都可以继续进行，就好像更新或插入从未发生过一样。非重复密钥被正常插入。” 所以是的，批量插入将报告成功。

# version-control - 原型和实际实现的源代码控制结构

> ID：689933
> 
> 赞同：0
> 
> 时间：2009-03-27T14:17:45.070
> 
> 标签：version-control, prototype

我们应该如何用原型+应用程序的“真实”实现来构建源代码控制项目？

我们为一个新项目制作一个原型，并将其存储在源代码控制（Subversion，但问题应该独立于此）中，在我们所有项目的主存储库中具有以下结构：

```
[项目名]/
  树干/
    源/
      UIPrototype/
  分支机构/
  标签/

```

我们与一名实习生一起从事领域逻辑的设计工作，我们计划在下周开始实施领域逻辑。

我们考虑了以下几种可能性：

*   一个完全独立的存储库（实习生在源代码控制/Subversion 方面有几周的经验）

*   我们主存储库中的一个单独项目

*   `branches/prototype`原型的现有项目下的分支（例如），然后`trunk`用于“实际”实现

对于这种情况，您会推荐什么结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T14:29:48.660

在拥有多个程序的大型软件部门担任 SCM 经理几年后，我的建议是建立一个分支，原因如下：

1.  如果原型不工作，你可以让分支在那个时候死掉。

2.  如果原型有效，那么您可以将其合并回主干以进行初级开发

3.  如果需要开始主要项目的工作，您可以继续处理原型

Subversion 非常适合处理所有这些场景。您还可以使用标签来帮助控制您的代码。这些应该尽可能具有描述性，以便任何追随您的人都可以轻松确定代码的用途。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:23:07.180

我们所做的是有一个单独的存储库，称为原型，我们将所有的测试/播放/实验/原型项目放在其中。如果有什么值得的，我们会将它移到它自己的存储库中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:30:31.967

我们有一个应用程序树，并且有标有“内部”的目录，表示不打算装运的东西。原型和内部工具都可以通过这种方式开发。此外，当我们根据从原型中学到的知识开始下一代“实时”项目时，原型代码总是便于参考。

# java - 基于 Java 的监控应用程序

> ID：689939
> 
> 赞同：1
> 
> 时间：2009-03-27T14:18:36.440
> 
> 标签：java, frameworks, statistics, monitoring

想象下一个架构：

1.  我们有基于 Spring 框架的 Java 应用程序（我们称之为 Manager）。
2.  它接受请求并可以启动其他应用程序来处理它们（我们称它们为容器）。这些容器存在很长时间。它们的结构相当复杂，由几个不同的应用程序组成，但它们有控制部分，用 C++ 和 bash 脚本编写。8 个 CPU 内核上的预期数量约为 2000。
3.  我们有监控 Heartbeat 应用程序（还有 Java over Spring）。数据应该以某种方式从这些容器（关于 CPU、内存、带宽使用、版本）以及从管理器和聚合中获取。Heartbeat 会定期将聚合数据发送到更远的地方。

你对实施这样的事情有什么建议？请从您的经验中指出一些解决类似问题的框架或开源代码或一些一般性考虑。

[更新]

*   目标操作系统：Solaris
*   提到的 2000 个进程是本机应用程序。每个都有自己的 chroot 并以单独的用户身份登录运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:31:41.120

我最初的想法不是管理/监控方面，而是使用 Java 管理器在您的一台机器上启动 2,000 个不同的进程。这些消耗多少内存？它们是否同时运行？如果它们是不同的实现，机器可以利用共享库等来减少内存消耗。

然后Java进程必须读取/处理进程stdout/stderr（通常您在每个流的线程中执行此操作，以防止阻塞-如果您有2,000个使用此机制的进程，那么您正在查看4000个线程）。

因此，在查看可管理性之前，我会首先考虑此架构并在多台机器和 VM 上扩展此架构。

为了得到你的 CPU/内存等。我会看看[JMX](http://java.sun.com/j2se/1.5.0/docs/guide/management/overview.html)和提供的 bean。JMX 提供了通过 RMI 等公开此数据的方法。但是要获取每个子进程（用您的话说是容器）的此信息将需要特定于操作系统的信息。你在什么操作系统上？对于 Windows，请查看[WMI](http://msdn.microsoft.com/en-us/library/aa394582.aspx)。在 Unix/Linux 上，各种`/proc`文件系统节点可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T01:18:13.593

Maybe you can find something helpful on the Nagios Page ([http://www.nagios.org/](http://www.nagios.org/))

# c# - C#中具有多维键的哈希表

> ID：689940
> 
> 赞同：69
> 
> 时间：2009-03-27T14:18:43.663
> 
> 标签：c#, dictionary, hashtable

我基本上是在寻找一种在 c# 中使用二维类型键访问哈希表值的方法。

最终我将能够做这样的事情

```
HashTable[1][false] = 5;
int a = HashTable[1][false];
//a = 5 
```

这是我一直在尝试的……没有奏效

```
Hashtable test = new Hashtable();
test.Add(new Dictionary<int, bool>() { { 1, true } }, 555);
Dictionary<int, bool> temp = new Dictionary<int, bool>() {{1, true}};
string testz = test[temp].ToString(); 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-27T14:25:15.347

我认为更好的方法是将多维键的许多字段封装到一个类/结构中。例如

```
struct Key {
  public readonly int Dimension1;
  public readonly bool Dimension2;
  public Key(int p1, bool p2) {
    Dimension1 = p1;
    Dimension2 = p2;
  }
  // Equals and GetHashCode ommitted
} 
```

现在您可以创建和使用普通的 HashTable 并将此包装器用作 Key。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2017-10-19T12:11:00.750

您现在可以在 C# 7.0 中使用新的元组执行此操作：

```
// Declare
var test = new Dictionary<(int, bool), int>();

// Add
test.Add((1, false), 5);

// Get
int a = test[(1, false)]; 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-03-27T14:25:21.540

如何使用具有某种元组结构的常规字典作为键？

```
public class TwoKeyDictionary<K1,K2,V>
{
    private readonly Dictionary<Pair<K1,K2>, V> _dict;

    public V this[K1 k1, K2 k2]
    {
        get { return _dict[new Pair(k1,k2)]; }
    }

    private struct Pair
    {
        public K1 First;
        public K2 Second;

        public override Int32 GetHashCode()
        {
            return First.GetHashCode() ^ Second.GetHashCode();
        }

        // ... Equals, ctor, etc...
    }
} 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-27T14:24:01.903

我认为这可能更接近您正在寻找的...

```
var data = new Dictionary<int, Dictionary<bool, int>>(); 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-04-05T05:24:58.623

以防万一最近有人在这里，如其中一位评论者所述，如何在 .Net 4.0 中以快速而肮脏的方式执行此操作的示例。

```
class Program
{
  static void Main(string[] args)
  {
     var twoDic = new Dictionary<Tuple<int, bool>, String>();
     twoDic.Add(new Tuple<int, bool>(3, true), "3 and true." );
     twoDic.Add(new Tuple<int, bool>(4, true), "4 and true." );
     twoDic.Add(new Tuple<int, bool>(3, false), "3 and false.");

     // Will throw exception. Item with the same key already exists.
     // twoDic.Add(new Tuple<int, bool>(3, true), "3 and true." );

     Console.WriteLine(twoDic[new Tuple<int, bool>(3,false)]);
     Console.WriteLine(twoDic[new Tuple<int, bool>(4,true)]);
     // Outputs "3 and false." and "4 and true."
  }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-27T15:43:05.817

我建议对 jachymko 的解决方案稍作改动，这样您就可以避免为密钥对创建一个类。相反，包装一个私有字典，如下所示：

```
public class MultiDictionary<K1, K2, V>
{
    private Dictionary<K1, Dictionary<K2, V>> dict = 
        new Dictionary<K1, Dictionary<K2, V>>();

    public V this[K1 key1, K2 key2]
    {
        get
        {
            return dict[key1][key2];
        }

        set
        {
            if (!dict.ContainsKey(key1))
            {
                dict[key1] = new Dictionary<K2, V>();
            }
            dict[key1][key2] = value;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-27T14:53:39.197

您需要一个正确`Dictonary`实现的关键类。`GetHashCode`并且您可以扩展`Dictonary`以让您以友好的方式访问它。

`KeyPair`班级：

```
public class KeyPair<Tkey1, Tkey2>
{
    public KeyPair(Tkey1 key1, Tkey2 key2)
    {
        Key1 = key1;
        Key2 = key2;
    }

    public Tkey1 Key1 { get; set; }
    public Tkey2 Key2 { get; set; }

    public override int GetHashCode()
    {
        return Key1.GetHashCode() ^ Key2.GetHashCode();
    }
    public override bool Equals(object obj)
    {
        KeyPair<Tkey1, Tkey2> o = obj as KeyPair<Tkey1, Tkey2>;
        if (o == null)
            return false;
        else
            return Key1.Equals(o.Key1) && Key2.Equals(o.Key2);
    }
} 
```

扩展`Dictonary<>`：

```
public class KeyPairDictonary<Tkey1, Tkey2, Tvalue> 
    : Dictionary<KeyPair<Tkey1, Tkey2>, Tvalue>
{
    public Tvalue this[Tkey1 key1, Tkey2 key2]
    {
        get
        {
            return this[new KeyPair<Tkey1, Tkey2>(key1, key2)];
        }
        set
        {
            this[new KeyPair<Tkey1, Tkey2>(key1, key2)] = value;
        }
    }
} 
```

你可以像这样使用它：

```
KeyPairDictonary<int, bool, string> dict = 
    new KeyPairDictonary<int, bool, string>();

dict[1, false] = "test";
string test = dict[1, false]; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-27T14:24:36.363

我建议您创建一个小的自定义类来公开 bool 和 int 属性，并覆盖其 GetHashCode 和 Equals 方法，然后将其用作键。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-29T16:50:06.870

本质上，您需要使用嵌入式哈希表。如果您考虑一下您的问题，则具有两个键的哈希表是具有两个自变量的函数，并且`f(x,y)`根据定义是二维的。

但是您想像使用它一样使用它，而不是嵌入哈希表。因此，您需要做的是创建一个对象，该对象包含该嵌入式哈希表的想法并像单个哈希一样操作。

一些障碍：

*   您想对其进行迭代，因此您需要覆盖该`GetEnumerator()`方法。而且您需要自己的迭代器，它将在二维中正确迭代。
*   您需要进行更多检查以确保没有重复项。

我已经包含了我的代码来做到这一点：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;
using System.Windows.Forms;

namespace YourProjectNameHere
{
    public class Hashtable2D
    {
        /// <summary>
        /// This is a hashtable of hashtables
        /// The X dim is the root key, and the y is the internal hashes key
        /// </summary>
        /// 
        private Hashtable root = new Hashtable();
        public bool overwriteDuplicates = false;
        public bool alertOnDuplicates = true;

        public void Add(object key_x, object key_y, object toStore)
        {
            if(root[key_x]!=null)//If key_x has already been entered 
            {
                Hashtable tempHT = (Hashtable)root[key_x];//IF the hash table does not exist then focus will skip to the catch statement
                if (tempHT[key_y] == null)  tempHT.Add(key_y, toStore);
                else handleDuplicate(tempHT, key_y, toStore);
            }else{//Making a new hashtable 
                Hashtable tempHT = new Hashtable();
                tempHT.Add(key_y, toStore);
                root.Add(key_x, tempHT);
            }

        }

        public void Remove(object key_x, object key_y)
        {
            try{
                ((Hashtable)root[key_x]).Remove(key_y);
            }catch(Exception e){
                MessageBox.Show("That item does not exist");
            }

        }

        public void handleDuplicate (Hashtable tempHT, object key_y, object toStore)
        {
            if (alertOnDuplicates) MessageBox.Show("This Item already Exists in the collection");

            if (overwriteDuplicates)
            {
                tempHT.Remove(key_y);
                tempHT.Add(key_y,toStore);
            }
        }

        public object getItem(object key_x, object key_y)
        {
            Hashtable tempHT = (Hashtable)root[key_x];
            return tempHT[key_y];
        }

        public ClassEnumerator GetEnumerator()
        {
            return new ClassEnumerator(root);
        }

        public class ClassEnumerator : IEnumerator
        {
            private Hashtable ht;
            private IEnumerator iEnumRoot;
            private Hashtable innerHt;
            private IEnumerator iEnumInner;

            public ClassEnumerator(Hashtable _ht)
            {
                ht = _ht;
                iEnumRoot = ht.GetEnumerator();

                iEnumRoot.MoveNext();//THIS ASSUMES THAT THERE IS AT LEAST ONE ITEM

                innerHt = (Hashtable)((DictionaryEntry)iEnumRoot.Current).Value;
                iEnumInner = innerHt.GetEnumerator();
            }

            #region IEnumerator Members

            public void Reset()
            {
                iEnumRoot = ht.GetEnumerator();
            }

            public object Current
            {
                get
                {
                    return iEnumInner.Current; 
                }
            }

            public bool MoveNext()
            {
                if(!iEnumInner.MoveNext())
                {
                    if (!iEnumRoot.MoveNext()) return false;
                    innerHt = (Hashtable)((DictionaryEntry)iEnumRoot.Current).Value;
                    iEnumInner = innerHt.GetEnumerator();
                    iEnumInner.MoveNext();
                }
                return true;
            }

            #endregion
        }

    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-27T14:25:02.167

您可能能够“双重嵌套”您的哈希表 - 换句话说，您的主 Dictionary 是 type `Dictionary<int, Dictionary<bool, my_return_type>>`。

这实现了您能够在第一个代码片段中使用双括号表示法的目标。

当然，管理方面有点棘手。每次添加条目时，需要测试主字典是否包含主键字典，如果没有则添加新字典，然后将辅助键和值添加到内部字典中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-27T14:25:38.733

你能用一个`Dictionary<KeyValuePair<int,bool>,int>`吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-27T14:28:44.700

将您的二维密钥包装在一个单独的文件中`type`并将该类型用作密钥。还要考虑覆盖`GetHashCode()`和`Equals()`方法。最好使用`Dictionary<>`而不是`HashTable`因为显然你可以使用它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-27T14:30:39.470

一种快速而肮脏的方法是从两条信息中创建一个复合键，例如

```
IDictionary<string, int> values = new Dictionary<string, int>();
int i = ...;
bool b = ...;
string key = string.Concat(i, '\0', b);
values[key] = 555; 
```

为了更好地封装这一点，您可以包装字典：

```
public class MyDict
{
    private readonly IDictionary<string, int> values = new Dictionary<string, int>();

    public int this[int i, bool b]
    {
        get
        {
            string key = BuildKey(i, b);
            return values[key];
        }

        set
        {
            string key = BuildKey(i, b);
            values[key] = value;
        }
    }

    private static string BuildKey(int i, bool b)
    {
        return string.Concat(i, '\0', b);
    }
} 
```

为了使它更健壮，将复合键封装为一种类型，例如包含两个字段的类，确保您正确覆盖 Equals() 和 GetHashCode() 方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-13T18:12:25.517

看，这段代码工作得很好：

```
 public Form1()
    {
            InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

        this.Services = new Dictionary<object, Hashtable>();
        this.Services.Add("array1", new Hashtable());

        this.Services["array1"]["qwe"] = "123";
        this.Services["array1"][22] = 223;

        object zz = null;
        zz = this.Services["array1"]["qwe"];
        MessageBox.Show(zz.ToString()); // shows qwe

        zz = this.Services["array1"][22];
        MessageBox.Show(zz.ToString()); // shows 22
    } 
```

现在我们只需要一个包装器来避免手动执行此操作。Services.Add("array1", new Hashtable());

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-08-09T18:00:03.913

我认为现在最简单的方法是使用 Tupple.Create 和 ValueTuple.Create：

```
> var k1 =  Tuple.Create("test", int.MinValue, DateTime.MinValue, double.MinValue);
> var k2 = Tuple.Create("test", int.MinValue, DateTime.MinValue, double.MinValue);
> var dict = new Dictionary<object, object>();
> dict.Add(k1, "item");
> dict.Add(k2, "item");
An item with the same key has already been added....
> dict[k1] == dict[k2]
true 
```

或使用新的 c#7 元组语法来创建元组键：

```
var k = (item1: "value1", item2: 123); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-18T14:32:28.243

这是我的嵌套字典实现：

```
public class TwoKeysDictionary<K1, K2, T>:
        Dictionary<K1, Dictionary<K2, T>>
{
    public T this[K1 key1, K2 key2]
    {
        get => base.ContainsKey(key1) && base[key1].ContainsKey(key2) ? base[key1][key2] : default;
        set
        {
            if (ContainsKey(key1) && base[key1].ContainsKey(key2))
                base[key1][key2] = value;
            else
                Add(key1, key2, value);
        }
    }

    public void Add(K1 key1, K2 key2, T value)
    {
        if (ContainsKey(key1))
        {
            if (base[key1].ContainsKey(key2))
                throw new Exception("Couple " + key1 + "/" + key2 + " already exists!");
            base[key1].Add(key2, value);
        }
        else
            Add(key1, new Dictionary<K2, T>() { { key2, value } });
    }

    public bool ContainsKey(K1 key1, K2 key2) => ContainsKey(key1) && base[key1].ContainsKey(key2);
} 
```

# c# - 使用存储过程最优雅的方式是什么？

> ID：689943
> 
> 赞同：8
> 
> 时间：2009-03-27T14:20:16.577
> 
> 标签：c#, sql, stored-procedures

我正在我的存储库类中重写内联 SQL 以改用存储过程（安全要求）。在过去使用 Fluent NHibernate 和 Linq2Sql 之后，我发现它非常笨拙和不优雅。

**编辑**：澄清一下，我不是在寻找适用于存储过程的 ORM 解决方案。我只是想要一些关于编写下面代码的好方法的建议。

是否有任何策略可以使这种代码尽可能优雅？

```
 string commandText = "dbo.Save";

        using (SqlConnection sql = new SqlConnection(_connString.ConnectionString))
        using (SqlCommand cmd = sql.CreateCommand())
        {
            cmd.CommandText = commandText;
            cmd.CommandType = CommandType.StoredProcedure;

            SqlParameter idParam = new SqlParameter("identity", item.Identity);
            idParam.Direction = ParameterDirection.Input;

            SqlParameter nameParam = new SqlParameter("name", item.Name);
            nameParam.Direction = ParameterDirection.Input;

            SqlParameter descParam = new SqlParameter("desc", item.Description);
            descParam.Direction = ParameterDirection.Input;

            SqlParameter titleParam = new SqlParameter("title", item.)
            descParam.Direction = ParameterDirection.Input;

            //SNIP More parameters

            cmd.Parameters.Add(idParam);
            cmd.Parameters.Add(descParam);
            cmd.Parameters.Add(titleParam);
            //SNIP etc

            sql.Open();

            cmd.ExecuteNonQuery();

            //Get out parameters
        }

        return item; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-27T14:29:39.767

在我们的内部应用程序中，我们通常使用 SqlHelper 类，该类可在以下链接（下载和说明）中找到：http: [//www.microsoft.com/downloads/details.aspx? familyid=f63d1f0a-9877-4a7b-88ec- 0426b48df275&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=f63d1f0a-9877-4a7b-88ec-0426b48df275&displaylang=en)

本质上，SqlHelper 类消除了声明连接对象、命令等的一些需要，并允许您调用方法来返回对象，例如 DataSet

然后，您可以这样使用 SqlHelper：

```
public static int UpdateItem(int parameter1, int parameter2, string parameter3)
    {
        SqlParameter[] arParam = new SqlParameter[3];
        arParam[0] = new SqlParameter("@Parameter1", lotId);
        arParam[1] = new SqlParameter("@Parameter2", saleId);
        arParam[2] = new SqlParameter("@Parameter3", lotNumber);

        return int.Parse(SqlHelper.ExecuteScalar(connString, CommandType.StoredProcedure, "spName", arParam).ToString(), CultureInfo.InvariantCulture);
    } 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T14:33:23.223

[获取Enterprise Library](http://msdn.microsoft.com/en-us/library/dd203099.aspx)的副本。它是 ADO 的一个很好的包装器。例如：

```
using System.Data.Common;
using System.Globalization;
using Microsoft.Practices.EnterpriseLibrary.Data;

Database db = DatabaseFactory.CreateDatabase(DatabaseType.MyDatabase.ToString());

using (DbCommand dbCommand = db.GetStoredProcCommand("dbo.MyStoredProc")) {
    db.AddInParameter(dbCommand, "identity", DbType.Int32, item.Identity);
    db.AddInParameter(dbCommand, "name", DbType.String, item.Name);
    db.AddInParameter(dbCommand, "desc", DbType.String, item.Description);
    db.AddInParameter(dbCommand, "title", DbType.String, item.Title);

    db.ExecuteNonQuery(dbCommand);
} // using dbCommand 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T15:12:24.267

我通常使用以下示例的一些变体，当然取决于环境：

**我在整个代码中调用的基本辅助方法**

```
public static SqlCommand CreateStoredProcCmd(string name, SqlConnection con)
{
    var cmd = new SqlCommand(name, con);
    cmd.CommandType = CommandType.StoredProcedure;
    return cmd;
}

public static void AddParams(this SqlCommand cmdObject, Params SqlParameter[] parameters)
{
  foreach(SqlParameter param in parameters)
  {
    cmdObject.Parameters.add(param);
  }
}

/* Any overloaded methods to create params receiving my param definitions 
in any manner that the usual new SqlParameter() constructor doesn't handle */
public static SqlParameter CreateSqlParam(string ParamName,
                                          SqlDbType ParamType,
                                          object value)
{
    return CreateSqlParam(ParamName, ParamType, ParameterDirection.Input, value);
}

public static SqlParameter CreateSqlParam(string ParamName, 
                                          SqlDbType ParamType, 
                                          ParameterDirection ParamDir)
{
    return CreateSqlParam(ParamName, ParamType, ParamDir, null;
}                          

public static SqlParameter CreateSqlParam(string ParamName, 
                                          SqlDbType ParamType, 
                                          ParameterDirection ParamDir,
                                          object value)
{
    var parm = new SqlParameter(ParamName, ParamType);
    parm.Direction = ParamDir;
    parm.Value = value;
    return parm;
} 
```

**现在这是我如何设置我的存储过程并优雅地添加我的所有参数**

```
public static string DoStuff()
{
    using (var oCon = new SqlConnection("MyConnectionString"))
    {
        oCon.Open();
        var oCmd = CreateStoredProcCmd("sp_Name", oCon).AddParams(
            CreateSqlParam("Param1", SqlDBType.Int, 3),
            CreateSqlParam("Param2", SqlDBType.VarChar, "Hello World"),
            CreateSqlParam("Param3", SqlDBType.VarChar, ParameterDirection.Output)
        );
        oCmd.Prepare();
        oCmd.ExecuteNonQuery();
        object outVal = oCmd.Parameters["Param3"];
        return null != outVal ? outVal.ToString() : String.Empty;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T14:22:58.037

您可以使用[SubSonic](http://subsonicproject.com/)作为您的类和存储过程之间的 ORM 层。这是一个基本的[例子](http://geekswithblogs.net/scottkuhl/archive/2006/12/08/100700.aspx)。Phil Haack 也有一篇很好的[文章](http://haacked.com/archive/2007/05/29/strongly-typed-stored-procedures-using-subsonic.aspx)。

[在另一个问题](https://stackoverflow.com/questions/687762/which-orm-is-the-best-when-using-stored-procedures)中有一些很好的信息。

编辑：由于您已更新问题以表明您不想使用 ORM，因此 SubSonic 不适合您。但是，我会将答案留给其他使用存储过程的人。:) 您还应该看看是否有可能使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T14:25:32.697

您可以通过从 SqlParameter 派生您自己的 InputSqlParameter 并在构造函数中将方向设置为 Input 来将行数减半。

那会让你写

```
 cmd.Parameters.Add(new InputSqlParameter("title", item.title));
    cmd.Parameters.Add(new InputSqlParameter("property", item.property)); 
```

这显示了一个模式，并允许您设置参数名称和项目字段的列表，并在**for**循环中添加参数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-27T14:33:34.970

我建议使用 Microsoft Application Blocks SqlHelper 对象。

对于您上面列出的声明，我可以执行以下操作。

```
SqlHelper.ExecuteNonQuery(_connectionString, "MyProcName", 1, "NameValue", "Description", "Title"); 
```

基本上 SQL Helper 需要一些参数。

1.  连接到数据库的连接字符串
2.  存储过程的名称
3.  参数值数组，按照它们在存储过程中出现的顺序排列。

与显式创建每个参数相比，这种方法有一个非常轻微的性能缺陷，但时间节省通常超​​过它，因为它太小了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-27T15:22:13.683

为了使代码不那么冗长，我总是使用添加参数

```
cmd.Parameters.AddWithValue("name", item.Name);
cmd.Parameters.AddWithValue("title", item.Title);
// and so on 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-27T15:29:00.000

输入是默认方向，您可以缩短参数添加，并且可能还想声明 SqlDBTypes...

```
cmd.Parameters.Add("identity", SqlDBType.???).Value = item.Identity;
cmd.Parameters.Add("desc", SqlDbType.???, ?size?).Value = item.Description;
cmd.Parameters.Add("title", SqlDBType.???, ?size?).Value = item.Title;

//Output params generally don't need a value so...
cmd.Parameters.Add("someOut", SqlDBType.???).Direction = ParameterDirection.Output; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-27T14:27:08.543

将给定存储过程的每个参数保存在“数据类”中。使用注释来指定诸如“in”或“out”sproc 参数之类的东西。

然后您可以从客户端代码加载类，然后使用反射构建存储过程的所有参数，执行存储过程，并将输出参数加载回数据类。

稍微干净一点：输入一个类，输出一个类（即使有些是输入/输出）。这样一来（对于客户端代码）就很清楚哪些参数需要在输入的过程中填写，哪些会被返回。这也消除了对这些注释的需要。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-27T14:30:44.757

```
using (var conn = new SqlConnection(ConnectionString))
using (var cmd = conn.CreateCommand())
{
    cmd.CommandText = "[dbo].[Save]";
    cmd.CommandType = CommandType.StoredProcedure;

    cmd.Parameters.Add(new SqlParameter(
        "Identity", SqlDbType.Int) { Value = item.Identity });

    cmd.Parameters.Add(new SqlParameter(
        "Name", SqlDbType.NVarChar, 50) { Value = item.Name });

    cmd.Parameters.Add(new SqlParameter(
        "Title", SqlDbType.NVarChar, 100) { Value = item.Title });

    conn.Open();
    cmd.ExecuteNonQuery();
} 
```

**这是Ent Lib**的样子：

```
// Note, that you don't need to specify connection string here,
// it will be automatically taken from a configuration file
var db = DatabaseFactory.CreateDatabase();

using (var cmd = db.GetStoredProcCommand("[dbo].[Save]"))
{
    db.AddInParameter(cmd, "Identity", DbType.Int32, item.Identity);
    db.AddInParameter(cmd, "Name", DbType.String, item.Name);
    db.AddInParameter(cmd, "Title", DbType.String, item.Title);
    db.ExecuteNonQuery(cmd);
} 
```

您还可以使用 Enterprise Library 中的 SqlHelper 方法来简化此语法。

```
SqlHelper.ExecuteNonQuery(connectinString,
     CommandType.StoredProcedure, "[dbo].[Save]", new SqlParameter[]
         {
             new SqlParameter("Identity", item.Identity),
             new SqlParameter("Name", item.Name),
             new SqlParameter("Title", item.Title)
         }); 
```

# c# - DeleteOnSubmit() 的 C# LINQ 状态

> ID：689948
> 
> 赞同：2
> 
> 时间：2009-03-27T14:21:24.390
> 
> 标签：c#, .net, linq, linq-to-sql

我正在开发用于创建、更改和删除酒店预订（预订）的网络服务。一个预订可以包含多次住宿（住宿是房间、订购的服务等之间的链接）。每次住宿都有自己的时间段，因此您可以在同一预订中创建 3 次住宿，为期 3 周。

当需要更改预订时，我的问题就出现了。输入是预订 ID（如上所示）以及所需住宿的新数据。因此，如果最初入住的是 2 间单人间和 1 间双人间，每间都有自己的开始和结束日期，而客户希望将其中一间单人间更改为双人间，他将发送：1 间单人间、2 间双人间和由我来弄清楚发生了什么变化（这不会改变，所以恐怕任何建议改变这一点的解决方案都已失效）。

我使用 LINQ 来挑选当前的停留并将它们设置为删除

```
var oldStays = (from stay in persistentStorage.DataContext.Stays 
                where stays.booking_id == bookingId 
                select stay);
persistentStorage.DataContext.Stays.DeleteAllOnSubmit(oldStays); 
```

但是，在我删除它们之前，我需要确保有可供新住宿使用的房间。一个简单的出路是如果 LINQ 在进行新查询时自动假定这些记录已删除（这意味着我不必担心日期、现有房间等）。如果是这样的话，问题就已经解决了。

如果没有，我需要某种方法来检查新的可用预订，同时忽略未更改的住宿（在上述情况下，我只需要检查在给定期间是否有双人房可用，因为另一个双和单已经预订）。LINQ 是否有一些聪明的方法可以帮助解决这个问题，如果有，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T14:39:58.590

您应该能够通过使用事务获得预期的行为：

*   创建交易
*   删除您的预订
*   检查新房间是否可用并预订
*   如果一切正常，提交
*   否则回滚事务

编辑 - 示例（使用 SQL 事务，您也可以使用 TransactionContext）：

```
try
{
  persistentStorage.DataContext.Transaction=persistentStorage.DataContext.Connection.BeginTransaction();

  var oldStays = (from stay in persistentStorage.DataContext.Stays 
                where stays.booking_id == bookingId 
                select stay);
  persistentStorage.DataContext.Stays.DeleteAllOnSubmit(oldStays);
  persistentStorage.DataContext.SubmitChanges();

  // do you select/insert/etc.

  if (ok)
    persistentStorage.DataContext.Transaction.Commit();
}
finally
{
  if (persistentStorage.DataContext.Transaction!=null) persistentStorage.DataContext.Transaction.Dispose();
  persistentStorage.DataContext.Transaction=null;
} 
```

# jquery - 当其他 div 动画完成时开始动画 div

> ID：689951
> 
> 赞同：1
> 
> 时间：2009-03-27T14:21:59.647
> 
> 标签：jquery, jquery-ui, animation, events, event-handling

我正在制作一个相当复杂的 jquery-to 动画，它根据不同的触发事件移动各种 div。为了简化我试图解决的场景是：

1.  我在屏幕上有 DIV 1 和 DIV 2
2.  DIV 1 需要从位置 A 动画到位置 B
3.  DIV 2 还需要从位置 C 动画到位置 D，但仅当 DIV 1 到达位置 B 时。

我应该怎么做这样的事情？

我在想我需要使用一种`trigger/event listener`机制，如果 DIV 2 进入睡眠状态，并且只有在 DIV 1 到达屏幕上的位置 B 时触发的事件才会唤醒。

这是我应该拥有的最好的心态吗？我如何使用 jQuery 来做到这一点。

非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T14:23:25.307

[animate](http://docs.jquery.com/Effects/animate#paramsdurationeasingcallback)函数允许您指定在动画完成时运行的回调：

```
$('#div1').animate({...}, 1000, 'linear', function() {
    $('#div2').animate({...}, 1000);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:24:22.590

jQuery 有一个接受回调的[animate 函数。](http://docs.jquery.com/Effects/animate#paramsdurationeasingcallback)在那里为 DIV 2 设置动画。

```
div1.animate({ ... }, 'slow', 'linear', function() {
    div2.animate({ ...}, ...);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T04:20:07.043

我最终提出了以下解决方案来解决我的情况：

```
div1.animate(
   {...},
   'complete' : function() {
      div2.trigger('myStartMove');
   }
);

div2.bind('myStartMove', function(ev){
   div2.animate(
      {...}
   );
}); 
```

我发现最好使用触发器而不是在完整回调中直接调用嵌套动画。对于我拥有的复杂动画，使我的编码更加清晰。

# c++ - 简单的跨平台 C++ GUI 控制台——如何？

> ID：689959
> 
> 赞同：0
> 
> 时间：2009-03-27T14:23:31.937
> 
> 标签：c++, user-interface, console, cross-platform, sdl

我正在写一个游戏，我最终需要一个控制台来进行简单的文本输入；文件名和简单值。

使用 SDL，我的控制台看起来最简单：

```
class   Console
{
public:
  typedef std::list<String> InputList;

  enum  Result
  {
    NOTHING = 0,
    ENTERED,
    ESCAPED
  };

  static const String&  GetInput()  { return input; }

  static Result Query(SDLKey lastKey)
  {
    if(lastResult == ENTERED || lastResult == ESCAPED)
    {
      input.clear();
    }

    switch (lastKey)
    {
    case    SDLK_a:
    case    SDLK_b:
    case    SDLK_c:
    case    SDLK_d:
    case    SDLK_e:
    case    SDLK_f:
    case    SDLK_g:
    case    SDLK_h:
    case    SDLK_i:
    case    SDLK_j:
    case    SDLK_k:
    case    SDLK_l:
    case    SDLK_m:
    case    SDLK_n:
    case    SDLK_o:
    case    SDLK_p:
    case    SDLK_q:
    case    SDLK_r:
    case    SDLK_s:
    case    SDLK_t:
    case    SDLK_u:
    case    SDLK_v:
    case    SDLK_w:
    case    SDLK_x:
    case    SDLK_y:
    case    SDLK_z:
    case    SDLK_0:
    case    SDLK_1:
    case    SDLK_2:
    case    SDLK_3:
    case    SDLK_4:
    case    SDLK_5:
    case    SDLK_6:
    case    SDLK_7:
    case    SDLK_8:
    case    SDLK_9:
    case    SDLK_SLASH:
    case    SDLK_BACKSLASH:
    case    SDLK_PERIOD:
    case    SDLK_COMMA:
    case    SDLK_SPACE:
    case    SDLK_UNDERSCORE:
    case    SDLK_MINUS:
        input += static_cast<char> (lastKey);
        lastResult = NOTHING;
        break;
    case    SDLK_RETURN:
        lastResult = ENTERED;
        break;
    case    SDLK_ESCAPE:
        lastResult = ESCAPED;
        break;
    }
    return lastResult;
  }

protected:
  static Result lastResult;
  static String input;
}; 
```

这将从应用程序的主事件循环中调用，如果控制台处于活动状态并且最后一个事件是按键，那么输入的结果将在必要的状态下进行处理。

当然，它看起来非常尴尬......有什么更好的方法来实现一个可以在我的游戏窗口中轻松呈现的简单控制台？（不要接近高度不可移植的解决方案，例如必须重新路由 std::cout 或编写代码以启动 UNIX 控制台等。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T16:33:28.597

我会提供的一个建议是在这种情况下使用 if 语句而不是 switch：

```
if(lastKey == SDLK_RETURN)
    lastResult = ENTERED;
else if(lastKey == SDLK_ESCAPE)
    lastResult = ESCAPED;
else if(lastKey >= SDLK_SPACE && lastKey <= SDLK_z)
{
    input += static_cast<char> (lastKey);
    lastResult = NOTHING;
} 
```

我冒昧地添加了一些您在上面的代码中没有的字符，例如与号、引号、括号、方括号等。如果您不想要这些键，您可以添加更多的 if 语句到再分解一下。

这假设键的枚举没有太大变化。如果它确实改变了很多，你可能会更好地利用你所拥有的。

# sql - 有人使用右外连接吗？

> ID：689963
> 
> 赞同：41
> 
> 时间：2009-03-27T14:24:24.600
> 
> 标签：sql

我一直使用 INNER JOIN 和 LEFT OUTER JOIN。但是，我似乎从来不需要 RIGHT OUTER JOIN。

我见过很多使用右连接的讨厌的自动生成的 SQL，但对我来说，这些代码是不可能让我理解的。我总是需要使用内连接和左连接来重写它来制作它的头部或尾部。

有人真的使用右连接编写查询吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-09-05T23:17:24.363

举一个`RIGHT JOIN`可能有用的例子。

假设有三个表，分别是 People、Pets 和 Pet Accessories。人们可以选择养宠物，这些宠物可以选择拥有配饰

```
CREATE TABLE Persons
  (
     PersonName VARCHAR(10) PRIMARY KEY
  );

INSERT INTO Persons
VALUES      ('Alice'),
            ('Bob'),
            ('Charles');

CREATE TABLE Pets
  (
     PetName    VARCHAR(10) PRIMARY KEY,
     PersonName VARCHAR(10)
  );

INSERT INTO Pets
VALUES      ('Rover',
             'Alice'),
            ('Lassie',
             'Alice'),
            ('Fifi',
             'Charles');

CREATE TABLE PetAccessories
  (
     AccessoryName VARCHAR(10) PRIMARY KEY,
     PetName       VARCHAR(10)
  );

INSERT INTO PetAccessories
VALUES      ('Ball', 'Rover'),
            ('Bone', 'Rover'),
            ('Mouse','Fifi'); 
```

如果要求获得列出所有人的结果，无论他们是否拥有宠物以及有关他们拥有的任何宠物的信息，这些宠物也有配件。

这**不起作用**（不包括 Bob）

```
SELECT P.PersonName,
       Pt.PetName,
       Pa.AccessoryName
FROM   Persons P
       LEFT JOIN Pets Pt
         ON P.PersonName = Pt.PersonName
       INNER JOIN PetAccessories Pa
         ON Pt.PetName = Pa.PetName; 
```

这**不起作用**（包括 Lassie）

```
SELECT P.PersonName,
       Pt.PetName,
       Pa.AccessoryName
FROM   Persons P
       LEFT JOIN Pets Pt
         ON P.PersonName = Pt.PersonName
       LEFT JOIN PetAccessories Pa
         ON Pt.PetName = Pa.PetName; 
```

这**确实有效**（但语法不太常见，因为它需要`ON`连续两个子句来实现所需的逻辑连接顺序）

```
SELECT P.PersonName,
       Pt.PetName,
       Pa.AccessoryName
FROM   Persons P
       LEFT JOIN Pets Pt
                  INNER JOIN PetAccessories Pa
                    ON Pt.PetName = Pa.PetName
         ON P.PersonName = Pt.PersonName; 
```

总而言之，可能最容易使用`RIGHT JOIN`

```
SELECT P.PersonName,
       Pt.PetName,
       Pa.AccessoryName
FROM   Pets Pt
       JOIN PetAccessories Pa
         ON Pt.PetName = Pa.PetName
       RIGHT JOIN Persons P
         ON P.PersonName = Pt.PersonName; 
```

尽管如果确定要避免这种情况，另一种选择是引入一个可以连接到的派生表

```
SELECT P.PersonName,
       T.PetName,
       T.AccessoryName
FROM   Persons P
       LEFT JOIN (SELECT Pt.PetName,
                         Pa.AccessoryName,
                         Pt.PersonName
                  FROM   Pets Pt
                         JOIN PetAccessories Pa
                           ON Pt.PetName = Pa.PetName) T
         ON T.PersonName = P.PersonName; 
```

SQL Fiddles：[MySQL](http://www.sqlfiddle.com/#!2/8ea6a/2)、[PostgreSQL](http://www.sqlfiddle.com/#!12/8ea6a/1)、[SQL Server](http://www.sqlfiddle.com/#!6/8ea6a/1)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-27T14:27:39.633

这取决于您将每个表放在联接的哪一侧。

如果你想返回左表中的所有行，即使右表中没有匹配项......你使用左连接。

如果要返回右表中的所有行，即使左表中没有匹配项，也可以使用右连接。

有趣的是，我很少使用右连接。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-27T14:26:46.670

您通常使用 RIGHT OUTER JOINS 在其他表中查找孤立项。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-27T14:26:00.137

不，我不这样做的原因很简单，我可以使用内连接或左连接来完成所有事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-27T14:47:42.877

我只使用 left，但我想说它们实际上是相同的，具体取决于您如何订购。我与一些只使用正确的人一起工作，因为他们从内到外构建查询并且喜欢将主要项目保留在底部，因此在他们看来，只使用正确是有意义的。

IE

重点在这里

需要更多垃圾

更多垃圾右外加入主要材料

我更喜欢做主要的事情而不是垃圾......所以离开外部为我工作。

所以无论什么漂浮你的船。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-27T14:27:50.333

我唯一一次使用右外连接是在我处理现有查询并需要更改它（通常从内部）时。我可以反转连接并使其左转，可能没问题，但我尝试减少修改代码时更改的内容数量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T14:27:26.933

我们这里的标准做法是尽可能使用 LEFT JOIN 来编写所有内容。如果需要，我们偶尔会使用 FULL OUTER JOIN，但从不使用 RIGHT JOIN。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-27T14:57:38.860

您可以使用 LEFT 或 RIGHT 连接来完成同样的事情。一般来说，大多数人认为左连接可能是因为我们从左到右阅读。这真的归结为保持一致。您的团队应该专注于使用 LEFT 或 RIGHT 连接，而不是两者，因为它们本质上是完全相同的东西，但写法不同。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-27T15:52:29.257

很少，如前所述，您通常可以重新排序并使用左连接。此外，我自然倾向于对数据进行排序，这样左连接就可以获取我需要的数据。我认为完全外部连接和交叉连接也是如此，大多数人倾向于远离它们。

# c# - 在 C# 中将 IntPtr 获取到 ulong 变量

> ID：689975
> 
> 赞同：0
> 
> 时间：2009-03-27T14:26:09.403
> 
> 标签：c#, interop, intptr, istream

我需要将一个 IntPtr 传递给 IStream.Read，并且 IntPtr 应该指向一个 ulong 变量。如何获得指向我的 ulong 变量的 IntPtr？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T14:31:04.523

如果你想避免不安全的代码，我相信你必须使用 GCHandle 方法。我不确定这如何与盒装值类型一起使用。

```
var handle = GCHandle.Alloc(myVar, GCHandleType.Pinned);
var ptr = handle.AddrOfPinnedObject() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T14:32:35.533

最好的方法是更改​​ IStream 定义：

```
void Read([Out, MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 1)] byte[] pv,
          int cb, /*IntPtr*/ ref int pcbRead); 
```

然后你可以写

```
int pcbRead = 0;
Read(..., ref pcbRead); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T14:32:01.463

如果您不能使用不安全的代码，请尝试以下操作。

```
var myValue = GetTheValue();
var ptr = Marshal.AllocHGLobal(Marshal.SizeOf(typeof(ulong));
Marshal.StructureToPointer(ptr, myValue, false); 
```

稍后，您将需要在“ptr”值上调用 Marshal.FreeHGlobal。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T14:28:21.520

```
var pointer = new IntPtr(&myVariable); 
```

# php - 多个mysqli连接问题

> ID：689977
> 
> 赞同：1
> 
> 时间：2009-03-27T14:26:29.213
> 
> 标签：php, mysql, mysqli

我在 mysqli 连接方面遇到了一些奇怪的问题。

我正在使用 mysqli 处理一个页面，并且它一整天都运行良好。然后我制作了这个页面的副本，并将其剥离以调试问题，并将其作为不同的文件进行测试。它在连接方面工作得很好。在尝试请求我正在处理的原始文件时，我收到错误：

> 用户 'user'@'localhost' 的访问被拒绝（使用密码：YES）

我不明白为什么。每次使用完连接后，我都关闭了连接，尽管我不明白为什么会出现问题。有趣的是，该文件的旧版本工作正常，尽管包含完全相同的连接细节和代码。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T14:39:13.020

把问题转过来。与其说两个版本（一个有效的一个和一个无效的）在重要方面是相同的，不如关注它们不同的方式，并尝试找出哪些差异也很重要。

制作工作版本的附加副本。验证它是否有效。尝试通过将尽可能多的更改一个一个地应用到此测试副本，使其成为非工作版本的副本，直到您拥有尽可能接近损坏版本但仍然有效的东西. 比较这两个，这应该会告诉你问题出在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T14:29:54.853

诡异的。如果您正在测试来自同一台机器的文件，它们应该可以工作（如果它们具有相同的代码）。

再次检查用户名和密码，即空格或奇怪的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T23:16:43.733

确保您的 IP 已添加到 MySQL 允许的连接列表中，同时确保您的密码正确。如果可能，请尝试提供完整的主机名而不是 localhost。

如果不成功，请发布您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T03:34:49.770

只是为了它，在工作副本和文件的旧版本之间运行一个差异。检查是否存在任何问题，例如：移动括号、变量名更改等。也许定义用户名和密码的代码部分永远不会运行！

如果您需要免费程序，请检查[WinDiff](http://www.grigsoft.com/download-windiff.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T17:19:19.110

如果你放：

```
error_reporting(E_ALL); 
```

作为您代码中的第一行，您是否在任一页面上都收到任何错误？可能有一些奇怪的事情，例如程序无法再打开包含文件。

* * *

您说将文件 A 复制到文件 B 意味着文件 A 不起作用。如果将文件 A 复制到文件 B，删除文件 A，然后将文件 B 复制到文件 A，会发生什么？

# java - 关于如何对网站进行会话证明的任何建议？

> ID：689989
> 
> 赞同：1
> 
> 时间：2009-03-27T14:29:17.243
> 
> 标签：java, session, tomcat, session-state

这可能是一个非常奇怪的问题，但一些提示或指南会很有帮助。我们要对我们的网站进行“会话证明”，基本上要确保两个不同的会话生成相同的链接结构（例如，用户 a 和用户 b 将在同一个网页中获得相同的链接）。

此测试背后的原因是，我们的网站是由内容管理解决方案生成的，该解决方案将为每个不同的会话生成不同的链接（URL）。该 CMS（内部构建）已修复为跨会话返回相同的链接。

会话证明的另一种[情况](https://stackoverflow.com/questions/683906/how-to-verify-that-squid-used-as-a-reversed-proxy-is-working)是，我们的缓存机制 (SQUID) 一直在向我们的网站提供 TCP_MISSes，这使我们认为整个网站都被标记为动态的，并且缓存服务器必须一直重新获取所有对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T14:33:04.363

您是否尝试验证两个不同的用户确实看到相同的结构？一种方法是使用 wget 之类的东西从两个不同的 IP 地址抓取整个网站，然后比较生成的树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-21T08:18:38.220

您可以尝试使用像[Pureload](http://www.minq.se/products/pureload/)这样的负载测试套件来模拟多个用户访问您的网站。Pureload 可以有多个并发模拟用户，每个用户都发出相同的请求，并确认结果符合预期。根据您的结果的动态程度，这可能会帮助您测试您的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T21:19:15.197

这就是我们在[amplafi.com 所做的](http://amplafi.com)

（h/t 请参阅web.xml 中的[http://randomcoder.com/articles/jsessionid-considered-harmful ）：](http://randomcoder.com/articles/jsessionid-considered-harmful)

```
<filter>
    <filter-name>DisableSessionIdsInUrlFilter</filter-name>
    <filter-class>
        com.amplafi.web.servlet.DisableSessionIdsInUrlFilter
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>DisableSessionIdsInUrlFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

这个java代码：

```
import java.io.IOException;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletResponseWrapper;
import javax.servlet.http.HttpSession;

/**
 * remove any session id from the Url.
 *
 *
 * Ideally we would like to only remove this container-provided functionality
 * only for public portions of the web site (that can be crawled by google)
 * or for links that are to be bookmarked.
 *
 * @author Patrick Moore
 */
public class DisableSessionIdsInUrlFilter implements Filter {
    @Override
    public void destroy() {
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        if (!(request instanceof HttpServletRequest)) {
            chain.doFilter(request, response);
            return;
        }

        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        /*
         * Next, let's invalidate any sessions that are backed by a URL-encoded
         * session id. This prevents an attacker from generating a valid link.
         * Just because we won't be generating session-encoded links doesn't
         * mean someone else won't try
         */
        if (httpRequest.isRequestedSessionIdFromURL()) {
            HttpSession session = httpRequest.getSession();
            if (session != null) {
                session.invalidate();
            }
        }
        HttpServletResponseWrapper wrappedResponse = new ResponseWrapper(httpResponse);
        chain.doFilter(request, wrappedResponse);
    }

    @Override
    @SuppressWarnings("unused")
    public void init(FilterConfig arg0) throws ServletException {
    }

    /**
     * wraps response and prevense jsessionid from being encoded on the output.
     */
    private static class ResponseWrapper extends HttpServletResponseWrapper {

        ResponseWrapper(HttpServletResponse httpResponse) {
            super(httpResponse);
        }
        @Override
        public String encodeRedirectUrl(String uri) {
            return uri;
        }

        @Override
        public String encodeRedirectURL(String uri) {
            return uri;
        }

        @Override
        public String encodeUrl(String uri) {
            return uri;
        }

        @Override
        public String encodeURL(String uri) {
            return uri;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-13T08:30:11.700

为什么您的网址不同？您是否在其中存储会话 ID？

如果你是，你应该把它移到饼干上！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T02:59:39.637

如果您网站中的每个页面都有不同的链接，那么该网站的缓存肯定会被破坏。

您是否在询问如何验证每个会话的链接是否相同？或者您在问如何确保每个会话的链接相同？

对于前者，只需从两个不同的浏览器和用户登录浏览就足够了。

至于确保每个会话的链接都相同......这将取决于您指示的内部实施。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-09T14:56:36.937

您可以使用 selenium 在 Java 中编写测试。为您期望的数据添加断言。然后，您可以遍历多个登录列表以查看每个登录的测试通过。

Selenium 很容易上手，并且可以用多种语言编写测试。

有关详细信息，请参见此处：

[http://seleniumhq.org/projects/remote-control/](http://seleniumhq.org/projects/remote-control/)

一个示例测试将是这样的（伪代码）：

```
public void setUp() throws Exception {
    setUp("http://mywebsite.com", "*chrome"); // to run the test in opera replace chrome with opera
}

public void testLoginWithMultipleUsers() {
    for(loop over users) {
        runLogin(user)
    }
}

public void runLogin(User user) throws Exception {
    selenium.open("/login.htm");
    assertTrue(selenium.isTextPresent("Link1"));
    assertTrue(selenium.isTextPresent("2003-2008"));
    selenium.open("/account");
    assertTrue(selenium.isTextPresent("2003-2008"));
    selenium.waitForPageToLoad("30000");
    etc... 
```

Selenium 提供了许多方法来检查链接和其他页面元素是否存在，甚至可以将测试记录在浏览器中 - 试一试！

# css - 溢出隐藏父项内的中心图像

> ID：689991
> 
> 赞同：23
> 
> 时间：2009-03-27T14:29:41.187
> 
> 标签：css

我有一个跨度标签内的图像，跨度具有设定的宽度和高度，并设置为溢出隐藏。所以它只显示图像的一小部分。这可行，但可见图像的一小部分是左上角。我希望它成为可见图像的中心。我想我需要绝对定位图像，但图像的大小可能会有所不同。有谁知道怎么做我想做的事？

谢谢！

这是HTML：

```
<div class="lightbox_images">
                <h6>Alternate Views</h6>
                <span>
                    <a href="http://www.kranichs.com/mothers_rings/mothers_rings_txt2.jpg" rel="lightbox[product_alternate_views]" title="This is my captions 1">
                        <img src="http://www.kranichs.com/mothers_rings/mothers_rings_txt2.jpg" />
                    </a>
                </span>
                <span>
                    <a href="https://www.kranichs.com/product_images/Simon-G@346_M_346_M.jpg" rel="lightbox[product_alternate_views]" title="This is my captions 2">
                        <img src="https://www.kranichs.com/product_images/Simon-G@346_M_346_M.jpg" />
                    </a>
                </span>
                <span>
                    <a href="http://www.kranichs.com/images/simong/sim_banner_01.jpg" rel="lightbox[product_alternate_views]" title="This is my captions 3">
                        <img src="http://www.kranichs.com/images/simong/sim_banner_01.jpg" />
                    </a>
                </span>
                <span>
                    <a href="http://www.kranichs.com/images/psu/psu_banner.jpg" rel="lightbox[product_alternate_views]" title="This is my captions 4">
                        <img src="http://www.kranichs.com/images/psu/psu_banner.jpg" />
                    </a>
                </span>
            </div> 
```

这是CSS：

```
.lightbox_images{
    background-color:#F9F9F9;
    border:1px solid #F0F0F0;
}
.lightbox_images h6{
    font-family:Verdana, Arial, Helvetica, sans-serif;
    color:#333333;
    font-size:14px;
    font-weight:bold;
    font-style:italic;
    text-decoration:none;
    margin:0px;
}
.lightbox_images span{
    padding:5px;
    padding-bottom:15px;
    background-color:#DFDFDF;
    margin:5px;
    display:inline-block;
    border:1px solid #CCC;
}
.lightbox_images a{
    display:inline-block;
    width:60px;
    height:60px;
    overflow:hidden;
    position:relative;
}

.lightbox_images a img{
    position:absolute;
    left:-50%;
    top:-50%;
}

.lightbox_images span:hover{
    border:1px solid #BBB;
    background-color:#CFCFCF;
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-28T13:15:09.937

正如 Billy Moat 在[https://stackoverflow.com/a/14837947/2227298](https://stackoverflow.com/a/14837947/2227298)中提出的那样，有一个**不知道图像高度和宽度的解决方案。**

在这里试试：http: [//jsfiddle.net/LSKRy/](http://jsfiddle.net/LSKRy/)

```
<div class="outer">
    <div class="inner">
    <img src="http://3.bp.blogspot.com/-zvTnqSbUAk8/Tm49IrDAVCI/AAAAAAAACv8/05Ood5LcjkE/s1600/Ferrari-458-Italia-Nighthawk-6.jpg" alt="" />
    </div>
</div>

.outer {
    width: 300px;
    overflow: hidden;
}

.inner {
    display: inline-block;
    position: relative;
    right: -50%;
}

img {
    position: relative;
    left: -50%;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-27T14:37:30.560

鉴于这种 HTML：

```
<span><img src="..." width="..." height="..." alt="..." /></span> 
```

你可以像这样使用 CSS：

```
span {
  position: relative;
  display: block;
  width: 50px;  /* Change this */
  height: 50px; /* Change this */
  overflow: hidden;
  border: 1px solid #000;
}
span img {
  position: absolute;
  left: -10px; /* Change this */
  top: -10px;  /* Change this */
} 
```

然后，您可以根据其确切尺寸将图像居中。

或者，如果您能够修改 HTML，则可以改为使用以下内容：

```
<div>
  <a href="...">[name of picture]</a>
</div> 
```

然后，将它与这个 CSS 匹配：

```
div {
  width: 50px;
  height: 50px;
  background: transparent url(...) center center no-repeat;
  border: 1px solid #000;
}
div a {
  display: block;
  height: 100%;
  text-indent: -9999em; /* Hides the link text */
} 
```

在这种情况下，无论其尺寸如何，背景都会自动居中，并且仍然可以点击。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-03T16:51:02.613

**这个例子，图像位于元素的中心，不管它的大小**

HTML：

```
<div class="box">
    <img src="example.jpg">
</div> 
```

CSS：

```
div.box{
    width: 100px;
    height: 100px
    overflow: hidden;
    text-align: center;
}

div.box > img{
    left: 50%;
    margin-left: -100%;
    position: relative;
    width: auto !important;
    height: 100px !important;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T14:41:20.363

如果图像的宽度和高度不同，我认为唯一的方法是使用 javascript。

向左设置图像样式：50%；最高：50%；然后，使用javascript（可能是图像加载事件）添加margin-left：- *imageWidth* /2 px；边距顶部：- *imageHeight* /2 px；

所以基本上你有

```
span img {
    position: absolute;
    left: 50%;
    top: 50%;
} 
```

和下面的js

```
window.onload = function() {

  var images = document.getElementsByTagName('img');

  for(i=0; i<images.length; i++)
     images[i].onload = centerImage(images[i]);

  function centerImage(img) {
    img.style.marginLeft = -(img.width/2) + "px";
    img.style.marginTop = -(img.height/2) + "px";
  }

} 
```

PS。如果您使用的是 javascript 框架/库，则代码可以简化一点，但我没有做出这样的假设。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T14:39:02.320

您可以将图像设置为元素的背景并设置 x,y 轴，如下例所示：

```
#mySpan {
  background-image: url(myimage.png);
  background-repeat: no-repeat;
  background-attachment:fixed;
  background-position: -10 -10
} 
```

# proxy - 开放代理列表

> ID：689995
> 
> 赞同：2
> 
> 时间：2009-03-27T14:30:00.593
> 
> 标签：proxy

我们正在寻找一个开放代理列表，目的是禁止来自这些 IP 的消息通过我们的系统。网络上似乎没有任何类似于权威列表的东西，更不用说是不需要解析的简单格式。

以前有没有人做过这样的事情，如果有，你是怎么处理的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T14:36:51.560

你注定要失败——代理四处走动，不断变化。不可能有一个列表会包含大量的列表。还有像[tor](http://www.torproject.org/)这样的东西，它允许任何人成为隐藏用户网络的代理。

通常，为了应对这种情况，您可以将服务器设置为拒绝访问因流量过多而影响您的 IP，或者其他一些表明它们不合格的指标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:34:59.130

只需探测传入的 IP。这就是大多数 IRC 网络阻止代理连接到它们的方法。******`*