# StackOverflow 问答 12391000-12391999

# sockets - Libevent 中的未决事件和活动事件有什么区别？

> ID：12391002
> 
> 赞同：2
> 
> 时间：2012-09-12T14:54:59.700
> 
> 标签：sockets, network-programming, libevent

我正在学习如何使用 Libevent。虽然我无法理解挂起和活动之间的区别。在我看来，当一个事件被添加到 event_base 并且该事件还没有发生时，它处于挂起状态，而调用者等待的事件发生了，然后处于活动状态，对吗？但是，当我阅读描述时`event_pending`，看到代码爆炸，它说当事件挂起时，改变内部状态是不好的它，我认为这里的“待定”一词是误解，它应该是“event_active”....我错了吗？

```
#include <event2/event.h>
#include <stdio.h>

/* Change the callback and callback_arg of 'ev', which must not be
 * pending. */
int replace_callback(struct event *ev, event_callback_fn new_callback,
    void *new_callback_arg)
{
    struct event_base *base;
    evutil_socket_t fd;
    short events;

    int pending;

    pending = event_pending(ev, EV_READ|EV_WRITE|EV_SIGNAL|EV_TIMEOUT,
                        NULL);
    if (pending) {
        /* We want to catch this here so that we do not re-assign a
         * pending event.  That would be very very bad. */
        fprintf(stderr,
            "Error! replace_callback called on a pending event!\n");
        return -1;
    }

    event_get_assignment(ev, &base, &fd, &events,
                     NULL /* ignore old callback */ ,
                     NULL /* ignore old callback argument */);

    event_assign(ev, base, fd, events, new_callback, new_callback_arg);
    return 0;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:51:40.237

未决事件意味着触发了某些操作并且事件回调的执行在 event_base 中排队。

活动事件意味着事件回调当前正在执行当前线程或其他一些（不要忘记您可以操作来自其他线程的事件，即不运行事件循环）

重新分配一个挂起的事件不是线程安全的操作，你可以在 event.c 中看到它。

我认为，如果您编写单线程应用程序，随时重新分配事件是安全的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-27T16:45:28.180

libevent 书籍报价（[http://www.wangafu.net/~nickm/libevent-book/Ref4_event.html](http://www.wangafu.net/~nickm/libevent-book/Ref4_event.html)）：

> 一旦调用 Libevent 函数来设置事件并将其与事件库相关联，它就会被初始化。此时，您可以添加，这使其在基础中挂起。当事件未决时，如果触发事件的条件发生（例如，其文件描述符更改状态或超时到期），则事件变为活动状态，并运行其（用户提供的）回调函数。

所以 libevent 术语中的“待处理”意味着“刚刚添加到反应器中”。没有动作触发需要获取挂起的事件。我用简单的程序检查了这种行为：

```
#include <stdio.h>
#include <unistd.h>
#include <assert.h>
#include <event.h>

void read_cb( int sock, short which, void *arg )
{
    printf( "read_cb() called\n" );
    fflush( stdout );
    // while our callback is running event is active
}

int main()
{
    struct event_base *base = event_base_new();

    int fd[ 2 ];
    assert( pipe( fd ) == 0 );

    struct event ev;
    event_set( & ev, fd[ 0 ], EV_READ | EV_PERSIST, read_cb, NULL );
    event_base_set( base, & ev );

    assert( event_add( & ev, NULL ) != -1 );
    // it's pending now, just after adding

    printf( "event_pending( ... ) == %d\n", event_pending( & ev, EV_READ, NULL ) );
    fflush( stdout );

    event_base_loop( base, EVLOOP_ONCE );

    return 0;
} 
```

输出：

> event_pending( ... ) == 2

# app-store-connect - iTunes 连接：为应用程序的现有用户设置额外的更新价格

> ID：12391006
> 
> 赞同：0
> 
> 时间：2012-09-12T14:55:18.360
> 
> 标签：app-store-connect, updates

我已经在应用商店提交了一份申请，价格为 6.99 美元。现在我正在提交这个应用程序的新版本。在这里，我希望已安装此应用程序的 iPhone 用户应为此更新支付 0.99 美元，新用户应支付 6.99 美元

是否可以为现有用户收取额外费用进行更新？请建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:01:17.117

不会。来自 App Store 的更新始终是免费的。如果您想对附加内容收费，您可以使用应用内购买系统。

否则，如果您希望从用户那里获得更多收益，您唯一的选择是创建一个全新的应用程序进行重大更新。

# symfony - Symfony2 中用户生成的文件存储

> ID：12391010
> 
> 赞同：1
> 
> 时间：2012-09-12T14:55:27.237
> 
> 标签：symfony, storage, symfony-2.1, user-management

我有一个带有用户管理的 Symfony2 项目（FOsUserbundle 和 Sonata 捆绑包）。在我的应用程序的某些情况下，我需要为用户创建文件，并且我想存储它们。这些文件可能很大，所以我排除将它们存储在会话/本地存储中。

第一个问题：是否有 symfony2 模式来处理用户生成的文件和存储？这些文件应该放在哪里？哪个目录？

第二个问题：我的应用程序需要使用一个大文件。用户不应访问此文件，但主要是我的应用程序控制器必须访问。存储此文件和限制访问的最佳安全方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:55:43.920

**第一个问题：** 根据每个用户拥有的文件数量，我会使用某种命名约定。例如 temp/[username]/file1.dat 或 temp/[username].dat 您可以按照 s [ymfony2 cookbock 在实体上上传文件](http://symfony.com/doc/2.0/cookbook/doctrine/file_uploads.html)并检查功能来实现此策略：

```
public function preUpload()
{
    if (null !== $this->file) {
        // do whatever you want to generate a unique name
        $this->path = uniqid().'.'.$this->file->guessExtension();
    }
} 
```

这是生成的文件名，您可以轻松设置用户名，而不是一些随机的“uniqueid()”。

**第二个问题** 在我看来，保护文件最好通过一个无法通过网络访问的文件夹来实现。例如，如果您具有以下结构：

```
myproject    
  app    
  src    
  vendor    
  web  <-- your domain points to this folder    
  save_files 
```

然后您可以将文件存储在无法通过直接 Web 访问访问的 save_folder 中。在您的应用程序/控制器中，您可以通过文件系统访问它或使用一些抽象，如[KnpGaufretteBundle](https://github.com/KnpLabs/Gaufrette)

# c# - 在 C# 中创建简单的分层 PSD 文件

> ID：12391012
> 
> 赞同：4
> 
> 时间：2012-09-12T14:55:35.320
> 
> 标签：c#, .net, photoshop

我正在用 C# .Net 3.0 制作一个微型成像工具。

我想制作一个 psd 文件，将一些图像分层。

我用谷歌搜索但没有发现有用的信息。

photoshop SDK 可能仅用于 Photoshop 插件或自动化。

但是，正如我所见，iPad 应用程序 Recreate 具有 psd 导出功能，因此必须有一种方法可以在代码中创建 psd 文件。

是否有一些图书馆或其他方式来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T14:59:50.363

我不知道您可以使用任何库，但[PSD 文件格式](http://www.adobe.com/devnet-apps/photoshop/fileformatashtml/PhotoshopFileFormats.htm#50577409_pgfId-1036097)已由 Adob​​e 发布。也许您可以编写自己的方法来创建 PSD。

# python - 如何在远程站点无法检测到主机/主机 IP 的情况下使用代理？

> ID：12391013
> 
> 赞同：1
> 
> 时间：2012-09-12T14:55:40.373
> 
> 标签：python, security, http, networking, proxy

我正在尝试通过 python 使用代理，以便从不同的特定 IP 地址登录到站点。但是，某些网站似乎可以检测到原始（主机）IP 地址。我已经对这个问题进行了一些调查，这就是我发现的。

我尝试过四种代理方法：

*   带有代理设置的 Firefox。
*   Python 与`mechanize.set_proxies`.
*   使用内部网络的虚拟机中的 Firefox 以及充当路由器的另一台虚拟机（具有两个适配器：一个 NAT 和该内部网络）进行设置，以使内部网络流量通过代理进行路由。
*   [TorBrowser](https://www.torproject.org/download/download-easy.html.en)（使用 Firefox 作为实际浏览器）。

对于前三个，我使用了相同的代理。Tor 选项只是为了进行额外的测试，而不是通过我自己的代理。以下是我注意到的预期行为：

*   有了所有这些，如果我转到`http://www.whatismyip.com/`，它会给出正确的 IP 地址（代理的 IP 地址，而不是主机的 IP 地址）。
*   `whatismyip.com`所有这些都说“未检测到代理”。

事实上，我访问的网站似乎确实认为我的 IP 是代理的 IP。但是，有一些奇怪的情况让我认为某些网站可以以某种方式检测到我的原始 IP 地址。

*   在一种情况下，通过 Firefox 使用非美国代理访问非美国站点，该站点实际上能够打印我的原始 IP 地址（来自美国）并拒绝我访问。这不应该是不可能的吗？但是，通过具有相同非美国代理的虚拟机或具有非美国出口节点的 TorBrowser 访问该站点，该站点无法这样做。
*   在类似的情况下，我正在通过非美国代理访问另一个非美国站点。如果我从虚拟机中的 Firefox 或使用非美国出口节点的 TorBrowser 登录该站点，该站点将正常运行。但是，如果我尝试使用代理（与虚拟机使用的代理相同）或使用代理通过 Firefox 登录`mechanize`，它将无法登录并显示不相关的错误消息。
*   在第三种情况下，使用该`mechanize.set_proxies`选项，我使一个请求过多的站点超载，因此它决定阻止访问（每当我登录时它都会故意超时）。我认为它可能阻止了代理的 IP 地址。但是，当我从另一台主机上运行代码，但使用相同的代理时，它再次工作了一段时间，直到他们再次阻止它。（不用担心，我不会再骚扰该网站 - 我重新运行了该程序，因为我认为这可能是我的一个小故障，而不是他们的一个障碍。）使用 Firefox + 代理访问该网站来自被阻止主机之一的解决方案也导致了有目的的超时。

在我看来，所有这些站点，在 Firefox + 代理和`mechanize`案例中，都能够找到有关主机 IP 地址的信息，而在 TorBrowser 和虚拟机案例中，它们却没有。

这些网站如何收集这些信息？TorBrowser 和阻止站点收集此信息的虚拟机案例有什么不同？而且，我将如何实现我的 python 脚本，以便我通过代理访问的站点无法检测到主机/主机的 IP 地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T17:05:18.763

代理可能会在[`X-Forwarded-For`](http://en.wikipedia.org/wiki/X-Forwarded-For)HTTP 标头中报告您的真实 IP 地址，但如果是这样，我很惊讶 WhatIsMyIP 网站没有告诉您这件事。

如果您第一次直接访问非美国站点，然后再次使用代理，则该站点也可能在您第一次访问时在您的浏览器中设置了[cookie](http://en.wikipedia.org/wiki/HTTP_cookie)，即使您的 IP 地址发生更改，该站点也可以识别您。这可以解释您在浏览器实例之间观察到的差异。

（我注意到学术期刊网站喜欢这样做。如果我尝试从家里访问付费文章并因为我没有使用我大学的代理服务器而被阻止，我通常必须在启用代理后清除 cookie被允许访问。）

# sql - 为什么 SQL 导入向导认为我的 Excel 数据长度为 255 个字符？

> ID：12391016
> 
> 赞同：0
> 
> 时间：2012-09-12T14:55:44.953
> 
> 标签：sql, excel

我正在尝试将数据表导入 SQL，并且我有几列限制了数据的长度。奇才队不断给我一个警告，上面写着：

警告 0x802092a7：数据流任务 1：由于从长度为 255 的数据流列“技术平台”插入长度为 15 的数据库列“技术平台”中的数据，可能会发生截断。

列单元格的长度都是 10 个字符，我已将 excel 中这些列的文本长度限制为 10 个字符。那么为什么 SQL 认为这些是 255 个字符长呢？就像我说的，我有其他列有限，它们导入得很好。

# shell - AWK：比较两个 CSV 文件

> ID：12391023
> 
> 赞同：1
> 
> 时间：2012-09-12T14:56:00.453
> 
> 标签：shell, scripting, awk, cygwin

我有两个 CSV 文件，我想使用 AWK 比较它们并生成一个新文件。

文件 1.csv：

```
"no","loc" 
"abc121","C:/pro/in" 
"abc122","C:/pro/abc"
"abc123","C:/pro/xyz"
"abc124","C:/pro/in" 
```

文件 2.csv：

```
"no","loc" 
"abc121","C:/pro/in"
"abc122","C:/pro/abc"
"abc125","C:/pro/xyz"
"abc126","C:/pro/in" 
```

输出.csv：

```
"file1","file2","Diff" 
"abc121","abc121","Match" 
"abc122","abc122","Match" 
"abc123","","Unmatch" 
"abc124","","Unmatch" 
"","abc125","Unmatch" 
"","abc126","Unmatch" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T05:56:36.337

一种方法`awk`：

### 脚本.awk：

```
BEGIN {
    FS = ","
}

NR>1 && NR==FNR {
    a[$1] = $2
    next
}

FNR>1 { 
    print ($1 in a) ? $1 FS $1 FS "Match" : "\"\"" FS $1 FS "Unmatch"
    delete a[$1] 
}

END {
    for (x in a) {
        print x FS "\"\"" FS "Unmatch"
    }
} 
```

### 输出：

```
$ awk -f script.awk file1.csv file2.csv
"abc121","abc121",Match
"abc122","abc122",Match
"","abc125",Unmatch
"","abc126",Unmatch
"abc124","",Unmatch
"abc123","",Unmatch 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:31:38.427

我没有`awk`单独使用，但如果我理解你所要求的要点，我认为这个长单行应该可以做到......

```
join -t, -a 1 -a 2 -o 1.1 2.1 1.2 2.2 file1.csv file2.csv | awk -F, '{ if ( $3 == $4 ) var = "\"Match\""; else var = "\"Unmatch\"" ; print $1","$2","var }' | sed -e '1d' -e 's/^,/"",/' -e 's/,$/,"" /' -e 's/,,/,"",/g' 
```

描述：

*   该`join`部分采用两个 CSV 文件，将它们连接到第一列（默认行为`join`）并输出所有四个字段 ( `-o 1.1 2.1 1.2 2.2`)，确保包含两个文件都不匹配的行 ( `-a 1 -a 2`)。
*   该`awk`部分采用该输出并将第 3 列和第 4 列的组合替换为`"Match"`或`"Unmatch"`基于它们是否确实匹配。我不得不根据您的示例对这种行为做出假设。
*   该`sed`部分从输出 ( ) 中删除 "no","loc" 标头，`-e '1d'`并用开闭引号 ( `-e 's/^,/"",/' -e 's/,$/,""/' -e 's/,,/,"",/g'`) 替换空字段。最后一部分对您来说可能不是必需的。

编辑：正如tripleee 指出的那样，如果两个初始文件未排序，上述操作将失败。这是一个更新的命令来解决这个问题。它在将每个文件传递给加入之前将标题行和排序...

```
join -t, -a 1 -a 2 -o 1.1 2.1 1.2 2.2 <( sed 1d file1.csv | sort ) <( sed 1d file2.csv | sort ) | awk -F, '{ if ( $3 == $4 ) var = "\"Match\""; else var = "\"Unmatch\"" ; print $1","$2","var }' | sed -e 's/^,/"",/' -e 's/,$/,""/' -e 's/,,/,"",/g' 
```

# php - PHP 不显示来自 MYSQL 时间戳搜索的结果

> ID：12391026
> 
> 赞同：0
> 
> 时间：2012-09-12T14:56:19.530
> 
> 标签：php, mysql, timestamp

下面是我从 MYSQL 数据库中搜索日期范围的代码。我可以搜索日期并显示表格标题（产品描述、新的或拥有的和日期），但它不显示数据库中的任何结果？

关于我需要如何编辑代码以使其显示所选日期范围内的结果的任何想法？

```
<?php
if(!isset($_POST['find']))
{
?>
<form method = "post" action = "<?php echo $_SERVER['PHP_SELF'];?>">
<table width = "450" align = "center">
    <tr>
    <td><b><i>Please enter date in the field below (i.e. 11-09-2012)</i></b></td>
</tr>
<tr>
    <td>
    From&nbsp;:&nbsp;
    <input type = "text" name = "small">
    To&nbsp;:&nbsp;
    <input type = "text" name = "large"></td>
</tr>
<tr>
    <td align = "center">
        <input type = "submit" name = "find" value = "SEARCH">
        <input type = "reset" value = "CLEAR FORM">
        </td>   
    </tr>
</table>
</form>
<?php
}
else
{
$small = trim($_POST['small']);
$large = trim($_POST['large']);

$connection = mysql_pconnect("localhost", "user_name", "password") or die("Connection failed. ".myslq_error());
 mysql_select_db("stock") or die("Unable to select db. ".mysql_error());
//Add 1 to the upper range, $large, else it won't make it inclusive
$query = "SELECT * FROM main_stock WHERE curr_timestamp BETWEEN DATE_FORMAT(curr_timestamp,'%".$small."') AND DATE_FORMAT(curr_timestamp, '%".($large+1)."') ORDER BY curr_timestamp";
$result = mysql_query($query) or die(mysql_error());

echo "<table width = '500' align = 'center'>";
echo "<tr><b>";
    echo "<td>Product Description</td>";
    echo "<td>New or Own?</td>";
    echo "<td>Date</td>";
echo "</b></tr>";
while($record = mysql_fetch_object($result))
{
    echo "<tr>";
        echo "<td>".$record->product_desc."</td>";
        echo "<td>".$record->newown."</td>";
        $year_part_of_date = explode('-', $record->curr_timestamp);
    echo "<td>".$year_part_of_date[0]."</td>";
        //if you want the full date replace the $year_part_of_date[0] with $record->date
    echo "</tr>";
}
echo "</table>";

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:13:36.683

1.  切换逻辑顺序。您不希望您的流程成为`else`.
2.  似乎您正在结合程序样式和对象样式。选一个。
3.  您应该避免选择所有 ( `SELECT *`)。始终指定列列表。
4.  日期格式不正确。您应该格式化输入日期以匹配数据库格式 ( `YYYY-MM-DD`)。我假设`curr_timestamp`是`YYYY-MM-DD`。
5.  您需要停止使用`mysql_`函数，因为它们已被[弃用](http://www.deprecatedphp.com/mysql)。
6.  使用准备好的语句来防止 SQL 注入。

我没有对此进行测试，但这解决了我上面列出的问题：

```
<?php
if(isset($_POST['find']))
{
    $link = mysqli_connect("localhost", "user_name", "password", "stock");

    if (mysqli_connect_error()) {
    die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());
    }

    $stmt = mysqli_prepare($link, 'SELECT * FROM main_stock WHERE curr_timestamp ' . 
    "BETWEEN DATE_FORMAT(?, '%m-%d-%Y') " . 
    "AND DATE_FORMAT(?, '%m-%d-%Y') ORDER BY curr_timestamp");

    mysqli_bind_param($stmt, 'ss', $_POST['small'], $_POST['large']) or die(mysqli_error($dbh));

    $result = mysqli_stmt_execute($stmt) or die(mysqli_error($link));

    echo "<table width = '500' align = 'center'>";
    echo "<tr><b>";
    echo "<td>Product Description</td>";
    echo "<td>New or Own?</td>";
    echo "<td>Date</td>";
    echo "</b></tr>";

    while($record = mysqli_fetch_assoc($result)) {
    echo "<tr>";
    echo "<td>" . $record[product_desc] . "</td>";
    echo "<td>" . $record[newown] . "</td>";

        $year_part_of_date = explode('-', $record[curr_timestamp]);

    echo "<td>".$year_part_of_date[0]."</td>";

        //if you want the full date replace the $year_part_of_date[0] with $record->date
    echo "</tr>";
    }

    echo "</table>";

   mysqli_close($link);
}
else
{
?>
<form method = "post" action = "<?php echo $_SERVER['PHP_SELF'];?>">
<table width = "450" align = "center">
    <tr>
    <td><b><i>Please enter date in the field below (i.e. 11-09-2012)</i></b></td>
</tr>
<tr>
    <td>
    From&nbsp;:&nbsp;
    <input type = "text" name = "small">
    To&nbsp;:&nbsp;
    <input type = "text" name = "large"></td>
</tr>
<tr>
    <td align = "center">
        <input type = "submit" name = "find" value = "SEARCH">
        <input type = "reset" value = "CLEAR FORM">
        </td>   
    </tr>
</table>
</form>
<?php
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:06:02.647

我猜你的查询无效。

假设这`curr_timestamp`是一个格式为 的 MySQL 日期时间字段`YYYY-MM-DD HH:MM:SS`，您需要将输入更改为这种格式以便于比较。如果您可以详细说明 and 的格式，`$small`那`$large`将很有帮助。

您可能希望您的查询采用这种格式

```
SELECT * FROM main_stock
WHERE curr_timestamp BETWEEN '$small_formatted' AND '$large_formatted'
ORDER BY curr_timestamp ASC 
```

使用类似的东西在哪里`$small_formatted`和正确格式化时间`$large_formatted``date('Y-m-d H:i:s', $input_timestamp)`

# web-services - 如果 Web 服务方法具有复杂的类型参数/返回值，如何调用它？

> ID：12391037
> 
> 赞同：1
> 
> 时间：2012-09-12T14:56:47.697
> 
> 标签：web-services

我有个问题：

我需要使用动态调用来调用 Web 服务。我让我的dll根据WSDL文件生成一个程序集，然后使用反射调用这个程序集的方法，问题是这个web服务提供的方法有参数/返回值，它是复杂类型而不是原始类型。如果我想动态调用这个方法怎么办？

例如：

这个 WebMethod 是

```
CustomType1 Method1(CustomType2 param)

class CustomType1 { int a; int b; }

class CustomType2 { string a; string b; } 
```

我目前所做的是我添加了一个 CS 文件，其中包含 和 的定义，`CustomType1`我`CustomType2`根据 WSDL 文件中的定义编写的文件。程序运行时抛出异常“`XXX.CustomType2`无法将类型转换为类型`CustomType2`”

我被困住了，我该怎么办？

# r - R中轴的不规则缩放

> ID：12391038
> 
> 赞同：1
> 
> 时间：2012-09-12T14:56:56.643
> 
> 标签：r, plot, scale

我已经计算了三个网络的几个类别的值。我想在 R 中创建一个条形图来显示这些网络参数之间的差异。到目前为止，我用*barplot* R 函数绘制了这个，x 轴上的类别，y 轴上的值和每个类别三个条形图（每个网络一个）。

但是现在我有一个比其他所有值都高得多的值。因此看不到其余部分的差异，因为它们仅由一条细线表示，因为一个大条几乎填满了整个情节。

我现在的想法是在 y 轴上以不规则的比例绘制值，例如，一半代表 0 到 300 之间的值，另一半代表 300 到 3000 之间的值。有没有办法做到这一点？或者一个很好的替代方法来处理这个问题？我也想过绘制对数，但不幸的是我也有负值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:53:06.453

我建议不规则的比例不是一个好的计划——我认为它会让图表的观众感到困惑。相反，您可以使用该`layout()`函数在水平布局中绘制三个单独的条形图。因此，每个类别都可以有自己的情节，有自己的规模。

但是，如果您仍然有一个 3000 的柱，而其他所有的柱都在 300，那将无济于事。在这种情况下，您可以使用 手动设置 y 轴范围`ylim=c(min,max)`。为了防止条形图超出屏幕，您可以使用简单的逻辑将任何 > 300 的值定义为 300 或类似的值。然后，在此处放置一个文本点，说明实际值（使用`text`，也许与`arrow`）。

有了这些想法，我建议一个值是其他值的 10 倍的图表可能真的不值得呈现，或者如果是，那么主要的收获不是“值 2 和 3 如何相互比较”，这将是“天哪，看看 1 比 2 和 3 大多少”。因此，如果一个条形图很大，两个条形图很小，这可能没什么大不了的，只要你没有在一个图上完成所有 9 个（这会搞砸其他相关的比较）。因此，如果您使用 拆分它们`layout()`，那么它就没什么大不了的了。

# android - 带有朋友风格的单词列表视图

> ID：12391039
> 
> 赞同：0
> 
> 时间：2012-09-12T14:56:58.657
> 
> 标签：android, android-layout

我有一个 android 游戏，它加载用户对他的朋友的“游戏”列表。类似于“与朋友的游戏单词”

![](../Images/9700bb820d08eb68ee43d45409deca36.png)

为了重新创建这种类型的视图，我最初使用了一个列表视图，但是因为有不同的元素，即游戏、部分（他们的移动 - 你的移动）等，我认为我不能用纯粹的列表视图来做这种布局？

有没有人做过类似的事情？我可能只是使用滚动视图并动态构建布局，但我担心如果用户有很多游戏，性能会受到影响。

任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:29:37.837

您应该覆盖`getView()`列表视图适配器中的方法。它负责显示每个项目的布局。您将可以在那里执行以下操作：

```
if(position == YOUR_MOVE_POSITION) {

     // here hide ordinary elements, and set the ones you need to be visible
} 
```

在这里查看详细信息：[链接](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

**示例：（我如何看待解决方案）**

此方法在您的适配器类中（用于填充`ListView`，因此您需要使用如下代码覆盖它：

```
public View getView(int position, View convertView, ViewGroup parent) {

  final View v;

  if(position == 1) {  // here come instructions for 'header' no.1
    v = createViewFromResource(position, convertView, parent, mResource);

    // the widget you want to show in header:
    ImageView yourMoveImage = (ImageView) v.findViewById(R.id.your_move);

    // and here come widgets you don't want to show in headers:
    ImageView otherWidget = (ImageView) v.findViewById(R.id.other_widget);

    // then you set the visibility:
    yourMoveImage.setVisibility(View.VISIBLE);    // here is the key
    otherWidget.setVisibility(View.GONE);       // it may also be View.INVISIBLE (look up the official docs for details)   

  } else {

    if(position == 5){  // here come instructions for 'header' no.1

      v = createViewFromResource(position, convertView, parent, mResource);

      // the widget you want to show in header:
      ImageView theirMoveImage = (ImageView) v.findViewById(R.id.their_move);

      // and here come widgets you don't want to show in headers:
      ImageView otherWidget = (ImageView) v.findViewById(R.id.other_widget); 

      // then you set the visibility:
      yourMoveImage.setVisibility(View.VISIBLE);    // here is the key
      otherWidget.setVisibility(View.GONE);       // it may also be View.INVISIBLE (look up the official docs for details)   

    } else {

      // if it is the regular item, just show it as desribed in your XML:
      v = createViewFromResource(position, convertView, parent, mResource);
    }
  }

  return v;
} 
```

# ruby - 如何在 Rspec 中使用通配符参数模拟方法调用？

> ID：12391040
> 
> 赞同：2
> 
> 时间：2012-09-12T14:56:58.417
> 
> 标签：ruby, rspec, wildcard

这是我的生产代码

```
def my_method
    list = [.....]
    list.each do |filename|
        content = File.read(filename)
        ...
    end
end 
```

我正在 Rspec 中编写单元测试，那么如何使用通配符参数模拟 File.read？

```
File.should_receive(:read).with(??some regex here).and_return "" 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T15:01:19.167

您可以使用[`anything`](https://www.relishapp.com/rspec/rspec-mocks/v/2-11/docs/argument-matchers/general-matchers#anything-argument-matcher)或`any_args`。

```
File.should_receive(:read).with(anything).and_return "" 
```

# java - 如何使用 wicket 和 javascript 打印 pdf 文件

> ID：12391041
> 
> 赞同：2
> 
> 时间：2012-09-12T14:57:04.390
> 
> 标签：java, printing, wicket

我的检票口应用程序创建了一些 pdf 文件。现在我想添加按钮来打印它，像这样：http: [//javascript.about.com/library/blprint.htm](http://javascript.about.com/library/blprint.htm)我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-15T19:19:49.183

看起来你把两件事混合在一起。你的例子是一个javascript。它不是 PDF，它只是打印您的文档。它与浏览器菜单 File -> Print 相同，但事件是从处理按钮操作的 javascript 调用的。您可以使用与该示例中相同的按钮并将@print CSS 添加到您的网页中，以使您的文档可以很好地打印。

还有另一种方式。如果要从应用程序打印 PDF 文档并从 Java 代码生成 PDF，请查看 Wicket 1.6 的以下示例：

```
add(new Link<Void>("myPdfLink") {

    private static final long serialVersionUID = 1L;

    @Override
    public void onClick() {
        byte[] data = ... // TODO your data
        final ByteArrayInputStream stream = new ByteArrayInputStream(data);
        IResourceStream resourceStream = new AbstractResourceStream() {                    
            private static final long serialVersionUID = 1L;

            @Override
            public InputStream getInputStream() throws ResourceStreamNotFoundException {
                return stream;
            }

            @Override
            public void close() throws IOException {
                stream.close();
            }

            @Override
            public String getContentType() {
                return "application/pdf";
            }

        };   

        getRequestCycle().scheduleRequestHandlerAfterCurrent(
            new ResourceStreamRequestHandler(resourceStream)
                .setFileName("my-pdf-to-download.pdf")
                .setContentDisposition(ContentDisposition.ATTACHMENT)
                .setCacheDuration(Duration.ONE_SECOND)
        );  

    }

}); 
```

# android - 无法在 post http 请求中获得 http JSON 响应

> ID：12391042
> 
> 赞同：1
> 
> 时间：2012-09-12T14:57:08.497
> 
> 标签：android, json, post, request, response

我尝试在以下代码中接收 http 响应：

```
public void httpRes (){
try {
    HttpClient client = new DefaultHttpClient();
    String postURL = "http://validate.jsontest.com/";
    HttpPost post = new HttpPost(postURL);
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair("user", "kris"));
        params.add(new BasicNameValuePair("pass", "xyz"));
        UrlEncodedFormEntity ent = new UrlEncodedFormEntity(params, HTTP.UTF_8);
        post.setEntity(ent);
        HttpResponse responsePOST = client.execute(post);
        HttpEntity resEntity = responsePOST.getEntity();
        if (resEntity != null) {
            Log.i("RESPONSE",EntityUtils.toString(resEntity));
        }
} catch (Exception e) {
    e.printStackTrace();
}} 
```

出现错误 -

LogCat 日志：

```
09-12 21:48:58.099: INFO/RESPONSE(28485): {
        "error": "No JSON to validate. Please post JSON to validate via the json parameter.",
        "validate": false
        } 
```

我试图从 GET requsets 接收响应 - 一切都很好，但是当我尝试 POST 请求所有各种 POST 代码时 - 我无法得到答案！问题是什么？需要帮忙。

我也试过：

```
Map<String, String> comment = new HashMap<String, String>();
comment.put("password", "password");
comment.put("avatar", "httpssssssss");

String json = new GsonBuilder().create().toJson(comment, Map.class);
HttpResponse response = makeRequest("http://validate.jsontest.com/", json);
//Log.w(TAG, EntityUtils.toString(response));
try {
    HttpEntity entity = response.getEntity();
    InputStream is = entity.getContent();
    String sss= convertStreamToString(is);
    Log.w("SSSSSSSSSSSSSSSSSS", sss);
} catch (Exception ex) {
    Log.w("Exception exxx", ex);
}
public static HttpResponse makeRequest(String uri, String json) {
        try {
            HttpPost httpPost = new HttpPost(uri);
            httpPost.setEntity(new StringEntity(json));
            httpPost.setHeader("Accept", "application/json");
            httpPost.setHeader("Content-type", "application/json");
            return new DefaultHttpClient().execute(httpPost);
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return null;
    }

private static String convertStreamToString(InputStream is) {

        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();
        String line = null;
        try {
            while ((line = reader.readLine()) != null) {
                sb.append((line + "\n"));
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    } 
```

那么，问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-03T16:49:52.947

[http://validate.jsontest.com](http://validate.jsontest.com)拒绝 POST 请求，除非`Content-Type`标头设置为`application/x-www-form-urlencoded`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:09:26.133

通过 GET 您的代码行

```
HttpPost httpPost = new HttpPost(uri); 
```

应该

```
HttpPost httpPost = new HttpPost(uri+"?json="+json); 
```

而且我认为您不需要下面的三行。

通过 POST 你需要像这样传递 json 参数。

```
params.add(new BasicNameValuePair("json", json)); 
```

假设 json 是一个包含您的 json 数据的变量。

您可以在浏览器中测试 GET 方法，例如[http://validate.jsontest.com/?json=](http://validate.jsontest.com/?json=) {validate: true}

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T15:06:05.637

您需要将有效的 json 发布到 url [http://validate.jsontest.com/](http://validate.jsontest.com/)来验证它。你所做的基本上是向 url 发送一个 post 请求，它不是 json 格式的。您必须将其编码为 json，然后将其发送到验证 url。

# java - 以最简单的方式访问内部元素的属性

> ID：12391043
> 
> 赞同：1
> 
> 时间：2012-09-12T14:57:08.700
> 
> 标签：java, jakarta-ee, jaxb

对于这种简单的xml，有没有办法使用单个java bean进行映射：

```
<item lang="en">
   <item-url>some url</item-url>
   <parent id="id_123"/>
</item> 
```

我试过这样的事情：

```
@XmlRootElement( name = "item" )
public class Item {

    @XmlElement( name = "item-url" )
    private String url;

    @XmlAttribute( name = "parent/@id" )
    // Of course XPath doesn't work here, but it would be great...
    private String parentId;
} 
```

换句话说 - 如何在不创建相应 bean 的情况下访问内部元素的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:15:01.610

您可以使用`XmlAdapter`：

**父标识符适配器**

```
public class ParentIdAdapter extends XmlAdapter<ParentIdAdapter.AdaptedParentId, String> {

    public String unmarshal(AdaptedParentId value) {
        return value.id;
    }

    public AdaptedParentId marshal(String value) {
        AdaptedParentId adapted = new AdaptedParentId();
        adapted.id = value;
        return adapted;
    }

    public static class AdaptedParentId {
        @XmlAttribute
        public String id;
    }

} 
```

**物品**

```
@XmlRootElement( name = "item" )
public class Item {

    @XmlElement( name = "item-url" )
    private String url;

    @XmlElement( name = "parent" )
    @XmlJavaTypeAdapter(ParentIdAdapter.class)
    private String parentId;
} 
```

* * *

如果您使用[**EclipseLink MOXy**](http://www.eclipse.org/eclipselink/moxy.php)作为您的 JAXB 提供程序，那么您可以利用该`@XmlPath`扩展来执行以下操作：

```
@XmlRootElement( name = "item" )
public class Item {

    @XmlElement( name = "item-url" )
    private String url;

    @XmlPath("parent/@id")
    private String parentId;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:23:00.037

由于我不想在我的包中创建冗余类，所以我找到的最佳解决方案是：

```
@XmlRootElement( name = "item" )
public class Item {

    @XmlRootElement( name = "parent" )
    private static class ParentIdWrapper {
        @XmlAttribute( name = "id" )
        public String id;
    }

    @XmlElement( name = "item-url" )
    private String url;

    @XmlElement( name = "parent" )
    private ParentIdWrapper parentIdWrap;

    public String getParentId() {
        return this.parentIdWrap.id;
    }
} 
```

# java - 确定传递 Java 导入的工具？

> ID：12391044
> 
> 赞同：4
> 
> 时间：2012-09-12T14:57:09.110
> 
> 标签：java, import, code-analysis

是否有某种工具可以指向一组 Java 类，并生成显示每个类的传递导入的输出？

我知道从语言本身的角度来看，导入不是“可传递的”——即，如果 com.acme.X 导入 com.acme.Y，而 com.acme.Y 导入 com.acme.Z，那并不意味着您可以在 com.acme.X 中引用 com.acme.Z。但这不是我的意思：

相反，我的意思是 com.acme.X 仍然依赖于 com.acme.Z（至少在 X 和 Y 的当前实现下），我想知道这个事实。事实上，我想知道大量的课程，所以我希望有一个工具可以自动确定它。

一个独立的工具或一个 Eclipse 插件或特性都会很棒。

提前致谢。

**编辑**希望能显示我想要这个：

我有一个巨大的整体 jar，其中包含许多（基本上）完全不相关的功能。我想把它分成几个更小、更易于管理、更自洽的罐子。

不幸的是，我不能简单地根据包来分解它，因为许多包本身也不是自洽的。也就是说，例如，有一个“com.acme.utils”包。该软件包中的两件事可能没有任何共同点，只是它们在某种意义上都是“实用程序”。一个可能是某个特定业务功能的实用程序，另一个可能是 TCP/IP 实用程序，另一个可能是一组字符串实用程序，另一个可能是一些完全不相关的业务功能。

还有很多这样的包。因此，当您从包的角度来看导入的传递性时，它们会无限滚雪球，因此整体 jar 中的所有内容或多或少都依赖于整体 jar 中的其他所有内容。

所以我想首先从*类*的角度考虑导入的传递性，而不是从*包*的角度。这样我应该能够更容易地确定哪些类需要从现有的包重组为新的、更连贯的包，然后我可以通过包/包集将整体 jar 分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:05:10.920

我们将声纳用于软件指标。[http://www.sonarsource.org/](http://www.sonarsource.org/)

# c# - 使用 windows auth 从 web 应用程序访问服务列表

> ID：12391045
> 
> 赞同：1
> 
> 时间：2012-09-12T14:57:08.780
> 
> 标签：c#, .net, windows-services

我构建了一个 Web 应用程序，它获取所选服务器上所有服务的列表。我在应用程序上启用了 Windows 身份验证。当我从 vs2010 运行时它工作正常，但是当我在本地机器 IIS 上部署相同的代码时，我收到如下所示的错误。我还从几台不同的用户机器上测试了网站，他们得到了同样的错误。关于如何解决这个问题的任何想法以及我需要在 IIS 中使用哪些设置才能发生这种情况。我可以访问所有服务器，测试应用程序的用户也可以访问这些服务器。

**信息：** `Cannot open Service Control Manager on computer ''. This operation might require other privileges.`

```
Inner Exception: System.ComponentModel.Win32Exception (0x80004005): Access is denied

Stack Trace:    at System.ServiceProcess.ServiceController.GetDataBaseHandleWithAccess(String machineName, Int32 serviceControlManaqerAccess)
   at System.ServiceProcess.ServiceController.GetDataBaseHandleWithEnumerateAccess(String machineName)
   at System.ServiceProcess.ServiceController.GetServicesOfType(String machineName, Int32 serviceType)
   at System.ServiceProcess.ServiceController.GetServices(String machineName) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:18:21.297

如果没有更多信息 - 听起来运行您的应用程序的应用程序池的身份没有足够的权限来访问 SCM。如果您希望使用通过 Web 应用程序进行身份验证的用户的凭据，则需要使用模拟。

几个问题 - 你在使用模拟吗？此外，如果您将应用程序池的身份更改为管理员（这不是长期解决方案，只是一个测试），是否可以解决错误？

# jax-ws - 快速信息集不适用于 JAXWS Glassfish Metro

> ID：12391050
> 
> 赞同：0
> 
> 时间：2012-09-12T14:57:22.597
> 
> 标签：jax-ws, glassfish-3, java-metro-framework

我们正在构建一个高吞吐量的后端系统，它将发送和检索可变大小的 byte[]，一种缓存服务。绑定对于这个项目至关重要，因此我们一直在测试 SOAP、REST 和 Fast Infoset，并使用 Memcached 客户端作为我们的基线。

我们的测试没有显示 SOAP 和 Fast Infoset 客户端的往返时间有任何差异。我的消息不包含指示应用程序/fastinfoset 的标题信​​息。从我可以看到快速信息集没有打开，因为客户端没有发送正确的信息，因为 Metro 指南中的技术是错误的，或者我完全错过了一些东西。

难道我做错了什么？有更好的解决方案吗？

[此站点上的 CXF 上](https://stackoverflow.com/questions/2853365/how-do-you-use-fastinfoset-with-jaxws)有相同问题的解决方案，但它不是我可以使用的，我正在使用 Metro。请不要向我引用该解决方案。

这是有关如何工作的[地铁指南：](http://metro.java.net/2.2/guide/ch02.html#using-fastinfoset)

*   玻璃鱼 3.1.2
*   JDK 1.7
*   地铁2.2

我测试中的两个客户端对一行代码的接受相同。

```
((javax.xml.ws.BindingProvider) _port).getRequestContext().put(JAXWSProperties.CONTENT_NEGOTIATION_PROPERTY, "pessimistic"); 
```

快速信息集客户端的客户端代码如下所示。（只需减去上面的行，您就知道我们的soap 客户端是什么样子了。）上面链接的指南表明，上面的行是使我们的JAXWS 客户端能够使用FastInfoset 所需的全部内容。

```
 public EpCacheFiClient(long period) {      
     try {          
          _service = new EpCacheService(new URL(WSDL_URL_KEY), QNAME);
          _port = _service.getEpCachePort();            
          ((javax.xml.ws.BindingProvider) _port).getRequestContext().put(JAXWSProperties.CONTENT_NEGOTIATION_PROPERTY, "pessimistic");          
          if (_port != null) {              
               System.out.println("Found service port!");           
          } else {              
                 System.exit(128);          
          }     
     } catch (MalformedURLException e) {            
          e.printStackTrace();      
     }
} 
```

[来自 itu](http://www.itu.int/ITU-T/asn1/xml/tutorial-fws.pdf)的教程介绍了消息传递级别协议的详细信息。其中有一个我的标题应该是什么样子的示例。

```
POST /AlertPort HTTP/1.1
Content-Type: application/fastsoap; action="urn:alert"
Accepts: application/fastsoap, application/text+xml
Content-Length: ....
... sequence of octets …" 
```

教程是从2005年开始的，我们知道HTTP头域Content-Type发生了变化，根据上面的metro guide参考应该是application/fastinfoset。这证明我没有遇到错误，而是存在文档问题。希望我能从这个论坛的好心专家那里找到答案。

这是我的消息的样子。我砍掉了二进制文件。请注意，服务没有任何指示表明与该客户端的继续通信应该是快速信息集。使用 Wireshark，我可以肯定地说，我发送到服务器的所有消息都没有任何标头信息来指示快速信息集。

```
POST /epcache/EpCacheService HTTP/1.1
Accept: text/xml, multipart/related
Content-Type: text/xml;charset=utf-8
SOAPAction: "urn:ProcessEpCacheSet"
User-Agent: JAX-WS RI 2.2.4-b01
Host: linux-xxxxx:8080
Connection: keep-alive 
```

我还想指出，我可以将任何我想要的内容放入 BindingProvider 的请求上下文中，它会显示在每个请求的标头中，因此在我的测试中实例化 _port 没有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:17:22.360

我最终发现了发生了什么，那就是图书馆。如果我使用了正确的字符串，推荐的命令和技术就会起作用。不幸的是，文档没有区分内部库和外部库，并且使用了不推荐使用的枚举。

简而言之，如果您使用嵌入到 JDK 中的 jax-ws，请使用此属性 [1]；否则，请尝试 [2]。

[1] com.sun.xml.internal.ws.client.ContentNegotiation [2] com.sun.xml.ws.client.ContentNegotiation

只需要知道魔法咒语。

请在我也发布此问题的 glassfish 论坛上阅读以下解决方案。 [http://home.java.net/forum/topic/glassfish/glassfish/fast-infoset-comparison-soap-not-faster](http://home.java.net/forum/topic/glassfish/glassfish/fast-infoset-comparison-soap-not-faster)

# javascript - 如果窗口关闭，请打开一个函数

> ID：12391055
> 
> 赞同：0
> 
> 时间：2012-09-12T14:57:34.447
> 
> 标签：javascript, jquery, html

当浏览器选项卡关闭时，我需要打开一个函数（还有 alt + f4）。是否有某种javascript功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T14:58:36.880

在一般情况下，您只能使用[onbeforeunload](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload)显示标准确认对话框。

您不能执行任意 javascript 函数（出于明显的安全原因）。

例外情况是当此选项卡从另一个仍然打开且在同一个域上的选项卡打开时：在这种情况下，您可以从打开器检查子项是否仍然打开（但在关闭之前您无法执行代码）。

你可以像这样测试它：

```
var tab = window.open("index2.html");
setInterval(function(){console.log(tab.window)}, 2000); // shows that tab.window is null as soon as you close the child tab 
```

**编辑：**实际上，您可以使用 onbeforeunload 回调做一些事情，但它不可靠，不适用于所有浏览器，不允许警报或阻止关闭窗口。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T15:01:50.337

您可以使用 jQuery 卸载功能

```
 <script type="text/javascript"> 
       $(document).ready(function(){
      $(window).unload(function(){
        alert("Close this window to show Me Unload Event occur..!");
         });
         });
    </script> 
```

[http://api.jquery.com/unload/](http://api.jquery.com/unload/)

尝试这个

```
 <!DOCTYPE html>
        <html>
       <head>
        <script src="jquery.js"></script>
         <script>
          $(document).ready(function(){
        $(window).unload(function(){
        alert("Goodbye!");
         });
        });
       </script>
      </head>
     <body>
     <p>When you click <a href="http://www.google.com">this link</a>, or close the window, an alert box will be triggered.</p>
      </body>
     </html> 
```

它在我的 Firefox 中工作

# google-drive-api - 下载文档时出现 VersionConflictException

> ID：12391059
> 
> 赞同：2
> 
> 时间：2012-09-12T14:57:46.770
> 
> 标签：google-drive-api, google-docs-api

尝试从 Google Docs 下载文件时，有时会收到 VersionConflictException。我猜这是无害的，但为什么会发生这种情况？

我正在使用 gdata-media-1.0-1.41.3.jar

```
com.google.gdata.util.VersionConflictException: Conflict
at com.google.gdata.client.http.HttpGDataRequest.handleErrorResponse(HttpGDataRequest.java:612)
at com.google.gdata.client.http.GoogleGDataRequest.handleErrorResponse(GoogleGDataRequest.java:563)
at com.google.gdata.client.http.HttpGDataRequest.checkResponse(HttpGDataRequest.java:552)
at com.google.gdata.client.http.HttpGDataRequest.execute(HttpGDataRequest.java:530)
at com.google.gdata.client.http.GoogleGDataRequest.execute(GoogleGDataRequest.java:535)
at com.google.gdata.client.media.MediaService.getMediaResource(MediaService.java:234)
at com.google.gdata.client.media.MediaService.getMedia(MediaService.java:276)
at com.google.gdata.client.media.MediaService.getMedia(MediaService.java:302) 
```

我们使用的代码如下：

```
DocumentListEntry entry = ... // from the feed of changed documents
MediaContent documentContent = (com.google.gdata.data.MediaContent) entry.getContent();
String uri = documentContent.getUri();
MediaContent downloadContent = new MediaContent();
downloadContent.setUri(uri);
MediaSource mediaSource = docsService.getMedia(downloadContent);
InputStream inputStream = mediaSource.getInputStream();
File file = // some file
OutputStream output = new FileOutputStream(file);
try {
    IOUtils.copy(inputStream, output);
} finally {
    IOUtils.closeQuietly(output);
    IOUtils.closeQuietly(inputStream);
} 
```

# ipad - 模拟器上不存在的 iPad 设备 UIToolbar 错误

> ID：12391062
> 
> 赞同：0
> 
> 时间：2012-09-12T14:57:56.980
> 
> 标签：ipad, ios-simulator, uitoolbar

在 iPad 模拟器中运行通用应用程序时，如下所示的 UIWebview 效果很好：

![iPad模拟器](../Images/10be156a737cc7df6f8a2d90d8094b37.png)

但是，当我在 iPad 上运行它时，用户界面如下所示：

![iPad 设备](../Images/124b0c8a685cb2468af08bf4531b8c3c.png)

这个 UIToolbar 问题以前在设备和模拟器上都是一个问题，但是在我做了一些更改之后，现在只存在于设备上......有什么想法吗？

# opencl - 在英特尔集成 GPU 上进行 GP 开发的技术有哪些选择？

> ID：12391063
> 
> 赞同：3
> 
> 时间：2012-09-12T14:58:04.403
> 
> 标签：opencl, gpu, gpgpu, intel

开发在英特尔 Ivy Bridge 处理器的集成 GPU 上运行的通用软件时，我可以选择哪些技术、语言和工具？OpenCL（如果是，英特尔驱动程序？谁的编译器？）？库达？基于 LLVM 的东西？

我相信 DirectCompute 不适合我们，因为我们不会运行 Windows。

**编辑**：刚刚发现[这篇文章](http://vr-zone.com/articles/ivy-bridge-hd-graphics-to-gain-4k-display-support-in-october/17173.html)表明 IvyBridge 驱动程序很快就会支持 OpenCL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T21:53:23.557

正如@talonmies 指出的那样，集成GPU 支持英特尔OpenCL，但仅在Windows 上：

[http://software.intel.com/en-us/articles/opencl-sdk-frequently-asked-questions/#14](http://software.intel.com/en-us/articles/opencl-sdk-frequently-asked-questions/#14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T11:02:17.327

OpenGL-ES 在英特尔高清处理器上运行良好。

# windows-8 - 类似于 GridView 的页面，但具有静态组，并且每个组部分将具有不同的布局

> ID：12391066
> 
> 赞同：4
> 
> 时间：2012-09-12T14:58:13.943
> 
> 标签：windows-8, microsoft-metro, windows-runtime, winrt-xaml

我想在 Contoso Cookbook 应用程序中创建一个有点像 Grouped Items Page 的页面（如果你看过的话）。基本上，它是一个绑定到 CollectionViewSource 的 GridView。

```
 <CollectionViewSource
        x:Name="groupedItemsViewSource"
        Source="{Binding Groups}"
        IsSourceGrouped="true"
        ItemsPath="TopItems"
        d:Source="{Binding AllGroups, Source={d:DesignInstance Type=data:SampleDataSource, IsDesignTimeCreatable=True}}"/> 
```

GridView 似乎使用 Source 属性将 Groups 绑定到 CVS 数据源的最高级别，然后使用 ItemsPath 属性绑定每个单独的部分。

但是，我的页面不同之处在于我的组是静态的，它们是：时间、类别、列表。第一个将有一个列表视图，第二个是瓷砖网格，第三个将是另一个列表视图。

此外，每个组部分本身具有不同的布局。这不仅仅是重复组和重复项目布局。我期望能够直接在 XAML 中为每个组定义“静态”组和布局，甚至可能将测试数据添加到这些元素，但似乎 GridView*需要*数据绑定，即使只是到一个虚拟数据源设计时间。

那么你会怎么做呢？所以本质上，它需要与 GridView 完全相同的水平滚动和换行，但组具有完全不同的布局，并且理想情况下每个组应该可以直接在 XAML 中定义？

我正在考虑创建一个包含在滚动查看器中的普通网格......你怎么看？你会怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T02:56:40.367

在 GridView 中，可以为组分配[GroupStyle](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.groupstyle.aspx)，如下所示：

```
<GridView.GroupStyle>
    <GroupStyle HeaderTemplate="{StaticResource MyGroupHeaderTemplate}" 
                Panel="{StaticResource MyGroupItemsPanelTemplate}" 
                HidesIfEmpty="True" />
</GridView.GroupStyle> 
```

现在，在您的情况下，每个组都需要自己的 GroupStyle。因此，您可以在 GridView 的每个组中使用 ListView，而不是：

1.  使用标题模板和`ItemsPanelTemplate`要使用的面板 ( (MSDN))定义 2 种不同的组样式

2.  定义一个具有您的自定义逻辑的类，以选择用于组的组样式。（[GroupStyleSelector](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.groupstyleselector.aspx)）

3.  在 XAML 中的 GridView 上设置 GroupStyleSelector 属性

4.  在视图模型中定义静态组以包含您想要的数据：（时间、类别、列表）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T08:15:00.303

这可以通过[DataTemplateSelector](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.datatemplateselector.aspx)来完成。您将有多个组，但在每个组中，项目的样式不同。有关更多帮助文章，请参阅此[SO 帖子](https://stackoverflow.com/questions/12152406/gridview-binding-to-groups-of-different-viewmodels-combining-images-and-text/12179853#12179853)。

# ruby-on-rails - Hyper-V 中的 Gem 安装连接问题

> ID：12391087
> 
> 赞同：0
> 
> 时间：2012-09-12T14:59:13.790
> 
> 标签：ruby-on-rails, ruby, rubygems, virtual-machine, hyper-v

我有一个通过 Hyper-V 运行的 Windows Server 2010 VM。我可以使用虚拟机中的 Web 浏览器连接到单个 gem，但是当我为任何 gem 运行 gem install 时，连接超时并出现我在下面粘贴的错误。图像使用虚拟交换机 - 您认为这是导致问题的原因吗？我不知道如何解决这个问题。

```
C:\Ruby193\bin>gem install rails -V
Error fetching remote data:             Errno::ETIMEDOUT: A connection attempt f
ailed because the connected party did not properly respond after a period of tim
e, or established connection failed because connected host has failed to respond
. - connect(2) (http://rubygems.org/latest_specs.4.8.gz)
Falling back to local-only install
ERROR:  Could not find a valid gem 'rails' (>= 0) in any repository
ERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)
    Errno::ETIMEDOUT: A connection attempt failed because the connected party di
d not properly respond after a period of time, or established connection failed
because connected host has failed to respond. - connect(2) (http://rubygems.org/
latest_specs.4.8.gz) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:36:28.167

也许可能缺少的是代理配置（考虑到您可以浏览到 ruby​​gems.org）

您可以`--http-proxy`在命令中使用选项`gem install`或设置`HTTP_PROXY`环境变量。

首先，您需要获取代理配置，这很可能在您的 Web 浏览器中。

它应该如下所示：

```
http://host:port/ 
```

或者：

```
http://username:password@host:port/ 
```

您需要在以下位置使用它`gem install`：

```
gem install rails --http-proxy=http://host:port/ 
```

或者，如果将其设置为环境变量，则可以避免每次都键入它：

```
SET HTTP_PROXY=http://host:port/
gem install rails 
```

您可以通过文档查看有关此内容的更多详细信息`gem help install`。

希望有帮助。

# python - 从python中的函数创建一个新对象

> ID：12391090
> 
> 赞同：1
> 
> 时间：2012-09-12T14:59:18.153
> 
> 标签：python, object

```
class SlidePuzzle(object):

    def __init__(self, state = None):
        if state == None: state = [[1,2,3],[4,'N',5],[6,7,8]]
        self.puzzle_state = list(state)

    def isValidMove(self, move):
        x,y = self.getBlank()

        if move == 'up':
            return y != 0
        elif move == 'down':
            return y != 2
        elif move == 'left':
            return x != 0
        elif move == 'right':
            return x != 2
        else:
            print "Invalid Move"
            return 0
    def getValidMoves(self):
        validMoves = ['up', 'down', 'left', 'right']

        if not self.isValidMove('down'):
            validMoves.remove('down')
        if not self.isValidMove('up'):
            validMoves.remove('up')
        if not self.isValidMove('right'):
            validMoves.remove('right')
        if not self.isValidMove('left'):
            validMoves.remove('left')

        return validMoves

    def generateChildren(self):
        return [SlidePuzzle(self.puzzle_state).move(m) for m in self.getValidMoves()] 
```

如果我运行这些命令：

```
- p = SlidePuzzle()
- print p
- p.move('up')
- print p
- print p.generateChildren()
- print p 
```

这是输出。我没有包含我的所有源代码，但您可以看到移动功能根据需要工作。我不明白为什么 generateChildren 函数不仅似乎没有创建任何新的幻灯片拼图对象，而且还与调用对象的拼图状态相混淆。

```
- [1, 2, 3]
- [4, 'N', 5]
- [6, 7, 8]

- [1, 'N', 3]
- [4, 2, 5]
- [6, 7, 8]

- [None, None, None]

- [1, 2, 3]
- [4, 'N', 5]
- [6, 7, 8] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:07:02.733

`generateChildren`从 中返回返回值列表`SlidePuzzle.move()`，而不是`SlidePuzzle`对象列表。你不显示`move`，但我怀疑它返回无。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T15:02:57.390

列表是通过“引用”传递的，所以你必须首先复制列表，否则你的新 Puzzle 将在同一个列表上运行：

```
def generateChildren(self):
    return [SlidePuzzle(self.puzzle_state[:]).move(m) for m in self.getValidMoves()] 
```

注意`[:]`which 复制列表。

此外`.move`返回`None`，这就是它最终成为 beee 的原因`None`。

# python - [py.test]: 测试依赖

> ID：12391092
> 
> 赞同：9
> 
> 时间：2012-09-12T14:59:21.600
> 
> 标签：python, pytest

我正在使用 py.test 编写测试系统，并根据其他一些测试运行结果寻找一种方法来执行特定的测试。

例如，我们有标准的测试类：

```
import pytest

class Test_Smoke:
   def test_A(self):
       pass

   def test_B(self):
       pass

   def test_C(self):
       pass 
```

如果 test_A() 和 test_B() 通过，则应该执行 test_C()，否则 - 跳过。

我需要一种在测试或测试类级别上执行此类操作的方法（例如，如果所有 Test_Smoke 都通过了，则执行 Test_Perfo），并且我无法使用标准方法（例如 @pytest.mark.skipif）找到解决方案。

pytest有可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-07-20T08:15:42.003

您可能想看看[pytest-dependency](https://pytest-dependency.readthedocs.io/en/latest/index.html)。这是一个插件，如果其他一些测试失败，它允许您跳过一些测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-17T13:07:32.707

还要考虑[pytest-depends](https://pypi.org/project/pytest-depends/)：

```
def test_build_exists():
    assert os.path.exists(BUILD_PATH)

@pytest.mark.depends(on=['test_build_exists'])
def test_build_version():
    # this will skip if `test_build_exists` fails... 
```

# java - 我可以从我的应用程序管理 Android 中的闹钟吗？

> ID：12391093
> 
> 赞同：-1
> 
> 时间：2012-09-12T14:59:27.403
> 
> 标签：java, android

我开发了一个必须在 Android 中管理闹钟的应用程序。我特别需要执行以下操作：

*   当用户设置闹钟时在我的应用程序中执行一些代码（同时在执行时找出闹钟的时间）；
*   当用户在我的应用程序中按下特定按钮时取消警报；
*   当警报响起时，在我的应用程序中执行一些代码。

我必须提一下，我对 CPU 警报不感兴趣，而是对人们用来唤醒的闹钟应用程序感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:17:00.990

[您可以使用此处描述](http://developer.android.com/reference/android/provider/AlarmClock.html)的意图设置警报。

但是，您无法拦截 AlarmClock UI 或在您寻求时发出警报。

您可能想考虑安排自己的提醒，可能使用带有[RTC_WAKEUP](http://developer.android.com/reference/android/app/AlarmManager.html)的 AlarmManager。

# asp.net - updatepanel 根据请求和响应工作

> ID：12391094
> 
> 赞同：0
> 
> 时间：2012-09-12T14:59:32.517
> 
> 标签：asp.net, asp.net-ajax, updatepanel

我有 2 组`asp:TextBox`和`asp:Button`控件，其中一组在更新面板内，另一组在外部..

```
 <asp:UpdatePanel runat="server">
        <ContentTemplate>
            <asp:Button Text="text" runat="server" ID="btn1"/>
            <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        </ContentTemplate>
    </asp:UpdatePanel>
    <asp:Button Text="text" runat="server" ID="btn2"/>
    <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox> 
```

代码隐藏

```
 protected void Page_Load(object sender, EventArgs e)
    {
        TextBox1.Text = TextBox2.Text;
    } 
```

现在我的问题是，Updatepanel 究竟是如何工作的？

实际上我认为，`btn1`单击时，只有 UpdatePanel 的内容作为请求发送到服务器，而响应来自服务器仅发送到该更新面板。

因此，我在 TextBox2 中输入了一些文本并单击了`btn1`.. 但令人惊讶`TextBox1`的是，文本变成了`TextBox2`..

然后我想，整个页面作为请求发送到服务器，响应只发送到该 updatePanel 并相应更新..

现在我检查了 Google Chrome 开发者工具中的两个请求（即 Request from`btn1`和）。再次令我惊讶的是，请求`btn2`有所不同。`Content-Length`

如果更新面板之外有更多控件，那么`Content-Length`来自的请求会更多`btn2`

有人可以对此有所了解吗..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:24:24.973

好的..这里的事情是，即使您在页面中有一个 UpdatePanel，当发生回发时，所有内容都会回发到服务器。这就像没有 UpdatePanel 的普通页面。这就是您为 UpdatePanel 选择 UpdateMode 的原因...

它是**UpdateMode="Always"** 和**UpdateMode="Conditional"**。

因为您没有在此处设置任何内容，所以默认情况下始终为“始终”，因此整个页面都在回发...

要在添加 UpdatePanel 后查看您正在寻找的更改，您需要将其设置为条件并将元素添加为 AsynPostbackTriggers ...

```
<asp:UpdatePanel runat="server" UpdateMode="Conditional">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="btn1" />
    </Triggers>
    <ContentTemplate>
        <asp:Button Text="text" runat="server" ID="btn1"/>
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    </ContentTemplate>
</asp:UpdatePanel>
<asp:Button Text="text" runat="server" ID="btn2"/>
<asp:TextBox ID="TextBox2" runat="server"></asp:TextBox> 
```

现在，当您单击 btn1 时，只有 UpdatePanel 中的内容会被发回并且可以在响应中看到。

如果单击 btn2，则响应中只能看到 UpdatePanel 之外的内容。

# http - 在 Simperium 中创建每个用户的管理密钥

> ID：12391098
> 
> 赞同：1
> 
> 时间：2012-09-12T14:59:49.463
> 
> 标签：http, simperium

http API 文档要求为多个操作创建一个特殊的令牌（例如列出存储桶、所有更改）

X-Simperium-Token — 必须使用具有管理员权限的 API 密钥创建身份验证令牌

如何创建此令牌？

我尝试了几件事：

1.  `curl -H 'X-Simperium-Token: {my admin key}' https://api.simperium.com/1/{app_name}/buckets`. 这导致了“元”桶`{"buckets": [{"name": "exception"}, {"name": "code"}, {"name": "message"}]}`，这很有趣。

2.  `curl -H 'X-Simperium-API-Key: {my admin key}' -d '{"username":"{valid user}", "password":"{valid password}"}' https://auth.simperium.com/1/{app_name}/authorize/`. 结果：应用凭据无效

3.  使用我的普通密钥进行授权，它工作正常，并为我提供了一个访问令牌，我可以将其用于其他（非管理员）操作。

我的想法是，我需要以某种方式将我的管理密钥传递给“授权”，并为该用户生成一个拥有管理员权限的身份验证令牌（例如，列出他的所有存储桶）。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:41:49.280

您应该能够在任何需要使用具有管理员权限的 API 密钥创建的令牌的地方直接将管理员密钥用于令牌。我们目前正在开发 UI 以实际创建具有不同选项的这些 API 密钥。同时，您可以直接使用仪表板中的管理员密钥，也可以联系我们，我们可以为您创建一个。

# excel - 如何通过卸载清理注册表设置？

> ID：12391103
> 
> 赞同：0
> 
> 时间：2012-09-12T15:00:06.093
> 
> 标签：excel, installation, uninstallation

我有一个安装程序，需要在 \Software\Microsoft\Office\12.0\Excel\Options 下向 Currentuser 添加一个密钥。它必须是 CurrentUser，因为 excel 不在 LocalMachine 中查找。我有一个客户需要管理员权限才能安装。我发现当安装程序以管理员用户身份运行时，密钥是在管理员用户注册表设置下创建的。为了解决这个问题，我编写了一个自定义操作，该操作在 Currentuser 中创建了 Excel 密钥，然后将该密钥复制到当前登录到计算机的所有其他用户。这似乎有效。

我现在遇到的问题是卸载。注册表项保留在原位，这会导致 Excel 出现问题。在卸载时摆脱此注册表项的最佳方法是什么？

我在 VS 2010 中使用 Windows 安装程序。

居里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T01:29:14.330

尝试安装和运行 Revo Uninstaller。安装完成后，看看excel是否还有待卸载。在 REVO 中，卸载过程中有一个步骤，您可以在其中选中要删除的注册表项的复选框（粗体文本）。

[http://www.bleepingcomputer.com/download/revo-uninstaller/](http://www.bleepingcomputer.com/download/revo-uninstaller/)

（在网站上，单击“立即下载”而不是顶部的“下载”按钮（这只是指向 google 线索的链接）。

# c# - 有没有办法可以添加代码以将计时器列表更新到我继承的类中？

> ID：12391104
> 
> 赞同：0
> 
> 时间：2012-09-12T15:00:11.087
> 
> 标签：c#

我有以下课程：

```
public abstract class BaseGridViewModel 
{
    protected BaseGridViewModel() 
    {
        Timer = new List<long>();
    }
    public List<long> Timer { get; set; }
}
public class CityReportViewModel : BaseGridViewModel 
{
    public IEnumerable<City.Grid> Grid { get; set; }
} 
```

在我的操作代码中，我正在做这样的计时：

```
 var vm = new CityReportViewModel();
        var sw = Stopwatch.StartNew();
        try {
            //
            vm.Timer.Add(sw.ElapsedMilliseconds);
            //
            vm.Timer.Add(sw.ElapsedMilliseconds);
            //
            // Lots more vm.Timer.Add lines ...
        } catch (Exception e) {
            log(e);
        } finally {
            sw.Stop();
        } 
```

因为我做了很多计时，所以我的控制器中重复了很多次 vm.Timer.Add 代码。

有什么方法可以通过更改 ViewModel 来简化计时器编码。我正在考虑的事情是将计时器设置为 ViewModel 中的一个字段，然后通过某种方式告诉 ViewModel 我想记录一个新的计时事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:09:25.410

我不太确定你的要求，但听起来你需要一个观察者。您的“BaseGridViewModel”可能会将自己注册到观察者。观察者可能会引发一个事件来更新所有附加的 BaseGridViewModel 中的所有计时器。

## 编辑

这就是我所说的：

```
 public class TimerUpdateService
    {
        public TimerUpdateService()
        {
            // May create here a Stopwatch to measure your time.
        }

        private EventHandler<EventArgs> _updater;

        public void Register(BaseGridViewModel baseGridViewModel)
        {
            _updater += baseGridViewModel.timerUpdate_UpDateTimers;
        }

        public void Unregister(BaseGridViewModel baseGridViewModel)
        {
            _updater -= baseGridViewModel.timerUpdate_UpDateTimers;
        }

        /// <summary>
        /// Call this method to refresh all timers on the registred 'BaseGridViewModel'.
        /// </summary>
        public void UpdateAllViewModels()
        {
            EventHandler<EventArgs> handler = _updater;
            if (handler != null)
                handler(this, EventArgs.Empty);
        }

    }

    public abstract class BaseGridViewModel
    {
        protected BaseGridViewModel()
        {
            Timer = new List<long>();
        }

        public void timerUpdate_UpDateTimers(object sender, EventArgs e)
        {
            Timer.Add(e.elapsed);
        }

        public List<long> Timer { get; set; }

    }

    public class CityReportViewModel : BaseGridViewModel
    {
        public IEnumerable<City.Grid> Grid { get; set; }

    } 
```

愿这就是你所需要的。上面的代码只是一个例子..

# delphi - 使用环境变量调试时“程序无法启动，因为 ....dll 丢失”

> ID：12391105
> 
> 赞同：4
> 
> 时间：2012-09-12T15:00:12.980
> 
> 标签：delphi, debugging, dll, delphi-xe2

在这些情况下，在 Delphi XE2 update 4 中调试可执行文件时，我得到了进一步提到的错误：

*   这取决于系统路径`mqic.dll`中的 WebShpere （`C:\Program Files \IBM\WebSphere MQ\bin\mqic.dll`而`C:\Program Files\IBM\WebSphere MQ\bin`不是用户路径）。
*   正在使用`Run`-> `Parameters`-> `Debugger`-> `Environment Block`->中的覆盖环境变量进行调试`User overrides`
*   `Including System Variables`在同一属性页上进行检查

这是错误（它是标记为“系统错误”的 Windows DLL 加载错误）。

> 程序无法启动，因为您的计算机缺少 mqic.dll。尝试重新安装程序以解决此问题。

几点注意事项：

*   我以普通用户的身份进行调试（无论如何这是正常的做法，但在这种情况下，由于客户端的策略，我不能成为管理员）。
*   一旦我删除了环境变量，它就可以工作（但是程序 barfs 因为它确实需要信息）。
*   在 Delphi 启动之前指定环境变量很麻烦，但作为一种临时解决方法是可行的（我需要在调试时经常更改该变量以测试不同的场景；Delphi 的启动/关闭时间使这很乏味）。
*   我不能没有环境变量，因为它是没有源代码的应用程序所必需的，并且无法及时重写以使其被逐步淘汰

这是事件日志显示的内容：

```
Faulting application name: CAS400NTMQ.exe, version: 1.1.4639.52512, time stamp: 0x50508180
Faulting module name: ntdll.dll, version: 6.1.7601.17725, time stamp: 0x4ec49b60
Exception code: 0xc0000005
Fault offset: 0x0005333f
Faulting process id: 0x4b20
Faulting application start time: 0x01cd90e36bb90816
Faulting application path: C:\Users\...\bin\CAS400NTMQ.exe
Faulting module path: C:\Windows\SYSTEM32\ntdll.dll
Report Id: a9853965-fcd6-11e1-ae66-78e3b5ca2514 
```

问题：有没有比我上面使用的其他解决方案或更简单的解决方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:22:46.423

根据[Andreas Hausladen 的最新博文](http://andy.jgknet.de/blog/2012/09/patches-from-ide-fix-pack-that-were-applied-to-xe3/)和[他的回答](https://stackoverflow.com/questions/9963790/standard-dialog-does-not-popup/9964517#9964517)，IDEFixPack 解决了这个 XE2 错误。并且在 XE3 中不需要，因为 XE3 解决了这个问题。

所以我怀疑如果你能设法在这台机器上安装[IDEFixPack](http://andy.jgknet.de/blog/ide-tools/ide-fix-pack-2009-10/) ，这可能是最有效的解决方法。即使您无法安装 IDEFixPack，那么这个答案仍然对其他读者有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T17:48:14.123

Delphi XE2 对用户覆盖的环境变量的处理有问题。获取示例应用程序：

```
program Project1;

{$APPTYPE CONSOLE}

uses
  System.SysUtils;

begin
  Writeln(GetEnvironmentVariable('PATH'));
  Readln;
end. 
```

当调试器用完或没有用户覆盖环境变量时，这会很好地输出路径。但是只要在 Run->Parameters->Environment Block 中引入环境变量，它就会输出一个空字符串。

一种可能的解决方法似乎是覆盖所需的变量，在本例中为“PATH”。然后程序可以再次输出（并可能使用）正确的路径。显然，这是一个相当有限的解决方法。一旦你使用了用户覆盖，你失去的不仅仅是“PATH”。Fi 示例程序仍然无法输出“APPDATA”。

以前的 Delphi 版本似乎没有这个问题。有一个关于 QC 的报告：[Include System Variables is not working](http://qc.embarcadero.com/wc/qcmain.aspx?d=103388) again，它在构建 17.0.4625.53395 中作为“固定”关闭。

# c# - Linq 的 except 方法不适用于字节值

> ID：12391107
> 
> 赞同：3
> 
> 时间：2012-09-12T15:00:15.480
> 
> 标签：c#, .net, linq

```
 [TestMethod()]
    public void TestExceptWithRandomInput()
    {
        byte[] listA =  new byte[4096];
        var rand = new Random();
        rand.NextBytes(listA);

        byte[] listB = new byte[] { 0x00 };
        var nullCount = (from a in listA
                         where a == 0x00
                         select a);

        var listC = listA.Except(listB);

        Assert.AreEqual(4096, listA.Length);
        Assert.AreEqual(4096 - nullCount.Count(), listC.Count()); //Fails!!
    }

    [TestMethod()]
    public void TestWhereWithRandomInput()
    {
        byte[] listA = new byte[4096];
        var rand = new Random();
        rand.NextBytes(listA);

        byte[] listB = new byte[] { 0x00 };
        var nullCount = (from a in listA
                         where a == 0x00
                         select a);

        var listC = listA.Where(a => !listB.Contains(a));

        Assert.AreEqual(4096, listA.Length);
        Assert.AreEqual(4096 - nullCount.Count(), listC.Count()); //Successful
    } 
```

上面的代码在使用 except() 函数时似乎失败，但在使用 Where() 时工作​​正常。似乎缺少什么？我需要为字节实现 IEqualityComparer 吗？我认为这仅对复杂类型是必需的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:06:46.207

`Except`也摆脱了第一个参数中的重复项。这是一个集合操作，集合并不意味着重复 - 与`Union`等相同`Intersect`。

`listA.Except(listB)`给出 . 中所有*唯一*的非空字节`listA`。

如果您想获取序列中的所有非空字节，这`listA.Where(b => b != 0x00)`可能是合乎逻辑的事情。

如果要计算空字节，`listA.Count(b => b == 0x00)`最清楚地表达这一点。

如果你想要一个“除了但保留重复”，而不是`!Contains`对每个不是很有效的项目做一个，你可以做类似的事情：

```
public static IEnumerable<T> ExceptWithDuplicates<T>(
    this IEnumerable<T> source1,
    IEnumerable<T> source2)
{
    HashSet<T> in2 = new HashSet<T>(source2);
    foreach(T s1 in source1)
    {
        if(!in2.Contains(s1)) // rather than if Add
        {
            yield return s1;
        }
    }
} 
```

（免责声明：不是在 IDE 中编写的。）这与常规的基本相同`Except`，但它不会*将*源项目添加到内部`HashSet`，因此它会多次返回相同的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:08:00.433

除了返回一组值，这意味着它将只返回每个值一次

# java - 在java中创建一个文本文件

> ID：12391114
> 
> 赞同：1
> 
> 时间：2012-09-12T15:00:40.120
> 
> 标签：java, file, text, text-files, filewriter

我在创建具有我想要的名称的文本文件时遇到问题。

我想创建一个名为：'username' Subjects 的文本文件。

```
 private void saveSubjects(){

    RegisterFrame r = new RegisterFrame();

    String username = r.txtUser.getText();;

    try{
        FileWriter f = new FileWriter(username + "" + "Subjects" + ".txt", true);

        String subjects[] = lstSubjects.getItems();

        for(int i = 0; i<subjects.length; i++){
            f.write(subjects[i] + "\r\n");
        }
        f.close();
        JOptionPane.showMessageDialog(null, "Data saved!", "Data Saved", JOptionPane.INFORMATION_MESSAGE);
    }catch(Exception e){
        JOptionPane.showMessageDialog(null, "Nothing Inputted!", "Error", JOptionPane.ERROR_MESSAGE);
    }

} 
```

我想从 RegisterFrame 获取用户名，因为它是在那里输入的，但它不起作用。我知道这是一件简单的事情，但我仍然是这方面的初学者。我该如何解决这个问题？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:17:00.560

尝试这个：

```
String username = r.txtUser.getText();
System.out.println("The loaded username is: " + username); 
```

然后您将看到问题出在哪里：写入文件或获取用户名文本。

如果问题在于获取文本，请考虑其他获取文本的方式或通过删除文件写入部分并指定用户名获取部分来修改问题。

否则，IDK 哪里出错了。

顺便说一句：它怎么不起作用？该文件根本没有创建？你看到任何错误吗？文件名称错误？请明确说明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:25:42.310

您编写文件的代码似乎很好。根据您的代码，我尝试了这个，效果很好：

```
public static void main(String[] args) {

    FileWriter f = null;
    try {
        f = new FileWriter("Subjects.txt", true);

        String subjects[] = {"subject1", "subject2"};

        for (String subject : subjects) {
            f.write(subject + "\r\n");
        }

    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        IOUtils.closeQuietly(f);
    }
} 
```

我会说你的问题在其他地方。

请注意，最佳实践要求 Closeable 对象，例如`FileWriter`应该在 finally 块中关闭

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:34:04.857

假设`new RegisterFrame()`启动一个 GUI 窗口，问题是你的代码在你有机会输入你的名字之前运行。相反，您需要使用[事件侦听](http://docs.oracle.com/javase/tutorial/uiswing/events/index.html)器来捕获文本字段的内容，否则获取名称的代码会在窗口打开后立即运行，远在您有机会输入任何内容之前。

时间线是这样的：

1.  RegisterFrame 启动一个新线程来显示 GUI 而不会阻塞您的代码
2.  您的代码立即从 txtUser 中提取“”，这当然是空的
3.  *现在*你输入你的名字
4.  什么也没有发生，因为您的代码中没有任何内容关注该操作

相反，它应该是：

1.  RegisterFrame 启动一个新线程来显示 GUI 而不会阻塞您的代码
2.  该方法返回或开始执行不依赖于 GUI 的工作
3.  *现在*你输入你的名字
4.  从新线程触发事件侦听器，并执行获取名称和写入文件的相关操作

您必须确定哪种侦听器对您的用例有意义，例如，您可能希望等到用户单击按钮（例如“提交”或“写入文件”）并在该按钮上注册一个[ActionListener 。](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)然后你把你的用户名轮询和文件写入行为放在那个动作中*，你就是金子！

[*我应该补充一点，实际上您希望在 ActionListeners 中做的尽可能少，最好检查用户名是否不为空，然后将实际工作传递给另一个线程，例如使用[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)，但是对于你的目的我怀疑不用担心是可以的。]

# sql-server - 如何创建带有模块名称前缀的表？

> ID：12391124
> 
> 赞同：1
> 
> 时间：2012-09-12T15:01:06.717
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2008r2-express

我下载了 AdentureWorks 数据库并找到了一种新样式来创建如下表。

1.  Sales.SalesOrderHeader
2.  人.人
3.  Sales.SalesOrderDetail

你能解释一下如何创建可以有模块前缀的表吗？

如果您对查询有任何困惑，请告诉我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T07:13:17.687

您可以在这里找到的视频： [一](http://vimeo.com/3098935)、[二](http://www.youtube.com/watch?v=4XMigeEc0vg)、[三](http://www.youtube.com/watch?v=6cYP6Yf68As)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T06:21:37.320

您可以根据给定的模块名称更改架构。

架构名称 = `Sales`in`SalesOrderHeader`和`SalesOrderDetail`Table

并且当您当时访问表时写`Sales.SalesOrderHeader`

默认情况下，架构名称是`dbo`

# qt - QPushButton css 按下

> ID：12391125
> 
> 赞同：2
> 
> 时间：2012-09-12T15:01:09.417
> 
> 标签：qt, qpushbutton

我需要在`QPushButton`按下状态时更改 a 的背景图像。我试过这个CSS：

```
QPushButton { background: transparent; border: none;} 
QPushButton:pressed { image: url(\mypath\settings_press.png); } 
```

但是运行时我收到以下错误：

> 无法解析小部件的样式表

任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T15:11:33.680

我见过的所有 Qt 样式表示例都使用 UNIX 样式路径，因此您的 CSS 应该如下所示：

```
QPushButton { background: transparent; border: none;} 
QPushButton:pressed { image: url(/mypath/settings_press.png); } 
```

此外，Qt 样式表的 URL 需要是 Qt 资源的相对路径，例如：

```
QPushButton:pressed { image: url(':images/settings_press.png') } 
```

或绝对路径，例如：

```
QPushButton:pressed { image: url('/usr/share/icons/crystalsvg/settings_press.png') } 
```

除非您绝对可以保证图像的安装路径，否则我会走资源路线。

# module - magento 事件观察者 (magento1.7)

> ID：12391127
> 
> 赞同：3
> 
> 时间：2012-09-12T15:01:17.200
> 
> 标签：module, magento-1.7

我正在尝试在我的模块（app/code/local/Foo/Bar）中实现一个简单的观察者。我的目标是在前端加载产品时将产品名称设置为“[产品名称] 很酷”。

这些是我的文件： **app/code/local/Foo/Bar/etc/config.xml**

```
<?xml version="1.0" encoding="UTF-8"?>

<config>
    <global>
        <models>
            <foo_bar>       
                    <class>Foo_Bar_Model</class>
            </foo_bar>  
        </models>
    </global>
    <frontend>
        <events>
            <catalog_product_load_after>
                <observers>
                    <foo_bar>
                        <type>model</type>
                        <class>foo_bar/observer</class>
                        <method>catalogProductLoadAfter</method>
                    </foo_bar>
                </observers>
            </catalog_product_load_after>
        </events>
    </frontend>
</config> 
```

**app/code/local/Foo/Bar/Model/Observer.php**

```
<?php 
class Foo_Bar_Model_Observer{

public function catalogProductLoadAfter(Varien_Event_Observer $observer)

{
    $product = $observer ->getProduct();

    $product ->setName($product.getName().' '.'is cool');
} 
}
?> 
```

而且我还在**app/etc/modules/Foo_Bar.xml中配置了模块**

```
<?xml version="1.0" encoding="UTF-8"?>
 <config>
   <modules>
     <Foo_Bar>
        <active>true</active>
        <codePool>local</codePool>
     </Foo_Bar>
  </modules>
</config> 
```

但它确实有效，有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T13:12:32.937

您只需要模型的模块名称：

```
<foo_bar>
     <type>model</type>
     <class>bar/observer</class>
     <method>catalogProductLoadAfter</method>
</foo_bar> 
```

你不需要指定 Foo_Bar

你的PHP也有错误

```
$product ->setName($product.getName().' '.'is cool'); 
```

应该

```
$product->setName($product->getName().' '.'is cool'); 
```

# ios - 点击 tablecell 显示 UIDatePicker

> ID：12391129
> 
> 赞同：2
> 
> 时间：2012-09-12T15:01:24.377
> 
> 标签：ios, uitableview, uidatepicker, tablecell

我有一个表格视图控制器，其中一个单元格是“日期”，当我单击时，我想显示一个日期选择器并更新值。

![带有日期单元格的表格](../Images/8497a80d1de8e76143f38c7555b592b1.png)

当我点击限制日期时，我得到

![带日期选择器的表](../Images/62ce474c5d788b098264a6872f35cd77.png)

现在这里是代码：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if ( indexPath.section == 0 )
    {
        if ( indexPath.row == 3 )
        {
            UITableViewCell *targetCell = [tableView cellForRowAtIndexPath:indexPath];
            self.pickerView.date = [self.dateFormatter dateFromString:targetCell.detailTextLabel.text];

            // check if our date picker is already on screen
            if (self.pickerView.superview == nil)
            {
                [self.view.window addSubview: self.pickerView];
                // size up the picker view to our screen and compute the start/end frame origin for our slide up animation
                //
                // compute the start frame

                CGRect screenRect = [[UIScreen mainScreen] applicationFrame];
                CGSize pickerSize = [self.pickerView sizeThatFits:CGSizeZero];
                CGRect startRect = CGRectMake(0.0,
                                              screenRect.origin.y + screenRect.size.height,
                                              pickerSize.width, pickerSize.height);
                self.pickerView.frame = startRect;

                // compute the end frame
                CGRect pickerRect = CGRectMake(0.0,
                                               screenRect.origin.y + screenRect.size.height - pickerSize.height,
                                               pickerSize.width,
                                               pickerSize.height);
                // start the slide up animation
                [UIView beginAnimations:nil context:NULL];
                    [UIView setAnimationDuration:0.3];

                    // we need to perform some post operations after the animation is complete
                    [UIView setAnimationDelegate:self];

                    self.pickerView.frame = pickerRect;

                    // shrink the table vertical size to make room for the date picker
                    CGRect newFrame = self.tableView.frame;
                    newFrame.size.height -= self.pickerView.frame.size.height;
                    self.tableView.frame = newFrame;
                [UIView commitAnimations];

                // add the "Done" button to the nav bar

                self.navigationItem.rightBarButtonItem = self.doneButton;
            }
        }
    }
}

- (IBAction)dateChanged:(id)sender
{
    [self.tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:3 inSection:0]].detailTextLabel.text = [self.dateFormatter stringFromDate:[sender date]];
}

- (void)slideDownDidStop
{
    [self.pickerView removeFromSuperview];
}

- (IBAction)doneAction:(id)sender
{
    CGRect screenRect = [[UIScreen mainScreen] applicationFrame];
    CGRect endFrame = self.pickerView.frame;
    endFrame.origin.y = screenRect.origin.y + screenRect.size.height;

    // start the slide down animation
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    // we need to perform some post operations after the animation is complete
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDidStopSelector:@selector(slideDownDidStop)];

    self.pickerView.frame = endFrame;
    [UIView commitAnimations];

    // grow the table back again in vertical size to make room for the date picker
    CGRect newFrame = self.tableView.frame;
    newFrame.size.height += self.pickerView.frame.size.height;
    self.tableView.frame = newFrame;

    // remove the "Done" button in the nav bar
    self.navigationItem.rightBarButtonItem = nil;

    // deselect the current table row
    NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
    [self.tableView deselectRowAtIndexPath:indexPath animated:YES];

    self.navigationItem.rightBarButtonItem = self.nextButton;
} 
```

我有三个问题：

第一：日期选择器顶部的黑条是什么，我如何删除它？

第二：当用户在日期选择器外部单击时，我可以做些什么来关闭日期选择器？

第三：如何移动表格视图滚动，以便在打开日期选择器时可以看到“限制日期”字段？

对不起，大屏幕截图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:15:15.487

[在 UIActionSheet 中以模态方式呈现您的日期选择器](https://stackoverflow.com/questions/349858/fitting-a-uidatepicker-into-a-uiactionsheet)怎么样？

在上面的示例中，黑色条（可能是大小问题）被替换为方便的工具栏，您可以在其中放置“保存”和“取消”等按钮，我相信如果您使用 a`UIActionSheet`并在其外部单击它自动关闭（我不确定），但如果不是，你可以使用它的`dismiss`方法来隐藏它。

关于表格视图，您可以使用`[myTableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:someRow inSection:someSection] atScrollPosition:UITableViewScrollPositionMiddle animated:YES];`在您想要的特定单元格处设置表格滚动的偏移量。

# jquery - .click 事件在 ajax 请求后不起作用

> ID：12391131
> 
> 赞同：0
> 
> 时间：2012-09-12T15:01:27.497
> 
> 标签：jquery, ajax

我正在使用 jQuery 1.7.2 版本，我正在使用 Ajax 提交我的表单

```
$("input#addPostSubmit").click( function(){
    $.ajax({
            //this is the php file that processes the data and send mail
            url: BASE_URL+"post/ajaxcreate",    
            //POST method is used
            type: "POST",
            //pass the data         
            data: $("#addImage").serialize(),       
            //Do not cache the page
            cache: false,
            //success
            success: function (html) {
                         var obj = jQuery.parseJSON(html);          
                    if(obj.Status == 'Success'){
                        $("#error").removeClass('hide');
                        $("#error").addClass('success');
                        $("#error").html(obj.Message);
                        $.fn.colorbox.resize();
                        setTimeout(function(){$.fn.colorbox.close()},5000);
                        window.parent.location.reload();    
                    }
                    if(obj.Status == 'Fail'){
                        $('.add_post_submit').html('<input type="button" id="addPostSubmit" value="Create" />');
                        $("input#addPostSubmit").removeAttr('disabled');
                        $("#error").removeClass('hide');
                        $("#error").addClass('error');
                        error = obj.Message.split(';');
                        html = '<ul>';
                        for(a=0;a<error.length;a++){
                            html += '<li>'+error[a]+'</li>';
                        }
                        html += '</ul>';    
                        $("#error").html(html);
                        $('html').css({overflow: 'hidden'});
                        $.fn.colorbox.resize();
                    }
            }       
    });
}); 
```

例如，在表单字段之一上不允许使用 null。当服务器验证表单并返回错误时，我会显示它，当我再次单击该按钮时它不起作用。

它工作正常，但问题是当 ajax 请求完成并且服务器返回任何表单错误然后提交按钮不起作用时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:12:18.637

我建议收听文档上的提交事件，而不是单击处理程序。

```
$(document).on('submit','form',function(e){
  e.preventDefault();
  $.ajax({
          //this is the php file that processes the data and send mail
          url: BASE_URL+"post/ajaxcreate",    
          //POST method is used
          type: "POST",
          //pass the data         
          data: $("#addImage").serialize(),       
          //Do not cache the page
          cache: false,
          //success
          success: function (html) {
              // come code
          }       
  });
}); 
```

# c# - 按下表单按钮时触发

> ID：12391138
> 
> 赞同：1
> 
> 时间：2012-09-12T15:01:52.147
> 
> 标签：c#, asp.net

有人可以指出我正确的方向吗？我试图在按下表单按钮时触发循环。

//伪代码while(button1被按下) value1 += 1 然后松开按钮就停止循环

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:05:07.203

为了避免使用线程，您可以`Timer`在表单/控件上添加一个组件，并尝试在鼠标按下时启用它并在鼠标按下时禁用它。然后将通常放入循环中的代码放入`Timer_Tick event`.

# ember.js - 如何处理 ember-data 交易错误？

> ID：12391139
> 
> 赞同：4
> 
> 时间：2012-09-12T15:01:51.287
> 
> 标签：ember.js, ember-data

我如何知道事务提交何时失败？

```
var obj = App.store.findAll(App.Todo).get('firstObject');
var t = App.store.transaction();

t.add(obj);
obj.set('summary','New Summary');
t.commit();
// 403 or 401 is returned from the server (request failed)
a.get('isLoading'); // true
a.get('isError'); // false 
```

用例：我希望用户看到他的操作（保存对象）失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T12:32:22.427

事实上，截至今天，ember-data`RESTAdapter`不会处理提交请求上的错误。

您可能会对以下提出错误处理支持[的 PR感兴趣。](https://github.com/emberjs/data/pull/376)

# javascript - 在 IE 中设置 href 属性而不更改链接外观而不设置 innerHTML

> ID：12391144
> 
> 赞同：1
> 
> 时间：2012-09-12T15:02:09.527
> 
> 标签：javascript, internet-explorer

IE 有一个问题，例如，如果我尝试动态更改如下链接：

```
<a href="http://www.foo.com">www.foo.com</a> 
```

至

```
<a href="http://www.bar.com?q=www.foo.com">www.foo.com</a> 
```

使用 JavaScript 将链接更改为（仅在 IE 中）

```
<a href="http://www.bar.com?q=www.foo.com">http://www.bar.com?q=www.foo.com</a> 
```

这不是我想要做的。

我找到了解决方案，例如保存 interHTML、更改链接并使用旧值恢复 interHTML……但是如果内部内容有一些动态附加的事件怎么办？将丢失。

目前我尝试检查是否有任何带有innerHTML的HTML属性，如果没有，我会恢复旧的HTML。

```
function change_link(a,newlink)
{
    if(navigator.appName == 'Microsoft Internet Explorer') {
        var old = a.innerHTML ;
        if(old.indexOf('<')==-1) {
            a.href=newlink;
            a.innerHTML = old;
            return
        }
    }
    a.href=newlink;
} 
```

可能有什么问题吗？

是否可以动态地将事件附加到内部 HTML 的纯文本中，并且在内部 HTML 重置期间它会丢失？

# android - 使用 WebView 实现登录流程的问题

> ID：12391149
> 
> 赞同：1
> 
> 时间：2012-09-12T15:02:30.210
> 
> 标签：android

我在使用`webview`登录流程。如果用户只是在最初打开的页面上输入他的信息，一切都会正常工作。我收到了对 onPageFinished 的回调，我从 URL 中提取了一个令牌并从那里继续。但是，如果在最初打开的页面上，用户单击以使用 facebook 登录，那么他们将被重定向到 facebook 的登录页面，我似乎什至在 onPageFinished 中收到了该 URL 加载的回调。但是，如果用户以这种方式导航到 FB，那么我在 onPageFinished 中执行的其他异步调用将不会执行。如果他们只是立即输入他们的登录凭据，那么一切都很好。使用 FB，一切都会停止。没有相关日志，没有任何类型的崩溃。以下内容让您了解这一切的样子（我知道以下内容甚至不是有效的 Java 并且不会编译，但我

```
SomeAwesomeName extends Fragment {

    View onCreateView {
        Webview webView = new WebView;
        webview.setWebViewClient(new MyClient)
        return webiew;
    }

    class MyClient extends WebViewClient {
     onPageFinished(String url) {
        if(url.contains("/user/login/done")) { //user hit login on the initially opened page and we're good
            //grab a token from that url and do some asynchronous call
            SomeClass.fetchSomethingAsync("what to fetch", new CallBack() {
                void done(data) {
                    startActivity(new Intent("bla bla"))
                    getActivity.finish
                }
            })
        }
     }
    }

} 
```

我意识到上面的内容可能有点令人困惑，所以让我将问题总结如下：在所有情况下，当我们被定向到包含“user/login/done”的 URL 时，登录流程就会结束。无论用户选择使用他们的电子邮件/密码还是决定使用 facebook，登录流程总是在同一个地方结束。

流程只能是以下两种可能性之一：

***第一种可能性（这可行）*** 片段变得可见-> WebView加载URL->用户使用电子邮件/密码登录->调用onPageFinished->提取令牌->在onPageFinished内部触发异步调用并在回调时启动一个新活动叫。

***第二种可能性*** 片段变得可见-> WebView加载URL->用户单击以使用重定向到FB的FaceBook登录->调用onPageFinished->提取令牌->然后...什么也没有。

这里唯一的区别是用户在网页方面导航更深一层。除此之外，我无法弄清楚到底发生了什么。在 FB 登录成功后实际上调用 onPageFinished 的事实让我更加陌生。onPageFinished 被调用，我可以从传递给我的 URL 中获取令牌，但随后 onPageFinished 就像停止执行一样。该应用程序没有遇到 ANR 或崩溃，并且日志中没有任何可疑之处。

**编辑**

实际上，我现在看到在 onPageStarted 中传递给我的 URL 之一包含：

> Ferror_reason%3Duser_denied%26error%3Daccess_denied%26error_description%3DThe%2Buser%2Bdenied%2Byour%2Brequest

所以 webview/webviewclient 发生了一些奇怪的事情。有什么想法吗？

**编辑**

即使出现 FB“用户拒绝访问”错误，我连接到与 FB 接口以处理登录的 Web 服务实际上也能够检索 FB 的令牌。在日志中，我看到 FB 错误，然后重定向回 web 服务到 user/login/done?token=FACEBOOK_TOKEN_HERE。

但是我似乎仍然无法在我的 onPageFinished 内部继续执行以启动一个新的活动。我什至尝试过在新线程中做所有事情或将可运行的内容发布到 getActivity().runOnUiThread，但似乎都没有帮助。

# c# - 我如何遍历两个列表来比较两个列表中的项目？

> ID：12391153
> 
> 赞同：0
> 
> 时间：2012-09-12T15:02:39.617
> 
> 标签：c#

我有这个代码：

```
private void removeDuplicates(List<string> currentSites, List<string> visitedSites)
        {
            for (int i = 0; i < currentSites.Count; i++)
            {
                for (int x = 0; x < visitedSites.Count; x++)
                {

                }
            }                    
        } 
```

我得到两个列表，我需要首先将一个列表中的每个项目与另一个列表中的项目进行比较，以循环遍历另一个列表中的所有项目并进行比较。如果其中一项存在于另一个 List 中，则将其标记为 NULL。

我需要检查visitedSites 是否在currentSites 中，以便将一项移动到所有列表中，以检查是否退出是否将其标记为null。

在任何情况下，我都需要使用两个循环，一个在另一个循环中。

当我发现它的 null 以将其标记为 null 并在它中断之后；

然后，如果我没有错，我需要添加另一个循环 FOR 来移动 List currentSites 并删除所有标记为 NULL 的项目。

这个想法是通过将重复的项目标记为空来比较列表，然后删除所有空的。

这是一开始的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using HtmlAgilityPack;
using System.IO;
using System.Text.RegularExpressions;
using System.Xml.Linq;
using System.Net;
using System.Web;

namespace GatherLinks
{
    public partial class Form1 : Form
    {
        List<string> currentCrawlingSite;
        List<string> sitesToCrawl;
        int actual_sites;
        BackgroundWorker worker;
        int sites = 0;
        int y = 0;
        string guys = "http://www.google.com";

        public Form1()
        {
            InitializeComponent();

            currentCrawlingSite = new List<string>();
            sitesToCrawl = new List<string>();
            actual_sites = 0;
                    }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private List<string> getLinks(HtmlAgilityPack.HtmlDocument document)
        {

            List<string> mainLinks = new List<string>();
            var linkNodes = document.DocumentNode.SelectNodes("//a[@href]");
            if (linkNodes != null)
            {
                foreach (HtmlNode link in linkNodes)
                {
                    var href = link.Attributes["href"].Value;
                    mainLinks.Add(href);
                }
            }
            return mainLinks;

        }

        private List<string> webCrawler(string url, int levels , DoWorkEventArgs eve)
        {
                HtmlAgilityPack.HtmlDocument doc;
                HtmlWeb hw = new HtmlWeb();
                List<string> webSites;// = new List<string>();
                List<string> csFiles = new List<string>();

                csFiles.Add("temp string to know that something is happening in level = " + levels.ToString());
                csFiles.Add("current site name in this level is : " + url);
                                try
                {
                    doc = hw.Load(url);
                    currentCrawlingSite.Add(url);
                    webSites = getLinks(doc);
                    removeDuplicates(currentCrawlingSite, webSites);
                    removeDuplicates(currentCrawlingSite, sitesToCrawl);
                    sitesToCrawl = webSites;

                    if (levels == 0)
                    {
                        return csFiles;
                    }
                    else
                    {

                        for (int i = 0; i < webSites.Count() && i < 20; i++)                         {
                            int mx = Math.Min(webSites.Count(), 20);

                            if ((worker.CancellationPending == true))
                            {
                                eve.Cancel = true;
                                break;
                            }
                            else
                            {

                                string t = webSites[i];
                                                                if ((t.StartsWith("http://") == true) || (t.StartsWith("https://") == true)) 
                                {

                                        actual_sites++;
                                        csFiles.AddRange(webCrawler(t, levels - 1,eve));
                                        this.Invoke(new MethodInvoker(delegate { Texts(richTextBox1, "Level Number " + levels + " " + t + Environment.NewLine, Color.Red); }));
                                        worker.ReportProgress(Math.Min((int)((double)i / mx * 100),100));

                                }
                            }
                        }

                        return csFiles;
                    }

                }
                catch
                {
                    return csFiles;
                }

        } 
```

所以我调用removeDuplicated函数两次需要在removeDuplicated中做我上面写的事情然后我不确定是否要做sitesToCrawl = webSites; 或以某种方式将网站中的链接添加到sitesToCrawl。这个想法是当我遍历网站时，添加到 csFiles 列表时不会有重复的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:05:24.473

不确定我是否理解您的问题：

```
IEnumerable<string> notVisitedSites = currentSites.Except(visitedSites); 
```

# box-api - Box.net URL 方案

> ID：12391154
> 
> 赞同：2
> 
> 时间：2012-09-12T15:02:43.653
> 
> 标签：box-api

我正在编写一个 iPhone 应用程序 MyApp，它需要在线和离线访问文档。我的用户已经通过与公司服务器同步的 Box iPhone 应用程序管理这些文档（pdf、电影等）。

如果 MyApp 知道文档的路径和文件名，是否可以使用 Box URL Schemes 启动 Box 并在外部打开文档？

MyApp 不需要存储或访问文件，并且由于 Box 已经下载了文件，因此将它们存储在两个应用程序的文档空间中是没有意义的。

如果有这样的 URL Scheme，那么后续的两个问题是：A）文档关闭时是否有回调返回 MyApp，B）MyApp 可以使用另一个 URL Scheme 获取文档列表吗？

```
NSURL *ourURL = [NSURL URLWithString:@"box://some/path/to/fileid?callback=myapp://"];
if ([ourApplication canOpenURL:ourURL]) {
    [ourApplication openURL:ourURL];
} 
```

如果目前无法做到这一点，但 Box 对此感兴趣，那么我有兴趣成为 beta 测试人员/早期采用者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T17:44:54.810

如果您只想将用户定向到 Box 页面，您可以通过以下两种方式之一将用户定向到特定文件：

1) 如果文件在 Box 中共享并且您具有共享名称，则可以生成共享 url（请参阅 developer.box.com 文档中的共享）。但是，这仅适用于共享的文件。

2）如果您有Box中文件的文件ID，您可以生成一个URL，用户可以登录到自己的Box帐户并查看内容。您可以通过进入 Box 并查看单击特定文件时 URL 的显示方式来确定该 URL。但是，我们不喜欢为开发者宣传该 URL，因为我们不保证将来会保留此 URL 格式。它已经有一段时间没有改变了，所以它可能是安全的，但 Box 提供了“使用它需要您自担风险”的免责声明。

不幸的是，Box 没有办法根据文件路径提取文件。您需要文件 ID 或共享名称。没有依赖文件或文件夹名称的 url。

# c# - 如何从 C# 代码控制 WPF 窗口？

> ID：12391157
> 
> 赞同：0
> 
> 时间：2012-09-12T15:03:02.190
> 
> 标签：c#, wpf, xaml

我对 C# WPF 有点困惑。如何从 C# 代码设置 WPF 窗口的属性？例如，尝试`ShowInTaskbar = false;`不隐藏窗口的任务栏按钮，我实际上必须在 XAML 中进行它才能工作。这不是问题，但我想知道，在使用 WPF 时如何从 C# 代码控制 GUI。

这听起来像是一个迟钝的问题，但我正在尝试从 WinForms 过渡到 WPF。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:06:07.117

你只需要实例/引用`Window`然后你可以在代码中做任何你想做的事情。

`windowInstance.ShowInTaskBar = false`在代码中尝试它应该可以工作

# django - 使用 q.save() 的 IntegrityError：可能不是 NULL

> ID：12391160
> 
> 赞同：-2
> 
> 时间：2012-09-12T15:03:06.770
> 
> 标签：django

我不确定为什么会收到错误消息。这是意见和clesses

```
from polls.models import Word, Results

def detail(request):
    q = Word(type="How do you like")
    q.save()
    Word.objects.get(pk=1)

    q.score_set.create(score=5)
    q.score_set.create(score=4)
    q.score_set.create(score=3)
    q.score_set.create(score=2)
    q.score_set.create(score=1)

    return render_to_response('/$') 
```

模型.py

```
 from django.db import models

class Word(models.Model):
    type = models.CharField(max_length=200)

    def __unicode__(self):
            return self.type

class Results(models.Model):
    word = models.ForeignKey(Word)
    score = models.IntegerField()

    def __unicode__(self):
            return self.score 
```

错误：

```
IntegrityError at /
polls_word.score may not be NULLRequest Method: GET 
Request URL: Django Version: 1.4.1 
Exception Type: IntegrityError 
Exception Value: polls_word.score may not be NULL 
Exception Location: /home/oveledar/.virtualenvs/django/lib/python2.6/site-packages/django/db/backends/sqlite3/base.py in execute, line 337 
Python Executable: /home/oveledar/.virtualenvs/django/bin/python 
Python Version: 2.6.6 
Python Path: ['/home/oveledar/django/mysite',
 '/home/oveledar/.virtualenvs/django/lib/python2.6/site-packages/setuptools-0.6c11-py2.6.egg',
 '/home/oveledar/.virtualenvs/django/lib/python2.6/site-packages/pip-1.0.2-py2.6.egg',
 '/home/oveledar/.virtualenvs/django/lib64/python26.zip',
 '/home/oveledar/.virtualenvs/django/lib64/python2.6',
 '/home/oveledar/.virtualenvs/django/lib64/python2.6/plat-linux2',
 '/home/oveledar/.virtualenvs/django/lib64/python2.6/lib-tk',
 '/home/oveledar/.virtualenvs/django/lib64/python2.6/lib-old',
 '/home/oveledar/.virtualenvs/django/lib64/python2.6/lib-dynload',
 '/usr/lib/python2.6',
 '/usr/lib64/python2.6',
 '/home/oveledar/.virtualenvs/django/lib/python2.6/site-packages'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:12:42.870

您的表结构不正确，您需要：

```
class Results(models.Model):
    word = models.ForeignKey(Word)
    score = models.IntegerField(blank=True, null=True) 
```

之后，删除此表并运行命令：

```
python manange.py syncdb 
```

#`blank`选项是否需要此节点以进行表单验证

#`null`选项它是为你的数据库（空真或假）

# r - 使用 sqldf 将巨大的 csv 文件读入 R 是可行的，但 sqlite 文件占用的空间是它应该占用的两倍并且需要“清理”

> ID：12391162
> 
> 赞同：6
> 
> 时间：2012-09-12T15:03:13.640
> 
> 标签：r, sqlite, sqldf

环顾四周，我发现读取大于内存的 csv 文件的最佳方法是使用`read.csv.sql`from package `sqldf`。该函数会将数据直接读入sqlite数据库，然后执行sql语句。

我注意到以下情况：似乎读入sqlite的数据存储在一个临时表中，因此为了使其可以访问以供将来使用，需要在sql语句中进行询问。

例如，以下代码将一些示例数据读入 sqlite：

```
# generate sample data
sample_data <- data.frame(col1 = sample(letters, 100000, TRUE), col2 = rnorm(100000))
# save as csv
write.csv(sample_data, "sample_data.csv", row.names = FALSE)
# create a sample sqlite database
library(sqldf)
sqldf("attach sample_db as new") 
# read the csv into the database and create a table with its content
read.csv.sql("sample_data.csv", sql = "create table data as select * from file", 
             dbname = "sample_db", header = T, row.names = F, sep = ",") 
```

然后可以使用 访问数据`sqldf("select * from data limit 5", dbname = "sample_db")`。

问题如下：sqlite 文件占用的空间是应有的两倍。我的猜测是它包含两次数据：一次用于临时读取，一次用于存储表。可以使用`sqldf("vacuum", dbname = "sample_db")`. 这会回收空的空间，但是需要很长时间，尤其是文件很大的时候。

是否有更好的解决方案不会在第一次创建此数据重复？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T16:00:44.293

解决方案：`RSQLite`无需经过即可使用`sqldf`：

```
library(RSQLite)
con <- dbConnect("SQLite", dbname = "sample_db")
# read csv file into sql database
dbWriteTable(con, name="sample_data", value="sample_data.csv", 
             row.names=FALSE, header=TRUE, sep = ",") 
```

# javascript - Google Fiber，他们是如何实现他们的演练页面的？

> ID：12391165
> 
> 赞同：-1
> 
> 时间：2012-09-12T15:03:27.057
> 
> 标签：javascript, flash, html, user-interface

[http://fiber.google.com/how/](http://fiber.google.com/how/)

这就是 HTML5 画布动画吗？闪光？我很难说。谢谢！

![屏风](../Images/4867d794798845f1c850f144aff9a942.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:06:21.337

它不是 Flash，它是图像和巧妙的 javascript 的组合。

编辑：哦，当然还有 HTML 和 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:18:46.440

类似于 HTML5 的东西，例如[http://atari.com/arcade/](http://atari.com/arcade/)

# jquery - 数据表 - 仅在 IE9 中的滚动问题

> ID：12391170
> 
> 赞同：7
> 
> 时间：2012-09-12T15:03:48.810
> 
> 标签：jquery, datatables

我遇到了 Datatables 没有正确使用其 x 轴滚动的问题。

我之前遇到过 IE9 'ghost cell' 问题，我能够修复。但是，现在我遇到了一个问题，即显示我的溢出 x，而不是隐藏它并使窗口可滚动。

我的数据表初始化：

```
 var oTable = $('#tableBP').dataTable({
        "bJQueryUI": true,
        "sScrollX": "100%",
        "sScrollXInner": "200%",
        "sScrollY": 300,
        "bScrollCollapse": false,
        "bFilter": true,
        "bSort": false,
        "bInfo": false,
        "bPaginate": false
    });

    //This is a Datatables plugin. The issue occurs whether I comment this part or not.
    new FixedColumns(oTable, { 
        "iLeftWidth": 225
    }); 
```

这就是我所面临的：![overflowX 无法正常工作](../Images/401b269cdb03d905a8ed1528e4d82814.png)

虽然它在 IE9 兼容模式下工作。不幸的是，页面的其他部分不允许我运行这是一个较低版本的兼容性，但这清楚地将其标记为仅限 IE9 的问题。在 Chrome、Safari、Opera、Firefox 中没有问题。

我不会在这里发布表格，因为它的大小（在某些情况下是 2000+ td 字段）。这是一个完全有效的 HTML 表格，带有一个 thead/tbody，并且标签之间的所有空格都已被删除（这是修复我之前的幽灵单元问题的原因）。

有人对 Datatables 有任何经验并知道此问题的根本原因吗？

PS：这是一个 MVC2 应用程序（C#.Net），但这个问题似乎与生成此网页的应用程序无关。

**更新**

我忘了提到以下部分：

表格曾经正确显示；但由于 IE9 在大表中的幽灵单元问题，我被迫清除 table/thead/tbody/tr/td 标签之间的所有空格。我通过在我的应用程序的 HTML 输出上强制进行正则表达式替换来解决这个问题：

```
// response is the string with my HTML output which will be written to the browser after this:

string expression = @">[ \t\r\n\v\f]*<td"; 
response = Regex.Replace(response, expression, @"> <td"); 
```

如果我注释掉 RegEx 替换，数据表的溢出效果很好，但我面临着导致错位和全面丑陋的幽灵单元问题。取消注释时，所有单元格都完全对齐，但溢出停止工作。

就像我说的，这个问题只与 IE9 有关。所有其他浏览器（包括兼容模式下的 IE9）在注释/未注释状态下完美呈现表格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T14:57:16.777

经过大量的搜索和耐心，我已经设法解决了这个问题。

这个问题与 Bootstrap 相关。好吧，不完全是 Bootstrap，但 Bootstrap.css 所做的是`max-width: 100%;`向每个表添加一个。这对于一般布局非常有用，但显然 IE9 无法将其与可滚动`overflow-x`设置相结合。根据我的经验，IE9 并不喜欢最大和最小高度和宽度。

但我还是要感谢你们所有人的努力，你们让我走上了正确的道路，找到了这个问题的根源！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T08:10:48.140

添加这个，在`demo_table_jui.css`第 117 行（下`.dataTables_wrapper`）：

```
.DTFC_ScrollWrapper {
    overflow: hidden;
    overflow-x: scroll;
} 
```

这可以解决问题（至少，在这里，在所有浏览器中，包括 IE9 中的 IE7 和 IE8 文档模式）。

![工作水平滚动（无垂直滚动条），带有搜索框的标题保持在视图中](../Images/0b2b6365b5a9b4d418506f2a981a5ef0.png)

**已编辑**：不应`.dataTables_wrapper`像我在此答案前面所建议的那样添加溢出代码，但`.DTFC ScrollWrapper`应使用溢出指定类，请参见上面的代码。

* * *

顺便说一句，完全不相关：这家公司总是让我想起“De Bende van Nijvel”，不要问我为什么；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T08:46:59.890

这是`line 110`在`.dataTables_wrapper`添加`overflow:auto;`后的解决方案`clear:both;`

```
.dataTables_wrapper {
    position: relative;
    min-height: 302px;
    _height: 302px;
    clear: both;
    overflow:auto;
} 
```

**前**

[![前](../Images/c1b4357a810345528b0d23c439007c44.png)](https://i.stack.imgur.com/NlevV.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/mjpmxycy.phe.png)）]

**后**

[![后](../Images/54b6f823dc630852627fefcf8aa4be17.png)](https://i.stack.imgur.com/hxNGu.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/nqhwq2t4.ihg.png)）]

如果您想很好地坐在搜索工具栏下方`overflow:auto;`，可能想在 3 个表格周围添加一个额外的 div 并给出它。`clear:both;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T09:44:03.120

```
/*
 * The position is changed from relative to inherit, to fix the issue with the scrolling of the wrapper.
 */

.dataTables_wrapper {
    position: inherit;
    clear: both;
    *zoom: 1;
} 
```

问题可能是由于 DIV 的位置。我通过覆盖数据表 css 中的位置解决了类似的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-22T16:58:44.717

我通过应用以下 CSS 解决了这个问题：

```
/* this is needed for IE and Firefox if using horizontal scroll*/
table{
    max-width: none;
    min-height: 0%;
} 
```

# list - 是否有自动对子小部件进行排序的 Dojo 列表容器？

> ID：12391171
> 
> 赞同：1
> 
> 时间：2012-09-12T15:03:51.737
> 
> 标签：list, containers, dojo, sorted

我想要一个图形容器，我可以在其中添加和删除我的自定义小部件，我可以在其中设置在这些操作发生时自动应用的排序功能。

Dojo 中是否已经有我错过的合适对象？或者也许我没有正确考虑这个问题？

如果没有，是否有任何最小工作自定义容器小部件的示例等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T05:26:39.260

不要认为真的存在 - 标准组件的排序功能如何知道，它应该使用哪些参数来加权顺序，容器何时可以包含任何小部件类型？

恕我直言，使用布局小部件扩展将是您的最佳选择。他们每个人都有一个添加孩子的功能，遵循这个原型：

```
addChild(/*Object*/ dijit, /*Integer?*/ insertIndex) 
```

是一个很好的`dijit.layout.StackContainer`起点，它继承自`dijit._Container`(and `dijit.layout._LayoutWidget`)。因此，您可以选择何时调用覆盖的扩展功能。

```
dojo.declare("my.Container", [dijit._Container], {
    getSortOrder : function(newDijit) {
         var newIndex = -1; ??
         // something to work with
         var currentChildren = this.getChildren();
         var currentDescendants = this.getDescendants();
         return newIndex;
    },
    addChild: function(dijit, index) {
           // figure out index
           arguments[1] = this.getSortOrder(dijit);
           this.inherited(arguments);
    }
}); 
```

但请注意，layoutwidgets 比选择顺序更重要，也像边界容器的区域参数一样定位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:28:01.310

使用 SitePen 的[dgrid](https://github.com/SitePen/dgrid)，然后使用类型为 Editor 的列定义一个 List 小部件。将您的自定义小部件发送到编辑器的参数。dgrid 的 List 小部件应该能够像基于您的数据的网格一样进行排序，并且 Editor 列应该能够显示您想要的任何内容作为 List 项目内容的一部分。

如果你需要什么我会在附近。运气，

# postgresql - 如何自动关闭 PostgreSQL 中的空闲连接？

> ID：12391174
> 
> 赞同：74
> 
> 时间：2012-09-12T15:04:09.427
> 
> 标签：postgresql, timeout, connection

一些客户端连接到我们的 postgresql 数据库但保持连接打开。是否可以告诉 Postgresql 在一定数量的不活动后关闭这些连接？

**TL;博士**

> 如果您使用的是 Postgresql 版本 >= `9.2`
> THEN 使用[我想出的解决方案](https://stackoverflow.com/a/30769511/363573)
> 
> 如果您不想编写任何代码，请
> 使用[arqnid 的解决方案](https://stackoverflow.com/a/12403753/363573)
> 
> 如果您不想编写任何代码
> 并且您使用的是 Postgresql 版本 >=`14`
> 那么使用[Laurenz Albe 的解决方案](https://stackoverflow.com/a/69528572/363573)

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2015-06-11T00:16:15.490

对于那些感兴趣的人，这里是我提出的解决方案，灵感来自[Craig Ringer](https://stackoverflow.com/users/398670/craig-ringer)的评论：

> *（...）使用 cron 作业查看连接上次活动的时间（请参阅 pg_stat_activity）并使用 pg_terminate_backend 杀死旧的。（...）*

选择的解决方案如下：

*   首先，我们升级到 Postgresql 9.2。
*   然后，我们安排一个线程每秒运行一次。
*   当线程运行时，它会查找任何旧的非活动连接。

    > *   如果连接*状态*为、或，则认为连接**处于非活动**状态。*`idle``idle in transaction``idle in transaction (aborted)``disabled`*
    > **   *如果连接状态*在 5 分钟以上保持不变，则连接被视为**旧连接。***

***   还有其他线程与上述相同。但是，这些线程以不同的用户连接到数据库。*   我们为连接到我们数据库的任何应用程序保留至少一个连接。（`rank()`功能）**

 **这是线程运行的 SQL 查询：

```
WITH inactive_connections AS (
    SELECT
        pid,
        rank() over (partition by client_addr order by backend_start ASC) as rank
    FROM 
        pg_stat_activity
    WHERE
        -- Exclude the thread owned connection (ie no auto-kill)
        pid <> pg_backend_pid( )
    AND
        -- Exclude known applications connections
        application_name !~ '(?:psql)|(?:pgAdmin.+)'
    AND
        -- Include connections to the same database the thread is connected to
        datname = current_database() 
    AND
        -- Include connections using the same thread username connection
        usename = current_user 
    AND
        -- Include inactive connections only
        state in ('idle', 'idle in transaction', 'idle in transaction (aborted)', 'disabled') 
    AND
        -- Include old connections (found with the state_change field)
        current_timestamp - state_change > interval '5 minutes' 
)
SELECT
    pg_terminate_backend(pid)
FROM
    inactive_connections 
WHERE
    rank > 1 -- Leave one connection for each application connected to the database 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2018-10-08T14:28:13.457

如果您使用的是 PostgreSQL >= 9.6，则有一个更简单的解决方案。假设您想每 5 分钟删除一次所有空闲连接，只需运行以下命令：

```
alter system set idle_in_transaction_session_timeout='5min'; 
```

如果您没有超级用户的访问权限（Azure 云上的示例），请尝试：

```
SET SESSION idle_in_transaction_session_timeout = '5min'; 
```

但是后者仅适用于当前会话，这很可能不是您想要的。

要**禁用**该功能，

```
alter system set idle_in_transaction_session_timeout=0; 
```

或者

```
SET SESSION idle_in_transaction_session_timeout = 0; 
```

（顺便说一下，0 是默认值）。

如果使用`alter system`，则必须重新加载配置以开始更改并且更改是持久的，例如，如果您将重新启动服务器，则不必再重新运行查询。

检查功能状态：

```
show idle_in_transaction_session_timeout; 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-09-13T09:59:10.440

通过像[PgBouncer](http://wiki.postgresql.org/wiki/PgBouncer)`server_idle_timeout`这样的代理连接，它会在几秒钟后关闭连接。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2021-10-11T15:14:07.367

从 PostgreSQL v14 开始，您可以将[`idle_session_timeout`](https://www.postgresql.org/docs/14/runtime-config-client.html#GUC-IDLE-SESSION-TIMEOUT)参数设置为自动断开空闲的客户端会话。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-07-17T19:05:02.463

如果您将 AWS 与 PostgreSQL >= 9.6 一起使用，则必须执行以下操作：

### 创建自定义参数组

转到 RDS > 参数组 > 创建参数组 选择您使用的 PSQL 版本，将其命名为“customParameters”或其他名称，并添加描述“处理空闲连接”。

### 更改 idle_in_transaction_session_timeout 值

幸运的是，它将创建默认 AWS 组的副本，因此您只需调整您认为不适合您的用例的内容。

现在单击新创建的参数组并搜索“空闲”。
'idle_in_transaction_session_timeout' 的默认值设置为 24 小时（86400000 毫秒）。将此数字除以 24 得到小时数 (3600000)，然后您必须再次将 3600000 除以 4、6 或 12，具体取决于您是否希望超时分别为 15、10 或 5 分钟（或等效地乘以分钟数 x 60000，因此 5 分钟的值为 300 000）。

### 分配组

最后但并非最不重要的一点是，更改组：

转到 RDS，选择您的数据库并单击“修改”。

现在在“数据库选项”下，您将找到“数据库参数组”，将其更改为新创建的组。

然后，您可以决定是否要立即应用修改（注意停机时间）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-08-26T15:34:42.863

我遇到了连接被拒绝的问题，因为 Postgresql 12 服务器（但在使用早期 9.6 和 10 版本的类似项目上没有）和 Ubuntu 18 上连接了太多客户端。

我想知道这些设置是否

```
tcp_keepalives_idle 
tcp_keepalives_interval 
```

可能比

```
idle_in_transaction_session_timeout 
```

**idle_in_transaction_session_timeout**确实只关闭来自失败事务的空闲连接，而不是其语句正确终止的非活动连接......文档显示这些套接字级别设置对 Unix 域套接字没有影响，但它可以在 Ubuntu 上运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-05T10:03:59.307

直到 PostgreSQL 13，你可以使用我的扩展[pg_timeout](https://www.pgxn.org/dist/pg_timeout/1.0.0)。**

# sql - 匹配 T-SQL 存储过程中的多个条件

> ID：12391176
> 
> 赞同：0
> 
> 时间：2012-09-12T15:04:18.953
> 
> 标签：sql, tsql

我被迫使用具有以下结构 (ScheduledEmails) 的表，并希望找到处理多个变量设置为 1 (true) 的最有效方法

如果只选择了一个，下面的脚本只会返回正确的值。

任何人都可以推荐一种修改底部查询以适应多个条件的方法。

> 例如@IsMonday 和@IsTuesday 在哪里是真的等等？

我尝试了多种 AND/OR 组合，但似乎都没有产生预期的结果。

```
DECLARE @IsMonday bit
DECLARE @IsTuesday bit
DECLARE @IsWednesday bit
DECLARE @IsThursday bit
DECLARE @IsFriday bit
DECLARE @IsSaturday bit
DECLARE @IsSunday bit
DECLARE @Is0000 bit
DECLARE @Is0100 bit
DECLARE @Is0200 bit
DECLARE @Is0300 bit
DECLARE @Is0400 bit
DECLARE @Is0500 bit
DECLARE @Is0600 bit
DECLARE @Is0700 bit
DECLARE @Is0800 bit
DECLARE @Is0900 bit
DECLARE @Is1000 bit
DECLARE @Is1100 bit
DECLARE @Is1200 bit
DECLARE @Is1300 bit
DECLARE @Is1400 bit
DECLARE @Is1500 bit
DECLARE @Is1600 bit
DECLARE @Is1700 bit
DECLARE @Is1800 bit
DECLARE @Is1900 bit
DECLARE @Is2000 bit
DECLARE @Is2100 bit
DECLARE @Is2200 bit
DECLARE @Is2300 bit

DECLARE @dayOfWeek VARCHAR(20)
DECLARE @hourOfDay int

SET @dayOfWeek = datename(dw,GETDATE()) -- Monday to Sunday
SET @hourOfDay = datepart(hh, GETDATE()) -- Single digit 0 - 23

SET @IsMonday = CASE WHEN @dayOfWeek = 'Monday' THEN 1 ELSE 0 END
SET @IsTuesday = CASE WHEN @dayOfWeek = 'Tuesday' THEN 1 ELSE 0 END
SET @IsWednesday = CASE WHEN @dayOfWeek = 'Wednesday' THEN 1 ELSE 0 END
SET @IsThursday = CASE WHEN @dayOfWeek = 'Thursday' THEN 1 ELSE 0 END
SET @IsFriday = CASE WHEN @dayOfWeek = 'Friday' THEN 1 ELSE 0 END
SET @IsSaturday = CASE WHEN @dayOfWeek = 'Saturday' THEN 1 ELSE 0 END
SET @IsSunday = CASE WHEN @dayOfWeek = 'Sunday' THEN 1 ELSE 0 END
SET @Is0000 = CASE WHEN @hourOfDay = 0 THEN 1 ELSE 0 END
SET @Is0100 = CASE WHEN @hourOfDay = 1 THEN 1 ELSE 0 END
SET @Is0200 = CASE WHEN @hourOfDay = 2 THEN 1 ELSE 0 END
SET @Is0300 = CASE WHEN @hourOfDay = 3 THEN 1 ELSE 0 END
SET @Is0400 = CASE WHEN @hourOfDay = 4 THEN 1 ELSE 0 END
SET @Is0500 = CASE WHEN @hourOfDay = 5 THEN 1 ELSE 0 END
SET @Is0600 = CASE WHEN @hourOfDay = 6 THEN 1 ELSE 0 END
SET @Is0700 = CASE WHEN @hourOfDay = 7 THEN 1 ELSE 0 END
SET @Is0800 = CASE WHEN @hourOfDay = 8 THEN 1 ELSE 0 END
SET @Is0900 = CASE WHEN @hourOfDay = 9 THEN 1 ELSE 0 END
SET @Is1000 = CASE WHEN @hourOfDay = 10 THEN 1 ELSE 0 END
SET @Is1100 = CASE WHEN @hourOfDay = 11 THEN 1 ELSE 0 END
SET @Is1200 = CASE WHEN @hourOfDay = 12 THEN 1 ELSE 0 END
SET @Is1300 = CASE WHEN @hourOfDay = 13 THEN 1 ELSE 0 END
SET @Is1400 = CASE WHEN @hourOfDay = 14 THEN 1 ELSE 0 END
SET @Is1500 = CASE WHEN @hourOfDay = 15 THEN 1 ELSE 0 END
SET @Is1600 = CASE WHEN @hourOfDay = 16 THEN 1 ELSE 0 END
SET @Is1700 = CASE WHEN @hourOfDay = 17 THEN 1 ELSE 0 END
SET @Is1800 = CASE WHEN @hourOfDay = 18 THEN 1 ELSE 0 END
SET @Is1900 = CASE WHEN @hourOfDay = 19 THEN 1 ELSE 0 END
SET @Is2000 = CASE WHEN @hourOfDay = 20 THEN 1 ELSE 0 END
SET @Is2100 = CASE WHEN @hourOfDay = 21 THEN 1 ELSE 0 END
SET @Is2200 = CASE WHEN @hourOfDay = 22 THEN 1 ELSE 0 END
SET @Is2300 = CASE WHEN @hourOfDay = 23 THEN 1 ELSE 0 END

INSERT INTO ScheduledEmailQueue (ScheduledEmailId, Created)
SELECT Id, GETDATE() FROM ScheduledEmails WHERE 
(SendMonday = @IsMonday AND
SendTuesday = @IsTuesday AND
SendWednesday = @IsWednesday AND
SendThursday= @IsThursday AND
SendFriday = @IsFriday AND
SendSaturday = @IsSaturday AND
SendSunday = @IsSunday AND
Send0000 = @Is0000 AND
Send0100 = @Is0100 AND 
Send0200 = @Is0200 AND 
Send0300 = @Is0300 AND 
Send0400 = @Is0400 AND 
Send0500 = @Is0500 AND 
Send0600 = @Is0600 AND 
Send0700 = @Is0700 AND 
Send0800 = @Is0800 AND 
Send0900 = @Is0900 AND 
Send1000 = @Is1000 AND 
Send1100 = @Is1100 AND 
Send1200 = @Is1200 AND 
Send1300 = @Is1300 AND 
Send1400 = @Is1400 AND 
Send1500 = @Is1500 AND 
Send1600 = @Is1600 AND 
Send1700 = @Is1700 AND 
Send1800 = @Is1800 AND 
Send1900 = @Is1900 AND 
Send2000 = @Is2000 AND 
Send2100 = @Is2100 AND 
Send2200 = @Is2200 AND 
Send2300 = @Is2300)

SELECT Id, GETDATE() FROM ScheduledEmails WHERE 
SendMonday= @IsMonday AND
SendTuesday = @IsTuesday AND
SendWednesday = @IsWednesday AND
SendThursday= @IsThursday AND
SendFriday = @IsFriday AND
SendSaturday = @IsSaturday AND
SendSunday = @IsSunday AND
Send0000 = @Is0000 AND
Send0100 = @Is0100 AND 
Send0200 = @Is0200 AND 
Send0300 = @Is0300 AND 
Send0400 = @Is0400 AND 
Send0500 = @Is0500 AND 
Send0600 = @Is0600 AND 
Send0700 = @Is0700 AND 
Send0800 = @Is0800 AND 
Send0900 = @Is0900 AND 
Send1000 = @Is1000 AND 
Send1100 = @Is1100 AND 
Send1200 = @Is1200 AND 
Send1300 = @Is1300 AND 
Send1400 = @Is1400 AND 
Send1500 = @Is1500 AND 
Send1600 = @Is1600 AND 
Send1700 = @Is1700 AND 
Send1800 = @Is1800 AND 
Send1900 = @Is1900 AND 
Send2000 = @Is2000 AND 
Send2100 = @Is2100 AND 
Send2200 = @Is2200 AND 
Send2300 = @Is2300 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:29:19.760

如果我正确理解了您的要求，您只想从 ScheduledEmails 表中选择当前星期几和小时的记录，并将它们插入到 ScheduledEmailQueue 表中。如果确实如此，您可以创建一个动态 sql 查询并执行它。如果我没有正确理解您的要求，那么我提前道歉:)

```
DECLARE @dayOfWeek VARCHAR(20)
DECLARE @hourOfDay INT
DECLARE @hourOfDayColumnName VARCHAR(20)
DECLARE @dayOfWeekColumnName VARCHAR(20)
DECLARE @sql VARCHAR(MAX)

SET @dayOfWeek = datename(dw,GETDATE()) -- Monday to Sunday
SET @hourOfDay = datepart(hh, GETDATE()) -- Single digit 0 - 23
SET @hourOfDayColumnName = 'Send' + CASE WHEN LEN(@hourOfDay) = 1 THEN '0' + CONVERT(VARCHAR, @hourOfDay) ELSE CONVERT(VARCHAR, @hourOfDay) END + '00'
SET @dayOfWeekColumnName = 'Send' + @dayOfWeek
SET @sql = 'INSERT INTO ScheduledEmailQueue (ScheduledEmailId, Created)
SELECT Id, GETDATE() FROM ScheduledEmails WHERE ' + @dayOfWeekColumnName + ' = 1 AND ' + @hourOfDayColumnName + ' = 1'

PRINT @hourOfDayColumnName
PRINT @dayOfWeekColumnName
PRINT @sql
EXEC (@sql) 
```

对不起，我看错了你的问题，但我仍然不清楚你的要求。如果您使用 DayOfWeek 和 Hour，它们将始终返回奇异值（例如星期一和 22）。如果要根据多个条件选择值，则必须执行简单的硬编码查询，例如：

```
SELECT Id, GETDATE() FROM ScheduledEmails WHERE 
SendMonday= 1 AND
SendTuesday = 1 AND
Send0000 = 1 AND
Send0100 = 1 
```

如果您事先不知道所需天数和数小时的值，那么您可以将它们作为参数传递给存储的过程并使用它们进行过滤。

# javascript - 如何按顺序运行javascript语句

> ID：12391177
> 
> 赞同：1
> 
> 时间：2012-09-12T15:04:20.450
> 
> 标签：javascript, jquery, toastr

我想先显示一条消息，然后重定向我的页面：

```
toastr.success('Your report has been submitted successfully.');
window.location = '/Report'; 
```

但是上面的代码允许两个语句同时运行。结果，重定向发生在显示 toastr 消息之前，这需要时间。

`$.when(...).done(...)`对于这种情况，我们有类似的东西吗？

- - 更新 - -

如果有人不知道[toastr](http://codeseven.github.com/toastr/)，它是一个在网页上显示消息的库。

当然设置一个计时器会起作用。但是有没有什么优雅的方法可以在第一个语句完成后运行第二个语句？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T15:06:14.410

您可以使用 setTimeout ：

```
toastr.success('Your report has been submitted successfully.');
setTimeout(function(){window.location = '/Report';}, 2000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T13:56:48.637

您可以将函数作为回调传递，以便在函数完成后执行。请参阅有关此类似问题的所选答案：[我应该如何调用 3 个函数以便一个接一个地执行它们？](https://stackoverflow.com/questions/5187968/how-should-i-call-3-functions-in-order-to-execute-them-one-after-the-other)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-03T00:32:19.807

`onHidden`使用 toastr选项我取得了很大的成功。它基本上是一个事件回调，允许您设置重定向 url，在 toast 关闭或隐藏时触发。

```
// Notify the user of success and redirect when the toast closes
toastr.options.onHidden = function () {
     window.location.href = <YOUR REDIRECT URL>;
};

// Fire the success toast which is bound to the onHidden function                    
toastr.success('Success!<br/><br/>You\'ll now be automatically redirected to your current items.', 'Download Success', { timeOut: 3000, closeButton: true, positionClass: 'toast-bottom-right', progressBar: true }); 
```

# android - 背景附件在 Jelly Bean WebView 中打乱了渲染？

> ID：12391179
> 
> 赞同：3
> 
> 时间：2012-09-12T15:04:24.443
> 
> 标签：android, css, android-webview, android-4.2-jelly-bean

似乎背景固定的 CSS 属性在 Jelly Bean WebView 中无法正常工作（无论是在应用程序中还是使用默认的 Android 浏览器）。

如果我设置此属性，则背景图像会加载到内容之上，即内容位于背景图像后面。

这是我的相关 HTML 代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">   
<meta name="viewport" content="target-densitydpi=device-dpi">
<meta name="viewport" content="initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="./gesture-background_files/genre-channel-background.css">
<style type="text/css"></style></head>
<body>
<div id="right-keys">
    <a href="keypress://1"><img src="./gesture-background_files/one.png"></a><br />
    Film24<br />                    
</div>
<div id="right-keys-vertical">
    <a href="keypress://1"><img src="./gesture-background_files/one.png"></a><br />
    Film24<br />
</div>
<div id="footer">
    MUSCADE<span class="large">EPG</span>
</div>   
</body>
</html> 
```

这是 CSS 的相关部分：

```
body {
    background-image: url(hot-black-background.jpg);
    background-color: black;
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-position: bottom left;
}

#right-keys, #right-keys-vertical {
    position: absolute;
    right: 10px;
    width: 100px;

    text-align: center;
    text-shadow: black 2px 2px 0px;
}

#right-keys img, #right-keys-vertical img {
    height: 90px;
    margin-bottom: 0;
}

#footer {
    position: absolute;
    right: 10px;
    bottom: 10px;
    font-size: 20px;
} 
```

它有点长，但唯一重要的部分是CSS 文件顶部的`background-attachment`和属性。`background-position`如果我删除这些，一切正常。

这是一个已知的错误？任何人都可以提出解决方法吗？

这是该文件的链接，因此您可以尝试从 Jelly Bean 本地浏览器（不是 Chrome）打开它：

```
http://212.92.197.78/gesture/gesture-background.htm 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T21:41:21.623

事实证明，如果你在 Jelly Bean 浏览器中使用

```
body {
   background-image: url(any-image.jpg);
   background-attachment: fixed;
   background-position: bottom;
} 
```

或涉及`bottom`或`right`的`background-position`任何内容，您参考屏幕右侧或底部边缘定位的任何元素都将被背景图像覆盖。

这肯定是 Jelly Bean 浏览器中的一个错误。

我没有使用上面的方法，而是使用以下代码在我的页面上放置了背景图像：

HTML：

```
<body>
   <img id="background" src="any-image.jpg" />
   (...)
</body> 
```

CSS：

```
#background {
   z-index: -1;
   position: fixed;
   bottom: 0;
   left: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:50:02.673

对于位置相关和绝对位置，您可以使用 z-index。阅读有关 z-index 的更多信息：http: [//www.w3schools.com/cssref/pr_pos_z-index.asp](http://www.w3schools.com/cssref/pr_pos_z-index.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T07:35:45.010

在我的网站上，为了使背景图像重新出现在内容后面（在 Jelly Bean 浏览器上），我只需要删除 css 属性：background-attachment：fixed。

Zoltan 的解决方案对我来说效果不佳，因为它使背景图像在某些浏览器中无法正确显示（在 browserstack 上测试）

# sql - 选择尚未从数据库中选择的随机 ID

> ID：12391181
> 
> 赞同：3
> 
> 时间：2012-09-12T15:04:32.923
> 
> 标签：sql, database

以下是我已经尝试在 Sql 中选择随机问题的方法：

> 通过 newid() 从 testTable 中选择前 10 个 id

*   未针对大数据进行优化

> 从 testTable 表样本中选择前 10 个 id（1%） - 但是对于表样本，我们不能确定它总是会返回数据，因为它适用于选择页面的概率
> 
> 我已经尝试了其他几种方法来获取行号，但我仍然想要更优化的解决方案

我只想要那些之前没有选择的 id。我不想使用 not in 因为 sql 不会缓存 not in 查询。

欢迎任何比在查询中使用 not 更优化的方法来挑选尚未挑选的 id。

我将讨论表的架构：

假设有以下表格：

1.  包含问题的表，QuestionsTable
2.  包含所有用户进行测试的表说 testUserTale
3.  包含测试中每个用户的问题的表。

所以我必须确保曾经尝试过问题的学生在下一次测试中不会再看到

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:15:05.983

随机程序

此过程生成一个随机数（但请参阅使用说明）。

句法

DBMS_RANDOM.RANDOM RETURN binary_integer;

编译指示

PRAGMA restrict_references (random, WNDS) 返回值

# php - 链接到PHP中不同目录中的文件

> ID：12391184
> 
> 赞同：2
> 
> 时间：2012-09-12T15:04:45.793
> 
> 标签：php, wordpress, syntax-error, require

**我关于在wordpress**编程方面获得帮助的另一个问题由于某种原因被标记为离题，所以我问**的是另一种方式**。我正在尝试嵌入我的 wordpress 帖子。我正在使用本教程：

> [http://www.corvidworks.com/articles/wordpress-content-on-other-pages](http://www.corvidworks.com/articles/wordpress-content-on-other-pages)

问题在于这段代码：

```
<?php

// Include WordPress 
define('WP_USE_THEMES', false);
require('./wordpress/wp-load.php');
query_posts('showposts=1');

?>` 
```

当我尝试运行插入的页面时，我收到错误消息，指出该文件不存在。假装我的域是 blah.com，该文件位于 www.blah.com/wordpress/wp-load.php，包含此 PHP 代码的页面位于 www.blah.com/other/page.php。

如何更改 require 行上链接的语法以确保它指向正确的位置，因为现在它似乎不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:38:30.210

你试过了吗

```
require('../wordpress/wp-load.php'); 
```

或者无论如何

```
require('../../wordpress/wp-load.php'); 
```

?

（取决于文件位置的深度）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-12T12:29:27.693

就像上面的答案一样

这对我有用

```
require('../wordpress/wp-load.php'); 
```

# javascript - 为什么未执行的语句会减慢我的功能？

> ID：12391191
> 
> 赞同：50
> 
> 时间：2012-09-12T15:05:06.727
> 
> 标签：javascript, performance

我创建了四个不同的函数，如下所示：

```
var normal = function() {
    return;
};
var control = function() {
    return;
    alert("Hello, world!");
};
var withArguments = function() {
    return;
    arguments;
};
var withEval = function() {
    return;
    eval("");
}; 
```

由于他们都什么都不做并立即返回，我希望他们所有人都具有相同的速度。但是，[在 jsPerf 上对其进行测试](http://jsperf.com/unexecuted-statements-after-return)后，我发现它`normal`并`control`执行大致相同，但`withArguments`执行`withEval`速度要慢得多。

为什么这些未执行的语句会对性能产生任何影响？既然他们从来没有被执行过，他们怎么可能有任何效果呢？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-09-12T15:15:08.727

简而言之，`eval`在函数内部调用并能够访问`arguments`数组都在函数调用期间使用额外的设置。如果知道既不执行`arguments`也不`eval`执行，则可以跳过此额外设置。

编译器不会尝试预测`arguments`数组是否会被实际访问或是否`eval`会被实际调用，它只会检查它们是否存在于函数中。

## `arguments`

在运行时调用使用对象的可变参数函数`arguments`比调用不使用对象的“普通”函数更昂贵`arguments`。

`arguments`声明对象时绑定执行环境所需的额外步骤[在 ECMA-262 标准的 §10.6 中指定](http://es5.github.io/#x10.6)。创建`arguments`对象是一个有点昂贵的 15 步过程。基本上，`arguments`必须用传入的参数填充，并且必须创建`.caller`和属性。`.callee`

该标准规定，`arguments`对象应该在函数进入其执行上下文时创建，除非在名为 的函数中已经声明了参数、变量或函数`arguments`。

出于优化的目的，大多数浏览器实际上不会创建 arguments 对象，除非函数在某处实际使用它（即使在 a 之后`return`）。这就是为什么在`arguments`引用时会看到性能下降的原因，即使包含它的行从未执行过。

## `eval`

[按照 ECMA-262 标准 §10.4.2 中的规定，](http://es5.github.io/#x10.4.2)输入`eval`代码需要创建一个特殊的执行上下文。基本上，它必须将调用函数的执行上下文的所有属性绑定到上下文。`eval`

如果`eval`在一个函数中调用了多个 s，那么它们基本上都会执行两次相同的过程。为了优化，如果浏览器检测到`eval`函数中有一个（甚至在 a 之后`return`），它会预先填充这个每个人都`eval`可以使用的新执行上下文，这样就不需要多次重新创建它。

* * *

**请注意，这些优化是依赖于浏览器的，并且不是标准所要求的**，因此某些浏览器实际上可能不会执行所描述的优化，或者它们可能会以不同的方式做事。

# r - 在开发 R 包中包含数据示例

> ID：12391195
> 
> 赞同：25
> 
> 时间：2012-09-12T15:05:12.740
> 
> 标签：r, package, roxygen2

我渴望学习如何将数据示例合并为写在函数上方的注释，例如：

```
##' @examples 
##' ## Set working directory...
##' ## Load data into R session:
##' data <- system.file("extdata", "data.txt", package="...", sep="\t", header=TRUE, stringsAsFactors = FALSE)
##'
##' ## For reproducible results:
##' set.seed(999) 
```

我将我的“data.txt”文件放在目录中：/pkg_Name/inst/extdata/。但是，R CMD 检查在这一步中指示错误。如果我继续 R CMD 构建和 R CMD 安装，那么在加载包后，我无法将数据输入 R 会话......谁能告诉我出了什么问题？这是在函数帮助文档末尾包含数据示例的正确方法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-02-07T08:23:53.517

Hadley Wickham has a chapter in his book ["R Packages"](http://r-pkgs.had.co.nz/) on [how to incorporate data into an R Package](http://r-pkgs.had.co.nz/data.html).

Dirk points to the official documentation on [data in packages](https://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages).

Alternatively, here's an example of learning from the ggplot2 package for one way of how to incorporate data using rda files and roxygen.

[Here is the `data` directory in the ggplot2 package](https://github.com/hadley/ggplot2/tree/master/data). In this example, each data file is stored in a separate `rda` file (e.g., generated using `save(foo, file='foo.rda')`.

![enter image description here](../Images/2c6dc0b87935431c6b24b7490df0fbcf.png)

See [the file data.r](https://github.com/hadley/ggplot2/blob/master/R/data.R) for the Roxygen commands to generate the Rmd help files for the data: E.g.,

```
#' Prices of 50,000 round cut diamonds
#'
#' A dataset containing the prices and other attributes of almost 54,000
#'  diamonds. The variables are as follows:
#'
#' @format A data frame with 53940 rows and 10 variables:
#' \itemize{
#'   \item price: price in US dollars (\$326--\$18,823)
#'   \item carat: weight of the diamond (0.2--5.01)
#'   \item cut: quality of the cut (Fair, Good, Very Good, Premium, Ideal)
#'   \item color: diamond colour, from J (worst) to D (best)
#'   \item clarity: a measurement of how clear the diamond is
#'      (I1 (worst), SI1, SI2, VS1, VS2, VVS1, VVS2, IF (best))
#'   \item x: length in mm (0--10.74)
#'   \item y: width in mm (0--58.9)
#'   \item z: depth in mm (0--31.8)
#'   \item depth: total depth percentage = z / mean(x, y) = 2 * z / (x + y) (43--79)
#'   \item table: width of top of diamond relative to widest point (43--95)
#' }
"diamonds" 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-12T15:16:14.810

请查看包含数据的 CRAN 包并复制他们的方法。几周前，我刚刚将数据添加到一个仅限工作的包中，它就可以工作......

值得一提的是，手册中有一节[1.1.5 Data in packages](http://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages)对此进行了解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-02T05:21:23.060

```
x <- sample(1000)
devtools::use_data(x, mtcars) 
```

> [http://r-pkgs.had.co.nz/data.html](http://r-pkgs.had.co.nz/data.html)

# mysql - 选择平面数据成表格格式

> ID：12391200
> 
> 赞同：0
> 
> 时间：2012-09-12T15:05:27.093
> 
> 标签：mysql

我有一个类似于以下模式的表

```
id | year | month | amount ...
x  | 2011 | 12    | 312
x  | 2011 | 12    | 213
x  | 2012 | 1     | 123
x  | 2012 | 1     | 123
x  | 2012 | 2     | 123
... 
```

我想知道是否有可能（通过mysql）输出类似

```
year | 1   | 2   | 3 | ....
2011 | 321 | 231 | ...
2012 | 246 | 123 | ... 
```

所以做一个`group by year, month`,`sum(amount)`并每年输出一个“行”，将各个月份作为列。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:23:52.187

您会想要使用各种数据透视表。如果您只处理几个月，那么下面的 SQL 应该适合您。我只做了前三个月，但其余的都是一样的。

```
SELECT year, SUM(IF(month=1,amount,0)) As '1', SUM(IF(month=2,amount,0)) As '2', SUM(IF(month=3,amount,0)) As '3' FROM mytable GROUP BY year 
```

# ruby - 名称中带有 Acroynym 的 Ruby Gem

> ID：12391204
> 
> 赞同：-1
> 
> 时间：2012-09-12T15:05:47.533
> 
> 标签：ruby, rubygems

[已解决：请参阅下面的评论]

我创建了一个 Ruby Gem 来连接到我的应用程序的 API：my_app_api。我想像这样使用它：`MyAppAPI::Foo.bar()`. 但是，我得到：

```
NameError: uninitialized constant MyAppAPI 
```

我知道调用/命名它的标准方法是`MyAppApi::Foo.bar()`，但我更愿意使用首字母缩写词类命名约定。如何指定/加载模块？

作为参考，该类如下所示：

```
module MyAppAPI

 class Foo < ActiveResource::Base
 extend MyAppAPI

 self.site = 'http://localhost:3000/api/'
 self.format = :json

 class << self

   def bar
     return 'huzzah!'
   end

 end

  end
end 
```

该`my_app_api.rb`文件如下所示：

```
require "rubygems"
require 'active_resource'

require 'my_app_api/foo' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:22:27.267

您是否尝试过以正常方式加载宝石？

```
require 'my_app_api'
MyAppAPI::Foo.bar() 
```

常量名称 MyAppAPI 很好，不是问题的原因。有大量的 Ruby 核心类/模块的名称中有首字母缩略词：

*   [http://www.ruby-doc.org/core-1.9.3/GC.html](http://www.ruby-doc.org/core-1.9.3/GC.html)
*   [http://www.ruby-doc.org/core-1.9.3/RubyVM.html](http://www.ruby-doc.org/core-1.9.3/RubyVM.html)
*   [http://ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:25:48.503

尝试在声明后在 my_app_api.rb 中声明空模块`require`：

```
module MyAppAPI
end 
```

如果您依赖动态类和模块加载机制（如 Rails 使用），这可能会有所帮助。

我假设您的应用程序正在明确调用`require "my_app_api"`. 这是什么类型的应用程序，你在哪里做的`require`？

# wcf - 无法打开 WCF 服务 - 客户端调用过多

> ID：12391205
> 
> 赞同：2
> 
> 时间：2012-09-12T15:05:55.330
> 
> 标签：wcf, web-services, timeout, wcf-client, endpoint

我有一个托管在 Windows 服务中的 WCF Web 服务。

使用以下属性配置服务 (VB)

```
<ServiceBehavior(ConcurrencyMode:=ConcurrencyMode.Multiple,
InstanceContextMode:=InstanceContextMode.PerCall,
UseSynchronizationContext:=False)> 
```

我创建了一个测试客户端，它一次创建 50 个线程，并且我立即启动它们，所有这些都查询 WCF 服务上的操作。前 30 个左右的开口 (client.open()) 工作，但之后我在客户端上收到一条错误消息，指出无法完成打开，因为尝试打开服务时超时，因此我得到一个 EndPointNotFoundException . （如果重要的话，我调用的操作都是同步的。）

我是否可以期待这种行为，因此只需要忍受这些例外情况，或者我是否必须查看我的一些设置，无论是上述设置还是任何其他设置？（我正在使用 NetTcpBinding。）

我看到的是客户端同时处理一次创建的线程的请求，因此上述设置具有使服务同时启用多用户的预期效果。

但理想情况下，我不会得到超时异常。相反，我希望客户等待更长的时间才能得到他们的响应，而不是超时。

有任何想法吗？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:12:53.930

检查如下设置：

```
<behavior name="CommonServices_Behavior">
  <serviceThrottling maxConcurrentCalls="100" maxConcurrentSessions="50"
   maxConcurrentInstances="50" />
</behavior> 
```

我似乎记得其中一些值在您的 machine.config 文件中设置了默认值。还有一个[MaxConnections 值来检查 NetTcpBinding](http://msdn.microsoft.com/en-us/library/ee377061%28v=bts.10%29.aspx)。

# c# - 如何在 Windows 窗体 C# 中赋予文本框渐变颜色

> ID：12391208
> 
> 赞同：3
> 
> 时间：2012-09-12T15:05:56.853
> 
> 标签：c#, winforms, colors, gradient

嘿，我需要帮助给我的文本框一个渐变色。我知道我可以给实际的 WIndows Form 一个渐变颜色，但我只能弄清楚如何给我想要的文本框？

请帮我 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:14:32.050

你可以看看[这个](http://social.msdn.microsoft.com/Forums/en/csharplanguage/thread/fbdd1e74-4ad9-40ae-9458-3339640948c3)。它必须帮助你。

# php - 矩阵第 4 部分和 MySql 困境

> ID：12391210
> 
> 赞同：0
> 
> 时间：2012-09-12T15:06:01.583
> 
> 标签：php, mysql

我想做以下事情：

基本上我对事件表有以下设计：

事件：

*   ID
*   代码
*   日期

创建新事件时，我想做以下事情：

*   检查是否有任何可用的代码。如果日期已经过去，则可以使用代码。

    `$code1 = select code from event where date_add(date, INTERVAL 7 day) < NOW() AND code NOT IN (select code from event where date_start > NOW()) limit 1`

*   如果代码可用，请获取该代码并将其用于新事件。

    `insert into event (code, date) VALUES($code1, NOW())`

*   如果代码不可用，则生成新代码。

问题是我担心当同时创建 2 个事件时，它们都会得到相同的代码。我怎样才能防止这种情况？

目标是为每个事件分配一个 1-100 的代码。所以因为 1-100 只是 100 个数字，我需要回收代码，这就是我检查旧代码以分配给新事件的原因。我希望能够通过回收旧代码为事件分配 1 到 100 的代码。我不想将相同的代码分配给 2 个不同的事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:33:58.153

好的，这是一个很长的镜头，而且我不是数据库人员，所以请谨慎对待我的建议并进行自己的研究...

我认为你想要的是可序列化的交易。基本上，您首先要求[MySQL](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html)使用`SET TRANSACTION ISOLATION LEVEL SERIALIZABLE`. 然后，在您的三个步骤之前，您通过运行开始事务`START TRANSACTION`，并在您的三个步骤之后运行`COMMIT`。

一些进一步的阅读：

*   [http://en.wikipedia.org/wiki/Database_transaction](http://en.wikipedia.org/wiki/Database_transaction)
*   [http://en.wikipedia.org/wiki/Serializability](http://en.wikipedia.org/wiki/Serializability)
*   [http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-transactions.html](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-transactions.html)

我不确定可序列化性产生的开销。希望更熟悉数据库的人可以参与进来。

如果您可以解决您的问题，我个人宁愿这样做而不是使用事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:34:26.740

您应该在工作时锁定桌子：

```
LOCK TABLE event WRITE;
SELECT MIN(code) FROM event WHERE date_add(date_end, INTERVAL 7 day) < NOW()
     AND code NOT IN (SELECT code FROM event WHERE date_start > NOW());
...
INSERT INTO event ...
UNLOCK TABLES; 
```

您还可以保留一个包含所有活动代码的表格（在这种情况下，所有数字都是从 1 到 100）。在这种情况下，您可以`INSERT`使用单个语句执行以下操作：

```
INSERT INTO event ( code, <other fields> )
    SELECT MIN(codes.code) AS code, <other values> FROM codes
        LEFT JOIN event ON ( codes.code = event code
        AND ( event.date_end > DATE_ADD(now(), INTERVAL 7 day)
              OR event.date_start >= NOW()) )
    WHERE event.code IS NULL; 
```

这会选择所有未在“活动”事件中使用的代码，并将其中最小的代码插入`event`（根据需要添加其他字段）。

您也可以使用 subSELECT ( `SELECT DISTINCT code FROM event`) 代替`codes`表格，但在这种情况下，您只会选择至少已经使用过一次的代码；任何“新”代码都将被忽略。

上述逻辑的一个副作用是，较大的代码被重复使用的频率较低，即，如果您有 20 个活动事件，它们使用的代码很可能是 1 到 20。如果您想均匀地回收代码，您可以例子`SELECT ... ORDER BY RAND() LIMIT 1`。

# asp.net - 在一个 asp 中继器项目中渲染标记

> ID：12391215
> 
> 赞同：0
> 
> 时间：2012-09-12T15:06:06.403
> 
> 标签：asp.net, .net, vb.net, repeater

好的，只是想着如何正确地提出问题。

我有一个返回一些反馈详细信息的数据表。数据表包含两家公司的反馈。数据表的反馈根据每个数据行中的一个指标来区分。

中继器按日期顺序排序（最新的优先）。如果公司是 A 和 B，则 A 公司的反馈将始终列在最前面，因为它们是最新的。如果列出的反馈是 B 公司的反馈，我已经渲染了一张图片和一些措辞。

```
Public Function RenderTitle(ByVal objItem As Object) As String
        Select Case objItem
            Case 1
                Return String.Empty
            Case 0
                Return "Feedback below obtained whilst a member of our sister company  " & "<img src=""../img/logo.png"" />"
            Case Else
                Return String.Empty
        End Select
    End Function 
```

如果反馈属于 B 公司，则会呈现标题。

问题：我不希望在 B 公司的所有项目中呈现标题。我希望它只在属于 B 公司的第一个项目（反馈）中呈现。我该如何实现呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:18:18.357

根据数据格式化 DataList 或 Repeater 控件的内容可以通过使用两种技术来完成。

第一种技术是为 ItemDataBound 事件创建一个事件处理程序，该事件在数据源中的每条记录绑定到新的 DataListItem 或 RepeaterItem 时触发。在 ItemDataBound 事件处理程序中，可以检查当前项目的数据，然后可以将格式应用于模板的内容，或者对于 DataListItems，应用于整个项目本身。

或者，可以通过格式化函数来实现自定义格式化。格式化函数是一种可以从 DataList 或 Repeater 的模板调用的方法，该模板返回要在其位置发出的 HTML。通常，格式化函数返回的 HTML 由绑定到当前项的值决定。这些值可以作为标量值或通过传入绑定到项目的整个对象（例如 ProductsRow 实例）传递给格式化函数。

[http://msdn.microsoft.com/en-us/library/bb510136.aspx](http://msdn.microsoft.com/en-us/library/bb510136.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:35:11.360

你能试试这样的东西吗......（丑陋的代码和未经测试）

**HTML**

```
...
<asp:HiddenField ID="hdnIsTitleRenderd" runat="server"/>
... 
```

**代码**

```
Page_Load()
    If Not IsPostBack
         hdnIsTitleRenderd.Value = "False"
    End If
End  Sub 

Public Function RenderTitle(ByVal objItem As Object) As String
       Select Case objItem
            Case 1
                Return String.Empty
            Case 0
                If Convert.ToBoolean(hdnIsTitleRenderd.Value) = False
                       hdnIsTitleRenderd.Value = "True"
                       Return "Feedback below obtained whilst a member of our sister company  " & "<img src=""../img/logo.png"" />"
                Else
                    Return String.Empty
                End If
            Case Else
                    Return String.Empty
        End Select
End Function 
```

# jsf-2 - 在 RichFaces webapp 中被忽略

> ID：12391220
> 
> 赞同：4
> 
> 时间：2012-09-12T15:06:14.273
> 
> 标签：jsf-2, internet-explorer-9, richfaces

我在 Glassfish 2.1 上使用 JSF 2.0 和 RichFaces 3.3.3。我创建了一个带有模式面板的 Web 应用程序，该面板在我的计算机（本地服务器）中运行良好。由于特定 RichFaces 版本的 IE9 不兼容，我`X-UA-Compatible: IE=8`在我的 HTML 头中使用了元标记：

```
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

当我在本地环境中部署时，模态面板如下所示：

![1好](../Images/ccb5b3e6ac5f06ef57848ba2400e4d8c.png)

但是当我在生产服务器中部署时，我遇到了问题。

如果我使用带有兼容性视图的 IE [（来源：][[geneanet.org](http://bloges.geneanet.org/public/Blog%20EN/EN-ie8-03.png)][）] ，我的模态面板如下所示：[![补偿](../Images/aedf4a119a872b7e30a71ae11ea95493.png)](https://i.stack.imgur.com/NTmsU.png)

![2不行](../Images/d3619f8208fcde8ae77e3711ed044d43.png)

如果我不使用兼容性视图，我会看到模态面板，但我所有的 ajax 按钮都不起作用。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:45:17.603

来自 IE 开发人员文档，[定义文档兼容性](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)：

> ...
> 
> 标`X-UA-Compatible`头不区分大小写；但是，它必须出现在网页的标题（HEAD 部分）中**，在除标题元素和其他元元素之外的所有其他元素之前**。
> 
> ...

RichFaces 3.3.3 默认自动包含`<link>`引用 RichFaces 特定 CSS 样式表的元素，位于**头顶**，位于原始模板内容*之前。*`<head>`因此， HTML元素`X-UA-Compatible`风格的标头在RichFaces 3.3.3 webapp 中*总是*无法工作。它在您的本地开发环境中运行良好很可能是因为您已将 localhost 站点添加到浏览器配置中的 IE8 兼容站点列表中。那时标题的存在不再重要。`<meta>`*`X-UA-Compatible`*

 *最好的办法是`X-UA-Compatible`直接在 HTTP 响应本身上设置标头，而不是作为 HTML 元标记。您可以使用一个简单的[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)来做到这一点，该过滤器被映射`FacesServlet`并执行以下工作：

```
@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    ((HttpServletResponse) response).setHeader("X-UA-Compatible", "IE=8");
    chain.doFilter(request, response);
} 
```*

# javascript - 具有全局标志的正则表达式仅匹配第一个匹配项

> ID：12391221
> 
> 赞同：2
> 
> 时间：2012-09-12T15:06:18.297
> 
> 标签：javascript, regex, regex-greedy

为什么：

```
/(\[#([0-9]{8})\])/g.exec("[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]") 
```

返回

> [“[#12345678]”、“[#12345678]”、“12345678”]

我希望它匹配所有这些数字，但它似乎太贪婪了。

> [#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355] 12345678 87654321 56233001 36381069 23416459 56435355

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:08:39.170

就是这样`.exec()`工作的。要获得多个结果，请在循环中运行它。

```
var re = /(\[#([0-9]{8})\])/g,
    str = "[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]",
    match;

while (match = re.exec(str)) {
    console.log(match);
} 
```

此外，外部捕获组似乎无关紧要。你可能应该摆脱它。

```
/\[#([0-9]{8})\]/g, 
```

结果：

```
[
    "[#12345678]",
    "12345678"
],
[
    "[#87654321]",
    "87654321"
],
[
    "[#56233001]",
    "56233001"
],
[
    "[#36381069]",
    "36381069"
],
[
    "[#23416459]",
    "23416459"
],
[
    "[#56435355]",
    "56435355"
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:14:58.697

您可以使用`replace`字符串的方法来收集所有匹配项：

```
var s = "[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]";
var re = /\[#([0-9]{8})\]/g;
var l = [];
s.replace(re, function($0, $1) {l.push($1)});
// l == ["12345678", "87654321", "56233001", "36381069", "23416459", "56435355"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:11:55.347

`regex.exec`返回正则表达式中的组（括号中的内容）。

您要查找的函数是您在字符串上调用的函数，`match`.

`string.match(regex)`返回所有匹配项。

```
"[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]".match(/(\[#([0-9]{8})\])/g)
// yields: ["[#12345678]", "[#87654321]", "[#56233001]", "[#36381069]", "[#23416459]", "[#56435355]"] 
```

编辑：

如果您只想要不带括号和 # 的数字，只需将正则表达式更改为`/\d{8}/g`

```
"[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]".match(/[0-9]{8}/g)
// yields: ["12345678", "87654321", "56233001", "36381069", "23416459", "56435355"] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T17:11:50.723

尝试这个：

```
 var re = /\[#(\d{8})\]/g;
    var sourcestring = "[#12345678] [#87654321] [#56233001] [#36381069] [#23416459] [#56435355]";
    var results = [];
    var i = 0;
    var matches;
    while (matches = re.exec(sourcestring)) {
        results[i] = matches;
        alert(results[i][1]);
        i++;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-30T11:43:03.530

在 ES2020 中添加了一个新功能[matchAll](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll)女巫可以完成这项工作。

# jquery - 淡出按钮/选项卡，直到表单字段有用户输入

> ID：12391222
> 
> 赞同：0
> 
> 时间：2012-09-12T15:06:18.630
> 
> 标签：jquery, forms, input, hide, fade

[http://tinyurl.com/8z8rup5](http://tinyurl.com/8z8rup5)

请看看我到目前为止的发展。我正在尝试在 jQuery 中禁用此表单顶部的选项卡以及下一步链接（这些是锚点，而不是输入按钮 - 至少在提交按钮之前），直到在该特定字段上填写标签。用户在之前的选项卡中输入数据后，可以返回到之前的选项卡。我认为，它们不一定需要是正确的，而只是有用户输入。

我不完全确定如何去做，因为我试图禁用锚链接（并淡化它们的不透明度）而不是输入按钮。

任何帮助都会很棒！谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:14:07.267

尝试看一下这篇文章：[如何使用 jQuery 启用或禁用锚点？](https://stackoverflow.com/questions/1164635/how-to-enable-or-disable-an-anchor-using-jquery)

基本上你会想要阻止锚的默认功能，直到满足某些条件：

```
$('a.something').click(function(e) {
  if(!valid) 
    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:14:57.690

您可以使用 preventDefault() 来防止发生默认操作。因此，对于您的导航链接，您可以使用以下方法禁用它们：

```
$(".desktoponly a").click(function (e){
   e.preventDefault();
}); 
```

显然，您可以对站点中的任何其他锚标记执行相同的操作。在单击按钮时，您可以检查表单是否完整，并且仅在表单完整时才转换。

看到这个小提琴：

[http://jsfiddle.net/johnkoer/j6X88/4/](http://jsfiddle.net/johnkoer/j6X88/4/)

# mysql - 将 Play Framework @ManyToOne 关系链接到 MySQL 中的外键

> ID：12391223
> 
> 赞同：2
> 
> 时间：2012-09-12T15:06:19.763
> 
> 标签：mysql, jpa, playframework, foreign-keys, playframework-1.x

我想做的是让我的游戏！项目使用 MySQL 上已经存在的数据库。与数据库的连接很好。我的问题在于将 MySQL 数据库中的外键约束链接到我的 Play！项目类的 @ManyToOne 关系。

所以基本上我目前在我的数据库中拥有的是：

```
...
create table clubadmin  (
    clubadmin_id  int not null auto_increment,
    club_id int not null,
    user_id int not null,
    primary key (clubadmin_id),
    constraint fk_clubadmin_club_id foreign key (club_id) references club(club_id), 
    constraint fk_clubadmin_user_id foreign key (user_id) references user(user_id)
);

create table special(
    spec_id int not null auto_increment,
    spec_datetime datetime not null,
    spec_content varchar(500) not null,
    clubadmin_id int not null,
    primary key (spec_id),
    constraint fk_special_clubadmin_id foreign key (clubadmin_id) references clubadmin(clubadmin_id)
);
... 
```

强调特殊和俱乐部管理员之间的关系。

在我的游戏中！项目我有一个 ClubAdmin 和一个具有以下内容的特殊课程：

```
package models;

...

@Entity
@Table(name="special")
public class Special extends GenericModel
{
        @Id 
        @GeneratedValue(strategy=GenerationType.AUTO)
        @Required
        public Long spec_id;

        ...

        @ManyToOne
        @Required
        public Clubadmin clubadmin;

        public Special(Clubadmin admin,...)
        {
                ...
                this.clubadmin = admin;
                ...
        }
} 
```

和

```
package models;

...

@Entity
@Table(name="clubadmin")
public class ClubAdmin extends GenericModel
{

        @Id 
        @GeneratedValue(strategy=GenerationType.AUTO)
        @Required
        public Long clubadmin_id;

        ...

        @OneToMany(mappedBy="clubadmin",cascade=CascadeType.ALL)
        public List<Special> specials;

        public ClubAdmin(...)
        {
                ...
                this.specials=new ArrayList<Special>();
                ...
        }
} 
```

从我所见，看起来在 Special 类中创建 @ManyToOne 关系是在 Special 表中创建一个新字段，其名称`clubadmin_clubadmin_id`代表外键，而不管`fk_special_clubadmin_id`约束是否存在。这不应该发生。

我如何制作 Play！实现并使用数据库中现有的约束，使其不创建自己的？

我正在使用播放！1.2.4 和 MySQL 5.3

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T05:36:32.650

将 JoinColumn 注释添加到您的 ManyToOne 字段以指定与 jpa 推断的列名不同的列名

就像是

```
@JoinColumn(name="clubadmin_id", referencedColumnName="clubadmin_id") 
```

# hadoop - hadoop hdfs 指向 file:/// 而不是 hdfs://

> ID：12391226
> 
> 赞同：6
> 
> 时间：2012-09-12T15:06:32.323
> 
> 标签：hadoop, hdfs, cloudera

所以我在 CentOS 5 上通过 Cloudera Manager cdh3u5 安装了 Hadoop。当我运行 cmd

`hadoop fs -ls /`

我希望看到 hdfs://localhost.localdomain:8020/ 的内容

但是，它返回了**file:///的内容**

现在，不用说我可以通过以下方式访问我的**hdfs://**

`hadoop fs -ls hdfs://localhost.localdomain:8020/`

但是在安装 Accumulo 等其他应用程序时，accumulo 会自动检测 Hadoop Filesystem in file:///

问题是，有没有人遇到过这个问题，你是如何解决的？

我查看了[HDFS thrift server 返回本地 FS 的内容，而不是 HDFS](https://stackoverflow.com/questions/10331992/hdfs-thrift-server-returns-content-of-local-fs-not-hdfs)，这是一个类似的问题，但没有解决这个问题。另外，Cloudera Manager cdh4 没有这个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T15:42:22.483

默认情况下，Hadoop 将使用本地模式。您可能需要设置`fs.default.name`为`hdfs://localhost.localdomain:8020/`in `$HADOOP_HOME/conf/core-site.xml`。

为此，您将其添加到`core-site.xml`：

```
 <property>
  <name>fs.default.name</name>
  <value>hdfs://localhost.localdomain:8020/</value>
</property> 
```

Accumulo 感到困惑的原因是因为它使用相同的默认配置来确定 HDFS 的位置......并且它默认为`file://`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-06T07:41:47.377

我们应该指定数据节点数据目录和名称节点元数据目录。

dfs.name.dir,

dfs.namenode.name.dir,

dfs.data.dir,

dfs.datanode.data.dir,

fs.default.name

在 core-site.xml 文件和格式名称节点中。

要格式化 HDFS 名称节点：

hadoop 名称节点格式

输入“是”以确认格式化名称节点。重启 HDFS 服务并部署客户端配置以访问 HDFS。

如果您已经完成了上述步骤。确保正确部署客户端配置并且它指向实际的集群端点。

# elasticsearch - 如何使 Elasticsearch 索引全局区分大小写？

> ID：12391228
> 
> 赞同：2
> 
> 时间：2012-09-12T15:06:37.810
> 
> 标签：elasticsearch, case-sensitive

默认情况下，ES 不区分大小写。有一些示例（例如[elasticsearch 中不区分大小写的搜索](https://stackoverflow.com/questions/11638676/case-insensitive-search-in-elasticsearch)）如何为 ES 中的特定字段定义分析器。

我有大量的数据类型，加载了不同的字段，按名称在字段上设置分析器对我来说是完全不切实际的。

我以前使用 Solr，并通过对我的所有数据使用 dynamicFields 并编辑 schema.xml 以修改“文本”字段类型以从分析器中删除 LowerCaseFilterFactory 来完成全局区分大小写的搜索。

我怎样才能在 ES 中做类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:47:03.780

[查看Analysis index 模块](http://www.elasticsearch.org/guide/reference/index-modules/analysis/)的 elasticsearch 文档。有一个默认分析器部分说：

> 默认逻辑名称允许配置一个分析器，该分析器将用于索引和搜索 API。default_index 逻辑名可用于配置仅在索引时使用的默认分析器，而 default_search 可用于配置仅在搜索时使用的默认分析器。

我想这就是你要找的。很高兴知道 elasticsearch 中的默认分析器是[StandardAnalyzer](http://www.elasticsearch.org/guide/reference/index-modules/analysis/standard-analyzer.html)。

# maven-3 - 声纳和 Maven 与 Windows 上的 SQL 服务器

> ID：12391230
> 
> 赞同：2
> 
> 时间：2012-09-12T15:06:44.173
> 
> 标签：maven-3, sonarqube

运行 Sonar 3.2 时，当我尝试列出在 Web 浏览器中分析的项目时，会显示以下错误消息。

尝试显示小部件“过滤器”时出错。请联系管理员。

查看声纳日志时，我看到以下消息：

> rails 无法呈现小部件过滤器：org.sonar.api.utils.SonarException：无法执行过滤器：Filter[rootSnapshotId=,baseSnapshotId=,baseSnapshotPath=,scopes=,qualifiers=[TRK],languages=,favouriteIds=,dateCriterion= ,keyRegexp=,nameRegexp=,onDirectChildren=false,measureCriteria=[],periodIndex=0,sortedMetricId=,sortedByMeasureVariation=false,sortedByLanguage=false,sortedByName=true,sortedByKey=false,sortedByDate=false,sortedByVersion=false,isNumericMetric=true ,ascendingSort=true], sql=SELECT s.id, MAX(s.project_id) as pid, MAX(s.root_project_id) as rpid, MAX(p.long_name) as name FROM snapshots INNER JOIN projects p ON s.project_id =p.id WHERE s.status=:status AND s.islast=:islast AND s.qualifier IN (:qualifiers) AND p.copy_resource_id IS NULL GROUP BY s.id

我在后端使用 SQL Server 2008。该查询看起来不适合 SQL。有什么问题？使用 Maven 分析项目时，我没有遇到任何问题。它给了我一个构建成功。

我在窗口上使用 Apache Maven 3.0.2 和 Sonar 3.2。关于发生了什么的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T19:13:07.147

您是否使用 sqljdbc 驱动程序连接到 SQL Server？我通过使用[此答案](https://stackoverflow.com/a/8128690/1046641)中详述的[jTDS 驱动程序](http://jtds.sourceforge.net/index.html)解决了这个问题。

# javascript - spin.js 在启动时填充模型实例

> ID：12391231
> 
> 赞同：0
> 
> 时间：2012-09-12T15:06:45.613
> 
> 标签：javascript, spine.js

这里绝对是初学者。我想在页面加载后立即将数据加载到模型中。在执行任何其他操作之前。目前我有这个代码。

```
// Model code
var Portfolio = Spine.Model.sub({});
Portfolio.configure("Portfolio")

Portfolio.extend({
  populate: function(values){
    for(var i in values[0]){
     // add attributes to Model
      this.attributes.push(i);
    }
    for(var j = 0; j < values.length; j++ ){
      var tmpInst =  this.create(values[j]);
      tmpInst.save();
    }
  }
});

// app controller code
$(function(){
   var App =Spine.Controller.sub({
    init: function(){
      jQuery.getJSON("../xml/data.json", 
        function(result){ 
             Portfolio.populate(result['content']);
        }
      ).complete(function(result) { 
          // do other stuff
      });
    }
  })
    var app = new App();
}); 
```

因此，当页面完成加载时，将`init`调用控制器函数，该函数检索 json 数据并将其传递给模型，模型对其进行解析并创建各个实例。

我做错了吗？我在文档中看到了 Fetch 函数，但没有关于它是如何工作的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:09:24.117

您可能想使用 Spine 的框架来执行此操作：

1.  不要触发你自己的 jQuery.getJSON()，而是在你的模型中包含 Spine.Ajax。

    ```
    Portfolio.extend(Spine.Model.Ajax);
    ```

2.  将 Spine.Model.host 设置为您的服务器
3.  将 url 属性/方法添加到您的 Portfolio 对象，例如“xml/data.json”
4.  调用 Portfolio.fetch()
5.  覆盖 Portfolio.fetch() 函数以仅提取数组数据的节点或您想到的任何初始化，就像配置一样。如果我没记错的话， fetch() 将加载对象并设置 JSON 中提供的所有属性，即使它们没有在 Model @configure 调用中配置

# html - 使用 CSS 强制表格行出现在同一行

> ID：12391242
> 
> 赞同：2
> 
> 时间：2012-09-12T15:07:11.743
> 
> 标签：html, css

我有一个像这样的两行表：

```
---------------------------
| 1 Item | Total: $370.00 |
---------------------------
|   View Cart   Check-out |
--------------------------- 
```

我希望它内联显示，如下所示：

```
| 1 Item | Total: $370.00 | View Cart   Check-out | 
```

这可能与 CSS 吗？注意：不幸的是，这段代码是由我的 CMS 生成的，很难将其更改为使用 div，然后使用 CSS float:left 或 display:inline-block。

简化的 HTML：

```
<table class="cart-block-summary">
 <tbody>
  <tr>
   <td class="cart-block-summary-items">1 Item</td>
   <td class="cart-block-summary-total">Total: $370.00</td>
  </tr>
  <tr class="cart-block-summary-links">
   <td colspan="2">View cart  Checkout</td>
  </tr>
 </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:12:57.623

为我工作：

```
 ​​table { width: 600px;}
    tr{float:left}​ 
```

[http://jsfiddle.net/N5fhU/](http://jsfiddle.net/N5fhU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:54:02.670

您也可以删除最后一个 TR，这样它看起来就在一行中

```
<table class="cart-block-summary">
 <tbody>
  <tr>
   <td class="cart-block-summary-items">1 Item</td>
   <td class="cart-block-summary-total">Total: $370.00</td>
   <td class="cart-block-summary-links" colspan="2">View cart Checkout</td>
  </tr>
 </tbody>
</table> 
```

# c++ - Visual Studio 中的 /MD 不会从发布配置中的 msvcr100.dll 导入

> ID：12391243
> 
> 赞同：0
> 
> 时间：2012-09-12T15:07:12.727
> 
> 标签：c++, visual-studio-2010

我有一个有点奇怪的问题，通常人们倾向于问如何从他们的可执行文件中删除对 msvcrXX.dll 的引用，而我有一个相反的问题：我需要强制我的可执行文件使用 msvcr100.dll。它是必需的，因为我将使用 CRT 的附加 DLL 链接到我的项目，并且此 DLL 导入 msvcr 函数。

所以我设置了 /MD 选项，然后在“调试”中构建时，我得到了一个工作代码（msvcr100.dll 在 EXE 的导入表中），但是当我尝试编译“发布”时，我实现了一个更大的可执行文件只有从 mylib.dll 和 kernel32.dll 导入，这会导致 CRT 未正确初始化并因此出现运行时错误。

我有

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h> 
```

在代码中，例如，使用了“printf”函数。

提前感谢您的答案。

添加：我找到的解决方案：在代码开头添加“#define _DLL”并将msvcrt.lib添加到附加依赖项中。谷歌说，这就是“/MD”必须做的，不知道为什么没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:47:55.257

我找到的解决方案：在代码开头添加“#define _DLL”并将 msvcrt.lib 添加到附加依赖项中。谷歌说，这就是“/MD”必须做的，不知道为什么没有。

任何更美好的想法仍然值得赞赏。

# c# - PdfSharp - 入门

> ID：12391244
> 
> 赞同：1
> 
> 时间：2012-09-12T15:07:14.863
> 
> 标签：c#, visual-studio-2010, pdfsharp

我有一个 C# 控制台应用程序，并想向其中添加 PdfSharp 的一些功能。

我已经从[Sourceforge](http://sourceforge.net/projects/pdfsharp/support)下载了两个 zip 文件……程序集和源代码。

似乎有几种方法可以添加功能

*   `.dll`对解压缩程序集文件夹中文件的引用。
*   实际上将项目添加到我的解决方案中。

我正在尝试使用后一种方法。

这就是我需要做的吗？

1.  我将解压缩的源代码文件中的文件夹“PdfSharp”复制并粘贴到我的解决方案文件夹中。
2.  在 VS 我去解决方案资源管理器右键单击解决方案并选择`Add`>`Existing Project...`
3.  然后我选择了以下...

![在此处输入图像描述](../Images/9dc15217af5176899f6480443926ea39.png)

我承担项目`PdfSharp-ag.csproj`；`PdfSharp-Hybrid.csproj`; `PdfSharp-WPF.csproj`用于其他一些应用程序？我的意思是我的简单控制台应用程序就是我需要的项目`PdfSharp.csproj`？

完成上述步骤后，我的解决方案如下所示：

![在此处输入图像描述](../Images/61bb55a0697808fc4f1795d53324b7de.png)

...并且在原始项目参考部分中参考 PdfSharp 进行扩展时：

![在此处输入图像描述](../Images/75b74d601a5677bdcdf95f8f89a52236.png)

* * *

然后，我使用以下代码测试了控制台应用程序一切正常：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Drawing; //<< additional reference required

using PdfSharp;
using PdfSharp.Pdf;
using PdfSharp.Drawing;

namespace PDFsharpSolutionQF
{
  class Program
  {
    static void Main(string[] args)
    {

      PdfDocument pdf = new PdfDocument();
      pdf.Info.Title = "My First PDF";
      PdfPage pdfPage = pdf.AddPage();
      XGraphics graph = XGraphics.FromPdfPage(pdfPage);
      XFont font = new XFont("Verdana",20,XFontStyle.Bold);
      graph.DrawString("This is my first PDF document",font,XBrushes.Black,new XRect(0,0,pdfPage.Width.Point,pdfPage.Height.Point),XStringFormats.Center);
      string pdfFilename = "firstpage.pdf";
      pdf.Save(pdfFilename);
      //Process.Start(pdfFilename);

    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:09:57.310

您能否详细说明为什么要尝试将程序源添加到您自己的应用程序中？如果您只是想利用库的功能，那么您最好只在项目中引用 DLL，然后使用它提供的 API。

我能想到的靠近源代码的唯一原因是 a) 如果您需要对其进行调试或 b) 如果您打算以某种方式修改功能。您是在尝试这样做，还是只是以通常的方式使用 API？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:33:39.093

您可以使用 PdfSharp.csproj 或 PdfSharp-WPF.csproj - 前者使用 GDI+ 进行图形操作，后者使用 WPF 函数。-Hybrid 是内部的，-ag 是用于 SilverLight 的（功能还不完整）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-31T01:39:06.070

在项目中包含源代码的一个好处是无需分发 DLL。我个人使用DLL。但我可以看到仅分发 EXE 的优势。

# php - PHP数组的问题

> ID：12391246
> 
> 赞同：1
> 
> 时间：2012-09-12T15:07:27.537
> 
> 标签：php, arrays

我将开始说我真的是 PHP 的菜鸟，我需要解决一个问题，我知道逻辑，但是在语法上我已经死了。

情况就是这样。

我需要创建一个 wordpress 循环，它将显示具有 3 种不同颜色的 span 类的图像，每个循环 1 个，因此，0 = 绿色，1 = 蓝色，2 = 粉红色。

由于我有 3 种颜色和 X 个输出，我考虑创建一个从 0 到 2 的数组，根据我描述的颜色分配一个值，然后创建一个条件，如果 i > 2，则 i = 0 .

有了这个，我将在我的 span 类上回显数组值，这应该可以解决问题。

我需要帮助的是为此创建语法，到目前为止，这就是我所拥有的：

```
<?php while ( have_posts() ) : the_post(); $i = 0 ?>
 <?php 
    $array = array(
      0 => 'green', 
      1 => 'blue', 
      2 => 'pink',
    ); 
  ?>
 <span class="<?php echo $array ?>;">Title</span>

 <?php
  $i++;
 ?>
 <?if ($i > 2) { $i=0; } endif; ?> 
<?php endwhile; ?> 
```

我错过了应该将计数器 i 与数组进行比较的部分。

我将不胜感激任何帮助！

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:10:01.933

此代码存在一些**问题**（以及一些建议）。

*   您`$i = 0;`在 while 循环中定义，这意味着它总是`== 0`
*   您正在尝试打印`$array`而不是一个项目

如何**修复**：

*   移出`$i = 0;`while 循环（所以它在循环之前定义）
*   用于`echo $array[$i]`回显您要查找的项目 ID
*   使用模运算符获取余数`$i / 3`并将其用作索引

你也可以

*   在一行上定义`$colors = array('green', 'blue', 'pink');`行为相同的数组 - 这适用于 PHP 使用从 0 开始的默认索引
*   使用类似的变量`$colors`而不是`$array`使发生的事情更清楚
*   减少`<?php`标签的数量以使事情更清晰
*   `$colors`在循环外定义数组（现在称为）

请参阅下面的完整代码

```
<?php 
  $colors = array(
    0 => 'green', 
    1 => 'blue', 
    2 => 'pink',
  ); 

  $i = 0;
  while ( $loop->have_posts() ) : $loop->the_post();    
?>
<span class="<?php echo $colors[$i % 3] ?>;">Title</span>
<?php
  $i++;
  endwhile;
?> 
```

并进一步简化

```
<?php 
  $colors = array('green', 'blue',  'pink'); 
  $i = 0;
  while ( $loop->have_posts() ) : $loop->the_post();    
?>
    <span class="<?php echo $colors[$i % 3] ?>;">Title</span>
<?php
    $i++;
  endwhile;
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:13:12.427

首先，`$array`每次运行循环时都要重新声明。把它放在你开始`while`循环之前。

其次，您需要使用索引访问数组中的元素：

```
<span class="<?php echo $array[$i] ?>;">Title</span> 
```

第三，您需要将循环放在`$i = 0` *前面。*`while`这里发生的是变量每次`$i`都被重置。`0`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:09:24.800

您正在打印整个`$array`而不是单个数组元素（即`$array[$i]`），您还在循环`$i = 0`内重置计数器（） ：`while`

```
<?php 
    // a little bit cleaned up version of your code
    $array = array(
        0 => 'green', 
        1 => 'blue', 
        2 => 'pink',
    ); 

   $i = 0;
   while ( $loop->have_posts() ) : $loop->the_post();
?>
   <span class="<?php echo $array[$i] ?>;">Title</span>
<?php
    $i++;
    if ($i > 2) { $i=0; }

    endwhile; 
?> 
```

# jquery - Jquery 表单插件在 IE 8 中不起作用

> ID：12391249
> 
> 赞同：8
> 
> 时间：2012-09-12T15:07:36.163
> 
> 标签：jquery, ajax, internet-explorer, plugins, jquery-forms-plugin

经过4个小时的阅读帖子试图解决这个问题......

我使用该插件上传照片并将其返回到 Tinymce 编辑器。它在 Chrome 和 Firefox 中完美运行，但在 IE 中失败。在开发工具中，它在第 474 行的 jquery.forms.js 中中断，因为 IE 无法识别该`finally`语句。所以我删除它，然后当同一个文件调用`form.submit()`. 无论如何我都无法解决这个问题。我正在使用`Jquery v. 1.8.1`和`Malsup Jquery Form Plugin v. 3.15`。

这是代码：

```
$("#img-form").hide(); // hide the browse button

$("#image").change(function() {
    $("#img-form").ajaxSubmit(options); // upload the file directly after selection
});

/*
 * set options for jQuery form plugin
 */
var options = { 
    cache: false,
    contentType:"text/html",
    type: 'POST',
    url: "../upload.php",
    data: { width: w, height: h, bounds: b },
    success: showResponse  // post-submit callback 
}; 

function showResponse(responseText, statusText, xhr, $form)  { 
    var obj = JSON.parse(responseText);
    var state = obj.state;
    var response = obj.response;

    if(state) {
        tinyMCE.execCommand('mceInsertContent', false, response); // place the image into the editor
    } else {
        alert(response);
    }
} 
```

任何帮助，你都会拯救我的理智，谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-20T20:57:49.543

事实证明，这是 100% 不可能的。由于我通过触发`click`而不是通过实际用户单击按钮打开文件浏览器，因此出于安全原因，IE 绝不允许您提交表单。我必须让用户手动单击文件输入，然后表单插件就很神奇。

# c++ - 错误 LNK2001：未解析的外部符号 Visual C++

> ID：12391253
> 
> 赞同：2
> 
> 时间：2012-09-12T15:07:51.187
> 
> 标签：c++, visual-studio-2010, mfc

> **可能重复：**
> [`static`, `extern`,`const`在头文件中](https://stackoverflow.com/questions/9908151/static-extern-const-in-header-file)

我正在使用 Visual C++ 并遇到此错误。

我在 global.h 中分别声明了下面两条外部行。

```
extern CSocketManager  m_SocketManager[10];
extern CSocketManager* m_pCurServer; 
```

```
1>ServerSocketDlg.obj : 错误 LNK2001: 无法解析的外部符号 "class CSocketManager * m_pCurServer" (?m_pCurServer@@3PAVCSocketManager@@A)

1>SocketManager.obj : 错误 LNK2001: 无法解析的外部符号 "class CSocketManager * m_pCurServer" (?m_pCurServer@@3PAVCSocketManager@@A)

```

有谁知道可能导致这些错误的原因？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:12:32.943

在 .h 中声明为 extern 的对象也必须在 .cpp 文件中声明。

问题是链接器不知道在哪里可以找到这两个对象。

解决方案：您还必须在 .cpp 文件中声明 m_pCurServer 因为它是正在编译的 .cpp，而不是标头。

# excel - 在excel中复制单元格

> ID：12391255
> 
> 赞同：1
> 
> 时间：2012-09-12T15:07:53.433
> 
> 标签：excel, cell, replicate

有谁知道是否有办法在 excel 中精确复制一个单元格，以便它具有相同的值和相同的格式？因此，如果“父”单元格的格式发生更改（通过条件格式），则复制的单元格也会更改格式。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:45:17.967

假设原始单元格是 A1。

最简单的方法是设置新单元格`=a1`。要复制条件格式，请选择原始单元格 a1，然后选择格式刷（在剪贴板子菜单上；看起来像对角线上的画笔）。（图标将变为画笔。）然后单击新单元格。

我尝试了几种类型的条件格式，它适用于条件格式 - >突出显示单元格规则（例如，大于 nn）。

它也适用于顶部/底部规则或色标等范围，但您需要复制整个范围（如果您复制单个单元格，它将不起作用，因为范围没有意义）。

# javascript - Backbone.js 微模板

> ID：12391256
> 
> 赞同：0
> 
> 时间：2012-09-12T15:07:59.907
> 
> 标签：javascript, templates, backbone.js

我有一个应用程序，它使用 Backbone.js、Jquery、Mustache 和 PHP 作为后端。

我已经从 underscore.js 实现了微模板，我目前在我的标题页中定义了这些模板。

我对如何组织模板有点怀疑。是否有任何有效的方法来组织文件中的所有模板并根据需要加载它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:17:23.983

我使用与您完全相同的设置。Backbone、jQuery、mustache（用于初始页面渲染）和 PHP（你是 SlimPHP 的粉丝吗？:-) 我相信有很多方法可以做到这一点，但你可能会考虑使用一个非常棒的工具是 require.js。

使用 require，基本上您将 Backbone 客户端应用程序编码为一系列 AMD 模块。模型、集合、视图是它们自己的模块，它们定义了彼此之间的依赖关系。AMD 模块的本质是所有模块都是异步加载的。因此，当您的第一个页面加载时，只有使该页面运行所需的代码才会执行​​。当您离开页面并转到另一个页面时，将执行该代码，包括该代码定义的所有依赖项。

require 的好处是它有一个插件，可以让你将所有的 HTML 代码分离成 html 文件。您只需定义哪些视图需要这些文件作为依赖项，并将它们作为文本导入以在下划线模板中使用。

准备好上线后，您可以使用 require.js 的优化功能将所有 js 脚本 + html 模板压缩并合并到一个文件中。砰。

对于大型项目，这样的工具非常好。

[要求JS](http://requirejs.org/)

# c# - C# File.Exists 在部分复制的文件上

> ID：12391258
> 
> 赞同：-4
> 
> 时间：2012-09-12T15:08:06.723
> 
> 标签：c#, .net

例如，我有一个 20gb 的文件，我决定将它复制到“c:/folder/filename.ext”。显然，这需要一些时间才能完成。

如果在复制过程中执行，下面的返回是什么？

```
File.Exists("c:/folder/filename.ext"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:13:40.810

> 如果在复制过程中执行，下面的返回是什么？

假设您正在运行代码的进程具有足够的权限来读取它将返回的文件（即使文件存在，如果帐户没有足够的权限来读取文件，`True`请不要忘记`File.Exists`返回）。`False`该`File.Exists`方法不关心文件当前是否正在被写入或读取：

```
public class Program
{
    static void Main()
    {
        Task.Factory.StartNew(() =>
        {
            using (var stream = File.OpenWrite("test.dat"))
            {
                Thread.Sleep(100);
            }
        });
        Thread.Sleep(10);

        // prints True
        Console.WriteLine(File.Exists("test.dat"));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:15:15.500

我不太确定，但我认为如果有任何文件（完整或部分复制）它会返回 true。

如果您需要复制过程的状态，您应该检查长度，或使用散列 (SHA1)。

# sql-server - 函数不再接受额外参数

> ID：12391260
> 
> 赞同：0
> 
> 时间：2012-09-12T15:08:16.390
> 
> 标签：sql-server, sql-server-2008

我正在尝试将函数从一个数据库编写到另一个数据库。这些函数不是我写的，所以不知道初衷。其中之一给我带来了一些麻烦。该函数`GetPayDate`只接受一个`datetime`参数。但是，当它被调用时：

```
SET @Minutes = (SELECT SUM(DATEDIFF(n, '1/1/2008', DateTime)) FROM Activities WHERE EmployeeID = @EmployeeID AND dbo.GetPayDate(DateTime, Homework) = @PayDate AND ActivityTypeID = 2) 
```

它被传递了一个额外的参数。这发生在多个位置。它在原始数据库上运行良好，但是当我尝试将其编写为新数据库时，它会抛出：

```
Msg 8144, Level 16, State 2, Procedure GetTotalHours, Line 8
Procedure or function dbo.GetPayDate has too many arguments specified. 
```

为什么它会在一个数据库中而不是另一个数据库中工作，以及那个额外的参数可能首先在那里做什么？

来自源服务器的定义：

```
CREATE FUNCTION [dbo].[GetPayDate](@Date DATETIME)     RETURNS DATETIME  AS  BEGIN    DECLARE @FirstPayPeriod DATETIME  DECLARE @PayPeriodsElapsed INT  DECLARE @PayPeriod DATETIME    SET @FirstPayPeriod = '5/4/2008'  SET @PayPeriodsElapsed = 0    IF @Date IS NULL   SET @PayPeriod = NULL  ELSE    BEGIN    SET @PayPeriodsElapsed = CONVERT(INT, DATEDIFF(d, @FirstPayPeriod, @Date) / 14)    IF  DATEDIFF(d, @FirstPayPeriod, @Date) % 14 > 0 SET @PayPeriodsElapsed = @PayPeriodsElapsed + 1    SET @PayPeriod = DATEADD (d, @PayPeriodsElapsed * 14, @FirstPayPeriod)    SET @PayPeriod = DATEADD (d, 5, @PayPeriod)   END    RETURN @PayPeriod    END 
```

来自目标服务器的定义：

```
CREATE FUNCTION [dbo].[GetPayDate](@Date DATETIME)     RETURNS DATETIME  AS  BEGIN    DECLARE @FirstPayPeriod DATETIME  DECLARE @PayPeriodsElapsed INT  DECLARE @PayPeriod DATETIME    SET @FirstPayPeriod = '5/4/2008'  SET @PayPeriodsElapsed = 0    IF @Date IS NULL   SET @PayPeriod = NULL  ELSE    BEGIN    SET @PayPeriodsElapsed = CONVERT(INT, DATEDIFF(d, @FirstPayPeriod, @Date) / 14)    IF  DATEDIFF(d, @FirstPayPeriod, @Date) % 14 > 0 SET @PayPeriodsElapsed = @PayPeriodsElapsed + 1    SET @PayPeriod = DATEADD (d, @PayPeriodsElapsed * 14, @FirstPayPeriod)    SET @PayPeriod = DATEADD (d, 5, @PayPeriod)   END    RETURN @PayPeriod    END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:13:34.740

听起来您的一个数据库有`GetPayDate`两个参数，而另一个数据库`GetPayDate`只有一个参数。因此混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T17:18:58.163

众所周知，高级程序员有时会犯错。

您收到的错误消息是在这种情况下应该得到的。以前是否有效无关紧要，现在无效。我推测该函数最初有两个参数并且有人更改了它。（如果您已将 sql 代码正确地保存在源代码控制中，因为它与任何其他代码一样，您甚至可以告诉谁以及何时，如果您没有，那么这是建议您这样做的好时机，因为您正在迁移到一个新的数据库）。可能对函数的所有引用都没有更改，只是进行更改的开发人员正在处理的那些。

至于他们在原始数据库中工作，我怀疑他们可能不是，但他们被调用的方式可能不会冒出任何人们可以看到的错误。或者实际上，有人忘记更新的代码部分并没有被应用程序定期调用（例如，可能只有一个 IF 分支或不再使用的 proc）。因此，也许该函数正在整个应用程序中使用，但在大多数情况下，它是用一个参数正确调用的。

你看不到最后一次调用函数是什么时候。但是，您可以在 dev 上测试应用程序并同时运行 SQL 分析器以查看函数是如何被调用的。如果您使用存储过程，您可能首先需要识别调用该函数的过程并在探查器中查找它们的执行情况。

总而言之，最初发生的事情并不重要，它在新数据库中不起作用，因此必须更改调用。

# css - Gmail 是否支持 CSS 类？

> ID：12391262
> 
> 赞同：3
> 
> 时间：2012-09-12T15:08:25.737
> 
> 标签：css, gmail, css-selectors

标题实际上只是问题的缩短版本。我知道 Gmail 有限的 CSS 支持，但我正在阅读[“电子邮件中的 CSS 支持指南”](http://www.campaignmonitor.com/css/)，其中有关于 Gmail 支持`.class`和`#id`选择器的说明：

> (!) 如果在广告系列导入之前或期间内联 CSS，则在某些情况下有效

就 CSS 支持而言，这实际上意味着什么？对我来说，这听起来只是建议使用预处理器来获取任何样式声明并将它们应用于匹配的元素。

### 在 Gmail 客户端的 HTML 电子邮件中使用 CSS 类有什么技巧吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T15:16:05.927

Gmail 只会使用内联的 CSS。它不允许内部或外部样式表。或者更确切地说，我发现它的支持充其量是不可靠的。使用此工具可以为您将内部和外部样式转换为内联：

[http://inlinestyler.torchboxapps.com/styler/](http://inlinestyler.torchboxapps.com/styler/)

它甚至可以告诉您不同电子邮件客户端对您的文档的支持程度。这将使您以更理智的方式进行开发，并且仅在最后进行转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-02T12:23:26.217

Gmail 目前确实支持 .class 和 #id 选择器以及内部样式表（意思是标签）。您应该记住，某些样式是由 Gmail 修改的。例如，您不能使用负边距或框阴影 atm。

不过，我不确定外部样式表。我没有测试过这些。

# objective-c - UITableViewCell - prepareForReuse and dequeueReusableCellWithIdentifier

> ID：12391263
> 
> 赞同：0
> 
> 时间：2012-09-12T15:08:27.967
> 
> 标签：objective-c, ios, uitableview, grand-central-dispatch

Check the [GitHub project](https://github.com/SlaunchaMan/GCDExample) for this [article](http://blog.slaunchaman.com/2011/02/28/cocoa-touch-tutorial-using-grand-central-dispatch-for-asynchronous-table-view-cells/). A notification is sent by **prepareForReuse** method of the custom cell(JKCallbacksTableViewCell class) to the table(RootViewController class) which is observed by the **tableViewCellIsPreparingForReuse** method. This method resets the association key and the imageview of the cell.

So, why does author preferred to send it through a notification instead of resetting them after getting a non-nil cell from **dequeueReusableCellWithIdentifier** method of the table?

According to the [documentation of UITableViewCell](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableViewCell/reuseIdentifier), prepareForReuse is called just before dequeueReusableCellWithIdentifier.

> If a UITableViewCell object is reusable—that is, it has a reuse identifier—this method is invoked just before the object is returned from the UITableView method dequeueReusableCellWithIdentifier:.

I have tested it that when dequeueReusableCellWithIdentifier returns a non-nill value it's coupled with a call to prepareForReuse.

Author commented in the JKCallbacksTableViewCell.h about application logic separation but i think that is a kind of overkill; optimizing performance with async dispatch but sending those slow notifications to reset some properties... Or am i missing something about GCD?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:21:03.373

Most programming problems have a near-infinite number of solutions. I didn’t have any particular reason to choose notifications other than the fact that they’re loosely coupled.

Regarding your comment about the speed of the notification: the thing that makes the app slow is loading the images, so we’re trying to optimize *that*. Notifications aren’t slow enough to make a difference in the use of the app otherwise, so to use something else for pure performance reasons is unwarranted here.

That said, it’s in GitHub, so feel free to send a pull request that doesn’t use notifications. If I like it better, I’ll use it.

# c - 使用 open() 或 creat() 创建文件的权限位设置比我要求的要少

> ID：12391265
> 
> 赞同：1
> 
> 时间：2012-09-12T15:08:30.090
> 
> 标签：c, unix, file-io, permissions, umask

我正在编写一个程序来模仿 cp 实用程序。但是，我无法使文件权限正常工作。我知道它们存储在结构中`stat`并存储在`st_mode`带有`stat`.

我的问题是我没有获得组或其他类别的写权限，即`-rwxr-xr-x`即使源文件是`-rwxrwxrwx`. 我设置权限的语句如下。

```
if ( (dest_fd = open(dest_file, O_WRONLY|O_CREAT, (stats.st_mode & S_IRUSR)|(stats.st_mode & S_IWUSR)|(stats.st_mode & S_IXUSR)|(stats.st_mode & S_IRGRP)|(stats.st_mode & S_IWGRP)|(stats.st_mode & S_IXGRP)|(stats.st_mode & S_IROTH)|(stats.st_mode & S_IWOTH)| (stats.st_mode & S_IXOTH))) < 0)
    {
            printf("There was a problem opening the destination file.");
            exit(EXIT_FAILURE);
    }//ends the if statement opening the destination file. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T15:17:00.117

到目前为止的答案是正确的`umask`，而不是清除`umask`（如果您的程序是多线程的或者如果您可能正在调用任何创建文件的库函数，这很危险）我会将`umask`您视为用户配置变量不允许修改，而是`fchmod`在创建文件后调用文件以赋予它们您想要的最终权限。无论如何，这对于授予某些权限（如 suid/sgid）可能是必要的，某些内核在文件被修改时会删除这些权限。我最初也会使用 mode 创建文件`0600`，以便在打开它和更改权限之间没有竞争条件，在此期间另一个用户可以获得文件的打开句柄。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T15:13:03.503

问题的原因是

> 创建文件的权限为`(mode & ~umask)`

通常，`umask`is `022`，因此禁止创建全局可写文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:13:06.717

*nix 会屏蔽您创建的文件中的模式位，但您可以使用该`umask()`函数更改掩码。`man umask`（也许`man 2 umask`）了解详情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T15:23:43.443

您可以使用`chmod(2)`系统调用来更改现有文件或目录的权限，或者`fchmod(2)`在给定打开文件描述符的情况下设置权限。

为了更加安全并防止利用可能的竞争条件，您可以在创建文件时使用一组非常严格的权限，然后使用它`chmod(2)`来恢复原始权限。这是做什么`cp -a`（除了它创建具有默认权限的文件）：

```
$ strace cp -a file file1
...
open("file1", O_WRONLY|O_TRUNC)       = 4
...
fchmod(4, 0100640)                    = 0
... 
```

`chmod(2)`并且`fchmod(2)`不受 umask 值的影响。

# javascript - Javascript 开关不起作用

> ID：12391268
> 
> 赞同：2
> 
> 时间：2012-09-12T15:08:42.803
> 
> 标签：javascript, switch-statement

我有以下代码：

```
var windowNow = window.localStorage.getItem("windowNow");
switch(windowNow)
{
case 1:
    var link = "http://www.zive.sk/rss/sc-47/default.aspx";
    var listviewID = "feedZive";
    break;
case 2:
    var link = "http://mobilmania.azet.sk/rss/sc-47/default.aspx";
    var listviewID = "feedMobil";
    break;
case 3: 
    var link = "http://www.automoto.sk/rss";
    var listviewID = "feedAuto";
    break;
} 
```

我知道，`windowNow === 1`因为我已经用 alert 进行了检查，并且为了确保它真的是 1 我检查了它`if(windowNow == 1) { alert ("Window now is 1");}`并且它有效。但它在我的开关内不起作用（通过警报检查）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T15:11:05.553

中的项目`localStorage`始终是字符串。使用`case "1"`等。

您的检查的问题是这是一个松散的检查，它不检查数据类型。你应该尝试过

```
if(windowNow === 1) { alert ("Window now is 1");} 
```

注意三元组`=`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:11:24.613

不要在开关内声明变量。在交换机外部声明它们并在内部分配。还要先转换为整数。

```
var windowNow = parseInt(window.localStorage.getItem("windowNow"), 10), link, listviewID;
switch(windowNow)
{
case 1:
    link = "http://www.zive.sk/rss/sc-47/default.aspx";
    listviewID = "feedZive";
    break;
case 2:
    link = "http://mobilmania.azet.sk/rss/sc-47/default.aspx";
    listviewID = "feedMobil";
    break;
case 3: 
    link = "http://www.automoto.sk/rss";
    listviewID = "feedAuto";
    break;
default:
    // default assignment.
} 
```

# sql - 用 JOIN 替换 SQL UNION

> ID：12391270
> 
> 赞同：0
> 
> 时间：2012-09-12T15:08:54.790
> 
> 标签：sql

我对 SQL 很陌生，我有一个关于连接的问题。

我有以下三个表，其中第三个表可以包含有关标题和项目级别的信息

表 1 - 标题

```
GUID

AAA
BBB
CCC 
```

表 2 - 项目

```
GUID ITEMNR -> Can be 01, 02, ... 99

BBB  01
BBB  02
CCC  01 
```

表 3 - 添加信息

```
GUID INFO ITEMNR -> If 00 info belongs to header, if > 00 info on item level

AAA  xx   00
BBB  yy   00
BBB  xx   10
CCC  zz   00 
```

现在我想搜索 info = xx 的 guid，但我需要找到 info = xx 的 guid（在标题级别）以及至少一个项目具有 info = xx 的 guid

所以结果应该是这样的

```
GUID ITEMNR
AAA  00
BBB  10 
```

像下面这样的东西可以工作，但它使用 UNION：

```
SELECT H.GUID, I.itemnr
from HEADER as H 
inner join ADDINFO as A on H.guid = A.guid and A.itemnr = '00'
left outer join ITEM as I on I.guid = A.guid 
where 
A.info = 'xx' and
NOT EXIST (SELECT GUID FROM ADDINFO WHERE ADDINFO.guid = I.guid and
ADDINFO.itemnr =     I.itemnr)
UNION
SELECT H2.GUID, I2.itemnr
from HEADER as H2
inner join ADDINFO as A2 on H2.guid = A2.guid and A2.itemnr > '00'
inner join ITEM as I2 on H2.guid = I2.guid 
where A.info = 'xx' 
```

是否有任何 SQL 专家知道仅使用一个选择和连接而不是“联合”和“不存在”来获得上述结果的可能性 - 在我正在工作的应用程序中，我不能使用联合或“不存在”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:25:03.473

您正试图找到具有特定特征的事物组。我认为最好的方法是使用 group by and having 子句：

```
select guid
from addinfo
group by guid
having sum(case when info = 'xx' and itemnr = '00' then 1 else 0 end) > 0 or -- items on header level
       sum(case when info = 'xx' and itemnr > '00' then 1 else 0 end) > 0    -- items on the item level 
```

这封装了您的两个条件。也可以简化为：

```
select guid
from addinfo
group by guid
having sum(case when info = 'xx' then 1 else 0 end) > 0 
```

# 3d - 仅在 3-d 绘图中关闭 z 轴

> ID：12391271
> 
> 赞同：12
> 
> 时间：2012-09-12T15:08:54.910
> 
> 标签：3d, matplotlib, axis

我有一些`mpl_toolkits.mplot3d`从不同角度查看的曲面图。当从正上方（elev = 90, azim = 90）观察时，z 轴的文本全部堆积在其自身之上。

`ax.set_axis_off()`隐藏所有轴，但我想隐藏或关闭 z 轴，但仍能看到 x 和 y 轴。

我该怎么做？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-16T13:06:48.970

大多数功能都可以通过 w_zaxis 访问：

在这种情况下，您可以使用：

```
ax.w_zaxis.line.set_lw(0.)
ax.set_zticks([]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-02-08T23:08:17.477

虽然这个问题是很久以前发布的，但我没有找到一个好的解决方案。我自己尝试过，然后发现下面的代码可能有效：

```
ax.set_zticks([]) 
```

# c++ - 如何监视我生成的进程中的活动？

> ID：12391272
> 
> 赞同：3
> 
> 时间：2012-09-12T15:08:54.957
> 
> 标签：c++, .net, hook, setwindowshookex

我的任务是尝试监视从初始程序生成的所有 GUI 程序中的活动，并在它们在一段时间内不活动时杀死它们。这不可能是系统活动，因为即使用户只是使用另一个程序一段时间（不是由初始程序产生的），我们也必须关闭程序。应用程序生成过程是一个 .Net 程序，不会改变。我可以用来从 .Net`SetWindowsHookEx`设置低级挂钩（`WH_KEYBOARD_LL`和`WH_MOUSE_LL`），但不确定如何将消息与我已启动的进程关联（使用`System.Diagnostics.Process`。）我可以从执行挂钩的应用程序中挂钩事件，但它会当我尝试为生成的程序挂钩到特定线程时总是失败。

我最接近的方法是创建一个`SetWindowsHookEx`代表 .Net 程序调用的 C++ dll。使用这种方法，我可以连接到生成的 notepad.exe 的第一个线程，但永远不会调用回调函数。如果我指定线程 id 为 0，则在原始应用程序中有活动时调用回调，因此我知道`SetWindowsHookEx`在这种情况下的工作原理。

我还没有完全理解挂钩，但是从我所读到的内容来看，这将不起作用，因为 dll 回调函数地址对于被挂钩的进程来说毫无意义。这是我遇到的问题吗？如果是这样，有没有办法解决这个问题，或者有人可以建议一种替代方法来确定是否正在积极使用生成的进程？

.Net (C#) 代码：

```
private const int WH_MOUSE = 14;

[DllImport("TestHook.dll", EntryPoint="InitializeHook",  SetLastError=true, CharSet=CharSet.Unicode, ExactSpelling=true, CallingConvention=CallingConvention.StdCall)]
private static extern bool InitializeHook(uint hookType, int threadID);

private void HookEm() {
    //...
    System.Diagnostics.Process testProcess = System.Diagnostics.Process.Start("notepad");
    if(!InitializeHook(WH_MOUSE, testProcess.Threads[0].Id)) // The notepad.exe thread I know hooks
        MessageBox.Show("Boom!");
    //...
} 
```

C++ DLL：

```
HHOOK hookValue;

bool InitializeHook(UINT hookID, int threadID) {
    //... Determining which callback to use
    hookValue = SetWindowsHookEx(hookID, (HOOKPROC)MouseHookCallback, _dllInstance, threadID);
    //...
    return hookValue != NULL
}

static LRESULT CALLBACK MouseHookCallback(int code, WPARAM wparam, LPARAM lparam) {
    //From what I can see, this is never touched when hooking a thread on an outside process
} 
```

目前所有这些都是在 32 位 Windows XP 计算机上完成的。我明白需要一个单独的 64 位 dll 来处理生成的 64 位应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-27T15:18:23.890

对于遇到类似问题的任何人，我们的最终解决方案是使用`GetWindowThreadProcessId(GetForegroundWindow(), ref foregroundWindowProcessId)`并保留我们生成的进程 ID 的映射来检查前台窗口。每次触发此计时器时，我们都会设置一个布尔值来检查调用的函数，`CallNextHookEx`因为它必须高效/快速，否则窗口将解开我们的钩子。然后我们使用上面的布尔值和系统挂钩`SetWindowsHookEx`来确定用户是否在我们的应用程序中处于活动状态。此解决方案不需要 C++ dll。

# c++ - 使用 POCO C++ 通过 TCP 连接发送和接收 OOB 数据

> ID：12391283
> 
> 赞同：1
> 
> 时间：2012-09-12T15:09:25.720
> 
> 标签：c++, tcpserver, poco-libraries

我需要开发一个能够定期接收紧急越界数据的 TCP 服务器。我正在使用 POCO C++ 库来实现这一点。在[StreamSocket](http://www.appinf.com/docs/poco/Poco.Net.StreamSocket.html)类的（稀缺）文档中，我看到这应该是一个非常容易实现的任务：应该通过在使用 receiveBytes() 方法时设置 SO_OOBINLINE 标志来完成，如下所示：

```
n = ss.receiveBytes( buffer, sizeof(buffer), SO_OOBINLINE ); 
```

为了测试这一点，我制作了一个非常简单的 TCP 客户端（也使用 POCO 库），它使用“sendUrgent()”方法发送 OOB 数据（单个字节）：

```
ss1.sendUrgent( 0xFF ); 
```

当我发送 OOB 数据时，什么也没有发生。服务器似乎没有注意到它。

另一方面，当我使用 sendBytes() 方法发送“普通”数据时，如果在 StreamSocket 上设置了 SO_OOBINLINE 标志，我会收到无限量的相同发送数据（尽管没有人在，但它一直在读取相同的数据重新发送）。

我错过了什么？

**编辑**：在@JimR 的建议和阅读后[，](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzab6/rzab6coobd.htm)我尝试过：

```
n = ss.receiveBytes( buffer, sizeof(buffer), MSG_OOB ); 
```

甚至这样：

```
n = ss.receiveBytes( buffer, sizeof(buffer), SO_OOBINLINE | MSG_OOB ); 
```

两者都引发相同的异常：无效参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:21:09.813

我*认为*（已经很久了）你应该改变

`n = ss.receiveBytes( buffer, sizeof(buffer), SO_OOBINLINE );`到

`n = ss.receiveBytes( buffer, sizeof(buffer), MSG_OOB );`

*编辑*：除了上述更改外，您还需要`setsockopt`使用`SO_OOBINLINE`标志和适当的参数进行调用，以便在正常流中而不是在单独的通道中看到 OOB 数据。在您的情况下，如评论中所述，请致电`ss.setOOBInline(true);`.

`SO_OOBINLINE`是与 . 一起使用的套接字选项`setsockopt`。

`MSG_OOB`是`recv`和`send`和公司的旗帜。

# php - WSO2 服务生成 wsdl 为空

> ID：12391286
> 
> 赞同：-1
> 
> 时间：2012-09-12T15:09:46.077
> 
> 标签：php, web-services, wsdl, wso2, wsh

我已经在我的服务器上安装了 wso2，并使用给定的 WSDL 文档创建了一些 web 服务和客户端。但是现在我必须从我自己创建的服务中创建一个 WSDL。但是当我用“？wsdl”调用我的服务网址时，我得到一个空文档。有人知道我做错了什么吗？当我使用 wsdl_generation 目录 rpc_service.php?wsdl 的示例执行此操作时，也会发生同样的情况。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:18:06.603

我不知道是不是你的情况，但是像 Safari 这样的一些浏览器不显示 XML 代码。如果没有显示任何内容，请尝试执行“查看页面源代码”之类的操作告诉我..

# arrays - 单选按钮在面板阵列中是不可见的

> ID：12391287
> 
> 赞同：1
> 
> 时间：2012-09-12T15:09:47.537
> 
> 标签：arrays, winforms, radio-button, panel

在 Form 构造函数中，我生成了一个面板数组（下面代码中的**pnl_**），其中包括单选按钮。当我可视化表单时，只有面板可见，而不是内部的单选按钮。**奇怪的是，当我只生成一个面板（下面代码中的pnl** ）时，一切都很好。

```
public partial class Radiobuttons_on_Panel : Form
{
    private Panel pnl = new Panel();
    private RadioButton rbtn1 = new RadioButton();
    private RadioButton rbtn2 = new RadioButton();

    private Panel[] pnl_ = new Panel[7];
    private RadioButton[] rbtn1_ = new RadioButton[7];
    private RadioButton[] rbtn2_ = new RadioButton[7];

    public Radiobuttons_on_Panel()
    {
        InitializeComponent();

        pnl.Location = new Point(10, 10);
        pnl.Size = new Size(100, 100);
        pnl.BorderStyle = BorderStyle.FixedSingle;

        rbtn1.Location = pnl.Location;
        rbtn1.Text = "AAA";

        rbtn2.Location = new Point(pnl.Location.X, pnl.Location.Y + rbtn1.Height);
        rbtn2.Text = "BBB";

        pnl.Controls.Add(rbtn1);
        pnl.Controls.Add(rbtn2);
        this.Controls.Add(pnl);

        for (int i = 0; i < pnl_.Length; i++)
        {
            pnl_[i] = new Panel();
            pnl_[i].BorderStyle = BorderStyle.FixedSingle;
            pnl_[i].Size = new Size(100, 100);
            pnl_[i].Location = new Point(10 + i * 110, 200);

            rbtn1_[i] = new RadioButton();
            rbtn1_[i].Location = pnl_[i].Location;
            rbtn1_[i].Text = "AAA";

            rbtn2_[i] = new RadioButton();
            rbtn2_[i].Location = new Point(pnl_[i].Location.X, pnl_[i].Location.Y + rbtn1_[i].Height);
            rbtn2_[i].Text = "BBB";

            pnl_[i].Controls.Add(rbtn1_[i]);
            pnl_[i].Controls.Add(rbtn2_[i]);

            this.Controls.Add(pnl_[i]);
        }
    }
} 
```

问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:34:41.090

您的问题是您对位置的计算是错误的。单选按钮的位置是相对于它们的容器——在本例中是面板。如果您只是将您的位置设置为

```
rbtn1_[i] = new RadioButton();
rbtn1_[i].Location = new Point(10, 10);
rbtn1_[i].Text = "AAA";

rbtn2_[i] = new RadioButton();
rbtn2_[i].Location = new Point(rbtn1_[i].Location.X, rbtn1_[i].Location.Y + rbtn1_[i].Height);
rbtn2_[i].Text = "BBB"; 
```

按钮将按照您想要的方式布置。

事情在您的第一个中解决，因为您的单选按钮位置值小到足以在面板中可见。对于其他人，好吧，他们超出了父面板的范围。

总而言之，`Location`属性总是相对于容器，无论是 a`Panel`还是 a `Form`-`Location`面板的值是相对于的，`Form`但`Location`单选按钮的值是相对于它们所在的任何面板。

MSDN 参考：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.control.location.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.location.aspx)

# java - 如何将组件添加到 JFrame 子类的子类中

> ID：12391294
> 
> 赞同：1
> 
> 时间：2012-09-12T15:10:13.870
> 
> 标签：java, swing, jframe, subclass, jcomponent

我有一个 JFrame A 的子类。我有另一个类 B，它是 A 的子类。我想像 JButtons 一样向框架 B 添加新组件。我的代码如下：

```
public B() extends A {
    //Calling super class constructor
    super();

    //Creating and adding a button 
    JButton btn = new JButton();
    this.add(btn);

    //other codes
} 
```

当我显示框架时，没有添加按钮，只显示超类框架及其组件。如何在子类 B 的框架中添加这些按钮？

更新：这是我的代码的精简版本。我在超类**ListObjects**中使用了 BorderLayout 。

```
package assignment2;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ListAndModifyCustomer extends ListObjects {

public ListAndModifyCustomer() {
    //Calling super class constructor
    super("Customers");

    //Adding listener to the ok button
    super.selectBtn.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {

            //codes to create another JFrame

            dispose();  //Closing the frame
        }
    });

    //Adding button to the panel
    super.panel.add(new JButton("NO"));

    JPanel jp = new JPanel();
    jp.add(super.selectBtn);

    super.add(jp, BorderLayout.SOUTH);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T06:13:19.660

最可能的原因是`BorderLayout`. A`BorderLayout`在其每个位置中只能包含一个组件。如果您不指定位置，`CENTER`则将使用该位置。

因此，如果您的`ListObjects`班级和`ListAndModifyCustomer`班级都在`add`没有指定位置的情况下进行调用，则只有第二个组件可见（并添加）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:19:29.627

做`this.getContentPane().add(btn)`。
我无法发表更多评论，因为没有关于使用哪些组件、布局等的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T05:10:40.280

我发现如果我们在子类中创建一个面板并将所有项目添加到该面板并将该面板添加到超类的框架中，那么组件就会变得可见。

# jquery - 使用 Spring 和 jQuery 将对象数组从模型传递到 JSP

> ID：12391297
> 
> 赞同：0
> 
> 时间：2012-09-12T15:10:18.340
> 
> 标签：jquery, jsp, spring-mvc

我正面临 JSP 和 Spring 的问题，我试图将对象数组从模型传递到视图 (JSP)。

这是我在控制器部分的代码：

```
@RequestMapping(value = "/clientes.html")
public ModelAndView handleRequest(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException  {

    Map<String, Object> myModel = new HashMap<String, Object>();
    myModel.put("arrClients", this.clientManager.getClients());
    myModel.put("clientNames", this.clientManager.getNames());
    return new ModelAndView("clients", "model", myModel);
} 
```

在 JSP 文件中，我可以使用 jstl 访问“arrClients”，例如：

```
 <c:forEach items="${model.arrClients}" var="client">
        <div id="newClient">
            <p>
                <c:out value="${client.name}" />
                <i><c:out value="${client.surname}" /></i>
            </p>
        </div>
    </c:forEach> 
```

这段代码正在工作，但我想访问 , 中的这个数组，将它存储在一个 jQuery var 中。

如果我尝试访问另一个数组（字符串），它就可以工作，并且我在控制台中有消息。

```
$(function() {
    var clientNames = ${model.clientsNames};
            console.info('it Works!!');

} 
```

但是当我尝试访问另一个数组时

```
$(function() {
    var clients = ${model.arrClients};
            console.info('it Works!!');
} 
```

我无法访问这个数组，我什至无法获得控制台消息。有谁知道如何使用 jQuery 访问 JSP 文件中的对象数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T00:14:10.523

您需要记住，JSP 输出是在 JS 中解释的，就像您自己键入一样。因此，您的线路：

```
var clients = ${model.arrClients}; 
```

如果内容`${model.arrClients}`是可以的，`["foo", "bar"]`但不会是这样的`foo, bar`。使用 Javascript 调试工具（Firebug、Chrome 控制台等）查看控制台错误日志，并查看页面中该行的实际 HTML 输出。

第二个`console.info()`没有出现的事实表明您的 JSTL 表达式导致了 JS 语法错误。

编辑：正如 gigadot 指出的那样，您不能使用 List 或数组之类的 Java 对象并在 JSP 中声明它——您只会得到`toString()`表示，这通常不是您想要的。您需要对`<c:forEach>`块使用类似的代码并将每个元素添加到您的 JS 数组中，一次一个（例如使用`.push()`）。

# c# - 64 位和 32 位安装程序（高级安装程序）上的 Visual Studio Crystal Reports

> ID：12391302
> 
> 赞同：0
> 
> 时间：2012-09-12T15:10:38.500
> 
> 标签：c#, crystal-reports, installation, report, multiplatform

任何想法如何在单个 Visual Studio 安装程序中包含 cr_runtime_X64 和 cr_runtime_X86？

我可以合并两个平台的项目设置，但是当涉及到 CR 作为先决条件时，它只允许我一条路径。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T19:30:03.907

在[高级安装程序](http://www.advancedinstaller.com)中，我发现您所要做的就是配置 32 位或 64 位工作站的第一个先决条件，使用“设置文件”选项卡中的启动条件设置以及相应 Runtime.msi 的路径，然后添加一个新的其他工作站的其他 msi 的路径的先决条件。

# android - 方向从双窗格更改为单窗格

> ID：12391304
> 
> 赞同：2
> 
> 时间：2012-09-12T15:10:45.783
> 
> 标签：android, android-fragments, android-orientation

横向和纵向的不同布局之间的方向更改似乎很容易，但是我找不到适合我当前情况的解决方案。

我想在横向模式下使用带有两个片段的双窗格布局

res\layout-land\dashboard_activity.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment class="xxx.DashboardFragment"
            android:id="@+id/master_frag"
            android:layout_width="@dimen/timeline_size"
            android:layout_height="match_parent"/>

    <fragment class="xxx.TaskInstanceFragment"
            android:id="@+id/details_frag"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
</LinearLayout> 
```

以及纵向模式下的单窗格布局

res\layout\dashboard_activity.xml

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment class="xxx.DashboardFragment"
        android:id="@+id/master_frag"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        />

</FrameLayout> 
```

我想指出 DashboardFragment 由 ViewPager 组成。不知道是否重要。

现在，当我将方向从横向（双）更改为纵向（单）时，应用程序崩溃，因为它想要更新`details_frag`. 当我以纵向开始活动时，它可以工作，只有从横向切换到纵向才会出现问题。

在活动中有以下代码：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.dashboard_activity);

    Fragment frag = getSupportFragmentManager().findFragmentById(R.id.details_frag);
    mDualFragments = frag != null;

    /* .. */
} 
```

现在，`FragmentManager`当我切换到纵向模式时，仍然会找到详细信息片段，因此`mDualFragments`仍然为真但应该为假，这导致稍后调用详细信息片段中的方法。

那么，这是为什么呢？:)

问候， Konsumierer

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:18:29.367

因为`findFragmentById`不仅返回当前布局中的片段，还返回之前显示的片段。试试这个：

```
mDualFragments = frag != null && frag.isInLayout(); 
```

# c# - 是否可以在 CssClass 属性中执行条件语句？

> ID：12391305
> 
> 赞同：0
> 
> 时间：2012-09-12T15:10:49.087
> 
> 标签：c#, asp.net

我正在使用中继器控件。我的项目属性之一是布尔值。我知道我可以在 Text 属性中做一个条件语句，例如：

```
Text='<%# Item.Boolean ? "Text 1" : "Text 2" %> 
```

但是，如果我想要相同的文本但不同的 CSS 样式取决于布尔值怎么办？

像下面这样的代码可能吗？

```
CssClass=<%# Item.Boolean ? "CssClass1" : "CssClass2" %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-17T15:37:52.677

你不能那样做。不是 runat 服务器类型的标签，因此它无法尝试在那里执行逻辑。相反，您需要在 Page_PreRenderComplete 中设置 gridview 的属性。

使用类似下面的东西来做到这一点：

```
protected void Page_PreRenderComplete(object sender, EventArgs e)
{
    this.FormatGridviewRows();
}

private void FormatGridviewRows()
{
    foreach (GridViewRow row in this.GridView1.Rows)
    {
        // Don't attempt changes on header / select / etc. Only Datarow
        if (row.RowType != DataControlRowType.DataRow) continue;

        // At least make sure everything has the default class
        row.CssClass = "gridViewRow";

        // Don't affect the first row
        if (row.DataItemIndex <= 0) continue; 

        if (row.RowState == DataControlRowState.Normal || row.RowState == (DataControlRowState.Normal ^ DataControlRowState.Edit))
        {
            row.CssClass = !this.cbForceOverride.Checked 
                ? "gridViewRow" 
                : "gridViewRow gridViewRowDisabled";
        }

        if (row.RowState == DataControlRowState.Alternate || row.RowState == (DataControlRowState.Alternate ^ DataControlRowState.Edit))
        {
            row.CssClass = !this.cbForceOverride.Checked
                ? "gridViewAltRow"
                : "gridViewAltRow gridViewAltRowDisabled";
        }
    }

} 
```

然后在您的样式表中：

```
.gridViewRow {
    background-color: #f2f2f2; 
}

.gridViewAltRow {
    background-color: #ffffff;
}

.gridViewRow, .gridViewAltRow {
    color: #000000;
}

.gridViewRowDisabled, .gridViewAltRowDisabled {
    color: #DDDDDD;
} 
```

# user-interface - OSX 上的 Haskell GUI 库

> ID：12391307
> 
> 赞同：9
> 
> 时间：2012-09-12T15:10:56.317
> 
> 标签：user-interface, haskell

我想用 Haskell 在 OSX 上创建一个 GUI 应用程序。它主要应该是关于在画布上绘图。我尝试了以下选项，但没有一个有效：

*   WX。由于依赖于过时的 quicktime 版本，它不能很好地工作。我不能用它编译，也不能在 ghci 中使用它。
*   Gtk2hs。它涉及非常复杂的安装过程，对于我来说自制软件失败了（我在 haskell.org wiki 上尝试了这个序列，但它对我不起作用可能是因为 OSX10.8）。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:16:57.037

如果您只是在画布上绘制 2D 形状，您可以尝试[光泽](http://hackage.haskell.org/package/gloss)。

# scala - 推迟val解析的优雅方法

> ID：12391310
> 
> 赞同：3
> 
> 时间：2012-09-12T15:11:06.317
> 
> 标签：scala, lazy-evaluation

我有一个`val`：

```
val something = System.nanoTime 
```

然后经过一系列方法调用：

```
foo(something) {
  bar(something, 2) { etc }
} 
```

我想将`val`解决方案推迟到最后一个实际使用它的方法。我知道 scala 的`lazy`修饰符，但似乎`something`作为参数传递会自动解析它的值，无论变量是否在该方法中被使用。

到目前为止，我的（有点丑陋的）解决方案是：

```
val something = () => System.nanoTime 
```

虽然这可行，但它涉及更改所有方法签名，在这种情况下从`Long`到`() => Long`。我想可能有一种更优雅的方法来解决它，你们怎么看？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:23:42.823

在不更改签名的情况下无法执行此操作，但是您应该`x: => Long`使用`x: () => Long`. 第一个是所谓的`by name parameter`。**每次**调用时都会评估按名称参数。所以总的来说它看起来像：

```
def foo(x: => Long) = {
  x + 12 // x will be evaluated here
}

lazy val x = 12L
foo(x) 
```

# web-services - 使用用户定义的描述列出 SSRS 订阅

> ID：12391313
> 
> 赞同：1
> 
> 时间：2012-09-12T15:11:21.137
> 
> 标签：web-services, reporting-services

我们有越来越多的非数据驱动的 SSRS 2008 订阅，而 SSRS 中的默认列表没有提供任何方式来指示每个订阅的全部内容。是的，有描述，但它是自动生成的，不是很有帮助。例如，我们需要它说“Company ABC Quarterly to Managers”。

我查看了使用 ReportingService2010 Web 服务，并设法不仅阅读了每个报告的描述，而且还对其进行了修改。但是，一旦有人从 SSRS 编辑订阅（有时需要这样做），描述就会恢复为自动生成的描述。

虽然我从未使用过数据驱动的报告，但我想知道这些是否会提供我需要的功能。鉴于我并不真正需要订阅数据驱动，因此设置起来似乎需要做很多工作。

我在这里错过了一些简单的东西吗？这个简单的功能是升级到更新的 SSRS 版本所附带的吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:26:32.707

> 我在这里错过了一些简单的东西吗？这个简单的功能是升级到更新的 SSRS 版本所附带的吗？

SSRS 2012 中的标准订阅似乎[也不允许输入描述](http://msdn.microsoft.com/en-us/library/ms156307)（虽然我找不到 UI 的屏幕截图）。

> 虽然我从未使用过数据驱动的报告，但我想知道这些是否会提供我需要的功能。鉴于我并不真正需要订阅数据驱动，因此设置起来似乎需要做很多工作。

如果标准订阅满足业务需求，我会反对数据驱动订阅的需求。这值得你花时间和精力吗？如果是，那么明显的优势是订阅描述在 UI 中是可编辑的，并且在修改订阅时似乎不会被覆盖。

**如果您仍然对使用标准订阅感兴趣...**

“破解” SSRS 以使订阅不会覆盖描述（无论如何在 UI 中不可编辑）的一种方法是修改存储过程 ReportServer.dbo.UpdateSubscription。

*免责声明：使用以下建议需您自担风险。**这涉及修改 Reporting Services 所依赖的标准存储过程。***

您可以更改更新语句，以便仅在订阅不是数据驱动订阅时才修改描述值（我们不想破坏可在 UI*中编辑的数据驱动订阅描述）。*在存储过程中，您可以通过查看@DataSettings 的值来区分数据驱动订阅和标准订阅。如果是`IS NULL`，那么它是一个普通的旧订阅。如果是`IS NOT NULL`，那么我们正在研究数据驱动的订阅。

更新语句中的以下行：

```
[Description] = @Description, 
```

可以改为：

```
[Description] = CASE WHEN @DataSettings IS NULL THEN [Description]
                        ELSE @Description
                    END, 
```

这将在 SSRS 中修改所有标准订阅描述时保持相同，但允许修改数据驱动的订阅描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-31T19:41:27.063

这是 dev_etter 对 hack 的扩展。我能够使用存储过程@parameter 输入和一个新的报表参数（pReportParameterName）来创建报表独有的动态、用户可控的描述。

*   向报表添加新的隐藏文本参数 (pReportParameterName)
*   在 UPDATE 语句上方的存储过程 UpdateSubscription 中添加下面的代码块 1。
*   将 UPDATE 语句的“Description =”行更改为类似于下面的代码块 2。

通过该设置，创建或编辑定时订阅并将所需的文本输入到描述参数中。保存后，您应该会在订阅屏幕的描述列中看到输入的描述。

```
/*** Code Block 1 ***/
DECLARE @Param as XML = CAST(@Parameters as XML)
DECLARE @MY_Description as varchar(512)

SELECT  @MY_Description = e.f.value('(.)[1]', 'varchar (100)')
FROM (select 1 id, @Param xCol) tx
    CROSS APPLY tx.xCol.nodes('./ParameterValues/ParameterValue') AS a(b)
    CROSS APPLY a.b.nodes('./Name') AS c(d)
    CROSS APPLY a.b.nodes('./Value') AS e(f)
WHERE c.d.value('(.)[1]', 'varchar (100)') LIKE 'pReportParameterName'

   /*** Code Block 2 ***/
    [Description] = --@Description
                    CASE 
                        WHEN @DataSettings IS NULL 
                             AND @MY_Description IS NOT NULL 
                             THEN @MY_Description
                        ELSE @Description
                    END, 
```

干杯，Sj

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-06T18:38:03.173

根据 Mat's Mug，我注意到我最终使用的解决方案：

由于我们所有的订阅都涉及通过电子邮件发送报告，因此我们可以将电子邮件主题字段重新用作描述。这样就可以生成所有订阅的列表，并为每个订阅显示任意描述。

# c++ - 使用联合数组中的数据初始化 std::vector

> ID：12391316
> 
> 赞同：0
> 
> 时间：2012-09-12T15:11:29.387
> 
> 标签：c++

我如何从结构数组初始化 std::vector，其中结构包含不同类型的联合。换句话说，数组用于存储特定类型的多个值，可以是 int、char* 等。

到目前为止，这是我的解决方案，但我正在寻找更好的方法：

`vector<int>`如果它存储`int`s，则convert 函数返回 a ，如果存储 s，`vector<std::string>`则返回 a `char*`。

下面的 Value 类型是一个包含名为 value 的联合的结构。下面的 Container 类指向此类值的缓冲区。

```
// union member getter
class Getter
{
public:

    void operator()(int8_t& i, const Value& value)
    {
        i = value.value.i;
    }

    void operator()(std::string& s, const Value& value)
    {
       s = std::string(value.value.s);
    }

    ...
};

template<class T>
std::vector<T> convert(Container* container)
{
    std::vector<T> c;
    c.reserve(container->nrOfValues);
    Getter g;
    for(int i=0;i<container->nrOfValues;i++)
    {
        T value;
        g(value, container->values[i]);
        c.push_back(value);
    }
    return c;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T10:56:24.713

如果你喜欢一些模板魔法，你可以用稍微不同的方式来做：

```
// Source union to get data from
union U
{
  int i;
  char* s;
  double d;
};

// Conversion type template function (declared only)
template <class T> T convert(const U& i_u);

// Macro for template specializations definition
#define FIELD_CONV(SrcType, DestField)\
template <> SrcType convert(const U& i_u)\
{ auto p = &DestField; return i_u.*p; }

// Defining conversions: source type -> union field to get data from
FIELD_CONV(int, U::i)
FIELD_CONV(std::string, U::s)
FIELD_CONV(double, U::d)

// Get rid of macro that not needed any more - just for macro haters ;-)
#undef FIELD_CONV

// Usage
template<class T> std::vector<T> convert(Container* container)
{
   std::vector<T> c;
   c.reserve(container->nrOfValues);
   for(int i = 0; i < container->nrOfValues; ++i)
     c.push_back(convert<T>(container->values[i])); 
   return c;
} 
```

这种方法的优点——它简短、简单且易于扩展。当您向联合添加新字段时，您只需编写另一个`FIELD_CONV()`定义。

编译示例在[这里](http://liveworkspace.org/code/85d7df49f5ae72d1bebcee544426707c)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T17:28:23.690

您的问题是联合为每个值提供不同的名称，这导致需要将名称转换为类型的函数，例如 Getter::operator() 返回类型并获取联合的命名成员。

你对此无能为力。您可以在每个项目上保存变量声明和复制/字符串构造函数，仅此而已。

如果您无法修改原始结构，则可以使用一组长度默认值（必须传入）初始化向量，然后使用 getter 进行迭代：

```
vector<T> v(length, defaultValue);
typename vector<T>::iterator iter = vec.begin();
for(int index = 0; *iter != vec.end() && index < length; ++iter, ++index) {
  converter(*iter, array[index]);
} 
```

请注意，这在迭代索引和迭代器以及验证两者在发生事故时仍然有效时开始变得很麻烦......

如果您可以修改原始结构：

```
class Ugly { // or struct, it doesn't matter
public:
  union {
    char* s;
    int i;
  } value;

  Ugly(char* s) {
    value.s = s;
  }

  Ugly (const int& i) {
    value.i = i;
  }

  operator std::string() const {
    return std::string(value.s);
  }

  operator int() const {
    return value.i;
  }
}; 
```

然后你的 for 循环变成：

```
for(int i=0;i<container->nrOfValues;i++)
{
    c.push_back(container->values[i]);
} 
```

注意：您可以创建向量并将其作为参数传递给复制函数，因为它涉及在返回期间复制数据。

# c# - Facebook 喜欢的 linq-xml 查询

> ID：12391317
> 
> 赞同：0
> 
> 时间：2012-09-12T15:11:31.443
> 
> 标签：c#, linq, facebook-graph-api, linq-to-xml

我正在尝试获取链接的 Facebook 喜欢总数。将链接粘贴到浏览器中以查看 xml 响应

这是我正在做的事情：

```
var link = "https://api.facebook.com/method/fql.query?query=select%20%20like_count,%20total_count,%20share_count,%20click_count%20from%20link_stat%20where%20url=%22http://micgadget.com/29723/the-undercover-report-on-how-the-new-iphone-5-is-made-inside-foxconn-factory/%22";
//var xml = MakeRequest(link);
XDocument xdoc = XDocument.Load(link);

var likes = (from e in xdoc.Descendants("total_count")
             select e).SingleOrDefault().Value;
return int.Parse(likes); 
```

它在 linq 查询中抛出一个对象引用查询。如何从响应中获取 toal_count？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:54:05.527

首先，total_Count 没有后代，因此如果您想要该元素的值，则无法查询。其次，生成的 XML 元素包括名称空间。在搜索该元素的 .value 时，您需要包括这些。尝试这样的事情

```
var link = "https://api.facebook.com/method/fql.query?query=select%20%20like_count,%20total_count,%20share_count,%20click_count%20from%20link_stat%20where%20url=%22http://micgadget.com/29723/the-undercover-report-on-how-the-new-iphone-5-is-made-inside-foxconn-factory/%22";
XDocument xdoc = XDocument.Load(link);
XNamespace ns = xdoc.Root.Attribute("xmlns").Value;

var likes = (from e in xdoc.Descendants() where e.Name == ns + "total_count"
             select e.Value).SingleOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:31:30.470

尝试，

```
var link = "https://api.facebook.com/method/fql.query?query=select%20%20like_count,%20total_count,%20share_count,%20click_count%20from%20link_stat%20where%20url=%22http://micgadget.com/29723/the-undercover-report-on-how-the-new-iphone-5-is-made-inside-foxconn-factory/%22";
//var xml = MakeRequest(link);
XDocument xdoc = XDocument.Load(link);

var query =  xdoc.Descendants().SingleOrDefault(o => o.Name.LocalName == "total_count");

if (!(query == null))
{
    int count = int.Parse(query.Value);
} 
```

# android - 在移动浏览器中单击 URL 时启动 Android 应用程序

> ID：12391319
> 
> 赞同：0
> 
> 时间：2012-09-12T15:11:34.883
> 
> 标签：android

RE：[从 android 浏览器启动自定义 android 应用程序](https://stackoverflow.com/questions/2958701/launch-custom-android-application-from-android-browser/12382173#12382173)

我已经尝试了上述帖子中描述的方法，如果在 G+、Twitter 等应用程序中单击 URL，它可以完美运行。但是，当我使用移动浏览器加载包含 URL 的网页时（ android 和 chrome 浏览器），点击 URL 不会启动应用程序。

有没有其他人看到过这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:21:44.203

如果您已经使用可以处理这些链接的浏览器，那么大多数时候（曾经？）Android 不会寻找另一个应用程序来处理这些链接。我已经看到了这种行为，我认为它无法改变。

唯一的方法是使用您自己的架构，正如您提到的链接中已经详述的那样：

```
<intent-filter>
    <data android:scheme="my.special.scheme" />
    <action android:name="android.intent.action.VIEW" />
</intent-filter>

<a href="my.special.scheme://other/parameters/here"> 
```

但是，此链接无法在没有您的应用的设备上使用。你可以接受吗？

# oracle - 可变数组 oracle ORA-02330

> ID：12391325
> 
> 赞同：1
> 
> 时间：2012-09-12T15:11:53.837
> 
> 标签：oracle, object, relational-database, varray

我正在开发一个简单的应用程序，用于了解 Oracle 和数据库对象关系与对象和可变数组的关系......我做了下一个代码：

这是我的可变数组

```
SQL> create or replace type software_va as varray(3) of varchar2(30);
2 / 
```

这是我创建的一个对象：

```
SQL> create or replace type cargo1 as object(
 2  id_cargo number,
 3  nom_cargo varchar2(20),
 4  suc ref sucursal);
 5  / 
```

当我尝试以这种方式创建表时：

```
SQL> create table cargos of cargo1(
2  primary key(id_cargo),
3  manejosoft software_va); 
```

我收到了这个错误：

```
ERROR en line 3:
ORA-02330: datatype specification not allowed 
```

我不明白为什么会出现此错误，也不知道我是否有问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:29:14.713

`object`如果您想要一个同时包含和列的关系表`varray`，这应该可以工作，并且仍然具有基于对象 ID 的主键：

```
create table cargos
(
    cargo cargo1,
    manejosoft software_va,
    constraint cargos_pk primary key (cargo.id_cargo)
);

Table created.

insert into cargos values (cargo1(1, 'test'), software_va('a', 'b', 'c'));

1 row created.

insert into cargos values (cargo1(1, 'dup test'), software_va('d', 'e', 'f'));

insert into cargos values (cargo1(1, 'dup test'), software_va('d', 'e', 'f'))
*
ERROR at line 1:
ORA-00001: unique constraint (SCOTT.CARGOS_PK) violated

select * from cargos;

CARGO(ID_CARGO, NOM_CARGO)
--------------------------------------------------------------------------------
MANEJOSOFT
--------------------------------------------------------------------------------
CARGO1(1, 'test')
SOFTWARE_VA('a', 'b', 'c')

select c.cargo.nom_cargo
from cargos c
where c.cargo.id_cargo = 1;

CARGO.NOM_CARGO
--------------------
test 
```

如果您想要一个[对象表](http://docs.oracle.com/cd/E11882_01/server.112/e25789/tablecls.htm#sthref177)，那么您不能拥有`varray`评论中提到的列：

```
create table cargos of cargo1
(
    primary key(id_cargo)
); 
```

# android - 致力于在按下小部件时启动 GPS

> ID：12391326
> 
> 赞同：0
> 
> 时间：2012-09-12T15:11:54.303
> 
> 标签：android, gps

在遵循关于 SO 的教程后，我找到了一种在有人进入我的应用程序后启用 GPS 的方法。问题是我设置了代码来更改纬度和经度的显示以随着用户改变位置而改变。我知道它有效，因为我的第一个 GPS 运行平稳。现在我正试图在我现有的代码上实现它。

除了我运行代码时，GPS 图标会像它一样闪烁，但是当我进入应用程序时，没有任何变化。

这是我使用的代码：

```
 Intent intent = new Intent("android.location.GPS_ENABLED_CHANGE");
    intent.putExtra("enabled", true);
    sendBroadcast(intent); 
```

有关使其充分发挥作用的任何提示，请务必告知！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:21:34.540

解决您的问题的更好方法是要求用户自己启用 GPS。在未经用户许可的情况下进行操作可能非常有害，想象一下设备的电池几乎没电了，启用 GPS 会立即耗尽电池。要让用户启​​用 GPS，您可以触发一个`AlertDialog`，创建一个`Intent`以`ACTION_LOCATION_SOURCE_SETTINGS`打开设备的设置菜单，用户将能够在其中启用 GPS。希望这可以帮助。

# imagemagick - 如何在 ImageMagick 中连接角销和合成？

> ID：12391329
> 
> 赞同：0
> 
> 时间：2012-09-12T15:11:54.693
> 
> 标签：imagemagick

在 ImageMagick 中，我可以通过三个独立的步骤创建合成。我将第一张图片固定在角落，然后是第二张图片。然后我合成并将这两个图像放在背景图像的顶部：

```
convert .\source1.png -matte -virtual-pixel transparent -distort Perspective '0,0,27,211 0,278,197,266 500,0,176,19 500,278,323,48' source1a.png
convert .\source2.png -matte -virtual-pixel transparent -distort Perspective '0,0,2,72 0,278,86,181 500,0,215,2 500,278,311,85' source2a.png
convert .\card.png -page +253+41 .\source2a.png -page +0+98 .\source1a.png -layers flatten fred4.png 
```

由于某种原因，Windows 不会像我期望的那样响应将这些命令放在括号中：

```
convert .\card.png -page +253+41 (.\source1.png -matte -virtual-pixel transparent -distort Perspective '0,0,27,211 0,278,197,266 500,0,176,19 500,278,323,48') -page +0+98 (.\source2.png -matte -virtual-pixel transparent -distort Perspective '0,0,2,72 0,278,86,181 500,0,215,2 500,278,311,85') -layers flatten fred4.png 
```

出于某种原因，当我执行上述命令时，它会为每个图像打开查看器，并且输出是错误的。

有没有办法做到这一点而不必写出两个中间图像？理想情况下，我可以将图像放在背景上，然后在背景图像的坐标空间中做角销。任何想法都会非常有帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:50:34.557

当您使用括号对命令进行分组时，您**需要**在和字符的**每一侧**（至少）留下一个空白。这是有据可查的，并且所有示例都显示了它！（在 Unix 上，甚至可以将它们转义并使用和分组 ImageMagick 命令）。`(``)``\(``\)`

所以这应该适用于 Windows：

```
convert                   ^
  card.png                ^
 -page +253+41            ^
    (                     ^
      source1.png         ^
     -matte               ^
     -virtual-pixel transparent ^
     -distort Perspective '0,0,27,211 0,278,197,266 500,0,176,19 500,278,323,48' ^
    )                     ^
 -page +0+98              ^
    (                     ^
      source2.png         ^
     -matte               ^
     -virtual-pixel transparent ^
     -distort Perspective '0,0,2,72  0,278,86,181  500,0,215,2  500,278,311,85'  ^
    )                     ^
 -layers flatten          ^
  fred4.png 
```

# mongodb - MongoDB upsert 与 $push 和 $not

> ID：12391334
> 
> 赞同：2
> 
> 时间：2012-09-12T15:12:18.513
> 
> 标签：mongodb

我最近更新到 Mongodb 2.2.0，发现下面的查询现在不再有效。

数据库为空，我运行以下命令：

```
db.Sessions.update({_id:"test",sessions:{$not:{$elemMatch:{type:"Web"}}}},{$push:{sessions:{type:"Web",dateAdded:new Date}}},true) 
```

返回错误：

```
Cannot apply $push/$pushAll modifier to non-array 
```

在更新之前，将创建以下文档：

```
{ "_id" : "test", "sessions" : [ { "type" : "Web", "dateAdded" : ISODate("2012-09-12T15:11:11.942Z") } ] } 
```

有任何想法吗？

**编辑：** 我忘了提，在这个版本中添加了 $not ，因为以下工作正常，所以数组/字段不存在不是问题。

```
db.Sessions.update({_id:"test"},{$push:{sessions:{type:"Web",dateAdded:new Date}}},true) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:14:53.517

的行为`$elemMatch`在 2.2 中略有改变，这就是为什么它不再与 结合使用的原因`$not`，它只是一个用于否定其他运算符的[元运算](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-Metaoperator%3a%7B%7B%24not%7D%7D)符，实际上不能用于搜索字段。

相反，您可以使用[`$nin`](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24nin)(not in) 检查会话数组中的值。

例如，

```
> db.Sessions.update( { _id:"test", sessions: { "$nin": {type: "Web"} } }, {"$push":{sessions:{type:"Web",dateAdded:new Date}}},true);
> db.Sessions.findOne();
{
    "_id" : "test",
    "sessions" : [
        {
            "type" : "Web",
            "dateAdded" : ISODate("2012-09-12T16:03:18.271Z")
        }
    ]
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T23:21:55.307

我提交了一个错误“[不应使用带有 $not 运算符的查询字段来填充 upsert 文档](https://jira.mongodb.org/browse/SERVER-8172)”，该错误将被反向移植到 2.2.x 中以修复这种情况。

# javascript - 如何使用 JavaScript 获取当前 URL？

> ID：12391337
> 
> 赞同：6
> 
> 时间：2012-09-12T15:12:30.870
> 
> 标签：javascript, url

我想获取我当前的 URL 地址，将其保存到变量中，然后将其传递给 HTML 元素：

```
 var url = document.URL;
 document.getElementById("url").innerHTML = url; 
```

我尝试过使用`document.URL`，`window.location`但`window.location.href`它们都不适合我。它什么也不显示。

我的 HTML 是：

```
<p id="url"></p> 
```

提前致谢！

这是我的源代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>

  <style type="text/css">

    input:hover
    {
        background: black;
        color: white;   
        border: 0;      
    }

  </style>

  <script>   

  var url = location.href;
  document.getElementById("url").innerHTML = url;

  function first()
  {
    var string = "It works!";
    write(string);
  }

  function write(szoveg)
  {
      alert(szoveg);
  }

  function submit()
  {
      var result;
      result = confirm("Would you like to confirm your change?");
      if(result==true) 
          window.location="okay.html";
      else if(result==false)
          alert("You have clicked the \"cancel\" button.");

  }  

  </script>

</head>

<body>

  <input type="button" onclick="first()" value="Try Me" />

  <p onmouseover="submit()">Hover over this text.</p>

  <p id="url">error</p>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:14:13.237

现在您已经公开了整个代码，我们可以看到您`document.getElementById("url")`在加载 DOM 之前运行得太早了。将您的脚本移动到正文标记的末尾（请参阅此答案末尾的固定代码）。

在成功加载这些 DOM 元素之前，无法运行引用 DOM 元素的脚本。有三种方法可以确保这一点。

1.  最简单的方法是将脚本放在`</body>`标签之前。由于`<body>`标签中的内容是按顺序加载的，因此可以确保在脚本运行之前已经加载了所有页面，因此脚本可以引用它。

2.  您可以编写脚本以等待页面中的所有内容完成加载（包括图像），方法是仅在`window.onload`事件触发时运行您的代码。这等待的时间比必要的要长，因为它还等待所有图像完成加载，但它安全且容易。

3.  您可以编写脚本以等待仅加载 DOM。由于旧浏览器需要不同的机制，因此跨浏览器执行此操作有点棘手。在较新的浏览器中，这个时间是用`DOMContentLoaded`文档上的一个事件来表示的。

`window.location.href`包含当前页面 URL。这始终有效，并且是获取当前页面 URL 的正确方法。

工作演示：http: [//jsfiddle.net/jfriend00/yGrxU/](http://jsfiddle.net/jfriend00/yGrxU/)

如果这在您的页面中不起作用，那么您的代码中还有其他问题。这可能是因为您在加载 DOM 之前过早地运行代码，因此`document.getElementById()`无法正常工作。您可以通过将 javascript 代码移动到 body 标记的末尾来解决此问题。

另一种可能性是您的页面中有一个脚本错误，导致您的 javscript 停止执行。您应该检查浏览器错误控制台或调试控制台以查看是否报告了任何脚本错误。

* * *

现在您已经发布了整个代码，我们可以看到您需要将脚本移动到`</body>`标签之前，如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>

  <style type="text/css">

    input:hover
    {
        background: black;
        color: white;   
        border: 0;      
    }

  </style>

</head>

<body>

  <input type="button" onclick="first()" value="Try Me" />

  <p onmouseover="submit()">Hover over this text.</p>

  <p id="url">error</p>

  <script>   

  var url = location.href;
  document.getElementById("url").innerHTML = url;

  function first()
  {
    var string = "It works!";
    write(string);
  }

  function write(szoveg)
  {
      alert(szoveg);
  }

  function submit()
  {
      var result;
      result = confirm("Would you like to confirm your change?");
      if(result==true) 
          window.location="okay.html";
      else if(result==false)
          alert("You have clicked the \"cancel\" button.");

  }  

  </script>
</body>

</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:14:39.603

试试这个，你可以将你的页面的url放入一个变量中

```
window.location.href 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:24:54.183

你的问题是这两行：

```
var url = location.href;
document.getElementById("url").innerHTML = url; 
```

在您的`<p>`标签存在之前执行。`p`从您的脚本中删除它们并在您的标签后添加一个新脚本：

```
<p id="url"></p>
<script>
    var url = location.href;
    document.getElementById("url").innerHTML = url;
</script> 
```

看到这个[JSFiddle](http://jsfiddle.net/hu4Gq/1/)

使用包含 url 的文本节点替换自身的脚本可能会更好。然后，如果您不在其他任何地方使用该 id，则无需提供`p`an ：`id`

```
<p>
    <script>
      (function(){
        var scripts = document.getElementsByTagName('script');
        var this_script = scripts[scripts.length - 1];
        this_script.parentNode.replaceChild(
          document.createTextNode(location.href),
          this_script
        );
      })();
    </script>
</p> 
```

看到这个[JSFiddle](http://jsfiddle.net/n38w8/)

# python - 组合变音符号不能用 unicodedata.normalize (PYTHON) 规范化

> ID：12391348
> 
> 赞同：4
> 
> 时间：2012-09-12T15:13:11.320
> 
> 标签：python, unicode, replace, diacritics

我知道`unicodedata.normalize`将变音符号转换为非变音符号：

```
import unicodedata
''.join( c for c in unicodedata.normalize('NFD', u'B\u0153uf') 
            if unicodedata.category(c) != 'Mn'
       ) 
```

我的问题是（可以在这个例子中看到）： unicodedata 是否有办法将组合的 char 变音符号替换为对应的字符？(u'œ' 变成 'oe')

如果不是，我认为我将不得不对这些进行打击，但是我不妨与所有 uchars 及其对应物一起编译我自己的 dict 并`unicodedata`完全忘记......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:57:47.890

您的问题中的术语有些混乱。[*变音符号*](http://en.wikipedia.org/wiki/Diacritic)是可以添加到字母或其他字符但通常不独立存在的标记。（Unicode 也使用更通用的术语*组合字符*。）`normalize('NFD', ...)`所做的是将[*预先组合的字符*](http://en.wikipedia.org/wiki/Precomposed_character)转换为其组件。

无论如何，答案是 – 不是预先组合的字符。这是一个[*印刷连字*](http://en.wikipedia.org/wiki/Typographic_ligature)：

```
>>> unicodedata.name(u'\u0153')
'LATIN SMALL LIGATURE OE' 
```

该`unicodedata`模块没有提供将连字分成其部分的方法。但数据存在于角色名称中：

```
import re
import unicodedata

_ligature_re = re.compile(r'LATIN (?:(CAPITAL)|SMALL) LIGATURE ([A-Z]{2,})')

def split_ligatures(s):
    """
    Split the ligatures in `s` into their component letters. 
    """
    def untie(l):
        m = _ligature_re.match(unicodedata.name(l))
        if not m: return l
        elif m.group(1): return m.group(2)
        else: return m.group(2).lower()
    return ''.join(untie(l) for l in s)

>>> split_ligatures(u'B\u0153uf \u0132sselmeer \uFB00otogra\uFB00')
u'Boeuf IJsselmeer ffotograff' 
```

（当然，在实践中您不会这样做：您会按照您在问题中的建议对 Unicode 数据库进行预处理以生成查找表。Unicode 中并没有那么多连字。）

# android - 删除 vs execSQL 命令 android

> ID：12391350
> 
> 赞同：0
> 
> 时间：2012-09-12T15:13:20.897
> 
> 标签：android, android-sqlite

所以我有一个数据库，`SQLiteDatabase db`我在我的管理器类中编写了几个私有方法，这些方法将被公共方法调用：

```
 public void updateData (MakeabilityModel newData){

        SQLiteDatabase db = this.getWritableDatabase();
        db.beginTransaction();
        try {

          reWriteSVTable(db, list);

          db.setTransactionSuccessful();
        } catch (Exception e){
           //TODO through rollback message?
           e.printStackTrace(); 
        } finally {

          db.endTransaction();
        }

    }
    //Private Methods
    private void clearTable(SQLiteDatabase db, String table){
        db.delete(table, null, null);

    }

    private void reWriteSVTable(SQLiteDatabase db, List<MakeabilityLens> lenses){
        clearTable(db, singleVision);
        ContentValues cv;
        for(int i=0; i<lenses.size(); i++){
            cv = new ContentValues();
            cv.put(colScreenID, hsID);
            cv.put(colIconID, id);
            cv.put(colRank, hsTotal);
            db.insert(isLookUp, colID, cv);     
         }
   } 
```

我的问题是这个..我希望能够将 sql 异常抛出回公共方法，这样如果有异常，它将终止事务并回滚所有数据..

似乎使用 delete() 和 insert() 方法比 execSQL() 更干净，但不会抛出 sqlExceptions。execSQL() 另一方面呢？我是否需要使用 execSQL 以及如何确保它应该在任何私有方法中抛出异常，它将捕获它并在私有方法中回滚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T14:30:37.357

`execSQL()`如果 sql 字符串无效，首先抛出异常。那是在 sql 字符串语法而不是 sql 操作上的例外。也就是说，如果 sql 语句有效但操作失败（例如由于约束），它不会抛出异常。

所以 ..

`execSQL()`基本上和之间的唯一区别`delete()`是`delete()`返回受影响的行数（在你的情况下，删除的行数），但`execSQL()`没有。

注意：
要`delete()`返回受影响的行数，您必须传递除`null`where 子句参数之外的任何值。在你的情况下，通过`"1"`.

# sql - 用同一列中的其他值更新列值

> ID：12391351
> 
> 赞同：-1
> 
> 时间：2012-09-12T15:13:32.037
> 
> 标签：sql

我有像`A`和这样的字段`B`。数据是这样的：

```
+---+-----+
| A | B   |
+---+-----+
| 1 | 100 |
| 1 | A   |
| 2 | 200 |
| 2 | A   |
| 3 | 300 |
| 3 | A   |
+---+-----+ 
```

现在我需要的输出数据是：

```
+---+-----+
| A | B   |
+---+-----+
| 1 | 100 |
| 1 | 100 |
| 2 | 200 |
| 2 | 200 |
| 3 | 300 |
| 3 | 200 |
+---+-----+ 
```

我需要 GP 数据库中的 SQL 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:28:52.097

您可以通过简单的更新来做到这一点，这应该适用于任何数据库：

```
update t
    set B = (select max(B) from t2 where B <> 'A' and t2.A = t.A)
    where B = 'A' 
```

# android - 未找到 Android 应用内购买项目

> ID：12391359
> 
> 赞同：0
> 
> 时间：2012-09-12T15:14:08.497
> 
> 标签：android, android-billing

我试图在 android 中实现应用购买。我已经正确设置了一切......我使用以下代码：

```
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.main_purchase_yes:
        if(BillingHelper.isBillingSupported()){
            BillingHelper.requestPurchase(TopOption.this, "android.test.purchased"); 
            // android.test.purchased or android.test.canceled or android.test.refunded or com.blundell.item.passport
        } else {
            Toast msg = Toast.makeText(TopOption.this, "Can't purchase on this device", Toast.LENGTH_LONG);

            msg.setGravity(Gravity.CENTER, msg.getXOffset() / 2, msg.getYOffset() / 2);

            msg.show();
            Log.i(TAG,"Can't purchase on this device");
            // XXX press button before service started will disable when it shouldnt
        }

        break;
    default:
        // nada
        Log.i(TAG,"default. ID: "+v.getId());
        break;
    } 
```

但是，如果我将产品 ID 而不是“android.test.purchased”设置为“com.company.item.itemID”，我从商店得到的响应是 ItemNotFound？有人知道该怎么做吗？

在我的 manifest.xml 中，我设置了所有内容，例如权限、服务和其他......而且我在任何地方都设置了 com.companyname.AppID。在谷歌解放军我已经设置了应用程序。以及我设置为已发布的项目。

有谁知道该怎么做？

更新：

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.companyname.productid"
android:versionCode="1"
android:versionName="1.0" android:installLocation="preferExternal">

<uses-sdk
    android:minSdkVersion="4"
    android:targetSdkVersion="15" />
<supports-screens
android:largeScreens="true"
android:normalScreens="true"
android:smallScreens="true"
android:anyDensity="true" />
 <uses-permission android:name="android.permission.INTERNET" /> 
 <uses-permission android:name="com.android.vending.BILLING" />
<application

    android:icon="@drawable/ic_launcher"
    android:label="@string/newname"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen">
    <activity
        android:name=".TopOption"
        android:label="@string/appName"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".mygame"
        android:label="@string/title_activity_main" 
        android:screenOrientation="portrait">
    </activity>
     <activity
        android:name=".aboutclass"
        android:label="@string/title_activity_main"
        android:screenOrientation="portrait" >
    </activity>

  <service android:name=".BillingService" />
  <receiver android:name=".BillingReceiver">
     <intent-filter>
        <action android:name="com.android.vending.billing.IN_APP_NOTIFY" />
        <action android:name="com.android.vending.billing.RESPONSE_CODE" />
        <action android:name="com.android.vending.billing.PURCHASE_STATE_CHANGED" />         
     </intent-filter>
  </receiver> 

</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:04:48.823

尝试这个：

1.  将您的应用导出为 APK 文件。
2.  将 APK 上传到 Google Play。
3.  将相同的 APK 侧载到您的测试设备。
4.  等待一个小时左右，让 Google Play 更新其服务器。
5.  测试已安装的 APK。

# c# - 在单独的程序集中本地化 resx 文件？

> ID：12391363
> 
> 赞同：1
> 
> 时间：2012-09-12T15:14:18.477
> 
> 标签：c#, localization, embedded-resource, resx

我有一个场景，我需要在多个项目类型（Web 前端、WCF、Windows 服务等）之间共享本地化，所以我的想法是创建一个本地化程序集，我可以在其中嵌入所有 resx 文件，然后随时添加/修改这些我只需要重新部署一个 dll 来更新我的所有应用程序。

因此，为了进行测试，我创建了一个类库项目并将其命名为 TestLocalization。我向它添加了一个名为 LocalizationManager 的类，它现在只是一个存根，（我计划稍后在其中放入一些实用方法）。然后我添加了两个 resx 文件，每个文件都有一个测试条目。我将一个文件命名为 Resource.resx，另一个命名为 Resource.fr.resx。我验证了 resx 文件的 Build Action 设置为 'Embedded Resource' 然后编译它并尝试使用以下代码调用它：

```
Assembly assembly = typeof(TestLocalization.LocalizationManager).Assembly;
ResourceManager rm = new ResourceManager("Resource", assembly);
string str = rm.GetString("AKey"); 
```

它给了我以下错误：

“找不到适合指定区域性或中性区域性的任何资源。确保“Resource.resources”在编译时已正确嵌入或链接到程序集“TestLocalization”中，或者所需的所有附属程序集都是可加载和完全签名的。 "

我在这里做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:22:10.000

我不确定我最初做错了什么，但我可以发誓我用程序集 + 命名空间 + 资源名的所有可能排列对其进行了测试，但它没有用，但也许我忘了保存或其他什么，因为它真的很简单：

```
ResourceManager rm = new ResourceManager("TestLocalization.Resource", assembly); 
```

那就是我的项目名称是 TestLocalization 并且我的 resx 文件都在根目录中的地方。如果您将它们放在根目录下的子目录中，则还需要包含它。

然后，如果您想在语言环境之间切换，只需执行以下操作：

```
CultureInfo french = new CultureInfo("fr-FR");
string translatedVal = rm.GetString("keyname", french); 
```

# web-services - JBoss AS 在发送 SOAP 消息时停止工作

> ID：12391366
> 
> 赞同：0
> 
> 时间：2012-09-12T15:14:27.907
> 
> 标签：web-services, soap, jboss

我正在使用 JBoss AS 5.0.0。我以“默认”配置启动它，其中一些 Web 服务被部署为 *.ear 文件。客户端发送 SOAP 消息并获得有效响应，并以这种方式与服务器通信。但有时会抛出异常，服务器不再响应。

这是堆栈跟踪：

```
 17:58:00,546 ERROR [STDERR] 12.09.2012 17:58:00 com.sun.xml.ws.transport.http.servlet.WSServletDelegate doGet
SEVERE: caught throwable
javax.xml.ws.WebServiceException: javax.xml.stream.XMLStreamException
        at com.sun.xml.ws.encoding.StreamSOAPCodec.encode(StreamSOAPCodec.java:112)
        at com.sun.xml.ws.encoding.SOAPBindingCodec.encode(SOAPBindingCodec.java:284)
        at com.sun.xml.ws.transport.http.HttpAdapter.encodePacket(HttpAdapter.java:339)
        at com.sun.xml.ws.transport.http.HttpAdapter.access$100(HttpAdapter.java:93)
        at com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:481)
        at com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:244)
        at com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:135)
        at com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doGet(WSServletDelegate.java:129)
        at com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doPost(WSServletDelegate.java:160)
        at com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet.java:75)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:710)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)
        at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)
        at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)
        at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:828)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:601)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
        at java.lang.Thread.run(Thread.java:619)
Caused by: javax.xml.stream.XMLStreamException
        at com.sun.xml.stream.writers.XMLStreamWriterImpl.flush(XMLStreamWriterImpl.java:402)
        at com.sun.xml.ws.streaming.XMLStreamWriterUtil.getOutputStream(XMLStreamWriterUtil.java:97)
        at com.sun.xml.ws.message.jaxb.JAXBMessage.writePayloadTo(JAXBMessage.java:319)
        at com.sun.xml.ws.message.AbstractMessageImpl.writeTo(AbstractMessageImpl.java:142)
        at com.sun.xml.ws.encoding.StreamSOAPCodec.encode(StreamSOAPCodec.java:109)
        ... 31 more
18:02:00,482 ERROR [STDERR] 12.09.2012 18:02:00 com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit handle
SEVERE: Couldn't create SOAP message due to exception: Unable to create StAX reader or writer
com.sun.xml.ws.protocol.soap.MessageCreationException: Couldn't create SOAP message due to exception: Unable to create StAX reader or writer
        at com.sun.xml.ws.encoding.SOAPBindingCodec.decode(SOAPBindingCodec.java:365)
        at com.sun.xml.ws.transport.http.HttpAdapter.decodePacket(HttpAdapter.java:277)
        at com.sun.xml.ws.transport.http.HttpAdapter.access$500(HttpAdapter.java:93)
        at com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:457)
        at com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:244)
        at com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:135)
        at com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doGet(WSServletDelegate.java:129)
        at com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doPost(WSServletDelegate.java:160)
        at com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet.java:75)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:710)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)
        at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)
        at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)
        at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:828)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:601)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
        at java.lang.Thread.run(Thread.java:619)
Caused by: com.sun.xml.ws.streaming.XMLReaderException: Unable to create StAX reader or writer
        at com.sun.xml.ws.api.streaming.XMLStreamReaderFactory$Zephyr.doCreate(XMLStreamReaderFactory.java:334)
        at com.sun.xml.ws.api.streaming.XMLStreamReaderFactory.doCreate(XMLStreamReaderFactory.java:201)
        at com.sun.xml.ws.api.streaming.XMLStreamReaderFactory.create(XMLStreamReaderFactory.java:154)
        at com.sun.xml.ws.encoding.StreamSOAPCodec.decode(StreamSOAPCodec.java:301)
        at com.sun.xml.ws.encoding.StreamSOAPCodec.decode(StreamSOAPCodec.java:129)
        at com.sun.xml.ws.encoding.SOAPBindingCodec.decode(SOAPBindingCodec.java:360)
        ... 30 more
Caused by: javax.xml.stream.XMLStreamException
        at com.sun.xml.stream.XMLReaderImpl.setInputSource(XMLReaderImpl.java:197)
        at com.sun.xml.stream.XMLReaderImpl.setInputSource(XMLReaderImpl.java:207)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at com.sun.xml.ws.api.streaming.XMLStreamReaderFactory$Zephyr.reuse(XMLStreamReaderFactory.java:342)
        at com.sun.xml.ws.api.streaming.XMLStreamReaderFactory$Zephyr.doCreate(XMLStreamReaderFactory.java:325)
        ... 35 more 
```

我应该以何种方式进行调查或其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T18:01:37.780

VM Ware Player 设置存在问题。当我使用 VM Ware 时，我应该配置网络设置。网络被配置为使用不必要的代理。在我看来，由于网络连接不正确，一些肥皂消息丢失了。删除此代理设置后，不会重现错误。

# go - 打印机-接收器程序中的“所有 goroutines 都处于睡眠状态 - 死锁！退出状态 2”错误

> ID：12391371
> 
> 赞同：6
> 
> 时间：2012-09-12T15:14:45.623
> 
> 标签：go, channel

我正在尝试创建一个简单的程序来学习 Go 中的频道。但是我遇到了一个死锁错误，我无法弄清楚

```
package main

import (
    "fmt"
    "time"
)

func printer(c chan int) {
    for i := 0; i < 10; i++ {
        c <- i
        time.Sleep(time.Second)
    }
}

func reciever(c chan int) {
    for {
        recievedMsg := <-c
        fmt.Println(recievedMsg)
    }
}

func main() {
    newChanel := make(chan int)
    printer(newChanel)
    reciever(newChanel)
} 
```

我最初的想法是关于睡眠功能，但即使我不包括这个，我仍然会遇到这个错误并退出消息。任何人都可以就如何解决这个问题提供一些提示吗？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T15:16:35.890

您需要两个执行线程，因为现在`reciever`无法调用该函数，因为您永远不会离开该`printer`函数。您需要在单独的 goroutine 上执行其中一个。

您还应该在循环中`close`使用通道并使用`range`运算符，以便在通道关闭时结束。

所以我建议你这个代码：

```
func printer(c chan int) {
    for i := 0; i < 10; i++ {
        c <- i
        time.Sleep(time.Second)
    }
    close(c)
}

func reciever(c chan int) {
    for recievedMsg := range c {
        fmt.Println(recievedMsg)
    }
}

func main() {
    newChanel := make(chan int)
    go printer(newChanel)
    reciever(newChanel)
} 
```

# python - SQLAlchemy 中的链式比较

> ID：12391377
> 
> 赞同：8
> 
> 时间：2012-09-12T15:15:03.783
> 
> 标签：python, database, orm, sqlalchemy

Python[支持链式比较](http://docs.python.org/reference/expressions.html#not-in)：`1 < 2 < 3`转换为`(1 < 2) and (2 < 3)`.

我正在尝试使用 SQLAlchemy 进行 SQL 查询，如下所示：

```
results = session.query(Couple).filter(10 < Couple.NumOfResults < 20).all() 
```

我得到的结果并不像预期的那样。我已经打开了引擎的`echo=True`关键字，而且确实 - 生成的 SQL 查询只包含两个比较之一。

我找不到任何明确说明这是禁止的文档。我假设如果 Python 支持这种类型的表达式，那么 SQLAlchemy 也应该支持它。

为什么这不起作用？我想到了一种可能的解决方案（在答案中共享），但很高兴听到其他意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-10-14T19:04:29.820

SQLAlchemy 不支持 Python 的链式比较。以下是作者 Michael Bayer 的官方原因：

> 不幸的是，从 python 的角度来看，这可能是不可能的。“x < y < z”的机制依赖于两个单独表达式的返回值。诸如“column < 5”之类的 SQLA 表达式返回一个 BinaryExpression 对象，该对象的计算结果为 True - 因此第二个表达式永远不会被调用，我们也永远没有机会检测表达式链。此外，需要检测表达式链并将其转换为 BETWEEN，因为 SQL 不支持链式比较运算符。不包括检测chains->BETWEEN 部分，要完成这项工作需要`__nonzero__()`根据比较运算符的方向来操作BinaryExpression 对象的值，以便强制进行两个比较。添加一个基本的`__nonzero__()`返回 False 的 BinaryExpression 说明当前代码库对它的容忍度非常差，至少需要将数十种“if x:”类型的检查转换为“if x is None:”，但可能会有更难解决的其他问题。对于外界来说，它可能会造成严重破坏。鉴于此处适当的 SQL 运算符是 BETWEEN ，可以从 between 运算符轻松访问，我不认为向后弯腰和混淆人们的水平是值得的，所以这是一个“不会修复”。

详见： [https ://bitbucket.org/zzzeek/sqlalchemy/issues/1394/sql-expressions-dont-support-x-col-y](https://bitbucket.org/zzzeek/sqlalchemy/issues/1394/sql-expressions-dont-support-x-col-y)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:17:24.860

原因是 Python 实际上会评估类似于以下内容的内容：

```
_tmp = Couple.NumOfResults
(10 < _tmp and _tmp < 20) 
```

SQLAlchemy 不支持该`and`运算符（应该使用该运算符`and_`）。因此，SQLAlchemy 中不允许进行链式比较。

在原始示例中，应改为编写以下代码：

```
results = session.query(Couple).filter(and_(10 < Couple.NumOfResults, 
                                            Couple.NumOfResults < 20)).all() 
```

# python - 即使它们在 Eclipse pydev 中工作，我的导入也用红色下划线

> ID：12391379
> 
> 赞同：0
> 
> 时间：2012-09-12T15:15:08.900
> 
> 标签：python, eclipse, pydev

在 pydev 中，我有一个名为 webcrawler 的 python 包。这个包在目录'/home/raido/Workspace/WebCrawler' 包中包含了一些模块；website, tier, referrer, etc. etc... 每个模块都包含一系列功能。我想在另一个 pydev 项目中使用这些功能之一，所以我输入了....

```
import sys
sys.path.append('/home/raido/Workspace/WebCrawler')
from webcrawler import website

print website.getXmlLang('http://www.google.com') 
```

该脚本运行良好并运行打印出信息的函数。我不明白为什么“从网络爬虫导入网站”行中的网站一词带有红色下划线。错误说...

```
Unresolved import: website
website Found at: TestUrl

from webcrawler import website 
```

但是，一切似乎都运行良好。这是一个 pydev 错误吗？我该如何解决？我试过这样做。

```
import sys
sys.path.append('/home/raido/Workspace/WebCrawler')
from webcrawler.website import getXmlLang

print getXmlLang('http://www.google.com') 
```

即使这样做也可以这样做，也会用红色强调导入“getXmlLang”。

Python 2.6.5 Eclipse 3.7.1 PyDev 2.5.0.2012050419 Ubuntu 10.04

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T21:59:45.607

您应该在*PyDev - PYTHONPATH/External Libraries*选项卡中添加项目使用的所有库，您可以在项目属性中找到该选项卡。这应该可以解决问题。

# html - Rails：为什么显示的模板中定义了空格？

> ID：12391383
> 
> 赞同：3
> 
> 时间：2012-09-12T15:15:19.577
> 
> 标签：html, ruby-on-rails, whitespace, actionview

对为什么这些空格按字面意思理解有点困惑。

如果你看一下下面的图片，你会看到一堆矩形。左边的顶部矩形实际上应该与右边的栏对齐，但这不是因为换行。

![带有元素检查器的网页屏幕截图](../Images/cc5f5086c9456280665ad4c7e8b7a15d.png)

此布局的 Rails 代码如下所示...

在布局中：

```
<div id = "left_bar"><%=yield(:left_bar)%></div>
<div id = "main_content"><%=yield%></div> 
```

在实际模板中：

```
<div class = "set_area images current" id = "set_area_<%= @image_set.id %>">
  <%= render('images/images', :images => @image_set.images) %>
  <div class = "clear"></div>
</div>

<% content_for :left_bar do %>
  <% for set in @image_sets %>
    <%= render("set_tab", :set => set, :is_current_tab => set.eql?(@image_set))%>
  <% end %>
<% end %> 
```

编辑：为简洁起见，上面的代码已经稍微简化了。

更新：当我替换线以呈现部分时：

```
<%= render("set_tab", :set => set, :is_current_tab => set.eql?(@image_set))%> 
```

和

```
<p>Hello</p> 
```

空白没有出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:50:34.580

我将问题追踪到“set_tab”部分。我开始再次删除并重新添加行。

我相信这是错误的，因为有一些混合编码。我主要在 linux 机器上工作，但当天早些时候我在 windows 机器上做了一些编辑。

如果其他人发现他们的观点像这样表现出来，请扔掉你的缩进并重做。

# visual-studio - Visual Studio 单元测试 - 多个案例，如 Nunit

> ID：12391387
> 
> 赞同：12
> 
> 时间：2012-09-12T15:15:42.597
> 
> 标签：visual-studio, unit-testing, mstest, vs-unit-testing-framework

在[Nunit](http://nunit.org/?p=testCase&r=2.5)中，可以为多种情况重用一种测试方法。

```
[TestCase(12,3,4)]
[TestCase(12,2,6)]
[TestCase(12,4,3)]
public void DivideTest(int n, int d, int q)
{
  Assert.AreEqual( q, n / d );
} 
```

如何在 Visual Studio 的测试框架中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:19:08.463

开箱即用是不可能的。但至少对于 VS 2010，您可以编写 MSTEST 扩展来提供几乎相同的功能。检查这个[博客](http://blog.drorhelper.com/2011/01/how-to-add-rowtest-support-to-mstest.html)。但它不如 NUnit 的 TestCase 好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:20:49.260

不幸的是，MS Test 不支持 RowTests。但是，可以使用[DataSource](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.datasourceattribute.aspx)属性破解解决方法。[这里](https://stackoverflow.com/questions/1010685/does-mstest-have-an-equivalent-to-nunits-testcase)有一个例子。

# xcode4 - 如何防止 Xcode 安装 iOS 文档？

> ID：12391388
> 
> 赞同：0
> 
> 时间：2012-09-12T15:15:43.317
> 
> 标签：xcode4

我在首选项的“下载”部分将 Xcode 设置为“自动检查并安装更新”。如果我删除 iOS 5.1 库，它会自动重新安装。安装新东西不是“更新”。我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:05:11.797

你会发现告诉 Xcode 不要搜索 iOS 文档比让它永远不安装 iOS 文档更容易。在搜索字段中有一个放大镜图标按钮。单击按钮并选择显示查找选项。

当您显示查找选项时，您应该会看到“查找范围”菜单。单击菜单，您应该会在 iOS 文档旁边看到一个检查。选择 iOS 文档，检查就会消失，Xcode 不会搜索 iOS 文档。

# python - Sphinx 是否在执行“make html”时运行我的代码？

> ID：12391390
> 
> 赞同：9
> 
> 时间：2012-09-12T15:15:52.870
> 
> 标签：python, python-sphinx

我继承了一个相当大的代码库，我想为其创建 HTML 文档。因为它是用 Python 编写的，所以我决定使用 Sphinx，因为代码的用户已经习惯了使用 Sphinx 创建的 Python 文档的设计和功能。我使用该命令`sphinx-apidoc`自动创建`.rst`文件。我将模块路径导入`sys.path`，以便 Sphinx 可以找到代码。

到目前为止，一切都很好。但是，当我尝试使用 command 创建 HTML 时`make html`，会弹出许多回溯，并且代码库中的一些示例似乎已被执行。这可能是什么原因，我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T18:00:46.780

使用[autodoc](http://www.sphinx-doc.org/en/master/ext/autodoc.html)时，Sphinx 会导入文档化的模块，因此所有模块级代码都会被执行。每次您执行“制作 html”时都会发生这种情况。从这个意义上说，Sphinx 确实“运行”了您的代码。

您可能必须以不同的方式组织代码以使错误消失（将模块级代码移动到函数中）。有关可能发生的情况的示例，请参阅[此问题。](https://stackoverflow.com/q/6912025/407651)

这是我的猜测，但可能不是全部。如果没有更多信息，很难说更多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-13T22:13:15.480

```
def main():

    print('hello world')

if __name__ == '__main__':

    main() 
```

这样您的代码将不会运行。

# vb.net - 将excel表导入sql数据库VB Net客户端

> ID：12391399
> 
> 赞同：0
> 
> 时间：2012-09-12T15:16:18.527
> 
> 标签：vb.net

我有一些代码我希望有人可以查看性能改进。我有一个需要每周导入的电子表格。该工作表有 112 列和大约 35,000 行。我的代码有效，但导入数据大约需要 20 分钟。excel 列名与数据库列名不匹配（我继承了这个）。这是我正在使用的代码。（我删除了很多字段，以便于阅读）

```
 'Connection String to Excel Workbook   
    Dim excelConnectionString As String = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & MyFile & ";Extended Properties=""Excel 12.0;HDR=Yes;"""

    ' Create Connection to Excel Workbook   
    Using connection As New System.Data.OleDb.OleDbConnection(excelConnectionString)

        'List columns you need from the Excel file   
        Dim command As New System.Data.OleDb.OleDbCommand("Select * FROM [" & txtSheetName.Text & "$]", connection)
        connection.Open()

        ' Create DbDataReader to Data Worksheet   
        Using dr As System.Data.OleDb.OleDbDataReader = command.ExecuteReader()

            Dim strSql As String = ""

            strSql = "INSERT INTO MyTestTable (" & _
                        "State, [Store Code], [Store Name], [Store Zone Code], [Store Zone Code Name], " & _
                        "WeekProd, YTDNew, " & _
                        "UpdatedBy, DateUpdated" & _
                     ") VALUES (" & _
                        "@State, @StoreCode, @StoreName, @StoreZoneCode, @StoreZoneCodeName, " & _
                        "@WeekProd, @YTDNew, " & _
                        "@UpdatedBy, @DateUpdated" & _

            Try
                If dr.HasRows() Then

                    While dr.Read()

                        If Convert.ToString(dr.Item(0)) <> "" Then

                            Dim MyZone As String = Convert.ToString(dr.Item(1))
                            MyZone = StrConv(MyZone, vbProperCase)

                            Dim cmd As New SqlClient.SqlCommand
                            cmd.Connection = cn
                            cmd.CommandType = CommandType.Text
                            cmd.CommandText = strSql

                            cmd.Parameters.Add("@State", SqlDbType.VarChar).Value = ""
                            cmd.Parameters.Add("@StoreCode", SqlDbType.VarChar).Value = Convert.ToString(dr.Item(0))
                            cmd.Parameters.Add("@StoreName", SqlDbType.VarChar).Value = MyZone
                            cmd.Parameters.Add("@StoreZoneCode", SqlDbType.VarChar).Value = Convert.ToString(dr.Item(2))
                            cmd.Parameters.Add("@StoreZoneCodeName", SqlDbType.VarChar).Value = Convert.ToString(dr.Item(3))
                            cmd.Parameters.Add("@WeekProd", SqlDbType.Float).Value = Convert.ToDecimal(dr.Item(93))
                            cmd.Parameters.Add("@YTDNew", SqlDbType.Float).Value = Convert.ToDecimal(dr.Item(94))
                            cmd.Parameters.Add("@UpdatedBy", SqlDbType.VarChar).Value = MyUser.Substring(MyUser.Length - 4)
                            cmd.Parameters.Add("@DateUpdated", SqlDbType.Date).Value = Date.Today()

                            cmd.ExecuteScalar()

                        End If

                    End While

                End If

            Catch ex As Exception

                lblMessage.Text = ex.Message
                Exit Sub

            Finally

                cn.Close()
                cn = Nothing

            End Try

        End Using

    End Using 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:58:28.193

不会保证这会让世界在性能方面着火，但它可能会有所帮助。

我的第一个想法是*不要*为 Excel 表中的每一行创建一个新的 SqlCommand 对象和参数集。我会创建*一次*（考虑到您的数据大小，这应该可以为您节省大约 35K 对象实例化的开销），在读取器循环之外建立参数名称，然后调用 SetParameter 将每一列的值设置为中的每一行遍历 Excel。这应该为您交换大约 35K *（实际字段数）参数*添加*调用的开销，以调用对现有参数的 setparameter 调用。而且我还将调用类型更改为 ExecuteNonQuery 而不是 ExecuteScalar。

现在，通常情况下，传统观点认为您只在需要时打开/关闭与数据库的连接，我认为这隐含在此结构中（每次插入都打开/关闭），但在这种情况下，对于数据像这样的更新场景，我认为这将是一个合理的例外。

# javascript - 尝试使用来自控制器的 json 数据加载 Simile 时间线

> ID：12391402
> 
> 赞同：2
> 
> 时间：2012-09-12T15:16:21.630
> 
> 标签：javascript, jquery, json, simile

当我尝试使用来自服务器的数据加载 Simile Timeline 时，我收到以下消息：

```
Failed to load json data from 
{"events":
[{
"description":"Oswald moves to New Orleans, and finds employment at the William B. Riley Coffee Company.",
"end":"Wed May 01 1969 00:00:00 GMT-0600",
"isDuration":true,
"start":"Wed May 01 1963 00:00:00 GMT-0600",
"title":"Oswald moves to New Orleans"}]}
Bad Request 
```

我认为数据看起来是正确的。

这是触发请求的代码：

```
$(document).ready(function () {
        $.ajax({
            url: "http://localhost:64510/api/timeline",
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            success: function (data) {
                loadTimeLine(data);
            }
        });

    });

function loadTimeLine(data) {

        var eventSource = new Timeline.DefaultEventSource();
        var bandInfos = [
            Timeline.createBandInfo({
                eventSource: eventSource,
                date: "Jun 28 2006 00:00:00 GMT",
                width: "70%",
                intervalUnit: Timeline.DateTime.MONTH,
                intervalPixels: 100
            }),
            Timeline.createBandInfo({
                eventSource: eventSource,
                date: "Jun 28 2006 00:00:00 GMT",
                width: "30%",
                intervalUnit: Timeline.DateTime.YEAR,
                intervalPixels: 200
            })
        ];
        bandInfos[1].syncWith = 0;
        bandInfos[1].highlight = true;

        tl = Timeline.create(document.getElementById("my-timeline"), bandInfos);

        Timeline.loadJSON(JSON.stringify(data), function (xml, url) { eventSource.loadJSON(xml, url); });

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:25:04.367

解决方案是您必须在从服务器创建响应时添加状态代码 200。

# android - android对齐以编程方式查看

> ID：12391404
> 
> 赞同：0
> 
> 时间：2012-09-12T15:16:27.307
> 
> 标签：android

我有一个包含一些 TextViews 的 LinearLayout。我设置

```
android:gravity="center_horizontal" 
```

父布局和结果如下所示（对于 N=2）：

![在此处输入图像描述](../Images/2ee4d4043c8ae412bb1af2b54ea0cf3e.png)

我希望它看起来像

![在此处输入图像描述](../Images/11472e0f0ebf51184ae2c660c7c0b6b2.png)

换句话说，我希望它们向左对齐。更准确地说，我的计划是找到最长的 TextView，然后将其他 TextViews 对齐到该视图的左边界。谁能解释我在我的 Activity 的哪个回调中可以做到这一点？我试过

```
public void onCreate(Bundle savedInstanceState) 
```

但

```
textView.getWidth() 
```

（我用来查找最长的 TextView）为所有 textViews 返回 0。第二个问题是：我应该使用什么方法将 TextView 向左移动“n”个像素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:48:36.457

嗯，看起来最简单的方法就是将 LinearLayout 嵌入到另一个 Layout 中，而不是尝试手动完成。

可能的方法：

```
RelativeLayout with gravity:center
  Linear Layout with gravity:left and wrap_content as size
    TextView1, wrap_content
    TextView2 
    ... 
```

这应该可以解决问题！

顺便说一句，如果您尝试对布局做任何事情，覆盖 onCreate 将永远无法工作！只有在绘图框架完成一个“onMeasure”和一个“onLayout”循环后，才会定义布局。确保这一点的（hacky）方法是简单地推迟该代码（例如，使用“View.postDelayed（..）”。更好的方法是在 onCreate 方法中添加一个自定义的、不可见的视图。当它第一次调用onDraw，你可以确定至少第一个布局周期已经完成，所有的视图都应该返回它们的实际大小。

在移动视图方面：你看过“View.setOffset”吗？

# c# - 迭代属性

> ID：12391405
> 
> 赞同：0
> 
> 时间：2012-09-12T15:16:28.247
> 
> 标签：c#

我一直在对迭代属性进行一些研究，并提出了一个似乎可行的基本解决方案，但并不完全符合我的要求。我正在调用一个 WebService 方法，该方法返回一个具有大量属性的 PeopleSoft 对象。这些属性中的每一个都返回一些模糊类型的对象，这些对象类型需要花费太多时间来单独进行类型转换。我的代码有效并且它迭代属性，但它不显示值。这是 Visual Studio 为属性之一制作的自动生成代码。

```
public SETIDTypeShape5 SETID {
        get {
            return this.sETIDField;
        }
        set {
            this.sETIDField = value;
        }
    } 
```

我猜测 SETIDTypeShape5 没有正确的 ToString() 方法，因为当它被打印时，它显示的只是 SETIDTypeShape5。我知道它有一个与之关联的 Value 属性，但是有什么方法可以访问该值吗？这是我到目前为止的代码，以及一些输出的样子。

```
 Type getType = idResponseTypeShape.GetType();

            foreach (PropertyInfo info in getType.GetProperties(BindingFlags.Instance | BindingFlags.Public))
            {
                String name = info.Name;
                object value = info.GetValue(idResponseTypeShape, null);
                Debug.WriteLine("{0} = {1}", name, value);
            }

SETID = VendorMod.edu.clcillinois.fs3.SETIDTypeShape5
VENDOR_ID = VendorMod.edu.clcillinois.fs3.VENDOR_IDTypeShape5
VENDOR_NAME_SHORT = VendorMod.edu.clcillinois.fs3.VENDOR_NAME_SHORTTypeShape3
VNDR_NAME_SHRT_USR = VendorMod.edu.clcillinois.fs3.VNDR_NAME_SHRT_USRTypeShape1
VNDR_NAME_SEQ_NUM = VendorMod.edu.clcillinois.fs3.VNDR_NAME_SEQ_NUMTypeShape1
NAME1 = VendorMod.edu.clcillinois.fs3.NAME1TypeShape3
NAME2 = VendorMod.edu.clcillinois.fs3.NAME2TypeShape1
VENDOR_STATUS = VendorMod.edu.clcillinois.fs3.VENDOR_STATUSTypeShape1 
```

我不确定我是否在彻底解释它，但我基本上是在寻找一种方法来获取这些 TypeShapes 中的每一个的 Value，而无需手动将每个 TypeShape 明确地转换为正确的对象。这甚至可能吗？

# c# - 跨域错误 - Silverlight - WCF 自托管服务

> ID：12391408
> 
> 赞同：1
> 
> 时间：2012-09-12T15:16:37.683
> 
> 标签：c#, wcf, silverlight, soap, windows-services

我正在尝试使用我创建的使用 HTTPS 的自托管 WCF 服务。我可以使用 WCFClientTest 工具和 Web 浏览器访问该服务，但是我的 silverlight 应用程序无法正常工作。我收到以下错误：

```
This could be due to to attempting to access a service in a cross-domain way without a proper cross-domain policy in place, or a policy that is unsuitable for SOAP services. You may need to contact the owner of the service to publish a cross-domain policy file and to ensure it allows SOAP-related HTTP headers to be sent. 
```

我确实有clientaccesspolicy.xml，当我通过fiddler查看它时，我可以看到silverlight应用程序正常。xml 文件包含以下内容：

```
<access-policy>
<cross-domain-access>
<policy>
<allow-from http-request-headers="*">
<domain uri="*"/>
</allow-from>
<grant-to>
<resource path="/" include-subpaths="true"/>
</grant-to>
</policy>
</cross-domain-access>
</access-policy> 
```

问题是，即使 silverlight 应用程序似乎正在请求并接收该文件，它仍然会抛出允许跨域访问所需的错误消息。有什么想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:33:28.460

请注意您的应用程序尝试使用 WCF 服务的地址和端口。使用 Fiddler 查看它在哪里调用（我遇到过很多这样的问题，因为 VS 的错误是相同的......它没有找到服务）。

无论如何，这里有一个正在工作的 clientaccesspolicy.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="http://*"/>
        <domain uri="https://*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:22:07.143

您需要一个单独的域节点用于 https：

```
<domain uri="https://*" /> 
```

有关跨域的更多信息，请访问：http: [//msdn.microsoft.com/en-us/library/dd470115](http://msdn.microsoft.com/en-us/library/dd470115(VS.95).aspx) (VS.95).aspx和[http://blogs.msdn.com/b/carlosfigueira/archive/2008 /03/07/enabling-cross-domain-calls-for-silverlight-apps-on-self-hosted-web-services.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2008/03/07/enabling-cross-domain-calls-for-silverlight-apps-on-self-hosted-web-services.aspx)

愿此链接有所帮助。

# box-api - 以管理员身份共享用户文件夹

> ID：12391409
> 
> 赞同：2
> 
> 时间：2012-09-12T15:16:39.733
> 
> 标签：box-api

试图弄清楚我是否可以通过 box-api 执行以下操作。

1.  以企业管理员身份进行身份验证
2.  查找一个用户（在我们的例子中是一个名为“group_xxx”的特殊盒子用户，该帐户将作为一个非个人共享组，如“group_math_dept”、“group_engineering_dept”等）。
3.  查询给定用户 ID 的根文件夹信息（可能是“GET /users//folders/0”（尝试它不起作用）。
4.  查看已与其共享给定文件夹的企业用户列表。
5.  修改共享给定文件夹的企业用户列表。

我想做的是开发一个应用程序，将这些特殊组帐户的管理员委派给给定组中的适当个人。我们可以维护谁在本地管理什么。我可以作为我们的 Box 管理员之一进行身份验证（即我有步骤 1 和 2 的工作代码）。但是，我在 API v2.0 文档中看不到对步骤 3、4 和 5 的支持。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:11:58.500

不幸的是，我的理解与您发现的相同；API 目前不支持步骤 3 到 5 等帐户和元操作。

更新：查看 Box 的开发人员博客，看起来第 4 步和第 5 步的功能实际上只是添加了，但尚未在文档中。

[http://developers.blog.box.com/2012/09/10/v2-api-updates-keep-rolling/](http://developers.blog.box.com/2012/09/10/v2-api-updates-keep-rolling/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T17:39:45.580

Box 实际上在私有测试版中有更多的企业/管理 API 方法。早期测试人员可以在受控环境中访问这些内容，并包括代表其他具有管理权限的用户执行操作的方法。

如果您有兴趣，请随时向 api [at] box [dot] com 发送电子邮件，以讨论 beta 方法的测试。

# python - 带有嵌入式 python 模块的 C++ 中的多线程

> ID：12391410
> 
> 赞同：2
> 
> 时间：2012-09-12T15:16:43.717
> 
> 标签：python, c++, gil, python-2.4

我正在尝试通过启动一个boost线程来创建一个多线程程序，该线程调用一个函数，该函数又调用一些python模块，但程序挂在那里，因为它获得了一些PyGILState_Ensure（）锁并无限期地等待它释放。你能请告诉我这里有什么问题。

是的，实际上一个 python 模块调用我的 c++ 代码，它在单独的线程中调用另一个 python 模块，这就是为什么我认为它等待 PyGIL 释放导致死锁，所以，有没有使用补丁删除 PyGIL 的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:23:10.873

Python 解释器不是可重入的，需要在调用时锁定解释器（参见例如[http://dabeaz.blogspot.be/2011/08/inside-look-at-gil-removal-patch-of。 html](http://dabeaz.blogspot.be/2011/08/inside-look-at-gil-removal-patch-of.html) ). 在您的特定情况下，解释器上似乎有另一个 Python 调用已经在运行，并且它持有 GIL。

# twitter-bootstrap - 引导导航列表折叠悬停问题

> ID：12391412
> 
> 赞同：2
> 
> 时间：2012-09-12T15:16:46.307
> 
> 标签：twitter-bootstrap, navigation, collapse, nav

在我也有折叠控件的导航列表中时，我似乎无法让悬停在导航标题上正常工作（突出显示列表项）。请注意，nav-header 项必须具有指向页面的链接以及折叠控件，因此必须具有跨度。

```
<ul class="nav nav-list">
<li class="nav-header">
    <span>
        <a href="/" title=""><i class="icon-home"></i>Home</a>
        <span class="caret pull-right" data-target="#test" data-toggle="collapse"></span>
    </span>
    <ul class="nav nav-list collapse in" id="test" >
        <li><a href="/ticket_list.cfm" title="Show list of tickets">Open Tickets</a></li>
        <li><a href="/account/" title="Edit user accounts">Accounts / Community</a></li>
    </ul>
</li>
</ul> 
```

[http://jsfiddle.net/awjreynolds/2Aucc/3/](http://jsfiddle.net/awjreynolds/2Aucc/3/)

有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:50:43.227

该`<span>`标签阻止了高亮效果，因为控制这些样式的选择器是`.nav-list > li > a`和`.nav-list > li > a:hover`。
因此，您可以使用适合您需求的选择器来调整您的标记或重现该样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T21:43:49.003

我刚刚遇到了同样的悬停样式问题，在包含`<span>`. 除了原始帖子提出的问题外，`.active`如果您`<li>`包含`<span>`. 我扩展了 awjr 到达的 css 以获得处理该`class="active"`案例的这个版本。

这是工作的jsfiddle [http://jsfiddle.net/sazerac08/bKSJs/4/](http://jsfiddle.net/sazerac08/bKSJs/4/)

```
/* fix bootsrap nav-list containing a span */
.nav > li > span:hover {
    text-decoration: none;
    background-color: #EEE;
}
.nav-list > .active > span, .nav-list > .active > span:hover, .nav-list > .active > span:focus {
    text-decoration: none;
    background-color: #0088cc;
}
.nav-list > .active > span > a {
    color: #ffffff;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.2);
}
.nav > li > span {
    display: block;
}
.nav-list > li > span > a {
    text-decoration: none;
}
.nav-list > li > span {
    margin-right: -15px;
    margin-left: -15px;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
}
.nav-list > li > span {
    padding: 3px 15px;
} 
```

# java - 如何获取APK文件图标

> ID：12391413
> 
> 赞同：2
> 
> 时间：2012-09-12T15:16:48.150
> 
> 标签：java, android

我一直在尝试获取某个 APK 文件的图标，但没有成功。问题是，我有 APK 文件路径并使用它，我想获取它的图标（作为 Drawable）。

预先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:21:03.470

看看[PackageItemInfo](http://developer.android.com/reference/android/content/pm/PackageItemInfo.html)。有了它，您可以读出设备上安装的任何应用程序的图标！

甚至更快：使用

```
 Context.getPackageManager() 
```

接收对 PackageManager 的引用。对此，您可以致电：

```
 getActivityIcon(Intent i) 
```

您唯一要做的就是在意图中打包包路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:19:32.513

扩展马蒂亚斯的答案，因为我最初的假设是`ic_launcher.png`：

```
int icon = 0;

// if you don't know the icon's name:
icon = (new PackageItemInfo()).icon;

// if you do know the icon's name:
icon = R.drawable.ic_launcher; // or whatever your resource id is

Drawable d = getResources().getDrawable( icon ); 
```

# javascript - 计算数组中的对象以使用 jQuery 更改进度条

> ID：12391415
> 
> 赞同：0
> 
> 时间：2012-09-12T15:16:50.337
> 
> 标签：javascript, jquery

我有一些像这样的示例数据：

```
var data = {
    "section": {
        "1": {
            "question": [{
                "id": "1a",
                "num": "1",
                "title": "test"
            }, {
                "id": "1b",
                "num": "2",
                "title": "test"
            }]
        },
        "2": {
            "question": [{
                "id": "2a",
                "num": "1",
                "title": "test"
            }, {
                "id": "2b",
                "num": "2",
                "title": "test"
            }]
        }
    }
} 
```

使用这个我试图计算问题的数量。因此，对于这个数据样本，总共有 4 个问题......

计划是使用以下数据更新进度表宽度：

```
<div id="progress"><div id="bar"></div></div> 
```

这是我开始整理的 JS 代码：

```
var number = 0, numQuestions, total, width;

function updateProgress() {

    number += 1;

    numQuestions = data.question;

    //total =

    width = total / number;

    $('#progress #bar').animate({'width':width});

} 
```

为了得到`width`我猜我需要将两个部分和问题加在一起，然后除以进度条的宽度，然后将进度的宽度设置为该数字的数字？？

任何人都可以提供一些帮助并指出我正确的方向吗？

主要问题是：

*   numQuestions 返回未定义，所以显然我做错了
*   我不确定如何计算总数......这应该是`#progress #bar`根据 numQuestions 计算的宽度吗？还是完全不同的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:31:53.550

我建议修改您的数据结构如下：

```
var data = {
    "sections": [ // sections is now an array instead of an object
        {
            "question": [{
                "id": "1a",
                "num": "1",
                "title": "test"
            }, {
                "id": "1b",
                "num": "2",
                "title": "test"
            }]
        },
        {
            "question": [{
                "id": "2a",
                "num": "1",
                "title": "test"
            }, {
                "id": "2b",
                "num": "2",
                "title": "test"
            }]
        }
    ]
} 
```

除非您需要命名这些部分，否则无需键入它们。

然后，您可以像这样获取部分的数量：

`var numSections = data.sections.length;`

要获取所有部分的问题总数，您需要创建一个循环：

```
var numQuestions = 0;
for (var i = 0; i < data.sections.length; i++){
    var questions = data.sections[i].question;
    for (var j = 0; j < questions.length; j++){
        numQuestions++;
    }
} 
```

然后，要更新进度条，您将：

```
function updateProgress() {
    number++;
    width = number / numQuestions * 100;
    $('#progress #bar').animate({'width':width + '%'});
} 
```

你会想要`#progress`一个固定的宽度，并`#bar`有一个基于百分比的宽度，范围从`0`到`100%`。

如果您需要命名这些部分，您可以像这样计算问题的数量：

```
var numQuestions = 0;
for (var sect in data.section){
    var questions = data.section[sect].question;
    for (var j = 0; j < questions.length; j++){
        numQuestions++;
    }
} 
```

您可以在这里看到所有这些工作：http: [//jsfiddle.net/wAGHS/1/](http://jsfiddle.net/wAGHS/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:40:12.150

在您的 updateProgress() 中，因为数据对象在关键“问题”处没有元素

```
data.question 
```

将返回未定义。

假设：section 必须是一个对象，并且 question 必须是一个数组

并进一步假设数据可以包含多个“部分”，要获取数据中的问题总数，请尝试：

```
var total_questions=0;
Object.keys(data).forEach(function(k){
    Object.keys(data[k]).forEach(function(num){
        total_questions+=data[k][num]['question'] 
            ? data[k][num]['question'].length 
            : 0;
    })
}); 
```

如果数据只包含一个部分，则上述内容可以简化为：

```
var total_questions=0;
Object.keys(data.section).forEach(function(num){
    total_questions+=data.section[num]['question'] 
        ? data.section[num]['question'].length 
        : 0
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:50:48.077

此功能确实计算您的数据对象中的“问题”：

```
function countquestions(obj) {
   var count = 0;
   for(var prop in obj) {
       if (obj.hasOwnProperty(prop)){
           for(var propp in obj[prop]) {
               if (obj[prop].hasOwnProperty(propp)){
                   ++count;
               }
           }
       }
   }
   return count;
} 
```

它为上面的数据对象返回 2，但是您说它有 4 个问题，这让我感到困惑，因为它只有两个“问题”对象。如果您将每个“问题”对象计为两个，那么只需将我的函数返回的结果乘以 2。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T15:30:00.440

# 回答计数问题

如果您查看您的`data`对象，则没有`data.question`. 问题在下方`section`，然后在`1`或`2`（`data.section.1.question`和`data.section.2.question`）下方。

因此，首先将 a 设置`var`为`data.sections`。[遍历](https://stackoverflow.com/a/500531/600101)各个部分并[检查](https://stackoverflow.com/a/6700/600101)下面问题对象的大小并将它们总结为一个变量。然后你就有了问题的总数。

现在到下一部分：您总共有四个问题。进度应该显示什么？用户回答的问题数量还是什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-12T15:31:25.217

在您的`object` `data.question`is 中`undefined`，由于对象的每个属性`section`都有一个`question`属性，您可以计算它们。

```
var number = 0;
for (key in data.section) {
   number++
} 
```

[http://jsfiddle.net/KuJgN/](http://jsfiddle.net/KuJgN/)

# javascript - 查询 JS Ext.data.Store

> ID：12391418
> 
> 赞同：4
> 
> 时间：2012-09-12T15:16:59.850
> 
> 标签：javascript, extjs, combobox, store

我打算使用[http://www.objis.com/formationextjs/lib/extjs-4.0.0/docs/api/Ext.data.Store.html](http://www.objis.com/formationextjs/lib/extjs-4.0.0/docs/api/Ext.data.Store.html)来存储表格并过滤数据......例如表销售：产品 | 分行 | 数量 | 收入 | ...假设数量和收入的数据是值的范围，例如：小于 100，在 101 和 200 之间等，我`ComboBox`为每一列使用一个来过滤数据：产品组合框，分支组合框，...

我的设计有一个全局`Store`来固定桌子，`Store`每个`ComboBox`. 我知道我可以使用中的事件/侦听`Select`器`ComboBox`来应用过滤器。另外，使用`datachanged`全局`Store`的 来设置其他存储中的数据。

我的问题是：如何从全局存储中获取/选择/提取一列并应用不同和排序操作来设置每个组合框存储中的数据？？？

**更新**

示例[http://jsfiddle.net/jQXf7/6/](http://jsfiddle.net/jQXf7/6/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:18:37.487

我使用`collect`商店的方法制定了解决方案，并使用`Ext.data.ArrayReader`了`ComboBox` `Stores`.

*   [`Collect`](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.data.Store-method-collect)：从此存储中收集特定 dataIndex 的唯一值。
*   [`Ext.data.ArrayReader`](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.data.ArrayReader)：数据读取器类，用于从数组创建 Ext.data.Record 对象数组。

解决方法：http: [//jsfiddle.net/jQXf7/10/](http://jsfiddle.net/jQXf7/10/)（当时一个过滤器的简单实现）

# ios - UIImagePNGRepresentation 中的 png_error 仅在 iOS 5.1+ 上

> ID：12391424
> 
> 赞同：10
> 
> 时间：2012-09-12T15:17:19.460
> 
> 标签：ios, image, png, ios5.1, uiimagepngrepresentation

我们遇到了一个奇怪的崩溃，其中 UIImagePNGRepresentation() 有时会导致 png_error 调用。我们无法在我们内部的任何设备上重现此错误。

以下是我们的 HockeyApp 崩溃日志之一的堆栈跟踪示例：

```
Thread 0 Crashed:
0   libsystem_kernel.dylib         0x3167132c __pthread_kill + 8
1   libsystem_c.dylib              0x33d6729f abort + 94
2   ImageIO                        0x346c38bf png_error + 114
3   ImageIO                        0x346c2fe3 png_write_end + 46
4   ImageIO                        0x346bf069 writeOnePng + 2260
5   ImageIO                        0x346be78b _CGImagePluginWritePNG + 82
6   ImageIO                        0x346be6fd CGImageDestinationFinalize + 132
7   UIKit                          0x31346e23 UIImagePNGRepresentation + 274 
```

我们只在运行 iOS 5.1+ 及更高版本的设备上看到此崩溃日志。我们实际上也遇到了来自 iOS 6 的崩溃，所以这个错误还没有得到修复。

我编写了一个测试应用程序，它下载了我们的应用程序可以显示的超过 16,000 张可能的图像，并且所有这些图像都能够毫无问题地下载并保存到磁盘中。[对这个要点](https://gist.github.com/2784669)的一些回应暗示这个问题可能是由损坏的图像引起的，但看看我如何下载超过 16,000 张图像并且从未遇到过问题，我认为情况并非如此。

我正在研究的最新假设是，正在下载的数据以某种方式损坏，因此正在创建损坏的 UIImage。但是，所有创建损坏的 UIImage 的尝试都失败了。Apple 似乎为 UIImage 创建了一个健壮的构造函数，这样我传入的任何无效的结果都会导致构造函数返回 nil。

有没有其他人从 UIImagePNGRepresentation 经历过这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T07:47:32.880

如果调用`UIImagePNGRepresentation`在循环内，我看到另一个[SO 线程](https://stackoverflow.com/a/9111591/413289)上的修复建议`sleep(1.0);`在保存后添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T09:46:18.380

在我的生产应用程序（在我的情况下使用）中，几个月来我一直在努力解决类似的本地图像损坏问题，`UIImageJPEGRepresentation()`在我的情况下，它与下载图像无关 - 但与本地存储和渲染有关。

就我而言，错误的实际用户影响是图像只会部分呈现；图像的其余部分只是显示为灰色和损坏。我正在使用 Core Data 存储和读取磁盘（但令人震惊的是，Core Data 不是我的问题）。

**我的修复：**

我以前使用这种方便的方法：

```
UIImage *image = [UIImage imageWithContentsOfFile:imagePath]; 
```

[..但是根据此处其他相关帖子](https://stackoverflow.com/questions/5081297/ios-uiimagejpegrepresentation-error-not-a-jpeg-file-starts-with-0xff-0xd9)的建议，我改用了这种方法组合：

```
NSData *resultData = [NSData dataWithContentsOfFile:imagePath];
UIImage *image = [UIImage imageWithData:resultData]; 
```

..它似乎解决了我的问题！

**我的理论**

我猜测`imageWithContentsOfFile:`，由于某种原因，与纯基本调用相比，处理一些非原子边缘情况条件更差`NSData`，并且出于某种原因允许在前一个“写入”完成之前开始“读取”。

希望这可以帮助！祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:44:04.133

您是否尝试过使用不同的网络条件进行测试？3G 或边缘，而不仅仅是 wifi？尝试使用[网络链接调节](https://stackoverflow.com/questions/9659382/installing-apples-network-link-conditioner-tool)器来模拟这些缓慢和有损网络的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T03:27:21.650

您是否从辅助线程进行任何 UIKit 调用？我已经看到了 UIKit 图形调用在辅助线程上工作但主线程在稍后的某个时候崩溃的崩溃。有一些 UIKit 方法可以在辅助线程上使用，但并不多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-18T17:22:00.457

我们在大规模运行的应用程序中遇到了这个问题。它每天发生超过1000次。使用 Crashlytics 中的日志记录功能，我们能够准确确定导致崩溃的图像。

大约有 25 张图像触发了崩溃。我们意识到这些图像中的每一张都是从 Photoshop 中导出的，而我们的大多数图像都是从 Illustrator 中导出的。在我们尝试过的所有其他程序中，图像都呈现得很好，我们永远无法确定它们的“错误”是什么。但是我们从 Illustrator 重新导出了图像，我们这次崩溃的发生率降为零。

我意识到这并不能提供根本原因，但认为它可能对其遇到此问题的其他人有所帮助。

# ios - 模式视图控制器不在窗口层次结构中

> ID：12391425
> 
> 赞同：3
> 
> 时间：2012-09-12T15:17:21.740
> 
> 标签：ios, uitabbarcontroller, mfmailcomposeviewcontroller

我正在尝试做的应用程序有一个标签栏控制器。

当应用程序启动时，我在 AppDelegate 中获取用户位置，当我获得所需的准确性时，AppDelegate 将 NSNotification 发送到我的应用程序的起始页面（标签栏控制器的索引 0）。

收到通知后，此视图会尝试发送包含用户坐标和其他数据的电子邮件，但一旦出现 MFMailComposeViewController，我就会收到以下错误：

```
Warning: Attempt to present <MFMailComposeViewController: 0x98a0270> on <UITabBarController: 0x988c630> whose view is not in the window hierarchy! 
```

我错过了什么？

谢谢。

编辑：添加一些代码...

这就是我在 AppDelegate.m 中的内容：

```
- (void) locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
NSUserDefaults *phoneNumbers = [NSUserDefaults standardUserDefaults];
NSDate *eventDate = newLocation.timestamp;
NSTimeInterval howRecent = [eventDate timeIntervalSinceNow];
if (abs(howRecent) < 10.0) {
    [self locationUpdate:newLocation];
    smsLoc = newLocation;
    if ([[phoneNumbers objectForKey:@"sendSMS"] isEqualToString:@"yes"]) {
        [[NSNotificationCenter defaultCenter] postNotificationName:@"sendSMS" object:nil];
    } else if ([[phoneNumbers objectForKey:@"sendEmail"] isEqualToString:@"yes"]) {
        [[NSNotificationCenter defaultCenter] postNotificationName:@"sendEmail" object:nil];
    }

}
} 
```

然后，在我的第一个视图控制器中，我有：

```
- (void)viewDidLoad
{
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(sendSMS:) name:@"sendSMS" object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(sendEmail:) name:@"sendEmail" object:nil];
} 
```

最后，“sendSMS”的选择器（另一个非常相似）：

```
- (void)sendSMS: (NSNotification *)notification {
NSUserDefaults *phoneNumbers = [NSUserDefaults standardUserDefaults];
if ([phoneNumbers objectForKey:@"first"] || [phoneNumbers objectForKey:@"second"]) {
        MFMessageComposeViewController *controller = [[MFMessageComposeViewController alloc] init];
        if ([MFMessageComposeViewController canSendText]) {
            AppDelegate *deleg = (AppDelegate *)[[UIApplication sharedApplication] delegate];
            controller.body = [NSString stringWithFormat:@"some message with coordinates %.4f - %.4f", [deleg currentLocation].coordinate.latitude, [deleg currentLocation].coordinate.longitude];
            controller.recipients = [NSArray arrayWithObjects:[phoneNumbers objectForKey:@"first"], [phoneNumbers objectForKey:@"second"], nil];
            controller.messageComposeDelegate = self;
            [self presentModalViewController:controller animated:YES];
        }
    }
}
} 
```

第二次编辑：添加更多代码。

```
UITabBarController *tabBarController = [[UITabBarController alloc] init];
tabBarController.delegate = self;
tabBarController.selectedIndex = 0;
[[tabBarController.tabBar.items objectAtIndex:0] setTitle:NSLocalizedString(@"Home", nil)];
[[tabBarController.tabBar.items objectAtIndex:1] setTitle:NSLocalizedString(@"Requests", nil)];
[[tabBarController.tabBar.items objectAtIndex:2] setTitle:NSLocalizedString(@"Account", nil)];
[[tabBarController.tabBar.items objectAtIndex:3] setTitle:NSLocalizedString(@"Settings", nil)];
//some other controls from DB
[[tabBarController.tabBar.items objectAtIndex:1] setBadgeValue:[NSString stringWithFormat:@"%d",number]]; 
```

tabbarController 是通过 IB 制作的，但我在 AppDelegate 中添加了上面的代码，因为我需要本地化标签栏项目并向其中一个项目添加徽章。我在这里做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T10:05:50.970

我不确定你是否解决了这个问题。该错误消息意味着您用于呈现另一个模态视图控制器的视图控制器在窗口上不可见。这可能发生在例如：

```
[VC1 presentModalViewController:VC2];

// Error here, since VC1 is no longer visible on the window
[VC1 presentModalViewController:VC3]; 
```

如果您的问题与上述类似，您可以像这样修复它：

```
if (self.modalViewController != nil) {
    [self.modalViewController presentModalViewController:VC3 animated:YES];
} else {
    [self.tabBarController presentModalViewController:VC3 animated:YES];
} 
```

如果这不能解决您的问题，也许您可​​以尝试使用 self.tabBarController 而不是 self 来呈现。再次只是建议，但不确定它是否有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-22T10:43:38.290

使用它可以帮助某人：`[[UIApplication sharedApplication].keyWindow.rootViewController presentViewController:picker animated:NO completion:nil];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-18T14:17:04.870

由于 modalViewController 和 presentModalViewController 已被弃用，以下对我有用：

```
presentingVC = [[UIApplication sharedApplication] keyWindow].rootViewController;
if (presentingVC.presentedViewController) {
    [presentingVC.presentedViewController presentViewController:VC3 animated:YES completion:nil];
} else {
    [presentingVC presentViewController:VC3 animated:YES completion:nil];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-17T09:22:31.143

你可以按照这个模式

```
[VC1 presentModalViewController:VC2];

//
[**VC2** presentModalViewController:VC3]; 
```

# r - 在条形图中删除每个面板未使用的因素

> ID：12391429
> 
> 赞同：2
> 
> 时间：2012-09-12T15:17:29.340
> 
> 标签：r, plot, lattice

我正在尝试使用 lattice 中的条形图制作绘图，但对于给定面板，我遇到了一些未使用因子的问题。我尝试过使用`drop.unused.levels`，但似乎它只会在未在任何面板中使用时丢弃因子。

这是我正在使用的数据框：

```
dm <- structure(list(Benchmark = structure(c(1L, 2L, 3L, 4L, 5L, 6L, 
7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 
2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L), class = "factor", .Label = c("416.gamess", 
"429.mcf", "436.cactusADM", "458.sjeng", "462.libquantum", "471.omnetpp", 
"482.sphinx3")), Class = structure(c(3L, 1L, 2L, 3L, 1L, 4L, 
2L, 3L, 1L, 2L, 3L, 1L, 4L, 2L, 3L, 1L, 2L, 3L, 1L, 4L, 2L, 3L, 
1L, 2L, 3L, 1L, 4L, 2L, 3L, 1L, 2L, 3L, 1L, 4L, 2L), class = "factor", .Label = c("CS", 
"PF", "PI", "PU")), Config = structure(c(1L, 1L, 1L, 1L, 1L, 
1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L), .Label = c("Disabled", 
"Shallowest", "Deepest", "StorePref", "StridedPref"), class = "factor"), 
    Perf = c(1, 0.72, 0.8, 1, 0.32, 1.16, 0.79, 1, 0.98, 1, 1, 
    0.72, 1, 0.99, 1, 0.98, 1, 1, 1.12, 0.97, 1, 1, 0.97, 1, 
    1, 0.99, 0.97, 1, 1, 1.18, 1, 1, 0.99, 0.97, 1)), .Names = c("Benchmark", 
"Class", "Config", "Perf"), row.names = c(NA, -35L), class = "data.frame") 
```

首先我尝试`barchart`这样使用：

```
barchart(Perf ~ Benchmark | Class, dm, groups=Config,
         scales=list(x=list(relation='free')), auto.key=list(columns=3)) 
```

这给了我以下情节：

![糟糕的情节](../Images/602ff14abf78a3819f84fb5cc6d836f3.png)

如您所见，PI、PF 和 CS 类的基准之间存在差距。原因是每个因素只存在于给定的类别中，因此在所有其他类别中都缺失，并且`barchart`可能会在 x 轴上引入间隙。

我的第二次尝试是打电话`barchart`四次（每个班级一次）：

```
class.subset <- function(dframe, class.name) {
    return(dframe[dframe$Class == class.name, ])
}

pl1 <- barchart(Perf ~ Benchmark, class.subset(dm, 'PI'), groups=Config)
pl2 <- barchart(Perf ~ Benchmark, class.subset(dm, 'PF'),, groups=Config)
pl3 <- barchart(Perf ~ Benchmark, class.subset(dm, 'CS'),, groups=Config)
pl4 <- barchart(Perf ~ Benchmark, class.subset(dm, 'PU'),, groups=Config)

print(pl1, split=c(1, 1, 2, 2), more = TRUE)
print(pl2, split=c(1, 2, 2, 2), more = TRUE)
print(pl3, split=c(2, 1, 2, 2), more = TRUE)
print(pl4, split=c(2, 2, 2, 2)) 
```

我得到的图几乎是我想要的，但现在我不知道如何为所有子图创建一个全局图例（而不是每个子图都使用相同的图例）：

![几乎好](../Images/361be3c6d4e39f1e2d972fdbd37fce64.png)

理想情况下，我更愿意使用第一种方法来解决我面临的问题（因为这样我也会在每个面板中都有类名）。但是，如果在第二种情况下，可以为每个包含类名的子图添加全局图例和标题，那也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:26:57.793

这是使用的快速方法`latticeExtra`：

```
pl1 <- barchart(Perf ~ Benchmark|Class, class.subset(dm, 'PI'), groups=Config, 
                auto.key=list(columns=3))
pl2 <- barchart(Perf ~ Benchmark|Class, class.subset(dm, 'PF'), groups=Config)
pl3 <- barchart(Perf ~ Benchmark|Class, class.subset(dm, 'CS'), groups=Config)
pl4 <- barchart(Perf ~ Benchmark|Class, class.subset(dm, 'PU'), groups=Config)

library(latticeExtra)
pls <- c(pl1, pl2, pl3, pl4)
pls <- update(pls, scales=list(y="same"))
pls 
```

![在此处输入图像描述](../Images/f226d39a7249e3af32d9d5187955e49c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-28T14:48:50.247

我只是在一个有 95 个级别的因素中遇到了同样的问题`lattice::xyplot`。对我有用的是（因子是具有太多级别的变量）：

```
 library(gdata)
    key<-simpleKey(levels(drop.levels(df$factor)),...)
    xyplot(response~predictor,groups=factor, data=df, key=key) 
```

对我来说就像一个魅力。最良好的祝愿！

# java - 自动化 Java AWT 小程序

> ID：12391433
> 
> 赞同：1
> 
> 时间：2012-09-12T15:17:55.860
> 
> 标签：java, applet, automation, awt, ui-automation

我需要自动化我的 java 应用程序。我使用 Selenium，但在这种情况下，它不能识别 GUI 的元素。我们使用 2000 的 Java AWT。你能帮我选择合适的自动化工具吗？我使用 AutoIT，但它不是我的应用程序的最佳变体。

# xml - 在tomcat webapp中动态设置上下文参数？

> ID：12391441
> 
> 赞同：0
> 
> 时间：2012-09-12T15:18:43.170
> 
> 标签：xml, jsp, tomcat, web-applications

我在 tomcat_5.0.28，Linux 上部署了 webapp。

我的应用程序是多用户和配置文件（用户可以是管理员或只是简单用户）。

在我的`web.xml`我有这些台词

```
...
<web-app>
    <display-name>my-app</display-name>
    <context-param>
        <param-name>configFileName</param-name>
        <param-value>/WEB-INF/my-app-config.xml</param-value>
    </context-param>
    ... 
```

如何`configFileName`根据他的个人资料在用户登录时设置参数的值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T14:35:47.053

如果您可以使用参数值作为模板

```
 <param-name>configFileName</param-name>
 <param-value>/WEB-INF/my-app-config-{username}.xml</param-value> 
```

然后你的jsp可以是​​这样的

```
 String userName = request.getRemoteUser()
 String temp = context.getInitParameter("configFileName");
 String fileName = temp.replace("{username}", userName); 
```

# ruby-on-rails-3 - Carrierwave：如果尺寸大于则缩放图像（有条件地创建版本）

> ID：12391443
> 
> 赞同：3
> 
> 时间：2012-09-12T15:18:55.967
> 
> 标签：ruby-on-rails-3, carrierwave, minimagick

仅当图像大于版本的大小时，才可以使用carrierwave 创建版本（例如拇指）？

例子：

```
version :thumb, :if => :is_thumbnable? do 
    process :resize_to_fit => [32,nil]
end

protected

def is_thumbnable?(file)
  image ||= MiniMagick::Image.open(file.path)
  if image.nil?
    if image['width'] >= 32 || image['height'] >= 32
      true
    else
      false
    end
  else
    false
  end
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-12-30T14:39:59.990

我尝试了它们，但它对我不起作用。在开发中调整为大图像时，我的服务器被阻止。

*   载波 (0.9.0)
*   rmagick (2.13.2)

所以我看了一下文档：[http ://carrierwave.rubyforge.org/rdoc/classes/CarrierWave/RMagick.html](http://carrierwave.rubyforge.org/rdoc/classes/CarrierWave/RMagick.html)

有一个奇妙的功能：`resize_to_limit(width, height)`

> 调整图像大小以适应指定尺寸，同时保持原始纵横比。仅当图像大于指定尺寸时才会调整图像大小。生成的图像可能比在较小尺寸中指定的更短或更窄，但不会大于指定值。

我的代码如下所示：

```
version :version_name, from_version: :parent_version_name do
    process resize_to_limit: [width, nil]
end 
```

只有当它更大时，它才会调整大小以适应宽度，同时尊重 w/h 的比率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T17:06:47.870

我定义了一种方法，如果图像超过给定的宽度，则在这种情况下将其操作为 32 像素的大小。将此代码放入您的 ImageUploader：

```
 version :thumb do 
    process :resize_to_width => [32, nil]
  end

  def resize_to_width(width, height)
    manipulate! do |img|
      if img[:width] >= width
        img.resize "#{width}x#{img[:height]}"
      end
      img = yield(img) if block_given?
      img
    end
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T13:39:47.363

实际上@Roza 解决方案对我不起作用。我不得不像这样修改方法：

```
process :resize_to_width => [650, nil]

def resize_to_width(width, height)
  manipulate! do |img|
    if img.columns >= width
      img.resize(width)
    end
    img = yield(img) if block_given?
    img
  end
end 
```

我使用 rmagick (2.13.2) 和 rails 3.2.13,carrierwave (0.8.0)

# stored-procedures - xmltable、xml doc 上的 DB2 iSeries v6.1 与 Linux v9.7 功能

> ID：12391448
> 
> 赞同：0
> 
> 时间：2012-09-12T15:19:06.187
> 
> 标签：stored-procedures, db2

技术人员——当我尝试部署我知道在 Linux v9.7 上工作的存储过程时，我在 i db2 6.1 安装中找不到 *LIBL 类型 *SQLUDT 中的 sql0204 XML。我试图让它工作的原因是因为我真的需要传递一个表（或数组）变量。我找不到将多维数组发送到 i 的 6.1 v 上的 sproc 的方法，所以我想我会尝试使用 xml 文档来解决这个问题。但这也失败了......有人对我如何解决这个问题有任何建议吗？

这是适用于 v9.7、Linux 的存储过程：

```
 CREATE PROCEDURE HCMDEV.EMP_MULTIPLE_XML (IN DOC XML)
  DYNAMIC RESULT SETS 1
  READS SQL DATA
  LANGUAGE SQL SPECIFIC EMP_MULTIPLE_XML

  P1: BEGIN

  DECLARE CSR1 CURSOR WITH RETURN FOR
    SELECT emp.EMPID,
           emp.FIRSTNAME,
           emp.LASTNAME,
           emp.DIVISION,
           emp.DISTRICT,
           emp.LOCATION,
           emp.OPERATIONALAREA,
           emp.TERMDATE,
           emp.REHIREDATE,
           emp.HIREDATE,
           emp.ADDRESSLINE1,
           emp.ADDRESSLINE2,
           emp.CITY,
           emp.STATE,
           emp.ZIPCODE,
           emp.TELEPHONE1,
           emp.POSITIONCODE,
           emp.POSITIONTITLE,
           emp.HIRECODE
        FROM HCMDEV.EMPLOYEE emp
         WHERE EMP.EMPID IN
          (SELECT X.EMPID
           FROM XMLTABLE('$d/EMPLOYEE/EMPID' PASSING DOC AS "d" COLUMNS EMPID CHAR(9) PATH '.') AS X);

  OPEN CSR1;
  END P1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:27:11.603

对于那些关注这个线程的人，xmltable 直到 V7R1 才可用。解决方法是创建一个存储过程，它接受 CLOB 数据类型作为 IN 参数。在我的例子中，我传递了一个带有逗号的长字符串来分隔 empid 的值。这工作得很好。这是一个示例：

```
 CREATE PROCEDURE HCMDEV.EMP_MULT (IN emp_array CLOB(2M))
 DYNAMIC RESULT SETS 1
 READS SQL DATA
 LANGUAGE SQL SPECIFIC EMP_MULT
 P1: BEGIN
-- #######################################################################
-- # Returns specific employees based on incoming clob array
-- #######################################################################

DECLARE v_dyn varchar(10000);
DECLARE v_sql varchar(10000);

DECLARE cursor1 CURSOR WITH RETURN FOR v_dyn;

SET v_sql = 
  'SELECT
     emp.EMPID,
     emp.FIRSTNAME,
     emp.LASTNAME
     FROM HCMDEV.EMPLOYEE emp
      WHERE emp.EMPID IN (' || emp_array || ')';

   PREPARE v_dyn FROM v_sql;

   OPEN cursor1; 
```

结束 P1

# c++ - 确定不打开文件的确切原因

> ID：12391454
> 
> 赞同：0
> 
> 时间：2012-09-12T15:19:21.630
> 
> 标签：c++, boost, fstream, boost-filesystem

问题是`std::fstream`默认情况下不会抛出异常，而是设置可以检查的位。显然，然后可以通过使用这里解释的异常函数来引发异常（我认为）——参见例如[c++ 参考页](http://www.cplusplus.com/reference/iostream/ios/exceptions/)

但是，例如，如果文件的写入权限意味着无法写入文件怎么办？这意味着当我尝试做

```
 ofstream file("file", ios::out); 
```

会导致失败。但是如何确定它是否由于 uid 没有写权限的确切原因而失败呢？我想我正在寻找的是某种机制可以准确地告诉我这一点，例如它可能会显示“文件无法写入，因为...”。我不想检查文件权限，因为可能发生写入失败的原因有很多（硬盘驱动器故障/损坏等）。如果它能准确地告诉我它失败的原因会更好。

有谁知道 iostreams（尤其是 ostreams）是否存在这样的错误检查系统？（也许在提升？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:29:45.653

您可以尝试检查`errno`并将其转换为人类可读的形式`strerror`。

该标准不保证`errno`I/O 故障的适用性，但在实践中它应该有效。

# java - Java 'final' 声明对类成员变量的影响

> ID：12391455
> 
> 赞同：4
> 
> 时间：2012-09-12T15:19:27.760
> 
> 标签：java, performance, variables, final

这更像是一个理论问题而不是解决方案问题，所以请听我说。

在 C/C++ 和 PHP 中，您可以声明常量。通常有几种方法可以做到这一点（`#DEFINE`例如，或' `const type`'......），其最终效果是在编译期间完成替换，以便所有这些命名常量都变为文字。这很有帮助，因为不必访问内存位置来查找数据，而是将数据硬编码在其中，但没有硬编码的缺点 - 如果需要重用，则调用该值，并在该值时更改该值的所有实例需要改变。

但是 Java 的`final`声明有点不可思议。因为我可以使用未设置的最终变量创建一个类并在构造时初始化它们，这意味着据我所知它们没有被预编译为文字。除了保证它们在构造后不能在逻辑上改变之外，`final`声明是否对效率有任何好处？

对文章的引用很好，只要您记下解释`final`真正起作用的部分以及除了在构造后停止值更改之外它的好处是什么。

作为推论，除了简单地使用文字之外，是否有可能以任何其他方式在 Java 中实际声明编译级常量（无论如何都是个坏主意？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:27:07.037

Java 确实有常量表达式。请参阅java 语言规范中的[此处](http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.28)。

```
A compile-time constant expression is an expression denoting a value of primitive type or a String that does not complete abruptly and is composed using only the following:

Literals of primitive type and literals of type String (§3.10.5)
Casts to primitive types and casts to type String
The unary operators +, -, ~, and ! (but not ++ or --)
The multiplicative operators *, /, and %
The additive operators + and -
The shift operators <<, >>, and >>>
The relational operators <, <=, >, and >= (but not instanceof)
The equality operators == and !=
The bitwise and logical operators &, ^, and |
The conditional-and operator && and the conditional-or operator ||
The ternary conditional operator ? :
Parenthesized expressions whose contained expression is a constant expression.
Simple names that refer to constant variables (§4.12.4).
Qualified names of the form TypeName . Identifier that refer to constant variables (§4.12.4). 
```

但在 Java 中，与 C/C++ 不同，您还拥有 JIT 编译器，因此可以进行额外的内联。所以底线是，在你看到真正的性能问题之前不要担心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T15:37:23.460

Java 确实有一些常量，Java 编译器将在编译时将其替换为它们的值。例如，属于`final`和属于类型的成员变量实际上是`String`常量，它们以这种方式被替换。（这是允许的，因为类`String`是不可变的）。这样做的后果之一是，如果您更改源代码中的字符串，但不重新编译使用该字符串的类，这些类将看不到该字符串的新值。

JLS 在以下段落中对此进行了解释：

[4.12.4`final`变量](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.4)

[13.4.9`final`字段和常量](http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html#jls-13.4.9)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T15:38:57.620

最终字段旨在制作*不可变*对象。

静态最终字段是您的*常量*。

编译器优化、数据流分析在某种程度上发生。尝试使用 javap 来查看 jvm 字节码 - 如果您对此感兴趣的话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T15:39:58.217

> 最后的声明对效率有什么好处吗？

并不真地。这是因为 JIT 通常可以确定该值在运行时没有更改，并且可以将其视为最终值。（如果值不是 volatile 并且在另一个线程中更改，这是一个问题）

在 Java 8 中，如果可以将局部变量设为 final，则可以在闭包中使用它们，而不必将它们声明为 final。

# xsd - Visual Studio 2008 从 XSD 文件中读取值

> ID：12391461
> 
> 赞同：2
> 
> 时间：2012-09-12T15:19:37.740
> 
> 标签：xsd

第一篇文章。我正在尝试读取 Visual Basic 中任何 XSD 的值。我希望应用程序读回复杂类型、元素等值。我一直在研究 MSXML2，但大多数示例都包括针对 XML 文件的验证。我只想阅读 XSD 并获取信息。xml 阅读器能否读取 XSD 文件？任何帮助都很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:21:14.817

这在很大程度上取决于您尝试使用此信息做什么，因此在执行此操作之前需要具备先决条件。

对于所有非常琐碎的任务，我建议使用[System.Xml.Schema](http://msdn.microsoft.com/en-us/library/system.xml.schema.aspx)命名空间中的类，特别是从[XmlSchema](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschema.aspx)和[XmlSchemaSet](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaset.aspx)开始。这将允许您以任何您想要的方式操作 XSD；如果证明是一项要求，它还允许您在使用它们之前验证模式。

为了完整性，对于我称之为非常简单的任务，您可能还认为 XSD 只是 XML，因此任何 XML 处理器都应该允许您加载 XSD 并根据需要对其进行查询。

由于您提到了 VS2008，以上所有内容都将在 Visual Basic.NET 上。如果您仍在使用 Visual Basic 并且需要依赖 MSXML，那么我建议您参考这篇关于使用[Visual Basic 和 SOM](http://support.microsoft.com/kb/312554)的文章。

# ruby-on-rails - 最佳方法 - 视图中的条件

> ID：12391463
> 
> 赞同：0
> 
> 时间：2012-09-12T15:19:46.863
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我有一个带有名称、标题、描述等的模型。如果名称是例如 weather-foracast 我想显示一个额外的 html 元素

```
= high_chart("my_id", @chart) 
```

在显示模板中，它会生成一个漂亮的图表。当页面不是天气预报时，我不想显示图表。

最好的方法是什么？视图中的条件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:25:14.320

由于看起来您是 HAML，`if`因此您可以使用如下修饰符：

```
= high_chart("my_id", @chart) if [model.name] == "weather-forecast" 
```

where`[model.name]`替换为适当的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:42:39.773

我知道这个答案完全是多余的，但是要考虑的是将您的条件逻辑移到您的视图之外。
也许与 View Presenter 模式一起使用，请参阅： [关于 rails 中的 Presenter 模式。有更好的方法吗？](https://stackoverflow.com/questions/2822314/about-presenter-pattern-in-rails-is-a-better-way-to-do-it)

Presenter 是 ruby​​ 对象，可以很容易地进行测试。
而在视图中拥有大量逻辑确实很难测试。
此外，您希望逻辑隔离，在视图页面中检查 model.name 并不是 MVC 的最佳方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T17:57:08.497

您的问题看起来非常接近[Object on Rails](http://objectsonrails.com/#ID-2656c30c-080a-4a4e-a53e-4fbaad39c262)中提出的展览模式。

简单地说，提出的解决方案是将模型包装在使用模型状态（在您的情况下为记录名称）选择的装饰器（或多个装饰器）中。

[我无法像书中](http://objectsonrails.com/#ID-2656c30c-080a-4a4e-a53e-4fbaad39c262)解释的那样解释它，但 Pattern 非常有用，以至于 Avdi Grimm 用它制作了一个宝石：[https ://github.com/objects-on-rails/display-case](https://github.com/objects-on-rails/display-case)

# html - 在 IE 中加载和收集字段信息时遇到问题。在 Chrome 中很好

> ID：12391467
> 
> 赞同：0
> 
> 时间：2012-09-12T15:20:04.813
> 
> 标签：html, onload, window.location

在体内，我有以下内容：

```
<body onload="loadCheck1();"> 
```

这指向以下功能：

```
function loadCheck1() {

var chkme1 = "<?php echo $_GET['update']; ?>";
if (chkme1 ==1){
window.location = "viewrecipe.php?recipe_name="+recipe_name.value+"&update=2&texty1="+texty1.value+"&texty2="+texty2.value+"&texty3="+texty3.value+"&texty4="+texty4.value+"&texty5="+texty5.value; 
}

if (last==3){
window.location = "viewrecipe.php?recipe_name="+recipe_name.value+"&NewFG1="+texty4.value+"&NewAlc="+texty5.value;
}

} 
```

URL`viewrecipe.php?update=1`应该加载第一个 window.location 并且`viewrecipe.php?update=3`应该加载第二个。

在 Chrome 中，这绝对没问题。在 IE 中，我收到一条错误消息，提示“recipe_name”未定义。

我唯一能想到的是，在 Chrome 中，代码仅在页面实际加载后才会激活。到那时，所有字段值都将被填写。

页面加载后是否有其他方法可以运行功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:25:43.370

您的函数中未定义几个变量： - recipe_name - last

它们是在其他地方定义的吗？我猜 texty1 到 texty5 是表单输入。如果不是，这些变量也没有定义。

您应该向我们提供更多代码，以便我们为您提供帮助。

# .net - obj 目录的用途

> ID：12391468
> 
> 赞同：2
> 
> 时间：2012-09-12T15:20:14.657
> 
> 标签：.net

一个简单的问题（希望如此）。.NET 中的 obj 目录是什么？我的意思是在构建发生时除了 bin 目录之外生成的目录。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:21:32.813

该`obj`目录是创建编译的目标文件并将其组装成程序集的位置。本质上这是编译器/链接器/汇编器的工作目录。

结果被复制到`bin`（二进制）目录。

另请参阅[obj 和 bin 文件夹（由 Visual Studio 创建）用于什么？](https://stackoverflow.com/q/5308491/1583)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:22:26.060

“obj”文件夹用于存储临时目标文件和其他用于在编译过程中创建最终二进制文件的文件。

“bin”文件夹是完整二进制文件（程序集）的输出文件夹。

# animation - HighCharts 动画按列

> ID：12391469
> 
> 赞同：0
> 
> 时间：2012-09-12T15:20:18.407
> 
> 标签：animation, charts, highcharts

是否可以控制 HighCharts 中每条数据的动画时间？

我的意思是在以下演示的幻灯片 7 上：http: [//blackwavedesign.com/tmp/drlathian/animation_demo/index.html](http://blackwavedesign.com/tmp/drlathian/animation_demo/index.html)我希望让第一列动画，然后 5 秒后，让第二列动画，等等。我在想可能没有办法做到这一点，但也许有人知道解决方法。创建此图表的脚本位于此脚本的 buildHighCharts.js 函数中：http: [//blackwavedesign.com/tmp/drlathian/animation_demo/assets/js/drutil.js](http://blackwavedesign.com/tmp/drlathian/animation_demo/assets/js/drutil.js)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T17:05:10.407

您可以通过在图表上设置一个初始点，然后在一段时间内输入您的附加点来做到这一点。以这个[jsFiddle](http://jsfiddle.net/wergeld/nY7ve/16/)为例。

# c# - 手动调整gridview列的大小

> ID：12391471
> 
> 赞同：1
> 
> 时间：2012-09-12T15:20:20.880
> 
> 标签：c#, asp.net

我有一个在其中显示电子邮件 html 的 gridview。由于 html 的格式，这些列非常宽。如何手动设置gridview中列的大小？我试过

项目样式宽度 =

标题样式宽度 =

但这些都没有改变列宽，任何想法都将不胜感激。

谢谢，

```
 <asp:BoundField HeaderText="Message"  HeaderStyle-Width="100px" ItemStyle-Width="100px" ItemStyle-Wrap="false" HeaderStyle-Wrap="false" HtmlEncode="false" DataField="message" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:17:53.260

遵循这个模式，你就会成功，祝你好运；）

```
<asp:BoundField DataField="ISBN" HeaderText="ISBN" ItemStyle-Width="120px" HeaderStyle-Height="40px">
     <HeaderStyle Height="40px"></HeaderStyle>
     <ItemStyle Width="120px"></ItemStyle>
</asp:BoundField> 
```

# sql - 在 ms sqlserver 中循环 SELECT 语句

> ID：12391472
> 
> 赞同：5
> 
> 时间：2012-09-12T15:20:28.393
> 
> 标签：sql, sql-server

> **可能重复：**
> [SQL Server 2008 生成一系列日期时间](https://stackoverflow.com/questions/7149271/sql-server-2008-generate-a-series-of-date-times)

我必须遍历 startDate 和 endDate

SELECT 语句应该产生结果为..

预期输出：

```
------------
Date
------------
09/01/2012 -> startDate
09/02/2012
09/03/2012
.
.
.
.
09/30/2012 -> endDate 
```

我试过

```
declare @startDate datetime , @endDate endDate
set @startDate='09/01/2012'
set @endDate='09/30/2012'

while DATEDIFF(@startDate,@endDate)!=-1
begin
select @startDate as Date
set @startDate = DATEADD(day,2,@startDate)
end 
```

但它不工作..

它产生30个输出..

我希望单个输出中的日期与预期输出中的一样。

伙计们，我哪里错了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-12T15:27:09.800

每次迭代时，这将为您提供每次循环迭代的结果集`select`。

如果您希望每次迭代将单个结果集插入到临时表/变量中，然后从中选择或

```
;with T(day) as
(
    select @startDate as day
        union all
    select day + 1
        from T
        where day < @endDate
)
select day as [Date] from T 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:31:44.583

如果要使用`WHILE`循环：

```
declare @startDate datetime , @endDate datetime
set @startDate='09/01/2012'
set @endDate='09/30/2012'

create table #temp (startDate datetime)   

while @startDate <= @endDate
    begin
        insert into #temp
        select @startDate as Date
        set @startDate = DATEADD(day,1,@startDate)
    end

select *
from #temp

drop table #temp 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/93b55/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:31:07.620

您可以为这些值创建一个临时表，并在迭代后最终从中进行选择。

```
declare @temp table (TheDate date)

declare @startDate datetime , @endDate datetime
set @startDate='09/01/2012'
set @endDate='09/30/2012'

while DATEDIFF(day, @startDate, @endDate)!=-1
begin
insert into @temp (thedate) values (@startDate)
set @startDate = DATEADD(day,2,@startDate)
end
select * from @temp 
```

编辑：cte Alex 建议是 imo 一种更清洁的方法，更多的是一种 sql 方法，无需使用循环或游标。

# java - 从 applicationContext.xml 读取环境变量

> ID：12391474
> 
> 赞同：8
> 
> 时间：2012-09-12T15:20:31.443
> 
> 标签：java, xml, spring, applicationcontext

我需要阅读在我的 web.xml 中定义的环境变量

```
<env-entry>
    <description>Path Repositorio NFS</description>
    <env-entry-name>PATH_ENV</env-entry-name>
    <env-entry-type>java.lang.String</env-entry-type>
    <env-entry-value>C:/V3</env-entry-value>
</env-entry> 
```

从我的`applicationContext.xml`

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="${PATH_ENV}/myprop.properties" />
</bean> 
```

我怎样才能做到这一点 ？

* * *

最后我做了下一个：

1 在 context.xml 中定义环境变量：

```
<Environment name="PATH_ENV" type="java.lang.String"/> 
```

2 在 web.xml 中定义 env-entry

```
<env-entry>
    <description>Path Repositorio NFS</description>
    <env-entry-name>PATH_ENV</env-entry-name>
    <env-entry-type>java.lang.String</env-entry-type>
    <env-entry-value>/WEB-INF/</env-entry-value>
  </env-entry> 
```

3 在applicationContext.xml中定义

```
<bean id="configurationPath" class="org.springframework.jndi.JndiObjectFactoryBean">  
    <property name="jndiName">  
        <value>java:comp/env/PATH_ENV</value>  
    </property>  
</bean>  

<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
       <property name="location">
            <bean factory-bean="configurationPath" factory-method="concat">
                <constructor-arg value="myprop.properties"/>
            </bean>
        </property>
    </bean> 
```

这是正确运行的，但是如果我在以下位置定义完整路径：

```
<env-entry-value>C:/V3/</env-entry-value> 
```

我有下一个问题：

```
java.io.FileNotFoundException: Could not open ServletContext resource [/C:/V3/aesantasa.properties] 
```

我无法在 env-entry-value 中定义完整路径为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T09:46:23.867

您可以使用 JndiObjectFactoryBean 或查找 JNDI 条目（环境条目和资源）[`<jee:jndi-lookup>`](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/xsd-config.html#xsd-config-body-schemas-jee-jndi-lookup)：

```
<jee:jndi-lookup id="PATH_ENV" jndi-name="PATH_ENV"/> 
```

（要使用 jee 命名空间，您必须[声明](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/xsd-config.html#xsd-config-body-schemas-jee)它）。

这定义了一个名为“PATH_ENV”的spring bean，它包含（作为字符串）在环境条目中配置的路径。您现在可以将其注入其他 bean：

```
<bean class="xy.Foo">
    <property name="path" ref="PATH_ENV"/>
</bean> 
```

剩下的困难是连接字符串。（不幸的是，没有 JndiPlaceholderConfigurer 可以用 JNDI 环境条目替换占位符，因此您不能使用该`${property}/foo`语法进行连接，并且必须提供另一个 bean 定义：

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
        <bean factory-bean="PATH_ENV" factory-method="concat">
            <constructor-arg>/myprop.properties</constructor-arg>
        </bean>
    </property>
</bean> 
```

（代码未经测试，因为我手头没有 Spring 项目来测试它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:41:17.243

您可以使用`context-param`，这将起作用。

```
<context-param>
    <param-name>PATH_ENV</param-name>
    <param-value>C:/V3</param-value>
</context-param> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T10:10:01.187

为什么不只使用以下内容？

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <property name="location" value="file:C:/V3/myprop.properties"/>
</bean> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-13T17:02:13.313

我解决了一些类似的问题。

我用路径的变化部分创建了一个 Windows 系统变量：

```
my computer --> advanced options --> environment options --> Systeme Variable 
```

然后我完成了 Spring AppContext 上的路径，如下所示：

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">

   <property name="locations">  
       <list>
              <value>file:${PARENT_PATH}/conf/dev/jdbc.properties</value>
       <list>           
   </property>
</bean> 
```

我不知道是否真的有帮助，但对我有用

# jboss7.x - 使用 cargo 部署战争到远程 Jboss7 服务器

> ID：12391475
> 
> 赞同：0
> 
> 时间：2012-09-12T15:20:32.950
> 
> 标签：jboss7.x, cargo, maven-cargo

我想使用[Cargo](http://cargo.codehaus.org/)将我的 maven 生成`war`文件部署到已经运行的远程 JBoss 服务器。

我已经这样配置了`pom.xml`：

```
 ...
        <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>

            <dependencies>
                <dependency>
                    <groupId>org.jboss.as</groupId>
                    <artifactId>jboss-as-controller-client</artifactId>
                    <version>7.1.0.Final</version>
                </dependency>
            </dependencies>

            <configuration>
                <!-- Container configuration -->
                <container>
                    <timeout>300000</timeout> <!-- 5 minutes -->
                    <containerId>jboss71x</containerId>
                    <type>remote</type>
                </container>

                <!-- Configuration to use with the container -->
                <configuration>
                    <type>runtime</type>
                    <properties>
                        <cargo.hostname><myIP></cargo.hostname>
                        <cargo.jboss.management.port>9999</cargo.jboss.management.port>
                        <cargo.remote.username><myUser></cargo.remote.username>
                        <cargo.remote.password><myPass></cargo.remote.password>
                    </properties>
                </configuration>
                <!-- Deployer configuration -->
                <deployer>
                    <type>remote</type>
                </deployer>

                <!-- Deployables configuration -->
                <deployables>
                    <deployable>
                        <groupId>de.<myGroup></groupId>
                        <artifactId><myArtifact></artifactId>
                        <type>war</type>
                        <pingURL>http://<myIP>:8080/<myContextPath></pingURL>
                        <pingTimeout>60000</pingTimeout>
                    </deployable>
                </deployables>

            </configuration>
        </plugin>
    ... 
```

当然，< `my...`> 形式的所有变量都用实际值填写。

如果我使用 maven 命令运行它：

```
mvn -X cargo:deploy 
```

Maven控制台说：

```
...
Sep 12, 2012 5:06:12 PM org.xnio.nio.NioXnio <clinit>
INFO: XNIO NIO Implementation Version 3.0.3.GA
Sep 12, 2012 5:06:12 PM org.jboss.remoting3.EndpointImpl <clinit>
INFO: JBoss Remoting version 3.2.2.GA
[DEBUG] [swordCallbackHandler] Responded to a RealmCallback
[DEBUG] [swordCallbackHandler] Responded to a NameCallback
[DEBUG] [swordCallbackHandler] Responded to a PasswordCallback
[INFO] [Boss7xRemoteDeployer] The deployment has failed: org.codehaus.cargo.util.CargoException: Cannot deploy deployable org.codehaus.cargo.container.jboss.deployable.JBossWAR[myWar.war]
... 
```

在正在运行的 JBoss 服务器上，我可以在控制台中看到如下日志消息：

```
17:07:24,197 ERROR [org.jboss.remoting.remote.connection] (Remoting "pc09:MANAGEMENT" read-1) JBREM000200: Remote connection failed: java.io.IOException: Eine vorhandene Verbindung wurde vom Remotehost geschlossen. 
```

（对不起日志里面的德语。它基本上说：远程主机关闭了现有连接。）

有谁知道可能出了什么问题，或者我如何从货物中获得更多调试信息以找出问题所在？

顺便说一句：我已经使用 JBoss CLI 访问该 Jboss 服务器进行[Arquillian](http://www.jboss.org/arquillian.html)测试，所以我非常有信心通过 CLI 访问该 Jboss 服务器应该没问题。

**编辑：** 似乎我必须先取消部署。为了确保对 CLI 的访问正常，我只是使用`jboss-cli.bat`. 然后我只是巧合地取消了现有的战争，然后通过货物的部署开始工作。（我可以关闭此问题或以任何方式将其标记为已解决吗？）

# android - “不推荐使用 TabActivity 类型”对于应用程序选项卡

> ID：12391478
> 
> 赞同：3
> 
> 时间：2012-09-12T15:20:34.603
> 
> 标签：android, tabs

“不推荐使用 TabActivity 类型”？

我正在按照教程书制作应用程序的标签。

我已经从 android developer.com 网站进行了检查，但我对以下消息的重要性一无所知：`This class is deprecated.`

新的应用程序应该使用 Fragments 而不是这个类；要继续在旧设备上运行，您可以使用 v4 支持库，它提供了与 DONUT 兼容的 Fragment API 版本。"* (http://developer.android.com/reference/android/app/TabActivity .html)

1.  什么是 v4 支持库？
2.  如何完成选项卡功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T15:30:41.377

您仍然可以使用已弃用的软件包。但是，建议使用 Fragments 以及支持包。[你可以在这里](http://developer.android.com/tools/extras/support-library.html)阅读更多关于它的信息。但是，如果您是 java 和 android 开发的初学者，我建议您暂时忽略弃用，当您完成当前使用的教程后，如果您发现它具有教育意义，请返回此内容。

如果您想观看使用 Fragments 的标签式导航的一个很好的示例，请使用 android 4.0 或更高版本在 Eclipse 中创建一个新项目。确保您的 android-plugin 已更新。您将可以选择创建一个已经实现基本导航的项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T15:31:24.583

“Deprecated”表示api开发者不再推荐使用它，可能是因为[`Fragments`](http://developer.android.com/guide/components/fragments.html)引入了它的模型不是很好，或者效率低下等`Honeycomb`，可以用来提供与tabs类似的功能，更符合android当前的设计理念。

由于`Fragment`在 中引入`Android 3.0 Honeycomb`，您可能认为您不能将其用于预`Honeycomb`设备。输入[`Support Libraries`](http://developer.android.com/tools/extras/support-library.html)。它们是您可以包含在您的应用程序中的库，这些库需要预先运行`Honeycomb`并且仍然使用此类。

因此，如果您愿意，您可以`TabActivity`按照您所遵循的任何教程中的说明完成，它可能适用于更多即将推出的 android 版本。但建议您开始使用`Fragments`.

# java - Android - 获取加载的类/反射以获取包中的类？

> ID：12391481
> 
> 赞同：0
> 
> 时间：2012-09-12T15:20:45.200
> 
> 标签：java, android, sdk, android-ndk

有谁知道如何（从 Android 应用程序中）获取 Android 包中的类列表，或者如何使用与 Dalvik VM 一起使用的反射从给定包中检索类名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:40:39.053

因此对于 Android，我们可以使用 DexFile 类来枚举给定 APK 中的可见类。

```
 try {
            DexFile dexFile = new DexFile(new File("/data/app/com.uxpsystems.cepclient-2.apk"));
            Enumeration<String> enumeration = dexFile.entries();

            if (enumeration.hasMoreElements() == false){
                Logger.d(LOG_TAG, "--> Enumeration has no elements");
            }

            while (enumeration.hasMoreElements()){
                String className = enumeration.nextElement();

                if (className.substring(0, 18).equals("com.somecompany.aproduct")){
                    Logger.d(LOG_TAG, "--> Enumeration: " + className); 
                }else{
//                  Logger.d(LOG_TAG, "--> Failed match: " + className.substring(0, 18));
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

# javascript - JQM simpledialog：如何提示输入数字？

> ID：12391482
> 
> 赞同：1
> 
> 时间：2012-09-12T15:20:45.263
> 
> 标签：javascript, jquery, jquery-ui, jquery-mobile, jquery-ui-dialog

有没有

```
mode: "number" 
```

jquery.mobile.simpledialog.js 的选项？

即：我需要向用户询问一个数字，并且我希望移动键盘处于“仅限数字模式”...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:21:10.107

要显示数字键盘，请添加`type="number"`到`input`标签。在 SimpleDialog 中，您可以使用自由格式显示，例如：

```
$(document).delegate('#opendialog', 'click', function() {
  $('<div>').simpledialog2({
    mode: 'blank',
    headerText: 'Some Stuff',
    headerClose: true,
    blankContent : 
      "<input type='number' /> " +
      "<a rel='close' data-role='button' href='#'>Close</a>"
  })
})​ 
```

在支持它的浏览器上，当您尝试在`input`标签中输入内容时，您会得到一个数字键盘。不过，这不会限制桌面浏览器上的用户输入文本。您必须单独检查。

请参阅此[jsFiddle](http://jsfiddle.net/EepnZ/1/)示例。

# grails - Grails Twitter Bootstrap 插件问题与 navbar-fixed-top

> ID：12391484
> 
> 赞同：0
> 
> 时间：2012-09-12T15:20:50.537
> 
> 标签：grails, twitter-bootstrap, grails-plugin, gsp

我正在使用`Grails 2.1.0`and`[Twitter Bootstrap Plugin 2.1.1](http://grails.org/plugin/twitter-bootstrap)`遇到问题`navbar-fixed-top`。

为了使导航栏固定在页面顶部以在调整大小期间正确运行，[Twitter Bootstrap Docs](http://twitter.github.com/bootstrap/components.html#navbar)指出：

> 添加 .navbar-fixed-top 并记住通过向 .navbar-fixed-top 添加至少 40px 的填充来说明其下方的隐藏区域。请务必在核心 Bootstrap CSS 之后和可选的响应式 CSS 之前添加它。

使用 Grails Plugin for Twitter Bootstrap 时如何做到这一点？

这是我尝试过的：

**主文件**

```
<head>
  ...
  <r:require modules="bootstrap-css"/>
  <style type="text/css">
    body {
      padding-top: 60px;
      padding-bottom: 40px;
    }
    .sidebar-nav {
      padding: 9px 0;
    }
  </style>
  <r:require modules="bootstrap-responsive-css"/>
  <r:layoutResources/>
</head> 
```

问题是用于 Twitter Bootstrap 的 Grails 插件获取内容`bootstrap.css`并将`bootstrap-responsive.css`它们组合到以下合并文件中：`static/bundle-bundle_bootstrap_head.css`.

因此，我无法按照 Twitter Bootstrap 文档将主体填充样式放在“核心 Bootstrap CSS 之后和响应式 CSS 之前”。

**这是我从上面的 main.gsp 获得的查看源代码 HTML**

```
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
  .sidebar-nav {
    padding: 9px 0;
  }
</style>

<link href="/homes/static/bundle-bundle_bootstrap_head.css" type="text/css" 
    rel="stylesheet" media="screen, projection" /> 
```

如果没有办法做到这一点，我总是可以删除 Grails Twitter Bootstrap 插件并手动下载 Twitter Bootstrap 并将其放入我的 Grails 项目的`web-app/css`、`web-app/images`和`web-app/js`. 但是，我希望能够使用 Grails Twitter Bootstrap 插件。

非常感谢您，我很感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:36:14.517

Bootstrap 推荐该样式的位置，因为当屏幕宽度低于`980px`navbar 时变为`static`(not `fixed`)。`bootstrap-responsive.css`因此，在阻止移动设备顶部的空白区域之后调用`padding`（没有固定元素来填充该填充）。

您可以使用媒体查询重现此行为：

```
@media (min-width:980px) {
    body {
        padding-top: 40px;
    }
} 
```

把这个 CSS 放在你的样式表的任何地方，不用担心你的`<links>`

# php - wordpress：header.php 和 footer.php 的默认位置

> ID：12391486
> 
> 赞同：8
> 
> 时间：2012-09-12T15:20:57.817
> 
> 标签：php, wordpress, themes

这是一个非常简单的问题。我安装了 wordpress 3.4.2。我正在尝试从头开始构建主题。所以我添加了一个 style.css 文件和一个 index.php 文件。两者都只包含最低限度。现在我想知道当我从 index.php 调用 get_header() 和 get_footer() 函数时，wordpress 用来生成我网站的页眉和页脚的 header.php 和 footer.php 文件在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T15:22:20.373

在您的 wordpress 主题的根文件夹中，例如 wp-content/themes/mytheme 所以您还必须创建这些...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T17:06:52.880

在这里找到答案：http: [//codex.wordpress.org/Function_Reference/get_header](http://codex.wordpress.org/Function_Reference/get_header)。似乎默认的 header.php 和其他一些模板文件在 wp-includes/theme-compat/

# java - 我在玩 Spring、Maven 和 Eclipse，强制 Maven2 复制依赖项

> ID：12391489
> 
> 赞同：0
> 
> 时间：2012-09-12T15:21:10.553
> 
> 标签：java, eclipse, spring, maven-2

我在 Eclipse 中玩耍，试图让 Maven 将依赖项加载到我的 Springs 项目中。我是 Maven 新手，所以这让我很难过。我试图强制 Maven2 将依赖项复制到 Eclipse 中的 target/lib 中，但不知道正确的方法。

我收到以下错误：

```
Description Resource    Path    Location    Type
maven-dependency-plugin (goals "copy-dependencies", "unpack") is not supported by m2e.  pom.xml /TestSpringMaven    line 54 Maven Project Build Lifecycle Mapping Problem 
```

这是我的 POM.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.springsource.greenbeans.maven</groupId>
    <artifactId>TestSpringMaven</artifactId>
    <packaging>war</packaging>
    <version>0.0.1-SNAPSHOT</version>
    <name>TestSpringMaven Maven Webapp</name>
    <url>http://maven.apache.org</url>
    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-webflow</artifactId>
            <version>2.3.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>

    </dependencies>
    <build>
        <finalName>TestSpringMaven</finalName>

        <plugins>
                    <plugin>
                        <artifactId>maven-dependency-plugin</artifactId>
                            <executions>
                                <execution>
                                    <phase>install</phase>
                                    <goals>
                                        <goal>copy-dependencies</goal>
                                    </goals>
                                    <configuration>
                                        <outputDirectory>${project.build.directory}/lib</outputDirectory>
                                    </configuration>
                                </execution>
                            </executions>
                    </plugin>
                </plugins>

    </build>

</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:34:56.777

Eclipse 自动在构建路径中包含 Maven 依赖项。确保你`right click your project --> Maven --> Enable Dependency Management`
的 jar 文件被自动复制到`WEB-INF\lib\`你的战争中。

如果你遵循 maven 默认设置，生活会容易得多。

# axes - 用于根据单元格值设置 X 轴以穿过 Y 轴的宏

> ID：12391491
> 
> 赞同：0
> 
> 时间：2012-09-12T15:21:31.340
> 
> 标签：axes

我希望根据单元格中的值将 x 轴设置为与 y 轴交叉。有没有我可以用来完成这个的宏？

谢谢，娜塔莉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T21:23:36.490

如果有人好奇，请想办法：

```
Sub Set_Analyst_Medians()
ActiveSheet.ChartObjects("Chart 23").Activate
ActiveChart.PlotArea.Select
ActiveChart.SetElement (msoElementPrimaryValueAxisShow)
ActiveSheet.ChartObjects("Chart 23").Activate
ActiveChart.Axes(xlValue).Select
ActiveChart.Axes(xlValue).CrossesAt = Range("D38")
ActiveChart.Axes(xlValue).MaximumScale = Range("D49")
ActiveChart.Axes(xlValue).MinimumScale = Range("D50")
Selection.Delete
End Sub 
```

# android - Android：淡出屏幕时动画帧速率不佳

> ID：12391496
> 
> 赞同：1
> 
> 时间：2012-09-12T15:21:51.753
> 
> 标签：android, animation, alpha

我有一个简单的任务：当发生某些事情（比如按下按钮）时，淡出屏幕（+ 其他操作，但现在没关系）。我的 minSDKVersion 是 11。我是这样做的：活动布局包含一个视图：

```
<View
    android:id="@+id/bgFadingView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:alpha="0"
    android:background="@android:color/black" /> 
```

我淡出屏幕的方法如下：

```
protected void fadeBGView(boolean fadeIn)
{
    ObjectAnimator animator = ObjectAnimator.ofFloat(bgFadingView, "alpha", fadeIn ? 0.75f : 0f); //bgFadingView is initialized via findViewById(R.id.bgFadingView);
    animator.setDuration(1000);
    animator.start();
} 
```

换句话说，我有黑色视图，它占据了整个屏幕，当我需要淡入时，我将视图的 alpha 从 0 更改为 0.75。

问题是它的帧率很差......我看到逐帧动画褪色 - 它以大约 15fps 的速度工作。我究竟做错了什么？Android 系统淡入淡出工作得更加顺畅 - 我想获得相同的结果或关闭。如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:43:47.117

我所要做的就是：

```
ObjectAnimator.setFrameDelay(10); 
```

默认帧延迟太长，所以我的动画运行不顺畅。问题不是由于设备性能限制。

# hibernate - 映射 java.util.map 在休眠中使用 JPA 注释

> ID：12391498
> 
> 赞同：2
> 
> 时间：2012-09-12T15:22:01.317
> 
> 标签：hibernate, jpa, map, annotations

我似乎在映射休眠中的集合时遇到问题，其中键和资源都是休眠要映射的实体。

而从文档（我这个问题的主要资源是这个，但我当然欢迎任何其他资源： http: [//docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/collections.html](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/collections.html) ) 看起来这应该是一个相对简单的任务，我似乎无法让地图的密钥持久化。

我的代码看起来像这样：

父类：

```
@Entity
public class Parent {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;
    @MapKey
    @MapKeyClass(Key.class)
    @ManyToMany(cascade = CascadeType.ALL)
    private Map<Key, Resource> map; 
```

关键类：

```
@Table(name="ParentKey")
@Entity
public class Key implements Comparable<Key> {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;
    @Column(name = "hierarchyKey")
    private int key; 
```

资源类是一个相对简单的 POJO，并且可以很好地持续存在，所以我认为问题不在该类中。

我确实在休眠论坛的一些文档中遇到了注释@MapKeyManyToMany，但我相信这已经被弃用了。

数据库的模式在这个阶段并不重要，主要关心的是确保一切都持久化到数据库中。我们将 MySQL 用于底层数据库。

我相信您可能会猜到，任何涉及单词 map、hibernate、entity 和 key 的搜索都会返回大量与此问题无关的问题，尽管我确信这一定是经常发生的情况的映射情况。

我不经常提交问题，但我是一个活跃的读者，所以如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T18:10:59.877

这按规定工作。操作不会级联到映射的键。它们仅级联到值。在[文档](http://docs.oracle.com/javaee/6/api/javax/persistence/ManyToMany.html#cascade%28%29)中，这是用以下词语讲述的：

> 当目标集合是 java.util.Map 时，级联元素适用于映射值。

密钥必须单独保存。

# c# - URI 到 XML 解析

> ID：12391500
> 
> 赞同：0
> 
> 时间：2012-09-12T15:22:07.867
> 
> 标签：c#, .net, xml, recursion, xml-parsing

我需要将 URI 地址转换为 XML 表示法。例如

```
/Test1/Test2/Test3/ 
```

到

```
<Modul>
<Test1/><Test2/><Test3/>
</Modul> 
```

这是我的代码：

```
private static XmlNode NodeRecurs(XmlNode node, string nodeName)
{
    string[] array = nodeName.Split('/');
    var xdoc = new XmlDocument();
    var name = nodeName.Remove(0, array[0].Length + 1);
    XmlNode xmlNode = xdoc.CreateNode(XmlNodeType.Element, array[0], string.Empty);
    node.AppendChild(xmlNode);

    if (array.Count() != 0)
    {
        NodeRecurs(node, name);
    }

    return node;
} 
```

当`NodeRecurs`调用自身时，它是`InvalidArgument`例外。它说当前节点的上下文是错误的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:26:39.410

要将节点附加到文档，它们需要由*同一个*文档创建。

每次调用函数时都会创建一个*新函数 - 在函数外部创建一个并将其作为参数传入。* `XmlDocument`

# google-apps-script - 从 Apps 脚本访问 Google Cloud SQL

> ID：12391501
> 
> 赞同：6
> 
> 时间：2012-09-12T15:22:10.357
> 
> 标签：google-apps-script, google-cloud-sql

我想知道是否有办法使用 Apps 脚本连接到我的 Google Cloud SQL DB 来执行查询。

我已经阅读了很多帖子，似乎访问 DB Cloud SQL 的唯一方法是使用 App Engine。

有人知道解决方案吗？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-23T05:09:40.130

是的，显然可以通过 JDBC 将应用程序脚本与 Google Cloud SQL 连接起来。

**从 Google Apps 脚本连接到 Google Cloud SQL 实例：** Google Apps 脚本能够通过 JDBC 与 Jdbc 服务建立连接。

**授权：** 为了连接到实例，用户必须是相关 Google API 控制台项目的成员。或者，可以指定用户名和密码以应用更细粒度的权限。要了解有关访问控制的更多信息，请参阅[访问控制文档](https://developers.google.com/cloud-sql/docs/access_control)

**访问 Google Cloud SQL 数据库：** 我们可以在 Apps Script 中使用特殊方法 getCloudSqlConnection 连接到这些数据库。此方法的工作方式与*getConnection*相同，但仅接受 Google Cloud SQL 连接字符串。

```
var conn = Jdbc.getCloudSqlConnection("jdbc:google:rdbms://instance_name/database_name"); 
```

连接后，您可以使用与任何 MySQL 数据库相同的代码。

**写入数据库：** 此代码将在数据库的人员表中插入一条记录

```
function insert() {
  var fname="First Name"
  var lname="Last Name"
  var conn = Jdbc.getCloudSqlConnection("jdbc:google:rdbms://instance_name/database_name");
  var stmt = conn.createStatement()
  var query="insert into person(FNAME,LNAME) values('"+fname+"','"+lname+"')"
  stmt.execute(query)
  stmt.close()
  conn.close()
 } 
```

**从数据库中读取：** 此代码将从数据库中读取。

```
function read() {
  var conn = Jdbc.getCloudSqlConnection("jdbc:google:rdbms://instance_name/database_name");
  var stmt = conn.createStatement()
  var query="select FNAME, LNAME from person"
  var rs= stmt.executeQuery(query)
  while(rs.next()){
    Logger.log("First Name : "+rs.getString(1)+" , "+"Last Name : "+rs.getString(2))
  }
  rs.close()
  stmt.close()
  conn.close()
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-10T05:29:13.530

在您的 Google Developers 控制台中，单击概览，向下到页面中间单击，如何连接到您的云 SQL 实例，然后单击链接。接下来选择 Java 作为语言，直到找到从外部网络连接，找到您的 url。

它应该是这样的：

```
url = "jdbc:mysql://your_address?user=root"; 
```

如果启用 IPv4（000.000.000.00 格式的数字）

复制 url 省略 ?user=root";

粘贴到`var conn = Jdbc.getConnection("jdbc:mysql://your_address/`

添加`/db_name`和完成的代码行应该看起来像这样。

```
var conn = Jdbc.getConnection("jdbc:mysql://your_address/db_name”, user, userPwd); 
```

要记住的两件事

1.  允许 App 脚本网络 ID 的第一个

2.  提前创建数据库以从 Apps 脚本写入数据，这让生活变得更加轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:52:20.240

现在还没有任何解决方案可以从 GAS 连接到 Google Cloud SQL DB，而且尚不清楚何时引入。[这](http://code.google.com/p/google-apps-script-issues/issues/detail?id=931)是问题跟踪器上的一个问题，[这里](https://groups.google.com/forum/?fromgroups=#!topic/google-cloud-sql-discuss/Pgg_r2kQnMM)是 Google Cloud SQL 组上有关此问题的讨论。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-12T15:30:35.567

我认为连接到 Google Cloud Sql DB 的唯一方法是通过 AppEngine。

# iis - 如何绕过负载均衡器

> ID：12391502
> 
> 赞同：0
> 
> 时间：2012-09-12T15:22:10.543
> 
> 标签：iis, load-balancing, hosts

我的团队昨晚部署了我们的站点，今天早上发现了一个错误，再次部署，现在我们所有的站点都关闭了。我们的站点使用负载平衡器，并且都在同一个 IIS 应用程序池上运行。我们多次尝试重新启动 IIS 均无济于事，这导致我们认为这是负载均衡器的问题。是否可以使用主机文件绕过负载均衡器，还是有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:30:18.770

每台服务器上的网卡都有自己的ip地址，在负载均衡器发布的ip地址之上，你可以将你的dns记录重置为这个地址。

请记住，这会将您带到单个服务器，但鉴于您目前没有服务器...

# jquery - 从jQuery提交的表单中排除div？

> ID：12391503
> 
> 赞同：1
> 
> 时间：2012-09-12T15:22:12.823
> 
> 标签：jquery, html, submit

当我通过 jQuery 提交表单时，如下所示`jQuery('#myForm').submit()`：
我不想在该表单内的指定 div 中发送一些信息（我的意思是所有输入字段、选择元素、textarea 元素等都不允许发送到服务器），但我不知道要防止该 div与所有者表格一起提交。
你能帮我解决这个问题吗？太感谢了。

* * *

谢谢大家的快速回复。我试图将该div中所有输入字段的“禁用”属性设置为false，但是当我在服务器上再次检查时，仍然提交了一些其他字段（例如select，textarea）。我想我也应该禁用它们。有没有办法在不禁用每种输入元素的情况下删除或“隐藏/禁用”整个 div？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:29:04.850

像这样的事情应该这样做：

```
$('div#excludeMyInputs input').prop("disabled",true);
$('#myform').submit();
$('div#excludeMyInputs input').prop("disabled",false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:25:51.610

我会说，如果您有一个带有输入的表单并且您不想将这些输入的值发送到某处，那么您可能会错误地处理它。

但是，您可以将这些表单元素放在表单元素之外**（**`#myForm`例如，在名为 的第二个表单中`#myForm2`），然后这些输入将被忽略，`jQuery('#myForm').submit();`但它们仍会显示在页面上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:25:55.483

上[一篇文章](https://stackoverflow.com/questions/4869987/how-do-i-exclude-certain-form-fields-upon-submission-of-the-form-without-disabli)可能对您有所帮助。看起来您最好的选择是在调用 .submit() 之前禁用或删除 div 中的表单元素

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T15:32:40.673

您可以使用 $.ajax 函数来选择要发送的数据：

```
$(document).on('submit','#myForm',function(e) {
  e.preventDefault();
  $.ajax({
    url:$(this).attr('action'),
    type:'post',
    data:{
      input1:$('#input1').val(),
      input2:$('#input2').val()
      // etc etc
    },
    success:function(data) {
      console.log(data);
    },
    error:function(jqXHR, textStatus, errorThrown) {
      console.log(errorThrown);
    }
  });
}); 
```

# asp.net - .NET MVC 3 (C#) 默认会员提供程序 - 如何设置？

> ID：12391506
> 
> 赞同：2
> 
> 时间：2012-09-12T15:22:27.120
> 
> 标签：asp.net, asp.net-membership

我对 .NET 的会员提供商有些困惑。我已经构建了一个 MVC 3 Web 应用程序，但显然登录页面不能开箱即用，因为我需要连接一个会员提供程序。我本来希望这个过程很简单，但是当我寻求帮助时，我发现了许多关于编写自定义提供程序的文章。我不能只设置一个或两个表，在 web.config 中连接一些详细信息，然后根据一些默认的 MVC 成员资格提供程序来工作吗？

我不想重新发明轮子！

TIA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:33:51.037

[MSDN 成员资格安装文档](http://msdn.microsoft.com/en-us/library/ff648345.aspx)仍然适用于 .NET 4，但请注意默认成员资格提供程序在 4.5 中发生了变化——完全不同的表结构。

**TL;博士**

*   创建 aspnet 成员数据库*或*将表添加到现有数据库（`aspnet_regsql.exe`位于 .net 2 框架文件夹中）

*   将必要的成员资格和角色提供程序配置部分添加到您的 web.config。

*   使用站点管理工具添加用户（或至少一个初始管理员用户）

# java - 在 JavaFX 2.2 桌面应用程序中嵌入 Google 地图会引发异常并且通常不执行

> ID：12391508
> 
> 赞同：7
> 
> 时间：2012-09-12T15:22:39.613
> 
> 标签：java, google-maps, webview, javafx-2

我有一个项目需要在桌面 Java 应用程序中嵌入谷歌地图。经过一些研究，我发现 Java FX 确实提供了此功能，并着手编写示例应用程序作为 PoC。该应用程序工作，一切都很好。升级到新的 7u7 java 版本后，我的代码不再像以前那样工作了。代码运行并显示网页，但没有向网页（谷歌地图）触发手势（平移/缩放）事件，并且由于某种原因，当我单击并拖动（好像平移）时，我得到了包含的异常，我无法理解。

我非常感谢有人在 JavaFX 2.2 应用程序中嵌入谷歌地图的任何见解。提前感谢您的任何帮助和/或建议

以下是我的应用程序代码/HTML 代码和引发的异常：

JavaFX 代码：

```
 private Scene scene;
    private MyBrowser myBrowser;
    private LocationClickHandler handler;
    private Vector<Button> buttons;
    //private Moderator moderator;

    /**
     * @param args the command line arguments
    */
   public static void main(String[] args) {

      launch(args);
   }

    @Override
      public void start(Stage primaryStage) {

  buttons = new Vector<Button>();
  //moderator = new Moderator();
  handler=new LocationClickHandler();

  primaryStage.setTitle("java-buddy.blogspot.com");

  myBrowser = new MyBrowser();
  //moderator.registerAddIconListener(myBrowser);
  VBox mainbox = new VBox();
  mainbox.getChildren().add(myBrowser);

 // mainbox.getChildren().add(generateEntitiesButtonBox());
//  mainbox.getChildren().add(generateSensorsButtonBox());
  scene = new Scene(mainbox, 1280, 760);

  primaryStage.setScene(scene);

  primaryStage.show();

 }

    class MyBrowser extends Region {

  HBox toolbar;

  WebView webView = new WebView();
  WebEngine webEngine = webView.getEngine();

  public MyBrowser(){
      webView.setMinSize(1280, 400);
      final URL urlGoogleMaps = getClass().getResource("googlemaps2.html");
      webEngine.load(urlGoogleMaps.toExternalForm());

      getChildren().add(webView);
      /*webEngine.getLoadWorker().stateProperty().addListener(
              new ChangeListener<State>() {  
                @Override public void changed(ObservableValue<? extends State> ov, State oldState, State newState) {
                  if (newState == State.SUCCEEDED) {
                    JSObject win = (JSObject) webEngine.executeScript("window");
                    win.setMember("java", handler);
                  }
                }
              });*/

  } 
```

加载到 Web 视图中的 HTML：

```
 <!DOCTYPE html>
    <html>
    <head>
    <title>Java-Buddy: Google Maps</title>
    <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <style>#mapcanvas { height: 500px; width: 100%}</style>

    <script type="text/javascript">
    var map;
    var icon="icons/Tank.png";
    var last_clicked;
    var elliptical=0;

    var sensors = new Array();
    var sensors_to_targets = new Array();
    var targets = new Array();
    var target_paths = new Array();
    var target_polys = new Array();

    var counter =0;
    //var marker;

    function loadmap(){

      var options = {
          zoom: 16,
          center: new google.maps.LatLng(51.507222, -0.1275),
          mapTypeId: google.maps.MapTypeId.SATELLITE,
          streetViewControl: false
      }
      map = new google.maps.Map(document.getElementById("mapcanvas"), options);
      google.maps.event.trigger(map,'resize');  
      google.maps.event.addListener(map, 'click', function(event) {

        java.saveLocation(event.latLng.lat(),event.latLng.lng());

       });

      }

    </script>

    </head>
    <body onload="loadmap()">
    <div id="mapcanvas"></div>
    </body>
    </html> 
```

在 Web 视图中拖动时抛出的异常：

```
java.lang.NullPointerException: Clipboard.putContent: null data
at com.sun.javafx.tk.quantum.QuantumClipboard.putContent(QuantumClipboard.java:442)
at javafx.scene.input.Clipboard.setContent(Clipboard.java:226)
at com.sun.webpane.sg.UIClientImpl.confirmStartDrag(UIClientImpl.java:178)
at com.sun.webpane.platform.WebPage.confirmStartDrag(WebPage.java:861)
at javafx.scene.web.WebView$19.handle(WebView.java:1204)
at javafx.scene.web.WebView$19.handle(WebView.java:1201)
at com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:69)
at com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:217)
at com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:170)
at com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:38)
at com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:37)
at com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:92)
at com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:35)
at com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:92)
at com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:53)
at com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:33)
at javafx.event.Event.fireEvent(Event.java:171)
at javafx.scene.Scene$DnDGesture.fireEvent(Scene.java:2627)
at javafx.scene.Scene$DnDGesture.process(Scene.java:2706)
at javafx.scene.Scene$DnDGesture.access$8700(Scene.java:2603)
at javafx.scene.Scene$MouseHandler.process(Scene.java:3340)
at javafx.scene.Scene$MouseHandler.process(Scene.java:3164)
at javafx.scene.Scene$MouseHandler.access$1900(Scene.java:3119)
at javafx.scene.Scene.impl_processMouseEvent(Scene.java:1559)
at javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2261)
at com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:228)
at com.sun.glass.ui.View.handleMouseEvent(View.java:528)
at com.sun.glass.ui.View.notifyMouse(View.java:922)
at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
at com.sun.glass.ui.win.WinApplication.access$100(WinApplication.java:29)
at com.sun.glass.ui.win.WinApplication$3$1.run(WinApplication.java:73)
at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T22:38:52.420

根据 Sergey 链接的问题，此问题的一部分似乎是由[Google Maps v3 api](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4238)中的错误引起的，并且是在浏览器中启用触摸事件的结果（平移不适用于 Chrome with touch 中的 Google Maps v3 api事件也启用）。

JavaFX 2.0.x（和 2.1.x）webview 没有实现触摸事件，但 JavaFX 2.2 实现了，因此两者之间的行为差​​异的原因之一。

作为一种解决方法，您可以使用不包含此错误[的 google maps api v2](https://developers.google.com/maps/documentation/javascript/v2/reference)（至少在该版本的 api 于 2013 年 5 月 19 日下线之前）。或者您可以使用 JavaFX 2.1，直到 JavaFX 团队和 Google 实施修复/解决方法。或者，您可以继续寻找其他解决方法，例如 Sergey 建议的解决方法或其对您有用的变体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T16:50:30.743

这看起来像 WebView 中的一个错误，我会归档它。

作为一种解决方法，您可以为您的 WebView 提供一个空的拖动处理程序：

```
 webView.setOnDragDetected(new EventHandler<MouseEvent>() {

            @Override
            public void handle(MouseEvent t) {
                // intentionally do nothing
            }
        }); 
```

# javascript - 主干视图访问方法变量

> ID：12391512
> 
> 赞同：1
> 
> 时间：2012-09-12T15:22:50.710
> 
> 标签：javascript, backbone.js

可能是一个简单的问题......如何访问backbone.js 视图中的变量？

```
initialize: function() { //all init here }
render: function() {//all render here }

printFoo: function(event) {
   var printVar = this.changeFoo.changeVar  // how do I access changeVar  here???
}

changeFoo: function(event) {
  var changeVar = $(e.currentTarget).attr('id');
} 
```

如何访问 changeVar ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:25:33.153

简短的回答，你不能。

原因：`changeVar`是`changeFoo`.

您可以*提升* `changeVar`成为外部对象的成员。在这种情况下，、和可以`changeVar`访问。`initialize``render``printFoo``changeFoo`

```
function ConstructorFunctionName(){
    var changeVar = 'foo';
    /*this.changeVar = 'foo'; // this can also be used */

    this.initialize = function() { //all init here };
    this.render = function() { //all render here };

    this.printFoo = function(event) {
       var printVar = changeVar;
    };

    this.changeFoo = function(event) {
      this.changeVar = $(e.currentTarget).attr('id');
    };
} 
```

[http://jsfiddle.net/Njwdx/](http://jsfiddle.net/Njwdx/)

# c# - C# REST WebClient POST 问题

> ID：12391514
> 
> 赞同：0
> 
> 时间：2012-09-12T15:22:54.557
> 
> 标签：c#, windows-phone-7, rest, post, webclient

我正在尝试通过 POST 方法将数据上传到 REST 服务，但由于某些原因，服务器告诉我：

> System.Net.WebException：远程服务器返回错误：NotFound。

我正在尝试使用以下代码上传数据：

```
WebClient addserving = new WebClient();
addserving.Credentials = new NetworkCredential(username.Text, passwort.Password);

addserving.Encoding = System.Text.Encoding.GetEncoding("ISO-8859-1");
addserving.Headers[HttpRequestHeader.ContentType] = "application/x-www-form-urlencoded";
addserving.UploadStringAsync(new Uri("http://jokr.info/api/v8/diary/add_item.xml&apikey=123456&item_id=1240&serving_id=1566"), "POST");
addserving.UploadStringCompleted += new UploadStringCompletedEventHandler(serving_UploadStringCompleted); 
```

API的文档告诉我这样发布：

```
Rate Limit: Yes
HTTP Methods: POST
Authentication: Basic authentication (Username or E-Mail and Password)
Formats: xml
Parameters: format, apikey [GET], activity_id [POST], activity_duration [POST], activity_kj [POST], timestamp [POST] (optional) 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:24:56.703

你不应该有一个`?`在陈述查询参数之前而不是`&`

`http://jokr.info/api/v8/diary/add_item.xml?apikey=123456&item_id=1240&serving_id=1566`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:25:23.190

您缺少一个问号来标记 hte 参数集合的开始。

改变

```
http://jokr.info/api/v8/diary/add_item.xml&apikey=123456&item_id 
```

到

```
http://jokr.info/api/v8/diary/add_item.xml?apikey=123456&item_id 
```

# javascript - Dojo 工具提示未在 Internet Explorer 中显示

> ID：12391515
> 
> 赞同：2
> 
> 时间：2012-09-12T15:22:55.480
> 
> 标签：javascript, jquery, css, dojo

我在下面有这段代码可以在文本旁边显示工具提示。

该代码在 Firefox 和 chrome 中可以正常工作，但在 IE 8 和 IE9 中无法正常工作

```
var gridTooltip = new Tooltip({
                connectId: "grid1",
                selector: "td",
                position: ["above"],
                getContent: function(matchedNode){
                    var childNode = matchedNode.childNodes[0];
                    if(childNode.nodeType == 1 && childNode.className == "user") {
                        this.position = ["after"];
                        this.open(childNode);
                        return false;                
                    }
                    if(matchedNode.className && matchedNode.className == "user") {
                        this.position = ["after"];            
                    } else {
                        this.position = ["above"];                               
                    }

                    return matchedNode.textContent;
                }
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:34:45.433

IE 不支持 textContent 我不认为...

尝试改变：

```
return matchedNode.textContent; 
```

至：

```
return matchedNode.textContent || matchedNode.innerText; 
```

或使用innerHTML。

# qt - 如何在Qt中获取drawItemText的结束位置

> ID：12391517
> 
> 赞同：2
> 
> 时间：2012-09-12T15:22:59.283
> 
> 标签：qt, qpainter

我正在尝试通过子类化并覆盖paintEvent来自定义QPUshButton。我正在写文本，然后是如下图标：

```
paintEvent(QPaintEvent *paint)
    {
         QStyleOption opt;
         opt.init(this);
         QPainter p(this);
        //Draw the base
         style()->drawPrimitive(QStyle::PE_Widget, &opt, &p, this);

        //Draw the text
         style()->drawItemText(&p,this->rect(),Qt::AlignCenter,(this->palette()), true, this->text());

    //How do I make the image immediately follow the text

         if(!this->icon().isNull())
            //Draw the icon at 75% button height
            style()->drawItemPixmap(&p, this->rect(),Qt::AlignRight|Qt::AlignVCenter, this->icon().pixmap(this->rect().height()  * 0.75));

    } 
```

我居中对齐文本，右对齐图标。但是，这会导致文本和图标之间出现间隙。有什么办法让我在文本之后立即绘制图标，而不是对齐？

换句话说，有没有办法获得**drawItemText**完成的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T17:04:24.263

[QStyle::itemTextRect()](http://qt-project.org/doc/qt-4.8/qstyle.html#itemTextRect)将告诉你文本将在给定的矩形、字体度量和对齐方式下放置在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:31:59.097

[QFontMetrics](http://doc.qt.nokia.com/4.7-snapshot/qfontmetrics.html)会告诉你你的文本有多宽。它不知道您的矩形，因此您必须自己进行对齐计算。

# java - 如何使用 libgdx 资产管理器正确加载纹理

> ID：12391518
> 
> 赞同：12
> 
> 时间：2012-09-12T15:23:09.383
> 
> 标签：java, android, libgdx

这是如何正确地将纹理加载到`AssetManager`?

```
Texture tex;
AssetManager manager = new AssetManager();
manager.load("menu/bg.png",Texture.class);
tex = manager.get("menu/bg.png",Texture.class); 
```

纹理无法加载并出现错误“无法加载纹理菜单/bg.png”。

我们应该如何使用`AssetManager`?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-13T15:53:57.913

这几乎就是 AssetManager 应该使用的方式，但不完全是这样。**我建议在 wiki 上阅读有关[libgdx AssetManager](https://github.com/libgdx/libgdx/wiki/Managing-your-assets)的信息。**

几点：
变量应该是驼峰式，所以 AssetManager *manager* ... 而不是 AssetManager *Manager*。

您需要致电`manager.update()`；真正让它加载东西。这将需要调用，直到`manager.update()`; 返回true，然后加载完成。因此，您可以制作一个调用`manager.update();`每个帧的加载屏幕，当它返回 true 时，您切换到其他屏幕。
如果您只想加载所有内容并阻止直到加载，请`manager.finishLoading();`在尝试从管理器获取任何内容之前调用。

您可能必须在`assets`名为的文件夹中创建一个文件夹`data`并将您的资产放在那里，而不是直接将它们放在资产文件夹中。因此，将您的资产放入`mygame-android\assets\data`而不是`mygame-android\assets`.

如果您使用 gdx-setup-gui 创建项目，应该没问题。但如果没有，您的桌面项目也需要知道在哪里可以找到资产。

关于如何[使用 libgdx 创建动画、响应式加载屏幕的示例](https://github.com/Matsemann/libgdx-loading-screen)。（[视频](http://www.youtube.com/watch?v=gpI2U_9jDak)）

# javascript - Javascript Reg ex 匹配文本

> ID：12391525
> 
> 赞同：0
> 
> 时间：2012-09-12T15:23:29.437
> 
> 标签：javascript

如何检查特定文本是否单独存在于单词中或单词的一部分中？我理解下面的代码，但它是单独工作的。我正在寻找一个表达式，它也将返回 TRUE 以进行测试，重新测试但 False 用于 test0123,123test。非常感谢任何帮助

```
var string_1 = "test";
var string_2 = "retests";

/\btest\b/g.test(string_1);//TRUE

/\Btest\B/g.test(string_2);//TRUE 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:29:27.013

你是这个意思吗？

```
/([^\d]+|\b)test([^\d]+|\b)/g.test(string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:32:39.777

只需查找已测试或重新测试的显式单词：

```
/\b(tested|retest)\b/gi 
```

围绕这两种选择，单词边界仍然存在。

# c++ - 带有时间戳的自定义打印功能发出警告

> ID：12391528
> 
> 赞同：0
> 
> 时间：2012-09-12T15:23:37.600
> 
> 标签：c++, c, timestamp, printf

我制作了一个自定义打印功能，它打印带有时间戳的消息。但是当我编译它时，编译器会说“格式字符串不是字符串文字”。它仍然可以正常编译，但我有点被这个错误困扰，因为编译器还说这可能不安全，所以我想修复它。

```
void Log(const char *message, ...)
{
    time_t rawtime;
    struct tm* timeinfo;
    char timestamp[11];

    time(&rawtime);
    timeinfo = localtime(&rawtime);

    strftime(timestamp, 11, "%X: ", timeinfo);

    fprintf(stdout, timestamp); // format not a string literal and no format arguments [-Wformat-security]

    va_list args;
    va_start(args, message);
    vfprintf(stdout, message, args);
    va_end(args);
    fprintf(stdout, "\n");
} 
```

我尝试将其更改`timestamp`为 a`const char*`但随后`strftime`不接受它并且警告仍然存在。

我该如何解决这个问题，有没有办法优化这个功能（因为我不太了解`C IO library`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:40:27.370

```
fprintf(stdout, timestamp); 
```

`fprintf`用于由格式字符串引导的格式化输出。不带参数调用但格式字符串有点误用，并且启动速度很慢。为了安全使用`fprintf`，您应该使用`fprintf (stdout, "%s", timestamp);`

或者，只需使用`fputs (timestamp, stdout);`This 绕过格式字符串的解析，并按原样将字符串打印到标准输出。这正是您想要的，而且速度更快，因为`fputs`不解析要打印的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:25:33.793

```
fprintf(stdout, "%s", timestamp); 
```

问题是，如果您的时间戳字符串包含 %s 或类似字符串，则 fprintf 函数将寻找一个额外的参数（您没有提供）。

# android - android - 布局 - 调整 ImageButtons 的大小？

> ID：12391532
> 
> 赞同：0
> 
> 时间：2012-09-12T15:23:48.813
> 
> 标签：android, layout, resize, tablelayout

我写了一个布局。在布局上有 5 个按钮。

```
http://imageshack.us/photo/my-images/607/layout.gif/ 
```

这是我的表格布局：

```
<TableLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:shrinkColumns="0,1"  android:stretchColumns="*">

<TableRow
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:gravity="center_horizontal">
    <TextView
        android:layout_width="match_parent" 
        android:layout_height="wrap_content"
        android:textSize="14dp" 
        android:text="Hello"  
        android:layout_span="5"
        android:paddingTop="27dp"
        android:paddingBottom="25dp"
        android:textColor="#ffffff" 
        android:gravity="center" />
</TableRow> 

<TableRow>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

    <FrameLayout
        android:layout_weight="0.2">
        <ImageButton
            android:id="@+id/ImageButton1"
            android:background="@drawable/ImageButton1"
            android:layout_width="97dp"
            android:layout_height="90dp" 
            android:layout_gravity="center"
            android:scaleType="center"
             />
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
       <ImageButton
            android:id="@+id/ImageButton2"
            android:layout_width="97dp"
            android:layout_height="90dp"
            android:background="@drawable/ImageButton2"
            android:layout_gravity="center"
            android:scaleType="center" />           
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
       <ImageButton
            android:id="@+id/ImageButton3"
            android:layout_width="97dp"
            android:layout_height="90dp"
            android:background="@drawable/ImageButton3"
            android:layout_gravity="center"
            android:scaleType="center" />
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

</TableRow>

<TableRow>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

    <TextView
            android:textSize="12dp" 
            android:text="Text1"  
            android:padding="3dp"
            android:textColor="#fff" 
            android:gravity="center" />   

    <TextView
            android:textSize="12dp" 
            android:text="Text2"  
            android:padding="3dp"
            android:textColor="#fff" 
            android:gravity="center" />  

    <TextView
            android:textSize="12dp" 
            android:text="Text3"  
            android:padding="3dp"
            android:textColor="#fff" 
            android:gravity="center" />  

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

</TableRow>

<View
    android:layout_height="30dp" />

<TableRow>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

    <FrameLayout
        android:layout_weight="0.2">

        <ImageButton
            android:id="@+id/ImageButton4"
            android:layout_width="97dp"
            android:layout_height="90dp"
            android:background="@drawable/ImageButton4"
            android:scaleType="center"
            android:layout_gravity="center" />
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
        <ImageButton
            android:id="@+id/ImageButton5"
            android:layout_width="97dp"
            android:layout_height="90dp"
            android:background="@drawable/ImageButton5
            android:scaleType="center"
            android:layout_gravity="center" />        
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>

    <FrameLayout
        android:layout_weight="0.2">
    </FrameLayout>   

</TableRow>

</TableLayout> 
```

在我的大智能手机上一切正常。但是当我用我的小智能手机看它时，底部屏幕上没有足够的空间了。我该如何更改它，以便表格布局可以缩放所有内容。

我在这里通过图像按钮给出了这个：

```
android:layout_width="97dp"
android:layout_height="90dp" 
```

这就是为什么小型智能手机底部没有足够空间的原因。表格布局应缩放图像按钮。图像按钮不是方形的。它像矩形。

表格布局应为水平 100% 和垂直 100%。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:53:54.310

我认为问题是由于缩放，而不是根据屏幕尺寸缩小。您需要为所有三个类别 hdpi 、 mdpi 和 ldpi 制作具有适当密度的新可绘制对象。

要计算您需要的密度，您可以使用此工具 [http://labs.skinkers.com/content/android_dp_px_calculator/](http://labs.skinkers.com/content/android_dp_px_calculator/)

缩放取决于屏幕尺寸和屏幕密度两件事。

有关更多信息，您可以查看[开发人员网站](http://developer.android.com/guide/practices/screens_support.htmlhttp://developer.android.com/guide/practices/screens_support.html)，您会发现 android 如何粗略地缩放图像 ![在此处输入图像描述](../Images/24870f041941cf0a3f2ae266a2ec6320.png)

# c# - 在代码隐藏中注册 Javascript 块：RegisterClientScriptBlock 问题

> ID：12391534
> 
> 赞同：1
> 
> 时间：2012-09-12T15:23:49.247
> 
> 标签：c#, javascript, asp.net

**设想**

BasePage.cs 实现 System.Web.UI.Page。它是一个没有 aspx 的超类，**所有实际页面**都是从那里派生的。

我正在使用[RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/btf44dc9.aspx)在 BasePage 中注册一些 javascript ：

```
public class BasePage : System.Web.UI.Page
{

  protected virtual void Page_Load(object sender, EventArgs e)
  {
    ClientScriptManager cs = Page.ClientScript;
    Type csType = this.GetType();
    cs.RegisterClientScriptBlock(csType, "handler", @"<script language='javascript' type='text/javascript'>alert('Something stupid!');</script>");
  }
} 
```

我在模拟中测试了这个片段：它工作正常。然后我在 BasePage.cs 中插入了代码片段。在 index.aspx 中，脚本没有被执行。浏览器调试显示：

*   没有脚本被注册
*   没有显示控制台错误

在所有其他页面中，它都可以正常工作。

**问题**

是否有与该`RegisterClientScriptBlock()`方法相关的任何具体问题？

**评论**

很抱歉，我不允许发布整个 index.aspx 页面代码。但也许如果你有线索，那么我可以给你更多的细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:15:55.337

最终，我的一位同事建议用标签包装 index.aspx 标记`form`。这已经足够了，现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:42:42.390

您是否在浏览器中检查了 ViewSource 选项。它将帮助您了解如何将脚本编写为最终输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:42:44.190

正如我所评论的：我相信将您标记`Page_Load`为 as`virtual`可能意味着您的后代页面以某种方式覆盖它，然后不调用`base`( `Base Page`) 版本，导致脚本未注册。

# netbeans - Mac OS Mountain Lion上基于JDK7的Netbeans 7.2频繁崩溃

> ID：12391537
> 
> 赞同：1
> 
> 时间：2012-09-12T15:23:58.037
> 
> 标签：netbeans, netbeans-7, netbeans-7.2

我在安装了 Mountain Lion 的 macbook pro 上使用最新版本的 Netbeans (7.2)，它让我经常崩溃。是只有我一个人，还是一般问题，谁负责山狮、netbeans 或jdk7？

（本机默认的 java 版本是 java 7 - 你可以在 System Preferences->Java 中设置）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T17:09:08.080

我会说 Java 7。我（在 Lion 上）短暂地尝试过它，但它有严重的问题。例如[，在 OS X Lion 上使用 Java 7 中的 JTables 对 setValueAt 的虚假调用？](https://stackoverflow.com/questions/11553197/spurious-calls-to-setvalueat-with-jtables-in-java-7-on-os-x-lion)

我一直在 Lion 上运行带有 Java 6 的 Netbeans 就好了。

IIRC，netbeans 将记录问题（异常等...），您可能希望在 ~/.netbeans 目录中查看（确切名称可能会有所不同），以便提交给 Netbeans 或作为 Java 错误来提供帮助。

# php - 以预先确定的顺序在 php 中显示来自 xml 的数据

> ID：12391538
> 
> 赞同：1
> 
> 时间：2012-09-12T15:23:58.877
> 
> 标签：php, xml

我还在学习如何在 php 中处理 xml 数据，

这是我上一个问题[流控制的第二部分，具体取决于 xml 元素的值](https://stackoverflow.com/questions/12352300/flow-control-depending-on-value-of-xml-element)。

现在我需要能够根据“PRICE”标签以降序或升序显示项目，

这是到目前为止的代码：

```
<?php
$itm = $_GET['itm'];
$ITEMSS = new SimpleXMLElement('items.xml', null, true);

echo <<<EOF
<table width="100%" align="center" border="1" bordercolor="#0099ff" cellpadding="1" cellspacing="0">

<tr>
        <th bgcolor="#66ccff"><span class="style4">ITEM Name</span></th>
        <th bgcolor="#66ccff"><span class="style4">item TYPE </span></th>
        <th bgcolor="#66ccff"><span class="style4">item DESCIPTION </span></th>
        <th bgcolor="#66ccff"><span class="style4">item PRICE</span></th>
</tr>

EOF;
foreach($ITEMSS as $ITEMS) // loop through our DATAS
{
if($ITEMS->TITLE=="$itm")
{
    echo <<<EOF
    <tr height="30" align=middle>
        <td>{$ITEMS->TITLE}</td>
        <td>{$ITEMS->TYPE}</td>
        <td>{$ITEMS->DESCIPTION}</td>
        <td>{$ITEMS->PRICE}</td>
    </tr>

EOF;
}
}

echo '</table>';
?> 
```

这是 xml 树： http: [//fast-ptp.fr.cr/xml/items.xml](http://fast-ptp.fr.cr/xml/items.xml)

这是我正在测试的页面：

[http://fast-ptp.fr.cr/xml/items.php](http://fast-ptp.fr.cr/xml/items.php)

# marklogic - 如何从元素范围索引中检索构面值？

> ID：12391541
> 
> 赞同：0
> 
> 时间：2012-09-12T15:24:10.717
> 
> 标签：marklogic

我在某些元素上创建了元素范围索引。现在我想将这些值显示为方面。从数据库中获取构面的优化方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:54:41.970

只需使用 search:search 工具，它已经尽可能使用所有可用的索引。添加元素作为范围约束，可选择关闭搜索结果。如果定义了可以生成构面结果的约束，则该函数应默认返回构面。

[http://developer.marklogic.com/pubs/5.0/apidocs/SearchAPI.html#search:search](http://developer.marklogic.com/pubs/5.0/apidocs/SearchAPI.html#search:search)

！

# php - 从 opencart 中的支付控制器更新结帐评论

> ID：12391542
> 
> 赞同：1
> 
> 时间：2012-09-12T15:24:11.500
> 
> 标签：php, checkout, opencart

如何从 opencart 中的支付控制器更新结帐评论。或者如果它还没有设置，有没有办法设置它？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:54:13.187

只需将值添加到

```
$this->session->data['comment'] 
```

就那么简单。您当然可以先检查它是否为空，并在需要时附加一个值

# objective-c - 使用 ARC 从导航控制器弹出时保留视图控制器

> ID：12391544
> 
> 赞同：2
> 
> 时间：2012-09-12T15:24:19.410
> 
> 标签：objective-c, ios, uiviewcontroller, uinavigationcontroller, automatic-ref-counting

我有两个表视图和一个由`UINavigationController`. 当在第二个表上选择一行时，它会弹出到一个详细视图，允许更改该行表示的特定数据。我需要能够`UITableView`在`UIViewController`不丢失 UIViewControllers 中可能已更改的任何数据（按钮选择、在字段中输入的文本值等）之间切换。

基本上，一旦`UIViewController`呈现，应该能够在表格和详细视图之间来回切换而不会丢失任何数据。

问题是，当`UIViewController`从导航控制器弹出 a 时，该内存会自动释放，并且由于我使用的是 ARC，因此我不能只`retain`在`UITableView`.

我知道每次选择相应的表行时我都​​可以手动重建视图，但我觉得这可能是一个混乱的解决方案。我想到的另一个选择是保留一个 push 数组，`UIViewControllers`并在创建新行之前检查所选表行是否与现有值对应，但这也可能会变得混乱。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:41:38.310

就像你建议的那样，有几个解决方案。

由于内存问题，阵列解决方案效率极低。

您提出的第二个解决方案要优雅得多。只需在该视图控制器中编写您自己的 init 方法并使用 plist 文件中的数据初始化视图控制器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:54:56.180

您在这种来回视图中的最终愿望是您在问题中所说的：您希望在视图控制器之间切换而不会丢失在这些控制器中执行的操作的任何信息。但是，如果您考虑 MVC 模式的工作原理，您应该将视图控制器视为视图和模型之间的粘合逻辑。视图不是持久的，这就是为什么 ARC 在不再需要视图时摆脱拥有的视图控制器是合法的。相反，当您的应用程序运行时，您应该只保留模型数据：模型数据将在所涉及的视图控制器之间共享，每次都将重新创建视图控制器，并且将根据模型数据更新相应的视图。视图控制器应该保持活动状态的唯一原因是它的 alloc-init-loadView 占用太多（例如。

所以基本上你应该做的是： - 选择表 - 提取与表关联的模型数据，包括与视图控制器相关的所有信息 - 推送视图控制器；保存对模型的所有视图修改 - 当视图控制器弹出时，模型数据将仅返回 - 下次，当您再次推送视图控制器时，您将恢复模型并重新初始化视图控制器。

这种方法并不复杂，并且可以让您以简洁的方式构建应用程序。明天您可以更改您的视图控制器结构（即它的视图和逻辑），而不会影响与其他视图控制器的通信，因为这仅由模型传递管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:59:53.247

如果我正确阅读了这个问题，那么您就有一个由相同模型数据驱动的 tableView 和 detailView。在详细视图中对模型数据进行更改时，您希望这些更改保持不变。

如果您在弹出详细视图时根据控件的状态更新模型，那么这些更改将持续存在，并且在您下一次深入查看详细视图时这些更改将可见。

您没有提到表格数据采用什么形式，但我们假设它`NSArray`是`NSMutableDictionaries`. 当您点击该行时，该`didSelectRowAtIndexPath:`方法需要通过细节控制器上的属性将该数组索引中的字典传递给细节视图控制器。详细视图控制器将更新解除它的方法中的字典值。

考虑这一点的方法是使用模型-视图-控制器模式。表和明细视图数据存储在模型中；视图呈现数据；控制器负责更新模型并在视图之间导航。

# java - 具有更多字段的 ItemizedOverlay

> ID：12391548
> 
> 赞同：0
> 
> 时间：2012-09-12T15:24:31.097
> 
> 标签：java, android, overlay, parcelable

如您所知，叠加项目只有标题、消息和可绘制图像。

我想创建一个自定义项目，例如还具有以下字段：ID、街道、城市、国家。

在调用 OnTap 后，我想在列表视图中显示该信息，因此在您点击项目后，会出现一个包含指定项目的 ID、街道、城市和国家/地区的列表。

因此，据我了解，我必须创建另一个将显示该列表的活动，这意味着我必须通过 Parceling itemizedoverlay 类将数据发送到 listActivity。

我很难考虑如何做到这一点，因为当我创建该构造函数时：

```
public MyItemizedOverlay(Parcel source){
     /*
      * Reconstruct from the Parcel
      */
     Log.d("MyTag", "ParcelData(Parcel source): time to put back parcel data");

     ID = source.readInt();
     imagePath = source.readInt();
     distance = source.readFloat(); 
```

}

我收到以下错误（意味着我必须调用基本构造函数）：

> 隐式超级构造函数 ItemizedOverlay() 未定义。必须显式调用另一个构造函数

**结论：**很有可能有另一种解决方案，我相信人们已经面临过这种情况，所以我很高兴听到你的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:49:14.907

您需要按以下方式定义两个构造函数，此方法适用于我：

```
public HelloItemizedOverlay(Drawable defaultMarker) {
  super(boundCenterBottom(defaultMarker));
}
public HelloItemizedOverlay(Drawable defaultMarker, String ID, String city, String country) {
  super(boundCenterBottom(defaultMarker));
  #do something with the ID, city, country. Possibly store them in instance variables
} 
```

# c - 从文件中读取 c 代码

> ID：12391549
> 
> 赞同：0
> 
> 时间：2012-09-12T15:24:31.717
> 
> 标签：c, file, strstr

我有以下代码可以从文件中读取：

```
fin = fopen("file1.txt", "r");

char* url;
if ( fin ) 
{
    while ( line = read_line(fin) ) 
    {
        if ( (url=strstr(line, "url="))!=NULL )
        {
            fprintf(stdout, "%s \n", url);
            url=line;
        }
        free(line);
    }
}

printf("line is:%s ",url); //this one is NULL. How to solve this? 
                           // I need A COPY OF THE DATA
fclose(fin); 
```

出于某种原因`url`，`null`何时`printf`被调用 - 我该如何解决？我需要一份数据副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:30:32.740

url 只是一个指向内存块的指针，它不包含字符串。当您调用 free(line) 时，您会删除指向的内存 url。

您需要为 url 分配内存，然后使用 strcpy 复制字符串。

还要确保 if 中的代码实际运行，否则 url 指向内存中的随机点。

沿着这些思路。我不确定 strcpy 的参数顺序，在尝试之前先查一下。

```
char* url = 0;
if ( fin ) 
{
    while ( line = read_line(fin) ) 
    {
        char* tmp_url = strstr(line, "url="));
        if (tmp_url != NULL)
        {
            if(url != 0) free(url);
            url = (char*)malloc(sizeof(char)*strlen(line)+1); //if you don't know why I'm adding +1 look up null terminated strings
            fprintf(stdout, "%s \n", url);
            strcpy(url, line);
        }
        free(line);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:44:37.337

`read_line`如果您的函数没有分配内存，那会容易得多。这是一个建议的更改（未经测试：xmalloc 和 xfopen 显然是失败时退出的包装器）：

```
char *path = "file1.txt";
char* url;
size_t line_size;
line = xmalloc( line_size = 128 );
fin = xfopen( path, "r");
/* Pass &line so that read_line may realloc if necessary */
while( read_line2( fin, &line, &line_size )) {
        if( url = strstr( line, "url=" )) {
            printf( "%s \n", url);
            url=line;
        }
    }
}
printf("line is:%s ",url); 
free(line);
fclose(fin); 
```

# database - 自动或在一定时间间隔后将数据从 Table1 复制到 Table2

> ID：12391550
> 
> 赞同：0
> 
> 时间：2012-09-12T15:24:40.437
> 
> 标签：database

我正在使用 MSSQL 服务器企业版数据库。在那个数据库中，我有两个表，比如说 Table1、Table2。我想在某些基础上自动将数据从 Table1 复制并粘贴到 Table2。假设在某个时间间隔（每小时之后）或计算机启动或 Table1 中的任何更改。从 Table1 到 Table2 的数据复制应该会自动发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:27:23.233

您也可以[`triggers`](http://msdn.microsoft.com/en-us/library/ms189799.aspx)在 table1 上写入以将插入/更新/删除传播到 table2。这会在 table1 更改时发生。不知道为什么要拥有相同数据的两个副本！我们错过了什么吗？

# jquery - 无法在 jquery UI 对话框中设置输入字段的值

> ID：12391551
> 
> 赞同：2
> 
> 时间：2012-09-12T15:24:42.337
> 
> 标签：jquery, forms, jquery-ui-dialog

我正在尝试使用 jquery 更改输入字段的值。输入字段在 UI 对话框内。这是我的 Zend 表单的一部分

```
<input name="formulaCategory" id="formulaCategory" value="" size="40" type="text"> 
```

我有一个链接调用一个显示对话框的函数，我希望它也改变这个输入的值。

```
function editFormulaCategoryDialog() {

    $("#edit-formula-category-dialog").dialog({show: "slide"});
    $("#formulaCategory").val('test');
} 
```

为什么它不起作用？

如果我将输入代码放在对话框外部页面的其他位置并单击相同的链接，则会显示对话框，并且对话框外部输入字段的值会按预期更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T15:30:26.633

尝试这个：

```
function editFormulaCategoryDialog() {

    $("#edit-formula-category-dialog").dialog({
        show: "slide",
        create: function() {
            $("#formulaCategory").val('test');
        }
    });
} 
```

***[在创建](http://jqueryui.com/demos/dialog/#event-create)***对话框后尝试回调。您还可以使用***[打开](http://jqueryui.com/demos/dialog/#event-open)***事件回调。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T15:30:06.760

运行时的 Jquery UI 会删除所有文档对象并将其放在 DOM 之外，此时您将无法访问任何对象。这是所有 Jquery UI 插件的默认行为。所以你必须通过改变你使用它的方式来承受一些。

而且也没有办法`dialog`让你的元素单独存在，因为它不可能正确显示对话框。如果您想使用这种在对话框中显示部分表单的模式，您将不得不使用`dialog`回调方法来动态填充表单内的隐藏字段，或者类似的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-12T17:49:30.653

我需要类似的解决方案，尝试使用延迟较小的 setTimeout 函数。它对我有用。

```
function myCreateDialogFn(){
    //.....create jQuery Dialog here;

    setTimeout(function () {
        $("#edit-formula-category-dialog").find('input').each(function () {
            if (this.name=="formulaCategory"){
                // your code here
            }
        }
    }, 200);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-16T15:34:50.207

我这样做而不是使用任意超时。我有每 250 毫秒轮询一次元素是否存在的功能。

```
// wait for element to exist before populating
function waitForElement(elementPath, callBack){
  window.setTimeout(function(){
    if($(elementPath).length){
      callBack(elementPath, $(elementPath));
    }else{
      waitForElement(elementPath, callBack);
    }
  },250)
} 
```

然后我这样称呼它

```
 waitForElement("#idOfDialog",function(){
            var ordered=$("#input1).val();
            var price=$("#input2").val();
            var vendor=$("#input3").val();
.... or set value
             $("#input4").val("test"); 
```

这似乎解决了问题

# windows-8 - Windows 8 Metro 风格列表选择器在哪里

> ID：12391557
> 
> 赞同：1
> 
> 时间：2012-09-12T15:25:02.180
> 
> 标签：windows-8, windows-runtime

我们在 Windows Phone 7 中有一个列表选择器控件——它来自 Windows Phone 7 工具包。

我们对 Windows 8 Metro Style Application 有类似的控制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:02:08.160

我可能会使用[listview](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.controls.listview.aspx)来实现它。只需处理[ItemClick](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.controls.listviewbase.itemclick.aspx)事件并更改每个项目的“视图模型”中的属性。将每个项目的视图绑定到视图模型的“选定”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T04:39:04.207

组合框是相当于 Windows 8 中的 ListPicker 的控件。xaml 将是这样的。

```
<ComboBox x:Name="cbFrequency">
    <ComboBoxItem Text="Daily"/>
    <ComboBoxItem Text="Monthly"/>
    <ComboBoxItem Text="Weekly"/>
    <ComboBoxItem Text="Yearly"/>
</ComboBox> 
```

同样可以像这样在后面的代码中动态完成

```
var frequencyList = new List<string> {"Daily", "Monthly", "Weekly", "Yearly"};
cbFrequency.ItemsSource = frequencyList; 
```

# jquery - 如何使“页脚”粘在facebox（jQuery插件）对话框的底部

> ID：12391559
> 
> 赞同：2
> 
> 时间：2012-09-12T15:25:10.967
> 
> 标签：jquery, css, facebox

我正在使用一个名为[Facebox](http://defunkt.io/facebox/)的 jQuery 插件来创建包含内容的对话框，当然还会阻止和淡出页面的其余部分。

此插件可以将外部 html 页面应用为如下布局：

```
<a href="remote.html" rel="facebox">Open Facebox Dialog</a> 
```

我计划将 facebox 对话框设置为固定大小，并且 facebox 最终将包含需要滚动才能访问的内容。

*但是*，我还希望某些内容始终固定在底部，例如“**固定页脚**”。

我尝试应用[Joseph Silber 的解决方案](https://stackoverflow.com/a/8824859/1380710)（如果我想对整个页面执行此操作：[fiddle](http://jsfiddle.net/uw8f9/)），但它将固定页脚放在对话框之外，位于页面底部：

[![页脚不合适的屏幕截图](../Images/51da17e0bc7c131ec470856354d206d8.png)](https://i.stack.imgur.com/iNrwG.png)

我还尝试应用[RegDwight 的解决方案](https://stackoverflow.com/a/2140776/1380710)，它提出了这样的建议：http: [//jsfiddle.net/c82ha/2/](http://jsfiddle.net/c82ha/2/)

这使它正确地固定在底部，但正如小提琴所示，在向下滚动到它之前它不会显示。

我希望它**固定在底部，而不管页面其余部分的滚动或大小**。

我怎样才能做到这一点？

* * *

有关的：

*   [即使有滚动条，也让 div 始终停留在页面内容的底部](https://stackoverflow.com/questions/8824831/make-div-stay-at-bottom-of-pages-content-all-the-time-even-when-there-are-scrol)
*   [CSS 将 div 推到页面底部](https://stackoverflow.com/questions/2140763/css-push-div-to-bottom-of-page)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:02:21.693

您是否尝试过在对话中绝对定位页脚？

**HTML**

```
<div class="dialogue">
    <div class="content">
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
        <p>Text</p>
    </div>
    <div class="footer">
        Footer
    </div>
</div> 
```

**CSS**

```
.dialogue{
    width: 200px;
    height: 500px;
    position: relative;
    background: red;
}
.dialogue .footer{
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: #000;
    color: #fff;
}
​ 
```

[jsFiddle](http://jsfiddle.net/Tz8cd/)

# c# - 如何读取一次数据，然后在 C# 中对所述数据执行多次操作？

> ID：12391567
> 
> 赞同：0
> 
> 时间：2012-09-12T15:25:34.130
> 
> 标签：c#, winforms, visual-studio-2010

我创建了一个带有 3 个按钮的 WindowsForm 应用程序。单击任何按钮可读取`c:\data.txt`并执行不同的数据“分析”。按钮 1 可能会将数字相加`data.txt`，按钮 2 可能会平均它们，按钮 3 可能会将它们相乘。

在每一个下，`private void button1_Click`我都有一行代码从 data.txt 中读取数据。这对我来说似乎效率低下，因为在 3 个按钮单击事件中的每一个中都有相同的“ReadLines”代码。

有没有办法只读取一次数据，然后让我的按钮执行分析？

这样，“ReadLines”代码只使用一次，并且数据以某种方式与任何`button1_Click`事件共享。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:28:31.000

这并不难——你需要有一个*字段*来保存你读取的值——该字段将可用于类中的所有函数。

```
 private string[] data;

 // in constructor:
 data = File.ReadAllLines(@"c:\data.txt");

 // in your methods, simply use data 
```

另一种选择是有一个`LoadData`方法来检查是否`data`存在`null`并从您的方法中调用它：

```
private void LoadData()
{
  if(data == null)
    data = File.ReadAllLines(@"c:\data.txt");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:34:43.190

如果您想进一步最大化效率，您可以使用字段和属性来延迟加载它。

```
private string[] _data;

private string[] Data
{
    get
    {
        return _data ?? _data = File.ReadAllLines(@"c:\data.txt");
    }
} 
```

现在，您的调用代码可以直接使用该属性，而无需检查该字段是否为空，并且您在需要之前不会加载数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:30:07.243

向您的类添加将执行延迟加载的属性。

首先添加一个存放数据的地方

```
private string[] _FileData; 
```

然后添加一个新属性

```
private string[] FileData 
{ 
    get
    {
        if (_FileData != null && _FileData.Length > 0)
            return _FileData;

        _FileData = File.ReadAllLines(@"c:\data.txt");

        return _FileData;
    }
} 
```

然后只需使用 FileData 属性来获取文件文本。它只会在第一次获取文件文本，之后`_FileData`将保存您的文件，并且在您访问`FileData`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T15:30:32.387

这是一个同样通用的答案；）

您可以声明一个共享变量（例如 a `string`），在每个按钮单击处理程序上，您检查它是否为空或 null ( `String.IsNullOrEmpty(myString)`)。如果它为空，请执行`ReadLines`代码并将数据存储在`string`变量中。然后对变量进行处理。

下次单击按钮时，您将看到您`string`的不是空的，只需处理字符串，而不必再次读取文件。

# javascript - 给定语法错误的fancybox中的for循环

> ID：12391571
> 
> 赞同：0
> 
> 时间：2012-09-12T15:25:54.703
> 
> 标签：javascript, jquery, fancybox

```
function  imgshow(val2){
    var arrayVal2 = val2.split(',');
    $.fancybox([
    for (i=0; i<arrayVal2.length; i++){
        'uploads/'+arrayVal2[i],
        //'http://farm3.static.flickr.com/2687/4220681515_cc4f42d6b9.jpg',
        {
            'href'  : 'uploads/'+arrayVal2[i],
            'title' : 'Lorem ipsum dolor sit amet, consectetur adipiscing elit'
        }
    }   
    ], {
        'padding'           : 0,
        'transitionIn'      : 'none',
        'transitionOut'     : 'none',
        'type'              : 'image',
        'changeFade'        : 0
    });
} 
```

我可以在那里给循环吗？在我放置 for 循环的地方存在语法错误，我在数据库中有图像名称。爆炸并存储在数组中。并调用 for 循环以显示所有图像，但给出语法错误

请指导我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:01:07.273

这不是有效的 javascript

```
[for (;;) {}] 
```

但你可以这样做

```
[
(function() {
var val = [];
for (i=0; i<arrayVal2.length; i++){
    val.push(['uploads/'+arrayVal2[i],
    //'http://farm3.static.flickr.com/2687/4220681515_cc4f42d6b9.jpg',
    {
        'href'  : 'uploads/'+arrayVal2[i],
        'title' : 'Lorem ipsum dolor sit amet, consectetur adipiscing elit'
    }]);
}
return val;
)()
] 
```

虽然不好看。我建议重构该部分。

# c# - BigInteger.Equals(Object obj) 中的隐式转换如何工作？

> ID：12391575
> 
> 赞同：1
> 
> 时间：2012-09-12T15:26:01.780
> 
> 标签：c#, implicit-conversion

我正在查看 BigInteger 的文档，并在方法中遇到了以下内容`BigInteger.Equals(Object obj)`：

*如果 obj 参数不是 BigInteger 值，而是定义了隐式转换的数据类型，则 Equals(Object) 方法在执行比较之前将 obj 转换为 BigInteger 值。*

然后我开始想知道我将如何去做，因为从对象转换需要显式转换。我想出的最好方法如下：

```
Type type = obj.GetType()
if(type == typeof(byte))
{
  byte b = (byte)obj;
  return Equals(b);
}
if(type == typeof(short))
{
  short s = (short)obj;
  return Equals(s);
}
//Continue for all types that can be implicitly cast to BigInteger. 
```

在我看来，我缺少一种更简单的方法来做到这一点。那么，考虑到我从一个对象开始，还有哪些其他方法可以进行隐式转换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:41:05.737

ILSpy 的当前实现：

```
return obj is BigInteger && this.Equals((BigInteger)obj); 
```

至少该文件的措辞可能会被认为具有误导性。它的意思是什么`BigInteger`或*从它派生的任何东西*都将隐含转换为`BigInteger`，因此将被转换为 a`BigInteger`以测试相等性。

will的当前定义`struct`意味着没有任何东西可以派生自`BigInteger`，因此文档在该声明中实际上有点毫无意义。

您可能对用户定义的`implicit`运算符感到困惑，该运算符将用于允许`int`, `short`, et al`BigInteger`在代码中“隐式”存储：

```
BigInteger b = 1; 
```

# azure - Azure 上带有图表（图形）的报告未实现错误

> ID：12391582
> 
> 赞同：0
> 
> 时间：2012-09-12T15:26:50.703
> 
> 标签：azure, crystal-reports, charts

我在 Windows Azure 上安装了 Crystal Reports，大多数报表都可以正常工作。但是，所有带有图表的报告都不起作用。我从我的网页上得到操作尚未实现的错误。

非常感谢任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T18:58:44.283

[如果您可以安装所有需要的 SAP，我从您提到的线程中](http://scn.sap.com/thread/3236182)了解到，在本地服务器上，您可以尝试以下选项之一：

*   启动一个 webrole，rdp 进入它并安装需要的东西
*   创建一个安装所需材料的启动任务。[参见这个例子](http://danieljsinclair.wordpress.com/2012/06/28/how-i-got-net-4-5-rc-running-in-a-windows-azure-webrole/)。
*   利用 Azure 中的新 IaaS 功能。从图库中的其中一个图像创建一个新服务器，或者将包含所需内容的[系统准备好的](http://msdn.microsoft.com/en-us/library/windowsazure/gg465407.aspx)图像上传到 Azure。

# ios - 对于没有数据返回的网络呼叫，使用 NSURLRequest+NSURLConnection 似乎有点过头了

> ID：12391583
> 
> 赞同：0
> 
> 时间：2012-09-12T15:26:54.387
> 
> 标签：ios, nsurlconnection, nsdata, nsurlrequest

全部，

这可能看起来很简单，但我已经浏览了 URL 加载系统程序指南和各种 NSURL.... 类，但没有找到我的答案。

我只是想从应用程序向网站打一个简单的电话来预订聚会地点：

```
NSString *path=[NSString stringWithFormat:@"http://www.myparty123.com/ireservedURL.asp?Nickname=%@&Seat=%i&Email=%@&Currentparty=%i",john,5432,john@yahoo.com,6598];
NSURL* reservationURL =[NSURL URLWithString:path];
NSData *call= [NSData dataWithContentsOfURL:reservationURL]; 
```

这似乎是一种简单的方法，但我收到警告说我没有使用“调用”变量。在没有数据返回的情况下使用 NSData 进行调用似乎有点过头了。

然而，创建一个 NSURLRequest 并启动一个 NSURLConnection 然后用该请求实现委托似乎也有点矫枉过正。

我错过了什么。

谢谢九巴

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:36:51.520

NSURLConnection 有一个名为 sendSynchronousRequest:returningResponse:error: 的方法，它允许您从 URL 下载 NSData 而无需实现 NSURLConnection 委托。

所以你的代码可以重写：

```
NSString *path = [NSString stringWithFormat:@"http://www.myparty123.com/ireservedURL.asp?Nickname=%@&Seat=%i&Email=%@&Currentparty=%i",@"john",5432,@"john@yahoo.com",6598];
NSURL *url = [NSURL URLWithString:path];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil]; 
```

您将不再收到警告，因为您没有将数据分配给无用的变量。如果您想知道响应是否成功，您可以创建一个 NSURLResponse 变量并将其传递给 sendSynchronousRequest 方法调用。

需要注意的是，此方法将阻塞您调用它的任何线程。因此，如果您在 UI 线程上调用它并且下载需要 10 秒，则用户将无法与应用程序交互。实现 NSURLConnection 委托或使用 sendAsynchronousRequest:queue:completionHandler: 方法不会阻塞使用它们的线程。

您还可以将此代码包装在 NSInvocationOperation 中并将其添加到 NSOperationQueue 或查看类似[AFNetworking](https://github.com/AFNetworking/AFNetworking)的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:00:28.033

据了解，发送请求的最简单`+ (id)stringWithContentsOfURL:(NSURL *)url encoding:(NSStringEncoding)enc error:(NSError **)error`方法是`NSString`

# wcf - Visual Studio 2012 安装破坏了我的 2010 WCF 项目

> ID：12391586
> 
> 赞同：13
> 
> 时间：2012-09-12T15:26:58.510
> 
> 标签：wcf, visual-studio-2012, runtime-error

我已经安装了 VS 2012 并在一些 Web 项目中成功使用它，但它的某些东西导致我的 Web 服务项目中断。我还在web服务项目上使用VS 2010，2012年还没有打开。

一切都编译并正常工作，除非它试图在我引用的博客项目中创建一个类的实例，然后它会抛出这个错误：

*调用 HttpRequest.GetBufferlessInputStream 后不支持此方法或属性。*

我在项目中找不到明确使用**GetBufferlessInputStream的任何地方。**

如果我跳过博客代码，一切都会正确执行。

我找不到其他收到此错误的人来尝试缩小范围，任何想法从哪里开始？

**堆**

```
 at System.Web.HttpRequest.get_InputStream()
   at OAS.Web.Log.WebEvent..ctor(EventType type, HttpContext context, String applicationName)
   at OAS.Web.Log.WebTrace..ctor(HttpContext context, String applicationName)
   at OAS.Web.AdvisorServices.Extensions.OperationLoggerParameterInspector.BeforeCall(String operationName, Object[] inputs) in C:\SourceControl\OAS\IM.NET3.0\Web\AdvisorServices\OAS.Web.AdvisorServices.Extensions\OperationLogger\OperationLoggerParameterInspector.cs:line 54 
```

****编辑**- 奖金问题

为什么这些 Framework 4.5 属性会影响我的 4.0 解决方案？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-14T00:25:21.903

**注意：**此问题已在 .net 4.5.1 中修复。您可以看到 4.5.1 的修复。拥有 .net 4.5.1 后，添加以下 appSetting 以切换回旧行为。

```
<configuration>      
<appSettings>
      <add key="wcf:serviceHostingEnvironment:useClassicReadEntityBodyMode" value="true" />
</appSettings> 
</configuration> 
```

以下是如何创建 HttpModule 以强制 ReadEntityBodyMode 为“经典”：http: [//blogs.msdn.com/b/praburaj/archive/2012/09/13/accessing-httpcontext-current-request-inputstream-property -在-aspnet 兼容性模式中抛出异常-this-method-or-property-is-not-supported-after-httprequest-getbufferlessinputstream-has-been-invoked.aspx](http://blogs.msdn.com/b/praburaj/archive/2012/09/13/accessing-httpcontext-current-request-inputstream-property-in-aspnetcompatibility-mode-throws-exception-this-method-or-property-is-not-supported-after-httprequest-getbufferlessinputstream-has-been-invoked.aspx)

要回答您的其他问题（为什么这些 Framework 4.5 属性会影响我的 4.0 解决方案？）：.net 4.5 是 .net 4.0 的就地升级。所以即使你的项目是针对 4.0 的，由于 VS 2012 安装了 4.5 运行时，4.5 的一些行为也会生效。

**编辑**

*博客条目：*

在 .net 4.5 中，WCF 利用缓冲区较少的输入流来获得可伸缩性优势。因此，当您尝试访问 HttpContext.Current.Request.InputStream 属性时，您可能会遇到以下异常，因为 InputStream 属性试图让您处理经典流，因为它们都不兼容。

> **“调用HttpRequest.GetBufferlessInputStream**后，不支持此方法或属性 。”</p>

如果您有一个运行良好的 WCF 4.0 应用程序，但在将 .net 框架升级到 4.5 时，您会注意到服务在访问此属性时失败，以下是解决此问题的方法：

*   在同一个 WCF 项目中添加一个简单的 HttpModule，它将在 WCF 读取之前访问每个请求的 InputStream 属性，这样它将强制 HttpContext.Request.ReadEntityBody 为“经典”并确保兼容性。

    ```
    public class WcfReadEntityBodyModeWorkaroundModule : IHttpModule    
    {    
        public void Dispose() { }

        public void Init(HttpApplication context) {    
            context.BeginRequest += context_BeginRequest;    
        }    

        void context_BeginRequest(object sender, EventArgs e) {
            //This will force the HttpContext.Request.ReadEntityBody to be "Classic" and will ensure compatibility..    
            Stream stream = (sender as HttpApplication).Request.InputStream;    
        }    
     } 
    ```

*   `<configuration>` `<modules>`通过在设置中添加这些行，在您的 web.config 中注册此模块。

    ```
    <system.webServer>
        <modules>
            <!-- Register the managed module -->
            <add name="WcfReadEntityBodyModeWorkaroundModule" type="MyAssembly.WcfReadEntityBodyModeWorkaroundModule, MyAssembly" />
        </modules> 
    ```

*   如果您在经典模式下使用应用程序池，则需要将模块添加到 web.config 中的此部分：

    ```
    <system.web>
        <httpModules>
            <add name="WcfReadEntityBodyModeWorkaroundModule" type="MyAssembly.WcfReadEntityBodyModeWorkaroundModule, MyAssembly" />
        </httpModules> 
    ```

如果您的项目无法修改，那么您可以在单独的程序集中编写此 Http 模块，单独 GAC 并在 web.config 中注册此模块。

现在尝试访问它应该为您成功的服务！

# android - 捕获通过 XML 定义的 View.setOnClickListener()

> ID：12391589
> 
> 赞同：5
> 
> 时间：2012-09-12T15:27:12.877
> 
> 标签：android, listener, aspectj

我正在将 AspectJ 与 Android 一起使用，并且我成功地捕获`View.setOnClickListener()`了对这方面的调用：

```
public aspect Test {

    pointcut callPointcut(View view, OnClickListener listener) : call(void View.setOnClickListener(OnClickListener)) && target(view) && args(listener);

    @SuppressAjWarnings // Exported advice
    before(View view, OnClickListener listener) : callPointcut(view, listener)
    {
        Log.d("AspectJ", "Attempt to set onClick listener on view " + Integer.toHexString(view.getId()));
        Log.d("AspectJ", "Aspect has executed.");
        Log.d("AspectJ", listener.toString());
    }
} 
```

不幸的是，这不会捕获`android:onClick`在布局 XML 中设置的侦听器。有没有办法捕捉到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:17:44.837

你不能那样做。

如果我理解正确，您在 Views 上收听 setOnClickListener() 的调用。

当您在 xml 中设置 onclick 属性时，它永远不会被调用。侦听器在创建视图时设置 - 直接。setOnClickListener() 永远不会被调用。

唯一的解决方案是手动检查您的所有视图 - 这不是推荐的，也可能不是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T16:51:25.263

I'm not 100% sure if this will work, but why not modify the View class to have an mOnClickListener attribute. Then when the OnClickListener is about to be set in the custom View class, set the attribute to "new OnClickListener(){ ... }" then call setOnClickListener with the attribute. You would then add a public method called getOnClickListener(), which you could call on your custom View object to return said listener.

This may be a roundabout / tedious way, because you would also need to include not only your custom View class, but every subclass of View that you plan on using in your XML and change their superclasses to use your custom View, not Android's. Then, you would need to change your XML elements to reflect that, i.e. com.yourpackage.Button, etc.

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-09-17T04:55:33.780

您可以使用，

```
 <TextView
            android:id="@+id/display_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="3dp"
            android:onClick="testclick"
            android:textSize="16sp"
            android:textStyle="bold" > 
```

在您的活动中添加以下 API，

```
public void textclick(View v){

//TODO :anything you want 
} 
```

# eclipse - 强制 Eclipse CDT makefile 在编译前清理文件

> ID：12391590
> 
> 赞同：5
> 
> 时间：2012-09-12T15:27:30.927
> 
> 标签：eclipse, makefile, eclipse-cdt

我正在为一个项目使用 Eclipse + CDT。我正在使用构建设置中的“自动生成 Makefile”选项。我在一个文件中保存了每次编译项目时必须实现的日期和一些值。但是由于我每次都不会更改此文件，因此编译器不会刷新它。有什么选择可以让我有一个 Phony 目标吗？

如果我可以在 makefile 中添加一些行就可以了， `rm -f *.o target` 但是下次我更新我的项目时这将被删除。

我发现在设置 >> c/c++ 构建 >> 行为中有机会编写一些干净的变量。这有帮助吗？我试图写文件名，但这不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T09:22:36.157

您可以给 CDT 一个预构建命令。对我来说（Linux 上的 3.6.2）：

*   `Project`→`Properties`
*   `C/C++ Build`类别
*   `Settings`子类别
*   `Build Steps`标签
*   `Pre-build steps`窗格
*   输入命令以删除有问题的目标文件（`rm f.o`或类似的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-13T11:52:08.820

您可以在 Pre-build 步骤中使用**make clean**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-28T10:28:50.517

我在预构建步骤中添加了以下内容，它似乎效果很好：

```
del ${CWD}\addtional_dir\file.o 
```

# javascript - 函数的多个参数

> ID：12391591
> 
> 赞同：0
> 
> 时间：2012-09-12T15:27:33.497
> 
> 标签：javascript, function, arguments, getelementbyid

我有一个表格，当将链接添加到任何单元格时，它可以使整行可点击。我想做的是将此脚本添加到页面上的多个表中。问题是该脚本只能与一个表一起使用，因为它只能与 id 一起使用，而不能与 class css 一起使用。如何添加多个表 ID？

```
 window.onload = function(){
      ConvertRowsToLinks("results-table"); //My table id
      // ConvertRowToLinks("results-table", "results-table2");
      // I would like to add results-table2, results-table3 etc...

  }

  function ConvertRowsToLinks(xTableId){

    var rows = document.getElementById(xTableId).getElementsByTagName("tr");

    for(i=0;i<rows.length;i++){
      var link = rows[i].getElementsByTagName("a")
      if(link.length == 1){
        rows[i].onclick = new Function("document.location.href='" + link[0].href + "'");
        rows[i].onmouseover = new Function("this.className='highlight'");
        rows[i].onmouseout = new Function("this.className=''");
      }
    }

    ConvertSideRowsToLinks("sidebar-table");
  }

  function ConvertSideRowsToLinks(xTableId){

    var rows = document.getElementById(xTableId).getElementsByTagName("tr");

    for(i=0;i<rows.length;i++){
      var link = rows[i].getElementsByTagName("a")
      if(link.length == 1){
        rows[i].onclick = new Function("document.location.href='" + link[0].href + "'");
        rows[i].onmouseover = new Function("this.className='highlight'");
        rows[i].onmouseout = new Function("this.className=''");
      }
    }

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:40:57.790

您也可以通过这种方式对*参数*进行切片，您可以根据需要传递任意数量的 id，并且您不必创建数组显式：

```
 function ConvertSideRowsToLinks()
  {
    var ids = Array.prototype.slice.call(arguments)
    for (var key in ids)
    {
        var table =  document.getElementById(ids[key])
        var rows =table.getElementsByTagName("tr");

        for(i=0;i<rows.length;i++){
          var link = rows[i].getElementsByTagName("a")
          if(link.length == 1){
            rows[i].onclick = new Function("document.location.href='" + link[0].href + "'");
            rows[i].onmouseover = new Function("this.className='highlight'");
            rows[i].onmouseout = new Function("this.className=''");
        }
      }
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:35:04.263

使用类作为：

```
//Html code
<a class="test" name="Name 1"></a>
<a class="test" name="Name 2"></a>
<a class="test" name="Name 3"></a>

// access like
var elements = document.getElementsByClassName("test"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:37:12.323

您可以传递一个数组并对其进行迭代：

```
function ConvertTablesRowsToLinks(tableIds){
  tableIds.forEach( ConvertRowsToLinks); 
```

}

```
function ConvertRowsToLinks(xTableId){
    var i; // variable i should be declared otherwise is leaking to global namespace.
    var rows = document.getElementById(xTableId).getElementsByTagName("tr");
    for(i=0;i<rows.length;i++){
      var link = rows[i].getElementsByTagName("a")
      if(link.length == 1){
      rows[i].onclick = new Function("document.location.href='" + link[0].href + "'");
      rows[i].onmouseover = new Function("this.className='highlight'");
      rows[i].onmouseout = new Function("this.className=''");
    }
  } 
```

# c# - 使用接口成员实现接口

> ID：12391592
> 
> 赞同：3
> 
> 时间：2012-09-12T15:27:39.457
> 
> 标签：c#, interface

实现具有自己的接口成员的接口的正确方法是什么？（我说得对吗？）这就是我的意思：

```
public Interface IFoo
{
    string Forty { get; set; }
    string Two { get; set; }
}

public Interface IBar
{
    // other stuff...

    IFoo Answer { get; set; }
}

public class Foo : IFoo
{
    public string Forty { get; set; }
    public string Two { get; set; }
}

public class Bar : IBar
{
    // other stuff

    public Foo Answer { get; set; } //why doesnt' this work?
} 
```

我已经使用显式接口实现解决了我的问题，但我想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:29:47.747

您需要使用与界面中完全相同的类型：

```
public class Bar : IBar 
{ 
    public IFoo Answer { get; set; }   
} 
```

注意：`IFoo`而不是`Foo`.

原因是接口定义了一个契约并且契约说它必须是一个`IFoo`.

想一想：

你有类`Foo`和`Foo2`，都实现`IFoo`。根据合同，可以分配两个类的实例。现在，如果你的代码是合法的，这会以某种方式破坏，因为你的类只接受`Foo`. 显式接口实现不会以任何方式改变这一事实。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T15:35:54.663

你需要使用泛型才能做你想做的事。

```
public interface IFoo
{
    string Forty { get; set; }
    string Two { get; set; }
}

public interface IBar<T>
    where T : IFoo
{
    // other stuff...

    T Answer { get; set; }
}

public class Foo : IFoo
{
    public string Forty { get; set; }
    public string Two { get; set; }
}

public class Bar : IBar<Foo>
{
    // other stuff

    public Foo Answer { get; set; }
} 
```

这将允许您提供一个接口，该接口类似于“要实现此接口，您必须具有一个具有实现的类型的公共 getter/setter 的属性`IFoo`。” 如果没有泛型，您只是说该类具有类型为的属性`IFoo`，而不是任何实现的属性`IFoo`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:30:39.083

IBar 有一个 IFoo 字段，而不是 Foo 字段，而是这样做：

```
public class Bar : IBar
{
    // other stuff

    public IFoo Answer { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T15:32:45.460

Foo 可以扩展 IFoo 类型，但这不是接口公开的内容。接口定义了合同，您需要遵守该合同的条款。所以正确的方法是 `public IFoo Answer{get;set;}`像其他人所说的那样使用。

# spring - 如何在方法中使用 @value 注释从属性文件中读取 aa 属性？

> ID：12391596
> 
> 赞同：7
> 
> 时间：2012-09-12T15:27:51.343
> 
> 标签：spring, annotations, spring-3

我可以在方法中使用@value 注释来读取属性吗？

```
 void method1(){

     @Value("#{AppProperties['service.name']}") String name;
     -------
      -------
   } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T15:38:19.187

方法变量的私有访问器是不合适的。

如果看@Value注解的定义，只能放在FIELD、PARAMETER或METHOD级别。

```
@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Value { 
```

因此，要么将名称声明为类属性，要么声明为方法参数...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-12T15:35:29.317

不 :) 您可以使用注释来注释类、字段、方法及其参数。但不是在方法中，因为没有办法使用反射来获取方法局部变量以处理这些注释。在您的字段中使用@Value，并从您的方法中读取值。

# c# - C#/asp.net 全局变量？

> ID：12391597
> 
> 赞同：2
> 
> 时间：2012-09-12T15:27:52.903
> 
> 标签：c#, asp.net, variables, webforms, global-variables

我有两个具有点击功能的按钮

单击时，第一个会被分配一个变量。

当我单击按钮 2 时，如何让我的第二个按钮从第一个按钮获取变量？

它似乎不起作用。由于第二个按钮无法识别变量。

谢谢

编辑：

只是为了澄清我的代码正在生成一个pdf。按钮 1 选择要使用的模板的 url。在按钮 2（生成 pdf 的那个）中，我希望它从按钮 1 中获取变量集，以便它知道要使用什么模板。

编辑 2：我的代码确实有效，但仅当我不使用 ajax 更新面板时。似乎我试图设置的变量没有用 AJAX 设置

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:35:21.523

你的按钮有`Id`，你用他的按钮得到这个按钮`Id`

注意：您可以添加 runat="server" 以便在服务器端进行可视化

```
<asp:Button id="Button1"
           Text="Click "
           OnClick="Btn1_Click" 
           runat="server"/>

<asp:Button id="Button2"
           Text="Click "
           OnClick="Btn2_Click" 
           runat="server"/>

void Btn2_Click(Object sender, EventArgs e)
{
    Button1.Text = "test after click on button 2";

    Template = ...;//Set your value
}

void Btn1_Click(Object sender, EventArgs e)
{
    Button2.Text = "test after click on button 1";

    //Here you can get your value after post.
    var result = Template; 
} 
```

它不是主题，但在委托中，您还可以通过传递发件人参数来获得对象按钮。

```
var button = sender as Button; //You get button who raise event 
```

为了管理`Template Path`财产。

```
public string Template
{
   get
   {
      if(ViewState["Template"] != null)
      {       
         return (string)ViewState["Template"];
      }
   }

   set{ViewState["Template"] = value;} 
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T16:14:10.640

我猜您正在查看在 button2 的点击事件中访问变量的值，该变量的值是在 button1 点击事件中设置的？

```
private string myPrivateString = "";

void Page_Load()//Not sure of correct method signature
{
  if(Page.IsPostBack)
  {
    myPrivateString = Session["myPrivateString"];
  }
}

void Button1_Click(object sender, EventArgs e)
{
  //There will a postback before this gets executed
  myPrivateString = "Value Set From Button 1";
  Session["myPrivateString"] = myPrivateString;
}

void Button2_Click(object sender, EventArgs e)
{
  //There will a postback before this gets executed
  //Accessing myPrivateString here without setting value from session
  //will return empty string as after PostBack its a new page thats rendered.
  myPrivateString = Session["myPrivateString"]; // Or do it in the Page_Load event
} 
```

我想现在你可以在 button2 click 事件中获取值。
另请阅读 ASP.NET 页面生命周期以及 ASP.NET 框架如何处理按钮单击等客户端事件。

# javascript - Jquery 验证（第一个字符不能为 0 或符号）

> ID：12391599
> 
> 赞同：1
> 
> 时间：2012-09-12T15:28:01.520
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用 Jquery 验证。

目前，我有一个文本字段。当用户在字段中输入 0 或任何其他符号作为第一个字符时，如何提示警报？

```
 $.validator.addMethod(
    "regex",
    function(value, element, regexp) {
        var re = new RegExp(regexp);
        return this.optional(element) || re.test(value);
    },
    "Please check your input."
 );
 $("#Textbox").rules("add", { regex: "^[a-zA-Z'.\\s]{1,40}$" }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T11:34:52.483

只看正则表达式，如果你想要的只是防止第一个字符为零而没有别的，它应该是

```
$("#Textbox").rules("add", { regex: "^[^0]$" }) 
```

要排除符号，您可以将它们添加到禁止字符列表中

```
$("#Textbox").rules("add", { regex: "^[^0$-/:-?{-~!"^_`\[\]]$" }) 
```

或指定允许的字符。在这种情况下，大小写字母、数字 1-9、撇号、句号或空格

```
$("#Textbox").rules("add", { regex: "^[a-zA-Z1-9'.\s]" }) 
```

# asp.net - 创建自定义 GridviewAdapter

> ID：12391601
> 
> 赞同：0
> 
> 时间：2012-09-12T15:28:03.667
> 
> 标签：asp.net, gridview, control-adapter

我想为 Gridview 控件制作一个简单的适配器，它将在`<div>`标签内呈现单元格内容。

而不是渲染为

```
<table>
  <tr>
    <td>Some Data</td>
    <td>Some Data</td>
  </tr>
</table> 
```

我希望它呈现为

```
<table>
  <tr>
    <td><div>Some Data</div></td>
    <td><div>Some Data</div></td>
  </tr>
</table> 
```

*我知道这可以使用 Jquery 或在 RowDataBound 中以其他方式完成，但我特别想使用适配器来完成。*

在我看来，如果有办法查看创建默认 .Net Gridview 的适配器的代码，那么更改会很简单，但是我不知道如何获取该代码。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T18:30:02.927

[Microsoft 以CSS 友好控制适配器](http://cssfriendly.codeplex.com/)的形式提供了控制适配器的参考实现

你可以看看他们是如何实现[GridViewAdapter](http://cssfriendly.codeplex.com/SourceControl/changeset/view/73982#9847)

这是处理渲染行的代码

```
private void WriteRows(HtmlTextWriter writer, GridView gridView, GridViewRowCollection rows, string tableSection)
{
    if (rows.Count > 0)
    {
        writer.WriteLine();
        writer.WriteBeginTag(tableSection);
        writer.Write(HtmlTextWriter.TagRightChar);
        writer.Indent++;

        foreach (GridViewRow row in rows)
        {
            if (!row.Visible)
                continue;

            writer.WriteLine();
            writer.WriteBeginTag("tr");

            string className = GetRowClass(gridView, row);
            if (!String.IsNullOrEmpty(className))
            {
                writer.WriteAttribute("class", className);
            }

            writer.Write(HtmlTextWriter.TagRightChar);
            writer.Indent++;

            foreach (TableCell cell in row.Cells)
            {
                DataControlFieldCell fieldCell = cell as DataControlFieldCell;
                if ((fieldCell != null) && (fieldCell.ContainingField != null))
                {
                    DataControlField field = fieldCell.ContainingField;
                    if (!field.Visible)
                    {
                        cell.Visible = false;
                    }

                    // Apply item style CSS class
                    TableItemStyle itemStyle;
                    switch (row.RowType)
                    {
                        case DataControlRowType.Header:
                            itemStyle = field.HeaderStyle;
                            // Add CSS classes for sorting
                            SetHeaderCellSortingClass(gridView, field, itemStyle);
                            break;
                        case DataControlRowType.Footer:
                            itemStyle = field.FooterStyle;
                            break;
                        default:
                            itemStyle = field.ItemStyle;
                            break;
                    }
                    if (itemStyle != null && !String.IsNullOrEmpty(itemStyle.CssClass))
                    {
                        if (!String.IsNullOrEmpty(cell.CssClass))
                            cell.CssClass += " ";
                        cell.CssClass += itemStyle.CssClass;
                    }
                }

                writer.WriteLine();
                cell.RenderControl(writer);
            }

            writer.Indent--;
            writer.WriteLine();
            writer.WriteEndTag("tr");
        }

        writer.Indent--;
        writer.WriteLine();
        writer.WriteEndTag(tableSection);
    }
} 
```

# r - 有效地将来自多个文件的源代码整合到一个文件中，包括（Roxygen）注释

> ID：12391603
> 
> 赞同：2
> 
> 时间：2012-09-12T15:28:08.727
> 
> 标签：r, roxygen2, roxygen, consolidation

## 问题

将源代码从多个源文件合并到单个源文件的有效方法是什么 - 包括 Roxygen 文档注释，可能还包括其他注释？

我记得有一个来自某个包的解析方法可以解释注释（将它放在某个属性“字段”中），但我再也找不到它了。

* * *

## 背景资料

主要出于两个原因，我喜欢将源代码从给定数量的源文件合并到单个源文件的灵活性：

1.  为了保持清醒，我坚持“每个文件一个定义”范例，其中每个源文件都包含一个定义（函数、S4 方法、S4 参考类等）。此外，这些源文件可能存储在我的“源目录”的各个子目录中，因此甚至可能具有相同的文件名。然而，为了组合一个真正的 R 包，有时最好将多个 def 组合到一个源文件中。在重复文件名的情况下，我什至需要。
2.  并行化时，能够将所有必需的源代码分组到一个文件中并将其推送到工作进程以便他们可以获取代码是很方便的

## 家庭作业

这是我目前的解决方案；感觉“还可以”，但是

1.  我觉得可能有更好的、更有效的方法
2.  在检测 Roxygen 代码方面似乎有点脆弱

## 创建示例源文件

```
foo1 <- function(x) {message("I'm foo #1"); return(TRUE)}
roxy.1 <- c(
    "#' Title foo1()",
    "#'", 
    "#' Description foo1().",
    "##' This line is commented out",
    "#'", 
    "#' @param x Some R object that doesn't matter.",
    "#' @return \\code{TRUE}.",
    "#' @references \\url{http://www.something.com/}",
    "#' @author Janko Thyson \\email{john.doe@@something.com}",
    "#' @seealso \\code{\\link{foo2}}",
    "#' @example inst/examples/foo1.R"
)

foo2 <- function(y) {message("I'm foo #2"); return(FALSE)}
roxy.2 <- c(
    "#' Title foo2()",
    "#'", 
    "#' Description foo2().",
    "##' This line is commented out",
    "#'", 
    "#' @param y Some R object that doesn't matter.",
    "#' @return \\code{FALSE}.",
    "#' @references \\url{http://www.something.com/}",
    "#' @author Janko Thyson \\email{john.doe@@something.com}",
    "#' @seealso \\code{\\link{foo1}}",
    "#' @example inst/examples/foo2.R"
)

dir.create("src/functions", recursive=TRUE, showWarnings=FALSE)
dir.create("src/conso", recursive=TRUE, showWarnings=FALSE)

write(roxy.1, file="src/functions/foo1.R")
write(deparse(foo1), file="src/functions/foo1.R", append=TRUE)
write(roxy.2, file="src/functions/foo2.R")
write(deparse(foo2), file="src/functions/foo2.R", append=TRUE) 
```

## 合并功能

```
consolidateThis <- function(
    path="src/functions",
    path.conso="src/conso/src_functions.R",
    rgx.roxy="^(#' ?|##' ?)(\\w*|@|$)",
    do.overwrite=TRUE,
    do.roxygen=TRUE,
    ...
) {
    if (!file.exists(path)) {
        stop("Check your 'path' argument")
    }
    files <- list.files(path, full.names=TRUE)
    if (do.overwrite) {
        file.create(path.conso)
    }
    sapply(files, function(ii) {
        this <- readLines(con=ii, warn=FALSE)
        code <- base::parse(text=this)
        if (do.roxygen) {     
            idx.roxy <- grep(rgx.roxy, this)
            if (length(idx.roxy)) {
                if (length(idx.roxy) == 1) {
                    stop("Weird roxygen code (just a one-liner)") 
                }
                bench <- seq(from=idx.roxy[1], max(idx.roxy))
                if (!all(bench %in% idx.roxy)) {
                    stop("Breaks in your roxygen code. Possibly detected comments that aren't roxygen code")
                }
                code.roxy <- this[idx.roxy]
                write(code.roxy, file=path.conso, append=TRUE)
            }
        }
        write(c(deparse(code[[1]]), ""), file=path.conso, append=TRUE)
    })
    return(path.conso)
} 
```

## 应用函数

```
path <- consolidateThis()
> path
[1] "src/conso/src_functions.R" 
```

所以现在有一个源文件 'src/conso/src_functions.R' 包含合并的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:14:44.140

您是否特别需要解析（然后解析）函数的源代码？如果没有，您可以大大简化代码。

以下产生与 完全相同的输出`ConsolidateThis()`。

```
ConsolidateThis2 <-
function(path="src/functions",
         path.conso="src/conso/src_functions.R",
         overwrite = TRUE) {
    if(overwrite) cat("", file = path.conso) # Blank out the file's contents

    ## A function to append infile's contents to outfile and add 2 <RET>          
    prettyappend <- function(infile, outfile) {
        file.append(outfile, infile)
        cat("\n\n", file = outfile, append = TRUE)
    }

    ## Append all files in 'path.conso' to file 'path'
    sapply(dir(path, full.names=TRUE), prettyappend, path.conso)
}

ConsolidateThis2() 
```

# javadoc - 通过注解过滤 javadoc

> ID：12391604
> 
> 赞同：3
> 
> 时间：2012-09-12T15:28:10.843
> 
> 标签：javadoc

我希望能够使用 @nnotations 来标记要从 javadoc 中排除的类或方法。

有没有办法为此目的对标准 doclet 进行子类化？第一次通过 javadoc-doc 并没有找到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-30T21:47:47.550

已提议但当前未实现注解@exclude

在链接中，您可以找到 javadoc 的重新实现，并实现了 @exclude

[http://www.dzone.com/links/javadoc_tool_with_exclude_tag.html](http://www.dzone.com/links/javadoc_tool_with_exclude_tag.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-31T14:28:04.053

您可能想考虑使用 Doclava doclet： [https ://code.google.com/p/doclava/](https://code.google.com/p/doclava/)

这实现`@hide`了从生成的 javadoc 中排除类和方法。

它还产生格式更好的输出。（也就是说，vanilla javadoc 做了一些 doclava 没有做的事情，但我从来不需要。）

# javascript - 将 Flash Google Maps API 转换为基于 Flash 的 Javascript？

> ID：12391609
> 
> 赞同：4
> 
> 时间：2012-09-12T15:28:41.490
> 
> 标签：javascript, flash, google-maps

我得到了一个旧程序来处理，它使用 Google Maps API for Flash。该应用程序是在 Flash CS5 中构建的，除了 Flash 之外不能转换为其他任何东西（因为它是一个更大的 Flex 应用程序的一部分，它采用 Flash 构建的 swf 并将它们加载到一个 Flex 构建的更大的应用程序中）所以我不能使用纯 Javascript方法。而且我也不懂任何 Javascript，我基本上是一个纯 Flash/Flex 开发人员，呵呵。

是否有一种“简单”的方法可以将应用程序从基于 Flash 的 API 转换为基于 Javascript 的 API？我什至不知道从哪里开始，我刚大学毕业，这是我第一个真正的大项目，而且我是唯一的 Flash 开发人员

否则我有点卡住了，因为 API 密钥过期了，谷歌没有给出新的密钥，他们也没有回答我更新密钥的请求。我也在研究 MapQuest Flash API 并将其转换为那个，但是，我不确定。

我还想注意我不能使用网络视图，因为内容需要显示在顶部，并且整个地图需要集成到 SWF 中，我应该只从 API 中提取数据并在 Flash 中显示为一个 Flash 元素。我以前使用过网络设置，它不适合我对这个项目的需求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T18:07:57.063

请参阅我对重复问题的回答：[在 Flash 中嵌入 Google 地图](https://stackoverflow.com/questions/14725861/embedding-google-maps-in-flash/15029139#15029139) - 我已经在 Flash 中实现了 Bing、Google 和 MapQuest JavaScript 地图及其高程服务 - 完整的帖子（带代码）太长了，所以在这里：[http:// pastebin.com/Jzq5E06F](http://pastebin.com/Jzq5E06F)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:06:55.387

将应用程序转换为[MapQuest 的 API](http://developer.mapquest.com/web/products/featured/as3-flex-flash)。我期待一场噩梦，实际上我对过渡的顺利进行感到非常惊讶（正如您从时间戳中看到的那样）。根本没花我多长时间。

功能是可比的，归结为只是更改一些函数名称以获得相同的功能以获得更简单的事物，然后进行一些挖掘并使一切正常工作。

# javascript - 当我向上滚动时，如何使“粘性菜单”回到原来的类？

> ID：12391610
> 
> 赞同：0
> 
> 时间：2012-09-12T15:28:43.147
> 
> 标签：javascript, header, scroll, nav, sticky

我对javascript相当陌生，我正在尝试在我的网站上制作第二个粘性菜单。当您向下滚动时，我有第二个导航更改其类，这似乎工作正常。但是，一旦您向上滚动，我希望它回到原来的类。有什么帮助吗？代码如下。

```
<script type="text/javascript">        
$(window).scroll(function () { 
        if (window.scrollY > 200)
        {
      $("#top-bar").removeClass("nav-main").addClass("navbar-inner").addClass("navbar-fixed-top"); 
    }

    });
</script> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:46:15.000

也许类似于 else 的东西可以恢复原始类。

```
<script type="text/javascript">        
$(window).scroll(function () { 
        if (window.scrollY > 200) {
           $("#top-bar").removeClass("nav-main").addClass("navbar-inner").addClass("navbar-fixed-top"); 
        } else {
           $("#top-bar").addClass("nav-main").removeClass("navbar-inner").removeClass("navbar-fixed-top"); 
        }

    });
</script> 
```

# php - 将 1 年减去一个日期 php/mysql

> ID：12391617
> 
> 赞同：0
> 
> 时间：2012-09-12T15:29:08.813
> 
> 标签：php, mysql, date

我试图从我的数据库中选择一些东西，但我做了一个图表，所以为了比较 In eed 相同的值，但对于前几年。

我也做过类似的事情：

```
$query254="
  SELECT SUM(honoraires) 
  FROM versements 
  WHERE `date_reception`=DATE_SUB(".$dates3[$i3].", INTERVAL 365 DAY)";

  $resultat254 = mysql_query($query254) or die(mysql_error());
  $rowing254 = mysql_fetch_array($resultat254); ?> 
```

问题是它不起作用，实际上它选择了同一年的值。不减去 365 天。

所以我不知道该怎么办。

接受我最崇高的敬意。

SP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:40:34.793

如果您不介意在将其放入 MySQL 查询之前在 php 中执行此操作。只需这样做：

```
$tempdate = date('Y-m-d',strtotime($dates3[$i3] . ' -1 year'));
$query254="
  SELECT SUM(honoraires) 
  FROM versements 
  WHERE `date_reception`='{$tempdate}'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:40:11.270

```
$query254="SELECT 
SUM(honoraires) 
FROM 
versements 
WHERE 
`date_reception`=date(".mysql_real_escape_string($dates3[$i3])." - INTERVAL 1 YEAR)"; 
```

# sql - 选择具有几乎相同数据的行，除了 1 个字段

> ID：12391618
> 
> 赞同：2
> 
> 时间：2012-09-12T15:29:10.307
> 
> 标签：sql, sql-server

如果我在 SQL 数据库（访问前端）中有几行，除了一个字段之外，数据几乎完全一致（我知道规范化，但我很高兴地说这不是我做的！），有没有一种简单的方法来选择一行使用公共数据并将其他字段的所有值一起显示？我可以编写一个函数以编程方式完成它，但我想知道有更简单的方法吗？

例如

```
animal   brown   dog

animal   brown   cat

animal   brown   horse 
```

作为

```
animal   brown   dog, cat, horse 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:48:36.863

你可以[`STUFF()`](http://msdn.microsoft.com/en-us/library/ms188043.aspx)用来得到这个：

```
select distinct col1, col2,
  Stuff((SELECT N', ' + col3 
         FROM yourtable t2
         where t1.col1 = t2.col1
         FOR XML PATH(''),TYPE)
        .value('text()[1]','nvarchar(max)'),1,2,N'')
from yourtable t1 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/6ef26/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:47:30.210

以下是您需要使用的技术示例：

```
select 'test' as Test, 1 as Item 
into #test 
union select 'test2', 2 
union select 'test', 3 
union select NUll, 4 
union select 'test', 5 

select t2.test, STUFF((SELECT  ', ' + cast(t1.Item as varchar (10) )
        FROM #test t1 where t2.test = t1.test 
        FOR XML PATH('')), 1, 1, '') 
     from #test t2
     group by t2.test 
```

# python - 在 python 中设计类的最佳方法

> ID：12391621
> 
> 赞同：10
> 
> 时间：2012-09-12T15:29:14.727
> 
> 标签：python, oop, class, coding-style

因此，对于试图理解类的人来说，这更像是一个哲学问题。

大多数时候，我如何使用类实际上是一种非常糟糕的使用方式。我想到了很多函数，一段时间后只是缩进代码并使其成为一个类，如果一个变量重复很多，用 self.variable 替换一些东西。（我知道这是不好的做法）但无论如何......我要问的是：

```
 class FooBar:
       def __init__(self,foo,bar):
           self._foo = foo
           self._bar = bar
           self.ans = self.__execute()

       def __execute(self):
            return something(self._foo, self._bar) 
```

现在有很多方法可以做到这一点：

```
 class FooBar:
         def __init__(self,foo):
           self._foo = foo

       def execute(self,bar):
            return something(self._foo, bar) 
```

你能建议哪个不好，哪个更糟吗？

或任何其他方式来做到这一点。

这只是一个玩具示例（offcourse）。我的意思是，如果有一个函数，这里就不需要有一个类.. 但是让我们说 __execute something() 调用一整套其他方法.. ?? 谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T15:32:47.443

如果每个`FooBar`人都负责，`bar`那么第一个是正确的。如果`bar`只需要`execute()`而不是`FooBar`的问题，则第二个是正确的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T15:51:49.137

**一句话，您在这里要担心的正式术语是*Separation of Concerns***。

In response to your specific example, which of the two examples you choose depends on the concerns solved by `FooBar` and `bar`. If `bar` is in the same problem domain as `FooBar` or if it otherwise makes sense for `FooBar` to store a reference to `bar`, then the second example is correct. For instance, if `FooBar` has multiple methods that accept a `bar` and if you always pass the same instance of `bar` to each of a particular `FooBar` instance's `bar`-related methods, then the prior example is correct. Otherwise, the latter is more correct.

Ideally, each class you create should model exactly one major concern of your program. This can get a bit tricky, because you have to decide the granularity of "major concern" for yourself. Look to your dependency tree to determine if you're doing this correctly. It should be relatively easy to pull each individual class out of your program and test it in isolation from all other classes. If this is very difficult, you haven't split your concerns correctly. More formally, good separation of concerns is accomplished by designing classes which are [**cohesive** and **loosely coupled**](http://jasoncoffin.com/2011/03/10/cohesion-and-coupling-principles-of-orthogonal-object-orientated-programming/).

While this isn't useful for the example you posted, one simple pattern that helps accomplish this on a broader scale is Inversion of Control (IoC, sometimes called Dependency Injection). Under IoC, classes are written such that they aren't aware of their dependencies directly, only the interfaces (protocols in Python-speak) which their dependencies implement. Then at run time, typically during application initialization, instances of major classes are created by factories, and they are assigned references to their actual dependencies. See [this article](http://wiki.python.org/moin/DependencyInjectionPattern) (with [this example](http://code.activestate.com/recipes/413268/)) for an explanation of how this can be accomplished in Python.

Finally, learn [the four tenets of object-oriented programming](http://codingarchitect.wordpress.com/2006/09/27/four-tenets-of-oop/).

# javascript - 何时在“自动完成”中调用“焦点”

> ID：12391627
> 
> 赞同：2
> 
> 时间：2012-09-12T15:29:37.447
> 
> 标签：javascript, jquery

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)中的“焦点”文档指出：

> focusType:autocompletefocus 在焦点移动到一个项目之前（不是选择），ui.item 指的是焦点项目。焦点的默认操作是将文本字段的值替换为焦点项的值，但前提是焦点事件是由键盘交互触发的。取消此事件会阻止更新值，但不会阻止菜单项获得焦点。
> 
> 代码示例
> 
> 提供一个回调函数来处理作为初始化选项的焦点事件。$( ".selector" ).autocomplete({ focus: function(event, ui) { ... } }); 按类型绑定到焦点事件：autocompletefocus。$( ".selector" ).bind( "autocompletefocus", function(event, ui) { ... });

使用下面的代码在所有自动完成元素上设置一个名为“mytag”的属性，其值为“tester”，即使我没有选择这些元素。为什么仅在聚焦下拉菜单之一时不添加属性“焦点”，而不是在加载页面时添加？

```
 $("#myDiv").autocomplete({
    source: availableTags,
    focus: function(event, ui) {
        $(".ui-autocomplete li").attr("mytag", "tester");
    }
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:35:54.823

当用鼠标悬停在建议的完成上或用箭头键选择一个时。这是一个正常的“焦点”，应用于自动完成框。
自己试试吧：http: [//jsfiddle.net/qk9gv/](http://jsfiddle.net/qk9gv/)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:31:32.417

当自动完成附加到的输入变为“焦点”时..即您可以开始输入的那一刻。

# javascript - 如何使用 JavaScript 上传嵌入的图像？

> ID：12391628
> 
> 赞同：16
> 
> 时间：2012-09-12T15:29:36.943
> 
> 标签：javascript, image, upload

我想构建一个简单的 HTML 页面，其中包含 JavaScript 来执行表单 POST，其中包含嵌入在 HTML 中的图像数据与磁盘上的文件。

我看过这篇可以使用常规表单数据的帖子，但我对图像数据感到困惑。

[JavaScript 发布请求，如表单提交](https://stackoverflow.com/questions/133925/javascript-post-request-like-a-form-submit)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-18T04:25:53.267

# ** 更新 ** 2014 年 2 月 **

可作为 jQuery 插件使用的新版本和改进版本： [https ://github.com/CoeJoder/jquery.image.blob](https://github.com/CoeJoder/jquery.image.blob)

## 用法：

```
$('img').imageBlob().ajax('/upload', {
    complete: function(jqXHR, textStatus) { console.log(textStatus); } 
}); 
```

* * *

## 要求

*   [画布](https://developer.mozilla.org/en-US/docs/DOM/HTMLCanvasElement)元素( HTML 5)
*   [表单数据](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData)
*   [XMLHttpRequest.send](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#send) (:FormData)
*   [Blob 构造函数](https://developer.mozilla.org/en-US/docs/DOM/Blob#Constructor)
*   [Uint8Array](https://developer.mozilla.org/en-US/docs/JavaScript_typed_arrays/Uint8Array)
*   [atob()](https://developer.mozilla.org/en-US/docs/DOM/window.atob) ,[逃逸()](https://developer.mozilla.org/en-US/docs/DOM/window.escape?redirectlocale=en-US&redirectslug=DOM:window.escape)

因此，浏览器要求是：

*   铬：20+
*   火狐：13+
*   互联网浏览器：10+
*   歌剧：12.5+
*   野生动物园：6+

注意：图像必须与您的 JavaScript**同源**，否则浏览器安全策略将阻止调用`canvas.toDataURL()`（有关更多详细信息，请参阅此 SO 问题：[为什么 canvas.toDataURL() 会引发安全异常？](https://stackoverflow.com/questions/2390232/why-does-canvas-todataurl-throw-a-security-exception)）。如该帖子的答案中所述，可以使用代理服务器通过响应标头注入来规避此限制。

这是下面代码的[jsfiddle](http://jsfiddle.net/keWkJ/3/)。它应该抛出错误消息，因为它没有提交到真实的 URL ('/some/url')。使用 firebug 或类似工具检查请求数据并验证图像是否序列化为表单数据（页面加载后单击“运行”）：

![发布数据](../Images/f8f87fb9e3f3649fa470ba8d26d711de.png)

## 示例标记

```
<img id="someImage" src="../img/logo.png"/> 
```

## JavaScript

```
(function() {
    // access the raw image data
    var img = document.getElementById('someImage');
    var canvas = document.createElement('canvas');
    var ctx = canvas.getContext('2d');
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);
    var dataUrl = canvas.toDataURL('image/png');
    var blob = dataUriToBlob(dataUrl);

    // submit as a multipart form, along with any other data
    var form = new FormData();
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/some/url', true);    // plug-in desired URL
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                alert('Success: ' + xhr.responseText);
            } else {
                alert('Error submitting image: ' + xhr.status);
            }
        }
    };
    form.append('param1', 'value1');
    form.append('param2', 'value2');
    form.append('theFile', blob);
    xhr.send(form);

    function dataUriToBlob(dataURI) {
        // serialize the base64/URLEncoded data
        var byteString;
        if (dataURI.split(',')[0].indexOf('base64') >= 0) {
            byteString = atob(dataURI.split(',')[1]);
        }
        else {
            byteString = unescape(dataURI.split(',')[1]);
        }

        // parse the mime type
        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]

        // construct a Blob of the image data
        var array = [];
        for(var i = 0; i < byteString.length; i++) {
            array.push(byteString.charCodeAt(i));
        }
        return new Blob(
            [new Uint8Array(array)],
            {type: mimeString}
        );
    }
})(); 
```

## 参考

SO：['将 DataURI 转换为文件并附加到 FormData](https://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T20:23:11.987

假设您正在谈论嵌入式图像数据，例如[http://en.wikipedia.org/wiki/Data_URI_scheme#HTML](http://en.wikipedia.org/wiki/Data_URI_scheme#HTML)

****如果我的假设不正确，请忽略此答案。**

您可以使用 XMLHttpRequest 将其作为 JSON 发送。这是示例代码：（您可能希望在发送前删除标题部分（'data:image/png;base64,'））

**图片**

```
<img id="myimg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"> 
```

**按钮**

```
<input id="subbtn" type="button" value="sub" onclick="sendImg()"></input> 
```

**脚本**

```
function sendImg() {
    var dt = document.getElementById("myimg").src;
    var xhr = new XMLHttpRequest();
    xhr.open("POST", '/Home/Index', true); //put your URL instead of '/Home/Index'
    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) { //4 means request finished and response is ready
            alert(xhr.responseText);
        }
    };
    var contentType = "application/json";
    xhr.setRequestHeader("Content-Type", contentType);

    for (var header in this.headers) {
        xhr.setRequestHeader(header, headers[header]);
    }

    // here's our data variable that we talked about earlier
    var data = JSON.stringify({ src: dt });

    // finally send the request as binary data
    xhr.send(data);
} 
```

***编辑***

正如@JoeCoder 建议的那样，您也可以使用 FormData 对象并以二进制格式发送，而不是 json。查看他的[答案](https://stackoverflow.com/a/12470362/441860)以获取更多详细信息。

# java - 使用 ChannelSftp 下载大文件时文件传输不完整

> ID：12391636
> 
> 赞同：0
> 
> 时间：2012-09-12T15:30:02.097
> 
> 标签：java, sftp, jsch, vfs

**设想**

我正在尝试使用 Apache VFS 从 SFTP 服务器（Proftpd）以 Java 编程方式下载一个大文件（> 3 GB）。Apache VFS 在内部使用来自 JSch 的 ChannelSftp。

**环境**

*   Ubuntu Linux 服务器 12.4
*   Profptd 1.3.4a
*   开放SSH

**问题**

在大约 2 GB 的数据之后，会话关闭并且从 ChannelSftp 抛出 IOException。

**解决方法**

*   使用 OpenSSH SFTP 服务器和 Java 客户端问题不会出现
*   使用 sftp 客户端和 Proftpd 它也可以工作

**问题**

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:34:52.410

jsch.ChannelSftp 无法处理 Proftpd 的密钥更新方法。此问题影响版本 0.1.46。在 0.1.38 版本中，它被认为是固定的，但它似乎只适用于其他 sftp 服务器。

要解决此问题，只需使用 Proftpd 指令

```
SFTPRekey none 
```

# javascript - 在javascript中声明值后返回零

> ID：12391639
> 
> 赞同：0
> 
> 时间：2012-09-12T15:30:07.827
> 
> 标签：javascript, html

我正在尝试制作一个画廊查看器，网页在其上显示真实图像的缩略图，然后当单击图像时，显示原始图像（具有原始大小），包含 html“img”元素的 div 更改为可见（否则默认设置为隐藏），同时我试图获取图像的尺寸，以便我可以正确地将不同尺寸的图像居中。到他们的宽度，我遇到的问题是，每当我在页面加载后第一次单击任何拇指时，获取图像宽度的语句发送 0，然后单击任何其他图像而不重新加载页面（包括前一个）它显示了前一个图像的尺寸，有时它可以工作，有时不能（大部分没有），请帮帮我。javascript代码如下。

```
// JavaScript Document
$(document).ready(function() {
$.post(

"loadup.php",
        {
            refer:"yes"
        },function(response){
            $("#gallery_view_tab").html(response);
            initAll();
    });
});

function initAll(){
    $("<div id='imgViewer'></div>").appendTo("body"); //set up image viewer
    $("#imgViewer").insertBefore("#monster_wrap"); //set before monster_wrap

    var thumbimgs = $(".thumbimg");
    for(i=0; i<thumbimgs.length; i++){
        var thumbimg = thumbimgs[i].id;
        var thumbid = '#'+thumbimg;
        $(thumbid).click(loadImgviewer);
    }
}

function loadImgviewer(){
    var imgLink = this.getAttribute("data-link");
    $("<img id='closeImgviewer' src='images/close.png' /><img src='' id='imgview' />").appendTo("#imgViewer");
    $("#imgview").attr('src', imgLink);
    $("#imgViewer").css('visibility', 'visible');
        imgwidth = $("#imgview").width();
        screenwidth = $(window).width();
        var pos = (screenwidth - imgwidth)/2;
        $("#log").html(pos);
        $("#imgview").css('margin-left', pos);

$("#closeImgviewer").click(unloadImgviewer); //set click event handler on image view closer

}

function unloadImgviewer(){
    $("#imgViewer").css('visibility', 'hidden');
    $("#imgview").attr('src', '');
    $("#imgViewer").empty();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:17:16.697

我只是稍微重写了你的代码。

```
$(document).ready(function() {
    $.post(
        "loadup.php",
         {
             refer:"yes"
         },
         function(response){
             $("#gallery_view_tab").html(response);
             initAll();
         }
    );
});

function initAll(){
    $("<div id='imgViewer'></div>").appendTo("body"); //set up image viewer
    $("#imgViewer").insertBefore("#monster_wrap"); //set before monster_wrap
    $(".thumbimg").on('click', loadImgviewer);
}

function loadImgviewer(){
    var imgwidth, pos,
        screenwidth = $(window).width();
    var imgLink = this.getAttribute("data-link");
    $("<img id='closeImgviewer' src='images/close.png' /><img src='' id='imgview' />").appendTo("#imgViewer");
    $("#imgview").attr('src', imgLink).on('load',function(evt){
        imgwidth = $(this).width();
        pos = (screenwidth - imgwidth) / 2;
        $("#log").html(pos);
        $("#imgview").css('margin-left', pos);
        $("#imgViewer").css('visibility', 'visible');
    };
    $("#closeImgviewer").click(unloadImgviewer); //set click event handler on image view closer
}

function unloadImgviewer(){
    $("#imgViewer").css('visibility', 'hidden');
    $("#imgview").attr('src', '');
    $("#imgViewer").empty();
} 
```

请试试我们的。没有尝试过，但我认为它应该可以工作。

# html - 选择时导航下拉菜单会关闭

> ID：12391640
> 
> 赞同：0
> 
> 时间：2012-09-12T15:30:08.383
> 
> 标签：html, css, drop-down-menu

我有一个下拉菜单，当它被选中时，如下图所示：

![在此处输入图像描述](../Images/d9dab8e740c14446e16be3c4daf4adc5.png)

应该有一个比“快速观看”更长的列表，但它似乎被切断了，这是为什么呢？

HTML：

```
<div id="top_bar">
<div id="top_inner">
<div id="logo"> <a href="http://www.edosbornephotography.com"><img src="images/logo.gif" alt="Ed Osborne" width="225" height="115" class="logo"></a></div>
<div class="nav">
<ul class = "menu" >
            <li> <a href = "#" > Home </a> </li>
            <li><a href = "#" > Tutorials </a>
        <ul class = "submenu" >
            <li> <a href = "#" > CSS </a> </li>
            <li> <a href = "#"> Javascript </a> </li>
            <li> <a href = "#" > jQuery </a> </li>
            <li> <a href = "#"> HTML </a> </li>
            <li> <a href = "#" > PHP </a> </li>
        </ul>
        </li>

        <li><a href = "#" > Code </a>
        <ul class = "submenu" >
        <li> <a href = "#" > Watch in Flash </a> </li>
        <li> <a href = "#" > Date with JS </a> </li>
        <li> <a href = "#" > XML AS </a> </li>
        <li> <a href = "#" > RSS and PHP </a> </li>
        <li> <a href = "#" > ASP to Excel </a> </li>
        <li> <a href = "#" > PHP to Excel </a > </li>
        </ul>
        </li>

        <li> <a href = "#" > About Us </a> </li>
        <li> <a href = "#" > Privacy </a> </li>
        <li> <a href = "#" > RSS </a> </li>
        <li> <a href = "#" > Contact </a> </li>
        </ul>
    </div>
</div>

<div></div>
</body>
</html> 
```

CSS：

```
#top_bar {
width: 100%;
height: 145px;
background: #000000;
overflow: hidden;
}

#top_inner {
text-align: center;
margin: 0 auto;
width: 1000px;
height: 144px;
}

#logo {
float: left;
padding-top: 20px;
padding-right: 82px;
}

body {
margin: 0; padding: 0;
font: 12px normal Arial, Helvetica, sans-serif;
background: #FFF url(../images/body_bg.gif) repeat-x;
}

.nav {
margin: 0 auto;
position: relative;
padding-top: 85px;
}

ul.menu {
list-style: none;
padding: 0 15px;
margin: 0;
float: left;
background: #222;
font-size: 1.2em;
background: url(../images/topnav_bg.gif) repeat-x;
}

ul.menu li {
float: left;
margin: 0;  
padding: 0 15px 0 0;
position: relative; 
}

ul.menu li a{
padding: 10px 15px;
color: #fff;
display: block;
text-decoration: none;
float: left;
}

ul.menu li a:hover{
background: url(../images/topnav_hover.gif) no-repeat center top;
}

ul.menu li span { 
width: 17px;
height: 35px;
float: left;
background: url(../images/subnav_btn.gif) no-repeat center top;
}

ul.menu li span.subhover {background-position: center bottom; cursor: pointer;} 

ul.menu li ul.submenu {
list-style: none;
position: absolute; 
left: 0; top: 35px;
background: #333;
margin: 0; padding: 0;
display: none;
float: left;
width: 170px;
-moz-border-radius-bottomleft: 5px;
-moz-border-radius-bottomright: 5px;
-webkit-border-bottom-left-radius: 5px;
-webkit-border-bottom-right-radius: 5px;
border: 1px solid #111;
}

ul.menu li ul.submenu li{
margin: 0; padding: 0;
border-top: 1px solid #252525; 
border-bottom: 1px solid #444; 
clear: both;
width: 170px;
}

ul.menu li ul.submenu li a {
float: left;
width: 145px;
background: #333 url(../images/dropdown_linkbg.gif) no-repeat 10px center;
padding-left: 20px;
}

ul.menu li ul.submenu li a:hover { 
background: #222 url(../images/dropdown_linkbg.gif) no-repeat 10px center; 
} 
```

任何人都可以解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:52:31.707

添加

```
ul.menu li:hover ul { display:block; } 
```

并从中删除

```
#top_bar { overflow: hidden; } 
```

[jsfiddle](http://jsfiddle.net/lalatino/NRWkq/)

# html - 如何将 textarea 标签放在 div 标签中？

> ID：12391643
> 
> 赞同：3
> 
> 时间：2012-09-12T15:30:24.853
> 
> 标签：html, tags

我想在我的网页上放置一个 textarea，但它必须在 div 标签内才能保持我的布局。我不希望用户能够重新调整 textarea 的大小，直到它超出我放入的 div 标签，它会弄乱孔布局。有没有办法在 textarea 上设置最大尺寸？

感谢帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:32:27.677

**CSS：**

```
textarea {
    width:400px;
    height:200px;
    resize:none; /* disable resize functionality */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:33:31.347

最简单的方法（虽然它有点草率）是内嵌 textarea 的样式。如果您定义宽度和调整大小：无，您的用户将无法调整文本区域的大小并破坏您的设计。

```
<div>
  <textarea name="yourtextarea" style="width:300px;height:200px;resize:none;" /></textarea>
</div> 
```

但是，我建议您将 textarea 的样式与 Xander 的回答类似，因为它更干净。不过我会改变一件事，那就是添加一个不太通用的选择器。

```
<head> // place in your header
  <style type="text/css">
    #textAreaId {
      width:300px;
      height:200px;
      resize:none;
    }
  </style>
</head>

<body> // place inside of your div, within the body tag

  <div>
    <textarea id="textAreaId" name="yourtextarea" /></textarea>
  </div>

<body> 
```

# python - 删除元组的聪明方法

> ID：12391645
> 
> 赞同：4
> 
> 时间：2012-09-12T15:30:29.050
> 
> 标签：python, tuples

我有一个元组列表，如下所述（此元组按第二个值的降序排序）：

```
from string import ascii_letters
myTup = zip (ascii_letters, range(10)[::-1])
threshold = 5.5

>>> myTup
[('a', 9), ('b', 8), ('c', 7), ('d', 6), ('e', 5), ('f', 4), ('g', 3), ('h', 2), \
('i', 1), ('j', 0)] 
```

给定一个阈值，丢弃第二个值小于该阈值的所有元组的最佳方法是什么。

我有超过 500 万个元组，因此不想逐个元组执行比较元组，从而删除或添加到另一个元组列表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:37:14.630

由于元组已排序，您可以简单地搜索值低于阈值的第一个元组，然后使用切片表示法删除剩余的值：

```
index = next(i for i, (t1, t2) in enumerate(myTup) if t2 < threshold)
del myTup[index:] 
```

正如 Vaughn Cato 所指出的，二分搜索会加快速度。`bisect.bisect`会很有用，除非您创建一个单独的键序列，否则它将不适用于您当前的数据结构，如此[处](http://docs.python.org/library/bisect.html#other-examples)所述。但这违反了您禁止创建新列表的规定。

不过，您可以使用[源代码](http://hg.python.org/cpython/file/2.7/Lib/bisect.py)作为您自己的二进制搜索的基础。或者，您可以更改数据结构：

```
>>> myTup
[(0, 'a'), (1, 'b'), (2, 'c'), (3, 'd'), (4, 'e'), (5, 'f'), 
 (6, 'g'), (7, 'h'), (8, 'i'), (9, 'j')]
>>> index = bisect.bisect(myTup, (threshold, None))
>>> del myTup[:index]
>>> myTup
[(6, 'g'), (7, 'h'), (8, 'i'), (9, 'j')] 
```

这里的缺点是删除可能会在线性时间内发生，因为 Python 必须将整个内存块移回......除非 Python 很聪明地删除从`0`. （有人知道吗？）

最后，如果你*真的*愿意改变你的数据结构，你可以这样做：

```
[(-9, 'a'), (-8, 'b'), (-7, 'c'), (-6, 'd'), (-5, 'e'), (-4, 'f'), 
 (-3, 'g'), (-2, 'h'), (-1, 'i'), (0, 'j')]
>>> index = bisect.bisect(myTup, (-threshold, None))
>>> del myTup[index:]
>>> myTup
[(-9, 'a'), (-8, 'b'), (-7, 'c'), (-6, 'd')] 
```

（请注意，Python 3 会抱怨`None`比较，所以你可以使用类似的东西`(-threshold, chr(0))`。）

我怀疑我一开始建议的线性时间搜索在大多数情况下都是可以接受的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T18:02:17.433

这是一种奇特的方法，它在执行 bisect 之前将列表包装在类似列表的对象中。

```
import bisect

def revkey(items):
    class Items:
        def __getitem__(self, index):
            assert 0 <= index < _len
            return items[_max-index][1]
        def __len__(self):
            return _len
        def bisect(self, value):
            return _len - bisect.bisect_left(self, value)
    _len = len(items)
    _max = _len-1
    return Items()

tuples = [('a', 9), ('b', 8), ('c', 7), ('d', 6), ('e', 5), ('f', 4), ('g', 3), ('h', 2), ('i', 1), ('j', 0)]

for x in range(-2, 12):
    assert len(tuples) == 10
    t = tuples[:]
    stop = revkey(t).bisect(x)
    del t[stop:]
    assert t == [item for item in tuples if item[1] >= x] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:40:19.070

可能比@Curious 的代码快一点：

```
newTup=[]
for tup in myTup:
    if tup[1]>threshold:
        newTup.append(tup)
    else:
        break 
```

因为元组是有序的，所以您不必遍历所有元组。

另一种可能性也是，使用二分法，并找到`i`最后一个元素的索引，该索引高于阈值。然后你会这样做：

```
newTup=myTup[:i] 
```

我认为最后一种方法是最快的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T15:40:25.050

你也可以使用`itertools`例如

```
from itertools import ifilter
iterable_filtered = ifilter(lambda x : x[1] > threshold, myTup) 
```

如果您想要一个可迭代的过滤列表，或者只是：

```
filtered = filter(lambda x: x[1] > threshold, myTup) 
```

直接进入列表。

我对这些方法的相对性能不太熟悉，因此必须对其进行测试（例如，在[IPython 中使用 %timeit](http://scienceoss.com/test-the-speed-of-your-code-interactively-in-ipython/)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T15:35:16.343

鉴于您正在处理的元组数量，您可能需要考虑使用[NumPy](http://docs.scipy.org)。

定义一个[结构化数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)，如

```
my_array= np.array(myTup, dtype=[('f0',"|S10"), ('f1',float)]) 
```

您可以访问元组的第二个元素，`myarray['f1']`从而为您提供一个浮点数组。你可以知道使用[花哨的索引](http://docs.scipy.org/doc/numpy/user/basics.indexing.html)技术来过滤你想要的元素，比如

```
my_array[myarray['f1'] < threshold] 
```

仅保留 your`f1`小于 your `threshold`..的条目

# grails - 是否有 Grails“加载插件”/“加载所有插件”事件？

> ID：12391649
> 
> 赞同：1
> 
> 时间：2012-09-12T15:30:35.057
> 
> 标签：grails, quartz-scheduler, grails-plugin

我正在构建一个 Grails 插件，它将使用[quartz 插件](http://grails.org/plugin/quartz)安排作业。我可以使用该`static triggers`部分安排作业，并且作业运行良好。但我也想使用[Job.schedule 方法](http://grails-plugins.github.com/grails-quartz/guide/triggers.html)动态调度作业，当我从引导程序调用此方法时，我收到以下错误：`No signature of method: static TransmitterRenameJob.schedule() is applicable for argument types: (java.lang.String)`.

为什么我的工作（与我静态调度的工作完全相同）缺少 schedule 方法？我应该在哪里放置代码来动态安排我的工作？

**编辑：**

在进一步的研究中，似乎 Quartz 插件直到引导程序运行后才加载，因此尚未注入 schedule 方法。在我的代码中的什么时候可以保证所有插件都已加载？是否有我可以订阅的插件加载事件？

# java - Spring Authentication 查看其他会话

> ID：12391652
> 
> 赞同：0
> 
> 时间：2012-09-12T15:30:38.900
> 
> 标签：java, spring, session, spring-security

我知道我可以为具有当前活动会话的用户获取所有会话，并且我知道我可以获取所有主体，它将显示所有具有活动会话的用户。但我想知道是否可以为特定用户获取所有会话。因此，假设我是当前活动会话的 userA，我想获取所有主体，然后选择其中一个主体，然后为该特定主体选择 g​​etAllSessions。这可能吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:08:13.340

您正在谈论[`SessionRegistry`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/core/session/SessionRegistry.html)并且在 API 中有[`getAllSessions(Object principal, boolean includeExpiredSessions)`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/core/session/SessionRegistry.html#getAllSessions%28java.lang.Object,%20boolean%29)您可以使用的方法。例如：

```
List<Object> allPrincipals = getAllPrincipals();
Object principal = allPrincipals.get(0); // change this to way you want
List<SessionInformation> principalSessions = getAllSessions(principal, false); 
```

请记住，主体对象可以是任何东西，例如[`User`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/core/userdetails/User.html)或您自己的实现，但**它****必须`equals()``hashCode`**正确定义。

# java - 防止 wmic.exe 写入 TempWmicBatchFile.bat

> ID：12391655
> 
> 赞同：4
> 
> 时间：2012-09-12T15:30:53.697
> 
> 标签：java, virtual-keyboard, temporary-files, wmic, on-screen-keyboard

我想在我的 Java 应用程序中检查 Windows 虚拟键盘是否已经在运行。

我搜索它并发现，我可以用它`wmic.exe`来搜索一个进程。

这就是我正在做的事情：

```
Process proc = Runtime.getRuntime().exec("wmic.exe");
BufferedReader input = new BufferedReader(new InputStreamReader(proc
    .getInputStream()));
OutputStreamWriter oStream = new OutputStreamWriter(proc
    .getOutputStream());
oStream .write("process where name='osk.exe' get caption");
oStream .flush();
oStream .close();
input.readLine();
while ((in = input.readLine()) != null) {
    if (in.contains("osk.exe")) {
        input.close();
        proc.destroy();
        return;
    }
}
input.close();
proc.destroy(); 
```

这是可行`wmic`的，但是以某种方式`TempWmicBatchFile.bat`使用`process where name='osk.exe' get caption`.

我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:17:01.067

您可以避免打开其他流来传递另一个命令。这就是创建临时 bat 文件的原因。

使用下面的代码。它不会创建临时批处理文件

```
public class WmicTest {

    public static void main(String[] args) throws IOException {

        Process proc = Runtime.getRuntime().exec("wmic.exe process where name='osk.exe' get caption");
        BufferedReader input = new BufferedReader(new InputStreamReader(proc
                .getInputStream()));
//        OutputStreamWriter oStream = new OutputStreamWriter(proc
//                .getOutputStream());
//        oStream.write("process where name='osk.exe' get caption");
//        oStream.flush();
 //       oStream.close();
        input.readLine();
        String in;
        while ((in = input.readLine()) != null) {
            if (in.contains("osk.exe")) {
                System.out.println("Found");
                input.close();
                proc.destroy();
                return;
            }
        }
        input.close();
        proc.destroy();
    }
} 
```

# .htaccess - 重定向但不显示 URL redirec :: htaccess？

> ID：12391661
> 
> 赞同：0
> 
> 时间：2012-09-12T15:31:11.657
> 
> 标签：.htaccess, redirect

我需要将一些用户重定向到子域，但我不希望他们知道他们在子域中。他们应该认为他们在主要领域。我相信这可以通过 htaccess 来完成，但这对我来说是胡言乱语。

有人可以给我一些骨头吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:05:24.870

当提供来自不同域的内容而不重定向浏览器（从而更改地址栏中的 URL）时，需要发生两件事之一。要么有另一个域的**文件路径**解析，要么必须设置[反向代理（如果加载了 mod_proxy，这很容易做到）。](http://en.wikipedia.org/wiki/Reverse_proxy)

看起来您的子域位于主域的文档根目录中，这意味着此选项将是可行的。因此，如果您想这样做，当有人将此 URL 放在他们的地址栏中时`http://domain.com/page`，他们会获得[http://sub.domain.com/another-page](http://sub.domain.com/another-page)中的内容，您只需将这些规则添加到顶部htaccess 文件位于您的主域 ( `public_html`) 的文档根目录中：

```
RewriteEngine On
RewriteRule ^page(.*)$ /subdomain_folder/another-page$1 [L] 
```

否则，第二个选项是使用 mod_proxy：

```
RewriteEngine On
RewriteRule ^page(.*)$ http://sub.domain.com/another-page$1 [L,P] 
```

* * *

编辑：

> 我想根据他们的 ip（地理位置）将一些用户重定向到另一个子域。是的 public_html 是根

`%{REMOTE_ADDR}` 您可以通过变量检查 IP ：

```
RewriteCond %{REMOTE_ADDR} ^123\.45\.67\.89$
RewriteCond !^/subdomain_folder
RewriteRule ^(.*)$ /subdomain_folder/$1 [L] 
```

# ruby - nil:NilClass 的未定义方法“[]”

> ID：12391662
> 
> 赞同：4
> 
> 时间：2012-09-12T15:31:16.123
> 
> 标签：ruby

我正在编写一个快速脚本，以通过 telnet 从具有 CLI 的设备中提取数据。对于不知道如何处理的错误，我可以使用一点帮助。

```
res = nil
res = t.cmd('actual command').match(/Calls:\s(\d{1,})/)[1].to_i 
```

在某些情况下，该设备正在快速打印出各种自主输出。此外，在此期间，设备有时不会返回导致不匹配的所有输出。因此，我收到以下错误：

```
in `<main>': undefined method `[]' for nil:NilClass (NoMethodError) 
```

我尝试了一些不同的方法，但似乎无法解决这个问题。感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T15:56:52.827

当你看到`undefined method '[]' for nil:NilClass`它意味着：

> 嘿！您有一个`nil`后跟的值`[...]`，但`nil`没有此方法。

在这种情况下，您的问题是`match(...)`有时无法匹配您想要的文本，返回`nil`，然后您无法要求`[1]`。避免这种情况的一些直接方法是：

```
match = t.cmd('actual command').match(/Calls:\s(\d{1,})/)
res = match && match[1].to_i

# or
res = match[1].to_i if match

# or 
res = if (match=t.cmd('actual command').match(/Calls:\s(\d{1,})/))
  match[1].to_i
end

# or
res = (match=t.cmd('actual command').match(/Calls:\s(\d{1,})/)) && match[1].to_i 
```

但是，更简单的解决方案是使用[`String#[]`](http://ruby-doc.org/core-1.9.3/String.html#method-i-5B-5D)方法直接拉出正则表达式捕获：

```
res = t.cmd('actual command')[/Calls:\s(\d+)/,1]
res = res.to_i if res 
```

如果正则表达式失败，`nil`并且您不想调用`to_i`.`nil`

[*我还清理了你的正则表达式，因为`\d{1,}`它相当于`\d+`.*]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:50:19.680

您需要条件来检查匹配结果是否为零。尝试这样的事情：

```
res = nil
res = t.cmd('actual command').match(/Calls:\s(\d{1,})/)[1].to_i rescue nil 
```

res 变量将保持为零，因此您可以稍后对此信息进行一些检查。

# asp.net-mvc - 我对 EntitySet 的嘲笑是错误的吗？

> ID：12391663
> 
> 赞同：1
> 
> 时间：2012-09-12T15:31:17.980
> 
> 标签：asp.net-mvc, linq, moq, mstest, entityset

我是一位经验丰富的程序员，但对 LINQ/Moq/Ninject/MVC/MS Test/etc 不熟悉，并且遇到了一个我无法弄清楚的问题。

我从 Pro ASP.NET MVC 2 Framework 书（但使用 .NET 4.5/MVC 4）构建了 SportsStore 示例。我得到了这个工作，现在我已经开始将它转换为与我们的真实数据库一起工作。此时的主要区别在于，我们不仅有一个 Product 类，还有一个 ProductSub 类。每个产品类由 1 个或多个 ProductSub 组成，我已经用 EntitySet 关联定义了它。为了让 CartController 知道要将哪个 ProductSub 添加到购物车中，我决定将 CartController.AddToCart 更改为使用 productSubId 而不是 productId。

当我运行网站并手动单击“添加产品”时，一切似乎都正常。但是，当我运行单元测试时，我得到一个 NullReferenceException，因为 cart.Lines[0] 为空。我不认为错误出现在 CartController 中，因为当我运行网页时这似乎有效，我尝试使用 FakeProductsRepository（修改为添加 ProductSubID）来排除 Moq 导致此问题（没有帮助，所以我不'认为错误与起订量无关）。

我发现 CartController 中的这一行在单元测试中返回 null 但在我运行网页时没有：

```
productsRepository.ProductSubs.FirstOrDefault(ps => ps.ProductSubID == productSubId); 
```

因此，我尝试对 CartController 进行硬编码，以查看 LINQ to Product 是否可以正常工作，它确实做到了！我认为这意味着 productsRepository 有产品，但由于某种原因，产品没有 ProductSub。到目前为止我是对的吗？

我最好的猜测是单元测试中的这段代码有问题：

```
new Product { ProductID = 2, ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 456} } } 
```

但我不知道是什么。使用List有错吗？我尝试使用 EntitySet 代替，但它得到了同样的错误。

单元测试代码：

```
 [TestMethod]
    public void Can_Add_Product_To_Cart()
    {
        // Arrange: Give a repository with some products...
        var mockProductsRepository = UnitTestHelpers.MockProductsRepository(
            new Product { ProductID = 1, ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 123 } } },
            new Product { ProductID = 2, ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 456 } } }
        );

        var cartController = new CartController(mockProductsRepository, null);
        var cart = new Cart();

        // Act: When a user adds a product to their cart...
        cartController.AddToCart(cart, 456, null);

        // Assert: Then the product is in their cart
        Assert.AreEqual(1, cart.Lines.Count);
        Assert.AreEqual(456, cart.Lines[0].ProductSub.ProductSubID);
    } 
```

购物车类：

```
public class Cart
{
    private List<CartLine> lines = new List<CartLine>();
    public IList<CartLine> Lines { get { return lines.AsReadOnly(); } }

    public void AddItem(ProductSub productSub, int quantity)
    {
        var line = lines.FirstOrDefault(x => x.ProductSub.ProductSubID == productSub.ProductSubID);
        if (line == null)
            lines.Add(new CartLine { ProductSub = productSub, Quantity = quantity });
        else
            line.Quantity += quantity;
    }

    public decimal ComputeTotalValue()
    {
        return lines.Sum(l => (decimal)l.ProductSub.Price * l.Quantity);
    }

    public void Clear()
    {
        lines.Clear();
    }

    public void RemoveLine(ProductSub productSub)
    {
        lines.RemoveAll(l => l.ProductSub.ProductSubID == productSub.ProductSubID);
    }
}

public class CartLine
{
    public ProductSub ProductSub { get; set; }
    public int Quantity { get; set; }
} 
```

产品类别：

```
[Table]
public class Product
{
    [HiddenInput(DisplayValue = false)]
    [Column(Name = "id", IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
    public int ProductID { get; set; }

    [Required(ErrorMessage = "Please enter a product name")]
    [Column]
    public string Name { get; set; }

    [Required(ErrorMessage = "Please enter a description")]
    [DataType(DataType.MultilineText)]
    [Column(Name = "info")]
    public string Description { get; set; }

    public float LowestPrice 
    {
        get { return (from product in ProductSubs select product.Price).Min(); }
    }

    private EntitySet<ProductSub> _ProductSubs = new EntitySet<ProductSub>();
    [System.Data.Linq.Mapping.Association(Storage = "_ProductSubs", OtherKey = "ProductID")]
    public ICollection<ProductSub> ProductSubs
    {
        get { return _ProductSubs; }
        set { _ProductSubs.Assign(value); }
    }

    [Required(ErrorMessage = "Please specify a category")]
    [Column]
    public string Category { get; set; }
}

[Table]
public class ProductSub
{
    [HiddenInput(DisplayValue = false)]
    [Column(Name = "id", IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
    public int ProductSubID { get; set; }

    [Column(Name = "products_id")]
    private int ProductID;
    private EntityRef<Product> _Product = new EntityRef<Product>();
    [System.Data.Linq.Mapping.Association(Storage = "_Product", ThisKey = "ProductID")]
    public Product Product
    {
        get { return _Product.Entity; }
        set { _Product.Entity = value; }
    }

    [Column]
    public string Name { get; set; }

    [Required]
    [Range(0.00, double.MaxValue, ErrorMessage = "Please enter a positive price")]
    [Column]
    public float Price { get; set; }
} 
```

UnitTestHelpers 代码（应该没问题，因为我尝试了 FakeProductsRepository）：

```
 public static IProductsRepository MockProductsRepository(params Product[] products)
    {
        var mockProductsRepos = new Mock<IProductsRepository>();
        mockProductsRepos.Setup(x => x.Products).Returns(products.AsQueryable());
        return mockProductsRepos.Object;
    } 
```

CartController 代码（应该没问题，因为它可以在网页上运行）：

```
 public RedirectToRouteResult AddToCart(Cart cart, int productSubId, string returnUrl)
    {
        //Product product = productsRepository.Products.FirstOrDefault(p => p.ProductID == 2);
        //cart.AddItem(product.ProductSubs.FirstOrDefault(), 1);
        ProductSub productSub = productsRepository.ProductSubs.FirstOrDefault(ps => ps.ProductSubID == productSubId);
        cart.AddItem(productSub, 1);
        return RedirectToAction("Index", new { returnUrl });
    } 
```

FakeProductsRepository 的代码：

```
public class FakeProductsRepository : IProductsRepository
{
    private static IQueryable<Product> fakeProducts = new List<Product> {
        new Product { Name = "Football", ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 123, Price = 25 } } },
        new Product { Name = "Surf board", ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 456, Price = 179 } } },
        new Product { Name = "Running shoes", ProductSubs = new List<ProductSub> { new ProductSub { ProductSubID = 789, Price = 95 } } }
    }.AsQueryable();

    public FakeProductsRepository(params Product[] prods)
    {
        fakeProducts = new List<Product>(prods).AsQueryable();
    }

    public IQueryable<Product> Products
    {
        get { return fakeProducts; }
    }

    public IQueryable<ProductSub> ProductSubs
    {
        get { return fakeProducts.SelectMany(ps => ps.ProductSubs); }
    }

    public void SaveProduct(Product product)
    {
        throw new NotImplementedException();
    }

    public void DeleteProduct(Product product)
    {
        throw new NotImplementedException();
    }
} 
```

如果您需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:47:27.213

即使您提供了很多代码，也缺少一些必要的信息，所以我假设`IProductsRepository.ProductSubs`返回`IQueryable<ProductSub>`。该`MockProductsRepository`方法创建一个模拟，`IProductsRepository`但不做任何设置`IProductsRepository.ProductSubs`。模拟框架很可能会返回一个空的`IQueryable<ProductSub>`.

在`AddToCart`您尝试找到`ProductSub`using `productsRepository.ProductSubs.FirstOrDefault`. 因为模拟返回一个空集合`FirstOrDefault`将返回 null，因此您调用`cart.AddItem(null, 1)`它解释了为什么`cart.Lines[0]`为 null。

在修复模拟之前，您可以考虑进行参数验证，例如

```
public void AddItem(ProductSub productSub, int quantity) 
{ 
    if (productSub == null)
        throw new ArgumentNullException("productSub");
    if (quantity < 1)
        throw new ArgumentOutOfRangeException("quantity"); 
```

然后，当您重新运行测试时，您的问题出在哪里会更清楚。

接下来就是为`IProductsRepository.ProductSubs`in创建一个设置`MockProductsRepository`：

```
mockProductsRepos
  .Setup(x => x.ProductSubs)
  .Returns(products.SelectMany(p => p.ProductSubs).AsQueryable()); 
```

这只是从提供给的对象中创建所有`ProductSub`对象的集合。您当然可以根据需要进行修改。`Product``MockProductsRepository`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T08:34:57.117

感谢 Martin Liversage，我找到了解决方案。模拟错了，但我没弄明白，因为我的 FakeProductsRepository 也错了。由于 Products 和 ProductSubs 之间的依赖关系，我认为他对模拟的建议更改不会起作用（但如果我错了，请纠正我）。

FakeProductsRepository 中的问题是构造函数用空集合覆盖了初始 fakeProducts 集合。一旦我将其更改为仅在提供新集合作为参数时覆盖初始集合，则单元测试使用 FakeProductsRepository 工作。

```
 public FakeProductsRepository(params Product[] products)
    {
        if (products != null)
            fakeProducts = new List<Product>(products).AsQueryable();
    } 
```

因此，模拟存在问题，因为它仍然不起作用。为了解决这个问题，我需要做的就是从 IProductsRepository 中删除 ProductSubs 函数（我原本打算作为快捷方式，但我意识到它搞砸了模拟）。一旦我这样做并通过 CartController 中的 Products 访问 ProductSubs，一切都会再次运行。

```
 public RedirectToRouteResult AddToCart(Cart cart, int productSubId, string returnUrl)
    {
        ProductSub productSub = productsRepository.Products.SelectMany(p => p.ProductSubs).FirstOrDefault(ps => ps.ProductSubID == productSubId);
        cart.AddItem(productSub, 1);
        return RedirectToAction("Index", new { returnUrl });
    } 
```

这就是我所需要的，但为了简化测试代码，我还决定在足够的情况下使用纯 ProductSub 对象，而不是通过 Product 访问它们。我需要整个产品的地方（即当涉及 IProductsRepository 时，我使用了我认为更简洁的代码，然后在一行上创建整个对象（即使用新列表等）：

```
var ps1 = new ProductSub { ProductSubID = 11 };
var p1 = new Product();
p1.ProductSubs.Add(ps1); 
```

# perl - Perl LWP::UserAgent 针对给定服务器随机挂起 120 秒

> ID：12391671
> 
> 赞同：3
> 
> 时间：2012-09-12T15:31:39.097
> 
> 标签：perl, www-mechanize, lwp, lwp-useragent

我注意到使用给定的 https 网站处理`response_data`和`response_done`事件之间大约有 120 秒的延迟。[`WWW::Mechanize`](https://metacpan.org/module/WWW::Mechanize)我使用普通的网络浏览器进行了检查，并没有遇到这种缓慢的情况，所以我怀疑我必须做错什么。

这是我为追踪事件所做的（由于某种原因[`use LWP::Debug qw(+)`](https://metacpan.org/module/LWP::Debug)没有做任何事情）：

```
use WWW::Mechanize;
use Time::HiRes qw(gettimeofday);
use IO::Handle;

my $mech = WWW::Mechanize->new(
  timeout     => 3,
  autocheck   => 1,       # check success of each query
  stack_depth => 0,       # no keeping history
  keep_alive  => 50,      # connection pool
);

$mech->agent_alias( 'Windows IE 6' );
open my $debugfile, '>traffic.txt';
$debugfile->autoflush(1);

$mech->add_handler( request_send => sub {
    my $cur_time = gettimeofday();
    my $req = shift;
    print $debugfile "\n$cur_time === BEGIN HTTP REQUEST ===\n";
    print $debugfile $req->dump();
    print $debugfile "\n$cur_time ===   END HTTP REQUEST ===\n";
    return
  }
);
$mech->add_handler( response_header => sub {
    my $cur_time = gettimeofday();
    my $res = shift;
    print $debugfile "\n$cur_time === GOT RESPONSE HDRS ===\n";
    print $debugfile $res->dump();
    return
  }
);
$mech->add_handler( response_data => sub {
    my $cur_time = gettimeofday();
    my $res = shift;
    my $content_length = length($res->content);
    print $debugfile "$cur_time === Got response data chunk resp size = $content_length ===\n";
    return
  }
);
$mech->add_handler( response_done => sub {
    my $cur_time = gettimeofday();
    my $res = shift;
    print $debugfile "\n$cur_time === BEGIN HTTP RESPONSE ===\n";
    print $debugfile $res->dump();
    print $debugfile "\n===   END HTTP RESPONSE ===\n";
    return
  }
); 
```

这是跟踪的摘录（URL 和 cookie 被混淆了）：

```
1347463214.24724 === BEGIN HTTP REQUEST ===
GET https://...
Accept-Encoding: gzip
Referer: https://...
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Cookie: ...
Cookie2: $Version="1"

(no content)

1347463214.24724 ===   END HTTP REQUEST ===

1347463216.13134 === GOT RESPONSE HDRS ===
HTTP/1.1 200 OK
Date: Wed, 12 Sep 2012 15:20:08 GMT
Accept-Ranges: bytes
...
Server: Lotus-Domino
Content-Length: 377806
Content-Type: application/octet-stream
Last-Modified: Fri, 07 Sep 2012 06:25:33 GMT
Client-Peer: ...
Client-Response-Num: 1
Client-SSL-Cert-Issuer: ...
Client-SSL-Cert-Subject: ...
Client-SSL-Cipher: DES-CBC3-SHA
Client-SSL-Socket-Class: IO::Socket::SSL

(no content)
1347463216.48305 === Got response data chunk resp size = 4096 ===

1347463337.98131 === BEGIN HTTP RESPONSE ===
HTTP/1.1 200 OK
Date: Wed, 12 Sep 2012 15:20:08 GMT
Accept-Ranges: bytes
...
Server: Lotus-Domino
Content-Length: 377806
Content-Type: application/octet-stream
Last-Modified: Fri, 07 Sep 2012 06:25:33 GMT
Client-Date: Wed, 12 Sep 2012 15:22:17 GMT
Client-Peer: ...
Client-Response-Num: 1
Client-SSL-Cert-Issuer: ...
Client-SSL-Cert-Subject: ...
Client-SSL-Cipher: DES-CBC3-SHA
Client-SSL-Socket-Class: IO::Socket::SSL

PK\3\4\24\0\6\0\10\0\0\0!\0\x88\xBC\21Xi\2\0\0\x84\22\0\0\23\0\10\2[Content_Types].xml \xA2...
(+ 377294 more bytes not shown)

===   END HTTP RESPONSE === 
```

在“Got response data chunk”和“BEGIN HTTP RESPONSE”消息期间，您可以看到 121.5 秒的间隔。`LWP::UserAgent`我有一种在收到全部数据后有时会挂起两分钟的感觉。

你有什么线索可以从哪里来吗？

**编辑**这里是 Wireshark 中的屏幕截图：我在 120 秒后收到 FIN/ACK 消息……</p>

![Wireshark 摘录](../Images/14dfc135cf3014caa7d31c1714c4dc00.png)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:35:53.950

我认为您的交易实际上可能需要很长时间。的文档[`LWP::UserAgent`](https://metacpan.org/module/LWP%3a%3aUserAgent)说这个

> [response_data 处理程序] 需要返回一个 TRUE 值，以便为同一请求的后续块再次调用

因此，因为您的处理程序不返回任何内容，所以您只跟踪第一个返回的数据包

根据您的输出，前 4KB 的数据在 2.2 秒内到达，或大约每秒 2KB。整个数据的长度为 369KB，因此您预计会再收到 92 个数据包，而以每秒 2KB 的速度传输需要三分钟。你会在两分钟内得到回复，所以我认为你的时间是合理的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T16:59:30.903

感谢 Borodin 的回答，我找到了解决它的方法：

我以`response_data`这种方式修改了事件处理程序子：

```
if($res->header('Content-Length') == length($res->content)) {
    die "OK"; # Got whole data, not waiting for server to end the communication channel.
}
return 1; # In other cases make sure the handler is called for subsequent chunks 
```

然后如果`X-Died`header 等于`OK`然后忽略调用者中的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-29T17:28:50.637

我知道这已经很老了，但我最近遇到了同样的问题。仅当未加密的 HTTPS 响应（包括标头）的大小正好为 1024 字节时才会发生这种情况。Benoit 的响应似乎正好是 4096 字节，所以 1024 的倍数可能很重要。我无法控制服务器，因此无法生成任意长度的测试响应，也无法在任何其他服务器上重现该问题。不过，在 1024 字节处发生的情况是可重复的。

环顾 LWP 代码（v6.05），我发现 sysread 被要求一次读取 1024 个字节。因此，它第一次返回所有 1024 个字节。然后立即第二次调用它，而不是返回0，表示没有更多数据，而是返回undef，表示错误，并将errno设置为EAGAIN，表示还有更多数据，但尚不可用. 这会导致套接字上的选择，因为不会有更多数据而挂起。超时需要 120 秒，然后返回我们所拥有的数据，这恰好是正确的结果。因此，我们没有错误，只是有很长的延迟。

我没有足够方便的访问权限来使用 Benoit 的解决方案。相反，我的解决方法是扩展 HTTPS 处理代码以检查上述情况并返回 0 而不是 undef：

```
package LWP::Protocol::https::Socket;

sub sysread {
    my $self = shift;
    my $result = $self->SUPER::sysread(@_);
    # If we get undef back then some error occurred. If it's EAGAIN
    # then that ought to mean that there is more data to read but
    # it's not available yet. We suspect the error may be false.
    # $_[2] is the offset, so if it's defined and non-zero we have
    # some data in the buffer.
    # $_[0] is the buffer, so check it for an entire HTTP response,
    # including the headers and the body. If the length specified
    # by Content-Length is exactly the length of the body we have in
    # the buffer, then take that as being complete and return a length
    # here instead. Since it's unlikely that anything was read, the
    # buffer will not have increased in size and the result will be zero
    # (which was the expected result anyway).
    if (!defined($result) &&
        $!{EAGAIN} &&
        $_[2] &&
        $_[0] =~ /^HTTP\/\d+\.\d+\s+\d+\s+.*\s+content-length\s*:\s*(\d+).*?\r?\n\r?\n(.*)$/si &&
        length($2) == $1) {
            return length($_[0]) - $_[2]; # bufferlen - offset
    }
    return $result;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-29T15:54:22.997

艾伦，我在我的系统上收到了同样的行为。对于内容长度 1024、2048、3072 字节等

这个问题的解决方法是将Net::HTTP升级到6.09及以上版本

# c++ - 如何操作char数组

> ID：12391672
> 
> 赞同：0
> 
> 时间：2012-09-12T15:31:39.130
> 
> 标签：c++, c, arrays, char, buffer

我有这样的东西。

```
char header[4096]; //header information from a file 
```

有一个字段称为`startByteOffset`which is `8 bytes`(offset in header is 8) 然后还有`endByteOffset`which is `8 bytes`in lenght. (offset in header is 16). 我需要更改`endByteOffset`. 怎么做？谢谢。如果还不够清楚，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:40:44.390

要将整数分解为字符（字节），您可以使用移位和屏蔽。

```
uint64_t value = /* ... */;
header[endbyteoffset]   = value         & 0xff;
header[endbyteoffset+1] = (value >> 8)  & 0xff;
header[endbyteoffset+2] = (value >> 16) & 0xff;
header[endbyteoffset+3] = (value >> 24) & 0xff;
// ...
header[endbyteoffset+7] = (value >> 56) & 0xff; 
```

您需要知道这些值是以*小端*还是*大端的*顺序存储的。我上面提供的示例是针对小端的；对于big-endian，您只需颠倒班次的顺序，首先从最大班次开始。

# java - java for循环的效率

> ID：12391673
> 
> 赞同：3
> 
> 时间：2012-09-12T15:31:43.733
> 
> 标签：java, memory-management, loops, for-loop

作为这个问题的附录[Java 循环效率（“for”与“foreach”）](https://stackoverflow.com/questions/9226483/java-loop-efficiency-for-vs-foreach)

我有一个简单的问题。增强的 for 循环是否具有更大的内存占用，或者它们会编译成相同的结构，使它们的内存占用相同，从而`for(Object o : collection) { ... }`总是更好地进行只读操作？

我问的原因是，在我正在处理的模拟器中，每帧（60/秒）我都在对数组中可能有数千个项目运行操作，例如要绘制的面、要进行光线跟踪等。循环

```
for(Object o : collection) {
   o.doSomething(); 
} 
```

看起来它可以制作集合的内存副本（我似乎记得我之前的阅读中确实如此）这在大多数情况下是可以的，但如果你每秒执行 30000 次光线跟踪乘以 60 次则不行。

另一方面，很明显循环

```
count = collection.size();
for(i = 0; i < count; i++) {
   collection[i].doSomething();
} 
```

通过参考做所有事情，并且占用空间相对较小，即使它更难阅读（虽然老实说，不多）

有什么想法吗，伙计们？

（注意：阅读 for 循环的难度的影响仅在您进入多层时才明显 - 对于单层 fors 增益非常小。我从经验中这么说......`collection[i].property.subcollection[j].row[k].col[l].prop.subtable[m]`变得令人心碎，特别是如果一些其中需要演员：`((Type3)((Type2)((Type1)collection[i]).property.subcollection[j].row[k]).col[l].prop).subtable[m]`例如。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:37:46.080

如果您有一个使用 hte 的 ArrayList，则以下模式可以是一个微优化

```
for(int i=0, len=list.size(); i < len; i++) 
```

您节省的内存大约为 16-24 字节，因为 for-each 循环将始终创建一个迭代器。

> （60/秒）我正在对数组中可能有数千个项目运行操作，例如要绘制的面部，要针对光线追踪，

对于每秒 60,000 次，您不太可能注意到差异，尤其是因为您正在对每个项目进行相对重要的工作。

> 看起来它可能会制作集合的内存副本

如果在循环遍历列表时更改列表，这不是为什么会得到 ConcurrentModicationException 的原因。一种解决方法是复制一份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:46:33.240

很难说 JIT 将如何优化您的代码（Java 的哪个实现，哪个操作系统等）。这里的要点是 for-each 语法编译为与使用迭代器语法相同的字节码，请参见[此处](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)和[此处](https://stackoverflow.com/questions/2113216/which-is-more-efficient-a-for-each-loop-or-an-iterator)。使用迭代器语法的主要原因是在迭代期间删除项目。请注意，[Iterator](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)接口上的 remove 方法是可选的。

我自己做了一些简单的例子来查看字节码：

对于数组的每次迭代

```
// compiled .class file is 585 bytes
public class ForEachLoop {
  public static void main(String[] args) {
    for(String s : args){
      System.out.println(s);
    }
  }
}

// byte code for main method
public static void main(java.lang.String[]);
  Code:
   Stack=2, Locals=5, Args_size=1
   0:   aload_0
   1:   dup
   2:   astore  4
   4:   arraylength
   5:   istore_3
   6:   iconst_0
   7:   istore_2
   8:   goto    26
   11:  aload   4
   13:  iload_2
   14:  aaload
   15:  astore_1
   16:  getstatic   #16; //Field java/lang/System.out:Ljava/io/PrintStream;
   19:  aload_1
   20:  invokevirtual   #22; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   23:  iinc    2, 1
   26:  iload_2
   27:  iload_3
   28:  if_icmplt   11
   31:  return
  LineNumberTable: 
   line 4: 0
   line 5: 16
   line 4: 23
   line 7: 31

  LocalVariableTable: 
   Start  Length  Slot  Name   Signature
   0      32      0    args       [Ljava/lang/String;
   16      7      1    s       Ljava/lang/String; 
```

数组索引循环

```
// compiled .class file is 554 bytes
public class ArrayLoop {
  public static void main(String[] args) {
    for (int i = 0; i < args.length; i++) {
      System.out.println(args[i]);
    }
  }
}

// byte code for main method
public static void main(java.lang.String[]);
  Code:
   Stack=3, Locals=2, Args_size=1
   0:   iconst_0
   1:   istore_1
   2:   goto    17
   5:   getstatic   #16; //Field java/lang/System.out:Ljava/io/PrintStream;
   8:   aload_0
   9:   iload_1
   10:  aaload
   11:  invokevirtual   #22; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   14:  iinc    1, 1
   17:  iload_1
   18:  aload_0
   19:  arraylength
   20:  if_icmplt   5
   23:  return
  LineNumberTable: 
   line 4: 0
   line 5: 5
   line 4: 14
   line 7: 23

  LocalVariableTable: 
   Start  Length  Slot  Name   Signature
   0      24      0    args       [Ljava/lang/String;
   2      21      1    i       I 
```

我们可以看到**数组迭代字节码更紧凑**（准确地说是 31 个字节）。

# mono - 符号文件 /home/symphony/mono/mcs/class/System.Web/test/bin/Debug/System.Web.dll.mdb 与图像不匹配

> ID：12391676
> 
> 赞同：0
> 
> 时间：2012-09-12T15:31:50.933
> 
> 标签：mono, monodevelop, system.web

当我构建`System.Web-net_4_0.sln`（Ubuntu12.04，monoDevelop）时，结果是构建成功，然后我尝试`System.web.dll`使用测试控制台应用程序进行调试：

```
 public static void Main (string[] args)
    {
        System.Web.UI.Page page=new System.Web.UI.Page();\\**Make a breakpoint here**
        page.ProcessRequest(null);
    } 
```

结果是：

```
Symbol file /home/symphony/mono/mcs/class/System.Web/test/bin/Debug/System.Web.dll.mdb doesn't match image /home/symphony/mono/mcs/class/System.Web/test/bin/Debug/System.Web.dll 
```

任何机构都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:37:28.483

在构建 sln 之后，您是否运行了“sudo make install”（使用 shell，在 mcs/class/System.Web/ 文件夹中）以便新的 DLL 进入您的 GAC 和所有？

此外，最好通过“make”构建程序集，而不是构建 SLN 文件。我不认为构建系统正在使用 SLN 文件进行构建，它们就在那里，因此您可以更轻松地在 IDE 中破解 Mono 源代码。

# c# - 在剃刀网页中将数据从一页传递到另一页

> ID：12391678
> 
> 赞同：1
> 
> 时间：2012-09-12T15:31:54.370
> 
> 标签：c#, razor

我有一个选择表单，它在选择“类别”后刷新自身以显示“子类别”我确实在子类别中进行了验证，以便用户仅在子类别之后进入下一页

我在第 1 页有这样的代码

```
if (IsPost && Validation.IsValid())
{
    parent = Request.Form["parent"];
    Response.Redirect("~/Members/cb/Page2");
} 
```

在第 2 页

```
 @Html.Hidden("parent", Request.Form["parent"]) 
```

但是，我无法在 page2 中获取从第 1 页传递的隐藏值，请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:35:04.970

尝试将 url 中的父级传递到第二页：

```
Response.Redirect("~/Members/cb/Page2?parent=" + Request.Form["parent"]); 
```

如果您重定向隐藏的文件将在重定向页面上不可用。与任何其他输入一样的隐藏字段仅在表单提交时发回服务器。

# git - 用于 Windows 签出、分支、提交和拉取更改的 Git gui

> ID：12391685
> 
> 赞同：4
> 
> 时间：2012-09-12T15:32:04.817
> 
> 标签：git, git-gui, github-for-windows

自从过去 5 年以来，我一直在使用 SVN，我是 GIT 的新手问题。

我使用 GIT GUI 成功完成的步骤。

```
Step 1- I create two folders on the c: Project-clone-1 and project-clone-2
Step 2- Then i clone Project1(which is on github cloud public server) in 'Project-clone-1' then in 'project-clone-2'

What i want to achieve by creating two copies of same repository is to observe if i commit any change from 'Project-clone-1' and then would like to go to 'project-clone-2' to pull and see if changes comes there.

Step 3- i made some change in a file which is inside 'Project-clone-1' i commit and then pushed.

Please remember i have only master branch.
Step 4- Then i went to the 'project-clone-2' from git GUI i do remote -> Fetch from -> origion
Step 5- it shows Fetching new changes from origin master-> orgin-> master (done)
Step 6- when i opened file which i expect to have change in 'project-clone-2' i still see old file ??? 
```

当我进行更新时，它没有显示远程更改我错过了什么吗？

感谢您提前提供帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T16:07:31.210

当 you 时`git fetch`，它不会自动将新内容合并到您的本地分支中。

假设您正在尝试将您的`master`分支与名为`origin`. 当 you 时`git fetch`，它会抓取`master`远程仓库上分支的最新更改并将它们存储在`origin/master`分支中（在您的本地仓库中）。这使您有机会在将更改`diff`合并到本地分支之前查看更改（例如，使用 ）。要将这些更改合并到本地`master`分支中，您可以（在主分支中）：

`git merge origin/master`

Git 有一个快捷命令可以自动获取和合并：`git pull`. 这可能就是你要找的。

# sql - 如果 SQLite 中不存在

> ID：12391686
> 
> 赞同：1
> 
> 时间：2012-09-12T15:32:06.220
> 
> 标签：sql, sqlite

如果 devID 不存在，我如何检查 devID 是否已经存在，然后插入以下查询：

```
INSERT  into profiles (devID,alert) VALUES ("ff",1) ; 
```

PS：我已经在 SO 中看到[了这个](https://stackoverflow.com/questions/531035/how-to-do-if-not-exists-in-sqlite)解决方案，但不确定如何根据该解决方案修改我的查询。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:34:53.560

```
INSERT INTO profiles (devID, alert)
SELECT 'ff', 1
WHERE NOT EXISTS (SELECT 1 FROM profiles WHERE devID = 'ff'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T15:34:58.267

尝试这个：

```
INSERT OR IGNORE INTO profiles (devID,alert) VALUES ("ff",1) ; 
```

如[`INSERT`语法](http://www.sqlite.org/lang_insert.html)中所述：

![在此处输入图像描述](../Images/8f301a4f263c54888cf4acb8f770ee0b.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:35:03.057

根据您的链接：

```
INSERT INTO profiles (devID,alert)
SELECT "ff", 1
WHERE NOT EXISTS (SELECT 1 FROM profiles WHERE devID ="ff"); 
```

# sql - 修改有关绑定或相等值的现有信息

> ID：12391687
> 
> 赞同：1
> 
> 时间：2012-09-12T15:32:06.070
> 
> 标签：sql

我正在尝试使用奥林匹克数据库，我的任务是修改我所知道的有关在同一赛事中并列的奥运选手的信息。

> “首先，扩展查询以显示有关事件的更多详细信息：代替事件 ID，显示事件性别、距离和样式。作为其中的一部分，现在将按事件性别、距离、样式。然后放置。
> 
> 其次，显示两个参赛者的更多细节：在每个参赛者编号的位置，显示他们的名字和姓氏以及他们的国家名称（而不是国家代码）。”

* * *

我必须使用的四个表是：

竞争对手，其中包含：CompetitornNum、Givenname、Familyname。

结果，其中包含：Eventid、CompetitorNum、Place。

事件，其中包含：Eventid、Eventgender、Distance、Style

国家，其中包含：国名

```
Is my original query.

SELECT C1.EventID, C1.Place, C1.CompetitorNum, C2.CompetitorNum
FROM Results C1, Results C2
WHERE C1.Place = C2.Place
    and C1.EventID = C2.EventId
    and C1.CompetitorNum < C2.CompetitorNum
ORDER BY C1.EventID; 
```

我的问题是我对我需要做什么有一个概念，但是每次我尝试某些东西时我们被告知要使用的程序崩溃，我真的不知道从哪里开始。

```
SELECT Eventgender, Distance, Style, C1.Place, Givenname, Familyname, Countryname,     Givenname, Familyname, Countryname
FROM Results C1, Results C2
    natural join Competitors
    natural join Countries
    natural join Events
WHERE C1.Place = C2.Place
    and C1.EventId = C2.EventId
    and C1.CompetitorNum < C2.CompetitorNum
ORDER BY C1.EventID; 
```

我希望选择第 1 个人和第 2 个人的 Givenname、Familyname 和 Countryname，而不是我目前正在检索的 CompetitorNum。

我的新查询找到了第一个人，但我不确定如何更改以获取第二个人信息。

任何帮助将不胜感激

* * *

我似乎找到了解决方案，但是我不确定我是否使用了最好的方法来完成任务。有更好的方法吗？

```
SELECT C5.Eventgender, C5.Distance, C5.Style, C1.Place, C3.Givenname, 
C3.Familyname, C6.Countryname, C4.Givenname, C4.Familyname, C7.Countryname
FROM Results C1
    join Results C2 on C1.Place = C2.Place and C1.EventId = C2.Eventid 
        and C1.Competitornum < C2.Competitornum
    join Competitors C3 on C3.Competitornum = C1.Competitornum
    join Competitors C4 on C4.Competitornum = C2.Competitornum
    join Events C5 on C5.Eventid = C1.Eventid
    join Countries C6 on C6.Countrycode = C3.Countrycode
    join Countries C7 on C7.Countrycode = C4.Countrycode
ORDER BY C1.EventId; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T03:05:20.933

```
SELECT C5.Eventgender, C5.Distance, C5.Style, C1.Place, C3.Givenname, 
C3.Familyname, C6.Countryname, C4.Givenname, C4.Familyname, C7.Countryname
FROM Results C1
    INNER JOIN Results C2 on C1.Place = C2.Place and C1.EventId = C2.Eventid 
        and C1.Competitornum < C2.Competitornum
    INNER JOIN Competitors C3 on C3.Competitornum = C1.Competitornum
    INNER JOIN Competitors C4 on C4.Competitornum = C2.Competitornum
    INNER JOIN Events C5 on C5.Eventid = C1.Eventid
    INNER JOIN Countries C6 on C6.Countrycode = C3.Countrycode
    INNER JOIN Countries C7 on C7.Countrycode = C4.Countrycode
ORDER BY C1.EventId; 
```

# java - 带有 eclipselink 的 Web 项目需要“org.hibernate.SessionFactory”

> ID：12391688
> 
> 赞同：2
> 
> 时间：2012-09-12T15:32:05.977
> 
> 标签：java, installation, eclipselink, eclipse-wtp

我在 Eclipse 中创建动态 Web 项目以包含 eclipselink 实现时遇到问题。

当我`JPA`勾选下的复选框时`Project Facets`，选择`EclipseLink 2.4.x`作为平台并选择`EclipseLink 2.4.0- Juno`我下载的库，我收到一个错误：

```
The class 'org.hibernate.SessionFactory' is required to be in the selected libraries. 
```

由于我无意使用hibernate，我不明白这一点......

如果我选择`disable library configuration`，项目会接受它，我可以在项目的类路径中包含所需的库 (EclipseLink)。不过，我想了解为什么我不能使用这个 JPA Facet 工具来使用 EclipseLink 构建我的项目。

我使用的 Facets 是`Dynamic Web Module 3.0`,`Java 1.7`和`JPA 2.0`. 我的日食`EE for Web Developers Juno 4.2`与`WTP platfrorm`.

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:40:33.010

如果您选择 EclipseLink 平台并在库配置中收到此验证消息，那么您正在使用的 Hibernate Tools 版本中存在错误。EclipseLink 平台不需要此类来进行正确的库配置。您当前的解决方法就足够了，但是如果您想按设计使用库配置，听起来您需要从 Eclipse 安装中卸载 Hibernate Tools，直到它们能够解决此问题。我建议针对这个问题提交一个针对 Hibernate Tools 的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T05:11:43.970

我也遇到了这个问题。当我在 Eclipse 中卸载 JBOSS 时，错误已修复。但是如果你想用 jboss 安装创建项目，选择 hibernate 作为平台。然后没有错误。项目将被正确配置

# git - 目录的 Gitignore 问题

> ID：12391690
> 
> 赞同：3
> 
> 时间：2012-09-12T15:32:12.617
> 
> 标签：git, version-control

我一直遇到 .gitignore 没有忽略我的 node_modules 目录的问题。

这是我的 .gitignore 文件：

```
*~
~*
*.log
images/
images/*
images/**/*

.idea/
.idea/*
import_errors/
output/
output/*
node_modules/
node_modules/*
uploads/
downloads/
tmp/

.DS_Store

!.keep
!*/ 
```

我还尝试运行命令来更新 git-index 并从索引中删除文件夹

```
$ git rm --cached node_modules
fatal: pathspec 'node_modules' did not match any files
$ git update-index --assume-unchanged node_modules
fatal: Unable to mark file node_modules 
```

通常我只会发出这两个命令，但我不断收到这些错误。第一个命令应该取消暂存文件，第二个命令应该更新 git 索引以停止跟踪文件。但由于某种原因，这并没有发生，我不知道还有什么可能是错的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:31:59.913

再次仔细检查 gitignore 文件后找到了答案。原来我的最后一条规则是：

```
!*/ 
```

这意味着应该保留项目根目录下的所有文件夹。在我完全理解 git 的工作原理之前，我很久以前就这样做了。它旨在将某些文件夹保留在那里，但只是空的，其中没有内容。但这就是上面的规则的含义，并且不需要该规则。

所以删除那条线并做`$ git rm --cached node_modules`就可以了。该命令将它从暂存区中删除，然后更新索引，因此您不必运行第二个命令`$ git update-index --assume-unchange`。

# php - post_per_page 不起作用

> ID：12391697
> 
> 赞同：0
> 
> 时间：2012-09-12T15:32:39.743
> 
> 标签：php, wordpress, post

除了posts_per_page（它将显示的帖子数量）之外，一切都在我的代码中运行。这是我的 Wordpress 代码的一部分：

```
<?php 
$category = get_the_category();
$current_category = $category[0]->term_id;
$qarr = array(
    'posts_per_page' => $posts_number,
    'cat' => $current_category,
    'tag' => 'pinned', // tag filtered
    'post__not_in' => array(get_the_ID())
);
$q = new WP_Query($qarr);
if($q->have_posts()) : while ($q->have_posts()) : $q->the_post();
?> 
```

**为什么它不起作用？**我已阅读文档，但不明白问题所在。

如果您想查看和测试它，这里是完整的代码，只需为 $posts_number 设置一个数字：http: [//pastebin.com/uNsynNiM](http://pastebin.com/uNsynNiM)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:18:50.517

从您之前的问题来看，您的主题主要是使用 query_posts 针对您的数据库运行任何和所有发布查询。由于这会改变主循环，因此 WP_Query 和 get_posts 也会受到对 query_posts 的任何和所有现有调用的影响。我相当确定您的 Widget 中的 WP_Query 调用受到某处流氓 query_posts 调用的影响。

我的建议是，因为将您的主题从所有 query_posts 实例转换为 WP_Query 可能需要相当多的努力，所以暂时使用“showposts”，因为这基本上可以解决问题。我仍然建议将对 query_posts 函数的所有调用切换到 WP_Query，只是因为这样做会显着提高性能，但最终，这需要您付出巨大的努力来解决一个相当小的问题。

就个人而言，我会这样做吗？作为一个良好实践的练习，我可能会，是的。我会说值得吗？这取决于项目。如果这只是一个个人项目，我不会说这是必要的。

祝你好运，我希望一切顺利。

# jquery-ui - jquery-ui-map 检测信息窗口关闭并平移到地图中心

> ID：12391699
> 
> 赞同：1
> 
> 时间：2012-09-12T15:32:43.333
> 
> 标签：jquery-ui, google-maps, google-maps-api-3, jquery-ui-map

如何检测 jquery-ui-map 中关闭的 infowindow 并在窗口关闭后将地图平移到中心？

```
<pre>

 $(function() { 
                demo.add(function() {
                    $('#themap').gmap({'center': '54.977614,23.871643', 'zoom': 7,'disableDefaultUI':false, 'callback': function() {
                        var self = this;
                        $.getJSON( 'index.php?option=com_maps&view=stendai&format=json', function(data) { 
                            $.each( data.markers, function(i, marker) {
                                self.addMarker({ 'id':marker.id, 'position': new google.maps.LatLng(marker.latitude, marker.longitude),'icon':'images/stendas.png' , 'bounds':true }

                                 ).click(function() {
                                    self.openInfoWindow({ 'content': marker.content }, this);
                                });

                            });
                        });
                    }}); 
                }).load();
            });

</pre> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:50:31.783

Google Maps Infowindows 有一个`closeclick`事件。您可以将侦听器附加到每个信息窗口的此事件，并在收到此事件的通知时平移地图。[这篇文章](https://stackoverflow.com/questions/6777721/google-maps-api-v3-infowindow-close-event-callback)中给出了一个基本示例。

# node.js - 为亚马逊 fps 生成签名

> ID：12391706
> 
> 赞同：5
> 
> 时间：2012-09-12T15:33:14.090
> 
> 标签：node.js, coffeescript, amazon-fps

我正在努力将 Amazon FPS 集成到我公司的网站中，但似乎无法生成正确的签名。这是亚马逊的文档所说的： [http ://docs.amazonwebservices.com/AmazonFPS/latest/FPSAdvancedGuide/APPNDX_GeneratingaSignature.html](http://docs.amazonwebservices.com/AmazonFPS/latest/FPSAdvancedGuide/APPNDX_GeneratingaSignature.html)

这是我散列的字符串：

```
GET\nfps.sandbox.amazonaws.com\n/\nAction=Reserve&AWSAccessKeyId=REMOVED&CallerDescription=Reserve&CallerReference=CallerReference05&RecipientTokenId=254656Example83987&SenderTokenId=553IPMACGAZ2J4N1L7BJ3UMNRFTQU4V9NT4RJCTVADDJKXQ6L1ZAKSIUNPIRTTI1&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2012-09-12T22%3A29%3A07.623Z&TransactionAmount.CurrencyCode=USD&TransactionAmount.Value=1.00&Version=2010-08-28 
```

这是我发送的 HTTP 请求：

```
https://fps.sandbox.amazonaws.com?Action=Reserve&AWSAccessKeyId=REMOVED&CallerDescription=Reserve&CallerReference=CallerReference05&RecipientTokenId=254656Example83987&SenderTokenId=553IPMACGAZ2J4N1L7BJ3UMNRFTQU4V9NT4RJCTVADDJKXQ6L1ZAKSIUNPIRTTI1&Signature=t5r%2BWmV9PdoOGfHhtwLJ5nJ8zo%2BIJL4uWB6MOMpkZLw%3D&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2012-09-12T22%3A29%3A07.623Z&TransactionAmount.CurrencyCode=USD&TransactionAmount.Value=1.00&Version=2010-08-28 
```

这也是我收到的确切错误：

```
SignatureDoesNotMatch The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details. RequestID - ac476abb-2bc6-4891-8854-e52cf33f8716 
```

我正在使用带有 node.js 后端的咖啡脚本编写此内容。谁能发现我做错了什么？如果需要，我可以发布我的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:42:47.850

我弄清楚我做错了什么。我的查询字段不是自然字节顺序。AWSAccessKey 位于 Action 之前。亚马逊的例子向他们展示了我试图这样做的方式，而不是正确的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-22T07:32:00.177

我写了一个小库来帮助签署请求。也许它对你有用[https://github.com/theRemix/aws_signature_utils_js](https://github.com/theRemix/aws_signature_utils_js)

# python - open() 找不到给定路径相对于 PYTHONPATH 的文件

> ID：12391709
> 
> 赞同：1
> 
> 时间：2012-09-12T15:33:22.410
> 
> 标签：python, ubuntu, path

我做到了`export PYTHONPATH=$PYTHONPATH:/home/User/folder/test`。然后我在进去的时候运行了python`/home/User/`并检查了`sys.path`——它是正确的。

```
>>> import sys
>>> sys.path
['', '/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg', 
'/home/User', '/home/User/folder/test','/usr/lib/python2.7',
'/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', 
'/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', 
'/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages'] 
```

然后我尝试打开这样的文件`/home/User/folder/test/pics/text/text.txt`：

```
>>>file = open('pics/text/text.txt','r')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IOError: [Errno 2] No such file or directory: 
```

如您所见，文件路径的前半部分在 in 中`$PYTHONPATH`，后半部分作为`open()`函数的参数给出。为什么它不起作用？我应该改变什么？

当我从`/home/User/folder/test`（导出路径）运行 python 并尝试打开文件时 - 它起作用了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T15:42:09.043

Open 是相对于当前目录的，不使用 PYTHONPATH。当前目录默认为在命令行上启动 python 时的任何目录。

[您可以使用os.chdir](http://docs.python.org/library/os.html#os.chdir "操作系统目录")更改当前目录

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:42:21.963

如果我正确阅读了您的问题，您希望您的数据位于相对于模块的位置。如果是这种情况，您可以使用：

```
full_path = os.path.join(os.path.split(__file__)[:-1]+['pics','text','text.txt']) 
```

`__file__`是模块的路径（包括`modulename.py`）。因此，我拆分了该路径，拉出`modulename.py`( `[:-1]`) 并通过添加相对路径的其余部分`os.path.join`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:56:24.420

每当我想导入相对于当前的脚本并且不使用包时，我通常使用

```
sys.path = [os.path.dirname(__file__) + "/../another_dir"] + sys.path 
```

# mysql - 数据库关系中的单值数据到多值数据

> ID：12391712
> 
> 赞同：0
> 
> 时间：2012-09-12T15:33:30.423
> 
> 标签：mysql, sql, database, database-design, relational-database

我很难想象这个。我只是没有脑子去做。

我有一张桌子叫`reports`.

```
---------------------------------------------
| report_id   | set_of_bads | field1 | field2 |
---------------------------------------------
| 123         | set1        | qwe    | qwe    |
---------------------------------------------
| 321         | 123112      | ewq    | ewq    |
--------------------------------------------- 
```

我还有另一张桌子叫`bads`. 此表包含不良数据列表。

```
-------------------------------------
| bad_id    | set_it_belongs_to | field2 | field3  |
-------------------------------------
| 1         | set1              | qwe    | qwe     |
-------------------------------------
| 2         | set1              | qee    | tte     |
-------------------------------------
| 3         | set1              | q44w   | 3qwe    |
-------------------------------------
| 4         | 234               | qoow   | 3qwe    |
------------------------------------- 
```

我想设置主键到外键关系。我的问题是，如何将字段连接`set_of_bads`到表中`set_it_belongs_to`。`bads`这样，如果我想`set1`通过调用`reports`表来获取整个数据集，我就可以做到。

示例：*嘿报告表.. 调出具有`report_id` `123`. 好的，谢谢.. 现在从中获取所有行，该行具有, in字段的行`bads`中的值。谢谢。`set_of_bads``report_id` `123``set_it_belongs_to`*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:38:17.627

试试这个，

```
SELECT  a.*,      -- will display all records from reports table
        b.*       -- will display all records from bads table
FROM    reports a
        INNER JOIN bads b
            ON a.set_of_bads = b.set_it_belongs_to
WHERE   a.report_ID = 123 
```

**更新 1**

在您的语句中，在表`CREATE TABLE`上指定外键约束`bads`

```
CREATE TABLE bads
(
bad_id INT AUTO_INCREMENT   ,
 set_it_belongs_to VARCHAR(50),
 field2 VARCHAR(50),
 field3 VARCHAR(50),
 CONSTRAINT bads_pk PRIMARY KEY (bad_id),
 CONSTRAINT bads_fk FOREIGN KEY (set_it_belongs_to) 
    REFERENCES reports(set_of_bads)
); 
```

并确保表`primary key`的`reports``set_of_bads`

# vb.net - 使用 Microsoft.Office.Interop.Word 时强加页码

> ID：12391714
> 
> 赞同：1
> 
> 时间：2012-09-12T15:33:37.930
> 
> 标签：vb.net, interop, ms-word, page-numbering

我有以下 VB.Net 代码来创建 Microsoft Word 文档。如何强加页码？

```
Imports Word = Microsoft.Office.Interop.Word

Dim wordApp As Word._Application = New  _
Word.ApplicationClass()

Dim wordDoc As Word._Document = _
    wordApp.Documents.Add()

Dim para As Word.Paragraph = wordDoc.Paragraphs.Add()
para.Range.Text = "First Page Content."
para.Range.InsertParagraphAfter()

para.Range.InsertBreak()

para.Range.Text = "Second Page Content."
para.Range.InsertParagraphAfter() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:21:33.590

你可以试试：

```
 'wdAlignPageNumberCenter=1
 wordDoc.Sections(1).Footers(1).PageNumbers.Add (1) 
```

# jquery - 将背景颜色从一个单元格复制到另一个表格单元格

> ID：12391716
> 
> 赞同：0
> 
> 时间：2012-09-12T15:33:38.120
> 
> 标签：jquery, css

我得到了这个工作，但解决方案感觉有点*脏*，所以如果有人可以看看它并给出如何优化方法的提示，那就太好了。

我有一个设置了背景颜色的特定起始表。在它下面是没有背景颜色的类似表格，实际上这些表格是为我通过 ajax 检索的数组中的每条记录动态创建的。该脚本的目的是复制结果网格中每一*列的背景颜色：*

```
for (var i = 2; i < 34; i++) {
    var c = $('table tr td:nth('+ i + ')').css('background-color');        
    $('table tr td:nth-child('+i+')').css('background-color',c);
} 
```

我现在首先从第一个表中找到背景颜色，然后在循环中复制找到的颜色。

小更新：它至少需要在 IE 8 中工作。

可以在此处找到一个示例：http: [//jsfiddle.net/KvdM/9RRfU/](http://jsfiddle.net/KvdM/9RRfU/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:48:46.967

您也可以考虑只使用 CSS3 col 和 nth-child。请参阅红色 cols 的示例：

[http://jsfiddle.net/pdejuan/9RRfU/5/](http://jsfiddle.net/pdejuan/9RRfU/5/)

[Col 元素](http://www.w3.org/TR/html-markup/col.html)的附加信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T13:14:49.450

以下代码获取表格单元格的第一行并对其进行迭代。它缓存 jQuery 包装的`this`隐式参数并获取它在表中的列位置以及它的`background-color`. 接下来，它使用相同的 更新该位置的其余表格单元格`background-color`。

```
$(function() {
    $( "tr:first td" ).each(function() {
        var $this = $( this ),
            index = $this.index(),
            color = $this.css( "background-color" );

        $( "td:nth-child(" + index + ")" ).css( "background-color", color )
    });
}); 
```

​ 这是一个带有上述片段的 jsFiddle... [http://jsfiddle.net/fpVuW/](http://jsfiddle.net/fpVuW/)

您可能会考虑向表格添加一个特殊类并更新 jQuery，以便它只操作这些表格，否则如果您的页面上有任何其他表格，它们也会被更改。

另一种解决方案是创建一个函数或插​​件，将一个表复制到另一个特定表，然后为每个表调用函数/插件。这样您就可以更好地控制哪些表被更改。

# xml - 向 csv 输出添加唯一 ID

> ID：12391717
> 
> 赞同：1
> 
> 时间：2012-09-12T15:33:45.163
> 
> 标签：xml, xslt, xpath

我的代码成功地将 xml 文件转换为 csv，以逗号（，）结束创建的数据

样本数据

```
<Addy>
 <Rowinfo>
<LD>FLAT</LD>
<L>1</L>
<Th> Passage</Th>
</Rowinfo>
 <Addy> 
```

产生一个 csv 输出

```
FLAT,1,Passage, 
```

打开此文件并添加一列以赋予其唯一 ID，例如 1,2,3...

```
1,FLAT,1,Passage,
2,FLAT,1,Passage, 
```

最后的逗号消失了

```
 1,FLAT,1,Passage
 2,FLAT,2,okete 
```

XSLT 可以在生成 csv 输出的过程中自动分配这些唯一编号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:46:28.660

用于 XPath 的函数也可以在 XSLT 中使用。这三个中的一个可能会有所帮助：

*   fn:Id（又名 fn:element-with-id）
*   fn:Id-ref
*   fn:位置

最后一个看起来特别有希望。如果您相对于`RowInfo`节点执行它，您可能会从中获得一个干净的升序数值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T17:06:16.363

只需添加两行...

将此第二行添加到您的第一个模板...

```
<xsl:template match="/">
 <xsl:value-of select="'Id,'" />
 etc. 
```

将此第二行添加到您的第二个模板...

```
<xsl:template match="*" mode="row">
 <xsl:value-of select="concat(position(),',')" />
 etc. 
```

现在你得到 csv 输出，比如......

```
Id,LD,L,Th
1,FLAT,1, Passage 
```

...其中第一列 ( *'Id'* ) 是唯一 ID。（事实上​​，一个序数行号。）

# java - 是否可以在保存期间停止休眠？

> ID：12391722
> 
> 赞同：0
> 
> 时间：2012-09-12T15:34:04.770
> 
> 标签：java, hibernate, persistence

我有一个将结构化格式的大文件上传到数据库的应用程序。结构是这样的，即保存一个 Data 对象，其中包含 DataRow 对象的集合。

有时这些文件可能会保存相当长的时间，在此保存期间，用户可能会决定取消操作。

我的问题是，除了杀死 JVM 之外，有没有办法停止持久化 Data 对象的过程？欢迎任何想法，包括对持久性技术的更改。

这是我的 DAO 中调用来持久化 Data 对象的方法。

```
@Override
public Data saveData(Data data) {

    Transaction transaction = null;

    Session session = HibernateUtil.getSessionFactory().openSession();
    Data merged = null;
    try{
        transaction = session.beginTransaction();
        merged = (Data) session.merge(data);
        transaction.commit();
    } catch (HibernateException e) {
        transaction.rollback();         
        throw e;
    } finally {
        session.close();
    }
    return merged;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:25:58.917

如果可能的话，实现将大量数据以块的形式保存的最佳方法。持久化 - 服务应该被视为异步进程，以便客户端可以在数据被持久化的同时同时使用它。您可以使用初始值为“false”的线程局部变量，如“isCanceled”。在每次迭代中，您可以检查变量是否设置为“true”并取消持久化操作。但是，如果您需要回滚逻辑，则必须考虑一种逻辑，以从数据库中删除持久化的条目。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T15:38:09.460

将会话设置为参数，以便您可以终止会话并进行回滚。

# c# - 如何向 TreeNode 对象添加新字段？

> ID：12391726
> 
> 赞同：1
> 
> 时间：2012-09-12T15:34:22.440
> 
> 标签：c#, .net, winforms, treeview, treenode

例如，有`.Name`,`.Text`字段。如果我需要`Type`和字段怎么办`Path`，`Direction`如何将它们添加到类中`TreeNode`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:45:04.170

这是否满足您的意图？我已将这些显示为属性，但省略 {get;set;} 并且您将拥有字段。

```
 class myTreeNode : System.Windows.Forms.TreeNode
  {
    public string NodeType { get; set; }
    public string NodePath { get; set; }
    public string Direction { get; set; }
  } 
```

要将 myTreeNode 实例添加到 TreeView，您可以这样做：

```
myTreeNode node = new myTreeNode();  
treeview1.Nodes.Add(node); 
```

如果您想使用 Tag 属性而不是将这些直接存储在继承的节点中，（仅显示两个属性而不是 3 个）

```
class NodeTag
{  
  public NodeTag(string path, string direction)
  {
     NodePath = path;
     Direction = direction;
  }
  public string Direction {get;set;}
} 
```

然后，在创建树的代码中，您将执行以下操作：

```
TreeNode node = new TreeNode();
node.Tag = new NodeTag("my path", "South");
treeView1.Nodes.Add(node); 
```

# python - Webapp2 - 当用户从不同的浏览器登录时，用户登录会话无效

> ID：12391736
> 
> 赞同：1
> 
> 时间：2012-09-12T15:34:53.910
> 
> 标签：python, session, sessionid, webapp2

我在 webapp2 应用程序中有以下要求。当用户离开他的机器或浏览器时，应该终止该用户之前的身份验证会话。

当用户从另一台机器登录时，我可以通过在登录时将 remote_addr 存储在用户对象中来执行此操作。当请求用户的会话时，我在登录时检查请求中的 remote_addr 与用户的 remote_addr。

我对这个解决方案不满意，因为当用户在代理服务器后面时它不起作用，而且当用户使用不同的浏览器时它也不起作用。

webapp2 是否在某处存储会话 ID，因此我可以使用它来查看用户是否已登录新会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T09:58:58.967

修改你已经做的事情：当用户登录时，创建唯一/随机令牌并将其存储在用户对象中，并在浏览器中设置一个 cookie。当请求用户会话时，检查两个令牌（来自请求 cookie 和用户对象）是否匹配，如果不匹配，则刻录会话。

它是一样的，但不是`remote_addr`使用您在登录时生成并设置为 cookie 的随机令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T15:45:00.923

当您第一次在浏览器会话中打开网站时，会创建一个站点会话。

当他登录时，您只需将会话 ID 存储在数据库中。您需要有一个带有活动登录的漂亮表。如果您想让他在稍后关闭并重新启动浏览器时保持登录状态，您也可以在他的浏览器中设置一个 cookie。显然，如果 cookie 存在，则将会话 id 修改为 cookie 中的那个。

Cookie 不会在浏览器之间共享，因此在这种情况下，如果他从新浏览器登录，您会更改活动登录表中的会话 ID。

此外，您还需要一个小型 ajax 来检查当前会话是否每 5 分钟左右仍然处于活动状态，如果没有，则将其注销。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-22T16:21:40.633

[http://webapp-improved.appspot.com/api/webapp2_extras/sessions.html](http://webapp-improved.appspot.com/api/webapp2_extras/sessions.html)讲述了“会话ID”。

另请参阅 Nick Johnson 在[webapp2-for-authentication-and-login](https://stackoverflow.com/questions/7641110)的回答，以及[使用 ndb library](http://code.google.com/r/karthikdv-webapp2/source/browse/webapp2_extras/appengine/sessions_ndb.py)
的数据存储的示例实现。

# xpages - 强制使用 SSJS 进行部分更新？

> ID：12391737
> 
> 赞同：0
> 
> 时间：2012-09-12T15:34:54.467
> 
> 标签：xpages

我在这里遇到一个问题：

[扩展库对话框刷新/缓存问题？](https://stackoverflow.com/questions/12376480/extensions-library-dialog-box-refresh-caching-issue)

对话框内容未更新。我想作为一种解决方法，我可以调用一个函数来强制更新对话框。

我找到了一些用 CSJS 来做的代码，但是我将如何用 SSJS 来做呢？

我确实尝试放置：

XSP.partialRefreshPost("#{id:computedField1}");

在我的对话框的 onFocus 事件和 onShow 客户端事件中，但我得到 formID 为空或不是对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:30:42.040

您可以在对话框中放置一个动态内容控件，并使用 ssjs 使用 getComponent("dynContentControl").show("key") 更新内容

# ruby - 使用 Watir 双击？

> ID：12391738
> 
> 赞同：2
> 
> 时间：2012-09-12T15:34:54.170
> 
> 标签：ruby, watir

除非您使用firewatir，否则似乎不是受支持的功能？

我已经浏览了它，似乎在任何地方都找不到它，我遇到了 double_click 但在控制台中返回了一个未定义的方法错误。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T16:07:33.560

元素有一种`double_click`方法。

尝试：

```
browser.element.double_click 
```

请注意，`element`它不一定是元素类型。它可以是子类，如链接、跨度等。

相关 rdocs：[Watir-Classic](http://rdoc.info/gems/watir-classic/Watir/Element#double_click-instance_method)和[Watir-Webdriver](http://rubydoc.info/gems/watir-webdriver/Watir/Element#double_click-instance_method)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-15T22:01:34.180

您也可以尝试 fire_event("ondblclick") 方法

```
browser.link(:id,”object_to_doubleclick”).fire_event(”ondblclick”) 
```

fire_event 方法支持许多不同的事件，包括

*   onmousemove
*   鼠标悬停
*   onmousedown
*   onmouseup
*   点击
*   onmouseout 等等...

# sql - 链接服务器上的身份插入失败

> ID：12391744
> 
> 赞同：24
> 
> 时间：2012-09-12T15:35:05.123
> 
> 标签：sql, sql-server, sql-server-2008

我想使用存储过程将表从我的测试数据库复制到具有相同 ID/身份的链接服务器，但我无法让它工作..我已经设置`IDENTITY_INSERT`为`ON`但它仍然抱怨 ID 列.

这是我的程序：

```
CREATE PROCEDURE [dbo].[TEST2PROD_CopyUIDataSServer]
AS Begin
declare @sql nvarchar(max)
-- First truncate target table
set @sql = 'EXEC [LINKEDSERVER].tempdb.sys.sp_sqlexec' + char(39)+ 'TRUNCATE Table [ProductManager].dbo.[UIData]' + char(39)+  ';'
---- SET IDENTITY_INSERT ON
set @sql = @sql + 'EXEC [LINKEDSERVER].tempdb.sys.sp_sqlexec' + char(39)+ 'SET IDENTITY_INSERT [ProductManager].[dbo].[UIData] ON' + char(39)+  ';'
---- INSERT UIDATA records from DB1 into linked server DB2
set @sql = @sql + 'WITH TestData as (SELECT * from ProductManager.dbo.UIData UID)' + NCHAR(13)+  'INSERT INTO   [LINKEDSERVER].[ProductManager].[dbo].[UIData]' + NCHAR(13) + 'select * from TestData;'
print @sql
exec (@sql) 
end 
```

但是当我执行 SP 时，它给了我以下错误：

> 链接服务器的 OLE DB 提供程序“SQLNCLI10”.... 由于列“Id”，无法插入表“[LINKEDSERVER].[ProductManager].[dbo].[UIData]”。用户无权写入该列。

链接服务器属性 RPC 和 RPC out 设置为 true。我希望有人能在这里帮助我吗？

**更新：**我决定把事情分开，首先我将数据从本地服务器复制到链接服务器，在`TEMP_TABLE`那里我不必处理`IDENTITY`问题。

然后我在链接/远程服务器上编写了一个存储过程，因为我没有使用`SELECT *`但指定列列表。很有可能这也可以在 SP 中的本地服务器上运行，但我还没有时间或兴趣去检查它。

```
USE [ProductManager]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[TEST2PROD_CopyBaseTables]
AS BEGIN
DECLARE @DestTable VARCHAR(50)
DECLARE @DestPath VARCHAR(50)
DECLARE @SrceTable VARCHAR(255)
declare @sql nvarchar(max)
DECLARE @columnList varchar(max)
DECLARE @err int

Begin TRY

declare @comma_delimited_list varchar(4000) 
--- FIRST TRY WITH ONE TABLE, EXTENDABLE...
set @comma_delimited_list = 'UIData' 

declare @cursor cursor 
set @cursor = cursor static for  
  select * from dbo.Split(@comma_delimited_list,',') a 

declare @naam varchar(50)
open @cursor 
while 1=1 begin 
  fetch next from @cursor into @DestTable
  if @@fetch_status <> 0 break 

    --Create tablenames
    SET @SrceTable = '[ProductManager].[dbo].TEMP_' + @DestTable
    SET @DestPath = '[ProductManager].[dbo].'+ @DestTable 
    print @srceTable;
    print @DestTable;

    --Truncate target table
    set @sql ='TRUNCATE TABLE '+ @DestPath + ';'

    --Insert statement needs column names
    set @columnList =''
    SELECT  @columnList = coalesce(@columnList + '[' + name + '],','') FROM sys.columns Where OBJECT_NAME(OBJECT_ID) = @DestTable
    if RIGHT(RTRIM(@columnList),1) = ',' 
    begin
        SET @columnList = LEFT(@columnList, LEN(@columnList) - 1) 
    end

    --Transfer data from source table 2 destination
     set @sql = @sql + ' SET IDENTITY_INSERT ' + @DestPath + ' ON;' + ' INSERT INTO ' + @DestPath + '(' + @columnList + ') SELECT ' + @columnList + ' FROM ' + @SrceTable

    print @sql;

    exec (@sql)
end 
-- not strictly necessary w/ cursor variables since the will go out of scope like a normal var 
close @cursor 
deallocate @cursor 

End Try
Begin Catch
 declare @ErrorMsg nvarchar(MAX);
 select @ErrorMsg =  ERROR_MESSAGE();

SELECT @err = @@error IF @err <> 0 Return @err
end Catch
END 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-12T15:44:52.737

`IDENTITY_INSERT`不适用于链接服务器 AFAIK，除非您执行包含`SET IDENTITY_INSERT`批处理的动态 SQL 或在远程服务器上有一些代码（例如存储过程）为您执行此操作。

这`IDENTITY_INSERT`是每个会话（请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms188059.aspx)），当您使用远程服务器时，这可能与您通过执行的语句处于不同的会话中`[LINKEDSERVER].tempdb.sys.sp_sqlexec`，这会导致它在您看到它发生时失败。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-02-11T03:11:05.480

您可以使用“SWITCH TO”技巧将标识值插入到链接服务器上具有**标识****列**的**表中。**

 **如果您没有使用“SWITCH TO”技巧在列上添加和删除标识，它会非常快，即使在大表上也是如此！

从概念上讲，您只需创建一个与您想要的表完全相同的新 SCHEMA，`INSERT`而*无需*定义身份。然后将表切换到该 SCHEMA 并执行您的`INSERT`. 然后切换回定义身份的 SCHEMA。
下面的示例已在 AZURE 中的链接服务器上进行了测试。使用“SWITCH TO”的所有注意事项都适用（索引必须相同，删除并重新创建外键等）

要进行测试，您可以在链接的 Azure SQL Server 数据库上运行下面的完整脚本。您需要使用 and 进行查找/替换`[LINKED_SERVER_NAME]`，`[DATABASE_NAME]`替换为您的值。在非 Azure DB 上，您可能需要将“ON PRIMARY”添加到表创建中。

```
--Let's setup the example by creating a table with an IDENTITY column on the Linked Server
EXEC('
CREATE TABLE [DATABASE_NAME].[dbo].[Example_Table](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nchar](10) NULL
)
 '
) AT [LINKED_SERVER_NAME]

--INSERT some data into the table
INSERT INTO [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] ([Name]) VALUES ('Travis')
INSERT INTO [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] ([Name]) VALUES ('Mike')

-- Looks good
SELECT * FROM [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table]

GO

-- Create a TABLE with an identical schema, without the identity defined
EXEC('
CREATE TABLE [DATABASE_NAME].[dbo].[Example_Table_temp](
    [ID] [int] NOT NULL,
    [Name] [nchar](10) NULL
)
 '
) AT [LINKED_SERVER_NAME]

--Now Use the "SWITCH TO" to move the data to the new table
EXEC('
 ALTER TABLE [DATABASE_NAME].[dbo].[Example_Table] SWITCH TO [DATABASE_NAME].[dbo].[Example_Table_temp]
  '
) AT [LINKED_SERVER_NAME]

--Drop the old table (It should now be empty, but you may want to verify that if you are unsure here)
EXEC('
 DROP TABLE [DATABASE_NAME].[dbo].[Example_Table]
 '
) AT [LINKED_SERVER_NAME] 

--Rename the new table back to the old table name
-- NOTE the lack of database and owner identifiers in the new name
-- NOTE the use of double single qoutes (ESCAPED single quotes)
EXEC('USE [DATABASE_NAME];
  EXEC sp_rename ''[DATABASE_NAME].[dbo].Example_Table_temp'',''Example_Table''
   '
) AT [LINKED_SERVER_NAME] 

  -- Now do your IDENTITY INSERTs !!!!

 INSERT INTO [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] (ID,[Name]) VALUES (888,'Travis')
 INSERT INTO [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] (ID,[Name]) VALUES (999,'Mike')

 --Verify they got put in
SELECT * FROM [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] 

  --Now let's switch it back to our SCHEMA with an IDENTITY

  EXEC('
CREATE TABLE [DATABASE_NAME].[dbo].[Example_Table_temp](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nchar](10) NULL
)

 ALTER TABLE [DATABASE_NAME].[dbo].[Example_Table] SWITCH TO [DATABASE_NAME].[dbo].[Example_Table_temp]

 DROP TABLE [DATABASE_NAME].[dbo].[Example_Table]

  EXEC sp_rename ''[DATABASE_NAME].[dbo].Example_Table_temp'',''Example_Table''
     '
) AT [LINKED_SERVER_NAME] 

--Data is still there
 SELECT * FROM [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] 
 GO
 -- And note you can no longer INSERT the IDENTITY
 INSERT INTO [LINKED_SERVER_NAME].[DATABASE_NAME].[dbo].[Example_Table] (ID,[Name]) VALUES (45,'Travis')
GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-03T05:38:30.093

您需要执行动态查询示例：

```
exec [LINKSERVERNAME].[DATABASENAME].[SCHEMANAME].sp_executesql N'Your Query' 
```

如果有任何列集标识，您需要设置`SET IDENTITY_INSERT TargetTable ON`并且需要指定列名。例子：

```
SET IDENTITY_INSERT TargetTable ON;
INSERT INTO TargetTable(Col1, Col2, Col3)
SELECT Col1, Col2, Col3 FROM SourceTable;
SET IDENTITY_INSERT TargetTable OFF; 
```**

# c# - C# 是否有索引数组是 PHP 之类的字符串？

> ID：12391745
> 
> 赞同：5
> 
> 时间：2012-09-12T15:35:06.497
> 
> 标签：c#, php, arrays, indexing

我自己学习 C# 已经两个月了。之前，我学过 PHP，发现它有一个数组，其中索引是一个字符串，像这样：

```
$John["age"] = 21;
$John["location"] = "Vietnam"; 
```

记住我们为数组元素设置的内容非常有用。我试图找出 C# 是否支持该数组类型，但我还没有看到任何答案。

C# 有这样的数组吗？如果是这样，我该如何创建它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T15:37:53.540

C# 支持任何类型的对象作为索引。一个内嵌的实现是`System.Collections.Generic.Dictionary<T1,T2>`. 你可以这样声明：

```
Dictionary<string, string> myDictionary = new Dictionary<string, string>(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T15:36:52.670

是的，这是一个关联数组，在 C# 中由泛型[`Dictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)类或非泛型表示[`Hashtable`](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)。

您的代码只能使用 a `Hashmap`，因为这些值并非都属于同一类型。但是，我强烈建议您重新考虑该设计。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-12T15:46:39.713

`System.Collections.Generic.Dictionary<T1,T2>`像其他人说的那样使用。为了完成你的知识，你应该知道你可以控制自己的行为`[]`。例子：

```
public class MyClass
{
    public string this[string someArg]
    {
        get { return "You called this with " + someArg; }
    }

}

class Program
{

    void Main()
    {
        MyClass x = new MyClass();
        Console.WriteLine(x["something"]);
    }
} 
```

会产生“你用一些东西来称呼它”。

更多关于这在[文档中](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)

# python - 向量值多元函数中的插值

> ID：12391747
> 
> 赞同：5
> 
> 时间：2012-09-12T15:35:16.657
> 
> 标签：python, interpolation

在 Python 中，我试图构建一个在多维（5+）参数空间中插入向量值数据的例程。即我有一个函数，它接受一些输入变量并返回一些输出变量。目前，向量的每个元素都有一个调用。数据在一个列文件中，所以我用

```
import numpy
[x_data,y_data,f1_data,f2_data] = numpy.loadtxt('data',unpack=True) 
```

然后，我使用 SciPy 的函数实例化各个插值器，例如

```
from scipy import interpolate
f1 = interpolate.LinearNDInterpolator((x_data,y_data),f1_data)
f2 = interpolate.LinearNDInterpolator((x_data,y_data),f2_data)
... 
```

现在，当我进行插值调用时，我必须为每个值`f1`、`f2`等进行插值，即使它确实应该作为一个操作来实现。而且我猜测进行一次插值应该比进行 5 次或更多更快。

*有没有办法构造一个向量（或数组）值的插值器？*

我尝试用

```
f = interpolate.LinearNDInterpolator((x_data,y_data),(f1_data,f2_data,...)) 
```

但它返回错误

> ValueError：不同数量的值和点

我也读过[这个问题和答案](https://stackoverflow.com/questions/11129958/vector-valued-function-interpolation-using-numpy-scipy "这个问题")，但它是关于标量的向量值函数，显然可以由`interp1d`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T17:00:34.490

[`scipy.interpolate.LinearNDInterpolator`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.LinearNDInterpolator.html)期望以行优先顺序接收其数据：例如，在您的情况下，第一个参数需要是一对数组，而不是一对数组。由于您在加载数据时转置了数据，因此在将其传递给`LinearNDInterpolator`. 尝试类似：

```
points = numpy.array((x, y)).T
values = numpy.array((f1, f2)).T
f = interpolate.LinearNDInterpolator(points, values) 
```

# node.js - ntwitter 和 Heroku 不像本地那样行事

> ID：12391751
> 
> 赞同：0
> 
> 时间：2012-09-12T15:35:29.233
> 
> 标签：node.js, twitter, heroku, socket.io

我有一个使用 ntwitter 和 socket.io 的非常简单的应用程序。这是另一个应用程序的小鸟。我把它放在 Heroku 上，它可以工作几个小时。日志没有显示任何内容，并且应用程序运行良好。所以基本上它是一个安静的谜。

请在此处找到该应用程序：

[https://github.com/soixantecircuits/whos-knocking-node/](https://github.com/soixantecircuits/whos-knocking-node/)

在本地根本没有问题。

在本地使用 `foreman start`完美。

我迷路了，很想得到你的帮助。

对于那些有时间查看 github repo 的人，请找到以下代码：

```
var twitter = require('ntwitter');
try {
    var credentials = require('./credentials.js');
} catch (err) {
    console.log("Error:", err);
    console.log("Using environmental credentials.");
    var credentials = {
        consumer_key: process.env.CONSUMER_KEY,
        consumer_secret: process.env.CONSUMER_SECRET,
        access_token_key: process.env.ACCESS_TOKEN_KEY,
        access_token_secret: process.env.ACCESS_TOKEN_SECRET
    };
}    

var app = require('express')(),
    server = require('http').createServer(app),
    io = require('socket.io').listen(server);    

var port = process.env.PORT || 5000;
var nTwitterCount = 0;    

server.listen(port);    

app.get('/', function(req, res) {
    //res.sendfile(__dirname + '/index.html');
    res.writeHead(200, {
        'Content-Type': 'text/plain'
    });
    res.end('Ring the Bell\n' + nTwitterCount);
});    

var new_tweet = {};    

var t = new twitter({
    consumer_key: credentials.consumer_key,
    consumer_secret: credentials.consumer_secret,
    access_token_key: credentials.access_token_key,
    access_token_secret: credentials.access_token_secret
});
t.stream('statuses/filter', {
    track: ['soixantecircuits', 'ringthebell']
}, function(stream) {
    stream.on('data', function(tweet) {
        //console.log(tweet.text);
        nTwitterCount++;
        //new_tweet = tweet.text;
        console.log(tweet);
        io.sockets.emit('new_tweet', tweet);
    });
    stream.on('error', function(response) {
        console.log(response);
    });
    stream.on('end', function(response) {
        console.log(response);
    });
    stream.on('destroy', function(response) {
        console.log(response);
    });
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:46:17.030

我的预感是，由于您使用的是 Socket.io，因此您想使用 Websockets。Heroku 还不支持 Websockets。您必须在 Heroku 上强制使用 Socket.io 的长轮询。

看到这个：[https ://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku](https://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku)

简而言之，这样做：

```
io.configure(function () { 
 io.set("transports", ["xhr-polling"]); 
 io.set("polling duration", 10); 
}); 
```

再说一次，这只是我的预感。试试看，让我知道。

# git - 分支时挤压或变基

> ID：12391754
> 
> 赞同：0
> 
> 时间：2012-09-12T15:35:39.210
> 
> 标签：git, rebase, squash

我正在从我的主分支开始一个新分支。但我不希望新分支上的全部历史。我希望只有 1 个提交来启动分支。

我创建了新分支并尝试重新设置所有提交，但它不起作用，因为我没有以前的提交。我不明白“先前提交”的东西......

也许压缩提交会更好。但是我的新分支在创建时已经与主分支合并。

我不知道该怎么做。你有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T17:44:22.583

您可以使用一点管道来做到这一点：

```
tree=$(git log -1 --format=%T master)
commit=$(git commit-tree $tree -m "initial commit")
git checkout -b new_branch $commit 
```

解释：

1.  仅从当前提交中提取树（数据）`master`，因为这是您真正感兴趣的内容。树对象的 SHA1 由 打印`git log -1 --format=%T`，并保存到`$tree`

2.  从没有父级的树中创建一个提交。这是通过管道命令完成的，该命令`git commit-tree`接受一个树对象和一个提交消息，并创建一个提交对象。它通常也需要父提交，但在这种情况下，我们不想要父提交，所以我们不给。该命令输出结果提交的 SHA1，我们将其保存到`$commit`.

3.  第三步，也是最简单的一步，是以新的提交为起点创建一个分支，使用通常的`git checkout -b`.

**编辑**：执行此操作的更简单的方法是使用`git checkout --orphan new_branch master`后跟`git commit -m "Initial commit"`，结果完全相同。我将上述解释用于教育目的，因为研究它教会了我一些关于 git 的细节。另外，请注意 git 之所以难以做到这一点是有原因的——强烈鼓励进行历史跟踪——所以如果你这样做，一定要有充分的理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T17:44:32.100

如我所见，您不了解分支是什么。分支只是指向提交的指针。当您从 master 创建一个分支时，您不会创建任何提交，新分支只是指向与 master 完全相同的提交，它们都表示相同。所以，还没有什么可以压缩或变基，也没有历史。

只有在您做了一些更改并将它们提交到分支上之后，您的问题才会有意义：如何将分支中所做的所有更改作为一个提交合并到 master 中？只需使用`git merge --squash branch`.

# java - 当父框架调整大小时，如何确保 JPanel 缩小？

> ID：12391757
> 
> 赞同：1
> 
> 时间：2012-09-12T15:35:54.810
> 
> 标签：java, swing

我有一个基本的注释面板，我希望在调整父 jframe 的大小时缩小宽度，但它没有发生。我正在使用嵌套的 gridbaglayouts。

```
package com.protocase.notes.views;

import com.protocase.notes.controller.NotesController;
import com.protocase.notes.model.Subject;
import com.protocase.notes.model.Note;
import com.protocase.notes.model.database.PMSNotesAdapter;
import java.awt.Color;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

/**
 * @author DavidH
 */
public class NotesViewer extends JPanel {
    // <editor-fold defaultstate="collapsed" desc="Attributes">

    private Subject subject;
    private NotesController controller;

    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="Getters N' Setters">
    /**
     * Gets back the current subject.
     * @return 
     */
    public Subject getSubject() {
        return subject;
    }

    public NotesController getController() {
        return controller;
    }

    public void setController(NotesController controller) {
        this.controller = controller;
    }

    /**
     * Should clear the panel of the current subject and load the details for 
     * the other object.
     * @param subject 
     */
    public void setSubject(Subject subject) {
        this.subject = subject;
    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="Constructor">

    /**
     * -- Sets up a note viewer with a subject and a controller. Likely this 
     *    would be the constructor used if you were passing off from another
     *    NoteViewer or something else that used a notes adapter or controller.
     * @param subject
     * @param controller 
     */
    public NotesViewer(Subject subject, NotesController controller) {
        this.subject = subject;
        this.controller = controller;
        initComponents();
    }

    /** 
     * -- Sets up a note view with a subject and creates a new controller. This
     *    would be the constructor typically chosen if choosing notes was 
     *    infrequent and only one or two notes needs to be displayed.
     * @param subject 
     */
    public NotesViewer(Subject subject) {
        this(subject, new NotesController(new PMSNotesAdapter()));
    }

    /** 
     *  -- Sets up a note view without a subject and creates a new controller. 
     *     This would be for a note viewer without any notes, perhaps populating
     *     as you choose values in another form.
     * @param subject 
     */
    public NotesViewer() {
        this(null);
    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="initComponents()">

    /**
     * Sets up the view for the NotesViewer
     */
    private void initComponents() {
        // -- Make a new panel for the header
        JPanel panel = new JPanel();

        panel.setLayout(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();

        c.gridx = 0;
        c.fill = GridBagConstraints.HORIZONTAL;
        c.gridy = 0;
        c.weightx = .5;
        //c.anchor = GridBagConstraints.NORTHWEST;
        JLabel label = new JLabel("Viewing Notes for [Subject]");
        label.setAlignmentX(JLabel.LEFT_ALIGNMENT);
        label.setBorder(BorderFactory.createLineBorder(Color.YELLOW));

        panel.add(label);

        JButton newNoteButton = new JButton("New");
        c = new GridBagConstraints();
//        c.fill = GridBagConstraints.HORIZONTAL;
        c.gridx = 1;
        c.gridy = 0;
        c.weightx = .5;
        c.anchor = GridBagConstraints.EAST;
        panel.add(newNoteButton, c);

        // -- NotePanels
        c = new GridBagConstraints();
        c.fill = GridBagConstraints.HORIZONTAL;
        c.weightx = 1;
        c.weighty = 1;
        c.gridx = 0;
        c.gridwidth = 2;

        int y = 1;
        for (Note n : subject.getNotes()) {
            c.gridy = y++;
            panel.add(new NotesPanel(n, controller), c);
        }

        this.setLayout(new GridBagLayout());
        GridBagConstraints pc = new GridBagConstraints();
        pc.gridx = 0;
        pc.gridy = 0;
        pc.weightx = 1;
        pc.weighty = 1;
        pc.fill = GridBagConstraints.BOTH;

        panel.setBackground(Color.blue);
        JScrollPane scroll = new JScrollPane();
        scroll.setViewportView(panel);
        //scroll.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
        this.add(scroll, pc);
        //this.add(panel, pc);
        // -- Add it all to the layout
    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="private methods">
    //</editor-fold>
} 
```

* * *

```
package com.protocase.notes.views;

import com.protocase.notes.controller.NotesController;
import com.protocase.notes.model.Note;
import java.awt.CardLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.border.BevelBorder;
import javax.swing.border.Border;
import javax.swing.border.MatteBorder;

/**
 * @author dah01
 */
public class NotesPanel extends JPanel {
    // <editor-fold defaultstate="collapsed" desc="Attributes">
    private Note note;
    private NotesController controller;
    private CardLayout cardLayout;
    private JTextArea viewTextArea;
    private JTextArea editTextArea;
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="Getters N' Setters">

    public NotesController getController() {
        return controller;
    }

    public void setController(NotesController controller) {
        this.controller = controller;
    }

    public Note getNote() {
        return note;
    }

    public void setNote(Note note) {
        this.note = note;
    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="Constructor">

    /**
     * Sets up a note panel that shows everything about the note.
     * @param note 
     */
    public NotesPanel(Note note, NotesController controller) {

        this.note = note;
        cardLayout = new CardLayout();
        this.setLayout(cardLayout);

        // -- Setup the layout manager.
        this.setBackground(new Color(199, 187, 192));
        this.setBorder(new BevelBorder(BevelBorder.RAISED));

        // -- ViewPanel
        this.add("ViewPanel", initViewPanel());
        this.add("EditPanel", initEditPanel());

    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="EditPanel">
    private JPanel initEditPanel() {
        JPanel editPanel = new JPanel();
        editPanel.setLayout(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();

        c.fill = GridBagConstraints.HORIZONTAL;
        c.gridy = 0;
        c.weightx = 1;
        c.weighty = 0.3;
        editPanel.add(initCreatorLabel(), c);

        c.gridy++;
        editPanel.add(initEditTextScroll(), c);

        c.gridy++;
        c.anchor = GridBagConstraints.WEST;
        c.fill = GridBagConstraints.NONE;
        editPanel.add(initEditorLabel(), c);

        c.gridx++;
        c.anchor = GridBagConstraints.EAST;
        editPanel.add(initSaveButton(), c);

        return editPanel;
    }

    private JScrollPane initEditTextScroll() {
        this.editTextArea = new JTextArea(note.getContents());
        editTextArea.setLineWrap(true);
        editTextArea.setWrapStyleWord(true);
        JScrollPane scrollPane = new JScrollPane(editTextArea);
        scrollPane.setAlignmentX(JScrollPane.LEFT_ALIGNMENT);
        Border b = scrollPane.getViewportBorder();

        MatteBorder mb = BorderFactory.createMatteBorder(2, 2, 2, 2, Color.BLUE);

        scrollPane.setBorder(mb);
        return scrollPane;
    }

    private JButton initSaveButton() {
        final CardLayout l = this.cardLayout;
        final JPanel p = this;

        final NotesController c = this.controller;
        final Note n = this.note;
        final JTextArea noteText = this.viewTextArea;
        final JTextArea textToSubmit = this.editTextArea;
        ActionListener al = new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                //controller.saveNote(n);
                noteText.setText(textToSubmit.getText());
                l.next(p);
            }
        };

        JButton saveButton = new JButton("Save");
        saveButton.addActionListener(al);
        saveButton.setPreferredSize(new Dimension(62, 26));

        return saveButton;
    }

    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="ViewPanel">
    private JPanel initViewPanel() {
        JPanel viewPanel = new JPanel();
        viewPanel.setLayout(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();

        c.fill = GridBagConstraints.HORIZONTAL  ;
        c.gridy = 0;
        c.weightx = 1;
        c.weighty = 0.3;
        viewPanel.add(initCreatorLabel(), c);

        c.gridy++;

        viewPanel.add(this.initNoteTextArea(), c);

        c.fill = GridBagConstraints.NONE;
        c.anchor = GridBagConstraints.WEST;
        c.gridy++;
        viewPanel.add(initEditorLabel(), c);

        c.gridx++;
        c.anchor = GridBagConstraints.EAST;
        viewPanel.add(initEditButton(), c);

        return viewPanel;
    }

    private JLabel initCreatorLabel() {
        DateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        if (note != null) {
            String noteBy = "Note by " + note.getCreator();

            String noteCreated = formatter.format(note.getDateCreated());
            JLabel creatorLabel = new JLabel(noteBy + " @ " + noteCreated);
            creatorLabel.setAlignmentX(JLabel.LEFT_ALIGNMENT);
            return creatorLabel;
        } else {
            System.out.println("NOTE IS NULL");
            return null;
        }

    }

    private JScrollPane initNoteTextArea() {
        // -- Setup the notes area.
        this.viewTextArea = new JTextArea(note.getContents());
        viewTextArea.setEditable(false);
        viewTextArea.setLineWrap(true);
        viewTextArea.setWrapStyleWord(true);
        JScrollPane scrollPane = new JScrollPane(viewTextArea);
        scrollPane.setAlignmentX(JScrollPane.LEFT_ALIGNMENT);

        return scrollPane;
    }

    private JLabel initEditorLabel() {
        // -- Setup the edited by label.
        JLabel editorLabel = new JLabel(" -- Last edited by " + note.getLastEdited() + " at " + note.getDateModified());
        editorLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        return editorLabel;
    }

    private JButton initEditButton() {
        final CardLayout l = this.cardLayout;
        final JPanel p = this;

        ActionListener ar = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                l.next(p);
            }
        };

        JButton editButton = new JButton("Edit");
        editButton.setPreferredSize(new Dimension(62,26));
        editButton.addActionListener(ar);

        return editButton;
    }
    //</editor-fold>
    // <editor-fold defaultstate="collapsed" desc="Grow Width When Resized">

    @Override
    public Dimension getPreferredSize() {
        int fw  = this.getParent().getSize().width;
        int fh = super.getPreferredSize().height;
        return new Dimension(fw,fh);
    }
    //</editor-fold>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T04:09:48.203

对于手动控制，将组件侦听器添加到父组件，如下所示：

```
MyParentComponent.addComponentListener(new java.awt.event.ComponentAdapter() {
    public void componentResized(java.awt.event.ComponentEvent evt) {
        ComponentResized(evt);
    }
}); 
```

创建一个“ComponentResized”方法并将大小更改为您需要的任何内容，如下所示：

```
private void ComponentResized(ComponentEvent evt)
{
    MyChildComponent.setSize(newWidth, newHeight);
} 
```

# python - 内存高效将许多数据文件导入 Python 中的 pandas DataFrame

> ID：12391758
> 
> 赞同：0
> 
> 时间：2012-09-12T15:36:01.630
> 
> 标签：python, pandas

我将-delimited.dat 文件`DataFrame`的目录导入熊猫。`|`以下代码有效，但我最终用`MemoryError:`.

```
import pandas as pd
import glob

temp = []
dataDir = 'C:/users/richard/research/data/edgar/masterfiles'
for dataFile in glob.glob(dataDir + '/master_*.dat'):
    print dataFile
    temp.append(pd.read_table(dataFile, delimiter='|', header=0))

masterAll = pd.concat(temp) 
```

有没有更节省内存的方法？还是我应该全力以赴去数据库？（我最终会迁移到数据库，但我正在逐步迁移到熊猫。）谢谢！

FWIW，这是一个示例 .dat 文件的头：

```
cik|cname|ftype|date|fileloc
1000032|BINCH JAMES G|4|2011-03-08|edgar/data/1000032/0001181431-11-016512.txt
1000045|NICHOLAS FINANCIAL INC|10-Q|2011-02-11|edgar/data/1000045/0001193125-11-031933.txt
1000045|NICHOLAS FINANCIAL INC|8-K|2011-01-11|edgar/data/1000045/0001193125-11-005531.txt
1000045|NICHOLAS FINANCIAL INC|8-K|2011-01-27|edgar/data/1000045/0001193125-11-015631.txt
1000045|NICHOLAS FINANCIAL INC|SC 13G/A|2011-02-14|edgar/data/1000045/0000929638-11-00151.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T17:05:39.567

通常，如果您介意内存使用，最好使用生成器而不是提前创建列表。就像是：

```
dir_path = os.path.join(data_dir, 'master_*.dat')
master_all = pd.concat(pd.read_table(data_file, delimiter='|', header=0)
                                     for data_file in glob.glob(dir_path)) 
```

或者您可以为更详细的版本编写生成器函数。

无论如何，如果 RAM 不足以包含最终结果 + 列出完整文件的一些临时空间（可能更多......这取决于垃圾收集器的工作方式），这将无法解决问题。

# javascript - 正则表达式从包含多个类的单个字符串匹配 css 类名

> ID：12391760
> 
> 赞同：1
> 
> 时间：2012-09-12T15:36:09.537
> 
> 标签：javascript, css, regex

我有一个包含多个 css 类的长字符串。使用正则表达式，我想匹配每个类名，因为我需要像这样替换这些类名：

```
<span>CLASSNAME</span> 
```

我已经尝试了几个小时来想出一个解决方案，我认为我已经很接近了，但是对于某些类名，我无法从匹配中排除右大括号。

这是我一直在进行测试的示例字符串：

```
#main .items-Outer p{ font-family:Verdana; color: #000000; font-size: 50px; font-weight: bold; }#footer .footer-inner p.intro{ font-family:Arial; color: #444444; font-size: 30; font-weight: normal; }.genericTxt{ font-family:Courier; color: #444444; font-size: 30; font-weight: normal; } 
```

这是我到目前为止想出的正则表达式：

```
((^(?:.+?)(?:[^{]*))|((?:\})(?:.+?)(?:[^{]*))) 
```

请看我附上的截图，因为它会更清楚地显示我得到的匹配。我的问题是我显然想从任何匹配中排除大括号。

![正则表达式匹配](../Images/b32ac3dbd63cdb5865917440f07ff169.png)

为了澄清，我所追求的匹配示例是：

*   # main .items-Outer p

*   # 页脚 .footer-inner p.intro

*   .genericTxt

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:51:40.447

*当且仅当*没有任何嵌套的花括号时，以下应该有效：

```
/\.(-?[_a-zA-Z]+[_a-zA-Z0-9-]*)(?![^\{]*\})/ 
```

这是[一个演示](http://regexpal.com/?flags=g&regex=%5C.(-%3F%5B_a-zA-Z%5D%2B%5B_a-zA-Z0-9-%5D*)(%3F!%5B%5E%5C%7B%5D*%5C%7D)&input=%23main%20.items-Outer%20p%7B%20font-family%3AVerdana%3B%20color%3A%20%23000000%3B%20font-size%3A%2050px%3B%20font-weight%3A%20bold%3B%20%7D%23footer%20.footer-inner%20p.intro%7B%20font-family%3AArial%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D.genericTxt%7B%20font-family%3ACourier%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D)！

请注意，我正在为 valid-CSS-class-name 正则表达式引用[这个问题。](https://stackoverflow.com/questions/448981/what-characters-are-valid-in-css-class-names)

**编辑**

我刚刚阅读了您的评论，说明您希望匹配整个*选择器*，而不仅仅是*类名*。在这种情况下，试试这个，虽然我对它的健壮性没有信心：

```
/[^}]*(?=\{|$)/ 
```

这是[一个演示](http://regexpal.com/?flags=g&regex=%5B%5E%7D%5D*(%3F%3D%5C%7B%7C%24)&input=%23main%20.items-Outer%20p%7B%20font-family%3AVerdana%3B%20color%3A%20%23000000%3B%20font-size%3A%2050px%3B%20font-weight%3A%20bold%3B%20%7D%23footer%20.footer-inner%20p.intro%7B%20font-family%3AArial%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D.genericTxt%7B%20font-family%3ACourier%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:42:08.790

这是正则表达式

```
(?:(\}|^)).*?(?:\{) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T16:10:48.763

假设 str 包含您的 CSS，则以下正则表达式：

```
str.match(/(?:#\w+\s+)?\.[\w-]+(?:\s+\w+\s*\.\w+|\s+\w+)?/ig) 
```

返回：

```
["#main .items-Outer p", "#footer .footer-inner p.intro", ".genericTxt"] 
```

正则表达式是：

```
(?:#\w+\s+)?      -- optional leading CSS id, i.e. #abc
\.[\w-]+          -- CSS classname, i.e. .ab-c
(?:
    \s+\w+\s*\.\w+  -- optional CSS elt followed by classname, i.e. p.abc
|                   -- or
    \s+\w+          -- optional CSS elt, i.e. p
)? 
```

看[演示](http://regexpal.com/?flags=g&regex=%28%3F%3A%23%5Cw%2B%5Cs%2B%29%3F%5C.%5B%5Cw-%5D%2B%28%3F%3A%5Cs%2B%5Cw%2B%5Cs%2a%5C.%5Cw%2B%7C%5Cs%2B%5Cw%2B%29%3F&input=%23main%20.items-Outer%20p%7B%20font-family%3AVerdana%3B%20color%3A%20%23000000%3B%20font-size%3A%2050px%3B%20font-weight%3A%20bold%3B%20%7D%23footer%20.footer-inner%20p.intro%7B%20font-family%3AArial%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D.genericTxt%7B%20font-family%3ACourier%3B%20color%3A%20%23444444%3B%20font-size%3A%2030%3B%20font-weight%3A%20normal%3B%20%7D)

# c# - 从字节数组创建的输出位图中未对齐

> ID：12391763
> 
> 赞同：2
> 
> 时间：2012-09-12T15:36:27.273
> 
> 标签：c#, bitmap

我试图理解为什么我无法从字节数组创建位图。在仔细审查了有关从字节数组创建位图的现有帖子后，我发布了这个帖子，如下所示：

*   [从 byte[] 创建位图](https://stackoverflow.com/questions/6463811/creating-a-bitmap-from-a-byte)，
*   [在 C# 中使用图像和位图？](https://stackoverflow.com/questions/3405138/working-with-image-and-bitmap-in-c),
*   [C#：使用字节数组创建位图](https://stackoverflow.com/questions/817874/c-bitmap-creation-using-bytes-array)

我的代码旨在对 8bppIndexed 数字图像执行过滤器，将像素值写入 byte[] 缓冲区，以便在 8BppIndexed 位图中再次转换（经过一些处理以管理灰度级）

我的输入图像是通过特定 perl 代码创建的普通图像：

![输入图像](../Images/2ac8cb0f40ca5387280b84102e6c350c.png)

当然，在执行过滤器后，由于过滤器管理边界的方式，输出图像丢失了第一行和最后一行以及第一列和最后一列，因此从原始 256 x 256 图像中我得到了 254 x 254 图像。

只是为了专注于这个问题，我已经评论了负责执行过滤器的代码，以便真正执行的操作是显而易见的：

```
ComputedPixel = InputImage.GetPixel(myColumn, myRow).R; 
```

我知道，我应该使用锁定和解锁，但我更喜欢一个一个头痛。无论如何，这段代码应该是一种身份转换，最后我使用：

```
private unsafe void FillOutputImage()
{           
    OutputImage = new Bitmap (OutputImageCols, OutputImageRows, PixelFormat .Format8bppIndexed);
    ColorPalette ncp = OutputImage.Palette;
    for (int i = 0; i < 256; i++)
        ncp.Entries[i] = Color .FromArgb(255, i, i, i);
    OutputImage.Palette = ncp;

    Rectangle area  = new Rectangle(0, 0, OutputImageCols,  OutputImageRows);
    var data = OutputImage.LockBits(area, ImageLockMode.WriteOnly, OutputImage.PixelFormat);
    Marshal.Copy(byteBuffer, 0, data.Scan0, byteBuffer.Length);

    OutputImage.UnlockBits(data);         
} 
```

我得到的输出图像如下：

![输出图像](../Images/e9f7c153628494ade75c2cf9b9f6af8c.png)

很明显，我每行丢失一个像素，但我不明白为什么：

1.  我已经仔细控制了所有参数：`OutputImageCols`，长度`OutputImageRows` 和`byte[] byteBuffer`内容甚至写入已知值作为测试的方式。
2.  该代码与 StackOverflow 和其他地方发布的其他代码几乎相同。

也许有人可以帮助确定问题出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T10:58:44.930

答案不是我的正确答案，真正的答案来自[Hans Passant](https://stackoverflow.com/users/17034/hans-passant)，它给了我触发解决方案的提示（谢谢，Hans）。我关闭我的答案只是提供一个简单的细节，以防万一有人感兴趣：而不是处理缓冲区，然后通过 Marshal.Copy 复制它，处理不同缓冲区上的 4 字节对齐问题并使用更多内存比严格要求的内存大，我只是使用 LockBits 直接处理图像数据，使用已经为操作设置的数据结构。这是我在编辑给汉斯的问题中考虑的替代方案；我知道很遗憾我的问题没有明确说明。无论如何，现在一切正常。

# php - 你能在它杀死脚本之前捕获超出分配的内存错误吗？

> ID：12391764
> 
> 赞同：0
> 
> 时间：2012-09-12T15:36:27.803
> 
> 标签：php, memory, error-handling, try-catch, allocation

问题是我想在内存问题发生之前发现它们。我有一个从数据库获取行并将返回的关联数组转换为变量的系统，但我永远不知道数据库结果的大小是多少，或者一旦发出数据库请求将占用多少内存。这意味着我的软件可能会因为超出内存而失败。

但我想以某种方式避免这种情况。其中一种方法显然是使数据库请求更小，但如果这是不可能的，或者如果我不知道从数据库返回的数据大小怎么办？是否有可能“捕捉”在 PHP 中超出内存使用的情况？像这样的东西：

```
$requestOk=memory_test(function(){
    return doSomething();
});
if($requestOk){
    // Memory seems fine
    // $requestOk now has the value from memory_test() function
} else {
    // Function would have exceeded memory
} 
```

我只是发现我的脚本可能会因为内存问题而随时死掉，这是有问题的。据我所知，这里不能使用 try-catch，因为这是一个致命错误。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T01:26:12.727

您可以将函数 memory_get_usage 放在循环中，并检查每次循环迭代时是否接近内存限制。

# javascript - 在基于 iframe 的文本编辑器中禁用 Firefox 和 Chrome 拼写检查

> ID：12391766
> 
> 赞同：1
> 
> 时间：2012-09-12T15:36:39.427
> 
> 标签：javascript, html, firefox, gwt, designmode

有很多关于如何`textarea`使用`spellcheck='false'`. 但是，要拥有具有更高级功能的文本区域，必须使用`iframe`with `designMode = "on"`（例如，参见[此页面](http://www.evagoras.com/2011/02/02/web-based-content-editor-using-iframe/)，这是在 GWT 中实现 RichTextArea 的一种方式），我找不到关于该主题的单个帖子。

事实证明，Firefox 会检测到此类高级文本区域并在其中启用拼写检查。您可以通过从 Firefox/Chrome访问[此页面并在文本字段中输入一些内容来实时查看它。](http://examples.roughian.com/index.htm#Widgets~RichTextArea)如果您使用例如 Firebug 检查 html 源代码，您将看不到任何`textarea`标记，但 FF 拼写检查仍处于活动状态。我设法禁用它的唯一方法是设置`designMode`为`off`但是......我需要它是`on`。

问题是：**是否有可能在不设置 designMode =“off”的情况下禁用基于 iframe 的文本区域的 FF 拼写检查？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T16:08:01.170

只需设置`spellcheck="false"`到`body`iframe 中的元素上。在FF[这里](http://examples.roughian.com/index.htm#Widgets~RichTextArea)工作。

# objective-c - 避免嵌套块

> ID：12391767
> 
> 赞同：1
> 
> 时间：2012-09-12T15:36:44.110
> 
> 标签：objective-c, ios, uiviewcontroller, block

如果有一个视图控制器想要一次执行多个基于块的任务，那么在完成块执行后如何将控制权交还给视图控制器。

假设 ViewControllerOne 想要执行许多任务，每个任务都依赖于前一个任务的结果，那么在每个完成块执行后如何将这个控制权交还给 viewcontroller？

我开始考虑这个问题，我正朝着一个深度嵌套的块模式前进，这肯定只会让其他阅读或测试它的人感到困惑。

一个任务执行，完成块返回下一个任务所需的结果或错误，它有自己的完成任务，下一个任务依赖于等等。

如何在一个地方管理控件，即视图控制器？

完成块是否会使用指向正在调用它的视图控制器（self）的指针来调用处理下一个任务的下一个函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:56:30.643

你想要达到的目标对我来说有点不清楚，但你可以尝试类似的东西：

```
- (id)performBlocks:(NSArray *)blocks
{
    id state = [self initialState];

    for(id (^block)(id) in blocks)
    {
        state = block(state);

        // do something with state
    }

    return state;
} 
```

由于每个块都依赖于前一个块的结果，因此您必须串行执行它们。您可以传递一个由每个块更新的状态对象，然后在对连续块的调用之间，您可以根据调用之间的状态进行任何处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:56:08.687

这听起来像是 NSOperation 的依赖特性的理想用例。即，

```
- (void)addDependency:(NSOperation *)operation
- (void)removeDependency:(NSOperation *)operation 
```

您可以使某些操作依赖于其他操作，因此您可以构建操作之间的依赖关系图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T21:29:50.483

您关于“将控制权”交还给 viewController (VC) 的评论没有意义，因为 VC 通常被阻塞在 runLoop 回调中，等待某些事情发生。

如果我理解你想要什么，它就有机会在所有这些事情发生的同时处理其他发给 VC 的消息。定义一个方法：

```
{
   NSMutableArray *blocks; // ivar
   BOOL isCanceled;
}
typedef void (^block_t)(id input);

-(void)performBlock:(id)result; 
```

一次创建所有块或从容地创建所有块，但将它们添加到块数组中。每个块都有一个传递给它的对象，其中包含它需要的工作项。：

```
block_t b = ^(id input) {
  ... do some work using input;
  NSDictionary *dict = ....; // a possible result of the work
  dispatch_async(dispatch_get_main_queue(), ^{ [self performBlock:dict; } );
}; 
```

第一个块被分派到某个队列 - 也可能是一个后台队列，并将其结果发送回 VC：

```
-(void)performBlock:(id)result
{
  if(isCanceled) { // some other method set this flag
  ...
  } else if([blocks count]) {
    block_t b = [blocks objectAtIndex:0];
    [blocks removeObjectAtIndex:0]; // guessing at method name
    dispatch_async(some queue, b);
  }
} 
```

# php - 对于 REST，我如何使用 PHP 接收发布的数据？

> ID：12391771
> 
> 赞同：0
> 
> 时间：2012-09-12T15:36:45.503
> 
> 标签：php, rest

我想使用 PHP 为我的 Web 服务设置一个小型 RESTful 接口。问题是我查看了框架，但无法弄清楚如何接收没有字段名称的发布数据？

例如，如果服务器将数据发布到我的服务器，我无法弄清楚如何在不需要 postfield（POST 变量）的情况下获取它。传统上，使用表单，人们发送带有字段名称的帖子数据，例如：

```
 curl_setopt($ch, CURLOPT_POSTFIELDS, postfield=postvalue); 
```

我会使用这样的PHP代码：

```
 $postvalue=$_POST[postfield]; 
```

获取 postfield 的值，但由于服务器发布数据不使用 postfield 而只是发送 XML，我如何在没有字段的情况下获得它？如何捕获 XML？这就是我迷路的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:40:08.320

@netrox

*   将 application/x-www-urlencoded 用于 REST 服务是完全有效的
*   您可以读取任何类型的 POST 数据，如下所示：

    ```
    $data = file_get_contents('php://input'); 
    ```

如果您的服务接受 JSON 格式，您可以解码并使用它：

```
$json = json_decode($data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:42:01.910

```
file_get_contents('php://input'); 
```

这为您提供了客户端发送的原始正文

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T15:41:08.650

通常，您使用 GET 或 POST 将数据传递到服务器。根据你的 API 应该做什么，你必须选择一个。但是每个条目都应该有一个密钥，因为它更易于实现和使用。以强制顺序（以使您的代码知道在哪里）在没有键的情况下传递数据很容易出错。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-12T15:39:58.063

每个 post 变量都有一个名称。它来自哪里并不重要。如果他们正在发送 XML，则该 XML 数据有一个名称，您可以使用 $_POST 来获取 XML 数据。一旦获得 XML 数据，您就可以使用[XML 解析器](http://php.net/manual/en/book.xml.php)对其进行解析。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-12T15:41:11.863

你可以试试这个

```
<xml>
<item>
 <something>value</something>
</item>
</xml> 
```

因为你得到了 xml ......我想现在你从 curl 中得到文本并从你那里得到值使用这个

```
$whatineed = $curlValue->item->something; 
```

# excel - Excel公式6的倍数

> ID：12391775
> 
> 赞同：0
> 
> 时间：2012-09-12T15:37:01.470
> 
> 标签：excel, excel-formula

我不知道如何在excel中做到这一点：

如果 A1 / 6 rest != 0，则将 A1 舍入为下一个 6 的倍数。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T15:42:48.507

这正是 CEILING 函数所做的。

```
=CEILING(A1, 6) 
```

这会将 A1 舍入到下一个 6 的倍数。

# common-lisp - 如何更改 aif 以便能够在宏调用中访问“it”而不在包中公开“it”

> ID：12391776
> 
> 赞同：3
> 
> 时间：2012-09-12T15:37:00.633
> 
> 标签：common-lisp

如果您将 onlisp 中提供的 aif 代码[放在](http://www.paulgraham.com/onlisp.html)一个包中并尝试在另一个包中使用它，则会遇到 packagename:it 不是外部的问题。

```
(in-package :packagename)

(defmacro aif (test-form then-form &optional else-form)
  ‘(let ((it ,test-form))
     (if it ,then-form ,else-form))) 
```

通缉调用语法

```
(in-package :otherpackage)

(aif (do-stuff)
  (FORMAT t "~a~%" it)
  (FORMAT t "just got nil~%")) 
```

如何在代码中修复此行为，而无需在包声明中将变量设置为外部并且`it`只能通过`it`而不是访问`packagename:it`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T16:07:21.777

```
(defmacro aif (test then &optional else)
  ;;; read-from-string will intern the symbol
  ;;; in the current package, with the correct
  ;;; read-table-case
  (let ((it (read-from-string "it")))
    `(let ((,it ,test))
       (if ,it ,then ,else)))) 
```

或者这也有效：

```
(defmacro aif (test then &optional else)
  ;;; (intern "IT") or (intern "it") will work
  ;;; as well, depending on your readtable settings.
  ;;; using string or symbol-name gets around that.
  (let ((it (intern (string 'it))))
    `(let ((,it ,test))
       (if ,it ,then ,else)))) 
```

# xml - 将 fop 表向右移动

> ID：12391778
> 
> 赞同：2
> 
> 时间：2012-09-12T15:37:06.370
> 
> 标签：xml, pdf, xsl-fo, apache-fop

我`FOP`通过混合`xsl`和`xml`文件来实现，从而获得一个`PDF`文件。

但我似乎无法正确地将表格向右移动。
我操纵了以下与以下`attributes`相关的FOP `table`：

1.  `start-indent`：但是表格的内容移位超过了移位值的`start-indent`两倍，破坏了整体布局
2.  `margin-left`：这个属性在桌子上的效果似乎与`start-indent`

还有其他方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T13:50:23.313

`start-indent="20mm"`如果您在`fo:table`元素和`start-indent="0mm"`on `fo:table-body`（以及 on `fo:table-header`and `fo:table-footer`，如果使用它们）上指定，它应该可以工作。例如：

```
<fo:table table-layout="fixed" width="60mm" 
          border-style="solid" start-indent="20mm">
  <fo:table-column column-width="40%"/>
  <fo:table-column column-width="60%"/>
  <fo:table-body start-indent="0mm" >
    <fo:table-row>
      <fo:table-cell border-style="solid">
        <fo:block>Col1</fo:block>
      </fo:table-cell>
      <fo:table-cell border-style="solid">
        <fo:block>Col2</fo:block>
      </fo:table-cell>
    </fo:table-row>
  </fo:table-body>
</fo:table> 
```

[`start-indent`](http://www.w3.org/TR/xsl11/#start-indent)是继承的财产。重置它使其不适用于`fo:table`.

我无法使其与[`margin-left`](http://www.w3.org/TR/xsl11/#margin-left)（非继承属性）一起使用。这可能是一个 FOP 错误（它适用于[XEP](http://www.renderx.com/tools/xep.html)）。

另请参阅Xmlgraphics-fop wiki 上的[解释 XSL-FO 中的缩进继承一文（尤其是“带有表格的更多示例”部分）。](http://wiki.apache.org/xmlgraphics-fop/IndentInheritance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-19T14:01:56.153

如果上面的解决方案不起作用，还有另一种方法。它只是一个第一列空的表。所以它看起来像一个右移表。

```
<fo:block wrap-option="no-wrap">
    <fo:table border-collapse="collapse" width="100%">
        <fo:table-column column-width="proportional-column-width(60)" />
        <fo:table-column column-width="proportional-column-width(20)" />
        <fo:table-column column-width="proportional-column-width(20)" />
        <fo:table-header />
        <fo:table-body>
            <fo:table-row>
                <fo:table-cell />
                <fo:table-cell>
                    <fo:block>John</fo:block>
                </fo:table-cell>
                <fo:table-cell>
                    <fo:block>Doe</fo:block>
                </fo:table-cell>
            </fo:table-row>
            <fo:table-row>
                <fo:table-cell />
                <fo:table-cell>
                    <fo:block>Peter</fo:block>
                </fo:table-cell>
                <fo:table-cell>
                    <fo:block>Parker</fo:block>
                </fo:table-cell>
            </fo:table-row>
        </fo:table-body>
    </fo:table>
</fo:block> 
```

*   该表的宽度为 100%，第一列为空。
*   列具有百分比宽度。
*   显然不允许使用 % 列宽，请改用比例列宽。
*   在此示例中，没有标题名称，但您可以添加除第一列之外的名称。
*   如果需要边界，则应在逻辑上将第一个边界除外。

# php - 在 PHP 中获取给定 URL 的 google plus 共享

> ID：12391779
> 
> 赞同：4
> 
> 时间：2012-09-12T15:37:09.337
> 
> 标签：php, google-plus, google-plus-one

我想在 google plus 上获取 PHP 中给定 URL 的共享数量。我发现这个功能可以做到这一点：

```
function get_shares_google_plus($url) {
  $curl = curl_init();
  curl_setopt($curl, CURLOPT_URL, "https://clients6.google.com/rpc");
  curl_setopt($curl, CURLOPT_POST, 1);
  curl_setopt($curl, CURLOPT_POSTFIELDS, '[{"method":"pos.plusones.get","id":"p","params":{"nolog":true,"id":"' . $url . '","source":"widget","userId":"@viewer","groupId":"@self"},"jsonrpc":"2.0","key":"p","apiVersion":"v1"}]');
  curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
  curl_setopt($curl, CURLOPT_HTTPHEADER, array('Content-type: application/json'));
  $curl_results = curl_exec ($curl);
  curl_close ($curl);
  $json = json_decode($curl_results, true);
  print_r($json);
  return intval( $json[0]['result']['metadata']['globalCounts']['count'] );
} 
```

但是，我总是收到相同的信息：`Notice: Undefined index: result in ...`.

我做`print_r($json)`，我得到：`Array ( [0] => Array ( [error] => Array ( [code] => 400 [message] => Invalid Value [data] => Array ( [0] => Array ( [domain] => global [reason] => invalid [message] => Invalid Value ) ) ) [id] => p )`。

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T19:08:36.443

RPC API 从未打算供公众使用，Google 更改了身份验证以防止滥用。因此，您发布的代码不再起作用。但是，我找到了一个更简单的解决方案：

**更新 (23.01.2013)：**谷歌在 2012 年 12 月阻止了这个 URL - 所以这个方法不再起作用了！
**更新（15.05.2013）：**该方法再次有效！

```
<?php
/**
 * Get the numeric, total count of +1s from Google+ users for a given URL.
 * @author          Stephan Schmitz <eyecatchup@gmail.com>
 * @copyright       Copyright (c) 2013 Stephan Schmitz
 * @license         http://eyecatchup.mit-license.org/  MIT License
 * @link            <a href="https://gist.github.com/eyecatchup/8495140">Source</a>.
 * @param   $url    string  The URL to check the +1 count for.
 * @return  intval          The total count of +1s.
 */
function getGplusShares($url) {
    $url = sprintf('https://plusone.google.com/u/0/_/+1/fastbutton?url=%s', urlencode($url));
    preg_match_all('/{c: (.*?),/', file_get_contents($url), $match, PREG_SET_ORDER);
    return (1 === sizeof($match) && 2 === sizeof($match[0])) ? intval($match[0][1]) : 0;
} 
```

* * *

**更新 (18.01.2014)：**这是一个使用 curl 的改进版本，一个后备主机并进行一些错误处理（最新版本可以在这里找到[https://gist.github.com/eyecatchup/8495140](https://gist.github.com/eyecatchup/8495140)）。

```
<?php
/**
 * GetPlusOnesByURL()
 *
 * Get the numeric, total count of +1s from Google+ users for a given URL.
 *
 * Example usage:
 * <code>
 *   $url = 'http://www.facebook.com/';
 *   printf("The URL '%s' received %s +1s from Google+ users.", $url, GetPlusOnesByURL($url));
 * </code>
 *
 * @author          Stephan Schmitz <eyecatchup@gmail.com>
 * @copyright       Copyright (c) 2014 Stephan Schmitz
 * @license         http://eyecatchup.mit-license.org/  MIT License
 * @link            <a href="https://gist.github.com/eyecatchup/8495140">Source</a>.
 * @link            <a href="http://stackoverflow.com/a/13385591/624466">Read more</a>.
 *
 * @param   $url    string  The URL to check the +1 count for.
 * @return  intval          The total count of +1s.
 */
function GetPlusOnesByURL($url) {
    !$url && die('No URL, no results. ;)');

    !filter_var($url, FILTER_VALIDATE_URL) &&
        die(sprintf('PHP said, "%s" is not a valid URL.', $url));

    foreach (array('apis', 'plusone') as $host) {
        $ch = curl_init(sprintf('https://%s.google.com/u/0/_/+1/fastbutton?url=%s',
                                      $host, urlencode($url)));
        curl_setopt_array($ch, array(
            CURLOPT_FOLLOWLOCATION => 1,
            CURLOPT_RETURNTRANSFER => 1,
            CURLOPT_SSL_VERIFYPEER => 0,
            CURLOPT_USERAGENT      => 'Mozilla/5.0 (Windows NT 6.1; WOW64) ' .
                                      'AppleWebKit/537.36 (KHTML, like Gecko) ' .
                                      'Chrome/32.0.1700.72 Safari/537.36' ));
        $response = curl_exec($ch);
        $curlinfo = curl_getinfo($ch);
        curl_close($ch);

        if (200 === $curlinfo['http_code'] && 0 < strlen($response)) { break 1; }
        $response = 0;
    }
    !$response && die("Requests to Google's server fail..?!");

    preg_match_all('/window\.__SSR\s\=\s\{c:\s(\d+?)\./', $response, $match, PREG_SET_ORDER);
    return (1 === sizeof($match) && 2 === sizeof($match[0])) ? intval($match[0][1]) : 0;
} 
```

* * *

**更新 (02.11.2017)：** +1 计数正式失效！[正如产品经理 John Nack 在此 Google+ 帖子](https://plus.google.com/110610523830483756510/posts/Z1FfzduveUo)中所宣布的那样，Google 最近从其网络共享按钮中删除了共享计数（又名 +1 计数）。*（他们声称此举的目的是让 +1 按钮和分享框加载更快。）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:18:08.157

这段代码是行不通的。此外，没有提供此计数的公开 API。

此代码使用支持 +1 按钮的 RPC API。此 API 不是官方支持的 API，并且不打算在[Google+ 插件](http://developers.google.com/+/plugins)的内部实现之外使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T12:34:27.503

**此处其他帖子中列出的 cURL 和 API 方式不再有效。**

[至少还有一种方法](http://shinraholdings.com/870/count-facebook-likes-twitter-links-and-google-pluses-with-php/#google-plus)，但它很丑，谷歌显然不支持它。您只需使用正则表达式从官方按钮的 JavaScript 源代码中提取变量：

```
function shinra_gplus_get_count( $url ) {
    $contents = file_get_contents( 
        'https://plusone.google.com/_/+1/fastbutton?url=' 
        . urlencode( $url ) 
    );

    preg_match( '/window\.__SSR = {c: ([\d]+)/', $contents, $matches );

    if( isset( $matches[0] ) ) 
        return (int) str_replace( 'window.__SSR = {c: ', '', $matches[0] );
    return 0;
} 
```

# ssis - 为什么 SSIS 现在将 SQL DATE 转换为 DT_WSTR？

> ID：12391783
> 
> 赞同：3
> 
> 时间：2012-09-12T15:37:21.363
> 
> 标签：ssis

我将我的 SSIS 2008 包升级到 2012。现在突然间，他们都想将来自数据源的 SQL Server DATE 字段视为 DT_WSTR，而不是 2008 年的 DT_DBDATE……有人知道为什么或如何阻止它吗？这样做？

为了查找和比较，它一直在强迫我添加数据类型转换以将 DT_WSTR 转换回 DB_DBDATE，这非常烦人....

# php - 防止通过 url 注入 iframe？

> ID：12391785
> 
> 赞同：0
> 
> 时间：2012-09-12T15:37:25.920
> 
> 标签：php, security, url, iframe, code-injection

我正在尝试防止可以分发 url 的攻击，该攻击使用 url 中的 javascript 将 iframe（包含假登录屏幕）插入 PHP 站点。PHP 是否有某种方法可以在加载页面之前清除页面的 URL？

网址看起来像：`login.php?login_nav_map=%2Fv3%2Farchives%2Findex.php%22/%3E%3Cimg%20src=%22no.jpg%22%20onerror=%22document.write%28String.fromCharCode%2860,99,101,110,116,101,114,62,10,60,105,109,103,32,115,114,99,61,34,104,116,116,112,58,47,47,119,119,119,46,119,111,114,108,100,116,118,112,99,46,99,111,109,47,98,108,111,45,99,111,110,116,101,110,116,47,117,112,108,111,97,100,115,47,50,48,49,49,47,48,56,47,97,98,99,45,111,110,108,105,110,101,45,116,118,46,106,112,103,34,47,62,60,98,114,47,62,10,60,104,49,62,65,100,`

并且字符代码将 iframe 插入到我不想要的页面中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:43:46.237

您的问题确实令人困惑，因此我将尝试回答几个问题，希望对您有所帮助。

**您有一个不希望人们在 iframe 中加载的网页。**

使用框架突破脚本，通常类似于

```
if (top.location != location) {
    top.location.href = document.location.href ;
} 
```

**您有一个网页，人们可以在其中发布内容，并且您不希望有人输入 iframe 代码并在您的页面上加载框架。**

清理输入。看看[`htmlentities`](http://php.net/manual/en/function.htmlentities.php)。这将`<`和`>`（除其他外）转换为它们的 HTML 实体，因此所有内容都将在页面上可见，但浏览器不会将任何标签解析为代码。没有更多`<script>`，它会显示为只是而不是执行里面的代码。

**您有一个网站，其中 URL 参数在代码中具有某种含义，并且您不希望有人将恶意 URL 作为参数。**就像是`http://mysite.com?foo=bar&url=somebadwebsite.com/virus.php`

您应该有一个要阻止的 URL 或域的黑名单。查看[`parse_url`](http://php.net/manual/en/function.parse-url.php)以获取 URL 的各个部分，您可以使用它[`in_array`](http://php.net/manual/en/function.in-array.php)来查看它是否`host`是列入黑名单的数组的一部分。

**您有一个网站，其中 URL 参数控制页面的内容。**类似的东西`http://mysite.com?foo=bar&title=Hello`，它在页面上显示“你好”。您不希望有人在那里注入 JS 并让您的页面执行该操作。

这样做通常是个坏主意。在这种情况下，您应该有一个可能值的白名单。

```
$value = $_GET['title']
switch ($value) {
    case 'Hello':
        // do something for hello
        break;
    case 'Goodbye':
        // do something for goodbye
        break;
    default:
        // do something if it's something you don't expect/want as input
} 
```

# vba - 屏幕更新效果

> ID：12391786
> 
> 赞同：19
> 
> 时间：2012-09-12T15:37:36.980
> 
> 标签：vba, excel, optimization

我一直在测量代码执行时间，以衡量在本地执行脚本和在服务器上执行脚本之间的差异。有一次我忘了禁用`screen updating`，很庆幸我在更详细地考虑它之前对闪光灯不敏感：

当我第一次开始使用时，`VBA`我总是认为它只是被使用过，所以它不会吓到最终用户认为他们的 PC 即将崩溃。`screen updating`当我开始阅读更多关于提高代码效率的内容时，我明白了它的用途，但是对代码执行时间有多大影响呢？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-13T12:02:48.713

如果代码与 Excel 交互的方式导致屏幕内容发生更改，则关闭屏幕更新只会影响执行时间。屏幕变化量越大，影响就越大。其他发布的答案恰当地证明了这一点。

其他可以影响执行时间的应用程序设置是计算和事件处理。使用此代码模板作为起点（错误处理程序确保在子结束时重新打开这些属性，即使它出错）

```
Sub YourSub()
    On Error GoTo EH

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.EnableEvents = False

    ' Code here

CleanUp:
    On Error Resume Next
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    Application.EnableEvents = True
Exit Sub
EH:
    ' Do error handling
    Resume CleanUp
End Sub 
```

存在可以提供更大的执行速度改进的其他技术。

最有用的包括

1.  避免`Select`，`Activate`并且`ActiveCell/Sheet/Workbook`尽可能地。而是声明和分配变量并引用它们。
2.  引用大范围时，将 Range 数据复制到变体数组进行处理，然后将结果复制回范围。
3.  使用`Range.SpecialCells`,`Range.Find`和`Range.AutoFilter`来限制引用的单元格的数量。

SO上有很多这些技术的例子。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-12T16:09:52.837

如果您想查看一个相当激烈的示例来说明为什么`ScreenUpdating`重要，请运行以下代码。在 Excel 2011 中，我在没有`ScreenUpdating = false`! 这是一个*巨大*的时间差异。

```
Sub testScreenUpdating()

    Dim i As Integer
    Dim numbSwitches As Integer
    Dim results As String

    'swap between sheets this number of times
    numbSwitches = 1000

    'keep track of time
    Dim startTime As Double
    startTime = Time

    'swap between sheets 1/2 (need both sheets or this will crash)
    For i = 1 To numbSwitches
        Sheets(1 + (i Mod 2)).Select
    Next i

    'get results
    results = "Screen Updating not disabled: " & Format(Time - startTime, "hh:mm:ss") & " seconds"
    startTime = Time

    'scenario 2 - screenupdating disabled

    Application.ScreenUpdating = False

    'swap between sheets 1/2 (need both sheets or this will crash)
    For i = 1 To numbSwitches
        Sheets(1 + (i Mod 2)).Select
    Next i

    Application.ScreenUpdating = True

    'get results for part two
    results = results & vbCrLf & "Screen Updating IS disabled: " & Format(Time - startTime, "hh:mm:ss") & " seconds"

    'show results
    MsgBox results

End Sub 
```

* * *

此外，虽然我们讨论的是提高效率的方法，但另一个关键点是`Select`、`Selection`和`Activate`很少（如果有的话）必要。当您录制宏时，它总是会使用这些宏，但是在极少数情况下您需要在代码中实际使用它们。同样，`Active`标题中的任何内容（例如`ActiveCell`）通常都表明您的代码将变慢，因为您可能正在选择单元格。

您几乎总是可以专门参考单元格/工作表并避免选择。例如：

```
msgbox (Worksheets(1).Range("A1").value) 
```

无论您当前是否在第一个工作表上，都可以使用。一个常见的新 VBA 错误是执行以下操作：

```
Worksheets(1).Select
msgbox (Range("A1").value) 
```

这是一个不需要的步骤。

这增加了代码运行时的大量时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T15:37:36.980

首先，我一直在使用 Richie (UK) Post #7 [Here编写的脚本](http://www.ozgrid.com/forum/showthread.php?t=56900&p=293030#post293030)

它只是迭代一个循环，改变一个单元格中 i 的值。我稍微改变了它，所以它循环了 10,000 次，我为样本量执行了 10 次。

*屏幕更新对我的代码执行速度有何影响？*

`Screen Updating`这些是禁用和启用时的执行长度：

```
Disabled    Enabled
0.61909653  2.105066913
0.619555829 2.106865363
0.620805767 2.106866315
0.625528325 2.102403315
0.625319976 2.0991179
0.621287448 2.105103142
0.621540236 2.101392665
0.624537531 2.106866716
0.620401789 2.109004449 
```

如您所见，在`Screen Updating`未禁用时执行代码所需的时间几乎是 3.5 倍。

这两个代码都是使用 VB 编辑器中的“运行”按钮执行的，而不是“观看”电子表格。

代码开头和结尾的 2 行简单的代码：

```
Application.ScreenUpdating = False
Application.ScreenUpdating = True 
```

但是，它们会对您的执行效率产生很大影响！

**注意：**显然`Screen Updating`这里的许多人都知道 的优点，但这可能对初学者有好处，我发现查看数字很有趣！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-09T21:06:46.857

关于屏幕更新，有一件重要的事情需要了解，我在之前的任何答案中都没有看到。从我自己的测试中，我发现关闭和打开屏幕更新大约需要 15 毫秒（通过 Excel 互操作在 C# 中测试）。如果您将执行任何花费更少时间的事情，请记住这一点。毕竟不要在某个循环中多次打开/关闭屏幕更新。那将是真正的性能杀手。

如果你想快速使用 C++，还有一个注意事项（你可能不想听到）。它通常比 VBA 快 5 到 10 倍（不要在这里抓住我，这取决于您的实际操作）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-14T11:47:44.243

我知道这是一个旧线程，但是：

1.  设置`ScreenUpdating = true`，但请记住将其设置回其旧值。
2.  更改工作簿也将重置`ScreenUpdating`。

# css - A 元素中的border-top

> ID：12391788
> 
> 赞同：0
> 
> 时间：2012-09-12T15:37:42.673
> 
> 标签：css, zurb-foundation

我需要一些帮助来为 A 元素设置边框顶部。正如您[在此处](http://comvivem.treswd.com/net/ "这里")看到的，按钮是一个 A 样式元素，具有

```
<hr> 
```

定位绝对，然后从上到下移动以实现该行为，但这适用于此按钮（注意 HR 中的宽度：85%）但如果我希望在所有站点的其余按钮中具有相同的行为，那么这种方法不会工作导致宽度：85%。所以我的问题是：为 A 元素设置边框顶部是否可以获得相同的行为？边框顶部必须与主按钮具有相同的宽度，但您可能会注意到留有 padding: 0 5px。

提前感谢和欢呼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:50:03.570

是的，让`<a>`行为像块元素：

```
a{
   display:block;
   border-top: 2px solid #FCC;
 } 
```

`<a>`这将为您的 html 中的所有元素提供与您的 hr 相同颜色的顶部边框。

或者您可以将其应用于您已经在`<a>`标签上的按钮类：

```
.button{
   display:block;
   border-top: 2px solid #FCC;
 } 
```

# android - 谷歌应用引擎和安卓

> ID：12391792
> 
> 赞同：3
> 
> 时间：2012-09-12T15:37:46.700
> 
> 标签：android, google-app-engine

我是 android 开发的新手，发现很难理解一些主题。我打算开发一个投票应用程序，我想从我的服务器发布问题，这些问题在应用程序中更新，用户的回复存储在我的在线数据库中。我不想要我的应用程序的任何 Web 界面。

我知道如何使用 eclipse、android sdk 和 ADT 创建一个 android 应用程序。同样在网上阅读后，我知道我需要后端成为我的服务器和数据库的 Google App Engine（我需要外部数据库）。

1）我的第一个问题是人们使用python开发appengine端代码而我不知道python，我只知道java的基础（通过android编程），所以我应该使用appengine SDK for Java吗？

2）我是否必须安装“Google plugin for eclipse”来编码服务器端程序，还是只需要appengine sdk？插件有个“App engine连接android项目”的功能，是不是很有用？

3）我读到我需要使用 GWT SDK 来使用 GAE 对 webapp 进行编程，但是正如我所说我不需要任何 web 界面，我需要 GWT 吗？

有关如何继续我的申请的任何帮助都将非常有用。谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T15:41:47.370

我不确定您从哪里得到所有这些误解，让我一一澄清

1.  首先Android应用程序的后端不需要使用GAE，后端可以是任何以可解析格式发出数据的东西。因此，您可以使用`JSP`、`Node.js`、或任何其他适合您需要的 Web 框架。`Ruby on Rails``Asp.Net`
2.  就像您可以使用任何 Web 框架一样，您也可以使用任何适合您的数据库。

> 我的第一个问题是人们使用 python 开发 appengine 端代码而我不知道 python，我只知道 java 的基本知识（通过 android 编程），所以我应该使用 appengine SDK for Java 吗？

如果您想使用 Java 为 GAE 开发，请继续，它只是带有一些限制的 servlet。

> 2）我是否必须安装“Google plugin for eclipse”来编码服务器端程序，还是只需要appengine sdk？插件有个“App engine连接android项目”的功能，是不是很有用？

安装 Google 插件是可选的，您可以使用 ant builds 构建它。至于appengine连接的android项目，试一试，我确实有帮助。但它是否适合您的需求，由您尝试后决定。

> 3）我读到我需要使用 GWT SDK 来使用 GAE 对 webapp 进行编程，但是正如我所说我不需要任何 web 界面，我需要 GWT 吗？

对于 GAE，使用 GWT 是完全可选的。仅在需要时使用它。

# linux - 测试夏令时变化

> ID：12391793
> 
> 赞同：1
> 
> 时间：2012-09-12T15:37:51.113
> 
> 标签：linux, date, dst

如果有人可以提供帮助，我在 Linux 中的 date 命令有一个小问题，我用它来及时跳转以触发我们的计费流程，以便我们可以快速测试。

我遇到的问题是当我跑步时

```
date --set="OCT 27 01:00:59 BST 2012 2 day" 
```

我得到的返回日期是 2012 年 10 月 29 日星期一 00:00:59 GMT，这是正确的，因为它考虑了日光节约。

但是当我跑步时

```
date --set="MAR 30 00:00:59 GMT 2013 3 day" 
```

我得到 Apr 2 00:00:59 BST 2013 这是错误的，因为我想要的是 Apr 2 01:00:59 BST 2013。

为什么它以一种方式工作而不是另一种方式，以及处理这种情况的最佳方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T11:34:46.030

根据：[http](http://ascending.wordpress.com/2008/04/03/how-linux-handles-summer-time/) ://ascending.wordpress.com/2008/04/03/how-linux-handles-summer-time/ 使用

```
zdump -v Europe/Chisinau 
```

供您所在地区查看您的系统何时添加/删除额外的 DST 小时

但实际上，您在 DST 切换后 1 天请求了 BST（英国夏令时）日期，在另一种情况下，您在 DST 切换后 2 天请求了 GMT 日期，但 GMT 没有夏令时偏移。

# jqgrid - 保存新行时 JqGrid 基本网格示例错误

> ID：12391795
> 
> 赞同：2
> 
> 时间：2012-09-12T15:37:52.973
> 
> 标签：jqgrid

我正在使用[jqGrid Demos](http://www.trirand.com/blog/jqgrid/jqgrid.html#t24)中的 Basic Grid 示例：

```
jQuery("#rowed1").jqGrid(
        {
            url : 'clientArray',
            datatype : "local",
            colNames : [ 'Inv No', 'Date', 'Client', 'Amount', 'Tax',
                    'Total', 'Notes' ],
            colModel : [ {
                name : 'id',
                index : 'id',
                width : 55,
                editable : true,
                key: true
            }, {
                name : 'invdate',
                index : 'invdate',
                width : 90,
                editable : true
            }, {
                name : 'name',
                index : 'name',
                width : 100,
                editable : true
            }, {
                name : 'amount',
                index : 'amount',
                width : 80,
                align : "right",
                editable : true
            }, {
                name : 'tax',
                index : 'tax',
                width : 80,
                align : "right",
                editable : true
            }, {
                name : 'total',
                index : 'total',
                width : 80,
                align : "right",
                editable : true
            }, {
                name : 'note',
                index : 'note',
                width : 150,
                sortable : false,
                editable : true
            } ],
            rowNum : 10,
            rowList : [ 10, 20, 30 ],
            pager : '#prowed1',
            sortname : 'id',
            viewrecords : true,
            sortorder : "desc",
            editurl : "clientArray",
            caption : "Basic Example"
        });
jQuery("#rowed1").jqGrid('navGrid', "#prowed1", {
    edit : false,
    add : false,
    del : false
}); 
```

以下事件用于处理用户单击编辑、保存和取消按钮：

```
jQuery("#ed1").click(function() {
    var id = jQuery('#rowed1').jqGrid('getGridParam','selrow');
    jQuery("#rowed1").jqGrid('editRow', id);
    this.disabled = 'true';
    jQuery("#sved1,#cned1").attr("disabled", false);
});
jQuery("#sved1").click(function() {

    var rowid = jQuery('#rowed1').jqGrid('getGridParam','selrow');
    alert('id: ' + rowid);
    jQuery("#rowed1").jqGrid('saveRow', rowid , false );
    jQuery("#sved1,#cned1").attr("disabled", true);
    jQuery("#ed1").attr("disabled", false);
    jQuery("#aded1").attr("disabled", false);

});
jQuery("#cned1").click(function() {
    var id = jQuery('#rowed1').jqGrid('getGridParam','selrow');
    jQuery("#rowed1").jqGrid('restoreRow', id);
    jQuery("#sved1,#cned1").attr("disabled", true);
    jQuery("#ed1").attr("disabled", false);
    jQuery("#aded1").attr("disabled", false);
});

jQuery("#aded1").click(function() {
    jQuery("#rowed1").jqGrid('addRow',  'new');
    this.disabled = 'true';
    jQuery("#sved1,#cned1").attr("disabled", false);
}); 
```

和按钮的html：

```
 <input type="BUTTON" id="aded1"  value="Add Row" />
 <input type="BUTTON" id="ed1" value="Edit row 3" /> 
 <input type="BUTTON" id="sved1" disabled='true' value="Save row 3" /> 
 <input type="BUTTON" id="cned1" disabled='true' value="Cancel Save" /> 
```

但网格无法正常工作，因为：

*   保存新行后，它保持选中状态，我无法选择其他行。
*   当我取消对一行的编辑时，它会删除其他几行。
*   当我第二次单击添加新行按钮时，谷歌浏览器调试器控制台显示错误：**未捕获的类型错误：无法读取未定义的属性“名称”**

我几乎可以肯定它与新的行 ID 有关，但经过 2 天的尝试，我将不胜感激，在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:35:47.743

您将错误的参数传递给`addRow`. 来自[jqGrid 文档`addRow`](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ainline_editing#addrow)：

> 调用约定：
> 
> ```
> jQuery("#grid_id").jqGrid('addRow',parameters); 
> ```
> 
> 其中参数是一个对象，具有以下默认值：
> 
> ```
> parameters =
> {
>   rowID : "new_row",
>   initdata : {},
>   position :"first",
>   useDefValues : false,
>   useFormatter : false,
>   addRowParams : {extraparam:{}}
> } 
> ```

此外，您将希望`rowID`每次都设置为等于一个新值。您可以显式执行此操作，也可以将其设置`undefined`为让 jqGrid 为每个新行分配一个随机 ID。

* * *

例如：

```
jQuery("#aded1").click(function() { 
    var parameters = { 
          rowid : undefined, 
          initdata : {}, 
          position :"first", 
          useDefValues : false, 
          useFormatter : false, 
          addRowParams : {extraparam:{}} 
    };

    jQuery("#rowed1").jqGrid('addRow', parameters); 
}); 
```

# virtualhost - 使用 Wampserver 的多个虚拟站点

> ID：12391799
> 
> 赞同：0
> 
> 时间：2012-09-12T15:38:27.760
> 
> 标签：virtualhost, wampserver

我在创建多个虚拟主机时遇到问题，我将 C:\wamp\alias\web.local 编辑为如下所示：

```
NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin webmaster@website1.local           
    DocumentRoot "C:/Documents and Settings/username/workspace/www.website1.com"
    ServerName website1.local

    <Directory "C:/Documents and Settings/username/workspace/www.website1.com">
            DirectoryIndex index.php index.htm index.html
            Options Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
            AllowOverride All
            Order allow,deny
            Allow from all
    </Directory>
</VirtualHost>

NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin webmaster@website2.local           
    DocumentRoot "C:/Documents and Settings/username/workspace/www.website2.com"
    ServerName website2.local

    <Directory "C:/Documents and Settings/username/workspace/www.website2.com">
            DirectoryIndex index.php index.htm index.html
            Options Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
            AllowOverride All
            Order allow,deny
            Allow from all
    </Directory>
</VirtualHost>

NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin webmaster@website3.local           
    DocumentRoot "C:/Documents and Settings/username/workspace/www.website3.com"
    ServerName website3.local

    <Directory "C:/Documents and Settings/username/workspace/www.website3.com">
            DirectoryIndex index.php index.htm index.html
            Options Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
            AllowOverride All
            Order allow,deny
            Allow from all
    </Directory>
</VirtualHost>

NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin webmaster@website4.local           
    DocumentRoot "C:/Documents and Settings/username/workspace/www.website4.com"
    ServerName website4.local

    <Directory "C:/Documents and Settings/username/workspace/www.website4.com">
            DirectoryIndex index.php index.htm index.html
            Options Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
            AllowOverride All
            Order allow,deny
            Allow from all
    </Directory>
</VirtualHost> 
```

我的主机文件如下所示：

```
127.0.0.1       localhost
127.0.0.1       website1.local
127.0.0.1       website2.local
127.0.0.1       website3.local
127.0.0.1       website4.local 
```

我重新启动了 Wampserver，但似乎无法访问 website1.local、website2.local、website3.local 或 website4.local。我收到“网络错误（dns_unresolved_hostname）”错误消息。

请注意*localhost*是唯一一个似乎可以工作的。

任何帮助表示赞赏。

问候，斯蒂芬

*编辑*

我在 Windows XP 上运行 Wampserver 2.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T12:52:25.213

几个问题，您不能通过编辑该文件来创建虚拟主机。

您使用此文件 c:\wamp\bin\apache\apache.2.xy\conf\extra\httpd-vhosts.conf 然后从 https.conf 中取消注释“包含 conf/extra/chris-vhosts.conf”文件，它靠近文件的底部。

现在，您在上面引用的 VHOST 定义看起来很不错，因此您可能只需移动到正确的位置，然后您就可以开始了。

## 除了

使用包含空格的目录结构是一个非常非常糟糕的主意，例如

```
DocumentRoot "C:/Documents and Settings/username/workspace/www.website3.com" 
```

将您的站点代码放在这样的结构中要安全得多

```
C:\websites\www\website3
C:\websites\www\website4 
```

甚至

```
D:\websites\www\website4 
```

哦，还有一件事，你只需要一个参考

```
NameVirtualHost *:80 
```

通常是 vhost 定义文件的第一行。

# c++ - 对重载的模棱两可的调用 - 强制转换

> ID：12391800
> 
> 赞同：2
> 
> 时间：2012-09-12T15:38:29.053
> 
> 标签：c++, casting, compiler-errors, long-integer, code-cleanup

在一个程序上工作，我的一行代码给我带来了问题。我想知道这里是否有人可能知道如何修复这一行代码：

```
long long x;
srand(time(NULL));
x = rand() % 1000;
long long range = pow (2, 60*(pow(2,x)-1)) ; 
```

每当我运行它时，我都会收到一条错误消息，指出存在对重载的模棱两可的调用。我做了一些研究，它似乎与不同的类型有关（关于`long long`）。我在想可能有一种方法可以用不同的方式来解决这个问题，但是我不确定如何做到这一点。有人会碰巧对如何使第二行代码正常工作有任何建议吗？

编辑：我收到以下错误：

```
main1.cpp:149: error: ISO C++ says that these are ambiguous, even though the worst conversion for the first is better than the worst conversion for the second:
/usr/include/architecture/i386/math.h:343: note: candidate 1: double pow(double, double)
/usr/include/c++/4.2.1/cmath:357: note: candidate 2: float std::pow(float, float)
main1.cpp:149: error: ISO C++ says that these are ambiguous, even though the worst conversion for the first is better than the worst conversion for the second:
/usr/include/architecture/i386/math.h:343: note: candidate 1: double pow(double, double)
/usr/include/c++/4.2.1/cmath:357: note: candidate 2: float std::pow(float, float) 
```

使用Luchian建议的方法出现以下错误如下：

```
main1.cpp:149: error: call of overloaded 'pow(int, long long int&)' is ambiguous
/usr/include/architecture/i386/math.h:343: note: candidates are: double pow(double, double)
/usr/include/c++/4.2.1/cmath:357: note:                 float std::pow(float, float)
/usr/include/c++/4.2.1/cmath:361: note:                 long double std::pow(long double, long double)
/usr/include/c++/4.2.1/cmath:365: note:                 double std::pow(double, int)
/usr/include/c++/4.2.1/cmath:369: note:                 float std::pow(float, int)
/usr/include/c++/4.2.1/cmath:373: note:                 long double std::pow(long double, int) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:45:43.307

`pow`for`float`和有重载版本`double`。由于您要传入`long`s，因此您需要强制转换为`float`or `double`，但编译器不知道您想要哪个。

尝试更改`2`为`2.0`. 这使它成为`double`并且应该解决歧义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:45:31.910

使用任一：

```
long long range = ::pow (2, 60*(::pow(2,x)-1)) ; 
```

或者

```
long long range = std::pow (2, 60*(std::pow(2,x)-1)) ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:40:25.693

我相信错误在于`pow`要求第一个参数不是`int`。

候选函数应该是：

```
(1)float pow( float base, float exp );

(2)double pow( double base, double exp );

(3)long double pow( long double base, long double exp ); 
```

你需要：

```
long long range = pow(2.0, 60*(pow(2.0, x)-1)); 
```

所以编译器可以知道使用的`double`版本`pow`

# iphone - App in App purchase：如果没有产品可以恢复，有什么委托方法吗？

> ID：12391803
> 
> 赞同：0
> 
> 时间：2012-09-12T15:38:41.157
> 
> 标签：iphone, in-app-purchase, product, restore

我有一个应用程序为用户提供“恢复”按钮来恢复以前购买的产品。

但是如果用户之前没有购买过任何产品，当他点击“恢复”按钮时

```
([[SKPaymentQueue defaultQueue] restoreCompletedTransactions];) 
```

该程序将等待苹果的响应。两者都不：

```
(void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions 
```

也不

```
(void)paymentQueue:(SKPaymentQueue *)queue restoreCompletedTransactionsFailedWithError:(NSError *) 
```

错误被调用。

有没有推荐的方法来处理这类问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T07:26:44.843

如果 net 或 Apple 服务器已关闭，则一定有错误。在物理设备上检查它。此外，如果您想检查是否有任何产品，您可以检查如下；

```
- (void) paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue
{
if([queue.transactions count]>0){
    NSLog(@"received restored transactions: %i", queue.transactions.count);
} 
else {
    NSLog(@"No Product to restore"); 
} 
```

# java - 无法加载 BufferedImage

> ID：12391805
> 
> 赞同：1
> 
> 时间：2012-09-12T15:38:50.927
> 
> 标签：java, image, netbeans

我有一个带有该代码的表格：

```
public Form() 
{
    initComponents();
    try 
    {
        File file= new File("avatar.jpg");
        BufferedImage image= ImageIO.read(file);
    } 
    catch (IOException ex) 
    {
        System.out.println("Failed to load image");
    }
} 
```

问题是代码总是抛出 IOException 并进入 catch 块。
所以文件没有被读取。
我使用 Netbeans 7.2 创建了项目，目录如下所示：

![目录](../Images/3fd2ca8528d03bbc773fa8f1234d5625.png)

有什么问题？也许文件不应该在那里，而是在父目录中？要不然是啥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:47:52.283

看起来你有一个命名空间，`poker.*` 这一切都取决于 jvm 的初始化位置。你的主线在哪里？在`/Users/ramy/NetBeansProjects/Poker/src`吗？

此外，我建议您使用`getResource()`所有文件加载需求，尤其是在 jar 中。

```
this.getClass().getResource("/resource/buttons1.png")
or
this.getClass().getResourceAsStream("/resource/TX_Jello2.ttf") 
```

您可以通过执行以下操作找出程序默认路径的位置：

```
System.getProperty("user.dir"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:51:22.177

您的图像是否被打包在您的 jar 中？要找出这一点，请像提取普通 zip 文件一样提取 jar 文件，并检查图像是否在那里（通常位于*jarname\packagename\filename*。如果是，那么您需要使用`getResourceAsStream()`.

它会是这样的：

```
public class Test {
  private static final String absName = "/yourpackage/yourimage.jpg";

  public static void main(String[] args) {
    Class c=null;
    try {
      c = Class.forName("yourpackage.Test");//pkg is the package name in which the resource lies
    } catch (Exception ex) {
      // This should not happen.
    }
    InputStream s = c.getResourceAsStream(absName);
    // do something with it.
  }

    public InputStream getResourceAsStream(String name) {
      name = resolveName(name);
      ClassLoader cl = getClassLoader();
      if (cl==null) {
        return ClassLoader.getSystemResourceAsStream(name); // A system class.
      }
      return cl.getResourceAsStream(name);
    }

    public java.net.URL getResource(String name) {
      name = resolveName(name);
      ClassLoader cl = getClassLoader();
      if (cl==null) {
        return ClassLoader.getSystemResource(name);  // A system class.
      }
      return cl.getResource(name);
    }

    private String resolveName(String name) {
      if (name == null) {
        return name;
      }
      if (!name.startsWith("/")) {
        Class c = this;
        while (c.isArray()) {
          c = c.getComponentType();
        }
        String baseName = c.getName();
        int index = baseName.lastIndexOf('.');
        if (index != -1) {
          name = baseName.substring(0, index).replace('.', '/') + "/" + name;
        }
      } else {
        name = name.substring(1);
      }
      return name;
    }
} 
```

**参考：**

*   [访问资源](http://docs.oracle.com/javase/1.5.0/docs/guide/lang/resources.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:46:28.263

如果没有看到错误，我会说最可能的原因是它找不到文件。因此，我建议您将 File 构造函数中的“avatar.jpg”替换为它的绝对文件路径。例如

```
File file = new File("INSERT_PATH_TO_FILE/avatar.jpg"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T15:48:18.930

您不能假设图像将“存在”，因为您的 .java 和图像之间的相对路径似乎没问题。

访问资源取决于您的“类型”项目（Web、独立......）。在您的情况下，您可以尝试从类路径中获取图像

```
final File inputFile = new ClassPathResource("....").getFile();
    final BufferedImage inputImg = ImageIO.read(inputFile); 
```

# mysql - 删除重复的行，除了一个，** 其中行包含 NULL 值**

> ID：12391808
> 
> 赞同：3
> 
> 时间：2012-09-12T15:39:11.067
> 
> 标签：mysql, null, duplicates

这个问题类似于但不同于其他涉及在 MySQL 中删除重复行的 SO 问题。

在一个或多个列包含 NULL 值的情况下，参考问题（如下）中选择的解决方案失败。我在下面的 sqlfiddle 中包含了模式以及两个选择的答案，以说明以前的解决方案在哪里不起作用。

**源架构：**

```
CREATE TABLE IF NOT EXISTS `deldup` (
  `or_id` int(11) NOT NULL AUTO_INCREMENT,
  `order_id` varchar(5) NOT NULL,
  `txt_value` varchar(20) NOT NULL,
  `date_of_revision` date NOT NULL,
  `status` int(3) DEFAULT NULL,
  PRIMARY KEY (`or_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=16 ;

INSERT INTO `deldup` (`or_id`, `order_id`, `txt_value`, `date_of_revision`, `status`) VALUES
(1, '10001', 'ABC', '2003-03-06', NULL),
(2, '10001', 'RFE', '2003-03-11', NULL),
(3, '10002', 'ASE', '2009-08-05', NULL),
(4, '10003', 'PEF', '2001-11-03', NULL),
(5, '10004', 'OIU', '1999-10-29', NULL),
(6, '10005', 'FOO', '2002-03-01', NULL),
(7, '10006', 'RTY', '2005-08-19', NULL),
(8, '10001', 'NND', '2003-03-20', NULL),
(9, '10005', 'VBN', '2002-02-19', NULL),
(10, '10002', 'AAQ', '2009-08-13', NULL),
(11, '10002', 'EEW', '2009-08-07', NULL),
(12, '10001', 'ABC', '2003-03-06', 3),
(13, '10001', 'ABC', '2003-03-06', 3),
(14, '10001', 'ABC', '2003-03-06', NULL),
(15, '10001', 'ABC', '2003-03-06', NULL); 
```

**解决方案示例 1：**

[http://sqlfiddle.com/#!2/983f3/1](http://sqlfiddle.com/#!2/983f3/1)

```
create temporary table tmpTable (or_id int);

insert  tmpTable
        (or_id)
select  or_id
from    deldup yt
where   exists
        (
        select  *
        from    deldup yt2
        where   yt2.txt_value = yt.txt_value

                and yt2.order_id = yt.order_id
                and yt2.date_of_revision = yt.date_of_revision
                and yt2.status = yt.status
                and yt2.or_id > yt.or_id
        );

delete  
from    deldup
where   or_id in (select or_id from tmpTable); 
```

请注意，包含非空行值的行已成功删除，但未删除包含空值的行（请参阅生成的 SELECT 查询中的第 14 行和第 15 行）。

* * *

**解决方案示例 2：**

[http://sqlfiddle.com/#!2/8a4f8/1](http://sqlfiddle.com/#!2/8a4f8/1)

```
DELETE 
    n1 
FROM 
    deldup n1, 
    deldup n2 
WHERE 
    n1.or_id                < n2.or_id AND 
    n1.order_id             = n2.order_id AND 
    n1.txt_value            = n2.txt_value AND 
    n1.date_of_revision     = n2.date_of_revision AND
    n1.status               = n2.status 
```

此解决方案涉及的代码更少，工作方式与示例 1 相同，包括排除包含空值的行。

* * *

如何删除其中一个列值包含 NULL 值的重复行？

* * *

**参考：**

[删除 MySQL 中除 One 之外的所有重复行？](https://stackoverflow.com/questions/4685173/delete-all-duplicate-rows-except-for-one-in-mysql)

[删除 MySQL 中的重复行](https://stackoverflow.com/questions/3311903/remove-duplicate-rows-in-mysql)

[如何从 mysql 数据库中删除重复的条目？](https://stackoverflow.com/questions/2867530/how-to-remove-duplicate-entries-from-a-mysql-db)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:43:01.843

如何简单地调整第二个解决方案，如下[所示](http://sqlfiddle.com/#!2/302f2/1)：

```
WHERE
  ...
  (n1.status IS NULL AND n2.status IS NULL 
   OR n1.status = n2.status) 
```

我假设您仅在所有值都重复时才认为该记录是重复的。

# php - 用关系检查其他表中的状态

> ID：12391811
> 
> 赞同：1
> 
> 时间：2012-09-12T15:39:30.450
> 
> 标签：php, mysql, sql, symfony1, doctrine

我在数据库中有：

```
User:
id | name
1  | one
2  | two
3  | three
4  | four
5  | five

House:
id | name
1  | London
2  | Barcelona

UserHouse:
id_user | id_house
 1      |  1
 2      |  2
 4      |  1 
```

我如何在 SQL 查询中使用 IF 和 ISSET？

**从用户中选择 ***

我想收到：

用户：

```
name | has_house
1    | yes
2    | yes
3    | no
4    | yes
5    | no 
```

**我必须从SELECT * from User**开始我的查询。我不能在 House 或 UserHouse 中加注星标。有可能吗？如果是，如何？

我也可以使用 DOCTRINE 和 Symfony。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:42:47.360

尝试使用`LEFT JOIN`

```
SELECT  a.id, IF(COALESCE(b.id_user, 1) = 1, 'no', 'yes') has_house
FROM    user a
        LEFT JOIN userhouse b
            on a.id = b.id_user 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:56:30.993

如果您真的只能使用**SELECT * from User**开始查询，您可以试试这个：

```
SELECT * FROM User
  JOIN (
    SELECT
      User.id id_user,
      IF(UserHouse.id_house > 0, 'yes', 'no') AS has_house
    FROM
        User
      LEFT JOIN
        UserHouse ON UserHouse.id_user = User.id
    ) HasHouse ON HasHouse.id_user = User.id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T15:57:07.023

如果您使用的是 sql server，则应该使用 case one 而不是 if 语句。

```
SELECT   user.id, 'Has House' =
  CASE COALESCE(b.id_user, 0)
     WHEN 0 THEN 'No'
     ELSE 'Yes'
  END
FROM user as u leftjoin userhouse as uh on u.id = uh.id_user 
```

[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T16:38:50.357

可能这会有所帮助，

[http://msdn.microsoft.com/en-us/library/ms182717.aspx](http://msdn.microsoft.com/en-us/library/ms182717.aspx)

# php - ajax 长轮询在页面刷新时崩溃\链接到另一个页面

> ID：12391813
> 
> 赞同：0
> 
> 时间：2012-09-12T15:39:37.270
> 
> 标签：php, jquery, ajax

我已经在这里发布了一个类似的问题，但没有得到可以解决我的问题的回复，而且问题也发生了一些变化，所以我重新发布并迫切希望获得一些帮助！

链接到上一个问题：

[使用 mysql 进行 ajax 长轮询](https://stackoverflow.com/questions/12369477/ajax-long-polling-with-mysql)

当前代码：

JS（我从 php 运行它）：

```
$oldIDq = mysql_query("SELECT * FROM messages ORDER BY id DESC LIMIT 1");
while($oldrow = mysql_fetch_array($oldIDq)){
$oldID = $oldrow['id'];    
}

$func = '
var oldID = '.$oldID.';

function wait() {
$.ajax({
    type: "GET",
    url: "../scripts/msg_scripts/msg.php?oldid=" + oldID,
    async: true,
    cache: false,

    success: function (data){

        if(data != \'1\'){
            var json = eval(\'(\' + data + \')\');
             if (json[\'msg_content\'] != "") {
                  alert("new meassage added"); 
                  } 
                  oldID = json[\'oldID\']; 
                  setTimeout(\'wait()\',1000); }

    },

    disconnect: function()
    {
        return false;
        setTimeout(\'wait()\',1000);
    },

    error: function(XMLHttpRequest, textStatus, errorThrown){
      alert("error: " + textStatus + "(" + errorThrown + ")");  
      setTimeout(\'wait()\',1000);
    }

});
}

$(document).ready(function(){

    wait();
});
'; 
```

服务器：

```
 $connect = mysql_connect ("localhost", "root", "")

or die ("couldnt connect");
mysql_select_db ("***") or die ("not found"); //if db was not found die
mysql_query("SET NAMES 'utf8'");

$oldID = $_GET['oldid']; 

if($oldID == "") {

die('timeout');
}
else{

$result = mysql_query("SELECT id FROM messages ORDER BY id DESC LIMIT 1");
while($row = mysql_fetch_array($result))
{
    $last_msg_id = $row['id']; 
}
while($last_msg_id <= $oldID)
{
    usleep(10000);
    clearstatcache();
    $result = mysql_query("SELECT id FROM messages ORDER BY id DESC LIMIT 1");
    while($row = mysql_fetch_array($result))
    {
        $last_msg_id = $row['id'];
    }
}

$response = array();
$response['msg_content'] = 'new';
$response['oldID'] = $last_msg_id;
echo json_encode($response);
} 
```

现在，我在进程的服务器端运行了一个会话，我暂时将其删除，因为我知道长轮询对会话有问题我也有会话在发送 ajax 请求的页面上运行，因为我删除了会话我的问题在某种程度上有所改善，现在发生的情况是我基本上可以点击我网站上的链接并退出页面并出现错误，但如果我这样做超过 4-5 次，浏览器会冻结每次点击在任何链接上只是重新运行 ajax 函数，我得到一个不同的错误。如果我刷新请求的页面，我会立即收到第二个错误并且浏览器冻结。如果这是有用的信息，如果我关闭浏览器并尝试重新打开我网站的任何页面，除非我重新运行我的服务器（现在在本地主机上工作），否则它根本不会加载，也用 chrome 和 ff 尝试过。

有人可以指出我的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:04:50.393

-- 再次更新以检索所有新消息

阅读您的代码，您只希望返回最后一条消息，如果是这样，那么在这种情况下，while 循环非常无用。请记住，在 oldID 和插入到您的数据库中的最后一个 ID 之间可能有更多“新”消息，您会跳过这些消息，我提供的这段代码也是如此

```
$connect = mysql_connect ("localhost", "root", "")
or die ("couldnt connect");
mysql_select_db ("***") or die ("not found"); //if db was not found die
mysql_query("SET NAMES 'utf8'");

$oldID = trim($_GET['oldid']);

// empty response, you may fill it with a default msg
$response = array(
  'msg_content' => 'none',
  'oldID' => $oldID
);

// this if statement will prevent to return a valid 
// JSON string to the ajax request
if(empty($oldID)) {
 die('timeout');
}
else {
  $result = mysql_query("SELECT id FROM messages WHERE id > ".addslashes($oldID)." ORDER BY id DESC");
  $index = 1;
  // check if results have new messages
  if(($num_rows = mysql_num_rows($result) > 0) {
    $response['msg_content'] = 'new';
    while($row = mysql_fetch_array($result)) {
      $response['new_msgs'][] = $row['id']
      if($index == $num_rows)
        $response['oldID'] = $row['id']; // set oldID to last record
  }
}
echo json_encode($response); 
```

--

关于如何正确使用[session_write_close](http://php.net/manual/en/function.session-write-close.php)的评论。

```
session_start(); 
  $var_id = $_SESSION['id']; 
  $var_fn = $_SESSION['firstname']; 
  $var_ln = $_SESSION['lastname']; 
  $var_mail = $_SESSION['email']; 
// close write to session here to release it for other sources 
session_write_close();

if (!loggedin()){
  header ("Location: index.php");} 
  if ($_GET['id']) {
    $id = mysql_real_escape_string($_GET['id']);} 
  // you are using session here, use the localized $var_id
  else if (isset($var_id)) {
    $id = mysql_real_escape_string($var_id);
} 
```

当`session_start()`被调用时，该点的会话被锁定以写入任何其他源，除了它所在的当前范围（.php 执行文件）。这是为了确保在读取会话值期间不能更改任何值。

从[文档](http://php.net/manual/en/function.session-write-close.php)

> 会话数据通常在脚本终止后存储，无需调用 session_write_close()，但由于会话数据被锁定以防止并发写入，任何时候只有一个脚本可以对会话进行操作。将框架集与会话一起使用时，由于这种锁定，您将体验到一个一个加载的框架。您可以通过在会话变量的所有更改完成后立即结束会话来减少加载所有帧所需的时间。

对于**卡住**的问题，我认为while循环是无止境的，从浏览器请求页面`http://example.com/pathto/scripts/msg_scripts/msg.php`，看看会发生什么

```
$counter = 0;
while($last_msg_id <= $oldID)
{
    usleep(10); // changing to be a bit faster
    clearstatcache();
    $result = mysql_query("SELECT id FROM messages ORDER BY id DESC LIMIT 1");
    $row = mysql_fetch_array($result);
    $last_msg_id = $row['id'];
    $counter++;

    if($counter > 100)
      break;
}
echo "counted: {$counter}";
exit(); 
```

# c++ - 如何从 STL 容器实例中获取元素类型？

> ID：12391814
> 
> 赞同：17
> 
> 时间：2012-09-12T15:39:42.503
> 
> 标签：c++, stl, c++11, decltype

我知道 value_type、key_type ......但它们对类型而不是实例进行操作。我尝试了类似的东西：

```
std::set<uint64_t> mySet;   

decltype (mySet)::value_type pos; 
```

但它不起作用。

编辑：我使用 VS 2010。

EDIT2：这段代码的目的是获得一种类型，将其赋予 boost::lexical_cast<> 是否有一种解决方法可以实现这一点？我想要这样的东西：

```
 mySet.insert(boost::lexical_cast<decltype(mySet)::value_type>(*it));
  // it is a iterator in vector of strings 
```

EDIT3：这有效：

```
mySet.insert(boost::lexical_cast<decltype(mySet)::value_type>(*it)); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-12T15:43:24.087

`decltype (mySet)::value_type`是正确的。确保在编译器中启用了 C++11 模式。如果你有，那么这是一个编译器错误。

一种可能的解决方法涉及使用身份元功能：

```
template <typename T>
struct identity { typedef T type; };

identity<decltype(mySet)>::type::value_type pos; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-12T16:13:55.333

我会反过来做：

```
typedef std::set<uint_least64_t> set_type;
set_type mySet;
set_type::value_type pos; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-02T15:38:17.743

结合其他答案：

```
template<typename TVariant, typename Tfind>
struct is_variant_of {
    template<typename T1, typename T2> struct var_unfold : public std::false_type {};
    template<typename T1, typename... Tlist> struct var_unfold<T1, std::variant<Tlist...>> 
    { constexpr static bool value = (std::is_same_v<T1, Tlist> || ...); };

    constexpr static bool value = var_unfold<Tfind, TVariant>::value;
};

main() {
    using TV = std::variant<int, double>;
    static_assert(is_variant_of<TV, int>::value);
} 
```

*   `template struct var_unfold{}``std::variant<Ts...>`通过偏特化匹配
*   `std::is_same_v`与 c++17 折叠表达式一起使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-31T15:21:10.873

这是打印优先级队列元素的打印方法的简单示例：

```
template<typename T> void print_queue(T& queue) {
    while (!queue.empty()) {
        std::cout << queue.top() << " ";
        queue.pop();
    }
    std::cout << '\n';
} 
```

问题是，在打印完所有元素后，队列是空的。为了将队列恢复到原始状态，我们添加了向量容器。从队列中推导出队列元素的类型：

```
template<typename T> void print_queue(T& queue) {
    std::vector<T::value_type> vec;
    while (!queue.empty()) {
        std::cout << queue.top() << " ";
        vec.push_back(queue.top());
        queue.pop();
    }
    std::cout << '\n';
    for (auto & v : vec) {
        queue.push(v);
    }
} 
```

# java - 从eclipse自动部署文件到tomcat

> ID：12391816
> 
> 赞同：0
> 
> 时间：2012-09-12T15:39:50.267
> 
> 标签：java, eclipse, tomcat

我有一个可以通过`myvm.com`我的 tomcat 位置访问的 VPS，我可以通过以下`C:\tomcat\` 方式访问我的 tomcate/WebApps 文件夹中的 Web 应用程序`http://myvm.com`

现在我有一个 java 项目`C:\MyProject`。我已将我的项目导入 Eclipse。现在我想在 C:\MyProject 中编辑一些文件后，它应该自动将其部署到 C:\tomcat 以便我可以通过[http://myvm.com浏览它](http://myvm.com)

怎么做？请一些详细的步骤我对这个系统很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:44:03.973

这可能会对您有所帮助： [tuto eclipse tomcat](http://www.coreservlets.com/Apache-Tomcat-Tutorial/tomcat-7-with-eclipse.html "tuto eclipse tomcat")

如果您在 Eclipse 安装中声明您的 tomcat 安装（在 C:\tomcat 中），您应该能够在其中自动发布或至少使用“重新部署”命令

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:04:01.967

您可以使用[Sysdeo Tomcat 插件](http://www.eclipsetotale.com/tomcatPlugin.html)来让您的 tomcat 更新您的 java 项目的最新更改。

jvm 不支持某些类型的热替换代码，但您可以使用[DCEVM](http://ssw.jku.at/dcevm/)来超越它们：

> 动态代码演进虚拟机 (DCE VM) 是对 Java HotSpot(TM) VM 的修改，它允许在运行时无限制地重新定义加载的类。HotSpot(TM) VM 的当前热交换机制只允许更改方法体。我们增强的 VM 允许添加和删除字段和方法以及更改类的超类型。

# php - 如何在magento时事通讯订阅中添加名字和姓氏？

> ID：12391817
> 
> 赞同：1
> 
> 时间：2012-09-12T15:39:51.427
> 
> 标签：php, magento, subscription, newsletter

我是 magento 的新手。Magento 默认只有电子邮件 ID 用于订阅时事通讯。如何在时事通讯订阅中添加名字和姓氏？看了很多教程。但他们不是很清楚。帮我看看这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-19T16:47:19.910

有一个免费的扩展，它添加了性别、名字和姓氏字段，并使其在后端网格中可用，以便通过 xml/csv 导出：http: [//www.magentocommerce.com/magento-connect/extended-newsletter-subscription- for-guests.html](http://www.magentocommerce.com/magento-connect/extended-newsletter-subscription-for-guests.html)

您可以同时使用函数变量`{{var subscriber.getSubscriberFirstname()}}`和`{{var subscriber.getSubscriberLastname()}}`电子邮件模板。

如果用户登录，它将使用在扩展订阅表单中输入的客人姓名或客户姓名。唯一的事情是，如果用户登录并使用**另一个**电子邮件地址填写扩展订阅表单，而不是他的电子邮件地址已注册，这两个变量将不返回任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:53:02.990

转到系统 > 交易电子邮件 > 选择一种布局进行编辑。使用这个变量：

```
 {{var customer.lastname}} 
```

查看更多信息：[http ://www.mesmerlab.com/create-new-email-template-magento/](http://www.mesmerlab.com/create-new-email-template-magento/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T18:10:58.410

问题是在 newsletter_subscriber 表中没有名字或姓氏的列。

这已在此问题的答案中得到解决：

[向 Magento 的订阅模块添加自定义字段](https://stackoverflow.com/questions/3155784/adding-a-custom-field-to-magentos-subscribtion-module/6425683#6425683)

# java - 在 play 2 框架中将下拉列表项添加到 json 对象

> ID：12391822
> 
> 赞同：0
> 
> 时间：2012-09-12T15:40:08.720
> 
> 标签：java, javascript, jquery, html, playframework

我有一个带有 java 的 play 2 框架项目。在视图文件中，有一个由控制器类中的方法填充的下拉列表。除了下拉列表，我还有一个 json 数据结构，它由视图文件中的 javascript 方法和事件侦听器填充。现在我想要一种将下拉列表中的选定项目添加到 json 对象的方法。我提供了下面的代码片段。

这是下拉列表的代码：

```
 <select class = "selectone">
  @for(gesture <- gesturesList){
      <option value = @gesture.id>
        @gesture.getName()
      </option>
  } 
  </select> 
```

我有以下来自 javascript 和 json 对象的代码片段

```
 <script type="text/javascript" charset="utf-8">

     /* this is our websocket connection */       
var WS = window['MozWebSocket'] ? MozWebSocket : WebSocket
var socket = new WS("@routes.Application.webSocket().webSocketURL(request)")

/* this is the json object , it contains x and y coordinates from HTML5 canvas */              
          var jNode =  {"x":arrayX,"y":arrayY }  

 /* this is a jquery function for tranmitting  json object through the websocket */                        

        $('button.add').click(function() { 
             socket.send(JSON.stringify(jNode));})                                 
     </script>       
} 
```

有人可以告诉我如何将下拉列表中选择的项目添加到 json 对象中，以便我们在 json 对象中有如下内容：

var jNode = {"x":arrayX,"y":arrayY , "item" : Itemselected}

谢谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:25:21.833

你应该意识到这是一个 JS+HTML 的话题，所以显示 Play 的视图对 JS 极客来说毫无意义......

无论如何，当您使用 jQuery 时，也可以使用它来获取`val()`. 顺便说一句，请记住它应该放在某个事件中（即：）`click()`，否则它将复制页面加载后设置的值并且不会更改它）：

```
 <select class = "selectone">
     <option value="0">Choose</option>
     <option value="1">Gest 1</option>
     <option value="2">Gest 2</option>
     <option value="3">Gest 3</option>
 </select>

 <script type="text/javascript" charset="utf-8">
      // ...
    $('button.add').click(function() { 
        var jNode = {"x":arrayX,"y":arrayY , "item" : $("select.selectone").val()};
        socket.send(JSON.stringify(jNode));
    });
      // ...                                 
 </script> 
```

来自[val() API](http://api.jquery.com/val/)：

```
$('select.foo option:selected').val();    // get the value from a dropdown select
$('select.foo').val();                    // get the value from a dropdown select even easier 
```

# python - Python：创建 SVG

> ID：12391826
> 
> 赞同：-3
> 
> 时间：2012-09-12T15:40:12.123
> 
> 标签：python, svg

我想要的是创建一些电气符号（晶体管、电容器、二极管......），而不是像拼图元素一样使用它们来创建电气方案图并将其保存为一个 SVG 文件。

我的想法是

*   使用某种 SVG 方案（如 XML 方案）从基本形状中创建复杂的电气符号：线条、圆形、方形......
*   使用这些符号的实例和坐标（我在 Python 中加载）将它们放在最终电气方案中的正确位置
*   将其另存为 .SVG

最好的方法是什么？（SVGFig 看起来可以，但我找不到类似的例子）示例将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:46:33.457

嗯，不确定它是否对您有帮助，但有一个程序，称为 Dia diagram editor，用于绘制 SVG 并配备 Python 命令行。不过，它非常有问题，但至少它内部有一组很好的电气符号并且可以与 SVG 一起使用。祝你好运！

这里有些例子：

[https://mail.gnome.org/archives/dia-list/2010-August/msg00014.html](https://mail.gnome.org/archives/dia-list/2010-August/msg00014.html)

[https://live.gnome.org/Dia/Python](https://live.gnome.org/Dia/Python)

# iphone - 在 Objective-C 中读取 powerpoint pptx 文件

> ID：12391829
> 
> 赞同：3
> 
> 时间：2012-09-12T15:40:22.097
> 
> 标签：iphone, ios, powerpoint, openxml

我被要求找到一种方法来使用 pptx 作为在 iPhone 上使用 cocos2D 的游戏的输入。据我所知，pptx 文件使用 Office Open XML 标准，应该是完全可读的，包括任何编程语言的动画信息。

但是，我只找到使用 docx 文件的示例/教程，我想知道 pptx 文件是否存在此类文档。

我只是在那个主题上花了两天时间，我就是找不到精力去深入研究 Microsoft 文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T03:23:55.887

.pptx 文件只是一个包含一些图像文件和 XML 文件的 ZIP 文件。Wouter van Vugt 的[免费电子书](http://www.freetechbooks.com/open-xml-the-markup-explained-t666.html)将帮助您理解 XML。不幸的是，这些文件包含很多样板文件，因此可能需要一些时间才能找到您感兴趣的部分。

# android - 无法使用 CLEAR_TOP 标志启动市场活动

> ID：12391836
> 
> 赞同：1
> 
> 时间：2012-09-12T15:40:42.823
> 
> 标签：android

考虑这个提示用户对市场上的应用程序进行评分的代码片段：

```
private void backToMainActivity() {
    Intent i = new Intent(mActivity, MainActivity.class);
    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    mActivity.startActivity(i);

    mActivity.finish();
}

...

if (mRateToast.leftClicked(x, y)) {
    setRate(true);

    Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=" + GameGlobals.PACKAGE_NAME));
    i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET | Intent.FLAG_ACTIVITY_NEW_TASK);
    mActivity.startActivity(i);

    backToMainActivity();
} else if (mRateToast.rightClicked(x, y)) {
    setRate(false);
    backToMainActivity();
} 
```

它的作用是检测按下了哪个按钮（速率或稍后），相应地设置一个标志并在需要时运行市场应用程序。无论按下哪个按钮，我都想返回主菜单（这是一个游戏活动，距离主菜单活动1个活动）。

在 Android 4.1 上，这工作正常 - 市场打开到应用程序的页面，从市场返回时，我在主菜单上。在android <= 2.3上，市场没有打开，我只是直接返回主菜单。但是，如果我`i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);`在`backToMainActivity`方法中注释它，它会打开。但是，这会导致其他问题，例如返回按钮返回错误的活动而不是退出应用程序，因此不是解决方案。

如何运行市场，返回主菜单并使主菜单活动位于活动堆栈的顶部？

**注意：**我还没有尝试过，但删除它`finish`也不是一个真正的选择。我的游戏活动也可以由外部应用程序直接启动，在这种情况下，如果我取消`finish`调用，由于某种原因`CLEAR_TOP`将无法正常工作，并且按主菜单活动上的后退按钮将返回游戏活动而不是退出应用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:50:34.210

试试这个

```
Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=" + GameGlobals.PACKAGE_NAME));
i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET | Intent.FLAG_ACTIVITY_NEW_TASK);
mActivity.startActivityForResult(i,1552); 
```

* * *

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if(requestCode==1552){
        backToMainActivity();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:06:23.697

我通过删除`Intent.FLAG_ACTIVITY_NEW_TASK`和使用[MoshErsan](https://stackoverflow.com/users/737925/moshersan)在他的回答`startActivityForResult`中描述的方法解决了这个问题。显然，在 android <= 2.3中将市场作为一项新任务启动并不好。`CLEAR_TOP`

如果有人可以解释为什么最初的方法不起作用或提供更好的解决方案，我会在一两天内接受这个答案，如果不是，我会接受我的。

# javascript - onclick 样式整个 li - 不想要

> ID：12391838
> 
> 赞同：1
> 
> 时间：2012-09-12T15:40:55.840
> 
> 标签：javascript, css

我刚进入这个项目，代码已经写好了，但是我们发现了一个问题。当您单击菜单中的任何位置时，它会将整个东西变成金色，您看不到菜单该部分中的任何链接。您可以再次单击它，它将恢复正常状态。这只发生在 Internet Explorer 9 和 Chrome 中，在 Firefox 中没有问题。底部的链接提供了一张图片，以便您查看问题。

我们在网站的移动版和 IE8 版本的 LI 上有一个 onclick，因此它们也有一个不错的下拉菜单。

当我删除 onclick 时，它会解决问题，但也会阻止移动和 IE8 用户的下拉菜单。

这是我认为与此问题有关的代码：HTML：

```
<li id="prospective" class="rightborder" onclick="javascript:showElement('prospective-links')">Future Students
<ul id="prospective-links">
<li><a href="/admissions">Undergraduate Admissions</a></li><li><a href="/morelinks">More  Links</a></li></ul> 
```

JS

```
function showHide() {
var s=document.getElementById("buttonbar").style;
if ($(window).width() > 949) {
s.display = "block";
document.getElementById("prospective-links").style.display = "block";
document.getElementById("current-links").style.display = "block";
document.getElementById("academic-links").style.display = "block";
document.getElementById("facstaff-links").style.display = "block";
document.getElementById("parent-links").style.display = "block";
document.getElementById("alumni-links").style.display = "block";
document.getElementById("visitor-links").style.display = "block";
$("#accordion").accordion('destroy');
$("#buttonbar").unbind('mouseenter');
$("#buttonbar").unbind('mouseleave');
$.fn.pause=function(a){$(this).stop().animate({dummy:1},a);return this};
function mouseleft(){$("#buttonbar").triggerHandler("mouseleave")}
$(document).ready(function()
{$("#buttonbar").mouseenter(function()      {$(this).stop().pause(160).animate({height:"12.7em"},400,"easeOutQuart")}).mouseleave(function(){$(this).stop().pause(160).animate({height:"2.2em"},400,"easeOutQuart")});});$(function(){$("#accordion").accordion({fillSpace:!0,icons:{header:"accordion-header",headerSelected:"accordion-headerselected"}})});
if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i)) ||     (navigator.userAgent.match(/iPad/i))) {
$("#buttonbar li").bind('touchstart', function(){
console.log("touch started");
});
$("#buttonbar li").bind('touchend', function(){
console.log("touch ended");
});
}

}
else {
/*$("#accordion").accordion({active:false});*/
$("#accordion").accordion('destroy');
$("#buttonbar").unbind('mouseenter');
$("#buttonbar").unbind('mouseleave');
$("#buttonbar li").unbind('touchstart');
$("#buttonbar li").unbind('touchend');

s.display = "none";
document.getElementById("prospective-links").style.display = "none";
document.getElementById("current-links").style.display = "none";
document.getElementById("academic-links").style.display = "none";
document.getElementById("facstaff-links").style.display = "none";
document.getElementById("parent-links").style.display = "none";
document.getElementById("alumni-links").style.display = "none";
document.getElementById("visitor-links").style.display = "none";
/*$("#buttonbar").accordion('destroy');*/
}
} 
else { function showElement(d){ var s=document.getElementById(d).style; 
if (s.display != "block" ) { s.display = "block"; } else { s.display = "none"; } }; 
```

和CSS：

```
#prospective-links li,
#current-links li,
#academic-links li,
#facstaff-links li,
#parent-links li,
#alumni-links li,
#visitor-links li {
   width: 80%;}
prospective-links,
current-links,
academic-links,
facstaff-links,
parent-links,
alumni-links,
visitor-links {
display: none;
} 
```

[菜单问题](http://www.cameron.edu/uploads/35/9a/359adc97a384dd7e2350a6aa4ef0af65/menubar.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:29:00.893

我将用你提供的有限信息来试一试。

所以图片中“未来学生”下面的部分就是你所说的。你点击它，它就像图像一样“变成金色”。

实际上发生的事情是你点击它然后它就消失了。根据您调用的函数，这是正确的行为。它正在显示，所以现在它隐藏了它。顺便说一句，`showElement`这个函数的名字很糟糕，因为这不是它正在做的事情，但你继承了它，所以你可能无法控制它。类似的东西`toggleElement`会更好。

```
function showElement(d){ 
    var s=document.getElementById(d).style; 
    if (s.display != "block" ) { 
        s.display = "block"; 
    } else { 
        s.display = "none"; 
    } 
} 
```

我的猜测是，在移动设备和 ie8 中，这些子菜单一开始是隐藏的，所以这个功能做了它应该做的事情，即在第一次点击时显示子菜单，然后在再次点击时隐藏它。尽管您在此处显示的功能表明宽度小于 949 像素的任何窗口都应该发生这种情况`$(window).width() > 949`

到目前为止，这是我能做的最好的事情。

# ruby-on-rails - Dojo + Rails 3.2.8 + CoffeeScript

> ID：12391840
> 
> 赞同：2
> 
> 时间：2012-09-12T15:40:59.823
> 
> 标签：ruby-on-rails, dojo, coffeescript

我正在尝试在 Rails 3.2.8 Web 应用程序中使用 Dojo Toolkit 1.8 而不是 JQuery，主要是因为缺少基于 JQuery 的完整且视觉上统一的小部件。遵循以下步骤：

*   将 dojo、dijit 和 dojox 目录解压到 app/assets/javascripts
*   在 application.js 中更改`//= require_tree .`为`//= require_directory .`
*   编辑的应用程序布局（还不是不引人注目......只是为了测试效果）

视图/布局/application.html.erb

```
<!DOCTYPE html>
<html>
<head>
  <title>Dojo</title>
  <%= stylesheet_link_tag 'application' %>
  <%= javascript_include_tag 'application' %>
  <%= stylesheet_link_tag '/assets/dijit/themes/claro/claro.css' %>
  <%= javascript_include_tag "dojo/dojo", :'data-dojo-config' => 'async: true' %>
  <%= csrf_meta_tags %>
</head>
<body class='claro'>
  <%= yield %>
  <script>
    require(["dojo/parser", "dojo/ready"], function(parser, ready) {
      ready(function() {
        parser.parse();
      });
    });
  </script>
</body>
</html> 
```

*   为 index 操作创建了一个名为 home 的控制器和一个模板

意见/主页/index.html.erb

```
<input type="text" required="true" name="bday" id="bday" data-dojo-type="dijit/form/DateTextBox" value=<%= localize(Date.today - 21.days) %> />
<button id="button1" type="button" data-dojo-type="dijit/form/Button">Button 1</button> 
```

好的，Dijit 很好用！但是，当我尝试将一些 dojo 代码放入 CoffeeScript 文件 (assets/javascripts/home.js.coffee) 时，Firebug 控制台上会出现**“ReferenceError: require is not defined”**错误消息。示例代码：

```
require ["dojo/domReady!"], () ->
  alert('ok') 
```

如果我`//= require dojo/dojo`在上面的代码之前加上 a，它会运行，但会加载所有 dojo 模块（不仅仅是 domReady），并且在 Firebug 上引发“错误：defineAlreadyDefined”。

有什么方法可以调用 require 函数而无需重新加载整个 dojo.js 甚至访问 dojo 全局变量？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:14:48.147

这是我的失误，我交换了 javascripts 包含顺序。正确的是：

```
 <%= stylesheet_link_tag '/assets/dijit/themes/claro/claro.css' %>
  <%= javascript_include_tag "dojo/dojo", :'data-dojo-config' => 'async: true' %>
  <%= stylesheet_link_tag 'application' %>
  <%= javascript_include_tag 'application' %> 
```

当我尝试在咖啡脚本文件中使用模块时，尚未加载 Dojo。

感谢您的关注。

# c++ - 将 C++ 函数指针传递给 Fortran 子例程

> ID：12391841
> 
> 赞同：1
> 
> 时间：2012-09-12T15:40:59.910
> 
> 标签：c++, arrays, pointers, parameters, fortran

我一直在尝试调试这个调用 Fortran 子例程 DLSODE 的代码。这个子例程的两个参数是函数，FEX 和 JEX，我将它们作为函数指针传递。据我了解，fortran 子例程使用的任何函数都必须具有按引用调用的参数，因为 fortran 不接受按值调用。

我的问题是我得到的错误似乎表明我在指针的函数声明中声明的数据类型与下面的函数定义之间存在差异，并且我没有成功调试它。

```
#include <iostream>
#include <cmath>
using namespace std;

extern"C" {void DLSODE_(void (*fex)(int, double, double[], double[]), int *NEQ,
                        double *Y[], double *T, double *TOUT, int *ITOL,
                        double *RTOL, double *ATOL[], int *ITASK, int *ISTATE,
                        int *IOPT, double *RWORK[], int *LRW, int *IWORK[],
                        int *LIW, void (*jex)(int, double, double[], int, 
                                              int, double [3][3], int), 
                        int *MF);
}    

void FEX (int &NEQ, double &T, double Y[], int YDOT[]);

void JEX (int &NEQ, double &T, double Y[], int &ML, int &MU, double PD[3][3], 
          int &NRPD);

int main(){

    int IOPT, IOUT, ISTATE, ITASK, ITOL, IWORK[23], LIW, LRW, MF, NEQ, ICOUNT=1;
    double ATOL[3], RTOL, RWORK[58], T, TOUT, Y[3];
    NEQ = 3;
    Y[0] = 1;
    Y[1] = 0;
    Y[2] = 0;
    T = 0;
    TOUT = 0.4;
    ITOL = 2;
    RTOL = pow(10,-4);
    ATOL[0] = pow(10,-6);
    ATOL[1] = pow(10,-10);
    ATOL[2] = pow(10,-6);
    ITASK = 1;
    ISTATE = 1;
    IOPT = 0;
    LRW = 58;
    LIW = 23;
    MF = 21;

    for (ICOUNT; ICOUNT <13; ICOUNT++)
    {
        DLSODE_(&FEX, &NEQ, &Y, &T, &TOUT, &ITOL, &RTOL, &ATOL, &ITASK, &ISTATE, 
                &IOPT, &RWORK, &LRW, &IWORK, &LIW, &JEX, &MF);
        cout<<"At t= "<<T<<" y= "<<Y[1]<<" "<<Y[2]<<" "<<Y[3]<<"\n";
    }
}

void FEX (int &NEQ, double &T, double Y[], double YDOT[]){
    YDOT[0] = -.04*Y[0] + pow(10,4)*Y[1]*Y[2];
    YDOT[2] = 3*pow(10,7)*Y[1]*Y[1];
    YDOT[1] = -YDOT[0] - YDOT[2];
}

void JEX (int &NEQ, double &T, double Y[], int &ML, int &MU, double &PD[3][3], 
          int &NRPD){
    PD[0][0] = -.04;
    PD[0][1] = 1*pow(10,4)*Y[2];
    PD[0][2] = 1*pow(10,4)*Y[1];
    PD[1][0] = .04;
    PD[1][2] = -PD[0][2];
    PD[2][1] = 6*pow(10,7)*Y[1];
    PD[1][1] = -PD[0][1] - PD[2][1];
} 
```

错误消息是

```
 cversion1.cpp: In function ‘int main()’:
 cversion1.cpp:44:52: error: invalid conversion from ‘void (*)(int&, double&, double*, int*)’ to ‘void (*)(int, double, double*, double*)’
 cversion1.cpp:44:52: error: cannot convert ‘double (*)[3]’ to ‘double**’ for argument ‘3’ to ‘void DLSODE_(void (*)(int, double, double*, double*), int*, double**, double*, double*, int*, double*, double**, int*, int*, int*, double**, int*, int**, int*, void (*)(int, double, double*, int, int, double (*)[3], int), int*)’
 cversion1.cpp: At global scope:
 cversion1.cpp:55:77: error: declaration of ‘PD’ as array of references
 cversion1.cpp:55:78: error: expected ‘)’ before ‘,’ token
 cversion1.cpp:56:4: error: expected unqualified-id before ‘int’ 
```

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T03:43:34.530

将 C 或 C++ 与 Fortran 接口的现代方法是使用 Fortran ISO C 绑定。这提供了接口 Fortran 和 C（以及通过'extern "C"' 的 C++）的方法，它是 Fortran 语言标准的一部分，因此是编译器和平台独立的。不再需要诸如“Fortran 通过引用传递”之类的语句以及 Fortran 编译器附加下划线（在另一个答案中链接的网页中制作）。程序员可以指定与 C 兼容的调用约定和准确的名称。这是如果您被允许修改 Fortran 代码。或者，您可以在 C/C++ 例程和原始 Fortran 例程之间用 Fortran 编写粘合例程。Stackoverflow 上有很多关于 ISO C 绑定的问题/答案。gfortran 手册中有示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T16:19:06.343

```
void (*fex)(int, double, double[], double[]) 
```

不匹配

```
void FEX (int &NEQ, double &T, double Y[], double YDOT[]) 
```

您已将参数 3 声明`DLSODE`为`double *Y[]`，一个指向 的指针数组`double`，但这应该只是`double Y[]`。你传入`&Y`，并被`Y`声明为`double Y[3]`，但你应该传入`Y`。

在您的`JEX`声明中，您有`double &PD[3][3]`，但您只想`double PD[3][3]`在这里。

您应该将计算表达`3*pow(10,7)`为`30000000`或`3E7`，它们是编译时常量。

还要记住，C 和 C++ 对二维数组使用行优先顺序，但 FORTRAN 使用列优先顺序。当您通过 C/FORTRAN 边界传递数组时，这将产生转置数组的效果。

这涵盖了您发布的错误消息以及我看到的所有错误。

此外，[这](http://wwwcompass.cern.ch/compass/software/offline/software/fandc/fandc.html)似乎是您尝试做的一个很好的参考。

# mysql - MYSQL查询多表的逻辑

> ID：12391846
> 
> 赞同：0
> 
> 时间：2012-09-12T15:41:12.143
> 
> 标签：mysql, database, logic

您好，我对 MySql 有点生疏，有人可以帮我解决这个问题吗？

问题：我有以下表格：

![在此处输入图像描述](../Images/11fee4b8dbbfe70946031ddf4b818277.png)![在此处输入图像描述](../Images/52fa4719c80657d9a29a78cf021738d0.png)

我需要得到一个 Result:`APINAME`和`DESCRIPTION`( `ENDPOINT`from `APIS`table) where `USER_ID`(from `subscriptions`table) is = "1234" on `API_ID`，注意它`API_ID`的值与`APINAME`.

希望这已经足够清楚了。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:44:14.100

生锈是轻描淡写。你花了更多的时间来制作图片而不是寻找解决方案。

```
 select apiname, description, endpoint
  from apis a, subscriptions s
  where a.apiname = s.api_id
  and s.user_id = 1234 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:45:06.393

这应该有效：

```
SELECT a.apiname, a.description, a.endpoint
FROM apis a
INNER JOIN subscriptions b ON b.api_id = a.apiname
WHERE b.user_id = '1234' 
```

# sql - 使用 Django ORM 执行复杂的自引用查询

> ID：12391847
> 
> 赞同：4
> 
> 时间：2012-09-12T15:41:12.277
> 
> 标签：sql, django, orm

我有以下模型：

```
class Message(Model):
    url = URLField("URL")
    email = EmailField("E-Mail")
    contacted = BooleanField("Contacted", default=False) 
```

使用示例数据，例如：

```
| url | email           | contacted |
+-----+-----------------+-----------+
| foo | foo@example.com | N         |
| bar | bar@example.com | N         |
| baz | foo@example.com | Y         | 
```

我想选择从未联系过其电子邮件地址的所有不同行（按电子邮件地址）。使用此示例数据，该`bar@example.com`行将是唯一返回的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T18:09:41.453

这将返回您想要的记录：

```
not_contacted = Message.objects.exclude(
    email__in=Message.objects.filter(contacted=True).values('email')
) 
```

这样做的好处是只运行一个查询。您的查询将如下所示：

```
SELECT
    messages_message.id, messages_message.url, messages_message.email, messages_message.contacted
FROM
    Messages
WHERE NOT
    (messages_message.email IN
        ( SELECT U0.email from messages_message U0 WHERE U0.contacted = True )
    ) 
```

请注意，对于许多许多记录，此查询可能不是最佳的，但它可能适用于大多数用途。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:36:28.737

```
DROP SCHEMA tmp CASCADE;
CREATE SCHEMA tmp ;
SET search_path=tmp;

CREATE TABLE massage
        ( zurl varchar NOT NULL
        , zemail varchar NOT NULL
        , contacted boolean
        );
INSERT into massage(zurl, zemail, contacted) VALUES

( 'foo', 'foo@example.com', False)
,( 'bar', 'bar@example.com', False)
,( 'baz', 'foo@example.com', True)
        ;

SELECT
        DISTINCT zemail AS zemail
        , MIN(zurl) AS zurl
FROM massage m
WHERE NOT EXISTS (
        SELECT *
        FROM massage nx
        WHERE nx.zemail = m.zemail
        AND nx.contacted = True
        )
GROUP BY zemail; 
```

如果给定电子邮件地址有多个记录，则上面的记录会选择具有“最低”URL 的记录。如果你想要它们，查询会更简单：

```
SELECT m.zurl, m.zemail
FROM massage m
WHERE NOT EXISTS (
        SELECT *
        FROM massage nx
        WHERE nx.zemail = m.zemail
        AND nx.contacted = True
        ) ; 
```

# jquery - 将字段名称添加到 jquery validate 插件中的错误消息

> ID：12391850
> 
> 赞同：0
> 
> 时间：2012-09-12T15:41:23.407
> 
> 标签：jquery, validation, options, jquery-validate

我正在使用 jquery validate 插件来验证需要大量字段的表单。为了清楚起见，我想使用错误消息容器来显示错误消息，但是在这种情况下，我只会看到每个字段的相同通用（或自定义）错误消息。

我希望至少能够在每条错误消息前添加字段名称，以使错误消息更容易掌握。这是我想要实现的示例：

```
There are errors in your form:

 - Type of fruit: required
 - Quantity: required
 - Category: required 
```

而不是简单地得到：

```
There are errors in your form:

 - required
 - required
 - required 
```

我一直在搜索插件的文档和互联网一段时间，但找不到任何关于如何以简单直接的方式实现这一目标的迹象。

有谁知道这是否可以做到，以及如何做到？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:51:54.293

我认为可以这样做：

```
class="{required:true, messages:{required:'Type of fruit: required'}}" 
```

在这里看一个例子 - [http://jsfiddle.net/eJ4e3/](http://jsfiddle.net/eJ4e3/)

# oracle10g - 如何在Oracle中制作表的副本？

> ID：12391851
> 
> 赞同：1
> 
> 时间：2012-09-12T15:41:24.643
> 
> 标签：oracle10g

我需要将几个表从我们的 Oracle 数据库发送给我们的一位开发人员。我通常只发送整个数据库。但是如何只发送选定的表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:44:16.760

您可以使用 oracle 的导出工具。

```
exp scott/tiger file=emp.dmp tables=(emp,dept) 
```

这是来自 oracle的[常见问题解答链接。](http://www.orafaq.com/wiki/Import_Export_FAQ)

# asp.net-mvc - Razor 视图中的内联 If

> ID：12391853
> 
> 赞同：9
> 
> 时间：2012-09-12T15:41:30.417
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3, razor

在我的控制器中，我有内联 If 语句：

```
ViewBag.NameSortParam = If(String.IsNullOrEmpty(sortOrder), "Name desc", "") 
```

在我看来，如果出现以下情况，我似乎无法使用内联：

```
@Code
    If(True, true, true)
End code 
```

它说，“If 必须以匹配的 End If 结尾。” 如果在这里，为什么我不能使用内联？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T15:44:32.367

尝试

```
@Code
    @(If(True, true, true))
End Code 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-12T15:55:43.483

你可以使用这样的东西：

```
 @(true? "yes": "no") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-24T07:13:37.613

如果在 vb.net 中，您可以像这样进行内联：

```
@(If(testExpression, TruePart, FalsePart)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T15:44:55.140

您可以使用`IIf`，您不需要将代码与`@Code`部分混淆：

```
@IIf(String.IsNullOrEmpty(sortOrder), "Name desc", "") 
```

# matlab - 使用 recfromcsv 的输出

> ID：12391854
> 
> 赞同：1
> 
> 时间：2012-09-12T15:41:30.037
> 
> 标签：matlab, numpy, python-2.7

我正在将 Matlab 脚本移植到 Python。以下是摘录：

```
%// Create a list of unique trade dates
DateList = unique(AllData(:,1));

%// Loop through the dates
for DateIndex = 1:size(DateList,1)

    CalibrationDate = DateList(DateIndex);
    %// Extract the data for a single cablibration date (but all expiries)
    SubsetIndices = ismember(AllData(:,1) , DateList(DateIndex)) == 1;    
    SubsetAllExpiries = AllData(SubsetIndices, :); 
```

`AllData`是一个*N* × *6*单元矩阵，前 2 列是日期（字符串），其他 4 列是数字。在 python 中，我将从 csv 中获取这些数据，如下所示：

```
import numpy as np
AllData = np.recfromcsv(open("MyCSV.csv", "rb")) 
```

因此，如果我没记错的话，现在`AllData`是一个普通元组的 numpy 数组。这是保存这些数据的最佳格式吗？目标是从第 1 列中提取唯一日期列表，并为每个日期提取第 1 列中具有该日期的行（第 1 列已排序）。然后对于第一列中的每一行，对剩余 5 列中的数字和日期进行一些数学运算。

所以在matlab中我可以得到日期列表，`unique(AllData(:,1))`然后我可以得到对应于该日期的记录（行）（即第一列中的日期），如下所示：

```
SubsetIndices = ismember(AllData(:,1) , MyDate) == 1;    
SubsetAllExpiries = AllData(SubsetIndices, :); 
```

如何在 Python 中最好地实现相同的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:03:27.660

把事情放在上下文中，`np.recfromcsv`只是[`np.genfromtxt`](http://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html)输出记录数组而不是结构化数组的修改版本。

[结构化数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)允许您通过名称访问各个字段（此处为您的列），例如 in ，`my_array["field_one"]`而记录数组为您提供相同的功能，*并且*可以将字段作为属性访问，例如 in `my_array.field_one`。我不喜欢“作为属性访问”，所以我通常坚持使用结构化数组。

供您参考，structurede/record 数组**不是**元组数组，而是一些 numpy 对象的数组调用 a `np.void`：它是一个内存块，由您拥有的字段子块组成，每个子块的大小取决于其数据类型。

也就是说，是的，您似乎想到的正是结构化数组的那种用法。该方法将是：

*   获取您的`dates`数组并过滤它们以找到独特的元素。
*   找到这些唯一元素的索引，作为一个整数数组，我们称之为 `matching`，
*   用于使用[花哨的索引](http://docs.scipy.org/doc/numpy/user/basics.indexing.html)`matching`访问相应的记录（*例如*，数组的行），如 .`my_array[matching]`
*   根据需要对记录执行计算。

请注意，您可以将日期保留为字符串或`datetime`使用用户定义的转换器将它们转换为对象，如[文档](http://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html)中所述。例如，您可以将 a`YYYY-MM-DD`转换为`datetime`带有 a 的对象`lambda s:datetime.dateime.strptime(s,"%Y-%m-%d")`。这样，比方说，`N`每行（一条记录）由两个日期作为字符串和 4 个浮点数组成的数组，你将有一个`N`数组，其中每行由两个`datetime`对象和 4 个浮点数组成。

注意你的数组的形状（通过`my_array.shape`），它说`(N,)`，这意味着它是一个一维数组，即使它看起来像一个具有多列的二维表。您可以使用其名称访问各个字段（每个“列”）。例如，如果我们创建一个由一个名为的字符串字段`first`和一个`int`名为的字段组成的数组`second`，如下所示：

```
x = np.array([('a',1),('b',2)], dtype=[('first',"|S10"),('second',int)]) 
```

您可以访问该`first`列

```
>>> x['first']
array(['a', 'b'], 
      dtype='|S10') 
```

# jetty - 与 Jetty8 一起使用的 sl4j 版本

> ID：12391856
> 
> 赞同：1
> 
> 时间：2012-09-12T15:41:41.807
> 
> 标签：jetty, version, slf4j

Jetty8 使用的是哪个版本的 sl4j。Jetty8.1 发行版没有提供 sl4j，并且多次尝试为此获取 sl4j 的兼容版本都失败了。是否有可以下载此兼容 sl4j 的链接。到目前为止，我创建的当前设置中的 sl4j 根本没有使用 sl4j。但我想用这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:49:56.060

在 8.0.0.M3 版本的 jetty-project pom.xml 中定义：

```
<slf4j-version>1.5.11</slf4j-version> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:19:43.497

slf4j 版本是 1.6.1，您可以[在 POM](http://search.maven.org/remotecontent?filepath=org/eclipse/jetty/jetty-project/8.1.7.v20120910/jetty-project-8.1.7.v20120910.pom)中看到 8.1.7 版本。使用 maven，你不会遇到依赖问题。

# java - 写新道。没有绑定到线程的休眠会话

> ID：12391864
> 
> 赞同：0
> 
> 时间：2012-09-12T15:42:02.843
> 
> 标签：java, sql, hibernate, transactional

所以我有这样的课

基地道

```
public interface BaseDao<T> {

    T save(T entity);  
} 
```

用户道

```
public interface UserDao extends BaseDao<User> {

    User getUserByUserName(String name);

} 
```

GenericDao 公共抽象类 GenericDao 实现 BaseDao {

```
@Autowired
protected SessionFactory sessionFactory;

private Class<?> getEntityClass() {
    return ((Class) ((ParameterizedType) getClass().getGenericSuperclass())
            .getActualTypeArguments()[0]);
}

public T save(T entity) {
    Integer id = (Integer) sessionFactory.getCurrentSession().save(entity);
    return (T) sessionFactory.getCurrentSession().get(getEntityClass(), id);
} 
```

}

UserDaoImpl

```
@Repository
public class PgUserDaoImpl extends GenericDao<User> implements UserDao {

    public User getUserByUserName(String name) {
        Criteria criteria = sessionFactory.getCurrentSession().createCriteria(
                User.class);
        criteria.add(Restrictions.eq("name", name));

        return (User) criteria.uniqueResult();
    }

} 
```

通用服务

```
public class GenericService<T extends GenericDao<E>, E> {

    protected T dao;

    public GenericService(T dao) {
        setDao(dao);
    }

    @Transactional
    public E save(E entity) {
        return dao.save(entity);
    }
} 
```

用户服务实现

```
@Service("userServiceImpl")
public class UserServiceImpl extends GenericService<PgUserDaoImpl, User>
        implements UserService {

    @Autowired
    public UserServiceImpl(PgUserDaoImpl dao) {
        super(dao);
    }

    @Autowired
    private UserAssebmler assebmler;

    @Transactional
    @Override
    public UserDetails loadUserByUsername(String name)
            throws UsernameNotFoundException {
        .....
    }

} 
```

所以我写了测试控制器来保存用户，但我总是得到 Exception **org.hibernate.HibernateException: No Hibernate Session bound to thread，并且配置不允许在这里创建非事务性的**

控制器@

```
Controller
@RequestMapping(value = "/test")
public class TestController {

    @Autowired
    private UserServiceImpl userService;

    @RequestMapping(value = "save", method = RequestMethod.GET)
    public String test() {

        User user = new User();

        user.setName("admin");
        user.setPassword("21232f297a57a5a743894a0e4a801fc3");
        user.setRole(UserRole.ADMIN);

        userService.save(user);

        return "home";
    }

} 
```

有人知道热修复吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T11:15:31.040

我通过从 HibernateDaoSupport 类扩展 GenericDao 类解决了我的问题。

# c# - 这个 VS2010 构建输出是关于什么的？

> ID：12391870
> 
> 赞同：0
> 
> 时间：2012-09-12T15:42:29.430
> 
> 标签：c#, visual-studio-2010, build

C# WPF 应用程序的这个构建输出是怎么回事？

```
------ Rebuild All started: Project: CACI.Common, Configuration: Debug Any CPU ------
  CACI.Common -> D:\SvnSource\Main\InSite\trunk\insite\InsUi\Common\bin\Debug\CACI.Common.dll
------ Rebuild All started: Project: CACI.InSite, Configuration: Debug Any CPU ------
D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\View\SingleSelectTreeVw.xaml.cs(9,10): warning CS0105: The using directive for 'System.Windows.Controls' appeared previously in this namespace
d:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\Infrastructure\CustomMessageBox\MessageBoxVw.xaml(32,48): warning CS0108: 'CACI.InSite.Infrastructure.CustomMessageBox.MessageBoxVw.Icon' hides inherited member 'System.Windows.Window.Icon'. Use the new keyword if hiding was intended.
D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\Model\ManagedQuery\IOrderingQueryComponent.cs(78,33): warning CS0108: 'CACI.InSite.Model.ManagedQuery.IOrderingQueryComponent.ComponentType' hides inherited member 'CACI.InSite.Model.ManagedQuery.IQueryComponent.ComponentType'. Use the new keyword if hiding was intended.
D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\Model\ManagedQuery\IQueryComponent.cs(26,33): (Related location)
D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\Model\ManagedQuery\IOrderingQueryComponent.cs(83,12): warning CS0108: 'CACI.InSite.Model.ManagedQuery.IOrderingQueryComponent.HaveDefinition' hides inherited member 'CACI.InSite.Model.ManagedQuery.IQueryComponent.HaveDefinition'. Use the new keyword if hiding was intended.
D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\Model\ManagedQuery\IQueryComponent.cs(30,12): (Related location)
... LOADS MORE ERRORS

Compile complete -- 0 errors, 51 warnings
  Starting pre-build event
  Stopping InsDB80 service.
  The InSite80 DB Server service is not started.

  More help is available by typing NET HELPMSG 3521.

  PREBUILD EVENT INFO InsDB80 service already stopped.
  Registering project COM dependencies.
  COM Reference 'InsCtl8Lib' is the interop assembly for ActiveX control 'AxInsCtl8Lib' but was marked to be linked by the compiler with the /link flag. This COM reference will be treated as a reference and will not be linked.
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1558,9): warning : At least one of the arguments for 'ISMKeyStoreKeys.GetKeyString2' cannot be marshaled by the runtime marshaler.  Such arguments will therefore be passed as a pointer and may require unsafe code to manipulate.
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1558,9): warning : At least one of the arguments for 'SMKeyStore.GetKeyString2' cannot be marshaled by the runtime marshaler.  Such arguments will therefore be passed as a pointer and may require unsafe code to manipulate.
View\SingleSelectTreeVw.xaml.cs(9,10): warning CS0105: The using directive for 'System.Windows.Controls' appeared previously in this namespace
Model\ManagedQuery\IGroupingQueryComponent.cs(54,33): warning CS0108: 'CACI.InSite.Model.ManagedQuery.IGroupingQueryComponent.ComponentType' hides inherited member 'CACI.InSite.Model.ManagedQuery.IQueryComponent.ComponentType'. Use the new keyword if hiding was intended.
Model\ManagedQuery\IGroupingQueryComponent.cs(59,12): warning CS0108: 'CACI.InSite.Model.ManagedQuery.IGroupingQueryComponent.HaveDefinition' hides inherited member 'CACI.InSite.Model.ManagedQuery.IQueryComponent.HaveDefinition'. Use the new keyword if hiding was intended.
Model\ManagedQuery\IGroupingQueryComponent.cs(147,45): warning CS0108: 'CACI.InSite.Model.ManagedQuery.IGroupingQueryComponent.GetEnumerator()' hides inherited member 'System.Collections.Generic.IEnumerable<CACI.InSite.Model.ManagedQuery.IGroupingQueryExpression>.GetEnumerator()'. Use the new keyword if hiding was intended.
... LOADS MORE ERRORS
  CACI.InSite -> D:\SvnSource\Main\InSite\trunk\insite\InsUi\InSite\bin\Debug\CACI.InSite.exe
========== Rebuild All: 2 succeeded, 0 failed, 0 skipped ========== 
```

显然，存在大量编译警告这一事实是一个问题，但这是我无法控制的。我不明白的是输出本身的结构。

它从编译 .cs 文件生成的大量警告开始，这些警告使用文件的完全根路径并包含扩展某些警告的“（相关位置）”条目。

然后有一个“编译完成”消息指示有多少警告，然后是预构建事件的运行（重新启动数据库服务）。现在称我为老式的，但我的方式相当成熟，我通常希望我的预构建事件在我的文件构建*之前运行。*

最后还有第二个警告块，它主要是第一个块的重复，但这次它包括与链接相关的错误，不使用完全根目录的路径，也不包含“（相关位置）”添加。

第一个问题：在我看来，这个输出看起来像一个非理性的混乱，实际上在某种程度上我不理解是合乎逻辑的吗？

第二个问题：无论如何我可以强制 VS 输出一些更传统的东西

```
1\. Pre-build event.
2\. Compiler warnings with inserted "(Related location)" markers.
3\. Link errors.
4\. Build summary. 
```

编辑：我更新了输出以反映实际上有 2 个项目正在构建的事实，但第一个项目在没有错误或警告的情况下完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T16:39:36.207

这是 MS 不会修复的 VS2010 错误。

[为什么在 VS2010 中 WPF 应用程序会重复所有警告两次，我该如何停止？](https://stackoverflow.com/questions/12428705/why-in-vs2010-does-a-wpf-application-repeat-all-warnings-twice-and-how-do-i-stop)

错误报告在这里。

[https://connect.microsoft.com/VisualStudio/feedback/details/763045/adding-a-xaml-namespace-reference-to- contains-assembly-corrupts-build-output](https://connect.microsoft.com/VisualStudio/feedback/details/763045/adding-a-xaml-namespace-reference-to-containing-assembly-corrupts-build-output)

# apache - Ubuntu 升级后 Subversion/svn Propfind 405 错误

> ID：12391872
> 
> 赞同：0
> 
> 时间：2012-09-12T15:42:34.153
> 
> 标签：apache, svn, ubuntu

我已经升级了托管我的 Subversion 存储库的 Ubuntu 服务器，现在无法访问 svn。

```
http://hostname/svn 
```

没有给我任何回应，Subclipse 说：

```
Propfind 405 method not allowed. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:42:34.153

问题是在升级过程中，我选择用新版本覆盖/etc/apache2/mods-available/ 中的**dav_svn.conf** - 有效地取消了 apache 中的 Subversion 配置。

幸运的是，升级过程将原始副本保存为 dav_svn.conf.dpkg-old 在同一目录中，因此我能够使用以下内容查看差异并恢复配置：

```
diff dav_svn.conf  dav_svn.conf.dpkg-old 
```

最后，重新加载 Apache 配置：

```
sudo service apache2 graceful 
```

# objective-c - 使用 NSTask 运行用户定义的命令

> ID：12391874
> 
> 赞同：0
> 
> 时间：2012-09-12T15:42:40.550
> 
> 标签：objective-c, cocoa, nstask

我想执行用户指定的终端命令。例如，用户可能在文本字段中写入`killall "TextEdit"`或`say "Hello world!"`，而我想执行该命令。

NSTask 是要走的路，除了我有两个问题：

**第一：**论据。现在我正在这样做：

```
NSArray* args = [commandString componentsSeparatedByString: @" "];
[task setArguments: [args subarrayWithRange: NSMakeRange(1, [args count] - 1)]]; // First one is the command name 
```

这是这样做的方法吗？我不认为我对此有任何问题，但我看起来并不安全。想象一下：用户写入`killall 'Address Book'`但命令接收为参数`'Address`和`Book'`?? 那是行不通的。那么，我应该怎么做呢？如何安全地解析参数？

**第二：**发射路径。只需要编写命令的名称而不是完整的路径对用户来说更加友好。所以我想支持这一点，这意味着以编程方式找出只有它的名称的命令的完整路径。为此，我在 NSTask 上写了一个这样的类别：

```
+ (NSString*)completePathForExec: (NSString*)exec
{
    NSTask* task = [[NSTask alloc] init];
    NSPipe* pipe = [[NSPipe alloc] init];

    NSArray* args = [NSArray arrayWithObject: exec];
    [task setLaunchPath: @"/usr/bin/which"];
    [task setArguments: args];
    [task setStandardOutput: pipe];
    [task setStandardError: pipe];

    [task launch];    
    [task waitUntilExit];

    NSFileHandle* file = [pipe fileHandleForReading];
    NSString* result = [[NSString alloc] initWithData: [file readDataToEndOfFile] encoding: NSASCIIStringEncoding];

    if ([result length]) {
        if ([result hasSuffix: @"\n"]) { result = [result substringWithRange: NSMakeRange(0, [result length] - 1)]; }

        return result;
    }
    else { return exec; }
} 
```

这似乎运作良好。但是，我如何确定这条路径：`/usr/bin/which`将始终有效？我的意思是：它会在 10.6、10.7、10.8 等上运行吗？我想我曾经遇到过一个问题，即 shell 命令的路径随系统版本而变化，你永远不会太小心。

如果保证路径保持不变，那么这不是问题。如果它改变了，那么我怎么知道“路径查找器的路径”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:34:21.687

不重新发明命令行解析轮会容易得多。但是，当然，执行任意用户输入的代码是一场安全噩梦（由于用户可以访问系统，因此可能直接运行终端）。

具体来说，让 NSTask 使用命令行选项包装对其中一个 shell 的调用，以使其执行任意字符串。

```
sh -c "ls -alF" 
```

这将允许您将路径传递给`sh`您的启动路径，该路径位于每个系统上的固定位置。该`@"-c"`参数告诉`sh`将下一个参数解析为脚本，当然，下一个参数是用户输入的任何内容。

请注意，这也将赋予用户管道内容的能力。

# azure - 共同管理员在新的 Azure 门户中看不到订阅

> ID：12391879
> 
> 赞同：9
> 
> 时间：2012-09-12T15:42:57.447
> 
> 标签：azure, portal

简单地说，我有一个 Azure 企业订阅。我有一个共同管理员，他有自己的个人 90 天试用订阅。当共同管理员使用新的预览门户 (manage.windowsazure.com) 时，他可以查看他们的个人订阅（他是管理员），但不能选择或查看公司订阅（他是共同管理员）。

有任何想法吗？我们希望将公司内的多人分配为共同管理员，以便他们可以使用预览功能（虚拟机、Azure 网站、媒体服务）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-04-06T16:44:32.253

我也遇到了这个问题，事实上，试图通过 resources.azure.com 站点查看数据被证明是徒劳的。事实证明，新门户拥有自己的用户管理功能，这些功能比旧门户的管理员/共同管理员更精细。允许订阅所有者使您成为新门户中的贡献者或所有者，您应该能够通过新门户查看有关订阅的更多数据。要做到这一点：

1.  作为服务管理员，转到新门户
2.  浏览订阅
3.  找到并选择您需要添加用户的订阅
4.  在订阅详细信息边栏选项卡中，选择设置
5.  在资源管理下，选择用户
6.  您会注意到，即使您是共同管理员，您也不会在用户中列出。
7.  添加用户并使他们成为贡献者/所有者

有关 Azure 基于角色的访问控制的更多信息，请访问：[https ://azure.microsoft.com/en-us/documentation/articles/role-based-access-control-configure/](https://azure.microsoft.com/en-us/documentation/articles/role-based-access-control-configure/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-05-09T20:52:13.720

Azure 管理员已更改，因此 2 个当前答案已过时。请按照以下步骤操作：

1.  打开订阅，单击“我的权限”，然后“单击此处查看此订阅的完整访问详细信息”
2.  在访问控制 (IAM) 中，单击角色分配，然后单击添加
3.  选择“添加角色分配”，然后选择角色为“贡献者”并从右侧窗格中选择要添加的用户，然后单击“保存”。
4.  确保用户在“角色分配”下被列为贡献者

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T18:54:57.953

Windows Azure 预览门户的主要问题是，如果您是任何特定 Windows Azure 订阅的**帐户管理员**，当您使用作为其他 Windows Azure 帐户的帐户管理员的实时 ID 时，它只会显示特定于该特定订阅的配置。如果同一个 live ID 是两个不同订阅的**服务管理员**，那么在预览门户中，两个订阅详细信息都将显示。此问题与 Windows Azure Preview Portal 相关，并且仍在进行中。

因此，如果你想解决这个问题，你应该使用**OrgID/liveID**，它是多个订阅中的**服务管理员**（如果适用），这样 LiveID 将显示两个订阅的详细信息。

# java - 无法连接到其他 PC 的 TCP 套接字服务器

> ID：12391882
> 
> 赞同：1
> 
> 时间：2012-09-12T15:43:05.443
> 
> 标签：java, networking

我和我的朋友正在做在线游戏项目，一开始我们使用 java 建立的 TCP 连接。我该怎么做才能成功让我的朋友客户端连接到我的服务器？在本地主机上它工作得很好。这有什么要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:07:55.903

检查以确保您的防火墙允许从远程主机连接到您托管游戏的端口上的计算机。如果您的朋友从其他位置连接到您的计算机，您很可能需要将防火墙规则添加到您的路由器。

# ruby-on-rails - Ruby on Rails 多个 belongs_to 关联保存

> ID：12391884
> 
> 赞同：2
> 
> 时间：2012-09-12T15:43:08.647
> 
> 标签：ruby-on-rails, activerecord, associations, belongs-to

`belongs_to`在 Rails 的概念中有一些我不太了解的东西。文档指出：

`Adding an object to a collection (has_many or has_and_belongs_to_many) automatically saves that object`

假设我有一个`Employee`实体：

```
class Employee < ActiveRecord::Base  
  belongs_to :department
  belongs_to :city    
  belongs_to :pay_grade
end 
```

以下代码会触发三个更新吗？如果是，有更好的方法吗？：

```
e = Employee.create("John Smith")
Department.find(1) << e
City.find(42) << e
Pay_Grade.find("P-78") << e 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:45:34.017

您可以简单地分配它：

```
e = Employee.new(:name => "John Smith")
e.department = Department.find(1)
e.city = City.find(42)
e.pay_grade = Pay_Grade.where(:name => "P-78")

e.save 
```

在保存对象之前，我将其更改`create`为构造对象。`new`构造函数采用散列，而不是不同的值。`find`只接受 id 而不是字符串，`where`而是在字段上使用。

您还可以使用以下内容：

```
Employee.create(:name => "John Smith", 
                :department => Department.find(1), 
                :city => City.find(42), 
                :pay_grade => PayGrade.where(:name => "P-78").first 
```

另请注意，型号名称应为驼峰式：`PayGrade`而不是`Pay_Grade`.

# html - 用 2 个跨度覆盖一个 div

> ID：12391885
> 
> 赞同：0
> 
> 时间：2012-09-12T15:43:13.660
> 
> 标签：html, css

我有这个 HTML 片段：

```
<div style="display: inline-block; width: 20px; height: 20px; background-color: silver">
    <span style="display: inline-block; background-color: red; width: 10px; height: 20px;"></span>
    <span style="display: inline-block; background-color: green; width: 10px; height: 20px; "></span>
</div> 
```

`<div>`我的目标是用两个并排的跨度覆盖外部，但是，一个跨度位于另一个跨度之上。

怎么制作，所以红色的SPAN在左边，右边的SPAN在右边？（注意，我希望该解决方案支持超过 2 个内部 SPAN）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:47:03.260

因为跨度是`inline-block`，所以它们之间的空白将显示为一个空格，并且一个将被推到下方，因为 div 的宽度不考虑那个额外的空间。尝试使用注释删除跨度之间的空格（或将它们放在同一行）。

```
<div style="display: inline-block; width: 20px; height: 20px; background-color: silver">
    <span style="..."></span><!--
    --><span style="..."></span>
</div> 
```

我还建议使用样式表来设置元素的样式，而不是使用内联 CSS。这将使您的代码更具可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T15:47:07.873

如果您浮动跨度，它们将并排移动。[这里](http://jsfiddle.net/CzP94/)有一个例子。

```
 <div style=" width: 20px; height: 20px; background-color: silver">
        <span style="display: inline-block; float:left;background-color: red; width: 10px; height: 20px;"></span>
        <span style="display: inline-block; float:left;background-color: green; width: 10px; height: 20px; "></span>
    </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:53:00.973

威廉对你的问题的评估是正确的。我发现添加`font-size: 0`到父元素（在您的情况下是封闭的 div）可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T17:03:36.940

就像 scrappedcola 所说的，它可以通过浮动内部元素来修复，但是每当你浮动一些应该清晰的东西时，它可以是这样的：-

```
<div style=" width: 20px; height: 20px; background-color: silver">
        <span style="display: inline-block; float:left;background-color: red; width: 10px; height: 20px;"></span>
        <span style="display: inline-block; float:left;background-color: green; width: 10px; height: 20px; "></span>
        <div style="clear: both;"></div>
    </div> 
```

这里额外的 div 是一个伪元素，用于清除浮动元素

另一种方法是在父 div 上使用 clearfix 类

clearfi 类的 css 是

```
.clearfix:after {clear:both;content:".";display:block;height:0;visibility:hidden;} 
```

您的代码应如下所示：-

```
<div class="clearfix" style=" width: 20px; height: 20px; background-color: silver">
            <span style="display: inline-block; float:left;background-color: red; width: 10px; height: 20px;"></span>
            <span style="display: inline-block; float:left;background-color: green; width: 10px; height: 20px; "></span>
        </div> 
```

# silverlight - 升级 Silverlight 时出错

> ID：12391886
> 
> 赞同：1
> 
> 时间：2012-09-12T15:43:18.123
> 
> 标签：silverlight, silverlight-4.0, silverlight-2.0

我继承了一个相当大的项目，需要从 Silverlight 2 升级到 Silverlight 4。我最近在尝试测试该项目时遇到了错误。

```
Microsoft JScript runtime error: Unhandled Error in Silverlight Application Set property 'System.Windows.FrameworkElement.Style' threw an exception. [Line: 257 Position: 27]   at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
   at ESM.Visualization.MainPage.InitializeComponent()
   at ESM.Visualization.MainPage..ctor()
   at ESM.Visualization.App.Application_Startup(Object sender, StartupEventArgs e)
   at MS.Internal.CoreInvokeHandler.InvokeEventHandler(Int32 typeIndex, Delegate handlerDelegate, Object sender, Object args)
   at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, Int32 actualArgsTypeIndex, String eventName) 
```

我认为 Silverlight 2 和 4 之间可能丢失了一些文件，但我不确定从哪里开始寻找要修复的更改。任何帮助，将不胜感激。

# tridion - 在 Tridion 2009 中批量删除出版物

> ID：12391889
> 
> 赞同：2
> 
> 时间：2012-09-12T15:43:35.823
> 
> 标签：tridion

有没有办法批量删除出版物而不是从内容管理器中删除它们？我需要清理掉大约 75 家现在过剩的酒吧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T16:14:09.957

虽然*可以*直接操作数据库，但删除出版物的唯一*受支持*的方法是通过内容管理器或 API（尽管快速查看文档，我认为只能通过旧的 TOM API，而不是 TOM.Net）。

正如 Nuno 所建议的那样，对于 75 种出版物，通过内容管理器完成这项工作可能比编写/测试/调试使用 API 完成相同工作的工具要容易得多。

请记住，您只能删除出版物，只要：

*   出版物中没有任何内容被发布。
*   出版物在蓝图中没有任何子出版物。
*   您是系统管理员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T17:54:00.013

最简单的方法是使用我想说的核心服务 API，例如，按照[tridion-practice](http://code.google.com/p/tridion-practice/wiki/GetCoreServiceClientWithoutConfigFile)`client.Delete("tcm:0-xyz-1");`中的描述调用创建核心服务客户端。

但是，您很可能会收到一个`Item is in use.`错误，您最好可以在 UI 中手动解决该错误。使用该方法也可以在调用 Delete 之前取消发布整个发布作为准备`client.UnPublish()`（有关所需参数的详细信息，请参阅 API 文档）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:52:47.057

很大程度上取决于您需要摆脱哪些出版物。从脚本中删除出版物很容易。（我最喜欢的方法是使用 Windows Powershell），但您需要先删除蓝图子级，然后再尝试删除它们的父级。如果出版物具有蓝图子项，则不能将其删除。

所以先搞清楚蓝图关系，再做删除。尽管如此，对于 75 份出版物，您可能会在测试脚本之前手工完成。当然，如果您需要通过您的 DTAP 街道准确地传输相同的更改，则可以使用脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:25:09.837

这是一个耗时的过程，我去年删除了 50 多个，其中数千个已发布项目在这些出版物中。

仅供参考，有一种更快的方法可以使用电动工具将所有项目设置为未发布，但同样会在代理数据库中留下许多条目。

因此，建议对此进行计划并从内容管理器、tom API 或核心服务中进行适当的取消发布和删除。

# jquery - 使用 jquery 强制 css 用于某个类

> ID：12391890
> 
> 赞同：0
> 
> 时间：2012-09-12T15:43:37.000
> 
> 标签：jquery, css, opacity

我有一个带有自动旋转导航的 jquery 横幅循环。导航设置在一个列表中，其中活动幻灯片有一个 LI 类 activeSlide：

```
<ul id="billboard-nav">
    <li class="activeSlide"><span class="overlay">NAV1</span></li>
    <li><span class="overlay">NAV2</span></li>
    <li><span class="overlay">NAV3</span></li>
</ul> 
```

Jquery 设置所以 .overlay 是不透明度 0，并且在悬停时，它会更改为不透明度 1。

```
<script>
$(function() {  

    $("#billboard-nav li .overlay").css({ opacity: 0 });

    $("#billboard-nav li").hover(
        function() {$(this).children('.overlay').stop().animate({"opacity": "1"}, 100);},
        function() {$(this).children('.overlay').stop().animate({"opacity": "0"}, 1200);}
    );

});
</script> 
```

这很好用，除了我需要 .activeSlide .overlay 保持不透明度：1。我可以通过样式表设置 opacity:1!important，但这是 CSS3，ie7、8 不支持。JS 解决方案将是首选。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:48:29.613

首先询问 li 是否包含 activeSlide 类，将其放入每个函数中，然后放在您拥有的行之前

```
if(!$(this).attr("class") || $(this).attr("class")!="activeSlide" 
```

另一种选择是：

```
$("#billboard-nav li").no(".activeSlide").hover(
        function() {$(this).children('.overlay').stop().animate({"opacity": "1"}, 100);},
        function() {$(this).children('.overlay').stop().animate({"opacity": "0"}, 1200);}
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:53:11.067

只需添加一个 Condition 并检查当前 li 是否有 activeSlide 类。如果是，则什么也不做。

```
$(function() {

    $("#billboard-nav li .overlay").css({
        opacity: 0
    });

    $("#billboard-nav li").hover(

    function() {
        $(this).children('.overlay').stop().animate({
            "opacity": "1"
        }, 100);
    }, function() {
        if ($(this).hasClass('activeSlide')) {
           // Because this has ActiveSlide class do nothing
        }
        else {

            $(this).children('.overlay').stop().animate({
                "opacity": "0"
            }, 1200);
        }
        });

    });​ 
```

在这里检查[FIDDLE](http://jsfiddle.net/sushanth009/54Rww/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:55:02.017

尝试这个：

```
$('#billboard-nav li').hover(function() {
  if ($('this').hasClass('activeSlide')) {

  }
  else {
        function() {$(this).children('.overlay').stop().animate({"opacity": "0"}, 1200);}
    );
  }
}); 
```

# php - php爆炸问题

> ID：12391894
> 
> 赞同：0
> 
> 时间：2012-09-12T15:44:09.133
> 
> 标签：php, html, explode, submit-button

我编写了一个小的 php 脚本，它从目录中读取文件名，使用explode 去除扩展名，然后在 php 页面上显示文件名。

但是由于某种原因，每当文件名包含多个单词时，它只显示文件名的第一个单词。

这是代码，

```
while  ($name = readdir ($handle)) 
        {
            if ($name == '.' || $name == '..')
            continue; /* don't echo anything, skip to next read */
            $i++;
            echo '<td >';
            echo '<form name="form" method="get" action="download.php">';
            echo '<input type="hidden" name="file" value='.$name.' />';
            $parts=explode(".",$name);
            $name=$parts[0];
            echo '<input type="submit" name="submit" value='.$name.' class="subbutton" /> </br></br>';
            echo '</form>';
            echo '</td>';
            if($i==5)
            {
            echo '</tr>';
            echo '<tr>';
            $i=0;
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T15:48:42.970

更改此行：

```
echo '<input type="submit" name="submit" value='.$name.' class="subbutton" /> </br></br>'; 
```

对此：

```
echo '<input type="submit" name="submit" value="'.$name.'" class="subbutton" /> </br></br>'; 
```

这样你就可以引用你的属性，并且 HTML 解析器不会被文件名中的空格弄糊涂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:50:44.030

您需要确保将所有内容都放在文件名中最后一个句点的左侧，因为文件名可以包含多个。这使得爆炸成为一个不太理想的解决方案。以下代码将为您提供文件名，减去文件扩展名：

```
$file_name_without_extension = substr($full_file_name, 0, strrpos($full_file_name, ".")); 
```

# asp.net - 触发事件后，在文本框或单选按钮列表中输入的值会在事件回发时清除吗？

> ID：12391897
> 
> 赞同：1
> 
> 时间：2012-09-12T15:44:16.573
> 
> 标签：asp.net, vb.net, input, postback

在 ASP.net 中，我有一个简单的文本框和单选按钮列表，其中包含是或否选项。在 VB 服务器端，我实现了单选按钮的 OnClick 并执行了操作。

```
<asp:RadioButtonList ID="rbltest" runat="server" AutoPostBack="true"      OnSelectedIndexChange="rbltest_SelectedIndexChanged"                                                                      <asp:ListItem Text="Yes" Value="0"></asp:ListItem>
<asp:ListItem Selected="True" Text="No" Value="1"></asp:ListItem>
</asp:RadioButtonList> 
```

唯一的问题是，如果我单击单选按钮，然后将数据输入到 TextBox（立即 - 在不到 2 秒的时间内），当单选按钮返回时，它会删除数据。这很烦人。反正周围有吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:51:30.503

解决此问题的唯一方法是删除`AutoPostBack=true`控件`RadioButtonList`。自动回发选项会立即启动一个 HTTP 回发到服务器，因此在此之后键入的任何内容都将丢失。

其他选项：

*   实现一个客户端`onclick`处理程序，并在回发过程中*禁用*文本（即，让用户清楚他们不能输入任何内容，也就是[最小惊讶原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)）。
*   使用 Javascript 在客户端完全实现更改逻辑
*   使用 ASP.Net AJAX [UpdatePanel](http://ajax.net-tutorials.com/controls/updatepanel-control/)异步执行回发（这不需要完整回发到服务器，因此允许您继续输入）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:50:51.323

`EnableViewState="false"`您必须在您的控件上删除丢失数据的人，并让控件上的 ViewState (true) 的默认值。

# jquery - html - 如何在 pdf 嵌入标签中放置内容？

> ID：12391898
> 
> 赞同：1
> 
> 时间：2012-09-12T15:44:17.430
> 
> 标签：jquery, html, adobe-reader

在 html 代码中，我有在`<embed></embed>`网络上显示 pdf 文件的标签。但问题是我需要考虑用户没有安装或安装 adobe 插件但禁用 web 查看器设置的情况。所以基本上我需要检测pdf是否显示。

我想做这样的事情`<embed>Please install the acrobat plugin.</embed>`，因为如果它确实有效，那么它应该在文本顶部显示 pdf 从而隐藏文本，但如果 pdf 没有显示，那么文本会显示。

但是当我对此进行测试时，它不起作用。当我查看 IE9 开发者工具时，“请安装 acrobat 插件”。文本在嵌入标签之外......就像这样：

```
<embed/>
Please install the acrobat plugin.
</embed> 
```

有谁知道如何解决这个问题？谢谢。

# javascript - 我在哪里可以找到 RXUI Javascript 'Time Flies' 示例？

> ID：12391902
> 
> 赞同：0
> 
> 时间：2012-09-12T15:44:20.520
> 
> 标签：javascript, system.reactive, reactive-extensions-js

大约两年前，Microsoft Research 有一个很棒的 RXUI-For-Web 原型，它带有一个示例 html 页面，当您移动鼠标时，该页面上的文本“时间像箭头一样飞逝”。我一直在尝试再次找到原型，但 MS Research 已经重新组织了这些页面，我无法再次找到原始示例项目。有谁知道这个转移到哪里了？有谁知道我可以找到原始“时光飞逝”示例的替代位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T10:44:04.100

[在 github 上](http://reactive-extensions.github.com/RxJS-Examples/timeflies/timeflies.html)随机遇到了这个问题和一个明显有效的例子。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:56:32.350

似乎该示例未包含在当前的 git 存储库中。该团队正在努力使用更新的位更新存储库。您可能会发现它重新出现并在某个时候飞得更快。我认为您仍然可以在[http://msdn.microsoft.com/en-us/data/gg577610#js](http://msdn.microsoft.com/en-us/data/gg577610#js)下载的 RxJs 1.0 中找到示例。解释代码的博客文章位于[http://blogs.msdn.com/b/jeffva/archive/2010/03/17/reactive-extensions-for-javascript-the-time-flies-like-an-arrow -sample.aspx?CommentPosted=true#commentmessage](http://blogs.msdn.com/b/jeffva/archive/2010/03/17/reactive-extensions-for-javascript-the-time-flies-like-an-arrow-sample.aspx?CommentPosted=true#commentmessage)。不幸的是，在线帖子不再有效，因为它使用了不再可用的 RxJs 版本（出现 502 错误）。

# php - 显示独特点击的 url 旋转器

> ID：12391904
> 
> 赞同：-1
> 
> 时间：2012-09-12T15:44:22.523
> 
> 标签：php, mysql, url, rotator

我想在 php 中创建一个 URL rotator 页面，为每个访问者显示每个 URL 一次，换句话说，旋转器中的每个 url 只会获得唯一的点击，并且如果同一个访问者 (ip) 已经看到了 rotator 中的所有 url ，它将显示一个默认 URL，该默认 URL 只有在所有链接都显示给该访问者时才会显示。

url 可能存储在 .db 文件或 MySQL 数据库中。

如果你能告诉我如何使用访问者 ip 而不是 cookie 来做到这一点会更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:52:37.997

使用访问者 IP 的关键问题是 1) 可能会从会话更改为会话，并且更相关 2) 防火墙/代理后面的多个用户将显示为单个 IP。使用 cookie（或等效的本地存储标记）是有效实现您想要做的事情的唯一方法。

您是否有不想使用 cookie 的原因？

# python - 如何在数字前添加足够的零以便使用 Python 获得该数字的六位数字？

> ID：12391907
> 
> 赞同：1
> 
> 时间：2012-09-12T15:44:29.433
> 
> 标签：python

我的数据库中有一个巨大的数字列表（每个数字小于或等于 6 个数字），例如：
90494
898333
898
13
等。

我希望使用 python 将它们格式化为：
090494
898333
000898
000013
等...

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T15:45:25.410

[带有C 风格格式修饰符的](http://docs.python.org/library/stdtypes.html#string-formatting)标准 python 插值应该可以工作：

```
print "%06d" % number 
```

* * *

或者，如果您更喜欢[**PEP 3101**](http://www.python.org/dev/peps/pep-3101/)[`.format`](http://docs.python.org/library/string.html#format-examples)中的描述（很可能是 python 中字符串格式化的未来）：[](http://www.python.org/dev/peps/pep-3101/)

 **```
print '{0:06d}'.format(1) 
```

* * *

或者，如果您正在使用字符串，则可以使用[`zfill`](http://docs.python.org/library/string.html#string.zfill)：

```
print '1'.zfill(6) 
```**

# saxon - 使用 Saxon API 和 IKVM 的基本 Web 应用程序抛出异常

> ID：12391913
> 
> 赞同：0
> 
> 时间：2012-09-12T15:44:36.947
> 
> 标签：saxon, ikvm

我创建了一个基本的 .NET 4.0 应用程序并引用了 Saxon 程序集。这是我在项目中引用的 dll 列表。

saxon9.dll saxon9api.dll IKVM.OpenJDK.ClassLibrary.dll IKVM.Runtime.dll

该应用程序的代码如下：

```
Sub Main()

    Console.WriteLine("Trying to instantiate SaxonProcessor...")
    Try
        Dim SaxonProcessor As Saxon.Api.Processor = New Saxon.Api.Processor()
    Catch ex As Exception
        Console.WriteLine("Error: " & ex.Message & ex.StackTrace)
        Console.Read()
    End Try

    Console.WriteLine("Saxon instantiated successfully!")
    Console.Read()

End Sub 
```

当我在我们的 IIS 机器上运行这个应用程序时，我得到以下输出：

正在尝试实例化 SaxonProcessor... Saxon 实例化成功！

然后，我创建了一个基本的 Web 应用程序项目并引用了与 Windows 应用程序相同的文件。我将 Web 应用程序部署到包含所有引用程序集的虚拟目录。我将以下代码放入我的 Default.aspx 页面中：

公共类 _Default 继承 System.Web.UI.Page

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Response.Write("Trying to instantiate SaxonProcessor...")

    Try
        Dim SaxonProcessor As Saxon.Api.Processor = New Saxon.Api.Processor()
        Response.Write("Saxon instantiated successfully!")
    Catch ex As Exception
        Response.Write("Error: " & ex.Message & ex.StackTrace)
    End Try

End Sub 
```

结束类

当我加载页面时，它给了我这个异常：

尝试实例化 SaxonProcessor...错误：“IKVM.NativeCode.java.lang.Thread”的类型初始化程序引发异常。在 IKVM.NativeCode.java.lang.Class.forName0(String name, Boolean initialize, Object loader) at java.lang.Class.forName0(String , Boolean , ClassLoader) at java.lang.Class.forName(String className) at net.sf.saxon.dotnet.DotNetExtensionFunctionFactory.class$(String x0) at net.sf.saxon.dotnet.DotNetExtensionFunctionFactory..ctor(Configuration config) at net.sf.saxon.dotnet.DotNetPlatform.initialize(Configuration config) at net.sf.saxon.Configuration.init() at net.sf.saxon.Configuration..ctor() at Saxon.Api.Processor..ctor() at BealSaxxon._Default.Page_Load(Object sender, EventArgs e) in C :\Users\u0147101\Desktop\BealSaxxon\BealSaxxon\Default.aspx.vb:第 9 行

来自 IIS 机器的完整堆栈跟踪：

```
System.TypeInitializationException: The type initializer for 'IKVM.NativeCode.java.lang.Thread' threw an exception. ---> System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.TypeInitializationException: The type initializer for 'java.io.BufferedInputStream' threw an exception. ---> java.lang.RuntimeException: java.lang.IllegalAccessException: Class java.util.concurrent.atomic.AtomicReferenceFieldUpdater can not access a member of class java.io.BufferedInputStream with modifiers "volatile" ---> java.lang.IllegalAccessException: Class java.util.concurrent.atomic.AtomicReferenceFieldUpdater can not access a member of class java.io.BufferedInputStream with modifiers "volatile"
   at sun.reflect.misc.ReflectUtil.ensureMemberAccess(Class currentClass, Class memberClass, Object target, Int32 modifiers)
   at java.util.concurrent.atomic.AtomicReferenceFieldUpdater.AtomicReferenceFieldUpdaterImpl..ctor(Class , Class , String )
   --- End of inner exception stack trace ---
   at java.util.concurrent.atomic.AtomicReferenceFieldUpdater.AtomicReferenceFieldUpdaterImpl..ctor(Class , Class , String )
   at java.util.concurrent.atomic.AtomicReferenceFieldUpdater.newUpdater(Class tclass, Class vclass, String fieldName)
   at java.io.BufferedInputStream..cctor()
   --- End of inner exception stack trace ---
   at java.io.BufferedInputStream.__<clinit>()
   at java.lang.System.initializeSystemClass()
   --- End of inner exception stack trace ---
   at System.RuntimeMethodHandle._InvokeMethodFast(IRuntimeMethodInfo method, Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeType typeOwner)
   at System.RuntimeMethodHandle.InvokeMethodFast(IRuntimeMethodInfo method, Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeType typeOwner)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
   at IKVM.NativeCode.java.lang.Thread..cctor()
   --- End of inner exception stack trace ---
   at IKVM.NativeCode.java.lang.Class.forName0(String name, Boolean initialize, Object loader)
   at java.lang.Class.forName(String className)
   at net.sf.saxon.dotnet.DotNetExtensionFunctionFactory.class$(String x0)
   at net.sf.saxon.dotnet.DotNetExtensionFunctionFactory..ctor(Configuration config)
   at net.sf.saxon.dotnet.DotNetPlatform.initialize(Configuration config)
   at net.sf.saxon.Configuration.init()
   at net.sf.saxon.Configuration..ctor()
   at Saxon.Api.Processor..ctor()
   at EDG.Transforms..ctor()
   at EDG.Main..ctor(NameValueCollection applicationSettings, List`1 exceptionList)
   at EDG.EGallery..ctor(NameValueCollection ConfigurationSettings, List`1 ExceptionList) 
```

有没有人见过这个异常？我在谷歌上进行了广泛的搜索，但似乎没有人有这个特定的例外。我认为这是 IIS 的权限问题，但我不确定。运行此应用程序的应用程序池是由机器管理员设置的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T13:43:09.793

在这种情况下，是一个名为 OpNET 的产品干扰了使用 JVM 的应用程序。一旦停止其服务和进程，撒克逊程序集就可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:44:22.683

我认为这可能是两种原因。

*   缺少 IKVM dll 之一。添加 IKVM 的所有 dll 以测试是否可以解决问题。
*   IKVM 是为 .NET 2 而不是版本 4 编译的。您需要将版本映射添加到您的 app.config。

# java - IllegalStateException：getInputStream() 不可用。这是可重入调用吗？

> ID：12391915
> 
> 赞同：1
> 
> 时间：2012-09-12T15:44:44.907
> 
> 标签：java, android, http

我正在创建一个用于下载项目的类。我正在使用以下方法连接和检索下载信息：

```
public mDownload(String url) throws MalformedURLException {
    this.url = new URL(url);
}

private void connect() throws IOException {
    connection = url.openConnection();
    date = connection.getDate();
--> expiration = connection.getExpiration();
    length = connection.getContentLength();
    lastModified = connection.getLastModified();
} 
```

但我有一些关于`-->`线路强制崩溃的报告：

```
java.lang.IllegalStateException: getInputStream() is not available. Is this a reentrant call?
        at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:524)
        at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHeaderField(HttpURLConnectionImpl.java:464)
        at java.net.URLConnection.getHeaderFieldDate(URLConnection.java:548)
        at java.net.HttpURLConnection.getHeaderFieldDate(HttpURLConnection.java:702)
        at java.net.URLConnection.getExpiration(URLConnection.java:426) 
```

为什么会发生此错误，我该如何避免？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:02:54.107

查看[这个 commit](http://gitorious.org/ginger/libcore/commit/c6dae581716b9362a5c7f166c80a7f2b46ed1124/diffs?diffmode=sidebyside&fragment=1)，这可能是一个糟糕的异常消息。可能是响应未能返回任何数据。您可以通过监控实际的网络流量来确认。

# xml - XML 展平重复节点

> ID：12391921
> 
> 赞同：1
> 
> 时间：2012-09-12T15:45:12.690
> 
> 标签：xml, xslt

我的项目中有以下 XML 结构。我需要编写一些东西来转置重复节点以制作扁平结构

```
<bookstore>
  <book >
    <title lang="en">Everyday Italian</title>
    <author>Giada De Laurentiis</author>
    <year>2005</year>
    <price>30.00</price>
  </book>
  <book >
    <title lang="en">Harry Potter</title>
    <author>J K. Rowling</author>
    <year>2005</year>
    <price>29.99</price>
  </book>
  <book>
    <title lang="en">Learning XML</title>
    <author>Erik T. Ray</author>
    <year>2003</year>
    <price>39.95</price>
  </book>
</bookstore> 
```

我想像这样把结构弄平

```
<bookstore>

    <bookonetitle lang="en">Everyday Italian</bookonetitle>
    <bookoneauthor>Giada De Laurentiis</bookoneauthor>
    <bookoneyear>2005</bookoneyear>
    <bookoneprice>30.00</bookoneprice>

    <booktwotitle lang="en">Harry Potter</booktwotitle>
    <booktwoauthor>J K. Rowling</booktwoauthor>
    <booktwoyear>2005</booktwoyear>
    <booktwoprice>29.99</booktwoprice>

    <bookthreetitle lang="en">Learning XML</bookthreetitle>
    <bookthreetitle>Erik T. Ray</bookthreetitle>
    <bookthreetitle>2003</bookthreetitle>
    <bookthreetitle>39.95</bookthreetitle>

</bookstore> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:22:09.423

你的输出结构让我觉得很尴尬。你可能想重新考虑一下。但无论如何，这个 XSLT 1.0 样式表...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />
<xsl:strip-space elements="*" />

<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="book">
  <xsl:apply-templates select="node()"/>
</xsl:template>

<xsl:template match="book/*">
  <xsl:element name="book-{count(../preceding-sibling::book)+1}-{local-name()}">
    <xsl:apply-templates select="@*|node()"/>
  </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

...将您的样本输入转换为...

```
<bookstore>
  <book-1-title lang="en">Everyday Italian</book-1-title>
  <book-1-author>Giada De Laurentiis</book-1-author>
  <book-1-year>2005</book-1-year>
  <book-1-price>30.00</book-1-price>
  <book-2-title lang="en">Harry Potter</book-2-title>
  <book-2-author>J K. Rowling</book-2-author>
  <book-2-year>2005</book-2-year>
  <book-2-price>29.99</book-2-price>
  <book-3-title lang="en">Learning XML</book-3-title>
  <book-3-author>Erik T. Ray</book-3-author>
  <book-3-year>2003</book-3-year>
  <book-3-price>39.95</book-3-price>
</bookstore> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T03:46:30.740

根据 Michael Kay 的评论，您最好的选择是使用 XSLT 2.0 指令：

```
<xsl:number value="$n" format="w"/> 
```

**但是，如果您不能使用 XSLT 2.0 并且书籍数量有限**并且预先知道限制，那么可以使用这样的解决方案：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" exclude-result-prefixes="my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:numbers>
   <num>one</num>
   <num>two</num>
   <num>three</num>
   <num>four</num>
   <num>five</num>
   <num>six</num>
   <num>seven</num>
   <num>eight</num>
   <num>nine</num>
   <num>ten</num>
   <num>eleven</num>
   <num>twelve</num>
 </my:numbers>

 <xsl:variable name="vNumbers" select="document('')/*/my:numbers/*"/>

 <xsl:template match="/*">
  <bookstore><xsl:apply-templates/></bookstore>
 </xsl:template>
 <xsl:template match="book">
  <xsl:apply-templates select="*">
   <xsl:with-param name="pPos" select="position()"/>
  </xsl:apply-templates>
  <xsl:text>&#xA;</xsl:text>
 </xsl:template>

 <xsl:template match="book/*">
   <xsl:param name="pPos"/>

   <xsl:element name="book{$vNumbers[$pPos]}{name()}">
     <xsl:copy-of select="@*|node()"/>
   </xsl:element>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<bookstore>
  <book >
    <title lang="en">Everyday Italian</title>
    <author>Giada De Laurentiis</author>
    <year>2005</year>
    <price>30.00</price>
  </book>
  <book >
    <title lang="en">Harry Potter</title>
    <author>J K. Rowling</author>
    <year>2005</year>
    <price>29.99</price>
  </book>
  <book>
    <title lang="en">Learning XML</title>
    <author>Erik T. Ray</author>
    <year>2003</year>
    <price>39.95</price>
  </book>
</bookstore> 
```

**产生了想要的正确结果**：

```
<bookstore>
   <bookonetitle lang="en">Everyday Italian</bookonetitle>
   <bookoneauthor>Giada De Laurentiis</bookoneauthor>
   <bookoneyear>2005</bookoneyear>
   <bookoneprice>30.00</bookoneprice>

   <booktwotitle lang="en">Harry Potter</booktwotitle>
   <booktwoauthor>J K. Rowling</booktwoauthor>
   <booktwoyear>2005</booktwoyear>
   <booktwoprice>29.99</booktwoprice>

   <bookthreetitle lang="en">Learning XML</bookthreetitle>
   <bookthreeauthor>Erik T. Ray</bookthreeauthor>
   <bookthreeyear>2003</bookthreeyear>
   <bookthreeprice>39.95</bookthreeprice>

</bookstore> 
```

# android - WebView 中没有软键盘

> ID：12391923
> 
> 赞同：0
> 
> 时间：2012-09-12T15:45:19.373
> 
> 标签：android

我的 android 应用程序有一个 webview。我在哪里加载网页以提供用户名和密码。但现在一个问题是没有软键盘没有出现。请帮助任何人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T15:51:48.167

可以帮助你这个代码：

```
 webView.requestFocus(View.FOCUS_DOWN);
 webView.setOnTouchListener(new View.OnTouchListener()
   {
    @Override
     public boolean onTouch(View v, MotionEvent event)
    {
      switch (event.getAction())
      {
        case MotionEvent.ACTION_DOWN:
        case MotionEvent.ACTION_UP:
            if (!v.hasFocus())
            {
                v.requestFocus();
            }
            break;
       }
      return false;
    }
   }); 
```

# mod-rewrite - 自定义查询参数而不将它们附加到 URL

> ID：12391924
> 
> 赞同：0
> 
> 时间：2012-09-12T15:45:19.980
> 
> 标签：mod-rewrite, url-rewriting, yii, url-routing

我有`'urlFormat'=>'path'`和`'showScriptName'=>false`在`urlManager`.

我有代理/读取作为控制器/动作和 article=>some_name 作为参数。

每当我创建一个链接时，例如： $this->createUrl('proxies/read', array('article'=>$name));

结果是以下类型的 URL：

```
proxies/read?article=socks5_proxy_list 
```

我想转储查询参数并重新格式化 URL，如下所示：

```
controller/action/param_name/param_value 
```

在这种情况下，这将是：

```
proxies/read/article/socks5_proxy_list 
```

我目前的“规则”如下所示：

```
'rules'=>array(
  '<controller:\w+>/<id:\d+>'=>'<controller>/view',
  '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
  '<controller:\w+>/<action:\w+>/article/<article:\w+>'=>'<controller>/<action>/article/<article>',
  '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
), 
```

但他们似乎没有工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:51:16.293

1.  使这项工作的捷径：

    ```
    $this->createUrl('proxies/read/article/'.$name); 
    ```

    并在没有您的自定义规则的情况下保留 urlManager 规则。

2.  其他方式：

    ```
    // urlManager
    'rules'=>array(// order of rules is also important
      '<controller:\w+>/<action:\w+>/article/<article:\w+>'=>'<controller>/<action>',
      '<controller:\w+>/<id:\d+>'=>'<controller>/view',
      '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
      '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
    ), 
    ```

    在上面的数组中，我只是将新规则放在开头，以确保在遇到这种模式时应用该规则。如果您有其他规则，则只需确保此规则出现在可以匹配模式的更通用规则之前。经验法则：更具体的规则应该出现在一般规则之前。

    在视图中创建 url：

    ```
    $this->createUrl('proxies/read', array('article'=>$name)); 
    ```

3.  如果您不需要任何默认的“[用户友好的 url](http://www.yiiframework.com/doc/guide/1.1/en/topics.url#user-friendly-urls "http://www.yiiframework.com/doc/guide/1.1/en/topics.url#user-friendly-urls") ”规则，而只需要路径格式的 url，那么您只需指定`'urlFormat'=>'path'`并将`'rules'`数组留空或一起省略即可。

如果您还没有阅读权威指南中的[URL 管理指南，请阅读。](http://www.yiiframework.com/doc/guide/1.1/en/topics.url "http://www.yiiframework.com/doc/guide/1.1/en/topics.url")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:49:02.620

不需要规则。。

[http://yourhost.com/mycontroller/dosomething/param1/value/param2/value](http://yourhost.com/mycontroller/dosomething/param1/value/param2/value)

```
class MyController extends Controller {
   public function actionDosomething($param1, $param2) {
   }
} 
```

至于 createUrl()。给它一个 key=>value 参数数组作为第二个参数

[http://www.yiiframework.com/doc/api/1.1/CController#createUrl-detail](http://www.yiiframework.com/doc/api/1.1/CController#createUrl-detail)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T17:18:39.000

试试这些规则

```
'rules'=>array(
  '<controller:\w+>/<id:\d+>'=>'<controller>/view',
  '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',  
  '<controller:\w+>/<action:\w+>/*'=>'<controller>/<action>',
), 
```

# c# - 使用 PerCall，程序集是在 WCF 中加载一次还是每次调用？

> ID：12391927
> 
> 赞同：1
> 
> 时间：2012-09-12T15:45:26.620
> 
> 标签：c#, .net, wcf

我有一个`WCF service`配置为`PerCall`. 每次调用都会建立`Entity Framework`与后端数据库的连接，并将加载一系列程序集。

程序集的加载是如何工作的`WCF`，它们会在每次调用时加载，还是在服务的每个生命周期加载一次？

在这方面改用是否有任何好处`PerSession`，或者这不是问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:51:37.983

仅加载 dll 的一份副本。

不同之处在于内存中的对象实例和与数据库的连接。

例如，如果您的解决方案有一个与数据库建立连接的 dll。假设服务器刚刚重新启动。每次通话：

*   调用 1 进来的 DLL 将被加载到内存中并 JIT 编译
*   将创建一个服务实例
*   将创建到数据库的连接
*   然后这个调用完成
*   连接将被释放到连接池
*   服务的实例将被释放，垃圾收集器将清理它。
*   然后呼叫 2 和 3 同时进来
*   加载了 dll 并编译了 JIT，因此这里没有工作
*   将为 2 和 3 创建 2 个实例
*   将从连接池中检索一个连接
*   将创建一个连接
*   然后调用完成
*   连接将被释放到连接池
*   服务的实例将被释放，垃圾收集器将清理它。

始终是第一次命中时 JIT 编译的 DLL 的单个副本。

*   每个呼叫，每次呼叫的一个实例，在呼叫结束时处置。
*   Per Session，每个会话的一个实例，在会话到期时释放
*   Single，单个实例

# .net - 防止在 .NET 数据表中的 RowChanging 中触发 RowChanged 事件

> ID：12391929
> 
> 赞同：0
> 
> 时间：2012-09-12T15:45:31.770
> 
> 标签：.net, datatable

在我们的应用程序中，我们正在向数据表中添加一行。我想在将行添加到表之前对其进行验证，如果数据不符合业务要求，则不会添加该行。我认为 RowChanging 甚至是我需要添加验证代码的地方。但是，如何防止该行被添加到 DataTable 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T16:19:17.610

我认为可以阻止在`RowChanging`事件处理程序中添加行的唯一方法是抛出异常：

```
if (e.Action == DataRowAction.Add) {
    if (e.Row["SomeColumn"].ToString() == "AnInvalidValue") {
        throw new InvalidOperationException("You can't do that.");
    }
} 
```

您显然必须捕获此异常并优雅地处理它。

更好的方法是在尝试添加新的`DataRow`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-01T19:58:08.987

假设我们有一个 DataGridView。您必须使用 dataGridView1_RowValidating 事件。一个简单的代码如下：

私人无效dataGridView1_RowValidating（对象发送者，DataGridViewCellCancelEventArgs e）{

```
 if (dataGridView1.IsCurrentRowDirty==true)
        {
            if (dataGridView1.Rows[e.RowIndex].Cells["FirstName"].Value.ToString() == "")
            e.Cancel = true;
            MessageBox.Show("Please enter Student FirstName");
        }
    } 
```

# c# - ASP.NET MVC Web Api 重用

> ID：12391935
> 
> 赞同：-3
> 
> 时间：2012-09-12T15:45:49.110
> 
> 标签：c#, .net, asp.net-mvc-4, asp.net-web-api

在“web api”出现之前，必须执行类型的操作`JsonResult GetPersons(..)`。现在，使用 web api，可以拥有`List<Person> GetPersons(..)`.

我认为这样做的全部意义在于重新利用这些动作，即：从另一个动作（也许`ActionResult GetPersons(..)`）调用 GetPersons。

但是在许多序列化问题之后，我发现这不是一个选择。比如对象里面有一个枚举那么简单，是不能序列化为json的。

所以我最终得到了许多`dynamic X(...)`返回的匿名类型，我不能真正重用我的 API 的很多东西。有什么建议吗？

重复代码的示例如下：

杰森：

`from a in b select new { ... }`

不是 json

`from a in b`

另外，我在许多论坛中读到返回 EF 对象本身并不好，而这正是 web api 的动机（以及 [ScriptIgnore] 的存在）

问题：如何在 API 和普通控制器中重用查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T23:36:36.217

> 如何在 API 和普通控制器中重用查询？

通过不在 API 或 MVC 控制器中定义查询。您可以在 MVC 项目外部的共享程序集中定义查询，并让控制器调用该层。

例子：

**外化**

```
public interface IQuery<TResult> {}

public interface IQueryProcessor
{
    TResult Execute<TResult>(IQuery<TResult> query)
}

public class MyQueryObject : IQuery<MyEntity[]>
{
    public string QueryParam1 { get; set; }
    public int QueryParam2 { get; set; }
} 
```

**API 控制器**

```
public class MyApiController : ApiController
{
    private readonly IQueryProcessor _queryProcessor;

    public MyApiController(IQueryProcessor queryProcessor)
    {
        _queryProcessor = queryProcessor
    }

    public IEnumerable<MyApiModel> Get
        ([FromUri] string queryParam1, int queryParam2)
    {
        var query = new MyQueryObject
        {
            QueryParam1 = queryParam1,
            QueryParam2 = queryParam2,
        };
        var results = _queryProcessor.Execute(query);
        return Mapper.Map<IEnumerable<MyApiModel>>(results);
    }
} 
```

**MVC 控制器**

```
public class MyMvcController : Controller
{
    private readonly IQueryProcessor _queryProcessor;

    public MyMvcController(IQueryProcessor queryProcessor)
    {
        _queryProcessor = queryProcessor
    }

    public ViewResult Index(string queryParam1, int queryParam2)
    {
        var query = new MyQueryObject
        {
            QueryParam1 = queryParam1,
            QueryParam2 = queryParam2,
        };
        var results = _queryProcessor.Execute(query);
        var models = Mapper.Map<IEnumerable<MyViewModel>>(results);
        return View(models);
    }
} 
```

# php - PHP simplexls - 获取列标题但没有单元格数据

> ID：12391936
> 
> 赞同：0
> 
> 时间：2012-09-12T15:46:09.277
> 
> 标签：php

使用 simplexls 类 v0.4 运行 PHP v5.3.10，在加载电子表格后，维度（即行数和列数）关闭。

这些行确实包含列标题，但所有数据行都是空的，即使电子表格中有数据。

以下是用于说明目的的一小部分输出样本。任何想法为什么我没有得到任何实际的细胞数据？

```
Array
(
    [0] => cheyco.xlsx
)
Sheets count is: 7
i = 1:

Dimensions(1) returns:
Array
(
    [0] => 4
    [1] => 5
)

Rows(1) returns:
Array
(
    [0] => Array
        (
            [0] => Facility Code
            [1] => Site ID
            [2] => Name
            [3] => Description
        )

    [1] => Array
        (
            [0] =>
        )

    [2] => Array
        (
            [2] =>
        )

)
i = 2:

Dimensions(2) returns:
Array
(
    [0] => 5
    [1] => 29
)

Rows(2) returns:
Array
(
    [0] => Array
        (
            [0] => Unit Code
            [1] => Facility Code
            [2] => Type (I,E,O)
            [3] => Name
            [4] => Description
        )

    [1] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [2] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [3] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [4] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [5] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [6] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        )

    [7] => Array
        (
            [0] =>
            [1] =>
            [3] =>
        ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T15:18:25.090

事实证明，SimpleXLS 无法读取较新的 .xlsx 格式。以以前的 .xls 格式保存文档解决了该问题。

# jquery - 如何从嵌套 JSON 字符串中的数组中检索值？

> ID：12391939
> 
> 赞同：1
> 
> 时间：2012-09-12T15:46:14.913
> 
> 标签：jquery, json

如何从`name":"offset","values":["90"]`这个 JSON 字符串中的数组 paramList（在开头）中检索值 90？

```
{"query":{"query":"skole","hits":10,"paramList":[{"name":"hits","values":["10"]},{"name":"offset","values":["90"]},{"name":"q","values":["skole"]}]},"status":"success","facets":[{"selectionType":"AND","numberOfItems":1,"selectableItems":[{"value":"Intranett","displayName":"Intranett","count":146,"paramId":"?hits=10&q=skole&kilde=Intranett"}],"appliedItems":[],"facetName":"Kilde"},{"selectionType":"AND","numberOfItems":4,"selectableItems":[{"value":"EPiServerPage","displayName":"EPiServerPage","count":90,"paramId":"?hits=10&q=skole&type_s=EPiServerPage"},{"value":"Word","displayName":"Word","count":51,"paramId":"?hits=10&q=skole&type_s=Word"},{"value":"ClubNews","displayName":"ClubNews","count":4,"paramId":"?hits=10&q=skole&type_s=ClubNews"},{"value":"Project","displayName":"Project","count":1,"paramId":"?hits=10&q=skole&type_s=Project"}],"appliedItems":[],"facetName":"Type"}],"suggestions":{"displayName":"spellingSuggestion","suggestions":null,"collatedSuggestion":{"suggestion":null,"paramId":"?q=null"}},"errors":[],"numberOfHits":146,"pagination":{"offset":90,"first":{"displayName":"1","selected":false,"end":10,"start":1,"paramId":"?hits=10&q=skole&offset=1"},"next":{"displayName":"11","selected":false,"end":109,"start":100,"paramId":"?hits=10&q=skole&offset=100"},"hitsPerPage":10,"paginationItems":[{"displayName":"5","selected":false,"end":49,"start":40,"paramId":"?hits=10&q=skole&offset=40"},{"displayName":"6","selected":false,"end":59,"start":50,"paramId":"?hits=10&q=skole&offset=50"}, ..... 
```

为了检索元素查询（第一行的开头），我使用`{$T.query.query}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:49:18.043

`$T.query.query.paramList[1].values[0]`假设结构不会改变

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T15:49:51.260

~~`var val = jsonArray["query"]["paramList"][1]["values"];`~~

```
var q = jsonArray["query"]["paramList"];

var values = q.map(function(){

    return values[0];

});

var index = values.indexOf(90); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:51:09.990

如果您只查找该特定值并且知道它在 JSON 中的位置，则可以使用：

```
var json = 'YOUR JSON STRING HERE';
var obj = $.parseJSON(json);
var value = obj.query.paramList[1].values[0]; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-12T15:51:13.363

您的 JSON 已评估

```
JSON.query.paramList[1].values.[0]; 
```

返回 90。

# windows - Documents 中的 Subversion 目录的文件结构已损坏

> ID：12391948
> 
> 赞同：1
> 
> 时间：2012-09-12T15:46:34.467
> 
> 标签：windows, svn

当我的项目的龟 svn 文件夹在我的 Documents 文件夹中时，它会显示许多奇怪的 svn 类型文件，并且没有目录结构，只有一个杂乱的文件夹中的所有内容。但是，当我从 Documents 中剪切并粘贴目录说 c:\ 时，我看到文件和文件夹很好，没有所有颠覆奇怪的文件？！？我有 Windows 7 Pro，64 位。我想给出奇怪文件的图像，但需要 10 个代表....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T14:24:28.307

在相关 Document 目录的右上角，确保**Arrange by:**设置为**Folder**而不是**Name**。

或者，按**Alt**打开菜单栏，然后​​选择**查看 -> 排列方式 -> 文件夹**

**Name**视图将所有内容整合到一个平面结构中，并显示隐藏的 .svn 目录中包含的非隐藏文件。

# r - 当变量名称存储在字符向量中时选择/分配给 data.table

> ID：12391950
> 
> 赞同：98
> 
> 时间：2012-09-12T15:46:41.620
> 
> 标签：r, data.table

`data.table`如果变量名称存储在字符向量中，您如何引用变量？例如，这适用于`data.frame`：

```
df <- data.frame(col1 = 1:3)
colname <- "col1"
df[colname] <- 4:6
df
#   col1
# 1    4
# 2    5
# 3    6 
```

如何对 data.table 执行相同的操作，无论是否使用`:=`符号？显而易见的事情`dt[ , list(colname)]`不起作用（我也没想到）。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-09-12T16:05:27.197

*以编程方式选择*变量的两种方法：

1.  `with = FALSE`：

    ```
     DT = data.table(col1 = 1:3)
     colname = "col1"
     DT[, colname, with = FALSE] 
     #    col1
     # 1:    1
     # 2:    2
     # 3:    3 
    ```

2.  'dot dot' ( `..`) 前缀：

    ```
     DT[, ..colname]    
     #    col1
     # 1:    1
     # 2:    2
     # 3:    3 
    ```

有关 'dot dot' ( `..`) 表示法的进一步说明，请参阅[1.10.2 中的新功能](https://github.com/Rdatatable/data.table/blob/master/NEWS.md#changes-in-v1102--on-cran-31-jan-2017)（目前未在帮助文本中描述）。

要*分配*给变量，请将 LHS`:=`括在括号中：

```
DT[, (colname) := 4:6]    
#    col1
# 1:    4
# 2:    5
# 3:    6 
```

后者称为列*plonk*，因为您通过引用替换了整个列向量。如果存在子集`i`，它将通过引用进行子分配。周围的括号`(colname)`是 CRAN 2014 年 10 月 v1.9.4 版本中引入的简写。这是[新闻](https://github.com/Rdatatable/data.table/blob/master/NEWS.0.md#changes-in-v194--on-cran-2-oct-2014)：

> 现在在所有情况下都不推荐使用`with = FALSE`with ，因为一段时间以来一直首选用括号包裹 LHS 。`:=``:=`

> ```
> colVar = "col1" 
> ```

```
DT[, (colVar) := 1]                             # please change to this
DT[, c("col1", "col2") := 1]                    # no change
DT[, 2:4 := 1]                                  # no change
DT[, c("col1","col2") := list(sum(a), mean(b))]  # no change
DT[, `:=`(...), by = ...]                       # no change 
```

另见**详细信息**部分`?`:=``：

```
DT[i, (colnamevector) := value]
# [...] The parens are enough to stop the LHS being a symbol 
```

* * *

并在评论中回答进一步的问题，这是一种方法（像往常一样有很多方法）：

```
DT[, colname := cumsum(get(colname)), with = FALSE]
#    col1
# 1:    4
# 2:    9
# 3:   15 
```

`eval`或者，您可能会发现仅对a进行读取、写入和调试更容易`paste`，类似于构造动态 SQL 语句以发送到服务器：

```
expr = paste0("DT[,",colname,":=cumsum(",colname,")]")
expr
# [1] "DT[,col1:=cumsum(col1)]"

eval(parse(text=expr))
#    col1
# 1:    4
# 2:   13
# 3:   28 
```

如果你经常这样做，你可以定义一个辅助函数`EVAL`：

```
EVAL = function(...)eval(parse(text=paste0(...)),envir=parent.frame(2))

EVAL("DT[,",colname,":=cumsum(",colname,")]")
#    col1
# 1:    4
# 2:   17
# 3:   45 
```

现在`data.table`1.8.2 自动优化`j`效率，使用该`eval`方法可能更可取。例如，`get()`in`j`阻止了一些优化。

或者，有`set()`。的低开销、函数形式`:=`，在这里会很好。见`?set`。

```
set(DT, j = colname, value = cumsum(DT[[colname]]))
DT
#    col1
# 1:    4
# 2:   21
# 3:   66 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-06-30T16:26:42.943

*这不是一个真正的答案，但我没有足够的街头信誉来发表评论：/

无论如何，对于可能希望在数据表中实际创建一个新列并将名称存储在变量中的任何人，我都有以下工作要做。我不知道它的性能。有什么改进的建议吗？假设一个无名的新列总是被命名为 V1 是否安全？

```
colname <- as.name("users")
# Google Analytics query is run with chosen metric and resulting data is assigned to DT
DT2 <- DT[, sum(eval(colname, .SD)), by = country]
setnames(DT2, "V1", as.character(colname)) 
```

请注意，我可以在 sum() 中很好地引用它，但似乎无法在同一步骤中对其进行分配。顺便说一句，我需要这样做的原因是 colname 将基于 Shiny 应用程序中的用户输入。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-05T08:33:30.833

## 通过变量或函数从 data.table 中检索多列：

```
library(data.table)

x <- data.table(this=1:2,that=1:2,whatever=1:2)

# === explicit call
x[, .(that, whatever)]
x[, c('that', 'whatever')]

# === indirect via  variable
# ... direct assignment
mycols <- c('that','whatever')
# ... same as result of a function call
mycols <- grep('a', colnames(x), value=TRUE)

x[, ..mycols]
x[, .SD, .SDcols=mycols]

# === direct 1-liner usage
x[, .SD, .SDcols=c('that','whatever')]
x[, .SD, .SDcols=grep('a', colnames(x), value=TRUE)] 
```

这都产生

```
 that whatever
1:    1        1
2:    2        2 
```

我找到了`.SDcols`最优雅的方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-17T04:04:38.663

**对于多列和应用于列值的函数。**

从函数更新值时，RHS 必须是列表对象，因此使用`.SD`with循环就`lapply`可以了。

下面的示例将整数列转换为数字列

```
a1 <- data.table(a=1:5, b=6:10, c1=letters[1:5])
sapply(a1, class)  # show classes of columns
#         a           b          c1 
# "integer"   "integer" "character" 

# column name character vector
nm <- c("a", "b")

# Convert columns a and b to numeric type
a1[, j = (nm) := lapply(.SD, as.numeric ), .SDcols = nm ]

sapply(a1, class)
#         a           b          c1 
# "numeric"   "numeric" "character" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-19T04:13:30.137

你可以试试这个：

```
colname <- as.name("COL_NAME")
DT2 <- DT[, list(COL_SUM=sum(eval(colname, .SD))), by = c(group)] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-09T08:34:14.833

在开发版本 1.14.3 中，[data.table](/questions/tagged/data.table "显示标记为“data.table”的问题")获得了一个用于*对 data.table 进行编程*的新接口，请参见[New Features](https://github.com/Rdatatable/data.table/blob/master/NEWS.md#new-features)中的第 10 项。它使用新`env =`参数。

```
library(data.table) # development version 1.14.3 used
dt <- data.table(col1 = 1:3)
colname <- "col1"

dt[, cn := cn + 3L, env = list(cn = colname)][] 
```

> ```
>  col1
>    <int>
> 1:     4
> 2:     5
> 3:     6 
> ```

# actionscript-3 - 播放视频时，Flash 投影仪显示黑屏

> ID：12391951
> 
> 赞同：1
> 
> 时间：2012-09-12T15:46:43.410
> 
> 标签：actionscript-3, flash

我正在创建一个用于演示的桌面可执行投影仪文件。

我已将 fscommand 设置为在启动时全屏显示投影仪。

一切正常，直到我们到达视频幻灯片，此时在全屏时视频幻灯片完全变黑，您无法查看任何内容。

如果退出全屏，则幻灯片可以再次查看，但视频不会显示，除非我前进幻灯片然后返回。

有谁知道为什么会这样？

```
fscommand("fullscreen", "true");

import flash.media.SoundMixer;  
import gs.TweenMax;
import gs.easing.*;

stage.addEventListener(KeyboardEvent.KEY_UP, keyHandler);

this.blendMode = BlendMode.LAYER;

stage.scaleMode = StageScaleMode.SHOW_ALL; 
```

# c# - 列表 .AddRange 导致短暂的延迟

> ID：12391956
> 
> 赞同：3
> 
> 时间：2012-09-12T15:47:03.867
> 
> 标签：c#, list, xna, profiling

我有一个实现 ICollidable 接口的实体列表。该接口用于解决实体之间的冲突。因此，我的实体是：

*   球员
*   敌人
*   弹丸
*   项目
*   瓷砖

在每次游戏更新（大约 60 t/s）时，我都会清除列表并根据游戏状态添加当前实体。我通过以下方式完成此操作：

```
collidableEntities.Clear();
collidableEntities.AddRange(players);
collidableEntities.AddRange(enemies);
collidableEntities.AddRange(projectiles);
collidableEntities.AddRange(items);
collidableEntities.AddRange(camera.VisibleTiles); 
```

一切正常，直到我将可见图块添加到列表中。运行游戏循环的前约 1-2 秒会导致可见的打嗝延迟绘制（因此我可以看到渲染中的抖动）。我可以从字面上删除/添加添加图块的行并查看抖动发生和不发生，因此我将其缩小到该行。

我的问题是，为什么？VisibleTiles 的列表大约有 450-500 个图块，所以实际上并没有那么多数据。每个图块包含一个 Texture2D（图像）和一个 Vector2（位置），以确定渲染的内容和位置。我会继续看，但从头顶看，我不明白为什么只有前 1-2 秒打嗝，但从那里开始就很顺利。

任何建议表示赞赏。

**更新**

我尝试将初始容量增加到近似数量的元素，但没有观察到差异。

**更新**

根据要求，这是 camera.VisibleTiles 的代码

```
public List<Tile>
{
    get { return this.visibleTiles; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T16:20:06.477

每当您遇到这样的性能问题时，正确的反应是不要猜测可能的原因；正确的反应是**分析应用程序**。有多种选择；我相信您可以在 StackOverflow 上找到建议。

不过，我今天感觉很幸运，所以我将无视我刚刚给你的建议，胡乱猜测。我将解释我的推理，希望对将来诊断此类问题有所帮助。

您描述的问题*仅在游戏开始时**仅发生一次*，这一事实使我相信这不是列表本身的功能或碰撞逻辑所固有的任何东西。当然，这是假设列表中的对象数量在这段时间内基本保持不变。如果它*是*由其中任何一个引起的，我希望它*每帧*都会发生。

 ***因此我怀疑**垃圾收集器**。您可能会在游戏开始时看到 GC 发生——换句话说，在您将所有大量资产加载到内存之后。您也可能会在代码中看似随机的点看到它，因为您分配的任何对象理论上都可以将其推入集合中。

我的猜测是：当你加载游戏时，你创建的资源会产生很大的收集压力，但这不足以触发收集。当您在游戏过程中分配对象时（在这种情况下，由于调整列表的大小），它会增加收集压力到 GC 最终决定激活的点，从而导致您观察到的抖动。一旦 GC 运行，并且所有适当的对象都已降级到正确的代，抖动就会停止。

正如我所说，这只是一个猜测，尽管是受过教育的。但是，它很容易测试。`GC.Collect(2)`在进入渲染循环之前添加一个调用。如果我是对的，抖动应该会消失。

如果你想比这更彻底——我强烈推荐它——微软提供了一个对调试内存问题很有用的工具，即[CLR Profiler](http://www.microsoft.com/en-us/download/details.aspx?id=16273)。该工具将准确地向您显示收集发生的时间以及原因。它对 XNA 开发非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T16:06:01.700

1-2秒可能是因为GC调整了每一代的大小。查看相应的性能计数器，看看第一秒内是否有大量的 Gen1/2 收集（最小化 GC 是游戏的有用目标）

额外的随机猜测：你所有的对象都是`struct`出于某种原因。而且很大。所以复制它们需要很长时间。（不会解释第一秒后的平滑）

笔记：

*   与其合并单个列表中的项目，不如考虑创建避免所有复制的迭代器。
*   获取分析器
*   学习查看您的流程的性能计数器。有趣的类别是内存、GC、CPU、处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:50:13.410

您可以使用[重载的构造函数`List<T>`](http://msdn.microsoft.com/en-us/library/dw8e0z9z.aspx)来初始化具有预定义大小的列表：

```
var collidableEntities = new List<object>(500); 
```***

# javascript - 下载使用 POST 数据动态生成的文件

> ID：12391958
> 
> 赞同：0
> 
> 时间：2012-09-12T15:47:10.187
> 
> 标签：javascript, rest, post, xmlhttprequest, download

我需要使用从 POST 请求中获得的一些数据生成 PDF 文件。作为对此请求的响应，我想发送生成的 PDF 文件，用户应该得到一个“将文件另存为”对话框。

这一切都应该即时发生。我不想将 PDF 保存到磁盘并通过附加请求提供它。这一切都应该发生在一个请求中。

但我不知道我怎么能做到这样的事情。如果我使用 XMLHttRequest，则无法显示“文件另存为”对话框。另一方面，如果我使用表单，我无法在没有 URL 加密开销的情况下发送 POST 数据。

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T16:09:55.207

最后，我用 2 个请求解决了它。首先将所需的数据发送到服务器并从中创建 PDF，然后返回临时文件的 ID。第二个下载pdf并删除临时文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T18:25:59.467

我通过将数据从 javascript 生成的表单字段发布到 php.ini 来做到这一点。

```
var form = $('<form method="post" action="svgoutput/convert.php"> <input type="text"  name="incomingSvgData" value="'+base64_encode(svgDataString)+'"><input type="submit" value="Submit Post"> </form> ');
form[0].submit(); 
```

对于 IE，表单在提交时位于 dom 中。

在 php 方面，我做我的生成和东西（在这种情况下为 SVG 到 PNG）并设置以下标题：

```
header("Content-Type: YOURMIMETYPE");
header("Content-Disposition: attachment; filename=YOURFILENAME.EXT");
echo YOURDATA; 
```

无需在一篇文章中显示另存为对话框即可顺利下载。如果您需要“另存为”，只需使用标题，例如此处[如何使用 PHP 显示“另存为”对话框用于文本文件](https://stackoverflow.com/questions/732063/how-to-show-save-as-dialog-box-using-php-for-text-files)

# entity-framework - EF Code First + 延迟加载，投影无法按预期工作

> ID：12391961
> 
> 赞同：3
> 
> 时间：2012-09-12T15:47:24.923
> 
> 标签：entity-framework, ef-code-first, lazy-loading, projection, eager-loading

我有这样的事情：

```
var tmp =_forumsDb.Threads
.Where(t => t.Id == variable)
.Select(t => new { Thread = t, Posts = t.Posts.Take(1) })
.Single(); 
```

现在，我希望`tmp.Thread.Posts.Count();`是 1，但它会占用我在数据库中的所有帖子。是否可以使用需要明确数量的帖子的投影，在单个查询中进行而不关闭延迟加载？

编辑：我尝试做这样的事情，但它也不起作用：

```
var tmp =_forumsDb.Threads
.Where(t => t.Id == variable)
.Select(t => new { Thread = t, Posts = t.Posts.OrderBy(p => p.DateCreated).Take(1) })
.Select(t => t.Thread)
.Single(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:31:49.650

`tmp.Thread.Posts`是为其配置了延迟加载的导航属性。由于尚未加载，因此访问它会加载所有剩余的帖子。

`tmp.Posts`不是导航属性。那是您应该能够在不触发另一个查询的情况下访问的那个。

# java - java.sql.SQLException: [Oracle][ODBC][Ora]ORA-01008: 并非所有变量都绑定

> ID：12391965
> 
> 赞同：1
> 
> 时间：2012-09-12T15:47:31.573
> 
> 标签：java, sql, jsp, jdbc

```
import java.sql.*;

class TestConnection 
{
public static void main(String args[])
{

    try
    {
        Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
        Connection con = DriverManager.getConnection("jdbc:odbc:ram","myuser","myuser");

        Statement st = con.createStatement();
        st.executeUpdate("insert into student values( &stno, &sname, &course, &fees); ");
        System.out.println("1 row Inserted");

        con.close();
    }
    catch(Exception P)
    {
        P.printStackTrace();
    }
} 
```

}

我已经创建了表格，我想从键盘输入输入，但是我收到以下错误请帮助我......

```
java.sql.SQLException: [Oracle][ODBC][Ora]ORA-01008: not all variables bound
at sun.jdbc.odbc.JdbcOdbc.createSQLException(Unknown Source)
at sun.jdbc.odbc.JdbcOdbc.standardError(Unknown Source)
at sun.jdbc.odbc.JdbcOdbc.SQLExecDirect(Unknown Source)
at sun.jdbc.odbc.JdbcOdbcStatement.execute(Unknown Source)
at sun.jdbc.odbc.JdbcOdbcStatement.executeUpdate(Unknown Source)
at TestConnection.main(TestConnection.java:13) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:52:41.163

您应该使用`PreparedStatement`和 设置参数，如下所示：

```
import java.sql.*;

class TestConnection 
{
    public static void main(String args[])
    {
        int stno = Integer.parseInt(args[0]);
        String name = args[1];
        String course = args[2];
        double fees = Double.parseDouble(args[3]);

        try
        {
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
            Connection con = 
                DriverManager.getConnection("jdbc:odbc:ram","myuser","myuser");
            PreparedStatement st = 
                con.prepareStatement("insert into student values(?, ?, ?, ?)");
            st.setInt(1, stno);
            st.setString(2, name);
            st.setString(3, course);
            st.setDouble(4, fees);
            // executeUpdate returns the number of rows inserted/updated/deleted.
            int count = st.executeUpdate();
            System.out.println(count + " row(s) inserted.");
            con.close();
        }
        catch(Exception P)
        {
            P.printStackTrace();
        }
    }
} 
```

# qtranslate - qTranslate 和 Wordpress 功能

> ID：12391969
> 
> 赞同：4
> 
> 时间：2012-09-12T15:47:46.903
> 
> 标签：qtranslate

我在 Wordpress 网站上使用 qTranslate，但在某些情况下将其中的一些部分用于 Wordpress 功能时遇到了一些麻烦。例如，当我想在查询中包含“阅读更多链接”时，我可以这样做：

```
echo _e('[:en]Read More_[:ru]читать далее_'); 
```

（也就是说，它看起来像是在回声，所以我可能做的不对，即使它似乎有效）。

但我不能完全弄清楚这个的语法：

```
echo comments_number( '<div class="noComment"></div>No Comments', '<div class="oneComment"></div>One Comment', '<div class="oneComment"></div>% Comments' ); 
```

我如何输入这些翻译？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T10:53:50.830

试试这个：

```
echo comments_number(
    qtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage('<div class="noComment"></div>[:en]No Comments[:es]No comentarios'), 
    qtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage('<div class="oneComment"></div>[:en]One Comment[:es]Uno comentario'), 
    qtrans_useCurrentLanguageIfNotFoundUseDefaultLanguage('<div class="oneComment"></div>[:en]% Comments[:es]% comentarios)' 
); 
```

# javascript - 多个可观察对象多次触发的问题

> ID：12391972
> 
> 赞同：1
> 
> 时间：2012-09-12T15:47:57.190
> 
> 标签：javascript, pagination, ember.js

在 Ember.js 中，我有一个调用 json 请求的 Controller 属性函数，它需要有多个 observable，因为有多个条件需要更新 json 数据。

当仅观察到一个属性发生更改时，这很有效，但是，当多个属性发生更改时，这会导致 json 请求使用相同的请求多次触发。如何将此功能触发的次数限制为一次？

我将问题保持一般性，以便将其应用于其他未来的案例，但是，如果它是相关的，我使用它的情况是分页的情况，我需要观察页面索引，页面大小，排序依据和排序顺序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T11:03:39.490

最简单的方法是在控制器即将发出请求时在控制器上设置一个标志，在请求完成时清除它，并在观察者中检查该标志以决定是否生成 ajax 请求。

# entity-framework - 如何使用 EntityFramework 插入数据？

> ID：12391973
> 
> 赞同：0
> 
> 时间：2012-09-12T15:47:58.693
> 
> 标签：entity-framework

如何使用 将数据插入我的数据库`Entity Framework`？

我正在尝试下面的代码，但是，在方法中`AddObject`我必须传递 2 个参数：

*   字符串实体集名称
*   对象实体

是什么`entitySetName`？这`object entity`是我的模型吗？

`EntityNetimoveis.San2011Entities db = new EntityNetimoveis.San2011Entities();` `Model.Gerenciar.UsuarioCurso us = new Model.Gerenciar.UsuarioCurso();`

```
public void ProcessRequest(HttpContext context)
    {
        context.Response.ContentType = "text/plain";
try
    {
        us.Usuario_Id = Convert.ToInt32(context.Request["id"]);
        db.San_UsuarioCurso.Context.AddObject(us);
        db.SaveChanges();
        context.Response.Write("ok");
    }
    catch (Exception e)
    {
        context.Response.Write("");            
    }            
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:58:33.980

在您的情况下，它是您的 ObjectSet 的名称`San_UsuarioCurso`。

但是，您在参考文献中来回走动。

在 `db.San_UsuarioCurso.Context.`你引用你的上下文 (db) 然后转到你的对象集 (San_UsuarioCurso) 然后**回到**你的上下文 (Context)。

您可以像这样直接添加到对象集，而不必定义实体集的名称：

```
db.San_UsuarioCurso.AddObject(us); 
```

或者，如果您想使用您的功能，这也应该有效：

```
db.San_UsuarioCurso.Context.AddObject("San_UsuarioCurso", us) 
```

# postgresql - postgres 选择结果

> ID：12391979
> 
> 赞同：0
> 
> 时间：2012-09-12T15:48:26.683
> 
> 标签：postgresql, select, sequence

如果表中的数据是：

```
select * from data;

 key  | value                    
------+---------
 a    | a_value
 b    | b_value
 c    | c_value
 d    | d_value
 e    | e_value
 f    | f_value 
```

如果一个客户端连接到我的 Web 服务器并询问 a 的值，我的应用程序将尝试执行以下操作：

```
select value where key = 'c'; 
```

并将结果值发送给客户端

如果 3 个客户端连接到我的 Web 服务器，则会出现 3 个语句，

```
 select value where key = 'e';  # client 1

  select value where key = 'c';  # client 2

  select value where key = 'a';  # client 3 
```

出于资源原因，我想将许多语句合并到一个 select 语句中。

```
select * where key = 'e' or key = 'c' or key = 'a';

 key  | value                    
------+---------
 a    | a_value
 c    | c_value
 e    | e_value 
```

但问题是结果的顺序与我的 WHERE 子句不同。所以我无法将结果与客户的查询区分开来。如果我想将价值发送回客户

```
'e_value' to client 1
'c_value' to client 2
'a_value' to client 3 
```

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:04:12.483

我不太了解您的用例，但是像下面这样的查询使您能够

1.  .. 以预定义的顺序获取结果
2.  .. 识别结果集中的行

```
SELECT v.*, d.value
FROM   data
JOIN  (
   VALUES
     (1::int, 'e'::text)  -- explicit cast may not be necessary
    ,(2, 'c')
    ,(3, 'a')
    ) v(client, key) USING (key)
ORDER  BY v.client; 
```

回报：

```
client | key | value
-------+-----+------
1      | e   | e_value
2      | c   | c_value
3      | a   | a_value 
```

# java - 工厂模式示例 - 需要解决以下代码

> ID：12391984
> 
> 赞同：1
> 
> 时间：2012-09-12T15:48:36.550
> 
> 标签：java, design-patterns

```
package com.factory;

import java.util.HashMap;
import java.util.Map;

//Factory class
class FactoryClass {
        Map products = new HashMap();

        void registerProduct(String prodId, ProductInt prodInterface) {
            products.put(prodId, prodInterface);
        }

        ProductInt createProduct(String prodId) {
            return ((ProductInt) products.get(prodId)).createProduct();
        }
}    

// Client
public class FactoryPattern {
    public static void main(String[] args) {
        FactoryClass factory = new FactoryClass();
        factory.createProduct("pen");
    }
} 
```

* * *

```
package com.factory;

//Interface Product
public interface ProductInt {
    ProductInt createProduct();
}

// Concrete Product-1
class Pen implements ProductInt {
    static {
        FactoryClass factory = new FactoryClass();
        factory.registerProduct("pen", new Pen());
    }

    public ProductInt createProduct() {
        return new Pen();
    }
}

// Concrete Product-2
class Pencil implements ProductInt {
    static {
        FactoryClass factory = new FactoryClass();
        factory.registerProduct("pencil", new Pencil());
    }
    public ProductInt createProduct() {
        return new Pencil();
    }

} 
```

当我运行此代码时，我得到空指针，因为在 hashmap 中没有注册任何产品。因此，当我请求“铅笔”的产品实例时，它找不到任何键来返回具体的 Pencil 类对象。任何人都可以帮我编写这个代码——就像工厂和具体类之间不应该有任何直接关系，以便注册将保留在工厂类之外，我应该得到我请求的正确的具体类对象？

谢谢巴拉吉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:23:48.303

几个问题：

首先，工厂方法应该`static`与正在创建的类位于或位于不同的类中。因此，拥有`interface`其唯一的方法是创建接口的实例是不合逻辑的。您可能会`InterfaceA`创建一个实例，`InterfaceB`或者接口是通用`FactoryInterface<X>`的并创建`X`. 查看 Guava 的 [供应商](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Supplier.html)界面

举个例子，`Pen`... 不能调用`Pen.createProduct()`，除非你已经有一个实例，`Pen`因为该方法不是静态的。

因此，鉴于上述情况，请考虑让您`Factory`使用`Producer<X>`or`Supplier<X>`创建`X`.

其次，考虑将您的工厂类设为 a `Singleton`。您遇到的问题是每个静态初始化都会创建一个新的工厂实例，该实例会立即被丢弃。因此，当您稍后尝试获取映射值时，您会从与注册它的实例不同的实例中获取它。

最后，在以某种方式使用/触及类之前，不会调用类的静态初始化器。您需要调用某些东西`Pen`并`Pencil`让它们的静态初始化程序块被调用，从而注册它们自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:11:50.383

您正在创建您的单独实例`FactoryClass`- 每个实例都有自己的`Map products`实例 - 您在`main()`方法中创建的工厂与您创建和注册的工厂`pen`不同`pencil`。显然没有在`FactoryClass.products`.

一种方法是`Map products`在你的`FactoryClass`as中声明`static`- 这将解决你的直接问题 - 即使作为一个整体，你的代码似乎需要在其他地方进行其他改进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-04T12:43:17.857

除了上面的答案[http://www.oodesign.com/factory-pattern.html](http://www.oodesign.com/factory-pattern.html)说：我们必须确保在工厂要求注册之前加载具体的产品类（如果它们不是加载它们将不会在工厂中注册，并且 createProduct 将返回 null）。为了确保这一点，我们将在主类的静态部分使用 Class.forName 方法。

```
class Main {

static
{
    try
    {
        Class.forName("OneProduct");
        Class.forName("AnotherProduct");
    }
    catch (ClassNotFoundException any)
    {
        any.printStackTrace();
    }
}
public static void main(String args[]) throws PhoneCallNotRegisteredException
{
    ...
}
} 
```

# java - When running Groovy scripts using the groovy-all jar, how do you specify a classpath?

> ID：12391985
> 
> 赞同：10
> 
> 时间：2012-09-12T15:48:37.767
> 
> 标签：java, groovy, classpath

I've found an example for running Groovy scripts on systems that do not have Groovy installed using the groovy-all jar file. I attempted the following:

```
java -cp src:.:lib/* -jar lib/groovy-all-2.0.1.jar src/com/example/MyScript.groovy 
```

The trouble is my script depends on jars in the lib directory plus two other Groovy script files located in src/com/examples. When I run this, it complains about the import statements for all of them. I can run it on a system that has Groovy installed fine by using the following:

```
CLASSPATH="src:.:lib/*" groovy src/com/example/MyScript.groovy 
```

How do I run Groovy scripts this way, using the groovy-all jar, as well as give it a classpath?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-12T22:35:23.233

You can't combine both `-jar` and `-cp` in a `java` command, so you need to name the main class explicitly. Looking at the manifest of the `groovy-all` JAR, the main class name is `groovy.ui.GroovyMain`, so you need

```
java -cp 'src:.:lib/*' groovy.ui.GroovyMain src/com/example/MyScript.groovy 
```

(if groovy-all were not already covered by `lib/*` you would need to add that to the `-cp` as well).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T21:11:51.377

One way is to compile the Groovy files to "*.class" files. Then include the jar from the $GROOVY_HOME/embeddable directory and put it on the classpath.

Here is a minimalist example (the first line is a simple Unix copy; use whatever works for you):

```
$ cp /some-dir/groovy-1.8.5/embeddable/* . 
$ groovyc Test.groovy 
$ java -cp . groovy-all-1.8.5.jar Test 
```

For typical distribution, you would use Ant/Maven/Gradle to build your own jar file with the compiled Groovy (i.e. class files) in it.

# google-bigquery - bigquery“下载为 CSV”的真正行限制是多少？

> ID：12391986
> 
> 赞同：1
> 
> 时间：2012-09-12T15:48:38.823
> 
> 标签：google-bigquery

BigQuery [Browser 工具文档](https://developers.google.com/bigquery/docs/browser_tool#exportdata)提到了 CSV 导出的限制：

> 如果查询结果集的行数少于 16,000，您可以将其下载为 CSV 文件。

我们已经尝试过此功能，但限制似乎远小于 16,000 行。使用此查询：

```
SELECT 
  contract_id,
  product,
  AVG(element_value)
FROM [******.payout]
GROUP BY contract_id, product
LIMIT 600; 
```

UI 响应错误：

> 此结果集包含太多行，无法直接下载。请使用“另存为表格”，然后导出...

如果我将 LIMIT 减少到 500，则 CSV 下载有效。

您能否确认实际的行数限制。文档是否已过时，或者这是查询界面中的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:21:39.450

这是 UI 中的一个错误——以 CSV 格式下载最多可以处理 16k 行（或 10 MB 的结果）。这已在内部修复，修复应该会在下周发布。

# ios - 当键盘启动时，滚动视图在缩放时滚动，即使我没有更改 contentOffset

> ID：12391991
> 
> 赞同：1
> 
> 时间：2012-09-12T15:49:00.943
> 
> 标签：ios, ipad, uiscrollview

当键盘打开时，如果滚动视图已经缩放，滚动视图的 X 位置会自动移动。我没有更改 contentOffset。但是当键盘向上时，滚动视图仍然在移动。

我从未更改 contentOffset 或任何其他滚动视图位置，但滚动视图将自身移动到另一个 X 位置。

# upgrade - Umbraco - 升级到 4.5.2 后无法导航到内容以外的部分

> ID：12391996
> 
> 赞同：0
> 
> 时间：2012-09-12T15:49:14.287
> 
> 标签：upgrade, umbraco

我尝试在 Umbraco 论坛上发布此内容，但无济于事。希望能在这里得到一些帮助。

我以为我从 4.0.4.2 成功升级到 4.5.2（正在升级到 4.8...），因为我没有收到任何错误，而且一切似乎都很顺利。但是，在后台，当我单击 Content 以外的任何部分时，我会被重定向回 Content。我可以通过在# 符号之后输入每个部分的名称来手动访问每个部分，例如：#media，但是一旦我单击一个树项目，它就会将我重定向回 Content。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T16:11:48.253

2个想法：

1.  您正在浏览器中缓存一些旧的 javascript。尝试清除缓存。IE在这方面可以固执己见；最好在 Chrome 中尝试。

2.  就个人而言，如果您的站点在 4.5.2 下运行，我不会担心后台问题，只需继续升级到 4.8.1。无论如何，那里可能会有新的问题需要解决:) 并且后台问题可能会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:24:15.733

通过以下脚本更新图标解决了这个问题。链接必须在 appIcon 字段之外运行。不确定为什么通过 4.5.2 升级更新数据库时不执行此操作。

update umbracoApp set appIcon = '.tray' + appAlias where appAlias IN ('content','media','users','settings','developer','member')