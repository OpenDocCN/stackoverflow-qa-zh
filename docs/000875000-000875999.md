# StackOverflow 问答 000875000-000875999

# sql - 查找源代码管理中缺少的 SQL 对象

> ID：875009
> 
> 赞同：0
> 
> 时间：2009-05-17T17:06:37.753
> 
> 标签：sql, version-control

我们使用 Source Safe 并正在迁移到 Source Gear。我们知道我们有 sql 对象（过程、触发器、视图、函数）在 sql 中，但从未添加到源代码存储库中。追捕那些以便我添加它们的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T17:08:39.080

创建一个空数据库并在其上执行所有 SourceSafe 脚本。

然后运行[​​Sql Compare](http://www.red-gate.com/products/SQL_Compare)以查看缺少的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-07T11:40:12.793

SQL Source Control 有一个早期访问版本，它将您在 SSMS 中的数据库链接到 SourceGear Vault。这可以使源代码控制您的数据库更容易前进，[http://www.red-gate.com/messageboard/viewtopic.php](http://www.red-gate.com/messageboard/viewtopic.php?t=12265) ?t=12265 。

# oracle - 有没有办法将oracle数据文件从简体中文（HZ）编码转换为Unicode（UTF-8）编码

> ID：875018
> 
> 赞同：0
> 
> 时间：2009-05-17T17:09:35.350
> 
> 标签：oracle

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:59:10.400

Assuming that the NLS settings on both machines are correct and that the data on the source is properly encoded, since you are just trying to move data from one database to another, just about any Oracle tool should work. You could use the export and import utilities (classic or DataPump versions depending on the version of Oracle). You could also use Streams or materialized views to copy the data from one database to another. Or you could set up a database link and query data over the database link. The Oracle client will automatically convert the data from the source character set to the destination character set.

# jsp - EL 如何搜索属性？

> ID：875024
> 
> 赞同：1
> 
> 时间：2009-05-17T17:13:52.287
> 
> 标签：jsp, el, taglib

EL 如何在 JSP 中搜索属性？以及如何禁用它？

有人知道EL的性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T20:31:05.480

在 EL 中，如果一个对象不是隐式对象，它会在各种范围内搜索给定名称的对象。搜索发生的顺序如下：

1.  页面范围
2.  请求范围
3.  会话范围
4.  适用范围

要禁用 EL：`<%@ page isELIgnored ="true" %>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-19T09:02:24.073

EL 使用 ELResolver 链解析。EL 解析器的顺序如下：

*   `ImplicitObjectELResolver`
*   `ELResolver`s 通过此方法注册，按照注册的顺序。
*   `MapELResolver`
*   `ListELResolver`
*   `ArrayELResolver`
*   `BeanELResolver`
*   `ScopedAttributeELResolver`

EL 的每个令牌都被赋予这个解析器链来解析。

# iphone - 禁用 UINavigationItem 自定义右视图？

> ID：875025
> 
> 赞同：2
> 
> 时间：2009-05-17T17:16:31.270
> 
> 标签：iphone, cocoa, uinavigationbar, uisegmentedcontrol

我创建了一个自定义右视图，如下所示：

```
// Build the Segmented Control
NSArray *segmentTextContent = [NSArray arrayWithObjects:[UIImage imageNamed:@"arrow-dice.png"], [UIImage imageNamed:@"arrow-up.png"], [UIImage imageNamed:@"arrow-down.png"], nil];
UISegmentedControl *segmentedControl = [[UISegmentedControl alloc] initWithItems:segmentTextContent];

// Customize the Segmented Control
segmentedControl.momentary = YES;
segmentedControl.segmentedControlStyle = UISegmentedControlStyleBar;
[segmentedControl addTarget:self action:@selector(segmentChanged:) forControlEvents:UIControlEventValueChanged]; 
```

然后我将它添加到我的导航栏，如下所示：

```
// Add the control to the navigation bar right item
UIBarButtonItem *segmentItem = [[UIBarButtonItem alloc] initWithCustomView:segmentedControl];
[segmentedControl release];
self.navigationItem.rightBarButtonItem = segmentItem;
self.navigationItem.rightBarButtonItem.title = @"";
[segmentItem release]; 
```

我可以按如下方式隐藏它：

```
self.navigationItem.rightBarButtonItem.customView.hidden = NO; 
```

问题 ...但是如何禁用分段控件的所有（或更好的特定元素）？

以下不起作用。

```
self.navigationItem.rightBarButtonItem.enabled = NO; 
```

任何想法表示赞赏...

谢谢，
马特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T17:23:51.920

UISegmentedControl.h

```
- (void)removeSegmentAtIndex:(NSUInteger)segment animated:(BOOL)animated;
- (void)removeAllSegments;
- (void)setEnabled:(BOOL)enabled forSegmentAtIndex:(NSUInteger)segment;       //default is YES

  e.g. [segmentedControl setEnabled:NO forSegmentAtIndex:1]; 
```

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T09:02:43.727

```
[navItem.rightBarButtonItem setEnabled:NO]; 
```

就如此容易 ：）

参考： http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIBarItem_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBarItem_Class/Reference/Reference.html) 查看**enabled**属性。

# python - 欧拉计划问题 245

> ID：875027
> 
> 赞同：8
> 
> 时间：2009-05-17T17:20:00.097
> 
> 标签：python, algorithm, math

我现在遇到[问题 245](http://projecteuler.net/index.php?section=problems&id=245)，但遇到了一些问题。我已经做了一些工作，但我觉得我没有采取任何真正的步骤来解决它。这是我到目前为止所得到的：

我们需要找到具有 a 和 b 正整数的 n=ab。我们也可以假设 gcd(a, b) = 1 而不会失去一般性，因此 phi(n) = phi(ab) = phi(a)phi(b)。

我们正在努力解决：

![\frac{n-\phi(n)}{n-1}=\frac1k](https://chart.apis.google.com/chart?cht=tx&chl=%5Cfrac%7Bn-%5Cphi%28n%29%7D%7Bn-1%7D%3D%5Cfrac1k)

![\frac{n-1}{n-\phi(n)}=k](https://chart.apis.google.com/chart?cht=tx&chl=%5Cfrac%7Bn-1%7D%7Bn-%5Cphi%28n%29%7D%3Dk)

因此：

![n\equiv1\ (\text{mod }n-\phi(n))](https://chart.apis.google.com/chart?cht=tx&chl=n%5Cequiv1%5C%20%28%5Ctext%7Bmod%20%7Dn-%5Cphi%28n%29%29)

在这一点上，我认为实际查看这些数字是如何分布的将是一个好主意。我破解了一个蛮力程序，我用来找到所有（复合）解决方案，最多 10 ⁴：

```
15, 85, 255, 259, 391, 589, 1111, 3193, 4171, 4369, 12361, 17473, 21845, 25429, 28243, 47989, 52537, 65535, 65641, 68377, 83767, 91759 
```

重要的是，看起来[不会有太多](http://www08.wolframalpha.com/input/?i=15%2C+85%2C+255%2C+259%2C+391%2C+589%2C+1111%2C+3193%2C+4171%2C+4369%2C+12361%2C+17473%2C+21845%2C+25429%2C+28243%2C+47989%2C+52537%2C+65535%2C+65641%2C+68377%2C+83767%2C+91759)小于问题要求的 10 ^(11)限制。我发现的最有趣/最有用的一点是，即使 n 的值很大，k 也非常小。事实上，最大的 k 只有 138。（此外，似乎 k 总是偶数。）

考虑到这一点，我猜想有可能考虑 k 的每个值并找到 n 的值与 k 的值。

回到原来的方程，注意它可以改写为：

![\frac{\phi(n)-1}{n-1}=\frac{k-1}k](https://chart.apis.google.com/chart?cht=tx&chl=%5Cfrac%7B%5Cphi%28n%29-1%7D%7Bn-1%7D%3D%5Cfrac%7Bk-1%7Dk)

因为我们知道 k：

![k\cdot\phi(n)\equiv k\ (\text{mod }n-1)](https://chart.apis.google.com/chart?cht=tx&chl=k%5Ccdot%5Cphi%28n%29%5Cequiv%20k%5C%20%28%5Ctext%7Bmod%20%7Dn-1%29)

这就是我所能得到的；我仍在追求我的一些路线，但我想知道我是否错过了重点！通过蛮力方法，我发现总和最多为 10 ⁸，即 5699973227（n 只有 237 个解决方案）。

我几乎没有想法。谁能给出一些提示？

* * *

**更新**：很多人已经做了很多工作，我们已经能够证明几件事。这是一个列表：

n 总是奇数，k 总是偶数。k <= 10 ^(5.5)。n 必须是无平方的。

我已经找到了当 n=pq（2 个素因数）且 p>q 时的所有解决方案。我使用了对于 2 个素数 q = k+factor(k^2-k+1) 和 p = k+[k^2-k+1]/factor(k^2-k+1) 的事实。我们还知道 2 个素数 k < q < 2k。

对于具有 2 个以上素因子的 n，n 的所有素数都大于 k。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T16:37:17.450

Project Euler 不喜欢在 StackOverflow 等公共论坛上讨论问题。所有任务都是单独完成的，如果您遇到问题，您可能会就特定的数学或编程概念寻求帮助，但您不能只决定问如何解决手头的问题——这会带走 Euler 项目的意义。

重点是自己学习并提出解决方案，并学习新概念。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T06:44:33.260

让我继续 jug 的开始，但尝试一种不同的方法。目标再次是找到具有两个不同因子 n=pq 的数字。正如您已经指出的那样，我们正在寻找 n-phi(n) 除以 n-1 的数字。即，如果 n=pq 那么这意味着我们正在寻找 p,q 使得

```
 p+q-1 divides pq-1 
```

假设我们固定 p 并且正在寻找满足上述等式的所有素数 q。上面的方程看起来不太容易求解，因此下一步是尽可能地消除 q。特别是，我们使用如果 a 整除 b 那么 a 也整除 b + ka 对于任何整数 k。因此

```
 p+q-1 divides pq - 1 - p(p+q-1) 
```

并简化这导致条件

```
 p+q-1 divides p^2 - p + 1. 
```

我们可以假设 p 是 n 中较小的素因子。那么 p 小于 10 ^(11)的平方根。^(因此，可以通过遍历 10 11)平方根以下的所有素数 p 来找到所有具有两个因子的数字，然后找到 p^2-p+1 的除数，求解 q 并检查 q 是否为素数且 pq 是否为问题的解决方案。

当然，这仍然使整数具有两个以上的质因数。在这里也有一种类似的方法，但涉及更多，需要进一步优化。

我无法回答的一个问题是，为什么这个问题的表述如此复杂。难道作者不能只要求 n-phi(n) 除以 n-1 的复合整数的总和。所以也许我在那里错过了一个很大的提示。

* * *

现在，已知具有两个素因子的解决方案，我将尝试找到一种潜在的算法来找到具有超过 2 个素因子的解决方案。目标是找到一个算法，给定一个复合整数 m 找到所有素数 q，使得 mq 是一个解决方案。即，q 必须是这样的

```
 mq - phi(mq) divides mq - 1. 
```

让

```
 F = mq - phi(mq). 
```

那么当然

```
 F = (m-phi(m)) q + phi(m). 
```

与两个素因数的情况一样，可以通过从上面等式的左侧消除 q 来找到 F 的条件。因为 F 除 mq-1 它也除

```
 (m-phi(m))(mq - 1) 
```

因此也

```
 m F - (m-phi(m))(mq - 1)  = m phi(m) + m - phi(m). 
```

因此，通过找到 m phi(m) + m - phi(m) 的所有除数 F 并检查 (F - phi(m))/ (m - phi(m)) 是否为素数，可以找到所有解给定 m 的 mq。因为只有满足的除数 F

```
 F == phi(m) (mod m - phi(m)) 
```

可以导致新的解决方案，这个事实有时可以用来优化 m phi(m) + m - phi(m) 的分解。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T07:44:41.353

乘以素数。我所做的是首先检查每个 2-prime 产品；存储那些是成功的。然后使用存储的产品，检查那些有更多素数的产品（你的蛮力中显示的每个 3 素数产品都有一个有效的 2 素数子集）。使用这些存储的产品，然后用 4 个素数、5 个素数等再试一次。

唯一的缺点是你需要一个好的筛子或素数列表。

以下是 N<=(10^7) 的列表：

**2589,11111,11111111111111111111111111111111111156411564158985859858598585985898585985985859598585959858** _ 327937，346063,353029,360301,013,56367,5801,58013,56667,5607,9856,4721,558013,539,970186,58013,539,9701423,093987,9701423,09398,080701,013539,970141,013539,080141,1093987,118,5601,013539,080769,013539,080769,11939,080769,1093987,118423,11854,118423869,1233823869,1233823,12618 07,1264693， 1455889,1487371,1529641,1574383,1612381,1617379,1657531,1793689,20163 79,2095087,2130871,2214031,2299459,2500681,2553709,2609689,2617963,2763697,30475 21,3146677,3397651,3514603,3539017,3820909， 3961219,4078927,4186993,4197901,44997 07,4552411,4935883,4975687,5103841,5299351,5729257,5829877,5864581,6017299,62364 01,6802531,6856609,8759011,9059233,9203377,9301603,9305311,9526747,9536899， 95832 79,9782347,9900217 **3 个素数** 255,21845,335923,3817309 **4 个素数** 65535 **5 个素数** 83623935

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T15:29:11.463

为了不放弃太多，我建议两件事：

1.  分析你通过蛮力产生的数字序列：它们都有一个共同的特征。如果你找到它是什么，那么你可能会尝试暴力破解你的解决方案。

2.  寻找更复杂的因式分解算法。甚至更好：与其从数字中找到因子，不如从因子中构建数字......

* * *

编辑：您会发现的模式只会增加您的理解，并希望向您展示如何通过充分操纵分析表达式来获得相同数量的知识。在不知道这种模式的情况下，恐怕没有解决办法。另外，这可能是欧拉计划中最难的问题之一，因此您不必担心无需大量汗水和辛劳就能找到解决方案……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T15:38:37.833

对这个问题没有直接帮助，但可能对未来的数学项目很有趣：我建议不要使用 WolframAlpha 来分析序列，而是推荐research.att.com 上[的“整数序列在线百科全书”](http://www.research.att.com/~njas/sequences/)。

玩得开心解决所有欧拉问题！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T07:01:08.520

我还没有找到完整的解决方案，但我想分享我的想法。也许有人可以帮忙。

我认为应该尝试将问题减少到

[![O(sqrt(n)](https://i.stack.imgur.com/t5oJ8.gif)](https://i.stack.imgur.com/t5oJ8.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21O%28%5Csqrt%7Bn%7D%29.gif)）]

复杂性。以下事实可用于使搜索更有效：

*   任何解都必须是奇数
*   任何解都必须是不同素数的倍数（不允许平方数因数）

其他人已经指出了这些，并且很容易仅使用 totient 函数的基本属性来证明它们。

我将从分析直到 sqrt(10^11) 的所有素数和合数开始。这不是一项大任务，所需时间应远低于 1 分钟的要求。平方根以上的所有解的形式为：

```
a*b, where at least one of a,b < sqrt(10^11) 
```

在迭代范围 0..sqrt(10^11) 时，我将在迭代中搜索作为解的数字的倍数。我只会介绍将平方根以下的数字与单个素数相乘的情况。我将以这种方式得到的解决方案集将是二素因子解决方案集的超集。它仍然不是完整的解决方案集，因为 p1 *p2* p3 形式的解决方案，其中 p1p2,p2p3,p1p3>sqrt(10^11) 将找不到。

设 b 是平方根以下的数，a 是乘以它的素数。

[![b = kb*(b - phi(b)) + mb](https://i.stack.imgur.com/hlPSV.gif)](https://i.stack.imgur.com/hlPSV.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21b%20%3D%20k_%7Bb%7D%5Bb%20-%20%5Cphi%28b%29%5D%20%2B%20m_%7Bb%7D.gif)）]

我们有：

[![ab = kb(ab - aphi(b)) + amb](https://i.stack.imgur.com/tTRHX.gif)](https://i.stack.imgur.com/tTRHX.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21ab%20%3D%20k_%7Bb%7D%5Bab%20-%20a%5Cphi%28b%29%5D%20%2B%20am_%7Bb%7D.gif)）]

基于以下事实

```
phi(a) = a - 1 and phi(a)*phi(b) = phi(a*b) if a, b coprime 
```

我们有

[![ab = kb(ab - phi(ab)) - kbphi(b) + amb](https://i.stack.imgur.com/sfQQX.gif)](https://i.stack.imgur.com/sfQQX.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21ab%20%3D%20k_%7Bb%7D%5Bab%20-%20%5Cphi%28ab%29%5D%20-%20k_%7Bb%7D%5Cphi%28b%29%20%2B%20am_%7Bb%7D.gif)）]

右边的“模”部分可以写成：

[![m = amb - kbphi(b) = (a-1)mb - (kb-1)b](https://i.stack.imgur.com/R5nfz.gif)](https://i.stack.imgur.com/R5nfz.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21m%20%3D%20am_%7Bb%7D%20-%20k_%7Bb%7D%5Cphi%28b%29%20%3D%20%28a-1%29m_%7Bb%7D%20-%20%28k_%7Bb%7D-1%29b.gif)）]

让我暂时接受

[![0 <= m <= ab - phi(ab)](https://i.stack.imgur.com/9pTnx.gif)](https://i.stack.imgur.com/9pTnx.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%210%20%5Cleq%20m%20%5Cleq%20ab%20-%20%5Cphi%28ab%29.gif)）]

然后我可以为 a (m=1) 求解上述方程，验证结果是否为素数，然后我将得到唯一的解，它是 b 的倍数。如果 m 不在实际模数的范围内，那么我需要为不同的 k 值求解方程：

[![(k-1)(ab - phi(ab)) <= m <= k(ab - phi(ab))](https://i.stack.imgur.com/WbBGn.gif)](https://i.stack.imgur.com/WbBGn.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21%28k-1%29%28ab%20-%20%5Cphi%28ab%29%29%20%5Cleq%20m%20%5Cleq%20k%28ab%20-%20%5Cphi%28ab%29%29.gif)）]

（k 值必须以某种方式受到限制）或证明在这种情况下将有更高的 b < sqrt(10^11) 来涵盖这一点。

b 素数或 b 复合数和 mb = 0 有一个特殊情况。在这种情况下：

[![m = -(kb - 1)b](https://i.stack.imgur.com/KwIjo.gif)](https://i.stack.imgur.com/KwIjo.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21m%20%3D%20-%28k_%7Bb%7D%20-%201%29b.gif)）]

这是可以计算的。对于 ba 素数：

[![m = -(b-1)b](https://i.stack.imgur.com/hmgdE.gif)](https://i.stack.imgur.com/hmgdE.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21m%20%3D%20-%28b%20-%201%29b.gif)）]

我需要找到一个满足等式的素数 a：

[![k(ab - (a-1)phi(b)) + m = 1, k = 1,2,...](https://i.stack.imgur.com/1DRKv.gif)](https://i.stack.imgur.com/1DRKv.gif)
[（来源：[texify.com](http://www.texify.com/img/%5CLARGE%5C%21k%5Bab%20-%20%28a-1%29%5Cphi%28b%29%5D%20%2B%20m%20%20%3D%201%2C%20k%20%3D%201%2C2%2C....gif)）]

例如，设 b=3，phi(b)=2。

我需要解决：

k[3a-2(a-1)] - 6 = 1 => k(a + 2) = 5

对于 k=1, a=7, a prime (solution) 对于所有其他 k 值，不能满足上述等式。

# java - Java中的getter/setter

> ID：875033
> 
> 赞同：23
> 
> 时间：2009-05-17T17:24:54.540
> 
> 标签：java, actionscript-3, setter, getter, accessor

我是 Java 新手，但对 ActionScript 3 有一些 OOP 经验，所以我试图依靠我知道的东西进行迁移。

在 ActionScript 3 中，您可以使用 get 和 set 关键字创建 getter 和 setter，这意味着您可以在类中创建一个方法并通过该类实例的属性访问数据。我可能听起来很复杂，但事实并非如此。这是一个例子：

```
class Dummy{

    private var _name:String;

    public function Dummy(name:String=null){
        this._name = name;
    }

    //getter
    public function get name():String{
        return _name;
    }

    //setter
    public function set name(value:String):void{
    //do some validation if necessary
        _name = value;
    }

} 
```

我会`name`在一个对象中访问：

```
var dummy:Dummy = new Dummy("fred");
trace(dummy.name);//prints: fred
dummy.name = "lolo";//setter
trace(dummy.name);//getter 
```

我将如何在 Java 中做到这一点？

仅仅拥有一些公共领域是不可能的。我注意到在方法前面有使用 get 和 set 的约定，我可以接受。

例如，

```
class Dummy{

    String _name;

    public void Dummy(){}

    public void Dummy(String name){
        _name = name;
    }

    public String getName(){
        return _name;
    }

    public void setName(String name){
        _name = name;
    }

} 
```

Java 中是否有与 ActionScript 3 的 getter/setter 等效的方法，例如从类的实例中将私有字段作为字段访问，但在类内部有实现该字段的方法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-17T17:28:57.860

没有。AS3 getter 和 setter 是 ECMAScript 的东西。在 Java 中，您会被 getVal() 和 setVal() 风格的函数所困扰——没有任何语法糖可以让您轻松处理事情。

我认为 Eclipse 可以帮助自动生成这些类型的东西......

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-17T17:29:46.690

您的 Java 代码很好，除了您想要将`_name` **私有**.

在您的 AS3 示例中，Java中没有**get**和**set**关键字。对不起，它并没有比你已经在做的更好。

更正的代码：

```
class Dummy {
  private String _name;

  public void Dummy() {}

  public void Dummy(String name) {
    setName(name);
  }

  public String getName() {
    return _name;
  }

  public void setName(String value) {
    _name = value;
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T17:31:06.733

可悲的是，不，java 中没有等效的语言级支持。

get* 和 set* 模式在 Java 文化中已经非常成熟，以至于您会发现对它们的强大 IDE 支持（例如，eclipse 会自动为您生成它们），并且如果您正在使用首先使用表达式语言的东西为 jsps (EL) 制作，那么您将能够使用属性表示法来访问 getter 和 setter。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-17T17:52:29.080

我会考虑没有 getter 或 setter，因为它们在你的情况下不做任何事情，除了让代码更复杂。这是一个没有 getter 或 setter 的示例。

```
class Dummy {
  public String name;
  public Dummy(String name) { this.name = name; }
}

Dummy dummy = new Dummy("fred");
System.out.println(dummy.name);//getter, prints: fred
dummy.name = "lolo";//setter
System.out.println(dummy.name);//getter, prints: lolo 
```

恕我直言，不要让事情变得比你需要的更复杂。通常情况下，增加复杂性会受到[You-Aint-Gonna-Need-It 的影响](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-03T18:21:56.513

一种独立于 IDE 的方法是使用[Lombok](http://projectlombok.org/index.html)，这是一个基于注释的库，可以生成 getter、setter 甚至`equals()`和`hashcode()`. 它为编译器执行此操作，但不在源文件中，因此您不必查看方法，只需使用它们即可。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T17:29:42.477

在 Java 中，在不暴露对象内部的情况下，唯一的选择是制作自己的 getter 和 setter，就像在示例中一样。

约定是在要更改的字段之前`get`或`set`前面。因此，就像在您的示例中一样，该字段`name`将分别具有`getName`和`setName`方法作为其对应的 getter 和 setter。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T20:14:04.613

此外，在添加 setter 和 getter 之前，最好问问自己为什么要公开相关对象的内部数据。
我建议你阅读这篇文章 - [http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)

# iphone - 在 iPhone 邮件应用程序上绘制蓝色“未读点”

> ID：875035
> 
> 赞同：2
> 
> 时间：2009-05-17T17:25:52.590
> 
> 标签：iphone, objective-c, cocoa-touch, quartz-graphics

有没有人有一个例子来说明如何绘制苹果邮件应用程序中使用的蓝色“未读点”？这是一个具体的：

![在此处输入图像描述](https://i.stack.imgur.com/CDVms.jpg)

用 Quartz2d 画一个椭圆很简单，但是阴影+渐变的巧妙使用使这个看起来真的是 3d 的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T18:32:40.293

我认为邮件中的蓝点实际上是一个图像；我想对图像进行位图处理会比绘制渐变更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T03:44:18.723

如果您决定使用资源，则有一个名为 UIKit-Artwork-Extractor 的应用程序，可让您从已安装的所有 IOS 应用程序中提取所有资源

[https://github.com/0xced/UIKit-Artwork-Extractor](https://github.com/0xced/UIKit-Artwork-Extractor)

# python - 在 Python 中接收 16 位整数

> ID：875046
> 
> 赞同：11
> 
> 时间：2009-05-17T17:31:50.290
> 
> 标签：python, integer

我正在通过串行端口从一个硬件中读取 16 位整数。

使用 Python，我怎样才能获得正确的 LSB 和 MSB，并让 Python 理解它是我正在摆弄的 16 位有符号整数，而不仅仅是两个字节的数据？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-17T17:36:48.537

尝试使用[struct](http://docs.python.org/library/struct.html)模块：

```
import struct
# read 2 bytes from hardware as a string
s = hardware.readbytes(2)
# h means signed short
# < means "little-endian, standard size (16 bit)"
# > means "big-endian, standard size (16 bit)"
value = struct.unpack("<h", s) # hardware returns little-endian
value = struct.unpack(">h", s) # hardware returns big-endian 
```

# vb.net - 如何永久存储字符串？应用关闭后？

> ID：875047
> 
> 赞同：2
> 
> 时间：2009-05-17T17:32:49.353
> 
> 标签：vb.net, string, datastore

我试图弄清楚如何做到这一点，因为我不确定这样做的正确方法是什么。

我有几个字符串要永久存储/保存，即使在应用程序关闭后也是如此。我应该如何进行？我是从文本文件中读取还是写入？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T17:36:20.847

我相信您正在寻找一种称为应用程序设置的功能。此功能将负责在应用程序实例之间存储设置。它存储设置的方式是 ClickOnce 和用户感知的，因此它消除了很多问题。

这是该主题概述的链接

*   [http://msdn.microsoft.com/en-us/library/c9db58th(VS.80).aspx](http://msdn.microsoft.com/en-us/library/c9db58th(VS.80).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T17:36:50.160

使用[我的设置](http://msdn.microsoft.com/en-us/library/ms379611.aspx#vbmysettings_topic3)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T17:35:16.713

是的，您可以将其存储在一个简单的文本文件中或使用[设置文件](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T17:36:09.693

看看应用程序设置：http: [//msdn.microsoft.com/en-us/library/0zszyc6e.aspx](http://msdn.microsoft.com/en-us/library/0zszyc6e.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T15:00:24.273

我将需要的内容存储在纯文本文件中。我使用自己的格式：第一行：数组的长度或需要存储数据的字节数/行数。第二行：数据类型。第三行：目录或路径信息。最后我存储数据。

那是因为编程语言可以按字符或按行读取。C++ 考虑空格和行。

SQL 或 Access 是当您需要存储比字符串或数组更复杂的数据时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T17:35:21.020

是的，我会将它存储在某种形式的文本文件中，然后您可以在加载时阅读它。它在 Visual Basic 中很容易实现，您甚至可以在 Codemonkeys 或类似工具中找到一些示例。我会避免使用注册表。当然，如果您愿意，您也可以使用某种数据库（Access、SQLITE 等）来存储这些值。但这取决于数据的类型以及您需要从中读取/写入多少数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T17:37:15.340

是的，您可以写入文本文件，或者尝试使用 SQLite，它可以让您的 VB 程序具有数据库功能。

[http://www.google.com/search?hl=en&q=visual+basic+sqlite&btnG=搜索](http://www.google.com/search?hl=en&q=visual+basic+sqlite&btnG=Search)

# c# - 带 Action 参数的起订量

> ID：875048
> 
> 赞同：6
> 
> 时间：2009-05-17T17:33:50.303
> 
> 标签：c#, moq

我正在尝试使用 Moq 3.x，它运行良好。但是，我有一个问题，我不知道如何解决。给定

```
public interface ITestSpec
{
  bool Run(Action<string, string> onIncorrectResponse);
} 
```

我正在尝试以下操作：

```
var passingTestSpec = new Mock<ITestSpec>();
passingTestSpec
  .Setup(m => m.Run(null))
  .Returns(true);

Action<string, string> fakeAction =
  (expected, actual) => { throw new Exception("Should not run"); };

Assert.IsTrue(passingTestSpec.Object.Run(fakeAction)); 
```

我的问题是对 passTestSpec.Object.Run(... some action ...) 的任何调用都返回 false。似乎 Moq 库正在尝试将操作与我在 Setup() 调用中传递给 Run() 的参数相匹配，但失败了。实际上，我在 Run() 调用中执行的操作并不重要……它仍然返回 false。

有任何想法吗？

[编辑] 我刚刚发现了一些东西；如果我将设置行替换为

```
 .Setup(m => m.Run(fakeAction)) 
```

测试通过。但是，我不知道 .Run() 方法将被调用什么操作，所以这不是一个解决方案。任何人都知道 It.IsAny 等价的动作吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-17T17:48:20.613

有什么问题：

```
It.IsAny<Action<string, string>>() 
```

# c++ - 如何将 byte[] 复制到 char* 中？

> ID：875050
> 
> 赞同：0
> 
> 时间：2009-05-17T17:34:54.610
> 
> 标签：c++, c

我需要的只是strcpy()。

我想看看缓冲区（字节数组）的前三个字节是否是“JMX”作为字符串。

这是我到目前为止所做的：

```
char * ddj;
strcpy( ddj, buffer ); //buffer is BYTE[]
if ( strcmp( "JMX", ddj ) == 0 ) //check first three chars are "JMX"
{
    buffer += 20;   //increase the index with 20
    size -= 20;     //int
} 
```

我在 strcmp() 行遇到异常。问题是什么？

*我希望我用 C# 写这个:(*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T17:38:03.013

这里出了问题：

1.  `ddj`不指向任何实际内存。因此副本将具有未定义的行为
2.  最初不需要复制。

这是你可以做的：

```
if(strncmp("JMX", buffer, 3) == 0) {
  buffer += 20;
  size -= 20;
} 
```

这使用[strncmp](http://linux.die.net/man/3/strncmp)而不是[strcmp](http://linux.die.net/man/3/strcmp)，从而确保比较不超过三个字节。如果`buffer`可以包含少于三个字节，您应该执行以下操作：

```
if(buf_len >= 3 && strncmp("JMX", buffer, 3) == 0) {
  buffer += 20;
  size -= 20;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T17:41:46.113

您没有为`ddj`. 因为它是一个局部变量，所以它是在堆栈上分配的。默认情况下，局部变量不会初始化为 0/false/NULL，因此在`ddj`声明它之后立即的值是未定义的——它将具有堆栈上特定位置的内存中剩余的任何值。任何取消引用它的尝试（即读取或写入它指向的内存）都将具有未定义的行为。在你的情况下，它崩溃了，因为它指向一个无效的地址。

要解决此问题，您需要为`ddj`. 您可以在堆栈上分配静态存储，也可以在堆上分配动态存储。要分配静态存储，请执行以下操作：

```
// Allocate 64 bytes for ddj.  It will automatically be deallocated when the function
// returns.  Be careful of buffer overflows!
char ddj[64]; 
```

分配动态存储：

```
// Allocate 64 bytes for ddj.  It will NOT be automatically deallocated -- you must
// explicitly deallocate it yourself at some point in the future when you're done
// with it.  Be careful of buffer overflows!
char *ddj = new char[64];
...
delete [] ddj;  // Deallocate it 
```

与其自己管理存储，不如使用`std::string`自动处理内存管理的 .

最后，由于您所做的只是比较字符串的前三个字符，因此无需跳过循环来复制字符串并进行比较。只需使用[`strncmp()`](http://linux.die.net/man/3/strncmp)：

```
if(strncmp(buffer, "JMX", 3) == 0)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T17:36:34.670

您还没有为 ddj 分配内存。使用 new 分配内存。例如

```
char *ddj = new char[size]; //Allocate size number of chars
//do the required comaprisons

delete[] ddj; //Remember to release the memory. 
```

另一方面，您可以使用标准字符串类 std::string 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T17:39:00.453

您必须为`ddj`. 要么将其声明为

```
char ddj[NAX_LENGTH]; 
```

或动态分配

```
char* ddj = new char[length]; // You must use delete[] to free the memory in the end. 
```

一个更方便的选择是`std::string`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T17:42:00.717

首先，它崩溃了，因为`ddj`它没有指向任何东西。

其次，您不需要将数据从 byte[] 复制到 char* （它们本质上是相同的）。你可以这样做：

```
if (strncmp("JMX", reinterpret_cast<char*>(buffer), 3) == 0)
{
  // Strings are equal, do what you want
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T17:37:26.290

这是 UB，因为`ddj`它没有指向任何东西。您需要分配内存：

```
char* ddj = new char[strlen(buffer) + 1]; 
```

确保`delete`使用分配的内存`delete[]`（不是普通的`delete`！）。

您也可以使用`std::string`通常是安全的，因为您不必处理指针和内存分配。

但是，查看您的代码`ddj`似乎毫无用处。只需使用`buffer`：

```
if ( strcmp( "JMX", buffer ) == 0 ) //check first three chars are "JMX"
{
    buffer += 20;   //increase the index with 20
    size -= 20;     //int
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T17:40:17.083

如果你想strcmp ddj，你也可以先在buffer上做，如果以后需要的话，复制一个buffer。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T17:44:51.257

您收到异常是因为变量 'ddj' 未初始化。它指向垃圾，所以谁知道你在哪里复制那个字符串......

不过，您实际上并不需要在比较它们之前复制字节。

```
if(strncmp("JMX", buffer, 3) == 0) // check if the first three characters are "JMX"
{
    buffer += 20;
    size -= 20;
} 
```

# asp.net - 如何处理 Web 服务中字符串中的特殊字符？

> ID：875057
> 
> 赞同：1
> 
> 时间：2009-05-17T17:36:10.177
> 
> 标签：asp.net, web-services, asmx, special-characters

为了展示 .NET 中的这个基本问题以及这个问题的原因，我编写了一个简单的测试 Web 服务，其中包含一个方法 (EditString)，以及一个调用它的消费者控制台应用程序。

它们都是通过文件/新建项目等创建的标准 Web 服务/控制台应用程序，所以我不会列出整个代码 - 只是有问题的方法：

网络方法：

```
[WebMethod]
public string EditString(string s, bool useSpecial)
{
    return s + (useSpecial ? ((char)19).ToString() : "");
} 
```

[您可以看到，如果 useSpecial 为 false，它只会返回字符串 s。如果 useSpecial 为真，则返回 s + char 19。]

控制台应用程序：

```
TestService.Service1 service = new SCTestConsumer.TestService.Service1();

string response1 = service.EditString("hello", false);
Console.WriteLine(response1);

string response2 = service.EditString("hello", true); // fails!
Console.WriteLine(response2); 
```

[第二个响应失败，因为该方法返回 hello + 一个特殊字符（为了参数的缘故，ascii 代码为 19）。]

错误是：

*   XML 文档中存在错误 (1, 287)

*   内部异常：“''，十六进制值 0x13，是无效字符。第 1 行，位置 287。”

有几点值得一提：

*   当直接浏览到 ASMX 文件（例如`http://localhost:2065/service1.asmx`）并通过它运行该方法（使用与控制台应用程序中相同的参数）时，Web 方法本身可以正常工作 - 即显示带有字符串 hello + char 19 的 XML。

*   以其他方式检查序列化的 XML 表明特殊字符被正确编码（服务器端似乎没问题，这很好）

*   所以看起来客户端有问题 - 即.NET生成的代理类代码不处理特殊字符

*   这是一个更大项目的一部分，其中对象被传入和传出 Web 方法 - 包含字符串属性 - 这些是正常工作所需要的。即我们正在反序列化类。

有关解决方法以及如何实施的任何建议？

还是我完全错过了一些非常明显的东西！！？

PS。我没有太多运气让它使用 CDATA 标记（.NET 是否支持这些开箱即用？）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T17:56:19.900

您将需要使用 byte[] 而不是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:24:49.007

我正在考虑一些可能对您有所帮助的选项。您可以使用 html 实体而不是 char(19) 来选择路线。或者如您所说，您可能想要使用 CDATA。

要提出一个干净的解决方案，您可能不想将整个内容放在 CDATA 中。我不确定您为什么认为 .NET 可能不支持它。您是在序列化的背景下这么说的吗？

# css - jQuery - 无法在 ajax 回调函数中设置 css 属性

> ID：875073
> 
> 赞同：0
> 
> 时间：2009-05-17T17:40:31.873
> 
> 标签：css, jquery, callback, background-color

我正在尝试获取一个 jquery ajax 回调函数来更新表格单元格的背景颜色，但我无法让它工作。

我有以下代码（在 Firebug 中不会产生错误）：

```
$(".tariffdate").click(function () {
   var property_id = $('#property_id').attr("value");
   var tariff_id = $('#tariff_id').attr("value");
   var tariff_date = $(this).attr("id");
   $.post("/admin/properties/my_properties/booking/edit/*", { property_id: property_id, tariff_id: tariff_id, tariff_date:  tariff_date },
function(data){
   var bgcol = '#' + data;
   $(this).css('background-color',bgcol);
   alert("Color Me: " + bgcol);
}); 
```

我添加了警报只是为了确认我得到了预期的数据（一个 6 位十六进制代码），而且我是 - 但我的表格单元格的背景顽固地拒绝改变。

所有表格单元格都有 .tariffdate 类，但也有单独的 ID。

作为测试，我尝试为该类创建一个悬停函数：

```
$(".tariffdate").hover(function () {
   $(this).css('background-color','#ff0000');
}); 
```

以上工作正常 - 所以我真的很困惑为什么我的回调函数不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T17:46:12.740

在 AJAX 完成的处理程序中，实例`this`更改为 ajax 对象。您需要将 的实例保存`this`到对象并使用该对象。例如：

```
$(".tariffdate").click(function () {
   var property_id = $('#property_id').attr("value");
   var tariff_id = $('#tariff_id').attr("value");
   var tariff_date = $(this).attr("id");
   var tariff = $(this);
   $.post("/admin/properties/my_properties/booking/edit/*", 
      { property_id: property_id, tariff_id: tariff_id, tariff_date:  tariff_date },
      function(data) {
         var bgcol = '#' + data;
         tariff.css('background-color',bgcol);
         alert("Color Me: " + bgcol);
      }
   );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T17:45:16.233

检查 ajax 回调函数中的“this”变量是什么。我怀疑它不是指 .tariffdate

# python - 如何在 Python 中打印对象的列表、字典或集合

> ID：875074
> 
> 赞同：21
> 
> 时间：2009-05-17T17:41:03.633
> 
> 标签：python, list

我在 python 中编写了一个实现的类，`__str__(self)`但是当我在包含此类实例的列表上使用 print 时，我只得到默认输出`<__main__.DSequence instance at 0x4b8c10>`。我是否需要实现另一个魔术功能才能使其正常工作，还是我必须编写自定义打印功能？

这是课程：

```
class DSequence:

    def __init__(self, sid, seq):
        """Sequence object for a dummy dna string"""
        self.sid = sid
        self.seq = seq

    def __iter__(self):
        return self

    def __str__(self):
        return '[' + str(self.sid) + '] -> [' + str(self.seq) + ']'

    def next(self):
        if self.index == 0:
            raise StopIteration
        self.index = self.index - 1
        return self.seq[self.index] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-17T17:42:22.993

是的，您需要使用[`__repr__`](http://docs.python.org/reference/datamodel.html#object.__repr__). 其行为的一个简单示例：

```
>>> class Foo:
...     def __str__(self):
...             return '__str__'
...     def __repr__(self):
...             return '__repr__'
...
>>> bar = Foo()
>>> bar 
__repr__
>>> print bar 
__str__
>>> repr(bar)
'__repr__'
>>> str(bar)
'__str__' 
```

但是，如果您不定义 a `__str__`，它会退回到`__repr__`，尽管不建议这样做：

```
>>> class Foo:
...     def __repr__(self):
...             return '__repr__'
...
>>> bar = Foo()
>>> bar
__repr__
>>> print bar
__repr__ 
```

正如手册所建议的那样，所有考虑的东西`__repr__`都用于调试，并且应该返回`repr`对象的某些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:48:02.030

避免使用 + 进行连接的一点改进：

```
def __str__(self):
  return '[%s] -> [%s]' % (self.sid, self.seq) 
```

# c# - 泛型部分视图：如何将泛型类设置为模型？

> ID：875085
> 
> 赞同：15
> 
> 时间：2009-05-17T17:45:36.483
> 
> 标签：c#, asp.net-mvc, generics

我正在尝试在 ASP.NET MVC 应用程序中构建通用网格视图。

让我用一些代码解释一下：

```
public interface ITrustGrid<T>
{
    IPagedList<T> Elements { get; set; }
    IList<IColumn<T>> Columns { get; set; }
    IList<string> Headers { get; }
} 
```

这是一个类的接口，允许我在控制器中设置列和表达式。

我将实现传递给这样的局部视图：

```
<% Html.RenderPartial("SimpleTrustGridViewer", ViewData["employeeGrid"] as TrustGrid<EmployeeInfoDTO>); %> 
```

问题是我无法弄清楚如何制作呈现网格通用的局部视图。

换句话说，我想把这个变成：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<ITrustGrid<EmployeeInfoDTO>>" %> 
```

变成这样的东西：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<ITrustGrid<T>>" %> 
```

=> 如何以最简单的方式使我的局部视图通用？

**编辑：**

我通过使用具有公共 TrustGrid GetTrustGrid() 方法的 TrustGridBuilder 解决了这个问题，该方法返回非泛型 TrustGrid。TrustGrid 包含字符串而不是 linq 的东西。所以我在 GetTrustGrid() 方法中执行 linq 并将字符串放在 TrustGrid 对象中。

感谢大家在正确的轨道上帮助我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T17:56:12.007

您可以使您将传递给此部分的所有模型类型都从基类/接口继承，该基类/接口建立了此部分视图将使用的基本行为并接受该类/接口类型的任何对象，或者只拥有视图接受任何类型的对象，然后使用反射来确定您的局部视图行为。

例子：

```
public interface IDisplayModel
{
    string DisplayText{get;set;}
    string ImageUrl{get;set;}
    string AltText{get;set;}
}

public interface ITrustGrid<T> where T : IDisplayModel
{    
    IPagedList<T> Elements { get; set; }    
    IList<IColumn<T>> Columns { get; set; }    
    IList<string> Headers { get; }
}

<%@ Control Language="C#" 
    Inherits="System.Web.Mvc.ViewUserControl<ITrustGrid<IDisplayModel>>" %> 
```

当然，您`IDisplayModel`会根据您想要的行为而有所不同。然后，这将允许您将任何内容传递给实现此基本接口的此部分以建立一般行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T17:48:06.310

不可能那样做。原因是`.aspx`它将生成一个您对其没有太多控制权的类，并且您无法向其添加通用参数。我想最直接的方法是将它作为`object`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T19:13:32.757

我同意 Mehrdad 的观点，据我所知，不可能做出通用的观点。在我的一个项目中，我使用了一个与您的界面非常相似的界面，然后将委托函数传递给处理每个项目的特定呈现的视图。

例如，我会使用带有附加字段的非通用视图数据类：

```
public interface ITrustGrid {
    IPagedList Elements { get; set; }
    IList<IColumn> Columns { get; set; }
    IList<string> Headers { get; }

    Func<object, string> ElementRenderer { get; }
} 
```

在您的主视图中，您将准备视图数据：

```
<%
ITrustGrid data = (ITrustGrid)ViewData["employeeGrid"];
data.ElementRenderer = new Func<object, string>(delegate(o) {
    var employee = (Employee)o;
    //render employee
    return html;
});

Html.RenderPartial("SimpleTrustGridViewer", data);
%> 
```

在您的部分网格中，您将照常处理网格，然后调用委托来渲染每个单元格：

```
<%
foreach(var element in ViewData.Elements){
    %>
    <tr>
        <td><%=ViewData.ElementRenderer(element) %></td>
    </tr>
    <%
}
%> 
```

当然，上面的代码只为每个元素呈现一个单元格，您必须创建一个稍微复杂的委托来呈现多个列（或传入一个委托数组，每列一个）。

我认为这将是最干净的方法之一，尽管有点麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T19:25:25.090

@李克：

我在我的控制器中做类似的事情：

```
var columns = new List<IColumn<EmployeeInfoDTO>>
                  {
                      new Column<EmployeeInfoDTO>("Full name", e => string.Format("{0} {1}", e.FirstName, e.Name)),
                      new Column<EmployeeInfoDTO>("Examination date", e => e.ExaminationDate.HasValue? string.Format("{0} days ago", currentDate.Subtract(e.ExaminationDate.Value).Days) : "Unknown")
                  };

var employeeGrid = new TrustGrid<EmployeeInfoDTO> { Columns = columns, Elements = GetEmployees(currentPageIndex)};

ViewData["employeeGrid"] = employeeGrid; 
```

所以在我的部分观点中，我可以这样做：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<ITrustGrid<EmployeeInfoDTO>>" %>
<table>
    <thead>
        <tr>
            <%
                foreach (string header in Model.Headers)
                    Response.Write(Html.Th(header));
            %>
        </tr>
    </thead>
    <tbody>
        <%
            foreach (var element in Model.Elements)
            {
                Response.Write("<tr>");
                foreach (var column in Model.Columns)
                    Response.Write(Html.Td(column.ValueExpression(element)));
                Response.Write("</tr>");
            }
        %>
    </tbody>
</table>
<div class="pager">
    <%= Html.Pager(Model.Elements.PageSize, Model.Elements.PageNumber, Model.Elements.TotalItemCount)%>
</div> 
```

如您所见，我的部分代码都不依赖于使用的类型。所以我仍然认为有一个简单的解决方案。

# javascript - Javascript：调整图像大小以适合窗口，然后切换完整大小并在点击时调整大小？

> ID：875087
> 
> 赞同：0
> 
> 时间：2009-05-17T17:47:37.307
> 
> 标签：javascript

我正在尝试创建一个小片段，以允许调整加载的图像以适应用户的分辨率。然后允许用户在实际图像大小和针对其分辨率调整的图像大小之间进行切换。这是我到目前为止得到的：

```
<img src="<?=$file['direct_url']?>" border="0" onload="if(this.width>screen.width/1.5) {this.width=screen.width/1.5;this.alt='Click image to view full size';}window.status=this.width;" onmouseover="if(this.alt) this.style.cursor='hand';" onclick="if (this.width=screen.width/1.5) {this.width=screen.width*1.5} else {this.width=screen.width/1.5}"> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T02:29:20.860

我认为您可能唯一需要的是一个自定义属性，您可以在其中使用 / 高度存储原始图像。

```
<img originalwidth="100" originalheight="100" /> 
```

您可以使用以下方法检索/使用这些值：

```
this.getAttribute('originalwidth');
this.getAttribute('originalheight'); 
```

# ruby-on-rails - 使用过 Django 和 Ruby on Rails 的用户能否对使用它们进行一些比较？

> ID：875091
> 
> 赞同：0
> 
> 时间：2009-05-17T17:48:29.053
> 
> 标签：ruby-on-rails, django, frameworks

> **重复：** [Django 还是 Ruby-On-Rails？](https://stackoverflow.com/questions/846231/django-or-ruby-on-rails/847932)

我一直在阅读 Ruby on Rails，似乎在某些线程上，有些用户也很喜欢 Django？

两者都使用过的人能否提供一些有关使用它们的见解，例如

易用性
生产力
有趣的因素
部署问题

或您强烈推荐的任何其他框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T19:59:12.120

两者都是优秀的框架。不过，我发现 Rails 更适合敏捷开发人员。在大多数情况下，您将运行一些生成器来获取您需要的文件作为代码的占位符。事情将立即生效，您只需根据这些约定进行构建。它非常灵活并且拥有一个庞大的社区，许多创新和有趣的实践都被投入到 Rails 中。它的开发周期似乎比 Django 快。

在与 Django 仅接触表面之后，它有一些有趣的差异。据我所知，您不会像 Rails 那样获得开箱即用的模式迁移。但是你可以通过可扩展的管理界面为你的模型获得一个非常简单的 CRUD 机制，这对于测试/管理内容非常有用。整个项目的文档记录非常好，从[Django Book到](http://www.djangobook.com/)[docs.djangoproject.com](http://docs.djangoproject.com/)上的大量信息。

我个人更喜欢 Rails 的做事方式。但老实说，您需要同时尝试它们，看看哪些对您有用，而且由于我们谈论的是两个非常好的但完全不同的框架，因此做出任何一种方式都是一个艰难的决定。因此，如果您已经足够了解 Ruby 或 Python，请从您所知道的开始，然后从那里开始。一旦你了解了一个人的工作原理，你就可以自己评估较小的差异。希望有帮助。

# http - 我可以做自己的 HTTP 标头属性吗？

> ID：875096
> 
> 赞同：2
> 
> 时间：2009-05-17T17:55:40.353
> 
> 标签：http, jsp, header

我可以在其中制作自己的标题`HTTP request`吗？

例如这是`normal HTTP request`

```
GET / HTTP/1.1
Host: google.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT x.x; xx; rv:x.x.x.x) xxx        Firefox/3.0.10 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: xx,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: windows-1250,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive 
```

这是带有我的“属性”的标题

```
GET / HTTP/1.1
Host: google.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT x.x; xx; rv:x.x.x.x) xxx        Firefox/3.0.10 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: xx,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip,deflate
Accept-Charset: windows-1250,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Name: John 
```

我将在服务器响应中有“属性”。我将在 HTTP 标头中使用“属性”而不是会话属性...

顺便说一句。对不起我的英语...... ;)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T00:06:24.867

你想重新发明饼干吗？

你知道，饼干就是这样。服务器在标头中发送的值，客户端将随每个请求返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:05:55.173

试试这个：[request.setHeader(name, value)](http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/http/HttpServletRequest.html#setHeader%28java%2Elang%2EString%2C%20java%2Elang%2EString%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T00:28:46.110

是的你可以。但是，你为什么想要？

HTTP 协议允许您设置自己的自定义标头。但是，这也意味着您的服务器需要了解您的自定义标头。因此，此解决方案仅适用于您的自定义应用程序，而不适用于所有应用程序。除非您准确记录所有这些自定义设置，否则它还可能使将来的维护/调试变得更加困难。

我会支持 wmeyer 所说的，使用 cookie。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-13T13:48:26.300

您可以编写一个小代理应用程序。它接收客户端请求，添加适当的属性并将其转发给服务器。我建议这个解决方案，因为根据我的经验，您可能需要丰富 http 标头内容以实现多个 Web 应用程序之间的集成。

我刚刚描述的行为例如由 Tivoli Access Manager 实现，以将 LDAP 检索到的信息转发到后端应用程序。服务器。

对不起，如果我的回答似乎超出主题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T18:11:31.200

是的，我相信你可以。尽量确保您没有重复使用某人已经使用的标题。另请记住，出于安全原因，Web 服务器和代理可能会过滤您的标头。

事实上，我认为jsp*中的*会话是用特殊的标题创建的......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T18:33:08.280

似乎您的问题是关于**REQUEST**中的标头，即从客户端进入服务器。您不能强制客户端从服务器端发送任何自定义标头。

使用`response.setHeader("Name", "John")`只会发送此标头作为响应，但客户端**不会**将其发送回您。对不起。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T00:03:01.040

您可以使用 XMLHttpRequest 执行此操作，但不能使用普通浏览器请求。

# java - 树结构的正则表达式？

> ID：875100
> 
> 赞同：11
> 
> 时间：2009-05-17T17:57:26.310
> 
> 标签：java, python, c, regex, tree-structure

是否有用于搜索和修改树结构的正则表达式等价物？我正在寻找简洁的迷你语言（如 perl 正则表达式）。

这是一个示例，可以阐明我在寻找什么。

```
<root>
  <node name="1">
    subtrees ....
  </node>
  <node name="2">
    <node name="2.1">
     data
    </node>
    other subtrees...
  </node>
</root> 
```

在上述树上可能的操作是“将节点 2.1 的子树移动到节点 1 的子树中”。操作的结果可能看起来像..

```
<root>
  <node name="1">
    subtrees ....
    <node name="2.1">
     data
    </node>
  </node>
  <node name="2">
    other subtrees...
  </node>
</root> 
```

搜索和替换操作，例如查找所有具有至少 2 个子节点的节点、查找数据以“a”开头的所有节点，如果子树至少有 2 个其他兄弟节点，则将其替换为“b”等。应该支持。

对于字符串，其中唯一的维度是字符串的长度，我们可以使用正则表达式执行许多上述操作（或它们的一维等效项）。我想知道是否有树的等价物。（而不是单个正则表达式，您可能需要编写一组转换规则，但这没关系）。

我想知道是否有一些简单的迷你语言（不是正则表达式本身，而是通过库等可以像正则表达式一样访问的东西）。执行这些操作？最好作为 python 库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-21T13:40:55.173

斯坦福大学的 TSurgeon 和 Tregex 能够做到这一点。[您可以从http://nlp.stanford.edu/software/tregex.shtml](http://nlp.stanford.edu/software/tregex.shtml)下载该库

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T18:17:02.567

我不知道可以做到这一点的通用语言，但在我看来，您正在寻找类似[XPath](http://en.wikipedia.org/wiki/XPath)的东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T18:17:31.427

[TXL](http://www.txl.ca/)用于基于模式的树重写。

[使用ANTLR](http://www.antlr.org/wiki/display/~admin/2008/11/30/Example+tree+rewriting+with+patterns)等解析器工具包也可以使用模式重写树

使用自下而上的树重写、google BURS 或 BURG 生成代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T18:13:22.010

在二叉搜索树中导航需要状态（我在哪个节点？）和比较（该值小于还是大于该值？），这是有限状态自动机无法完成的。

当然，您可以搜索具有给定值的节点，但是如果您不知道其父节点，例如，您如何删除不是叶子的节点？

即使通过节点提供的信息知道父节点，如何确定左子树的最小值，将其移除并放入节点中？

我认为你对 FSA 的要求太高了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T18:17:55.310

[本文](http://www.perl.com/pub/a/2003/06/06/regexps.html)提供了一些关于递归 Perl 正则表达式的有用提示，但老实说，很少看到以这种方式处理树结构。

更典型的是，人们会编写一个状态机样式的解析器，它可能使用正则表达式来解析树中的每个特定节点。

[Expat](http://expat.sourceforge.net/)可能是一个很好的例子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T18:33:12.820

由 Scala、F#、Erlang 和 Haskell 等语言提供的模式匹配（我相信还有更多）旨在简洁地操作树等数据结构，尤其是与递归一起使用时。

[这](http://www.scala-lang.org/node/120)是 Scala 中模式匹配可以做什么的一个非常高级的视图。显示的示例确实不公平地进行模式匹配。

维基百科也有一些关于模式匹配的参考。[这里](http://en.wikibooks.org/wiki/Haskell/Pattern_matching)和[这里](http://en.wikipedia.org/wiki/Pattern_Matching#Tree_patterns_for_strings)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T20:51:00.407

我有点惊讶[XSLT](https://en.wikipedia.org/wiki/XSLT)没有作为答案出现。诚然，我不认为它是一种特别优雅的语言，并且大多数现有的解决方案倾向于支持过程方法而不是模式匹配，并且仅仅因为将 XML 应用于 XML 而盲目地应用它而得到了一个非常糟糕的代表——但除此之外它符合要求。可惜它的规范表示是如此冗长，虽然......

# c++ - 如何按索引从 std::vector<> 中删除元素？

> ID：875103
> 
> 赞同：634
> 
> 时间：2009-05-17T17:59:36.290
> 
> 标签：c++, stl, vector, erase

我有一个 std::vector<int>，我想删除第 n 个元素。我怎么做？

```
std::vector<int> vec;

vec.push_back(6);
vec.push_back(-17);
vec.push_back(12);

vec.erase(???); 
```

* * *

## 回答 #1

> 赞同：827
> 
> 时间：2009-05-17T18:01:45.087

要删除单个元素，您可以执行以下操作：

```
std::vector<int> vec;

vec.push_back(6);
vec.push_back(-17);
vec.push_back(12);

// Deletes the second element (vec[1])
vec.erase(std::next(vec.begin())); 
```

或者，一次删除多个元素：

```
// Deletes the second through third elements (vec[1], vec[2])
vec.erase(std::next(vec.begin(), 1), std::next(vec.begin(), 3)); 
```

* * *

## 回答 #2

> 赞同：315
> 
> 时间：2009-05-17T18:08:55.853

std::vector 上的擦除方法已重载，因此调用可能更清晰

```
vec.erase(vec.begin() + index); 
```

当您只想擦除单个元素时。

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2011-03-10T20:47:43.757

```
template <typename T>
void remove(std::vector<T>& vec, size_t pos)
{
    std::vector<T>::iterator it = vec.begin();
    std::advance(it, pos);
    vec.erase(it);
} 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2016-05-04T11:06:07.913

该`erase`方法将以两种方式使用：

1.  擦除单个元素：

    ```
    vector.erase( vector.begin() + 3 ); // Deleting the fourth element 
    ```

2.  擦除元素范围：

    ```
    vector.erase( vector.begin() + 3, vector.begin() + 5 ); // Deleting from fourth element to sixth element 
    ```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2020-09-02T19:18:20.940

擦除带有 index 的元素：

```
vec.erase(vec.begin() + index); 
```

擦除具有值的元素：

```
vec.erase(find(vec.begin(),vec.end(),value)); 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-05-20T21:07:11.563

实际上，该`erase`功能适用​​于两个配置文件：

*   删除单个元素

    ```
    iterator erase (iterator position); 
    ```

*   删除一系列元素

    ```
    iterator erase (iterator first, iterator last); 
    ```

由于 std::vec.begin() 标志着容器的开始，如果我们想删除向量中的第 i 个元素，我们可以使用：

```
vec.erase(vec.begin() + index); 
```

如果仔细观察，vec.begin() 只是一个指向向量起始位置的指针，将 i 的值添加到它会增加指向 i 位置的指针，因此我们可以通过以下方式访问指向第 i 个元素的指针：

```
&vec[i] 
```

所以我们可以写：

```
vec.erase(&vec[i]); // To delete the ith element 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-09-18T15:18:54.267

如果你有一个无序向量，你可以利用它是无序的这一事实，并使用我在 CPPCON 的 Dan Higgins 那里看到的东西

```
template< typename TContainer >
static bool EraseFromUnorderedByIndex( TContainer& inContainer, size_t inIndex )
{
    if ( inIndex < inContainer.size() )
    {
        if ( inIndex != inContainer.size() - 1 )
            inContainer[inIndex] = inContainer.back();
        inContainer.pop_back();
        return true;
    }
    return false;
} 
```

由于列表顺序无关紧要，只需将列表中的最后一个元素复制到要删除的项目的顶部，然后弹出并删除最后一个项目。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2020-08-26T13:27:54.150

对某些人来说似乎很明显，但要详细说明上述答案：

如果您在整个向量的循环中使用删除`std::vector`元素，您应该以**相反的顺序**处理您的向量，也就是说使用`erase`

 **`for (int i = v.size() - 1; i >= 0; i--)`

而不是（古典）

`for (int i = 0; i < v.size(); i++)`

原因是索引会受到影响，`erase`因此如果您删除第 4 个元素，那么之前的第 5 个元素现在是新的第 4 个元素，如果您正在执行`i++`.

下面是一个简单的例子，说明我想删除一个 int 向量的所有赔率元素；

```
#include <iostream>
#include <vector>

using namespace std;

void printVector(const vector<int> &v)
{
    for (size_t i = 0; i < v.size(); i++)
    {
        cout << v[i] << " ";
    }
    cout << endl;
}

int main()
{    
    vector<int> v1, v2;
    for (int i = 0; i < 10; i++)
    {
        v1.push_back(i);
        v2.push_back(i);
    }

    // print v1
    cout << "v1: " << endl;
    printVector(v1);

    cout << endl;

    // print v2
    cout << "v2: " << endl;
    printVector(v2);

    // Erase all odd elements
    cout << "--- Erase odd elements ---" << endl;

    // loop with decreasing indices
    cout << "Process v2 with decreasing indices: " << endl;
    for (int i = v2.size() - 1; i >= 0; i--)
    {
        if (v2[i] % 2 != 0)
        {
            cout << "# ";
            v2.erase(v2.begin() + i);
        }
        else
        {
            cout << v2[i] << " ";
        }
    }
    cout << endl;
    cout << endl;

    // loop with increasing indices
    cout << "Process v1 with increasing indices: " << endl;
    for (int i = 0; i < v1.size(); i++)
    {
        if (v1[i] % 2 != 0)
        {
            cout << "# ";
            v1.erase(v1.begin() + i);
        }
        else
        {
            cout << v1[i] << " ";
        }
    }

    return 0;
} 
```

输出：

```
v1:
0 1 2 3 4 5 6 7 8 9

v2:
0 1 2 3 4 5 6 7 8 9
--- Erase odd elements ---
Process v2 with decreasing indices:
# 8 # 6 # 4 # 2 # 0

Process v1 with increasing indices:
0 # # # # # 
```

请注意，在索引增加的第二个版本中，偶数不会显示，因为它们会被跳过，因为`i++`

另请注意，以相反的顺序处理向量，您**不能**将无符号类型用于索引（`for (uint8_t i = v.size() -1; ...`不起作用）。这是因为当`i`equals时`0`，例如`i--`会溢出并等于（因此循环不会像现在一样停止，并且可能超出向量的范围）。`255``uint8_t``i``>= 0`

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-05-12T14:28:03.770

如果您使用大型向量（大小 > 100,000）并且想要删除大量元素，我建议您执行以下操作：

```
int main(int argc, char** argv) {

    vector <int> vec;
    vector <int> vec2;

    for (int i = 0; i < 20000000; i++){
        vec.push_back(i);}

    for (int i = 0; i < vec.size(); i++)
    {
        if(vec.at(i) %3 != 0)
            vec2.push_back(i);
    }

    vec = vec2;
    cout << vec.size() << endl;
} 
```

该代码获取 vec 中不能被 3 整除的每个数字并将其复制到 vec2。之后它将 vec2 复制到 vec 中。它非常快。要处理 20,000,000 个元素，这个算法只需要 0.8 秒！

我用擦除方法做了同样的事情，它需要很多很多时间：

```
Erase-Version (10k elements)  : 0.04 sec
Erase-Version (100k elements) : 0.6  sec
Erase-Version (1000k elements): 56   sec
Erase-Version (10000k elements): ...still calculating (>30 min) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-06-18T22:14:11.520

要删除元素，请使用以下方式：

```
// declaring and assigning array1 
std:vector<int> array1 {0,2,3,4};

// erasing the value in the array
array1.erase(array1.begin()+n); 
```

有关**更广泛的概述**，您可以访问：[http ://www.cplusplus.com/reference/vector/vector/erase/](http://www.cplusplus.com/reference/vector/vector/erase/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-07-11T07:18:05.317

我建议阅读这篇文章，因为我相信这就是你要找的。[https://en.wikipedia.org/wiki/Erase%E2%80%93remove_idiom](https://en.wikipedia.org/wiki/Erase%E2%80%93remove_idiom)

如果您使用例如

```
 vec.erase(vec.begin() + 1, vec.begin() + 3); 
```

您将擦除向量的第 n 个元素，但是当您擦除第二个元素时，向量的所有其他元素将被移动并且向量大小将为 -1。如果您循环遍历向量，这可能会出现问题，因为向量 size() 正在减小。如果您遇到此类问题，建议您使用标准 C++ 库中的现有算法。和“删除”或“remove_if”。

希望这有帮助

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-03-12T13:24:39.020

如果您需要擦除 for 循环内的元素，请执行以下操作：

```
for(int i = 0; i < vec.size(); i++){

    if(condition)
        vec.erase(vec.begin() + i);

} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-25T15:29:34.153

前面的答案假设您**总是**有一个有符号索引。可悲的是，`std::vector`用于`size_type`索引和`difference_type`迭代器算术，所以如果你启用了“-Wconversion”和朋友，它们就不能一起工作。这是回答问题的另一种方式，同时能够处理有符号和无符号：

去除：

```
template<class T, class I, class = typename std::enable_if<std::is_integral<I>::value>::type>
void remove(std::vector<T> &v, I index)
{
    const auto &iter = v.cbegin() + gsl::narrow_cast<typename std::vector<T>::difference_type>(index);
    v.erase(iter);
} 
```

采取：

```
template<class T, class I, class = typename std::enable_if<std::is_integral<I>::value>::type>
T take(std::vector<T> &v, I index)
{
    const auto &iter = v.cbegin() + gsl::narrow_cast<typename std::vector<T>::difference_type>(index);

    auto val = *iter;
    v.erase(iter);

    return val;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-08-23T09:03:31.717

如果你想通过在向量中找到它的值来删除一个元素，这是另一种方法，你只需要在向量上执行此操作。

```
vector<int> ar(n);
ar.erase(remove(ar.begin(), ar.end()), (place your value here from vector array)); 
```

它会从这里删除你的价值。谢谢

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-06-24T06:10:19.110

这个怎么样？

```
void squeeze(vector<int> &v)
{
    int j = 0;
    for (int i = 1; i < v.size(); i++)
        if (v[i] != v[j] && ++j != i)
            v[j] = v[i];
    v.resize(j + 1);
} 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2019-04-26T20:04:55.923

最快的方式（时间复杂度（）=常数的编程竞赛）

1秒可擦除100M条；

```
 vector<int> it = (vector<int>::iterator) &vec[pos];
    vec.erase(it); 
```

和最易读的方式： `vec.erase(vec.begin() + pos);`

# iphone - setNeedsDisplay 并不总是调用 drawRect

> ID：875110
> 
> 赞同：10
> 
> 时间：2009-05-17T18:02:50.000
> 
> 标签：iphone, cocoa-touch

我在自定义表格单元格中有一个自定义视图。每次更改自定义视图上的特定属性时，我都会调用`[self setNeedsDisplay]`它来重绘视图`- (void)drawRect:(CGRect)rect`。该属性在表视图委托的`tableView:cellForRowAtIndexPath:`. 但是当表格视图大于屏幕并且必须重复使用单元格时，`drawRect`并不是每次都调用`setNeedsDisplay`它。尤其是当我快速轻弹桌子的时候。慢速滚动效果很好。这导致第一个和最后一个单元格中的信息通常不正确。

在日志中我可以看到，通常，每次调用都会调用`setNeedsDisplay`，`drawRect`但是当我快速滚动表格视图时，调用的次数会`setNeedsDisplay`多于`drawRect`。当然，这里应该有一个一比一的比例。

我在普通 UIView 中使用相同的自定义视图，并且每次调用`setNeedsDisplay`. 这个问题似乎与表格视图和重用单元格无关。

有谁知道这里发生了什么？有没有其他方法可以强制自定义视图重绘自身？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-17T17:31:38.787

在我发现问题之前，我想我在这个问题上挣扎了将近一个星期。在这里，我不骗你：

指向此自定义视图的指针在 .m 文件而不是 .h 文件中定义，使其成为类变量而不是实例变量。

是的，我非常非常尴尬。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T02:35:51.280

`setNeedsDisplay`只有当视图可见时才会调用`drawRect:`，否则它会使视图的图层无效，并且`drawRect:`会在它变得可见时被调用。

滚动表格视图时，表格视图将请求单元格，希望将它们添加到视图中。如果滚动速度足够快，则某些单元格的准备时间会过长，并且当它们准备好时，它们应该定位的位置已在屏幕外。在这些情况下，表格视图会丢弃它们而不是将它们添加到滚动视图（因此`drawRect:`不会被调用）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T18:45:43.407

你应该打电话`[_table_ reloadData]`重新绘制表格。不是`[_table_cell_ setNeedsDsiplay]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T21:12:07.737

听起来有两种情况下会刷新视图：如果内部值更改（并且您调用`[self setNeedsDisplay]`强制更新），以及如果 tableview 请求绘制（或重用）单元格。在这种情况下，您没有明确地重绘该自定义视图。

根据文档：

> 重用单元格时，tableView:cellForRowAtIndexPath: 中的表视图委托应*始终*重置所有内容。

如果 tableview 正在回收单元格，它会交还一个旧值仍然存在的单元格。确保内容已更新由您决定。根据您设置自定义表格单元格的方式，您可能需要做更多工作以确保视图是最新的，但最简单的事情是在自定义表格单元格处理程序中强制调用`[myCustomView setNeedsDisplay]`.

# .net - 64 到 32 位互操作 - 如何？

> ID：875112
> 
> 赞同：13
> 
> 时间：2009-05-17T18:05:03.723
> 
> 标签：.net, com, interop, x86, 64-bit

我需要将一些遗留的 32 位代码（我没有源代码）集成到一个项目中，以便可以从 64 位 .NET 程序集中调用它。原始代码被实现为 DLL 中的 32 位 COM 对象。Windows 不允许从 64 位对象直接调用到 32 位对象，因此我正在寻找有关如何处理这种情况的灵感。

如何从 64 位 .NET 程序集访问旧的 32 位 COM 对象？

更新：我们发现 COM 组件本身是一些 ANSI C 的包装器，我们为其找到了原始源代码。我们能够在 Visual Studio 中将其编译为原生 64 位 dll，并将其导入 .NET - 抱歉移动了球门柱！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T18:10:21.890

最好的方法是制作一个包含 32 位 DLL 的进程外 COM 服务器。然后您可以从 64 位代码中调用它。

[这里是](http://blog.mattmags.com/2007/06/30/accessing-32-bit-dlls-from-64-bit-code/)对基本概念的解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T18:11:46.270

您需要做的是创建两个与 IPC 通信的进程。这样，一个可以是 32 位的，一个可以是 64 位的。您需要创建一个 32 程序，该程序与 COM 对象链接并通过一些 IPC 机制（例如命名管道）公开其 API。这样，您的 .NET 程序就可以从另一个进程访问它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-22T16:07:49.350

看看这篇[博文](http://www.etherealbits.com/?p=15)。您可以使用运行时可调用包装器从 64 位 .NET 应用程序引用 32 位 COM 程序集。简短的版本如下...

1.  使用 tlbimp.exe 创建 64 位 Runtime Callable Wrapper：

    `tlbimp.exe foo.dll /machine:x64 /out:Interop.Foo.dll`

2.  如果您还没有注册 COM 程序集（不是 RCW）：

    `regsvr32.exe foo.dll`

3.  `Interop.Foo.dll`从您的应用程序中引用 RCW（例如）。将您的构建配置更改为 x64，让我们摇滚吧。

# opengl - 用于 Alpha 透明度的 AMD RenderMonkey GLSG 配置

> ID：875113
> 
> 赞同：1
> 
> 时间：2009-05-17T18:05:54.440
> 
> 标签：opengl, glsl, alphablending

我正在尝试使用 RenderMonkey 设计一个使用 Alpha 透明度的 GLSL 着色器，并且 RenderState 编辑器不使用我在 OpenGL 中使用的相同术语。谁能建议如何将其配置为简单的 Alpha 透明度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:08:34.343

RenderMonkey 分解了源和目标的 RGB 和 A，而 OpenGL 将它们作为一个处理，将 GLenum 中的组合（如 GL_SRC_ALPHA 和 GL_ONE_MINUS_SRC_ALPHA）传递给 glBlendFunc()。例如，GL_SRC_ALPHA 设置了 RGB*和*A 的来源，但 RenderMonkey 似乎想要单独完成它们。So, once you turn on GL_BlendEnable TRUE, you just need to set: GL_BlendDestAlpha INV_SRC_ALPHA (equivalent to the A portion of GL_ONE_MINUS_SRC_ALPHA) GL_BlendDestRGB INV_SRC_ALPHA (equivalent to the RGB portion of GL_ONE_MINUS_SRC_ALPHA) GL_BlendSourceAlpha SRC_ALPHA (equivalent to the RGB portion of GL_SRC_ALPHA) GL_BlendSourceRGB SRC_ALPHA （相当于 GL_SRC_ALPHA 的 RGB 部分）

# php - 在数据库中扩展类

> ID：875116
> 
> 赞同：3
> 
> 时间：2009-05-17T18:08:11.597
> 
> 标签：php, mysql, database-design

我正在开发一个 php 项目，该项目需要存储有关各种建筑物的信息，并将根据建筑物的类型存储不同类型的信息：

```
Class Building {
    var $location
    var $name
} 
```

Building 类将由 House 和 Office 等类扩展，因此这些类将如下所示（仅作为示例）

```
Class House Extends Building {
    var $numRooms;
    var $numBathrooms;
}

Class Office extends Building {
    var $offices;
    var $sqfoot;
} 
```

问题是，这应该如何在数据库中表示（如果重要的话，我使用 MySQL）。我应该使用构建表来存储位置和名称，然后为每个其他类创建一个表来保存“扩展”变量吗？或者我是否为每个班级创建一个表格？或者构建表是否应该包含可以在其他类中的所有变量的列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T18:33:09.247

我强烈建议您查看Martin Fowler 定义的[类表继承模式。](http://www.martinfowler.com/eaaCatalog/classTableInheritance.html)

这种设计模式创建了一个表，其中包含所有建筑物通用的数据，然后需要一个单独的表来存储与特定类型的建筑物相关的任何数据。我发现有帮助的一件事是在父表中存储一个“类型”字段，这样您就知道您拥有什么类型的实体，而无需在子表中搜索相应的记录。

我建议除非你有一个非常具体、明确的理由来使用实体属性设计，否则你应该避免它。一方面，使用这种类型的设计来利用数据库上的约束来控制需要哪些输入以及允许哪些类型的值变得不可能。另一方面，它将大大减慢任何需要从这些类型的字段中提取数据的查询，因为存储在这些字段中的数据无法像通常那样被索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:22:33.680

如果这个想法是不让一堆表格和字段使事情复杂化，我只需为 Building 创建一个表格，然后为数据添加两个字段，一个将定义建筑物的类型（即：房屋、办公室等。 .) 另一个是扩展类对象数据的序列化。

但我认为最好的方法实际上取决于您需要对数据库进行的查询类型。例如，如果您需要查询数据库以选择“$numRooms > 5”的所有“房屋”，则序列化可能不是最佳选择...

# firefox - 在 Firefox 中复制和粘贴

> ID：875119
> 
> 赞同：2
> 
> 时间：2009-05-17T18:10:03.997
> 
> 标签：firefox, wysiwyg, clipboard, copy-paste

在使用所见即所得的编辑器时，我遇到了限制访问剪贴板的 Firefox 的墙（尚未测试 Webkit）。

1.  有人可以解释为什么限制**复制**到剪贴板吗？

    我只是想不出一种可以恶意使用它的方法，而且缺乏“复制”支持的用例比比皆是。
    事实上，诸如[zeroClipboard 之](http://code.google.com/p/zeroclipboard/)类的整个库只是为了方便此功能。

    （我理解——但不同意——允许对剪贴板进行*读取*访问会造成漏洞，尽管弹出窗口会解决这个问题。）

2.  有没有什么好的技巧/方法可以给我一个“粘贴”按钮？我看到帖子中提到了“textarea 技巧”，但没有解释它们是如何工作的。

3.  是否有一个非常常见的场景，即合法用户的生产受到“安全预防措施”的阻碍，而“坏人”使用黑客 [如 zeroClip] 使安全感觉完全错误？

我知道，如果我签署我的脚本，就会有一个复杂的“官方”方法可用。[我没有知识或资源去做]，但即使这样也会在我使用它时生成一个弹出窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T18:50:12.273

同样的原因，站点脚本不能仅仅更改您的书签或写出对本地文件的更改：那些属于用户，并且允许脚本修改它们也允许恶意脚本写出恶意内容或删除有价值的数据。

是的，我们通常认为剪贴板数据“不太重要”，因为它是暂时的。但它仍然属于用户，而不是碰巧打开的任何页面。想象一个脚本，出于防止侵犯版权的[错误希望](https://stackoverflow.com/questions/446334/preventing-selection-copy-to-clipboard-in-firefox)，每 100 毫秒[清除一次剪贴板！](http://blog.gilluminate.com/2006/04/25/prevent-copy-paste-and-print-screen-online/)或者复制危险的系统命令，希望少数用户将它们粘贴到终端而不先仔细检查......

FWIW，从[版本 10](http://www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes_02.html#head31)开始，Flash 还加强了对修改剪贴板的限制：现在，此类修改必须是用户交互的直接结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-23T16:51:57.257

我认为安全问题是从剪贴板*读取的站点。*一个站点可能有一个脚本，它只是被动地读取每个访问者的剪贴板并保存数据。在用户不知情的情况下，该网站可能会收集电子邮件地址、密码、信用卡号、社会保险号等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T18:12:23.120

您可能从不支持撤消的应用程序中剪切了某些内容，或者将某些内容粘贴到其他地方。如果允许自动修改剪贴板，您可能会丢失您剪切的数据。

# python - 数据库中的 Zlib - Django

> ID：875122
> 
> 赞同：1
> 
> 时间：2009-05-17T18:10:58.770
> 
> 标签：python, database, django, django-models, zlib

当我尝试将 zlibbed 字符串放入 models.TextField

```
>>> f = VCFile(head = 'blahblah'.encode('zlib'))
>>> f.save() 
```

它失败：

```
 ...
raise DjangoUnicodeDecodeError(s, *e.args)
DjangoUnicodeDecodeError: 'utf8' codec can't decode byte 0x9c in position 1: unexpected code byte. You passed in 'x\x9cK\xcaI\xccH\x02b\x00\x0eP\x03/' (<type 'str'>) 
```

有没有办法解决这个问题（除了转义字符串 - 它必须是节省空间的）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:59:28.347

就像 Marcus 所说，如果你想保持二进制格式，就必须使用 BLOB。如果您可以对其进行编码，则可以使用 base64 编码：

```
from base64 import binascii

f = VCFile(head = binascii.b2a_base64('blahblah'.encode('zlib'))) 
```

在我对 33k 个字符的非常基本的测试中，zlib 字符串是原始字符串大小的 28%，base64 编码的 zlib 字符串是原始字符串大小的 37%。在压缩方面不太好，但仍然有很大的改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T18:24:58.183

如果您不想对其进行编码，则必须将其存储为二进制对象 (BLOB)，而不是字符串。Django 似乎不支持开箱即用的 BlobFields，所以去网上找到它或一起破解一些东西。

# objective-c - 像 Mobile Safari 一样在其选项卡中淡入/淡出 UIScrollView 的内容

> ID：875129
> 
> 赞同：13
> 
> 时间：2009-05-17T18:14:36.330
> 
> 标签：objective-c, iphone, cocoa-touch, uiscrollview, core-animation

**注意：我在下面的更新答案中添加了我的新解决方案。**

我尝试重现我们在 iPhone/iPod touch 上的 Mobile Safari 选项卡中看到的效果。

基本上，它是一个 UIScrollView，它拥有 4 个可重用的 UIView（充当环形缓冲区），并水平滚动。滚动时，UIView 的不透明度将通过偏移无缝淡入/淡出。

目前，我在`- (void)scrollViewDidScroll:(UIScrollView *)scrollView`. 比如从 UIScrollView 中获取 contentOffset，确定分页，计算 contentOffset 和每个 UIView 位置之间的 delta，决定/设置每个 UIView 在`scrollViewDidScroll:`被调用时的 alpha 值。

它可以工作，性能还可以，一切运行顺利，但唯一的问题是计算量太大。

我试过UIView的`beginAnimations:`and `commitAnimations:`，但是在里面没用`scrollViewDidScroll:`，因为1）新的alpha值还是要自己计算，2）scrollViewDidScroll：滚动的时候一直调用，这里做动画没意义。有没有办法用 Core Animation 重写这部分？所以我不必自己计算每个 UIView 的 alpha 值，相反，我可以将整个作品留给 Core Animation。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-24T14:36:50.693

**更新**

我想出了另一种方法来更新每个页面的 alpha 值。创建内容视图时，我使用 KVO 添加带有 UIScrollView 的 contentOffset 的观察者：

```
[self.scrollView addObserver:[self.contentViews objectAtIndex:i] 
                  forKeyPath:@"contentOffset" 
                     options:NSKeyValueObservingOptionNew
                     context:@selector(updateAlpha:)]; 
```

这样我的每个 contentViews 都会在 contentOffset 更改时收到消息：

```
- (void)observeValueForKeyPath:(NSString *)keyPath 
                      ofObject:(id)object 
                        change:(NSDictionary *)change 
                       context:(void *)context {
    [self performSelector:(SEL)context withObject:change];
} 
```

我的 contentViews 可以在滚动时自行计算和动画：

```
- (void)updateAlpha:(NSDictionary *)change {
    CGFloat offset = [[change objectForKey:NSKeyValueChangeNewKey] CGPointValue].x;
    CGFloat origin = [self frame].origin.x;
    CGFloat delta = fabs(origin - offset);

    [UIView beginAnimations:@"Fading" context:nil];
    if (delta < [self frame].size.width) {
        self.alpha = 1 - delta/self.frame.size.width*0.7;
    } else {
        self.alpha = 0.3;
    }
    [UIView commitAnimations];
} 
```

当然，当您从 superview 中删除内容视图时，您需要删除观察者，并在创建新的内容视图时再次添加它们。

希望这对那些想要做同样事情的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:01:09.697

正如您从 scrollViewDidScroll: 调用频率中所注意到的那样，UIScrollView 不会简单地触发并忘记核心动画转换：它会根据触摸、加速度等手动移动边界。没有直接的方法可以改变这一点。

但是，如果您被滚动事件淹没，您可以尝试以下技巧：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    NSTimeInterval timestamp = [[NSDate date] timeIntervalSince1970];
    if (timestamp - _savedTimestamp) < 0.1)
        return;
    _savedTimestamp = timestamp;

    // do the rest of your work here
} 
```

H

# .net - 使用 LINQ to SQL 时如何抽象出持久性代码？

> ID：875130
> 
> 赞同：6
> 
> 时间：2009-05-17T18:14:51.977
> 
> 标签：.net, linq-to-sql

我喜欢 LINQ to SQL，但它一直困扰着我，在使用它时，我的存储库代码由 LINQ to SQL 框架生成，因此与 SQL Server 数据库紧密耦合。

你们中是否有人以抽象、松散耦合的方式使用 LINQ to SQL？如果是，你们是如何解决保持代码独立于数据库的问题的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T19:37:02.787

为了我自己; 我满足于重用 LINQ/dbml 生成的对象模型，因为实际上属性不会伤害我，并且任何其他实现都可以提供足够相似的模型 - 但我不使用我的数据上下文在 DAL 之外。所以我有类似的东西：

*   `IFooRepository`- 使用生成的 dbml 对象和一些 POCO 模型类定义可用的方法
*   `FooRepository`- 了解数据上下文的实现

我的存储库方法不公开 LINQ 概念，例如`IQueryable<T>`and `Expression<...>`，因为它们是[泄漏的抽象](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)；其他实现会以不同的方式工作（例如，EF 支持两者的不同方面）。

此外 - 我已将大多数关联属性标记为内部属性，并且仅在 DAL 查询期间使用它们（在 OO 工作期间并没有那么多）。

我可以映射到纯 POCO，但我没有看到好处。我在这里对此有更多想法：[Pragmatic LINQ](http://marcgravell.blogspot.com/2009/02/pragmatic-linq.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:33:26.830

您可以使用类似于[NerdsDinner](http://nerddinnerbook.s3.amazonaws.com/Intro.htm)中使用的方法。这个项目使用 dat 上下文作为数据库的网关，并围绕它构建一个存储库。

这种存储库模式根据被调用的方法添加一些条件、过滤器、排序命令......等，然后将一个 IQuerable 返回给调用者，让门打开以供进一步修改。

实际上，在围绕 NHibernate ISession 构建存储库时，您的做法几乎相同。

例如，如果您决定用 NHibernate 替换 LinqtoSql，您只需在存储库中查询一个 Linq 会话，而不是数据上下文一个。当然，您需要使用 LinqtoSql 自动添加的属性来完成部分类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T01:50:40.903

嘿内森，好问题。

正如其他人所说，最好的办法是抽象所有 GET/WRITE 方法，并将 DataContext 完全隐藏在业务逻辑之外。

我的方法是用一堆通用方法编写一个 DAL，这些方法使用反射来做任何必要的事情。

在这些情况下，一旦方法接收到一个对象，比如“产品”，它就可以在内部独立于你的 ORM/数据访问技术做任何它想做的事情。如果你愿意，它可以只写一个基于几个参数的 SQL 字符串，以及对象的反射。

**但是**，单独执行此操作并不能完全将您从 LINQ 分离到 SQL。

问题实际上是实体本身。即使您抽象了检索数据的方法，您仍然会在业务​​逻辑的整个过程中使用这些实体。

我觉得，目前，这只是我准备接受的东西，因为重新编写我自己的断开连接的实体似乎是一座我还没有准备好跨越的桥梁，只是因为它似乎有很多不必要的工作...

不过，我很想看看其他人如何解决这个问题。

干杯！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-18T01:13:44.707

上面的 Mouk 提到了 NerdsDinner 中的存储库模式，这里还有一个如何快速设置它的教程：

[http://www.asp.net/learn/mvc/tutorial-10-cs.aspx](http://www.asp.net/learn/mvc/tutorial-10-cs.aspx)

这是一个很好的小系列教程，在 NerdsDinner 之前发布。这里的概念也可以在传统的 asp.net 网络表单应用程序中设置。

另外，我建议使用 Linq To Entities（更新的，对其他数据库的更多支持），一些基础知识在这里： [http ://www.asp.net/learn/mvc/tutorial-16-cs.aspx](http://www.asp.net/learn/mvc/tutorial-16-cs.aspx)

# java - 如何在框架可见后调用 setUndecorated()？

> ID：875132
> 
> 赞同：21
> 
> 时间：2009-05-17T18:17:17.540
> 
> 标签：java, swing, fullscreen

在我的 Swing 应用程序中，我希望能够在装饰和未装饰之间切换，而无需重新创建整个框架。但是，API 不允许我`setUndecorated()`在框架可见后调用。

即使我打电话`setVisible(false)`，`isDisplayable()`仍然返回真。API 说，使框架不可显示的唯一方法是重新创建它。但是，我不想仅仅为了关闭一些标题栏而重新创建框架。

我正在制作一个可以在全屏和窗口模式之间切换的全屏应用程序；它应该能够在保持状态等的同时进行切换。

可见帧后如何执行此操作？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-17T19:38:52.270

你试过打电话`Frame.dispose()`然后换吗？自己没有尝试过，但它可能会起作用。

如果没有，那么您可以做的就是让框架成为类中无关紧要的部分，只有最低限度的挂钩必须连接到最高级别的面板或面板，然后将它们移动到新框架。所有的孩子都会跟着。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-18T09:52:02.640

你不能。当我试图达到同样的目标时，这就是我的经验。

但是，如果您将整个 UI 放在框架中的一个面板中，则可以创建一个新框架并将该面板添加到框架中。没有那么多工作。

像这样的东西：

```
// to start with
JPanel myUI = createUIPanel();
JFrame frame = new JFrame();
frame.add(myUI);

// .. and later ...

JFrame newFrame = new JFrame();
newFrame.setUndecorated();
newFrame.add(myUI); 
```

在 Swing 中，面板（实际上是组件的任何实例）一次只能在一个框架中，因此当您将其添加到新框架中时，它会立即停止在旧框架中。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-07-30T11:50:10.053

看看[https://tvbrowser.svn.sourceforge.net/svnroot/tvbrowser/trunk/tvbrowser/src/tvbrowser/ui/mainframe/MainFrame.java](https://tvbrowser.svn.sourceforge.net/svnroot/tvbrowser/trunk/tvbrowser/src/tvbrowser/ui/mainframe/MainFrame.java)

在方法中`switchFullscreenMode()`：

```
dispose();
...
setFullScreenWindow(...);
setUndecorated(true/false);
setBounds(mXPos, mYPos, mWidth, mHeight);
...
setVisible(true); 
```

实际上，还有很多东西可以隐藏各种侧面板，如果鼠标接触到这些侧面板，这些侧面板就会重新出现。

另请注意，您必须明确设置边界。`Window.setExtendedState(MAXIMIZED_BOTH)`在 dispose() 的及时附近严重干扰，因为它们都依赖于操作系统的多个本机事件，如果窗口在那一瞬间无法显示，这些事件就会丢失。

我不建议直接使用默认屏幕：

```
GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice(); 
```

而是使用屏幕，您的 JFrame 当前处于打开状态：

```
setBounds(getGraphicsConfiguration().getBounds());
getGraphicsConfiguration().getDevice().setFullScreenWindow(this); 
```

虽然现在是一样的，但将来可能会改变。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-12-05T10:55:14.947

调用`dispose()`释放本机窗口资源。然后您可以编辑未装饰等属性。然后只需调用`setVisible(true)`重新创建窗口资源，一切正常（位置和所有组件都不会改变）

```
dispose();
setUndecorated(true/false);
setVisible(true); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-12T13:42:49.237

尝试：

```
dispose();
setUndecorated(true);
setVisible(true); 
```

看看这个。希望它会有所帮助！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T18:23:01.510

好吧，您将需要不同的框架实例。您可以在不重新创建框架的情况下移动框架的内容。这里的关键是让你的代码不依赖于特定的框架。无论如何，这是一个基本的良好做法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-31T14:56:53.160

以下是如何使`ALT`+`Enter`进入没有栏模式的全屏和最小化并显示标题栏和开始栏的代码：

```
public class myTest extends JFrame{
 //Your codes...
     //if "ALT" key on hold and "Enter" key pressed with it
     if (evt.isAltDown() && evt.getKeyCode() == evt.VK_ENTER) {    
         //if the JFrame has Title bar
         if (isUndecorated()) {
             //this will dispose your JFrame
             dispose();
             //here to set it with no Title bar
             setUndecorated(false);
             pack();
             setLocationRelativeTo(null);
             //as you dispose your JFrame, you have to remake it Visible..
             setVisible(true);
          } else {
             dispose();
             setUndecorated(true);
             setExtendedState(MAXIMIZED_BOTH);
             setVisible(true);
        }
    }
//your codes
} 
```

# apache-flex - flex 3 server.error.request 发送 web 服务

> ID：875135
> 
> 赞同：0
> 
> 时间：2009-05-17T18:17:51.347
> 
> 标签：apache-flex, flex3

我有一个 .net web 服务，我在 flex 中调用它，然后我有一个表单，我通过 web 服务中的另一种方法将新帖子插入到表中。但是当我尝试插入该方法时， flex 会产生错误：

> [RPC 故障 faultString="HTTP 请求错误" faultCode="Server.Error.Request" faultDetail="Error: [IOErrorEvent type="ioError" bubbles=false cancelable=false eventPhase=2 text="Error #2032: Stream Error。网址： [http://localhost:xxxxx/xxxx/xxxx.asmx](http://localhost:xxxxx/xxxx/xxxx.asmx) "]。网址： [http://localhost:xxxx/xxxx/xxxx.asmx](http://localhost:xxxx/xxxx/xxxx.asmx) "]

但是该方法工作正常，并且该帖子已添加到数据库中。这有点令人困惑，因为我真的不知道 Flex 在做什么。在 .NET Web 服务中拥有多个方法怎么样，这有关系吗？或者尝试在 flex 中使用不同的 web 服务调用来调用相同的 URL。

有谁知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:41:27.187

[将“ http://localhost:xxxxx/xxxx/xxxx.asmx](http://localhost:xxxxx/xxxx/xxxx.asmx) ”复制并粘贴到您的浏览器中，并确保您可以查看该页面...

还要确保您的 wsdl 参数如下所示： wsdl="http://localhost:xxxxx/xxxx/xxxx.asmx?wsdl"

# c# - 如何从 XmlNodeList 中删除 XmlNode

> ID：875136
> 
> 赞同：29
> 
> 时间：2009-05-17T18:17:54.717
> 
> 标签：c#, xml

我需要根据条件删除 XmlNode。怎么做？

```
foreach (XmlNode drawNode in nodeList)
{
       //Based on a condition
       drawNode.RemoveAll();  //need to remove the entire node                      

} 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-17T18:29:14.370

这应该为您解决问题：

```
for (int i = nodeList.Count - 1; i >= 0; i--)
{
    nodeList[i].ParentNode.RemoveChild(nodeList[i]);
} 
```

如果您使用常规 for 循环进行循环，并“向后”循环，您可以随时删除项目。

更新：这是一个完整的示例，包括加载 xml 文件、定位节点、删除它们和保存文件：

```
XmlDocument doc = new XmlDocument();
doc.Load(fileName);
XmlNodeList nodes = doc.SelectNodes("some-xpath-query");
for (int i = nodes.Count - 1; i >= 0; i--)
{
    nodes[i].ParentNode.RemoveChild(nodes[i]);
}
doc.Save(fileName); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T18:22:47.703

您不能轻易使用迭代器（foreach 语句）来删除您的节点。如我所见，您可以执行以下操作：

1) 在你的 foreach 循环中，保存所有应该删除的元素的列表。然后你只遍历这些元素并删除它们。

2) 使用普通的 for 循环并跟踪删除一个项目后要访问的下一个元素。

编辑：当使用 for 循环时，按照 Fredrik 建议的方式进行，向后循环。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T18:24:25.237

如果您尝试从 XML DOM 中删除节点，这不是正确的方法。因为 an`XMLNodeList`只是一个节点列表。相反，您想从父节点中删除该节点。像这样：

```
XmlNode parentNode = // some value
XmlNode drawNode = // some value
parentNode.ParentNode.RemoveChild(drawNode); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-13T18:15:19.353

下面是不是更简单一点：

```
XmlDocument doc = new XmlDocument(); 
doc.Load(fileName); 
XmlNodeList nodes = doc.SelectNodes("some-xpath-query"); 
while (nodes.FirstChild != null) {     
    nodes.RemoveChild(nodes.FirstChild); 
} 
doc.Save(fileName); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-11-15T02:08:49.900

在我看来，您只是想删除整个 XML 元素...

如果这是您的 XML...

```
<Xml1>
  <body>
    <Book>
      <Title name="Tom Sawyer" />
      <Author value="Mark Twain" />
    </Book>
    <Book>
      <Title name="A Tale of Two Cities" />
      <Author value="Charles Dickens" />
    </Book>
  </body>
</Xml1> 
```

如果你想删除一本书，你需要抓取第一个`<Book>`节点。你可以这样做：

```
XmlDocument doc = new XmlDocument();
doc.Load(fileName);

XmlNodeList nodes = doc.GetElementsByTagName("body");
XmlNode bodyNode = nodes[0];
XmlNode firstBook = bodyNode.ChildNodes[0]; 
```

拥有“第一本书”节点后，您可以使用以下命令从正文节点中删除它：

```
bodyNode.RemoveChild(firstBook); 
```

这将自动影响/更新 XML Document 变量，因此`doc`现在只有：

```
<Xml1>
  <body>
    <Book>
      <Title name="A Tale of Two Cities" />
      <Author value="Charles Dickens" />
    </Book>
  </body>
</Xml1> 
```

如果你想抓取并删除整个`body`，你应该能够做到：

```
XmlNodeList xml1 = doc.GetElementsByTagName("Xml1");
XmlNode xmlNode = xml[0];
xmlNode.RemoveChild(bodyNode); 
```

并且`doc`变量将被更新为不再包含该`body`元素，然后可以重新保存到文件系统：

```
doc.Save(fileName); 
```

`fileName`您计算机上 XML 文档的完整路径在哪里。

最重要的是，我们没有使用`doc.SelectNodes()`，所以我们不必担心使用`XMLNamespaceManager`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-11T09:45:20.327

```
 XmlNodeList xnodeContact = xmldocContact.GetElementsByTagName("contact");
          foreach (ListViewItem item in listViewContacts.Items)
            {
                if (item.Checked)
                {
                    if (item.Index >= 0)
                        xnodeContact[0].ParentNode.RemoveChild(xnodeContact[0]);
                        listViewContacts.Items.Remove(item);
                    }
                }
            }
            xmldocContact.Save(appdataPath + "\\WhatAppcontactList.xml");
            Invalidate(); 
```

# ruby-on-rails - 在 Ruby On Rails 中发布 XHR 操作之前如何更改请求参数？

> ID：875138
> 
> 赞同：0
> 
> 时间：2009-05-17T18:18:22.860
> 
> 标签：ruby-on-rails, ajax, xmlhttprequest, prototypejs

我有一个表格，其中包含人员列表，旁边有复选框。然后我有一个`submit_to_remote`将被检查的人传递给控制器​​进行处理。它目前通过以下形式的检查人员：

```
checkbox_name => checkbox_value 
```

`checkbox_value`在哪里`person_id`。这来自`parameters:Form.serialize(this.form)` 用于构建参数的原型。

但是，由于该`submit_to_remote`按钮是一个“禁用”按钮，我想要一个看起来像这样的操作：

```
people/disable/person_id1,person_id2,person_id3 
```

这会禁用这些人，而且我认为语法对 API 更友好。

如何在 Ajax 更新程序使用`submit_to_remote`帮助程序中的选项提交之前更改参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T18:26:25.093

使用 Form.serialize(true) 获取以参数名称作为键的哈希。

您可以对该散列执行任何操作，包括删除输入、更改其值、过滤它们等等。

Ajax.Updated 然后将接受修改后的哈希作为参数。

哦，如果您想要此表单的另一个目标，只需指定它！如果我没记错的话，这是第一个参数。

# iphone - 苹果手机开发

> ID：875142
> 
> 赞同：-1
> 
> 时间：2009-05-17T18:20:45.943
> 
> 标签：iphone

今天似乎每个人都对构建 iPhone 应用程序感兴趣。你必须有一部 iPhone 才能构建应用程序吗？是否有模拟 iphone 体验的开发/测试环境以避免购买。

如果是，下一步将采取哪些措施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T18:37:15.637

开发 iPhone 应用程序不需要 iPhone。您也可以使用 iPod Touch。如果您不想购买任何一种设备，iPhone SDK 附带一个 iPhone 模拟器，您可以使用它来测试您的应用程序。然而，模拟器有许多限制，例如缺少加速度计。

请记住，您还需要一台至少装有 Mac OS X 10.5 版的 Macintosh 计算机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T18:35:46.887

如果您计划在 Apple Store 上发布您的应用程序，那么它必须使用 Apple 的 iPhone 开发工具包进行开发。该开发套件可从其网站下载。（你可以使用各种开源开发工具包，让你的应用程序在“越狱”手机上运行。）我认为你也必须加入苹果开发者计划——大约 99 美元左右。

问题是开发工具包只能在 MacOS 上运行，所以你必须有一个 Apple 才能开发应用程序。它带有一个软件模拟器，因此您不一定需要拥有一部真正的 iPhone。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T18:36:15.560

从技术上讲，您不必拥有 iPhone 来编写 iPhone 程序，但您必须（如果您通过正常的、非 hackintosh 渠道）拥有基于 Intel 的 Mac，并且在设备上测试您的应用程序是 100，如果不比在模拟器中测试有用 1000 倍。

[前往 Apple 的开发者网站](http://developer.apple.com/iphone)注册成为开发者（免费，直到您想在设备上进行测试，见上文）并下载 Xcode。这将包括 iPhone SDK 和 iPhone 模拟器。

# javascript - 从 HTML 中删除 JavaScript 代码

> ID：875145
> 
> 赞同：1
> 
> 时间：2009-05-17T18:22:19.187
> 
> 标签：javascript

我正在寻找 C# 正则表达式来替换/删除 HTML 中的所有 JavaScript。有人可以帮我写代码吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T18:35:05.330

仅删除`<script>`标签实际上不会这样做。那是因为您也可以将 Javascript 放入事件处理程序中（onclick 等）。用正则表达式很难捕捉到它们。

再一次，我们重新审视这个问题，或者用正则表达式解析或处理 HTML。这是工作的错误工具。如果您不想要片状代码，请使用 HTML 解析器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T18:36:39.617

为什么要过滤 javascript？

如果您试图防止 Web 应用程序中的跨站点脚本攻击，您最好使用经过良好测试的库来实现此目的。看起来微软有一个可能有用的[AntiXSS库。](http://www.microsoft.com/downloads/details.aspx?FamilyID=051ee83c-5ccf-48ed-8463-02f56a6bfc09&DisplayLang=en "反XSS")

# c - 在 MinGW 3.4.5 中使用 -ansi 开关的问题

> ID：875148
> 
> 赞同：2
> 
> 时间：2009-05-17T18:23:00.980
> 
> 标签：c, gcc, header, mingw, c89

我正在阅读 gcc 中使用的标志，并阅读了使用`gcc -ansi -pedantic -Wall file1 [file2 [file3...]] -o output`. 为了我的代码质量，保持它的标准，并得到所有关于它的警告。

好吧，关于使用 -ansi 编译...如果我包含`<stdlib.h>`，gcc 会给我这个错误：

`In file included from ansi.c:2: C:/c/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdlib.h:317: error: syntax error before "double"`

那一行是这样的：

```
inline double __cdecl __MINGW_NOTHROW strtod (const char* __restrict__ __nptr, char** __restrict__ __endptr)
{ return __strtod(__nptr, __endptr); } 
```

在 C中不`inline`存在？“标准”标题不应该是标准 ansi 吗？我应该删除内联还是避免使用 stdlib.h 编译（我现在真的不记得 stdlib 中有什么了）？

## **更新**

通过阅读 Adam 发布的链接，我发现“inline”不是 C89 中的关键字，而 C89 是使用 -ansi 开关强制执行的。我不得不把它改成`__inline__`一个 MinGW 宏。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T18:31:01.950

这似乎是 mingw 中的一个已知问题： [link to archive mingw mailing list](http://lists-archives.org/mingw-users/11944-new-error-with-latest-cvs-stdlib-h.html)

它告诉 inline 不是 c89 标准的一部分（因为 -ansi 强制它），它应该被替换`__inline__`为

如果您阅读下一封电子邮件，有人会告诉他已直接在 cvs 中修复了此错误。查看新代码并查看（？）然后告诉我们。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:34:57.777

inline 不是 gcc 3.4.5 认为是 ANSI C 的一部分 - 它是 C99 的一部分，我想你能确认你使用的是哪个版本的 gcc 吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T18:53:36.743

在编译到特定标准之前，我遇到过这个问题。在我正在编译的 Linux 系统上，pthread rwlock 标头不符合 c99 标准（或者不符合 ifndef 标准）。在这些情况下你必须小心，检查预处理器的输出有时会在这些情况下有所帮助。

# css - CSS显示属性参数

> ID：875151
> 
> 赞同：0
> 
> 时间：2009-05-17T18:23:37.623
> 
> 标签：css

我有一个包含许多缩略图的容器框。我之前用所有的拇指制作了一个 div，但这效率不高。我现在将所有差异拇指包含在标签中，并将它们包含在同一类中。

在我的类属性中：

```
.thumb-wrap {
    float: left;
    display: block;
    margin: 5px;
}

.thumb {
    padding: 4px;
}
.thumb-img {
    width: 100px;
    height: 75px;
    border: 1px solid #999;
    padding: 5px;
    background-image:url(slide-bg.jpg);
} 
```

html是：

```
 <div class="thumb-wrap">
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>
        <a href="#" class="thumb" ><img src="img0-thumb0.jpg" class="thumb-img"/>   </a>

        </div> 
```

但是拇指出现在框中的中心。我不想要那个。我希望它们左对齐。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T18:57:14.943

如果您将它们包装在 div“thumb-wrap”中，您也不需要链接上的类“thumb”或图像上的“thumb-img”。

只需使用父关系：

```
.thumb-wrap {
    float: left;
    display: block;
    margin: 5px; 
```

}

```
 .thumb-wrap a {
    padding: 4px; 
```

}

```
 .thumb-wrap img {
    width: 100px;
    height: 75px;
    border: 1px solid #999;
    padding: 5px;
    background-image:url(slide-bg.jpg); 
```

}

这将使您的 HTML 更干净。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T02:32:09.907

与其使用 div 来包含您的拇指，不如使用列表更符合语义：

```
<ul class="thumbs">
   <li><a href="#"><img src="img0-thumb0.jpg" /></a>
   <li><a href="#"><img src="img1-thumb1.jpg" /></a>
   <li><a href="#"><img src="img2-thumb2.jpg" /></a>
   <li><a href="#"><img src="img3-thumb3.jpg" /></a>
</ul> 
```

然后，您不需要列表中的每个锚点和每个图像上的类，因为您可以像这样定位它们：

```
ul.thumbs li a {
   /* anchor styles here */
}
ul.thumbs li a img {
   /* image styles here */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T18:26:42.737

对不起大家。这很愚蠢。我`text-align: center;`在体内。

# iphone - NSURL URLWithString：引发异常

> ID：875160
> 
> 赞同：5
> 
> 时间：2009-05-17T18:29:15.697
> 
> 标签：iphone, objective-c, crash-reports

简而言之，`[NSURL URLWithString:]`似乎引发了异常。根据文档“如果字符串格式错误，则返回 nil。” 没有提到在任何情况下都会引发异常。除此之外，我`nil`在将字符串转换为 URL 之前对 URL 进行编码和检查。

任何人都可以就它可能是哪个异常或在转换 URL 之前我应该​​进行哪些其他错误检查提供任何建议？

如果您对细节感兴趣，调用代码如下所示：

```
NSString* tmpText = [newUrl stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
if (tmpText == nil) {
    // error handling
}
else {
    NSURL* tmpURL = [NSURL URLWithString:tmpText]; 
```

这是从 iTunes Connect 下载的崩溃报告的一部分：

```
8   libobjc.A.dylib                 0x300c1f84 objc_exception_throw
9   CoreFoundation                  0x3029a598 +[NSException raise:format:arguments:]
10  CoreFoundation                  0x3029a538 +[NSException raise:format:]
11  Foundation                      0x30696dde -[NSURL initWithString:relativeToURL:]
12  Foundation                      0x30696cd8 +[NSURL URLWithString:relativeToURL:]
13  Foundation                      0x30696cae +[NSURL URLWithString:]
14  Yummy                           0x000146ca -[DeliciousPostCell setUrl:] + 46 
```

似乎该 URL 以某种方式采用了“错误”格式，但这确实应该返回一个`nil`非异常。

我从未见过自己引发异常，因此我无法使用 XCode 来捕获代码并查看发生了什么。遇到问题的用户从未直接联系过我，所以我无法询问更多细节。任何建议都非常感谢。

*更新（2009 年 14 月 7 日）*：看起来像这样的 hack，但我在可疑行周围添加了一个异常块。我还提出了 Radar 错误报告 (#7031551)，建议代码应与文档匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T19:02:25.603

我遇到了一些 API 抛出异常的情况，这些异常根据文档不应该出现。我的建议是确保（在您的实际代码中） tmpText 确实不是 nil （在这种情况下会引发异常，因为大多数期望 NSStrings 的 api 不是 nil 保存在那里）。之后，只需在其周围添加异常处理并将错误报告提交到 bugreporter.apple.com 即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T19:41:08.990

值得记录字符串的原始值以查看输入的`-initWithString:`内容。需要注意的一件事是，它`-stringByAddingPercentEscapesUsingEncoding:`只会转义 url 中非法的字符，它们在任何情况下都不是上下文敏感的。所以如果输入字符串是'http::::host;:'，那么它不会有任何字符被转义，并且仍然是一个无效的URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T19:03:19.160

您的字符串 ,`tmpText`必须以某种方式格式错误（这意味着它的某些内容不符合[RFC 2396](http://www.faqs.org/rfcs/rfc2396.html)）。不幸的是，由于您无法从用户那里获得该变量的确切内容，因此我无法帮助您找出其格式错误的原因。有关类似行为的报告，请参阅Apple 的 Open Radar 上的[这篇文章。](http://openradar.appspot.com/6810626)我知道该报告是关于传递`nil`到`URLWithString`的，但如果它`nil`与任何其他格式错误的字符串相同，则行为（抛出异常）可能是相同的。

我建议看看是如何`newUrl`创建的，看看你是否能找到任何可能不允许字符进入的边缘情况。我的猜测是这就是你的问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-15T19:16:35.507

NSURL 为格式错误的 url 返回 nil，NSLog 你的字符串并设置断点以准确查看传递给你的 NSURL 创建方法的内容。如果您的 URLWithString 使用硬编码值，则进一步证明您传递的任何内容都是格式错误的。小心使用 stringByAddingPercentEscapesUsingEncoding 和其他字符串方法，因为它们还可以添加一些额外的废话，您的 NSURL 收件人可能会窒息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T10:26:42.617

在使用之前，您能否做一个日志并查看 newUrl 和 tmpText 中存在的内容。这应该让您知道从哪里开始寻找。

stringByAddingPercent... 永远不会返回 nil（除非 newUrl 为 nil）。

如果传递给它的字符串格式错误，则 URLWithString: 调用将返回 nil。所以 url 对象是你应该注意的 nil 检查（在调用 openURL: 方法之前）

# c# - 将我的 SQL 转换为 LINQ

> ID：875161
> 
> 赞同：0
> 
> 时间：2009-05-17T18:29:53.917
> 
> 标签：c#, linq

这是我编写的代码，但我想使用 LINQ，你能帮我将此代码转换为 LINQ 吗？

```
/// <summary>
/// Stores the request in the PublisherRequests table and
/// the selected categories in the PubReq_Categories table.
/// </summary>
/// <param name="UserId">The user's ID logged in.</param>
/// <param name="Url">URL of the site that you want show the banner on it.</param>
/// <param name="TypeId">The type id of the banner type you want to show.</param>
/// <param name="CategoryIds">A set of category IDs depend on your banner.</param>
/// <returns></returns>

public static int PutRequest(string UserId,string Url,int TypeId,int[] CategoryIds)
{
    int reqId;

    using ( SqlConnection cnn = new SqlConnection(ConfigurationManager.ConnectionStrings[0].ConnectionString) )
    {
        //Retrieves the last RequestId from database.
        string selectLastReq = "SELECT TOP 1 RequestId FROM PublisherRequests WHERE UserId=" +
            UserId.ToString() + "ORDER BY RequestId DESC";
        SqlCommand cmdSelect = new SqlCommand(selectLastReq, cnn);

        //For inserting the new request in the database.
        string insertRequest = string.Format("INSERT INTO PublisherRequests(" +
            "RequestId, UserId,PageUrl, TypeId) VALUES ('{0}','{1}',{2})",
            UserId, Url, TypeId);
        SqlCommand cmdInsert = new SqlCommand(insertRequest, cnn);

        //For inserting each category for the request on a new row.
        string insertReqCat = string.Format("INSERT INTO PubReq_Categories(" +
            "RequestId, CategoryId) VALUES (@ReqId,@CatId)");
        SqlCommand cmdInsertReqCat = new SqlCommand(insertReqCat, cnn);
        cmdInsertReqCat.Parameters.Add("@ReqId", SqlDbType.Int);
        cmdInsertReqCat.Parameters.Add("@CatId", SqlDbType.Int);

        cnn.Open();

        //New request insertion.
        cmdInsert.ExecuteNonQuery();

        //Retrieve last request number.
        reqId = Convert.ToInt32(cmdSelect.ExecuteScalar());

        //Categories insertion.
        cmdInsertReqCat.Parameters["@ReqId"].Value = reqId;
        foreach ( int catId in CategoryIds )
        {
            cmdInsertReqCat.Parameters["@CatId"].Value = catId;
            cmdInsertReqCat.ExecuteNonQuery();
        }
    }

    return reqId;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T18:45:35.887

假设您正在使用设计器，RequestId 列是自动生成的，您在两个类之间有关联，并且您的类命名如下，我认为这会起作用。

```
using (var context = new DBDataContext())
{
    var request = new PublisherRequest
                  {
                     UserId = UserId,
                     PageUrl = Url,
                     TypeId = TypeId
                  };

    for (var categoryId in CategoryIds)
    {
         request.PubReqCategories.Add( new PubReqCategory
                                       {
                                           CategoryId = categoryId 
                                       } );
    }

    context.PublisherRequests.InsertOnSubmit( request );
    context.SubmitChanges();
} 
```

# apache-flex - 无法克隆扩展的 ByteArray

> ID：875163
> 
> 赞同：0
> 
> 时间：2009-05-17T18:30:11.453
> 
> 标签：apache-flex, flash, actionscript-3

我扩展了 ByteArray 类，如下所示：

```
[RemoteClass(alias="MyByteArray")]
public class MyByteArray extends ByteArray {} 
```

并使用 ByteArray#readObject()/writeObject() 克隆了此类的一个实例。但是，由于某种原因，克隆的对象是 ByteArray 的实例，而不是 MyByteArray。这在以下示例中进行了说明：

```
registerClassAlias("MyByteArray", MyByteArray);
var b1:MyByteArray = new MyByteArray();
var tmp:ByteArray = new ByteArray();
tmp.writeObject(b1);           
tmp.position = 0;
var b2:* = tmp.readObject();
trace( b2 is MyByteArray ); // prints false
trace( b2 is ByteArray ); // prints true 
```

此外，当我在 MyByteArray 类中添加一些自定义字段时，它们不会用 writeObject() 保存，也不会克隆......

谁能解释我为什么克隆的对象不是 MyByteArray 的实例？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T21:47:37.323

我认为这是因为 tmp 是 ByteArray 类型，而不是 MyByteArray 类型。如果你制作 MyByteArray 类型的 tmp，它应该返回一个相同类型的对象，我认为使用 writeObject？或者您可能需要对它进行类型转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T10:02:41.857

ByteArray 可能作为对象序列化的特殊情况处理，所以我怀疑你会绕过它。

尝试对 ByteArray 进行子类化对我来说听起来像是一种代码味道。我会考虑使用封装而不是继承来解决您的问题。

# java - 块级同步

> ID：875175
> 
> 赞同：10
> 
> 时间：2009-05-17T18:35:26.637
> 
> 标签：java, synchronization

传递给同步的参数有什么意义？

```
synchronized ( parameter )
{

} 
```

实现块级同步。在某处我看到了类似的代码

```
class test
{
    public static final int lock =1;

    ...

    synchronized(lock){
       ...
    }
} 
```

我不明白这段代码的目的。

谁能给我一个更好的例子和/或解释它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-17T18:43:25.063

这是锁定的参考。基本上，两个线程不会同时执行使用相同引用同步的代码块。正如 Cletus 所说，同步*方法*主要等同于`synchronized (this)`在方法内部使用。

我非常希望您看到的示例代码不是*那样*- 您正在尝试在原始变量上进行同步。同步仅适用于监视器（通过引用） - 即使它*是*合法代码，`x`也会被装箱，这将导致一些*非常*奇怪的行为，因为某些整数将始终被装箱到相同的引用，而其他整数将创建一个新的每次你装箱时都反对。幸运的是，Java 编译器意识到这是一个非常糟糕的主意，并且会为您发布的代码提供编译时错误。

更合理的代码是：

```
class Test
{
    private static final Object lock = new Object();

    ...

    synchronized(lock){
       ...
    }
} 
```

我已将锁设为私有，并将其类型更改为`Object`. 它是否应该是静态的取决于情况 - 如果您想从多个线程访问/更改静态数据，通常通常使用静态变量；当您想从多个线程访问/更改每个实例的数据时，实例变量通常用于锁定。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-17T18:37:57.367

这个：

```
public synchronized void blah() {
  // do stuff
} 
```

在语义上等价于：

```
public void blah() {
  synchronized (this) {
    // do stuff
  }
} 
```

有些人不喜欢使用“this”进行同步，部分原因是它是公共的（因为实例对外部代码可见）。这就是为什么您最终会遇到使用私人锁的人：

```
public class Foo
  private final static String LOCK = new String("LOCK");

  public void blah() {
    synchronized (LOCK) {
      // do stuff
    }
  }
} 
```

好处是 LOCK 在类之外是不可见的，而且您可以创建多个锁来处理更细粒度的锁定情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T18:41:13.010

该`synchronized`语句的目的是确保在多线程应用程序中，在给定时间只有一个线程可以访问关键数据结构。

例如，如果您让两个线程同时更改相同的数据结构，则该数据结构将被破坏，那么您通常会使用锁来保护它。

在现实世界中，考虑一个类似物，公共厕所有一把钥匙，挂在中央位置。在使用厕所之前，您需要钥匙，不仅可以进入，而且还可以保证没有其他人会同时尝试进入同一个厕所。他们将不得不等待密钥可用。

这就是这种锁结构的工作原理。

`synchronized`在这种情况下，关键字的参数是关键。你锁定钥匙，做你需要做的事，然后你解锁钥匙让其他人可以访问它。如果其他线程尝试锁定当前被另一个线程锁定的密钥，则该线程将不得不等待。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-17T18:52:24.937

我无法解释它，因为它无法编译。您不能锁定原语。

另一个不好的例子是将其更改为

```
public static final Integer lock =1; 
```

这是一个坏主意，因为小型自动装箱原语被缓存并且可能会产生奇怪的副作用（如果这样做不止一次）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T18:42:27.983

传入 synchronized 的对象实例是“锁定单元”。尝试在同一实例上获得锁定的其他执行线程都将等待轮到它们。

人们使用 this 而不是方法级同步关键字（锁定在执行类对象的实例上）的原因是，他们可能想要一个更细粒度或不同的东西来等待锁定，这取决于他们的多线程算法是如何设计的.

# javascript - 如何测量有多少字符适合文档的宽度？

> ID：875183
> 
> 赞同：7
> 
> 时间：2009-05-17T18:39:10.970
> 
> 标签：javascript, jquery, string

我需要用 JavaScript（我正在使用 jQuery）编写一个函数，该函数知道适合浏览器窗口一行的字符数。我正在使用等宽字体来缓解问题，但如果我将它概括为不同的字体会更好。

我怎么知道浏览器中有多少个字符会填满一行？目的是计算填充一行的字符数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T18:49:41.637

您可以创建元素并向其附加字符，直到您检测到换行，例如通过观察变化`offsetHeight`（您可以使用二分算法对其进行优化）。

这当然非常依赖于浏览器、系统、安装的字体和用户的设置，因此您必须在每次显示页面、调整大小或用户更改字体大小时为每个文本片段计算它（即使全页缩放也会引入一些-by-one 错误，可能导致字符数改变）。

因此，在大多数情况下，这可能是一种矫枉过正的做法，如果实施不当，会导致比解决的问题更多的麻烦。

还有其他解决方案，例如，如果您想确保只有一行可见，您可以使用`white-space:nowrap`并且`overflow:hidden`在某些浏览器`text-overflow:ellipsis`中可以很好地剪切文本。或者，如果您不想删减字词，请使用 1 行高的容器和`overflow:hidden`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T18:48:04.370

在 HTML 中没有简单的方法可以做到这一点。

但是，如果您真的必须知道，您可能可以使用一些非常丑陋的 javascript 来弄清楚：

首先，创建一个具有您需要的宽度的 <div>，放入一些字符并请求它的 .height() 以像素为单位。然后，继续向其中添加字符并继续检查 .height()，当 <div> 的高度发生变化时，您就知道它已经增长到适合新的文本行了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T18:41:52.697

您可以获得浏览器可用的总宽度

```
window.innerWidth 
```

然后你可以用下面的方法得到一个元素的宽度。

```
document.getElemenById('elem').clientWidth 
```

# python - 守护进程 python 包装器“子进程 I/O 超时”，需要一些指导

> ID：875190
> 
> 赞同：1
> 
> 时间：2009-05-17T18:43:17.263
> 
> 标签：python, daemon, tex

我不太熟悉在 Python 中创建守护进程的方式，因此当我尝试安装和运行第三方开源 TeX Python Wrapper 时，我被一个我不理解的错误所困扰。

我添加了一些打印来帮助调试。

错误的称为 texdp.py

当我运行调用 texdp 服务器启动的 mathrand 时，出现以下错误

```
output_fds  {8: 'dvi', 5: 'log', 6: 'logfile', 7: 'err'}
input_fds  3
readable, writable [] [3]  outflds, inputflds:  [8, 5, 6, 7] [3]
pointer len_str:  0 63
folder fd:  7
readable, writable [5] []  outflds, inputflds:  [8, 5, 6, 7] []
pointer len_str:  63 63
folder fd:  7
readable, writable [5] []  outflds, inputflds:  [8, 5, 6, 7] []
pointer len_str:  63 63
folder fd:  5
readable, writable [] []  outflds, inputflds:  [8, 5, 6, 7] []
pointer len_str:  63 63
folder fd:  5
SUB IO ERROR: readable []  pointer == len_str: 63 , 63

Traceback (most recent call last):
  File "/usr/local/bin/mathtrand", line 18, in <module>
    server.start()
  File "/usr/local/lib/python2.6/dist-packages/mathtran/server.py", line 71, in start
    self.secplain.start()
  File "/usr/local/lib/python2.6/dist-packages/tex/texdp.py", line 159, in start
    self.process(self._params.start)
  File "/usr/local/lib/python2.6/dist-packages/tex/texdp.py", line 175, in process
    value = self._process(str + self._params.done, self._params.done_str)
  File "/usr/local/lib/python2.6/dist-packages/tex/texdp.py", line 210, in _process
    raise SubprocessError, 'subprocess I/O timed out' 
```

负责的代码部分附加并位于方法**def _process**中的第 200 行附近。

我不知道从哪里开始寻找，以及这个错误的真正含义。任何帮助都非常受欢迎。

[https://texd.svn.sourceforge.net/svnroot/texd/trunk/py/tex/texdp.py](https://texd.svn.sourceforge.net/svnroot/texd/trunk/py/tex/texdp.py)

```
# Copyright: (c) 2007 The Open University, Milton Keynes, UK
# License: GPL version 2 or (at your option) any later version.
# Author: Jonathan Fine <jfine@pytex.org>, <J.Fine@open.ac.uk>

"""Wrapper around TeX process, to handle input and output.

Further comments to go here.
"""

__version__ = '$Revision: 116 $'[11:-2]
# $Source$

# TODO:  Move interface instances to elsewhere.
# TODO:  error recovery, e.g. undefined control sequence.
# TODO:  Abnormal exit is leaving orphaned processes.
# TODO:  Refactor _process into tex.util, share with metapostdp.

import os                               # Create directories and fifos
from select import select               # Helps handle i/o to TeX process
from tex.util import make_nonblocking   # For non-blocking file descriptor
from tex.util import DaemonSubprocess
from tex.dviopcode import FNT_DEF1, FNT_DEF4
import signal

class SubprocessError(EnvironmentError):

    pass

# TODO:  This belongs elsewhere.
class Interface(object):
    """Stores useful, but format specific, constants."""

    def __init__(self, **kwargs):
        # TODO:  Be more specific about the parameters.
        self.__dict__ = kwargs

# TeX knows about these fonts, but Python does not yet know.
# This list created by command: $tex --ini '&plain' \\dump
preloaded_fonts = ( 'cmr10', 'cmr9', 'cmr8', 'cmr7', 'cmr6', 'cmr5',
                    'cmmi10', 'cmmi9', 'cmmi8', 'cmmi7', 'cmmi6',
                    'cmmi5', 'cmsy10', 'cmsy9', 'cmsy8', 'cmsy7',
                    'cmsy6', 'cmsy5', 'cmex10', 'cmss10', 'cmssq8',
                    'cmssi10', 'cmssqi8', 'cmbx10', 'cmbx9', 'cmbx8',
                    'cmbx7', 'cmbx6', 'cmbx5', 'cmtt10', 'cmtt9',
                    'cmtt8', 'cmsltt10', 'cmsl10', 'cmsl9', 'cmsl8',
                    'cmti10', 'cmti9', 'cmti8', 'cmti7', 'cmu10',
                    'cmmib10', 'cmbsy10', 'cmcsc10', 'cmssbx10',
                    'cmdunh10', 'cmr7 scaled 2074',
                    'cmtt10 scaled 1440', 'cmssbx10 scaled 1440',
                    'manfnt', )

# Ship out a page that starts with a font def.
load_font_template = \
r'''%%
\begingroup
  \hoffset 0sp
  \voffset 0sp
  \setbox0\hbox{\font\tmp %s\relax\tmp M}%%
  \ht0 0sp
  \shipout\box 0
\endgroup
'''

secplain_load_font_template = \
r'''%%
\_begingroup
  \_hoffset 0sp
  \_voffset 0sp
  \_setbox0\_hbox{\_font\_tmp %s\_relax\_tmp M}%%
  \_ht0 0sp
  \_shipout\_box 0
\_endgroup
'''

plain = Interface(format='plain',
                  start = r'\shipout\hbox{}' '\n',
                  done = '\n' r'\immediate\write16{DONE}\read-1to\temp ' '\n',
                  done_str = 'DONE\n',
                  stop = '\end' '\n',
                  preloaded_fonts = preloaded_fonts,
                  load_font_template = load_font_template,
                  )

secplain = Interface(format='secplain',
                  start = r'\_shipout\_hbox{}' '\n',
                  done = '\n' r'\_immediate\_write16{DONE}\_read-1to\_temp ' '\n',
                  done_str = 'DONE\n',
                  stop = '\_end' '\n',
                  preloaded_fonts = preloaded_fonts,
                  load_font_template = secplain_load_font_template,
                  )

class Texdp(DaemonSubprocess):
    """Wrapper around TeX process that handles input and output.

    More comments go here.    
    """

    _fifos = ('texput.tex', 'texput.log', 'texput.dvi')

    def _make_args(self):

        # Don Knuth created plain.fmt, renamed by some to tex.fmt.
        fmt = self._params.format
        if fmt == 'plain' or fmt == 'tex':
            fmt = ''
        else:
            fmt = '--fmt=' + fmt

        # Build up the arguments list.
        args = ('tex', '--ipc',)
        args += ('--output-comment=""',) # Don't record time of run.
        if fmt:
            args += (fmt,)
        args += ('texput.tex',)
        return args

    def start(self):

        super(Texdp, self).start()      # Start the TeX process.

        # We will now initialise TeX, and conprocessnect to file descriptors.
        # We need to do some low-level input/output, in order to
        # manage long input strings.  Therefore, we use file
        # descriptors rather than file objects.

        # We map output fds to what will be a dictionary key.
        ofd = self._output_fd_dict = {}

        cwd = self._cwd                 # Shorthand.
        child = self._child 

        # For us, stdin and stdout are special.
        self._stdin = child.stdin.fileno()
        self._stdout = child.stdout.fileno()

        # Read stdout and stderr to 'log' and 'err' respectively.
        ofd[self._stdout] = 'log'
        ofd[child.stderr.fileno()] = 'err'

        # Open 'texput.tex', and block until it is available, which is
        # when TeX has started.  Then make 'texput.tex' non-blocking,
        # in case of a long write.
        self._texin = os.open(os.path.join(cwd, 'texput.tex'), os.O_WRONLY)
        make_nonblocking(self._texin)

        # Read 'texput.log' and 'texput.dvi' to 'logfile' and 'dvi'.
        for src, tgt in (('texput.log', 'logfile'), ('texput.dvi', 'dvi')):
            fd = os.open(os.path.join(cwd, src),
                         os.O_RDONLY|os.O_NONBLOCK)
            ofd[fd] = tgt

        # Ship out blank page, and initialise preloaded fonts.
        self.process(self._params.start)
        self._fontdefs = []
        for font_spec in self._params.preloaded_fonts:
            self.load_new_font(font_spec)

    def process(self, str):
        "Return dictionary with log, dvi, logfile and err entries."

        # TeX will read the data, following by the 'done' command.
        # The 'done' command will cause TeX to write the 'done_str',
        # which signals the end of the process.  It will also pause
        # TeX for input.

        # TODO: I do not know why the pause is required, but it is.
        # Remove it here and in the _params, and the program hangs.

        value = self._process(str + self._params.done, self._params.done_str)
        self._child.stdin.write('\n')   # TeX is paused for input.
        return value

    def _process(self, str, done_str):

        # Write str, and read output, until we are done.  Then gather
        # up the accumulated output, and return as a dictionary.  The
        # input string might be long.  Later, we might allow writing to
        # stdin, in response to errors.

        # Initialisation.
        print "output_fds ", self._output_fd_dict
        output_fds = self._output_fd_dict.keys()
        print "input_fds ", self._texin
        input_fds = [self._texin]

        accumulator = {}
        for fd in output_fds:
            accumulator[fd] = []

        pointer, len_str = 0, len(str)

        # The main input/ouput loop.
        # TOD0: magic number, timeout.
        done = False
        while not done:
            readable, writable = select(output_fds, input_fds, [], 0.1)[0:2]
            print "readable, writable", readable, writable, " outflds, inputflds: ", output_fds, input_fds
            print "pointer len_str: ", pointer, len_str
            print "folder fd: ", fd
            if not readable and pointer == len_str:
                print "SUB IO ERROR: readable", readable, " pointer == len_str:", pointer, ",", len_str
                os.kill(self._child.pid, signal.SIGKILL)
                self._child.wait()
                raise SubprocessError, 'subprocess I/O timed out'

            if pointer != len_str and writable:
                written = os.write(self._texin, str[pointer:pointer+4096])
                pointer += written
                if pointer == len_str:
                    input_fds = []

            for fd in readable:
                if self._child.poll() is not None:
                    raise SubprocessError, 'read from terminated subprocess'

                tmp = os.read(fd, 4096)
                if fd == self._stdout:
                    if tmp.endswith(done_str):
                        tmp = tmp[:-len(done_str)]
                        done = True
                accumulator[fd].append(tmp)

        if pointer != len_str:
            raise SystemError, "TeX said 'done' before end of input."

        # Join accumulated output, create and return ouput dictionary.
        value = {}
        for fd, name in self._output_fd_dict.items():
            value[name] = ''.join(accumulator[fd])
        return value

    def load_new_font(self, font_spec):
        """Tell both TeX and Python about a new font.

        Raises an exception if the font is not new.
        """

        # Ask TeX to load font, and ship out page that uses it.
        command mathtran= self._params.load_font_template % font_spec
        dvi = self.process(command)['dvi']

        bytes = dvi[45:-1]                  # Page body.
        opcode = ord(bytes[0])              # First opcode.

        # The first opcode should be a fontdef, which we extract.
        if FNT_DEF1 <= opcode <= FNT_DEF4:
            body_len = (2 + (opcode - FNT_DEF1)
                        + 12                # Checksum, scale, design size.
                        + 2)                # Length of 'area' and font name.

            name_len = ord(bytes[body_len - 2]) \
                       + ord(bytes[body_len - 1])

            fontdef = bytes[:body_len + name_len]
            self._fontdefs.append(fontdef)
            return

        else:
            raise ValueError, "font '%s' not new or not found" % font_spec 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T00:27:11.353

超时基于`select`调用

```
readable, writable = select(output_fds, input_fds, [], 0.1)[0:2] 
```

超时时间为 0.1 秒。这合适吗？

变量名很模糊（“指针”在 Python 中毫无意义）。但是，似乎如果 0.1 秒内没有任何反应，则会引发“超时”。

* * *

奇怪的是，该程序打开文件以与子进程进行通信。与子进程“共享”文件是非常奇怪的。

通常我们会做两件事之一——使用管道与子进程主动通信或使用文件让子进程自行运行。

这是一个更简单的设计。

1.  将输入放入输入文件中。

2.  运行 Tex 守护程序子进程，直到它完成，或者你已经厌倦了等待它。

3.  如果你厌倦了等待它，那就杀了它。

    别的

    *   从等待函数中查看状态

    *   读取输出文件。

这几乎就是你所需要的。而且不会有神秘的“暂停”，没有低级I/O，没有非阻塞I/O。

如果由于某种原因您需要与子进程进行通信，那么您应该考虑用管道替换文件（这些管道不共享，并且对于您正在做的任何事情都可能更好。）

# wpf - WPF 应用程序 - Visual Studio 2008 工具箱未正确加载！

> ID：875192
> 
> 赞同：1
> 
> 时间：2009-05-17T18:45:07.790
> 
> 标签：wpf, visual-studio-2008, wpf-controls

我对 WPF 很陌生，但是我对 WindowsForms 有深入的了解。当我在 Visual Studio 中创建新的 WinForms 应用程序时，工具箱会显示大量可用于开发程序的不同控件的列表。

然而，这只是我第二次开始在 WPF 中设计东西，而工具箱实际上只显示了一些常见的控件——比如文本框和按钮，而没有太多其他的东西。

我之前创建了一个 WPF 应用程序，在其中我将流文档拖到网格上并使用它的功能，但似乎不存在。

不知道为什么会这样？某些东西没有正确加载？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-05T09:21:04.360

转到工具->导入和导出设置->将打开向导选择**导入选定的环境设置**单击下一步你会发现类似这样的东西

C:\Documents and Settings\deepak.kumar2\My Documents\Visual Studio 2008\Settings\VWD Express

**默认选择一个文件，在VWD Express**文件夹或**Settings**文件夹中更改此文件

这个名字会像**CurrentSettings.vssettings**现在点击下一步并关闭

现在转到工具-> 选择工具箱项-> 选择**WPF 组件**选项卡现在从可用列表中选择任何控件

迪帕克卡拉

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T18:52:05.033

[您可以使用“选择工具箱项”对话框](http://msdn.microsoft.com/en-us/library/dyca0t6t.aspx)将工具箱重置为其原始状态。

但请注意 - WPF 在工具箱中的控件比 Windows 窗体少得多。默认情况下，不会有很多可用的控件，尤其是当您将它与 Windows 窗体控件/窗体进行比较时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T20:37:23.080

我曾经遇到过 VS2008 没有显示工具箱项目的问题。虽然我的问题与 WPF 无关，但我发现的解决方案可能有用 - 我所做的是通过命令行启动 Visual Studio，使用选项在加载期间重置跳过包。

从 VS 命令提示符：

```
devenv.exe /resetskippkgs 
```

# version-control - vimdiff 针对源代码控制存储库

> ID：875201
> 
> 赞同：5
> 
> 时间：2009-05-17T18:49:53.587
> 
> 标签：version-control, vim, diff

[scmdiff](http://github.com/ghewgill/vim-scmdiff/tree/master "scmdiff 在 github")标记文件的签入版本和正在编辑的文件之间的差异。它通过为更改的线条着色来标记它。有没有办法使用`vimdiff`-style split 来查看更改，而不仅仅是为更改的行着色？

例如，如果`abc`是受版本控制的文件，那么我可以使用以下内容在一侧显示当前版本，`abc`在另一侧显示最新版本：

```
tkdiff abc 
```

我也可以这样做：

```
tkdiff -r1 -r5 abc 
```

显示版本 1 和 5 之间的差异。最后，我可以这样做：

```
tkdiff -r1 abc 
```

查看当前版本和版本 1 之间的差异。

这是我希望在文件的两个版本之间看到的那种差异，仅使用 Vim。可以做到吗？我在 Linux 下工作，我使用 Bitkeeper 进行版本控制。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T18:59:29.620

我通过以下方式将 vimdiff 与 subversion 一起使用：

当我想查看特定文件或一组文件的 vimdiff 差异时，我会：

```
svn diff [files] --diff-cmd svd 
```

这里 --diff-cmd 指示 subversion 使用命令“svd”而不是其默认的 diff 行为。svd 是以下 shell 脚本：

```
#!/bin/bash
shift 5; /usr/bin/vimdiff -f "$@" 
```

您没有提到您的操作系统，以上内容肯定适用于 Linux 和 OS X。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T10:33:12.980

我使用[vcscommand](http://www.vim.org/scripts/script.php?script_id=90 "vcscomman")插件与 VCS 交互。

从描述：

> VIM 7 插件可用于在 VIM 中操作由 CVS、SVN、SVK 和 git 控制的文件，包括使用 vimdiff 系统提交更改和执行差异。

特别是`:VCSVimDiff`将拆分当前窗口并针对 repo 中的最新版本显示“vimdiff”。您还可以指定一个修订号将当前缓冲区与（即`:VCSVimDiff -2`）进行比较，或者指定两个修订号以相互区分。这是文档中的相关部分：

> :VCSVimDiff
> 
> 使用 vimdiff 显示当前文件版本之间的差异。
> 
> 如果未指定修订，则使用当前分支上文件的最新版本。对于一个论点，该论点用作上述修订。使用两个参数，使用 vimdiff 显示两个版本之间的差异。
> 
> 使用零或一个参数，原始缓冲区用于执行 vimdiff。当暂存缓冲区关闭时，原始缓冲区将返回到正常模式。
> 
> 一旦使用上述方法启动 vimdiff 模式，可以通过将单个版本参数传递给命令来添加额外的 vimdiff 缓冲区。总共可能有多达 4 个 vimdiff 缓冲区。
> 
> 使用命令的 2 参数形式将 vimdiff 重置为仅这 2 个版本。此外，在不同的文件上调用命令将关闭以前的 vimdiff 缓冲区。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-01T14:00:08.487

VCSCommand 插件在这种情况下非常有用，它也可以与 SVN、CVS 和其他存储库无缝协作。`:VCSVimDiff`在缓冲区中加载的文件和存储库中的副本之间应用 vimdiff。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T20:13:54.177

我是[bazaar 的 vimdiff 插件](https://code.launchpad.net/~bzr/bzr-vimdiff/vimdiff)的快乐用户。对于 git，有[gitvimdiff](http://www.vim.org/scripts/script.php?script_id=1989)（可以使用[其他几种解决方案）。](http://technotales.wordpress.com/2009/05/17/git-diff-with-vimdiff/)Mercurial[也可以做到这](http://www.selenic.com/mercurial/wiki/UsingVimdiffForSingleDiffs)一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T07:04:36.947

对于 ClearCase VCS，有一个[插件](http://www.vim.org/scripts/script.php?script_id=15)也可以满足您的需求。

# xcode - GDB 备忘单

> ID：875205
> 
> 赞同：31
> 
> 时间：2009-05-17T18:52:14.750
> 
> 标签：xcode, debugging, gdb

谁能推荐一个好的gbd备忘单？我对 windbg 命令很有经验，我正在寻找 lml（列出加载的模块）、~*k（所有线程堆栈）、ba（访问中断）、dt（转储类型）、dv（转储帧变量）的 gdb 等效项)、sxe（设置 SEH 处理程序）等。我知道不会有 1 对 1 的等价物，但我只需要最常用/有用的命令的简明摘要。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-17T18:57:23.010

我个人使用这个：[gdb 的备忘单](http://users.ece.utexas.edu/~adnan/gdb-refcard.pdf) 或者[那个链接还没有被破坏](http://refcards.com/docs/peschr/gdb/gdb-refcard-a4.pdf)...... 我已经在工作中打印出来了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-17T18:58:48.543

[http://www.digilife.be/quickreferences/QRC/GDB%20Quick%20Reference.pdf](http://www.digilife.be/quickreferences/QRC/GDB%20Quick%20Reference.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-04T03:32:18.263

```
 +========================+==============================+=============================+
  |GDB                     | DBX                          | WINDOWS  ntsd,wdeb386,windbg|
  +========================+==============================+=============================+
  |break line              | stop at line                 |                          F9 |
  |break func              | stop in func                 |bp func                 A-F9 |
  |break *addr             | stopi at addr                |br,ba                   A-F9 |
  |break ... if expr       | stop ... -if expr            |bp f "j cond 'r';'g'"   A-F9 |
  |cond n                  | stop ... -if expr            |                             |
  |tbreak                  | stop ... -temp               |bp f "bc"           F9 F5 F9 |
  |watch expr              | stop expr [slow]             |                             |
  |watch var               | stop modify &var [fast]      |                             |
  |                        | stop change var              |                        A-F9 |
  |catch x                 | intercept x                  |                             |
  |info break              | status                       |bl                      A-F9 |
  |info watch              | status                       |                             |
  |clear                   | clear                        |                             |
  |clear fun               | delete n                     |bc                           |
  |delete                  | delete all                   |bc *                    A-F9 |
  |disable                 | handler -disable all         |bd *                    C-F9 |
  |disable n               | handler -disable n           |                             |
  |enable                  | handler -enable all          |be                           |
  |enable n                | handler -enable n            |                             |
  |ignore n cnt            | handler -count n cnt         |bp n cnt                A-F9 |
  +========================+==============================+=============================+
  |set args                | runargs                      |                         A-F7|
  |run                     | run args                     |g                      C-S-F5|
  |continue                | cont                         |g (go)                   F5  |
  |stepi                   | stepi                        |t                            |
  |step                    | step                         |                         F11 |
  |next                    | next                         |p                        F10 |
  |jump line               | cont at line                 |p =addr / g =addr     R-Mouse|
  |finish                  | step up                      |bp retaddr+4             F12 |
  |return (now)            | pop                          |g =retaddr                   |
  |until line              | stop at line -temp;cont      |bp func;g                    |
  |C-j                     | !!                           |<CR> (repeat)                |
  +========================+==============================+=============================+
  |commands n              | when ... { cmds; }           |bp n "cmds"                  |
  |backtrace n             | where n                      |kb ks kv                     |
  |frame n                 | frame n                      |                             |
  |info reg reg            | print $reg                   |r                            |
  |signal num              | cont sig num                 |                             |
  |set var=expr            | assign var=expr              |e (enter bytes),f (fill)     |
  |x/fmt addr              | x addr/fmt                   |d[abcw] addr (display)    A-6|
  |disassem addr           | dis addr                     |u                   C-F11,A-8|
  |shell cmd               | sh cmd [if needed]           |                             |
  |info func regex         | funcs regexp                 |X (ntsd)                     |
  |ptype type              | whatis -t type               |                             |
  |define cmd              | function cmd                 |zs,zl,zd (default cmd)       |
  |handle sig              | stop sig sig                 |                             |
  |info signals            | status; catch                |di (display IDT)             |
  |attach pid              | debug - pid                  |                             |
  |attach pid              | debug a.out pid              |                             |
  |file file               | [unnecessary]                |                             |
  |exec file               | debug file                   |                             |
  |core file               | debug a.out corefile         |                             |
  |set editing on          | set -o emacs                 |                             |
  |set language x          | language x                   |                             |
  |set prompt x            | PS1=x                        |                             |
  |set history size x      | HISTSIZE=x                   |                             |
  |set print object on     | dbxenv output_dynamic_type on|                             |
  |show commands           | history                      |                             |
  |dir name                | pathmap name                 |                             |
  |show dir                | pathmap                      |lm                           |
  |info line <n            | listi n                      |                             |
  |info source             | file                         |ln                           |
  |info sources            | files; modules               |                             |
  |forw regex              | search regexp                |lse regexp                   |
  |rev regex               | bsearch regexp               |                             |
  |.gdbinit                | .dbxrc (was .dbxinit)        |                             |
  |q                       | quit                         |q                            |
  +========================+==============================+=============================+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-03T11:51:08.303

这是我使用（并创建）的一个非常简单的跨平台调试备忘单。 [http://mohit.io/blog/cross-platform-debugging-cheat-sheet/](http://mohit.io/blog/cross-platform-debugging-cheat-sheet/) 希望你能找到所需的windbg -> gdb 命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T03:49:00.273

```
 +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |Feature    |Description|vc       |dbx         |gdb           |windbg  |ntsd|edebug|perld|i386kd|wdeb386|
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |Lang       |-          |c        |c           |c             |c       |c   |elisp |perl |c     |c      |
  |OS         |-          |win      |unix        |unix etc      |win     |win |all   |all  |win   |win    |
  |GUI        |-          |Y        |N           |N             |Y       |N   |emacs |N    |N     |N      |
  |Alt GUI    |-          |N        |emacs ddd   |emacs         |N       |N   |N     |ddd  |N     |N      |
  |Vendor GUI |-          |Y        |Sun/workshop|HP/wdbg       |Y       |N   |emacs |N    |N     |N      |
  |Cmdline    |-          |No No    |Y           |Y             |Y       |Y   |-     |Y    |Y     |Y      |
  |Alias      |-          |keymapper|alias/define|command       |N       |ini |Y     +=    |N     |N      |
  |Completion |<TAB>      |-        |Y           |YY            |N       |N   |YY    |-    |N     |N      |
  |Script     |script     |VbPerlOle|ksh         |Y             |dll     |dll |Y     |Y    |$<file|dll    |
  |Actions    |When .. do |         |when        |              |        |    |      |a<>{}|      |       |
  |History    |cmd history|N        |Y           |Y             |Y       |Y   |Y     |!    |Y     |Y      |
  |Init       |setup      |regedit  |.dbxrc      |.gdbinit      |regedit |ini |.emacs|-    |ENV   |-      |
  |Options    |config     |regedit  |dbxenv      |set           |        |    |      |O    |      |       |
  |Help       |?          |msdn     |help        |i   info      |? .hlp  |?   |info  |h pod|? msdn|? msnd |
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |bp         |break      |F9       |stop at     |b             |bp      |bp  |-     |-    |bp    |bp     |
  |ba         |hardware   |A-F9     |stop access |hbreak/b *addr|br      |ba  |-     |N    |ba    |br     |
  |bl handlers|list stops |A-F9     |status      |i b           |-       |-   |l     |L    |bl    |-      |
  |bd         |delete     |F9       |delete N    |delete break N|-       |-   |u     |d D  |-     |-      |
  |bc clear   |del current|C-F9     |clear       |clear         |-       |-   |-     |-    |bc    |-      |
  |bp once    |break once |F9 F5 F9 |stop -temp  |tbreak        |-       |-   |-     |c .. |-     |-      |
  |be on      |enable     |C-F9     |-           |enable        |-       |-   |-     |-    |be    |-      |
  |bd off     |disable    |C-F9     | -disable   |disable       |-       |-   |-     |-    |bd    |-      |
  |bp if      |conditional|C-F9     |cond -if    |condition     |J       |-   |-     |-    |J     |-      |
  |bp --k==0  |count to bp|C-F9     |-count k    |ignore .. k   |J       |-   |-     |-    |J     |-      |
  |bp do act  |action on b|N        |when..{..}  |command ...   |J       |-   |-     |-    |J     |-      |
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |unassemble |disassemble|C-F11/A-8|dis   $pc   |disassem addr |u       |-   |-     |-    |U     |-      |
  |bt         |backtrace  |A-7      |where       |bt            |kd kb kd|-   |-     |T    |~k ln |-      |
  |frame      |           |A-7      |frame       |up/down       |-       |-   |-     |-    |-     |-      |
  |Locals vars|-          |A-4      |dump        |-             |-       |-   |-     |V    |-     |-      |
  |regs       |registers  |A-5      |regs -F     |info regs     |-       |#R  |-     |-    |-     |-      |
  |Expr       |eval expr  |F8       |print       |print         |?expr   |-   |e/R   |x m p|?expr |-      |
  |Change var |           |F8       |p x=y       |p x=y         |-       |-   |-     +=    |E F   |-      |
  |trace      |single step|VC       |trace       |trace         |-       |-   |-     |t    |tr    |-      |
  |Examine Mem|-          |A-6      |x addr/fmt  |x/fmt addr    |dw db dc|-   |-     |-    |D     |-      |
  |Threads    |-          |A-6      |-           |-             |-       |~*KB|-     |-    |~     |-      |
  |symbols    |-          |-        |-           |i             |-       |X   |C-h   |-    |X     |-      |
  |watch      |-          |A-3      |display     |-             |-       |-   |-     |w    |-     |-      |
  |typeof     |           |         |whatis -t   |ptype         |-       |-   |-     |-    |-     |-      |
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |Exe        |-          |Menu     |debug a.out |file a.out    |-       |-   |-     |-    |ini   |win.com|
  |args       |-          |Menu     |runargs     |set args      |Menu    |cmd |-     |cmd  |Kernel|Kernel |
  |src        |-          |vc pdb   |dir ~/src   |pathmap ~/src |-       |-   |-     |-    |-     |-      |
  |Edit       |-          |builtin  |list        |list          |-       |-   |-     |-    |-     |-      |
  |start      |-          |C-S-F5   |run [args]  |run           |G       |-   |-     |-    |G     |-      |
  |continue   |go         |F5       |cont        |continue      |-       |-   |c     |c    |-     |-      |
  |step into  |-          |F11      |step        |step          |T       |-   |d     |s    |T     |-      |
  |stepi      |instruction|-        |stepi       |stepi         |-       |-   |-     |-    |J     |-      |
  |step over  |-          |F10      |next        |next          |P       |-   |-     |n    |P     |-      |
  |step if    |-          |-        |-           |-             |-       |-   |-     |-    |J     |-      |
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |finish     |till return|F12      |step up     |finish        |-       |-   |r     |r    |-     |-      |
  |until      |till cursor|F6       | -temp;cont |until         |-       |-   |bc    |-    |-     |-      |
  |jump       |-          |F2       |cont at     |jump          |-       |-   |-     |-    |-     |-      |
  |pop        |return now |\jump    |pop         |return        |-       |-   |-     |r    |-     |-      |
  |repeat     |redo       |-        |!!          |<CR>          |-       |-   |-     |<CR> |-     |-      |
  |quit       |-          |MENU     |quit        |q             |q       |q   |q C-] |-    |q     |q      |
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+
  |Feature    |Desc       |vc       |dbx         |gdb           |windbg  |ntsd|edebug|perld|i386kd|wdeb386|
  +===========+===========+=========+============+==============+========+====+======+=====+======+=======+ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-15T08:50:35.003

来自谷歌的两个链接，我很快找到了一些我在其他答案的链接中找不到的真正有用的东西：

*   [http://www.sthu.org/code/codesnippets/files/gdb_cheatsheet.pdf](http://www.sthu.org/code/codesnippets/files/gdb_cheatsheet.pdf)
*   [http://erik.cabetas.com/stuff/debug/gdb-essentials.pdf](http://erik.cabetas.com/stuff/debug/gdb-essentials.pdf)

# database - 如何从行偏移中选择最近 24 小时的行

> ID：875211
> 
> 赞同：1
> 
> 时间：2009-05-17T18:54:02.827
> 
> 标签：database, mysql

我试图从存储在 MySQL 中的数据集计算 24 小时 rms（均方根）。我需要获取在特定行偏移之前 24 小时内发生的最后 24 小时的点。例如，如果我想计算行 id 1250 的 24 小时 rms，其时间戳为 2007 年 6 月 7 日午夜，我将需要获取它与 2007 年 6 月 6 日午夜之间发生的所有点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T19:03:28.037

在我的脑海中......（MYSQL）

```
declare @endTime datetime;
select @endTime=timestamp from data where id=@rowId
select 
    * 
from 
    data 
where 
    timestamp<=@endtime and timestamp>ADDDATE(@endTime,INTERVAL -1 DAY) 
```

(T-SQL)

```
declare @endTime datetime2;
select @endTime=timestamp from data where id=@rowId
select * from data where timestamp<=@endtime and timestamp>dateadd(d,-1,@endTime) 
```

您可能需要调整日期时间类型以匹配您的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T19:08:33.687

您可以直接针对某些集合使用聚合函数：

```
select
  sqrt(sum(pow(my_value,2))/count(*))
from
  my_table
where
  my_date between '2007-06-06 00:00:00' and '2007-06-07 00:00:00' 
```

# function - 函数属性问题

> ID：875215
> 
> 赞同：0
> 
> 时间：2009-05-17T18:57:07.080
> 
> 标签：function

这个提议是真的吗？

对于所有函数 *f*
*f(a+b) = f(a) + f(b)*。

如果是，那为什么？如果不是，那么这些特殊函数是什么，它们有什么属性？

编辑：哇，我认为地板/天花板功能不持有财产。？我可以想到反例，但有人可以证明这一点。但是保持这个属性的函数叫什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T19:04:08.067

您提到了一个函数*f*：

```
f(a + b) = f(a) + f(b) 
```

这样的函数称为[同态](http://en.wikipedia.org/wiki/Homomorphism)，它可以定义在某些代数结构上。在这种情况下， *+*是一个特殊的二元函数，它将*a*和*b*映射到同一域的元素上。

显然，并非所有函数都是同态的，正如其他人已经向您展示的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:00:43.127

在过程式编程中，这是不正确的，因为任意函数可能具有任意副作用。

例如，您可以有一个全局计数器，每次调用 f() 时都会递增并添加到返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T19:01:18.883

log(a+b) = log(a) + log(b) 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T19:03:10.843

不。

如果 f(k * a) = k * f(a) 也称为线性。

一般来说，这样的函数称为同态，但这不限于加法。

# .net - VB.NET 中 Dictionary(Of String, SomeReferenceType) 的性能

> ID：875222
> 
> 赞同：7
> 
> 时间：2009-05-17T18:58:31.447
> 
> 标签：.net, vb.net, performance, dictionary

从/向 Dictionary(Of String, SomeReferenceType) 读取/添加值的性能如何取决于已输入的记录数？我的意思是，当 n 变大时，时间会随着 O(1)、O(log n)、O(n) 增加，还是以其他方式增加？

```
Dim index As New Dictionary(Of String, SomeReferenceType)

' N entries added in a loop
' ...

Dim id As Integer = 123456789 ' 9-digit number
Dim key As String = id.ToString()
Dim value As New SomeReferenceType

index(key) = value ' Need to estimate this
value = index.TryGetValue(key) ' and this operations depending on N (for large N) 
```

另外，如果内存不足怎么办？我们是否应该在输入元素之前设置字典的容量以避免在没有足够内存空间的情况下复制它？此操作（如果需要，将字典复制到新位置）需要多长时间，具体取决于 N？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T20:53:52.460

从 a 获取项目的性能`Dictionary`受项目数量的影响很小。项目根据其哈希码分为桶，因此每个桶中通常只有一个或很少的项目。该操作接近于 O(1) 操作。

添加项目也接近于 O(1) 操作。如果必须增加容量，您将受到性能影响，但平均而言，这是非常小的。由于容量每次翻倍，增加容量时移动的数据量实际上并没有那么多。数据平均额外移动了 1.3 倍，因此每次添加的平均额外工作归结为移动大约 16 个字节。

如果您知道将获得多大`Dictionary`，或者只是有一个不错的估计，您应该在创建它时使用它，以减少或消除增加容量的需要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T19:01:44.950

`Dictionary`用 Hastables 实现 - 因此 O(1)。

`SortedDictionary`用二叉树（红/黑）实现 - 因此 O(log n)

`SortedList`用列表+二分搜索实现 - 因此 O(n)

所有字典都会自动增加它们的大小（这里的性能是 O(n) 但这并不经常发生，因为大小是智能地预先计算的，所以无论如何近似的性能是 O(1) - 见[这个](http://en.wikipedia.org/wiki/Growable_array#Geometric_expansion_and_amortized_cost)）

只需谷歌它们并查看微软文档。

# javascript - 调整浏览器大小时调整jqGrid的大小？

> ID：875225
> 
> 赞同：81
> 
> 时间：2009-05-17T18:58:53.100
> 
> 标签：javascript, jquery, jqgrid, grid, resize

调整浏览器窗口大小时，有没有办法调整[jqGrid的大小？](http://www.trirand.com/blog/)我已经尝试过[这里](http://www.trirand.com/blog/?page_id=18/discussion/browser-resize-how-to-resize-jqgrid/page-1/post-3350/)描述的方法，但该技术在 IE7 中不起作用。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-10-27T19:20:26.047

一段时间以来一直在生产中使用它，没有任何抱怨（可能需要一些调整才能在您的网站上看起来正确..例如，减去侧边栏的宽度等）

```
$(window).bind('resize', function() {
    $("#jqgrid").setGridWidth($(window).width());
}).trigger('resize'); 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-10-15T21:12:18.367

作为后续：

这篇文章中显示的之前的代码最终被放弃了，因为它不可靠。根据 jqGrid 文档的建议，我现在使用以下 API 函数来调整网格的大小：

```
jQuery("#targetGrid").setGridWidth(width); 
```

要进行实际的调整大小，实现以下逻辑的函数绑定到窗口的调整大小事件：

*   使用其父级的 clientWidth 和（如果不可用）其 offsetWidth 属性计算网格的宽度。

*   执行完整性检查以确保宽度变化超过 x 像素（以解决一些特定于应用程序的问题）

*   最后，使用 setGridWidth() 改变网格的宽度

这是处理调整大小的示例代码：

```
jQuery(window).bind('resize', function() {

    // Get width of parent container
    var width = jQuery(targetContainer).attr('clientWidth');
    if (width == null || width < 1){
        // For IE, revert to offsetWidth if necessary
        width = jQuery(targetContainer).attr('offsetWidth');
    }
    width = width - 2; // Fudge factor to prevent horizontal scrollbars
    if (width > 0 &&
        // Only resize if new width exceeds a minimal threshold
        // Fixes IE issue with in-place resizing when mousing-over frame bars
        Math.abs(width - jQuery(targetGrid).width()) > 5)
    {
        jQuery(targetGrid).setGridWidth(width);
    }

}).trigger('resize'); 
```

和示例标记：

```
<div id="grid_container">
    <table id="grid"></table>
    <div id="grid_pgr"></div>
</div> 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-10-22T21:54:22.930

自动调整大小：

对于 jQgrid 3.5+

```
 if (grid = $('.ui-jqgrid-btable:visible')) {
            grid.each(function(index) {
                gridId = $(this).attr('id');
                gridParentWidth = $('#gbox_' + gridId).parent().width();
                $('#' + gridId).setGridWidth(gridParentWidth);
            });
        } 
```

对于 jQgrid 3.4.x：

```
 if (typeof $('table.scroll').setGridWidth == 'function') {
            $('table.scroll').setGridWidth(100, true); //reset when grid is wider than container (div)
            if (gridObj) {

            } else {
                $('#contentBox_content .grid_bdiv:reallyvisible').each(function(index) {
                    grid = $(this).children('table.scroll');
                    gridParentWidth = $(this).parent().width() – origami.grid.gridFromRight;
                    grid.setGridWidth(gridParentWidth, true);
                });
            }
        } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-09-29T22:07:58.553

这似乎对我很有效

```
$(window).bind('resize', function() {
    jQuery("#grid").setGridWidth($('#parentDiv').width()-30, true);
}).trigger('resize'); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-11-11T21:23:56.447

我使用 960.gs 进行布局，所以我的解决方案如下：

```
 $(window).bind(
        'resize',
        function() {
                    //  Grid ids we are using
            $("#demogr, #allergygr, #problemsgr, #diagnosesgr, #medicalhisgr").setGridWidth(
                    $(".grid_5").width());
            $("#clinteamgr, #procedgr").setGridWidth(
                    $(".grid_10").width());
        }).trigger('resize');
// Here we set a global options

jQuery.extend(jQuery.jgrid.defaults, {
    // altRows:true,
    autowidth : true,
    beforeSelectRow : function(rowid, e) { // disable row highlighting onclick
        return false;
    },
    datatype : "jsonstring",
    datastr : grdata,  //  JSON object generated by another function
    gridview : false,
    height : '100%',
    hoverrows : false,
    loadonce : true,
    sortable : false,
    jsonReader : {
        repeatitems : false
    }
});

// Demographics Grid

$("#demogr").jqGrid( {
    caption : "Demographics",
    colNames : [ 'Info', 'Data' ],
    colModel : [ {
        name : 'Info',
        width : "30%",
        sortable : false,
        jsonmap : 'ITEM'
    }, {
        name : 'Description',
        width : "70%",
        sortable : false,
        jsonmap : 'DESCRIPTION'
    } ],
    jsonReader : {
        root : "DEMOGRAPHICS",
        id : "DEMOID"
    }
}); 
```

// 下面定义的其他网格...

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-02-09T12:58:49.660

如果你：

*   有`shrinkToFit: false`（平均固定宽度的列）
*   有`autowidth: true`
*   不在乎流体高度
*   有水平滚动条

您可以使用以下样式制作具有流体宽度的网格：

```
.ui-jqgrid {
  max-width: 100% !important;
  width: auto !important;
}

.ui-jqgrid-view,
.ui-jqgrid-hdiv,
.ui-jqgrid-bdiv {
   width: auto !important;
} 
```

[这是一个演示](http://jsfiddle.net/chintsu/Lqff05wn/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-17T19:18:12.013

借用链接中的代码，您可以尝试以下操作：

```
$(window).bind('resize', function() { 
    // resize the datagrid to fit the page properly:
    $('div.subject').children('div').each(function() {
        $(this).width('auto');
        $(this).find('table').width('100%');
    });
}); 
```

这样，您就可以直接绑定到 window.onresize 事件，这实际上看起来就像您想要的问题。

如果您的网格设置为 100% 宽度，尽管它应该在其容器扩展时自动扩展，除非您使用的插件有一些我不知道的复杂性。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-04-05T14:06:54.730

主要答案对我有用，但使应用程序在 IE 中极不响应，所以我按照建议使用了计时器。代码看起来像这样（`$(#contentColumn)`是 JQGrid 所在的 div）：

```
 function resizeGrids() {
    var reportObjectsGrid = $("#ReportObjectsGrid");
    reportObjectsGrid.setGridWidth($("#contentColumn").width());
};

var resizeTimer;

$(window).bind('resize', function () {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(resizeGrids, 60);
}); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-08-26T13:01:05.640

你好 Stack 溢出爱好者。我喜欢大多数答案，我什至投了几个票，但出于某种奇怪的原因，他们都没有在 IE 8 上为我工作……但我确实遇到了这些链接……这个人写了一个似乎工作。将它包含在您的项目中，除了 jquery UI，输入您的表格名称和 div。

[http://stevenharman.net/blog/archive/2009/08/21/creating-a-fluid-jquery-jqgrid.aspx](http://stevenharman.net/blog/archive/2009/08/21/creating-a-fluid-jquery-jqgrid.aspx)

[http://code.google.com/p/codeincubator/source/browse/#svn%2FSamples%2Fsteveharman%2FjQuery%2Fjquery.jqgrid.fluid%253Fstate%253Dclose](http://code.google.com/p/codeincubator/source/browse/#svn%2FSamples%2Fsteveharman%2FjQuery%2Fjquery.jqgrid.fluid%253Fstate%253Dclosed)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-04T11:13:27.747

```
autowidth: true 
```

非常适合我。从[这里](https://stackoverflow.com/questions/3725236)学到的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-03T12:30:24.190

这有效..

```
var $targetGrid = $("#myGridId");
$(window).resize(function () {
    var jqGridWrapperId = "#gbox_" + $targetGrid.attr('id') //here be dragons, this is     generated by jqGrid.
    $targetGrid.setGridWidth($(jqGridWrapperId).parent().width()); //perhaps add padding calculation here?
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-05-09T07:19:25.520

```
<script>
$(document).ready(function(){    
$(window).on('resize', function() {
    jQuery("#grid").setGridWidth($('#fill').width(), false); 
    jQuery("#grid").setGridHeight($('#fill').height(),true); 
}).trigger('resize');      
});
</script> 
```

# python - Python中的简单数据存储

> ID：875228
> 
> 赞同：3
> 
> 时间：2009-05-17T19:00:20.693
> 
> 标签：python, file-io, csv, multidimensional-array, fileparsing

我正在寻找一个使用 Python 将数据存储为平面文件的简单解决方案，这样每一行都是可以轻松解析的数组的字符串表示形式。

我确信 python 有一个库可以轻松完成这样的任务，但到目前为止，我发现的所有方法似乎都很难让它工作，我相信有更好的方法。到目前为止，我已经尝试过：

*   array.toFile() 方法，但不知道如何让它与嵌套的字符串数组一起工作，它似乎面向整数数据。
*   列表和集合没有内置的 toFile 方法，因此我必须手动对其进行解析和编码。
*   CSV 似乎是一种不错的方法，但这也需要手动解析它，并且不允许我在末尾简单地附加新行 - 因此 CSVWriter 的任何新调用都会覆盖文件现有数据。

我真的在努力避免使用数据库（也许是 SQLite，但它似乎有点矫枉过正），因为我正在尝试将其开发为除了 Python 之外没有任何软件先决条件。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T19:51:09.873

除了`pickle`（[上面提到的](https://stackoverflow.com/questions/875228/simple-data-storing-in-python/875272#875272)），还有[`json`](http://docs.python.org/library/json.html)（内置于 2.6，在此之前通过[simplejson](http://pypi.python.org/pypi/simplejson/)[`marshal`](http://docs.python.org/library/marshal.html#module-marshal)可用），和. 此外，作者[`reader`](http://docs.python.org/library/csv.html#csv.reader)所在的同一[`csv`模块](http://docs.python.org/library/csv.html)中有一个。

更新：正如 S. Lott 在评论中指出的那样，还有 YAML，可通过[PyYAML](http://pyyaml.org/)等获得。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T19:13:10.653

[http://docs.python.org/library/pickle.html](http://docs.python.org/library/pickle.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T19:15:45.530

该文件必须是人类可读的吗？如果没有，[shelf](http://docs.python.org/library/shelve.html)真的很容易使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T21:16:12.843

> 我正在寻找一个使用 Python 将数据存储为平面文件的简单解决方案，这样每一行都是可以轻松解析的数组的字符串表示形式。

数据是否只会被 Python 程序解析？如果没有，那么我会避免使用 pickle 等（搁置和编组），因为它们非常特定于 Python。JSON 和 YAML 具有重要的优势，即解析器可轻松用于大多数任何语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-13T05:29:56.700

SourceForge 的此解决方案仅使用标准 Python 模块：

y_serial.py 模块 :: 使用 SQLite 存储 Python 对象

“序列化 + 持久性:: 在几行代码中，将 Python 对象压缩和注释为 SQLite；然后在没有任何 SQL 的情况下通过关键字按时间顺序检索它们。数据库存储无模式数据的最有用的“标准”模块。”

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

SQLite 一点也不“矫枉过正”——你会惊讶于它是多么的简单；此外，它还解决了更一般的数据持久性问题。

# c# - C# 中的专用网络端口

> ID：875231
> 
> 赞同：0
> 
> 时间：2009-05-17T19:01:15.170
> 
> 标签：c#, networking, port

我如何确保我的计算机上的特定端口没有被用于我在 C# 中需要的服务以外的任何其他目的？

在我模拟局域网信使的程序中，我在尝试连接到远程主机时遇到连接被拒绝错误。因此我需要以某种方式确保该端口没有被用于任何其他目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T19:04:29.267

你不能确保这一点。任何程序都可以注册以侦听任何端口，如果没有其他进程正在使用它，操作系统将允许它。

您最好的选择是选择一个现在已知可被任何服务使用的端口，并将其用作您的传入端口。[这](http://www.iana.org/assignments/port-numbers)是一个众所周知的端口列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T19:14:20.727

```
IPAddress localAddr = IPAddress.Parse("127.0.0.1");
server = new TcpListener(localAddr, 0); 
```

这将为您提供本地机器上的第一个可用端口。

[http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T19:04:36.643

打开一个tcp-socket监听就可以了？这会阻止其他任何人做同样的事情。

拒绝连接听起来更像是防火墙问题。

# math - 数字问题的小数部分

> ID：875238
> 
> 赞同：2
> 
> 时间：2009-05-17T19:02:24.560
> 
> 标签：math, rounding, floor, ceil

什么是一个好的算法来确定添加/减去数字所需的必要分数，以便在不使用内置天花板或地板功能的情况下将其四舍五入到最接近的整数？

编辑：寻找一个数学数字技巧来找出将数字四舍五入到最接近的整数所需的部分。数学运算越原始越好。请避免使用其他程序。无论哪种方式都可以采用 0.5，无论哪种方式适合您的方法。这不是我的作业问题，我也不打算在任何地方使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T19:08:05.733

将数字修改为 1 得到小数部分，如果大于 0.5，则向上取整，否则向下取整

或者

将数字除以 0.5，如果是奇数，则向上取整，否则向下取整

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T20:51:54.413

一旦你有了数字的小数部分，问题就基本解决了。获得小数部分的一种方法是从你的数字中反复减去 2 的幂（假设它已经被设为正，如果它一开始是负的）。

下面的函数，`getWholeMaker`，返回你想要的（必须添加到四舍五入的“东西”）。它的运行时间是`O(log(n))`，并且仅使用基本操作。

```
/* Returns the factional part of x */
double getFrac(double x) {
    if(x < 0) x = -x;
    if(x < 1) return x;
    else if(x < 2) return x-1;

    /* x >= 0 */
    double t = 2;
    while(t+t <= x) t += t;
    /* t is now the largest power of 2 less than or equal to x */
    while(t >= 1) {
        if(t <= x) x -= t;
        t /= 2;
    }

    return x;
}

double getWholeMaker(double x) {
    double frac = getFrac(x);
    double sign = x >= 0 ? +1 : -1;
    return sign * (frac <= 0.5 ? -frac : 1-frac);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T19:32:33.467

如果你不能使用 mod （因为它可能只为你的语言中的整数定义，你可以做这样的事情（在 C-ish 伪代码中）：

```
// make the input positive:
boolean inputPositive = true;
if (input < 0) {
  input = 0 - input;
  inputPositive = false;
}

// subtract 1 until you just have the decimal portion:
int integerPart = 0;
while (input > 1) {
  input = input - 1;
  integerPart++;
}

int ret;
if (input >= 0.5) { // round up
  ret = integerPart + 1;
} else {
  ret = integerPart;
}

if (inputPositive) {
  return ret;
} else {
  return 0 - ret;
} 
```

此解决方案不使用 mod 或任何外部功能。当然，我无法想象你为什么会在现实生活中想要这个。不过，想想也很有趣。

# iphone - 使用 Transform 正确旋转 UITableView 而不会弄乱 Interface Builder

> ID：875240
> 
> 赞同：4
> 
> 时间：2009-05-17T19:02:55.370
> 
> 标签：iphone, uitableview

UiTableView 在横向模式下不提供水平滚动。

我的 UiTableView 不是全屏的（所以我不能在旋转我的内容时使用它水平模式，这是图片）

我发现要使用 Transforms 旋转我的 UiTableView。我必须将它放置在 Interface Builder 中某个奇怪的位置，以便在旋转时看起来正确.....

有没有人在不使用 Interface Builder 的情况下做到这一点？相同的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T13:26:12.010

好的，问题是由于 tableview 的宽度是灵活的，因此在旋转后单元格的宽度（实际上是高度）也增加了。我通过继承 UITableView 并覆盖 layoutSubviews 方法克服了这个问题，所以现在看起来像这样：

```
- (void)layoutSubviews {

    [super layoutSubviews];

    for (UIView* child in [self subviews]) {

        CGRect frame1 = child.frame;
        if ([child isKindOfClass:[UITableViewCell class]]) {
            frame1.size.width = 120;
            child.frame = frame1;        
        } 
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T19:10:06.243

[请参阅 Apple 网站上的Windows 和视图](http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/WindowsandViews/WindowsandViews.html)概念指南中的自动调整行为部分。这解释了如何在不使用 Interface Builder 且无需处理手动实现复杂变换的情况下实现从纵向到横向再返回的自动旋转。

至于旋转您的自定义内容和禁用滚动，请参阅`shouldAutorotateToInterfaceOrientation:interfaceOrientation`、`willRotateToInterfaceOrientation:duration:`和`didRotateFromInterfaceOrientation:`in [`UIViewController`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html)。您可以实现这些方法来拦截旋转事件，检查您要移动到哪个方向，并在那里处理您的自定义绘图和属性设置内容。

**编辑**

作为对您的评论的回应，我从 Apple的[Table View Programming Guide中找到了这一点：](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/TableViewAPIOverview/TableViewAPIOverview.html#//apple_ref/doc/uid/TP40007451-CH4-SW2)

> UITableView 继承自 UIScrollView，它定义了内容大于窗口大小的视图的滚动行为。 **UITableView 重新定义了滚动行为，只允许垂直滚动。**

也许 Apple 认为水平滚动表格视图违反了他们的人机界面准则。我想知道如果您对 进行子类化，您是否可以重新定义滚动行为`UITableView`，但这可能需要大量的试错工作。如果你真的能够做到这一点，我相信这里的很多人都会对你是如何做到的感兴趣。我搜索了一段时间试图找到其他人的解决方案，但我找不到任何东西。

再说一次，如果你这样做，Apple 可能不允许你的应用进入应用商店，假设它确实打破了 HIG。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-11T23:42:22.233

我知道这有点晚了，但这是我的答案。

正如其他人所说，要实现水平滚动，您可以对 tableview 应用 90 度变换。但是，要摆脱奇怪的帧错误，您必须在变换之前获取帧，应用变换然后将帧恢复到原始帧。

```
 // Save the tableview frame (as it is layed out in IB)
CGRect oldframe = tableview.frame;

// Apply the transform
tableview.transform=CGAffineTransformMakeRotation(M_PI/2);

// For some weird reason, the frame of the table also gets rotated, so you must restore the
//original frame    
tableview.frame = oldframe; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-01T11:35:51.833

您可以通过执行以下操作来实现您正在寻找的东西：

1.  通过代码或 IB 创建一个 UITableView 并将其附加到 UIViewController（不要使用 UITableViewController）
2.  对您的表格应用 90 度逆时针变换。
3.  在您的 tableView:cellForRowAtIndexPath: 方法中，在返回单元格之前对单元格应用 90 度顺时针变换。

砰！您现在有了一个带有垂直单元格的水平滚动表。您可能必须更正单元格和表格的宽度和高度以使一切看起来正确，但我想这可能会对您有所帮助。

另一个提示：您可以使用表格的图层控制旋转的中心点。anchorPoint 属性（它是一个 CGPoint）。如果您将其设置在视图边界中心以外的其他位置，则旋转效果（和任何其他效果）将使用该点作为参考。

# c++ - 如何获取当前目录？

> ID：875249
> 
> 赞同：78
> 
> 时间：2009-05-17T19:05:38.123
> 
> 标签：c++, windows

我一直在 C# 和 Delphi 中这样做，但 C++ 是邪恶的。目的是在当前目录（运行可执行文件的位置）中创建一个文件。

我的代码：

```
LPTSTR NPath = NULL;
DWORD a = GetCurrentDirectory(MAX_PATH,NPath);
HANDLE hNewFile = CreateFile(NPath,GENERIC_WRITE,0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL); 
```

我在 GetCurrentDirectory() 处遇到异常。

请告诉我为什么会出现异常以及如何在 C++ 中使其更容易？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-05-17T19:10:29.223

我建议您在进一步学习之前阅读一本有关 C++ 的书，因为这有助于获得更稳固的基础。[Koenig 和 Moo 的Accelerated C++](http://www.acceleratedcpp.com/)非常出色。

要获取可执行路径，请使用[GetModuleFileName](http://msdn.microsoft.com/en-us/library/ms683197%28VS.85%29.aspx)：

```
TCHAR buffer[MAX_PATH] = { 0 };
GetModuleFileName( NULL, buffer, MAX_PATH ); 
```

这是一个获取没有文件名的目录的 C++ 函数：

```
#include <windows.h>
#include <string>
#include <iostream>

std::wstring ExePath() {
    TCHAR buffer[MAX_PATH] = { 0 };
    GetModuleFileName( NULL, buffer, MAX_PATH );
    std::wstring::size_type pos = std::wstring(buffer).find_last_of(L"\\/");
    return std::wstring(buffer).substr(0, pos);
}

int main() {
    std::cout << "my directory is " << ExePath() << "\n";
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-17T19:08:40.537

`GetCurrentDirectory`不为结果分配空间，这取决于你。

```
TCHAR NPath[MAX_PATH];
GetCurrentDirectory(MAX_PATH, NPath); 
```

此外，如果您想以 C++ 方式执行此操作，请查看[Boost.Filesystem库。](http://www.boost.org/doc/libs/1_39_0/libs/filesystem/doc/index.htm)

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2018-09-26T16:04:46.747

不清楚是需要当前工作目录还是包含可执行文件的目录的路径。

大多数答案似乎都回答了后者。

但是对于前者，以及创建文件问题的第二部分，C++17 标准现在合并了文件系统库，这大大简化了这一点：

```
#include <filesystem>
#include <iostream>

std::filesystem::path cwd = std::filesystem::current_path() / "filename.txt";
std::ofstream file(cwd.string());
file.close(); 
```

这会获取当前工作目录，将文件名添加到路径并创建一个空文件。请注意，路径对象负责处理依赖于操作系统的路径，因此 cwd.string() 返回一个依赖于操作系统的路径字符串。尼托。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-09-13T00:20:56.720

[恕我直言，这里是对匿名回答](https://stackoverflow.com/a/875264/184528)的一些改进。

```
#include <windows.h>
#include <string>
#include <iostream>

std::string GetExeFileName()
{
  char buffer[MAX_PATH];
  GetModuleFileName( NULL, buffer, MAX_PATH );
  return std::string(buffer);
}

std::string GetExePath() 
{
  std::string f = GetExeFileName();
  return f.substr(0, f.find_last_of( "\\/" ));
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-11-10T07:29:56.530

一个简单的方法是：

```
int main(int argc, char * argv[]){
    std::cout << argv[0]; 
    std::cin.get();
} 
```

`argv[]`几乎是一个包含运行 .exe 的参数的数组，但第一个始终是可执行文件的路径。如果我构建它，控制台将显示： `C:\Users\Ulisse\source\repos\altcmd\Debug\currentdir.exe`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-08-03T22:08:49.317

```
#include <iostream>    
#include <stdio.h>
#include <dirent.h>

std::string current_working_directory()
{
    char* cwd = _getcwd( 0, 0 ) ; // **** microsoft specific ****
    std::string working_directory(cwd) ;
    std::free(cwd) ;
    return working_directory ;
}

int main(){
    std::cout << "i am now in " << current_working_directory() << endl;
} 
```

我未能正确使用 GetModuleFileName。我发现这项工作非常好。刚刚在 Windows 上测试过，还没有在 Linux 上尝试过 :)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-12-02T19:54:49.613

请不要忘记在使用它们之前将缓冲区初始化为*某些东西。*同样重要的是，为结尾的 null 提供字符串缓冲区空间

```
TCHAR path[MAX_PATH+1] = L"";
DWORD len = GetCurrentDirectory(MAX_PATH, path); 
```

[参考](http://books.google.ca/books?id=mmjVIC6WolgC&pg=PT128&lpg=PT128&dq=alexandrescu+initialize+variables&source=bl&ots=ccQnLOhLVc&sig=ZSIyxrBMrp1kkC-iFNPwWx-O-m4&hl=en&ei=6izZTr3YHIThiAL7-4HqDw&sa=X&oi=book_result&ct=result&resnum=1&ved=0CBwQ6AEwAA#v=onepage&q&f=false)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-01-09T05:28:01.727

```
WCHAR path[MAX_PATH] = {0};
GetModuleFileName(NULL, path, MAX_PATH);
PathRemoveFileSpec(path); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-17T19:11:32.467

您应该提供一个有效的缓冲区占位符。那是：

```
TCHAR s[100];
DWORD a = GetCurrentDirectory(100, s); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-02-19T17:29:29.777

```
#include <windows.h>
using namespace std;

// The directory path returned by native GetCurrentDirectory() no end backslash
string getCurrentDirectoryOnWindows()
{
    const unsigned long maxDir = 260;
    char currentDir[maxDir];
    GetCurrentDirectory(maxDir, currentDir);
    return string(currentDir);
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-03-15T17:41:33.603

`GetModuleFileName()`您可以使用更优雅的方式删除文件名：

```
TCHAR fullPath[MAX_PATH];
TCHAR driveLetter[3];
TCHAR directory[MAX_PATH];
TCHAR FinalPath[MAX_PATH];
GetModuleFileName(NULL, fullPath, MAX_PATH);
_splitpath(fullPath, driveLetter, directory, NULL, NULL);
sprintf(FinalPath, "%s%s",driveLetter, directory); 
```

希望能帮助到你！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-17T19:17:28.147

*GetCurrentDirectory() 获取当前目录，该目录是从中*调用 exe 的位置。要获取 exe 的位置，请使用 GetModuleFileName(NULL ...)。~~如果你有 exe 的句柄，或者如果你没有，你可以从 GetCommandLine() 派生它。~~

正如巴特沃思先生所指出的，你不需要把手。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-08-25T15:13:39.197

为什么这里没有人考虑使用这个简单的代码？

```
TCHAR szDir[MAX_PATH] = { 0 };

GetModuleFileName(NULL, szDir, MAX_PATH);
szDir[std::string(szDir).find_last_of("\\/")] = 0; 
```

甚至更简单

```
TCHAR szDir[MAX_PATH] = { 0 };
TCHAR* szEnd = nullptr;
GetModuleFileName(NULL, szDir, MAX_PATH);
szEnd = _tcsrchr(szDir, '\\');
*szEnd = 0; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-02-03T09:19:45.297

我想，找到当前目录的最简单方法是从命令行参数中剪切它。

```
#include <string>
#include <iostream>

int main(int argc, char* argv[])
{
  std::string cur_dir(argv[0]);
  int pos = cur_dir.find_last_of("/\\");

  std::cout << "path: " << cur_dir.substr(0, pos) << std::endl;
  std::cout << "file: " << cur_dir.substr(pos+1) << std::endl;
  return 0;
} 
```

您可能知道每个程序都将其可执行名称作为第一个命令行参数。所以你可以使用这个。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-10-14T03:35:37.670

我的 CAE 项目中带有 unicode 开发环境的代码片段：

```
/// @brief Gets current module file path. 
std::string getModuleFilePath() {
    TCHAR buffer[MAX_PATH];
    GetModuleFileName( NULL, buffer, MAX_PATH );
    CT2CA pszPath(buffer);
    std::string path(pszPath);
    std::string::size_type pos = path.find_last_of("\\/");
    return path.substr( 0, pos);
} 
```

只需使用调用内部 API **::MultiByteToWideChar**或**::WideCharToMultiByte的模板****CA2CAEX**或**CA2AEX**。</p>

 ***** * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-05-17T06:52:09.307

如果您使用的是[Poco](https://pocoproject.org/)库，那么它是单行的，它应该适用于我认为的所有平台。

```
Poco::Path::current() 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-01T10:55:14.910

如果您不想使用 std，可以使用以下代码：

```
char * ExePath() 
{
   static char buffer[MAX_PATH] = { 0 };
   GetModuleFileName( NULL, buffer, MAX_PATH );
   char * LastSlash = strrchr(buffer, '\\');
   if(LastSlash == NULL)
        LastSlash = strrchr(buffer, '/');

   buffer[LastSlash-buffer] = 0;
   return buffer;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-03T12:45:07.827

我只是在 Windows 中为此目的使用 getcwd() 方法，它工作得很好。代码部分如下：

```
char cwd[256];
getcwd(cwd, 256);
string cwd_str = string(cwd); 
```

`<unistd.h>`但是必须添加该库。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-05-17T19:22:47.293

要查找可执行文件所在的目录，可以使用：

```
TCHAR szFilePath[_MAX_PATH];
::GetModuleFileName(NULL, szFilePath, _MAX_PATH); 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2014-04-19T06:08:01.683

```
String^ exePath = Application::ExecutablePath;<br>
MessageBox::Show(exePath); 
```

# programming-languages - 在当今环境中了解的编程语言

> ID：875251
> 
> 赞同：4
> 
> 时间：2009-05-17T19:06:12.053
> 
> 标签：programming-languages

我是一个已经编程几年的新手。有许多用于不同目的的编程语言。在说明原因的同时，为了在当今环境中具有竞争力，学习一套好的语言是什么。

我会尽力正确标记这个问题，因为它不是直接编程问题。

**注意：**阅读一些评论后。这不是最好的编程语言问题。C++ 可能比 javascript 更强大，但哪个要求更高？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T20:35:41.037

目前尚不清楚您所说的“这种环境”是什么意思，或者您所说的竞争性是什么意思。了解当前流行的一组语言（例如，可能包括 C#、Java、PHP 和 Ruby）不会有什么坏处。

如果您想获得一份*好*工作并在*任何*环境中都具有竞争力，这就是我在潜在招聘中寻找的：

*   他们了解 C，尤其是成本模型吗？他们真的知道程序执行时寄存器和内存发生了什么吗？如果有人声称 C++ 而不是 C 作为理解程序在机器级别如何工作的基础，他们能否解释模板、虚拟成员函数等发生了什么？

*   他们可以递归解决问题吗？他们可以在不使用可变数据结构的情况下解决问题吗？他们可以通过组合纯函数来解决问题吗？良好的指标是在 Haskell、ML、Caml 或 F# 等语言中的成功。Scheme、Lisp 和 Clojure 也是可以接受的。

*   他们可以[使用类型来帮助理解和创建程序](https://stackoverflow.com/questions/842026/principles-best-practices-and-design-patterns-for-functional-programming/842517#842517)吗？良好的指标是在 Haskell、ML、Caml 或 F# 等语言中的成功。

*   他们是否理解使用函数或对象的高阶编程？

*   他们可以使用别人设计的类库吗？好的指标包括 Smalltalk、Ruby、Modula-3、Java 或 C#。

*   他们真的可以设计自己的类层次结构吗？这需要深入了解 Smalltalk、Ruby、Modula-3、Java、C# 中使用的编程方法。

*   `sh`他们能否使用, `ksh`, `bash`, awk, Lua 或 Python 之类的语言将简单的 Unix 命令有效地组合到脚本中？

*   他们能否使用 Lua、Icon、awk、Python 或 Ruby 等语言快速编写好的字符串处理程序。（我不是 Perl 的粉丝，因为它似乎不能促进其用户的清晰思维。）

因此，要成为我团队的优秀员工，您必须**熟悉四种语言**：C、函数式语言、面向对象的语言和脚本语言（可以接受对字符串处理的偏向）。 *您选择哪种*语言部分取决于口味。我的喜好是只做*一*件事的语言（而不是像 Scala 或 C++ 这样的混合语言），因为它们会*迫使*你学习一种新的思维方式。我会推荐：

*   C

*   Haskell 或标准机器学习

*   Smalltalk（或者可能是 Ruby，如果你从脑海中抹去 Perlish 的起源）

*   卢阿

这四种语言都有明确的做事方式，四种语言中的三种在权重比方面处于领先地位：做事非常好的小语言。第四，不幸的是，没有简单的函数式语言也可以教你使用类型进行编程。

请记住，这些特定语言是个人喜好问题；多换人就好了。重要的是你**学会了用计算机解决问题的强大方法**；语言是实现这一目标的工具，而不是目标本身。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T20:11:42.000

英语和至少一种您的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T19:15:33.410

我认为您必须根据应用领域来决定：

*   “商业”应用
*   游戏编程
*   网络应用
*   算法/数学
*   数据库处理
*   ...

我认为了解一种具有 C 风格语法（C、C++、C#、PHP、Perl、Java）的语言总是一个不错的选择，因为当您了解一种语言时，更容易理解其他此类语言（这些都非常重要） .

作为一种脚本语言，Python 相对普及。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-17T19:45:16.423

在 Windows 世界中，C# 将是一项不错的投资。它将允许您定位客户端应用程序、服务器端应用程序和 Web 应用程序（通过 ASP.NET）。

对于跨平台 Java 是一个不错的选择。它已经存在了很长时间，并且有一组很棒的库，可以让你做几乎任何你想做的事情。它是 C# 的跨平台等价物。

了解脚本语言也很好。现在有很多选择，如果不想引发一场激烈的战争，最好的选择是 Python 或 Ruby。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-17T20:24:51.093

一般来说，我会说：

*   脚本语言，Perl，Python，Ruby
*   一种“低级”语言，C
*   函数式语言，Haskell，Scheme
*   面向对象的语言、C++、C#、Java

但这完全取决于一个人会做什么，例如在有大量数学的科学环境中，了解 matlab 或 R 很重要；在 mac 环境中，了解 Objective-C 很重要。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T20:45:51.807

Tiobe Programming Community Index 可能不时值得一看：

[http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

用他们自己的话来说：

> TIOBE 编程社区指数显示了编程语言的流行程度。该索引每月更新一次。评级基于全球熟练工程师的数量、课程和第三方供应商的数量。流行的搜索引擎 Google、MSN、Yahoo! 和 YouTube 用于计算收视率。请注意，TIOBE 索引不是关于最好的编程语言或编写大多数代码行的语言。该索引可用于检查您的编程技能是否仍然是最新的，或者在开始构建新软件系统时就应该采用哪种编程语言做出战略决策。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T19:08:39.290

Python！和 C#（不幸的是，大多数工作；并不是说 C# 是一种糟糕的语言，但我希望看到更多的竞争）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-26T01:46:35.173

好吧，首先，我根本不是“专家程序员”或任何东西，我可以说我仍在学习我的第一语言。但很多时候，对我来说，进步甚至不是学习特定的语言，总有一些方法可以让你学会更好地使用计算机本身。我发现我喜欢编写批处理文件来为我做事，并使用命令行来做一些事情。

但是，根据我的经验（ofc 很少）：Python 是一门非常好学的语言。它简单，强大，并且可以做很多事情，即使我不知道所有这些

Java 对我来说有点难学，但我想我是在匆匆忙忙地完成它。我已经将 Java 搁置了一段时间。

不过，根据我的研究时间和我在其他地方听到的情况，听起来 C++/Java 是绝对必须的，而 Python 更是一种有用的语言，在日常工作中你可能不像 C++/Java 那样使用它类型语言。

另外，感谢您提出这个问题，我试图解决这个问题，但我的问题已经结束：3

希望我和我缺乏经验以某种方式有所帮助：D

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-17T19:11:27.253

我认为你可以尝试一些 Python、Ruby、PHP、Java、C，然后选择你最喜欢的一个，然后再继续使用它。现在有的公司只做PHP，有的公司主要用Java，有的只用Ruby on Rails，所以你接触一些，然后决定你想更进一步。如果你是好人，那么无论你使用哪种语言，你都会获得好工作的机会很高。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-17T19:13:07.393

Python、Java（或 C#）、C、JavaScript。

最好按这个顺序。这就是基础课程。

Python，因为它很简单。Java 是因为它具有庞大的类库并教授如何使用 API。C，因为这就是它实际运行的原因。JavaScript，因为在 2009 年你不能没有它，而它是最后一次，因为你要么被宠坏，要么更早地无法理解它。

是的，没有框架不要做JS，拿Prototype。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-17T19:13:25.910

正如您所说，有许多编程语言。不同的语言用于不同类型的编程，不同的团队/雇主使用不同的语言。

所以，你的问题的答案取决于“什么样的编程？” 和“哪个雇主？”。

即使我*可以*告诉你最*流行*的语言是什么，那*仍然*无法回答哪种语言会让你更有竞争力：一个人可能最具竞争力的语言可能是一些相对不受欢迎的语言，有一些需求，但没有或很少有竞争对手。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-17T19:13:46.300

在任何给定时间，您都可以查看当地的工作列表来决定需要什么。我会看看你想工作的职位发布，看看有什么可用的。

除非我想去大城市旅行，否则本地的一切似乎都与 ASP/.NET 相关。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-17T20:07:50.510

我建议确保您涵盖所有主要领域。学习 C 以获得一些基础知识，这些基础知识将帮助您学习其他更高级别的语言。学习类似方案的函数式语言，即使它只是为了学习经验。然后当然会选择一些面向对象的东西，比如 C++ 或 C#（取决于你想要的领域）。然后选择一种可靠的脚本语言，比如 python 或 ruby​​，如果你打算接触网络，也可以选择 javascript。如果您打算做大量与 Web 相关的工作，请另外考虑 c# 或 actionscript（分别用于 silverlight 或 flash）。

这应该会给你带来多样性和广泛的理解，让你可以快速、轻松地拿起你需要的任何其他东西。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-18T12:25:25.593

Java 或 C# 或 C++。如果您只想在稳定的公司中找到工作，那么这些就是语言。

为了好玩，有各种各样的语言可能会或可能不会获得更多的工作量。

现在说真的，语言只是某些编程概念的实现。你真正应该关注的是学习这些概念。在那种情况下，学习一门语言只是拿起语法并查找其标准库的问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-18T17:38:59.250

我还建议任何业务应用程序程序员学习一些 SQL，重点是编写高性能查询。很少有业务应用程序不严重依赖数据库访问。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-18T18:06:47.463

你的问题中缺少的是你的能力和愿望，你住在哪里（以及你愿意搬迁），以及你正在寻找什么。

您可以查看各种职位空缺列表，或者您当地的工作委员会，以查看大多数工作在哪里。如果您现在想最大限度地提高被录用的机会，这可能是您最好的选择（尽管您可能会因竞争而措手不及——如果每个人都遵循这个计划，就会出现供过于求的情况，`$POPULAR_LANGUAGE`而且更容易被录用`$LESS_POPULAR_LANGUAGE`） . 这也可能因地区而异。

不过，这并不能保证高薪。你将与​​编程基因库的底层竞争，薪水很可能基于此。如果您能胜任并找到工作，那么不太常见但技术含量更高的东西可能会提高您的薪水。

它也不一定适合长期就业。二十年后你想去哪里？如果您坚持使用当前流行的语言，并且不准备从那里迁移，那么十年后您很可能会陷入低薪和乏味的项目中。如果你想尝试让自己适应未来，你可以学习更难、更多样化的语言。

如果您有创业的雄心，请考虑您想做什么，以及最适合做什么。在初创企业中，您必须能够完成大量工作，因此您需要效率，并且您可以使用几乎任何您想要的语言和环境，特别是如果它是基于 Web 的方法。

另外，实际上，您的能力如何？你能掌握技术科目并超越你的竞争对手，还是你相当平庸并希望生活在群体中？您喜欢编写软件，还是正在寻找高薪过渡到业务主管？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-08-23T21:53:58.000

您应该了解主流语言，例如：C/C++、C#、Java、XHTML/CSS 和 SQL

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-02-20T13:23:03.640

我高度个人化和有偏见的看法是，你应该学习：

*   **Java** - 它的语法非常冗长和简单，但这对于初学者和任何必须维护大型公司代码库的人来说都是一个巨大的优势。它拥有首屈一指的庞大的开源图书馆生态系统。而且您可以获得很棒的免费 IDE，例如 Eclipse。您还可以编写 Android 应用程序。此外，无论您喜不喜欢，它都是业务发展的第一语言，因此您在工作方面不会出错。

*   **汇编器**- 因为最好的编码器应该知道他们的机器是如何工作的。你可能永远也找不到工作，甚至无法在其中写任何特别大的东西，但它会让你成为一个更好的开发人员。在此之后，您将真正欣赏更高级别的语言....

*   **Clojure** - 因为它是一个 Lisp，每个人的生活中都应该有适当的 Lisp 体验。它是一种适合快速开发的动态语言。它是一种现代函数式编程语言。它非常适合并发。这是未来。有什么不喜欢的？

*   **Javascript——**因为在某些时候，你肯定会想在网络上做客户端的事情。它本身就是一种有趣的语言。这是您最有可能做某事的唯一一个，它将给您的朋友/家人留下深刻印象，他们只想在互联网上看到一些漂亮的东西。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-05-17T20:46:28.967

C# 很棒（你也可以在 linux 上用 mono 来使用它）还有 ruby​​ on rails 和 PHP，也许还有 F#

# iphone - 在 iPhone 上录制“Apple 无损”音频

> ID：875252
> 
> 赞同：2
> 
> 时间：2009-05-17T19:06:12.087
> 
> 标签：iphone, audio, core-audio, mp4

你能指出我的文档/片段/博客，它解释了如何在 iPhone 上录制苹果无损音频文件，好吗？

我检查了 Apple Dev Center 中的录音机示例，但无法弄清楚我将哪个设置用于无损音频。

问候，

斯特凡

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T15:42:19.480

iPhone OS 支持使用多种不同的压缩音频编码格式录制 .caf 文件：

Apple Lossless - kAudioFormatAppleLossless

iLBC（互联网低比特率编解码器）-kAudioFormatiLBC

IMA/ADPCM (aka IMA4) - kAudioFormatAppleIMA4

µLaw - kAudioFormatULaw

aLaw - kAudioFormatALaw

```
- (id) initWithURL: fileURL {
    NSLog (@"initializing a recorder object.");
    self = [super init];

    if (self != nil) {

        // define the audio stream basic description for the file to record into

        // record audio at the current hardware sample rate
        // make sure the audio session is active before asking for properties
        UInt32 propertySize = sizeof(audioFormat.mSampleRate);
        AudioSessionGetProperty(kAudioSessionProperty_CurrentHardwareSampleRate,
                                &propertySize,
                                &audioFormat.mSampleRate);

        audioFormat.mFormatID           = kAudioFormatAppleIMA4; // record using IMA4 codec
        audioFormat.mChannelsPerFrame   = 1;

        AudioQueueNewInput(&audioFormat, ... );

        ...

    }

    return self;
} 
```

您肯定想阅读[音频队列服务编程指南](http://developer.apple.com/iphone/library/documentation/MusicAudio/Conceptual/AudioQueueProgrammingGuide/AudioQueueProgrammingGuide.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:55:49.787

查看 Apple iPhone 开发中心上的 SpeakHere 示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-22T14:25:24.893

我将 iTalk Recorder Premium 用于 .aiff（未压缩），然后导出到笔记本电脑并使用**flac**对其进行压缩 - 默认情况下会保留时间戳。

```
flac --best *.aiff 
```

# java - visualvm 中的美元符号

> ID：875253
> 
> 赞同：2
> 
> 时间：2009-05-17T19:07:55.873
> 
> 标签：java, profiling, visualvm

我正在尝试分析一个应用程序，并且我有很多 sim.core.EndPoint$2 类型的实例

当我检查这些实例时，我确认它们不是 sim.core.EndPoint 类型，它们似乎是一个 EndPoint，还有一些不应该存在的东西。

VisualVM中类型名称后的美元符号是什么意思？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T19:09:49.863

这意味着它是 EndPoint.java 中定义的匿名内部类。

顺便说一下，ClassName$AnotherName 是在 JVM 中指定内部类的约定。

查看 EndPoint 定义了哪些匿名类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T19:59:38.857

它肯定是一个编译器工件（对你来说是隐藏的，但它是工作所必需的）。

如果它不是匿名类，它可能是匿名对象引用封闭类的方式。您在匿名类中引用的“外部”是否有任何最终对象？

# html - 如何在 Internet 网站上显示本地存储的图像？

> ID：875255
> 
> 赞同：1
> 
> 时间：2009-05-17T19:08:16.527
> 
> 标签：html, image, local-files

我想在我的网站上显示存储在访问者本地文件系统中的图像。

**假设我在访问者驱动器上有图像的位置（例如 c:\Documents And Settings\Ropstah\image.png），那么我是否可以在我的互联网网站上显示此图像（例如 www.website.com） ?**

当我使用以下语法（Internet Explorer 7、Firefox 3 等）时，图像似乎不会加载：

```
<img src="file://c:\Documents and Settings\Ropstah\image.png" /> 
```

如果 .html 文件（我在 website.com/index.html 上使用）位于我的本地电脑上，则图像**会显示...**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T19:11:51.873

这听起来像是 Web 浏览器上的安全设置，可能设置为阻止访问 Internet 站点的本地文件系统的级别。

用户可以以特定于每个浏览器的方式编辑安全设置。例如对于 IE，它的工具 -> Internet 选项 -> 安全

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T19:33:05.637

如果用户将您的站点设置为受信任区域，则可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T19:12:36.050

你不能。

愚蠢的是，这些浏览器决定通过不允许公共网页禁用本地内容来关闭“安全漏洞”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T19:17:03.670

使用纯 HTML，您无法访问存储在用户计算机上的文件。您可以改用 Flash、Java Applet、ActiveX、Silverlight、...

# xcode - 可可/苹果符号服务器

> ID：875261
> 
> 赞同：2
> 
> 时间：2009-05-17T19:09:33.077
> 
> 标签：xcode, cocoa, gdb

[Microsoft public symbol server 和 windbg](http://msdl.microsoft.com/download/symbols)的 dbg/cocoa/apple 字中是否有等价物？

所以基本上

1.  gdb 是否支持符号服务器的概念？
2.  苹果是否为自己的公共符号提供公共 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T19:39:24.967

1) 不是，但您*可以*从外部文件加载符号 2) 否

见[http://zenit.senecac.on.ca/wiki/index.php/Potential_Projects#gdb_symbol_server_support](http://zenit.senecac.on.ca/wiki/index.php/Potential_Projects#gdb_symbol_server_support)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T19:47:34.890

Mac OS X 框架无论如何都包含符号（在函数名和 Objective-C 信息的范围内），因此您不需要 Apple 从服务器提供该信息。

对于您自己的应用程序，将调试符号格式设置为 DWARF-with-dSYM，并为每个测试版和最终版本存档 dSYM 包。gdb 应该从 dSYM 包中检索符号信息，只要您将它们与真实的（例如，.app）包放在一起。同样，不需要服务器。

更多信息：

*   [使用 Xcode 调试和符号化故障转储](http://developer.apple.com/tools/xcode/symbolizingcrashdumps.html)
*   [Symbolicator](http://boredzo.org/symbolicator/)（一种符号化崩溃日志的工具——依赖于 dSYM 包，但在磁盘上的位置方面不如 gdb 那样挑剔）

# algorithm - 颜色生成功能

> ID：875270
> 
> 赞同：3
> 
> 时间：2009-05-17T19:12:47.407
> 
> 标签：algorithm, rgb

让我们考虑以下场景：一个函数可以生成从白色到红色、从白色到蓝色、从白色到粉色、从白色到橙色等的代码颜色。

颜色代码采用 RGB 格式，值从 0 到 255。

有任何想法吗？你能给我这个算法的伪代码或链接吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T19:19:22.760

听起来你在进行[线性插值](http://en.wikipedia.org/wiki/Linear_interpolation)- 在你的情况下，从白色插值到指定的颜色。例如，在 C# 中：

```
public IEnumerable<Color> Interpolate(Color from, Color to, int steps)
{
    int range = steps-1; // Makes things a bit easier
    for (int i=0; i < steps; i++)
    {
        // i is the proportion of the "to" colour to use.
        // j is the proportion of the "from" colour to use.

        int j = range - i;
        int r = ((from.R * j) + (to.R * i)) / range;
        int g = ((from.G * j) + (to.G * i)) / range;
        int b = ((from.B * j) + (to.B * i)) / range;
        yield return new Color(r, g, b);
    }
} 
```

当然，除了线性插值之外还有其他方法，但这可能是最简单的。请注意，如果您有很多步骤或更大的值，这会变得很棘手，因为您需要考虑溢出的可能性。在这种情况下你应该没问题 - 你不太可能想要超过 256 步，最大值是 255，所以你不会接近`int`s 的限制。

编辑：如评论中所述，RGB 可能不是使用线性插值的最佳域。您最好将 from/to RGB 值转换为[HSL 或 HSV](http://en.wikipedia.org/wiki/HSL_color_space)，并对它们进行插值。根据您的平台，这可能很容易或很棘手。如果没有为您提供适当的计算公式，上一句中的维基百科链接会给出相应的计算公式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T19:18:55.180

算法：

1.  查找白色的 RGB 值
2.  查找其他颜色的 RGB 值（例如，您提到红色、蓝色、粉红色、橙色）
3.  计算其 RGB 分量在算术上介于两个极值的 RGB 分量之间的 RGB 值

例如，如果一个极端是（0,0,0），另一个极端是（0,255,255），那么这两种颜色之间的中间值是（0,128,128）......并且值是这些颜色之间四分之一的值两个值是（0,64,64）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T23:22:07.297

通过已知的特定点对颜色进行插值通常用于构建图形数据的配色方案。显式插值公式的替代方法是选择在其表示背后有一些设计的配色方案。这种方案的一个很好的来源是[ColorBrewer](http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer_intro.html)。

即使您需要插值，从精心设计的配色方案开始也可以产生更多可用的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T19:19:52.120

从你想要渐变的两种颜色开始，然后将它们分成 R、G 和 B 部分。

决定要淡出多少个“步骤”。

将 R、G 和 B 部分之间的差异除以步数。现在，每种颜色都有一个“阶梯差”。

循环遍历每个步骤，并为每次迭代将步长差添加到颜色值一次。*你做的最后一*件事是四舍五入到整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T19:17:56.337

你想改成什么颜色？白色到红色只是从 255 255 255 开始并递减后两个直到你有 255 0 0 的情况。蓝色将保留最后一个值并递减以结束 0 0 255 等

# java - 在 LinkedList 中查找数字的中位数

> ID：875285
> 
> 赞同：2
> 
> 时间：2009-05-17T19:18:10.360
> 
> 标签：java, linked-list, median

你如何找到在 Java 中存储为 LinkedList 的数字列表的中位数？我不明白维基百科所指的选择算法。如果你能解释一下，加分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T19:23:42.050

最好的算法是[QuickSelect](http://goanna.cs.rmit.edu.au/~stbird/Tutorials/QuickSelect.html)

阅读文章并尝试理解 QuickSort - 概念类似。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T22:22:08.380

您基本上有两个主要选择：

1.  简单快捷的方法 - 对列表进行排序`O(nlogn)`。由于中位数被定义为一半的值大于它，一半的值小于它的值，所以只需取第一个`n/2`值 - 这就是中位数。

2.  如果这是一项对性能至关重要的任务，您可以应用各种选择算法，这些算法可以`O(n)`在好的情况下为您提供（但在最坏的情况下仍不能保证线性）。

无论如何，请查看 wikipedia entry on [**Selection Algorithms**](http://en.wikipedia.org/wiki/Selection_algorithm)，这应该可以让您对所有可用的方法有一个很好的总结。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T19:47:43.767

如果您想要一种快速编程的方式，请对列表进行排序并选择中间元素（或两个中间元素的平均值）。

更有效的选择算法本质上是尽量避免对列表中您实际上不需要排序的位进行排序，以找到给定*n的第**n*个元素。（JDK 目前不提供这种开箱即用的算法。）**更新：**为了扩展我之前的帖子，更有效方法的示例包括：

 ****   基于[并行排序](http://www.javamex.com/tutorials/threads/CyclicBarrier_parallel_sort.shtml)的选择，其初始阶段在对每个存储桶进行排序之前将数据放入多个“存储桶”，但随后（在中位数的情况下）您实际上只对中间的“存储桶”进行排序，因为精确任何一方的桶中项目的顺序都无关紧要
*   基于诸如快速排序之类的分而治之排序算法进行选择，但同样，该算法实际上并未对超出所需范围的子列表进行排序。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-17T19:56:12.797

中位数是排序列表中间的数字。（对于条目数奇数的列表很容易，对于条目数为偶数的列表，它可以是两个“中间数字”之间的任意数字）

所以对列表进行排序，并找出中间的数字是什么。

# c# - WinForms 列表框中的图像缩略图

> ID：875288
> 
> 赞同：3
> 
> 时间：2009-05-17T19:19:17.503
> 
> 标签：c#, winforms, image, listbox

我正在尝试在 Windows 窗体应用程序的列表框中显示缩略图。我已经阅读并看到了各种建议，但我正在寻找最简单的建议。这是我正在尝试做的事情的详细信息。

我正在尝试显示图像的缩略图并在其旁边显示文本。

我查看了 ListViews，但它们似乎没有提供我正在寻找的东西。任何代码将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T19:30:56.217

将您的列表框设置为 ownerdraw

然后在 itemdraw 事件（或者它是 drawitem 吗？）中抓取您的图像并将其绘制在分配的空间中（`e.Graphics.DrawImage`），然后在它旁边绘制项目的测试（`e.Graphics.DrawString`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T19:35:05.787

ImageListBox 有很多实现。可以在这里找到：http: [//www.codeproject.com/KB/combobox/imagelistbox.aspx](http://www.codeproject.com/KB/combobox/imagelistbox.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T19:43:28.843

将图像列表分配给 ListBox 并将 View 属性设置为：List 或 Tile，现在为每个项目选择应显示列表中的哪个图像。在我看来，与带有图像的 ListBox 完全一样；）

# sql - 如何在 AIX 上的 DB2 中删除多个列？

> ID：875291
> 
> 赞同：2
> 
> 时间：2009-05-17T19:20:04.303
> 
> 标签：sql, db2

在 DB2 中删除多个列的语法是什么？我试过这个：

```
ALTER TABLE work_item DROP COLUMN (TRANSACTION_TYPE, REQUEST_TYPE, LOCATION_CODE, ROLE_ID, SUBMITTED_BY); 
```

但它没有用。我在 AIX 上运行（根据我的阅读，看起来您可能根本无法在 AIX 以外的平台上删除列）。

如果我一一删除列，它似乎可以工作，但是在前三个之后，我需要到`REORG`表中。我想一口气做到这一点，没有 REORG。

是否可以？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T19:32:45.853

以下内容适用于 Windows 上的 DB2 9.5，但也适用于 AIX 上的早期版本：

```
ALTER TABLE MYSCHEMA.ABC
DROP COLUMN B
DROP COLUMN C 
```

[这是关于 ALTER TABLE 命令的文档](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.db2.luw.sql.ref.doc/doc/r0000888.html)

# algorithm - 用于可变长度记录存储和磁盘查找的数据结构/算法，仅在主键上搜索

> ID：875304
> 
> 赞同：5
> 
> 时间：2009-05-17T19:30:40.960
> 
> 标签：algorithm, data-structures, filesystems, disk

我正在寻找一种适用于基于大块的设备（例如机械硬盘驱动器）的算法/数据结构，该结构针对插入、获取、更新和删除进行了优化，其中始终使用数据的 ID 和数据的位置进行搜索任何 ID 的字段都有可变长度。

B-Tree 似乎是一种常用的结构，但主要用于固定长度的记录。我还期望获取和更新比插入和删除要多得多。我可以摆脱 B 树的 O(log m) 查找吗？

我很高兴它是一个组合系统，例如 ISAM 结合了 B-tree 和线性文件存储，看起来它可以使用可变长度记录作为一种方法。有更好的吗？

一些进一步的限制：

1) ID 可能是稀疏的，但它们可以以线性数字块的形式出现 - 但范围很大（64 位）

2) 我不想使用 DBMS，我的特定问题的性能并不是很好。我不需要完整 DBMS 使用的任何操作，也不需要搜索。我需要一些可以轻松调整和优化的东西。称之为学术好奇心，如果它被 MySQL 完成，那么我会使用它，但我必须尝试走得更快。

3）数据集大于内存，但是如果索引像键，偏移量一样简单，它可能很适合内存。我当然正在研究存储中的 10 亿个或更多实体。

4) 理想情况下，删除记录时应恢复空间。这可能是通过压缩，但我很想看看是否有更好的方法（例如，B 树很容易恢复空间）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-18T10:23:00.923

最简单的方法：使用像 Berkeley DB 这样的东西。它为任意字节字符串提供键值存储，并为您完成所有艰苦的工作。如果您愿意，它甚至提供用于索引的“二级数据库”。

自己动手的方式：使用协议缓冲区（或您选择的二进制格式）来定义 B-Tree 节点和数据项结构。为您的数据库使用仅附加文件。要写入新记录或修改现有记录，只需将记录本身写入文件末尾，然后写入任何修改后的 B-Tree 节点（例如，记录的父节点、*其父*节点等直到根）。然后，将树的新根的位置写入文件开头的标题块。要读取文件，您只需找到最近的根节点并像在任何其他文件中一样读取 B-Tree。这种方法有几个优点：

*   由于写入的数据永远不会被修改，读取者不需要锁定，并在开始读取时基于根节点获得数据库的“快照”视图。
*   通过向您的节点和记录添加“先前版本”字段，您可以基本上免费访问先前版本的数据库。
*   与大多数支持修改的磁盘文件格式相比，它非常容易实现和调试。
*   压缩数据库包括简单地读出最新版本的数据和 B-Tree 并将其写入新文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:43:36.597

如果您的 ID 是数字并且不是很稀疏，则一种选择是在一个文件中使用一个简单的（偏移量、长度）表，并引用另一个文件中的数据。这将使您进行 O(1) 查找，并且更新/插入/删除仅受您的可用空间跟踪机制约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T20:57:46.430

最好的可能是使用商业数据库引擎。

您可以通过将索引（即 {"logical ID" maps to "physical location"} 值对）存储在哈希映射中（对逻辑 ID 进行哈希处理）来摆脱 B-tree 的任何 O(log m) 查找...或者，甚至，如果 ID 值不是稀疏的，则将索引存储在连续向量中（逻辑 ID 用作偏移值向量的索引），如 bdonlan 建议的那样。

一个重要的实现细节可能是您用来访问索引的 API：是否将其存储在 RAM（操作系统与系统页面文件一起支持）并使用指针在进程内访问它，和/或将其存储在磁盘（O/S 缓存在文件系统缓存中）并使用文件 I/O API 访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T07:03:30.040

如果数据库对您来说很重，请考虑使用键值存储。

如果您真的要自己实现它，请使用基于磁盘的哈希表或 B 树。为避免可变长度值的问题，请将值存储在单独的文件中，并使用 B 树作为数据文件的索引。删除值后的空间回收会很棘手，但它是可能的（例如，通过数据文件中释放空间的位集）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-27T13:01:31.790

# 索引可变长度记录文件。

索引可变长度记录文件可能看起来像一项艰巨的任务，但一旦您确定哪些是移动部分，它真的非常简单。

为此，您应该以固定大小的块（即 128、256 或 512 等）读取文件。您的记录还应该有一个**易于识别的记录结束字符**。这意味着该字符不能作为常规字符出现在您的记录中。

接下来是扫描文件以查找**每条记录的开头，**创建具有以下结构的索引文件：

```
key, 0, 0
........
........
key, block, offset 
```

这里的**key**是您索引文件的键（字段）（可以是复合键）。**block**是记录开始的（从 0 开始*的*）块编号，**offset**是记录开始到块开始的（从*0*开始的）偏移量。*根据您使用的块大小，您的记录可能跨越多个块。*因此，一旦您找到记录的开头，您需要获取**尽可能多的连续块**来检索整个记录。

如果您需要搜索不同的条件，完全可以同时创建多个索引文件。

创建此索引文件后，下一步是按关键字段对其进行排序。或者，您可以使用[**插入排序**](https://en.wikipedia.org/wiki/Insertion_sort)机制，在创建索引文件*时对其进行排序*。

**[使用类似文件搜索的](https://en.cppreference.com/w/c/io/fseek)**函数检索按该键排序的记录，在索引文件上查找键并检索其记录偏移量对。[**在这种情况下，二分搜索**](https://en.wikipedia.org/wiki/Binary_search_algorithm)似乎表现得相当好，但您可以使用任何类型。

这种结构允许您的数据库接受记录的**添加**、**删除**和**更新**。在文件末尾进行添加，将其键添加到索引文件中。要删除记录，只需将记录的第一个字符更改为**唯一字符**，`0x0`然后从索引文件中删除条目。更新可以通过删除然后在文件末尾添加更新的记录来实现。

如果您打算处理非常大的文件，那么为索引使用类似[**B-Tree**](https://en.wikipedia.org/wiki/B-tree)的结构可能会有很大帮助，因为**B-Trees 索引不需要完全加载到内存中。**B-Tree 算法进一步将索引文件划分为*页面*，然后根据需要将这些页面加载到内存中。

# ruby-on-rails - 从 Rails 模式更新生成迁移，而不是相反

> ID：875311
> 
> 赞同：1
> 
> 时间：2009-05-17T19:34:41.403
> 
> 标签：ruby-on-rails, database, schema, migration

我讨厌编写迁移，但模式保持同步很重要。我更愿意做的是更新我的`schema.rb`并让 Rails 通知，然后运行一些基于旧版本和当前版本之间的差异生成适当迁移的东西。

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T19:45:19.840

一些谷歌搜索揭示了这个插件：[http ://errtheblog.com/posts/65-automatically](http://errtheblog.com/posts/65-automatically)

它实际上并没有为您创建迁移。但看起来它基本上可以满足您的需求。

编辑：这是插件代码的最新链接：http: [//github.com/pjhyett/auto_migrations/](http://github.com/pjhyett/auto_migrations/)

# javascript - 如何在不使用 Javascript 的情况下最好地重定向网页？

> ID：875318
> 
> 赞同：0
> 
> 时间：2009-05-17T19:39:10.523
> 
> 标签：javascript, html, http-status-code-301, http-status-code-302

我的默认页面中有一些脚本，可根据浏览器的语言将用户重定向到我网站的特定语言版本。我想添加一些东西来重定向那些没有启用 Javascript 的用户。

目前我有以下内容：

```
<noscript>
  <META HTTP-EQUIV=REFRESH CONTENT="1; URL=en/index.htm">.
</noscript> 
```

但我读过这不是太明智，因为一些搜索引擎不赞成它。我该如何做到这一点并让搜索引擎满意？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T19:42:16.413

您应该使用 .htaccess 文件从标头中检测浏览器的语言（使用正则表达式），然后以这种方式重定向它们。这样做与客户端配置完全无关，搜索引擎会正确处理它。有大量关于如何实现这一点的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T19:42:27.893

可以通过添加以下 http 标头使用服务器端语言来完成

```
Location: /en/index 
```

将用户重定向到[http://www.example.com/en/index](http://www.example.com/en/index)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T19:43:35.270

您需要[解析`Accept-Language`HTTP 标头](http://www.thefutureoftheweb.com/blog/use-accept-language-header)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T19:43:57.080

为什么不在服务器端重定向，通过 302 HTTP 状态代码进行响应。我不知道你在服务器上有什么，但所有框架都支持它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T19:52:50.370

您也可以使用 301 HTTP 状态代码在服务器端重定向。这是实现良好 SEO 的最佳方法。该示例在 C# 中，但每个平台都有自己的方法来将标头添加到响应中：

```
Response.Clear();
Response.Status = "301 Moved Permanently";
Response.AddHeader("Location", "/newfolder/newfilelocation"); 
```

使用 301 状态码的原因是搜索引擎索引了新页面，因为它是“永久移动”而不是“临时移动”的 302。

# svn - 帮我解释一下为什么系统构建工具不应该自动进行 SVN 签入

> ID：875324
> 
> 赞同：2
> 
> 时间：2009-05-17T19:41:20.563
> 
> 标签：svn, workflow, sysadmin, cfengine

我正在尝试**反对自动签入到版本控制**。我的工作小组围绕 CFEngine 编写了一些系统构建工具，现在他们认为这些工具应该自动检查 SSH 主机密钥等事情。

**现在**，作为一名程序员，我最初的直觉反应是，除了人类之外，没有什么应该调用“svn up”和“svn ci”。在最近的一个案例中，一堆文件的 .rNNNN 合并版本破坏了工具，这就是本次讨论的开始。

**现在**，设计工具的人基本上承认他正在使用 SVN 来同步文件，并且他基本上可以用 NFS 挂载替换所有这些。他甚至说他会将“svn diff”包装成“make diff”，因为这似乎比我们所有人都知道 SVN 的工作原理要好。

**所以......**我在这里要求人群帮助我为没有 Makefile、shell 脚本等包装 Subversion 命令提出一个很好的论据，而 Subversion 基本上被用于在不同机器上同步文件。

这是我的清单，到目前为止：

1.  我们并没有真正对这些数据进行版本控制，所以它不应该放在 svn 中。
2.  我们已经说过它可以被 NFS 挂载所取代，所以我们为什么不这样做。
3.  **本土工具现在正在包装 SVN，软件总是会有错误，因此当我们遇到错误时，我们的 SVN 修订版现在会弄得一团糟。**

...请讨论/帮助我提出这个问题，或者告诉我你为什么不同意！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T19:55:10.053

SVN 是用于在机器上同步文件的好工具！如果我想让一堆机器拥有完全相同版本的文件，那么让它们处于颠覆状态并能够检查它们是天赐之物。是的，您可以使用诸如 rsync 之类的工具或安装 NFS 以使它们保持最新，但至少 subversion 允许您存储所有修订并在需要时回滚/转发。

不过，我要说的一件事是，当这些文件可能破坏您的系统时，让机器从主干自动更新可能是个坏主意，它们应该从标签更新。这样，您可以签入并维护修订历史记录测试它们，然后应用一个标签，该标签将在其他机器上同步文件更新时。

我理解您对让这些工具自动提交的担忧，因为您可能觉得应该需要某种人工验证，但对我来说，消除人工交互可以消除流程中的人为错误，而这正是我希望从这种类型的系统中实现的。

当您在 svn 树上设置生产标签之前确认一切正常时，应该考虑到人的方面。

总而言之，您的流程很好，盲目地允许自动化流程将文件推送到可能破坏事物的环境中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T20:00:34.113

实际上SVN比NFS好。至少它提供了一个原子一致的全局视图（即，您不会同步文件的半提交视图）。我反对开发自动提交，因为它不允许同行评审过程，但对于管理工作，SVN 非常有用。我的2c。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T19:59:22.853

[这是旧鞋与玻璃瓶](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)辩论的另一个例子。在这种情况下，NFS 挂载可能是要走的路，我们的夜间构建提交版本控制更改，仅此而已。

您的 SVN 存储库用于帮助版本和构建代码。如果你正在做的事情以任何方式危害到这一点，那么不要这样做。

如果 SVN 绝对是最好的方法，那么创建一个单独的存储库并使用它，不要管关键存储库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T22:01:36.010

只有人类应该提交，但我认为没有理由禁止自动结帐和更新。唯一的事情是确保人们将工作和测试的代码提交到进行自动更新的地方。

NFS 有点酷，但如果 NFS 服务器坏了，你就有麻烦了。您可以尝试使用 GlusterFS 之类的东西来拥有多个数据副本（但不要尝试`ls`使用 Glusterfs 目录，因为它是 O(number of files) ）。

`Neil Trodden` posted an excellent remark on tags in this thread, it'd solve Your problem I suppose.

# java - 在 swing GUI 中跟踪更改

> ID：875334
> 
> 赞同：1
> 
> 时间：2009-05-17T19:44:31.400
> 
> 标签：java, swing

比如说，一个包含大量 JCheckboxes、JTextfields、JLists 和其他 JComponents 的应用程序属性页面。现在，我需要做的是跟踪用户所做的更改并保存它们。实现这一点的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T20:36:25.280

您不需要实时跟踪更改（除非有特殊需要）。

您可以对 OK 按钮做出反应，迭代组件，获取它们的值，也许与旧的比较或只是盲目地保存所有值。
如果用户取消，当然放弃一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T05:56:45.030

您可以使用两种方法：

(1) 当用户在您的属性页面上单击“确定”时，从您的 JComponents 中提取当前值并更新您的设置或诸如此类的东西。这是最简单的方法，因为您不需要 ActionListeners 并且如果用户退出，您不必回滚更改（但从您的问题来看，此对话框/页面的作用并不完全清楚）。

(2) 对于实现了ActionListener的swing对象，监听ActionEvent并相应地处理变化。对于 JTextFields，使用 DocumentListener，如下面的示例代码所示：

```
import java.awt.BorderLayout;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;

public class Test implements DocumentListener
{
  private JTextField jtf;

  public static void main(String[] args)
  { 
    javax.swing.SwingUtilities.invokeLater(new Runnable()
        {
          public void run()
          {
            Test test = new Test();
          }
        });
  }
  public Test()
  {
    JFrame jf = new JFrame();
    JPanel jp = new JPanel();
    jtf = new JTextField();
    jtf.getDocument().addDocumentListener(this);
    jp.setLayout(new BorderLayout());
    jp.add(jtf, BorderLayout.CENTER);
    jf.add(jp);
    jf.setSize(200, 100);
    jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    jf.setVisible(true);
  }

  public void changedUpdate(DocumentEvent e) 
  {
   // Do stuff here
  }
  public void insertUpdate(DocumentEvent e) 
  {
    // Do stuff here
  }
  public void removeUpdate(DocumentEvent e) 
  {
    // Do stuff here
  }
} 
```

正如您可能从 (1) 中猜到的，如果用户退出并且您必须考虑如何回滚任何更改，则 (2) 中的挑战会出现。不过，这实际上取决于您在做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T06:44:29.943

[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)应该对此有所帮助。基本上它允许一个组件（发布者）通知其他组件（订阅者）事情，基本上它是一个 ActionListener （如[Catchwa's Answer](https://stackoverflow.com/questions/875334/tracking-changes-in-a-swing-gui/876422#876422)）。

来自 Google[的观察者模式 Java 示例](http://www.google.com/search?q=Java+Observer+Pattern+example)

如果您可以查看[Head First Design Patterns](http://oreilly.com/catalog/9780596007126/)的第 2 章或[Action Listener 教程](http://java.sun.com/docs/books/tutorial/uiswing/events/actionlistener.html)

我希望这会有所帮助，目前我无法举出一个例子，但希望这能帮助您入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T19:48:12.547

一个 Command 类和一个可序列化的 ArrayList 或 LinkedList 的命令。命令将在 actionPerformed 方法中生成。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T07:10:27.470

我的主要问题是，您要记录哪些更改/事件。点击、文本更改、按钮状态、....

对于每个事件，您都可以将侦听器添加到 swing 组件。一个[单例](http://en.wikipedia.org/wiki/Singleton_pattern)类可以是您要添加到不同组件的侦听器的实现者。您可以将这些单例类添加到不同的组件中。

当组件发生变化或通知特殊监听器时，单例管理器会收到通知并可以处理此事件。

管理器可以记录即将到来的事件，还可以保存一个 EventObject，其中包含您要存储的所有内容。可以使用[xstream](http://xstream.codehaus.org/)存储在磁盘上的 EventObject 列表。

# python - 使用 map() 和 for 有什么价值吗？

> ID：875337
> 
> 赞同：10
> 
> 时间：2009-05-17T19:45:43.520
> 
> 标签：python, for-loop, map-function

map() 会像“for”那样遍历列表吗？使用 map vs for 有什么价值吗？

如果是这样，现在我的代码如下所示：

```
for item in items:
    item.my_func() 
```

如果有意义，我想将其设为 map()。那可能吗？一个例子是什么样的？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-17T19:49:16.990

您可以使用[`map`](http://docs.python.org/3.0/library/functions.html#map)而不是`for`您显示的循环，但由于您似乎没有使用 的结果`item.my_func()`，因此**不建议**这样做。`map`如果要将没有副作用的函数应用于列表的所有元素，则应使用。在所有其他情况下，请使用显式 for 循环。

此外，从 Python 3.0 开始，`map`返回一个生成器，因此在这种情况下`map`将不会表现出相同的行为（除非您明确评估生成器返回的所有元素，例如通过调用[`list`](http://docs.python.org/3.0/library/functions.html#list)它）。

* * *

**编辑**：[kibibu](https://stackoverflow.com/users/81804/kibibu)在评论中要求澄清为什么`map`' 的第一个参数不应该是具有副作用的函数。我会尝试回答这个问题：

`map``f` [意味着在数学意义上](http://en.wikipedia.org/wiki/Function_%28mathematics%29)传递一个函数。在这种情况下，第二个参数的元素以何种顺序应用并不重要`f`（当然，只要它们以原始顺序*返回*）。更重要的是，在这些情况下，在`map(g, map(f, l))`语义上等同于`map(lambda x: g(f(x)), l)`，无论*和**应用于各自输入**的顺序如何`f``g`*。

`map`例如，一次返回和迭代器或完整列表都没有关系。但是，如果`f`和/或`g`导致副作用，那么只有当 的语义`map(g, map(f, l))`在任何阶段`g`应用于由before返回的前*n 个*元素应用于的*(n + 1)* st 元素时，才能保证这种等价性。（这意味着必须执行最懒惰的迭代——它在 Python 3 中执行，但在 Python 2 中不是！）`map(f, l)``map(f, l)``f`*`l``map`*

 *更进一步：即使我们假设 的 Python 3 实现，如果 的输出在提供给外部调用之前被传递`map`，语义等价可能很容易被打破。`map(f, l)`[`itertools.tee`](http://docs.python.org/3.1/library/itertools.html#itertools.tee)`map`

上面的讨论似乎是理论上的，但随着程序变得越来越复杂，它们变得更难推理，因此也更难调试。确保某些东西是不变的可以在一定程度上缓解这个问题，实际上可以防止一整类错误。

最后，`map`让许多人想起它在各种（纯）函数式语言中的真正函数式对应物。传递给它一个带有副作用的“函数”会让那些人感到困惑。因此，作为替代方案（即使用显式循环）并不比调用 更难实现`map`，强烈建议将使用限制`map`在要应用的函数不会引起副作用的情况下。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T20:00:38.187

你可以像这样使用 map 来编写它：

```
map(cls.my_func, items) 
```

将 cls 替换为您正在迭代的项目的类。

正如 Stephan202 所提到的，在这种情况下**不建议**这样做。

通常，如果您想通过对列表中的每个项目应用某些函数来创建新列表，请使用 map。这意味着该函数没有副作用，因此您可以（可能）并行运行地图。

如果您不想创建新列表，或者该函数有副作用，请使用 for 循环。在您的示例中就是这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T20:18:55.837

存在细微的语义差异，这可能在 python 语言规范中是封闭的。该*地图*是明确可并行的，而*仅*在特殊情况下。代码可以从*for中**跳出*，但只能从*map*中跳出异常。

 **在我看来， *map*不应该同时保证函数应用*的*顺序。AFAIK 目前没有 python 实现能够执行此自动并行化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T21:53:43.283

如果需要，您可以将 Your 切换`map`到一些很酷的线程或多处理或分布式计算框架。[Disco](http://discoproject.org/)是基于 erlang-and-python 的分布式、抗故障框架的示例。我将它配置在 2 个 8 核的盒子上，现在我的程序运行速度快了 16 倍，这要归功于 Disco 集群，但是我不得不从列表推导和 for 循环重写我的程序以映射/减少。

使用 for 循环和列表推导以及 map/reduce 编写程序是一样的，但是当您需要它在集群上运行时，如果您使用 map/reduce，您几乎可以免费完成。如果你没有，那么，你将不得不重写。

当心：据我所知，python 2.x 从 map 返回一个列表而不是迭代器。我听说这可以通过使用`iter.imap()`（虽然从未使用过）来绕过。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T12:57:04.780

当您不需要返回结果列表（例如具有副作用的函数）时，请使用显式 for 循环。

当您确实需要返回结果列表时（例如，直接根据输入返回值的函数），请使用列表推导式。

当你试图让 Lisp 用户相信 Python 值得使用时，请使用 map()。;)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T19:53:35.110

的主要优点`map`是当您想要获取列表中每个元素的某些计算结果时。例如，此代码段将列表中的每个值加倍：

```
map(lambda x: x * 2, [1,2,3,4])  #=> [2, 4, 6, 8] 
```

重要的是要注意`map`返回一个带有结果的新列表。它不会修改原始列表。

要对 执行相同的操作`for`，您必须创建一个空列表并在正文中添加额外的一行，`for`以将每个计算的结果添加到新列表中。该`map`版本更加简洁和实用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T22:02:03.713

对于内置函数，Map 有时比手动编写 for 循环更快。尝试时序图（str，范围（1000000））与类似的for循环。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-17T19:48:14.170

```
map(lambda item: item.my_func(), items) 
```

# asp.net-mvc - ASP.net mvc 页脚常用数据

> ID：875343
> 
> 赞同：4
> 
> 时间：2009-05-17T19:48:50.660
> 
> 标签：asp.net-mvc, viewdata

所以，我有一个页脚，它将出现在我的 Web 应用程序的每个页面上

我需要它来呈现动态数据......这意味着每个控制器动作都需要返回包含此数据的 viewData ......以及特定于动作的数据

你们将如何实现这一点？也许是基本控制器的构造函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T20:05:29.797

您在基本控制器的想法上走在了正确的轨道上，但我会覆盖 OnActionExecuted 并在那里生成数据。在生成公共数据之前检查结果是否将是 ViewResult。如果结果是重定向或通过 AJAX 返回的数据，则无需生成数据。

您还可以考虑为公共数据创建一个仅查看模型（如果数据很广泛）并将其作为一个整体放入 ViewData。然后，您可以创建一个强类型的局部视图，该视图采用模型并在视图中更轻松地使用模型的属性。从母版页呈现这个部分视图可以很容易地合并每个页面上的数据并以强类型的方式使用它。

如果页脚数据或格式不复杂，那么将标记放在母版页中可能会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T21:12:38.310

您可以创建一个`ActionFilter`将数据写入 ViewData 的方法，如下所示：

```
public class CustomActionFilter : ActionFilterAttribute
{
    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        filterContext.Controller.ViewData["WillNeedThis"] = "Foo";
    }
} 
```

然后装饰你的控制器和/或需要这些数据的动作：

```
[CustomActionFilter]
public class HomeController : Controller {
   ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T19:53:01.617

您可以将数据传递到母版页并在那里显示页脚：

[在 ASP.NET MVC 中将数据传递到母版页](https://stackoverflow.com/questions/78548/passing-data-to-master-page-in-asp-net-mvc)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T16:04:02.093

使用[MVC Futures](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)程序集中的 Html.RenderAction() 方法怎么样？

**-- 站点.master --**

```
 <div id="footer">
        <% Html.RenderAction("SomeAction", "SomeController",
               new { someParam = ViewData["someValue"] }); %>
  </div> 
```

有些人可能会争辩说，这混淆了 View 和 Controller 分离的水域，我可能不会在 ViewPage 中这样做，但我认为它是 MasterViewPage 中的一个不错的替代方案。

**火焰开启** ;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T19:59:23.320

如果数据不复杂，我使用 ViewData 字典来存储这些信息。如果是，我将页脚数据放在所有模型的基类中，然后将页脚移动到 ContentPlaceholder。这有点烦人，因为您必须将它放在每个视图页面上。

# sql - 如果使用的连接字符串是 .mdf 文件的路径，您是否必须在计算机上安装 SQL Server？

> ID：875345
> 
> 赞同：1
> 
> 时间：2009-05-17T19:49:29.080
> 
> 标签：sql, linq, mdf

我想知道您是否可以在未安装 SQL Server 实例的机器上使用 .mdf 文件使用 Linq to SQL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T19:53:28.760

您必须将数据库附加到某个 Sql 服务器实例。您可能希望在同一台机器上执行此操作，否则在写入数据库时​​会增加网络延迟（在某些情况下可能会很极端）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T20:00:10.353

不，您需要将文件附加到某个 MSSQL 实例。您可以使用 MsSQL Express 来完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T20:03:15.917

如果 SQL Server 的成本是一个问题，您可能可以使用 SQL Server Express。免费。2008 版的下载地址在[此处](http://www.microsoft.com/express/sql/register/)。或者您可以在[此处](http://www.microsoft.com/Sqlserver/2005/en/us/express-down.aspx)使用 2005 版本。

# c# - 底层连接已关闭：接收时发生意外错误

> ID：875348
> 
> 赞同：4
> 
> 时间：2009-05-17T19:52:12.023
> 
> 标签：c#, windows-server-2008, windows-server-2003, webclient

当我在我的 win2k8 机器上尝试我的程序时，它运行良好，但在 win 2k3 上，它给了我这个错误消息

这是产生错误的代码

```
WebClient wc = new WebClient(); 
wc.DownloadFile("ftp://ftp.website.com/sample.zip"); 
```

这是奇怪的部分。如果我完全禁用服务器上的防火墙。错误消失了。但如果我将程序添加到例外列表并打开防火墙，它仍然会出错。

在网上搜索了几天，找不到任何解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T21:00:12.397

您应该尝试对 FTP 使用被动模式。WebClient 类不允许这样做，但 FtpWebRequest 允许。

```
FtpWebRequest request = WebRequest.Create("ftp://ftp.website.com/sample.zip") as FtpWebRequest;
request.UsePassive = true;
FtpWebResponse response = request.GetResponse() as FtpWebResponse;
Stream ftpStream = response.GetResponse();
int bufferSize = 8192;
byte[] buffer = new byte[bufferSize];
using (FileStream fileStream = new FileStream("localfile.zip", FileMode.Create, FileAccess.Write))
{
    int nBytes;
    while((nBytes = ftpStream.Read(buffer, 0, bufferSize) > 0)
    {
        fileStream.Write(buffer, 0, nBytes);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:17:10.470

请发布完整的异常，包括任何 InnerException：

```
try
{
    WebClient wc = new WebClient(); 
    wc.DownloadFile("ftp://ftp.website.com/sample.zip");
}
catch (Exception ex)
{
    Console.WriteLine(ex.ToString()); // Or Debug.Trace, or whatever
    throw;    // As if the catch were not present
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-06T15:00:03.460

我有一个类似的问题（没有 ftp）和不同的解决方案

生产服务器环境已变得非常安全，以至于服务器无法访问 URL。

快速测试是在盒子上使用浏览器，看看是否可以导航到 url。

希望这可以帮助某人。

# c# - 在 C# 中存储读者信息

> ID：875355
> 
> 赞同：1
> 
> 时间：2009-05-17T19:54:45.327
> 
> 标签：c#, .net, mysql, database

我知道我的要求对于 C# 专家可能没有多大意义，但我会解释我想要做什么，然后如果你愿意，你可以建议我如何以更好的方式做到这一点？

我有一个名为 DatabaseManager 的 C# 类，它处理不同的 MySQL 查询（ado.net NET 连接器，而不是 linq 或任何类型的 ActiveRecord-ish 库）。

我正在做类似的事情

```
categories = db_manager.getCategories(); 
```

类别列表非常小（10 项），所以我想知道在没有大量附加代码的情况下访问检索到的信息的最佳方式是什么。

现在我正在使用 Struct 来存储信息，但我确信有更好的方法来做到这一点。

这是我的代码：

```
 public struct Category
    {
        public string name;
    }
    internal ArrayList getCategories()
    {
        ArrayList categories = new ArrayList();

        MySqlDataReader reader;
        Category category_info;

        try
        {
            conn.Open();
            reader = category_query.ExecuteReader();
            while (reader.Read())
            {
                category_info = new Category();
                category_info.name = reader["name"].ToString();
                categories.Add(category_info);
            }
            reader.Close();
            conn.Close();
        }
        catch (MySqlException e)
        {
            Console.WriteLine("ERROR " + e.ToString());
        }

        return categories;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T20:01:38.230

例子：

```
public IEnumerable<Category> GetCategories()
{
    using (var connection = new MySqlConnection("CONNECTION STRING"))
    using (var command = new MySqlCommand("SELECT name FROM categories", connection))
    {
        connection.Open();
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                yield return new Category { name = reader.GetString(0) };
            }
        }
    }
} 
```

评论：

1.  让 ADO.NET 连接池为您做正确的工作（避免将连接存储在静态字段等...）
2.  始终确保正确处置非托管资源（在 C# 中使用“使用”）
3.  始终从您的公共方法（在本例中为 IEnumerable<Category>）返回层次结构中的最低接口。
4.  让调用者处理异常和日志记录。这些是横切关注点，不应与您的数据库访问代码混合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:58:15.383

我要做的第一件事是用 List 替换您对 ArrayList 的使用，这将为您使用类别列表提供编译时类型检查（因此在您的代码中使用它时您不必进行类型转换）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T20:02:04.437

以这样的方式退回它们并没有错。但是，有几件事很突出：

*   您的 catch 块记录错误，但随后返回空数组或部分填充的数组。这可能不是一个好主意
*   如果在 try 块中抛出异常，您将不会关闭连接或处置阅读器。考虑 using() 语句。
*   您应该使用泛型类型 (List<>) 而不是 ArrayList。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-17T20:00:27.950

从你的代码我猜你正在使用.NET 1.1，因为你没有使用泛型的力量。

1) 使用仅包含字符串的结构是一种矫枉过正。只需创建一个字符串数组列表（或使用泛型 List ）

2）当您的尝试块中发生异常时，您将连接和阅读器保持打开状态...改用它：

```
try 
{
   conn.open();
   //more code
}
catch (MySqlException e) { // code
}
finally {
   conn.close()
   if (reader != null)
      reader.close();
} 
```

# javascript - 如何检测 JavaScript 输入的多字节字符结束？

> ID：875374
> 
> 赞同：0
> 
> 时间：2009-05-17T20:04:30.487
> 
> 标签：javascript, multibyte

目前，我听`Enter`钥匙开始发送消息。

但是对于多字节字符，`Enter`键应该选择某个字符。

问题是我不知道如何检测用户是否正在输入多字节字符，即使他在这个过程中，消息也会在他第一次`Enter`按键时发送。

所以用户体验真的很奇怪。

有人对此有解决方案吗？

如果您不明白我的意思，可以尝试在这里聊天，一旦您开始对话，切换到多字节模式，您就会明白我的意思。

链接在这里：

[http://maishudi.com/OMegle.php](http://maishudi.com/OMegle.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T13:33:25.517

我假设您对多字节输入的引用是对“输入法”（或 Windows 上的“输入法编辑器”）的引用。

不幸的是，目前还没有任何真正的解决方案——DOM3 将为此添加机制，但由于复杂性，它似乎已经放弃了这一点。

在您考虑浏览器之间的行为差​​异之前，部分复杂性来自各个输入法的截然不同的行为。一个很好的例子是只检查你收到的关于日语、韩语和（繁体和简体）中文的一组行为的关键事件。浏览器无法避免这种情况，因为它们正在响应输入编辑器直接触发的事件。

您真正可以依赖的唯一东西是`keyDown`事件，即使在 Opera 和 Firefox 中也没有那么多 - Safari 和 IE 都`keyDown`在 IME 组合期间提供事件，a`charCode`为 229，以及`keyUp`一个`charCode`对应于实际密钥的事件按下。

有一个`textInput`事件，但只有 Safari 支持（代理 Chrome 也应该支持它），但无论如何它并不比标准事件好：-/

# math - floor(sqrt(floor(x))) 中哪一层是多余的？

> ID：875377
> 
> 赞同：14
> 
> 时间：2009-05-17T20:06:57.923
> 
> 标签：math, floor

我有`floor(sqrt(floor(x)))`。这是真的：

1.  内部`floor`是多余的。
2.  外部`floor`是多余的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-17T20:39:32.260

显然外层不是多余的，因为例如`sqrt(2)`不是整数，因此`floor(sqrt(2))≠sqrt(2)`.

`sqrt(floor(x))≠sqrt(x)`对于非整数也很容易看出这一点`x`。因为`sqrt`是单调函数。

我们需要找出是否`floor(sqrt(floor(x)))==floor(sqrt(x))`适用于所有有理数（或实数）。

让我们证明如果`sqrt(n)<m`那么`sqrt(n+1)<m+1`，对于整数`m,n`。很容易看出

```
n<m^2 ⇒ n+1 < m^2+1 < m^2+2m+1 = (m+1)^2 
```

因此，由于`sqrt`是 montone，我们有

```
sqrt(n) < m -> sqrt(n+1) < m+1 -> sqrt(n+eps)<m+1 for 0<=eps<1 
```

因此`floor(sqrt(n))=floor(sqrt(n+eps))`对于 all`0<eps<1`和 integer `n`。否则假设`floor(sqrt(n))=m`and `floor(sqrt(n+eps))=m+1`，并且你有一个案例 where`sqrt(n)<m+1`然而`sqrt(n+eps)>=m+1`。

因此，假设`floor`需要外部，内部`floor`是多余的。

换句话说，它总是正确的

```
floor(sqrt(n)) == floor(sqrt(floor(n))) 
```

内在`ceil`呢？

很容易看出这一点`floor(sqrt(n)) ≠ floor(sqrt(ceil(n)))`。例如

```
floor(sqrt(0.001))=0, while floor(sqrt(1))=1 
```

但是你可以用类似的方式证明

```
ceil(sqrt(n)) == ceil(sqrt(ceil(n))) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-17T20:40:29.887

内层是多余的，外层当然不是。

外面的不是多余的，因为如果 x 是平方数，数字 x 的平方根只会产生整数。

内部是多余的，因为区间 [x,x+1[ （其中 x 是整数）中的任何数字的平方根始终位于区间 [floor(sqrt(x)),ceil(sqrt(x) )[ 因此，如果您只对结果的整数部分感兴趣，则无需在取其平方根之前对数字求底。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T20:14:00.683

直觉上我相信内在的是多余的，但我无法证明这一点。

除非你能提供一个证明我错的 x 值，否则你不能投票给我。8-)

**编辑：**请参阅 v3 对此答案的评论以获取证据 - 谢谢，v3！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-17T20:09:29.057

内层是多余的

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-17T20:40:14.847

内层是多余的。反证法：

假设内层不是多余的。这将意味着：

```
floor(sqrt(x)) != floor(sqrt(x+d)) 
```

对于某些 x 和 d，其中 floor(x) = floor(x+d)。然后我们要考虑三个数字：a = sqrt(x)，b = floor(sqrt(x+d))，c = sqrt(x+d)。b 是一个整数，a < b < c。这意味着 a^2 < b^2 < c^2，或 x < b^2 < x+d。但是如果 b 是一个整数，那么 b^2 是一个整数。因此 floor(x) < b^2，b^2 <= floor(x+d)，然后 floor(x) < floor(x+d)。但我们首先假设 floor(x) = floor(x+d)。我们遇到了矛盾，所以我们的假设是错误的，内层是多余的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-17T20:12:18.067

如果 x 是整数，则内层是多余的。

如果 x 不是整数，则两者都不是多余的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-17T20:19:26.427

外层不是多余的。反例：x = 2。

地板(sqrt(地板(2))) = 地板(sqrt(2)) = 地板(1.41...)

如果没有外层，结果将是 1.41...

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-17T20:53:54.160

如果内层不是多余的，那么我们会期望 floor(sqrt(n)) != floor(sqrt(m))，其中 m = floor(n)

请注意，n - 1 < m <= n。m 总是小于或等于 n

floor(sqrt(n)) != floor(sqrt(m)) 要求 sqrt(n) 和 sqrt(m) 的值至少相差 1.0

但是，没有任何值 n 的 sqrt(n) 与 sqrt(n + 1) 相差至少 1.0，因为对于 0 和 1 之间的所有值，该值的 sqrt 根据定义小于 1。

因此，对于所有值 n，floor(sqrt(n)) == floor(sqrt(n + 1))。这与最初的假设相矛盾。

因此内层是多余的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-04T15:28:01.287

如果`n^2 <= x < (n+1)^2`where`n`是一个整数，那么

1.  `n <= sqrt(x) < n+1`, 所以`floor(sqrt(x)) = n`;
2.  `n^2 <= floor(x) < (n+1)^2`，如此`n <= sqrt(floor(x)) < n+1`，如此`floor(sqrt(floor(x))) = n`。

因此，`floor(sqrt(floor(x))) = floor(sqrt(x))`，这意味着**内层**是多余的。

# php - 如何区分页面刷新和关闭页面

> ID：875380
> 
> 赞同：4
> 
> 时间：2009-05-17T20:09:07.013
> 
> 标签：php, javascript

我有一个网络应用游戏，在游戏中我想拥有它，所以如果用户关闭页面或他们的浏览器，它会自动将他们注销。我尝试使用附加到窗口的 onbeforeunload 事件：

```
window.onbeforeunload = function() {
    // perform logout functions here
} 
```

问题是，如果用户刷新页面，它也会触发。有没有一种方法可以检测用户是完全关闭整个页面，还是只是刷新它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T20:12:11.343

没有可检测到的差异。要自动注销用户，您应该在存储登录或会话信息的 cookie 上设置过期时间。因此，如果您将其设置为 1 小时，则用户将在该时间之后基本上被注销，因为 cookie 将被销毁。如果您想在他们仍在与站点交互时推迟此自动注销，您可以在他们每次执行某种操作（单击链接、激活 AJAX 调用等）时重置 cookie 的过期时间。这意味着他们将在 1 小时不活动后注销，而不是在登录后仅 1 小时，这听起来更像你想要的。

如果您将 cookie 的过期时间设置为 0，那么它将在会话结束后过期。这通常发生在用户完全退出浏览器时。这也是另一种选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T20:33:22.820

如前所述，你不能。更糟糕的是，这个事件已经被很多浏览器放弃了，可能是因为它被恶意脚本滥用，做pop-under之类的。

一种可能的解决方法是让 Ajax 脚本“打电话回家”：如果它静默一段时间，用户就放弃了站点（关闭页面或浏览器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T21:28:21.440

让 onunload 事件向服务器发送一个请求，这将导致会话在 n 秒内过期（其中 n 是页面重新加载请求发生的最长时间，因此可能是 10）。然后让该站点的脚本检查该事件是否已安排，如果是，请取消它。这会给你你想要的行为。

但是，是的，我建议只是让会话过期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:59:11.603

如果我没记错的话 Javascript 应该有一个名为 onWindowClose 的函数，也许可以尝试搜索它？

关于 PHP 解决方案，我不确定是否有任何解决方案，但我建议您快速查看[PHP 连接处理](http://www.php.net/manual/en/features.connection-handling.php)，特别是 connection_aborted() 和 register_shutdown_function() 函数。

# objective-c - Cocoa 为什么我要保留和释放一个函数参数？

> ID：875391
> 
> 赞同：0
> 
> 时间：2009-05-17T20:13:12.103
> 
> 标签：objective-c, cocoa, macos

我正在研究 Aaron Hillegass 的书，特别是彩票示例。我对方法有疑问`-setEntryDate:`；为什么我要保留`date`？该程序在不保留它的情况下仍然有效。

```
 -(void)setEntryDate:(NSCalendarDate *)date {
    [date retain];
    [entryDate release];
    entryDate = date;
} 
```

但这仍然可以正常工作：

```
-(void)setEntryDate:(NSCalendarDate *)date {
    entryDate = date;
} 
```

那么为什么我必须保留`date`然后释放是正确的`entryDate`呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T20:24:01.407

它现在可以工作，但是如果你正在编写一个更大的程序，那么在未来某个不确定的时间点，对象`date`指向的对象可能会被调用`setEntryDate`. 如果发生这种情况，它将在整个程序的其余部分中失效。您将这个对象保留在类中，因为该类现在拥有对该对象的引用并且需要指出这一点。通过这样做，即使调用`setEntryDate`的任何类要释放`date`，您的班级仍将保持对它的有效引用。此外，这不仅仅是您正在编写的常规旧方法。这是一个 setter，它的具体职责是在它所属的类上设置一个实例变量。如果您正在编写非 setter 方法，则可能不必保留参数。我想说的是，保留方法参数并不总是必要的。它只是在这种情况下（几乎所有处理非原始类型的设置器）。

[这称为“引用计数”，在此处](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)进行了详细说明。现在，因为你才刚刚开始学习，所以不要担心阅读。当您开始使用内存管理进入更复杂的场景时，该指南是非常有价值的阅读材料。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T20:25:22.543

因为您声称拥有该对象的所有权，并且`retain`您就是这样做的。不正确的代码有时会发生正确的工作，但这本质上只是运气。

请参阅[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T20:35:25.437

诸如此类的方法称为*访问器方法*。顾名思义，它们允许检索和设置变量——具体来说，它们被称为“getter”和“setter”。

约定（然而，您将在本书后面的章节中看到，这不仅仅是约定）是为变量调用“getter”，例如，被`NSString`调用的`foo`

```
- (NSString*)foo; 
```

而“二传手”：

```
- (void)setFoo:(NSString*)newFoo; 
```

在上面的示例中，实现了该方法来设置新的日期值。内存管理在第 4 章中进行了描述，但简而言之，Objective-C 对象的工作方式是它们具有“保留计数”——它表示对象具有的引用数量；分配时，对象的保留计数为 1。然后可以向对象发送`retain`或`release`消息以分别增加或减少保留计数。消息意味着发送消息的`retain`对象想要使用该对象，所以`retain`就这样。消息意味着发送消息的`release`对象不再想使用该对象，因此减少了保留计数。当对象的保留计数达到 0 时，该对象被释放。这样就避免了内存泄漏。

`date`保留和`entryDate`释放的原因，是`date`你想“了解”的新对象；因此，您通过`retain`ing 来声明对它的所有权。该`entryDate`变量指向当前日期对象，但由于您将其设置为新值，因此您不再需要了解它；因此你`release`它；这可以防止内存泄漏，因为您最初将保留此变量。

正如我之前所说，一旦阅读*第 4 章：内存管理*，这个概念就会变得更加清晰。现在，只要接受它并在解释时理解其背后的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T22:13:04.547

If you learn by videos better, Stanford University has [published](https://podcasts.apple.com/us/podcast/iphone-application-programming-spring-2009/id384233222) some videos on the iPhone development which also cover Cocoa and Objective-C to a certain extent. Check out lecture 3, it makes a good overview on memory management, with examples and discussion.

# .net - 无需处理的 XML 序列化

> ID：875398
> 
> 赞同：7
> 
> 时间：2009-05-17T20:15:32.613
> 
> 标签：.net, xml-serialization, idisposable

```
 using (var file_stream = File.Create("users.xml"))
        {
            var serializer = new XmlSerializer(typeof(PasswordManager));
            serializer.Serialize(file_stream, this);
            file_stream.Close();
        } 
```

使用上面的代码可以完美地工作。但是，当我将其缩短为：

```
 var serializer = new XmlSerializer(typeof(PasswordManager));
          serializer.Serialize(File.Create("users.xml"), this); 
```

当我尝试在同一个测试中反序列化 users.xml 文件时出现以下异常：该进程无法访问文件“users.xml”，因为它正在被另一个进程使用。

原因似乎是 File.Create 方法返回一个打开的 FileStream，我无法关闭它，因为我没有保留它的引用。

我的坏，还是微软的？;-)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T20:20:21.433

问题是，在您的第二个示例中，您打开了一个从未处理过的文件句柄，因此第二次调用您的方法时，它将抛出您描述的异常。第一个片段是更可取的方式（您可以删除 file_stream.Close() 位 - Stream.Dispose() 将自动调用它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-29T07:53:18.730

您应该在**try finally**块中进行序列化，以便确保无论成功还是失败，文件都已关闭/处置。这就是**using**关键字为您所做的。

```
var serializer = new XmlSerializer(typeof(PasswordManager));
var fs = File.Create("users.xml");
try { serializer.Serialize(fs,this); }
finally { fs.Close(); } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T22:10:55.297

如果您没有“使用”语句，但保留了关闭，那么您就可以了。

*[编辑：添加尝试......最后，谢谢奶酪]*

```
var serializer = new XmlSerializer(typeof(PasswordManager));
FileStream fs;
try
{
    fs = File.Create("users.xml");
    serializer.Serialize(fs, this);
}
finally
{
    fs.Close(); // or fs.Dispose()
} 
```

但是，在这种情况下，Dispose 更可取，因为它知道清理必须采取的*所有操作，包括关闭（以及任何其他操作）。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-29T23:28:45.330

File.Create 应该放在 try 块之外，如我之前的回答所示。如果将其放在 try 块中，则需要在关闭之前检查**fs**是否有空引用。以下显示了更正后的代码，但我的第一个答案要好得多，因为您可以避免此检查。

```
serializer = new XmlSerializer(typeof(PasswordManager));
FileStream fs;
try
{
    fs = File.Create("users.xml");
    serializer.Serialize(fs, this);
}
finally
{
    if (fs != null)  // in case File.Create fails
        fs.Close(); // or fs.Dispose()
} 
```

# ruby-on-rails - rails：如何不在模型中包含一些数据库属性

> ID：875410
> 
> 赞同：0
> 
> 时间：2009-05-17T20:20:47.530
> 
> 标签：ruby-on-rails, cookies

我的数据库表有一列可以包含大量数据。我不希望这些数据成为相应 rails 对象（模型）的一部分。

如何在模型中告知我不想将此字段存储在内存中？

最初，这是因为我有一个大于 4k 的会话，并且 rails 引发了 ActionController::Session::CookieStore::CookieOverflow 异常。

谢谢你的帮助，米凯尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T20:50:13.093

加载模型时，您可以显式设置要选择的列并跳过大列：

```
MyModel.find(id, :select => 'column1, column2, column3') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T20:52:55.253

您必须通过 find-option 明确指定列`:select`。但是，不鼓励在会话中存储模型。仅在会话中存储对象 ID 并将模型对象本身保存在 中`Rails.cache`怎么样？

# include - PHP：运行 phing 时只包含文件？

> ID：875415
> 
> 赞同：0
> 
> 时间：2009-05-17T20:24:05.870
> 
> 标签：include, xdebug, phing

我有以下文件夹结构：

```
/main
    /loader.php
    /build.xml
    /components
        /package1
            /class1.php
        /package2
            /class2.php
    /tests
        /package1
            /class1.test.php
        /package2
            /class2.test.php 
```

当我运行 Web 应用程序时，我`loader.php`首先加载并通过调用`Loader::load( 'package_name' )`. 然后包括所有必要的文件。这里的好处是我不需要包含`loader.php`在类文件中，因为我可以依赖`Loader`.

单元测试类通过显式包含所有必要的类来模拟这种行为。所以 phing 和 PHPUnit 也没有问题。

但现在我想用 phing 和 Xdebug 生成一个覆盖率报告。这里的问题是 phing 似乎加载了每个 PHP 文件来创建覆盖数据库。不幸的是，它停止了，因为它找不到`Loader`PHP 文件中使用的类。

我可以轻松地`include`向每个类文件添加一条语句，但我想知道是否只有在代码覆盖率分析正在检查文件时才包含文件？

其他想法：我还可以通过扫描单元测试目录并因此找到所有必需的包含的方式来配置覆盖率分析。然后我需要过滤与类似模式匹配的类`/Test$/i`。可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-07T07:40:40.233

我找了很长时间来寻找类似的东西。

最后，我完成了以下更改。基本上，您告诉 php cli 预先添加一个包含您的加载逻辑的 php 文件。

在我的 cli 的 php.ini 中，我设置了以下内容：

auto_prepend_file = autoload.php

我确保该文件位于我的包含路径（在我的情况下为 /usr/share/php）并在其中放入以下行（我使用 Zend Framework，它也在我的包含路径中）：

require_once "Zend/Loader/Autoloader.php"; $autoloader = Zend_Loader_Autoloader::getInstance(); $autoloader->registerNamespace('Model_');

现在，您可以做的是定义您的 __autoload 函数并定义需要自动加载的内容，但您明白了。

这是一个丑陋的黑客，但它为我完成了一些事情。

杰罗恩

# sql - 在 sql 查询中使用 charindex

> ID：875416
> 
> 赞同：1
> 
> 时间：2009-05-17T20:24:17.007
> 
> 标签：sql

我有一个名为 itemIDs 的字符串，由逗号 (12,43,34,..) 分隔，为了将其用作参数，我需要将其转换为 int，因为 db 中的 itemID 是 int 格式。

这是我写的，但我收到一条错误消息`Incorrect syntax near the keyword 'as'.`

```
using (SqlCommand searchResult = new SqlCommand("SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE (itemID = cast(charindex(',',(@itemIDs as int))))", searchCon)) 
```

我想不通，这似乎是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T20:34:38.683

您从哪里获得 itemID？如果它是您在数学上生成的字符串，并且不是来自外部来源，您可以使用：

```
... "SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE itemID IN (" + itemIDs + ")" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T20:35:36.513

我会在这里为您的 WHERE 子句建议一种不同的方法。您可以使用 IN 来指定您的列表。

```
using (SqlCommand searchResult = new SqlCommand("
SELECT ItemID, Name, RelDate, Price, Status 
FROM item_k 
WHERE itemID IN (" + itemIDs + ")" 
```

这对应于这样的 SQL：

```
SELECT ItemID, Name, RelDate, Price, Status 
FROM item_k 
WHERE itemID IN (12,43,34) 
```

# c# - 在 C# 中的 .NET Compact Framework 中旋转图像的快速方法

> ID：875419
> 
> 赞同：0
> 
> 时间：2009-05-17T20:26:40.590
> 
> 标签：c#, graphics, windows-mobile, compact-framework

在 .NET Compact Framework 中是否有一种快速旋转图像的方法。

我找到了进行 90、180,270 次旋转的方法，但希望能够以相似的速度自由旋转图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T20:51:54.587

90 度、180 度或 270 度旋转根本不需要计算，只需移动一些数据。另一方面，自由角度旋转需要大量计算。所以这永远不会像直角旋转一样快......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-10T23:44:44.890

您可以使用 OpenNetCF 的 ImageUtil 类来执行此操作（这是您正在寻找的“旋转”方法）。该方法将位图和（浮动）角度作为参数。在这里找到规格：

[http://www.opennetcf.com/library/sdf/html/eb32a9ba-c1dc-7194-bd31-a5d035790a45.htm](http://www.opennetcf.com/library/sdf/html/eb32a9ba-c1dc-7194-bd31-a5d035790a45.htm)

# streaming - 如何无缝连接 MP3 流？

> ID：875421
> 
> 赞同：5
> 
> 时间：2009-05-17T20:26:50.310
> 
> 标签：streaming, mp3, lossless

我正在开发一个能够播放有针对性的广告的流媒体服务器。基本上听众会听到相同的音乐，但是每隔 30 分钟就会出现一个广告块，每个听众都有自己的广告块。实现这样的流媒体服务器会带来各种问题，这个问题就是其中之一。

服务器将以类似于 Icecast 的方式工作，即它将通过网络从某个流生成器读取流并将其中继到每个侦听器。当广播广告的时候，服务器停止从生成器获取流，从文件中读取广告并将它们插入每个侦听器的缓冲区，传输它们并继续从生成器中继流。

当服务器从中继流切换到广播广告时，它必须连接两个 MP3 流（我们在 MP3 中广播）。我担心的是，简单地将一个数据一个接一个地附加可能会产生一些听得见的伪影。可以无缝完成吗？

我已经想通了： - 我可以让服务器知道 MP3 帧以避免同步错误。- 我正在考虑在流中的 MP3 帧之后附加广告文件中的 MP3 帧。- 由于广告是从正确编码的 MP3 文件加载的，我绕过了字节库的问题，因为文件的第一帧不能使用它。

但我担心的是 MDCT 的工作方式。听众不知道我的服务器会做什么，因此他们的 MP3 解码器可能会产生一些伪影，因为不正确的 MDCT 数据将一个接一个地放置在他们下载的流中。带有广告的文件开头的零填充会对此进行补偿吗？

您是否知道任何可以无缝连接两个 MP3 文件而无需解压缩的库/工具（如果可能的话是开源的）？

你能指出任何描述 MP3 格式的好资源吗？我在互联网上搜索了很多，找到了很多信息，但我仍然错过了整体情况。

也许您知道如果我使用其他编解码器（如 OGG/Vorbis、AAC）会更容易？

PS。这个问题[与合并 mp3 文件的最佳方法是什么？](http://stackoverflow.com:80/questions/62618/what-is-the-best-way-to-merge-mp3-files). mp3wrap 和类似的工具对我来说不是一个选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-03T17:04:26.207

您应该能够连接 CBR 和 VBR 格式的 mp3 文件。MP3 文件没有主标题（忽略 ID3 和 Xing）。音频数据存储为块，其中每个块都包含自己的标头。标头包含解码该块中的音频数据所需的信息（比特率、采样频率、立体声等）。

这就是为什么很难确定一个 mp3 文件的时长的原因之一。

另一种看待它的方式是，如果将 CBR MP3 文件与 VBR 文件连接起来，则最终结果与具有恒定比特率的音频第一部分的长 VBR 文件相同。

问题是某些 MP3 播放器可能很严格，并且需要 VBR MP3 文件的 Xing 标头。然而，这从来都不是 MP3 格式的规范，但现在假定它是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T20:37:24.683

我相信 MP3 可以通过简单地连接文件来合并。在一些快速测试 ( `cat file1.mp3 file2.mp3 > merged.mp3; mplayer merged.mp3`) 中，它似乎按预期工作。从 Web 服务器流式传输可能也可以正常工作。

你将如何处理切换当前输入文件？您可以简单地将广告视为要播放的短曲目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T20:37:20.737

如果您使用的是 Windows，Microsoft [DirectShow](http://msdn.microsoft.com/en-us/library/ms783323.aspx) API 可能是您的首选。您应该会发现它能够以各种格式处理静态和流式音频和视频（您只需要必要的编解码器，并且界面几乎对所有人都相同）。

话虽如此，但不幸的是，DirectShow 的设计非常复杂，学习曲线陡峭，但如果您要在 Windows 上进行音频/视频操作，它提供的功能无与伦比。然而，有大量关于如何使用它的示例和教程，所以最终可能不会那么痛苦。此外，如果您使用的是 .NET Framework，则有一个名为[DirectShow.NET](http://directshownet.sourceforge.net/)的托管包装。无论你做什么，这都不是一件容易的事，除非那里有我不知道的东西。无论如何，祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T20:54:40.400

我遇到了一个非常相似的问题，在向各种来源提出了正确的问题后，我提出了以下问题......

任何有价值的解码器都会跳过“坏”数据，直到它到达有效的帧头。这就是 ID3v2 将附加信息注入 mp3 数据所依赖的。在服务器上，我会分析源 MP3 文件以仅提供有效的 MP3 帧。如果您提供一些无声帧（大约 7 个应该这样做），解码器应该有时间在加速下一次加载（未关联的）MP3 数据之前稳定下来，避免在连接来自不同编码的帧时（正确地）假设的伪影会议。

更成问题的是 MP3 属性（1/2 通道、输出采样率等）可能在一帧到下一帧之间切换。一些解码器在遇到这样的流时会非常沮丧，导致播放速度为 1/2 等。因此，您需要确保将所有源材料编码为相同的输出属性，否则您可能会陷入困境。

您可能已经看过了，但如果没有：

[http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=79&printer=t](http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=79&printer=t)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-17T20:56:45.200

我不明白你为什么要连接文件。您为什么不使用某种播放列表系统，只需更改您发送的文件。我认为从长远来看，这将提供更大的灵活性，并且您最终不会得到大型 MP3 文件。

# c - 这个多线程程序是否比非多线程程序执行得更好？

> ID：875437
> 
> 赞同：1
> 
> 时间：2009-05-17T20:37:03.793
> 
> 标签：c, multithreading, unix

我的一个同事让我给他写作业。虽然这样做不太合乎道德，但我还是认罪了。问题是这样的：用 C 语言编写一个程序，计算序列 1 ² + 2 ² + ... + n ²。假设 n 是 p 的倍数，p 是线程数。这是我写的：

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

#define SQR(X) ((X) * (X))

int n, p = 10, total_sum = 0;

pthread_mutex_t mtx = PTHREAD_MUTEX_INITIALIZER;
/* Function prototype */
void *do_calc(void *arg);

int main(int argc, char** argv)
{
    int i;
    pthread_t *thread_array;
    printf("Type number n: ");
    fscanf(stdin, "%d", &n);

    if (n % p != 0 ) {
        fprintf(stderr, "Number must be multiple of 10 (number of threads)\n");
        exit(-1);
    }

    thread_array = (pthread_t *) malloc(p * sizeof(pthread_t));
    for (i = 0; i < p; i++)
        pthread_create(&thread_array[i], NULL, do_calc, (void *) i);
    for (i = 0; i < p; i++)
        pthread_join(thread_array[i], NULL);

    printf("Total sum: %d\n", total_sum);
    pthread_exit(NULL);
}

void *do_calc(void *arg)
{
    int i, local_sum = 0;
    int thr = (int) arg;
    pthread_mutex_lock(&mtx);
    for (i = thr * (n / p); i < ((thr + 1) * (n / p)); i++)
    local_sum += SQR(i + 1);
    total_sum += local_sum;
    pthread_mutex_unlock(&mtx);
    pthread_exit(NULL);
} 
```

除了逻辑/句法的观点，我想知道：

2.  相应的非多线程程序将如何执行
3.  我如何测试/查看他们的表现
4.  不使用线程的程序是什么

在此先感谢，我期待着阅读您的想法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T20:49:09.787

您在计算之前获取 Mutex。您应该在对局部值求和之前立即执行此操作。

```
pthread_mutex_lock(&mtx);
total_sum += local_sum;
pthread_mutex_unlock(&mtx); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T20:42:38.150

这取决于你有多少 CPU。使用单个 CPU 内核，计算密集型程序永远不会在多线程下运行得更快。

此外，由于您是在持有锁的情况下完成所有工作，因此您最终只会在任何时候运行一个线程，因此无论如何它实际上都是单线程的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T01:14:18.107

不要打扰线程等。事实上，根本不要在循环中做任何添加。只需使用以下公式：

∑(r = 1; n) r^2 = 1/6 * n (n + 1)(2 n + 1) [1]

[1] [http://thesaurus.maths.org/mmkb/entry.html?action=entryById&id=1539](http://thesaurus.maths.org/mmkb/entry.html?action=entryById&id=1539)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T20:43:02.143

由于您的代码在实际计算中由互斥锁序列化，因此它会比非线程版本慢。当然，您可以轻松地为自己进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T20:42:54.623

我会试着看看这些计算需要多少。如果它只是一小部分时间，那么我可能会选择单个进程模型，因为为每个计算生成一个线程本身就会产生一些开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T20:51:24.883

要比较性能，只需记住程序启动时的系统时间，从 n=1000 调用它并在最后查看系统时间。与非线程程序结果进行比较。正如bdonlan所说，非线程会运行得更快

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T20:57:06.023

1) 单线程的性能可能会比这好一点，因为所有的计算都是在一个锁内完成的，锁的开销会增加总时间。最好只在将局部和添加到总和时锁定，或者将局部和存储在数组中并在主线程中计算总和。

2) 在代码中使用时序语句来测量算法期间经过的时间。在多线程情况下，仅测量主线程上的经过时间。

3）源自您的代码：

```
int i, total_sum = 0;
for (i = 0; i < n; i++)
  total_sum += SQR(i + 1); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T22:29:40.887

一个更大的考虑因素是调度。实现内核端线程的最简单方法是让每个线程都获得相同的时间。进程只是拥有自己内存空间的线程。如果所有线程的时间相等，则添加一个线程将花费您从 1/n 的时间到 2/(n + 1) 的时间，这显然更好，因为 > 0 个不是您的其他线程。

不过，实际的实现可能而且确实会有很大差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T01:31:43.180

有点离题，但也许可以通过让每个线程将其结果写入数组元素来避免互斥锁（因此分配“results = calloc（sizeof（int），p）”（顺便说一句，“p”是一个可怕的变量名称保持线程数）和结果[thr] = local_sum），并让加入线程（好吧，main（））对结果进行求和。所以每个线程只负责计算它的总数：只有 main() 协调线程，将它们的数据连接在一起。关注点分离。

对于额外的功劳 (:p)，使用传递给 do_calc() 的 arg 作为传递线程 ID 和将结果写入的位置的一种方式，而不是依赖于全局数组。

# .net - ASP.NET 移动版 2.0

> ID：875443
> 
> 赞同：0
> 
> 时间：2009-05-17T20:39:47.830
> 
> 标签：.net, linq, mobile, asp.net-2.0

我正在尝试发送值 id 以连接 2 个页面。带有评论页面的搜索页面。

这是我得到的错误：

```
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code

    Exception Details:System.NullReferenceException :Object reference not set to an instance of an object

    Source Error:

    Line 101:
    Line 102:        ListComment.DataSource = comm;
    Line 103:        ListComment.DataBind();
    Line 104:
    Line 105:    } 
```

这是我的评论页面代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Comment.aspx.cs" Inherits="Comment"  Debug="true"%>
<%@ Register TagPrefix="mobile" Namespace="System.Web.UI.MobileControls" Assembly="System.Web.Mobile"%>

<html xmlns="http://www.w3.org/1999/xhtml" >
<body>
    <mobile:Form id="Form1" runat="server" BackColor="#fcf9f3" Paginate="True">

        <mobile:Label ID="CommentError" Runat="server" ForeColor="red" 
            Font-Size="Small" Font-Bold="True" Visible="false" />

        <mobile:Label ID="Label2" Runat="server" ForeColor="#d3af63" Font-Italic="True" 
            Font-Name="Monotype Covasia" Font-Bold="True" text="Write Comments" />
        <mobile:Label ID="lblCommentTitle" Runat="server" text="Title" />
        <mobile:TextBox ID="txtCommentTitle" Runat="server" text="" />
        <br />

        <mobile:Label ID="lblCommentText" Runat="server" text="Comment" />
        <mobile:TextBox ID="txtCommentText" Runat="server" text=""/>

        <br />
        <mobile:Command ID="submit" Runat="server" text="Submit" OnClick="submitform_Click" />
        <br />

        <mobile:Label ID="Label1" Runat="server" ForeColor="#d3af63" Font-Italic="True" 
            Font-Name="Monotype Covasia" Font-Bold="True" text="Read Comments"/>
        <mobile:list runat="server" id="ListComment" DataTextfield="comment_text"
             DataValueField="comment_text" Font-Size="Small" Font-Italic="True" 
             ItemsPerPage="5" Wrapping="Wrap"  BreakAfter="True"/>

    </mobile:Form>
</body>
</html>

using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Web;
using System.Web.Mobile;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.MobileControls;
using System.Data.Linq;
using System.Xml.Linq;
using System.Linq;

public partial class Comment : System.Web.UI.MobileControls.MobilePage
{
    CommentDataContext Comments = new CommentDataContext();
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Session["error_msg"] != null)
        {
            CommentError.Text = Session["error_msg"].ToString();
            Session["error_msg"] = null;
            CommentError.Visible = true;
        }

        if (Session["r_id"] != null)
        {
            String r_id = Session["r_id"].ToString();

        }       

        GetComment();
    }

    protected void submitform_Click(object sender, EventArgs e)
    {
        if (Page.IsValid) 
        {
            AddComment();
        }
    }

    #region Inserting a comment
    protected void AddComment()
    {
        mobile_comment mobilecon = new mobile_comment();
        mobilecon.comment_text = txtCommentText.Text;
        mobilecon.comment_title = txtCommentTitle.Text;

        Comments.mobile_comments.InsertOnSubmit(mobilecon);
        Comments.SubmitChanges();

        Session["error_msg"] = "Your comment has been added";
        Response.Redirect("Comment.aspx");
    }
    #endregion

    protected void GetComment()
    {
        var comm = from c in Comments.mobile_comments
                   where c.r_id == Int32.Parse(Session["r_id"].ToString())
                   //where c.r_id == Int32.Parse(Request["r_id"].ToString())
                   select c;

        ListComment.DataSource = comm;
        ListComment.DataBind();

    }
} 
```

我是否正确使用了这个语句 where c.r_id == Int32.Parse(Session["r_id"].ToString())

如果没有那么我如何链接ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-03-13T22:33:23.637

首先，尝试在 move 中调用 GetComment 方法

```
 ...
 if (Session["r_id"] != null)
    {
        String r_id = Session["r_id"].ToString();
        int id = int.Parse(r_id);
        GetComment(id);
    }  
 ...
  protected void GetComment(int id)
{
    var comm = from c in Comments.mobile_comments
               where c.r_id == id
               select c;

    ListComment.DataSource = comm;
    ListComment.DataBind();

} 
```

当您从 url 中的 web-form 传递参数时，例如 mySite/Comments.aspx?r_id=18 那么您必须使用 Request["r_id"] 对象。[关于 Request object](http://www.dotnetspider.com/tutorials/aspnet-tutorial-35.aspx) , [MSDN](http://msdn.microsoft.com/en-us/library/system.web.httprequest%28v=VS.80%29.aspx) 但是当你在提交或其他用户操作上设置 Session["r_id"]=18 时，你必须使用 Session["r_id"] 来获取值。[关于会话](http://msdn.microsoft.com/en-us/library/ms178581.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T20:51:06.163

我不确定这是否是您的问题，但是此代码...

```
if (Session["r_id"] != null)        
{            
  String r_id = Session["r_id"].ToString(); 
} 
```

什么都不做，因为您在 if 块的范围内声明了 r_id 然后什么也不做。因此，当您使用 LINQ 语句对其进行迭代时，您尚未成功确保 Session["r_id"] 不为空。您的意思是将 r_id 传递给 GetComment 以用于与 c.r_id 进行比较，而不是返回会话？

# python - 在 Python 中打印守护线程异常

> ID：875453
> 
> 赞同：9
> 
> 时间：2009-05-17T20:45:28.720
> 
> 标签：python, multithreading

Python 不会打印来自守护线程中引发的异常的回溯消息。

例如，此代码创建一个守护线程并在新线程中引发异常：

```
def error_raiser():
    raise Exception

import threading
thread = threading.Thread(target=error_raiser)
thread.daemon = True
thread.start() 
```

但不打印回溯。（它没有输出）。

但是，如果线程未设置为守护线程，Python 将打印回溯。这是相同的代码，但注释掉了一行：

```
def error_raiser():
    raise Exception

import threading
thread = threading.Thread(target=error_raiser)
# thread.daemon = True
thread.start() 
```

和输出：

```
Exception in Thread-1:
Traceback (most recent call last):
  File "C:\Python26\lib\threading.py", line 525, in __bootstrap_inner
    self.run()
  File "C:\Python26\lib\threading.py", line 477, in run
    self.__target(*self.__args, **self.__kwargs)
  File "test.py", line 2, in error_raiser
    raise Exception
Exception 
```

在 Python 2.6.2 和 Python 3.0.1 中执行此代码并给出相同的结果。然而，有趣的是，如果我通过在 IPython shell 中导入代码来执行代码，无论线程是否为守护进程，都会显示异常。

根据文档，“daemon”标志的唯一意义是“当只剩下守护线程时，整个 Python 程序退出”。这会让我相信在异常之后不打印回溯是 Python 中的一个错误，除非我错过了文档中的某些内容。

这是一个错误，还是我错过了文档中的某些内容并且这种行为是故意的？如果是故意的，如何强制 Python 在不使用 IPython 的情况下在守护线程中打印回溯？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T20:56:46.930

根据维基百科，根据定义，守护进程应该从控制 tty 中分离出来，所以我认为没有显示异常是正确的（毕竟，即使你关闭启动它的 shell，守护进程也应该继续工作）..
见[这里](http://en.wikipedia.org/wiki/Daemon_(computer_software)#Types_of_daemons).

至于如何打印回溯，我认为一个简单的 try/except_then_log_to_file 就可以了：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-07-06T12:41:22.747

> 这是一个错误，还是我错过了文档中的某些内容并且这种行为是故意的？

你自己基本上已经说出了原因，却没有意识到：

> 根据文档，“daemon”标志的唯一意义是“当只剩下守护线程时，整个 Python 程序退出”。

如果你有一个非守护线程，Python 会在`thread.start()`. 这种等待包括它所做的任何事情，包括引发和处理异常。

If you have a daemonic thread, Python *does not wait* for it after `thread.start()`. Instead, in the absence of further instructions Python exits immediately. That means your thread never has a chance to raise or handle the exception.

* * *

> If it is intentional, how can I force Python to print the traceback in daemon threads without using IPython?

For a `daemon` thread, it is inconsequential what your thread is supposed to do. If it was instructed to print something, the same would have happened.

That also means you have no way to conditionally wait for an action of the daemon. Either you set `thread.daemon = False` and get all tracebacks - as well as all prints, I/O, and other actions. Or you set `thread.daemon = True` and get no traceback - and no prints, I/O or other actions - after all other threads are dead.

* * *

> Interestingly, however, if I execute the code by importing it in the IPython shell, the exception is displayed whether the thread is daemonic or not.

The thing about shells is that they never exit unless you kill them. Since the shell's interpreter does not exit while it waits for your input, any `daemon` threads started remain alive.

# java - Java - 这是良好的编程习惯吗？

> ID：875458
> 
> 赞同：5
> 
> 时间：2009-05-17T20:48:31.787
> 
> 标签：java, coding-style, constants

只是想知道以下是否被认为是良好的编程习惯？我喜欢让我的个人源文件尽可能简洁和整洁，但我想知道更有经验的编码人员会怎么想。我特别喜欢 Settings.java 类将我所有的“幻数”保存在一个地方的想法。有人对我如何改进事情有任何建议吗？

快乐编码:-)

```
class ApplicationLauncher 
{
    public static void main(String[] args) 
    {
        SwingApplication mySwingApplication = new SwingApplication();
    }
}

//////////////

import javax.swing.*;

public class SwingApplication extends JFrame
{
    public SwingApplication()
    {       
        JFrame myJFrame = new JFrame();
        myJFrame.setSize(Settings.frameWidth, Settings.frameHeight);
        myJFrame.setVisible(true);      
    }
}

//////////////

class Settings 
{
    static int frameWidth = 100;
    static int frameHeight = 200;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T20:55:44.857

有一个设置类没有错。但是，在您的示例中，设置在它们适用的框架方面相当模糊，它们也不是实际设置，而是严格属于 SwingApplication 类的默认值。

我们无法控制的另一件事是 Swing 中的构造函数调用如何级联到程序的消息泵循环中。

对我来说，永远不会返回（除非框架关闭）并且不仅仅是初始化对象的构造函数从来没有意义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T20:52:11.997

将带有幻数的特殊类作为静态成员是一种很好的 Java 实践。

随着程序的增长，可以使用多个设置类，每个类都有描述性名称。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T20:56:23.327

有些人喜欢将所有这些东西、魔术数字等组合在一个大而丑陋的 XML 文件中，该文件将在运行时读取（并理解）。您的方法对于小型项目（例如一般课程）显然是可以的，但请考虑从 XML 文件获取这些设置的明显优势：您无需重新编译源代码以反映对设置所做的更改:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-17T21:00:01.430

您正在使用一些人所说的“可怕的常量接口反模式”，尽管常量通常位于导入的接口中。我对此没有意见，尤其是在静态导入出现之后，但也许有人会让我们了解可怕的邪恶。其中之一似乎是“这不是接口的用途”。

更值得关注的是，您应该在线程中启动 GUI：

```
 //Schedule a job for the event-dispatching thread: creating
    //and showing this application's GUI.
    SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame myJFrame = new JFrame();
                myJFrame.setSize(Settings.frameWidth, Settings.frameHeight);
                myJFrame.setVisible(true);
            }
        }); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-18T09:46:23.837

正如其他人所说，这是非常好的做法，但是您可以做一些事情来改进代码：

*   给`Settings`类一个私有的无参数构造函数。这使得实例化变得不可能，并使其作为常量存储库的意图更加清晰。
*   设置应该是`final`（不可变的）以及`static`.
*   通常，Java 中的常量是编写的，`LIKE_THIS`而不是`likeThis`.
*   如果您使用的是 Java 1.5 或更高版本，则可以`import static Settings.FRAME_WIDTH;`在您的类中使用以便能够`FRAME_WIDTH`直接使用，而不必编写`Settings.FRAME_WIDTH`.

最终你会得到：

```
class Settings
{
    /** Do not instantiate! */
    private Settings() {}

    static final int FRAME_WIDTH = 100;

    static final int FRAME_HEIGHT = 200;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-17T20:54:09.090

Macker 很好地覆盖了它。此外，这样做可以让您在将来轻松地将一些设置移动到实际的用户偏好中，以便他们可以自定义程序的不同部分。由于您的所有设置都已被隔离到它们自己的类中，因此您只需付出最少的努力。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-17T20:57:59.237

我认为这可能是一个很好的做法，只要设置不太可能更改并且您记录设置之间的关系。如果这些可能会更改，那么配置文件和/或命令行参数更有意义，因为它们不需要重新编译。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-17T21:20:04.520

如果您要为您的幻数使用静态，请确保它们也是最终的，如果您的意思是它们不会改变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-17T21:01:12.287

可变静态是一个非常糟糕的主意。坚持“从上方进行参数化”。

是直接问的，但是示例代码有其他问题。您已经扩展`JFrame`（一种不好的做法），但随后忽略了这一点并创建了另一个`JFrame`实际使用。此外，您还需要包含样板以始终访问 AWT 事件调度线程 (EDT) 上的 Swing 组件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-17T21:22:51.080

您可能需要查看 JSR 296（[Swing 应用程序框架](https://appframework.dev.java.net/)）来处理您的 GUI 设置/启动/属性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-18T07:12:53.813

另一种不需要静态导入的解决方案是创建一个包含字段、getter 和 setter 的完整“ApplicationSettings”类，并将此类的实例传递给需要参数的类的构造函数。这允许您保留一个配置对象，如果您想在用户调整窗口大小时保存新大小，则可以轻松地保存或修改该对象。

# objective-c - NSCoder - 归档一个指针？

> ID：875459
> 
> 赞同：3
> 
> 时间：2009-05-17T20:48:52.143
> 
> 标签：objective-c

我有一个包含指向另一个类的指针的objective-c 类。我想通过 NSCoder 归档这个类的一个实例：

```
@interface Barn
{
    int m_numHorses;

    // Barn does not allocate this instance, it just points to it.
    Farmer* m_pFarmer;
}
@end

...

- (void)encodeWithCoder:(NSCoder *)encoder
{
    [encoder encodeInt:m_numHorses forKey:@"numHorses"];
    [encoder encode?:m_pFarmer forKey:@"pFarmer"];
}

- (void) setPointer:(Farmer*)pFarmer
{
    m_pFarmer = pFarmer;
} 
```

我将如何归档 m_pFarmer 指针？这对我来说没有意义，因为它只是一个地址，而且我看不到 NSCoder 可以为您序列化到磁盘，以便它知道稍后在您反序列化时如何恢复链接？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T23:50:17.760

您不能直接对指针进行编码，因为当您取消归档对象时，指针的值将完全不同。我的意思是，你可以用

```
encodeValueOfObjCType:@encode(id) at:&m_pFarmer 
```

但不能保证反序列化的指针会指向反序列化的农夫；事实上，它很可能不会。

如果`Barn`不拥有`Farmer`，则`Barn`不应在反序列化时重新创建它；您最终会得到一个`Farmer`与原始版本不同的新版本。那么，您需要一种方法来找到原始 Farmer 的反序列化实例，并将 Barn 的 Farmer 实例替换为另一个。

有人拥有`Farmer`，对吧？所以`Barn`需要有一个`findMyFarmer`方法，它查看所有的`FarmerOwner`s 并找到它应该使用的原始实例。（也许通过比较`farmerID`ivar 上的`Farmer`？）一旦完成，您可以在 上实施`-[NSObject awakeAfterUsingCoder:(NSCoder *)]`以`Barn`触发农民更换例程。

希望这是有道理的。查看有关存档和序列化的[文档，尤其是有关](http://developer.apple.com/documentation/Cocoa/Conceptual/Archiving/)**编码和解码对象**的页面，以了解有关动态替换对象的更多信息。

**更新**

`NSArchiver`s 和`NSKeyedArchiver`s 支持[*条件*归档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/Archiving/Concepts/archives.html#//apple_ref/doc/uid/20000946-142208)的思想，（通过`encodeConditionalObject:`）只有当归档中的其他对象已经添加对象时，才会将对象添加到归档中。该文档说“**通常，条件对象用于编码对对象的弱引用或非保留引用。** ”。因此，如果您`Farmer`的文件已经被存档，那么您会想要添加它，但如果您只是在`Barn`没有任何农民的情况下对您的文件进行编码，那么您就不会想要添加它。

一定要查看上面引用的文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T21:10:14.527

你也应该在你的类中使用`encodeObject:`和实现，所以它会被递归调用。`NSCoding``Farmer`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T00:48:28.090

您应该首先阅读 BJ 指向的文档。

序列化库足够智能，可以检测同一对象的重复，并且只会对其进行一次编码。所以一般来说，如果你以后需要它，你应该对这个对象进行编码。序列化库甚至可以处理图形循环。你不需要担心这些事情，并且*不*应该主动去猜测其他对象将如何处理这个对象。ObjC 没有 C++ 经常需要的那种强大的对象所有权概念。引用计数内存管理不需要它，您不应该重新创建它。

说到引用计数，你的意思是不要在你的 setter 中保留 Farmer 吗？这是因为 Barn 已经保留了 Farmer 吗？或者这是垃圾收集代码？或者这是无意的保留不足？如果您实际上保留了它，那么当您反序列化这些东西时，这肯定会导致崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:02:33.407

如果您真的想对指针持有的地址进行编码（因为您可以保证`Farmer`对象将保留在该位置，直到您解码存档），那么您可以将指针编码为`NSInteger`.

IE`[encoder encodeInteger:(NSInteger)m_pFarmer forKey:@"pFarmer"];`

不过一般来说，这是一个坏主意，除非您非常小心地将`Farmer`对象保存得比存档更长。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-07T17:31:22.097

我做了类似的事情。在您的情况下，我会为 Farmer 生成一个 UUID（唯一标识符），使用

```
var uniqueIdentifier: String = NSUUID().UUIDString 
```

然后我会使用 NSCoding 将这个 UUID 保存在 Farmer 上。

我还将通过此 UUID 将 Barn 指向 Farmer（您可以在 Barn 上计算出的“Farmer”属性通过 UUID 确定 Farmer）。并使用 NSCoding 保存 Barn 的 UUID。这样，在磁盘上保存数据时，您将永远不会丢失指针。

当然，更好的技术解决方案是使用 CoreData，但那是另一回事......

编辑：我有一个案例，我试图用 NSCoding 对指向另一个对象的指针进行编码。我的案例是指向股票（定义为股票的属性）的股票警报。似乎 NSCoding 创建了原始对象的副本，在其当前状态下“冻结”。并且该副本将独立于原始对象存在。股票有属性，一些是存储的（当前股价），另一些是计算的（以货币或百分比计算的收益）。股票警报的股票属性的存储属性未更改，而计算属性（取决于其他因素）发生了变化。所以我的经验的结论是，尝试使用 NSCoding 保存指向另一个对象的指针并不是一个好主意。

# java - 通过 HTTPS/SSL 的 Java 客户端证书

> ID：875467
> 
> 赞同：121
> 
> 时间：2009-05-17T20:51:55.257
> 
> 标签：java, ssl, jsse, sslhandshakeexception

我正在使用 Java 6，并尝试`HttpsURLConnection`使用客户端证书针对远程服务器创建一个。
服务器正在使用自签名根证书，并要求提供受密码保护的客户端证书。我已将服务器根证书和客户端证书添加到我在`/System/Library/Frameworks/JavaVM.framework/Versions/1.6.0/Home/lib/security/cacerts`（OSX 10.5）中找到的默认 java 密钥库中。密钥库文件的名称似乎表明客户端证书不应该放在那里？

无论如何，将根证书添加到这个商店解决了臭名昭著的问题`javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed' problem.`

但是，我现在被困在如何使用客户端证书上。我尝试了两种方法，但都没有让我到任何地方。
首先，也是首选，尝试：

```
SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
URL url = new URL("https://somehost.dk:3049");
HttpsURLConnection conn = (HttpsURLConnection)url.openConnection();
conn.setSSLSocketFactory(sslsocketfactory);
InputStream inputstream = conn.getInputStream();
// The last line fails, and gives:
// javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure 
```

我尝试跳过 HttpsURLConnection 类（不理想，因为我想与服务器交谈 HTTP），而是这样做：

```
SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
SSLSocket sslsocket = (SSLSocket) sslsocketfactory.createSocket("somehost.dk", 3049);
InputStream inputstream = sslsocket.getInputStream();
// do anything with the inputstream results in:
// java.net.SocketTimeoutException: Read timed out 
```

我什至不确定客户端证书是这里的问题。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-05-19T12:34:10.693

终于解决了；）。[在这里](http://emo.sourceforge.net/cert-login-howto.html)得到了一个强烈的暗示（甘道夫的回答也涉及到了一点）。缺少的链接（大部分）是下面的第一个参数，在某种程度上我忽略了密钥库和信任库之间的区别。

自签名服务器证书必须导入信任库：

> keytool -import -alias gridserver -file gridserver.crt -storepass $PASS -keystore gridserver.keystore

需要设置这些属性（在命令行或代码中）：

```
-Djavax.net.ssl.keyStoreType=pkcs12
-Djavax.net.ssl.trustStoreType=jks
-Djavax.net.ssl.keyStore=clientcertificate.p12
-Djavax.net.ssl.trustStore=gridserver.keystore
-Djavax.net.debug=ssl # very verbose debug
-Djavax.net.ssl.keyStorePassword=$PASS
-Djavax.net.ssl.trustStorePassword=$PASS 
```

工作示例代码：

```
SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
URL url = new URL("https://gridserver:3049/cgi-bin/ls.py");
HttpsURLConnection conn = (HttpsURLConnection)url.openConnection();
conn.setSSLSocketFactory(sslsocketfactory);
InputStream inputstream = conn.getInputStream();
InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
BufferedReader bufferedreader = new BufferedReader(inputstreamreader);

String string = null;
while ((string = bufferedreader.readLine()) != null) {
    System.out.println("Received " + string);
} 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-05-18T08:58:31.237

虽然不推荐，但您也可以一起禁用 SSL 证书验证：

```
import javax.net.ssl.*;
import java.security.SecureRandom;
import java.security.cert.X509Certificate;

public class SSLTool {

  public static void disableCertificateValidation() {
    // Create a trust manager that does not validate certificate chains
    TrustManager[] trustAllCerts = new TrustManager[] { 
      new X509TrustManager() {
        public X509Certificate[] getAcceptedIssuers() { 
          return new X509Certificate[0]; 
        }
        public void checkClientTrusted(X509Certificate[] certs, String authType) {}
        public void checkServerTrusted(X509Certificate[] certs, String authType) {}
    }};

    // Ignore differences between given hostname and certificate hostname
    HostnameVerifier hv = new HostnameVerifier() {
      public boolean verify(String hostname, SSLSession session) { return true; }
    };

    // Install the all-trusting trust manager
    try {
      SSLContext sc = SSLContext.getInstance("SSL");
      sc.init(null, trustAllCerts, new SecureRandom());
      HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
      HttpsURLConnection.setDefaultHostnameVerifier(hv);
    } catch (Exception e) {}
  }
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-17T22:42:20.607

您是否设置了 KeyStore 和/或 TrustStore 系统属性？

```
java -Djavax.net.ssl.keyStore=pathToKeystore -Djavax.net.ssl.keyStorePassword=123456 
```

或从代码

```
System.setProperty("javax.net.ssl.keyStore", pathToKeyStore); 
```

与 javax.net.ssl.trustStore 相同

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-07-07T21:42:54.413

如果您使用 Axis 框架处理 Web 服务调用，则有一个更简单的答案。如果您只想让您的客户端能够调用 SSL Web 服务并忽略 SSL 证书错误，那么只需在调用任何 Web 服务之前添加以下语句：

`System.setProperty("axis.socketSecureFactory", "org.apache.axis.components.net.SunFakeTrustSocketFactory");`

关于这是在生产环境中做的一件非常糟糕的事情的通常免责声明适用。

我在[Axis wiki](http://wiki.apache.org/ws/FrontPage/Axis/SslUnsignedCertificate)找到了这个。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-11-06T12:29:06.290

对我来说，这就是使用 Apache HttpComponents ~ HttpClient 4.x 的方法：

```
 KeyStore keyStore  = KeyStore.getInstance("PKCS12");
    FileInputStream instream = new FileInputStream(new File("client-p12-keystore.p12"));
    try {
        keyStore.load(instream, "helloworld".toCharArray());
    } finally {
        instream.close();
    }

    // Trust own CA and all self-signed certs
    SSLContext sslcontext = SSLContexts.custom()
        .loadKeyMaterial(keyStore, "helloworld".toCharArray())
        //.loadTrustMaterial(trustStore, new TrustSelfSignedStrategy()) //custom trust store
        .build();
    // Allow TLSv1 protocol only
    SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(
        sslcontext,
        new String[] { "TLSv1" },
        null,
        SSLConnectionSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER); //TODO
    CloseableHttpClient httpclient = HttpClients.custom()
        .setHostnameVerifier(SSLConnectionSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER) //TODO
        .setSSLSocketFactory(sslsf)
        .build();
    try {

        HttpGet httpget = new HttpGet("https://localhost:8443/secure/index");

        System.out.println("executing request" + httpget.getRequestLine());

        CloseableHttpResponse response = httpclient.execute(httpget);
        try {
            HttpEntity entity = response.getEntity();

            System.out.println("----------------------------------------");
            System.out.println(response.getStatusLine());
            if (entity != null) {
                System.out.println("Response content length: " + entity.getContentLength());
            }
            EntityUtils.consume(entity);
        } finally {
            response.close();
        }
    } finally {
        httpclient.close();
    } 
```

P12 文件包含使用 BouncyCastle 创建的客户端证书和客户端私钥：

```
public static byte[] convertPEMToPKCS12(final String keyFile, final String cerFile,
    final String password)
    throws IOException, CertificateException, KeyStoreException, NoSuchAlgorithmException,
    NoSuchProviderException
{
    // Get the private key
    FileReader reader = new FileReader(keyFile);

    PEMParser pem = new PEMParser(reader);
    PEMKeyPair pemKeyPair = ((PEMKeyPair)pem.readObject());
    JcaPEMKeyConverter jcaPEMKeyConverter = new JcaPEMKeyConverter().setProvider("BC");
    KeyPair keyPair = jcaPEMKeyConverter.getKeyPair(pemKeyPair);

    PrivateKey key = keyPair.getPrivate();

    pem.close();
    reader.close();

    // Get the certificate
    reader = new FileReader(cerFile);
    pem = new PEMParser(reader);

    X509CertificateHolder certHolder = (X509CertificateHolder) pem.readObject();
    java.security.cert.Certificate x509Certificate =
        new JcaX509CertificateConverter().setProvider("BC")
            .getCertificate(certHolder);

    pem.close();
    reader.close();

    // Put them into a PKCS12 keystore and write it to a byte[]
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    KeyStore ks = KeyStore.getInstance("PKCS12", "BC");
    ks.load(null);
    ks.setKeyEntry("key-alias", (Key) key, password.toCharArray(),
        new java.security.cert.Certificate[]{x509Certificate});
    ks.store(bos, password.toCharArray());
    bos.close();
    return bos.toByteArray();
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-17T21:23:27.897

我在我当前的项目中使用 Apache commons HTTP Client 包来执行此操作，它适用于 SSL 和自签名证书（在将其安装到您提到的 cacerts 之后）。请看这里：

[http://hc.apache.org/httpclient-3.x/tutorial.html](http://hc.apache.org/httpclient-3.x/tutorial.html)

[http://hc.apache.org/httpclient-3.x/sslguide.html](http://hc.apache.org/httpclient-3.x/sslguide.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-18T08:55:31.430

我认为您的服务器证书有问题，不是有效的证书（我认为这就是“handshake_failure”在这种情况下的含义）：

将您的服务器证书导入到客户端 JRE 上的 trustcacerts 密钥库中。这很容易用[keytool](http://java.sun.com/j2se/1.3/docs/tooldocs/win32/keytool.html)完成：

```
keytool
    -import
    -alias <provide_an_alias>
    -file <certificate_file>
    -keystore <your_path_to_jre>/lib/security/cacerts 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-31T15:54:56.460

使用下面的代码

```
-Djavax.net.ssl.keyStoreType=pkcs12 
```

或者

```
System.setProperty("javax.net.ssl.keyStore", pathToKeyStore); 
```

根本不需要。此外，无需创建您自己的自定义 SSL 工厂。

我也遇到了同样的问题，在我的情况下，有一个问题是**完整的证书链**没有导入到信任库中。使用 keytool 工具权限从根证书导入证书，您也可以在记事本中打开 cacerts 文件，查看是否导入了完整的证书链。检查您在导入证书时提供的别名，打开证书并查看其中包含多少个证书，cacerts 文件中应该有相同数量的证书。

cacerts 文件也应该在您运行应用程序的服务器中配置，两台服务器将使用公钥/私钥相互验证。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-24T21:36:31.173

尽管这个问题已有 12 多年的历史并且有很多很好的答案，但我想提供一个替代方案。这是加载密钥库和信任库并获取 sslsocketfactory 或 sslcontext 的一小段代码：

```
SSLFactory sslFactory = SSLFactory.builder()
        .withIdentityMaterial("clientcertificate.p12", "password".toCharArray(), "PKCS12")
        .withTrustMaterial("gridserver.keystore", "password".toCharArray(), "PKCS12")
        .build();

SSLSocketFactory sslSocketFactory = sslFactory.getSslSocketFactory();
SSLContext sslContext = sslFactory.getSslContext(); 
```

此示例代码片段来自库：[GitHub - SSLContext Kickstart](https://github.com/Hakky54/sslcontext-kickstart)您可以使用以下片段添加它：

```
<dependency>
    <groupId>io.github.hakky54</groupId>
    <artifactId>sslcontext-kickstart</artifactId>
    <version>7.0.2</version>
</dependency> 
```

# java - 有人可以总结一下 Java 接口的可见性选择吗？

> ID：875471
> 
> 赞同：1
> 
> 时间：2009-05-17T20:53:31.197
> 
> 标签：java, oop, api-design

我真的有两个问题：

1) 你什么时候会使用包私有接口？

2）有没有办法让一个公共接口在其包外实现而关闭？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T21:00:12.023

1）仅在您的包范围内需要接口时。例如，接口可以使您的代码更具可读性，但包的调用者不需要它。

2）不，这是不可能的。有关更多信息，请参阅此[链接](http://www.codestyle.org/java/faq-Interface.shtml#publicinterfacemethods)。接口没有定义实现。那你怎么能关闭它来实施呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T21:26:24.707

包私有接口仅在策略模式的此类实现的情况下有用，在这种情况下，您可能希望使用多种实现，但不希望世界知道这些类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T21:25:36.237

1）您的包中可能有多个类使用的实用方法，这些方法永远不应被外部调用。或者它们可能只有一个类需要，但是该类太大了，您想将一些方法移动到另一个类以实现可维护性。

2）我将不得不尝试一下（对不起，我现在急于出门），但是您可以通过在接口中声明一个受保护的默认构造函数来*有效地*做到这一点。

# c# - 验证请求事件

> ID：875472
> 
> 赞同：42
> 
> 时间：2009-05-17T20:53:36.080
> 
> 标签：c#, asp.net, authentication, forms-authentication, httpapplication

Q 1\. 据我了解`FormsAuthenticationModule`是订阅`AuthenticateRequest`事件，因此只有在这个事件被触发后，才会被`FormsAuthenticationModule`调用。但是下面的引用让我有点困惑：

1.  > 该`AuthenticateRequest`事件表明配置的身份验证机制已对当前请求进行身份验证。

    *   上面的引用不是表明在`AuthenticateRequest`引发事件时，请求（又名用户）已经过身份验证吗？
2.  > 订阅`AuthenticateRequest`事件可确保在处理附加的模块或事件处理程序之前对请求进行身份验证。

    *   据我了解这句话，如果我们订阅`AuthenticatedRequest`，那么我们的事件处理程序将在`FormsAuthenticationModule`? 因此`Application_AuthenticateRequest()`会在被调用之前`FormsAuthenticationModule`被调用吗？

Q 2\. 我正在学习的书建议`Application_AuthenticateRequest()`我们能够验证用户是否是特定角色的成员，如果不是，我们可以自动添加用户：

```
 protected void Application_AuthenticateRequest(Object sender, EventArgs e)
    {
            if (User.Identity.IsAuthenticated && Roles.Enabled)
            {

                //here we can subscribe user to a role via Roles.AddUserToRole()
            }       
    } 
```

从上面的代码来看，在被调用`Application_AuthenticateRequest()`之后`FormsAuthenticationModule`被调用，但是同一本书的其他地方暗示`Application_AuthenticateRequest()`在之前被调用`FormsAuthenticationModule`：

> > `Application_AuthenticateRequest` 在执行身份验证之前调用。这是创建您自己的身份验证逻辑的起点。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-17T21:40:57.480

FormsAuthenticationModule 似乎首先得到处理。这个模块通常早于 ASP.NET 管道中的任何自定义模块，所以当 AuthenticateRequest 被触发时，FormsAuthenticationModule 将首先被调用，完成它的工作，然后你的模块的事件处理程序将被调用。

如果您真的想深入研究，我建议您尝试自己调试 ASP.NET 代码。这是一篇如何设置你的VS的帖子：

[http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx)

**编辑**：我能够通过在 Global.asax 中使用自定义模块和事件处理程序设置一个 Web 项目来确认此行为。看一下HttpApplication.InitInternal的源码，初始化顺序如下：

*   集成模块的初始化：FormsAuthenticationModule 连接到 HttpApplication.AuthenticateRequest 事件
*   自定义模块的初始化：自定义模块连接到 HttpApplication.AuthenticateRequest 事件
*   Global 类（global.asax）的初始化：这里我们连接到 AuthenticateRequest 事件
*   HttpApplication.InitInternal 按照特定名称模式（例如 Application_AuthenticateRequest）搜索 Global 类上的方法，将它们与事件匹配并连接

初始化之后，当 AuthenticateRequest 触发时，事件处理程序会按照它们初始化的顺序被调用，所以：

*   FormsAuthenticationModule.AuthenticateRequest 事件处理程序
*   CustomModule.AuthenticateRequest 事件处理程序
*   Global.AuthenticateRequest 事件处理程序
*   Global.Application_AuthenticateRequest 方法

除非我错过了什么，否则没有阻止事件处理程序触发的机制，所以无论 FormsAuthenticationModule.AuthenticateRequest 的结果如何，下一个处理程序仍将被调用。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-20T12:03:31.343

如果您想访问 User 对象，我建议您使用

```
protected void Application_Start()
{
    PostAuthenticateRequest += Application_PostAuthenticateRequest;
}

protected void Application_PostAuthenticateRequest(object sender, EventArgs e)
{
    if(User.Identity.IsAuthenticated)
    {
        //Do stuff here
    }
} 
```

# python - 使用 python 编辑 wav 文件

> ID：875476
> 
> 赞同：4
> 
> 时间：2009-05-17T20:54:38.480
> 
> 标签：python, audio

在 wav 文件中的每个单词之间，我完全保持沉默（我用 Hex 工作室检查过，沉默用 0 表示）。

如何消除非静音声音？

我正在使用 python 编程。

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-17T23:50:00.553

Python 有一个[wav 模块](http://docs.python.org/library/wave.html)。您可以使用它打开一个 wav 文件进行读取，并使用 `getframes(1)' 命令逐帧浏览文件。

```
import wave
w = wave.open('beeps.wav', 'r')
for i in range():
frame = w.readframes(1) 
```

返回的帧将是一个字节字符串，其中包含十六进制值。如果文件是立体声文件，结果将如下所示（4 个字节）：

```
'\xe2\xff\xe2\xff' 
```

如果是单声道，它将有一半的数据（2 个字节）：

```
'\xe2\xff' 
```

因为音频是 16 位，所以每个通道长 2 个字节。如果是 8 位，每个通道将只有一个字节。您可以使用该`getsampwidth()`方法来确定这一点。此外，`getchannels()`将确定它是单声道还是立体声。

您可以遍历这些字节以查看它们是否都为零，这意味着两个通道都是静默的。在以下示例中，我使用该`ord()`函数将`'\xe2'`十六进制值转换为整数。

```
import wave
w = wave.open('beeps.wav', 'r')
for i in range(w.getnframes()):
    ### read 1 frame and the position will updated ###
    frame = w.readframes(1)

    all_zero = True
    for j in range(len(frame)):
        # check if amplitude is greater than 0
        if ord(frame[j]) > 0:
            all_zero = False
            break

    if all_zero:
        # perform your cut here
        print 'silence found at frame %s' % w.tell()
        print 'silence found at second %s' % (w.tell()/w..getframerate()) 
```

值得注意的是，单帧静音并不一定表示空白空间，因为幅度可能跨越 0 标记正常频率。因此，建议在确定该区域是否实际上是静默之前观察一定数量的 0 帧。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-05T02:05:33.263

我一直在为我正在从事的一个项目对这个主题进行一些研究，并且我在提供的解决方案中遇到了一些问题，即确定静音的方法不正确。“更正确”的实现将是：

```
import struct
import wave

wave_file = wave.open("sound_file.wav", "r")

for i in range(wave_file.getnframes()):
    # read a single frame and advance to next frame
    current_frame = wave_file.readframes(1)

    # check for silence
    silent = True
    # wave frame samples are stored in little endian**
    # this example works for a single channel 16-bit per sample encoding
    unpacked_signed_value = struct.unpack("<h", current_frame) # *
    if abs(unpacked_signed_value[0]) > 500:
        silent = False

    if silent:
        print "Frame %s is silent." % wave_file.tell()
    else
        print "Frame %s is not silent." % wave_file.tell() 
```

# **参考资料和有用的链接**

*`Struct Unpacking`在这里有用：[https ://docs.python.org/2/library/struct.html](https://docs.python.org/2/library/struct.html)

**我找到了一个很好的参考来解释用于处理不同大小位编码和多个通道的波形文件格式是：[http ://www.piclist.com/techref/io/serial/midi/wave.html](http://www.piclist.com/techref/io/serial/midi/wave.html)

对 readframes(x) 方法返回的字符串对象的第一个元素使用 Python 中的内置 ord() 函数将无法正常工作。

另一个关键点是多通道音频是交错的，因此需要一些额外的逻辑来处理通道。同样，上面的链接详细介绍了这一点。

希望这对将来的某人有所帮助。

以下是链接中的一些更重要的点，以及我认为有帮助的内容。

**数据组织**

* * *

所有数据都存储在 8 位字节中，以 Intel 80x86（即小端）格式排列。多字节值的字节首先存储低位（即最低有效）字节。数据位如下（即，顶部显示位号）：

```
 7  6  5  4  3  2  1  0
       +-----------------------+
 char: | lsb               msb |
       +-----------------------+

         7  6  5  4  3  2  1  0 15 14 13 12 11 10  9  8
       +-----------------------+-----------------------+
short: | lsb     byte 0        |       byte 1      msb |
       +-----------------------+-----------------------+

         7  6  5  4  3  2  1  0 15 14 13 12 11 10  9  8 23 22 21 20 19 18 17 16 31 30 29 28 27 26 25 24
       +-----------------------+-----------------------+-----------------------+-----------------------+
 long: | lsb     byte 0        |       byte 1          |         byte 2        |       byte 3      msb |
       +-----------------------+-----------------------+-----------------------+-----------------------+ 
```

**交错**

* * *

对于多声道声音（例如，立体声波形），来自每个声道的单个采样点是交错的。例如，假设一个立体声（即 2 声道）波形。不是先存储左声道的所有采样点，然后再存储右声道的所有采样点，而是将两个声道的采样点“混合”在一起。您将存储左声道的第一个采样点。接下来，您将存储右声道的第一个采样点。接下来，您将存储左声道的第二个采样点。接下来，您将存储右通道的第二个采样点，依此类推，交替存储每个通道的下一个采样点。这就是交错数据的含义；您依次存储每个通道的下一个采样点，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T15:19:45.070

另请参阅[如何在没有音频库的情况下编辑原始 PCM 音频数据？](https://stackoverflow.com/questions/841049/how-to-edit-raw-pcm-audio-data-without-an-audio-library)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T12:44:19.970

在切割它们之前，您需要提出一个最小连续零数量的阈值。否则，您将从正常音频数据的中间删除完全有效的零。您可以遍历波形文件，复制任何非零值，并缓冲零值。当您缓冲零并最终遇到下一个非零时，如果缓冲区的样本少于阈值，则将它们复制过来，否则将其丢弃。

不过，Python 并不是完成此类任务的好工具。:(

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T21:46:24.783

您可能想尝试使用命令行声音处理工具[sox 。](http://linux.die.net/man/1/sox)它有多种模式，其中之一是`silence`：

> 静音：从声音文件的开头、中间或结尾删除静音。沉默是低于指定阈值的任何事物。

它支持多种声音格式并且速度非常快，因此解析大文件应该不是问题。

> 要从文件中间删除静音，请指定`below_periods`负数。然后，此值被视为正值，还用于指示效果应按照 指定的重新开始处理`above_periods`，使其适用于删除声音文件中间的静音时段。

不过，我还没有找到任何用于 libsox 的 python 构建，但是您可以像使用 python 中的所有命令行程序一样使用它（或者您可以重写它 - 然后使用 sox 源代码作为指导）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T21:00:43.253

我没有这方面的经验，但是看看标准库中的[wave](http://docs.python.org/library/wave.html)模块。这可能会做你想要的。否则，您必须将文件作为字节流读取并剪切出 0 字节序列（但您不能只剪切所有 0 字节，因为这会使文件无效......）

# javascript - 用于在 gmail 中插入数学的 Greasemonkey 脚本

> ID：875478
> 
> 赞同：7
> 
> 时间：2009-05-17T20:54:42.740
> 
> 标签：javascript, email, latex, gmail, mathml

我希望有一种与 gmail 交流数学方程式的简单方法。

有一个名为 AsciiMath的[JavaScript脚本，它应该将类似 Tex 的方程转换为标准的 mathML。](http://www1.chapman.edu/~jipsen/mathml/asciimath.html)

我认为将这个脚本与 GM 一起使用会很好。我认为在发送电子邮件之前，此脚本会将您电子邮件中的所有类似 TeX 的方程转换为 MathML。因此，使用 FF（或安装了 MathPlayer 的 IE）的阅读器将能够轻松阅读这些方程式。

理想情况下，我希望以某种方式将原始的类似 TeX 的方程式保存在纯文本消息中，以便纯文本电子邮件客户端（例如`mutt`.

显然，这里最薄弱的环节是客户端软件，它很可能不支持 MathML。不过，如果我的通讯员使用的是 Firefox 和某种网络邮件（这很合理）——它应该可以工作。

我的问题是，有可能吗？有人这样做吗？

您是否看到这种方法存在任何技术问题（gmail 过滤 MathML、客户端未正确解析等）？

有什么更聪明的想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-14T01:52:52.033

[GmailTeX](http://alexeev.org/gmailtex.html)完全符合您的要求。它是纯 javascript，因此可以在 Firefox、Chrome、Opera 中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T21:17:56.973

使用[texify](http://texify.com)并将其仅转换为 html 图像或该图像的链接怎么样？这将节省一些解析和转换 tex 数学代码的工作，即使使用简单的邮件客户端也能正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-23T09:39:30.507

据我所知，GmailTeX（建议在最佳答案中）不再在 Firefox 中工作。

我可以推荐[Gmail 的浏览器插件 MathQuill](https://addons.mozilla.org/en-US/firefox/addon/mathquill-for-gmail/)（[Chrome](https://chrome.google.com/webstore/detail/mathquill-for-gmail/jdliianpdlmcfnjgijmgpmmpomdhllni)也有），它允许在 Gmail 撰写窗口中编辑公式，并将它们转换为图片。（在概念上类似于 GmailTeX，但具有交互式编辑器。）

**免责声明：我是插件的作者。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:00:35.623

根据您与谁沟通，最简单的解决方案有时是通过电子邮件发送 raw tex。

# c++ - .cpp 文件和 .h 文件有什么区别？

> ID：875479
> 
> 赞同：78
> 
> 时间：2009-05-17T20:54:48.353
> 
> 标签：c++, header, include

因为我制作了 .cpp 文件，然后将它们传输到 .h 文件中，所以我能找到的唯一区别是您不能 #include .cpp 文件。我缺少什么区别吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-17T20:57:28.490

C++ 构建系统（编译器）没有区别，所以它都是一种约定。

约定是`.h`文件是声明，`.cpp`文件是定义。

这就是`.h`文件是`#include`d 的原因——我们包括声明。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-17T20:59:24.037

.cpp 文件是编译单元：它将被编译的真正的源代码文件（在 C++ 中）。

.h（头文件）文件是虚拟复制/粘贴到 #include 预编译器指令出现的 .cpp 文件中的文件。将标头代码插入 .cpp 代码后，即可开始编译 .cpp。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-17T21:00:17.437

.h 文件或头文件用于在类声明中列出可公开访问的实例变量和方法。.cpp 文件或实现文件用于实际实现这些方法并使用这些实例变量。

它们分开的原因是 .h 文件没有编译成二进制代码，而 .cpp 文件是。以图书馆为例。假设您是作者，并且您不希望它是开源的。因此，您将编译后的二进制库和头文件分发给您的客户。这使他们可以轻松查看有关他们可以使用的库类的所有信息，而无法查看您是如何实现这些方法的。它们更适合使用您的代码而不是编译器的人。如前所述：这是惯例。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-17T21:32:50.073

标头 ( `.h`, `.hpp`, ...) 文件包含

*   类定义 ( `class X { ... };`)
*   内联函数定义 ( `inline int get_cpus() { ... }`)
*   函数声明 ( `void help();`)
*   对象声明 ( `extern int debug_enabled;`)

源文件 ( `.c`, `.cpp`, `.cxx`) 包含

*   函数定义（`void help() { ... }`或`void X::f() { ... }`）
*   对象定义 ( `int debug_enabled = 1;`)

但是，实际上并不需要`.h`使用后缀命名标头和命名源文件的约定。`.cpp`总是可以告诉一个好的编译器如何处理某个文件，而不管它的文件名后缀（`-x <file-type>`对于 gcc。Like `-x c++`）。

源文件将包含在整个程序中只能出现一次的定义。因此，如果您在某处包含一个源文件，然后将该文件的编译结果和源文件本身的一个链接在一起，那么您当然会得到链接器错误，因为这些定义现在出现了两次：包含源文件，然后在包含它的文件中。这就是您在包含`.cpp`文件时遇到问题的原因。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-17T21:37:14.697

> 我知道声明和定义之间的区别。

然而：

*   CPP 文件包括它所包含的任何头文件中的定义（因为 CPP 和头文件一起成为一个单一的“翻译单元”）
*   一个头文件可能包含在多个 CPP 文件中
*   链接器通常不会喜欢在多个 CPP 文件中定义的任何内容

因此，头文件中的任何定义都应该是内联的或静态的。头文件还包含多个 CPP 文件使用的声明。

既不是静态也不是内联的定义被放置在 CPP 文件中。此外，仅在一个 CPP 文件中需要的任何声明通常放在该 CPP 文件本身中，而不是放在任何（可共享的）头文件中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-17T21:13:55.767

一个好的经验法则是“.h 文件应该具有 [可能] 被多个源文件使用的声明，但没有可以运行的代码。”

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-17T21:04:03.590

其他人已经提供了很好的解释，但我认为我应该澄清各种扩展之间的区别：

```
  C 的源文件：.c
  C 的头文件：.h

  C++ 的源文件：.cpp
  C++ 的头文件：.hpp

```

当然，正如已经指出的那样，这些只是惯例。编译器实际上并没有注意到它们——这纯粹是为了编码器的利益。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-17T20:57:22.233

按照惯例，.h 文件被其他文件包含，并且永远不会被它们自己直接编译。.cpp 文件——再次按照惯例——是编译过程的根源；它们直接或间接包括 .h 文件，但通常不包括 .cpp 文件。

# django - Django视图的命名约定？

> ID：875480
> 
> 赞同：6
> 
> 时间：2009-05-17T20:55:00.397
> 
> 标签：django, naming-conventions

我正在构建一个网站（在 Django 中），并且对用于我的功能的正确命名约定感到困惑。简单的例子：假设我有一个页面，让用户决定他们是想看图像 A 还是图像 B。一旦用户提交决定，网站就会显示用户请求的图像。

这是我的视图模块中的两个功能：

```
def function1(request):
    """Returns the page that presents the user with the choice between A and B"""

def function2(request):
    """Takes in the submitted form and returns a page with the image the user requested.""" 
```

命名执行此操作的函数的约定是什么？我看到至少两种可行的方法：

**选项 1**：`function1: "decide", function2: "view_image"`

**选项 2**：`function1: "view_choices", function2: "decide"`

核心问题是这些函数中的每一个都做了两件事：（1）处理和存储用户提交的数据，以及（2）返回下一页，这可能与用户的输入相关，也可能不相关。那么我应该在 (1) 或 (2) 之后命名我的函数吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T21:29:54.183

通常，约定是某种 CRUD（创建、检索、更新、删除）。我个人使用索引、详细信息、创建、更新、删除来执行我的操作。但是，我认为这不适用于您的自定义函数。

真的，听起来你的函数应该合并到同一个“选择”函数中。然后，您可以根据结果是否为 POST 来显示表单或结果。

*注意：我[从表单处理的 django 文档中](http://docs.djangoproject.com/en/dev/topics/forms/#using-a-form-in-a-view)大量复制了这个示例。*

```
def choose(request):
    """
    Presents the user with an image selection form and displays the result.
    """
    if request.method == 'POST': # If the form has been submitted...
        form = ChoiceForm(request.POST) # A form bound to the POST data
        if form.is_valid(): # All validation rules pass
            # Process the data in form.cleaned_data
            # ...
            return HttpResponseRedirect('/thanks/') # Redirect after POST
    else:
        form = ChoiceForm() # An unbound form

    return render_to_response('choose.html', {
        'form': form,
    }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T20:58:51.730

只要您有这些好评论，我怀疑这对您来说永远不会成为问题。

无论如何，最好根据函数的功能命名函数，因此 function1 可以是“displayImageChoices”，而 function2 可以是“displayImage”。

IE，function1 接受一些输入并显示一些选择，function2 接受一些输入并显示一个图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:33:39.743

在适用的情况下，我会使用类似于内置视图（object_list、object_detail 等）的东西。（总是一个好主意）

然后，其余部分将尽可能遵循该概念（item_action）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-12-24T15:56:16.187

我知道这现在有点过时了，但是自从切换到基于类的视图之后。

PEP8 ( [python.org/dev/peps/pep-0008](http://python.org/dev/peps/pep-0008) ) 类的命名约定是每个单词的大写，没有空格。如果您仍然使用函数样式视图，那么它将是小写函数名称，其中空格替换为下划线以提高可读性。

例如基于类的视图：

```
class MyClassBasedView():
    ... 
```

基于函数

```
def my_function_based_view():
    ... 
```

# drupal - 如何使两个网站看起来合二为一 - 哪些功能很重要？

> ID：875481
> 
> 赞同：-2
> 
> 时间：2009-05-17T20:55:22.503
> 
> 标签：drupal, web, openid, joomla

我正要写一份投标书。解决方案可能是基于 PHP 的 CMS。稍后我可能想要集成一个 ASP.NET 框架并使其看起来像一个站点。

1.  哪些功能会使这相对容易。
2.  OpenId 和类似的东西会有所不同吗？
3.  在 PHP 世界中，Joomla 应该比 Druapal 更具集成性。这里有什么重要的区别？
4.  ASP.NET、Python 或 Ruby 中是否存在比其他框架更易于集成的特定框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T21:05:23.710

我认为最重要的是选择合适的服务器。服务器需要有足够的模块。Apache 将是一个不错的选择，因为它支持您想要的一切，包括 mod_aspnet（我没有测试过，但很多人说它可以工作）。

如果您认为 asp.net 集成肯定会到来，我会选择 Windows 作为操作系统，因为它肯定会更容易。

您还可以安装反向代理，它会根据请求决定哪个服务器呈现内容 - 如果用户请求 aspx 页面，代理将连接到 IIS 和 windows 页面，如果它要求 php，它可以连接到其他服务器。这种方法的问题是共享内存和状态，这可以通过精心设计来解决，以支持这一点——比如保存所有状态信息和模型数据的共享数据库......

OpenID 没有任何区别——您选择的任何框架都有库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:09:50.020

最重要的是将尽可能多的外观以一种可以被任何平台共享的格式。这意味着您应该开发一组标准的 CSS 文件和 (X)HTML 文件，这些文件可以在任何这些平台选项中导入（或直接呈现）。可以将其视为编写一个可以由不同程序加载的动态库。

如果您的所有平台选项都支持，使用 OpenID 进行身份验证会很好，但请记住，每个平台都需要为每个用户存储额外的用户元数据（首选项、上次登录、权限/角色等）还是要在他们之间争吵。OpenID 只解决身份验证问题，而不是授权或偏好问题。

最后，由于有很多选择，我会坚持跨平台解决方案。这将为您留下最多的选择。恕我直言，如果您有可能有一天与其他系统集成或迁移到另一个系统，那么使用 ASP.NET 并没有什么令人信服的优势。

# linq - 如何将 2 个 LINQ 合二为一

> ID：875503
> 
> 赞同：0
> 
> 时间：2009-05-17T21:00:59.930
> 
> 标签：linq

我正在尝试用一些信息填充树视图控件，为此我使用了 2 个单独的 LINQ 语句，如下所示；

```
Dim a = From i In CustomerTable _
        Group By ShipToCustName = i.Item(6), BillToCustName = i.Item(4) Into Details = Group, Count() _
        Order By ShipToCustName

Dim b = From x In a _
        Group By ShipToName = x.ShipToCustName Into Group, Count() _
        Order By ShipToName

For Each item In b
        Console.WriteLine("Shitp To Location: " + item.ShipToName)
        For Each x In item.Group
            Console.WriteLine("...BillTo:" + x.BillToCustName)
            For Each ticket In x.Details
                Console.WriteLine("......TicketNum" + ticket.Item(0).ToString)

            Next
        Next
Next 
```

有没有办法将 A 和 B 组合成一个查询？任何帮助请...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T21:07:54.720

嗯，真的 B 是一个单一的查询。请记住，从 Linq 语句返回的是 IQueryable，而不是实际结果。这意味着 B 将自己的表达式与 A 的表达式组合在一起，但在您枚举 B 之前不会执行检索。所以 B 实际上只是一个单一的查询。

# oop - 物体的形状和结构有什么区别？

> ID：875511
> 
> 赞同：0
> 
> 时间：2009-05-17T21:05:26.347
> 
> 标签：oop, language-agnostic

我看到它在数据上下文中使用了很多。来自 ScottGu 的[帖子](http://weblogs.asp.net/scottgu/archive/2007/04/21/new-orcas-language-feature-query-syntax.aspx)：

> LINQ 和查询语法提供的真正强大的功能之一是能够定义与被查询数据分开的新类，然后使用它们来控制查询返回的数据的形状和结构。

当他提到数据的形状时，他是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T21:10:37.630

我认为这些是非正式的术语，定义是主观的。我会使用“形状”来指代对象如何与系统中的其他对象相适应。（比较“表面积”，这是对对象界面复杂性的粗略（不是双关语：-）度量。）我会使用“结构”来指代对象是如何在内部设计和实现的。

因此，您可以拥有具有良好“形状”但结构像皱纹纸的类。这可能比其他方式更容易重构：形状差，但实现好。（我敢肯定有些人会质疑后者是否可能。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:10:33.667

形状是对象的任何空间属性（尤其是由轮廓定义的），而结构是对象的构造方式及其部分的排列。当然，这可以适用于任何类型的对象。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:13:58.417

将形状视为对象“api”，而结构是它的内部实现。在精心设计的系统中，形状将保持静态，而结构可能会发生显着变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T22:21:21.547

一般来说，我会认为一个类的*形状*是该类提供的公共方法和属性。该结构将是使用的内部构造和表示。在引用材料的上下文中，我认为通过允许使用匿名或备用命名类定义查询的返回类型，您可以重新定义查询返回的数据，约束和转换其原始形状数据源。

例如，假设您有一个与联系人表相关的用户表。使用 LINQ 和匿名类作为选择，您可以返回具有主要联系人对象的用户，而无需定义特定视图；仅使用 LINQ。

```
var userWithContact = from u in db.Users
                      select new
                          { 
                            Name = u.Name,
                            Address = u.Contacts
                                       .Where( c => c.Type = "self" ).First().Address
                          }; 
```

# aop - 面向切面编程（AOP）的缺点是什么？

> ID：875512
> 
> 赞同：26
> 
> 时间：2009-05-17T21:06:49.683
> 
> 标签：aop

面向切面编程的可能和关键缺点是什么？

例如：对新手的神秘调试（可读性影响）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-12-22T17:42:37.027

我认为最大的问题是没有人知道*如何定义方面的语义*，或者*如何以非程序方式声明连接点*。

如果您无法独立于将要嵌入的上下文来定义方面的作用，或者无法以不损害其嵌入的上下文的方式定义它所具有的效果，那么您（和工具) 无法推断它的可靠性。（您会注意到方面最常见的示例是“日志记录”，它被定义为“将一些内容写入应用程序不知道的日志流”，因为这是非常安全的）。这违反了 David Parnas 的[信息隐藏关键概念](http://en.wikipedia.org/wiki/Information_hiding). 我看到的最糟糕的方面示例之一是将同步原语插入代码中的方面。这会影响代码可能具有的交互顺序。你怎么可能知道这是安全的（不会死锁？不会活锁？不会无法保护？面对同步伙伴中抛出的异常可以恢复？）除非应用程序已经只做了一些琐碎的事情。

现在通常通过提供某种标识符通配符来定义连接点（例如，“将此方面放入任何名为“DataBaseAccess*”的方法中。为此，编写受影响方法的人必须表明他们的代码的意图通过以一种有趣的方式命名他们的代码来进行切面化；这几乎不是模块化的。更糟糕的是，为什么切面的受害者甚至必须知道它存在？考虑一下如果你只是重命名一些方法会发生什么；切面不再注入到它的位置需要，你的应用程序会中断。需要的是*有意的连接点规范*; 不知何故，方面必须知道在哪里需要它，而不需要程序员在每个使用点放置霓虹灯。（AspectJ 有一些与控制流相关的连接点，在这方面似乎更好一些）。

所以方面是一种有趣的想法，但我认为它们在技术上还不成熟。这种不成熟使它们的使用变得脆弱。这就是问题所在。（我是自动化软件工程工具的忠实粉丝 [查看我的简历] 只是不是这样）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-17T21:13:49.557

*   较差的工具链支持 - 调试器、分析器等可能不了解 AOP，因此可能在代码上工作，就好像所有方面都已被过程代码取代
*   代码膨胀 - 小源代码可能导致更大的目标代码，因为代码在整个代码库中“编织”

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-17T22:04:53.880

我认为最大的缺点是很好地使用 AOP。例如，人们在它没有意义的地方使用它，并且不会在它有用的地方使用它。

例如，工厂模式显然是 AOP 可以做得更好的东西，DI 也可以做得很好，但是观察者模式在使用 AOP 时更简单，策略模式也是如此。

单元测试会更难，尤其是如果你在运行时进行编织。

如果在运行时编织，那么您也会受到性能影响。

在将 AOP 与类混合时，有一个很好的方法来模拟正在发生的事情是一个问题，因为我认为 UML 在这一点上不是一个好的模型。

除非您使用 Eclipse，否则工具确实会出现问题，但是，使用 Eclipse 和 AJDT AOP 会容易得多。

例如，我们仍然使用 junit 和 nunit，因此必须修改我们的代码以允许运行单元测试，当使用特权模式时，AOP 也可以通过测试私有方法来进行更好的单元测试，而且我们不必只更改程序使它们与单元测试一起工作。这是另一个没有真正理解 AOP 如何有用的例子，我们仍然在许多方面与单元测试框架和当前的设计模式实现联系在一起，并且看不到 AOP 如何帮助我们更好地编码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-17T21:44:44.023

维护和调试。使用 aop，您突然有了在给定点运行的代码（方法入口、退出等），但仅查看代码，您甚至不知道它是否被调用，特别是如果 aop 配置在另一个文件中，如 xml 配置。如果建议引起了一些变化，那么在调试应用程序时，事情可能看起来很奇怪，没有任何解释。这不仅仅影响新手。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T21:15:32.627

我不会称其为严重的劣势，但我看到的最大问题是开发人员的经验和适应能力之一。并非所有开发人员都了解声明式编程和命令式编程之间的区别。

我们非常广泛地使用了 EntLib 4.1 中的[策略注入应用程序块](http://msdn.microsoft.com/en-us/library/cc309507.aspx)以及用于 DI 的[Unity](http://www.codeplex.com/unity)，但对于某些人来说，它并不是很快就会接受的东西。我发现自己一遍又一遍地向同样的人解释为什么应用程序没有按照他们期望的方式运行。它通常开始他们解释一些东西，我说“看到方法上方的声明”。:) 有些人马上就得到它，喜欢它并变得非常高效——其他人则在挣扎。

学习曲线并不是 AOP 独有的，但它似乎比普通开发人员遇到的其他事情具有更高的学习曲线。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T22:12:30.960

关于维护/调试论点，面向方面的编程倾向于与敏捷软件开发实践的所有其他方面齐头并进。

这些实践倾向于从图片中删除调试，取而代之的是单元测试和测试驱动的开发。

此外，与没有建议的大型、难以理解的代码足迹相比，维护一个带有建议的小而清晰的代码足迹可能要容易得多（建议是将一个大的、难以理解的代码足迹转换为一个小的、清晰的代码足迹）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-20T12:12:57.917

因为 AOP 的强大，如果你的横切存在 bug，它可能会导致广泛的问题。另一方面，有人可能会以方面编写者没有预料到的方式更改程序中的连接点——例如，通过重命名或移动方法——从而产生意想不到的后果。模块化横切关注点的一个优点是使一名程序员能够轻松地影响整个系统。

# mysql - 分层 MySQL 资产跟踪的最佳实践

> ID：875520
> 
> 赞同：0
> 
> 时间：2009-05-17T21:13:06.733
> 
> 标签：mysql, database, database-design

我正在编写一个在线项目资产跟踪器，但我是 MySQL 新手。跟踪此类项目、用户和资产的最佳方式是什么？我有 3 个用于资产、用户和项目的表。用户应该拥有项目和资产。资产可以是多个项目的成员，并且项目应该能够被多个用户看到。

我想到的第一种方法是在每个项目上都有一个 mediumtext 字段，其中包含它链接到的每个资产的 id。每个资产也将有一个 mediumtext 将具有它链接到的每个项目 id。这是一个问题，因为我不能真正进行搜索，而不必解析文本以找出它所附加的项目/资产。

另一个无需解析的解决方案是为链接信息设置单独的表，例如，会有一个资产表，其中包含资产 ID、项目 ID 和用户 ID，如果它被分配给另一个项目或用户，该表中将有另一个条目。但是，此解决方案将具有具有多个条目的资产。

另一种方法是让站点在创建项目时创建一个表，该表将存储资产和用户信息。据我所知，由于可能有数千个项目，这将很快挤满数据库，并且在 MySQL 上创建表比条目更重。

我倾向于第二种解决方案。有没有人知道更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T21:24:57.847

引用：

> 在每个项目上都有一个 mediumtext 字段，其中包含它链接到的每个资产的 id

这是最糟糕的设计......也许永远！阅读[数据库关系](http://www.agiledata.org/essays/relationalDatabases.html)。参加紧急[速成班](http://www.oreillynet.com/pub/a/php/2003/12/23/php_foundations.html)。查看一些[示例数据库](http://www.databasedev.co.uk/data_models.html)；MS Access 有一些相当不错的模板，您可以检查一下。

你所描述的看起来可以用这些关系建模：

```
 project --- inf:inf --- users
  asset   --- 1:1     --- users
  asset   --- inf:inf --- projects 
```

多对多关系将放在一个单独的表中。

# ruby-on-rails - 允许用户通过 GET 参数选择命名范围

> ID：875530
> 
> 赞同：0
> 
> 时间：2009-05-17T21:20:07.810
> 
> 标签：ruby-on-rails, search, scope

在我的帖子模型中，我有一个命名范围：

```
named_scope :random, :order => "Random()" 
```

我想让用户能够通过发送 GET 请求以随机顺序获取帖子`params[:scope] = 'random'`。

缺少`eval("Post.#{params[:scope]}")`，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T01:10:17.210

我会推荐我非常棒的acts_as_filter 插件，该插件设计用于通过named_scopes 对结果进行用户驱动的过滤。

[http://github.com/tobyhede/acts_as_filter/tree/master](http://github.com/tobyhede/acts_as_filter/tree/master)

Eval 可以很好地使用 - 但请确保您根据接受/预期的值进行验证（我通常只是将一些值插入数组并测试接受的值。包括？（参数））

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T04:29:23.113

eval 是一个非常糟糕的主意。但是，#send 非常适合这个 - 它本质上比 eval 更安全，更快（据我所知）。

```
Product.send(params[:scope]) 
```

应该这样做:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:32:01.993

我会远离 eval 因为您正在处理来自用户的数据。也许只使用一个简单的案例陈述？通过这种方式，您将能够验证他们提供给您的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-22T04:31:11.190

我在搜索中遇到了它。[searchlogic](http://github.com/binarylogic/searchlogic)非常适合这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T20:36:53.447

对于您给出的示例，我会很明确，并将范围链接在一起以构建您想要的查询：

```
scope = Post
scope = scope.random if params[:scope] == 'random'
@posts = scope.find(:all, ...) # or paginate or whatever you need to do 
```

如果 params[:scope] 不是 'random'，这与调用 Post.find() 相同，否则它正在执行 Post.random.find()

从其他答案之一看来， find_by_filter 会为您做几乎相同的事情。

使用这种模式，如果您需要支持不互斥的事物，您还可以将多个范围组合到查询中，例如

```
scope = scope.only_monsters if params[:just_monsters] == 1    
scope = scope.limit(params[:limit].to_i) unless params[:limit].to_i.zero? 
```

所以 GETting /posts?scope=random&just_monsters=1&limit=5 会给你：

```
Post.random.just_monsters.limit(5).find(:all, ...) 
```

# java - 如何在 Java 中实现这个等式？

> ID：875531
> 
> 赞同：3
> 
> 时间：2009-05-17T21:20:21.537
> 
> 标签：java, algorithm, dynamic-programming, recurrence

好的，这更像是一个后续问题：[如何计算旅行商双调旅行的最佳路径？](https://stackoverflow.com/questions/874982/how-to-compute-optimal-paths-for-traveling-salesman-bitonic-tour)

首先，对于旅行商问题的双调旅行，我有以下递归关系：

```
(a) When i = 1 and j = 2, l(i; j) = dist(pi; pj )
(b) When i < j - 1; l(i; j) = l(i; j - 1) + dist(pj-1; pj)
(c) When i = j - 1 and j > 2, min 1<=k<i (l(k; i) + dist(pk; pj )) 
```

`l`是以前结果的表格。我的问题是 C 部分：假设`l(k,i)`和`dist(pk,pj)`已定义，我将如何在 Java 中实现 C 部分？`k`我最初的想法是我从`1`to迭代`i`并存储 的最小结果`(l(k,i) + dist(pk,pj))`，但我认为这是不对的。

例如：

```
for (int k = 1; k < i; ++k) {
  tmp = l(k,i) + dist(pk,pj);
  if (tmp < min) {
    min = tmp;
  }
}

// min is the result 
```

这似乎是一个愚蠢的问题（可能是，我严重缺乏睡眠），但我希望有人能帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T22:03:43.883

一个明显的优化是`dist(pk,pj)`在循环之前预先计算你的值

例如

```
dist_pk_pj = dist(pk,pj);

/* then do as you did before */
for (int k = 1; k < i; ++k) {
  tmp = l(k,i) + dist_pk_pj;
  if (tmp < min) {
    min = tmp;
  }
} 
```

请注意，我没有对 l 进行类似的优化（如预先计算 l 的表），因为您声明它已经是预先计算的表。如果不是，那么我将执行相同的优化:)

但正如前面的评论所说，Java 编译器可以很好地为您进行优化。我不是 Java 编译器执行哪些优化的专家，所以请对最后一条评论持保留态度:)

最后，该`l(k,i)`表有什么特殊属性吗？例如一些对称性`l(i,k) = l(k,i)`（我只是在这里猜测，因为我对这个问题了解不多，所以如果这听起来很古怪，请忽略此评论）。如果有任何特殊属性发布它们，我们可以提出进一步的优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:37:20.407

我认为 Java 编译器会以它的方式优化你的循环。没关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T22:21:47.630

> ```
> (a) When i = 1 and j = 2, l(i; j) = dist(pi; pj )
> 
> (b) When i < j - 1; l(i; j) = l(i; j - 1) + dist(pj-1; pj)
> 
> (c) When i = j - 1 and j > 2, min 1<=k<i (l(k; i) + dist(pk; pj )) 
> ```

```
import system.math

unsigned long i;

unsigned long j;

if ((i==j-1)&& (j>2))

{

unsigned long k=1;

unsigned long result;

while (k<i)

{

  result = l(k; i) + dist(pk; pj )

  min = minus(min, result);

  k++;

}

return min;

} 
```

# c# - 如何在 aspx 页面中动态获取所有控件（及其 ID）？

> ID：875537
> 
> 赞同：2
> 
> 时间：2009-05-17T21:24:43.727
> 
> 标签：c#, asp.net, visual-studio-2008

您好，我需要根据要执行的服务动态激活页面中的字段...

让我解释：

有一个包含所有可能字段的页面和一个包含所有要执行的选定服务的列表框，然后当用户选择要执行的服务（例如更改车牌）时，我只需要激活字段服务需要...（服务和字段之间的关系存储在数据库中）。

```
public void CheckAll(int pService_Id, Control pPage)
{

    foreach (Control control in pPage.Controls)
    {
        busExecutaServico vExecuta = new busExecutaServico();

        if (vExecuta.EnableField(control.ID.ToString(), Convert.ToInt32(listBoxServices.SelectedValue)))
        {
            switch (control.GetType().ToString())
            {
                case "TextBox":
                    TextBox controleText = (TextBox)Page.FindControl(control.ID.ToString());
                    controleText.Enabled = true;
                    break; 
```

请注意，busExecutaServico 是包含方法 (EnableField) 的类，用于检查所选项目是否与数据库中的任何字段匹配。

我似乎无法让 control.ID.ToString() 正常工作（ID 始终为 NULL）

如果有人可以帮助我解决这个问题，或者如果有另一种方法（即使它与我正在尝试的完全不同），那将有很大帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T23:09:51.680

我喜欢使用递归函数来按类型或 ID 定位控件。

```
public Control FindControlRecursive(Control rootControl, string controlId)
{
    if (rootControl.ID == controlId)
        return rootControl;

    foreach (Control control in rootControl.Controls)
    {
        Control foundControl = FindControlRecursive(control, controlId);
        if (foundControl != null)
        {
            return foundControl;
        }
    }

    return null;
}

public Control FindControlRecursive(Control rootControl, Type type)
{
    if (rootControl.GetType().Equals(type))
        return rootControl;

    foreach (Control control in rootControl.Controls)
    {
        Control foundControl = FindControlRecursive(control, type);
        if (foundControl != null)
        {
            return foundControl;
        }
    }

    return null;
} 
```

您可以调整这些以首先返回一组控件，然后再处理它们。可能更容易跟踪正在发生的事情。

我在这里学到了这种技术：[http ://www.west-wind.com/Weblog/posts/5127.aspx](http://www.west-wind.com/Weblog/posts/5127.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:37:04.697

**除非每个**控件都被赋予了ID，否则您的代码将遇到 ID 为空。

还有为什么要使用：-

```
TextBox controleText = (TextBox)Page.FindControl(control.ID.ToString()); 
```

根本不是：-

```
TextBox controleText = (TextBox)control; 
```

实际上，因为您只想更改 Enabled 属性，请考虑：-

```
((WebControl)control).Enabled = False; 
```

我怀疑这会消除许多案例陈述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:30:57.223

请注意，FindControl 仅搜索当前命名容器，因此 Page.FindControl 将仅查找直接添加到 Page 的控件。例如，如果您有一个转发器控件，其中包含您要查找的控件并将其添加到 Page，您可以通过 Page.FindControl 找到您的转发器控件，但它不会在您的转发器中找到子控件，您将拥有在页面中的所有容器控件上递归执行 FindControl。

这可能看起来有点奇怪，但它允许您在同一页面上拥有具有相同 ID 的控件。例如，如果您有 10 个用户控件实例，其中包含名为“MyName”的文本框，那么您真的希望它们不会覆盖彼此的“MyName”字段！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T21:36:36.180

在您的代码中，您不需要搜索任何控件 - 您已经在“控件”变量中拥有它。您甚至不需要将其转换为 TextBox，只需转换为 WebControl，只需执行以下操作：

```
...
if (vExecuta.EnableField(control.ID.ToString(), Convert.ToInt32(listBoxServices.SelectedValue)))
    ((WebControl)control).Enabled = true; 
```

PS control.ID 已经是字符串，因此您也应该删除任何 ID.ToString() 。

# python - 如何在 Emacs 中为某些内容着色？

> ID：875543
> 
> 赞同：4
> 
> 时间：2009-05-17T21:26:58.700
> 
> 标签：python, django, emacs, syntax-highlighting

我在 emacs 中编写 Django/Python，我希望像 {% comment %} FOO {% endcomment %} 这样的东西变成橙色。

如何为重要的 Django 模板标签设置一些颜色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T22:17:10.497

您可以使用[django-mode](http://code.djangoproject.com/wiki/Emacs)或[MuMaMo](http://www.emacswiki.org/emacs/MuMaMo)等专用模式。

如果您想要一些非常基本的东西，并且假设您正在编辑`html-mode`，您可以尝试以下操作：

```
(defun django-highlight-comments ()
  (interactive "p")
  (highlight-regexp "{%.*?%}" 'hi-orange))
(add-hook 'html-mode-hook 'django-highlight-comments) 
```

（只需将上述行添加到您的`.emacs`or`init.el`中，然后对其进行评估或重新启动 emacs）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T22:23:11.267

这就是我所做的。它比上面的代码更通用一点，它使用了内置的字体锁定机制。

```
(defvar django-tag-face (make-face 'django-tag-face))
(defvar django-variable-face (make-face 'django-variable-face))
(set-face-background 'django-tag-face "Aquamarine")
(set-face-foreground 'django-tag-face "Black")
(set-face-background 'django-variable-face "Plum")
(set-face-foreground 'django-variable-face "Black")

(font-lock-add-keywords
 'html-mode
 '(("\\({%[^%]*%}\\)" 1 django-tag-face prepend)
   ("\\({{[^}]*}}\\)" 1 django-variable-face prepend))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:32:18.827

[这里](http://code.djangoproject.com/wiki/Emacs) [有](http://www.chickenwingsoftware.com/scratches/python/how-i-edit-django-templates) [一些](http://www.chickenwingsoftware.com/scratches/python/more-on-editing-django-templates-in-xemacs) [链接](http://importskynet.blogspot.com/2009/01/some-thoughts-about-django-template.html)。我在谷歌上找到了它们。似乎没有一个完全完整的“官方”解决方案可以解决这个问题，但有一些可能非常有用的替代品可用。

# c++ - 如果#included 有多个.cpp 文件会怎样？

> ID：875553
> 
> 赞同：1
> 
> 时间：2009-05-17T21:35:23.203
> 
> 标签：c++, include

因为我见过（并使用过）这样的情况：

在 header.h 中：

```
class point
{
public:
    point(xpos, ypos);
    int x;
    int y;
}; 
```

在 def.cpp 中：

```
#include"header.h"
point::point(xpos, ypos)
{
    x = xpos;
    y = ypos;
} 
```

在 main.cpp 中：

```
#include"header.h"
int main()
{
    point p1(5,6);
    return 0;
} 
```

我知道程序从 main 执行，但是编译器如何知道编译 .cpp 文件的顺序？（特别是如果有多个非主 .cpp 文件）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T21:40:24.470

**编译器**不在乎- 它将每个 .cpp 文件编译成 .obj 文件，每个 .obj 文件都包含一个缺失符号的列表。所以在这种情况下， main.obj 说“我失踪了`point::point`”。

然后**链接器**的工作就是获取所有 .obj 文件，将它们组合成一个可执行文件，并确保每个 .obj 文件的缺失符号可从其他 .obj 文件之一中获得——因此称为“链接器”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T21:40:23.953

如果将它们包含在两个不同的 cpp 文件中，那没问题。如果两次包含相同的标题，则会出现重复定义的错误。

您应该使用包含警卫来规避这一点。

在您的文件顶部，在任何代码之前：

```
#ifndef HEADER_H_ //every header gets it's own name
#define HEADER_H_ 
```

在底部：

```
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T21:39:19.120

编译顺序无关紧要。一切都由编译器编译，它使用 .h 文件来确保至少声明了您使用的符号。这是链接器的工作，它在编译器完成后执行，将您的方法调用实际匹配到它们的实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T21:46:35.890

编译器不需要知道编译 .cpp 文件的顺序。

链接器将所有单独编译的 .o（从 .cpp 构建）文件排序出来，并将所有内容解析为一个可执行文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T21:38:04.490

通常你自己单独编译它们（或使用类似的构建工具`make`）。头文件允许您以任何顺序编译它们。如果您确实将它们编译在一起，则顺序可能是您传递给编译器命令的顺序，但这实际上并不重要，它们最终都链接到一个可执行文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T21:53:45.203

这是图论应用的一个例子。编译后的模块包含所有代码块的相对偏移量，并由链接器在构建可执行文件时发现依赖关系（图）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-17T21:41:59.503

这就是为什么您会在一些头文件的顶部看到#ifndef HEADER_H 和#define HEADER_H。例如，[此处描述](http://www.fredosaurus.com/notes-cpp/preprocessor/ifdef.html)的每个头文件仅包含一个的概念。

# c# - Graphics.CopyFromScreen 返回黑屏

> ID：875563
> 
> 赞同：0
> 
> 时间：2009-05-17T21:39:25.300
> 
> 标签：c#, .net, screenshot

我有一个小应用程序，它拍摄屏幕截图并将它们保存到它所在的文件夹中。它大部分时间都可以正常工作，但在某些情况下，例如在 Team Fortress 2 中或在 OpenGL 模式下运行魔兽争霸 3 时，它只会返回一个完全黑色（或白色）的图像。有没有人有办法解决这个问题？

我正在使用 c# 标准：

```
Bitmap bmp;
Graphics gfx;
bmp = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb);
gfx = Graphics.FromImage(bmpScreenshot);
gfx.CopyFromScreen(Screen.PrimaryScreen.Bounds.X, Screen.PrimaryScreen.Bounds.Y, 0, 0, Screen.PrimaryScreen.Bounds.Size, CopyPixelOperation.SourceCopy);
bmpScreenshot.Save("image.jpg", ImageFormat.Jpeg); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T21:47:14.797

Windows 屏幕截图功能不会从 DirectX 表面复制数据。您必须像[本文](http://www.mvps.org/vbdx/articles/screenshot/index.html)中描述的那样手动执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:46:39.353

我理解这是因为您的显卡覆盖了这些类型的图形。这也是为什么您可能也无法抓取显示视频的屏幕片段的原因。

控制面板 --> 显示属性 --> 设置 --> 高级 --> 疑难解答

我认为那里有一个选项可以减少硬件加速，这应该可以让你抓住它们。

我知道我必须这样做才能从视频中抓取屏幕截图，希望这对您的 opengl 内容有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T21:45:05.037

您假设屏幕`PixelFormat.Format32bppArgb`可能并非总是如此，但我不知道这是否与其他答案相关。

如果相关，您可以尝试`Screen.PrimaryScreen.BitsPerPixel`获取屏幕的深度。我没有尝试过，所以我不知道它是否有效。

# c++ - 如何在 C++ 中引用“所有者类”？

> ID：875578
> 
> 赞同：1
> 
> 时间：2009-05-17T21:50:18.487
> 
> 标签：c++, class, this

我的代码如下所示：

```
template<class T>
class list
{
public:
    class iterator;
};

template<class T>
class list::iterator
{
public:
    iterator();
protected:
    list* lstptr;
};

list<T>::iterator::iterator()
{
    //???
} 
```

我想让构造函数`list::iterator`指向`iterator::lstptr`它调用的列表。IE：

```
list xlst;
xlst::iterator xitr;
//xitr.lstptr = xlst 
```

我该怎么做？

而且，我是否正确引用了我的迭代器构造函数，或者我应该做这样的事情：

```
template<class T>
class list<T>::iterator
{
public:
    list<T>::iterator();
protected:
    list* lstptr;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T21:54:29.973

您可以将列表传递给迭代器的构造函数：

```
list xlst;
list::iterator xitr(xlst); 
```

或者，您可以创建一个迭代器工厂函数：

```
list xlst;
list::iterator xitr = xlst.create_iter(); 
```

在工厂函数情况下，`create_iter()`函数可以`this`用来引用封闭列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:20:32.593

由于您不需要更改（重新安装）指针并且不需要 NULL 值，因此我将改为使用引用。您也可以在分配成员变量时使用初始化列表（如果您使用引用，则必须这样做）。

```
template<class T>
class list::iterator
{
public:
    iterator( list& parent ) : lstptr( parent ){}

protected:
    list& lstptr;
}; 
```

并且如前所述：使用 list 类中的工厂方法来构造 list::iterator 类型的对象。

# search - Wolfram Alpha 在编程中的用途

> ID：875580
> 
> 赞同：3
> 
> 时间：2009-05-17T21:52:55.313
> 
> 标签：search, reference, wolframalpha

现在[Wolfram Alpha](http://www.wolframalpha.com/)发布了，我很想知道它是否可以在日常编程中用作节省时间的工具。

你会用 Wolfram Alpha 做什么，之前需要更多时间手动完成？

我想[“Web 和计算机系统”示例](http://www.wolframalpha.com/examples/WebAndComputerSystems.html)是一个好的开始，但必须有更多隐藏的宝石对我们程序员来说真正实用。

一个简短的示例列表：

*   [MD5 哈希](http://www41.wolframalpha.com/input/?i=MD5+%22A+quick+brown+fox+jumps+over+the+lazy+dog.%22)/ [SHA 哈希](http://www41.wolframalpha.com/input/?i=SHA1+%22A+quick+brown+fox+jumps+over+the+lazy+dog.%22)
*   [快速锁定符号的 unicode 和 HTML 代码](http://www43.wolframalpha.com/input/?i=dash&a=%2AC.dash-_%2ACharacter-)
*   [颜色代码](http://www43.wolframalpha.com/input/?i=HTMLgreen)

**请在每个答案中仅包含一个搜索查询，然后我们可以对它们进行评分以将最佳答案排在首位。**

*（我把这个做成了一个社区维基，因为我们将使用投票来进行排名）*

***注意：****如果答案中的某些链接不起作用（例如：wolfram 未找到任何结果，则将所有 + 替换为空格..*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T21:55:45.197

我可能会“节省时间”，而不是玩弄它，而是做真正的工作。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T21:59:07.140

计算 NACA 剖面的升力系数（[示例](http://www80.wolframalpha.com/input/?i=NACA+2214+airfoil)）。

（我为此做了一个程序，但很高兴可以选择快速完成）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T11:25:42.580

这可能会在以后困扰我，但让我感到震惊的是，虽然可能以机械方式使用 WA，但从我的角度来看，我认为这不是难以计算的信息问题，而是需要解决的问题解决了，是软人类数据无法分类或刚性建模。Google 似乎明白这一点，但不确定 Stephen Wolfram 是否明白。

OTOH，现在任何人都可以成为[Colin Laney](http://everything2.com/title/Colin%2520Laney)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T00:52:56.067

我可能不会用它来做任何事情。我不了解你，但我每天要处理足够多的黑匣子，我宁愿使用那些经过充分尝试和测试的黑匣子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T00:19:14.027

有人在这里仔细检查我：“Wolfram Alpha”（无引号）的 MD5 哈希是：882b 0be2 79eb 7e88 86cd 3dae 19c1 d267 而不是：a615 9984 9aee b7be 3091 68bc 0ab7？

编辑：每次给出相同的查询时，哈希都会改变......这是什么类型的哈希？ [http://www14.wolframalpha.com/input/?i=MD5%22Wolfram+Alpha%22](http://www14.wolframalpha.com/input/?i=MD5%22Wolfram+Alpha%22)

# vb.net - 我可以在 VB.NET 中为 IEnumerable 函数实现收益返回吗？

> ID：875587
> 
> 赞同：9
> 
> 时间：2009-05-17T21:55:56.180
> 
> 标签：vb.net, ienumerable, iterator, yield-return

> **可能的重复：**
> [VB.NET 中的 Yield](https://stackoverflow.com/questions/97381/yield-in-vb-net)

在 C# 中，当编写一个返回 的函数时`IEnumerble<>`，您可以使用它`yield return`来返回枚举的单个项目并`yield break;`表示没有剩余项目。做同样事情的 VB.NET 语法是什么？

[来自NerdDinner](http://nerddinnerbook.s3.amazonaws.com/Part3.htm)代码的示例：

```
public IEnumerable<RuleViolation> GetRuleViolations() {

   if (String.IsNullOrEmpty(Title))
       yield return new RuleViolation("Title required","Title");

   if (String.IsNullOrEmpty(Description))
       yield return new RuleViolation("Description required","Description");

   if (String.IsNullOrEmpty(HostedBy))
       yield return new RuleViolation("HostedBy required", "HostedBy");

   if (String.IsNullOrEmpty(Address))
       yield return new RuleViolation("Address required", "Address");

   if (String.IsNullOrEmpty(Country))
       yield return new RuleViolation("Country required", "Country");

   if (String.IsNullOrEmpty(ContactPhone))
       yield return new RuleViolation("Phone# required", "ContactPhone");

   if (!PhoneValidator.IsValidNumber(ContactPhone, Country))
       yield return new RuleViolation("Phone# does not match country", "ContactPhone");

   yield break;
} 
```

此[将 C# 转换为 VB.NET 工具](http://www.developerfusion.com/tools/convert/csharp-to-vb/)会给出“不支持 YieldStatement”错误。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-17T22:12:49.540

从语言语法级别来看，目前在 VB.Net 中没有等效于 C# 的 yield return。

然而，Bill McCarthy 最近在 MSDN 杂志上发表了一篇关于如何在 VB.Net 9.0 中实现类似模式的文章

*   [http://visualstudiomagazine.com/articles/2009/02/01/use-iterators-in-vb-now.aspx](http://visualstudiomagazine.com/articles/2009/02/01/use-iterators-in-vb-now.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-05-05T14:37:38.047

新的[Async CTP](http://msdn.microsoft.com/en-us/vstudio/async.aspx)包括对`Yield`VB.NET 的支持。

有关用法的信息，请参阅[Visual Basic 中的迭代器。](http://msdn.microsoft.com/en-us/vstudio/gg497937)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T22:26:50.257

在这里查看我的答案：

*   [VB.NET 中的产量](https://stackoverflow.com/questions/97381/yield-in-vb-net)
*   [VB.NET 中的迭代器模式（C# 将使用 yield！）](https://stackoverflow.com/questions/250874/iterator-pattern-vb-net-c-would-use-yield)

总结一下：
VB.Net 没有 yield，但 C# 通过将代码转换为幕后的状态机来实现 yield。VB.Net 的`Static`关键字还允许您在函数中存储状态，因此理论上您应该能够实现一个类，该类允许您在用作方法的`Static`成员时编写类似的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T22:00:37.213

在 VB.NET 中没有收益返回 :( 只需创建一个列表并返回它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T22:34:04.293

在幕后，编译器创建一个枚举器类来完成这项工作。由于 VB.NET 没有实现这种模式，因此您必须创建自己的 IEnumerator(Of T) 实现

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-02T09:52:49.393

下面给出输出：2、4、8、16、32

在 VB 中，

```
Public Shared Function setofNumbers() As Integer()

    Dim counter As Integer = 0
    Dim results As New List(Of Integer)
    Dim result As Integer = 1
    While counter < 5
        result = result * 2
        results.Add(result)
        counter += 1
    End While
    Return results.ToArray()
End Function

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    For Each i As Integer In setofNumbers()
        MessageBox.Show(i)
    Next
End Sub 
```

在 C# 中

```
 private void Form1_Load(object sender, EventArgs e)
    {
        foreach (int i in setofNumbers())
        {
            MessageBox.Show(i.ToString());
        }
    }

    public static IEnumerable<int> setofNumbers()
    {
        int counter=0;
        //List<int> results = new List<int>();
        int result=1;
        while (counter < 5)
        {
          result = result * 2;
          counter += 1;
          yield return result;
        }
    } 
```

# .net - 连接池与什么相关联？

> ID：875589
> 
> 赞同：4
> 
> 时间：2009-05-17T21:57:02.387
> 
> 标签：.net, connection-pooling

我正在阅读.net 中的连接池，但我不确定我是否正确。他们说关闭的连接会返回到池中，以便以后可以重用。但是池与什么相关联？它是数据库还是只是应用程序环境（执行它的计算机）？如果是后者，那么如果您有两个用户在两台不同的计算机上打开他们的应用程序并一个接一个地请求相同的连接，那么连接池并没有什么不同，对吗？

编辑：当然我知道如果同一个应用再次打开同一个连接会有所不同，但是同一个应用的两个不同实例呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T22:00:41.737

连接池仅限于客户端 PC，并与连接字符串和身份验证详细信息相关联。

因此，如果连接关闭并返回到池中，则只有在连接字符串和身份验证详细信息完全匹配时才会重用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T22:06:46.903

连接池只是客户端的一个集合，当您第一次尝试打开与数据库的连接时，它会充满连接。如果您使用完连接对象，它不会被释放，而是返回到可用连接的集合中。

这样可以提高性能，因为打开和关闭数据库连接可能非常昂贵（考虑建立连接所需的网络流量）。

这是关于该主题的一个很好的启动教程：

[http://www.eggheadcafe.com/tutorials/aspnet/df2b05d8-93ea-49e1-aeaa-d116a4d6ac3b/adonet-connection-poolin.aspx](http://www.eggheadcafe.com/tutorials/aspnet/df2b05d8-93ea-49e1-aeaa-d116a4d6ac3b/adonet-connection-poolin.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T21:42:29.993

ConnectionPoolCollection 实际上是一个包含 ConnectionPool 对象的单例对象。

您可以通过反射 DbConnection 上的静态函数来测试这一点，以清除单个池或清除所有池。

[ClearAllPools](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearallpools(VS.80).aspx) - 从 SQL Server 中的 DbConnection 清除所有池。

由于该对象是一个单例，它不能跨进程边界工作。您最终将得到每个进程一个池。

有一些 ADO.NET 提供程序可以通过使用 COM 对象保存实例引用跨应用程序进程进行池化，但大多数不这样做。

# ruby-on-rails - What are some good role authorization solutions used with Authlogic?

> ID：875595
> 
> 赞同：6
> 
> 时间：2009-05-17T21:59:13.613
> 
> 标签：ruby-on-rails, ruby, authorization, roles

I am looking for a good role based authorization solution to use alongside Authlogic. Anyone have any good suggestions? Please list some pros and cons from your experience if possible please.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T04:36:31.620

At RailsConf, I saw a lightning talk on Lockdown and was very impressed. Anyone with a modest amount of db and rails experience can roll their own ACL system, but Lockdown looks nice because it tries to keep the permission stuff out of the way.

[http://lockdown.rubyforge.org/](http://lockdown.rubyforge.org/)

I had used role_requirement previously but I didn't dig it.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T19:35:45.727

Acl9 works great with AuthLogic:

[http://github.com/be9/acl9/tree/master](http://github.com/be9/acl9/tree/master)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-17T09:12:44.553

I have recently have been using a gem called easy_roles. Super light weight and super easy to use. It's also flexible enough for you to implement your own controller security etc etc.

[http://github.com/platform45/easy_roles](http://github.com/platform45/easy_roles)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-06T15:17:47.447

Check out [http://blog.platform45.com/2009/10/05/howto-basic-roles-for-users](http://blog.platform45.com/2009/10/05/howto-basic-roles-for-users) for basic role requirement, works with restful_authentication and authlogic..

It's really simple, fast and lightweight.

# java - 将时间/数据时间/数据转换为 java.util.Calendar？

> ID：875596
> 
> 赞同：1
> 
> 时间：2009-05-17T21:59:38.463
> 
> 标签：java, ruby, calendar, timezone, jruby

是否可以以简单的方式将 JRuby Time/DataTime/Data 转换为 java.util.Calendar，包括时区？

在#jruby 上，我得到了这样的代码`cal.set_time_in_millis(time.to_i)`，但我在中间丢失了有关时区的信息。所以更具体的问题是如何转换时区，但我更愿意问更广泛的问题，以防有更简单的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-23T19:00:26.627

您可以使用 #to_java 方法将 Ruby 时间对象转换为 java.util.Date：

```
require 'java'
Time.now.to_java 
```

请注意，当将 Ruby 对象传递给 Java 方法时，这种强制转换会自动发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T19:25:15.827

我知道时间不存储时区，所以返回的`Time.now.zone`是本地时区。

因此很容易转换为`java.util.Data`：

```
data = java.util.Date.new(date.to_i*1000) 
```

# javascript - Greasemonkey 和 Gmail - 解析邮件内容

> ID：875600
> 
> 赞同：1
> 
> 时间：2009-05-17T22:00:56.823
> 
> 标签：javascript, gmail, greasemonkey

我想阅读 Gmail 邮件的内容并在链接上添加一些花哨的东西。这是一些代码：

```
unsafeWindow.gmonkey.load("1.0", function(gmail){
  gmail.registerViewChangeCallback(function(){
    if (gmail.getActiveViewType && gmail.getActiveViewType() == "cv") {
      var viewElement = gmail.getActiveViewElement()
      // Do things with viewElement
    }
  })
}) 
```

邮件的 dom 对象中的链接的实际检测是容易的部分。问题是`registerViewChangeCallback`只有在显示线程时才会运行。大线程将隐藏大部分消息，仅由用户请求加载。我还没有找到用于此特定操作（加载单个消息）的 Gmail greasemonkey API 方法，这是我需要运行我的脚本的时候。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-18T03:55:40.363

正如您所说，[registerViewChangeCallback()](http://code.google.com/p/gmail-greasemonkey/wiki/GmailGreasemonkey10API)函数仅在用户将其视图从例如线程更改为档案等时触发。

您真正需要的是添加一个拦截 gmail 回发然后更改链接的功能。我从来没有尝试过自己做，但是[这个答案](https://stackoverflow.com/questions/629671/how-can-i-intercept-xmlhttprequests-from-a-greasemonkey-script/629782#629782)有一些示例代码给你。当 gmail 检索到一条新消息时，它会触发一个`readystatechange`事件，您的代码可以拦截该事件。然后，您可以以任何您希望的方式更改消息的内容（尽管您可能需要等待片刻才能让 gmail 先插入消息 - 不确定那个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-16T00:58:21.587

我想你会发现一些消息在线程中列出时已加载；因此你的问题。

你为什么不直接使用自定义样式呢？UserStyles FF 插件。

# python - ZODB 3 中的持久集

> ID：875607
> 
> 赞同：3
> 
> 时间：2009-05-17T22:07:09.367
> 
> 标签：python, set, zodb

ZODB 提供 a`PersistentList`和 a `PersistentMapping`，但我想要一个`PersistentSet`. 我写了一个快速类，它反映了[`PersistentList`](http://sysinf0.klabs.be/usr/share/zope2.7/lib/python/ZODB/PersistentList.py?f=view)ZODB 2 中的古代。因为`UserSet`在 Python 中没有，我不得不从基于 C 的内置`set`.

```
class PersistentSet(UserSet, Persistent):
    def __iand__(self, other):
        set.__iand__(other)
        self._p_changed = 1

    ...

    ...

    ...

    def symmetric_difference_update(self, other):
        set.symmetric_difference_update(other)
        self._p_changed = 1 
```

该代码产生了“多个基地有实例布局冲突”[错误](https://stackoverflow.com/questions/309129/why-cant-i-inherit-from-dict-and-exception-in-python)。我尝试在 周围创建一个`UserSet`包装器`set`，但这也没有解决问题。

```
class UserSet(set):
    def __init__(self):
        self.value = set
    def __getattribute__(self, name):
        return self.value.__getattribute__(name 
```

最后，我导入`sets.Set`了（被内置的 取代`set`），但这似乎也是在 C 中实现的。我没有在 PyPI 上找到任何集合实现，所以我现在处于死胡同。

**我有哪些选择？** 我可能不得不从头开始实现一个集合，或者使用`UserDict`并丢弃所有的`value`s.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-11T18:30:34.303

为什么不使用 ZODB 中的[BTree](http://www.zodb.org/documentation/guide/modules.html#btrees-package)库提供的持久集类。有 4 个这样的类可用。IITreeSet 和 IOTreeSet 管理整数集，而 OITreeSet 和 OOTreeSet 管理任意对象集。它们分别对应四个BTree类IIBTree、IOBTree、OIBTree和OOBTree。它们相对于 Python 中内置的集合实现的优势在于它们的快速查找机制（感谢底层 BTree）和它们的持久性支持。

这是一些示例代码：

```
>>> from BTrees.IIBTree import IITreeSet, union, intersection
>>> a = IITreeSet([1,2,3])
>>> a
<BTrees._IIBTree.IITreeSet object at 0x00B3FF18>
>>> b = IITreeSet([4,3,2])
>>> list(a)
[1, 2, 3]
>>> list(b)
[2, 3, 4]
>>> union(a,b)
IISet([1, 2, 3, 4])
>>> intersection(a,b)
IISet([2, 3]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T05:51:30.620

将所有属性请求转发到内部集：

```
class PersistentSet(Persistent):
    def __init__(self):
        self.inner_set = set()

    def __getattribute__(self, name):
        try:
            inner_set = Persistent.__getattribute__(self, "inner_set")
            output = getattr(inner_set, name)
        except AttributeError:
            output = Persistent.__getattribute__(self, name)

        return output 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-26T12:12:25.890

对于未来的阅读，我只想对已经提出的答案稍作改进......

**自定义持久集类**

```
class PersistentSet(Persistent):

    def __init__(self, *args, **kwargs):
        self._set = set(*args, **kwargs)

    def __getattr__(self, name):
        return getattr(self._set, name) 
```

**库中的持久集类**

```
from BTrees.OOBTree import OOSet 
```

* * *

*也可以看看*

*   [**（双星）和*（星）对参数有什么作用？](https://stackoverflow.com/questions/36901/what-does-double-star-and-star-do-for-python-parameters)
*   [__getattr__ 与 __getattribute__ 之间的区别](https://stackoverflow.com/questions/3278077/difference-between-getattr-vs-getattribute)
*   [http://docs.zope.org/zope3/Code/BTrees/OOBTree/OOSet.1](http://docs.zope.org/zope3/Code/BTrees/OOBTree/OOSet.1)

# windows - 如何在插入模式下更改 Vim 文本指针大小？

> ID：875609
> 
> 赞同：4
> 
> 时间：2009-05-17T22:08:21.533
> 
> 标签：windows, vim, text-cursor

有谁知道如何在插入模式下更改 gVim 中文本指针的粗细？我在 Windows 上使用它，所以也许有一个 Windows 技巧可以完成这项工作。

现在它大约 3px 宽，而我想要它 1px 宽。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T22:25:33.050

查看 :help gcr 了解完整详情。您可能想要编辑现有设置，但这对我有用：

```
set gcr=...,i-ci:ver10-Cursor/lCursor,... 
```

... 表示之前存在的值，用于其他模式。

# javascript - 如何在 IE 中复制内联样式元素？

> ID：875610
> 
> 赞同：4
> 
> 时间：2009-05-17T22:08:37.693
> 
> 标签：javascript, internet-explorer, dom

IE 不允许写入 style 或 head 元素的 innerHTML 属性。那么如何将样式元素从一个文档的头部复制到另一个文档呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T22:16:21.920

```
function copy_style(src_style_tag) {    
    var tmp_div = document.createElement('div');
    var innerHTML = src_style_tag.innerHTML;
    tmp_div.innerHTML = '<p>x</p><style type="text/css">' + innerHTML + '</style>';

    return tmp_div.getElementsByTagName('style')[0];
} 
```

`<p>`神奇`innerHTML`的是你需要`tmp_div`. 没有它，IE 不接受样式元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T22:12:48.480

如果要复制一些元素，请尝试将[Node.cloneNode(true)](https://developer.mozilla.org/En/DOM/Node.cloneNode)与[Node.appendChild一起使用](https://developer.mozilla.org/En/DOM/Node.appendChild)

# unit-testing - 是否有一个 UI 单元测试框架可以测试与模式对话框的交互（通过 showModalDialog）？

> ID：875611
> 
> 赞同：1
> 
> 时间：2009-05-17T22:08:44.620
> 
> 标签：unit-testing, user-interface, modal-dialog

我正在尝试在我的 ASP.NET 站点的页面之间进行一些单元/集成测试，但似乎找不到任何可以有效处理`showModalDialog`命令生成的模式对话框的工具（[FF3](https://developer.mozilla.org/En/DOM/Window.showModalDialog)，[IE](https://developer.mozilla.org/En/DOM/Window.showModalDialog)）。

有没有人有测试这些烦人的东西的经验？

* * *

**更新：** @bbmud 是对的——WatiN 非常支持模态对话框。这是让我开始[的例子。](http://www.teknologika.com/blog/modal-dialogs-and-dropdowns-in-watin/)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T22:23:06.177

您是否绑定到任何特定平台？根据您的问题和答案，我猜是 C#/.NET ;)

[WatiN](http://watin.sourceforge.net/index.html)对 IE 中的模态和非模态对话框有很好的支持，但我不确定它是否适用于 FF3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T23:32:38.520

如果您正在寻找免费的东西，我会支持 WatiN。

# mysql - 多行表上的 MySQL 速度优化：处理它的最佳方法是什么？

> ID：875616
> 
> 赞同：0
> 
> 时间：2009-05-17T22:10:16.333
> 
> 标签：mysql, optimization

我正在开发一个聊天应用程序。我想将所有内容都记录到一个表中（即“谁说了什么以及什么时候说的”）。我希望在不久的将来我会有数千行。我想知道：优化表格的最佳方法是什么，我知道我会经常插入行，有时会进行分组阅读（即显示用户的整个对话（看看他/她何时登录/开始聊天，然后看看当他/她退出时，显示整个对话））。

该表应该能够处理（我希望！）很多行。（15000 / 天 => 4,5 M 每月 => 54 M 行在年底）。

超过 15 天的对话可以被历史化（但我不知道我应该如何做才能正确）。

任何的想法 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T22:27:00.333

我有两个建议给你：

1.  如果您期望大量写入很少有低优先级读取。那么你最好使用尽可能少的索引。索引会使插入速度变慢。只添加你真正需要的。
2.  如果日志表将变得越来越大，您应该考虑日志轮换。否则你可能会得到一个巨大的损坏表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T22:45:07.777

Mysql 在处理非常大的数据集方面做得非常好，只需要标准的数据库调优和索引。我运行了一个在数据库中有数百万行的站点，并且能够在 mysql 上运行它。

Mysql 确实有一个用于处理多行的[“归档”表引擎选项](http://dev.mysql.com/doc/refman/5.4/en/archive-storage-engine.html)，但是缺少索引支持将使它不是一个很好的选择，除非是历史数据。

将需要创建索引，但您必须平衡它们，而不仅仅是创建它们，因为您可以。它们将允许更快的查询（并且需要对这么大的表进行可用查询），但是您拥有的索引越多，插入的成本就越高。

如果您只是在“用户”id 列上查询，那么索引不会有问题，但如果您希望对消息进行全文查询，您可能需要考虑只在 mysql 中索引用户列和使用[sphynx](http://www.sphinxsearch.com/)或[lucene](http://lucene.apache.org/java/docs/)之类的东西进行全文搜索，因为 mysql 中的全文搜索不是最快的，而且会显着减慢插入时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T23:52:36.803

5400 万行并不多，尤其是一年多。

如果您要定期轮换大量数据，我建议使用 MyISAM 和 MERGE 表。由于您不会删除或编辑记录，因此只要将并发设置为 1，就不会出现任何锁定问题。插入将始终添加到表的末尾，因此 SELECT 和 INSERT 可以同时发生。所以你不必使用基于 InnoDB 的表（可以使用 MERGE 表）。

您每月可以有 1 个表，命名为 data200905、data200904 等。您的合并表将包括您需要搜索的所有基础表。插入是在合并表上完成的，因此您不必担心更改名称。当需要轮换数据并创建新表时，只需重新声明 MERGE 表。

您甚至可以根据季度、年份等创建多个 MERGE 表。一个表可以在多个 MERGE 表中使用。

我已经在每月添加 3000 万条记录的数据库上完成了此设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T23:41:00.030

您可以使用两张表来处理这个问题——一张用于当前聊天历史记录，一张用于存档表。在一段时间（一周、一个月或一天，具体取决于您的流量）结束时，您可以归档当前聊天消息，将它们从小表中删除并将它们添加到归档中。

这样，您的应用程序将能够很好地处理最常见的情况——查询当前聊天状态，这将非常快。

对于诸如“x 上个月说了什么”之类的查询，您将查询存档表，这将需要更长的时间，但这没关系，因为不会有那么多这样的查询，如果有人确实像这样搜索，他愿意再等几秒钟。

根据您的用例，您可以扩展此原则 - 如果在过去 6 个月内有很多聊天消息查询 - 也将它们存储在单独的表中。

.NET 垃圾收集器使用类似的原理（对于完全不同的区域），它对短寿命对象、长寿命对象、大对象等具有不同的存储空间。

# stored-procedures - 我应该删除存储过程帐户以级联到 FK 表吗？

> ID：875620
> 
> 赞同：1
> 
> 时间：2009-05-17T22:11:32.133
> 
> 标签：stored-procedures

假设我有一个员工表（PK 是员工 ID）和一个销售表，其中销售表有一个用于员工 ID 的 FK 列。

现在在设计我的 deleteEmployee 存储过程时，我应该先删除 Sales 表中的行，还是应该创建单独的存储过程以在每个表中删除，然后在我的业务逻辑层担心？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T22:14:50.097

不不不。

在 Employee 表中添加一个名为“OutServiceDt”的字段，并存储他们离开公司的日期。

这样你就可以保存他们的销售记录、他们的地址信息以及你所拥有的任何其他信息:)

如果您正在寻找在职的员工，请过滤“OutServiceDt 为空”。

# c# - 是否有一种简单的方法来比较 2 个 XDocuments 是否相等而忽略元素/属性顺序？

> ID：875625
> 
> 赞同：21
> 
> 时间：2009-05-17T22:13:59.803
> 
> 标签：c#, xml, linq-to-xml

对我的序列化代码进行单元测试，我发现一个失败，因为我的属性以不同的顺序列出（我只是比较 XDocument.ToString() 值），虽然我可以解决这个问题，但按什么顺序对我来说并不重要只要元素或属性都在正确的层次结构中以正确的名称出现，它们就会出现。我可能可以编写一个方法来做到这一点，但我想知道是否有一种我不知道的简单内置方式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T23:12:07.557

XNode 有一个 DeepEquals 函数应该可以解决问题。

[http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.deepequals.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.deepequals.aspx)

更新：

DeepEquals 函数似乎并不总是正常工作。您最好实施自己的比较例程。

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=400469](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=400469)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-26T10:38:12.407

除了“亚当露丝”，我还阅读了微软链接，这篇博文非常有用。

埃里克怀特：http: [//blogs.msdn.com/b/ericwhite/archive/2009/01/28/equality-semantics-of-linq-to-xml-trees.aspx](http://blogs.msdn.com/b/ericwhite/archive/2009/01/28/equality-semantics-of-linq-to-xml-trees.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T19:43:16.867

[在此处](http://msdn.microsoft.com/en-us/library/aa302294.aspx)尝试 Microsoft XML Diff 和补丁实用程序 或谷歌“Xml Diff”

# php - 在 Ajax 响应回调中获取 json

> ID：875630
> 
> 赞同：7
> 
> 时间：2009-05-17T22:17:56.407
> 
> 标签：php, javascript, ajax, prototypejs

我正在尝试创建一个小的 ajax 聊天系统（只是为了它），我正在使用prototype.js 来处理 ajax 部分。

我在帮助中读到的一件事是，如果您返回 json 数据，回调函数将在第二个参数中填充该 json 数据。

所以在我被调用的 php 文件中，我有：

```
header('Content-type: application/json');

if (($response = $acs_ajch_sql->postmsg($acs_ajch_msg,$acs_ajch_username,$acs_ajch_channel,$acs_ajch_ts_client)) === true)
    echo json_encode(array('lastid' => $acs_ajch_sql->msgid));
else
    echo json_encode(array('error' => $response)); 
```

在 ajax 请求中，我有：

```
onSuccess: function (response,json) {
                alert(response.responseText);
                alert(json);    
            } 
```

response.responseText 的警报给了我 {"lastid": 8 } 但 json 给了我 null。

任何人都知道我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-17T22:24:43.740

[这是使用 Prototype 检索 JSON](http://www.prototypejs.org/learn/json)的正确语法

```
onSuccess: function(response){
   var json = response.responseText.evalJSON();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T22:16:08.073

有一个 Response: Response.responseJSON 属性，只有当后端返回 Content-Type: application/json 时才填充 JSON 对象，即，如果您在后端代码中执行以下操作：

```
$this->output->set_content_type('application/json');
$this->output->set_output(json_encode($answer));
//this is within a Codeigniter controller 
```

在这种情况下 Response.responseJSON != undefined 您可以在 onSuccess(t) 处理程序中检查接收端：

```
onSuccess:function(t) {
  if (t.responseJSON != undefined) 
  {
    // backend sent some JSON content (maybe with error messages?)
  }
  else 
  {
    // backend sent some text/html, let's say content for my target DIV
  }
} 
```

我并没有真正回答有关处理程序的第二个参数的问题，但如果它确实存在，那么 Prototype 肯定只会在响应的内容类型正确的情况下提供它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-03T15:21:02.480

这来自原型官方：

> 评估 JavaScript 响应 有时应用程序被设计为发送 JavaScript 代码作为响应。如果响应的内容类型与 JavaScript 的 MIME 类型匹配，则为真，Prototype 将自动 eval() 返回代码。如果不需要，则不需要显式处理响应。
> 
> 或者，如果响应包含 X-JSON 标头，则其内容将被解析，保存为对象并作为第二个参数发送到回调：
> 
> new Ajax.Request('/some_url', { method:'get', onSuccess: function(transport, json){
> 
> ```
>  alert(json ? Object.inspect(json) : "no JSON object");
> 
> } 
> ```
> 
> });
> 
> 当您想要使用 Ajax 获取重要数据但想要避免解析 XML 响应的开销时，请使用此功能。JSON 比 XML 快得多（也更轻量）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T22:55:40.780

您也可以跳过框架。这是一种跨浏览器兼容的 ajax 方式，用于评论小部件：

```
//从服务器获取评论
CommentWidget.prototype.getComments = function() {
  var commentURL = this.getCommentsURL + this.obj.type + '/' + this.obj.id;
  this.asyncRequest('GET', commentURL, null);
}

//发起一个XHR请求
CommentWidget.prototype.asyncRequest = function(method, uri, form) {
  var o = createXhrObject()
  if(!o) { 返回空值；}
  o.open(方法, uri, true);
  o.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
  变种自我=这个；
  o.onreadystatechange = function () {self.callback(o)};
  如果（形式）{
    o.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
    o.send(makePostData(form));
  } 别的 {
    o.send('');
  }  
}

//发表评论后，这会重写页面上的评论
CommentWidget.prototype.callback = function(o) {                  
  如果（o.readyState！= 4）{返回}
  //将 JSON 字符串转换为 JavaScript 对象。
  var response_obj = eval('(' + o.responseText + ')');
  this.comments = response_obj.comments;
  this.refresh()
}

```

我在这里开源了这段代码[http://www.trailbehind.com/comment_widget](http://www.trailbehind.com/comment_widget)

# debugging - 如何在调试 groovy 时检查对象（eclipse 插件或其他）

> ID：875634
> 
> 赞同：10
> 
> 时间：2009-05-17T22:19:32.800
> 
> 标签：debugging, groovy

我已经开始通过构建一个宠物项目来学习 groovy。我使用 XmlSlurper 获取一些 html 并对其进行解析等。我正在使用 eclipse3.4 和 groovy 1.6 插件。我很难尝试遍历所有 html 元素等。我希望设置一些断点，检查我的内容所在的当前变量，查看它包含的内容，我必须迭代什么，评估一些表达式等等等

但我几乎不能做这样的事情： - 一些变量没有出现在变量视图中（也许它没有类型？） - 选择任何表达式但你不能评估 - 最糟糕的是（对我来说）任何变量都会显示其所有常规内容（元类，值......）。大多数时候开发人员会感兴趣的东西都隐藏在层次结构中并且很难找到。

我原以为文档中提到的 ObjectExplorer 能够提供帮助，但我无法让它与我的脚本一起运行。

人们在 groovy 中开发时用什么来做这种事情？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T22:29:01.360

**选项1：**

在您的脚本中尝试以下操作

```
groovy.inspect.swingui.ObjectBrowser.inspect(object) 
```

这给出了所有公共字段、属性、方法等

**选项 2：**

您还可以使用 obj.dump() 或 object.inspect() 方法查看对象的值，例如 println obj.inspect() 或 assert obj.inspect() == "some values"

**其他选项：**

*   Eclipse 3.4 调试透视图工作得很好。即使是没有类型信息的也会出现。你能给出你在 3.4 中调试时遇到的具体问题吗
*   打印变量
*   使用有关 xml 预期输出的断言编写单元测试

# jquery - 如何防止以后对 jQuery 自动完成器的绑定触发？

> ID：875643
> 
> 赞同：1
> 
> 时间：2009-05-17T22:25:45.797
> 
> 标签：jquery, jquery-plugins, autocomplete

下面的代码非常简单。我有一个 jQuery[自动完成](http://docs.jquery.com/Plugins/Autocomplete)绑定到 .html 引用的 html 文本输入`#search`。当用户在其中输入内容时，一个下拉列表会显示来自服务器的建议。如果用户单击其中一个建议，或者在选中它的情况下按 Enter，则会出现一个弹出窗口（Facebox），显示弹出窗口中的调用页面。相反，如果用户只想执行普通搜索而不选择建议，他可以通过按 Enter 或单击 来执行此操作`#searchButton`。换句话说：

1.  用户输入一些东西，例如葡萄柚
2.  出现可选择的建议。
3.  场景 1：用户使用鼠标或键盘选择一个建议，按 Enter 键或单击它 - 导致该项目弹出，即自动完成的结果 .handler 触发（而不是 .keypress）
4.  场景 2：用户对建议不感兴趣，而是按 Enter 或单击`#searchButton`以对他输入的内容执行完整搜索`#search`。自动完成的结果处理程序不会触发，相反，Enter 按键触发`#searchButton`点击事件，或者直接触发（即实际点击）从而触发正常搜索。

这在 IE6、IE7、IE8、Chrome、Safari 中运行良好，但在 Firefox 中却不行。

在 Firefox 中，当在建议上按下 Enter 时，结果处理程序和按键事件都会触发，为用户提供 facebox 弹出窗口，并执行完整搜索。我认为以某种方式停止`.keypress`射击 if 。`result`火灾可以解决问题，但是，我一直无法弄清楚如何做到这一点。我尝试使用 jQuery`stopPropogation()`和`stopImmediatePropogation()`.result 处理程序，希望它能阻止 .keypress 触发，但它并没有改变任何事情。

如果有人有任何想法，或者想帮助我解决这个问题，我将不胜感激。

提前致谢！

```
 jQuery("#search").autocomplete("/index/suggest", {
        selectFirst: false,
        formatItem: function(data, i, n, value) {
            return "<font color='#3399CC'>" + value.split("::")[0] + "</font>";
        },
        formatResult: function(data,value) {
            return value.split("::")[0];
        }
    }).result(function(event, data, formatted) {
        alert('Hello, someone selected a suggestion by clicking on it or pressing enter on it, so you\'re getting this!');
        var pieces = formatted.split("::");
        var url = '/' + pieces[1] + '/detail/?id=' + pieces[2];
        jQuery.facebox({ ajax: url });
    }).keypress(keypressHandler).blur(function() {
        alert('I don\'t want this to appear if .result above is called, and it doesnt, except in firefox! Bah!');
        jQuery(this).flushCache();
    });

    function keypressHandler(e)
    {
        if(e.which == 13) {
            if(!jQuery('#searchButton').is(':disabled')) {
                jQuery(this).blur();
                jQuery('#searchButton').focus().click();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T22:39:16.230

您是否尝试过仅在搜索框上取消绑定按键事件并重新绑定您自己的按键处理程序？

```
jQuery("#search").autocomplete("/index/suggest", {
    selectFirst: false,
    formatItem: function(data, i, n, value) {
        return "<font color='#3399CC'>" + value.split("::")[0] + "</font>";
    },
    formatResult: function(data,value) {
        return value.split("::")[0];
    }
}).result(function(event, data, formatted) {
    alert('Hello, someone selected a suggestion by clicking on it or pressing enter on it, so you\'re getting this!');
    var pieces = formatted.split("::");
    var url = '/' + pieces[1] + '/detail/?id=' + pieces[2];
    jQuery.facebox({ ajax: url });
});

jQuery("#search").unbind("keypress").keypress(keypressHandler).blur(function() {
    alert('I don\'t want this to appear if .result above is called, and it doesnt, except in firefox! Bah!');
    jQuery(this).flushCache();
}); 
```

也可能是在自动完成处理程序中处理了其他关键事件。我认为您希望将它们从文本输入中删除，同时将它们留在自动完成“列表”中。如果自动完成处理的事件与按键不同，您可能希望删除它们。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-17T22:38:17.623

在 javascript 中，您可以简单地：

```
return false; 
```

在您的事件处理函数上，以阻止事件进一步冒泡。

# .net - FormsAuthentication.CookieDomain 属性

> ID：875647
> 
> 赞同：1
> 
> 时间：2009-05-17T22:27:08.850
> 
> 标签：.net, asp.net, authentication, cookies, forms-authentication

第一季度

> FormsAuthentication.CookieDomain 属性指定此 cookie 对其有效的域。如果您希望 cookie 可用于 Web 服务器上的更多应用程序，则覆盖此属性很有用

A) 我假设引用的意思是，如果使用相同的浏览器登录两个 Web 应用程序，那么覆盖此属性将导致这两个应用程序将它们的票证放入同一个身份验证 cookie？

B) 上面的引用不是暗示如果我们的 Web 服务器上只有一个 Asp.Net 应用程序运行，那么我们不需要覆盖默认值（它是一个空字符串）？

但据我所知，即使我们的 Web 服务器上只运行了一个 Asp.Net 应用程序，我们仍然需要将此属性设置为代表我们域的值，否则表单身份验证将不起作用？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T22:32:12.957

正确的。如果您只有一个应用程序，则不需要覆盖该值，但您也不需要设置它，它会为您解决。

实际上，这适用于您可能在[http://www.example.com](http://www.example.com)上拥有一个应用程序而在[http://host1.example.com](http://host1.example.com)上拥有一个应用程序的情况- 将 cookie 域设置为 example.com 意味着它们将共享相同的 cookie。

# javascript - 为什么 Internet Explorer 在新窗口中而不是在动态插入的 iframe 中打开表单提交？

> ID：875650
> 
> 赞同：5
> 
> 时间：2009-05-17T22:28:47.600
> 
> 标签：javascript, internet-explorer, dom, iframe

我正在尝试将表单发布到隐藏的、动态插入的 iframe，但在 Internet Explorer 中，表单提交会在新窗口中打开。

```
var iframe = document.createElement('iframe');
iframe.name = 'hidden_iframe';
iframe.className = 'NotVisible';
iframe.id = 'hidden_iframe';
document.body.appendChild(iframe);

var my_form = document.getElementById('my_form');
my_form.target = 'hidden_iframe'; 
```

这适用于 Firefox，但不适用于 Internet Explorer。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-17T22:32:16.543

显然，您需要在对 createElement 的调用中包含名称。这适用于 IE，并在符合标准的浏览器中导致异常。我们得到：

```
var iframe;
try {
    iframe = document.createElement('<iframe name="hidden_iframe">');
} catch (ex) {
    iframe = document.createElement('iframe');
    iframe.name='hidden_iframe';
}

iframe.className = 'NotVisible';
iframe.id = 'hidden_iframe';
document.body.appendChild(iframe);

var my_form = document.getElementById('my_form');
my_form.target = 'hidden_iframe'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T22:32:35.653

这难道不是使用[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)提交更容易完成吗？您介绍的 iframe 方法非常老套，容易出现很多问题。

这是一个[jQuery 表单插件](http://malsup.com/jquery/form/)，它通过为您处理表单值的所有序列化来轻松进行 Ajax 提交。

# asp.net-mvc - Linq2Sql 将记录插入相关表

> ID：875653
> 
> 赞同：3
> 
> 时间：2009-05-17T22:30:51.337
> 
> 标签：asp.net-mvc, linq-to-sql

类似的情况：[如何使用 LINQ2SQL 添加多个依赖记录](https://stackoverflow.com/questions/630320/how-to-add-several-dependent-records-with-linq2sql) （这似乎合乎逻辑，但对我不起作用）

ASP.NET MVC + Linq2SQL

我有 2 张表，分别称为 Challenges 和 Participants。

*   挑战 { challengeId，ChallengeDesc，申请人Id，responantId }
*   参与者{参与者ID，名字，姓氏}

参与者和挑战之间存在一对多的关系 - 每个密钥（applicantId、RespondantId）1 个。

我有一个输入表单，它收集所有字段以创建新的申请人和响应者以及挑战。Databinder 将所有字段正确绑定到 Challenge 及其子参与者，但是，当浏览由 Linq2Sql 创建的结构时，参与者对象的名称与挑战对象中的键名不匹配（applicantId 与 Participant 对象匹配，并且 respondantId 与 Participant1 匹配目的）。

因此，当我在 InsertOnSubmit(aChallenge) 之后尝试 SubmitChanges() 时，我从 Linq2Sql 收到一条foreign_key 约束验证消息。在 SQL Server Profiler 中，我可以看到参与者正在正确创建，但是在保存挑战时，这些新插入的参与者的 ID 没有设置为挑战对象，因此系统抛出外键违规消息。

我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-23T01:42:49.960

我认为你必须这样写（假设你有 Participant 和 Challenge 类）：

```
Participant applicant = new Participant();
Participant respondant = new Participant();
//update your participants here

Challenge insertedChallenge = new Challenge();
//update your challenge values here

applicant.Challenges.add(insertedChallenge);
respondant.Challenges1.add(insertedChallenge);

submitChanges(); 
```

Linq-to-SQL 应该自动分配这些属性（挑战和挑战），以便它可以为您设置键值。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:52:40.143

您可能想要编辑您的数据对象（通常使用 DBML 设计器）并将`Participant`-typed 属性分别重命名为`Applicant`和`Respondent`。使用它会比拥有`Participant`and更容易`Participant1`。您可以在关联属性（连接表格的线）中执行此操作。

当您想在 中分配外键时`Challenge`，您有两个选择。如果您`Participant`自己拥有对象，则可以将它们分配给（新重命名的）`Applicant`和`Respondent`属性（LINQ to SQL 将更新`ApplicantID`或`RespondentID`相应地更新）。或者，如果您有`ParticipantID`s，您可以将它们分配给`ApplicantID`或`RespondentID`直接分配。

# c - 在 C 中链接外部变量

> ID：875655
> 
> 赞同：15
> 
> 时间：2009-05-17T22:32:09.120
> 
> 标签：c, extern

在 Unix 中，我有三个主要文件。其中一个是库，另一个是程序。

*   `MyLib.c`并且`MyLib.h`是图书馆。
*   `main.c`是程序。

在`MyLib.h`我有一个声明（`extern int Variable;`）。当我尝试使用`Variable`时，`main.c`我不能。当然，我已经包含`MyLib.h`in`MyLib.c`和 in `main.c`，并且我也将它们链接起来。无论如何，该变量在`main.c`.

链接程序时如何获取可用的变量？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-17T22:36:28.610

`Variable`必须在某处定义。我会将其声明为 in 中的全局变量`MyLib.c`，然后仅将其声明为`extern`in `main.c`。

正在发生的事情是，对于`MyLib.c`和`main.c`，编译器被告知`Variable`存在并且是一个`int`，但它在其他地方（`extern`）。这很好，但是它实际上必须在其他地方，并且当您的链接器尝试将所有文​​件链接在一起时，它实际上找不到`Variable`任何地方，所以它告诉您它不存在。

试试这个：

MyLib.c：

```
int Variable; 
```

MyLib.h：

```
extern int Variable; 
```

主.c：

```
#include "MyLib.h"

int main(void)
{
    Variable = 10;
    printf("%d\n", Variable);
    return 0;
} 
```

# java - 自定义位置中的 Log4j 属性

> ID：875663
> 
> 赞同：14
> 
> 时间：2009-05-17T22:35:40.093
> 
> 标签：java, properties, log4j, propertyconfigurator

我将 Apache Commons Logging 和 SLF4J 与 log4j 一起使用，但我也想在 conf/log4.properties 等自定义位置使用 log4j.properties。这是问题所在：

如果我使用

```
 PropertyConfigurator.configure("conf/log4j.properties"); 
```

然后我的应用程序与 log4j 相关联，并违背了拥有 ACL 和 SLF4J 的目的。

在应用程序不知道日志记录实现是什么的情况下配置它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-17T23:06:18.757

我认为最简单的做法是使用*log4j.configuration*系统属性指定文件的位置。采用[Log4J 手册](http://logging.apache.org/log4j/1.2/manual.html)中的示例：

```
java -Dlog4j.configuration=conf/log4j.properties -classpath ... 
```

我相信 Log4J 会在类路径的任何位置找到一个名为“log4j.properties”的文件，但可能会产生幻觉。不过值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T13:41:28.913

正如您所说，通过调用`PropertiesConfigurator`，您将应用程序绑定到 log4j。然而，这种关系的延伸是相当有限的。您可以很容易地删除调用行`PropertiesConfigurator`并重新编译您的代码。完成之后，假设您使用 SLF4J API 进行日志记录，您可以将 log4j 替换为另一个日志框架，例如 logback-classic 或 jul，只需替换 jar 文件即可。因此，SLF4J 仍然在很大程度上发挥了它的作用。我不会把婴儿和洗澡水一起扔出去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-05T19:54:22.593

您可以使用 VM 参数指定配置文件位置

`-Dlog4j.configuration="file:/C:/workspace3/local/log4j.properties"`

# mysql - 如何将文本框中的日期转换为 MySQL DATETIME 格式

> ID：875664
> 
> 赞同：0
> 
> 时间：2009-05-17T22:36:27.533
> 
> 标签：mysql, datetime, textbox, input

我对 php 很陌生，并且一直在阅读 Larry Ullman 的书来开发一个基本的数据库站点。我使用 YUI 日历弹出日期选择器将日期添加到名为“日期”的文本字段中。它输入的日期格式是例如 2009 年 5 月 7 日，星期四

我尝试了许多不同的方法来尝试在 mysql db 中输入日期，但它仍然是 00 00 00 00 00 00 这是与我拥有的日期字段相关的代码，

```
 // Check for a Date.
if (eregi ("^([0-9]{2})/([0-9]{2})/([0-9]{4})$", $_POST['date'],)) {
    $p = escape_data($_POST['date'],);
} else {
    $p = FALSE;
    echo '<p><font color="red">Please enter a valid Date!</font></p>';
}

    // Add the URL to the urls table.
    $query = "INSERT INTO urls (url, title, description, date) VALUES ('$u', '$t', '$d', '$p')";        
    $result = @mysql_query ($query); // Run the query.
    $uid = @mysql_insert_id(); // Get the url ID.

    if ($uid > 0) { // New URL has been added. 
```

我想我已经提供了所有相关信息，但如果这没有帮助，我再次道歉，我会尽力为您提供您可能需要的任何其他信息。谢谢 - 肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T22:49:18.237

您可能需要以 mysql 对该数据类型期望的方式格式化日期，否则它无法识别它。您可以使用正则表达式或类似方法来提取组件部分并根据 MySQL DATETIME 类型的格式对其进行格式化。

编辑：有关上述格式，请参见[http://dev.mysql.com/doc/refman/5.0/en/datetime.html](http://dev.mysql.com/doc/refman/5.0/en/datetime.html)。此外，最好将日期/时间存储为 unix 时间戳，因为这通常更易于维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T02:44:31.557

如果您的日期选择器传入的格式是“2009 年 5 月 7 日，星期四”，那么[strtotime()](http://www.php.net/strtotime)和[date()](http://www.php.net/date)函数应该可以为您提供传递给 MySQL 的有效日期：

```
$p = date("Y-m-d H:i:s",strtotime('Thursday, 7 May 2009')); 
```

如果您的数据库字段是 DATE，您可能只需要“Ymd”部分。如果是 DATETIME，您也需要“H:i:s”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-18T13:13:07.457

mysql中的日期格式是YYYY-MM-DD，所以改变你在php上接受数据的方式

> if (eregi ("^([0-9]{2})/([0-9]{2})/([0-9]{4})$", $_POST['date'],) ) { $p = escape_data($_POST['date'],); } 其他 { $p = 假；回声'
> 
> 请输入一个有效的日期！
> 
> ';

应该

> if (eregi ("^([0-9]{4}/([0-9]{2})/([0-9]{2}))$", $_POST['date'],) ) { $p = escape_data($_POST['date'],); } 其他 { $p = 假；回声'
> 
> 请输入一个有效的日期！
> 
> ';

# emacs - 如何在渲染 emacs 框架后运行命令？

> ID：875667
> 
> 赞同：2
> 
> 时间：2009-05-17T22:37:59.870
> 
> 标签：emacs, elisp, emacs-ecb

我试图弄清楚如何使用 Emacs 代码浏览器 (ECB)，你可以用它做的一件事是设置 ecb-windows-width 来决定 ecb 窗口的宽度。问题是这个序列：

1.  屏幕上弹出框架。
2.  ecb-activate 被调用，根据 ecb-windows-width 进行缩放。
3.  默认帧列表参数启动，帧被调整大小。

问题是由于这个顺序，ecb 窗口的宽度是在框架调整大小之前设置的，然后不会被缩放。

所以我想运行ecb-redraw-layout（或者理想情况下只是ecb-activate），但它必须在#3之后发生。否则，某种 ecb-dynamic-width-scale 选项也可以使用。

对于它的价值，ecb-auto-activate 不起作用，所以我不知道这是否能解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T23:34:04.587

看来我找到了解决方法。

1.  将 ecb-fix-window-size 设置为 true。
2.  当框架加载时，调用 ecb-activate 并且 ecb 窗口与框架大小成比例地缩放。
3.  然后 default-frame-alist 启动并调整框架大小，但 ecb 窗口具有固定大小并且不会缩放。

Quite hackish because you're setting the width according to the default frame size that comes up first, not the size you actually use. But oh well.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T22:56:27.533

我不熟悉 ECB，但`after-make-frame-functions`可能有助于运行您想要的功能（或运行一些您想对 ecb 框架执行特殊操作的钩子函数）。

`after-make-frame-functions`是接受**一个**参数（新创建的框架）的函数列表，并在创建框架后运行。这不适用于初始 emacs 框架（在启动时），因为您的 .emacs 是在框架创建*后读取的。*

# api - Castle Windsor Fluent 注册 - Pick() 做什么？

> ID：875670
> 
> 赞同：6
> 
> 时间：2009-05-17T22:40:01.283
> 
> 标签：api, castle-windsor, fluent-interface

当使用城堡温莎的自动注册时，我看到人们在做类似的事情

```
_container.Register(
  AllTypes.Pick().FromAssembly(Assembly.GetExecutingAssembly())
    .WithService.FirstInterface()); 
```

对于我的一生，我无法弄清楚 Pick() 方法的作用，也找不到任何文档。谁能给我解释一下？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T23:40:25.197

`Pick(IEnumerable<Type>)` [是 的同义词](http://fisheye2.atlassian.com/browse/castleproject/trunk/InversionOfControl/Castle.MicroKernel/Registration/Strategies/AllTypes.cs?r=5688#l128) `From(IEnumerable<Type>)`，即它选择指定的类型作为注册目标。

`AllTypes.Pick()` [与 相同](http://fisheye2.atlassian.com/browse/castleproject/trunk/InversionOfControl/Castle.MicroKernel/Registration/Strategies/AllTypes.cs?r=5688#l51) `AllTypes.Of<object>()`，因此它有效地选择了所有类型。

`AllTypes.Pick().FromAssembly(Assembly.GetExecutingAssembly())`将在执行程序集中选择所有类型（当然，您可以过滤）

像往常一样，查看[fluent API wiki](http://using.castleproject.org/display/IoC/Fluent+Registration+API)和/或[测试用例](http://svn.castleproject.org:8080/svn/castle/trunk/InversionOfControl/Castle.MicroKernel.Tests/Registration/AllTypesTestCase.cs)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T23:44:34.903

这是这个 fluent API 的起点，用于选择哪些类型将自动注册到容器中。

```
Container.Register(
        AllTypes.Pick()
        .FromAssemblyNamed("MyAssembly")
        .If(t => t.Name.EndsWith("ABC"))
        .Configure(c => c.LifeStyle.Is(LifestyleType.Transient))
        .WithService.Select(i => typeof(I))
    ); 
```

在此示例中，所有从 MyAssembly 中选择的名称以“ABC”结尾的类型都将添加到具有 Transient Lifestyle 作为类型 I 的服务的容器中。该示例来自[这个问题](https://stackoverflow.com/questions/651392/castle-windsor-fluent-api-define-dependency-explicitly)。

这是一种内部 DSL 形式的声明性方法。使用这种 API，方法用于对稍后执行的行为进行排序。为了实现这一点，这些方法返回建设者指导配置步骤，而实际工作在最后完成。

# c# - 如何使用 LINQ 在函数中定义返回类型？

> ID：875674
> 
> 赞同：1
> 
> 时间：2009-05-17T22:44:42.223
> 
> 标签：c#, asp.net, linq, linq-to-sql, entity-framework

我想知道在以下情况下如何在函数中定义返回类型。

我有一个产品，我一次返回所有信息或一个产品。

正如您在下面定义的函数中看到的那样。

```
public static Products GetProducts(int pid) 
{
    var pro = from p in context.Products
              select p;

    if(pid > 0)
        pro =  pro.where(p => p.ProductID ==pid)

    return (Products)p;
} 
```

问题是它给了我铸造错误。如您所见，我想要实现的是基于我的参数，它给了我一个结果集。有时是一堆产品，有时是单一产品。我是 linq 的新手，因此我们将不胜感激。

错误是***无法将“System.Data.Objects.ObjectQuery`1[TTDCore.Theatres]”类型的对象转换为“TTDCore.Theatres”类型***

当我将它绑定到gridview时。这是一个代码

```
Products p = Class1.GetProducts(0);

GridView1.DataSource = p;
GridView1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T22:46:04.110

您想要返回`IEnumerable<Product>`，它表示类型的对象的可*迭代*（或可枚举）`Product`。LINQ 通常都基于这种泛型类型，因此它通常是您希望作为查询结果返回的内容。

我相信您的代码应该固定为如下所示：

```
public static IEnumerable<Products> GetProducts(int pid) 
{
    var pro = from p in context.Products
              select p;

    if(pid > 0)
        pro =  pro.Where(p => p.ProductID == pid)

    return pro;
} 
```

让我知道您的问题是否还有其他含义。我不完全确定你到底在寻找什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T22:56:17.703

我喜欢明确使用 Linq 查询和 lambda。我建议将您的函数定义为 List<Product>（或 IEnumerable<Product>），然后将 .ToList() 添加到 where 语句中。我假设 Products 类型是某种集合？

# javascript - Google Maps API - 加载缓慢的 javascript

> ID：875678
> 
> 赞同：11
> 
> 时间：2009-05-17T22:45:50.677
> 
> 标签：javascript, google-maps

我正在使用 Google Maps API 在某个页面上显示地图。

问题是文件`http://maps.google.com/maps?file=api.....`有时碰巧加载得很慢——降低了页面的性能，因为 JavaScript 的其余部分首先在文档就绪时加载，它很少到达——因为浏览器锁定等待来自 Google 的文件。

我试图将 JavaScript 文件从`<head>`标签移动到我的内容下。但是 JavaScript 的其余部分永远不会被触发，因为浏览器等待来自 Google 的文件。

有没有办法解决这个问题，或者有没有其他人遇到过同样的问题？它是最近开始的，我不知道为什么。

这是我的代码，如果有人感兴趣的话：

```
<script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=true&amp;key=ABQIAAAAa24xicak8_ghHX58i7La7hRFh9iM79SNC94rOejOtdMRvQmJiBS6Uv5F_1BNSh9ZuSzFXyekHISgew">    </script>
<script type="text/javascript" src="/js/maps.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
    // Google Maps
    initialize();

    // Other JavaScript comes here....

   });
</script> 
```

如果我访问

```
http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=true&amp;key=ABQIAAAAa24xicak8_ghHX58i7La7hRFh9iM79SNC94rOejOtdMRvQmJiBS6Uv5F_1BNSh9ZuSzFXyekHISgew 
```

文件立即加载。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-11-17T14:33:49.457

现在这是一个相当古老的问题 - 解决方案是禁用萤火虫（至少对我来说）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-24T07:51:36.720

使用 Google 的 Ajax API。从过去开始，Google 的所有服务都可以通过 JavaScript API 访问。它是一个模块化系统，你只需要包含 JSAPI 库，然后你就可以动态加载你需要的模块——它不会阻塞你的网站。

```
<script type="text/javascript"        
        src="http://www.google.com/jsapi?key=ABCDEFG"></script>
<script type="text/javascript">
google.load("maps", "2");
google.setOnLoadCallback(function() {
    // Your logic goes here.
    // It will be run right after the maps module was loaded.
});
</script> 
```

有关详细信息，请参阅[JSAPI 的开发人员文档](http://code.google.com/apis/ajax/documentation/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T05:35:51.680

关于 JavaScript 优化：始终将 JS 放在 Maps API 脚本的底部。我真的想不出任何好的理由让任何 JS 出现在脑海中。

# c# - 将托管 (C#) 字符串 [] 数组传递给 COM DLL

> ID：875679
> 
> 赞同：0
> 
> 时间：2009-05-17T22:46:03.517
> 
> 标签：c#, arrays, com, unmanaged, managed

**设置：**
我有一个 COM DLL，它调用托管 C# DLL 中的一个方法。此函数返回一个 C# string[] 数组，该数组被封送为 SAFEARRAY。

**问题：**
当我尝试访问安全数组中的字符串时，我只得到字符串的第一个字符。我究竟做错了什么？

**编码：**

```
 // Pointer to the managed interface
    DatabasePtr pODB(__uuidof(DBClass));

    // Get the string[] array from the managed method
    SAFEARRAY* safearray = pODB->GetStringArray();

    HRESULT hresult;

    long ubound;
    long lbound;

    hresult = SafeArrayGetUBound(safearray, 1, &ubound);
    hresult = SafeArrayGetLBound(safearray, 1, &lbound);

    long index;
    BSTR fromarray;

    for (; lbound <= ubound; lbound++)
    {
        index = lbound;

        hresult = SafeArrayGetElement(safearray, &index, (void*)&fromarray);

        char buffer[512];
        sprintf_s(buffer,"%s",fromarray);

        MessageBox(0, (LPCSTR)buffer, "...", 0);
    } 
```

谢谢你的帮助，-
肖恩！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T23:27:28.457

BSTR 是一个 unicode 字符串，因此您必须使用`wchar_t`缓冲区和`wsprintf_s`. 现在你打印第一个 unicode 字符的 ANSI 部分，然后在 \0 上停止。请，请不要像那样堆叠溢出（原文如此！）。使用保险箱`_vsnwprintf_s_l`及其系列，您的代码就像现在一样是黑客的乐趣，您将被击败。请参阅[http://msdn.microsoft.com/en-us/library/d3xd30zz(VS.80).aspx](http://msdn.microsoft.com/en-us/library/d3xd30zz(VS.80).aspx)

# php - PHP Zip extractTo - 权限问题

> ID：875681
> 
> 赞同：2
> 
> 时间：2009-05-17T22:47:23.997
> 
> 标签：php, permissions, zip, zlib

我正在尝试使用 PHP 解压缩 Zip 存档`extractTo`。PHP 脚本通过网络浏览器运行，即“nobody”。

逻辑和流程：

1.  在文档根目录下创建一个新的子目录（例如“abc”），权限为 0777，所有者“nobody”（即 public_html 上一级）

2.  将 Zip 文件（从 public_html 下的传入 FTP 目录）复制到 abc 子目录。此 Zip 文件的权限设置为 0777，所有者“nobody”。

3.  在 abc 下创建一个“解压”子目录，权限 0777 / 无人

4.  调用`extractTo`将 zip 文件解压缩到解压缩的子目录。

代码是：

```
if ($zip->extractTo('$abc_unzipped_path') === TRUE)
{
     [more code]
} 
```

第 4 步导致 php 脚本返回以下错误：

> ZipArchive::extractTo() [ziparchive.extractto]: [脚本路径和名称] 行 [extractTo 调用的行号] 中的权限被拒绝

谁能看到权限问题可能出在哪里？

*   PHP 版本 5.2.9
*   Zlib 1.2.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T22:11:12.697

...原来问题出在 zip 文件本身，它以各种方式导致上述错误，或者根本没有错误消息（脚本崩溃）

# subtext - 如何在没有 Web 平台安装程序的情况下获取潜文本源代码？

> ID：875684
> 
> 赞同：0
> 
> 时间：2009-05-17T22:51:53.423
> 
> 标签：subtext

我查遍了整个网络，如果不使用 Web 平台安装程序，我找不到获取新版本潜文本的方法？为什么我们需要安装安装程序才能获取源代码？这个额外的箍的目的是什么？有谁知道如何在不使用 Web 平台安装程序的情况下在 Web Gallery 上获取任何 Web 应用程序？

编辑：好的，我在[链接文本上找到它](http://code.google.com/p/subtext/downloads/list)

网络安装程序的目的是什么？为什么不直接给我们来源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-23T08:15:31.950

Web 平台安装程序用于在您的机器上下载和安装*产品。*它可以处理诸如应用适当的 IIS 设置、在文件系统上设置权限等事情......

因此，它非常适合在服务器上运行 Subtext 或其他 Web 软件的运行实例。

如果您想要源代码，请访问[http://code.google.com/p/subtext](http://code.google.com/p/subtext)

# c++ - 为研究人员简化算法测试。

> ID：875685
> 
> 赞同：1
> 
> 时间：2009-05-17T22:51:59.133
> 
> 标签：c++, scripting, real-time

我在一个从事大量研究开发和完整运输代码的小组工作。

我有一半时间开发在我们的实时系统上运行的流程（介于软实时和硬实时之间，中等实时？）

另一半我为那些根本不关心代码的研究人员编写或优化流程。

目前我正在研究一个我必须分成两个不同分支的过程。

一个小组有一个研究版本，一个生产版本需要偶尔与研究代码合并，以将最新和最好的投入生产。

要测试这些流程，您需要设置一个半复杂的测试环境，它将我们分析的数据在正确的时间（实时系统）发送到流程。

我正在考虑如何制作：

1.  主意
2.  实施
3.  测试
4.  转到#1

让我的同事尽可能轻松、快速、无痛地骑行。

我的一个想法是在这些长时间运行的进程中嵌入一种脚本语言。因此，随着流程的运行，他们可以调整实际算法及其参数。

我立即查看了嵌入：

*   Lua（有用的[指南](http://csl.sublevel3.org/lua/)）
*   Python（有用的[指南](http://docs.python.org/extending/extending.html)）

这些似乎都是可行的，实际上可能完全解决给定的问题。

还有其他好主意吗？

在 1-2 行更改后重新编译，重新部署到测试环境并重新启动很糟糕。

该系统相当复杂，希望我能体面地解释它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T02:31:00.230

如果您可以通过脚本更改足够多的程序以使其有用，而无需完全重新编译，那么也许您应该考虑将系统分解为更小的部分。您可以有一个“服务器”来处理数据加载等，然后是执行实际处理的客户端代码。每次系统加载新数据时，它都会检查并查看客户端代码是否已重新编译，如果是，则使用它。

我认为这里有几个优点，其中最大的优点是整个系统不会那么复杂。现在您使用一种语言而不是两种语言工作。人们在脑海中从 python 或 lua 模式转移到 c++ 模式时，不太可能把事情搞砸。通过在系统中嵌入一些其他语言，您也会冒着依赖它的风险。如果您使用 python 或 lua 来 tweek 程序，这些语言要么在需要部署时成为依赖项，要么您需要将事情退回到 C++。如果您选择将内容移植到 C++，则在切换期间还有另一个机会出现错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T01:44:02.217

嵌入 Lua 比嵌入 Python 容易得多。

*   Lua 从一开始就被设计为嵌入式；Python 的可嵌入性是事后嫁接的。

*   Lua 比 Python 小约 20 倍，也更简单。

您不会对构建过程说太多，但是通过使用真正强大的 make 版本可以显着简化构建和测试。我使用 Andrew Hume 的[mk](http://swtch.com/plan9port/unix/)，但您可能最好花时间掌握 Glenn Fowler 的[nmake](http://www.research.att.com/~gsf/nmake/nmake.html)，它可以即时添加依赖项并消除对单独配置步骤的需要。我通常不推荐 nmake，因为它有点复杂，但很明显，Fowler 和他的团队已经为*许多*扩展和可移植性问题构建了 nmake 解决方案。对于您的特定情况，可能值得努力掌握它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T23:20:02.797

不确定我是否了解您的系统，但如果构建和部署过于复杂，也许您可​​以自动化它？如果部署是完全自动的，那会解决问题吗？

我不明白脚本语言如何解决问题？如果你改变你的算法，你仍然需要从头开始计算，不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:08:11.007

听起来您需要的是[CruiseControl](http://cruisecontrol.sourceforge.net/)或类似的东西；每次你接触基线代码时，它都会重新构建并重新运行测试。

# c++ - C++ GUI 编程的建议

> ID：875686
> 
> 赞同：17
> 
> 时间：2009-05-17T22:53:22.673
> 
> 标签：c++, visual-c++

我已经编写 C++ 控制台/CMD 行应用程序大约一年了，并且想进入 Windows GUI 应用程序。对于那些曾经走这条路的人，你能给我什么建议/提示。例如：好的阅读材料、教程、接近策略等……

我知道这是一个非常广泛的问题，但我真的不知道如何/从哪里开始，因此不知道如何正确地提出这个问题。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-18T01:08:45.420

我强烈推荐使用[Qt 库](https://www.qt.io/)，原因如下：

1.  该框架可**免费**用于 Windows、Linux、MacOS X 和一些移动系统。从 4.5 版开始，许可证是 LGPL，这基本上意味着您甚至可以在商业应用程序中使用 Qt。
2.  Qt的**设计**非常出色，例如他们使用现代设计模式和非常一致的界面设计（我不知道有很多其他库使用如此完美的面向对象思想）。使用 Qt 与使用 Boost 相同：它会提高你自己的编程技能，因为它们使用了如此漂亮的概念！
3.  它们非常快，例如在**渲染**中（由于 OpenGL、DirectX 等的不同后端）。只要看看[这个视频](http://www.youtube.com/watch?v=MXS3xKV-UM0&feature=channel_page)，你就会发现使用 Qt 可以轻松完成，但使用原生 Windows、Mac 或 Linux 编程很难实现。
4.  他们有一个**非常棒的文档**，有大量的教程和一个很好的参考。您可以使用给定的文档轻松开始学习 Qt！该文档也[可以在线获得](https://doc.qt.io/qt-5.7/index.html)，因此请自行查看。
5.  如前所述，Qt 是**跨平台的**；您拥有一个适用于所有重要操作系统的源代码库。当您还可以“免费”拥有 Mac 和 Linux 时，为什么还要限制自己使用 Windows？
6.  Qt**不仅仅是**“只是”用户界面。它们还提供网络和数据库功能、OpenGL 绑定、功能齐全的 Web 浏览器控件（基于 WebKit）、多媒体播放库等等。

*老实说，我在为 Windows本地*开发软件上浪费了几年时间，而我本来可以更有效率。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T23:09:10.183

对于 C++，您有两个选择，Native 或 Managed。

对于本机开发，我的团队（在 Microsoft，在 Windows 中）使用[Windows 模板库](http://en.wikipedia.org/wiki/Windows_Template_Library)。它对我们非常有效。

您应该了解 Win32 的基础知识以及 Windowing 的工作原理。经典著作是[Programming Windows®](https://rads.stackoverflow.com/amzn/click/com/157231995X)

对于托管开发，您可以将 C++ 与[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)一起使用。但是，Windows 窗体已被[Windows Presentation Foundation (WPF)](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)取代。

*   这是一个可以让您快速上手[的好网站。](http://windowsclient.net/)
*   [这个教程很有用](http://msdn.microsoft.com/en-us/library/aa733747(VS.60).aspx)
*   您可以为您的工具使用 V [isual C++ 2008 Express Edition](http://www.microsoft.com/Express/vc/)（它们是免费的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T23:34:09.517

大多数窗口库和技术都使用类似的习惯用法。选一个，学习一下。

在坚持使用 C++ 的同时，[Windows 模板库](http://wtl.sourceforge.net/ "Windows 模板库")是 Microsoft Windows 的一个非常好的饰面。

对于跨平台 C++ 窗口工具包（它们在 Microsoft Windows 以及其他平台上工作），您可以尝试[QT](http://qt.nokia.com/ "QT")或[wxWidgets](http://www.wxwidgets.org/ "wxWidgets")。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-18T18:00:13.107

我对 Windows C++ GUI 编程的最佳建议是不要进行 Windows C++ GUI 编程。

我意识到如果它不合格，这是一个非常无信息/智能的响应，所以我会注意你没有说你*需要*做 C++ Windows GUI 编程，而是你“想进入 Windows GUI 应用程序”。如果是这种情况，并且您没有使用 C++ 的非常具体的理由（即用 MFC 编写的庞大的现有遗留代码库或您想要为其构建前端但会很痛苦的一堆 C++ 代码暴露给 .NET 代码），那么走 .NET 路线并开始学习 Windows 窗体或使用 C# 或您选择的其他 .NET 语言更好的 WPF 将会变得更加容易和高效。

如果您确实需要使用 C++，那么我会支持 Qt 或 wxWidgets 等 3rd 方工具包的建议，因为 Microsoft 的 C/C++ GUI 编程工具的状态现在很糟糕。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-17T22:59:25.280

好吧，对于 Windows GUI，习惯于大量引用 MSDN，假设您想直接处理 API。

我最喜欢学习基础知识的资源是[theForger 的教程](http://www.winprog.org/tutorial/)，但那里有数百本书和其他网站。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T23:01:10.500

我想一个重要的起点是你的工具包。您标记了这个 visualc++，所以我假设您正在查看它，但请记住还有其他工具包，例如 Qt。

我建议从[Microsoft 的教程](http://msdn.microsoft.com/en-us/library/aa733747(VS.60).aspx)开始。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T01:47:56.980

+1 为 Qt。我会将文档放在我对 GUI 系统的需求列表的顶部。Qt 有很棒的文档，背后有一个庞大的社区。还有几本关于它的书。如果您独自工作而没有其他团队成员可以依赖，那么好的文档非常重要。替代品是 wxWidgets、MFC、WTL、FLTK 等等。他们都有优点和缺点。例如，FLTK 很小，只提供 GUI，而 Qt 和 wxWidgets 还包括网络、数据库访问等。在诺基亚收购之后，Qt 似乎势头最猛，例如 Qt Creator 的发布使您能够在 Visual Studio 之外开发应用程序.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T18:12:13.147

自从我在 Windows GUI 上使用 C++ 已经很长时间了，我的话总是避免在 Windows GUI 中使用 C++，除非你有一个很好的理由，我的意思是一个很好的理由，如果你需要一些性能，C# 对于 90 来说绰绰有余% 的情况，如果您需要更多功能，请在 C++ dll 中编写对性能至关重要的东西，然后从 Windows 窗体或 WPF 应用程序中调用它。它将为您节省大量时间。仍然是我的意见，如果你有另一个我完全尊重

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-03T06:59:18.007

第一个问题是你想用 C++ 开发免费的、开源的、供个人使用的还是商业应用程序？

1.  如果你想开发供个人使用！然后你可以使用一些好的 C++ 工具包、框架或 API。
2.  如果您想开发一个开源或免费的 GUI 应用程序。然后，您可以使用具有 GPL 或任何满足您需求的开源许可证的 C++ 工具包、框架或 API。
3.  甚至您也可以使用具有 LGPL 许可的开源工具包、框架或 API 开发商业应用程序。

第二个问题是你想为 Windows、Mac、Unix 还是 Linux 开发？还是所有这些，甚至对于移动平台？

1.  如果你像我一样有一个 Windows 用户，并且只想为 Windows 开发，我的意思是不是跨平台，你可以使用 Win32 API，虽然，学习 Win32 API 更难，但它可以让你完全控制机器。相信我，没有其他工具可以让您完全控制机器。如果您不喜欢 Win32 API，出于任何原因，您可以使用 MFC，这是 Microsoft 的另一项技术，但不是免费的、陈旧的并且现在已经很少受到关注。如果您决定使用 .NET 平台进行开发，那么您拥有 C++/CLI，它是用于开发 .NET 应用程序的 C++ 语言的扩展。.NET 为您提供类型安全、OOP 和内置垃圾收集器，在一个包中为您提供与 Windows 和 x86 或 x64 机器相关的所有 API。.NET 有自己的世界！微软已决定移植 .

2.  如果您想为跨平台开发 C++ GUI 应用程序，那么 Qt、WxWidgets 和 U++ 可以为您提供帮助。您可以使用这些库编写一次并在任何地方部署。许多开源 IDE 和编译器也可用于轻松开发 C++ 应用程序。请注意，如果您不想为跨平台开发，任何跨平台库都会产生开销，并且不可避免地会增加可执行文件的大小。

您的 C++ 知识是否足以对软件系统进行编程？

事实上，如果你对 C++ 的了解不够深入，而且你不了解 OOP、封装、类、接口、类型、编程模式等编程方法，你就无法使用任何具有充分潜力的工具包。不要忘记每个工具包、框架或 API 都是用某种编程语言实现的。如果您确实非常了解该语言，则可以很好地使用该工具包。我想，你会明白我的意思的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-27T12:37:24.053

抛开 WPF 或 VC++ 或 Qt，您还可以尝试几个库，例如：

*   开放框架*   **加工***   ...

这里有一个使用 Openframeworks 开发 Gui 的活动项目：
[http ://www.syedrezaali.com/blog/?p=2172](http://www.syedrezaali.com/blog/?p=2172)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-17T23:02:04.023

您熟悉 Microsoft Visual Studio 和 .NET 技术吗？既然你想为 Windows 平台开发，为什么不从看看[Microsoft Visual C++ Express Edition](http://www.microsoft.com/Express/vc/)开始。？使用 MS 提供的工具进行一些探索并搜索一些教程。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-02-21T12:43:17.467

我们是在 2020 年，但这个问题仍然是相关的。我同意 Qt 用户的观点，这是一个很棒的框架。

但是，还有[C++Builder](https://en.wikipedia.org/wiki/C%2B%2BBuilder)可以在设计时为您提供可视化的 GUI 设计。C++Builder 应用程序可以在 VCL（仅限 Windows）和 FireMonkey（跨平台）框架上构建。Clang 编译器可以生成 32 位和 64 位本机可执行文件。C++Builder 的社区版是免费的。Delphi 无缝集成：C++Builder 项目可以直接包含 Delphi 文件并使用任何现有的 Delphi 组件包和库。

# unix - 无法将管道更改为普通文件

> ID：875687
> 
> 赞同：0
> 
> 时间：2009-05-17T22:54:24.667
> 
> 标签：unix, pipe

我有以下文件（上图），它似乎是一个 Unix 管道 [替代文本 http://dl.getdropbox.com/u/175564/problemFile.png](http://dl.getdropbox.com/u/175564/problemFile.png)

**如何使管道成为默认文本文件**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T23:31:47.603

除非还有其他没有提到的并发症，最简单的就是使用大锤：

```
$ rm outside
$ touch outside 
```

如果当前有进程正在使用该文件，则需要先终止该进程，然后重新启动它以使用新文件。否则，管道将保持打开但不可见，直到进程最终终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T22:57:46.467

> 如何使管道成为默认文本文件，以使第一个字母变为 d？

'd' 的第一个字符表示该条目是一个目录，而不是普通文件。

# html - 如何加载从数据库访问的数据到 html 表单

> ID：875688
> 
> 赞同：0
> 
> 时间：2009-05-17T22:54:29.830
> 
> 标签：html, forms, textbox, textarea

我正在尝试使用 GetString() 方法从表中访问数据，并且该数据存储在某个变量中，然后当我单击提交按钮时必须将其加载到 html 表单中。怎么办？请帮我......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T01:58:51.277

这个问题太笼统了。

为了访问数据库，您需要一个以 ASP.NET、Java、PHP 等语言运行服务器端代码的 Web 服务器。服务器代​​码将负责使用“GetString()”方法来读取表并在表单中填充数据（或者更好的是，将其返回到 MVC 视图或通过 AJAX 返回到 JavaScript 以将其加载到 HTML 表单中）。

# java - 为什么生成执行操作的 Java 代码比“解释器循环”运行得更慢？

> ID：875695
> 
> 赞同：2
> 
> 时间：2009-05-17T23:01:01.920
> 
> 标签：java, optimization, code-generation, jvm-hotspot

我有一些对 BitSet 执行按位运算的 Java 代码。我有一个操作列表，可以通过循环来“解释”它们，但对我来说重要的是我可以尽快执行这些操作，所以我一直在尝试动态生成代码来应用它们。我生成 Java 源代码来执行操作并使用 Javassist 编译实现这些操作的类。

不幸的是，我动态生成的代码比解释代码运行得慢。这似乎是因为 HotSpot 正在优化解释代码，但没有优化编译代码：在我运行它几千次之后，我的解释代码运行速度是最初的两倍，但我的编译代码显示没有加速。与这个假设一致，我的解释代码最初比编译代码慢，但最终更快。

我不确定为什么会这样。我的猜测是 Javassist 可能使用了一个类加载器，它的类 HotSpot 没有触及。但我不是 Java 类加载方面的专家，所以我不确定这是否是一个合理的猜测或如何进行测试。以下是我使用 Javassist 创建和加载类的方法：

```
ClassPool pool = ClassPool.getDefault();
CtClass tClass = pool.makeClass("foo");

// foo implements MyInterface, with one method
tClass.addInterface(pool.get(MyInterface.class.getName()));

// Get the source for the method and add it
CtMethod tMethod = CtNewMethod.make(getSource(), tClass);
tClass.addMethod(tMethod);

// finally, compile and load the class
return (MyInterface)tClass.toClass().newInstance(); 
```

有没有人知道这里发生了什么？我真的很感激你能提供的任何帮助。

我在 Windows XP 32 位上使用 Sun 1.6 服务器 JVM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T23:12:41.097

HotSpot 不关心代码来自哪里。例如，它会愉快地将通过虚拟方法调用调用的代码与由不同类加载器加载的实现进行内联。

我建议您在源代码中写出您尝试为此基准执行的操作，然后对其进行基准测试。编写生成代码的示例通常比编写生成器更容易。

HotSpot 可能无法尽其所能优化代码的原因有很多。例如，很长的方法往往不会被内联或内联方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T07:28:04.443

我想我明白这里发生了什么。我的第一个错误是生成的方法太长了。在我修复它之后，我注意到虽然我生成的代码仍然较慢，但它最终接近了解释代码的速度。

我认为这里最大的加速来自 HotSpot 优化我的代码。在解释版本中，需要优化的代码非常少，因此 HotSpot 很快就会处理它。在生成的版本中，有很多代码需要优化，因此 HotSpot 需要更长的时间才能对所有代码发挥作用。

如果我运行我的基准测试足够长的时间，我现在看到我生成的代码的性能比解释的代码稍微好一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T08:19:54.510

有一个 JVM 设置可以控制编译代码的速度 -XX:CompileThreshold=10000

> 编译前的方法调用/分支数 [-client: 1,500]

我不知道这是否会有所帮助，因为在您的示例中，大小似乎起着至关重要的作用。

# django - 使用 Git 开发 Django 项目

> ID：875698
> 
> 赞同：8
> 
> 时间：2009-05-17T23:01:24.197
> 
> 标签：django, git

我想知道是否有人有使用 Git 源代码控制管理在一个小团队（我的情况下是 3 个）中处理 Django 项目的经验。

该项目托管在开发服务器上，这就是为什么我遇到这样的问题。开发人员在将更改提交到本地存储库并将这些更改推送到服务器之前，无法查看他们的代码是否有效。然而，即便如此，git 似乎也没有更新服务器上保存存储库的目录中的文件——可能是因为它只存储更改以节省空间。

在处理这个项目时，我们开始互相干扰，所以需要某种版本控制——但我就是想不出一个解决方案。

如果有人克服了类似的问题，我很想听听如何做到这一点。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T23:14:53.057

推送到远程存储库时，最好的结果是远程存储库是没有工作目录的“裸”存储库。听起来您在远程存储库上有一个工作目录，在进行推送时，Git 不会更新该目录。

对于您的情况，我建议开发人员拥有自己的测试环境，他们可以在将代码推送到其他任何地方之前在本地进行测试。*拥有一个中心位置，每个人都需要在尝试*之前推动他们的工作，这将导致很多痛苦和痛苦。

对于部署，我建议推送到中央“裸”存储库，然后有一个流程，部署服务器*将*最新代码从中央存储库拉到其工作目录中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T23:18:44.670

当您推送到（共享）git 存储库时，它不会更新该存储库的工作文件。基本上是因为工作文件可能很脏，在这种情况下你必须合并——为此你需要在那里拥有完整的 shell 访问权限，一般情况下可能并非如此。

如果您想在某处签出共享存储库的最新“主”，您可以通过编写更新后挂钩来安排。我将在下面给出一个示例，我用它来检查“ui”子目录并使其对 Apache 可用。

但是，我会说我认为您的流程可以改进。开发人员通常需要他们可以在推送到共享点之前对其进行测试的个人服务器：否则该共享存储库可能非常不可靠。考虑一下，如果我对它进行更改但它不起作用，是我的更改破坏了它还是其他人的副作用？

好的，我将其用作更新后挂钩：

```
#!/bin/sh
# Should be run from a Git repository, with a set of refs to update from on the command line.
# This is the post-update hook convention.

info() {
    echo "post-update: $@"
}

die() {
    echo "post-update: $@" >&2
    exit 1
}

output_dir=..
for refname in "$@"; do
    case $refname in
        refs/heads/master)
            new_tree_id=$(git rev-parse $refname:ui)
            new_dir="$output_dir/tree-$new_tree_id"
            if [ ! -d "$new_dir" ]; then
                info "Checking out UI"
                mkdir "$new_dir"
                git archive --format=tar $new_tree_id | ( cd $new_dir && tar xf - )
            fi
            prev_link_target=$(readlink $output_dir/current)
            if [ -n "$prev_link_target" -a "$prev_link_target" = "tree-$new_tree_id" ]; then
                info "UI unchanged"
            else
                rm -f $output_dir/current
                ln -snf "tree-$new_tree_id" "$output_dir/current"
                info "UI updated"
                title=$(git show --quiet --pretty="format:%s" "$refname" | \
                    sed -e 's/[^A-Za-z][^A-Za-z]*/_/g')
                date=$(git show --quiet --pretty="format:%ci" "$refname" | \
                    sed -e 's/\([0-9]*\)-\([0-9]*\)-\([0-9]*\) \([0-9]*\):\([0-9]*\):\([0-9]*\) +0000/\1\2\3T\4\5\6Z/')
                ln -s "tree-$new_tree_id" "$output_dir/${date}__${title}"
            fi
            ;;
    esac
done 
```

如前所述，这只是检查“ui”子目录。这就是设置 new_tree_id 的 ":ui" 位。只需取出“:ui”（或更改为“^{tree}”）即可查看所有内容。

结帐进入包含 git repo 的目录，由 output_dir 控制。该脚本预计将在 git repo 中运行（这反过来又预计是裸露的）：这不是很干净。

签出被放入“tree-XXXX”目录中，并且“当前”符号链接设法指向最新的。这使得从一个到另一个原子的变化，虽然它不太可能需要这么长时间，这很重要。这也意味着恢复重用旧文件。这也意味着它会在您不断推动修订时占用磁盘空间......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T18:25:47.690

有同样的问题，也与 django 一起工作。

如前所述，同意在部署之前进行本地测试。

然后，您可以将本地版本推送到服务器上的新分支。然后你与这个分支和主分支进行合并。在此之后，您将看到更新的文件。

如果你不小心推到了主分支，那么你可以做一个 git reset --hard。但是，所有未在当前工作分支中提交的更改都将丢失。所以保重。

# java - 使用策略模式的 Java 电子邮件程序

> ID：875703
> 
> 赞同：6
> 
> 时间：2009-05-17T23:05:42.847
> 
> 标签：java, oop, design-patterns, strategy-pattern

**更新：又**增加了一个问题（问题#4）。

大家好，

我正在为自己构建一个自定义电子邮件实用程序。现在，为了遵守单一职责原则，我想要以下类：MailerSender、MailProvider 和 EmailObject。MailSender 更像是一个代表，请查看以下内容：

```
public class MailSender {
    private IMailProvider mailProvider;

    public void setMailProvider (IMailProvider provider) {
        this.mailProvider = provider;
    }

    // option to set it up during construction
    public MailSender (IMailProvider provider) {
        this.mailProvider = provider;
    }

    public void sendEmail(EmailObject obj) {
        if(mailProvider == null)
            throw new RuntimeException("Need a mail provider to send email.");

        try {
            mailProvider.send(obj);
        } catch (Exception e) {
            // do something here
        }
    }
} 
```

MailSender 需要一个 IMailProvider 电子邮件提供商来完成发送电子邮件的工作。在下面找到它：

```
public interface IMailProvider {
    public void sendEmail(EmailObject obj);
}

public class SMTPEmailProvider implements IMailProvider {
    public void sendEmail(EmailObject obj) {
        // use SMTP to send email using passed-in config
    }
}

public class JMSEmailProvider implements IMailProvider {
    public void sendEmail(EmailObject obj) {
        // push emails to JMS queue to be picked up by another thread
    }
} 
```

我在上面定义了一些策略，但它可以扩展到任何数量。由于 MailSender 可以随时更改它的提供者，它有效地实现了策略模式，对吧？

EmailObject 是一个包含相关电子邮件信息的 POJO：

```
public class EmailObject {
    private String to;
    private String from;
    private String cc;
    private String subject;
    private String body;

    // setters and getters for all
} 
```

客户端代码将如下所示：

```
MailSender sender = new MailSender(new SMTPMailProvider());
sender.send(new EmailObject());
sender.setMailProvider(new JMSMailProvider());
sender.send(new EmailObject()); 
```

我的问题是：

1\. 我是否实施了策略模式？
2、这个设计好不好？MailProvider 知道 EmailObject 是否有意义？
3\. 如果我以后有一个新的 EmailObject 需要附件怎么办？
4\. 客户端代码现在需要在创建 MailSender 之前获取特定的 MailProvider ......这有意义吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T23:13:15.417

好的，让我们来看看你的问题。

1）模糊，是的。您可以争辩说您有“算法”或“策略”，并且可以在它们之间进行选择。但是，我更愿意将策略模式视为与算法相关的东西。例如，获取搜索结果的不同方式。在这里，您正在处理您委派发送电子邮件角色的不同代理。这是一种常见的设计，但我不确定我是否一定会称之为策略。无论哪种方式，设计模式都是为了帮助你思考，而不是把你锁在一个特定的名字上。

2）我认为设计是合理的。我会使用接口而不是实际的类，尤其是对于 EMailObject。此外，应该有一个电子邮件对象的工厂，不要只是新建它们。每个提供商也很可能会提供自己的“电子邮件对象”，其中包括包详细信息。您发送的是内容，而不是“信封”。

3）这是使用接口而不是类的另一个好理由。您可能希望包含元数据和潜在附件的 getter/setter，因为它们是您的域（电子邮件）的合法部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T00:18:57.007

在我看来，这里最重要的问题是：

1.  您可以在不发送实际电子邮件的情况下测试您的组件吗？是的：

    ```
    MailSender sender = new MailSender(new FakeMailProvider());
    sender.send(new EmailObject()); 
    ```

2.  您可以在没有其他应用程序的情况下测试您的电子邮件提供商吗？是的：

    ```
    SMTPMailProvider provider = new SMTPMailProvider();
    provider.send(new EmailObject()); 
    ```

您已成功地将提供者与发送者分离。

编辑：第四季度。客户端在发送EmailObject之前需要将具体的MailProvider传递给MailSender。该语句可以转换成这样的形式：“客户要求电子邮件服务发送电子邮件、传递电子邮件数据并选择传输方式（一种发送电子邮件的方式）”。我认为没关系，但是如果您不想每次都指定传输，您可以将其更改为“......然后服务使用配置的传输发送电子邮件”并将提供程序实例化移动到配置中。

# python - python-fastcgi 扩展

> ID：875713
> 
> 赞同：3
> 
> 时间：2009-05-17T23:13:29.190
> 
> 标签：python, fastcgi

没有太多关于[python-fastcgi](http://pypi.python.org/pypi/python-fastcgi) C 库的文档，所以我想知道是否有人可以提供一个简单的例子来说明如何用它制作一个简单的 FastCGI 服务器。一个“Hello World”的例子会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T03:20:07.587

**编辑：**我误读了这个问题。哎呀。

[Jon 的 Python 模块](http://jonpy.sourceforge.net/)是有用模块的集合，包括一个很棒的 FastCGI 模块：http: [//jonpy.sourceforge.net/fcgi.html](http://jonpy.sourceforge.net/fcgi.html)

这是页面中的示例：

```
import jon.cgi as cgi 
import jon.fcgi as fcgi

class Handler(cgi.Handler):
  def process(self, req):
    req.set_header("Content-Type", "text/plain")
    req.write("Hello, world!\n")

fcgi.Server({fcgi.FCGI_RESPONDER: Handler}).run() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T14:45:40.927

我会推荐使用这样一个 fastcgi WSGI 包装器[，](http://svn.saddi.com/py-lib/trunk/fcgi.py)这样你就不会从一开始就被 fastcgi 方法所束缚。

然后是一个简单的 test.fgi 文件，如下所示：

```
#!/usr/bin/env python

from fcgi import WSGIServer

def app(env, start):

    start('200 OK', [('Content-Type', 'text/plain')])
    yield 'Hello, World!\n'
    yield '\n'

    yield 'Your environment is:\n'
    for k, v in sorted(env.items()):
        yield '\t%s: %r\n' % (k, v)

WSGIServer(app).run() 
```

# jsp-tags - 如何用 JSP 标签扩展解决这个问题？

> ID：875715
> 
> 赞同：2
> 
> 时间：2009-05-17T23:15:24.787
> 
> 标签：jsp-tags

从 JSP 和 servlet 开发开始，我在将要插入 JSP 页面的无主体自定义标记方面遇到了一些问题。

完成的步骤：

1.  在目录中成功编写并编译了一个 CustomTag.java（扩展`TagSupport`） ；`WEB-INF/classes`
2.  用一个非常简单的例子定义了 TLD 文件，包括一个无主体标签`<body-content>`的`empty`值；
3.  在 JSP 页面中使用指向我的`/WEB-INF/tlds/site.tld`文件的 taglib 指令的标记。

考虑到所有这些，您是否知道为什么 Tomcat 会发送这样的错误：

> CustomTag 无法解析为类型

提前感谢您的回答，如果您需要更多详细信息，请询问。

* * *

这是我的 TLD 文件：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

< ! DOCTYPE taglib 
    PUBLIC "-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.2//EN" 
    "http://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd">

<taglib>
    <tlib-version>1.0</tlib-version>
    <jsp-version>1.2</jsp-version>
    <short-name>customlib</short-name>
    <description>Custom library.</description>
    <tag>
      <name>header</name>
      <tag-class>HeaderTag</tag-class>
      <body-content>empty</body-content>
      <description>...</description>
    </tag>
</taglib> 
```

* * *

JSP 文件：

```
<%@ page contentType="text/html; charset=UTF-8" language="java" import="java.sql.*" errorPage="" %>
<%@ taglib uri="/WEB-INF/tlds/customlib.tld" prefix="clib" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>title</title>
</head>

<body>
    <clib:header />
</body>
</html> 
```

* * *

HeaderTag 类：

```
import javax.servlet.jsp.JspTagException;
import javax.servlet.jsp.tagext.TagSupport;
import java.io.IOException;

public class HeaderTag extends TagSupport {

    public int doEndTag() throws JspTagException {
        try {
            pageContext.getOut().print("<p>header</p>");
        }
        catch (IOException e) {
            throw new JspTagException("Error.");
        }
        return EVAL_PAGE;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T23:26:42.530

你已经重建和重新部署，对吗？在这种情况下，我最好的猜测是您在 TLD 文件中遗漏了 <tag-class> 指令。

```
<tag>
    <name>cookieIterator</name>
    <tag-class>util.infoTemplates.CookieIterator</tag-class>
    <body-content>JSP</body-content>
</tag> 
```

如果这不是原因，请发布您的 TLD 文件和示例 JSP。

* * *

编辑：所有标签类都必须有一个包。根据 JSP 2.0 规范（JSP 11.2 节）：

> 从 JSP 2.0 开始，引用未命名（也称为默认）包中的任何类都是非法的。

# ajax - onselect 在一个组合中它会在另一个组合中动态更改数据？

> ID：875718
> 
> 赞同：0
> 
> 时间：2009-05-17T23:15:56.423
> 
> 标签：ajax, jsp, dynamic, load, onchange

您好先生，我是 jsp 和 ajax 世界的新手。我的问题是如果我选择一个组合选项，那么它应该动态更改其他组合选项而无需按下提交按钮。例如，如果我选择国家，那么它应该在其他组合中显示他们的状态。我使用 servlet & JSP 和 MS-ACCESS 作为后端。请尽可能尽快回复。

感谢您....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T02:06:51.130

你需要：

1.  一段JSP，它返回一个可以在javascript中解析的字符串，以创建一个可能的组合框项目（值，名称）列表，以在第二个组合框中选择，基于可以在第一个组合框中选择的值
2.  一段 javascript，它接收 FIRST 组合框的 onChange 事件并使用然后选择的值来创建一个 XMLHTTP 请求到您的 JSP（在 1）
3.  一段 javascript，您可以将其传递给 XMLHTTP-request onReadyStateChange 事件以执行，它读取/解析可解析字符串（从 1 开始）并用这些值填充第二个 COMBOBOX

祝你好运

# social-networking - 如何学习必要的人类学来创建社交软件？

> ID：875719
> 
> 赞同：6
> 
> 时间：2009-05-17T23:17:05.983
> 
> 标签：social-networking

Joel Spolsky 今天一遍又一遍地重复这一点，了解一点人类学对程序员来说可能非常有用，因为所创建的大部分内容都是社交软件。

已经了解计算机科学的人如何学习了解人类如何工作所需的人类学？有什么书吗？有录音讲座吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T23:32:11.610

我同意，现在对于开发人员来说，了解我们的想法比以往任何时候都更加重要。丹·丹尼特 (Dan Dennett)所著的《[意识解释](https://rads.stackoverflow.com/amzn/click/com/0316180661)》一书让我大开眼界，让我明白我们的思维方式与我们认为的方式不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T23:27:00.297

我建议[Clay Shirky 的网站](http://www.shirky.com/)是一个不错的起点。它是在互联网背景下设置的社会人类学，因此（程序员）比纯粹的学术人类学更容易获得它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-22T23:46:26.670

我不确定接近当代人类学是一个整体是发展你所寻求的知识的绝对最佳方式。人类学家研究了很多不同的东西，虽然知道这些东西会帮助你开发更好的设计和产品，但在这种情况下，成为一名通才可能不是有效地利用时间。

人类学家研究*文化*，当你把一群人放在很近的地方，让情况缓和一段时间时，就会发生上层建筑的东西。为粗略的定义道歉。了解文化、文化和社会如何运作、是什么导致它们崩溃、是什么导致它们蓬勃发展，这些都是令人着迷和有用的。阅读“人类学大炮”将帮助您开始理解这一点，但又是漫长的道路，我认为您需要回答的问题通过一些具体的项目更容易解决。

首先，我想暂时描述一下人类学的特征：尽管人类学不是一个*实验*领域，但它是令人难以置信的 *经验性*。人类学家收集了大量数据，并试图尽可能完整地描述他们所看到的。这种方法论和方法——我认为——对软件开发人员非常有用。根据您的经验，很容易就软件的某个功能或方面说“人们想要这个”或“用户有这种感觉”。很难以精确的方式弄清楚用户的实际感受和与您的软件交互的方式。如果您必须以软件开发人员的身份参加人类学课程，我会推荐一些强调方法论的课程。

在具体资源方面，我想到了以下方向

Dona Harroway 的“ [The Cyborg Manifesto](http://www.stanford.edu/dept/HPS/Haraway/CyborgManifesto.html) ”作为一个研究领域的基础工作，立即浮现在脑海中，该研究探讨了人和机器之间的互动，以及作为一种社会现象的机器。它很短。好读。[Amber Case](http://www.oakhazelnut.com/)是一位年轻的“半机械人人类学家”，确实在 Harroway 的传统中工作，我会跟进这两个人。

其次，我会探索对城市和小社区的研究。除了在一些非常极端的情况下（例如 Twitter、Facebook 等），整个文化都不会使用您的软件。团体是。了解他们。我认为被称为“城市社会学”的城市研究和工作可能会开始为您提供您感兴趣的答案。我认为这是一个很好的起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T23:28:26.970

我听说有一本书很好，但还没有机会深入研究它：[编程集体智慧](http://oreilly.com/catalog/9780596529321/)。它为您提供了一些算法来量化社交软件中的人类行为。听起来不错。

Mathew Podwysocki 前段时间写了一篇关于[在 Haskell 中实现这些想法的](http://weblogs.asp.net/podwysocki/archive/2009/04/17/haskell-and-collective-intelligence.aspx)文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T23:40:22.527

[日常用品的设计](https://rads.stackoverflow.com/amzn/click/com/0465067107)

[人性化的界面](https://rads.stackoverflow.com/amzn/click/com/0201379376)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T23:21:14.663

了解社交软件的唯一规则是“人们会做任何事来赚钱或上床”:)

但严肃地说，我认为人类学并不重要，重要的是理解人们必须为社交软件做出贡献或在社交软件上展示自己的动机。最近有不少书籍很好地解释了这些概念。一个好的开始可能是 Clay Shriky 的“Here come everyone”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-21T15:20:16.090

这里的许多答案都指向关于意识如何工作或人们如何与设备交互的文本。这是一个很好的开始，因为它显示了您想去的地方。除此之外，您还可以考虑了解人类工作方式的基本社会和经验方面。通过这种方式，您可以在了解人类如何体验您的软件以及它如何成为社交世界的一部分的情况下开发软件。

为此，我推荐 Mary Midgley 的 The Ethical Primate。本书是关于哲学、伦理、自由和进化的，但它牢牢地植根于经验知识。它还将为您提供工具，使您能够批判性地检查语言和知识——根据我作为计算机科学专业的经验——STEM 通常在讨论人时使用。如果您想阅读关于 STEM 语言在描述人类时的危险的最后一点的简短文本，您可以阅读 Mary Midgley 的生物技术和畸形。

一个较少涉及关于人类理论化的伦理和社会影响的文本是纠结的翅膀。

有许多民族志描述了人们如何与社交媒体等技术进行交互。这些更具体到您正在研究的技术类型。

# c# - 如何在 codedom 编译的代码中调试/中断

> ID：875723
> 
> 赞同：22
> 
> 时间：2009-05-17T23:21:24.913
> 
> 标签：c#, .net, debugging, code-generation

我有一个动态加载 c# 源文件并将它们作为插件运行的应用程序。当我在调试模式下运行主应用程序时，是否可以调试到动态程序集中？显然设置断点是有问题的，因为源不是原始项目的一部分，但是我应该能够进入或中断代码的异常吗？

有没有办法让codedom为此或其他东西生成PDB？

这是我用于动态编译的代码。

```
CSharpCodeProvider codeProvider = new CSharpCodeProvider(new Dictionary<string, string>() { { "CompilerVersion", "v3.5" } });
//codeProvider.
ICodeCompiler icc = codeProvider.CreateCompiler();

CompilerParameters parameters = new CompilerParameters();
parameters.GenerateExecutable = false;
parameters.GenerateInMemory = true;
parameters.CompilerOptions = string.Format("/lib:\"{0}\"", Application.StartupPath);
parameters.ReferencedAssemblies.Add("System.dll");
parameters.ReferencedAssemblies.Add("System.Core.dll");

CompilerResults results = icc.CompileAssemblyFromSource(parameters, Source);
DLL.CreateInstance(t.FullName, false, BindingFlags.Default, null, new object[] { engine }, null, null); 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-18T00:06:11.920

尝试以下选项：

```
parameters.GenerateInMemory = false; //default
parameters.TempFiles = new TempFileCollection(Environment.GetEnvironmentVariable("TEMP"), true);
parameters.IncludeDebugInformation = true; 
```

我不确定这在您的情况下是否可以正常工作，但如果可以，您可以使用条件编译指令将此参数括起来，以便它仅在调试模式下转储生成的程序集。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-11-25T14:09:07.577

[@bbmud](https://stackoverflow.com/a/875796/109702)的答案是正确的，尽管它错过了一个错误修复。CSharpCodeGenerator（.NET 中将 C# 代码编译为 IL 的类）设置为在创建 pdb 文件后立即删除它们，除非您添加`/debug:pdbonly`到 CompilerOptions 字符串。但是，如果您这样做，该`IncludeDebugInformation`标志将被忽略，并且编译器会生成难以调试的优化代码。为避免这种情况，您必须明确告诉代码生成器保留所有文件。

这是完整的食谱：

```
parameters.GenerateInMemory = false; //default
parameters.TempFiles = new TempFileCollection(Environment.GetEnvironmentVariable("TEMP"), true);
parameters.IncludeDebugInformation = true;
parameters.TempFiles.KeepFiles = true 
```

这是CSharpCodeGenerator代码的罪魁祸首部分：

```
 string fileExtension = "pdb";
    if ((options.CompilerOptions != null) && (CultureInfo.InvariantCulture.CompareInfo.IndexOf(options.CompilerOptions, "/debug:pdbonly", CompareOptions.IgnoreCase) != -1))
    {
        results.TempFiles.AddExtension(fileExtension, true);
    }
    else
    {
        results.TempFiles.AddExtension(fileExtension);
    } 
```

告诉编译器`TempFiles.AddExtension(fileExtension, true)`保留 pdb 文件。*else*选项`results.TempFiles.AddExtension(fileExtension);`告诉它将 pdb 视为所有临时文件，默认情况下意味着删除它们。

# jquery - JQUERY 未定义

> ID：875729
> 
> 赞同：1
> 
> 时间：2009-05-17T23:24:11.723
> 
> 标签：jquery, undefined

我收到“JQUERY 未定义”错误。你有什么想法（下面的代码）。

```
<%@ Page Language="C#" AutoEventWireup="true" Inherits="faturaYazici2" CodeBehind="faturaYazici2.aspx.cs" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<link href="JS/reset-fonts-grids.css" rel="stylesheet" type="text/css" />

<script src="JS/boxy/jquery.boxy.js" type="text/javascript"></script>

<script src="JS/jquery-1.3.2.min.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function() {
        window.print();
    });
</script>
........
........... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T23:32:01.860

您在 jQuery 之前引用了 Boxy 插件。像这样重新排序您的脚本标签：

```
<script src="JS/jquery-1.3.2.min.js" type="text/javascript"></script>
<script src="JS/boxy/jquery.boxy.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T23:25:46.307

是你的 jQuery 脚本

```
<script src="JS/jquery-1.3.2.min.js" type="text/javascript"></script> 
```

加载成功？

尝试将其替换为

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script> 
```

（从 Google 的网站加载 jQuery）看看是否可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-20T22:56:30.200

您的 Asp.Net 应用程序中是否启用了安全性。我的是。因此，无法加载 jquery 文件。将以下行添加到您的 web.config：

```
<location path="JS">
    <system.web>
        <authorization>
            <allow users="*" />
        </authorization>
    </system.web>
</location> 
```

# c++ - 向调用线程发出资源已在使用中的信号

> ID：875743
> 
> 赞同：2
> 
> 时间：2009-05-17T23:30:08.340
> 
> 标签：c++, windows, multithreading, concurrency

抽象的问题......
我们有一个结构，可以由 2 或 3 个线程同时访问。
如果结构已被修改，我们希望向尝试修改结构的线程发出信号。

例如此刻的代码：

```
thread0: struct->modify(var SomeNewState)
thread1: struct->modify(var SomeNewState)
thread2: struct->modify(var SomeNewState)  

void struct::modify(var SomeNewState) {
    EnterCriticalSection(&criticalSection);
    change some state...
    LeaveCriticalSection(&criticalSection);
} 
```

我们想要做的是`struct::modify()`立即返回以指示是否正在使用criticalSection。也就是说，我们*不希望其他线程在这个 criticalSection 上等待*。

我们需要这样做的原因是“获胜”中的第一个线程，我们不希望其他线程等待陈旧状态。只要调用不是并发的，状态就有效（状态在其他地方排队）。状态改变本身并不是一个长时间的操作，但会产生需要很长时间（3-4 秒）才能发生的实际后果。

编辑：
解决方案是这样的。

```
int struct::modify(var SomeNewState) {
    if(TryEnterCriticalSection(&criticalSection)) {
        change some state...
        LeaveCriticalSection(&criticalSection);
        return 0;
    }
    else {
        return 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T23:43:56.980

你在使用 Windows 吗？

[TryEnterCriticalSection](http://msdn.microsoft.com/en-us/library/ms686857(VS.85).aspx)

[编辑：固定链接]

# jquery - 如何同时制作两个jquery-ajax进程？

> ID：875744
> 
> 赞同：0
> 
> 时间：2009-05-17T23:30:57.293
> 
> 标签：jquery, ajax

我尝试在同一页面中调用 2 个函数同时提交 jquery-ajax 以处理差异任务（函数 1 是将新记录插入数据库，函数 2 是每 5 秒读取一次数据库，然后显示来自html 表中的数据库）。

在我调用函数 1 之前，页面工作正常，调用函数 2 以每 5 秒读取一次记录并在页面上显示记录，但是一旦我调用函数 1 插入新记录，函数 2 似乎在队列中等待并且仅在功能 1 兼容后才开始处理。但是，我很确定这个问题不是因为在函数 1 插入新记录时数据库被锁定。

有谁知道如何同时进行两个 jquery-ajax 处理？有关我的代码的更多详细信息，请参见下文：

HTML：

```
<table style='width:100%' border="0">
    <tr>
        <td width="120"><input onclick="submitAction()" type="button" value="Process"></td>
    </tr>
</table>

<script>
    var myInterval = setInterval('getUpdatedRecord()', 5000);
</script> 
```

Javascript：

```
function submitAction()
{
    var paramList = "Action=make_process";

    ajaxRequest = $.ajax({
        url: "ord_process.php",
        type: 'POST',
        data: paramList,
        error: function(){
             msgObj.innerHTML = '<div style="width:313px; padding-top:40px;"><p class="cAlign">Connecton error.<br>Please try again.</p></div>';
                },
        success: function(data){
         var endDateTime = getCurrentDateTime();
         msgObj.innerHTML = ''; 
        alert("  "+data+"\n\n  Start Date&Time : "+startDateTime+"\n    End Date&Time : "+endDateTime)
            }   
     });    
}

function getUpdatedJobRecord()
{
    var paramList = "Action=get_job_record&call=ajax";

    ajaxRequest = $.ajax({
            url: "ord_process.php",
            type: 'POST',
            data: paramList,
            error: function(){
                msgObjB.innerHTML = update_date;
                msgObjA.innerHTML = '<td><div style="width:313px; padding-top:40px;"><p class="cAlign">Connecton error.<br>Please try again.</p></div></td>';
            },
            success: function(data){
                msgObjB.innerHTML = update_date;
                msgObjA.innerHTML = data;
            }       
    }); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T00:05:03.343

您是否检查过文档：[http](http://docs.jquery.com/Ajax/jQuery.ajax) ://docs.jquery.com/Ajax/jQuery.ajax 尝试了异步选项？另一种解决方案可能是（虽然它很难看）复制 ord_process.php 脚本并查看问题是否是由于某些内部队列或其他原因。

# php - Zend 框架中的动态默认模块

> ID：875747
> 
> 赞同：7
> 
> 时间：2009-05-17T23:31:49.833
> 
> 标签：php, zend-framework, module

有谁知道在 Zend Framework 中动态设置默认模块而不遇到命名空间问题的方法？例如，我想要做的是有一个允许加载的模块表，其中一个设置为默认模块。例如，我可能有：

```
admin
blog
calendar 
```

作为可以加载的模块。如果我将“blog”作为默认模块，那么“admin”和“calendar”必须将它们的控制器命名为命名空间（Admin_IndexController、Calendar_IndexController），而“blog”则不是（IndexController）。

如果我将“日历”更改为默认模块，ZF 由于命名空间而无法再找到这些类。

你怎么解决这个问题？我目前正在使用以下代码：

```
$modules = new Modules();
$activeModules = $modules->fetchActive();
foreach($activeModules as $mod) {
    $loadedModules[$mod->name] = '..application/modules/' . $mod->name . '/controllers';
    if($mod->default) {
        $defaultModule = $mod->name;
    }
}
$frontController->setControllerDirectory($loadedModules);
$frontController->setDefaultModule($defaultModule); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T19:17:47.647

如果您打算更改默认模块，最好将**所有**模块命名为命名空间，然后指定默认模块应作为前缀：

首先更改“博客”模块以使用命名空间：

```
<?php

// Used to be "class IndexController"
class Blog_IndexController extends Zend_Controller_Action {

} 
```

然后，在 Zend_Controller_Front 实例上为**prefixDefaultModule**选项调用**setParam ：**

 **```
<?php

    // Allow your default module to be prefixed
    $frontController->setParam('prefixDefaultModule', true); 
```

有关解释，请参见[错误 # 1831](http://framework.zend.com/issues/browse/ZF-1831)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-19T08:22:04.357

使用application.ini：resources.frontController.prefixDefaultModule = true resources.frontController.defaultModule = default

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T18:55:40.703

您可以使默认模块实际上成为整个过程中的决定部分。更具体地说 - 使默认模块的所有请求都转到一个类，然后该类将决定哪个特定模块当前是默认模块，并将请求重新路由到它。

至少这是我们实现它的方式；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T21:32:16.127

听起来像是 preDispatch 控制器插件的工作。

您可以根据某些请求或身份/会话/已知数据修改请求以更改模块，以按需转发或重定向。

# ruby - 在页面中测试登录

> ID：875752
> 
> 赞同：1
> 
> 时间：2009-05-17T23:33:47.600
> 
> 标签：ruby, login

我必须在工作中访问一些页面，然后登录它们以报告任何问题。我正在考虑编写一个程序来做到这一点。

首先，我必须能够访问这些页面，然后我必须找到登录表单并发送信息。目前，我计划为每个测试（可访问性和登录）打印真/假，然后自己填写表格。我希望以后能够写一些东西来自动化它。

我正在考虑使用 Ruby，虽然我还没有编写过代码，但它似乎会让整个事情变得更容易。我用 Java 工作得最多，虽然我有一些 C++ 经验和一点 C 经验。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T23:58:10.363

您可以使用[Selenium IDE](http://seleniumhq.org/projects/ide/)。它是用于简单 Web 测试的记录和回放工具，然后您可以将其保存为 Selenium RC 的任何您想要的语言的测试。我希望它有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T00:09:06.937

Python urllib2 模块很容易让您与 HTTP 服务器交互。您可以使用 urrlib2 读取页面以验证内容。您可以使用 urlencoded 表单数据进行 POST 并验证内容。

此外，Python 有一个简单的 unittest 库，可以帮助您构建测试。

```
class TestForm( unittest.TestCase ):
    def testFillInForm( self ): 
        data= urllib.urlencode( { field1="value", field2="value" } )
        response= urllib2.urlopen( "http://localhost/path/to/form", data )
        # check the response

if __name__ == "__main__":
    unittest.main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T23:35:58.420

Ruby、PHP 和 Python 都有易于使用的 HTTP 库，这使得这种操作非常容易。这些语言中的任何一种都可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:56:06.367

如果你想这样做是红宝石，机械化宝石将是完美的

`需要'机械化'

代理 = WWW::MECHANIZE.new page = agent.get('localhost/path/to/form')

login_form = page.forms.first #假设第一个表单是我们想要的

login_form.username = '我的用户名'

login_form.password = '我的密码'

page = agent.submit(login_form)

puts page.body # 只是为了看结果`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T03:10:36.547

我发现 CURL 在 PHP 下也非常有用且易于使用。简单易学。

处理 cookie、HTTPS 等。

都好。

# php - 链接 Facebook 连接

> ID：875755
> 
> 赞同：2
> 
> 时间：2009-05-17T23:34:35.303
> 
> 标签：php, mysql, facebook

我已经开始将 Facebook Connect 与我的应用程序集成在一起。不过，我有一点缺乏知识的问题。

我可以完美地让您登录我网站上的 Facebook Connect 等，显示您的详细信息，所有 FB Connect 功能都可以使用。但是，我该如何做才能将 facebook 用户 ID 作为当前用户信息的一部分存储到我的 MySQL 数据库中？那么，如果他们已授予访问权限，我如何将他们自动登录到 Facebook Connect？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-06T23:17:05.360

您必须在 facebook 登录过程中在您的站点中创建新用户，以便下次可以使用保存的数据。您必须修改您的用户表并为新数据添加一些字段（例如 facebook id）。我用 PHP 和 MySql 写了一篇关于它的教程：

> [http://www.barattalo.it/facebook-connect-tutorial/](http://www.barattalo.it/facebook-connect-tutorial/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T18:15:48.500

使用 PHP Facebook 客户端库，您应该能够在“页面”顶部添加以下内容：

```
$api_key = "YOUR APP API KEY";
$api_secret = "YOUR API SECRET KEY";

$facebook = new Facebook($api_key, $api_secret);
$facebook_id = $facebook->get_loggedin_user(); 
```

如果用户已登录，$facebook_id 将设置为他们的 facebook id (BIGINT)。如果不是，它将为空。请注意，用户需要在他们的浏览器中启用第三方 cookie 才能在最初的“连接”调用之后工作。在这种情况下，您可以使用 API 来获取登录用户：

```
$facebook->api_client->users_getLoggedInUser(); 
```

所以基本上（伪）：

```
if (!is_null($facebook_id))
{
    // authenticate user on your site with local cookie or session
    // pull user data from users table by "$facebook_id"
    // if user isn't in the database, create a new row with their facebook id
}
else
{
    // show the connect button?
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T09:07:24.843

你看过clickpass.com吗？让您使用许多不同的 ID 登录您的网站。刚刚在 python 站点上安装需要一段时间，但看起来不错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-05T09:18:15.653

这里是链接解释只是
[https://developers.facebook.com/docs/facebook-login/multiple-providers](https://developers.facebook.com/docs/facebook-login/multiple-providers)
它解释了使用 facebook connect 的不同场景

# ruby-on-rails - 如何在 Ruby On Rails 中将数字四舍五入到动态精度？

> ID：875756
> 
> 赞同：5
> 
> 时间：2009-05-17T23:35:26.707
> 
> 标签：ruby-on-rails, rounding

我想将数字四舍五入到最接近的数量级。（我想我说的对）

这里有些例子：

```
Input => Output

8 => 10
34 => 40
99 => 100
120 => 200
360 => 400
990 => 1000
1040 => 2000
1620 => 2000
5070 => 6000
9000 => 10000 
```

有人知道用 Ruby 或 Rails 快速编写它的方法吗？

本质上，我需要知道数字的数量级以及如何按该精度四舍五入。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-18T00:30:55.807

这是另一种方式：

```
def roundup(num)
  x = Math.log10(num).floor
  num=(num/(10.0**x)).ceil*10**x
  return num
end 
```

更通俗地说：

```
def roundup(num)
  x = Math.log10(num).floor
  (num/(10.0**x)).ceil * 10**x
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T00:24:08.367

这是一个解决方案。它执行以下规则：

*   不修改 0 和 10 的幂；
*   9？？？向上取整到 10000（无论多长时间）；
*   一种？？？向上舍入到 B000（无论多长），其中 B 是 A 后面的数字。

.

```
def roundup(n)
  n = n.to_i
  s = n.to_s
  s =~ /\A1?0*\z/ ? n : s =~ /\A\d0*\z/ ? ("1" + "0" * s.size).to_i :     
      (s[0, 1].to_i + 1).to_s + "0" * (s.size - 1)).to_i
end

fail if roundup(0) != 0
fail if roundup(1) != 1
fail if roundup(8) != 10
fail if roundup(34) != 40
fail if roundup(99) != 100
fail if roundup(100) != 100
fail if roundup(120) != 200
fail if roundup(360) != 400
fail if roundup(990) != 1000
fail if roundup(1040) != 2000
fail if roundup(1620) != 2000
fail if roundup(5070) != 6000
fail if roundup(6000) != 10000
fail if roundup(9000) != 10000 
```

# sql - SQL 中的 Charindex 没有给出想要的结果

> ID：875759
> 
> 赞同：1
> 
> 时间：2009-05-17T23:38:11.877
> 
> 标签：sql, sql-server, tsql

我有一个字符串，它是函数的输出，例如：“1,3,16,..,..”。

我使用了以下 SQL 查询并在 Visual Studio 的查询生成器中运行它，它没有给我任何语法错误。

```
SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE (ItemID = cast(charindex(',', @itemIDs) as int)) 
```

我给了 3,16 作为 @itemID 参数值，但它没有给出预期的结果。

然后我使用了以下 SQL 查询（没有 charindex）：

```
SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE (ItemID = @itemIDs) 
```

我给了 3 作为@itemID 参数值，我得到了它的结果。我还给出了 16（在单独的场合）作为 @itemID 参数值，我得到了它的结果。我得出结论，ItemID 3 和 16 有值。

为什么带有 charindex 的 SQL 查询没有给我任何结果？

我似乎无法弄清楚这里的问题，请帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T11:03:41.700

这是另一个解决方案。根据我的经验，当您将 ItemIds 列表作为逗号分隔值的字符串时，您需要一个拆分函数。这是非常有用的。

使用 split 函数，您可以简单地使用调用 split 函数并传递 ItemIds 列表和相关分隔符的结果进行 INNER JOIN，如下所示：

```
DECLARE @ItemIDs varchar(100)
SET @ItemIDs = '1,3,16,22,34,35'

SELECT 
     ItemID, Name, RelDate, Price, Status 
FROM item_k
     INNER JOIN dbo.UTILfn_Split(@ItemIDs,',') itemIds 
       ON itemIds.Value = item_k.ItemID 
```

虽然这可能看起来很复杂，但它是更优雅和可维护的解决方案。下面是创建**[dbo.UTILfn_Split](http://www.devx.com/tips/Tip/20009)**函数的代码。你需要先运行这个：

```
IF EXISTS (SELECT * FROM sysobjects WHERE id = 
object_id(N'[dbo].[UTILfn_Split]') AND xtype IN (N'FN', N'IF', N'TF'))
DROP FUNCTION [dbo].[UTILfn_Split]
GO

CREATE FUNCTION dbo.UTILfn_Split
(
    @String nvarchar (4000),
    @Delimiter nvarchar (10)
)
RETURNS @ValueTable TABLE ([Value] nvarchar(4000))
BEGIN
 DECLARE @NextString nvarchar(4000)
 DECLARE @Pos int
 DECLARE @NextPos int
 DECLARE @CommaCheck nvarchar(1)

 --Initialize
 SET @NextString = ''
 SET @CommaCheck = RIGHT(@String,1)  
 --Check for trailing Comma, if not exists, INSERT
 --if (@CommaCheck <> @Delimiter )
 SET @String = @String + @Delimiter

 --Get position of first Comma
 SET @Pos = CHARINDEX(@Delimiter,@String)
 SET @NextPos = 1

 --Loop while there is still a comma in the String of levels
 WHILE (@pos <>  0)  
 BEGIN
  SET @NextString = SUBSTRING(@String,1,@Pos - 1)

  INSERT INTO @ValueTable ( [Value]) Values (@NextString)

  SET @String = SUBSTRING(@String,@pos +1,LEN(@String))

  SET @NextPos = @Pos
  SET @pos  = CHARINDEX(@Delimiter,@String)
 END 
 RETURN
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T23:51:59.303

[`CHARINDEX`](http://msdn.microsoft.com/en-us/library/ms186323.aspx)只返回在字符串中找到字符的位置。

所以当`@ItemIDs`设置为`'3,16'`then 你的`WHERE`子句...

```
WHERE (ItemID = CAST(CHARINDEX(',', @ItemIDs) AS INT)) 
```

……相当于……

```
WHERE ItemID = 2 
```

...因为`CHARINDEX`返回`2`，因为在字符串的位置 2 找到了逗号字符`'3,16'`。

我猜*（a）*您的表中没有行 where `ItemID`is `2`，并且*（b）*您真的不希望逗号的位置来指示返回哪些行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T00:47:59.043

您可以动态创建使用`in`运算符的查询：

```
declare @Sql varchar(1000)
set @Sql = 'select ItemID, Name, RelDate, Price, Status from item_k where ItemID in (' + @itemIDs + ')'
exec(@Sql) 
```

不过，请小心发送到程序中的内容。与任何动态 SQL 一样，如果数据来自未经验证的用户输入，则该过程对 SQL 注入开放。

编辑：
这是查询中发生的事情：

首先我们声明一个变量来保存动态查询。这只是一个`varchar`足够大的变量。

在变量中，我们将@itemIDs 变量放在两个字符串之间以形成查询。逗号分隔的值放在`in`运算符的括号之间以形成类似于以下内容的表达式：`where ItemID in (1,3,16)`

最后，该`exec`命令执行变量中的查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T00:26:47.410

尝试 SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE ItemID in (@itemIDs)

# php - 在创建 PHP 类实例时运行代码？

> ID：875760
> 
> 赞同：2
> 
> 时间：2009-05-17T23:38:20.957
> 
> 标签：php, class, object

我希望代码在我创建新对象时运行。例如，看到这个：

```
<?php

class Test {
echo 'Hello, World!';
}

$test = new Test;

?> 
```

我希望它回响“你好，世界！” 每当我创建该对象的新实例时，之后不调用函数。这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T23:42:26.703

你应该阅读[构造函数](http://www.php.net/manual/en/language.oop5.decon.php)

```
<?php
class MyClass {
   public function __construct() {
      echo "This code is executed when class in instanciated.";
   }
}
?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T23:41:43.913

```
class Test {
 function __construct(){
    echo 'Hello, World!';
 }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T00:32:46.083

或者在 PHP 4 上使用：

```
class Test {
    function Test {
        echo 'Hi';
    }
} 
```

编辑：这也适用于 PHP 5，所以这是最好的方法。

# wpf - 仅使用集合项的子集的 WPF 绑定到组合

> ID：875763
> 
> 赞同：4
> 
> 时间：2009-05-17T23:40:24.523
> 
> 标签：wpf, binding, combobox, observablecollection

我正在尝试仅使用选择的集合对象将 TwoWay 绑定设置到组合框。目前，如果我只想绑定集合中的所有内容，一切正常，但在下面的示例类中，如果我只想显示 Active=True 的项目怎么办？我可以使用 LINQ 过滤项目，例如 ItemsSource = FROM x IN Coll WHERE x.Active=True 但随后我失去了 TwoWay 绑定。即，如果源中的名称或活动状态是从其他地方更新的，则组合框不会自动更新。

有可能吗？如果没有，是否有人不得不处理这个问题有一些建议？

```
'The Class
Public Class Test
    Implements ComponentModel.INotifyPropertyChanged

    Private _Name As String
    Private _Active As Boolean

    Public Sub New(Name As String, Active As Boolean)
        _Name=Name
        _Active=Active
    End Sub

    Public Property Name() As String
End Class

'Declare a Collection and add some Tests, then bind to Cbo in Page Load
Dim Coll As New ObservableCollection
Coll.Add(New Test("Test1", True))
Coll.Add(New Test("Test2", False))
Coll.Add(New Test("Test3", True))
TheComboBox.ItemsSource=Coll 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T23:45:25.293

两种选择：

您可以使用像[Bindable LINQ](http://bindablelinq.codeplex.com)这样的框架，使您的 LINQ 查询返回可观察的集合（因此绑定保持为双向）。

或者，您可以将 ComboBox 的项目绑定到 CollectionViewSource 并通过 Filter 事件处理程序运行每个项目：

```
<CollectionViewSource
    Source="{Binding MyItems}"
    Filter="OnlyActiveItems"
    x:Key="ItemsView"/>

<ComboBox ItemsSource="{Binding Source={StaticResource ItemsView}}" /> 
```

带有代码隐藏：

```
private void OnlyActiveItems(object sender, FilterEventArgs e)
{
    e.Accepted = false;

    var item = e.Item as Text;
    if (item == null) return;

    e.Accepted = item.Active;
} 
```

请注意，我不完全确定 CollectionViewSource 将识别 INotifyPropertyChanged 接口并在一个元素更改时重新查询列表。如果过滤器方法不起作用，我真的建议 Bindable LINQ。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T08:00:19.773

CollectionViewSource 类可以向任何 WPF 项控件添加排序和过滤

# python - 如何使用 Python 对字符串进行编码和解码以在 URL 中使用？

> ID：875771
> 
> 赞同：4
> 
> 时间：2009-05-17T23:45:12.343
> 
> 标签：python, string, hash, urlencode, clean-urls

我有一个这样的字符串：

```
String A: [ 12234_1_Hello'World_34433_22acb_4554344_accCC44 ] 
```

我想加密字符串 A 以在干净的 URL 中使用。像这样的东西：

```
String B: [ cYdfkeYss4543423sdfHsaaZ ] 
```

python中是否有编码API，给定字符串A，它返回字符串B？python中是否有解码API，给定字符串B，它返回字符串A？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-26T10:27:29.437

请注意，编码和加密之间存在巨大差异。

如果你想发送敏感数据，那么不要使用上面提到的编码；）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-17T23:51:22.347

进行编码/解码的一种方法是使用包 base64，例如：

```
import base64
import sys

encoded = base64.b64encode(sys.stdin.read())
print encoded

decoded = base64.b64decode(encoded)
print decoded 
```

是你要找的吗？根据您的特殊情况，您会得到：

输入：12234_1_Hello'World_34433_22acb_4554344_accCC44

编码：MTIyMzRfMV9IZWxsbydXb3JsZF8zNDQzM18yMmFjYl80NTU0MzQ0X2FjY0NDNDQ=

解码：12234_1_Hello'World_34433_22acb_4554344_accCC44

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T23:54:47.640

您是否要加密字符串或对其进行编码以删除 url 的非法字符？如果是后者，您可以使用[`urllib.quote`](http://docs.python.org/library/urllib.html#quote)：

```
>>> quoted = urllib.quote("12234_1_Hello'World_34433_22acb_4554344_accCC44")
>>> quoted
'12234_1_Hello%27World_34433_22acb_4554344_accCC44'

>>> urllib.unquote(quoted)
"12234_1_Hello'World_34433_22acb_4554344_accCC44" 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-17T23:56:46.250

您是在加密、压缩还是只是 urlencoding 之后？该字符串可以在 urlencoding 之后传递，但这不会像您的示例那样使其更小。压缩可能会缩小它，但您仍然需要对结果进行 urlencode。

你真的需要对查看者隐藏字符串数据（例如敏感数据，不应该被阅读你肩膀的 URL 的人查看）吗？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-18T00:41:19.730

为了使它非常简短-> 只需在数据库中插入一行。存储类似`(id auto_increment, url)`元组列表的东西。然后您可以`base64`对 id 进行编码以获得“代理 url”。通过解码 id 并在数据库中查找正确的 url 来解码它。或者，如果您不介意标识符看起来是连续的，只需使用数字即可。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-17T23:54:06.503

从 python 2.4 开始，base64 模块提供了对来自不同基数的字符串的编码和解码。

在您的示例中，您将执行以下操作：

```
import base64
string_b = base64.b64encode(string_a)
string_a = base64.b64decode(string_b) 
```

完整的 API： [http ://docs.python.org/library/base64.html](http://docs.python.org/library/base64.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-18T00:43:06.090

很难减小字符串的大小并保留任意内容。

您必须将数据限制为可以有效压缩的数据。

您的替代方法是执行以下操作。

1.  将“URL 中的所有参数”保存在数据库行中。

2.  为这个参数集合分配一个 GUID 键。

3.  然后提供该缩短的 GUID 密钥。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T03:36:04.857

另一种也可以缩短字符串的方法是计算字符串的 md5/sha1 哈希（如果您愿意，可以与种子连接）：

```
import hashlib
>>> hashlib.sha1("12234_1_Hello'World_34433_22acb_4554344_accCC44").hexdigest()
'e1153227558aadc00a2e90b5013fdd6b0804fdfb' 
```

理论上，您应该得到一组碰撞很少且长度固定的字符串。该[`hashlib`](http://docs.python.org/library/hashlib.html)库具有一系列不同的哈希函数，您可以以这种方式使用，具有不同的输出大小。

编辑：你还说你需要一个可逆的字符串，所以这不起作用。然而，Afaik，许多像您这样使用干净 URL 的 Web 平台似乎想要实现使用哈希函数来计算缩短的 URL，然后将该 URL 与页面的其他数据一起存储以提供反向查找功能。

# wpf - WPF DataGrid - 结合 TimeSeries w/MultiBinding，丢失更改通知。为什么？

> ID：875773
> 
> 赞同：3
> 
> 时间：2009-05-17T23:45:27.227
> 
> 标签：wpf, data-binding, observablecollection

我有一个有两个 ObservableCollection<TimeValue> 的类，其中 TimeValue 是一个自定义 DateTime/Value 与更改通知配对（通过 INotifyPropertyChanged）。我称这些为目标和实际值。

当我将它们绑定到图表时，一切正常，我得到了两个 LineSeries。如果我将其中一个绑定到 DataGrid，其中有一列用于“日期”，一列用于“值”，则可以再次完美运行。我什至得到了我需要的双向绑定。

但是，我需要有一个 DataGrid，它有一个“日期”列，以及一个用于 Targets 和 Actuals 的列。问题是我需要列出一个范围内的所有日期，而其中一些日期可能在 Targets、Actuals 或两者中没有对应的值。

所以，我决定做一个 MultiBinding，它以 Targets 和 Actuals 作为输入，并输出一个组合的 TimeSeriesC，只要其中一个原件没有价值，它就具有空值。

它有效，但不响应基础数据的任何变化。

这很好用（绑定到一个 ObservableCollection）：

```
<ctrls:DataGrid Grid.Row="1" Height="400" AutoGenerateColumns="False" CanUserDeleteRows="False" SelectionUnit="Cell">
<ctrls:DataGrid.ItemsSource>
    <Binding Path="Targets"/>
    <!--<MultiBinding Converter="{StaticResource TargetActualListConverter}">
        <Binding Path="Targets"/>
        <Binding Path="Actuals"/>
    </MultiBinding>-->
</ctrls:DataGrid.ItemsSource>
<ctrls:DataGrid.Columns>
    <ctrls:DataGridTextColumn Header="Date" Binding="{Binding Date,StringFormat={}{0:ddd, MMM d}}"/>
    <ctrls:DataGridTextColumn Header="Target" Binding="{Binding Value}"/>
    <!--<ctrls:DataGridTextColumn Header="Target" Binding="{Binding Value[0]}"/>
    <ctrls:DataGridTextColumn Header="Actual" Binding="{Binding Value[1]}"/>-->
</ctrls:DataGrid.Columns> 
```

这有效，但仅在首次初始化时有效。更改通知无响应：

```
<ctrls:DataGrid Grid.Row="1" Height="400" AutoGenerateColumns="False" CanUserDeleteRows="False" SelectionUnit="Cell">
<ctrls:DataGrid.ItemsSource>
    <!--<Binding Path="Targets"/>-->
    <MultiBinding Converter="{StaticResource TargetActualListConverter}">
        <Binding Path="Targets"/>
        <Binding Path="Actuals"/>
    </MultiBinding>
</ctrls:DataGrid.ItemsSource>
<ctrls:DataGrid.Columns>
    <ctrls:DataGridTextColumn Header="Date" Binding="{Binding Date,StringFormat={}{0:ddd, MMM d}}"/>
    <!--<ctrls:DataGridTextColumn Header="Target" Binding="{Binding Value}"/>-->
    <ctrls:DataGridTextColumn Header="Target" Binding="{Binding Value[0]}"/>
    <ctrls:DataGridTextColumn Header="Actual" Binding="{Binding Value[1]}"/>
</ctrls:DataGrid.Columns> 
```

这是我的 IMultiValueConverter：

```
class TargetActualListConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        TimeSeries<double> Targets = values[0] as TimeSeries<double>;
        TimeSeries<double> Actuals = values[1] as TimeSeries<double>;
        DateTime[] range = TimeSeries<double>.GetDateRange(Targets, Actuals);//Get min and max Dates
        int count = (range[1] - range[0]).Days;//total number of days
        DateTime currDate = new DateTime();
        TimeSeries<double?[]> combined = new TimeSeries<double?[]>();
        for (int i = 0; i < count; i++)
        {
            currDate = range[0].AddDays(i);
            double?[] vals = { Targets.Dates.Contains(currDate) ? (double?)Targets.GetValueByDate(currDate) : null, Actuals.Dates.Contains(currDate) ? (double?)Actuals.GetValueByDate(currDate) : null };
            combined.Add(new TimeValue<double?[]>(currDate, vals));
        }
        return combined;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        TimeSeries<double?[]> combined = value as TimeSeries<double?[]>;
        TimeSeries<double> Targets = new TimeSeries<double>();
        TimeSeries<double> Actuals = new TimeSeries<double>();

        foreach (TimeValue<double?[]> tv in combined)
        {
            if(tv.Value[0]!=null)
                Targets.Add(new TimeValue<double>(tv.Date,(double)tv.Value[0]));
            if (tv.Value[1] != null)
                Actuals.Add(new TimeValue<double>(tv.Date, (double)tv.Value[1]));
        }
        TimeSeries<double>[] result = { Targets, Actuals };
        return result;

    }
} 
```

我不能离得太远，因为它显示了值。

我究竟做错了什么？或者，有没有更简单的方法可以做到这一点？

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T00:20:57.020

看起来这是由转换器引起的。ObservableCollection 实现了 INotifyCollectionChanged，它会在集合发生更改（添加/删除/替换/移动/重置）时通知 UI。这些都是对集合的更改，而不是集合的内容，因此您之前看到的更新是由于您的类实现了 INotifyPropertyChanged。因为 MultiCoverter 正在返回一个新对象的新集合，所以初始集合中的数据不会传播到这些对象，因为它们没有绑定到原始对象来通知它们。

我建议的第一件事是查看[CompositeCollection](http://msdn.microsoft.com/en-us/library/system.windows.data.compositecollection.aspx)元素，看看它是否符合您的需求。

您可以使用以下方式维护原始对象，而不是按原样设置 ItemsSource：

```
<ctrls:DataGrid.ItemsSource>
    <CompositeCollection>
            <CollectionContainer Collection="{Binding Targets}" />
            <CollectionContainer Collection="{Binding Actuals}" />
       </CompositeCollection>
</ctrls:DataGrid.ItemsSource> 
```

（我假设“不响应基础数据的任何更改”是指更改值，而不是修改集合，如果我不正确，请告诉我，我会更深入地研究它。）

**编辑添加**
如果这不起作用，另一种方法是编写一个新类，该类将包装 Target 和 Actual 集合。然后可以使用这些包装器创建单个 ObservableCollection。这实际上是比使用 ValueConverter 或 CompositeCollection 更好的方法。无论哪种方式，您都会失去一些最初存在的功能。通过使用值转换器重新创建集合，它不再直接绑定到原始对象，因此可能会丢失属性通知。通过使用 CompositeCollection，您不再拥有可以通过添加/删除/移动等进行迭代或修改的单个集合，因为它必须知道要对哪个集合进行操作。

这种类型的包装功能在 WPF 中非常有用，并且是 ViewModel 的一个非常简化的版本，是 MV-VM 设计模式的一部分。当您无权访问底层类时，可以使用它来添加 INotifyPropertyChanged 或 IDataErrorInfo，还可以帮助向底层模型添加状态和交互等附加功能。

这是一个演示此功能的简短示例，其中我们的两个初始类都具有相同的 Name 属性，并且不实现它们之间不共享的 INotifyPropertyChanged。

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        Foo foo1 = new Foo { ID = 1, Name = "Foo1" };
        Foo foo3 = new Foo { ID = 3, Name = "Foo3" };
        Foo foo5 = new Foo { ID = 5, Name = "Foo5" };
        Bar bar1 = new Bar { ID = 1, Name = "Bar1" };
        Bar bar2 = new Bar { ID = 2, Name = "Bar2" };
        Bar bar4 = new Bar { ID = 4, Name = "Bar4" };

        ObservableCollection<FooBarViewModel> fooBar = new ObservableCollection<FooBarViewModel>();
        fooBar.Add(new FooBarViewModel(foo1, bar1));
        fooBar.Add(new FooBarViewModel(bar2));
        fooBar.Add(new FooBarViewModel(foo3));
        fooBar.Add(new FooBarViewModel(bar4));
        fooBar.Add(new FooBarViewModel(foo5));

        this.DataContext = fooBar;
    }
}

public class Foo
{
    public int ID { get; set; }
    public string Name { get; set; }
}

public class Bar
{
    public int ID { get; set; }
    public string Name { get; set; }
}

public class FooBarViewModel : INotifyPropertyChanged
{
    public Foo WrappedFoo { get; private set; }
    public Bar WrappedBar { get; private set; }

    public int ID
    {
        get
        {
            if (WrappedFoo != null)
            { return WrappedFoo.ID; }
            else if (WrappedBar != null)
            { return WrappedBar.ID; }
            else
            { return -1; }
        }
        set
        {
            if (WrappedFoo != null)
            { WrappedFoo.ID = value; }
            if (WrappedBar != null)
            { WrappedBar.ID = value; }

            this.NotifyPropertyChanged("ID");
        }
    }

    public string BarName
    {
        get
        {
            return WrappedBar.Name;
        }
        set
        {
            WrappedBar.Name = value;
            this.NotifyPropertyChanged("BarName");
        }
    }

    public string FooName
    {
        get
        {
            return WrappedFoo.Name;
        }
        set
        {
            WrappedFoo.Name = value;
            this.NotifyPropertyChanged("FooName");
        }
    }

    public FooBarViewModel(Foo foo)
        : this(foo, null) { }
    public FooBarViewModel(Bar bar)
        : this(null, bar) { }
    public FooBarViewModel(Foo foo, Bar bar)
    {
        WrappedFoo = foo;
        WrappedBar = bar;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

然后在窗口中：

```
 <ListView ItemsSource="{Binding}">
    <ListView.View>
        <GridView>
            <GridViewColumn Header="ID" DisplayMemberBinding="{Binding ID}"/>
            <GridViewColumn Header="Foo Name" DisplayMemberBinding="{Binding FooName}"/>
            <GridViewColumn Header="Bar Name" DisplayMemberBinding="{Binding BarName}"/>
        </GridView>
    </ListView.View>
</ListView> 
```

# authentication - JSP中的注销代码

> ID：875778
> 
> 赞同：0
> 
> 时间：2009-05-17T23:51:29.880
> 
> 标签：authentication, jsp, session, servlets, logout

我正在使用基本级别的身份验证，我需要 JSP/Servlet 中的最佳注销代码。我使用 JSP & servlet 和 MS-Access 作为后端。

是否需要在 JSP 中创建会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T20:27:44.160

如果您想“注销”应用程序，请尝试：

request.getSession().invalidate();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-26T14:06:28.523

request.getSession().invalidate(); 不会工作允许...所以在成功登录时间后的 1 步设置一个会话 session.setAttribute("loginstatus","true"); 在注销时将该值设置为“false”；

并且在登录页面之后包含一个 authentication.jsp，它允许检查“loginstatus”会话的 ststus，如果它是假的，那么它将控制转发到登录页面之前......我认为它会起作用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-20T09:48:32.023

如果您使用的是 Servlet 3.0 API，请使用：

`<a href="${pageContext.request.logout()}">Logout</a>`

这行得通（经过测试和证明）！

# php - json和php设置

> ID：875786
> 
> 赞同：1
> 
> 时间：2009-05-17T23:58:03.500
> 
> 标签：php, json

我通过 ajax 将 json 编码的字符串从 javascript 传递到服务器上的 php 文件。在我的在线服务器上，这工作正常。但在本地，它没有。

这两个地方的 php 安装存在一些差异。次要的。两者都是php4。本地安装实际上是一个较新的 php4。

我试图找出为什么会这样。看起来服务器端使用 pear servies_json (json.php) 解析的 json 解析不正确。它管理第一个括号，但随后停在那里，所有内部数据都丢失了？

是否有一个 php 插件或我需要安装的东西来防止这种情况发生。设置开关？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T00:08:13.007

[json_decode()](http://au.php.net/json_decode)应该在服务器端用于解码 JSON 对象，它应该相当一致地工作。它的姊妹函数[json_encode()](http://au.php.net/json_encode)同样适用于将数组/对象编码为 JSON 字符串，该字符串可以在您的 javascript 中回显。

这两个函数都需要 php 5，对于 php 4，您可以查看[此代码](http://au.php.net/manual/en/function.json-encode.php#82904)。

# linux - 我需要 -D_REENTRANT 和 -pthreads 吗？

> ID：875789
> 
> 赞同：40
> 
> 时间：2009-05-18T00:01:21.073
> 
> 标签：linux, gcc, pthreads

在 Linux（内核 2.6.5）上，我们的构建系统使用`-D_REENTRANT`.

**使用时还需要这个`pthreads`吗？**

它与`gcc -pthread`期权有什么关系？我知道我应该`-pthread`与 pthreads 一起使用，我还需要`-D_REENTRANT`吗？

附带说明一下，您知道在 gcc 3.3.3 和 gcc 4.xx 之间使用 REENTRANT 之间有什么区别吗？

当我使用`-pthread`gcc 选项时，我可以看到它`_REENTRANT`被定义了。`-D_REENTRANT`从命令行省略是否会产生任何影响，例如，是否可以在没有多线程支持的情况下编译某些对象，然后链接到使用 pthread 的二进制文件中并会导致问题？

**我认为应该可以使用：** `g++ -pthread`

```
> echo | g++          -E -dM -c - > singlethreaded
> echo | g++ -pthread -E -dM -c - > multithreaded
> diff singlethreaded multithreaded
39a40
> #define _REENTRANT 1 
```

我们正在编译多个静态库和与静态库链接的应用程序，库和应用程序都使用 pthread。

我相信它在过去的某个阶段是必需的，但想知道它是否仍然是必需的。谷歌搜索没有返回任何最近提到的信息 - `D_REENTRANT`with `pthreads`. 您能否指出我在最近版本的**kernel/gcc/pthread**中讨论使用的链接或参考资料？

澄清：目前我们正在使用 -D_REENTRANT 和 -lpthread，我假设我可以用 g++ -pthread 替换它们，查看 man gcc 它为预处理器和链接器设置了标志。有什么想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-21T01:28:25.083

对我来说，最好的答案是`pts`如果他愿意提交它作为答案的评论：

> 您进行了适当的调查并回答了您自己的问题。使用`g++ -pthread`，就相当于`g++ -lpthread -D_REENTRANT`。使用`g++ -D_REENTRANT`会有所不同，它可能不会设置所有链接器标志。– 点 5 月 18 日 0:30

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T02:18:32.930

从 gcc 信息页面：

```
`-pthread'
     Adds support for multithreading with the "pthreads" library.  This
     option sets flags for both the preprocessor and linker. 
```

所以只需 -pthread 标志就足够了。但是，我不建议仅将其传递给您的某些代码。

正如 Chris 在评论中建议的那样，在 Linux 上使用 gcc -dumpspecs 确实确认它也设置了预处理器标志：

```
%{posix:-D_POSIX_SOURCE} %{pthread:-D_REENTRANT} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-18T02:42:45.553

gcc 的 -pthreads 标志设置了在您所在平台上支持 pthreads 所需的相关编译器和链接器标志。

你是对的，在 linux x86（可能还有许多其他平台）上，这相当于'-D_REENTRANT -lpthread'，但在所有平台上都不一定如此。

（至少有一段时间，在 aix 上，-pthread 导致 g++ 链接到一个完全不同的 libstdc++.a。不过，我不知道现在是否仍然如此……）

# gcc - 现代编译器如何使用 mmx/3dnow/sse 指令？

> ID：875791
> 
> 赞同：20
> 
> 时间：2009-05-18T00:02:46.047
> 
> 标签：gcc, compiler-construction, x86, sse, assembly

我一直在阅读 x86 指令集扩展，它们似乎只在某些非常特定的情况下有用（例如，HADDPD - SSE3 中的（Horizo​​ntal-Add-Packed-Double））。这些需要一定的寄存器布局，需要刻意设置，或者从之前的一系列指令中发生。像 gcc 这样的通用编译器多久实际使用一次这些指令（或其子集），或者它们主要用于手工编码的汇编程序？编译器如何检测适合使用 SIMD 指令的位置？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-18T00:11:20.427

通常，很少有编译器使用它们。GCC 和 Visual Studio 通常不能使用 SIMD 指令。如果启用 SSE 作为编译器标志，它将使用标量 SSE 指令进行常规浮点运算，但通常不要期望自动使用矢量化指令。在某些情况下，最新版本的 GCC 可能能够使用它们，但我上次尝试时并没有工作。英特尔的 C++ 编译器是我所知道的唯一能够自动矢量化某些循环的大型编译器。

不过，一般来说，您必须自己使用它们。在原始汇编程序中，或通过使用编译器内在函数。一般来说，我会说内在函数是更好的方法，因为它们更好地允许编译器理解代码，从而安排和优化，但在实践中，我知道 MSVC 至少并不总是从内在函数生成非常有效的代码，所以简单的 asm 可能是那里最好的解决方案。实验一下，看看有什么效果。但是不要指望编译器会为您使用这些指令，除非您 1) 使用正确的编译器，以及 2) 编写可以简单矢量化的相当简单的循环。

**更新 2012**
好的，自从我写这个答案以来已经过去了三年。GCC 已经能够自动矢量化（简单）代码几年了，在 VS2012 中，MSVC*终于*获得了同样的能力。当然，我的回答的主要部分仍然适用：编译器仍然只能向量化相当琐碎的代码。对于任何更复杂的事情，您都被困在内部函数或内联汇编中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T01:16:37.507

只要您将 Mono 的类用于向量，Mono 就可以使用 SIMD 扩展。你可以在这里阅读：http: [//tirania.org/blog/archive/2008/Nov-03.html](http://tirania.org/blog/archive/2008/Nov-03.html)

只要您使用`-O3`或使用特定标志，GCC 就应该进行一些自动矢量化。他们在这里有一个信息页面：http: [//gcc.gnu.org/projects/tree-ssa/vectorization.html](http://gcc.gnu.org/projects/tree-ssa/vectorization.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T01:37:38.550

一段时间以来，如何自动利用 SSE 和其他小型向量单元*（*无需程序员以特殊语言结构或特别祝福的编译器“内在”形式提供指导）的问题一直是编译器研究的主题。大多数结果似乎专门针对特定问题域，例如[数字信号处理](http://www.ece.cmu.edu/~pueschel/papers/sse.ps)。我没有跟上关于这个主题的文献，但我*读到*的内容表明，利用向量 (SSE) 单元仍然是一个研究主题，人们应该对该领域常用的通用编译器抱有较低的期望.

建议搜索词：**向量化编译器**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-18T19:51:59.933

我已经看到 gcc 使用 sse 将默认的 std::string 对象清零。sse 的使用不是特别强大，但它确实存在。在大多数情况下，尽管您必须自己编写。

我知道这一点是因为我让堆栈变得未对齐并且它崩溃了，否则我可能不会注意到！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-11T08:40:08.403

如果您使用向量 pascal 编译器，您将获得 SIMD 具有优势的类型的高效 SIMD 代码。基本上这是长度小于 64 位的任何内容。（对于 64 位实数，执行 SIMD 实际上更慢）。最新版本的编译器还将自动跨内核并行化

# php - 如何使 mail() 在 Ubuntu 上工作？

> ID：875794
> 
> 赞同：3
> 
> 时间：2009-05-18T00:05:56.367
> 
> 标签：php, email, ubuntu-8.10

我有一个新安装的 Ubuntu 并尝试使用 php 的 mail() 函数。该功能失败，我想我的安装中缺少一两个包。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T00:15:19.107

您是否在 php.ini 中配置了邮件功能？

```
sendmail_path = /usr/sbin/sendmail -i -t    
or
sendmail_path = /usr/lib/sendmail -i -t 
```

# c# - 在数据绑定期间跳过项目

> ID：875795
> 
> 赞同：2
> 
> 时间：2009-05-18T00:06:03.107
> 
> 标签：c#, asp.net, databound-controls

问候！

我有一个使用 XmlDataSource 控件的 Repeater 控件。

```
<asp:FormView id="myFormView" runat="server" DataSourceID="myXmlDataSource">
    <ItemTemplate>
            <span>Items</span>
        <asp:Repeater id="myRepeater1" runat="server" DataSource='<%# XPathSelect("Items/*")%>'>
            <HeaderTemplate>
                <ul>
            </HeaderTemplate>
            <ItemTemplate>
                <li><%# XPath("text()")%></li>
            </ItemTemplate>
            <FooterTemplate>
                </ul>            
            </FooterTemplate>
        </asp:Repeater>
        <span>Things</span>
        <asp:Repeater id="myRepeater2" runat="server" DataSource='<%# XPathSelect("Things/*")%>'>
            <HeaderTemplate>
                <ul>
            </HeaderTemplate>
            <ItemTemplate>
                <li><%# XPath("text()")%></li>
            </ItemTemplate>
            <FooterTemplate>
                </ul>            
            </FooterTemplate>
        </asp:Repeater>
    </ItemTemplate>
</asp:FormView>        
<asp:XmlDataSource ID="myXmlDataSource" XPath="Root" EnableCaching="false" runat="server" /> 
```

XML 看起来像这样：

```
<Root>
    <Items>
        <Item>A</Item>
        <Item>B</Item>
        <Item>C</Item>
        <Item>D</Item>
    </Items>
    <Things>
        <Thing>1</Thing>
        <Thing>2</Thing>
        <Thing>3</Thing>
    </Things>
</Root> 
```

在某些情况下，我想在绑定时“跳过”“B”项，使其不显示。在 DataBinding 事件期间有没有办法可以跳过“B”项的绑定以使其不显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T00:33:23.167

如果您使用的是 XmlDataSource，我建议您将 XPath 从“根”更改为仅包含您要绑定的项目的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T00:38:14.387

您可以调查中继器的 OnItemDataBound() 方法中的当前 DataItem，如果它符合您的条件，则跳过处理该项目

# php - Facebook 连接对话框弹出

> ID：875799
> 
> 赞同：4
> 
> 时间：2009-05-18T00:08:28.653
> 
> 标签：php, javascript, facebook

当使用“连接”facebook 连接按钮时，当我单击它时，它会在当前窗口之外打开一个新的弹出窗口。这很烦人，我如何才能使用大多数网站上的内联模式对话框？

我附上了一个示例站点，看看您是否可以从中做出任何事情。

[http://www.giglocator.com/connect/index.php](http://www.giglocator.com/connect/index.php)

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-25T04:27:08.937

出于安全原因，Facebook 删除了内联登录对话框。但是，如果用户登录 Facebook，但尚未授权您的应用程序，则要求他们授权您的应用程序的弹出窗口将是内联的。但是，任何要求输入 Facebook 密码的内容都将显示在弹出窗口中，以便用户可以看到获取密码的网站的 URL。它让用户安心。

我试图弄清楚为什么我改变了我，但它没有。内联框会显示给以前从未使用过您的网站/应用程序的登录用户。未登录 Facebook 的 FB 用户将收到弹出窗口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-24T18:51:48.617

“之前，Connect with Facebook 对话框出现在浏览器窗口内的一个 IFrame“灯箱”中。明天每周代码推送后，该对话框将在单独的浏览器窗口中弹出，带有地址栏，与用户登录流程匹配时用户未登录 Facebook 并尝试将帐户与您的网站关联。”

[http://developers.facebook.com/news.php?blog=1&story=312](http://developers.facebook.com/news.php?blog=1&story=312)

# java - 使用 Java 6 执行 Java 5 代码

> ID：875800
> 
> 赞同：1
> 
> 时间：2009-05-18T00:08:50.743
> 
> 标签：java, compilation, java-6, java-5

有*什么*方法可以在使用 Java 5 编译的 JDK 6 上运行类文件（即以 main 作为入口点）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T00:09:46.793

是的。旧的 java 代码可以在较新的 JVM 上执行，但反之则不行。

你会没事的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T00:10:10.087

当然，这应该完全没有问题。为什么，你有问题吗？更加详细一些。

# javascript - prototype.js Ajax.PeriodicalUpdater 调用自己的函数来更新

> ID：875808
> 
> 赞同：1
> 
> 时间：2009-05-18T00:11:38.180
> 
> 标签：javascript, ajax, prototypejs

任何人都知道是否可以让 PeriodicalUpdater 将它收到的数据传递给我分配的函数以更新所需的字段？

我想处理收到的数据，然后让 PeriodicalUpdater 函数更新该字段。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T02:10:18.767

是的，您可以向它传递一个 onsuccess 回调，就像您对任何其他 AjaxRequest 所做的那样。

```
new Ajax.PeriodicalUpdater('container', '/someurl', {
  method: 'get', 
  frequency: 3, 
  decay: 2;
  onsuccess: function(response){
     myCustomFunction(response.responseText);
  }
});

function myCustomFunction(data){
  /* do something */
} 
```

请参阅[Ajax.PeriodicalUpdater](http://www.prototypejs.org/api/ajax/periodicalUpdater)和[Ajax 选项](http://www.prototypejs.org/api/ajax/options)。

# javascript - 将值传递给 eventListener 函数

> ID：875810
> 
> 赞同：0
> 
> 时间：2009-05-18T00:13:06.850
> 
> 标签：javascript, dom

```
for ( var i=0; i<thumbs.length; i++) {
    var num = i;
    Core.addEventListener(thumbs[i], "click",  Slide.thumbClick);
} 
```

在上面的代码中，我想将 的值传递`var num`给`thumbClick`事件监听器。但我做不到。如果我尝试显示该值，它会给出一个未定义的值。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T00:24:39.503

不记得了，但你应该能够做这样的事情：

```
Core.addEventListener(thumbs[i], "click", function() {
    //...do stuff here
}); 
```

var *num*应该仍可用于此匿名函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T00:25:50.623

一种方法是创建一个动态函数。

像这样的东西。（这是基于我对其他基于 ECMAScript 的语言的经验，您可能需要仔细检查以确保它有效。）

```
for ( var i=0; i<thumbs.length; i++)
{
        var num = i;
        Core.addEventListener(thumbs[i], "click",  new function(evt){
            Slide.thumbClick(num);
        });
} 
```

# php - 使 PHP 对象根据变量名执行不同的操作

> ID：875815
> 
> 赞同：1
> 
> 时间：2009-05-18T00:19:10.453
> 
> 标签：php, class

例如，假设我有一个用户数据库。我有一个类可以从数据库中获取有关这些用户的信息。

我想让班级“自我意识”它自己的名字，如下所示：

```
<?php

class UserData {

//[code that fetches the ID number from the variable name, and queries the database for info]

}

$user24 = new UserData;
echo 'Welcome, '.$user24->name.'!';

?> 
```

理想情况下，这段代码会输出类似“Welcome, Bob!”的内容，并且会根据我的命名而改变。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T00:26:19.733

由于给定对象可能有多个名称，因此这不是现代编程语言中普遍有效的技术。例如，假设用户 25 与用户 24 的名称不同，您希望以下代码打印什么？

```
$user24 = new UserData;
echo 'Welcome, '.$user24->name.'!';
$user25 = $user24;
echo 'Welcome, '.$user25->name.'!'; 
```

不仅如此，您还可以拥有没有名称的对象：

```
echo 'Welcome, '.(new UserData)->name.'!'; 
```

一个更典型的实现是让对象构造函数接受一个参数，告诉它你正在处理哪个用户，如下所示：

```
$user = new UserData(24);
echo 'Welcome, '.$user->name.'!'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T00:29:44.483

即使有可能（我不这么认为），你也不应该这样做。其他人只会看到很多魔法，而且很难调试。尽可能坚持标准和已知的想法/模式。

你为什么不想使用：

```
$user = new UserData(24); 
```

甚至更好（因为您不应该在构造函数中执行任何阻塞操作）：

```
$user = UserData::getById(24); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T00:30:24.810

一个值（例如一个对象）与其变量名的关系是一对多的——也就是说，一个值可能有多个名称，其中每个名称都是对同一个值的引用。它甚至可能根本没有名字，也就是说，它可以是一个表达式（例如，一个新的表达式返回一个对象）。因此，不可能以编程方式找出值的“该”名称。一个值可以有多个名称，也可以没有名称。

# sharepoint - 如何更新 SharePoint 内容类型？

> ID：875817
> 
> 赞同：6
> 
> 时间：2009-05-18T00:23:56.917
> 
> 标签：sharepoint, deployment

我需要通过向内容类型添加新字段来更新现有的 SharePoint 内容类型。我需要确保将此字段添加到使用此内容类型的所有列表中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T03:20:30.267

如果您的内容类型是使用功能创建的，据我所知，您无法升级功能以将新列添加到内容类型。

这让您有两个选择：

1.  在 UI 中执行
2.  使用 SharePoint 对象模型以编程方式进行

这是执行选项 #2 的示例：http: [//blogs.msdn.com/nidhishd/archive/2008/05/06/how-to-modify-content-type-once-it-is-deployed.aspx](http://blogs.msdn.com/nidhishd/archive/2008/05/06/how-to-modify-content-type-once-it-is-deployed.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T04:16:32.643

这真的是开箱即​​用的标准功能。当您编辑内容类型并添加字段时，它会添加到使用该内容类型的所有实例中。

该列表中的每个新条目都将包含更新的字段。任何现有条目也将具有该字段，但将为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-10T10:56:08.080

如果您只进行更新（通过添加字段），您应该能够做到这一点。

```
STSADM -deactivefeature...
STSADM -installfeature... (contenttype with new field)
STSADM -activatefeature...
IISRESET 
```

您现在应该在内容类型库中设置您的新字段，但您需要先将内容类型删除/添加到所需列表中，然后它们才会出现

# sql-server - 确定应用程序问题、数据库问题或硬件问题？

> ID：875820
> 
> 赞同：-4
> 
> 时间：2009-05-18T00:24:31.813
> 
> 标签：sql-server, performance

我有一个由 SQL Server 数据库支持的 Web 应用程序，它直到昨天都运行良好。现在我遇到了该应用程序的性能问题。我如何知道它是应用程序问题、数据库问题还是硬件问题？

谁能帮助指导我逐步完成基本故障排除过程，以确定性能问题是否与应用程序、数据库或硬件有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T00:33:35.223

运行探查器。按值 > 50 ms 的持续时间过滤，您很可能会找到最严重的违规者。如果语句是 SELECT 的，则将它们复制到查询分析器并运行显示实际执行计划并进行相应调整（创建索引等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T00:41:50.743

首先要做的事情...定义所有更改的列表，没有更改太小。

一旦您拥有该更改列表，就开始一项一项地支持它们。

一步一步的详细信息 ehhh ......这是一个艰难的过程。我一直在寻找明显的东西。如果我看到一些可疑的东西，我会停止我正在做的事情并进一步调查，或者我会将它作为可能的问题放在白板上。

1) 同样，我总是首先创建一个列表，列出所有基础设施（防火墙、交换机、数据库、HotFix、Web 服务器等）发生变化的所有内容。如果发生了变化，我总是要求提供更多关于那个改变。我的猜测是您没有任何此类信息，而不是我试图让您失望，组织需要一段时间才能达到适当的成熟度水平，其操作才能开始捕获所有更改。

2) 开始查看日志。由于我的所有应用程序都在 Windows Server 上，因此我首先查看应用程序事件日志。我正在寻找应用程序错误。接下来我转到系统事件日志，我再次寻找错误。接下来我可能会对我的 IIS 日志进行分析......我通常在这些日志中启用 time-taken 字段，因此我专注于长时间运行的请求。

3）接下来我将看看数据库服务器。我将要求我的 DBA 运行 SQL Profiler 以查看哪些查询需要很长时间。我还会要求他们收集有关数据库锁的信息。我还要求他们检查数据库的运行状况（索引是否是最新的，表/索引是否碎片化）。

4) 接下来，我让 Windows Server 管理员收集有关 Web Server 和 SQL Server 的性能计数器统计信息。我想查找内存泄漏、IO 队列、CPU 利用率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T00:30:41.190

在您接近诊断问题之前，这个问题需要额外的问题：

你有源代码吗？您知道在应用程序出现性能问题期间正在执行哪些 SQL 语句吗？如果是这样，您可以直接从 SQL 控制台窗口对数据库运行 SQL 语句，并查看性能问题是否纯粹在数据库中。

您有权访问数据库日志吗？我对 SQL 服务器日志不熟悉，但我知道 Oracle 有很多日志，而且里面充满了好东西。

假设数据库似乎响应令人满意，是否涉及网络？这是一个网络应用程序吗？您是否有权访问 Web 服务器的 Web 日志？

问题是否仅限于特定的一组用户？一些用户会遇到问题，而其他用户不会吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T02:19:27.933

第一个嫌疑人是代码的更改。如果代码中发生了某些事情并且性能问题与此相关，那么这就是主要嫌疑人。

如果没有任何变化，那么数据库就是一个很好的嫌疑人。假设您的标签使用的是 MS-SQL，有两种可能的情况：

1.  数据达到一定水平，引擎更改了用于执行查询的算法，而这种新算法需要不同的索引。

2.  只需重建索引即可。[从这个链接](http://www.sql-server-performance.com/tips/rebuilding_indexes_p1.aspx)可以看出，重建索引非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:11:06.900

用户会说：它运行缓慢
老板会说：修复它
网络人会说：这是一个数据库问题
数据库人会说：这是一个应用程序问题
应用程序人会说：这是一个网络问题

# cocoa - Managed Object Class Generation 对话框中的“Generate Validation Methods”复选框有什么作用？

> ID：875825
> 
> 赞同：0
> 
> 时间：2009-05-18T00:26:28.720
> 
> 标签：cocoa, core-data, code-generation

Managed Object Class Generation 对话框中的“Generate Validation Methods”复选框有什么作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T00:52:23.557

阅读核心数据编程指南中的[验证](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdManagedObjects.html#//apple_ref/doc/uid/TP40003397-BBCEHEGG)。

# c# - ASP.NET 表单自动保存

> ID：875834
> 
> 赞同：4
> 
> 时间：2009-05-18T00:31:14.370
> 
> 标签：c#, asp.net, javascript, jquery, sql-server-2005

我们有一个内部的 asp.net 表单应用程序，其中一个页面本质上是一个所见即所得的编辑器，用户可以在其中输入 3-5 段报告。具有最少用户中断的自动保存功能的最佳选择是什么？我不想每五分钟左右强制回发一次，除非我必须这样做，而是可能在每次文本更改时进行某种类型的客户端检查，并将其与上次提交信息的时间进行比较，然后从那里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T00:39:21.310

这是一个完美的任务，可以通过使用 AJAX 来解决。您可以设置某种计时器以在用户更改客户端后立即开始运行，然后让它在客户端执行异步调用返回到您的服务器以发送所见即所得框的内容。然后，您可以禁用计时器，直到用户再次开始编辑以避免不必要的异步调用。

这肯定会避免用回发打断用户。

有很多方法可以做到这一点，但下面的 MSDN 链接将是一个好的开始：

[http://msdn.microsoft.com/en-us/library/bb398785.aspx](http://msdn.microsoft.com/en-us/library/bb398785.aspx)

本质上，这为您提供了一个概述，但您需要关注的主要部分是将 Web 服务暴露给 JavaScript：

[http://msdn.microsoft.com/en-us/library/bb398998.aspx](http://msdn.microsoft.com/en-us/library/bb398998.aspx)

# asp.net - ASP.Net VS ASP.Net MVC

> ID：875835
> 
> 赞同：3
> 
> 时间：2009-05-18T00:32:13.527
> 
> 标签：asp.net, asp.net-mvc, syntax

现在这不是关于哪种技术更好的问题，因为它们都有针对不同场景的相关用途。

我的问题是关于两者的语法。它们的语法有何不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T00:36:57.103

ASP.NET MVC（顾名思义）仍然是 ASP.NET。它只是添加了一个额外的层来实现模型-视图-控制器方法。视图只是普通的旧 ASPX 页面，控制器只是从控制器类继承的普通旧 C#/VB.NET 类。唯一的主要区别（当然，除了整个 MVC 的思维方式）是默认情况下不使用代码隐藏文件。不过，您仍然可以自己创建它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T00:37:57.007

语法几乎相同。您仍在编写 C# 或 VB 代码。唯一的区别是您没有代码隐藏，因为它被分离到控制器中。您的视图中可能包含一些逻辑，以 ASP 标记 ( <%= %> ) 的形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T01:52:32.273

MVC 和 Webforms 使用不同的 HttpHandler 来向开发人员公开编程功能以处理请求。

MVC 使您可以更好地控制放在页面上的 html（因为您将编写几乎所有内容），而 Webforms（又名 ASP.Net）将自动将 Html 呈现到页面。

两者都使用相同的语法，但是您无法访问 MVC 中的服务器控件（例如`<asp:DataGrid />`），这可以节省您使用数据绑定等功能的时间，但代价是 html 看起来有点像呕吐物。

您还会发现，您不需要页面生命周期事件中的特殊情况（因为 MVC 中不存在这种情况）来阻止事件在您处理事件时触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:35:54.187

没有比这更好的东西了，两者各有利弊。这取决于您希望如何开发此应用程序的需要。两者都有其优点或缺点。

# php - 如何检查日期是否已过

> ID：875845
> 
> 赞同：2
> 
> 时间：2009-05-18T00:41:21.337
> 
> 标签：php, mysql, time, timestamp

我正在尝试检查一个日期是否已经过去或者它是否是未来。如果 end_date 已经过去，那么我不希望它显示。end_date 是 MySQL 时间戳。现在所有新闻文章都在显示，即使它们的 end_date 已经过去。这是我用来检查日期是否已过的代码：

```
function dateExp( $timestamp ){

   $exp = intval($timestamp);
   $today = intval( time() );

   if( $exp > today ) return true;
   else return false;

} 
```

这是获取文章并显示它们的代码：

```
$qry = "select *    
         from   news
         where  display='Y'
         order by priority, date_added, title";

$news = _execQry($qry);

foreach( $news as $n )
{
   if( dateExp($n['end_date']) ){
      echo '<h3>'. $n['title'] .'</h3>';
      echo '<p>'. $n['story'] ;
      echo '<br />Added on '. dateFormat($n['date_added']) .'</p><br />';
   }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T00:49:51.283

我建议您修剪查询中的记录，这样您的编程需要处理的数据较少。

$qry = "select *
from news
where display='Y' **and end_date >= CurDate()**
order by priority, date_added, title";

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T00:43:56.820

问题在于 dateExp 函数。您缺少一个**$**符号。因为 PHP 将*今天解释为一个常量*，而不是**$today**，后者是您用来保存当前时间戳的变量。

它应该是这样的：

```
function dateExp( $timestamp )
{

$exp = intval($timestamp);
$today = intval( time() );

if( $exp > $today ) return true;
else return false;

} 
```

事实上，您可以进一步简化该功能：

```
function dateExp($timestamp)
{
   $timestamp = intval($timestamp);  // make sure we're dealing wit 'numbers'
   return ($timestamp > time());     // return TRUE if $timestamp is in the future
} 
```

# asp.net - 覆盖对象上的 ToString 以在 DataBinding 中使用

> ID：875848
> 
> 赞同：1
> 
> 时间：2009-05-18T00:43:12.470
> 
> 标签：asp.net, data-binding

我正在使用 ASP.Net 2.0 中的数据绑定，并且遇到了 Eval 命令的问题。

我有一个正在数据绑定的类，如下所示：

```
public class Address
{
   public string Street;
   public string City;
   public string Country;
   public new string ToString()
   {
      return String.Format("{0}, {1}, {2}", Street, City, Country);
   }
} 
```

还有另一个类（我要绑定数据的那个）：

```
public class Situation
{
  public Address ObjAddress;
  public string OtherInformation;
} 
```

现在，当我有一个数据绑定控件时，例如

```
<asp:DetailsView ID="dvSituation" DataSourceID="dataSourceThatPullsSituations" AutoGenerateRows="false"runat="server">
<EmptyDataTemplate>
    No situation selected
</EmptyDataTemplate>
<Fields>
   <asp:BoundField HeaderText="Other data" DataField="OtherInformation" />
   <asp:TemplateField>
       <HeaderTemplate>
           Address
       </HeaderTemplate>
       <ItemTemplate>
            <%-- This will work --%>
            <%# ((Situation)Container.DataItem).ObjAddress.ToString() %>
            <%-- This won't --%>
            <%# Eval("ObjAddress") %>
       </ItemTemplate>
   </asp:TemplateField>
</Fields>
</asp:DetailsView> 
```

为什么当这个字段被评估时我的 ToString() 类没有被调用？我只是在 eval 运行时得到类型名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:10:11.890

而不是使用：

```
public new string ToString() 
```

使用**覆盖**关键字：

```
public override string ToString() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T01:12:45.473

在 ToString 方法中使用[override](http://msdn.microsoft.com/en-us/library/ebca9ah3(VS.71).aspx)关键字而不是[new 。](http://msdn.microsoft.com/en-us/library/51y09td4(VS.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T04:09:37.423

所以我的印象是，即使对象被称为超类， *new关键字也会覆盖实现：*

例如

```
Address test = new Address();
Object aFurtherTest = test;
aFurtherTest.ToString(); 
```

将要求我使用*new*关键字。这个关键字实际上所做的是有效地创建一个与基类中定义的方法同名的方法。

所以如果我在上面的例子中使用*new*关键字，我会得到对象的 ToString 方法。换句话说，根据我将其视为（基类或子类）的类型，ToString 方法将调用不同的方法。

显然，我应该有 RTFM 的情况......

# objective-c - 编译一个 Objective-C 程序

> ID：875849
> 
> 赞同：0
> 
> 时间：2009-05-18T00:43:13.937
> 
> 标签：objective-c

我在编译以下程序时遇到问题。我正在使用“gcc -framework Foundation inherit8.1m”并收到以下错误。我究竟做错了什么？谢谢。

> ld 警告：inherit8.1m，文件不是必需的架构 未定义符号：“_main”，引用自：从 crt1.10.5.o 开始 ld：未找到符号 collect2：ld 返回 1 个退出状态

```
// Simple example to illustrate inheritance

#import <Foundation/Foundation.h>

// ClassA declaration and definition

@interface ClassA: NSObject
{
   int  x;
}

-(void) initVar;
@end

@implementation ClassA
-(void) initVar
{
  x = 100;
}
@end

// Class B declaration and definition

@interface ClassB : ClassA
-(void) printVar;
@end

@implementation ClassB
-(void) printVar
{
  NSLog (@"x = %i", x);
}
@end

int main (int argc, char *argv[])
{
   NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

   ClassB  *b = [[ClassB alloc] init];

   [b initVar];     // will use inherited method
   [b printVar];    // reveal value of x;

   [b release];

   [pool drain];
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T00:48:59.180

尝试将源文件重命名为仅以 .m 结尾的内容。您的文件具有 .1m 的扩展名，这似乎使编译器感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T00:50:45.353

你把你的文件命名错了。它应该是inherit8.m，而不是inherit8。**1**米。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T01:07:53.783

我发现在 linux 上使用 GNUmakefile 更容易（不确定这是不是你的情况）。我有一个命令行工具`LogTest`编译自`source.m`：

```
> cat source.m
#import <Foundation/Foundation.h>

int main(void)
{
    NSLog(@"Executing");
    return 0;
}

> cat GNUmakefile
include $(GNUSTEP_MAKEFILES)/common.make

TOOL_NAME = LogTest
LogTest_OBJC_FILES = source.m

include $(GNUSTEP_MAKEFILES)/tool.make

> make
Making all for tool LogTest...
 Compiling file source.m ...
 Linking tool LogTest ...

> ./obj/LogTest
2009-05-17 20:05:36.032 LogTest[9850] Executing 
```

# breadcrumbs - Concordion 中的什么约定允许自动生成面包屑？

> ID：875850
> 
> 赞同：1
> 
> 时间：2009-05-18T00:43:43.703
> 
> 标签：breadcrumbs, concordion

我开始使用[Concordion](http://www.concordion.org/)为我正在开发的一小段代码创建一些测试。在示例中，它声明[“如果您使用正确的约定，Concordion 将自动为您插入面包屑。”](http://www.concordion.org/Example.html) . 但是，我找不到这些约定的明确描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-02T08:47:55.780

除了上面的[链接](http://www.concordion.org/dist/1.4.1/test-output/concordion/spec/concordion/results/breadcrumbs/Breadcrumbs.html)，还请阅读[面包屑是如何确定的？](http://www.concordion.org/dist/1.4.1/test-output/concordion/spec/concordion/results/breadcrumbs/DeterminingBreadcrumbs.html)，关键是

*   将 Abc.html 放在 Abc 文件夹下
*   为真实的描述添加 Abc 的描述
*   最重要的是在响应文件夹中添加相关的AbcTest.java，请 直接参考[concordion源代码](http://code.google.com/p/concordion/source/browse/#svn%2Ftrunk%2Fconcordion%2Fsrc%2Ftest)

# c# - XNA：仅将 SpriteBatch.Draw(...) 颜色应用于非透明像素

> ID：875853
> 
> 赞同：0
> 
> 时间：2009-05-18T00:44:33.980
> 
> 标签：c#, xna, 2d

我有一个从具有 alpha 通道的 PNG 加载的精灵。该图像包含一个不透明的磁盘，其余部分是透明的。

我想使用 的`color`参数`SpriteBatch.Draw(...)`来改变磁盘的色调。然而，默认的混合行为将颜色应用到整个精灵，所以我最终在有色圆盘周围形成了一个不透明的方形轮廓。

有没有办法改变混合模式，使透明像素不受`color`参数影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T00:57:44.713

我从未见过这种情况发生，而且我从 XNA 开始就一直在使用像这样的透明 PNG。你在混合 2D 和 3D 吗？如果是这样，您的 3D 渲染设置可能会混淆 SpriteBatch，但我认为 SpriteBatch 应该为您正确设置这些。也许您使用的 PNG 图像有问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T01:34:24.780

比尔，你是对的。我忘了清除其中一个 PNG 中的背景。这个问题应该被删除。

# php - 如何最好地与 PHP 中的 0 进行比较？

> ID：875854
> 
> 赞同：14
> 
> 时间：2009-05-18T00:44:36.150
> 
> 标签：php, mysql, comparison

在我正在处理的一段代码中，我需要从数据库中提取一个值并检查它是否为`0`. 最初，我把它写成：

```
if ($myVal == 0) { ... 
```

但是今天再看的时候，发现里面有个bug：

```
var_dump("foo" == 0);  // bool(true)

// and while we're here...
var_dump(intval("foo")); // int(0) 
```

由于这个值来自数据库，这**通常**意味着它将是一个字符串，所以我想我可以这样做：

```
if ($myVal === "0") 
```

但这似乎违反直觉，因为我实际上想处理一个整数，这似乎表明我们正在处理字符串。*（我希望这对您有意义。）*此外，在给定字段类型的情况下，任何给定的 DB 访问器都会将值转换为适当的类型，这并不奇怪。

当它可能是字符串或整数时，您使用什么方法来检查值 0？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-18T00:51:08.007

精简版：

```
if ("$myVal" === '0') 
```

或者

```
if (strval($myVal) === '0') 
```

长版：

```
if ($myVal === 0 || $myVal === '0') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T00:46:28.970

我目前得到的最好的是：

```
is_numeric($myVal) && $myVal == 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T01:40:25.033

如果您从数据库返回的值是字符串，但原始数据类型是整数，那么您可能希望您的 DAO（数据访问对象，或任何拉取数据的对象）将事物转换为您期望的数据类型。这样，正在查看值的 PHP 代码正在查看它所期望的数据类型。

当然，问题在于 DB 定义的数据类型和 PHP 定义的数据类型之间没有 1-1 的对应关系。但是，在大多数情况下，这不是问题，因为我们通常使用的大多数类型都有等效类型：int、float、bool、string。

结果是，在查询数据库的地方和检查这些值的地方之间，这些值应该转换为您期望的数据类型。我刚刚在包含 int(10) 和 varchar(50) 的 MySQL 表上使用 mysql_fetch_object() 进行了测试；这两个字段总是被 PHP 作为“字符串”类型拉入。因此，如果您希望将其中一个字段视为 int，请在对其进行任何操作之前将其转换为 int。例如：

```
$rs = mysql_query("SELECT * FROM table");
while ($row = mysql_fetch_object($rs)) {
    $RealRow->id = (int)$row->id;
    $RealRow->name = $row->name;
    // etc.
}

// ... later ...

if ($RealRow->status == 0) {
    // do something
} 
```

查询和 RealRow 的内容应该在一个类/方法中，以便对其进行封装；这样，您的代码中获取数据的任何部分都`table`将始终获取 $RealRow 对象，该对象会将所有内容设置为正确的数据类型。当然，如果你改变你的数据类型，这需要手动编辑DAO来处理强制转换；也可以查询数据库以获取每个字段的类型（使用“SHOW COLUMNS FROM table”），并*自动*将字段转换为正确的数据类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T02:47:43.950

我认为你应该只使用

```
if ($myVal == 0) 
```

我认为不必担心 $myVal 是否为“foo”。你自己说过这个值永远只是一个数字。

换句话说，如果你曾经体验过 $myVal 是“foo”，那么错误不是“foo”== 0，错误是 $myVal 是“foo”，而它应该是一个数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T00:46:41.213

尝试使用 intval() 将字符串转换为 int

```
if( intval($myVal) == 0 ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-31T09:20:50.990

```
// In codeigniter 3.1.11
if( $row->mamt === 0 || $row->mamt === '0')
{
    $temp    =   'C'.++$set_flag;

    $this->db->where('sch_code',$row->sch_code);
    $this->db->where('inst_no',$row->inst_no);
    $this->db->update($this->fl_karvy, array('flag' => $temp));
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-01T01:05:14.683

```
if( ('integer' === gettype($is_anonymous) && $is_anonymous === 0 )
    ||
    ('string' === gettype($is_anonymous) && $is_anonymous === '0')    
 ) {
    echo 'matches';
} 
```

# algorithm - 缩小时的插值算法

> ID：875856
> 
> 赞同：19
> 
> 时间：2009-05-18T00:44:59.893
> 
> 标签：algorithm, image, interpolation

我试图理解缩减。我可以看到在放大时如何使用插值算法（例如双三次和最近邻）来“填充”旧的已知点（像素，如果是图像）之间的空白。

但是降级？我看不出如何在那里使用任何插值技术。没有空白可填！

我已经坚持了很长时间，请给我一个正确的方向。实际上，当您删除已知数据时，您如何进行插值？

**编辑**：假设我们有一个一维图像，每个点有一个颜色通道。按平均像素值缩放 6 到 3 个点的缩小算法如下所示：1,2,3,4,5,6 = (1+2)/2,(3+4)/2,(5+6)/ 2 我在正确的轨道上吗？这种插值是缩小比例而不是仅仅丢弃数据吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-18T01:26:26.393

如果将原始像素概念化为宽度为 n，则像素的中心距任一边缘为 n/2。

可以假设像素中心的这个点定义了颜色。

如果您正在下采样，您可以从概念上这样考虑：即使您正在减小物理尺寸，而是认为您正在保持相同的尺寸，但减少了像素数（从概念上讲，像素的尺寸正在增加）。然后就可以算一算了...

示例：假设您的图像高 1 像素，宽 3 像素，并且您只会水平缩小。假设您要将其更改为 2 像素宽。现在原始图像是 3n，您将其转换为 2 个像素，因此每个新像素将占用原始图像像素的 (3/2)。

不要再考虑中心了……新像素的中心在 (3/4)n 和 (9/4)n [即 (3/4) + (3/2)]。原始像素的中心位于 (1/2)n、(3/2)n 和 (5/2)n。因此，每个中心都位于我们可以找到原始像素中心的位置之间——没有一个与原始像素的中心匹配。让我们看看 (3/4)n 处的第一个像素 - 它距原始第一个像素 (1/4)n，距原始第二个像素 (3/4)n。

如果我们想保持平滑的图像，请使用反比关系：取第一个像素的颜色值的 (3/4) + 第二个像素的颜色值的 (1/4)，因为新的像素中心，从概念上讲，将更接近第一个原始像素中心（n/4 距离）而不是第二个（3n/4 距离）。

因此，不必真正丢弃数据 - 只需从其邻居计算适当的比率（在总图像的物理尺寸不变的概念空间中）。这是一个平均而不是严格的跳过/丢弃。

在 2d 图像中，比率计算起来更复杂，但要点是相同的。插值，并从最接近的原始“邻居”中提取更多值。如果下采样不是非常严重，则生成的图像应该看起来与原始图像非常相似。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-18T00:51:28.927

无论是放大还是缩小，正在进行的“插值”实际上是重新采样。

如果缩小版本中的样本数不是全部样本数（像素等）的偶数除数，则简单地丢弃数据将产生在图像中显示为“锯齿”的采样错误。相反，如果您使用您提到的算法之一插入新样本在现有样本之间的空间中的位置，则结果会更加平滑。

您可以将其概念化为首先放大到旧大小和新大小的最小公倍数，然后通过丢弃样本来缩小，只是没有实际生成中间结果。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-18T03:13:00.443

此草图显示了从三个像素（黑色曲线）开始并使用插值（蓝色曲线）下采样到两个像素（红色曲线）的几个像素的部分。插值由原始的三个像素确定，最后两个像素设置为每个最终像素中心的插值值。（如果这里不清楚，垂直轴显示的是单个颜色通道的每个像素的强度。）

[替代文字 http://img391.imageshack.us/img391/3310/downsampling.png](http://img391.imageshack.us/img391/3310/downsampling.png)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-18T03:50:27.397

在这里，您在顶部有原始图像，然后在中间有一个简单的去除算法，在底部有一个插值算法。

考虑一个大聚光灯。中心的光最亮，边缘的光变暗。当你把它照得更远时，你会期望光束突然失去边缘附近的黑暗，变成一个坚实的光轮廓吗？

不，stackoverflow 徽标也发生了同样的事情。正如您在第一次缩小中看到的那样，图片失去了边缘的柔和度，看起来很糟糕。第二次缩小通过平均像素环境来保持边缘的平滑度。

一个简单的卷积滤波器供您尝试，是将像素和周围所有其他像素的 RGB 值相加，然后做一个简单的平均。然后用该值替换像素。然后您可以丢弃相邻像素，因为您已经将该信息包含在中心像素中。

![替代文字](https://imgur.com/41d0m.png)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-18T03:15:32.823

无论我们是放大还是缩小，我们都需要确定（在一定程度上准确）两个像素之间的点的颜色值是多少。

让我们取一行像素：

```
P     P     P     P     P     P     P     P     P 
```

我们上采样，我们想知道在中间点使用的像素值：

```
P   P   P   P   P   P   P   P   P   P   P   P   P 
```

当我们下采样时，我们还想知道在中间点使用的像素值：

```
P       P       P       P       P       P       P 
```

（当然，我们希望在二维而不是一维中做到这一点，但原理相同。）

所以无论如何，我们需要插值来确定正确的样本值。根据我们想要结果的准确程度，有不同的插值技术。理想情况下，我们会正确地重新采样所涉及的所有数学......但即使这只是严格完成的插值！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-25T14:50:17.580

如果您使用窗口化 sinc 滤波器，例如 lanczos，它实际上会滤除在较低分辨率下无法表示的高频细节。平均滤波器不会这样做，从而导致伪影。sinc 滤波器还可以产生更清晰的图像，并且适用于放大和缩小。

如果您要使用 sinc 放大图像，然后将其缩小回原始尺寸，您将得到几乎完全相同的图像，而如果您在缩小尺寸时仅对像素进行平均，您最终会得到比原始尺寸稍微模糊的东西. 如果您使用傅立叶变换来调整窗口 sinc 试图逼近的大小，则除了舍入误差之外，您将获得准确的原始图像。

不过，有些人不喜欢使用 sinc 滤波器产生的尖锐边缘周围的轻微振铃。我建议平均用于缩小矢量图形，sinc 用于缩小照片。

# java - 如何使用包含空格的信用卡号？

> ID：875867
> 
> 赞同：12
> 
> 时间：2009-05-18T00:49:46.167
> 
> 标签：java, string, usability

当检测到未经培训的购物者输入了信用卡/借记卡号时，一些精美的网站会显示错误对话框，因为该卡号打印在带有空格的卡上。是否有可能以某种方式编写一个 Java Web 应用程序来处理这些带有空格的数字，就好像它们是正确的一样？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-18T00:52:54.820

我的观点是，任何拒绝带有空格的信用卡号的 Web 应用程序都没有发挥作用。当您收到信用卡号码时，很容易做到：

```
String ccNumber = ccNumber.replaceAll("[\\s-]+", ""); 
```

删除空格和破折号（有些也使用这些）。然后验证结果。如果你强迫他们删除你可以很容易做到的空间，你只会惹恼你的用户。

至于**如何**验证，这取决于很多事情，例如您正在使用哪个 Web 框架以及您选择了哪些验证选项。例如，Struts 1 可能使用也可能不使用 Apache Commons Validator，而 Spring MVC 将（可能）使用 Spring 验证等等。所以我不能确切地告诉你如何验证，但我可以告诉你验证**什么**。

**第一件事是不**应该拒绝带有空格的CC号。大多数人会发现：

```
4123 0987 8876 2939 
```

**比**：

```
4123098788762939 
```

如果用户遗漏或输入错误的数字并需要找出他或她的信用卡号码验证失败的原因，这一点非常重要。这篇文章顶部的 replaceAll() 涵盖了这种情况。

第二件事是您以正确的方式显示信用卡号（即使出于安全原因将某些数字替换为 X）。我建议你通读[信用卡号码剖析](http://www.merriampark.com/anatomycc.htm)。

该页面为您提供了位数和有效前缀的规则。一个健壮的 Web 应用程序将实现这些**，因此您可以在尝试使用信用卡号之前判断它是否无效**。将信用卡详细信息提交到支付网关最多可能需要 30 秒（或可能更长时间），因此在您确定付款将被接受之前，您不应该这样做。否则会提供非常糟糕的用户体验。如果失败 1-2 次而不是等待，用户很有可能会放弃。

至于显示它们，这取决于位数：

*   16：4组4个，用空格隔开；
*   15：像[美国运通](http://globaldais.com/wp-images/American-Express-Titanium-Black-Card.jpg)卡，即4-6-5，每组之间有一个空格；
*   14：就像一张[大来](http://www.asa.org.au/pageBANK/images/diners_person_cob_asa_e.jpg)卡，即 4-6-4，每组之间有一个空格；
*   13：从未见过 13，但 4-5-4 或 4-4-5 或 5-4-4（或可能是 3-3-3-4）浮现在脑海中。

在作为标准验证例程的一部分*提交处理之前，*应根据页面中提到的校验和算法验证信用卡号。该页面具有该例程的 Java 实现。

**每个**接受信用卡付款的网站都应该将上述所有作为**绝对最低限度**，否则您只是在放弃业务，因为您的用户会感到沮丧。

所以简短的版本是两个简单的规则：

1.  对用户输入尽可能宽容；和
2.  在提交之前尽一切可能验证信用卡详细信息。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-18T01:30:22.763

我会尽可能去除所有非数字字符，然后检查长度是否有效，然后通过像[Luhn's algorithm](http://en.wikipedia.org/wiki/Luhn_algorithm)这样的真实验证运行用户输入。

```
String ccNumber = input.replaceAll("\\D", ""); 
```

从 中去除所有非数字`String input`。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-18T01:08:50.630

强迫您以特定格式输入信用卡号码（和类似内容）的网站 - 严重惹恼我。

那些人只是因为他们（开发人员）懒惰而给他们的客户带来不便。没有理由不接受信用卡号码、电话号码等提供的任何格式的内容。唯一的限制是了解如何解释该值所需的内容。

你不应该关心我输入的是 5555-4444-3333-2222 还是 5555444433332222，如果你不喜欢它们，只需去掉破折号 - 与空格相同。对于电话号码，除非您要自动拨打该号码，否则您可能甚至都不关心它的格式，因此除非您必须这样做，否则不要惹恼您的用户。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-18T04:51:39.927

很不幸的是，不行。Java 无法处理这些要求，因为在 x86 芯片上模拟 Java 虚拟机涉及太多开销，没有为 Perl 的正则表达式等有用的构造留下空间，它可以这样做：

```
$input =~ s/\D//g; 
```

几年前，Java 曾尝试添加正则表达式，但它们只运行在不再使用的 PowerPC 芯片上。问题是所有正则表达式都必须包含为字符串而不是一流的语言结构，因此需要双反斜杠，但众所周知，反斜杠在 x86 架构的主要操作系统上意味着不同的东西。

我的建议是升级到 Perl。众所周知，Scheme 能够处理这种情况并在竞争中提供巨大的优势，但 Scheme 只能在 LISP 机器上运行。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-18T01:04:21.890

不幸的是没有，这就是为什么那些花哨的网站需要向未经培训的购物者显示一个错误对话框：强制*购物者*以机器喜欢的格式重新输入他们的号码。

为什么，如果只有一*台机器*可以做“数据处理”，那么机器本身就可以改变数据格式！或者，如果没有“未经训练的”购物者这样的东西就好了！唉!

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-18T00:52:57.283

您的问题似乎很奇怪，但我认为它应该像通过验证功能运行用户输入的信用卡号码一样简单，该功能首先会删除所有空格。

在任何使用或不使用正则表达式的现代语言中，这都是相当微不足道的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-20T18:55:02.337

简单的。

*   您的输入空间是包含所有字符的某个字符集中的字符列表。
*   您的输出空间是来自某些仅包含数字的字符集的字符列表。

为了解决这个问题，我们创建了一个只包含数字 0 到 9 的中间空间。我们可以为这个有限集创建一个新的枚举。我们称其为手指空间，因为奇怪的是它包含的成员数量与我们的手指数量相同。

然后我们编写两个函数。

1.  将输入空间转换为手指空间
2.  将手指空间转换为输出空间

当我们将输入空间减少到手指空间时，我们只需丢弃在手指空间中找不到的任何字符。从手指空间到输出空间的转换更加容易。我们只是在输出空间中找到相同的数字。

诀窍在于它适用于所有字符集。我还没有弄清楚如何确定某个字符是否与我的手指组中的成员匹配。也许我应该把它作为一个问题发布。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-20T20:24:54.137

汤姆，

问题在技术上解决了，我们从理论上讲。

这里有两种思想流派。我认为说“如果用户无法弄清楚这是他们的问题”是不可接受的答案。

1.  对您的用户输入要坚定，并且只接受格式正确的信用卡号码。这需要让用户保持在页面上，直到他们做对了所有事情。
2.  通过假设他们的意图并为他们调整他们的输入来更加宽容（只要确保给他们一个确认屏幕以验证新输入）。

在我看来，#2 是要走的路，您可以使用正则表达式（如上所述）将所有空格、特殊字符等从 cc# 字段中拉出，并让用户不必再次输入他们的信息。

无论哪种方式，您都应该告知用户正确的输入形式（即 xxxx-xx-xxxx）

根据经验，我倾向于欣赏那些在处理用户输入的方式上更加优雅的网站。

有关正则表达式的更多提示，请查看正则表达式。信息

祝你好运，

-罗伯特

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T00:52:46.393

有许多选项，但最合乎逻辑的似乎是只做一个简单的字符串替换，用一个封闭字符替换所有空格，即''。这会将信用卡字符串减少为一长串数字..然后处理掉

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-20T20:15:19.727

该网站上的广告... 只需 49.95 美元，您就可以拥有一个与该在线商店兼容的新特殊键盘。单击此处将新键盘添加到您的购物车并结帐。结帐时，请在指定字段中输入您的信用卡号。请不要输入数字之间的空格，因为我们的商店不知道如何处理数字之间的空格。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T18:52:45.533

我会假设这是一个真正的问题，即使它看起来像是某种巨魔或笑话。

您应该为您的界面建模，以便用户本能地以受控方式执行输入。简单的说，就是先问他们卡的种类，然后在输入表单上格式化输入，匹配卡。例如，假设像 Visa 或 Mastercard 这样的 16 位卡，显示 4 个输入框，由空格或破折号分隔，每个输入框限制输入 4 个字符，并在用户键入第四位数字后自动移动到系列中的下一个框。

它在页面上应该类似于以下内容：

> 卡号：
> [1234] - [1234] - [1234] - [1234]

或者

> 卡号：
> [1234] - [123456] - [12345]

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-25T11:03:15.497

似乎只有一个人提到了 Luhn 或 mod 10 算法

[http://en.wikipedia.org/wiki/Luhn_algorithm](http://en.wikipedia.org/wiki/Luhn_algorithm)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-18T00:51:56.350

当然。压缩空间。可能有无数种方法可以做到这一点；我很想使用 String.split() 将其分解为空格，然后连接产生的四个字符串。或者使用 StringBuffer.indexOf() 和 .delteCharAt()。

...或者正如 Cletus 所说，使用 replaceAll()。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-22T01:08:12.937

您可以使用 javascript 验证通过使用`onkeypress`事件来检查最后一个字符是否有效，如果不只是删除它，甚至可能会闪现一条消息，说明输入了无效字符。这种方式永远不会输入无效数字。它还可以自动输入所需格式的分隔符（空格或 -）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-23T15:38:10.240

早在 1998 年，我就在一家只允许使用 Visa 的商店中编写了这对 Perl 函数（……实际上是在 Visa 中……）。

```
sub mod10_checkdigit
{
    my($acct) = @_;
    die "invalid account number in BRPS::mod10_checkdigit"
        unless $acct =~ m%^\d+$%;
    my(@digits) = split //, $acct;
    my($len) = scalar(@digits);
    print "# ($len) @digits\n" if ($ENV{PERL_BRPS_DEBUG});
    my($i, $sum, $chk);
    my($mul) = (($len % 2) == 1) ? 1 : 2;
    $len--;
    for ($i = 0; $i < $len; $i++)
    {
        my($val) = $mul * $digits[$i];
        # Note that we need the digital root of the value, but $val is not
        # greater than 18 (because $digits[$i] <= 9 and $mul <= 2).
        $val -= 9 if ($val >= 10);
        $sum += $val;
        print "# $i: $digits[$i] * $mul => $val => $sum\n" if ($ENV{PERL_BRPS_DEBUG});
        $mul = 3 - $mul;
    }
    $chk = 10 - ($sum % 10);
    $chk = 0 if ($chk == 10);
    return $chk;
}

sub validate_account
{
    my($acct) = @_;
    # Strip leading and trailing blanks
    $acct =~ s/^\s*(\S.*\S)\s*$/$1/;
    my($clean) = $acct;
    # Check that account number is string of digits, blanks and dashes
    return undef, "account number is not a sequence of digits, blanks and dashes"
        unless $acct =~ m/^[- \d]+$/;
    return undef, "account number is not a Visa account number"
        unless $acct =~ m/^4/;
    # Remove non-digits
    $clean =~ s/\D//g;
    return undef, "account number is neither 13 nor 16 digits"
        unless length($clean) == 16 || length($clean) == 13;
    # Punctuators must be reasonably consistent!
    return undef, "invalid punctuation pattern"
        unless ($acct =~ m/^\d{16}$/o or $acct =~ m/^\d{13}$/o or
                $acct =~ m/^\d{4}[- ]\d{4}[- ]\d{4}[- ]\d{4}$/o or
                $acct =~ m/^\d{4}[- ]\d{3}[- ]\d{3}[- ]\d{3}$/o);
    # Determine check digit
    my($chk) = mod10_checkdigit($clean);
    return undef, "check digit on account number is incorrect"
        unless $clean =~ m/$chk$/;
    return $clean, "ok";
} 
```

允许合理的信用卡号码通过。概括起来处理万事达卡、发现卡、美国运通卡也不难。

### 咆哮

我*不*喜欢坚持让我以内部格式输入数据的网站。Dammit - 将数字存储为一个大整数并将其作为纯数字字符串发送；这对计算机来说很好。但请让我输入可识别的人类可读格式 - 甚至以人类可读格式重新呈现数据。处理信用卡号码的网站有太多的懒惰。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-25T00:13:12.827

如果您的意思是 javascript，您可以使用“前进到下一个输入”方法：

这是HTML：

```
<form id="ccform" action="cc_submit.php" method="post">
    <fieldset id="ccnumber">
        <input id="firstset" type="text" maxlength="4" />
        <input id="secondset" type="text" maxlength="4" />
        <input id="thirdset" type="text" maxlength="4" />
        <input id="fourthset" type="text" maxlength="4" />
    </fieldset>
</form> 
```

这是JS：

```
var ccfields;

function moveToNext(e) {
    var field = e.currentTarget;
    var chars = field.value.length;
    var setnumb = Number(field.id.substr(3,1)) - 1;
    if(chars >= 4 && setnumb < 3) {
        ccfields[setnumb + 1].focus();
    }
}

window.onload = function() {
    ccfields = document.getElementById("ccnumber").getElementsByTagName("input");
    for (var i = 0; i < ccfields.length; i++) {
        ccfields[i].onkeyup = moveToNext;
    }
}; 
```

当然，您将需要添加一个检查非数字的函数和一个用于获取四个字段并将它们合并为一个字符串以传递回表单的函数。使用像 Jquery 这样的 js 库来确保以相同的方式处理事件并简化对输入的遍历也不是一个坏主意，因此您可以使用“名称”等属性而不会造成任何混淆。

但一般来说，如果人们看到 4 个字段，则更容易输入他们的数字，对于那些认为“啊，我必须为每个数字使用鼠标”的访问者来说，他们（或至少我）很高兴该页面足够聪明，可以知道移动到下一个字段。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-25T12:55:48.017

解决方案 1：只需放入 4 个可以输入 4 位数字的文本框。就像输入软件的许可证密钥的方式一样。您可以在输入空格字符或制表符后触发框更改为下一行。

解决方案 2：使用上述评论之一中提到的正则表达式。问题是，如果它是一个 Web 应用程序，您将很容易受到注入攻击。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-25T13:42:25.660

Java ^(TM)非常适合服务器端编程，而 javascript 在客户端可能有用；例如在验证期间。

有效信用卡号的长度在 12（例如 Maestro）和 19（例如 Solo、Switch）之间变化。客户端 javascript 可以确定卡号是否有效（只有数字（带有破折号或空格），适合发行机构，校验和是否正常，...）并从“人类可读”执行 1:1 映射（例如

```
American Express    3400 0100 2000 009 
```

) 到内部表示，例如

```
<input ... id="ccid" value="340001002000009">
<input ... id="ccissuer" value="AMEX"> 
```

一旦信用卡信息验证通过了**输入**时的验证，值就可以透明地转换为内部表单**on-submit**。

可以在网上找到一个简单的 javascript 函数示例，该函数对这个问题进行一些检查，例如这里[http://www.braemoor.co.uk/software/creditcard.shtml](http://www.braemoor.co.uk/software/creditcard.shtml)。

对答案的描述就这么多。

# hibernate - Java JPA多对一多态映射

> ID：875879
> 
> 赞同：1
> 
> 时间：2009-05-18T00:56:57.743
> 
> 标签：hibernate, jpa

我正在尝试使用多态类型映射 JPA（现在使用 Hibernate）多对一关系，但我没有运气。我不明白为什么这是不可能的，或者为什么我会被迫在映射中声明一个具体类型。这是一个例子：

```
@MappedSuperclass
class BaseClass {
    @Id
    long id;
}
class ClassWithList extends BaseClass {
    String attribute;

    @OneToMany(mappedBy="backPointer")
    List<ListClass> list;
}
class ListClass extends BaseClass {
    String listItemData;

    @ManyToOne
    @JoinColumns({
       @JoinColumn(name="baseId"),
       @JoinColumn(name="baseType"),
    })
    BaseClass backPointer;
} 
```

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T01:06:23.150

对于特定的记录，您无话可说，它是哪种类型。我建议您查看[TopLink JPA：How-To Define Inheritance](http://www.oracle.com/technology/products/ias/toplink/jpa/howto/use-inheritance.html)。它同样适用于 Hibernate。

# string - 比较字符串大小是比较字符的可接受替代方法吗？

> ID：875883
> 
> 赞同：0
> 
> 时间：2009-05-18T01:00:49.277
> 
> 标签：string, grep

我正在用 C++ 编写一个 grep 函数（作为一个自我分配的练习 - 我意识到这没有实际 grep 功能的功能）来获取原始字符串和您正在寻找的搜索字符串。在代码中，我在 grep 字符串中输入所有字符，直到它看到的第一个空格。然后我将 grep 字符串中的字符与搜索字符串进行比较，如果匹配，则将其存储在临时字符串中。我遍历 grep 字符串并将搜索字符串的长度与临时字符串进行比较以查看它是否匹配。

我的问题：比较长度是不是很糟糕？我可以使用 for 循环来比较每个单独的字符，但这似乎会不必要地占用 CPU 周期。这是我的输入功能供参考：

```
std::string grep(std::string originalStr, std::string searchStr)
{
std::string grepStr = "";
std::string finalStr = "";
//stores final string; is the return value
finalStr.resize(originalStr.length() + 1);
grepStr.resize(originalStr.length() + 1);

int place = 0;
//remember where you are in originalStr[place]
int numOfOccurences = 0;
//remember number of times searchStr was found;
//not necessary
std::string tempStr = "";
//will temporarily hold grepStr    

//handles case if first occurence is a space
if (originalStr[0] == ' ')
{
    place++;
}

while (place != originalStr.length())
{
    tempStr = "";

    while (originalStr[place] != ' ')
    {

        if (originalStr[place] == ' ')
        {
           break;
        }

        grepStr[place] = originalStr[place];
        ++place;
    }

    ++place;//ensures you skip over the space next pass

    for (int i = 0; i != grepStr.length(); i++)
    {
        if (grepStr[i] == searchStr[i])
        {
            //if they are the same, append that char..
            tempStr[i] = grepStr[i];

            if (tempStr.length() == grepStr.length())
            //..then check for string length; if same, searchStr equals tempStr
            //and you can append grepStr to the finalStr
            {                    
                for (int x = 0; x != finalStr.length(); x++)
                {
                    finalStr[x] = grepStr[x];
                }

                ++numOfOccurences;
                //add one to the number of occurences in originalStr
                finalStr += ' ';
                //add a space IF you find the string
            }
        }
    }
}

return finalStr;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:01:51.177

不，一点也不差。毕竟，至少在某种意义上，如果两个字符串的长度不相等，它们就不可能相等。

如果想度过一段美好的时光，请查看 Boyer-Moore 字符串匹配算法和 Knuth-Pratt-Morris 算法。J [原文如此！他真的是这样拼写的]摩尔对他们有一个[很好的页面](http://www.cs.utexas.edu/~moore/best-ideas/string-searching/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T01:05:34.320

如果您使用std::string，STL find 函数可能会比您创建的这个版本更有效地运行。在字符串中搜索子字符串是一个已知问题，我确信库版本已尽可能优化。

# apache-flex - Flex：ActionScript 项目大小问题

> ID：875886
> 
> 赞同：1
> 
> 时间：2009-05-18T01:02:42.643
> 
> 标签：apache-flex, actionscript-3, size

我有一个小时的一些有趣的问题.. 在我的 flex 项目中，所有宽度和高度属性都返回为零.. 我试过这个：

```
 private function onEnterFrame(e:Event):void
    {
        trace(stage.width, parent.width, this.width, root.width);
    } 
```

和结果：

0 0 0 0

使用 Flex，sdk 3.2

任何人都可以帮助我吗？

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:45:56.657

我认为您需要 stage.stageWidth 和 stage.stageHeight，而不是 stage.width 和 stage.height。

# c# - iTextSharp 垂直间距

> ID：875892
> 
> 赞同：5
> 
> 时间：2009-05-18T01:07:58.027
> 
> 标签：c#, itextsharp

我正在使用 iTextSharp 生成一些 PDF 文件。我有两个有内容的表格，我想在两个表格之间放置一些空间，比如相当于 1 行文本（使用与空间周围的表格相同的字体）。

下面是我用来添加两个表的代码。我想不通的是如何在两张桌子之间放置一个垂直空间。

```
Table upperTable = new Table(1);
upperTable.Border = Rectangle.NO_BORDER;
upperTable.DefaultCell.Border = Rectangle.NO_BORDER;
upperTable.DefaultCell.HorizontalAlignment = Element.ALIGN_CENTER;
upperTable.AddCell(new Phrase("some text", font3));
d.Add(upperTable);
Table lowerTable= new Table(1);
lowerTable.Border = Rectangle.NO_BORDER;
lowerTable.DefaultCell.Border = Rectangle.NO_BORDER;
lowerTable.DefaultCell.HorizontalAlignment = Element.ALIGN_CENTER;
lowerTable.AddCell(new Phrase("some other text", font3));
d.Add(lowerTable); 
```

有人能告诉我如何在两张桌子之间添加垂直空间吗？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-03-22T00:13:55.310

请改用 PdfPTable。它具有属性`SpacingBefore`和`SpacingAfter`

例如：

```
PdfPTable upperTable = new PdfPTable(1);
upperTable.AddCell(new Phrase("some text", font3));
upperTable.SpacingAfter = 10f; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T03:10:47.147

我找到了一种可行的解决方案...将新行作为前面字符串或后面字符串的一部分添加到我要创建的空间中。例如：

```
Table upperTable = new Table(1);
upperTable.Border = Rectangle.NO_BORDER;
upperTable.DefaultCell.Border = Rectangle.NO_BORDER;
upperTable.DefaultCell.HorizontalAlignment = Element.ALIGN_CENTER;
upperTable.AddCell(new Phrase("some text" + '\n', font3));
d.Add(upperTable);
Table lowerTable= new Table(1);
lowerTable.Border = Rectangle.NO_BORDER;
lowerTable.DefaultCell.Border = Rectangle.NO_BORDER;
lowerTable.DefaultCell.HorizontalAlignment = Element.ALIGN_CENTER;
lowerTable.AddCell(new Phrase('\n' + "some other text", font3));
d.Add(lowerTable); 
```

将导致在and`font3`之间添加高度定义为 的 2 行`"some text"``"some other text"`

# java - 休眠+摇摆

> ID：875897
> 
> 赞同：12
> 
> 时间：2009-05-18T01:09:30.910
> 
> 标签：java, hibernate, swing

最佳做法是什么？

*   整个应用程序的单个会话
*   每个窗口一个会话
*   每个线程一个会话，并随机分离所有内容
*   还有什么？

我用谷歌搜索了一下，没有一致意见。每个人都说些什么，然后收回。我发现拖着一个会话愚蠢...

那么，有什么关系呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T01:38:08.673

也许每个事件处理一个会话是正确的方法。在 Web 应用程序中，我们通常为每个请求创建一个会话（使用所有那些 OpenSessionInView 等内容）。如果我们仔细考虑，Web 应用程序中的每个请求都是应用程序中的不同交互，而在 Swing 应用程序中，每个触发的事件都是应用程序中不同的交互。如果我们在 Swing 应用程序中应用我们在 Web 应用程序中应用的相同原则，那么我们应该为每个事件处理创建一个会话。

但是我们必须确定使用 Hibernate 是否是最佳选择……您正在访问的数据库是本地数据库还是远程数据库？其他应用程序是否共享同一个数据库？您应该考虑创建一个 EJB\HTTP 后端，而不是让您的 Swing 应用程序直接访问数据库。使用 Hibernate 建议你有一个不那么简单的数据库，所以我认为你应该考虑创建一个 EJB\HTTP 后端。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T09:47:59.143

我在一个企业规模的富 Internet 应用程序中使用了 Hibernate，从技术上讲，它类似于 hibernate + swing 的组合。我花了很多时间研究在 3 层应用程序中使用 hibernate 的不同设计模式。

Hibernate 并不完全适用于这种应用程序，因此没有太多关于此主题的信息。我尝试了不同的设计模式，但其中大多数会导致内存泄漏、在会话中附加和解除附加对象的问题、事务问题等。最终的解决方案是使用每个请求的会话模式。基本上，在您从 UI 逻辑到业务逻辑的每个请求中，您都会创建一个新的休眠会话。然后，您的业务逻辑执行您希望它执行的任何操作，并且在结束业务逻辑执行之前，您刷新并关闭打开的会话。这样就不会有任何内存泄漏，对象将正确地从会话中附加和分离。

这不是一个完美的解决方案，因为您会遇到一些问题，例如延迟加载和事务。我将简要解释这些问题以及如何解决它们。

事务
因为您在每次请求后终止休眠会话，所以您不能拥有超出一个请求的事务。这可能有点问题，例如，假设您想在同一个事务中存储 10 个对象。您不能为每个对象单独发出保存请求，因为事务已终止。因此，您需要创建一个将对象列表作为输入并将所有这些对象保存在同一事务中的方法。如果事务失败，则回滚所有对象。

延迟加载
您的对象的延迟加载将不起作用，因为它们很可能未附加到会话（即，如果您在会话终止后延迟加载某些内容）。为了使延迟加载起作用，您需要将对象重新附加到会话。我也想出了一个解决方法，这在创建新实体对象时有点棘手，但在日常开发中工作得很好。这个想法是为延迟加载的字段设置重复的 getter 和 setter。一对是私有的，另一对是公共的。这个想法是私有的getter/setter对是hibernate内部使用的，而公共的getter和setter是临时的，由开发人员使用。因此，当开发人员调用公共 getter 时，getter 会检查该字段是否已加载，如果没有，则将对象附加到会话，加载字段并关闭会话。瞧，一切正常，开发人员从未注意到任何事情。这是一个小代码给你的想法：

```
 @Entity
public class Foo {
  List<Bar> bars = new ArrayList<Bar>();

  @OneToMany
  private List<Bar> getBarsInternal() {
    return bars;
  }

  private void setBarsInternal(List<Bar> bars) {
    this.bars = bars;
  }

  @Transient
  public List<Bar> getBars() {
     // pseudo code
     if(check if bar is still lazy loaded) {
       // the field is still lazy loaded
       // attach the field to a session an initialize it
       // once the field is initialized, it can be returned
    }
    return getBarsInternal();       
  }

  public void setBars(List<Bar> bars) {
    setBarsInternal(bars);
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T07:28:29.117

我们从每个应用一个会话开始，我在下面列出了动机和问题，

顾名思义，整个用户与应用程序的交互将包括一个单一的长寿命会话，并且与数据库的所有（主要）通信都将通过该会话进行。您的“工作单元”现在将包含所有用户与应用程序的交互……这意味着您的“应用程序事务”是应用程序的整个生命周期。

**为什么**？1\. 这样做的最大驱动力似乎是使用 hibernate 的延迟初始化功能，例如显示书籍信息的对话框可以在选择下拉组合框时动态填充作者信息。

2.  由于对底层数据的所有修改都是通过这个单一的长时间运行的会话完成的，因此您可以在方便的位置明确划分事务边界。

3.  利用会话缓存，无需每次都从数据库加载/卸载对象。

**如何**：

如果您在 GUI 线程中执行所有主要工作（几乎所有 Java GUI 系统都是单事件线程的，您可以使用调整线程本地模式从 GUI 线程获取主会话。

**问题**：

上述优势可能描绘出一幅美好的画面，但使用长时间运行的会话而没有经过深思熟虑可能会导致一些严重的问题，这些问题在应用程序变得足够大或足够复杂之前可能并不明显。

1.  您的应用程序可能会遭受“臃肿的会话缓存”现象。随着会话缓存变得越来越大，您的每个应用程序都会变得越来越慢，因为休眠必须为每个查询遍历会话缓存中的所有对象（具有巨大的会话这可能会减慢您的速度，如果会话变大，即使没有更改，刷新也会花费越来越多的时间）。如果允许会话变大，则上述第 3 项本质上的优势可能会成为劣势（由于休眠事务后写）。在某些情况下可能有用的解决方法可能是使用 query.setReadOnly(true) 和 session.setReadOnly() 用于将只读对象加载到会话中的查询/实体。
2.  手动“驱逐”以保持会话一致，您可能出于各种原因在应用程序的各个位置使用 sql 查询来执行更新/删除，在这种情况下您必须手动驱逐以防止会话被破坏。
3.  如果您计划从“其他会话”访问数据，事务性后写可能会妨碍您（取决于您如何管理长时间运行的会话）。
4.  当休眠执行其延迟加载魔法时，用户可能会遇到 GUI 冻结。
5.  经典的延迟加载 n+1 查询问题（见下面的链接）
6.  过时的数据问题。如果数据是由不使用主会话的某些后台作业或线程更新的..您的主会话将不会与更改保持同步。

我仍然认为，如果您有一致的驱逐策略，例如在订单窗口关闭时驱逐订单图，这可能是一个很好的策略。

我们切换到 session-per-window ，它有自己的问题，比如管理窗口间通信（例如价格窗口的变化可能使订单窗口数据过时）。可能想看看使用这种方法的 Christian Bauer 的挥杆示例。

我想，与其他所有事情一样，没有单一的正确方法可以做到这一点，您如何管理会话取决于应用程序的布局方式，例如，如果每个窗口都可以是一个独立的工作单元，这不会干扰其他工作单元，那么每个窗口的会话可能是更好的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T09:12:10.043

您要解决的是同步两个模型：您有内存模型和数据库模型。碰巧将每个更改传播到数据库中太昂贵了。此外，您希望能够处理错误（即将您的模型回滚到一致状态）。为了能够做到这一点，你必须有办法说“现在，它是一致的”。

当前的解决方案是在已知模型一致时（通常在开始更改之前）在数据库中启动事务，然后在内存模式下进行所有更改，以某种方式将它们映射到数据库，更新数据库然后提交事务。

虽然这听起来很简单，但 OO 编程却积极阻碍了这一进程。我们将模型操作隐藏在调用结构的深处，我们非常努力地让一段代码的用户不知道代码实际做了什么。在一个完美的世界中，您的开发工具应该将操作所需的所有代码展开到单个方法/函数中，将其包装在事务中并使用它来完成。

这行不通。相反，我们决定引入一个全局变量：会话。这很糟糕，我们对此感到羞耻，所以我们试图隐藏这个事实，但会话是全局的 - 每个操作。现在您需要一种将会话附加到操作的方法。您可以说“在当前线程中执行的所有代码都是一个操作”。如果你这样做了，自然的解决方案是让每个线程的会话都是全局的。

或者你有一些令牌。然后，您将会话附加到令牌并传递它。

但基本问题始终是：如何将会话附加到模型上的单个操作。困难的部分是知道操作何时开始、何时结束以及如何处理错误。

对于 Web 应用程序，使用请求是定义操作的自然方式：请求期间发生的所有事情都被视为一个步骤。该应用程序并没有真正将模型保存在内存中。在请求结束时一切都被遗忘，并在下一个请求到来时再次从数据库加载。缓慢但易于管理。

桌面应用程序是一种完全不同的野兽。他们通常将整个模型一直保存在内存中。除非用户提出要求（当她“保存”她的工作时），否则我们不会保留更改，因为这太慢了，而且由于没有什么比请求更重要，因此没有简单、自动的方式来定义“操作” .

将操作附加到事件的想法很好。只有在桌面应用程序中，您可以拥有多个与事件通信的线程，现在，您需要一种方法将所有事件标记为“它们属于从很久以前收到的事件 X 开始的操作”。事件通常是小的、不可变的数据片段，因此您不能将会话附加到它们。但是你需要某种标记来标记所有属于一起的事件。这就是为什么大多数桌面应用程序要么与服务器一起工作（它再次像 Web 应用程序一样工作）并且没有大的内存模型，或者他们不使用数据库而是以自定义格式保存他们的模型（想想 Office）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T01:12:31.777

关闭会话时，请注意这会导致您的对象分离，并且将涉及一些额外的开销来将对象重新附加到会话以便保存或使用数据库更新它们。

话虽如此，我同意你的观点，拖着一个会话没有多大意义，你应该在每个事务结束时释放会话。我将导致拥有一个会话池，每个线程都可以根据需要从中访问会话，并在完成后将其释放回池中。您可以使用 Spring 来帮助您管理会话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T01:13:20.230

这实际上取决于应用程序，但实际上您只希望会话持续与数据库上的逻辑事务一样长。我很确定会话不是线程安全的，因此您可能希望将行为本地化到单个类。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T01:24:46.850

我真的看不出有什么令人信服的理由，为什么你想在一个有 Swing 前端的应用程序中做不同的事情，然后是一个 Web 前端。在后一种情况下，通常会为每个请求创建一个 Session，尽管在许多情况下，Session 的实际创建是透明地处理的（例如，由 Spring 处理）。

假设您的 Swing 应用程序实现了 MVC 模式，那么为什么不在每个控制器方法的开头创建 Session 并在最后关闭它。如果您的应用程序是多线程的，您可以使用[ThreadLocal](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ThreadLocal.html)变量轻松地将每个 Session 范围限定为特定线程。这几乎与 Servlet 容器（即 Web 应用程序）中发生的情况完全相似。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-21T15:35:03.107

**最佳实践（您的经验可能会有所不同）：** 多用户客户端/服务器应用程序中最常见的模式是每个请求会话。在这个模型中，来自客户端的请求被发送到服务器（Hibernate 持久层运行的地方），一个新的 Hibernate Session 被打开，所有的数据库操作都在这个工作单元中执行。一旦工作完成（并准备好客户端的响应），会话将被刷新并关闭。您还可以使用单个数据库事务来处理客户端请求，在您打开和关闭会话时启动并提交它。两者之间的关系是一对一的，该模型非常适合许多应用程序。

见：[http ://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#transactions-basics-uow](http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/#transactions-basics-uow)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T09:00:56.700

我更喜欢每个模型更新的会话。它有助于避免长时间的会话，还有助于最大限度地减少会话创建的总数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T02:15:48.907

如果您创建一个线程池，那么您不会为每个事务或每个请求的连接付出太多代价，具体取决于您在做什么。

我倾向于将较低级别的代码划分为一个处理表或其他对象的类，然后在上面是一个控制器，它知道如何与多个 daos 对话。例如，要下订单，您检查它是否有库存，然后您处理付款，然后减少项目并下订单。这些将是跨越多个 daos 的事务，因此它们应该使用相同的会话。

但是，使用一个连接会出现问题，因为您将连接连接一段时间，并且您可能会丢失连接，同时假设它仍然存在。如果每个屏幕或页面有一个请求，同样的问题会更加复杂。

您可以查看 Spring 用户的一些最佳实践，因为 Hibernate 似乎在该框架中非常流行。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-25T09:55:28.707

由于在 Oracle 中创建会话的成本很高，而且我主要使用 Oracle 作为 RDBMS，所以我会选择“为整个应用程序创建一个会话”。“每个事件处理一个会话”在 GUI 应用程序的上下文中似乎很荒谬。在网络上这样做是有原因的，但这些原因通常不适用于 GUI 程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-25T11:00:27.440

您真正想要避免的是每个操作会话的场景，其中对于每个单个数据库操作，都会创建并关闭一个新的 Hibernate 会话。

编辑：忽略我之前关于应用程序生命周期中一个会话的废话，这样做完全有可能（并且可能是最有效的方式）。只要确保适当地划分您的事务 - 无论是使用 Spring @Transaction 之类的声明方式，还是以编程方式。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-10T12:36:52.127

我对可以包装在事务中的每一系列数据库操作使用一个会话，这包括尽可能随时传递对象集合，但是延迟加载字段/属性的关闭会话问题不断出现。

我的应用程序是 Swing 和 JavaFX 的混合体，这就是我修复它们的方式：

我的第一种方法是不使用任何延迟加载，但这对于一些具有更复杂对象图的实体来说是一场噩梦。

JavaFX 的 Table View 控件在我的应用程序中扮演着重要的角色，与 JavaFX 上的 TableView 相比，我认为 swing JTable 很糟糕。

现在，当我加载 JFrame 或 JInternalFrame 或 JDialog 时，我预加载了最新的“工作”实体，它们的所有子项都加载了延迟加载，没有性能命中，我将数据绑定到具有主核心的 TableView 控件急切加载的字段可见。用户需要从 TableView Grid 中选择一条记录来处理，当他们这样做时，我重新获取实体的实例，因为我有一个句柄到它的 Id，在获取对象之后，然后是 .size() 方法为所有延迟加载的子集合调用。这会强制 Hibernate 加载惰性字段/属性。

我现在可以对一个特定的对象实例做任何我想做的事情，并且所有的孩子都被填充了。

我认为这种方法将性能提高了两倍。获取列表数据时，速度很快。当您获取具有 Id 的对象时，它的精确点，并且由于孩子都是延迟加载的，这意味着选择也更轻巧且更紧凑。

# xml - 使用 XSLT 将子节点移动到父属性中

> ID：875900
> 
> 赞同：3
> 
> 时间：2009-05-18T01:12:07.597
> 
> 标签：xml, xslt

我有一些包含记录和子记录的 XML，如下所示：

```
<data>
    <record jsxid="id0x0b60fec0" ID="12429070" Created="2008-10-21T03:00:00.0000000-07:00">
        <record jsxid="id0x0b60ff10" string="101"/>
        <record jsxid="id0x0e64d8e8" string="63"/>
        <record jsxid="id0x2fd83f08" string="Y"/>
    </record>
    <record jsxid="id0x0b60fec0" ID="12429070" Created="2008-10-21T03:00:00.0000000-07:00">
        <record jsxid="id0x0b60ff10" string="102"/>
        <record jsxid="id0x0e64d8e8" string="77"/>
        <record jsxid="id0x2fd83f08" string="Y"/>
    </record>       
<data> 
```

我需要对其进行转换，以便将子记录的字符串属性作为连续编号的属性带到父记录中，然后将其丢弃，如下所示：

```
<data>
    <record jsxid="id0x0b60fec0" ID="12429070" Created="2008-10-21T03:00:00.0000000-07:00" 1="101" 2="63" 3="Y"/>
    <record jsxid="id0x0b60fec0" ID="12429070" Created="2008-10-21T03:00:00.0000000-07:00" 1="102" 2="77" 3="Y"/>
<data> 
```

子记录的数量在文档中是任意的，但在同一文档中保持不变。

有人会这么好心地指出 XSLT 解决方案的方法吗？非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T01:49:30.830

这是一个完整的解决方案：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <!-- By default, recursively copy all nodes unchanged -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <!-- But don't process any children of <record> (such as whitespace)... -->
  <xsl:template match="record/node()"/>

  <!-- ...except for doubly-nested records;
       convert them to attributes, named according to position -->
  <xsl:template match="record/record" priority="1">
    <xsl:variable name="pos">
      <xsl:number/>
    </xsl:variable>
    <xsl:attribute name="r{$pos}">
      <xsl:value-of select="@string"/>
    </xsl:attribute>
  </xsl:template>

</xsl:stylesheet> 
```

请注意，我将您的属性名称更改为“r1”、“r2”等，因为 XML 不允许您以数字开头的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T01:25:44.553

这可能会做到这一点，在处理顶级`<record>`元素时运行以下 XSLT 片段：

```
<xsl:for-each select="record">
    <xsl:attribute name="{position()}">
        <xsl:value-of select="@string" />
    </xsl:attribute>
</xsl:for-each> 
```

本质上，这会遍历每个子`<record>`元素并创建一个`<xsl:attribute>`描述所需属性的元素。调用该`position()`函数以获取顶级元素内的相对位置：1、2、3 等。

这不是一个完整的解决方案；假定您对 XSLT 有一定的了解。

# c# - Windows Mobile GUI 选项

> ID：875909
> 
> 赞同：0
> 
> 时间：2009-05-18T01:15:09.117
> 
> 标签：c#, c++, user-interface, windows-mobile

我是 WinMo 的新手，想为 Windows Mobile Touch 设备编写一个 GUI 应用程序。

我熟悉 C#/C++，虽然没有任何 GUI 开发，并且正在为具有大型 C++ 代码库的应用程序编写 GUI，我已经成功地移植到平台。

对于熟悉 ObjectiveC/Cocoa 的人，您有什么建议可以简化向 Windows GUI 开发的过渡？

具体来说：1）有哪些选择？语言/框架/工具包 + Pro's/Con's。

2）什么是约定？我想我正在寻找类似 iPhone 的苹果人机界面指南。

3) 将托管 C# 与非托管 C++ 接口的最佳方式是什么，我假设是 pInvoke？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T06:45:06.527

我已经使用[WTL](http://sourceforge.net/projects/wtl)为智能手机创建应用程序，因为您最终会得到一个很少（如果有的话）依赖项的小型 EXE。值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:07:46.397

如果你想做一个企业应用程序，.NET 很适合你。但是要为大众市场做一个快速响应的应用程序，我认为.NET 做不到。我已经看到一些应用程序首先在 .NET 中完成，然后由于性能问题而在 C++ 中重新编写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T03:15:16.053

关于2， http: [//msdn.microsoft.com/en-us/library/bb158602.aspx](http://msdn.microsoft.com/en-us/library/bb158602.aspx)

我没有对 WinMob 上的不同框架做太多事情，所以我不适合评论其他问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T05:56:05.967

1) 对于 GUI 设计，您可以在 C++/MFC 和 .NET Compact Framework 之间进行选择。推荐的 UI 方法（尤其是对于新手）是使用 C# 的 .NET Compact Framework。IDE支持很棒，语言和框架都很成熟。这几乎就像为常规 .NET 平台编写代码一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-10T07:34:06.260

如果您的目标 Windows 移动设备支持 opengl，请查看[silvermoon](http://silvermoon.codeplex.com)

# algorithm - 如何将两个队列合并为一个队列？

> ID：875911
> 
> 赞同：4
> 
> 时间：2009-05-18T01:16:31.017
> 
> 标签：algorithm, merge, queue

给定两个支持操作 enqueue/push_back、dequeue/pop_front 和 size 的队列

```
Q1: A1 A2 A3
Q2: B1 B2 B3 
```

如何将它们合并到第三个队列中（也支持相同的操作），获得：

```
Q3: A1 B1 A2 B2 A3 B3 
```

我对使用的算法更感兴趣，而不是任何特定的语言实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:42:23.903

这是一些伪代码：

```
Queue mergeQueues(Queue A, Queue B)
{
    Queue newQ;
    while(A.nonempty() OR B.nonempty())
    {
        if (A.nonempty())
            newQ.push(A.pop());
        if (B.nonempty())
            newQ.push(B.pop());
    }
    return newQ;
} 
```

where`push`将一个元素插入队列并`pop`删除队列中的下一个元素并返回它。

请注意，这不适用于堆栈。你最终会得到向后的元素。如果您可以反转堆栈（例如，通过重复转移到另一个堆栈），那么它将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T01:21:43.300

虽然两个队列都不是空的，但从 A 中取出一个项目并将其排入 newQ。然后将一个项目从队列 B 中出列。如果其中一个队列（A 或 B）为空，则将另一个队列的其余部分出列并将每个元素入队到 newQ。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T03:03:44.600

它似乎很适合递归实现：

```
mergeQueues :: Queue a -> Queue a -> Queue a
mergeQueues qa qb =
    merge qa qb emptyQueue
    where
        merge qa qb qr
            | isEmpty qa = append qb qr
            | otherwise  = move (merge qb) qa qr
        append q qr
            | isEmpty q  = qr
            | otherwise  = move append q qr
        move f q qr =
            let (val,q') = pop q
             in f q' (push val qr) 
```

请注意，我们只是在递归时来回翻转队列以便在它们之间交替，直到一个为空，此时我们只是从一个附加到另一个。

请注意，尽管这比 ribond 给出的命令式版本长，但它只进行了最少数量的`isEmpty`检查。如果您不介意在稍微优化的版本中进行尽可能多的检查（将 isEmpty 值分配给变量以供下面重用），您可以删除该`append`函数并继续调用`merge`，在添加初始测试后`merge`测试两个队列是否为空，如果是则终止递归。

对于不熟悉 Haskell 的人，我们传入移动下一个要调用的函数（这是高阶函数式编程）；在这种`append`情况下，这只是附加，在这种`move`情况下是“部分应用”的移动函数：它获取第一个参数，`qb`在我们调用之前应用`move`，然后`move`应用其他两个参数。

这听起来像是在日常业务编程中可能遇到的一项合理任务。但是，如果这是一个家庭作业功能，我建议你仔细研究一下上面的代码是如何工作的，我想你会学到一些东西。

另外，上面的代码有可能有错误；证明它有效（或发现错误）将是一个很好的练习。

# cookies - 有没有办法在 Pylons 中将 cookie 标记为 HttpOnly？

> ID：875913
> 
> 赞同：0
> 
> 时间：2009-05-18T01:19:25.613
> 
> 标签：cookies, pylons, httponly

我在网上找不到任何有关如何执行此操作的文档。我认为它可能可以发送某种自定义 HTTP 标头响应，但如果有更规范的方式，这样做似乎有点蹩脚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T04:44:46.757

```
theresponse.set_cookie(..., httponly=True, ...) 
```

# asp.net - 如何在 ASP.NETMembership 中使用匿名用户

> ID：875914
> 
> 赞同：1
> 
> 时间：2009-05-18T01:21:11.817
> 
> 标签：asp.net, authentication

尝试访问 UserID 时最好检查空用户还是应该分配一个匿名帐户？或其他？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T01:53:16.903

在 ASP.NET 成员资格中，您可以调用以下函数来检查用户是否已登录/已通过身份验证/匿名...

```
User.Identity.IsAuthenticated() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T01:25:18.533

您应该检查是否没有当前用户，然后在幕后自动创建一个新用户帐户并登录。如果您使用 cookie（并假设用户启用了它们），此“匿名用户”的后续访问仍将映射到您的用户存储库中的同一帐户，这对于跟踪活动很有用。

您可以自动将用户放入“注册”和“自动/匿名”组。这使您的代码可以轻松识别行为方式 - 例如，根据当前用户是否是“匿名”组的成员来决定是否显示“登录”或“我的帐户”链接。如果/当用户决定这样做时，它还可以更容易地将活动历史迁移到注册帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T02:05:19.293

如果您在页面上，该`User.Identity.IsAuthenticated()`属性将为您提供一个布尔值。如果您不在页面上（即，想要签入类方法），则需要导入`System.Web.HttpContext`命名空间。

# language-agnostic - 从应用程序中提取框架的最佳实践是什么？

> ID：875923
> 
> 赞同：2
> 
> 时间：2009-05-18T01:28:19.757
> 
> 标签：language-agnostic

我已经在一个应用程序上工作了两年多，并且开发了许多有用的帮助程序、实用程序、功能、设置约定等。

我想开始构建一个类似的应用程序，并认为我可以在新应用程序中重用现有应用程序中内置的许多功能。

我一直听说从应用程序中提取框架是最好的，但没有听到太多关于它的最佳实践。更好地知道对框架的更改可以使我将要构建的所有类似应用程序受益（可能有十几个）。

我从哪里开始？有什么最佳实践吗？有什么陷阱或需要注意的地方吗？

编辑：我应该澄清一下，除了我自己，我不是为任何人做这件事。我正在为不同的行业开发类似的应用程序，所以核心是 90% 相同，不同之处在于细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T01:40:53.610

请参阅[从 Basecamp 中提取 Rails，](http://media.rubyonrails.org/presentations/extractingrails.pdf)了解 David Heinemeier Hansson 对 Rails 是如何产生的看法，从其起源作为 Basecamp 中使用的框架。鉴于 Rails 的流行，您可能会从 DHH 如何实现这一目标中学到一两件事。:-)

（好吧，也许与其说是如何，不如说是为什么。但仍然很有趣。:-)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T02:36:31.280

以下是 Starling Software 从为[QAM](http://www.starling-software.com/en/qam.html)和 QWeb 做这件事中学到的东西。

我们的方法是将其视为使用框架或原型框架分布在所有项目中的重构工作。我们将每个项目中的框架代码分成单独构建的东西，例如，src/myapp 包含应用程序特定的代码，而 src/qam 包含框架本身。每个项目都有自己的应用程序特定代码副本，还有一个单独的项目，其中仅包含框架本身的最新版本。当我们在特定项目中确定想要加入框架的内容时，我们：

1.  在项目中重构以概括代码（基于我们对这个应用程序和所有其他使用该框架的应用程序的理解）；
2.  在项目中进行重构，将通用代码从特定于应用程序的部分移至框架部分；
3.  将此更新应用于包含框架“主副本”的项目；
4.  将该主副本中的更改合并到也使用该框架的其他项目中；进而
5.  在其他项目中重构以使用框架的该部分而不是它们类似的特定于应用程序的代码。

这需要相当多的纪律才能快速移动更改。如果您刚刚完成了一项新功能的开发并立即将其引入其他项目，那么集成很容易。一段时间没有更新的项目变得更加难以更新以使用最新版本的框架。如果您不快速将更改引入主副本，您可能会在两个项目中的框架副本中出现不同的（更糟糕的是，冲突的）更改，并且合并可能会变得相当痛苦。在开始更改框架之前，您肯定希望将任何特定项目更新到最新版本的框架。

这样做需要在工具等方面有一定的实际支持。您需要一种在框架的不同副本之间来回移动更改的方法，方便快捷。我们有一个定制工具来做这件事`qu`（

为每个应用程序提供一个全面的测试套件会大有帮助；我不确定我是否想在没有那个的情况下尝试这个。

为了理智，重要的是保持较小的变化。同样，这完全取决于合并和移动更新的难度。如果它总是很快，而且你最近一直在做一些事情，那么事情就会很容易。变化越大，你在框架上工作的时间越长，事情就会变得越困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T01:33:54.673

把你所有的代码放在你办公桌旁边的一堆里。从空白页开始，编写您*希望*可以使用所需框架编写的代码。然后将您现有的代码用于组件，并编写允许您使用所需代码的框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:36:05.043

我以前做过，虽然这是一次有趣且有益的经历，但我不得不说我不会再这样做了。以下是我的理由...

1）人们期望你支持这个框架。这是我面临的第 1 个挑战。人们来找我寻求增强、问题和错误修复。嗯，这真的很艰难，因为我已经转移到其他项目并且没有时间支持他们。

*因此，请确保您为未来制定了明确的支持计划。* 应用程序将如何维护？谁来维护它？需要多少时间来维护它？最重要的是……谁来为这项维护买单？

2) 开发人员讨厌被告知要做什么或受到限制。我为 VB 开发人员编写的简化数据访问层的框架。它创建了一组易于使用的例程，无论 MS 做了什么来更改数据库访问例程，这些例程都可以正常工作。好吧，某些开发人员不喜欢被告知使用框架，所以他们会抱怨和抱怨。坦率地说，我厌倦了听到它，它引起了对同事的一些恶意。

*因此，请确保您有一些厚脸皮并且可以推销人们为什么应该使用您的框架。*

# jquery - jQuery多值弹出提示

> ID：875926
> 
> 赞同：0
> 
> 时间：2009-05-18T01:30:58.520
> 
> 标签：jquery, html, prompt

我有一些 jquery 代码正在执行 ajax 查找并返回逗号分隔值（value1、value2、value3 ...）

我想用这些值提示用户找出他们想要的值。

我没有太多运气找到一个 jquery 扩展，它会给我一个弹出窗口，显示值列表并返回选定的值。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T02:06:08.357

有一个带有 Dialog 类的 JQuery UI 库。您必须将值放在表单上，​​但它可以毫无问题地完成模态部分。

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

# objective-c - 编辑选定行中的单元格

> ID：875931
> 
> 赞同：0
> 
> 时间：2009-05-18T01:35:15.950
> 
> 标签：objective-c, cocoa

显然，我使用绑定的时间太长了，因为我不知道该怎么做。我有一张有几列的桌子。选择一行后，您可以编辑其优先级，从而修改核心数据属性。我也将其设置为 IBAction。基本上，我想从我的代码中访问 Core Data 属性的值。然后，我想将选择的任何行的第一列（并更改其优先级）设置为与优先级对应的多个感叹号。

抱歉，这措辞令人困惑；这是一个例子：

选择第 7 行。我将其优先级更改为 2。现在，Core Data 属性 myPriority 设置为 2。现在触发了一个代码块。它从 Core Data 中获取所选行（第 7 行）的优先级，并希望将所选行（第 7 行）的第 1 列设置为 2 个感叹号（优先级 2）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T03:37:33.287

如果您习惯于绑定，那么我建议您查看 NSValueTransformer；具体来说，创建一个将优先级值转换为感叹号字符串的子类。然后，您只需提供名称（与 中使用的名称相同`+setValueTransformer:forName:`）作为绑定中的“值转换器”属性。

例如，代码如下所示：

```
@interface PriorityTransformer : NSValueTransformer
@end

@implementation PriorityTransformer
+ (Class) transformedValueClass { return ( [NSString class] ); }
+ (BOOL) allowsReverseTransformation { return ( NO ); }
- (id) transformedValue: (id) value
{
    // this makes the string creation a bit simpler
    static unichar chars[MAX_PRIORITY_VALUE] = { 0 };
    if ( chars[0] == 0 )
    {
        // ideally you'd use a spinlock or such to ensure it's setup before 
        //  another thread uses it
        int i;
        for ( i = 0; i < MAX_PRIORITY_VALUE; i++ )
            chars[i] = (unichar) '!';
    }

    return ( [NSString stringWithCharacters: chars
                                     length: [value unsignedIntegerValue]] );
}
@end 
```

然后，您可以将此代码放入与中心类（例如应用程序委托）相同的文件中，并通过该类的`+initialize`方法注册它，以确保及时注册它以供任何 nib 找到它：

```
+ (void) initialize
{
    // +initialize is called for each class in a hierarchy, so always
    //  make sure you're being called for your *own* class, not some sub- or
    //  super-class which doesn't have its own implementation of this method
    if ( self != [MyClass class] )
        return;

    PriorityTransformer * obj = [[PriorityTransformer alloc] init];
    [NSValueTransformer setValueTransformer: obj forName: @"PriorityTransformer"];
    [obj release];   // obj is retained by the transformer lookup table
} 
```

# windows - 在 Windows 下嵌入外部应用程序

> ID：875934
> 
> 赞同：0
> 
> 时间：2009-05-18T01:36:42.560
> 
> 标签：windows, qt, embed, external

我有一个想要添加一些功能的 Windows 桌面应用程序。不幸的是，源代码不可用，但它有一个 COM API。

因此，我希望将此应用程序嵌入到我自己的窗口中（带有菜单、工具栏等）并通过 COM API 链接事件。

您如何建议我将一个应用程序嵌入到另一个应用程序中？（我本来打算使用 Qt 工具包，但它只支持在 Linux 上嵌入应用程序。）

谢谢，理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T10:10:53.020

您可以为此使用 ActiveQt——它既允许在 ActiveX 客户端中嵌入 Qt 组件，也允许在 Qt 应用程序中托管 ActiveX 组件。也可以看看

[http://doc.trolltech.com/4.5/activeqt.html](http://doc.trolltech.com/4.5/activeqt.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T10:15:36.660

我不确定Windows中有没有好方法。也许您可以让您的新应用程序成为一个“始终位于顶部”的窗口，该窗口大部分是透明的，并且与“嵌入式”应用程序的大小和位置相匹配。这可能是 .NET 最容易完成的。

# reporting-services - Reporting Services 2008：在参数中使用 user!userid

> ID：875939
> 
> 赞同：4
> 
> 时间：2009-05-18T01:40:53.470
> 
> 标签：reporting-services, parameters, ssrs-2008

我有一个带有参数的报告，该参数由查询返回的销售代表列表填充。我想根据运行报告的用户的安全权限过滤该列表。

为了使查询工作，我需要将 user!userID 传递给数据库。我试过这样的事情：

...其中用户名 = 用户！用户 ID...

但它不喜欢语法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T01:43:34.930

将您的查询更改为：

```
where UserName = @user 
```

...并在“参数”选项卡中，将“用户！用户 ID”分配给“@user”参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-22T23:40:29.460

只是想分享一下我的经验，如果像我一样在没有任何线索的情况下徘徊的可怜灵魂。我发现我的@user 参数必须是列表中的第一个，才能填充我的下拉列表，这取决于它。我不知道为什么会这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T00:46:05.893

是的，我可以确认在查询中使用用户 ID 设置另一个参数的默认值时，订单很重要。我必须删除并重新创建参数才能使其正常工作。我看不到移动参数顺序的方法

# groovy - 常规闭包参数

> ID：875941
> 
> 赞同：5
> 
> 时间：2009-05-18T01:41:06.840
> 
> 标签：groovy, closures

[本书](https://rads.stackoverflow.com/amzn/click/com/1590599950)中出现了以下使用 grails 邮件插件提供的 sendMail 方法的示例。

```
sendMail {
    to "foo@example.org"
    subject "Registration Complete"
    body view:"/foo/bar", model:[user:new User()]
} 
```

我知道 {} 中的代码是一个作为参数传递给 sendMail 的闭包。我也明白`to`，`subject`并且`body`是方法调用。

我试图弄清楚实现 sendMail 方法的代码是什么样的，我最好的猜测是这样的：

```
MailService {

    String subject
    String recipient
    String view
    def model

    sendMail(closure) {
        closure.call()
        // Code to send the mail now that all the 
        // various properties have been set
    }

    to(recipient) {
        this.recipient = recipient
    }

    subject(subject) {
        this.subject = subject;
    }

    body(view, model) {
        this.view = view
        this.model = model
    }
} 
```

这是合理的，还是我错过了什么？特别是，闭包（`to`, `subject`, `body`）中调用的方法是否必须与 ? 属于同一类的成员`sendMail`？

谢谢，唐

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-28T00:39:30.987

MailService.sendMail 闭包委托：

```
 MailMessage sendMail(Closure callable) {
    def messageBuilder = new MailMessageBuilder(this, mailSender)
    callable.delegate = messageBuilder
    callable.resolveStrategy = Closure.DELEGATE_FIRST
    callable.call()

    def message = messageBuilder.createMessage()
    initMessage(message)
    sendMail message
    return message
} 
```

例如，MailMessageBuilder 的方法：

```
void to(recip) {
    if(recip) {
        if (ConfigurationHolder.config.grails.mail.overrideAddress)
            recip = ConfigurationHolder.config.grails.mail.overrideAddress
        getMessage().setTo([recip.toString()] as String[])
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T02:06:27.793

我不确定 sendMail 方法的确切作用，因为我没有您提到的书。如您所描述的， sendMail 方法确实采用了闭包，但它可能使用[构建器](http://groovy.codehaus.org/Builders)而不是以正常方式执行。本质上，这将是一种用于描述要发送的电子邮件的领域特定语言。

您定义的类不起作用的原因是闭包的范围是声明它的地方而不是运行它的地方。因此，让您的闭包调用 to() 方法，除非您将邮件服务的实例传递给闭包，否则它将无法调用 MailService 中的 to 方法。

通过一些修改，您的示例可以通过使用常规闭包来工作。以下对调用的更改和

```
// The it-> can be omitted but I put it in here so you can see the parameter
service.sendMail {it->
    it.to "foo@example.org"
    it.subject "Registration Complete"
    it.body view:"/foo/bar", model:[user:new User()]
} 
```

类中的 sendMail 方法应如下所示

```
def sendMail(closure) {
    closure(this)
    // Code to send the mail now that all the 
    // various properties have been set
} 
```

# http - HTTP“获取”安全性

> ID：875944
> 
> 赞同：4
> 
> 时间：2009-05-18T01:42:52.873
> 
> 标签：http, get

有哪些 HTTP“获取”安全最佳实践？

什么时候应该隐藏 HTTP Get 查询字符串值？

**编辑**- 我继承的应用程序具有所有查询字符串参数 XOR '加密'。它还在查询字符串中传递诸如 AccountID 之类的内容。所以我想知道这些是否是好的做法，如果不是，我将如何纠正这些事情。

**编辑**-

我可以用来解决这个问题的一种方法是创建一个基类（这只是伪代码）：

```
 public mustinherit class QSBase

  public shared Unique as long = 0
  private m_ID as string

  public readonly property ID
    get
      return m_ID
    end get
  end property

  public sub new()
   m_ID = Unique 'somehow get a unique value for this querystring
   Unique += 1
  end sub

  public function IDQueryString() as string
    return "ID=" & m_ID
  end function

end class 
```

然后对于应用程序中的每个页面，我将为每个查询字符串值创建一个具有属性的派生类。

```
 public class QSPage1
  inherits QSBase

  private m_AccountID as string

  public readonly property AccountID as string
    get
      return m_AccountID
    end get
  end property

  public sub new(byval _AccountID as string)
    m_AccountID = _AccountID
  end sub

end class 
```

然后，当我将查询字符串传递给弹出窗口或其他页面时，我会实例化相关类，将其存储在会话中并在查询字符串上传递唯一 ID

```
 Dim qs as new QSPage1("123456")
Session(qs.ID) = qs
Server.Transfer("Page1.aspx?" & qs.IDQueryString())
'or
CreatePopup("Page1.aspx?" & qs.IDQueryString()) 
```

在页面中，我通过提取唯一 ID 并引用存储的会话值来访问这些值：

```
 AccountID = CType(Session(Request.QueryString("ID")), QSPage1).AccountID() 
```

当然可以在页面中放入一个函数或一个类。

这种方法的一些好处是：

*   除了不相关的 ID 之外，没有任何查询字符串可见。
*   在现有代码中实现相当容易。

一些缺点是：

*   长时间的会话可能会累积许多这样的查询字符串对象
*   该会话的唯一 ID 需要是“真正唯一的”

谁能想到任何其他好处/缺点或更好的方法来做到这一点（除了重写应用程序）？

**编辑**-

感谢所有说要使用 HTTPS 和 POST 的人。不幸的是，我正在寻找仅与使用“GET”有关的答案。（除非您可以解释如何在不使用 QueryString、Session 或 Javascript 的情况下将数据发布到弹出窗口？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T01:44:36.380

如果您有任何值得掩盖的事情，那么我建议您使用 HTTPS 并转储 HTTP。

通常，我不会在查询字符串中放置与客户、供应商或订单标识符相关的任何内容。但这就是我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T01:50:57.410

我认为你永远不应该混淆 GET 参数。

如果需要在导航栏隐藏查询字符串中的参数，应该使用post。

如果您想防止嗅探器拦截您的 GET 参数数据，请使用 HTTPS。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T01:47:59.337

也许你可以扩展你想要完成的事情？一般来说，您应该避免将重要的东西（如登录凭据）放在 URL 中。URL 有“泄露”的习惯。

一般建议：设置您的 robots.txt 以防止 Google 将这些页面中的任何一个编入索引，并使登录令牌（或其他）只能一次性使用。

编辑：我建议不要使用弱异或“加密”。如果您担心有人篡改 URL 参数，请添加安全哈希。如果您确实需要隐藏查询包含的信息，然后对其进行真正的加密，请不要使用您自己的弱算法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T02:16:20.687

绝不要保护`GET`请求中的信息。这些请求由 Web 服务器直接记录。因此，该信息以纯文本格式提供，供第三方查看和破解，如果他们愿意的话。

如果您需要传递凭据，请使用 cookie 存储状态信息并通过 SSL 对所有内容进行分层。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-10T04:39:29.447

My honest answer is that unless the data is REALLY sensitive (like a password, or credit card number, etc) then whoever coded the "encryption" was probably trying to cover up a lack of proper authentication/authorization in the app.

If for instance you are concerned that if you don't encrypt the "accountId=1" part of the URL then someone will be able to tamper it to "accountId=2" and view someone else's account, then the real flaw in the app is that it doesn't check the ownership of the account before delivering the goods!

Trying to fix this lack of authorization checking with encryption is at best a bandaid. Note that bandaids are sometimes necessary - it may be too hard to do anything else at this point - but we should still recognize it for what it is.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T01:56:07.903

如果您想要更高的安全性，请使用 POST？

您不应该在查询字符串中传递帐户信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T02:13:59.443

您可以在 asp.net 中使用 HttpModule，它可以全局加密 HTTP Get 值 - [用于查询字符串加密的 HttpModule](http://madskristensen.net/post/HttpModule-for-query-string-encryption.aspx)。此外，使用 SessionId 作为加密/描述的密钥，这使得每个会话的查询字符串更加安全。但是，它不是 100% 安全的，我不会推荐它用于高安全性网站。

正如“JD”所建议的那样，最好使用 HTTPS 来保护服务器和客户端之间的通信。但是，客户端可以在浏览器上轻松更改参数值，例如 /showinvoice.aspx?id=1000 到 /showinvoice.aspx?id=1001

我建议在执行页面之前在服务器端验证每个参数的值。这将停止执行无效的请求。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T01:54:47.510

想到几个...

*   根据请求的内容，可能需要身份验证和授权。

*   如何消费和使用查询参数数据值得考虑。如果参数数据以除了一组选项之外的任何方式使用，并且如果它可能来自不受信任的来源，那么可能需要验证参数值。

*   小心返回错误代码。攻击者可以使用错误代码通过了解站点的地形来确定可能的攻击向量：如果资源不存在或参数错误等返回什么。

# java - Spring 是否会结合 MVC 和 WebFlow？

> ID：875948
> 
> 赞同：3
> 
> 时间：2009-05-18T01:45:26.720
> 
> 标签：java, spring, spring-mvc, spring-webflow

我想我曾经在某个地方读过 Juergen Holler 说 Spring 的未来目标是结合 Spring MVC 和 WebFlow ......

现在还是这样吗？

目前它们似乎仍然是相当独立的项目，WebFlow 被推荐为 MVC 的扩展。作为开发人员，如果我可以同时使用这两种控制器并以相同的方式（Java 或 XML）定义我的所有控制器，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T22:43:18.837

嗯，这是我发现[的东西：](http://blog.springsource.com/2009/04/20/spring-web-flow-project-update/)

Web Flow 3 ...您可以期待看到引入了 @Flow 模型，该模型补充了 Spring MVC 的无状态 @Controller 模型并允许将有状态的 Web 流定义为 POJO。

# c++ - 在 Hook Filter 函数中过滤 Windows 消息

> ID：875950
> 
> 赞同：1
> 
> 时间：2009-05-18T01:46:28.497
> 
> 标签：c++, windows, winapi, hook

我正在尝试使用 Windows 挂钩检索另一个应用程序的消息。我已经用 SetWindowsHookEx 设置了一个 WH_GETMESSAGE 钩子。这是通过 DLL 完成的。在我的 GetMsgProc 函数（每当目标应用程序收到消息时都应该调用它）中，我想根据消息的类型采取行动。但是我在使用这个 if 语句时遇到了麻烦。

```
LRESULT CALLBACK MessageHookProcedure(int code, WPARAM wParam, LPARAM lParam){
    if(((MSG*)lParam)->message == WM_COMMAND){
        MessageBox(NULL,L"The hook procedure was called",L"Test Window",MB_OK);
    }

    return CallNextHookEx(g_MessageHook,code,wParam,lParam);
} 
```

由于某种原因，永远不会创建 MessageBox。我知道应用程序正在接收来自 Spy++ 的 WM_COMMAND 消息。如果我取出 IF 语句，MessageBox 会在接收各种消息时一遍又一遍地创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T02:09:15.743

你确定你分别钩住了正确的窗口或正确的消息吗？在某些情况下会生成`WM_SYSCOMMAND`or`WM_MENUCOMMAND`而不是`WM_COMMAND`.

您的代码看起来不错，您是否也尝试将传入消息转储到控制台？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T08:22:14.180

这里的 LPARAM 是指向 CWPSTRUCT 的指针，而 CWPSTRUCT 又包含消息参数。以下应该工作。

```
LRESULT CALLBACK MessageHookProcedure(int code, WPARAM wParam, LPARAM lParam){
    if(((CWPSTRUCT*)lParam)->message == WM_COMMAND){
        MessageBox(NULL,L"The hook procedure was called",L"Test Window",MB_OK);
    }

    return CallNextHookEx(g_MessageHook,code,wParam,lParam);
} 
```

# php - 如何处理 HTML 表单中的“仅”可见字段？

> ID：875958
> 
> 赞同：0
> 
> 时间：2009-05-18T01:51:54.413
> 
> 标签：php, html, forms

有没有办法不处理“display:none”样式的字段？这些字段使用 javascript 动态隐藏，但在 PHP 中正常处理。

我正在寻找一个 PHP 解决方案（没有 javascript）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T02:02:44.027

根据表单的结构，删除`name`隐藏输入的属性可能是一种可行的方法。在您用来隐藏输入的任何 Javascript 中，添加以下行：

```
myInputElement.removeAttribute('name'); 
```

没有名称的输入不会与表单一起提交。如果您可能需要恢复（并再次显示输入），您可能需要考虑将名称存储在可检索的位置：可能使用与每个元素相同的名称`name`，`id`或者将其存储到某个元素的`class`属性中。

* * *

正如 Colin 所建议的，一个更好的主意是禁用该元素。这将与删除其名称具有相同的效果，但是如果您需要，它会更容易恢复。

```
myInputElement.disabled = true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T02:25:42.630

我记得被[禁用](http://www.w3.org/TR/html401/interact/forms.html#adef-disabled)的输入不会在表单数据中提交。因此，当您隐藏该字段时，也要设置 disabled 属性。无需使用名称和 ID。

来自 W3C：

> 在本例中，INPUT 元素被禁用。因此，它无法接收用户输入，也不会将其值与表单一起提交。
> 
> <输入禁用名称=“弗雷德”值=“石头”>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T01:54:39.927

您可以使用 javascript 将隐藏字段中的所有值设置为“”。可选地，像 jQuery 这样的库可以帮助您以更简单的方式根据您的样式 (style="display:none;") 选择字段...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T01:58:01.450

您可以通过使用 :visible 选择器来查看哪些表单元素是可见的，然后将可见的元素序列化为表单并提交它，或者删除不可见的元素来执行此操作（以 jQuery 为例）。

[http://docs.jquery.com/Selectors/visible](http://docs.jquery.com/Selectors/visible) [http://docs.jquery.com/Selectors](http://docs.jquery.com/Selectors)

[http://docs.jquery.com/Ajax/serialize](http://docs.jquery.com/Ajax/serialize) [http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

但是，您可以更容易地使表单元素在它们变得不可见时变为空，然后在服务器端使它们成为可选的。

**编辑** 除非您以一种或另一种方式发送指令，否则我无法想到让 PHP 不处理它们。任何有名字的东西都将被处理，除了复选框，它由缺少值表示。据我所知，当提交表单时，PHP 无法判断客户端的字段可见状态是什么。

也许您可以将禁用/不可见字段的名称添加到一个额外的隐藏字段中，用逗号或其他东西连接起来，并构建 PHP 以不处理其中出现的字段。否则，您可以操纵字段名称以 proc_ 和 noproc_ 或其他名称开头，并将其用作是否处理该字段的指令，但同样您只是将额外的指令传递给 PHP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T02:01:49.613

删除各个字段的名称属性。PHP 不会处理它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T02:14:16.153

我不确定您是否可以在不至少对 Javascript 进行一些更改的情况下做到这一点。

由于这些字段隐藏在浏览器中（可能使用 CSS），因此接收表单的 PHP 脚本无法知道哪些是隐藏的（它不会获得当前的 CSS 状态），除非 javascript 提供帮助。

如前所述，我建议让 javascript 删除 name 属性，以便不提交字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T02:37:33.773

PHP 无法检测 HTML 表单是否被隐藏。唯一的方法是：A）使用 JS 取消设置名称

这样做的问题是，如果您想重新启用表单元素，您会丢失名称并且必须以某种方式存储它以替换它。

B）添加一个额外的隐藏字段，说明该字段是隐藏的（再次使用 JS）这将向 HTTP POST 添加更多数据，这可能被认为是一个缺点。另外，您还需要安装 PHP 来检查是否设置了“fieldHidden”$_POST 变量。

一个例子是创建一个名为“HiddenFields[hiddenFieldName]”的隐藏元素，然后使用 if array_key_exists 和您正在检查的 post 变量的名称。

这有点令人费解，但如果您愿意，仍然可以让 PHP 访问该变量。

C) 将该字段设置为只读。（再次，使用 JS）我认为这会起作用。但是 PHP 无法访问它，这可能是一个问题。

# python - 如何使用 Python 从字符串中删除符号？

> ID：875968
> 
> 赞同：98
> 
> 时间：2009-05-18T01:55:37.617
> 
> 标签：python, regex, string

我是 Python 和 RegEx 的初学者，我想知道如何制作一个带有符号并用空格替换它们的字符串。任何帮助都很棒。

例如：

```
how much for the maple syrup? $20.99? That's ricidulous!!! 
```

进入：

```
how much for the maple syrup 20 99 That s ridiculous 
```

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-05-18T01:59:55.907

一种方法，使用[正则表达式](http://docs.python.org/library/re.html)：

```
>>> s = "how much for the maple syrup? $20.99? That's ridiculous!!!"
>>> re.sub(r'[^\w]', ' ', s)
'how much for the maple syrup   20 99  That s ridiculous   ' 
```

*   `\w`将匹配字母数字字符和下划线

*   `[^\w]`将匹配任何*不是*字母数字或下划线的

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-18T09:24:32.337

有时，找出正则表达式比在 python 中写出它需要更长的时间：

```
import string
s = "how much for the maple syrup? $20.99? That's ricidulous!!!"
for char in string.punctuation:
    s = s.replace(char, ' ') 
```

如果您需要其他字符，您可以将其更改为使用白名单或扩展您的黑名单。

示例白名单：

```
whitelist = string.letters + string.digits + ' '
new_s = ''
for char in s:
    if char in whitelist:
        new_s += char
    else:
        new_s += ' ' 
```

使用生成器表达式的示例白名单：

```
whitelist = string.letters + string.digits + ' '
new_s = ''.join(c for c in s if c in whitelist) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-18T05:45:07.460

我经常只是打开控制台并在对象方法中寻找解决方案。很多时候它已经在那里了：

```
>>> a = "hello ' s"
>>> dir(a)
[ (....) 'partition', 'replace' (....)]
>>> a.replace("'", " ")
'hello   s' 
```

简短回答：使用`string.replace()`.

# security - 如何划分面向外的 Bugzilla？

> ID：875983
> 
> 赞同：2
> 
> 时间：2009-05-18T02:02:53.840
> 
> 标签：security, bugzilla, issue-tracking

我们是一家拥有约 65 位客户的 ISV。当他们致电提出支持问题时，我们会将其记录在我们的内部 Bugzilla 实例中（在我们允许呼叫的每个客户站点都有少数经过专门培训的超级用户）。

我们正在考虑通过 Internet 提供此 Bugzilla 实例，以便客户可以记录他们自己的问题并跟踪他们的进度。但是，我们不希望任何客户看到另一个客户的问题，尤其是因为每个问题都可能包含商业敏感信息。

据我所知，Bugzilla 使用“产品”和“组”来控制错误可见性。在我们的例子中，我们必须设置超过 60 个，这将严重地使我们对 Bugzilla 的使用和管理（例如搜索和报告）复杂化。

是否有另一种方法可以提供对 Bugzilla 的分隔访问？是否有任何其他问题跟踪系统具有解决此问题的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T23:02:02.127

一旦一个 bug 被限制在一个只有某些人可以看到的组中，您可以选择让 (a) bug 报告者和/或 (b) CC 列表中的任何人都可以看到该 bug，无论他们是否是该组的一部分。事实上，我认为这是默认设置。

您可以创建一个内部组，您的所有员工都是该组的成员，而您的所有客户都不是。只有该组的成员才能访问该错误。如果您想授予客户对该错误的访问权限，请将其添加到 CC 列表中。如果错误输入不需要组成员身份*，*客户将能够输入错误，并且由于他们是报告者，因此将自动具有查看权限。

（目前我面前没有安装 Bugzilla，所以我只是在头脑中做这件事。）

# winapi - Windows 中 CreateFile 的默认缓冲区大小是多少？

> ID：875984
> 
> 赞同：0
> 
> 时间：2009-05-18T02:04:23.430
> 
> 标签：winapi, buffer, createfile

当调用 CreateFile 函数时没有标志 FILE_FLAG_NO_BUFFERING，操作系统内部缓冲区的大小是多少？

如果我的缓冲区大小大于 Windows 的内部缓冲区，我可以完全使用磁盘的吞吐量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T02:24:52.493

它可能因 Windows 版本而异，并且取决于可用 RAM 的数量。而不是依赖于任何特定的东西，您应该简单地使用适合您的应用程序的缓冲区大小进行读取和写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T20:58:49.000

这取决于您有多少 RAM，以及机器的配置方式。服务器通常配置为特权系统缓存。您可以通过更改以下注册表项来更改它

```
[HKEY_LOCAL_MACHINE \System \CurrentControlSet \Control \Session Manager \Memory Management] LargeSystemCache 
```

[SetSystemFileCacheSize 函数](http://msdn.microsoft.com/en-us/library/aa965240.aspx)可用于更改缓存大小。但是，据我了解，设置工作集大小更多的是对操作系统的提示，而不是硬限制。

关于你的第二个问题，我不确定你的意思。我看不出缓冲区的大小将如何影响吞吐量，但我相信如果我错了，有人会纠正我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-27T20:22:50.343

如果您使用无缓冲，那么除了您提供给读/写的缓冲区之外，实际上没有用于 I/O 的缓冲区。（压缩文件除外，这是一个不同的蜡球。）

在这种情况下，系统缓存会被忽略，这就是为什么需要（请参阅[MSDN](http://msdn.microsoft.com/en-us/library/cc644950(v=VS.85).aspx)）注意对齐和 I/O 大小的原因。

# c# - 实体框架不会在 SQL Express (MDF) 中保留数据

> ID：875995
> 
> 赞同：11
> 
> 时间：2009-05-18T02:09:52.933
> 
> 标签：c#, entity-framework, persistence, sql-server-express

我正在使用实体框架开发应用程序并将数据存储在 .mdf 数据库中。我的代码可以读取数据，显然它也可以保存，但只是表面上。它没有错误，当程序运行时它就像数据被保存一样，我可以例如保存一个对象，处理上下文，创建一个新对象，然后当我搜索我的对象时它就在那里！但是当我查询数据库以查看存储的数据时，那里什么都没有。如果我关闭应用程序并再次运行它，所有数据都会消失。这是我为测试而编写的示例代码：

```
 using (DatabaseEntities e = new DatabaseEntities())
        {
            for (int i = 0; i < 50; i++)
            {
                User u = new User();
                u.Nome = "User" + i.ToString();
                e.AddToUser(u);
            }
            int c = e.SaveChanges(true);

            List<User> us = e.User.Where<User>(x => x.ID < 50).ToList<User>();

            foreach (User u in us)
                Console.WriteLine("ID: " + u.ID + " Hello from " + u.Nome);

            Console.ReadKey();
        } 
```

当我运行它时，我得到 50 个输出，如果我在调试中查看 c 变量的内容，有 50 个更改，一切似乎都很好，但是当我启动查询浏览器并查看我的 MDF 数据库的内容时，那里什么都没有。

可能这是非常简单的事情，但我看不出它是什么，我需要你的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-19T21:06:57.520

我刚刚发现出了什么问题，我想实际上并没有什么问题。我强制出错，然后我可以看到我正在访问的数据库在 bin 目录中，Visual Studio 每次运行应用程序时都会将我的数据库复制到 bin 目录中，这就是为什么如果我手动添加一些数据我可以看到它，但运行时中的保存不会持久化。我一直在服务器中使用数据库，这是我第一次使用本地数据库，所以我把它搞砸了，但非常感谢你的帮助！

* * *

## 编辑：提供解决方案

如果您希望在构建时禁用复制数据库，则必须`Copy to Output Directoy`从`.mdf`解决方案资源管理器中访问文件。
只需将其更改为`Copy if newer`或`Do not copy`。

**请注意，访问[数据库](https://msdn.microsoft.com/en-US/library/ms246989.aspx)[时存在](https://msdn.microsoft.com/en-US/library/ms246989.aspx)`Copy if newer`一些风险。[`.mdf`](https://msdn.microsoft.com/en-US/library/ms246989.aspx)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T06:09:38.880

有几件事浮现在脑海：

*   双/高音检查您的连接字符串；你真的在和你认为的文件说话吗？
*   您是否在任何地方使用事务而不提交它们？
*   您是否将 mdf 文件设置为“始终复制”（或其他任何内容）....即，您是否在每次点击构建/播放时不断覆盖 mdf？

另外-我认为在这种情况下并不重要，但是要验证数据，您应该使用*不同*的实体/数据上下文：

```
using (DatabaseEntities e = new DatabaseEntities()) {
    for (int i = 0; i < 50; i++) {
        User u = new User();
        u.Nome = "User" + i.ToString();
        e.AddToUser(u);
    }
    int c = e.SaveChanges(true);
}
using (DatabaseEntities e = new DatabaseEntities()) {
    List<User> us = e.User.Where<User>(x => x.ID < 50).ToList<User>();
    foreach (User u in us)
        Console.WriteLine("ID: " + u.ID + " Hello from " + u.Nome);
}
Console.ReadKey(); 
```

就像我说的 - 我怀疑它在这里会很重要，但值得检查......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:06:41.633

由于使用 Visual Studio Server Explorer 将 MDF 数据库文件附加到 LocalDB 的方式，可能会出现这种情况。

当您附加 MDF 文件时，VS 会询问您是否要在项目中创建数据库的副本。如果您说“否”，则在配置文件中生成一个连接字符串，其中包括一个“attachdbfilename”条目，该条目指向磁盘上 MDF 文件的绝对路径（例如“C:\...”）。但是，如果您说“是”，它会复制 MDF 文件，将其添加到项目中，并且生成的连接字符串中的“attachdbfilename”条目将与 |DataDirectory| 相关。

当您按 F5 运行应用程序时，VS 会将***包括数据库 MDF 文件在内的***所有文件复制到 bin 文件夹中。对该数据库进行所有更改。当您关闭并重新启动应用程序时，原始数据库的新克隆将被复制到 bin 文件夹中，覆盖那里的所有内容，因此似乎覆盖了您之前的更改。这在[如何：管理项目中的本地数据文件中有所介绍](http://msdn.microsoft.com/en-US/library/ms246989.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T07:46:46.537

ID的类型是什么？一个 GUID？身份证怎么设置？使用 NewID() 作为默认值？如果是这种情况，O/R 映射器就无法读回 ID，并且可能会将实体标记为错误保存。如果您在 db 上执行任何查询，还请检查 SQL Profiler。**************