# StackOverflow 问答 11966000-11966999

# java - 使用 JavaMail API 发送邮件而不使用 SSL

> ID：11966005
> 
> 赞同：3
> 
> 时间：2012-08-15T08:15:15.423
> 
> 标签：java, android, exception, smtp, jakarta-mail

我想让我的 android 应用程序使用我的邮件服务器发送邮件，我的服务器使用端口 25，所以我的应用程序需要在没有 ssl 的情况下发送邮件。我已经尝试过这里大多数类似问题中提到的方法，但都没有奏效，因此我提出了一个新问题。以下是我读过的一些链接：
[使用带有 smtp 但没有 SSL 的 JavaMail API 在 android 中](https://stackoverflow.com/questions/10083547/send-email-in-android-using-javamail-api-with-smtp-but-without-ssl)
[发送电子邮件 使用 TSL](https://stackoverflow.com/questions/7081138/sending-emails-over-smtp-with-tsl?rq=1)
[Java Mail 通过 SMTP 发送电子邮件：在没有 SSL Javamail 的端口 25 上发送电子邮件时出现](https://stackoverflow.com/questions/1949871/java-mail-sslhandshakeexception-when-sending-email-on-port-25-without-ssl)
[SSLHandshakeException：javax.net.ssl.SSLHandshakeException：sun。](https://stackoverflow.com/questions/7939972/javamail-javax-net-ssl-sslhandshakeexception-sun-security-validator-validatore?rq=1)
[使用带有 TLS 的 JavaMail](https://stackoverflow.com/questions/411331/using-javamail-with-tls?rq=1) [从 VPS 发送邮件时出现 security.validator.ValidatorException](https://stackoverflow.com/questions/7939972/javamail-javax-net-ssl-sslhandshakeexception-sun-security-validator-validatore?rq=1)
[http://java.sun.com/products/javamail/javamail-1.4.2/SSLNOTES142.txt](http://java.sun.com/products/javamail/javamail-1.4.2/SSLNOTES142.txt)

下面是我的邮件发送类：

```
public class MailSender extends Authenticator { 
    private String user; 
    private String password; 

    private String [] to; 
    private String from; 

    private String port; 
    private String sport; 

    private String host; 

    private String subject; 
    private String body; 

    private boolean auth; 
    private boolean debuggable; 

    private Multipart multi; 

    public MailSender(){ 
        host = "me.myserver.com"; 
        port = "25"; 
        sport = "25"; 

        user = ""; 
        password = ""; 
        from = ""; 
        subject = ""; 
        body = ""; 

        debuggable = true; 
        auth = true; 

        multi = new MimeMultipart(); 

        // There is something wrong with MailCap, javamail can not find a handler for the multipart/mixed part, so this bit needs to be added. 
        MailcapCommandMap mc = (MailcapCommandMap) CommandMap.getDefaultCommandMap();  
        mc.addMailcap("text/html;; x-java-content-handler=com.sun.mail.handlers.text_html");  
        mc.addMailcap("text/plain;; x-java-content-handler=com.sun.mail.handlers.text_plain");  
        mc.addMailcap("multipart/*;; x-java-content-handler=com.sun.mail.handlers.multipart_mixed"); 
        mc.addMailcap("message/rfc822;; x-java-content-handler=com.sun.mail.handlers.message_rfc822");  
        CommandMap.setDefaultCommandMap(mc);  
    } 

    public MailSender(String user, String password){ 
        this();       
        this.user = user; 
        this.password = password;    
    } 

    public boolean send() throws Exception { 
        Properties props = setProperties(); 

        try{ 
            Session session = Session.getInstance(props, this); 
            session.setDebug(true); 

            MimeMessage msg = new MimeMessage(session); 

            msg.setFrom(new InternetAddress(from)); 

            InternetAddress[] addressTo = new InternetAddress[to.length]; 
            for(int i=0; i<to.length; i++){ 
                addressTo[i] = new InternetAddress(to[i]); 
            } 

            msg.setRecipients(MimeMessage.RecipientType.TO, addressTo); 
            msg.setSubject(subject); 
            msg.setSentDate(new Date()); 

            BodyPart messageBodyPart = new MimeBodyPart(); 
            messageBodyPart.setText(body); 
            multi.addBodyPart(messageBodyPart); 

            msg.setContent(multi); 

            Transport transport = session.getTransport("smtps"); 
            transport.connect(host, 25, user, password); 
            transport.sendMessage(msg, msg.getAllRecipients()); 
            transport.close(); 
            return true; 
        } catch (Exception e) { 
            e.printStackTrace(); 
            return false; 
        } 
    } 

    public void addAttachment(String filename) throws Exception { 
        BodyPart messageBodyPart = new MimeBodyPart(); 
        DataSource source = new FileDataSource(filename); 
        messageBodyPart.setDataHandler(new DataHandler(source)); 
        messageBodyPart.setFileName(filename); 

        multi.addBodyPart(messageBodyPart); 
    } 

    @Override  
      public PasswordAuthentication getPasswordAuthentication() {  
        return new PasswordAuthentication(user, password);  
      } 

    private Properties setProperties() { 
        Properties props = new Properties(); 

        props.put("mail.smtp.host", host); 

        if(debuggable) { 
            props.put("mail.debug", "true"); 
        } 

        if(auth) { 
            props.put("mail.smtp.auth", "true"); 
        } 

        //props.put("mail.smtp.ssl.enable", "false");
        //props.put("mail.smtp.ssl.trust", "*");

        props.put("mail.smtp.port", port); 
        props.put("mail.smtp.socketFactory.port", sport); 
        //props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory"); 
        //props.put("mail.smtp.socketFactory.fallback", "true"); 
        props.setProperty("mail.smtp.ssl.enable", "true");
        props.setProperty("mail.smtp.ssl.socketFactory.class",
                        "DummySSLSocketFactory");
        props.setProperty("mail.smtp.ssl.socketFactory.fallback", "false");

        //props.put("mail.smtp.starttls.enable", "false");

        return props; 
    } 

    public void setTo(String[] toAddress) { 
        this.to = toAddress; 
    } 

    public void setFrom(String fromAddress) { 
        this.from = fromAddress; 
    } 

    public void setSubject(String subject) { 
        this.subject = subject; 
    } 

    public void setBody(String body) {  
        this.body = body;  
    } 
} 
```

DummySSLSocketFactory.java：

```
public class DummySSLSocketFactory extends SSLSocketFactory {
    private SSLSocketFactory factory;

    public DummySSLSocketFactory() {
    try {
        SSLContext sslcontext = SSLContext.getInstance("TLS");
        sslcontext.init(null,
                 new TrustManager[] { new DummyTrustManager()},
                 null);
        factory = (SSLSocketFactory)sslcontext.getSocketFactory();
    } catch(Exception ex) {
        // ignore
    }
    }

    public static SocketFactory getDefault() {
    return new DummySSLSocketFactory();
    }

    public Socket createSocket() throws IOException {
    return factory.createSocket();
    }

    public Socket createSocket(Socket socket, String s, int i, boolean flag)
                throws IOException {
    return factory.createSocket(socket, s, i, flag);
    }

    public Socket createSocket(InetAddress inaddr, int i,
                InetAddress inaddr1, int j) throws IOException {
    return factory.createSocket(inaddr, i, inaddr1, j);
    }

    public Socket createSocket(InetAddress inaddr, int i)
                throws IOException {
    return factory.createSocket(inaddr, i);
    }

    public Socket createSocket(String s, int i, InetAddress inaddr, int j)
                throws IOException {
    return factory.createSocket(s, i, inaddr, j);
    }

    public Socket createSocket(String s, int i) throws IOException {
    return factory.createSocket(s, i);
    }

    public String[] getDefaultCipherSuites() {
    return factory.getDefaultCipherSuites();
    }

    public String[] getSupportedCipherSuites() {
    return factory.getSupportedCipherSuites();
    }
} 
```

DummyTrustManager.java：

```
public class DummyTrustManager implements X509TrustManager {
    public void checkClientTrusted(X509Certificate[] cert, String authType) {
    // everything is trusted
    }

    public void checkServerTrusted(X509Certificate[] cert, String authType) {
    // everything is trusted
    }

    public X509Certificate[] getAcceptedIssuers() {
    return new X509Certificate[0];
    }
} 
```

日志中的错误消息：

```
08-15 16:08:59.338: W/System.err(16163): javax.mail.MessagingException: Could not connect to SMTP host: me.myserver.com, port: 25;
08-15 16:08:59.338: W/System.err(16163):   nested exception is:
08-15 16:08:59.338: W/System.err(16163):    javax.net.ssl.SSLHandshakeException: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x5bfaf480: Failure in SSL library, usually a protocol error
08-15 16:08:59.338: W/System.err(16163): error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol (external/openssl/ssl/s23_clnt.c:766 0x580b87de:0x00000000)
08-15 16:08:59.338: W/System.err(16163):    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1391)
08-15 16:08:59.338: W/System.err(16163):    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:412)
08-15 16:08:59.346: W/System.err(16163):    at javax.mail.Service.connect(Service.java:288)
08-15 16:08:59.346: W/System.err(16163):    at Android.sender.MailSender.send(MailSender.java:100)
08-15 16:08:59.346: W/System.err(16163):    at Android.sender.Sender$SendMail.doInBackground(Sender.java:73)
08-15 16:08:59.346: W/System.err(16163):    at Android.sender.Sender$SendMail.doInBackground(Sender.java:1)
08-15 16:08:59.354: W/System.err(16163):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
08-15 16:08:59.354: W/System.err(16163):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-15 16:08:59.354: W/System.err(16163):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-15 16:08:59.354: W/System.err(16163):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
08-15 16:08:59.354: W/System.err(16163):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-15 16:08:59.354: W/System.err(16163):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-15 16:08:59.354: W/System.err(16163):    at java.lang.Thread.run(Thread.java:856)
08-15 16:08:59.354: W/System.err(16163): Caused by: javax.net.ssl.SSLHandshakeException: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x5bfaf480: Failure in SSL library, usually a protocol error
08-15 16:08:59.354: W/System.err(16163): error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol (external/openssl/ssl/s23_clnt.c:766 0x580b87de:0x00000000)
08-15 16:08:59.362: W/System.err(16163):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:436)
08-15 16:08:59.362: W/System.err(16163):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.<init>(OpenSSLSocketImpl.java:647)
08-15 16:08:59.362: W/System.err(16163):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.getInputStream(OpenSSLSocketImpl.java:618)
08-15 16:08:59.362: W/System.err(16163):    at com.sun.mail.smtp.SMTPTransport.initStreams(SMTPTransport.java:1449)
08-15 16:08:59.362: W/System.err(16163):    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1366)
08-15 16:08:59.362: W/System.err(16163):    ... 12 more
08-15 16:08:59.362: W/System.err(16163): Caused by: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x5bfaf480: Failure in SSL library, usually a protocol error
08-15 16:08:59.362: W/System.err(16163): error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol (external/openssl/ssl/s23_clnt.c:766 0x580b87de:0x00000000)
08-15 16:08:59.362: W/System.err(16163):    at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_do_handshake(Native Method)
08-15 16:08:59.362: W/System.err(16163):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:395)
08-15 16:08:59.362: W/System.err(16163):    ... 16 more 
```

这里我改了“Transport transport = session.getTransport("smtps");” 到“Transport transport = session.getTransport("smtps");”，并且错误日志中的消息已更改。

```
08-15 17:18:13.986: W/System.err(21399): javax.mail.MessagingException: Could not convert socket to TLS;
08-15 17:18:13.986: W/System.err(21399):   nested exception is:
08-15 17:18:13.986: W/System.err(21399):    javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.
08-15 17:18:13.986: W/System.err(21399):    at com.sun.mail.smtp.SMTPTransport.startTLS(SMTPTransport.java:1339)
08-15 17:18:13.986: W/System.err(21399):    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:420)
08-15 17:18:13.986: W/System.err(21399):    at javax.mail.Service.connect(Service.java:288)
08-15 17:18:13.986: W/System.err(21399):    at Android.sender.MailSender.send(MailSender.java:100)
08-15 17:18:13.986: W/System.err(21399):    at Android.sender.Sender$SendMail.doInBackground(Sender.java:73)
08-15 17:18:13.986: W/System.err(21399):    at Android.sender.Sender$SendMail.doInBackground(Sender.java:1)
08-15 17:18:13.986: W/System.err(21399):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
08-15 17:18:13.986: W/System.err(21399):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-15 17:18:13.986: W/System.err(21399):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-15 17:18:13.986: W/System.err(21399):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
08-15 17:18:13.986: W/System.err(21399):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-15 17:18:13.986: W/System.err(21399):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-15 17:18:13.986: W/System.err(21399):    at java.lang.Thread.run(Thread.java:856)
08-15 17:18:13.986: W/System.err(21399): Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.
08-15 17:18:13.986: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:398)
08-15 17:18:13.986: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.<init>(OpenSSLSocketImpl.java:647)
08-15 17:18:13.986: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.getInputStream(OpenSSLSocketImpl.java:618)
08-15 17:18:13.986: W/System.err(21399):    at com.sun.mail.smtp.SMTPTransport.initStreams(SMTPTransport.java:1449)
08-15 17:18:13.986: W/System.err(21399):    at com.sun.mail.smtp.SMTPTransport.startTLS(SMTPTransport.java:1336)
08-15 17:18:13.986: W/System.err(21399):    ... 12 more
08-15 17:18:13.986: W/System.err(21399): Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.
08-15 17:18:13.986: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:192)
08-15 17:18:13.994: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.TrustManagerImpl.checkServerTrusted(TrustManagerImpl.java:163)
08-15 17:18:13.994: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.verifyCertificateChain(OpenSSLSocketImpl.java:597)
08-15 17:18:13.994: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_do_handshake(Native Method)
08-15 17:18:13.994: W/System.err(21399):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:395)
08-15 17:18:13.994: W/System.err(21399):    ... 16 more
08-15 17:18:13.994: W/System.err(21399): Caused by: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.
08-15 17:18:13.994: W/System.err(21399):    ... 21 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:55:32.653

这似乎与您的其他线程重复：[SSLException in using JavaMail API](https://stackoverflow.com/questions/11963587/sslexception-in-using-javamail-api/11963983)，尽管在那里您似乎**确实**想使用 SSL。

如果你不想使用 SSL，为什么还要有 DummySSLSocketFactory 和 DummyTrustManager？完全摆脱它们并使用“smtp”协议，而不是“smtps”协议。而且，正如我在您的另一个线程中解释的那样，您根本不需要任何套接字工厂属性，即使您使用的是 SSL。

您没有说是否要使用 STARTTLS，即是否要使用纯文本（非 SSL）连接连接到您的邮件服务器，然后将连接切换到 SSL。如果您想这样做，请将 mail.smtp.starttls.enable 属性设置为 true。

# sql - 循环文件中的 SQL 命令

> ID：11966010
> 
> 赞同：0
> 
> 时间：2012-08-15T08:15:30.803
> 
> 标签：sql, sql-server

我有一个看起来像这样的 SQL 文件（很明显，真实的东西要长一些，而且实际上可以做一些事情:)）

```
DECLARE @Mandatory int = 0 
DECLARE @Fish int = 3 

DECLARE @InitialPriceID int
if @Mandatory= 0
    begin
    select @InitialPriceID = priceID from Fishes where FishID = @Fish
    end 
```

我有一个“强制”和“鱼”值的文件

```
 Mandatory,Fish
     1,3
     0,4
     1,4
     1,3
     1,7 
```

我需要编写一个程序，该程序将为我们的 DBO 生成一个（或多个）SQL 文件以针对数据库运行。但我不太确定如何解决这个问题......

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:22:52.920

您通常应该更喜欢基于集合的解决方案。我不知道完整的解决方案是什么样的，但从一开始你就给出了：

```
declare @Values table (Mandatory int,Fish int)
insert into @Values(Mandatory,Fish) values
(1,3),
(0,4),
(1,4),
(1,3),
(1,7),

;with Prices as (
    select
        Mandatory,
        Fish,
        CASE
            WHEN Mandatory = 0 THEN f.PriceID
            ELSE 55 /* Calculation for Mandatory = 1? */
        END as InitialPriceID
    from
        @Values v
            left join /* Or inner join? */
        Fishes f
            on
                v.Fish = f.Fish
) select * from Prices 
```

您应该旨在一次计算所有结果，而不是试图“循环”每个计算。SQL 以这种方式工作得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:25:12.947

冒着过度简化 C# 或类似内容的风险，您可以使用字符串处理方法：

```
class Program
{
    static void Main(string[] args)
    {
        var sb = new StringBuilder();

        foreach(var line in File.ReadLines(@"c:\myfile.csv"))
        {
            string[] values = line.Split(',');

            int mandatory = Int32.Parse(values[0]);
            int fish = Int32.Parse(values[1]);

            sb.AppendLine(new Foo(mandatory, fish).ToString());
        }

        File.WriteAllText("@c:\myfile.sql", sb.ToString());
    }

    private sealed class Foo
    {
        public Foo(int mandatory, int fish)
        {
            this.Mandatory = mandatory;
            this.Fish = fish;
        }

        public int Mandatory { get; private set; }
        public int Fish { get; set; }

        public override string ToString()
        {
            return String.Format(@"DECLARE @Mandatory int = {0}
DECLARE @Fish int = {1}

DECLARE @InitialPriceID int
if @Mandatory= 
begin
select @InitialPriceID = priceID from Fishes where FishID = @Fish
end
", this.Mandatory, this.Fish);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T08:25:50.437

有很多关于如何通过 t-sql 从文本文件中读取的文章，请[查看 SO 上的“打开和读取文本文件的存储过程”](https://stackoverflow.com/questions/4425001/stored-procedure-to-open-and-read-a-text-file)，如果您可以将输入文件的格式更改为 xml，那么您可以查看[SQL SERVER - 使用 T-SQL 读取 XML 文件的简单示例](http://blog.sqlauthority.com/2009/02/13/sql-server-simple-example-of-reading-xml-file-using-t-sql/)

# iphone - 如何从导航控制器中的视图控制器堆栈中获取特定的视图控制器？

> ID：11966012
> 
> 赞同：3
> 
> 时间：2012-08-15T08:15:38.140
> 
> 标签：iphone, ios, ipad

我有一个应用程序，其中我有一个表格视图。当按下单元格上的按钮时，我必须转到另一个视图控制器（即：testviewcontroller），显示我在前一个中选择的内容。然后按下一个按钮时我需要转到另一个显示剩余值的视图控制器。如果他在那里选择一个，那么我需要重复上述过程。问题是从这里我也携带一些值到那个 testviewcontroller。如果我弹回到我的视图控制器我怎么能携带新的价值观。目前我正在这样做。

```
TestViewController *test  =[[ TestViewController alloc]initWithNibName:@"TestViewController" bundle:nil];

test.itemselected=head;

test.itemid=productid;
//NSLog(@"%@",del.navigationController);

[del.navigationController pushViewController:test animated:YES]; 
```

但我知道

```
NSArray *array = [del.navigationController viewControllers]; 
```

`[array objectAtIndex:3]`是我想要的视图控制器。

谁能知道我怎样才能避免再次推送相同的视图控制器？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-15T08:31:36.957

```
for (UIViewController*vc in [self.navigationController viewControllers]) {
if ([vc isKindOfClass: [TestViewController class]]){
vc.itemselected= head ; 
[[self navigationController] popToViewController:vc animated:YES];
  }
} 
```

****编辑**** 这应该是

`for (TestViewController*vc in [self.navigationController viewControllers])`

代替

```
for (UIViewController*vc in [self.navigationController viewControllers]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:26:21.373

对于您的情况，最好弹回并用新内容重新加载表格。无需推送到新实例

使用单独的数组作为表的数据源

从数据源数组中删除所选项目

然后在弹回重新加载内容时推送到下一个视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-31T07:35:33.060

您可以在视图控制器堆栈上遍历循环。

```
-(void) viewWillDisappear:(BOOL)animated {
    if ([self.navigationController.viewControllers indexOfObject:self]==NSNotFound) {

        NSMutableArray *ViewControllerArray=[[NSMutableArray alloc]init];
        for (long i=[self.navigationController.viewControllers count]-1;i>0; i--) {

            [ViewControllerArray addObject:[self.navigationController.viewControllers objectAtIndex:i]];

            NSLog(@"%@",ViewControllerArray);
            NSLog(@"%@",self.navigationController.viewControllers);
        }

        for (UIViewController *controller in self.navigationController.viewControllers) {

            //Do not forget to import AnOldViewController.h
            if ([controller isKindOfClass:[YourViewController class]]) {

                [self.navigationController popToViewController:controller
                                                      animated:YES];
                break;
            }
        }

    }
    [super viewWillDisappear:animated];
} 
```

# c# - 如何增加 XAML 中的字体大小？

> ID：11966019
> 
> 赞同：4
> 
> 时间：2012-08-15T08:16:06.183
> 
> 标签：c#, xaml, font-size

我怎样才能增加一个字体，比方说，TextBlock？我**不想**有这样的事情：

```
<TextBlock FontSize="20">
  text
</TextBlock> 
```

因为当用户更改控件字体大小的 Windows 设置时，它将无法正常工作。我们有类似`+VALUE`（例如`+2`）的东西，类似于 HTML 吗？

**编辑**
这就是我谈论 Windows 设置的意思： ![在此处输入图像描述](../Images/e1e4bd01c3e95be3b225bc46649c23fe.png)

但我收到的答案完全让我满意。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T08:24:27.043

WPF 没有 em 字体大小，在这个[SO的答案中有替代品](https://stackoverflow.com/questions/653918/wpf-analogy-for-em-unit)

最简单的可能是

```
<ScaleTransform ScaleX="1.2" ScaleY="1.2" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-11T13:30:23.523

将 Bob Vale 的答案改编为您的原始代码

```
<TextBlock>
    <TextBlock.RenderTransform>
        <ScaleTransform ScaleX="1.2" ScaleY="1.2" />
    </TextBlock.RenderTransform>
    text
</TextBlock> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T08:29:22.463

首先，您应该为您的字体大小创建一个应用程序范围的样式，如本答案所述：[WPF global font size](https://stackoverflow.com/questions/893428/wpf-global-font-size)

然后，您可以将 fontsize 值绑定到采用控制面板中定义的大小的静态类的属性，并相应地对其进行调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-03T18:14:01.910

对于那些发现这个问题需要相对字体大小机制来实现设计目的的可怜人，例如您在 css 中使用的，我发现了一个似乎在 WPF 中工作的 hack。

它是这样使用的：

```
<StackPanel>
    <TextBlock>outer</TextBlock>
    <ContentControl local:RelativeFontSize.RelativeFontSize="2">
        <StackPanel>
            <TextBlock>inner</TextBlock>
            <ContentControl local:RelativeFontSize.RelativeFontSize="2">
                <StackPanel>
                    <TextBlock>innerest</TextBlock>
                </StackPanel>
            </ContentControl>
        </StackPanel>
    </ContentControl>
</StackPanel> 
```

这给出了这个：

[![截屏](../Images/b99d7a3fb3f116c38227428bb2dcff41.png)](https://i.stack.imgur.com/cHW8q.png)

这是代码：

```
public static class RelativeFontSize
{
    public static readonly DependencyProperty RelativeFontSizeProperty =
        DependencyProperty.RegisterAttached("RelativeFontSize", typeof(Double), typeof(RelativeFontSize), new PropertyMetadata(1.0, HandlePropertyChanged));

    public static Double GetRelativeFontSize(Control target)
        => (Double)target.GetValue(RelativeFontSizeProperty);

    public static void SetRelativeFontSize(Control target, Double value)
        => target.SetValue(RelativeFontSizeProperty, value);

    static Boolean isInTrickery = false;

    public static void HandlePropertyChanged(Object target, DependencyPropertyChangedEventArgs args)
    {
        if (isInTrickery) return;

        if (target is Control control)
        {
            isInTrickery = true;

            try
            {
                control.SetValue(Control.FontSizeProperty, DependencyProperty.UnsetValue);

                var unchangedFontSize = control.FontSize;

                var value = (Double)args.NewValue;

                control.FontSize = unchangedFontSize * value;

                control.SetValue(Control.FontSizeProperty, unchangedFontSize * value);
            }
            finally
            {
                isInTrickery = false;
            }
        }
    }
} 
```

# oracle - BEGIN - PL/SQL 中的 END 块原子事务

> ID：11966020
> 
> 赞同：62
> 
> 时间：2012-08-15T08:16:08.403
> 
> 标签：oracle, plsql

这些信息应该很容易找到，但我没有任何运气。

当我`BEGIN - END`在 PL/SQL 中有一个块时，它是否表现为一个原子事务，它将尝试在命中该`END`块时提交，如果出现任何问题，则回滚更改？

如果不是，我如何确保 BEGIN - END 块内的代码表现得像一个原子事务，以及该块如何“默认”表现？

编辑：我认为我正在从存储过程运行并且我正在使用隐式块。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-08-16T02:00:22.530

首先，`BEGIN..END`只是句法元素，与事务无关。

其次，在 Oracle 中，所有单独的 DML 语句都是原子的（即它们要么完全成功，要么在第一次失败时回滚任何中间更改）（除非您使用 EXCEPTIONS INTO 选项，我不会在这里介绍）。

如果您希望将一组语句视为单个原子事务，您可以执行以下操作：

```
BEGIN
  SAVEPOINT start_tran;
  INSERT INTO .... ; -- first DML
  UPDATE .... ; -- second DML
  BEGIN ... END; -- some other work
  UPDATE .... ; -- final DML
EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK TO start_tran;
    RAISE;
END; 
```

这样，任何异常都会导致该块中的语句回滚，但*在该块之前*运行的任何语句都不会回滚。

请注意，我不包含 COMMIT - 通常我更喜欢调用进程来发出提交。

* * *

确实，没有异常处理程序的 BEGIN..END 块会自动为您处理：

```
BEGIN
  INSERT INTO .... ; -- first DML
  UPDATE .... ; -- second DML
  BEGIN ... END; -- some other work
  UPDATE .... ; -- final DML
END; 
```

如果引发异常，所有的插入和更新都将回滚；但是只要你想添加一个异常处理程序，它就不会回滚。所以我更喜欢使用保存点的显式方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-15T18:38:25.063

`BEGIN`-`END`块是 PL/SQL 的构建块，每个 PL/SQL 单元都包含在至少一个这样的块中。嵌套——PL `BEGIN`/ `END`SQL 块中的块通常用于捕获某些异常并处理该特殊异常，然后引发不相关的异常。然而，在 PL/SQL 中，您（客户端）必须始终为事务发出提交或回滚。

如果您希望在包含事务的 PL/SQL 中具有原子事务，则需要`PRAGMA AUTONOMOUS_TRANSACTION`在声明块中声明 a。这将确保该块中的任何 DML 都可以独立于包含的事务提交或回滚。

但是，您不能为嵌套块声明此编译指示。您只能为：

*   顶级（非嵌套）匿名 PL/SQL 块
*   项目清单
*   本地、独立和打包的函数和过程
*   SQL 对象类型的方法
*   数据库触发器

参考：[甲骨文](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/autotransaction_pragma.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T08:29:26.647

你没有提到这是一个匿名的 PL/SQL 块还是一个声明性的，即。包、过程或功能。但是，在 PL/SQL 中，必须显式提交 COMMIT 以将事务保存到数据库。COMMIT 实际上将所有未保存的事务从您当前用户的*session*保存到数据库。

如果发生错误，事务会隐式执行 ROLLBACK。

这是 PL/SQL 的默认行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-29T09:19:23.213

Commit PL/SQL 块的默认行为：

> 您应该明确提交或回滚每个事务。是在 PL/SQL 程序中还是从客户端程序中发出提交或回滚取决于应用程序逻辑。如果您没有明确提交或回滚事务，客户端环境将确定其最终状态。
> 
> 例如，在 SQL *Plus 环境中，如果您的 PL/SQL 块不包含 COMMIT 或 ROLLBACK 语句，则事务的最终状态取决于您在运行该块后所做的事情。如果执行数据定义、数据控制或 COMMIT 语句，或者发出 EXIT、DISCONNECT 或 QUIT 命令，Oracle 将提交事务。如果执行 ROLLBACK 语句或中止 SQL* Plus 会话，Oracle 会回滚事务。

[https://docs.oracle.com/cd/B19306_01/appdev.102/b14261/sqloperations.htm#i7105](https://docs.oracle.com/cd/B19306_01/appdev.102/b14261/sqloperations.htm#i7105)

# android - 为智能手机编写 wifi 设备驱动程序

> ID：11966022
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:16:12.563
> 
> 标签：android, iphone, linux, wifi, android-wifi

1.  我是否需要为每个在 Android 上运行的智能手机编写单独的 dd ？
2.  我需要为 iPhone 4s 和 iPhone 4 编写单独的 dd 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:20:08.083

我不应该这么认为——它们都很标准——只需对 3 部不同的手机进行一些 QA。我知道三星有一个独特的蓝牙驱动程序，但我没有看到任何设备的 wifi 有区别。

[三星 Galaxy 蓝牙驱动程序](https://stackoverflow.com/questions/9596978/samsung-galaxy-bluetooth-drivers)

您的设备没有连接到您的计算机吗？如果您的设备有wifi但无法连接到您的计算机，您应该只需要编写驱动程序，在这种情况下您应该先在线搜索它们。

# facebook - 无法获取 fb 用户信息

> ID：11966027
> 
> 赞同：0
> 
> 时间：2012-08-15T08:16:54.220
> 
> 标签：facebook, facebook-graph-api

我开始使用 Fb 应用程序开发。我尝试部署 facebook php api 中给出的示例应用程序，但似乎无法正常工作

这是代码： -

```
<?php

require '../src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => '**************',
  'secret' => '**************************',
));

// Get User ID
$user = $facebook->getUser();

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// Login or logout url will be needed depending on current user state.
if ($user) {

  $logoutUrl = $facebook->getLogoutUrl();
} else {

  $loginUrl = $facebook->getLoginUrl();
}

$naitik = $facebook->api('/naitik');

?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <title>php-sdk</title>
    <style>
      body {
        font-family: 'Lucida Grande', Verdana, Arial, sans-serif;
      }
      h1 a {
        text-decoration: none;
        color: #3b5998;
      }
      h1 a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>php-sdk</h1>

    <?php if ($user): ?>
      <a href="<?php echo $logoutUrl; ?>">Logout</a>
    <?php else: ?>
      <div>
        Login using OAuth 2.0 handled by the PHP SDK:
        <a href="<?php echo $loginUrl; ?>">Login with Facebook</a>
      </div>
    <?php endif ?>

    <h3>PHP Session</h3>
    <pre><?php print_r($_SESSION); ?></pre>

    <?php if ($user): ?>
      <h3>You</h3>
      <img src="https://graph.facebook.com/<?php echo $user; ?>/picture">

      <h3>Your User Object (/me)</h3>
      <pre><?php print_r($user_profile); ?></pre>
    <?php else: ?>
      <strong><em>You are not Connected.</em></strong>
    <?php endif ?>

    <h3>Public profile of Naitik</h3>
    <img src="https://graph.facebook.com/aitik/picture">
    <?php echo $naitik['name'];
    ?>
  </body>
</html> 
```

但是 $user 始终为空，并且显示“您未连接”。是因为我使用的是免费的虚拟主机并且没有任何安全 URL？

我的应用程序的网址，如果您想查看：[http ://apps.facebook.com/iiiimags](http://apps.facebook.com/iiiimags)

# c - 如何以编程方式访问 C 中的 bash 命令历史记录？

> ID：11966030
> 
> 赞同：5
> 
> 时间：2012-08-15T08:17:08.140
> 
> 标签：c, bash

我讨厌 bash 'history' 命令。它永远找不到我想要的历史项目。有时我可以通过“历史 | 得到我想要的”。grep XXX' 但通常要么历史太长（400+ 点击！耶）要么太短（没有点击。嘘）。

我心想，我为什么不写一个小“历史助手”命令，让我基本上“加星”特定的历史项目，并让它们*总是*出现在我的历史中，有一个全局星表和一个 cwd 特定星表。

听起来很神奇。所以我天真地试图通过这样做来阅读历史：

```
system("history > blah")
FILE *fp = fopen("blah", "r") 
```

哦，那没用。啊，我明白了，system() 命令在它自己的上下文中运行，并且无法访问 bash 历史记录。德拉斯。好的，所以我会尝试阅读**~/.bash_history**

咩咩~不。只有在最后一次调用 a) history -w 或 b) 调用退出 shell 之前，历史记录才会出现。

所以，问题：**如何以编程方式访问 C 中的当前 bash 历史记录？**

（注意。不，*不是*~/.bash_history 中的内容，*当前*历史记录，当您从提示中键入“历史记录”时看到的确切输出；另外，为什么要问 C？为什么不...但真的，因为我已经有一个方便的 ncurses 包装器，我将使用它来让我在普通终端上进行花哨的自动完成和子选择历史搜索......）

编辑：拜托，如果你有一些有用的东西可以贡献，我很高兴听到它，但我有点厌烦诸如“你应该阅读 bash 历史手册页”之类的评论。

我读过它们。没有*什么*可以让我为历史项目“加注星标”并让它始终出现在我的历史中，也**没有什么**可以让我维护每个目录的历史上下文。这些都是历史所不支持的。我很欣赏这个。这就是为什么我想为我的特定目的编写一个辅助函数。如果您有类似“也许您应该多阅读历史手册页”之类的评论，请忍住，不要回复；它并没有真正解决我的问题。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:33:03.400

**简短的回答**

您可以在内置的`history`源代码中找到答案。`bash`

**长答案**

看起来你只需要阅读`help history`一段`man bash`时间。

您的历史文件不断用 shell 重写（取决于您的设置。默认情况下，它是在注销/退出时刻完成的）。你需要破解 shell 来添加特定的规则来做到这一点。但是你离这个水平还很远。

只是因为如果你非常接近它，你没有问如何使用 .bash_history from `c`=)

然而，还有另一种改进历史记录的方法：增加历史记录大小，限制重复阅读，并使所有命令在执行后立即进入历史记录。为此，您需要放入`.bashrc`以下变量：

```
PROMPT_COMMAND='history -a;history -n'

export HISTCONTROL=ignoredups
export HISTTIMEFORMAT='%F %T '
export HISTSIZE=100500

shopt -s histappend
shopt -s cmdhist 
```

您还可以使用以下命令阻止特定命令的录制

```
export HISTIGNORE="unwanted_command:unwanted_mask*" 
```

希望它会帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T04:41:53.787

**工作目录特定历史**

```
function cd {
    builtin cd "$@"
    if [ -f .cwdhist ]; then
        history -r .cwdhist
    fi
} 
```

**已加星标的历史命令**

基本原理是结合一些shell函数逻辑来围绕你的history helper程序写和读history。

```
function histedit {
    history -a
    historyhelper $HOME/.bash_history $HOME/.histout
    history -c
    history -r $HOME/.histout
} 
```

该`history -a`命令将所有最近的历史记录附加到历史记录文件中。然后该函数调用您的历史帮助程序。你可以在这个程序中加入你想要的任何智能，确保你最喜欢的命令在历史记录中，如果它们不是，则添加它们，然后将其输出保留在`.histout`（或其他）中。然后函数继续，清除并重新加载历史。也许它应该避免清除历史记录。或者，如果 historyhelper 返回非零退出状态，函数应该中止。你可以在这里做的各种事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T10:42:16.583

你能得到的最接近的是

```
alias cmd="history | cmd" 
```

并从应用程序中读取标准输入。

# jquery-ui - 带有 Slim 框架的 jqueryUI 自动完成功能

> ID：11966035
> 
> 赞同：0
> 
> 时间：2012-08-15T08:17:51.283
> 
> 标签：jquery-ui, mod-rewrite, autocomplete, slim

我从 php、jquery 和 Slim PHP 框架开始，我一直在为 jqeryUI 自动完成请求制作 Slim 处理程序（路由）。

1.  jqeryui 自动完成将数据作为`term`GET 参数发送，即`restapi.php/test/?term=hello`
2.  使用 Slim，我可以处理诸如`restapi.php/test/hello`等之类的请求。

怎么解决？我自己考虑过的解决方案是用 mod-rewrite 重写 URL（无论如何基本上都将它与 Slim 一起使用），但我不确定这是否是正确的方法。

我会很高兴收到您的修改和建议，如果重写是最好的方法，一些带有示例的参考资料将对我有所帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:55:04.287

实际上，您可能不应该`/*`用来做您正在做的事情。SLIM 提供了一个可以获取你请求的参数的方法。

```
$dataIn = $app->request()->params(); 
```

这将为您提供一组请求参数。因此，如果您的 get 请求是这样的：

```
restapi.php/test/?term=hello&page=1&limit=15

$dataIn = $app->request()->params();

// $dataIn['term'] = 'hello'
// $dataIn['page'] = 1
// $dataIn['term'] = 15 
```

此外，您可以通过将 arg 放入`param()`方法中来获取特定参数。

```
$term = $app->request()->params('term'); 
```

区分路由参数和请求参数会让生活变得更轻松。;-)

# winforms - 如何设置富文本框控件的滚动位置？

> ID：11966037
> 
> 赞同：3
> 
> 时间：2012-08-15T08:18:00.303
> 
> 标签：winforms, position, scrollbar, richtextbox

我在 winforms 4（customRTB1 和 customRTB2）上使用 2 个富文本框。两个 rtb 都有相同的文本。我想要实现的是，当一个 rtb (customRTB1) 向下滚动时，另一个 rtb (customRTB2) 也应该滚动到与 customRTB1 完全相同的位置。我试过这个：

```
public class CustomRTB : RichTextBox
    {
        #region API Stuff
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        public static extern int GetScrollPos(IntPtr hWnd, int nBar);

        [DllImport("user32.dll")]
        public static extern int SetScrollPos(IntPtr hWnd, int nBar, int nPos, bool bRedraw);

        private const int SB_HORZ = 0x0;
        private const int SB_VERT = 0x1;
        #endregion
        public int HorizontalPosition
        {
            get { return GetScrollPos((IntPtr)this.Handle, SB_HORZ); }
            set { SetScrollPos((IntPtr)this.Handle, SB_HORZ, value, true); }
        }

        public int VerticalPosition
        {
            get { return GetScrollPos((IntPtr)this.Handle, SB_VERT); }
            set { SetScrollPos((IntPtr)this.Handle, SB_VERT, value, true); }
        }
    } 
```

使用 Horizo​​ntalPosition 和 VerticalPosition 我可以移动 SECOND rtb 的滚动条，如下所示：

```
private void customRTB1_VScroll(object sender, EventArgs e)
{
          customRTB2.VerticalPosition = customRTB1.VerticalPosition;
} 
```

这会将第二个 rtb 的滚动条移动到第一个 rtb 的位置，但是，它根本不会移动文本！那么如何让第二个rtb根据滚动条的位置显示对应的文字呢？主要是，我希望第一个 rtb 发生的每个活动（编辑、滚动等）在第二个 rtb 上重复。我知道我非常接近解决方案。请帮忙。

# android - 需要基本设计

> ID：11966041
> 
> 赞同：0
> 
> 时间：2012-08-15T08:18:14.600
> 
> 标签：android, android-fragments, android-activity, android-tabs

我的目标是 android 2.1 上的应用程序。我有一个包含三个部分的布局。页眉、主体和页脚。页脚在整个应用程序生命周期中保持不变。页脚有四个选项供用户选择（如四个选项卡）。当用户选择页脚中的每个选项时，主体中的内容必须更改。并且当用户在主体中与 UI 交互时，只需要更改主体的内容（如活动替换活动）。并且页脚中的用户选择必须保持突出显示，直到用户在页脚中选择另一个选项。我几乎需要在同一个选项卡中启动活动，但选项卡位于下方。很多人建议使用活动组，但由于它已被弃用，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:25:43.810

如果您想获得 2.1 和更高版本等较低版本的支持，我可以提出我的建议。我总是为托盘使用单独的 XML 布局（在您的情况下为页脚），例如（**res/layout/tray.xml**）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainMenu"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom"
    android:background="#EEEEEE"
    android:gravity="bottom|fill_horizontal"
    android:orientation="horizontal"
    android:padding="5dp" >

    <ImageView
        android:id="@+id/addBtn"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:src="@drawable/add" android:layout_weight="0.2"/>

    <ImageView
        android:id="@+id/catalogBtn"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:src="@drawable/catalog" android:layout_weight="0.2"/>

    <ImageView
        android:id="@+id/searchBtn"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:src="@drawable/search" android:layout_weight="0.2"/>

    <ImageView
        android:id="@+id/settingsBtn"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:src="@drawable/settings" android:layout_weight="0.2"/>

    <ImageView
        android:id="@+id/infoBtn"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:src="@drawable/info" android:layout_weight="0.2"/>

</LinearLayout> 
```

并将其包含在我需要的每个**活动中：**

```
<include layout="@layout/tray" android:id="@+id/tray" /> 
```

之后，我可以在java代码中按ID隐藏/显示托盘中的一些按钮，或者用另一种颜色选择其中一些按钮......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:43:57.290

另一种可能的方法是使用[片段](http://developer.android.com/guide/components/fragments.html)而不是每个内容页面的完整活动。片段很像活动，只是它们需要嵌入到要显示的活动中，并且它们使您可以自由更改活动一部分的内容（即，将一个片段交换为另一个片段），这意味着您可以让活动的另一部分保持不变 - 例如用于在这些片段之间切换的选项卡。一个不错的好处是在另一个活动中重用该内容页面非常容易，如果您选择创建一个适合平板电脑的版本，您可以轻松地为现有片段构建更复杂的视图。

将[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)与某种类型的页面指示器一起使用，例如[此处的选项卡指示器，](http://viewpagerindicator.com/)您可以拥有一个活动片段并轻松地在它们之间切换。

由于您的目标是 2.1，因此您需要使用 android[支持库](http://developer.android.com/tools/extras/support-library.html)来支持片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:26:56.487

要在所有活动中显示页脚菜单，您可以创建自定义布局 - 页脚的布局 - 并将其包含在每个活动中，或者更具体地说，将其包含在每个活动的布局中`<include />`

此外，您的所有活动都应该有一个父活动，让它成为`BaseActivity`，您将在其中为您的页脚菜单提供适当的操作。

然后，您只需要继承 BaseActivity 并将页脚菜单布局包含到您当前的布局中，即可使该菜单可用于您想要的任何 Activity。

# c++ - 你能从一个大小和它的内容生成一个可变参数模板包吗？

> ID：11966044
> 
> 赞同：9
> 
> 时间：2012-08-15T08:18:42.520
> 
> 标签：c++, templates, c++11, variadic-templates

考虑以下代码：

```
template<unsigned int... TSIZE>
struct Base {};
template<unsigned int TORDER, unsigned int TDIM>
struct Derived : public Base</* TDIM, TDIM, ... TDIM (TORDER times) */> {}; 
```

您认为在本例的第二行中正确生成 Base 的模板参数是否存在技巧？例如我想`Derived<3, 5>`继承自`Base<5, 5, 5>`. 怎么做 ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T08:41:43.857

有了一点 TMP，这毕竟不是那么难：

```
template<unsigned ToGo, class T, T Arg, template<T...> class Target, T... Args>
struct generate_pack
  : generate_pack<ToGo-1, T, Arg, Target, Args..., Arg>
{ // build up the 'Args' pack by appending 'Arg' ...
};

template<class T, T Arg, template<T...> class Target, T... Args>
struct generate_pack<0, T, Arg, Target, Args...>
{ // until there are no more appends to do
  using type = Target<Args...>;
};

template<unsigned Num, class T, T Arg, template<T...> class Target>
using GeneratePack = typename generate_pack<Num, T, Arg, Target>::type;

template<unsigned int... TSIZE>
struct Base{};

template<unsigned int TORDER, unsigned int TDIM> 
struct Derived
  : GeneratePack<TORDER, unsigned, TDIM, Base>
{
}; 
```

[活生生的例子。](http://liveworkspace.org/code/b245da9840eb4e81eb8e8a033ce7afe4)

# c++ - 即时初始化字符数组

> ID：11966049
> 
> 赞同：0
> 
> 时间：2012-08-15T08:19:13.897
> 
> 标签：c++, c, arrays, multidimensional-array

我想使用指针即时初始化一个字符数组。即用户输入不知道数组的大小。用户一直提供输入，直到按下返回。这里的条件是：

*   使用指针初始化
*   不要提前传递数组的大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T08:24:21.063

假设一个 C 问题，如何（未经测试）：

```
char *arr = malloc(10);
size_t size = 10, index = 0;
int ch;
while ((ch = getc(stdin)) != EOF && ch != '\n' && ch != '\r') {
    if (index >= size) {
        size *= 2;
        arr = realloc(arr, size); /* XXX check it first. */
    }
    arr[index++] = ch;
}
arr[index] = 0; 
```

如果它真的是一个 C++ 问题，你想要[`std::getline`](http://en.cppreference.com/w/cpp/string/basic_string/getline)一个[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:25:23.263

std::string 有一个方法`push_back`std::vector 也可以完成这项工作。尽管如此，如果您真的被迫使用动态数组和字符指针，我建议您实施类似于向量中使用的重新分配策略 - 每次元素数量大于当前大小时，大小加倍。

# mysql - 通过 SQL 显示有限的随机行

> ID：11966050
> 
> 赞同：1
> 
> 时间：2012-08-15T08:19:15.050
> 
> 标签：mysql

我正在使用 select 命令从 sql 表中选择值。它从表中返回 10 个值。但我想*随机*显示 3 个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:20:24.740

```
select * from your_table
order by rand()
limit 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:34:02.083

简单地说，你可以对小桌子这样做：

```
SELECT * FROM yourTable
ORDER BY RAND()
LIMIT 3; 
```

但是如果你有大表，那么你可以选择使用`fragmentation`结果集......假设，你的表包含 200K 行，你只需要随机选择 100 行，那么你可以计算结果集的片段......片段给定表的结果集将是 0.0005，以后可以像这样使用：

```
SELECT * FROM yourTable WHERE RAND()<=0.0005 
```

要获得准确的 100 行，您可以稍微增加片段，并且可以像这样使用：

```
 SELECT * FROM yourTable WHERE RAND()<=0.0006 LIMIT 100; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:19:54.967

尝试这个：

```
SELECT * 
FROM tableName
ORDER BY RAND()
LIMIT 3 
```

但请注意，**[根据这篇文章](http://jan.kneschke.de/projects/mysql/order-by-rand/)**， 使用**ORDER BY RAND()**已经落后于表中只有 100 行的优化查询。`ORDER BY RAND()`

**[本文](http://jan.kneschke.de/projects/mysql/order-by-rand/)**展示了基于性能生成随机记录的不同技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:21:04.533

在大桌子上不是一个好主意：

```
select * from mytable order by rand() limit 3 
```

# jquery - jQuery：CSS函数在动画函数后没有触发

> ID：11966051
> 
> 赞同：0
> 
> 时间：2012-08-15T08:19:25.463
> 
> 标签：jquery

请有人解释为什么以下不起作用。这发生在同一个点击事件上，但 CSS 函数不是紧随其后，所以如果可能的话，我不想在动画函数上使用回调。

**注意：动画会触发，但 CSS 不会。**

```
 container.animate({
                left : (posLeft + slideWidth),
            });

                container.css({
                left : '-'+(itemsLength + startX)+'px',
            }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:29:29.000

`.animate`不是同步的，也就是说，绝对不能保证在（视觉上）完成`.css`之后调用。`.animate`因此，在您的情况下， after`.animate`被调用，`.css`立即被调用，但该`left`位置很快被`.animate`内部调用覆盖`setInterval`。

根据[文档](http://api.jquery.com/animate/)，第二个参数可以是定义选项的对象，其中一个是`complete`

> 如果提供，则在动画完成后触发**完整的回调**函数。这对于将不同的动画按顺序串在一起很有用。回调没有发送任何参数，但它被设置为动画的 DOM 元素。如果为多个元素设置了动画，则每个匹配的元素都会执行一次回调，而不是对整个动画执行一次。

```
container.animate({
   left : (posLeft + slideWidth),
}, {
   complete: function() {
      $(this).css({ // as per doc, this is the DOM element being animated
         left : '-'+(itemsLength + startX)+'px',
      }); 
   })
}); 
```

# namespaces - 如何避免 BDD（生菜）中的名称冲突

> ID：11966052
> 
> 赞同：1
> 
> 时间：2012-08-15T08:19:27.167
> 
> 标签：namespaces, bdd, lettuce

我正在用生菜在 Django 中学习 BDD，同时我想到不同场景中的两个步骤碰巧具有相同名称的情况，例如，

```
Feature: a feature A
    Scenario: a scenario S1
        Given this is the conflicted step
        Then chect the result of scenario S1

Feature: a feature B
    Scenario: a scenario S2
        Given this is the conflicted step
        Then chect the result of scenario S2 
```

上述步骤***this是冲突的步骤***，碰巧在多个不同含义的场景中定义。然后将针对此步骤的所有出现执行此步骤的以下测试代码。

```
@step(r'this is the conflicted step')
def mytest(step):
    # do test 
```

我的问题是，是否有一种命名空间机制允许我们为具有相同名称但在不同场景中的步骤创建不同的测试代码？例如，我期望以下测试代码或类似的东西：

```
@step(r'a feature A', r'this is the conflicted step')
def aaaa(step):
    # do test

@step(r'a feature B', r'this is the conflicted step')
def bbbb(step):
    # do other test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:34:55.567

我对生菜不熟悉，但在 Cucumber 中你有 a 的概念[`Background`](https://www.relishapp.com/cucumber/cucumber/docs/background)。

使用 a `Background`，您可以为所有场景定义一个共享的“给定”步骤，然后您可以删除冲突的步骤。

如果这不是您需要的，那么您将不得不更改步骤的文本，以更具体地说明它们的作用，以消除冲突。

# objective-c - 视频数据为空

> ID：11966056
> 
> 赞同：0
> 
> 时间：2012-08-15T08:19:50.067
> 
> 标签：objective-c, xcode

我正在尝试找到一种从 UIImagePickerController 上传视频的方法。下面的代码，它返回 0 长度的视频数据，但我肯定视频路径是正确的，因为它返回类似

/private/var/mobile/Applications/22318D96-B5B5-4C92-A8EB-869311275E40/tmp//trim.‌​AE6xnl.MOV

```
NSString *videoPath = [[info objectForKey:UIImagePickerControllerMediaURL] path];
NSData *videoData = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:videoPath ofType:@"mov"]];
int videoSize = [videoData length];
NSLog(@"Video path: %d", moviePath);
NSLog(@"Video size: %d", videoSize); 
```

知道为**pathForResource**放置的正确参数是什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:38:22.763

做这个：

```
NSURL* movieUrl = [info valueForKey:UIImagePickerControllerMediaURL];
NSData *videoData = [NSData dataWithContentsOfURL:movieUrl];
if(videoData)
{
   int videoSize = [videoData length];
  NSLog(@"Video path: %d", movieUrl);
  NSLog(@"Video size: %d", videoSize);
} 
```

# java - 如果不支持 isTranslucencyCapable 怎么办

> ID：11966058
> 
> 赞同：0
> 
> 时间：2012-08-15T08:20:02.407
> 
> 标签：java, swing

在我们的 Centos 6.0 盒子上，我试图有一个半透明的窗口，上面有一个简单的消息。想法是停止用户输入任何数据，而我的程序连接到的程序已停止。但是，当我使用 OpenJdk 6 尝试它时，AWTUtilities 代码失败并出现异常。如果我尝试在此条目[Java 透明窗口](https://stackoverflow.com/questions/11844927/java-transparent-window)中作为示例提供的代码，我得到的只是一个带有弯曲角面板的紫色窗口，它不是半透明的。任何想法我将如何实现这种效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T10:30:18.900

你能做的不多。如果屏幕上已经有 JFrame/JDialog，则可以改用玻璃窗[格](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)

# opencv - OpenCV：突然光线变化下的背景减法

> ID：11966069
> 
> 赞同：5
> 
> 时间：2012-08-15T08:21:02.677
> 
> 标签：opencv, background, background-image, image-segmentation

我正在研究突然的光线变化下的背景减法。在 OpenCV 或 IPP 中是否有任何示例代码或方法可以有效地做到这一点？我正在阅读视频帧，所以运行时间应该非常快。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T21:26:01.320

您需要首先设计某种归一化技术，其中两个帧（一个具有低光照和另一个具有大量光照）都将被归一化并且应该包含非常接近的值。

不幸的是，我遇到了同样的问题，我无法完全解决它，但解决这个问题的一种方法是执行[直方图均衡](http://opencv.itseez.com/doc/tutorials/imgproc/histograms/histogram_equalization/histogram_equalization.html?highlight=histogram%20normalization)。

完成均衡后，您可以继续使用简单的背景减法技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-07T07:09:45.900

我知道这已经很老了。但我遇到了几乎同样的问题。我所做的是降低所有图像（帧）的 RGB 分量的强度。对于我在街上检测汽车的情况，几乎可以消除阳光引起的突然照明变化。然后将修改后的 RGB 帧提供给背景减法，例如 BackgroundSubtractorMOG2。

这是代码。变量 bitshift 需要根据条件调整为 2 或 4。

```
void makeIlluminationInvariantRGB(const cv::Mat& frame, cv::Mat& result) {
    frame.copyTo(result);
    uint8_t* pixelPtr = (uint8_t*)result.data;
    int cn = result.channels();
    int bitshift = 3;

    for(int row = 0; row < result.rows; row++)
    {
        for(int col = 0; col < result.cols; col++)
        {
            pixelPtr[row*result.cols*cn + col*cn + 0] = pixelPtr[row*result.cols*cn + col*cn + 0] >> bitshift;

            pixelPtr[row*result.cols*cn + col*cn + 1] = pixelPtr[row*result.cols*cn + col*cn + 1] >> bitshift;

            pixelPtr[row*result.cols*cn + col*cn + 2] = pixelPtr[row*result.cols*cn + col*cn + 2] >> bitshift;
        }
    }
} 
```

希望它可以帮助别人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-09T05:07:28.853

我解决这个问题的方法是对减法模型使用 meanStdDev 公式。如果偏差真的很大，我触发了背景模型的重置。

# php - php - 替换出现的字符串

> ID：11966078
> 
> 赞同：13
> 
> 时间：2012-08-15T08:21:29.027
> 
> 标签：php, string

我有一个字符串`"First line | second line | third line"` 如何`|`用 `new line`字符替换？

我正在尝试使用`preg_replace`但没有 liuck

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-15T08:23:42.123

这里是

```
str_replace('|',"\n",$string); 
```

当 \n 放置在双引号字符串中时，它会更改为新行

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-02-08T18:45:01.577

用这个：

```
str_replace('|', PHP_EOL, $str); 
```

您应该使用`PHP_EOL`，而不是`"\n"`因为 PHP_EOL 将始终在所有服务器平台上工作。（注意。Windows 使用`"\r\n"`和 unix/linux 使用`"\n"`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T08:25:07.380

使用`strtr`比`str_replace`or快一点`preg_replace`。

```
echo strtr($string,'|', "\n"); 
```

注意周围的双引号`\n`。

另外，如果你想输出 HTML，换行符是不够的，你需要用`<br />`标签替换它。

```
echo str_replace("|", "<br />\n", $string); 
```

# javascript - 如何在没有 Xcode 的情况下手动安装 Phonegap 库？

> ID：11966080
> 
> 赞同：1
> 
> 时间：2012-08-15T08:21:59.540
> 
> 标签：javascript, iphone, ios, xcode, cordova

我是否需要安装 Phonegap 库，或者将它们复制到应用脚本所在的位置就足够了？

我正在 Windows 上使用 Dreamweaver 开发 javascript、html、jquery、css php 等应用程序。我想使用 cordova-2.0.0，它是 Phonegap 的最后一个版本，用于从相册上传图片或捕获它们。我已经从[http://docs.phonegap.com/en/2.0.0/cordova_camera_camera.md.html#Camera 获取](http://docs.phonegap.com/en/2.0.0/cordova_camera_camera.md.html#Camera)了完整的例子这个代码需要 src="cordova-2.0.0.js" 问题是我做的不知道我是否应该安装 Phonegap 或将其库复制到示例脚本可以看到它们的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:27:00.497

您将 PhoneGap 库复制到合适的位置，然后将文件导入应用程序项目。[PhoneGap 主页](http://phonegap.com/)提供了有关如何执行此操作的详细信息。

由于您不想使用 Xcode，我假设这是因为您使用的是 Windows。您是否看过有关创建 Phonegap iOS 应用程序的指南？

[在没有 Mac 的情况下设置构建 iOS 应用程序的详细指南](http://community.phonegap.com/nitobi/topics/detailed_guide_for_setting_up_building_ios_apps_without_a_mac)

**编辑：**如果您正在尝试创建一个可从 Safari 访问的网络应用程序，并且您正在尝试上传照片，那么您可能应该阅读[这个问题](https://stackoverflow.com/questions/3891831/a-html5-web-app-for-mobile-safari-to-upload-images-from-the-photos-app)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:27:18.823

我没有在没有 xcode 的情况下完成它，所以可能不是最好的答案，但是您可以尝试 IBM Worklight，它是一个基于 Eclipse 的具有 PhoneGap 的 IDE，或者可以看看像 Sencha Touch 这样的东西，它也具有 HTML5 中的本机开发功能。

# javascript - Javascript / jQuery：在 contentWindow.print 之后删除 iframe

> ID：11966084
> 
> 赞同：2
> 
> 时间：2012-08-15T08:22:43.270
> 
> 标签：javascript, jquery, iframe, printing

我正在使用这个代码，它源于[这里](https://stackoverflow.com/questions/5220249/print-from-frontend-javascript)和[这里](https://stackoverflow.com/questions/4689145/pass-jquery-variables-between-iframe-and-parent/4689154#4689154)。

```
$('#my_button').on('click', function (e) {
    var iframe = document.createElement('iframe');
    iframe.id = "my_iframe";
    iframe.onload = function() {
        var doc = iframe.contentDocument || iframe.contentWindow.document;
        doc.getElementsByTagName('body')[0].innerHTML = "<p>test123</p>";

        iframe.contentWindow.focus(); 
        iframe.contentWindow.print();

        $("#my_iframe", top.document).remove();
    };

    document.getElementsByTagName('body')[0].appendChild(iframe);
}); 
```

没有这`remove`条线，它打印得很好。但是，该`remove`行在`iframe`有机会执行`print()`. 如何设置某种回调以便它打印然后才删除 iframe？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:38:47.583

我在搜索打印事件检测时找到了这个解决方案：

[http://tjvantoll.com/2012/06/15/detecting-print-requests-with-javascript/](http://tjvantoll.com/2012/06/15/detecting-print-requests-with-javascript/)

在这里，我按照 Stano 的要求添加了 JS 代码，但重要的是还要阅读整个链接的帖子，因为这种方法存在局限性。一般来说，这篇文章是关于仅在 IE 中有效的 onafterprint 事件以及使该事件在其他浏览器中有效的解决方案。

```
(function() {
    var beforePrint = function() {
        console.log('Functionality to run before printing.');
    };
    var afterPrint = function() {
        console.log('Functionality to run after printing');
    };

    if (window.matchMedia) {
        var mediaQueryList = window.matchMedia('print');
        mediaQueryList.addListener(function(mql) {
            if (mql.matches) {
                beforePrint();
            } else {
                afterPrint();
            }
        });
    }

    window.onbeforeprint = beforePrint;
    window.onafterprint = afterPrint;
}()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T08:43:08.770

创建一个这样的函数：

```
function printIframe(iframe,callback) {
  iframe.contentWindow.print();
  if (callback && typeof(callback) === "function") {
    // execute the callback, passing parameters as necessary
    callback();
  }
} 
```

并调用它而不是像这样的其他两个函数。printIframe(iframe,function(){ $("#my_iframe", top.document).remove();})

如果你愿意，你也可以使用 setTimeout 来延迟。

```
setTimeout(function() {alert('hello');},1250); 
```

# php - Yii 项目单元测试：验证器

> ID：11966090
> 
> 赞同：0
> 
> 时间：2012-08-15T08:23:17.177
> 
> 标签：php, unit-testing, yii

我们的项目已经变得太大而无法手动测试，因此我们开始使用单元测试来覆盖它。现在我们面临着测试模型验证过程的困境。

一方面，验证是模型逻辑的一部分，因此需要对其进行测试，因此我们开始进行繁琐的测试，如下所示：

```
public function testNameRequired()
{
    $this->object->name = '';
    $this->assertFalse($this->object->validate(array('name')));

    $this->object->name = 'Franky';
    $this->assertTrue($this->object->validate(array('name')));
} 
```

但另一方面，验证器（我的意思是内置）是框架的一部分并且已经过测试，所以我们基本上是在测试静态`rules`数组（跟踪意外代码修改是 VCS 的任务）。

我们也在考虑创建某种可重用的验证器测试，它会接受`rules`数组，解析它并运行上面的测试，但它只是重写框架测试。

所以问题是：

您是否在代码中测试验证？如果你这样做，那怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T08:28:43.057

我认为您忽略了测试的想法：您不一定要测试验证代码是否有效，而是您的验证**逻辑**是否有效。

我建议您仍然进行所有测试，原因有两个：

*   万一你忘记验证某事，你可能会记得验证它并发现你的错误在哪里。
*   测试还有另一个目的：允许轻松[重构](http://en.wikipedia.org/wiki/Code_refactoring)。可能是您或其他最终使用您的代码的程序员将决定对其进行编辑。如果测试已经到位，则很容易确保新版本可以正常工作。也不要假设 Yii 的开发人员不会犯错误 ;) 他们也只是人类——这取决于你对他人的信任程度。

如果您决定测试您的验证，我不会依赖使用`rules()`'s 的输出 - 这应该是您正在测试的事情之一。

# java - 从编译的类文件中显示泛型类型参数

> ID：11966091
> 
> 赞同：2
> 
> 时间：2012-08-15T08:23:17.207
> 
> 标签：java, generics, javap

是否有类似于*javap*的工具可以显示具有原始（非擦除）类型的方法和字段？

我知道编译源代码时会[删除类型信息。](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)但是，编译器必须以某种方式知道，因为即使库已经编译到类文件中，它也能够确定我对库方法的调用是否匹配它们的签名。所以至少在理论上，应该可以检索到类型信息。

我进一步搜索并找到了这个答案： [Java 类文件中存储的泛型类型在哪里？](https://stackoverflow.com/questions/937933/where-are-generic-types-stored-in-java-class-files) 这向我指出了[getGeneric...()](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#getGenericReturnType())方法。所以在我看来，类型信息以某种复杂的方式存储在类文件中，这些方法允许获取它。但是到目前为止，我还没有找到可以显示此信息的（命令行）工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:56:03.423

您使用的是旧版本的`javap`.

```
$ javap -version
1.7.0

$ javap java.util.List
Compiled from "List.java"
public interface java.util.List<E> extends java.util.Collection<E> {
  public abstract int size();
  public abstract boolean isEmpty();
  public abstract boolean contains(java.lang.Object);
  public abstract java.util.Iterator<E> iterator();
  public abstract java.lang.Object[] toArray();
  public abstract <T extends java/lang/Object> T[] toArray(T[]);
  public abstract boolean add(E);
  public abstract boolean remove(java.lang.Object);
  public abstract boolean containsAll(java.util.Collection<?>);
  public abstract boolean addAll(java.util.Collection<? extends E>);
  public abstract boolean addAll(int, java.util.Collection<? extends E>);
  public abstract boolean removeAll(java.util.Collection<?>);
  public abstract boolean retainAll(java.util.Collection<?>);
  public abstract void clear();
  public abstract boolean equals(java.lang.Object);
  public abstract int hashCode();
  public abstract E get(int);
  public abstract E set(int, E);
  public abstract void add(int, E);
  public abstract E remove(int);
  public abstract int indexOf(java.lang.Object);
  public abstract int lastIndexOf(java.lang.Object);
  public abstract java.util.ListIterator<E> listIterator();
  public abstract java.util.ListIterator<E> listIterator(int);
  public abstract java.util.List<E> subList(int, int);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:31:42.147

在 a 中查看的一个非常好的工具`.class`是[JClasslib](http://www.ej-technologies.com/products/jclasslib/overview.html)。这是一个比`javap`. 示例截图：

![在此处输入图像描述](../Images/98ac081edc8171333c9ce575f25ae23e.png)

您可以使用它来查看`.class`文件中的所有字段、所有方法、字节码以及所有内容。它还可以打开 JAR 文件。

您可以查看“属性”部分 -> 签名。您可以在那里找到此类信息。

例如：对于以下类定义：

```
public class BlaType<T extends Integer> 
```

我可以看到这样的东西：

![在此处输入图像描述](../Images/f95ca23f9a212729c4851c5f636127a9.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T08:33:18.627

诸如[http://java.decompiler.free.fr/](http://java.decompiler.free.fr/)之类的反编译器将为您提供原始源代码的近似值，包括通用签名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:26:55.660

您可以尝试一下`Method.toGenericString()`，似乎您可以在运行时从类中获得一切。此方法应打印具有通用边界的方法签名。

# .net - 如何处理实体框架消息

> ID：11966096
> 
> 赞同：0
> 
> 时间：2012-08-15T08:23:30.130
> 
> 标签：.net, entity-framework

我有一个与 EF4.3 一起使用的规范化数据库。

在这种情况下，我有一个用户（每个人都是用户）。有些是订阅者，订阅者是贡献者、成员或管理员。

因此，对于每种类型的用户，我都会通过导航属性包含适当的关联。

所以成员 linq 语句将是这样的：

```
 var u = r.FindBy(x => x.UserId == userId)
                .Include("Subscribers")
                .Include("Members")
                .SingleOrDefault(); 
```

就对象而言，每个人都是用户 - 只是不同的排列。

当不包含某些导航属性时，我正在尝试寻找在代码中处理此问题的最佳方法。例如，我不会在上面的示例中包括贡献者或管理员。通常我可以检查 user.subscriber.contributor 不为 NULL，但即使我进行此检查，我也会得到“对象上下文已被处理...”。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:34:43.403

您收到异常是因为您的实体被代理以进行延迟加载，并且在您处理上下文之前它们没有正确分离。无法直接分离具有加载关系的实体（您必须改为通过 serizliazation 创建深层副本），因此在这种情况下最好的解决方案是关闭延迟加载。在这种情况下，您的实体将不会尝试延迟加载首次访问的导航属性。

```
objectContext.ContextOptions.LazyLoadingEnabled = false; 
```

您也可以改为关闭整个代理创建：

```
objectContext.ContextOptions.ProxyCreationEnabled = false; 
```

# plone - 基于敏捷度检索内容对象的 IntID 的规范方法

> ID：11966097
> 
> 赞同：0
> 
> 时间：2012-08-15T08:23:34.357
> 
> 标签：plone, dexterity

五.intid 文档说明了以下用于检索对象的 IntID 的模式：

```
from five.intid import site
intids = site.get_intids(app.plone)
intid_obj = intids.getId(app.plone.restrictedTraverse('path/to/object') 
```

这是否也是 Plone 中的规范方式，或者是否有一些帮助/实用程序方法可以包装上面的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:25:20.720

我总是使用：

```
from zope.component import getUtility
from zope.intid.interfaces import IIntIds

intid = getUtility(IIntIds).getId(object) 
```

因为 intid 实用程序已在本地组件管理器中注册。

# c++ - 向更新其物理状态的对象添加数值积分

> ID：11966100
> 
> 赞同：4
> 
> 时间：2012-08-15T08:23:40.383
> 
> 标签：c++, design-patterns, numerical-methods

我考虑过这种情况：大致如下所示的对象：

```
class PhyisicalObject
{
  private:
  virtual void Update() = 0;
  friend class PhysicsController;
  void DoUpdate() { this->Update(); }
}; 
```

有一个称为 a 的控制器类`PhysicsController`，它通过调用物理对象的`DoUpdate()`方法来管理物理对象池的动态。就术语而言，此方法调用函数的重载版本，`Update()`其中使用数值积分器逐步计算对象的位置、速度和加速度。我认为拥有一个暗示此功能的接口将是一个很好的起点：

```
class IIntegrator
{
  virtual void opertor() (const vec3& pos, const vec3& vel, vec3& outPos, vec3& outVel);
}; 
```

现在继承这个`IIntegrator`抽象类并提供各种方法的实现是下一步（显式欧拉、RK4、Verlet、中点、辛欧拉，也许一些半隐式/IMEX 或隐式的会很好）。问题是我不清楚如何做以下两件事：

1.  每个物理对象以不同的方式在其任何顶点计算自己的加速度（考虑到对象由通过弹簧或某种约束对象连接的质点组成）。此函数必须传递给积分器，但它是特定于对象的。可以获得指向非静态方法的指针，但这如何适合`IIntegrator`接口？

2.  当一个对象调用它的`Update()`方法时，幕后发生的事情是一个集成器被用来提供功能。也许我想即时切换集成方法。或者至少用不同的积分器实例化同一种对象。对我来说，这听起来像是一家工厂在这样做，而且对于即时集成商切换……也许是一种策略模式？在这种情况下，什么解决方案会非常优雅和高效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:44:28.013

在不讨论实现细节的情况下，这里有一些可能适用于您的问题的设计模式

*   **工厂**或**原型**在启动时从文件创建对象，或分别在运行时克隆它们。
*   **Composite**这可以用于建模`PhysicalObjects`，可以是独立的对象，也可以是由弦、弹簧或重力连接的集合。
*   **迭代器**或**访问者**这可以用于`PhysicsController`迭代所有物理对象（复合或独立）并在它们上应用函数。
*   **策略**在运行时选择不同`IIntegrator`的对象及其集成函数。

除了 GoF 书籍（[亚马逊），](https://rads.stackoverflow.com/amzn/click/com/0201633612)[这里](http://sourcemaking.com/design_patterns)还有一个很好的在线资源

# eclipse - org.eclipse.ui.workbench.prefs 中字体首选项中的值是什么意思？

> ID：11966103
> 
> 赞同：2
> 
> 时间：2012-08-15T08:23:50.500
> 
> 标签：eclipse

我需要从外部工具更改 Eclipse 字体设置，并且我试图找出首选项文件中不同值的含义。

在`...\.metadata\.plugins\org.eclipse.core.runtime\.settings\org.eclipse.ui.workbench.prefs` 我有这些价值观：

```
org.eclipse.jface.textfont=1|Courier New|9.75|0|WINDOWS|1|-13|0|0|0|400|0|0|0|-18|3|2|1|49|Courier New; 
```

我可以通过更改首选项中的字体设置来弄清楚其中一些是什么意思，但其余的呢？

这是我到目前为止发现的：

```
1|Courier New|9.75|0    |WINDOWS|1|-13|0|0|0|400 |0     |0        |0        |-18   |3|2|1|49|Courier New;
?|font       |size|style|?      |?|?  |?|?|?|bold|italic|underline|strikeout|script|?|?|?|? |font       ; 
```

# magento - 使用文本值而不是下拉菜单向 Magento 产品添加自定义属性选择器

> ID：11966105
> 
> 赞同：0
> 
> 时间：2012-08-15T08:23:55.763
> 
> 标签：magento, text, attributes, product

Magento 提供可配置产品，以便买家选择给定产品的属性，例如衬衫的尺寸或手机的颜色。

问题是，您必须将每个可能的单个组合添加为一个简单的产品，而 Configurable Product 仅作为一个容器工作。这对于具有太多值和意外值的属性是不切实际的。

例如，它不允许文本值。如果买家想在衬衫上印上他的名字怎么办？

如果我想添加数十个值的可选属性怎么办？它不必通过管理区域添加，硬编码的解决方案是可以的。

有像购物车项目注释这样的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T17:55:17.450

可配置产品不应用于没有物理定义的产品，例如绘图和设计。相反，最好在这些情况下使用自定义选项，因为您既不关心产品库存也不关心基于属性的统计信息。这可以通过管理产品屏幕上的自定义选项选项卡来完成。当然，这消除了各种情况下对可配置产品的需求。

# padrino - 在 padrino 中过滤之前的全局 - 它是如何完成的？

> ID：11966109
> 
> 赞同：0
> 
> 时间：2012-08-15T08:24:03.490
> 
> 标签：padrino, before-filter

padrino[文档](http://www.padrinorb.com/guides/controllers)让您知道如何在控制器的上下文中执行前过滤器，但我正在尝试执行全局过滤器。

我要解决的问题是我的域名应该转发到www。版本，但 Godaddy 没有正确执行。所以现在我想在我的代码中手动重定向 - 因此是全局的前置过滤器。

或者我应该看“中间件”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T04:53:38.507

尝试使用 rack-rewrite gem

在你的 config.ru 添加类似

```
require 'rack/rewrite'
use Rack::Rewrite do
r301 %r{.*}, 'http://www.your-domain.com$&',
  :if => Proc.new { |rack_env| rack_env['SERVER_NAME'] != 'www.your-domain.com' }
end 
```

不要忘记将 gem 'rack-rewrite' 包含到您的 Gemfile 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T13:41:33.957

谷歌的第一个结果[http://logbook.route19.com/post/9018495987/sinatra-redirect-www-to-non-www](http://logbook.route19.com/post/9018495987/sinatra-redirect-www-to-non-www)

只需与该链接相反即可。尝试这样的事情：

```
before do
  redirect "www.#{request.url}" unless request.host =~ /^www/
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-05T21:48:24.120

我已将全局前置过滤器添加到 app.rb。不确定这是否是正确的方法，但它的工作原理与在我的控制器中添加之前的过滤器相同。

在您的 app.rb 文件中

```
before do
  # Code goes here
end 
```

# javascript - Firefox 中的粗体 ExecCommand 不起作用

> ID：11966111
> 
> 赞同：1
> 
> 时间：2012-08-15T08:24:15.087
> 
> 标签：javascript, firefox, selection, bold, execcommand

我正在使用 execCommand 使我的所见即所得编辑器上的文本变为粗体。该命令工作正常，但现在由于某种原因在 Firefox 14.0.1 中停止工作。发生的情况是，如果我有一个文本并将其加粗然后保存，我会得到这样的东西，（这是我想要的，到目前为止还可以）：

```
 <span font-weight: bold;">hello</span> 
```

现在的问题是，如果我再次选择文本以删除粗体，Firefox 不理解 font-weight 属性，因此它会在我的文本中再次添加 b 标记。例如，在 Firefox 10、Chrome 或 IE 中不会发生这种情况。浏览器在那里理解并删除字体粗细。

所以我的问题是，是否有人对此有所了解？

提前致谢

# java - 关于具有阻塞队列方法的java中的生产者和消费者模式

> ID：11966112
> 
> 赞同：1
> 
> 时间：2012-08-15T08:24:17.577
> 
> 标签：java, multithreading, concurrency

我正在研究关于 java 中的线程的生产者和消费者设计模式，我最近在 java 5 中进行了探索，介绍了 Java 5 中 BlockingQueue 数据结构的介绍 它现在更简单了，因为 BlockingQueue 通过引入阻塞方法隐式地提供了这种控制放（）和取（）。现在您不需要使用等待和通知来在生产者和消费者之间进行通信。BlockingQueue put() 方法将在 Bounded Queue 的情况下 Queue 已满时阻塞，如果 Queue 为空，则 take() 方法将阻塞。在下一节中，我们将看到一个生产者消费者设计模式的代码示例。我已经开发了以下程序，但也请让我知道 waut() 和 notify() 的旧式方法，我也想用旧式方法开发相同的逻辑

人们请告知如何实现这一点，经典方式是使用 wait() 和 notify() 方法在生产者和消费者线程之间进行通信，并在单个条件下阻塞它们中的每一个，例如满队列和空队列......？

```
 import java.util.concurrent.BlockingQueue;
import java.util.concurrent.LinkedBlockingQueue;
import java.util.logging.Level;
import java.util.logging.Logger;

public class ProducerConsumerPattern {

    public static void main(String args[]){

     //Creating shared object
     BlockingQueue sharedQueue = new LinkedBlockingQueue();

     //Creating Producer and Consumer Thread
     Thread prodThread = new Thread(new Producer(sharedQueue));
     Thread consThread = new Thread(new Consumer(sharedQueue));

     //Starting producer and Consumer thread
     prodThread.start();
     consThread.start();
    }

}

//Producer Class in java
class Producer implements Runnable {

    private final BlockingQueue sharedQueue;

    public Producer(BlockingQueue sharedQueue) {
        this.sharedQueue = sharedQueue;
    }

    @Override
    public void run() {
        for(int i=0; i<10; i++){
            try {
                System.out.println("Produced: " + i);
                sharedQueue.put(i);
            } catch (InterruptedException ex) {
                Logger.getLogger(Producer.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

}

//Consumer Class in Java
class Consumer implements Runnable{

    private final BlockingQueue sharedQueue;

    public Consumer (BlockingQueue sharedQueue) {
        this.sharedQueue = sharedQueue;
    }

    @Override
    public void run() {
        while(true){
            try {
                System.out.println("Consumed: "+ sharedQueue.take());
            } catch (InterruptedException ex) {
                Logger.getLogger(Consumer.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

}

Output:
Produced: 0
Produced: 1
Consumed: 0
Produced: 2
Consumed: 1
Produced: 3
Consumed: 2
Produced: 4
Consumed: 3
Produced: 5
Consumed: 4
Produced: 6
Consumed: 5
Produced: 7
Consumed: 6
Produced: 8
Consumed: 7
Produced: 9
Consumed: 8
Consumed: 9 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:43:30.797

如果您想知道另一种方法，请尝试使用 ExecutorService

```
public static void main(String... args) {
    ExecutorService service = Executors.newSingleThreadExecutor();
    for (int i = 0; i < 100; i++) {
        System.out.println("Produced: " + i);

        final int finalI = i;
        service.submit(new Runnable() {
            @Override
            public void run() {
                System.out.println("Consumed: " + finalI);
            }
        });
    }
    service.shutdown();
} 
```

只需 10 个任务，生产者就可以在消费者开始之前完成。如果您尝试 100 个任务，您可能会发现它们是交错的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T08:36:24.737

如果您想了解 BlockingQueue 的工作原理，出于教育目的，您可以随时查看[它的源代码](http://kickjava.com/src/java/util/concurrent/LinkedBlockingQueue.java.htm)。

最简单的方法可能是`synchronize`和`offer()`方法`take()`，一旦队列已满并且有人尝试`offer()`使用元素 - 调用`wait()`。当有人在使用元素时，`notify()`睡眠线程。（尝试`take()`从空队列中获取相同的想法）。
请记住确保所有`wait()`调用都嵌套在循环中，以检查每次唤醒线程时是否满足条件。

如果您打算出于产品目的从头开始实施它 - 我强烈反对它。您应该尽可能多地使用现有的、经过测试的库和组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T15:32:00.123

我可以在睡梦中做这个等待通知的东西（或者至少我认为我可以）。Java 1.4 源代码提供了所有这一切的漂亮示例，但他们已经转而使用原子来做所有事情，现在变得更加复杂。等待通知确实提供了灵活性和功能，尽管其他方法可以保护您免受并发的危险并简化代码。

为此，您需要一些字段，如下所示：

```
private final ConcurrentLinkedQueue<Intger>  sharedQueue =
                                                    new ConcurrentLinkedQueue<>();
private volatile   boolean  waitFlag = true; 
```

您的 Producer.run 将如下所示：

```
public void run()  {
    for (int i = 0; i < 100000, i++)  {
        System.out.println( "Produced: " + i );
        sharedQueue.add( new Integer( i ) );
        if (waitFlag)       // volatile access is cheaper than synch.
            synchronized (sharedQueue)  { sharedQueue.notifyAll(); }
    }
} 
```

和 Consumer.run：

```
public void run()  {
    waitFlag = false;
    for (;;)  {
        Integer  ic = sharedQueue.poll();
        if (ic == null)  {
            synchronized (sharedQueue)  {
                waitFlag = true;
                // An add might have come through before waitFlag was set.
                ic = sharedQueue.poll();
                if (ic == null)  {
                    try  { sharedQueue.wait(); }
                    catch (InterruptedException ex)  {}
                    waitFlag = false;
                    continue;
                }
                waitFlag = true;
            }
        }
        System.out.println( "Consumed: " + ic );
    }
} 
```

这使同步保持在最低限度。如果一切顺利，每次添加只会查看一个 volatile 字段。您应该能够同时运行任意数量的生产者。（消费者会更棘手——你必须放弃`waitFlag`。）你可以使用不同的对象来等待/通知所有。

# blackberry - 黑莓 - 从 GPS、网络服务或手机信号塔获取位置

> ID：11966116
> 
> 赞同：1
> 
> 时间：2012-08-15T08:24:45.233
> 
> 标签：blackberry, location, coordinates

我正在尝试在 BlackBerry 中获取位置。我可以通过 GPS 或 Google Web 服务成功获取位置。如果 GPS 不可用（在建筑物内）或手机不支持 GPS，则通过 Google Web 服务获取位置。但是，我想更新此类以执行以下操作：

1) 检查 GPS 是否可用 -> 从 GPS 获取位置 2) 否则检查互联网是否可用 -> (Yes) 从 Google Webservice 获取位置 3) (No) 从移动网络蜂窝塔获取位置 4) 之后不断更新位置给定的时间间隔（10-20 秒）

请帮忙。

```
public class GPSHandler { 

       private GPSThread _gpsThread;
       private Coordinates _location;
       private boolean _gotLocation;
       private GPSListener _listener;

       /** this class will be a Singleton, as the device only has one GPS system */
       private static GPSHandler _instance;

       /** @return the Singleton instance of the GPSHandler */
       public static GPSHandler getInstance() {
          if (_instance == null) {
             _instance = new GPSHandler();
          }
          return _instance;
       }

       /** not publicly accessible ... use getInstance() */
       private GPSHandler() { 
          _gpsThread = new GPSThread();
          // NOTE: you might not want to call start() unless you have a listener.
          //  Otherwise, just make sure to handle the case where the location is
          //  received before setListener() is called.
          _gpsThread.start(); 
       }

       public void setListener(GPSListener listener) {
          // only supports one listener this way
          _listener = listener;   
       }

       private void setLocation(final Coordinates value) {
          _location = value;
          if (value.getLatitude() != 0.0 || value.getLongitude() != 0.0) {
             _gotLocation = true;
             if (_listener != null) {
                // this assumes listeners are UI listeners, and want callbacks on the UI thread:
                UiApplication.getUiApplication().invokeLater(new Runnable() {
                   public void run() {
                      _listener.onLocationReceived(value);
                   }
                });
             }
          }
       }

       private class GPSThread extends Thread {

          private void getLocationFromGoogle() {
             try { 
                int cellID = GPRSInfo.getCellInfo().getCellId(); 
                int lac = GPRSInfo.getCellInfo().getLAC(); 

                String urlString2 = "http://www.google.com/glm/mmap"; 

                // Open a connection to Google Maps API  
                ConnectionFactory connFact = new ConnectionFactory(); 
                ConnectionDescriptor connDesc; 
                connDesc = connFact.getConnection(urlString2); 

                HttpConnection httpConn2; 
                httpConn2 = (HttpConnection)connDesc.getConnection(); 
                httpConn2.setRequestMethod("POST"); 

                // Write some custom data to Google Maps API  
                OutputStream outputStream2 = httpConn2.openOutputStream();//getOutputStream(); 
                writeDataGoogleMaps(outputStream2, cellID, lac); 

                // Get the response   
                InputStream inputStream2 = httpConn2.openInputStream();//getInputStream(); 
                DataInputStream dataInputStream2 = new DataInputStream(inputStream2); 

                // Interpret the response obtained  
                dataInputStream2.readShort(); 
                dataInputStream2.readByte(); 

                final int code = dataInputStream2.readInt(); 
                UiApplication.getUiApplication().invokeLater(new Runnable() {
                   public void run() {
                      Dialog.alert(code + "");   
                   }
                });                        

                if (code == 0) { 
                   final double latitude = dataInputStream2.readInt() / 1000000D; 
                   final double longitude = dataInputStream2.readInt() / 1000000D; 
                   setLocation(new Coordinates(latitude, longitude, 0.0f));

                   UiApplication.getUiApplication().invokeLater(new Runnable() {
                      public void run() {
                         Dialog.alert(latitude+"-----"+longitude);   
                      }
                   });

                   dataInputStream2.readInt(); 
                   dataInputStream2.readInt(); 
                   dataInputStream2.readUTF(); 
                } else { 
                   System.out.println("Error obtaining Cell Id "); 
                } 
                outputStream2.close(); 
                inputStream2.close(); 
             } catch (Exception e) { 
                System.out.println("Error: " + e.getMessage()); 
             } 
          }

          private void tryGetLocationFromDevice() {
             _gotLocation = false;
             try {
                Criteria myCriteria = new Criteria(); 
                myCriteria.setCostAllowed(false); 
                LocationProvider myLocationProvider = LocationProvider.getInstance(myCriteria); 

                try { 
                   Location myLocation = myLocationProvider.getLocation(300); 
                   setLocation(myLocation.getQualifiedCoordinates()); 
                } catch ( InterruptedException iex ) { 
                   System.out.println(iex.getMessage());
                } catch ( LocationException lex ) { 
                   System.out.println(lex.getMessage());
                } 
             } catch ( LocationException lex ) { 
                System.out.println(lex.getMessage());
             }

             if (!_gotLocation) { 
                getLocationFromGoogle();
             } 
          }

          public void run() { 
             int bbMapsHandle = CodeModuleManager.getModuleHandle("net_rim_bb_lbs");    // OS 4.5 - 6.0
             int bbMapsHandle60 = CodeModuleManager.getModuleHandle("net_rim_bb_maps"); // OS 6.0
             if (bbMapsHandle > 0 || bbMapsHandle60 > 0) { 
                tryGetLocationFromDevice();
             } else {
                getLocationFromGoogle();
             }
             return; 
          } 
       } 

       private void writeDataGoogleMaps(OutputStream out, int cellID, int lac) throws IOException { 
          DataOutputStream dataOutputStream = new DataOutputStream(out); 
          dataOutputStream.writeShort(21); 
          dataOutputStream.writeLong(0); 
          dataOutputStream.writeUTF("en"); 
          dataOutputStream.writeUTF("Android"); 
          dataOutputStream.writeUTF("1.0"); 
          dataOutputStream.writeUTF("Web"); 
          dataOutputStream.writeByte(27); 
          dataOutputStream.writeInt(0); 
          dataOutputStream.writeInt(0); 
          dataOutputStream.writeInt(3); 
          dataOutputStream.writeUTF(""); 

          dataOutputStream.writeInt(cellID); 
          dataOutputStream.writeInt(lac); 

          dataOutputStream.writeInt(0); 
          dataOutputStream.writeInt(0); 
          dataOutputStream.writeInt(0); 
          dataOutputStream.writeInt(0); 
          dataOutputStream.flush(); 
       } 

    } 
```

# javascript - jquery中的异步请求（Get）

> ID：11966120
> 
> 赞同：0
> 
> 时间：2012-08-15T08:25:00.600
> 
> 标签：javascript, jquery

我尝试获得树结构，所以我使用树控制。但我想首先获得根级别的项目，然后单击其中一个我想获得它的孩子。

因此，我使用带有以下代码的 Get 请求：

```
$(function() {
    $('#tt').tree({
        onBeforeExpand: function(node) {
            var count = getChildren(node);
            if (count == 0) {
                var hospitalId = node.id;

                $.getJSON('@Url.Action("LoadDepartments")', {
                    hospitalId: hospitalId
                }, function(result) {

                    if (result != null) {
                        $('#tt').tree('append', {
                            parent: node.target,
                            data: result

                        });
                    }
                });
            }
        }
    });
});​ 
```

在此函数中，我获取所选父节点的数据并将它们附加到树结构中。我希望在单击父节点并展开它后看到这个子元素。但是我只在关闭后才看到子元素，然后再展开它。但是，如果我使用调试并逐步进行，我会立即看到结果。

也许我应该使用延迟？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:58:43.127

也许你应该`onBeforeExpand`改成`onExpand`? 确保`data`确实在扩展**后加载和注入。**

从文档：

> onExpand：节点展开时触发。

`jQuery`如果您提供指向您正在使用的插件的链接，也会有所帮助。

# openssl - 如何使用包括 CRL 分发点的 openssl 创建证书？

> ID：11966123
> 
> 赞同：5
> 
> 时间：2012-08-15T08:25:16.073
> 
> 标签：openssl, x509, certificate-revocation

我在使用 openssl 创建包含用于测试的 crl 分发点的 x509 证书时遇到问题。

我检查了文档并找到了用于此目的的配置设置 crlDistributionPoints。不幸的是，openssl 总是生成 x509 版本 1 证书，而不是带有 crl 分发点的版本 3 证书。我确定我的命令或配置有问题，但仔细阅读文档并尝试配置并没有帮助。考虑了配置文件中的其他设置，因此我确定文件本身被 openssl 使用。

我正在使用命令

```
openssl x509 -req -in $NAME.csr -out certs/$NAME.pem -days 3650 -CAcreateserial -CA cacert.pem -CAkey private/cakey.pem -CAserial serial 
```

我正在使用以下配置文件：

```
[ ca ]
default_ca              = CA_default

[ CA_default ]

dir                     = /home/ca
database                = $dir/index.txt
new_certs_dir           = $dir/newcerts

certificate             = $dir/cacert.pem
serial                  = $dir/serial
private_key             = $dir/private/cakey.pem
RANDFILE                = $dir/private/.rand

default_days            = 3650
default_crl_days        = 30
default_md              = md5

policy                  = policy_any
email_in_dn             = no

name_opt                = ca_default
cert_opt                = ca_default
copy_extensions         = none

x509_extensions         = extensions_section

[ extensions_section ]

crlDistributionPoints=URI:http://example.com/crl.pem

[ policy_any ]
countryName             = supplied
stateOrProvinceName     = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = supplied
emailAddress            = optional 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-19T02:27:44.373

`openssl x509`不会读取您在上面在配置文件中指定的扩展配置。

您可以`crlDistributionPoints`（至少）通过以下两种方式进入您的证书：

1.  使用`openssl ca`而不是`x509`签署请求。`-config`如果您的配置不在默认位置，则根据需要传递。如果您省略以开头的选项，则可以使用您提供的大多数命令`-CA`

    `openssl ca -in $NAME.csr -out certs/$NAME.pem -days 3650`

2.  使用您在问题中提供的命令，但首先创建一个包含您的 v3 扩展名的文件（即`mycrl.cnf`）；将选项添加`-extfile mycrl.cnf`到您的通话中`openssl x509`

    ```
    openssl x509 -req -in $NAME.csr -out certs/$NAME.pem -days 3650 \
      -CAcreateserial -CA cacert.pem -CAkey private/cakey.pem \
      -CAserial serial -extfile mycrl.cnf` 
    ```

    其中`mycrl.cnf`包含以下内容：

    `crlDistributionPoints=URI:http://example.com/crl.pem`

`openssl ca`该命令可能更适合您想要执行的操作，因为您会发现大多数示例都依赖于该命令，该命令利用 openssl.cnf 中的各种设置进行 v3 扩展。

顺便说一句：[不](http://www.kb.cert.org/vuls/id/836068/)建议在证书中使用 MD5 消息摘要。

以前 SHA1 是 MD5 的建议替代品，但现在也已弃用。您可以指定在请求和签名操作中使用的消息摘要，并且可以使用 列出支持的消息摘要`openssl list-message-digest-commands`。

例如，您可以在签名请求时使用 SHA256`-md sha256`选项`openssl ca`（或`default_md=sha256`在您的`[CA_default]`配置部分中设置）。

# c++ - Qt pro 文件的对应 CMakeList

> ID：11966124
> 
> 赞同：0
> 
> 时间：2012-08-15T08:25:20.170
> 
> 标签：c++, qt, cmake

我需要将 Qt Project 转换为 CMake ，因为我想将它与 CMake 中已经存在的其他项目集成。

Qt .Pro 文件如下，

```
TEMPLATE = app
INCLUDEPATH += ./lib

# Input

HEADERS +=  dollar/GestureTemplate.h \
    dollar/PathWriter.h \
    dollar/GeometricRecognizerTypes.h \
    dollar/GeometricRecognizer.h \
    dollar/SampleGestures.h \
    lib/GestureTemplate.h \
    lib/PathWriter.h \
    lib/GeometricRecognizerTypes.h \
    lib/GeometricRecognizer.h \
    lib/SampleGestures.h \
    lib/MultiStrokeGestureTemplate .h \
    lib/MultiStrokeGestureTemplate .h \
    lib/MultiStrokeGestureTemplate .h \
    lib/MultiStrokeGestureTemplate .h \
    lib/SampleMultiStrokeGestures.h \
    lib/MultipleStrokeGestureTemplate.h \
    lib/utils.h
SOURCES += main.cpp \
    lib/GeometricRecognizer.cpp

LIBS += -L/usr/lib \
    -lml \ 
```

Lib只有一个目录，主路径有main.cpp，其他文件都在Lib目录下。

我对 cmake 了解不多，我为上述 qt 项目提供了以下 cmake 列表。

```
cmake_minimum_required (VERSION 2.6)
Project(dollar)
INCLUDE_DIRECTORIES("lib")
# Make Executable
ADD_EXECUTABLE(main main.cpp)
# Link the executable to the Hello library.
TARGET_LINK_LIBRARIES(main -lml -L/usr/lib) 
```

cmake 成功但之后 make 给了我很多错误，请参阅错误日志 -> [http://www.text-upload.com/read,4022366863337。](http://www.text-upload.com/read,4022366863337)我需要在 CMake 列表中添加哪些内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:45:01.313

您似乎错过了 lib/GeometricRecognizer.cpp 文件

```
# Make Executable
ADD_EXECUTABLE(main main.cpp lib/GeometricRecognizer.cpp) 
```

# php - 如何使用 FOSTwitterBundle 调用 Twitter API

> ID：11966127
> 
> 赞同：3
> 
> 时间：2012-08-15T08:25:22.150
> 
> 标签：php, symfony

我已经安装了 FOSTwitterBundle 并在 Twitter 上设置了密钥。

我创建了这个动作：

```
public function twitterFirstAction(Request $request)
{
    $twitter  = $this->get('fos_twitter.service');
    $authURL  = $twitter->getLoginUrl($request);
    $response = new RedirectResponse($authURL);
    return $response;
} 
```

它重定向到 twitter 并重定向回`twitterSecondAction()`

```
public function twitterSecondAction(Request $request)
{
    $twitter = $this->get('fos_twitter.service');
    // now what
} 
```

我检查了会话，一切都很好。但现在我对如何进行 API 调用感到困惑。例如，列出用户的关注者。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T16:08:13.863

FOSTwitterBundle 具有[TwitterOAuth](https://github.com/kertz/twitteroauth/blob/master/twitteroauth/twitteroauth.php)`fos_twitter.api`类服务，它允许您获取、发布和删除请求。

因此，您的第二个操作可能如下所示：

```
public function twitterSecondAction(Request $request)
{
    $twitter = $this->get('fos_twitter.api'); //
    $idsOfFollowers = $twitter->get('followers/ids');
} 
```

请参阅[twitter API 文档](https://dev.twitter.com/docs/api)了解可能的操作。

# c# - Linq 外连接语法

> ID：11966128
> 
> 赞同：0
> 
> 时间：2012-08-15T08:25:33.710
> 
> 标签：c#, .net, linq

我有以下查询：

```
var query =
     from modules in _Context.Modules
     join moduleStrings in _Context.ModuleStrings on modules.MID equals moduleStrings.MID
     join strings in _Context.Strings on moduleStrings.SID equals strings.SID
     join stringTexts in _Context.StringTexts on strings.SID equals stringTexts.SID into stringsEmpty
     from stringTexts in stringsEmpty.DefaultIfEmpty()
     join languages in _Context.Languages on stringTexts.LID equals languages.LID
     where modules.MID == MID && LID == languages.LID
     select new GridData6S() 
     { 
         Name = strings.Name,
         Text = stringTexts != null ? stringTexts.Text : ""
     }; 
```

我想加入它，以便在 stringTexts 为空时看到空文本。

这可能是一些小事，但我已经看了一个小时，无法弄清楚。这是我得到的最接近的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:20:18.363

您正在过滤掉任何不是 LID=languages.LID 的语言，因此当语言/字符串文本为空时，此条件永远不会成立。

此外，您似乎加入语言表的唯一原因是获取 LID，这也是加入条件，您可以跳过加入语言

模块也是如此......

这可能会有所帮助并且更简单一些

```
var query = 
  from moduleStrings in _Context.ModuleStrings  
  join strings in _Context.Strings on moduleStrings.SID equals strings.SID 
  join stringTexts1 in _Context.StringTexts.Where(x=>x.LID==LID) on strings.SID equals stringTexts.SID into stringsEmpty 
  from stringTexts in stringsEmpty.DefaultIfEmpty() 
  where moduleStrings.MID == MID 
  select new GridData6S()  
  {  
      Name = strings.Name, 
      Text = stringTexts != null ? stringTexts.Text : "" 
  }; 
```

# ruby-on-rails - 如何在带有 Rails 的 URL 中使用记录属性？

> ID：11966130
> 
> 赞同：0
> 
> 时间：2012-08-15T08:25:35.277
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, clean-urls

除了 id 之外，我如何说服 rails 在 url 中使用记录属性？

例如，考虑一个`Publication`具有属性的类`pub_date`，最好有一个类似的 url

```
 /publications/#{pub_date.year}/#{id} 
```

虽然我可以`to_param`用来更改“id”部分，但我似乎记得生成一个带有“/”的参数是一个坏主意。所以使用类似的东西

```
def to_param
  "#{pub_data.year}/#{super}"
end 
```

似乎不可行。此外，使用其他 URL 模板似乎是不可能的，例如，如果我想在 url 的另一部分使用该属性，例如：

```
 /#{pub_date.year}/publications/#{id} 
```

我可以定义匹配的路线，例如

```
 match "/xxx/:foo/:bar" => "ctrlr#act" 
```

但我不确定如何使用自动生成的`_url`and助手。`_path`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T11:03:42.670

你可以使用 :as 选项

```
get "/xxx/:foo/:bar" => "ctrlr#act", :as => :xxx 
```

接着

```
xxx_path(:foo => 'asd', :bar => 'qwe') # "/xxx/asd/qwe" 
```

# c# - 在 protobuf-csharp-port 2.4.1.473 中重建 AddressBook 示例

> ID：11966135
> 
> 赞同：3
> 
> 时间：2012-08-15T08:25:52.567
> 
> 标签：c#, .net, protocol-buffers

我已经成功地在 protobuf-csharp-port-2.4.1.473-source 中构建了示例 AddressBook 项目，甚至让它与来自 protobuf-2.4.1-win32 的 C++ 示例一起工作。但是，当我尝试重新生成 AddressBookProtos.cs 文件并执行它时，我遇到了以下运行时问题。

```
Options:
L: List contents
A: Add new person
Q: Quit
Action? a
Exception executing action: System.TypeInitializationException: The type initializer
for 'Google.ProtocolBuffers.Examples.AddressBook.AddressBook' threw an exception. ---> 
System.TypeInitializationException: The type initializer
for 'Google.ProtocolBuffers.Examples.AddressBook.AddressBookProtos' threw an exception. --->
System.ArgumentException: Invalid embedded descriptor for "tutorial/addressbook.proto". --->
Google.ProtocolBuffers.Descriptors.DescriptorValidationException: tutorial/addressbook.proto:
Dependencies passed to FileDescriptor.BuildFrom() don't match those listed in the
FileDescriptorProto.
at Google.ProtocolBuffers.Descriptors.FileDescriptor.BuildFrom(FileDescriptorProto proto,
FileDescriptor[] dependencies)
at Google.ProtocolBuffers.Descriptors.FileDescriptor.InternalBuildGeneratedFileFrom(Byte[]
descriptorData, FileDescriptor[] dependencies, InternalDescriptorAssigner descriptorAssigner) 
```

我尝试使用 protos\tutorial\addressbook.proto 从 protobuf-csharp-port-2.4.1.473-release-binaries 生成 AddressBookProtos.cs，但它似乎缺少命名空间和雨伞类名选项。此外，protobuf-csharp-port-2.4.1.473-source 中的 src\AddressBook\AddressBookProtos.cs 中列出的版本号表示它是“2.3.0.277”。

# javascript - 加载 javascript/css 时消除页面闪烁

> ID：11966137
> 
> 赞同：1
> 
> 时间：2012-08-15T08:26:04.067
> 
> 标签：javascript, jquery, css

我尝试将内联 javascript 代码放在 之后`</body>`，但没有帮助。

HTML 代码：

```
<html>  
<head>
        <meta charset="UTF-8"/>
        <title> Foodstant Delivery </title>

        <link rel="stylesheet" type="text/css" media="screen" href="testCSS.css" />
        <link rel="stylesheet" type="text/css" href="jquery.booklet.1.4.0.css" media="screen" />

        <script type="text/javascript" src="scripts/jquery-1.7.2.js"></script>
        <script type="text/javascript" src="scripts/jquery-ui.min.js"> </script>
        <script src="scripts/jquery.easing.1.3.js" type="text/javascript"></script>
        <script src="scripts/jquery.booklet.1.4.0.min.js" type="text/javascript">
        </script>
</head>

<body>
        <div id="container">
        <div id="numb1">    
                <img src="images/number4.png" />
            </div> 

        <figure id="logo"> 
            <img src="images/logo23.png" alt="Foodstant Delivery logo" />
        </figure>   

        <figure id="abtex">
            <img src="images/abtext126.png" />
        </figure>   
    <div class="Navigation">
        <div id="navbar">
            <ul>
                <li class="OP"><a href="testHP.html"><img src="images/house.png" width="40" height="32" /></a>
                </li>   
                <li class="OP" id="OPM1"><img src="images/order.png"   /><a  href="Orders.html">Orders</a></li>
                <li class="OP" id="OPM"><img src="images/menupic3.png" /><a  href="Menu.html">Menu</a></li>
                <li class="OP"> <img src="images/contact.png" /><a href="#">Contact</a>
                        <div class="extended">
                            <div class="arrow-container"><div class="arrow-up"></div></div>

                            <ul class="smallNav">
                                <li><a href="#">+65-65553333</a></li>
                                <li><a href="http://www.facebook.com/pages/yourfanpage/12345678" target="_blank">Facebook</a></li>
                                <li><a href="http://twitter.com/yourtwitter" target="_blank">Twitter</a></li>
                                <li><a href="www.gmail.com" target="_blank">enquiry [at] foodstant [dot] com</a></li>
                            </ul>
                        </div>
                    </li>

                <li class="OP"><img src="images/Pen.png"  /><a href="AboutUs2.html">About Us</a></li>
                <li class="OP"><img src="images/pin.png"   /><a  href="Jobs.html">Jobs</a></li>
            </ul>   
        </div>
    </div>  

        <span id="papersl">
            <img src="images/paperslant5.png" />
        </span>

    <div id="mybook">
        <div> 
            <img src="images/CC1.png" width="100%" height="100%" />
        </div>
        <div> 
            <img src="images/WC.png" width="100%" height="100%" />
        </div>
        <div> 
            <img src="images/ss1.png" width="100%" height="100%" />
        </div>
        <div> 
            <img src="images/beverages.png" width="100%" height="100%" />
        </div>
    </div>

        <form action="" id="search-form" class="SF">
            <fieldset>
                <input type="text" id="search" name="search" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" value="Search..." class="searchfield" />
                <input type="submit" id="search-submit" value="" />
            </fieldset>
        </form>

        <figure id="foot">
            <img src="images/footer-comb1.png" usemap="#green" border="0">

            <map name="green">

            <area shape="rect" coords="503,41,614,85" href="http://www.trees.com/furniture.html">
            <area shape="rect" coords="710,44,866,84"  href="#0" id="se" >
            </map>
        </figure>   

</div>
</body>

<script type="text/javascript">
            $(document).ready(function() {

                $('#numb1').hide().delay(800).fadeIn('normal');

                $('#se').click(function() {
                    $('.SF').css('visibility','visible');

                });     

                $(function() {
                    $('#mybook').booklet({
                   width:600,
                     height:350
                });
            });
            });

        </script>

    </html> 
```

CSS：

```
* {
    margin: 0;
    padding:0;

}

body {
    background-image: url('images/BG-W1.png');
    font-family: 'Conv_LITHOSPRO-REGULAR',Verdana,Helvetica,'Courier New',sans-serif;
    /*height: 800px !important;*/

}

@font-face {
    font-family: 'Conv_LITHOSPRO-REGULAR';
    src: url('fonts/LITHOSPRO-REGULAR.eot');
    src: url('fonts/LITHOSPRO-REGULAR.eot?#iefix') format('embedded-opentype');
    src: local('☺'), url('fonts/LITHOSPRO-REGULAR.woff') format('woff'), url('fonts/LITHOSPRO-REGULAR.ttf') format('truetype'), url('fonts/LITHOSPRO-REGULAR.svg') format('svg');
}

#container{
    max-width:1000px;
    margin: 0 auto; 
    position: relative; 
    padding: 0 auto;
    /*height: 762px !important;*/
    /*border: 2px solid blue;*/

}

#logo {
    float:left;
    /*border: 1px solid black;*/
    height: 180px;
}

#abtex {
    float: left;
        /*border: 1px solid black;*/
        height: 180px;
}

#navbar {

}

.ftex {
    position: relative;

}

#qqq {
    position: static !important;
    border: 1px solid black;
    background-image:url('images/bg-fs-5.png');
     background-repeat:no-repeat;
     height: 125px;
     width: 800px;
     /*padding:25px 0 0 0;*/
     /*padding-top: 50px;
     padding-left: 34px;*/
}

.ftex ul {
    list-style-type:none;
    /*border:2px solid yellow;*/
    width:1200px;

}

.ftex ul li {
    display:inline;
    padding-right: 170px; 
    font-family: 'Conv_LITHOSPRO-REGULAR';
    font-size: 20px;
    /*border:2px solid red;*/
    color:#ffbf81;
}

.ftex li a:link {
  color: #ffbf81;
  border-bottom:4px solid #ffbf81;
  }

.ftex li a:visited {
  color: #ffbf81;
  border-bottom:4px solid #ffbf81;
  }

.ftex li a:hover {
  color: #ffbf81;
  background:none;
  border-radius: 0;
  border-bottom:4px solid #ffbf81;
  }

.ftex li a:active {
  color: #ffbf81;
  border-bottom:4px solid #ffbf81;
  } 

.ftex ul li#ss {
    border-bottom:4px solid #ffbf81;
    padding-right:5px;

}

#footerBg {
    position: relative;
    bottom:-90px;
    left:-50px;

}

#foot {
    padding-top: 10px;
}

#foot img {
    display: block;
}

#foothome{
    padding-top:100px; 
}

#foothome img {
    display: block;
}

#numb1 {
    position: absolute;
    /*border:10px solid red;*/
    top:10px;

    right:-124px;
    /*z-index: 100;*/
    /*background:url(images/number2.png); */
}

#abt {
    position: relative;
    /*border: 1px solid red;*/
    height: 400px;
    left:180px;
    top:-60px;

    z-index: -2;

}

#papersl {
    position: absolute;
    left: 60px;
    top: 222px;
    z-index: -4;
}

.Navigation { background:background: rgb(246,248,249); /* Old browsers */
    background: -moz-linear-gradient(top,  rgba(246,248,249,1) 0%, rgba(229,235,238,1) 46%, rgba(215,222,227,1) 65%, rgba(245,247,249,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(246,248,249,1)), color-stop(46%,rgba(229,235,238,1)), color-stop(65%,rgba(215,222,227,1)), color-stop(100%,rgba(245,247,249,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(246,248,249,1) 0%,rgba(229,235,238,1) 46%,rgba(215,222,227,1) 65%,rgba(245,247,249,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(246,248,249,1) 0%,rgba(229,235,238,1) 46%,rgba(215,222,227,1) 65%,rgba(245,247,249,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(246,248,249,1) 0%,rgba(229,235,238,1) 46%,rgba(215,222,227,1) 65%,rgba(245,247,249,1) 100%); /* IE10+ */
    background: linear-gradient(to bottom,  rgba(246,248,249,1) 0%,rgba(229,235,238,1) 46%,rgba(215,222,227,1) 65%,rgba(245,247,249,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f6f8f9', endColorstr='#f5f7f9',GradientType=0 ); /* IE6-9 */ 
    border-top-left-radius: 10px;
    border-bottom-left-radius:10px;
    border-top-right-radius: 10px; 
    border-bottom-right-radius:10px;

    box-shadow: -3px -5px 10px  #888888;
    font-size: 26px;

    /*position: relative;
    top:-50px;*/
    clear:both;

    font-family: 'Conv_LITHOSPRO-REGULAR';  

}

.Navigation ul li {  position: relative; list-style: none; padding: 17px 10px; }

.Navigation ul li a { font-size: 26px; color: white; text-decoration: none; }

.Navigation ul li:hover { background: url(images/hover.png) repeat-x; height: 43px; -webkit-box-shadow: 0 0px 2px black inset; padding: 20px 9px; border-left: 1px solid #a4a4a4; border-right: 1px solid #a4a4a4;} 

.Navigation ul li:hover { background: none; -webkit-box-shadow: none; -moz-box-shadow: none; height: auto; border: none; }

.arrow-up { width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 15px solid #6a6a63; position: absolute; left: 20px; top: -15px; }

.Navigation  ul li .extended { position: absolute; top: 45px; left: 0; width: 220px; background: url(images/dropdownback.png); z-index: 1000; -moz-box-shadow: 0 0px 8px rgba(0,0,0,0.8); -webkit-box-shadow: 0 0px 8px rgba(0,0,0,0.8); box-shadow: 0 0 8px black; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; border: 1px solid white; display: none; color: white; }

.Navigation  ul li .extended img { display: block; margin: 5px auto 15px auto; -webkit-box-reflect:below 0px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(0.8, transparent), to(rgba(255,255,255,0.5))); }

.Navigation  ul li .extended a { font-size:14px;}

.Navigation  ul li .extended h2, .Navigation ul li .ultraNav h2 { padding-top: 10px; padding-left: 10px; font-size: 16px; text-shadow: 0 1px 2px black; color: white; background: url(images/headerback.png) repeat-x; height: 20px; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px;  }

.Navigation ul li .extended span { padding-left: 10px; font-size: 11px; }

.Navigation  ul li .extended ul.smallNav { border-top: 1px solid rgba(141,141,141,0.50);  padding: 10px; height: 100px;  }

.Navigation ul li .extended ul.smallNav li { width: 200px; padding: 0; line-height: 22px; font-weight: bold; background: url(images/linkback.png) no-repeat; }

.extended ul li {float:left;}

.Navigation  ul li .extended ul.smallNav li:first-child { margin: 0; }

.Navigation  ul li .extended ul.smallNav li:last-child { margin-bottom: 10px; }

.Navigation ul li:hover .extended { display: block; }

.Navigation ul li ul li:hover a { color: white; } 

#navbar ul {
    list-style-position:inside;
    padding-top: 10px;
    padding-bottom: 10px;
}

#navbar ul li {     
        display: inline;
        padding:0 20px 0px 0px; 
        margin-bottom: 10px;
        list-style-type:disc;
    }

#navbar ul li.OP {
        /*list-style-image:url('images/order.png'); */
        padding-left: 15px;

}   

#navbar ul li.OP img {
    vertical-align: middle; 
}

#navbar li a:link {
  color: #EF174A;
  }

#navbar li a:visited {
  color: #BF4100;
  }

 #navbar li a:hover {
  color: black;
  background-color:#D2D2D2;
  border-radius: 10px; 
  }

 #navbar li a:active {
  color: #918FBC;
  } 

li a {
    text-decoration:none;
}  

#navbar ul li.OP a {
    padding-left: 10px;
}

.Navigation  ul li .extended ul.smallNav li a { color: #c7c7c7 !important; text-shadow: none !important;  } 

.Navigation ul li .extended ul.smallNav li a:hover { color: white !important;} 

.arrow-container { margin-top:-16px; height:16px;  }

fieldset {
    border: 0 none;
    margin: 0;
    padding: 0;
    vertical-align: baseline;
}
#main {
    border: medium none;
    /*height: 500px;*/
    margin: 50px auto;
    padding: 15px 0;
    width: 326px;
    font-family: 'Conv_LITHOSPRO-REGULAR';
}
.or1 input {
    background-color: #303030;
    border: medium none;
    border-radius: 0.4em 0.4em 0.4em 0.4em;
    box-shadow: 0 -1px 0 0 #000000;
    color: #FFFFFF;

    font-size: 1.2em;
    height: 27px;
    letter-spacing: 2px;
    margin: 15px 0;
    padding: 0 0 0 10px;
    width: 316px;
}

.ico {
    float: right;
}

button {
    background: -moz-linear-gradient(center bottom , #303030, #3A3A3A) repeat scroll 0 0 transparent;
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(48,48,48,1)), color-stop(100%,rgba(58,58,58,1))); 
    background: -webkit-linear-gradient(top, rgba(48,48,48,1) 0%,rgba(58,58,58,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, rgba(48,48,48,1) 0%,rgba(58,58,58,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top, rgba(48,48,48,1) 0%,rgba(58,58,58,1) 100%); /* IE10+ */
    background: linear-gradient(to bottom, rgba(48,48,48,1) 0%,rgba(58,58,58,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#303030', endColorstr='#3a3a3a',GradientType=0 ); /* IE6-9 */
    border: medium none;
    border-radius: 0.2em 0.2em 0.2em 0.2em;

    -webkit-border-radius: .2em;
    box-shadow: 0 0 1px rgba(255, 255, 255, 0.1);
    color: #FFFFFF;
    float: right;
    height: 24px;
    text-align: right;
    width: 79px;
}

button:hover {
    background: -moz-linear-gradient(center bottom , #303030, #4B4B4B) repeat scroll 0 0 transparent;
}

button:active {
    border: medium none;
    box-shadow: 0 0 2px rgba(255, 255, 255, 0.2);
}

.note1 {

    padding-top: 40px;
    padding-left: 20px;
    font-size: 20px;
    text-align: center;
    color: #F74E09;

}

#search-form { width: 190px; position: absolute; right: 100px;
    bottom:55px;
    visibility: hidden; display: block;}
#search { background: #b2a48c; border: 3px solid #402f1d; color: #2b1e11; height: 20px; line-height: 20px; width: 150px; padding: 2px 4px; position: absolute; top: 11px; left: 0}
#search-submit { background: #b2a48c url(images/search.png) no-repeat 12px 7px; border: 3px solid #402f1d; height: 50px; width: 50px; position: absolute; top: 0; right: 0; display:block;}
#search-submit img {
    display: block;
}
#search-submit:hover { background-color: #c7bba7;}

/* CSS3 */
#search { border-radius: 20px; -moz-border-radius: 20px; -webkit-border-radius: 20px;
   background: -webkit-gradient(linear, left top, left bottom, from(#b2a48c), to(#9b8d74));
   background: -moz-linear-gradient(top, #b2a48c, #9b8d74);
   text-shadow: rgba(0,0,0,.2) 0 0 5px;
   display: inline;
   }
#search-submit { border-radius: 50px; -moz-border-radius: 50px; -webkit-border-radius: 50px; -mox-box-shadow: 0 0 5px black;display:block;
    /* Webkit-transition */
    -webkit-transition-property: background-color; 
    -webkit-transition-duration: 0.4s, 0.4s; 
    -webkit-transition-timing-function: linear, ease-in;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:33:17.963

在加载 js 之前使用 css 将 body 的可见性设置设置为隐藏，然后使用 jquery 删除带有 js onload 的属性。CSS：

```
 body { visibility: hidden;} 
```

javascript:

```
 $().ready(function(){ $("body").css({visibility:'visible'})}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:45:54.677

如果我正确理解了这个问题，请将其放入 testCSS.css ...

```
#numb1 { visibility:hidden; } 
```

或者...

```
#numb1 { display:none; } 
```

哪个更让你高兴。

这样做会在页面显示之前隐藏 numb1 元素。你所做的让页面在隐藏它然后淡入之前加载，所以它是短暂可见的。

# android - for 循环内的两个按钮 OnClickListener

> ID：11966139
> 
> 赞同：0
> 
> 时间：2012-08-15T08:26:12.720
> 
> 标签：android, button, android-button

我正在自学 Android，现在我正在学习如何使用按钮。我创建了一个简单的向上计数器，其工作原理如下：我在不同的文本字段中添加字符串（例如 1 2 3）。然后我想成对比较它们（1 与 2、1 与 3、2 与 3）。第一个字符串元素写在第一个按钮上，第二个写在第二个按钮上，在我按下任何这些按钮后，按钮上的标签必须更改（如果有 1 和 2，那么它应该更改为 1 和 3 或 2 和3等）并且字符串元素获得更高的排名。一切似乎都运行良好，但我认为我在添加按钮时犯了很大的错误。谁能帮我？:) 我可以像在下面的代码中那样添加按钮侦听器吗？：） 谢谢你！

```
public void counter() 
{
    int i = 0;
    int a = i + 1;

    for ( i = 0; i < candidates.size() - 1; i++ ) 
    {
            Log.d(TAG, "Setting button one tag: " + i );
            button_one.setTag(i);
            button_one.setText(candidates.get(i).name);

            for (a = i + 1; a < candidates.size(); a++)
            {
            Log.d(TAG, "Setting button two tag: " + a );
            button_two.setTag(a);
            button_two.setText(candidates.get(a).name);

            button_one.setOnClickListener(new View.OnClickListener() 
            {

                public void onClick(View view) {

                    /* Read the clicked tag */
                    int tag = (Integer) view.getTag();

                    /* Make higher rank */
                    candidates.get(tag).addRank();
                }
            });

            button_two.setOnClickListener(new View.OnClickListener() 
            {

                public void onClick(View view) {

                    /* Read the clicked tag */
                    int tag = (Integer) view.getTag();

                    /* Make higher rank */
                    candidates.get(tag).addRank();
                }
            }); 
            }       
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:36:23.907

一般来说，不需要在循环中添加点击侦听器，除非您动态地创建这些按钮。

在循环中为同一个按钮设置点击侦听器，每次循环循环时，只会覆盖以前的设置，所以我认为这样做没有任何意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:14:01.813

AndyRes 所说的一切加上：您正在创建 (candidates.size() * Candidates.size()) 数量的 OnClickListener，这是大量不必要的对象占用您的内存。

你应该在你定义你之后创建一个`OnClickListener mListener = new View.OnClickListener etc... etc...` 和外部循环`OnCreate()``button_one = (Button)findViewById(R.id.button_one);``button_one.setOnClickListener(mListener);`

这样，您只有 1 个侦听器可以为您可能拥有的任意数量的按钮提供服务，并且不需要再次设置同一个侦听器。

# asp.net - HTTP 错误 404.0 - 在 IIS 服务器上未找到 wcf 路由

> ID：11966151
> 
> 赞同：1
> 
> 时间：2012-08-15T08:27:01.303
> 
> 标签：asp.net, wcf, iis, .net-4.0, iis-7.5

我的 WCF 项目中有以下提到的设置，但是当我在 IIS 服务器中部署它时，当我尝试像这样访问我的网站时出现 404 错误：http: [//mysite.com/MyService](http://mysite.com/MyService) Global.asax：

```
public class Global : System.Web.HttpApplication
{

    protected void Application_Start(object sender, EventArgs e)
    {
        RouteTable.Routes.Add(new ServiceRoute("MyService", new AppServiceHostFactory(), typeof(UserService)));
    } 
```

我的服务.cs：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]

public class MyService : IMyService
{ 
```

网络配置：

```
<system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true">
        <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    </modules>
</system.webServer>

<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior name="">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
                               </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true"
                               aspNetCompatibilityEnabled="true"/>
</system.serviceModel> 
```

# asp.net - 从 2 个文本框读取时，对象引用未设置为对象的实例

> ID：11966153
> 
> 赞同：0
> 
> 时间：2012-08-15T08:27:05.180
> 
> 标签：asp.net

```
 for (int i = 0; i < parts.Count; i++)
        {
            if (!((part)parts[i]).deleteUsed)
                ((part)parts[i]).hints = ((TextBox)partsView.Rows[i].Cells[4].FindControl("textBox")).Text;
            ((part)parts[i]).PartsWaiting = ((TextBox)partsView.Rows[i].Cells[5].FindControl("textBox1")).Text;
        } 
```

**System.NullReferenceException：对象引用未设置为对象的实例**。

由于某种原因，我收到此错误，似乎不知道我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:33:24.570

您的问题部分是由于多个链接的尊重，例如

```
a.getB().getC().getD() 
```

如果其中一种方法返回 null，您将无法轻松识别发生了什么。

除非您非常确定自己在做什么，否则我会将上述内容分为以下两种：

1.  单独的行并分配中间变量。然后空值将变得明显。它所在的行
2.  `NullPtrException`一组在解析 null 时取消引用并抛出 a 的函数。同样，您的违规路线将立即变得明显。

您会注意到，上述内容并非针对您当前的问题。相反，当您无法确定链接方法在某个阶段不会返回 null 时，这是一种有用的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:31:43.393

FindControl 可能没有获取文本框。设置断点并观察`FindControl()`. 还要确保您在 FindControl 中使用的 ID 是正确的。

# c - 是否可以定义一个“（”被转义的宏？

> ID：11966160
> 
> 赞同：0
> 
> 时间：2012-08-15T08:27:29.243
> 
> 标签：c

我可以定义一个宏，如：

```
#define ERROR_REPORT(LEVEL,SUB_LEVEL printf( 
```

编译器抱怨这一行期望`;`. 有没有办法逃脱“（”？

这是为了替换一个函数：

```
 ERROR_REPORT(LEVEL,SUB_LEVEL
          "error, there is an error %d\n",
           error_id); 
```

带有 C 内置函数

```
 printf("error, there is an error %d\n",
         error_id); 
```

编辑：我只想替换一个“（”，不包括“）”。我问这个的原因是已经发布了一些代码，所以我只想将 ERROR_REPROT(... 之类的一行替换为 printf( 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T08:32:42.027

我建议你使用[可变参数宏](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html)：

```
#define ERROR_REPORT(LEVEL, SUB_LEVEL, ...) \
    printf(__VA_ARGS__) 
```

虽然你可以把任何你想要的东西作为宏的替代品，但你定义它是错误的：

```
#define ERROR_REPORT(LEVEL,SUB_LEVEL   printf(
/*      Error with missing `)` here ^ */ 
```

预处理器需要右括号，否则会导致预处理阶段出错。

此外，当您使用此宏时，您不能这样做：

```
ERROR_REPORT(LEVEL,SUB_LEVEL
      "error, there is an error %d\n",
       error_id); 
```

`SUB_LEVEL`预处理器也会在这里抛出错误，因为参数和字符串之间没有逗号。

因此，如果您可以替换单个左括号，这个问题的答案就是不，您不能。

# php - TCPDF 边距和自定义页面大小问题

> ID：11966162
> 
> 赞同：2
> 
> 时间：2012-08-15T08:27:33.120
> 
> 标签：php, format, margin, tcpdf

首先，我将定义为 A4 尺寸。

然后，当通过数据库中的一些动态计算找到页面宽度和高度时，我将使用`$resolution`.

我需要页边距顶部和左侧全部为零。

然后`setxy`将通过厘米测量将项目分配到绝对位置。

但是，它不断从左侧和顶部获得额外的边距空间......

打印时，我选择以实际尺寸打印

```
global $l;

$l = Array();
$l['a_meta_charset'] = 'UTF-8';
$l['a_meta_dir'] = 'ltr';
$l['a_meta_language'] = 'en';
$l['w_page'] = 'page';

require_once('../tcpdf.php');
$PDF_PAGE_FORMAT= 'A4';
$pdf = new TCPDF('L', 'cm', 'A4', true, 'UTF-8', false);
$pdf->SetPrintHeader(false);
$pdf->SetPrintFooter(false);
$pdf->SetHeaderMargin(0);
$pdf->SetFooterMargin(0);
$pdf->SetDefaultMonospacedFont('courier');
$pdf->SetMargins(0,0,0, true);
$pdf->SetAutoPageBreak(FALSE, 0);
$pdf->setLanguageArray($l);

$pdfWidth= "30";
$pdfHeight= "15";
$resolution= array($pdfWidth, $pdfHeight);

$pdf->AddPage('L', $resolution, $keepmargins=true);
$pdf->SetXY(1,2,true);
$pdf->SetFont('freesans','B',8);
$pdf->Cell(0,0,"test 123",0,1,'L');
$pdf->SetXY(20,7,true);
$pdf->SetFont('freesans','B',8);
$pdf->Cell(0,0,"Title 2",1,0,'L');

$pdfdata= $pdf->Output('test.pdf', 'S'); 
```

# cakephp - Cakephp 未定义索引

> ID：11966167
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:28:08.880
> 
> 标签：cakephp, indexing

创建视图时，我得到一个`undefined index error: Account` 在线`$senderName['Account']['company_name']`但在调试变量时，数组打印出来

```
array(
    (int) 0 => array(
        'Account' => array(
            'id' => '0',
            'street' => 'SYSTEM',
            'city' => 'SYSTEM',
            'postcode' => '0',
            'state' => 'SYS',
            'country' => 'SYS',
            'active' => true,
            'company_name' => 'SYSTEM',
            'abn' => '0'
        ),
        'Template' => array(),
        'User' => array(),
        'Invoice' => array()
    ), 
```

这是我的观点的代码

```
<?php foreach($invoice as $invoices):?>
                <?php foreach($senderName as $senderName):?>
                <?php foreach($receiverName as $receiverName):?>
                    <tr> 
                <tr>
                        <td align='center'><?php echo $senderName['Account']['company_name']; ?></td>
                        <td align='center'><?php echo $receiverName['Account']['company_name']; ?></td>
                        <td align='center'><?php echo $this->Form->Html->link($invoices['Invoice']['id'],
                                    array('controller' => 'Invoices','action'=>'viewinvoice',$invoices['Invoice']['id'])); ?></td>
                    </tr>
                <?php endforeach; ?>
                <?php endforeach; ?>
                <?php endforeach; ?> 
```

以防万一这是我的相关功能

```
 $accounts2=$this->User->find('list', array(
        'fields'=>array('account_id'),
        'conditions' => array(
        'id' => $this->Auth->user('id'))));

        $invoices=$this->Invoice->find('all', array(
        'conditions' => array(
        'Invoice.receiver_id' => $accounts2)));

        $sender=$this->Invoice->Find('list', array('fields'=>('sender_id')));
        $receiver=$this->Invoice->Find('list', array('fields'=>('receiver_id')));

        $senderName=$this->Account->Find('all', array(
        'conditions' => array(
        'id'=>array_values($sender))));

        $receiverName=$this->Account->find('all', array(
        'conditions' => array(
        'id'=>array_values($receiver))));
debug($senderName);

        $this->set('senderName', $senderName);
        $this->set('accounts2', $accounts2); 
        $this->set('receiverName', $receiverName); 
        $this->set('sender',$sender);
        $this->set('receiver',$receiver);
        $this->set('invoice', $invoices);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T10:29:38.820

你的电脑是对的。:)

```
$senderName['Account']['company_name'] 
```

不存在。

```
$senderName['0']['Account']['company_name'] 
```

做。

数据采用这种格式，因为它们可能是多个帐户喜欢发件人名称。

编辑：

你能在你的模型中给出关系吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:39:02.207

我认为您应该查看您的代码：

```
<?php foreach($senderName as $senderName):?>
<?php foreach($receiverName as $receiverName):?> 
```

在 foreach array_expression 和 value 变量应该不同，但您使用了相同的变量名，请为此使用不同的名称。

# php - PHP - 访问多维数组的问题

> ID：11966173
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:28:39.987
> 
> 标签：php, arrays, multidimensional-array

从我使用 FirePHP 检索的这个多维（？）数组中获取正确数据时遇到问题，以查看我正在使用的内容：

```
array(
    ['day'] => 'Wed'
    ['is_used'] => 1
    [0] =>
    array(
        ['day'] =>
        'Wed'
        ['title'] =>
        'onsdag denna veckan 2'
        ['content'] =>
        ['price'] =>
    )
    [1] =>
    array(

        ['day'] =>
        'Wed'
        ['title'] =>
        'onsdagslunchen'
        ['content'] =>
        ['price'] =>
        123123
    )
) 
```

如果有意义的话，我想在数组中使用 0, 1 数组...？还是这个数组坏了？

当我尝试

```
foreach ($foo as $bar){
    echo $bar
} 
```

我得到 4 个结果，day、is_used 和 0、1 数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:37:41.757

代码正确返回值。`$foo`它返回数组的第一个孩子，它们是：

```
day
is_used
0
1 
```

`day`and`is_used`是字符串，但是因为`0`and`1`是数组，所以您需要再次循环遍历它们以获取它们的值：

```
foreach ($foo as $fooKey=>$bar){
    if(is_array($bar))
        // cycle through the array
        foreach ($bar as $key=>$value)
            // Echo out the string of the array
            echo "$fooKey $key = $value<br />";
        }
    } else {
        // Echo out the string
       echo "$fooKey = $bar<br />";
    }
} 
```

这应该回显以下内容：

```
day = Wed
is_used = 1
0 day = Wed
0 title = onsdag denna veckan 2
0 content =
0 price =
1 day = Wed
1 title = onsdagslunchen
1 content =
1 price = 123123 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:36:26.543

也许这就是你想要的：

```
foreach ($my_array as $key=>$val) {
    if (is_numeric($key) {
        // do something with $val (where $val is an array in the example)
    }
} 
```

# c# - 单击 WebControl 内的文本框时显示虚拟键盘

> ID：11966178
> 
> 赞同：0
> 
> 时间：2012-08-15T08:29:20.157
> 
> 标签：c#, wpf

我创建了一个虚拟键盘，弹出 wpf 文本框控件的键盘。单击网页内的文本框时如何使键盘弹出？

显示文本框的逻辑如下：

```
static void TouchScreenKeyboardPropertyChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            FrameworkElement host = sender as FrameworkElement;
            if (host != null)
            {
                host.GotFocus += new RoutedEventHandler(OnGotFocus);
                host.LostFocus += new RoutedEventHandler(OnLostFocus);
            }
        }

    static void OnGotFocus(object sender, RoutedEventArgs e)
    {
        Control host = sender as Control;

        if (sender == typeof(TextBox))
        {
            _PreviousTextBoxBackgroundBrush = host.Background;
            _PreviousTextBoxBorderBrush = host.BorderBrush;
            _PreviousTextBoxBorderThickness = host.BorderThickness;

            host.Background = Brushes.Yellow;
            host.BorderBrush = Brushes.Red;
            host.BorderThickness = new Thickness(4);
        }

        _CurrentControl = host;

        if (_InstanceObject == null)
        {
            FrameworkElement ct = host;
            while (true)
            {
                if (ct is Window)
                {
                    ((Window)ct).LocationChanged += new EventHandler(TouchScreenKeyboard_LocationChanged);
                    ((Window)ct).Activated += new EventHandler(TouchScreenKeyboard_Activated);
                    ((Window)ct).Deactivated += new EventHandler(TouchScreenKeyboard_Deactivated);
                    break;
                }
                if(ct.Parent != null)
                ct = (FrameworkElement)ct.Parent;
            }

            _InstanceObject = new TouchScreenKeyboard();
            _InstanceObject.AllowsTransparency = true;
            _InstanceObject.WindowStyle = WindowStyle.None;
            _InstanceObject.ShowInTaskbar = false;
            _InstanceObject.ShowInTaskbar = false;
            _InstanceObject.Topmost = true;

           host.LayoutUpdated += new EventHandler(tb_LayoutUpdated);
        }
    }

    static void TouchScreenKeyboard_Deactivated(object sender, EventArgs e)
    {
        if (_InstanceObject != null)
        {
            _InstanceObject.Topmost = false;
        }
    }

    static void TouchScreenKeyboard_Activated(object sender, EventArgs e)
    {
        if (_InstanceObject != null)
        {
            _InstanceObject.Topmost = true;
        }
    }

    static void TouchScreenKeyboard_LocationChanged(object sender, EventArgs e)
    {
        syncchild();
    }

    static void tb_LayoutUpdated(object sender, EventArgs e)
    {
        syncchild();
    }

    static void OnLostFocus(object sender, RoutedEventArgs e)
    {

        Control host = sender as Control;
        host.Background = _PreviousTextBoxBackgroundBrush;
        host.BorderBrush = _PreviousTextBoxBorderBrush;
        host.BorderThickness = _PreviousTextBoxBorderThickness;

        if (_InstanceObject != null)
        {
            _InstanceObject.Close();
            _InstanceObject = null;
        }
    }

    #endregion
}

    private static void syncchild()
    {
        if (_CurrentControl != null && _InstanceObject != null)
        {

            Point virtualpoint = new Point(0, _CurrentControl.ActualHeight + 3);
            Point Actualpoint = _CurrentControl.PointToScreen(virtualpoint);

            if (WidthTouchKeyboard + Actualpoint.X > SystemParameters.VirtualScreenWidth)
            {
                double difference = WidthTouchKeyboard + Actualpoint.X - SystemParameters.VirtualScreenWidth;
                _InstanceObject.Left = Actualpoint.X - difference;
            }
            else if (!(Actualpoint.X > 1))
            {
                _InstanceObject.Left = 1;
            }
            else
                _InstanceObject.Left = Actualpoint.X;

            _InstanceObject.Top = Actualpoint.Y;
            _InstanceObject.Show();
        }
    }

 private static void SetKeyInBrowser(string key)
    {
        var elementName = (((mshtml.HTMLDocument)(dom)).activeElement).id;

        if (elementName != null)
        {
            var existingText = dom.getElementById(elementName).getAttribute("value");
            if (existingText == null)
            {
                existingText = "";
            }
            //if it's a backspace.
            if (isBackspace)
            {
                existingText = existingText.ToString().Remove(existingText.ToString().Length - 1);
                dom.getElementById(elementName).setAttribute("value", existingText.ToString());
            }
            else if (key.Length != 0)
            {
                dom.getElementById(elementName).setAttribute("value", existingText.ToString() + key[key.Length - 1]);
            }
        }
        isBackspace = false;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:39:18.600

您需要为此使用javascript。您需要知道该文本字段何时像这样聚焦： [检查焦点是否在文本字段上](https://stackoverflow.com/questions/6618289/check-if-focus-is-on-a-textfield)

然后，一旦在 JavaScript 上触发了焦点事件，您应该调用 WPF 函数来显示键盘。以下是有用的提示：

[如何以编程方式检查在 WPF 浏览器中加载的网页内的文本输入框是否具有焦点？](https://stackoverflow.com/questions/6059816/how-to-programmaticaly-check-if-a-text-input-box-inside-a-web-page-loaded-in-wpf)

# sql - 用于查找所有包含两列的表 ROWS 的 SQL 查询

> ID：11966185
> 
> 赞同：1
> 
> 时间：2012-08-15T08:29:34.757
> 
> 标签：sql, sql-server-2008

我有一个包含大约 +100 个表的数据库，比如一半的表有 A 列和 B 列。

我的问题是，我可以查询所有具有特定值的列的表，例如

> 从数据库中选择 *
> 
> 在哪里
> 
> EACHTABLE HAS COLUMN A = 21 //仅当表有列和值时
> 
> 和
> 
> B栏= 13

我不确定我会做多准确，谷歌也没有任何内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:51:10.820

`sp_MSforeachtable`如果您喜欢肆无忌惮地生活，您可以使用未记录的 MS 存储过程：

```
create table T1 (
    ColumnA int not null,
    ColumnB int not null
)
go
create table T2 (
    ColumnA int not null,
    Column2 int not null
)
go
create table T3 (
    Column1 int not null,
    ColumnB int not null
)
go
create table T4 (
    ColumnA int not null,
    ColumnB int not null
)
go
insert into T1 values (1,2);
insert into T2 values (3,4);
insert into T3 values (5,6);
insert into T4 values (7,8);
go
create table #Results (TableName sysname,ColumnA int,ColumnB int)
exec sp_MSforeachtable 'insert into #Results select ''?'',ColumnA,ColumnB from ?',
    @whereand = ' and syso.object_id in (select object_id from sys.columns where name=''ColumnA'') and syso.object_id in (select object_id from sys.columns where name=''ColumnB'')'
select * from #Results
drop table #Results 
```

结果：

```
TableName                             ColumnA     ColumnB
------------------------------------- ----------- -----------
[dbo].[T1]                            1           2
[dbo].[T4]                            7           8 
```

* * *

默认情况下，`sp_MSforeachtable`顾名思义，将为数据库中的每个表执行相同的任务。但是，此过程的一个可选参数称为`@Whereand`，可用于修改`WHERE`枚举数据库中的表的内部查询的子句。知道这个内部查询已经为某些系统视图建立了两个别名会有所帮助。`o`是`sysobjects`（遗留系统视图）的别名。`syso`是`sys.all_objects`（更现代的系统视图）的别名。

一旦`sp_MSforeachtable`决定了要针对哪些表运行，它将执行作为其第一个参数提供给它的查询。但是，它将替换`?`为架构和表名（`?`是默认替换字符。可以根据需要更改）

在这种情况下，我选择创建一个临时表，然后让每个选定的表将其结果存储到该临时表中，并在`sp_MSforeachtable`运行完成后，将组合结果选择出来，无需进一步处理。

有一个类似的（同样未记录的）过程`sp_MSforeachdb`将访问服务器上的每个用户数据库。这些甚至可以组合起来（尽管有时您必须小心将`'`引号字符加倍）。但是，没有等效的`sp_MSforeachcolumn`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:55:17.950

试试这个：

```
 select t.name from sys.objects t inner join sys.columns c
 on t.name=OBJECT_NAME(c.object_id)
 where t.type='U'
 and c.name in('col1','col2')
 group by t.name
 having COUNT(*) = 2
 order by 1 
```

然后，您只需遍历所有表并微调这些列的值。

像

```
Declare @out TABLE(tblname varchar(100))
if exists(select * from tbl1 where col1='21' and col2='22')
BEGIN
INSERT INTO @out
select tbl1
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:38:40.657

您可以尝试使用动态查询。

```
select 'select * from '+table_name+ ' where'+column_name+'=21'
from information_schema.columns where column_name = 'A' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:43:03.130

我建议使用两个步骤：首先，找出数据库中包含这两列的所有表，并将其用于时间派生表。因为我不是 SQL-Server 2008 方面的专家，所以我建议您查看白皮书。

表达式**可能**如下所示：

```
SELECT tablename
FROM information_schema.tables sdbt
WHERE "column a" IN
    (SELECT columns
     FROM information_schema.columns col
     WHERE col.tablename = sdbt.tablename) 
```

其次，使用表达式根据您的要求值过滤结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T08:48:16.043

此命令应该一次性完成，仅适用于 A 列，相应地修改以包含您需要的任何其他列：

```
exec sp_MSforeachtable
@command1=N'SELECT * FROM ? WHERE A = 21',
@whereand=' and o.name IN (SELECT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME = ''A'') ' 
```

# asp.net - 在asp.net c#中使用webservice发送大文件？

> ID：11966186
> 
> 赞同：2
> 
> 时间：2012-08-15T08:29:35.093
> 
> 标签：asp.net, web-services

我已经编写了以下代码，但它不起作用。将文件上传到 Web 服务时出现以下错误：

> `1.An operation on a socket could not be performed because the system lacked sufficient buffer space or because a queue was full`
> 
> `2.The underlying connection was closed: An unexpected error occurred on a send.`

我已将以下代码用于 Web 服务，当文件大小超过 90 mb 时出现错误：

```
LocalService.IphoneService obj = new LocalService.IphoneService();
byte[] objFile = FileToByteArray(@"D:\Brijesh\My Project\WebSite5\IMG_0010.MOV");
int RtnVal = obj.AddNewProject("demo", "demo", "demo@demo.com", "demo@demo.com", 1, 2,    29, "IMG_0010.MOV", objFile,"00.00.06");

public byte[] FileToByteArray(string fileName)
{
    byte[] fileContent = null;
    System.IO.FileStream fs = new System.IO.FileStream(fileName, System.IO.FileMode.Open, System.IO.FileAccess.Read);
    System.IO.BinaryReader binaryReader = new System.IO.BinaryReader(fs);
    long byteLength = new System.IO.FileInfo(fileName).Length;
    //byteLength = 94371840;
    fileContent = binaryReader.ReadBytes((Int32)byteLength);
    fs.Close();
    fs.Dispose();
    binaryReader.Close();
    return fileContent;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:45:48.670

没有套接字会在一个块中传输 200MB。您将接收到的数据块大多在 1024 到 4096 字节之间（取决于您的设置）。

1.  分块读取这些数据。
2.  在服务器上重新组装您的文件。
3.  然后根据需要使用这个接收到的文件，由字节组装而成。

对于 asp.net 网络服务：

[使webservice能够接收大量数据](http://msdn.microsoft.com/en-us/library/aa528822.aspx)

> 通过将配置元素添加到应用程序的 web.config 文件，增加 ASP.NET 对 SOAP 消息的最大大小和允许执行请求的最大秒数的限制。下面的代码示例将 ASP.NET 对传入请求的最大大小的限制设置为 400MB，并将允许执行请求的最长时间设置为 5 分钟（300 秒）。

把它放在你的 web.config 中。

```
<configuration>
  <system.web>
  <httpRuntime maxMessageLength="409600"
    executionTimeoutInSeconds="300"/>
  </system.web>
</configuration> 
```

请记住，只要处理此请求，您就会阻塞线程。这不适用于大量用户。

# php - URL/robots.txt 的 PHP file_exists() 返回 false

> ID：11966187
> 
> 赞同：1
> 
> 时间：2012-08-15T08:29:42.600
> 
> 标签：php, robots.txt

我尝试使用 file_exists(URL/robots.txt) 来查看该文件是否存在于随机选择的网站上，但我得到了错误的响应；

如何检查 robots.txt 文件是否存在？

我不想在我检查之前开始下载。

使用 fopen() 可以解决问题吗？因为：成功时返回文件指针资源，错误时返回 FALSE。

我想我可以这样说：

```
$f=@fopen($url,"r"); 
if($f) ... 
```

我的代码：

[http://www1.macys.com/robots.txt](http://www1.macys.com/robots.txt) 也许不存在 [http://www.intend.ro/robots.txt](http://www.intend.ro/robots.txt) 也许不存在 [http://www.emag.ro/robots.txt](http://www.emag.ro/robots.txt) 也许不存在那里 [http://www1.bloomingdales.com/robots.txt](http://www1.bloomingdales.com/robots.txt) 也许它不在那里

```
try {
            if (file_exists($file)) 
                {
                echo 'exists'.PHP_EOL;
                $curl_tool = new CurlTool();
                $content = $curl_tool->fetchContent($file);
                //if the file exists on local disk, delete it
                if (file_exists(CRAWLER_FILES . 'robots_' . $website_id . '.txt'))
                    unlink(CRAWLER_FILES . 'robots_' . $website . '.txt');
                echo CRAWLER_FILES . 'robots_' . $website_id . '.txt', $content . PHP_EOL;
                file_put_contents(CRAWLER_FILES . 'robots_' . $website_id . '.txt', $content);
            }
            else
            {
                echo 'maybe it\'s not there'.PHP_EOL;
            }
        } catch (Exception $e) {
            echo 'EXCEPTION ' . $e . PHP_EOL;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T08:33:47.020

`file_exists`不能用于其他网站的资源。它适用于本地文件系统。[在这里](http://www.brightcherry.co.uk/scribbles/php-check-if-file-exists-on-different-domain/)查看如何正确执行检查。

正如其他人在评论中提到的那样，并且链接说它（可能）最容易使用`get_headers`函数来做到这一点：

```
try {
    if (strpos(get_headers($url,1),"404")!==FALSE){
        ... your code ...
    } else {
        ... you get the idea ...
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T08:37:14.890

只是为了支持其他人所说的，

最好在 php 中使用 cURL 来确定[http://example.com/robots.txt](http://example.com/robots.txt)是否返回 404 状态码。如果是，则该文件不存在。如果它返回 200，则表示它存在。

不过要小心自定义 404 页面，我从来没有想过要找出它们返回的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T08:35:07.803

[`http://``stat()`](http://ca.php.net/manual/en/wrappers.http.php)包装器[不支持](http://ca.php.net/manual/en/wrappers.http.php)[`file_exists()`需要](http://php.net/manual/en/function.file-exists.php)[的](http://ca.php.net/manual/en/wrappers.http.php)[功能](http://ca.php.net/manual/en/wrappers.http.php)；您将需要检查来自例如 cURL 的 HTTP 响应代码。

> 从 PHP 5.0.0 开始，这个函数也可以与一些 URL 包装器一起使用。请参阅支持的协议和包装器以确定哪些包装器支持 stat() 系列功能。

# zend-framework - 如何在 zend 路由中使用可选参数

> ID：11966188
> 
> 赞同：1
> 
> 时间：2012-08-15T08:29:52.783
> 
> 标签：zend-framework, frameworks, routing, routes, zend-route

我想使用可选参数为标准路由器设置类似的路由，例如：

```
intranet.route = 'intranet/:controller/:action/:title/:id' 
```

只有 id 参数不需要值。我尝试给它一个默认值，比如*null* - 但是变量仍然设置，但是当用户没有给它任何值时，我根本不希望它存在

另外，我如何设置具有动态值的路线，就像这样：

*内网/index/index/Front%20Page/123/foo/bar*

那么变量 $foo 存在，其值为“bar”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:33:00.823

您可以为 application.ini 中的参数设置默认值，例如

```
resources.router.routes.intranet.defaults.id = null 
```

或者，如果您想设置动态路线，您可以使用 *

```
intranet.route = 'intranet/:controller/:action/:title/* 
```

这使得标题后的变量是可选的。

# grails - grails 组合键更新

> ID：11966189
> 
> 赞同：0
> 
> 时间：2012-08-15T08:29:54.133
> 
> 标签：grails, grails-orm

我有一个遗留数据库，我正在使用 Grails。错误＃1。

它使用复合键。错误 #2。

给定这些域类：

```
Movie {
    static hasMany = [ roles: Role ]
}
Person {
    static hasMany = [ roles: Role ]
}
Role {
    Movie movie
    Person person
    String foo
} 
```

我想将角色从一个人转移到另一个人，如下所示：

```
Role x = person1.roles[0]
x.person = person2
save(flush:true) 
```

但什么也没有发生。完全没有。我在 log4j 中为休眠打开了跟踪和调试级别日志记录，它没有显示更新语句。但是，如果我这样做：

```
Role x = person1.roles[0]
x.person = person2
x.foo = "i can haz update?"
save(flush:true) 
```

foo 确实发生了更新，但指向 person 的外键没有被修改，如下所示：

```
DEBUG hibernate.SQL  - update ct_roles set foo=? where movie_id=? and person_id=?
TRACE sql.BasicBinder  - binding parameter [1] as 'i can haz update?'
TRACE sql.BasicBinder  - binding parameter [2] as [BIGINT] - 999
TRACE sql.BasicBinder  - binding parameter [3] as [BIGINT] - 2 
```

请注意，person_id 2 属于 person2，目前还没有角色，因此更新失败。

那么，除了简单地删除旧角色并创建一个附加到所需人员的新角色之外，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:34:36.187

尝试：

person1.removeFromRoles(role) *//role 是要从中删除人员的角色对象*
role.person = person2

应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T22:28:18.553

答案是：

```
class Role { 
    Movie movie
    Person person
    String fuGorm

    def move(Person newbie) {
        def m = this.movie?.id
        def p = this.person?.id
        def n = newbie?.id

        // bypass GORM and issue a raw SQL update command...
        def q = "update ct_roles set person_id=$n where person_id=$p and movie_id=$m"
        def success = runCommand(q)

        if (success) {
            // the above bypasses GORM, so we should still
            // perform the operation using GORM speak
            // otherwise our objects will be out of sync with the DB.
            // The following EPIC FAILS to update the DB, 
            // but it does update the local Grails domain objects
            this.person.removeFromRoles(this)
            this.person = newbie
            newbie.addToRoles(this)
        }
        return success
    }
    def runCommand = { query ->
        def db = new Sql(dataSource)
        db.execute (query)
    }
} 
```

# perl - Perl 脚本，用于查找用户在 Perforce 中对工作区所做的添加/编辑或删除操作

> ID：11966193
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:30:22.823
> 
> 标签：perl, perforce

perforce 列出用户提交的文件，即 p4 更改 -u 我想做的是在 perl 中编写一个小函数，它将查找用户提交了哪些更改 对这些更改执行了哪些操作，即添加、编辑或删除并打印那些 . 所以逻辑是这样的 1\. 查找用户提交的更改 2\. 对这些更改结果执行了哪些操作：用户在日期之后提交了 5 个更改列表...在所有更改中找到 5 个添加、2 个删除和 1 个编辑操作.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:54:39.323

目前还不清楚你在绊倒什么。

*   如果它从 Perl 连接到 perforce，您可以为此目的使用几个 CPAN 模块之一：请参阅谷歌搜索[“CPAN perforce”](https://www.google.com/#hl=en&safe=off&sclient=psy-ab&q=cpan+perforce)中的第一个命中。

*   如果您希望`p4 changes -u`从命令行解析 STDOUT 输出，请发布命令的确切输出格式、到目前为止您尝试解析它的内容以及程序所需的匹配输出。

# asp.net-mvc-3 - 从模型创建图表。（asp.net mvc3 中的 MS 图表控件）

> ID：11966197
> 
> 赞同：0
> 
> 时间：2012-08-15T08:30:40.577
> 
> 标签：asp.net-mvc-3, redirecttoaction, microsoft-chart-controls

我正在尝试在视图中创建图表，内容（名称/系列/类型等）都将由用户在视图中选择的控件确定。

只要我加载一个已经创建的图表一切都很好，例如：

在我的视野中：

```
 <controls above my graph>

  <img src="@Url.Action("StatusGraph")"/>

     <controls below my graph> 
```

控制器内部

```
 //Creates status graph as specified by the controls in parent partial view or using          defaults
     public ActionResult StatusGraph(){
         return View();
     } 
```

最后是 StatusGraph 视图：（[本微软教程](http://www.asp.net/web-pages/tutorials/data/7-displaying-data-in-a-chart) 使用的通用图表作为示例）

```
@{
// TODO: use the data from the model to draw a chart

var myChart = new Chart(width: 600, height: 400)
    .AddTitle("Chart title")
    .AddSeries(
        name: "Employee",
        xValue: new[] {  "Peter", "Andrew", "Julie", "Mary", "Dave" },
        yValues: new[] { "2", "6", "4", "5", "3" })
    .Write();
  } 
```

正如我所说，这完美地工作并且实际上在父视图中呈现图表，而不是在它自己的单独窗口中（真的是微软，为什么？），但是一旦我尝试扩展 StatusGraph 方法以接受参数（只是图表标题开始）并将其传递给 StatusGraph 当浏览器尝试加载图片时，我收到 404 错误。

当我在扩展的 StatusGraph 方法中设置断点时，我尝试将标题传递给视图，代码永远不会停止，就好像它永远不会被调用一样。

我的问题是：我怎样才能使这项工作？如何将数据从视图传递到动作到另一个视图。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:37:06.650

您可以/应该使用视图模型：

```
public class MyViewModel
{
    public string Title { get; set; }
} 
```

接着：

```
public ActionResult StatusGraph(MyViewModel model)
{
    return View(model);
} 
```

最后：

```
@model MyViewModel
@{
    var myChart = new Chart(width: 600, height: 400)
        .AddTitle(Model.Title)
        .AddSeries(
            name: "Employee",
            xValue: new[] {  "Peter", "Andrew", "Julie", "Mary", "Dave" },
            yValues: new[] { "2", "6", "4", "5", "3" })
        .Write();
} 
```

并在渲染图表时传递值：

```
<img src="@Url.Action("StatusGraph", new { title = "Chart title" })"/> 
```

当然，这些值也可以在您的控制器操作中定义，而不是将它们作为参数传递给`img`源：

```
public ActionResult StatusGraph()
{
    var model = new MyViewModel
    {
        // TODO: could come from a database or something
        Title = "Chart title"
    };
    return View(model);
} 
```

# google-apps-script - 遇到错误：发生意外错误

> ID：11966201
> 
> 赞同：0
> 
> 时间：2012-08-15T08:31:08.050
> 
> 标签：google-apps-script

我做了一些简单的代码测试来弄清楚这个 Google-Apps-Script 是如何工作的。

现在我面临一条错误消息，我不知道是什么原因。一切都像我想要的那样工作，但运行代码以错误消息“遇到错误：发生意外错误”结束

我在我的网页上将此代码作为 Apps-script-gadget 运行。

请帮助初学者！:-)

这里的代码：

函数 doGet(e) {

```
var app1 = UiApp.createApplication();  
app1.add(app1.loadComponent("Panel1")); //Panel1 made with UI-tool
var but1 = app1.getElementById("Button1");
var handler = app1.createServerClickHandler('func1');
but1.addClickHandler(handler);

return app1; 
```

}

函数 func1(e) {

```
var app2 = UiApp.getActiveApplication();

app2.getElementById("TextBox1").setText("BigBrother");

return app2; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:05:17.273

当使用`getElementById()`没有 ID 的元素时，通常会发生这种情况...如果您的 TextBox1 确实设置了具有正确值的 ID，请在 GUI 构建器中检查。

编辑：这是一个屏幕截图。 ![在此处输入图像描述](../Images/d8160aea241c9244fd58385570c698e5.png)

并嵌入网站：

![在此处输入图像描述](../Images/835187dbf0e17c9b5758dd4740f170ac.png)

![在此处输入图像描述](../Images/2500bb3f871c1d4a24f3077943df5ce8.png)

# liferay - 在 Liferay 中为浏览器 IE 7 使用基于表格的布局

> ID：11966204
> 
> 赞同：0
> 
> 时间：2012-08-15T08:31:33.677
> 
> 标签：liferay

我有这个代码，

```
#if ($browserSniffer.isIe($request) && $browserSniffer.getMajorVersion($request) < 8) 
```

在 Liferay 的页面布局中告诉他们为浏览器 IE 7 使用基于表格的布局，但我收到以下警告：

```
Invalid character used in text string ( #if($browserSniffer.isIe($request) && $browserSniffer.getMajorVersion($request) < 8) ). 
```

问题似乎是 AND (&&) 参数，但我没有看到任何问题。所以，如果有人能告诉我问题是什么，我将不胜感激。

在此先感谢，阿迪亚。

* * *

## 更新：布局文件

```
<div class="default-page-template" id="main-content" role="main">
   #if ($browserSniffer.isIe($request) && $browserSniffer.getMajorVersion($request) < 8)
    <table class="portlet-layout">
            <tr>
                <td class="portlet-column portlet-column-first" id="column-1">
                    $processor.processColumn("column-1", "portlet-column-content portlet-column-content-first")
                </td>
                <td class="portlet-column portlet-column-last" id="column-2">
                    $processor.processColumn("column-2", "portlet-column-content portlet-column-content-last")
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="portlet-column portlet-column-first" id="column-3">
                    $processor.processColumn("column-3", "portlet-column-content portlet-column-content-first")
                </td>
            </tr>
        </table>

        <table class="portlet-layout">
            <tr>
                <td class="portlet-column portlet-column-first" id="column-4">
                    $processor.processColumn("column-4", "portlet-column-content portlet-column-content-first")
                </td>
                <td class="portlet-column" id="column-5">
                    $processor.processColumn("column-5", "portlet-column-content portlet-column-content-last")
                </td>
                <td class="portlet-column portlet-column-last" id="column-6">
                    $processor.processColumn("column-6", "portlet-column-content portlet-column-content-last")
                </td>
            </tr>
        </table>

        <table class="portlet-layout">
            <tr>
                <td class="portlet-column portlet-column-last" id="column-7">
                    $processor.processColumn("column-7", "portlet-column-content portlet-column-content-last")
                </td>
            </tr>
        </table> 
    #else
        <div class="portlet-layout">
            <div class="portlet-column portlet-column-first" id="column-1">
                $processor.processColumn("column-1", "portlet-column-content portlet-column-content-first")
            </div>

            <div class="portlet-column portlet-column-last" id="column-2">
                $processor.processColumn("column-2", "portlet-column-content portlet-column-content-last")
            </div>
        </div>

        <div class="portlet-layout">
            <div class="portlet-column portlet-column-first" id="column-3">  
                $processor.processColumn("column-3", "portlet-column-content portlet-column-content-first")
            </div>
        </div>

        <div class="portlet-layout">
            <div class="portlet-column portlet-column-first" id="column-4">
               $processor.processColumn("column-4", "portlet-column-content portlet-column-content-first")
            </div>

            <div class="portlet-column" id="column-5">
                $processor.processColumn("column-5", "portlet-column-content portlet-column-content-last")
            </div>

            <div class="portlet-column portlet-column-last" id="column-6">
            $processor.processColumn("column-6", "portlet-column-content portlet-column-content-last")
            </div>          
        </div>

        <div class="portlet-layout">
            <div class="portlet-column portlet-column-first" id="column-7">
                $processor.processColumn("column-7", "portlet-column-content portlet-column-content-first")
            </div>
        </div>

    #end
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T12:25:44.533

您可以轻松确定和解决 && 问题，如果这确实是问题 - 尽管它是速度处理逻辑运算符的方式：

```
#if ($browserSniffer.isIe($request))
  #if($browserSniffer.getMajorVersion($request) < 8)
     ... (your stuff here)
  #end
#end 
```

如果不是，至少您在语句的一半中收到新的错误消息，并且可以从那里继续调试。

你在什么样的文件里有这个？布局模板？主题？

# javascript - Javascript 函数 - 通过引用复制，但这里发生了什么？

> ID：11966208
> 
> 赞同：0
> 
> 时间：2012-08-15T08:31:40.467
> 
> 标签：javascript, function, reference, variable-assignment

给定 JavaScript 中的函数是引用类型（通过引用复制，与简单类型不同），这里到底发生了什么？

```
var func = function() { alert(1); };
var func_alias = func;
var func = function() { alert(2); };
func_alias(); //1 
```

如果`func_alias`是对 的引用`func`，**为什么它不更新？您不希望它的调用（第 4 行）返回`2`吗？**

这是与其他引用示例不同的行为：

```
var obj = {prop: 'val'};
var obj_alias = obj;
obj.prop = 'updated val';
alert(obj_alias.prop); //updated val - not original one 
```

`func_alias`似乎保留了原始的预覆盖副本`func`- 简而言之，它似乎表现得好像它是按价值复制的。这当然被以下事实证明是不成立的：

```
var func = function(){}
var func_alias = func;
func === func_alias; //true 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:45:17.583

`var func = function() { alert(1); };`

这里创建了一个新函数，并将对它的引用复制到`func`

`var func_alias = func;`

存储的函数引用`func`被分配给另一个变量`func_alias`

`var func = function() { alert(2); };`

另一个新函数被创建并且对它的引用被分配给`func`. 对存储在其中的第一个函数的引用`func`丢失。但是由于您`func_alias`在覆盖之前保存了它`func`，因此仍然可以调用它。

`func_alias();`

`func_alias`在步骤 2 中被分配了对第一个函数的引用（并且在那之后没有被覆盖）。所以第一个函数被调用。

* * *

**编辑#1**

根据您使用对象的第二个示例：

```
var obj = {prop: 'val'}; 
```

在这里，创建了一个新对象并将对它的引用分配给`obj`

```
var obj_alias = obj; 
```

引用被复制到另一个变量 obj_alias

```
obj.prop = 'updated val'; 
```

在这里，您不会覆盖 的值`obj`，而只是覆盖存储在 obj 中的引用所指向的对象的属性。的值`obj`（即对第一步创建的对象的引用）保持不变。

在您的函数示例中，您实际上是`func`用新的函数引用覆盖了变量。

```
alert(obj_alias.prop); 
```

的 和 的值仍然相同，因为您也没有覆盖`obj_alias`。`obj`它们都持有对第 1 步中创建的对象的引用。

* * *

**编辑#2**

这可以用**C**语言很好地解释。

*   当您通过创建对象时`var obj = {prop: 'val'};`- 假设该对象存储在内存中的地址 0x0001 处。即obj的实际值为0x0001

*   当您将其分配给 时`obj_alias`，`obj_alias`也会获得值 0x0001 - 现在两个变量都指向存储在地址 0x0001 的内容

*   当您这样做时`obj.x = y`，您不会覆盖 的值`obj`，而只是`obj`用于访问存储在 0x0001 的对象并修改其属性之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:33:58.750

不同的是

在第一段代码中，您让一个变量引用另一个对象。

在第二段代码中，你改变了对象的属性，这两个变量是指同一个对象。

```
var func = function() { alert(1); };
var func_alias = func; // func_alias refer to the first function.
var func = function() { alert(2); }; // let func refer to another function, but won't affect func_alias
func_alias(); //1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:44:13.890

如果您认为您的程序代码是一个允许您存储和使用对象的大型仓库。
然后您的代码执行以下操作：
第 1 行 - 让我们存储函数 SOMEWHERE 并且我（第一个变量）会记住它的位置 [您没有（也不能）在此处指定特定位置]。
第 2 行 - 让其他人也记住函数的存储位置。
第 3 行 - 让我们在 SOMEWHERE 存储另一个函数，我（第一个变量）会记住它在哪里[你没有（也不能）在此处指定特定位置]。
第 4 行 - 询问第 2 行的人我的职能在哪里。

你预期的结果是什么？

# c# - 混合模式程序集是针对运行时版本“v2.0.50727”构建的，无法在 4.0 运行时中加载

> ID：11966213
> 
> 赞同：4
> 
> 时间：2012-08-15T08:32:01.207
> 
> 标签：c#, visual-studio-2010, command-line

在命令行执行中运行可执行文件后出现此异常：

**“混合模式程序集是针对运行时版本‘v2.0.50727’构建的，如果没有额外的配置信息，则无法在 4.0 运行时中加载。”**

在互联网上搜索此问题后，我发现其中一种方法是配置 App.Config 文件。这在 VS2010 中运行良好，但在命令模式下仍会产生相同的错误。

那么有没有办法通过使用命令行来解决这个问题，因为生成更新版本的 .dll 是不可能的。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T20:45:23.113

你也可以试试 useLegacyV2RuntimeActivationPolicy="true"

```
 <startup useLegacyV2RuntimeActivationPolicy="true">
      <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
    </startup> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-16T04:25:07.360

确保您已配置 App.config 和 ProgramName.exe.config 文件。

例如：

```
<configuration>
    <startup>
      <supportedRuntime version="v2.0.50727"/>
   </startup>
 </configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T06:18:49.217

另一种解决方案可以是重新编译所有依赖于 .NET 4.0 的混合 (C++/CLI) 程序集。如果这些组件是第三方，通常是不可能的。

# sql-server - nhibernate 为 postgres 记录 sql 但不为 sql server

> ID：11966214
> 
> 赞同：0
> 
> 时间：2012-08-15T08:32:13.603
> 
> 标签：sql-server, nhibernate, fluent-nhibernate

我是 nhibernate 的新手（但以前在 java 中使用过 hibernate）。

我为我们的 sql server 数据库（sql server 企业版 8）建立了一个会话工厂

```
ISessionFactory factory2 = Fluently.Configure()
  .Database(MsSqlConfiguration.MsSql2008
    .ConnectionString(@"user id=xx; password=xxx;server=xxx;initial catalog=xxx")
    .ShowSql()
  )
  .Mappings(m => m.FluentMappings
    .AddFromAssemblyOf<Program>())
  .ExposeConfiguration(cfg => new SchemaValidator(cfg).Validate())
  .BuildSessionFactory(); 
```

所以我使用该`ShowSql()`方法将查询记录到控制台。

在我的程序中，我加载/创建两个对象并希望保留它们，然后对列进行更新：

```
using (var session = sf.OpenSession())
{
    session.FlushMode = FlushMode.Always;
    using (var ta = session.BeginTransaction())
    {
        Console.ReadKey();
        PMA pm = session.CreateCriteria<PMA>()
            .Add(Restrictions.Eq("Name", "HANSER")).List<PMA>().FirstOrDefault();
        if (pm == null)
        {
            pm = new PMA();
            pm.Prio = "1";
            pm.Name = "HANSER";
            pm.Datum = DateTime.Now;
            session.Save(pm);
        }

        Clip clip = new Clip();
        clip.PMA = pm;
        clip.sys_created = DateTime.Now;
        clip.sys_name = "system name";
        clip.Title = "Test";
        session.Save(clip);

        Console.ReadKey();

        clip.Title = "PETERSEN";
        session.SaveOrUpdate(clip);
        session.Transaction.Commit();
        session.Flush();
        session.Dispose();

        Console.ReadKey();
    }
} 
```

pm 对象的第一个插入将记录在控制台上，但剪辑对象的另一个插入和更新不会出现在控制台中。当我查看数据库时，我发现一切正常，一切都将被插入和更新。但我想查看查询。我尝试将刷新模式设置为始终，并在最后对会话进行 session.Flush()，然后是 session.Dispose()，但没有任何变化。

当我使用 postgres（仅更改 sessionfactory）时，我会看到所有查询日志。如何让 nhibernate 记录 sql server 的所有查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:53:20.207

使用 ADO.NET 批处理时（在支持它的 SQL Server 中默认启用），DML 查询不会记录到控制台。

# python - spynner 我如何点击登录按钮？

> ID：11966216
> 
> 赞同：0
> 
> 时间：2012-08-15T08:32:40.490
> 
> 标签：python, login, spynner

我想访问 vk.com - 我所做的就是：

```
>>> import spynner as s
>>> b = s.Browser()
>>> b.load('http://vk.com')
True
>>> b.wk_fill('input[#name=email]', 'my@mail.ru')
>>> b.wk_fill('input[name=pass]', 'my_secret_password')
>>> b.create_webview()
>>> b.show() 
```

它向我展示了[https://picasaweb.google.com/108465638371111457481/SpynnerExperiments#5776810930419210290](https://picasaweb.google.com/108465638371111457481/SpynnerExperiments#5776810930419210290) 之后如何通过 spynner 单击登录按钮？

完整的追溯和我的尝试你可以在这里看到：http: [//dumpz.org/245555/](http://dumpz.org/245555/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:11:04.340

这对我有用（使用[这个 spynnner](https://github.com/makinacorpus/spynner)）：

```
import spynner
b = spynner.Browser()
b.show()
b.load('http://vk.com')
b.wk_fill('input[name=email]', 'my@mail.ru')
b.wk_fill('input[name=pass]', 'my_secret_password')
b.click("#quick_login_button")
b.browse() # this way we see wha's going on 
```

# c# - 组织内的应用程序共享

> ID：11966220
> 
> 赞同：0
> 
> 时间：2012-08-15T08:33:02.143
> 
> 标签：c#, windows-phone-7, marketplace

如何共享我的 windows phone 7 应用程序以进行内部共享。就像我在应用程序上创建的一样，我想与公司利益相关者分享。或者第二种情况是我为一些私人公司制作了我的应用程序，他们不想在市场上分享或发布。他们只是想在公司和组织内使用这个应用程序。

任何想法我们如何分享这个应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:37:35.813

IIRC 当您对您的应用程序进行 Beta 测试时（前提是您拥有 AppHub 会员资格），您可以为您的应用程序指定一些私人测试人员，尽管我认为这仅限于 10 人左右。我认为您不能发布私人应用程序。

[来源](http://www.winrumors.com/windows-phone-app-hub-updated-to-include-private-marketplace-for-beta-apps/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:37:51.670

我认为您可以使用 Sharepoint 来做到这一点。

看看这个：http: [//msdn.microsoft.com/en-us/sharepointandwindowsphone7trainingcourse_creatingprivateapplicationslab.aspx](http://msdn.microsoft.com/en-us/sharepointandwindowsphone7trainingcourse_creatingprivateapplicationslab.aspx)

我做了更多的研究，应该有一个叫做“[企业市场](http://blog.wpfwonderland.com/2011/04/15/mango-adds-beta-and-private-marketplaces-to-windows-phone-7-and-neglects-enterprise/)”的东西。您仍将应用程序发布到普通市场，但只有具有直接 (Zune) 链接的人才能下载该应用程序。它在公共市场上是找不到的。

随着 Windows Phone 8 的推出，将有可能创建一个“[公司中心](http://techie-buzz.com/tech-news/wp8-enterprise-features.html)”

# ios - 无法将模拟指标设置为更改

> ID：11966222
> 
> 赞同：1
> 
> 时间：2012-08-15T08:33:04.157
> 
> 标签：ios, xcode, storyboard

我有一个 UIViewController 与一个 UITableViewController 相连，它本身嵌入在 UINavigationController 中。

在 Utilities 检查器的 Attributes 窗格中，我已将 Top Bar 设置为 Translucent Black Navigation Bar（在 Simulated Metrics 下）。

这在 UITableViewController 中工作得很好，但我在 UIViewController 中的视图在导航栏后面向后滑动，如此处所述[，](https://stackoverflow.com/questions/1091971/problem-when-set-navigationbar-to-black-translucent-style)所以我想我会尝试将 Utilities inspector > Attributes pane > Simulated Metrics > Top Bar 的默认设置更改为黑色导航栏。

没用。似乎我无法推断任何模拟指标。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:40:34.543

只是为了检查您的理解......模拟指标就是状态栏/标签栏等在界面生成器中的显示方式。这些不会影响正在运行的应用程序。

更改状态栏类型最简单的地方是在目标的 info.plist 中：

![在此处输入图像描述](../Images/ff887e9897e05cfbef3273f169b4218f.png)

要以编程方式更改它，只需使用：

```
[UIApplication sharedApplication].statusBarStyle = UIStatusBarStyleBlackOpaque; 
```

更改导航栏样式

```
self.navigationController.navigationBar.barStyle = UIBarStyleBlackOpaque; 
```

# android - 视图未保存在屏幕方向开关上

> ID：11966223
> 
> 赞同：0
> 
> 时间：2012-08-15T08:33:04.443
> 
> 标签：android

该应用程序应该保存它在方向更改时绘制的视图，但它没有。谁能说出问题出在哪里？

我没有收到任何错误，但是当我更改设备方向时，视图会重新启动，而不会保存我绘制的内容。

```
public DrawingView(Context context, AttributeSet attrs) {
    super(context, attrs);
    conAdd();
}

public DrawingView(Context context) {
    super(context);
    conAdd();

}

private void conAdd() {
    paint = new Paint(Paint.ANTI_ALIAS_FLAG);
    paint.setColor(Color.GREEN);
    paint.setStyle(Style.STROKE);
    paint.setStrokeCap(Paint.Cap.ROUND);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(width);
    path = new Path();
    setOnTouchListener(this);
    setBackgroundColor(Color.BLACK);

}

@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {
    bitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_4444);
    Canvas canvasNew = new Canvas();
    canvasNew.setBitmap(bitmap);
    canvas = canvasNew;
    super.onSizeChanged(w, h, oldw, oldh);
}

@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    canvas.drawPath(path, paint);
    canvas.drawBitmap(bitmap, 0, 0, paint);
}

public boolean onTouch(View v, MotionEvent event) {
    float x = event.getX();
    float y = event.getY();
    if (event.getAction() == MotionEvent.ACTION_DOWN) {
        path.reset();
        path.moveTo(x, y);
        invalidate();
    }
    if (event.getAction() == MotionEvent.ACTION_MOVE) {
        if (Math.abs(x - lastX) > 4 || Math.abs(y - lastY) > 4) {
            path.quadTo(lastX, lastY, (lastX + x) / 2, (lastY + y) / 2);
            invalidate();

        }

    }

    if (event.getAction() == MotionEvent.ACTION_UP) {
        path.lineTo(x, y);

        canvas.drawPath(path, paint);
    }

    lastX = x;
    lastY = y;
    return true;

}

 @Override
    protected Parcelable onSaveInstanceState() {
        Bundle inBox = new Bundle();
        inBox.putParcelable("draw", super.onSaveInstanceState());
        inBox.putParcelable("bitmap", bitmap);
        return super.onSaveInstanceState();

    }

 @Override
    protected void onRestoreInstanceState(Parcelable state) 
    {
         if (state instanceof Bundle) {
              Bundle outBox = (Bundle) state;
              this.bitmap = outBox.getParcelable("bitmap");
              super.onRestoreInstanceState(outBox.getParcelable("draw"));
              return;
         }
         super.onRestoreInstanceState(state);
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-28T10:31:48.353

您正在返回`super.onSaveInstanceState();`而不是返回您自己的捆绑包 ( `inBox`)。因此，您保存的数据不会做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T21:50:09.523

您是否尝试过使用

```
<activity android:name=".YourActivity" android:configChanges="orientation|screenSize"> 
```

?

请注意，虽然单独的*“方向”*可能无法提供它，但添加*“screenSize”*选项就可以了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-14T22:17:02.587

您的功能不正确：

```
@Override
public void onSaveInstanceState(Bundle savedInstanceState){
    // Your code here

    // Call at the end
    super.onSaveInstanceState(savedInstanceState);
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState){
    // Call at the start
    super.onRestoreInstanceState(savedInstanceState);

    // Your code here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:39:54.010

您需要在运行时管理配置更改 - 我也花了很长时间才找到它：

[http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)

**引用：**
以下清单代码声明了一个处理屏幕方向更改和键盘可用性更改的活动：

```
<activity android:name=".MyActivity"
    android:configChanges="orientation|keyboardHidden"
    android:label="@string/app_name"> 
```

# python - 将修改后的列表导出到 CSV

> ID：11966231
> 
> 赞同：0
> 
> 时间：2012-08-15T08:33:41.927
> 
> 标签：python, list, csv, export-to-csv

我有一个大列表，包含一系列 id 和相关值，极短的版本如下所示：

```
large = [('5501', [(4, 5, 8), (6, -4, -6)]), ('2222', [(2, 4, -5), (1, -15, 4)])] 
```

我的目标是将修改后的“大”（带有添加）版本导出到 Excel *（每个值都有自己的单独单元格 - 即 5501 在 A1 中，在 A2 中为 4，在 B2 中为 5，在 C2 中为 8...第一个空格将在 A4 等）*中，如下所示：

**输出到 Excel 的所需表格**

```
5501 
4,5,8 
6,-4,-6
'space here'
'Sorted absolutes maxes'
8, 6, 5
'space here'     
2222 
2,4,-5 
1,-15,4
'space here'
'Sorted absolutes maxes'
15, 5, 2
'space here' 
```

我已经能够使用以下代码导出上述所需的形式：

```
import csv
with open("out1.csv", "wb") as fp: 
   writer = csv.writer(fp, delimiter=",")     
   for entry in large:        
       writer.writerow([entry[0]])         
       for line in entry[1]:             
           writer.writerow(line)        
       writer.writerow([]) 
```

但是，它没有所需的**排序绝对值（即忽略任何“-”符号）最大值** ，如上述**所需形式**。这是我需要帮助的地方 - 非常感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T11:57:09.550

`abs`首先，您可以通过像这样映射元组来获得绝对值

```
map(abs, entry[1][0]) 
map(abs, entry[1][1]) 
```

然后，您可以通过首先使用 zip 创建位置对来获得成对最大值

```
zip(map(abs, entry[1][0]), map(abs, entry[1][1])) 
```

然后再次将这些对映射到它们各自的最大值：

```
map(max, zip(map(abs, entry[1][0]), map(abs, entry[1][1]))) 
```

现在您所要做的就是将它们从最大值排序到最小值并将它们写入您的文件：

```
with open("out1.csv", "wb") as fp: 
   writer = csv.writer(fp, delimiter=",")     
   for entry in large:        
       writer.writerow([entry[0]])         
       for line in entry[1]:             
           writer.writerow(line)        
       writer.writerow([])
       writer.writerow(['Sorted absolute maxes'])
       maxima = map(max, zip(map(abs, entry[1][0]), map(abs, entry[1][1])) )
       writer.writerow(sorted(maxima, reverse=True))
       writer.writerow([]) 
```

这给了我以下输出：

```
5501
4,5,8
6,-4,-6

Sorted absolute maxes
8,6,5

2222
2,4,-5
1,-15,4

Sorted absolute maxes
15,5,2 
```

# exception - Sharepoint 中的 CatchAccessDeniedException 和 SuppressAccessDeniedRedirectInScope 之间的区别

> ID：11966236
> 
> 赞同：2
> 
> 时间：2012-08-15T08:34:08.773
> 
> 标签：exception, sharepoint-2010, access-denied

他们都做同样的事情吗？

还是行为上有区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T21:39:01.010

`SuppressAccessDeniedRedirectInScope`是一个实现`IDisposable`. 构造函数存储原始值`CatchAccessDeniedException`并将值设置为`false`以抑制使用范围内的自动重定向。该`Dispose`方法恢复 的原始值`CatchAccessDeniedException`。

# c - 用 C 编写结构的规则是否因 Turbo C++ 编译器和 GCC 而异？

> ID：11966240
> 
> 赞同：-2
> 
> 时间：2012-08-15T08:34:45.790
> 
> 标签：c, gcc, structure, typedef, turbo-c++

我在 C 中有一个单链表程序。当我在 TC++ 上编译它时，它只有 2 个关于某些声明的错误（很好）。但是当我使用 GCC 在 Ubuntu 中编译它时，它有太多的错误。我为结构的成员创建了一个名为 NODE 的自定义数据类型，但 GCC 不会接受它。因为我使用了 typedef，所以有一个错误说 -

```
expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘struct’ 
```

我错过了什么规则？请帮我！

* * *

这是代码：

```
#include<stdio.h>
typdef struct node
{
    int data;
    NODE *next;
}NODE;

//Creation Of the Nodes with NULL pointers
NODE* createnewnode()
{
    NODE* nn;
    nn=(NODE*)malloc(sizeof(NODE));
    if(nn==NULL)
    {
        printf("Insufficient Memory");
        exit(0);
    }
    printf("Enter data");
    scanf("%d",&nn->data);
    nn->next=NULL;
    return(nn);
}

// Creation Of the Links
NODE* createlinkedlist(NODE *hn, int n)
{
    NODE *cn, *nn;
    for(i=0;i<n;i++);
    {
        nn=createnewnode();
        if(hn==NULL)
        {
            hn=nn;
        }
else
        {
            cn->next==nn;
        }
    cn=nn;
    return(hn);
}

//Display of The Data
void display(NODE *hn)
{

    NODE *cn;
    for(cn=hn;cn!=NULL;cn=cn->next)
    {
        printf("\t %d, "cn->data);
    }
}

//Linear Searching
void search(NODE *hn, int n)
{
    NODE *cn;
    int i, x;
    printf("Enter the data to be found");
    scanf("%d",&x);
    i=0;
    while(i<n)
    {
        if(x==cn->data)
        {
            printf("Data found at %d",i+1);
            break;
        }

        cn=cn->next;
        i=i++;
    }
}

void main()
{
    int n;
    NODE* hn=NULL;
    printf("Enter the number of nodes to be created");
    scanf("%d",&n);
    createlinkedlist(hn,n);
    display(hn);
} 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:10:07.160

即使已更正`typedef`，您也不能`NODE`在其自己的声明中使用。先做一个前向声明`NODE`，或者更好地称之为`node`：

```
typedef struct node node;
struct node {
  ...
  node* next;
}; 
```

*编辑：*和其他挑剔：

*   不要投射`malloc`. 如果您觉得需要它，那么您在其他地方就错了。（这里你不包括`stdlib.h`）
*   因为 long C 不再有变量的默认类型。你`i`的 in`createlinkedlist`是未知的，没有现代编译器会让它通过
*   您至少有一个地方使用`==`运算符而不是赋值`=`。始终在启用所有警告的情况下进行编译，任何体面的编译器都应该发现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-17T07:36:36.603

// 上面问的代码更正，但是程序员的一些逻辑是不正确的。

```
#include <cstdlib>
#include <iostream>
#include<stdio.h>

using namespace std;

typedef struct node // typedef spell
{
    int data;
   node *next;  // NODE was in upper case it should be in lower case
   node() //Constructor : i defined it in traditional way as extra
    {
        next = NULL;
        data = 0;
    }

}NODE;

//Creation Of the Nodes with NULL pointers
NODE* createnewnode()
{
    NODE* nn;
    nn=(NODE*)malloc(sizeof(NODE));
    if(nn==NULL)
    {
        printf("Insufficient Memory");
        exit(0);
    }
    printf("Enter data");
    scanf("%d",&nn->data);
    nn->next=NULL;
    return(nn);
}

// Creation Of the Links
NODE* createlinkedlist(NODE *hn, int n)
{
    NODE *cn, *nn;
    int i;           // int i, was not defined, more correction fixed 
    for(i=0;i<n;i++);
    {
        nn=createnewnode();
        if(hn==NULL)
        {
            hn=nn;
        }
else
        {
            cn->next==nn;
        }
    cn=nn;
    return(hn);
}
}
//Display of The Data
void display(NODE *hn)
{

    NODE *cn;
    for(cn=hn;cn!=NULL;cn=cn->next)
    {
        printf("\t %d", cn->data);
    }
}

//Linear Searching
void search(NODE *hn, int n)
{
    NODE *cn;
    int i, x;
    printf("Enter the data to be found");
    scanf("%d",&x);
    i=0;
    while(i<n)
    {
        if(x==cn->data)
        {
            printf("Data found at %d",i+1);
            break;
        }

        cn=cn->next;
        i=i++;
    }
}

int  main()
{
    int n;
        NODE* hn=NULL;
    printf("Enter the number of nodes to be created");
    scanf("%d",&n);
    createlinkedlist(hn,n);
    display(hn);
    system("pause");
    return 0;
} 
```

# generics - Ada 泛型和汇编代码生成

> ID：11966247
> 
> 赞同：2
> 
> 时间：2012-08-15T08:35:11.353
> 
> 标签：generics, assembly, compiler-construction, ada, gnat

我想知道是否有办法从 Ada 泛型中获得更小/更高效的汇编代码。

例如，我编写了一个小的虚拟 Ada 程序 (main.adb) 来显示一个通用过程并实例化它 6 次：

```
with Ada.Text_Io;
procedure Main is

   generic
      X : Natural;
      with procedure Bob (S : in String);
   procedure Thing_Gen (S : in String);

   procedure Thing_Gen (S : in String) is
   begin
      for I in 0 .. X loop
         Bob (Natural'Image (I) & " " & S);
      end loop;
   end Thing_Gen;

   procedure Alice (S : in String) is
   begin
      Ada.Text_Io.Put_Line ("Alice:" & S);
   end Alice;

   procedure Aaa is new Thing_Gen (X => 1, Bob => Alice);
   procedure Baa is new Thing_Gen (X => 2, Bob => Alice);
   procedure Caa is new Thing_Gen (X => 3, Bob => Alice);
   procedure Daa is new Thing_Gen (X => 4, Bob => Alice);
   procedure Eaa is new Thing_Gen (X => 5, Bob => Alice);
   procedure Faa is new Thing_Gen (X => 6, Bob => Alice);

begin

   Aaa("A");
   Baa("B");
   Caa("C");
   Daa("D");
   Eaa("E");
   Faa("F");

end Main; 
```

为了编译，`gnatmake main.adb`当我查看结果时，`objdump -d -S main > main.dump`我看到每个通用实例都有 6 个部分：

```
000000000040275f <main__baa.2182>:
  40275f:   55                      push   %rbp
  402760:   48 89 e5                mov    %rsp,%rbp 
```

... <剪辑>

```
0000000000402a05 <main__caa.2187>:
  402a05:   55                      push   %rbp
  402a06:   48 89 e5                mov    %rsp,%rbp 
```

... < 剪辑 > 等等...

每个都有非常相似的代码，所以我怀疑正在发生的是 gnatmake`Thing_Gen`用作模板并扩展每个实例化的代码，而不是使用某些参数重用代码。

所以问题是，如何让 gnatmake 重用泛型的代码，而不是为每个实例复制/粘贴？

我本来希望实例化采用以下形式：

1.  设置 Baa / 应用通用参数（我知道`X`有`This_Value` & 程序`Bob`在`This_Address`）
2.  调用`Thing_Gen`（然后使用设置来产生预期的结果）

导致`Thing_Gen`代码重用。但情况似乎并非如此。也欢迎解释为什么我是汇编程序和编译器问题的菜鸟！

注意：Sparc 和 Intel 的结果相同！（英特尔 gnatmake 版本 4.4.3）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T11:06:43.550

我不认为你可以让 Gnat 做共享泛型，因为泛型的代码生成是编译器实现者的设计选择问题，而 AdaCore 选择复制。

根据[这个线程](http://coding.derkeiler.com/Archive/Ada/comp.lang.ada/2010-07/msg00515.html)，RR 和 Irvine 可能支持共享泛型。

# javascript - $resource `get` 函数如何在 AngularJS 中同步工作？

> ID：11966252
> 
> 赞同：43
> 
> 时间：2012-08-15T08:35:31.800
> 
> 标签：javascript, angularjs

我正在观看[这个](http://www.youtube.com/watch?v=IRelx4-ISbs)AngularJS 教程，该教程描述了如何使用 Angular 资源连接到 Twitter。（[视频教程](http://www.youtube.com/watch?v=IRelx4-ISbs)）这是在示例控制器中设置的资源：

```
$scope.twitter = $resource('http://twitter.com/:action',
    {action: 'search.json', q: 'angularjs', callback: 'JSON_CALLBACK'},
    {get: {method: 'JSONP'}}); 
```

本教程显示有几种方法可以使用`get`调用从资源中取回数据。第一种方法是将回调传递给 get 函数。ajax 请求返回后，将使用结果调用回调：

```
$scope.twitter.get(function(result) {
    console.log('This was the result:', result);
}); 
```

我理解这种方法。这对我来说很有意义。该资源代表网络上一个可以获取数据的地方，`get`只需对 url 进行 ajax 调用，获取 json，然后使用 json 调用回调函数。参数是那个`result`json。

这对我来说很有意义，因为很明显这是一个异步调用。也就是说，在幕后，ajax 调用会触发，并且调用之后的代码不会被阻塞，它会继续执行。然后在稍后的某个不确定点，当 xhr 成功时，回调函数被调用。

然后教程显示了一种看起来简单得多的不同方法，但我不明白它是如何工作的：

```
$scope.twitterResult = $scope.twitter.get(); 
```

我假设下面的 xhr`get`必须是异步的，但在这一行中，我们将`get`调用的返回值分配给一个变量，就好像它同步返回一样。

我不理解这一点是错的吗？这怎么可能？我认为它真的很好用，我只是不明白。

我知道它可以在它下面的 xhr 关闭并异步处理时`get`返回*一些东西*`$scope.twitterResult`，但是如果您自己遵循代码示例，您将看到在执行任何后续行之前获取实际的 twitter 内容。例如，如果您`console.log($scope.twitterResult)`在该行之后立即写入，您将在控制台中看到来自 twitter 的结果，而不是稍后替换的临时值。

更重要的是，因为这是可能的，我如何编写一个利用相同功能的 Angular 服务？除了 ajax 请求之外，还有其他类型的数据存储需要异步调用，可以在 JavaScript 中使用，我希望能够以这种风格同步编写代码。例如，索引数据库。如果我能理解 Angular 的内置资源是如何做到的，我会试一试。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-08-15T08:56:39.037

$resource 不是同步的，尽管此语法可能表明它是：

```
$scope.twitterResult = $scope.twitter.get(); 
```

这里发生的是对 AngularJS 的调用将在调用后立即返回`twitter.get()`，**结果是一个空数组。然后，当异步调用完成并且真实数据从服务器到达时，数组将更新为 data**。AngularJS 将简单地保留对返回数组的引用，并在数据可用时填充它。

这是发生“魔术”的 $resource 实现的片段：[https ://github.com/angular/angular.js/blob/master/src/ngResource/resource.js#L372](https://github.com/angular/angular.js/blob/master/src/ngResource/resource.js#L372)

这在[**$resource 文档**](http://docs.angularjs.org/api/ngResource.%24resource)中也有描述：

> 重要的是要意识到调用 $resource 对象方法会立即返回一个空引用（对象或数组取决于`isArray`）。从服务器返回数据后，现有参考将填充实际数据。这是一个有用的技巧，因为通常将资源分配给模型，然后由视图呈现。拥有一个空对象不会导致渲染，一旦数据从服务器到达，那么该对象就会被数据填充，并且视图会自动重新渲染自身以显示新数据。这意味着在大多数情况下，我们不必为操作方法编写回调函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-26T17:23:59.127

$q 也可以做到这一点。您可以使用以下方法将普通对象转换为“延迟值”：

```
var delayedValue = function($scope, deferred, value) {
    setTimeout(function() {
        $scope.$apply(function () {
            deferred.resolve(value);
        });
    }, 1000);
    return deferred.promise;
}; 
```

然后在控制器中使用它，以获得与 $scope.twitter.get() 在 OP 示例中所做的类似的效果

```
angular.module('someApp', [])
.controller('someController', ['$scope', '$q', function($scope, $q) {
  var deferred = $q.defer();
  $scope.numbers = delayedValue($scope, deferred, ['some', 'numbers']);
}]); 
```

# magento - Magento 自定义选项在购物车/结帐页面中显示价格

> ID：11966256
> 
> 赞同：0
> 
> 时间：2012-08-15T08:36:02.830
> 
> 标签：magento

我试图在购物车页面和结帐页面中显示自定义选项的每个价格。

所以我更改了这个文件：app/code/core/Mage/Catalog/Helper/Product/Configuration.php 在第 75 行

```
 $options[] = array(
                    'label' => $option->getTitle(),
                    'value' => $group->getFormattedOptionValue($itemOption->getValue()),
                    'print_value' => $group->getPrintableOptionValue($itemOption->getValue()),
                    'option_id' => $option->getId(),
                    'option_type' => $option->getType(),
                    'custom_view' => $group->isCustomizedView(),

                    //##my changing
                   'my_price' => $option->getPrice()
                ); 
```

但这仅适用于字段，当我的自定义选项是选择框或单选按钮时不起作用。

有人可以帮忙吗，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-16T04:18:47.237

打开你的模板文件

**app/design/frontend/default/theme/template/checkout/cart/item/default.phtml**

找到 foreach 循环：

```
<?php foreach ($_options as $_option) : ?> 
```

在该 foreach 循环中，添加以下代码：

```
<?php

        $optionId = $_option['option_id'];
        $product = $_item->getProduct();
        $option = $product->getOptionById($optionId);
        $itemOption = $_item->getOptionByCode('option_' . $option->getId());
        $price = false;
        foreach ($option->getValues() as $values) {
            if ($values->getId() == $itemOption['value']) {
                $price = $values->price;
            }
        }
        if ($price !== false) {
            echo Mage::helper('core')->currency($price);
        }

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T11:33:22.760

不确定你是否已经解决了你的问题，但作为参考，这是我所做的..

自定义选项价格仅可从 product 对象获得，而不是 item 对象（可从 cart/item/default.phtml 模板中轻松获得）。您必须从项目 ($_item->getProductId()) 中找到产品 ID，然后加载该产品。从那里您将要加载产品选项，遍历自定义选项选择值（在我的情况下）并在选项值 id 与产品和项目对象（[http://subesh.com）匹配时提取价格。 np/2009/12/custom-options-product-magento/](http://subesh.com.np/2009/12/custom-options-product-magento/)以获得更多帮助）。

希望这可以帮助您上路:)

# active-directory - LDAP 连接字符串

> ID：11966261
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:36:21.440
> 
> 标签：active-directory, ldap

我有这个 LDAP 连接字符串：`connectionString="LDAP://username:password@10.10.10.246:389/DC=ABC,DC=local"`

活动目录服务器`ABC.local`带有 IP `10.10.10.246`。

我正在使用此代码从活动目录中读取属性：

```
MembershipSection membershipSection = (MembershipSection)WebConfigurationManager.GetSection("system.web/membership");
    string defaultProvider = membershipSection.DefaultProvider;
ProviderSettings providerSettings = membershipSection.Providers[defaultProvider];
string connectionStringName = providerSettings.Parameters["connectionStringName"];
string connectionString = WebConfigurationManager.ConnectionStrings[connectionStringName].ConnectionString;
DirectoryEntry ent = new DirectoryEntry(connectionString);
string name = ent.Properties["l"].Value.ToString();
string Language = ent.Properties["st"].Value.ToString(); 
```

但出现一个错误说`"The server is not operational."`。我是在用连接字符串做任何事情还是正在发生什么。你帮帮我好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T08:05:08.717

这是关于ServerFault 和[StackOverFlow中的](https://stackoverflow.com/questions/5359721/whats-the-connection-string-for-ldap)[LDAP 连接字符串的说明](https://serverfault.com/questions/130543/how-can-i-figure-out-my-ldap-connection-string)

您不应该在连接字符串中使用 IP 地址，这是一个坏习惯。在你的情况下，我认为它应该是这样的：`LDAP://ABC.local/DC=ABC,DC=local`。

每次您需要在 AD 中搜索对象时都可以使用它：`LDAP://OU=Users,DC=ABC,DC=local`等等。

关于身份验证，这里有[一个解释](https://stackoverflow.com/questions/5359721/whats-the-connection-string-for-ldap)，它为您提供：

`DirectoryEntry dirEntry = new DirectoryEntry(connectionString, username, password);`

我希望这有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-02T12:34:53.587

您的连接字符串不正确，您应该使用另一个连接字符串并以不同的方式初始化 DirectoryEntry 条目：

```
string connectionString="LDAP://10.10.10.246/DC=ABC,DC=com"; // You can use also simple "LDAP://DC=ABC,DC=com" without IP
DirectoryEntry ent = new DirectoryEntry(connectionString, userName, password);
string name = ent.Properties["name"].Value.ToString(); // Note that property 'l' has friendly name 'City', it's unavailable for domain object! 
```

# matlab - 计算图像中的水平线和垂直线

> ID：11966268
> 
> 赞同：3
> 
> 时间：2012-08-15T08:36:49.253
> 
> 标签：matlab, image-processing

谁能帮我计算图像中水平和垂直线的数量

这是 OCR 特征提取项目的一部分

多谢

更多信息 ：

" 我的项目是在图像中寻找数字 所以它的 OCR 项目

我在 Matlab 中使用神经网络

但我的问题是我应该将什么功能发送到网络“

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:43:54.280

如果您刚刚开始并且不知道该怎么做，请查看：

[https://stackoverflow.com/questions/850717/what-are-some-popular-ocr-algorithms](https://stackoverflow.com/questions/850717/what-are-some-popular-ocr-algorithms)

这是在 C# 中实现的。

这是一个做 OCR 的项目，可能对你也有用：

[http://www.codeproject.com/Articles/160868/AC-Project-in-Optical-Character-Recognition-OCR-U](http://www.codeproject.com/Articles/160868/A-C-Project-in-Optical-Character-Recognition-OCR-U)

或者这可能是一些用处，在搜索了一段时间之后 Tesseracts 似乎是相关的：

[http://code.google.com/p/tesseract-ocr/downloads/detail?name=tesseract-ocr-setup-3.01-1.exe&can=2&q=](http://code.google.com/p/tesseract-ocr/downloads/detail?name=tesseract-ocr-setup-3.01-1.exe&can=2&q=)

祝你好运

# tomcat - 在 Lucene 中索引 500,000 个用户时的频繁 GC (ParNew)

> ID：11966271
> 
> 赞同：0
> 
> 时间：2012-08-15T08:37:00.017
> 
> 标签：tomcat, lucene, garbage-collection, tomcat6, terracotta

我们在 Lucene 中索引了大量的用户信息，一次分批运行 500 个。在索引时，我看到非常频繁的 GC (ParNew)。这是正常行为还是我应该研究 GC 调整？

```
2012-08-15 10:33:06,136 INFO  LuceneIndex-INFO - Indexing operations number for User index: 500 / batch size: 500
2569.177: [GC 2569.177: [ParNew: 35167K->1679K(38336K), 0.0136120 secs] 582353K->548865K(4190080K), 0.0138380 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
2569.501: [GC 2569.502: [ParNew: 35791K->2304K(38336K), 0.0153980 secs] 582977K->549490K(4190080K), 0.0156060 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
2570.061: [GC 2570.061: [ParNew: 36416K->2383K(38336K), 0.0419800 secs] 583602K->550107K(4190080K), 0.0421810 secs] [Times: user=0.04 sys=0.00, real=0.04 secs] 
2570.495: [GC 2570.495: [ParNew: 36495K->3327K(38336K), 0.0156630 secs] 584219K->551277K(4190080K), 0.0158750 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2571.002: [GC 2571.002: [ParNew: 37439K->2196K(38336K), 0.0163630 secs] 585389K->550513K(4190080K), 0.0165770 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
2571.581: [GC 2571.581: [ParNew: 36308K->2599K(38336K), 0.0318710 secs] 584625K->551456K(4190080K), 0.0320840 secs] [Times: user=0.04 sys=0.00, real=0.03 secs] 
2572.154: [GC 2572.154: [ParNew: 36711K->2806K(38336K), 0.0256790 secs] 585568K->552168K(4190080K), 0.0259410 secs] [Times: user=0.04 sys=0.00, real=0.03 secs] 
2572.769: [GC 2572.769: [ParNew: 36918K->2781K(38336K), 0.0270240 secs] 586280K->552530K(4190080K), 0.0273190 secs] [Times: user=0.04 sys=0.00, real=0.03 secs] 
2573.440: [GC 2573.440: [ParNew: 36893K->2771K(38336K), 0.0179540 secs] 586642K->552988K(4190080K), 0.0182890 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
2574.002: [GC 2574.002: [ParNew: 36883K->3823K(38336K), 0.0178490 secs] 587100K->554556K(4190080K), 0.0181850 secs] [Times: user=0.04 sys=0.00, real=0.02 secs] 
2574.417: [GC 2574.417: [ParNew: 37935K->2550K(38336K), 0.0346110 secs] 588668K->553727K(4190080K), 0.0348370 secs] [Times: user=0.04 sys=0.00, real=0.04 secs] 
2575.001: [GC 2575.001: [ParNew: 36662K->2824K(38336K), 0.0169600 secs] 587839K->554396K(4190080K), 0.0171800 secs] [Times: user=0.04 sys=0.00, real=0.01 secs] 
2575.586: [GC 2575.587: [ParNew: 36936K->3126K(38336K), 0.0173760 secs] 588508K->555255K(4190080K), 0.0177080 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2576.143: [GC 2576.143: [ParNew: 37238K->2125K(38336K), 0.0181420 secs] 589367K->554934K(4190080K), 0.0184010 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2576.640: [GC 2576.640: [ParNew: 36237K->2038K(38336K), 0.0179820 secs] 589046K->555251K(4190080K), 0.0182770 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
2577.148: [GC 2577.148: [ParNew: 36150K->2999K(38336K), 0.0169140 secs] 589363K->556690K(4190080K), 0.0172490 secs] [Times: user=0.04 sys=0.00, real=0.02 secs] 
2577.687: [GC 2577.687: [ParNew: 37111K->2951K(38336K), 0.0182880 secs] 590802K->557188K(4190080K), 0.0184980 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2578.180: [GC 2578.180: [ParNew: 37063K->3038K(38336K), 0.0197550 secs] 591300K->557791K(4190080K), 0.0200550 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2578.569: [GC 2578.570: [ParNew: 37136K->3104K(38336K), 0.0213140 secs] 591889K->558271K(4190080K), 0.0215390 secs] [Times: user=0.03 sys=0.00, real=0.03 secs] 
2578.608: [GC 2578.608: [ParNew: 37216K->1994K(38336K), 0.0167620 secs] 592383K->557626K(4190080K), 0.0169510 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2578.638: [GC 2578.638: [ParNew: 36079K->1685K(38336K), 0.0140540 secs] 591711K->557938K(4190080K), 0.0142940 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2578.666: [GC 2578.666: [ParNew: 35797K->1196K(38336K), 0.0180850 secs] 592050K->557998K(4190080K), 0.0182930 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2579.027: [GC 2579.027: [ParNew: 35308K->763K(38336K), 0.0123190 secs] 592110K->557885K(4190080K), 0.0125280 secs] [Times: user=0.02 sys=0.01, real=0.02 secs] 
2579.592: [GC 2579.592: [ParNew: 34875K->3337K(38336K), 0.0200230 secs] 591997K->560478K(4190080K), 0.0202360 secs] [Times: user=0.03 sys=0.00, real=0.02 secs] 
2580.223: [GC 2580.223: [ParNew: 37449K->2553K(38336K), 0.0390630 secs] 594590K->562692K(4190080K), 0.0392720 secs] [Times: user=0.04 sys=0.00, real=0.04 secs] 
2580.704: [GC 2580.705: [ParNew: 36665K->1774K(38336K), 0.0137640 secs] 596804K->561913K(4190080K), 0.0140930 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:15:23.947

我想说的是正常行为：从上面的日志来看，看起来 JVM 花费了大约 4% 的时间来取出正常的垃圾（每次清理约 0.02 秒，每 1/2 秒）。
这个问题是从哪里来的：你甚至认为这个过程很慢吗？或者你只是确保它是正常的？

一般来说，如果您在批处理模式下进行索引，因此不太关心系统响应能力而更关心总吞吐量，那么您将希望使用吞吐量收集器作为您的[GC 策略来运行。](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html#1.1.%20Types%20of%20Collectors%7Coutline)

# paypal - Mass Pay操作中如何检查每笔付款？

> ID：11966273
> 
> 赞同：1
> 
> 时间：2012-08-15T08:37:06.120
> 
> 标签：paypal, masspay

我想使用 Mass Pay 操作向用户发送付款，但我找不到如何检查收到的付款和未收到的付款。

以下是来自 www.x.com 的文字：

```
The response from a Mass Pay call signals only success or failure for the call, it does not
indicate the status of each individual transaction. To help account for your payouts, sign up
for the daily Transaction Details report, which collects the status of your individual 
transactions. You can also manually track your transactions by logging into your PayPal account 
to view the details and status of each of your Mass Pay payouts. 
```

我搜索了交易详情报告，但找不到使用它的示例。

如何发送一些关于交易详情报告或其他检查方式的电话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T00:27:48.643

您可以“收听”即时付款通知 (IPN)。

[IPN 文档](https://cms.paypal.com/cms_content/US/en_US/files/developer/IPNGuide.pdf)

# python - 忽略在库中抛出和捕获的异常

> ID：11966276
> 
> 赞同：6
> 
> 时间：2012-08-15T08:37:13.403
> 
> 标签：python, debugging, exception, pycharm

我使用的 Python 标准库和其他库（例如 PyQt）有时会在非错误条件下使用异常。看看下面除了函数`os.get_exec_path()`。它使用多个`try`语句来捕获在尝试查找某些环境数据时引发的异常。

```
try:
    path_list = env.get('PATH')
except TypeError:
    path_list = None

if supports_bytes_environ:
    try:
        path_listb = env[b'PATH']
    except (KeyError, TypeError):
        pass
    else:
        if path_list is not None:
            raise ValueError(
                "env cannot contain 'PATH' and b'PATH' keys")
        path_list = path_listb

    if path_list is not None and isinstance(path_list, bytes):
        path_list = fsdecode(path_list) 
```

这些异常并不表示错误，而是在正常情况下抛出。当对这些异常之一使用异常断点时，调试器也会中断这些库函数。

在 PyCharm 或 Python 中，有没有办法让调试器在不涉及我的代码的情况下在库中抛出和捕获的异常不会中断？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-01-17T14:03:19.953

在 PyCharm 中，转到 Run-->View Breakpoints，然后选中“On raise”和**“Ignore library files** ”。

[![选项菜单的屏幕截图](../Images/eacc230e4db4751af5be4c3c4c04f5cf.png)](https://i.stack.imgur.com/sjFvh.png)

第一个选项使调试器在引发异常时停止，而不是仅在程序终止时停止，第二个选项为 PyCharm 提供忽略库文件的策略，从而主要在您的代码中搜索。

由于[CrazyCoder](https://stackoverflow.com/users/104891/crazycoder)的功能请求[链接](https://youtrack.jetbrains.com/issue/PY-6396)已被添加，因此找到了解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-17T22:30:54.583

有一段时间，我有一个复杂的计划，其中涉及以下内容：

```
try( Closeable ignore = Debugger.newBreakSuppression() )
{
   ... library call which may throw ...
} <-- exception looks like it is thrown here 
```

这让我永远不会被库调用中抛出和吞没的异常所困扰。如果一个异常被库调用抛出并且没有被捕获，那么它看起来好像它发生在右大括号处。

它的工作方式如下：

`Closeable``AutoCloseable`是一个在没有声明任何检查异常的情况下扩展的接口。

`ignore`只是一个名称，告诉 IntelliJ IDEA 不要抱怨未使用的变量，这是必要的，因为愚蠢的 java 不支持`try( Debugger.newBreakSuppression() )`.

`Debugger`是我自己的类，带有调试相关的辅助方法。

`newBreakSuppression()`是一种方法，它将创建某个`BreakSuppression`类的线程本地实例，它会注意到我们希望中断异常被暂时挂起的事实。

然后我有一个带有中断条件的异常断点，它将调用我的`Debugger`类来询问是否可以中断，如果实例化了任何对象，`Debugger`该类将以“否”响应。`BreakSuppression`

这非常复杂，因为虚拟机在我的代码加载之前抛出异常，因此在程序启动期间无法评估过滤器，并且调试器会弹出一个对话框抱怨而不是忽略它。（我不是在抱怨，我讨厌无声的错误。）所以，我必须有一个可怕的，可怕的，不要在家里尝试这个的破解，中断条件看起来像这样：`java.lang.System.err.equals( this )` 通常，这会从不返回 true，因为`System.err`不等于抛出异常，因此调试器永远不会中断。但是，当我的`Debugger`类被初始化时，它将替换`System.err`为它自己的一个类，它提供了一个实现`equals(Object)`并`true`在调试器中断时返回。所以，基本上，我正在使用`System.err`作为一个永恒的全局变量。

最终我放弃了整个方案，因为它过于复杂并且性能很差，因为在 Java 软件生态系统中显然经常抛出异常，所以每次抛出异常时评估一个表达式会极大地减慢一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T10:08:14.047

此功能尚未实现，您可以投票：

*   [添加仅针对我的文件的异常中断（添加断点）的能力](http://youtrack.jetbrains.com/issue/PY-6396)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T01:25:53.230

解决方案还有另一个 SO 答案： [Debugging with pycharm, how to step into project, without enter django library](https://stackoverflow.com/questions/15164565/debugging-with-pycharm-how-to-step-into-project-without-entering-django-librar/15186219#15186219)

它对我有用，除了我仍然进入“_pydev_execfile.py”文件，但在将它们添加到链接答案中的排除项后，我没有进入其他文件。

# asp.net-mvc - IIS 7 上 Web 服务的 ServicePrincipleName 设置

> ID：11966279
> 
> 赞同：0
> 
> 时间：2012-08-15T08:37:20.600
> 
> 标签：asp.net-mvc, security, iis-7, active-directory

我很混乱。

考虑以下：

*   具有称为 DOM 的域的 Active Directory 环境
*   具有 NetBIOS 名称 VS1 的 IIS 7 框
*   为 VS1 提供别名的 DNS 记录为 pineapple.london.uk.corp
*   作为 DOM\PineappleService 运行的应用程序池
*   启用 Windows 身份验证。
*   客户端使用 HttpWebRequest 调用盒子上的 XML/JSON ASP.NET 服务。

该服务调用网络上的工作站来收集信息。这适用于我使用以我身份运行的 IIS Express 的开发，因为 IISX 只是一个 .exe

在生产中，服务工作正常，身份验证工作，但调用导致服务（作为 PineappleService 运行）访问网络上的内容的函数失败。

我怀疑存在 SPN 注册问题，但我不知道要设置哪些 SPN。

最近，我偶然发现了这篇文章，这似乎与其他一些文章大相径庭：

[http://blogs.msdn.com/b/webtopics/archive/2009/01/19/service-principal-name-spn-checklist-for-kerberos-authentication-with-iis-7-0.aspx](http://blogs.msdn.com/b/webtopics/archive/2009/01/19/service-principal-name-spn-checklist-for-kerberos-authentication-with-iis-7-0.aspx)

请注意，它说

> SPN 要求与上述相同。您不必为 Domain1\Username1 添加像 http/ 这样的 SPN，这与 IIS 6.0 不同（我们必须为应用程序池标识添加一个 http/ 形式的 SPN）。

所以我不知道什么是对的了。我不知道是否需要注册 HTTP SPN 或 HOST SPN 或使用 DNS 别名或 NetBIOS 名称，并在 PineappleService 帐户或 VS1 计算机帐户上设置它们。

我不知道当我尝试时是否存在缓慢的 AD 复制问题，这意味着我必须在反复试验之间等待一个小时。

现在一切都那么复杂。我作为系统操作员和开发人员工作了 15 年，我感觉到域和工作站以及权利和政策的终结。这一切都变得太多了。

谢谢你的帮助。

卢克

这是与 ServerFault 的交叉帖子，没有得到任何答案：

[https://serverfault.com/questions/417483/serviceprinciplename-setup-for-web-service-on-iis-](https://serverfault.com/questions/417483/serviceprinciplename-setup-for-web-service-on-iis-)

# c++ - 使用 Xcode 作为 c++ 代码的 IDE

> ID：11966280
> 
> 赞同：1
> 
> 时间：2012-08-15T08:37:22.313
> 
> 标签：c++, xcode, xcode4.2

> **可能重复：**
> [将现有 c++ 项目导入 Xcode IDE](https://stackoverflow.com/questions/5034286/import-existing-c-project-into-xcode-ide)

我有一堆 c++ 代码，我想在 Xcode 4.2 中导入并使用它的 IDE 功能。我的代码在两个目录中，include 和 src。我只想将它们导入一个项目，以便我可以查看我的类列表、它们的功能并创建新的。另外，我不需要创建makefile，因为我已经有了一个。我想要这样做的主要原因是在编写代码时使用 Xcode 的建议功能。

我的问题是，我应该选择哪个项目，我应该如何进行？

非常感谢 干杯埃达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:41:50.187

从“Mac->Other”组创建一个“External Build System”类型的项目。模板助手会询问您要使用什么构建工具 - 它默认为 /usr/bin/make，这可能是您需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:42:18.943

对于 make，打开 New Project 向导，然后选择`OS X > Other > External Build System`

然后您将源添加到您的项目中，然后您可能需要指定一些发现路径，以便索引和代码完成功能正常运行。

# php - PHP密码功能

> ID：11966284
> 
> 赞同：-4
> 
> 时间：2012-08-15T08:37:39.863
> 
> 标签：php, security, hash, passwords, crypt

此功能对密码和电子邮件哈希/加密是否安全？编辑：显然不是！

```
$password = mysql_real_escape_string(htmlspecialchars(trim($_POST['password'])));
$hash_algo = "sha512";
$raw_output = false;

$hash = hash($hash_algo, $password, $raw_output);
$hash_20 = substr($hash, 0, 20);

$salt = substr($hash, -20); 
$crypt = crypt ( $hash_20, $salt);
$crypt_20 = substr($crypt, 0, 20); 
```

编辑：这是我现在使用的代码。我觉得这个很安全。这是一个带有随机盐生成器的 PBKDF2 密码哈希函数。

所以，这里是 PBKDF2 函数。p 是密码。s 代表盐。c 用于迭代 kl 用于密钥长度。a 用于哈希算法。

```
function pbkdf2( $p, $s, $c, $kl, $a = 'sha256' )
{ 
    $hl = strlen(hash($a, null, true)); # Hash length
    $kb = ceil($kl / $hl);              # Key blocks to compute
    $dk = '';                           # Derived key

    # Create key
    for ( $block = 1; $block <= $kb; $block ++ ) {

        # Initial hash for this block
        $ib = $b = hash_hmac($a, $s . pack('N', $block), $p, true);

        # Perform block iterations
        for ( $i = 1; $i < $c; $i ++ )

            # XOR each iterate
            $ib ^= ($b = hash_hmac($a, $b, $p, true));

        $dk .= $ib; # Append iterated block
    }

    # Return derived key of correct length
    return substr($dk, 0, $kl);
} 
```

盐发生器：

```
function salt( $length )
{
    $chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";  
    $salt="";
    $size = strlen( $chars );

    for( $i = 0; $i < $length; $i++ )
    {
        $salt.= $chars[ rand( 0, $size - 1 ) ];
    }

    return $salt;

} 
```

正在使用：

```
if(isset($_POST['submit']))
{

    $Password = mysql_real_escape_string(htmlspecialchars(trim($_POST['Password'])));

    //To make sure the salt has never more chars than the password.
    $salt_length = strlen($Password); 
    $salt = salt($salt_length);

    //Hash Password 
    $hash = base64_encode(pbkdf2($Password, $salt, 100000, 32));
    //--------------//
} 
```

谷歌搜索一下，发现 100000 次迭代非常安全，但我想 10000 次就足够了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T08:48:49.350

由于您正在对输入进行散列处理，因此您不能简单地将其反转为原始值。假设攻击者*知道*这个算法，那么问题是暴力破解密码需要多长时间。为此，测试一次算法迭代需要多长时间。然后计算攻击者必须尝试多少次才能在高端机器上尝试所有可能的密码。然后你就知道算法有多“安全”了。您正在寻找至少以千年为单位的答案，但最好是大爆炸。

也就是说，假设没有针对攻击者可以尝试的算法的实际攻击，这将缩短该时间。

由于您是从输入本身导出盐，因此您只是稍微扩展了算法。您没有使用实际的盐，它是一个独立于输入的随机唯一值。因此，您正在使用具有不那么复杂的散列算法的未加盐输入。我敢打赌，用这种算法蛮力“保护”整个密码数据库并不难。

# highcharts - Highcharts 工具提示始终位于光标右侧

> ID：11966286
> 
> 赞同：17
> 
> 时间：2012-08-15T08:37:43.253
> 
> 标签：highcharts

我想在光标右侧显示工具提示。

我查看了文档/示例，但找不到强制工具提示停留在光标右侧的方法。

谁能告诉我该怎么做？

使用[工具提示定位](http://www.highcharts.com/ref/#tooltip--positioner)器，我只能设置默认位置。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-15T19:23:18.207

工具提示定位器不仅仅是默认位置。函数参数包含有关您的点位置和工具提示尺寸的信息，使用这些信息将其定位到右侧应该相当简单。

[Highchart/stock 允许您](http://api.highcharts.com/highstock#tooltip.positioner)按如下方式定义备用定位器

```
tooltip:{
    positioner:function(boxWidth, boxHeight, point){
        ...
    }
} 
```

请注意，您可以使用三个参数（boxWidth、boxHeight、point），对于大多数用例来说，这些似乎足以计算所需的工具提示位置。boxWidth 和 boxHeight 是您的工具提示所需的宽度和高度，因此您可以将它们用于边缘情况以调整您的工具提示并防止它溢出图表甚至更糟地被剪裁。

highstock 自带的默认tooltip定位器如下（[源码](http://code.highcharts.com/stock/highstock.src.js)）

```
/**
 * Place the tooltip in a chart without spilling over
 * and not covering the point it self.
 */
getPosition: function (boxWidth, boxHeight, point) {

    // Set up the variables
    var chart = this.chart,
        plotLeft = chart.plotLeft,
        plotTop = chart.plotTop,
        plotWidth = chart.plotWidth,
        plotHeight = chart.plotHeight,
        distance = pick(this.options.distance, 12), // You can use a number directly here, as you may not be able to use pick, as its an internal highchart function 
        pointX = point.plotX,
        pointY = point.plotY,
        x = pointX + plotLeft + (chart.inverted ? distance : -boxWidth - distance),
        y = pointY - boxHeight + plotTop + 15, // 15 means the point is 15 pixels up from the bottom of the tooltip
        alignedRight;

    // It is too far to the left, adjust it
    if (x < 7) {
        x = plotLeft + pointX + distance;
    }

    // Test to see if the tooltip is too far to the right,
    // if it is, move it back to be inside and then up to not cover the point.
    if ((x + boxWidth) > (plotLeft + plotWidth)) {
        x -= (x + boxWidth) - (plotLeft + plotWidth);
        y = pointY - boxHeight + plotTop - distance;
        alignedRight = true;
    }

    // If it is now above the plot area, align it to the top of the plot area
    if (y < plotTop + 5) {
        y = plotTop + 5;

        // If the tooltip is still covering the point, move it below instead
        if (alignedRight && pointY >= y && pointY <= (y + boxHeight)) {
            y = pointY + plotTop + distance; // below
        }
    } 

    // Now if the tooltip is below the chart, move it up. It's better to cover the
    // point than to disappear outside the chart. #834.
    if (y + boxHeight > plotTop + plotHeight) {
        y = mathMax(plotTop, plotTop + plotHeight - boxHeight - distance); // below
    }

    return {x: x, y: y};
} 
```

有了以上所有信息，我认为您有足够的工具来实现您的要求，只需修改函数以使浮动向右而不是默认向左。

我将继续为您提供[最简单的定位工具提示的实现](http://jsfiddle.net/jugal/bAw5J/)，您应该能够根据后面提到的默认工具提示定位器的代码来实现边缘情况

```
tooltip: {
    positioner: function(boxWidth, boxHeight, point) {         
        return {x:point.plotX + 20,y:point.plotY};         
    }
} 
```

阅读更多 @[自定义 Highcharts - 工具提示定位](http://ahumbleopinion.com/customizing-highcharts-tooltip-positioning/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-15T21:37:09.437

使工具提示始终位于光标右侧的更好解决方案如下：

```
function (labelWidth, labelHeight, point) { 
    return { 
        x: point.plotX + labelWidth / 2 + 20,
        y: point.plotY + labelHeight / 2 
    };
} 
```

# selenium - 无法使用 Selenium Webdrive 控制滑块验证码 jquery？

> ID：11966287
> 
> 赞同：2
> 
> 时间：2012-08-15T08:37:42.693
> 
> 标签：selenium, selenium-webdriver

我想记录我们客户网站上提供的**滑块验证码。**

我们从名为[http://www.fmylife.com/signup的其他网站获得了这个概念](http://www.fmylife.com/signup)

这有用于注册的滑块验证码

我尝试使用 selenium webdriver action builder

```
public class TestFmylife {
    WebDriver driver;
    Selenium selenium;

    @BeforeMethod
    public void startSelenium() {
        driver = new FirefoxDriver();
        selenium = new WebDriverBackedSelenium(driver, "http://www.fmylife.com/");
        driver.manage().window().maximize();
    }

    @AfterMethod
    public void stopSelenium() {
        driver.close();
    }

    @Test
    public void testFmylife() {
        selenium.open("/");
        selenium.click("link=Sign up");
        selenium.waitForPageToLoad("30000");
        selenium.type("name=login", "testfmylife");
        selenium.type("name=pass", "123@fmylife");
        selenium.type("name=passc", "123@fmylife");
        selenium.type("name=mail", "testfmylife@gmail.com");

        Point MyPoint= driver.findElement(By.xpath("//*[@id='bgSlider']")).getLocation();

        WebElement someElement = driver.findElement(By.xpath("//*[@id='bgSlider']"));

        System.out.println(MyPoint.x+"--------"+MyPoint.y);

        Actions builder = new Actions(driver);

        Action dragAndDrop =  builder.clickAndHold(someElement).moveByOffset(MyPoint.x,(MyPoint.y + 100)).release().build();

        dragAndDrop.perform();

        selenium.click("css=div.form > div.ok > input[type=\"submit\"]");
    }
} 
```

但我无法使用此代码移动滑块

帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T07:30:27.463

```
Actions builder = new Actions(driver);

Action dragAndDrop = builder.clickAndHold(someElement)
   .moveToElement(otherElement)
   .release(otherElement)
   .build();

dragAndDrop.perform(); 
```

更多信息可以在 - [http://code.google.com/p/selenium/wiki/AdvancedUserInteractions找到](http://code.google.com/p/selenium/wiki/AdvancedUserInteractions)

您可以按如下方式使用定位器 -

```
String xto=Integer.toString(LocatorTo.getLocation().x);
String yto=Integer.toString(LocatorTo.getLocation().y); 
```

工作代码-

```
WebDriver driver = new InternetExplorerDriver();
driver.get("http://jqueryui.com/demos/slider/");
//Identify WebElement
WebElement slider = driver.findElement(By.xpath("//div[@id='slider']/a"));

//Using Action Class
Actions move = new Actions(driver);
Action action = move.dragAndDropBy(slider, 30, 0).build();
action.perform();

driver.quit(); 
```

来源 - [https://gist.github.com/2497551](https://gist.github.com/2497551)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T08:00:02.973

如果你的滑块和我的一样

![在此处输入图像描述](../Images/64568a926c8c1380269376aadaa4a2e4.png)

在“滑块轨道”（一个 <div> 标记作为长黑条）内有一个“滑块手柄”（一个 <a/> 标签作为值为“5ft 5”的框），那么以下代码将在 C# 中努力将滑块手柄沿滑块轨道移动一个百分比。

```
public void SetSliderPercentage(string sliderHandleXpath, string sliderTrackXpath, int percentage)
{
    var sliderHandle = driver.FindElement(By.XPath(sliderHandleXpath));
    var sliderTrack = driver.FindElement(By.XPath(sliderTrackXpath));
    var width = int.Parse(sliderTrack.GetCssValue("width").Replace("px", ""));
    var dx = (int)(percentage / 100.0 * width);
    new Actions(driver)
                .DragAndDropToOffset(sliderHandle, dx, 0)
                .Build()
                .Perform();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T04:09:33.563

我使用了 Actions 类 (java.lang.Object org.openqa.selenium.interactions.Actions) 的 dragAndDropBy 方法，并将滑块水平移动了 200 个点。请尝试以下代码：

```
WebDriver driver = new FirefoxDriver();
driver.get("http://www.fmylife.com/signup");
WebElement slider = driver.findElement(By.xpath(".//*[@id='Slider']"));
Actions builder = new Actions (driver);
builder.dragAndDropBy(slider, 200, 0).build().perform(); 
```

# java - 查询联系信息时出现 NullPointerException

> ID：11966290
> 
> 赞同：1
> 
> 时间：2012-08-15T08:37:57.680
> 
> 标签：java, android

我正在查询联系信息以获取电话号码和电子邮件地址，这是我的代码：

```
protected void onPreExecute() {
    // get total count
    Cursor count = getContentResolver().query(
    ContactsContract.Contacts.CONTENT_URI, null, null, null, null);
    total = count.getCount();

    // setup progress dialog
    progressDialog.setMessage(getString(R.string.profile_synchonizing));
    progressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
    progressDialog.setProgress(0);
    progressDialog.setMax(total);
    progressDialog.show();        // Profile.java:270
}

protected Void doInBackground(String... arg0) {
    Cursor cursor = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, null, null, null, null);

    while (cursor.moveToNext()) {
        String contactId = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts._ID));
        String name = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));

        if (Integer.parseInt(cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER))) > 0) {
            Cursor phoneNumber = getContentResolver().query(Phone.CONTENT_URI, null, Phone.CONTACT_ID + " = ?", new String[] { contactId }, null);
            while (phoneNumber.moveToNext()) {
                // do something
            }
        }

        Cursor emails = getContentResolver().query(Email.CONTENT_URI, null, Email.CONTACT_ID + " = ?", new String[] { contactId }, null);
        while (emails.moveToNext()) {
            // do something
        }
    }
} 
```

我已经确保联系人有电话号码，但是在这些行中我仍然遇到空指针异常：

```
while (phoneNumber.moveToNext())     //Profile.java:315
while (emails.moveToNext()) 
```

异常堆栈：

```
08-15 16:41:33.162: E/AndroidRuntime(20283): FATAL EXCEPTION: AsyncTask #2
08-15 16:41:33.162: E/AndroidRuntime(20283): java.lang.RuntimeException: An error occured while executing doInBackground()
08-15 16:41:33.162: E/AndroidRuntime(20283):    at android.os.AsyncTask$3.done(AsyncTask.java:200)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.lang.Thread.run(Thread.java:1027)
08-15 16:41:33.162: E/AndroidRuntime(20283): Caused by: java.lang.NullPointerException
08-15 16:41:33.162: E/AndroidRuntime(20283):    at test.Profile$SyncContactAsync.doInBackground(Profile.java:315)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at test.Profile$SyncContactAsync.doInBackground(Profile.java:1)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
08-15 16:41:33.162: E/AndroidRuntime(20283):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
08-15 16:41:33.162: E/AndroidRuntime(20283):    ... 4 more
08-15 16:41:33.902: D/WindowManagerImpl(20283): finishRemoveViewLocked, mViews[0]: com.android.internal.policy.impl.PhoneWindow$DecorView@40545090
08-15 16:41:33.932: E/WindowManager(20283): Activity test.TabScreen has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@405bc868 that was originally added here
08-15 16:41:33.932: E/WindowManager(20283): android.view.WindowLeaked: Activity test.TabScreen has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@405bc868 that was originally added here
08-15 16:41:33.932: E/WindowManager(20283):     at android.view.ViewRoot.<init>(ViewRoot.java:278)
08-15 16:41:33.932: E/WindowManager(20283):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:149)
08-15 16:41:33.932: E/WindowManager(20283):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
08-15 16:41:33.932: E/WindowManager(20283):     at     android.view.Window$LocalWindowManager.addView(Window.java:433)
08-15 16:41:33.932: E/WindowManager(20283):     at android.app.Dialog.show(Dialog.java:265)
08-15 16:41:33.932: E/WindowManager(20283):     at test.Profile$SyncContactAsync.onPreExecute(Profile.java:270)
08-15 16:41:33.932: E/WindowManager(20283):     at android.os.AsyncTask.execute(AsyncTask.java:391)
08-15 16:41:33.932: E/WindowManager(20283):     at test.Profile$3.onItemClick(Profile.java:235)
08-15 16:41:33.932: E/WindowManager(20283):     at android.widget.AdapterView.performItemClick(AdapterView.java:284)
08-15 16:41:33.932: E/WindowManager(20283):     at android.widget.ListView.performItemClick(ListView.java:3569)
08-15 16:41:33.932: E/WindowManager(20283):     at android.widget.AbsListView$PerformClick.run(AbsListView.java:1831)
08-15 16:41:33.932: E/WindowManager(20283):     at android.os.Handler.handleCallback(Handler.java:587)
08-15 16:41:33.932: E/WindowManager(20283):     at android.os.Handler.dispatchMessage(Handler.java:92)
08-15 16:41:33.932: E/WindowManager(20283):     at android.os.Looper.loop(Looper.java:150)
08-15 16:41:33.932: E/WindowManager(20283):     at android.app.ActivityThread.main(ActivityThread.java:4385)
08-15 16:41:33.932: E/WindowManager(20283):     at java.lang.reflect.Method.invokeNative(Native Method)
08-15 16:41:33.932: E/WindowManager(20283):     at java.lang.reflect.Method.invoke(Method.java:507)
08-15 16:41:33.932: E/WindowManager(20283):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
08-15 16:41:33.932: E/WindowManager(20283):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
08-15 16:41:33.932: E/WindowManager(20283):     at dalvik.system.NativeStart.main(Native Method) 
```

我检查了引发异常的联系人，它有电话号码和电子邮件地址。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:49:23.210

You should call `moveToFirst()` on all the cursors before traversing their data e.g.

```
Cursor cursor = getContentResolver.query( ... );
cursor.moveToFirst();
while( cursor.moveToNext() ) {
    // process data here...
} 
```

Hope this helps...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:00:39.087

您可能忘记了清单 (AndroidManifest.xml) 中的联系人读取权限：

```
<uses-permission android:name="android.permission.READ_CONTACTS" /> 
```

注意：这也会导致 NULL 指针异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T10:08:44.717

为什么在使用之前不检查光标是否为空值？
然后，您可以检查您的查询为什么它们没有返回结果

# node.js - 作为两个事件驱动的服务器，为什么 node.js 需要 Nginx 不需要的异步代码？

> ID：11966292
> 
> 赞同：3
> 
> 时间：2012-08-15T08:38:15.527
> 
> 标签：node.js, asynchronous, nginx

问题在标题中。换句话说，如果 Nginx 和 node.js 一样是事件驱动的异步 IO 模型，那为什么不需要编写异步风格的代码呢？我知道，Nginx实际上并**没有**执行任何代码，而是将它们代理给可以执行的人。那么为什么节点不这样做呢？我们在当前的 Ngninx 方式中遗漏了什么吗？或者，从节点获得更多（除了编写异步代码的痛苦）？

附言。更具体地说，Nginx+php-fpm 或 Nginx+wsgi+python/ruby 与单独的节点在性能或利用节点声称的计算资源方面有何不同？节点不能只使用现有的 FastCGI 模型，成为一个同步风格的 JavaScript 解释器，让网络服务器完成它的异步工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T13:36:59.597

从 NodeJS 谷歌组交叉发布：

好的，我会尽力回答你的问题：

Nginx 是一个只代理请求的网络服务器。现在，如果您以 Nginx+php+fpm 或 Nginx+wsgi+ruby 为例，您将拥有一个异步的、有事件的 Web 服务器，它位于同步执行的 Web 服务器前面。因此 Nginx 将接受（）尽可能多的连接，并且所有这些连接都将排队。从 Nginx 到您的后端同步服务器的请求将是异步的。但是你的后端同步服务器也接受（）没有排队任何连接。它一次只能处理一个请求（考虑到您是单线程的），一次只能处理多个请求（prefork/fork（慢）/多线程 -> 有其自身的缺点，例如线程创建时间（可以通过线程池来避免，但是PITA 来实现）、上下文切换、线程死锁、

想象一下，您有 2 条通往 Nginx 正在访问的后端服务器的路由：

/404，/登录。

如果 /login 路由做了大量的 I/O 并且如果另一个请求是向 /404 发出的，那么 /404 页面的渲染将取决于 /login 的请求的完成（因为进程被阻塞了）。所以基本上对任何请求的响应将取决于执行 I/O 时间最长的请求。因此，即使 Nginx 是异步的，它对任何请求的响应时间也将完全取决于完成时间最长的请求（罪魁祸首：同步后端服务器）。

Now if you take the example of NodeJS, everything is asynchronous and evented. Be it File/Network I/O etc. So nothing blocks the process. So taking the previous example, even if /login route is doing a lot of I/O its all asynchronous and /404 page is rendered immediately.

My explanation is quite rudimentary. But I think it should give you more clarity.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T08:49:20.980

nginx 是一个简单的静态 HTTP 和代理服务器。Node.js 是一个功能齐全的应用程序平台。

为什么您不期望更专业的应用程序抽象出您不需要直接控制的所有内部工作？

### 编辑：

[您的 PS 与此问题](https://stackoverflow.com/questions/7419976/whats-advantages-on-using-node-js-node-http-server-over-php-ruby-etc-nginx?lq=1)非常相似，并且特别关注使用 Node.JS 作为 HTTP 服务器。请记住，当该问题结束时，v0.4.12 刚刚发布 - v0.8.5 是目前最新的稳定版本。无论如何，关键在于这取决于您要实现的目标。

[这篇博](http://blog.caustik.com/2012/04/10/node-js-w250k-concurrent-connections/)文描述了一个基于 Node.JS 的设置，在单个服务器上实现了 250k 个并发连接。一个快速的谷歌搜索显示人们尝试使用 nginx+php 进行类似的尝试，努力达到 100k，但可用的硬件资源要多得多。

# android - 主屏幕小部件中的 ListvView 有时会显示旧的（缓存的？）数据

> ID：11966293
> 
> 赞同：1
> 
> 时间：2012-08-15T08:38:17.583
> 
> 标签：android, listview, caching, widget, android-4.0-ice-cream-sandwich

我有一个带有 ListView 的主屏幕小部件（Android 4.x - ICS），经过一些更改，列出的项目没有正确显示 - 我的意思是，显示“旧”数据。它总是这样：

1.  listview 的可见部分总是显示好的（= 新的）数据
2.  列表的不可见部分（向上或向下滚动）总是显示一些旧项目（有些不是）

看起来，列表的不可见部分被缓存了，当我向上或向下滚动时，只有少数项目被刷新，而其他项目则没有。它看起来很有趣，因为当我上下滚动时，有些项目显示旧的，一些新的，而且总是不同的项目，就像绝对随机的一样。很简单很奇怪...

有什么问题？这是我的列表视图：

```
<ListView
    android:id="@+id/panelNews"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_marginLeft="@dimen/padding"
    android:layout_marginRight="@dimen/padding"
    android:layout_weight="1"
    android:gravity="top"
    android:paddingTop="@dimen/padding"
    android:scrollingCache="false"
    android:animationCache="false">
</ListView> 
```

这是我的 MyWidgetServiceFactory 方法的代码（每次数据更改都会触发此方法）：

```
public void onDataSetChanged() {
    MyLogger.log(TAG, "onDataSetChanged");
    listItems = dbHandler.getRecords(prefHandler);
} 
```

这就是我如何通知 MyWidgetServiceFactory 来自我的 UpdateService 的数据更改：

```
AppWidgetManager manager = AppWidgetManager.getInstance(this);
int[] appWidgetIds = manager.getAppWidgetIds(new ComponentName(this, MyWidget.class));
manager.notifyAppWidgetViewDataChanged(appWidgetIds, R.id.panelNews); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:56:07.837

你应该使用函数

```
notifyDataSetChanged() 
```

在您用来填充列表的适配器上调用。检查此[链接](https://stackoverflow.com/questions/4903758/android-how-to-refresh-listview-contents) 以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T10:00:29.667

好的，完全是我的错，这是愚蠢的错误 - 我只是忘记更新 1 个字段。

# c# - 在 C# 中从 GridView 填充数据表

> ID：11966295
> 
> 赞同：2
> 
> 时间：2012-08-15T08:38:29.553
> 
> 标签：c#, asp.net, gridview, datatable

如何在 ASP.NET 中从 GridView 填充 DataTable？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T08:43:57.940

简单地说，你可以这样做：

```
BindingSource bindingSource = (BindingSource )yourGridView.DataSource;
DataTable yourDataTable= (DataTable ) bindingSource .DataSource; 
```

另一种方式，你可以这样做：

```
DataTable yourDataTable = yourGridView.DataSource as DataTable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T12:05:54.350

```
 I solved like this
           if (myGridView.Rows.Count > 0)
            {
                var dt = new DataTable();
                dt.Columns.Add("Column1", typeof(string));
                dt.Columns.Add("Column2", typeof(Int64));
                dt.Columns.Add("Column3", typeof(string));

                foreach (GridViewRow row in gd_endYearSchool.Rows)
                {
                    var id = row.Cells[1].Text;
         //for find textbox
          var tb1 = row.Cells[2].FindControl("tbNr") as TextBox;
                    int nrord = 0;
                    if (tb1 != null)
                    {
                        var ord = tb1.Text;
                        if (!Int64.TryParse(ord, out nrord))
                        {
                            nrord = 0;
                        }
                    }
                    var text=row.Cell[3].text;
                    dt.Rows.Add(id,nrord,text);
                }

            } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T12:12:17.843

我会这样做，我想这会帮助你。

```
public void Data_table()
{
    Session["Data"] = "";
    DataTable dt = new DataTable();
    //Add Columns to the datatable
    dt.Columns.Add("c1");
    dt.Columns.Add("c2");
    dt.Columns.Add("c3");
    //Define a datarow for the datatable dt
    DataRow dr = dt.NewRow();
    //Now add the datarow to the datatable
    Session["Data"] = dt;
    RadGrid1.DataSource = dt;
    RadGrid1.Rebind();
}

protected void RadGrid1_NeedDataSource(object sender, GridNeedDataSourceEventArgs e)
{            
    if (((System.Data.DataTable)(Session["Data"])).Rows.Count.ToString() != "")
    {
        RadGrid1.DataSource = Session["Data"];
    }
} 
```

谢谢..，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T11:33:28.270

您可以使用 foreach 从 gridview 填充数据表

# linux - 使用 shell 脚本搜索单词并在该单词之后导出 35 个字符？

> ID：11966299
> 
> 赞同：1
> 
> 时间：2012-08-15T08:38:43.177
> 
> 标签：linux, shell

我有一个文件`input.txt`，其中包含大量奇怪的字符、html 标签和有用的材料。我想在新文件 output.txt中显示 35 个字符，`description`不包括奇怪的字符，如和没有 html 标记。`$$#$#@$#@***$#`帮我。提前谢谢。

我的最终目标是找到单词描述并在描述后打印 35 个字符，其中不应包含 html 标签和奇怪的字符。可能吗？像这儿：

```
<description>&lt;p&gt;&lt;img class="float_right"
 src="http://static3.businessinsider.com/image/502ab0036bb3f7147b00000f-400-300/dnu.jpg"
 border="0" alt="dnu" width="400" height="300" /&gt;&lt;/p&gt;&lt;p&gt;The lawn
 was filled with &lt;a class="hidden_link"
 href="http://www.businessinsider.com/blackboard/goldman-sachs"&gt;Goldman
 Sachs&lt;/a&gt; Group Inc. partners dressed in pink looking out on a pink sunset. 
```

我想从：（`The lawn is filled with`再次跳过这些标签并继续）`Group Inc. partners`（35 个字符。完成！）然后停止并搜索另一个描述！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:44:55.307

您可以使用 XPath 选择 HTML 节点中的所有文本。在您的情况下，这应该有效：

```
xpath -q -e '//description//text()' input.txt 
```

查询的`//description//text()`工作方式如下：

*   `//description`: 向下钻取 HTML 文档，直到找到一个名为`description`
*   `//text()`：在此节点中向下钻取所有其他节点并选择它们的文本

鉴于您的数据，此输出：

```
The lawn was filled with 
Goldman Sachs
 Group Inc. partners dressed in pink looking out on a pink sunset. 
```

# php - 扩展一个抽象类，扩展另一个抽象类，需要重写父抽象类实现的接口

> ID：11966301
> 
> 赞同：0
> 
> 时间：2012-08-15T08:38:49.647
> 
> 标签：php, inheritance, interface

我有一个名为 Post 的实体类。Post 的父级基于一个名为 AbstractPost 的抽象类。AbstractPost 有一个变量“author”，其 setter 的签名定义在一个名为 PostInterface 的接口中。

我处于需要覆盖作者的设置器的情况，但不想修改父母（当然）。

这些是父类：

```
class Post extends AbstractPost
abstract class AbstractPost implements PostInterface
interface PostInterface 
```

我有以下课程：

```
class MyPost extends MyAbstractPost
abstract class MyAbstractPost extends AbstractPost implements MyPostInterface
interface MyPostInterface extends PostInterface 
```

但是，我收到错误：

> 致命错误：MyAbstractPost::setAuthor() 的声明必须与 PostInterface::setAuthor() 的声明兼容

我读过孩子继承了父类的“实现”部分（这里的正确术语是什么？），所以我想我想知道如何覆盖它。还是我没有以正确的方式扩展/实施？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:51:54.800

答案是不。

重载方法签名会破坏拥有接口的目的。

# c# - 过程或函数“usp_User_Info2”需要参数“@UserName”，但未提供该参数

> ID：11966302
> 
> 赞同：0
> 
> 时间：2012-08-15T08:39:00.197
> 
> 标签：c#, asp.net, sql

我正在使用 ASP.NET 4.0 和 SQL Server 2008 R2。我想使用“用户注册”网页的存储过程插入数据。每当我插入数据时，错误显示为“过程或函数'usp_User_Info2'需要参数'@UserName'，未提供”。但我输入了除SNo（身份列）和Vendor_ID（计算列）之外的所有必填字段。什么解决方案？而且我还希望插入后在消息框中显示“Vendor_ID”。

```
 CREATE TABLE User_Info2
    (
     SNo int Identity (2000,1) , 
     Vendor_ID AS 'VEN' + CAST(SNo as varchar(16)) PERSISTED PRIMARY KEY,
     UserName VARCHAR(16) NOT NULL,
     User_Password VARCHAR(12) NOT NULL,
     User_ConPassword VARCHAR(12) NOT NULL,
     User_FirstName VARCHAR(25) NOT NULL,
     User_LastName VARCHAR(25) SPARSE NULL,
     User_Title VARCHAR(35) NOT NULL,
     User_EMail VARCHAR(35) NOT NULL,
     User_PhoneNo VARCHAR(14) NOT NULL,
     User_MobileNo VARCHAR(14)NOT NULL,
     User_FaxNo VARCHAR(14)NOT NULL,
     UserReg_Date DATE DEFAULT GETDATE()
    )

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    ALTER PROCEDURE [dbo].[usp_User_Info2]
    @UserName VARCHAR(30),
    @User_Password VARCHAR(12),
    @User_ConPassword VARCHAR(12),
    @User_FirstName VARCHAR(25),
    @User_LastName VARCHAR(25),
    @User_Title VARCHAR(35),
    @User_OtherEMail VARCHAR(30),
    @User_PhoneNo VARCHAR(14),
    @User_MobileNo VARCHAR(14),
    @User_FaxNo VARCHAR(14)
    AS
    BEGIN
SET NOCOUNT ON;
    INSERT INTO User_Info2 (UserName,User_Password,User_ConPassword,User_FirstName,User_LastName,
     User_Title,User_OtherEmail,User_PhoneNo,User_MobileNo,User_FaxNo)
           VALUES     (@UserName,@User_Password,@User_ConPassword,@User_FirstName,@User_LastName,
    @User_Title,@User_OtherEMail,@User_PhoneNo,@User_MobileNo,@User_FaxNo)
    END

    protected void BtnUserNext_Click(object sender, EventArgs e)
    {
        SqlConnection SqlCon = new SqlConnection(GetConnectionString());
        SqlCommand cmd = new SqlCommand();
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.CommandText = "usp_User_Info2";
        cmd.Parameters.Add("@User_Email", SqlDbType.VarChar).Value = txtUserName.Text.Trim();
        cmd.Parameters.Add("@User_Password",SqlDbType.VarChar).Value = txtRegPassword.Text;
        cmd.Parameters.Add("@User_ConPassword",SqlDbType.VarChar).Value = txtRegConPassword.Text;
        cmd.Parameters.Add("@User_FirstName",SqlDbType.VarChar).Value = txtRegFName.Text.Trim();
        cmd.Parameters.Add("@User_LastName",SqlDbType.VarChar).Value = txtRegLName.Text.Trim();
        cmd.Parameters.Add("@User_Title",SqlDbType.VarChar).Value = txtRegTitle.Text.Trim();
        cmd.Parameters.Add("@User_OtherEmail", SqlDbType.VarChar).Value = txtOtherEmail.Text;
        cmd.Parameters.Add("@User_PhoneNo",SqlDbType.VarChar).Value = txtRegTelephone.Text;
        cmd.Parameters.Add("@User_MobileNo", SqlDbType.VarChar).Value = txtRegMobile.Text.Trim();
        cmd.Parameters.Add("@User_FaxNo", SqlDbType.VarChar).Value = txtRegFax.Text.Trim();
        cmd.Connection = SqlCon;
        try
        {
            SqlCon.Open();
            cmd.ExecuteScalar();
        }
        finally
        { string url = "../CompanyBasicInfo.aspx?Parameter=" + Server.UrlEncode
          ("+ Vendor_ID  +"); 
              ClientScript.RegisterStartupScript(this.GetType(), "callfunction",
              "alert('Login created successfully for "+ Vendor_ID +"');
              window.location.href = '"  + url + "';", true); 
              SqlCon.Close();
        }        
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:41:10.457

```
 cmd.Parameters.Add("@User_Email", SqlDbType.VarChar).Value = txtUserName.Text.Trim(); 
```

应该：

```
 cmd.Parameters.Add("@UserName", SqlDbType.VarChar).Value = txtUserName.Text.Trim(); 
```

要获取标识列，请将其添加到存储过程的底部：

```
SELECT SCOPE_IDENTITY() 'Id' 
```

并从中获取值`ExecuteScalar`：

```
Vendor_ID = "VEN" + ((int)cmd.ExecuteScalar()).ToString(); 
```

# java - Oracle - 如何正确执行事务？

> ID：11966304
> 
> 赞同：0
> 
> 时间：2012-08-15T08:39:21.877
> 
> 标签：java, sql, oracle, jdbc, transactions

我的声明：

```
statement.addBatch("START TRANSACTION;" +
                "UPDATE FIRST_TABLE SET FIRST_FIELD = 1;" +
                "UPDATE SECOND_TABLE SET SECOND_FIELD = 2;" +
                "UPDATE THIRD_TABLE SET THIRD_FIELD = 3;" +
                "COMMIT;"); 
```

下一行抛出异常：

```
statement.executeBatch(); 
```

如果我使用该方法，也会发生同样的事情`execute`：

```
statement.execute(myTransaction); 
```

例外：

```
java.sql.BatchUpdateException: ORA-00900: invalid SQL statement 
```

我使用甲骨文。如果我在命令行或 SQL IDE 中执行此语句，我没有任何异常。在这种情况下它可以正常工作。**仅在 java 代码中**存在此异常。怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T08:45:47.947

尝试，

```
connection.setAutoCommit(false);
statement.addBatch("UPDATE FIRST_TABLE SET FIRST_FIELD = 1");
statement.addBatch("UPDATE SECOND_TABLE SET SECOND_FIELD = 2");
statement.addBatch("UPDATE THIRD_TABLE SET THIRD_FIELD = 3");
int [] counts = statement.executeBatch();
connection.commit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:45:29.227

尝试将每个更新语句添加到单独的`addBatch()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:43:11.800

通常，您会使用连接的 setAutoCommit() 方法来启动事务、运行语句，最后适当地调用 commit() 或 rollback()。这是一种与数据库无关的事务处理方式。不确定，为什么要构造相同的 SQL！你能详细说明你的用例吗？

```
Connection con = dataSource.getConnection();
try {
    con.setAutoCommit(false);
    Statement stmt = con.prepareStatement("<your update statement with placeholders for  parameters");
    stmt.set(1, <Value1>);
    stmt.set(2, <Value2>);
    stmt.execute();
    con.commit();
}
catch (SQLException sqle) {
    // Handle the exception
    con.rollback();
}
finally {
    con.close();
} 
```

注意：在上面的代码中，在获取连接和关闭连接时有很多极端情况需要处理，为了让这看起来简单，暂时省略了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:46:01.210

附带说明一下，为了创建一批 SQL，您必须将每个语句单独添加到批处理中。

所以，而不是：

```
 statement.addBatch("START TRANSACTION;" +
            "UPDATE FIRST_TABLE SET FIRST_FIELD = 1;" +
            "UPDATE SECOND_TABLE SET SECOND_FIELD = 2;" +
            "UPDATE THIRD_TABLE SET THIRD_FIELD = 3;" +
            "COMMIT;"); 
```

利用：

```
 statement.addBatch("START TRANSACTION;");
     statement.addBatch("UPDATE FIRST_TABLE SET FIRST_FIELD = 1;");
     .... 
```

但是，这不是运行事务的标准方式。要运行事务：

```
 con.setAutoCommit(false); //so that a transaction is not committed after each
                              //statement

    //run you queries
    statement.executeUpdate(); //or statement.executeBatch();
    ...
    //in the end commit
    con.commit(); 
```

# bash - 期望在 bash 中对 ssh 密码进行异常处理

> ID：11966305
> 
> 赞同：2
> 
> 时间：2012-08-15T08:39:35.167
> 
> 标签：bash, shell, expect

```
VAR=$(expect -c "
     spawn ssh-copy-id -i $SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP    
     expect "*?assword:*"
     send \"$REMOTE_HOST_PASSWD\r\";  
     send -- "\r"
     expect eof
    ")

#echo "$VAR" 
```

代码在我的 bash 脚本中的一个函数中工作。当密码错误时我需要一个异常。我的方法是；

```
VAR=$(expect -c "
     spawn ssh-copy-id -i $SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP    
     expect "*?assword:*"
     send \"$REMOTE_HOST_PASSWD\r\"; 
     expect "Permission denied, please try again."
     send user "Wrong pass"
     exit
     send -- "\r"
     expect eof
    ")

#echo "$VAR" 
```

但它给出了错误

```
couldn't read file "denied,": no such file or directory 
```

我认为这是关于引用。当我将期望 -c " 更改为单引号期望 -c ' 时，这一次它给出了找不到 $SSH_KEY_PATH_PUB 的错误，因为它是脚本中的一个变量。所以我认为它超出了范围。解决办法是什么

编辑：好的，这次最好使用单引号并且它可以工作。但是 if 子句可以做什么；

```
 AR=$(expect -c '
 spawn ssh-copy-id -i '"$SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP"'
 expect "*?assword:*"
 send "'"$REMOTE_HOST_PASSWD"'\r";
 expect "Permission denied, please try again."
 send user "Wrong pass"
 exit
 send -- "\r"
 expect eof 
```

')

这一次，如果通过是好的，它会成功，如果通过不正确，它不会。但是当通行证正确时，它会写入“错误通行证”阶段。它可以做什么所以如果通过正确它必须退出而不是继续。对不起我不熟悉期望及其语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:54:06.060

您要么需要在字符串中转义 " 字符的其他用途

```
AR=$(expect -c "
    spawn ssh-copy-id -i $SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP    
    expect \"*?assword:*\"
    send \"$REMOTE_HOST_PASSWD\r\"; 
    expect \"Permission denied, please try again.\"
    send user \"Wrong pass\"
    exit
    send -- \"\r\"
    expect eof
") 
```

或者你可以切换到使用单引号，但你需要退出引号来扩展你的变量

```
 AR=$(expect -c '
    spawn ssh-copy-id -i '"$SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP"'
    expect "*?assword:*"
    send "'"$REMOTE_HOST_PASSWD"'\r";
    expect "Permission denied, please try again."
    send user "Wrong pass"
    exit
    send -- "\r"
    expect eof
') 
```

基本上，在单个命令参数中切换用于引用命令的引用类型。这是有效的，因为 bash 单词参数可以包含引号。简单的例子

'密码='"$密码"

并且您可以根据需要组合任意数量的引号开关，只要两个不同的引号之间没有空格，它们都将被视为同一个单词或命令参数的一部分。

# django - 通过 django 中的表单提交奇怪的 url 模式

> ID：11966307
> 
> 赞同：0
> 
> 时间：2012-08-15T08:39:54.887
> 
> 标签：django, forms, django-urls

我在页面上有一个表格：

```
 <form id="create_event" method="post" action="{% url app.views.create_event course.id %}" >
        {% csrf_token %}
        {{ eventForm.as_p }}
        <input type="submit" value="add event">
    </form> 
```

在我的 urls.py 我有

```
(r'^item/(?P<item_id>\w+)/create_event/$', create_event),
(r'^item/(?P<item_id>\w+)/$', item), 
```

我的本地主机上同时具有 create_event 和 item 函数。

但是，由于某种原因，当我在服务器端（webfaction 上的 1.2.3，我坚持使用 1.2.3）的表单上按提交时，django 抛出以下错误：

```
Page not found (404)
Request Method: GET
Request URL:    http://my_url/item/1/create_event/app.views.course 
```

当我用硬编码的 URL 替换 {% url app.views.create_event course_id %} 时，它仍然以某种方式将方法名称附加到 URL。这可能是 1.2.3 还没有我从 1.3 开始使用的一些功能的问题吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:08:20.103

尝试将您的网址更改为：

```
(r'^item/(?P<item_id>\w+)/$', item, name='item'), 
```

然后将您的重定向更改`create_event`为：

```
return redirect('item', item_id = item_id) 
```

# javascript - 从另一个数组中减去数组

> ID：11966308
> 
> 赞同：1
> 
> 时间：2012-08-15T08:40:22.973
> 
> 标签：javascript

我有一个包含八个值的数组。我有另一个具有相同数量值的数组。我可以简单地从彼此中减去这些数组吗？

这是一个例子：

```
var firstSet =[2,3,4,5,6,7,8,9]
var secondSet =[1,2,3,4,5,6,7,8]

firstSet - secondSet =[1,1,1,1,1,1,1,1] //I was hoping for this to be the result of a substraction, but I'm getting "undefined" instead of 1.. 
```

这应该如何正确完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:43:07.773

像这样：

```
var newArray = [];
for(var i=0,len=firstSet.length;i<len;i++)
  newArray.push(secondSet[i] - firstSet[i]); 
```

请注意，它`secondSet`的数量应与`firstSet`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T08:44:34.050

试试这个：

```
for (i in firstSet) {
    firstSet[i] -= secondSet[i];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T08:43:27.337

逐元素减法应该起作用：

```
var result = [];

for (var i = 0, length = firstSet.length; i < length; i++) {
  result.push(firstSet[i] - secondSet[i]);
}

console.log(result); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T08:44:53.680

```
var firstSet = [2,3,4,5,6,7,8,9]
var secondSet = [1,2,3,4,5,6,7,8]

var sub = function(f, s) {
    var st = [], l, i;
    for (i = 0, l = f.length; i < l; i++) {
        st[i] = f[i] - s[i];
    }

    return st;
}

console.log(sub(firstSet, secondSet));​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T09:37:17.517

您所追求的是类似于 Haskell 的“zipWith”功能

"zipWith (-) xs ys"，或者在 Javascript 语法中 "zipWith(function(a,b) { return a - b; }, xs, ys)" 返回一个数组 [(xs[0] - ys[0] ), (xs[1] - ys[1]), ...]

Underscore.js 库为这类事情提供了一些不错的功能。它没有 zipWith，但它有 "zip"，它将一对数组 xs, ys 转换为一对数组 [[xs[0], ys[0]], [xs[1], ys[ 1]], ...]，然后您可以将减法函数映射到：

_.zip(xs, ys).map(function(x) { return x[0] - x[1]; })

您可能会发现这很有趣[https://github.com/documentcloud/underscore/issues/145](https://github.com/documentcloud/underscore/issues/145)

# bash - 前导美元符号如何影响 Bash 中的单引号？

> ID：11966312
> 
> 赞同：77
> 
> 时间：2012-08-15T08:40:41.437
> 
> 标签：bash, quotes, double-quotes, single-quotes

我需要从 Bash CLI 将字符串作为参数传递给程序，例如

```
program "don't do this" 
```

该字符串可能包含任何字符，如`'$'`,`'\'`等，我不希望 Bash 进行任何修改。所以我考虑使用单引号。

但是以下方法不起作用：

```
 program 'don\'t do this'            //escape doesn't work in single quote 
```

虽然以下两项有效：

```
 program $'dont\'t do this'          //seems fine, but any other side effects?
 program 'dont'\''do this'           //breaking into 3 parts 
```

第一种方法似乎更好，因为它获得的预修改更少（将美元符号放在前面并将每个替换`\`为`\\`），但我不知道美元符号还能做什么。

我真的用谷歌搜索了这个，但我找不到我需要的东西......

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-08-15T08:46:16.940

它会导致转义序列被解释。

```
$ echo $'Name\tAge\nBob\t24\nMary\t36'
Name    Age
Bob     24
Mary    36 
```

扩展这些序列后，结果是单引号，就好像美元符号不存在一样。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-08-15T08:48:14.763

用作前缀告诉BASH`$`尝试查找具有该名称的变量。`$'`是一种特殊语法（[在此处进行了充分解释](http://www.gnu.org/software/bash/manual/html_node/ANSI_002dC-Quoting.html#ANSI_002dC-Quoting)），它支持 ANSI-C 字符串处理。在这种情况下，单个刻度不是“在下一个刻度之前逐字获取值”。使用起来应该很安全。缺点是它只是 BASH 并且非常少见，所以很多人会想知道它的含义。

更好的方法是使用单引号。如果您需要字符串中的单引号，则需要将其替换为`'\''`. 这将结束前一个单引号字符串，为其添加一个单引号 ( `\'`)，然后开始一个新的单引号字符串。[这种语法适用于Bourne shell](http://en.wikipedia.org/wiki/Bourne_shell)的任何后代，它很容易理解并且大多数人很快就能识别出这种模式。

另一种方法是替换每个单引号，`'"'"'`它转换为“终止当前的单引号字符串，附加仅包含一个单引号的双引号字符串，重新启动单引号字符串”。这避免了转义字符并且看起来很好对称。如果您需要在双引号字符串中使用双引号，它也可以反过来工作：`"'"'"`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-06T10:11:37.707

您找不到比以下更快或更有效的方法：

```
eval RESULT=\$\'$STRING\' 
```

一方面，这是**eval**的用途，并且您可以避免在所有地方分叉子流程的疯狂成本，正如之前的答案似乎暗示的那样。你的例子：

```
$ foo='\u25b6'
$ eval bar=\$\'$foo\'
$ echo "$bar"
▶ 
```

# php - 如何使用 jQuery.parseJSON 绕过换行符

> ID：11966314
> 
> 赞同：4
> 
> 时间：2012-08-15T08:41:01.097
> 
> 标签：php, javascript, jquery

使用 jQuery.parseJSON() 解析 json 时，出现此错误

```
SyntaxError: JSON.parse: bad control character in string literal 
```

快速搜索表明这是由 json 字符串中的换行符引起的。

我使用 json_encode() 从 PHP 获取我的 json 字符串。

有没有办法以 jQuery.parseJSON() 不会抱怨并仍然保留换行信息的方式对其进行编码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T08:57:50.023

根据 v8 错误跟踪器（[http://code.google.com/p/v8/issues/detail?id=616](http://code.google.com/p/v8/issues/detail?id=616)），这实际上是正确的行为：

“JSON 字符串中不允许换行（没有控制字符，例如，参见 ECMA262 5ed 的 JsonStringCharacter 生产，第 15.2.1.1 节）。”

因此，这实际上取决于您要做什么-在这种情况下，由于需要换行符，因此需要在进行 json 解析之前对其进行转义：

```
//myjsonobject contains the json object

var obj = jQuery.parseJSON(myjsonobject.replace(/\n/g,"\\n")); 
```

# sql - 两个表之间的依赖路径

> ID：11966320
> 
> 赞同：1
> 
> 时间：2012-08-15T08:41:38.743
> 
> 标签：sql, sql-server

在我们的系统中，所有的数据移动都是由存储过程完成的。有很多遗留表和过程，很难找到数据是如何从一个表转换到另一个表的。所以过程是 Table1 -> Stored proc 1 将其转换为 -> Table 2 -> Stored proc 2 将其转换为 Table 3 等

我知道可以从某些系统表中读取依赖项

```
Select Distinct
SysObjects.Name 'Table Name',
Procedures.Name 'Stored Procedure'
From SysObjects
Join (SysObjects Procedures
Join SysDepends
on Procedures.Id = SysDepends.Id)
On SysDepends.DepId = SysObjects.Id
Where SysObjects.XType = 'U'
And Procedures.XType = 'P'
Group by SysObjects.Name,
SysObjects.Id,
Procedures.Name
Order by SysObjects.Name Asc 
```

MS SQL 中是否有任何分析函数来查找两个表之间的可能路径？

我正在使用 MS 2008R2 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:48:31.597

If you know the names of the tables, you can search the SP definition for their names.

```
SELECT name from sysobjects 
where Xtype='p' and OBJECT_DEFINITION(id) like '%tablename%' 
```

# c++ - 关于direct3d 关于D3DXCreateTextureFromFileEx 的方法

> ID：11966327
> 
> 赞同：1
> 
> 时间：2012-08-15T08:41:52.030
> 
> 标签：c++, directx, textures, direct3d

我可以用 gif 图片创建纹理对象吗？我尝试这样做并成功编译和链接，但无法启动。

```
if(D3DXCreateTextureFromFileEx(g_D3DDevice, file, 0, 0, 0, 0,
    D3DFMT_UNKNOWN, D3DPOOL_MANAGED, D3DX_DEFAULT,
    D3DX_DEFAULT,  colorkey,   &info,  NULL, 
    &m_textureList[index].image) != D3D_OK) return false; 
```

也许我应该改变一些参数？对不起，direct3d 的新功能。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:45:46.137

> 我可以用 gif 图片创建纹理对象吗？

[不与`D3DXCreateTextureFromFileEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172802%28v=vs.85%29.aspx)：

> 此函数支持以下文件格式：.bmp、.dds、.dib、.hdr、.jpg、.pfm、.png、.ppm 和 .tga。见`D3DXIMAGE_FILEFORMAT`。

# authentication - Apache 服务器无法启动（Bitnami Redmine Stack - 2.0-3-1）

> ID：11966329
> 
> 赞同：0
> 
> 时间：2012-08-15T08:42:08.410
> 
> 标签：authentication, tortoisesvn, redmine, bitnami

我一直试图让我的头脑与Redmine一起工作，我已经下载了`TortoiseSVN 1.7.7` *（Build 22907 - 64 Bit（Subversion 1.7.5））*。

我已经能够将用户添加到 Redmine，添加项目，将它们与 TortoiseSVN 链接。但是在尝试使用 TortoiseSVN 添加经过身份验证的用户时遇到了障碍。

问题似乎在于某些 DSO 文件。我一直在关注 TortoiseSVN 手册中的[Apache Based Server页面来配置 Apache 服务器以进行用户身份验证。](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-apache.html#tsvn-serversetup-apache-7)

TortoiseSVN 手册中的说明告诉我们

1.  使用 Windows 资源管理器，进入 Subversion 的安装目录（通常为 c:\program files\Subversion），找到文件 `/httpd/mod_dav_svn.so`和`mod_authz_svn.so`. 将这些文件复制到 Apache 模块目录（通常是 c:\program files\apache group\apache2\modules ）。

2.  将文件从 Subversion 安装目录复制到 Apache bin 目录`/bin/libdb*.dll`。`/bin/intl3_svn.dll`

现在我看不到说明告诉我们的文件夹。也就是我自己手动安装TortoiseSVN的时候，看不到文件`libdb*.dll`，也找不到`httpd/`SVN的安装文件夹下的目录。

当我进行搜索时，我在 bitnami 堆栈下找到了所需的文件！

```
G:\Program Files\BitNami Redmine Stack\subversion\bin 
```

从这里我按照说明进行操作，最后我重新启动了 Apache 服务器，它不会再次启动。它一直在失败。可能有问题，我猜是需要复制的文件。因为我在 Tortoise SVN 的手动安装中没有看到它们。而是在 bitnami 堆栈中。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T14:29:12.790

BitNami Redmine Stack 已经包含一个 Apache 服务器和一个 Subversion 服务器。它是您使用的 Apache 服务器。您不需要将这些 dll 添加到 bin 文件夹中。您需要启用这些模块并在 httpd.conf 文件中添加适当的配置。

您需要在 httpd.conf 文件中取消注释这些模块：

```
LoadModule dav_module modules/mod_dav.so 
LoadModule dav_fs_module modules/mod_dav_fs.so 
LoadModule dav_svn_module modules/mod_dav_svn.so  
LoadModule authz_svn_module modules/mod_authz_svn.so 
```

`<Location>`最后根据您上面提到的指南添加一个部分。

# javascript - jQuery facybox 和galleriffic

> ID：11966334
> 
> 赞同：0
> 
> 时间：2012-08-15T08:42:49.380
> 
> 标签：javascript, jquery, conflict

我尝试使用的两个插件似乎存在冲突。

facybox 是一个灯塔插件： [https ://github.com/bitbonsai/facyBox/](https://github.com/bitbonsai/facyBox/)

这使得 div 出现并使页面的其余部分变暗。在那个 div 里面，我很想有一个画廊幻灯片： [http ://www.twospy.com/galleriffic/](http://www.twospy.com/galleriffic/)

如果galleriffic幻灯片放映在div facybox使用的iframe中，一切正常，但如果我尝试初始化包含facybox使用的div的页面内的galleriffic，它会中断。

我在 javascript 方面不是很有经验，所以我想知道是否有人可以给我任何关于寻找什么来解决这个冲突的提示。当两个插件都尝试利用某个事件时，是否会出现这种情况？

# excel - 如何使用列名和行名将excel数据导入R

> ID：11966335
> 
> 赞同：7
> 
> 时间：2012-08-15T08:42:50.290
> 
> 标签：excel, r, import

我是 R 新手，想知道如何使用行名和列名将 excel 数据导入 R。具体来说，我需要一个excel文件中的多个工作表中的数据子集。我可以使用行名和列名来识别某些数据单元并将其提取到 R 吗？

```
Worksheet 1
----------
* X Y Z 
A 1 2 2
B 1 1 1
C 1 3 4
D 4 2 2
E 2 2 2 
----------
Worksheet 2
----------
*  X Y1 Z1 
A 1  2  2
B 1  2  3
C 1  3  4
D 4  1  1
E 2  1  1 
```

例如在上面的电子表格中，我如何使用工作表 1 中的行名和列名 (D,Y) (D,Z) (E,Y) (E,Z) 提取数据 (2,2,2,2)

如何使用工作表 2 中的行名和列名 (D,Y1) (D,Z1) (E,Y1) (E,Z1) 提取数据 (1,1,1,1)？

感谢您提供的任何帮助

巴里

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T10:59:14.633

@Andrie 提到了 XLConnect 包，它是 R 和 Excel 之间非常有用的 I/O 包，可以在 Excel 表中选择区域。

我在我的 Dropbox 公共文件夹中创建了一个与您类似的 Excel 文件，您可以在[此处](https://dl.dropbox.com/u/8750577/example.xls)`example.xls`下载该文件。

```
require(XLConnect)

## A5:C5 correspond to (D,Y) (D,Z) (E,Y) (E,Z)  in your example
selectworksheet1 <- readWorksheetFromFile("/home/ahmadou/Dropbox/Public/example.xls",
                               sheet = "Worksheet1", 
                               region = "A5:C5", header = FALSE)

selectworksheet1
##  Col0 Col1 Col2
## 1    2    2    2

## B4:C5 correspond to (D,Y1) (D,Z1) (E,Y1) (E,Z1) in the second example
selectworksheet2 <- readWorksheetFromFile("/home/ahmadou/Dropbox/Public/example.xls",
                         sheet = "Worksheet2", 
                         region = "B4:C5", header = FALSE)

selectworksheet2
##   Col0 Col1
## 1    1    1
## 2    1    1

unlist(selectworksheet2)
## Col01 Col02 Col11 Col12 
##    1     1     1     1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T09:25:00.407

有几个包提供了将 Excel 数据导入 R 的功能；请参阅[R 数据导入/导出](http://cran.r-project.org/doc/manuals/R-data.html#Reading-Excel-spreadsheets)文档。

我发现[xlsx](http://cran.r-project.org/web/packages/xlsx/index.html)包很有用（它将读取 .xls 和 .xlsx 文件）。我不相信它会接受行/列名称作为输入，但它会接受它们的数值（例如第 1 行，第 4 列）。在您的情况下，假设 X、Y 和 Z 对应于第 1-3 列，这样的事情应该可以工作：

```
library(xlsx)
# first example subset; call it ss1
# assume first row is not a header; otherwise requires header = T
ss1 <- read.xlsx("myfile.xlsx", sheetIndex = 1, rowIndex = 4:5, colIndex = 2:3)

# second example subset; call it ss2
# just the same except worksheet index = 2
ss2 <- read.xlsx("myfile.xlsx", sheetIndex = 2, rowIndex = 4:5, colIndex = 2:3) 
```

但是，您需要对自己的文件进行试验，直到一切正常。您也可以指定*sheetName*但我发现*sheetIndex*通常更可靠，一旦您确定了每张工作表的正确索引。如果第一行是标题，请注意。

说了这么多：我的首选是将工作表导出为文本格式，例如 CSV，使用 shell 工具（剪切、头部、尾部*等*）获取所需的行/列并将其导入 R。

# asp.net-mvc - 为什么在 MVC 4 中做 POST 会引发异常？

> ID：11966337
> 
> 赞同：5
> 
> 时间：2012-08-15T08:42:53.183
> 
> 标签：asp.net-mvc, asp.net-web-api

我正在尝试做这样的 POST：

```
 HttpClient hc = new HttpClient();
    byte[] bytes = ReadFile(@"my_path");

    var postData = new List<KeyValuePair<string, string>>();
    postData.Add(new KeyValuePair<string, string>("FileName", "001.jpeg"));
    postData.Add(new KeyValuePair<string, string>("ConvertToExtension", ".pdf"));
    postData.Add(new KeyValuePair<string, string>("Content", Convert.ToBase64String(bytes)));

    HttpContent content = new FormUrlEncodedContent(postData);
    hc.PostAsync("url", content).ContinueWith((postTask) => {
    postTask.Result.EnsureSuccessStatusCode();
    }); 
```

但我收到了这个例外：

> 无效的 URI：Uri 字符串太长。

抱怨这条线：`HttpContent content = new FormUrlEncodedContent(postData);`。对于小文件，它可以工作，但我不明白为什么对于较大的文件它不起作用？

当我发布内容时，**内容**可能会更大......那为什么它会抱怨 URI？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:48:42.847

You should use MultipartFormDataContent ( [http://msdn.microsoft.com/en-us/library/system.net.http.multipartformdatacontent%28v=vs.110%29](http://msdn.microsoft.com/en-us/library/system.net.http.multipartformdatacontent%28v=vs.110%29) ) instead of FormUrlEncodedContent, which sends your data as "application/x-www-form-urlencoded".

So even if your using the POST verb, it is still POSTing to a very long url containing your data, hence the error.

> The content type "application/x-www-form-urlencoded" is inefficient for sending large quantities of binary data or text containing non-ASCII characters. The content type "multipart/form-data" should be used for submitting forms that contain files, non-ASCII data, and binary data.

See : [http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1)

For a sample, have a look at this answer : [ASP.NET WebApi: how to perform a multipart post with file upload using WebApi HttpClient](https://stackoverflow.com/questions/10339877/asp-net-webapi-how-to-perform-a-multipart-post-with-file-upload-using-webapi-ht)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-22T13:07:35.470

我知道这已经得到解答，但我遇到了同样的问题，发现这是 FormUrlEncodedContent 类中的一个限制。错误的原因是对象的编码正在由`Uri.EscapeDataString()`. [这篇文章在 CodePlex 上进行了解释。](https://aspnetwebstack.codeplex.com/workitem/1963)我最终使用 HTTPUtility 类提出了自己的 Url Encode 解决方案。

```
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Web;

namespace Wfm.Net.Http
{
    public class UrlContent : ByteArrayContent
    {
        public UrlContent(IEnumerable<KeyValuePair<string, string>> content)
            : base(GetCollectionBytes(content, Encoding.UTF8))
        {
        }

        public UrlContent(byte[] content, int offset, int count) : base(content, offset, count)
        {
        }

        private static byte[] GetCollectionBytes(IEnumerable<KeyValuePair<string, string>> c, Encoding encoding)
        {
            string str = string.Join("&", c.Select(i => string.Concat(HttpUtility.UrlEncode(i.Key), '=', HttpUtility.UrlEncode(i.Value))).ToArray());
            return encoding.GetBytes(str);
        }
    }

} 
```

我写了一篇关于我如何实现它的小[文章。](http://webforwardmedia.com/formurlencodedcontent-invalid-uri-uri-string-long/)希望这可以帮助任何有同样问题的人。

# javascript - 评估空字符串的值

> ID：11966338
> 
> 赞同：1
> 
> 时间：2012-08-15T08:42:59.320
> 
> 标签：javascript

为什么是

```
console.log('' == false); //true 
```

但

```
console.log('' === false); //false 
```

基于[此](http://www.mapbender.org/JavaScript_pitfalls%3a_null,_false,_undefined,_NaN)，最后一行应该返回 true，对吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T08:45:14.153

因为`===`检查类型并且字符串是字符串，而 false 是布尔值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T08:45:25.553

不，当您`===`在 javascript 中使用时，您也在比较**type**，[请参阅这篇](http://longgoldenears.blogspot.co.uk/2007/09/triple-equals-in-javascript.html)更详细解释的文章。

# vba - VBA Excel：重命名列以便于引用

> ID：11966342
> 
> 赞同：3
> 
> 时间：2012-08-15T08:43:11.757
> 
> 标签：vba, excel, range, named-ranges

我正在编写一个脚本，将数据从 Excel 单元格传输到不同的单词表。到目前为止，我正在这样做：

```
 wordDoc.Bookmarks("Editor").Range.Text = Sheets("Product Eval").Range("E" & evalRow).Text 
```

其中 evalRow 是之前计算的。

现在，我想避免当有人在 E 列之前添加一列时，我必须重写整个代码。是否可以重命名整个列，即使它们被移动，它们也会保留它们的名称，并且我可以引用一个特定的单元格VBA中的那个列名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T12:45:48.127

自己解决了这个问题：

*   标记整列
*   在 Excel 2007 左上角的“名称框”中写入所需的名称，然后按 Enter

在 VBA 中，以下代码针对特定列中的第 4 行（根据列标题，我将列命名为“Employees”）：

```
 test = Sheets("Sheet1").Range("Employees").Cells(4, 1).Text 
```

请注意，使用列时，单元格的第二个参数始终必须为 1（否则您将离开列）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:07:22.647

是的。要命名一个范围，你应该

1.  在excel中选择范围
2.  单击“名称”框并输入您要输入的名称。
3.  现在在公式中，您可以按您定义的名称访问单元格/范围。

# c# - Html.BeginForm Post 去 HttpGet 操作而不是 IE 中的 HttpPost，在 Chrome 和 Firefox 中很好

> ID：11966345
> 
> 赞同：9
> 
> 时间：2012-08-15T08:43:18.260
> 
> 标签：c#, asp.net-mvc-3, razor

我的 Razor 视图中有以下内容：

```
 @using (Html.BeginForm("Edit", "MyController", FormMethod.Post))
{
    <div class="grid_1">&nbsp;</div>
    <div id="ValSummary"> @Html.ValidationSummary(false)</div>

    @Html.EditorFor(x => x.Role, MVC.Shared.Views.EditorTemplates.KeyValuePairSelectList, new { SelectListOptions = Model.RoleSelectList })<br /><br />
    @Html.EditorFor(x => x.Trust, MVC.Shared.Views.EditorTemplates.KeyValuePairSelectList, new { SelectListOptions = Model.TrustSelectList.OrderBy(x => x.Text) })<br /><br />
    @Html.EditorFor(x => x.GmcCode)<br /><br />

    <div class="createbutton">
        <input id="btnGoBack" type="button" value="Back"/>  
        <input id="btnSubmit" type="button" value="Submit" />
    </div>

} 
```

在我的控制器中，我有

```
[HttpGet]
public virtual ActionResult Edit(string id)
{
}

[HttpPost]
public virtual ActionResult Edit(ViewModel viewModel)
{
} 
```

在 Firefox 和 Chrome 中一切正常，但在 IE 中，当提交表单时，触发的是 HttpGet 操作而不是 HttpPost。

调用堆栈或 IE 开发人员工具控制台中没有任何线索。

有什么明显的我失踪了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T08:52:41.113

您的提交按钮应该是一个真正的提交[按钮](http://www.w3.org/TR/html401/interact/forms.html#edef-BUTTON)`type="Submit"`

```
<input id="btnSubmit" type="submit" value="Submit" /> 
```

在所有浏览器中正确提交表单。

有关更多差异，请参阅此 SO 问题：[<input type='button' /> 和 <input type='submit' /> 之间的区别](https://stackoverflow.com/questions/290215/difference-between-input-type-button-and-input-type-submit)

# drop-down-menu - OneToOne 关系中 jsf 的下拉菜单

> ID：11966352
> 
> 赞同：0
> 
> 时间：2012-08-15T08:43:38.257
> 
> 标签：drop-down-menu, jsf-2, selectonemenu

我想在 jsf 中为 OneToOne/ManyToOne 关系使用简单的下拉菜单

人.java

```
package com.aminpy.create;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToOne;

@Entity
public class Person {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;
    private String firstName;
    private String lastName;
    private Phone phone;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    @OneToOne
    public Phone getPhone() {
        return phone;
    }

    public void setPhone(Phone phone) {
        this.phone = phone;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    @Override
    public String toString() {
        return firstName + " " + lastName;
    }
} 
```

托管 bean -> PersonPage.java

```
package com.aminpy.create;

import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;

@ManagedBean
@SessionScoped
public class PersonPage {
    private Person person;
    private List<Phone> phoneList;
    private EntityManagerFactory emf;
    private EntityManager em;

    public Person getPerson() {
        if (person == null) {
            person = new Person();
        }
        return person;
    }

    public void setPerson(Person person) {
        this.person = person;
    }

    public List<Phone> getPhoneList() {
        if (phoneList == null) {
            emf = Persistence.createEntityManagerFactory("manager1");
            em = emf.createEntityManager();
            Query query = em.createQuery("select p from Phone p");
            phoneList = query.getResultList();
            em.close();
        }
        return phoneList;
    }

    public void setPhoneList(List<Phone> phoneList) {
        this.phoneList = phoneList;
    }

    public String btnCreate() {
        emf = Persistence.createEntityManagerFactory("manager1");
        em = emf.createEntityManager();

        em.getTransaction().begin();
        em.persist(person);
        em.getTransaction().commit();
        System.out.println("Record Stored!");
        em.close();

        return null;
    }
} 
```

这是我的 index.xhtml 页面

```
<h:form id="person_form">
    <h:inputText value="#{personPage.person.firstName}" />
    <h:inputText value="#{personPage.person.lastName}" />
    <h:selectOneMenu value="#{personPage.person.phone}">
        <f:selectItems value="#{personPage.phoneList}" var="ph"
            itemLabel="#{ph.number}" itemValue="#{ph.id}" />
    </h:selectOneMenu>
    <h:commandButton value="save" action="#{personPage.btnCreate}" />
</h:form> 
```

我的关系在 main() 函数中没有任何问题，但是当我提交带有此错误的表单时出现问题

```
sourceId=person_form:j_idt8[severity=(ERROR 2), summary=(Conversion Error setting value 'class com.aminpy.create.Phone' for 'null Converter'.), detail=(Conversion Error setting value 'class com.aminpy.create.Phone' for 'null Converter'.)] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T11:09:56.817

您需要创建一个可以在和[`Converter`](http://docs.oracle.com/javaee/6/api/javax/faces/convert/Converter.html)之间转换的自定义 JSF 。`String``Phone`

```
@FacesConverter(forClass=Phone.class)
public class PhoneConverter implements Converter {

    @Override
    public Object getAsObject(FacesContext ctx, UIComponent component, java.lang.String value) {
        // Write code here which converts from String to Phone.
    }

    @Override
    public String getAsString(FacesContext ctx, UIComponent component, Object value) {
        // Write code here which converts from Phone to String.
    }

} 
```

此外，您应该替换`itemValue`to be`#{ph}`而不是`#{ph.id}`.

### 也可以看看：

*   [“空转换器”的转换错误设置值](https://stackoverflow.com/questions/4734580/jsf-2-selection-combo-box-with-without-conversion-strategy/4735322#4735322)

# php - codeigniter - 在控制器中使用帮助器不起作用

> ID：11966355
> 
> 赞同：6
> 
> 时间：2012-08-15T08:43:50.400
> 
> 标签：php, codeigniter, controller, helper

我需要在多个控制器中使用一个功能。所以我想使用自定义助手，但似乎我无法让它工作。（它在视图中有效，但我在控制器中需要它）

它给了我以下致命错误：

> 致命错误：在第 12 行的 /application/controllers/developers.php 中调用未定义的方法 Developers::checkIfLoggedIn()

使用助手在多个控制器中使用功能是明智之举，还是我应该这样做。

提前致谢，
马克

**编辑：**
控制器文件：

```
if (!defined('BASEPATH')) exit('No direct script access allowed');

class Developers extends CI_Controller
{
    public function __construct()
    {
         parent::__construct()
         $this->load->helper('form');
         $this->load->helper('url');
         $this->load->helper('login');

         //helper function
         checkIfLoggedIn($this->session->userdata('loggedIn'));
    }
} 
```

帮助文件：

```
if (!defined('BASEPATH')) exit('No direct script access allowed');

if (!function_exists('checkIfLoggedIn'))
{
    function checkIfLoggedIn($session_loggedIn)
    {
        $loggedIn = $session_loggedIn;
        if($loggedIn == false)
        {
            redirect('login/');
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-15T09:26:05.360

在您的控制器中，您以错误的方式使用它，它不是控制器的方法，因此您不能`$this`用来调用它。

> 可以在控制器函数中的任何位置（甚至在您的视图文件中，尽管这不是一个好习惯）中加载帮助程序，只要您在使用它之前加载它。您可以在控制器构造函数中加载您的助手，以便它们在任何函数中自动可用，或者您可以在需要它的特定函数中加载助手。

要加载帮助程序，您可以使用

```
$this->load->helper('name'); // name is the name of the file without extention 
```

> 与 CodeIgniter 中的大多数其他系统不同，Helper 不是以面向对象的格式编写的。它们是简单的程序函数。每个辅助函数执行一项特定任务，不依赖于其他函数。

因此，要在控制器中调用辅助函数，您不应该使用

```
$this->function_name(); 
```

改为使用

```
function_name(); 
```

例如，如果您在名为`myCustomHelper.php`如下的帮助文件中有一个帮助函数

```
function myHelper()
{
    // code
} 
```

然后您可以将其加载到控制器中并按如下方式调用它

```
$this->load->helper('myCustomHelper');
myHelper(); // call the function 
```

但最好在构造函数中加载帮助程序，这样它就可以在整个脚本中使用。

**更新：**如果您的帮助文件的名称是，`login_helper.php`那么您可以在控制器中使用它，如下所示

```
$this->load->helper('login_helper');
checkIfLoggedIn($this->session->userdata('loggedIn')); 
```

[**在这里阅读更多**](http://codeigniter.com/user_guide/general/helpers.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T18:45:42.373

好的，我知道这个问题已经在 5 个月前被问过了，但也许有些人会觉得这很有用。我刚刚遇到了同样的问题，发现我的辅助函数的文件名是 CodeIgniter 已经使用的文件名。

因此，如果您没有收到警告：“无法加载请求的文件”，而是收到警告：“致命错误：调用未定义的函数 [function_name]，您可能正在使用本机已经存在的文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-22T15:31:18.470

Helpers 是在 codeigniter 中声明全局函数的理想方式，并且您所做的是正确的。以下只是对您有帮助的几点。

*   通过单行而不是单独的行加载所有帮助程序。

    ```
    $this->load->helper('form');
    $this->load->helper('url');
    $this->load->helper('login');
    ```

    ```
    $this->load->helper(array('form','url','login'));

    ```

*   如果你想让它在所有控制器文件中都是全局的，那么你可以把它放在' `config/`'目录中的 autoload.php 文件中。更新`$autoload['helper']`变量如下：

    ```
    $autoload['helper'] = array('url','site');
    ```

来源：[如何在 CodeIgniter 中创建和调用全局 PHP 函数](https://webolute.com/blog/programming/how-to-create-call-global-php-functions-in-codeigniter)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T09:25:24.260

而是创建一个库类并在那里定义您的函数。然后在控制器中加载库并调用库的函数。您可以在任何控制器中加载库并使用其方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-25T17:44:10.503

关于相关问题：将 $this->load 放入 __constructor 时要小心：在 PHP 中，您必须然后显式调用 parent::__construct(); 否则不再调用父构造函数，留下 $this->load 未定义。上面的解决方案是正确的，但很容易被忽视。

```
class My extends CI_Controller {
public function __construct() { 
parent::__construct();
$this->load->helper('url'); } 
```

如果您不这样做，您将收到错误消息 My::$load 不存在并且帮助程序不会加载。

# java - 项目外部的 Java 源代码结构

> ID：11966361
> 
> 赞同：2
> 
> 时间：2012-08-15T08:44:16.177
> 
> 标签：java, netbeans

我正在尝试构建一个新的 Java 代码库并且有一个我需要指导的问题。

拥有一个包含与包名称结构一致的所有代码的单一目录树的存储库似乎是明智的。我有几个项目使用这个源代码，并希望这些项目使用中央存储库中的代码。我发现netbeans 反对这一点。我可以很好地设置我的第一个项目，我添加顶级 src 文件夹并包含/排除文件夹以识别项目的特定代码。第二个项目虽然导致 netbeans 反对说“项目中已使用的包文件夹”。

我的第一个问题是，我是否想通过使用包含多个项目的单个 Java 存储库使用不同部分的代码来做一些非常规的事情。

其次，我如何配置 netbeans 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T11:38:30.523

不知道这是否为时已晚...

在第二个项目中创建指向原始源的链接。

这就是我所拥有的。。

```
C:\dev\shared\src
C:\dev\ProjectOne\src (This includes the shared source just fine)
C:\dev\ProjectTwo\src (This one causes the warning when you add the shared src folder) 
```

因此，（在 Windows 上）将 CD 放入`C:\dev\ProjectTwo\` mklink /D sharedSrc`C:\dev\shared\src`

结果：

```
C:\dev\ProjectTwo\sharedSrc 
```

告诉 netbeans 引用 sharedSrc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T10:54:23.903

当您在一个文件夹中创建 NetBeans 项目时，NetBeans 会创建包含所有项目设置的 nbproject 文件夹。您不能这样做 NetBeans 使用另一个文件夹名称。因此，一个文件夹只能包含一个 NetBeans 项目。

当然，您可以打开“projectui.properties”文件并复制所需项目的属性（openProjectsDisplayNames.nn、openProjectsURLs.nn 和 openProjectsIcons.nn），但新项目将使用相同的“nbproject”文件夹。:-)

因此，我看到了使用一个源库的下一个正确方法。

- 创建新项目的文件夹

- 在此文件夹中创建具有自定义源路径的 NetBeans“自由形式”项目

对于 maven 项目，解决方案是相同的：使用自定义 pom.xml 分隔文件夹。

# javascript - 获取选择中的光标位置 - 相对于文档

> ID：11966369
> 
> 赞同：2
> 
> 时间：2012-08-15T08:44:45.047
> 
> 标签：javascript, caret

**样本**

> 这是**可编辑**div 中的一些文本。这可以跨越多行、多段等等。我想要做的是在**这里**找到插入符号的相对位置。意思是，插入符号位于 {top:'5px', left:'250px'}，相对于 div 或文档。

这个想法是然后提供带有选项的下拉菜单。这是直接可能的还是我必须根据`div line-height, padding,.. + caret position`等来制定解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T08:48:56.910

从 rangy 检查这个演示。也许正是您正在寻找的：

[https://github.com/timdown/rangy/blob/master/demos/position.html](https://github.com/timdown/rangy/blob/master/demos/position.html)

如果您查看代码，您将能够看到：

```
var startPos = rangy.getSelection().getStartDocumentPos(); // get x, y of selection/cursor 
```

然后你可以使用`startPos.x`和`startPos.y`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T00:30:34.973

我已经深入研究了 Rangy 的代码（太棒了！但是将其完全包含在我的用例中有点过头了），只要有人不需要完全的跨浏览器兼容性，她就可以使用本机单线：

`var pos = window.getSelection().getRangeAt(0).getClientRects()[0]`

然后你将有可用`top`的 , `bottom`,`right`和`left`on `pos` *（好吧，我撒谎了——不是真正的单线，它必须被包装以检查是否有一些范围）。*

我只需要它与 Firefox 一起工作，所以对我来说就足够了。

概括：

*   完全在 Firefox 17 / Chrome 23 中工作（**也可用于跟踪插入符号**，无需实际选择，也无需启用插入符号浏览）
*   但是请注意，当您单击页面的空白片段（而不是任何文本）时， *您实际上会将插入符号移动到某处*（启用插入符号浏览 -`F7`在 Firefox 中 - 以查看位置）。当您在段落之间单击时，它通常是段落的结尾——如果您单击它旁边，或者光标上方最接近的文本。
*   在 Opera 12 中，仅当有非空选择时才有效。
*   在 IE8 上不起作用，在 IE9 和 IE10 上都没有检查过。

演示（不适用于 JSFiddle，所以我将其全部转储在这里）：

```
<!DOCTYPE html>
<head>
    <script type="text/javascript">
    var getSelectionTopLeft = function (){
        var selection = window.getSelection();
        var rangePos, x, y;
        if(selection.rangeCount) {
            rangePos = window.getSelection().getRangeAt(0).getClientRects()[0];
            // you can get also right and bottom here if you like
            x = parseInt(rangePos.left);
            y = parseInt(rangePos.top);
            console && console.log("found selection at: x=" + x + ", y=" + y);
        }else{
            x = 0;
            y = 0;
            console && console.log("no selections found");
        }
        return {x: x, y: y};
    }
    var move = function (offsetX, offsetY){
        var coords = getSelectionTopLeft();
        var square = document.getElementById('square');
        square.style.left = (coords.x + offsetX) + 'px';
        square.style.top = (coords.y + offsetY) + 'px';
    }
    </script>
    <style type="text/css">
    #square {position:absolute; top:0; left:0; width:10px; height:10px; background-color:red;}
    </style>
</head>

<body>
    <h1>Caret position test</h1>
    <div id="square"></div>
    <button onclick="move(5, 5)">move the square 5px/5px below the caret</button>

    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.
    Curabitur tempor pharetra iaculis. Ut tempor mauris et ligula
    aliquam sed venenatis dui pharetra. Duis dictum rutrum venenatis.
    Cras ut lorem justo.</p>

    <p>Nam vehicula elit tincidunt nibh elementum venenatis. Duis a facilisis sem.
    Morbi luctus porttitor feugiat. Nunc feugiat augue eu tortor interdum fermentum
    a tincidunt felis.</p>
</body>
</html> 
```

# wcf - OBJECT 类型成员的 Wcf 序列化

> ID：11966374
> 
> 赞同：1
> 
> 时间：2012-08-15T08:45:02.730
> 
> 标签：wcf, object, serialization

我有 DataContract (BalanceClassificationAttribute)，它有一个对象类型的字段。

```
[DataContract]
[KnownType(typeof(string))]
[KnownType(typeof(long))]
[KnownType(typeof(int))]
[KnownType(typeof(uint))]
public class BalanceClassificationAttribute
{
    /// <summary>
    /// Value of searching attribute.
    /// </summary>
    [DataMember]
    public Object Value
    {
        get;
        set;
    }
} 
```

该字段的值可以是 string、long、int、uint

A 添加了这些属性字节

```
[KnownType(typeof(string))]
[KnownType(typeof(long))]
[KnownType(typeof(int))]
[KnownType(typeof(uint))] 
```

但是这个 DataContract 不起作用。我还能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:01:45.040

[KnownTypeAttribute](http://msdn.microsoft.com/en-us/library/ms730167.aspx)的主要目的是处理肥皂消息反序列化中的类型继承场景。您正试图将其用作对原始类型执行数据转换的一种方式。您最安全的选择是通过对您在列表中引用的类型的一系列`TryParse`调用来处理值的数据转换`KnownType`。

# python - python中“in”和“for”操作的效率

> ID：11966376
> 
> 赞同：0
> 
> 时间：2012-08-15T08:45:06.120
> 
> 标签：python, performance

我在这里有两个列表，分别称为 A 和 B。

```
len(A) > len(B) 
```

有两种方法可以做某事：

方法一：

```
def f():
    return [someFunc(i) for i in A if i in B] 
```

方法二：

```
def f():
    return [someFunc(i) for i in B if i in A] 
```

哪个更有效，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T08:48:02.697

Both are O(mn), since you're iterating over each list for each element of the other list.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T08:54:35.690

虽然操作的时间复杂度`in`是`O(n)`，所以整个操作是`O(nm)`，但这主要适用于它如何随问题规模扩展。`A`在性能方面，除了和`B`互斥的最坏情况之外，它应该更快地执行`for B if i in A`(where `len(A) > len(B)`)，因为`in`一旦找到匹配项就会停止迭代。

`A`考虑所有条目和`B`具有相同值的最佳情况。该`in`操作将有效地`O(1)`和整个操作`O(m)`。

每个人都喜欢的一些基准：

```
$ python -m timeit "A=list(range(100000));B=list(range(100))" "[i for i in A if i in B]"
10 loops, best of 3: 113 msec per loop

$ python -m timeit "A=list(range(100000));B=list(range(100))" "[i for i in B if i in A]"
100 loops, best of 3: 2.6 msec per loop 
```

抛开性能不谈，请注意您提供的两个函数*做的不是同一件事*。第一个迭代`A`并丢弃未出现在中的值，`B`这与迭代`B`并丢弃未出现在中的值不同`A`。回到两个列表中的所有值都相同的场景，第一个函数将返回`len(A)`元素，而第二个`len(B)`元素将返回。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T08:49:55.700

```
def f(A, B):
    return [someFunc(_) for _ in set(A).intersection(B)] 
```

should be the most efficient way of doing this (at least if the lists are long enough for the time complexity to be of issue)

# solr - GlassFish v3 和 Solr 3.6 - JNDI 中没有 /solr/home

> ID：11966378
> 
> 赞同：1
> 
> 时间：2012-08-15T08:45:11.807
> 
> 标签：solr, glassfish

我将 Solr 3.6.1 与 GlassFish v3.1.2 一起使用。`dist/apache-solr-3.6.1`在设置以下 JVM 选项后，我通过自动部署来安装它：

```
asadmin create-jvm-options -Dsolr.solr.home=/mysolrhome/
asadmin create-jvm-options -Dsolr.data.dir=/mysolrhome/data 
```

但是，在 GlassFish 日志中，我注意到它打印出来

```
INFO: No /solr/home in JNDI
INFO: using system property solr.solr.home: /mysolrhome/ 
```

看起来我应该能够通过 JNDI 而不是 JVM 选项来定义 Solr 主目录。如果可能的话，我更喜欢使用 JNDI。因此，我尝试使用名称和一个没有名称且`java.lang.String`值为. 重新部署 Solr 战争文件后，它仍然会记录未找到的日志。我还尝试使用具有相同结果的名称创建 JNDI 自定义资源。`org.glassfish.resources.custom.factory.PrimitivesAndStringFactory``solr/home``/mysolrhome``/solr/home``/solr/home`

`solr/home`在 Glassfish 下为 Solr设置 JNDI 的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T13:03:54.980

在 Glassfish 控制台中设置系统属性“solr.solr.home”

[http://wiki.apache.org/solr/SolrGlassfish](http://wiki.apache.org/solr/SolrGlassfish)

或者在 domain.xml 中设置一个 env-entry 'solr/home'

[http://javahowto.blogspot.com/2010/04/glassfish-set-web-env-entry.html](http://javahowto.blogspot.com/2010/04/glassfish-set-web-env-entry.html)

# .net - 当日期/时间更改时，如何避免自定义计时器中的计时不一致？

> ID：11966386
> 
> 赞同：0
> 
> 时间：2012-08-15T08:45:28.183
> 
> 标签：.net, datetime, timer, c++-cli

我有一个计时器类，它使用本地机器的日期/时间来计算事情已经运行了多长时间，并设置在一段时间后到期的计时器。

我发现如果用户更改系统时间，这会对我的应用程序造成严重破坏，因为计时器突然认为他们已经过期或者他们记录的时间突然跳了一个小时（比如说）。

这些计时器当前通过多线程应用程序使用。

计时器/超时计时器运行时间从几秒到几天不等。

如何避免这些时间不一致？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:04:21.433

除了您找到的事件之外，您还可以使用[Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)之类的东西而不是系统时间来进行计时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T18:04:19.733

您可以使用 SystemEvents.TimeChanged 事件来获得通知。

您还需要担心机器的时区或夏令时规则的变化。.NET 通过在第一次检索日期时间时锁定区域来确保不会对计时器造成重大中断。换句话说，它确保计时器在其编程间隔而不是其绝对时间到期。如果这是一个问题（测试它），那么您需要通过调用 CultureInfo.ClearCachedData()（对于 TimeZone 和 DateTime）以及 TimeZoneInfo.ClearCachedData()（对于 TimeZoneInfo 和 DateTimeOffset）来明确清除该状态。

调整机器时钟时，许多其他事情可能会出错。例如文件系统时间戳。Linux 闰秒错误是最近发生的一个有趣事件。拥有可靠的时间源对于保持机器嗡嗡声非常重要，很容易从时间服务器获得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:08:45.877

在您在 SO 上发布内容之前，Google 搜索为何总是失败？如果其他人想做这样的事情，我发现有[一个可以使用的系统事件](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.timechanged%28v=vs.80%29.aspx)。

# php - 使用重复的 ID 将 csv 文件保存到 phpadmin 中。使用 php

> ID：11966397
> 
> 赞同：0
> 
> 时间：2012-08-15T08:45:56.190
> 
> 标签：php

我有一个 csv 文件，其中包含以下数据：

SUBJ_CODE 描述 时间 天 房间单位 EC-26765 FORLAN EL 9:30 - 10:30 AM MWF 203 3 EC-26773 IT 421 L 11:30 - 12:30 PM MWF CISC 1 EC-26781 IT 421 5:01 - 6： 31 PM TTH CISC 2 EC-26823 IT 420 8:30 - 11:30 AM SAT MA1 3 EC-26807 IT 423 3:00 - 4:30 PM TTH M1 3 EC-26799 IT 422 8:01 - 9:01 PM TTH 211 2 EC-26815 IT 422 L 6:31 - 8:01 PM TTH C1 1 ED-08326 FIL 38 7:30 - 9:00 AM TTH EDTE 3 IS-24331 MATH 16 12:00 - 1:30 PM TTH 203 3

我想将此 csv 文件保存到我的 phpadmin 中，如下所示： ID_NO SUBJ_CODE 描述 TIME DAYS ROOM UNITS 08329 EC-26765 FORLAN EL 9:30 - 10:30 AM MWF 203 3 08329 EC-26773 IT 421 L 11:30 - 12： 30 PM MWF CISC 1 08329 EC-26781 IT 421 5:01 - 6:31 PM TTH CISC 2 08329 EC-26823 IT 420 8:30 - 11:30 AM SAT MA1 3 08329 EC-26807 IT 423 3:00 - 4 :30 PM TTH M1 3 08329 EC-26799 IT 422 8:01 - 9:01 PM TTH 211 2 08329 EC-26815 IT 422 L 6:31 - 8:01 PM TTH C1 1 08329 ED-08326 FIL 38 7:30 - 上午 9:00 TTH EDTE 3 08329 IS-24331 数学 16 12:00 - 下午 1:30 TTH 203 3

这是我的代码：

```
 if(isset($_POST['submit']))     
    {

    if($_FILES["file"]["type"] != "application/vnd.ms-excel")
    {
        echo "This is not a CSV file.";
    }
    elseif(is_uploaded_file($_FILES['file']['tmp_name'])){

        //Process the CSV file
        $handle = fopen($_FILES['file']['tmp_name'], "r");
        $data = fgetcsv($handle, 10000, ","); //Remove if CSV file does not have column headings
        while (($data = fgetcsv($handle, 10000, ",")) !== FALSE) 
        {

            //$att = $myrow['STUD_ID'];
            $att0 = mysql_real_escape_string($data[0]);
            $att1 = mysql_real_escape_string($data[1]);
            $att2 = mysql_real_escape_string($data[2]);
            $att3 = mysql_real_escape_string($data[3]);
            $att4 = mysql_real_escape_string($data[4]);
            $att5 = mysql_real_escape_string($data[5]);

            $sql = "INSERT INTO schedule (IDNO,SUBJ_CODE,DESCRIPTION,TIME,DAYS,ROOM,UNITS)
                                  VALUES ('$att','$att0','$att1','$att2','$att3','$att4','$att5')";
            mysql_query($sql);
        }
        mysql_close($evancon);
        echo "<script>alert('CSV file successfully imported.');</script>";
    }
    else{
        die("You shouldn't be here");
    }
    }
        ?> 
```

希望你能回答这个问题....谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:47:45.440

我假设的`ID_NO`列是主键，所以你不能有重复。通过您的示例数据的外观，您可以创建一个复合主键，`ID_NO`并且`SUBJ_CODE`它是唯一的。

# error-handling - 停止出现带有自定义错误代码的警告对话框 - LabVIEW

> ID：11966399
> 
> 赞同：1
> 
> 时间：2012-08-15T08:46:08.223
> 
> 标签：error-handling, labview, custom-errors

我使用“错误代码编辑器”创建了一个自定义错误文件，我想禁用在检测到我的错误代码时出现的警告对话框。我怎样才能做到这一点？

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<nidocument>
<nicomment>

</nicomment>
<nierror code="5000">
SUCCESS
</nierror>
<nierror code="5012">
INVALID HANDLE
</nierror>
</nidocument> 
```

我想阻止它出现->

![在此处输入图像描述](../Images/83f9f64507b8b47cbf1004b7673e02ce.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:52:40.820

您应该将错误处理程序（Simple Error Handler.vi 或只是一个错误指示器）连接到产生这些错误的 VI。默认情况下，Danging error 终端总是会弹出一个错误。

您可以在首选项中关闭此类错误处理，但不建议这样做。标准是将所有错误终端连接起来，并最终在顶层处理任何错误。

# php - 解析 XML 时不能访问超过其父节点的第一个子节点

> ID：11966404
> 
> 赞同：0
> 
> 时间：2012-08-15T08:46:19.973
> 
> 标签：php, mysql, xml, xml-parsing

我的 XML 节点结构是如何工作的，我有多个父元素的子元素，它们也出现多次。我可以访问子元素，但只能访问每个父元素的第一个元素。我还试图将子元素中的数据插入 MySQL。在第一个元素之后，我似乎无法访问任何子元素。当我 echo 时`count()`，我可以获得每个重复出现的父级的子元素的总数，但我似乎无法使用该数据。解析 XML 对我来说相当新，我的 PHP 有点生疏，所以请见谅。我没有得到什么？

注意：我关心的数据在 mt 节点中。mt 节点的直接父节点是 mi 节点。

```
$string = file_get_contents('file1.xml');
$xml = new SimpleXMLElement($string);

foreach ($xml->md as $mt_tag) {
    if (isset($mt_tag->mi->mt)) {
        $query = "INSERT INTO xmlData(
                xml_data
                ) VALUES (
                '{$mt_tag->mi->mt}'
                )";
        mysql_query($query, $connection);
        echo count($mt_tag->mi->mt);
        echo "<br />";
    } else {
        echo "<p>Creation Failed.<p>";
        echo "<p>" . mysql_error() . "</p>";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:55:46.530

您在 mt 节点上缺少一个 for 循环：

```
foreach ($xml->md as $md_tag) {
       if (isset($md_tag->mi->mt)) {

              foreach ($md_tag->mi->mt as $mt) {
                    //do something
              }
       }
} 
```

请确保更改不一致的内容

```
foreach ($xml->md as $mt_tag) { 
```

至

```
foreach ($xml->md as $md_tag) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:53:27.757

您必须考虑阅读以下内容：http: [//bg2.php.net/manual/en/function.simplexml-load-string.php](http://bg2.php.net/manual/en/function.simplexml-load-string.php)

# c# - Location for a picture box and dynamic creation of user controls

> ID：11966410
> 
> 赞同：1
> 
> 时间：2012-08-15T08:47:16.007
> 
> 标签：c#

When I'm trying to set a position for a user control that contains a PictureBox and an ImageList, only part of the image is visible!? What is wrong? For the location, I guess pixel is what I can use?

```
pictureBox1.Location = new Point(10, 20);
pictureBox1.Image = imageList1.Images[3]; 
```

Then I also wonder how I can create several user controls, like the one I describe above, during runtime, like some kind of dynamic creation!? I want to set different images and location for each user control. This creation should take place inside another user control and that contains a big panel. I'm not sure how i should do this and how I can communicate between the two user controls? Just like passing values to methods and constructors af these user controls?!

Preciate some help to solve this! Thanks!

EDIT: I'm trying this code right now, but I cant find the reason why it isn't working?

```
pictureBox1.Size = new System.Drawing.Size(79, 91);
pictureBox1.Location = new Point(10,10);
pictureBox1.Image = imageList1.Images[3]; 
```

I still get only parts of the image. And it's strange why the code below works and show 100% of the image?

```
pictureBox1.Image = imageList1.Images[2]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:59:39.330

```
PictureBox[] pics = new PictureBox[10];

        int size = 20;
        for (int i = 0; i < 10; i++)
        {
            pics[i] = new PictureBox();
            pics[i].Size = new System.Drawing.Size(size, size);
            pics[i].Location = new Point(size * 2 * i + 10, size);
            //pics[i].Image = image
            pics[i].BackColor = Color.AliceBlue;
            pics[i].Parent = this;
        } 
```

对于图片框的 2D 行，您可以使用嵌套的 for 循环：

```
PictureBox[,] pics = new PictureBox[10,10];

        int size = 20;
        for (int i = 0; i < 10; i++)
        {
            for (int j = 0; j < 10; j++)
            {
                pics[i, j] = new PictureBox();
                pics[i, j].Size = new System.Drawing.Size(size, size);
                pics[i, j].Location = new Point(size * 2 * i + 10, size * 2 * j + 10);
                //pics[i,j].Image = image
                pics[i, j].BackColor = Color.AliceBlue;
                pics[i, j].Parent = this;
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:52:07.260

Have a look at the SizeMode property on the PictureBox, you may need to set this to StretchImage to fit your image resolution into your PictureBox size.

As for dynamically creating controls, yes you can, just lokk at the code in your designer.cs to see how the code is generated for the controls when you set them up at design time.

# c# - How to auto adjust the screen on Mobile

> ID：11966419
> 
> 赞同：0
> 
> 时间：2012-08-15T08:48:18.430
> 
> 标签：c#, jquery, html

I developed the mobile website on Jquery Mobile and C#. It is working but the problem is that when I run it on to the mobile the screen is not automatically adjusting the form in to the screen. The data on the form expand from the screen and making an horizontal scroll which is not needed.

What can I do so the horizontal scroll disappear and the form auto adjust in to the screen.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T20:51:08.290

使用@media CSS 查询来定位具有可预测的较小屏幕尺寸的移动浏览器。

CSS：

```
 html,body { overflow-x: hidden; }

 @media (max-width: 700px) {
    // mobile-specific CSS goes here...
    html { font-size: 14px; }
 } 
```

# sql - 错误：引用表“bar”的给定键没有唯一约束匹配

> ID：11966420
> 
> 赞同：213
> 
> 时间：2012-08-15T08:48:29.627
> 
> 标签：sql, postgresql, foreign-keys, unique-constraint

尝试在 Postgres 9.1 中创建这个示例表结构：

```
CREATE TABLE foo (
    name        VARCHAR(256) PRIMARY KEY
);

CREATE TABLE bar (
    pkey        SERIAL PRIMARY KEY,
    foo_fk      VARCHAR(256) NOT NULL REFERENCES foo(name), 
    name        VARCHAR(256) NOT NULL, 
    UNIQUE (foo_fk,name)
);

CREATE TABLE baz(   
    pkey        SERIAL PRIMARY KEY,
    bar_fk      VARCHAR(256) NOT NULL REFERENCES bar(name),
    name        VARCHAR(256)
); 
```

运行上面的代码会产生一个错误，这对我来说没有意义：

> ```
> NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "foo_pkey" for table "foo"
> NOTICE:  CREATE TABLE will create implicit sequence "bar_pkey_seq" for serial column "bar.pkey"
> NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "bar_pkey" for table "bar"
> NOTICE:  CREATE TABLE / UNIQUE will create implicit index "bar_foo_fk_name_key" for table "bar"
> NOTICE:  CREATE TABLE will create implicit sequence "baz_pkey_seq" for serial column "baz.pkey"
> NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "baz_pkey" for table "baz"
> ERROR:  there is no unique constraint matching given keys for referenced table "bar" 
> ```

```
********** Error **********

ERROR: there is no unique constraint matching given keys for referenced table "bar"
SQL state: 42830 
```

谁能解释为什么会出现这个错误？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2012-08-15T09:00:22.520

这是因为表`name`上的列`bar`没有*UNIQUE*约束。

`bar`因此，假设您在包含名称的表上有 2 行，并且您在on 上插入`'ams'`一行，由于有两行匹配，它将引用哪一行？`baz``'ams'``bar_fk``bar`

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2012-08-15T08:54:32.017

在 postgresql 中，所有外键都必须引用父表中的**唯一键**，所以在你的`bar`表中你必须有一个`unique (name)`索引。

另请参阅[http://www.postgresql.org/docs/9.1/static/ddl-constraints.html#DDL-CONSTRAINTS-FK](http://www.postgresql.org/docs/9.1/static/ddl-constraints.html#DDL-CONSTRAINTS-FK)，特别是：

> 最后，我们应该提到**外键必须引用作为主键或形成唯一约束的列。**

强调我的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-01-17T06:43:42.447

您应该将 name 列作为唯一约束。这是 3 行代码来改变你的问题

1.  首先通过键入此代码找出主键约束

    ```
    \d table_name 
    ```

    您在底部显示为这样`"some_constraint" PRIMARY KEY, btree (column)`

2.  删除约束：

    ```
    ALTER TABLE table_name DROP CONSTRAINT some_constraint 
    ```

3.  用现有的主键列添加一个新的主键列：

    ```
    ALTER TABLE table_name ADD CONSTRAINT some_constraint PRIMARY KEY(COLUMN_NAME1,COLUMN_NAME2); 
    ```

就这样。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-08-15T09:09:34.590

当您像所做`UNIQUE`的那样作为表级约束执行时，您的定义有点像复合主键，请参见[ddl 约束](http://www.postgresql.org/docs/8.1/static/ddl-constraints.html)，这是一个摘录

> 这指定指定列中的值*组合*在整个表中是唯一的，尽管任何一列不必是（并且通常不是）唯一的。

**这意味着如果组合**是唯一的并且这与您的外键约束不匹配，则任一字段都可能具有非唯一值。

您很可能希望约束处于列级别。因此，与其将它们定义为表级约束，不如将它们“附加”`UNIQUE`到列定义的末尾，`name VARCHAR(60) NOT NULL UNIQUE`或者为每个字段指定单独的表级约束。

# multithreading - how can I kill or pause a thread when it return to previous intent or home page

> ID：11966422
> 
> 赞同：0
> 
> 时间：2012-08-15T08:48:34.000
> 
> 标签：multithreading, loops, android-intent, kill-process

There is a Button that start an activity every 30 second by a thread. My problem is when I start the activity I cannot cancel or pause it and it runs periodically when I go back to the previous page or even home screen and show the Intent. ans also when I come back and change some setting like loop duration and press the Button, the new thread is added to previous one and both run with their loop time.

I tried to use finish() in onPause() or interrupt but I could not solve the problem!

```
Thread timer = new Thread(){
public void run(){
    try {
            webWiew.loadUrl(xxxxxxx);
        sleep(30000);       
    } catch (InterruptedException e) {
        e.printStackTrace();
    }finally{
        Intent runNewIntent =new Intent("The Intent Name");
        startActivity(runNewIntent);
            }
        }
    };
    timer.start();
} 
@Override
protected void onPause() {
    super.onPause();
    finish();
} 
```

I was wondering if you tell me how can I stop or kill the thread when I leave the activity by pressing a keyboard or return button or go out of the program.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:26:47.250

检查这个[How do you kill a thread in Java?](https://stackoverflow.com/questions/671049/how-do-you-kill-a-thread-in-java)
而这个[http://docs.oracle.com/javase/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html](http://docs.oracle.com/javase/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)

你可以试试`timer.interrupt();`

# asp.net - Manual Binding To DetailsView

> ID：11966423
> 
> 赞同：0
> 
> 时间：2012-08-15T08:48:35.003
> 
> 标签：asp.net, detailsview, manual

I Want to bind detailsview to the page manually , for example

I Have a linqdatasource as declared here in design mode..

On a page load event I have written following..

```
protected void Page_Load(object sender, EventArgs e)
{
    DetailsView dv = new DetailsView();
    dv.AllowPaging = true;
    dv.DataSource = LinqDataSource1;
    dv.DataBind();
    this.Controls.Add(dv);
} 
```

but i got error like this..

**Control 'ctl02' of type 'DetailsView' must be placed inside a form tag with runat=server.**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:52:20.793

在 ASPX 中的表单内添加一个占位符，并将您的详细信息视图从后面的代码添加到占位符。

# git - 使用 `git push` 直接部署到 FTP？

> ID：11966431
> 
> 赞同：0
> 
> 时间：2012-08-15T08:49:13.240
> 
> 标签：git, deployment, ftp

我想知道是否可以在 git 中配置一个远程 FTP 分支，这样我就可以推送到 github，然后一个接一个地推送到部署。

如果可以的话，这将是很棒的。

否则，还有哪些其他选项可以快速轻松地部署？git 可以使用 ssh 或类似的东西吗？我的主机是 SDF.org，您可以在此处查看他们为经过验证的用户提供的选项：`http://sdf.org?join`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T11:16:55.433

我正在使用另一种方法通过 ssh/ftp 部署我的文件：我没有使用 git push，而是将所需文件打包为`.tar.gz`存档并使用`scp`或相应的 ftp 命令上传。请参阅 我的博客条目中[的“The Hook”部分。](http://www2.informatik.hu-berlin.de/~mamuelle/blog/introduction.html)`find`在那里，我使用 tar找到所有想要的文件并打包它们：

```
find . -name "*.html" -o -name "*.css" -o -name "*.js" | tar -czf archive.tgz --files-from - 
```

之后，您可以简单地使用以下命令上传文件`scp`并使用以下命令解压缩`ssh`：

```
scp archive.tgz mamuelle@g<domain>:~/.public_html/
ssh mamuelle@<domain> tar xfz .public_html/archive.tgz -C .public_html 
```

您可以使用 ftp 执行相同的操作。查看有关如何将文件上传到 ftp 的相应手册。

我上面描述的可以使用钩子自动启动。例如，我将它与 一起使用`post-merge`。

[此答案](https://stackoverflow.com/questions/2950107/git-push-into-production-ftp)中描述了另一种选择。有简单的 shell 脚本可以通过`git-push`.

**编辑**使用 ssh，也可以直接推送到裸远程仓库。

# java - addPreferencesFromResource deprecated - any other solution?

> ID：11966434
> 
> 赞同：1
> 
> 时间：2012-08-15T08:49:22.993
> 
> 标签：java, android, sharedpreferences, android-preferences

I'm trying to create a preferences page to save user preferences.

Currently I am sat with this in preferences.xml:

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen 
    xmlns:android="http://schemas.android.com/apk/res/android">

    <PreferenceCategory android:title="User Preferences">
        <CheckBoxPreference
            android:title="Save Credentials"
            android:defaultValue="true"
            android:summary="Save User Login Details"
            android:key="credentialsPref" />
        </PreferenceCategory>                

</PreferenceScreen> 
```

And this in PreferencesActivity.class:

```
public class PreferencesActivity extends PreferenceActivity {

    @SuppressWarnings("deprecation")
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.layout.preferences);
    }

} 
```

That all works ok but it states that addPreferencesFromResource is deprecated, is there a better way of doing this - I have seen use of PreferenceFragment but it looks like an incredibly long winded way of going about this task, unless I'm mistaken?

(New to Java and programming in general)

Thanks

# asp.net - 使用 C# 在 ASP.net 中发送确认电子邮件时我的错误是什么

> ID：11966436
> 
> 赞同：0
> 
> 时间：2012-08-15T08:49:25.887
> 
> 标签：asp.net, c#-4.0, smtp

这是我写的代码

```
 MailMessage msg = new MailMessage();

        msg.From = new MailAddress("noreply@xxx.com", "My site                Registratration");
        msg.To.Add(new MailAddress(email, name, System.Text.Encoding.UTF8));
        msg.Subject = "xxx- Register Account";
        msg.IsBodyHtml = true;
        msg.DeliveryNotificationOptions = DeliveryNotificationOptions.None;
        msg.Priority = MailPriority.Normal;

        StreamReader sr = new StreamReader(Server.MapPath("~/ActiveMail.htm"));
        string temp = sr.ReadToEnd();
        temp = temp.Replace("[###Name###]", name).Replace("[###Url###]", key);
        msg.Body = temp;

        SmtpClient smtp = new SmtpClient("mail.xxx.com");
        System.Net.NetworkCredential perm = new    System.Net.NetworkCredential("noreply@xxx.com", "My host email's password");
        smtp.Credentials = perm;
        smtp.Send(msg); 
```

似乎它必须工作，但在 smtp.Send(msg) 部分我收到电子邮件无法发送的错误。有没有人可以帮助我？非常感谢

## 堆栈跟踪：

```
[SocketException (0x274c): A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond 110.4.46.160:25]
   System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress) +225
   System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception) +279

[WebException: Unable to connect to the remote server]
   System.Net.ServicePoint.GetConnection(PooledStream PooledStream, Object owner, Boolean async, IPAddress& address, Socket& abortSocket, Socket& abortSocket6, Int32 timeout) +6054548
   System.Net.PooledStream.Activate(Object owningObject, Boolean async, Int32 timeout, GeneralAsyncDelegate asyncCallback) +314
   System.Net.PooledStream.Activate(Object owningObject, GeneralAsyncDelegate asyncCallback) +21
   System.Net.ConnectionPool.GetConnection(Object owningObject, GeneralAsyncDelegate asyncCallback, Int32 creationTimeout) +322
   System.Net.Mail.SmtpConnection.GetConnection(ServicePoint servicePoint) +146
   System.Net.Mail.SmtpTransport.GetConnection(ServicePoint servicePoint) +170
   System.Net.Mail.SmtpClient.GetConnection() +50
   System.Net.Mail.SmtpClient.Send(MailMessage message) +1484

[SmtpException: Failure sending mail.]
   System.Net.Mail.SmtpClient.Send(MailMessage message) +1811
   NewUser.SendEmail(String email, String name, String key) in g:\Programming\Projects\xxx\xxxWebsite(Mysql)\NewUser.aspx.cs:99
   NewUser.SignupBtn_Click(Object sender, EventArgs e) in g:\Programming\Projects\xxx\xxxWebsite(Mysql)\NewUser.aspx.cs:69
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +118
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +112
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10

 System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:46:30.250

以下对我很有效，尝试设置您的主机和端口：

```
 var email = new MailMessage();
        email.From = new MailAddress("johnnytables@xkcd.com");
        email.To.Add("johnnysmom@xkcd.com");
        email.Subject = "DROP TABLE STUDENT";
        email.Body = "Our student records are gone!";

        SmtpClient smtp = new SmtpClient();
        smtp.Host = "127.0.0.1";
        smtp.Port = 25;
        smtp.UseDefaultCredentials = true;
        smtp.Credentials = new NetworkCredential("johnnytables@xkcd.com", "password");
        smtp.Send(email); 
```

# java - 在 JFrame 上绘制 BufferedImage 并写入文件

> ID：11966439
> 
> 赞同：1
> 
> 时间：2012-08-15T08:49:42.423
> 
> 标签：java, graphics, awt, bufferedimage

我正在尝试编写一个程序，它将图像读入 BufferedImage，在 JFrame 上绘制它，在其中绘制圆圈，然后将其写入文件。

以下代码将完成所有这些，除了保存文件的内容。保存的图像仅包含未触及的 BufferedImage。No Circles ;) 我已经尝试通过更改和添加一些代码来解决这个问题，但这并没有太大帮助。

```
public class PaintImage extends Component {

BufferedImage img;
private int pngWidth, pngHeight;

public int getPngWidth() {
    return pngWidth;
}

public int getPngHeight() {
    return pngHeight;
}

public void paint(Graphics g) {
    super.paint(g);

 //g = img.createGraphics();
 g.drawImage(img, 0, 0, 809, 1080, null);
 g.drawOval(33, 33, 444, 444);
}

public PaintImage() {
try {
    img = ImageIO.read(new File("C:\\karte_vorlage.png"));
    pngWidth = img.getWidth();
    pngHeight = img.getHeight();

} catch (IOException e) {
}
}

public void writeImage () {
    try {
     img.getGraphics();
        ImageIO.write(img, "png", new File("C:\\save.png"));
    } catch (IOException e1) {
        e1.printStackTrace();
    }
}

} 
```

取消注释 g = img.createGraphics(); 导致图像失真。

请帮我。谢谢大家。

编辑： 1\. 方法paint(Graphics g) 被调用两次。在最小化的情况下，它将再次被调用两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T10:28:30.270

您可以简单地将组件直接绘制到`BufferedImage`

```
BufferedImage tempImage = new BufferedImage(imagePane.getWidth(), imagePane.getHeight(), BufferedImage.TYPE_INT_ARGB);
Graphics2D g = tempImage.createGraphics();

imagePane.printAll(g);

ImageIO.write(tempImage, "png", new File("C:\\save.png")); 
```

您可能想玩弄宽度和高度以更好地满足您的要求

**更新**

继续思考这个问题。

另一个想法是创建某种“绘制管理器”或“可绘制”界面，给定`Graphics`内容可以自行绘制（显然您想知道更多信息，例如`width`& `height`）

这意味着它在哪里绘制并不重要。

另一件事是您可能想向渲染器提供有关如何`paintable`绘制的提示（例如首选大小）

只是一个想法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:17:56.023

用另一种方法在图像上画圆。您可以随时调用此其他方法。然后在paint方法中，您只需将图像绘制到组件上即可。

```
public void paint(Graphics g) {
    super.paint(g);
    g.drawImage(img, 0, 0, 809, 1080, null);
}

public void drawCircle() {
    Graphics g = img.getGraphics();
    g.drawOval(33, 33, 444, 444);
} 
```

您还可以删除 img.getGraphics(); 来自 writeImage 方法，因为那里不需要它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T12:12:02.443

你应该改变你的设计。试试这个方法：

1.  读取 png 文件并将其保存到 bufferedImage。
2.  更改您的paint() 方法（这非常重要，因为您想要的是一个带有附加元素的新图像，但是您的代码意味着首先绘制一个png，然后在UI 上绘制一个椭圆）。它不会修改 bufferedImage。添加您自己的事件以更改缓冲图像。例如，当您单击按钮时，运行如下方法：

无效富（缓冲图像）{

```
 g = bufferedImage.getGraphis();
    g.drawSomething();
}
public void paint(Graphics g) {
    g.drawImage(bufferedImage);
} 
```

# wpf - How to create datatemplate in code behind with listview gridview for a treeview

> ID：11966445
> 
> 赞同：0
> 
> 时间：2012-08-15T08:50:23.687
> 
> 标签：wpf, datatemplate

Hi Please help me to realize the fallowing datatemplate in code behind

```
<TreeView Name="OrderTree" DataContext="{Binding ordersTree}" ItemsSource="{Binding}">
    <TreeView.Resources>
        <HierarchicalDataTemplate 
              ...
        </HierarchicalDataTemplate>
        <DataTemplate DataType="{x:Type ordVM:OrderedDataCollectionVM}">
            <ListView Name="orderedListView" Margin="0,5,0,0" ItemsSource="{Binding GridData}">
                <ListView.View>
                    <GridView>
                        <GridViewColumn DisplayMemberBinding="{Binding Number}" Width="20" />
                        <GridViewColumn Header="{x:Static lang:ViewTextResource.product_name}" DisplayMemberBinding="{Binding Product.Name}" Width="150" />
                        <GridViewColumn Header="{Binding GridHeaders.[0]}" CellTemplate="{StaticResource GridViewComboBox1}" Width="120"/>
                        <GridViewColumn Header="{Binding GridHeaders.[1]}" CellTemplate="{StaticResource GridViewComboBox2}" Width="120"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </DataTemplate>
    </TreeView.Resources>
</TreeView> 
```

I want to create a DataTemplate in code behind for my TreeView with a ListView which has a GridView which columns count depends on my data.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T08:56:12.553

看看[这个](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/6b3ff2e5-7084-43a7-a3a2-a7c787b61339/)。看起来这就是你想要的。

有趣的部分：

```
DataTemplate template = new DataTemplate();  

template.VisualTree = new FrameworkElementFactory(typeof(Path));  

template.VisualTree.SetBinding(Path.StrokeProperty, new Binding("Stroke"));  
template.VisualTree.SetBinding(Path.StrokeThicknessProperty, new Binding("StrokeThickness"));  
template.VisualTree.SetBinding(Path.FillProperty, new Binding("Interior"));  
template.VisualTree.SetBinding(Path.DataProperty, new Binding("Geometry")); 
```

只需编辑它以满足您的需要。

# python - 使用 __import__() 以故障安全的方式重新导入相同的 python 模块

> ID：11966446
> 
> 赞同：1
> 
> 时间：2012-08-15T08:50:35.183
> 
> 标签：python

我正在使用`__import__`导入 python 模块。但是，我想实施一个解决方案来重新导入可能同时更改的模块（开发/调试目的）。如果我尝试这个，我仍然会得到“旧”模块，我猜是因为它已经被导入了。我可以强制 python 从相同的 .py 文件名重新导入新版本的模块吗？我无法在重新导入之前删除旧模块（我猜这会有所帮助），因为我想要某种防错行为：如果（重新）导入失败，我想继续使用旧模块。

类似这样的或多或少的伪代码：

```
mod = None
reload_trigger = True
MODULE_NAME = "mymodule.py"
while True:
    if reload_trigger:
        reload_trigger = False
        try:
            mod_new = __import__(MODULE_NAME)
        except ImportError as a:
            if mod is None:
                raise RuntimeError("Initial module import failed, cannot continue!")
            print("Import problem, still using the old module: " + str(a))
            continue
        mod = mod_new
        del mod_new
     mod.main_loop_iterate_etc()  # it may also set reload_trigger to True 
```

Afaik reload() 可用于重新导入模块，但我不确定如果重新导入失败如何处理这种情况，所以我仍然可以使用旧模块代替。使用异常处理程序“保护” reload() 以捕获导入问题等是否足够？

另外，我是否应该手动处理这种情况以重新加载我重新导入的模块导入的所有模块？因为我希望它们被重新加载以及“依赖”。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:38:32.730

重新导入模块的正确方法是使用`reload`，但是您想防止重新导入失败是正确的。我建议`superreload`从 IPython 自动重载扩展（[source](https://github.com/ipython/ipython/blob/master/IPython/extensions/autoreload.py)）看一下。

这应该处理重新加载中的错误：

```
old_dict = module.__dict__.copy()
try:
    module = reload(module)
except:
    module.__dict__.update(old_dict)
    raise 
```

# azure - 对 PartitionKey/RowKey 列表的 Azure 表存储查询非常慢

> ID：11966450
> 
> 赞同：1
> 
> 时间：2012-08-15T08:51:24.227
> 
> 标签：azure, azure-table-storage

`GET /Product()?$filter=((PartitionKey%20eq%20'lIkfA81JpTmv')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lIGcEmrr7hWz')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lIAoy6PqeMVn')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lIjETAtuhYGM')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lIHa0znP5qAk')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lIOCaSXg9YE7')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lInRozGrMa7T')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lILEwwPPcBfe')%20and%20(RowKey%20eq%20'')) %20or%20((PartitionKey%20eq%20'lJ14qZv1KFn4')%20and%20(RowKey%20eq%20''))% 20or%20((PartitionKey%20eq%20'lIIohzupFLcV')%20and%20(RowKey%20eq%20'')).....`

对已知 PartitionKey 和 RowKey 的列表 (50) 的 Azure 表存储非常标准的查询。从服务器开始第一口需要 5 秒。有没有办法加快速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T16:51:16.670

“或”查询并未按照您期望的方式进行优化。像这样的查询会导致全表扫描。正如 Gaurav 建议的那样，您确实需要将这些作为单独的查询（并行）进行，以获得快速的响应时间。

我也完全不同意 Astaykov 的说法，即您不应该费心优化，因为您的性能在 SLA 范围内。性能不是随机的，SLA 通常是一个上限。请花时间优化对性能敏感的查询。您应该能够轻松地在亚秒级时间内始终如一地进行这种查找。

**编辑：**

不确定您使用的是哪种语言，但这里有一个快速的 Node.js 测试，从我家开始似乎通常需要 1 到 1.2 秒，但偶尔会接近 1.5：

```
function timeParallelQueries(account, key) {
    var azure = require('azure'),
        Q = require('q'),
        _ = require('underscore');

    var tables = azure.createTableService(account, key);

    function convertToString(n) { return n + ''; }

    var start = null;

    Q.ncall(tables.createTableIfNotExists, tables, 'test')
    .then(function () {
        return Q.all(_.map(_.map(_.range(50), convertToString), function(key) {
            return Q.ncall(tables.insertOrReplaceEntity, tables, 'test', {PartitionKey: key, RowKey: key});
        }));
    })
    .then(function () {
        start = new Date();
        return Q.all(_.map(_.map(_.range(50), convertToString), function (key) {
            return Q.ncall(tables.queryEntity, tables, 'test', key, key);
        }));
    })
    .then(console.log)
    .then(function (results) {
        console.log('Took ' + (new Date() - start) + 'ms.');
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:23:21.623

除了您正在查询“已知”的 PK 和 RK 之外，您还为其中的许多提供了 OR。考虑到不同分区分布在不同物理服务器上的机会非常高，我对结果并不感到惊讶。

同样根据[Storage SLA](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=6656)，一个表操作：

> 必须在 10 秒内完成处理或返回继续

对**单个实体**（即单对 PK & RK）进行操作时：

> 必须在 2 秒内完成处理

所以 5 秒是平均水平，并且在 SLA 范围内。即使您以某种方式加快查询速度，它也不可靠，因为您的查询的 SLA 是“在 10 秒内”。因此，您在优化查询方面所做的所有努力都可能被浪费，因为这是一个可变时间，取决于许多因素。而你今天实现的 3 秒结果，明天可能会产生 8 秒并且仍在 SLA 内。

我不会深入挖掘 SLA 中的内容。

**更新 1**

还有许多其他方法可以减少页面加载时间。你可以开始异步思考了！将超级干净的数据空 HTML 发送到客户端，并在页面加载后通过 ajax 按需加载所有数据。

还要考虑缓存。您可以缓存（几乎）任何类型的要呈现给用户的数据。权衡“数据准确性”与“速度加载”。所以你可以缓存，甚至预缓存一些要加载的数据。我认为这将是您的方案的一个选择，因为您知道您正在寻找的 PK 和 RK - 缓存这些条目并从缓存中提供它们，而不是在每个请求上都转到表。您可以根据数据更改的可能性设置绝对到期或滑动到期。

**更新 2**

正如 Gaurav 提到的 - 您可以尝试并行查询表，并将结果放入缓存中。但是，并行度取决于您正在操作的核心数量。因此，如果您在单核上，则进行并行查询是没有意义的。不过，请考虑缓存和客户端数据绑定！

# xcode - Game Center not showing in Fullscreen (MacOS / xcode)

> ID：11966451
> 
> 赞同：3
> 
> 时间：2012-08-15T08:51:33.797
> 
> 标签：xcode, sdl, fullscreen, game-center, osx-mountain-lion

I'm developing a MacOS application. Since Mountain Lion (10.8) it is possible to add Game Center to OS X applications. I've added one, tested it, and it works fine, but only in windowed mode. If I go fullscreen with my app, I can no longer see Game Center windows (authentication window nor match finding). What can be the problem? I'm using SDL and OpenGL. I know that SDL uses Cocoa to set up the application's window. Game Center for OS X uses GKDialogController to show and dismiss windows, but there isn't much to tweak there. One thing that came to my mind was setting parent window as follows:

```
self.dialogController.parentWindow = [NSApp mainWindow]; 
```

But nothing changed. There is a brief pause when i access the Game Center, so it seems everything is working ok in fullscreen, just the window is not shown. How to bring that window in fullscreen to be visible / frontal ? Is there something to be changed in OpenGL or in SDL? Or is this impossible and I'd need to switch to native window creating?

# c - pointer to a pointer in a linked list

> ID：11966454
> 
> 赞同：0
> 
> 时间：2012-08-15T08:51:43.530
> 
> 标签：c, pointers, linked-list

I'm trying to set a linked list head through pointer to a pointer. I can see inside the function that the address of the head pointer is changing but as i return to the main progran it becomes NULL again. can someone tell me what I'm doing wrong ??

```
 #include <stdio.h>
           #include <stdlib.h>

           typedef void(*fun_t)(int);
           typedef struct timer_t {
           int   time;
           fun_t func;
           struct timer_t *next;
           }TIMER_T;

          void add_timer(int sec, fun_t func, TIMER_T *head);

             void run_timers(TIMER_T **head);

           void timer_func(int);

           int main(void)
            {
            TIMER_T *head = NULL;
            int time = 1;

            fun_t func = timer_func;

            while (time < 1000) {
              printf("\nCalling add_timer(time=%d, func=0x%x, head=0x%x)\n", time,     

              func, &head);
               add_timer(time, func, head);
               time *= 2;
              }  
              run_timers(&head);

              return 0;
             }

            void add_timer(int sec, fun_t func, TIMER_T *head)
            {
           TIMER_T ** ppScan=&head;
               TIMER_T *new_timer = NULL;
           new_timer = (TIMER_T*)malloc(sizeof(TIMER_T));
               new_timer->time = sec;
               new_timer->func = func;
               new_timer->next = NULL;

               while((*ppScan != NULL) && (((**ppScan).time)<sec))
               ppScan = &(*ppScan)->next;

               new_timer->next = *ppScan;
               *ppScan = new_timer;
               } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:02:58.187

你弄错了。*函数*需要取一个双指针，调用*者*需要取地址：

```
{   // caller
    TIMER_T *head = NULL;
    do_something(&head);
}

void do_something(TIMER_T ** p)  // callee
{
    *p = malloc(sizeof(TIMER_T*));
    // etc.
} 
```

以前有[很多](https://stackoverflow.com/a/9729853/596781)[很多](https://stackoverflow.com/a/11926448/596781)类似的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:01:25.007

由于 C 函数参数是**通过**它们的**值**而不是通过它们的**地址**传递的，并且您不会在调用中传递任何变量的地址：

```
add_timer(time, func, head); 
```

所以它们都不会在`add_time`函数范围之外被改变。

您可能需要做的是传递以下地址`head`：

```
add_timer(time, func, &head); 
```

和：

```
void add_timer(int sec, fun_t func, TIMER_T **head)
{
    TIMER_T ** ppScan = head;
    // ...
} 
```

# c# - user32.dll SendMessage 命令导致消息发送应用程序暂停执行

> ID：11966462
> 
> 赞同：1
> 
> 时间：2012-08-15T08:52:22.163
> 
> 标签：c#, dllimport, user32

我正在使用 user32 SendMessage dll 命令将命令传输到 Windows 应用程序。

```
[DllImport("user32.dll")]
private static extern IntPtr SendMessage(IntPtr hWnd, uint msg, IntPtr wParam, IntPtr lParam); 
```

其中一个命令使应用程序显示一个接受输入的模式框。

我的问题是：**为什么我的应用程序的代码执行会停止，直到另一个应用程序的模式框被关闭？**

有没有办法继续执行我的应用程序代码，而不会受到使用 user32.dll 发送消息时引起的暂停的干扰？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T08:59:30.377

SendMessage 将阻塞，直到呼叫的接收者完成对消息的处理。

您可以改为使用 PostMessage ，这将允许您的程序在发送消息后立即继续执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:00:56.997

[您可以在此处](http://msdn.microsoft.com/ru-ru/library/system.threading.threadstart.aspx)阅读有关线程的信息

这是一个简单的例子：

```
using System.Threading;

public static void DoSendMessage() 
{
    SendMessage(...); 
}

public void RunSendMessage()
{
  ThreadStart threadDelegate = new ThreadStart(DoSendMessage);
  Thread newThread = new Thread(threadDelegate);
  newThread.Start();
} 
```

# mysql - 选择不同的值 ColumnA 而 ColumnB = Value1 和 ColumnB = Value2

> ID：11966465
> 
> 赞同：0
> 
> 时间：2012-08-15T08:52:38.453
> 
> 标签：mysql

这是桌子

```
mysql> desc tags;
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | int(11)      | NO   | PRI | NULL    | auto_increment |
| content_id | int(11)      | NO   |     | NULL    |                |
| name       | varchar(100) | NO   |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+
3 rows in set (0.00 sec) 
```

一些数据

```
mysql> select * from tags;
+----+------------+---------------+
| id | content_id | name          |
+----+------------+---------------+
|  1 |         36 | banana        |
|  2 |         36 | strawberry    |
|  3 |         36 | orange        |
|  4 |         36 | apple         |
|  5 |         36 | watermelon    |
|  6 |         37 | qiwi          |
|  7 |         37 | apple         |
|  8 |         37 | orange        |
|  9 |         37 | bed           |
| 10 |         38 | grape         |
| 11 |         38 | apple         |
+----+------------+---------------+
11 rows in set (0.00 sec) 
```

我想要的是获取一个唯一`content_id`s 的列表，其中`name`是 apple 并且 content_id 也有 ORANGE 与之相关联。

所以在这个例子中，如果我想知道哪个 content_ids 被标记为“apple”和“orange”，它会导致：

```
+------------+
| content_id |
+------------+
|         36 |
|         37 |
+------------+ 
```

因为这是仅有的两个被相应标记的 content_id。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:02:00.990

你可以在它也有这样的名字的地方`left join`使用表格：`content_id`

```
select tbl.content_id
from tags tbl
left join tags tbl2 on tbl2.content_id = tbl.content_id and tbl2.name = 'orange'
where tbl.name = 'apple' and tbl2.name is not null
group by tbl.content_id 
```

仅返回存在`tbl2.name is not null`子句指示的相应连接的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T08:56:33.893

```
select content_id
from tags
where `name` in ('banana', 'orange')
group by content_id
having count(distinct `name`) >= 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:24:06.040

```
select content_id from fruits 
where name in('apple','orange')
group by content_id
having COUNT(*)=2 
```

# ms-access - 访问 SQL 查询日期

> ID：11966466
> 
> 赞同：0
> 
> 时间：2012-08-15T08:52:38.827
> 
> 标签：ms-access

这是我的代码：

```
SELECT DataBaseUser.Agents, Abs(Sum([NoPPI1])) AS [NoPPI-1], Abs(Sum([NoPPI2])) AS [NoPPI-2], Abs(Sum([NoPPI3])) AS [NoPPI-3], Abs(Sum([NoPPI4])) AS [NoPPI-4], Abs(Sum([NoPPI5])) AS [NoPPI-5], Abs(Sum([NoPPI6])) AS [NoPPI-6], Abs(Sum([NoPPI1])+Sum([NoPPI2])+Sum([NoPPI3])+Sum([NoPPI4])+Sum([NoPPI5])+Sum([NoPPI6])) AS TotalNoPPI
FROM DataBaseUser INNER JOIN MainData ON DataBaseUser.ID = MainData.AgentDropDown
GROUP BY DataBaseUser.Agents; 
```

试图让这个查询工作，基本上查询是总结每个销售代理的总 NoPPI1 到 NoPPI6。我遇到的问题是我需要在 NoPPI1 上有某种过滤器，比如这个月，然后对于 NoPPI2 来说，2 个月前的日期过滤器。

这可能吗？

谢谢

* * *

更新

目前的结果如下所示：

```
Agents | NoPPI1 | NoPPI2 | NoPPI3 | NoPPI4 | NoPPI5 | NoPPI6 |
--------------------------------------------------------------
Ash    | 34     | 32     | 17     | 12     | 4      | 1      |
Kate   | 45     | 23     | 15     | 9      | 2      | 0      | 
```

等等。 |

控制日期的字段是 NoPPIDate1 等。

所以我想要实现的是：

NoPPI1 需要求和，abs 然后按日期过滤，然后对另一个相同但不同的日期。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:18:36.663

首先要做的是使用 UNION 查询对表进行规范化。这会给你更多的控制：

```
SELECT Agent, "NoPPI1" As Description, NoPPI1 As NoPPI,  NoPPI1Date As NoPPIDate
FROM Table
UNION
SELECT Agent, "NoPPI2" As Description, NoPPI2 As NoPPI,  NoPPI2Date As NoPPIDate
FROM Table
<...> 
```

然后您可以更轻松地选择：

```
SELECT Agent, Sum(NoPPI) FROM UnionQ
WHERE NoPPIDate=#2012/12/31#
GROUP BY Agent 
```

# applescript - 我可以从 iWork 应用程序中的菜单或热键执行我的 Applescript 吗？

> ID：11966469
> 
> 赞同：2
> 
> 时间：2012-08-15T08:52:48.417
> 
> 标签：applescript, osx-mountain-lion, iwork

我找不到有关如何从Numbers 或任何其他 iWork 应用程序中**的菜单（或热键）执行 Applescript 的说明。**我毫不怀疑以前有人问过这个问题，只是找不到......谷歌有一些关于这个主题的说明，但据我所知，这些都非常过时。

该脚本已经在 ~/Library/Scripts 中。

可以做到吗？如果是这样，怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T16:49:43.337

如果您不想安装像 FastScripts 这样的第三方应用程序（尽管 FastScripts 非常棒），您可以这样做。

打开菜单栏中的脚本菜单。（它看起来像一个卷轴。）
1\. 打开 AppleScript 编辑器，它位于 ~/Library/Applications/Utilities 中，不是您用户帐户的库文件夹，而是硬盘驱动器上的根库文件夹。
2\. 从主菜单中选择“首选项”，确保选中“常规”，然后选中“在菜单栏中显示脚本菜单”框。

在 AppleScript 编辑器中创建脚本并将其保存到：
~/Library/Users/[Your User Account Name]/Library/Scripts/Applications/[Your Application Name]
因此，如果我的用户帐户名为 Foo 并且我正在保存一个我想在 Coda 中使用的脚本，我会将其保存到：
~/Library/Users/Foo/Library/Scripts/Applications/Coda

现在当我在 Coda ，然后单击现在出现在我的菜单栏中的“脚本菜单”图标，我会得到一个可以执行的脚本的下拉列表，其中包括特定于应用程序的部分，现在应该包含您的脚本。

这些说明适用于 OSX Lion 和 Mountain Lion。在此之前，通过执行操作系统附带的示例脚本之一来安装脚本菜单。

# css - 为什么我的文字溢出

> ID：11966470
> 
> 赞同：0
> 
> 时间：2012-08-15T08:52:56.067
> 
> 标签：css, html, overflow

我在这个网站上的文字有点奇怪：

[http://skole.thebekker.dk/tutorials/?p=test](http://skole.thebekker.dk/tutorials/?p=test) 最后第二段...

HTML & CSS 源代码在这里：http: [//jsfiddle.net/mqQEu/](http://jsfiddle.net/mqQEu/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T08:59:19.050

添加这个：

```
white-space: normal; 
```

到你的段落css `p {}`，你的文本会更好地换行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:04:11.523

您已将所有页面内容包装在[PRE](http://www.w3schools.com/tags/tag_pre.asp)标记中。PRE 是预格式化的文本，它使用源中的格式而不是标记中定义的格式。它不应该以这种方式使用，通常用于不寻常的格式或代码示例。

删除此标签，然后修复行距，它将起作用

# python - Python 的锁定成本与性能，（多线程有意义吗？）

> ID：11966471
> 
> 赞同：5
> 
> 时间：2012-08-15T08:53:02.867
> 
> 标签：python, multithreading, performance, gil

我正在做一个项目，我的代码吞吐量非常重要，经过一番考虑，我选择让我的程序线程化。

主线程和子线程都从两个共享字典中添加和删除。考虑到python中锁定的性能，我一直在浏览互联网上的一些输入，它是一个缓慢的操作等等。

所以我得到了什么，因为python实际上根本没有线程化（考虑到GIL只在一个核心上工作）如果我需要在我的应用程序中获得高性能，除了处理IO之外，我有什么可以通过使其线程化来赢得的?

**编辑**

实际问题是（在有见地的评论之后）

既然有 GIL，多线程在 python 中有意义吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-05-08T03:17:27.777

IMO，锁定解决方案对性能的影响很大，主要是在多线程真正等待它时。

获取和释放非**竞争**锁的成本应该是微不足道的。

[这个线程](https://mail.python.org/pipermail/python-ideas/2010-July/007644.html)显示了一个关于那个的测试。

> 好的，这是在 Linux 下使用 Python 3.2 获取和释放非竞争锁的成本：
> 
> ```
> $ python3 -m timeit \
>   -s "from threading import Lock; l=Lock(); a=l.acquire; r=l.release" \
>   "a(); r()"
> 
> 10000000 loops, best of 3: 0.127 usec per loop 
> ```
> 
> 以下是调用虚拟 Python 函数的成本：
> 
> ```
> $ python3 -m timeit -s "def a(): pass" "a(); a()"
> 
> 1000000 loops, best of 3: 0.221 usec per loop 
> ```
> 
> 这是调用一个普通的 C 函数（返回 False 单例）的成本：
> 
> ```
> $ python3 -m timeit -s "a=bool" "a(); a()"
> 
> 10000000 loops, best of 3: 0.164 usec per loop 
> ```
> 
> 另外，请注意，使用锁作为上下文管理器实际上更慢，而不是你想象的更快：
> 
> ```
> $ python3 -m timeit -s "from threading import Lock; l=Lock()" \
>   "with l: pass"
> 
> 1000000 loops, best of 3: 0.242 usec per loop 
> ```
> 
> 至少在Linux下，锁性能似乎没有太大的提升空间，至少可以这么说。
> 
> PS：RLock 现在和 Lock 一样快：
> 
> ```
> $ python3 -m timeit \
>   -s "from threading import RLock; l=RLock(); a=l.acquire; r=l.release" \
>   "a(); r()"
> 
> 10000000 loops, best of 3: 0.114 usec per loop 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T09:03:24.573

首先，任何语言的锁定都是性能瓶颈。尽可能减少锁定；例如，不要使用共享目录，而是创建一棵树，并让每个线程在该树的不同分支中工作。

由于您将执行大量 I/O，因此您的性能问题将存在，并且线程不一定会改善问题。首先研究事件驱动的架构：

*   标准库[`asyncore`模块](http://docs.python.org/library/asyncore.html)
*   [`twisted`](https://twistedmatrix.com/trac/)
*   [`eventlets`](http://eventlet.net/)
*   [`greenlets`](http://greenlet.readthedocs.org/en/latest/index.html)

GIL 在这里不太可能是您的问题；例如，只要线程进入 C 代码（几乎可以肯定在任何 I/O 调用期间），它就会被释放。如果它*确实*成为瓶颈，请转移到多个流程。例如，在我管理的一个大型 Intranet 集群上，我们运行 6 个进程，每 2 个线程，以充分利用所有 CPU 内核（其中 2 个进程负载非常轻）。

如果您觉得需要多个进程，请使用该[`multiprocessing`模块](http://docs.python.org/library/multiprocessing.html)或轻松启动服务器的多个实例（每个实例侦听不同的端口）并使用负载平衡器（如 haproxy）将流量引导到每个服务器。

# html - 将用户重定向到他们自己的主页

> ID：11966473
> 
> 赞同：5
> 
> 时间：2012-08-15T08:53:08.793
> 
> 标签：html, hyperlink

我想知道是否可以将用户重定向到他们的主页。主页是指在他们的浏览器中定义为主页的 URL。当他们单击浏览器的“主页”按钮时，他们会进入该页面。

我知道 Internet Explorer 使用`<a href="about:home" title"Go to your homepage">Homepage</a>`，但我不知道其他浏览器为此使用什么！

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:05:53.653

我不知道您是否正在寻找此线程中讨论的类似内容：

[使用 Javascript 将用户发送到浏览器的主页](https://stackoverflow.com/questions/1369450/sending-user-to-their-browsers-home-page-using-javascript)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:04:21.137

只需创建一个链接即可返回用户来自的位置：

```
<a href="#" onClick="history.go(-1);return true;">Back</a> 
```

或类似的按钮

```
<button type="button" onClick="history.go(-1): return true:">I do not agree</button> 
```

# javascript - jquery $(this) 在嵌套语句中？

> ID：11966477
> 
> 赞同：-1
> 
> 时间：2012-08-15T08:53:28.443
> 
> 标签：javascript, jquery

当我想在嵌套语句中引用“this”时会发生什么，它使用哪个“this”？

这是一个例子来说明我上面的意思：

```
 $("input").blur(function(){
            var theThis = $(this);
            if(!($(".invalid").length > 0)){
                //if there's no messages already open
                theThis.data("validator").checkValidity();
            }else{
                //add the message to the next to be displayed
                nextToAlert.push(theThis);
                //bind an event to the errored field being changed
                $(".invalid").on("change", function(){
                    var me = $(this);
                    if(!me.hasClass('invalid')){
                        nextToAlert.pop().checkValidity();

                    }
                });
            }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:14:51.350

Javascript 使用函数作用域： 的值`this`取决于包含它的最内层函数的调用方式。调用`object.method()`时，`this`方法内部的值为`object`; 如果你打电话`function()`，的价值`this`是`window`。您还可以`this`通过调用设置为任意值`function.call(thisValue)`。当函数是回调时，取值`this`完全取决于调用它的代码，因此您的主要信息来源应该是 jQuery 文档。但通常 jQuery 会设置`this`为动作发生的 DOM 元素。例如， in`$('.foo').on('click', myFunc)`的值将是捕获点击的元素，因为它将是集合中的当前元素，依此类推。`this``myFunc``$('.foo').each(myFunc)``$(this)`然后用于将 DOM 元素转换为 jQuery 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:57:25.297

阅读[这篇文章](http://remysharp.com/2007/04/12/jquerys-this-demystified/)以更好地理解`$(this)`。作为一个简单的（并非总是正确的，但在 99% 的情况下）规则：`$(this)`将引用当前执行上下文中的相关元素（DOM 文档中的当前位置）。

在您的示例中：

*   `theThis`将是（当前）`$("input")`
*   `me`将是（当前）`$(".invalid")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T08:59:37.543

在您的代码中：

*   `theThis`指`$("input")`
*   `me`逆转为`$(".invalid")`

`$(this)`将始终根据当前范围而变化。

当您使用任何类型的动作绑定函数时，例如`blur`、`on`、`bind`、`live`等，那么`$(this)`将引用事件绑定到的当前 jQuery 对象。

# cassandra - “SELECT...IN...”运算符不工作

> ID：11966478
> 
> 赞同：1
> 
> 时间：2012-08-15T08:53:39.633
> 
> 标签：cassandra, composite-key

使用 cassandra-1.1.2。像这样的架构。

```
    创建表联系人（
      用户名文本，
      联系方式文本，
      分组文本，
      名称文本，
      主键（用户 ID、联系人 ID）
    )

```

它包含的所有日期。

```
    cqlsh:contactks> 从联系人中选择 *；
     用户名 | 联系方式 | 团体 | 姓名
    --------+------------+--------+------
          一个 | a11 | a13 | a12
          一个 | a21 | a23 | a22
          一个 | a31 | a33 | a32
          乙 | b11 | b13 | b12

```

所以我做了这样的查询：

```
    cqlsh:contactks> select * from contacts where contactid in ('a11', 'a21');
    cqlsh:contactks>

```

什么都不退！！！如何在不将“contactid”作为分区键的情况下使用“IN”选项获取值？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:06:49.323

我相信你需要实现一个[二级索引](http://www.datastax.com/docs/1.1/references/cql/SELECT#cql-select)才能在`contactid`where 子句中搜索它。

# blackberry - 黑莓，点击标签时拨打电话

> ID：11966479
> 
> 赞同：2
> 
> 时间：2012-08-15T08:53:42.267
> 
> 标签：blackberry, java-me

我需要制作一个包含可点击号码的标签，以便当用户点击标签时会拨打电话号码（或向用户显示拨打电话的选项）。当我此时单击标签时，我只会得到一个工具提示类型的菜单，其中包含复制数字的选项...

```
private LabelField contactPhoneNumberField = new LabelField(number,Field.FOCUSABLE)
{
        protected boolean navigationClick()
        {
            // write your code on click
            // make the call
            PhoneArguments callArgs = new PhoneArguments(
                PhoneArguments.ARG_CALL, number);
            Invoke.invokeApplication(Invoke.APP_TYPE_PHONE, callArgs);
            return true;
        }

    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T21:22:31.900

一个忠告。您不应该使用 navigationClick() 来处理点击。改写 navigationUnclick() 方法并处理 Unclick。

1.  这符合标准用户界面行为。几乎所有原生字段，如按钮，黑莓上的列表字段都在取消点击而不是点击时执行操作。甚至窗口上的按钮和链接也遵循相同的概念。

2.  如果您对更改焦点的 navigationClick() 执行一些操作 - 例如推送新屏幕，则 navigationUnclick 将在焦点的新字段上调用。如果该字段是按钮，则该按钮将被单击。

3.  如果焦点没有改变，那么 navigationUnclick() 将返回未处理。这将导致屏幕的 navigationUnclickUnhandled() 将显示“工具提示类型的菜单”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T10:21:03.113

```
final LabelField contactPhoneNumberField = new LabelField("",Field.FOCUSABLE) {
public boolean navigationClick (int status , int time){
    PhoneArguments callArgs = new PhoneArguments(
    PhoneArguments.ARG_CALL, number);
    Invoke.invokeApplication(Invoke.APP_TYPE_PHONE, callArgs);
    return true; 
```

} };

玩了一段时间后发现我需要添加 int status 和 int time 参数

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T09:36:49.753

我认为执行流程不会进入您的`navigationClick()`方法，因此您会得到工具提示而不是想要的功能。

似乎点击事件没有到达您的标签实例，并且之前已被消耗。例如由容器类实例（屏幕/管理器）。

检查`naviagationClick()`容器屏幕类/管理器实例的方法，并确保您的标签实例获得点击事件。

# javascript - 单击另一个 DIV 时更改 DIV 颜色

> ID：11966482
> 
> 赞同：5
> 
> 时间：2012-08-15T08:54:00.567
> 
> 标签：javascript, jquery, html, css, click

正如您在 jsfiddle [http://jsfiddle.net/C8B8g/7/](http://jsfiddle.net/C8B8g/7/)上看到的那样，我有 2 个按钮（= 2 div）“区域”和“源”。每个 div 在鼠标悬停时都会突出显示（蓝色背景）（感谢 stackoverflow 的贡献者，因为我在 JS 中仍然很糟糕）。

我注意到用户实际上并没有意识到这些是按钮所以我想做的是让第一个包含文本“我们的地区”的 DIV 默认情况下以蓝色背景突出显示并且只返回白色当单击包含文本“我们的来源”的另一个 div 时的背景（在这种情况下，“我们的来源”背景将变为蓝色）。在 CSS 中使用“current”进行了一些测试，但没有成功......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T08:58:44.730

试试这个：更新： [**这里正在工作 jsFiddle。**](http://jsfiddle.net/C8B8g/24/)

```
$('.activity-title a:first').css({'background-color':'#f00','color':'#fff'});
//for setting first button highlighted by default,
//don't forgot to define document.ready before this

$('.activity-title a').click(function() {
    var region = $(this).attr('data-region');

    $('.activity-title a').css({'background-color':'#fff','color':'#467FD9'});
    $(this).css({'background-color':'#f00','color':'#fff'});

    $('.textzone:visible').stop().fadeOut(500, function () {
    //don't forgot to add stop() for preventing repeat click conflict
        $('#' + region).fadeIn(500);
    });

    return false;

});​ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T09:04:19.537

为选定的 div 添加样式

```
.source-selected {
    background-color:#00F;
} 
```

将此类添加到您的默认 div。

将此行添加到您的点击处理程序（更新）

```
if(!$(this).closest('.source-title-box').hasClass('source-selected'))
{
    $('.source-title-box').toggleClass('source-selected');
} 
```

尝试更新的小提琴：

[http://jsfiddle.net/dmvcQ/1](http://jsfiddle.net/dmvcQ/1)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T09:43:29.557

好的，我决定发布答案，因为我想解决您的代码的某些部分。

首先`return false;`，你可以使用 jQuery`event.preventDefault();`函数，而不是最后做 a。最终结果基本相同，但是这样做我们可以使用 jQuery 告诉锚点在一开始就什么也不做，然后再运行任何其他代码。

我更新的 Javascript 代码：

```
$('.source-title-box a').click(function(event) {

    // Stop the default anchor behaviour
    event.preventDefault(); 

    // Lets check if the clicked link is already active
    // And if it is active, don't let them click it!
    if($(this).closest('div').hasClass('active')) {
        return false;   
    }

    // Now lets remove any active classes that exist
    $('.active').toggleClass('active');

    // And apply an active class to the clicked buttons
    // parent div
    $(this).closest('div').toggleClass('active');

    var region = $(this).attr('data-region');

    $('.textzone:visible').fadeOut(500, function () {
        $('#' + region).fadeIn(500);
    });
});​ 
```

我添加的 CSS：

```
.active {
    background-color:#467FD9;
    color:#fff;   

}
.active a {
    cursor:default;  /* Don't show the hand cursor */
    color:#fff;  
} 
```

一个工作示例：

[http://jsfiddle.net/dmvcQ/3/](http://jsfiddle.net/dmvcQ/3/)

我不确定当前的 HTML 标记是否有其他用途，但当前的样式和功能可以通过 a 来实现，`<a href="#" data-region="source-region">Our region</a>`您不需要将它们包装在 a`<div>`和 a`<span>`中。

例如这里是相同的代码，只有锚标签：http: [//jsfiddle.net/dmvcQ/7/](http://jsfiddle.net/dmvcQ/7/)

如果您对答案有任何疑问，请告诉我。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T09:00:35.933

```
try with this exemple:
<div id="target">
 Test1
</div>
<div id="other">
  Test2
</div>

<script>
$("#target").click(function() {
  $('#target').css({'background':'blue'});
 $('#other').css({'background':'white'});
});

$("#other").click(function() {
  $('#other').css({'background':'blue'});
  $('#target').css({'background':'white'});
});
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T09:51:07.170

或者你可以主要做jquery

一个工作示例：

[http://jsfiddle.net/razmig/GhbjS/](http://jsfiddle.net/razmig/GhbjS/)

```
$('.activity-title a:first').css({
    "background-color": "#467FD9",
    "color": "#fff"
});

$('.activity-title a').mouseover(function() {
    $('.activity-title a').css({
        "background-color": "#fff",
        "color": "#467FD9"
    });
    $(this).css({
        "background-color": "#467FD9",
        "color": "#fff"
    });

});

$('.activity-title a').click(function() {
    var region = $(this).attr('data-region');

    $('.textzone:visible').fadeOut(2000, function() {
        $('#' + region).fadeIn(2000);
    });

    return false;

}); 
```

# php - 本地备份远程数据库

> ID：11966484
> 
> 赞同：0
> 
> 时间：2012-08-15T08:54:10.987
> 
> 标签：php, mysql, mysql-error-1064, remote-access, database-backups

我必须在一定的时间间隔内在实时服务器中备份我的数据库。为此，我创建了一个批处理文件并使用普通 Windows 的 Schedular 安排它的执行。我在批处理文件中调用了一个 php 文件来执行备份功能。在 php 文件中，我使用普通的 mysql 查询连接到数据库并获取数据结构，但这总是抛出错误说

> **警告**：mysql_connect() [function.mysql-connect]: [2002] 连接尝试失败，因为连接方没有（尝试通过 tcp://[远程数据库服务器] 连接）在 [**本地服务器上的文件**] 上**第 xx 行**

请帮助我克服这个错误，以便我可以在本地备份远程数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:07:45.160

错误代码 2002 表示 MySQL 未在远程服务器上运行，或者您使用了错误的端口号？你确定你用来连接的端口号是开放的，而不是防火墙或其他东西吗？

在 MySQL 参考中阅读更多关于它的信息，他们解释了 2002 错误：[http ://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html](http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:28:45.930

您可以使用的另一个选项是让实时服务器将 JSON 数据发送到本地服务器并在本地插入，这样您就不必处理配置，并且您可以轻松地为应用程序中的其他模块或任何其他应用程序扩展相同的过程可能需要相同的数据而无需重新开始工作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-09-14T13:14:31.897

```
<?php
ini_set('display_errors', 1);
ini_set('max_execution_time', 0);

$notify_me = 'true';
$email = 'notify email';
$this_server = 'FQDN of local server';
$remote_server = 'FQDN of remote server';

$dbserver = "localhost";
$dbuser = "root";
$dbpass = "";
$time_of_day = '22';
$day_of_week = 'Sat';
$backup_user = 'backups';
$who_am_i = 'Name for email to go to';
$backup_server = 'remote ftp server to upload to';
$ftp_user = 'ftp user name';
$ftp_pass = 'ftp password';

$command="php -q /home/$backup_user/create_mysql_dumps.php";
$job="0 $time_of_day * * * $command";
echo "( crontab -l | grep -v \"$command\" ; echo \"$job\" ) | crontab -";

shell_exec("( crontab -l | grep -v \"$command\" ; echo \"$job\" ) | crontab -");

@shell_exec("adduser $backup_user");

mysql_connect($dbserver, $dbuser, $dbpass);

mysql_select_db("mysql");

function dirToArray($directory) {

    $array_items = array();
    $handle = @ opendir($directory);
        while (false !== ($file = @ readdir($handle))) {
            if ($file != "." && $file != "..") {
                if (is_dir($directory)) {
                    $array_items[] = $file;
                }

            }
        }
        @ closedir($handle);

    return $array_items;

}

$sql = mysql_query("show databases");

while($row = mysql_fetch_array($sql)){
@shell_exec("mkdir /home/$backup_user/data/");
shell_exec("chmod 777 /home/$backup_user/data/");

shell_exec("rm /home/$backup_user/data/$row[0].sql -f");
    shell_exec("mysqldump -u $dbuser -p$dbpass $row[0] > /home/$backup_user/data/$row[0].sql");

    echo "Dbase Backup created for $row[0]\n";
    usleep(2000);
    if(file_exists("/home/$backup_user/data/$row[0].sql")){

    if($notify_me == 'true'){
    mail($email, "Dbase Backup created for $row[0]", "Hello $who_am_i This is your backup script telling you that its working and saving a backup for $row[0] in /home/$backup_user/data/$row[0].sql", null, "-f root@$this_server"); 

      }
    }

}

@shell_exec("mkdir /home/$backup_user/data/");
shell_exec("chmod 777 /home/$backup_user/data/");

shell_exec("rm /home/$backup_user/data/all-databases.sql");
shell_exec("mysqldump -u $dbuser -p$dbpass --all-databases > /home/$backup_user/data/all-databases.sql");
echo "Dbase Backup created for All Databases\n";
    if(file_exists("/home/$backup_user/data/$row[0].sql")){
      if($notify_me == 'true'){
    mail($email, "Dbase Backup created for All Databases", "Hello $who_am_i This is your backup script telling you that its working and saving a backup for ALL SERVERS HAS BEEN CREATED", null, "-f root@$this_server"); 

      }
    }

$homes = dirToArray("/home");
$exclude = array('backups', 'mail_admin', 'trials', 'vmail', 'lost+found', 'aquota.user', 'aquota.group');
foreach($homes as $home){

  if(!in_array($home, $exclude) & is_dir("/home/$home")){
  echo "File System Backup created for /home/$home\n";

      @mkdir("/home/$backup_user/files/");
      @mkdir("/home/$backup_user/files/$home");
      @shell_exec("rm /home/$backup_user/files/$home/* -R -f");
      shell_exec("cp /home/$home/* /home/$backup_user/files/$home/ -R -p");
      if($notify_me == 'true'){
    mail($email, "File System Backup created for /home/$home", "Hello $who_am_i This is your backup script telling you that its working and saving a backup for /home/$home in /home/$backup_user/files/$home", null, "-f root@$this_server"); 

      }  
  usleep(2000);
  }

}
if(date("D") == $day_of_week){

@shell_exec("rm /home/$backup_user/named/* -R -f");
@shell_exec("rm /home/$backup_user/httpd/* -R -f");
@shell_exec("rm /home/$backup_user/mysql/my.cnf -f");
@shell_exec("rm /home/$backup_user/php/php.ini -f");

@mkdir("/home/backups/named");
@mkdir("/home/backups/httpd");
@mkdir("/home/backups/named");
@mkdir("/home/backups/mysql");
@mkdir("/home/backups/php");

shell_exec("cp /var/named/* /home/$backup_user/named/ -R -p");
shell_exec("cp /etc/httpd/conf/* /home/$backup_user/httpd/ -R -p");
shell_exec("cp /etc/my.cnf /home/$backup_user/mysql/my.cnf -p");
shell_exec("cp /etc/php.ini /home/$backup_user/php/php.ini -p");
shell_exec("cp /etc/named.conf /home/$backup_user/named/named.conf -p");

@mkdir("/home/$backup_user/zip");

@shell_exec("rm /home/$backup_user/$this_server-backup-weekly.tar.gz -f");
shell_exec("tar -czvf /home/$backup_user/$this_server-backup-weekly.tar.gz /home/$backup_user --exclude=/home/$backup_user/$this_server-backup-weekly.tar.gz");

if(file_exists("/home/$backup_user/$this_server-backup-weekly.tar.gz")){
echo "Weekly Archive created for $this_server\n";
      if($notify_me == 'true'){
    mail($email, "Weekly Archive created for $this_server", "Hello $who_am_i This is your backup script telling you that its working and saving a weekly archive for $server at /home/$backup_user/$this_server-backup-weekly.tar.gz", null, "-f root@$this_server"); 

      }  
    echo "sending backup to " . "http://$backup_server/backme_up.php\n";  

    $file = "/home/$backup_user/$this_server-backup-weekly.tar.gz";

    $fp = fopen($file, 'r');

    $conn_id = ftp_connect($backup_server) or die("Couldn't connect to $ftp_server"); 
    echo "$conn_id, $ftp_user, $ftp_pass";
    ftp_login($conn_id, $ftp_user, $ftp_pass);
    ftp_chdir($conn_id, "/home/$ftp_user");
    $contents = ftp_nlist($conn_id, ".");
    if (ftp_delete($conn_id, "$this_server-backup-weekly.tar.gz")) {
      echo "$this_server-backup-weekly.tar.gzdeleted successful\n";
      } else {
      echo "could not delete $file\n";
      }
    if (ftp_put($conn_id, "$this_server-backup-weekly.tar.gz", $file, FTP_ASCII)) {
      echo "successfully uploaded $file\n";
      } else {
      echo "There was a problem while uploading $file\n";
      }

    ftp_close($conn_id);
    fclose($fp);
}
}

die();
exit; 
```

# c++ - 堆的 C++ 损坏

> ID：11966489
> 
> 赞同：4
> 
> 时间：2012-08-15T08:54:31.003
> 
> 标签：c++, visual-c++, heap-corruption

我有一个简单的同步队列

```
 template <typename T>

    class SynchronisedQueue
    {
    public:

        void Enqueue(const T& data)
        {
            boost::unique_lock<boost::mutex> lock(queueMutex);
            dataQueue.push(data);
            conditionVariable.notify_one();
        } 

        T Dequeue()
        {
            boost::unique_lock<boost::mutex> lock(queueMutex);

            while (dataQueue.size()==0) 
            {
                conditionVariable.wait(lock);
            }

            T result=dataQueue.front(); dataQueue.pop();
            return result;
        } 

    private:

    std::queue<T> dataQueue;                        // Use STL queue to store data
boost::mutex queueMutex;                        // The mutex to synchronise on
boost::condition_variable conditionVariable;    // The condition to wait for
}; 
```

当我从队列中出列时，有时会损坏堆......

> HEAP: Free Heap block ccb1080 在 ccb13c0 被释放后修改

调用堆栈是：

```
ntdll.dll!76fa5654()    
[Frames below may be incorrect and/or missing, no symbols loaded for ntdll.dll] 
ntdll.dll!76f6a554()    
ntdll.dll!76f35a70()    
ntdll.dll!76fa5eff()    
ntdll.dll!76f6a3ba()    
ntdll.dll!76f35a70()    
msvcr90d.dll!_heap_alloc_base(unsigned int size=1222)  Line 105 + 0x28 bytes    C
msvcr90d.dll!_heap_alloc_dbg_impl(unsigned int nSize=1186, int nBlockUse=1, const char * szFileName=0x00000000, int nLine=0, int * errno_tmp=0x1310ee18)  Line 427 + 0x9 bytes  C++
msvcr90d.dll!_nh_malloc_dbg_impl(unsigned int nSize=1186, int nhFlag=0, int nBlockUse=1, const char * szFileName=0x00000000, int nLine=0, int * errno_tmp=0x1310ee18)  Line 239 + 0x19 bytes    C++
msvcr90d.dll!_nh_malloc_dbg(unsigned int nSize=1186, int nhFlag=0, int nBlockUse=1, const char * szFileName=0x00000000, int nLine=0)  Line 296 + 0x1d bytes C++
msvcr90d.dll!malloc(unsigned int nSize=1186)  Line 56 + 0x15 bytes  C++
msvcr90d.dll!operator new(unsigned int size=1186)  Line 59 + 0x9 bytes  C++
x.ax!std::_Allocate<unsigned char>(unsigned int _Count=1186, unsigned char * __formal=0x00000000)  Line 43 + 0x9 bytes  C++
ax.ax!std::allocator<unsigned char>::allocate(unsigned int _Count=1186)  Line 145 + 0xb bytes   C++
ax.ax!std::vector<unsigned char,std::allocator<unsigned char> >::_Buy(unsigned int _Capacity=1186)  Line 1110 + 0xf bytes   C++
ax.ax!std::vector<unsigned char,std::allocator<unsigned char> >::vector<unsigned char,std::allocator<unsigned char> >(const std::vector<unsigned char,std::allocator<unsigned char> > & _Right=[1186](83 'S',50 '2',54 '6',67 'C',162 '¢',4 '',0,0,108 'l',0,0,0,2 '',64 '@',0,0,6 '',14 '',64 '@',0,35 '#',2 '',147 '“',76 'L',114 'r',53 '5',0,0,54 '6',79 'O',78 'N',4 '',0,0,0,0,54 '6',79 'O',78 'N',4 '',0,0,0,0,255 'ÿ',255 'ÿ',255 'ÿ',255 'ÿ',255 'ÿ',255 'ÿ',255 'ÿ',255 'ÿ',106 'j',4 '',0,0,0,0,0,1 '',65 'A',154 'š',3 '',1 '',176 '°',159 'Ÿ',255 'ÿ',240 'ğ',199 'Ç',...))  Line 501 + 0x11 bytes    C++
ax.ax!SynchronisedQueue<std::vector<unsigned char,std::allocator<unsigned char> > >::Dequeue()  Line 32 + 0xc bytes C++
ax.ax!PPin::FillBuffer(IMediaSample * pSample=0x0cadbea8)  Line 225 + 0x12 bytes    C++
ax.ax!PPin::DoBufferProcessingLoop()  Line 300 + 0x13 bytes C++
ax.ax!CSourceStream::ThreadProc()  + 0x13e bytes    
ax.ax!CAMThread::InitialThreadProc()  + 0x51 bytes  
kernel32.dll!753bed6c()     
ntdll.dll!76f4377b()    
ntdll.dll!76f4374e() 
```

> 什么可能导致此堆损坏？如何调试堆损坏错误？有任何想法吗...

**更新：** 使用示例

```
// Enqueue
void GetVideoStreams( BYTE *pData)
{
 std::vector<BYTE> vecFrame(pData, pData + nLen/sizeof(pData[0]));
 IncomingFramesQueue.Enqueue(vecFrame);

}

//Dequeue
void ConsumeVideoStreams()
{

 vector<BYTE> data = IncomingFramesQueue.Dequeue();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:05:58.497

如上所述 - 您的代码和您发布的堆栈跟踪表明一些内存分配正在进行中。连同错误消息，我假设堆损坏发生在其他地方，并且每次都在出队时弹出，因为它使用大量内存来复制这些向量。

使用一些内存分析工具的评估版（例如[http://www.softwareverify.com/cpp-memory.php](http://www.softwareverify.com/cpp-memory.php)）来查找错误。市场上也有一些免费工具（最著名的是 Valgrind），但我不知道有什么免费的适用于 Visual C++ 的好工具。

此外，您可以查看这篇文章[如何调试堆损坏错误？](https://stackoverflow.com/questions/1010106/how-to-debug-heap-corruption-errors)此处了解有关如何解决此错误的其他方法。

从我到目前为止看到的情况来看，错误不在您发布的代码中。如果您需要更多帮助，请提供一个包含错误的小型自包含示例。

* * *

我刚刚发现了一个可能值得一试的免费工具：[Dr. Memory](http://code.google.com/p/drmemory/)。我当然从[stackoverflow](https://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows)获得了链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T10:39:05.790

是的，。您可能正在混合运行时库的 Release 和 Debug 版本。

在 Windows（仅 AFAIK）上，有 2 个不同的运行时库，发布版本会按照您的预期进行内存分配，但调试版本会在所有分配周围添加保护块，以便它可以跟踪缓冲区溢出和其他内存错误。这个系统的问题是，如果你在同一个应用程序中混合一个 Release 和一个 Debug 库，你将在 Release 中分配（比如说）10 个字节，然后在 Debug 中释放 18 个字节（4+10+4）。

诀窍是每次都构建和链接所有 Debug 或所有 Release。或者，如果您必须在调试版本中使用 Release 库，那么您*必须*确保在 dll 中进行的所有分配也由同一个库释放 - 不允许使用 CRT 新/删除例程，将它们包装在功能。这确保了 dll A 中的 10 字节分配将被同一个 dll 释放，这显然只会删除 10 字节。

编辑：

好的，如果不是这样，那么在使用复制构造函数（Dequeue 的第 32 行）分配新向量时查看调用堆栈会显示错误，因此首先将该行拆分为 2 个语句，以便您可以查看它是否是副本，或者导致问题的pop（我总是倾向于在它们之间放置一个调试语句，以确保您知道哪一行是问题所在）。

您的示例代码显示了访问队列的 2 种不同方式 -> Enqueue 和 .Dequeue，这表明队列本身更加复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T20:20:00.973

这些是非常有用的函数，可以调用以验证堆在调试构建中没有损坏：

_ASSERTE(_CrtCheckMemory());

您还可以设置标志，以便在退出时检查内存泄漏：

通过设置（或）以下标志：_CRTDBG_LEAK_CHECK_DF

有关详细信息，请参阅以下页面：

[http://msdn.microsoft.com/en-us/library/e73x0s4b(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/e73x0s4b(v=vs.110).aspx) [http://msdn.microsoft.com/en-us/library/5at7yxcs.aspx](http://msdn.microsoft.com/en-us/library/5at7yxcs.aspx)

# windows-8 - kaspersky pure2 阻止 Metro 应用程序运行

> ID：11966499
> 
> 赞同：2
> 
> 时间：2012-08-15T08:55:44.640
> 
> 标签：windows-8

几天之内，我一直在使用 Windows 8 build9200，我发现当你安装 kaspersky pure 2 时，它会阻止一些 Metro 应用程序运行，并且在 Metro 应用程序鞋启动屏幕之后，它们只是让我回到 Metro 默认 UI，我试图将所有低限制的 Windows 服务和应用程序置于受信任级别但不起作用，通常情况下，它发生在 UAC 设置为关闭但我刷新 Windows 并且一切正常，再次安装 kapser 并且某些 Metro 应用程序无法运行时它不会影响所有 Metro 应用程序我的 chrome 在 Metro 界面中工作正常，我不知道是否有可能的解决方案？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T14:44:25.127

Kaspersky 发布了 Kaspersky PURE 2.0 的更新版本...在[http://products.kaspersky-labs.com/english/homeuser/pure2/pure12.0.2.733en.exe](http://products.kaspersky-labs.com/english/homeuser/pure2/pure12.0.2.733en.exe)下载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T10:00:48.717

我检查了卡巴斯基网站，现在表明 Pure 与 Windows 8 兼容。我安装了，但我再次无法启动任何 Metro 应用程序（商店、联系人......）这很无聊。我的订阅正在运行，我无法使用它:(

# .net - {“找不到可安装的 ISAM。”}

> ID：11966502
> 
> 赞同：0
> 
> 时间：2012-08-15T08:55:47.240
> 
> 标签：.net

作为 .Net 编程的新手，我有疑问，请澄清一下。

我想使用 MS Access2007 创建和连接数据库。

我将代码编写为：

```
OleDbConnection con;
protected void Page_Load(object sender, EventArgs e)
{
   con = new OleDbConnection("Provider=Microsoft.Ace.Oledb.12.0;DataSource=D:/Customerdetails.accdb");
   con.Open(); 
```

1.如何纠正此错误{“找不到可安装的 ISAM。”} 2.如何知道我的 PC 中的 MS Access 驱动程序名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:22:13.277

你有没有看过 HKEY_LOCAL_MACHINE\software\odbc\odbcinst.ini 那里有一个驱动程序列表和名称 - 你应该能够从中挑选出来，以编程方式（例如寻找优惠词）我注意到默认情况下 win7 似乎来了即使安装了办公室，驱动程序也比以前少得多。

# r - 如何替换栅格对象中的 NA

> ID：11966503
> 
> 赞同：15
> 
> 时间：2012-08-15T08:55:51.143
> 
> 标签：r, spatial, raster

我需要从下面的示例中替换`NA`光栅对象 ( `r`) 中的 's。

```
library(raster)
filename <- system.file("external/test.grd", package="raster")
r <- raster(filename) 
```

我也尝试删除这些（并将结果放在 a 中`data.frame`），但无济于事。

```
dfr <- as.data.frame(r, na.rm=T)
summary(dfr)
# test       
# Min.   : 128.4  
# 1st Qu.: 293.2  
# Median : 371.4  
# Mean   : 423.2  
# 3rd Qu.: 499.8  
# Max.   :1805.8  
# NA's   :6097 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-16T07:20:14.470

一种更安全的内存方法（对于大文件）是使用重新分类：

```
library(raster)
filename <- system.file("external/test.grd", package="raster")
r <- raster(filename)
rna <- reclassify(r, cbind(NA, 250)) 
```

这里有三种方法可以做到这一点`terra`

```
library(terra)
f <- system.file("ex/elev.tif", package="terra")
r <- rast(f)
x <- classify(r, cbind(NA, -99))
y <- subst(r, NA, -99)
z <- ifel(is.na(r), -99, r) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-15T09:31:18.910

我不确定`NA`从对象中删除值是否有意义`raster`，但您可以轻松替换它。

例如：

```
oldpar <- par(mfrow=c(1, 2))
plot(r)
r[is.na(r)] <- 250
plot(r)
par(oldpar) 
```

![在此处输入图像描述](../Images/f3baf4ae569abc9136732b50cb9806c9.png)

* * *

如果您真的想要，您可以将栅格值提取到向量中，然后删除这些`NA`值。（虽然，由于您丢失了空间信息，我看不出这有什么帮助。）

```
r <- raster(filename)

r <- values(r)
head(r)
[1] NA NA NA NA NA NA

head(na.omit(r))
[1] 633.686 712.545 654.162 604.442 857.256 755.506 
```

# java - 代码重复（或不重复） - JAVA

> ID：11966510
> 
> 赞同：3
> 
> 时间：2012-08-15T08:56:33.473
> 
> 标签：java, interface, instanceof, code-duplication

我有代码重复的情况（或者是吗？），我不知道如何避免它，但我的代码仍然保持清晰。

让我把情况大大简化：

```
// let's say I have a interface Entity

interface Entity {

    public Entity add (Entity operand);

}

// And two classes that implement this interface

class MyInteger implements Entity {

    private int value;

    public Entity add (Entity operand)
    {
         // here I have to manage the situation distinctly if operand is a MyInteger or MyString

    }

}

class MyString implements Entity {

    private String value;

    public Entity add (Entity operand )
    {

    }
} 
```

现在，我的问题是 MyString 中的 add 方法与 MyInteger 中的 add 方法基本相同。请记住，我有比这里提到的两种类型更多的类型，并且对于某些方法 add 是不一样的。

这是代码重复吗？如果是这样，有没有办法避免它？因为我似乎想不出一个。

另外，在 add 方法中，如何在不使用 if (instanceof) 语句的情况下在操作数的各种类型之间进行切换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:59:10.690

查找模板模式。您可以为任何重复的代码重构并添加一个 Abstract 类。如果这是特定于两个类，您可以只让这两个类扩展 Abstract 类。

为了避免`instanceof`，我不确定什么是最好的，但您可以链接一个特定于实体类的额外方法，然后在必要时调用超级/抽象类。

最后，调查泛型提供了哪些可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T08:59:13.080

听起来您需要[访问者](http://en.wikipedia.org/wiki/Visitor_pattern)或[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)机制。

您的`add(Entity operand)`方法必须根据传递的操作数来决定要做什么，因此您可以通过*回调*操作数来实现这一点。例如

```
// in MyInteger
public Entity add(Entity operand) {
   operand.addInteger(this);
}

// in MyString
public Entity add(Entity operand) {
   operand.addString(this);
} 
```

请注意，上述实现会根据调用的类型而改变。通过重定向回操作数，您的调用路径由最初调用的实体*和*使用的操作数确定。

每个实体都必须实现`addInteger(MyInteger p)`，`addString(MyString p)`等等，但在这个阶段你有具体的类型可以使用，并且可以轻松地确定要做什么。

请注意，您不必使用`instanceof`或类似。以上是类型安全且完整的。例如，添加一个新的操作数类型将导致一组明显的重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T08:59:35.717

您可以使用抽象类并为其提供具体的 add 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T10:56:12.430

到目前为止，我认为您的方法没有问题。

由于实体是一个实例，您可以通过以下方式解决代码重复问题：

*   只需忽略它并进行重复，因为它会给你一个干净的解决方案。如果您只有少数情况会发生这种重复，那么以这种方式实现它可能会更好。

*   如前所述，实现一个抽象类，例如 AbstractEntity 将所有方法实现一次作为受保护的成员方法，并将 MyInteger 和 MyString 声明为子类。

*   进一步进行子类化，考虑哪个实体需要哪些方法并构建子类树。注意：如果您不能进行仔细的设计，这将阻碍进一步的调整。

*   使用实用程序类：具有公共静态方法和私有构造函数的类来实现所需的功能。

如何找出实体的类型：

*   使用 instanceof（好吧，这很丑）
*   在接口中实现方法返回类型为 Enum 或测试属性：getType() == STRING 或 isString()
*   在接口中实现您希望的方法：checkIfStringAndAddIt()。

# javascript - 来自 iframe 中 swf 的 Javascript 调用

> ID：11966514
> 
> 赞同：0
> 
> 时间：2012-08-15T08:56:45.917
> 
> 标签：javascript, actionscript-3, cross-domain

当所有都在同一个html文档中时，我从AS3调用了一个javascript函数，这一切都成功了。但是当我将 swf 放入 iframe 中时，我收到一个错误，例如；

```
Unsafe JavaScript attempt to access frame with URL http://example.com/ from     frame with URL http://example2.com. Domains, protocols and ports must match. 
```

iframe 和父文档具有不同的域。我该如何解决？在这种情况下，要求之一是它也应该在 iframe 中使用。因此，将它们全部放在同一个框架中并不是解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:46:37.690

正如 Philipp 所评论的，这被浏览器的跨脚本保护所阻止（其中的 SWF 元素只是一种干扰 - 如果子 iFrame 中的任何 javascript 不共享同一个域，则它们将被阻止调用父框架）。

但是，您的父框架应该可以访问子 iframe，因此您可以从您的 swf 在子 iframe 中设置一个参数，并从父框架轮询该参数。

否则，用 PHP 或 .NET 或您喜欢的任何东西创建服务器端脚本并从中获得价值是微不足道的。

# math - 查找所有线性相关的向量子集

> ID：11966515
> 
> 赞同：0
> 
> 时间：2012-08-15T08:57:14.637
> 
> 标签：math, vector, linear-algebra

我有这种形式的向量

```
(1 1 1 0 1 0)
(0 0 1 0 0 0)
(1 0 0 0 0 0) 
(0 0 0 1 0 0) 
(1 1 0 0 1 0) 
(0 0 1 1 0 0) 
(1 0 1 1 0 0) 
```

我需要找到 Z2 上的所有线性相关子集。

例如 1,2,5 和 3,6,7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:53:07.177

好的，我的 5 美分蛮力 IINM 正在迭代向量集的所有子集。所以，相反，你从底部开始，每个向量的单例集显然是线性独立的。

在下一步中，对于每个单例集合，您通过尝试添加集合中的每个剩余向量来创建一个列表，并查看这些对中的哪些是独立的，记下您已经测试过的那些对，以防止重复的努力。

在第 3 步中，对于每个独立的对，您将尝试将剩余的每个向量相加以形成三元组，测试新向量的独立性，并标记您已经测试过的三元组。

这应该比蛮力节省很多，最坏的情况是一组所有独立的向量。

# css-float - 删除浮动 CSS

> ID：11966518
> 
> 赞同：0
> 
> 时间：2012-08-15T08:57:26.513
> 
> 标签：css-float

我有一个具有浮动属性的 CSS 代码。当我调整浏览器窗口的大小时，我的网页菜单正在向下移动。我已经注释掉了浮动属性，但没有任何改变。我应该怎么做才能使它即使调整浏览器大小也不会向下移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:08:38.673

调整窗口大小时，浮动与 div 的浮动无关。

它只是要求 div 向左对齐，只有在有空间时才向右对齐，

我认为你应该做的是像下面这样制作名为“内容”的包装器 div ID，并在那里添加所有内部 div 元素，

```
#content{
width:960px;
margin:0px auto;
} 
```

现在在这个 div 内容中，如果你有 2 个 div 的宽度为 400px 和 400px，如果你将它们的属性设置为向左浮动，它们会向左对齐，如果你将它设置为向右浮动，它们会向右对齐..

如果没有空间，例如一个 div 是 400 像素，另一个是 600 像素，即使属性设置为向左浮动，它们也会作为垂直潜水出现，因为组合宽度大于容器 div

了解有关[固定宽度 css 设计的更多信息](http://www.techrepublic.com/article/creating-a-fixed-width-layout-with-css/5314471)

# javascript - 如何找到 0 - 100 之间的素数？

> ID：11966520
> 
> 赞同：61
> 
> 时间：2012-08-15T08:57:47.810
> 
> 标签：javascript, math, primes

在 Javascript 中，我如何找到 0 - 100 之间的素数？我已经考虑过了，但我不知道如何找到它们。我想过做 x % x 但我发现了明显的问题。这是我到目前为止所拥有的：但不幸的是，这是有史以来最糟糕的代码。

```
var prime = function (){
var num;
for (num = 0; num < 101; num++){
    if (num % 2 === 0){
        break;
    }
    else if (num % 3 === 0){
        break;
    }
    else if (num % 4=== 0){
        break;
    }
    else if (num % 5 === 0){
        break;
    }
    else if (num % 6 === 0){
        break;
    }
    else if (num % 7 === 0){
        break;
    }
    else if (num % 8 === 0){
        break;
    }
    else if (num % 9 === 0){
        break;
    }
    else if (num % 10 === 0){
        break;
    }
    else if (num % 11 === 0){
        break;
    }
    else if (num % 12 === 0){
        break;
    }
    else {
        return num;
    }
}
};
console.log(prime()); 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-09-05T18:26:38.017

下面是一个在 JavaScript 中实现筛子的例子：

```
function getPrimes(max) {
    var sieve = [], i, j, primes = [];
    for (i = 2; i <= max; ++i) {
        if (!sieve[i]) {
            // i has not been marked -- it is prime
            primes.push(i);
            for (j = i << 1; j <= max; j += i) {
                sieve[j] = true;
            }
        }
    }
    return primes;
} 
```

然后`getPrimes(100)`将返回 2 到 100（含）之间的所有素数的数组。当然，由于内存限制，您不能将其与大参数一起使用。

Java 实现看起来非常相似。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-08-15T10:15:55.183

这是我解决它的方法。将它从 Java 重写为 JavaScript，如果有语法错误，请见谅。

```
function isPrime (n)
{
    if (n < 2) return false;

    /**
     * An integer is prime if it is not divisible by any prime less than or equal to its square root
     **/

    var q = Math.floor(Math.sqrt(n));

    for (var i = 2; i <= q; i++)
    {
        if (n % i == 0)
        {
            return false;
        }
    }

    return true;
} 
```

一个数 ,`n`如果它不能被除 1 和它本身之外的任何其他数整除，那么它就是质数。此外，检查数字 [2, sqrt(n)] 就足够了。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-08-15T09:15:09.667

**这是该脚本的现场演示：http: [//jsfiddle.net/K2QJp/](http://jsfiddle.net/K2QJp/)**

首先，创建一个函数来测试单个数字是否为素数。如果你想扩展 Number 对象，你可以，但我决定让代码尽可能简单。

```
function isPrime(num) {
    if(num < 2) return false;
    for (var i = 2; i < num; i++) {
        if(num%i==0)
            return false;
    }
    return true;
} 
```

该脚本遍历比该数字小 2 到 1 之间的每个数字，并测试如果您将该数字除以增量，是否有任何数字没有余数。如果有任何没有余数，它就不是素数。如果数字小于 2，则它不是质数。否则，它是素数。

然后创建一个 for 循环来遍历数字 0 到 100 并使用该函数测试每个数字。如果是素数，则将数字输出到日志中。

```
for(var i = 0; i < 100; i++){
    if(isPrime(i)) console.log(i);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-08-15T09:00:01.927

无论使用哪种语言，在一个范围内寻找素数的最好和最容易获得的方法之一就是使用[sieve](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)。

不会给你代码，但这是一个很好的起点。

对于像您这样的小范围，最有效的方法是预先计算数字。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-01-02T23:52:51.733

我稍微修改了[Sundaram](https://en.wikipedia.org/wiki/Sieve_of_Sundaram)算法的 Sieve 以减少不必要的迭代，它似乎非常快。

这个算法实际上比这个主题下最被接受[的@Ted Hopp 的解决方案快两倍。](https://stackoverflow.com/a/12287599)解决 0 - 1M 之间的 78498 个素数在 Chrome 55 中需要 20~25 毫秒，在 FF 50.1 中需要 < 90 毫秒。@ vitaly [-t 的获取下一个素数算法](https://stackoverflow.com/a/32890203)看起来很有趣，但结果也慢得多。

这是核心算法。可以应用分段和线程来获得极好的结果。

```
"use strict";
function primeSieve(n){
  var a = Array(n = n/2),
      t = (Math.sqrt(4+8*n)-2)/4,
      u = 0,
      r = [];
  for(var i = 1; i <= t; i++){
    u = (n-i)/(1+2*i);
    for(var j = i; j <= u; j++) a[i + j + 2*i*j] = true;
  }
  for(var i = 0; i<= n; i++) !a[i] && r.push(i*2+1);
  return r;
}

var primes = [];
console.time("primes");
primes = primeSieve(1000000);
console.timeEnd("primes");
console.log(primes.length);
```

**循环限制解释：**

就像 Erasthotenes 筛法一样，Sundaram 筛法算法也会从列表中删除一些选定的整数。选择哪些整数要划掉规则是 i + j + 2ij ≤ n 其中 i 和 j 是两个索引，n 是总元素的数量。一旦我们划掉每一个 i + j + 2ij，剩下的数字就会加倍并奇数化 (2n+1) 以显示素数列表。最后阶段实际上是偶数的自动折扣。它的证明[在这里](https://en.wikipedia.org/wiki/Sieve_of_Sundaram#Correctness)得到了很好的解释。

仅当正确选择循环索引开始和结束限制以使不存在（或最小）冗余（多次）消除非素数时，Sundaram 的筛选才会快。因为我们需要 i 和 j 值来计算要删除的数字，所以 i + j + 2ij 直到 n 让我们看看我们如何接近。

**i)**所以我们必须找到 i 和 j 相等时可以取的最大值。即 2i + 2i^2 = n。我们可以通过使用二次公式轻松求解 i 的正值，即`t = (Math.sqrt(4+8*n)-2)/4,`

**j)**内部循环索引 j 应该从 i 开始并一直运行到它可以与当前 i 值一起运行的点。仅此而已。由于我们知道 i + j + 2ij = n，这可以很容易地计算为`u = (n-i)/(1+2*i);`

虽然这不会完全消除冗余交叉点，但它将“大大”消除冗余。例如，对于 n = 50（检查最大为 100 的素数）而不是执行 50 x 50 = 2500，我们总共只执行 30 次迭代。很明显，这个算法不应该被认为是一个 O(n^2) 时间复杂度的算法。

```
i  j  v
1  1  4
1  2  7
1  3 10
1  4 13
1  5 16
1  6 19
1  7 22  <<
1  8 25
1  9 28
1 10 31  <<
1 11 34
1 12 37  <<
1 13 40  <<
1 14 43
1 15 46
1 16 49  <<
2  2 12
2  3 17
2  4 22  << dupe #1
2  5 27
2  6 32
2  7 37  << dupe #2
2  8 42
2  9 47
3  3 24
3  4 31  << dupe #3
3  5 38
3  6 45
4  4 40  << dupe #4
4  5 49  << dupe #5 
```

其中只有5个重复。22、31、37、40、49。对于 n = 100，冗余度约为 20%，但对于 n = 10M，它增加到 ~300%。这意味着进一步优化 SoS 有可能随着 n 的增长更快地获得结果。因此，一个想法可能是分段并始终保持 n 小。

所以好吧..我决定把这个任务更进一步。

经过对反复交叉的一些仔细检查后，我意识到，除案例外，如果or索引值中`i === 1`的一个或两个在 4、7、10、13、16、19 之间。 .series，生成一个重复的交叉。然后只在 时允许内循环转动，从而实现循环总数进一步减少 35-40%。因此，例如对于 1M 整数，嵌套循环的总转数从 1.4M 下降到 1M。哇..！我们在这里谈论的几乎是 O(n)。`i``j``i%3-1 !== 0`

我刚刚做了一个测试。在 JS 中，一个空循环计数到 1B 就需要 4000 毫秒。在以下修改后的算法中，找到高达 100M 的素数需要相同的时间。

我还实现了该算法的分段部分以推送给工人。这样我们也可以使用多个线程。但是该代码稍后会出现。

因此，让我向您介绍修改后​​的 Sundaram 筛子，它可能在不分段时处于最佳状态。它将使用 Chrome V8 和 Edge ChakraCore 在大约 15-20 毫秒内计算 0-1M 之间的素数。

```
"use strict";
function primeSieve(n){
  var a = Array(n = n/2),
      t = (Math.sqrt(4+8*n)-2)/4,
      u = 0,
      r = [];
  for(var i = 1; i < (n-1)/3; i++) a[1+3*i] = true;
  for(var i = 2; i <= t; i++){
    u = (n-i)/(1+2*i);
    if (i%3-1) for(var j = i; j < u; j++) a[i + j + 2*i*j] = true;
  }
  for(var i = 0; i< n; i++) !a[i] && r.push(i*2+1);
  return r;
}

var primes = [];
console.time("primes");
primes = primeSieve(1000000);
console.timeEnd("primes");
console.log(primes.length);
```

嗯......最后我想我已经实现了一个筛子（它起源于 Sundaram 的巧妙筛子），它是我可以在互联网上找到的最快的 JavaScript 筛子，包括“Eratosthenes 的 Odds only Sieve”或“阿特金斯筛”。这也为网络工作者、多线程做好了准备。

这样想。在这台用于单线程的简陋 AMD PC 中，JS 需要 3,300 毫秒才能计数到 10^9，以下优化的分段 SoS 将在 14,000 毫秒内为我提供高达 10^9 的 50847534 个素数。这意味着只是计数的 4.25 倍。我认为这令人印象深刻。

你可以自己测试一下；

```
console.time("tare");
for (var i = 0; i < 1000000000; i++);
console.timeEnd("tare");
```

在这里，我向您介绍了 Sundaram 的分段 Seieve。

```
"use strict";
function findPrimes(n){

  function primeSieve(g,o,r){
    var t = (Math.sqrt(4+8*(g+o))-2)/4,
        e = 0,
        s = 0;

    ar.fill(true);
    if (o) {
      for(var i = Math.ceil((o-1)/3); i < (g+o-1)/3; i++) ar[1+3*i-o] = false;
      for(var i = 2; i < t; i++){
        s = Math.ceil((o-i)/(1+2*i));
        e = (g+o-i)/(1+2*i);
        if (i%3-1) for(var j = s; j < e; j++) ar[i + j + 2*i*j-o] = false;
      }
    } else {
        for(var i = 1; i < (g-1)/3; i++) ar[1+3*i] = false;
        for(var i = 2; i < t; i++){
          e = (g-i)/(1+2*i);
          if (i%3-1) for(var j = i; j < e; j++) ar[i + j + 2*i*j] = false;
        }
      }
    for(var i = 0; i < g; i++) ar[i] && r.push((i+o)*2+1);
    return r;
  }

  var cs = n <= 1e6 ? 7500
                    : n <= 1e7 ? 60000
                               : 100000, // chunk size
      cc = ~~(n/cs),                     // chunk count
      xs = n % cs,                       // excess after last chunk
      ar = Array(cs/2),                  // array used as map
  result = [];

  for(var i = 0; i < cc; i++) result = primeSieve(cs/2,i*cs/2,result);
  result = xs ? primeSieve(xs/2,cc*cs/2,result) : result;
  result[0] *=2;
  return result;
}

var primes = [];
console.time("primes");
primes = findPrimes(1000000000);
console.timeEnd("primes");
console.log(primes.length);
```

我不确定它是否比这更好。我很想听听你的意见。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-04-14T09:55:58.193

如果一个数不能被比该数低的其他素数整除，则该数是素数。

所以这建立了一个`primes`数组。将每个新的奇数候选`n`除以现有的`primes`低于`n`. 作为一种优化，它不考虑偶数并将前置`2`作为最后一步。

```
var primes = [];
for(var n=3;n<=100;n+=2) {
  if(primes.every(function(prime){return n%prime!=0})) {
    primes.push(n);
  }
}
primes.unshift(2); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-09-13T12:56:39.007

求 0 到 n 之间的素数。您只需要检查一个数字 x 是否可以被 0 -（x 的平方根）之间的任何数字整除。如果我们通过 n 并找到 0 和 n 之间的所有素数，逻辑可以实现为 -

```
 function findPrimeNums(n)
    { 
       var x= 3,j,i=2,
       primeArr=[2],isPrime;
       for (;x<=n;x+=2){
           j = (int) Math.sqrt (x);
           isPrime = true;
           for (i = 2; i <= j; i++)
           {
                if (x % i == 0){
                    isPrime = false;
                    break;
                }
            }
            if(isPrime){
                primeArr.push(x);
            }

        }   

        return primeArr;
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-06-17T04:45:46.777

```
 var n=100;
            var counter = 0;
            var primeNumbers = "Prime Numbers: ";
            for(var i=2; i<=n; ++i)
            {
                counter=0;
                for(var j=2; j<=n; ++j)
                {
                    if(i>=j && i%j == 0)
                    {
                        ++counter;
                    }

                }
                if(counter == 1)
                    {
                        primeNumbers = primeNumbers + i + "  ";
                    }

            }
            console.log(primeNumbers); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-15T09:11:25.473

Luchian 的回答为您提供了找到素数的标准技术的链接。

一种效率较低但更简单的方法是将现有代码转换为嵌套循环。观察你除以 2,3,4,5,6 等等......然后把它变成一个循环。

鉴于这是作业，并且作业的目的是帮助您学习基本的编程，一个简单、正确但效率较低的解决方案应该没问题。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-11-06T18:48:18.700

[使用递归结合此处](https://stackoverflow.com/a/11967564/561731)的平方根规则，检查一个数字是否为素数：

```
function isPrime(num){

    // An integer is prime if it is not divisible by any prime less than or equal to its square root
    var squareRoot = parseInt(Math.sqrt(num));
    var primeCountUp = function(divisor){
        if(divisor > squareRoot) {
            // got to a point where the divisor is greater than 
            // the square root, therefore it is prime
            return true;
        }
        else if(num % divisor === 0) {
            // found a result that divides evenly, NOT prime
            return false;
        }
        else {
            // keep counting
            return primeCountUp(++divisor);
        }
    };

    // start @ 2 because everything is divisible by 1
    return primeCountUp(2);

} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-06-16T05:22:17.953

我最近想出了一个单行解决方案，可以在 Scrimba 上完成 JS 挑战（下图）。

**ES6+**

```
const getPrimes=num=>Array(num-1).fill().map((e,i)=>2+i).filter((e,i,a)=>a.slice(0,i).every(x=>e%x!==0)); 
```

**< ES6**

```
function getPrimes(num){return ",".repeat(num).slice(0,-1).split(',').map(function(e,i){return i+1}).filter(function(e){return e>1}).filter(function(x){return ",".repeat(x).slice(0,-1).split(',').map(function(f,j){return j}).filter(function(e){return e>1}).every(function(e){return x%e!==0})})}; 
```

这是解释的逻辑：

1.  首先，该`.repeat()`函数使用所需数字（100）作为转发器参数，然后将数组映射到索引+1以获得所需数字（在本例中为100）的所有数字的数组。从 0 到该数字 (0-100) 的数字范围。这里正在进行一些字符串拆分和连接魔术。如果您愿意，我很乐意进一步解释这一步。

2.  我们从数组中排除 0 和 1，因为它们不应该被测试为素数，以免它们给出误报。两者都不是素数。我们`.filter()`仅使用 > 1 (≥ 2) 的数字来执行此操作。

3.  现在，我们过滤我们的新数组，其中包含 2 到所需数字 (100) 之间的所有整数，仅用于素数。为了只过滤素数，我们在第一步中使用了一些相同的魔法。我们再次使用`.filter()`and来创建一个从 2 到新数字数组中的**每个**值的新数组。对于每个值的新数组，我们检查是否有任何数字 ≥ 2 和 < 该数字是该数字的因数。我们可以使用与模运算符配对的方法来执行此操作，以检查该数字在除以 2 和自身之间的任何值时是否有任何余数。如果每个值都有余数 (`.repeat()`**`.every()``%``x%e!==0`)，从 2 到该数字的所有值都满足条件（但不包括该数字，即：[2,99]），我们可以说该数字是素数。过滤器函数将所有素数返回到最上面的返回值，从而返回介于 2 和传递值之间的素数列表。**

 **例如，使用我在上面添加的这些函数之一，返回以下内容：

```
getPrimes(100);
// => [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97] 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-05-06T12:48:52.870

## 你也可以试试这个方法，这个方法很基础但很容易理解：

```
 var tw = 2, th = 3, fv = 5, se = 7; 

 document.write(tw + "," + th + ","+ fv + "," + se + ",");

for(var n = 0; n <= 100; n++)
{

  if((n % tw !== 0) && (n % th !==0) && (n % fv !==0 ) && (n % se !==0))

  {
      if (n == 1)
      {
          continue;
      }

    document.write(n +",");
  }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-10-01T14:32:00.157

这是一种在 JavaScript 中基于先前素数计算素数的快速方法。

```
function nextPrime(value) {
    if (value > 2) {
        var i, q;
        do {
            i = 3;
            value += 2;
            q = Math.floor(Math.sqrt(value));
            while (i <= q && value % i) {
                i += 2;
            }
        } while (i <= q);
        return value;
    }
    return value === 2 ? 3 : 2;
} 
```

### 测试

```
var value = 0, result = [];
for (var i = 0; i < 10; i++) {
    value = nextPrime(value);
    result.push(value);
}
console.log("Primes:", result); 
```

### 输出

```
Primes: [ 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 ] 
```

它比此处发布的其他替代方案更快，因为：

*   它将循环限制与整数对齐，这样工作得更快；
*   它使用较短的迭代循环，跳过偶数。

它可以在大约 130 毫秒内为您提供前 100,000 个素数，或在大约 4 秒内为您提供前 1m 个素数。

```
 function nextPrime(value) {
        if (value > 2) {
            var i, q;
            do {
                i = 3;
                value += 2;
                q = Math.floor(Math.sqrt(value));
                while (i <= q && value % i) {
                    i += 2;
                }
            } while (i <= q);
            return value;
        }
        return value === 2 ? 3 : 2;
    }

    var value, result = [];
    for (var i = 0; i < 10; i++) {
        value = nextPrime(value);
        result.push(value);
    }

    display("Primes: " + result.join(', '));

    function display(msg) {
        document.body.insertAdjacentHTML(
            "beforeend",
            "<p>" + msg + "</p>"
        );
    }
```

## 更新

[这是一个比这个快 10 倍的解决方案](https://github.com/vitaly-t/primes-generator)。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-10-06T20:43:50.347

```
<code>
<script language="javascript">
   var n=prompt("Enter User Value")
     var x=1;
       if(n==0 || n==1) x=0;
          for(i=2;i<n;i++)
           {
          if(n%i==0)
       {
     x=0;
     break;
       }
           }
           if(x==1)
             {
                alert(n +" "+" is prime");
             }
             else
             {
                alert(n +" "+" is not prime");
             }

          </script> 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-11-13T11:32:32.087

埃拉托色尼筛。它有点外观，但很简单，而且很有效！

```
function count_prime(arg) {

    arg = typeof arg !== 'undefined' ? arg : 20; //default value
    var list = [2]
    var list2 = [0,1]
    var real_prime = []

    counter = 2
    while (counter < arg ) {
        if (counter % 2 !== 0) {
            list.push(counter)
        }
        counter++
    }

    for (i = 0; i < list.length - 1; i++) {
        var a = list[i]
        for (j = 0; j < list.length - 1; j++) {
            if (list[j] % a === 0 && list[j] !== a) {
                list[j] = false;       // assign false to non-prime numbers
            }
        }
        if (list[i] !== false) { 
            real_prime.push(list[i]);  // save all prime numbers in new array
        }
    }
 }
window.onload=count_prime(100); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-05-13T08:50:17.720

这是我的尝试。

将初始`i=0`值从 0 更改为您想要的任何值，将第二个`i<100`从 100 更改为任何值以获得不同范围内的素数。

```
for(var i=0; i<100000; i++){
    var devisableCount = 2;

    for(var x=0; x<=i/2; x++){
        if (devisableCount > 3) {
            break;
        }
        if(i !== 1 && i !== 0 && i !== x){
            if(i%x === 0){
               devisableCount++;
             }
        }
    }

    if(devisableCount === 3){
        console.log(i);
    }
} 
```

我试过了`10000000`- 这需要一些时间，但似乎是准确的。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-01-10T09:42:54.437

这是计算给定范围（1到极限）之间素数的非常简单的方法。

**简单的解决方案**：

```
 public static void getAllPrimeNumbers(int limit) {

        System.out.println("Printing prime number from 1 to " + limit);

        for(int number=2; number<=limit; number++){
            //***print all prime numbers upto limit***
            if(isPrime(number)){
                System.out.println(number);
            }
        }
    }

    public static boolean isPrime(int num) {
        if (num == 0 || num == 1) {
            return false;
        }
        if (num == 2) { 
            return true;
        }

        for (int i = 2; i <= num / 2; i++) {
            if (num % i == 0) {
                return false;
            }
        }
        return true;
    } 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-06-04T20:42:51.463

而这个来自著名 JS Ninja 的著名代码

```
var isPrime = n => Array(Math.ceil(Math.sqrt(n)+1)).fill().map((e,i)=>i).slice(2).every(m => n%m);

console.log(Array(100).fill().map((e,i)=>i+1).slice(1).filter(isPrime)); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-08-21T07:09:41.943

使用 ES6 的新特性构建的列表，尤其是使用生成器。转到[https://codepen.io/arius/pen/wqmzGp](https://codepen.io/arius/pen/wqmzGp)用加泰罗尼亚语与我​​的学生一起上课。希望对你有帮助。

```
function* Primer(max) { 
  const infinite = !max && max !== 0;
  const re = /^.?$|^(..+?)\1+$/; 
  let current = 1;

  while (infinite || max-- ) {
      if(!re.test('1'.repeat(current)) == true) yield current;
      current++
  };
};

let [...list] = Primer(100); 
console.log(list);
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-08-16T02:22:26.923

*   如果我们已经尝试删除*2* ，为什么还要尝试删除*4*（和*6,8,10,12* ） ？如果我们已经尝试删除*3* ，为什么还要尝试删除*9*？如果*11 * 11 = 121*大于*100* ， 为什么要尝试删除*11*？*为什么要尝试从2*中 删除任何奇数？*为什么要尝试删除任何大于2*的 偶数呢？

 *****消除死测试，你会得到一个好的代码，测试*低于 100*的素数。

而且您的代码远非有史以来最糟糕的代码。许多*其他*人会尝试将*100*除以*99*。但是绝对冠军会生成`2..96`with的所有产品`2..96`来测试*97*是否在其中。[那个](https://stackoverflow.com/questions/10639861/python-prime-generator-in-one-line)效率低得惊人。

[*Eratosthenes*](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)的筛子当然要好得多，你可以有一个 - 低于*100* -[*没有布尔数组（也没有除法！）*](https://stackoverflow.com/a/9435507/849891)：

```
console.log(2)
var m3 = 9, m5 = 25, m7 = 49, i = 3
for( ; i < 100; i += 2 )
{
    if( i != m3 && i != m5 && i != m7) console.log(i)
    else
    {
        if( i == m3 ) m3 += 6
        if( i == m5 ) m5 += 10
        if( i == m7 ) m7 += 14
    }
} "DONE" 
```

* * *

这是 Eratosthenes 的筛子，如果我们跳过复合材料 - 这就是这段代码正在做的事情。合成和跳过它们的时间（通过检查*相等性*）混合到一个时间线中。通常的筛子首先生成复合物并将它们标记在一个数组中，然后扫描该数组。在这里，这两个阶段被合并为一个，以避免使用任何数组（这仅是因为我们提前知道上限的平方根 - *10 - 并且只使用低于它的素数，即**3,5,7* - *2*的倍数，即偶数，提前隐式跳过）。

换句话说，这是对 Eratosthenes的*增量*筛选，并且 ,`m3`形成素数*3、5*和*7*的倍数的隐式优先级*队列*。`m5``m7`

 **** * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-09-20T23:43:20.343

这是一个使用 JS 生成器的高效、简短的解决方案。[JSfiddle](https://jsfiddle.net/95zvutyk/)

```
// Consecutive integers
let nats = function* (n) {
    while (true) yield n++
}

// Wrapper generator
let primes = function* () {
    yield* sieve(primes(), nats(2))
}

// The sieve itself; only tests primes up to sqrt(n)
let sieve = function* (pg, ng) {
    yield ng.next().value;
    let n, p = pg.next().value;
    while ((n = ng.next().value) < p * p) yield n;
    yield* sieve(pg, (function* () {
        while (n = ng.next().value) if (n % p) yield n
    })())
}

// Longest prefix of stream where some predicate holds
let take = function* (vs, fn) {
    let nx;
    while (!(nx = vs.next()).done && fn(nx.value)) yield nx.value
}

document.querySelectorAll('dd')[0].textContent =

// Primes smaller than 100
    [...take(primes(), x => x < 100)].join(', ')
```

```
<dl>
<dt>Primes under 100</dt>
<dd></dd>
</dl>
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-07-10T10:36:27.433

我正在寻找如何找出素数并浏览了上面太长的代码。我为素数找到了一个新的简单解决方案，并使用过滤器添加它们。如果我的代码有任何错误，请建议我，因为我是初学者。

```
function sumPrimes(num) {

let newNum = [];

for(let i = 2; i <= num; i++) {
newNum.push(i)
}
for(let i in newNum) {

newNum = newNum.filter(item => item == newNum[i] || item % newNum[i] !== 0)
}

return newNum.reduce((a,b) => a+b)
}

sumPrimes(10); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-05-03T09:48:15.010

您可以将其用于任何大小的素数数组。希望这可以帮助

```
 function prime() {
   var num = 2;

   var body = document.getElementById("solution");

   var len = arguments.length;
   var flag = true;

   for (j = 0; j < len; j++) {

     for (i = num; i < arguments[j]; i++) {

       if (arguments[j] % i == 0) {
         body.innerHTML += arguments[j] + " False <br />";
         flag = false;
         break;

       } else {
         flag = true;

       }

     }
     if (flag) {
       body.innerHTML += arguments[j] + " True <br />";

     }

   }

 }

 var data = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

 prime.apply(null, data);
```

```
<div id="solution">

</div>
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-09-11T14:44:17.010

```
public static void main(String[] args) {
    int m = 100;
    int a[] =new int[m];
    for (int i=2; i<m; i++)
        for (int j=0; j<m; j+=i)
            a[j]++;
    for (int i=0; i<m; i++)
        if (a[i]==1) System.out.println(i);
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-10-12T20:05:47.910

使用 Eratosthenes 筛，[Rosettacode 上的源代码](https://rosettacode.org/wiki/Sieve_of_Eratosthenes#JavaScript)

最快的解决方案：[https ://repl.it/@caub/getPrimes-bench](https://repl.it/@caub/getPrimes-bench)

```
function getPrimes(limit) {
    if (limit < 2) return [];
    var sqrtlmt = limit**.5 - 2;
    var nums = Array.from({length: limit-1}, (_,i)=>i+2);
    for (var i = 0; i <= sqrtlmt; i++) {
        var p = nums[i]
        if (p) {
            for (var j = p * p - 2; j < nums.length; j += p)
                nums[j] = 0;
        }
    }
    return nums.filter(x => x); // return non 0 values
}
document.body.innerHTML = `<pre style="white-space:pre-wrap">${getPrimes(100).join(', ')}</pre>`;

// for fun, this fantasist regexp way (very inefficient):
// Array.from({length:101}, (_,i)=>i).filter(n => n>1&&!/^(oo+)\1+$/.test('o'.repeat(n))
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-02-16T05:09:40.087

没有任何循环的版本。对您拥有的任何阵列使用它。IE。，

```
[1,2,3...100].filter(x=>isPrime(x));
const isPrime = n => {
if(n===1){
return false;
}
if([2,3,5,7].includes(n)){
return true;
}
return n%2!=0 && n%3!=0 && n%5!=0 && n%7!=0;
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-04-28T19:05:30.993

以下是找到 n 以内的素数的`Brute-force iterative`方法和方法。`Sieve of Eratosthenes`就时间复杂度而言，第二种方法的性能优于第一种

**暴力迭代**

```
function findPrime(n) {
  var res = [2],
      isNotPrime;

  for (var i = 3; i < n; i++) {
    isNotPrime = res.some(checkDivisorExist);
    if ( !isNotPrime ) {
      res.push(i);
    }
  }

  function checkDivisorExist (j) {
    return i % j === 0;
  }

  return res;
} 
```

**埃拉托色尼筛法**

```
function seiveOfErasthones (n) {
  var listOfNum =range(n),
      i = 2;

  // CHeck only until the square of the prime is less than number
  while (i*i < n && i < n) {
    listOfNum = filterMultiples(listOfNum, i);
    i++;
  }

  return listOfNum;

  function range (num) {
    var res = [];
    for (var i = 2; i <= num; i++) {
      res.push(i);
    }
    return res;
  }

  function filterMultiples (list, x) {
    return list.filter(function (item) {
      // Include numbers smaller than x as they are already prime
      return (item <= x) || (item > x && item % x !== 0);
    });
  }
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-08-15T09:05:23.447

首先，将您的内部代码更改为另一个循环 ( `for`and `while`)，以便您可以针对不同的值重复相同的代码。

对于您的问题更具体，如果您想知道给定`n`是否为素数，则需要将其划分为 2 和 sqrt(n) 之间的所有值。如果任何模块为 0，则它不是素数。

如果你想找到所有的素数，你可以加速它并`n`只通过除以先前找到的素数来检查。加速这个过程的另一种方法是，除了 2 和 3，所有素数都是`6*k`正或小于 1。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2012-09-05T18:12:53.967

如果您要使用将在此线程中介绍的任何海量算法，那么您应该学习记住其中的一些算法。

请参阅[面试问题：递归生成素数的最快方法是什么？](https://stackoverflow.com/questions/4551731/interview-question-what-is-the-fastest-way-to-generate-prime-number-recursivel)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-03-04T14:51:16.643

这是我的[解决方案](http://jsfiddle.net/ka8ypt5v/)

```
//find all prime numbers
function showMePrimeNumbers(start, end){
    var primes = [];
    for(var number = start; number < end; number++){
        var primeNumberDividers = []; //there should only be 2: 1 & number
        for(var divider = 1; divider <= number; divider++){
            if(number % divider === 0){
                primeNumberDividers.push(divider);
            }      
        }
        if(primeNumberDividers.length === 2){
            primes.push(number);
        }
    }
    return primes;
}

console.log(showMePrimeNumbers(1, 100)); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-08-28T18:33:34.560

我为那些不想使用提示方法而只想看到程序打印素数的人修改了 Rinto 的答案。它的工作

```
for (n = 0; n < 100; n++) {
    var x = 1;
    if (n == 0 || n == 1) x = 0;
    for (i = 2; i < n; i++) {
        if (n % i == 0) {
            x = 0;
            break;
        }
    }
    if (x == 1) {
        // if prime print the numbers 
        document.write(n);
    } else {
        // if not prime print the number do nothing 
    }
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2012-09-06T17:36:14.857

使用以下函数找出素数：

```
function primeNumbers() {
    var p
    var n = document.primeForm.primeText.value
    var d
    var x
    var prime
    var displayAll = 2 + " "
    for (p = 3; p <= n; p = p + 2) {
        x = Math.sqrt(p)
        prime = 1
        for (d = 3; prime && (d <= x); d = d + 2)
        if ((p % d) == 0) prime = 0
        else prime = 1
        if (prime == 1) {
            displayAll = displayAll + p + " "
        }
    }
    document.primeForm.primeArea.value = displayAll
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2014-02-15T09:51:29.380

用JS函数检查数字是否为素数

```
function isPrime(num)
        {
            var flag = true;
            for(var i=2; i<=Math.ceil(num/2); i++)
            {
                if((num%i)==0)
                {
                    flag = false;
                    break;
                }
            }
            return flag;    
        } 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2015-02-05T01:07:37.713

这样的事情怎么样。

```
next_prime:
for (var i = 2; i < 100; i++){
    for (var e = 2; e < i; e++){
        if (i % e === 0) continue next_prime;
    }
    console.log(i + '<br>');
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-08-12T20:11:29.347

这是一种测试数字是否为素数的方法。

```
function isPrime(numb){
  if (numb % 2 == 0) return false;
  for (var i=3; i<= Math.sqrt(numb); i = i + 2) {
    if (numb % i == 0) {
     return false;
    }
  }
  return true;
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2015-12-30T14:47:34.027

我创建了一个 JSFiddle，展示了它应该如何以可读的方式工作，

想法是有两个函数 isPrime 和 getPrimeNumbers 来分离功能，以及使用 Math.pow 和初始值 2，因为它应该始终存在，请参阅 jsfiddle 附加的[jsFiddle](https://jsfiddle.net/py68qhq5/6/)

```
window.onload = function() {
  (function() {
    var cont = document.getElementById('MainContainer');
    var curEl = document.createElement('span');
    var primeNumbers = [2];

    function fillContent() {
        var primeNumbersContent = document.createTextNode(JSON.stringify(primeNumbers));
        curEl.appendChild(primeNumbersContent);
        cont.appendChild(curEl);
    }

    function isPrime(n) {
        var divisor = 2;
        while (n > divisor) {
            if (Math.pow(divisor, 2) > n) {
                return true;
            }
            if (n % divisor == 0 || Math.sqrt(divisor) > n) {
                return false;
            } else {
                divisor++;
            }
        }
        return true;
    }

    function getPrimeNumbers(range) {
        for (var i = 3; i <= range; i+=2) {
            if (isPrime(i)) {
                primeNumbers.push(i);
            }
        }
        fillContent(primeNumbers);
    }
    getPrimeNumbers(11);
  })();
}; 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2016-01-19T10:01:10.393

这是我使用埃拉托色尼筛法的解决方案：

```
function gimmePrimes(num) {
  numArray = [];
  // first generate array of numbers [2,3,...num]
  for (i = 2; i <= num; ++i) {
    numArray.push(i);
  }

  for (i = 0; i < numArray.length; ++i) {
    //this for loop helps to go through each element of array

    for (j = numArray[i]; j < numArray[numArray.length - 1]; ++j) {
      //get's the value of i'th element
      for (k = 2; j * k <= numArray[numArray.length - 1]; ++k) {
        //find the index of multiples of ith element in the array
        index = numArray.indexOf(j * k);
        if (index > -1) { //remove the multiples
          numArray.splice(index, 1);
        }
      }

    }
  }
  return numArray; //return result
}
gimmePrimes(100); 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2020-05-31T16:05:54.720

```
function isPrime(num) {
  for(var i = 2; i < num; i++)
    if(num % i === 0) return false;
  return num ;
}
function primes(n){
  var array_of_primes=[];
for(var i = 2; i < n; i++){
    if(isPrime(i)) array_of_primes.push(i)>1;
     }
   return array_of_primes;
}
document.write(primes(10000)); 
```

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2013-07-19T05:06:16.500

```
<html>
<head>
<script type="text/javascript">
function primeNumber() {
 x=document.getElementById('txt_field').value;
  for (i=1; i<=parseInt(x); i++) {
  var flag=0,flag1=0; 
    for (j=2; j<i; j++) {
      if(i%j==0){
       flag=1;
      if(i==x)
       flag1=1;
      }
    }
   if(flag==0)
    document.write(i+'<br>');
  }
   if(flag1==0) 
    document.write('Its a prime number.');
   else 
    document.write('Its not a prime number.');
}
</script>
</head>

<body>
 <input id="txt_field" type="text" name="field" />
 <input type="button" name="submit" value="Submit" onclick="primeNumber();" />
</body>
</html> 
```

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2014-11-19T14:04:07.027

有人试过这个吗？它简单高效...

```
function Prime(num) {
  if (num <= 2)return false;
  for(var i = 2; i < num; i++){
    if (num % i == 0) return false;
  }
  return true;
}

function PrimeWithin(userinput){
  for(var i = 2; i < userinput; i++){
    if(Prime(i)){
        console.log(i);
    }
  }
}

PrimeWithin(500); 
```**********

# android - 在印度创建开发者帐户的问题

> ID：11966521
> 
> 赞同：11
> 
> 时间：2012-08-15T08:57:49.260
> 
> 标签：android, account

我是来自印度的开发人员。我完成了一个应用程序开发，我想发布它，但是当我尝试创建谷歌开发者帐户时，令我惊讶的是，在创建钱包帐户时，印度并没有出现在国家下拉列表中。我继续选择美国，在询问卡号时，我正确提供了我的借记卡号（不带空格）、CVV 号和地址，但它说卡无效，但卡可以使用，我仍然尝试了另一张卡，同样的问题。我无法创建开发者帐户。有印度人遇到过这个问题吗？可能是由于货币。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-07T06:46:26.100

我在这个讨论中迟到了，但对于新人来说，我最近从印度注册了 Google Play 帐户，在尝试了几乎所有类型的卡后我发现了这一点，几乎所有印度信用卡都可以注册 Google Play 帐户。但是对于借记卡，只有 ICICI 为我工作。休息 IDBI 银行、巴罗达银行、Karur Vyasa 银行、印度联合银行没有工作。希望它能帮助一些在注册 android 开发者帐户时遇到问题的新印度开发者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-06T11:10:19.983

现在回答已经很晚了，但人们总是在寻找解决方案，所以对于那些仍然找不到路的人来说。谷歌钱包显示卡无效的错误消息是因为

1.Goolge钱包使用国际付费服务创建开发者账号。

2.您的卡应该支持国际支付交易（大多数新卡在印度不支持）。

**解决方案：**

***联系相关银行，要求他们为国际交易扩展卡服务***

[注意：（这是指添加借记卡）即使卡上说它具有国际或全球访问权限，您也需要从各个银行的客户服务中心激活此服务]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-23T15:53:51.420

*大多数印度借记卡还不支持使用贝宝和谷歌钱包！但有些借记卡可以！目前在印度支持信用卡和借记卡的贝宝和谷歌钱包服务的两家银行是 AXIS 银行和 ICICI 银行！HDFC 银行和印度联合银行（UBI）仅在他们发行的信用卡上支持这些设施。所有其他银行目前不支持此功能。因此，我建议用户为此交易在 AXIS 银行或 ICICI 银行创建一个帐户。*

# git - git svn clone 结果为空目录

> ID：11966525
> 
> 赞同：46
> 
> 时间：2012-08-15T08:58:15.510
> 
> 标签：git, svn

我有一个项目结构的 svn 存储库：

```
/root/projectA/trunk
/root/projectA/branches
/root/projectA/tags

/root/projectB/trunk
/root/projectB/branches
/root/projectB/tags 
```

我想克隆项目A。当我运行时：

```
git svn clone -r <revision number>:HEAD <url>/root/projectA 
```

我没有收到任何错误，并且在新的 projectA 目录下创建了一个 git 存储库。但是目录是空的。我错过了什么吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2015-09-11T17:44:12.593

我的问题是使用`-s`or`--stdlayout`因为我的 svn repo 没有标准布局（主干、分支、标签）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-16T15:03:06.377

下面的命令完成了这项工作：

```
 git svn clone -r HEAD <url>/root/projectA 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-03-22T19:17:05.677

对于包括该`authors-file`选项的任何人，如果在提供的作者文件中遇到没有查找值的作者，`git svn clone`它将**完全停止。**如果您不注意，git 的“警报”可能看起来就像 repo 已经完成克隆，并且没有说明该过程未完成。除了 .git 之外，repo 的目录将是空的。

如果您添加缺少的作者，然后重新运行**确切的**命令，git 将继续它停止的地方。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-04T14:27:42.677

我遇到了同样的问题，并通过使用 --no-metadata 参数解决了。在你的情况下，这相当于

```
git svn clone -r <revision number>:HEAD <url>/root/projectA --no-metadata 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-05T10:35:53.080

如果您使用 HTTP 或 HTTPS 传输（即您的存储库 URL 以 HTTP[s] 开头），您需要提供有效的**SVN**用户名。

```
git svn clone -s https://svn.example.com/root/projectA --username <SVN username> 
```

*-s 是 --stdlayout 的别名*

但是，我只需要指定一次 --username 选项，随后的调用就可以在没有它的情况下工作。我猜它缓存了用户名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-07T12:23:38.517

有一个类似的问题，在目录中执行 'git reset --hard HEAD' 似乎会创建文件。

.git/objects 非常大，所以我猜这些文件是从 svn 导入到 git 中的，它们只是没有被检出，或者其他什么。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-04T02:30:49.247

就我而言，克隆操作没有正确完成。`git svn clone`在结帐过程中会失败。一旦我解决了这个问题，它会在克隆操作后自动进行结帐——不再有空文件夹。

[更新]以下是我的情况：

尝试`git svn clone --preserve-empty-dirs <repo>`对我来说失败了。在网上搜索后，我找到了[https://www.semitwist.com/articles/article/view/the-better-svn-git-guide](https://www.semitwist.com/articles/article/view/the-better-svn-git-guide)，其中部分内容是：

> 这部分有点烦人。从 v1.7.7 开始，Git 有一个 --preserve-empty-dirs。问题是，这该死的东西坏了。如果您尝试按原样使用它，整个操作可能会在中途失败。它必须被修复。
> 
> 首先，找到你的 git-svn 文件：
> 
> $ 查找 /2> /dev/null | grep git-svn
> 
> $ 查找 2>/dev/null / -type f | grep -l "剥离失败"
> 
> 对我来说，它位于 /usr/libexec/git-core/git-svn。

注意：它不再存在于 git-svn 中（至少不在 git 2.7.0 中）。我在`/usr/lib/perl5/vendor_perl/5.22/Git/SVN/Fetcher.pm`.

在您喜欢的编辑器中打开目标文件：

`sudo <your-favorite-editor> path/to/file`

> 现在，在这个 git-svn 文件中，搜索`die "Failed to strip path`. （[取决于您的 git 版本，] 它 [可能] 位于第 4583 行附近。更改`die`为`print`并保存。您的 git-svn 现在已修复。

`git svn clone --preserve-empty-dirs <repo>`现在应该按预期运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-15T09:12:20.107

我无法检查这是否有效，但请尝试：

```
git svn clone --stdlayout <url>/root/projectA/ 
```

# apache-flex - 弹性警报中的文本和图标位置

> ID：11966529
> 
> 赞同：0
> 
> 时间：2012-08-15T08:58:36.637
> 
> 标签：apache-flex, flex3, styles, alert

如何更改 flex 警报中文本和图标的位置？它位于警报框的顶部，但应该水平居中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T06:08:17.323

试试这个`mx|Alert { vertical-align:middle; text-align:center; }`

# ruby-on-rails - Ruby on rails 中的 AND OR 过滤器

> ID：11966535
> 
> 赞同：1
> 
> 时间：2012-08-15T08:58:55.557
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, garb-gem

我有一个问题：如何在过滤器参数中编写 2 个条件？`:page_path.eql => "/teams/1" or :page_path.eql => 'teams/2'`

它适用于一种情况，但不适用于两种情况:(

```
output = Exits.results(profile, :filters => {:page_path.eql => "/teams/1"}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:25:04.997

尝试这个

```
output = Exits.results(profile,:filters =>{:page_path.contains => "^/teams/[1|2]$"}) 
```

你也可以试试速记

```
output = profile.exits(:filters =>{:page_path.contains => "^/teams/[1|2]$"}) 
```

带日期选项

```
output = Exits.results(profile, :filters => {:page_path.contains => "^/teams/[1|2]$"},:start_date => Date.new(2012,8,13),:end_date => Date.today) 
```

或者

```
output = profile.exits(:filters => {:page_path.contains => "^/teams/[1|2]$"},:start_date => Date.new(2012,8,13),:end_date => Date.today) 
```

这对我有用

使用`contains`而不是`matches`我认为它不理解正则表达式。

# android - Sencha Touch 2 - 加载视图后如何运行函数？

> ID：11966536
> 
> 赞同：1
> 
> 时间：2012-08-15T08:59:00.190
> 
> 标签：android, jquery, mobile, touch, extjs

我在 Sencha Touch 中有一个视图，我通过初始化函数填充了该视图。这是代码：

```
Ext.define("Pycsell.view.Home", {
    extend: "Ext.form.Panel",
    requires: "Ext.form.FieldSet",
    alias: "widget.homepage",
    config:{
        scrollable: false,
        cls: 'splash_screen',
        layout: 'vbox'
    },

    initialize: function () {
        this.callParent(arguments);

        var fb_login = {
            xtype: 'button',
            cls: 'fb_login_button'
        };

        var tradreg = {
            xtype: 'button',
            cls: 'tradreg_button'
        };

        var tradlog = {
            xtype: 'button',
            cls: 'tradlog_button'
        };

        var logo_container = Ext.create('Ext.Panel', {
            cls: 'logo_container',
            width: '90%',
            flex: 4,
        });

        var button_container = Ext.create('Ext.Panel', {
            cls: 'splash_content',
            items: [fb_login, tradreg, tradlog],
            flex: 2,
        });

        this.add([
            logo_container,
            button_container
        ]);
        this.setButtonSizes();

    },//End init

    setButtonSizes: function() {
        console.log('Width is:' + $('.fb_login_button').width());
        console.log('Old height is:' + $('.fb_login_button').height());
        var height = $('.fb_login_button').width()*0.29;
        $('.fb_login_button').height(height);
        console.log('New height is:' + $('.fb_login_button').height());
    }
}); 
```

现在，setButtonSizes 函数确实触发了，但是所有的值都是空的，这让我相信这些项目在它被调用时实际上并没有被初始化。我将如何正确执行此操作以便实际设置值？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:13:52.230

众所周知，这可能是非常棘手的。问题是您的函数可能在组件渲染之前被调用。我还没有对 Sencha Touch 2 做过任何工作，但看起来使用绘制事件应该会有所帮助。像这样的东西：

```
Ext.define("Pycsell.view.Home", {
 extend: "Ext.form.Panel",
 requires: "Ext.form.FieldSet",
 alias: "widget.homepage",
 config:{
     scrollable: false,
     cls: 'splash_screen',
     layout: 'vbox'
 },
  initialize: function () {
     this.callParent(arguments);
      var fb_login = {
         xtype: 'button',
         cls: 'fb_login_button'
     };
      var tradreg = {
         xtype: 'button',
         cls: 'tradreg_button'
     };
      var tradlog = {
         xtype: 'button',
         cls: 'tradlog_button'
     };
      var logo_container = Ext.create('Ext.Panel', {
         cls: 'logo_container',
         width: '90%',
         flex: 4,
     });
      var button_container = Ext.create('Ext.Panel', {
         cls: 'splash_content',
         items: [fb_login, tradreg, tradlog],
         flex: 2,
     });
       this.add([
         logo_container,
         button_container
     ]);
     /* Attaches a listener to the component that will be fired after the
     component is rendered or shown. */
     this.on('painted', this.setButtonSizes);
  },//End init
  setButtonSizes: function() {
     console.log('Width is:' + $('.fb_login_button').width());
     console.log('Old height is:' + $('.fb_login_button').height());
     var height = $('.fb_login_button').width()*0.29;      
     $('.fb_login_button').height(height);
     console.log('New height is:' + $('.fb_login_button').height());
 }
}); 
```

根据您要完成的任务，这可能会触发事件太多次（看起来每次显示组件时都会触发）。所以你可能需要调整 setButtonSizes 来补偿。

# c# - 如何为自跟踪类编写数据库“保存”方法？

> ID：11966537
> 
> 赞同：0
> 
> 时间：2012-08-15T08:59:09.633
> 
> 标签：c#

为了问这个问题，让我写一个包含我的问题的类。

```
class Student{

public int StudentId;
public string Name;
public int Age;
public string Address;

public void Save(){
   if (StudentId == 0){
   //// run the insert query here
/*
Insert into Student(Studentid,Name,Age,Address)values(...);
} else {
/// run the update query...
/*Update Student Set Address = @address , Age = @age , Name = @name
where StudentId = @stdid;*/
}
} 
```

现在为了使用该类，我将编写以下代码。

```
Student Std = new Student{StudentId = 1, Name="xyz", Address = "Home"};

Std.Save(); //// this will insert the value in the database 
```

现在以后。

```
Student std1 = new Student();

std1.Studentid = 1;
std1.Age= 10;
std1.Save(); 
```

现在调用 save 这次将用 Null 或空字符串覆盖地址。

我寻求有关此问题的可能解决方案的建议。

消费者有可能希望用空字符串更改地址。

期待回复。

问候

ķ

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:02:10.850

您正在做的是实例化一个*新* `Student`对象，并简单地为其分配新值。由于您从不分配地址，因此它将是`null`.

您的插入/更新逻辑是有缺陷的，因为它*假定*具有一个`0`ID 意味着值已经被持久化（可能是也可能不是这种情况 - 您的类设计确实允许创建一个`Student`不持久的并给出它是任何旧 ID）。结果是您将值保存到数据库中，包括`null`地址。

你的逻辑应该是：

*   如果学生 ID 不为 0：
    *   开始交易
    *   从 DB 获取学生详细信息
    *   使用新的详细信息更新学生对象
    *   节省
    *   提交交易

您还应该重组您的`Student`类，以便`Id`不能简单地写入（可能只是在构造函数中）并且有办法`Student`从您的数据库加载 a 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:06:36.410

没有任何神奇的方法可以用于它......您只需检查`null`并决定是否在某个时候覆盖。

您可以使用一些 ORM 框架，例如 NHibernate 或 Entity Framework，如果您有兴趣，它们会自动完成这样的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:03:52.910

我认为你应该以不同的方式设置你的结构。

现在，您正在创建一个新`Student`对象，用（仅）更改的数据填充它，并尝试通过`Studentid`.

我认为您还应该创建一个（静态）方法，例如`GetStudentById(int id)`. 让它从填充了所有属性的数据库中返回学生，进行更改并使用`Save()`. 现在这些值不会为空或重置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T09:04:52.763

与管理代码中的默认值*不同*，在一段时间内可能会发生很多变化，而是更容易管理默认值设置`DB`。只需将相应`DB`字段*默认值*的字段设置为您需要的值，并停止在代码中携带它。当然，如果您*有权*访问数据库结构并允许更改它。

如果您**不想**重置新对象中的值（从您的帖子中不是很清楚），只需使用`Clone(..)`您类型的（比如说）方法`Student`，然后只更改字段。

例子：

```
Student std= new Student{StudentId = 1, Name="xyz", Address = "Home"};
Std.Save();

//after 

Student std1 = std.Clone(); //after clone you have Adrress field too in std1    
std1.Studentid = 1;
std1.Age= 10;
std1.Save(); 
```

# android - 我在 PopupMenu 中使用 ShareActionProvider，但显示两个 PopupMenu？

> ID：11966542
> 
> 赞同：6
> 
> 时间：2012-08-15T08:59:33.770
> 
> 标签：android, popupmenu, shareactionprovider

我在 PopupMenu 中使用 ShareActionProvider，但是当我单击共享菜单项时，它会在屏幕上显示两个 PopupMenus，一个被另一个覆盖。一个显示应用程序图标和名称，另一个只显示应用程序名称。

除了这个问题，它工作正常......我该
如何解决它？

PS：请原谅我表达的不好

我的代码是：

```
PopupMenu popup = new PopupMenu(this, button);
popup.getMenuInflater().inflate(R.menu.scrawl_popup_menu, popup.getMenu());
MenuItem overflowItem = popup.getMenu().findItem(R.id.popup_share);
ShareActionProvider overflowProvider =
    (ShareActionProvider) overflowItem.getActionProvider();
overflowProvider.setShareHistoryFileName(
    ShareActionProvider.DEFAULT_SHARE_HISTORY_FILE_NAME);
overflowProvider.setShareIntent(createShareIntent()); 
```

menu.xml 是：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/popup_clear"
        android:icon="@drawable/ic_menu_clear"
        android:title="@string/popup_menu_clear" />
    <item android:id="@+id/popup_insert_bg"
        android:icon="@drawable/ic_menu_insert_bg"
        android:title="@string/popup_menu_insert_bg"/>
    <item android:id="@+id/popup_share"
        android:icon="@android:drawable/ic_menu_share"
        android:title="@string/popup_menu_share"
        android:actionProviderClass="android.widget.ShareActionProvider">
    </item>
</menu> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-26T12:48:38.273

我不得不使用 startActivity(getShareIntent("/status.jpg")); 这并不完全符合您的预期。但是，它可以用于相同的目的。希望它有所帮助。

```
private Intent getShareIntent(String filePath) {
        Intent shareIntent = new Intent(Intent.ACTION_SEND);

        File sdCard = Environment.getExternalStorageDirectory();

        File sharedFile = new File(sdCard + sharePath);
        Uri uri = Uri.fromFile(sharedFile);

        shareIntent.setType("image/*");
        shareIntent.putExtra(Intent.EXTRA_STREAM, uri);
        return shareIntent;
    } 
```

但是，最后我改为使用带有选择模式的操作栏：http: [//developer.android.com/design/patterns/selection.html](http://developer.android.com/design/patterns/selection.html)

# node.js - NodeJS：错误：产生 EINVAL

> ID：11966544
> 
> 赞同：1
> 
> 时间：2012-08-15T08:59:35.250
> 
> 标签：node.js

**环境：**

> ```
> [root@etone46 backups]# uname -a
> Linux etone46 2.6.18-53.el5xen #1 SMP Wed Oct 10 16:48:44 EDT 2007 x86_64 x86_64 x86_64 GNU/Linux
> [root@etone46 backups]# node -v
> v0.8.6 
> ```

**代码是从节点文档复制的。**

```
var util  = require('util'),
    spawn = require('child_process').spawn,
        ls    = spawn('ls', ['-lh', '/usr']);

        ls.stdout.on('data', function (data) {
              console.log('stdout: ' + data);
        });

        ls.stderr.on('data', function (data) {
              console.log('stderr: ' + data);
        });

        ls.on('exit', function (code) {
              console.log('child process exited with code ' + code);
        }); 
```

**得到错误：**

> [root@etone46 备份]# 节点 1.js
> 
> ```
> child_process.js:790
>     throw errnoException(errno, 'spawn');
>           ^
> Error: spawn EINVAL
>     at errnoException (child_process.js:838:11)
>     at ChildProcess.spawn (child_process.js:790:11)
>     at exports.spawn (child_process.js:614:9)
>     at Object.<anonymous> (/opt/backups/1.js:3:14)
>     at Module._compile (module.js:449:26)
>     at Object.Module._extensions..js (module.js:467:10)
>     at Module.load (module.js:356:32)
>     at Function.Module._load (module.js:312:12)
>     at Module.runMain (module.js:492:10)
>     at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
> ```

# .net - 使用 MediaChase ECF G5 5.1 进行复杂的自定义促销

> ID：11966548
> 
> 赞同：2
> 
> 时间：2012-08-15T08:59:42.060
> 
> 标签：.net, e-commerce, episerver

我们正在尝试根据客户要求使用相当复杂的规则集为 ECF G5 创建自定义促销。它类似于：

*   非折扣价的最高商品
*   根据类别、子类别、细分市场和/或单个产品折扣（最具体获胜），根据特定查找表打折的其他项目
*   最高的项目可能有优惠券折扣应用

您将如何在 ECF G5 5.1 中构建它？我已经阅读了文档（[http://docs.mediachase.com/display/ecf51devguide/Custom+Promotion+Development+Explanation](http://docs.mediachase.com/display/ecf51devguide/Custom+Promotion+Development+Explanation)）并且我有几个问题：

1.  按购物车促销会影响单个订单项还是必须在整个购物车上运行？在我们的案例中，我们需要根据整个购物车来决定该商品是否是最昂贵的商品
2.  是否有一种简单的 G5 方法可以在购物车中获得“最昂贵”的产品？
3.  如何控制哪些产品符合优惠券资格？

不是在寻找“最干净”或最符合架构的解决方案，只是想完成它！如果您有任何快速指示，将不胜感激。

我们正在使用 .NET 3.5 框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T10:53:45.497

Mediachase ECF 可以升级到 EPiServer Commerce，在此处查看更多信息 - [http://www.episerver.com/About-Us/Press-Room/Press-Releases/EPiServer-Acquires-Business-of-e-Commerce-Solution -Provider-Mediachase-/](http://www.episerver.com/About-Us/Press-Room/Press-Releases/EPiServer-Acquires-Business-of-e-Commerce-Solution-Provider-Mediachase-/) 您可以在此处了解有关该产品最新版本的更多信息 - [http://www.episerver.com/Commerce/](http://www.episerver.com/Commerce/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T05:56:56.050

以上都是可能的。最好的起点是使用现有的促销活动之一。我会给出快速的指示，因为正如评论中提到的那样，完整的解决方案将涉及大量的开发和测试。所以这里是指针：

1.  是的，它可以，当您调用 AssignReward 时，其中一个参数是受影响的条目，在您的情况下，它可能只是一个特定的条目。
2.  添加另一个使用 linq 获取最高价格项目并将其保存到常量的规则。
3.  您可以为一个项目定义一个自定义属性，然后使用它来过滤它是否有资格获得折扣。

PS：我实际上是在 ECF 中编写促销引擎的人，但是我不再与公司相关联，并且建议使用一个名为 VirtoCommerce ( [http://virtocommerce.com](http://virtocommerce.com) ) 的新框架。开源，更直观的营销引擎，轻松从ECF或EPiServer升级。

**更正：**

*   直到 2011 年开发 ECF 的工程师团队不再在公司工作

*   我是 ECF 的合法创建者，并且在 2011 年之前一直是一名建筑师

# android - Android 操作栏 - 选项卡

> ID：11966550
> 
> 赞同：0
> 
> 时间：2012-08-15T08:59:57.340
> 
> 标签：android, android-actionbar

这个“动作栏”怎么做？正是我的意思是[http://i48.tinypic.com/2s667hs.png](http://i48.tinypic.com/2s667hs.png)这样的事情。它可以适合Android 2.3吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:03:32.373

操作栏仅 3.0+。除非您使用第三方代码，例如 ActionBarSherlock。

要在 android 上进行本机操作，我建议您阅读有关操作栏的开发人员指南帖子。[http://developer.android.com/guide/topics/ui/actionbar.html](http://developer.android.com/guide/topics/ui/actionbar.html)

# jquery - QTip2 ajax弹出窗口不起作用

> ID：11966552
> 
> 赞同：1
> 
> 时间：2012-08-15T09:00:07.347
> 
> 标签：jquery, ajax, qtip2

我正在尝试通过 ajax 显示 qtip 弹出窗口，但没有成功。我得到了以下代码，但似乎无法检测到哪里出了问题。帮助将不胜感激。

```
<script type="text/javascript">
$(document).ready(function()
{
    $('.tiplink').qtip({
        content:{
            var id = $(this).attr('rel');
            text: '<img class="" src="../images/loader.gif" alt="Loading..." />',
            ajax:{
                url: 'pops.php',
                type: 'POST', 
                loading: false,
                data: 'id=' + id
            }
        },

        show: 'mouseover', // Show it on mouseover
        hide: {
            delay: 200,
            fixed: true // We'll let the user interact with it
        },
        style: {
            classes: 'ui-tooltip-light ui-tooltip-shadow',
            width: 290 
        }
    });

});
</script>

<a href="#" class="tiplink" rel='1'>show me the popup1!</a>
<a href="#" class="tiplink" rel='2'>show me the popup2!</a>
<a href="#" class="tiplink" rel='3'>show me the popup3!</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T15:47:27.127

我有类似的问题；这似乎与**$('.myclass').qtip({})**不能引用多个元素的事实有关。如果确实如此（例如您的示例），您需要将 qtip() 调用包装在**each(function())**块中...

关于您的示例，以下内容应该可以解决您的问题：

```
$(document).ready(function()
{
  // the each() call I was explaining above this code example
  $('.tiplink').each(function(){

    // Extract your variables here:
    var $this = $(this);
    var id = $this.attr('rel');

    // Now make your qtip() call
    $this.qtip({
      content:{
        text: '<img class="" src="../images/loader.gif" alt="Loading..." />',
        ajax:{
          url: 'pops.php',
          type: 'POST', 
          loading: false,
          data: 'id=' + id
        }
      },
      show: 'mouseover', // Show it on mouseover
      hide: {
        delay: 200,
        fixed: true // We'll let the user interact with it
      },
      style: {
        classes: 'ui-tooltip-light ui-tooltip-shadow',
        width: 290 
      }
    });
  }); // end each(function()) call
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:21:32.233

有一些问题可能对您有所 [帮助](https://stackoverflow.com/questions/2950004/how-to-use-jquery-qtip-simple-example-please)

以及 qtip 网站上的教程 [本身](http://craigsworks.com/projects/qtip/docs/tutorials/)

如果您按照书面规定做所有事情，我看不出任何其他原因它不应该工作

# php - 无需客户端登录的 Google Analytics Core Reporting API 3.0 版

> ID：11966554
> 
> 赞同：7
> 
> 时间：2012-08-15T09:00:19.743
> 
> 标签：php, google-analytics, google-analytics-api

我想使用更新的 v3.0 访问我们的 Google Analytics 帐户报告，但从我阅读的所有内容看来，为了获得用户必须登录的有效访问令牌。

我们希望直接访问我们自己的帐户报告，而不是根据客户的帐户访问客户的报告。我们如何在 PHP 中完成此操作，而无需将浏览器发送到 Google 登录页面？v3.0 没有直接的 API 身份验证吗？

**编辑**

这似乎是在没有最终用户交互的情况下访问 API 的唯一方法，他们称之为“服务器到服务器”：

[https://developers.google.com/accounts/docs/OAuth2ServiceAccount](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)

**编辑 2**

好像做不到？;(

> **警告：**目前很少有 Google API 支持服务帐户。以下 Google 开发者服务目前支持服务帐号：
> 
> *   谷歌云存储
> *   谷歌预测 API
> *   谷歌网址缩短器
> *   谷歌 OAuth 2.0 授权服务器

**编辑 3**

毕竟似乎有一个解决方案，因为我登录一次，然后使用“刷新令牌”来继续获得访问权限，而无需额外的用户登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T03:08:05.607

我确实最终使用了刷新令牌，它们工作正常。我通过使用 google api 控制台获得了一个 oauth 令牌，然后将其保存。

然后我只是在每个请求之前这样做：

```
require_once 'google-api-php-client/src/apiClient.php';
require_once 'google-api-php-client/src/contrib/apiAnalyticsService.php';;

$client = new apiClient();
$client->setApplicationName('My Analytics');
$client->setClientId($this->client_id);
$client->setClientSecret($this->client_secret);
$client->setDeveloperKey($this->api_key);

$client->setScopes(array('https://www.googleapis.com/auth/analytics.readonly'));

$client->refreshToken($this->refresh_token);

$this->service = new apiAnalyticsService($client); 
```

# freebsd - sbwait 进程状态在 FreeBSD 顶部意味着什么？

> ID：11966559
> 
> 赞同：6
> 
> 时间：2012-08-15T09:00:36.013
> 
> 标签：freebsd

在 FreeBSD 系统上，在下面的顶部输出中，mysql 守护进程处于“sbwait”状态。这意味着什么？

```
last pid: 12833;  load averages:  0.18,  0.26,  0.25    up 3+17:40:21  04:58:46
26 processes:  1 running, 25 sleeping
CPU: 16.5% user,  0.0% nice, 12.8% system,  6.8% interrupt, 63.9% idle
Mem: 184M Active, 137M Inact, 88M Wired, 6308K Cache, 53M Buf, 7192K Free
Swap: 4096M Total, 420K Used, 4095M Free

  PID USERNAME  THR PRI NICE   SIZE    RES STATE    TIME   WCPU COMMAND
 1772 mysql      17  30    0   224M   165M sbwait 511:31 14.79% mysqld
12833 root        1  20    0  9944K  1488K RUN      0:00  0.10% top
 1472 root        1  20    0  9612K   828K select   5:07  0.00% powerd
 1465 root        1  20    0 11296K  1644K select   2:01  0.00% ntpd
 1804 root        1  20    0 11324K  2140K select   0:37  0.00% sendmail
 1403 root        1  20    0 12200K  2320K select   0:27  0.00% nmbd
 1814 root        1  20    0  9644K  1004K nanslp   0:08  0.00% cron
 1407 root        1  20    0 20756K  3756K select   0:06  0.00% smbd
 1273 root        1  20    0  9612K  1036K select   0:04  0.00% syslogd
11937 root        1  20    0 15788K  3124K select   0:03  0.00% sshd
 1808 smmsp       1  20    0 11324K  1864K pause    0:01  0.00% sendmail
 1438 root        1  20    0 20840K  3696K select   0:00  0.00% smbd
 1111 _dhcp       1  20    0  9540K  1136K select   0:00  0.00% dhclient
11941 root        1  20    0 10940K  2024K pause    0:00  0.00% csh
 1517 mysql       1  52    0  9924K  1072K wait     0:00  0.00% sh
 1073 root        1  47    0  9540K  1012K select   0:00  0.00% dhclient
 1797 root        1  20    0 13064K  1892K select   0:00  0.00% sshd 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T19:34:44.917

这意味着进程中的进程中的一个线程正在等待数据到达套接字。top 的默认模式对于像 mysqld 这样的线程进程来说信息量不是很大；虽然您有 17 个 mysql 线程，但 top 在此模式下只能显示其中一个。您应该使用'-H' 标志到顶部（或在顶部时使用'H' 键盘命令）来分别查看各个线程，这将显示每个线程的不同状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T10:58:28.250

使用来源：

```
find /usr/src -type f  -exec grep -H sbwait {} \+ 
```

这会给你一些文件来查看。

看`/usr/src/sys/kern/uipc_sockbuf.c`：

```
/*
 * Wait for data to arrive at/drain from a socket buffer.
 */
int
sbwait(struct sockbuf *sb)
{

        SOCKBUF_LOCK_ASSERT(sb);

        sb->sb_flags |= SB_WAIT;
        return (msleep(&sb->sb_cc, &sb->sb_mtx,
            (sb->sb_flags & SB_NOINTR) ? PSOCK : PSOCK | PCATCH, "sbwait",
            sb->sb_timeo));
} 
```

# objective-c - 在图像查看器中显示来自 nstableview 的选定图标

> ID：11966562
> 
> 赞同：0
> 
> 时间：2012-08-15T09:00:37.947
> 
> 标签：objective-c, cocoa, imageview, nstableview, nsfilemanager

我有一个类似于上传菜单的表格视图。它包含 4 列：图标、名称、大小和日期。数据从数组控制器显示在 nstablevier 中（没有声明 IBOutlet tableview，我不使用数据源）。我在 nstableview 附近的同一窗口中有一个图像查看器。当我选择一行时，我想在 imageViewer 中显示 tableview 中的图标。但我找不到解决方案。例如，您能帮我提出解决方案、教程或文档吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:45:47.440

在界面生成器中，将 arraycontroller.selection.image 绑定到您的 imageViewer.value。

为此，请单击 imageViewer，选择界面构建器窗口右侧的绑定部分（第 7 个图标），然后在“值”部分单击绑定，将“绑定到”设置为阵列控制器，控制器键为“选择” ，模型键路径是“图像”或“图标”（取决于您在阵列控制器中命名它的方式）。

# objective-c - 如何使用 CATransform3D 为一组 CALayer 添加阴影

> ID：11966568
> 
> 赞同：2
> 
> 时间：2012-08-15T09:01:06.717
> 
> 标签：objective-c, ios, calayer, uibezierpath, cgpath

如何为一组 CALayers 添加阴影？我有一个“FoldingView”类，它维护几个“SliceView”类。每个 sliceview 的层都将被赋予一个 CATransform3D，其中我使用了透视属性 (.m34 = 1.0 / -1000)。

如何添加具有良好视觉逻辑的阴影？这是我到目前为止一直在想的：

1.  我可以获得每个切片的路径并将它们组合起来以获得阴影路径。

    *   我不知道当图层使用 CATransform3D 时如何获取 CALayer 的路径
    *   它可能在视觉上起作用，但如果光应该来自左上角，我担心它不会完全正确。
2.  我可以将标准 CALayer 阴影应用于所有图层

    *   由于阴影相互重叠，它看起来不太好

如果有人有任何其他建议或知道如何编写第 1 个想法，我将非常高兴！这是您从中看到屏幕截图的示例项目的链接。

[下载带有代码的压缩应用程序](http://shared.agens.no/public/hfossli/foldingview/no.agens.foldshadow.zip)

![来自应用程序的示例图像](../Images/06d1694550ec2490f086a13dbe6c76ab.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:01:06.717

这似乎按要求工作。这是按切片视图完成的。

```
- (UIBezierPath *)shadowPath
{ 

    if(self.progress == 0 && self.position != VGFoldSliceCenter)
    {
        UIBezierPath *path = [UIBezierPath bezierPath];  
        return path;
    }
    else
    { 
        CGPoint topLeft = pointForAnchorPointInRect(CGPointMake(0, 0), self.bounds);
        CGPoint topRight = pointForAnchorPointInRect(CGPointMake(1, 0), self.bounds);
        CGPoint bottomLeft = pointForAnchorPointInRect(CGPointMake(0, 1), self.bounds);
        CGPoint bottomRight = pointForAnchorPointInRect(CGPointMake(1, 1), self.bounds);

        CGPoint topLeftTranslated = [self.superview convertPoint:topLeft fromView:self];
        CGPoint topRightTranslated = [self.superview convertPoint:topRight fromView:self];
        CGPoint bottomLeftTranslated = [self.superview convertPoint:bottomLeft fromView:self];
        CGPoint bottomRightTranslated = [self.superview convertPoint:bottomRight fromView:self];

        UIBezierPath *path = [UIBezierPath bezierPath];

        [path moveToPoint:topLeftTranslated];
        [path addLineToPoint:topRightTranslated];
        [path addLineToPoint:bottomRightTranslated];
        [path addLineToPoint:bottomLeftTranslated];
        [path closePath]; 

        return path;
    } 
} 
```

# wcf - 通过 ssl 验证自定义 WCF 客户端证书

> ID：11966576
> 
> 赞同：0
> 
> 时间：2012-08-15T09:01:45.983
> 
> 标签：wcf, validation, ssl, client-certificates

你好，

我正在尝试使用 WCF 进行一些身份验证：

*   使用用户名/密码验证用户
*   使用客户端证书对客户端进行身份验证
*   自定义接受哪些根证书

经过反复试验，我设法使第 1 点和第 2 点工作，但我被困在第 3 点。这是我的服务配置

```
<system.serviceModel>
    <behaviors>
        <endpointBehaviors />
        <serviceBehaviors>
            <behavior name="MyBehavior">
                <serviceCredentials>
                    <userNameAuthentication userNamePasswordValidationMode="Custom"
                                            customUserNamePasswordValidatorType="WcfService1.CustomValidator, WcfService1" />
                </serviceCredentials>                    
                <serviceMetadata httpsGetEnabled="true" httpGetEnabled="false" />
                <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <bindings>
        <customBinding>
            <binding name="certificate">
                <security authenticationMode="UserNameOverTransport" />
                <textMessageEncoding messageVersion="Soap12WSAddressing10" />
                <httpsTransport requireClientCertificate="true" />
            </binding>
        </customBinding>
    </bindings>
    <services>
        <service behaviorConfiguration="MyBehavior" name="WcfService1.Service1">
            <endpoint address="" binding="customBinding" bindingConfiguration="certificate"
                      contract="WcfService1.IService1" />
        </service>
    </services>
</system.serviceModel> 
```

这是我的客户端配置

```
 <client>
        <endpoint name="service1" address="https://localhost:443/WcfService1/Service1.svc" binding="customBinding"
                  bindingConfiguration="certificate" behaviorConfiguration="certificate" contract="WcfService1.IService1" />
    </client>
    <behaviors>
        <endpointBehaviors>
            <behavior name="certificate">
                <clientCredentials>
                    <clientCertificate storeName="My" storeLocation="LocalMachine" x509FindType="FindBySubjectName"
                                       findValue="SignedByCA" />
                </clientCredentials>
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors />
    </behaviors>
    <bindings>
        <customBinding>
            <binding name="certificate">
                <security authenticationMode="UserNameOverTransport" />
                <textMessageEncoding messageVersion="Soap12WSAddressing10" />
                <httpsTransport requireClientCertificate="true" />
            </binding>
        </customBinding>
    </bindings> 
```

使用客户端并附加用户名凭据效果很好

```
var channelFactory = new ChannelFactory<IService1>("service1");
var user = channelFactory.Credentials.UserName;
user.UserName = username;
user.Password = password; 
```

使用 OperationContext.Current.ServiceSecurityContext.AuthorizationContext.ClaimSets 可以让我访问用户名以及证书的名称和指纹。可悲的是，我找不到证书的颁发者名称。我还能如何禁止没有某个根证书颁发的证书的客户端？

非常欢迎任何提示我正确方向或任何替代方案的提示；）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:59:34.217

实际上，这很容易，但是 hack。授权上下文中有一个身份列表。

```
OperationContext.Current.ServiceSecurityContext
.AuthorizationContext.Properties["Identities"] 
```

其中之一是 X509Identity 类型。那个是 System.IdentityModel 内部的，你不能直接得到它。

```
identity.GetType().Name == "X509Identity" 
```

这并不重要，因为包含证书的字段是私有的，无论如何:)

```
var field = identity.GetType().GetField(
    "certificate", 
    BindingFlags.GetField | BindingFlags.Instance | BindingFlags.NonPublic);
var certificate = (X509Certificate2) field.GetValue(identity);
string issuer = certificate.Issuer; 
```

# android - Android：Camera.open() 在 onResume() 方法中不起作用

> ID：11966577
> 
> 赞同：0
> 
> 时间：2012-08-15T09:01:52.870
> 
> 标签：android, android-camera

我有一个应用程序，我在`onResume()`方法中打开相机：

```
@Override
    public void onResume() {
            super.onResume();
        openCamera();
        ....
}

public void openCamera() {
        try {
            camera = Camera.open();
            Log.d(CAMERA, "Camre opened");
        } catch (Exception exception) {
            Log.e(CAMERA, "Cannot open camera", exception);
        }
    } 
```

如果我不在方法中调用 openCamera() 方法，它可以正常工作`onResume()`，但在`onResume()`方法中它给了我以下异常：

```
08-15 14:50:33.999: E/camera(1753): Cannot open camera
08-15 14:50:33.999: E/camera(1753): java.lang.RuntimeException: Fail to connect to camera service
08-15 14:50:33.999: E/camera(1753):     at android.hardware.Camera.native_setup(Native Method)
08-15 14:50:33.999: E/camera(1753):     at android.hardware.Camera.<init>(Camera.java:302)
08-15 14:50:33.999: E/camera(1753):     at android.hardware.Camera.open(Camera.java:279)
08-15 14:50:33.999: E/camera(1753):     at buet.threebyzero.autoSecuritySystem.Capture.openCamera(Capture.java:46)
08-15 14:50:33.999: E/camera(1753):     at buet.threebyzero.autoSecuritySystem.Capture.onResume(Capture.java:55)
08-15 14:50:33.999: E/camera(1753):     at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1154)
08-15 14:50:33.999: E/camera(1753):     at android.app.Activity.performResume(Activity.java:4539)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2434)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2472)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1986)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
08-15 14:50:33.999: E/camera(1753):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-15 14:50:33.999: E/camera(1753):     at android.os.Looper.loop(Looper.java:137)
08-15 14:50:33.999: E/camera(1753):     at android.app.ActivityThread.main(ActivityThread.java:4424)
08-15 14:50:33.999: E/camera(1753):     at java.lang.reflect.Method.invokeNative(Native Method)
08-15 14:50:33.999: E/camera(1753):     at java.lang.reflect.Method.invoke(Method.java:511)
08-15 14:50:33.999: E/camera(1753):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-15 14:50:33.999: E/camera(1753):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-15 14:50:33.999: E/camera(1753):     at dalvik.system.NativeStart.main(Native Method) 
```

**编辑：**重新启动模拟器和覆盖`onPause()`方法后问题部分解决：

```
@Override
    protected void onPause() {
        super.onPause();
        if(camera != null)
            camera.release();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:07:51.227

不确定这是否是问题所在，但`release`每次当您的活动进入后台时，请确保您使用相机。

# .net - .NET 中继器 - 自定义服务器验证

> ID：11966587
> 
> 赞同：3
> 
> 时间：2012-08-15T09:02:25.897
> 
> 标签：.net, validation

我不明白如何在转发器中进行正确的自定义服务器端验证。

我有三列中继器控制：1）注册 - 复选框 2）参加 - 复选框 3）时间 - 文本框

我需要编写验证时间文本框值的服务器端自定义验证。

现在我已经在我的转发器中编写了以下自定义验证：

```
 <asp:Repeater runat="server" ID="rptResidents" OnItemDataBound="rptResidents_ItemDataBound">
 ....
    <asp:CheckBox runat="server" CssClass="RegisterSpan" name="RegisterChkName" ID="chkRegister" />
    <asp:CheckBox runat="server" CssClass="AttendedSpan" name="AttendedChkName" ID="chkAttended" />
    <asp:TextBox runat="server" ID="txtTime" Width="30px" MaxLength="3" Columns="3"></asp:TextBox>
    <asp:CustomValidator runat="server" Width="1px" ID="valTimeRange" ControlToValidate="txtTime" OnServerValidate="valTimeRange_ServerValidate" Text="*" ErrorMessage="Minutes cannot exceed the minutes of the event" />
  .... 
```

服务器端验证功能：

```
protected void valTimeRange_ServerValidate(object sender, ServerValidateEventArgs e)
{
    int maxAllowedMinutes = 0;
    maxAllowedMinutes = Convert.ToInt32(this.txtMaxAllowedMinutes.Text);

            int val = Convert.ToInt32(e.Value);
            if (val > maxAllowedMinutes)
            {
                e.IsValid = false;
            }
            else
            {
                e.IsValid = true;
            }           
} 
```

这工作正常。但我需要添加额外的逻辑。我还需要使用复选框 - 在我的自定义服务器端验证中注册和参加。

所以 ServerValidate 函数看起来像：

```
protected void valTimeRange_ServerValidate(object sender, ServerValidateEventArgs e)
{
    if (CHECKBOX_REGISTER_IS_CHECKED && CHECKBOX_ATTENDED_IS_CHECKED) //?????
    {
            DO_VALIDATION_DESCRIBED_ABOVE
    }
    else
    {
        e.IsValid = true; //NO NEED TO VALIDATE TIME HERE OR ANY OTHER LOGIC COULD BE HERE
    }
} 
```

所以这里的问题是 - 我不了解如何在服务器端验证方法中获取复选框值（两个复选框都来自转发器）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T14:03:49.440

**查看源码，你会发现：**

```
<input name="myRepeater$ctl00$myTextBox" type="text" id="myRepeater_myTextBox_0" />
<input name="myRepeater$ctl01$myTextBox" type="text" id="myRepeater_myTextBox_1" />
<input name="myRepeater$ctl02$myTextBox" type="text" id="myRepeater_myTextBox_2" /> 
```

从后面的代码中，您可以通过 ClientID 属性访问这个生成的 id。您还可以通过搜索转发器的 Items 属性来访问各个控件：

```
TextBox textBox2 = myRepeater.Items[1].FindControl("myTextBox"); 
```

**编辑**：您可以显式设置控件的 ClientID。您必须将其 ClientIDMode 设置为 Static 并在数据绑定时更改 ID：

```
protected void Page_Load(object sender, EventArgs e)
{
    myRepeater.ItemDataBound += new RepeaterItemEventHandler(myRepeater_ItemDataBound);
    myRepeater.DataSource = new int[3];
    myRepeater.DataBind();
}

void myRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    var textbox = e.Item.FindControl("myTextBox");
    textbox.ClientIDMode = ClientIDMode.Static;
    textbox.ID = "myTextBox" + (e.Item.ItemIndex + 1);
} 
```

**给出这个 HTML**：

```
<input name="myRepeater$ctl01$myTextBox1" type="text" id="myTextBox1" />
<input name="myRepeater$ctl02$myTextBox2" type="text" id="myTextBox2" />
<input name="myRepeater$ctl02$myTextBox3" type="text" id="myTextBox3" /> 
```

谢谢。

# iphone - 如何更干净地编写此代码段

> ID：11966588
> 
> 赞同：0
> 
> 时间：2012-08-15T09:02:29.317
> 
> 标签：iphone, objective-c, ios, xcode

在回合制游戏中，我想找到以前的玩家。要找到下一个玩家，我可以输入：

```
int lastPlayer = match.currentPlayer - 1; 
```

问题是当currentPlayer是player 1的时候，那么lastPlayer变成了0，这是错误的。应该是player6。

为了解决这个问题，我可以这样做：

```
 int lastPlayer = match.currentPlayer - 1;

    if (lastPlayer == 0)
        lastPlayer = match.numberOfPlayers; 
```

我的问题是如何以更简洁的方式编写它。我知道游戏中心，基于回合的代码可以执行以下操作：

```
 (currentIndex + 1) % match.participants.count]; 
```

我怎样才能重写我的代码来做同样的事情？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:25:47.800

那个怎么样？

```
int lastPlayer = match.currentPlayer > 1 ? match.currentPlayer - 1 : match.numberOfPlayers; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:30:31.883

如果你有这样的回合计数器：

```
for(int i=0;i< maxTurns;i++){//do something} 
```

玩家 1 第一回合，玩家 2 第二回合，依此类推，您可以得到与在游戏中心完全相同的当前玩家编号。

也许你不知道模“%”运算符，它返回除法的其余部分，例如

```
3%2 = 1 
```

你的回合计数器一直在计数，所以下一个玩家是

```
(turncounter + 1)%match.numberOfPlayer 
```

在这种情况下，模运算符会在达到最大玩家人数时“重置”你的计数器（它的第 6 轮，有 5 名玩家 6%5 = 1）。

综上所述，currentPlayer 是`turncounter%match.numberOfPlayer`

nextPlayer 是`++turncounter%match.numberOfPlayer`

# c++ - C ++ x中的RPG游戏可以低于0？

> ID：11966589
> 
> 赞同：-5
> 
> 时间：2012-08-15T09:02:36.917
> 
> 标签：c++

我正在制作一个 c++ rpg。

这是我的代码： http: [//pastebin.com/cyR5bzKR](http://pastebin.com/cyR5bzKR)

它让我去-1，然后我不能去任何地方。我也可以去4，然后我哪儿也去不了。

有什么帮助吗？

我不希望这过于复杂。

PS 我正在使用 Code::Blocks 我不认为这是问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:04:50.667

在决定玩家是否应该能够移动时，您需要考虑下一个动作。

像这样的东西应该工作......

```
if(dir == "L" && x-1 >= xMin) {
  printf("You Went Left");
  x--;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:41:24.197

你有这样的代码：

```
if (x >= min) --x; 
```

您正在检查一个值是否大于或等于另一个值，然后再递减它。即*如果它相等，你**仍然**递减*，因此，之后它会小于那个值。

解决方案是仅在大于最小值时递减：

```
if (x > min) --x; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:44:25.257

当您向右移动时，您需要检查您不在最正确的位置。同样，当向左移动时，您需要检查您是否不在最左边的位置。

但是你正在测试你没有超过最右边/最左边的位置（并且还在检查你是否在棋盘上，这似乎没有必要）。

你想要类似的东西

```
if (dir == "R" && x < xmax) ++x;
else if (dir == "L" && x > xmin) --x; 
```

您所做的其他测试是多余的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-15T09:28:24.917

```
 if(dir == "L" && x > xMin)
    {
        printf("You Went Left");
        x--;
    }
    else if(dir == "R" && x < xMax)
    {
        printf("You Went Right");
        x++;
    }
    else
    {
        printf("You can't go that way.");
    } 
```

# c# - 如何打开使链接在新标签页中打开？

> ID：11966591
> 
> 赞同：0
> 
> 时间：2012-08-15T09:02:46.453
> 
> 标签：c#, asp.net, webforms

如何使用新标签/新窗口打开 btnSMS.PostBackUrl？或者无论如何要转到该 URL，然后自动转到另一个页面？

更多信息：该 URL 是一种使用服务提供商 (Clickatell) 发送 SMS 的方法。但是除了说明消息发送是否成功之外，URL 什么也没有。我不希望使用我的 ASP.NET 的用户卡在那里。我想让他们在发送消息后返回我的网站。

```
protected void btnSMS_Click1(object sender, EventArgs e)
{

    String HP = txtHP.Text;
    String URL = "http://api.clickatell.com/http/sendmsg?user=myuser&password=mypassword&api_id=myapi_id&to=";
    String Text = "&text=" + txtSMS.Text;
    btnSMS.PostBackUrl = URL + HP + Text;

    string username;
    //Sql Connection to access the database
    SqlConnection conn6 = new SqlConnection("MY CONNECTION");
    //Opening the Connnection
    conn6.Open();
    string mySQL;
    username = HttpContext.Current.User.Identity.Name;
    //Insert the information into the database table Login
    mySQL = "INSERT INTO Table_Message(Username, Message, Title, SendTo) VALUES('" + username + "','" + txtSMS.Text.Trim() + "','" + txtTitle.Text.Trim() + "','" + txtHP.Text.Trim() + "')";

    SqlCommand cmdAdd = new SqlCommand(mySQL, conn6);
    //Execute the sql command
    cmdAdd.ExecuteNonQuery();
    //Close the Connection
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:09:25.363

我认为实现这一点的更好方法是将表单发布到您网站中的 URL，您可以对其做出反应，然后从您的服务器发布到您正在使用的服务，并将用户重定向到适当的 URL .

**更新**

*我假设您在这里使用网络表单。*

问题是您可以发布到您想要的 URL，但您的用户在页面上看不到任何更改。另一个问题是，您将服务的密码和 API_ID 放在回发 URL 中，任何可以导航到您的页面并按 F12 键的人都可以看到该 URL。公开您的 API_ID 是一个很大的错误。它应该是只有你和远程服务应该知道的东西。

这是我的解决方案。

首次加载页面时，您将显示一个空表单并允许用户输入您想要的数据。

然后在点击事件Handler中，获取你想要的数据并手动发布到服务中。HTTP 帖子包含要发送到服务的键值对列表。您必须手动构建发布请求，并从远程服务获取响应。

所以这就是你的点击处理程序的样子。

```
protected void btnSMS_Click1(object sender, EventArgs e)
 {
    Dictionary<string,string> postValues = new   Dictionary<string,string>();

    // gather the key value pairs ou want from your controls and add them to the dictionary.
   // and call postSynchronous method (which I'll explain below)
   string result = postSynchronous(URLtoPOST,postValues);

   if (result= yourSuccessValue){
       // redirect to a page that says.. 'Yay!! you successfully posted to the service ?'
       Server.Transfer("successPage.aspx");
   }else
   {
      // what to do if it fails ?
   }
} 
```

现在该`postSynchronous`方法（或您想调用的任何名称）是您必须手动编写的东西，这将需要一个 RUL 来发布和一个键值对列表与发布一起发送，然后构建实际的发布请求。

查看此链接以获取教程以了解如何执行此操作。 [http://petewarden.typepad.com/searchbrowser/2008/09/how-to-post-an.html](http://petewarden.typepad.com/searchbrowser/2008/09/how-to-post-an.html)

我试图嵌入该方法和任何相关方法的代码，但它太长了。

因此，以这种方式做事更好的是，您永远不会将 API 密钥或密码发送到用户的浏览器，这样他们就永远不会知道。（否则他们可以像你一样使用密钥访问服务，这是一个安全漏洞）

与您的解决方案相比，这有什么不好的是您在服务器上发布，这会给您的服务器带来 CPU 和网络负载。但我想这是您获得的安全利益的良好折衷。

希望这可以帮助。并随时提出任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T10:49:25.870

您的按钮应密切反映如下：

```
<asp:Button runat="server" ID="btnSMS"  UseSubmitBehavior="false"  OnClick="btnSMS_Click1"  Text="Send/> 
```

然后在代码隐藏中构建您的回发网址，然后在提交后添加以下内容：

```
protected void btnSMS_Click1(object sender, EventArgs e)
        {

 String HP = txtHP.Text;
            String URL = "http://api.clickatell.com/http/sendmsg?user=myuser&password=mypassword&api_id=myapi_id&to=";
            String Text = "&text=" + txtSMS.Text;
            string UrlFinal = URL + HP + Text;

            string username;
            //Sql Connection to access the database      
            SqlConnection conn6 = new SqlConnection("Data Source=19-17\\sqlexpress;" + "Initial Catalog = Suite2; Integrated Security =SSPI");
            //Opening the Connnection      
            conn6.Open();
            string mySQL;
            username = HttpContext.Current.User.Identity.Name;
            //Insert the information into the database table Login      
            mySQL = "INSERT INTO Table_Message(Username, Message, Title, Startdate, Enddate, SendTo) VALUES('" + username + "','" + txtSMS.Text.Trim() + "','" + txtTitle.Text.Trim() + "','" + txtHP.Text.Trim() + "')";

            SqlCommand cmdAdd = new SqlCommand(mySQL, conn6);
            //Execute the sql command      
            cmdAdd.ExecuteNonQuery();
            //Close the Connection 

            this.ClientScript.RegisterStartupScript(this.GetType(),
                                        "navigate",
                                        "window.open('" + UrlFinal + "');",
                                        true); 

        } 
```

这应该在新窗口中打开。或者，也可以使用 window.navigate ，这将在同一浏览器中打开另一个页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:16:07.303

是否可以将属性添加`target="_blank"`到 btnSMS 项目？如果它是一个链接元素，它看起来像这样：

```
id="btnSMS" href="" target="_blank" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-18T09:36:03.263

一个重要的切线——你让自己危险地暴露在 SQL 注入攻击之下。

您永远不应该、永远、永远不要将用户的文本输入与 SQL 查询连接起来。

使用`@Parameter`SQL 查询字符串中的值，然后使用`SqlCommand`参数替换这些值。

```
string mySQL = "INSERT INTO Table_Message(Username, Message, Title, SendTo) VALUES(@Username, @Message, @Title, @SendTo)";
SqlCommand cmdAdd = new SqlCommand(mySQL, conn6);
cmdAdd.Parameters.AddWithValue("@Username", username);
cmdAdd.Parameters.AddWithValue("@Message", txtSMS.Text.Trim());
cmdAdd.Parameters.AddWithValue("@Title", txtTitle.Text.Trim());
cmdAdd.Parameters.AddWithValue("@SendTo", txtHP.Text.Trim());
cmdAdd.ExecuteNonQuery(); 
```

明确指定类型会更好：

```
cmdAdd.Parameters.Add("@Username", SqlDbType.NVarChar, 100).Value = username; 
```

请参阅 Troy Hunt 的精彩系列 - [http://www.troyhunt.com/2010/05/owasp-top-10-for-net-developers-part-1.html](http://www.troyhunt.com/2010/05/owasp-top-10-for-net-developers-part-1.html)

# security - 如何在 Symfony2 上的两个不同防火墙下保护 API

> ID：11966597
> 
> 赞同：0
> 
> 时间：2012-08-15T09:03:15.653
> 
> 标签：security, api, rest, symfony-2.1

我目前正在 Symfony2.1 上开发一组新的 Restfull API，它们目前在我的 security.yml 中没有防火墙

```
 api:
        pattern: ^/api
        security: false 
```

我`RequestListener`通过检查用户是否提供 Auth 令牌或使用 Basic Auth 来“保护”他们。正确登录后，我们使用用户填充安全上下文。（也许我们甚至可以使用工厂制作防火墙？）

这非常适合想要在他们的应用程序中使用我们的 API 的外部开发人员/组织。

现在，我希望我们在项目中依赖这些相同的 API（控制器、ajax 调用..），我现在想知道我们是否必须自己实现 API get-token 或 Basic Auth 流程来填充安全上下文API，或者他们是否可以以某种方式神奇地检索主防火墙的当前安全上下文。（它可以让我免于获取令牌、将其保存在某处并在我的视图中一直通过我的 Backbonejs ajax 调用传递它的尴尬）。

感谢您对此的想法！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:30:53.040

首先，对于基本身份验证，您可以依赖Symfony2 提供的[`http_basic`身份验证提供程序。](http://symfony.com/doc/master/book/security.html#basic-example-http-authentication)无需使用请求侦听器。如果要使用基于令牌的身份验证，请编写[一个 Token authentication provider](http://symfony.com/doc/master/cookbook/security/custom_authentication_provider.html)。

安全上下文是分开的，您不能与另一个上下文交互。它们是完全分区的。但是，您可以根据需要添加任意数量的身份验证提供程序。

使用 Backbone.js，您可以保留基于令牌的策略。例如，使用 HTML 属性将令牌传递给 Backbone：

```
<body data-token="xxxx">
    ...
</body> 
```

然后，只需在您的 JavaScript 应用程序中使用它：

```
$.ajaxSetup({
    headers: {
        'token': $('body').data('token')
    }
}); 
```

有关更多信息，请参阅[$.ajaxSetup 文档](http://api.jquery.com/jQuery.ajaxSetup/)。

# sharepoint - WSS 3.0 ItemAdded

> ID：11966598
> 
> 赞同：0
> 
> 时间：2012-08-15T09:03:21.810
> 
> 标签：sharepoint, overriding, content-type, wss, event-receiver

我正在使用 WSS 3.0 并尝试使用 ItemAdded-Event 设置一些权限。问题是，如果我添加一个项目，该事件不会触发。我搜索了整个网络，一无所获。它仅在 ItemAdding / ItemAdded 上，但我已经实现了一个完美运行的 ItemUpdating 和 ItemDeleting 事件！是否存在已知问题？

这是我的事件（它甚至没有得到我的调试消息.. :():

```
 public override void ItemAdded(SPItemEventProperties properties)
      {
        Debug.WriteLine("ItemAdded started.");
        PMDB_ContentType_Class pmClass = new PMDB_ContentType_Class();

        pmClass.SetPermissions(properties);

        Debug.WriteLine("ItemAdded ended.");
      } 
```

这是feature.xml

```
<?xml version="1.0" encoding="utf-8"?>
<Feature Id="34e2c6bd-0e9f-4a65-b280-3cd4c5ff5cb4" Title="PMDB_ContentType"           
Scope="Site" Version="1.0.0.0" Hidden="FALSE" DefaultResourceFile="core" 
xmlns="http://schemas.microsoft.com/sharepoint/">
<ElementManifests>
<ElementManifest Location="PMDB_ContentType\PMDB_ContentType.xml" />
</ElementManifests>
</Feature> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T23:17:32.120

1 >> 我希望你在 FeatureActivated Event 接收器中正确地附加了你的事件和你的列表。我无法检查，因为您尚未发布该代码。请检查该代码中是否有任何错误。

2 >> 使用 Sharepoint Manager (http://spm.codeplex.com/releases/view/51438) 查看您的活动是否正确附加到您的列表中。如果没有，请尝试从 Web UI 停用功能并再次重新激活它。

# xapian - 如何在 Xapian 查询构造函数中使用术语位置参数

> ID：11966602
> 
> 赞同：0
> 
> 时间：2012-08-15T09:03:37.053
> 
> 标签：xapian

Xapian[文档](http://xapian.org/docs/overview.html)讨论了一个带有术语位置参数的查询构造函数，用于短语搜索：

引用：

> 这个构造函数实际上接受了几个额外的参数，这些参数可用于指定查询中术语的位置和频率信息：
> 
> ```
> Xapian::Query(const string & tname_,
>          Xapian::termcount wqf_ = 1,
>          Xapian::termpos term_pos_ = 0) 
> ```
> 
> term_pos 表示词条在查询中的位置。同样，这对于单个词条查询本身没有用，但用于短语搜索、段落检索和其他需要了解查询中词条顺序的操作（例如在给定文档的顺序与它们在查询中出现的顺序相同）。如果不需要此类操作，则可以使用默认值 0。

在参考资料中，我们有：

> ```
> Xapian::Query::Query  (   const std::string &     tname_,
>       Xapian::termcount   wqf_ = 1,
>       Xapian::termpos     pos_ = 0     
>   ) 
> ```
> 
> 由单个术语组成的查询。

和：

> ```
> typedef unsigned  termpos 
> ```
> 
> 文档或查询中的术语位置。

所以，假设我想为短语构建一个查询：**“foo bar baz”**，我该怎么做？！term_pos_ 是否提供相对位置值，即定义文档中术语的顺序：（
*我在这里使用的是 python 绑定 API，因为我更熟悉它）*

```
 q = xapian.Query(xapian.Query.OP_AND, [xapian.Query("foo", wqf, 1),xapian.Query("bar", wqf,2),xapian.Query("baz", wqf,3)] ) 
```

只是为了测试，假设我们做了：

```
 q = xapian.Query(xapian.Query.OP_AND, [xapian.Query("foo", wqf, 3),xapian.Query("bar", wqf, 4),xapian.Query("baz", wqf, 5)] ) 
```

所以这会给出与前面的例子相同的结果？！

假设我们有：

```
 q = xapian.Query(xapian.Query.OP_AND, [xapian.Query("foo", wqf, 2),xapian.Query("bar", wqf, 4),xapian.Query("baz", wqf, 5)] ) 
```

所以现在这将匹配文档的“foo”“bar”用一个术语分隔，然后是“baz”？

是这样，还是这个参数指的是索引词的绝对位置？！

**编辑：**

和`OP_PHRASE`这有什么关系？我找到了一些使用 OP_PHRASE 的在线示例：

```
q = xapian.Query(xapian.Query.OP_PHRASE, term_list) 
```

这显然是有道理的，但是在短语搜索中，上述 term_pos_ 构造函数的作用是什么——它是一种更外科手术的做事方式吗！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T03:54:27.427

```
int pos = 1;
std::list<Xapian::Query> subs;
subs.push_back(Xapian::Query("foo", 1, pos++));
subs.push_back(Xapian::Query("bar", 1, pos++));
querylist.push_back(Xapian::Query(Xapian::Query::OP_PHRASE, subs.begin(), subs.end())); 
```

# c# - 如何在代码隐藏中的 ImageButton 中加载图像？

> ID：11966606
> 
> 赞同：2
> 
> 时间：2012-08-15T09:03:52.280
> 
> 标签：c#, asp.net

我想在后面的代码中创建我的 imagebutton。所以我使用这段代码：

```
 LiteralControl ltr = new LiteralControl();

 ltr.Text = "<asp:ImageButton class=\"stylImage\" AlternateText=\"Signature\" runat=\"server\" ImageUrl=\"~/images/Workflow/digital-signature-pic.jpg\" OnCommand=\"Image_OnCommand\" CommandName=\"imgclick\"/>"; 
```

但它不起作用。什么都没有显示。

任何想法？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:09:51.437

不要使用 Literal 控件，而是添加一个面板控件并将 ImageButton 控件包含在您的面板中。您应该在 Page Init 事件中添加控件

```
protected void Page_Init(object sender, EventArgs e)
{
    ImageButton imgBtn = new ImageButton();
    imgBtn.ID = "img_id";
    imgBtn.ImageUrl = "~/images/Workflow/digital-signature-pic.jpg";
    imgBtn.AlternateText= "Signature";
    imgBtn.Click += (source, args) =>
    {
        // do something
    };
    Panel1.Controls.Add(imgBtn);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:09:35.817

您需要将其添加到页面上的容器中，请参阅这篇文章：

[http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx](http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:11:54.713

您不能将服务器端控件写入文字。你有两个选择，

*   直接在页面上设置图像按钮并更改可见性属性
*   或者添加一个占位符或面板控件并动态添加图像按钮，就像这样

    ```
     ImageButton btn = new ImageButton(); 
            btn.ImageUrl = "my image url";

            btn.Click += btn_Click;

            btn.ID = "create an ID";
            etc....
            ph.Controls.Add(btn); 
    ```

# c++ - 为什么 Cppcheck 没有发现这个明显的数组越界错误？

> ID：11966613
> 
> 赞同：7
> 
> 时间：2012-08-15T09:04:27.990
> 
> 标签：c++, code-analysis, static-code-analysis, cppcheck

我安装了[Cppcheck](http://cppcheck.sourceforge.net/)工具来对我的 C++ 项目进行静态代码分析，感觉它的性能很差。例如，谁能告诉我*为什么*Cppcheck 在以下代码中无法找到数组越界错误？

```
void f(int c) { 
    char *p = new char[10]; 
    p[c] = 42; 
} 

void g() { 
    f(100); 
} 
```

有一个[在线演示](http://cppcheck.sourceforge.net/demo/)，可以使用 Cppcheck 方便地检查此代码。它所提出的只是第 4 行的内存泄漏，没有潜在缓冲区溢出的迹象。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T19:40:32.650

我是一名 Cppcheck 开发人员。

Cppcheck 无法检测到这一点并非设计使然。

Cppcheck 当前不使用来自所有函数调用的所有给定参数来评估函数。我们有这方面的票，我希望有一天能修好。这会很好。

如果您使用 Cppcheck，您不应该认为它会检测到所有错误。Cppcheck 可能无法检测到大多数错误。在我看来，没有任何方法可以检测到您软件中的所有错误。仅使用 Cppcheck 来检测一些您无法检测到的错误。它在一定程度上减少了错误的数量。

我希望你不会太失望，并会继续使用 Cppcheck。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-15T09:37:22.700

因为目前不支持。

对于编译器来说，这实际上并不是一个明显的错误。就像是

```
char c[5];
for (int i=0; i<10; ++i)
    c[i] = 0; 
```

更明显，因为它们都在同一个代码中。

就像是

```
#define f(c) { \
    char *p = new char[10];  \
    p[c] = 42; \
}

void g() { 
    f(100); 
} 
```

更明显，因为 cppcheck 和编译器在实际检查之前就地扩展了所有宏。

但是，您发布的代码并非微不足道，因为 cppcheck 以及编译器需要该函数内的整个代码并根据参数对其进行评估。如果该功能在视线范围内当然是可能的（跨翻译单元变得非常困难，甚至不可能），但现在，cppcheck 没有该功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-19T06:22:40.753

最新版本的 Cppcheck 1.70 dev 能够检测到这个错误：

```
$ cppcheck test.cpp 
Checking test.cpp...
[test.cpp:3]: (error) Array 'p[10]' accessed at index 100, which is out of bounds.
[test.cpp:4]: (error) Memory leak: p 
```

# .net - 如何获取 CheckedListBox.checkedItems 作为字符串列表

> ID：11966614
> 
> 赞同：6
> 
> 时间：2012-08-15T09:04:29.607
> 
> 标签：.net, c#-4.0, .net-4.0

我试图`CheckedListBox.CheckedItems`成为一个 StringList。但我不知道如何得到它。我正在尝试使用 LINQ 将其作为单列。我在 .Net-C# 方面的经验不足，无法做到这一点。有人可以说怎么做吗？

注意：我使用的是 .Net-4.0。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-15T09:08:56.090

如果您存储在这些项目中的值是字符串：

```
List<string> items = chk.CheckedItems.Cast<string>().ToList(); 
```

如果它们是某种自定义类型，您可以使用该类型：

```
List<SomeTypeUsedForTheItems> items = chk.CheckedItems.Cast<SomeTypeUsedForTheItems>().ToList(); 
```

# r - 从 R 数据框中选择一系列行

> ID：11966615
> 
> 赞同：4
> 
> 时间：2012-08-15T09:04:30.210
> 
> 标签：r

我有一个包含 1000 行的数据框，我想一次对其执行 100 行的操作。因此，我试图找出如何在行数上使用计数器增量并一次选择 100 行，例如 1 到 100，然后从 101 到 200 ......直到 1000 并使用 for 对每个子集执行操作环形。任何人都可以建议如何做到这一点，因为我找不到一个好的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T09:11:26.447

一种简单的方法是创建一个分组变量，然后使用`split()`并`lapply()`执行您需要的任何操作。

可以使用 轻松创建您的分组`rep()`。

这是一个例子：

```
set.seed(1)
demo = data.frame(A = sample(300, 50, replace=TRUE),
                  B = rnorm(50))
demo$groups = rep(1:5, each=10)
demo.split = split(demo, demo$groups)
lapply(demo.split, colMeans)
# $`1`
#           A           B      groups 
# 165.9000000  -0.1530186   1.0000000 
# 
# $`2`
#           A           B      groups 
# 168.2000000   0.1141589   2.0000000 
# 
# $`3`
#           A           B      groups 
# 126.0000000   0.1625241   3.0000000 
# 
# $`4`
#           A           B      groups 
# 159.4000000   0.3340555   4.0000000 
# 
# $`5`
#           A           B      groups 
# 181.8000000   0.0363812   5.0000000 
```

如果您不想将组添加到源`data.frame`中，可以通过执行以下操作来实现相同的效果：

```
groups = rep(1:5, each=10)
lapply(split(demo, groups), colMeans) 
```

当然，替换`colMeans`为您想要的任何功能。

使用`data.frame`具有 1000 行的 a 示例，您的`rep()`语句应类似于：

```
rep(1:10, each=100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:00:05.647

@mrdwab 的答案很棒，并展示了如何避免 for 循环。但是，如果您真的必须使用 for 循环（biglm 包将是您可能想要的一个示例），那么这是一种方法：

```
for( i in seq(1,1000,by=100) ) {
  myfun( df[ i:(i+99), ] )
} 
```

如果总行数不是块大小的倍数，那么您可能需要更多类似的东西：

```
tmp <- seq( 1, nrow(df), by=100 )
tmp2 <- c( tail( tmp, -1)-1, nrow(df) )
n <- length(tmp)
out <- numeric(n)
for( i in seq_along(tmp) ) {
  out[i] <- myfun( df[ tmp[i]:tmp2[i], ] )
} 
```

# php - 我很困惑：为类中的所有函数定义变量的最简单方法是什么？

> ID：11966617
> 
> 赞同：2
> 
> 时间：2012-08-15T09:04:38.170
> 
> 标签：php, oop

很抱歉问了一些被广泛记录的东西，但是我遇到了很多不同的方法，我非常非常困惑。

1.  `public static`
2.  `public $foo`
3.  `global`，这似乎是一种不好的做法
4.  `define()`
5.  `const constant = 'constant value';`

我是否低估了我在这里尝试做的事情的复杂性？

```
class MyClass
    {

    $foo = 'bar';

    function DoStuff()
        {
        echo $foo;
        }

    } //MyClass 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:08:13.270

```
Class Example
{
    private $foo = 5;

    function bar()
    {
        echo $this->foo;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T09:09:29.067

如果它应该只在你的课堂上可用，我建议这样做：

```
class MyClass {
   private $foo = 'bar';

   public function DoStuff() {
      echo $this->foo;
   }

} 
```

如果它应该可以从其他类中获得，你应该实现 getter 和 setter。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T09:13:25.867

静态变量在没有类实例的情况下可用，并且在所有实例之间共享

const 是恒定的 - 它的值不能改变

公共属性属于特定实例，可以由任何对象更改，而不仅仅是实例。

都是有效的数据声明方式，这取决于你需要什么。

您是否需要数据不可更改？(const) 你需要数据在课堂之外可见吗？（公共）您是否需要在实例之间共享数据（静态；注意您也可以拥有私有静态）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T09:13:49.947

`public $foo`是每个人都可以访问`$my = new MyClass(); $my->foo`并且可以设置的变量

`public static $foo``MyClass::foo`是一个每个人都可以访问但不能设置的变量

`global $foo`是每个人都可以设置和获得的变量`$foo`

`define("FOO","myString")`是一种全球性的，但可以通过`FOO`但不能设置

`const foo`就像一个静电

# sql - SQL Inner Join 尽可能满足 2 个条件

> ID：11966618
> 
> 赞同：4
> 
> 时间：2012-08-15T09:04:42.600
> 
> 标签：sql, sql-server-2008

我在映射表中有以下数据：

```
ID1         LOCALID         ID2
Local_-1    BankA_7-9       Local_2647
Local_0     Bank_7-9        Local_2647
Local_2624  BGROMF          NULL
Local_2619  BIS             NULL 
```

ID2 可以为空。

我的第二张桌子看起来像：

```
ID1        ID2
Local_-1   Local_2674 
Local_0    Local_2674
Local_2624 Local_2674
Local_2619 Local_2674 
```

如何内部连接具有以下条件的表？是否可以在没有 if 语句的情况下执行此操作？

如果映射表中的 ID2 为空，则在 ID1 上加入，否则在 ID1 和 ID2 上加入。

我的出发点（显然会排除空值）是：

```
SELECT * FROM 
    #Table2 C
     INNER JOIN Mapping F 
                  ON C.ID1 = F.ID1 AND
                  C.ID2 = F.ID2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T09:07:24.413

```
SELECT * FROM  
    #Table2 C 
     INNER JOIN Mapping F  
                  ON C.ID1 = F.ID1 AND 
                  C.ID2 = ISNULL(F.ID2, C.ID2) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-13T12:01:34.093

使用查询

```
SELECT * FROM 
    #Table2 C
     INNER JOIN Mapping F 
       ON C.ID1 = F.ID1 AND
       C.ID2 = F.ID2ffgffgf 
```

# zend-framework - zend 框架：找不到类

> ID：11966619
> 
> 赞同：0
> 
> 时间：2012-08-15T09:04:43.603
> 
> 标签：zend-framework, classnotfound

我在 zend 框架基本应用程序中遇到找不到类的问题。请帮忙

我有基本结构并添加了模型/表目录。在我提交时显示我的登录页面后，出现以下错误

**致命错误**：第 18 行的 E:\zendu\Apache2\htdocs\login\application\controllers\AuthController.php 中找不到类“Application_models_tables_User”

授权控制器.php

```
class AuthController extends Zend_Controller_Action
{

public function init()
{
    /* Initialize action controller here */
}

public function indexAction()
{
    // action body
}

public function loginAction()
{
    $data = new Application_models_tables_User();

} 
```

模型/表格/User.php

```
class Application_models_tables_User extends Zend_Db_Table
{
protected $_name = 'users';
} 
```

在应用程序.ini

```
appnamespace = "Application" 
```

我正在使用zend studio，因此自动创建了基本结构。所以我不必设置模型的包含路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:19:44.423

阅读[以下](http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html#zend.loader.autoloader-resource.module)内容：

模块资源自动加载器将文件夹 'models' 设置为 namespace `Model`。

我会将您的班级名称更改为`Application_Model_Table_User`，并将您的“模型/表格”文件夹更改为`models/Table`

# javascript - 根据用户屏幕大小加载 js 或 php

> ID：11966628
> 
> 赞同：4
> 
> 时间：2012-08-15T09:05:21.393
> 
> 标签：javascript, jquery, ajax, responsive-design

我有几个 Swiffy (HTML5 SWF) 动画，我只想根据用户的屏幕尺寸加载它们！

iv 在下面找到了一些 JavaScript，它说如果 screnn 大于 1400 它将加载但它不起作用！

```
<script language=javascript>
if(screen.Width>1400)
{
    document.write("<?php include('/map/map4.php');?>");
}
else
{
    document.write("<?php include('/map/map1.php');?>");
}
</script> 
```

任何人都知道用上述或其他方式做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:10:08.500

改变这个：

```
if(screen.Width>1400) 
```

至：

```
if (screen.width > 1400) 
```

`width`对象的属性`screen`应该是小写的。

还要注意，当 JavaScript 执行时 ServerSide 处理结束，你`document.write`的 s 只输出文本而不是可执行的 php 代码，你可以改用`load`jQuery 的方法。

> 从服务器加载数据并将返回的 HTML 放入匹配的元素中。

```
if (screen.width > 1400) {
     $('#wrapper').load('/map/map4.php');
} else {
     $('#wrapper').load('/map/map1.php');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:10:54.310

这些 php 文件的内容将被注入到 JavaScript 文字中，并且可能会破坏文字。从浏览器查看时，您能否发布生成的 html。

可能您想要做的是将两个 php 文件放入单独的 div 中的代码中，然后使用 CSS 隐藏或显示相关文件。

如果你这样做，你可以使用@media css 查询来显示/隐藏基于窗口大小的部分，这将随着用户调整浏览器大小而动态调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:20:59.220

如果您只有 SWF 对象，您可以通过[DOM 操作将它们添加到文档中](https://www.google.de/#hl=de&output=search&sclient=psy-ab&q=DOM+Manipulation&oq=DOM+Manipulation&gs_l=hp.3..0l4.851.851.0.1876.1.1.0.0.0.0.104.104.0j1.1.0...0.0...1c.UFppUTspr18&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&fp=7964df66ca62f4a9&biw=1303&bih=790)

如果你想有一个更复杂的方法来检查用户屏幕有一个库[jRespond](http://viget.com/inspire/managing-javascript-on-responsive-websites)，如果用户调整浏览器大小，它将轮询浏览器大小和更新

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-14T16:42:49.897

我面临同样的困境，所以我使用了这个解决方法，我希望它有所帮助。

```
<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>435</title>
<script>  if( document.cookie.indexOf("resolucion5") < 0) {
//alert("Cargando resolucion.");

if (screen.width > 1199){ document.cookie = "resolucion5=desktop; max-age=" + 5; }
if ((screen.width > 768)&&(screen.width < 1200)){ document.cookie = "resolucion5=tablet; max-age=" + 5; }
if ((screen.width > 380)&&(screen.width < 780)){ document.cookie = "resolucion5=cel; max-age=" + 5; }
if (screen.width < 381){ document.cookie = "resolucion5=mini; max-age=" + 5; 
}

location.reload();
}</script>

<? if ($_COOKIE["resolucion5"]=="desktop"){$resolucion="";}
elseif ($_COOKIE["resolucion5"]=="tablet"){$resolucion="med";}
elseif ($_COOKIE["resolucion5"]=="cel"){$resolucion="med";}
elseif ($_COOKIE["resolucion5"]=="mini"){$resolucion="mini";} ?>

<link href="style<? echo $resolucion; ?>.php" rel="stylesheet">
 <script src="somescript<? echo $resolucion; ?>.js" type="text/javascript"></script>

</head>

<body>
<? require("menu".$resolucion.".php"); ?><br>
<img src="welcome<? echo $resolucion; ?>.jpg">
</body>
</html> 
```

# objective-c - 为什么我的应用程序在尝试使用 dateWithTimeIntervalSince1970 时会因 NSInvalidArgumentException 而崩溃？

> ID：11966635
> 
> 赞同：-1
> 
> 时间：2012-08-15T09:06:03.897
> 
> 标签：objective-c, ios, date, nsdate

我正在尝试使用 dateWithTimeIntervalSince1970 创建一个 NSDate，但我不断收到 NSInvalidArgumentException。我无法弄清楚我的语法有什么问题：

```
// [mutableItem valueForKey:@"date"] is a string which represents an integer of milliseconds

NSDate *dateObject = [NSDate dateWithTimeIntervalSince1970:([[mutableItem valueForKey:@"date"] longLongValue]/1000)]; 
```

谁能看到这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:22:36.237

如果除以 1000，则除以整数。如果你除以 1000。（DOT）那么它可能会起作用。

dateWithTimeIntervalSince1970：需要一个双精度的 NSTimeInterval。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:35:30.967

你能检查你的 mutableItem 值吗？

这是我的工作示例：

```
NSString *mutableItem = @"1344981600000";

NSDate *dateObject = [NSDate dateWithTimeIntervalSince1970:([mutableItem longLongValue]/1000)];

//dateObject = 2012-08-14 22:00:00 +0000 
```

# prolog - 返回最小值或小于特定数字 - 序言

> ID：11966638
> 
> 赞同：3
> 
> 时间：2012-08-15T09:06:20.480
> 
> 标签：prolog

这个问题要求我们对 Prolog 进行编码，如果列表 L 中没有元素小于 A，则当 M 为 A 时满足；否则当 M 是列表 L 的最小值时满足

```
minLessThan([],A,A).
minLessThan([H|T], A, M) :-
   H >= A,
   M is A,
   minLessThan(T, A, M).
minLessThan([H|T], A, M) :-
   H < A,
   M is H,
   minLessThan(T, A, M). 
```

现在，我的结果对句子的第一部分有效，但是当 M 是列表 L 的最小值时它一直返回 false，我假设当列表 L 为空时出现问题，它返回 A，有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:55:26.997

由于这是家庭作业，我只会给你一些建议：

对于您要执行的操作，在递归步骤之前，您不应在第二个和第三个子句中实例化 M 。也就是说，您不必放置`M is A`and`M is H`因为 M 将在基本情况（第一个子句）中被实例化。

此外，第三个子句中的递归调用应该使用`H`而不是`A`作为第二个参数，因为您找到了一个小于当前最小值的项目。

注意 的第二个参数`minLessThan`可以读作“找到的当前最小值”，所以你应该调用过程给出一些初始值，否则会发生实例化错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T00:28:16.663

```
minLessThan([],A,A).

minLessThan([H|T], A, M) :-
    H >= A,
    minLessThan(T, A, M).

minLessThan([H|T], A, M) :-
    H < A,
    minLessThan(T, H, M). 
```

这是我编辑的答案，现在可以正常工作。

# memcached - 使用 Homebrew 卸载 memcached 和/或（强制）安装 - Mac OS X

> ID：11966640
> 
> 赞同：3
> 
> 时间：2012-08-15T09:06:24.023
> 
> 标签：memcached, homebrew

我需要在我的 Mac (os X 10.8) 上安装 memcached，我首先“手动”安装 memcached 和 libevent (1)。好吧，也许我这样做有点太快了，现在我发现最好用 Homebrew“干净地”安装它。

我想我应该首先卸载“干净”的 libevent 和 memcached。我是不是该 ？还是我应该简单地运行`brew install memcached`，并使用该功能删除 Homebrew 认为要删除的文件？（我的意思是`brew link -f memcached`之后`brew install memcached`；我想知道它会有多“干净”，如果我以后不会遇到难以解决的问题......）

谢谢你的帮助 ！

* * *

(1) 我是如何安装 libevent 的：

```
cd /tmp
wget http://www.monkey.org/~provos/libevent-1.4.13-stable.tar.gz
tar zxvf libevent-1.4.13-stable.tar.gz
./configure
make
sudo make install 
```

和内存缓存：

```
wget http://memcached.googlecode.com/files/memcached-1.4.1.tar.gz
tar xzvf memcached-1.4.1.tar.gz
cd memcached-1.4.1
./configure
make
make test
sudo make install
memcached -d -P pidfile -l 127.0.0.1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T18:51:15.437

Memcached 和 libevent 都带有 Makefile`uninstall`目标命令。假设您仍然拥有之前配置的源文件；否则，您需要`./configure`在运行任何 make 命令之前运行。

```
cd memcached-1.4.1
sudo make uninstall
cd ../libevent-1.4.1-stable
sudo make uninstall 
```

之后，您应该能够使用 Homebrew 干净地安装所有内容。

# php - 从 Google Analytics 中删除页面

> ID：11966644
> 
> 赞同：3
> 
> 时间：2012-08-15T09:06:50.020
> 
> 标签：php, google-analytics

我的 header.php 包含文件中保存了我的 Google Analytics 跟踪代码。如何从某些页面中删除它？由于各种原因，有几页我不想跟踪。

我在 GA 中尝试了正则表达式过滤器，但无济于事。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:10:10.527

如果它被插入到您自己的服务器端代码中，为什么不只是`if()`在它周围添加一些以仅在某些正则表达式不匹配（检查当前请求）或未设置某些标志时才嵌入它？对 GA 进行过滤听起来有点像一个不太理想的解决方案，因为数据集已经创建好了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T10:17:33.297

尝试：

```
header('Location: http://www.example.com/?id=154077');
header('X-Robots-Tag: noindex, nofollow', true); 
```

# ios - 当 audioqueue 播放从 ffmpeg 解码的 lpcm 时，音频队列的经过时间超过了媒体的持续时间

> ID：11966645
> 
> 赞同：0
> 
> 时间：2012-08-15T09:06:51.947
> 
> 标签：ios, audio, ffmpeg, pcm, audioqueueservices

使用音频队列播放从ffmpeg解码的lpcm数据时，经过的时间`AudioQueueGetCurrentTime`超过了媒体的持续时间。但是当用AVFoundation框架解码相同的媒体时，经过的时间等于媒体的持续时间，所以当ffmpeg在没有解码的情况下读取媒体，然后将压缩的媒体数据发送到audioqueue，经过的时间也等于媒体的持续时间。**AudioStreamBasicDescription**设置如下：

```
 asbd.mSampleRate = 44100;
    asbd.mFormatID = kAudioFormatLinearPCM;
    asbd.mFormatFlags = kAudioFormatFlagsCanonical;
    asbd.mBytesPerPacket = 4;
    asbd.mFramesPerPacket = 1;
    asbd.mBytesPerFrame = 4;
    asbd.mChannelsPerFrame = 2;
    asbd.mBitsPerChannel = 16;
    asbd.mReserved = 0; 
```

播放从 AVFoundation 解码的数据时，**AudioStreamBasicDescription**的设置同上。通过我的测试发现ffmpeg和AVFoundation的`AudioTimeStamp.mSampleTime`get by`AudioQueueGetCurrentTime`是不同的，ffmpeg的值大于AVFoundation。所以我想知道这是怎么发生的，以及如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T11:58:33.433

这里的错误`asbd.mSampleRate = 44100`并不总是正确的，所以有时结果是正确的，但其他人是错误的。然后你应该设置`asbd.mSampleRate = audioCodecCtx->sample_rate`，这总是很好用！

# javascript - javascript复选框全选，取消全选，反转选择

> ID：11966646
> 
> 赞同：-3
> 
> 时间：2012-08-15T09:06:54.113
> 
> 标签：javascript, checkbox, action

我正在做的脚本遇到问题。实际上我给了类似的东西，因为我正在为我的 Intranet 做一个邮箱。

```
<script type="text/javascript">
function GereChkbox(conteneur, a_faire) {
var blnEtat=null;
var Chckbox = document.getElementById('box-table-a').firstChild;
    while (Chckbox!=null) {
        if (Chckbox.nodeName=="INPUT")
            if (Chckbox.getAttribute("type")=="checkbox") {
                blnEtat = (a_faire=='0') ? false : (a_faire=='1') ? true : (document.getElementById(Chckbox.getAttribute("id")).checked) ? false : true;
                document.getElementById(Chckbox.getAttribute("id")).checked=blnEtat;
            }
        Chckbox = Chckbox.nextSibling;
    }
}
</script><form>
<table width="100%" border="0" id='box-table-a'>
  <tr>
    <th scope="col" width="15%"><strong>Exp&eacute;diteur</strong></th>
    <th scope="col" width="60%"><strong>Message</strong></th>
    <th scope="col" width="10%"><strong>Date</strong></th>
    <th scope="col" width="15%"><strong>Actions</strong></th>
  </tr><?php $sql="SELECT * FROM `messages` WHERE `id_destinataire`='".$_SESSION['login']."' AND `trash`='0' ORDER BY id DESC LIMIT ".$premiereEntree.", ".$messagesParPage."" ;
$result=mysql_query($sql) or die(__LINE__.mysql_error().$sql);
$i=0; 
while($data=mysql_fetch_assoc($result)) {                                                ?>
<tr>
<td align="left"><?php $req="SELECT * FROM `gestionnaire` WHERE `login`='".$data['id_expediteur']."'";
$result2=mysql_query($req) or die(__LINE__.mysql_error().$req);
$expediteur=mysql_fetch_assoc($result2);  ?><img src="<?php if (!empty($expediteur['urlavatar'])) {echo $expediteur['urlavatar']; } else {echo "images/noAvatar.gif" ;} ; ?>" width="50px" height="50px" /><br /><?php echo $expediteur['nom'].' '.$expediteur['prenom'] ; ?></td>
<td><?php if($data['lu']=='0') { echo '<p align="left"><img src="images/Gnome-Mail-Unread-32.png" width="24px" height="24px" /><strong>  '.$data['titre'].'</strong></p>';
$nbChar = 150; // Nb. de caractères sans '...'

if(strlen($data['message']) >= $nbChar)
    $message = substr($data['message'], 0, $nbChar).' [...]';

echo '<p align="left"><i>'.$message.'</i></p>';
}
else { echo '<p align="left"><img src="images/Gnome-Emblem-Mail-32.png" width="24px" height="24px" /><strong>  '.$data['titre'].'</strong></p>';
$nbChar = 150; // Nb. de caractères sans '...'

if(strlen($data['message']) >= $nbChar)
    $message = substr($data['message'], 0, $nbChar).' [...]';

echo '<p align="left"><i>'.$message.'</i></p>';} ;
?></td>
<td><?php echo  date('d-m-Y H:i',strtotime($data["date"])) ; ?></td>
<td><a href="index.php?p=liremessage&amp;id=<?php echo $data['id'] ; ?>"><img src="images/email_open.png" alt="Lire le message" width="24px" height="24px" border="0"  /></a> <img src="images/Gnome-Mail-Forward-32.png" alt="Transf&eacute;rer le message" width="24px" height="24px" border="0"  /> <a href="deletemessage.page?id=<?php echo $data['id'] ; ?>" onclick="return confirm('Voulez vous vraiment supprimer ce message?')"><img src="images/mail-trash.png" alt="Supprimer ce message" width="24px" height="24px" border="0"  /></a> <input type="checkbox" name="action[<?php echo ++$i; ?>]" id="checkbox<?php echo $i; ?>"  /></td>
</tr>
<?php } ; ?>
</table>
<table width="100%" border="0">
  <tr>
    <td>Actions: <input type="button" value="Tout cocher" onClick="GereChkbox('div_chck','1');">&nbsp;&nbsp;&nbsp;
<input type="button" value="Tout d&eacute;cocher" onClick="GereChkbox('div_chck','0');">&nbsp;&nbsp;&nbsp;
<input type="button" value="Inverser la s&eacute;lection" onClick="GereChkbox('div_chck','2');"></td>
    <td>&nbsp;</td>
  </tr>
</table>
</form> 
```

事实上，由于脚本的原因，它并没有真正起作用，而且我在控制台中没有错误消息。

非常感谢您的帮助。

亲切的问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:44:03.043

无论如何，这里有一个函数可以切换/选中/取消选中给它的任何复选框：

```
function changeCheckboxes(list, value){
    for(var i = list.length - 1 ; i >=0 ; i--){
        list[i].checked = (typeof value === 'boolean') ? value : !list[i].checked ;
   }
} 
```

它接受一个节点列表或复选框数组作为第一个参数。使用它如下...

## 切换复选框：

`changeCheckboxes(allCheckboxes);`

## 复选框：

`changeCheckboxes(allCheckboxes, true);`

## 取消选中复选框：

`changeCheckboxes(allCheckboxes, false);`

要获取所有复选框，您可以这样做：

```
var inputs = document.getElementsByTagName('input');
var allCheckboxes = [] ;
    for (var j = inputs.length-1 ; j >= 0 ; j--){
        if (inputs[j].type === 'checkbox'){
        allCheckboxes.push(inputs[j]);
    }
} 
```

# javascript - Shopify 来自商店前端的 javascript api

> ID：11966647
> 
> 赞同：2
> 
> 时间：2012-08-15T09:06:57.280
> 
> 标签：javascript, authentication, frontend, shopify

我为shopify制作了一个脚本标签（带有一个Rails应用程序），其中几乎没有行代码：

```
$.getJSON('/admin/custom_collections.json',function(res) {

    $(res.custom_collections).each(function(index,collection) {
        var collectionHTML = '<li><a data-collection-id="' + collection.id + '" href="#">' + collection.title + '</a></li>';
        $("#ajax-search-container").append(collectionHTML);
    })
}) 
```

是否可以从商店前端使用它？如何验证此 javascript 以存储管理员？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:14:50.913

验证 JS 的最佳方法之一是在请求中发送 access_token。或者您可以向您的服务器发送一个请求，然后通过创建一个 MD5 验证请求的方法来检查用户是否有任何更改。

但是个人我使用第一种方法，我发送一个令牌并检查它。您可以生成此令牌并将它们存储在数据库中，并让它们拥有一生。因此，如果用户在 5 分钟内未发帖，则令牌无效。

**这是用于生成令牌**

```
before_filter :generate_token_to_db

private

def generate_token_to_db
  Token.create!(:token => generate_token)
end

def generate_token
  (0...64).map{65.+(rand(25)).chr}.join
end 
```

然后您可以进入管理站点，搜索此令牌，然后如果它在那里，则执行操作，如果没有，则重新定向客户并告诉他失败。

# xquery - 如何使用 XQuery 从一系列值中选择属性的特定值？

> ID：11966656
> 
> 赞同：0
> 
> 时间：2012-08-15T09:07:40.707
> 
> 标签：xquery

如何使用 XQuery 从一系列值中选择特定的属性值？

我的 XML 文件如下所示：

```
<unit id="01" xref="entry01 entry02"> 
```

如何从**外部参照**属性中选择特定值（例如 entry01）并将其分配给变量？

我需要从属性**xref**中选择单个值，因为这些值的附加功能在文件后面定义：

```
<features xref="entry01" font-size="2">
<features xref="entry02" font-size="3"> 
```

我想将这些条目组织到一个表格中，如下例所示。属性定义的列如下：unit id, xref, font-size。

```
<tbody>
<tr>
<td>01</td>
<td>entry01</td>
<td>2</td>
</tr>
<tr>
<td>01</td>
<td>entry02</td>
<td>3</td>
</tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:33:27.383

用于`fn:tokenize`在空格（或所有空格）字符处拆分，具体取决于您的需要：

在单个空格处拆分：

```
tokenize(<unit id="01" xref="entry01 entry02"/>/@xref, " ")[1] 
```

允许多个空格直接相邻：

```
tokenize(<unit id="01" xref="entry01  entry02"/>/@xref, " +")[2 
```

Split at a single whitespace (I changed the attribute value to contain a tab character):

```
tokenize(<unit id="01" xref="entry01    entry02"/>/@xref, "\s")[2] 
```

# iphone - 如何判断一个字符是否被 UIFont 支持？

> ID：11966658
> 
> 赞同：4
> 
> 时间：2012-08-15T09:07:48.793
> 
> 标签：iphone, ios, uifont

如何判断一个字符是否被 UIFont 支持？

例如：如何判断一个UIFont是否支持“サポート”或“поддержка”

特别感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T09:47:52.417

查看 CGFontGetGlyphWithGlyphName： - 如果字形不存在，则返回 0。

# perl - 日期范围的 Perl Case 语句

> ID：11966661
> 
> 赞同：0
> 
> 时间：2012-08-15T09:07:53.477
> 
> 标签：perl, switch-statement, case, control-structure

我有这个 PERL Switch..case 语句：

```
switch ($today)
{ 
    case "14-Aug-2012"  { do A }
    case "15-Aug-2012"  { do B }
}#end switch 
```

我的问题是，2012 年 8 月 15 日的“做 B”声明与 2012 年 10 月 1 日相同。我如何说这些日期之间的大小写，这样我就不必在不同的日子重写相同的东西并使我的脚本变长？

我已经放入了整个脚本，因此有人可以帮助我使用我必须处理的问题来管理我的问题。

```
use Date::Calc
use Switch

#connect to database...

my @date_today=Today();
my $today=substr(Date_to_Text(@date_today),4,11);

Switch($today)
{
  case "14-Aug-2012" {Do A}
  case "15-Aug-2012" {Do B}
  case ...
  case ...
  case ...
} 
```

最后 3 个 case 语句应该这样做：

```
 between 16-Aug-2012 and 28-Sep-2012 {do C}
  between 29-Sep-2012 and 26-Oct-2012 {do D}
  between 27-Oct-2012 and 09-Nov-2012 {do E} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:20:25.760

使用软件工程方法。

如果您需要在整个日期范围内执行相同的操作，请使用该范围的 ID 作为谨慎的值来选择。然后有一个子程序告诉你日期所在的范围 ID 是什么：

```
sub range_for_date {
    my $date = shift;
    # Compute the range value in some discreet subset
    # How to compute it is somewhat irrelevant
    #      and can be asked separately if you have no idea
    # discreet subset can be an index 1..N, ecpoch timestamps,
    # or a somehow-encoded range end date (e.g. "20121001" is easy)
    # For the switch example below we will assume end dates

    return $range_id; # in "20121001" format 
}

switch (range_for_date($today)) {
    case "20121001" { do B; }
    case "20120110" { do A; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T11:43:30.297

这是另一种可能更简单的方法。它只是将日期转换为 YYYYMMDD 格式，从而可以对它们进行数字排序/比较。

```
sub sortable_date
{
    my %months;
    @months{
        'Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'
    } = ('01'..'12');

    if (shift() =~ /^(\d{1,2})-(\w{3})-(\d{4})/ and exists $months{$2})
    {
        return "$3$months{$2}$1";   
    }
    else { die "invalid date format!"; }
}

switch (sortable_date($today))
{ 
    case sortable_date("14-Aug-2012")                  { do A }
    case ($_[0] >= sortable_date("15-Aug-2012") and
          $_[0] <= sortable_date("01-Oct-2012"))       { do B }
} 
```

不过，如果您要对一般日期做很多事情，我会推荐 mpe 的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:14:05.160

使用 UNIX 时间戳而不是日期字符串。时间戳是整数，可以很容易地分类为日期范围（并使用 重新格式化`localtime()`）。

例如，使用`Time::Local`及其`timelocal()`函数将您的字符串转换为时间戳：

```
use Time::Local;
my %months = ( # necessary because timelocal() expects month numbers, not strings
  'Jan' => 0,
  'Feb' => 1,
  'Mar' => 2,
  'Apr' => 3,
  'May' => 4,
  'Jun' => 5,
  'Jul' => 6,
  'Aug' => 7,
  'Sep' => 8,
  'Oct' => 9,
  'Nov' => 10,
  'Dec' => 11
);
my $today = '15-Aug-2012';
my @t = $today =~ /(\d{4})-(\w{3})-(\d{4})/;
$t[1] = $months{$t[1]};  # turn string into integer
my $timestamp = timelocal(0, 0, 0, @t[0, 1, 2]); # sec, min, hr, day, month, year 
```

# android - Android：从 XML 向 Web 视图添加按钮

> ID：11966664
> 
> 赞同：1
> 
> 时间：2012-08-15T09:07:57.453
> 
> 标签：android, android-layout, android-webview

我正在开发一个 android 应用程序，我需要显示 HTML 页面。

我设法使用下面的网络视图做到了这一点

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <WebView 
    android:id="@+id/webView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    </WebView>

    <Button
            android:id="@+id/disease_consultation_button"
            android:layout_width="@dimen/buttonWidth"
            android:layout_height="@dimen/buttonHeight"
            android:layout_gravity="right"
            android:layout_marginRight="20dp"
            style="@style/buttonStyle"
            android:text="@string/continue_button" />

    </LinearLayout> 
```

并来自java代码

```
WebView webView;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.disease_web_view_activity);

       webView = (WebView) findViewById(R.id.webView1);
       webView.getSettings().setJavaScriptEnabled(true);

       String customHtml = "<html><body><h1>Hello, WebView</h1></body></html>";
       webView.loadData(customHtml, "text/html", "UTF-8");

    } 
```

该按钮没有出现在视图中，我不知道为什么？

谁能帮帮我？

视图看起来像这样

![出现的视图](../Images/22e430d38c55479229233c7a73ede460.png)

编辑：这就是我所做的并解决了问题=）

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <RelativeLayout 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >    

     <TextView android:id="@+id/disease_consultation_titleTextView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            style="@style/activityTitle" />

    <Button
            android:id="@+id/disease_consultation_button"
            android:layout_width="wrap_content"
            android:layout_height="@dimen/buttonHeight"
            android:layout_gravity="right"
            android:layout_marginLeft="550dp"
            android:layout_marginTop="80dp"
            style="@style/buttonStyle"
            android:text="@string/request_new_consultation" />

    <WebView 
            android:id="@+id/webView1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="150dp" >

    </WebView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:23:39.933

您可以做的一件事是放置第一个按钮（或另一个包含多个项目的布局），然后添加您的 WebView，例如

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

<WebView
    android:id="@+id/webView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
</LinearLayout> 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:11:41.533

它不会出现。:)

A`WebView`就像一个浏览器，它呈现 HTML 页面的内容。
因此，如果您需要在 中显示一个按钮`WebView`，您应该使用该按钮创建一个 HTML 页面并提供`WebView`显示它的 url。

如果您想显示一个 HTML 按钮，请在您的代码中包含一个：

```
String customHtml = "<html><body><h1>Hello, WebView</h1>
                         <button type="button">Click Me!</button> 
                     </body></html>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T10:10:55.707

a 的默认方向`LinearLayout`是水平的。由于您的 WebView 与父元素的宽度（即`android:layout_width="fill_parent"`）相匹配，因此 WebView 将使用所有可用的宽度。

要解决您的问题，请`LinearLayout`通过设置设置垂直方向`android:orientation="vertical"`。有了这个，布局中的元素将显示为彼此波纹，而不是并排。

[您可以在developer.android.com](http://developer.android.com/reference/android/widget/LinearLayout.html)阅读有关此主题的更多信息。

编辑：代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:orientation="vertical">

    <WebView 
        android:id="@+id/webView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

    </WebView> 

    <Button
        android:id="@+id/disease_consultation_button"
        android:layout_width="@dimen/buttonWidth"
        android:layout_height="@dimen/buttonHeight"
        android:layout_gravity="right"
        android:layout_marginRight="20dp"
        style="@style/buttonStyle"
        android:text="@string/continue_button" />

</LinearLayout> 
```

# c# - 难以为接口/引用类型的成员实现属性

> ID：11966671
> 
> 赞同：1
> 
> 时间：2012-08-15T09:08:33.493
> 
> 标签：c#, linq, oop

我在为类型接口/引用类型的成员实现属性时遇到困难。我有以下代码：

```
public interface IPort: IBaseModel
{
  string PortName {get;set;}
}
public class Port : IPort
{
 public string PortName {get;set;}
}
public abstract class AbstractBaseModel : IBaseModel
{ 
 List<IBaseModel> children = new List<IBaseModel>();

 public void RegisterProperties(IBaseModel model)
 {
   // code to get the property info using reflection and update the children list.
   //   children.Add(propertyinfo.getValue(this,null))
 }
}

public Vessel : AbstractBaseModel
{
 public IPort Port {get ; set;}

  public Vessel()
 {
    base.RegisterProperties(this);
  }
} 
```

在 Vessel 类中，以不同形式编写属性 PortName 在其余代码中表现出不同的行为。当我需要使用反射调用抽象基类中的属性时，需要知道各种实现有什么区别以及哪一个是最好的：

```
1\. private IPort port;
   public IPort Port
   {
     get
     {
      if (port == null)
       port = new Port();
      return port;
      }
     set {port = value;}
   }

2\. public IPort Port {get ; set;}

3\. public IPort Port {
     get
      {
       if (port == null)
         port = new Port();
       return port;
       }
     set {}
   } 
```

另外，我正在使用实体框架来加载我的 Vessel 类。令我惊讶的是，每次我在 LINQ 代码中选择 Vessel 类型的对象时都会调用 set 访问器（属性的“值”为空）。对此的任何指示都会有所帮助。

# rest - 使用 TeamCity REST API 跟踪构建进度

> ID：11966674
> 
> 赞同：9
> 
> 时间：2012-08-15T09:08:54.177
> 
> 标签：rest, continuous-integration, teamcity

我使用 TeamCity (7.0) REST API 来允许开发人员触发自定义构建。我将构建添加到队列中，如下所示：

http://teamcity/httpAuth/action.html?add2Queue=[buildTypeId]&name=[propName]&value=[propValue]

我的问题是如何最好地跟踪刚刚触发的构建进度。REST 调用不会返回有关分配给构建的构建 ID 的任何信息，因此即使我轮询构建列表（正在运行/已完成），我也不知道其中一个是否是我触发的。队列中可能有相同 buildTypeId 的多个构建，因此我需要一种方法来分离出我所追求的那个。

我在某处读到一个建议，您可以为放入队列中的每个构建添加一个具有唯一值的构建属性，然后轮询构建列表并查找具有该确切属性值的构建列表。然而，我还没有找到一种列出构建属性的方法，所以我仍然卡住了。此 REST 调用不提供有关属性的信息：

http://teamcity/httpAuth/app/rest/builds/?locator=buildType:[buildTypeId]

关于如何解决这个问题的任何建议？理想情况下，我想知道构建是否在队列中，是否正在运行，以及何时完成我想获得状态。然而，最重要的是要知道它是否已完成以及状态如何。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T06:32:34.080

经过一些进一步的调查，我想出了一个似乎工作正常的解决方案：

我发现即使您没有使用“/builds/?locator=buildType:x”调用获得有关自定义构建属性的任何信息，您也可以提取该列表中每个构建的构建 ID，然后执行另一个 REST 调用以获取有关一个特定构建的更多详细信息。其余调用如下所示：

```
http://teamcity/httpAuth/app/rest/builds/id:{0} 
```

此调用的响应将为您提供一个“构建对象”，其中包含构建属性列表等。

我跟踪构建进度的解决方案是这样的：

将构建添加到 TeamCity 队列时，我首先将一个名为“BuildIdentifier”的属性添加到 URL。该值只是一个 GUID。我将此标识符传递回客户端应用程序，然后客户端开始轮询服务器，询问具有此特定标识符的构建状态。然后服务器通过一些步骤来识别构建的当前阶段：

1：检查构建是否正在运行。我通过调用“/builds?locator=running:true”获取正在运行的构建列表，遍历构建并使用构建 ID 查询 REST API 以获取详细信息。然后，我会查看每个正在运行的构建的详细信息，以寻找与我从客户端收到的具有匹配“BuildIdentifier”属性的构建。如果在其中一个正在运行的构建中存在匹配项，我会向正在跟踪进度的客户端发送一条响应，其中包含构建正在以 x%（构建对象的 PercentageComplete 属性）运行的消息。如果未找到匹配项，我将继续执行第 2 步。

2：检查是否完成：首先使用“/builds/?locator=buildType:x”调用获取最新的构建列表。然后执行与步骤 1 相同的操作，并从列表中提取 X 个最新版本（我选择了 5）。为了限制 REST 调用的数量，我假设构建将在最新的 5 个构建中完成。然后，我在 BuildIdentifier 上查找匹配项，如果找到匹配项，则返回构建状态（失败、成功等）。

3：如果第 1 步或第 2 步中的 BuildIdentifier 不匹配，我可以假设构建在队列中，因此我将其作为当前状态返回。

在客户端，只要状态表明构建在队列中或正在运行，我就会每 x 秒轮询一次服务器的状态。

如果还有其他人遇到同样的问题，希望这个解决方案会有所帮助！如果您使用 TeamCity REST API，我认为跟踪触发构建的进度是一项非常常见的任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-06T22:51:19.613

[Queued Builds](http://confluence.jetbrains.com/display/TCD8/REST+API#RESTAPI-QueuedBuilds) rest api 是完成此任务的最佳方式，但仅在 8.1 版后才可用。

*   要开始构建，请发送一个 POST 请求来`~/httpAuth/app/rest/buildQueue`喜欢这个

    ```
    {
        buildType: { id: "bt667" },
        branchName: "master",
        properties: {
            property: [
                { "name": "Property", "value": "test" }
            ]
        }
    } 
    ```

*   响应包含一个可用于检查构建状态的 href。

    ```
    {
        ...
        "href": "/httpAuth/app/rest/buildQueue/taskId:49337",
        ...
    } 
    ```

*   要检查排队的构建状态，请向步骤 1 的响应中指定的 href 发送 GET 请求。

这是对以前 API 的巨大改进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-31T11:44:09.217

从 TeamCity 8.1 开始，REST API 获得了触发构建和跟踪排队构建结果的专用方法，因为构建队列请求返回指向排队构建的链接，该链接稍后可用于跟踪构建的当前状态。请参阅[TeamCity 文档](http://confluence.jetbrains.com/display/TCD9/REST+API#RESTAPI-TriggeringaBuild)中的详细信息。

# x86 - pte 修改是否与通常的内存访问一样通过相同的页表？

> ID：11966676
> 
> 赞同：4
> 
> 时间：2012-08-15T09:09:04.977
> 
> 标签：x86, operating-system, osdev

我知道通常的内存访问将通过页表进行虚拟地址到物理地址的转换。但是 pte 修改呢？说操作系统要修改一个进程的页表项，是不是也要经过进程的页表呢？换句话说，页表中是否有指向自身的条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T17:09:27.880

这在很大程度上取决于 CPU/MMU/硬件。

在 x86 PTE 上，通常在已启用页面转换时修改（不要将其与页表的初始设置混淆，这可以在启用页面转换之前完成），因此内存访问必须涉及虚拟到物理地址的转换。

当然，您可以关闭页面翻译。或者您可以使用 DMA 或其他电路（或 CPU）从 CPU 外部更改内存内容。但这是非常不寻常的。

虽然我不知道很多不同的 CPU，但很有可能它们中的一些具有特殊功能，可以在访问 PTE 时直接操作 PTE，而无需地址转换。

在 x86 上，通常还设置页面目录（最顶层的页表），使其其中一个条目指向页面目录。这使您可以访问虚拟地址子范围中的所有 PDE 和 PTE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:43:58.703

这是正确的。通常有一个 PTE 指向页面目录本身的物理地址，以使其可以从虚拟地址空间访问。

# c# - 无法通过通用名称从 C# 中的商店获取证书

> ID：11966677
> 
> 赞同：1
> 
> 时间：2012-08-15T09:09:06.403
> 
> 标签：c#, .net, cryptography, x509certificate2

在 .Net 4.0 中，我无法使用 X509Store 的 find 方法从自定义存储中获取证书。使用以下代码：

```
X509Store store = new X509Store(storeName, StoreLocation.CurrentUser);

store.Open(OpenFlags.ReadOnly);
X509Certificate2Collection col = store.Certificates.Find(X509FindType.FindBySubjectName, commonName,false); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T11:27:30.623

**解决它**

抱歉，我犯了一个基本错误，我忘记了使私钥可导出，因此一旦我使密钥可导出代码开始工作，加密 API 就不会将私钥暴露给 .net。

# java - Java Swing - 闪烁的图标不显示

> ID：11966681
> 
> 赞同：2
> 
> 时间：2012-08-15T09:09:20.480
> 
> 标签：java, swing, timer, icons, glasspane

我正在尝试使用 GlassPane 将图标闪烁给用户。我正在运行一个`javax.swing.Timer`基本上执行此操作的：

```
for (int i = 0; i < 3; i++) {
    frame.getGlassPane().setVisible(true);
    try {
        Thread.sleep(500);
    } catch (InterruptedException e1) {
       //To change body of catch statement use File | Settings | File Templates.
        e1.printStackTrace();
    }
    frame.getGlassPane().setVisible(false);
} 
```

不幸的是，如果我让 EDT（计时器内的当前线程）休眠，则图标不会显示，因为该`paintComponent`方法在线程进入休眠状态之前无法完全调用。因此，当下一条指令启动时，玻璃窗格被隐藏，因此图标永远不会显示。有没有办法使用这种（类似的）方法来实现我想要的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T10:09:41.663

你可以使用一个`javax.swing.Timer`

```
public FlashTimer() {

    javax.swing.Timer flashTimer = new javax.swing.Timer(500, new FlashHandler());
    flashTimer.setCoalesce(true);
    flashTimer.setRepeats(true);
    flashTimer.setInitialDelay(0);

}

public class FlashHandler implements ActionListener {

    private int counter;

    @Override
    public void actionPerformed(ActionEvent ae) {

        countrol.setVisible(counter % 2 == 0);
        counter++;
        if (counter > 3) {

            ((Timer)ae.getSource()).stop();

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T09:30:32.593

应该很明显 - 使用单独的线程并在那里执行“闪烁逻辑”，但在 EDT 中修改 UI。这是一个简单的例子（应该足以理解这个想法）：

```
public static void main ( String[] args )
{
    JFrame frame = new JFrame ();

    final JLabel label = new JLabel ( "X" );
    label.setBorder ( BorderFactory.createEmptyBorder ( 90, 90, 90, 90 ) );
    frame.add ( label );

    frame.setDefaultCloseOperation ( JFrame.EXIT_ON_CLOSE );
    frame.pack ();
    frame.setLocationRelativeTo ( null );
    frame.setVisible ( true );

    new Thread ( new Runnable ()
    {
        public void run ()
        {
            for ( int i = 0; i < 15; i++ )
            {
                try
                {
                    setVisible ( false );
                    Thread.sleep ( 500 );
                    setVisible ( true );
                    Thread.sleep ( 500 );
                }
                catch ( InterruptedException e1 )
                {
                    //
                }
            }
        }

        private void setVisible ( final boolean visible )
        {
            SwingUtilities.invokeLater ( new Runnable ()
            {
                public void run ()
                {
                    label.setVisible ( visible );
                }
            } );
        }
    } ).start ();
} 
```

# c# - 如何获取 PCI 设备的 Device ID？

> ID：11966684
> 
> 赞同：4
> 
> 时间：2012-08-15T09:09:30.837
> 
> 标签：c#, wmi, device, pci

我正在尝试从 C# 中的设备管理器获取系统设备 ID。我找到了一些代码来查找 USB 设备 ID，但我不知道如何将代码从 USB 设备更改为 PCI 设备。

这是我找到的代码：

```
 ManagementObjectSearcher mos = new ManagementObjectSearcher("SELECT * FROM Win32_SystemDevices WHERE InterfaceType='USB'");    
 foreach (ManagementObject mo in mos.Get())     
 {
      ManagementObject query = new ManagementObject("Win32_PhysicalMedia.Tag='" + mo["DeviceID"] + "'");      
      Console.WriteLine(query["SerialNumber"]);    
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T06:27:09.940

根据 MSDN，**Win32_PhysicalMedia**代表任何类型的文档或存储介质。如果您想从 PCI 设备获取 DeviceID（如在控制面板的设备管理器中） - 您需要**Win32_PnPEntity**类，它表示即插即用设备的属性。因此，尝试使用此代码：

```
ManagementObjectSearcher searcher =
new ManagementObjectSearcher("root\\CIMV2",
"SELECT * FROM Win32_PnPEntity");

foreach (ManagementObject queryObj in searcher.Get())
{
     Console.WriteLine("DeviceID: {0}", queryObj["DeviceID"]);
     Console.WriteLine("Description: {0}", queryObj["Description"]);
} 
```

运行此代码为我提供了有关我的 PCI 设备的大量信息

# ios - 在 iOS 中以编程方式生成 OpenGL 顶点数据

> ID：11966685
> 
> 赞同：0
> 
> 时间：2012-08-15T09:09:31.557
> 
> 标签：ios, opengl-es

基本上我想做的是以编程方式生成我的顶点坐标，而不是将其存储在静态预定义的数组中。不幸的是，我无法将一个非常简单的示例转换为动态数组。

如果我坚持使用静态数组，一切正常：

```
typedef struct {
    GLfloat Position[3];
    GLfloat Color[4];
    GLfloat TexCoord[2];
    float Normal[3];
} Vertex;

Vertex sphereVertices[] = {
    {{1, -1, 1}, {1, 0, 0, 1}, {1, 0}, {0, 0, 1}},
    {{1, 1, 1}, {0, 1, 0, 1}, {1, 1}, {0, 0, 1}},
    {{-1, 1, 1}, {0, 0, 1, 1}, {0, 1}, {0, 0, 1}},
    {{-1, -1, 1}, {0, 0, 0, 1}, {0, 0}, {0, 0, 1}}
};

GLubyte sphereIndices [] = {
    0, 1, 2,
    2, 3, 0
}; 
```

...

```
glGenBuffers(1, &sphereIndexBuffer);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, sphereIndexBuffer);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(sphereIndices), sphereIndices, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), (const GLvoid *) offsetof(Vertex, Position)); 
```

...

```
glDrawElements(GL_TRIANGLES, 6 * sizeof(GLubyte), GL_UNSIGNED_BYTE, 0); 
```

一旦我将索引切换到动态数组，就只会出现第一个三角形。

```
GLubyte *sphereIndices;

+(void)initialize {
    sphereIndices = malloc(6 * sizeof(GLubyte));
    sphereIndices[0] = 0;
    sphereIndices[1] = 1;
    sphereIndices[2] = 2;
    sphereIndices[3] = 2;
    sphereIndices[4] = 3;
    sphereIndices[5] = 0;
} 
```

可能这与指针有关。有人知道我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T10:30:00.303

我能够自己解决问题。正如我已经预料到的那样，这个问题与我对指针的理解缺失有关。

据我发现，没有办法获得动态数组的大小。因为它`sizeof(sphereIndices)`总是返回 4，它是指针的大小而不是数据的大小。这就是为什么`glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(sphereIndices), sphereIndices, GL_STATIC_DRAW)`只向 openGL 发送 4 个索引而不是 6 个的原因。

我通过引入一个额外的变量来跟踪索引的数量来解决这个问题。

# regex - 查找替换修改的正则表达式

> ID：11966691
> 
> 赞同：0
> 
> 时间：2012-08-15T09:09:45.750
> 
> 标签：regex, eclipse

我想在**Eclipse**中使用正则表达式来使代码适应软件更新。

代替

`{$CFG->prefix}example1.xy`

代码必须是：

`{example1}.xy`

去工作。

另一个例子是：

`{$CFG->prefix}example2.foo`

>

`{example2}.foo`

常数部分是`{$CFG->prefix}`：`.`

我尝试了以下方法（我使用空格使阅读更容易）：

寻找：`\{\$CFG-\>prefix\} ([a-z]|[0-9])* \. ([a-z]|[0-9])*`

它将找到请求的字符串。我努力更换它。

我可以`,/1`用来存储正则表达式的结果并在替换中使用它（对吗？）但我不确定如何修改/操作这个结果。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:15:32.740

你可以试试

```
\{\$CFG-\>prefix\}([a-z0-9]*)\. 
```

并替换为

```
{\1}. 
```

1.  我不确定为什么你的正则表达式中有空格，我删除了它们。

2.  量词`*`应该在您的组内，否则您将只有最后一个匹配的字符`\1`而不是完整的单词。

3.  由于您不想替换最后一部分，因此您不需要匹配和替换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:13:48.843

尝试以下搜索和替换：

**查找**：`\{\$CFG->prefix\}([a-z0-9]*)\.([a-z0-9]*)`

**替换为**：`{\1}.\2`

使用上述以下内容：

[![前](../Images/be680850b89fc03759997dddccc9e5d6.png)](https://i.stack.imgur.com/AokSm.png)     成为     [![后](../Images/f540cefd81248c26fc17f5db914c78dd.png)](https://i.stack.imgur.com/vaLDc.png)

**[这](http://youtu.be/QTKSkPbzcEA)**是一个快速的截屏视频，展示了这一点。

### 对 OP 的 Find reg-ex 所做的更改

为了使上述查找替换工作，我必须对 OP 的查找表达式进行以下更改：

1.  删除了空格。
2.  在组内移动了贪婪匹配修改器：即 `([...]*)`代替`([...])*`
3.  更正了字符集：即`[a-z0-9]`代替`[a-z]|[0-9]`
4.  引入了另一个组，该组捕获了该期间之后的部分。然而，这并不是严格需要的，但在某些情况下可能很有用。

# java - Android 流畅的多点触控绘图

> ID：11966692
> 
> 赞同：3
> 
> 时间：2012-08-15T09:09:47.237
> 
> 标签：java, android, drawing, multi-touch

我正在尝试制作一个简单的绘图应用程序。我想用光滑的手指画出简单的曲线。并使用多点触控。我有以下代码：

```
@Override
public void onDraw(Canvas canvas) {
    for (Path path : paths) {
        canvas.drawPath(path, paint);
    }
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    float xPos = event.getX();
    float yPos = event.getY();

    if (event.getAction() == MotionEvent.ACTION_DOWN)
    {
        path = new Path();
        path.moveTo(xPos, yPos);
    }
    else if (event.getAction() == MotionEvent.ACTION_MOVE)
    {
        path.lineTo(xPos, yPos);
                    paths.add(path);
    }
    else if (event.getAction() == MotionEvent.ACTION_UP)
    {
        path.lineTo(xPos, yPos);
                    paths.add(path);
    }

    invalidate();

    return true;
} 
```

哪里有别的办法？怎样才能用三指画得又好又流畅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:13:11.523

对于`MotionEvent`此类应用程序，其中嵌入了历史信息。批处理标题下的[http://developer.android.com/reference/android/view/MotionEvent.html](http://developer.android.com/reference/android/view/MotionEvent.html)有一个很好的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-30T14:02:21.937

这里是复制粘贴的示例。只需创建扩展 View 的类并实现以下方法。

```
private final Paint paint = new Paint(); // Don't forgot to init color, form etc.

@Override
protected void onDraw(Canvas canvas) {
    for (int size = paths.size(), i = 0; i < size; i++) {
        Path path = paths.get(i);
        if (path != null) {
            canvas.drawPath(path, paint);
        }
    }
}

private HashMap<Integer, Float> mX = new HashMap<Integer, Float>();
private HashMap<Integer, Float> mY = new HashMap<Integer, Float>();
private HashMap<Integer, Path> paths = new HashMap<Integer, Path>();

@Override
public boolean onTouchEvent(MotionEvent event) {
    int maskedAction = event.getActionMasked();

    Log.d(TAG, "onTouchEvent");

    switch (maskedAction) {
        case MotionEvent.ACTION_DOWN:
        case MotionEvent.ACTION_POINTER_DOWN: {
            for (int size = event.getPointerCount(), i = 0; i < size; i++) {
                Path p = new Path();
                p.moveTo(event.getX(i), event.getY(i));
                paths.put(event.getPointerId(i), p);
                mX.put(event.getPointerId(i), event.getX(i));
                mY.put(event.getPointerId(i), event.getY(i));
            }
            break;
        }
        case MotionEvent.ACTION_MOVE: {
            for (int size = event.getPointerCount(), i = 0; i < size; i++) {
                Path p = paths.get(event.getPointerId(i));
                if (p != null) {
                    float x = event.getX(i);
                    float y = event.getY(i);
                    p.quadTo(mX.get(event.getPointerId(i)), mY.get(event.getPointerId(i)), (x + mX.get(event.getPointerId(i))) / 2,
                            (y + mY.get(event.getPointerId(i))) / 2);
                    mX.put(event.getPointerId(i), event.getX(i));
                    mY.put(event.getPointerId(i), event.getY(i));
                }
            }
            invalidate();
            break;
        }
        case MotionEvent.ACTION_UP:
        case MotionEvent.ACTION_POINTER_UP:
        case MotionEvent.ACTION_CANCEL: {
            for (int size = event.getPointerCount(), i = 0; i < size; i++) {
                Path p = paths.get(event.getPointerId(i));
                if (p != null) {
                    p.lineTo(event.getX(i), event.getY(i));
                    invalidate();
                    paths.remove(event.getPointerId(i));
                    mX.remove(event.getPointerId(i));
                    mY.remove(event.getPointerId(i));
                }
            }
            break;
        }
    }

    return true;
} 
```

# c# - 如何在 Caliburn.Micro 中处理登录/注销？

> ID：11966698
> 
> 赞同：6
> 
> 时间：2012-08-15T09:10:27.960
> 
> 标签：c#, .net, wpf, caliburn.micro, wpf-4.0

我是 Caliburn.Micro 的新手，我想知道在我的应用程序中处理用户登录/注销周期的最佳方法是什么。我在网上看到一些建议使用一个空的 Shell-View 来实现这一点，它在 LoginView 和主应用程序视图之间切换，当然每个都有一个自定义 ViewModel。

我不太喜欢这个解决方案，因为对我来说，这是 2 个独立的窗口，具有非常不同的属性（标题、图标、大小），而且这似乎是一个不干净的解决方案，两个将一个窗口更改为另一个窗口。另一个问题是，登录窗口来自一个我无法控制且不使用 Caliburn.Micro 的实用程序库，它是一个普通的旧窗口，当用户单击“登录”时它会给我一个事件。

我还看到了在 Bootstrapper 启动方法中显示此对话框的建议，但我看到的问题是用户可以选择“注销”应再次显示登录对话框的应用程序。处理 Bootstrapper 中视图之间的切换对我来说似乎是错误的。

我想要的是有某种 ApplicationViewModel 或 ApplicationController 像 Caliburn Conductor 一样工作，但不是在窗口内的视图之间切换，它应该在 LoginWindow 和 MainWindow 之间切换，并且还应该处理整个应用程序的关闭（其中还需要注销）。在激活时，它会显示 LoginWindow，处理 Login 事件，然后切换到主窗口（Shell）。如果用户选择“注销”，该事件应该再次冒泡到 ApplicationViewModel/Controller，这将停用/关闭 MainWindow，执行注销，然后再次显示 LoginDialog。类似的关闭事件会执行注销，然后关闭整个应用程序。

所以我的问题是：

1.  你如何看待这个解决方案，你有另一个/更好的解决方案吗？
2.  我该如何实施？;-)

非常感谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-17T21:02:04.053

我认为您的问题的解决方案相当容易。

简而言之，您正在创建一个 ViewModel 作为 Shell，当应用程序启动时，它用登录窗口表示。如果用户成功登录，此窗口将关闭，并且视图模型的相同实例将显示在内容窗口中。如果用户正在注销，则会再次显示登录窗口。

首先创建一个接口 IShell，它公开两个委托`LoginSuccessful`和`Logout`

```
public interface IShell
    {
        Action LoginSuccessful { get; set; }
        Action Logout { get; set; }
    } 
```

接下来创建一个`ShellViewModel`实现的类`IShell`

```
 public class ShellViewModel : Screen, IShell
    {
        public ShellViewModel()
        {
            LoginSuccessful = delegate { };
            Logout = delegate { };
        }

        public Action LoginSuccessful { get; set; }
        public Action Logout { get; set; }

        public void DoLogin()
        {
            LoginSuccessful();
        }

        public void DoLogout()
        {
            Logout();
        }
    } 
```

方法`DoLogin`和`DoLogout`是可以绑定到`Button`适合您的控件或任何控件的操作。

下一步是覆盖`OnStartupMethod`Bootstrapper 中的 。前提是您拥有一个实例`WindowManager`并由`ShellViewModel`您选择的 IoC 框架导出。

```
protected override void OnStartup(object sender, StartupEventArgs e)
        {
            var windowManager = IoC.Get<IWindowManager>();
            var viewModel = IoC.Get<IShell>();

            viewModel.LoginSuccessful =
                () => GuardCloseAndReopen("Content");

            viewModel.Logout =
                () => GuardCloseAndReopen("Login");

            windowManager.ShowWindow(viewModel, "Login");
        }

        private void GuardCloseAndReopen(string shellViewMode)
        {
            var windowManager = IoC.Get<IWindowManager>();
            var shellScreen = IoC.Get<IShell>() as Screen;

            Application.ShutdownMode = ShutdownMode.OnExplicitShutdown;

            shellScreen.TryClose();

            Application.ShutdownMode = ShutdownMode.OnLastWindowClose;

            windowManager.ShowWindow(shellScreen, shellViewMode);
        } 
```

诀窍是：如果调用该方法，`DoLogout`当前窗口会通过调用`TryClose`. `ShellViewModel`同时，您可以通过将 设置为`Application.ShutdownMode`来防止应用程序被关闭`OnExplicitShutdown`。然后使用窗口管理器，通过将“登录”作为上下文信息传递给窗口管理器，以登录模式创建另一个窗口。这实际上是同一个 ViewModel，但是具有不同的视觉表示。

因为`Logout`你正在做同样的事情。

要使用 Caliburn 约定来完成这项工作，您需要一个特殊的项目结构，如此处所示（并在此处解释[）](http://caliburnmicro.codeplex.com/wikipage?title=All%20About%20Conventions)： ![在此处输入图像描述](../Images/960fc7284be05a4df56ca9f26a3ebf4f.png)

现在我挑战您获取这段代码并创建一个小示例应用程序。创建一个`Login`视图（使用按钮登录或其他）并`Content`使用 LoginSuccessful/ Logout 方法创建一个带有注销按钮的视图。

这将用最少的代码和类解决您的问题。希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T19:42:42.427

我已经尝试过创建一些基本上可以工作但可能需要更多工作才能真正可用的东西。完整的评论和来源可以在我网站上的这篇文章[Caliburn.Micro 登录窗口示例中找到。](http://kihonkai.com/content/caliburnmicro-login-window-sample)

我使用`IEventAggregator`Caliburn.Micro 来控制两个窗口之间的过渡。你得到这个代码来打开登录屏幕：

```
public void Handle(LoginEvent message)
{
    LoginWindow loginWindow = new LoginWindow();
    loginWindow.Login += new EventHandler<LoginEventArgs>(this.LoginWindow_Login);
    loginWindow.Cancel += new EventHandler(LoginWindow_Cancel);
    loginWindow.ShowDialog();
} 
```

首次打开应用程序和发布注销事件时都使用相同的源。注销事件如下所示：

```
public void Handle(LogoutEvent message)
{
    Application.Current.ShutdownMode = ShutdownMode.OnExplicitShutdown;
    message.Source.TryClose();
    Application.Current.ShutdownMode = ShutdownMode.OnLastWindowClose;
    this.events.Publish(new LoginEvent());
} 
```

当登录成功时，它使用此代码打开基于 ViewModel 的主窗口：

```
ContentViewModel viewModel;
viewModel = IoC.Get<ContentViewModel>();
viewModel.Username = e.Username;
this.windowManager.ShowWindow(viewModel); 
```

# iphone - 如何检查 iOS 设备是否是视网膜显示器 iPod touch？

> ID：11966702
> 
> 赞同：0
> 
> 时间：2012-08-15T09:11:06.453
> 
> 标签：iphone, ios, ipod-touch

是否有一种安全的方法来确定设备是否属于特定型号？例如，我必须知道用户使用的设备是否是视网膜显示器 iPod touch。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T09:14:47.833

```
NSRange r = [[[UIDevice currentDevice] model] rangeOfString:@"iPod"];
float s = [[UIScreen mainScreen] scale];

if (r.location != NSNotFound && s > 1.5f) {
    // retina iTouch
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T09:15:29.263

我可能会尝试这样的事情：

```
+(BOOL) isRetinaiPod
{
    return [[[UIDevice currentDevice] model] isEqualToString:@"iPod touch"] && [UIScreen mainScreen].scale >= 2.0f;
} 
```

但是，您可以使用以下命令返回设备的名称：

```
+ (NSString *) deviceName 
{
    struct utsname u;
    uname(&u);
    return [NSString stringWithUTF8String:u.sysname];
} 
```

# jquery - Jquery 工具覆盖：在覆盖中打开外部页面时需要 rel="nofollow"

> ID：11966703
> 
> 赞同：0
> 
> 时间：2012-08-15T09:11:09.240
> 
> 标签：jquery, overlay, jquery-tools

我们有一个页面，其中不同的链接可以在 jquery 工具覆盖中打开不同的外部页面，就像在这个页面上解释的那样：http: [//jquerytools.org/demos/overlay/external.html](http://jquerytools.org/demos/overlay/external.html)。

现在我们的问题是我们还需要将 NOFOLLOW 添加到我们的 rel 属性中，因为我们不希望 Google 索引外部页面的内容，但这会破坏覆盖功能，因为覆盖的 id 不包含单词不关注。

我有一个想法，将 NOFOLLOW 也添加到覆盖的 id 中，但不幸的是，这不起作用，关于如何解决这个问题的任何想法？

最好的问候马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T11:52:53.387

如前所述，您将需要`nofollow`从服务器端提供服务，否则 Google 不会接收它。想到这样做的唯一想法是

*   `<a rel="nofollow" data-overlay="yes" ...>`从服务器端服务。这`data-`是我们在 jQuery 中执行的下一步

*   在初始化覆盖之前，在 jQuery 中，遍历每个元素并将`rel`属性从更改`nofollow`为`overlay`：

    ```
    $('[data-overlay="yes"]').attr("rel", "overlay");  // not tested 
                                                       // but should work 
    ```

*   初始化覆盖

*   任务完成。来点冰淇淋吧！

# ios - 具有透明度的 iOS 优化 png

> ID：11966706
> 
> 赞同：1
> 
> 时间：2012-08-15T09:11:32.703
> 
> 标签：ios, optimization, png

我正在使用这个优秀的[OptimizedPNG](https://github.com/basuke/OptimizedPNG)来下载（不是 Xcode 捆绑的）图像，但它似乎将透明像素变成黑色。是否有适用于包含透明度的 PNG 的类似实用程序（使用 CgBI 格式进行优化）？

根据要求的示例用法：

```
 UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:IMAGE_URL]]];
NSData *data = [image optimizedData];
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"optimized-image.png"];
[[NSFileManager defaultManager] createFileAtPath:filePath contents:data attributes:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T10:20:19.497

简单的答案：忘记“优化的 PNG”。

[http://imageoptim.com/tweetbot.html](http://imageoptim.com/tweetbot.html)

[http://www.cocoanetics.com/2011/10/avoiding-image-decompression-sickness/](http://www.cocoanetics.com/2011/10/avoiding-image-decompression-sickness/)

我正在使用 PNGOUT 尽可能好地压缩图像，我可以验证速度没有差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:15:57.303

尝试将 UIImageView 的 backgroundColor 属性设置为 [UIColor clearColor]；

# asp.net - 为什么视图状态被序列化到表单中的隐藏字段而不保存在服务器上？

> ID：11966708
> 
> 赞同：4
> 
> 时间：2012-08-15T09:11:51.743
> 
> 标签：asp.net, webforms, viewstate

我对*WebForms*很陌生，我正在尝试了解*ViewState*。今天 AFAIK，它通过回发到同一页面来保持对 UI 的修改。但是为什么它将状态（= 存储的修改）发送到客户端并且**不将其保存在服务器上以**节省 CPU 周期和带宽？

我是否理解完全错误的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:18:55.887

顾名思义，视图状态是与视图有内在联系的东西，在保持这种关系的同时尝试单独管理它并不是一件容易的事。

您需要存储每个页面的视图状态，因此您仍然必须向客户端发送一个 ID，以便能够在回发时获得正确的视图状态。另一个严重的问题是您向客户端发送了一个页面，但您不知道客户端何时或是否将该页面回发到服务器，因此您需要至少在会话到期之前存储视图状态。

这可能会导致服务器资源的浪费，因为所有这些视图状态都是为可能永远不会回发到服务器的用户存储的。如果您保持视图状态纤细，您会同意存储它的最佳位置是发送视图。

最后，如果您仍然对客户端的视图状态不满意，您可以覆盖页面的[`SavePageStateToPersistenceMedium`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.savepagestatetopersistencemedium.aspx)和[`LoadPageStateFromPersistenceMedium`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.loadpagestatefrompersistencemedium.aspx)方法并将其保存到另一个媒体。我已经听到很多人抱怨客户端上的视图状态，大多数时候我只是告诉他们继续在服务器上实现对另一种介质的持久性......但是，我相信没有人做过，可能是因为它很复杂你最终会得到一个不那么干净的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T09:37:28.663

ViewState 在页面执行回发以将页面的控制树恢复到页面最后呈现时的状态时使用。

例如，这允许 GridView 控件在回发时保持其状态（在 GridView 中显示），而无需将其重新绑定到相同的数据。

默认情况下 ViewState 被序列化并发送到客户端的原因是（我猜）这是在客户端执行回发时获取它的最简单方法。

例如，如果用户打开了多个浏览器窗口并加载了相同的页面，并且您将视图状态存储在 Session 中怎么办？在这种情况下为不同的窗口分配正确的视图状态当然可以解决，但是让客户端明确发布它似乎是最简单的方法。

也就是说，可以将视图状态存储在 Session 中。例如见[这个链接](http://msdn.microsoft.com/en-us/library/system.web.ui.sessionpagestatepersister.aspx)。

通过实现您自己的`System.Web.UI.PageStatePersister`.

# jquery - jQuery .text 不起作用，但 .val 可以吗？

> ID：11966711
> 
> 赞同：0
> 
> 时间：2012-08-15T09:12:06.987
> 
> 标签：jquery, checkbox

我的代码在 jsfiddle 中工作，但是当我将代码实现到我的解决方案中时，它什么也没做。

当复选框被选中时，它的想法是填充一个逗号分隔的列表，其中包含已检查到 div 中的所有项目。但是，这不起作用，但它适用于 textarea 吗？

[http://jsfiddle.net/uJcB7/166/](http://jsfiddle.net/uJcB7/166/)

这是有问题的行：

```
 $('#standardFitFeatures').text(allVals) 
```

然后我给 div 然后 ID：

```
<div id="standardFitFeatures"></div> 
```

这根本不起作用，我必须创建一个 textarea 并将 .text 更改为 val

知道为什么以及如何在需要填充 div 时对其进行排序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:19:22.283

放

```
$('#cblistp input').click(updateTextArea);
 updateTextArea(); 
```

和

```
 $('#cblistStatic input').click(updateTextAreaW);
 updateTextAreaW(); 
```

`$(document).ready()`如果您想要一致的行为，请在里面

您很有可能将事件绑定到尚不存在的元素。

编辑

`.val()`适用于`TextArea`并且适用于... 请检查您是否确实在生产代码中使用了 Div 而不是 textarea `Input`。`.Text()``DIV`

# wordpress - Wordpress 和 WooCommerce，小部件太多

> ID：11966713
> 
> 赞同：0
> 
> 时间：2012-08-15T09:12:13.147
> 
> 标签：wordpress, wordpress-theming, woocommerce

我在朋友的 Wordpress 网站上使用 WooCommerce。她确实使用了自定义主题，而 WooCommerce 似乎不太喜欢它。主要问题是它在商店和产品页面上显示了一些额外的小部件。Twentyten 和 Twentyeleven 不显示小部件。关于如何在自定义主题上摆脱它们的任何建议？免责声明：我对 Wordpress 还很陌生，所以我希望它不是太明显。;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T10:28:48.600

如果在您更改主题时小部件不可用，那么您是对的，它们位于自定义模板中。它们要么在 functions.php 文件中，要么在包含文件夹中的它们自己的单独文件中。该文件将包含/需要从 functions.php 文件中。

您正在寻找的是一些如下所示的代码；

将定义一个新类，扩展`WP_Widget`类，即

```
class My_widget extends WP_Widget {
  // custom widget code in here
} 
```

然后接下来会有一个注册这个新小部件的钩子。您只需要注释掉与widgets_init 挂钩的任何行。它们将如下所示；

```
add_action('widgets_init', create_function('', 'return register_widget("My Widget");')); 
```

# java - 未检测到 XmlJavaTypeAdapter

> ID：11966714
> 
> 赞同：9
> 
> 时间：2012-08-15T09:12:18.390
> 
> 标签：java, jaxb

希望对 JAXB 专家来说很容易：

我正在尝试编组一个未定义默认无参数构造函数的*不可变类。*我已经定义了一个`XmlAdapter`实现，但似乎没有被采纳。我整理了一个简单的独立示例，但仍然无法正常工作。谁能告诉我我做错了什么？

**不可变类**

```
@XmlJavaTypeAdapter(FooAdapter.class)
@XmlRootElement
public class Foo {
  private final String name;
  private final int age;

  public Foo(String name, int age) {
    this.name = name;
    this.age = age;
  }

  public String getName() { return name; }
  public int getAge() { return age; }
} 
```

**适配器和值类型**

```
public class FooAdapter extends XmlAdapter<AdaptedFoo, Foo> {
  public Foo unmarshal(AdaptedFoo af) throws Exception {
    return new Foo(af.getName(), af.getAge());
  }

  public AdaptedFoo marshal(Foo foo) throws Exception {
    return new AdaptedFoo(foo);
  }
}

class AdaptedFoo {
  private String name;
  private int age;

  public AdaptedFoo() {}

  public AdaptedFoo(Foo foo) {
    this.name = foo.getName();
    this.age = foo.getAge();
  }

  @XmlAttribute
  public String getName() { return name; }
  public void setName(String name) { this.name = name; }

  @XmlAttribute
  public int getAge() { return age; }
  public void setAge(int age) { this.age = age; }
} 
```

**马歇尔**

```
public class Marshal {
  public static void main(String[] args) {
    Foo foo = new Foo("Adam", 34);

    try {
      JAXBContext jaxbContext = JAXBContext.newInstance(Foo.class);
      Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

      // output pretty printed
      jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

      jaxbMarshaller.marshal(foo, System.out);              
    } catch (JAXBException e) {
      e.printStackTrace();
    }   
  }
} 
```

**堆栈跟踪**

```
com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions
Foo does not have a no-arg default constructor.
        this problem is related to the following location:
                at Foo

        at com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException$Builder.check(IllegalAnnotationsException.java:91)
        at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.getTypeInfoSet(JAXBContextImpl.java:451)
        at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.<init>(JAXBContextImpl.java:283)
        at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.<init>(JAXBContextImpl.java:126)
        at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder.build(JAXBContextImpl.java:1142)
        at com.sun.xml.internal.bind.v2.ContextFactory.createContext(ContextFactory.java:130)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:248)
        at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:235)
        at javax.xml.bind.ContextFinder.find(ContextFinder.java:445)
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:637)
        at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:584)
        at Marshal2.main(Marshal2.java:11) 
```

请注意，我使用的是 JDK 1.7.0_05。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T10:08:18.597

以下内容应该有所帮助：

**FOO 作为根对象**

在`@XmlJavaTypeAdapter`类型级别指定时，它仅适用于引用该类的字段/属性，而不适用于该类的实例是 XML 树中的根对象时。这意味着您必须转换`Foo`为`AdaptedFoo`自己，并创建`JAXBContext`on`AdaptedFoo`和 not `Foo`。

**元帅**

```
package forum11966714;

import javax.xml.bind.*;

public class Marshal {
    public static void main(String[] args) {
      Foo foo = new Foo("Adam", 34);

      try {
        JAXBContext jaxbContext = JAXBContext.newInstance(AdaptedFoo.class);
        Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

        // output pretty printed
        jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

        jaxbMarshaller.marshal(new AdaptedFoo(foo), System.out);              
      } catch (JAXBException e) {
        e.printStackTrace();
      }   
    }
  } 
```

**适应食品**

您需要`@XmlRootElement`在类中添加注释`AdaptedFoo`。`Foo`您可以从类中删除相同的注释。

```
package forum11966714;

import javax.xml.bind.annotation.*;

@XmlRootElement
class AdaptedFoo {
    private String name;
    private int age;

    public AdaptedFoo() {
    }

    public AdaptedFoo(Foo foo) {
        this.name = foo.getName();
        this.age = foo.getAge();
    }

    @XmlAttribute
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @XmlAttribute
    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
} 
```

* * *

**FOO 作为嵌套对象**

当`Foo`不是根对象时，一切都按照您映射的方式工作。我已经扩展了你的模型来演示它是如何工作的。

**酒吧**

```
package forum11966714;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Bar {

    private Foo foo;

    public Foo getFoo() {
        return foo;
    }

    public void setFoo(Foo foo) {
        this.foo = foo;
    }

} 
```

**演示**

请注意，JAXB 参考实现不允许您`Foo`在引导`JAXBContext`.

```
package forum11966714;

import java.io.File;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;
import javax.xml.bind.Unmarshaller;

public class Demo {
    public static void main(String[] args) {
        try {
            JAXBContext jaxbContext = JAXBContext.newInstance(Bar.class);

            Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
            File xml = new File("src/forum11966714/input.xml");
            Bar bar = (Bar) jaxbUnmarshaller.unmarshal(xml);

            Marshaller jaxbMarshaller = jaxbContext.createMarshaller();
            jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
            jaxbMarshaller.marshal(bar, System.out);
        } catch (JAXBException e) {
            e.printStackTrace();
        }
    }
} 
```

**输入.xml/输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<bar>
    <foo name="Jane Doe" age="35"/>
</bar> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-11T15:24:31.893

我知道情况并非如此，但如果您在为该字段输入 @XmlJavaTypeAdapter 时遇到此类错误 - 请检查您是否指定了命名空间。你可能需要它。

就我而言，这不起作用：

```
@XmlElement(name = "Expiration")
@XmlJavaTypeAdapter(DateAdapter.class)
private Date expiration; 
```

直到指定命名空间：

```
@XmlElement(name = "Expiration", namespace="http://site/your.namespace")
@XmlJavaTypeAdapter(DateAdapter.class)
private Date expiration; 
```

# javascript - 实施会员系统的最简单方法是什么？

> ID：11966716
> 
> 赞同：1
> 
> 时间：2012-08-15T09:12:21.777
> 
> 标签：javascript, jquery, cookies, web, affiliate

我知道一个为我提供一些服务的网站。

如果我推荐人们从那个网站购买这项服务，我会得到越来越多的折扣。

该网站没有已建立的会员系统

我与网站沟通，

并得到了他们的回复：

> 不幸的是，目前，我们没有任何类型的联盟链接和 ID 方案在运行，但我们很想探索建立一个。你能澄清一下你的意思吗？您想要自己的电子邮件地址吗？您会将我们的网站放在您自己的网站上，以便我们跟踪您的预订？
> 
> 我们渴望与您合作，所以请告诉我们需要什么！

我怎样才能建立一个快速的会员系统（仅限我，不是通用的可扩展系统）？

跟踪像素？曲奇饼？

我对这一切都很陌生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:36:13.767

你可以这样做：
**第一个选项：**

*   `http://example.com/buy_this_service?ref=your-own-unique-ID`在野外发布链接文本。
*   告诉公司`$_GET["ref"]`在他们的`service/index.php`文件中进行跟踪。

如果有`example.com`问题的公司不能/不会做任何事情，那么你可以做：
**第二种选择：**

*   发布`http://your-own-domain.com/buy-this-amazing-service`链接文本。
*   通过记录他们的 IP、时间、位置、唯一与否等来静默跟踪每次访问。
*   重定向`http://your-own-domain.com/buy-this-amazing-service`到`http://example.com/service`

* * *

在第一种情况下，`example.com`需要在`Ref ID`访问者登陆他们的页面时立即捕获和处理，这应该是`buy-this`页面（链接指向的页面）。
因此，用户登陆、`Elad (referrer)`发送该访问者的站点记录。如果访问者购买，他们会信用`Elad`，如果没有，那么他们什么也不做。
从这里开始，无论我们的 Ref ID 是否保留在 URL 中。我们现在不需要它。该实例已被记录。

如果该站点已经在记录 IP，那么您应该要求他们使用第一种情况。或者，以一种骇人听闻的方式，在第二个选项中，在`your-domain.com/amazing-service`页面上，捕获访问者的 IP 尝试将其传递给`example.com`using`GET`方法。

# spring - spring：message，如何获取所有带有“开头”键的消息

> ID：11966718
> 
> 赞同：4
> 
> 时间：2012-08-15T09:12:43.387
> 
> 标签：spring, jsp, jstl

所以我的消息文件中有一堆消息，其中的键如下

```
alt.text1=Hello
alt.text2=Goodbye 
```

在我的 JSP 中，我可以使用

```
<spring:message code="alt.text1"/>
<spring:message code="alt.text2"/> 
```

呈现为

```
Hello Goodbye 
```

问题是，我如何获取密钥以“alt”开头的所有消息。IE 我想一次显示所有“alt”消息，但不显示文件中不以 alt 开头的任何其他消息。

我知道消息是 JSP 中的哈希图，例如，我如何访问此映射以遍历其键和值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T18:41:14.860

我最终创建了一个`CustomerMessageSource`如下并将 listAllAltLabels 的结果放在视图上。然后这是一个简单的迭代案例。

```
public class CustomMessageSource extends ReloadableResourceBundleMessageSource {

    public Map<String, String> listAllAltLabels(String basename, Locale locale) {
        Map<String, String> altLabels = new HashMap<String, String>();

        PropertiesHolder propertiesHolder = getMergedProperties(locale);
        Properties properties = propertiesHolder.getProperties();

        for(Object key : properties.keySet()){
            if(((String)key).startsWith("alt.")) {
                altLabels.put((String)key, (String)properties.get(key));
            }
        }

        return altLabels;
    } 

} 
```

我使用spring webflow（隐藏大多数控制器），但基本上在渲染页面之前在控制器/动作的某个地方，调用listAllAltLabels并将结果分配给“altLabelMessages”并将其放入模型/视图中。

然后在视图中（jsp）

```
<c:forEach items="${altLabelMessages}" var="message">
    <form:option value="${message.key}" label="${message.value}"/>
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:57:52.967

我不知道 Spring，但看起来没有[标签](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/html/spring.tld.html)可以使用 Spring 获取消息包。

如果你会使用`<fmt:setBundle/>`，你会得到一个[`LocalizationContext`](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/fmt/LocalizationContext.html)对象，其中包含一个[`ResourceBundle`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html). 不幸的[`keySet`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#keySet%28%29)是，使用表达式语言无法访问该方法。

您可以做的是在 bean 中加载消息包并创建以 开头的键列表`alt.`，或者只公开整个键集。

# android - 从同一类中的 2 个不同方法读取字符串失败，HTC 手机 API 8 上的空指针异常

> ID：11966721
> 
> 赞同：0
> 
> 时间：2012-08-15T09:12:54.743
> 
> 标签：android, string, nullpointerexception, htc-android

我有一个奇怪的问题，它只出现在某些制造商的手机上。特别是 HTC，这在我的 Samsumg S2 上运行良好。

我有两种方法：

```
public void setPref(String key) {
    prefkey = key ;
    }

public String getPref() {
    return prefkey ;
    } 
```

在开始图像选择的意图之前，我使用它们来存储共享首选项名称，然后在 onActivityResult 中读回该值，以便我可以实际将图像路径保存到正确的首选项。

问题是 setPref() 和 getPref() 方法似乎只能在单个方法中工作。因此，当我在 onPreferenceTreeClick 中 setPref(preference.getKey()) 时，该集合工作正常，并且我已经完成了 println 以显示 getPref() 在该方法中有效，但是当我在 onActivityResult 方法中运行 getPref() 时，它只返回 null（仅在 HTC 手机上），因此还附加了 catlog 输出。我的三星 S2 工作正常，返回正确的值。我在我的java中做错了吗？（注意：我没有包含一些工作代码以使其看起来更容易阅读）

```
public class Preferences extends PreferenceActivity implements SharedPreferences.OnSharedPreferenceChangeListener {

private static final int SELECT_PICTURE = 1;
private String selectedImagePath;
private String prefkey ;
private SharedPreferences preferences;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.pref);
    PreferenceManager.getDefaultSharedPreferences(this).registerOnSharedPreferenceChangeListener(this);
}

@Override
public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference) {
    // TODO Auto-generated method stub

    if (preference.toString().substring(0,3).equals("Pho")) {
        setPref(preference.getKey());
        Intent intent = new Intent();
        intent.setType("image/*");
        intent.setAction(Intent.ACTION_GET_CONTENT);
        startActivityForResult(Intent.createChooser(intent,"Select Picture"), SELECT_PICTURE);

    }

    return super.onPreferenceTreeClick(preferenceScreen, preference);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub

    if(resultCode != RESULT_CANCELED){
        if (resultCode == RESULT_OK) {

            if (requestCode == SELECT_PICTURE) {
                Uri selectedImageUri = data.getData();

                selectedImagePath = getPath(selectedImageUri);

                SharedPreferences mySharedPrefs = PreferenceManager.getDefaultSharedPreferences(getApplication());
                mySharedPrefs.edit().putString(getPref(),selectedImagePath).commit();

                super.onActivityResult(requestCode, resultCode, data);
            }

        }
    }
}

public void setPref(String key) {
        prefkey = key ;
    }

public String getPref() {
        return prefkey ;
    }
} 
```

日志猫

```
 08-14 07:05:53.371 I/System.out(19175): OnSharedPref: arg0android.app.SharedPreferencesImpl@40d843b0 arg1 null
    08-14 07:05:53.371 D/AndroidRuntime(19175): Shutting down VM
    08-14 07:05:53.371 W/dalvikvm(19175): threadid=1: thread exiting with uncaught exception (group=0x40a97a08)
    08-14 07:05:53.381 E/EmbeddedLogger(  431): App crashed! Process: org.bazza.android.testlist
    08-14 07:05:53.381 E/EmbeddedLogger(  431): App crashed! Package: org.bazza.android.testlist v1 (1.0)
    08-14 07:05:53.381 E/EmbeddedLogger(  431): Application Label: testlist
    08-14 07:05:53.381 E/AndroidRuntime(19175): FATAL EXCEPTION: main
    08-14 07:05:53.381 E/AndroidRuntime(19175): java.lang.RuntimeException: Unable to resume activity {org.bazza.android.testlist/org.bazza.android.testlist.Preferences}: java.lang.RuntimeException: Failure
    delivering result ResultInfo{who=null, request=1, result=-1, data=Intent {
    dat=content://media/external/images/media/1297 typ=image/jpeg (has extras) }}
    to activity {org.bazza.android.testlist/org.bazza.android.testlist.Preferences}: java.lang.NullPointerException
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2823)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2862)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2245)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.access$600(ActivityThread.java:139)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.os.Handler.dispatchMessage(Handler.java:99)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.os.Looper.loop(Looper.java:154)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.main(ActivityThread.java:4977)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at java.lang.reflect.Method.invokeNative(Native Method)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at java.lang.reflect.Method.invoke(Method.java:511)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at dalvik.system.NativeStart.main(Native Method)
    08-14 07:05:53.381 E/AndroidRuntime(19175): Caused by: java.lang.RuntimeException: Failure
    delivering result ResultInfo{who=null, request=1, result=-1, data=Intent 
    {dat=content://media/external/images/media/1297 typ=image/jpeg (has extras) }} to
    activity {org.bazza.android.testlist/org.bazza.android.testlist.Preferences}: java.lang.NullPointerException
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3398)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2804)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     ... 12 more
    08-14 07:05:53.381 E/AndroidRuntime(19175): Caused by: java.lang.NullPointerException
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at org.bazza.android.testlist.Preferences.onSharedPreferenceChanged(Preferences.java:172)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.SharedPreferencesImpl$EditorImpl.notifyListeners(SharedPreferencesImpl.java:455)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.SharedPreferencesImpl$EditorImpl.commit(SharedPreferencesImpl.java:441)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at org.bazza.android.testlist.Preferences.onActivityResult(Preferences.java:136)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.Activity.dispatchActivityResult(Activity.java:4747)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3394)
    08-14 07:05:53.381 E/AndroidRuntime(19175):     ... 13 more
    08-14 07:05:53.381 W/ActivityManager(  431):   Force finishing activity org.bazza.android.testlist/.Preferences
    08-14 07:05:53.411 D/ViewRootImpl(  431): @@@- disable SystemServer HW acceleration 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:07:58.230

好的，我想我可能已经找到了答案，我没有使用静态变量或方法

IE

需要是

```
private static String prefkey ; 
```

和

```
public static void setPref(String key) {
    prefkey = key ;
}
public static String getPref() {
    return prefkey ;
} 
```

这解决了我的问题。

参考下面的一些 Android 文档：

公共静态字段/方法

使数据可跨活动/服务访问的另一种方法是使用公共静态字段和/或方法。您可以从应用程序中的任何其他类访问这些静态字段。要共享一个对象，创建对象的活动会设置一个静态字段以指向该对象，任何其他想要使用该对象的活动只需访问该静态字段。

# linux - 语法错误：换行意外 node.js rpm

> ID：11966722
> 
> 赞同：5
> 
> 时间：2012-08-15T09:13:00.073
> 
> 标签：linux, node.js

我在我的 Linux Debian 服务器上运行 node.js，并且在运行 .sh 脚本尝试安装 RPM 时遇到问题。

命令是：
`curl http://npmjs.org/install.sh | sh`

该脚本是受支持的安装 RPM 包。

`-bash: sh: Syntax error: newline unexpected`

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-15T10:06:21.310

用这个：

```
curl -k https://npmjs.org/install.sh | sudo sh 
```

**注意：** [npm 包含](https://github.com/isaacs/npm/blob/master/README.md)在新版本的 node.js 中。现在无需单独安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-17T23:09:09.220

尝试：

```
curl -O https://www.npmjs.org/install.sh
sudo sh install.sh 
```

受此[启发](https://stackoverflow.com/a/15508817/3290121)。

# php - 如何使用 PHP 提示用户选择保存文件的位置？

> ID：11966724
> 
> 赞同：0
> 
> 时间：2012-08-15T09:13:07.647
> 
> 标签：php, save-dialog

当我从网上搜索答案时，大多数人建议使用 header() 函数，如下所示：

```
$testing = $_REQUEST['filename'];
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=".$testing);
header("cache-control: private");
header("pragma: private"); 
```

但是，这只会强制用户将 csv 文件下载到默认位置。

我想要做的是生成一个提示框来询问用户将文件保存在哪里，就像在 VBA 中由 Application.GetSaveAsFilename 创建的“另存为”对话框一样。

# javascript - css 和 javascript 像 iOS 照片应用一样滚动

> ID：11966726
> 
> 赞同：0
> 
> 时间：2012-08-15T09:13:18.973
> 
> 标签：javascript, css, ios, html

我想知道像iOS照片应用程序这样滚动项目的技术名称，例如，当用户以多快或多长时间滚动他/她的鼠标滚轮时被认为是一个滚动动作，然后转换到另一个部分网页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:26:54.333

它被称为动力学或动量滚动。

它不适用于鼠标滚轮，因为旧版 Microsoft Windows 鼠标滚轮是数字的，并且不提供所需的模拟输入以使操作流畅。在 OSX 上，Magic Mouse 上有模拟鼠标滚轮，但这并没有映射到 Javascript API。

但是，对于拖放，您可以使用以下内容：

[http://the-taylors.org/jquery.kinetic/](http://the-taylors.org/jquery.kinetic/)

# java - Jsoup：在html中查找没有id的元素

> ID：11966730
> 
> 赞同：0
> 
> 时间：2012-08-15T09:13:35.260
> 
> 标签：java, html, parsing, jsoup

我是 Jsoup 的新手，我正在尝试解析一个 html 文件以查找所有没有 id 的元素。到目前为止，我只有这个代码片段：

```
 Document doc = Jsoup.parse(input, null);
        for (Element el : doc.getAllElements()) {
            hasId = el.hasAttr("id");
            if (!hasId) {
                idList.add(el.tagName());
            } else {
                log.info("id:" + el.attr("id"));
            }
        } 
```

正确找到具有 id 的元素。我的问题是我只想扫描具有 id 的开始元素。我可以用 Jsoup 处理这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:24:28.357

我不确定我是否正确理解了您的问题，但我认为您只想选择所有没有`id`属性的元素。如果是这样，这应该工作：

```
doc.select("*:not([id])") 
```

jsoup 网站上有[完整的选择器列表。](http://jsoup.org/cookbook/extracting-data/selector-syntax)

***更新：***

这是一个完整的例子：

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.*;

public class Soup {
  public static void main(String[] args) {
    String data = "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"> <tr> <td class=\"reportheader\" align=\"left\" nowrap width=\"720\">Outside my Dreams</td> </tr> </table>";
    Document doc = Jsoup.parse(data);
    StringBuilder tags = new StringBuilder();
    for (Element el : doc.select("body *:not([id])")) {
      tags.append(el.tagName());
      tags.append(' ');
    }
    System.out.println(tags);
  }
} 
```

在我的机器上运行上面的代码给了我这个输出：**`table tbody tr td`**

请注意，我稍微更改了查询：`"body *:not([id])"`. `body`在前面添加排除了`<html><title></title><body> ... </body></html>`Jsoup在解析`data`字符串中的部分文档时自动添加的。

# java - Google Guice 不就是另一个工厂吗？

> ID：11966731
> 
> 赞同：8
> 
> 时间：2012-08-15T09:13:36.260
> 
> 标签：java, design-patterns, guice

我想实例化一个用户帐户。我可以使用这样的工厂：

```
public class UserFactory {
  public User newUser(UserType type) {
    if (type == UserType.FREE) return new FreeUser();
  }
}

User user = UserFactory.newUser(UserType.FREE);  //UserType.FREE is an enum 
```

现在，如果我使用 Google Guice，我必须编写一个“模块”：

```
public class UserModule extends AbstractModule {

  public voidSetType(UserType type) {
    this.type = type;
  }

  @Override 
  protected void configure() {
    if (this.type = UserType.FREE)
      bind(User.class).to(FreeUser.class);
    else bind .....
  }
} 
```

然后，这是客户端代码：

```
Injector injector = Guice.createInjector(new UserModule().setType(UserType.FREE))); 
```

我的问题是：我必须编写一个模块类，而不是编写一个工厂类。从上面的例子中，我没有看到任何优势。Module 类使用反射，它比我在工厂类中的赋值语句要慢。Module 类并不比工厂类简单。我必须维护模块，而不是维护工厂。

无论如何，真正的优势是什么？Google Guice 不就是另一个工厂类吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T10:07:23.483

您看不到优势，因为 Guice（[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)）并非旨在取代[工厂](http://en.wikipedia.org/wiki/Factory_pattern)。它可以在一定程度上发挥作用（请参阅 AssistedInject 和 Providers），但如果您的工厂中有逻辑，那么您不太可能使用 Guice 作为直接替代品。

对此，Guice 的方式是仍然拥有一个工厂，而 Guice 将注入工厂。现在 User 听起来像一个域对象，很可能不需要 Guice 注入的依赖树。如果是这样，那么工厂应该是 Guice 感知的，并且可以`Provider`为每个 User 类型获取 s，或者可以直接访问 Inject 以使用不同[`Key`](http://google-guice.googlecode.com/git/javadoc/com/google/inject/Key.html)的 s 创建 User 对象。

DI 是关于依赖树的。工厂都是关于生产对象的，而调用者不必关心该对象是如何实现的。它们有交叉，可以一起使用，但它们正在解决不同的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T14:00:01.373

Guice 绝对不仅仅是一家工厂。它旨在减少系统中构建协作者的样板，并将创建这些协作者的依赖关系的责任分离出来。其原因包括：

1.  减少样板代码（如果你做对了）
2.  依赖项是抽象的，因此可以在以下位置进行交换：
    *   测试时间 - 可以交换假/模拟/存根实现
    *   运行时 - 当功能发生变化时，可以交换替代实现。
3.  “接口隔离”和“单一职责”等设计原则考虑

正如另一个答案所说，依赖注入和工厂之间存在交叉——它们都涉及管理对象并让外部系统满足它们的依赖关系，但它们的工作方式不同。在这种情况下，您需要工厂。但是使用依赖注入，如果你有很多需要彼此正常工作的工厂，你可以有一个像 Guice 这样的依赖注入框架来管理工厂的相互依赖，而不需要大量的手动接线代码和其他样板。

我倾向于将存在的依赖关系分解为几种不同的类型，并仅考虑对某些类型进行注入。

```
+=======================+========================== ===+=====================+
| 类型 | 注意 | 注入？|
+=======================+========================== ===+=====================+
| 静态依赖 | 继承类型 | 不适用 |
+---------------------+-------------- ---+--------------------+
| 合作者 | 服务、工厂等 | 绝对 |
+---------------------+-------------- ---+--------------------+
| 配置 | 上下文 | 也许- 小心|
+---------------------+-------------- ---+--------------------+
| 耗材/数据 | 值类型 | 不使用工厂|
+=======================+========================== ===+=====================+

```

当然，没有规则是一成不变的，但一般来说，我尽量不注入值类型，除非它们被不可变地用作整个依赖对象范围的上下文。

因此，使用 User 类型作为上下文（例如，对于请求）是可以的，但前提是它是不可变的并且作为“全局上下文”提供给范围为该请求的所有对象。但如果我打算对该用户进行操作，我将使用工厂管理它，可能在另一个单独的工作流/请求中。

自动依赖注入非常适合管理协作者、服务、实用程序类——应用程序的重要组成部分。当然，您可以将其降低到微观层面，但您需要非常小心，不要对此过于疯狂，或者要意识到复杂性的权衡。是的，您的代码将变得更通用、更可重用和抽象——但效果的原因也不太明显（现在错误可能是在运行系统中更早初始化的结果），您的流程将不那么线性，并且您的代码看起来更神奇。

如果您发现自己编写的模块代码比手动接线节省的模块代码多，那么请重新考虑您的设计。

旁注： 1\. 你可以通过重构工厂和将代码连接到极致来派生 Guice 和依赖注入框架，但工厂专门用于管理特定类 - Guice 根据定义是通用的，因此不适合替换某些类型的工厂。也许是纯样板工厂。2\. 你可以使用注入来注入值类型，但你会遇到困难——值类型（域对象）可能需要合法的依赖循环，尽管 Guice 和其他人并不真正打算这样做，尽管他们支持它。你是在玩火，但在一个每个人都了解风格和方法的系统中，它可能很强大。使用时要格外小心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T20:07:19.220

你真的需要“UserType”吗？

考虑一下：

```
class FreeUser extends User {...}
class NonFreeUser extends User {...}

void configure() {
  // if Type=Free
  bind(User.class).annotatedWith(Free.class).to(FreeUser.class);
  // else
  bind(User.class).to(NonFreeUser.class)
} 
```

进而

```
class SomeClassThatNeedsAFreeUser {
   @Inject
   @Free
   private User user;

} 
```

因此，当您使用 injector.getInstance(SomeClassThatNeedsAFreeUser.class) 时，您将获得一个自动注入 FreeSUer 的实例……我认为这是一种比通过特定工厂进行紧密耦合更好的方法。

# c++ - ofstream 的“预期不合格 ID”

> ID：11966740
> 
> 赞同：1
> 
> 时间：2012-08-15T09:14:08.223
> 
> 标签：c++, ofstream

我编写了以下 C++ 程序，但在我使用的行中`out_stream.open()`，它一直告诉我有关于“未知类型名 'out_stream'”和“预期不合格 ID”的错误。

我是 C++ 新手，我想我只是从教科书中抄下来的，所以我不知道哪里错了。如果这是一个非常简单的错误，请多多包涵。

这是我的代码：

```
#include <iostream>
#include <fstream>
#include <cmath>
#include <vector>
#include <boost/random.hpp>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/normal_distribution.hpp>
#include <boost/random/uniform_int_distribution.hpp>
#include <boost/math/distributions.hpp>

std::ofstream out_stream;
out_stream.open("output.txt");

int main()
{
    std::cout<<"hello world!";
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:14:47.193

你不能这样做

```
out_stream.open("output.txt"); 
```

在函数之外。把它放在 main() 里面。

```
int main()
{
    out_stream.open("output.txt");
    std::cout<<"hello world!";
    return 0;

} 
```

# java - 网站的 API 和服务

> ID：11966742
> 
> 赞同：0
> 
> 时间：2012-08-15T09:14:17.163
> 
> 标签：java, android, web

我目前正在为一个网站开发一个应用程序，我已经获得了它的登录 API 并成功实现了这个（登录）。现在我想进一步进入网站的其余页面。我的疑问是，这些页面中的每一个都会有一个单独的 API 吗？我应该为这些页面中的每一个使用不同的 url 地址吗？

我对 HTML 或 Web 开发了解不多，对此问题的一些澄清将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:50:29.617

您应该向 Web 服务开发人员询问其文档。他们应该为您提供良好的 Web 服务文档。

通常，文档应描述访问方法、参数、响应等。

[W3School](http://www.w3schools.com/webservices/default.asp)提供了一个很好的关于 web 服务的教程。这个[链接](http://www.w3schools.com/webservices/default.asp)可以帮助你。

# java - 从性能的角度来看，选择缓冲读取器或扫描器

> ID：11966746
> 
> 赞同：4
> 
> 时间：2012-08-15T09:14:30.157
> 
> 标签：java, io

从性能优化的角度来看：在 Java 中读取文件 - 缓冲读取器或扫描器更好吗？

```
import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.logging.Level;
import java.util.logging.Logger;

public class BufferedReaderExample {   

    public static void main(String args[]) {

        //reading file line by line in Java using BufferedReader       
        FileInputStream fis = null;
        BufferedReader reader = null;

        try {
            fis = new FileInputStream("C:/sample.txt");
            reader = new BufferedReader(new InputStreamReader(fis));

            System.out.println("Reading File line by line using BufferedReader");

            String line = reader.readLine();
            while(line != null){
                System.out.println(line);
                line = reader.readLine();
            }           

        } catch (FileNotFoundException ex) {
            Logger.getLogger(BufferedReaderExample.class.getName()).log(Level.SEVERE, null, ex);
        } catch (IOException ex) {
            Logger.getLogger(BufferedReaderExample.class.getName()).log(Level.SEVERE, null, ex);

        } finally {
            try {
                reader.close();
                fis.close();
            } catch (IOException ex) {
                Logger.getLogger(BufferedReaderExample.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
  } 

Output:
Reading File line by line using BufferedReader
first line in file
second line
third line
fourth line
fifth line
last line in file 
```

扫描仪的另一种方法是..

```
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.Scanner;

/**
 * @author Javin Paul
 * Java program to read file line by line using Scanner. Scanner is a rather new
 * utility class in Java and introduced in JDK 1.5 and preferred way to read input
 * from console.
 */
public class ScannerExample {

    public static void main(String args[]) throws FileNotFoundException  {

       //Scanner Example - read file line by line in Java using Scanner
        FileInputStream fis = new FileInputStream("C:/sample.txt");
        Scanner scanner = new Scanner(fis);

        //reading file line by line using Scanner in Java
        System.out.println("Reading file line by line in Java using Scanner");

        while(scanner.hasNextLine()){
            System.out.println(scanner.nextLine());
        }

        scanner.close();
    }   

}

Output:
Reading file line by line in Java using Scanner
first line in file
second line
third line
fourth line
fifth line
last line in file 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T09:27:10.447

`BufferedReader`比`Scanner`因为它要快得多，`buffers the character`因此您不必每次要从中读取字符时都访问该文件。

Scanner 具有特殊用途，例如直接读取原始数据类型，也用于正则表达式。

我同时使用了 Scanner 和 BufferedReader，而 BufferedReader 提供了显着的快速性能。你也可以自己测试一下。

# java - 允许我的程序在不打开路由器端口的情况下进行通信

> ID：11966748
> 
> 赞同：0
> 
> 时间：2012-08-15T09:14:33.193
> 
> 标签：java, sockets, connection, ports

我正在尝试制作一个用 java 编写的测试聊天程序，以便能够发送和接收消息。它可以工作，但要接收它们，您必须打开路由器上的端口。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:52:05.677

您不能不实现在两个客户端之间路由聊天的第三方服务器。该服务器将打开所需的传入端口，并且只会转发所有内容。

# php - 代码嗅探器 SVN 预提交钩子

> ID：11966749
> 
> 赞同：0
> 
> 时间：2012-08-15T09:14:36.843
> 
> 标签：php, svn, pear, pre-commit-hook, codesniffer

我一直在尝试让代码嗅探器按照 pear 的指南充当 svn 预提交钩子。然而，虽然我 100% 确定我的代码应该是无效的，但我没有收到任何错误，并且项目提交没有问题。

除了按照梨子给出的指导，还有什么需要做的吗？

[链接到代码嗅探器上的梨指南作为预提交挂钩](http://pear.php.net/manual/en/package.php.php-codesniffer.svn-pre-commit.php)

我的 phpcs-svn-pre-commit 文件：

```
#!C:\wamp\bin\php\php5.4.3\php.exe
<?php
/**
 * A commit hook for SVN.
 *
 * PHP version 5
 *
 * @category  PHP
 * @package   PHP_CodeSniffer
 * @author    Jack Bates <ms419@freezone.co.uk>
 * @author    Greg Sherwood <gsherwood@squiz.net>
 * @copyright 2006-2011 Squiz Pty Ltd (ABN 77 084 670 600)
 * @license   http://matrix.squiz.net/developer/tools/php_cs/licence BSD Licence
 * @link      http://pear.php.net/package/PHP_CodeSniffer
 */

if (is_file(dirname(__FILE__).'/../CodeSniffer/CLI.php') === true) {
    include_once dirname(__FILE__).'/../CodeSniffer/CLI.php';
} else {
    include_once 'PHP/CodeSniffer/CLI.php';
}

define('PHP_CODESNIFFER_SVNLOOK', 'C:\Program Files (x86)\VisualSVN Server\bin\svnlook');

/**
 * A class to process command line options.
 *
 * @category  PHP
 * @package   PHP_CodeSniffer
 * @author    Jack Bates <ms419@freezone.co.uk>
 * @author    Greg Sherwood <gsherwood@squiz.net>
 * @copyright 2006-2011 Squiz Pty Ltd (ABN 77 084 670 600)
 * @license   http://matrix.squiz.net/developer/tools/php_cs/licence BSD Licence
 * @version   Release: 1.3.6
 * @link      http://pear.php.net/package/PHP_CodeSniffer
 */
class PHP_CodeSniffer_SVN_Hook extends PHP_CodeSniffer_CLI
{

    /**
     * Get a list of default values for all possible command line arguments.
     *
     * @return array
     */
    public function getDefaults()
    {
        $defaults = parent::getDefaults();

        $defaults['svnArgs'] = array();
        return $defaults;

    }//end getDefaults()

    /**
     * Processes an unknown command line argument.
     *
     * All unknown args are sent to SVN commands.
     *
     * @param string $arg    The command line argument.
     * @param int    $pos    The position of the argument on the command line.
     * @param array  $values An array of values determined from CLI args.
     *
     * @return array The updated CLI values.
     * @see getCommandLineValues()
     */
    public function processUnknownArgument($arg, $pos, $values)
    {
        $values['svnArgs'][] = escapeshellarg($arg);
        return $values;

    }//end processUnknownArgument()

    /**
     * Runs PHP_CodeSniffer over files are directories.
     *
     * @param array $values An array of values determined from CLI args.
     *
     * @return int The number of error and warning messages shown.
     * @see getCommandLineValues()
     */
    public function process($values=array())
    {
        if (empty($values) === true) {
            $values = parent::getCommandLineValues();
        }

        // Get list of files in this transaction.
        $command = PHP_CODESNIFFER_SVNLOOK.' changed '.implode(' ', $values['svnArgs']);
        $handle  = popen($command, 'r');
        if ($handle === false) {
            echo 'ERROR: Could not execute "'.$command.'"'.PHP_EOL.PHP_EOL;
            exit(2);
        }

        $contents = stream_get_contents($handle);
        fclose($handle);

        // Do not check deleted paths.
        $contents = preg_replace('/^D.*/m', null, $contents);

        // Drop the four characters representing the action which precede the path on
        // each line.
        $contents = preg_replace('/^.{4}/m', null, $contents);

        $values['standard'] = $this->validateStandard($values['standard']);
        if (PHP_CodeSniffer::isInstalledStandard($values['standard']) === false) {
            // They didn't select a valid coding standard, so help them
            // out by letting them know which standards are installed.
            echo 'ERROR: the "'.$values['standard'].'" coding standard is not installed. ';
            $this->printInstalledStandards();
            exit(2);
        }

        $phpcs = new PHP_CodeSniffer(
            $values['verbosity'],
            $values['tabWidth'],
            $values['encoding']
        );

        // Set file extensions if they were specified. Otherwise,
        // let PHP_CodeSniffer decide on the defaults.
        if (empty($values['extensions']) === false) {
            $phpcs->setAllowedFileExtensions($values['extensions']);
        }

        // Set ignore patterns if they were specified.
        if (empty($values['ignored']) === false) {
            $phpcs->setIgnorePatterns($values['ignored']);
        }

        // Set some convenience member vars.
        if ($values['errorSeverity'] === null) {
            $this->errorSeverity = PHPCS_DEFAULT_ERROR_SEV;
        } else {
            $this->errorSeverity = $values['errorSeverity'];
        }

        if ($values['warningSeverity'] === null) {
            $this->warningSeverity = PHPCS_DEFAULT_WARN_SEV;
        } else {
            $this->warningSeverity = $values['warningSeverity'];
        }

        // Initialize PHP_CodeSniffer listeners but don't process any files.
        $phpcs->setCli($this);
        $phpcs->process(array(), $values['standard'], $values['sniffs']);

        // Need double quotes around the following regex beause the vertical whitespace
        // char is not always treated correctly for whatever reason.
        foreach (preg_split("/\v|\n/", $contents, -1, PREG_SPLIT_NO_EMPTY) as $path) {
            // No need to process folders as each changed file is checked.
            if (substr($path, -1) === '/') {
                continue;
            }

            // We need to check ignore rules ourself because they are
            // not checked when processing a single file.
            if ($phpcs->shouldProcessFile($path) === false) {
                continue;
            }

            // Get the contents of each file, as it would be after this transaction.
            $command = PHP_CODESNIFFER_SVNLOOK.' cat '.implode(' ', $values['svnArgs']).' '.escapeshellarg($path);
            $handle  = popen($command, 'r');
            if ($handle === false) {
                echo 'ERROR: Could not execute "'.$command.'"'.PHP_EOL.PHP_EOL;
                exit(2);
            }

            $contents = stream_get_contents($handle);
            fclose($handle);

            $phpcs->processFile($path, $contents);
        }//end foreach

        return $this->printErrorReport(
            $phpcs,
            $values['reports'],
            $values['showSources'],
            $values['reportFile'],
            $values['reportWidth']
        );

    }//end process()

    /**
     * Prints out the usage information for this script.
     *
     * @return void
     */
    public function printUsage()
    {
        parent::printUsage();

        echo PHP_EOL;
        echo '    Each additional argument is passed to the `svnlook changed ...`'.PHP_EOL;
        echo '    and `svnlook cat ...` commands.  The report is printed on standard output,'.PHP_EOL;
        echo '    however Subversion displays only standard error to the user, so in a'.PHP_EOL;
        echo '    pre-commit hook, this script should be invoked as follows:'.PHP_EOL;
        echo PHP_EOL;
        echo '    '.basename($_SERVER['argv'][0]).' ... "$REPOS" -t "$TXN" >&2 || exit 1'.PHP_EOL;

    }//end printUsage()

}//end class

$phpcs = new PHP_CodeSniffer_SVN_Hook();
$phpcs->checkRequirements();

$numErrors = $phpcs->process();
if ($numErrors !== 0) {
    exit(1);
}

?> 
```

还有我从颠覆中提交的预提交文件：

```
#!/bin/sh

# PRE-COMMIT HOOK
#
# The pre-commit hook is invoked before a Subversion txn is
# committed.  Subversion runs this hook by invoking a program
# (script, executable, binary, etc.) named 'pre-commit' (for which
# this file is a template), with the following ordered arguments:
#
#   [1] REPOS-PATH   (the path to this repository)
#   [2] TXN-NAME     (the name of the txn about to be committed)
#
#   [STDIN] LOCK-TOKENS ** the lock tokens are passed via STDIN.
#
#   If STDIN contains the line "LOCK-TOKENS:\n" (the "\n" denotes a
#   single newline), the lines following it are the lock tokens for
#   this commit.  The end of the list is marked by a line containing
#   only a newline character.
#
#   Each lock token line consists of a URI-escaped path, followed
#   by the separator character '|', followed by the lock token string,
#   followed by a newline.
#
# The default working directory for the invocation is undefined, so
# the program should set one explicitly if it cares.
#
# If the hook program exits with success, the txn is committed; but
# if it exits with failure (non-zero), the txn is aborted, no commit
# takes place, and STDERR is returned to the client.   The hook
# program can use the 'svnlook' utility to help it examine the txn.
#
# On a Unix system, the normal procedure is to have 'pre-commit'
# invoke other programs to do the real work, though it may do the
# work itself too.
#
#   ***  NOTE: THE HOOK PROGRAM MUST NOT MODIFY THE TXN, EXCEPT  ***
#   ***  FOR REVISION PROPERTIES (like svn:log or svn:author).   ***
#
#   This is why we recommend using the read-only 'svnlook' utility.
#   In the future, Subversion may enforce the rule that pre-commit
#   hooks should not modify the versioned data in txns, or else come
#   up with a mechanism to make it safe to do so (by informing the
#   committing client of the changes).  However, right now neither
#   mechanism is implemented, so hook writers just have to be careful.
#
# Note that 'pre-commit' must be executable by the user(s) who will
# invoke it (typically the user httpd runs as), and that user must
# have filesystem-level permission to access the repository.
#
# On a Windows system, you should name the hook program
# 'pre-commit.bat' or 'pre-commit.exe',
# but the basic idea is the same.
#
# The hook program typically does not inherit the environment of
# its parent process.  For example, a common problem is for the
# PATH environment variable to not be set to its usual value, so
# that subprograms fail to launch unless invoked via absolute path.
# If you're having unexpected problems with a hook program, the
# culprit may be unusual (or missing) environment variables.
# 
# Here is an example hook script, for a Unix /bin/sh interpreter.
# For more examples and pre-written hooks, see those in
# the Subversion repository at
# http://svn.apache.org/repos/asf/subversion/trunk/tools/hook-scripts/ and
# http://svn.apache.org/repos/asf/subversion/trunk/contrib/hook-scripts/

REPOS="$1"
TXN="$2"

# Make sure that the log message contains some text.
SVNLOOK=/usr/local/bin/svnlook
$SVNLOOK log -t "$TXN" "$REPOS" | \
   grep "[a-zA-Z0-9]" > /dev/null || exit 1

# Check that the author of this commit has the rights to perform
# the commit on the files and directories being modified.
commit-access-control.pl "$REPOS" "$TXN" commit-access-control.cfg || exit 1

C:\wamp\bin\php\php5.4.3\scripts\phpcs-svn-pre-commit "$REPOS" -t "$TXN" >&2 || exit 1

# All checks passed, so allow the commit.
exit 0 
```

我对 SVN 和代码嗅探器都很陌生，所以我几乎只是在遵循指南并运行测试。任何有关使其工作的建议或提示将不胜感激:)

**更新**

我已经设法从我的 svn 钩子中得到了一些结果，但是它现在显示了一个基于脚本的错误列表。我不熟悉 SVN 所需的脚本语言，所以我不知道如何解决这些问题。

错误列表：

REPOS 不被识别为内部或外部命令

TXN 未被识别为内部或外部命令

未知命令'/usr/local/bin/svnlook'

$SVNLOOK 未被识别为内部或外部命令

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T23:15:05.097

从您的可执行文件路径 ( `C:\wamp\bin\php\php5.4.3\php.exe`) 来看，我假设您正在使用 Windows 机器。

您问题中的`pre-commit`文件看起来像 Linux Bash Shell 脚本。Bash 的语法与您在 Windows 下使用的批处理文件不同。

我建议您使用`pre-commit.tmpl`为 Windows 机器制作的文件。您的`hooks`文件夹中可能有这些。我使用的是 Linux 机器，所以很遗憾，我无法在此搜索中进一步帮助您...

钩子看起来像这样`pre-commit`（摘自[An Introduction to Subversion Hook Scripts on Windows](http://blogs.wandisco.com/2011/11/10/an-introduction-to-subversion-hook-scripts-on-windows/)）：

```
@echo off
:: Stops commits that don't include a log message of at least 6 characters.
@echo off

setlocal

rem Subversion sends through the repository path and transaction id
set REPOS=%1
set TXN=%2

svnlook log %REPOS% -t %TXN% | findstr ...... > nul
if %errorlevel% gtr 0 (goto err) else exit 0

:err
echo --------------------------------------------------------------------------- 1>&2
echo Your commit has been blocked because it didn't include a log message. 1>&2
echo Do the commit again, this time with a log message that describes your changes. 1>&2
echo --------------------------------------------------------------------------- 1>&2
exit 1 
```

# javascript - 查找孩子的序列号

> ID：11966752
> 
> 赞同：1
> 
> 时间：2012-08-15T09:14:48.333
> 
> 标签：javascript, jquery

假设我有一个给定的 html 代码：

```
<ul class="fmenu123">
    <li>city</li>
    <li>service</li>
    <li>hour</li>
</ul> 
```

在 jquery 函数`children`和选择器中有`nth-child`。但是我怎么能找到这个`ul`元素的“鼠标悬停”子元素的序列号 - 即数字`n`使得第 n 个子`ul`元素正是这个选定的元素？在jquery中找到这个最简单的方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:19:00.817

[。指数（）](http://api.jquery.com/index)

```
$(".fmenu123 li").on("mouseover", function() {
    var index = $(this).index() + 1;
    console.log("hovered element: " + index);
}); 
```

[小提琴](http://jsfiddle.net/YFuCV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:19:17.237

用 1计数`previousSibling`s `nodeType`（仅计算元素节点：我假设您想忽略文本和注释节点），直到您点击 null。

```
function getElementIndex(node) {
    var index = 0;
    while ( (node = node.previousSibling) ) {
        if (node.nodeType == 1) {
            index++;
        }
    }
    return index;
} 
```

例子：

```
$('li').on('mouseover', function() {
    var index = getElementIndex(this);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:19:18.250

您可以使用该[`.index()`](http://api.jquery.com/index/)功能，如下所示：

```
$('li').on('mouseover', function() {
    var n = $(this).index() + 1; // :nth-child() is 1-indexed, .index() is 0-indexed
    // do some stuff with n
}); 
```

# java - 使用 Log4j 记录控制器/服务（集中式记录）

> ID：11966755
> 
> 赞同：0
> 
> 时间：2012-08-15T09:14:52.953
> 
> 标签：java, logging, log4j

我不想使用这样的东西：

```
Logger.getLogger(MyClass.class).info("Info message"); 
```

每次我想记录一些东西。

我尝试实现具有以下方法的日志记录服务：

```
public void info(final Object aMessage, final Object aSender); 
```

这允许我根据发送者的类获取 Logger 实例，但它隐藏了日志源类的方法和行。

我知道诸如 AOP 或 Slf4j 之类的替代方案。第一个不是我想要的，第二个引入了类似于第一行代码的内容：

```
LoggerFactory.getLogger(HelloWorld.class).info("Info message"); 
```

所以，我关心的不是隐藏 Log4j 依赖项，而是通过整个应用程序统一日志调用，如下所示：

```
//loggingController instance was injected previously
loggingControler.info("Info message",this); 
```

有什么办法可以实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T12:38:46.100

好的，似乎至少有一种方法可以解决这个问题：

例如有 LoggingService 和 LoggingController。第一个直接使用 Log4j，第二个只是服务和整个应用程序之间的一个层。

```
public class LoggingService implements ILoggingService{

   //other methods here.

   @Override
   public void warn(final Object aMessage, final Object aSender, final Throwable aThrowable) {
       log(aMessage, aSender, Level.WARN, aThrowable);
   }

   private void log(final Object aMessage, final Object aSender, final Level aLevel, final Throwable aThrowable) {
       final String className = getClassNameBy(aSender);
       Logger.getLogger(className).log(className, aLevel, aMessage, aThrowable);
   }
}

public class LoggingController implement ILoggingController{
    //logging service is injected previously
    @Override
    public void warn(final Object aMessage, final Throwable aThrowable) {
        loggingService.warn(aMessage, this, aThrowable);
    }
} 
```

因此，在这种情况下，您允许用户使用以下命令记录某些内容：

```
loggingController.warn("A warning", null); 
```

使用这种方式：

1.  用户对底层的日志功能一无所知
2.  如果您不需要它，或者环境不允许，您总是可以提供一个虚拟记录器。
3.  日志记录功能在整个应用程序中统一
4.  类名和代码行在日志中**正确显示。**
5.  **您不能使用 Log4j 最有用的功能之一——按包/类名过滤。**

# web-applications - 如何在 glassfish 中为 Web 应用程序设置域名？

> ID：11966756
> 
> 赞同：3
> 
> 时间：2012-08-15T09:14:52.763
> 
> 标签：web-applications, glassfish

谁能告诉我有关 webapplication(struts2) 的 glassfish 服务器域名的信息。

现在我使用我的 URL 来运行 Web 应用程序是：

```
http://localhost:8080/testapplication/ 
```

我想更改此 URL 以将我的应用程序运行为：

```
http://www.testapplicaiton.com/ 
```

所以我需要帮助来更改 Glassfish 服务器中的这个域名。在此先感谢。请提供您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T15:41:32.497

使用以下内容创建文件 sun-web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sun-web-app PUBLIC
        "-//Sun Microsystems, Inc.//DTD GlassFish Application Server 3.0 Servlet 3.0//EN"
        "http://www.sun.com/software/appserver/dtds/sun-web-app_3_0-0.dtd">
<sun-web-app>
    <context-root>/</context-root>
</sun-web-app> 
```

并将其放入WEB-INF目录。这将允许您摆脱 URL 中的“testapplication”。

您还必须将端口号更改为标准。有几种方法可以做到这一点。其中之一是然后转到应用程序服务器的 Web 控制台

配置->网络配置->网络监听器

您必须为 http-listener-1 的端口参数提供 80，为 http-listener-2 的端口参数提供 443 这允许您摆脱 URL 中的端口号“8080”

（但更快的方法是在 domain.xml 配置文件中搜索“8080”并在那里更改端口号）

在这些更改之后，您的应用程序将响应 http://localhost 和 https://localhost

域名“www.testapplicaiton.com”与 Glassfish 无关。您必须使用 DNS。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-10-11T14:35:40.243

在以下路径编辑您的主机文件： c:\windows\system32\drivers\etc\hosts 文件 最后添加条目作为您的 PC IP 192.168.2.4。I ONE SPACE 后跟 www.testapplicaiton.com 并保存文件并重新启动 PC。您的 PC IP 可以在 C:\ipconfig/all 找到（按 Enter 键）记下 IPv4 IP 地址。注意：编辑时在管理员模式下启动记事本。您只能在 LAN 上而不是在 INTERNET 上测试您的网站。对于 Internet，您需要一个域 www.testapplicaiton.com 和静态 ip，然后在您的路由器上的特定端口上进行端口转发。好吧，那就出发吧！！！祝你好运2U。

# xml - 添加上一个节点值和编号

> ID：11966757
> 
> 赞同：0
> 
> 时间：2012-08-15T09:14:56.330
> 
> 标签：xml, xslt, add

我正在尝试添加`1`到先前出现的节点。其背后的逻辑是，如果之前的节点在指定的三个字段上不匹配；然后将位置设置为`1`。如果前一个节点与前一个节点匹配，则从前一个位置获取值并添加`1`。

我已经创建了 XSLT 来完成这个，但是我不知道如何添加`1`到前一个节点。

当我使用代码片段时：

```
<xsl:value-of select="preceding-sibling::orderLine/position + '1'"/> 
```

我在输出中得到的响应是：

```
<position>NaN</position> 
```

我使用的 XSLT 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:strip-space elements="*"/>
    <xsl:output indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template
        match="/order/orderLines/orderLine[sku = preceding-sibling::orderLine/sku and lineId = preceding-sibling::orderLine/lineId]"/>

    <xsl:template match="/order/orderLines">
        <xsl:for-each select="/order/orderLines/orderLine">
            <xsl:copy>
                <xsl:apply-templates select="@* | node()"/>

                <xsl:choose>

                    <xsl:when
                        test="lineId = preceding-sibling::orderLine/lineId and sku = preceding-sibling::orderLine/sku and lineTrackingUrl = preceding-sibling::orderLine/lineTrackingUrl">
                        <position>
                            <!-- THE ISSUE IS HERE -->
                            <xsl:value-of select="preceding-sibling::orderLine/position + '1'"/>
                            <!-- THE ISSUE IS HERE -->
                        </position>
                    </xsl:when>
                    <xsl:otherwise>
                        <position>1</position>
                    </xsl:otherwise>
                </xsl:choose>

            </xsl:copy>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

示例输入：

```
 <?xml version="1.0" encoding="utf-8"?>
<order>
    <orderLines>
        <orderLine>
            <lineId>4</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>4</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>4</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>4</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>3</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>3</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>3</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
        <orderLine>
            <lineId>3</lineId>
            <sku>1111111</sku>
            <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        </orderLine>
    </orderLines>
</order> 
```

如果您使用上面的示例输入，它完美地说明了为什么这不起作用：

**预期结果：**

```
<?xml version="1.0" encoding="utf-8"?>
<order>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>0</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>1</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>2</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>3</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>0</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>1</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>2</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>3</position>
    </orderLine>
</order> 
```

**实际结果：**

```
<?xml version="1.0" encoding="utf-8"?>
<order>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>0</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>1</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>2</position>
    </orderLine>
    <orderLine>
        <lineId>4</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>3</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>0</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>5</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>6</position>
    </orderLine>
    <orderLine>
        <lineId>3</lineId>
        <sku>1111111</sku>
        <lineTrackingUrl>![CDATA[1111111111]]</lineTrackingUrl>
        <position>7</position>
    </orderLine>
</order> 
```

这不起作用的原因是因为它与以前的节点匹配：

这是代码：

```
<xsl:when
    test="lineId = preceding-sibling::orderLine/lineId and sku = preceding-sibling::orderLine/sku and lineTrackingUrl = preceding-sibling::orderLine/lineTrackingUrl">
    <position>
        <xsl:value-of select="count(preceding-sibling::orderLine/lineId)"/>
    </position>
</xsl:when> 
```

你会看到那个`test`时候是`lineId = preceding-sibling::orderLine/lineId and sku = preceding-sibling::orderLine/sku and lineTrackingUrl = preceding-sibling::orderLine/lineTrackingUrl`但是实际计数的只是`preceding-sibling::orderLine/lineId`

因此，它只匹配所有 lineId，而不仅仅是与之前的具有相同 lineId、相同 Sku 和相同 TrackingUrl 的那些，以及之前的那个......等等。我如何限制这个？

**经过修改的版本**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:strip-space elements="*"/>
    <xsl:output indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template
        match="/order/orderLines/orderLine[sku = preceding-sibling::orderLine/sku and lineId = preceding-sibling::orderLine/lineId]"/>

    <xsl:template match="/order/orderLines">
        <orderLines>
        <xsl:for-each select="/order/orderLines/orderLine">
            <xsl:copy>
                <xsl:apply-templates select="@* | node()"/>               

                <xsl:choose>

                    <xsl:when
                        test="lineId = preceding-sibling::orderLine[4]/lineId and sku = preceding-sibling::orderLine[4]/sku">
                        <position>
                            <xsl:value-of select="'5'"/>
                        </position>
                    </xsl:when>
                    <xsl:when
                        test="lineId = preceding-sibling::orderLine[3]/lineId and sku = preceding-sibling::orderLine[3]/sku">
                        <position>
                            <xsl:value-of select="'4'"/>
                        </position>
                    </xsl:when>
                    <xsl:when
                        test="lineId = preceding-sibling::orderLine[2]/lineId and sku = preceding-sibling::orderLine[2]/sku">
                        <position>
                            <xsl:value-of select="'3'"/>
                        </position>
                    </xsl:when>
                    <xsl:when
                        test="lineId = preceding-sibling::orderLine[1]/lineId and sku = preceding-sibling::orderLine[1]/sku">
                        <position>
                            <xsl:value-of select="'2'"/>
                        </position>
                    </xsl:when>
                    <xsl:otherwise>
                        <position><xsl:value-of select="'1'"/></position>

                    </xsl:otherwise>
                </xsl:choose>

            </xsl:copy>
        </xsl:for-each>
        </orderLines>
    </xsl:template>
</xsl:stylesheet> 
```

是否有一种更简洁的方法来执行多个 when 语句，这只适用于 4 个项目，有没有一种方法可以为无限的项目做这件事。目前这很好，但如果需要扩展，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:16:00.857

我通过使用 count() 函数解决了这个问题，所以有问题的行如下所示：

`<xsl:value-of select="count(preceding-sibling::orderLine/lineId)"/>`

这会自动将正确的数字填充到`<position/>`

因此，这意味着整个 XSLT 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:strip-space elements="*"/>
    <xsl:output indent="yes"/>

    <xsl:variable name="start" select="'0'"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template
        match="/order/orderLines/orderLine[sku = preceding-sibling::orderLine/sku and lineId = preceding-sibling::orderLine/lineId]"/>

    <xsl:template match="/order/orderLines">
        <xsl:for-each select="/order/orderLines/orderLine">
            <xsl:copy>
                <xsl:apply-templates select="@* | node()"/>

                <xsl:choose>

                    <xsl:when
                        test="lineId = preceding-sibling::orderLine/lineId and sku = preceding-sibling::orderLine/sku and lineTrackingUrl = preceding-sibling::orderLine/lineTrackingUrl">
                        <position>
                            <xsl:value-of select="count(preceding-sibling::orderLine/lineId)"/>
                        </position>
                    </xsl:when>
                    <xsl:otherwise>
                        <position>1</position>
                    </xsl:otherwise>
                </xsl:choose>

            </xsl:copy>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

# java - 在不同屏幕分辨率上具有 MIG 布局的 Java 桌面应用程序

> ID：11966758
> 
> 赞同：1
> 
> 时间：2012-08-15T09:15:06.757
> 
> 标签：java, swing, user-interface, screen-resolution, miglayout

我正在开发一个 Java 桌面应用程序，它使用 Swing 和 MIG 布局来构建 GUI。我有很多需要“固定”屏幕位置的拖放操作（该应用程序适用于插头和插座）。目前我们只支持一种屏幕分辨率是否可以构建 GUI 以便根据屏幕分辨率以某种方式缩放？

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:25:51.873

您可以通过以下方式获得屏幕分辨率：

```
Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize(); 
```

相应地设置你的大小`JFrame`。（请记住`setSize()`仅在 Frame 上使用，而不是在具有自己的 LayoutManager 的子组件上使用）

# ruby-on-rails - 导轨控制器流

> ID：11966760
> 
> 赞同：0
> 
> 时间：2012-08-15T09:15:21.507
> 
> 标签：ruby-on-rails, ruby, oop, activerecord

嗨，我在 rails 有一个控制器，但它给了我一个错误

```
ActiveRecord::StatementInvalid in StreamsController#front_page

Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'EPOCH FROM posts.created_at) - 1327654606)/9000) desc LIMIT 15' at line 1: SELECT  `posts`.* FROM `posts`  WHERE ((`posts`.`featured` = 1 OR `posts`.`author_id` = 5)) ORDER BY (ln( 1 + posts.likes_count) +  (EXTRACT(EPOCH FROM posts.created_at) - 1327654606)/9000) desc LIMIT 15 
```

StreamsController#front_page 是：

```
def front_page
    stream_responder do
      @stream = Stream::FrontPage.new(current_user, params[:offset])
      @stream_json = PostPresenter.collection_json(@stream.stream_posts, current_user, lite?: true, include_root: false)
    end
  end 
```

和 PostPresenter

```
require File.join(File.dirname(__FILE__), '..', '..', 'lib', 'template_picker')

class PostPresenter
  include ActionView::Helpers::TextHelper
  attr_accessor :post, :current_user

  def initialize(post, current_user=nil)
    @post = post
    @current_user = current_user
    @person = @current_user.try(:person)
  end

  def self.collection_json(collection, current_user, opts={})
    collection.includes(:author => :profile).map {|post| self.new(post, current_user).as_json(opts)}
  end

  def as_json(options={})
    {
        :id => @post.id,
        :guid => @post.guid,
        :text => @post.raw_message,
        :plain_text => @post.plain_text,
        :public => @post.public,
        :featured => @post.featured,
        :created_at => @post.created_at,
        :staff_picked_at => @post.staff_picked_at,
        :interacted_at => @post.interacted_at,
        :tags => @post.tags.as_json,
        :tag_list => @post.tags.map(&:name).join(", "),
        :post_type => @post.post_type,
        :image_url => @post.image_url,
        :object_url => @post.object_url,
        :favorite => @post.favorite,
        :nsfw => @post.nsfw,
        :author => PersonPresenter.new(@post.author, current_user),
        :o_embed_cache => @post.o_embed_cache.try(:as_api_response, :backbone),
        :mentioned_people => [],
        :photos => @post.photos.map {|p| p.as_api_response(:backbone)},
        :frame_name => @post.frame_name || template_name,
        :parent => (options.fetch(:include_root, true) ? parent(options) : nil),
        :title => title,
        :next_post => next_post_path,
        :previous_post => previous_post_path,
        :screenshot_url => @post.screenshot_url,
        :screenshot_width => @post.screenshot_width,
        :screenshot_height => @post.screenshot_height,
        :show_screenshot => self.show_screenshot?,
        :has_gif => self.has_gif?,
        :conversation_id => @post.conversation_id,
        :interactions => options.fetch(:lite?, false) ? lite_interactions : heavy_interactions,
        :original => @post.original?
    }
  end

  def next_post_path
    Rails.application.routes.url_helpers.next_post_path(@post)
  end

  def previous_post_path
    Rails.application.routes.url_helpers.previous_post_path(@post)
  end

  def heavy_interactions
    PostInteractionPresenter.new(@post, current_user).as_json
  end

  def lite_interactions
    PostInteractionPresenter::Lite.new(@post, current_user).as_json
  end

  def title
    @post.text.present? ? truncate(@post.plain_text, :length => 118) : I18n.translate('posts.presenter.title', :name => @post.author.name)
  end

  def template_name #kill me, lol, I should be client side
    @template_name ||= TemplatePicker.new(@post).template_name
  end

  def parent(opts={})
    PostPresenter.new(@post.parent, current_user).as_json({:include_root => false}.merge(opts)) if @post.respond_to?(:parent) && @post.parent.present?
  end

  def show_screenshot?
    @post.screenshot_url.present? 
  end

  def has_gif?
    return false unless @post.photos.present?
    return 'gif' if @post.photos.detect{ |p| p.url && p.url.match(".gif") }.present?
  end

  protected

  def person
    @current_user.person
  end

  def user_signed_in?
    @current_user.present?
  end

end 
```

我不知道我在哪里做错了..？非常需要帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T15:59:24.610

您正在关闭查询中未打开的括号。

```
'EPOCH FROM posts.created_at) ...' 
```

# java - Java封装

> ID：11966763
> 
> 赞同：22
> 
> 时间：2012-08-15T09:15:25.890
> 
> 标签：java, oop, jakarta-ee, encapsulation

我们总是说，如果我们简单地定义变量`private`并定义 getter setter 来访问这些变量，那么数据将被封装。我的问题是，如果我们可以通过 getter 和 setter 访问变量（数据），为什么数据是隐藏的或安全的？

我用谷歌搜索了很多解释，但我什么也没找到。每个人都在他们的博客和帖子中说这是一种数据隐藏技术，但尚未解释/详细说明。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-08-15T13:48:21.993

封装不仅仅是为类定义访问器和修改器方法。它是面向对象编程的一个更广泛的概念，包括最小化类之间的相互依赖关系，它通常通过信息隐藏来实现。

封装的美妙之处*在于改变事物而不影响其用户的力量*。

在像 Java 这样的面向对象编程语言中，您可以通过使用可访问性修饰符（public、protected、private，加上没有暗示包私有的修饰符）隐藏细节来实现封装。通过这些级别的可访问性，您可以控制封装级别，级别限制越少，更改发生时的成本就越高，并且类与其他依赖类（即用户类和子类）的耦合度越高。

因此，*目标不是隐藏数据本身*，而是如何操作这些数据的实现细节。

这个想法是提供一个公共接口，您可以通过该接口访问这些数据。您可以稍后更改数据的内部表示，而不会损害类的公共接口。相反，通过暴露数据本身，您损害了封装性，因此损害了在不影响其用户的情况下改变您处理数据的方式的能力。您创建对数据本身的依赖，而不是对类的公共接口。当“改变”最终找到你时，你会为麻烦调制一杯完美的鸡尾酒。

您可能想要封装对字段的访问有几个原因。Joshua Bloch 在他的《*[Effective Java](https://en.wikipedia.org/wiki/Joshua_Bloch#Bibliography)* 》一书中的第 14 条：最小化类和成员的可访问性中提到了几个令人信服的原因，我在此引用：

*   您可以限制可以存储在字段中的值（即性别必须是 F 或 M）。
*   您可以在修改字段时执行操作（触发事件、验证等）。
*   您可以通过同步方法来提供线程安全。
*   您可以切换到新的数据表示（即计算字段、不同的数据类型）

然而，封装不仅仅是隐藏字段。在 Java 中，您可以隐藏整个类，从而隐藏整个 API 的实现细节。例如，在方法中思考`Arrays.asList()`。它返回一个`List`实现，但你不关心哪个实现，只要它满足`List`接口，对吧？将来可以更改实现而不影响该方法的用户。

## 封装之美

现在，在我看来，要理解封装，首先必须理解抽象。

例如，考虑汽车概念的抽象级别。汽车的内部实现很复杂。它们有几个子系统，如传动系统、制动系统、燃油系统等。

然而，我们已经简化了它的抽象，我们通过它们抽象的公共接口与世界上所有的汽车进行交互。我们知道所有的汽车都有一个方向盘，通过它我们可以控制方向，它们有一个踏板，当你按下它时，你可以加速汽车并控制速度，还有一个当你按下它时，它就会停下来，你有一个档位可以让您控制前进或后退的棍子。这些特性构成了汽车抽象的公共接口。早上你可以开一辆轿车，然后下车，下午开一辆 SUV，就好像它是同一件事一样。

然而，我们中很少有人知道所有这些功能是如何在后台实现的。想想汽车没有液压方向系统的时代。有一天，汽车制造商发明了它，他们决定从那时起将其放入汽车中。尽管如此，这并没有改变用户与他们交互的方式。最多，用户体验到使用定向系统的改进。像这样的改变是可能的，因为汽车的内部实现是封装的。可以在不影响其公共接口的情况下安全地进行更改。

现在，想想汽车制造商决定把油箱盖放在汽车下面，而不是放在汽车的一侧。你去买一辆这样的新车，当你用完油时，你去加油站，却找不到油箱盖。突然你意识到它在汽车下方，但你无法用气泵软管到达它。现在，我们已经破坏了公共接口契约，因此，整个世界都崩溃了，它分崩离析，因为事情没有按照预期的方式工作。像这样的改变将花费数百万美元。我们需要更换世界上所有的气泵。当我们打破封装时，我们必须付出代价。

因此，如您所见，封装的目标是最大限度地减少相互依赖并促进变化。您可以通过最小化实现细节的暴露来最大化封装。类的状态只能通过其公共接口访问。

我真的建议您阅读 Alan Snyder 的一篇名为*[Encapsulation and Inheritance in Object-Oriented Programming Languages](http://dl.acm.org/citation.cfm?id=28702)*的论文。此链接指向 ACM 上的原始论文，但我很确定您可以通过 Google 找到 PDF 副本。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-15T09:25:42.933

我理解您的问题的方式是，尽管我们将变量声明为`private`，因为可以使用 getter 和 setter 访问这些变量，但它们不是私有的。因此，这样做的意义是什么？

好吧，当使用 getter 和 setter 时，您可以限制对`private`变量的访问。

IE，

```
private int x;

public int getInt(String password){
 if(password.equals("RealPassword")){
   return x;
  }
} 
```

对于二传手也是如此。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-08-15T09:20:16.870

数据是安全的，因为您可以在 getter / setter 中执行其他逻辑，并且无法更改变量的值。想象一下，您的代码不适用于 null 变量，因此在您的 setter 中，您可以检查 null 值并分配一个默认值，即 != null。因此，无论是否有人尝试将您的变量设置为 null，您的代码仍然有效。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-15T09:17:52.893

> 我的问题是，如果我们可以通过 getter 和 setter 访问变量（数据），为什么数据是隐藏的或安全的？

您可以将逻辑封装在 getter/setter 下。例如，

```
public void setAge(int age) {
    if (age < 0) {
        this.age = 0;
    }
    else {
        this.age = age;
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-15T09:24:59.547

继续 Jigar 的回答：有几件事需要封装。

1.  **合同管理：**如果你成功了`public`，你实际上是在让任何人将其更改为他们想要的任何东西。您无法通过添加约束来保护它。您的 setter 可以确保以适当的方式修改数据。

2.  **可变性：**你不必总是有一个 setter。如果您想在对象的生命周期内保持不可变的属性。您只需将其设为私有并且没有设置器。它可能会通过构造函数设置。然后你的 getter 将只返回属性（如果它是不可变的）或属性的副本（如果属性是可变的）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-15T09:47:39.747

一般来说，getter 和 setter 对字段的封装为更改留下了更大的灵活性。

如果直接访问字段，您将陷入“愚蠢的字段”。字段只能写入和读取。访问字段时不能做任何其他事情。

使用方法时，您可以在设置/读取值时做任何您想做的事情。正如 markus 和 Jigar 所提到的，验证是可能的。此外，您可以决定某天该值是从另一个值派生的，或者如果该值发生更改，则必须执行某些操作。

> 数据是如何隐藏或安全的

通过使用 getter 和 setter，数据既不隐藏也不安全。它只是为您提供了使其安全的可能性。隐藏的是实现而不是数据。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-06T06:11:04.693

如果存在访问器和/或突变器，数据验证是您关于封装如何提供安全性的问题的主要答案。其他人使用具有故障安全功能以在 mutator 中设置默认值的示例提到了这一点。你回答说你更喜欢抛出异常，这很好，但是*当你去使用它时识别你有坏数据并不会改变你有坏数据的事实*。*因此，在修改数据之前*捕获异常不是最好的吗，即在 mutator 中进行处理？这样，除非 mutator 验证它是有效的，否则实际数据永远不会被修改，因此在出现错误数据的情况下会保留原始数据。

我自己还只是一个学生，但是我和你第一次遇到封装时的情况一样，所以我花了一些时间弄清楚。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-15T09:22:04.433

我喜欢考虑线程时的解释。如果您公开了您的字段，您的实例如何知道某个线程何时更改了它的一个字段？

做到这一点的唯一方法是封装，或者更简单的 put 为该字段提供 getter 和 setter，因此您**始终**知道并可以检查/响应字段更新，例如。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-25T07:05:57.233

封装使代码更容易被其他人重用。使用封装的另一个关键原因是接口不能声明字段，但它们可以声明方法，方法可以引用一个字段！

方法在开头用动词正确命名。如：getName()、setName()、isDying()。哪位能帮忙看代码！

# javascript - 点击浏览器“返回”按钮显示 JSON 而不是 HTML（使用 Rails 和 d3.js）

> ID：11966766
> 
> 赞同：8
> 
> 时间：2012-08-15T09:15:47.613
> 
> 标签：javascript, ruby-on-rails, json, charts, d3.js

我正在使用 d3.js JSON 回调在 Rails 中生成一个图表，如下所示：

看法

```
d3.json(document.URL, function(data){ 
    // generate chart
} 
```

控制器

```
def index
    respond_to do |format|
        format.html do
            # return the HTML
        end
        format.json do
            # return the JSON
        end
    end
end 
```

一切正常。但是，当用户离开此图表，然后使用浏览器上的“后退”按钮导航回该图表时，他们会看到 JSON 而不是 HTML。

你能建议我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-11-11T21:24:54.607

嗯，这是因为当您点击返回按钮时，浏览器正在为给定的 URL 提供最后缓存的内容。I在您的情况下，最后一个内容是 AJAX (D3) 请求的 JSON。

除了接受的答案之外，您还可以尝试其他方式 - 只需附加`.html`到页面 URL。您可以通过将此过滤器添加到控制器或`ApplicationController`：

```
 before_filter do
     if request.format == :html && !params[:format]
       redirect_to format: :html
     end
   end 
```

还有第三种标准方式，`Vary: Accept`但由于这个[Chrome 错误和](http://code.google.com/p/chromium/issues/detail?id=94369)[浏览器缓存已损坏](http://jakearchibald.com/2014/browser-cache-vary-broken/)中描述的一些问题，它可能会导致一些问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T10:21:20.240

```
d3.json(window.location.pathname + ".json" + window.location.search.substring(0), function(json){  
    // generate chart
} 
```

由于受到[这个问题](https://stackoverflow.com/questions/979975/how-to-get-the-value-from-url-parameter)的启发。

# regex - 从一行中检测特定文本并将其保存在数组中

> ID：11966771
> 
> 赞同：1
> 
> 时间：2012-08-15T09:16:07.863
> 
> 标签：regex, perl, csv, text

我有一个文本文件，它由不同的行组成，看起来像

```
Destination|203.190.242.69|reached|203.190.244.6
Destination|208.109.249.198|reached|212.142.1.1
Destination|94.75.253.170|reached|85.17.100.90
Destination|212.112.234.228|reached|4.69.143.210
Destination|80.146.246.42|reached|192.168.1.1
Destination|122.209.193.217|reached|59.128.3.65
Destination|66.77.197.179|reached|66.77.197.251
Destination|195.254.227.65|reached|213.21.128.141
Destination|125.208.8.253|reached|125.208.15.254 
```

我需要保存两个 IP 并将它们保存在不同的数组中。所以会有两个数组，一个是Destination，一个是reached。我怎样才能做到这一点。目前我已经编写了一个代码来检测IP，但这似乎不起作用。

```
while (my $line = <$in>) {
    my $traceroute;
    if ($line =~ /(^Destination)/) {
        print "DUDE\n";
        my $ip = $line =~ /(\d+\.\d+\.\d+\.\d+)$/s;
        #$traceroute = $2;
        print "$ip\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:27:28.423

这应该可以解决问题：

```
while (my $line = <DATA>) {
    if($line =~ /(^Destination)/){
        my($dest, $reach) = $line =~ /(\d+\.\d+\.\d+\.\d+)/g;
        print "$dest $reach\n";
    }
}

__DATA__
Destination|203.190.242.69|reached|203.190.244.6
Destination|208.109.249.198|reached|212.142.1.1
Destination|94.75.253.170|reached|85.17.100.90
Destination|212.112.234.228|reached|4.69.143.210
Destination|80.146.246.42|reached|192.168.1.1
Destination|122.209.193.217|reached|59.128.3.65
Destination|66.77.197.179|reached|66.77.197.251
Destination|195.254.227.65|reached|213.21.128.141
Destination|125.208.8.253|reached|125.208.15.254 
```

在标量上下文中执行正则表达式，只返回成功匹配的数量或者`0`如果它失败。将 RegEx 的结果分配给数组或变量列表会将其置于列表上下文中，RegEx 在其中返回捕获的值。/g 修饰符不仅匹配 RegEx 一次，而且匹配字符串的频率。阅读[perldoc perlretut](http://perldoc.perl.org/perlretut.html)了解更多

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T09:37:42.423

由于您想将地址保存在数组中，而以前的解决方案都没有明确这样做，所以我发布了另一个答案：

```
use strict;

my (@destination, @reached);
foreach my $line (<DATA>) {
    chomp $line;
    my @fields = split '\|', $line;
    push @destination, $fields[1];
    push @reached, $fields[3];
}

use Data::Dumper;
print "Destinations:\n".Dumper(@destination);
print "Reached:\n".Dumper(@reached);

__DATA__
Destination|203.190.242.69|reached|203.190.244.6
Destination|208.109.249.198|reached|212.142.1.1
Destination|94.75.253.170|reached|85.17.100.90
Destination|212.112.234.228|reached|4.69.143.210
Destination|80.146.246.42|reached|192.168.1.1
Destination|122.209.193.217|reached|59.128.3.65
Destination|66.77.197.179|reached|66.77.197.251
Destination|195.254.227.65|reached|213.21.128.141
Destination|125.208.8.253|reached|125.208.15.254 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T09:26:49.077

在分隔符上拆分并将项目保存在索引 1 和 3 处。

```
perl -aF'\|' -lne 'next unless $F[0] eq "Destination"; print "$F[1]|$F[3]"' input >output 
```

当然，您可能想要不同的输出格式和/或做更多的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T09:24:22.890

```
while (my $line = <$in>) {
    chomp $line;
    if ($line =~ /^Destination\|(\d+\.\d+\.\d+\.\d+)\|reached\|(\d+\.\d+\.\d+\.\d+)$/) {
        my ($d, $r) = ($1,$2);
        print "$d => $r\n";
    }
} 
```

# sql - 查询以返回每个不同列值的顶部项目

> ID：11966774
> 
> 赞同：1
> 
> 时间：2012-08-15T09:16:17.253
> 
> 标签：sql, sql-server, sql-server-2000, greatest-n-per-group

如果我有一个包含以下字段的表

```
ID, SomeFK, SomeTime 
```

我将如何编写查询返回`SomeTime`每个`SomeFK`.

所以，结果可能看起来像

```
SomeFK    Sometime
0         2012-07-05 
0         2012-07-04 
0         2012-07-03 
1         2012-07-03 
1         2012-07-02 
1         2012-07-01 
2         2012-07-03 
2         2012-07-02 
2         2012-07-01 
....etc.... 
```

返回特定项目的最新项目`SomeFK`很容易，但我只是想不出如何为上述项目做。我也觉得应该很简单！

**编辑：**

抱歉，我错过了一些关键信息。这是针对SQL2000的，所以`ROW_NUMBER()`不能用！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T09:19:54.203

```
SELECT SomeFk, SomeTime 
FROM 
    (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY SomeFK ORDER BY sometime desc) rn
    FROM yourtable
    ) v
WHERE rn<=3
ORDER BY somefk, rn 
```

对于 SQL 2000，我建议升级到受支持的平台。

但如果你坚持。

```
select *
from yourtable t1
where
    (select COUNT(*)
     from yourtable
     where somefk = t1.somefk
     and sometime>=t1.sometime
    ) <=3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:24:17.267

我想我理解正确，你可以不选择`max`SomeTime 然后分组，像这样：

```
select SomeFK, max(SomeTime) 
from Table
group by SomeFK 
```

我在这里可能不合时宜，因为我不完全确定您所说的最新是什么意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:56:36.187

基于[此链接](http://archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=SelectTopNByGroup#SQL2000) （作为对原始问题的评论提供）。一种解决方案是：

```
SELECT DISTINCT ID, SomeFK, SomeTime
FROM SomeTable t1
WHERE ID IN (SELECT TOP 3 ID
               FROM SomeTable t2
              WHERE t2.SomeFK= t1.SomeFK
              ORDER BY SomeTime DESC)
ORDER BY SomeFK, SomeTime DESC 
```

虽然我现在更喜欢接受的解决方案。

# networking - 通过 MAC 地址检查主机可用性

> ID：11966776
> 
> 赞同：2
> 
> 时间：2012-08-15T09:16:27.220
> 
> 标签：networking, ip, ethernet, osi

是否可以检查具有特定 MAC 地址的主机是否“活动”？

我不想使用第 3 层 ISO/OSI 和 ICMP ping 消息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:19:47.130

你可以做一个[`ARP Ping`](http://manpages.ubuntu.com/manpages/lucid/man8/arping.8.html). 这仅在您物理上位于同一网段时才有效。[在Wikipedia 的 ARP Ping 文章](https://en.wikipedia.org/wiki/Arping)中阅读有关此内容的更多信息。

请注意，有两种不同的实现`arping`，一种可以 ping MAC 地址以将其解析为 IP 地址，另一种则不能。iproute2 包中的实现不能满足您的需求，但[Thomas Habets 实现](http://www.habets.pp.se/synscan/programs.php?prog=arping)可以。这在[Wikipedia ARP Ping 文章中也有说明](https://en.wikipedia.org/wiki/Arping)

# webgl - 学习WebGL和three.js

> ID：11966779
> 
> 赞同：162
> 
> 时间：2012-08-15T09:16:34.247
> 
> 标签：webgl, three.js

我是新手，开始学习网络浏览器中的 3D 计算机图形。我对在浏览器中制作 3D 游戏很感兴趣。对于任何学习过 WebGL 和three.js 的人...

1.  使用three.js需要WebGL知识吗？

2.  使用 three.js 与 WebGL 相比有什么优势？

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2012-08-15T14:01:35.497

由于您有远大的抱负，因此您必须花时间学习基础知识。这不是你先学什么的问题——如果你愿意，你可以同时学习它们。（这就是我所做的。）

这意味着您需要了解：

1.  WebGL 概念
2.  三.js
3.  基本的数学概念

**三.js。**Three.js 在抽象出 WebGL 的许多细节方面做得非常出色，所以就个人而言，我建议在您的项目中使用 Three.js。但请记住，Three.js 处于*alpha*阶段，并且经常更改，因此您必须为此做好准备。大多数人通过学习示例来学习 Three.js。避免使用过时的书籍和教程，并避免链接到旧版本库的网络示例。

**WebGL。**如果你使用 Three.js，你不需要知道如何在 WebGL 中编程，你只需要了解 WebGL 的概念。这意味着，您只需要能够阅读其他人的 WebGL 代码并理解您阅读的内容。这比从头开始自己编写 WebGL 程序要容易得多。您可以使用网上的任何教程很好地学习 WebGL 概念，例如[WebGLFundamentals.org](http://webglfundamentals.org)和[Learning WebGL](http://learningwebgl.com/blog/?page_id=1217)上的初学者教程。

**数学。**同样，您至少需要了解这些概念。三本好书是：

1.  Fletcher Dunn 和 Ian Parberry[用于图形和游戏开发的 3D 数学入门](https://rads.stackoverflow.com/amzn/click/com/1568817231)

2.  [游戏和交互式应用程序的基本数学：](https://rads.stackoverflow.com/amzn/click/com/1482250926) James M. Van Verth 和 Lars M. Bishop的程序员指南

3.  Eric Lengyel[的 3D 游戏编程和计算机图形学数学](https://rads.stackoverflow.com/amzn/click/com/1435458869)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-10-25T07:51:44.377

有一个非常好的在线课程——交互式 3D 图形，位于*[https://www.udacity.com/course/cs291](https://www.udacity.com/course/cs291)* on THREE.js。本课程还包括获得实践经验的作业。它涵盖了 Three.js 和计算机图形学的所有基本概念

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-08-15T10:25:09.540

我个人的想法如下：

*   如果你有足够的时间，你可以同时学习两者，但请注意 WebGL 比 Three.js 低得多。
*   对于第一个 3d 项目，专家建议使用 Three.js 之类的库，以便习惯这些术语和一般的 3d 模型。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-02-12T12:19:13.030

无论您选择哪个方向，我建议您学习/完善您的**线性代数技能**。然后继续学习或完善您对**MVP 维度（模型视图投影）**的理解。Three.JS 可以将大部分内容抽象出来，但我认为在认真对待任何 3D 开发之前理解这些概念是关键。

当我第一次使用 OpenGL 学习 3D 编程时，我写了[一篇关于 MVP 的介绍性文章。](http://rodrigo-silveira.com/3d-programming-transformation-matrix-tutorial/)我意识到，在我能够解释这些转换矩阵是什么以及它们与各种维度/空间的关系之前，我真的根本不*知道*任何 3D 编程，尽管我可以将对象渲染到屏幕上。

由于您的目标是创建游戏，因此我认为您将从首先学习一些原始 WebGL 中受益匪浅，即使您最终使用 Three.js 之类的框架来帮助您稍后编写代码。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-06-25T23:09:46.167

> “WebGL 是 2D API 而不是 3D API”

[http://webglfundamentals.org/webgl/lessons/webgl-2d-vs-3d-library.html](http://webglfundamentals.org/webgl/lessons/webgl-2d-vs-3d-library.html)

本文描述了 WebGL 和 3d 库（如three.js）之间的根本区别。
这让我在 WebGL 或 Three.js 之间做出选择变得不费吹灰之力。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-07-18T00:23:08.570

我以前有 Unity3D 和 Papervision3D 的背景，所以我对如何处理 3D 空间有很好的理解。Three.js 是您开始学习如何处理 WebGL 项目的途径。该 api 非常好，非常强大，如果您来自其他 3D 技术，您将在很短的时间内启动并运行。

我花了很多时间研究 Threejs.org 的示例——它们有很多，而且它们非常擅长让你离开并朝着正确的方向前进。这些文档足够好，尤其是当您将它们与其他 webGL 3D api 进行比较时。

您也可以考虑从他们的应用商店（Window>App store）获取免费版本的 Unity3D 和免费的 collada（我得到它时是免费的）导出器。我发现在 Unity 中设置我的场景并将其导出到 Collada 以与 Three.js 一起使用很容易。

另外，我发布了这个与 Three.js 一起使用的名为 neo ( [http://rockonflash.com/webGL/three/neo.js](http://rockonflash.com/webGL/three/neo.js) ) 的类。只需将其添加到您的项目中，然后调用 Neo.JackIntoThree()，它就会将方法/属性添加到 Object3D 以在您的项目中使用。在调试场景等时，诸如 DrawAllAxis() 之类的东西是无价的。

尽管如此，Three.js 是一个很好的方法——它足够灵活，可以让您编写自己的着色器/对象等，并且开箱即用的强大功能可以帮助您实现目标。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-03-27T22:24:15.727

我拿起了three.js，但也跳进了GLSL，并用three.js shaderMaterial做了很多实验。一种解决方法——three.js 仍然为您抽象了大部分内容，但它也为您提供了对所有渲染（投影、动画）功能的非常干净、低级别的访问。

这样，您甚至可以按照[这个很棒的 open-gl 教程](http://www.opengl-tutorial.org/beginners-tutorials/tutorial-3-matrices/)进行学习。您不必设置矩阵、类型化数组，因为三个已经为您设置好了，并在需要时更新它们。虽然着色器，您可以从头开始编写 - 简单的颜色渲染将是两行 GLSL。还有一个用于three.js 的后处理插件，它设置了所有缓冲区、全屏四边形和制作效果所需的东西，但着色器可以非常简单地开始。

由于可编程着色器是现代 3d 图形的精髓，我希望我的回答没有漏掉重点:) 迟早，任何这样做的人都需要至少了解引擎盖下发生的事情，这是野兽的本性。此外，了解均匀空间中的第四维可能也很重要。

[这本书非常适合 WebGL。](https://rads.stackoverflow.com/amzn/click/com/0321902920)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-03T00:13:40.750

两者都学了一点，感觉了解了webgl的基础，觉得webgl的介绍就够了，然后跳进三个js。一旦您了解了 WebGL 的基本概念，这将非常容易。有用的链接：

1.  我读过的最佳介绍： [http ://dev.opera.com/articles/view/an-introduction-to-webgl/](http://dev.opera.com/articles/view/an-introduction-to-webgl/)
2.  综合教程： [http ://www.johannes-raida.de/tutorials.htm](http://www.johannes-raida.de/tutorials.htm)

# android - 文本永远不会在 SherlockActionBar 上以纵向模式显示图标

> ID：11966780
> 
> 赞同：7
> 
> 时间：2012-08-15T09:16:35.523
> 
> 标签：android, android-actionbar, actionbarsherlock

我有一个关于夏洛克操作栏的问题。在纵向模式下，无论有多少可用空间，ICS 都不会在操作栏中的菜单项旁边显示文本。旋转到横向模式会产生预期的行为（图标 + 文本）。如果我从菜单项中删除图标，它会以纵向模式显示文本（仅）。如果空间可用，是否可以在纵向模式下显示文本 + 图标？我使用下面的代码将菜单项添加到操作栏中。

```
@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    menu.add(Menu.NONE, 1, 0, "Post").setTitle("Post").setIcon(android.R.drawable.ic_menu_save).setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS | MenuItem.SHOW_AS_ACTION_WITH_TEXT);    

    return true;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T11:42:45.807

来自[https://github.com/JakeWharton/ActionBarSherlock/issues/400](https://github.com/JakeWharton/ActionBarSherlock/issues/400)：

> 在宽度小于 480dp 的任何屏幕上，您永远不会在小视图上同时看到图标和文本。这是来自本机操作栏的规则。

所以，不，即使操作栏中有空间，它也不可能在较小的屏幕上。正如您所指出的，您可以放下图标以强制显示文本。

# python - 是否可以在同一个命名空间中混合 C 和 Python？

> ID：11966781
> 
> 赞同：2
> 
> 时间：2012-08-15T09:16:40.190
> 
> 标签：python, distutils

我想编写一个 Python 包来包装我正在编写的新 C 库 - 老实说，这只是一个学习练习。我想调用这个库`spam`（当然），C 库的结构是这样的。

```
Spam/
    lib/
        foo.c
        Makefile
        libspam.a   /* Generated by Makefile */
        libspam.so  /* Generated by Makefile */ 
```

假设 foo.c 提供了一个公共函数`foo(char * bar)`。同时，我想提供一个 Python 包。我想在同一个命名空间下提供一个包装器`foo`和另一个函数，比如。是一个**Python**函数，它对then 调用执行一些检查。他们可以这样称呼`safe_foo``safe_foo`**`bar``foo`**

 **```
import spam

file='hello.txt'
foo(file)
safe_foo(file) 
```

那可能吗？

类似的情况是我开发了一个 Python 包，然后想在不破坏 API 的情况下将一个函数重新实现为 C 函数。

您可能会看到我对 Python 打包有点陌生...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:53:57.703

这样做的常用方法是在 C 模块前加上下划线（例如`_foo.so`），然后正常命名 Python 模块（例如`foo.py`）。`foo`执行导入`_foo`并包含调用 C 模块中的函数的存根。**

# python - 将系统命令转换为 python 以进行文件搜索和删除

> ID：11966785
> 
> 赞同：2
> 
> 时间：2012-08-15T09:17:33.867
> 
> 标签：python, find

我有一个 cron 作业，它使用以下命令根据文件的年龄删除文件：

```
find /path/to/file/ -type f -mmin +120|xargs -I file rm 'file' 
```

但是，我想将该命令集成到一个 python 脚本中，该脚本涉及该任务以及其他也在 cron 上运行的东西。

我知道我可以将命令按原样插入 Python 脚本中，它可能会运行 find，但是我很想知道有一种更以 Python 为中心的方式来完成此任务以及可能带来哪些其他好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T10:09:07.843

我的方法是：

```
import os
import time

def checkfile(filename):
    filestats = os.stat(filename) # Gets infromation on file.
    if time.time() - filestats.st_mtime > 120: # Compares if file modification date is more than 120 less than the current time.
        os.remove(filename) # Removes file if it needs to be removed.

path = '/path/to/folder'

dirList = os.listdir(path) # Lists specified directory.
for filename in dirList:
    checkfile(os.path.join(path, filename)) # Runs checkfile function. 
```

编辑：我测试了它，它没有用，所以我修复了代码，我可以确认它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:21:25.397

采用`os.popen()`

```
>>>os.popen("find /path/to/file/ -type f -mmin +120|xargs -I file rm 'file'") 
```

或者您可以使用该`subprocess`模块：

```
>>> from subprocess import Popen, PIPE
>>> stdout= Popen(['ls','-l'], shell=False, stdout=PIPE).communicate()
>>> print(stdout) 
```

# javascript - 实现一个 div 部分显示在另一个 div 内的底部以在鼠标悬停时完全显示

> ID：11966790
> 
> 赞同：0
> 
> 时间：2012-08-15T09:17:53.167
> 
> 标签：javascript, jquery, html, css

这是[链接](http://www.tui.in/)

当您将鼠标悬停在“TUI Exclusive Offering”下的四个图像框上时，您将获得问题标题中描述的效果。

html：

```
<div class="maindiv">
<img src="img/img.jpg" />

<div class="lower_div">

this is the lower div1<br>
this is the lower div2<br>
this is the lower div3<br>
this is the lower div4<br>
this is the lower div5<br>
this is the lower div6<br>
</div>
</div> 
```

使`lower_div`坐在底部的方法是使其位置`absolute`和`bottom 0`。但无论出于何种原因，在我的大 html 页面中，尽管它在仅包含此代码段的另一个 html 页面中确实有效，但该技术不起作用。

所以我正在寻找另一种让 div 位于底部的方法。此外，我还需要让它完全显示在鼠标悬停上。

如何实现那些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:36:51.643

**这是一个工作演示：http: [//jsfiddle.net/qbyeC/](http://jsfiddle.net/qbyeC/)**

涉及 jQuery 时，javascript 很简单。您所要做的就是为每个 maindiv 定义 mouseenter 和 mouseleave。

```
$('.maindiv').on({
    mouseenter : function(e){
        $(this).children('.lowerdiv').stop(true,false);                    
        $(this).children('.lowerdiv').animate({top:0,marginTop:0});
    },
    mouseleave : function(e){
        $(this).children('.lowerdiv').stop(true,false);
        $(this).children('.lowerdiv').animate({top:'100%',marginTop:'-40px'});
    }
});​ 
```

这将检查 lowerdiv 类并将其动画到每个事件的正确位置。注意： mouseleave 第二行的 marginTop 应该与 lowerdiv 类的 margin-top css 属性相匹配。这是当鼠标不在元素上时您希望 div 伸出的量。

应该根据自己的喜好修改 css，但这些是重要的部分：

```
.maindiv {
    overflow:hidden;
    position:relative;
}
.lowerdiv {
    position:absolute;
    width:100%;
    bottom:0px;
    top:100%;
    margin-top:-40px;
} 
```

html 代码是你的方式，除了我将 lower-div 更改为 lowerdiv 以匹配 maindiv。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:51:35.790

可能这会帮助你。

脚本

```
 $(function(){
    $(".maindiv").hover(function(){
        $(this).children('.lowerdiv').stop().animate({top:0})
    },function() {
            $(this).children('.lowerdiv').stop()..animate({top:150})
        })
 })​ 
```

HTML

```
<div class="maindiv">
    Main div content
    <div class="lowerdiv">
        lowediv content
    </div>
</div>
<div class="maindiv">
    Main div content
    <div class="lowerdiv">
        lowediv content
    </div>
</div> 
```

CSS

```
 .maindiv{
    height:200px;
    width:200px;
    background:#CCC;
    position:relative;
    overflow:hidden;
    float:left;
    margin:10px;
}
.lowerdiv{
    height:200px;
    width:200px;
    background:#797987;
    position:absolute;
    top:150px;
}​ 
```

jsfiddle - [http://jsfiddle.net/tRYTq/4/](http://jsfiddle.net/tRYTq/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:37:31.643

你需要一个消极的立场（就像他们在 tui 页面上所做的那样），从类似的东西开始

```
position:absolute;
bottom:-20px; 
```

并尝试直到合适为止。

使用 jquery，您可以执行以下操作：

```
$('.maindiv').hover(
  function () {
    $(this).find('.lower_div').stop(true, false).animate({'bottom':0});
  },
  function () {
    $(this).find('.lower_div').stop(true, false).animate({'bottom':-20});
  }
); 
```

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

当然，这样你总是必须改变你的css和js中的原始位置（-20），同时你试图找到最好的起始位置。您可以通过在动画开始之前存储 original_position 来更优雅地做到这一点，但这可能在这里很远？我对stackoverflow很陌生

# layout - Yii：如何在 main.php（配置文件）中设置布局？

> ID：11966795
> 
> 赞同：1
> 
> 时间：2012-08-15T09:18:08.707
> 
> 标签：layout, frameworks, yii

[我在 yii 框架中](https://stackoverflow.com/questions/10313930/theming-and-layout-in-yii-framework)找到了这个链接 主题和布局， 但它描述了如何在控制器中设置自定义布局。

是否可以在配置文件（main.php）中设置自定义布局？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T10:54:43.483

是的你可以 。只需将[布局](http://www.yiiframework.com/doc/api/1.1/CWebApplication#layout-detail)属性添加到您的应用程序配置中

```
'layout'=>'your_layout_name' 
```

请记住，仅当[CController 布局](http://www.yiiframework.com/doc/api/1.1/CController#layout-detail)属性设置为时才使用上述配置`null`。

# eclipse - 使用 Xtext 网格化 Acceleo

> ID：11966797
> 
> 赞同：2
> 
> 时间：2012-08-15T09:18:16.817
> 
> 标签：eclipse, eclipse-emf, xtext, acceleo

我正在进行一项旨在从输入 UML 模型生成代码（即 Java）的 Acceleo 转换。

这个 UML 模型的一些元素（即活动不透明操作）包含一些符合 Xtext 语法的文本，我想在 Acceleo 转换中获得等效的 AST Ecore 表示。

为此，我开发了一个带有方法的 Java 类，该方法将包含 DSL 摘录的字符串作为输入，并生成符合它的 Ecore 模型（参见[http://www.eclipse.org/forums/index.php/ m/901947/#msg_901947](http://www.eclipse.org/forums/index.php/m/901947/#msg_901947)了解更多详情）。我已经在一个单独的 Java 应用程序中对其进行了测试，它似乎可以正常工作。

因此，我编写了一个简单的 Acceleo 模块（即 getDSLModel），包装了该 java 类，使我能够从 DSL 文本表示中获取 Ecore 模型。

假设我的 DSL（和等效的 Ecore）包含一个名为的根元素`DSLModel`，其中包含 (0..*) 个`DSLStatement`s（这是一种简化）。在 Acceleo 中，我从包含正确 DSL 脚本的字符串调用包装器时，我注意到它正确返回了`ModelImpl`.

```
 ['statement1;statement2'.getDSLModel()/] 
```

所以 Java 服务和 Xtext 解析正在工作。

但是，如果我尝试获取模型语句，即：

```
 ['statement1;statement2'.getDSLModel().statements/] 
```

它返回一个**“无效”**字符串。所以我不能在 for 循环中使用它

因此，我尝试从模型实例调用 eAllContents() OCL 服务，即：

```
 ['statement1;statement2'.getDSLModel().eAllContents()/] 
```

它实际上返回语句列表。我不明白为什么从 Xtext 解析器返回的 Ecore 实体的功能不能正常工作。

* * *

这是将字符串转换为我的 DSL 模型（Ecore AST）实例的 Java 服务。我已经用一个独立的 Java 应用程序对其进行了测试，它工作正常！

```
 public class GetDSLModel {
 public DSLModel getDSLModel(String expression){    
    DSLStandaloneSetupGenerated dslsas = new DSLStandaloneSetupGenerated();
    Injector injector = dslsas.createInjectorAndDoEMFRegistration();
    XtextResourceSet resourceSet = injector.getInstance(XtextResourceSet.class);
    resourceSet.addLoadOption(XtextResource.OPTION_RESOLVE_ALL, Boolean.TRUE);
    Resource resource = resourceSet.createResource(URI.createURI("dummy:/example.dsl"));
    InputStream in = new ByteArrayInputStream(expression.getBytes());
    try {
        resource.load(in, resourceSet.getLoadOptions());
        DSLModel model = (DSLModel) resource.getContents().get(0);
        return model;
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;

}

} 
```

现在我需要主 Acceleo (UML2Text) 转换中的 AST，因此这里是 Acceleo 包装器

```
 [query public getDSLModel(str:String): DSLModel =  (invoke('sfg.baleno.src.mloaders.GetDSLModel','getDSLModel(java.lang.String)',Sequence{str})).oclAsType(DSLModel)/] 
```

如果运行它，这就是我得到的

```
 input: ['statement1;statement2'.getDSLModel()/]
  output: mypackage.dsl.impl.DSLModelImpl@a1c7a

  input: ['statement1;statement2'.getDSLModel().statements/]  (Syntactically VALID)
  output: invalid

  input: ['statement1;statement2'.getDSLModel().eAllContents()/]
  output: mypackage.dsl.impl.DSLStatement@e53202 (...... 
```

**更新**

在 Acceleo 主模块的 Java 类中，我添加了以下几行

```
 @Override
 public void initialize(EObject element, File folder, java.util.List<? extends Object> arguments) throws IOException {    preInitialize();
    super.initialize(element, folder, arguments);
}
@Override
public void initialize(URI modelURI, File folder, java.util.List<?> arguments) throws IOException {
    preInitialize();
    super.initialize(modelURI, folder, arguments);
}

protected void preInitialize() {
   DSLStandaloneSetup.doSetup();
} 
```

和

```
 @Override
 public void registerPackages(ResourceSet resourceSet) {
    super.registerPackages(resourceSet);
   if (!isInWorkspace(org.eclipse.uml2.uml.UMLPackage.class)) {
         resourceSet.getPackageRegistry().put(org.eclipse.uml2.uml.UMLPackage.eINSTANCE.getNsURI(), org.eclipse.uml2.uml.UMLPackage.eINSTANCE);
    }
    if (!isInWorkspace(mypackages.DSLPackage.class)) {
        resourceSet.getPackageRegistry().put(mypackages.DSLPackage.eINSTANCE.getNsURI(), mypackages.DSLPackage.eINSTANCE);
     }
   EcoreUtil.resolveAll(resourceSet);
} 
```

但它的行为仍然相同。

**更新**

在此链接中，您可以**临时**找到一个示例 EMF 工作区的压缩文件，其中包含一个 Acceleo 和一个重现该问题的 XText 项目。奇怪的是，如果你将它作为 Java 应用程序运行，它可以工作，但如果你将它作为 Acceleo 应用程序运行，它就不会......

[https://docs.google.com/open?id=0B2_ovo8IiZaZaXdNdFdPMTI4Yjg](https://docs.google.com/open?id=0B2_ovo8IiZaZaXdNdFdPMTI4Yjg)

在左上角，您应该找到一个文件菜单，您可以从中下载 zip 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T07:33:04.403

不幸的是，我对 Xtext 不太熟悉……但我相信您的问题在于您从 java 服务中加载 dsl 的方式：您正在运行的 Eclipse（“acceleo 应用程序”）的上下文中生成，但是您加载你的模型就像你是独立的一样：新的 DSLStandaloneSetup, createInjector...

我相信这种加载模型的方式为您提供了 Xtext 元模型和工厂的两个实例，使 OCL 在您尝试获取其值时无法检索特征“语句”。

我能想到的绕过这个的一种可能方法是更改​​您的服务以将任何类型的 EObject 作为参数并使用其资源集来加载您的 dsl（因此使用您在启动器中初始化的资源集，即Acceleo 使用，而不是您自己的）：

```
public DSLModel getDSLModel(String expression, EObject eObj){
    ResourceSet rSet = eObj.eResource().getResourceSet();
    [...]
} 
```

有了这个，你不应该需要你从服务中进行的第二次 Xtext 初始化......如果它不起作用，除了去 Xtext 论坛并在那里询问如何制作之外，我真的没有建议的解决方案一个可以加载 DSL 并在独立和插件化环境中工作的应用程序。

# android - Android Easy Mock 测试错误

> ID：11966801
> 
> 赞同：0
> 
> 时间：2012-08-15T09:18:47.130
> 
> 标签：android, testing, easymock

我正在使用 Easy Mock 编写测试，但出现此错误。我已经添加了所有需要的 jar 文件 Objenesis 和 Cglib。

谁能告诉我为什么我会收到这个错误？

```
 java.lang.NoClassDefFoundError: org.easymock.EasyMock
    at de.uitool.commons.api.model.IconTextActionViewFactoryImplTest.setUp(IconTextActionViewFactoryImplTest.java:26)
   at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:169)
   at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:154)
   at    android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:537)
   at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1551) 
```

我的 setUp() 方法：

```
 protected void setUp() throws Exception {
    super.setUp();
    actionHandlerProvider = EasyMock.createMock(ActionHandlerProvider.class);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T11:26:50.640

我找到了这个设置 AndroidMock 的解决方案。您可以下载所需的 jar 文件和一个 pdf，其中显示了为 android 设置模拟测试所需的步骤。

[安卓模拟](http://code.google.com/p/android-mock/)

# android - 更新 appwidget、sqlite 时出现问题

> ID：11966805
> 
> 赞同：0
> 
> 时间：2012-08-15T09:19:01.957
> 
> 标签：android, service, sqlite, widget

我在更新我的 appwidget 时遇到问题。这是一个简单的小部件，它使用服务来更新小部件并从 db (sqlite) 获取报价并将其显示在主屏幕上。

在日志中，我看到引号被插入到 db。它们由方法返回

```
List<Quote> contacts = quoteSeeker.getAllQuotes(); 
```

然后出现在日志中：

```
Log.w(LOG, "From Intent" + String.valueOf(allWidgetIds.length));
Log.w(LOG, "Direct" + String.valueOf(allWidgetIds2.length)); 
```

在那之后，警告和错误就来了。可能是什么问题？

这是来自 LOGCAT 的日志：

```
08-15 10:56:18.295: I/service jarek(3061): Called
08-15 10:56:18.335: I/JARO TEST(3061): Called
08-15 10:56:18.335: D/Insert:(3061): Inserting ..
08-15 10:56:19.280: D/Reading:(3061): Reading all contacts..
08-15 10:56:19.335: D/Name:(3061): Id: 1 ,Name: Ravi ,Phone: 9100000000
08-15 10:56:19.335: D/Name:(3061): Id: 2 ,Name: Srinivas ,Phone: 9199999999
08-15 10:56:19.335: D/Name:(3061): Id: 3 ,Name: Tommy ,Phone: 9522222222
08-15 10:56:19.340: D/Name:(3061): Id: 4 ,Name: Karthik ,Phone: 9533333333
08-15 10:56:19.340: D/Name:(3061): Id: 5 ,Name: Darek ,Phone: DAREKDAREK
08-15 10:56:19.340: D/Name:(3061): Id: 6 ,Name: Ravi ,Phone: 9100000000
08-15 10:56:19.340: D/Name:(3061): Id: 7 ,Name: Srinivas ,Phone: 9199999999
08-15 10:56:19.345: D/Name:(3061): Id: 8 ,Name: Tommy ,Phone: 9522222222
08-15 10:56:19.345: D/Name:(3061): Id: 9 ,Name: Karthik ,Phone: 9533333333
08-15 10:56:19.345: D/Name:(3061): Id: 10 ,Name: Darek ,Phone: DAREKDAREK
08-15 10:56:19.345: D/Name:(3061): Id: 11 ,Name: Ravi ,Phone: 9100000000
08-15 10:56:19.350: D/Name:(3061): Id: 12 ,Name: Srinivas ,Phone: 9199999999
08-15 10:56:19.355: D/Name:(3061): Id: 13 ,Name: Tommy ,Phone: 9522222222
08-15 10:56:19.355: D/Name:(3061): Id: 14 ,Name: Karthik ,Phone: 9533333333
08-15 10:56:19.355: D/Name:(3061): Id: 15 ,Name: Darek ,Phone: DAREKDAREK
08-15 10:56:19.360: D/Name:(3061): Id: 16 ,Name: Ravi ,Phone: 9100000000
08-15 10:56:19.365: D/Name:(3061): Id: 17 ,Name: Srinivas ,Phone: 9199999999
08-15 10:56:19.365: D/Name:(3061): Id: 18 ,Name: Tommy ,Phone: 9522222222
08-15 10:56:19.365: D/Name:(3061): Id: 19 ,Name: Karthik ,Phone: 9533333333
08-15 10:56:19.370: D/Name:(3061): Id: 20 ,Name: Darek ,Phone: DAREKDAREK
08-15 10:56:19.375: W/JARO TEST(3061): From Intent1
08-15 10:56:19.380: W/JARO TEST(3061): Direct1
08-15 10:56:19.545: D/AndroidRuntime(3061): Shutting down VM
08-15 10:56:19.545: W/dalvikvm(3061): threadid=1: thread exiting with uncaught exception (group=0x4001d7f0)
08-15 10:56:19.580: E/AndroidRuntime(3061): FATAL EXCEPTION: main
08-15 10:56:19.580: E/AndroidRuntime(3061): java.lang.RuntimeException: Unable to start service beautiful.quotes.UpdateWidgetService@4643d410 with Intent { cmp=beautiful.quotes/.UpdateWidgetService (has extras) }: java.lang.IllegalStateException: attempt to re-open an already-closed object: android.database.sqlite.SQLiteQuery (mSql = SELECT  * FROM quotes) 
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3070)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.app.ActivityThread.access$3600(ActivityThread.java:125)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2096)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.os.Looper.loop(Looper.java:123)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.app.ActivityThread.main(ActivityThread.java:4641)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at java.lang.reflect.Method.invokeNative(Native Method)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at java.lang.reflect.Method.invoke(Method.java:521)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:880)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:638)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at dalvik.system.NativeStart.main(Native Method)
08-15 10:56:19.580: E/AndroidRuntime(3061): Caused by: java.lang.IllegalStateException: attempt to re-open an already-closed object: android.database.sqlite.SQLiteQuery (mSql = SELECT  * FROM quotes) 
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.database.sqlite.SQLiteClosable.acquireReference(SQLiteClosable.java:34)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:67)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:285)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:266)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at beautiful.quotes.DBHandler.getQuotesCount(DBHandler.java:114)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at         beautiful.quotes.DBHandler.getRandomQuote(DBHandler.java:139)
08-15 10:56:19.580: E/AndroidRuntime(3061):     at                     beautiful.quotes.UpdateWidgetService.onStart(UpdateWidgetService.java:62) 
```

和代码：Android manifest.xml

```
 <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:debuggable="true">  
        <receiver android:name="BeautifulQuotesWidget">
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
            <meta-data android:name="android.appwidget.provider" 
                android:resource="@xml/beatiful_quotes" />
        </receiver>  
        <service android:name=".UpdateWidgetService"></service>    
    </application> 
```

小部件的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android" 
    android:minWidth="146dip"
    android:minHeight="72dip"
    android:updatePeriodMillis="180000"
    android:initialLayout="@layout/activity_beautiful_quotes"
/> 
```

数据库助手：

公共类 DBHandler 扩展 SQLiteOpenHelper {

```
 // All Static variables
    // Database Version
    private static final int DATABASE_VERSION = 1;
    // Database Name
    private static final String DATABASE_NAME = "QuotesManager";
    // Contacts table name
    private static final String TABLE_QUOTES = "quotes";
    // Contacts Table Columns names
    private static final String KEY_ID = "id";
    private static final String KEY_AUTHOR = "author";
    private static final String KEY_DESCR = "description";
    private static final String LOG = "BAZA TEST";

    public DBHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    // Creating Tables
    @Override
    public void onCreate(SQLiteDatabase db) {
         String CREATE_QUOTES_TABLE = "CREATE TABLE " + TABLE_QUOTES + "("
                    + KEY_ID + " INTEGER PRIMARY KEY," + KEY_AUTHOR + " TEXT,"
                    + KEY_DESCR + " TEXT" + ")";
            db.execSQL(CREATE_QUOTES_TABLE);
    }

    // Upgrading database
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_QUOTES);
        // Create tables again
        onCreate(db);
    }

    // Adding new quote
    public void addQuote(Quote quote) {
        SQLiteDatabase db = this.getWritableDatabase();
        ContentValues values = new ContentValues();
        values.put(KEY_AUTHOR, quote.getAuthor()); // Author
        values.put(KEY_DESCR, quote.getDescription()); // Description

        // Inserting Row
        db.insert(TABLE_QUOTES, null, values);
        db.close(); // Closing database connection
    }

    // Getting single quote
    public Quote getQuote(int id) {
        SQLiteDatabase db = this.getReadableDatabase();
        Log.i(LOG, "Baza danych");
        Cursor cursor = db.query(TABLE_QUOTES, new String[] { KEY_ID,
                KEY_AUTHOR, KEY_DESCR }, KEY_ID + "=?",
                new String[] { String.valueOf(id) }, null, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        Quote quote = new Quote(Integer.parseInt(cursor.getString(0)),
                cursor.getString(1), cursor.getString(2));
        // return quote
        return quote;   
    }

    // Getting All quotes
    public List<Quote> getAllQuotes() {
        List<Quote> quotesList = new ArrayList<Quote>();
        // Select All Query
        String selectQuery = "SELECT  * FROM " + TABLE_QUOTES;

        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);

        // looping through all rows and adding to list
        if (cursor.moveToFirst()) {
            do {
                Quote quote = new Quote();
                quote.setID(Integer.parseInt(cursor.getString(0)));
                quote.setAuthor(cursor.getString(1));
                quote.setDescription(cursor.getString(2));
                // Adding contact to list
                quotesList.add(quote);
            } while (cursor.moveToNext());
        }
        // return contact list
        cursor.close();
        return quotesList;  
    }

    // Getting quotes count
    public int getQuotesCount() {
          String countQuery = "SELECT  * FROM " + TABLE_QUOTES;
            SQLiteDatabase db = this.getReadableDatabase();
            Cursor cursor = db.rawQuery(countQuery, null);
            cursor.close();
            // return count
            return cursor.getCount();
    }

    // Updating single quote
    public int updateQuote(Quote quote) {
            SQLiteDatabase db = this.getWritableDatabase();
            ContentValues values = new ContentValues();
            values.put(KEY_AUTHOR, quote.getAuthor());
            values.put(KEY_DESCR, quote.getDescription());
            // updating row
            return db.update(TABLE_QUOTES, values, KEY_ID + " = ?",
                    new String[] { String.valueOf(quote.getID()) });
}

    // Deleting single quote
    public void deleteQuote(Quote quote) {
           SQLiteDatabase db = this.getWritableDatabase();
            db.delete(TABLE_QUOTES, KEY_ID + " = ?",
                    new String[] { String.valueOf(quote.getID()) });
            db.close();
    }

    //Get random quote
    public Quote getRandomQuote(){
        SQLiteDatabase db = this.getReadableDatabase();
         int counts = getQuotesCount();
         Random rn = new Random();
         int id = rn.nextInt(counts);
        Cursor cursor = db.query(TABLE_QUOTES, new String[] { KEY_ID,
                KEY_AUTHOR, KEY_DESCR }, KEY_ID + "=?",
                new String[] { String.valueOf(id) }, null, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        Quote quote = new Quote(Integer.parseInt(cursor.getString(0)),
                cursor.getString(1), cursor.getString(2));
        // return quote
        return quote;
    }
} 
```

和服务：

```
public class UpdateWidgetService extends Service {
    private static final String LOG = "JARO TEST";
    DBHandler quoteSeeker;

    @Override
    public void onStart(Intent intent, int startId) {
        Log.i(LOG, "Called");
        // Create some random data
        quoteSeeker = new DBHandler(this);
         // Inserting Contacts
       Log.d("Insert: ", "Inserting ..");
       quoteSeeker.addQuote(new Quote("Ravi", "9100000000"));
       quoteSeeker.addQuote(new Quote("Srinivas", "9199999999"));
       quoteSeeker.addQuote(new Quote("Tommy", "9522222222"));
       quoteSeeker.close();
        quoteSeeker.addQuote(new Quote("Karthik", "9533333333"));
        quoteSeeker.addQuote(new Quote("Darek", "DAREKDAREK"));

        // Reading all contacts
        Log.d("Reading: ", "Reading all contacts..");
        List<Quote> contacts = quoteSeeker.getAllQuotes();       
        for (Quote cn : contacts) {
            String log = "Id: "+cn.getID()+" ,Name: " + cn.getAuthor() + " ,Phone: " + cn.getDescription();
                // Writing Contacts to log
        Log.d("Name: ", log);
    }
        AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(this
                .getApplicationContext());

        int[] allWidgetIds = intent.getIntArrayExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS);

        ComponentName thisWidget = new ComponentName(getApplicationContext(),
                BeautifulQuotesWidget.class);

        int[] allWidgetIds2 = appWidgetManager.getAppWidgetIds(thisWidget);
        Log.w(LOG, "From Intent" + String.valueOf(allWidgetIds.length));
        Log.w(LOG, "Direct" + String.valueOf(allWidgetIds2.length));

        for (int widgetId : allWidgetIds) {
            // Create some random data
            int number = (new Random().nextInt(100));
            quoteSeeker = new DBHandler(this);
            Quote q1 = quoteSeeker.getRandomQuote();
            RemoteViews remoteViews = new RemoteViews(this
                    .getApplicationContext().getPackageName(),
                    R.layout.activity_beautiful_quotes);
            Log.w("WidgetExample", String.valueOf(number));
            // Set the text
            remoteViews.setTextViewText(R.id.author_name,
                    "Random: " + String.valueOf(q1.getAuthor()));
            remoteViews.setTextViewText(R.id.quote_descr,
                    "Descr: " + String.valueOf(q1.getDescription()));

            // Register an onClickListener
            Intent clickIntent = new Intent(this.getApplicationContext(),
                    BeautifulQuotesWidget.class);

            clickIntent.setAction(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
            clickIntent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS,
                    allWidgetIds);

            PendingIntent pendingIntent = PendingIntent.getBroadcast(getApplicationContext(), 0, clickIntent,
                    PendingIntent.FLAG_UPDATE_CURRENT);
            remoteViews.setOnClickPendingIntent(R.id.quote_descr, pendingIntent);
            appWidgetManager.updateAppWidget(widgetId, remoteViews);
        }
        stopSelf();
        super.onStart(intent, startId);
    }
} 
```

和 AppWidgetProvider

```
public class BeautifulQuotesWidget extends AppWidgetProvider{
    private static final String LOG = "service jarek";

        @Override
        public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
            // To prevent any ANR timeouts, we perform the update in a service
        // Get all ids
            ComponentName thisWidget = new ComponentName(context, BeautifulQuotesWidget.class);
            int[] allWidgetIds = appWidgetManager.getAppWidgetIds(thisWidget);

            // Build the intent to call the service
            Intent intent = new Intent(context.getApplicationContext(),
                    UpdateWidgetService.class);
            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, allWidgetIds);

            Log.i(LOG, "Called");
            //context.startService(new Intent(context, UpdateService.class));
            // Update the widgets via the service
            context.startService(intent);
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:54:08.470

专注于你的这两行`UpdateWidgetService`

```
stopSelf();
super.onStart(intent, startId); 
```

在第二行......你正在调用一个方法本身（递归）......通过调用结束你的服务之后`stopSelf`......

这就是问题所在...您正在调用您在上一行中销毁的类的方法...

希望这可以帮助...

如果您决定这回答了您的问题，请将其标记为“已接受”。这将提高您和我的声誉分数。

# redis - 如何保证多个redis实例运行在不同的核上？

> ID：11966809
> 
> 赞同：8
> 
> 时间：2012-08-15T09:19:16.630
> 
> 标签：redis

我有一个 4 核服务器，我想在上面运行 redis。为了充分利用 4 核的能力，预计会启动 4 个 redis 实例，因为 redis 被设计为单线程。

但是，我很好奇如何确保 4 个实例完全在 4 个不同的内核上运行？实例启动时如何决定它运行的核心？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-15T11:02:37.720

Redis 本身不提供这样的保证。

如果您启动 4 个实例，操作系统将必须在 4 个内核上安排 4 个不同的进程。由操作系统执行此负载平衡，优化系统性能。

现在，如果您真的想将每个实例绑定到特定的内核，现代操作系统通常会提供工具来强制执行特定 CPU 内核上的进程。

例如，在 Linux 上，您可以查看[任务](http://linux.die.net/man/8/numactl)集和[numactl](http://linux.die.net/man/1/taskset)命令。

在实践中，您需要注意这一点，因为一旦在特定内核上启动 Redis（设置 CPU 掩码），所有线程和子进程都将从该 CPU 掩码继承。所以当 Redis 会尝试触发后台保存操作，或者后台 AOF 重写时，都会严重影响 Redis 实例的性能。这是因为主 Redis 线程将与后台操作共享 CPU 内核（这通常是 CPU 消耗）。

如果你真的想玩 CPU 绑定（但这真的是个好主意吗？），你需要将 N 个 Redis 实例绑定到 N+1 个 CPU 内核，保留一​​个内核用于后台操作，并确保最多一个后台对于这些实例，操作可以同时运行。

# java - 什么时候需要使用内存数据结构而不是 SQL 查询？

> ID：11966816
> 
> 赞同：1
> 
> 时间：2012-08-15T09:19:35.170
> 
> 标签：java, algorithm, data-structures, tree, nosql

作为最终结果，我的目标是让用户能够输入文本框之类的内容，并在用户输入字母时显示各种选项。
例如，用户可以开始键入一个名称，例如`Jam`，在最近的建议下方，例如、`James`等会出现。 我知道如果我使用 SQL可以完成这项工作（尽管我猜用户必须停止编写才能执行查询；所以用户在键入*时*实际上看不到建议。对吧？）。 但就我的范围而言，我不需要使用 RDBMS，因为数据很小并且它们之间没有真正的关系。`Jameson``Jamie`
`SELECT LIKE %Jam%` *我想过使用一些 NoSQL 解决方案，以便研究这项技术（以前从未使用过），但在这种情况下，我不确定如何处理这样的设计。
我应该建立一个树来预加载存储中的所有数据吗？所以我在内存和存储中都有数据？但是，如果我使用 NoSQL 解决方案，那通常不是在内存中吗？所以我在内存中有两次相同的数据？
关于如何解决这样的问题的任何帮助？*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:38:32.743

猜测您需要一些异步 Ajax 或 JQuery[自动完成](http://jqueryui.com/demos/autocomplete/)命令来从您的数据库中获取类似的项目。

如果它的 Java Swing 看看[这个](http://www.jdocs.com/swingx/1.0/org/jdesktop/swingx/autocomplete/package-summary.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:42:50.170

根据您对原始问题的评论，我认为您的目标存在冲突。

如果你想边做边学，你就有重新发明轮子的风险。您还冒着*尝试*重新发明轮子的风险，但结果却是一个不会滚动的方形轮子。

这不一定是坏事。您可以通过这种方式学到很多东西，但是这种学习方式与您的以下陈述相冲突。

> ...我仍然不确定我应该如何不重新实现事物并遵循标准方法。例如，NoSQL 是一个很好的方法吗？

这里唯一接近标准方法的是将数据存储在服务器上，而不是客户端上。有*很多*方法可以做到这一点，如果您反对选择“似乎可以解决问题的随机库”，那么您也应该反对选择“似乎可以解决问题的随机数据库技术”。

我认为在这种情况下学习的最佳方法是构建您的软件，使其对数据如何存储在后端一无所知。这样，您可以交换文本文件、SQL dbms、NoSQL dbms 以及您可以想到的任何其他内容，而完全不影响前端代码。

*这是*很好的软件设计——前端和后端之间的松散耦合。*

# android - 我可以在我的 android 应用程序中只使用一个 BroadcastReceiver 吗？

> ID：11966820
> 
> 赞同：0
> 
> 时间：2012-08-15T09:20:12.323
> 
> 标签：android

我对广播接收器有点困惑。作为标题，我认为我的应用程序中不需要另一个 BroadcastReceiver。

或者，如果我在我的应用程序中使用一堆 BroadcastReceiver 有什么问题吗？我认为这会影响我的操作系统执行内存和性能，对吗？

感谢您的时间和热情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:27:17.190

全取决于你。您可以拥有多个`BroadcastReceiver`不同的集合`intent-filter`或使用单个广播接收器来处理所有意图过滤器。

通常最好根据意图过滤器集定义不同的接收器，这些意图过滤器应该为相关的任务组提供功能。

就像我说的，这完全取决于你。如果您有大量的意图过滤器并且您希望正确处理您的代码（基于它执行的类似任务分类），那么请使用多个接收器。否则，在单个接收器中处理几个过滤器很容易且合乎逻辑。

此外，您的应用程序的性能不会受到阻碍，因为它取决于接收器中任务的执行，而不是接收器或过滤器的数量。

提示：尝试介绍`Threads`您需要执行一些繁重工作的地方:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:27:58.490

认为类应该有一个责任。因此，如果您的 BroadcastReceiver 处理这两者`SMS`和`CALL`意图，那么请考虑拥有多个接收器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:24:00.143

您可以在应用程序上声明任意数量的广播接收器。它将影响您是否在收到的每个广播中开始执行一百万个长时间运行的后台操作。

但是您计划的应用程序真的需要所有这些接收器吗？

有一些 API 可以以编程方式启用/禁用您声明的接收器，这也可能是一个不错的选择。

**编辑：** 我想如果你自己做一点测试会更容易。

*   在您的 Eclipse 上，创建一个新的 Android 项目。
*   创建一个扩展广播接收器的类。
*   保存并关闭它。
*   现在转到清单，应用程序选项卡，应用程序节点，添加按钮，添加接收器。
*   等待 Eclipse 搜索您的应用程序并找到您刚刚创建的应用程序。
*   在接收器内部放置了一个新的 Intent 过滤器。不需要名字什么的。
*   在过滤器内放置一个动作。
*   在操作名称中，检查下拉菜单。

这些是 BroadcastReceiver 可能正在接收的所有不同操作。因此，它只是让某些应用程序更简单、更有条理地实现多个接收器，每个不同类型的动作一个接收器。或者它可能只接收两个非常相似的动作，并且将它们全部放在一个接收器中更简单。

是否有意义？

# java - 设置java日期的年份

> ID：11966822
> 
> 赞同：4
> 
> 时间：2012-08-15T09:20:17.097
> 
> 标签：java, date, calendar

我正在尝试设置 a 的年份`java.util.Date`。

我需要解析的时间戳不包括年份所以我这样做了：

```
private static final SimpleDateFormat logTimeStampFormat = 
    new SimpleDateFormat("MMM dd HH:mm:ss.SSS");

boolean isAfterRefDate (String line, Date refDate) {        
    try {
        Date logTimeStamp = logTimeStampFormat.parse(line);
        logTimeStamp.setYear(2012);      // But this is deprecated!
        return logTimeStamp.after(refDate);
    } catch (ParseException e) {
        // Handle exception
    }        
} 
```

为了避免使用不推荐使用的方法，我这样做：

```
private static final SimpleDateFormat logTimeStampFormat = 
    new SimpleDateFormat("MMM dd HH:mm:ss.SSS");

private static Calendar cal = Calendar.getInstance();

boolean isAfterRefDate (String line, Date refDate) {
    try {
        Date logTimeStamp = logTimeStampFormat.parse(line);
        cal.setTime(logTimeStamp);
        cal.set(Calendar.YEAR, 2012);
        logTimeStamp = cal.getTime();            
        return logTimeStamp.after(refDate);
    } catch (ParseException e) {
        // Handle exception
    }        
} 
```

我只是不认为这是解决这个问题的最好方法。我必须首先正确设置日历对象，然后从中取回日期对象，而之前我可以直接修改日期对象。

有人可以提出更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:23:42.717

> 有人可以提出更好的方法。

当然 - 首先尽量避免使用`Date`and `Calendar`。改用[Joda Time](http://joda-time.sf.net)，效果更好。

在 a 上设置年份`Date`本质上是模棱两可的操作 - 今年应该是什么时区？如果您将 2013 年设置为之前的 2012 年 2 月 29 日，您会期望发生什么？

使用 Joda Time 将使您的代码在您*真正*期望的数据类型方面更加清晰。如果您确实需要，您始终可以在 API 边界进行`Date`转换。`Calendar`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-20T02:44:24.990

# java.time

> 有人可以提出更好的方法吗？

是的，使用[java.time](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)类。

[Jon Skeet](https://stackoverflow.com/a/11966856/642706)的答案是正确的，但现在已经过时了，因为 Joda-Time 团队建议迁移到 java.time 类。

## `MonthDay`&`LocalTime`

我们可以将该输入字符串解析为两个单独的对象 a`MonthDay`和 a `LocalTime`。第一个显然是一个月和一个月中的一天，但没有任何年份，所以它不是一个完整的日期。第二个代表一天中的时间，但没有任何日期和任何时区。

```
String input = "Sep 21 12:34:56.123";
DateTimeFormatter f = DateTimeFormatter.ofPattern ( "MMM dd HH:mm:ss.SSS" );

MonthDay md = MonthDay.parse ( input , f );
LocalTime lt = LocalTime.parse ( input , f );

System.out.println ( "md: " + md + " | lt: " + lt ); 
```

> 医学博士：--09-21 | 时间：12:34:56.123

## `LocalDateTime`

我们可以加一年，完全搅拌，得到一个`LocalDateTime`.

```
LocalDateTime ldt = LocalDateTime.of( ld , lt ); 
```

## `ZonedDateTime`

这仍然不是一个实际的时刻，也不是时间线上的一个点。如果没有从 UTC 偏移或时区的上下文， a`LocalDateTime`就没有意义。

应用 a`ZoneId`以获得`ZonedDateTime`. 现在我们有了一个有意义的时刻，时间线上的一个点。

```
ZoneId z = ZoneId.of( "America/Montreal" );
ZonedDateTime zdt = ldt.atZone( z ); 
```

# android - Android：在丢失蓝牙连接时完成多项活动

> ID：11966828
> 
> 赞同：1
> 
> 时间：2012-08-15T09:20:42.293
> 
> 标签：android, bluetooth

我有一个应用程序，在主要活动中，用户选择了一个蓝牙设备并且应用程序连接到它。然后启动一个新活动，用户可以在其中选择不同的活动（与蓝牙设备交互的方式不同）。最后选择的活动被启动并且用户很高兴。

我的问题是，当连接丢失时，我应该以某种方式完成*活动列表*和*交互*活动......但是如何？我听说过 Intents 在活动和广播之间传递消息，甚至是 Helpers，但没有关于如何将信息从正在运行的线程传递到多个其他活动的示例。

不同的连接线程（我从 BluetoothChat 示例中借用）位于 Application 类中，因此我可以从任何活动访问写入函数。这也是我检测到丢失连接的地方。

这是我的应用程序中的相关代码：

应用程序类：

```
public class BluetoothRemoteControlApp extends Application {
    public final int BT_CONNECTION_LOST = 1;

    // . . .

    private class ConnectedThread extends Thread {
        // . . .

        public void run() {
            byte[] buffer = new byte[1024];
            int bytes;

            while (true) {
                try {
                    bytes = mmInStream.read(buffer);
                    mHandler.obtainMessage(0, bytes, -1, buffer).sendToTarget();
                } catch (IOException e) {
                    e.printStackTrace();
                    // the lost connection is detected here
                    connectionLost();
                    break;
                }
            }
        }

        // . . .
    }

    private void connectionLost() {
        Log.e("BT", "Connection lost");
        // inform that connection was lost,
        // finish all activities and (re)start device select activity again
    }
} 
```

提出不同*活动*（称为“行动”）的活动：

```
public class ActionListActivity extends ListActivity {
    ArrayList<Action> activityList = new ArrayList<Action>();

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // list of available activities, arguments: title, description and class name
        activityList.add(new Action("Accelerometer Control", "Control your robot by tilting the phone", "AccelerometerControl"));
        // . . .

        setListAdapter(new ActionListBaseAdapter(this, activityList));
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        super.onListItemClick(l, v, position, id);

        String activity = activityList.get(position).getClassName();

        try {
            Class<?> activityClass = Class.forName("com.bluetooth.activities." + activity);
            Intent intent = new Intent(ActionListActivity.this, activityClass);
            startActivity(intent);
        }
        catch(ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    // add a method here to finish the activity when connection is lost
} 
```

假设我启动了我的 AccelerometerControl 活动，要输入什么`connectionLost()`来发送消息`ActionListActivity()`，`AccelerometerControl()`以便他们完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:24:15.710

使用`startActivityOnResult`而不是 startActivity 并且当您想要完成活动时，使用具有相同请求代码的[finishActivity (int requestCode)](http://developer.android.com/reference/android/app/Activity.html#finishActivity%28int%29)`startActivityOnResult`

Edit:
Create an ArrayList of Handlers in Application and also a static BluetoothRemoteControlApp field in your Application class and instantiate this to the present Application class instance.

In each Activity create a Handler. In Activity's Onresume register this Handler with Application using static field of BluetoothRemoteControlApp.

As soon as Connection is dropped, Iterate over all the handlers and sendmessage. In all Handler's , handleMessage use finish().

In Onpause remove this handler from Application

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:36:59.157

You can set flags like `intent.addFlags( Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET );` when you launch your `Activity` after making a connection. This will allow you to unroll the back stack of Activities when you reset the task.

# adsense - 多个 adsense 发布者 id 的混合和匹配等

> ID：11966832
> 
> 赞同：1
> 
> 时间：2012-08-15T09:21:13.103
> 
> 标签：adsense, ads

有谁知道关于在网站上使用多个发布者 ID 的 adsense TOS。

一个页面是否可以有 1 个使用发布者 ID#1 的广告和另一个使用发布者 ID#2 的广告，即顶部横幅广告使用一个 pubid，底部横幅广告使用另一个 pubid

这很重要，因为我最近注意到一些非常奇怪的结果，但我想在说更多之前确定我所做的事情是“合法的”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T14:31:29.977

只要不超过每页的添加总数，您就可以在同一个站点上拥有多个 Adsence id，即使是同一个页面（我认为如果您有超过 3 个的话，额外的添加不会出现。）

周围有许多网站允许您将 Adsence 广告包含在您的内容中。看看这些：

1.  [www.weebly.com](http://www.weebly.com)
2.  [www.hubpages.com](http://www.hubpages.com)
3.  [www.triond.com](http://www.triond.com)
4.  [更多的...](http://www.webnots.com/adsense-revenue-sharing-sites.html)

> 它 100% 允许在单个页面或整个网站上使用多个发布商 ID，前提是不超过每页的广告单元总数（每页而不是每个帐户。）

[http://productforums.google.com/forum/#!topic/adsense/eBwPjDixtUY](http://productforums.google.com/forum/#!topic/adsense/eBwPjDixtUY)

> 答案是肯定的，我们确实允许这样做。但在您将广告代码与其他发布商放在同一网页或网站上之前，请记住以下几点：
> 
> *   每页的最大产品数量将保持不变。
>     
>     
> *   如果您不拥有该网站，则需要获得网站所有者的许可才能在其网页上展示您的广告。
>     
>     
> *   我们无法在帐户之间分配收入，因此产生的任何收入都将记入与被点击或查看的广告单元关联的帐户。任何展示 Google 广告的共享网站也必须遵守我们的计划政策。
>     
>     
> *   您应对出现您的广告代码的任何网页的内容负责。在将您的广告代码放置到其他发布商的网站之前，我们建议您检查该网站是否存在任何违反政策的行为。
>     
>     
> 
> 在将您的代码提供给其他发布商之前的最后一个提示 - 尝试使用我们的“允许的网站”功能来监控您的广告的展示位置并保持您的帐户信誉良好。

[http://adsense.blogspot.com/2008/07/sharing-your-ad-space.html](http://adsense.blogspot.com/2008/07/sharing-your-ad-space.html)

# php - 评论插件在 safari 上效果不佳

> ID：11966837
> 
> 赞同：0
> 
> 时间：2012-08-15T09:21:33.590
> 
> 标签：php, facebook, plugins, safari, facebook-comments

facebook 评论插件在 Safari 浏览器上不能很好地工作，它出现在侧面并且在标签中看不到它。有人知道吗？知道如何解决吗？

它的工作但即使我设置为右侧也会出现在左侧，然后在选项卡中看不到评论插件。它只发生在 Safari 浏览器中

```
 <div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
   js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/he_IL/all.js#xfbml=1&appId=*****";
  fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

    <img src="image.jpg"/><br/>

   <div class="fb-comments" data-href="the link..." data-num-posts="5" data-width="800" align="right"></div> 
```

重要的是要注意它在所有其他浏览器中都能很好地工作谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T01:29:29.697

在 Safari 5.1.5 中对我来说似乎工作正常。我不会尝试添加`align`为 fb 插件元素的属性。

尝试这样的事情：

```
<div align="right">
  <div class="fb-comments" data-href="the link..." data-num-posts="5" data-width="800"></div>
</div> 
```

您的 HTML 可能比您在问题中包含的内容更复杂，因此可能会发布屏幕截图和更多 HTML。

# objective-c - 有没有办法在 Interface Builder/storyboard 中自动调整 UIImageView 的大小？

> ID：11966838
> 
> 赞同：19
> 
> 时间：2012-08-15T09:21:33.867
> 
> 标签：objective-c, xcode, uiimageview

在 storyboard 或 interface builder 中为 uiimageview 设置图像时，它会保留原来的形状`UIImageView`，这意味着图像本身是完全扭曲的。

为了匹配`UIImageView`其图像的大小，我必须从文件检查器中手动输入大小。

有没有一种方法`UIImageView`可以自动检测其图像的原始大小并相应地调整其自身的大小？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-15T10:00:36.190

我假设您指的是故事板/IB 中的布局。要获得图像的原始大小，只需选择图像并按键盘上的**Command** + **= 。**按比例重新调整大小选择角并在重新调整大小时按住 shift 键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T09:40:55.293

为什么不在代码中设置 uiimageview 的大小？这是你需要做的...

```
//get the Image
UIImage *img = [UIImage imageNamed:@"img.png"];

CGFloat x = img.origin.x;
CGFloat y = img.origin.y;
CGFloat width = img.size.width;
CGFloat height = img.size.height;
imageView.frame = CGRectMake(x, y, width, height);  //imageView is your uiimageview's reference 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T09:39:05.263

使用 contentMode

```
imageView.contentMode = UIViewContentModeScaleAspectFit; 
```

**编辑**：我刚刚看到您似乎想将 imageViews 大小调整为图像....不同

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2015-10-28T19:03:34.103

这就是我所做的：

```
imageView.clipsToBounds = YES;
[imageView setContentMode: UIViewContentModeScaleAspectFit]; 
```

这对我有用。

# json - Spring json @ResponseBody - 返回一个命名变量

> ID：11966839
> 
> 赞同：0
> 
> 时间：2012-08-15T09:21:33.933
> 
> 标签：json, spring, spring-mvc, datatables

我有一个 Spring 控制器方法，它正确地将 JSON 中的对象集合返回给客户端：

```
@RequestMapping(value="/admin/rawreads/unknowntags", method=RequestMethod.GET)
public @ResponseBody Collection<RawRead> getRawReadsWithUnknownTag() {
    ....
} 
```

我正在尝试集成一个名为 DataTables 的 jQuery 插件/插件。DataTables 可以为我处理获取数据并在页面中填充表格的异步请求，但是它需要以具有特定名称“aaData”而不是当前格式的数组返回数据：

```
[{"oid":149452,"date":1233076733000,"readerId":"811210008","recordNo":226,"tagCode":"0103A003C0","reader":null,"guard":null,"checkpoint":null},{"oid":149453,"date":1233076734000,"readerId":"8112100 .... etc] 
```

来自 DataTable 文档的 DataTables 的建议返回格式：

```
{
 "sEcho": 1,
 "iTotalRecords": "n",
 "iTotalDisplayRecords": "n",
 "aaData": [
 [object1][object2].... etc
 ]
} 
```

如何更改我的 Java 方法以返回 DataTables 所需格式的数据 - 命名数组？

编辑：尝试将 vars 放入 HashMap 服务器端，更接近我需要的东西：

```
{"iTotalDisplayRecords":3050,"iTotalRecords":3050,"aaData":   
  [{"oid":149452,"date":1233076733000, ...<snip>},{...}]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:45:01.840

为数据表创建一个正确格式的单独类，包含 sEcho、itotalrecords、ittotaldisplayrecords 的字段，然后是一个名为 aaData 的数组。

然后通过 jason 返回此类，然后采用您建议的格式。

```
class TableDTO
{
 int sEcho;
 int iTotalRecords;
 int itotalDisplayRecords;

 array[] aaData;
} 
```

显然将数据分配给这些字段和适当的访问器等！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:37:39.067

您必须再编写一个 TotalDisplayRecords 类，并且它必须包含数组 oid 类。之后，您返回 TotalDisplayRecords 对象。

# python - PID 处理 Python 暂停状态

> ID：11966842
> 
> 赞同：0
> 
> 时间：2012-08-15T09:22:06.683
> 
> 标签：python, subprocess, pid

有没有办法确定进程/PID 是否处于暂停状态？

当前`Popen("kill -STOP "+str(pid),shell=True)`用于暂停进程。

确定给定 pid 是否处于暂停状态的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:34:07.707

您可以阅读`/proc/:pid/stat`或`/proc/:pid/status`，例如：

```
Name:   python
State:  T (stopped) 
```

# c - 读取 wav 文件，计算持续时间 / data_size 总是错误的

> ID：11966844
> 
> 赞同：3
> 
> 时间：2012-08-15T09:22:12.273
> 
> 标签：c, linux, wav, duration, wave

我正在尝试读取由 ffmpeg 生成的 wav 文件

ffmpeg -i av

FFmpeg 生成一个头大小为 18 但没有任何扩展数据的 wav 文件。

这是我的数据结构：

```
struct wav_header {
  uint32_t chunk_id;
  uint32_t chunk_data_size;
  uint32_t riff_type;
  uint32_t fmt;
  uint32_t fmt_chunk_size;
  uint16_t format_tag;
  uint16_t channels;
  uint32_t samples_per_second;
  uint32_t bytes_per_second;
  uint16_t block_align;         /* 1 => 8-bit mono, 2 => 8-bit stereo or 16-bit mono, 4 => 16-bit stereo */
  uint16_t bits_per_sample;
};

struct fact_header {
  uint32_t chunk_id;
  uint32_t chunk_data_size;
  uint32_t sample_length;
};

struct data_header {
  uint32_t id;
  uint32_t size;
}; 
```

如果我把它们读出来，我会得到我的 wav 文件的以下结果：

```
chunk_data_size: 40836134

ftm_chunk_size: 18
channels: 2
samples_per_second (samplerate): 48000
bytes_per_second: 192000
block_align: 4
bits_per_sample: 16

data_id: 61746164    -> 'data' OK
data_size: 40836096 
```

我现在尝试使用公式计算以秒为单位的长度

```
data_size / bytes_per_second 
```

并获得以下输出：

```
length_in_seconds: 212.68800354
length_in_minutes: 3.54480004    (length_in_seconds / 60) 
```

但是当我在 iTunes 中打开我的文件时，我得到的长度是 3:31。我也尝试过使用其他声音文件，但我总是有点过分。

我还尝试过对我的 wav 文件进行 hexdump。与我执行 for (i < data_size; i += 2) printf("%02x", data[i]) 相比，hexdump 显示的输出更少

所以我不知何故读得太远了？

我在整个互联网上搜索了有关公式的信息，但我有点卡住了，因为我总是得出相同的结果。

[http://www-mmsp.ece.mcgill.ca/documents/audioformats/wave/wave.html](http://www-mmsp.ece.mcgill.ca/documents/audioformats/wave/wave.html)

您可以阅读以下声明：

“WAVE 文件通常具有在声音数据（数据块）之前或之后的信息块。一些程序（天真地）假设对于 PCM 数据，文件头正好是 44 字节长，并且文件的其余部分包含声音数据。这不是一个安全的假设。”

这可能是我做错了什么。但是我怎样才能得到正确的 sound_chuck_data_size 呢？

**编辑**

lile *gcb*在下面指出一切都很好。解决方案是时间以十进制时间存储，我必须将其转换为常规时间:-) 这就是我想出的，它工作正常：

```
track.duration_dec = (float)data.size / (header.bytes_per_second * 60);
track.duration_time = convert_time(track.duration_dec);

static double convert_time(double input) {
  double integral;
  double frac;
  char buffer[48];
  frac = modf(input, &integral);
  sprintf(buffer, "%d.%1.f", (int)integral, frac*60);
  return atof(buffer);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:34:37.123

对我来说这听起来不错。所以你的歌是3.54480004。如前所述，这是十进制的。所以你有 3 分钟，然后是 0.54480004 * 60，即 33.28 秒。所以我会说 3.33 分钟长

# iphone - 使用 facebook api for ios sdk 的问题

> ID：11966847
> 
> 赞同：3
> 
> 时间：2012-08-15T09:22:27.073
> 
> 标签：iphone, objective-c, facebook, api

我已经从源 [代码下载了源项目。](http://www.mobisoftinfotech.com/blog/wp-content/uploads/2010/02/FacebookAPI.zip)

我在那里遇到了很多问题，然后我更改了源头路径然后在项目设置中更改了编译器版本，然后所有这些都解决了，现在没有错误，它运行了，当我单击 FBLoginButton 时，出现了 Facebook 登录对话框但是看起来很空，![空的](../Images/60e08ba2c3322401f6e5697bac403e1d.png)

我不知道为什么，应用程序密钥和应用程序密钥放置正确。我用设备试过，如果模拟器有问题，看起来还是一样的。我做错了什么，我搜索了很多，没有找到任何解决方案，请告诉我任何想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T13:16:14.020

我也有同样的问题。我在这里开了一个bug：[https](https://developers.facebook.com/bugs/279606225487338) ://developers.facebook.com/bugs/279606225487338 你也可以投票给它，这样FB可以看看。让我们希望他们解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T10:11:19.997

我们在应用程序商店中有两个应用程序，它们使用 facebook 的这个旧 api 登录，他们也 g=已经停止工作......所以很可能 Facebook 已经停止支持这个，但我不喜欢任何官方的东西。我想我们将不得不合并新的 Api .. :/ 如果我找到一些东西，我会在这里发布......

# progress-4gl - 是否可以在事务中将记录写为 NO-UNDO？

> ID：11966849
> 
> 赞同：0
> 
> 时间：2012-08-15T09:22:34.980
> 
> 标签：progress-4gl, openedge, 4gl

我们正在做一些日志记录问题，我们需要在数据库中写入日志。但是该进程在事务中运行并且通过回滚是我们的新日志也被删除。我可以从事务中写入数据库吗？类似于使用 NO-UNDO 选项在 temptable 中写入...？新的日志仍然保留在数据库中......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T10:59:17.320

另一种可能性是使用应用服务器。应用服务器会话上的事务独立于原始会话中的事务（这就是可选和冗余的“DISTINCT TRANSACTION”语法的全部意义所在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:11:03.500

另一种选择是使用简单的消息传递系统。一个非常容易设置和使用的选项是 STOMP。它是平台中立的，非常容易上手。

Julian Lyndon-Smith 大约一个月前在 PEG 上发布了以下内容，它确实像他所说的那样易于设置和使用（我已经尝试过了，我使用了 ApacheMQ，它也非常易于设置和使用）：

> 继在波士顿和芬兰的演讲之后，dot.r 很高兴地宣布开源 Stomp 项目立即可用。
> 
> 从[http://www.dotr.com](http://www.dotr.com)或 [https://bitbucket.org/jmls/stomp](https://bitbucket.org/jmls/stomp)下载，dot.r stomp 程序允许您将进度会话连接到连接到相同的任何其他应用程序或服务消息代理。
> 
> 支持 Stomp 的开源免费消息代理有：
> 
> **保险丝**
> 
> (http://fusesource.com/products/fuse-mq-enterprise/) [现在归红帽公司所有的 Progress 公司] Fuse MQ Enterprise 是一个基于标准的开源消息传递平台，其部署占用空间非常小。无需支付许可费用，再加上可与任何开发环境一起使用的高性能、可靠消息传递，提供了一种支持随处集成的解决方案
> 
> **活动MQ**
> 
> Apache ActiveMQ (tm) (http://activemq.apache.org/) 是最流行和最强大的开源消息传递和集成模式服务器。Apache ActiveMQ 速度快，支持许多跨语言客户端和协议，带有易于使用的企业集成模式和许多高级特性，同时完全支持 JMS 1.1 和 J2EE 1.4。
> 
> Apache ActiveMQ 在 Apache 2.0 许可下发布。
> 
> **兔MQ**
> 
> RabbitMQ 是一个消息代理。主要思想非常简单：它接受和转发消息。您可以将其视为邮局：当您将邮件发送到邮箱时，您很确定邮递员先生最终会将邮件递送给您的收件人。使用这个比喻 RabbitMQ 是一个邮箱、一个邮局和一个邮递员。
> 
> RabbitMQ 和邮局之间的主要区别在于它不处理纸张，而是接受、存储和转发二进制数据块 - 消息。
> 
> * * *
> 
> 请随时在 [https://bitbucket.org/jmls/stomp](https://bitbucket.org/jmls/stomp)问题系统上记录任何问题，并 fork 项目以提交您要添加的所有新功能......
> 
> dot.r Stomp 使用宽松的 MIT 许可证 (http://en.wikipedia.org/wiki/MIT_License)
> 
> 玩得开心，享受！
> 
> 朱利安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:05:04.813

我认为在 ABL 中没有任何方法可以按照您的计划有效地（在整个地方喷洒临时表刷新或其他花絮）或可靠地（如果应用程序因未刷新的临时崩溃而崩溃-表？），正如其他人所提到的。我建议通过使数据库异步写入来减少复杂的日志记录与您的应用程序的耦合，如果可能的话，发生在您的应用程序之外。

由于您使用的是 Windows，因此您可以更改日志记录以使用 .NET [log4net](http://logging.apache.org/log4net/)库而不是 ABL 构造。log4net 有一些有用的[附加程序：](http://logging.apache.org/log4net/release/config-examples.html)

*   [AdoNetAppender](http://logging.apache.org/log4net/release/sdk/log4net.Appender.AdoNetAppender.html)可让您直接登录到数据库
*   [RemoteSyslogAppender](http://logging.apache.org/log4net/release/sdk/log4net.Appender.RemoteSyslogAppender.html)使用 syslog 协议，让您登录到外部 Unix syslog 或[rsyslog](http://www.rsyslog.com/doc/manual.html)守护进程（rsyslog 支持将日志消息写入数据库）
*   [UDPAppender](http://logging.apache.org/log4net/release/sdk/log4net.Appender.UdpAppender.html)通过 UDP 数据包将日志消息发送到其他要处理的地方（例如，支持[写入数据库的](http://www.moonlit-software.com/logfaces/web/features/index.php#database)[logFaces](http://www.moonlit-software.com)服务器）

如果您必须在 ABL 中执行此操作，那么您可以使用专门为您的日志消息 ( `OUTPUT TO STREAM`) 命名的输出流，该输出流写入外部进程正在侦听以处理它的特定位置。该文件可能是由类似的东西创建的管道，`mkfifo`或者只是一个常规文本文件，用于监视更改`inotify`（不确定这些 Windows 等效项是什么）。这个外部进程将处理解析消息并将它们写入数据库（基本上是重新发明 rsyslog）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T10:05:11.380

对数据库的每次更改都必须是事务的一部分。如果您没有显式启动一个，它将为您隐式启动，并作用于具有事务功能的下一个外部块。

但是，尽管我不建议您使用子事务。您可以通过在事务范围内显式指定 DO TRANSACTION 来调用子事务。虽然数据库永远不会知道它，但客户端可以回滚子事务，而数据库可以提交事务。

但是为了实现这样的东西，你必须掌握事务范围、块行为和错误处理的概念。

真正的重男轻女。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T14:23:48.320

将您的日志条目写入不可撤消的临时表。当代码将提交事务或事务不活动时（transactionID = ？）让您的代码写出日志条目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-15T18:56:28.350

我喜欢 no-undo temp-table 的想法，只要确保将数据库写入部分放在“FINALLY”块中，以防出现未处理的异常。

# iphone - 无法将网点连接到信息

> ID：11966851
> 
> 赞同：0
> 
> 时间：2012-08-15T09:22:36.060
> 
> 标签：iphone, view, uiview, porting

我正在将一个应用程序从 iPad 移植到 iPhone，使其具有通用性。我有一个带有列表对象的 tableView，然后是一个包含每个对象信息的视图。在 iPad 上一切正常，我为 iPhone 制作了一个新的 tableview，它也可以工作。

不起作用的是对象的信息不会显示在 iPhone 的视图中。我有一些图像、标签和文本视图连接到一些网点。这些由 AppDelegate “填充”。我可以连接插座，但它们不显示信息。控制台中没有出现错误。

有人有什么建议吗？

编辑：删除了“med”（错字，挪威人踢了）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:43:19.423

您可能还没有设置表视图的委托和/或数据源。要么以编程方式执行此操作，要么从 IB 链接它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:34:50.923

您是否尝试添加 NSLogs 以确保在您填充它们时插座不为空？如果您尝试在加载视图本身之前填充插座，那么插座当时为零。

# jvm - 关于java语法的问题

> ID：11966861
> 
> 赞同：0
> 
> 时间：2012-08-15T09:24:05.240
> 
> 标签：jvm, java

这是代码：

```
public class EmployeeTest
{
    public static void main(String args[]){
    //System.out.println("hello world");

    Employee aEmployee = new Employee("David",1000);
    System.out.println(aEmployee.getName() + aEmployee.getSalary());
    }
}

class Employee // **why can't I put a "public" here**
{
    // Constructor
    public Employee(String name, double salary)
    {
        this.name = name;
        this.salary = salary;
    }

    // Methods
    public String getName()
    {
        return this.name;
    }

    public double getSalary()
    {
        return this.salary;
    }

    // instance field
    private String name;
    private double salary;
} 
```

我的问题是：在第二类定义的第一行，为什么我不能放一个“**公共**”来定义它？当使用它定义一个类时，“public”的确切含义是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:26:03.227

因为一个Java源文件最多只能有一个顶级`public`类或接口，而且源文件的名称必须与该类或接口的名称相同。

这是 Oracle JDK 的 Java 编译器强加的规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T09:26:10.250

这是语言特性。每个 .java 文件必须只有一个`top-level`公共类，并且公共类名必须*与*源 java 文件名匹配。

基本上，*非公共类型在**包*之外是不可访问的，因此如果您希望允许在任何地方使用类型，那么将其设为*public*。

永远不要在默认包中创建类型。（[始终使用包](http://docs.oracle.com/javase/tutorial/java/package/packages.html)）

雇员.java

* * *

```
package com.abc.model;

public class Employee{..} 
```

EmployeeTest.java

* * *

```
package com.abc.test;

public class EmployeeTest{ ... } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T09:27:27.443

在 Java 中，每个源文件只能有一个*公共*顶级类，并且它需要与文件命名相同。

当编译器需要从包外部定位类定义时，这对编译器很有用，因为它知道类型名称，它知道在哪个类文件中找到该类。例如。由于 jar 文件本质上是一个带有类文件的 zip 文件，因此编译器不必解压缩整个 jar 文件来查找类定义。

[Java 语言规范 §7.6 将此](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.6)指定为可选限制；

> *当且仅当包存储在文件系统中（第 7.2 节）时，如果在由类型名称组成的名称下的文件中未找到类型*，主机系统可能会选择强制限制它是编译时错误*如果满足以下任一条件，则加上扩展名（例如 .java 或 .jav）：*
> 
> *   该类型由声明该类型的包的其他编译单元中的代码引用。
>     
>     
> *   *该类型被声明为公共的（因此可以从其他包中的代码中访问）。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T09:28:17.267

您可以在合法的公共类中定义一个公共类。

```
public class EmployeeTest
{
     public class Employee {

     }
} 
```

# django - 具有 N 个可选参数的 Django url

> ID：11966863
> 
> 赞同：0
> 
> 时间：2012-08-15T09:24:12.307
> 
> 标签：django, django-urls

我想拥有与[khanacademy.org](http://khanacademy.org)在其视频中相同的 url 模式。假设我打开了一个标题为“代数之美”的视频，其网址将是[http://www.khanacademy.org/math/algebra/introduction-to-algebra/v/the-beauty-of-algebra](http://www.khanacademy.org/math/algebra/introduction-to-algebra/v/the-beauty-of-algebra)。

它在 url 中显示了三个级别的类别（数学、代数和代数介绍）。我在 django 中想要的也是一样的。类别级别（参数数量）可能会增加到 N。

我不想像这样对 Urls 进行硬编码

```
url(r"^(?P<level_one>[a-zA-Z]+)/v/(?P<slug>[-\w]+)/$", "my_view", name="level_one"),
url(r"^(?P<level_one>[a-zA-Z]+)/(?P<level_two>[a-zA-Z]+)/v/(?P<slug>[-\w]+)/$", "my_view", name="level_two"),
url(r"^(?P<level_one>[a-zA-Z]+)/(?P<level_two>[a-zA-Z]+)/(?P<level_three>[a-zA-Z]+)/v/(?P<slug>[-\w]+)/$", "my_view", name="level_three"),
... 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:34:41.687

我不相信你的`urls.py`. 最好的选择可能是有一个通用的包罗万象的 url，它指向一个视图，您可以在其中编写自己的 url 调度程序，这比 django 的 url 可以提供的更复杂。

您将能够解析路径并处理视图中的 N 个级别。

# javascript - 传单：圈子的行为与 CircleMarker 不同

> ID：11966866
> 
> 赞同：7
> 
> 时间：2012-08-15T09:24:20.050
> 
> 标签：javascript, geojson, leaflet

在此处的 Leaflet 文档中：[http](http://leafletjs.com/reference-1.2.0.html#circlemarker) ://leafletjs.com/reference-1.2.0.html#circlemarker 它说 CircleMaker 扩展了 Circle，并且它是同一件事，除了半径以像素而不是米为单位指定，这样即使您缩放地图，圆圈的大小也会保持不变。

但是我确实需要 Circles，因为我正在尝试在地图上绘制 100m 半径的圆圈。为此，我使用以下代码：

```
var geojsonLayer = new L.GeoJSON(null,{
pointToLayer: function (latlng){
    return new L.CircleMarker(latlng, {
        radius: 5,
        fillColor: "#ff7800",
        color: "#000",
        weight: 1,
        opacity: 1,
        fillOpacity: 0.8,
    });
}});

map.addLayer(osm);
map.addLayer(geojsonLayer);
geojsonLayer.addGeoJSON(jsonExample); 
```

但是，如果我将代码更改为使用“Circle”而不是 CircleMaker，这将完美地工作，整个地图将无法加载，并且我收到一个 javascript 错误：

```
Error: Error: Invalid LatLng object: (56.229917, NaN) 
```

我可以通过预先过滤geojson来删除那些既缺乏纬度又缺乏经度的点来解决这个问题，但我很困惑：Circle和CircleMaker都指定它们将LatLng对象作为中心点的规范，我不'不知道某个 LatLng 对象如何作为 CircleMarker 的中心点有效，但如果用作 Circle 的中心点则无效。

我是否忽略了一些明显的东西，或者这只是传单中的一个弱点和/或错误，我只需要解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T13:27:03.377

我通过更改 L.circle 中的 leaflet.js 的 _getLngRadius() 方法解决了这个问题。在传单版本 0.4.4 中，它在第 4913 行附近。

此方法与 circleMarker 中的方法不同，因为它动态计算圆的半径。如果您更改具有

> this._mRadius/hLength

到

> this._mRadius.radius/hLength

应该没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-24T13:12:15.033

代码没有问题了。尽管由于不同的构造函数很容易出现同样的问题：

```
L.CircleMarker( <LatLng> latlng, <Path options> options? ) 
```

和

```
L.Circle( <LatLng> latlng, <Number> radius, <Path options> options? ) 
```

请务必将半径传递给您的新圈子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T11:27:29.003

您可以在函数开头添加 if(latlng && latlng.lat && latlng.lng) (latlng)

这将忽略错误的数据。

# mysql - Mysql交叉表查询计数百分比？

> ID：11966870
> 
> 赞同：0
> 
> 时间：2012-08-15T09:24:33.570
> 
> 标签：mysql

早上好，是否可以从交叉表查询中计算 2 个计算列的百分比，我的缩减查询如下？

```
Select
  a.ContactFullName As Adviser,
  Sum(Month(b.CaseDate) = 1) As Jan,
  Sum(Month(b.CaseDate) = 2) As Feb,
  Sum(Month(b.CaseDate) = 3) As Mar,
  Count(b.CaseID) As Total,
  Count(b.StatusSubmittedDate) As Comms

From
  tblcontacts a Inner Join
  tblcases b On a.ContactID = b.ContactAssignedTo
Group By
  a.ContactFullName With Rollup 
```

这是将月份输出为显示每个月案例的列，Total 列计算行，而 Comms 列仅计算带有日期的案例。我想做的是计算 Total/Comms 的百分比；

```
Total | Comms | %_Share
100   | 50    | 50%
346   | 53    | 15%
278   | 89    | 32% 
```

我看错了，我应该创建多个查询来实现吗？

感谢您的关注

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T10:03:23.993

只需选择另一列：

```
Select …,
  100*Count(b.StatusSubmittedDate)/Count(b.CaseID) As `%_Share`
From … 
```

这是 100*Comms/Total，即您的预期输出表示的方式，而不是您在文本中写的 Total/Comms。

据我所知，直接重用一个计算列来计算另一个计算列中的值是不可能的。但是重复评估的开销`Count`应该不会太高，也许 MySQL 甚至会检测到这样的常用术语并只计算一次，我不知道。

# android - 如何将嵌套的 XML 结构实现为 2 个 ListView？

> ID：11966877
> 
> 赞同：0
> 
> 时间：2012-08-15T09:25:19.783
> 
> 标签：android, xml, listview, arraylist, hashmap

我正在尝试解析具有以下结构的 XML 文件：

```
<groups>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
      <action>...</action>
    </actions>
  </group>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
      <action>...</action>
      <action>...</action>
    </actions>
  </group>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
    </actions>
  </group>
</groups> 
```

目前在第一个 ListView 中，每行都有“名称”和“描述”可见。这是功能齐全的。选择一行时，将使用另一个 ListView 创建一个新活动。在这里，我想根据上一个列表中的选定位置显示每行的操作。我该怎么做？我还尝试将“动作”添加到我的其他项目添加到的地图中，但它只为每个组添加 1 个“动作”。请指教？

公共类 ErrorCodeList 扩展 ListActivity {

```
public static final String LANGUAGE = null;

public ArrayList<HashMap<String, String>> mylist;
public ListAdapter adapter;
public Dialog progDialog;
public ProgressBar progBar;
public TextView lblMessage;

private Intent myIntent;
private String  URLvariable;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listplaceholder);

    myIntent = getIntent();
    URLvariable = myIntent.getExtras().getString("urlType");

    mylist = new ArrayList<HashMap<String, String>>();

    adapter = new SimpleAdapter(this, mylist , R.layout.activity_error_list, 
                    new String[] { "tid", "tname" }, 
                    new int[] { R.id.item_id, R.id.item_title });

    final ListView lv = getListView();
    lv.setTextFilterEnabled(true);  
    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {              
            @SuppressWarnings("unchecked")
            HashMap<String, String> hashMap = (HashMap<String, String>) lv.getItemAtPosition(position);                 

            Intent myIntent = new Intent(view.getContext(),ErrorCodeDetails.class);
            myIntent.putExtra("map",hashMap);
            startActivity(myIntent);

        }
    });

    progDialog = new Dialog(this, R.style.progress_dialog);
    progDialog.setContentView(R.layout.progress_dialog);

    progBar = (ProgressBar) progDialog.findViewById(R.id.progBar);
    lblMessage = (TextView) progDialog.findViewById(R.id.txtProgMessage);
    lblMessage.setText("Please Wait.....");

    progDialog.show();
    new GetDataTask().execute();        

}

private Boolean isOnline()  {
    ConnectivityManager cm = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo ni = cm.getActiveNetworkInfo();
    if(ni != null && ni.isConnected())
        return true;

    return false;
}

private class GetDataTask extends AsyncTask<Void, Void, Integer> {

    @Override
    protected Integer doInBackground(Void... params) {

        if(isOnline()){
            mylist.clear();                  
            }  

            // Start the http request
            String feedURL="http://...";        
            String xml = XMLfunctions.getXML(feedURL);
            Document doc = XMLfunctions.XMLfromString(xml);

            int numResults = 1;

            if((numResults <= 0)){
                Toast.makeText(ErrorCodeList.this, "Geen resultaten gevonden", Toast.LENGTH_LONG).show();  
                finish();
            }

            NodeList troubles = doc.getElementsByTagName("trouble");

            for (int i = 0; i < troubles.getLength(); i++) {                            
                HashMap<String, String> map = new HashMap<String, String>();    

                Element e = (Element)troubles.item(i);
                if((e.getAttributes().getNamedItem("type").getNodeValue().equals("error"))) {
                    //map.put("id", "ID:" + Integer.valueOf(e.getAttributes().getNamedItem("id").getNodeValue()));
                    //map.put("status", "Status:" + (e.getAttributes().getNamedItem("status").getNodeValue()));
                    map.put("tid", XMLfunctions.getValue(e, "id"));
                    map.put("tname", XMLfunctions.getValue(e, "name"));
                    map.put("tdescription", XMLfunctions.getValue(e, "description"));

                    //NodeList  ns=e.getElementsByTagName("trouble_cause");
                    mylist.add(map);
                }           
            }
            System.out.println(mylist);
        }else{
            Toast.makeText(ErrorCodeList.this, "No connection..", Toast.LENGTH_LONG).show();            
        }

        return 1;
    }

    @Override
    protected void onPostExecute(Integer result) {

        setListAdapter(adapter);
        progDialog.dismiss();
        super.onPostExecute(result);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:21:55.377

创建一个数据对象组。

```
public class Group {
private String id;
private String name;
private String description;
private ArrayList<String> actions;
public String getId() {
    return id;
}
public void setId(String id) {
    this.id = id;
}
public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}
public String getDescription() {
    return description;
}
public void setDescription(String description) {
    this.description = description;
}
public ArrayList<String> getActions() {
    return actions;
}
public void setActions(ArrayList<String> actions) {
    this.actions = actions;
}
} 
```

您的活动代码将如下所示。

```
public class MainActivity extends Activity implements OnItemClickListener {

private ArrayList<Group> groups;
private ListView list;
private MyAdapter adapter;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    list = (ListView)findViewById(R.id.my_list);
    list.setAdapter(adapter = new MyAdapter());
    list.setOnItemClickListener(this);
    parseXML();
}

private void parseXML(){
    // TODO: CODE TO PARSE XML
    adapter.notifyDataSetChanged();
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public class MyAdapter extends BaseAdapter{

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return groups.size();
    }

    @Override
    public Object getItem(int arg0) {
        // TODO Auto-generated method stub
        return groups.get(0);
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO: Create row view here.
        // USE groups to create list here
        return null;
    }

}

@Override
public void onItemClick(AdapterView<?> listView, View rowView, int position, long column) {
    // TODO Auto-generated method stub
    Group clickedGroup = groups.get(position);
    Intent intent = new Intent(this, SecondActivity.class);
    Bundle bundle = new Bundle();
    bundle.putStringArrayList("ACTIONS", clickedGroup.getActions());
    intent.putExtra("BUNDLE", bundle);
    startActivity(intent);
}

} 
```

你的第二个活动看起来像这样

```
public class SecondActivity extends Activity {

private ArrayList<String> actions;
private ListView list;
private ActionAdapter adapter;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);

    Intent intent = getIntent();
    Bundle bundle = intent.getBundleExtra("BUNDLE");
    actions = bundle.getStringArrayList("ACTIONS");

    list = (ListView)findViewById(R.id.my_list2);
    list.setAdapter(adapter = new ActionAdapter());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public class ActionAdapter extends BaseAdapter{

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return actions.size();
    }

    @Override
    public Object getItem(int arg0) {
        // TODO Auto-generated method stub
        return actions.get(0);
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO: Create row view here.
        // USE actions to create list here
        return null;
    }

}

} 
```

# javascript - 检测 Firebug（或任何其他 Web 调试器）何时用于调试

> ID：11966885
> 
> 赞同：6
> 
> 时间：2012-08-15T09:25:39.330
> 
> 标签：javascript, debugging, firefox, firebug

我有一个 Javascript 应用程序，它依赖于在文本区域中捕获键盘事件。在使用 firebug (1.10.2) 在 Firefox (14.x) 上测试和调试它时，我注意到当我的断点处于活动状态并且调试器正在工作时，我的应用程序的行为会有所不同。

我知道如何检测 Firebug，但我想知道当 Firebug 实际用于调试时是否可以检测（使用 Javascript）？

*编辑：这是一些随机网站上的示例*

[该站点](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)在输入框中捕获键事件，打印出字符代码并将按下的键替换为文本表示（即“输入”表示输入键）或大写字母（如果是字母）。

当我使用 Chrome 调试它并在侦听器函数上放置一个断点时，到达断点时没有任何反应（如预期的那样），当我恢复脚本时，文本会正常打印出来。

当我在 Firefox 上使用 Firebug 对其进行调试时：假设之前我按下了“e”字母并且输入栏包含文本“E”。我打开断点并按字母“z”。Firebug 在断点处停止，但输入栏现在有文本“Ez”而不是“E”。当我恢复脚本时，此文本将按预期替换为“Z”。

我尝试了另一个 Firefox 调试器（Venkman 0.9.89），同样的事情发生了。所以我的猜测是这是一个 Firefox 问题，而不是调试器问题。所以这个问题可能更笼统，可以检测到何时调试 Javascript 代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:36:35.917

这就是我检测 Firebug 的方法：

```
if (window.console && (window.console.firebug || window.console.exception)) {
  // At this point, Firebug is enabled
} 
```

第一个测试对于确保控制台确实存在很重要。第二个测试将测试 Firebug，尽管它只适用于旧版本。第三个是Firebug添加了“异常” 这是因为属性“异常”是由Firebug的插件添加的。

（不相关但感兴趣：`window.console.exception`是 Firebug 用来在控制台上显示消息的方法。例如，键入：

```
>>> window.console.exception("A message", {param:'Value'}) 
```

您将看到一个看起来非常熟悉的错误，其中包含传递对象的转储！

默克。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T13:16:11.463

好吧，希望这个答案对某人有所帮助。

让我们调试的函数如下：

```
function debugged()
{
   debugger;
}
setTimeout(debugged, 3000); 
```

添加此调试检测代码为：

```
setTimeout(this.x = function(a){ s = Math.abs(new Date() - a.c - 1000); a.c = new Date(); setTimeout(a.foo,1000, a); if(s>100)console.log("debug") },1000, {c: new Date(), foo:this.x}) 
```

因此，如果我们在某个地方运行它并打开调试器，它将触发断点并捕获调试事件（您可以通过控制台中出现的“调试”字样看到它）。这是一个概念，您可以更改检测周期时间和提高调试标志的方式。感谢单线程javascript。

# asp.net-mvc-3 - 远程验证不适用于 guid

> ID：11966891
> 
> 赞同：0
> 
> 时间：2012-08-15T09:25:54.633
> 
> 标签：asp.net-mvc-3, remote-validation

```
[Remote("DropDownSelected", "Patient")]
public Guid SexIdentifier { get; set; }

public ActionResult DropDownSelected(object value)
{
    var x = ((Guid)value).ToString();
    string xsd = value.ToString();
    var abc = ControllerContext.Controller;

    if (value == null)
    {
        //value = string.Empty;
    }

    if (value.ToString() == Convert.ToString(Guid.Empty) || value.ToString() == string.Empty)
    {
        return Json(String.Format("0 does not exist."), JsonRequestBehavior.AllowGet);
    }

    return Json(true, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:30:15.890

如果您的属性被调用`SexIdentifier`，那么您的操作必须为其参数使用相同的名称：

```
public ActionResult DropDownSelected(Guid sexIdentifier) 
{
    ...
} 
```

此外，如果您有下拉列表的默认值，则可以使用 nullable `Guid`：

```
public ActionResult DropDownSelected(Guid? sexIdentifier) 
{
    ...
} 
```

# c++ - C++ Microsoft：如何将 uuid/guid 与模板专业化相关联

> ID：11966892
> 
> 赞同：4
> 
> 时间：2012-08-15T09:25:55.627
> 
> 标签：c++, templates, com

我想将 uuid/guid 与模板专业化相关联。

以下代码可用于将 uuid 与非模板接口（类、结构）相关联：

```
__interface __declspec(uuid("CECA446F-2BE6-4AAC-A117-E395F27DF1F8")) ITest {
    virtual void Test() = 0;
};

GUID guid = __uuidof(ITest);   // OK 
```

现在我有一个模板界面

```
template<class T> __interface ITemplateTest {
    virtual void Test(T t) = 0;
    }; 
```

我想做以下工作：

```
GUID templateGuid = __uuidof(ITemplateTest<float>); 
```

无法将 __declspec(uuid(...)) 添加到模板类定义中。这很明显，因为接口的不同专业化需要不同的 uuid。所以我尝试通过以下方式将 uuid 与模板专业化相关联：

```
template<> __interface __declspec(uuid("CF4AB938-8CE0-4AB7-A56C-0253B6018C26")) ITemplateTest<float>; 
```

不幸的是，这也不起作用（__uuidof(.) 失败并显示“没有与此对象关联的 GUID”）。

我的问题有什么解决办法吗？

**这是在一些答案之后添加的更完整的示例：**

假设我有一个适用于不同数据类型的复杂算法。为了简单起见，这种“复杂”算法正在对数字进行平方。我只想实现我的算法一次，所以模板是要走的路。让我们进一步假设我想使用接口，因为我的应用程序使用了 COM。

所以这里有一个接口和一个实现这个接口的模板化对象：

```
template<class T> __interface ITemplateTest {
    virtual T Square(T t) = 0;
    };

template<class T> class CTemplateImplementation : public ITemplateTest<T> {
    public:
        virtual T Square(T t) { return t * t; };
    }; 
```

这允许做类似的事情

```
CTemplateImplementation<double> xDouble;
CTemplateImplementation<float>  xFloat;
CTemplateImplementation<int>    xInt;

std::cout << xDouble.Square(5.) << std::endl
          << xFloat.Square(5.0f) << std::endl
          << xInt.Square(5) << std::endl; 
```

现在让我们进一步假设我有另一个模板对象，也实现了一个非常“复杂”的算法，它利用了 CTemplateImplementation：

```
template<class T> class CSquareAndAddOne {
    private:
        CTemplateImplementation<T> m_squarer;
    public:
        T SquareAndAddOne(T t) { return m_squarer.Square(t) + T(1); }
    }; 
```

现在可以以相同的方式使用此对象：

```
CSquareAndAddOne<double> yDouble;
CSquareAndAddOne<float>  yFloat;
CSquareAndAddOne<int>    yInt;

std::cout << yDouble.SquareAndAddOne(5.) << std::endl
          << yFloat.SquareAndAddOne(5.0f) << std::endl
          << yInt.SquareAndAddOne(5) << std::endl; 
```

当 CSquareAndAddOne::SquandAndAddOne 想要使用 CTemplateImplementation 特化的 __uuid 时，问题就出现了。尝试以下操作：

```
 T SquareAndAddOne(T t) {
        GUID guid = __uuidof(m_multiplier);
        return m_squarer.Square(t) + T(1);
        } 
```

这不再起作用，因为没有与 m_multiplier 关联的 GUID。那么如何在不复制代码的情况下将 guid 分配给 CTemplateImplementation 的（在这种情况下为三个）不同的实现？你能提供一个完整的解决方案吗？从 CTemplateImplementation 为不同类型派生不同的类是不可能的，因为在 CSquareAndAddOne 中正确类型化的使用不能再通过模板参数来控制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T14:22:03.320

我尝试了一些显式的实例化魔法，它工作正常（至少在 VS2008 SP1 中）：

```
template<class T> __interface ITemplateTest { void Test(T t); }; // Interface declaration

template __interface ITemplateTest<float>; // Explicit instantiation

template __interface __declspec(uuid("CF4AB938-8CE0-4AB7-A56C-0253B6018C26") ITemplateTest<float>; // Repeat explicit instantiation with uuid association

GUID guid = __uuidof(ITemplateTest<float>); // Enjoy! :-) 
```

看起来最初的问题是在实际实例化*之前*`__declspec`试图将 guid 分配给类专业化。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T11:40:36.353

尝试：

```
__interface __declspec(uuid("CF4AB938-8CE0-4AB7-A56C-0253B6018C26")) 
ITestFloat: ITemplateTest<float> {
    virtual void Test() = 0;
}; 
```*

# python - 保存 XML 文档，破坏了我的 XSI 声明

> ID：11966896
> 
> 赞同：0
> 
> 时间：2012-08-15T09:26:08.647
> 
> 标签：python, xml, beautifulsoup

我有个问题：

我正在解析一个带有 python xml 解析器 ( [beautifulsoup](http://www.crummy.com/software/BeautifulSoup/) ) 的命名空间的 XML，当我保存该 xml 时，解析器用 {http://www.w3.org/2001/XMLSchema 替换命名空间中的“xsi:” -instance} 我怎样才能阻止他这样做？

例子：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"> 
```

变成：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" {http://www.w3.org/2001/XMLSchema-instance}schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"> 
```

谁能帮我解决这个问题？

问候，博扬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T14:27:56.330

我已经[为你提交了一个错误。](https://bugs.launchpad.net/beautifulsoup/+bug/1037597)我还提交了一个修复，它将在 Beautiful Soup 的下一个版本中发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T11:08:24.637

这就是我暂时解决它的方法。

```
soupOut = str(soup)
ns = re.search("<project [^>]* xmlns:xsi=\"(?P<ns>[^\"]*)\"[^>]*>",soupOut)
if ns:
    soupOut = soupOut.replace("{%s}"%ns.group('ns'), 'xsi:')
file.write(soupOut) 
```

# c# - 比较两个大型通用列表

> ID：11966897
> 
> 赞同：6
> 
> 时间：2012-08-15T09:26:09.860
> 
> 标签：c#, .net-4.0

我找不到一个具体的例子，所以我发布了这个问题。任何帮助表示赞赏。

我有两个大型通用列表，都有超过 300K 的项目。

我正在遍历第一个列表以拉回信息并即时为新列表生成一个新项目，但我需要在第二个列表中搜索并根据三个匹配条件返回一个值，如果发现添加到列表，但是您可以想象，执行 300k * 300k 次需要时间。

有什么办法可以更有效地做到这一点？

我的代码：

```
var reportList = new List<StocksHeldInCustody>();
foreach (var correctDepotHolding in correctDepotHoldings)
  {
    var reportLine = new StocksHeldInCustody();
    reportLine.ClientNo = correctDepotHolding.ClientNo;
    reportLine.Value = correctDepotHolding.ValueOfStock;
    reportLine.Depot = correctDepotHolding.Depot;
    reportLine.SEDOL = correctDepotHolding.StockCode;
    reportLine.Units = correctDepotHolding.QuantityHeld;
    reportLine.Custodian = "Unknown";
    reportLine.StockName = correctDepotHolding.StockR1.Trim() + " " + correctDepotHolding.StockR2.Trim();

    //Get custodian info

    foreach (var ccHolding in ccHoldList)
    {
      if (correctDepotHolding.ClientNo != ccHolding.ClientNo) continue;
      if (correctDepotHolding.Depot != ccHolding.Depot) continue;
      if (correctDepotHolding.StockCode != ccHolding.StockCode) continue;
      if (correctDepotHolding.QuantityHeld != ccHolding.QuantityHeld) continue;
      reportLine.Custodian = ccHolding.Custodian;
      break;
    }
    reportList.Add(reportLine);
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:30:53.027

正如 Pranay 所说，连接可能是您想要的：

```
var query = from correct in correctDepotHoldings
            join ccHolding in ccHoldList
              on new { correct.ClientNo, correct.Depot,
                       correct.StockCode, correct.QuantityHeld }
              equals new { ccHolding.ClientNo, ccHolding.Depot,
                           ccHolding.StockCode, ccHolding.QuantityHeld }
            // TODO: Fill in the properties here based on correct and ccHolding
            select new StocksHeldInCustody { ... };
var reportList = query.ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T09:28:06.093

您可以将查找列表中的数据移动到字典中，键是您正在搜索的 3 个项目的唯一哈希。然后您将进行非常快速的查找并节省数百万次迭代。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T09:28:49.783

查看我的完整帖子：[**Linq Join on Mutiple columns using Anonymous type**](http://pranayamr.blogspot.in/2011/10/linq-join-on-mutiple-columns-using.html)

利用将为您工作的 Linq 内部连接。

```
var list =  ( from x in entity
           join y in entity2 
          on new { x.field1, x.field2 } 
        equals new { y.field1, y.field2 }
        select new entity { fields to select}).ToList(); 
```

在多个字段上加入 linq

![在此处输入图像描述](../Images/dc8da52b2693e72d1d3d537c328852d8.png)

```
EmployeeDataContext edb= new EmployeeDataContext();
var cust = from c in edb.Customers
           join d in edb.Distributors on
             new { CityID = c.CityId, StateID = c.StateId, CountryID = c.CountryId,
                   Id = c.DistributorId }   
           equals
             new { CityID = d.CityId, StateID = d.StateId, CountryID = d.CountryId,
                   Id = d.DistributorId }   
           select c; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T09:29:19.953

使用 LINQ 加入列表并以您喜欢的方式返回。

例如

```
var list1 = GetMassiveList();
var list2 = GetMassiveList();

var list3 = from a in list1
            join b in list2
                 on new { a.Prop1, a.Prop2 } equals
                    new { b.Prop1, b.Prop2 } 
            select new { a.Prop1, b.Prop2 }; 
```

要进行外部连接，您可以使用 DefaultIfEmpty() 此示例将连接的 RIGHT 部分设置为默认对象（通常为 null），以用于未进行连接的情况。

例如

```
from a in list1
join b in list2
    on new { a.Prop1, a.Prop2 } equals
       new { b.Prop1, b.Prop2 } 
into outer
from b in outer.DefaultIfEmpty()
select new 
    Prop1 = a.Prop1,
    Prop2 = b != null ? b.Prop2 : "Value for Prop2 if the b join is null"
} 
```

# c - 使用多播 UDP 的 C 网络记录器？

> ID：11966899
> 
> 赞同：2
> 
> 时间：2012-08-15T09:26:19.720
> 
> 标签：c, linux, logging, udp, multicast

我可以从我的 Linux (C) 应用程序调用的库的任何建议，以使用多播 UDP 向碰巧在网络上监听的任何人发送简单的日志消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T11:38:53.400

您不需要库来*发送*多播数据包。将 UDP 消息发送到多播套接字仅比将 UDP 消息发送到单播地址稍微复杂一些。

特别是你需要用来`setsockopt`设置`IP_MULTICAST_TTL`你的数据包。

`setsockopt`接收方稍微困难一些——您必须使用with加入特定的多播组`IP_ADD_MEMBERSHIP`才能接收发送给它的消息。

这些选项都记录在`man 7 ip`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T10:17:45.410

当您问“任何库的推荐”时，我认为您不想要标准 c 库，因为我从未见过有人问是否有人向 c 开发推荐 c 库。所以很明显你不需要比c库更多的东西，但我的回答完全符合你的问题，或者，也许这个问题不太好。

您可以使用优秀的 ZeroMQ 和 EPGM 协议（封装在 UDP 中）

[zmq_pgm - ØMQ 使用 PGM 的可靠多播传输](http://api.zeromq.org/2-1%3azmq-pgm)

在服务器端

```
void *context = zmq_init(1);
assert(context);
void *broadcast = zmq_socket(context, ZMQ_PUB);
assert(broadcast);
rc = zmq_bind(broadcast, "epgm://192.168.0.123:5555");
assert(rc==0);
rc = s_send(broadcast, "Hello world!");
assert(rc==0); 
```

在客户端：

```
void *context = zmq_init(1);
assert(context);
void *watch = zmq_socket(context, ZMQ_SUB);
assert(watch);    
rc = zmq_connect(watch, "epgm://192.168.0.123:5555");
assert(rc==0);
char *message = s_receive(watch);
assert(message); 
```

# java - java - 如何在java中的long前面放置固定数量的0？

> ID：11966903
> 
> 赞同：1
> 
> 时间：2012-08-15T09:27:05.870
> 
> 标签：java, android

> **可能重复：**
> [在 Java 中用零填充整数](https://stackoverflow.com/questions/473282/left-padding-integers-with-zeros-in-java)

我有个问题。我正在开发一个安卓应用程序

我有一个很长的时间戳和一个需要组合的字符串。问题是，如果 long 小于 8 位，那么我需要显示 0 以使其看起来不错。

例子

长时间 = 311;

我怎样才能填写它，所以它会是

00000311

长时间2 = 3111

00003111

我希望你们中的任何人都能帮助我，因为我已经尝试为它找到一个多小时的解决方案了..

拉斯穆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T10:00:35.120

```
String.format("%08d", long time /*YourNumber*/); 
```

`%08d`: 长度为 8 的零填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:32:40.687

您可以使用 java.util.Formatter 用前导零填充。您需要指定宽度，如果数字的宽度小于给定宽度，它将用前导零填充。

[http://developer.android.com/reference/java/util/Formatter.html](http://developer.android.com/reference/java/util/Formatter.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:34:12.170

试试`NumberFormat`。像这样

```
NumberFormat formatter = new DecimalFormat("00000000");
String s = formatter.format(time); 
```

# c - GCC 中的后增量、函数调用、序列点概念

> ID：11966906
> 
> 赞同：3
> 
> 时间：2012-08-15T09:27:15.827
> 
> 标签：c, c99, gcc4, sequence-points

有一个代码片段，GCC 产生了我没想到的结果：

（我正在为目标 i686-linux-gnu 使用 gcc 版本 4.6.1 Ubuntu/Linaro 4.6.1-9ubuntu3）

[测试.c]

```
#include <stdio.h>

int *ptr;

int f(void)
{
    (*ptr)++;

    return 1;
}

int main()
{
    int a = 1, b = 2;

    ptr = &b;

    a = b++ + f() + f() ? b : a;

    printf ("b = %d\n", b);

    return a;
} 
```

据我了解，函数调用有一个序列点。后增量应在 f() 之前进行。

参见 C99 5.1.2.3：“......称为序列点，之前评估的所有副作用都应完整，后续评估的副作用不应发生。”

对于这个测试用例，也许评估的顺序是不确定的，但最终的结果应该是一样的。所以我预计 b 的最终结果是 5。但是，在使用 'gcc test.c -std=c99' 编译此案例后，输出显示 b = 3。

然后我使用“gcc test.c -std=c99 -S”看看发生了什么：

```
 movl    $1, 28(%esp)
        movl    $2, 24(%esp)
        leal    24(%esp), %eax
        movl    %eax, ptr
        movl    24(%esp), %ebx
        call    f
        leal    (%ebx,%eax), %esi
        call    f
        addl    %esi, %eax
        testl   %eax, %eax
        setne   %al
        leal    1(%ebx), %edx
        movl    %edx, 24(%esp)
        testb   %al, %al
        je      .L3
        movl    24(%esp), %eax
        jmp     .L4
.L3:
        movl    28(%esp), %eax
.L4:
        movl    %eax, 28(%esp) 
```

似乎 GCC 在 f() 之前使用评估值并在两次 f() 调用之后执行 '++' 操作。

我也用llvm-clang编译了这个case，结果显示b=5，也就是我所期望的。

我对后增量和序列点行为的理解是否不正确？或者这是 GCC461 的一个已知问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T19:57:51.300

除了 Clang，还有另外两个工具可以作为参考：[Frama-C 的价值分析](http://frama-c.com/value.html)和[KCC](http://code.google.com/p/c-semantics/)。我不会详细介绍如何安装它们或将它们用于此目的，但它们可用于检查 C 程序的定义性——与编译器不同，它们旨在告诉您目标程序是否显示未定义行为。

他们有粗糙的边缘，但他们都认为在程序结束时`b`绝对应该没有未定义的行为：`5`

```
Mini:~/c-semantics $ dist/kcc ~/t.c
Mini:~/c-semantics $ ./a.out 
b = 5 
```

这是一个比 Clang 认为的更强有力的论点（因为如果它是未定义的行为，Clang 仍然可以生成一个打印的程序`b = 5`）。

长话短说，您似乎在该版本的 GCC 中发现了一个错误。下一步是检查 SVN 以查看它是否仍然存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-21T21:15:45.333

我前段时间报告了这个 GCC 错误，并在今年早些时候修复了它。见[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48814](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48814)

# ruby-on-rails - 使用计算和类方法排序列

> ID：11966913
> 
> 赞同：1
> 
> 时间：2012-08-15T09:27:42.030
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在构建一个允许用户发布的应用程序。这些帖子可以被赞成和反对。每个帖子记录都会跟踪`upvotes:integer`和`downvotes:integer`。我希望能够对总投票数最多的记录进行排序（换句话说：）`upvotes-downvotes`。我完全不知道如何做到这一点，因为我不太了解 Class 方法如何与调用它们的对象交互。这是我的尝试：

我的控制器：

```
def index
    @posts = Post.find(:all).most_votes.order(vote_difference)
end 
```

我的 Post.rb 模型：

```
def self.most_votes
   vote_difference = (upvotes-downvotes)
end 
```

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T11:45:37.643

事实证明，您实际上可以将计算直接插入到 .order() 值中：

```
@posts = Post.find(:all).order('upvotes + downvotes') 
```

# iphone - UIScrollView 动态设置页面大小

> ID：11966914
> 
> 赞同：4
> 
> 时间：2012-08-15T09:27:47.537
> 
> 标签：iphone, ios, uiview, uiscrollview

我已经对此进行了很多研究，但未能找到解决方案。

我在**UIView**内部有一个**UIScrollView**。我在 pagingEnabled 模式下使用它。在内部，我以编程方式创建了 3 个不同的视图。在这 3 个不同的视图中，我有一堆东西（**UILabel、UITextView 等**）。所有视图内容都是动态的，并且在运行时确定。所以，我真的不知道。如果我给出这个内容的大小，有时，当用户向下滚动时，我会在屏幕底部看到一个带有白色空白的屏幕。我的问题是：？例如，对于第 1 页：`scrollView`**`scrollView``scrollView`**`scrollView.contentSize``scrollView``Can i set the content size dynamically for each single page of this scrollView`

`self.scrollViewNews.contentSize = CGSizeMake(constant1,constant2);`**** 

 ****并为第 2 页设置其他内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:28:30.617

我认为您`contentSize`对分页大小感到困惑。分页大小始终是滚动​​视图边界的大小，而不是您可以设置的属性。也就是说，当您向左/向右滑动时，它将按滚动视图的宽度“翻页”。

`contentSize`是滚动视图内所有子视图的虚拟边界框的大小。这仅用于限制滚动视图将滚动多远，并且对于分页，它将分页多少次，即`contentSize.width / bounds.size.width`.

假设 scrollView 没有放大/缩小（zoomScale = 1.0），那么您需要在虚拟“页面边界”上定位和调整子视图的大小。它们可以占据整个页面边界（调整大小以匹配 scrollview.bounds）或插入。如果您有一些更大/更小的内容，那么您必须决定是否要更改该内容的比例或在页面范围内向上/向下调整大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:32:55.633

是的，您可以动态设置滚动视图的内容大小。您也可以使用此方法：

```
self.scrollViewNews.contentSize = CGSizeMake(constant1,constant2); 
```

这个方法没有错。您在底部看到空白区域，因为您将 scrollView 的 contentSize 的高度设置为大于其内容的值。这就是问题所在。根据内容调整高度，空格会消失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T11:39:41.710

请尝试从当前内容中获取实际内容大小。

内容必须是从 the 继承的某个类，`UIView`并且它具有`frame.size.width`and`frame.size.height`属性。

`contentSize`当您将`UIScrollview`内容添加到`UIScrollView`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T11:44:18.177

试试这个。

```
- (void)viewDidLoad
{
    float sizeOfContent = 0;
    UIView *lLast = [scrollView.subviews lastObject];
    NSInteger wd = lLast.frame.origin.y;
    NSInteger ht = lLast.frame.size.height;

    sizeOfContent = wd+ht;

    scrollView.contentSize = CGSizeMake(scrollView.frame.size.width, sizeOfContent);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T09:35:17.787

是的。您可以通过动态设置滚动视图大小

```
scroller.contentSize = CGSizeMake(1650, 2000); 
```

您可以使用以下属性为每个页面设置动态框架

```
[urScrollView scrollRectToVisible:frame animated:YES]; 
```

如果您对滚动视图使用pagingEnabled **= YES**

下面的 UIScrollViewDelegate 委托将调整页面和内容

```
-(void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView{

    int page = urScrollView.contentOffset.x/urScrollView.frame.size.width;
    pageControl.currentPage = page;
}

//pager action
- (IBAction)changePage:(id)sender{

    int page = pageControl.currentPage;
    CGRect frame = urScrollView.frame;
    frame.origin.x = frame.size.width * page;
    frame.origin.y  = 0;
    [urScrollView scrollRectToVisible:frame animated:YES];
} 
```

请看这个[示例应用程序](http://eureka.ykyuen.info/2010/05/22/iphone-uiscrollview-with-paging-example/)****

# content-management-system - 哪个 CMS 适合我仅构建页面结构/导航？

> ID：11966915
> 
> 赞同：0
> 
> 时间：2012-08-15T09:27:49.250
> 
> 标签：content-management-system

这个问题可能不寻常。所以我试着先解释一下。我有一个带有自己后端的自编程门户网站。到目前为止工作正常，但不是很舒服。现在我正在计划重新启动（新设计，新页面结构）并问自己将我的系统设置在一些可用的 CMS/博客系统（Wordpress / Drupal / Cantao）之上是否是一件好事。这可能会给我带来一些免费的安慰和工具，而不是重新发明轮子。

我认为我只能使用 CMS 来构建基本的页面结构、导航或也使用新闻部分（但必须根据我的需要对其进行扩展）。其余的必须定制，因为我的功能非常特别——有一个大型图书数据库、用户帐户等等。

[http://www.fantasybuch.de/](http://www.fantasybuch.de/)（为语言冲击做准备；）

**走这条路有意义吗？是否有适合此类项目的 CMS 系统？**

我真的很感谢你的想法和提示。没有人可以问了。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:46:37.850

我认为 wordpress 可以在这里使用，还有其他网站将其用于电子商务，例如 (http://lsdev.biz/portfolio/payd/, [http://rockyourcause.com/shop](http://rockyourcause.com/shop) )

该插件 (http://getshopped.org/) 可用于处理商业内容。但是您也可以编写自己的代码来处理付款等。wp 系统是可扩展的并且被广泛使用，因此它应该是“未来”安全的。根据我的理解，Drupal 和 Joomla 比 wp 更难掌握。

我认为最大的问题是为什么你觉得有必要做这个改变？

# php - TYPO3 中的照片博客

> ID：11966920
> 
> 赞同：-2
> 
> 时间：2012-08-15T09:28:09.497
> 
> 标签：php, typo3

我在 TYPO3 中使用 Photoblog 扩展，但不断收到以下错误：

```
Fatal error: require_once() [function.require]: Failed opening required 
'C:/xampp/htdocs/testpage/t3lib/class.t3lib_htmlmail.php' 
(include_path='C:/xampp/htdocs/testpage/typo3/contrib/pear/;.;C:\xampp\php\PEAR') 
in C:\xampp\htdocs\testpage\typo3conf\ext\photoblog\pi1\class.tx_photoblog_pi1.php on line 92 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-15T10:59:57.307

class.t3lib_htmlmail.php 已从 TYPO3 4.7 中删除。所以你可以降级到 TYPO3 4.5 或者你可以自己修补你的扩展。

有一些关于新 API 的信息：http: [//buzz.typo3.org/teams/core/article/your-first-blog/](http://buzz.typo3.org/teams/core/article/your-first-blog/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-15T11:03:43.437

这是一个在 TYPO3 中使用 swiftmailer 发送电子邮件的工作示例。$replyemail 保存电子邮件地址，$replyname 保存纯文本名称，对于 $toemail 和 $toname 也是如此。

```
$mail = t3lib_div::makeInstance('t3lib_mail_message');
$mail->setFrom(array($replyemail => $replyname));
$mail->setTo(array($toemail => $toname));
$mail->setSubject('文本');
$mail->setBody('文本');
$mail->addPart('文本');

foreach ($pdf as $k => $filename)
{
   if (file_get_contents($filename))
   {
       $mail->attach(Swift_Attachment::fromPath($filename));
   }    
}
$邮件->发送（）；

```

# javascript - 在不使用 JavaScript 的情况下不通过 iframe 访问时从页面重定向？

> ID：11966926
> 
> 赞同：1
> 
> 时间：2012-08-15T09:28:44.050
> 
> 标签：javascript, asp.net, html, redirect, iframe

如果他们尝试直接访问某些页面，即不通过我提供的 iframe，我需要重定向用户。这是为了阻止他们访问其他用户的区域。

我找到的所有解决方案（顺便说一句）都使用 JavaScript - 我拥有的当前工作脚本是

```
if (top == self) {
var newURL = 'http://www.exampleurlhere.co.uk/'
window.setTimeout('GotoIndex()',0);
}
function GotoIndex() { top.location.href = newURL; } 
```

但是，这当然只有在用户启用了 JavaScript 时才有效，这让我很吃惊。有没有办法实现这个服务器端？我正在使用aspx。

谢谢，奥利。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T09:32:28.600

您无法在服务器端检查它，因为 IFrame 请求（通常）与任何其他 HTTP 请求没有什么不同。但是，您可以使用`GET`参数来指示这是一个 IFrame

```
<iframe src="mypage?iframe=yes"></iframe> 
```

显然，此解决方案仅在您控制包含 IFrame 的代码时才有效，否则无法在服务器端执行此操作。

# ruby-on-rails - AFNetworking 没有正确复数我的数据模型对象

> ID：11966928
> 
> 赞同：3
> 
> 时间：2012-08-15T09:28:48.870
> 
> 标签：ruby-on-rails, ios, afnetworking

我正在使用**AFNetworking**和**AFIncrementalStore**为客户端 API 请求构建 iOS + Rails 应用程序，使用 AFIncrementalStore 默认示例作为起点：[https ://github.com/AFNetworking/AFIncrementalStore/tree/master/Examples/Basic% 20示例](https://github.com/AFNetworking/AFIncrementalStore/tree/master/Examples/Basic%20Example)

我的主要数据对象称为“活动”，因此复数为“活动” - 我的索引页是`http://localhost:3000/activities.json`

但是，我可以在 Xcode 日志中看到 AFNetworking 以某种方式复数为“活动”：

```
Error: Error Domain=com.alamofire.networking.error Code=-1011
"Expected status code in (200-299), got 404" UserInfo=0x6da64a0
{NSErrorFailingURLKey=http://localhost:3000/activitys,
NSLocalizedDescription=Expected status code in (200-299), got 404} 
```

我可以改变这种行为吗？另外我想`.json`在 URL 上加上一个后缀。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:42:09.257

我在 AFIncrementalStore 提供的新 Twitter 示例中找到了一种解决方法：

```
// Inside "MyAPIClient.m"

- (NSURLRequest *)requestForFetchRequest:(NSFetchRequest *)fetchRequest withContext:(NSManagedObjectContext *)context {
    NSMutableURLRequest *mutableURLRequest = nil;
    if ([fetchRequest.entityName isEqualToString:@"Activity"]) {
        mutableURLRequest = [self requestWithMethod:@"GET" path:@"activities.json" parameters:nil];
    }
    return mutableURLRequest;
} 
```

# c# - IL中调用实例与newobj实例之间的区别

> ID：11966930
> 
> 赞同：9
> 
> 时间：2012-08-15T09:28:57.130
> 
> 标签：c#, il

我正在深入研究 C#，并使用可空值类型。只是出于实验目的，我写了一段代码：

```
 private static void HowNullableWorks()
    {
        int test = 3;
        int? implicitConversion = test;
        Nullable<int> test2 = new Nullable<int>(3);

        MethodThatTakesNullableInt(null);
        MethodThatTakesNullableInt(39);
    } 
```

我很惊讶地看到**implicitConversion** / **test2**变量被初始化为：

```
call       instance void valuetype [mscorlib]System.Nullable`1<int32>::.ctor(!0) 
```

指令，而当**MethodThatTakesNullableInt**被调用时，我可以看到：

```
IL_0017:  initobj    valuetype [mscorlib]System.Nullable`1<int32> 
```

和

```
IL_0026:  newobj     instance void valuetype [mscorlib]System.Nullable`1<int32>::.ctor(!0) 
```

我理解。我想我也会看到**implicitConversion** / **test2的****newobj**指令。

 ****这是完整的 IL 代码：

```
.method private hidebysig static void  HowNullableWorks() cil managed
{
  // Code size       50 (0x32)
  .maxstack  2
  .locals init ([0] int32 test,
           [1] valuetype [mscorlib]System.Nullable`1<int32> implicitConversion,
           [2] valuetype [mscorlib]System.Nullable`1<int32> test2,
           [3] valuetype [mscorlib]System.Nullable`1<int32> CS$0$0000)
  IL_0000:  nop
  IL_0001:  ldc.i4.3
  IL_0002:  stloc.0
  IL_0003:  ldloca.s   implicitConversion
  IL_0005:  ldloc.0
  IL_0006:  call       instance void valuetype [mscorlib]System.Nullable`1<int32>::.ctor(!0)
  IL_000b:  nop
  IL_000c:  ldloca.s   test2
  IL_000e:  ldc.i4.3
  IL_000f:  call       instance void valuetype [mscorlib]System.Nullable`1<int32>::.ctor(!0)
  IL_0014:  nop
  IL_0015:  ldloca.s   CS$0$0000
  IL_0017:  initobj    valuetype [mscorlib]System.Nullable`1<int32>
  IL_001d:  ldloc.3
  IL_001e:  call       void csharp.in.depth._2nd.Program::MethodThatTakesNullableInt(valuetype [mscorlib]System.Nullable`1<int32>)
  IL_0023:  nop
  IL_0024:  ldc.i4.s   39
  IL_0026:  newobj     instance void valuetype [mscorlib]System.Nullable`1<int32>::.ctor(!0)
  IL_002b:  call       void csharp.in.depth._2nd.Program::MethodThatTakesNullableInt(valuetype [mscorlib]System.Nullable`1<int32>)
  IL_0030:  nop
  IL_0031:  ret
} // end of method Program::HowNullableWorks 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:22:09.127

首先，看起来您已经在 Debug 模式下编译（基于`nop`s） - 如果您在 Release 模式下编译，您可能会看到发出不同的代码。

ECMA CLR 规范的第 I.12.1.6.2.1 节（初始化值类型的实例）说：

> 初始化值类型实例的 home 有三个选项。您可以通过加载家庭地址（参见表 I.8：家庭位置的地址和类型）并使用`initobj` 指令（对于局部变量，这也可以通过设置`localsinit`方法头中的位来完成）将其归零。您可以通过加载家庭地址来调用用户定义的构造函数（参见表 I.8：家庭位置的地址和类型），然后直接调用构造函数。或者，您可以将现有实例复制到主目录中，如 §I.12.1.6.2.2 中所述。

代码中可空类型的前三种用法导致 null 值存储在局部变量中，因此此注释是相关的（局部变量是值的一种类型*）*：前两个是局部变量`implicitConversion`并且`test`您已声明，第三个是编译器生成的临时文件，名为`CS$0$0000`. 正如 ECMA 规范所指出的，这些局部变量可以通过使用`initobj`（相当于结构的默认无参数构造函数，`CS$0$0000`在这种情况下用于）或通过加载本地地址并调用构造函数（用于其他两个当地人）。

但是，对于最终可为空的实例（由 的隐式转换创建`39`），结果不会存储在本地 - 它是在堆栈上生成的，因此初始化 home 的规则在这里不适用。相反，编译器只是用来`newobj`在堆栈上创建值（就像它对任何值或引用类型一样）。

您可能想知道为什么编译器会为调用生成本地`MethodThatTakesNullableInt(null)`而不是为`MethodThatTakesNullableInt(39)`. 我怀疑答案是编译器总是使用`initobj`调用默认构造函数（然后需要一个本地或其他 home 作为值），但是`newobj`当还没有合适的 home 时用于调用其他构造函数并将结果存储在堆栈中为价值。

有关更多信息，另请参阅规范中第 III.4.21 节（newobj）中的此评论：

> 值类型通常不使用`newobj`. 它们通常作为参数或局部变量分配，使用`newarr`（对于从零开始的一维数组）或作为对象的字段。分配后，它们将使用`initobj`. 但是，该`newobj` 指令可用于在堆栈上创建值类型的新实例，然后可以将其作为参数传递，存储在本地等。****

# ruby-on-rails - 运行任何 gem 命令时出错

> ID：11966932
> 
> 赞同：1
> 
> 时间：2012-08-15T09:29:11.950
> 
> 标签：ruby-on-rails, ruby, gem

每当我尝试从命令行使用任何 gem 操作时，我都会在执行操作之前收到此错误。目前我在运行 heroku 命令时收到此消息，但是在显示以下错误后 heroku 命令确实运行成功。如何摆脱以下错误显示 -

```
Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/mail-2.3.3.gemspec]: invalid date format in specification: "2012-03-14 00:00:00.000000000Z" Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/jquery-rails-1.0.19.gemspec]: invalid date format in specification: "2011-11-26 00:00:00.000000000Z" Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/multipart-post-1.1.5.gemspec]: invalid date format in specification: "2012-02-13 00:00:00.000000000Z" Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/uuid-2.3.5.gemspec]: invalid date format in specification: "2012-01-23 00:00:00.000000000Z" Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/oauth2-0.5.2.gemspec]: invalid date format in specification: "2012-01-04 00:00:00.000000000Z" Invalid gemspec in [/home/murtaza/.rvm/gems/ruby-1.9.3-p194/specifications/rack-cache-1.0.3.gemspec]: invalid date format in specification: "2011-08-27 00:00:00.000000000Z" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T10:19:03.963

gem-pristine -all 解决了问题！

# c# - 从列表框中读取项目

> ID：11966933
> 
> 赞同：0
> 
> 时间：2012-08-15T09:29:15.737
> 
> 标签：c#, listbox, streamreader

我有一个包含 1 个或多个文本文件的列表框，我将其作为命令打印。但我不知道如何让流阅读器从列表框中读取？

到目前为止，我得到了这个。：

```
public void OutputBtn_Click(object sender, EventArgs e)
{
    PrintDocument PrintD = new PrintDocument();
    PrintD.PrintPage += new PrintPageEventHandler(this.PrintDocument_PrintPage);
    StreamReader SR = new StreamReader("C:\\myfile.txt");
    PrintD.Print();

} 
```

有没有我可以更改 "C:\myfile.txt" 还是必须使用 "foreach" ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:33:06.770

你想要这样的东西吗？我不完全理解这个问题

```
string[] fileEntries = Directory.GetFiles("C:\\temp\\").Where(p => 
                                 p.EndsWith(".txt")).ToArray<string>();
foreach (string fileName in fileEntries)
{
    lb.Items.Add(new ListItem(fileName, fileName);
} 
```

好的，所以您的列表框充满了文件名？

```
private StreamReader sr;

public void OutputBtn_Click(object sender, EventArgs e)
{
    foreach(var li in lb.Items)
    {
        PrintDocument PrintD = new PrintDocument();
        PrintD.PrintPage += new PrintPageEventHandler(this.PrintDocument_PrintPage);
        sr = new StreamReader(li.ToString());
        PrintD.Print();        
    }
}

private void PrintDocument_PrintPage(object sender, PrintPageEventArgs ev) 
{
     float linesPerPage = 0;
     float yPos =  0;
     int count = 0;
     float leftMargin = ev.MarginBounds.Left;
     float topMargin = ev.MarginBounds.Top;
     String line = null;

     // Calculate the number of lines per page.
     linesPerPage = ev.MarginBounds.Height  / 
        printFont.GetHeight(ev.Graphics) ;

     // Iterate over the file, printing each line.
     while (count < linesPerPage && ((line = sr.ReadLine()) != null)) 
     {
        yPos = topMargin + (count * printFont.GetHeight(ev.Graphics));
        ev.Graphics.DrawString (line, printFont, Brushes.Black, 
           leftMargin, yPos, new StringFormat());
        count++;
     }

     // If more lines exist, print another page.
     if (line != null) 
        ev.HasMorePages = true;
     else 
        ev.HasMorePages = false;
} 
```

# python - Python，过滤对象列表，但返回特定属性？

> ID：11966937
> 
> 赞同：5
> 
> 时间：2012-08-15T09:30:01.717
> 
> 标签：python, map, filter, itertools

假设我有一个 Person 对象列表，其中包含一个 age 和 room_number 属性，并且我编写了一个 check() 函数，如果 person.age() 和 person.room_number() 都令人满意，则返回 True，否则返回 False。

`filter(check, list_of_people_objects)`将返回满足以下条件的 Person 对象列表`check()`

但是，我的问题是，有没有一种方法可以返回每个已批准人员房间号的列表，而无需遍历列表两次，就像不使用列表理解一样？所以过滤，但返回可迭代的更具体的属性。

`map(lambda x: x.room_number(), filter(check, list_of_people_objects))`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-15T09:33:36.840

其实有*两种*方式。

1.  [`itertools`](http://docs.python.org/library/itertools.html)

    ```
    map(..., itertools.ifilter(..)) 
    ```

2.  列表理解

    ```
    [x.room_number() for x in people if check(x)] 
    ```

您选择哪种主要是口味问题，但惯例倾向于后者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-29T21:53:33.467

在对象过滤的情况下，您希望对属性子集进行包容性联合以等于一组有限的值，然后执行过滤列表的任何选项（包括列出属性值），您可以使用生成器执行以下操作一条语句（最后一行代码，其余用于显示使用矩阵乘法生成大量对象以生成构造函数参数的指令）

```
#!/usr/bin/env python
import itertools
import pprint
class myObj(object):
    attr_1 = None
    attr_2 = None
    attr_3 = None
    def __init__(self, at1, at2, at3):
        self.attr_1 = at1
        self.attr_2 = at2
        self.attr_3 = at3
        super(myObj, self).__init__()

    def __repr__(self):
        return '<%s %s>' % (type(self), pprint.pformat(self.__dict__))

objs = itertools.starmap(myObj, itertools.product(iter('val_%d' % (i) for i in
    range(1,4)), repeat=3))

filter_dict = {
    'attr_1' : 'val_1',
    'attr_2' : 'val_2',
    'attr_3' : 'val_3',
}
print(list(result.attr_3 for result in objs if not list(False for pn,cval in
    filter_dict.items() if getattr(result, pn, None) != cval))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T09:43:21.613

```
class Person():
    def __init__(self,age,room):
        self.age=age
        self.room=room
    def check(self)    :
        if self.room>300 and self.age>15:
            return True
        else:
            return False 
```

**输出：**

```
>>> a=Person(20,285)
>>> b=Person(22,990)
>>> c=Person(12,958)
>>> d=Person(18,150)
>>> room=[]
>>> filterd=[]
>>> for x in (a,b,c,d):
    if x.check():
        room.append(x.room)
        filterd.append(x)

>>> room
[990]
>>> filterd
[<__main__.Person object at 0xa94c94c>] 
```

# java - 如何最好地编写以下代码？可行吗？请看说明

> ID：11966940
> 
> 赞同：0
> 
> 时间：2012-08-15T09:30:08.810
> 
> 标签：java, coding-style

正如您将在下面看到的。我正在编写一个名为 Property 的类，它可以绑定到任何 Serializable 类型，从类描述中可以看出。

`T`现在属性中的值在编译期间自动绑定为类型。

我想实现一个`Class getType()`应该`Class`在运行时返回值的对象的方法，即

```
Property<String> p = new Property<String>();

Class<String> cl = p.getType(); 
```

在这里，我希望 cl 是 String.class。当然一种方法是：

```
return value == null ? null : value.getClass(); 
```

问题是它不会反映在返回的类型中并返回`Class`对象的原始类型。理想情况下，我希望它是类型`Class<String>`

```
public class Property<T extends Serializable> implements Serializable {

    private T value = null ;
    private String name = null ;
    private boolean dirty = false ;
    private Entity parent = null ;

    public Class getType() {
        // Here I want to determine the type of T that this object is bound to ?
        return class; 
    }

    public T getValue() {
        return value;
    }

    public void setValue(T value) {
        this.value = value; 
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public boolean isDirty() {
        return dirty;
    }

    public void setDirty(boolean dirty) {
        this.dirty = dirty;
    }

    public Entity getParent() {
        return parent;
    }

    public void setParent(Entity parent) {
        this.parent = parent;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T09:37:22.907

简而言之，您不能，因为在运行时该类型已被[擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)。

但是，您可以这样做（简称为相关代码）：

```
public class Property<T extends Serializable> implements Serializable {

    private T value = null;
    private final Class<T> clazz;

    // The constructor requires an instance of the Class<T>
    public Property(Class<T> clazz) { 
        this.clazz = clazz;
    }

    // Return a typed Class object
    public Class<T> getType() {     
         return clazz;  // echo back a typed Class object pass to the constructor
    } 
```

传递给构造函数的`Class<T>`对象通常称为“类型令牌”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:39:50.860

你可以写一个方法

```
public Class<? extends T> getType() {
    return value == null ? null : value.getClass();
} 
```

这将返回 的*运行时*类型`value`，并在编译时尽可能多地提供有关返回的类的信息：它将`T`是`T`.

如果你想总是 return `Class<T>`，那么你必须提供类作为运行时参数，就像@Bohemian[描述](https://stackoverflow.com/a/11967041/1468366)的那样。由于类型擦除，泛型类的类型参数在运行时不可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T09:41:47.727

[由于类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，您不可能采用这种方式。一个后果是，用于实例化类型参数的类型不能在运行时直接确定。

这里有几个选择：

1) 使用 getClass() 获取属性*值的类型。*

```
 public Class getType() {
        return value.getClass();
    } 
```

2) 显式传递`Class`T 的实际类型的对象作为构造函数参数。请注意，泛型类型意味着您不会意外传递错误的`Class`对象

```
 private T value = null;
    private Class<T> type;

    public Property(Class<T> type) { this.type = type; }

    public Class<T> getType() { this.type; } 
```

* * *

还有另一种方法（从设计的角度来看可能在这里行不通），您可以在其中具体化 Property 类；例如

```
 public class IntegerProperty extends Property<Integer> {
        public Class getType() {
            returns Integer.class;
        }
    } 
```

有一些巧妙的变体，其中泛型类的子类位于匿名类中，和/或您通过`getClass().getTypeParameters()`. 但请注意，该`getTypeParameters()`方法*仅*在您为类型参数扩展了具有特定类型的泛型类时才有效。

# c# - 添加参数的两种情况有什么区别？

> ID：11966942
> 
> 赞同：3
> 
> 时间：2012-08-15T09:30:11.503
> 
> 标签：c#, asp.net, sql, performance, informix

我想知道有什么区别：

```
 DBCmd.Parameters.Add("user_name", IfxType.VarChar);
 DBCmd.Parameters["user_name"].Value = p_u; 
```

和

```
DBCmd.Parameters.Add("user_name", p_u); 
```

这里的最佳实践是什么，哪一种更安全，一种表现优于另一种？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T09:43:23.183

在所示示例中，*主要*区别在于它知道要使用的类型是明确的`IfxType.VarChar`- 这*可能*很重要，具体取决于具体情况以及 IFX 是否将字符串默认为`Char`、`VarChar`或`LongVarChar`。老实说，我不知道默认情况下会选择哪些。

显式通常是一个好主意，但不需要通过索引器重新获取，因为新参数是从`Add`;返回的。我可能会建议：

```
DBCmd.Parameters.Add("user_name", IfxType.VarChar).Value = p_u; 
```

或许：

```
DBCmd.Parameters.Add("user_name", IfxType.VarChar, 20).Value = p_u; 
```

其中`20`是参数的*大小*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:49:55.327

尽管有 Marc 的回答，`Parameters.Add`但不推荐添加值 - 它已替换为`AddWithValue`

# c# - 我可以重复使用对象实例来避免使用 protobuf-net 进行分配吗？

> ID：11966946
> 
> 赞同：8
> 
> 时间：2012-08-15T09:30:22.227
> 
> 标签：c#, .net, protobuf-net

*背景：这是基于一个在我回答之前被问到然后删除的问题——但我认为这是一个很好的问题，所以我整理了它，改写了它，并重新发布了它。*

在使用 protobuf-net 的高吞吐量场景中，大量分配是一个问题（特别是对于 GC），是否可以重用对象？例如通过添加`Clear()`方法？

```
[ProtoContract]
public class MyDTO
{
    [ProtoMember(1)]
    public int Foo { get; set; }
    [ProtoMember(2)]
    public string Bar { get; set; }
    [ProtoMember(3, DataFormat = DataFormat.Group)]
    public List<int> Values { get { return values; } }
    private readonly List<int> values = new List<int>();

    public void Clear()
    {
        values.Clear();
        Foo = 0;
        Bar = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T09:30:22.227

protobuf-net 永远不会调用您的`Clear()`方法本身，但对于简单的情况，您可以自己简单地执行此操作，并使用该`Merge`方法（在 v1 API 上，或者只是将对象传递到`Deserialize`v2 API 中）。例如：

```
MyDTO obj = new MyDTO();
for(...) {
    obj.Clear();
    Serializer.Merge(obj, source);        
} 
```

这会将数据加载到**现有** `obj`对象中，而不是每次都创建一个新对象。

在更复杂的场景中，您希望减少对象分配的数量，*并且乐于自己处理对象池/重用*，那么您可以使用自定义工厂。例如，您可以添加一个方法，`MyDTO`例如：

```
// this can also accept serialization-context parameters if
// you want to pass your pool in, etc
public static MyDTO Create()
{
    // try to get from the pool; only allocate new obj if necessary
    return SomePool.GetMyDTO() ?? new MyDTO();
} 
```

并且，在应用程序启动时，配置 protobuf-net 以了解它：

```
RuntimeTypeModel.Default[typeof(MyDTO)].SetFactory("Create"); 
```

（`SetFactory`也可以接受`MethodInfo`- 如果工厂方法未在相关类型中声明，则很有用）

With this, what should happen is the factory method is used *instead of* the usual construction mechanisms. It remains, however, entirely your job to cleanse (`Clear()`) the objects when you are finished with them, and to return them to your pool. What is particularly nice about the factory approach is that it will work for new sub-items in lists, etc, which you can't do just from `Merge`.

# zend-framework - Zend GData - 共享表

> ID：11966948
> 
> 赞同：1
> 
> 时间：2012-08-15T09:30:27.723
> 
> 标签：zend-framework, google-docs, gdata, google-drive-api, zend-gdata

我想通过 Zend GData API（在 PHP 中）分享一个谷歌文档（电子表格）。

有没有办法通过 API 做到这一点？

或者，我可以在已经共享的集合中创建工作表。但也找不到办法。

最好的，大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:18:43.117

您可以使用新的 Google Drive API 共享文件：[https ://developers.google.com/drive/manage-sharing](https://developers.google.com/drive/manage-sharing)

它不使用 Zend 库，但文档包含所有方法的 PHP 片段和使用相同编程语言的完整示例应用程序：

[https://developers.google.com/drive/examples/php](https://developers.google.com/drive/examples/php)

# asp.net - ASP.NET MVC 3 中网站/媒体内容的授权

> ID：11966958
> 
> 赞同：0
> 
> 时间：2012-08-15T09:30:47.630
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, authorization, media

我试图在未登录时拒绝访问文件夹或资源（防止窃取）。在我的文件夹中

**Web.config：**（/媒体）

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <authorization>
      <deny users="?"/>
      <allow users="*" />
    </authorization>
  </system.web>
</configuration> 
```

我正在调用的代码：

**指数：**

```
@Video.MediaPlayer(
    path: "~/Media/Tree Felling2.wmv",
    width: "600",
    height: "400",
    autoStart: false,
    playCount: 1,
    uiMode:  "full",
    stretchToFit: true,
    enableContextMenu: true,
    mute: false,
    volume: 75)

@Video.Flash(path: "~/Media/sample.swf",
             width: "80%",
             //height: "600",
             play: true,
             loop: false,
             menu:  true,
             bgColor: "red",
             quality: "medium",
             //scale: "showall",
             windowMode: "transparent") 
```

**注销时：**不显示闪存。媒体播放器无法连接到媒体。（如预期）

**登录时：**闪烁显示。**但媒体播放器仍然无法连接到媒体。**

我哪里错了？...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T10:50:28.490

不幸的是，这是适用于 FF 的 Windows Media Player 的一个已知错误。它将在 IE 中工作。

这不起作用的原因很简单：插件不会将身份验证 cookie 与请求一起发送，所以就好像您没有经过身份验证一样。

完成这项工作的唯一方法是将 cookie 值作为查询字符串参数附加到请求中，然后在服务器上重新同步会话。

让我们付诸行动，好吗？

不幸的是，我们不能使用`@Video.MediaPlayer`帮助程序，因为它不允许您指定查询字符串参数，它仅适用于物理文件（这有点糟糕）。所以：

```
<object classid="clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6" height="400" width="600" >
    <param name="URL" value="@Url.Content("~/media/test.wmv?requireAuthSync=true&token=" + Url.Encode(Request.Cookies[FormsAuthentication.FormsCookieName].Value))" />
    <param name="autoStart" value="False" />
    <param name="uiMode" value="full" />
    <param name="stretchToFit" value="True" />
    <param name="volume" value="75" />
    <embed src="@Url.Content("~/media/test.wmv?requireAuthSync=true&token=" + Url.Encode(Request.Cookies[FormsAuthentication.FormsCookieName].Value))" width="600" height="400" type="application/x-mplayer2" autoStart="False" uiMode="full" stretchToFit="True" volume="75" />
</object> 
```

在里面`Global.asax`我们订阅该`Application_BeginRequest`方法并从请求中重新同步身份验证cookie：

```
protected void Application_BeginRequest()
{
    if (!string.IsNullOrEmpty(Context.Request["RequireAuthSync"]))
    {
        AuthCookieSync();
    }
}

private void AuthCookieSync()
{
    try
    {
        string authParamName = "token";
        string authCookieName = FormsAuthentication.FormsCookieName;

        if (!string.IsNullOrEmpty(Context.Request[authParamName]))
        {
            UpdateCookie(authCookieName, Context.Request.QueryString[authParamName]);
        }
    }
    catch { }
}

private void UpdateCookie(string cookieName, string cookieValue)
{
    var cookie = Context.Request.Cookies.Get(cookieName);
    if (cookie == null)
    {
        cookie = new HttpCookie(cookieName);
    }
    cookie.Value = cookieValue;
    Context.Request.Cookies.Set(cookie);
} 
```

差不多就是这样。这个工作的唯一要求是在 IIS 7 集成管道模式下运行，以便所有请求都通过 ASP.NET，即使是`.wmv`文件请求，否则`BeginRequest`显然永远不会触发它们。

如果您使用一些旧版 Web 服务器（例如 IIS 6.0）或在经典管道模式下运行，并且不想使用 ASP.NET 对所有请求进行通配符映射，您可以将所有媒体文件放在安全位置（例如as `~/App_Data`) 不能被用户直接访问，然后通过使用`[Authorize]`属性修饰的控制器操作为他们提供服务：

```
[Authorize]
public ActionResult Media(string file)
{
    var appData = Server.MapPath("~/App_Data");
    var filename = Path.Combine(path, file);
    filename = Path.GetFullPath(filename);
    if (!filename.StartsWith(appData))
    {
        // prevent people from reading arbitrary files from your server
        throw new HttpException(403, "Forbidden");
    }
    return File(filename, "application/octet-stream");
} 
```

进而：

```
<object classid="clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6" height="400" width="600" >
    <param name="URL" value="@Url.Action("media", "home", new { requireAuthSync = true, token = Request.Cookies[FormsAuthentication.FormsCookieName].Value })" />
    <param name="autoStart" value="False" />
    <param name="uiMode" value="full" />
    <param name="stretchToFit" value="True" />
    <param name="volume" value="75" />
    <embed src="@Url.Action("media", "home", new { requireAuthSync = true, token = Request.Cookies[FormsAuthentication.FormsCookieName].Value })" width="600" height="400" type="application/x-mplayer2" autoStart="False" uiMode="full" stretchToFit="True" volume="75" />
</object> 
```

# javascript - JavaScript 中的 DOM 解析

> ID：11966960
> 
> 赞同：5
> 
> 时间：2012-08-15T09:30:56.273
> 
> 标签：javascript, dom, xmlhttprequest, cross-domain, innerhtml

**一些背景知识：**
我正在使用 JavaScript 开发一个基于 Web 的移动应用程序。HTML 渲染是基于 Safari 的。跨域策略已禁用，因此我可以使用 XmlHttpRequests 调用其他域。这个想法是解析外部 HTML 并获取特定元素的文本内容。
过去我逐行解析文本，找到我需要的行。然后获取标签的内容，它是该行的子字符串。这很麻烦，每次目标html更改时都需要大量维护。
所以现在我想将 html 文本解析为 DOM 并在其上运行 css 或 xpath 查询。
它运作良好：

```
$('<div></div>').append(htmlBody).find('#theElementToFind').text() 
```

唯一的问题是，当我使用浏览器将 html 文本加载到 DOM 元素中时，它会尝试加载所有外部资源（图像、js 文件等）。虽然它没有造成任何严重的问题，但我想避免这种情况。

**现在的问题是：**
**如何在浏览器不加载外部资源或运行 js 脚本的情况下将 html 文本解析为 DOM？**
我一直在思考的一些想法：

*   使用 createDocument 调用 ( `document.implementation.createDocument()`) 创建新的文档对象，但我不确定它是否会跳过外部资源的加载。
*   在 JS 中使用第三方 DOM 解析器 - 我尝试过的唯一一个在处理错误方面非常糟糕
*   使用 iframe 创建新文档，使具有相对路径的外部资源不会在控制台中抛出错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T11:49:54.960

似乎以下代码效果很好：

```
var doc = document.implementation.createHTMLDocument("");
doc.documentElement.innerHTML = htmlBody;
var text = $(doc).find('#theElementToFind').text(); 
```

未加载外部资源，未评估脚本。

在这里找到它： [https ://stackoverflow.com/a/9251106/95624](https://stackoverflow.com/a/9251106/95624)

来源： [https ://developer.mozilla.org/en/DOMParser#DOMParser_HTML_extension_for_other_browsers](https://developer.mozilla.org/en/DOMParser#DOMParser_HTML_extension_for_other_browsers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T09:34:47.683

您可以构造任何 html 字符串的 jQuery 对象，而无需将其附加到 DOM：

```
$(htmlBody).find('#theElementToFind').text(); 
```

# django - ModelForm 中的参考模型字段？

> ID：11966961
> 
> 赞同：0
> 
> 时间：2012-08-15T09:31:02.590
> 
> 标签：django, django-forms

我有一个模型：

```
class Questionnaire(models.Model):
  q1 = "What is your favourite colour?"
  a1 = models.CharField() 
```

我想使用 ModelForm 并覆盖这样的标签：

```
class QuestionnaireForm(forms.ModelForm):

  def __init__(self, *args, **kwargs):
    super(QuestionnaireForm, self).__init__(*args, **kwargs)
    self.fields['a1'].label = q1

  class Meta:
    model = Questionnaire 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:31:02.590

我在写它的时候解决了这个问题，所以这是后代的答案：

```
self.fields['a1'].label = self.Meta.model.q1 
```

ETC...

# android - 可扩展通知 android 4.1

> ID：11966963
> 
> 赞同：5
> 
> 时间：2012-08-15T09:31:06.773
> 
> 标签：android, notifications, android-4.2-jelly-bean

Android 4.1 JellyBean 中有新功能。状态栏中的可扩展通知。问题是如何实施？有任何教程如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:54:07.323

这是一个相当新的功能。这就是为什么那里没有太多信息或代码示例（还没有）。

但是，这应该可以帮助您开始（包括代码示例）： http: ~~[//www.martynhaigh.com/blog/2012/07/31/new-notifications-in-jellybean](http://www.martynhaigh.com/blog/2012/07/31/new-notifications-in-jellybean/)~~

**新链接：** [JellyBean 通知测试（](https://play.google.com/store/apps/details?id=com.sloy.jbnotif) [GitHub 上](https://github.com/Sloy/Jelly-Bean-Notification-Test)的源代码）

除此之外，Google 官方文档始终是您的朋友：http: [//developer.android.com/about/versions/android-4.1.html#UI](http://developer.android.com/about/versions/android-4.1.html#UI)

# regex - 新函数中的无效字符范围错误

> ID：11966975
> 
> 赞同：3
> 
> 时间：2012-08-15T09:31:58.537
> 
> 标签：regex, character, names

我对以下错误消息有疑问

> 无效的正则表达式'([aZ]*)_(.*)'，原因'无效的字符范围'

所以导致错误的代码行是

```
if(tide=="long") names(problem) <- sub("([a-Z]*)_(.*)","\\2",problem) 
```

因此，如果函数中的参数潮汐选择了 long，则应定义问题的名称....

但是当我输入`function(...,tide="long",..)`上面提到的错误信息时会显示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T09:34:45.320

您不能使用`[a-Z]`，因为字母顺序错误，但无论如何最好使用：

```
[a-zA-Z] 
```

问题是这些范围基于表格（ASCII 或 Unicode），但大写字母“Z”位于小写字母“a”之前，因此范围的顺序错误。

另一种使用的解决方案`[A-z]`是有效范围，但有字符

```
[\]^_` 
```

介于字母“Z”和字母“a”之间，因此该范围将包含您通常不想匹配的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T09:34:25.010

你的问题是这个`[a-Z]`

你必须写要么：`[a-z]`要么`[a-zA-Z]`

# java - 为什么swing会两次绘制简单组件？

> ID：11966980
> 
> 赞同：7
> 
> 时间：2012-08-15T09:32:31.633
> 
> 标签：java, swing, graphics, awt, paintcomponent

这是绘制椭圆的简单示例。

```
public class SwingPainter extends JFrame{
    public SwingPainter() {
        super("Swing Painter");
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

        getContentPane().add(new MySwingComponent());

        setSize(200, 200);
        setVisible(true);
    }

    public static void main(String[] args) {
        new SwingPainter();
    }

    class MySwingComponent extends JComponent {

         public void paintComponent(Graphics g) {
            System.out.println("paintComponent");
            super.paintComponent(g);
            g.setColor(Color.red);
            g.fillOval(10, 10, 50, 50);
        }

        @Override
        protected void paintBorder(Graphics g) {
            System.out.println("Paint border");
            super.paintBorder(g);
        }

        @Override
        protected void paintChildren(Graphics g) {
            System.out.println("Paint children");
            super.paintChildren(g);
        }
    }
} 
```

但是在调试模式或在绘制之前向控制台添加一些信息（如示例），您可以看到摆动绘制了两次组件。

> 油漆组件
> 
> 绘制边框
> 
> 画孩子
> 
> 油漆组件
> 
> 绘制边框
> 
> 画孩子

我不明白为什么会发生这种情况，但我认为它会影响困难 GUI 中的性能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T10:19:40.843

文章[*在 AWT 和 Swing 中绘制：附加绘制属性：不透明度*](http://www.oracle.com/technetwork/java/painting-140037.html#props)说明了原因：“不透明属性允许 Swing 的绘制系统检测对特定组件的重新绘制请求是否需要对底层祖先进行额外的重新绘制。” 因为你extend `JComponent`，所以`opaque`属性默认为false，无法优化。设置属性`true`以查看差异，以及不尊重属性的工件。相关示例可在[此处](https://stackoverflow.com/a/11744971/230513)和[此处](https://stackoverflow.com/a/7213546/230513)找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T10:13:35.407

我同意 Konstantin 的观点，您需要记住的是，重绘管理器在应用程序启动时响应任意数量的请求，这通常包括显示窗口和调整大小时的初始绘制请求（有两个）。

试试这个。等到应用程序运行并调整窗口大小。我相信你会得到更多的重绘请求；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T10:15:30.970

这对我来说很好。事实上，即使在调试模式下，输出也是：

```
paintComponent
Paint border
Paint children 
```

请记住，在 AWT 和 Swing 组件中，只要 GUI 引擎认为合适，就会通过回调调用许多方法（paint、paintBorder、paintChildren、paintComponent、repaint 等）。这可能因 JVM 不同而异，甚至因执行会话不同而异。它们也可以从与您的程序的交互中触发（例如，如果您最小化/最大化）。或者他们可能根本没有。

# bash - Bash 给出 printf -v 无效选项错误

> ID：11966983
> 
> 赞同：1
> 
> 时间：2012-08-15T09:32:44.430
> 
> 标签：bash

我在一台机器上做了一个脚本，上面有这个命令

```
printf -v $1 %s $2 
```

它在我正在使用的服务器上运行良好。但是当我将脚本复制到另一台服务器时，我得到了这个错误。我在这里想念什么？

编辑：代码对我的脚本所做的是它声明了变量，但没有在函数上本地化。这是完整的功能

```
#Declare each property=value as regular bash variable=value
function getProperty {
    for x in $(echo ${1} | tr ":" "\n")
    do
        set -- $(echo ${x} | tr "=" "\n")
        printf -v $1 %s $2
        #I tried using declare, but the variables become localized to this function only
    done
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:45:38.090

会`export`工作吗？

```
export "${1}=$(printf %s "$2")" 
```

我可能在这里吠错了树...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T11:04:26.710

看起来您正在尝试以以下形式获取一些输入：

```
var=value:var=value 
```

如果输入的任何部分包含空格、换行符或全局字符，这将失败。请参阅：[不要阅读带有 for 的行](http://mywiki.wooledge.org/DontReadLinesWithFor)。如果第一个参数为空，它也会失败。因为您的扩展是未引用的，所以您正在处理多次通配符和分词，这可能会导致问题。

不幸的是，间接赋值是 Bash 最大的失败之一。如果您经常这样做，您应该认真考虑将整个脚本切换到可以使用 nameref 变量的 ksh。仅仅为了那个功能就非常值得。（下一个版本的 Bash 应该可以解决这个问题）。

您应该使用数组来处理集合。如果您需要处理这样的键值对，那么您应该使用 Bash 4 和关联数组。`printf -v`是在最近的 Bash 中对外部范围进行间接分配的最佳方法。如果您有 Bash 4.2，那么您可以使用`declare -g`分配给全局。如果您的 bash 太旧而无法执行任何操作，请升级。

此处解释了一些技术以及如何使用关联数组：http: [//mywiki.wooledge.org/BashFAQ/006](http://mywiki.wooledge.org/BashFAQ/006)

另请阅读如何[报价](http://mywiki.wooledge.org/Quotes)。

# c# - 使用 Infragistics，我如何在 SplineChart 中标记特定点？

> ID：11966991
> 
> 赞同：0
> 
> 时间：2012-08-15T09:33:28.137
> 
> 标签：c#, infragistics

现在我有一个 DataGridView 控件与 DB 中的一些数据绑定，并且 SplineChart 显示了这些数据。当我单击 DataGridView 控件中的数据时，我想突出显示或标记图表中的特定点。

我用来绘制图表的是 Infragistics ultraChart(SplineChart)，C# WinForm。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:53:14.017

您可以使用图表的 ChartDrawItem 方法来自定义特定数据点的颜色。[在 Sung 的Chart University](http://www.infragistics.com/community/blogs/sung_kim/archive/2008/09/05/chart-university-chart-101-and-some-201-301-401-stuff.aspx)博客文章的“根据条件更改项目的颜色（仅限 2D）”部分中有一个示例。

# facebook - 如何在 Facebook Graph API 中处理带逗号的 URL

> ID：11966992
> 
> 赞同：4
> 
> 时间：2012-08-15T09:33:28.473
> 
> 标签：facebook, facebook-graph-api

我想使用 Graph API 来获取有关 URL 的一些信息。

它是这样工作的：

> [http://graph.facebook.com/?ids=URL,URL2,URL3](http://graph.facebook.com/?ids=URL,URL2,URL3)

但是，当 URL 包含逗号时，事情就会变得复杂。为了

> [http://www.example.com/name,东西](http://www.example.com/name,something)

我们得到

> [http://graph.facebook.com/?ids=http%3A%2F%2Fwww.example.com%2Fname%2Csomething](http://graph.facebook.com/?ids=http%3A%2F%2Fwww.example.com%2Fname%2Csomething)

什么给了我们：

```
{
   "error": {
      "message": "(#803) Some of the aliases you requested do not exist: something",
      "type": "OAuthException",
      "code": 803
   }
} 
```

可以用 URL 做什么来避免此类错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T10:24:49.663

只需对逗号进行双 URL 编码，因此请使用 %252C：

[http://graph.facebook.com/?ids=http%3A%2F%2Fwww.example.com%2Fname%252Csomething](http://graph.facebook.com/?ids=http%3A%2F%2Fwww.example.com%2Fname%252Csomething)

它可能看起来很奇怪，因为随后 Graph API 通过`http://www.example.com/name\u00252Csomething`- 但我只是通过将点赞按钮指向包含逗号（未编码）的 URL 来测试它，喜欢它 - 然后它显示了这个 URL 的 1 个共享图表。

# oauth - 在 OpenEdge WebSpeed 中开发 oAUTH 服务

> ID：11966997
> 
> 赞同：0
> 
> 时间：2012-08-15T09:34:08.667
> 
> 标签：oauth, progress-4gl, openedge, webspeed

我正在开发一个包含 Web API 的新网站。我想知道的是，将服务器端 oAUTH 服务开发到我的新网站中是否容易（或难）？

我将 OE11.0 WebSpeed 与 Apache 结合使用。因为我从事 Progress/OpenEdge 4GL/ABL 开发已有 10 多年了，而且我发现翻译现有代码（如 PHP、Python、Java 等）非常困难。

我已经阅读了与 oAUTH 相关的 RFC，我发现自己迷失在“key-varner”中。

有人在 OpenEdge WebSpeed 中开发 oAUTH 服务器端代码吗？如果有，你愿意分享吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-15T15:09:15.353

CLR 桥现在在 OE 11 中工作，我们成功地在 webspeed 中使用 .NET dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:27:01.057

我认为您最好的选择是在 Webspeed / ABL 之外执行此操作，否则您将陷入重新发明轮子的困境。最简单的解决方案是直接从您的 ABL 代码调用 .NET 库，但我认为 CLR 桥不适用于 Webspeed / Appserver 应用程序。

一种解决方案是使用单独的非 Webspeed 应用程序来处理这些 oAUTH 请求，使用 Apache 服务器上的[`ProxyPass`指令](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)来模式匹配 URI 并将请求路由到适当的应用程序。

您可以使用任何非 Webspeed 技术。你想要，但由于我最了解 Ruby，我会指出优秀的[`omniauth`gem](https://github.com/intridea/omniauth)，它支持任意身份验证策略，包括 oAUTH。[您可以通过使用这些策略](https://github.com/intridea/omniauth/wiki/List-of-Strategies)中的任何一个来为您的特定提供商创建自定义 gem （请参阅“注释”部分并查看其中任何引用“OAuth API”或“OAuth 2 API”的策略）。

如果您想全力以赴并用不同的语言编写整个应用程序（但仍然使用 OpenEdge 数据库），我会吹响自己的号角并指出[OpenEdge 数据库的 Ruby 适配器](http://blog.abevoelker.com/final-ode-to-openedge-abl-part-1-a-ruby-adapter-is-born/)。这将允许您在 Web 应用程序中使用 Ruby on Rails 框架。