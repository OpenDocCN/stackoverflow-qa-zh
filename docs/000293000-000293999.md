# StackOverflow 问答 000293000-000293999

# algorithm - 确定语句/文本的积极或消极程度的算法

> ID：293000
> 
> 赞同：67
> 
> 时间：2008-11-15T20:14:25.317
> 
> 标签：algorithm, nlp

我需要一种算法来确定一个句子、段落或文章的语气是消极的还是积极的……或者更好的是，是消极的还是积极的。

例如：

> > Jason 是我见过的最糟糕的 SO 用户 (-10)
> > 
> > Jason 是 SO 用户 (0)
> > 
> > Jason 是我见过的最好的 SO 用户 (+10)
> > 
> > Jason 最擅长吸吮 SO (-10)
> > 
> > 虽然，在 SO 上还可以，但 Jason 在做坏事方面是最糟糕的（+10）

不容易吧？:)

我不希望有人向我解释这个算法，但我认为在学术界的某个地方已经有很多类似的工作。如果你能指点我一些文章或研究，我会喜欢的。

谢谢。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-15T20:50:55.913

自然语言处理的一个子领域称为[情感分析](http://en.wikipedia.org/wiki/Sentiment_analysis)，专门处理这个问题领域。由于在线用户论坛（ugc 或用户生成的内容）对消费产品进行了如此严格的审查，因此该领域已经完成了大量的商业工作。还有一个来自谢菲尔德大学的名为[GATE的文本分析原型平台，以及一个名为](http://gate.ac.uk/)[nltk](http://sourceforge.net/projects/nltk/)的 python 项目。两者都被认为是灵活的，但性能不是很高。一个或另一个可能有利于制定你自己的想法。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-12-24T13:41:12.250

在我的公司，我们有一种产品可以做到这一点并且性能也很好。我做了大部分工作。我可以给出一个简单的想法：

您需要将段落拆分为句子，然后将每个句子拆分为更小的子句子 - 根据逗号、连字符、分号、冒号、“和”、“或”等进行拆分。每个子句子将表现出完全独立的情绪在某些情况下。

有些句子即使是分开的，也必须连接在一起。

例如：产品很棒，很棒，很棒。

我们已经制定了一套关于需要拆分和不应该拆分的句子类型的综合规则（基于单词的 POS 标签）

在第一级，您可以使用词袋方法，即含义 - 列出积极和消极的词/短语并检查每个子句。在这样做的同时，还要看看“不”、“不”等否定词，它们会改变句子的极性。

即使那样，如果您找不到情绪，您也可以采用[朴素贝叶斯](http://en.wikipedia.org/wiki/Naive_Bayesian_classification)方法。这种方法不是很准确（大约 60%）。但是，如果您仅将其应用于未能通过第一组规则的句子 - 您可以轻松达到 80-85% 的准确率。

重要的部分是正面/负面的单词列表以及你拆分事物的方式。如果你愿意，你甚至可以通过实现[HMM](http://en.wikipedia.org/wiki/Hidden_Markov_model)（隐马尔可夫模型）或[CRF](http://en.wikipedia.org/wiki/Conditional_random_field)（条件随机场）来达到更高的水平。但我不是 NLP 方面的专家，其他人可能会填补你的空白。

对于好奇的人，我们用 NLTK 和 Reverend Bayes 模块实现了这一切。

非常简单，可以处理大部分句子。但是，您在尝试标记来自网络的内容时可能会遇到问题。大多数人不会在网络上写出正确的句子。处理讽刺也非常困难。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-15T20:21:05.833

这属于[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)的范畴，因此阅读这方面的内容可能是一个不错的起点。

如果您不想解决一个非常复杂的问题，您可以创建“正面”和“负面”单词的列表（如果需要，可以对它们进行加权）并对文本部分进行字数统计。显然，这不是一个“聪明”的解决方案，但它可以通过很少的工作为您提供一些信息，而在这些地方进行严肃的 NLP 将非常耗时。

您的一个示例可能会被标记为正面，而实际上使用这种方法是负面的（“Jason 最擅长吸吮 SO”），除非您碰巧认为“吸吮”比“最佳”更重要......但也是这个是一个小文本样本，如果您正在查看段落或更多文本，那么加权变得更加可靠，除非您有人故意试图欺骗您的算法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-15T21:26:11.693

正如所指出的，这属于自然语言处理下的情感分析。
Afaik GATE 没有任何进行情绪分析的组件。[根据我的经验，我已经实现了一种算法，该算法改编自Theresa Wilson、Janyce Wiebe、Paul Hoffmann（ this](http://www.cs.pitt.edu/~wiebe/pubs/papers/emnlp05polarity.pdf)
） 的论文“Recognizing Contextual Polarity in Phrase-Level Sentiment Analysis”中的一个GATE插件，它给出了合理的好结果。如果您想引导实施，它可以帮助您。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-15T22:08:23.807

根据您的应用程序，您可以通过[贝叶斯过滤](http://en.wikipedia.org/wiki/Bayesian_spam_filtering)算法（通常用于垃圾邮件过滤器）来实现。

一种方法是使用两个过滤器。一个用于正面文件，另一个用于负面文件。您将使用正面文档（无论您使用什么标准）为正面过滤器播种，并为负面文档播种负面过滤器。诀窍是找到这些文件。也许您可以设置它，以便您的用户有效地评价文档。

积极过滤器（一旦播种）将寻找积极的词。也许它会以*love*，*Peace*等词结束。负面过滤器也会适当地播种。

设置过滤器后，您可以通过它们运行测试文本以得出正面和负面分数。根据这些分数和一些权重，您可以得出您的数字分数。

贝叶斯过滤器虽然简单，却出奇地有效。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-21T12:33:10.043

你可以这样做：

```
 Jason is the worst SO user I have ever witnessed (-10) 
```

最差（-），其余为（+）。所以，那将是 (-) + (+) = (-)

```
 Jason is an SO user (0) 
```

( ) + ( ) = ( )

```
 Jason is the best SO user I have ever seen (+10) 
```

最好 (+) ，其余的是 ( )。所以，那将是 (+) + ( ) = (+)

```
 Jason is the best at sucking with SO (-10) 
```

最好的（+），吸吮（-）。所以，(+) + (-) = (-)

```
 While, okay at SO, Jason is the worst at doing bad (+10) 
```

最差（-），做坏事（-）。所以，(-) + (-) = (+)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-19T04:59:26.067

这种情绪分析有很多机器学习方法。我使用了大部分已经实现的机器学习算法。我用过的案例

## [weka](http://weka.wikispaces.com/Use+WEKA+in+your+Java+code)分类算法

*   支持向量机
*   天真无邪
*   J48

    只有您必须根据您的上下文训练模型，添加特征向量和基于规则的调整。就我而言，我得到了一些（61% 的准确率）。所以我们进入了[stanford core nlp](http://nlp.stanford.edu/software/corenlp.shtml)（他们为电影评论训练了他们的模型），我们使用了他们的训练集并添加了我们的训练集。我们可以达到 80-90% 的准确率。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-07-14T21:47:48.770

这是一个老问题，但我偶然发现了一个可以分析文章语气的工具，并找到了 IBM 的[Watson Tone Analyzer](https://tone-analyzer-demo.mybluemix.net/)。它允许每月免费调用 1​​000 次 API。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-15T20:29:06.677

我认为这完全取决于上下文。如果您正在寻找最擅长吸吮 SO 的人。吸吮最好的东西可能是一件积极的事情。为了确定什么是坏的或好的，我可以推荐多少研究模糊逻辑。

这有点像个子高。1.95m的人可以认为是高个子。如果你把那个人放在一个人都超过 2.10m 的组中，他看起来很矮。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-15T21:12:16.493

也许论文评分软件可以用来估计语气？[有线](http://www.wired.com/science/discoveries/news/2005/05/67458 "连线：计算机年级学生")文章。
[可能](http://www3.interscience.wiley.com/journal/119380725/abstract?CRETRY=1&SRETRY=0 "威利交叉科学")的参考。（我看不懂。）
[这份](http://www.jdentaled.org/cgi/reprint/69/2/285.pdf "牙科学生写作技巧的计算机化评估")报告将写作技巧与阅读它所需的 Flesch-Kincaid 年级水平进行了比较！[e-](http://www.ets.org/Media/Research/pdf/RD_Connections2.pdf "e-rator Overview")
rator 的第 4 页说他们关注拼写错误等。（也许不好的帖子也拼错了！）[Slashdot](http://slashdot.org/article.pl?sid=04/05/20/1551235 "Slashdot:Indiana First With Computerized Grading ")文章。

您还可以使用某种类型的电子邮件过滤器来处理消极性而不是垃圾邮件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-24T13:01:36.717

讽刺又如何：

*   Jason 是我见过的最好的 SO 用户，不是
*   Jason 是我见过的最好的 SO 用户，对吧

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-24T13:43:24.820

[啊，我记得我们评估过的一个名为LingPipe](http://alias-i.com/lingpipe/)（商业许可证）的Java 库。对于站点上可用的示例语料库，它可以正常工作，但对于真实数据，它非常糟糕。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-24T07:09:50.353

大多数情绪分析工具都是基于词典的，没有一个是完美的。此外，情感分析可以描述为三元情感分类或二元情感分类。此外，它是一个特定领域的任务。这意味着在新闻数据集上运行良好的工具可能无法很好地处理非正式和非结构化推文。

我建议使用几种工具，并使用基于聚合或投票的机制来决定情绪的强度。我遇到的关于情绪分析工具的最佳调查研究是[SentiBench](https://link.springer.com/article/10.1140/epjds/s13688-016-0085-1)。你会发现它很有帮助。

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2011-08-22T23:49:13.930

```
 use Algorithm::NaiveBayes;
     my $nb = Algorithm::NaiveBayes->new;

     $nb->add_instance
       (attributes => {foo => 1, bar => 1, baz => 3},
        label => 'sports');

     $nb->add_instance
       (attributes => {foo => 2, blurp => 1},
        label => ['sports', 'finance']);

     ... repeat for several more instances, then:
     $nb->train;

     # Find results for unseen instances
     my $result = $nb->predict
       (attributes => {bar => 3, blurp => 2}); 
```

# java - 如何将大型 Java 项目划分为更小的组件

> ID：293006
> 
> 赞同：9
> 
> 时间：2008-11-15T20:17:58.633
> 
> 标签：java, refactoring

我们试图将大代码库分成逻辑模块。我想要一些关于工具的建议，以及你在这类事情上可能有的任何经验。

该应用程序由一个服务器 WAR 和几个分布在 JAR 中的富客户端组成。问题在于它都在一个大而多毛的代码库中，一个大于 2k 文件的源树战争。每个 JAR 都有一个带有`main`方法的专用类，但依赖关系的纠结很快就会陷入困境。这并不是那么糟糕，良好的实践得到了一致的遵循，并且有特定任务的组件。它只需要一些改进来帮助我们的团队随着它的成长而扩展。

每个模块都在一个 Maven 项目中，由父 POM 构建。这个过程已经开始将每个 JAR/WAR 移动到它自己的项目中，但很明显，这只会触及表面：每个应用程序 JAR 中的一些类和一个庞大的“遗留”项目以及其他所有内容。此外，已经有一些单元和集成测试。

无论如何，我对工具、技术和一般建议很感兴趣，可以将过大且复杂的代码库分解成更易于管理的东西。免费/开源是首选。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-15T20:52:12.323

看看[结构 101](http://www.headwaysoftware.com/index.php)。它非常适合可视化依赖关系，并显示依赖关系以在您获得更清晰结构的过程中打破。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T06:39:39.563

我们最近完成了一项类似的任务，即一个包含> 1k 个源文件的项目，其中两个主要类必须拆分。我们最终得到了四个独立的项目，一个用于基本实用程序类，一个用于客户端数据库内容，一个用于服务器（该项目是一个 rmi-server-client 应用程序），一个用于客户端 gui 内容。我们的项目必须分开，因为其他应用程序仅将客户端用作命令行，并且如果您不小心使用了任何 gui 类，您将遇到仅在无头部署服务器上启动时发生的无头异常。

根据我们的经验，需要牢记以下几点：

*   使用**整个 sprint**来分离项目（不要让其他任务干扰拆分，因为您将需要整个 sprint 时间）
*   使用**版本控制**
*   在将任何功能移动到其他地方**之前**编写单元测试
*   使用**持续集成系统**（不管是自产还是开箱即用）
*   最小化当前变更集中的文件数量（当您必须撤消某些更改时，您将为自己节省大量工作）
*   **在移动类之前**一直使用依赖分析工具（我们在[DependencyFinder](http://depfind.sourceforge.net/)方面取得了很好的经验）
*   花时间将包重组为每个项目合理的包集
*   不要害怕更改接口但在工作区中有所有依赖的项目，这样你就会得到所有的编译错误

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T20:35:13.107

两个建议：您需要的第一件事是测试套件。第二个建议是小步骤工作。

如果您已经拥有强大的测试套件，那么您就处于有利位置。否则，我会进行一些好的高级测试（又名：系统测试）。

高级测试的主要优点是相对少量的测试可以让你获得很大的覆盖率。它们不会帮助您查明错误，但您实际上并不需要它：如果您以小步骤工作并且确保在每次更改后运行测试，您将能够快速检测到（意外引入）错误：错误的根源在于自上次运行测试以来代码的一小部分发生了变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T07:42:37.377

要继续 Itay 的回答，我建议阅读[Michael Feathers 的“有效使用旧代码”(pdf)](http://www.objectmentor.com/resources/articles/WorkingEffectivelyWithLegacyCode.pdf)。他还建议每一步都要有测试支持。还有[A书长版](https://rads.stackoverflow.com/amzn/click/com/0131177052)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-15T20:46:28.887

我将从您需要完成的各种任务开始。

我最近面临着类似的任务，考虑到一个 15 年前的代码库，该代码库是由一系列彼此没有任何交流的开发人员制作的（一个在项目上工作，离开，然后另一个被录用，等等，没有串扰）。结果是完全不同的风格和质量的大杂烩。

为了使它工作，我们必须隔离必要的功能，与装饰绒毛不同，以使其全部工作。例如，里面有很多不同的字符串类，一个人花了很多时间在`COleDateTime`to`const char*`和 back 之间进行 2k 行转换；那是绒毛，用于解决主要目标的附属任务的代码（将事物进出数据库）。

我们最终要做的是确定这段代码实现的一个大目标，然后为此编写基本逻辑。当有一项我们知道以前已经完成的任务需要完成时，我们会找到它并将其包装在库调用中，以便它可以独立存在。例如，一个代码块激活 USB 设备驱动程序以创建图像；此当前项目未触及该代码，但在必要时通过库调用调用该代码。另一个代码块用于安全加密狗，还有一个代码块向远程服务器查询数据。这就是可以封装的所有必要代码。然而，绘图代码是用 15 年的时间构建的，如此疯狂的大厦，以至于在一个月的时间里用 OpenGL 重写比试图弄清楚别人做了什么然后如何添加更好地利用时间给它。

我在这里有点手忙脚乱，因为我们的项目是 MFC C++ 到 .NET C#，但基本原则适用：

1.  找到主要目标
2.  确定使主要目标成为可能的所有小目标
3.  隔离已封装的代码部分（如果有）以用作库调用
4.  找出将它们拼凑在一起的逻辑。

我希望这会有所帮助...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T16:41:53.217

Maven 允许您将小项目设置为较大项目的子项目。如果您想将项目的一部分提取为其他项目的单独库，那么 maven 也可以这样做。

话虽如此，您肯定需要记录您的任务，每个较小的项目将完成什么，然后（正如这里多次说明的那样）测试、测试、测试。您需要在整个项目中工作的测试，然后有与项目的各个部分一起工作的测试，这些部分最终将作为子项目。

当您开始提取功能时，您需要额外的测试以确保您的功能是一致的，并且您可以模拟输入到您的各种子项目中。

# c# - 是否可以从一个控件“窃取”事件处理程序并将其提供给另一个控件？

> ID：293007
> 
> 赞同：14
> 
> 时间：2008-11-15T20:18:23.983
> 
> 标签：c#, .net

我想做这样的事情：

```
Button btn1 = new Button();
btn1.Click += new EventHandler(btn1_Click);
Button btn2 = new Button();
// Take whatever event got assigned to btn1 and assign it to btn2.
btn2.Click += btn1.Click; // The compiler says no... 
```

其中 btn1_Click 已在类中定义：

```
void btn1_Click(object sender, EventArgs e)
{
    //
} 
```

当然，这不会编译（“事件 'System.Windows.Forms.Control.Click' 只能出现在 += 或 -=" 的左侧）。有没有办法从一个控件中获取事件处理程序并在运行时将其分配给另一个控件？如果这不可能，那么复制事件处理程序并在运行时将其分配给另一个控件是否可行？

几点：我已经用谷歌搜索了一段时间，但还没有找到办法。大多数尝试的方法都涉及反射，因此如果您阅读了我的问题并认为答案非常明显，请先尝试在 Visual Studio 中编译代码。或者，如果答案真的非常明显，请随意给我一巴掌。谢谢，我真的很期待看看这是否可能。

我知道我可以这样做：

```
btn2.Click += new EventHandler(btn1_Click); 
```

这不是我在这里寻找的。

这也不是我要找的：

```
EventHandler handy = new EventHandler(btn1_Click);
Button btn1 = new Button();
btn1.Click += handy;
Button btn2 = new Button();
btn2.Click += handy; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-15T20:43:02.823

是的，这在技术上是可行的。反射是必需的，因为许多成员都是私有的和内部的。启动一个新的[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)项目并添加两个按钮。然后：

```
using System;
using System.ComponentModel;
using System.Windows.Forms;
using System.Reflection;

namespace WindowsFormsApplication1 {
  public partial class Form1 : Form {
    public Form1() {
      InitializeComponent();
      button1.Click += new EventHandler(button1_Click);
      // Get secret click event key
      FieldInfo eventClick = typeof(Control).GetField("EventClick", BindingFlags.NonPublic | BindingFlags.Static);
      object secret = eventClick.GetValue(null);
      // Retrieve the click event
      PropertyInfo eventsProp = typeof(Component).GetProperty("Events", BindingFlags.NonPublic | BindingFlags.Instance);
      EventHandlerList events = (EventHandlerList)eventsProp.GetValue(button1, null);
      Delegate click = events[secret];
      // Remove it from button1, add it to button2
      events.RemoveHandler(secret, click);
      events = (EventHandlerList)eventsProp.GetValue(button2, null);
      events.AddHandler(secret, click);
    }

    void button1_Click(object sender, EventArgs e) {
      MessageBox.Show("Yada");
    }
  }
} 
```

如果这使您确信 Microsoft 非常努力地阻止您这样做，那么您就理解了代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T20:23:46.623

不，你不能这样做。原因是封装 - 事件*只是*订阅/取消订阅，即它们不会让您“窥视”以查看已订阅的处理程序。

您*可以*做的是从 Button 派生，并创建一个调用`OnClick`. 然后，您只需要创建`btn1`该类的实例，并订阅一个处理程序，该处理程序将`btn2`调用`btn1.RaiseClickEvent()`或您调用该方法的任何内容。

我不确定我是否真的会推荐它。你到底想做什么？更大的图景是什么？

编辑：我看到您已经接受了通过反射获取当前事件集的版本，但是如果您对在原始控件中调用 OnXXX 处理程序的替代方案感兴趣，我在这里有一个示例。我最初复制*了所有*事件，但这确实导致了一些非常奇怪的效果。请注意，此版本意味着如果有人在调用 CopyEvents*后*订阅了原始按钮中的事件，它仍然是“挂钩的”——也就是说，将两者关联起来并不重要。

```
using System;
using System.Drawing;
using System.Reflection;
using System.Windows.Forms;

class Test
{
    static void Main()
    {

        TextBox output = new TextBox 
        { 
            Multiline = true,
            Height = 350,
            Width = 200,
            Location = new Point (5, 15)
        };
        Button original = new Button
        { 
            Text = "Original",
            Location = new Point (210, 15)
        };
        original.Click += Log(output, "Click!");
        original.MouseEnter += Log(output, "MouseEnter");
        original.MouseLeave += Log(output, "MouseLeave");

        Button copyCat = new Button
        {
            Text = "CopyCat",
            Location = new Point (210, 50)
        };

        CopyEvents(original, copyCat, "Click", "MouseEnter", "MouseLeave");

        Form form = new Form 
        { 
            Width = 400, 
            Height = 420,
            Controls = { output, original, copyCat }
        };

        Application.Run(form);
    }

    private static void CopyEvents(object source, object target, params string[] events)
    {
        Type sourceType = source.GetType();
        Type targetType = target.GetType();
        MethodInfo invoker = typeof(MethodAndSource).GetMethod("Invoke");
        foreach (String eventName in events)
        {
            EventInfo sourceEvent = sourceType.GetEvent(eventName);
            if (sourceEvent == null)
            {
                Console.WriteLine("Can't find {0}.{1}", sourceType.Name, eventName);
                continue;
            }

            // Note: we currently assume that all events are compatible with
            // EventHandler. This method could do with more error checks...

            MethodInfo raiseMethod = sourceType.GetMethod("On"+sourceEvent.Name, 
                                                          BindingFlags.Instance | 
                                                          BindingFlags.Public | 
                                                          BindingFlags.NonPublic);
            if (raiseMethod == null)
            {
                Console.WriteLine("Can't find {0}.On{1}", sourceType.Name, sourceEvent.Name);
                continue;
            }
            EventInfo targetEvent = targetType.GetEvent(sourceEvent.Name);
            if (targetEvent == null)
            {
                Console.WriteLine("Can't find {0}.{1}", targetType.Name, sourceEvent.Name);
                continue;
            }
            MethodAndSource methodAndSource = new MethodAndSource(raiseMethod, source);
            Delegate handler = Delegate.CreateDelegate(sourceEvent.EventHandlerType,
                                                       methodAndSource,
                                                       invoker);

            targetEvent.AddEventHandler(target, handler);
        }
    }

    private static EventHandler Log(TextBox output, string text)
    {
        return (sender, args) => output.Text += text + "\r\n";
    }

    private class MethodAndSource
    {
        private readonly MethodInfo method;
        private readonly object source;

        internal MethodAndSource(MethodInfo method, object source)
        {
            this.method = method;
            this.source = source;
        }

        public void Invoke(object sender, EventArgs args)
        {
            method.Invoke(source, new object[] { args });
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T21:11:12.253

我对@nobugz 的解决方案进行了一些挖掘，并提出了这个可以用于大多数通用对象的通用版本。

我发现，我敢说，*自动*事件的事件实际上是使用同名的支持委托字段编译的：

所以这是一个为更简单的对象*窃取*事件处理程序的方法：

```
class Program
{
    static void Main(string[] args)
    {
        var d = new Dummy();
        var d2 = new Dummy();

        // Use anonymous methods without saving any references
        d.MyEvents += (sender, e) => { Console.WriteLine("One!"); };
        d.MyEvents += (sender, e) => { Console.WriteLine("Two!"); };

        // Find the backing field and get its value
        var theType = d.GetType();
        var bindingFlags = BindingFlags.NonPublic | BindingFlags.Instance;

        var backingField = theType.GetField("MyEvents", bindingFlags);
        var backingDelegate = backingField.GetValue(d) as Delegate;

        var handlers = backingDelegate.GetInvocationList();

        // Bind the handlers to the second instance
        foreach (var handler in handlers)
            d2.MyEvents += handler as EventHandler;

        // See if the handlers are fired
        d2.DoRaiseEvent();

        Console.ReadKey();
    }
}

class Dummy
{
    public event EventHandler MyEvents;

    public void DoRaiseEvent() { MyEvents(this, new EventArgs()); }
} 
```

认为它可能对某些人有用。

但请注意，事件在 Windows 窗体组件中的连接方式是完全不同的。它们经过优化，因此多个事件不会占用大量内存，只是保持空值。所以它需要更多的挖掘，但@nobugz 已经做到了:-)

文章*[Delegates and events](http://csharpindepth.com/Articles/Chapter2/Events.aspx)* about combined delegates 可能有助于澄清答案中的许多要点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T20:39:17.577

您可以为按钮和图片框使用通用事件处理程序（根据先前答案的评论），然后使用“发送者”对象来确定如何在运行时处理事件。

# .net - 使用 Visual Studio 类型数据集的技巧？

> ID：293019
> 
> 赞同：5
> 
> 时间：2008-11-15T20:33:14.937
> 
> 标签：.net, ado.net, dataset, strong-typing

在 Visual Studio 2005/2008 中使用强类型数据集时，如果基础数据库架构发生更改，唯一实用的刷新方法是删除数据集并从头开始重新创建。这没关系，除非我需要自定义数据集。

通过扩展部分数据集类进行自定义允许保留自定义，但随后一个简单的 FillBy() 再次变成一长串 SQL。

有什么方法可以在不丢失数据集自定义的情况下将数据集与数据库模式重新同步？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T20:39:29.087

如果您只是进行简单的更改，例如向表格添加字段，那么我右键单击表格并单击配置。再次通过向导添加新字段（甚至将 select 替换为 select *），它将字段添加到表中并同步您构建的所有查询。我有大约 10 个不同的自定义查询的表，当我重新配置表时，查询都正确更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T20:48:41.440

因为类型化的数据集使用生成的嵌套类，所以定制经常会丢失。我所做的是生成类型化的数据集，然后将几个类标记为部分。然后我创建包含重复嵌套类结构（也标记为部分）的单独文件。

这样我就可以重新生成我的数据集，而我唯一需要做的更新就是返回并再次使它们成为局部的。我的自定义设置保存在单独的文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T21:06:28.083

类型化数据集是邪恶的。LINQ to SQL 应该是类型化数据集，所以我喜欢将其视为类型化数据集 3.0。我希望当他们将 L2S 折叠到实体框架中时，他们保留了 L2S 如此出色的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T12:01:49.573

我在许多 Web 和 Windows 项目中都非常成功地使用了类型化数据集。一开始有一点发现——学习数据集设计器的所有怪癖，以及如何扩展数据集以提供更灵活的连接配置。但是一旦你克服了这一点，生成数据访问层将是快速的工作。

# caching - TYPO3：将插件从 USER 更改为 USER_INT 类型

> ID：293021
> 
> 赞同：6
> 
> 时间：2008-11-15T20:34:14.917
> 
> 标签：caching, typo3

我有一个有效的 TYPO3 扩展。它附在[这个 wiki 页面上](http://wiki.orbeon.com/forms/doc/developer-guide/form-runner-typo3-extension)。如何更改此扩展程序的代码，使其属于 USER_INT 类型？即，我不希望 TYPO3 缓存此插件的输出，并且希望 TYPO3 每次使用扩展名的页面都调用扩展名，即禁用此扩展名的缓存。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-18T12:47:04.360

要为您的扩展禁用缓存，请转到您的 piX/class.tx_XXX_piX.php 文件并删除以下行（在您的类声明下方）：

```
var $pi_checkCHash = true; 
```

您还需要在 main 方法中添加以下行（在 $this->pi_loadLL(); 下方）：

```
$this->pi_USER_INT_obj=1;    // Configuring so caching is not expected. This value means that no cHash params are ever set. We do this, because it's a USER_INT object! 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T20:10:08.140

grunwalski 相反，你必须改变它：

```
t3lib_extMgm::addPItoST43($_EXTKEY,'piX/class.tx_yourextension_piX.php','_piX','list_type',1); 
```

对此：

```
t3lib_extMgm::addPItoST43($_EXTKEY,'piX/class.tx_yourextension_piX.php','_piX','list_type',0); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-07T11:43:47.973

解决问题的最简单方法是返回 Extension Maganer，选择您的扩展程序，从下拉菜单中选择“在 Kickstarter 中编辑”，然后选择相应的前端插件来编辑它的属性。

选中第一个复选框，这意味着您希望将插件呈现为 USER_INT cObjects。之后单击查看结果按钮，取消选中右侧的所有自定义 PHP 文件（您自己的代码，如模块和插件），然后单击 WRITE 按钮。请小心。如果您不取消选中您自己文件的复选框，它们将被虚拟文件覆盖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-21T15:32:19.693

正确和完整的方法是结合@arturh 和@Mehdi Guermazi 的答案：

1.  `addPItoST43()`将ext_localconf.php中调用的最后一个参数从 1 更改为 0
2.  `var $pi_checkCHash = true;`从 pi1 类头部的属性定义中删除该行。
3.  将该行添加`$this->pi_USER_INT_obj=1;`到 pi1 中 main() 函数的开头。

这些更改与您使用@bencuss 解决方案中解释的kickstarter 方法时所获得的相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T18:56:30.453

当您使用 Kickstarter 创建扩展程序后，您还必须转到文件 [yourextension]/ext_localconf.php 并更改此行

```
t3lib_extMgm::addPItoST43($_EXTKEY,'piX/class.tx_yourextension_piX.php','_piX','list_type',0); 
```

对此：

```
t3lib_extMgm::addPItoST43($_EXTKEY,'piX/class.tx_yourextension_piX.php','_piX','list_type',1); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-16T13:11:53.150

编辑扩展“myext”的文件 setup.txt。将“USER”更改为“USER_INT”。

```
plugin.tx_myext = USER_INT
plugin.tx_myxt { 
```

这个扩展永远不会被缓存。

# sql - AX / Axapta：通过 SQL 检索自定义字段

> ID：293029
> 
> 赞同：-1
> 
> 时间：2008-11-15T20:42:10.020
> 
> 标签：sql, axapta, business-connector

我在这里创建了我自己的一个相当“肮脏”的业务连接器，我无法找到已创建的那些“自定义字段”。

它们出现在 AX 中 - 但在 SQL 数据库中，根本没有提及它们……我有一种预感，所有自定义字段都存储在数据库中的其他位置，因此表的原始状态不会被改变- 但是哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T13:06:26.080

Dynamics Ax 中没有这样的字段，但是 SQL Server 中的某些字段可以具有与 Ax 中不同的名称，因为在字段名称较长的情况下，字段 ID 会添加到字段名称的末尾。有一个 SQLDictionary 表来关联 Ax 中的名称和 SQL 中的名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T10:50:44.507

抱歉举起一具死尸，但我发现了发生了什么：

我为这个项目做这个项目的公司有两个 SQL-server，一个是 SRVSQL，另一个是 SQLSRV ;) 呵呵！

因此，当我连接到 SQLSRV 时，所有自定义字段都存储在 SRVSQL 的表中；）

（责怪网络管理员；）

# xml - XML-over-HTTP 分析/测试框架

> ID：293038
> 
> 赞同：3
> 
> 时间：2008-11-15T20:51:57.690
> 
> 标签：xml, http

我们与之交互的许多产品/服务（包括我们自己的）使用 XML-over-HTTP 或衍生产品（如 OMA IMPS IM/presence 协议）。

我正在寻找一些工具来“监听”流量并为模拟/测试生成客户端/服务器存根。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T23:41:03.167

在某种程度上，这听起来像是[maxq](http://maxq.tigris.org/)正在尝试做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T21:15:41.357

对于一个项目来说，这听起来是个好主意。

这不是一个解决方案，但您的第一步应该是至少支持已知的 Web 服务描述符。

为此，应该使用wireshark 或类似的东西来嗅探流量，并查看正在访问的URL。如果幸运的话，这些服务将是具有可检索描述符或接口模式的 Web 服务。检查 .xsd、.wsdl、.asmx

这里有些例子：

[http://www.webservicex.net/CurrencyConvertor.asmx](http://www.webservicex.net/CurrencyConvertor.asmx)

[http://www.weather.gov/forecasts/xml/DWMLgen/wsdl/ndfdXML.wsdl](http://www.weather.gov/forecasts/xml/DWMLgen/wsdl/ndfdXML.wsdl)

[http://www.weather.gov/forecasts/xml/DWMLgen/schema/DWML.xsd](http://www.weather.gov/forecasts/xml/DWMLgen/schema/DWML.xsd)

有一些 Microsoft 工具随 SDL 一起提供，可以为这些工具提供存根。

我不知道你有什么解决方案，但我解决这个问题的方法是： - 使用 wireshark 记录特定 web 服务的 http 对话。- 解析（或查看）这些文件以提取被调用的 URL 并跟踪消息传递 + xml 文档。- 根据参数创建存根。- 首先创建一些简单的模式匹配器和转换（xml + xsl 可以 = 代码或一些用于调试的页面）。

您可能还需要考虑 - 通信可能不是 2 路 xml - 它可能是带有查询字符串的 HTTP 帖子和 xml 响应。- XML 文档的格式可能不正确 XML- 在尝试生成任何内容之前测试解析每条消息。

# database - Common Lisp 中的函数持久化

> ID：293040
> 
> 赞同：9
> 
> 时间：2008-11-15T20:52:44.693
> 
> 标签：database, lisp, persistence, common-lisp

是否有任何 Common Lisp 的持久性解决方案，例如 Elephant，允许函数持久性？目前我的应用程序在数据库上存储一个标识符，然后在它所在的函数表中进行搜索，但是这种方法不允许存储动态创建的函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-15T22:04:25.627

它不是一种数据库持久性机制，但大多数 Common Lisps 都有一种为各种对象（包括函数）[编写 FASL的方法。](http://www.franz.com/support/documentation/8.1/doc/operators/excl/fasl-write.htm)例如：

```
cl-user(1): (compile (defun hello () (format t "~&Hello~%")))
hello
nil
nil
cl-user(2): (excl:fasl-write (symbol-function 'hello) "/tmp/hello.fasl")
t
cl-user(3): (excl:fasl-read "/tmp/hello.fasl")
(#<Function hello @ #x1000a964d2>) 
```

您可以写入流（为了方便起见，我在这里使用了文件），因此您可以轻松捕获这些字节并将它们填充到数据库中，如果您愿意的话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T08:47:01.753

Pascal Bourguignon[在 comp.lang.lisp 上给出了标准解决方案](https://groups.google.com/group/comp.lang.lisp/msg/d8c36bf24a98445a)。基本上，您必须将源表单写入文件，`COMPILE`然后再写入文件`LOAD`。

```
(defvar *anon*)

(defun save-anonymous-function (fname args body)
  (let ((fname (make-pathname :type "LISP" :case :common :defaults fname)))
     (with-open-file (src fname :direction :output
                     :if-does-not-exist :create :if-exists :supersede)
       (print `(defparameter *anon* (lambda ,args ,body)) src))
     (compile-file fname))) 
```

然后您必须读取该文件并将其存储在您的数据库中。要取回它，您需要从数据库中获取它并在加载之前将其写入文件中。

```
(defun load-anonymous-function (fname)
   (let ((*load-verbose* nil)
         (*anon* nil)) ; to avoid modifying the global one.
     (load fname)
     *anon*)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T19:14:29.010

[普通感冒](http://www.discontinuity.info/~pkhuong/common-cold/)可能是你想要的。它包括可序列化的闭包和可序列化的延续。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T21:08:05.583

函数是不透明的对象，所以你不会很幸运地将它们存储在文件或类似的东西中。但是，您可以存储列表并在从数据库中检索时对其进行[编译。](http://www.lispworks.com/documentation/HyperSpec/Body/f_cmp.htm#compile)

当然，这不会帮助您存储闭包。这将需要将词法环境与代码一起存储，而您都没有（可移植的）访问权限。从存储列表编译的代码必须完全依赖全局数据或存储在数据库中的数据。

顺便说一句，请注意您可以[调用](http://www.lispworks.com/documentation/HyperSpec/Body/f_funcal.htm#funcall)符号，因此您不需要用于全局函数的函数表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-15T21:23:12.807

您可以查看保存 Lisp 图像。这允许保存“足够的信息以在以后重新启动 Lisp 进程”。您可以在将函数加载到图像后保存它们。

这也可能比您所寻找的更高级，但这里是对该过程的（非常）简要介绍：[保存核心图像](http://www.sbcl.org/manual/Saving-a-Core-Image.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-26T14:21:28.877

请注意，存储代码可能不是那么好。Zope 开发人员是通过艰难的方式学会了这一点的。

# .net - MEF 是依赖注入框架吗？

> ID：293051
> 
> 赞同：32
> 
> 时间：2008-11-15T21:06:41.250
> 
> 标签：.net, unity-container, mef

最近宣布的 .NET 4.0 的托管可扩展性框架 (MEF) - 它是一个依赖注入框架吗？来自 Patterns and Practices 的 Microsoft Unity 在 4.0 中会过时吗？MEF 与 Unity 等框架相比如何？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-15T22:09:36.737

在 Scott Guthrie 的 PDC 2008 2nd Keynote 中特别提到，MEF 与扩展 Visual Studio 2008 和其他应用程序有更多的关系，而不必使用所有的 COM 和旧技术......扩展VS2008 中的文本版本显示在其他内容中。[从第 2 天主题演讲 ( http://www.microsoftpdc.com](http://www.microsoftpdc.com) )开始大约 1 小时 15 分钟，您将获得直接信息，但基本上，如果您要“构建具有内置可扩展性点的应用程序，可以轻松被发现，并且它支持发现扩展，”那么 MEF 就是你想要的。UNITY 是您想要的高质量 IoC 容器，它执行 DI 以及其他解决方案，但与企业库的集成非常简单。

关于 EL4.0（现在是 4.1 - [http://msdn.microsoft.com/en-us/library/dd203099.aspx](http://msdn.microsoft.com/en-us/library/dd203099.aspx)）中的 Unity，它实际上是位于版本 2 ObjectBuilder 和 EL4.1 之上的 IoC具有将各种 EL 应用程序块的配置与 Unity 统一起来的扩展点。

MEF 与 Unity 就像将苹果与橙子进行比较。这里有一些完整描述 UNITY 的精彩且具体的播客/网络广播，我强烈推荐：

DotNetRocks 节目 #393 [http://www.dotnetrocks.com/default.aspx?showNum=393](http://www.dotnetrocks.com/default.aspx?showNum=393) DNR.tv 节目 #126 [http://www.dnrtv.com/default.aspx?showNum=126](http://www.dnrtv.com/default.aspx?showNum=126)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T21:17:53.533

我看到一篇文章听起来像是一个但更多的信息（[PDC2008 上的 Scott Guthrie](http://silverlight.services.live.com/7359/gg/video.wmv) [视频/wmv]）让我认为它不仅仅是一个依赖注入框架。从[事物的声音来看，](http://blogs.msdn.com/kcwalina/archive/2008/04/25/MEF.aspx)它可以用于依赖注入，但也可以做更多的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-18T22:10:30.753

这是关于 MEF/MAF/Unity/Prism[的对话，我觉得很有启发性。](http://mef.codeplex.com/discussions/35083?ProjectName=mef)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T07:46:55.933

我想添加一个 mopre 行，我刚刚读到**MEF 不是控制反转的一部分（因为据说dependecny 是 IOC 的同义词）但它实现了它**。当我们通过依赖注入实现 IOC 时，我们通常使用 Unity，它有助于发现静态依赖项，但 MEF 允许我们增加应用程序的可扩展性，而无需静态配置组件，即使它们可以在运行时发现。还有其他链接可以为您提供更多帮助： [Unity 和 MEF 之间的区别](http://akashkava.com/blog/391/mef-vs-unity-in-composite-application-prism/)

# java - 感叹号的正向前瞻

> ID：293070
> 
> 赞同：1
> 
> 时间：2008-11-15T21:26:01.677
> 
> 标签：java, regex, regex-lookarounds

我正在尝试构建一个 Java 正则表达式来匹配“ `.jar!`”

问题是我不希望匹配器消耗感叹号。我尝试使用`Pattern.compile("\\.jar(?=!)")`但失败了。就像逃避感叹号一样。

任何人都可以让它工作还是这是一个 JDK 错误？

**更新**：我觉得自己像个白痴，`Pattern.compile("\\.jar(?=!)")`确实有效。我使用的是 Matcher.matches() 而不是 Matcher.find()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T21:37:32.387

使用您的正则表达式对我有用（使用 Sun JDK 1.6.0_02 for Linux）：

```
import java.util.regex.*;

public class Regex {
        private static final String text = ".jar!";

        private static final String regex = "\\.jar(?=!)";

        public static void main(String[] args) {
                Pattern pat = Pattern.compile(regex, Pattern.DOTALL);
                Matcher matcher = pat.matcher(text);
                if (matcher.find()) {
                        System.out.println("Match: " + matcher.group());
                } else {
                        System.out.println("No match.");
                }
        }
} 
```

印刷：

```
Match: .jar 
```

（没有！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T21:32:17.890

此外，您可以尝试对其进行拳击

```
Pattern.compile("\\.jar(?=[!])") 
```

[Java必须被打破：Perl]

```
use strict;
use warnings;

my @data = qw( .jar .jar! .jarx .jarx! );

my @patterns = (
  "\\.jar(?=!)",
  "\\.jar(?=\\!)",
  "\\.jar(?=[!])",
);

for my $pat ( @patterns ){
  for my $inp ( @data ) {
    if ( $inp =~ /$pat/ ) {
      print "$inp =~ $pat \n";
    }
  }
} 
```

->

```
.jar! =~ \.jar(?=!) 
.jar! =~ \.jar(?=\!) 
.jar! =~ \.jar(?=[!]) 
```

# .net - 应该为简单的 POCO 域对象编写哪些单元测试？

> ID：293081
> 
> 赞同：5
> 
> 时间：2008-11-15T21:34:30.677
> 
> 标签：.net, unit-testing, agile

所以标准的敏捷哲学会建议让你的域类成为简单的 POCO，这些 POCO 通过数据访问对象使用单独的代理层进行持久化（就像 NHibernate 那样）。它还建议获得尽可能高的单元测试覆盖率。

为这些简单的 POCO 对象编写测试是否有意义？假设我有一个看起来像这样的类：

```
public class Container {
 public int ContainerId { get; set;}
 public string Name { get; set;}
 public IList<Item> Contents { get; set;}
} 
```

我可以为此编写哪些有用的单元测试？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-15T22:14:20.347

通常，像这样的值对象不需要有自己的测试。您将从使用它来实际做某事的类中获得报道。

单元测试旨在测试行为。没有行为？不需要测试。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-15T22:03:49.603

实际上，我认为如果您在编写类之前就开始为此代码编写测试，那么您的实现会有所不同。例如，您可能最终会编写一个构造函数来初始化您的集合，这样您就可以引用它而不必每次都检查 null。我认为编写测试可能是一个好习惯，即使您认为不需要它们。通常在编写测试时，您会发现您所做的许多假设在您的第一次代码尝试中无法解决。

例如，ContainerId 可以小于零吗？尝试将其设置为负值会是错误吗？集合是否应该由构造函数初始化，即，使用此容器类的类是否必须在访问之前检查 null 还是要保证集合永远不会为 null，尽管它可能为空？

也就是说，我通常会在这个过程中应用一些理智。例如，如果我知道构造函数是内部作用域的，并且对象仅由 Factory 类创建。我将测试工厂方法以确保它们始终生成合法对象，但不一定要测试容器类本身。

无论如何，我想底线是假设类需要测试，尝试编写它们，并且只有在我想不出有意义的测试来编写时才省略它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-15T21:37:39.173

这只是我的习惯，我绝不是这一切的全部，但我不会编写测试，直到我有一个实际做某事的构造函数（即设置默认值）。

您需要测试自己的代码，而不是语言。每当您使用 new Container() 时，您都会得到保证，您将获得一个新的 Container。而且，如果你确实搞砸了那一步，编译器就会捕捉到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T21:45:43.883

我喜欢将单元测试视为“调用”一个意图单元。

您的代码表达的唯一意图是 getter 和 setter；作为语言的一部分，我们假设这些工作。

没有表达其他意图，因此不需要测试。

但是，我建议从`Contents`属性中删除 setter。[集合属性应该是只读的。](http://msdn.microsoft.com/en-us/library/ms182327(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T14:56:22.650

我认为这甚至不是一个对象——对象是由它的行为定义的，而这个类没有任何东西。它是一个纯数据容器。也可以拥有这些 - 而且它们通常不需要任何测试 - 但请注意，您最终不会得到[Anemic Domain Model](http://www.martinfowler.com/bliki/AnemicDomainModel.html)。使用测试驱动开发会“迫使”你首先考虑你的类的行为，这可能是一个很好的练习。

# css - 您的 XHTML/CSS 标记的语义如何？

> ID：293090
> 
> 赞同：5
> 
> 时间：2008-11-15T21:41:14.813
> 
> 标签：css, xhtml

我认为我很擅长在我的页面上使用语义标记，但我仍然有一些这样的类：

```
/**** Aligns ****/
.right_align  { text-align: right; }
.left_align   { text-align: left; }
.center_align { text-align: center; } 
```

从技术上讲，这是一个禁忌。但是当你只想在表格中放置一些文本时，我应该对语义标记有多疯狂？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-15T21:54:33.740

为什么要对齐文本？

问题的答案是选择器所需的 id 或类的名称。你想调整它，因为它是一个价格吗？

```
table .price {
  text-align: right
} 
```

只要问问自己*为什么*要应用一种特定的风格，一切都会变得清晰。

我可能做得过火了，但我的上一个工作项目非常接近 100% 语义——我需要的任何非语义的东西（比如，我不能没有布局要求的填充 div），我使用 jQuery 动态添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T21:55:47.453

如果您想要表格单元格和对齐之间的紧密耦合，您可以`style="text-align:right"`直接在标签上分配属性。如果您不将它用于抽象级别，则没有理由通过类进行额外的间接级别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T21:56:31.850

我尝试考虑为什么我想要在表格中右对齐的列。例如，如果列包含货币金额，那么我将使用名为货币的样式而不是 right_align。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T21:52:33.607

语义标记是一个令人钦佩的目标，但在现实世界中，您有时必须做出妥协。在某些情况下，做某事的唯一明智的方法是打破语义并只输入一个`right_align`.

编辑：人们似乎误解了我的观点。您应该尽可能使用语义标记。但是，在某些情况下，它实际上只是一种风格选择，并且没有任何固有的数据可以用来描述或分类它。对于大部分表格数据来说，这通常是正确的，尤其是在动态生成的情况下。

我遇到过客户希望能够动态控制数据网格中出现的列的情况。无法提前知道他们将选择显示什么类型的数据。如果他们想要一种使动态生成的列居中或右对齐的方法，最好让他们使用居中和右对齐类，而不是让它们`style`在任何地方粘贴属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-15T21:55:57.403

100% 语义标记是一个愚蠢的目标。你的平面设计师会说，“让我们把这个对齐”，原因是“因为这样看起来不错”。你应该怎么做，在 div 中添加一个“looksgoodthatway”类？恰到好处地调整它并继续你的生活！:)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-11-15T23:15:31.847

根据经验，出于可用性原因，您应该将令牌保留在尽可能多的行上。

我使用以下符号

```
匹配器，¶
匹配器¶
{¶
··属性：·属性；¶
}¶

```

你为什么问？这解决了许多碰撞问题，因为它减少了位置的数量 2 个不相关的变化可以同时在 2 个不同的地方发生（这会导致碰撞），并且当碰撞**确实**发生时，更容易看到是什么导致它并选择了正确的解决方案。

这是因为 SCM 的 DIFF 是面向行的，如果您将所有内容放在 1 行上，您将有 2 个选择，软管一套完整，或软管另一个。

此外，我发现，如果坚持这种特定的风格，可以很容易地编写检测 CSS 中错误的 lint 检查代码。

例如，找出错别字：

```
matcher 
matcher, 
{
    attribute property 
  attribute
} 
```

在这种情况下，仅检查空格和分隔符一致性的代码也会检测到编码错误！

# perl - 有哪些 RAD 工具可用于在 Perl 中构建 GUI？

> ID：293094
> 
> 赞同：3
> 
> 时间：2008-11-15T21:48:58.993
> 
> 标签：perl, user-interface, rad

我需要做一些快速而简单的 Perl GUI 构建。我买不起科莫多许可证。人们会推荐什么作为免费（如啤酒）替代品。我不在乎它是 UNIX 还是 Windows 或两者兼而有之。我会使用 Win32 Perl 或 Perl/Tk，这取决于什么是最好的解决方案。我也会看看任何使用其他东西的 PM。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T04:30:51.320

对于 Perl/Tk，有[ZooZ](http://www.perltk.org/index.php?option=content&task=view&id=28&Itemid=29)。

就个人而言，我更喜欢使用[Glade](http://glade.gnome.org/)进行 GUI 设计和[Gtk2::GladeXML](http://search.cpan.org/dist/Gtk2-GladeXML)。正如其他人提到的，还有 WxWidget 和 Qt 替代品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T03:58:23.850

Perlmonks 的帖子[http://www.perlmonks.org/?node_id=627282](http://www.perlmonks.org/?node_id=627282)以及谷歌搜索[“perl gui builder”](http://www.google.com/search?client=safari&rls=en-us&q=perl+gui+builder&ie=UTF-8&oe=UTF-8)可能会有所帮助。看到可用的内容后，您也许可以提出更具体的问题以获得更好的答案。

祝你好运， ：）

# c# - 具有访问权限的asp.net动态数据

> ID：293096
> 
> 赞同：0
> 
> 时间：2008-11-15T21:49:43.283
> 
> 标签：c#, asp.net, database, ms-access

你能用ms access作为asp.net动态数据项目网站的后端吗？任何链接或示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T22:19:35.250

起初我认为这应该是可能的，因为 .NET 通常支持[ODBC](http://msdn.microsoft.com/library/system.data.odbc.odbcconnectionstringbuilder.aspx "OdbcConnectionStringBuilder")，因此可以连接到 MS Access 数据库。Linq to SQL 和 ADO.NET Entity Framework 似乎是 ASP.NET 动态数据最流行的数据提供者。但是，似乎有些问题需要修改数据提供程序以使其与 EF 兼容，并且 Linq 2 Sql 仅支持 MS SQL Server。因此，目前似乎只有 MS SQL Server 和 MS SQL Server Compact[支持](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4015016 "实体框架 ODBC 支持")EF。不过，还有最后一个希望。根据Microsoft 论坛上的[这篇文章](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4015016 "实体框架 ODBC 支持")，您可以实现自己的[实体框架提供程序](http://code.msdn.microsoft.com/EFSampleProvider "实体框架示例提供程序")来支持 Access 或 ODBC。

# winapi - 如何从服务返回错误？

> ID：293098
> 
> 赞同：1
> 
> 时间：2008-11-15T21:52:32.903
> 
> 标签：winapi, windows-services, service

我正在编写一个服务应用程序，有时无法在从服务 MMC 接收到 SERVICE_CONTROL_STOP 后立即停止。我目前这样处理它：（在伪代码中）：

```
DWORD 
HandlerEx(
    DWORD dwControl, 
    DWORD dwEventType, 
    PVOID pvEventData, 
    PVOID pvContext
) 
{
    switch( dwControl )
    {
    case SERVICE_CONTROL_STOP:
        if ( CanStopServiceNow() )
        {
             ReportStatus( SERVICE_STOP_PENDING );
             DoStopService();
             ReportStatus( SERVICE_STOPPED );
             return NO_ERROR;
        }
        else
             return ERROR_BUSY;
        break;
    }

    return NO_ERROR;
} 
```

当服务可以停止（并且确实停止）时，它运行良好，但是当它无法停止时，我希望 Windows 报告我返回的错误（在此示例中为 ERROR_BUSY。）相反，Windows 显示一条消息说：

```
"The service did not return an error. 
This could be an internal Windows error or an internal service error." 
```

所以我的问题是，如何让服务向 SCM 报告它现在无法停止并让 MMC 显示有关我返回的实际错误代码的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T22:51:34.377

我知道这不会回答您的具体问题。但我认为答案是“没有办法”。无论如何我都会提出建议。大多数需要对其启动和关闭进行更多控制的应用程序，我可以想到 Sap 和 Oracle，将 windows 服务用作管理服务，并实现 gui 或命令行界面来启动和停止实际的“工作进程”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T18:14:55.447

回答我自己的问题（在更详细地调查问题之后）：服务不应从 HandlerEx 函数返回错误代码，而应将其状态报告给 SCM，指示它是否可以接受 SERVICE_CONTROL_STOP 代码。如果服务检测到无法立即停止，则应清除其 SERVICE_STATUS 结构中的 SERVICE_ACCEPT_STOP 位并调用 SetServiceStatus()。这应该可以防止 SCM 首先尝试停止服务。当条件清除并且服务决定可以安全停止时，它应该设置 SERVICE_ACCEPT_STOP 位并再次调用 SetServiceStatus()。

# loops - VB6 - 使用 do while 循环语法编译错误

> ID：293100
> 
> 赞同：0
> 
> 时间：2008-11-15T21:53:30.750
> 
> 标签：loops, vb6, do-while

我有一个 do-while 循环，它应该做三件事，逐行浏览文本文件，文本文件包含路径名和文件名（C:\Folder\file1.txt）。

如果该行包含某个字符串，则它将文件复制到该位置，将其重命名为文本文件中的名称，然后替换复制文件中的字符串。
如果不是，则继续下一行。

我认为这将是相当直截了当的，但它似乎并没有奏效。我目前甚至无法编译，因为我收到错误说循环的语法错误。

任何帮助将不胜感激，这是整个函数的代码：

```
Private Sub Command2_Click()

    Dim LineData As String 
    Dim FileHandle As Integer

    FileHandle = FreeFile
    Open "C:\textfile.txt" For Input As #FileHandle

    Do While Not EOF(FileHandle)
        Line Input #FileHandle, LineData
        If InStr(LineData, ".log") Then
            FileCopy "C:\thefile.log",LineData
            Open LineData For Input As #3
             #3 = Replace$(#3, "abc", "xyz")
        Else
        End If  
    Loop

    Close #FileHandle
    Close #3

    MsgBox "Copy, Replace, Complete!"

End Sub 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T22:07:35.900

我不相信

```
#3 = Replace$(#3, "abc", "xyz") 
```

已验证。您需要逐行读取该文件的内容（或一次读取一些合理的块），进行替换，然后将其写回新文件。当您无论如何都在复制文件时，我建议您从源位置读取它，并将新版本写入文件将被复制到的位置。

例如...

```
Private Sub Command2_Click()
 Dim LineData As String
 Dim FileHandle As Integer
 Dim sourceHandle as Integer
 Dim destHandle as Integer
 dim temp as string
 FileHandle = FreeFile
 Open "C:\textfile.txt" For Input As #FileHandle
 Do While Not EOF(FileHandle)
  Line Input #FileHandle, LineData
  If InStr(LineData, ".log") Then
   sourceHandle=FreeFile
   Open "C:\thefile.log" For Input as #sourceHandle
   destHandle=FreeFile
   Open LineData For Output as #destHandle
   Do while Not EOF(sourceHandle)
    Line Input #sourceHandle,temp
    temp=replace$(temp,"abc","xyz")
    Print #destHandle,temp
   Loop
   Close #destHandle
   Close #sourceHandle
  End If
 Loop
Close #FileHandle
MsgBox "Copy, Replace, Complete!"
End Sub 
```

抱歉，如果有任何错误，由于我没有在这台计算机上安装 VB IDE，因此未经测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T12:04:30.860

#3 = Replace$... 是您的问题线...修复该问题和其他内容会导致：

```
Private Sub Command2_Click()
  Dim LineData As String
  Dim FileHandle As Integer
  Dim Buffer As String
  FileHandle = FreeFile
  Open "C:\thefile.log" For Binary Access Read As #FileHandle
  Buffer = Space(LOF(FileHandle))
  Get #FileHandle, , Buffer
  Buffer = Replace(Buffer, "abc", "xyz")
  Close #FileHandle
  FileHandle = FreeFile
  Open "C:\textfile.txt" For Input As #FileHandle
  Do Until EOF(FileHandle)
    Line Input #FileHandle, LineData
    If InStr(LineData, ".log") Then
      Open LineData For Output As #3
      Print #3, Buffer;
      Close #3
    End If
  Loop
  Close #FileHandle
  MsgBox "Copy, Replace, Complete!"
End Sub 
```

如果您更喜欢极简主义和简短的代码，则可以改用：

```
Private Sub Command2_Click()
  ''// This code requires a reference to Microsoft Scripting runtime (Project -> References)
  Dim FSO As New Scripting.FileSystemObject
  Dim Files() As String
  Dim File As String
  Dim Data As String
  Data = Replace(FSO.OpenTextFile("C:\thefile.log").ReadAll(), "abc", "xyz")
  Files = Split(FSO.OpenTextFile("C:\textfile.txt").ReadAll(), vbCrLf)
  For Each File In Files
    If InStr(File, ".log") > 0 Then FSO.CreateTextFile(File, True).Write Data
  Next
  MsgBox "Copy, Replace, Complete!"
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T22:00:36.537

我看到的一个问题是你打开文件句柄，然后是#3，但是你以相同的顺序关闭它们，你应该关闭#3，然后是文件句柄。

我看到发生的是文件句柄被打开，然后它搜索包含“.log”的行，然后它做了一些事情——到目前为止，一切都很好。然而，它随后打开#3，执行其他操作，然后循环。完成后需要关闭#3。

将“Close #3”向上移动 4 行（到“#3 = Replace...”之后的下一条语句应该符合您的预期并且应该可以编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-05T16:36:43.427

我想向您建议一种不同的方法。我做过类似的事情，只是我事先知道我正在制作副本，我的方法是打开源代码和新目标（副本）。然后我逐行读取源文件，对我读入的变量进行必要的更改，然后再将其写回副本。我的文件永远不会超过几个 k，这足够快并且消除了你的一个循环。您必须在循环内有一个变量来告诉您在完成后将文件重命名为什么，或者如果您没有找到您正在寻找的行并且不需要副本，则删除该文件。

# java - 从 Jar 存档中读取类的 Java 命令行问题

> ID：293114
> 
> 赞同：2
> 
> 时间：2008-11-15T22:01:05.663
> 
> 标签：java, command-line

我正在尝试使用如下命令行语法运行基于 java 的工具：java -cp archive.jar archiveFolder.theMainClassName。虽然我正在搜索的类是一个主类，但“theMainClassName”在archive.jar 中，并且在输入时给出的archiveFolder中，我不断收到我的班级没有看到的错误。有人对这个问题有任何想法吗？先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T22:19:51.303

这是一个有效的具体示例，因此您可以比较自己的情况*。*

把这段代码放在任何地方，在一个名为`MainClass.java`. （我假设了一个`src`稍后调用的目录。当然，通常你会安排源以匹配包。）

```
package archiveFolder;

public class MainClass
{
    public static void main(String[] args)
    {
        System.out.println("I'm MainClass");
    }
} 
```

然后运行以下每个命令：

```
# Compile the source
javac -d . src/MainClass.java

# Build the jar file
jar cf archive.jar archiveFolder

# Remove the unpackaged binary, to prove it's not being used
rm -rf archiveFolder # Or rmdir /s /q archiveFolder on Windows

# Execute the class
java -cp archive.jar achiveFolder.MainClass 
```

结果：

```
I'm MainClass 
```

你是如何构建你的 jar 文件的？代码是否在适当的包中？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T22:06:46.633

MainClassName 类是否在顶部具有以下包行：

```
package archiveFolder 
```

您需要类文件与声明的包位于相同的目录结构中。所以如果你有类似的东西：

```
org/jc/tests/TestClass.class 
```

它的源文件必须如下所示：

```
package org.jc.tests;

public class TestClass {
  public static void main(String[] args) {
    System.out.printf("This is a test class!\n");
  }
} 
```

然后您可以使用以下内容创建 jar 文件并从命令行运行它（假设当前目录位于顶层，就在 org 之上）：

```
$ jar -cf testJar.jar org/jc/tests/*.class
$ java -cp testJar.jar org.jc.tests.TestClass 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T22:04:03.193

也许与`java -jar archive.jar`？

当然，它假设清单指向正确的类......

你应该给出你得到的确切信息，它可能会更清楚。

编辑：有关在 jar 清单文件中设置应用程序入口点（主类）的信息，请参阅[使用清单文件：基础知识。](http://java.sun.com/docs/books/tutorial/deployment/jar/manifestindex.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T14:42:26.297

通常，当找不到依赖类（静态成员）时会发生这种情况 - 像这样，使用 log4j：

```
public class MyClass {
  private static Logger log = Logger.getLogger("com.example");
} 
```

原因是这样一个静态成员的初始化可以理解为类加载的一部分——错误导致类不可用（loadable），导致你描述的错误。

静态构造函数是另一个可能的原因：

```
public class MyClass {
  static {
     // <b>any</b> error caused here will cause the class to 
     // not be loaded. Demonstrating with stupid typecast.
     Object o = new String();
     Integer i = (Integer) o;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T20:17:33.593

我认为其他人在这里介绍了一些常见的东西。我会 jar tf jar 并确保列出了该类。我还要仔细检查这个类是公共的，方法是“public static void main(String[] arg)”。

# linq - Linq-to-SQL 如何防止使用 Delete 方法？

> ID：293117
> 
> 赞同：4
> 
> 时间：2008-11-15T22:04:08.060
> 
> 标签：linq, linq-to-sql, stored-procedures

按照惯例，我们的数据库只允许对 INSERT、UPDATE 和 DELETE 使用存储过程。对于某些表/类型，没有 DELETE 存储过程，因为不允许删除行。（您只能将此类类型的状态更新为“已删除”）。例如，客户可能被标记为已删除，但从未真正从数据库中删除。

**如何防止对数据访问层中的某些类型使用 Delete() = 在 DMBL 中？**

插入和更新的“默认方法”映射到相应的存储过程。但是对于 Delete 它说**“使用运行时”**。我想将其设置为“不允许”。

有没有办法在数据库模型层上实现这一点？

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-15T22:12:35.203

为每个此类实体实现一个分部类并实现 OnValidate 分部方法。它将 ChangeAction 作为参数。当 ChangeAction 为 ChangeAction.Delete 时，抛出一个异常，指示该操作是不允许的（可能是 IllegalOperationException）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T23:35:50.853

在开发我的一个应用程序时，我遇到了同样的限制。您始终可以配置删除操作以使用某个存储过程，而不是框架为其生成 sql 命令。就我而言，当我说删除时，我们只是想将特定行标记为已删除，而不是物理删除它。所以我们的更新存储过程在删除命令中被重用，以简单地将 isDeleted col 值标记为 true。除此之外，您可能希望围绕 DBML 构建的类构建某种包装器并禁止删除方法。现在我没有看到任何特殊设置让框架只生成创建和更新方法。部分课程可能是另一种选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T03:44:50.180

如何为您用来连接数据库的用户配置权限？您可以为此特定用户设置拒绝删除操作，因此无法在数据库级别使用 DELETE 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T22:44:51.893

不生成删除 API，我的意思是生成的表上的选项不能删除将项目标记为已删除的能力。`DeleteOnSubmit`是`Table<TEntity>`班级的一部分。

如果删除实体总是出错，应该按照 tvanfosson 的建议`OnValidate`抛出一个错误。`InvalidOperationException`

我尝试将 Linq 映射到 Sql 删除到存储过程，它只是将字段设置为 true。这很奇怪，因为`DataContext`在“删除”之后删除了实例，但它们是合法的域实体，应该仍然在`DataContext`提交之后。

# workflow-foundation - ManualWorkflowSchedulerService.RunWorkflow 的线程安全

> ID：293121
> 
> 赞同：1
> 
> 时间：2008-11-15T22:06:18.430
> 
> 标签：workflow-foundation

我想知道 ManualWorkflowSchedulerService.RunWorkflow() 的正确用法。当我调用 ManualWorkflowSchedulerService.RunWorkflow 时，是否需要跨线程同步对同一个 workflowInstanceId 的调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T23:18:00.390

不，我不这么认为。[以下是“Essential Windows Workflow Foundation”一书](http://books.google.com/books?id=WSBYZwkzZyEC&printsec=frontcover&ei=v1cfSejfHIyYyASjw5mlBQ#PPA202,M1)的相关摘录

> 尽管可以在任意线程上调用 WorkflowInstance 上的操作，但托管在程序实例中的 WF 调度程序由单个线程提供服务。WF 运行时保证在调度程序循环正在积极处理工作项时，没有其他线程可以干扰或服务调度程序。**需要明确的是，托管应用程序可以同时在单独的线程上调用 WorkflowInstance 的方法——这不会影响调度程序在专用线程上执行活动**（对于一个执行片段）。

* * *

编辑：为了进一步调查这个问题，我创建了一个 wf，`ParallelActivity`其中包含两个`HandleExternalEvent`活动。每个活动的`invoked`处理程序只是将其线程休眠 3 秒。在宿主程序中，我创建了两个线程并通过服务触发了这两个事件。此外，我将其子类化`ManualWorkflowSchedulerService`以跟踪其`Schedule`方法。以下是结果（时间为毫秒的 10 分之一）：

```
Src    Time Thread
HOST   7616      1 CreateWorkflow
MWSS   7642      1 Schedule workflow
HOST   8297     12 Trigger event 1 and wait for RunWorkflow
MWSS   8316     12 Schedule workflow
  WF   8327     12 Handler 1 Invoked...wait 3 sec
HOST   8327      1 Press any key to exit...
HOST   8767     13 Trigger event 2 and wait for RunWorkflow
MWSS   8784     13 Schedule workflow
  WF  38319     12 Handler 1 Completed
  WF  38406     12 Handler 2 Invoked...wait 3 sec
  WF  68396     12 Handler 2 Completed
HOST  68573     13 RunWorkflow for event 2 completed in 5,98 sec
HOST  68794     12 WorkflowCompleted
HOST  68795     12 RunWorkflow for event 1 completed in 6,05 sec 
```

一些备注：

1.  调度程序总是使用主机的线程来调度工作项。
2.  工作流实例*并不总是*使用宿主的线程来执行活动。如果另一个活动已经在线程中执行，则该线程用于执行所有计划的活动。
3.  处理程序的执行是线程安全的，但是两个线程都等待两个处理程序完成！

如果您担心后者，我建议您发布以下帖子：

*   [了解 Windows 工作流中的 ParallelActivity](http://blogs.msdn.com/kaevans/archive/2007/09/12/understanding-parallelactivity-in-windows-workflow.aspx)
*   [使用工作流并行调用 Web 服务](http://blogs.msdn.com/kaevans/archive/2007/07/03/use-workflow-to-invoke-web-services-in-parallel.aspx)

顺便说一句，你能分享一些关于你所面临的场景的信息吗？

# regex - 我怎样才能使这个正则表达式更紧凑？

> ID：293134
> 
> 赞同：1
> 
> 时间：2008-11-15T22:14:26.823
> 
> 标签：regex

假设我有这样一行文字

```
Small   0.0..20.0   0.00    1.49    25.71   41.05   12.31   0.00    80.56 
```

我想捕获最后六个数字并忽略*Small*和前两组数字。

对于本练习，让我们忽略这样一个事实，即只进行某种字符串拆分而不是正则表达式可能更容易。

我有这个有效的正则表达式，但看起来有点可怕

```
^(Small).*?[0-9.]+.*?[0-9.]+.*?([0-9.]+).*?([0-9.]+).*?([0-9.]+).*?([0-9.]+).*?([0-9.]+).*?([0-9.]+) 
```

有什么方法可以压缩它吗？

例如，是否可以将最后 6 个数字的检查合并到一个语句中，该语句仍将结果存储为 6 个单独的组匹配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T22:24:04.993

如果您想将每个匹配项保存在单独的反向引用中，您别无选择，只能“拼写出来” - 如果您使用重复，您可以将所有六个组“作为一个”或只捕获最后一个，具体取决于您在哪里把捕获括号。所以不，不可能压缩正则表达式并仍然保留所有六个单独的匹配项。

一个更有效（虽然不漂亮）的正则表达式是：

```
^Small\s+[0-9.]+\s+[0-9.]+\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+)\s+([0-9.]+) 
```

因为它明确匹配空格。您的正则表达式将导致大量回溯。我的正则表达式匹配 28 步，你的匹配 106 步。

顺便说一句：在 Python 中，你可以简单地做一个

```
>>> pieces = "Small   0.0..20.0   0.00    1.49    25.71   41.05   12.31   0.00    80.56".split()[-6:]
>>> print pieces
['1.49', '25.71', '41.05', '12.31', '0.00', '80.56'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-15T23:01:20.190

这是我能得到的最短的：

```
^Small\s+(?:[\d.]+\s+){2}([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s+([\d.]+)\s*$ 
```

它必须很长，因为必须明确指定每个捕获。不过，无需捕获“小”。但最好尽可能具体（\s 而不是 .），并在两端锚定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T22:45:23.373

为了可用性，您应该使用字符串替换从复合部分构建正则表达式。

```
$d = "[0-9.]+"; 
$s = ".*?"; 

$re = "^(Small)$s$d$s$d$s($d)$s($d)$s($d)$s($d)$s($d)$s($d)"; 
```

至少你可以看到模式之外的结构，改变一个部分会改变它们。

如果您想获得真正的 ANSI，您可以使用简短的元语法并使其更易于阅读：

```
$re = "^(Small)_#D_#D_(#D)_(#D)_(#D)_(#D)_(#D)_(#D)"; 
$re = str_replace('#D','[0-9.]+',$re); 
$re = str_replace('_', '.*?' , $re ); 
```

（通过这种方式，更改空格标记或数字标记的定义也变得很简单）

# java - 禁用 JSP 扩展处理

> ID：293135
> 
> 赞同：1
> 
> 时间：2008-11-15T22:14:55.057
> 
> 标签：java, jsp, servlets, websphere

我有一个在 WebSphere Application Server 6.0 上运行的 JavaEE 1.4 Web 应用程序。在`web.xml`中，有一个 servlet 配置为拦截所有服务器请求：

```
<servlet-mapping>
    <servlet-name>name</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

在我尝试请求以`*.jsp`. 在这种情况下，服务器尝试使用此名称查找 JSP，但失败并出现以下错误：

```
java.io.FileNotFoundException: JSPG0036E: 未能找到资源 /cfvct/search_criteria.jsp
    在 com.ibm.ws.jsp.webcontainerext.JSPExtensionProcessor.findWrapper(JSPExtensionProcessor.java:279)
    在 com.ibm.ws.jsp.webcontainerext.JSPExtensionProcessor.handleRequest(JSPExtensionProcessor.java:261)
    在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3226)
    在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:253)
    在 com.ibm.ws.webcontainer.VirtualHost.handleRequest(VirtualHost.java:229)
    在 com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:1970)
    在 com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:120)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:434)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:373)
    在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:253)
    在 com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:207)
    在 com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:109)
    在 com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(WorkQueueManager.java:566)
    在 com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueueManager.java:619)
    在 com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueueManager.java:952)
    在 com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueueManager.java:1039)
    在 com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1475)

```

我需要让 servlet 处理这个请求，但似乎服务器使用一些`JSPExtensionProcessor`来处理所有以`.jsp`. 有没有办法改变这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T22:37:20.253

是的，您需要将您的 servlet 映射到 *.jsp 以便将 *.jsp 支持重定向到您的 servlet。

```
<servlet-mapping>
        <servlet-name>name</servlet-name>
        <url-pattern>*.jsp</url-pattern>
</servlet-mapping> 
```

然而，直接访问 jsps 通常是个坏主意。将它们放在某个目录的 WEB-INF 中，然后将适当的 url（.do、.action 等）映射到 servlet，然后在内部重定向到该 JSP 是更好的做法。

因此，用户无需键入 thisUrl.jsp，而是键入 thisUrl.do 或 thisUrl.action，然后它会被 servlet 命中以重定向到 thisUrl.jsp。

# .net - 学习 .NET/OOP 最佳实践的最佳方式？

> ID：293152
> 
> 赞同：17
> 
> 时间：2008-11-15T22:24:49.860
> 
> 标签：.net, oop

我对 .NET 编程（以及一般的 OOP）相对较新，我想确保在设计我的应用程序时不会养成不良的初学者习惯。

如果您正在招聘一个新的 .NET 开发人员并且必须让他相对较快地上手，但又想确保他采用最佳实践（例如，单一职责原则、单元测试、关注点分离），您会推荐什么学习路径？

我最近一直在收听 Polymorphic Podcast，虽然收听关于最佳实践的讨论很有帮助，但我发现缺乏旨在介绍这些最佳实践的截屏视频和代码示例。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-15T22:28:40.490

如果像在您的假设示例中那样，我正在招聘一位新的 .NET 开发人员并希望确保他们采用最佳实践，我将首先让他们查看我当前的代码库。

然后我建议他们阅读以下内容：

*   [务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)
*   [代码完成](http://cc2e.com/)
*   [头部优先设计模式](http://oreilly.com/catalog/9780596007126/)
*   [重构](http://books.google.com/books?hl=en&id=1MsETFPD3I0C&dq=refactoring&printsec=frontcover&source=web&ots=pKN4r5XEd8&sig=G3nhVKusgQZtmhgxXSyqQnhpzSI&sa=X&oi=book_result&resnum=3&ct=result)
*   [通过示例进行测试驱动开发](http://books.google.com/books?hl=en&id=gFgnde_vwMAC&dq=Test-Driven+Development&printsec=frontcover&source=web&ots=enFurwZpuE&sig=KCAxXrIHX27BmTr4_EfEBrboP7s&sa=X&oi=book_result&resnum=6&ct=result)

这应该为任何人提供最佳 OOP 实践的坚实基础。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-16T06:46:41.140

有两个独立但相关的目标：

*   成为优秀的 OO 开发人员

和

*   成为一名优秀的 .NET 开发人员

在后者方面表现出色至少需要在前者方面表现出色，但两者都需要努力。不要拘泥于 Microsoft 的思维方式，甚至是 .NET 思维方式——您需要熟悉该领域的广泛领域。

如果您有这样做的灵活性，请为自己找一份有经验的人愿意提供指导的工作或团队。

接下来，认识到你需要做大量的阅读，无论是在线还是离线。如果您的阅读速度一般或更低（大约每分钟 250 字或更少），那么您应该考虑参加阅读技巧培训课程。我在[Write Group](http://www.write.co.nz/mainsite/ImprovedReadingCentre.html)（新西兰）上过一门课程，阅读速度提高了三倍。

在书籍方面， Microsoft Press 的[Object Thinking](http://www.microsoft.com/MSPress/books/6820.aspx)将是一个很好的起点；我将遵循[Programming .NET Components](https://rads.stackoverflow.com/amzn/click/com/0596003471) (Juval Lowy) 和[Smalltalk 最佳实践模式](https://rads.stackoverflow.com/amzn/click/com/013476904X)(Kent Beck)，然后[是实用程序员](https://rads.stackoverflow.com/amzn/click/com/020161622X)(Hunt 和 Thomas)。

之后，四处搜索（在 StackOverflow 或其他地方）并找到推荐书籍和博客的列表。继续阅读——尝试至少每两个月（如果不是每月）阅读一本关于新主题的新书。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-15T22:36:25.153

如果您喜欢截屏视频，请看一下[敏捷之秋](http://www.autumnofagile.net/)。目前还没有那么多剧集，但我相信他会介绍一些最重要的最佳实践。

剧集计划如下所示：

*   敏捷价值观和实践概述
*   基本面向对象设计原则
*   设计模式在行动
*   单元测试基础
*   模拟对象
*   TDD
*   项目文件/文件夹组织
*   源代码管理基础
*   持续集成/构建自动化
*   敏捷项目规划原则
*   领域驱动设计核心概念概述

该系列的作者还制作了[NHibernate之夏](http://www.summerofnhibernate.com/)系列，一直颇受欢迎。

除此之外，在[dnr-tv](http://dnrtv.com/archives.aspx)上， Jean Paul Boodhoo 制作了五集关于设计模式和两集关于测试驱动开发的文章，我建议您也看看这些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T06:07:25.283

我在这里看到了很多很好的资源，但大多数都集中在阅读和学习材料上。虽然这些绝对是必不可少的，但我发现直到我实际使用了一种模式或启发式或概念或任何一次或多次时，它们才真正点击。

正因为如此，我会推荐阅读，但是当您坐下来编写代码时，开始使用 NUnit 并练习 TDD（或 BDD 等）。这将帮助您做两件事。

1.  它会迫使你解耦你的类。很难真正测试具有许多依赖项的代码。如果你想真正进入那里并编写测试，你将需要解耦。这是开始应用所有推荐阅读的好地方。:)

2.  TDD 将帮助您在编写代码之前考虑如何与代码交互。我发现抽象地思考设计与实际从外部编码界面不同，后者在将各个部分组合在一起时更有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-07T21:43:45.170

我认为您需要首先了解成为了解 OOP 和最佳实践的“优秀”程序员需要时间和经验。没有书籍、博客或培训的神奇组合可以在战壕中复制时间。

根据我自己的经验，我的建议是不要太担心你没有遵循最佳实践而只是编写代码。如果您是 OOP 或 .NET 的新手，您将会做一些愚蠢的事情。你将做与“最佳实践”相反的事情，直到你犯了足够多的错误来从中吸取教训。

特异性训练理论指出，你应该专门做你想变得更好的事情。这意味着要编写大量代码以更好地编写代码。

现在，一旦您无所畏惧地编写了大量代码，您将需要补充外部知识。按重要性排序：

1.  直接与比您有更多经验的人合作。这是加快速度的最快方法。

2.  阅读其他 OOP .NET 代码。开源非常适合这个！研究它、扩展它、为 OSS 项目添加特性，即使你从未提交过。

3.  看书。我特别指的是书籍......不是博客。书籍有更多的空间来扩展一个主题，最适合那些真正从头开始研究给定主题的人。我推荐[Code Complete](http://cc2e.com/)作为第一本书。

4.  阅读“网”。这包括博客、stackoverflow 等。

祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-17T22:33:12.747

PluralSight[模式库](http://www.pluralsight-training.net/microsoft/courses/TableOfContents?courseName=patterns-library&highlight=david-starr_pattern-factories!david-starr_pattern-introduction%2a4,6!steve-smith_patterns-adapter%2a12,0,1,2,4,5,6,8,9,10,11,13,14!steve-smith_patterns-proxy%2a11,0,1,2,3,4,5,6,7,10,12!steve-smith_patterns-singleton%2a13,0,1,2,3,4,6,8,9,10,11,14,15!steve-smith_patterns-templatemethod%2a9,0,1,2,3,4!keith-brown_command-pattern%2a5!brian-lagunas_decorator%2a12!david-starr_pattern-facade%2a9!niraj-bhatt_pattern-flyweight%2a7!steve-smith_patterns-iterator%2a9!steve-smith_pattern-lazyload%2a15!david-starr_pattern-mvp%2a11!brian-lagunas_mvvm%2a17!scott-allen_pattern-repository%2a9!john-brown_dpl-servicelocator%2a10!scott-allen_pattern-unitofwork%2a7!glenn-block_pattern-event-aggregator%2a12!david-starr_pattern-null-object%2a10!john-sonmez_design-patterns-bridge%2a0,1,11!john-sonmez_design-patterns-builder%2a0,6,7!john-sonmez_design-patterns-composite%2a0,10!john-sonmez_design-patterns-interpreter%2a0,4,8!john-sonmez_design-patterns-prototype%2a0,7#pattern-factories)和[面向对象设计的原则](http://www.pluralsight-training.net/microsoft/courses/TableOfContents?courseName=principles-oo-design&highlight=steve-smith_pood-dont-repeat-yourself-principle-part3%2a2#pood-dont-repeat-yourself-principle-part3)非常出色。每月的小额订阅非常值得。对我来说，从在线解释清楚的教程中学习比阅读书籍要容易得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T00:03:54.200

巧合的是，我正在阅读一本相当不错的 VB.net 书（由 Apress 出版）。

虽然网上有很多很棒的教程，但我还是建议买一本书，它们的方法通常要专业得多。

尽管听起来很疯狂，但我发现在学习编程时不要坐在电脑前要好得多！我总是读一两章，然后去我的电脑上真正地去做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-16T04:45:02.273

我正在帮助一个朋友，正是你提到的情况。他是一个硬件人，过去曾与 C 一起工作。

我认为最好的方法是指导和编码。我向他解释了一些概念，然后请他编写一些代码。我们刚刚在多个平台（WCF、Silverlight、XNA、...）中构建了一个简单的计算器，并使用了一些众所周知的模式（状态、MVP...）。

我强迫他使用良好的编程实践并根据他的错误向他询问新功能来重构代码。例如，如果他耦合了几个组件，如 View 和 Controller，我会要求他提供一个新视图......这显然让他重写了一堆代码，他意识到有更好的方法......

通过这种方式，他是提出自然脱钩的人，更重要的是“为什么是好的”。到目前为止，我对结果感到非常满意；他对单元测试以及它如何让他轻松地永久更改代码感到非常满意。

恕我直言，关注点分离和单元测试可以通过编码更好地解释和理解，并且必须实现新功能；特别适合新程序员。一旦他购买，我会推荐他阅读GOF 或其一些[更简单的变体的“](https://rads.stackoverflow.com/amzn/click/com/0596007124)[设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)” 。

# vb6 - 如何在不使用 Drag 'n' Drop 的情况下在设计时添加控件？

> ID：293158
> 
> 赞同：2
> 
> 时间：2008-11-15T22:33:57.047
> 
> 标签：vb6, user-controls, controls

我试图在 VB6 中创建一个向导类型的控件并遇到了一个绊脚石。

我想让控件的用户能够使用属性页向设计时控件添加和管理 CWizardPage(s)。

我使用的第一种方法是直接使用 Collection 将向导页面添加到 OCX，但是我遇到了两个问题，即 Collection 类不可持久化（而且我找不到一种简单的方法来实现它）并且VB6 在运行时实例化控件的能力似乎非常有限 - 所以实际上重新实例化它们似乎很困难。

我的下一个想法是只允许用户在设计时绘制向导页面。这种方法很有效，但是在另一个向导页面中而不是在 CWizardContainer 中绘制一个向导页面太容易了。

那么谁能告诉我如何在设计时向表单添加控件而不使用拖放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T01:05:34.790

You can dynamically add controls to a form or other container (such as a UserControl) using the `Add` method of the container's `Controls` collection. For example, to add a TextBox named `myTextBox` to a form called frmMyForm, you could do this:

`frmMyForm.Controls.Add "VB.TextBox", "myTextBox"`

Here is a snippet from the VB6 help file:

> ### Add Method (Controls Collection)
> 
> Adds a control to the **Controls** collection and returns a reference to the control.
> 
> **Syntax**
> 
> *object*.**Add** **(***ProgID, name, container***)**
> 
> The **Add** method syntax has these parts:
> 
> *object* (Required)
> 
> An object expression that evaluates to an object in the **Applies To** list.
> 
> *ProgID* (Required)
> 
> A string that identifies the control. The ProgID of most controls can be determined by viewing the Object Browser. The ProgID is composed of the Library and Class of the control. For example, the CommandButton control's ProgID is VB.CommandButton. In cases where the ProgID differs from that shown in the Object Browser, Visual Basic displays an error message that contains the correct ProgId.
> 
> *name* (Required)
> 
> A string that identifies the member of the collection.
> 
> *container* (Optional)
> 
> An object reference that specifies a container of the control. If not specified or NULL, defaults to the container to which the Controls collection belongs. You can put a control in any existing container control (such as the Frame control) by specifying this argument. A user control or an ActiveX document can also be a container.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T02:51:51.473

> ...VB6 seems very limited in it's ability to instantiate controls at run time...

Nothing could be further from the truth. Instantiating controls at run time in VB6 is trivial.

1.  At design time, set the Index property of the control to 0\. This turns the control into a control array.
2.  At runtime, load new instances of the control as needed.

As an example, create new Standard EXE project drop a TextBox onto the form, set its Index to 0 and put the following in the Form_Load event:

```
Private Sub Form_Load()

    Dim newIndex As Integer

    newIndex = Text1.UBound + 1
    Load Text1(newIndex)
    Text1(newIndex).Top = Text1(newIndex - 1).Top + Text1(newIndex - 1).Height
    Text1(newIndex).Visible = True

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T20:32:34.773

我曾开发过一个应用程序，该应用程序定期根据所需字段动态制作许多完整的数据输入屏幕。一直指定 Top、Left、Width 和 Height 是很冗长的。因此，您通常拥有控件的“模板”并将这些设置复制到附加的设置中。

# c# - 跨程序集使用应用程序设置

> ID：293160
> 
> 赞同：5
> 
> 时间：2008-11-15T22:35:42.707
> 
> 标签：c#, .net, plugins

我正在编写一个应用程序，该应用程序在不同的程序集中包含一个插件系统。

问题是插件系统需要从主应用程序获取应用程序设置（例如查找插件的目录）。

这是如何完成的，或者我是否以错误的方式进行此操作？

编辑：我被鼓励添加一些关于插件系统如何工作的细节。我还没有完全解决这个问题，我才刚刚开始实施它，但我基本上是通过[这篇文章](http://divil.co.uk/net/articles/plugins/plugins.asp)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T22:55:03.057

让主应用从应用设置中获取插件目录，并推送到插件系统中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T23:01:43.747

也许您可以在创建插件时将配置作为参数插入？

```
//Get the configuration for the current appDomain
System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);

//Create the plugin, and pass in the configuration
IPlugin myPlugin = new AlfaPlugin(config); 
```

您可能需要对 System.Configuration 程序集的引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-15T23:13:44.940

您可以编写自定义配置部分，它允许您编写表示 XML 模式的对象。一旦建立，您可以简单地询问该部分的当前实例。

您可以通过派生`System.Configuration.ConfigurationSection`和编写表示属性和子元素的属性来做到这一点。有关更多信息，请参阅[如何：使用 ConfigurationSection 创建自定义配置部分](http://msdn.microsoft.com/en-us/library/2tw134k3.aspx)。

运行库的 AppDomain 是当前配置范围。命名空间关联所有[`System.Configuration`](http://msdn.microsoft.com/en-us/library/system.configuration.aspx)配置文件并呈现统一视图。

要检索部分的当前实例，您可以使用[`ConfigurationManager.GetSection(...)`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.getsection.aspx).

你的插件应该接受这个部分的一个实例而不是一个通用`Configuration`对象。

# user-interface - 如何限制 wxWidgets 中的鼠标指针移动？

> ID：293163
> 
> 赞同：2
> 
> 时间：2008-11-15T22:36:54.700
> 
> 标签：user-interface, mouse, wxwidgets

有没有办法将鼠标指针移动限制到 wxWidgets 中的特定区域？我知道 Windows 中有一个 API 函数 ClipCursor()，但是 wxWidgets 中是否有适用于所有平台的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T22:49:37.530

不。据我所知，wx 中没有这样的功能。启动一个计时器（比如 50 毫秒）检查全局鼠标位置。如果鼠标在该区域之外，则再次将其设置为。

如果您出于某种原因想要限制鼠标，例如制作某种游戏，那么您可以捕获鼠标（请参阅 参考资料`wxWindow::CaptureMouse`）。即使指针在您的窗口之外，您也会收到鼠标事件。然后，您可以对鼠标运动事件做出反应并检查那里的位置，而无需计时器。这样做的缺点是鼠标将无法在其他地方用于其他程序，因为它们不会接收事件。

wxWidgets 手册指出 OSX 指南禁止程序以编程方式将鼠标指针设置到某个位置。这可能是 wx 中对此类东西没有太多支持的原因，特别是因为 wx 非常努力地尝试与所有可能的东西兼容。

小样本。单击按钮将鼠标限制在区域 0,0,100,100。单击某处以释放它。

```
#include <wx/wx.h>

namespace sample {

class MyWin : public wxFrame {
public:
    MyWin() 
        :wxFrame(0, wxID_ANY, wxT("haha title")) {
        mRestricted = wxRect(0, 0, 100, 100);
        mLast = mRestricted.GetTopLeft();
        wxButton * button = new wxButton(this, wxID_ANY, wxT("click this"));
    }

private:
    void OnClicked(wxCommandEvent& event) {
        if(!HasCapture()) {
            CaptureMouse();
            CheckPosition();
        }
    }

    void OnMotion(wxMouseEvent& event) {
        CheckPosition();
    }

    void OnLeft(wxMouseEvent& event) {
        if(HasCapture())
            ReleaseMouse();
    }

    void CheckPosition() {
        wxPoint pos = wxGetMousePosition();
        if(!mRestricted.Contains(pos)) {
            pos = ScreenToClient(mLast);
            WarpPointer(pos.x, pos.y);
        } else {
            mLast = pos;
        }
    }

    wxRect mRestricted;
    wxPoint mLast;
    DECLARE_EVENT_TABLE();
};

BEGIN_EVENT_TABLE(MyWin, wxFrame)
    EVT_BUTTON(wxID_ANY, MyWin::OnClicked)
    EVT_MOTION(MyWin::OnMotion)
    EVT_LEFT_DOWN(MyWin::OnLeft)
END_EVENT_TABLE()

class MyApp : public wxApp {
    virtual bool OnInit() {
        MyWin * win = new MyWin;
        win -> Show();
        SetTopWindow(win);
        return true;
    }
};

} /* sample:: */

IMPLEMENT_APP(sample::MyApp) 
```

# algorithm - 用子区间查找区间的最小覆盖

> ID：293168
> 
> 赞同：12
> 
> 时间：2008-11-15T22:41:08.953
> 
> 标签：algorithm, optimization, math, geometry

假设我有一个区间 (a,b)，以及多个子区间 {(a [i] ,b [i] )} [i]，它们的并集是 (a,b)。有没有一种有效的方法来选择仍然覆盖（a，b）的这些子区间的最小基数子集？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-16T21:27:16.137

从 a 或 b 开始的贪心算法总是给出最优解。

证明：考虑覆盖 a 的所有子区间的集合 S [a]。显然，其中之一必须属于最优解。如果我们将其替换为来自 S [a的子区间 (a] [max] ,b [max] )，其右端点 b [max]在 S [a]中最大（到达最右侧），剩余的未覆盖区间 (b [max] ,b) 将是最优解的剩余区间，因此它不能被比最优解的类似未覆盖区间更多的子区间覆盖。因此，由 (a [max] ,b [max] ) 和剩余区间的最优解 (b [max][[[[[[[,b) 也将是最优的。]]]]]]]

因此，只需从 a 开始并迭代地选择到达最右边的区间（并覆盖前一个区间的结尾），重复直到你点击 b。我相信如果您将间隔存储在增强间隔树中，则可以在 log(n) 中选择下一个间隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T22:53:50.597

听起来像动态规划。

这是算法的说明（假设间隔在按结束时间排序的列表中）：

```
//works backwards from the end
int minCard(int current, int must_end_after)
{
    if (current < 0)
        if (must_end_after == 0)
            return 0; //no more intervals needed
        else
            return infinity; //doesn't cover (a,b)

    if (intervals[current].end < must_end_after)
        return infinity; //doesn't cover (a,b)

    return min( 1 + minCard(current - 1, intervals[current].start),
                minCard(current - 1, must_end_after) );
           //include current interval or not?
} 
```

但它也应该涉及缓存（记忆）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:00:47.907

有两种情况需要考虑：
情况 1：在一个区间的结束时间之后没有重叠的区间。在这种情况下，选择开始时间最短、结束时间最长的下一个区间。(amin, bmax)。
情况 2：有 1 个或多个间隔与您正在查看的最后一个间隔重叠。在这种情况下，开始时间无关紧要，因为您已经涵盖了这一点。所以优化完成时间。(a, bmax)。

案例 1 也总是选择第一个区间作为最优集中的第一个区间（证明与 @RafalDowgrid 提供的相同）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-16T00:09:29.570

您的意思是，子区间仍然以这样一种方式重叠，即 (a,b) 在所有点上都完全覆盖？

也许将子区间本身拆分为与它们来自何处相关联的基本块，因此您可以列出每个基本块区间的选项，同时考虑子区间覆盖的其他区域。然后，您可以使用基于每个子子间隔的搜索，并且至少确保没有留下任何间隙。
然后需要搜索..有效..那会更难。

可以消除任何完全被另一组较小数字覆盖的间隔集合，并在预处理后解决问题。
对整体的最小化不就是对至少一半的最小化吗？我不知道。

找到期刊的[链接](http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6TYW-4007NH8-1&_user=3965572&_rdoc=1&_fmt=&_orig=search&_sort=d&view=c&_acct=C000061923&_version=1&_urlVersion=0&_userid=3965572&md5=982732d1784dfa7f569a906a2aea91da "科学直接")，但无法阅读。:(

这将是一个[命中集合](http://en.wikipedia.org/wiki/Hitting_set "维基百科：击球集")问题，并且通常是 NP_hard。
也无法阅读，[但](http://portal.acm.org/citation.cfm?id=967703.967716 "ACM 门户")看起来是相反的问题。
无法阅读它，但另一个[链接](http://www.springerlink.com/content/55t74461u0054747/ "施普林格链接")提到了拆分间隔。
[这](http://209.85.173.132/search?q=cache:S2bjnnFnnqIJ:www.math.tau.ac.il/~michas/randomized-opt.ps+&hl=en&ct=clnk&cd=19&gl=us "几何优化问题的随机算法")是有关几何优化问题的随机算法的可用参考。这个pdf的
第[35页有一个贪心算法。](http://www.ists.dartmouth.edu/library/394.pdf "李明博士")[Karp (1972)](http://www.cs.berkeley.edu/~luca/cs172/karp.pdf "组合问题的可约性")
的第 11 页提到了 hit-set 并且被引用了很多。 谷歌[结果](http://209.85.173.132/search?q=cache:iws2-LfSQmMJ:ftp://ftp.csl.sony.co.jp/CSL/paper/98/SCSL-TR-98-036.ps.gz+%22hitting+set%22+interval+karp&hl=en&ct=clnk&cd=31&gl=us "棘手几何组合优化问题的启发式及其应用")。研究很有趣，但我现在得走了。

# c# - 如何为知识库系统构建搜索引擎？

> ID：293172
> 
> 赞同：1
> 
> 时间：2008-11-15T22:43:24.877
> 
> 标签：c#, .net, search, full-text-search, search-engine

我需要使用 C# 在我们的知识库系统中构建全文搜索功能。我该如何开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T22:56:54.380

例如来自 Lucene：

[http://lucene.apache.org/java/docs/](http://lucene.apache.org/java/docs/)

C# 端口在这里[http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

您还应该阅读有关信息检索的一些内容，您可以从以下内容开始： http: [//www.amazon.com/Modern-Information-Retrieval-Ricardo-Baeza-Yates/dp/020139829X](https://rads.stackoverflow.com/amzn/click/com/020139829X)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T23:25:07.130

我在我的开源[错误跟踪](http://ifdefined.com/bugtrackernet.html)应用程序 BugTracker.NET 中使用 Lucene.Net。下载它并查看 my_lucene.cs - 执行索引 - 和 search_text.aspx - 执行搜索。我从对 Lucene 一无所知到能够在一个周末将它集成到我的应用程序中。

我在这里解释一下：
[http ://www.ifdefined.com/blog/post/2009/02/Full-Text-Search-in-ASPNET-using-LuceneNET.aspx](http://www.ifdefined.com/blog/post/2009/02/Full-Text-Search-in-ASPNET-using-LuceneNET.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T22:58:53.753

如果您的文本库很重要，您可能需要一个索引工具。

# c# - 将自定义设计时命令添加到 WinForms 控件

> ID：293187
> 
> 赞同：5
> 
> 时间：2008-11-15T22:54:41.280
> 
> 标签：c#, winforms, custom-controls, design-time

我有一个自定义 WinForms 控件（从控件继承，即没有用户界面 jsut 作为计时器），我想向其中添加自定义命令添加设计时间。

这可能类似于菜单的“右键单击并选择'编辑项目...'”。

这可能吗？如何？

另外，您能否推荐一些关于改进自定义控件的设计时体验的一般性阅读（在线）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T21:55:53.427

首先这里是有关该主题的相关 MSDN 文档的链接

[http://msdn.microsoft.com/en-us/library/ms171567(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms171567(VS.80).aspx)

更具体地说

[http://msdn.microsoft.com/en-us/library/system.componentmodel.design.menucommand(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.menucommand(VS.80).aspx)

至于涵盖这一点的书，[Chris Sells Winforms 的书](https://rads.stackoverflow.com/amzn/click/com/0321267966)可能是最好的，但老实说，我认为那里的任何书（在线或其他方式）都没有涵盖设计时功能的深度我个人想要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T12:59:13.477

另一个很好的链接是

[http://msdn.microsoft.com/en-us/magazine/cc163758.aspx](http://msdn.microsoft.com/en-us/magazine/cc163758.aspx)

这篇文章涵盖了 Chris Sells 的书中关于这个主题的大部分内容，但是这本书仍然值得购买。

# perl - 如何防止 GD::Graph 显示图形区域之外的点？

> ID：293208
> 
> 赞同：2
> 
> 时间：2008-11-15T23:13:36.763
> 
> 标签：perl, gd-graph

我正在使用[GD::Graph](http://search.cpan.org/dist/GD-Graph)在 Perl 中绘制一些图，并且一些数据在我想显示的区域之外，但不是在绘图区域之外的图表中被截断，而是在标题、图例上绘制，和轴标签。有谁知道如何阻止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T04:01:24.280

如果您知道您的界限是什么，请过滤数据并且不要将这些点包含在您发送到 GD::Graph 的数据中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T00:04:08.830

澄清一下：您是否在声明`y_max_value`高度并且您的数据超出了该范围？还是 GD::Graph 误算了正确的上限？

如果要设置值，则需要将值固定到该上限。GD::Graph 只是在做你告诉它做的事情。（这或多或少是布赖恩所说的）。

OTOH，我发现 GD::Graph 并不总是能很好地处理累积（堆叠）图，并且`y_max_value`在这些情况下往往会高估。它还可以在 Y 轴上产生一些没有吸引力的值，在刻度值处带有浮点数。这是你真正想要解决的问题吗？

遇到这两个问题后，我们找到了一个解决方案，使用 Tie::RangeHash 创建总是产生 5 个整数刻度点的“整洁”增量。

```
use Tie::RangeHash ;
my $y_ranges = new Tie::RangeHash Type => Tie::RangeHash::TYPE_NUMBER;
$y_ranges->add(' -500,  -101', '-25');
$y_ranges->add(' -100,   -26', '-10');
$y_ranges->add('  -25,    -1',  '-5');
$y_ranges->add('    0,    25',   '5');
$y_ranges->add('   26,   100',  '10');
$y_ranges->add('  101,   500',  '25');
$y_ranges->add('  501,  1000', '100');
$y_ranges->add(' 1001,  5000', '250');
$y_ranges->add(' 5001, 10000','1000');
$y_ranges->add('10001, 50000','2500');
$y_ranges->add('50001,'      ,'5000');

sub set_y_axis {
    # This routine over-rides the y_max_value calculation in GD::Graph, which produces double the
    # required limit, and therefore a lot of white-space...
    return 1 unless @_ ;            #no point going any further if no arguments were provided, however result has to be
                                    #non-zero to avoid /0 errors in GD::Graph
    my @a = map { $_ || 0 } @_ ;    #array may have undefs in it. Set null to zero for calc of max
    my ($y_max) = sort { $b <=> $a } @a ; # Get largest total for y-axis
    my $y_range = $y_ranges->fetch($y_max);
    my $y_axis = ($y_max%$y_range==0) ? $y_max+$y_range : ($y_max - ($y_max%$y_range) + $y_range);
    sprintf("%d", $y_axis);
}

sub my_graph {
    my @ymax;
    # generate data... foreach loop etc
        push(@ymax, $this_y_value); # append y-value or cumulative y-value as appropriate
    # etc.
    my $graph = GD::Graph::lines->new(750, 280);
    $graph->set(
        y_max_value         => set_y_axis(@ymax),
        x_labels_vertical   => 1,
        transparent         => 1,
        # etc
    );
    # etc
} 
```

希望这对你有用。

# emacs - Emacs 键绑定名人堂/耻辱

> ID：293213
> 
> 赞同：3
> 
> 时间：2008-11-15T23:17:49.050
> 
> 标签：emacs

开发软件中最好和最差的 emacs 键绑定是什么？自从我学会了它，我发现自己试图使用 Cp 和 Cn 在所有带有文本框的东西中上下移动。

我一直对具有 emacs 模式的软件感到恼火，这种模式很明显要么是由以前从未使用过 emacs 的人组合而成，要么是以糟糕的方式完成的。因此，让我们在此线程中识别赢家和输家。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-16T08:35:45.443

**勇敢的尝试**

**Eclipse** Emacs 绑定在编辑时很不错。但是，在某些对话框中，它们会神秘地中断并复制还原到 Cc 并粘贴到 Cv。一种刺激。

**一个不错的 Mac OS 奖励**

在 Mac OS 上，所有**Cocoa**应用程序都支持基本的 emacs 键绑定。这很有效，因为本机 Mac 应用程序不使用控制键进行任何操作，因此不会发生冲突。这也意味着您可以在 Mac 上使用几乎任何文本编辑器（或文字处理器），并且至少拥有基本的 Emacs 键。

**意想不到的好处**

这甚至意味着*Oxygen*（使用 Swing GUI 工具包的 XML 编辑器）支持 Emacs 键绑定，但仅在 mac 上。我认为是这种情况，因为 Apple 实际上使用重量级 (Cocoa) 文本小部件在其 LAF 中实现 Swing 文本小部件。

在其他平台上，我经常使用 Oxygen 的 Eclipse 插件版本来恢复我的键绑定。

**丑陋**

`G^%$&^% F^%$`StackOverflow 用于在 Mac 上用一些 Javascript 废话覆盖一些 Cocoa Emacs 绑定。很烦人。

```
C-k (kill-line)     is bound to (insert-this-crap `print("code sample");`)
C-b (backward-char) is bound to (insert-this-crap **strong text**)
C-e, C-a, C-p, C-f, C-n work as expected. 
```

这些 SO 快捷方式既没有记录，也没有可定制的。它们也不是特别有用。

在此处报告为错误：[http ://stackoverflow.uservoice.com/pages/general/suggestions/72686](http://stackoverflow.uservoice.com/pages/general/suggestions/72686)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T12:18:45.307

[这是一个来自编辑器的错误 EMACS 绑定示例，该编辑器甚至没有尝试像 EMACS 一样。]

我曾经发现自己在 Solaris 上的 EMACS 和[PRIMOS](http://en.wikipedia.org/wiki/PRIMOS)上的 SOL 之间来回移动。

在 Emacs 上，Cp 意味着上升一行。

在 SOL 上，Cp 显然是一个未记录的命令，这意味着在没有提示或保存的情况下退出编辑器！

在那段时间我失去了很多工作，让我告诉你。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-15T23:20:34.893

## 好的

*   嗯...emacs？除了 emacs 之外，还没有找到任何软件可以很好地使环境像 emacs 一样。

## 坏的

*   Oracle 的 SQL Developer - 说真的，让 Cp 做除打印之外的其他事情有那么难吗？

## 咩

*   Visual Studio - 总体而言，emacs 模式是可以通过的，但在某些地方很明显，您使用的是 Microsoft IDE 而不是好的旧 emacs。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-16T13:21:06.243

每次我想在 Firefox 中搜索时，[Firemacs 都会阻止我打开“保存页面”对话框。](https://addons.mozilla.org/en-US/firefox/addon/4141)它有点不稳定，但我发现它比[Conkeror](http://conkeror.org/)更易于访问，尽管它看起来具有更忠实的 Emacs 绑定。

根据 OP 关于“`C-p`打印”的评论，我想我想在十多年内保存一两个网页，所以我有点困惑为什么 Firefox 将它放在如此常见的组合键上`C-s`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T11:40:09.067

Bash 支持一些 Emacs 键（Cp、Cn、Cf、Cb、C-Space、Cw、Cy、Ca），但是当我使用 screen 时，我发现它相当混乱，我应该输入 Ca a Ck 来终止行。因此，将屏幕前缀键更改为其他内容可能是个好主意。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-08T16:53:12.660

> [这是一个来自编辑器的错误 EMACS 绑定示例，该编辑器甚至没有尝试像 EMACS 一样。]
> 
> 我曾经发现自己在 Solaris 上的 EMACS 和 PRIMOS 上的 SOL 之间来回移动。
> 
> 在 Emacs 上，Cp 意味着上升一行。
> 
> 在 SOL 上，Cp 显然是一个未记录的命令，这意味着在没有提示或保存的情况下退出编辑器！

PRIMOS 中的 Cp 意味着无处不在的“中断”（如 Unix 中的 Cc）。我相信它在 Emacs 被移植到 PRIMOS 之前就已经存在，因此更改一个程序比成千上万的用户和客户更容易。我首先在 PRIMOS 上学习了 Emacs，后来我花了几年时间才对 Cp 感到满意 :-)。

# .net - VB.NET 中的默认属性？

> ID：293215
> 
> 赞同：29
> 
> 时间：2008-11-15T23:18:03.713
> 
> 标签：.net, vb.net, oop

在 .NET 的早期，我*相信*有一个属性可以用来装饰类以指定默认属性。

根据我发现的一些文章，这似乎已在某个时候从框架中删除，因为它有点令人困惑，我可以看到情况如何。

不过，还有其他方法可以获得它提供的功能吗？

它看起来像这样：

```
<DefaultProperty("Value")> _  
Public Class GenericStat
    ...
    Public Property Value() As Integer
        ...
    End Property
    ...
End Class 
```

这允许你做`Response.Write(MyObject)`而不是`Response.Write(MyObject.Value)`...... 这不是一个非常笨拙的例子，但在一些复杂的面向对象的上下文中它变得有点可怕。请让我知道是否有更好的方法。

**注意：**我不是在寻找 Default 关键字，它只能用于带有参数的属性。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-16T21:14:24.070

嗯，.NET 框架确实有一个默认成员的概念。关键成分是 DefaultMemberAttribute 类和 Type.GetDefaultMembers()。在 VB.NET 中，指定默认成员是语言语法的一部分：

```
 Public Class Sample
    Private mValue As Integer
    Default Public ReadOnly Property Test(ByVal index As Integer) As Integer
      Get
        Return index
      End Get
    End Property
  End Class 
```

像这样使用它：

```
 Sub Main()
    Dim s As New Sample
    Console.WriteLine(s(42))
    Console.ReadLine()
  End Sub 
```

编译器通过自动发出 [DefaultMember] 来实现这一点。然而，这有一个限制，该属性必须有一个索引参数，特别是为了避免语法歧义。显式指定属性时不强制执行此限制：

```
 <System.Reflection.DefaultMember("AnotherTest")> _
  Public Class Sample
    Public ReadOnly Property AnotherTest() As Integer
      Get
        Return 42
      End Get
    End Property
  End Class 
```

但是该默认成员只能通过允许这种语法的语言作为默认值访问。我不知道 .NET 中的示例，这是在 COM 时代使用的，例如 VB6。这也是 VB6 使用 Set 关键字的核心原因，它解决了歧义并声明“我的意思是对象，而不是对象的默认属性”。对于当时的许多初级 Visual Basic 程序员来说，语法细节非常痛苦。

C# 具有完全相同的规则，但不允许相同的灵活性。您可能以前见过索引器：

```
 public class Sample {
    public int this[int index] {
      get { return index; }
    }
  } 
```

此代码还使编译器输出 [DefaultMember] 属性。该属性中的命名属性是“Item”。这就是为什么您在 MSDN 库中看到索引器记录和索引为“项目”的原因。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-20T18:14:26.203

我发现您可以使用上面提到的 This 来完成原始海报想要的操作`Widening Operator CType` ，但没有太多细节，所以当我试图找到这个问题的答案时，我完全错过了它。这种方法本身并没有定义默认属性，但它实现了相同的结果。

```
Public Class GenericStat
    ...
    Public Property Value() As Integer
    ...
    End Property
    ...
    'this could be overloaded if needed
    Public Sub New(ByVal Value As Integer)
        _Value = Value
    End Sub
    '
    Public Shared Widening Operator CType(ByVal val As Integer) As GenericStat
        Return New GenericStat(val)
    End Operator
    '
    Public Shared Widening Operator CType(ByVal val As GenericStat) As Integer
        Return val.Value
    End Operator
End Class 
```

所以现在

```
Dim MyObject as GenericStat
MyObject = 123 
```

和

```
Dim Int as Integer
Int = MyObject 
```

两者都可以在没有`.Value`参考和没有索引器的情况下工作，例如`myobject(1)`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-18T08:24:34.217

不，这是从 VB 7 中明确删除的。

当您拥有一长串默认属性时，很难确切知道将返回什么。当两者`b`都有`c`一个`Foo`方法时，是`a.Foo(1)`指`a.b.Foo(1)`还是`a.b.c.Foo(1)`？

真正的踢球者是`Set`。通过删除默认属性，他们还能够删除`Set`对象分配的关键字。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-18T08:34:23.950

> 在此示例中，它会拉取对象，但不会将其转换为整数。

布赖恩，我不明白为什么使用`Widening Operator CType`. 您向我们展示的代码*可以*正常工作。但是，请注意隐式转换。它们通常*不是*一个好主意。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-08-21T13:59:06.227

我一直在寻找类似问题的答案，在此过程中我偶然发现了这个问题。实际上，约翰的回答为我指明了我需要去的方向。它也可能有助于解决原始问题：

我的问题：我需要一些可以像整数一样使用的东西

```
Dim myVal as Integer
myVal = 15
If myVal = 15 then
  ...
End If 
```

...等等...但是我还需要其他东西

```
myVal.SomeReadOnlyProperty (as String)
myVal.SomeOtherReadOnlyProperty (as Integer) 
```

（实际上那些只读属性也可能是方法......）
等等......所以我真的需要一个对象

我正在考虑整数（@_@）的扩展方法......我不想走那条路......

我也想过写一个“ReadOnlyPropertyOracle”作为一个单独的类，并给它像这样的方法

```
GetSomeReadOnlyProperty(ByVal pVal as Integer) as String
GetSomeOtherReadOnlyProperty(ByVal pVal as Integer) as Integer 
```

weeeell .... 那会奏效，但看起来很可怕...

因此出现了 John's Hack 和 Brian MacKay 关于运算符的评论：结合两者，扩大/缩小转换运算符（用于赋值）和比较运算符......以及比较。这是我的代码的一部分，它可以满足我的需要：

```
'The first two give me the assignment operator like John suggested
Public Shared Widening Operator CType(ByVal val As Integer) As MySpecialIntType
    Return New MySpecialIntType(val)
End Operator

'As opposed to John's suggestion I think this should be Narrowing?
Public Shared Narrowing Operator CType(ByVal val As MySpecialIntType) As Integer
    Return val.Value
End Operator

'These two give me the comparison operator
'other operators can be added as needed
Public Shared Operator =(ByVal pSpecialTypeParameter As MySpecialIntType, ByVal pInt As Integer) As Boolean
    Return pSpecialTypeParameter.Value = pInt
End Operator

Public Shared Operator <>(ByVal pSpecialTypeParameter As MySpecialIntType, ByVal pInt As Integer) As Boolean
    Return pSpecialTypeParameter.Value <> pInt
End Operator 
```

是的，这仍然是 1-2 打单行运算符定义，但其中大多数都是微不足道的，几乎没有出错的余地 ;-) 所以这对我有用......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-16T01:24:08.577

为了回答我自己的问题，运算符重载似乎是一个有趣的解决方案。

最后，这不是一个很好的选择。

我最终不得不添加大约 17 个 1 行方法，这意味着有很多错误空间。更重要的是不能重载赋值运算符；for 的重载`=`仅用于相等测试。

所以即使这样，我也不能说：

`Dim x as Integer = MyObject.Stats(Stat.Health)`...在此示例中，它提取对象，但不将其转换为整数，因此结果当然是异常。

我真正需要的是一个好的老式默认属性，但我认为那些日子已经结束了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-15T23:26:09.267

有一个[`DefaultProperty`](http://msdn.microsoft.com/library/system.componentmodel.defaultpropertyattribute.aspx "默认属性")属性，因此您的示例应该是正确的，*但这*似乎适用于 Windows 窗体设计器中使用的组件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-15T23:52:31.070

您可以覆盖 ToString 方法以将 Value 作为字符串输出，这样当您执行 Response.Write(MyObject) 时，您会获得相同的效果。

```
 Public Overrides Function ToString() As String
        Return Me.Value.ToString 
    End Function 
```

[编辑] 既然我理解得更好了，为什么不直接提供一种方法来直接获取所包含对象的值。

```
Public Class MyClass
    Private m_Stats(100) As Stats  ' or some other collection'

    Public Property StatValue(ByVal stat_number As Integer) As _
        Integer
        Get
            Return m_Stats(stat_number)
        End Get
        Set(ByVal Value As Integer)
            m_Stats(stat_number) = Value
        End Set
    End Property
End Class 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-17T15:05:22.243

嗨，约翰，您的回答非常有用！我更改为使用任何类型，谢谢。

```
Public Class GenericStat(Of Ttype)

Public Property Value As Ttype
'
Public Sub New()

End Sub
'
'this could be overloaded if needed
Public Sub New(ByVal Value As Ttype)
   _Value = Value
End Sub
'
Public Shared Widening Operator CType(ByVal val As Ttype) As GenericStat(Of Ttype)
   Return New GenericStat(Of Ttype)(val)
End Operator
'
Public Shared Widening Operator CType(ByVal val As GenericStat(Of Ttype)) As Ttype
   Return val.Value
End Operator

End Class 
```

以及用法：

```
Dim MyInteger As GenericStat(Of Integer)
MyInteger = 123

Dim Int As Integer
Int = MyInteger

Dim MyString As GenericStat(Of String)
MyString = "MyValue"

Dim Str As String
Str = MyString 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-10T17:34:24.380

如果您导入 System.ComponentModel，您仍然可以使用该属性。

正如其他人提到的，这并不理想，因为 VB.Net 更喜欢您使用 Default 属性。当然，这是附带条件的，这并没有真正的帮助（例如，需要索引）。

但是如果你使用

`Imports System.ComponentModel`

它允许您在类上使用该属性。

# linq - 使用 IQueryable、foreach 和多个 Where 时的 LINQ to SQL 错误（或非常奇怪的功能）

> ID：293216
> 
> 赞同：2
> 
> 时间：2008-11-15T23:18:13.043
> 
> 标签：linq, linq-to-sql

我遇到了一个场景，其中 LINQ to SQL 的行为非常奇怪。我想知道我是否做错了什么。但我认为它很有可能是一个错误。

下面粘贴的代码不是我的真实代码。这是我为这篇文章创建的简化版本，使用的是 Northwind 数据库。

一点背景知识：我有一个方法，它需要一个`IQueryable`of`Product`和一个“过滤器对象”（我将在稍后描述）。`IQueryable`它应该基于“过滤器对象”在上运行一些“Where”扩展方法，然后返回`IQueryable`.

所谓“过滤器对象”就是`System.Collections.Generic.List`这种结构的一种匿名类型：`{ column = fieldEnum, id = int }`

`Products`fieldEnum 是我可能希望用于过滤的表的不同列的枚举。

与其进一步解释我的代码是如何工作的，不如看看它会更容易。这很简单。

```
enum filterType { supplier = 1, category }
public IQueryable<Product> getIQueryableProducts()
{
    NorthwindDataClassesDataContext db = new NorthwindDataClassesDataContext();
    IQueryable<Product> query = db.Products.AsQueryable();

    //this section is just for the example. It creates a Generic List of an Anonymous Type
    //with two objects. In real life I get the same kind of collection, but it isn't hard coded like here
    var filter1 = new { column = filterType.supplier, id = 7 };
    var filter2 = new { column = filterType.category, id = 3 };
    var filterList = (new[] { filter1 }).ToList();
    filterList.Add(filter2);

    foreach(var oFilter in filterList)
    {
        switch (oFilter.column)
        {
            case filterType.supplier:
                query = query.Where(p => p.SupplierID == oFilter.id);
                break;
            case filterType.category:
                query = query.Where(p => p.CategoryID == oFilter.id);
                break;
            default:
                break;
        }
    }
    return query;
} 
```

所以这里有一个例子。假设 List 包含此匿名类型的两项，`{ column = fieldEnum.Supplier, id = 7 }`并且`{ column = fieldEnum.Category, id = 3}`.

运行上述代码后，`IQueryable`对象的底层 SQL 查询应包含：

```
WHERE SupplierID = 7 AND CategoryID = 3 
```

但实际上，在代码运行之后，被执行的 SQL 是

```
WHERE SupplierID = 3 AND CategoryID = 3 
```

我尝试将其定义`query`为属性并在设置器上设置断点，以为我可以捕捉到不应该发生的变化。但据说一切都很好。因此，我只是在每个命令之后检查底层 SQL。我意识到第一次`Where`运行良好，并且`query`保持良好（意思是`SupplierID = 7`）直到`foreach`循环第二次运行之后。紧随其后`oFilter`成为第二个匿名类型项目，而不是第一个，“查询”SQL 更改为`Supplier = 3`. 因此，这里必须发生的事情是`Supplier`，LINQ to SQL 不仅记住应该等于 7，还记得 Supplier 应该等于`oFilter.id`。但是`oFilter`是一个`foreach`循环的单个项目的名称，它在它迭代之后意味着不同的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-15T23:29:41.087

我只看了你的问题，但我 90% 确信你应该阅读[On lambdas, capture, and mutability](https://lorgonblog.wordpress.com/2008/11/12/on-lambdas-capture-and-mutability/)的第一部分（其中包括指向 5 个类似 SO 问题的链接），一切都会变得清晰。

它的基本要点是您示例中的变量`oFilter`已通过*引用*而不是通过*value*在闭包中捕获。这意味着一旦循环完成迭代，变量的引用就是最后一个，因此在 lambda 执行时评估的值也是最后一个。

解决方法是在循环内插入一个新变量，`foreach`其范围仅为该迭代而不是整个循环：

```
foreach(var oFilter in filterList)
{
    var filter = oFilter; // add this
    switch (oFilter.column) // this doesn't have to change, but can for consistency
    {
        case filterType.supplier:
            query = query.Where(p => p.SupplierID == filter.id); // use `filter` here
            break; 
```

现在每个闭包都在一个*不同* `filter`的变量上，该变量在每个循环内重新声明，您的代码将按预期运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T23:46:05.687

按设计工作。您面临的问题是*词法闭包*和*可变变量*之间的冲突。

你可能想要做的是

```
foreach(var oFilter in filterList)
{
    var o = oFilter;
    switch (o.column)
    {
        case filterType.supplier:
            query = query.Where(p => p.SupplierID == o.id);
            break;
        case filterType.category:
            query = query.Where(p => p.CategoryID == o.id);
            break;
        default:
            break;
    }
} 
```

当编译为 IL 时，该变量`oFilter`被声明*一次*并使用*multiply*。您需要的是在闭包中为每次使用该变量单独声明的变量，这就是`o`现在的用途。

当您使用它时，请摆脱那个混蛋的匈牙利符号：P。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-07T19:45:19.853

我认为这是我见过的最清楚的解释： http: [//blogs.msdn.com/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx](http://blogs.msdn.com/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)：

> 基本上，问题的出现是因为我们指定 foreach 循环是一个语法糖

```
{
    IEnumerator<int> e = ((IEnumerable<int>)values).GetEnumerator();
    try
    {
        int m; // OUTSIDE THE ACTUAL LOOP
        while(e.MoveNext())
        {
            m = (int)(int)e.Current;
            funcs.Add(()=>m);
        }
    }
    finally
    {
        if (e != null) ((IDisposable)e).Dispose();
    }
} 
```

> 如果我们指定扩展是

```
try
{
    while(e.MoveNext())
    {
        int m; // INSIDE
        m = (int)(int)e.Current;
        funcs.Add(()=>m);
    } 
```

> 那么代码将按预期运行。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-18T02:02:22.743

问题是您没有附加到查询，而是每次都通过 foreach 语句替换它。

您想要 PredicateBuilder 之类的东西 - [http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

# testing - 测试根据客户位置显示不同的网站的最佳方法是什么？

> ID：293224
> 
> 赞同：3
> 
> 时间：2008-11-15T23:26:08.440
> 
> 标签：testing, internationalization

我正在使用 IP 位置查找向客户显示本地化价格，具体取决于他们是从英国、美国还是一般欧盟访问，如果无法确定位置，则默认为美国价格。

我可以轻松地强制系统相信我来自特定国家进行测试，但仍然无法确定当来自国外的访问者访问我的网站时它是否正确显示。使用某些代理是测试此类站点的唯一可行方法吗？如果是这样，我将如何去追踪一个我可以用来测试来自不同原产国的网站的网站？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T23:57:25.647

您应该能够通过使用代理来实现这一点。[http://www.proxy4free.com/page1.html](http://www.proxy4free.com/page1.html)有一堆。该网站刚刚来自谷歌搜索；不过，我以前从未使用过这样的代理，所以可能会有更好的网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T23:32:33.340

这不是关于如何测试，而是关于如何识别访问者。

与其使用 IP-lookup 来确定他们的地理位置，不如从 useragent 字符串中获取有关他们使用的语言环境的信息。

F.instance，我是挪威人，当我访问 useragent.org 时，我看到我的浏览器发送“nb-NO”作为我的机器使用的语言。

您可以轻松地使用它来自定义您网站上的货币、日期等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T23:29:34.907

如果该网站在 Google 的缓存中被索引，您可以使用正确的 URL 地址访问 google。前任。[http://www.google.co.uk/](http://www.google.co.uk/)

并查看它是否在缓存中正确显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T01:12:00.550

@Frode：检查 iseragent 字符串中的系统区域设置可能会产生误导。我去了加拿大，并将我的系统区域设置为法语。因此，它可能会向用户显示欧盟价格，而不是显示美国价格。许多这样的情况是可能的，其中语言环境不会在提到的这个特定应用程序中提供有关最终用户所需“价格等级”的准确信息。

=广告

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T01:27:53.140

如果您想使用 geo-ip 位置来检测用户的语言，使用代理可能是最好的方法。

网络上有很多开放代理列表，大部分都与国家/地区一起列出。谷歌有很多关于这个主题的[搜索结果。](http://www.google.com/search?q=proxy+list "代理名单")在最好的结果中，我以前用[SamAir](http://www.samair.ru/ "SAS：SamAir 安全。 代理列表。 代理工具。")测试过一些东西。

在正确的国家/地区以可接受的速度搜索有效的开放代理可能是一项乏味的任务。还要记住，您不应该使用任何这些代理服务器来提交任何敏感数据，因为您永远不知道谁在运行它们。这可能是一个值得信赖的 ISP（即不是来自 GB ;D），一个收集数据的蜜罐，或者一个由某些木马托管的非法开放代理。

# ruby - 猴子修补VS。坚实的原则？

> ID：293236
> 
> 赞同：25
> 
> 时间：2008-11-15T23:39:30.380
> 
> 标签：ruby, monkeypatching, solid-principles

在一些个人项目中，我正在慢慢地从 PHP5 迁移到 Python，我目前很喜欢这种体验。在选择走 Python 路线之前，我查看了 Ruby。我从 ruby​​ 社区注意到的是，猴子修补既常见又备受推崇。我还遇到了**很多**关于调试 ruby​​ 软件试验的恐怖故事，因为有人包含一个相对无害的库来做一些小工作，但它在不告诉任何人的情况下修补了一些大量使用的核心对象。

我选择 Python 的原因之一是它更简洁的语法以及它可以完成 Ruby 可以做的所有事情。Python 使 OO 的点击率比 PHP 更好，我正在阅读越来越多的 OO 原则以增强对这种更好的理解。

今天晚上我一直在阅读关于[罗伯特马丁的 SOLID](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)原则：

*   **单一**责任原则，
*   **开**闭原则，
*   **L** iskov替换原理，
*   **接口隔离原则，**以及****
***   **依赖**倒置原则**

 **我目前达到**O**：*软件实体（类、模块、功能等）应该对扩展开放，但对修改关闭*。

我的头脑在确保 OO 设计的一致性和整个猴子补丁之间的冲突。我知道可以在 Python 中进行猴子修补。我也明白，“pythonic”就是遵循常见的、经过充分测试的、oop 最佳实践和原则。

**我想知道的是社区对这两个对立主题的看法；**它们如何互操作，何时最好使用一个，是否应该进行猴子修补......希望你能为我提供解决方案。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-17T20:23:48.977

猴子修补（覆盖或修改预先存在的方法）和简单添加新方法之间是有区别的。我认为后者完全没问题，前者应该被怀疑地看待，但我仍然赞成保留它。

我遇到了很多这样的问题，第三方扩展猴子修补了核心库并破坏了一些东西，它们确实很糟糕。不幸的是，它们似乎总是源于第三方扩展开发者走的阻力最小的道路，而不是考虑如何真正正确地构建他们的解决方案。
这很糟糕，但这不仅仅是猴子修补的错，也不是人们有时割伤自己的刀匠的错。

我见过的唯一一次合法的猴子补丁需要是解决第三方或核心库中的错误。仅就这一点而言，它是无价的，如果他们取消了这样做的能力，我真的会感到失望。

我们有一个 C# 程序中的错误的时间表：

1.  阅读奇怪的错误报告并将问题跟踪到 CLR 库中的小错误。
2.  *花几天时间想出一个解决方法，包括在奇怪的地方捕获异常和大量破坏代码的黑客行为*
3.  *当 Microsoft 发布服务包时，花费数天时间来解决 hacky 解决方法*

我们有一个rails程序中的一个错误的时间表：

1.  阅读奇怪的错误报告并跟踪问题到 ruby​​ 标准库中的一个小错误
2.  *花 15 分钟执行小猴子补丁以从 ruby​​ 库中删除错误，并在其周围放置警卫以防止它在错误版本的 ruby​​ 上运行。*
3.  继续正常编码。
4.  *稍后发布下一个 ruby​​ 版本时，只需删除 monkeypatch。*

错误修复过程看起来很相似，除了猴子补丁，这是一个 15 分钟的解决方案和一个 5 秒的“提取”，而没有它，痛苦和痛苦随之而来。

PS：下面的例子是“技术上”的monkeypatching，但它是“道德上”的monkeypatching吗？我没有改变任何行为——这或多或少只是在 ruby​​ 中做 AOP ......

```
class SomeClass
  alias original_dostuff dostuff
  def dostuff
    # extra stuff, eg logging, opening a transaction, etc
    original_dostuff
  end
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-15T23:47:37.617

在我看来，monkeypatching 很有用，但也有可能被滥用。人们倾向于发现它，并觉得它应该在任何情况下都使用，在这种情况下，也许使用 mixin 或其他构造可能更合适。

我不认为这是你应该取缔的东西，它只是 Ruby 人喜欢使用的东西。你可以用 Python 做类似的事情，但社区的立场是事情应该更简单、更明显。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-15T23:55:05.417

猴子补丁不是 ruby​​ 显式的，它也通过 javascript 完成，具有负面 (IMO) 效果。

我个人的意见是猴子补丁应该只做

a) 将功能添加到您需要的新版本语言中可用的旧版本语言中。

b）当没有其他“合乎逻辑”的地方时。

有很多简单的方法可以让猴子补丁变得非常糟糕，例如改变基本功能（如*ADDITION* ）的工作方式的能力。

我的立场是，如果你能避免，就这样做。

如果你能以一种很好的方式避免它，向你致敬。

如果你无法避免它，请听取 200 个人的意见，因为你可能只是没有认真考虑过它。

**我最讨厌的是扩展****函数**对象的 mootools 。是的，你可以这样做。而不是人们只是学习 javascript 的工作原理：

```
setTimeout(function(){ 
    foo(args); 
}, 5000 ); 
```

每个函数对象都添加了一个新方法（是的，我不是在开玩笑），因此函数现在有了自己的函数。

```
foo.delay( 5000 , args ); 
```

这具有这种废话有效的额外效果：

```
foo.delay.delay( 500,  [ 500, args ] ); 
```

就这样无限循环。

结果？你不再有图书馆和语言，你的语言屈从于图书馆，如果图书馆恰好在范围内，你就不再有语言，你不能像学习时那样做事语言，而是必须学习一个**新**的命令子集，以免让它一蹶不振（以过度减速为代价！）

[我可以注意到 foo.delay 还返回了一个对象，它有自己的方法，所以你可以这样做]

```
x = foo.delay( 500, args ); 
x.clear(); 
```

乃至

```
 x.clear.delay(10); 
```

这听起来可能过于有用，......但你必须考虑到用于使其可行的大量开销。

```
 clearTimeout(x); 
```

太难了！

**（免责声明：我使用 moo 已经有一段时间了，并试图忘记它，函数名称/结构可能不正确。这不是 API 参考。请查看他们的网站了解详细信息（抱歉，他们的 API 参考很烂！） )**

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-16T01:47:53.880

Mokeypatching 通常是错误的。创建一个适当的子类并添加方法。

我在生产代码中使用过一次猴子补丁。

问题是 REST 使用 GET、POST、PUT 和 DELETE。但是 Django 测试客户端只提供 GET 和 POST。我已经为 PUT（如 POST）和 DELETE（如 GET）提供了猴子补丁方法。

由于 Django 客户端和 Django 测试驱动程序之间的紧密绑定，似乎最容易对其进行猴子补丁以支持完整的 REST 测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-16T01:07:37.533

您可能会发现有关 Ruby 的开放类和开放封闭原则的[讨论很有启发性。](http://blog.objectmentor.com/articles/2008/09/04/the-open-closed-principle-for-languages-with-open-classes)

尽管我喜欢 Ruby，但我觉得猴子补丁是完成工作的最后手段。在所有条件相同的情况下，我更喜欢使用带有函数式编程优点的传统 OO 技术。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T00:02:38.690

在我看来，monkey-patching 是 AOP 的一种形式。[面向方面的设计原则：面向对象设计的教训](http://aosd.net/2007/program/industry/I6-AspectDesignPrinciples.pdf)(PDF) 一文给出了一些关于如何将 SOLID 和其他 OOP 原则应用于 AOP 的想法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-16T00:20:02.620

我的第一个想法是猴子修补违反了 OCP，因为一个类的客户应该能够期望该类能够始终如一地工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-16T00:00:31.477

猴子修补是完全*错误*的，恕我直言。我没有遇到过您之前提到的开放/封闭原则，但这是我长期以来一直坚持的原则，我 100% 同意。我认为猴子修补是一种更大范围的代码气味，一种编码哲学的气味。

# search - 对 Haskell 中的某些元素进行二分搜索

> ID：293239
> 
> 赞同：6
> 
> 时间：2008-11-15T23:45:36.920
> 
> 标签：search, haskell

我正在尝试完成我的 Haskell 作业的最后一部分，但我被困住了，我的代码到目前为止：

```
data Entry = Entry (String, String)

class Lexico a where
    (<!), (=!), (>!) :: a -> a -> Bool

instance Lexico Entry where
    Entry (a,_) <! Entry (b,_) = a <  b
    Entry (a,_) =! Entry (b,_) = a == b
    Entry (a,_) >! Entry (b,_) = a >  b

entries :: [(String, String)]
entries =  [("saves", "en vaut"), ("time", "temps"), ("in", "<`a>"),
              ("{", "{"), ("A", "Un"), ("}", "}"), ("stitch", "point"),
              ("nine.", "cent."), ("Zazie", "Zazie")]

build :: (String, String) -> Entry
build (a, b) = Entry (a, b)

diction :: [Entry]
diction = quiksrt (map build entries)

size :: [a] -> Integer
size [] = 0
size (x:xs) = 1+ size xs

quiksrt :: Lexico a => [a] -> [a]
quiksrt [] = []
quiksrt (x:xs)
    |(size [y|y <- xs, y =! x]) > 0 = error "Duplicates not allowed."
    |otherwise = quiksrt [y|y <- xs, y <! x]++ [x] ++ quiksrt [y|y <- xs, y >! x] 

english :: String
english = "A stitch in time save nine."

show :: Entry -> String
show (Entry (a, b)) = "(" ++ Prelude.show a ++ ", " ++ Prelude.show b ++ ")"

showAll :: [Entry] -> String
showAll [] = []
showAll (x:xs) = Main.show x ++ "\n" ++ showAll xs

main :: IO ()
main = do putStr (showAll ( diction )) 
```

问题问：

> 编写一个 Haskell 程序，获取英语句子“english”，使用二分搜索查找英法词典中的每个单词，执行逐字替换，组装法语翻译并将其打印出来。
> 
> 函数“快速排序”拒绝重复条目（带有“错误”/中止），因此任何英语单词都有一个法语定义。使用原始 'raw_data' 和将 '("saves", "sauve")' 添加到 'raw_data' 后测试 'quicksort'。
> 
> 这是二分搜索的冯诺依曼晚期停止版本。将字面音译为 Haskell。进入后，Haskell 版本必须立即验证递归“循环不变量”，如果无法保持，则以“错误”/中止终止。如果找不到英文单词，它也会以相同的方式终止。
> 
> ```
> function binsearch (x : integer) : integer
> local j, k, h : integer
> j,k := 1,n
> do j+1 <> k --->
>   h := (j+k) div 2
>   {a[j] <= x < a[k]}        // loop invariant
>   if x <  a[h] ---> k := h
>    | x >= a[h] ---> j := h
>   fi
> od
> {a[j] <= x < a[j+1]}        // termination assertion
> found := x = a[j]
> if found     ---> return j
>  | not found ---> return 0
> fi 
> ```
> 
> 在 Haskell 版本中
> 
> ```
> binsearch :: String -> Integer -> Integer -> Entry 
> ```
> 
> 因为类型为“[Entry]”的常量字典“a”是全局可见的。提示：输入“binsearch”后立即将您的字符串（英文单词）变成“Entry”。
> 
> 高级数据类型“Entry”的编程价值在于，如果您可以在整数上设计这两个函数，那么将它们提升到对 Entry 进行操作是微不足道的。

有人知道我应该如何处理我的二进制搜索功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T06:01:25.490

讲师要求“直译”，因此请以相同的顺序使用相同的变量名。但请注意一些差异：

*   给定的版本只需要1个参数，他给出的签名需要3个。嗯，
*   给定的版本不是递归的，但他要求一个递归的版本。

另一个答案是转换为数组，但是对于这么小的练习（毕竟这是家庭作业），我觉得我们可以假装列表是直接访问的。我刚刚接受了你的 diction::[Entry] 并对其进行了索引。我确实必须在几个地方在 Int 和 Integer 之间进行转换。

小问题：您的英文值有误（bs 是我创建的 binSearch 的快捷方式）：

```
 *Main> map bs (words english)
[Entry ("A","Un"),Entry ("stitch","point"),Entry ("in","<`a>"),Entry ("time","te
mps"),*** Exception: Not found
*Main> map bs (words englishFixed)
[Entry ("A","Un"),Entry ("stitch","point"),Entry ("in","<`a>"),Entry ("time","te
mps"),Entry ("saves","en vaut"),Entry ("nine.","cent.")]
*Main> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T00:28:53.900

二进制搜索需要随机访问，这在列表中是不可能的。因此，首先要做的可能是将列表转换为`Array`(with `listArray`)，然后对其进行搜索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-09T19:45:20.047

这是问题的英文部分的代码（我对其进行了测试，并且效果很好）：

```
module Main where

class Lex a where
    (<!), (=!), (>!) :: a -> a -> Bool

data Entry = Entry String String

instance Lex Entry where
    (Entry a _) <!  (Entry b _) = a <  b
    (Entry a _) =!  (Entry b _) = a == b
    (Entry a _) >!  (Entry b _) = a >  b
  -- at this point, three binary (infix) operators on values of type 'Entry'
  -- have been defined

type Raw = (String, String)

raw_data :: [Raw]
raw_data  =  [("than a", "qu'un"), ("saves", "en vaut"), ("time", "temps"),
                ("in", "<`a>"), ("worse", "pire"), ("{", "{"), ("A", "Un"),
                ("}", "}"), ("stitch", "point"), ("crime;", "crime,"),
                ("a", "une"), ("nine.", "cent."), ("It's", "C'est"),
                ("Zazie", "Zazie"), ("cat", "chat"), ("it's", "c'est"),
                ("raisin", "raisin sec"), ("mistake.", "faute."),
                ("blueberry", "myrtille"), ("luck", "chance"),
                ("bad", "mauvais")]

cook :: Raw -> Entry
cook (x, y) = Entry x y

a :: [Entry]
a = map cook raw_data

quicksort :: Lex a => [a] -> [a]
quicksort []     = []
quicksort (x:xs) = quicksort (filter (<! x) xs) ++ [x] ++ quicksort (filter (=! x) xs) ++ quicksort (filter (>! x) xs) 

getfirst :: Entry -> String
getfirst (Entry x y) = x

getsecond :: Entry -> String
getsecond (Entry x y) = y

binarysearch :: String -> [Entry] -> Int -> Int -> String
binarysearch s e low high 
    | low > high = " NOT fOUND "
    | getfirst ((e)!!(mid)) > s = binarysearch s (e) low (mid-1)
    | getfirst ((e)!!(mid)) < s = binarysearch s (e) (mid+1) high
    | otherwise = getsecond ((e)!!(mid))
        where mid = (div (low+high) 2)

translator :: [String] -> [Entry] -> [String]
translator [] y = []
translator (x:xs) y = (binarysearch x y 0 ((length y)-1):translator xs y)

english :: String
english = "A stitch in time saves nine."

compute :: String -> [Entry] -> String
compute x y = unwords(translator (words (x)) y)

main = do
    putStr (compute english (quicksort a)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-08T22:47:15.120

一个重要的 Prelude 运算符是：

```
(!!) :: [a] -> Integer -> a
-- xs!!n returns the nth element of xs, starting at the left and
-- counting from 0. 
```

因此，`[14,7,3]!!1`~~> 7。

# css - 如何在 Flash 应用程序中使用“本机”自定义鼠标光标？

> ID：293246
> 
> 赞同：3
> 
> 时间：2008-11-15T23:50:19.343
> 
> 标签：css, apache-flex, flash, actionscript-3, cursors

在 Flash 应用程序中更改光标的最常见方法似乎是基于简单地**隐藏本机操作系统光标**并在（隐藏）光标所在的 Flash 矩形内**显示图形**（由 Flash Player 绘制）。例如，这就是这样[`mx.managers.CursorManager`](http://livedocs.adobe.com/flex/3/langref/mx/managers/CursorManager.html)做的。我发现这种方法不可接受的原因是 Flash Player 在更新光标图形方面不够快，导致光标移动出现一些非常**明显的滞后**，我发现这是一个非常基本的可用性问题和烦恼，使得整个应用程序似乎比实际慢。

另一方面，我注意到浏览器中的**CSS[`cursor`](http://www.w3schools.com/CSS/tryit.asp?filename=trycss_cursor)属性**实现工作正常——即当使用它实现自定义鼠标光标时，光标移动没有明显的滞后。

所以我的问题是：*有没有办法使用 CSS`cursor`属性（或任何其他不涉及滞后、缓慢光标移动的方法）来更改 Flash 矩形顶部的光标？*

我已经尝试通过 JavaScript 更改`cursor`Flash 元素（或 Flash 元素的包装器）的样式属性`Div`，但似乎无法正常工作。有没有人成功地做过这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-01T08:44:40.063

本机光标在 Flash Player 10.2 beta 中可用。所以你应该试一试！见：[http ://www.bytearray.org/?p=2373](http://www.bytearray.org/?p=2373)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T23:54:45.090

我不相信 Flash 有任何方法可以使用自定义系统光标。在我作为 Flash 开发人员的 6 年中，我从未听说过这样的功能或 hack。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T06:52:42.297

我理解你的抱怨，我也对显示更新的滞后感到沮丧。考虑使用 CSS 在浏览器中设置光标样式的解决方案虽然是一种有趣的方法......它闻起来很臭，但最重要的是，您可以使用 ExternalInterface 从 Actionscript 实现对 CSS 光标属性的控制。这样，您大概可以与调用一些 Javascript 以在运行时修改 HTML 页面 CSS 的 HTML 容器进行通信。不是 100% 确定这会奏效，但如果你绝望，它可能值得一试。否则，可能建议坚持使用 CursorManager。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T16:51:35.990

CursorManager 就是它，但我没有任何懒惰的问题。

如果您还没有看过它，请查看 Colin Moock 的 CustomMousePointer 类。[他在http://www.moock.org/eas3/examples/](http://www.moock.org/eas3/examples/)上发布了他的 Essential AS3 书中的大量 AS3 示例和示例代码。向下滚动到或搜索自定义鼠标指针链接。它在第 22 章标题下。

顺便提一下，这些示例中的代码最初是供 Flash 开发人员使用的，因此您可以通过使用 Flash 的 AS3 实现中不可用的对象来针对 Flex 优化其中的一些代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T18:47:52.353

我相信 Flash Player 10 会原生地让你选择 ibar、拖动手、手指或普通光标，但如果你在 Flash 9 中这是不可能的，我也不相信 CSS hack 会起作用。

我的建议是 - 使用 MOUSE_MOVE 事件来定位图形并将帧速率设置得尽可能高（例如每秒 50 帧）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-10T17:13:30.740

实际上，您可以通过编写一个调用 javascript 来更新鼠标光标的 ExternalInterface 来完成此操作。jQuery 功能在这里可以很好地工作，这是我在我的新作品集网站中为按钮和 Flash 应用程序的各个区域所做的事情。

新的投资组合还没有，但应该在接下来的一两周内，因为好奇的人会在[http://chrismcintoshdesigns.com](http://chrismcintoshdesigns.com)

# html - 在 CSS 中使用相对字体大小真的有什么意义吗？

> ID：293247
> 
> 赞同：9
> 
> 时间：2008-11-15T23:50:58.140
> 
> 标签：html, css, fonts, font-size

我已经阅读了很多关于使用相对或绝对字体大小调整大小的利弊。固定尺寸不会放大 IE6，但现在这不是什么大问题。可访问性很重要，但我认为所有优秀的可访问性软件都是为处理这些问题而构建的？

我想这主要取决于您是否希望能够使用一条规则更改所有字体大小（即您设置的默认字体大小），或者您是否希望能够在不影响嵌套元素的情况下在某处更改字体大小（这是最让我沮丧的事情！）。

有人有任何提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T01:02:28.277

根据[YUI 字体 CSS](http://developer.yahoo.com/yui/fonts/)，

> 始终使用百分比作为单位，因为它们比 ems 呈现更一致，并且因为它们允许用户启动调整大小（与像素不同）。

当它们是像 YUI 这样的框架的一部分时，相对字体大小可以很好地工作。特别是因为它们规范了字体在浏览器中的工作方式。

就个人而言，我确实偶尔会输入绝对像素，但通常只用于必须以某种方式与其他一些设计元素（如菜单）匹配大小的文本。

当您将 % 分配给某个元素，然后将不同的 % 分配给包含的元素时，% 的东西确实会分解。但这是我发现的唯一真正的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T00:28:55.757

正如这篇[CSS 字体大小](https://stackoverflow.com/questions/293247/is-there-really-any-point-to-using-relative-font-sizing-in-css)文章中所解释的：

> 理想吗？最好的计量单位是NONE！让用户代理根据用户的偏好确定显示 - 但是！我们也知道，对于大多数设计，这不是一个非常实用的方法。亲自？我更喜欢 .em 和 .px 的“混合匹配”灵活性——随着用户代理变得更加“用户友好”，设计师的大小调整将不会像现在这样存在潜在问题或争议。

不要忘记虽然相对字体大小可以用于...字体大小以外的其他事情！

*   [css 图片文字换行](http://www.bigbaer.com/css_tutorials/css.image.text.wrap.htm)
*   [css em 缩放图像](http://www.bigbaer.com/css_tutorials/css.scale.image.html.tutorial.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T01:35:41.143

除了在 IE6（唉，它仍然是一个非常流行的浏览器）中调整大小的能力之外，默认情况下，相对字体让您更有可能匹配用户的需求，而无需他们调整大小（或者知道如何调整，如果我们是在这里谈论没有经验的用户）。用户 - 或代表他们的某人 - 可能出于充分的理由（例如视觉障碍）增加了字体大小作为 DPI、操作系统或浏览器自定义，并且通过相对大小，您可以利用该信息对他们有利。

对于必须与其他以像素（即图像）大小的页面元素匹配大小的文本，请使用“px”。对于其余的， '％'。该问题假设使用相对字体大小在某种程度上是困难的；我不认为它是。

通常，您会在正文的“%”中设置一种字体大小，并在其他页面元素上设置一些字体大小，这些元素或多或少比一般正文文本重要。您应该很少有足够的嵌套级别和嵌套的字体大小，以至于您无法轻松跟踪它们。

尺寸相对于其父尺寸的大小并没有什么特别难以理解的，并且此属性可能很有用：如果您想更改页面或部分页面上的基本字体大小，您只需更改一次而不必通过修复包含元素的每个字体大小声明。

relative 唯一真正的困难是当你相对地调整了一个块的大小，但你想把它*里面*的东西调整回原来的大小。您可以计算出与父母百分比相反的百分比，但它可能是一个丑陋的数字，如果您不能/不能完全准确地说明它，您可能会得到 1px 的舍入误差。在这种偶尔的情况下，退后一步看看选择器可能是个好主意，看看你是否不能更有选择地应用大小以避免不得不撤消它。

诚然，如果我们有一个仅与用户的默认尺寸相关的单位，而不是父尺寸，来解决这样的问题会很好。不幸的是，唯一像这样工作的值是最小/较小/小/中/等。关键字，除了历史浏览器的一致性问题之外，还比较粗粒度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T00:51:44.447

OS X 和 Windows 至少处理`pt`不同的字体大小，所以这肯定是完全不行的。另一方面，是否有充分的理由*不*使用相对字体大小？这似乎不是一场双方都有好论据的加权辩论。相反，一方面有几个优点（可能并不总是很明显）。但另一方面，*只有表面*上的优势，只要稍加探索，就会证明毫无价值。¹

实际上，对于绝对字体大小，我只能想到*一个*论点，即通过复制设计软件中使用的字体大小，可以更轻松地为完成的设计实现 CSS。实际上，一致的设计只会使用少数几种不同的字体大小，它们是彼此之间的简单比例（例如 80%），因此可以用`em`或来简单地表示`%`。

* * *

^(1))你说：

> 或者您是否希望能够在不影响嵌套元素的情况下更改某处的字体大小

你到底是什么意思？CSS 的全部意义在于您（通常）更改元素相对于其父元素的属性。为什么这会成为一个问题？

整个辩论有点让人想起“不要使用布局表”的辩论。对于非专业人士来说，这些论点似乎是教条的²但无论如何都没有理由不遵循它们。这并不是说要求争论是错误的！但是有太多毫无意义的违反这条规则的行为。

* * *

^(2）)为了记录，我不是网页设计专业人士。在这里只谈一谈我的技术意见。但这个论点实际上与所使用的技术无关。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T00:51:51.217

想想你的父母或祖父母在看你的网页，有没有他们的双光眼镜（或三光眼镜）。如果他们因为您将所有字体都设为 8 像素而无法阅读，他们可能会去其他地方。如果他们单击“文本大小>>最大”并且没有任何反应，他们可能会去其他地方。

鉴于 - 至少在美国 - 许多网络冲浪者都是有时间、金钱和视力下降的老年人，使用 em 作为公共网站的字体似乎有很大的好处；-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T00:16:11.070

唯一有效的重要原因是很多人仍在使用 IE6。只是这个。在 2008 年底，不再关注 IE6 可能是件好事。但很难忽视IE6。我在意大利的一家大公司担任网页设计师/开发者，我们的许多员工或客户现在正在他们的工作计算机上使用 IE6 浏览互联网。

为什么？他们没有管理员权限，不能在他们的机器上安装任何东西，而且系统管理员总是忙于升级每个办公室的电脑。可能当他们的硬盘需要更换时，这些人会升级到 IE7（就像 Firefox 是一个梦想）。

这种事情可能只发生在意大利。但我不会打赌。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T02:57:31.883

对字体大小、行高、上/下边距和填充使用相对单位也将在用户增加/减少文本大小时保持印刷比例不变。排版和设计人员会欣赏它 =)

# project-planning - IT项目方法论

> ID：293252
> 
> 赞同：2
> 
> 时间：2008-11-15T23:54:52.797
> 
> 标签：project-planning

寻找好的项目方法。任何人都有一些好的参考链接。想分享。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T00:02:47.773

这是来自敏捷过程的联合开发者 Ken Schwaber 的谷歌视频的链接，Scrum 被称为 Scrum 等人。 [http://video.google.com/videoplay?docid=-7230144396191025011](http://video.google.com/videoplay?docid=-7230144396191025011)。我简要介绍了 Scrum 的全部内容以及如何从项目管理中使用它。

InfoQ 的另一个链接是关于敏捷以及 Thoughtworks 如何为其提供解决方案的。[http://www.infoq.com/news/2008/11/agile-infrastructure-made-easy](http://www.infoq.com/news/2008/11/agile-infrastructure-made-easy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T23:57:13.493

[www.agilealliance.org](http://www.agilealliance.org)应该有助于查找有关 XP 和 Scrum 之类的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T00:11:07.243

[这是关于Rational Unified Process](http://en.wikipedia.org/wiki/IBM_Rational_Unified_Process)的 Wikipedia 文章。[您还可以在www.sei.cmu.edu/cmm](http://www.sei.cmu.edu/cmm/) 找到有关能力成熟度模型的信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T00:56:24.717

有这么多的项目方法，你可以花很长时间搜索，但仍然找不到你正在寻找的东西。

首先，重要的是要很好地了解您处理的项目类型。不同的方法将适合不同类型的项目。具有复杂业务规则和 50 名开发人员的大型项目需要一种不同的方法来为本地计算机用品商店实施开源电子商务系统。简而言之，项目越大，方法论就越正式。

在敏捷运动方面，关键方法如下：

*   Scrum
*   经验值
*   FDD
*   DSDM

我相信还有一个敏捷版本的 RUP。我的偏好是 FDD（功能驱动开发），我写了一篇文章，讲述为什么我在寻找解决项目误入歧途问题的灵丹妙药后选择 FDD。我没有找到难以捉摸的灵丹妙药，但通过 FDD，我确实找到了一些非常有用的实践，我今天仍然将其用于 Web 开发项目。

[http://www.martinbauer.com/articles/successful_web_development_methodologies](http://www.martinbauer.com/articles/successful_web_development_methodologies)

干杯，马蒂

# c# - 将安全的 SQL 语句创建为字符串

> ID：293254
> 
> 赞同：12
> 
> 时间：2008-11-15T23:55:06.883
> 
> 标签：c#, .net, sql, concatenation, stringbuilder

我正在使用 C# 和 .NET 3.5。我需要生成并存储一些 T-SQL 插入语句，这些语句稍后将在远程服务器上执行。

例如，我有一个员工数组：

```
new Employee[]
{
   new Employee { ID = 5, Name = "Frank Grimes" },
   new Employee { ID = 6, Name = "Tim O'Reilly" }
} 
```

我需要得到一个字符串数组，如下所示：

```
"INSERT INTO Employees (id, name) VALUES (5, 'Frank Grimes')",
"INSERT INTO Employees (id, name) VALUES (6, 'Tim O''Reilly')" 
```

我正在查看一些使用 String.Format 创建插入语句的代码，但这感觉不对。我考虑使用 SqlCommand （希望做这样的[事情](https://stackoverflow.com/questions/265192/how-to-get-the-generated-sql-statment-from-a-sqlcommand-object)），但它没有提供将命令文本与参数组合的方法。

仅仅替换单引号并构建一个字符串就足够了吗？

```
string.Format("INSERT INTO Employees (id, name) VALUES ({0}, '{1}')",
    employee.ID,
    replaceQuotes(employee.Name)
    ); 
```

这样做时我应该注意什么？源数据是相当安全的，但我不想做太多假设。

编辑：只想指出，在这种情况下，我没有 SqlConnection 或任何直接连接到 SQL Server 的方法。这个特定的应用程序需要生成 sql 语句并将它们排队以在其他地方执行 - 否则我将使用 SqlCommand.Parameters.AddWithValue()

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-16T00:09:34.047

像这样创建您的 SqlCommand 对象：

```
SqlCommand cmd = new SqlCommand(
        "INSERT INTO Employees (id, name) VALUES (@id, @name)", conn);

SqlParameter param  = new SqlParameter();
param.ParameterName = "@id";
param.Value         = employee.ID;

cmd.Parameters.Add(param);

param  = new SqlParameter();
param.ParameterName = "@name";
param.Value         = employee.Name;

cmd.Parameters.Add(param);

cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-16T00:06:59.497

使用参数化命令。将参数也传递给您的远程服务器，并让它调用 SQL Server，仍然保持 SQL 本身和参数值之间的区别。

只要您从不将数据视为代码，就应该没问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T02:57:34.090

以这种方式修复替换引号功能：

```
void string replaceQuotes(string value) {
     string tmp = value;
     tmp = tmp.Replace("'", "''");
     return tmp;
} 
```

干杯!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T02:38:58.830

嗯，我同意其他所有人的观点，即您应该使用参数化查询并将其保留。但是你如何将这些 sql 语句传递给你的远程服务器呢？您是否有某种类型的服务，例如可以接受并执行任意 Sql 命令的 Web 服务，或者您的客户端应用程序是否会直接访问数据库？

如果您通过某种代理，那么无论您对客户端上的数据进行多少清理，黑客都可以绕过您的应用程序并攻击该服务。在这种情况下，请按照 Cade 的建议执行并将数据作为 XML 或您选择的任何格式（JSON、二进制等）传递。然后在您实际运行命令之前构建您的 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T02:14:01.033

为避免注入，您需要将数据传送到远程服务器（可能是 XML），然后在远程服务器上，数据应转换回适当的数据类型并用于参数化查询或存储过程。

# .net - 为什么很少有 .NET 语言集成到 Visual Studio（特别是 VS2008）中？

> ID：293256
> 
> 赞同：5
> 
> 时间：2008-11-15T23:56:40.813
> 
> 标签：.net, visual-studio, visual-studio-2008, programming-languages

“核心”.NET 语言集成到 VS2008 - C#、VB.NET 和 C++。我不确定当前对 J# 和 JScript 的支持。

但是还有许多其他 .NET 语言——A#、Boo、Oxygene、F#、IronLisp/IronScheme、IronPython、IronRuby、Nemerle、Phalanger、P#、PowerShell[等等](http://en.wikipedia.org/wiki/Microsoft_.NET_Languages)。其中，我只发现 VS 支持 F#（由 Microsoft 制造，因此不足为奇）、Oxygene、A#（但仅支持 VS2005）和 IronPython（仅适用于为此目的设计的外部项目）。

但是其他语言呢？由于它们以 .NET 运行时为目标，我认为只有在 VS 中使用这些语言才有意义。Visual Studio 是否有一些限制可以防止这种情况发生？有没有办法“强制” VS 编译这些语言？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-16T00:05:07.037

我怀疑这很简单：IDE 集成不是一项简单的任务，如果你想把它做好的话。我猜这些语言中的大多数都是在业余时间完成的，而不是有商业资金。所需的工作量非常昂贵 - 不一定是因为 Visual Studio 让事情变得特别困难，而是因为它从根本上是很难实现的。

当然，这并不是说它不能完成——只是它很难，而且“爱好”项目不太可能获得这种程度的承诺，除非它们真的很受欢迎。

顺便说一下，对于 Boo，您应该查看[BooLangStudio](http://www.codeplex.com/BooLangStudio)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T00:15:15.503

我同意乔恩的回答。[更详细地说，虽然在语言服务](http://msdn.microsoft.com/en-us/library/bb166533.aspx)（语法突出显示、智能感知、曲线）和[项目系统](http://www.codeplex.com/mpfproj)（代码文件、程序集引用、构建属性、MSBuild 项目文件）方面有大量的 VS 可扩展性支持，即使您从链接的 MPF 脚手架代码开始，为一种语言实现所有这些并做好它只是大量的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T04:45:44.567

我确实同意如果 VS 中有更广泛的语言支持会很好。但是，我认为他们也应该添加对一些其他非.NET 相关语言的支持。如果有对解释语言的支持（即使只是通过可下载的插件添加），那就太好了：R​​uby、PHP 和 Classic ASP。

还有一个问题是为什么VS'08不能打开和保存VS'05里面可以打开和保存的Solution/Project文件？？

# wpf - 同步 2 个 WPF 数据网格的滚动位置

> ID：293275
> 
> 赞同：6
> 
> 时间：2008-11-16T00:10:07.260
> 
> 标签：wpf, datagrid, scroll

我正在尝试**同步**2 个**WPF DataGrid**控件的水平**滚动位置。**

 **我正在订阅第一个 DataGrid 的**ScrollChanged**事件：

```
<toolkit:DataGrid x:Name="SourceGrid" ScrollViewer.ScrollChanged="SourceGrid_ScrollChanged"> 
```

我有第二个 DataGrid：

```
<toolkit:DataGrid x:Name="TargetGrid"> 
```

在事件处理程序中，我试图使用**`IScrollInfo.SetHorizontalOffset`**，但可惜 DataGrid 没有公开`IScrollInfo`：

```
private void SourceGrid_ScrollChanged(object sender, ScrollChangedEventArgs e)
{
    ((IScrollInfo)TargetGrid).SetHorizontalOffset(e.HorizontalOffset);
    // cast to IScrollInfo fails
} 
```

还有另一种方法可以做到这一点吗？或者 TargetGrid 上是否有另一个元素公开了`IScrollInfo`实现滚动位置同步所必需的？

顺便说一句，我**使用的是冻结列**，所以我不能用 ScrollViewers 包装两个 DataGrid 控件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T22:54:40.717

根据 Microsoft 产品组的说法，遍历可视化树以查找 ScrollViewer 是推荐的方法，正如[他们在 Codeplex 上的回答中](http://wpf.codeplex.com/discussions/40161)所解释的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-03T17:38:24.790

有一段很棒的代码可以做到这一点：

[http://www.codeproject.com/KB/WPF/ScrollSynchronization.aspx](http://www.codeproject.com/KB/WPF/ScrollSynchronization.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T10:31:29.267

我们在使用 Infragistics 网格时遇到了同样的问题，因为它*不*（仍然不）支持冻结列。所以我们有两个并排的网格，看起来像一个。左边的网格没有水平滚动，但右边的网格做到了。穷人的冰柱。

无论如何，我们最终只是伸手进入了视觉树并拉出了`ScrollViewer`我们自己。毕竟，我们知道它就在那里——它只是没有被对象模型暴露出来。如果 WPF 网格不公开 ScrollViewer，您可以使用类似的方法。或者您可以对网格进行子类化并添加您需要的功能来完成这项工作。

有兴趣了解您为什么需要这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-25T22:24:39.740

这是一个很好的解决方案。在 WPF 中为我工作得很好。

[http://www.codeproject.com/Articles/39244/Scroll-Synchronization](http://www.codeproject.com/Articles/39244/Scroll-Synchronization)

我刚刚引用了 ScrollSynchronizer dll，添加了一个 xml 导入：

xmlns:scroll="clr-命名空间:ScrollSynchronizer"

然后将其添加到我的数据网格和你叔叔的鲍勃：

```
<DataGrid.Resources>
   <Style TargetType="ScrollViewer">
     <Setter Property="scroll:ScrollSynchronizer.ScrollGroup" Value="Group1" />
   </Style>
</DataGrid.Resources> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-23T06:27:31.833

您可以欺骗数据网格将其 ScrollViewer 公开为每个网格的公共属性，例如在用户控件初始化期间调用 innerGridControl_ScrollChanged() 处理程序时。要公开它，您可以在 xaml 视图文件中创建网格，然后在另一个 xaml 视图中组合其中的两个。下面的代码在 innerGrid.xaml.cs 上，例如：

```
 public ScrollViewer Scroller { get; set; } // exposed ScrollViewer from the grid
    private bool _isFirstTimeLoaded = true; 

    private void innerGridControl_ScrollChanged(object sender, ScrollChangedEventArgs e)
    {
        if (_isFirstTimeLoaded) // just to save the code from casting and assignment after 1st time loaded
        {
            var scroller = (e.OriginalSource) as ScrollViewer;
            Scroller = scroller;
            _isFirstTimeLoaded = false;
        }
    } 
```

在 OuterGridView.xaml 上放置一个附加的事件处理程序定义：

```
<Views:innerGridView Grid.Row="1" Margin="2,0,2,2" DataContext="{Binding someCollection}" 
                                      x:Name="grid1Control"
                                      ScrollViewer.ScrollChanged="Grid1Attached_ScrollChanged"
                                      ></Views:innerGridView>

<Views:innerGridView Grid.Row="3" Margin="2,0,2,2" DataContext="{Binding someCollection}" 
                                      x:Name="grid2Control"
                                      ScrollViewer.ScrollChanged="Grid2Attached_ScrollChanged"
                                      ></Views:innerGridView> 
```

然后在发生另一个滚动事件时访问该公共 ScrollViewer.SetHorizo​​ntalOffset(e.Horizo​​ntalOffset) 方法。下面的代码位于处理程序定义之一的 OuterGridView.xaml.cs 中（

```
private void Grid1Attached_ScrollChanged(object sender, ScrollChangedEventArgs e)
    {
        if (e != null && !e.Handled)
        {
            if (e.HorizontalChange != 0.0)
            {
                grid2Control.Scroller.ScrollToHorizontalOffset(e.HorizontalOffset);
            }
            e.Handled = true;
        }
    }
private void Grid2Attached_ScrollChanged(object sender, ScrollChangedEventArgs e)
    {
        if (e != null && !e.Handled)
        {
            if (e.HorizontalChange != 0.0)
            {
                grid1Control.Scroller.ScrollToHorizontalOffset(e.HorizontalOffset);
            }
            e.Handled = true;
        }
    } 
```

还要确保内部网格内的任何其他 scroll_changed 事件（如果有，例如，如果您在其中一个列数据模板中定义具有默认滚动条的 TextBox）将其 e.Handled 设置为 true 以防止外部网格的处理程序处理它（此由于 routedevents 的默认冒泡行为而发生）。或者，您可以添加额外的 if 检查 e.OriginalSource 或 e.Source 以过滤您打算处理的滚动事件。

# asp.net - Asp.net System.Web.HttpContext.Current.Session 在 global.asax 中为空

> ID：293276
> 
> 赞同：14
> 
> 时间：2008-11-16T00:10:19.723
> 
> 标签：asp.net, session, null, global-asax

我有一个自定义安全主体对象，我在 global.asax 中为当前线程设置了它，一切都很好，通常没有问题。

但是，我只是通过让页面提供图像来添加动态图像功能，并且每当加载该动态图像页面时 System.Web.HttpContext.Current.Session 在 global.asax 中为空，这会阻止我设置安全性从那时起，主要作为正常和级联问题。

通常会话在 global.asax 中只有一次在用户登录开始时的会话期间为空，之后它总是可用这个单一的异常。

当浏览器在原始页面中遇到图像标签时加载动态图像页面，即

我猜这是浏览器请求该页面而不发送一些凭据的事实的某个方面？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-16T02:13:56.120

约翰，

我假设您正在为处理程序使用 ashx 处理程序。如果是这样，请务必从 IRequiresSessionState 派生，例如：

```
public class Images : IHttpHandler, System.Web.SessionState.IRequiresSessionState
{ } 
```

如果您不使用 ashx，您能否描述动态图像页面的含义？

乔什

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-29T06:48:14.307

在 Global.asax.cs Session_Start() 和 Session_End() 你需要使用“this.Session”！这样做的原因是 HttpContext 仅在有正在处理的请求时可用。这就是为什么您在 HttpContext.Current.Session 上获得 NULL 的原因！

来自 Microsoft 网站：“HttpContext 类：封装有关单个 HTTP 请求的所有 HTTP 特定信息。”

但不要难过......我也爱上了这个！:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T01:05:24.573

会话与是否登录无关。

当您想要访问会话时，您覆盖了什么事件？在 AcquireRequestState 被触发之前，会话不可用。

有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/library/9ysfzy8h.aspx](http://msdn.microsoft.com/en-us/library/9ysfzy8h.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T08:28:56.340

是的，你是对的，这是因为对象依赖可能会在其他页面传输并行的情况下发生冲突，这可能会破坏会话之间的防火墙

# sql-server - 为什么 Visual Studio 2008 不会在安装了 SQL Server 2008 Developer 的情况下创建 .mdf 文件？

> ID：293281
> 
> 赞同：15
> 
> 时间：2008-11-16T00:18:11.517
> 
> 标签：sql-server, asp.net-mvc, visual-studio-2008

我正在尝试一些 ASP.NET MVC 教程，其中一个具有以下步骤：

*   右键单击“App_Data”文件夹，然后选择“添加新项目”
*   在“数据”类别下选择“SQL Server 数据库”。

但是，一旦我这样做了，我就会从 Visual Studio 收到以下消息：

> 与 SQL Server 文件 (*.mdf) 的连接需要 SQL Server Express 2005 才能正常运行。请验证组件的安装或从 URL 下载...

问题是我安装了 SQL Server 2008 开发人员版，如果不需要的话，我真的宁愿不安装任何 Express 版本（2005 或 2008）。是否有解决此问题的方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-10-17T16:29:13.933

我在 64 位 Windows 7（使用 64 位 SQL Server Express 2008）上也遇到了这个问题。

[Microsoft 支持知识库文章](http://support.microsoft.com/default.aspx?scid=kb;en-us;957944)中引用了两种解决此问题的方法：

**1\. 解决方法**

> 若要解决此问题，请卸载 64 位版本的 SQL Server Express 2008，然后安装 32 位版本的 SQL Server Express 2008。

如果您不想进行卸载/安装，请尝试下面的修补程序方法。

**2\. 修补程序**

> Microsoft 现已提供受支持的修补程序。但是，它仅用于更正本文描述的问题。仅将其应用于遇到此特定问题的系统。

虽然文章本身不包含修补程序的链接，但您可以在此处获取：http: [//support.microsoft.com/hotfix/KBHotfix.aspx ?kbnum=957944](http://support.microsoft.com/hotfix/KBHotfix.aspx?kbnum=957944)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-16T01:20:59.567

为了阐明 masfenix 的回复，SQL Express 支持成熟的 SQL Server 不支持的一项功能：“用户实例”数据库。安装 SQL Express 并在 App_Data 文件夹中有一个 mdf 文件后，应用程序将根据需要动态附加和分离它。对于业余爱好者或小型企业网站，这可能是完美的。如果您在企业的其他地方运行 SQL，您可能不想走这条路，因此该功能对您没有用处。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-16T00:45:08.390

实际上，SQL express 是一个与 SQL Server 2005 完全不同的数据库引擎。所以，如果你想使用 mdf 文件，你需要 SQL Express。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T05:59:51.350

我想指出我已经安装了开发版和 Express 版。而且我仍然遇到同样的错误。我认为 Express 版必须作为单个实例安装。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T18:12:07.833

我有同样的问题，但我已经安装了 sql 2008 express。有什么方法可以让它与 sql 2008 express 一起工作，所以我不必在我的机器上安装第 4 个 sql 实例？我已经有 sql 2005、sql 2008、sql 2008 express

什么... :)

# .htaccess - 想要重定向除我之外的所有访客

> ID：293285
> 
> 赞同：18
> 
> 时间：2008-11-16T00:26:05.650
> 
> 标签：.htaccess, http-status-code-302

基本上我即将开始在一个网站上工作，我想要一些可以添加到我的 .htaccess 文件（或其他地方）中的东西，它可以像这个伪代码一样工作：（我的 ip 将代替 127.0.0.1 )

```
if (visitors_ip <> 127.0.0.1)
    redirectmatch ^(.*)$ http://www.example.com/under-construction.html 
```

希望这是有道理的......

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-16T00:36:49.903

那将是[这样的](http://kb.siteground.com/article/How_to_redirect_all_visitors_except_your_IP_to_another_site.html)：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REMOTE_ADDR} !^127\.0\.0\.1

RewriteCond %{REQUEST_URI} !/mypage\.html$  

RewriteRule .* http://www.anothersite.com/mypage.html [R=302,L] 
```

正如[Andrew](https://stackoverflow.com/questions/293285/want-to-redirect-all-visitors-except-for-me-htaccess#296652)指出的那样，如果您重定向到同一个域， %{REQUEST_URI} 条件可以避免无限循环。

正如[近 9 年后](https://stackoverflow.com/questions/293285/want-to-redirect-all-visitors-except-for-me/293298#comment78684559_293298)[Xorax](https://stackoverflow.com/users/426349/xorax)评论的那样：

> 你不应该使用`REMOTE_HOST`，它在很多情况下会失败。你应该使用`REMOTE_ADDR`.
> 参见“[和之间的](https://stackoverflow.com/q/3812166/6309)[区别`REMOTE_HOST``REMOTE_ADDR`](https://stackoverflow.com/q/3812166/6309)”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T19:49:10.483

这是我最终使用的解决方案，请注意它与 VonC 的类似，只是如果您选择重定向到同一个域，他会导致无限循环。

```
RewriteEngine On
RewriteBase /
RewriteCond %{REMOTE_HOST} !^127\.0\.0\.1
RewriteCond %{REQUEST_URI} !/coming-soon\.html$ 
RewriteRule .* http://www.andrewgjohnson.com/coming-soon.html [R=302,L] 
```

还需要注意的是，302是临时动作，应该使用，而不是nothing或301。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-13T21:37:06.073

```
<IfModule mod_rewrite.c>
RewriteEngine On
# Redirect all except allowed IP
ReWriteCond %{REMOTE_ADDR} !^000\.000\.000\.001$
RewriteCond %{REMOTE_ADDR} !000\.000\.000\.002$
ReWriteCond %{REMOTE_ADDR} !^000\.000\.000\.003$
RewriteRule (.*) http://YourOtherWebsite.com/$1 [R=301,L] 
</IfModule> 
```

在您的 wordpress ifmodule 之前，这将重定向除有问题的 3 个 IP 地址之外的所有人。

如果您的 IP 地址发生变化，您只需 ftp 到该站点并编辑 .htaccess 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T00:47:45.747

小心这种方法。

采用基于 IP 的方法来限制访问，然后失去对我的 IP 地址的租约，我已经被烧毁了。

当然，您总是可以通过 ssh 进入有问题的框并再次更改 .htaccess 文件，但是如果您不希望它发生，那么当您试图弄清楚刚刚发生的事情时，5 分钟的恐慌并不是很有趣。

我建议改为使用 .htaccess（与 htpasswd 文件一起）来请求访问您的开发站点的凭据。

一个很好的例子在这里：[http ://aplawrence.com/foo-web/htaccess-authentication.html](http://aplawrence.com/foo-web/htaccess-authentication.html)

# project-management - 用于敏捷项目管理的软件工具

> ID：293292
> 
> 赞同：5
> 
> 时间：2008-11-16T00:34:26.603
> 
> 标签：project-management, agile, jira, agile-processes, greenhopper

我们使用 JIRA 进行错误跟踪和发布管理，我们已经开始使用 greenhopper 在 JIRA 内部进行项目管理，但它缺少的一件事是用户故事与这些用户故事中的任务的概念。有没有人推荐其他任务板，例如完全支持用户故事和任务以及对用户快速简单的敏捷项目管理工具。我开始研究 targetprocess，所以如果有人对此有特别的反馈，那也很好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-16T01:38:12.760

[TargetProcess](http://www.targetprocess.com)是我用过的最少侵入性的项目管理工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T13:24:40.417

Scrum 和 XP 团队的一个常见反模式是将故事分解为任务，跟踪这些任务，并在迭代结束时通知所有任务都已完成，但用户故事并未完成（因为它们不仅仅是他们任务的总和）。

我强烈建议根本不要跟踪任务。如果您愿意，请对它们进行头脑风暴以进行估计，但始终估计和跟踪整个故事。如果一个故事太大了，就把它分解成更小的*故事*——这有时需要一些创造力，但几乎总是有可能的。

您可以使用 Jira 中的子问题将故事聚合成更大的故事，尽管据我所知，greenhopper 不太支持这一点。如果您的团队在同一地点，无论如何，我*强烈*推荐在白板上放置索引卡 - 如果您必须这样做，甚至除了 Jira 之外（这就是我们目前的工作方式）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-16T01:59:06.807

白板和便笺或便笺卡。

我知道您要求软件，但根据您的环境，可能很难超越公开可见的任务图表的沟通价值。

但是，如果您必须拥有软件，那么还有[Rally](http://www.rallydev.com)和 [VersionOne](http://www.versionone.com)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-16T00:50:01.127

我的公司使用 TargetProcess 已经有一段时间了，我们对该产品非常满意。每当我们遇到问题或错误时，我们都会向他们报告，问题或错误会很快得到解决。这是一个与 SCRUM 配合得很好的好工具。我真的推荐它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-16T01:34:52.127

[Acunote](http://www.acunote.com/)是我迄今为止发现的最好的一个。真的很容易，简单和快速使用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-11T23:02:30.777

我们将 Jira 与 GreenHopper 一起使用，没有任何问题。如果您可以控制 Jira 实例的配置，则可以轻松创建允许包含子任务的故事问题类型。在规划阶段，我们将故事放到下一个版本中，并将它们拆分为子任务，在更精确的时间进行估算并分配给团队成员。如果这些任务是分开的，您还可以将它们转换为特定故事的子任务。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-16T00:58:32.077

Thoughtworks 很乐意向您出售[Mingle](http://studios.thoughtworks.com/mingle-agile-project-management/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-19T23:02:03.463

看看[http://AgileZen.com/](http://AgileZen.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-16T00:51:38.033

看看爵士乐：[http](http://www.theserverside.com/news/thread.tss?thread_id=44577) ://www.theserverside.com/news/thread.tss?thread_id=44577 ， http: [//jazz.net/pub/index.jsp](http://jazz.net/pub/index.jsp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-12-18T19:27:44.863

我们刚刚发布了一个名为 Crew 的全新工具，它可能对您有用。它非常灵活，允许您设置适合您流程的项目结构和工作流程。

[http://www.devmynd.com/crew](http://www.devmynd.com/crew)

# python - “django 视图中的未知列‘user_id’错误

> ID：293300
> 
> 赞同：5
> 
> 时间：2008-11-16T00:44:35.770
> 
> 标签：python, django, django-models, model, view

我有一个错误，我不确定是什么原因造成的。

这是错误：

```
Exception Type:     OperationalError
Exception Value:    
(1054, "Unknown column 'user_id' in 'field list'") 
```

有谁知道我为什么会收到这个错误？我想不通。一切似乎都很好。

我的视图代码如下：

```
if "login" in request.session:
    t = request.POST.get('title', '')
    d = request.POST.get('description', '')
    fid = request.session["login"]
    fuser = User.objects.get(id=fid)
    i = Idea(user=fuser, title=t, description=d, num_votes=1)
    i.save()
    return HttpResponse("true", mimetype="text/plain")
else:
    return HttpResponse("false", mimetype="text/plain") 
```

我很感激任何帮助！谢谢！

编辑：也是一个附带问题。我使用objects.get(id=还是objects.get(pk=？如果我使用主键，我需要在模型中声明一个id字段或索引吗？

编辑：以下是相关模型：

```
class User (models.Model):
    first_name = models.CharField(max_length=200)
    last_name = models.CharField(max_length=200)
    email = models.CharField(max_length=200)
    password = models.CharField(max_length=200)

class Idea (models.Model):
    user = models.ForeignKey(User)
    title = models.CharField(max_length=200)
    description = models.CharField(max_length=255)
    num_votes = models.IntegerField() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T01:25:48.870

1.  该字段是从到`user_id`的 FK 引用。看起来你已经改变了你的模型，没有更新你的数据库，那么你就会遇到这种问题。`Idea``User`

    删除旧表，重新运行 syncdb。

2.  默认情况下，您的模型表会获得一个`id`字段。您可以在查询中调用它`id`。您也可以使用 的同义词`pk`。

    如果您自己定义主键字段，则不会获得自动`id`字段。但是您仍然可以使用`pk`来指代主键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T01:22:46.350

您必须展示您的模型才能获得真正的帮助，但您的 Idea 表似乎没有 user_id 列？是否修改了 SQL 表结构？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-31T03:01:31.980

是的，我放下了桌子，一切都很好。但是，您必须实际进入数据库并删除它们。“manage.py flush”或“manage.py reset appname”不会自己做。

-尼克·奥

# ruby-on-rails - 如何运行使用我的 Rails 模型的 Ruby 任务？

> ID：293302
> 
> 赞同：13
> 
> 时间：2008-11-16T00:45:42.930
> 
> 标签：ruby-on-rails, ruby

我有一个带有一些基本模型的 Rails 应用程序。该网站显示从其他来源检索到的数据。所以我需要编写一个在我的数据库中创建新实例的 Ruby 脚本。我知道我可以用测试钩子做到这一点，但我不确定这是否有意义。

我不确定这个任务应该是什么样子，我如何调用它，或者它应该在我的源代码树中的什么位置（lib\tasks？）。

例如，这是我的第一次尝试：

```
require 'active_record'
require '../app/models/mymodel.rb'

test = MyModel.new
test.name = 'test'
test.save 
```

这失败了，因为它无法连接到数据库。这对我的新手大脑来说是一种模糊的方式，因为大概 Rails 在幕后做了所有神奇的工作来设置所有这些东西。那么如何设置我的小脚本呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-16T04:23:52.177

您可以通过简单地要求 environment.rb 在任何 ruby​​ 脚本中加载整个 rails 环境：

```
require "#{ENV['RAILS_ROOT']}/config/environment" 
```

这假设设置了 RAILS_ROOT 环境变量，请参阅我的评论以了解其他方法。

这还有一个额外的好处，就是为您提供了您在 Rails 其余代码中拥有的所有不错的类和对象。

要启动您的流程，听起来 cron 会执行您想要的操作，我还会在您的 capistrano 配方中添加一个任务，该任务会将您的脚本添加到 crontab 以定期从外部源获取数据并更新您的数据库。这可以使用[cronedit](http://cronedit.rubyforge.org/) gem 轻松完成。

cron 方法确实有一些缺点，主要是开销和控制，对于其他更复杂的选项，请参阅rails wiki 中的[HowToRunBackgroundJobsInRails](http://wiki.rubyonrails.org/rails/pages/HowToRunBackgroundJobsInRails)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-16T09:00:25.393

我同意上面的答案，但你必须在你的任务中包含 => :environment 否则它不会加载 Rails 环境。

例如，

```
namespace :send do
  namespace :trial do
    namespace :expiry do
      desc "Sends out emails to people who's accounts are about to expire"
      task :warnings => :environment do
        User.trial_about_to_expire.has_not_been_notified_of_trial_expiry.each do |user|
          UserMailer.deliver_trial_expiring_warning(user)
          user.notified_of_trial_expiry = true
          user.save
        end
      end
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T02:33:23.930

我建议创建自定义 rake 任务（lib/task/foo.rake）。这使您可以轻松访问 Rails 应用程序的大部分功能。

```
namespace :foo do
  desc 'do something cool'
  def something_cool
     test = MyModel.new
     test.name = 'test'
     test.save
  end
end 
```

然后：

```
$ rake -T foo
rake foo:something_cool       # do something cool 
```

您甚至可以通过 cronjob 运行任务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T13:43:58.257

不久前我写了一篇关于这个的帖子。

[http://www.rawblock.com/2007/06/14/ruby-oracle-mac-os-x-pain-jruby-and-activerecord-jdbc-to-the-rescue/](http://www.rawblock.com/2007/06/14/ruby-oracle-mac-os-x-pain-jruby-and-activerecord-jdbc-to-the-rescue/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T01:54:32.977

您可以在脚本中打开连接，如下所示：

```
ActiveRecord::Base.establish_connection(
    :adapter  => "mysql",
    :username => "root",
    :host     => "localhost",
    :password => "******",
    :database => "******" 
) 
```

我确信有一种更优雅的方法可以做到这一点，这样它就可以从你的 database.yml 中获取信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-16T12:17:38.447

有几个步骤，需要更多的细节才能真正回答好。

您说您的网站从其他来源检索数据？多常？如果它是半定期的，您肯定想查看后台处理/消息传递。如果你真的很想避免每次脚本运行时都加载你的 rails 环境，因为你每次都会支付太高的启动税。

您需要研究多种选择。阅读他们中的每一个，特别是那些发布他们为什么做出选择的人的评论，会让你很好地了解在做出选择之前你需要问自己什么问题。加载数据的工作量有多大？ETC...

在我的脑海中，这些是您可能想要研究的一些事情

Script/Runner & Cron Background/RB Starling Workling MemcacheQ Beanstalk Background Job (Bj) delayed_job (Dj) Daemon Generator

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-18T20:25:15.543

查看我在“ [Rails 的 cron 作业：最佳实践？](https://stackoverflow.com/questions/285717/a-cron-job-for-rails-best-practices#287107) ”中的回答。

它包含两个使用 cron 运行 Rake 任务和类方法的示例（通过`script/runner`）。在这两种情况下，Rails 都已加载，您可以使用您的模型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T15:04:53.957

很好的 Joyent 写了使用 rake 从 cron 作业运行 rails 任务 - [http://wiki.joyent.com/accelerators:kb:rails:cron](http://wiki.joyent.com/accelerators:kb:rails:cron)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-31T04:07:37.237

运行与 Rails 应用程序/模型交互的 ruby​​ 任务的最简单方法是让 Rails 为您生成 Rake 任务！:)

这是一个例子

1.  跑`rails g task my_namespace my_task`

2.  这将生成一个名为的文件`lib/tasks/my_namespace.rake`，如下所示：

```
namespace :my_namespace do
desc "TODO: Describe your task here"
  task :my_task1 => :environment do
    #write any ruby code here and also work with your models
    puts User.find(1).name
  end
end 
```

3.  运行此任务`rake my_namespace:my_task`

4.  观看与 rails modal 交互的 ruby​​ 代码任务！

# .net - 将参数传递给 SQLCommand 的最佳方法是什么？

> ID：293311
> 
> 赞同：61
> 
> 时间：2008-11-16T00:56:13.093
> 
> 标签：.net, sql-server, ado.net, sqlcommand

将参数传递给 SQLCommand 的最佳方法是什么？你可以做：

```
cmd.Parameters.Add("@Name", SqlDbType.VarChar, 20).Value = "Bob"; 
```

或者

```
cmd.Parameters.Add("@Name", SqlDbType.VarChar).Value = "Bob"; 
```

或者

```
cmd.Parameters.Add("@Name").Value = "Bob"; 
```

似乎第一个在性能方面或在错误检查方面可能以某种方式“更好”。但我想更确切地知道。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-11-17T06:00:01.017

## 里面发生了什么？

您引用了几个重载的参数列表`Add`。这些是直接对应于`SqlParameter`类的构造函数重载的便利方法。它们本质上使用与您调用的便捷方法具有相同签名的任何构造函数来构造参数对象，然后`SqlParameterCollection.Add(SqlParameter)`像这样调用：

```
SqlParameter foo = new SqlParameter(parameterName, dbType, size);
this.Add(foo); 
```

`AddWithValue`类似，但更方便，还设置了值。但是，它实际上是为了解决框架缺陷而引入的。引用 MSDN，

> 它的重载`Add`采用字符串和对象已被弃用，因为可能与 `SqlParameterCollection.Add`采用 a`String`和`SqlDbType` 枚举值的重载存在歧义，其中将整数与字符串一起传递可能被解释为参数值或相应的 `SqlDbType`值。`AddWithValue` 每当您想通过指定其名称和值来添加参数时使用。

类的构造函数重载`SqlParameter`仅仅是设置实例属性的便利。它们缩短了代码，对性能的影响很小：构造函数可以绕过 setter 方法并直接对私有成员进行操作。如果有区别，那也不会太大。

## 我该怎么办？

请注意以下内容（来自 MSDN）

> 对于双向和输出参数以及返回值，您必须设置 的值`Size`。这对于输入参数不是必需的，如果没有显式设置，则在执行参数化语句时从指定参数的实际大小推断该值。

默认类型是输入。但是，如果您允许像这样推断大小并且在循环中回收参数对象（您确实说过您关心性能），那么大小将由第一个值设置，任何后续值都将是剪辑。显然，这仅对可变​​长度值（例如字符串）有意义。

如果您在循环中重复传递相同的逻辑参数，我建议您在循环外创建一个 SqlParameter 对象并适当调整其大小。过大的 varchar 是无害的，所以如果它是一个 PITA 以获得确切的最大值，只需将其设置为比您期望的列更大。因为您正在回收对象而不是为每次迭代创建一个新对象，所以即使您对超大尺寸感到有点兴奋，循环期间的内存消耗也可能会*下降。*

说实话，除非您处理数千个电话，否则这些都不会产生太大影响。`AddWithValue`创建一个新对象，回避大小问题。它简短而甜美，易于理解。如果您遍历数千个，请使用我的方法。如果您不这样做，请使用它`AddWithValue`来保持您的代码简单且易于维护。

* * *

## 2008 年是很久以前的事了

自从我写这篇文章以来的几年里，世界发生了变化。有新的日期类型，还有一个问题没有出现在我的脑海中，直到最近的一个日期问题让我思考扩大的含义。

对于那些不熟悉这些术语的人来说，扩大和缩小是数据类型转换的特性。如果将 int 分配给 double，则不会损失精度，因为 double 更“宽”。这样做总是安全的，因此转换是自动的。这就是为什么你可以将一个 int 分配给一个双精度，但反过来你必须进行显式转换 - 双精度到 int 是一种缩小转换，可能会损失精度。

这可以应用于字符串：NVARCHAR 比 VARCHAR 更宽，因此您可以将 VARCHAR 分配给 NVARCHAR，但反之则需要强制转换。比较有效，因为 VARCHAR 隐式扩展到 NVARCHAR，*但这会干扰索引的使用！*

C# 字符串是 Unicode，因此 AddWithValue 将产生一个 NVARCHAR 参数。在另一端，VARCHAR 列值扩大到 NVARCHAR 以进行比较。这不会停止查询执行，但会阻止使用索引。这是不好的。

你能为这个做什么？您有两种可能的解决方案。

*   显式键入参数。这意味着不再有 AddWithValue
*   将所有字符串列类型更改为 NVARCHAR。

放弃 VARCHAR 可能是最好的主意。这是一个具有可预测后果的简单更改，它改善了您的本地化故事。但是，您可能没有此选项。

这些天我没有做很多直接的 ADO.NET。Linq2Sql 现在是我的首选武器，编写此更新的行为让我想知道它是如何处理这个问题的。我突然渴望通过 VARCHAR 列检查我的数据访问代码以进行查找。

* * *

## 2019 年，世界*再次前行*

Linq2Sql 在 dotnet Core 中不可用，所以我发现自己在使用 Dapper。[N]VARCHAR 问题仍然存在，但它不再被埋没。我相信人们也可以使用 ADO，所以这方面的事情已经完成了一个完整的循环。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-11-16T00:59:41.170

您也可以使用`AddWithValue()`，但要注意可能出现错误的隐式类型转换。

```
cmd.Parameters.AddWithValue("@Name", "Bob"); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-16T03:30:00.537

我曾经使用您的选项1：

> cmd.Parameters.Add("@Name", SqlDbType.VarChar, 20).Value = "Bob";

效果很好，但后来我开始使用 .AddWithValue ，它变得非常简单。经过数千次使用后，它并没有给我带来任何问题。请注意，我几乎总是传递我的类私有变量，所以我不必担心隐式类型转换。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-16T01:17:57.043

我肯定会说#1。但是，微软在企业库中的数据访问应用程序块中做到这一点是最好的，尤其是对于 SQL 服务器：

[http://msdn.microsoft.com/en-us/library/dd203144.aspx](http://msdn.microsoft.com/en-us/library/dd203144.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T04:41:28.443

这取决于您的应用程序。我实际上喜欢 2，因为如果我更改存储的 proc 参数的长度，我不必更改我的 DAO。但这只是我。我不知道是否有任何性能惩罚或任何东西。

# html - HtmlAgilityPack 删除选项结束标签

> ID：293342
> 
> 赞同：24
> 
> 时间：2008-11-16T01:45:53.103
> 
> 标签：html, parsing, html-agility-pack

我正在使用 HtmlAgilityPack。我使用以下字符串创建了一个 HtmlDocument 和 LoadHtml：

```
<select id="foo_Bar" name="foo.Bar"><option selected="selected" value="1">One</option><option value="2">Two</option></select> 
```

这会做一些意想不到的事情。首先，它给出了两个解析器错误，EndTagNotRequired。其次，选择节点有 4 个子节点 - 两个用于选项标签，另外两个用于选项标签的内部文本。最后，OuterHtml 是这样的：

```
<select id="foo_Bar" name="foo.Bar"><option selected="selected" value="1">One<option value="2">Two</select> 
```

所以基本上我决定放弃选项的结束标签。让我们暂时搁置这样做是否适当和可取。我正在使用 HtmlAgilityPack 来测试 HTML 生成代码，所以我不希望它为我做出任何决定或给出任何错误，除非 HTML 确实格式错误。有什么方法可以让它表现出我想要的样子吗？我尝试为 HtmlDocument 设置一些选项，特别是：

```
 doc.OptionAutoCloseOnEnd = false;
 doc.OptionCheckSyntax = false;
 doc.OptionFixNestedTags = false; 
```

这是行不通的。如果 HtmlAgilityPack 不能做我想要的，你能推荐一些可以的东西吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-16T02:22:46.617

在 HAP 主页的讨论中报告了完全相同的错误，但看起来在几年内没有对项目进行有意义的修复。不鼓励。

对源代码的快速浏览表明，可以通过注释掉 HtmlNode.cs 的第 92 行来修复该错误：

```
// they sometimes contain, and sometimes they don 't...
ElementsFlags.Add("option", HtmlElementFlag.Empty); 
```

（实际上不，它们总是包含标签文本，尽管空白字符串也是有效的文本。粗心的作者可能会省略结束标签，但任何元素都是如此。）

**添加**

一个等效的解决方案是`HtmlNode.ElementsFlags.Remove("option");`在任何使用 liberary 之前调用（无需修改 liberary 源代码）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-05T14:30:58.777

似乎有一些理由不将 Option 标记解析为“通用”标记，以符合 XHTML，但这可能是一个真正的痛苦。

我的建议是做一个完整的字符串替换并将所有“选项”标签更改为“my_option”标签，这样你：

1.  不必修改库的来源（以后可以升级）。
2.  可以像往常一样解析。

HtmlAgilityPack 论坛上的原始帖子可以在以下位置找到： [http ://htmlagilitypack.codeplex.com/Thread/View.aspx?ThreadId=14982](http://htmlagilitypack.codeplex.com/Thread/View.aspx?ThreadId=14982)

# python - wxPython，设置StaticText()的值

> ID：293344
> 
> 赞同：28
> 
> 时间：2008-11-16T01:52:15.337
> 
> 标签：python, wxpython

我目前正在使用 wxPython 为应用程序制作一个小 GUI 前端。

我`wx.StaticText()`用来创建一个地方来保存一些文本，代码如下：

```
content = wx.StaticText(panel, -1, "Text Here", style=wx.ALIGN_CENTRE) 
```

单击从 MySQL 检索数据时，我有一个按钮，我想将值更改为`StaticText()`MySQL 数据，或者我还可以使用什么来保存数据。

我尝试使用以下方法：

```
contents = wx.TextCtrl(bkg, style=wx.TE_MULTILINE | wx.HSCROLL)
content.SetValue("New Text") 
```

这可以很好地显示数据，但是在加载数据后您可以编辑数据，我不希望这样。

希望你们理解我想要做什么，我是 Python 新手 :)

干杯

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-16T16:55:03.190

如果你使用[wx.StaticText()](http://docs.wxwidgets.org/stable/wx_wxstatictext.html#wxstatictextsetlabel)你可以：

```
def __init__(self, parent, *args, **kwargs): #frame constructor, etc.
    self.some_text = wx.StaticText(panel, wx.ID_ANY, label="Awaiting MySQL Data", style=wx.ALIGN_CENTER)

def someFunction(self):
    mysql_data = databasemodel.returnData() #query your database to return a string
    self.some_text.SetLabel(mysql_data) 
```

正如 litb 所提到的，wxWidgets 文档通常比[wxPython 文档](http://wxpython.org/docs/api/wx.StaticText-class.html)更容易使用。为了看到 SetLabel() 函数可以应用于 wx.StaticText 实例，您必须向上移动 wxPython 文档中的命名空间层次结构到[wxWindow 超类](http://wxpython.org/docs/api/wx.Window-class.html#SetLabel)，从该超类 wx.StaticText 继承。wxPython 与 wxWidgets 有一些不同之处，要找出它们是什么可能具有挑战性。幸运的是，很多时候，不同之处在于已添加到 wxPython 中而在 wxWidgets 中找不到的便利功能。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-16T02:00:54.073

`wx.TextCtrl`有一种风格叫做`wx.TE_READONLY`. 使用它使其成为只读的。

作为一个侧节点，您也可以使用wxPython的[C++ wxWidgets 手册。](http://docs.wxwidgets.org/stable/wx_contents.html)在需要对 wxPython 或其他端口进行特殊处理的地方，手册通常会指出不同之处。

# string - Haskell字符串列表通过行

> ID：293345
> 
> 赞同：2
> 
> 时间：2008-11-16T01:54:10.623
> 
> 标签：string, haskell, functional-programming

我正在使用行功能来获取输入并在将其发送到函数之前拆分许多变量。请查看运行函数并告诉我为什么会出现以下错误。似乎它应该只将 ln 中的第一个字符串分配给 seq，但我得到一个错误。

```
错误：不诚实.hs：33:11：
    无法将预期类型“[t]”与推断类型“Char”匹配
    在“do”表达式中： seq <- ln !! 0
    在表达式中：
        做 ln <- 行 s
           序列 <- ln !! 0
           状态 <- ln !! 1
           l1 <- listDouble (ln !! 2)
           ……
    在“运行”的定义中：
        运行 s = do ln <- 行 s
                   序列 <- ln !! 0
                   状态 <- ln !! 1
                   ……
代码如下...
 import Char

maximumInd :: (Double, Double) -> Int
maximumInd (d1,d2) | maximum [d1,d2] == d1 = 1
                   | maximum [d1,d2] == d2 = 2

scoreFunction :: String -> Int -> [Double] -> [Double] -> Double -> Double -> (Double,Double)
scoreFunction string (-1) l1 l2 t1 t2 = (0.5, 0.5)
scoreFunction string index l1 l2 t1 t2 = ((fst (scoreFunction string (index-1) l1 l2 t1 t2)) * (l1!!num) * (tr (maximumInd (scoreFunction string (index-1) l1 l2 t1 t2))!!1), (snd (scoreFunction string (index-1) l1 l2 t1 t2)) * (l2!!num) * (tr (maximumInd (scoreFunction string (index-1) l1 l2 t1 t2))!!2))
    where
        num = digitToInt (string!!index)
        tr n | n == 1 = l1
             | n == 2 = l2

--split is stolen from teh webs http://julipedia.blogspot.com/2006/08/split-function-in-haskell.html
split :: String -> Char -> [String]
split [] delim = [""]
split (c:cs) delim
   | c == delim = "" : rest
   | otherwise = (c : head rest) : tail rest
   where
       rest = split cs delim

readDouble :: String -> Double
readDouble s = read s :: Double

listDouble :: String -> [Double]
listDouble s = map readDouble $ split s ' '

run :: String -> String
run s = do
    ln <- lines s
    seq <- ln!!0
    states <- ln!!1
    l1 <- listDouble (ln!!2)
    l2 <- listDouble (ln!!3)
    tr1 <- readDouble (ln!!4)
    tr2 <- readDouble (ln!!5)
    show maximumInd (scoreFunction seq (length seq) l1 l2 tr1 tr2)

main = do
    putStrLn "Please compose a test job for Viterbi."
    putStrLn "First line: A sequence with language [1,9]."
    putStrLn "Second line: The number of states."
    putStrLn "For the next 2 lines: space delimited emission probabilities."
    putStrLn "For the 2 lines after that, transmission probabilities."
    putStrLn "Then do ./casino < filename "
    interact run 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T03:06:10.710

首先，让我们看看编译器是如何解释它的：

```
run :: String -> String 
```

`String`其实是`[Char]`。

```
run s = do
    ln <- lines s
    ... 
```

简化*了很多*事情，一个`do`块必须在`Monad`. 这意味着它“返回”一个 type 的值`(Monad t) => t a`。由于此函数正在返回`[Char]`，因此该`do`块将返回`[Char]`，即`Monad`是`[]`（如果您阅读`[a]`为`[] a`，会更清楚）。

[从我的另一个答案](https://stackoverflow.com/questions/215748/haskell-inserting-every-line-from-a-file-into-a-list#215796)复制，

> 简化了很多事情，在 IO monad 的 do 块上，每一行都是：
> 
> *   返回“IO a”类型的值的东西；其中“a”类型的值被丢弃（因此“a”通常是“()”）
> *   一个 <- 表达式，它做同样的事情，但不是丢弃“a”类型的值，而是将它的名称放在 <- 的左侧
> *   一个 let，它只不过是给一个值一个名字

在这里，我们不是在`IO`Monad 上，而是在`[]`Monad 上。所以右边的表达式`<-`必须是 a `[a]`。

因此，在该`do`块的第一行：

```
 ln <- lines s 
```

这里类型是`[[Char]]`，所以类型`ln`是`[Char]`。

在下一行：

```
 seq <- ln!!0 
```

这里`ln!!0`有 type `Char`，但是由于您在`[]`Monad 中，因此它需要某种列表。这就是导致编译器错误消息的原因。

`do`解决方案是使用普通`let`块，而不是使用符号：

```
run :: String -> String
run s = let
        ln = lines s
        seq = ln!!0
        states = ln!!1
        l1 = listDouble (ln!!2)
        l2 = listDouble (ln!!3)
        tr1 = readDouble (ln!!4)
        tr2 = readDouble (ln!!5)
    in show maximumInd (scoreFunction seq (length seq) l1 l2 tr1 tr2) 
```

我没有编译这个块，但即使它有其他问题，也应该足以让你重新开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T02:58:52.100

请记住，列表是 haskell 中的 monad，其定义如下：

```
instance Monad [] where
    m >>= f  = concatMap f m
    return x = [x]
    fail s   = [] 
```

因此，如果您使用代码，则类似于：

```
do {ln <- lines "hello, world"; ln!!0} 
```

这等效于以下使用绑定表示法：

```
lines "hello world" >>= (\ln -> ln!!0) 
```

或更简洁地说：

```
lines "hello world" >>= (!!0) 
```

我们现在可以使用 list monad 的定义来重写它，如下所示：

```
concatMap (!!0) (lines "hello, world") 
```

这相当于：

```
concat $ map (!!0) (lines "hello, world") 
```

"hello, world" 行将返回 ["hello, world"]，因此在其上映射 (!!0) 将生成字符串 "h"。它具有类型 [Char]，但 concat 需要类型 [[t]]。Char 与 [t] 不匹配，因此出现错误。

尝试使用 let 或其他东西而不是 do 表示法。

编辑：

所以我认为这就是你想要的，使用 let 而不是 do。

```
run :: String -> String
run s = let ln = lines s
            seq = ln!!0
            states = ln!!1
            l1 = listDouble (ln!!2)
            l2 = listDouble (ln!!3)
            tr1 = readDouble (ln!!4)
            tr2 = readDouble (ln!!5)
        in show $ maximumInd (scoreFunction seq (length seq) l1 l2 tr1 tr2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T02:59:34.390

是的，我认为米帕迪是对的。do 表示法转换为 >>= 并返回对列表 monad 的调用。

```
run s = do
    ln <- lines s
    seq <- ln!!0
    states <- ln!!1 
```

将获得由`lines s`seq 和 states 返回的列表，ln 每次都是该列表的字符串。所以实际上使用 ln!!0，你会得到那个字符串的第一个字符。但是那里的右侧需要一个列表`<-`。这就是我记得的所有内容。自从我用haskell做这些事情以来已经有很长一段时间了：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T02:39:32.903

我不确定这是否正确，但问题*可能*在于它`<-`不是赋值运算符，因为您*似乎*正在使用它；它本质上是从一个 monad 中解包一个值。但我不确定这是否是您的问题的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T04:03:03.327

run 的类型是 String -> String，所以你可能不想要 do 表示法 [1]。我建议你这样做：

1.  注释掉 listDouble 函数下面的所有内容，加载它，并确保它会编译。
2.  添加一个格式与您期望的文件类似的测试值。就像是：

    ```
     t = "[1,9]\n3\n1.0 1.0 1.0\n1.0 1.0 1.0\n1.0\n1.0" 
    ```

3.  为您在运行中定义的值添加顶层测试值

    ```
    ln = lines t
    seq = ln!!0
    states = ln!!1
    l1 = listDouble (ln!!2)
    l2 = listDouble (ln!!3)
    tr1 = readDouble (ln!!4)
    tr2 = readDouble (ln!!5) 
    ```

4.  使用 scoreFunction 的类型签名来指导您构建该函数的参数，然后是运行的其余部分，最后是 main。

学习使用解释器，例如 Hugs、ghci。学习 :r 和 :t 命令。例如（我正在使用柯里化来给出一些但不是全部的函数参数）：

```
 :t scoreFunction
  :t scoreFunction ""
  :t scoreFunction 3445 
```

您可以使用它让系统帮助您确定您是否在正确的轨道上。在顶层执行此操作会引入与 Prelude.seq 函数的冲突 - 重命名您的 seq，或将您的引用为 Main.seq。

Haskell 因初学者难以理解的错误消息而臭名昭著，因此我建议定期回滚到可编译的版本，方法是注释掉您当前的实验（这是我在上面的步骤 1 中让您做的），或者使用您的编辑撤消功能。

[1]我说可能是因为作为字符列表的字符串是 Monad 类的实例，但这是相当先进的

# c# - 在 C#/.NET 2.0 中控制双缓冲自绘 UserControl 的设计器外观

> ID：293351
> 
> 赞同：2
> 
> 时间：2008-11-16T02:03:23.117
> 
> 标签：c#, .net, user-controls, .net-2.0

我有一个所有者绘制的 UserControl，我在其中实现了双缓冲。为了让双缓冲在没有闪烁的情况下工作，我必须像这样覆盖 OnPaintBackground 事件：

```
protected override void OnPaintBackground(PaintEventArgs e)
{
    // don't even have to do anything else
} 
```

这在运行时效果很好。问题是，当我在设计时在窗体上有一个控件实例时，它会变成一个黑洞，显示拖过它的任何窗口的轨迹（因为 OnPaintBackground 事件的覆盖也控制设计时外观）。这只是一个表面上的问题，但它在视觉上很刺耳，它总是让项目的新开发人员认为某些事情出了严重的错误。

有没有办法让这样的被覆盖方法在设计时不被覆盖，或者有另一种解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-02T17:26:33.557

不幸的是，Steven Lowe 的解决方案涵盖了所有场景，尤其是当用户控件出现时。

this.DesignMode 标志非常具有欺骗性。它的唯一范围是检查直接父级是否在设计器内。

例如，如果您在设计器中有一个 Form A 和一个 UserControl B：

*   A.DesignMode 在设计器中查看时为真
*   B.DesignMode 在查看 A 时为 false，但在设计器中直接查看 B 时为 true。

对此的解决方案是检查一个特殊的标志（对于丑陋的 C++ 代码感到抱歉）：

```
 if(this->DesignMode || 
    LicenseManager::UsageMode == LicenseUsageMode::Designtime) 
    return; 
```

此变量将始终显示正确的设计布尔值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T02:25:01.713

```
if (this.DesignMode)
{
    return;    //or call base.OnPaintBackground()
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-03T20:47:59.240

`greggorob64`C#中的解决方案：

```
if (DesignMode || LicenseManager.UsageMode == LicenseUsageMode.Designtime) 
{
    return;
} 
```

# c# - C# 到 VB.NET 的帮助

> ID：293352
> 
> 赞同：-1
> 
> 时间：2008-11-16T02:06:41.893
> 
> 标签：c#, vb.net

我已经从 C# 转移到 9-5pm VB.NET

我应该知道什么技巧？除了语法之外，VB.NET 的最大区别在哪里？

命名空间去哪儿了？

[注：刚刚找到[http://converter.telerik.com/](http://converter.telerik.com/)辉煌]

干杯约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T02:56:35.473

Telerik 转换器对我使用了一些较新的语法。我觉得这个更好，虽然不是那么漂亮。

[http://www.developerfusion.com/tools/convert/csharp-to-vb/](http://www.developerfusion.com/tools/convert/csharp-to-vb/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T02:38:34.090

你看过这个答案吗？：[C# 和 VB.NET 之间最重要的功能区别是什么？](https://stackoverflow.com/questions/11632/what-are-the-most-important-functional-differences-between-c-and-vbnet)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T03:40:47.333

看到这两个问题：

[VB.Net 的隐藏功能](https://stackoverflow.com/questions/102084/hidden-features-of-vbnet)
[Visual Basic 10 最想要的功能](https://stackoverflow.com/questions/167714/most-wanted-features-for-visual-basic-100)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T03:44:20.353

看看这个：

[VB .NET 和 C# 比较](http://www.harding.edu/fmccown/vbnet_csharp_comparison.html)

在这一点上它有点旧（我认为它是 .NET 1.1），但它对于比较语法仍然很有用。

# language-agnostic - Fluent 接口 - 方法链

> ID：293353
> 
> 赞同：33
> 
> 时间：2008-11-16T02:13:53.313
> 
> 标签：language-agnostic, design-patterns, oop, fluent-interface

方法链是我知道构建流畅接口的唯一方法。

这是 C# 中的一个示例：

```
John john = new JohnBuilder()
    .AddSmartCode("c#")
    .WithfluentInterface("Please")
    .ButHow("Dunno");

Assert.IsNotNull(john);

  [Test]
    public void Should_Assign_Due_Date_With_7DayTermsVia_Invoice_Builder()
    {
        DateTime now = DateTime.Now;

        IInvoice invoice = new InvoiceBuilder()
            .IssuedOn(now)
            .WithInvoiceNumber(40)
            .WithPaymentTerms(PaymentTerms.SevenDays)
            .Generate();

        Assert.IsTrue(invoice.DateDue == now.AddDays(7));
    } 
```

那么其他人如何创建流畅的界面。你如何创造它？需要什么语言/平台/技术？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-16T06:32:38.080

构建流畅界面背后的核心理念是可读性——阅读代码的人应该能够理解正在实现的目标，而无需深入研究实现以澄清细节。

在 C#、VB.NET 和 Java 等现代 OO 语言中，方法链接是实现这一目标的一种方式，但它不是唯一的技术——另外两种技术是工厂类和命名参数。

还要注意，这些技术并不是相互排斥的——目标是最大限度地提高代码的可读性，而不是方法的纯度。

**方法链**

方法链接背后的关键见解是永远不会有返回 void 的方法，而是始终返回一些对象，或者更常见的是返回一些接口，以便进行进一步的调用。

您不一定需要返回调用该方法的同一对象 - 也就是说，您并不总是需要“返回 this;”。

一种有用的设计技术是创建一个内部类——我总是在它们后面加上“Expression”——它公开了流式 API，允许配置另一个类。

这有两个优点——它将流畅的 API 保存在一个地方，与类的主要功能隔离，并且（因为它是一个内部类）它可以以其他类无法做到的方式修补主类的内部结构。

您可能希望使用一系列接口来控制在给定时间点开发人员可以使用哪些方法。

**工厂班**

有时你想建立一系列相关的对象——例子包括 NHibernate Criteria API、Rhino.Mocks 期望约束和 NUnit 2.4 的新语法。

在这两种情况下，您都拥有要存储的实际对象，但为了使它们更容易创建，工厂类提供了静态方法来制造您需要的实例。

例如，在 NUnit 2.4 中，您可以编写：

```
Assert.That( result, Is.EqualTo(4)); 
```

“Is”类是一个充满工厂方法的静态类，它们为 NUnit 的评估创建约束。

事实上，为了考虑到浮点数的舍入误差和其他不精确性，您可以为测试指定一个精度：

```
Assert.That( result, Is.EqualTo(4.0).Within(0.01)); 
```

（提前道歉——我的语法可能不对。）

**命名参数**

在支持它们的语言（包括 Smalltalk 和 C# 4.0）中，命名参数提供了一种在方法调用中包含附加“语法”的方法，从而提高了可读性。

考虑一个假设的 Save() 方法，该方法采用文件名和保存后应用于文件的权限：

```
myDocument.Save("sampleFile.txt", FilePermissions.ReadOnly); 
```

使用命名参数，此方法可能如下所示：

```
myDocument.Save(file:"SampleFile.txt", permissions:FilePermissions.ReadOnly); 
```

或者，更流畅地：

```
myDocument.Save(toFile:"SampleFile.txt", withPermissions:FilePermissions.ReadOnly); 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-11-16T02:29:24.623

您可以使用任何版本的 .NET 或任何其他面向对象的语言创建流畅的接口。您需要做的就是创建一个对象，其方法总是返回对象本身。

例如在 C# 中：

```
public class JohnBuilder
{
    public JohnBuilder AddSmartCode(string s)
    {
        // do something
        return this;
    }

    public JohnBuilder WithfluentInterface(string s)
    {
        // do something
        return this;
    }

    public JohnBuilder ButHow(string s)
    {
        // do something
        return this;
    }
} 
```

用法：

```
John = new JohnBuilder()
    .AddSmartCode("c#")
    .WithfluentInterface("Please")
    .ButHow("Dunno"); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-16T02:28:42.020

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-08-05T01:30:53.320

前段时间我有你现在有同样的疑问。我已经做了一些研究，现在我正在写一系列关于设计流畅界面的技术的博客文章。

在以下位置查看：

[C# 流利界面设计指南第 1 部分](http://www.codeproject.com/Articles/99542/Guidelines-to-Fluent-Interface-design-in-C-Part-1)

我有一个关于 Chaining X Nesting 的部分，你可能会很感兴趣。

在接下来的文章中，我将更深入地讨论它。

最好的祝福，

安德烈·维安娜

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-16T02:27:38.120

Fluent 接口是在面向对象编程中通过始终从您的方法返回包含该方法的相同接口来实现的。因此，无论版本如何，您都可以在 java、javascript 和您喜欢的其他面向对象语言中实现此效果。

我发现通过使用接口最容易实现这种技术：

```
public interface IFoo
{
    IFoo SetBar(string s);
    IFoo DoStuff();
    IFoo SetColor(Color c);
} 
```

这样，任何实现接口的具体类都可以获得流畅的方法链接能力。FWIW .. 我用 C# 1.1 编写了上面的代码

你会发现这种技术在 jQuery API 中随处可见

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-16T02:28:05.140

这就是我构建所谓的流利界面或我唯一的方法的方式

```
Tokenizer<Bid> tkn = new Tokenizer<Bid>();
tkn.Add(Token.LambdaToken<Bid>("<YourFullName>", b => Util.CurrentUser.FullName))
    .Add(Token.LambdaToken<Bid>("<WalkthroughDate>",
          b => b.WalkThroughDate.ToShortDateString()))
    .Add(Token.LambdaToken<Bid>("<ContactFullName>", b => b.Contact.FullName))
    .Cache("Bid")
    .SetPattern(@"<\w+>"); 
```

我的示例需要 .net 3.5，但这只是我的 lambda 的原因。正如 Brad 指出的那样，您可以在任何版本的 .net 中执行此操作。尽管我认为 lambda 会带来更多有趣的可能性，例如这样。

======

其他一些很好的例子是 nHibernate 的 Criteria API，还有一个流畅的 nhibernate 扩展用于配置 nhibernate，但我从未使用过它

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-16T02:30:18.023

在 .Net 3.5/C# 3.0 中可能会想到几件事：

1.  如果一个对象没有实现一个流畅的接口，你可以使用扩展方法来链接你的调用。

2.  您也许可以使用对象初始化来模拟流畅，但这仅适用于实例化时，并且仅适用于单参数方法（其中属性只是一个设置器）。这对我来说似乎很骇人听闻，但它就在那里。

就个人而言，如果您正在实现构建器对象，我认为使用函数链接没有任何问题。如果构建器对象具有链接方法，它会使您正在创建的对象保持干净。只是一个想法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-15T01:13:12.990

# vista64 - 为什么微软决定将 32 位应用程序放在“Program Files (x86)”中？

> ID：293364
> 
> 赞同：3
> 
> 时间：2008-11-16T02:27:31.880
> 
> 标签：vista64

将 64 位应用程序放入“Program Files (x64)”并让 32 位应用程序在“Program Files”中运行是否***更有意义？***

我有一个需要运行[Flex](http://en.wikipedia.org/wiki/Adobe_Flex)编译器的批处理文件。在 x64 中，该程序位于“Program Files (x86)”中。在 Windows Vista 32 位上，它位于“程序文件”中 - 环境变量？核实：

```
ProgramFiles=C:\Program Files
ProgramFiles(x86)=C:\Program Files (x86) 
```

我该怎么办？

* * *

```
set mxmlc="%ProgramFiles(x86)%\Adobe\Flex Builder 3\sdks\3.1.0\bin\mxmlc.exe"
if NOT EXIST %mxmlc% set mxmlc="%ProgramFiles%\Adobe\Flex Builder 3\sdks\3.1.0\bin\mxmlc.exe" 
```

tnx

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T02:43:14.703

没什么。猜猜*\Windows\System32*包含什么？没错，64 位 DLL 文件。那么他们决定将 32 位旧版 DLL 文件放在哪里呢？*\Windows\SysWOW64*当然。

问题是，虽然 Windows 应用程序有内置工具来发现系统目录的位置，但许多应用程序并不使用它们。而且由于微软首先是向后兼容性的奴隶，所以我们得到了像这样的愚蠢东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-16T04:01:59.333

要使其便携：

```
SET ExecPath=%ProgramFiles(x86)%
IF "%ExecPath%"=="" SET ExecPath=%ProgramFiles% 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T02:34:27.093

x86 通常假定为 32 位，除非您指定 x86-64。为什么他们仍然需要自己的程序文件目录？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T02:41:01.200

呃...我认为x86是指Intel处理器架构，例如8086、80286、80386、80486和80586。

80386 具有第一个 32 位指令集，请参阅*[x86](http://en.wikipedia.org/wiki/X86)*（维基百科）。

编辑：啊，问题得到澄清。

请参阅 Stack Overflow 问题*[C# - How to get Program Files (x86) on Vista x64](https://stackoverflow.com/questions/194157)*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T03:44:05.267

*编辑：我有一个需要运行 FLEX 编译器的批处理文件。在 X64 中，该程序位于 Vista 32 位的“程序文件（x86）”中，它位于“程序文件”中。环境变量？.. 核实：*

使用 %ProgramFiles% 环境变量并跳过所有这些麻烦。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-22T03:46:11.197

a.) 仅仅因为默认安装位置更改并不意味着您必须在那里安装东西。一个简单的注册表更改将使您的新安装到您想要的任何地方。我的都转到一个单独的驱动器，放入我选择的文件夹中。如果应用程序甚至无法通过注册表跟踪其安装路径，那么它可能一开始就不值得安装。

b.) 我假设他们将 32 位应用程序放入 x86 文件夹，因为它不是 32 位操作系统，也就是说，旧的东西放在这里。你不会买新房子让你的狗睡在里面，而你睡在他的旧狗屋里，对吧？如果 64 位是一个进步，那么为什么要将旧版软件放在将继续作为标准安装文件夹的位置？

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-11-16T02:40:22.200

因为微软喜欢让人们的事情变得更复杂。他们没有简化向 64 位的过渡，而是使其变得分裂和困难。

# vb6 - vb6打开文件以追加问题路径未找到

> ID：293368
> 
> 赞同：3
> 
> 时间：2008-11-16T02:28:38.930
> 
> 标签：vb6, append

```
Open  App.Path & "\Folder\" & str(0) For Output 
```

似乎找不到路径但是如果在此之前我确实找到了

```
MsgBox App.Path & "\Folder\" & str(0) 
```

它提供了我想要的正确目录/文件名

如果我用引号中的直接路径替换该字符串，它可以正常工作，但是这对我的应用程序的其他用户来说不是很好:(有人知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T02:46:44.807

您可以打开一个不存在的文件。我试过了：

```
 Open "c:\temp\test.txt" & Str(0) For Output As #1
  Close #1 
```

当它运行它创建 c:\temp\test.txt 0

请注意，我在 Open 语句中添加了“As #1”，并且 Str(0) 为可选的减号添加了前导空格（CStr(0) 不添加前导空格）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T10:09:35.360

注释：您可以打开一个不存在的文件。

仅当您的文件夹存在时才为真。如果您的文件夹和文件都不存在，则会出现“找不到路径”错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T08:46:29.250

这是我为你做的一些简单的事情：

```
Function CreateLog(Destination As String, MyMessage As String)
    Dim PathToCreate, FolderPath, FileName As String

    'Check for Unnecessary Spaces
    Destination = Trim(Destination)
    FolderStr = Destination

    'Gather only FolderPath of Destination
    Do
        FolderStr = Mid(FolderStr, 1, Len(FolderStr) - 1)
    Loop Until Right(FolderStr, 1) = "\" Or Len(FolderStr) < 1

    'Gather only FileName
    FileName = Mid(Destination, Len(FolderStr) + 1, Len(Destination) - Len(FolderStr))

    'If the path does not exist than create it
    'Recursive approach
    For Each Folder In Split(FolderStr, "\")
        If InStr(1, Folder, ":") = 0 Then
            PathToCreate = PathToCreate & "\" & Folder
        Else
            PathToCreate = Folder
        End If
        If fso.FolderExists(PathToCreate) = False And PathToCreate <> "" Then
            fso.CreateFolder PathToCreate
        End If
    Next

    'Open file and add the message in it
    Open PathToCreate & "\" & FileName & ".txt" For Append As #1
    Print #1, MyMessage
    Close #1

End Function 
```

用法：

```
CreateLog "D:\Test\NewTest\NewFolder\AnotherFolder\atlastthefile.abcdefg", "Hello!" 
```

不管给出什么文件扩展，无论如何都会添加“.txt”。

# php - 在 PHP 中不加载未使用的脚本有多重要？

> ID：293375
> 
> 赞同：3
> 
> 时间：2008-11-16T02:36:11.193
> 
> 标签：php, optimization

在一个 90% 的页面使用相同库的网站上，您应该一直加载这些库还是只在需要时才加载它们？其他页面将是 ajax 或没有任何实际功能的简单页面。

此外，您是否应该只在需要时加载代码？如果在页面的中途您需要一个库，那么您应该加载它还是只是在顶部加载它。也许它可能永远不会在错误或错误数据之前到达那里。（在顶部加载使它更容易理解，但可能导致不需要额外的代码。）

我还想知道是否应该使库更具体，所以我不是说在查看的同时加载要编辑的代码？

基本上，我应该多担心加载代码或不加载代码？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-16T02:57:00.153

我总是尝试为文件、类和方法赋予[单一职责](http://en.wikipedia.org/wiki/Single_responsibility_principle "单一责任原则 - 维基百科，自由的百科全书")。因此，在任何一种情况下，将显示与编辑代码分开都是一个好主意。

至于加载库，我相信在很多情况下，包含非必需库的性能损失可能是无关紧要的。但是，`include`、`require`、`include_once`和`require_once`相对较慢，因为它们（显然）访问文件系统。如果您每次不使用的库都很大并且通常包含许多不同的文件本身，那么删除不必要的包含可能有助于减少花费在那里的时间。尽管如此，通过使用高效的缓存系统也可以大大降低成本。

鉴于您使用的是 PHP5 并且您的库很好地分为类，您可以利用 PHP 的[自动加载功能](http://php.net/autoload "PHP：自动加载 - 手动")，其中包括 PHP 脚本需要的所需类。这将非常有效地避免包含许多未使用的代码。

最后，如果您进行了任何可能影响网站性能的更改，请运行一些基准测试并分析性能的增益或损失。这样，您就不会冒着进行一些可能很酷的优化的风险，而这只会花费太多时间来完全实现甚至降低性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T02:57:55.453

请记住，每个加载的脚本都会在运行时编译 PHP 时进行解析，因此加载不需要的脚本会受到惩罚。根据您的应用程序结构和要求，这可能是次要的，但有些情况并非如此。

您可以做两件事来消除这些担忧：

1.  使用[__autoload](http://www.php.net/autoload)根据需要加载脚本。这消除了维护一个长的“需要”脚本列表的需要，并且只加载当前运行所需的内容。
2.  使用[APC](http://www.php.net/apc)作为字节码缓存来降低加载脚本的成本。APC 以编译状态缓存脚本，并为您的应用程序性能创造奇迹。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T06:14:43.077

+1 投票支持自动加载技术。

使用自动加载的另一个好处是它消除了一些滥用代码的可能性。如果出现问题，弹出一个回溯和一个“included_files”列表，你会得到一个问题可能出处的列表。

这意味着如果有人在其中一个文件的末尾隐藏了恶意代码，或者设计了一些富有成果的东西，那么您可以搜索的文件就会减少。

我曾经在一个代码库上工作过（不是我的），其中 URL 中某些标记的存在导致了意外的行为，并且由于代码很糟糕，跟踪问题的根源是一场噩梦其中一个文件正在重写整个请求，然后调用“死”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T20:55:53.820

问题是“有多重要”。

答：一点都不重要。如果你还没有十几台服务器运行这个应用程序，那么这可能是早期优化，众所周知，早期优化是万恶之源。

换句话说：甚至不用担心。在您考虑这一点之前，还有很多其他的事情可以优化速度。

# c - 为什么我的 C 代码没有编译成 EXE

> ID：293380
> 
> 赞同：1
> 
> 时间：2008-11-16T02:39:39.983
> 
> 标签：c, visual-studio

我刚开始尝试用 C 语言编写一个简单的程序，我正在使用 Visual Studios 来做这件事。我听说它可以编译 C 和 C++。我知道它确实如此，因为它说它可以编译。唯一的问题是，当我转到输出目录时，目录中没有 .exe 文件！它具有以下内容：

*   构建日志.html
*   mt.dep
*   test1.obj
*   vc90.idb
*   vc90.pdb

但仅此而已！没有EXE。我查看了所有选项并确保将其设置为编译为 exe，并检查了输出文件。即 $(OutDir)\$(ProjectName).exe。但是很可惜，没有出现任何exe。有任何想法吗？

此外，当我尝试按 f5 并首次亮相时，我收到一条错误消息

> 此应用程序无法启动，因为未找到 MSVCR90.DLL。重新安装应用程序可能会解决此问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T03:21:10.680

默认情况下，当您在新解决方案中创建新 C++ 项目时，您将获得如下文件夹结构：

C:\Projects\YourSolution C:\Projects\YourSolution\YourCppProject

YourSolution 包含 YourSolution.sln，YourCppProject 包含 YourCppProject.vcproj。

当您构建解决方案时，YourCppProject 中的所有中间文件都存储在 YourCppProject\Debug 或 YourCppProject\Release 下，但生成的 YourCppProject.exe 会在 YourSolution\Debug 或 YourSolution\Release 下。

您的 $(OutDir) 由 General -> Output Directory 配置。检查 YourCppProject 的项目配置，并查看它使用 $(SolutionDir) 作为输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T02:44:16.480

它是 C/C++ 控制台应用程序吗？您是否使用项目向导创建它？

你有类似的功能吗

```
#include "stdafx.h"

int _tmain(int argc, _TCHAR* argv[])
{
    printf("Hello, world!\n");
    return 0;
} 
```

在 .c 模块中，通常是 main.c？

当你按 F5 运行调试时会发生什么？你的构建日志是什么样的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T03:08:15.200

最简单的事情就是重新开始，确保你选择了正确的项目。

要使用 Visual Studio 编译普通的旧 C 代码，`Visual C++ > General > Empty Project`请从“新建项目”菜单中进行选择。这将创建 3 个空文件夹：头文件、资源文件和源文件。右键单击源文件，选择`Add > New Item`. 然后添加一个`main.cpp`，将其重命名为`main.c`，然后开始编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T03:38:25.920

[http://msdn.microsoft.com/en-us/library/ms235299.aspx](http://msdn.microsoft.com/en-us/library/ms235299.aspx)

> > 笔记：
> > 
> > 不支持重新分发在没有清单的情况下构建的 C/C++ 应用程序。如果没有将应用程序绑定到这些库的清单，C/C++ 应用程序就不能使用 Visual C++ 库。有关详细信息，请参阅选择部署方法。
> 
> 如果 DLL 不可访问且 Windows 无法为您的应用程序加载此 DLL，您可能会收到以下错误消息：
> 
> 此应用程序无法启动，因为未找到 MSVCR90.dll。重新安装应用程序可能会解决此问题。
> 
> 要解决这些错误，您必须确保正确构建您的应用程序并且在目标系统上正确部署 Visual C++ 库。要确定这些运行时错误的根本原因，请按照对 C/C++ 隔离应用程序和并行程序集进行故障排除中概述的步骤进行操作。

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T03:48:29.830

听起来你只点击编译，这会给你 .obj 文件，但你仍然需要点击构建。

# c# - .Net 家伙需要一些关于 Cocoa 的信息

> ID：293383
> 
> 赞同：28
> 
> 时间：2008-11-16T02:42:42.163
> 
> 标签：c#, .net, objective-c, cocoa

我想在 OSX 和 iPhone 上做一点开发。多年来，我一直是 .Net/C# 开发人员。我想知道是否有人在这两个平台上都有经验，可以告诉我它们是如何比较和对比的。我想知道我前面有什么样的学习曲线。

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-16T02:57:09.840

**首先是不好的：**
我在 XCode 中做了一些 Cocoa 开发。您会注意到的第一件事是 IDE (XCode) 并不像 Visual Studio 那样直观，或者一般来说都很好。在 XCode 中工作时，我真的很想念智能感知。Apple 开发人员可能会否决我的声明。但来自 .Net 环境，这才是我真正怀念的。所以不要把你的期望定得太高，你不会太失望。我不想让 XCode 停止运行，它只是不如 Visual Studio 好。

**现在好了：**
Cocoa 项目的总体架构**非常好**。我确实希望 .Net Winforms 和 WPF 像 Cocoa 项目一样使用开箱即用的 MVC。只要您遵循 MVC 模式，您的项目就应该没问题。我所做的一切都在 Objective C 中。你可能会拿起一本关于它的书。我购买[了适用于 Mac OS X 的 Cocoa Programming，](https://rads.stackoverflow.com/amzn/click/com/0321503619)并认为它非常好。如果您的背景中有任何 C，它看起来会非常熟悉。从 C# 的角度来看，类的点表示法被替换为类似于 Tcl 的消息发送表示法。

在您的机器上加载 iTunes 并在**iTunes U**下下载 iPhone 开发视频。您还需要在 Apple 注册开发人员计划并下载适用于 iPhone 的 XCode 的额外位。

希望有帮助。我绝不是专业的 Cocoa 开发人员。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-16T07:02:42.840

自 beta 1 以来，我一直在使用 C# 和 .NET 进行专业开发。XCode IDE 与 Visual Studio 完全不同。最初，您会感到非常困惑和迷茫。我仍然对 UI 不完全满意（亲爱的上帝，给我一个解决方案管理器窗口并杀死这个分屏垃圾），但是你很快就会像在 Studio 中一样高效和快速。文档具有可比性，尽管我更喜欢 MSDN 中的布局。

至于 Cocoa，它作为 GUI 工具包通常比 .NET 更容易使用。如上所述，它是一种不同的心态，但是一旦你把头绕在它周围，你就会挖掘它。

虽然它与 iPhone 无关，但 Mac 和 iPhone 开发之间有很多相似之处。拿起最新版本的 Aaron Hillegass OSX 书，你会帮自己一个忙。它几乎是编写任何 Cocoa 软件的事实上的指南。

总而言之......你最初会非常迷茫和困惑，但坚持它是值得的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-28T19:43:56.650

如果你有一些 Cocoa/Objective-C 背景，那么你可以在 Dave Mark 和 Jeff LaMarche 的“Beginning iPhone Development”的帮助下跳入 iPhone 开发：

[http://www.amazon.com/dp/1430216263/](https://rads.stackoverflow.com/amzn/click/com/1430216263)

这很容易理解，但作者假设对 Objective-C 有一些先验知识（如封底所述），所以我建议从 Aaron 的“Mac OS X 的 Cocoa 编程”的前五六章开始Hillegass，正如其他人之前指出的那样。

[http://www.amazon.com/dp/0321503619/](https://rads.stackoverflow.com/amzn/click/com/0321503619)

自从他在 NeXT 工作以来，Aaron 就一直在使用和教授 Objective-C 以及现在与 Cocoa 相关的框架，这表明了这一点。材料真的很好，很好。

虽然大部分开发技术同样适用于 Mac 和 iPhone，但有些技术仅适用于 Mac（例如，垃圾收集、绑定、核心数据），有些仅适用于 iPhone（例如，一个动作的多个目标）。

如果您想快速开始 iPhone 开发并且愿意投资一些现金，Aaron 的团队还可以在一周内通过 Big Nerd Ranch 的课程教您需要了解的一切。（iPhone 班总是很快就满了，但如果你碰巧在硅谷，那么 1 月份的“通勤者 iPhone”仍有空间。）

[http://www.bignerdranch.com/](http://www.bignerdranch.com/)

（单击**类**选项卡可查看时间安排，包括 Ruby、Android 等。）

虽然我个人更喜欢上面的选项，但当然也有一些免费的在线选项。Scott Stevenson 在 Cocoa/Objective-C 教程中投入了大量精力：

[http://www.cocoadevcentral.com/](http://www.cocoadevcentral.com/)

斯坦福大学开设了 Mac 开发和 iPhone 开发课程，由 Apple 工程师教授，并在网上发布了课程材料：

[Mac： http:](http://www.stanford.edu/class/cs193e/) [//www.stanford.edu/class/cs193e/](http://www.stanford.edu/class/cs193e/)
[iPhone： http:](http://www.stanford.edu/class/cs193p/) [//www.stanford.edu/class/cs193p/](http://www.stanford.edu/class/cs193p/)

最后，使用 Windows 背景进行 Mac/iPhone 开发的开发人员似乎试图避免使用 Interface Builder (IB)，而是使用代码构建 UI。我理解为什么——IB 不会在一个漂亮的代码清单中列出所有发生的事情——但我强烈建议不要使用这种策略。

Mac/iPhone 开发就是为了最小化代码。编写的代码越少，维护的就越少，出错的可能性就越小。IB 非常适合最小化 UI 所需的代码。

您的 C/C# 背景会很好地为您服务。一开始你会发现 Objective-C 看起来很奇怪，但我怀疑你会开始欣赏它的优点，并且很快就会掌握它。与 C++ 不同，它实际上非常简单。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-18T14:22:18.503

我刚刚将它标记为最喜欢的，因为我希望更多的 .NET+Cocoa 人加入进来。我刚刚（再次）开始使用 Cocoa，并且到目前为止我很喜欢它。（这有助于我在 10.5 上工作，它允许垃圾收集作为选项。）

到目前为止，我注意到的一些最大差异：

1.  是的，XCode 与 Visual Studio 非常不同。其他人可能会嘲笑“分屏”的性质，但我发现它非常直观，一旦我将我的大脑包裹在它周围。也许我可以在这里给出的最大建议是自定义工具栏，添加“编辑器”按钮，并虔诚地使用所述按钮进行代码编辑。
2.  消息传递语法感觉不熟悉，但我怀疑这是因为我不是来自 Smalltalk 背景。（我听说——虽然我还没有验证这一点——这些概念非常相似。）显然，从 10.5 开始，添加了点表示法和属性的概念，但 Hillegass 建议不要使用它们。我说做任何感觉对的事。（我自己在书中还没有那么远……）
3.  出于所有意图和目的，该语言是无类型的。这里的优点是您实际上可以修改框架类以满足您的需求，并且消息将在运行时得到解决，从而为您提供更多的自由。缺点是您可能直到运行时才发现错误，并且其中许多错误的行为方式与 .NET 异常不同——也就是说，当您未能捕获它们时，它们中的许多不会导致应用程序完全停止。（诚​​然，有`@throw`关键字；我还没有到达那里。:)）另一个缺点是 Obj-C 的`null`( `nil`) 概念可以接收消息 - 也没有`NullReferenceException`概念。这两者都可能导致调试问题。
4.  与 WinForms/WPF/ASP.NET 设计师相比，Interface Builder 是一个全新的野兽。归档整个 UI 而不是代码的概念是我们许多 .NET 人员难以掌握的概念之一。它没有错，但我们需要了解它。
5.  垃圾收集。从 10.5 开始，Cocoa 和 Objective-C 都支持引用计数 ( `retain`/ `release`/ `autorelease`) 内存管理和自动垃圾收集。刚刚开始工作，我无法详细说明两者的细节，但是虽然 GC 更易于使用，但您必须在目标选项中手动指定它——您的应用程序现在需要 10.5 或更高版本才能跑。此外，即使使用 GC，最好手动将指针设置为`nil`完成它们的时间，以向 GC 提示它们可能已准备好收集。不像.NET那么透明。（同样，还不错，只是不同。要知道的事情！）

我**绝不是**专家。我自己（再一次）从字面上开始走这条路。不过，我很喜欢它，而且我怀疑，如果像我这样的核心 Microsoft 开发人员能够挖掘它，那么其他人也可以。

最后，我在几个月前发现了[.NET Addict博客。](http://dotnetaddict.dotnetdevelopersjournal.com/)作者同时使用 .NET 和 Cocoa，并且有几篇文章讨论了它们之间的差异。强烈推荐。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-18T14:06:52.717

我在这两方面都非常有经验，尽管我已经有一年左右没有编写太多 C# 代码了。我从 Obj-C 转到 C#，并没有遇到太多麻烦。在我看来，Obj-C 代码比 C# 更正式，更不死板；例如，没有类型化数组，您不必担心在调用方法之前显式检查对象是否为 nil/null。一般来说，这是一件好事，因为您可以编写更紧凑、更优雅的代码 (IMO)。同时，与 C# 不同的是，您需要了解 C 编程的基本概念才能使用 Obj-C，因此如果您生疏了，可能需要复习一下指针之类的东西。

我认为对于 API，您会发现 Cocoa 更适合桌面应用程序，而不是 .NET 那样的企业级应用程序。例如，.NET 有 ADO.NET、ReportViewer 控件，而 Cocoa 有 Core Data、PDFKit 和 SearchKit。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-16T03:36:17.407

您必须始终提醒自己的一件大事是，Cocoa**的工作方式与 WinForms 不同**。即使您正在寻找一个，您也不会在任何地方找到“事件处理程序”！并不是说 WinForms 不好，而是 Cocoa 只是一个不同的范例。

# java - 处理在单独线程中抛出的异常的最佳方法是什么？

> ID：293388
> 
> 赞同：4
> 
> 时间：2008-11-16T02:46:57.223
> 
> 标签：java, multithreading, exception, java-me

我正在开发一个 J2ME 项目，该项目为许多任务（例如下载 HTTP 内容）生成工作线程。基本的线程布局与大多数 Java 应用程序相似——有一个主 UI 线程和工作线程来执行幕后工作。我的问题是处理工作线程中发生的异常的最佳方法是什么？

我通常坚持大多数异常应该尽可能渗透的设计原理。当我编写单线程应用程序时，我通常会将异常一直渗透到 UI 层，然后在错误对话框中将它们报告给用户。多线程应用程序是否有类似的做法？对我来说最直观的是在 Thread.run() 中捕获异常，然后在 UI 线程上调用 invokeLater 以在对话框中报告它。我在这里看到的问题是，在工作线程过早死亡之外，这种方法并没有真正通知 UI 线程有错误。可以这么说，我看不到跨线程抛出异常的明确方法。

谢谢，安迪

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T04:17:20.350

你不应该把 UI 代码塞进你的工人！

```
/**
 * TWO CHOICES:
 * - Monitor your threads and report errors,
 * - setup a callback to do something.
 */
public class ThreadExceptions {

    /** Demo of {@link RunnableCatch} */
    public static void main(String[] argv) throws InterruptedException {
        final Runnable bad = new NaughtyThread();
        // safe1 doesnt have a callback
        final RunnableCatch safe1 = new RunnableCatch(bad);
        // safe2 DOES have a callback
        final RunnableCatch safe2 = new RunnableCatch(bad, new RunnableCallback() {
            public void handleException(Runnable runnable, Exception exception) {
                System.out.println("Callback handled: " + exception.getMessage());
                exception.printStackTrace();
            }

        });
        final Thread t1 = new Thread(safe1, "myThread");
        final Thread t2 = new Thread(safe2, "myThread");
        t1.start();
        t2.start();
        t1.join();
        t2.join();
        if (safe1.getException() != null) {
            System.out.println("thread finished with exceptions");
            safe1.getException().printStackTrace();
        }
        System.out.println("done");
    }

}

/** Throws an exception 50% of the time */
class NaughtyThread implements Runnable {
    public void run() {
        try {
            if (Math.random() > .5) {
                throw new RuntimeException("badness");
            }
        } finally {
            System.out.println("ran");
        }
    }
}

/** Called when an exception occurs */
interface RunnableCallback {
    void handleException(Runnable runnable, Exception exception);
}

/**
 * Catches exceptions thrown by a Runnable,
 * so you can check/view them later and/or
 * deal with them from some callback.
 */
class RunnableCatch implements Runnable {

    /** Proxy we will run */
    private final Runnable _proxy;

    /** Callback, if any */
    private final RunnableCallback _callback;

    /** @guarded-by(this) */
    private Exception _exception;

    public RunnableCatch(final Runnable proxy) {
        this(proxy, null);
    }

    public RunnableCatch(final Runnable proxy, RunnableCallback target) {
        _proxy = proxy;
        _callback = target;
    }

    public void run() {
        try {
            _proxy.run();
        } catch (Exception e) {
            synchronized (this) {
                _exception = e;
            }
            if (_callback != null) {
                _callback.handleException(_proxy, e);
            }
        }
    }

    /** @return any exception that occured, or NULL */
    public synchronized Exception getException() {
        return _exception;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T04:28:55.193

除了 Stuph 给出的选项之外，另一个选项是在本地线程中设置异常。如果在清除该异常之前发生另一个异常，则发生断言。这至少让某人有机会注意到异常并对其进行处理。

# php - 在PHP中完成HTTP请求后执行代码？

> ID：293389
> 
> 赞同：4
> 
> 时间：2008-11-16T02:54:08.630
> 
> 标签：php, zend-framework

PHP 提供了一种注册关闭函数的机制：

```
register_shutdown_function('shutdown_func'); 
```

问题是在最近的 PHP 版本中，这个函数仍然在请求期间执行。

我有一个平台（如果重要的话，在 Zend 框架中），整个请求中的任何一段代码都可以注册一个要登录到数据库的条目。我没有在整个请求中使用大量单独的插入语句来减慢页面速度，而是将它们排队以在请求结束时插入。我希望能够在用户完成 HTTP 请求后执行此操作，因此记录或执行任何其他清理任务的时间长度不会影响用户感知的页面加载时间。

PHP中是否有内置方法可以做到这一点？或者我是否需要使用外部进程配置某种共享内存空间方案并指示该进程进行日志记录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T06:30:20.347

如果您真的关心 MySQL 的插入时间，那么您可能是在解决症状而不是原因。

例如，如果您的 PHP/Apache 进程在用户获取他们的 HTML 之后执行，那么您的 PHP/Apache 进程仍被锁定在该请求中。由于它很忙，如果出现另一个请求，Apache 必须分叉另一个线程，为其分配更多内存，打开额外的数据库连接等。

如果您遇到性能问题，您需要从 PHP/Apache 执行中移除繁重的工作。如果您有很多清理任务正在进行，那么您正在烧毁宝贵的 Apache 进程。

我会考虑将您的条目记录到文件中，并让 crontab 将这些条目带外加载到您的数据库中。如果您有其他繁重的任务，请使用排队/作业处理系统来完成带外工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T03:10:44.510

除了 register_shutdown_function() 之外，没有用于确定脚本何时退出的内置方法。然而，Zend 框架有几个钩子用于在调度过程的特定点运行代码。对于您的要求，最相关的是动作控制器的[调度后钩子](http://framework.zend.com/manual/en/zend.controller.action.html#zend.controller.action.prepostdispatch)，它发生在动作被调度之后，以及控制器插件代理的[dispatchLoopShutdown 事件](http://framework.zend.com/manual/en/zend.controller.plugins.html#zend.controller.plugins.introduction)。

您应该阅读手册以确定哪个更适合您。

编辑：我想我没有完全理解。从这些钩子中，您可以以某种形式分叉当前进程。PHP 有几种方法可以派生进程，您可以在手册中的[程序执行](http://www.php.net/manual/en/refs.fileprocess.process.php)部分阅读。我建议查看 pcntl 扩展 - 阅读[这篇博](http://www.welldonesoft.com/technology/articles/php/forking/)文以查看分叉子进程以在后台运行的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T04:09:37.777

[这个随机家伙的博客](http://www.brandonchecketts.com/archives/performing-post-output-script-processing-in-php)上的评论听起来与您想要的相似。如果该标头技巧不起作用，则该博客上的一条评论建议`exec()`使用单独的 PHP 脚本在后台运行，如果您的 Web 主机的配置允许这样的话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T04:14:12.557

对于您的口味，这可能有点骇人听闻，但这将是一种有效且简单的解决方法。

您可以创建一个由您选择的数据库管理的“队列”，首先，将请求存储在数据库的队列表中，然后输出一个 iframe，该 iframe 会导致一个脚本，该脚本将触发与您的 queue_id 匹配的指令数据库。

前任：

```
<?php
mysql_query('INSERT INTO queue ('instructions') VALUES ('something would go here');
echo('<iframe src="/yourapp/execute_queue/id?' . mysql_insert_id() . '" />');
?> 
```

框架会做类似的事情

前任：

```
<?php
$result = mysql_query('SELECT instructions FROM queue WHERE id = ' . $_GET['id']);
// From here, simply execute some instruction based on the "instructions" field, then delete the instruction from the database.
?> 
```

就像我说的，我可以看到你怎么会认为这个 hackish，但是框架将独立于它的父页面加载，所以它可以实现你想要的，而不需要在后台运行一些其他应用程序。

希望这至少可以为您指明正确的方向。

干杯!

# c - 未找到 MSVCR90.DLL

> ID：293401
> 
> 赞同：14
> 
> 时间：2008-11-16T03:03:05.023
> 
> 标签：c, visual-studio, visual-studio-2008

我知道已经有人问过这样的问题，但情况有点不同，关于那个问题的所有答案都对我不起作用。

我正在尝试在 VS2008 中编译一些 C 代码，但它不会创建 exe。此外，当我尝试使用 f5 运行它时，我得到：

> 此应用程序无法启动，因为未找到 MSVCR90.DLL。

我做了一些谷歌搜索，它说这是因为我的 c++ 可再发行包没有安装。所以我安装了它，重新启动一切并再次尝试。但是，唉，我仍然得到同样的错误。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-16T03:39:15.183

这听起来像是您的 VS2008 安装有问题，或者您的 DLL 搜索路径有问题。MSVCR90.DLL 是在您安装 VS2008 时安装的，您不必安装任何额外的可再发行包。

首先，我将检查您的 PATH 环境变量并确保其中没有会破坏某些条目的 gobbledydook，如果您在那里没有发现问题，那么我将卸载并重新安装 Visual Studio。

您也可以尝试搜索 MSVCR90.DLL（和其他类似的 DLL），并将它们移动到您的 Windows/System32 文件夹。

如果您现在只想开始，您可以做的另一件事是将项目更改为静态链接到运行时库，然后它甚至不会尝试加载该 DLL。转到您的项目设置，配置属性-> C/C++-> 代码生成并将运行时库从多线程 DLL 更改为仅多线程（或任何不以 DLL 结尾的选项）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T03:44:49.290

以下是检查项目配置的一些事项 - 在常规选项卡下：

*   .1 配置类型 - exe 在您的情况下。
*   .2 MFC 的使用：如果这是一个 MFC 应用程序，它可能更便于移植： 在静态库中使用 MFC。
*   .3 使用 ATL - 如果不使用 atl（或不确定），请说不使用 ATL。
*   .4 在 C/C++ -> Runtime Library 下：说多线程调试（调试版本）或多线程（发布版本）。

如果您收到特定的链接器错误，说明某些内容已定义：这意味着您的应用程序的某些部分（链接到您的 exe 的单独库）是使用不同的运行时链接构建的：

你可以：

*   确保这些库是使用与您的应用程序相同版本的 Visual Studio 编译的。

*   将这些项目更改为使用静态运行时：C/C++ -> 代码生成 -> 运行时库：/MT 或 MTd（与上面的 #4 相同）

*   如果您仍然有一些特定错误，请尝试告诉链接器忽略某些库：转到 Linker->Ignore Specific Library 并放入您要忽略的库。这对于“libcmt.lib”或“libcmtd.lib”最为常见。同样重要的是要知道以 'd' 结尾的 lib 通常是调试版本。如果您正在创建一个发布版本并且您得到“已经在 libcmtd.lib 中定义”，这意味着您正在某个地方将发布库链接到调试库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-08T14:00:49.207

如果您删除与您.exe 关联的清单文件，您将收到相同的错误。

MSVCR90.dll 没有安装在 system32 中，而是安装在并排文件夹中，因此需要清单。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-03T15:21:49.067

我刚刚被这个咬了，[这个页面](http://www.insidercoding.com/post/2008/07/21/Debugging-issues-with-MSVCR90DLL.aspx)让我再次工作。

关键是在调试配置中忽略 MSVCRT 和 MSVCR90 库。设置您的链接器 -> 输入 -> 忽略特定库设置以包括以下内容：

*   MSVCRT
*   MSVCR90

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-28T05:29:02.910

它应该在[http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a5c84275-3b97-4ab7-a40d-3802b2af5fc2&displaylang=en](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a5c84275-3b97-4ab7-a40d-3802b2af5fc2&displaylang=en) Visual Studio 2008 运行时库中。是的！安装后，openoffice 更新工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T05:58:39.973

如果您将完成的 exe 提供给其他人，他们将需要安装最新的 Visual c 运行时才能运行它。这仅适用于发布版本 AFAIK。Visual Studio 应在您的路径中安装所需的发布和调试运行时。该项目可能为不正确的运行时版本意外设置了额外的依赖项。

看看[这个页面](http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx)是否有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T03:41:55.260

转到您的项目设置，配置属性-> C/C++-> 代码生成并将运行时库从多线程 DLL 更改为多线程，然后尝试编译，但它不会。然后将其更改为多线程调试并尝试编译，但它不会再次，然后将其更改回多线程DLL，然后它应该编译并运行。

# lucene - Lucene 查询解析器

> ID：293403
> 
> 赞同：6
> 
> 时间：2008-11-16T03:04:35.847
> 
> 标签：lucene

Lucene QueryParser.parse(string) 是否仍然有效？如果不推荐使用，新语法是什么？

查询查询 = QueryParser.parse("Ophelia");

谢谢塔季扬娜

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T03:07:50.537

不确定确切的 API，但它已更改为实例对象。所有 QueryParsers 现在都是实例对象。

```
var qp = new QueryParser(new StandardAnalyzer(),fields);
qp.Parse(inputString,fields); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-27T15:25:22.330

5.0版：

```
QueryParser parser = new QueryParser(fields, new StandardAnalyzer());
Query query = parser.parse(searchString); 
```

这是最新的api！

# ruby-on-rails - 在 ruby on rails 中将参数作为路径变量传递

> ID：293409
> 
> 赞同：2
> 
> 时间：2008-11-16T03:12:02.477
> 
> 标签：ruby-on-rails, database, rails-routing

我还是 ROR 的新手，所以请原谅这个问题的简单性......

因此[http://www.example.com/controller/:id](http://www.example.com/controller/:id)在我的表中显示一条记录，其中 :id 是一个数字（1、2、3 等）。

有没有办法可以让 URL 中的 :id 成为显示记录中字段的值？这样我就可以拥有[http://www.example.com/controller/record_field](http://www.example.com/controller/record_field)？我希望对表中的特定记录进行人性化的引用。我相信这一定是可能的。我是否更改了 routes.rb 中的某些内容？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T03:19:06.613

最简洁的方法是在模型中添加一个新的 find 方法（或者简单地使用 Rails 提供的 find_by_fieldname 来控制）。然后您将让您的控制器使用该方法而不是常规的 find(params[:id]) 来提取您的模型记录。

[在这里](http://railscasts.com/episodes/63-model-name-in-url)查看 Ryan B 的截屏视频。这很容易，而且他是一位好老师，所以你应该没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T08:54:49.493

我使用名为friendly_id 的优秀rails 插件。

[http://github.com/norman/friendly_id/tree/master](http://github.com/norman/friendly_id/tree/master)

那应该很好地解决你。它也有据可查。

注意可能具有现代希腊字符的字段——可能需要为这些字符寻找解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T06:46:32.980

Jon Smock 的解决方案也可以。我倾向于以下。

```
class Hamburger << ActiveRecord::Base

  #this normally defaults to id
  def to_param 
     name
  end

end

class SomeModelController << ApplicationController

  def show 
    @hamburger = Hamburger.find(params[:id])  #still default code
  end
end

#goes in some view
This is the <%= link_to "tastiest hamburger ever", url_for(@hamburger) %>. 
```

粗略地说，这是一种 SEO 技术（漂亮的 URL 也是用户友好的，即使您不关心 SEO，我也向所有人推荐它们，例如在登录后的页面上）。我对 Rails SEO 进行了更深入的讨论，其中包括其他类似的技巧，[请点击此处](http://www.bingocardcreator.com/rails-seo-tips.htm)。

**重要提示：**`param`您应该在设计时考虑如果应该更改您将要做什么。例如，在我的汉堡包场景中，我完全有可能将“Sinfully Delicious Cheeseburger”重命名为“Triple Bypass”。如果这更改了 URL，则可能会产生一些影响，例如客户指向我的网站的链接被破坏。因此，对于生产用途，我通常给这些模型一个不可变的`permalink`属性，我将其初始化为仅对人类有意义*一次*。如果对象稍后发生变化，哦，好吧，URL 保持不变。（还有其他解决方案——这只是最简单的一个。）

# c++ - C++：使用两种内在类型的运算符作为函数对象

> ID：293421
> 
> 赞同：5
> 
> 时间：2008-11-16T03:24:12.983
> 
> 标签：c++, templates, functional-programming

我有一个类向量类，其中包含一个类型为对象的数组`"T"`，我想实现 4 个算术运算符，它将对每个项目应用运算：

```
// Constructors and other functions are omitted for brevity.
template<class T, unsigned int D>
class Vector {

public:
    // Add a value to each item: naive implementation.
    void operator += (const T&) {
        for (int i = 0; i < D; ++i) {
            data[i] += value;
        }
    }
    void operator -= (const T&) { ... }
    void operator *= (const T&) { ... }
    void operator /= (const T&) { ... }

private:
    T items[D];
}; 
```

因为运算符将包含相同的样板代码（循环每个元素并应用适当的操作），我想我可以概括它：

```
template<class T, unsigned int D>
class Vector {

public:
    void operator += (const T& value) { do_for_each(???, value); }
    void operator -= (const T& value) { do_for_each(???, value); }
    void operator *= (const T& value) { do_for_each(???, value); }
    void operator /= (const T& value) { do_for_each(???, value); }

private:
    void
    do_for_each(std::binary_function<void, T, T>& op, T value) {
        std::for_each(data, data + D, std::bind2nd(op, value));
    }

    T data[D];
}; 
```

现在，问题是，我如何传递一个运算符，该运算符采用两种内在类型并返回`void`到`do_for_each`，如上例所示？C++ 不允许我为内在类型做这个技巧（如果是，`"T::operator+="`将不起作用）。`"T"``"int"`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-16T03:40:15.433

首先，您应该真正从您的 operator+= 返回一个引用，因为您以后可以使用它们来实现 operator+、operator- 等。我会相应地改变它。

此外，您的 do_for_each 必须是一个模板，因为它必须知道函数对象的精确类型，因为二进制函数对象不是多态类。对于实际操作，您要使用`std::transform`：

```
template<class T, unsigned int D>
class Vector {

public:
    Vector& operator += (const T& value) { 
        do_for_each(std::plus<T>(), value); 
        return *this;
    }

    Vector& operator -= (const T& value) { 
        do_for_each(std::minus<T>(), value); 
        return *this;
    }

    Vector& operator *= (const T& value) { 
        do_for_each(std::multiplies<T>(), value);
        return *this; 
    }

    Vector& operator /= (const T& value) { 
        do_for_each(std::divides<T>(), value); 
        return *this;
    }

private:
    template<typename BinFun>
    void do_for_each(BinFun op, const T& value) {
        std::transform(data, data + D, data, std::bind2nd(op, value));
    }

    T data[D];
}; 
```

[std::transform](http://www.sgi.com/tech/stl/transform.html)只会将每个元素传递给函数对象，并将结果分配回作为第三个参数给出的迭代器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T04:48:20.520

你真的应该看看[Boost Operators](http://www.boost.org/doc/libs/1_37_0/libs/utility/operators.htm)，这是一个只有头文件的库，它真正简化了创建正交和一致的算术运算符重载。

具体来说：您可能会发现派生自`boost::operators::integer_arithmatic<T>`可以为您节省大量此类重复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T06:11:51.600

我认为 litb 在正确的轨道上并回答了确切的问题。
但我认为这是错误的解决方案。

我宁愿不使用 do_for_each() 而是直接使用 std::transform() ：

```
template<class T, unsigned int D>
class Vector 
{

  public:
    Vector& operator += (const T& value) { 
        std::transform(data, data + D, data, std::bind2nd(std::plus<T>(),value)); 
        return *this;
    }

    Vector& operator -= (const T& value) { 
        std::transform(data, data + D, data, std::bind2nd(std::minus<T>(),value)); 
        return *this;
    }

    Vector& operator *= (const T& value) { 
        std::transform(data, data + D, data, std::bind2nd(std::multiplies<T>(),value));
        return *this; 
    }

    Vector& operator /= (const T& value) { 
        std::transform(data, data + D, data, std::bind2nd(std::divides<T>(),value)); 
        return *this;
    }

  private:
    T data[D];
}; 
```

# nhibernate - NHibernate 2.0.1 标准：IsNull 限制抛出异常

> ID：293423
> 
> 赞同：1
> 
> 时间：2008-11-16T03:24:27.367
> 
> 标签：nhibernate, exception, criteria

我一直在使用`NHibernate 2.0.1.4000`所有当前的 .NET 3.5 SP1 项目，并且在使用任何其他查询（使用 Query 或 Criteria API）时都没有遇到任何问题，直到一些新的业务逻辑要求在这个特定项目中针对应用程序的数据库，需要从单个表中检索具有特定空属性（日期时间类型）的记录。

知道您不能对此类查询使用不等于限制，而是可以使用 IsNull 限制，这个简单的查询会生成“值不能为空！” 执行时异常。我有大量的 DEBUG 模式 log4net 日志文件，我已经查看过但还没有帮助，并且我已经验证我的表类确实指定了我正在检查的属性是一个可为空的属性（DateTime？）以避免强制更新记录等可能导致的问题，这在此处不会发生...

这是查询，没什么复杂的，我尝试使用/不使用 MaxResults 附加限制来消除它作为问题，但是，每次在我收集结果之前都会抛出异常：

```
ICriteria criteria = session.GetISession().CreateCriteria(typeof (Order)).Add(NHibernate.Criterion.Restrictions.IsNull("ShippedOn")).SetMaxResults(10);

IList<Order> entityList = criteria.List<Order>(); 
```

有什么想法或指向更多信息可以帮助我解决这个问题吗？我已经尝试过使用 HQL，同样的问题......我在这里遗漏了一些关于返回具有特定空属性的记录的内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-18T22:32:24.850

快速更新......但经过进一步调查后发现，当事务和工作单元完成时，Expection 实际上被抛出，并且会话 .Flush() 方法被调用，并且再次以某种方式与 NHibernate 如何尝试处理可为空的表字段/DAO 属性。即使我已经在我的课程中处理并映射了适用的表，但我的限制条件正在生成的实际 SQL 会导致异常在 Flush 上被 SqlDateTime 问题引发......

目前，我的解决方法是从我的第一个限制中检索记录并处理代码中的 IsNull 检查，而不是查询。性能不高，但在我弄清楚之前，它正在工作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T23:12:28.523

DateTimes 在 .net 中不可为空。您是否尝试过更改域模型以使用 DateTime？哪个可以为空？

您可以使用标准查询获得类似的异常。假设我有一个 Person 域对象，其中包含一个名为 Name 的字符串属性。我可以构建以下标准：

```
ICriteria criteria = session.CreateCriteria(typeof(Person)
.Add(Restrictions.Eq(1234)) 
```

但是我是否列出了这个标准 NHibernate 会抛出一个类型不匹配异常，因为我正在针对一个 int 测试一个字符串。NHIbernate 在幕后对映射的对象进行了一些巧妙的反射类型检查，如果类型不对齐，则会抛出异常。（如果不是这么聪明，你可能会得到一个 SqlException ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:47:46.290

当您的域模型、映射和数据库之间不匹配时，我已经看到过这种异常。例如，如果您的数据库中有一个可为空的 DateTime 字段，但在您的模型上没有一个可为空的属性。

[不久前，我在我的博客上的一篇文章](http://www.jagregory.com/writings/nhibernate-and-the-sqltypeexception/)中描述了它。我不能肯定这是你的问题，但它肯定听起来很熟悉。

# database - 就数据库而言，“为了正确性而规范化，为了性能而去规范化”是正确的口头禅吗？

> ID：293425
> 
> 赞同：48
> 
> 时间：2008-11-16T03:24:55.773
> 
> 标签：database, database-design, database-normalization, denormalization

规范化导致许多基本和理想的特征，包括审美愉悦。此外，它在理论上也是“正确的”。在这种情况下，非规范化被用作一种折衷方案，一种实现性能的校正。除了性能之外，还有什么原因可以使数据库非规范化？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-16T03:28:17.203

非规范化的两个最常见原因是：

1.  表现
2.  无知

前者应通过剖析进行验证，而后者应使用卷起的报纸进行更正；-)

我想说一个更好的口头禅是“为了正确而规范化，为了速度而去规范化——而且只有在必要时”

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2011-07-22T18:50:12.030

要完全理解原始问题的重要性，您必须了解系统开发中的团队动态，以及不同角色/类型的人倾向于采取的行为（或不当行为）类型。规范化很重要，因为它不仅仅是对设计模式的冷静辩论——它还与随着时间的推移如何设计和管理系统有很大关系。

数据库人员受过培训，认为数据完整性是最重要的问题。我们喜欢考虑数据 100% 的正确性，这样一旦数据在数据库中，您就不必考虑或处理它是否存在逻辑错误。这种思想流派高度重视规范化，因为它会导致（迫使）团队掌握数据和系统的底层逻辑。举一个简单的例子——客户只有一个姓名和地址，还是可以有多个？需要有人做出决定，系统将依赖于一致应用的规则。这听起来像是一个简单的问题，但是当你设计一个相当复杂的系统时，将这个问题乘以 500 倍，你就会看到问题——规则不能仅仅存在于纸上，它们必须得到执行。一个良好规范化的数据库设计（在唯一性约束、外键、检查值、逻辑执行触发器等的额外帮助下）可以帮助您拥有定义良好的核心数据模型和数据正确性规则，这非常重要，如果当许多人在系统的不同部分（不同的应用程序、报告等）上工作并且随着时间的推移不同的人在系统上工作时，您希望系统按预期工作。或者换一种说法——如果你没有某种方法来定义和操作执行一个可靠的核心数据模型，你的系统就会很糟糕。当许多人在系统的不同部分（不同的应用程序、报告等）工作并且随着时间的推移不同的人在系统上工作时，如果您希望系统按预期工作，这一点非常重要。或者换一种说法——如果你没有某种方法来定义和操作执行一个可靠的核心数据模型，你的系统就会很糟糕。当许多人在系统的不同部分（不同的应用程序、报告等）工作并且随着时间的推移不同的人在系统上工作时，如果您希望系统按预期工作，这一点非常重要。或者换一种说法——如果你没有某种方法来定义和操作执行一个可靠的核心数据模型，你的系统就会很糟糕。

其他人（通常是经验较少的开发人员）不这么看。他们认为数据库充其量是一个受制于他们正在开发的应用程序的工具，或者在最坏的情况下是一个需要避免的官僚机构。（请注意，我说的是“经验不足”的开发人员。优秀的开发人员与数据库人员一样意识到对可靠数据模型和数据正确性的需求。他们可能会在实现这一目标的最佳方法上有所不同，但是以我的经验，只要数据库团队知道他们在做什么并且可以对开发人员做出响应，就可以合理地在数据库层中做这些事情）。这些经验不足的人通常是推动非规范化的人，这或多或少是为了设计和管理数据模型而进行快速而肮脏的工作的借口。这就是您最终获得具有应用程序屏幕和报告的 1:1 数据库表的方式，每个表都反映了不同开发人员的设计假设，并且表之间完全缺乏完整性/连贯性。在我的职业生涯中，我曾多次经历过这种情况。开发系统是一种令人沮丧且效率极低的方式。

因此，人们对正常化有强烈感觉的一个原因是，这个问题是他们强烈关注的其他问题的替代品。如果你被卷入关于正常化的辩论，请考虑各方可能带来辩论的潜在（非技术）动机。

话虽如此，这是对原始问题的更直接答案:)

将您的数据库视为由尽可能接近逻辑设计的核心设计（高度规范化和约束）和解决其他问题（如稳定的应用程序接口和性能）的扩展设计组成是很有用的。

您应该希望约束和规范化您的核心数据模型，因为不这样做会损害数据的基本完整性以及系统正在构建的所有规则/假设。如果你让这些问题远离你，你的系统很快就会变得很糟糕。根据需求和真实数据测试您的核心数据模型，然后疯狂地迭代直到它工作。这一步感觉更像是澄清需求而不是构建解决方案，它应该这样做。使用核心数据模型作为强制功能，为所有相关人员获得有关这些设计问题的明确答案。

在继续扩展数据模型之前完成您的核心数据模型。使用它，看看你能用它走多远。根据数据量、用户数量和使用模式，您可能永远不需要扩展数据模型。看看您可以通过索引以及可以在 DBMS 中打开的 1,001 个与性能相关的旋钮获得多远。

如果您真正利用 DBMS 的性能管理功能，那么您需要考虑以增加非规范化的方式扩展您的数据模型。请注意，这不是非规范化您的核心数据模型，而是添加处理 denorm 数据的新资源。例如，如果有一些大型查询会破坏您的性能，您可能需要添加一些表来预先计算这些查询将产生的数据——本质上是预先执行查询。以保持非规范化数据与核心（规范化）数据的一致性的方式执行此操作非常重要。例如，在支持它们的 DBMS 中，您可以使用 MATERIALIZED VIEW 来自动维护 denorm 数据。如果您的 DBMS 没有此选项，

*以一种连贯的方式**选择性地*对数据库进行非规范化以应对现实的性能挑战与仅仅使用弱数据设计并将性能作为其理由之间存在天壤之别。

 *当我与中低经验的数据库人员和开发人员一起工作时，我坚持他们会产生一个绝对规范化的设计……然后可能会涉及少数更有经验的人来讨论选择性非规范化。非规范化在您的核心数据模型中或多或少总是不好的。在核心之外，如果你以一种经过深思熟虑和连贯的方式进行非规范化，那么它就没有任何问题。

换句话说，从一个正常的设计去规范化到一个在保留正常的同时添加一些非规范的设计——在处理数据的物理现实的同时保留它的基本逻辑——是好的。没有正常设计核心的设计——甚至不应该被称为非规范化，因为它们从一开始就没有被规范化，因为它们从来没有有意识地以一种有规律的方式设计——是不好的。

不要接受这样的术语，即弱、无纪律的设计是“非规范化”设计。我相信故意/仔细非规范化数据与导致非规范化数据的普通旧糟糕数据库设计之间的混淆是许多关于非规范化辩论的根本原因。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-16T04:49:04.777

非规范化通常意味着检索效率的一些改进（否则，为什么要这样做），但是在修改（插入、更新，有时甚至是删除）操作期间验证数据的复杂性方面付出了巨大的代价。大多数情况下，额外的复杂性被忽略（因为它太难描述了），导致数据库中的虚假数据，通常直到后来才被发现 - 例如当有人试图找出公司破产的原因和事实证明，数据是自不一致的，因为它是非规范化的。

我认为口头禅应该是“为了正确而规范化，只有当高级管理层愿意将你的工作交给别人时才去规范化”，此时你应该接受去新的牧场的机会，因为目前的工作可能不会持续下去，只要你会的。

或者“仅当管理层向您发送一封电子邮件，为您将造成的混乱无罪时才进行非规范化”。

当然，这假设您对自己的能力和对公司的价值充满信心。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-17T14:57:28.793

咒语几乎总是过分简化其主题。这是一个很好的例子。

规范化的优点不仅仅是理论上的或美学的。对于 2NF 及以后的每一次偏离正常形式，当您不遵循正常形式时会发生更新异常，而当您遵循正常形式时会消失。从 1NF 出发是一个完全不同的蠕虫罐头，我不打算在这里处理它。

这些更新异常通常属于插入新数据、更新现有数据和删除行。您通常可以通过巧妙、棘手的编程来解决这些异常情况。那么问题是使用聪明、棘手的编程的好处是值得的。有时代价是错误。有时代价是失去适应性。有时成本实际上是，不管你信不信，糟糕的表现。

如果你学习了各种范式，你应该认为你的学习是不完整的，直到你理解了伴随的更新异常。

将“非规范化”作为指导方针的问题在于它没有告诉您该做什么。有无数种方法可以对数据库进行非规范化。他们中的大多数人都很不幸，这是慈善的。最愚蠢的方法之一是每次你想加速某些特定查询时，一次简单地反规范化一个步骤。如果不了解应用程序的历史，您最终会得到一个无法理解的疯狂的杂烩。

许多“当时似乎是个好主意”的非规范化步骤后来被证明是非常糟糕的举动。

当您决定不完全规范化时，这是一个更好的选择：采用一些产生某些好处的设计规范，即使该设计规范背离了完全规范化。例如，星型模式设计，广泛用于数据仓库和数据集市。这是一种更加连贯和有纪律的方法，而不是仅仅通过奇思妙想进行非规范化。您将从星型模式设计中获得特定的好处，您可以将它们与您将遭受的更新异常进行对比，因为星型模式设计与规范化设计相矛盾。

通常，许多设计星型模式的人都在构建辅助数据库，它不与 OLTP 应用程序交互。保持这种数据库最新的最困难的问题之一是所谓的 ETL（提取、转换和加载）处理。好消息是，所有这些处理都可以集中在少数几个程序中，处理规范化 OLTP 数据库的应用程序程序员不必学习这些东西。有一些工具可以帮助 ETL，将数据从规范化的 OLTP 数据库复制到星型模式数据集市或仓库是一个很好理解的案例。

一旦您构建了星型模式，如果您选择了维度，明智地命名了列，特别是选择了粒度，那么将此星型模式与 Cognos 或 Business Objects 等 OLAP 工具一起使用几乎就像玩游戏一样简单一个视频游戏。这使您的数据分析师可以专注于分析数据，而不是了解数据容器的工作方式。

除了星型模式之外，还有其他一些偏离规范化的设计，但星型模式值得特别一提。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-16T21:37:52.323

Don't forget that each time you denormalize part of your database, your capacity to further adapt it decreases, as risks of bugs in code increases, making the whole system less and less sustainable.

Good luck!

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-16T03:31:52.813

维度模型中的数据仓库通常以（非规范化）星型模式建模。这些类型的模式（通常）不用于在线生产或事务系统。

根本原因是性能，但事实/维度模型还允许一些时间特征，例如在传统 ER 样式模型中可行的缓慢变化的维度，但可能非常复杂和缓慢（生效日期、存档表、活动记录， ETC）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-10-17T14:43:35.887

规范化与性能无关。我真的不能说它比 Erwin Smout 在这个线程中所做的更好： [规范化数据库对资源的影响是什么？](https://stackoverflow.com/questions/1379340/what-is-the-resource-impact-from-normalizing-a-database)

大多数 SQL DBMS 在不损害逻辑模型的情况下对更改数据的物理表示的支持有限，所以不幸的是，这就是为什么您可能会发现有必要进行道德化的原因之一。另一个是许多 DBMS 对多表完整性约束没有很好的支持，因此作为实现这些约束的解决方法，您可能被迫将无关属性放入某些表中。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-16T03:46:48.103

数据库规范化不仅仅是为了理论上的正确性，它还可以帮助防止数据损坏。我当然不会像@aSkywalker 建议的那样因为“简单”而去规范化。修复和清理损坏的数据绝非易事。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-16T14:36:05.000

您本身并没有标准化“正确性”。事情是这样的：

非规范化表具有提高性能的好处，但需要冗余和更多的开发人员脑力。

规范化表具有减少冗余和增加开发便利性的好处，但需要性能。

这几乎就像一个经典的平衡方程。因此，根据您的需求（例如有多少正在敲击您的数据库服务器），除非确实需要，否则您应该坚持使用规范化表。然而，从规范化到非规范化的开发比反规范化更容易且成本更低。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-16T14:01:17.067

没门。请记住，您应该规范化的是您的关系（逻辑级别），而不是您的表格（物理级别）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-16T14:23:04.137

非规范化数据更常见于未进行足够规范化的地方。

我的口头禅是“为了正确而规范化，为了表现而消除”。RDBM 是非常灵活的工具，但针对 OLTP 情况进行了优化。用更简单的东西（例如内存中的对象和事务日志）替换 RDBMS 会很有帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-03-06T23:27:36.237

我不同意这里人们的断言，即规范化数据库总是与更简单、更清洁、更健壮的代码相关联。当然，在很多情况下，完全规范化的代码比部分非规范化的代码更简单，但充其量这是一个指导方针，而不是物理定律。

有人曾经将一个词定义为一个活生生的想法的皮肤。在 CS 中，您可以说对象或表格是根据问题的需求和现有基础设施来定义的，而不是理想对象的柏拉图式反映。从理论上讲，理论和实践之间没有区别，但在实践中，你确实会发现理论的差异。这句话对 CS 来说特别有趣，因为该领域的重点之一是发现这些差异并以尽可能最好的方式处理它们。

从数据库方面休息一下，看看事情的编码方面，面向对象编程通过将许多密切相关的代码组合在一个对象类名称下，使我们摆脱了意大利面条编码的许多弊端它具有易于记忆的英文含义，并且以某种方式适合与其相关联的所有代码。如果太多信息聚集在一起，那么每个对象最终都会变得非常复杂，这让人想起意大利面条代码。如果你把集群做得很小，那么你就不能在不搜索大量对象的情况下遵循逻辑线程，每个对象中的信息很少，这被称为“通心粉代码”。

如果您考虑在事物的编程方面的理想对象大小与标准化数据库所产生的对象大小之间的权衡，我会向那些说通常基于数据库选择更好的人表示赞同然后在代码中解决该选择。特别是因为在某些情况下，您有能力通过使用 hibernate 和类似技术的连接创建对象。但是，我不会说这是绝对规则。任何 OR-Mapping 层的编写都是为了使最复杂的情​​况更简单，可能以增加最简单情况的复杂性为代价。请记住，复杂性不是以大小为单位来衡量的，而是以复杂性为单位来衡量的。那里有各种不同的系统。有些预计会增长到几千行代码并永远留在那里。其他人旨在成为公司数据的中央门户，理论上可以不受限制地向任何方向增长。一些应用程序管理每次更新都会读取数百万次的数据。其他人管理仅为审计和临时目的而读取的数据。一般来说，规则是：

*   规范化在中型或更大的应用程序中几乎总是一个好主意，当拆分两侧的数据都可以修改并且潜在的修改彼此独立时。

*   从单个表中更新或选择通常比使用多个表更简单，但是通过编写良好的 OR，可以将大部分数据模型空间的这种差异最小化。使用直接 SQL，这对于单个用例来说几乎是微不足道的，尽管它是以非面向对象的方式。

*   为了便于管理，代码需要保持相对较小，一种有效的方法是划分数据模型并围绕数据模型的各个部分构建面向服务的架构。应在整体复杂性管理策略的范式中考虑数据（去）规范化的最佳状态的目标。

在复杂的对象层次结构中，有一些您在数据库端看不到的复杂性，例如更新的级联。如果您使用对象所有权关系对关系外键和交叉链接进行建模，那么在更新对象时，您必须决定是否级联更新。这可能比在 sql 中更复杂，因为做某事一次和总是正确地做某事之间的区别，有点像加载数据文件和为该类型的文件编写解析器之间的区别。在 C++、java 或任何需要为各种不同场景正确做出决定的代码中级联更新或删除的代码，并且此逻辑中的错误后果可能非常严重。

还有一点值得用规范化规则之一来描述。数据库规范化的一个核心论点是数据重复总是不好的想法。这通常是正确的，但不能盲目地遵循，尤其是当解决方案的不同部分有不同的所有者时。我曾经看到一种情况，一组开发人员管理某种类型的事务，另一组开发人员支持这些事务的可审计性，因此第二组开发人员编写了一个服务，该服务在事务发生时刮掉几个表并创建一个非规范化的快照记录实际上说明了交易时系统的状态。这个场景是一个有趣的用例（至少对于问题的数据重复部分），但它实际上是更大类别问题的一部分。数据一致性要求通常会对数据库中的数据结构施加某些限制，通过使某些不正确的情况变得不可能，从而使错误处理和故障排除变得更简单。但是，这也会产生“冻结”部分数据的影响，因为更改该数据子集会导致过去的事务在一致性规则下变得无效。显然需要某种版本控制系统来解决这个问题，所以显而易见的问题是是使用规范化版本控制系统（有效和到期时间）还是基于快照的方法（交易时间的价值）。标准化版本有几个内部结构问题，您不必担心快照方法，例如：

*   即使对于大型表，日期范围查询也能有效完成吗？
*   是否可以保证日期范围不重叠？
*   是否可以将状态事件追溯到操作员、事务或更改原因？（可能是的，但这是额外的开销）
*   通过创建更复杂的版本控制系统，您是否让正确的所有者负责正确的数据？

我认为这里的最佳目标是不仅要了解理论上什么是正确的，还要了解为什么是正确的，以及违规的后果是什么，然后当您在现实世界中时，您可以决定哪些后果值得承担还有哪些其他好处。这才是设计的真正挑战。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-08-12T11:40:24.697

报告系统和交易系统有不同的要求。

我会推荐交易系统，总是使用规范化来保证数据的正确性。

对于报告系统，使用规范化，除非出于某种原因需要非规范化，例如便于即席查询、性能等。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-11-16T03:36:47.780

简单？不确定 Steven 是否会用他的报纸打我，但是在我挂的地方，有时非规范化的表可以帮助报告/只读人员完成他们的工作，而不会一直窃听数据库/开发人员......

# python - Python对象删除自身

> ID：293431
> 
> 赞同：84
> 
> 时间：2008-11-16T03:29:59.633
> 
> 标签：python, memory-management, instance

为什么这行不通？我正在尝试使类的实例自行删除。

```
>>> class A():
    def kill(self):
        del self

>>> a = A()
>>> a.kill()
>>> a
<__main__.A instance at 0x01F23170> 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-11-16T03:41:12.777

'self' 只是对对象的引用。'del self' 正在从 kill 函数的本地命名空间中删除 'self' 引用，而不是实际的对象。

要亲自了解这一点，请查看执行这两​​个函数时会发生什么：

```
>>> class A():
...     def kill_a(self):
...         print self
...         del self
...     def kill_b(self):
...         del self
...         print self
... 
>>> a = A()
>>> b = A()
>>> a.kill_a()
<__main__.A instance at 0xb771250c>
>>> b.kill_b()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 7, in kill_b
UnboundLocalError: local variable 'self' referenced before assignment 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-16T03:46:09.163

您不需要首先使用 del 删除实例。一旦对对象的最后一个引用消失，该对象将被垃圾回收。也许你应该告诉我们更多关于完整问题的信息。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2016-08-13T11:55:25.913

我想我终于明白了！
**注意：您不应该在普通代码中使用**它，但它是*可能的*。这只是出于好奇，请参阅其他答案以了解此问题的实际解决方案。

* * *

看看这段代码：

```
# NOTE: This is Python 3 code, it should work with python 2, but I haven't tested it.
import weakref

class InsaneClass(object):
    _alive = []
    def __new__(cls):
        self = super().__new__(cls)
        InsaneClass._alive.append(self)

        return weakref.proxy(self)

    def commit_suicide(self):
        self._alive.remove(self)

instance = InsaneClass()
instance.commit_suicide()
print(instance)

# Raises Error: ReferenceError: weakly-referenced object no longer exists 
```

在`__new__`方法中创建对象时，实例被弱引用代理替换，唯一的强引用保存在 _alive 类属性中。

### 什么是弱引用？

弱引用是垃圾收集器收集对象时不计为引用的引用。考虑这个例子：

```
>>> class Test(): pass

>>> a = Test()
>>> b = Test()

>>> c = a
>>> d = weakref.proxy(b)
>>> d
<weakproxy at 0x10671ae58 to Test at 0x10670f4e0> 
# The weak reference points to the Test() object

>>> del a
>>> c
<__main__.Test object at 0x10670f390> # c still exists

>>> del b
>>> d
<weakproxy at 0x10671ab38 to NoneType at 0x1002050d0> 
# d is now only a weak-reference to None. The Test() instance was garbage-collected 
```

所以对实例的唯一强引用存储在 _alive 类属性中。当 commit_suicide() 方法删除引用时，实例被垃圾收集。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-16T14:26:51.353

在这种特定情况下，您的示例没有多大意义。

当一个存有捡起一个物品时，该物品保留了一个单独的存在。它不会因为被捡起而消失。它仍然存在，但它 (a) 与存在在同一位置，并且 (b) 不再有资格被拾取。虽然它的状态发生了变化，但它仍然存在。

存在和项目之间存在双向关联。The Being 在一个集合中拥有该项目。该项目与一个存在相关联。

当一个物品被一个存在捡起时，必须发生两件事。

*   存在如何在某些项目中添加`set`项目。`bag`例如，您的属性可能是这样的`set`. [A`list`是一个糟糕的选择——订单在袋子里重要吗？]

*   物品的位置从它以前的位置变为存在的位置。可能有两类 os 项目 - 具有独立位置感的项目（因为它们自己移动）和必须将位置委托给他们所在的存在或地方的项目。

在任何情况下都不需要删除任何 Python 对象。如果一个项目被“摧毁”，那么它就不是在一个存在的包里。它不在一个位置。

```
player.bag.remove(cat) 
```

只需要让猫从袋子里出来。由于 cat 没有在其他任何地方使用，它既作为“已用”内存存在，又不存在，因为您的程序中没有任何东西可以访问它。当一些量子事件发生并且内存引用被垃圾收集时，它会悄悄地从内存中消失。

另一方面，

```
here.add( cat )
player.bag.remove(cat) 
```

将猫放在当前位置。猫继续存在，不会和垃圾一起被淘汰。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-28T05:41:34.537

实际上，您不需要删除对象来执行您正在尝试执行的操作。相反，您可以更改对象的状态。一个不进入编码的情况下如何工作的例子是你的玩家与怪物战斗并杀死怪物。这个怪物的状态是战斗。怪物将访问战斗所需的所有方法。当怪物因为生命值降到0而死亡时，怪物状态会变为死亡，你的角色会自动停止攻击。这种方法与使用标志甚至关键字非常相似。

同样显然在 python 中删除类是不需要的，因为当它们不再使用时它们将被自动收集。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-08T10:58:14.260

I am trying the same thing. I have a RPG battle system in which my Death(self) function has to kill the own object of the Fighter class. But it appeared it`s not possible. Maybe my class Game in which I collect all participants in the combat should delete units form the "fictional" map???

```
 def Death(self):
    if self.stats["HP"] <= 0:
        print("%s wounds were too much... Dead!"%(self.player["Name"]))
        del self
    else:
        return True

def Damage(self, enemy):
    todamage = self.stats["ATK"] + randint(1,6)
    todamage -= enemy.stats["DEF"]
    if todamage >=0:
        enemy.stats["HP"] -= todamage
        print("%s took %d damage from your attack!"%(enemy.player["Name"], todamage))
        enemy.Death()
        return True
    else:
        print("Ineffective...")
        return True
def Attack(self, enemy):
    tohit = self.stats["DEX"] + randint(1,6)
    if tohit > enemy.stats["EVA"]:
        print("You landed a successful attack on %s "%(enemy.player["Name"]))
        self.Damage(enemy)
        return True
    else:
        print("Miss!")
        return True
def Action(self, enemylist):
    for i in range(0, len(enemylist)):
        print("No.%d, %r"%(i, enemylist[i]))
    print("It`s your turn, %s. Take action!"%(self.player["Name"]))
    choice = input("\n(A)ttack\n(D)efend\n(S)kill\n(I)tem\n(H)elp\n>")
    if choice == 'a'or choice == 'A':
        who = int(input("Who? "))
        self.Attack(enemylist[who])
        return True
    else:
        return self.Action() 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-08-08T17:33:22.300

我无法告诉您如何使用类来实现这一点，但函数可以自行删除。

```
def kill_self(exit_msg = 'killed'):
    global kill_self
    del kill_self
    return exit_msg 
```

并查看输出：

```
 >>> kill_self
<function kill_self at 0x02A2C780>
>>> kill_self()
'killed'
>>> kill_self
Traceback (most recent call last):
  File "<pyshell#28>", line 1, in <module>
    kill_self
NameError: name 'kill_self' is not defined 
```

我认为在不知道类名的情况下删除类的单个实例是不可能的。

**注意：** 如果您为函数分配另一个名称，则另一个名称仍将引用旧名称，但一旦您尝试运行它就会导致错误：

```
>>> x = kill_self
>>> kill_self()
>>> kill_self
NameError: name 'kill_self' is not defined
>>> x
<function kill_self at 0x...>
>>> x()
NameError: global name 'kill_self' is not defined 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-16T03:59:10.463

事实上，Python 通过引用计数来进行垃圾收集。一旦对对象的最后一个引用超出范围，它就会被删除。在您的示例中：

```
a = A()
a.kill() 
```

我不相信变量“a”有任何方法可以将自己隐式设置为无。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-01T11:27:57.583

如果您使用对对象的单个引用，则对象可以通过重置对自身的外部引用来杀死自己，如下所示：

```
class Zero:
    pOne = None

class One:

    pTwo = None   

    def process(self):
        self.pTwo = Two()
        self.pTwo.dothing()
        self.pTwo.kill()

        # now this fails:
        self.pTwo.dothing()

class Two:

    def dothing(self):
        print "two says: doing something"

    def kill(self):
        Zero.pOne.pTwo = None

def main():
    Zero.pOne = One() # just a global
    Zero.pOne.process()

if __name__=="__main__":
    main() 
```

您当然可以通过从对象外部（而不是对象状态）检查对象是否存在来进行逻辑控制，例如：

```
if object_exists:
   use_existing_obj()
else: 
   obj = Obj() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-11-18T00:08:52.497

这是我过去做过的事情。创建一个对象列表，然后您可以使用该`list.remove()`方法让对象自行删除。

```
bullet_list = []

class Bullet:
    def kill_self(self):
        bullet_list.remove(self)

bullet_list += [Bullet()] 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-16T04:19:45.307

我很好奇你为什么要做这样的事情。很有可能，你应该让垃圾收集来完成它的工作。在 python 中，垃圾收集是相当确定的。因此，您不必像在其他语言中那样担心将对象留在内存中（并不是说引用计数没有缺点）。

尽管您应该考虑的一件事是包装您以后可能会摆脱的任何对象或资源。

```
class foo(object):
    def __init__(self):
        self.some_big_object = some_resource

    def killBigObject(self):
        del some_big_object 
```

回应[Null 的附录](https://stackoverflow.com/questions/293431/python-object-deleting-itself#293497)：

不幸的是，我不相信有一种方法可以按照您想做的方式做您想做的事情。这是您可能希望考虑的一种方法：

```
>>> class manager(object):
...     def __init__(self):
...             self.lookup = {}
...     def addItem(self, name, item):
...             self.lookup[name] = item
...             item.setLookup(self.lookup)
>>> class Item(object):
...     def __init__(self, name):
...             self.name = name
...     def setLookup(self, lookup):
...             self.lookup = lookup
...     def deleteSelf(self):
...             del self.lookup[self.name]
>>> man = manager()
>>> item = Item("foo")
>>> man.addItem("foo", item)
>>> man.lookup
 {'foo': <__main__.Item object at 0x81b50>}
>>> item.deleteSelf()
>>> man.lookup
 {} 
```

这有点混乱，但这应该给你的想法。从本质上讲，我不认为将游戏中某个项目的存在与它是否在内存中分配联系起来是一个好主意。这是因为物品被垃圾回收的条件可能与游戏中物品的条件不同。这样，您就不必为此担心太多。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-25T11:36:00.023

你能做的就是在课堂上带上你的名字并制作字典：

```
class A:
  def __init__(self, name):
    self.name=name
  def kill(self)
    del dict[self.name]

dict={}
dict["a"]=A("a")
dict["a"].kill() 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-29T19:52:19.527

```
class A:
  def __init__(self, function):
    self.function = function
  def kill(self):
    self.function(self)

def delete(object):                        #We are no longer in A object
  del object

a = A(delete)
print(a)
a.kill()
print(a) 
```

这段代码可以工作吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-28T11:35:21.877

替换工具：

```
class A:

    def __init__(self):
        self.a = 123

    def kill(self):
        from itertools import chain
        for attr_name in chain(dir(self.__class__), dir(self)):
            if attr_name.startswith('__'):
                continue
            attr = getattr(self, attr_name)
            if callable(attr):
                setattr(self, attr_name, lambda *args, **kwargs: print('NoneType'))
            else:
                setattr(self, attr_name, None)
        a.__str__ = lambda: ''
        a.__repr__ = lambda: '' 
```

```
a = A()
print(a.a)
a.kill()

print(a.a)
a.kill()

a = A()
print(a.a) 
```

将输出：

```
123
None
NoneType
123 
```

# c - 带空格的左pad printf

> ID：293438
> 
> 赞同：137
> 
> 时间：2008-11-16T03:32:31.640
> 
> 标签：c, formatting, printf

使用 printf 时，如何在左侧填充带有空格的字符串？

例如，我想打印前面有 40 个空格的“Hello”。

此外，我要打印的字符串由多行组成。我需要单独打印每一行吗？

编辑：为了清楚起见，我希望在每行之前打印 40 个空格。

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-11-16T03:42:40.810

如果您希望在 40 个字符宽的列中打印单词“Hello”，并在左侧填充空格，请使用以下命令。

```
char *ptr = "Hello";
printf("%40s\n", ptr); 
```

这会给你 35 个空格，然后是“你好”这个词。当您知道想要列的宽度时，这就是您格式化内容的方式，但是数据会发生变化（嗯，这是您可以做到的*一种*方式）。

如果你知道你想要 40 个空格然后是一些文本，只需将 40 个空格保存在一个常量中并打印它们。如果您需要打印多行，可以使用多个`printf`语句，如上面的语句，或者循环执行，更改`ptr`每次的值。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2012-02-25T21:09:58.673

我使用这个函数来缩进我的输出（例如打印一个树结构）。是字符串前的`indent`空格数。

```
void print_with_indent(int indent, char * string)
{
    printf("%*s%s", indent, "", string);
} 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2014-03-28T14:40:35.017

```
int space = 40;
printf("%*s", space, "Hello"); 
```

该语句将保留一行 40 个字符，在行尾打印字符串（删除多余的空格，使总行长恒定为 40）。同样可用于字符和整数，如下所示：

```
printf("%*d", space, 10);
printf("%*c", space, 'x'); 
```

这种使用参数来确定空格的方法在需要可变数量的空格时很有用。这些语句仍然适用于整数文字，如下所示：

```
printf("%*d", 10, 10);
printf("%*c", 20, 'x');
printf("%*s", 30, "Hello"); 
```

希望这对将来像我这样的人有所帮助。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-11-16T04:13:10.280

如果你想在字符串前正好有 40 个空格，那么你应该这样做：

```
printf("                                        %s\n", myStr ); 
```

如果这太脏了，你可以这样做（但它会比手动输入 40 个空格要慢）： `printf("%40s%s", "", myStr );`

如果您希望字符串在第 40 列排成一行（也就是说，在它前面最多有 39 个空格，以便最右边的字符在第 40 列中），请执行以下操作： `printf("%40s", myStr);`

您还可以通过执行以下操作在字符串之后放置“最多”40 个空格： `printf("%-40s", myStr);`

# python - Python 帮助 - 解析数据包日志

> ID：293444
> 
> 赞同：4
> 
> 时间：2008-11-16T03:39:45.683
> 
> 标签：python, parsing

我正在编写一个简单的程序，它将把来自wireshark 的数据包转储的日志文件解析为更易读的形式。我正在用python做这个。

目前我被困在这部分：

```
for i in range(len(linelist)):
if '### SERVER' in linelist[i]:
    #do server parsing stuff

    packet = linelist[i:find("\n\n", i, len(linelist))] 
```

linelist 是使用 readlines() 方法创建的列表，因此文件中的每一行都是列表中的一个元素。我正在遍历它以查找所有出现的“### SERVER”，然后抓取它之后的所有行，直到下一个空行（这表示数据包的结束）。我一定是做错了什么，因为不仅 find() 不起作用，而且我觉得有更好的方法来获取 ### SERVER 和下一次出现的空白行之间的所有内容。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T06:24:05.023

查看[file.readlines()](http://docs.python.org/library/stdtypes.html#file.readlines)文档：

> file.readlines([sizehint])
> 
> 使用 readline() 读取直到 EOF 并返回包含如此读取的行的列表。如果存在可选的 sizehint 参数，而不是读取到 EOF，而是读取总计大约 sizehint 字节的整行（可能在四舍五入到内部缓冲区大小之后）。如果 sizehint 无法实现或无法有效实现，则实现类文件接口的对象可能会选择忽略它。

和[file.readline()](http://docs.python.org/library/stdtypes.html#file.readline)文档：

> file.readline([大小])
> 
> 从文件中读取一整行。结尾的换行符保留在字符串中（但当文件以不完整的行结尾时可能不存在）。[6] 如果 size 参数存在且非负数，则它是最大字节数（包括尾随换行符），并且可能会返回不完整的行。仅当立即遇到 EOF 时才返回空字符串。

`A trailing newline character is kept in the string`- 表示其中的每一行`linelist`最多包含**一个**换行符。这就是为什么您无法`"\n\n"`在任何行中找到子字符串的原因 - 查找**整个空行**（或 EOF 处的空行）：

```
if myline in ("\n", ""):
    handle_empty_line() 
```

注意：我试图解释`find`行为，但 pythonic 解决方案看起来与您的代码片段非常不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T08:31:57.170

总体思路是：

```
inpacket = False
packets = []
for line in open("logfile"):
  if inpacket:
    content += line
    if line in ("\n", ""): # empty line
      inpacket = False
      packets.append(content)
  elif '### SERVER' in line:
    inpacket = True
    content = line
# put here packets.append on eof if needed 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T12:37:24.957

这也适用于显式迭代器。这样，嵌套循环可以通过使用行来更新迭代器的状态。

```
fileIter= iter(theFile)
for x in fileIter:
    if "### SERVER" in x:
        block = [x]
        for y in fileIter:
            if len(y.strip()) == 0: # empty line
                break
            block.append(y)
        print block # Or whatever
    # elif some other pattern: 
```

这具有查找位于文件尾端的块的令人愉快的特性，并且没有终止它们的空行。

此外，这很容易概括，因为没有明确的状态变化变量，您只需进入另一个循环以吸收其他类型块中的行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T12:37:26.767

最好的方法 - 使用生成器阅读[系统程序员的演示文稿生成器技巧](http://www.dabeaz.com/generators/) 这是我看到的关于解析日志的最佳方法；）

# .net - 将 MAME 或 SCUMMVM 移植到 .NET（XNA 或 Silverlight）的最佳方法是什么？

> ID：293477
> 
> 赞同：1
> 
> 时间：2008-11-16T04:10:02.360
> 
> 标签：.net, xna, emulation

我想知道移植这些仿真器引擎的主要挑战是什么。

无需重写所有代码就可以成功吗？任何可用的转换工具可以提供帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T19:37:30.913

有些人尝试过，但似乎他们[放弃了](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1011253&SiteID=1)：

[人渣](http://sourceforge.net/projects/scummvmxna/)

其他路线可能是[Cibyl](http://spel.bth.se/index.php/Cibyl)采取的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-18T00:53:04.483

XDA 开发人员中有一些人正在为 C#.Net/XNA/Silverlight 制作 DLL 包装器... DllImport 项目： http: [//forum.xda-developers.com/showthread.php ?t=1006331](http://forum.xda-developers.com/showthread.php?t=1006331)

据我了解，这是用于包装 DLL 以在 Windows Phone 7 系统上使用它们

但我不知道是否可以将它用于 ScummVM。好像你不能做 p/invoke。据我了解，ScummVM 严重依赖于 p/invoke。 [http://forums.scummvm.org/viewtopic.php?t=9350&sid=d324c805f27e3c62713f02db3763c021](http://forums.scummvm.org/viewtopic.php?t=9350&sid=d324c805f27e3c62713f02db3763c021)

注意：我根本没有读过这么多...我发现了。我可能误解了我正在阅读的一些内容。因此，如果您有兴趣尝试将 ScummVM 库移植或包装到 C#.Net/XNA/Silverlight 代码中，请亲自检查一下。

天哪，我累了……我现在真的应该去睡觉了……

# python - 如何修复错误嵌套/未闭合的 HTML 标签？

> ID：293482
> 
> 赞同：21
> 
> 时间：2008-11-16T04:14:57.640
> 
> 标签：python, html, algorithm, xhtml

我需要通过以正确的嵌套顺序关闭任何打开的标签来清理用户提交的 HTML。我一直在寻找一种算法或 Python 代码来执行此操作，但除了 PHP 中的一些半生不熟的实现等外，没有找到任何东西。

例如，像

```
<p>
  <ul>
    <li>Foo 
```

变成

```
<p>
  <ul>
    <li>Foo</li>
  </ul>
</p> 
```

任何帮助，将不胜感激 ：）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-16T06:05:25.297

使用 BeautifulSoup：

```
from BeautifulSoup import BeautifulSoup
html = "<p><ul><li>Foo"
soup = BeautifulSoup(html)
print soup.prettify() 
```

得到你

```
<p>
 <ul>
  <li>
   Foo
  </li>
 </ul>
</p> 
```

据我所知，您无法控制将 <li></li> 标记放在与 Foo 不同的行上。

使用整洁：

```
import tidy
html = "<p><ul><li>Foo"
print tidy.parseString(html, show_body_only=True) 
```

得到你

```
<ul>
<li>Foo</li>
</ul> 
```

不幸的是，我不知道如何在示例中保留 <p> 标记。Tidy 将其解释为一个空段落而不是一个未闭合的段落，所以这样做

```
print tidy.parseString(html, show_body_only=True, drop_empty_paras=False) 
```

出来作为

```
<p></p>
<ul>
<li>Foo</li>
</ul> 
```

当然，最终，示例中的 <p> 标记是多余的，因此丢失它可能会很好。

最后，Tidy 还可以进行缩进：

```
print tidy.parseString(html, show_body_only=True, indent=True) 
```

变成

```
<ul>
  <li>Foo
  </li>
</ul> 
```

所有这些都有其起伏，但希望其中一个足够接近。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-16T04:17:52.173

通过[Tidy](http://tidy.sourceforge.net/)或其移植的[库](http://utidylib.berlios.de/)之一运行它。

尝试手动编码，你*会*想挖出你的眼睛。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-08-23T07:08:12.593

使用 html5lib，效果很好！像这样。

汤= BeautifulSoup（数据，'html5lib'）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-17T09:38:25.117

刚才，我得到了一个 lxml 和 pyquery 不能正常工作的 html，似乎 html 中有一些错误。由于 Tidy 在 windows 中不容易安装，所以我选择`BeautifulSoup`. 但我发现：

```
from BeautifulSoup import BeautifulSoup
import lxml.html
soup = BeautifulSoup(page)
h = lxml.html(soup.prettify()) 
```

行为相同`h = lxml.html(page)`

真正解决我的问题的是`soup = BeautifulSoup(page, 'html5lib')`。
您应该`html5lib`先安装，然后可以将其用作`BeautifulSoup`. `html5lib`解析器似乎比其他人好得多。

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-12T15:19:12.560

我尝试使用以下方法，但在**python 3上****失败**

 **```
from BeautifulSoup import BeautifulSoup
soup = BeautifulSoup(page, 'html5lib') 
```

我在下面尝试并获得了**成功**

```
soup = bs4.BeautifulSoup(html, 'html5lib')
f_html = soup.prettify()
print(f'Formatted html::: {f_html}') 
```

# asp.net - Asp.net ajax 更新面板共享数据库连接

> ID：293495
> 
> 赞同：0
> 
> 时间：2008-11-16T04:29:21.963
> 
> 标签：asp.net, database, ajax

我在更新面板中有一个下拉框和一个文字标签。在下拉列表的选择更改事件上重新查询数据库并重新填充文字标记，然后调用 UPdatePanel.Update()。

下面，有没有办法可以避免每次都创建一个新的 Oledbconnection，因为这看起来很慢。我可以重复使用和存储：

1.  数据源
2.  页面中的连接。

如果是这样，我如何在从 GUI 到服务器的调用之间保持这种状态？下面是我的选择更改代码

```
protected void cboPeople_SelectedIndexChanged(object sender, EventArgs e)
{
    string dataSource = ConfigurationSettings.AppSettings["contactsDB"];
    var objConn = new OleDbConnection(dataSource);
    string id = People[cboPeople.Text];
    UpdateLiteral(objConn, id);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T06:38:42.780

使用 .NET 让您的连接保持比需要更长的时间并不是一个好主意。好的做法是在它周围放置一个 using 语句（因此它总是被清理）：

```
string dataSource = ConfigurationSettings.AppSettings["contactsDB"];
using(var objConn = new OleDbConnection(dataSource))
{
    string id = People[cboPeople.Text];
    UpdateLiteral(objConn, id);
} 
```

.NET 使用[连接池](http://www.ondotnet.com/pub/a/dotnet/2004/02/09/connpool.html)，这意味着当您关闭/处置连接时，它实际上并没有关闭连接，而是重置它并将其添加回池中。下次需要连接时，它会从池中使用。所以开销并没有你想象的那么多，而且速度也不慢。实际上，您会发现只要一次只需要一个连接，它就会使用相同的连接。

保持连接打开的危险在于它们永远不会关闭，并且在高需求情况下您会用完连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T04:42:33.230

您需要为每个请求重新创建它。你有一个无状态的服务器。您永远不知道您的客户何时或是否会回电。您不想保持与数据库的开放连接，也不能简单地为多个客户端提供服务，同时保持一个数据库连接。

> 要部署高性能应用程序，您必须使用连接池。当您为 OLE DB 使用 .NET Framework 数据提供程序时，您不必启用连接池，因为提供程序会自动管理它。有关如何将连接池与用于 OLE DB 的 .NET Framework 数据提供程序一起使用的详细信息，请参阅 OLE DB、ODBC 和 Oracle 连接池 (ADO.NET)。从[OleDbConnection 类](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.aspx)

# c++ - 如果在 C++ 中不返回值会发生什么？

> ID：293499
> 
> 赞同：14
> 
> 时间：2008-11-16T04:35:06.367
> 
> 标签：c++, g++, return-value

昨天，我发现自己在写这样的代码：

```
SomeStruct getSomeStruct()
{
    SomeStruct input;

    cin >> input.x;
    cin >> input.y;
} 
```

当然忘记实际返回我刚刚创建的结构。奇怪的是，这个函数返回的结构中的值*被*初始化为零（当使用 g++ 编译时）。这只是一个巧合还是另一个 SomeStruct 被隐式地创建和初始化？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-16T04:53:26.500

从声明为返回值（没有显式返回值）的函数的末尾脱落会导致未定义的后果。对于 gcc，您应该从`-Wall`打开最有用警告的命令行开关开始。控制您想要的警告的特定 gcc 警告是`-Wreturn-type`（包含在 中`-Wall`，为了完整起见，我只是提到这一点）。

打开警告后，您还应该使用`-Werror`将警告视为错误，并在检测到错误时停止构建。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-16T05:34:13.143

大多数现代 CPU 架构的调用约定指定一个特定的寄存器来将函数返回值传回给调用者。调用者进行函数调用，然后使用指定的寄存器作为返回值。如果你没有显式地返回一个值，调用者仍然会使用该寄存器中发生的任何垃圾。

编译器还将使用它可用于函数内部计算的所有寄存器。指定用于保存返回值的寄存器也将用于函数内的杂项计算。因此，当您忘记指定返回值时，通常会奇迹般地将正确的值返回给调用者：编译器使用该寄存器来存储您的对象。

不幸的是，即使是对函数的微小更改也可能导致寄存器分配发生变化，因此返回值变成了真正的垃圾。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-16T06:15:19.957

> 是否隐式地在某处创建并初始化了另一个 SomeStruct？

想想结构是如何返回的。如果`x`和`y`都是 32 位，则它太大而无法放入 32 位架构上的寄存器中，同样适用于 64 位架构上的 64 位值（@Denton Gentry 的回答提到了如何返回更简单的值） ，所以它必须分配到某个地方。为此使用堆会很浪费，因此必须在堆栈上分配它。但它不能在函数的堆栈帧上`getSomeStruct`，因为在函数返回后它不再有效。

相反，编译器通过向被调用函数传递一个指向分配给它的空间的隐藏指针，让调用者告诉被调用函数将结果放在哪里（可能在调用者的堆栈上的某个位置）。因此，将其设置为零的位置在*caller*上，而不是在您的`getSomeStruct`函数上。

还有一些优化，比如“命名值返回优化”，可以省略额外的副本。所以，如果你使用了 missing `return`，结果将直接在调用者分配的空间上创建，而不是创建一个临时的并复制它。

要了解更多关于正在发生的事情，您必须查看调用者函数。它是否正在初始化（为零）一个“空” `SomeStruct`，您稍后将`getSomeStruct`函数的返回值分配给该“空”？还是它在做其他事情？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-16T18:15:17.710

我觉得这很有趣。使用默认选项时，以下编译器在编译`GetSomeStruct()`函数时具有以下行为：

*   Microsoft VC，所有版本（从 VC6 开始）：

    **`error C4716: 'getSomeStruct' : must return a value`**

*   数字火星：

    **`Warning 18: implied return of getSomeStruct at closing '}' does not return value`**

*   科莫：

    **`warning: missing return statement at end of non-void function "getSomeStruct"`**

*   海湾合作委员会：

    **没有错误或警告**

鉴于标准中的以下几句话（6.6.3 第 2 段）：

> 没有表达式的 return 语句只能用于不返回值的函数，即返回类型为 void 的函数、构造函数 (12.1) 或析构函数 (12.4)。...从函数的末尾流出相当于没有值的返回；这会导致值返回函数中的未定义行为。

我想说编译器在这种情况下没有理由不给出错误。为什么这么多编译器只给出警告或根本不给出诊断？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-16T04:38:41.367

对我来说，编译器不允许它：[http ://codepad.org/KkzVCesh](http://codepad.org/KkzVCesh)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-16T09:58:00.100

你没有收到任何警告，因为你没有`-Wall -Werror`打开。（如其他答案所述）

但是我认为您可能得到了一个零填充的结构，因为堆栈对象是在调用者函数中默认构造的，可能带有显式零参数，或者由于堆栈上的零？

# ruby - 如何部署基于 RubyGem 的服务器

> ID：293500
> 
> 赞同：1
> 
> 时间：2008-11-16T04:35:40.407
> 
> 标签：ruby, deployment, rubygems

我们在 ruby​​ 中构建了一个自定义套接字服务器并将其打包为 gem。由于这是一个内部项目，我们不能简单地将其发布到 RubyForge 或 GitHub。我尝试设置我们自己的 gem 服务器，但 gem 不会通过 https 进行身份验证。我们的其他部署都是针对使用 capistrano 和 svn 进行部署的标准 Rails 应用程序。

我们当前的设置是使用带有 capistrano 的类似 rails 的部署。它执行以下操作：

*   查看来自 svn 的代码
*   构建宝石
*   安装宝石
*   重启服务器

这看起来很尴尬，并且使 gem 打包看起来像是额外的工作——但在部署问题之外，它非常适合作为 gem。

有更清洁的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T08:06:44.350

您可以从本地文件系统安装 gem。

```
gem install /path/to/some.gem 
```

用它编写 scp 脚本或使用 NFS 挂载等对您来说应该不会太难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T12:50:56.240

开始

```
gem server #That will serve all your local installed gems.

gem install YourLocalPkg1.X.X.gem 
```

#在你的主机上

采用

```
gem sources --add localhost:8808
gem install YourGem 
```

在客户端机器上开发一些东西

```
rake gem
gem install YourLocalPkg2.X.X.gem #on YourHost 
```

采用

```
gem update YourGem #on client machine 
```

也许您需要使用 https，但我在您的帖子中不明白为什么。在某些机器上

```
* Check out the code from svn #the railspart not in the gem
* gem update  YourGem #  or install if not exist....
* Restart the server 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T05:01:06.017

gem install --local path_to_gem/filename.gem 会有所帮助。或者，您可以在您的 Web 服务器上获得受信任的证书。

您可能可以使用 gem install -P NoSecurity 或 -P LowSecurity 从服务器安装，但我没有尝试过。

[http://www.rubygems.org/read/chapter/21](http://www.rubygems.org/read/chapter/21)

# javascript - Javascript；将用户发送到另一个页面

> ID：293506
> 
> 赞同：16
> 
> 时间：2008-11-16T04:40:58.913
> 
> 标签：javascript, transfer

我正在尝试使用 Javascript 函数将用户发送到另一个页面：

```
<input type="button" name="confirm" value="nextpage" onClick="message()"> 
```

还有我的 JavaScript：

```
function message() {
    ConfirmStatus = confirm("Install a Virus?");

    if (ConfirmStatus == true) {
        //Send user to another page
    }
} 
```

有谁知道如何将用户发送到另一个特定页面？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-16T04:44:29.280

你的代码搞砸了，但如果我做对了，你可以使用以下内容：

```
location.href = 'http://www.google.com';
or
location.href = 'myrelativepage.php'; 
```

祝你好运！

但我必须对你说，

1.  Javascript 可以关闭，因此您的功能将无法工作。

其他选择是通过代码执行此操作：

PHP： `header('Location: index.php');`

C＃： `Response.Redirect("yourpage.aspx");`

爪哇： `response.sendRedirect("[http://www.google.com](http://www.google.com)");`

笔记：

1.  所有这些重定向都必须放在向客户端的任何输出之前好吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-16T04:42:57.457

我相信`window.location.href = "newpage.html";`会奏效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T08:22:09.823

您还可以使用元刷新标签进行重定向。

```
<meta http-equiv="refresh" content="2;url=http://other-domain.com"> 
```

`http://other-domain.com`两秒钟后将重定向到该站点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-12-27T23:38:00.077

尝试这个！

```
window.location.replace("http://www.link.com"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-19T17:19:31.760

试试这个： `window.location.href = "YOUR_RELATIVE_PATH_HERE"`例如 ./pages/aboutus"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-15T15:51:48.717

window.location.href = 网址；

可以使用 javascript 重定向到所需的 url。

可以在[此 url中找到简单的示例](http://ramsharanshrestha.blogspot.com/2013/04/window.html)

# sql - 如何在互联网上找到值得信赖的数据库帮助？

> ID：293511
> 
> 赞同：1
> 
> 时间：2008-11-16T04:43:36.660
> 
> 标签：sql, database

我正在尝试帮助一家拥有可以从偶尔（或临时）数据库专业知识中受益的应用程序的小型企业。问题是，这家公司的所有 IP 都在这个数据库中，所以他们理所当然地不愿让某人访问它。

他们通常会亲自见面并获得信任，但在物理上接近他们的人才库非常有限。我想他们仍然可以以某种方式利用全球 DBA 专业知识......

即使是最蹩脚的 DBA 也能在这些人周围跳 SQL 圈——所以只公开数据库的一部分对我来说听起来不可行，但我希望我只是不知道怎么做。

有人对如何找到值得信赖的公司（或个人）有任何建议吗？当我聘请程序员时，我会从基本的东西开始，如果他们搞砸了也不会造成太大的伤害。有了数据库，我可以从哪些东西开始限制他们的曝光。也许 Profiler 输出用于分析之类的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T04:54:49.073

最简单的事情是要求所有看到数据库或其设计的员工和承包商签署保密协议。那里有很多样板文件，一位优秀的律师可以在不到一小时的计费时间的情况下为您提供所需的指导。业内每个人都习惯了，每个人都明白为什么要签。

当然，这不是一个编程问题，这只是一个法律问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T07:40:09.333

正如其他人所提到的，保密协议是一个好主意，从他们所看到的角度来涵盖你......

但是，我可以感觉到您也担心如果他们犯了错误，他们可能会对您的数据库造成任何潜在的“损害”。绕过并保护它有点困难，但我会推荐一些好的关键项目。

1.  在开始之前备份所有内容，这是常识，但不能夸大其词
2.  如果您能够复制生产问题，请为顾问提供测试环境。这提供了一个可以进行测试的隔离环境。
3.  不要限制他们的数据库访问。数据库问题需要深入系统，限制其访问，实际上可能导致错误而不是阻止错误。
4.  寻找参考资料或人员能力的证据。

我自己作为顾问提供这些信息。我从事 .NET 和 SQL Server 咨询，并确保在我的咨询案例中以上所有内容都是正确的，并且我没有遇到过错。史蒂文指出这一切中最大的关键，那就是**顾问所拥有的一切就是他的声誉**。认真的顾问完全理解这一点，因此会确保他们不会让自己陷入棘手的境地。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T05:08:36.003

顾问一直在签署保密协议，优秀的人会认真对待，因为顾问的声誉就是*他的全部*

虽然不是 DBA，但我可以强烈推荐[这个人](http://www.nov8r.com/about.aspx)，因为我认识他一辈子 ;-)

# asp.net - Ajax 回调 UpdatePanel.Update() 仍在重新加载整个页面

> ID：293524
> 
> 赞同：2
> 
> 时间：2008-11-16T04:56:40.270
> 
> 标签：asp.net, database, ajax, updatepanel

我在更新面板中有代码，即使单击按钮我将数据插入数据库并简单地调用 Updatepanel.Update() 重新加载整个页面：

礼物.ASPX

```
<table style="width:100%;">
            <tr>
                <td>
                    <asp:Label ID="Label2" runat="server" Text="Gift"></asp:Label>
                </td>
                <td>
<asp:UpdatePanel ID="UpdatePanel3" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
                    <asp:TextBox ID="txtNewGift" runat="server"></asp:TextBox>
    </ContentTemplate>
</asp:UpdatePanel>
                </td>
            </tr>
            <tr> 
```

礼物.aspx.CS

```
protected void cmdAddGift_Click(object sender, EventArgs e)
{
    OleDbConnection objConn = new OleDbConnection(DataSource);

    Random r = new Random();
    int giftID = r.Next(1200, 14000);

    OleDbCommand objCommand = new OleDbCommand("Insert into Gifts (GiftID, Description) values (" + giftID + ",'" + txtNewGift.Text + "')", objConn);
    ExecuteCommand(objCommand);

    PopulateGifts(objConn);

    txtNewGift.Text = "";
    UpdatePanel3.Update();
} 
```

任何想法为什么整个页面会重新加载而不仅仅是文本框得到更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T06:47:23.010

上例中的按钮在哪里？在 UpdatePanel 内部或外部。如果它在外部，则需要将其添加到 UpdatePanel 的触发器集合中。

此外，如果您要更改 UpdatePanel 的内容而不是导致（部分）回发的内容，则只需调用 UpdatePanel.Update()。

作为旁注（和个人圣战），建议在您的数据库连接周围放置一条 using 语句。

使用下面的标记，将发生以下情况：

*   btnInnerPart 位于更新面板内，因此会自动导致部分回发
*   btnInnerFull 将导致完整的回发，因为它在触发器集合中有一个 PostBackTrigger
*   btnOuterPart 将导致部分回发，因为它在触发器集合中有 AsyncPostBackTrigger
*   btnOuterFull 将导致完整的回发，因为它在 UpdatePanel 之外

标记：

```
<asp:UpdatePanel runat="server">
    <ContentTemplate>
        <!-- Content -->
        <asp:Button runat="server" ID="btnInnerPart" Text="Inner Part" />
        <asp:Button runat="server" ID="btnInnerFull" Text="Inner Full" />
    </ContentTemplate>
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="btnOuterPart" />
        <asp:PostBackTrigger ControlID="btnInnerFull" />
    </Triggers>
</asp:UpdatePanel>
<asp:Button runat="server" ID="btnOuterFull" Text="Outer Full" />
<asp:Button runat="server" ID="btnOuterPart" Text="Outer Part" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T05:03:11.583

Gifts.ASPX 上的按钮在哪里？如果将按钮放在 UpdatePanel 内或使用触发器，则无需调用 UpdatePanel3.Update(); 从后面的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T05:06:17.910

此外，您需要在页面上有一个 ScriptManager 对象。你是否有一个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T06:19:25.883

请检查更新面板的标签...您必须指定更新面板的触发控件，更新面板将在其上进行更新

# php - JavaScript 的 confirm() PHP 版本

> ID：293541
> 
> 赞同：2
> 
> 时间：2008-11-16T05:26:07.840
> 
> 标签：php, javascript, confirm

是否有 PHP 版本的 JavaScript 的 confirm() 函数？
如果没有，我的其他选择是什么，或者我如何制作类似于 confirm() 的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-16T05:34:55.997

因为 PHP 是一种服务器端语言（所有 PHP 代码都在服务器上执行，并且代码的输出被发送到客户端），所以您必须制作一个带有 OK/Cancel 按钮的 HTML 表单，该表单将提交给你的 PHP 页面。像这样的东西：

确认.php：

```
<p>Are you sure you want to do this?</p>

<form action="page2.php" method="post">
    <input type="submit" name="ok" value="OK" />
    <input type="submit" name="cancel" value="Cancel" />
</form> 
```

page2.php：

```
<?php

if (isset($_POST['ok'])) {
    // They pressed OK
}

if (isset($_POST['cancel'])) {
    // They pressed Cancel
}

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T05:46:07.237

使用上一篇文章中的相同答案添加一些错误处理和安全性：

```
<form action="page2.php" method="post">
   Your choice: <input type="radio" name="choice" value="yes"> Yes <input type="radio" name="choice" value="no" /> No
    <button type="submit">Send</button>
</form> 
```

在你的 page2.php 中：

```
if (isset($_POST['choice']) /* Always check buddy */) {
    switch($_POST['choice']) {
        case 'yes':
            /// Code here
            break;
        case 'no':
            /// Code here
            break;
        default:
            /// Error treatment
            break;
    }
}
else {
    // error treatment
} 
```

# .net - 您可以在 Silverlight 中即时编译代码吗？

> ID：293545
> 
> 赞同：6
> 
> 时间：2008-11-16T05:37:23.823
> 
> 标签：.net, silverlight, compiler-construction

我应该澄清一下，我正在寻找客户端解决方案。

或者，是否有用托管代码编写的 C# 编译器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T06:21:46.340

**在客户端**

如果您使用的是 Silverlight 2.0 ，请查看[动态语言运行时：](http://en.wikipedia.org/wiki/Dynamic_Language_Runtime)

*   [http://www.silverlightexamples.net/post/Execute-Code-String-at-Runtime-with-Silverlight-20-DLR.aspx](http://www.silverlightexamples.net/post/Execute-Code-String-at-Runtime-with-Silverlight-20-DLR.aspx)
*   [http://silverlight.net/learn/dynamiclanguages.aspx](http://silverlight.net/learn/dynamiclanguages.aspx)

* * *

**完全信任的服务器或客户端**

此示例使用[Microsoft.CSharp.CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)，在服务器上编译，并将程序集发送到客户端：

*   [http://www.cnblogs.com/baggiojing/archive/2008/11/03/1325297.html](http://www.cnblogs.com/baggiojing/archive/2008/11/03/1325297.html)

有一个VB等价物。它们允许您编译到磁盘或内存中。在大多数情况下，您不能在客户端上使用它们，因为它们需要完全信任。

其他示例：

*   [http://blogs.microsoft.co.il/blogs/alex_golesh/archive/2007/12/20/how-to-compile-c-3-0-code-dynamically.aspx](http://blogs.microsoft.co.il/blogs/alex_golesh/archive/2007/12/20/how-to-compile-c-3-0-code-dynamically.aspx)
*   [http://www.developerfusion.com/article/4529/using-net-to-make-your-application-scriptable/3/](http://www.developerfusion.com/article/4529/using-net-to-make-your-application-scriptable/3/)

完全信任的 Silverlight：

*   [http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/27/how-to-make-silverlight-be-air.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/04/27/how-to-make-silverlight-be-air.aspx)
*   [http://www.silverlightshow.net/items/Silverlight-Running-standalone-full-trust-applications.aspx](http://www.silverlightshow.net/items/Silverlight-Running-standalone-full-trust-applications.aspx)

# programming-languages - 闭包的副作用，它们仍然纯粹是功能性的吗？

> ID：293567
> 
> 赞同：15
> 
> 时间：2008-11-16T06:23:29.003
> 
> 标签：programming-languages, functional-programming, lisp

作为函数式编程的新手，我花了很多精力想“这是函数式的做事方式吗？” 显然，递归与迭代非常简单，很明显递归是做事的功能性方式。但以闭包为例。我已经了解了使用 Lisp 的闭包，并且我了解闭包是函数和环境的组合（听起来很像状态和行为）。例如：

```
(let ((x 1))
           (defun doubleX()
              (setf x (* x 2)))) 
```

这里我们有一个在 x 变量的环境中定义的函数 doubleX。我们可以将此函数传递给其他函数，然后调用它，它仍然能够引用 x 变量。该函数可以继续引用该变量，即使它是在定义该变量的环境之外调用的。我见过的很多关于闭包的例子都是这样的。其中 setf 用于更改词法变量的值。这让我很困惑，因为：

1.) 我认为 setf 是邪恶的。主要是因为它会引起副作用，而且显然它们也是邪恶的。

2.) 这真的是“功能性的”吗？似乎只是保持全局状态的一种方式，我认为函数式语言是无状态的。

也许我只是不明白闭包。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T06:39:28.033

你是对的，使用闭包来操纵状态并不是纯粹的功能。Lisp 允许您以函数式风格进行编程，但它不会强迫您这样做。我实际上更喜欢这种方法，因为它允许我在纯功能和修改状态的便利性之间取得务实的平衡。

您可能会尝试编写一些从外部看起来很实用但保持内部可变状态以提高效率的东西。一个很好的例子是记忆化，你记录所有以前的调用来加速像斐波那契这样的函数，但是由于函数总是为相同的输入返回相同的输出并且不修改任何外部状态，所以可以考虑从外部发挥作用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-16T06:41:41.977

闭包是穷人的对象（反之亦然），请参阅

[什么时候使用闭包？](https://stackoverflow.com/questions/256625/when-to-use-closure)

以及我在其中的回答。因此，如果您打算使用副作用来管理非 OO 应用程序中的状态，则闭包可变状态确实是一种简单的方法。不可变的替代方案“不那么邪恶”，但 99.9% 的语言提供可变状态，而且它们不可能都是错误的。:) 明智地使用可变状态是很有价值的，但是当与闭包和捕获一起使用时，它尤其容易出错，如此处所示

[关于 lambdas、捕获和可变性](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!689.entry)

无论如何，我认为你看到“这么多这样的例子”的原因是解释闭包行为的最常见方法之一是展示一个像这样的小例子，其中闭包捕获一个可变的，因此变成一个迷你-stateful-object 封装了一些可变状态。这是一个很好的示例，可以帮助确保您了解该构造的生命周期和副作用影响，但这并不是在各处使用该构造的认可。

大多数情况下，使用闭包，您只会关闭值或不可变状态，而“没有注意到”您正在这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-26T14:20:30.970

Common Lisp 和 Scheme 并不是纯粹的函数式。Clojure 主要是功能性的，但仍然不是纯粹的。Haskell 是我所知道的唯一一种纯函数式语言，我什至不能提及另一种语言的名称。

事实是，在纯函数式环境中工作非常困难（去学习 Haskell 并尝试在上面编写一些东西）。所以所有这些函数式编程语言实际上他们所做的是*允许*函数式编程，但不强制执行它。函数式编程非常强大，所以在可以使用的时候使用它，在不能使用的时候使用它。

随着时代的到来，重要的是要知道任何功能都是可并行的，因此避免产生副作用或在程序的尽可能小的子集中是有意义的。

# firefox - 我可以在 Firefox 的目录列表中使用 CSS 吗？

> ID：293570
> 
> 赞同：2
> 
> 时间：2008-11-16T06:27:30.290
> 
> 标签：firefox

例如，如果我在 Firefox 的地址栏中输入“C:\docs”，它会显示目录中的所有文件。是否可以使用 CSS 自定义此页面？

Apache 2.2 允许我们使用 IndexStyleSheet 指令来做到这一点，所以我想知道 Firefox 是否可以做到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T06:35:47.917

Firefox 对每个配置文件都有一个文件 userContent.css（在配置文件的设置文件夹中找到）。该文件定义了标准 CSS，为什么会被网站覆盖。所以它们也适用于目录列表。

您应该查看 Firefox 为目录列表创建的实际 HTML 代码，以了解如何正确执行 CSS 定义。您将在 Web 上找到有关 userContent.css 的大量文档。

[http://www.mozilla.org/unix/customizing.html#userContent](http://www.mozilla.org/unix/customizing.html#userContent)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T12:26:59.033

我认为最简单的方法是创建一个自定义css的自己的皮肤。在这种情况下，您必须修改 dirListing.css。(chrome://global/skin/dirListing/dirListing.css)

我知道核桃主题 ( [https://addons.mozilla.org/en-US/firefox/addon/122](https://addons.mozilla.org/en-US/firefox/addon/122) ) 包含修改后的文件列表。

# zend-framework - 将 JavaScript 事件处理程序附加到 Zend_Form_Element

> ID：293575
> 
> 赞同：1
> 
> 时间：2008-11-16T06:31:59.157
> 
> 标签：zend-framework

我需要在 Zend_Form_Element 的 onchange 事件中附加一些 javascript。我怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T06:39:52.853

尝试使用 setAttrib($name, $value)，例如：

```
$element->setAttrib('onchange', 'jsFunction();'); 
```

[您可以在此处](http://framework.zend.com/manual/en/zend.form.elements.html)找到有关 Zend_Form_Element 的更多详细信息。

# c# - 如何查看提交修订后所做的更改并解析它以获取评论？

> ID：293582
> 
> 赞同：6
> 
> 时间：2008-11-16T06:40:06.707
> 
> 标签：c#, svn, sharpsvn

我希望自动化一些与 SubVersion 相关的任务，所以我得到了 SharpSvn。不幸的是，我找不到太多的文档。

我希望能够在用户提交新修订后查看更改，以便我可以解析代码以获取特殊评论，然后可以将其上传到我的票证系统中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T13:15:05.693

如果您只想浏览 SharpSvn，您可以使用[http://docs.sharpsvn.net/](http://docs.sharpsvn.net/)。那里的文档远非完整，因为重点主要是提供功能。欢迎任何有关增强文档（或 SharpSvn 本身）的帮助 ;-)

要为您的问题跟踪器使用日志消息，您可以使用两种方法：

1.  一次处理一个更改的提交后挂钩
2.  每隔一段时间调用 'svn log -r <last-retrived>:HEAD' 的预定服务。

SharpSvn 的最后一个每日构建对提交钩子有一些支持，但那部分还不是真正的 api-stable。

您可以使用以下命令创建一个提交后挂钩 (post-commit.exe)：

```
static void Main(string[] args)
{
  SvnHookArguments ha;
  if (!SvnHookArguments.ParseHookArguments(args, SvnHookType.PostCommit, false, out ha))
  {
    Console.Error.WriteLine("Invalid arguments");
    Environment.Exit(1);
  }

  using (SvnLookClient cl = new SvnLookClient())
  {
    SvnChangeInfoEventArgs ci;
    cl.GetChangeInfo(ha.LookOrigin, out ci);

    // ci contains information on the commit e.g.
    Console.WriteLine(ci.LogMessage); // Has log message

    foreach(SvnChangeItem i in ci.ChangedPaths)
    {
       //
    }
  }
} 
```

（对于一个完整的解决方案，您还必须挂钩 post-revprop-change，因为您的用户可能会在第一次提交后更改日志消息）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T07:08:09.100

这有什么用吗？

[http://blogs.open.collab.net/svn/2008/04/sharpsvn-brings.html](http://blogs.open.collab.net/svn/2008/04/sharpsvn-brings.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T09:20:57.397

我想知道颠覆挂钩（在 svn 服务器上）是否可能不是另一种方法？我没有尝试过，但[CaptainHook](http://haacked.com/archive/2006/07/27/IntroducingCaptainHookASubversionHookFrameworkFor.NET.aspx)似乎提供了 svn->.NET hook 集成。

# c# - 将整数放入枚举的最佳方法是什么？

> ID：293586
> 
> 赞同：3
> 
> 时间：2008-11-16T06:43:40.680
> 
> 标签：c#, enums

标准：性能、性能、性能。

我需要一种将 uint、int 等转换为枚举等价物的方法。使用 C# 最快的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T06:51:46.433

为什么不能直接做演员？

```
MyEnum enumVar = (MyEnum)intVar; 
```

# apache-flex - 弹性内存是否安全（无泄漏）

> ID：293587
> 
> 赞同：2
> 
> 时间：2008-11-16T06:43:44.283
> 
> 标签：apache-flex

我想制作可以在支持 Flash 的浏览器中运行的应用程序，并决定 flex 对我来说是最好的，所以我开始学习。AFAIK flex 有一个 GC，但与我见过的其他语言的 GC 相比，该 GC 的工作方式可能有点不同。我发现[了这一点](http://blogs.adobe.com/aharui/2007/03/garbage_collection_and_memory.html)，但显然存在（或曾经）无法防止的巨大内存泄漏，并且在 IE 中运行时更糟。

现在可以安全地信任 flex。是否有任何泄漏已修复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T16:40:03.237

我在一个相当大和复杂的 Flex3 应用程序上工作，我们没有任何可怕或无法控制的内存泄漏——即使在 IE 中也是如此。

Grant Skinner 的这篇关于 AS3 垃圾收集的帖子对我很有帮助。它于 2006 年发布，但仍然完全相关（因为我们仍在使用 AS3）。这是他关于资源管理的三部分系列的一部分 - 在他的帖子中有相关文章的链接。

[http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html](http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html)

需要理解/记住的是，Flex 应用程序在 Flash Player 中运行 - 也许您对此很清楚，但如果您不是来自 Flash 开发背景，我认为这并不完全明显。至少，我不认为它会适合我。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-21T23:10:46.613

发布了一篇描述 Flash Player 垃圾收集的 Adob​​e DevNet 文章：

[http://www.adobe.com/devnet/flashplayer/articles/garbage_collection.html](http://www.adobe.com/devnet/flashplayer/articles/garbage_collection.html)

当您在 ActionScript 中编程时，与内存相关的最大问题是确保不要保留对不再需要的对象的引用。例如，当您添加事件侦听器时，请确保在不再需要该事件侦听器时也将其删除（或学习如何利用弱引用）。

根据我的经验，Flex 框架通常擅长这种类型的内存簿记。您的应用程序的内存占用将部分归结为您使用垃圾收集器进行编码的程度。

如果您确实遇到内存不断增加的问题，您可以利用 Profiler 获取和比较内存快照，以便找到泄漏的对象。您可以在此处找到有关 Profiler 的信息：

[http://livedocs.adobe.com/flex/3/html/profiler_1.html](http://livedocs.adobe.com/flex/3/html/profiler_1.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T11:44:52.007

我工作的人说 ComboBox 和自动完成事件存在错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T07:10:08.487

您可以查看的几个资源是：[Flex Bug Tracking](http://bugs.adobe.com/flex/)，您可以仔细阅读已修复/记录的内存泄漏错误。同样在 Flex Builder IDE 中，您可以使用 Profiler 来监控内存/CPU 使用情况等。我无法具体回答您的问题。我认为这里的部分责任在于你，开发人员，以及你如何设计和管理你的代码。除此之外，我注意到使用 Flex 3 框架（或一般的 ASVM2）它在管理 GC 方面做得很好。请记住，Flex 4 即将到来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T18:07:00.593

根据我的经验，随着时间的推移，Flex 2 会泄漏大量内存，尤其是在 Firefox 2 中。我不确定 Flex 3。

# zend-framework - 从 Zend_Controller_Action 动态包含 .js 文件？

> ID：293590
> 
> 赞同：4
> 
> 时间：2008-11-16T06:46:46.210
> 
> 标签：zend-framework

我遇到了根据执行路径我可能需要从控制器调用包含 .js 文件的情况。有什么好的方法吗？（除了使用实际的 .js 包含代码设置一些视图变量之外）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-16T11:47:56.523

请参阅视图助手 headScript()。我只是在脑海中写下这个，但我认为它是这样工作的：

从视图文件中：`$this->headScript()->appendFile('filename.js');`

从控制器内部：`$this->view->headScript()->appendFile('filename.js');`

然后在你的布局中的某个地方，你需要回显你的 headScript 对象：

`<?=$this->headScript();?>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T09:22:45.897

当然，你可以像@Bill Karwin 描述的那样做。

但是如果你想做得很好，你需要模板继承——比如它是在 Python 的 Django 框架中实现的。Zend 框架也有一些扩展，看看[Calypso](http://www.beberlei.de/calypso/)。

# php - MySQL、PHP - 表单帮助

> ID：293595
> 
> 赞同：0
> 
> 时间：2008-11-16T06:52:34.140
> 
> 标签：php, mysql, forms

问候，

我有以下代码

```
 <?       
        include("conn.php");
        $sn=$_GET["sn"];
        $sql="select * from kpi where no='$sn'";

        $result=mysql_query($sql,$connection) or die(mysql_error());
        while($row=mysql_fetch_array($result)) {
            $sn=$row['id'];
            $no=$row['no'];
            $pdetails=$row['pdetails'];
            $kpistatus=$row['kpistatus'];
            $status=$row['status'];
            $cols=$row['cols'];
            $rows=$row['rows'];
        }
    ?>

    <form name="form1" method="post" action="formsubmit.php?mode=addtable">
        <table width="100%" border="1" align="center" cellpadding="2" cellspacing="2">
          <tr>
            <td colspan="2"><strong>Add Table</strong></td>
               </td>
          </tr>
          <tr>
            <td>NO</td>
            <td><input name="no" type="text" id="no" value="<? echo $no; ?>"></td>
          </tr>
          <tr>
            <td>PROJECT DETAILS</td>
            <td><textarea name="pdetails" rows="10" cols="100"><? echo $pdetails; ?></textarea></td>
          </tr>
                        <tr>
            <td>KPISTATUS</td>
            <td>
            <?
            echo "<table border=\"1\" align=\"left\">\n";
            $j=0;
            while ($j < $rows) 
            {
            echo "<tr>\n";
            $i=0;
            while ($i < $cols) 
            {
            ?>
            <td><input type="text" name="kpistatus" id="kpistatus"></td>
            <?
            $i++;
            }       
            echo "</tr>\n";
            $j++;
            }
            echo "</table>\n";
            ?>
            </td>
            </tr>
            <tr>
            <td>STATUS</td>
            <td><textarea name="status" rows="10" cols="100"><? echo $status; ?></textarea></td>
          </tr>
          <tr>
            <td colspan="2"><input type="submit" name="Submit" value="ADD TABLE"></td>
          </tr>
        </table>
      </form> 
```

```
 elseif($mode=="addtable") {
        $no=$_POST["no"];
        $pdetails=$_POST["pdetails"];
        $kpistatus=$_POST["kpistatus"];
        $status=$_POST["status"];
        $sn=$_POST["id"];
        $sql="update kpi set pdetails='$pdetails',kpistatus='$kpistatus',status='$status' where no='$no'";
        //echo $sql;
        $result=mysql_query($sql,$connection) or die(mysql_error());
        //header("location: index.php");
      }
      ?> 
```

表格截图： http://img395.imageshack.us/my.php?image= [1226818203913yi6.png](http://img395.imageshack.us/my.php?image=1226818203913yi6.png)

用户可以输入需要插入数据的行数和列数。在屏幕截图中，我的行是 10，而列是 5。

现在我卡住的部分是，我如何确保 < input type="text" name="kpistatus" id="kpistatus"> 中的所有输入数据都保存在 kpistatus mysql 表中。

请帮我。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T07:51:23.130

如果您在`input`名称中加上方括号，php 会自动将它们转换为您在 post 数组中的数组。然后你可以遍历它并根据需要保存它们。在你的表格中，你会放

`<input type="text" name="kpistatus[]" id="kpistatus">`

（注意添加两个括号）。

然后，在您的表单处理代码中，您将拥有`$_POST['kpistatus']`一个数组。您可以使用 PHP 的`implode`函数通过执行类似`implode(',', $_POST['kpistatus']`.

快速说明：

在您的代码中，您需要在插入之前对所有变量使用[mysql_real_escape_string 。](http://www.php.net/mysql_real_escape_string)否则，用户可以在其中一个输入中输入 SQL 代码并能够做任何他们想做的事情（这称为 SQL 注入）。

想象一下如果有人在他们的状态字符串中有一个单引号会发生什么。充其量它会导致错误，最坏的情况是它们可能会覆盖或擦除您的数据。

对不起，如果这对你来说很明显，但我只是想确保覆盖它。

# .net - 将 www 链接路由到 .net mvc 中的非 www 链接

> ID：293597
> 
> 赞同：4
> 
> 时间：2008-11-16T06:52:49.473
> 
> 标签：.net, asp.net-mvc, url-rewriting

似乎使用 .NET MVC 中内置的友好路由库，它可以让我们做这样的事情。

如果我想要使用 .NET MVC 中的内置内容并不明显，我希望使用 MVC 框架自动将一个以 www 开头的 url 重定向到非 www url。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-01-29T14:42:47.163

您可以使用[IIS 7 URL 重写模块](http://www.iis.net/download/urlrewrite)

您可以从 IIS 进行设置，也可以将其放在`web.config`以下内容中`<system.webServer>`：

## www 到非 www

```
<rewrite>
  <rules>
    <rule name="Canonical" stopProcessing="true">
      <match url=".*" />
      <conditions>
        <add input="{HTTP_HOST}" pattern="^www[.](.+)" />
      </conditions>
      <action type="Redirect" url="http://{C:1}/{R:0}" redirectType="Permanent" />
    </rule>
  </rules>
</rewrite> 
```

或者，您可以在以下位置进行此重定向`global.asax.cs`：

```
protected void Application_BeginRequest(object sender, EventArgs ev)
{
    if (Request.Url.Host.StartsWith("www", StringComparison.InvariantCultureIgnoreCase))
    {
        Response.Clear();
        Response.AddHeader("Location", 
            String.Format("{0}://{1}{2}", Request.Url.Scheme, Request.Url.Host.Substring(4), Request.Url.PathAndQuery)
            );
        Response.StatusCode = 301;
        Response.End();
    }
} 
```

但请记住@Sam 所说的内容，[请在此处查看更多信息](http://www.ravelrumba.com/blog/static-cookieless-domain/)。

* * *

## 非 www 到 www

```
<rewrite>
  <rules>
    <rule name="Canonical" stopProcessing="true">
      <match url=".*" />
      <conditions>
        <add input="{HTTP_HOST}" pattern="^([a-z]+[.]net)$" />
      </conditions>
      <action type="Redirect" url="http://www.{C:0}/{R:0}" redirectType="Permanent" />
    </rule>
  </rules>
</rewrite> 
```

制作一个正则表达式模式以匹配您的主机并用于`{C:0}` `1, 2, ..., N`获取匹配的组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T07:52:12.303

从 www 到非 www 的 301 重定向有多种方法。我更喜欢在某些项目中将这种重定向逻辑保留在 ASP.NET 级别（即在我的应用程序中），但其他项目则需要性能更好的东西，例如 IIS7 url 重写。

它[在 ASP.NET 论坛上进行了讨论](http://forums.asp.net/t/1324018.aspx)，我选择在每个控制器上使用 WwwFilter。这对我有用，没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-02T13:50:55.270

尝试将其添加到您的***Global.asax***中：

```
if (HttpContext.Current.Request.Url.ToString().ToLower().Contains("http://YourSite.com"))
    {
            HttpContext.Current.Response.Status = "301 Moved Permanently";
            HttpContext.Current.Response.AddHeader("Location", Request.Url.ToString().ToLower().Replace("http://YourSite.com","http://www.YourSite.com"));
    } 
```

**它工作并经过测试。**

# agile - 敏捷软件开发方法的基本步骤

> ID：293599
> 
> 赞同：23
> 
> 时间：2008-11-16T06:53:35.103
> 
> 标签：agile, methodology

基本步骤是`Agile software development`什么？
以及如何使用敏捷方法开始一个新项目？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-16T07:17:28.910

好吧，OP，没有一个记录在案的“敏捷软件开发”分步指南，任何符合[宣言的](http://agilemanifesto.org/)程序都可以称为敏捷

但我也明白，要开始学习，必须有一个“手把手”/“按书本”的学习阶段。所以我建议你看看你当前的开发过程。找出耗费大量时间的“浪费”活动，并采用敏捷实践来抵消/最大限度地减少在该活动中花费的时间。例如，如果您经常遇到构建问题，请先设置一个持续集成服务器，然后设置一个严格的签入预筛选。与其改变一切，让每个人都感到迷茫和疏远，

*   一次**练习一种**
*   用它投资大约 2-3 周..适应它
*   检查团队中的每个人是否都觉得它有帮助。如果是的话，坚持下去，让它成为你新流程的一部分。否则丢弃并找到并替换为另一种替代疗法。

如果您的整个团队不熟悉敏捷，我建议（按强度顺序）

*   敏捷开发人员的实践（Andy Hunt，Venkat S.，薄书，新手的高价值页面比率）
*   敏捷原则实践和模式 (Robert & Micah Martin)
*   针对 TDD（beck、astels、et.all）、重构（Fowler、Joshua K.）等选择实践进行每周“变得更好”会议，这些实践必将获得巨大回报。
*   大约一个月后……去阅读哲学书籍，例如 XP Embrace Change - Beck、Poppendieck 的 Lean Books、Agile S/w Development - Alistair Cockburn、Peopleware - DeMarco、Lister

我建议看看[这里列出的书籍](https://stackoverflow.com/questions/126955/favorite-agile-related-books)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-16T07:51:30.167

有一个名为[Autumn of Agile](http://autumnofagile.net/)的截屏视频系列，介绍了敏捷原则。目前还没有那么多剧集，但剧集计划是这样的：

*   敏捷价值观和实践概述
*   基本面向对象设计原则
*   设计模式在行动
*   单元测试基础
*   模拟对象
*   TDD
*   项目文件/文件夹组织
*   源代码管理基础
*   持续集成/构建自动化
*   敏捷项目规划原则
*   领域驱动设计核心概念概述

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T20:08:17.870

Henrik Kniberg 整理了一个[简短的 PDF](http://www.crisp.se/henrik.kniberg/ScrumAndXpFromTheTrenches.pdf)，快速且易于阅读。你可以从阅读它开始。你会得到你的问题的答案，还有更多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T21:38:46.977

我推荐 Gregory S. Smith 的文章“创建敏捷环境”（[http://www.methodsandtools.com/archive/archive.php?id=70](http://www.methodsandtools.com/archive/archive.php?id=70)）和视频“企业中向敏捷方法的过渡”（[http ://www.renewtek.com/index.php?page=agile-methodology-in-the-enterprise](http://www.renewtek.com/index.php?page=agile-methodology-in-the-enterprise) )

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-16T11:20:51.757

采用敏捷软件开发方法的最佳方法在很大程度上取决于您所处的情况。您为什么要采用敏捷？什么好处对您来说最重要？您需要解决的最大问题是什么？您是否有资源进行颠覆性的一次性采用？或者你更喜欢从一个更长时间、可能更痛苦的增量采用开始？

我强烈推荐《敏捷采用模式》一书，以帮助您思考哪种采用方法适合您。从敏捷开发方面的知识渊博的人那里获得直接（现场）帮助可能也是一个好主意 - 一个可以观察您的团队，看到模式和反模式并贡献他如何处理它们的经验的人。

作为第一个实践之一，我一直想要适应的实践之一是迭代回顾。这些对于敏捷方法的适应周期至关重要。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-16T07:07:19.570

看看 robert marin 的“敏捷软件开发、原则、模式和实践”。有一个 java 和 ac# 版本。[http://www.amazon.com/Software-Development-Principles-Patterns-Practices/dp/0135974445](https://rads.stackoverflow.com/amzn/click/com/0135974445)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-09T14:47:55.053

I've read a lot of Agile books, and the one book I could truly recommend from all those is "The Art of Agile Development" by James Shore.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-29T19:51:48.533

最好的方法是聘请技术经验丰富的敏捷教练。让某人在您的团队中工作，该团队之前已经做过您想要采用的任何敏捷方法（scrum、xp、水晶、看板……等等）。他们将不得不看到你的工作环境——最好是在环境中工作以提供帮助。检查他们的参考资料并确保他们确实在实践中使用过它。周围有很多崇拜者和假货。

在团队中有经验丰富的人会让一切变得不同。仅仅从阅读一本书中就很难接受。你正试图改变一种文化，但你不能使用清单或算法来做到这一点。这是一个社会复杂性的事情。你试图鼓励复杂系统中的紧急行为。

如果您无法聘请敏捷教练，请在团队或您的部门或公司中找到其他有经验的人，并邀请他们“参观”团队。向他们展示你的情况并听取他们的意见。

不同的团队需要不同的建议——这取决于很多事情，包括团队成员、您使用的技术类型、您从事的业务类型......

最重要的是，与当地的敏捷专家联系并面对面学习。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-19T15:19:06.877

我将支持 Ilja 对这本书的推荐：http: [//www.amazon.com/Agile-Adoption-Patterns-Roadmap-Organizational/dp/0321514521](https://rads.stackoverflow.com/amzn/click/com/0321514521)

我认为这本书最有价值的部分是描述了首先采用哪些实践来实现某些商业价值（质量、上市时间……）。

书评：[http](https://rads.stackoverflow.com/amzn/click/com/0321514521) ://www.amazon.com/Agile-Adoption-Patterns-Roadmap-Organizational/dp/0321514521 示例章节：[http ://www.informit.com/store/product.aspx?isbn=0321514521 #信息8](http://www.informit.com/store/product.aspx?isbn=0321514521#info8)

最后加入 groups.yahoo.com 上的敏捷邮件列表，ScrumDevelopment 或 AgileProjectManagement 都将很好地满足您的需求。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-01T21:40:03.433

你不敏捷与否，你或多或少是敏捷的。

为了从你已经在做的事情开始变得更加敏捷，

*   可视化更多（屏幕上的指标、可视板等）
*   获得更多反馈并缩短反馈循环（CI、代码指标、错误指标等）
*   减少同时进行的工作量 (WIP) - 即减少个人和团队层面的多任务处理

如果您能够尝试新的东西，我会推荐看板。它是最不规范、最灵活的敏捷工具，您只需从可视化工作流程和限制 WIP 开始。

# sql - 如果我要发布有关 Oracle SQL 查询性能的问题，我的问题中应该包括什么？

> ID：293600
> 
> 赞同：3
> 
> 时间：2008-11-16T06:57:20.557
> 
> 标签：sql, performance, oracle, database-design

如果我发布有关针对 Oracle 数据库的查询的问题，我应该在我的问题中包含哪些内容，以便人们有机会回答我？我应该如何获得这些信息？

仅仅提供性能不佳的查询可能还不够。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T07:11:38.483

*   涉及的表的架构定义。
*   在这些表上定义的索引。
*   您正在执行的查询。
*   生成的查询执行计划

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T07:08:16.790

查询计划总是有用的

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T22:40:57.470

理想情况下，使用来自 v$sql 的 sql_id 和 child_cursor_id 使用 DBMS_XPLAN.DISPLAY_CURSOR 获取完整的查询计划。如果做不到这一点（即在旧版本上），请尝试 v$sql_plan 并包含过滤器和访问谓词。如果 EXPLAIN PLAN 确实显示了使用的计划，则很好。

DB 版本和版本（Express/Standard/Enterprise）。也许操作系统也是。从 V$VERSION 中选择 *

如果您有任何非标准的数据库参数，了解（尤其是与优化器相关的任何内容）很有用。select * from v$parameter where rownum < 5 and isdefault != 'TRUE'; *如果您执行 alter session set events '10053 trace name context forever, level 1' 并解析查询，将会有一个日志文件包含优化查询时使用的所有参数 *

真实世界的表大小和列分布（例如，它是一百万行表，其中 30% 的行是“红色”等）。以及 USER_TABLES、USER_TAB_COLUMNS 的相关统计信息。

它实际看起来多长时间，加上您从 v$sql 获得的任何 SQL 统计信息（一致获取、物理读取）。

另外，你认为谁应该能够跑得更快。您是否认为有更好的计划，或者您只是在祈祷。

# php - PHP 和并发文件访问

> ID：293601
> 
> 赞同：11
> 
> 时间：2008-11-16T06:58:36.670
> 
> 标签：php, file, concurrency

我正在用 PHP 构建一个小型 Web 应用程序，它将一些信息存储在纯文本文件中。但是，我的应用程序的所有用户在某个给定时间点和可能同时使用/修改此文本文件。

所以问题是。确保只有一个用户可以在任何给定时间点对文件进行更改的最佳方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-16T08:57:27.663

您应该锁定文件

```
 $fp = fopen("/tmp/lock.txt", "r+");

if (flock($fp, LOCK_EX)) {  // acquire an exclusive lock
    ftruncate($fp, 0);      // truncate file
    fwrite($fp, "Write something here\n");
    fflush($fp);            // flush output before releasing the lock
    flock($fp, LOCK_UN);    // release the lock
} else {
    echo "Couldn't get the lock!";
}

fclose($fp); 
```

看看[http://www.php.net/flock](http://www.php.net/flock)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-16T07:05:54.847

我的建议是使用 SQLite。它快速、轻量、存储在文件中，并具有防止并发修改的机制。除非您正在处理预先存在的文件格式，否则 SQLite 是您的最佳选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T08:20:07.817

你可以做一个提交日志的格式，就像维基百科那样。

使用数据库，每次保存的更改都会在数据库中创建一个新行，这使得以前的记录变得多余，并具有递增的值，那么您只需要担心在保存阶段获得表锁。

这样至少如果 2 个并发的人碰巧编辑了某些东西，这两个更改都将出现在历史记录中，并且在提交战争中丢失的任何内容都可以复制到新的修订版中。

现在，如果您不想使用数据库，那么您必须担心有一个修订控制文件支持每个可见文件。

您可以在文件系统上放置一个修订控制（ GIT/MERCURIAL/SVN ），然后在保存阶段自动提交，

伪代码：

```
 user->save : 
   getWritelock(); 
   write( $file ); 
   write_commitmessage( $commitmessagefile ); # <-- author , comment, etc 
   call "hg commit -l $commitmessagefile $file " ; 
   releaseWriteLock(); 
 done. 
```

至少这样，当 2 个人同时进行关键提交时，谁都不会迷路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T07:55:33.577

许多用户的单个文件真的不应该是您使用的策略我不认为 - 否则您可能需要实现一个（全局）访问点来监视文件当前是否正在编辑。获取锁，进行修改，释放锁等。我会选择“没有人建议使用数据库”（如果您不想要完整的 RDBMS 的开销，请使用 SQLite）

# c# - 包含 ASP 文件时，“aspnet_compiler.exe”以代码 1 退出“错误

> ID：293602
> 
> 赞同：0
> 
> 时间：2008-11-16T06:59:05.577
> 
> 标签：c#, asp.net

我有一个 ASP.NET 项目，在构建项目时它显示构建成功。但是当我构建部署项目时，它显示构建失败并显示错误消息

```
Error    5    "aspnet_compiler.exe" exited with code 1 
```

我重新检查了我的项目，发现当我删除线路时**`<!--#include file="admin/topstyle.asp"-->`**，它工作正常。如果我使用这条线，我会在构建 Web 部署项目以创建我的 dll 时出错。

**topstyle.asp**是一个文件，它为页面呈现一些常见的样式，如标题图像等。

谁能告诉我如何摆脱这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-17T12:02:13.860

您不能在同一页面中混合使用 ASP.NET 和 ASP。ASP.NET 编译器返回错误，因为它不理解 ASP 代码。

至于为什么项目可以正常构建，那是因为包含指令是 Web 服务器的功能，而不是 Visual Studio 甚至 ASP.NET。当您在 Visual Studio 中构建时，包含被忽略，因为编译器甚至不知道它是什么（它只是将其视为 HTML 注释），因此编译器只看到 ASP.NET 代码和 HTML ......但是当页面被动态编译时，网络服务器首先引入包含的文件，然后将整个内容传递给编译器，然后编译器在遇到包含的 ASP 代码时就会崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-17T06:07:04.403

以下 vb.net 代码的更改解决了错误“aspnet_compiler.exe”退出，代码为 1”。该解决方案已成功构建，但发布失败。

解决方案已成功构建，但 PUBLISH FAILED 错误“aspnet_compiler.exe”以代码 1 退出。

VB.NET 代码中的以下更改解决了此错误：

以前的代码：

```
dtRow.Item("ParentGroupName") = Session("SecondaryGroupItems").GetSecondaryGroupItem(Session("LgItems").GetLgItem(mFnTransaction.FnTransactionDetails(1).LgId).SecondaryGroupId).Name 
```

新代码：

```
Dim mmSecondaryGroupId As Integer = 0
Dim mmLgId As Integer = 0

mmLgId = mFnTransaction.FnTransactionDetails(1).LgId

mmSecondaryGroupId = DirectCast(Session("LgItems"), LgItems).GetLgItem(mmLgId).SecondaryGroupId

dtRow.Item("ParentGroupName") = DirectCast(Session("SecondaryGroupItems"), SecondaryGroupItems).GetSecondaryGroupItem(mmSecondaryGroupId).Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T07:50:19.547

它在其他页面上是否成功运行？Topstyle.asp 页面也是 ASP.NET 页面吗？如果不是这样，它就行不通，因为你不能像这样混合这两种技术。

在 ASP.NET 中，不鼓励使用包含语法。尝试改用用户控件或 <%= Globals.MyConstantThatContainsTheStyles %>。

如果您使用的是 ASP 2.0，请考虑使用母版页，但这对您的应用程序来说可能是一个很大的变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T10:10:19.323

我发现编译器有时会在包含指令中出现绝对路径问题。不知道它是否能解决这个特殊问题，但只要有可能，尽量`<!-- include virtual="~/page.asp" -->`改用。

# java - Java 或 Joda 中的十进制 DateTime 格式化程序

> ID：293617
> 
> 赞同：2
> 
> 时间：2008-11-16T07:11:02.353
> 
> 标签：java, datetime, formatting, jodatime

我正在编写一个要求日期为十进制格式的文件：

> `2007-04-24T13:18:09`变成`39196.554270833331000`

有没有人有时间格式化程序可以做到这一点（十进制时间是 VB/Office 等使用的）？

基本代码如下：

```
final DateTime date = new DateTime(2007, 04, 24, 13, 18, 9, 0, DateTimeZone.UTC);
double decimalTime = (double) date.plusYears(70).plusDays(1).getMillis() / (Days.ONE.toStandardDuration().getMillis())); //=39196.554270833331000. 
```

对于上面的例子。

（我开始使用可以执行此操作的 DateTimePrinter，但现在太难了（我没有链接 joda 源，所以我无法轻松获得想法））。

注意：十进制时间是自 1900 年以来的天数 - . 代表部分天数。2.6666666 是 1900 年 1 月 2 日下午 4 点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T16:56:00.067

您可以创建一个输出当天小数部分的格式化程序。您需要使用`DateTimeFormatterBuilder`手动构建模式。使用[appendFractionOfDay()](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormatterBuilder.html#appendFractionOfDay%28int,%20int%29)添加分数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T07:26:10.687

[getTime()](https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Date.html#getTime())方法有什么问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T23:38:08.030

不幸的是，您的问题不是很清楚，但我有一种预感，十进制时间您的意思是[Julian date](http://en.wikipedia.org/wiki/Julian_date)。有一篇关于在 Java[中将日期转换为朱利安日期的帖子。](http://forums.sun.com/thread.jspa?threadID=548884)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-10T11:32:49.773

您可以使用日历类执行此操作：

```
final long MILLIS_IN_DAY = 1000L * 60L * 60L * 24L;

final Calendar startOfTime = Calendar.getInstance();
startOfTime.setTimeZone(TimeZone.getTimeZone("UTC"));
startOfTime.clear();
startOfTime.set(1900, 0, 1, 0, 0, 0);

final Calendar myDate = Calendar.getInstance();
myDate.setTimeZone(TimeZone.getTimeZone("UTC"));
myDate.clear();
myDate.set(2007, 3, 24, 13, 18, 9); // 2007-04-24T13:18:09

final long diff = myDate.getTimeInMillis() - startOfTime.getTimeInMillis() + (2 * MILLIS_IN_DAY);
final double decimalTime = (double) diff / (double) MILLS_IN_DAY;
System.out.println(decimalTime); // 39196.55427083333 
```

需要注意的是：此代码仅在 1900 年 2 月 28 日之后有效。Excel[错误地](http://support.microsoft.com/kb/214326)将 1900 视为闰年，当然[不是](http://science.howstuffworks.com/question50.htm)。为了规避这个错误，计算会插入一个额外的日期（`2 * MILLIS_IN_DAY`），但这当然会破坏假想闰年发生之前的任何日期计算。

# c# - 监控系统中的进程启动

> ID：293624
> 
> 赞同：7
> 
> 时间：2008-11-16T07:18:04.697
> 
> 标签：c#, .net, c++, winapi

有没有办法在启动之前监控系统中启动的进程？

示例：
在 ZoneAlarm 或防病毒程序等程序上，当您运行程序时，它会在运行之前询问您是否允许运行该程序...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T18:06:31.563

有几种方法可以做到这一点。如果您只需要跟踪来自特定程序（或几个程序）的进程创建，这里提到的 EasyHook/Detours 方法将工作得很好，但您实际上需要在 CreateProcess 上安装一个钩子到每个程序中，所以它不是如果您想跟踪系统中的所有进程创建，这是一个很好的解决方案。

在基于 NT 的 Windows 变体 (NT/2000/XP/Vista) 中有一个特定的 API，称为 PsSetCreateProcessNotifyRoutine()。不幸的是，您只能从 ring0 调用此函数，因此需要在驱动程序中完成。这篇 CodeProject 文章中有一个方便的解释（和代码）：http: [//www.codeproject.com/KB/threads/procmon.aspx](http://www.codeproject.com/KB/threads/procmon.aspx)。

AFAIK，这只是一个通知，它本身并不允许您告诉系统是否应该创建进程。但是，如果您需要这样做，您可以暂停进程（例如，通过将其作为调试器附加），同时您的代码决定是否终止它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T07:52:50.647

您应该查看[easyhook-continuing-detours](http://code.google.com/p/easyhook-continuing-detours/)项目，它是[Microsoft Detours](http://research.microsoft.com/sn/detours/)项目的 .NET 端口。它将允许您挂钩非托管 API（例如 CreateProcess）。[在此处查看](http://code.google.com/p/easyhook-continuing-detours/wiki/Introduction)类似 FileMon 的简单程序的代码示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T07:32:00.520

您可以通过使用实时 ETW 消费者来了解进程何时启动 - 但是，为了能够采取一些可能*取消*进程启动的操作，您必须做一些可疑/未记录的事情，例如挂钩 CreateProcess，或使用内核过滤器驱动程序来阻止对 EXE 的读取。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T11:40:48.940

只需使用进程创建通知。它包含在 Windows 中。你不需要钩任何东西。

# algorithm - 以流行语言显示算法的网站？

> ID：293625
> 
> 赞同：2
> 
> 时间：2008-11-16T07:18:28.720
> 
> 标签：algorithm, sites

有没有像“语言枪战”这样的网站（shootout.alioth.debian.org 和dada.perl.it/shootout/），它展示了如何用不同的语言做简单/高级的事情？即如何在不同语言中使用哈希，如何排序，如何编写类，如何连接到站点等。嗯，上面这两个实际上是我想要找到的例子，但它们非常有限算法的选择。任何其他？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T07:29:14.783

我喜欢[LiteratePrograms](http://en.literateprograms.org)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T07:52:09.463

有很多这样的网站。请参阅[RosettaCode::Similar_Sites](http://rosettacode.org/wiki/Help:Similar_Sites)

# entity-framework - 从实体框架模型构建数据库模式

> ID：293631
> 
> 赞同：3
> 
> 时间：2008-11-16T07:29:24.847
> 
> 标签：entity-framework, ado.net

我看到 EF 可以根据现有的数据库模式更新模型。但是，我完全从头开始。我不想构建表，然后在 EF 模型文件中*重建它们。*有没有办法可以绘制模型文件，并自动为我创建 SQL 表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T07:38:18.337

不幸的是，您必须等待 EF 的第 2 版。

[这是](http://blogs.msdn.com/efdesign/archive/2008/09/10/model-first.aspx)EF 团队博客的链接，他们讨论在 v2 中添加 Model First 支持：

> Entity Framework V1 中最痛苦的遗漏之一是模型优先，这基本上意味着创建一个概念上的“模型优先”，然后从中派生存储模型、数据库和映射。
> 
> [...]
> 
> 实体框架的下一个版本将包括从您的模型生成数据库模式的能力。此功能的主要入口点是通过 Designer 上下文菜单，我们将在其中添加一个名为“从模型创建数据库”的新选项。

# javascript - 单击链接时显示带有 JavaScript 的确认弹出窗口

> ID：293648
> 
> 赞同：10
> 
> 时间：2008-11-16T07:47:43.187
> 
> 标签：javascript, html, user-interface, popup

如何创建其中一个超链接，当您单击它时，它会显示一个弹出窗口，询问“您确定吗？”

```
<INPUT TYPE="Button" NAME="confirm" VALUE="???" onClick="message()"> 
```

我已经有一个 message() 函数在工作。我只需要知道超链接的输入类型是什么。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-16T09:07:51.793

```
<a href="http://somewhere_else" onclick="return confirm()"> 
```

When the user clicks the link, the `confirm` function will be called. If the confirm function returns `false`, the link traversal is cancelled, if true is returned, the link is traversed.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-11T15:35:27.873

```
<a href="http://something.com" onclick="return confirmAction()">try to click, I dare you</a> 
```

与功能

```
function confirmAction(){
      var confirmed = confirm("Are you sure? This will remove this entry forever.");
      return confirmed;
} 
```

（您也可以立即返回确认，为了便于阅读，我将其分开）

在 FF、Chrome 和 IE 中测试

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T09:02:22.067

As Nahom said, except I would put the `javascript:message()` call directly in the href part (no need for onclik then).

Note: leaving the JavaScript call in the *onClick* has a benefit: in the *href* attribute, you can put a URL to go to if the user doesn't have JavaScript enabled. That way, if they do have JS, your code gets run. If they don't, they go somewhere where they are instructed to enable it (perhaps).

Now, your `message` routine must not only ask the question, but also use the answer: if positive, it must call submit() on the form to post the form. You can pass `this` in the call to ease the fetching of the form.

Personally, I would go for a button (input tag as you show) instead of a simple link to do the process: it would use a more familiar paradigm for the users.

[EDIT] Since I prefer to verify answers I give, I wrote a simple test:

```
<script type="text/javascript" language="JavaScript">
function AskAndSubmit(t)
{
  var answer = confirm("Are you sure you want to do this?");
  if (answer)
  {
    t.form.submit();
  }
}
</script>

<form action="Tests/Test.html" method="GET" name="subscriberAddForm">
<input type="hidden" name="locationId" value="2721"/>
<input type="text" name="text" value="3.1415926535897732384"/>
<input type="button" name="Confirm" value="Submit this form" onclick="AskAndSubmit(this)"/>
</form> 
```

Yes, the submit just reload the page here... Tested only in FF3.

[EDIT] Followed suggestion in the comments... :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T18:43:11.817

```
<a href="#" onclick="message(); return false;">???</a> 
```

只有当点击**不需要**将用户导航到另一个页面时，这个答案才可以。

# algorithm - 如何根据“争议”对故事进行排名？

> ID：293649
> 
> 赞同：4
> 
> 时间：2008-11-16T07:47:50.143
> 
> 标签：algorithm

我想根据“争议”商数对我的故事进行排名。例如，reddit.com 目前有“争议”部分：[http ://www.reddit.com/controversial/](http://www.reddit.com/controversial/)

当一个故事有很多赞成票和很多反对票时，即使总分为 0（例如），它也是有争议的。我应该如何计算这个商分数，以便当有很多人上下投票时，我可以以某种方式捕捉到这一点。

谢谢！！！

缺口

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T09:36:50.610

I would recommend using the [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation) of the votes.

A controversial vote that's 100% polarised would have equal numbers of -1 and +1 votes, so the mean would be 0 and the stddev would be around 1.0

Conversely a completely consistent set of votes (with no votes in the opposite direction) would have a mean of 1 or -1 and a stddev of 0.0.

Votes that aren't either completely consistent or completely polarised will produce a standard deviation figure between 0 and ~1.0 where that value will indicate the degree of controversy in the vote.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T07:58:34.100

最简单的方法是计算时间范围内（例如 1 周、48 小时等）给定评论的赞成/反对配对的数量，并让配对最多的评论首先出现。任何更复杂的事情都需要对最佳算法进行反复试验或试验 - 与往常一样，它因网站内容以及您希望它的加权方式而异。

总体而言，它与热度算法没有太大区别，热度算法通过检测时间范围内最多的点赞或观看来工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T08:06:32.617

简单地获取一个时间点的两个值（向上或向下）中的较小者呢？如果它上涨很多并下跌一点，或者相反，没有争议。

例如，如果项目有 10 次上升和 5 次下降，则“争议级别”为 5，因为有 5 个人不同意喜欢与否。另一方面，如果它有 10 次上涨或 10 次下跌，则“争议级别”为 0，因为没有人不同意。

因此，最后在这种情况下，两个项目中较小的一个定义了“热度”或“争议性”。这有意义吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T12:41:54.903

```
// figure out if up or down is winning - doesn't matter which
if (up_votes > down_votes)
{
    win_votes = up_votes;
    lose_votes = down_votes;
}
else
{
    win_votes = down_votes;
    lose_votes = up_votes;
}
// losewin_ratio is always <= 1, near 0 if win_votes >> lose_votes
losewin_ratio = lose_votes / win_votes; 
total_votes = up_votes + down_votes;
controversy_score = total_votes * losewin_ratio; // large means controversial 
```

该公式将为获得大量选票且投票比例接近 50/50 的故事产生高分，而对于一个选择的票数较少或多数票的故事，该公式将产生低分。

# asp.net-mvc - 关于 ASP.NET MVC 表单发布方案的问题

> ID：293652
> 
> 赞同：1
> 
> 时间：2008-11-16T07:50:51.823
> 
> 标签：asp.net-mvc

我目前有一个用于 /Address/Edit 和 /Address/Create 页面的用户控件。这个用户控件只包含以下代码来向系统提交一个新地址：

```
<% 
    using (Html.BeginForm())
    {
%>
        <table>
            <tr>
                <td>Street Address</td>
                <td>
                    <%= Html.TextBox("StreetAddress", (ViewData.Model != null) ? ViewData.Model.StreetAddress : "") %>
                    <%= Html.ValidationMessage("Address.StreetAddress") %>
                </td>
            </tr>
        </table>
        <%= Html.SubmitButton() %>
        <%
            if (ViewData["GeocodeResults"] != null) {
        %>      
            <p>
                Google maps found the following addresses that matched the address you entered.  Please select
                the appropriate address.  If none of these addresses are correct, try reentering the address
                again and be as specific as possible.
            </p>
            <ul>
                <% 
                    foreach (GeocodeResult geocodeResult in (List<GeocodeResult>)ViewData["GeocodeResults"]) { 
                %>
                        <li>
                            <%= geocodeResult.StreetAddress %>
                        </li>
                <% 
                   } 
                %>
            </ul>
        <%  
            } 
        %>
<%
    }
%> 
```

总结上面的代码，它在控制器中做了什么，它查询谷歌地图以对文本框中的地址进行地理编码（即把它变成一组经度/纬度坐标）。当 Google Maps 返回多个结果时，我将这些结果存储到 ViewData["GeocodeResults"] 中，然后它将向最终用户显示可能的地址。

现在，这可以很好地显示地址，但我真正想要的是将该列表呈现为超链接列表，以便用户可以单击适当的地址，表单将使用该地址而不是文本框。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T17:58:41.643

就像是：

```
<a href='javascript:void(0);' onclick='submitAddress(this);'>
    <%= geocodeResult.StreetAddress %></a> 
```

你在哪里

```
function submitAddress(link) {
   $('input#streetAddress:first').text(link.innerHtml);
   $('input#submit').click();
} 
```

您也可以将其放在一个隐藏字段中，这表示您不需要对该地址进行谷歌地图搜索。也就是说，如果提供了 HiddenStreetAddress，则只需使用 with 而无需查找。如果没有，请在 StreetAddress 上进行 Google 查找。如果有多个结果，则显示结果。如果没有，则使用提供的。

# javascript - 如何在 IE 中隐藏插入符号？(JavaScript)

> ID：293657
> 
> 赞同：5
> 
> 时间：2008-11-16T07:52:40.010
> 
> 标签：javascript, internet-explorer, hide, caret

在所见即所得编辑器上方显示弹出窗口时，插入符号（文本区域中的光标）在弹出窗口下仍然可见。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T08:54:18.387

First idea coming to my mind is to blur() the textarea or put the focus elsewhere. Of course, I suppose the WYSIWYG editor uses a simple textarea, not a more complex DHTML component.

# build-automation - 使用 CruiseControl.NET 进行不同类型的构建

> ID：293665
> 
> 赞同：3
> 
> 时间：2008-11-16T07:59:54.207
> 
> 标签：build-automation, cruisecontrol.net

我想知道一个人有什么样的构建（例如和学习）。

我目前设置了每晚触发更改的构建..

我应该为 ci 构建或不同的配置块使用不同的服务器吗？？？

请提供有关如何维护 CI 和每晚构建配置的想法或示例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T09:48:46.843

We use one build machine (a slightly older desktop pc at the moment, going to be in the server rack soon), with multiple project blocks in the configuration.

We have several main projects:

*   Debug (triggered automatically every hour)
*   Test(integration & unit tests) (triggered once a day)
*   Release (manually triggered, also does the integration and unit tests)

this seems to work well for our team of 12, however it would depend on your team size, release frequency and whether you do nightly builds for beta users.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T14:02:05.240

只要您为每种构建类型使用不同的工作文件夹（除非您不介意构建类型会相互覆盖），您就可以在一台服务器上有效地为每个产品拥有尽可能多的 CCNet 项目配置。

在工作中，我们的一台构建服务器构建了 4 种不同的产品，每个产品至少有 2 次构建——一个夜间构建和一个 CI 构建。我们的 CI 构建每 15 分钟触发一次更改，而夜间构建仅在发生更改时才会按计划触发。

# jquery - jQuery ajax，防止回调运行

> ID：293668
> 
> 赞同：1
> 
> 时间：2008-11-16T08:05:12.340
> 
> 标签：jquery, ajax

是否可以使用 jQuery 的 ajaxComplete 或 ajaxStop 功能来决定是否调用回调？

本质上，我希望能够采用目前在我的大多数回调中的基本错误检查代码，并将其添加到一种全局回调中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T11:13:13.020

排序答案：没有。

长答案：`ajaxComplete`和`ajaxStop`都是 jQuery AJAX 事件。您无法阻止事件的发生——“事件”没有其他意义，因为“执行每个已注册的回调函数”。无论您是否愿意，都会调用回调。

您*可以*做的是对您的回调进行编程，以便在满足（或不满足）某些要求时它不执行*任何操作。*实际上，这正是您所要求的。如果你编辑你的问题来解释你到底在做什么，人们可以告诉你如何去做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-21T03:32:36.547

我还希望能够禁用回调事件。有时您希望能够让服务器将您重定向到不同的操作。目前，这对于 jQuery ajax 调用是不可能的，因为响应必须返回到调用视图。

# c++ - 使用 c++ stl 读取大于 4GB 的文件

> ID：293672
> 
> 赞同：17
> 
> 时间：2008-11-16T08:14:23.850
> 
> 标签：c++, file-io, iostream

几周前，我使用 std::ifstream 读取一些文件，但由于文件大于 4GB，因此在打开时立即失败。当时我找不到一个体面的答案来解释为什么它被限制为 32 位文件大小，所以我使用本机 OS API 编写了自己的。

那么，我的问题是：有没有办法使用 std::ifstream/std::ostream 来处理大于 4GB 的文件（IE：标准 c++）

编辑：使用 VC 9 编译器 (Visual Studio 2008) 中的 STL 实现。EDIT2：当然必须有标准的方法来支持大于 4GB 的文件大小。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-16T09:01:18.000

显然，这取决于`off_t`库是如何实现的。

```
#include <streambuf>
__int64_t temp=std::numeric_limits<std::streamsize>::max(); 
```

给你当前的最大值是多少。

[STLport](http://stlport.sourceforge.net/)支持更大的文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-16T13:52:18.783

几年前我在 Linux 上使用 gcc 时遇到了这个问题。操作系统支持大文件，C 库（fopen 等）支持它，但 C++ 标准库不支持。我发现我必须使用正确的编译器标志重新编译 C++ 标准库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T14:41:47.483

从标准的角度来看，没有什么可以阻止这一点。然而，实际上，大多数 32 位实现都使用 32 位的`std::size_t`. 现在，C++ 标准要求 C++ 标准库中的标准分配器使用 std::size_t 作为大小量。因此，容器、字符串和内容的存储空间限制为 2^32 字节。情况可能是另一种情况`std::off_t`，我不知道那里到底发生了什么。

您必须直接使用操作系统的本机 API 或包装它的一些库才能做到这一点，而不必信任标准库实现，这些实现在很大程度上依赖于实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-03T04:15:26.140

至少在 VS2013 中，C++ 标准文件流可以很好地处理大文件（>4GBytes）。

我在 VS2013 上进行了测试（使用 update3）。

```
int64_t file_pos = 4LL * 1024 * 1024 * 1024 + 1;
file.seekp( file_pos, SEEK_SET );
assert( file );
cout << "cur pos: " << file.tellp() << endl; // the output is: 4294967297(4GB + 1) 
```

以下链接是另一个确认这是一个错误并已修复： [https ://connect.microsoft.com/VisualStudio/feedback/details/627639/std-fstream-use-32-bit-int-as-pos-在 x64 平台上输入偶数](https://connect.microsoft.com/VisualStudio/feedback/details/627639/std-fstream-use-32-bit-int-as-pos-type-even-on-x64-platform)

简称：Stephan T. Lavavej (Visual C++ Libraries Developer) 说

> 我们已经修复了它，该修复程序将在 VC11 中提供......所以现在应该可以正常支持大文件（无论 x86/x64 平台如何）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-18T13:36:31.940

如果您可以摆脱只使用标准 C++，那么您可能会对[boost::iostreams](http://www.boost.org/doc/libs/1_40_0/libs/iostreams/doc/faq.html#offsets)感兴趣。

# regex - 我对正则表达式的微调有问题

> ID：293694
> 
> 赞同：1
> 
> 时间：2008-11-16T08:45:40.323
> 
> 标签：regex, c#-2.0

我有正则表达式，这很好，但是在某些情况下它出来时效果不佳

**密切关注消息预览，因为消息编辑器使用“\”做了一些棘手的事情**

> [\[]?[\^%#\$\*@\-;].*?[\^%#\$\*@\-;][\]]

它的任务是找到通常看起来像这样的模式

> [ABA]

*   A - 字符集 ^,%,#,$,*,@,-,;
*   B - 一些文字
*   [ 和 ] 包含在模式中

预计会在测试字符串中找到此模式的所有出现

> 黑狐 [#sample1#] [%sample2%] - [#sample3#] 吃块。

但不是预期的匹配列表

*   “[#sample1#]”
*   “[%sample2%]”
*   “[#sample3#]”

我明白了

*   “[#sample1#]”
*   “[%sample2%]”
*   “- [#sample3#]”

似乎这个问题也会出现在集合“A”中的其他字符上。那么有人可以建议对我的正则表达式进行更改以使其按我的需要工作吗？

和不太重要的事情，如何让我的正则表达式排除看起来像那样的模式

> [ABC]

*   A - 字符集 ^,%,#,$,*,@,-,;
*   B - 一些文字
*   C - 字符集 ^,%,#,$,*,@,-,; **A以外的**
*   [ 和 ] 包含在模式中

例如

> [$sample1#] [%sample2@] [%sample3;]

提前致谢

第 MTH

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T09:18:34.017

```
\[([%#$*@;^-]).+?\1\]

```

应用于文本：

```
黑狐 [#sample1#] [%sample2%] - [#sample3#] [%sample4;] 吃块。

```

火柴

*   `[#sample1#]`
*   `[%sample2%]`
*   `[#sample3#]`
*   *但不是* `[%sample4;]`

编辑

这对我有用（按预期输出，按预期被 C# 接受的正则表达式）：

```
Regex re = new Regex(@"\[([%#$*@;^-]).+?\1\]");
string s = "Black fox [#sample1#] [%sample2%] - [#sample3#] [%sample4;] eats blocks.";

MatchCollection mc = re.Matches(s);
foreach (Match m in mc)
{
  Console.WriteLine(m.Value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T08:57:15.853

为什么是第一个“？” 在 ”[[]？”

```
\[[\^%#\$\*@\-;].*?[\^%#\$\*@\-;]\] 
```

会很好地检测到您的不同字符串

更准确地说：

```
\[([\^%#\$\*@\-;])([^\]]*?)(?=\1)([\^%#\$\*@\-;])\] 
```

会检测到 [ABA]

```
\[([\^%#\$\*@\-;])([^\]]*?)(?!\1)([\^%#\$\*@\-;])\] 
```

将检测 [ABC]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T09:05:07.587

您有一个可选的左方括号匹配：

[\]]？

对于你问题的第二部分（也许是为了简化），试试这个：

\[\%[^\%]+\%\]|\[\#[^\#]+\#\​​]|\[\$[^\$]+\$\]

在这种情况下，每个可能的分隔符都有一个子模式。该| 字符是“OR”，因此如果 3 个子表达式中的任何一个匹配，它将匹配。

每个子表达式将：

*   开口支架
*   特殊字符
*   所有不是特殊字符的东西 (1)
*   特殊字符
*   关闭后台

(1) 可能需要添加额外的排除项，如 ']' 或 '[' 这样它就不会意外匹配大量文本，例如：

[%MyVar#] 等等 [$OtherVar%]

抢

# asp.net - ASP.NET message box

> ID：293697
> 
> 赞同：3
> 
> 时间：2008-11-16T08:51:51.137
> 
> 标签：asp.net, messagebox

I am looking for a custom control which could enable me to call message of following type.

[http://extjs.com/deploy/dev/examples/message-box/msg-box.html](http://extjs.com/deploy/dev/examples/message-box/msg-box.html)

Is there a control which function like a .NET desktop application messagebox?

I know, exactly similar may not be possible but main features I am looking for here is returning value of clicked button and custom value entered by user in code behind.

I have also started working on it myself, but hardly any luck so far.. any direction in this case will also be very useful.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T09:11:25.887

There is a **good tutorial** which could help:

[Create MessageBox user control using ASP.NET and CSS](http://www.jankoatwarpspeed.com/post/2008/05/28/Create-MessageBox-user-control-using-ASPNET-and-CSS.aspx)

And here combining it with the **AjaxControlToolkit**:

[ASP.NET Popup Message Box User Control](http://beckelman.net/post/2008/07/15/ASPNET-Popup-Message-Box-User-Control.aspx)

*I hope this helps!*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T08:59:20.530

Have you looked at the [AJAX Toolkit](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ModalPopup/ModalPopup.aspx)? It doesn't do all the things you want, but it should be too hard to the extender and controls needed into a CustomControl and create your own DLL.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-26T07:15:31.753

通过添加对解决方案资源管理器的引用来使用命名空间“System.Windows.Forms”

# .net - 带有数据绑定控件的“无效回发或回调参数”

> ID：293699
> 
> 赞同：13
> 
> 时间：2008-11-16T08:52:52.710
> 
> 标签：.net, asp.net, gridview

当我的数据绑定控件上发生事件（添加/编辑/删除）时，我收到以下错误。

> 无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

我正在使用自定义 DataList 控件，但 GridView、DetailsView、FormView 和 Repeater 控件（可能还有其他数据绑定控件）也会出现此问题。

我能找到的答案告诉我关闭配置文件或页面中的验证，但这听起来不像是最好的解决方案。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-16T08:54:30.273

问题是在页面 Load 事件中为控件加载数据并调用 DataBind() 方法。但是，如果在引发事件之前调用 DataBind() 方法，则会在控件命名发生更改时生成上述异常。

解决方案是将其更改为 if(!IsPostback) DataBind()，然后在事件处理程序的末尾调用 DataBind() 方法。无论如何，您大部分时间都需要在处理程序结束时调用它以影响更改。

如果这不是您的问题，并且您正在使用 JavaScript 修改控件客户端，请查看[这篇文章](http://odetocode.com/Blogs/scott/archive/2006/03/21/3153.aspx)。

*这是一篇自我回答的帖子，因为我在博客上收到了很多关于这个问题的回复，我想我可能会进一步分享。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-25T18:36:21.453

这次真是万分感谢。我遇到了这个问题，你的自我回答帮助我解决了这个问题。

在每个事件处理程序结束时调用 DataBind() 方法的另一种方法是在页面 PreRender 事件中执行一次。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-16T12:23:20.517

我遇到了同样的问题，我花了几个小时才解决我的问题。罗伯特的回答部分帮助了我，尽管数据绑定了我的转发器，无论是否回发，问题仍然存在。经过大量研究后，我发现了一篇建议设置**UseSubmitBehavior="false"**，宾果游戏的帖子，它解决了这个问题。希望这会有所帮助。

# asp.net - LINQ to SQL 是构建模型或创建自己的类的最佳方式吗

> ID：293712
> 
> 赞同：2
> 
> 时间：2008-11-16T09:04:16.777
> 
> 标签：asp.net, linq, linq-to-sql, model

我正在使用 MS SQL Server 数据库在 ASP.net 中开发一个中型系统，我想知道**使用 LINQ 创建模型层或创建自己的处理数据库的类的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T09:16:39.513

最好的方法是主观的，但我认为最简单的是使用[LINQ to SQL。](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T09:19:41.393

使用 LINQ 设计器是在 UI 中构建模型的好方法，无需编写任何代码。您可以使用继承选项设置对象层次结构，还可以通过代码中的数据上下文访问关联的类。然后为您处理所有 SQL，这意味着您不必编写任何内容，只需在数据上下文上调用 SubmitChanges()。可以查看所有生成的代码，但有很多内容需要考虑。

我建议尝试使用 LINQ 属性等手动编写自己的类，以便了解它在幕后所做的事情。然后你会意识到继承和关联是如何实现的，实际上也让设计者更容易理解。

# c++ - 如何创建自定义 Windows 消息？

> ID：293723
> 
> 赞同：7
> 
> 时间：2008-11-16T09:30:44.413
> 
> 标签：c++, debugging, windows-ce

我们的项目在 Windows CE 6.0 上运行，并且是用 C++ 编写的。我们的代码有一些问题，我们无法调试。我们还发现，如果在我们的应用程序中创建线程并尝试从中**printf**，输出将不会出现。将出现的唯一输出是来自主线程的输出。我想做以下事情：

*   创建自定义窗口消息

*   使用 WPARAM 我想在屏幕上显示的 char* 的地址

*   使用 LPARAM 我想在屏幕上显示的 char* 的长度

*   发送消息

*   当它出现时处理它，以便它打印 char*

如何创建自定义窗口消息？WPARAM 和 LPARAM 有哪些类型？有可能做我刚刚写的吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T09:48:05.173

当然可以按照您的描述进行。您实际上不需要执行任何操作来为应用程序中的通信创建自定义消息：只需确保发送消息的代码和接收消息的代码就消息编号的实际含义达成一致，然后使用消息不与 Windows 使用的任何数字重叠的数字。有一个 RegisterWindowMessage() 函数，但只需要获取一个在整个操作系统中唯一的消息号，因此用于进程间通信。

实现这一点的最简单方法是在某处包含您的自定义消息编号的头文件，从 WM_USER 开始并向上编号，如下所示：

```
#define WM_FIRST_CUSTOM_MSG (WM_USER+0)
#define WM_SECOND_CUSTOM_MSG (WM_USER+1) 
```

WPARAM 和 LPARAM 类型是在包含“windows.h”时定义的，因此在不同的系统上可以有不同的类型。对于 32 位操作系统，它们通常都是 32 位整数。如果您只是将消息用于测试目的，那通常就足够了，您可以在其中粘贴您想要的任何内容。但是，对于生产代码，您应该更加小心：WPARAM 真正用于“类整数”数据，而 LPARAM 用于“类指针”数据。例如，在 Win64 中，LPARAM 的长度足以容纳 64 位指针，但 WPARAM 仅容纳 32 位整数。为了传递比整数和指针更多的数据，我会使用 lParam 将指针传递给包含我所有参数的某种结构。

说了这么多，这听起来像是一种获取调试输出的复杂方法。您是否尝试过使用 OutputDebugString() API 调用？或者调试线程的 printf() 调用？

# asp.net - 将子字符串转换为链接的正则表达式

> ID：293725
> 
> 赞同：2
> 
> 时间：2008-11-16T09:33:42.457
> 
> 标签：asp.net, vb.net, regex, string

我需要一个正则表达式来将字符串转换为链接。我写了一些东西，但它在 asp.net 中不起作用。我无法解决，我是正则表达式的新手。这个函数将 (bkz: string) 转换为 (bkz: show. aspx?td=字符串）

```
Dim pattern As String = "&lt;bkz[a-z0-9$-$&-&.-.ö-öı-ış-şç-çğ-ğü-ü\s]+)&gt;"
Dim regex As New Regex(pattern, RegexOptions.IgnoreCase)
str = regex.Replace(str, "<a href=""show.aspx?td=$1""><font color=""#CC0000"">$1</font></a>") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T10:09:34.240

对您的代码的一般评论：除了缺少左括号之外，您还做了多余的事情： $-$ 不是不正确的，但可以仅简化为 $ 。重音字符也是如此。
每个人都会告诉你，即使在纯 HTML 中也已弃用 font 标签：支持带有 style 属性的 span。

从您的问题和回复中的示例来看，我认为表达式可能类似于：

```
\(bkz: ([a-z0-9$&.öışçğü\s]+)\) 
```

替换字符串如下所示：

```
(bkz: <a href=""show.aspx?td=$1""><span style=""color: #C00"">$1</span></a>) 
```

但是第一个 $1 必须实际上是 URL 编码的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T09:41:39.837

您的正则表达式有麻烦，因为没有 '(' 的 ')'

将：

```
&lt;bkz:\s+((?:.(?!&gt;))+?.)&gt; 
```

工作得更好？

第一组将捕捉你所追求的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T09:51:38.537

感谢 Vonc，现在它不会引发错误，而且当我将 str 分配给 Label.Text 时，我也看不到链接。例如，在我将 str 绑定到我的标签后，应该在视图源中查看它；

```
<span id="Label1">(bkz: <a href="http://www.mysite.com?t=here">here</a>)</span> 
```

但是现在，它在viewsource源中；

```
<span id="Label1">(bkz: here)</span> 
```

# java - é is not correctly parsed

> ID：293728
> 
> 赞同：3
> 
> 时间：2008-11-16T09:40:39.807
> 
> 标签：java, linux, xerces, saxparser

My application will read xml from urlconnection. The xml encoding is ISO-8859-1, it contains é character. I use xerces saxparser to parse received xml content. However, é can not be parsed correctly while running application under lunix OS. Everything works fine in Windows. Could you guys please give me some hints? Thanks a lot

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T12:25:24.000

这可能是一个标记为“ISO-8859-1”的文件，而实际上它是另一种编码。

通常这种情况发生在“ISO-8859-1”和“Windows-2152”中：它们被使用得好像它们是可互换的，但它们不是。*（在对这个答案的评论中已经澄清，两种编码都同意“é”的字符代码，所以 Windows-1252 可能不是。）*

您可以使用十六进制编辑器找出文件中“é”的确切字符代码。您可以将该值作为文件编码的提示。如果您可以控制文件的生成方式，则建议查看负责的代码/方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T09:47:56.033

I bet this is related to file.encoding. Try running with -Dfile.encoding=iso-8859-1 as a VM parameter on linux.

If this works, you probably need to specify the correct format when opening the stream (somewhere in your code).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T12:57:21.000

正如 Tomalak 建议的那样，您应该做的第一件事是确定 xml 文件的真实编码，而不是标题中所述的编码。

您可以先使用 Internet Explorer 打开它。如果编码不正确，您可能会看到如下错误：

> 在文本内容中发现无效字符。错误处理资源...

或以下一个：

> 不支持从当前编码切换到指定编码。错误处理资源...

下一步是使用支持多种编码的文本编辑器。您可以使用免费、易于使用并支持多种编码的[Notepad++ 。](http://notepad-plus.sourceforge.net/es/site.htm)无论 xml 标头如何说明编码，编辑器都会尝试检测文件的编码并将其显示在状态栏上。

如果您确定文件编码是正确的，那么您可能没有正确处理 Java 中的编码。考虑到 Java 字符串是 UTF-16 并且在从/到字节数组转换时默认情况下，如果没有指定编码，Java 默认为系统编码（Windows 下的 Windows-1521 或现代 Linux 上的 UTF-8）。某些编码转换只会导致“奇怪”字符出现，例如固定 8 位编码之间的转换（即 Windows-1252 <-> ISO-8859-1）。由于无效字符，其他转换会引发编码异常（例如，尝试将 Windows-1252 文本导入为 UTF-8）。

无效代码示例如下：

```
// Parse the input
SAXParser saxParser = factory.newSAXParser();
InputStream is = new ByteArrayInputStream(stringToParse.getBytes());
saxParser.parse( is, handler ); 
```

默认情况下，转换`stringToParse.getBytes()`返回在 Windows 平台上编码为 Windows-1252 的字符串。如果在此步骤中 XML 文本以 ISO-8859-1 编码，则您的字符有误。正确的步骤应该是将 XML 读取为字节而不是字符串，并让 SAX 管理 xml 编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T20:24:05.873

如果 XML 声明未指定编码，则 sax 解析器将尝试使用默认编码 UTF-8。

如果您知道字符编码但未在 XML 声明中指定，则可以告诉解析器将该编码与 InputSource 一起使用：

```
InputSource inputSource = new InputSource(xmlInputStream);
inputSource.setEncoding("ISO-8859-1"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T15:31:42.807

抱歉这么晚才回复。我们解决了这个问题。我们对输入流做了一些错误的操作（正如 Fernando Miguélez 所说，转换导致了问题）。

感谢大家的帮助。

# javascript - Making a drop-down list using scriptaculous and prototype's BlindDown or SlideDown effect

> ID：293735
> 
> 赞同：2
> 
> 时间：2008-11-16T09:54:02.260
> 
> 标签：javascript, css, prototypejs, scriptaculous

I'm trying to make a javascript dropdown list using scriptaculous and prototype. I know this can be done using CSS :hover pseudo-selectors, but I would like to add some additional flair to it. The problem is that while I can kind of get the dropdown/up effect working, it seems very flaky. Is there a simple way to do this, or should I stick to the hovers? Here is the CSS I'm using.

```
<style type="text/css">
ul {list-style-type: none}

#navbar>li {
 position: relative;
 float: left;
 padding-right: 20px;
 height: 2em;
 background-color: #002;
}

ul.dropdown {
 display: block;
 position: absolute;
 top: 2em;
 left: 0px;
 background-color: #00c;
}
</style> 
```

And here is the html (I added the style="display: none" per the documentatoin, which said to put it there instead of in a stylesheet if you want the target to initially be hidden).

```
<ul id="navbar">
  <li
    onmouseover="Effect.BlindDown('dropdownone', { duration: 0.8 })"
    onmouseover="Effect.BlindUp('dropdownone', { duration: 0.8 })"><a href="">Menu Link 1</a>
    <ul id="dropdownone" class="dropdown" style="display: none">
      <li>Drop Down Link 1</li>
      <li>Drop Down Link 2</li>
      <li>Drop Down Link 3</li>
    </ul>
  </li>
  <li><a href="">Menu Link 2</a>
    <ul id="dropdowntwo" class="dropdown">
      <li>Drop Down Link 1</li>
      <li>Drop Down Link 2</li>
      <li>Drop Down Link 3</li>
      <li>Drop Down Link 4</li>
      <li>Drop Down Link 5</li>
    </ul>
  </li>
  <li><a href="">Menu Link 3</a>
    <ul id="dropdownthree" class="dropdown">
      <li>Drop Down Link 1</li>
      <li>Drop Down Link 2</li>
    </ul>
  </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T11:35:40.697

这种效果似乎适用[于“onclick”事件](http://www.java2s.com/Code/JavaScriptDemo/TextBlindUpandBlindDown.htm)

但是使用 onmouseover，[我读到](http://osdir.com/ml/lang.ruby.rails.spinoffs/2006-06/msg00358.html)您需要使用效果[队列](http://www.clientcide.com/3rd-party-libraries/scriptactulous/scriptaculous-and-its-effectqueue/)，这样您的盲上和盲下就不会互相踩踏，就像[在这个脚本](https://stackoverflow.com/questions/49630/problems-with-mouseout-event)中一样。

> 队列是事件列表（在当前上下文中的效果）。这些事件一个接一个（或并行）发生，目的是防止干扰当前的动作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T18:39:55.350

队列似乎没有帮助。在尝试了一个多小时不同的东西后，我将放弃并坚持使用简单的悬停菜单。这很有趣，因为我认为这是这些库应该简化的那种基本的 UI 增强效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T23:39:14.543

BlindDown 可以是这样的：

onmouseover="if($('dropdownone').style.display=='none') { Effect.BlindDown('dropdownone', { duration: 0.8 }) }"

我正在为“onmouseout”事件开发 BlindUp，但似乎无法使其正常工作。:(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T01:53:09.283

使用：**Effect.toggle('id_of_element', 'blind', { duration: 2.0 });**

headfirstproductions.ca/prototype-and-scriptaculous-drop-down-menu

# php - 多个关键字搜索脚本需要一些专家输入

> ID：293743
> 
> 赞同：0
> 
> 时间：2008-11-16T10:03:30.963
> 
> 标签：php, mysql, search, keyword

我一直在根据本教程编写关键字搜索脚本： [http ://www.hackosis.com/2007/11/06/howto-simple-search-engine-with-php-and-mysql/](http://www.hackosis.com/2007/11/06/howto-simple-search-engine-with-php-and-mysql/)

就像提到的一些评论者一样，该脚本最终只会根据搜索词中的最后一个词返回结果。所以我也尝试过实现另一个用户的建议之一，但现在我似乎只能根据第一个搜索词获得结果。

我的脚本的代码可以在这里找到：http: [//php.pastebin.com/m7759afd3](http://php.pastebin.com/m7759afd3)

我的 print_r 结果如下所示：

```
SELECT * FROM blog WHERE blog_title LIKE '%barry%' OR blog_content LIKE '%barry%' AND blog_title LIKE '%child%' OR blog_content LIKE '%child%' AND blog_title LIKE '%help%' OR blog_content LIKE '%help%' ORDER BY blog_title

SELECT * FROM links WHERE link_title LIKE '%barry%' OR link_desc LIKE '%barry%' AND link_title LIKE '%child%' OR link_desc LIKE '%child%' AND link_title LIKE '%help%' OR link_desc LIKE '%help%' ORDER BY link_title

SELECT * FROM pages WHERE page_title LIKE '%barry%' OR page_content LIKE '%barry%' AND page_title LIKE '%child%' OR page_content LIKE '%child%' AND page_title LIKE '%help%' OR page_content LIKE '%help%' ORDER BY page_title 
```

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T10:18:44.427

如果要返回包含**任何关键字的**结果，请将所有**AND**替换为**OR**。

如果您这样做，那么您的数据库将检查表的任何列中是否存在任何关键字。

因此，您的最终查询将由数据库服务器读取，如下所示：

```
SELECT * FROM blog WHERE blog_title LIKE '%barry%' OR blog_content LIKE '%barry%' OR blog_title LIKE '%child%' OR blog_content LIKE '%child%' OR blog_title LIKE '%help%' OR blog_content LIKE '%help%' ORDER BY blog_title 
```

并且应该返回在任何列 ( ) 中具有关键字 (barry、child、help) 的所有记录`blog_title, blog_content`。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T12:21:29.047

AND 运算符的优先级高于 OR，因此如果要返回包含**所有关键字的**结果，则需要添加括号，如下所示：

```
 SELECT * FROM blog
  WHERE (blog_title LIKE '%barry%' OR blog_content LIKE '%barry%')
    AND (blog_title LIKE '%child%' OR blog_content LIKE '%child%')
    AND (blog_title LIKE '%help%' OR blog_content LIKE '%help%')
  ORDER BY blog_title 
```

# c++ - How could I know when someone attaches a removable disk on my computer?

> ID：293747
> 
> 赞同：4
> 
> 时间：2008-11-16T10:10:34.177
> 
> 标签：c++, windows-xp, detect, removable-storage

I would like to know how can I detect when the user attaches a removable drive on a computer ( in a Windows XP environment ) . There surely has to be a better way than constantly checking to see if the number of drives increased , right ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-06-11T04:15:39.943

由于不太可能有人会回答，所以我将尽我所能将人类的知识反向链接起来。

[这个线程](https://stackoverflow.com/questions/1783657/get-notification-when-a-new-drive-is-connected-via-usb-or-other-means-c)似乎引用了几种不同的方式：

1.  [WM_DEVICECHANGE 消息](https://docs.microsoft.com/en-us/windows/win32/devio/wm-devicechange?redirectedfrom=MSDN)
2.  [创建 Windows 服务](https://www.codeproject.com/Articles/18062/Detecting-USB-Drive-Removal-in-a-C-Program)

# javascript - jQuery-ui 滑块 - 如何阻止两个滑块相互控制

> ID：293750
> 
> 赞同：3
> 
> 时间：2008-11-16T10:14:27.227
> 
> 标签：javascript, jquery, jquery-ui, slider, jquery-ui-slider

这是参考之前提出的[问题](https://stackoverflow.com/questions/282944/jquery-one-slider-controls-another)

这里的问题是，每个`slider`控制另一个。它会产生反馈。

我怎么可能阻止它？

```
$(function() {
    $("#slider").slider({ slide: moveSlider2 });
    $("#slider1").slider({ slide: moveSlider1 });
    function moveSlider2( e, ui ) 
    {
        $('#slider1').slider( 'moveTo', Math.round(ui.value) );
    }

    function moveSlider1( e, ui ) 
    {
        $('#slider').slider( 'moveTo', Math.round(ui.value) );
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T11:51:17.813

这有点像黑客，但有效：

```
$(function () {
    var slider = $("#slider");
    var slider1 = $("#slider1");
    var sliderHandle = $("#slider").find('.ui-slider-handle');
    var slider1Handle = $("#slider1").find('.ui-slider-handle');

    slider.slider({ slide: moveSlider1 });
    slider1.slider({ slide: moveSlider });

    function moveSlider( e, ui ) {
        sliderHandle.css('left', slider1Handle.css('left'));
    }

    function moveSlider1( e, ui ) {
        slider1Handle.css('left', sliderHandle.css('left'));
    }
}); 
```

基本上，您可以通过直接操作 css 来避免反馈，而不是触发幻灯片事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T10:21:06.323

你可以存储一个 var CurrentSlider = 'slider';

在任一滑块上的 mousedown 上，将 CurrentSlider 值设置为该滑块，

并在您的 moveSlider(...) 方法中检查这是否是 CurrentSlider，如果不是，则不传播滑动（避免反馈）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T12:16:12.707

您可以只为您的`moveSlider1`和`moveSlider2`函数提供一个可选参数，当设置为真值时，它会抑制递归。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-22T06:06:18.397

一种更简单的方法，它是上述答案的混合体：

```
 var s1 = true;
    var s2 = true;
    $('#slider').slider({
        handle: '.slider_handle',
        min: -100,
        max: 100,
        start: function(e, ui) {
        },
        stop: function(e, ui) { 
        },
        slide: function(e, ui) {
            if(s1)
            {
                s2 = false;
                $('#slider1').slider("moveTo", ui.value);
                s2 = true;
            }
        }
    });

    $("#slider1").slider({ 
        min: -100, 
        max: 100,
        start: function(e, ui) {
        },
        stop: function(e, ui) { 
        },
        slide: function(e, ui) {
            if(s2)
            {
                s1 = false;
                $('#slider').slider("moveTo", ui.value);
                s1 = true;
            }
        }
        });

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-12T06:34:46.297

现在尝试了这个，所有答案都可能由于 jquery ui 的更改而不起作用。

如果您更换，Badri 的解决方案将有效

```
$('#slider').slider("moveTo", ui.value); 
```

和

```
$('#slider').slider("option", "value", ui.value); 
```

# c# - 在 C# 中，如何在不破坏编码的情况下将网页保存到文件中？

> ID：293760
> 
> 赞同：4
> 
> 时间：2008-11-16T10:23:11.907
> 
> 标签：c#, encoding

这是我到目前为止得到的（这不起作用）。在这一点上，我认为我的目标是 Ansi 编码的，但我真的不想在这一点上知道。我的浏览器似乎能够确定使用什么编码，我该怎么做？

```
static void GetUrl(Uri uri, string localFileName)
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
    HttpWebResponse response;

    response = (HttpWebResponse)request.GetResponse();

    // Save the stream to file
    Stream responseStream = response.GetResponseStream();
    StreamReader reader = new StreamReader(responseStream, Encoding.Default);
    Stream fileStream = File.OpenWrite(localFileName);
    using (StreamWriter sw = new StreamWriter(fileStream, Encoding.Default))
    {
        sw.Write(reader.ReadToEnd());
        sw.Flush();
        sw.Close();
     }
} 
```

* * *

**回答后**（目前仅在 UTF-8 站点上测试）：

```
static void GetUrl(Uri uri, string localFileName)
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
    try
    {
        // Hope GetEncoding() knows how to parse the CharacterSet
        Encoding encoding = Encoding.GetEncoding(response.CharacterSet);
        StreamReader reader = new StreamReader(response.GetResponseStream(), encoding);
        using (StreamWriter sw = new StreamWriter(localFileName, false, encoding))
        {
            sw.Write(reader.ReadToEnd());
            sw.Flush();
            sw.Close();
        }
    }
    finally
    {
        response.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T10:30:07.930

网络浏览器可以通过三种方式尝试检测字符编码。

查找（如果是 HTML）：

```
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII"> 
```

或（对于 XHTML）

```
<?xml version="1.0" encoding="ISO-8859-1"?> 
```

有时甚至在 http 标头中指定

```
Content-Type: text/html; charset=ISO-8859-1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T10:53:39.037

您应该寻找服务器发送响应的编码。`Encoding.Default`这里没有减少芥末。:-)

```
Stream responseStream = response.GetResponseStream();
Encoding enc = Encoding.GetEncoding(response.CharacterSet);
StreamReader reader = new StreamReader(responseStream, enc);
Stream fileStream = File.OpenWrite(localFileName);
using (StreamWriter sw = new StreamWriter(fileStream, enc))
{  /* ... */ } 
```

可以肯定的是，您可以将所有内容都转换为 UTF-8 并将您的文件始终存储为 UTF-8。这样，您在读取文件时就无需猜测编码。

# emacs - 如何让 Emacs 显示空格？

> ID：293761
> 
> 赞同：69
> 
> 时间：2008-11-16T10:26:22.990
> 
> 标签：emacs, whitespace

如何让 Emacs 显示空格（如空格、制表符、换行符等）。许多其他编辑器，如 Kate 和 Eclipse 都具有此功能，我发现查看代码何时因空格和制表符（尤其是 Python）的混合而出现缩进非常有用。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-16T11:30:16.403

[WhiteSpace](https://www.emacswiki.org/emacs/WhiteSpace)模式是 Emacs 次要模式，用于可视化当前缓冲区中的所有空白字符。它可以用 激活`M-x whitespace-mode`。

这是直接取自 Emacs wiki 的 WhiteSpace 的截图，

[![空白模式在行动](https://i.stack.imgur.com/M45cG.png)](https://i.stack.imgur.com/M45cG.png)

注意：WhiteSpaceMode 现在已经取代了 BlankMode

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-16T10:30:28.693

[此处（空白模式）](http://www.emacswiki.org/emacs/BlankMode)和此处[和此处（ShowWhiteSpace）](http://www.emacswiki.org/emacs/ShowWhiteSpace)似乎总结了所有可能的设置

还：

```
(if (>= emacs-major-version 22)
  (progn
    ;; Mode to use with Emacs 22
    ;; http://emacswiki.org/cgi-bin/wiki/BlankMode
    (require 'blank-mode)
    ;; Mode not active by default: let's activate it
    (global-blank-mode t)
    ;; ... activate it when text mode where color syntax is not active by default
    (add-hook 'text-mode-hook 'blank-mode-on)
    ;; All invisible chars are shown, except newline char.
    (setq blank-chars '(tabs spaces trailing lines space-before-tab))
    ;; Show only for one color, no mark inserted
    (setq blank-style '(color))
    ;; Use for normal space (not shown)
    (set-face-background 'blank-space-face nil)
    (set-face-foreground 'blank-space-face "black")
    ;; used for non breakable space
    (set-face-background 'blank-hspace-face "PaleGreen")
    (set-face-foreground 'blank-hspace-face "black")
    ;; Used for spaces left of a tab
    (set-face-background 'blank-space-before-tab-face "orange")
    (set-face-foreground 'blank-space-before-tab-face "black")
    ;; Used for tab
    (set-face-background 'blank-tab-face "lemonchiffon")
    (set-face-foreground 'blank-tab-face "black")
    ;; used for extra space at the end of a line
    (set-face-background 'blank-trailing-face "gold")
    (set-face-foreground 'blank-trailing-face "black")
    ;; Used for line too long
    (set-face-background 'blank-line-face "snow2")
    (set-face-foreground 'blank-line-face "black")
  )
  (progn
    ;; For older Emacs prior to version 22.
    ;; http://www.emacswiki.org/cgi-bin/wiki/show-wspace.el
    (require 'show-wspace)
    (add-hook 'font-lock-mode-hook 'show-ws-highlight-tabs)
    (add-hook 'font-lock-mode-hook 'show-ws-highlight-hard-spaces)
    (add-hook 'font-lock-mode-hook 'show-ws-highlight-trailing-whitespace)
  )
) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-16T22:20:07.807

缩进破坏？- 永远不要在代码中使用标签 - 现在磁盘空间很便宜。

放入`(setq-default indent-tabs-mode nil)`您的 .emacs 文件。习惯于键入`C-x h M-x untabify`以取消整个缓冲区的制表符。要搜索标签类型`C-s C-i`。如果缓冲区中有模糊的控制字符，可以使用`M-x hexl-mode`.

也`C-x h M-x indent-region`将缩进整个缓冲区。某些模式（如 vhdl-mode）具有美化区域命令。

# java - How to add ChartFrame (JFreeChart library) to JFrame(javax.swing library)?

> ID：293762
> 
> 赞同：2
> 
> 时间：2008-11-16T10:29:29.677
> 
> 标签：java, jfreechart

I can't directly add ChartFrame object to my Jframe object with .add(Component) method. And it's not possible to cast from ChartFrame to JComponent. Casting ChartFrame to Component from java.awt library is also impossible.

How can I add ChartFrame to JFrame the other way?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T12:54:46.793

ChartFrame 是一个独立的 JFrame，适合作为一个独立的窗口。如果您想将其用作组件，ChartPanel 可能是更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T10:43:00.400

这意味着在另一个 JFrame 中插入一个 JFrame。

一个可能的解决方案是使用[JDesktopPane](http://java.sun.com/docs/books/tutorial/uiswing/components/internalframe.html)

```
JDesktopPane desktop = ...
JFrame frame = ...

frame.setContentPane(desktop);

JInternalFrame internalFrame = ...
desktop.add(internalFrame); 
```

# version-control - 如何将补丁发送给其他开发人员并避免合并冲突？

> ID：293768
> 
> 赞同：14
> 
> 时间：2008-11-16T10:37:00.193
> 
> 标签：version-control, patch, platform-agnostic

如何从提交中获取补丁以将其发送给其他开发人员？在以后合并我们的树时，如何最好地避免与此补丁的合并冲突？

如果你知道如何请解释如何在你选择的 VCS 中执行此操作，例如 subversion、git、Mercurial、bzr 等。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-16T14:22:59.707

在[git](http://git.or.cz/)中，您可以像这样通过管道输出[`git-diff`](http://git-scm.com/docs/git-diff)两个提交之间的输出：

```
git diff fa1afe1 deadbeef > patch.diff 
```

将其发送`patch.diff`给开发人员并让他[`git-apply`](http://www.kernel.org/pub/software/scm/git/docs/git-apply.html)将其发送到他的工作区，如下所示：

```
git apply patch.diff 
```

如果其他开发人员已经在他的存储库中拥有可用的提交，他总是可以在自己的管道中使用它，而无需像这样合并：

```
git apply < git diff fa1afe1 deadbeef 
```

然后，您可以[按通常的方式在 diff 中](http://www.kernel.org/pub/software/scm/git/docs/everyday.html)[添加](http://www.kernel.org/pub/software/scm/git/docs/git-add.html)和[提交](http://www.kernel.org/pub/software/scm/git/docs/git-commit.html)更改。

* * *

现在，当您必须将补丁合并回主分支（即公共分支）时，有趣的部分就来了。考虑以下修订树，主分支中`C*`应用的补丁在哪里：`C`

```
A---B---C---D          master, public/master
     \
      E---C*---F       feature_foo 
```

您可以使用它的上游头来[`git-rebase`](http://git-scm.com/docs/git-rebase)更新主题分支（在此示例中名为）。`feature_foo`这意味着当您输入以下内容时：

```
git rebase master feature_foo 
```

Git 将像这样重新排列修订树，并且还会应用补丁本身：

```
A---B---C---D          master, public/master
             \
              E*---F*  feature_foo 
```

合并到上游分支现在将是一个简单的快进合并。还要检查新的提交并分别作为以前的提交`E*`和工作。`F*``E``F`

您可以使用相同的步骤对另一个开发人员的分支执行相同的操作，但不是在公共存储库中执行此操作，而是从开发人员的存储库中[获取](http://www.kernel.org/pub/software/scm/git/docs/git-fetch.html)修订。这样一来，您就不必向其他开发人员询问补丁是否已经从他在他的存储库中发布的内容中获得。

请注意**永远不要对公共分支进行变基，**因为该命令将重写 git 历史记录，这是您不想在人们依赖的分支上执行的操作，并且在合并到远程存储库时会造成混乱。也永远不要忘记[经常集成](http://en.wikipedia.org/wiki/Continuous_Integration)，以便团队中的其他人可以参与您的更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T11:40:54.417

在 SVN 中，您可以简单地进行更改，然后在提交之前，将 svn diff 的输出通过管道传输到这样的文件

```
svn diff > mypatch.diff 
```

然后，您可以恢复您的更改并在以后使用

```
patch -p0 -i mypatch.diff 
```

与往常一样，不要盲目地将补丁应用于您的代码并始终首先检查它们。

如果源文件在使用补丁后发生了足够大的变化，您可能还会发现补丁会破坏您的源代码。

您也无法保证在尝试签入代码时不会发生合并冲突。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T16:53:10.840

Bzr 处理发送“合并指令”，这意味着它会为您发送补丁，以便对方可以简单地单击“确定”进行**合并**，并且补丁/应用等操作更少。

只是： $ bzr 发送 -o mycode.patch

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T19:25:44.523

在 Subversion 中没有很好的方法可以做到这一点。是的，您可以使用 svn diff + patch 但这只会将您的问题推迟到您要合并之前，然后您很可能已经忘记了它。

您在 Subversion 中执行此操作的方式是创建一个分支，在该分支上进行提交，并要求补丁的接收者切换到该分支。然后您可以以通常的方式将分支合并回主干。

# c++ - 如何创建一个以 HWND 为父的 QWidget？

> ID：293774
> 
> 赞同：9
> 
> 时间：2008-11-16T10:47:11.250
> 
> 标签：c++, windows, qt, wxwidgets

使用 wxWidgets 我使用以下代码：

```
HWND main_window = ...
...
wxWindow *w = new wxWindow();
wxWindow *window = w->CreateWindowFromHWND(0, (WXHWND) main_window); 
```

我如何在 Qt 中做同样的事情？这`HWND`是我想要作为新 QtWidget 的父窗口的窗口的句柄。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-16T11:06:06.233

使用 QWidget 的 create 方法。

```
HWND main_window = ...
...
QWidget *w = new QWidget();
w->create((WinId)main_window); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T11:00:03.033

您是否尝试过[Qt/MFC 迁移框架](http://doc.qt.digia.com/solutions/qtwinmigrate/)[`QWinWidget`](http://doc.qt.digia.com/solutions/qtwinmigrate/qwinwidget.html)中的类？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-12T17:43:23.327

fromWinId 怎么样[https://doc-snapshots.qt.io/qt6-dev/qwindow.html#fromWinId](https://doc-snapshots.qt.io/qt6-dev/qwindow.html#fromWinId)

创建由另一个进程或使用 Qt 下面的本机库创建的窗口的本地表示。

# .net - 一个正式的应用框架是不是太多了？

> ID：293776
> 
> 赞同：0
> 
> 时间：2008-11-16T10:55:58.080
> 
> 标签：.net, frameworks, csla

我们的商店为各种垂直行业设计和创建定制软件应用程序。我们目前在大部分开发中使用[Csla](http://www.lhotka.net/)框架的修改版本。

这是一个**很棒的框架**，支持多种方式与数据库通信，直接、远程、WCF 等。它提供了大量功能，其中许多我们不使用。该框架的优点很多，其中最重要的是 Rockford Lhotka 在**新**技术方面领先一步，这意味着我们不必进行研究。该框架的缺点是，您受制于创建者如何实现更改和技术以及您不使用的所有许多功能。

随着 Linq-to-Sql 的出现，我们正在认真考虑进行切换，授予很多生成的纯数据访问权限，但通过创建部分类，我们可以扩展数据访问权限并提供业务逻辑。我们还可以创建一些正式的接口来处理业务逻辑。可以使用/创建我们的规则管理器，等等。简而言之，我们将发展自己的应用程序框架。

我注意到[Jeff Atwood 在 PDC 2008 上讨论 ASP.NET MVC 框架时](http://haacked.com/archive/2008/11/07/haackoverflow-vs-stackoverflow.aspx)，他主要处理单个项目，而且**看起来**他正在使用部分类扩展 Linq-to-Sql。这种架构**似乎**证明了这样一个事实：代码易于维护，新功能可以快速添加，错误可以快速修复，并且性能良好……大多数时候。

我只是好奇其他用户的想法是什么？我是否因为我认为**更容易**使用和更易于**维护**的东西而放弃我们的框架而疯狂？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T14:18:33.117

> 该框架的缺点是，您受制于创建者如何实现更改和技术以及您不使用的所有许多功能。

使用 LINQ 时，您似乎会遇到这些相同的缺点，因此在进行更改时请记住这一点。在任何情况下，您都应该在进行这样的飞跃之前进行完整的分析，也许通过移植一个较小的现有应用程序或其中一个应用程序的子集作为案例研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T00:34:37.023

我阅读了 Rick Strahl 的一篇很好的博客，名为[A Simple Business Object Wrapper for LINQ to SQL](http://www.west-wind.com/WebLog/posts/160237.aspx)，它回答了我的一些问题。他花了一些时间解释了他对框架的看法。

# windows - CMD shell 中的可用空间

> ID：293780
> 
> 赞同：113
> 
> 时间：2008-11-16T11:04:33.833
> 
> 标签：windows, cmd

有没有办法在不安装一些第三方应用程序的情况下获得 CMD 中磁盘或文件夹的可用磁盘空间量？

我有一个将大文件复制到给定目录的 CMD，当然可以使用复制命令返回的错误级别，但是我必须等待复制文件所需的时间（例如......然后磁盘已满，复制操作失败）。

在我开始复制之前，我想知道它是否有任何想法。尝试了 Sysinternals 的 DU.EXE 实用程序，但只显示占用空间。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-11-16T11:09:19.440

如果您运行“ `dir c:\`”，最后一行将为您提供可用磁盘空间。

**编辑：** 更好的解决方案：“ `fsutil volume diskfree c:`”

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-11-16T11:11:54.553

一个可能的解决方案：

```
dir|find "bytes free" 
```

一个更“[高级的解决方案](http://www.robvanderwoude.com/ntadmincommands.html#Cmd17)”，适用于 Windows Xp 及更高版本：

```
wmic /node:"%COMPUTERNAME%" LogicalDisk Where DriveType="3" Get DeviceID,FreeSpace|find /I "c:" 
```

[Windows Management Instrumentation 命令行](http://windowswideopen.com/blog/how_do_i_use_wmic_to_gather_windows_2003_and_windows_xp_system_information/)(WMIC) 工具 (Wmic.exe) 可以收集有关 Windows Server 2003 以及 Windows XP 或 Vista 的大量信息。该工具使用 Windows Management Instrumentation (WMI) 访问底层硬件。不适用于 Windows 2000。

* * *

正如[Alexander Stohr](https://stackoverflow.com/users/3423146/alexander-stohr) [在评论中](https://stackoverflow.com/questions/293780/free-space-in-a-cmd-shell/293785#comment107413214_293785)指出的那样：

*   WMIC 也可以查看基于策略的限制。（即使 ' `dir`' 仍然可以完成这项工作），
*   ' `dir`' 取决于语言环境。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-02-02T15:55:12.307

使用此命令，您可以找到所有分区、大小和可用空间：`wmic logicaldisk get size, freespace, caption`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-06-06T23:10:28.737

您可以通过在 DIR 命令上使用 /-C 来避免逗号。

```
FOR /F "usebackq tokens=3" %%s IN (`DIR C:\ /-C /-O /W`) DO (
    SET FREE_SPACE=%%s
)
ECHO FREE_SPACE is %FREE_SPACE% 
```

如果要将可用空间与所需空间进行比较，可以执行以下操作。我用千位分隔符指定了数字，然后删除了它们。没有逗号很难掌握数字。SET /A 很好，但它停止处理大量数字。

```
SET EXITCODE=0
SET NEEDED=100,000,000
SET NEEDED=%NEEDED:,=%

IF %FREE_SPACE% LSS %NEEDED% (
    ECHO Not enough.
    SET EXITCODE=1
)
EXIT /B %EXITCODE% 
```

**更新：**

自 2014 年以来发生了很大变化。这是一个更好的答案。它使用在所有当前支持的 Microsoft Windows 系统上都可用的 PowerShell。

如果脚本是用 PowerShell 编写的，而不使用 cmd.exe 作为包装器，下面的代码会更清晰、更容易理解。如果您使用的是 PowerShell Core，请更改`powershell`为`pwsh`.

```
SET "NEEDED=100,000,000"
SET "NEEDED=%NEEDED:,=%"

powershell -NoLogo -NoProfile -Command ^
    $Free = (Get-PSDrive -Name 'C').Free; ^
    if ($Free -lt [int64]%NEEDED%) { exit $true } else { exit $false }
IF ERRORLEVEL 1 (
    ECHO "Not enough disk space available."
) else (
    ECHO "Available disk space is adequate."
) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-16T13:02:52.643

## 文件

显示所有磁盘；总容量、已用容量和可用容量。您可以通过各种命令行选项更改输出。

您可以从[http://www.paulsadowski.com/WSH/cmdprogs.htm、http://unxutils.sourceforge.net/](http://www.paulsadowski.com/WSH/cmdprogs.htm)或其他[地方](http://unxutils.sourceforge.net/)获得它。这是一个标准的unix-util，比如du。

`df -h`将显示所有驱动器的已用和可用磁盘空间。例如：

```
M:\>df -h
Filesystem      Size  Used Avail Use% Mounted on
C:/cygwin/bin   932G   78G  855G   9% /usr/bin
C:/cygwin/lib   932G   78G  855G   9% /usr/lib
C:/cygwin       932G   78G  855G   9% /
C:              932G   78G  855G   9% /cygdrive/c
E:              1.9T  1.3T  621G  67% /cygdrive/e
F:              1.9T  201G  1.7T  11% /cygdrive/f
H:              1.5T  524G  938G  36% /cygdrive/h
M:              1.5T  524G  938G  36% /cygdrive/m
P:               98G   67G   31G  69% /cygdrive/p
R:               98G   14G   84G  15% /cygdrive/r 
```

Cygwin 可从以下网址免费获得：[https](https://www.cygwin.com/) ://www.cygwin.com/ 它为命令提示符添加了许多强大的工具。要获得驱动器 M 上的可用空间（如在 Windows 中映射到共享驱动器），可以输入：

```
M:\>df -h | grep M: | awk '{print $4}' 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-09-05T07:26:08.690

以下脚本将为您提供驱动器上的空闲字节：

```
@setlocal enableextensions enabledelayedexpansion
@echo off
for /f "tokens=3" %%a in ('dir c:\') do (
    set bytesfree=%%a
)
set bytesfree=%bytesfree:,=%
echo %bytesfree%
endlocal && set bytesfree=%bytesfree% 
```

请注意，这取决于`dir`命令的输出，它需要包含 format 的可用空间的最后一行`24 Dir(s) 34,071,691,264 bytes free`。具体来说：

*   它必须是最后一行（或者您可以修改`for`循环以显式检测该行，而不是依赖于`bytesfree`每一行的设置）。
*   可用空间必须是第三个“单词”（或者您可以更改该`tokens=`位以获得不同的单词）。
*   千位分隔符是`,`字符（或者您可以将替换从逗号更改为其他内容）。

它不会污染您的环境名称空间，仅`bytesfree`在退出时设置变量。如果您的`dir`输出不同（例如，不同的区域设置或语言设置），您将需要调整脚本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-03T13:47:04.550

使用[paxdiablo](https://stackoverflow.com/users/14860/paxdiablo)出色的解决方案，我编写了一个更复杂的批处理脚本，它使用驱动器号作为传入参数，并检查驱动器是否以一种棘手（但不美观）的方式存在：

```
@echo off
setlocal enableextensions enabledelayedexpansion
set chkfile=drivechk.tmp
if "%1" == "" goto :usage
set drive=%1
set drive=%drive:\=%
set drive=%drive::=%
dir %drive%:>nul 2>%chkfile%
for %%? in (%chkfile%) do (
  set chksize=%%~z?
)
if %chksize% neq 0 (
  more %chkfile%
  del %chkfile%
  goto :eof
)
del %chkfile%
for /f "tokens=3" %%a in ('dir %drive%:\') do (
  set bytesfree=%%a
)
set bytesfree=%bytesfree:,=%
echo %bytesfree% byte(s) free on volume %drive%:
endlocal

goto :eof
:usage
  echo.
  echo   usage: freedisk ^<driveletter^> (eg.: freedisk c) 
```

注意1：您可以键入简单的字母（例如x）或可以使用x：或x：\格式作为参数中的驱动器号

注意2：仅当大小大于 0 时，脚本才会显示来自 %chkfile% 的 stderr

注意3：我将此脚本保存为freedisk.cmd（请参阅用法）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-04T00:25:15.843

我做了一个变体以从脚本中生成它：

`volume C: - 49 GB total space / 29512314880 byte(s) free`

我使用**diskpart**来获取此信息。

```
@echo off
setlocal enableextensions enabledelayedexpansion
set chkfile=drivechk.tmp
if "%1" == "" goto :usage
set drive=%1
set drive=%drive:\=%
set drive=%drive::=%
dir %drive%:>nul 2>%chkfile%
for %%? in (%chkfile%) do (
  set chksize=%%~z?
)
if %chksize% neq 0 (
  more %chkfile%
  del %chkfile%
  goto :eof
)
del %chkfile%
echo list volume | diskpart | find /I " %drive% " >%chkfile%
for /f "tokens=6" %%a in ('type %chkfile%' ) do (
    set dsksz=%%a
)
for /f "tokens=7" %%a in ('type %chkfile%' ) do (
    set dskunit=%%a
)
del %chkfile%
for /f "tokens=3" %%a in ('dir %drive%:\') do (
  set bytesfree=%%a
)
set bytesfree=%bytesfree:,=%
echo volume %drive%: - %dsksz% %dskunit% total space / %bytesfree% byte(s) free
endlocal

goto :eof
:usage
  echo.
  echo   usage: freedisk ^<driveletter^> (eg.: freedisk c) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-16T11:19:24.740

cscript 是第三方应用程序吗？我建议尝试[Microsoft Scripting](http://www.microsoft.com/technet/scriptcenter/default.mspx)，您可以在其中使用编程语言（JScript、VBS）来检查诸如[List Available Disk Space 之](http://www.microsoft.com/technet/scriptcenter/scripts/storage/disks/drives/stdvvb10.mspx?mfr=true)类的内容。

所有当前的 Windows 版本（包括 2008）都存在脚本基础结构。

# asp.net - 如何将 Castle Windsor 与 ASP.Net Web 表单一起使用？

> ID：293790
> 
> 赞同：33
> 
> 时间：2008-11-16T11:20:11.277
> 
> 标签：asp.net, inversion-of-control, castle-windsor

我正在尝试将 Windsor 的依赖注入连接到标准的 asp.net 网络表单。我想我已经使用 HttpModule 和 CustomAttribute（代码如下所示）实现了这一点，尽管该解决方案似乎有点笨拙，并且想知道 Windsor 是否有更好的现成支持解决方案？

这里有几个文件一起显示

```
 // index.aspx.cs
    public partial class IndexPage : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Logger.Write("page loading");
        }

        [Inject]
        public ILogger Logger { get; set; }
    }

    // WindsorHttpModule.cs
    public class WindsorHttpModule : IHttpModule
    {
        private HttpApplication _application;
        private IoCProvider _iocProvider;

        public void Init(HttpApplication context)
        {
            _application = context;
            _iocProvider = context as IoCProvider;

            if(_iocProvider == null)
            {
                throw new InvalidOperationException("Application must implement IoCProvider");
            }

            _application.PreRequestHandlerExecute += InitiateWindsor;
        }

        private void InitiateWindsor(object sender, System.EventArgs e)
        {
            Page currentPage = _application.Context.CurrentHandler as Page;
            if(currentPage != null)
            {
                InjectPropertiesOn(currentPage);
                currentPage.InitComplete += delegate { InjectUserControls(currentPage); };
            }
        }

        private void InjectUserControls(Control parent)
        {
            if(parent.Controls != null)
            {
                foreach (Control control in parent.Controls)
                {
                    if(control is UserControl)
                    {
                        InjectPropertiesOn(control);
                    }
                    InjectUserControls(control);
                }
            }
        }

        private void InjectPropertiesOn(object currentPage)
        {
            PropertyInfo[] properties = currentPage.GetType().GetProperties();
            foreach(PropertyInfo property in properties)
            {
                object[] attributes = property.GetCustomAttributes(typeof (InjectAttribute), false);
                if(attributes != null && attributes.Length > 0)
                {
                    object valueToInject = _iocProvider.Container.Resolve(property.PropertyType);
                    property.SetValue(currentPage, valueToInject, null);
                }
            }
        }
    }

    // Global.asax.cs
    public class Global : System.Web.HttpApplication, IoCProvider
    {
        private IWindsorContainer _container;

        public override void Init()
        {
            base.Init();

            InitializeIoC();
        }

        private void InitializeIoC()
        {
            _container = new WindsorContainer();
            _container.AddComponent<ILogger, Logger>();
        }

        public IWindsorContainer Container
        {
            get { return _container; }
        }
    }

    public interface IoCProvider
    {
        IWindsorContainer Container { get; }
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-17T07:17:30.517

我认为你基本上走在正确的轨道上 - 如果你还没有，我建议你看看 Rhino Igloo，一个 WebForms MVC 框架，[这是一篇很好的博客文章，](http://ayende.com/Blog/archive/2007/09/03/Rhino-Igloo-ndash-MVC-Framework-for-Web-Forms.aspx)来源在[这里](https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-igloo)- Ayende（Rhino 的作者Igloo) 在这个项目/库中很好地解决了使用带有 web 表单的 Windsor 的问题。

如果你要注入整个嵌套的控件集，我会缓存反射信息，我怀疑这最终可能会有点影响性能。

最后，spring.net 以一种更加面向配置的方式来解决这个问题，但可能值得看看它们的实现——这里有一篇很好的[参考博客文章](http://blogger.forgottenskies.com/?p=70)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-10T07:25:15.560

这是 OP 代码的修改版本，它 (i) 缓存注入的属性以避免重复反射调用，(ii) 释放所有已解析的组件，(iii) 封装容器访问以免暴露实现。

```
// global.asax.cs
public class Global : HttpApplication
{
    private static IWindsorContainer _container;

    protected void Application_Start(object sender, EventArgs e)
    {
        _container = new WindsorContainer();
        _container.Install(FromAssembly.This());
    }

    internal static object Resolve(Type type)
    {
        return _container.Resolve(type);
    }

    internal static void Release(object component)
    {
        _container.Release(component);
    }

    //...
}

// WindsorHttpModule.cs
public class WindsorHttpModule : IHttpModule
{
    // cache the properties to inject for each page
    private static readonly ConcurrentDictionary<Type, PropertyInfo[]> InjectedProperties = new ConcurrentDictionary<Type, PropertyInfo[]>();
    private HttpApplication _context;

    public void Init(HttpApplication context)
    {
        _context = context;
        _context.PreRequestHandlerExecute += InjectProperties;
        _context.EndRequest += ReleaseComponents;
    }

    private void InjectProperties(object sender, EventArgs e)
    {
        var currentPage = _context.Context.CurrentHandler as Page;
        if (currentPage != null)
        {
            InjectProperties(currentPage);
            currentPage.InitComplete += delegate { InjectUserControls(currentPage); };
        }
    }

    private void InjectUserControls(Control parent)
    {
        foreach (Control control in parent.Controls)
        {
            if (control is UserControl)
            {
                InjectProperties(control);
            }
            InjectUserControls(control);
        }
    }

    private void InjectProperties(Control control)
    {
        ResolvedComponents = new List<object>();
        var pageType = control.GetType();

        PropertyInfo[] properties;
        if (!InjectedProperties.TryGetValue(pageType, out properties))
        {
            properties = control.GetType().GetProperties()
                .Where(p => p.GetCustomAttributes(typeof(InjectAttribute), false).Length > 0)
                .ToArray();
            InjectedProperties.TryAdd(pageType, properties);
        }

        foreach (var property in properties)
        {
            var component = Global.Resolve(property.PropertyType);
            property.SetValue(control, component, null);
            ResolvedComponents.Add(component);
        }
    }

    private void ReleaseComponents(object sender, EventArgs e)
    {
        var resolvedComponents = ResolvedComponents;
        if (resolvedComponents != null)
        {
            foreach (var component in ResolvedComponents)
            {
                Global.Release(component);
            }
        }
    }

    private List<object> ResolvedComponents
    {
        get { return (List<object>)HttpContext.Current.Items["ResolvedComponents"]; }
        set { HttpContext.Current.Items["ResolvedComponents"] = value; }
    }

    public void Dispose()
    { }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T14:35:55.160

我最近开始在一家有很多遗留 webform 应用程序的公司工作，所以这看起来是一种非常有趣的方法，如果我们想将 DI 添加到现有网页，可以提供一种前进的方式，谢谢。

我注意到的一点是 Injection 方法使用 container.Resolve 来显式解析组件，因此我认为我们可能需要在页面卸载时对组件执行 container.Release。

如果我们有瞬态组件并且不这样做，那么我们可能会面临内存泄漏。不确定具有 Per Web Request 生活方式的组件会如何表现（即 Windsor 会在 Web 请求结束时拾取它们，即使我们明确解决了它们），但这里也可能需要谨慎行事。

因此，可能需要扩展模块以跟踪它解析的组件并释放它们，以便 Windsor 知道何时清理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-21T09:38:11.527

接受的答案中缺少的一件事是 http 模块需要在 web.config 文件中注册（取决于应用程序），然后模块才能真正解决代码隐藏页面上的依赖关系。你需要的是：

```
<system.webServer>
    <modules>
      <add name="ClassNameForHttpModuleHere" type="NamespaceForClass"/>
    </modules>
  </system.webServer> 
```

除此之外，公认的解决方案就像一种魅力。

添加http模块参考微软网站：[https ://msdn.microsoft.com/en-us/library/ms227673.aspx](https://msdn.microsoft.com/en-us/library/ms227673.aspx)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-09T12:01:33.903

除了这样做，您还可以直接使用类型解析器，例如：

```
ILogger Logger = ResolveType.Of<ILogger>(); 
```

# php - PHP MYSQL - 展开帮助

> ID：293794
> 
> 赞同：1
> 
> 时间：2008-11-16T11:26:41.123
> 
> 标签：php, mysql, explode

问候，

我在 1 个表中使用分隔符“，”将数据存储在 mysql 上。我也有存储在数据库中的行和列。现在我必须使用存储在数据库中的行号和列号来输出数据来绘制表格。

行号和列号是用户输入的，因此可能会有所不同。

比方说，列上有数字 3，行上有 3。

我需要像显示一样做，

```
|___d1__|___d2__|___d3__|
|___d4__|___d5__|___d6__|
|___d7__|___d8__|___d9__| 
```

其中 d1-d9 是存储在 mysql 数据库中的数据，其中一个表中带有分隔符“，”。

谢谢你帮助我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T13:04:12.237

这不会帮助您解决这个问题，但有一个很好的建议：永远不要将逗号分隔的值写入数据库字段。您无法明智地查询像这样存储的信息，并且您的应用程序代码将被丑陋的转换弄得一团糟。相反，请使用一个单独的表，其中包含对主表的引用和每个值一行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T13:43:14.763

您可以使用 explode() 函数将数据列中的逗号分隔值转换为数组：

```
<?php
  $result = mysql_query('SELECT rows, columns, data from table_name where id=1');
  $record = mysql_fetch_assoc($result);

  $rows = $record['rows'];
  $columns = $record['columns'];

  $data = explode(',' , $record['data']);

  if (sizeof($data) != $rows * $columns) die('invalid data');
?> 
```

要显示表格，您需要两个嵌套的 for 循环：

```
<table>
<?php for ($row = 0; $row < $rows; $row++) : ?>
    <tr>
    <?php for ($column = 0; $column < $columns; $column++) : ?>
        <td>
            <?php echo $data[$row * $columns + $column]; ?>
        </td>
    <?php endfor ?>
    </tr>
<?php endfor ?>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T12:08:18.167

假设用户为 2 行和 3 列设置表大小并输入 6 个单元格，将进入数据库的数据将是

> 2,3,d1,d2,d3,d4,d5,d6

当您从单元格中获取数据并在获取的字符串上进行爆炸时，您将获得包含 8 个元素的 1 维数组

$r = $e[0] 行

$c = $e[1] 列

$e[2-7] 数据

*   写开<table>标签
*   两个循环，一个接一个，
*   第一个将生成行首代码
*   写打开 <tr> 标签
*   其中一个将为行生成代码。
*   写开<td>标签
*   写入数据 $e[1 + 从内部和外部循环计算的位置]
*   写结束<td>标签
*   内循环结束
*   写结束 <tr> 标签
*   外循环结束
*   写结束 <table> 标签

它应该给你的想法

# .net - Visio 中的项目依赖关系图

> ID：293797
> 
> 赞同：4
> 
> 时间：2008-11-16T11:36:49.777
> 
> 标签：.net, visual-studio, dependencies, visio

我正在寻找一种可以在 Visio（或尽可能接近）中生成程序集/项目依赖关系图的工具，以帮助我将我们的一些系统分解为更易于管理的主干。

包含/排除非项目依赖项的能力是必须的（即包含/排除 System.assembly）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T20:30:34.130

试试 ReSharper。（我与产品或公司无关，但它为依赖遍历提供了许多不错的功能）。

您还可以尝试使用 SysInternal 工具集的 Depends.exe - 现在来自 Microsoft。

[Jetbrains 的 ReSharper](http://www.jetbrains.com/resharper/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T17:41:55.373

Visio 能够从您的解决方案中对 UML 进行逆向工程。[您可以在此处](http://office.microsoft.com/en-us/visio/HP815507451033.aspx)找到更多信息。但是，我不清楚您是否可以包含 .Net 程序集——因为它们并不真正包含在您的解决方案中。

# c++ - 如何在 Visual Studio 2008 SP1 中使用 std::tr1::mem_fun？

> ID：293799
> 
> 赞同：2
> 
> 时间：2008-11-16T11:38:50.020
> 
> 标签：c++, std, tr1, mem-fun

*VS2008 SP1*文档讨论了**`std::tr1::mem_fun`**.

那么为什么，当我尝试使用时**`std::tr1::mem_fun`**，为什么会出现这个编译错误？：

```
'mem_fun' : is not a member of 'std::tr1' 
```

同时，我可以**`std::tr1::function`**毫无问题地使用。

这是我试图编译的示例代码，它应该通过 a调用`TakesInt`的实例：`Test``function<void (int)>`

```
#include "stdafx.h"
#include <iostream>
#include <functional>
#include <memory>

struct Test { void TakesInt(int i) { std::cout << i; } };

void _tmain() 
{
    Test* t = new Test();

    //error C2039: 'mem_fun' : is not a member of 'std::tr1'
    std::tr1::function<void (int)> f =
        std::tr1::bind(std::tr1::mem_fun(&Test::TakesInt), t);
    f(2);
} 
```

我正在尝试使用 tr1 版本**`mem_fun`**，因为使用**`std::mem_fun`**我的代码时也无法编译！我无法从编译器错误中判断问题出在我的代码上，还是可以通过使用 tr1's 来解决**`mem_fun`**。那是你的 C++ 编译器错误（或者可能只是我！）。

* * *

## 更新：对。答案是正确拼写为 mem_fn！

但是，当我修复它时，代码仍然无法编译。

这是编译器错误：

```
error C2562: 
'std::tr1::_Callable_obj<_Ty,_Indirect>::_ApplyX' :
  'void' function returning a value 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T15:17:01.593

将其更改为：

```
std::tr1::function<void (int)> f =
    std::tr1::bind(std::tr1::mem_fn(&Test::TakesInt), t, std::tr1::placeholders::_1);
f(2); 
```

binder 需要 int 参数。所以你必须给它一个占位符，它代表生成的函数对象需要的整数参数。

顺便说一句：我不确定你是否已经知道这一点。但是你不需要那个 mem_fn 。只需将其更改为

```
std::tr1::function<void (int)> f =
    std::tr1::bind(&Test::TakesInt, t, std::tr1::placeholders::_1);
f(2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T13:35:21.393

我不是 TR1 或 VS2008 的专家，但快速谷歌搜索表明您正在寻找的功能是 std::tr1::mem_fn 。（至少，这就是 Boost 在他们的[TR1 实现中所说的，这就是它在](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_tr1/subject_list.html#boost_tr1.subject_list.mem_fn)[Wikipedia](http://en.wikipedia.org/wiki/C%2B%2B_Technical_Report_1#mem_fn)上的详细说明。）

不过，我不确定为什么旧版本的 mem_fun 会出现编译错误。如果您发布编译器关于此的消息，它可能会帮助我们弄清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T13:40:28.683

要像这样使用 mem_fun，您需要完全指定所有模板参数（因为 mem_fun 是一个类，并且不会对类进行自动模板参数推导）。mem_fun 也只有一个带 0 个参数的默认构造函数。

没有完整的类定义很难得到正确的。
但我对你想要的最好的选择是：（或接近的东西）

```
 std::tr1::mem_fun<Test,void (Test::*)(Test*),&Test::TakesInt>() 
```

我认为您正在寻找的是 mem_fn()。这是一个返回 mem_fun 类型对象的函数。因为是做模板参数自动扣减的功能。

```
 std::tr1::mem_fn(&Test::TakesInt) 
```

要解决第二个问题，请使用：std::bind1st()

```
 f=    std::bind1st(std::tr1::mem_fn(&Test::TakesInt), t); 
```

# .net - CIL 和 MSIL (IL) 有什么区别？

> ID：293800
> 
> 赞同：22
> 
> 时间：2008-11-16T11:39:12.343
> 
> 标签：.net

这两个术语可以互换吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-16T11:40:46.490

[CIL 是CLI 标准](http://www.ecma-international.org/publications/standards/Ecma-335.htm)中使用的术语。MSIL 是（我想）由 MS 工具创建的 CIL。实际上，它们是同义词。

[布拉德艾布拉姆斯这样说。](http://blogs.msdn.com/brada/archive/2005/09/20/CILorMSIL.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-16T13:35:38.630

MSIL 是最初的名称，但当它变成一个标准时，它被重命名为 CIL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-18T08:15:52.323

这两个术语相似，但有以下区别：

CIL——通用中间语言——是国际标准中使用的术语。

MSIL——微软中间语言——是微软实施该标准的产品术语。

# visual-studio - 有没有办法在 Visual Studio 2008 中指定大纲默认值，以便打开文件时默认折叠成员？

> ID：293806
> 
> 赞同：7
> 
> 时间：2008-11-16T11:49:37.003
> 
> 标签：visual-studio, outlining

我想要做的是 VS2008，当我打开一个代码文件时，默认情况下折叠文件中类/接口的所有成员（包括任何 XML 文档和注释）。

我根本*不想*使用区域。

我还希望能够使用 ctrl+m、ctrl+l 和弦来切换所有*成员*大纲（例如，如果所有内容都折叠了，我希望它展开所有成员，而不是评论或 XML 文档）。

可能的？如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T20:55:51.783

是的，第 1 部分。

不确定第 2 部分。

要让 VS2008 自动打开处于折叠状态的文件，您需要创建一个插件以在每个文档打开时运行“Edit.CollapsetoDefinition”。

这并不过分棘手 - 困难的部分似乎是您必须在文档实际打开几毫秒后运行代码，因此您需要使用 threed 池来执行此操作。

1.  为 VS2008 创建一个插件项目。
2.  将此代码（见下文）添加到 Connect 类的 OnConnection 方法的末尾。

```
 switch (connectMode)
    {
        case ext_ConnectMode.ext_cm_UISetup:
        case ext_ConnectMode.ext_cm_Startup:
            //Do nothing OnStartup will be called once IDE is initialised.
            break;
        case ext_ConnectMode.ext_cm_AfterStartup:
            //The addin was started post startup so we need to call its initialisation manually
            InitialiseHandlers();
            break;
    } 
```

3.  将此方法添加到 Connect 类

```
 private void InitialiseHandlers()
    {
        this._openHandler = new OnOpenHandler(_applicationObject);
    } 
```

4.  将对 InitialiseHandlers() 的调用添加到 Connect 类的 OnStartupComplete 方法。

```
 public void OnStartupComplete(ref Array custom)
    {
        InitialiseHandlers();
    } 
```

5.  将此类添加到项目中。

```
 using System;
    using System.Collections.Generic;
    using System.Text;
    using EnvDTE80;
    using EnvDTE;
    using System.Threading;

    namespace Collapser
    {
        internal class OnOpenHandler
        {
            DTE2 _application = null;
            EnvDTE.Events events = null;
            EnvDTE.DocumentEvents docEvents = null;

            internal OnOpenHandler(DTE2 application)
            {
                _application = application;
                events = _application.Events;
                docEvents = events.get_DocumentEvents(null);
                docEvents.DocumentOpened +=new _dispDocumentEvents_DocumentOpenedEventHandler(OnOpenHandler_DocumentOpened);
            }

            void OnOpenHandler_DocumentOpened(EnvDTE.Document document)
            {
                if (_application.Debugger.CurrentMode != dbgDebugMode.dbgBreakMode)
                {
                    ThreadPool.QueueUserWorkItem(new WaitCallback(Collapse));
                }
            }

            private void Collapse(object o)
            {
                System.Threading.Thread.Sleep(150);
                _application.ExecuteCommand("Edit.CollapsetoDefinitions", "");
            }
        }
    } 
```

现在所有打开的文件都应该完全折叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T18:55:15.953

使用 Visual Studio 宏来做同样的事情会容易得多。在 MyMacros 中编辑“EnvironmentEvents”宏文件并为 DocumentEvents.DocumentOpened 添加一个处理程序：
DTE.ExecuteCommand("Edit.CollapsetoDefinitions")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T17:25:39.660

我曾尝试自己为宏编写一些 Visual Basic 代码，从不同的地方借用，但无法使任何工作。那我做了什么？为什么，我当然在 StackOverflow 上问[了一个问题！](https://stackoverflow.com/questions/1050944/environmentevent-macro-doesnt-complete)它得到了回答，我将建议的代码添加到我的`EnvironmentEvents`宏中，现在当我打开 CS 文件时，大约一秒钟后，我所有的定义都被折叠了。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T17:43:22.103

将所有大纲折叠到函数定义的一种快速方法是按下： **Contextmenu-button***（在右侧窗口按钮旁边）***、L、O**

我用它所有的时间。如果有一个真正的热键请告诉我:)

# xml - LINQ to XML：解析其中一个节点呈现另一个节点类型的 XML 文件

> ID：293814
> 
> 赞同：3
> 
> 时间：2008-11-16T12:10:57.507
> 
> 标签：xml, linq, parsing

嗨！

这是否可以使用一个节点的字符串值来告诉使用 LINQ to XML 在另一个节点中呈现什么类型的字段？

例如：

```
<node>
  <name>nodeName</name>
  <type>string</type>
</node>
<node>
  <name>0</name>
  <type>bool</type>
</node>
<node>
  <name>42</name>
  <type>int</type>
</node> 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T13:55:43.957

好吧，鉴于类型信息仅在执行时已知，您不会得到一个好的静态类型 API - 但是您可以轻松地在 XElement 上编写一个扩展方法，该方法查找适当的子元素并返回`System.Object`。例如（未经测试）：

```
public static object ParseValue(this XElement element)
{
    XElement name = element.Element("name");
    XElement type = element.Element("type");
    // Insert error handling here :)

    switch (type.Value)
    {
        case "int":
            return int.Parse(name.Value);
        case "string":
            return name.Value;
        case "bool":
            return name.Value == "1"; // Or whatever
        default:
            throw new ArgumentException("Unknown element type " + type.Value);
    }
} 
```

这不是我设计数据格式的方式，但如果它被强加给你......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T14:02:37.470

```
public static void Main() {
    var xmlNodes = new XElement( "Nodes",
        new XElement( "Node",
            new XElement( "Name", "nodeName" ),
            new XElement( "Type", "string" )
        ),
        new XElement( "Node",
            new XElement( "Name", "True" ),
            new XElement( "Type", "bool" )
        ),
        new XElement( "Node",
            new XElement( "Name", "42" ),
            new XElement( "Type", "int" )
        )
    );

    var converters = new Dictionary<string,Func<string,object> >  {
        { "string", val => val },
        { "bool", val => Boolean.Parse( val ) },
        { "int", val => Int32.Parse( val ) }
    };

    var values = 
        from node in xmlNodes.Elements( "Node" )
        select converters[ node.Element( "Type" ).Value ]( node.Element( "Name" ).Value );

    foreach( var value in values )
        Console.WriteLine( value.GetType().ToString() + ": " + value );
} 
```

# c# - 需要有关将 ORM 和 SQL 与遗留系统结合的建议

> ID：293826
> 
> 赞同：2
> 
> 时间：2008-11-16T12:35:36.427
> 
> 标签：c#, sql, orm, interface, business-objects

我们正在将遗留系统移植到 .NET，既是为了清理架构，也是为了利用许多在遗留系统中不容易实现的新可能性。

**注意：在提交之前阅读我的帖子时，我注意到我可能在某些地方描述得太快了，即。掩盖了细节。如果有任何不清楚的地方，请发表评论（不是答案），我会尽可能多地补充**

遗留系统使用数据库和 100% 自定义编写的 SQL。这导致了宽表（即许多列），因为需要数据的代码只检索工作所需的内容。

作为移植的一部分，除了自定义 SQL 之外，我们还引入了一个我们可以使用的 ORM 层。我们选择的 ORM 是 DevExpress XPO，其中一个*特性*也给我们带来了一些问题，即当我们为 Employee 表定义 ORM 类时，我们必须为所有列添加属性，否则它不会为我们检索它们。

这也意味着当我们检索一个 Employee 时，我们会得到所有的列，即使我们只需要一些列。

拥有 ORM 的一个好处是我们可以将一些与属性相关的逻辑放入相同的类中，而不必到处复制它。例如，将名字、中间名和姓氏组合成“显示名称”的简单表达式可以放在那里，作为示例。

但是，如果我们在某处编写 SQL 代码，无论是在类似 DAL 的构造中，还是在任何地方，我们都需要复制这个表达式。这感觉不对，看起来像是错误和维护噩梦的秘诀。

但是，由于我们有两个选择：

*   ORM，获取所有内容，可以编写一次逻辑
*   SQL，获取我们需要的，需要复制逻辑

然后我们想出了一个替代方案。由于 ORM 对象是从字典代码生成的，我们决定也生成一组哑类。这些将具有相同数量的属性，但不会以相同的方式绑定到 ORM。此外，我们为所有对象添加了接口，也生成了，并使 ORM 和 dum 对象都实现了这个接口。

这使我们能够将其中的一些逻辑移出到与接口相关的扩展方法中。由于哑对象携带了足够的信息让我们将它们插入到我们的 SQL 类中，而不是返回 DataTable，我们可以返回一个 List，并提供可用的逻辑，这看起来是可行的。

然而，这导致了另一个问题。如果我想编写一段代码，仅在我需要知道他们是谁（即他们在系统中的标识符）以及他们的姓名（名字、中间名和姓氏）的上下文中显示或处理员工，如果我使用这个愚蠢的对象，编译器无法保证调用我的代码确实提供了所有这些东西。

一种*解决方案*是让我们让对象知道哪些属性已被赋值，并且尝试读取未赋值的属性会因异常而崩溃。这使我们有机会在运行时发现代码未传递足够信息的合同违约。

这对我们来说也很笨拙。

所以基本上我想要的建议是是否有其他人曾经或正在这种情况下，以及您可以提供的任何提示或建议。

目前，我们不能拆散桌子。由于端口的大小，旧应用程序仍需存在数年，并且 .NET 代码不是 3 年内发布类型的项目，但将在此过程中逐步发布。因此，遗留系统和 .NET 代码都需要使用相同的表。

我们也知道这不是一个理想的解决方案，所以请不要提出“你不应该这样做”这样的建议。我们很清楚这一点:)

* * *

我们研究过的一件事是使用“合同”创建一个 XML 文件或类似文件。所以我们可以在这个 XML 文件中加入如下内容：

*   有一个 Employee 类具有这 50 个属性
*   此外，对于程序的各个部分，我们有这 7 种变体
*   此外，我们有这 10 条逻辑，每条都需要属性 X、Y 和 Z（X、Y 和 Z 在这 10 种之间变化）

这可以让我们对这 8 个类（全类 + 7 个较小的变体）进行代码生成，并让生成器检测到变体 #3 的属性 X、Y 和 K 是否存在，然后我可以将代码绑定到逻辑或逻辑需要自动进入此类的接口。这将允许我们拥有许多不同类型的员工类，具有不同程度的属性覆盖，并让生成器自动将此类支持的所有逻辑添加到它。

然后我的代码可以说我需要一个 IEmployeeWithAddressAndPhoneNumbers 类型的员工。

这看起来也很笨重。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T12:51:24.617

我建议最终可能需要进行数据库重构（规范化）。您可以进行重构并使用视图来为遗留应用程序提供与数据库的接口与其期望一致的接口。也就是说，例如，将员工表分解为employee_info、employee_contact_info、employee_assignments，然后为遗留应用程序提供一个名为employee 的视图，该视图在这三个表之间进行连接（或者如果逻辑是基于表的函数更复杂）。这可能会让您继续使用完全基于 ORM 的解决方案，这是我更喜欢的解决方案，并让您的遗留应用程序满意。我不会继续使用 ORM/直接 SQL 的混合解决方案，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T13:13:42.420

“目前，我们无法拆分表格。由于端口的大小，旧应用程序仍将存在数年，而 .NET 代码不是 3 年内——发布类型的项目，但将在发布过程中逐步加入。因此，遗留系统和 .NET 代码都需要使用相同的表。

两个字：物化的观点。

您有几种“就地标准化”的方法。

1.  物化视图，a/k/a 索引视图。这是源表的规范化克隆。

2.  从旧表显式复制到新表。“我”你说。但是，请考虑您将逐步从旧应用程序中删除功能。这意味着您将在新的规范化表中拥有一些功能，并且可以优雅地忽略旧表。

3.  显式 2 路同步。这很难，并非不可能。您通过从旧表复制到正确设计的表进行规范化。作为临时解决方案，您可以使用存储过程和触发器将事务克隆到遗留表中。然后，随着转换的进行，您可以淘汰这些杂物。

在两个完全不同的模式中执行此操作会很高兴。由于旧数据库可能没有设计良好的模式，因此您的新数据库将具有一个或多个命名模式，以便您可以对定义进行一些版本控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T13:47:40.340

尽管我没有使用过这种特殊的 ORM，但视图在某些情况下可以用于为这些类型的数据库中的显示和报告提供更轻量级的对象。根据他们的文档，他们确实支持这样一个概念：[XPView Concepts](http://www.devexpress.com/Help/?document=XPO/CustomDocument2068.htm&levelup=true)

# asp.net - 使用 ASP.NET 会话状态时的常见问题和最佳实践是什么？

> ID：293831
> 
> 赞同：2
> 
> 时间：2008-11-16T12:45:58.310
> 
> 标签：asp.net, session

例如，我在我的 ASP.NET 应用程序中广泛使用了会话，但在某处听说存储在会话中的对象可以被服务器内存不足的系统删除。这是真的？是否有任何会话“回调”功能允许您重新填充清理的对象？

更一般地说，使用会话状态还有哪些其他潜在问题，以及处理这些问题的建议最佳实践是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T15:08:14.013

无论您使用哪种预防措施，始终假设您的 Session 可能会消失并仔细检查：

```
Dim sessionObj As Object = CType(Session("SessionKey"), Object)
If sessionObj Is Nothing
    sessionObj = ReCreateObj()
    Session("SessionKey") = sessionObj
End If

object sessionObj = Session["SessionKey"] as object ;
if(sessionObj == null)
{
    sessionObj = ReCreateObj();
    Session["SessionKey"] = sessionObj;
} 
```

Session 包装器适用于此，因此您在访问 Session 变量的任何地方都没有检查。

我对[自定义 Session-State Providers](http://msdn.microsoft.com/en-us/library/ms178587.aspx)很幸运。一些有用的调整包括：

*   使用数据库支持的 Session 时，请在请求开始时获取所有 Session 变量并在最后存储它们，而不是按访问/存储每组获取。如果您使用多个 Session 变量，这很有用，因为它减少了到外部服务器的往返行程。
*   实现两步内存/数据库存储。保存时，将您的 var 存储在本地服务器的内存中并保存到数据库中。访问时，首先检查内存（如果在这里找到它，则保存一个网络跃点），然后是数据库。

在实现你必须支持的东西之前，我肯定会看看三种[标准会话模式中的一种是否有效。](http://msdn.microsoft.com/en-us/library/ms178586.aspx)一旦您对应用程序的古怪需求有了更多了解，自定义会话就会很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T13:12:54.590

抱歉，我不知道从会话状态中删除项目，但在回答您的一般问题时，最重要的问题是您是否希望在一台或多台网络服务器机器上运行您的网络应用程序。

通常，您将会话状态保存在一台机器的内存中。面向多个 Web 服务器的负载平衡器必须配置为使事情“粘”，以便同一用户不断被路由到同一台机器。

或者，您可以将会话状态存储在中央位置，包括 SQL Server，但随后您需要为与 SQL Server 的网络和 IO 交互付出性能损失。你放弃本地的速度，处于内存状态。

由于会话状态默认为 20 分钟，如果您需要更多，但您的托管公司不允许您覆盖它，您将不得不在您的网页中运行一些 ajax 或隐藏的 iframe javascript 代码来 ping 服务器每（少于）20 分钟保持会话活跃

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T13:26:11.303

并且每次重新启动应用程序池时，例如，创建一个设置会话变量的页面并将其显示在页面中，现在，更新您的 BIN、APPCode、全局或本地资源文件夹，您将看到会话将被抹去。

并且在共享主机环境中，这将更加棘手，因为无论您覆盖什么 Session.Timeout 值，它们都会将会话超时通常阻止为 20 分钟。

由于这个以及更多的原因，我确实使用 SQL 会话，Web 应用程序有点慢，因为所有内容（会话）都在 SQL Server 中而不是在内存中，但是您可以对其进行更多控制，并且可以将会话超时设置为任何值你要！在我的情况下非常好，因为我希望他们在我更新应用程序时继续工作（非常糟糕的是，每次我更新 APP Code 文件夹时，所有用户都会丢失他们正在工作的内容并不得不再次登录）并且我想要将共享主机延长 20 分钟至 45 分钟。

阅读有关[SQL 会话状态的更多信息](http://idunno.org/articles/277.aspx)

# asp.net-mvc - 如何使用 ASP.NET MVC 创建仪表板用户界面？

> ID：293832
> 
> 赞同：5
> 
> 时间：2008-11-16T12:50:08.833
> 
> 标签：asp.net-mvc, user-interface, dashboard, web-parts

我目前正在使用 ASP.NET MVC 构建应用程序。数据输入页面相当容易编码，我只是为我的业务对象类型的页面制作模型：

```
namespace MyNameSpace.Web.Views.ProjectEdit
{
    public partial class MyView : ViewPage<Project>
    {
    }
} 
```

我正在苦苦挣扎的地方是找出使用 ASP.NET MVC 实现类似界面的仪表板的最佳方法，使用独立部件，其中每个部件的模型会有所不同？我**假设**每个部分都是 MVC 用户控件。

另外，我怎样才能使每个部分都是可测试的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T14:07:43.043

我认为用户控件可能是要走的路。我不确定对可测试性的关注是什么。您应该能够测试您的控制器是否提供了正确的视图数据——因为您将拥有多个模型，每个模型都可能存储在单独的视图数据项中，而不是将它们聚合在单个模型中。在单个模型中进行聚合也是可能的，尽管可能更脆弱。每个控件只需要检查特定的视图数据项，而不是特定于特定模型。您可以通过执行以下操作来近似每个视图页面上的模型变量：

```
<% MyUserControlModel model = ViewData["MyUserControlModel"]
         as MyUserControlModel; %>

<div id="myUserControl_dashboard" class="dashboard">
   Name: <%= model.Name %><br />
   Count: <%$ model.Count %>
</div> 
```

如果您需要测试您的视图，那么您可能已经在使用 Selenium 或其他一些 Web 测试框架。我不认为这些会关心页面是如何构建的，您应该能够像往常一样构建您的测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T14:36:13.610

查看这个概念是 MVC-Contrib [http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)中的子控制器。基本上，您对部分运行完整请求，然后在现有代码中显示您想要的部分。

或者，您可以查看这篇文章： http: [//blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-06T19:18:23.753

Codeplex.com 有一个开源项目“DotNet.Highcharts”。这个项目提供了一个 ASP.NET 控件，它围绕着优秀的（免费供个人使用）Highcharts 图表库。其中包括下载部分中的示例 MVC3 项目。

网址：[http ://dotnethighcharts.codeplex.com/](http://dotnethighcharts.codeplex.com/)

我在 CodeProject.com 上发布了一篇文章，其中包括可下载的 VS2012 解决方案和一些示例 C# 代码。但是，我在示例中使用了 Web 表单模板，而不是 MVC。仪表板的大部分是使用 JavaScript 库、HTML 和 CSS 完成的。我已经包含了一些示例 C# 代码来演示 C# 中的数据检索，然后将其与 JavaScript 代码合并以呈现众多仪表板图表之一。

# web-applications - 如何从独立客户端调用远程 EJB

> ID：293835
> 
> 赞同：8
> 
> 时间：2008-11-16T12:52:19.403
> 
> 标签：web-applications, jakarta-ee

我将 EJB 部署在 weblogic 服务器上。我想从独立应用程序（瘦客户端）访问这些 EJB。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-17T09:15:44.460

好的...我自己找到的。:)

这是我用来从瘦客户端连接到远程 EJB 的代码。

```
 Hashtable env = new Hashtable(5);
 env.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory");
 //Assuming weblogic server is running on localhost at port 7001
 env.put(Context.PROVIDER_URL, "t3://localhost:7001");

 Context ic = new InitialContext(env);

 //obtain a reference to the home or local home interface
 FooHome fooHome = (FooHome)ic.lookup("MyBeans/FooHome");

 //Get a reference to an object that implements the beans remote (component) interface
 Foo foo = fooHome.create();

 //call the service exposed by the bean
 foo.shoutFoo() 
```

它对我有用。

# c# - 有没有一种快速的方法可以在 C# 中将一个相同对象的所有变量转移到另一个对象中？

> ID：293840
> 
> 赞同：0
> 
> 时间：2008-11-16T13:03:10.333
> 
> 标签：c#, oop

这大概是一个简单的问题。假设我有一个名为 Users 的对象，它包含很多受保护的变量。

在该 Users 类中，我有一个创建临时 Users 对象的方法，用它做一些事情，如果成功，将所有变量从 temp Users 对象转移到我拥有的对象中。

是否有一些快速的方法可以将所有变量从一个用户对象传输到另一个用户对象而不使用 C#？

```
this.FirstName = temp.FirstName;
this.LastName = temp.LastName;
........75 variables later......
this.FavoriteColor = temp.FavoriteColor 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T13:08:52.600

更好的方法是实现 IClonable 接口。但是你会发现它并没有为你节省很多工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T13:09:32.007

您应该检查 C# 中的克隆。

[深度克隆对象](https://stackoverflow.com/questions/78536/cloning-objects-in-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T14:43:53.860

我认为序列化然后反序列化一个对象将创建一个新的对象实例。这应该与前一个对象相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T13:15:59.543

更好的解决方案可能是将这个方法移到你的类之外，然后将临时用户对象分配给你的主用户对象引用，如下所示：

```
_User = tmpUser; 
```

省去 75 行代码。每当我有一个类在它自己的方法中创建一个自身的实例时，我总是喜欢眨几下，并确保我真的需要这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-14T13:03:16.880

总是有反射选项。与此基本相似的东西：

```
public static void Copy(object source, object target)
    {
        foreach (System.Reflection.PropertyInfo pi in source.GetType().GetProperties())
        {
            System.Reflection.PropertyInfo tpi = target.GetType().GetProperty(pi.Name);
            if (tpi != null && tpi.PropertyType.IsAssignableFrom(pi.PropertyType))
            {
                tpi.SetValue(target, pi.GetValue(source, null), null);
            }

        }
    } 
```

不需要源和目标有任何关系，只需要一个名称和一个 IsAssignable 检查。如果您在任何地方使用引用类型，它会产生有趣的副作用，但对于您刚才描述的那种情况，这不是一个糟糕的探索选择。

```
class sourceTester
{
    public bool Hello { get; set; }
    public string World { get; set; }
    public int Foo { get; set; }
    public List<object> Bar { get; set; }
}

class targetTester
{
    public int Hello {get; set;}
    public string World { get; set; }
    public double Foo { get; set; }
    public List<object> Bar { get; set; }
}

static void Main(string[] args)
    {

        sourceTester src = new sourceTester { 
            Hello = true, 
            World = "Testing",
            Foo = 123,
            Bar = new List<object>()
        };

        targetTester tgt = new targetTester();

        Copy(src, tgt);

        //Immediate Window shows the following:
        //tgt.Hello
        //0
        //tgt.World
        //"Testing"
        //tgt.Foo
        //0.0
        //tgt.Bar
        //Count = 0
        //src.Bar.GetHashCode()
        //59129387
        //tgt.Bar.GetHashCode()
        //59129387
    } 
```

# emacs - 在 Emacs 中定义新的工具提示

> ID：293853
> 
> 赞同：14
> 
> 时间：2008-11-16T13:19:32.080
> 
> 标签：emacs

我想向 emacs 添加自定义工具提示。更具体地说，每当我用鼠标悬停在符号（函数/变量）名称上时，我都希望看到带有符号定义的工具提示。我知道我可以使用 cscope 之类的工具找到此类信息，但我不知道如何将 cscope 的输出附加到工具提示。是否有人对此有部分（如何将回调链接到 emacs 中的工具提示）或完整的（我如何实际将 cscope 的输出链接到工具提示）解决方案？

谢谢，尼尔

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T13:53:25.367

您的 Emacs 安装应该包括[Elisp 参考手册](http://www.gnu.org/software/emacs/manual/elisp.html)（如果没有，请立即下载 - 您在开发模式时将需要它）。要访问它，请转到 Info (Ch i) 并查找标有“Elisp”的节点，有时在单独的“Emacs”菜单中。键入`i`索引并`tooltip`查找有关工具提示的信息。您应该找到节点[32.19.4 Properties with Special Meanings](http://www.gnu.org/software/emacs/manual/html_node/elisp/Special-Properties.html#index-help_002decho-_0040r_007b_0028text-property_0029_007d-2589)，它告诉您该`help-echo`属性的内容是一个字符串，即工具提示内容，或者是一个可以动态构造工具提示的函数。浏览该节点周围的手册以了解有关文本属性以及如何设置它们的更多信息。

这是一个简单的例子：

```
(insert (propertize "foo\n" 'help-echo "Tooltip!")) 
```

将其输入`*scratch*`缓冲区并按下`C-j`以运行代码。然后将鼠标指向单词“foo”，您应该会看到工具提示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-08T16:05:48.020

有[一个 AutoOverlay 包](http://www.dr-qubit.org/predictive/auto-overlay-manual/html/index.php)可以根据缓冲区文本的正则表达式匹配自动添加叠加层以及与这些叠加层关联的工具提示。

# asp.net - 如何在 ASP.Net 站点中启用 FCKeditor 的实时预览？

> ID：293854
> 
> 赞同：2
> 
> 时间：2008-11-16T13:19:37.197
> 
> 标签：asp.net, wysiwyg, fckeditor, live-preview

在[这个](https://stackoverflow.com/questions/84353/i-need-a-wysiwyg-web-editor-web-based)问题中，Scott 写道，可以通过使用获取 FCKeditor 中编写的内容的当前 HTML`FCKeditorAPI.__Instances['instanceNameHere'].GetHTML();`

有人可以提供有关如何在 ASP.NET 页面中完成此操作的分步说明吗？到目前为止，我在 .aspx 文件中的所有内容是：

```
<%@ Register Assembly="FredCK.FCKeditorV2" Namespace="FredCK.FCKeditorV2" TagPrefix="FCKeditorV2" %>
<%@ Page Title="" Language="C#" ... %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
<h2>Create a new piece</h2>
<form id="form1" runat="server">

<FCKeditorV2:FCKeditor ID="FCKeditor1" runat="server">
</FCKeditorV2:FCKeditor>

<input id="Submit1" type="submit" value="Submit" runat="server" />
</form>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T14:57:26.953

在 JavaScript 中

好吧，您可以在这里执行此操作：

```
<script type="text/javascript">
    var oEditor = FCKeditorAPI.GetInstance(’IDFromFCKEditor’);
    oEditor.Events.AttachEvent( 'OnSelectionChange', function() {
        document.getElementById("PreviewDiv").innerHTML = oEditor.GetHTML(true);
    }) ;
</script> 
```

来源[http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/JavaScript_API](http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/JavaScript_API)

# c++ - 为什么这个 const 成员函数允许修改成员变量？

> ID：293857
> 
> 赞同：12
> 
> 时间：2008-11-16T13:21:43.183
> 
> 标签：c++, constants

```
class String
{

    private:
        char* rep;

    public:
        String (const char*);
        void toUpper() const;
};

String :: String (const char* s)
{
    rep = new char [strlen(s)+1];
    strcpy (rep, s);
}

void String :: toUpper () const
{
    for (int i = 0; rep [i]; i++)
    rep[i] = toupper(rep[i]);
}

int main ()
{
    const String lower ("lower");
    lower.toUpper();

    cout << lower << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-16T13:33:49.900

**一个 const 成员函数，是一个不改变其成员变量的成员函数。**

**成员函数上的 const 并不意味着 const char *。这意味着您无法更改指针所在地址中的数据。**

您的示例不会改变成员变量本身。

成员函数上的 const 将确保您将所有成员变量视为 const。

这意味着如果您有：

```
int x;
char c;
char *p; 
```

然后你将拥有：

```
const int x;
const char c;
char * const p; //<-- means you cannot change what p points to, but you can change the data p points to 
```

有 2 种类型的 const 指针。一个 const 成员函数使用我上面列出的那个。

* * *

**一种获得所需错误的方法：**

尝试改变：

```
char * rep; 
```

到：

```
char rep[1024]; 
```

并删除这一行：

```
rep = new char [strlen(s)+1]; 
```

它会抛出您期望的错误（由于 const 关键字而无法修改成员）

因为只有 1 种类型的 const 数组。这意味着您无法修改其任何数据。

* * *

现在整个系统实际上被以下示例破坏了：

```
class String
{

    private:
        char rep2[1024];
        char* rep;

 ...

 String :: String (const char* s)
 {
    rep = rep2;
    strcpy (rep, s); 
 } 
```

**所以这里要吸取的教训是成员函数上的 const 关键字并不能确保您的对象根本不会改变。**

它只确保每个成员变量都将被视为 const。对于指针，const char * 和 char * const 之间存在很大差异。

大多数时候，一个 const 成员函数意味着该成员函数不会修改对象本身，但并非总是如此，如上面的示例所示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T13:42:51.440

原因是你没有改变`rep`。如果你愿意，你会`rep = ...;`在你的代码中找到某个地方。这是之间的区别

```
char*const rep; 
```

和

```
const char* rep; 
```

在您的情况下，如果您执行 const 成员函数，则第一个完成：指针是 const。因此，您将无法重置指针。但是您很可能能够更改指针指向的内容。

现在，记住`rep[i] = ...;`是一样的`*(rep + i) = ...;`。因此，您更改的不是指针，而是指针*指向的内容*。您是被允许的，因为指针不是第二种情况类型。

**解决方案**

1.  您正在查看的 const 含义是`physical constness`. 但是， const 成员函数意味着您的对象是`logical const`. 如果对某些内容的更改将更改对象的*逻辑常量*，例如，如果它更改了对象所依赖的某些静态变量，则编译器无法知道您的类现在具有另一个逻辑值。而且它也不知道逻辑值的变化取决于指针指向的内容：编译器不会尝试检查 const 成员函数中的逻辑常量，因为它不知道这些成员变量的含义。这种东西被称为`const-correctness`。
2.  使用不只是引用或指针的对象：const 成员函数将使该对象成为 const，并且不允许您更改其内容。`std::string`，正如一些人所建议的那样，或者一个字符数组（请注意，一个数组*将*不允许您更改其内容，而不仅仅是一个指针），将是一个合适的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T13:26:11.787

toUpper() 不会更改指针（属于该类）。它只会更改 rep 指向的数据（不属于该类）。

但是，'const' 是对类的用户的一种保证：如果一个方法被声明为 const，那么使用你的类的实例的人可以期望在调用该方法时它不会改变。我的观点是，如果 toUpper() 改变了字符串的状态，无论 C++ 是否允许，*都不要将其声明为 const。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T13:31:10.980

const 限定符意味着它不会更改类的任何成员。

在这种情况下， **rep**是该类的唯一成员，我看不到修改该成员的尝试。**在类之外指向**或**引用**的任何内容都不被视为类的一部分。

解决此问题的方法是将 char* 替换为 std::string。
那么您将只能从 toUpper() 中调用 std::string 的 const 成员

例如（使用 std::string）

```
class String
{
    std::string rep;

    void toUpper() const
    { 
        for (int i = 0; rep [i]; i++)
            rep[i] = toupper(rep[i]);

        // Can only use const member functions on rep.
        // So here we use 'char const& std::string::operator[](size_t) const'
        // There is a non const version but we are not allowed to use it
        // because this method is const.

        // So the return type is 'char const&'
        // This can be used in the call to toupper()
        // But not on the lhs of the assignemnt statement

    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T15:39:23.843

您不能更改声明为的东西的值

```
const char* rep; 
```

或者

```
const char* const rep; 
```

不幸的是，声明你的成员 const 变成 rep 成

```
char* const rep; 
```

这意味着，您不能更改实际地址，但可以更改内容，而不能更改值。

为了使 const memebrs 尊重保持你的缓冲区 const，你需要制作代表和字符数组或字符串对象而不是字符指针。

# java - 使用队列模拟交叉路口车辆的程序

> ID：293874
> 
> 赞同：3
> 
> 时间：2008-11-16T13:42:20.660
> 
> 标签：java, queue, simulation

嗨，我有这个课程问题要解决。

这是问题：

设计一个程序来模拟交叉路口的车辆。

假设四个方向各有一条车道，每个方向都有红绿灯。随机改变各个方向车辆的到达时间，并设置有规律的灯光变化频率。运行您的方向并设置光照变化的规律频率。运行您的模拟一段时间以查看交叉路口的“行为”。

课程要求：

1.  应该用java编码
2.  使用正确的数据结构

如果有人知道如何做到这一点，请提供帮助；我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T13:50:47.103

阅读您必须用来模拟每个红绿灯的[队列](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html) [。](http://en.wikipedia.org/wiki/Queue_(data_structure))

每条车道上的每辆随机生成的汽车都将被推入相应的队列，然后在绿灯时从队列中弹出，并一直弹出汽车只要（提示：您还需要模拟时间（子提示：查看有限状态机））灯是绿色的，当然。您按顺序处理每个队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T13:55:43.130

一些有用的监控行为将包括均值、最大值和标准差。开发。每个信号灯处等待的汽车数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T14:01:08.330

要管理停止/等待/开始灯序列，请查看“有限状态机”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T14:03:21.633

阅读[离散事件模拟](http://en.wikipedia.org/wiki/Discrete_event_simulation)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T14:08:05.477

只是一个小提示。如果您不设置一些常数来模拟汽车加速到达十字路口的时间，那将不是一个合适的模拟。如果你有 10 辆车在排队并且灯变绿，他们不会立即穿过十字路口。

除此之外，您确实需要了解队列，尤其是 FIFO 和事件队列将帮助您避免进入多线程领域。

我希望您在进入队列之前不需要[从 Java 开始。](http://java.sun.com/docs/books/tutorial/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T17:27:08.243

如果您可以访问 IEEE，则​​有关于此主题的期刊，这里是[链接](http://ieeexplore.ieee.org/iel5/8866/28034/01252658.pdf?arnumber=1252658)

# asp.net-mvc - 如何允许使用 ASP.NET MVC 对 rss 提要进行授权？

> ID：293878
> 
> 赞同：4
> 
> 时间：2008-11-16T13:45:23.137
> 
> 标签：asp.net-mvc, authorization

我们的商店正在将我们的内部项目管理应用程序从 ASP.NET Web 窗体转换为 ASP.NET MVC。

我想为我们的客户提供他们当前未解决的问题的 RSS 提要……但我想通过某种类型的授权来这样做，例如登录名和密码。

这可能使用 ASP.NET MVC 还是应该通过 WCF 等其他服务来完成？示例代码将**不胜感激**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T02:20:27.743

我不确定最好的方法，但可以想到一些，但没有一个是超级棒的。

*   使用具有基本安全性的 IIS WindowsAuthentication 并实施验证方法，然后使用授权过滤器标记 RSS 操作。如果他们使用不允许 http 身份验证的 RSS feeder，您应该仍然可以执行[http://username:password@mysite.com/controller/action/rss](http://username:password@mysite.com/controller/action/rss)。

*   为每个客户生成一个令牌并将其放在 url 的一部分中：http: [//mysite.com/controller/action/rss/](http://mysite.com/controller/action/rss/) {token}。这不是很好。

*   将用户名/密码作为路由的一部分： [http://mysite.com/controller/action/rss/](http://mysite.com/controller/action/rss/) {username}/{password} ...虽然这很可怕。

所有这些都有点糟糕，因为密码（或令牌）是 url 可见的。如果它是https而不是http，也许这被认为是可以的。我认为第一个选项 + https 很常见吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T13:51:54.543

如果私人提要是 RSS 规范的一部分，您应该在那里寻找 RSS 身份验证的机制。

我之前曾为一个项目考虑过这一点，并得出结论，安全 RSS 将永远无法工作，因为没有足够的客户端（例如谷歌阅读器）支持它。

抱歉，没有完整的答案，但认为这可能会有所帮助。

# asp.net - 当用户单击浏览器刷新按钮时重定向到错误页面

> ID：293882
> 
> 赞同：1
> 
> 时间：2008-11-16T13:48:17.733
> 
> 标签：asp.net

我需要检查用户是否单击浏览器刷新按钮并重定向到错误页面。我们可以在 javascript 或 ASP.net 中的任何服务器端方法中执行此操作吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T14:03:18.140

如果您在 URL 中为每个链接提供一个唯一 ID（例如 GUID）作为参数，那么您可以跟踪您已处理的所有请求。（如果您不介意如果有人将浏览器打开几天然后点击刷新，则该机制不起作用，您可以清除“旧”请求。）第一次看到 GUID 时，将其写入表中。如果您再次看到它，请重定向到错误页面。

虽然它非常难看，用户只需编辑 URL 以稍微更改 GUID。*（您可以通过在生成*GUID 时记录它来修复最后一个缺陷，并更新表以指示它何时被*使用*。）

一般来说，用户希望能够刷新页面——尤其是对于 GET 请求（即使大多数用户不知道这意味着什么）。你为什么要这样做？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T14:44:30.037

好吧，您可以使用一种非常著名的技术，称为“同步令牌”或类似 =D 的东西，主要用于发送表单。

这将像这样工作：

1.  创建一个函数来提供一个伪随机字符串标记。

2.  对于您页面的每个请求，检查 Session 中是否存在变量，例如：Session["synctoken"] 如果存在。如果不是，那么这是第一次，生成一个令牌并将其存储在那里。

3.  每个链接请求，例如：“mypage.aspx”将一个名为 synctoken 的 get 与另一个令牌放在一起，与您存储在 Session 中的不同，它类似于“mypage.aspx?synctoken=2iO02-3S23d”。

4.  然后，回到 (2)，在请求中，如果 Session 中存在令牌，请检查 GET 是否存在（Request.QueryString["synctoken"] != null）。如果否，则发送错误。如果是，请检查令牌（会话和 GET）是否不同。如果它们不同，没关系，将 GET 存储到您的 Session (Session["synctoken"] = Request.QueryString["synctoken"]) 并转到步骤 (2)。如果不是，那么用户刷新了页面，你的错误就出现了。

它是这样的：

```
if (Session["synctoken"] != null) {
    if (Request.QueryString["synctoken"] != null) {
        if (Request.QueryString["synctoken"].ToString().Equals(Session["synctoken"].ToString())) {
            // Refresh! Goto Error!
            MyUtil.GotoError();
        }
        else {
            // It is ok, store the token and go on!
            Session["synctoken"] = Request.QueryString["synctoken"];
        }
    }
    else {
        MyUtil.GotoErrorPage();
    }
}
else {
    Session["synctoken"] = MyUtil.GenerateToken();
} 
```

对不起，如果我不能更清楚..祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T14:08:01.483

你可以这样做，但我相信你不应该这样做。用户控制着浏览器，如果她想刷新，你的工作就是确保页面刷新。返回错误页面是错误的答案。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-16T14:05:43.423

您可以使用客户端隐藏变量来存储计数器，也可以将计数器放入会话中。好吧，我建议您在刷新时使页面过期，您可以通过多种方式实现此禁用缓存等[就像所有银行网站一样]。

# eclipse - 如何在 Eclipse 中自动创建（脚本）war 文件？

> ID：293900
> 
> 赞同：6
> 
> 时间：2008-11-16T14:05:24.593
> 
> 标签：eclipse, war

单击 5 次按钮即可让 eclipse 为我的 eclipse 项目创建一个可部署的 war 文件，我认为可能有一些 eclipse 命令行选项可以做同样的事情，所以我可以将它写入脚本，但我没有看到它.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T14:11:33.053

使用[Ant`war`任务](http://ant.apache.org/manual/Tasks/war.html)，设置一个相关的构建文件，你可以点击“外部工具”按钮来执行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T14:09:24.630

您还可以为您的 Web 项目设置 Maven 构建。从命令行键入 mvn package 然后将为您构建项目。

有关 Maven 和 Eclipse 之间的集成，请参阅[m2Eclipse](http://m2eclipse.codehaus.org/)和[Maven Eclipse 插件](http://maven.apache.org/eclipse-plugin.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T07:02:25.157

关于 WAR 包装本身，我无话可说，抱歉。

[但正如我在 Eclipse 中构建 Java 后如何自动导出 WAR](https://stackoverflow.com/questions/347698/how-do-i-automatically-export-a-war-after-java-build-in-eclipse)中所写的那样 ？：如果**您**可以使用 Ant 脚本描述 WAR 打包，那么您可以在每次更改项目后自动执行该 Ant 脚本。使用 Project->Properties->Builders->Add->Ant Builder。为该构建器提供自定义 Ant 脚本，它将在项目的“正常”构建器之后自动执行。您甚至可以在构建器的设置中指定它是否只对特定文件的更改等做出反应。

Ant builder 是一种瑞士军刀，可用于您想要在项目构建中自动化的任何内容，而无需使用 maven 等大型工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-08T17:37:32.647

这个 Ant 脚本应该适用于项目的标准动态 Web 项目结构：

**创建 Ant build.xml 并在开始时替换两个属性：**

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Deploy From Eclipse to JBoss" basedir="." default="deploy">

  <!-- This replace with yours project name and JBoss location: -->
  <property name="warfile" value="MyProject"/>
  <property name="deploy" value="/home/honza/jboss-as-7.1.1.Final/standalone/deployments"/>

  <target name="create">
    <war destfile="${warfile}.war" webxml="WebContent/WEB-INF/web.xml" update="true">
      <classes dir="build\classes"/>
      <fileset dir="WebContent">
        <exclude name="WEB-INF/web.xml"/>
      </fileset>
    </war>
  </target>
  <target name="copy">
    <copy todir="${deploy}" overwrite="true">
      <fileset dir=".">
        <include name="${warfile}.war"/>
      </fileset>
    </copy>
  </target>
  <target name="clear">
    <delete includeemptydirs="true">
      <fileset dir="${deploy}" defaultexcludes="false">
        <include name="${warfile}.*/**" />
      </fileset>
    </delete>
  </target>
  <target name="deploy">
    <antcall target="create"/>
    <antcall target="clear"/>
    <antcall target="copy"/>
  </target>
</project> 
```

现在应该命令“ant”创建 WAR 并将它们复制到 JBoss。JBoss 自动部署在部署目录中找到的战争。

对于构建后的自动运行（项目 - 构建），请在此处添加此构建文件：

```
MyProject - Properties - New - Ant builder 
```

# c# - 反射 - 从 System.Type 实例获取通用参数

> ID：293905
> 
> 赞同：35
> 
> 时间：2008-11-16T14:08:31.140
> 
> 标签：c#, .net, reflection, generic-type-argument

如果我有以下代码：

```
MyType<int> anInstance = new MyType<int>();
Type type = anInstance.GetType(); 
```

如何通过查看类型变量找出实例化的类型参数“anInstance”？是否可以？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-11-16T14:12:20.883

使用[Type.GetGenericArguments](http://msdn.microsoft.com/en-us/library/system.type.getgenericarguments.aspx)。例如：

```
using System;
using System.Collections.Generic;

public class Test
{
    static void Main()
    {
        var dict = new Dictionary<string, int>();

        Type type = dict.GetType();
        Console.WriteLine("Type arguments:");
        foreach (Type arg in type.GetGenericArguments())
        {
            Console.WriteLine("  {0}", arg);
        }
    }
} 
```

输出：

```
Type arguments:
  System.String
  System.Int32 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-16T14:15:02.983

使用 Type.GetGenericArguments()。例如：

```
using System;
using System.Reflection;

namespace ConsoleApplication1 {
  class Program {
    static void Main(string[] args) {
      MyType<int> anInstance = new MyType<int>();
      Type type = anInstance.GetType();
      foreach (Type t in type.GetGenericArguments())
        Console.WriteLine(t.Name);
      Console.ReadLine();
    }
  }
  public class MyType<T> { }
} 
```

输出：Int32

# agile - 在 JIRA / Greenhopper 中跟踪用户故事

> ID：293909
> 
> 赞同：7
> 
> 时间：2008-11-16T14:13:31.190
> 
> 标签：agile, jira, user-stories, greenhopper

如果有人试图做敏捷，我正在想办法为此使用 JIRA / Greenhopper。我们是一个全球开发团队，因此分布式特性在这里至关重要。

我们最初使用 Scrumworks，但团队抱怨他们在 JIRA 和 scrumworks 中一直有重复的信息，并认为这是多余的。

我们得到了 Greenhopper，并认为这可以解决我们的问题，但我遇到的问题是：

1.  JIRA 中没有用户故事概念
2.  Greenhopper 过于专注于“任务”而没有在用户故事级别进行聚合。

有没有人在 JIRA 中成功地做到了这一点，或者我们是否应该考虑回到其他工具，如 scrumworks，只使用 JIRA 来解决我们支持团队提出的错误。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T03:56:27.410

您可以在 JIRA 中添加自己的问题类型。只需添加一个名为 User Story 的类型。

然后确保在 JIRA 中启用您的子任务功能。然后，您将能够将您的故事分解为多个子任务。如果您重用排名功能，则子任务的集成非常好。请参阅： http: [//www.greenpeppersoftware.com/confluence/display/GH/PLANNING+BOARD#PLANNINGBOARD-ordering](http://www.greenpeppersoftware.com/confluence/display/GH/PLANNING+BOARD#PLANNINGBOARD-ordering)

然后，您将能够

1) 在故事点中估算您的故事

2）优先处理您的问题（使用排名字段）

3) 在多个子任务中展开您的故事，您将在数小时内进行估算。

您应该在 GreenHopper 论坛上发布您的问题，可能会有更多更快的答案。[http://www.greenpeppersoftware.com/site/forums/list.page](http://www.greenpeppersoftware.com/site/forums/list.page)

干杯，

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-23T01:36:11.780

我正在使用 Jira 4.3 和 Greenhopper，它支持开箱即用的用户故事。还支持 Epics 和 Themes，但您必须进行一些配置。很可能这个内置功能是在原始问题的日期之后添加的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T07:11:52.940

您也可以尝试使用敏捷生命周期管理产品，例如 Rally，www.rallydev.com。Rally 从头开始​​构建，以支持任何敏捷流程并跨团队创建综合报告。看看这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-16T04:32:09.170

试试[Mingle](http://www.thoughtworks-studios.com/mingle-agile-project-management) - 这与 Jira 有[很好的集成，](http://community.thoughtworks.com/posts/ab8c8ee3a7)允许软件开发团队（使用 Mingle）和支持团队（使用 Jira）按照他们想要的方式工作。

# c# - 模型去哪儿了？

> ID：293915
> 
> 赞同：2
> 
> 时间：2008-11-16T14:19:46.607
> 
> 标签：c#, winforms, model-view-controller, mvp

我有一个 VS 解决方案，有以下项目。

-GUI -DataAccess -BusinessLogic
-BusinessObjects

但是主模型类应该在哪里？这通常是一组对象的缓存，这些对象是数据访问层和使用虚拟网格查看模型内部数据的 GUI 的结果。使用 MVC 或 MVP 的问题是一样的

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T15:21:01.977

这是一个主观问题，但通常为了强制您的模型对象与基础设施没有直接依赖关系，人们通常将它们放在单独的项目中。您还需要考虑哪些其他项目可能会使用这些模型对象。

将功能拆分为单独的可部署单元（组件）的另一种选择是，团队可以更加独立地运作。根据部署频率和团队自主权分离项目。

最后，我看到了一些项目，其中模型对象被远程调用（例如使用 .NET 远程处理）并在与 Web 服务器分开的应用程序服务器上提供服务。我真的不推荐这种方法，但它是一种选择。

如果您不打算重用它们，并且您意识到将它们放在同一个程序集中*允许*您与该项目中定义的任何其他内容创建交叉依赖项，但您足够聪明不这样做，您可以将它们全部放在同一个项目中。

也就是说，99% 的时间我都有这些项目：

*   用户界面
*   核
*   持久性
*   测试

但是您仍然必须考虑您的项目需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T15:45:24.673

我倾向于有

*   `Justice.Project.Core`— POCO 域模型 — 即业务对象）
*   `Justice.Project.Data`— NHibernate 映射等，持久性方案所在的位置
*   `Justice.Project.Services`— 存储库，以及无法轻松融入业务对象的业务逻辑
*   `Justice.Project.(Web|UI)`

模型*是*——或者*应该是*——业务对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T14:38:46.023

我的解决方案有 3 个（非测试）项目

1.  用户界面 - 显而易见
2.  核心——所有领域对象和业务逻辑
3.  数据访问 - 用于填充/保存模型对象的存储库模式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T17:18:29.447

> 我同意模型对象进入 POCO。所以可以说我有一个 Order 对象。我的问题是我在哪里有存储订单集合的类？

这取决于您的业务。您很可能会在几个不同的地方收集一系列订单......

在您的客户对象上，每个客户都应该有一个订单集合，所以您那里会有一个。

如果你有部门，每个部门都应该有他们创建的订单集合。

如果您有仓库，则每个仓库可能都有一组他们负责履行的订单。

有些对象没有父对象，这很好。在我的系统中，我们有客户。客户的真实世界所有者是我们（企业），但系统中没有“我们”对象。如果您正在寻找您的客户列表（在我们的例子中），我们会查询它的存储库。

```
IRespoistory<Client> repository = new Repository<Client>();
IList<Client> clients = repository.GetAllClients(); 
```

这同样适用于您的订单。

我建议你检查出这个DDD书：[http://www.amazon.com/gp/product/0321268202/ref=s9k2a_c1_at1-rfc_p-3237_p?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=center-1&pf_rd_r=1BWAPTN787CTZXJDV5BA&pf_rd_t=101&pf_rd_p=463383351&pf_rd_i=507846](https://rads.stackoverflow.com/amzn/click/com/0321268202)

# c# - 如何使用 C# 迭代分层数据并输出层次结构

> ID：293916
> 
> 赞同：2
> 
> 时间：2008-11-16T14:22:50.487
> 
> 标签：c#, .net

给定以下课程...

```
public class Category {
  public string Name {get;set;}
  public Category ParentCategory {get;set;}
} 
```

`IList<Category>`从Category 对象的集合（）中输出以下内容的最有效方法是什么？

```
+ Parent Category
++ Sub Category
++ Sub Category 2
+ Parent Category 2
++ Sub ...
++ Sub ..
++ Sub .... 
```

编辑：也许真正的问题应该是，我应该如何在数据库中表示这个模型并使用 NHibernate 检索它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T14:24:55.117

你不妨考虑扭转你们的关系。如果一个节点可以到达其父节点，但反之不行，则必须拥有*所有*叶节点才能打印出完整的树。将此与您让每个节点都知道其子节点的情况进行比较 - 那么您只需要根节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T14:57:14.100

一个小的递归函数可以为您完成。

```
static void recurseCategories(ref List<Category> cl, Category start, int level)
{
  foreach (Category child in cl)
  {
    if (child.ParentCategory == start)
    {
      Console.WriteLine(new String(' ', level) + child.Name);
      recurseCategories(ref cl, child, level + 1);
    }
  }
} 
```

我的假设是：

*   你有一个`List`of `Category`。（当然，您要打印的*所有*Category 对象都必须在该列表中。我认为这是不言而喻的，但似乎不是。）
*   根类别具有 的父级`null`。因此，初始函数调用应该是`recurseCategories(ref myCategoryList, null, 0)`.
*   您的列表中不存在孤立元素。应该添加一些错误处理代码。
*   输出顺序将与列表迭代的任何顺序一致，因此除了层次结构之外，它或多或少是巧合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T14:30:52.123

最近我阅读了有关分层 Linq 查询的信息，请查看[http://weblogs.asp.net/okloeten/archive/2006/07/09/Hierarchical-Linq-Queries.aspx](http://weblogs.asp.net/okloeten/archive/2006/07/09/Hierarchical-Linq-Queries.aspx)

但我倾向于同意 Jon Skeet。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T16:11:56.757

@Tomalok，当我使用此数据结构运行您的代码时，我得到两个节点：

```
class Program
{
    static void Main(string[] args)
    {
        var foo = new List<Category>();

        // Example structure from Question
        var fail1 = new Category() { Name = "test1" };
        var fail2 = new Category() { Name = "test2", ParentCategory = fail1 };
        var fail3 = new Category() { Name = "test3", ParentCategory = fail1 };
        var fail4 = new Category() { Name = "test4"};
        var fail5 = new Category() { Name = "test5", ParentCategory = fail4 };
        var fail6 = new Category() { Name = "test6", ParentCategory = fail4 };
        var fail7 = new Category() { Name = "test7", ParentCategory = fail4 };

        foo.Add(fail1);
        foo.Add(fail4);

        recurseCategories(ref foo, null, 0);

    }

    static void recurseCategories(ref List<Category> cl, Category start, int level)
    {
        foreach (Category child in cl)
        {
            if (child.ParentCategory == start)
            {
                Console.WriteLine(new String(' ', level) + child.Name);
                recurseCategories(ref cl, child, level + 1);
            }
        }
    }

    public class Category
    {
        public string Name { get; set; }
        public Category ParentCategory { get; set; }
    }

} 
```

输出：

```
test1
test4 
```

输出应该是：

```
test1
   test 2
   test 3
test 4
   test 5
   test 6
   test 7 
```

这是因为共享同一个父节点的子节点之间没有关系。

# c - 用 C 语言为微控制器编写应用程序

> ID：293923
> 
> 赞同：5
> 
> 时间：2008-11-16T14:34:35.610
> 
> 标签：c, embedded, microcontroller, pic

您知道哪些资源专门用于 PIC 微控制器的 C 语言软件开发？

我希望看到某种框架同时处理 IO（输入按钮和 LCD 输出）和应用程序逻辑。您可以将其视为一个非常简单的操作系统。我知道 PIC 的内存对于此类框架可能很小，所以我认为它可能是一个代码生成器，可以根据配置文件创建特定代码。然后，您添加特定于您的应用的代码片段。你见过类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T15:38:23.813

TinyOS（用 C 方言编写）已移植到一些 PIC 微控制器：

*   [http://www.tinyos.net](http://www.tinyos.net/)
*   [http://en.wikipedia.org/wiki/TinyOS](http://en.wikipedia.org/wiki/TinyOS)

但是，如果您要做的只是简单的 I/O，那么它的方式比您需要的更复杂，并且可能只自己编写代码比通过学习曲线更容易。

否则，可以使用 PLC“梯形逻辑”方法编写相当复杂的逻辑。有一个基于 PIC 微控制器的：

*   [http://www.cq.cx/ladder.pl](http://www.cq.cx/ladder.pl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T15:15:54.810

我从未见过这样的图书馆。这可能是因为 I/O 配置可能因一个项目而异，因此很难拥有一组“通用”功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T16:29:06.910

当然，这取决于哪个 PIC。PIC24/dsPIC 有许多中断级别，很容易使用它们来制作一个简单的基于优先级的调度程序。

对于确定性和良好的 A/D 过滤，很难击败具有几个基于定时器的中断级别的系统。

如果你真的想要一个操作系统，这里有一些：[Contiki](http://www.sics.se/contiki/) [pico|OS](http://picoos.sourceforge.net/) [TNKernel](http://www.tnkernel.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-27T23:22:40.903

查看 CCS C 编译器 ( [http://www.ccsinfo.com](http://www.ccsinfo.com) )。它有一个很好的综合库，用于处理数字 I/O、ADC、公共总线通信。教程和开发板也可用。

它有一个卓越的点对点支持论坛[http://www.ccsinfo.com/forum](http://www.ccsinfo.com/forum)。如果您正在考虑 CCS C，请务必查看此论坛，因为它会为您识别此 IDE 的一些特性。

它相对便宜。我已经使用它多年了。它一直在做足够的工作。

# iphone - SpeakHere 示例无法播放从互联网加载的声音

> ID：293929
> 
> 赞同：3
> 
> 时间：2008-11-16T14:42:22.880
> 
> 标签：iphone, cocoa-touch, audio, core-audio

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T20:17:29.503

Yes, you need to use [Audio File Stream Services](http://developer.apple.com/iphone/library/documentation/MusicAudio/Reference/AudioStreamReference/Reference/reference.html) to play directly from the internet.

I found the "AudioFileStreamExample" example useful, which should be installed in

```
/Developer/Examples/CoreAudio/Services/AudioFileStreamExample/ 
```

Also, Matt Gallagher has an article called "[Streaming and playing an MP3 stream](http://cocoawithlove.com/2008/09/streaming-and-playing-live-mp3-stream.html)" that includes iPhone example code. I haven't looked at it carefully, but it seems like it may be helpful to you.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-21T17:15:00.277

I think the main problem is that the code you are using deals with **AudioFile** objects (local audio files on disk) but when you load audio from the network you want to use **AudioFileStream**, which has its own set of API calls to use such as `AudioFileStreamOpen`, `AudioFileStreamParseBytes`, etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T01:57:29.180

I figured out a workaround. That is copy the content from internet to a local file, then play sound from that local file. And appears solve the problem.

Not perfect, but just works. If anyone has real solution, please let me know.

Here is the code to copy from internet to local file.

```
-(CFURLRef)saveURL:(NSString *)urlString {
    NSURL *url = (NSURL*)[[NSURL alloc] initWithString:urlString];
    NSData *data = [[NSData alloc] initWithContentsOfURL:url];
    NSArray *filePaths =    NSSearchPathForDirectoriesInDomains (                        NSDocumentDirectory,                                                        NSUserDomainMask,                                                   YES                                                    ); 

    NSString *recordingDirectory = [filePaths objectAtIndex: 0];

    CFStringRef fileString = (CFStringRef) [NSString stringWithFormat: @"%@/BufferFile.caf", recordingDirectory];
    NSLog(@"fileString = %@" , fileString);
    // create the file URL that identifies the file that the recording audio queue object records into
    CFURLRef fileURL =  CFURLCreateWithFileSystemPath (                                                NULL,   fileString,                                             kCFURLPOSIXPathStyle,                                             false);
    SInt32 err = 0;

    CFURLWriteDataAndPropertiesToResource (
  fileURL, (CFDataRef)data, nil, &err);
    return fileURL;
} 
```

# c# - 解决方案中的大多数项目

> ID：293938
> 
> 赞同：4
> 
> 时间：2008-11-16T14:52:57.040
> 
> 标签：c#, winforms, projects

对于 VS 2005，是否有最大数量的项目会导致性能问题。我们现在有多达 25 个项目并且还在不断增长。我们应该让这些二进制文件被引用还是我们将我们的应用程序逻辑分解成太多不同的项目。最近似乎开始成为一个大的性能问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T15:08:25.853

拥有过多的 DLL 文件可能会在运行时花费您，因此我建议您尽量减少项目数量。创建多个解决方案也是一种选择，但请尝试使解决方案彼此独立，这样您就不必在多个解决方案中调试和实现新功能 - 这可能很麻烦。

看看这篇文章：[项目反模式：Visual Studio 解决方案文件中的许多项目](http://www.lostechies.com/blogs/chad_myers/archive/2008/07/15/project-anti-pattern-many-projects-in-a-visual-studio-solution-file.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T03:23:13.733

是否存在贯穿所有 25 个项目的依赖链？如果某些项目不依赖于其他项目，请将它们放入自己的解决方案中。

如果您不需要并且通常不需要编译整个解决方案，请不要编译。通常您可以右键单击刚刚修改的项目并进行编译。VS 会找出需要重新编译哪些依赖项目。

除非您打算打断点，否则请使用“不调试就开始”。

某些 DLL 是否稳定且长时间未更改？它们也不必在您的解决方案中。

除非你真的必须，否则不要搜索整个解决方案。

真正的限制是人的思想。一个项目可以处理多少个文件？此外，除非您使用 ndepends 来跟踪依赖关系，否则在一个项目中放置多个类可能会导致过多的类依赖于其他类，从而使更改变得更加困难和风险更大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T03:33:34.337

通常我们会尝试将解决方案中的项目数量保持在 10 以下。在 10 之后，您开始有缓慢的编译时间和缓慢的“项目重新加载”时间。

但这里的主要问题是为什么你有 26 个项目？一个简单的网站只能有一个项目，而数据层、业务层、表示层都在同一个项目中。

如果你只为这 3 层的东西拆分项目，我建议你修改这个。例如，我们在 3 层有 3 个项目。我们在单独的程序集中有 3 层的原因是我们正在执行其他软件以在项目后期使用数据层。将我们的业务层保持在主演示项目之外，使我们能够轻松地对我们的业务层进行单元测试，同时将无用的依赖项保持在演示者层之外。

因此，总的来说，将项目保持在 10 个以下，并查看是否可以将一些项目合并在一起。它既可以在编译时也可以在构建时节省您的时间。管理这些 DLL 也将更加容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T16:54:27.497

我会说它在构建时而不是运行时花费你。少即是快，但也许您并不总是构建所有这些。如果是这种情况，那么您应该减少金额。否则将它们分成不同的解决方案。然后只有构建服务器需要构建所有这些，并且每日构建需要整夜构建;-)

# sql - 如何让 SQL 连接中的原始行不消失？

> ID：293946
> 
> 赞同：0
> 
> 时间：2008-11-16T14:59:15.983
> 
> 标签：sql

在此查询中：

```
SELECT COUNT(*) AS UserCount, Company.* FROM Company
LEFT JOIN User
ON User.CompanyId = Company.Id
WHERE Company.CanAccessSystem= true
AND(User.CanAccessSystem IS null OR User.CanAccessSystem = true)
GROUP BY Company.Id 
```

我想查询可以访问特定系统的公司列表以及公司内部可以访问该系统的用户数。

此查询适用于所有情况，除了一种非常重要的情况。如果公司可以访问系统但没有用户可以访问，则公司从查询中完全消失（即：Users.CanAccessSystem = false）。在这种情况下，我只想要 UserCount = 0。

可以访问系统的公司的示例：

```
Users   Company Name
1       WidgetWorks
3       WidgetCompany
0       WidgesRUs 
```

此系统在 MySQL 上

查询编辑：修复了错字“ON User.CompanyId = Company.Id”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T15:44:16.470

您的结果不起作用的原因是因为您没有任何连接子句。

```
SELECT IFNULL(COUNT(User.Id), 0) AS UserCount, Company.*
来自公司
左加入用户 User.CompanyId = Company.Id AND User.CanAccessSystem = true
WHERE Company.CanAccessSystem = true
GROUP BY Company.Id

```

那应该行得通。左连接的要点是主表条目应该始终出现，但左连接条目不一定要出现。

IFNULL() 仅用于返回 0，因为在这种情况下没有合适的用户将呈现 NULL 值。我不确定您如何在 MySQL 中处理布尔值，因为它本身不支持它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T16:16:39.180

我想我会从一个生成（不相交）联合的子查询开始：

*   公司 ID 和可以访问系统的用户的（非零）计数，其中至少有一个用户可以访问系统
*   没有用户可以访问系统时的公司 ID 和零计数

假设这`User.CanAccessSystem IS NULL`是解释 LEFT JOIN 所需的人工制品，则导致：

```
SELECT Company.ID, COUNT(*) AS UserCount
    FROM Company, User
    WHERE Company.ID = User.CompanyID
      AND User.CanAccessSystem = true
UNION
SELECT Company.ID, 0 AS UserCount
    FROM Company
    WHERE NOT EXISTS (SELECT * FROM User
                         WHERE Company.ID = User.CompanyID
                           AND User.CanAccessSystem = true) 
```

您可以使用“AND Company.CanAccessSystem = true”过滤这两个部分，如果大多数公司无法访问系统，这可能会有所帮助——或者您可以将其推迟到最终处理阶段。

然后，您需要将此结果与公司进行直接连接，确保公司能够访问系统的过滤条件应用于沿线的某处。

名义上，这会导致以下（未经测试的）代码：

```
SELECT UserCount, Company.*
    FROM Company JOIN
        (SELECT Company.ID AS ID, COUNT(*) AS UserCount
             FROM Company, User
             WHERE Company.ID = User.CompanyID
               AND User.CanAccessSystem = true
         UNION
         SELECT Company.ID AS ID, 0 AS UserCount
             FROM Company
             WHERE NOT EXISTS (SELECT * FROM User
                                  WHERE Company.ID = User.CompanyID
                                    AND User.CanAccessSystem = true)
        ) AS NumUsers
         ON Company.ID = NumUsers.ID
    WHERE Company.CanAccessSystem = true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T15:31:06.010

您应该计算 User.CanAccessSystem 为 true 的用户数。想想类似的东西

```
 count(case when User.CanAccessSystem then true end) 
```

如果 User.CanAccessSystem 为 false（默认），case 表达式将返回 NULL，并`count(expr)`计算表达式不为 null 的项目数。

所以这？

```
SELECT COUNT(case when User.CanAccessSystem then true end) AS UserCount, Company.*
FROM Company LEFT JOIN User
ON Company.id = user.companyId   -- I had to guess, this seems to be missing in your query
WHERE Company.CanAccessSystem= true
GROUP BY Company.Id 
```

ps 我使用 LEFT JOIN 而不是 INNER JOIN 是为了不排除没有用户的公司。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T15:31:49.787

这里有一个小技巧来做你想做的事，利用 bools are one or zeros you can sum(canaccess) 来获取可以访问系统的用户数量。为避免 NULL 出现问题，COALESCE 将 NULL 转换为 1（即，可以访问系统）

```
mysql> 从公司中选择 *；
+--------+------------+------------+
| 姓名 | company_id | 可以访问 |
+--------+------------+------------+
| 富 | 1 | 1 |
| 酒吧 | 2 | 1 |
| 巴兹 | 3 | 1 |
| 库克斯 | 4 | 1 |
+--------+------------+------------+
4 行一组（0.00 秒）

mysql> 从用户中选择 *；
+---------+------------+------------+
| 用户 ID | company_id | 可以访问 |
+---------+------------+------------+
| 1 | 1 | 1 |
| 2 | 1 | 0 |
| 3 | 1 | 1 |
| 4 | 2 | 空 |
| 5 | 2 | 1 |
| 6 | 2 | 0 |
| 7 | 3 | 1 |
| 8 | 3 | 0 |
| 9 | 4 | 0 |
+---------+------------+------------+
一组 9 行（0.00 秒）

mysql> select company_id, sum(canaccess) from
(选择 users.user_id, coalesce(users.canaccess,1) as canaccess,
users.company_id，company.name 从公司加入用户
on (users.company_id = Companies.company_id) where Companies.canaccess = 1) foo
按公司 ID 分组；
+------------+----------------+
| company_id | 总和（可以访问） |
+------------+----------------+
| 1 | 2 |
| 2 | 2 |
| 3 | 1 |
| 4 | 0 |
+------------+----------------+
4 行一组（0.00 秒）

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T17:03:12.317

我没有安装 MySQL ......

```
SELECT c.CompanyID, c.CompanyName, SUM(CASE u.CanAccessSystem WHEN 1 then 1 else 0 end) 
FROM Company c LEFT OUTER JOIN
    [User] u
ON u.CompanyID = c.CompanyID
WHERE c.CanAccessSystem = 1
GROUP BY c.CompanyID, c.CompanyName 
```

# css - IE中的提交按钮样式

> ID：293948
> 
> 赞同：7
> 
> 时间：2008-11-16T15:01:20.720
> 
> 标签：css, internet-explorer, submit

我对 Internet Explorer 的提交按钮行为有疑问。如果我加载页面一切都很好 - 提交按钮看起来应该。

[非活动状态 http://img58.imageshack.us/img58/7214/inactiveci9.jpg](http://img58.imageshack.us/img58/7214/inactiveci9.jpg)

但是，如果我在 FORM 内单击，提交按钮会获得一些我不喜欢的额外样式（有关更多信息，请参见图片）。

[![活动状态](https://i.stack.imgur.com/y9hpz.jpg)](https://i.stack.imgur.com/y9hpz.jpg)

如何禁用此行为。我在 Vista 下使用 IE7。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T15:50:13.087

CSS：

```
input:focus, 
input:active, 
input:hover 
{ 
   outline: none; 
   border: 1px solid; 
} 
```

没有保证，但这**应该**可以阻止 IE 变得愚蠢。

您应该稍微扩展上述样式，例如，更改背景颜色或边框颜色以提供指示焦点的替代更改。

（按 Tab，您会看到它移动；），附加样式是一个指示器，显示按 ENTER 后将执行的操作）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T15:28:47.483

这表示按钮已聚焦。键盘导航需要它。你不应该删除它。

但是，如果您将设计的外观看重于可用性和可访问性，那么请尝试[hideFocus](http://msdn.microsoft.com/en-us/library/ms533783.aspx)属性（至少它没有 有害`blur()`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T15:20:04.113

我在 IE 中遇到了同样的行为。据我所知，防止这种行为的唯一方法是将按钮边框属性设置为无 - 不理想，因为这显然会影响按钮的样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T15:21:52.630

这只是标准的 Windows 行为，其中默认按钮（即按 Enter 时单击的按钮）的边框稍厚。

# javascript - 带有动态生成元素的jQuery

> ID：293956
> 
> 赞同：4
> 
> 时间：2008-11-16T15:05:12.867
> 
> 标签：javascript, jquery

我使用 jQuery 已经有两个星期了，我注意到它可以很好地处理原始 HTML 文档中的对象，但是当我使用 jQuery 生成一个新元素时，库没有得到它的任何事件。

假设我尝试运行这样的东西：

```
$('.whatever').click(function() {
  alert("ALERT!");
}); 
```

如果 HTML 确实有这样的内容：

```
<span class="whatever">Whatever</span> 
```

然后点击这个词`Whatever`会给我一个很好的警报。

但是如果`span`元素是使用 jQuery 动态添加的，则单击它时不会发生任何事情。

有没有办法让 jQuery 以某种方式与这些元素一起工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-16T15:22:21.100

那是因为：（ [更正）]

```
$('.whatever').click(function() {
  alert("ALERT!");
}); 
```

字面意思是：

```
查找当前页面上具有“.whatever”类的所有元素
对于该结果集中的每个元素，将此函数绑定到其单击事件

```

所以很自然，添加一个新的 DOM 元素不会自动应用点击。

解决此问题的最佳方法是在插入阶段创建绑定，即：

```
 var x = document.createElement("span"); 
  $(x).click(function(){ });  //etc 
  $(somcontiner).append(x); 
```

### 关于简单地重新绑定所有内容的警告

如果做错了，可能会导致不良影响，即，使事件触发某事的次数增加。要停止这种情况，您可能需要先解除绑定以删除之前的传递绑定。

IE，

```
$(x).click(foo); 
$(x).click(bar);  //foo and bar should both execute. 
```

所以要阻止这个，你需要

```
$(x).unbind("click");
$(x).click(foo); 
```

在重新绑定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-08T15:15:56.333

如果您有 jQuery 1.3 或更高版本，请尝试使用[live](http://docs.jquery.com/Events/live)将事件添加到动态生成的元素：

```
$('.whatever').live("click", function() {
  alert("ALERT!");
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T19:41:26.240

谢谢大家。

不知何故，我认为元素是由 jQuery 自动添加到 DOM 中的，只需将它们添加到任何地方。

我还发现了有关该主题的一些额外信息：

[http://docs.jquery.com/Frequently_Asked_Questions#Why_do_my_events_stop_working_after_an_AJAX_request.3F](http://docs.jquery.com/Frequently_Asked_Questions#Why_do_my_events_stop_working_after_an_AJAX_request.3F)

[http://learningjquery.com/2008/03/working-with-events-part-1](http://learningjquery.com/2008/03/working-with-events-part-1)

[http://learningjquery.com/2008/05/working-with-events-part-2](http://learningjquery.com/2008/05/working-with-events-part-2)

以防万一其他人需要它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T15:18:32.637

你需要重新绑定它。

```
function bindme(){
    $('.whatever').click(function(){
        alert('binded');
    });
};

bindme();

//function that will generate something

function foo(){
   $('.whatever').val('oryt');
   bindme();//rebind itagain
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T15:28:26.220

另请查看[reglib](http://blogs.oracle.com/greimer/entry/reglib_javascript_library_now_available)，这是一个类似的库，可以实现您正在寻找的编程风格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T09:36:49.720

此外，还有一个出色的 jQuery 插件可以解决这个问题，称为[livequery](http://www.google.co.uk/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fbrandonaaron.net%2Fdocs%2Flivequery%2F&ei=CTshSaKvD4-M0QSDoK20CA&usg=AFQjCNHiEmyrBNe5Tyz1BDqcamx3ouO9ww&sig2=vzsusErgyoB2iPlq4JIjpg)

# javascript - 如何使用第一个下拉列表的 onChange 事件填充另一个下拉列表？

> ID：293959
> 
> 赞同：4
> 
> 时间：2008-11-16T15:05:48.403
> 
> 标签：javascript, jquery, html

使用 jquery 或仅使用简单的 javascript，我想从第一个下拉列表的选择中填充第二个下拉列表。第一个下拉列表的值是获取第二个下拉列表行的条件。

onChange 事件是怎样的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T15:15:53.110

实际上有一个插件可以做到这一点......

[http://code.google.com/p/jqueryselectcombo/](http://code.google.com/p/jqueryselectcombo/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-28T00:26:18.847

下面是一个实用但不太优雅的解决方案。这是一种根据首先选择美国 (US) 还是加拿大 (CA) 来填充州/省选择列表的方法。美国和美国各州默认可见。此方法依赖于简单的类命名约定来根据其父国家对州选项进行分组。

JS：

```
$('#s_country').change(function() {
    $('#s_state .state_CA').hide();
    $('#s_state .state_US').hide();
    $('#s_state').val('');
    var value = $.trim($("#s_country").val());
    $('#s_state').show();
    $('#s_state .state_'+ value).show();
}); 
```

的HTML：

```
<select name="s_state" id="s_state">
<option value="none"></option>
<? foreach ($states_us as $v):
    $selected = ($v->state_code == $current_state)?'selected="selected"':''; ?>
    <option class="state_US" value="<?=$v->state_code?>" <?=$selected?> ><?=ucfirst($v->state)?></option>
<? endforeach;?>
<? foreach ($states_ca as $v):
    $selected = ($v->state_code == set_value('s_state'))?'selected="selected"':'';                          ?>
    <option class="state_CA" value="<?=$v->state_code?>" <?=$selected;?>><?=ucfirst($v->state)?></option>
<? endforeach; ?>   
</select> 
```

希望这可以帮助。

# oop - 在构造函数中应该做多少工作？

> ID：293967
> 
> 赞同：51
> 
> 时间：2008-11-16T15:14:04.360
> 
> 标签：oop, constructor

应该在构造函数中执行可能需要一些时间的操作，还是应该构造对象然后稍后初始化。

例如，在构造表示目录结构的对象时，应在构造函数中完成对象及其子对象的填充。显然，一个目录可以包含目录，而目录又可以包含目录等等。

什么是优雅的解决方案？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-11-16T15:35:59.620

总结一下：

*   至少，您的构造函数需要将对象配置到其不变量为真的程度。

*   您对不变量的选择可能会影响您的客户。（对象是否承诺随时准备好访问？还是仅在某些状态下？）预先处理所有设置的构造函数可能会使生活更简单为班级的客户。

*   长时间运行的构造函数本身并不坏，但在某些情况下可能是坏的。

*   对于涉及用户交互的系统，任何类型的长时间运行的方法都可能导致响应能力差，应该避免。

*   将计算延迟到构造函数之后可能是一种有效的优化；可能没有必要执行所有工作。这取决于应用程序，不应过早确定。

*   总的来说，这取决于。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-16T15:18:34.337

您通常不希望构造函数进行任何计算。使用该代码的其他人不会期望它所做的不仅仅是基本设置。

对于您正在谈论的目录树，“优雅”的解决方案可能不是在构造对象时构建完整的树。相反，按需构建它。使用您的对象的人可能并不真正关心子目录中的内容，因此首先让您的构造函数列出第一级，然后如果有人想进入特定目录，然后在他们请求时构建树的那部分它。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-16T15:19:52.743

所需的时间不应成为不将某些东西放入构造函数的理由。您可以将代码本身放入一个私有函数中，然后从构造函数中调用它，以保持构造函数中的代码清晰。

但是，如果您想要做的事情不需要给对象一个定义的条件，并且您可以在第一次使用时稍后做这些事情，那么这将是一个合理的论据，可以将它放在以后再做。但是不要让它依赖于你的类的用户：这些东西（按需初始化）必须对你的类的用户完全透明。否则，对象的重要不变量可能很容易被破坏。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-16T15:23:09.897

这取决于（典型的 CS 答案）。如果您在启动时为长时间运行的程序构造对象，那么在构造函数中做大量工作是没有问题的。如果这是期望快速响应的 GUI 的一部分，则可能不合适。与往常一样，最好的答案是先尝试最简单的方法，然后从那里进行分析和优化。

对于这种特定情况，您可以对子目录对象进行惰性构造。仅为顶级目录的名称创建条目。如果它们被访问，则加载该目录的内容。在用户探索目录结构时再次执行此操作。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-16T16:01:56.213

构造函数最重要的工作是给对象一个初始的有效状态。在我看来，对构造函数最重要的期望是构造函数应该没有副作用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-16T17:15:54.507

我同意长期运行的构造函数本质上并不坏。但我会争辩说，你几乎总是做错事。我的建议与 Hugo、Rich 和 Litb 的建议类似：

1.  将您在构造函数中所做的工作保持在最低限度 - 将注意力集中在初始化状态上。
2.  除非无法避免，否则不要从构造函数中抛出。我尝试只抛出 std::bad_alloc。
3.  除非您知道它们的作用，否则不要调用操作系统或库 API - 大多数都可以阻止。它们将在您的开发盒和测试机器上快速运行，但在现场它们可能会因为系统忙于做其他事情而被长时间阻塞。
4.  永远，永远不要在构造函数中进行 I/O - 任何类型的。I/O 通常会受到各种非常长的延迟（数百毫秒到秒）的影响。I/O 包括
    *   磁盘 I/O
    *   任何使用网络的东西（即使是间接的）请记住，大多数资源都可以是现成的。

> I/O 问题示例：许多硬盘存在问题，即它们进入不服务读取或写入的状态达 100 毫秒甚至数千毫秒。第一代和第一代固态硬盘经常这样做。用户现在可以知道您的程序只是挂了一点-他们只是认为这是您的错误软件。

当然，长时间运行的构造函数的邪恶取决于两件事：

1.  “长”是什么意思
2.  在给定时间段内构造具有“长”构造函数的对象的频率。

现在，如果“长”只是几个 100 个额外时钟周期的工作，那么它并不是很长。但是构造函数正在进入 100 微秒的范围，我认为它很长。当然，如果您只实例化其中一个，或者很少实例化它们（比如每隔几秒一次），那么由于持续时间在此范围内，您不太可能看到问题。

频率是一个重要因素，如果您只构建其中的几个，500 us ctor 不是问题：但创建一百万个会带来严重的性能问题。

让我们谈谈您的示例：在“类目录”对象中填充目录对象树。（注意，我假设这是一个带有图形用户界面的程序）。在这里，您的 CTOR 持续时间不取决于您编写的代码 - 它的被告取决于枚举任意大目录树所需的时间。这在本地硬盘上已经够糟糕的了。它在远程（网络）资源上的问题更大。

现在，想象一下在您的用户界面线程上执行此操作 - 您的 UI 将停止在其轨道上几秒钟、几十秒钟甚至几分钟。在 Windows 中，我们称之为 UI 挂起。它们很糟糕（是的，我们有它们……是的，我们努​​力消除它们）。

UI 挂起会让人非常讨厌你的软件。

正确的做法是简单地初始化您的目录对象。在一个可以取消的循环中构建您的目录树并使您的 UI 保持响应状态（取消按钮应该始终有效）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-16T15:48:43.557

为了代码维护、测试和调试，我尽量避免将任何逻辑放在构造函数中。如果您更喜欢从构造函数执行逻辑，那么将逻辑放在诸如 init() 之类的方法中并从构造函数调用 init() 会很有帮助。如果您计划开发单元测试，则应避免将任何逻辑放在构造函数中，因为可能难以测试不同的案例。我认为之前的评论已经解决了这个问题，但是......如果您的应用程序是交互式的，那么您应该避免进行导致明显性能下降的单个调用。如果您的应用程序是非交互式的（例如：夜间批处理作业），那么单一的性能影响并不是什么大问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-01-05T08:02:49.753

从历史上看，我已经对构造函数进行了编码，以便一旦构造函数方法完成，对象就可以使用了。涉及多少或多少代码取决于对象的要求。

例如，假设我需要在详细信息视图中显示以下 Company 类：

```
public class Company
{
    public int Company_ID { get; set; }
    public string CompanyName { get; set; }
    public Address MailingAddress { get; set; }
    public Phones CompanyPhones { get; set; }
    public Contact ContactPerson { get; set; }
} 
```

由于我想在详细信息视图中显示有关公司的所有信息，因此我的构造函数将包含填充每个属性所需的所有代码。鉴于这是一个复杂类型，Company 构造函数也将触发 Address、Phones 和 Contact 构造函数的执行。

现在，如果我正在填充目录列表视图，我可能只需要 CompanyName 和主要电话号码，我可能在类上有第二个构造函数，它只检索该信息并将剩余信息留空，**或者**我可能只是创建一个单独的对象，只保存该信息。这实际上仅取决于如何检索信息以及从何处检索信息。

不管一个类上有多少个构造函数，我个人的目标是做任何必要的处理，为对象准备好可能被强加给它的任何任务。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-16T15:19:30.387

至于在构造函数中应该做多少工作，我想说它应该考虑到事情有多慢，你将如何使用这个类，以及你个人对它的总体感受。

在您的目录结构对象上：我最近为我的 HTPC 实现了一个 samba（windows 共享）浏览器，由于速度非常慢，我选择只在目录被触摸时才实际初始化它。例如，首先树只包含一个机器列表，然后每当您浏览到一个目录时，系统会自动从该机器初始化树并获取更深一层的目录列表，依此类推。

理想情况下，我认为您甚至可以编写一个工作线程来扫描目录广度优先，并优先考虑您当前正在浏览的目录，但通常这对于简单的事情来说工作量太大了；）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-16T16:29:53.833

确保 ctor 不做任何可能引发异常的事情。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-19T01:08:55.267

RAII 是 C++ 资源管理的支柱，所以在构造函数中获取你需要的资源，在析构函数中释放它们。

这是您建立类不变量的时候。如果需要时间，那就需要时间。您拥有的“如果 X 存在则做 Y”构造越少，该类的其余部分的设计就越简单。稍后，如果分析显示这是一个问题，请考虑延迟初始化等优化（在您第一次需要资源时获取资源）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-16T16:16:19.213

尽可能多，仅此而已。

构造函数必须将对象置于可用状态，因此至少应该初始化您的类变量。initted 的含义可以有广泛的解释。这是一个人为的例子。想象一下，你有一个类负责提供 N! 到您的呼叫应用程序。

实现它的一种方法是让构造函数什么都不做，使用带有循环的成员函数来计算所需的值并返回。

另一种实现它的方法是有一个类变量，它是一个数组。构造函数会将所有值设置为 -1，以指示该值尚未计算。成员函数会做惰性求值。它查看数组元素。如果为-1，则计算并存储并返回值，否则只返回数组中的值。

实现它的另一种方法就像最后一种方法一样，只有构造函数会预先计算值并填充数组，因此该方法可以将值从数组中拉出并返回。

实现它的另一种方法是将值保存在文本文件中，并使用 N 作为文件偏移量的基础以从中提取值。在这种情况下，构造函数将打开文件，而析构函数将关闭文件，而该方法将执行某种 fseek/fread 并返回值。

实现它的另一种方法是预先计算值，并将它们存储为类可以引用的静态数组。构造函数将不起作用，并且该方法将进入数组以获取值并返回它。多个实例将共享该数组。

综上所述，要重点关注的是，通常您希望能够调用一次构造函数，然后经常使用其他方法。如果在构造函数中做更多的工作意味着您的方法要做的工作更少，并且运行得更快，那么这是一个很好的权衡。如果你正在构造/破坏很多，比如在一个循环中，那么为你的构造函数设置高成本可能不是一个好主意。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-16T17:57:51.677

如果可以在构造函数之外完成某些事情，请避免在构造函数内部进行。稍后，当您知道您的班级在其他方面表现良好时，您可能会冒险在内部进行。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-16T15:20:09.247

这实际上取决于上下文，即课程必须解决的问题。例如，它是否应该始终能够显示其内部的当前子项？如果答案是肯定的，则不应将子项加载到构造函数中。另一方面，如果类表示目录结构的快照，则可以在构造函数中加载它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-21T10:49:14.023

我投票支持瘦构造函数，并在这种情况下为您的对象添加额外的“未初始化”状态行为。

原因：如果你不这样做，你就会强制所有用户要么拥有大量的构造函数，要么动态分配你的类。在这两种情况下，它都可能被视为麻烦。

如果这些对象变成静态的，可能很难从这些对象中捕获错误，因为构造函数会在 main() 之前运行，并且调试器更难以跟踪。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-12-21T11:02:46.153

很好的问题：你给出的“目录”对象引用其他“目录”对象的例子也是一个很好的例子。

对于这种特定情况，我将移动代码以在构造函数之外构建从属对象（或者可能按照此处的另一篇文章的建议执行第一级 [直接子级]），并具有单独的“初始化”或“构建”机制）。

否则还有另一个潜在问题——不仅仅是性能——那就是内存占用：如果你最终进行了非常深的递归调用，你也可能会遇到内存问题[因为堆栈将保留所有局部变量的副本直到递归结束]。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2008-11-16T15:33:54.320

尝试在那里拥有你认为必要的东西，不要考虑它是慢还是快。预优化是一种浪费时间，因此需要对其进行编码、分析和优化。

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2008-11-16T17:57:17.527

对象数组将始终使用默认（无参数）构造函数。没有办法解决这个问题。

有“特殊”构造函数：复制构造函数和 operator=()。

你可以有很多构造函数！或者稍后与很多构造函数结束。Bill 时不时地在 la-la 的土地上想要一个带有浮点数而不是双精度数的新构造函数来节省这 4 个糟糕的字节。（买一些 RAM 账单！）

您不能像调用普通方法那样调用构造函数来重新调用该初始化逻辑。

您不能将构造函数逻辑设为虚拟，并在子类中对其进行更改。（尽管如果您从构造函数而不是手动调用 initialize() 方法，则虚拟方法将不起作用。）

.

当构造函数中存在重要的逻辑时，所有这些事情都会造成很多麻烦。（或至少重复代码。）

因此，作为设计选择，我更喜欢使用最少的构造函数（可选地，取决于它们的参数和情况）调用 initialize() 方法。

根据具体情况，initialize() 可能是私有的。或者它可能是公共的并且支持多个调用（例如重新初始化）。

.

最终，这里的选择因情况而异。我们必须灵活，并考虑权衡。没有一种万能的。

我们用来实现一个具有单个单独实例的类的方法，该实例使用线程与一个专用硬件进行通信，并且必须在 1/2 小时内编写，这不一定是我们用来实现一个类的方法表示在数月内编写的可变精度浮点数的数学。

# jquery - 将元素添加到节点

> ID：293972
> 
> 赞同：0
> 
> 时间：2008-11-16T15:18:10.343
> 
> 标签：jquery

有一个HTML：

```
<div class="test">
<ul>
    <li>Item 1</li>
    <li>Item 2</li>
</ul>
</div> 
```

还有一点 JS：

```
$(document).ready(function() {
    // do stuff when DOM is ready
    $(".test ul").append('<li>Foo</li>');
}); 
```

为什么它什么都不添加，但是如果我从追加的参数字符串中删除 html，

```
.append('Foo') 
```

它有效 - 但这不是重点 - 新文本被添加为匿名块，而不是我想要的 li 项目。

阿努建议？

*编辑：* 啊，我发现了问题。我修改了从 Firefox 的“保存页面”选项保存的文件，扩展名为 .xhtml - 这就是问题所在。我重命名了它，它工作正常。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T15:21:15.347

从 JavaScript 添加实际的 HTML 相当难看，你有没有尝试过这样的事情：

```
var li=document.createElement("li");
li.appendChild(document.createTextNode("Dupa"));
$(".text ul").appendChild(li); 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T15:34:11.683

我检查了你的代码，它在我的机器上运行良好......所以我认为这不是 jQuery 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T15:42:01.263

扩展 Frans-Willems 代码：

```
jQuery(function($){
   /* This is exactly the same as that document ready thing */
   var li=document.createElement("li");
   $(li).text("Dupa");
   $(".text ul").append(li);
}); 
```

# windows - 如何在 Windows 全局范围内检测拖动操作？

> ID：293975
> 
> 赞同：1
> 
> 时间：2008-11-16T15:19:13.947
> 
> 标签：windows, drag-and-drop, mouse, hook

当我在 Windows XP 中拖动屏幕边缘的文件夹时，它会变成一个工具栏，其中包含文件夹中的文件。

windows如何检测到有拖动操作？

如果我想编写一个应用程序来检测系统范围内的拖动操作，我该怎么做？

还有一个问题：如何禁用这个 Windows XP 功能，真的很烦人。

# ruby - 在 Ruby 中标记已弃用代码的最佳实践？

> ID：293981
> 
> 赞同：139
> 
> 时间：2008-11-16T15:20:13.570
> 
> 标签：ruby, deprecated

我想将一个方法标记为已弃用，以便使用它的人可以轻松检查他们的代码并赶上进度。在 Java 中，您设置了 @Deprecated 并且每个人都知道这意味着什么。

那么有没有首选的方法（甚至工具）来标记和检查 Ruby 中的弃用情况？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2008-11-16T17:09:44.690

对于几乎所有情况，依赖库或元编程来弃用是过大的。只需向 rdoc 添加注释并调用该`Kernel#warn`方法。例如：

```
class Foo
  # <b>DEPRECATED:</b> Please use <tt>useful</tt> instead.
  def useless
    warn "[DEPRECATION] `useless` is deprecated.  Please use `useful` instead."
    useful
  end

  def useful
    # ...
  end
end 
```

* * *

如果您使用[Yard](http://yardoc.org/)而不是[rdoc](http://rdoc.sourceforge.net/)，您的文档注释应如下所示：

```
# @deprecated Please use {#useful} instead 
```

最后，如果您坚持[tomdoc](http://tomdoc.org/)，请让您的评论如下所示：

```
# Deprecated: Please use `useful` instead 
```

> *已弃用：表示该方法已弃用，将在未来版本中删除。您应该使用它来记录公开但将在下一个主要版本中删除的方法。*

* * *

另外，**不要忘记在将来的某个版本（以及正确的[semver](http://semver.org/) 'd 版本）**中删除不推荐使用的方法。不要犯与 Java 库一样的错误。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2014-05-09T00:11:58.233

Ruby 标准库有一个带有警告逻辑的模块：[https](https://ruby-doc.org/stdlib/libdoc/rubygems/rdoc/Gem/Deprecate.html) ://ruby-doc.org/stdlib/libdoc/rubygems/rdoc/Gem/Deprecate.html 。我倾向于以“标准”方式维护我的弃用消息：

```
# my_file.rb

class MyFile
  extend Gem::Deprecate

  def no_more
    close
  end
  deprecate :no_more, :close, 2015, 5

  def close
    # new logic here
  end
end

MyFile.new.no_more
# => NOTE: MyFile#no_more is deprecated; use close instead. It will be removed on or after 2015-05-01.
# => MyFile#no_more called from my_file.rb:16. 
```

请注意，通过这种方法，您将免费获得有关通话地点的信息。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-08-03T09:32:56.117

使用 ActiveSupport：

```
class Player < ActiveRecord::Base
  def to_s
    ActiveSupport::Deprecation.warn('Use presenter instead')
    partner_uid
  end
end 
```

生产环境默认关闭警告

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-05-25T22:29:47.017

如果您想变得刻薄（以乐于助人为幌子），您可以在警告期间打印出调用堆栈的第一行，让开发人员知道他们在哪里使用了已弃用的调用。

这很刻薄，因为**我很确定它会影响性能。**

```
warn Kernel.caller.first + " whatever deprecation message here" 
```

正确使用时，这将包括文件的绝对路径和使用过时调用的行。有关 Kernel::caller 的更多信息可[在此处获得](http://ruby-doc.org/core/classes/Kernel.html#M005929)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-06-27T09:42:28.163

您还可以使用`ActiveSupport::Deprecation`（在 4.0+ 版本中可用），例如：

```
require 'active_support/deprecation'
require 'active_support/core_ext/module/deprecation'

class MyGem
  def self.deprecator
    ActiveSupport::Deprecation.new('2.0', 'MyGem')
  end

  def old_method
  end

  def new_method
  end

  deprecate old_method: :new_method, deprecator: deprecator
end

MyGem.new.old_method
# => DEPRECATION WARNING: old_method is deprecated and will be removed from MyGem 2.0 (use new_method instead). (called from <main> at file.rb:18) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-16T15:31:12.487

你确实有[`libdeprecated-ruby`](https://packages.debian.org/search?keywords=libdeprecated-ruby)（2010-2012，2015 年不再在 ruby​​gem 上可用）

一个小型库，旨在帮助开发人员使用已弃用的代码。
这个想法来自 ' `D`' 编程语言，开发人员可以将某些代码标记为已弃用，然后允许/禁止执行已弃用代码的能力。

```
require 'lib/deprecated.rb'
require 'test/unit'

# this class is used to test the deprecate functionality
class DummyClass
  def monkey
    return true
  end

  deprecate :monkey
end

# we want exceptions for testing here.
Deprecate.set_action(:throw)

class DeprecateTest < Test::Unit::TestCase
  def test_set_action

    assert_raise(DeprecatedError) { raise StandardError.new unless DummyClass.new.monkey }

    Deprecate.set_action(proc { |msg| raise DeprecatedError.new("#{msg} is deprecated.") })

    assert_raise(DeprecatedError) { raise StandardError.new unless DummyClass.new.monkey }

    # set to warn and make sure our return values are getting through.
    Deprecate.set_action(:warn)

    assert_nothing_raised(DeprecatedError) { raise StandardError.new unless DummyClass.new.monkey } 
  end
end 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-07T06:47:43.960

您可以使用类宏模式并编写如下内容：

```
class Module     
     def deprecate(old_method, new_method)
          define_method(old_method) do |*args, &block|
               warn "Method #{old_method}() depricated. Use #{new_method}() instead"
               send(new_method, *args, &block)
          end
     end
end

class Test
     def my_new_method
          p "My method"
     end

     deprecate :my_old_method, :my_method
end 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-02-07T11:34:39.913

使用 rails 时，您有 Module#deprecate 方法。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-01T11:50:05.030

[Canivete](http://github.com/qmx/canivete)是一个宝石，它使您能够以简单而优雅的方式弃用您的方法。更多关于它的[信息](http://www.diegocarrion.com/2010/05/27/ruby-annotations/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-15T00:46:23.397

最后我总结了一个轻量级的方法：

```
def deprecate(msg)
  method = caller_locations(1, 1).first.label
  source = caller(2, 1).first
  warn "#{method} is deprecated: #{msg}\ncalled at #{source}"
end 
```

然后要弃用方法，在方法主体（或类的构造函数）中插入调用

```
def foo
  deprecate 'prefer bar, will be removed in version 3'
  ...
end 
```

它是相当声明性的，并提供相关信息的日志记录。我不是一个 Rubyist，所以它可能需要一些调整/YMMV。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-09-04T13:26:56.987

我们可以使用内部宏方法。例子：

`class Foo def get_a; puts "I'm an A" end def get_b; puts "I'm an B" end def get_c; puts "I'm an C" end`

```
def self.deprecate(old_method, new_method)
  define_method(old_method) do |*args, &block|
     puts "Warning: #{old_method} is deprecated! Use #{new_method} instead"
     send(new_method, *args, &block) 
```

结束结束

弃用 :a, :get_a 弃用 :b, :get_b 弃用 :c, :get_c 结束

o = Foo.new poa

# c++ - C ++中向量的通用向量

> ID：293988
> 
> 赞同：50
> 
> 时间：2008-11-16T15:26:26.363
> 
> 标签：c++, stl

C++ 中是否有一种好方法来实现（或伪造）向量的通用向量的类型？

忽略向量向量何时是一个好主意的问题（除非有等效的东西总是更好）。假设它确实准确地建模了问题，并且矩阵没有准确地建模问题。还假设将这些东西作为参数的模板化函数确实需要操纵结构（例如调用 push_back），因此它们不能只采用支持`[][]`.

我想做的是：

```
template<typename T>
typedef vector< vector<T> > vecvec;

vecvec<int> intSequences;
vecvec<string> stringSequences; 
```

但当然这是不可能的，因为 typedef 不能被模板化。

```
#define vecvec(T) vector< vector<T> > 
```

很接近，并且可以避免在每个在 vecvecs 上运行的模板化函数中重复类型，但不会受到大多数 C++ 程序员的欢迎。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-16T15:31:50.817

你想要模板类型定义。当前的 C++ 尚不支持该功能*。*一种解决方法是

```
template<typename T>
struct vecvec {
     typedef std::vector< std::vector<T> > type;
};

int main() {
    vecvec<int>::type intSequences;
    vecvec<std::string>::type stringSequences;
} 
```

在下一个 C++（称为 c++0x，由于 2010 年称为 c++1x）中，这将是可能的：

```
template<typename T>
using vecvec = std::vector< std::vector<T> >; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-18T10:47:03.667

我使用在 boost 库中实现的[Boost.MultiArray 。](http://www.boost.org/doc/libs/release/libs/multi_array/doc/user.html)

高温高压

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T22:39:01.590

您可以简单地创建一个新模板：

```
#include <string>
#include <vector>

template<typename T>
struct vecvec : public std::vector< std::vector<T> > {};

int main() 
{
    vecvec<int> intSequences;
    vecvec<std::string> stringSequences;
} 
```

如果你这样做，你必须记住 vector 的析构函数不是虚拟的，不要做这样的事情：

```
void test()
{
    std::vector< std::vector<int> >* pvv = new vecvec<int>;
    delete pvv;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-06T00:24:58.213

`std::vector`您可以使用作为基础来实现基本的向量类型：

```
#include <iostream>
#include <ostream>
#include <vector>
using namespace std;

template <typename T>
struct vecvec
{
    typedef vector<T> value_type;
    typedef vector<value_type> type;
    typedef typename type::size_type size_type;
    typedef typename type::reference reference;
    typedef typename type::const_reference const_reference;

    vecvec(size_type first, size_type second)
        : v_(first, value_type(second, T()))
    {}

    reference operator[](size_type n)
    { return v_[n]; }

    const_reference operator[](size_type n) const
    { return v_[n]; }

    size_type first_size() const
    { return v_.size(); }

    size_type second_size() const
    { return v_.empty() ? 0 : v_[0].size(); }

    // TODO: replicate std::vector interface if needed, like
    //iterator begin();
    //iterator end();

private:
    type v_;

};

// for convenient printing only
template <typename T> 
ostream& operator<<(ostream& os, vecvec<T> const& v)
{
    typedef vecvec<T> v_t;
    typedef typename v_t::value_type vv_t;
    for (typename v_t::size_type i = 0; i < v.first_size(); ++i)
    {
        for (typename vv_t::size_type j = 0; j < v.second_size(); ++j)
        {
            os << v[i][j] << '\t';
        }
        os << endl;
    }
    return os;
}

int main()
{
    vecvec<int> v(2, 3);
    cout << v.first_size() << " x " << v.second_size() << endl;
    cout << v << endl;

    v[0][0] = 1; v[0][1] = 3; v[0][2] = 5;
    v[1][0] = 2; v[1][1] = 4; v[1][2] = 6;
    cout << v << endl;
} 
```

它只是一个模拟矩阵的非常简单的容器（只要用户承诺，通过改进 vecvec 定义或通过正确使用，矩形形状）。

# c# - 报告生成代码会去哪里。

> ID：293989
> 
> 赞同：1
> 
> 时间：2008-11-16T15:28:16.203
> 
> 标签：c#, winforms, projects-and-solutions

我有一个包含以下项目的视觉工作室解决方案：

1.  用户界面
2.  数据访问
3.  业务逻辑
4.  业务对象

我现在有一堆代码可以生成通过电子邮件发送或保存为 csv 文件的报告。

这些 ReportGenerators 类接收业务对象并输出文件或字符串。

你会把它们放在哪个项目中？我倾向于答案，但想看看其他人的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T16:35:23.590

我会创建一个单独的报告项目。它不属于 UI（我假设它们在后台运行）——它实际上是一个“报告逻辑”层。

如果您考虑如何支持报告，您可能需要后端服务，但将来您可能还希望通过 Web 服务公开数据。如果您需要为用户提供前端报告工具，您可以像普通 UI -> 逻辑 -> 数据访问架构一样插入报告逻辑。

此外，如果您将报告代码分离出来，那么您将来可以自由地将其提取到专用的报告层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T19:12:41.383

同意 manwood 的帖子 - 您应该将它们构建为报告（如有必要，在报告后面放置一个 sproc），原因如下：

*   您可以运行报表并通过 ReportViewer 控件显示它们。这很简单。

*   您（更重要的是支持该应用程序的其他人）可以使用更多报告扩展该应用程序，而无需发布该应用程序的另一个版本。如果您不想被绑定到支持应用程序，这是一个非常有用的功能。

*   您也可以通过报告服务发布报告。

*   您可以通过 Reporting Services 框架获得报告服务（Excel、csv、pdf 等）的所有数据导出选项。

# database - 在数据库中存储地理位置的最有效方法

> ID：293997
> 
> 赞同：5
> 
> 时间：2008-11-16T15:32:58.613
> 
> 标签：database, geolocation, geocoding

我知道 postgres 有一种用于存储地理坐标的数据类型。但我正在寻找与 RDBMS 无关的解决方案。目前我在 MySQL 中使用 Decimal(25,20)。稍后我可能会使用这些数据根据与给定位置的给定距离来查找这些位置。哪种方法是存储此类数据的最佳方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T15:44:53.037

另一种好的技术是将这些值乘以一个常数并将它们存储为整数值。仅使用整数也有助于加快计算速度。

除非您非常需要精度，否则您实际上只需要在小数点后存储 5+ 个值。

此[纬度经度数据存储规范](http://www.tbs-sct.gc.ca/rpm-gbi/guides/Latlong_e.asp)提供了一个显示精度与小数位的图表。

```
# decmal places, example, precision
5    51.22135    ± 0.8 m
6   50.895132   ± 0.08 m 
```

7 将计算为 8 毫米，或约 0.314 英寸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T15:42:01.917

标准在[这里](http://portal.opengeospatial.org/files/?artifact_id=18241)。尽管对于像您这样的简单用例来说太多了，但它可能会让您了解为什么实际上最好去使用许多数据库现在拥有的一些符合 OGC 的包，甚至是[MySQL](http://dev.mysql.com/tech-resources/articles/4.1/gis-with-mysql.html)。

如果做不到这一点，并且假设您将实现距离计算的算法，那么任何具有您需要的精度的浮点数都可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T16:05:47.550

AFAIK，MS SQL Server 2008 支持将 GeoLocations 作为数据类型。我知道您正在使用 MySQL，但只是想我会在这个问题上提到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T16:54:00.727

[vfilby 的答案](https://stackoverflow.com/questions/293997/most-efficient-way-for-storing-geolocations-in-a-database#294014)可能是最好的答案，但是许多 RDBMS 对索引*字符*字段的支持比索引*密集*整数（或浮点）字段更好。

仅出于这个原因，我可能会建议首先转换数据：如果您想找到“接近”另一个值的值，您还需要一个保留此值的函数 - 也许通过转换为 base36 和 -`_`填充到小数点，但是如果您只需要完全匹配，几乎任何快速散列函数都可以。

再说一遍：如果您没有大量数据，或者您没有使用这样的 RDBMS，请执行[vfilby 建议](https://stackoverflow.com/questions/293997/most-efficient-way-for-storing-geolocations-in-a-database#294014)的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T15:58:23.773

按照[@vfilby 的](https://stackoverflow.com/questions/293997/most-efficient-way-for-storing-geolocations-in-a-database#294014)回答，为什么不将数字的两半存储为两个单独的 int 类型？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T16:38:21.103

我一直只是用 4 字节的浮点列来保存经纬度，因为精度上的误差远小于我们使用的设备的精度。您的应用程序可能不是这种情况，但如果是这种情况，您将无法获得比浮点数更多的 RDBMS 不可知论。*******