# StackOverflow 问答 12412000-12412999

# windows - 基本的 Windows 命令（ping、ipconfig）需要管理员权限 - 寻找一个选项

> ID：12412000
> 
> 赞同：3
> 
> 时间：2012-09-13T17:52:21.003
> 
> 标签：windows, windows-7, cmd

在我的主电脑（Win 7 64 位）上，像 ping 和 ipconfig 这样的基本 Windows 命令突然需要管理员权限。

如果我启动一个普通的命令行窗口，这些命令就找不到了（“X 不被识别为内部或外部命令、可运行程序或批处理文件。”）

如果我使用“以管理员身份运行”启动命令行窗口，一切都会按预期工作。

在我的第二台 PC（Win 7 32 位）上，我不需要管理员权限。而且我坚信几周前我不需要在我的主电脑上拥有管理员权限。一定有一些东西发生了变化，因此我认为一定有一些（注册表）开关或其他东西。

有任何想法吗？多谢

**[编辑]**

我仍然是管理员用户 - 只是正常启动 cmd，而不是“以管理员身份运行”

**[编辑2]**

它确实是 PATH 变量。问题是，路径在注册表中被保存为错误类型的字符串

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path 
```

必须是 REG_EXPAND_SZ，如[本线程](http://www.pcreview.co.uk/forums/cmd-exe-not-recognizing-system32-path-t309480.html)中所述。路径的字符串类型错误使其无法扩展 %SystemRoot%。确保您的系统 PATH 和用户 PATH 环境变量都是 REG_EXPAND_SZ 类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-20T03:29:10.493

为了缩小问题范围，请尝试以下操作：

*   打开命令提示符
*   确保您在`C:\`目录中
*   输入这个：`windows\system32\ipconfig /all`

这将指向命令的默认位置...您还可以按照路径查看 ipconfig.exe 是否首先存在。如果这不起作用或文件不存在，则它可能已损坏，或者您可能感染了旨在禁用这些命令的病毒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:06:51.440

srart 正常 cmd 提示并查看以下命令的输出

```
set path
dir %windir%\system32\ping.exe
dir %windir%\syswow64\ping.exe
dir %windir%\sysnative\ping.exe 
```

想了想，他们会告诉你一个问题。可能是 %path% 找不到 ping 或以某种方式...

# xml - 在 VBS 脚本中出现 MSXML 80070057“参数不正确”错误

> ID：12412002
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:52:46.130
> 
> 标签：xml, vbscript, msxml

这个小 VBS 脚本中的所有内容都可以正常工作，直到我到达下面所示的最后一行代码。到达该行后，脚本会抛出错误“参数 80070057.

在花费大量时间谷歌搜索之后，错误代码的含义大致相同，参数不正确。

```
'section 15
Set lots = xmlDoc3.selectNodes("ArrayOfLot/Lot")

For Each lot in lots
    Dim nl: Set nl = lot.cloneNode(true)
    xmlDoc4.documentElement.appendChild nl
Next

xmlDoc4.save xmlDoc4.url 'this code works

'**************************************************************************
'section 16 
Set lots = xmlDoc5.selectNodes("ArrayOfLot/Lot")

For Each lot in lots
    Dim nll: Set nll = lot.cloneNode(true)
    xmlDoc6.documentElement.appendChild nll
Next

xmlDoc6.save xmlDoc6.url 'this does not work - error thrown 
```

这真的很令人沮丧，因为 .save 仅比它高 8 行。有没有人知道我的问题可能是什么以及我如何解决它？

根据下面的答案，我发布了声明所有文档信息的代码：

```
Dim xmlFilePath6: xmlFilePath6 = "section16.xml"
Dim xmlDoc6: set xmlDoc6 = CreateObject("MSXML2.DomDocument")
xmlDoc6.async = "false"
xmlDoc6.load xmlFilePath6 
```

这实际上是针对 6 个不同的文档完成的，将 6 替换为其他数字 1-8 之一。我仍然感到困惑，因为 section16.xml 存在并且加载时没有抛出错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T02:59:27.720

**更新：**我调整了我的代码，使其`xmlDoc6`不再与文件关联，并且我重现了您的错误：

```
demo.vbs(67, 1) msxml3.dll: The parameter is incorrect. 
```

要重现您的错误，而不是这样：

```
xmlDoc6.load "xmlDoc6.xml" 
```

...我这样初始化`xmlDoc6`：

```
xmlDoc6.loadXML xmlText 
```

**预感：**确保`xmlDoc6`与文件相关联。如果不是，则 的值`xmlDoc6.url`将是空字符串。

* * *

**原文：**我写了一个完整的程序来说明你的用例。但是，我没有收到`incorrect parameter`您在尝试`xmlDoc6.save xmlDoc6.url`. 但也许我的程序中的某些内容会脱颖而出，从而引导您找到解决方案。

对于任何有兴趣的人，要运行这个程序，请将文本复制到一个名为 say, 的文件中`demo.vbs`，然后通过以下方式运行它：

```
cscript demo.vbs 
```

控制台的输出应如下所示：

```
Creating XML documents 3 through 6.
Saving file:///c:/Users/DavidRR/temp/xmlDoc4.xml
Saving file:///c:/Users/DavidRR/temp/xmlDoc6.xml
Done. 
```

* * *

```
' demo.vbs - Use MSXML to edit and save multiple XML files.

Option Explicit

Dim xmlText : xmlText = "" _
    & "<?xml version='1.0' encoding='utf-8'?>" _
    & "<ArrayOfLot>" _
    & "  <Lot>" _
    & "    Lot One" _
    & "  </Lot>" _
    & "  <Lot>" _
    & "    Lot Two" _
    & "  </Lot>" _
    & "  <Lot>" _
    & "    Lot Three" _
    & "  </Lot>" _
    & "</ArrayOfLot>" _
    & ""

WScript.Echo "Creating XML documents 3 through 6."

Dim  xmlDoc3 : Set xmlDoc3 = CreateObject("Msxml2.DOMDocument")
Dim  xmlDoc4 : Set xmlDoc4 = CreateObject("Msxml2.DOMDocument")
Dim  xmlDoc5 : Set xmlDoc5 = CreateObject("Msxml2.DOMDocument")
Dim  xmlDoc6 : Set xmlDoc6 = CreateObject("Msxml2.DOMDocument")

xmlDoc3.loadXML xmlText
If xmlDoc3.parseError.errorCode <> 0 Then
    WScript.Echo "Couldn't load xmlDoc3: " & xmlDoc3.parseError.reason
    WScript.Quit(1)
Else
    ' WScript.Echo "Loaded XML [" & xmlDoc3.documentElement.xml & "]"
End If

' WScript.Echo xmlDoc3.Xml
xmlDoc3.save "xmlDoc4.xml"
xmlDoc3.save "xmlDoc5.xml"
xmlDoc3.save "xmlDoc6.xml"

xmlDoc4.load "xmlDoc4.xml"
xmlDoc5.load "xmlDoc5.xml"
xmlDoc6.load "xmlDoc6.xml"
' xmlDoc6.loadXML xmlText
' WScript.Echo "xmlDoc6.url = [" & xmlDoc6.url & "]"

' section 15
Set lots = xmlDoc3.selectNodes("ArrayOfLot/Lot")
' WScript.Echo lots.length

Dim lot, lots
For Each lot In lots
    Dim nl: Set nl = lot.cloneNode(True)
    xmlDoc4.documentElement.appendChild nl
Next

WScript.Echo "Saving " & xmlDoc4.url
xmlDoc4.save xmlDoc4.url 'this code works

'**************************************************************************
' section 16
Set lots = xmlDoc5.selectNodes("ArrayOfLot/Lot")

For Each lot in lots
    Dim nll: Set nll = lot.cloneNode(true)
    xmlDoc6.documentElement.appendChild nll
Next

WScript.Echo "Saving " & xmlDoc6.url
xmlDoc6.save xmlDoc6.url ' reportedly does not work...but it works here.

Set xmlDoc6 = Nothing
Set xmlDoc5 = Nothing
Set xmlDoc4 = Nothing
Set xmlDoc3 = Nothing

WScript.Echo "Done."

' End 
```

# excel - 在 Excel 中打开文档后，从第一个选项卡复制数据并注意

> ID：12412004
> 
> 赞同：0
> 
> 时间：2012-09-13T17:52:53.553
> 
> 标签：excel, vba

我有一个需要打开的工作簿，然后从第一个选项卡复制数据，然后将其粘贴到创建脚本的原始工作簿中。

我遇到的问题是工作簿和第一个选项卡将被命名为相同的东西。因此，如果工作簿名称是`OpenPOs-100255-08292012.xls`选项卡，则`OpenPOs-100255-08292012`. 下周虽然 excel 表将是`OpenPOs-200211-12495312.xls`，这意味着选项卡将是`OpenPOs-200211-12495312`。

使用我现在使用的代码，有没有办法让它适用于这种情况？我想过让它`"Sheet 1"`成为当天的标签吗？我考虑过使用 `wsPOR.Sheets(wsPOR) 但我有一种感觉会作为错误回来。有人可以帮忙吗？

```
Sub Update_TNOOR()
    Dim wsTNO As Worksheet
    Dim wsTND As Worksheet
    Dim wsTNA As Worksheet
    Dim wbPOR As Workbook               'New Workbook
    Dim wbOOR As Workbook               'ThisWorkbook
    Dim lastrow As Long, lastrow2 As Long, fstcell As Long
    Dim strFile As String, NewFileType As String, filename As String

    Set wsTNO = Sheets("Tel-Nexx OOR")
    Set wsTND = Sheets("Tel-Nexx Data")
    Set wsTNA = Sheets("Tel-Nexx Archive")
    Set wbOOR = ThisWorkbook

    With Application
        .ScreenUpdating = False
        .DisplayAlerts = False
        .EnableEvents = False
    End With

    lastrow = wsTND.Range("A" & Rows.Count).End(xlUp).Row + 1
    wsTND.Range("A2:P" & lastrow).Delete

    strFile = Application.GetOpenFilename()
    NewFileType = "Excel Files 2007 (*.xls)"
    Set wbPOR = Application.Workbooks.Open(strFile)
    lastrow = wbPOR.Sheets("Sheet1").Range("A" & wbPOR.Sheets("Sheet1").Rows.Count).End(xlUp).Row
    wbPOR.Sheets("Sheet1").Range("A4:N" & lastrow).Copy wbOOR.Sheets("Tel-Nexx Data").Range("A2")
    wbPOR.Save
    wbPOR.Close

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:18:21.150

根据我上面的评论，您的代码 from`strFile = Application.GetOpenFilename()`变为`wbPOR.Close`：

```
strFile = Application.GetOpenFilename()
NewFileType = "Excel Files 2007 (*.xls)"

Set wbPOR = Application.Workbooks.Open(strFile)

Dim wsPOR As Worksheet
Set wsPOR = wbPOR.Sheets(Replace(wbPOR.Name, ".xls", ""))

lastrow = wsPOR.Range("A" & wsPOR.Rows.Count).End(xlUp).Row

wsPOR.Range("A4:N" & lastrow).Copy wbOOR.Sheets("Tel-Nexx Data").Range("A2")

wbPOR.Save
wbPOR.Close 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T17:57:12.173

使用[这个问题](https://stackoverflow.com/questions/12354592/excel-vba-regular-expression-get-file-name/12354829)的答案，并将其替换为您的`sheets()`参考

以我的回答为例，你`wbPOR.Sheets("Sheet1").`会变成

```
wbPOR.Sheets(left(strFile ,instrrev(strFile ,".")-1)). 
```

如果您扩展到更新的 excel 版本，这也将具有与其他扩展一起使用的优势。

# macos - mac 端口 32/64 位错误

> ID：12412006
> 
> 赞同：1
> 
> 时间：2012-09-13T17:53:00.823
> 
> 标签：macos, macports

通过 2011 mac book pro 在 Mac osx 10.7.4 上，我不断收到与以下问题相关的错误。

这些错误主要来自数学相关的开发库，这些开发库在各种 Linux 机器上编译和运行示例代码而没有错误，同时使用类似的 make 文件

我得到的错误通常是

```
ld: symbol(s) not found for architecture x86_64 
```

这也发生在各种编译器上，无论我如何编译我链接的 lib、clang、各种版本的 gcc 甚至是 haskell 的 ghc

一些给我错误的库是

*   PETSC（我从源代码编译，没有一个例子用 make test 编译）
*   GSL（来自macports）给出了同样的错误
*   FFTW ......而且名单还在继续

我相信罪魁祸首是某些地方（可能是编译器）是通过macports不正确地编译的，

例如`gcc -v`说它是编译的`Target: i686-apple-darwin11`

```
--build=i686-apple-darwin11 --enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.11~28/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 
```

而所有其他编译器，clang，g++-mp-4.7 exc，都说 Target: x86_64-apple-darwin11

这个问题有什么解决办法吗？

有没有办法重新编译所有强制 64 位的东西？能解决上面的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:56:46.380

Mac OS X 有自己的构建工具链，所以这可能是路径问题。

查看

```
which gcc 
```

并将路径与您知道来自 mac 端口（可能在 /opt/bin 中）的任何库进行比较。

作为一种解决方案，将 /opt/bin 路径放在 $PATH 的开头应该可以解决。

# oop - 用例将变量定义为“受保护”？

> ID：12412009
> 
> 赞同：1
> 
> 时间：2012-09-13T17:53:20.583
> 
> 标签：oop

我知道`protected`当想要使变量在扩展当前类的所有类中可见时应该使用，但这究竟意味着什么？最常见的用例是什么？

我想解决这个问题的另一种方法是，当您希望类变量从类的孩子而不是外部类可见时，关键情况是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:17:11.173

我遇到的大多数“受保护”访问修饰符的用例都是[“模板方法”模式](http://en.wikipedia.org/wiki/Template_method_pattern)的实例化。

在这种模式中，算法的细节被委托给子类。

实际上，受保护的访问在您的类不变量中创建了一个漏洞：子类可能会滥用成员，从而使您的不变量不再适用。

大多数时候，有比受保护访问更好的设计替代方案，[依赖倒置](http://en.wikipedia.org/wiki/Dependency_inversion_principle)是第一个想到的。

我的建议？不要将对象的内部结构发布给您不信任的任何人。谨慎使用“受保护”！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:58:52.640

受保护的变量有助于有效地访问基类的变量，而无需通过 get/set 约束。

受保护变量的有用性在开发应该用于其他应用程序的库中非常重要。它可以帮助您在 lib 环境中自由使用变量而不将它们公开，并且当您完成继承的类时，它们被禁止进入外部环境。

# c# - 事件处理程序可以在没有反射的情况下引用自己吗？

> ID：12412011
> 
> 赞同：1
> 
> 时间：2012-09-13T17:53:30.703
> 
> 标签：c#, events, event-handling, lambda, anonymous-methods

> **可能重复：在 C#**[单次事件订阅](https://stackoverflow.com/questions/5623658/single-shot-event-subscription)
> [中取消订阅匿名方法](https://stackoverflow.com/questions/183367/unsubscribe-anonymous-method-in-c-sharp)

是否可以从事件处理程序本身中获取对事件处理程序的引用，以便您可以从调用它的事件中解开它？

例如，我很想将 control.Loaded 事件指向一个 Lambda，但如果我这样做了，我不知道将什么传递给 unhook (-=) 调用。

这是代码的摘录：

```
private static void IsEnabled_Changed(object sender, DependencyPropertyChangedEventArgs e)
{
    var control = (Control)sender;

    if(control.IsLoaded)
        WireUpScrollViewerEvents(control);
    else
        control.Loaded += Control_Loaded;

}

private static void Control_Loaded(object sender, RoutedEventArgs e)
{
    var control = (Control)sender;

    control.Loaded -= Control_Loaded; // <-- How can I do this from a lambda in IsEnabled_Changed?

    WireUpScrollViewerEvents(control);
}

private static void WireUpScrollViewerEvents(Control control, bool attach)
{
    var scrollViewer = Utils.FindFirstVisualChild<ScrollViewer>(control);
    if(scrollViewer == null) return;

    var attachEvents = GetIsEnabled(control);

    if(attachEvents)
    {
        scrollViewer.PreviewDragEnter += ScrollViewer_PreviewDragEnter;
        scrollViewer.PreviewDragOver  += PreviewDragOver;
    }
    else
    {
        scrollViewer.PreviewDragEnter -= ScrollViewer_PreviewDragEnter;
        scrollViewer.PreviewDragOver  -= PreviewDragOver;
    }
} 
```

Control_Loaded 是一种实际方法的唯一原因是因为“control.Loaded -= Control_Loaded”行。我想知道我们是否可以直接从 IsEnabled_Changed 调用中匿名 lambda。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:23:18.403

## 好的，找到了。

好的，找到了。我无法让它工作的原因是我正在这样做......

```
RoutedEventHandler Control_Loaded = (s2, e2) =>
{
    control.Loaded -= Control_Loaded;
    WireUpScrollViewerEvents(control);
}; 
```

...当我应该这样做的时候...

```
RoutedEventHandler Control_Loaded = null; // <-- It's now declared before it's set, which is what we need
Control_Loaded = (s2, e2) =>
{
    control.Loaded -= Control_Loaded;
    WireUpScrollViewerEvents(control);
}; 
```

这是因为您必须先声明变量，然后才能使用它，而我试图将其用作声明的一部分。这解决了这个问题。

# php - 对象转换后的奇怪 foreach 行为

> ID：12412031
> 
> 赞同：0
> 
> 时间：2012-09-13T17:55:16.257
> 
> 标签：php, arrays, casting, stdclass

强制转换后，我遇到了奇怪的 PHP 行为。这是代码：

```
$obj = new stdClass();
$obj->{'0'} = "test";

$array = (array)$obj;
var_dump($array); 
```

此代码将输出：

```
array(1) { ["0"]=> string(4) "test" } 
```

绝对正常。

现在我添加一些代码：

```
foreach ($array as $key => $value) {
   $array[$key] = strtoupper($value);
}
var_dump($array); 
```

此代码输出：

```
array(2) {
  ["0"]=>
  string(4) "test"
  [0]=>
  string(4) "TEST"
} 
```

为什么我的 $key 强制转换为 int ？

如果我尝试一个更简单的例子：

```
$array = array("0" => "test");
foreach ($array as $key => $value) {
  $array[$key] = strtoupper($value);
}

var_dump($array); 
```

这将输出：

```
array(1) { [0]=> string(4) "TEST" } 
```

有人知道为什么我的 $key 会转换为 int 吗？

# 更新

我试图强制将我的密钥转换为字符串：

```
$array["{$key}"] = $value; 
```

和

```
$array[(string)$key] = $value; 
```

但它们是作为 int 插入的。所以我的问题应该是：有没有办法将键作为字符串插入到数组中？

我知道我可以通过使用第二个数组并解除字符串来解决我的问题：

```
$obj = new stdClass();
$obj->{'0'} = "test";
$array = (array)$obj;
$array2 = array();
foreach ($array as $key => $value) {
  $array2[$key] = strtoupper($value);
} 
```

但是如果以一种更漂亮的方式来制作它会很好，保留数据类型（并避免在迭代条目时重复条目，如前所述）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:59:21.527

来自 PHP 手册：

包含有效整数的字符串将被转换为整数类型。例如，键“8”实际上将存储在 8 下。另一方面，“08”不会被强制转换，因为它不是有效的十进制整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:43:19.710

@cHao 找到了一个干净且有效的解决方案，可以将对象转换为数组，而不需要 foreach() 问题。我的例子变成：

```
$array = array();
$obj = new stdClass();
$obj->{'0'} = "test";
foreach ($obj as $key => $value) {
   $array[$key] = strtoupper($value);
} 
```

stdClass 是可迭代的。

谢谢！

# awk - 根据特定列中的修改拆分表文件

> ID：12412035
> 
> 赞同：2
> 
> 时间：2012-09-13T17:55:25.493
> 
> 标签：awk, split, gnu

我有这种表：

```
classA, s1, ss1
classA, s1, ss2
classA, s2, ss1
classB, s1, ss1
classB, s1, ss2
classC, s1, ss1
classC, s2, ss1
classC, s2, ss2 
```

根据第一列中的连续值，我想将其拆分为 3 个名为“classA”、“classB”和“classC”的文件。我首先尝试找到一种使用 csplit 的方法，但它似乎只适用于指定的模式，而不是模式改变时。是否有任何 awk 方式或任何其他命令行工具可以做到这一点？

[更新] 我的第一列中还有一些导致该错误的斜线，例如：

```
classA, s1, ss1
classA, s1, ss2
classA, s2, ss1
classB, s1, ss1
classB, s1, ss2
classC, s1, ss1
classC, s2, ss1
classC, s2, ss2
classA/classA.1/classA.2, s1, ss1
classA/classA.1/classA.2, s1, ss2 
```

当我运行命令时：

```
awk -F, '{ print $0 > $1}' infile 
```

它在“classC”之前一直有效，但后来我遇到了那个错误，因为我猜它会将“/”解释为路径：

```
fatal: can't redirect to `classA/classA.1/classA.2' (No such file or directory) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:00:02.573

```
awk -F, '{ print $0 > $1}' infile 
```

**输出**

```
-rw-r--r-- 1 shellter root  48 Sep 13 14:01 classC
-rw-r--r-- 1 shellter root  32 Sep 13 14:01 classB
-rw-r--r-- 1 shellter root  48 Sep 13 14:01 classA 
```

其中 $1 有“/.../path/info，试试

```
awk -F, '{ outFile="$1"; gsub(/\//, "", outFile); print $0 > outFile }' infile 
```

如果你不这样做`gsub()`，任何 '/' 字符都将被解释为遵循创建输出文件的路径。当然，指定的路径需要存在，否则您将收到有关该影响的错误消息。

请注意，某些 awk 更喜欢使用 '/' 字符`gsub(/[\/]/,"", fileName)`，或者您甚至可能需要`[\\/]`将其作为搜索目标。

IHTH

# c# - 在 EntityFramework Join 语句中获取列数据

> ID：12412036
> 
> 赞同：0
> 
> 时间：2012-09-13T17:55:25.490
> 
> 标签：c#, entity-framework, linq-to-sql, linq-to-entities

我正在使用 EntityFramework（第一次）并设法进行查询、更新等。我有一个连接三个表的 linq 查询，如下所示：

```
//get a list of completed orders between the last run date of this job and NOW
        var completedOrders = from orders in db.orders
                              join orderStatus in db.orderStatus
                              on orders.statusID equals orderStatus.statusID
                              join aspnetUsers in db.aspnet_Users
                              on orders.userID equals aspnetUsers.UserId
                              into joined
                              where (orderStatus.statusID == 2 || orderStatus.statusID == 3 || orderStatus.statusID == 5) && (orders.dateTimeStamp > job.lastRunDate && orders.dateTimeStamp < DateTime.Now || !job.lastRunDate.HasValue)
                              select joined; 
```

然后我有一个简单的 foreach 循环：

```
foreach (var order in completedOrders)
        {

            //process here
        } 
```

我的问题是，如何获取 foreach 循环中的信息？我需要获取列数据，例如：

订购日期”]

虽然理想情况下我希望它是强类型的，因为我使用实体框架。

任何反馈将不胜感激。

提前感谢艾尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:08:08.380

您应该删除`into`并添加一个匿名类型：

```
...
on orders.userID equals aspnetUsers.UserId
where (orderStatus.statusID == 2 || orderStatus.statusID == 3 || orderStatus.statusID == 5) && (orders.dateTimeStamp > job.lastRunDate && orders.dateTimeStamp < DateTime.Now || !job.lastRunDate.HasValue)
select new { orders, orderStatus, aspnetUsers } 
```

然后你可以遍历结果

```
 foreach (var x in completedOrders)
 {
   // use x.orders.Date, etc.
 } 
```

# clojure - 在 Clojure 中，惰性 seq 总是分块吗？

> ID：12412038
> 
> 赞同：17
> 
> 时间：2012-09-13T17:55:27.770
> 
> 标签：clojure, lazy-evaluation, chunking, lazy-sequences

我的印象是惰性序列总是被分块的。

```
=> (take 1 (map #(do (print \.) %) (range)))
(................................0) 
```

正如预期的那样，打印了 32 个点，因为返回的惰性序列`range`被分块为 32 个元素块。但是，当`range`我不是用自己的函数尝试这个时`get-rss-feeds`，惰性序列不再被分块：

```
=> (take 1 (map #(do (print \.) %) (get-rss-feeds r)))
(."http://wholehealthsource.blogspot.com/feeds/posts/default") 
```

只打印了一个点，所以我猜返回的lazy-seq`get-rss-feeds`没有​​分块。确实：

```
=> (chunked-seq? (seq (range)))
true

=> (chunked-seq? (seq (get-rss-feeds r)))
false 
```

这是来源`get-rss-feeds`：

```
(defn get-rss-feeds
  "returns a lazy seq of urls of all feeds; takes an html-resource from the enlive library"
  [hr]
  (map #(:href (:attrs %))
       (filter #(rss-feed? (:type (:attrs %))) (html/select hr [:link]))) 
```

因此，chunkiness 似乎取决于惰性 seq 的产生方式。我查看了该函数的源代码，`range`并且有迹象表明它是以“矮胖”的方式实现的。所以我有点困惑这是如何工作的。有人可以澄清一下吗？

* * *

这就是我需要知道的原因。

我必须遵循代码：`(get-rss-entry (get-rss-feeds h-res) url)`

调用`get-rss-feeds`返回我需要检查的提要的惰性 URL 序列。

调用`get-rss-entry`查找特定条目（其 :link 字段与 get-rss-entry 的第二个参数匹配）。它检查由返回的惰性序列`get-rss-feeds`。评估每个项目需要跨网络的 http 请求来获取新的 rss 提要。为了最大限度地减少 http 请求的数量，重要的是要逐个检查序列并在匹配时立即停止。

这是代码：

```
(defn get-rss-entry
  [feeds url]
  (ffirst (drop-while empty? (map #(entry-with-url % url) feeds)))) 
```

`entry-with-url`如果没有匹配，则返回惰性匹配序列或空序列。

我对此进行了测试，它似乎可以正常工作（一次评估一个提要网址）。但我担心在某个地方，它会以某种“笨重”的方式开始表现，它会开始一次评估 32 个提要。我知道有一种方法[可以避免此处讨论的笨拙行为](https://stackoverflow.com/questions/3407876/how-do-i-avoid-clojures-chunking-behavior-for-lazy-seqs-that-i-want-to-short-ci)，但在这种情况下似乎甚至不需要。

我是否以非惯用方式使用惰性序列？循环/重复会是更好的选择吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-27T19:13:26.323

你的担心是对的。如果参数是返回分块序列的集合，您`get-rss-entry`确实会调用`entry-with-url`超过严格必要的参数。`feeds`例如，如果`feeds`是一个向量，`map`将一次对整个块进行操作。

这个问题直接在 Fogus*的 Clojure*中得到解决，函数`seq1`在第 12 章中定义：

```
(defn seq1 [s]
  (lazy-seq
    (when-let [[x] (seq s)]
      (cons x (seq1 (rest s)))))) 
```

你可以在你知道你想要最懒惰的地方使用它，就在你打电话之前`entry-with-url`：

```
(defn get-rss-entry
  [饲料网址]
  (ffirst (drop-while empty? (map #(entry-with-url % url) ( seq1 feeds)))))

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T15:44:25.287

惰性序列**并不总是分块**的——这取决于它们是如何产生的。

例如，这个函数产生的惰性序列是不分块的：

```
(defn integers-from [n]
  (lazy-seq (cons n (do (print \.) (integers-from (inc n))))))

(take 3 (integers-from 3))
=> (..3 .4 5) 
```

[但是出于性能原因（例如range](http://clojuredocs.org/clojure_core/clojure.core/range)），许多其他 clojure 内置函数确实会生成分块序列

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T18:30:12.920

正如您上面提到的，取决于分块的模糊性似乎是不明智的。在您确实需要不进行分块的情况下，明确地“取消分块”也是明智的，因为如果在其他时候您的代码以一种分块的方式发生变化，事情就不会中断。另一方面，**如果您需要按顺序执行操作，代理是一个很棒的工具**，您可以将下载功能发送给代理，然后无论您如何评估功能，它们都将一次运行一个，并且只运行一次。在某些时候，您可能想要`pmap`您的序列，然后即使使用原子将继续正常工作，即使取消分块也将不起作用。

# database - Solr - DataImportHandler：尝试使用列值作为字段名时，多值字段只保留第一个结果

> ID：12412040
> 
> 赞同：2
> 
> 时间：2012-09-13T17:55:44.373
> 
> 标签：database, solr, import, dataimporthandler, multivalue

我正在尝试使用类似于以下的文档配置执行完全导入：

```
<document>
    <entity name="parent" query="select * from parent_table" >
        <field name="id" column="ID" />
        <entity name="child" query="select * from child_table where PARENT_ID = ${parent.ID}" transformer="ClobTransformer" >
            <field name="${child.FIELD_COLUMN}" column="VALUE_COLUMN" clob="true" />
        </entity>
    </entity>
</document> 
```

假设 parent.ID=1 的 child_table 的字段/值结果如下所示：

```
FIELD_COLUMN   VALUE_COLUMN
fieldA         value1
fieldB         value2
fieldB         value3 
```

以及 fieldA 和 fieldB 的架构配置（注意 fieldB 是多值的）：

```
<field name="fieldA" type="string" indexed="true" stored="true" multiValued="false"/>
<field name="fieldB" type="string" indexed="true" stored="true" multiValued="true" /> 
```

运行完全导入后，父 1 的文档如下所示：

```
{"id":1,
"fieldA":"value1",
"fieldB":["value2"]} 
```

但是，我需要（并且期望）它看起来像这样（fieldB 应该有多个值）：

```
{"id":1,
"fieldA":"value1",
"fieldB":["value2","value3"]} 
```

任何帮助将不胜感激！！谢谢！

Solr 版本：4.0.0.2012.08.06.22.50.47

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T17:05:02.747

这是 DataImportHandler 中的一个错误，它已针对（尚未发布）Solr 4.1 进行了修复。 [请参阅您在此打开的 JIRA 问题](https://issues.apache.org/jira/browse/SOLR-3842)。

# mysql - 使用按位计数递增表 ID 字段

> ID：12412043
> 
> 赞同：0
> 
> 时间：2012-09-13T17:55:49.570
> 
> 标签：mysql, triggers, bit-manipulation

我正在做一个项目，我需要我的 ID 列是 2 ( `1,2,4,8,16..`) 的幂。我知道我们不能抵消`auto_increment`但是对于简单的加法/减法`my.cnf`。

例子：

```
id
----
1
2
4
8
16
32
64
128
etc 
```

我的想法之一是使用自动增量功能作为基础，然后创建一个触发器来应用 2 的幂并更新新 ID，但不幸的是，它不起作用：

```
DELIMITER $$
CREATE TRIGGER testbitcompatid BEFORE INSERT ON Table
    FOR EACH ROW 
    BEGIN
        SET NEW.id = pow(NEW.id, 2)
    END;
$$
DELIMITER ; 
```

因为`BEFORE INSERT`尚未生成`AUTO_INCREMENT` `id`，`AUTO_INCREMENT`将始终返回`0`，基本上不会导致列发生任何变化。

我也试过`AFTER INSERT`：

```
DELIMITER $$
CREATE TRIGGER testbitcompatid AFTER INSERT ON Table
    FOR EACH ROW 
    BEGIN
        SET Table.id = pow(NEW.id, 2) WHERE id = NEW.id;
    END;
$$
DELIMITER ; 
```

但这失败了，因为您无法更改在`AFTER INSERT`.

挠头，但我相信其他人有一个很好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-13T17:55:49.570

为了解决上述所有问题，我能够构建以下效果很好！

```
DELIMITER $$
CREATE TRIGGER testbitcompatid BEFORE INSERT ON Table
    FOR EACH ROW 
    BEGIN
        SET @LAST_ROW = (SELECT MAX(id) FROM Table);
        SET NEW.id = CASE WHEN @LAST_ROW IS NULL THEN 1 ELSE @LAST_ROW * 2 END;

    END;
$$
DELIMITER ; 
```

几乎，我们取最高的`id`，抓住`log(2)`它给我们相应的`AUTO_INCREMENT` `id`。然后我们添加`1`，并将其加电至`2`.

我希望这有助于防止其他人在路上感到头疼。

# php - Doctrine 2 One-To-Many 检索多方返回一个空集合

> ID：12412045
> 
> 赞同：1
> 
> 时间：2012-09-13T17:55:51.327
> 
> 标签：php, doctrine, one-to-many

我正在开发一个使用 Zend Framework 1.12 与学说 2 集成的项目。我在所述项目中遇到了双向一对多关系的问题。与我的问题有关的两个实体是团队和玩家；一个球队可以有很多球员。

团队实体：

```
namespace Entities;

use Doctrine\Common\Collections\Collection,
    Doctrine\Common\Collections\ArrayCollection;

/**
 * @Entity(repositoryClass="Repositories\TeamRepository")
 * @Table(name="team")
 */
class Team extends Entity{

/**
 * @Column(type="string", length=255)
 */
protected $name;

/**
 * @OneToMany(targetEntity="Player", mappedBy="team")
 */
protected $players;

public function __construct() {
    $this->players = new ArrayCollection();
}

public function getName(){
    return $this->name;
}

public function setName($name) {
    $this->name = $name;
    return $this;
}

public function getPlayers() {
    return $this->players;
} 
```

和玩家实体：

```
namespace Entities;

/**
* @Entity(repositoryClass="Repositories\PlayerRepository")
* @Table(name="player")
*/
class Player extends Entity{

    public function __construct() {

    }

    /**
     * @Column(type="string", length=255)
     */
    protected $name;

    /**
     * @ManyToOne(targetEntity="Team", inversedBy="players")
     * @JoinColumn(name="team_id", referencedColumnName="id")
     */
    protected $team;

    public function getName(){
        return $this->name;
    }

    public function setName($name) {
        $this->name = $name;
        return $this;
    }

    public function getTeam() {
        return $this->team;
    }

    public function setTeam($team) {
        $this->team = $team;
        return $this;
    }

} 
```

例如，现在在我的玩家控制器中，我可以检索一个玩家并获取球队名称

```
$oPlayer    = $this->_em->find('Entities\Player', $player_id);
$teamname   = $oPlayer->getTeam()->getName(); 
```

这按预期工作，我成功获得了玩家团队的名称。然而，反过来是行不通的。我无法检索给定球队的所有球员

```
$oTeam = $this->_em->find('Entities\Team', $team_id);
$oPlayers = $oTeam->getPlayers(); 
```

当我 var_dump 这个结果看起来像

```
object(Doctrine\ORM\PersistentCollection)#238 (9) {
  ["snapshot":"Doctrine\ORM\PersistentCollection":private]=>
  array(0) {
  }
  ["owner":"Doctrine\ORM\PersistentCollection":private]=>
  object(Entities\Team)#195 (7) {
     ...
  } 
```

请注意，似乎构建了一个 persistenCollection，但是该数组是空的。我已经广泛阅读了教义手册，并用谷歌搜索了我的背后，现在不知所措。

还有没有错误消息的事实，我很难解决这个问题。任何指针都会受到欢迎。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-20T19:14:02.360

这个问题已经解决。我一直试图为后代解决问题，但得出的结论是，我不再拥有现在怀疑原始错误所在的文件。我设法从另一个项目中获得了一份工作副本。通过蛮力 'diff'-ing 和替换代码，我将持久集合的空数组的错误追踪到我的引导程序和 resources/doctrine.php 配置文件，不幸的是我不再拥有这些文件，因此无法确认这一点. 令人尴尬的是，仍然返回 string(4) “team”（如评论中所讨论的），我终于发现这只是由于 die() 我放入了学说库文件并忘记了。

# c++ - c++ 为 sqlite3 设置

> ID：12412047
> 
> 赞同：0
> 
> 时间：2012-09-13T17:56:00.410
> 
> 标签：c++, c, windows, sqlite, compiler-construction

我已经下载了 sqlite3 的源代码，以便开始使用 c++ 中的 sqlite3 接口进行编程。但我不知道如何获取 sqlite 3 的 .lib 文件。

我有这些文件：

sqlite3.c shell.c sqlite3.h sqlite3ext.h

这是我的简单源代码：

```
#include <stdlib.h>
#include <SQL/sqlite3.h>

using namespace std;

int main(int argc, char *argv[]){   
    sqlite3 * db;

    int rc = sqlite3_open("file.txt", &db);

} 
```

但我得到“对 sqlite3_open 的未定义引用”

这是在我的makefile中：

```
MY_LIBS = -lsqlite3
main:
    g++ -g main.cpp -o sqliteex 
```

无法编译，因为没有名为 sqlite3.lib 的库

我从哪里得到这个文件或者我如何构建它以便我可以开始使用 sqlite3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:59:58.333

将您的构建命令更改为

```
gcc -g -c sqlite3.c -o sqlite3.o
g++ -g -c main.cpp -o main.o
g++ -o sqliteex sqlite3.o main.o 
```

（我假设 sqlite3.c 是“合并”。）

这是他们在项目中包含 sqlite 的推荐方式；您直接编译它而不是链接到它。

您可能（我不确定，您必须对此进行测试）需要将 sqlite 包含在

```
extern "C" {} 
```

堵塞。

# c# - 发送需要安全连接的电子邮件

> ID：12412054
> 
> 赞同：0
> 
> 时间：2012-09-13T17:56:17.910
> 
> 标签：c#, smtpclient, system.net.mail

## 重新提出问题

此代码不起作用

**错误是：** `The remote certificate is invalid according to the validation procedure.`

```
var client = new SmtpClient("smtp.domain.com.br", 25000)
{
    Credentials = new NetworkCredential("username", "password"),
    EnableSsl = true
};
client.Send("emailfrom@domain.com.br", "emailto@gmail.com", "test", "testbody");
// I also tested like this
// client.Send("emailfrom@domain.com.br", "emailto@domain.com", "test", "testbody"); 
```

但是这段代码有效

```
var client = new SmtpClient("smtp.gmail.com", 587)
{
    Credentials = new NetworkCredential("username", "password"),
    EnableSsl = true
};
client.Send("emailfrom@domain.com.br", "emailto@gmail.com", "test", "testbody"); 
```

我在 Outlook 中测试了第一个代码数据，如果我尝试从同一域发送电子邮件，则可以正常工作。

我相信错误是一些 SMTP 配置，但我不知道如何解决这个问题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:07:15.137

您使用哪个 smtp 服务器？如果您使用的是 gmail smtp 服务器，那么您必须使用通过 gmail 发送所需的端口号 587

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T17:31:38.780

我使用 Outlook 中生成的数字证书解决了这个问题，并将其放在运行我的应用程序的服务器上。

***有了我问题中的代码加上证书，我终于成功了。***

这是有关如何执行此操作的链接：[创建您自己的数字证书](http://office.microsoft.com/en-us/outlook-help/create-your-own-digital-certificate-HP005249558.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:21:34.970

根据下面的答案，您可以从 .config 文件中传递值，但您必须更改我所拥有的 ..如果您愿意，请先使用硬编码值对此进行测试，然后将工作版本转换为使用参数值

```
using System.Net;
using System.Net.Mail;

var fromAddress = new MailAddress("from@gmail.com", "From Name");
var toAddress = new MailAddress("to@example.com", "To Name");
const string fromPassword = "fromPassword";
const string subject = "Subject";
const string body = "Body";

var _smtpClient = new SmtpClient
           {
               Host = "smtp.gmail.com",
               Port = 587,
               EnableSsl = true,
               DeliveryMethod = SmtpDeliveryMethod.Network,
               UseDefaultCredentials = false,
               Credentials = 
                  new NetworkCredential(fromAddress.Address, fromPassword)
           };
using (var message = new MailMessage(fromAddress, toAddress)
                     {
                         Subject = subject,
                         Body = body
                     })
{
    _smtpClient.Send(message);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:29:22.390

您是否尝试过端口 465。也许您可以查看这篇文章。

[http://support.google.com/mail/bin/answer.py?hl=en&answer=13287](http://support.google.com/mail/bin/answer.py?hl=en&answer=13287)

# android - 如何将数据写入文件

> ID：12412061
> 
> 赞同：0
> 
> 时间：2012-09-13T17:56:48.487
> 
> 标签：android, file

在以下几行中，我在“Environment.getExternalStorageDirectory()”中创建了一个文件

```
File dir = Environment.getExternalStorageDirectory();
File file = new File(dir,"/DCIM/"+fileTitle); 
```

我的问题是：如何将文本数据写入这个创建的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:03:08.090

要将文本输出到文件，您可以使用[PrintWriter](http://developer.android.com/reference/java/io/PrintWriter.html)类，该类具有不同的有用方法来写入数据。您还可以查看流[概述](http://docs.oracle.com/javase/tutorial/essential/io/streams.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:05:37.040

从本[教程](http://www.anddev.org/working_with_files-t115.html)：

```
//Writing a file...  

try { 
       // catches IOException below
       final String TESTSTRING = new String("Hello Android");

       /* We have to use the openFileOutput()-method
       * the ActivityContext provides, to
       * protect your file from others and
       * This is done for security-reasons.
       * We chose MODE_WORLD_READABLE, because
       *  we have nothing to hide in our file */             
       FileOutputStream fOut = openFileOutput("samplefile.txt",
                                                            MODE_WORLD_READABLE);
       OutputStreamWriter osw = new OutputStreamWriter(fOut); 

       // Write the string to the file
       osw.write(TESTSTRING);

       /* ensure that everything is
        * really written out and close */
       osw.flush();
       osw.close();

//Reading the file back...

       /* We have to use the openFileInput()-method
        * the ActivityContext provides.
        * Again for security reasons with
        * openFileInput(...) */

        FileInputStream fIn = openFileInput("samplefile.txt");
        InputStreamReader isr = new InputStreamReader(fIn);

        /* Prepare a char-Array that will
         * hold the chars we read back in. */
        char[] inputBuffer = new char[TESTSTRING.length()];

        // Fill the Buffer with data from the file
        isr.read(inputBuffer);

        // Transform the chars to a String
        String readString = new String(inputBuffer);

        // Check if we read back the same chars that we had written out
        boolean isTheSame = TESTSTRING.equals(readString);

        Log.i("File Reading stuff", "success = " + isTheSame);

    } catch (IOException ioe) 
      {ioe.printStackTrace();} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:25:58.023

这是一个将数据写入文件的快速片段。请注意，它设计为在单独的线程中运行，因此您无需在主 UI 线程中执行文件 IO。

```
new Thread(new Runnable() {
  public void run() {
    String FILENAME = "hello_file";
    String string = "hello world!";

    FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE);
    fos.write(string.getBytes());
    fos.close();
  }
}).start(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:01:30.567

[您可以使用FileWriter](http://developer.android.com/reference/java/io/FileWriter.html)写入文件

# c++ - 二维数组帮助 C++

> ID：12412062
> 
> 赞同：0
> 
> 时间：2012-09-13T17:56:52.540
> 
> 标签：c++

好的，这是独家新闻：我正在为我的 c++ 类构建一个扫雷风格的程序，我正在使用 2D 数组来创建板，并使用第二个 2d 数组来存储猜测。对于 board 数组中的每个值，我运行一个随机数 gen 并为其分配一个介于 0 和 99 之间的值。如果数组中的每个值大于 85，则将其视为炸弹。程序接受用户输入并确定它是否是炸弹。如果不是对应的bool数组（isGuessed）位置则改为true。然后将此 bool 数组发送到 reDraw 函数以进行重绘。所有虚假布尔值都显示为“？” 并且所有 true 都显示为“X”。但是，当我重新绘制时，它会将数组中的多个位置更改为 X，只需要一次猜测。我的想法是，板的绘制与阵列位置无关。有人可以帮忙吗。为了清楚起见，我试图理解为什么函数 reDraw 不能正常工作。这是我的所有代码。

```
#include <iostream>
#include <ctime>
#include <cstdlib>

using namespace std;

//Function Prototypes 

void reDraw (bool guessed [] [10], int rows, int columns);
void newBoard (int rows, int columns);

int main(int argc, const char * argv[])
{
 //Declare Variables
  const int ROWS = 10;
  const int COLUMNS = 10;
int board [ROWS][COLUMNS];
bool wasGuessed [10] [10];
bool playAgain = true;
char newGame; 
int rowGuess, columnGuess, numOfBombs = 0, score = 0; 
bool bomb = false;
srand((unsigned) time(0));

// Welcome User, Give Direction

cout<<"\n\n\t\tWelcome To Matt's Minesweeper\n\n";

while (playAgain) {

 //function to randomly populate array elements
    for (int row = 0; row < ROWS; row++) {
        for (int column = 0; column < COLUMNS; column++) {
            board [row] [column] = rand() % 100; 
            if (board [row] [column] >= 85) {  //counter for bombs
                numOfBombs++;
        }
    }
}

// Create a new Display Board
newBoard(10, 10);

//Begin Game
cout<<"\nTotal Bombs In This Game: "<<numOfBombs;

// Process Guesses
do {
    cout<<"\nPlease Input your ROW & COLUMN Guess coordinate (i.e. 3 2): ";
    cin>>rowGuess>>columnGuess;

    if (board [rowGuess] [columnGuess] >= 85) {
        bomb = true;
        cout<<"\n\n\t\tXXXXXX BOMB HIT XXXXXXX\n\t\t\tGame Over.\n\n";
        cout<<"Your Score Score: "<<score;
        cout<<"\n\n Play Again (y/n):";
        cin>>newGame;
        switch (newGame) {
            case 'y':
                cout<<"\n\n";
                playAgain = true;
                break;
            default:
                playAgain = false;
                break;

        }
    } else {
        wasGuessed [rowGuess] [columnGuess] = true;
        score++; 
        reDraw(wasGuessed, 10, 10);
    }
} while (!bomb);

}

return 0;
}

   void reDraw (bool guessed [] [10], int rows, int columns)
{
    // Format row and column headers
    cout<<"  0   1   2   3   4   5   6   7   8  9\n";
    cout<<"0";
for (int i = 0; i < rows; i++) {
    for (int j = 0; j < columns; j++) {

        if ((j+1) % 10 == 0) 
            if ((i+1) == 10) {
                if (guessed [i] [j]) 
                    cout<<"X "<<" \n";
                else 
                    cout<<"? "<<" \n";
            }else{
                if (guessed [i] [j]) 
                    cout<<"X "<<" \n"<<i+1;
                else                
                    cout<<"? "<<" \n"<<i+1;
            }
        if ((j+1) % 10 != 0)
            if (guessed [j] [i]) 
                cout<<" X"<<"  ";
            else
                cout<<" ?"<<"  "; 

    }
}

}
void newBoard (int rows, int columns)
{

cout<<"  0   1   2   3   4   5   6   7   8  9\n";
cout<<"0";
for (int i = 0; i < rows; i++) {
    for (int j = 0; j < columns; j++) {

        if ((j+1) % 10 == 0) 
            if ((i+1) == 10) {
                cout<<"? "<<" \n";
            }else
                cout<<"? "<<" \n"<<i+1;
        if ((j+1) % 10 != 0)
            cout<<" ?"<<"  ";
    }

}

} 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:40:01.277

好的，它已修复。查看新代码：

更改 - 之后添加`reset()`并移至`wasGuessed [rowGuess] [columnGuess] = true;` 顶部`cin<<`。

它的作用就像一个魅力，将 ' 画`X`在`?`' 曾经站在猜测之前的位置。

```
#include <iostream>
#include <ctime>
#include <cstdlib>

using namespace std;

//Declare Variables
const int ROWS = 10;
const int COLUMNS = 10;
int board [ROWS][COLUMNS];
bool wasGuessed [ROWS] [COLUMNS];
bool playAgain = true;
char newGame; 
int rowGuess, columnGuess, numOfBombs = 0, score = 0; 
bool bomb = false;

//Function Prototypes 

void reDraw (bool guessed [] [10], int rows, int columns);
void newBoard (int rows, int columns);
void reset();

int main(int argc, const char * argv[])
{

srand((unsigned) time(0));

reset();

// Welcome User, Give Direction

cout<<"\n\n\t\tWelcome To Matt's Minesweeper\n\n";

while (playAgain) {

 //function to randomly populate array elements
    for (int row = 0; row < ROWS; row++) {
        for (int column = 0; column < COLUMNS; column++) {
            board [row] [column] = (rand() % 100) + 0; 
            if (board [row] [column] >= 85) {  //counter for bombs
                numOfBombs++;
        }
    }
}

// Create a new Display Board
newBoard(10, 10);

//Begin Game
cout<<"\nTotal Bombs In This Game: "<<numOfBombs;

// Process Guesses
do {
    cout<<"\nPlease Input your ROW & COLUMN Guess coordinate (i.e. 3 2): ";
    cin>>rowGuess>>columnGuess;
    wasGuessed [rowGuess] [columnGuess] = true;
    if (board [rowGuess] [columnGuess] >= 85) {
        bomb = true;
        cout<<"\n\n\t\tXXXXXX BOMB HIT XXXXXXX\n\t\t\tGame Over.\n\n";
        cout<<"Your Score Score: "<<score;
        cout<<"\n\n Play Again (y/n):";
        cin>>newGame;
        switch (newGame) {
            case 'y':
                cout<<"\n\n";
                playAgain = true;
                reset();
                break;
            default:
                playAgain = false;
                break;

        }
    } else {
        wasGuessed [rowGuess] [columnGuess] = true;
        score++; 
        reDraw(wasGuessed, 10, 10);
    }
} while (!bomb);

}

return 0;
}

   void reDraw (bool guessed [] [10], int rows, int columns)
{
    // Format row and column headers
    cout<<"  0   1   2   3   4   5   6   7   8  9\n";
    cout<<"0";
for (int i = 0; i < rows; i++) {
    for (int j = 0; j < columns; j++) {

        if ((j+1) % 10 == 0) 
            if ((i+1) == 10) {
                if (guessed [i] [j]) 
                    cout<<"X "<<" \n";
                else 
                    cout<<"? "<<" \n";
            }else{
                if (guessed [i] [j]) 
                    cout<<"X "<<" \n"<<i+1;
                else                
                    cout<<"? "<<" \n"<<i+1;
            }
        if ((j+1) % 10 != 0)
            if (guessed [j] [i]) 
                cout<<" X"<<"  ";
            else
                cout<<" ?"<<"  "; 

    }
}

}
void newBoard (int rows, int columns)
{

cout<<"  0   1   2   3   4   5   6   7   8  9\n";
cout<<"0";
for (int i = 0; i < rows; i++) {
    for (int j = 0; j < columns; j++) {

        if ((j+1) % 10 == 0) 
            if ((i+1) == 10) {
                cout<<"? "<<" \n";
            }else
                cout<<"? "<<" \n"<<i+1;
        if ((j+1) % 10 != 0)
            cout<<" ?"<<"  ";
    }

}

}

void reset()
{
    for (int row = 0; row < ROWS; row++) 
    {
            for (int column = 0; column < COLUMNS; column++) 
            {
                wasGuessed [row] [column] = false;

            }
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T22:49:05.583

我很无聊，所以我把你的程序做得更好。这一切都在一个文件中，但将其拆分为多个文件会很容易。只需将每个类的成员和类定义分开，并将它们放在自己的文件中，然后将 main 放在自己的文件中。

我做了一些可能会让你觉得很奇怪的事情。如果您看到某些内容，请在评论中询问，我会自己解释

```
// include all of the things
#include <cstdlib>
#include <ctime>
#include <iostream>
#include <iomanip>
#include <string>

// use all of the things
using std::rand;
using std::srand;
using std::time;
using std::cout;
using std::cin;
using std::endl;
using std::right;
using std::left;
using std::setw;
using std::string;

// MineSweepBoard.h

class MineSweepBoard
{
public:
    MineSweepBoard(int rows, int cols, float per);
    MineSweepBoard(int rows, int cols);
    MineSweepBoard();
    virtual ~MineSweepBoard();

    static const int ROW_DEFAULT, COL_DEFAULT;
    static const float CHANCE_DEFAULT;
    static const unsigned char MINE_MASK, UNCOVERED_MASK;
    static void Randomize();

    void RandomizeBoard();
    bool IsMine(int r, int c);
    bool IsUncovered(int r, int c);
    int UncoverSpace(int r, int c);
    int GetAdjMineCount(int r, int c);
    bool IsOnBoard(int r, int c);
    char GetBoardSquare(int r, int c);

    int GetRows();
    int GetCols();
    float GetPercentage();
    int GetMineCount();
    int GetSafeCount();

private:
    int rowcount, colcount;
    int minecount, safecount;

    float percentage;
    char * board;
    bool safedummy;

    void Init(int rows, int cols, float per);
};

// MineSweeper.h

class MineSweeper : public MineSweepBoard
{
public:
    MineSweeper();
    MineSweeper(int rows, int cols, float difficulty);
    MineSweeper(int rows, int cols, float difficulty, char mchar, char bchar, char uchar);

    static const char MINE_DEFAULT, BLANK_DEFAULT, UNKNOWN_DEFAULT;

    void PrintBoard();
    char GetCharForSpace(int r, int c);
    void Play();
    bool WonGame();
private:
    char minechar, blankchar, unknownchar;
    int cleared;

    void Init(char mchar, char bchar, char uchar);
};

// MineSweepBoard.cpp

const int MineSweepBoard::ROW_DEFAULT = 10, MineSweepBoard::COL_DEFAULT = 10;
const float MineSweepBoard::CHANCE_DEFAULT = 0.85;
const unsigned char MineSweepBoard::MINE_MASK = 0x1, MineSweepBoard::UNCOVERED_MASK = 0x2;

void MineSweepBoard::Randomize()
{
    srand(time(NULL));
}

int MineSweepBoard::GetRows()
{
    return rowcount;
}

int MineSweepBoard::GetCols()
{
    return colcount;
}

float MineSweepBoard::GetPercentage()
{
    return percentage;
}

int MineSweepBoard::GetMineCount()
{
    return minecount;
}

int MineSweepBoard::GetSafeCount()
{
    return safecount;
}

MineSweepBoard::MineSweepBoard()
{
    Init(ROW_DEFAULT, COL_DEFAULT, CHANCE_DEFAULT);
}

MineSweepBoard::MineSweepBoard(int rows, int cols)
{
    Init(rows, cols, CHANCE_DEFAULT);
}

MineSweepBoard::MineSweepBoard(int rows, int cols, float per)
{
    Init(rows, cols, per);
}

MineSweepBoard::~MineSweepBoard()
{
    delete[] board;
}

void MineSweepBoard::Init(int rows, int cols, float per)
{
    minecount = 0;
    safecount = rows * cols;
    percentage = per;
    rowcount = rows;
    colcount = cols;
    board = new char [rows * cols];
    RandomizeBoard();
}

char MineSweepBoard::GetBoardSquare(int r, int c)
{
    return board[r * colcount + c];
}

void MineSweepBoard::RandomizeBoard()
{
    for (int i = 0, j = rowcount * colcount; i != j; ++i)
    {
        float r = (((float) rand()) / ((float) RAND_MAX));
        board[i] = (percentage < r);
        if (board[i]) ++minecount;
    }
    safecount -= minecount;
}

bool MineSweepBoard::IsOnBoard(int r, int c)
{
    return (
               (r >= 0 && r < rowcount) &&
               (c >= 0 && c < colcount)
           );
}

bool MineSweepBoard::IsMine(int r, int c)
{
    return (
               (IsOnBoard(r, c)) &&
               (GetBoardSquare(r, c) & MINE_MASK)
           );
}

bool MineSweepBoard::IsUncovered(int r, int c)
{
    return (
               (IsOnBoard(r, c)) &&
               (GetBoardSquare(r, c) & UNCOVERED_MASK)
           );
}

int MineSweepBoard::UncoverSpace(int r, int c)
{
    int uncovered = 0;
    while (IsOnBoard(r, c) && !IsUncovered(r, c))
    {
        board[r * colcount + c] |= UNCOVERED_MASK;
        if (!(GetBoardSquare(r, c) & MINE_MASK)) ++uncovered;
        else break;

        if (GetAdjMineCount(r, c) == 0)
        {
            uncovered += UncoverSpace(r + 0, c + 1);
            uncovered += UncoverSpace(r + 0, c - 1);
            uncovered += UncoverSpace(r + 1, c + 0);
            uncovered += UncoverSpace(r - 1, c + 0);
        }

        break;
    }
    return uncovered;
}

int MineSweepBoard::GetAdjMineCount(int r, int c)
{
    return IsMine(r + 0, c + 1) + IsMine(r + 0, c - 1) + 
           IsMine(r + 1, c + 0) + IsMine(r - 1, c + 0) +
           IsMine(r + 1, c + 1) + IsMine(r - 1, c - 1) +
           IsMine(r + 1, c - 1) + IsMine(r - 1, c + 1);
}

// MineSweeper.cpp

const char MineSweeper::MINE_DEFAULT = 'X', MineSweeper::BLANK_DEFAULT = ' ', MineSweeper::UNKNOWN_DEFAULT = '?';

MineSweeper::MineSweeper() : MineSweepBoard()
{
    Init(MINE_DEFAULT, BLANK_DEFAULT, UNKNOWN_DEFAULT);
}

MineSweeper::MineSweeper(int rows, int cols, float difficulty) : MineSweepBoard(rows, cols, difficulty)
{
    Init(MINE_DEFAULT, BLANK_DEFAULT, UNKNOWN_DEFAULT);
}

MineSweeper::MineSweeper(int rows, int cols, float difficulty, char mchar, char bchar, char uchar) : MineSweepBoard(rows, cols, difficulty)
{
    Init(mchar, bchar, uchar);
}

void MineSweeper::Init(char mchar, char bchar, char uchar)
{
    minechar = mchar;
    blankchar = bchar;
    unknownchar = uchar;
}

void MineSweeper::PrintBoard()
{
    for (int i = 0; i < GetCols(); ++i) cout << setw(4) << right << i;
    cout << left << endl << endl;
    for (int r = 0; r < GetCols(); ++r)
    {
        cout << setw(3) << r;
        for (int c = 0; c < GetRows(); ++c)
        {
            cout << setw(4) << GetCharForSpace(r, c);
        }
        cout << endl;
    }
}

char MineSweeper::GetCharForSpace(int r, int c)
{
    if (IsUncovered(r, c))
    {
        if (IsMine(r, c))
            return minechar;
        int count = GetAdjMineCount(r, c);
        if (count == 0)
            return blankchar;
        else
            return '0' + count;
    }
    else
        return unknownchar;
}

void MineSweeper::Play()
{
    int score = 0;
    PrintBoard();
    cout << "Total Bombs In This Game: " << GetMineCount() << endl;

    while (true)
    {
        string dummy;
        int inputrow = -1, inputcol = -1;
        cout << "Please Input Your ROW & COLUMN Guess Coordinate (i.e. 3 2): ";
        cin >> inputrow >> inputcol;
        if (!cin || IsUncovered(inputrow, inputcol) || !IsOnBoard(inputrow, inputcol))
        {
            cout << "Invalid Selection! ";
            if (!cin)
            {
                cin.clear();
                cin >> dummy;
            }
            continue;
        }

        int uncovered = UncoverSpace(inputrow, inputcol);
        PrintBoard();
        if (IsMine(inputrow, inputcol))
        {
            cout << endl << endl << "\t\tXXXXXX BOMB HIT XXXXXX" << endl << "\t\t\tGame Over." << endl << endl;
            break;
        }
        else
        {
            score += uncovered;
            cleared += uncovered;
            if (WonGame())
            {
                cout << endl << endl << "\t\t------ ALL BOMBS CLEARED ------" << endl << "\t\t\tYou Win!" << endl << endl;
                break;
            }

        }
    }
    cout << "your Score: " << score << endl;
}

bool MineSweeper::WonGame()
{
    return (cleared == GetSafeCount());
}

// main.cpp

int main(int argc, char * argv[])
{
    MineSweepBoard::Randomize();

    cout << endl << endl << "\t\tWelcome To Wug's Minesweeper" << endl << endl;

    while(true)
    {
        char again = 'n';
        MineSweeper m;
        m.Play();
        cout << endl << "Play Again? (y/n) ";
        cin >> again;
        if (again == 'y')
        {
            cout << endl << endl;
            continue;
        }
        else break;
    }
    return 0;
} 
```

此代码具有原始版本所没有的以下特征：

*   你可以赢得比赛
*   和windows扫雷一样，在空旷的空间中间挑一块可以清理整个空间
*   输入验证
*   内存管理（你的只是在堆栈上使用了内存，它不需要 new 和 delete 任何东西
*   遗产
*   缩进一致（看缩进不一致的代码不好玩）

# ios - MonoTouch：为 iPhone 5 Retina 4 添加 Default-568h@2x.png

> ID：12412063
> 
> 赞同：8
> 
> 时间：2012-09-13T17:56:57.597
> 
> 标签：ios, xamarin.ios, iphone-5

在我们的`MonoTouch`项目中，是否添加了`Default-568h@2x.png`图像，`640 x 1136`以支持 iPhone 5 上的应用程序？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T21:59:29.230

这是操作系统调整窗口大小以填充 iPhone 5 显示屏所需的关键更改。Redth# 已经发布了[一篇](http://redth.info/get-your-monotouch-apps-ready-for-iphone-5-today/ "写上去")关于您可能需要进行的此调整和其他与尺寸相关的调整的文章。

# c - elf .rel.text 部分中 R_386_32/R_386_PC32 的含义

> ID：12412064
> 
> 赞同：10
> 
> 时间：2012-09-13T17:57:00.903
> 
> 标签：c, linux, assembly, x86

为了理解重定位的概念，我写了一个简单的 chk.c 程序如下：

```
 1 #include<stdio.h>
  2 main(){
  3         int x,y,sum;
  4         x = 3;
  5         y = 4;
  6         sum = x + y;
  7         printf("sum = %d\n",sum);
  8 } 
```

其等效的汇编代码，使用“objdump -d chk.o”是：

```
00000000 <main>:
   0:   55                      push   %ebp
   1:   89 e5                   mov    %esp,%ebp
   3:   83 e4 f0                and    $0xfffffff0,%esp
   6:   83 ec 20                sub    $0x20,%esp
   9:   c7 44 24 1c 03 00 00    movl   $0x3,0x1c(%esp)
  10:   00 
  11:   c7 44 24 18 04 00 00    movl   $0x4,0x18(%esp)
  18:   00 
  19:   8b 44 24 18             mov    0x18(%esp),%eax
  1d:   8b 54 24 1c             mov    0x1c(%esp),%edx
  21:   8d 04 02                lea    (%edx,%eax,1),%eax
  24:   89 44 24 14             mov    %eax,0x14(%esp)
  28:   b8 00 00 00 00          mov    $0x0,%eax
  2d:   8b 54 24 14             mov    0x14(%esp),%edx
  31:   89 54 24 04             mov    %edx,0x4(%esp)
  35:   89 04 24                mov    %eax,(%esp)
  38:   e8 fc ff ff ff          call   39 <main+0x39>
  3d:   c9                      leave  
  3e:   c3                      ret 
```

使用 readelf 看到的 .rel.text 部分如下：

```
Relocation section '.rel.text' at offset 0x360 contains 2 entries:
 Offset     Info    Type            Sym.Value  Sym. Name
00000029  00000501 R_386_32          00000000   .rodata
00000039  00000902 R_386_PC32        00000000   printf 
```

基于此，我有以下问题：

1）从 .rel.text 部分的第二个条目，我能够理解 .text 部分中偏移量 0x39 处的值（此处为 0xfcffffff）必须替换为与符号表的索引 9 关联的符号的地址（&结果是printf）。但是我在这里无法清楚地理解 0x02 (ELF32_R_TYPE) 的含义。R_386_PC32 在这里指定了什么？任何人都可以清楚地解释它的含义。

2）我也无法理解第一个条目。在 .text 部分的 0x29 偏移处需要替换什么以及为什么这里不清楚。我再次想知道 R_386_32 的含义。我找到了一个 pdf elf_format.pdf，但我无法从中清楚地理解 .rel.text 部分中“类型”的含义。

3）我也想知道汇编inst“lea（％edx，％eax，1），％eax”的含义。虽然我找到了一个很好的链接（[LEA 指令的目的是什么？](https://stackoverflow.com/questions/1658294/whats-the-purpose-of-the-lea-instruction)）描述 lea 的含义，但 lea 的格式（括号内的 3 个 arg 是什么）尚不清楚。

如果有人能清楚地解释上述问题的答案，将不胜感激。我仍然在努力寻找这些问题的答案，尽管我在谷歌上做了很多尝试。

还有一个问题。我在下面显示了偏移量 5 和 9 的符号表条目。

```
 Num: Value Size Type Bind Vis Ndx Name 
 5: 00000000 0 SECTION LOCAL DEFAULT 5 
 9: 00000000 0 NOTYPE GLOBAL DEFAULT UND printf' 
```

.rel.text 表中第一个条目的信息字段是 0x05，表示符号表的索引。我已经显示了上面索引 5 的符号表条目，但无法理解它是如何告诉我们它是用于 .rodata 的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T18:55:21.317

1)、2)：`R_386_32`是重定位，*将符号的绝对 32 位地址*放入指定的内存位置。`R_386_PC32`是一种重定位，它将*符号的 PC 相对 32 位地址*放入指定的内存位置。`R_386_32`对静态数据很有用，如此处所示，因为编译器只是将重定位的符号地址加载到某个寄存器中，然后将其视为指针。`R_386_PC32`对于函数引用很有用，因为它可以用作`call`. 有关如何处理重定位的示例，请参见[elf_machdep.c 。](http://freebsd.active-venture.com/FreeBSD-srctree/newsrc/i386/i386/elf_machdep.c.html)

3)`lea (%edx,%eax,1),%eax`仅`%eax = %edx + 1*%eax`表示如果用 C 语法表示。在这里，它基本上被用作`add`操作码的替代品。

编辑：这是一个例子。

假设您的代码从 0x401000 开始加载到内存中，字符串`"sum = %d\n"`在 0x401800（在该`.rodata`部分的开头）结束，即`printf`在 libc 中的 0x1400ab80。

然后，`R_386_32`在 0x29 处的重定位会将字节`00 18 40 00`放在 0x401029 处（只是复制符号的绝对地址），使指令位于 0x401028

```
 401028:   b8 00 18 40 00          mov    $0x401800,%eax 
```

`R_386_PC32`0x39 处的重定位将字节放置`43 9b c0 13`在 0x401039 处（值 0x1400ab80 - 0x40103d = 0x13c09b43 十六进制），使该指令

```
 401038:   e8 43 9b c0 13          call   $0x1400ab80 <printf> 
```

我们减去 0x40103d 来计算 %pc 的值（即 之后指令的地址`call`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T18:43:12.827

`"sum = ..."`第一个重定位条目是在设置调用的过程中获取指向格式字符串 () 的指针`printf`。由于`.rodata`节和节一样被重新定位`.text`，对字符串和其他常量数据的引用将需要修复。

考虑到这一点，看起来 R_386_32 重定位处理数据，而 R_386_PC32 处理代码地址，但 ELF 规范（我没有方便的副本）可能解释了各种细节。

该`lea`指令是编译器选择为此例程执行添加的指令。它本可以选择`add`或其他几种可能性，但这种形式`lea`似乎在某些情况下经常使用，因为它可以将加法与乘法结合起来。指令的结果`lea (%edx,%eax,1),%eax`是`%eax`将获得 的值`%edx + 1 * %eax`。1 可以替换为一组受限的小整数。该`lea`指令的最初目的是“加载有效地址”——获取基指针、索引和大小并产生数组中元素的地址。但是，正如您所看到的，编译器也可以选择将它用于其他事情......

# php - 会话在php中很快到期

> ID：12412065
> 
> 赞同：1
> 
> 时间：2012-09-13T17:57:02.580
> 
> 标签：php, session, session-cookies

我想延长会话时间，以便会话变量在 12 小时后不会过期。

问题是，在 24 分钟（会话到期前的默认时间）不活动后，会话仍然到期，因此为这些`SESSION`变量提供了未定义的索引。

我还需要在我的代码中做些什么才能延长会话，使其在 12 小时后才会自行过期：

下面的代码不起作用`ini_set()`是上面`session_start();`

```
<?php
    ini_set('session.gc_maxlifetime',12*60*60);
    ini_set('session.cookie_lifetime',12*60*60);
    phpinfo();              
    session_start();

    // .... rest of code below

?> 
```

下面的代码不起作用是 ini_set() 低于 session_start();

```
<?php
    phpinfo();              
    session_start();

    ini_set('session.gc_maxlifetime',12*60*60);
    ini_set('session.cookie_lifetime',12*60*60);

    // .... rest of code below

?> 
```

在`phpinfo()`中，它在下面说明了这一点`gc_maxlifetime`：

```
 Local Value  Master Value
session.gc_maxlifetime       43200        1440
session.cookie_lifetime      43200          0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:58:17.737

您目前只设置垃圾收集的时间。您还应该使用[session.cookie_lifetime](http://www.php.net/manual/en/session.configuration.php#ini.session.cookie-lifetime)设置或`session_set_cookie_params()`函数在浏览器中设置 cookie 过期。

# android - protectionLevel“签名”是否与 Android 调试密钥一起正常工作？

> ID：12412066
> 
> 赞同：2
> 
> 时间：2012-09-13T17:57:03.780
> 
> 标签：android, permissions, android-contentprovider

我有一个内容提供者和一个测试应用程序都使用调试密钥签名。如果未应用权限，客户端通常会收到内容，但我想对内容应用权限。因此将以下行添加到内容提供者的清单文件中：

```
 <permission android:name="org.example.provider.READ"
    android:permissionGroup="org.example.group.DATA_ACCESS"
    android:label="@string/readonlyaccess"
    android:protectionLevel="signature" />

  <application
    ...
    <provider android:name=".ImageContentProvider"
        android:authorities="org.example.provider"
        android:readPermission="org.example.provider.READ" /> 
```

在客户端的清单文件中添加了以下行：

```
<uses-permission android:name="org.example.provider.READ" /> 
```

当我尝试从提供程序获取数据时，出现错误：

```
09-13 22:38:20.995: E/AndroidRuntime(13979): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.hello/com.example.hello.HelloActivity}: java.lang.SecurityException: Permission Denial: reading org.example.ImageContentProvider uri content://org.example.provider/file from pid=13979, uid=10040 requires org.example.provider.READ 
```

我错过了什么，还是与应用程序由调试密钥签名的事实有关？如何解决问题？我也看到了添加`uses-permission`到提供程序的建议，但这也无济于事。注意。如果这可能很重要，则会在模拟器中进行检查。

我发现一个相关的问题[throws SecurityException when signing with default debug keystore](https://stackoverflow.com/questions/2420044/throws-securityexception-when-signing-with-the-default-debug-keystore)，但它没有提供实际的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:23:40.903

是的，它适用于调试密钥库，至少在我最后一次尝试时是这样。

我会`<permission>`在两个应用程序中都有这个元素。如果你先安装`<uses-permission>`一个，然后再安装`<permission>`一个，你会遇到问题。需要在`<uses-permission>`遇到之前定义权限，最简单的方法是将`<permission>`两者都放入。

# c - 零长度数组

> ID：12412067
> 
> 赞同：2
> 
> 时间：2012-09-13T17:57:08.283
> 
> 标签：c, arrays

在 C 中使用零长度数组有什么好处？

例如：

```
struct email {
    time_t send_date;
    int flags;
    int length;
    char body[];
}list[0]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:04:44.623

大小数组`0`在 C 中无效。

```
char bla[0];  // invalid C code 
```

从标准：

> (C99, 6.7.5.2p1) “如果表达式是常量表达式，它的值应大于零。”

因此`list`声明在您的程序中无效。

具有不完整类型作为结构的最后一个成员的数组是*灵活数组成员*。

```
struct email {
    time_t send_date;
    int flags;
    int length;
    char body[];
}; 
```

这`body`是一个灵活的数组成员。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T17:58:25.450

这是你的答案：[http ://www.quora.com/C-programming-language/What-is-the-advantage-of-using-zero-length-arrays-in-C](http://www.quora.com/C-programming-language/What-is-the-advantage-of-using-zero-length-arrays-in-C)

# sql - SQL UPDATE：一个语句中的多个列或多个单列语句？

> ID：12412075
> 
> 赞同：2
> 
> 时间：2012-09-13T17:57:45.643
> 
> 标签：sql, sql-server, performance, sqlperformance

`UPDATE`多列执行一条语句效率更高吗

```
UPDATE myTable 
SET [col1] = [col1] + 1, 
[col2] = [col2] + 1,
[col3] = [col3] + 1,
... 
[colN] = [colN] + 1 
```

还是多个`UPDATE`语句，每个语句只有一列？

```
UPDATE myTable SET [col1] = [col1] + 1
UPDATE myTable SET [col2] = [col2] + 1
UPDATE myTable SET [col3] = [col3] + 1
...
UPDATE myTable SET [colN] = [colN] + 1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:01:46.967

这可能会因任何一个数据库引擎的特定实现而有所不同，但我将投票认为单个更新通常比连续更新的性能更好。数据库只需要一次找到所需的记录，更新相关的值，并完成它。

现在，考虑到有计划缓存、索引、优化器和其他让事情变得更智能的元素，多更新版本很可能会接近前者的性能，但我的期望是，即使在最好的情况下，前者的表现也会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:13:05.583

毫无疑问，单一语句更有效。每个更新语句都需要将记录取到内存中，对记录执行更新，然后写出结果。

通过多次更新，您必须多次读入记录并多次写出。使用一个语句，您执行此操作一次。

此外，数据库将更改记录到日志文件中，以保持数据的完整性。无论更改的字段数量如何，都会记录每次更新。

当涉及索引、大于内存的表、约束和触发器时，情况会变得更糟。

第二个版本大约需要第一个版本的 N 倍，其中 N 是被修改的列数。

# objective-c - UILabel 不显示

> ID：12412076
> 
> 赞同：0
> 
> 时间：2012-09-13T17:57:51.920
> 
> 标签：objective-c, cocoa-touch

我试图以编程方式添加一个 UILabel （我用 IB 完成了它并且它有效）。但我不知道为什么它不显示。我以编程方式添加了一个按钮，效果很好。我希望按钮用随机报价更新标签。怎么了？

.h 文件：

```
@interface SecondViewController : UIViewController
{
    NSArray *citatDatabas;

}

@property (weak, nonatomic) IBOutlet UIButton *helloButton;
@property (weak, nonatomic) IBOutlet UIButton *citatKnapp;
@property (weak, nonatomic) IBOutlet UILabel *label1;

- (void)helloButtonPressed;
- (IBAction)citatKnappPressed:(id)sender;

@end 
```

执行：

```
@implementation SecondViewController
@synthesize helloButton, citatKnapp, label1;

- (void)loadView {
    [super loadView]; 
citatDatabas = [NSArray arrayWithObjects:
                    [NSString stringWithFormat:@"%@", @"People ask me, would you rather be feared or loved, um easy, I want people to be afriad of how much they love me - Michael Scott" ],
                    [NSString stringWithFormat:@"%@", @"You miss 100% of all the shoots you dont take - Wayne Greatsky - Michael Scott" ],
                    [NSString stringWithFormat:@"%@", @"DONT PANIC - hitchhiker's guide to the galaxy" ],
                    [NSString stringWithFormat:@"%@", @"Give someone a mask and they'll show their true face - Oscar Wilde" ],
                    [NSString stringWithFormat:@"%@", @"Given enough time, hydrogen starts to wonder where it came from, and where it is going" ],
                    [NSString stringWithFormat:@"%@", @"You have just begun reading the sentence you just finished reading" ],
                    nil];

    self.citatKnapp = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    self.citatKnapp.frame = CGRectMake(98, 162, 124, 37);
    [self.citatKnapp setTitle:@"Tryck för citat" forState:UIControlStateNormal];
    [self.citatKnapp addTarget:self action:@selector(citatKnappPressed:)     forControlEvents:UIControlEventTouchUpInside];

    self.citatKnapp.autoresizingMask = UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin;

    [self.view addSubview:self.citatKnapp];

    self.label1 = [[UILabel alloc]initWithFrame:CGRectMake(20, 71, 200, 83)];

    self.label1.frame = CGRectMake(20, 71, 200, 83);
    self.label1.text = @"hej";
    self.label1.backgroundColor = [UIColor greenColor];
    [self.view addSubview:self.label1];

}

- (IBAction)citatKnappPressed:(id)sender{

    self.label1.text = [citatDatabas objectAtIndex:
                  (random() % [citatDatabas count])];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:09:11.440

您的标签即将发布，请使用`@property (strong, nonatomic) IBOutlet UILabel *label1;`

如果您在分配 label1 后的任何行上放置一个断点，您将看到 label1 为 nil

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:04:28.427

loadView 中的原因，你的视图没有初始化。它是通过 XIB/StoryBoard 连接的吗？

如果不，

只需将您的视图初始化为方法中的第一行，为其添加标签

```
self.view = [[UIView alloc]initWithFrame:CGRectMake(0,0,320,480)]; 
```

然后写下你剩下的代码

# php - 用于更新 Mysql 表的 HTML 按钮

> ID：12412077
> 
> 赞同：-1
> 
> 时间：2012-09-13T17:57:56.890
> 
> 标签：php, mysql, html

我正在尝试使用我的 html 页面中的按钮更新 MySQL 表中的一行。当我按下按钮时，它会输出“查询失败”。我应该改变什么才能让它工作？

我的 HTML 代码：

```
<form action="status1.php">
     <input type="submit" name="approve" value=" + ">
</form> 
```

我的PHP代码：

```
<?php
require_once('config.php');
    $errmsg_arr = array();
    $errflag = false;
    $link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
    if(!$link) {
        die('Failed to connect to server: ' . mysql_error());
    }
    $db = mysql_select_db(DB_DATABASE);
    if(!$db) {
        die("Unable to select database");
    }
$qry="UPDATE applications SET (status) values('1') WHERE today='$today'";
$result = mysql_query($qry);
    if($result) {
        header("location: applications-admin.php");
        exit();
    }else {
        die("Query failed");
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:59:21.433

您对 UPDATE 使用了错误的语法；它应该是这样的：

```
$qry="UPDATE applications SET status='1' WHERE today='$today'"; 
```

**然而**

您应该考虑远离这些`mysql_*`功能，因为它们已被弃用 - 您应该考虑使用 PDO 或 mysqli 代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:59:52.197

UPDATE tablename SET fieldname=value WHERE [条件]

# php - php 创建数组以及不断增加值

> ID：12412088
> 
> 赞同：0
> 
> 时间：2012-09-13T17:58:31.563
> 
> 标签：php, arrays, key

我希望将所有`$profit`与其关联的数组 ( `$mfgname`) 相加。

```
$i=0;
while ($i < $num) {
...
    $array[$mfgname] = $profittotal + $profit;
    echo $mfgname . " | " . $profit . "<br/>";
...
$i++; } 
```

吐出：

```
Mfgname1 | 5.00
Mfgname3 | 1.00
Mfgname1 | -1.00
Mfgname2 | 10.00
Mfgname3 | 4.50
Mfgname2 | -5.00 
```

利润是正确的，但是该数组只显示了 Mfg 显示的最后一个利润：

```
Array (
        [Mfgname1] => -1.00
        [Mfgname2] => -5.00
        [Mfgname3] => 4.50
      ) 
```

如果它与该 Mfgname 相关联，我正在尝试将它们加起来。我相信我必须在 while 循环中找到数组值并尝试将其添加到最新的输出`$profit`中。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:08:48.490

我不确定你想做什么，但这是我的猜测

```
$array[$mfgname] += $profit; 
```

代替

```
$array[$mfgname] = $profittotal + $profit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:04:08.660

如果我明白你想要什么，我认为你在错误的地方使用了错误的变量。尝试这个：

```
$profittotal = $array[$mfgname] + $profit;
echo $mfgname . " | " . $profittotal . "<br/>"; 
```

# python - 无法在scrapy中找出正确的循环

> ID：12412091
> 
> 赞同：4
> 
> 时间：2012-09-13T17:58:46.627
> 
> 标签：python, scrapy

我是新手。

这是我的蜘蛛：

```
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector
from ampa.items import AmpaItem

class AmpaSpider(CrawlSpider):
    name = "ampa"
    allowed_domains = ['website']
    start_urls = ['website/page']

rules = (Rule(SgmlLinkExtractor(allow=('associados?', ), deny=('associado/', )), callback='parse_page', follow=True),)

def parse_page(self, response):
    hxs = HtmlXPathSelector(response)
    item = AmpaItem()
    farmers = hxs.select('//div[@class="span-24 tx_left"]')
    item['nome'] = farmers.select('//div/h3[@class="titulo"]/a/text()').extract()
    item['phone'] = farmers.select('//div/span[@class="chamada"]/a[contains(text(), "Telefone")]/text()').extract() 
    item['email'] = farmers.select('//div/span[@class="chamada"]/a[contains(text(), "E-mail")]/text()').extract()
    print item.values()
    return item 
```

这是我的管道：

```
class CsvWriterPipeline(object):

def __init__(self):
    self.csvwriter = csv.writer(open('items.csv', 'wb'))

def process_item(self, item, ampa):
    self.csvwriter.writerow([item['nome'], item['phone'], item['email']])   
    return item 
```

该网站的每个页面都有一个姓名、电话和电子邮件列表。上面的代码将输出一个 csv 文件，每页包含三列和一行。在第一列中，每个单元格是该页面中所有姓名的列表，在第二列中，它们是所有电话的列表，在第三列中，它们是所有电子邮件的列表。

**我真正想做的是将每个姓名、电话和电子邮件放在单独的行中。**我试图通过遍历每个项目来做到这一点，但它只在每一页上打印名字、电话和电子邮件。（是不是因为每次函数蜘蛛返回一个项目时，回调将爬虫移动到下一个URL）（是吗？？？）

你会怎么做呢？

这是项目：

```
from scrapy.item import Item, Field

class AmpaItem(Item):
nome = Field()
phone = Field()
email = Field() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T08:48:54.120

根据您在 中对复数的使用`farmes`，我假设页面上有很多农民。所以你的表达式很可能会返回一个农民的集合。

你能遍历农民的结果并产出每个项目吗？

```
#pseudocode
hxs = HtmlXPathSelector(response)
farmers = hxs.select('//div[@class="span-24 tx_left"]')
for farmer in farmer:
    item = AmpaItem()
    #be sure to select only one desired farmer here
    item['nome'] = farmers.select('//div/h3[@class="titulo"]/a/text()').extract()
    item['phone'] = farmers.select('//div/span[@class="chamada"]/a[contains(text(), "Telefone")]/text()').extract() 
    item['email'] = farmers.select('//div/span[@class="chamada"]/a[contains(text(), "E-mail")]/text()').extract()
    yield item 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T21:00:27.853

我通过更改管道找到了解决方案：

```
import csv
import itertools

class CsvWriterPipeline(object):

def __init__(self):
    self.csvwriter = csv.writer(open('items.csv', 'wb'), delimiter=',')

def process_item(self, item, ampa):
    for i,n,k in itertools.izip(item['nome'],item['phone'],item['email']):  
        self.csvwriter.writerow([i,n,k])    
    return item 
```

谢谢 DrColossos 和 dm03514！

这是我关于stackoverflow的第一个问题！！

# wpf - 液晶屏全高清的WPF

> ID：12412092
> 
> 赞同：3
> 
> 时间：2012-09-13T17:58:48.360
> 
> 标签：wpf, canvas, viewbox, lcd, scaletransform

我正在开发一个 WPF 应用程序，它将显示在全高清 LCD 屏幕（42 英寸）中。此外，我需要将控件容纳在绝对位置。在开发环境中，我看不到长度为 1920x1080 的窗口（这是目标屏幕的固定分辨率）。

完成此任务的最佳实践是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T20:39:18.610

WPF 使用与设备无关的单位来指定宽度/高度/位置/厚度等。

当您的屏幕 DPI 设置为 96dpi 时，1 DIU/DIP = 1 个物理像素.....但是当 DPI 不是 96dpi 时，1 DIU = 不同数量的物理像素。

如果您使用 a`Canvas`那么它使用 DIU 定位元素。

现在你暗示你想绝对定位在像素坐标方面。

因此，`Canvas`无论当前的 DPI 设置是什么，要做到这一点，您都必须使用缩放技巧（您可以使用 a`ViewBox`或 a来做到这一点`LayoutTransform`）。

下面的示例显示了实现它的一种方法（我的屏幕是 1366x768 ....您可以将其更改为全高清）。

它查看系统的 DPI，并`Canvas`在 DPI 上升时按比例缩小。这允许您使用真正意味着像素坐标的画布坐标。

如果您能够将用户屏幕更改为 96dpi，则无需进行缩放技巧，因为 1 DIU = 96dpi 时的 1 个物理像素……无需重新缩放。

```
<Window x:Class="WpfApplication12.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None"
        AllowsTransparency="True" Background="White"
        SizeToContent="WidthAndHeight"
        Title="MainWindow" Loaded="Window_Loaded">
    <Viewbox x:Name="viewbox">
    <Canvas x:Name="canvas">
        <Rectangle x:Name="rect" Canvas.Top="10" Canvas.Left="10" Stroke="Red" StrokeThickness="1"/>
        <Button Canvas.Top="20" Canvas.Left="20">Test Button</Button>
            <Ellipse Canvas.Top="100" Canvas.Left="100" Width="100" Height="100" Stroke="Red" StrokeThickness="10"/>
            <TextBlock Canvas.Top="100" Canvas.Left="100" FontSize="15">Some Text</TextBlock>
        </Canvas>
    </Viewbox>
</Window> 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication12
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        // HD
        const int screenwidth = 1366;
        const int screenheight = 768;

        // FULL HD
        //const int screenwidth = 1920;
        //const int screenheight = 1080;

        public MainWindow()
        {
            InitializeComponent();

            Top = 0;
            Left = 0;

            canvas.Width = screenwidth;
            canvas.Height = screenheight;

            rect.Width = screenwidth - 20;
            rect.Height = screenheight - 20;
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            bool bScaleBackToPixels = true;

            if (bScaleBackToPixels)
            {
                PresentationSource presentationsource = PresentationSource.FromVisual(this);
                Matrix m = presentationsource.CompositionTarget.TransformToDevice;

                double DpiWidthFactor = m.M11;
                double DpiHeightFactor = m.M22;

                viewbox.Width = screenwidth / DpiWidthFactor;
                viewbox.Height = screenheight / DpiHeightFactor;
            }
            else
            {
                viewbox.Width = screenwidth;
                viewbox.Height = screenheight;
            }
        }
    }
} 
```

* * *

```
<Window x:Class="WpfApplication12.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None"
        AllowsTransparency="True" Background="White"
        SizeToContent="WidthAndHeight"
        Title="MainWindow" Loaded="Window_Loaded">
    <Canvas x:Name="canvas">
        <Rectangle x:Name="rect" Canvas.Top="10" Canvas.Left="10" Stroke="Red" StrokeThickness="1"/>
        <Button Canvas.Top="20" Canvas.Left="20">Test Button</Button>
            <Ellipse Canvas.Top="100" Canvas.Left="100" Width="100" Height="100" Stroke="Red" StrokeThickness="10"/>
            <TextBlock Canvas.Top="100" Canvas.Left="100" FontSize="15">Some Text</TextBlock>
        </Canvas>
</Window> 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication12
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        // HD
        const int screenwidth = 1366;
        const int screenheight = 768;

        // FULL HD
        //const int screenwidth = 1920;
        //const int screenheight = 1080;

        public MainWindow()
        {
            InitializeComponent();

            Top = 0;
            Left = 0;

            canvas.Width = screenwidth;
            canvas.Height = screenheight;

            rect.Width = screenwidth - 20;
            rect.Height = screenheight - 20;
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            bool bScaleBackToPixels = true;

            if (bScaleBackToPixels)
            {
                PresentationSource presentationsource = PresentationSource.FromVisual(this);
                Matrix m = presentationsource.CompositionTarget.TransformToDevice;

                double DpiWidthFactor = m.M11;
                double DpiHeightFactor = m.M22;

                double scalex = 1 / DpiWidthFactor;
                double scaley = 1 / DpiHeightFactor;

                canvas.LayoutTransform = new ScaleTransform(scalex, scaley);
            }
        }
    }
} 
```

* * *

在 96 DPI 设置（较小 - 100%）下，屏幕如下所示：

![在此处输入图像描述](../Images/4855a0742b5b18d1f31e0fcbc8aede7f.png)

在 120 DPI 设置（中 - 125%）（即 96 x 1.25 = 120DPI）下，使用我上面的 ScaleBackToPixels 技术时屏幕看起来像这样（即它看起来与第一个屏幕相同）。

![在此处输入图像描述](../Images/69d03a4f1ceb3edb8a35374367d50d67.png)

在 120 DPI 设置（Medium - 125%）（即 96 x 1.25 = 120DPI）下，当您根本不进行任何调整时，屏幕看起来像这样（注意圆圈变大了，以及按钮的字体和大小）。

![在此处输入图像描述](../Images/2f5ffcf129d60807b4cd0c3fc6c9ef45.png)

所有 3 张图像并排进行比较：

![在此处输入图像描述](../Images/c3bbeb91581e43ae7ff793e036955c30.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T21:21:28.153

这是使屏幕分辨率 1920x1080 (FullHD) 在我的笔记本电脑屏幕分辨率 1366x768 中可见的转换：

**XAML**

```
 <ContentControl  Canvas.Left="1630" Canvas.Top="400" Content="{Binding Time}" />
        <ContentControl  Canvas.Left="1630" Canvas.Top="590" Content="{Binding NextPrayTime}" />
        <ContentControl  Canvas.Left="1650" Canvas.Top="700" Content="{Binding Today}" />
        <ContentControl  Canvas.Right="520" Canvas.Top="120" Content="{Binding Content}" />
        <ContentControl  Canvas.Left="0" Canvas.Top="965" Content="{Binding PrayTimes}">

        </ContentControl>
    </Canvas>
</Viewbox> 
```

**C＃**

```
static public class HD
{
    static public float Width { get { return 1366.0f; } }
    static public float Height { get { return 768.0f; } }
}

static public class FHD
{
    static public float Width { get { return 1920.0f; } }
    static public float Height { get { return 1080.0f; } }
}

static public class HDRatios
{
    static public double Width
    {
        get
        {
#if (DEBUG)
            return double.Parse((HD.Width / FHD.Width).ToString("0.0"));
#else
            return 1;
#endif
        }
    }
    static public double Height
    {
        get
        {
#if (DEBUG)
            return double.Parse((HD.Height / FHD.Height).ToString("0.0"));
#else
            return 1;
#endif
        }
    } 
```

该代码演示了在开发环境（DEBUG 标志）中将应用转换，而在发布版本中将不应用转换，因为它`Canvas.Left`是`Canvas.Top`根据全高清的分辨率。

我希望这种经验将帮助其他`Canvas`在绝对度量中遇到 WPF 中显示控件的人。

# networking - 通过网络传输 60GB 以上的文件有哪些选择？

> ID：12412099
> 
> 赞同：2
> 
> 时间：2012-09-13T17:59:09.233
> 
> 标签：networking, ftp, network-programming, compression

我即将开始开发一个应用程序来传输非常大的文件而不急于但需要可靠性。我希望那些曾经编写过这样一个特殊案例的人能给我一个关于我将要进入的内容的见解。

环境将是intranet ftp server>到目前为止使用active ftp normal ports windows系统。我可能还需要在发送之前压缩文件，我记得曾经使用过一个库，它会压缩到内存中，并且大小有限制......对此的想法也将不胜感激。

让我知道是否需要澄清其他内容。如果有任何不是真正详细的帮助，我正在寻求一般/更高级别的陷阱。我以前做过正常大小（最大 1GB）的应用程序，但这个似乎我需要限制速度，所以我不会破坏网络或类似的东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:09:10.583

我认为您可以从洪流中获得一些灵感。

Torrent 通常将文件分解为可管理的部分并计算它们的哈希值。后来他们一块一块地转移它们。每件作品都经过哈希验证，只有在匹配时才被接受。这是一种非常有效的机制，可以让传输从多个来源发生，也可以在不担心数据损坏的情况下重新启动任意次数。

对于从服务器到单个客户端的传输，我建议您创建一个标头，其中包含有关文件的元数据，以便接收者始终知道会发生什么，也知道已收到多少，还可以根据哈希检查收到的数据。

我实际上已经在客户端服务器应用程序上实现了这个想法，但数据大小要小得多，比如 1500k，但可靠性和冗余是重要因素。这样，您还可以有效地控制您希望通过应用程序允许的流量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:19:45.107

我认为要走的路是使用 rsync 实用程序作为 Python 的外部进程 -

[从这里](http://www.csc.fi/english/pages/data-services/transport/rsync)引用：

> 使用校验和将这些片段传输到目标站点中可能存在的文件，并仅传输从目标站点找不到的那些片段。实际上，这意味着如果要复​​制的文件的旧版本或部分版本已经存在于目标站点中，rsync 只会传输文件的缺失部分。在许多情况下，这会使数据更新过程更快，因为每次源站点和目标站点同步时都不会复制所有文件。

您可以使用 -z 开关进行动态压缩以透明地传输数据，无需启动任何一端来压缩整个文件。

另外，请在此处查看答案： [https ://serverfault.com/questions/154254/for-large-files-compress-first-then-transfer-or-rsync-z-which-would-be-fastest](https://serverfault.com/questions/154254/for-large-files-compress-first-then-transfer-or-rsync-z-which-would-be-fastest)

从 rsync 的手册页中，这可能很有趣：

> ```
>  --partial
>           By  default,  rsync  will  delete any partially transferred
>           file if the transfer is interrupted. In some  circumstances
>           it  is  more desirable to keep partially transferred files.
>           Using the --partial option tells rsync to keep the  partial
>           file which should make a subsequent transfer of the rest of
>           the file much faster 
> ```

# html - CSS：响应式布局中的高度自动问题

> ID：12412104
> 
> 赞同：5
> 
> 时间：2012-09-13T17:59:29.430
> 
> 标签：html, responsive-design, css

我在响应式布局中使用 jquery 延迟加载，并使用空白 gif 作为预览图像。为了让延迟加载工作，我必须通过属性设置图像的高度和宽度。

预览图像未设置为正确的高度，因为 height:auto 似乎是通过 src 而不是 height-attribute 计算高度。我总是得到一个正方形。

这是一个例子：

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Test</title>
  <style type="text/css">
    img {
      background-color: #000;
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <img src="blank.gif" width="500" height="300">
</body>
</html> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:19:02.750

没有固定的正确高度。如果我在 css 中设置固定高度，则图像将不会在我的响应式布局中以正确的纵横比调整大小。

主要问题是css从由src-attribute而不是width-和height-attribute设置的图像计算自动高度和纵横比。因此，如果有一个具有宽度和高度的真实图像，则一切正常。但是如果有一个空白（这只是一个拉伸的 1x1 图像），纵横比将无法正确计算，因为 html 设置的宽度和高度对 css 计算没有影响（但是没有 css 的浏览器如何显示它） -计算）。

我想到的一件事是仅为“真实图像”设置“高度：自动”，并在每次调整窗口大小时通过 jquery 计算“空白图像”的高度：

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Test</title>
  <style type="text/css">
    img {
      max-width: 100%;
    }
    .lazy-loaded {
      height: auto;
    }
  </style>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
  <script language="JavaScript">
    $(document).ready(function(){
      resizeBlankImages();
    });
    $(window).resize(function(){
      resizeBlankImages();
    });
    function resizeBlankImages() {
      $(".lazy-blank").each(function () {
        var originalWidth = $(this).attr('width');
        var originalHeight = $(this).attr('height');
        var ratio = originalWidth/originalHeight;
        var width = $(this).width();
        var height = width/ratio;
        $(this).height(height);
      });
    }
  </script>
</head>
<body>
  <img data-original="image.jpg" src="image.jpg" class="lazy lazy-loaded" width="500" height="300">
  <br/>
  <img data-original="image.jpg" src="blank.gif" class="lazy lazy-blank" width="500" height="300">
</body>
</html> 
```

它可以工作，但在包含许多图像的页面上可能会变得非常麻烦。有人对此有其他想法吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T04:16:53.953

将 .load 事件处理程序添加到您的惰性图像。当它们加载时，我们添加 .lazy_loaded 类

```
$("img.lazy").lazyload().load(function() {
    var self = $(this);
    if(self.attr('src') == self.data('original')){
        self.addClass('lazy_loaded');
    }
}); 
```

然后在你的CSS中，只应用高度：自动；.lazy_loaded 规则

```
.img.lazy{
    max-width: 100%;
}
img.lazy_loaded{
    height: auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:15:55.100

正确的高度是多少？如果您尝试使用 500 x 300 像素的固定大小，那么我建议您完全从 CSS 中进行操作。

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Test</title>
  <style type="text/css">
    img {
      background-color: #000;
      max-width: 100%;
      width: 300px;
      height: 500px;
    }
  </style>
</head>
<body>
  <img src="blank.gif" alt="preview" />
</body>
</html> 
```

# c - rand() 在 C 中有多独特？

> ID：12412108
> 
> 赞同：2
> 
> 时间：2012-09-13T17:59:38.270
> 
> 标签：c, random, unique, uniqueidentifier

我正在使用`rand()`需要唯一值的 6 位字段。我做对了吗？

有多少几率，`rand()`可以在连续或频繁调用时给我类似的值？

当我使用 rand() 时，它是独一无二的。但是，当我调用`srand(time(NULL))`or 时返回了相同的号码`srand(clock())`。似乎，它对我来说是相反的。或者是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:03:01.110

[`rand()`](http://www.cplusplus.com/reference/clibrary/cstdlib/rand/)返回 0 和 之间的值`RAND_MAX`。由于它是离散的均匀分布，`RAND_MAX`因此重复数字的概率为 1/( +1)，因此无法保证唯一性。

`srand(seed)`初始化您的随机数生成器，以便每次从中获得的数字序列`rand()`都是相同的，因为您每次都对其进行初始化`seed`。

在您的示例[`seed = time(NULL)`](http://www.cplusplus.com/reference/clibrary/ctime/time/)中，这是从 1970 年 1 月 1 日开始经过的秒数，因此确保了不同的种子，因此每次调用都有不同的随机数序列`srand(time(NULL))`（假设它不是在同一秒内进行的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:07:20.877

正如其他人指出的那样，不能保证唯一性。但是，您可能会看到重复的数字，因为您错误地使用了 srand() 和 rand()。

srand() 用于播种随机数生成器。这意味着在调用 srand 之后对 rand() 的一系列调用将产生一系列特定的值。如果您使用相同的值调用 srand() ，则 rand() 将产生相同系列的值（对于给定的实现，不同实现之间无法保证）

```
int main() {
    srand(100);
    for(int i = 0; i<5; ++i)
        printf("%d\n",rand());

    printf("\nreset\n\n");

    srand(100);
    for(int i = 0; i<5; ++i)
        printf("%d\n",rand());

} 
```

对我来说，这会产生：

```
365
1216
5415
16704
24504

reset

365
1216
5415
16704
24504 
```

time() 和 clock() 返回时间，但如果你调用它们的速度足够快，那么返回的值将是相同的，所以你会从 rand() 中得到相同的一系列值。

此外 rand() 通常不是一个很好的随机数生成器，使用它通常意味着您必须将一系列数字转换为您实际需要的分布。你应该找到一个不同的随机源，要么学习正确的方法来产生你想要的分布，要么使用一个可以为你做的库。（例如，一种在 0 和 N 之间产生“随机”数的常用方法是这样做`rand() % N`，但这并不是最好的方法。

C++ 在`<random>`. 它提供了不同的 PRNG 算法，例如 linear_congruential、mersenne_twister，甚至可能提供加密安全的 RNG（取决于实现）。它还提供了用于生成各种分布的对象，例如应避免在`rand() % N`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T18:04:21.720

随机数是*随机*的，不是*唯一的*。就像掷骰子的情况一样，当你可以连续掷出几个六时，你`rand`可以（并且应该）有时会给你相同的数字。

为了确保数字是唯一的，请构建一个集合，在其中注册您已经添加的每个数字。当一个随机数出现不止一次时，扔掉第二个，然后去寻找下一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:14:31.550

> rand() 在连续或频繁调用时可以给我类似的值的几率是多少？

的算法`rand`在 C 中未指定。返回的数字的随机性质量也是如此`rand`。

![在此处输入图像描述](../Images/7a1610df0a324c37467ce85d675768d1.png)

# c# - 自托管 WCF 服务的多个实例

> ID：12412111
> 
> 赞同：4
> 
> 时间：2012-09-13T17:59:40.693
> 
> 标签：c#, .net, wcf, multiple-instances, self-hosting

我们有一个从 C# 控制台应用程序运行的“工作者”服务，对于开发，我们总是运行该服务的单个实例，它获取数据块并执行一些计算，这些数据块由另一个服务提供（跟踪剩下多少数据等）

现在在 QA 中，我们希望同时（在同一台机器上）运行“worker”服务的多个实例。但是，一旦启动第二个实例，我们就会遇到异常：

> TransportManager 未能使用 NetTcpPortSharing 服务侦听提供的 URI：该 URI 已向该服务注册。

我们正在使用 netTcpBinding 并且端点地址被硬编码到 app.config 中并且保持不变，因此我假设我们遇到了这个错误。

```
<services>
    <service behaviorConfiguration="CoreBehavior" name="WorkerService">
        <endpoint address="net.tcp://localhost:8001/WorkerAssignment" binding="netTcpBinding" contract="IWorkerService" bindingConfiguration="CoreTcpBinding"/>
    </service>
</services>
<bindings>
    <netTcpBinding>
        <binding name="CoreTcpBinding" portSharingEnabled="true">
            <security mode="None"/>
        </binding>
    </netTcpBinding>
</bindings> 
```

申请代码：

```
var host = new ServiceHost(typeof(WorkerService));
host.Open(); 
```

我们如何为每个实例提供不同的 URI，以便至少端口保持不变？

或者如果有不同的方式来运行同一服务的多个实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:08:16.540

如果您想要拥有多个服务实例，**而**拥有单个服务主机就足够了 - 只需使用*ServiceBehaviorAttribute装饰您**的 WorkerService*

 *```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Percall)] 
public class WorkerService : IWorkerService 
{
  //...service data
} 
```

这将确保对服务的每次调用都将首先创建服务的新实例。可以在[这里找到创建服务类的其他方法](http://www.codeproject.com/Articles/86007/3-ways-to-do-WCF-instance-management-Per-call-Per)

但是，如果您希望拥有多个服务主机，那么不可能有两个服务主机在完全相同的 url 上托管相同的服务。

另一种情况是，如果您希望一个服务主机在具有相同基地址和自定义 uri 的多个端点上托管相同的服务。在这种情况下，您可以使用重载的 ServiceHost 构造函数或研究方法*AddBaseAddress*、*AddServiceEndpoint*。或者，如果您想从配置文件中执行此操作，那么这里的简单示例将稍微修改您的代码

```
<service behaviorConfiguration="CoreBehavior" name="WorkerService">
    <endpoint address="WorkerAssignment" binding="netTcpBinding" contract="IWorkerService"/>
    <endpoint address="QAWorkerAssignment" binding="netTcpBinding" contract="IWorkerService"/>
  <host>
    <baseAddresses>
      <add baseAddress="net.tcp://localhost:8001/" />
    </baseAddresses>
  </host>
</service> 
```

使用此配置，您将拥有两个服务端点

> net.tcp://localhost:8001/WorkerAssignment
> 
> net.tcp://localhost:8001/QAWorkerAssignment

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T01:02:03.913

Murtaza 你是对的，你仍然需要多个实例，问题是如何提供不同的端口

**替代 1：** 对于每个服务实例：在调用 ServiceHost.Open 之前，您可以将端点添加到服务

```
ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService))
WSHttpBinding binding = new WSHttpBinding();
serviceHost.AddServiceEndpoint(typeof(ICalculator), binding, "http://localhost:8000/servicemodelsamples/service/basic"); 
```

在上面的代码中，每个服务实例的地址部分可以有不同的端口。

详情如下[链接](http://msdn.microsoft.com/en-us/library/ms585836.aspx)

**备选方案 2：**启用端口共享

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding portSharingEnabled="true">
          <security mode="None" />
        </binding>
      </netTcpBinding>
    </bindings>
  </system.serviceModel>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:02:56.720

你可以定义你的`specific behavior`

```
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerCall, 
                 ConcurrencyMode = ConcurrencyMode.Multiple)] 
```*

# android - 将活动从纵向更改为横向并返回多次（即连续 5-15 次）会使应用程序崩溃

> ID：12412112
> 
> 赞同：0
> 
> 时间：2012-09-13T17:59:40.813
> 
> 标签：android

将页面上的视图从纵向更改为横向并返回多次（即连续 5-15 次）会使应用程序崩溃。错误文本是：

```
09-07 16:18:16.976: D/AndroidRuntime(4215): Shutting down VM
09-07 16:18:16.976: W/dalvikvm(4215): threadid=1: thread exiting with uncaught exception (group=0x40a2d1f8)
09-07 16:18:16.992: E/AndroidRuntime(4215): FATAL EXCEPTION: main
09-07 16:18:16.992: E/AndroidRuntime(4215): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.android.mobileTimerClock/com.android.mobileTimerClock.TimeClockDashBoard}: android.view.InflateException: Binary XML file line #3: Error inflating class <unknown>
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3351)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.access$700(ActivityThread.java:123)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1151)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.os.Handler.dispatchMessage(Handler.java:99)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.os.Looper.loop(Looper.java:137)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.main(ActivityThread.java:4424)
09-07 16:18:16.992: E/AndroidRuntime(4215): at java.lang.reflect.Method.invokeNative(Native Method)
09-07 16:18:16.992: E/AndroidRuntime(4215): at java.lang.reflect.Method.invoke(Method.java:511)
09-07 16:18:16.992: E/AndroidRuntime(4215): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-07 16:18:16.992: E/AndroidRuntime(4215): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-07 16:18:16.992: E/AndroidRuntime(4215): at dalvik.system.NativeStart.main(Native Method)
09-07 16:18:16.992: E/AndroidRuntime(4215): Caused by: android.view.InflateException: Binary XML file line #3: Error inflating class <unknown>
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.createView(LayoutInflater.java:606)
09-07 16:18:16.992: E/AndroidRuntime(4215): at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.onCreateView(LayoutInflater.java:653)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:678)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
09-07 16:18:16.992: E/AndroidRuntime(4215): at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:251)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.Activity.setContentView(Activity.java:1835)
09-07 16:18:16.992: E/AndroidRuntime(4215): at com.android.mobileTimerClock.TimeClockDashBoard.onCreate(TimeClockDashBoard.java:488)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.Activity.performCreate(Activity.java:4465)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-07 16:18:16.992: E/AndroidRuntime(4215): ... 12 more
09-07 16:18:16.992: E/AndroidRuntime(4215): Caused by: java.lang.reflect.InvocationTargetException
09-07 16:18:16.992: E/AndroidRuntime(4215): at java.lang.reflect.Constructor.constructNative(Native Method)
09-07 16:18:16.992: E/AndroidRuntime(4215): at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.LayoutInflater.createView(LayoutInflater.java:586)
09-07 16:18:16.992: E/AndroidRuntime(4215): ... 24 more
09-07 16:18:16.992: E/AndroidRuntime(4215): Caused by: java.lang.OutOfMemoryError
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.Bitmap.nativeCreate(Native Method)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.Bitmap.createBitmap(Bitmap.java:605)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.Bitmap.createBitmap(Bitmap.java:551)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:437)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:524)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:499)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.content.res.Resources.loadDrawable(Resources.java:1935)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.View.<init>(View.java:2785)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.view.ViewGroup.<init>(ViewGroup.java:385)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.widget.FrameLayout.<init>(FrameLayout.java:99)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.widget.ScrollView.<init>(ScrollView.java:152)
09-07 16:18:16.992: E/AndroidRuntime(4215): at android.widget.ScrollView.<init>(ScrollView.java:148)
09-07 16:18:16.992: E/AndroidRuntime(4215): ... 27 more
09-07 16:18:17.078: W/ActivityManager(181): Force finishing activity com.android.mobileTimerClock/.TimeClockDashBoard 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:05:44.433

你得到一个`OutOfMemoryError`. 你的活动是什么样的？你用的是什么版本的安卓？您的活动中是否有大型位图或 WebView？

您需要提供更多信息，或者尝试自己发现内存泄漏。[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)是一个很好的帮助工具。您可以尝试查看是否有任何东西持有对您正在销毁的活动的引用，这将防止它们被垃圾收集。[这篇博文](http://android-developers.blogspot.com/2011/03/memory-analysis-for-android.html)提供了一些基本的使用技巧。

**更新：**每个`AsyncTask`实例都可能持有对其宿主活动的引用。如果您`AsynTask`是活动的非静态内部类，则尤其如此。因此，当您轮换时，新任务将被触发，并且任何现有任务[都将继续运行](http://logc.at/2011/11/08/the-hidden-pitfalls-of-asynctask/)，除非您明确执行某些操作来阻止它们。

如果这些任务依赖于对其主机活动的引用，您可能会遇到内存问题。

有关此问题的解决方案，请参阅 Mark Murphy 的[博客文章](http://commonsware.com/blog/2010/09/10/asynctask-screen-rotation.html)。

> 示例项目将 AsyncTask 实现显示为静态内部类。该任务在 onRetainNonConfigurationInstance() 中返回，托管 Activity 负责确保 AsyncTask 在方向更改之前和之后知道要使用的正确 Activity 实例。

基本上，您需要确保您正确地“分离”了将从您的任务中销毁的主机活动。从那里开始，由您决定。您可以尝试将正在运行的任务从旧活动传递给新活动，也可以尝试强制它停止运行。这里的关键是**不要**为你使用内部类，`AsynTask`除非它是**static**。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T18:19:27.030

您可能会得到，`OutOfMemoryException`因为当活动破坏和重新创建时，某些对象（在大多数情况下，位图）没有被破坏/释放。

首先检查您的代码以查找并消除内存泄漏（如果有）。

然后，如果您的活动中有较大的位图或背景，请尝试从此类扩展您的活动：（它对我有用）

```
public abstract class AdvancedActivity extends Activity
{

  @Override
  protected void onResume()
  {
    System.gc();
    super.onResume();
  }

  @Override
  protected void onPause()
  {
    super.onPause();
    System.gc();
  }

  @Override
  public void setContentView(int layoutResID)
  {
    ViewGroup mainView = (ViewGroup)
      LayoutInflater.from(this).inflate(layoutResID, null);

    setContentView(mainView);
  }

  @Override
  public void setContentView(View view)
  {
    super.setContentView(view);
    m_contentView = (ViewGroup)view;
  }

  @Override
  public void setContentView(View view, LayoutParams params)
  {
    super.setContentView(view, params);

    m_contentView = (ViewGroup)view;
  }

  @Override
  protected void onDestroy()
  {
    super.onDestroy();

    // Fixes android memory  issue 8488 :
    // http://code.google.com/p/android/issues/detail?id=8488
    nullViewDrawablesRecursive(m_contentView);

    m_contentView = null;
    System.gc();
  }

  private void nullViewDrawablesRecursive(View view)
  {
    if(view != null)
    {
      try
      {
        if (view instanceof ViewGroup) {  
            ViewGroup viewGroup = (ViewGroup)view;
            int childCount = viewGroup.getChildCount();
            for(int index = 0; index < childCount; index++)
            {
              nullViewDrawablesRecursive(viewGroup.getChildAt(index));
            }
        }   
      }
      catch(Exception e)
      {          
      }

      nullViewDrawable(view);
    }    
  }

  private void nullViewDrawable(View view)
  {
    try
    {
      view.setBackgroundDrawable(null);
    }
    catch(Exception e)
    {          
    }

    try
    {
      ImageView imageView = (ImageView)view;
      imageView.setImageDrawable(null);
      imageView.setBackgroundDrawable(null);
    }
    catch(Exception e)
    {          
    }
  }

  // The top level content view.
  private ViewGroup m_contentView = null;
} 
```

当活动正在破坏时，它将尝试使任何可绘制对象为空。这不是一个标准的好方法，但至少它对我有用，当我在 2 次旋转后得到 OOM 时！

# ios - MonoTouch 5.4 和新 iPhone 5 + 新 XCode

> ID：12412113
> 
> 赞同：2
> 
> 时间：2012-09-13T17:59:44.020
> 
> 标签：ios, xamarin.ios, iphone-5

我们能否安装支持 iPhone 5 的新 XCode 并让它与 MonoTouch 5.4 一起使用，以创建适用于新屏幕尺寸的应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T21:56:03.877

[Redth](http://redth.info/get-your-monotouch-apps-ready-for-iphone-5-ios-6-today/ "不错的文章") # 发布了一篇关于让您的 MonoTouch 应用程序为 iPhone5 做好准备的精彩文章。对您的项目的关键更改是为新的显示尺寸添加新的初始图像，Default-568h@2x.png。我确信 Xamarin 将发布一个新版本，其中添加了一个 GUI 来设置它，但您现在可以按照 Redth# 的说明手动执行此操作。

# amazon-s3 - 为什么 boto 可能会被拒绝使用正确的 IAM 密钥访问 S3？

> ID：12412115
> 
> 赞同：6
> 
> 时间：2012-09-13T17:59:47.377
> 
> 标签：amazon-s3, boto, amazon-iam

我正在尝试使用 boto 访问 S3 上的存储桶。我已获得对存储桶的读取访问权限，并且当我在 S3 浏览器中探索它时，我的密钥正在工作。以下代码返回 403 Forbidden Access Denied。

```
conn = S3Connection('Access_Key_ID', 'Secret_Access_Key')
conn.get_all_buckets() 
```

通过 boto 配置文件使用访问密钥和秘密访问密钥时也会发生这种情况。由于密钥可能来自 IAM，我还需要做些什么吗？这是否表明设置中有错误？我对 IAM 了解不多，我只是得到了钥匙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-01T21:16:31.640

有些事情要检查...

*   如果您使用 boto，请确保您使用 conn.get_bucket(bucket_name) 仅访问您有权访问的存储桶。

*   在您的 IAM（用户）策略中，如果您要限制对单个存储桶的访问，请确保该策略包含对存储桶的足够权限，并且不包含用于 ARN 名称的尾部斜杠+星号（请参见下面的示例）。

*   请务必在存储桶的 S3 中为“Authenticated Users”设置“上传/删除”权限。

**权限示例：**

![在此处输入图像描述](../Images/2cc227b430215f3a6e398b4a7247e533.png)

**IAM 政策示例：**

*注意：使用策略生成器时会自动生成 SID*

```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
        "s3:*"
      ],
      "Sid": "Stmt0000000000001",
      "Resource": [
        "arn:aws:s3:::myBucketName"
      ],
      "Effect": "Allow"
    }
  ]
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T21:30:06.653

我的猜测是，这是因为您为您有权访问的单个存储桶调用 conn.get_all_buckets() 而不是 conn.get_bucket(bucket_name) 。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2018-01-20T01:46:30.753

`from boto.s3.connection import S3Connection conn = S3Connection('access key', 'secret access key') allBuckets = conn.get_all_buckets() for bucket in allBuckets: print(str(bucket.name))`

# python - 在python中剥离字符串的侧面

> ID：12412116
> 
> 赞同：1
> 
> 时间：2012-09-13T17:59:47.507
> 
> 标签：python, string, strip

我有一个这样的列表：

> 番茄4439, >gi|224089052|ref|XP_002308615.1| 预测蛋白质 [毛果杨]

我想使用 python 去除不需要的字符，所以列表看起来像：Tomato Populus trichocarpa

我可以为第一个执行以下操作：

```
name = ">Tomato4439"
name = name.strip(">1234567890")
print name
Tomato 
```

但是，我不确定如何处理第二个。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:13:15.910

给定：

```
s='Tomato4439, >gi|224089052|ref|XP_002308615.1| predicted protein [Populus trichocarpa]' 
```

这：

```
s = s.split()
[s[0].strip('0123456789,'), s[-2].replace('[',''), s[-1].replace(']','')] 
```

会给你

```
['Tomato', 'Populus', 'trichocarpa'] 
```

如果您要经常这样做，可能值得研究正则表达式，并且“规则”可能不是静态的，因为正则表达式在这种情况下处理数据更加灵活。但是，对于您提出的示例问题，这将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:06:55.927

```
>>> import re
>>> line = "Tomato4439, >gi|224089052|ref|XP_002308615.1| predicted protein [Populus trichocarpa]"
>>> match = re.match("^([a-zA-Z]+).*\[([a-zA-Z ]+)\].*",line)
>>> match.groups()
('Tomato', 'Populus trichocarpa') 
```

编辑为不包括`[]`第二部分...这应该适用于与查询模式匹配的任何内容（例如，以名称开头，以 [] 中的内容结尾）它也将匹配 `"Tomato4439, >gi|224089052|ref|XP_002308615.1| predicted protein [Populus trichocarpa apples]"`例如

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:07:11.440

```
import re
a = "Tomato4439, >gi|224089052|ref|XP_002308615.1| predicted protein [Populus trichocarpa]"
re.sub(r"^([A-Za-z]+).+\[([^]]+)\]$", r"\1 \2", a) 
```

这给

```
'Tomato Populus trichocarpa' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T18:07:16.723

如果您尝试解析的字符串在语义上是一致的，那么您最好的选择可能是对您拥有的不同“类型”字符串进行分类，然后使用 python 的`re`模块创建正则表达式来解析它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T18:19:58.590

以前的答案比我的简单，但是：

这是打印您不想要的东西的一种方法。

```
tag = "Tomato4439, >gi|224089052|ref|XP_002308615.1| predicted protein [Populus trichocarpa]"
import re, os
find = re.search('>(.+?) \[', tag).group(1)
print find 
```

给你

```
gi|224089052|ref|XP_002308615.1| predicted protein 
```

然后您可以使用替换功能将其从原始字符串中删除。以及用于删除多余不需要的字符的翻译功能。

```
tag2 = tag.replace(find, "")
tag3 = str.translate(tag2, None, ">[],")
print tag3 
```

给你

```
Tomato4439  Populus trichocarpa 
```

# visual-studio-2010 - MVC4 源码和 VS2010

> ID：12412123
> 
> 赞同：3
> 
> 时间：2012-09-13T18:00:18.060
> 
> 标签：visual-studio-2010, asp.net-mvc-4

背景：

根据[http://aspnetwebstack.codeplex.com/documentation](http://aspnetwebstack.codeplex.com/documentation)上的文档（在“获取和构建代码”下，第一项说：

```
The easiest way to work with our source is to install Visual Studio 2010 (with SP1). 
```

我正在运行 VS2010 SP1 并已设法按照所有说明启动并运行此源代码（在我的 Win7 64 位机器上）。我安装了 .NET 4.5 框架。

问题：

在构建期间（从命令行）以及从 Visual Studio 本身，我收到以下错误：

```
"The project file 'MY_LOCAL_PATH\src\System.Net.Http.Formatting.NetCore\System.Net.Http.Formatting.NetCore.csproj' cannot be opened. The project type is not supported." 
```

有谁知道如何让这个项目加载？Runtime.sln 中的所有其他内容都可以正常加载。

更新：

项目文件 (csproj) 中的两个项目类型 guid 是`BC8A1FFA-BEE3-4634-8014-F334798102B3`和`FAE04EC0-301F-11D3-BF4B-00C04F79EFBC`. 第一个与 Metro 有关，另一个是 C#。我可以理解地铁挂断，但文档再次说 VS2010 SP1 很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T21:31:23.330

如此[处](http://aspnetwebstack.codeplex.com/discussions/394550)所述，该解决方案现在需要 VS2012 和 Windows 8。我将相应地更新文档 Wiki。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T14:15:27.190

我已经通过电子邮件发送了一些人以及这篇文章，但无济于事。对此进行更多研究，我的最佳猜测是，由于 Metro 项目类型，我需要安装 Windows 8 才能使其正常工作。无论这个项目如何，MVC 项目都会构建，所以我要说这就是答案。

# ruby-on-rails - 在 Ruby/Rails 中遍历和解析文件

> ID：12412128
> 
> 赞同：1
> 
> 时间：2012-09-13T18:00:22.460
> 
> 标签：ruby-on-rails, ruby, file, parsing

有人可以向我指出一些用于在 Rails 应用程序中处理文件的文档/库吗？

具体来说，我需要扫描文件夹中的文件，并为每个文件夹读取并解析其中的一些数据。我以前没有在 Ruby 中做过这个，所以不知道去哪里找。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:01:59.440

在 Ruby 中解析文件非常容易。要在 Rails 中做到这一点，您只需使用 Ruby 文件库。在不知道您想做什么的情况下，我无法给您任何示例，但我可以为您指出 Ruby API。

文件：[http ://www.ruby-doc.org/core-1.9.3/File.html](http://www.ruby-doc.org/core-1.9.3/File.html)

目录：[http ://www.ruby-doc.org/core-1.9.3/Dir.html](http://www.ruby-doc.org/core-1.9.3/Dir.html)

# c++ - 在给定平面上创建 XYZ 位置的数据集

> ID：12412141
> 
> 赞同：1
> 
> 时间：2012-09-13T18:01:34.200
> 
> 标签：c++, 3d, geometry, computational-geometry, linear-algebra

我需要在给定起点和基于平面的位置之间的偏移量的情况下创建 XYZ 位置列表。在平面上，这很容易。假设我需要的偏移量是从位置 0,0,0 向下移动 3 然后向右移动 2

输出将是：

```
0,0,0 (starting position)
0,-3,0 (move down 3)
2,-3,0 (then move right 2) 
```

不同的起始位置也是如此，比如说 5,5,1：

```
5,5,1 (starting position)
5,2,1 (move down 3)
7,2,1 (then move right 2) 
```

当飞机不再在这个平面网格上时，问题就来了。

我能够计算给定 3 个点的平面方程和法向量。但是现在给定这个方程，我能做些什么来创建这个 XYZ 位置的数据集？

我知道我可以在给定两个值的情况下求解 XYZ。假设我知道 x=1 和 y=1，我可以求解 Z。但是向下移动 2 不再只是 y-2。我相信我需要在 x 和 y 轴上找到一个线性方程来增加位置并平行于这个新平面的 x 和 y 移动，然后只求解 Z。我不知道如何完成这个。

另一个问题是我需要计算这个平面相对于基准平面的角度、倾斜和旋转。

例如：

```
P1=0,0,0 and P2=1,1,0 the tilt=0deg angle=0deg rotation=45deg.
P1=0,0,0 and P2=0,1,1 the tilt=0deg angle=45deg rotation=0deg.
P1=0,0,0 and P2=1,0,1 the tilt=45deg angle=0deg rotation=0deg.
P1=0,0,0 and P2=1,1,1 the tilt=0deg angle=45deg rotation=45deg. 
```

我已经在这两个问题上搜索了几个小时，而且我总是在平面方程上停下来。正确操作 x,y 以平行于平面，然后利用该信息找到这些角度。这是要解决的很多几何问题，我找不到有关如何计算此点列表的更多信息，更不用说计算与基准平面的 3 个角度了。

我会对此有任何帮助或见解。只是简单的旧数学或对 C++ 的引用将非常适合阐明我在这里面临的这个问题。

谢谢你，马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:31:09.583

您可以将您的平面视为由一个点和一对[正交基](https://en.wikipedia.org/wiki/Orthonormal_basis)向量定义（这仅表示两个长度为 1、彼此成 90 度的向量）。你最基本的平面可以定义为：

```
p0 = (0, 0, 0) #Origin point
vx = (1, 0, 0) #X basis vector
vy = (0, 1, 0) #Y basis vector 
```

要查找在 X 方向和Y 方向`p1`上偏移的点，请使用以下公式：`dx``dy`

```
p1 = p0 + dx * vx + dy * vy 
```

如果您的偏移量沿给定轴（听起来像），则此公式将始终有效。如果向量已经旋转，这仍然是正确的——这就是您将要使用的属性。

因此，要找到沿旋转平面偏移的点：

1.  采用默认的基向量（`vx`和`vy`，上面）。
2.  旋转它们，直到它们定义了您想要的平面（您可能需要也可能不需要旋转原点，具体取决于问题的定义方式）。
3.  应用公式，得到你的答案。

现在，当您进行轮换时会有一些怪癖（顺序很重要！），但这是基本思想，应该足以让您走上正确的轨道。祝你好运！

# c# - 如何使用 C# 和实体框架实现 SQL Server 分页？

> ID：12412144
> 
> 赞同：1
> 
> 时间：2012-09-13T18:01:46.510
> 
> 标签：c#, sql-server, entity-framework, entity-framework-4

我必须使用实体框架更新包含大约 150,000 条记录的 Sql Server 表中的每一行。为了减少服务器的点击量，我想以 1000 行的单独批次执行此操作。我需要实体框架来：

1.  从数据库中选择前 1000 行。
2.  更新这些行。
3.  调用 SaveChanges() 方法。
4.  获取接下来的 1000 行。
5.  重复。

实现这一目标的最佳方法是什么？

我正在使用实体框架 4 和 SQL Server 2012。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:04:32.343

使用[LINQ](http://msdn.microsoft.com/en-us/library/bb336768) [Skip](http://msdn.microsoft.com/en-us/library/bb358985.aspx) & [Take](http://msdn.microsoft.com/en-us/library/bb503062)：

```
return query.Skip(HOW MUCH TO SKIP -AT THE BEGINNING WILL BE ZERO-)
    .Take(HOW MUCH TO TAKE -THE NUMBER OF YOUR PAGING SIZE-).ToList(); 
```

如果您想在循环中执行此操作，可以执行以下操作：

```
int pagingIncrement = 1000;
for (int i = 0; i <= 150 000; i=i+pagingIncrement)
{
    var query = your actual LINQ query.
    var results = query.Skip(i).Take(pagingIncrement);

    UpdatePartialResults(results);
} 
```

注意：重要的是，在更新这些行时，不要在实际的 LINQ 查询中更新 ORDER BY 的条件，否则最终可能会一次又一次地更新相同的结果（因为重新排序）。

其他想法是使用之前给出的一些想法来扩展 IEnumerable 迭代器，例如 a`Skip(counter).Take(pagingSize`和 yield result （有点异步处理）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:38:09.307

像这样的东西应该工作：

```
int skip =0;
int take = 1000;
for (int i = 0; i < 150; i++)
{
var rows = (from x in Context.Table
            select x).OrderBy(x => x.id).Skip(skip).Take(take).ToList();

//do some update stuff with rows

skip += 1000;
} 
```

# .net - 程序集在 MSTest 下无法加载 (EEFileLoadException)

> ID：12412147
> 
> 赞同：8
> 
> 时间：2012-09-13T18:01:54.377
> 
> 标签：.net, visual-studio-2010, c++-cli, mstest

我正在尝试在结合了托管代码和本机代码的 MSTest 场景中解决 EEFileLoadException。

我的应用程序由几十个 DLL 组成：一些本机（非托管）C++、一些 C++/CLI 和一些 C#。所有 DLL 都在同一个目录中。在正常操作中，主要可执行文件是本机 C++。本机 DLL 之一（我们称之为 Native.DLL）链接到 C++/CLI DLL，后者又引用了一个 C# 程序集，并且一切正常。

现在我正在尝试用 MSTest 编写测试。代码结构由 C# 单元测试组成，这些测试引用了一个 C++/CLI 程序集，该程序集调用了前面提到的 Native.DLL。但是，当我尝试运行测试时，我在 Native.DLL 调用它使用的第一个 C++/CLI 程序集时收到 EEFileLoadException。

我使用 Fusion 日志查看器尝试调试程序集加载问题。以下是日志的节选：

```
*** Assembly Binder Log Entry  (9/12/2012 @ 2:51:14 PM) ***

The operation failed.
Bind result: hr = 0x80070002\. The system cannot find the file specified.

Assembly manager loaded from:  C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll
Running under executable  C:\VS2010\Common7\IDE\QTAgent32.exe

LOG: Appbase = file:///C:/VS2010/Common7/IDE/
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\VS2010\Common7\IDE\QTAgent32.exe.Config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/VS2010/Common7/IDE/My.Managed.Assembly.DLL
(...)
LOG: All probing URLs attempted and failed. 
```

所以对我来说很清楚 AppBase 已设置为 QTAgent32.exe 的位置，并且它正在那里搜索托管程序集，而不是在我所有 DLL 实际所在的目录中。找到所有单元测试直接引用的程序集，并且找到非托管 DLL 没有问题，但是当非托管 DLL 尝试加载其他托管程序集时它会失败（尽管移动对单元测试的引用表明这是一个红鲱鱼；请参阅我的注释在“我尝试过的事情”下）。

我在 Visual Studio 2010 中完成所有这些工作。单元测试主要是生成的代码；它们实际上是用 SpecFlow 编写的验收测试。

如果还不清楚，我的问题是：**为什么我的程序集无法加载，我该如何解决？**

这是我已经尝试过的：

*   禁用部署（没有这个，我什至无法做到这一点）
*   将我的应用程序的路径添加到 LocalTestRun.testrunco​​nfig （作为“要加载的程序集的根文件夹”和“运行测试时使用的文件夹”）
*   添加`AppDomain.CurrentDomain.SetData("APPBASE", TheDirectoryThatMyDLLsAreIn);`到我的单元测试中
*   从我的单元测试代码中引用托管程序集，并在调用本机 C++ 之前向其中添加虚拟调用，以尝试预加载程序集，以便在 C++ 需要它们时它们已经存在。这产生了令人惊讶的结果：当 JIT 编译调用我的 C++/CLI 程序集的方法时，会发生相同的 EEFileLoadException。
*   为问题程序集添加了强名称。这没有效果。
*   添加了未能加载到 GAC 的程序集。执行此操作后，程序集加载仍然失败，但没有 Fusion 日志解释原因，并且测试结果包含消息“ `The same bind was seen before, and was failed with hr = 0x80070002.`”。无论如何，我不认为长期使用 GAC 是该项目可接受的解决方案。

这是运行测试时 MSTest 给出的错误：

```
Test method MyTestAssembly.MyTestMethod threw exception: 
System.TypeInitializationException: The type initializer for '<Module>' threw an exception. ---> <CrtImplementationDetails>.ModuleLoadExceptionHandlerException: A nested exception occurred after the primary exception that caused the C++ module to fail to load.
 ---> System.TypeInitializationException: The type initializer for '<Module>' threw an exception. ---> <CrtImplementationDetails>.ModuleLoadException: The C++ module failed to load during process initialization.
 ---> System.IO.FileNotFoundException: Could not load file or assembly 'MyNamespace.MyCPlusPlusCLIModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=1478252538103a9d' or one of its dependencies. The system cannot find the file specified.Assembly manager loaded from:  C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll
Running under executable  C:\VS2010\Common7\IDE\QTAgent32.exe 
```

# java - 如何防范资源耗尽等漏洞？

> ID：12412149
> 
> 赞同：3
> 
> 时间：2012-09-13T18:01:56.057
> 
> 标签：java, resources, exploit

我们碰巧使用了 IBM appscan [http://www-01.ibm.com/software/awdtools/appscan/](http://www-01.ibm.com/software/awdtools/appscan/)

针对我们的 java 代码库，它返回了大约 3000 个高严重性漏洞。

它们中的大多数恰好是系统信息泄漏，当我们在 catch 块中打印堆栈跟踪时它认为正在发生这种情况，但我们只打印它正在发生的文件名和行号，使我们能够更好地调试代码。

还有一些是关于 SQL 注入、输入验证等的。

但是，我的问题是关于资源耗尽（文件描述符、磁盘空间、套接字……），它列出了所有实例`java.io.BufferedReader.readLine`作为可能的外部攻击的位置。

```
 InputStream ins=conn.getInputStream();

      String inputLine;

      if (!preserveLinefeeds) {
         BufferedReader in = new BufferedReader(new InputStreamReader(ins));
         while ((inputLine = in.readLine()) != null)
            pr.readThreadResponse+=inputLine;
         in.close();
         ins.close();
      } 
```

conn 是一个 HttpURLConnection 对象。

如何在代码中添加安全防护以防止这种情况发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T05:41:22.437

如果 AppScan 指示与 readLine 关联的拒绝服务漏洞，则可能不是由于对关闭流失败的任何担忧（无论这可能多么重要），而是由于 readLine 的无限性质。由于 readLine 会继续读取输入，直到读取换行符或 CR-LF，如果输入源不受信任，则可能会在没有预期 CR-LF 的情况下向您提供大量数据，从而导致内存耗尽情况。

To resolve this you could either ensure (through mechanisms outside your app) that the input size is limited to something safe and reasonable (although AppScan, Fortify and other tools will continue to complain about the readLine) or, better yet, you could replace your readLines with a bounded read routine that sets an absolute maximum on the number of characters that will be read into the buffer.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:49:37.483

每次打开流时，请确保 finally 块在完成后关闭流。

如果从代码中的流读取时抛出 IOException，则流将不会关闭，因此会发出警告

Java 7 使用 try with resources 构造使这变得容易。在 Java 6 或更早版本中，您需要使用大量样板进行复制，例如

```
InputStream ins = null;
try {
  ins = conn.getInputStream();
  ...
} finally {
  IOUtils.closeQuietly(ins);
} 
```

使用 Apache Commons 中的 IOUtils 类

如果您不想添加依赖项，您可以编写自己的 closeQuietly

# ios - 无法摆脱分组 UITableView 中的部分背景颜色

> ID：12412150
> 
> 赞同：2
> 
> 时间：2012-09-13T18:01:57.553
> 
> 标签：ios, uitableview

我一直在尝试创建一个具有清晰背景的分组 UItableView。但由于某种原因，这些部分仍然具有浅灰色。我试图将 backgroundview 设置为 nil，但它不起作用。我还尝试将 backgroundView 设置为具有 clearColor 的视图，但也没有用。不知道我在这里做错了什么。

```
// make table's background clear
[self.myTable setBackgroundView:nil];
[self.myTable setBackgroundView:[[[UIView alloc] init] autorelease]];

UIView *bgView = [[UIView alloc] initWithFrame:self.myTable.frame];
bgView.backgroundColor = [UIColor clearColor];
self.myTable.backgroundView = bgView;
[bgView release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:06:25.967

如果您试图使单元格的背景清晰，您需要将 UICellView 的**backgroundView**属性更改为实际视图（nil 不起作用），在

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath { 
```

添加这个

```
cell.backgroundView = [[[UIView alloc] init] autorelease]; 
```

这将为单元格创建一个空白/空背景视图

# ios - 检查是否登录 ios facebook sdk 3.0

> ID：12412155
> 
> 赞同：6
> 
> 时间：2012-09-13T18:02:12.920
> 
> 标签：ios, cocoa, facebook-graph-api, ios5, facebook-ios-sdk

我正在使用 iOS facebook SDK 3.0。如何检查用户是否已经登录？

我尝试了下面的行，但它不能正常工作。尽管我已登录，但**有时**它会返回 NO。有什么建议吗？

```
if (FBSession.activeSession.isOpen == YES)
{
  // post to wall else login
} 
```

**- 编辑 -**

这就是我打开 Facebook 会话的方式：

```
NSArray *permissions = [[NSArray alloc] initWithObjects:
                        @"user_likes", 
                        @"read_stream",
                        @"publish_actions",
                        nil];
return [FBSession openActiveSessionWithPermissions:permissions
                                      allowLoginUI:allowLoginUI
                                 completionHandler:^(FBSession *session,
                                                     FBSessionState state,
                                                     NSError *error) {
                                     [self sessionStateChanged:session
                                                         state:state
                                                         error:error];
                                 }]; 
```

第一次需要登录，所以它可以工作。如果我在已经登录的情况下尝试此操作，则 FBSession.activeSession.isOpen 将返回 NO。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T22:52:28.750

您可以通过尝试在不允许登录 UI 的情况下打开新会话来检查您是否拥有有效的令牌

```
if (FBSession.activeSession.isOpen)
{
    // post to wall
} else {
    // try to open session with existing valid token
    NSArray *permissions = [[NSArray alloc] initWithObjects:
                            @"user_likes", 
                            @"read_stream",
                            @"publish_actions",
                            nil];
    FBSession *session = [[FBSession alloc] initWithPermissions:permissions];
    [FBSession setActiveSession:session];
    if([FBSession openActiveSessionWithAllowLoginUI:NO]) {
        // post to wall
    } else {
        // you need to log the user
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-08-26T12:29:07.400

如果您使用的 FBSDK 大于 4.x，则没有 FBSession 的概念。您必须仅通过`[FBSDKAccessToken currentAccessToken]`简单地检查它是否具有`nil`价值来找到活动会话，否则没有活动会话。

> 相反，您应该检查`[FBSDKAccessToken currentAccessToken]`或 `viewDidLoad`类似。如果 a`current token`可用，请执行登录后工作。您还可以使用它`currentAccessToken`来检索缓存的令牌。

你可以在这里找到更多[https://developers.facebook.com/docs/ios/upgrading-4.x](https://developers.facebook.com/docs/ios/upgrading-4.x)

> `FBSession.activeSession`已替换为`[FBSDKAccessToken currentAccessToken]`和`FBSDKLoginManager`。没有的概念 `session state`。相反，使用管理器登录，这会设置 `currentAccessToken`参考。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-28T07:26:54.610

我按照 Facebook 示例中的方式进行操作

```
if (FBSession.activeSession.state == FBSessionStateCreatedTokenLoaded)
{

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-28T07:38:49.320

如果状态为 in`FBSessionStateOpen`或 in ，则会话处于活动状态`FBSessionStateOpenTokenExtended`。您可以使用下面的函数来检查用户是否已登录：

```
- (BOOL)isSessionOpen
{
    return FBSession.activeSession.state == FBSessionStateOpen || FBSession.activeSession.state == FBSessionStateOpenTokenExtended;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T18:07:06.833

你是如何打开你的 FBSession 的？

如果您正在创建实例，请务必设置 FBSession.activeSession。那是我一段时间的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-16T11:34:34.907

```
 if ([FBSDKAccessToken currentAccessToken]) 
{
   NSLog(@"Already login");
    //[FBSession openActiveSessionWithAllowLoginUI: YES];
} 
```

# c# - asp 谷歌地图

> ID：12412156
> 
> 赞同：0
> 
> 时间：2012-09-13T18:02:14.323
> 
> 标签：c#, javascript, asp.net, google-maps

我想使用 Google Maps 和 Asp.net 可视化点。

1.  可视化地图
2.  把点放在地图上
3.  追踪路径点

这是我当前的代码。

```
<div id="map_canvas" style="width:80%; height:80%"></div>
<script type="text/javascript">
    function initialize() {
        var latlng = new google.maps.LatLng(46.781367900048, 6.6401992834884);
        var options = { zoom: 14, center: latlng, mapTypeId: google.maps.MapTypeId.ROADMAP };
        var map = new google.maps.Map(document.getElementById("map_canvas"), options);
        var marqueur = new google.maps.Marker(optionsMarqueur);
        marqueur.bindTo(latlng, map, "center");
    }
    $(function () {
        initialize();
    }); 
</script> 
```

但是所以我有没有标记的地图。我想知道如何更改此代码以可视化两点之间的路径。谢谢你。

# c# - 部署 webAPI 服务器端所需的最少文件

> ID：12412163
> 
> 赞同：11
> 
> 时间：2012-09-13T18:02:43.480
> 
> 标签：c#, wcf, service, asp.net-web-api, wcf-web-api

因此，经过大量研究后，我开始使用 webAPI 入口点来增强我们的服务服务器堆栈。基于[这个线程](http://forums.asp.net/t/1772347.aspx/1)，尤其是 Digerati 董事会成员的最后一篇文章，我们正在将 webAPI 服务作为外观实现到我们的 WCF 应用程序层中。（我们的 WCF 服务只是所有行为所在的应用程序层的外观）

我的问题是这个。我下载了 MVC 4 并在我的服务解决方案中创建了一个新的 WebAPI 项目。但是哇，在我的项目中创建了很多我不需要的废话！例如，所有的图像文件、家庭控制器、视图和模型等。

因此，在将其剥离为只是一个服务项目时，我需要构建一个功能性服务项目的最少文件是什么？我们的目的是在同一个服务器中并排发布两种服务类型（WCF 和 webAPI）。每个服务调用都执行相同的服务调用，并为请求返回特定的 DTO。到目前为止，它看起来像 App_Start、Controllers 和 Glabal.asax/web.config 条目。我绝对不需要视图、模型或图像！！！

任何关于其他人为进行纯服务部署所做的工作都将在这里受到欢迎。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-10T08:41:31.303

这里同样的问题。我发现Shawn Kendrot 的**[那篇文章](http://www.visuallylocated.com/post/2012/05/10/Creating-a-minimal-Web-API-web-project.aspx)**解释了如何创建最小的 Web API 项目。它是为 Web API 的 beta 版本编写的，但它似乎仍然有效。

1.  创建一个空的 ASP.NET 项目。
2.  `System.Web.Http`添加对和的引用`System.Web.Http.WebHost`（版本 4.0.0.0）
3.  添加`Global.asax`文件
4.  在`Global.Application_Start`. 就像是：

    ```
    protected void Application_Start(object sender, EventArgs e)
    {
        GlobalConfiguration.Configuration.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional });
    } 
    ```

5.  添加控制器

    ```
    public class SampleController : ApiController
    {
      public string Get(int id)
      {
        return "Hello";
      }
    } 
    ```

    6.  使用 URL 在本地运行项目`/api/sample/123`并享受结果：

![在此处输入图像描述](../Images/563b4528e4e943db1413d38fe7a70d71.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-16T03:14:27.820

供参考。我发现我不得不引用另外两个 .dll：

*   System.Net.Http
*   牛顿软件.Json

# visual-studio-2008 - 由于不可用的 VC8 调试 crt 上的并行错误，调试中的 Visual C++ 2008 (VC9) 项目无法执行

> ID：12412164
> 
> 赞同：0
> 
> 时间：2012-09-13T18:02:46.530
> 
> 标签：visual-studio-2008, visual-studio-2005, msvcrt

我正在使用 Visual Studio 2008 构建一个包含 40 个项目的应用程序。我们还链接了一些第 3 方库，我怀疑这引起了我的头痛。当我构建版本时，它运行良好。当我尝试进行调试构建并在 VS 调试器中运行时，由于熟悉的 sid-by-side 汇编错误，它不会运行。我尝试从安装了 2005 并且可以在调试中运行作为临时修复的系统复制 Debug_NonRedist 的内容，但这不起作用。我想知道哪个库需要 2005 redist crt，但我不知道该怎么做。我尝试在调试可执行文件上使用depends.exe，但它没有提供新信息。如何找出 vc8 调试运行时的依赖项来自何处？谢谢。

约瑟夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:34:41.300

我通过安装 VS 2005 express edition 解决了这个问题，然后安装了在 win7 上运行所需的服务包。

# c# - 从不同表的不同列中检索数据并显示到文本框

> ID：12412166
> 
> 赞同：0
> 
> 时间：2012-09-13T18:02:54.883
> 
> 标签：c#, asp.net, sql

如何从数据库中检索要显示到文本框的数据。就像在我的页面中一样，我有 2 个文本框。我需要从 TempTab 检索 B 列，从 CarTab 检索 C 列，并分别显示到文本框 1 和 2 上。我希望你能帮助我。欢迎举例。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:22:51.700

您可以尝试使用此代码

```
 var connetionString = "..";
    using (var connection = new SqlConnection(connetionString))
    {       

     using(var command = new SqlCommand("SELECT COLUMN1, COLUMN2 FROM YOURTABLE", connection))
     { 
       connection.Open();
       var  dr = cmmand.ExecuteReader();
       if (dr.HasRows == false)
       {
         throw new Exception();
       }
       if (dr.Read())
       {

           textBox1.Text = dr[0].ToString();
           textBox2.Text = dr[1].ToString();
       }

     } 

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:08:52.027

[您可以在此处](http://www.daniweb.com/software-development/csharp/threads/95937/how-to-retrieve-data-and-display-in-textbox-in-c)查看示例

希望它可以帮助你。快乐编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:10:25.573

听起来您需要一些初学者 ADO 帮助。从这里开始：

[http://msdn.microsoft.com/en-us/library/haa3afyz.aspx](http://msdn.microsoft.com/en-us/library/haa3afyz.aspx)

# c# - 如何在不循环的情况下等待布尔值（使用任何类型的等待/信号量/事件/互斥锁等）

> ID：12412167
> 
> 赞同：21
> 
> 时间：2012-09-13T18:02:58.357
> 
> 标签：c#, .net, multithreading, mutex, semaphore

我需要停止一个线程，直到另一个线程设置一个布尔值**并且我不想在它们之间共享一个事件**。

我目前拥有的是使用睡眠的以下代码（这就是我要更改的代码）：

```
while (!_engine.IsReadyToStop())
{
    System.Threading.Thread.Sleep(Properties.Settings.Default.IntervalForCheckingEngine); 
} 
```

有任何想法吗？

**编辑以澄清事情：**

有一个我不拥有的类的 _engine 对象。我无法修改它，这就是为什么我不想在它们之间共享事件。我需要等到该类的方法返回true。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2015-12-11T23:08:27.763

`SpinWait.SpinUntil`是正确的答案，无论您将此代码放在哪里。SpinUntil 提供[了“在调用之间的旋转、屈服和休眠的完美组合”](https://devblogs.microsoft.com/pfxteam/spinwait-spinuntil-for-unit-testing/)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-13T18:05:52.720

如果您正在使用`C# 4.0`，则可以使用：

```
Task t = Task.Factory.StartNew (() => SomeCall(..));
t.Wait(); 
```

通过使用[Task.Wait](http://msdn.microsoft.com/en-us/library/dd235635.aspx)方法。

如果您有多个任务一个接一个地运行，您可以使用[Task.ContinueWith](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.continuewith.aspx)：

```
 Task t = Task.Factory.StartNew (() =>SomeCall(..)).
                                ContinueWith(ExecuteAfterThisTaskFinishes(...);
 t.Wait(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T18:04:56.990

声明为

```
 AutoResetEvent _ReadyToStop = new AutoResetEvent(false); 
```

并用作

```
 _ReadyToStop.WaitOne(); 
```

和

```
 _ReadyToStop.Set(); 
```

有关更多信息，请参阅[.Net 中的同步原语](http://msdn.microsoft.com/en-us/library/ms228964.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-01T13:01:07.023

条件变量是可用于等待条件的同步原语。

它本身并不存在于 .NET 中。但以下[链接](https://github.com/CodeExMachina/ConditionVariable)为根据 SemaphoreSlim、AutoResetEvent 和 Monitor 类实现的条件变量类提供了 100% 的托管代码。它允许线程等待一个条件。并且可以在满足条件时唤醒一个或多个线程。此外，它还支持超时和 CancellationTokens。

要等待一个条件，您编写类似于以下的代码：

```
object queueLock = new object();

ConditionVariable notEmptyCondition = new ConditionVariable();

T Take() {

  lock(queueLock) {

    while(queue.Count == 0) {

      // wait for queue to be not empty
      notEmptyCondition.Wait(queueLock);
    }

    T item = queue.Dequeue();

    if(queue.Count < 100) {

      // notify producer queue not full anymore
      notFullCondition.Pulse();
    }

    return item;
  }
} 
```

然后在另一个线程中，您可以唤醒一个或多个等待条件的线程。

```
lock(queueLock) {

  //..add item here

  notEmptyCondition.Pulse(); // or PulseAll
} 
```

# python - Django 自定义管理员 admin.site.register + admin.site.unregister 在第一次 HTTP GET (Apache + mod WSGI) 上冲突 AlreadyRegistered + NotRegistered

> ID：12412170
> 
> 赞同：2
> 
> 时间：2012-09-13T18:03:04.277
> 
> 标签：python, django, apache, mod-wsgi, wsgi

在第一次 HTTP GET 期间（在重新加载守护程序模式下的 WSGI 之后），admin.site.unregister 抛出 NotRegistered 异常，但 admin.site.register 抛出 AlreadyRegistered 异常（catch-22？）但是，在随后的 HTTP GET 中，一切都加载得很好，没有错误。

设置：

*   姜戈 1.3
*   阿帕奇 2.2
*   中央操作系统

设置.py：

```
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    #'django.contrib.sites', #(this didn't seem to make a difference)
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    'django.contrib.admindocs',
    'base',
    'sample',
    'reports',
    'south',
) 
```

模型.py：

```
from django.db import models
from django.contrib import admin
from django.contrib.auth.models import User
from django.contrib.auth.admin import UserAdmin as AuthUserAdmin

class Company(models.Model):
  name = models.CharField(max_length=256)

class CompanyUser(models.Model):
  company = models.ForeignKey(Company)
  user = models.OneToOneField(User)

class CompanyUserInline(admin.StackedInline):
  model = CompanyUser
  max_num = 1
  can_delete = False

class CompanyUserAdmin(AuthUserAdmin):
  inlines = [ CompanyUserInline ]

# STUCK HERE !!
try:
  admin.site.unregister(User)
  # throws NotRegistered at / The model User is not registered
except:
  admin.site.register(User, CompanyUserAdmin)
  # throws AlreadyRegistered at / The model User is already registered 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T19:10:21.350

我在 freenode 的 #django 上找到了 mlvin 的答案

> 你在你的models.py而不是admin.py中定义它（这很好）但是如果你的代码中有任何地方在那个模型文件上导入*，它将再次执行注册调用

将属于 admin.py 的内容移动到 admin.py（来自 models.py）解决了它！不过，在我的辩护中，我继承了代码库——我不知道为什么我要把这个片段放在 models.py 而不是 admin.py 中。

有趣的是：虽然这个问题从来没有通过“manage.py runserver”在本地出现，但只有当我通过 Apache + WSGI 部署时，另一个人提到他们能够在本地重现它。诡异的。

但案件结案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-04T12:38:40.557

我的问题是：

> 我想用 MyUser(AbstarctUser) 自定义模型（在 model.py 中）和我的 admin.py 文件脚本中编辑用户（例如：添加手机），首先取消注册我的模型 MyUser 然后注册它，但 Django 没有注册我的自定义 MyUser 模型默认，

**所以在我的情况下，不需要先取消注册我的自定义模块，只需注册就足够了。**

# php - 可以找出哪些 MySQL 查询很慢吗？

> ID：12412172
> 
> 赞同：1
> 
> 时间：2012-09-13T18:03:05.527
> 
> 标签：php, mysql, query-optimization

我使用 PHP 函数`mysql_stat()`来获取有关我的 MySQL 数据库的信息。

有一个条目`Slow queries`，在我的例子中是 94（301729 个查询）。是否有包含有关查询的更多信息的日志文件？（时间，执行时间，查询本身，...）？

14 小时前我设置了一个新服务器，内存增加了 4 倍，......但我仍然有 0.031154% 的慢查询，这与以前基本相同，我认为这非常高。我真的很想知道哪些是慢查询，以及如何优化它们。慢查询的可接受比率是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:04:35.157

您可以在 my.cnf 中启用 log-slow-queries。这会将慢速查询写入日志。

```
log_slow_queries = /var/log/mysql/mysql-slow.log 
```

我认为如果用户需要等待，您的查询速度永远不会低于 0.2 秒。在不涉及用户的情况下执行 crons 时，这并不重要。但是如果使用同一个数据库/表，cron的查询会减慢正常查询（锁定/i/o）。

您可以通过设置正确的索引来优化您的数据库，并使用 EXPLAIN 尝试不同的查询。

# objective-c - 重叠子视图的最佳替代方案

> ID：12412177
> 
> 赞同：0
> 
> 时间：2012-09-13T18:03:23.503
> 
> 标签：objective-c, ios, storyboard

我有一个`UIView`包含登录表单，但是当用户已经登录时，我想显示一个注销按钮而不是表单。

我目前的方法是为登录表单和登录按钮创建一个子视图，在 Interface Builder 中相互重叠。

然后我一次只显示一个子视图。

有没有更好的方法来做到这一点，以便在 Interface Builder 中设计更容易，同时仍然使用相同的`UIViewController`？

如果重要，该视图是模态视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:43:54.187

您可以将您`UIViewController`的实际调整为`UITabBarController`，但调整选项卡栏，使其在控制器被推到屏幕时不可见：

`self.hidesBottomBarWhenPushed = YES;`

这应该允许您：

1.  以编程方式轻松地在视图之间切换
2.  在 IB 中轻松管理两个（或更多）单独的 UIViewController 实例，而不会重叠

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:09:30.170

对于视图控制器的可选/模态部分，我过去多次使用的一种方法是为每个部分创建一个视图作为 nib 中的顶级对象。您可以使用界面生成器更轻松地安排每个视图，然后您需要在代码中做的就是有条件地将适当的视图添加到`viewDidLoad`方法中的主视图。请记住，作为 nib 中的顶级对象，它们应该有强大的出口，而不是弱出口。

# coldfusion - 带有负数的 ColdFusion 的 If/Then 语句

> ID：12412187
> 
> 赞同：-4
> 
> 时间：2012-09-13T18:04:17.013
> 
> 标签：coldfusion, if-statement

我正在尝试在我们的网站上创建一个解决方法。我需要说明的是，如果 UPS 的运费 + 我们为每个产品输入的超大尺寸费用小于 1（0 或负数），则运费应为 0。

试图创造一种解决方法来按产品免费送货。

问题是我不知道 ColdFusion。我们的系统在产品级别没有免费送货选项。我测试了在字段中添加负数以对超大物品收取附加费。这有效，除非退回的运费为负数，它会从销售中扣除该金额。示例小部件 10 美元，运费 8.50 美元，超大费用设置为 -10，销售额为 8.50 美元。我需要将负数设置得足够高，以涵盖陆运费用的范围，因此我需要将费用编码为永远不能小于 0。希望这更有意义。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:15:59.200

你可以试试

```
max( 0, (upsCharge + oversizedCharge) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:16:26.863

不知道你在问什么。如何在 ColdFusion 中编写 if 语句？

```
<cfif (UPSCharge + OversizeCharge) GT 0>
    <!--- add shipping charge --->
<cfelse>
    <!--- free shipping --->
</cfif> 
```

# binary - Wireshark包开头识别

> ID：12412188
> 
> 赞同：2
> 
> 时间：2012-09-13T18:04:18.293
> 
> 标签：binary, wireshark, pcap, packet-sniffers, sniffer

我有一个由 Wireshark 创建的“.pcapng”二进制文件。

如何检测其中每个新包的开头？

是否有任何特定的字节序列？

或者，如何检测包的结束？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T21:45:10.020

（我见过母语不是英语的人说“packages”而不是“packets”——这两个词都来自同一个词“pack”，并且同一个词可能用于其他语言中的两个概念——所以我假设您指的是网络数据包；在英语中通常不使用“包”。）

[PCAP Next Generation Dump File Format](http://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html)文档中描述了 pcap-NG 文件格式。pcap-NG 文件是一系列块；每个块在开头都有一个长度字段（在结尾处，以简化*向后*扫描文件）。并非所有块都包含数据包；执行的块是数据包块、扩展数据包块和简单数据包块。

请注意，libpcap 1.1 及更高版本可以读取 pcap-NG 文件，因此任何使用 libpcap 读取捕获文件的程序都可以，如果动态喜欢 libpcap 并在 libpcap 共享库为 1.1 或更高版本的系统上运行，或者与 libpcap 静态链接1.1 或更高版本，可以使用与读取 pcap 文件相同的 API 读取一些 pcap-NG 文件，而无需对程序进行任何更改。（pcap-NG 文件包含多个接口，其中并非所有接口都具有相同的链路层标头类型或快照长度，因为当前的 libpcap API 不支持这一点。）没有基于 libpcap 1.1 的 WinPcap 版本或更高版本，因此 WinPcap 目前不能用于读取 pcap-NG 文件。

另一个可以读取 pcap-NG 文件的库是[NTAR](http://www.winpcap.org/ntar/default.htm)库。但是，它只能读取 pcap-NG 文件，不能读取 pcap 文件。

# android - 动态更改 RotateAnimations 参数

> ID：12412190
> 
> 赞同：0
> 
> 时间：2012-09-13T18:04:24.590
> 
> 标签：android, animation

我已经定义`RotateAnimation`旋转一个`ImageView`. 所以，我想在重复一些之后停止动画。场景如下：

第一个动画从 -25 到 25 度开始，在一个动画之后，这应该变为 -24 到 24 并反向和......当达到 0 到 0 时，这应该被取消。

```
 int intervalSize = -25;

    RotateAnimation r = new RotateAnimation(intervalSize, intervalSize, pivotX, pivotY);
    r.setDuration(3000);
    r.setStartOffset(0);
    r.setRepeatMode(RotateAnimation.REVERSE);
    r.setRepeatCount(RotateAnimation.INFINITE);
    startAnimation(r);
    r.setAnimationListener(new AnimationListener() {

        @Override
        public void onAnimationStart(Animation animation) {

        }

        @Override
        public void onAnimationRepeat(Animation animation) {
            if (intervalSize == 0)
                animation.cancel();
            intervalSize--;
        }

        @Override
        public void onAnimationEnd(Animation animation) {

        }
    }); 
```

任何人都可以请我怎样才能做到这一点？

提前致谢：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:10:11.133

我认为您的问题是，当您在每次动画重复时更改全局变量间隔大小时，正在重复的动画不是查看您的变量，而是当您说时传递给它的原始整数： new RotateAnimation(间隔大小，间隔大小，pivotX，pivotY）；

也就是说，动画将始终具有 -25，因为它是用它构建的，它不关心或知道您的 intervalSize var 的后续更改。

为了实现理想的目标，您可以执行以下操作：

```
 @Override
        public void onAnimationRepeat(Animation animation) {
            if (intervalSize == 0){
                animation.cancel();
            } else {
              ((RotationAnimation)animation).setFromDegress(intervalSize);
              ((RotationAnimation)animation).setToDegress(intervalSize);
            }
        } 
```

但是，可惜的是，RotationAnimation 上的这些属性似乎没有设置方法。因此，您可以使用 onAnimationEndEvent 创建具有新的 intervalSizeValue 的新动画。如：

使用 onAnimationEnd 事件，而不是有一个重复的动画，有一个一次性的动画。一旦结束，onAnimationEnd 事件应该使用新的 intervalSize 构造一个新的 RotationAnimation。

这是一个工作示例，它以您指定的方式从典型的 Android HelloWorld 应用程序中为 textview 设置动画：

```
 package com.example.rotationtest;

import android.os.Bundle;
import android.app.Activity;
import android.view.ViewTreeObserver.OnGlobalLayoutListener;
import android.view.animation.Animation;
import android.view.animation.Animation.AnimationListener;
import android.view.animation.RotateAnimation;
import android.widget.TextView;

public class MainActivity extends Activity {
    private TextView tv;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.activity_main);

        // the textView we will rotate
        tv = (TextView) this.findViewById(R.id.textView1);

        /***
         * we want to have the correct measured size of the view we are going to animate
         * as we want to do a rotation around it's centerpoint.
         * But, we cant get the measured size of a view until Layout has happened...
         * So use a LayoutListener to know when layout is done
         * But, beware that this is often called back on more than once,
         * so remove the listener after it is called first time
         */
        tv.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
            @Override
            public void onGlobalLayout() {
                initAnimation();
                tv.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                // above is deprecated. in API16+ use tv.getViewTreeObserver().removeOnGlobalLayoutListener(this);      
            }
        });
    }

    private int mRotationAbsDegrees = 25;
    private int mCurrentFromDegrees;
    private int mCurrentToDegrees;

    private void initAnimation(){
    mCurrentFromDegrees = -1 * mRotationAbsDegrees;
    mCurrentToDegrees = mRotationAbsDegrees;
    makeNewAnimation();
    }

    private void makeNewAnimation(){
    RotateAnimation r = new RotateAnimation(mCurrentFromDegrees, mCurrentToDegrees,  tv.getMeasuredWidth()/2, tv.getMeasuredHeight()/2);
        r.setDuration(3000); // TODO: might want to reduce the time as we get closer to zero mRotationAbsDegrees
        r.setStartOffset(0);
        //r.setRepeatMode(RotateAnimation.REVERSE);
        //r.setRepeatCount(RotateAnimation.INFINITE);
        tv.startAnimation(r);
        r.setAnimationListener(new AnimationListener() {

            @Override public void onAnimationStart(Animation animation) {}

            @Override public void onAnimationRepeat(Animation animation) {}

            @Override
            public void onAnimationEnd(Animation animation) {
            // if we have run down the mRotationAbsDegrees to zero, stop animating
            if (mRotationAbsDegrees <= 0){
                return;
            }
            if (mCurrentFromDegrees < 0){
                // reverse the from to
                mCurrentFromDegrees = -1*mCurrentFromDegrees;
                mCurrentToDegrees  = -1*mCurrentToDegrees;
            } else {
                // reduce the mRotationAbsDegrees
                mRotationAbsDegrees--;
                mCurrentFromDegrees = -1 * mRotationAbsDegrees;
                mCurrentToDegrees = mRotationAbsDegrees;
            }
            makeNewAnimation();
            }
        });
    }
} 
```

# java - Ant、Ivy 和 Artifactory 如何使用设置文件

> ID：12412192
> 
> 赞同：2
> 
> 时间：2012-09-13T18:04:27.977
> 
> 标签：java, ant, ivy, artifactory

> **可能重复：**
> [您将 ivysettings.xml 放在哪里？](https://stackoverflow.com/questions/1195393/where-do-you-put-ivysettings-xml)

我已将 Artifactory 设置为在我的机器上本地运行：

```
http://localhost:8080/artifactory/myRepo 
```

该仓库目前只有 1 个依赖项为我管理，Google Guice (3.0)：

```
myRepo/
    google/
        guice/
            3.0/
                guice-3.0/
                    guice-3.0.jar
                    guive-3.0-ivy.xml 
```

我现在已经配置了我的 Ant 构建以预先启动 Ivy 解析：

```
<project name="myapp-build default="audit" basedir=".." xmlns:ivy="antlib:org.apache.ivy.ant">
    <path id="ant.lib.path">
        <fileset dir="${env.ANT_HOME}/lib" includes="*.jar"/>
    </path>

    <!-- I have ivy.jar and its dependencies installed under ${ANT_HOME}lib. -->
    <taskdef resource="org/apache/ivy/ant/antlib.xml" uri="antlib:org.apache.ivy.ant" classpathref="ant.lib.path"/>
    <target name="resolve">
        <!-- Initialize Ivy and connect to host repository. -->
        <echo message="Initializing Apache Ivy and connecting to the host repository."/>
        <ivy:settings url="${ivy.std.repo.settings.url}" realm="${ivy.std.repo.realm}"
username="${ivy.std.repo.username}" passwd="${ivy.std.repo.password}"/>

        <!-- Clear/flush the Ivy cache. -->
        <echo message="Cleaning the local Ivy cache for the current build."/>
        <ivy:cleancache/>

        <!-- Resolve ivy.xml against the standard repository (all configurations) -->
        <echo message="Resolving ivy.xml dependencies against the host repository."/>
        <ivy:resolve file="./ivy.xml"/>

        <!-- Retrieve compile dependencies from local Ivy cache and place them into the gen/lib/main. -->
        <echo message="Retrieving compile-time dependencies."/>
        <ivy:retrieve ivypattern="${gen.lib.main.dir}/[artifact].[ext]" conf="compile"/>

        <!-- Retrieve test dependencies from local Ivy cache and place them into the gen/lib/test. -->
        <echo message="Retrieving testing dependencies."/>
        <ivy:retrieve ivypattern="${gen.lib.test.dir}/[artifact].[ext]" conf="test"/>
    </target>

...

</project> 
```

我还`ivy.xml`为我的模块编写了一个描述符。

我正在努力解决的是`ivysettings.xml`文件，特别是：

*   我应该把它放在哪里（在我的文件系统上），还是 Artifactory 以某种方式“上传”它？如果是这样，在哪里/如何？
*   用户名/密码（在`<ivy:settings>`任务中提供）用于基本 HTTP 身份验证，我*假设*Artifactory 重用这些凭据？

基本上，我需要知道将设置文件放在哪里，以及其中定义的所有登录 URL/凭据如何`<ivy:settings>`与我的 Artifactory 配置相关联。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T06:59:33.187

这部分重复了[您将 ivysettings.xml 放在哪里？](https://stackoverflow.com/questions/1195393/where-do-you-put-ivysettings-xml) 关于身份验证 - Artifactory 默认方案适用于基本 HTTP 身份验证。

# windows - Linux 服务器中的 TCP 窗口缩放 - 可能的副作用

> ID：12412193
> 
> 赞同：2
> 
> 时间：2012-09-13T18:04:30.757
> 
> 标签：windows, linux, networking, tcp

这里说——

[http://en.wikipedia.org/wiki/TCP_window_scale_option#Linux](http://en.wikipedia.org/wiki/TCP_window_scale_option#Linux)

“由于许多路由器和防火墙没有正确实施 TCP 窗口缩放，它可能会导致用户的 Internet 连接间歇性故障几分钟，然后似乎无缘无故地重新开始工作。

如果防火墙不支持 TCP 扩展，也会出现问题。”

据我了解，当许多短连接（网络）时， **TCP Window Scalling**对通道性能的不良影响。

在 Linux 服务器上禁用**TCP 窗口缩放，或者不？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T10:30:32.373

在我看来，您引用的维基百科文章大大夸大了这个案例。它链接到的 Microsoft 知识库文章仅引用了 5 台存在此问题的设备。那不是“很多”。

而且您需要考虑到问题是由 Windows Vista 默认设置为 8 的巨大窗口比例引起的，足以描述 64k << 8 = 16MB 的窗口，这是一个大得离谱的数字。Linux 可能会也可能不会触发它：目前您对此的证据为零。

TCP 窗口缩放不会导致“许多短连接的性能不佳”。它在长寿命连接上产生*了非常好的性能。*

我会更多地依赖 RFC 和供应商声明，而不是任意的 Web 资源；甚至维基百科。我在本月的一篇 TCP 文章中纠正了一个重大错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T09:57:50.283

1）所有 TCP 扩展，包括 SACK、ECN 等，都在客户端和服务器套接字内的 3-WAY-Handshake 进程之间协商，如果其中一个不支持任何所述扩展，那么另一个对等方在该 TCP 的生命周期内忽略那些 TCP 扩展会议。因此，如果您的防火墙或路由器不支持这些扩展，则没有问题。

2) 厂商根据 AIMD 原则实现窗口缩放是一般做法。最好将窗口缩放保留为默认启用。

# php - 在 PHP 中扩展包含的文件

> ID：12412195
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:04:32.673
> 
> 标签：php, oauth-2.0, notepad++

我正在尝试运行 PHP 脚本并在第 162、197 行等处出错，而页面只有 60 行。我在母版页中包含了 5 个其他页面。已使用 require_once 来包含它们。有没有办法可以扩展它们并查看问题出在哪里？

我使用 Notepad++ 来编辑我的代码。

问候， Himanshu Joshi

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:09:56.303

简单的修复。您需要更加注意 PHP 错误消息。

***它说什么文件***的第 162 和 197 行？

 *如果您只看到数字 162 和 197，那么*somefile*（在第 162 行）在*theotherfile*的第 197 行调用/加载一些其他代码。*

# haskell - 数据类型和任意，加在一起？

> ID：12412198
> 
> 赞同：3
> 
> 时间：2012-09-13T18:04:45.997
> 
> 标签：haskell

首先这是家庭作业，所以请不要放弃太多！我需要理解这一点，而不是复制别人的代码。

我必须创建一副牌。而且我已经获得了可以使用的代码，但我无法让它们工作。我的意思是我可以在 2012-2013 年的演出中创造出最好的牌组，但这对我没有帮助，因为我需要使用我们提供的代码，而且我不能更改它。

（我使用 Read 和 Enum 来创建一副纸牌，看起来很棒，但我不能完成这个任务）

最后我收到一些错误消息，你可以看到。

```
 import Test.QuickCheck

    --DECK OF CARDS

    data Suit = Hearts | Spades | Diamonds | Clubs
       deriving (Eq, Show)

    data Card = Card Rank Suit
        deriving (Eq, Show)

    data Rank = Numeric Integer | Jack | Queen | King | Ace
        deriving (Eq, Show)

    instance Arbitrary Rank where
    arbitrary = frequency [ (1, return Jack)
                    , (1, return Queen)
                    , (1, return King)
                    , (1, return Ace)
                    , (9, do n <- choose (2, 10)
                             return (Numeric n))

                    ]

     --MY OWN CODE

     type Deck = [Card]
     deck :: Deck
     deck = [Card v s | v <- arbitrary Rank, s <- Suit] 
```

当我尝试加载它时，我得到：

```
 Prelude> :l test4
   [1 of 1] Compiling Main             ( test4.hs, interpreted )

   test4.hs:31:35: Not in scope: data constructor `Rank'

   test4.hs:31:46: Not in scope: data constructor `Suit'
   Failed, modules loaded: none. 
```

我哪里错了？我错过了一些基本的东西吗？如果是这样，我在哪里阅读它？

我将不胜感激任何和所有的建议和想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:23:15.330

我会指出您的代码存在几个问题：

*   的类型`arbitrary`是`arbitrary :: Arbitrary a => Gen a`。所以你需要一些东西来运行这个生成器来获取随机列表。

*   `Rank`并且`Suit`是类型而不是一些值。此外，您还需要显式指定类型`arbitrary`以获取该类型的生成器。like`arbitrary :: (Gen Rank)`然后使用类似`sample'`或其他函数运行以实际获得随机排名。

*   同样，您需要为 和 定义任意`Card`实例。然后你可以通过只类型转换来生成`Suit``Deck``Deck``arbitrary``Gen Deck`

*   更多的是逻辑缺陷。您的任意实例将无法保证限制，例如一副牌中应该有 4 个国王等。因此，在为您定义任意实例时，`Deck`应该注意这一点。

*   `Test.QuickCheck`定义`arbitrary`实例时参考函数的类型。只需查看类型，您就会得到大部分正确的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:32:01.097

看起来你确实有一个基本的误解：在你的列表理解中，你试图使用`Rank`和`Suit`喜欢列表，但它们不是——它们是类型名称。如果你想遍历一组西装，你需要自己做一个。

在表达式中，大写的标识符应该是数据构造函数（因为类型在该上下文中没有任何意义）。编译器错误在这里并不是特别有用——它在数据构造函数命名空间中查找，但没有找到它们`Rank`。`Suit`

# asp.net - 想要在 Handler 中不显示图像

> ID：12412201
> 
> 赞同：0
> 
> 时间：2012-09-13T18:05:20.953
> 
> 标签：asp.net, handler

我正在尝试通过处理程序在网格视图中显示图像。但是当数据库中没有路径时，它会显示脏的无图像徽标。我需要在没有图像的地方显示“NOImage”图像。

```
 <asp:TemplateField HeaderText="Path_Image">
                            <ItemTemplate>
                                <asp:Image ID="Image1" runat="server" ImageUrl='<%# "LargeImage.ashx?p=" + Eval("Name") + "&q=" + Eval("Vertual_Path") %>' />
                            </ItemTemplate>
</asp:TemplateField> 
```

///大图像.ashx..

```
using System;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.IO;
using System.Text.RegularExpressions;
using System.Web;

public class LargeImage : IHttpHandler
{
    private Regex _nameValidationExpression = new Regex(@"[^\w/]");
    private int _thumbnailSize = 250;

    public void ProcessRequest(HttpContext context)
    {
        string photoName = context.Request.QueryString["p"];
        string P_Path = context.Request.QueryString["Q"];
        if (photoName == "" )
        {
            //file = (byte[])reader["Image"];
           // FileStream fs = File.OpenRead(HttpContext.Current.Server.MapPath("~/Article/NoImage.png"));
            //File = new byte[fs.Length];
            //fs.Read(File, 0, File.Length);
            context.Server.MapPath("~/Article/NoImage.jpg");
        }
        else
        {
            if (_nameValidationExpression.IsMatch(photoName))
            {

                throw new HttpException(404, "Invalid photo name.");
            }
            string cachePath = Path.Combine(HttpRuntime.CodegenDir, photoName + ".Large.png");
            if (File.Exists(cachePath))
            {
                OutputCacheResponse(context, File.GetLastWriteTime(cachePath));
                context.Response.WriteFile(cachePath);
                return;
            }
            else
            {

            }
            //string photoPath = context.Server.MapPath("~/Photo/" + photoName + ".jpg");
            // string photoPath = context.Server.MapPath("~/Photo/" + photoName + ".jpg");
            string photoPath = context.Server.MapPath(P_Path + "\\" + photoName + ".jpg");

            Bitmap photo;
            try
            {
                photo = new Bitmap(photoPath);
            }
            catch (ArgumentException)
            {

                throw new HttpException(404, "Photo not found.");
            }
            context.Response.ContentType = "image/pjpeg";
            int width, height;

            if (photo.Width > photo.Height)
            {
                width = _thumbnailSize;
                height = photo.Height * _thumbnailSize / photo.Width;
            }
            else
            {
                width = photo.Width * _thumbnailSize / photo.Height;
                height = _thumbnailSize;
            }
            Bitmap target = new Bitmap(width, height);
            using (Graphics graphics = Graphics.FromImage(target))
            {
                graphics.CompositingQuality = CompositingQuality.HighSpeed;
                graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
                graphics.CompositingMode = CompositingMode.SourceCopy;
                graphics.DrawImage(photo, 0, 0, width, height);
                using (MemoryStream memoryStream = new MemoryStream())
                {

                    //context.Response.AddHeader("Content-Disposition", "attachment; filename=\"" + photoName  + "\"");
                    context.Response.AddHeader("Content-Disposition", "attachment; filename=\"" + DateTime.UtcNow.ToString() + "\"");
                    target.Save(memoryStream, ImageFormat.Jpeg);
                   // OutputCacheResponse(context, File.GetLastWriteTime(photoPath));
                    // OutputCacheResponse(context, File.GetLastWriteTime(photoPath));
                    using (FileStream diskCacheStream = new FileStream(cachePath, FileMode.CreateNew))
                    {
                        memoryStream.WriteTo(diskCacheStream);
                    }
                    memoryStream.WriteTo(context.Response.OutputStream);
                    context.Response.Flush();
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:09:56.947

在 LargeImage.ashx 页面中，如果没有要呈现的记录/图像，请重定向到您本地拥有的静态图像（例如在您的图像文件夹中）。

这样，您就不会依赖浏览器特定的“损坏”图像。

例如

```
 Response.ContentType = "image/jpeg"  
 Try
    photo = GetPhoto(param)
      IF photo is Nothing then
            Response.Redirect("images/unknown.jpg", True)
      Else  
          Response.Binarywrite(photo)
      End if 
  Catch
            Response.Redirect("images/unknown.gif", True)
  Finally
      photo.Dispose() 
  End Try 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:17:12.863

在阅读您的代码时，您的问题似乎是您抛出的 HttpException(404, "Invalid photo name.") 。

浏览器会将其解释为损坏的图像。

用重定向到已知的本地图像替换那些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:12:34.207

您可以尝试使用此代码 - 基于 ProcessRequest

```
public class ImageHandler : IHttpHandler 
{
 public void ProcessRequest(System.Web.HttpContext ctx) 
 {
      if(condition) // Adjust your condition
      {     
         var path = ctx.Server.MapPath("~/images/NoImage.gif");
         var contentType = "image/gif";
         ctx.Response.ContentType = contentType;
         ctx.Response.WriteFile (path);
      }

}

public bool IsReusable { get {return true; } }        

} 
```

# character-encoding - 使用 Orbeon 为查询字符串指定字符编码

> ID：12412202
> 
> 赞同：2
> 
> 时间：2012-09-13T18:05:22.063
> 
> 标签：character-encoding, url-encoding, orbeon, xforms

我们在读取 UTF-8 查询字符串时遇到字符编码问题。一个单独的外部应用程序是构建到我们的 Orbeon 应用程序的链接，例如：

*   `http://localhost:8080/ops/encoding-test/?message=hello%20world`
*   `http://localhost:8080/ops/encoding-test/?message=it%E2%80%99s%20a%20message`

[我们应用程序的模型使用oxf:request](http://wiki.orbeon.com/forms/doc/developer-guide/processors-request-generator)处理器读取查询字符串，然后在视图中显示该字符串。在上面的第一种情况下，应用程序正确显示“hello world”而没有问题。在第二个测试用例中，`%E2%80%99`是 UTF-8 撇号的 URL 编码，并导致应用程序出错：

```
2012-09-13 12:21:43,383 ERROR XSLTTransformer  - Error at line 174 of oxf:/config/theme-examples.xsl:
Illegal HTML character: decimal 128
2012-09-13 12:21:43,384 ERROR ProcessorService  - Exception at line 174 of oxf:/config/theme-examples.xsl
; SystemID: oxf:/config/theme-examples.xsl; Line#: 174; Column#: -1
org.orbeon.saxon.trans.XPathException: Illegal HTML character: decimal 128 
```

*   完整的日志输出：[https ://gist.github.com/3716033](https://gist.github.com/3716033)
*   应用程序测试用例来源：[https](https://gist.github.com/3716159) ://gist.github.com/3716159 - 针对 orbeon-3.9.1.201202031753-PE 编写和测试

该错误引用`%80`了撇号的多字节编码的第二个字节。请注意，在日志中不仅主题会引发异常，而且 xforms 检查器也会引发异常。

看起来 URL 被解码为 Latin1 而不是 UTF-8，因为调试处理器列出`it???s a message`了三个字符作为撇号。到目前为止，在我的研究中，HTTP 似乎没有办法指定查询字符串本身的编码。

1.  使用 oxf:request 读取时，有没有办法指定查询字符串的编码？我没有看到处理器的配置属性或 properties-local.xml 中设置默认值的任何相关内容。
2.  如果没有，有没有办法强制字符串的相关编码？我怀疑这可以通过 XSLT 完成，但找不到示例。我相信我想要与​​ ruby​​ 的[String#force_encoding](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-force_encoding)等效的东西。
3.  如果没有，是否有任何其他建议的方法来解决该错误？我目前最坏情况的 hack-fix 是在它到达 servlet 之前使用 mod_rewrite 去除任何有问题的字符。

任何指导和帮助表示赞赏！

（交叉发布到[http://mail-archive.ow2.org/ops-users/2012-09/msg00033.html](http://mail-archive.ow2.org/ops-users/2012-09/msg00033.html)的 ops-users 邮件列表）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T03:00:28.927

Orbeon Forms 依赖于 servlet API 返回的内容：[`getParameterMap()`参见`ServletExternalContext`](https://github.com/orbeon/orbeon-forms/blob/master/src/java/org/orbeon/oxf/servlet/ServletExternalContext.java). 所以这似乎是您需要在应用程序服务器级别设置的东西；如果使用 Tomcat ，您可以通过[添加`URIEncoding="UTF-8"`.`<Connector>`](https://stackoverflow.com/questions/3278900/httpservletrequest-setcharacterencoding-seems-to-do-nothing)

# delphi - 转换接口时运算符不适用于此操作数类型

> ID：12412203
> 
> 赞同：1
> 
> 时间：2012-09-13T18:05:26.310
> 
> 标签：delphi, delphi-xe2

在过去的几天里，我一直在 Delphi XE2 中使用 3rd 方服务，并且即将完成。我遇到了一个绝对难倒我的问题，我认为应该有非常明显的答案。我希望另一双眼睛能告诉我我的问题是什么。

我有这个界面：

```
IWorshipTeamEvent = Interface(IInterface)
  function GetId : integer;
  function GetName : string;
  function GetTeamId : integer;
  function GetStartDate : TDate;
  function GetEndDate : TDate;
  function GetStartTime : TTime;
  function GetEndTime : TTime;
  function GetSets : IWorshipTeamSetList;

  property Id : integer read GetId;
  property Name : string read GetName;
  property TeamId : integer read GetTeamId;
  property StartDate : TDate read GetStartDate;
  property EndDate : TDate read GetEndDate;
  property StartTime : TTime read GetStartTime;
  property EndTime : TTime read GetEndTime;
  property Sets : IWorshipTeamSetList read GetSets;
end; 
```

然后在同一个单元的另一个类中，我试图`IWorshipTeamEvent`在这个函数中返回一个：

```
function TWorshipTeamEventList.GetEvent(index: Integer) : IWorshipTeamEvent;
begin
  //fEvents is a TInterfaceList that contains only IWorshipTeamEvents
  Result := fEvents[index] as IWorshipTeamEvent;
end; 
```

此时，我得到了编译器错误`Operator not applicable to this operand type`。我已经尝试了一些东西，比如创建一个类型为的`temp`变量`IXmlResponseType`

```
temp := fEvents[index] as IXmlResponseType;
Result := nil; 
```

已编译，所以我尝试`temp`使用一种类型进行`IWorshipTeamEvent`创建

```
temp := fEvents[index] as IWorshipTeamEvent;
Result := nil; 
```

没有编译。

非常感谢任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:13:34.413

我在另一个问题上阅读[了这个](https://stackoverflow.com/a/5422146/1224272)答案，该问题指出缺少 GUID。为我的界面生成 GUID 后`IWorshipTeamEvent`，一切都按预期编译和工作。

# c# - 如果另一个线程正在执行该方法，则退出该方法

> ID：12412204
> 
> 赞同：14
> 
> 时间：2012-09-13T18:05:31.520
> 
> 标签：c#, thread-safety

我在多线程应用程序中有一个方法，我希望在调用此方法时出现以下行为：

1.  如果当前没有其他线程正在执行该方法，则执行它。
2.  如果另一个线程当前正在执行该方法，则退出该方法而不执行它。

C# 中的`lock`语句对于等待线程完成执行很有用，但我不想序列化对此方法的访问，而是在另一个线程执行时绕过执行所述方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T18:14:06.047

您可以使用 Monitor.TryEnter 执行此操作，但可能更简单：互锁：

```
int executing; // make this static if you want this one-caller-only to
               // all objects instead of a single object
void Foo() {
    bool won = false;
    try {
        won = Interlocked.CompareExchange(ref executing, 1, 0) == 0;
        if(won) {
           // your code here
        }
    } finally {
        if(won) Interlocked.Exchange(ref executing, 0);
    }

} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-13T18:09:19.473

我想我不明白......如果一次只能由一个线程调用，为什么要多个线程调用它？

无论如何，您可以使用[Monitor.TryEnter()](http://msdn.microsoft.com/en-us/library/4tssbxcw.aspx)。`false`如果获取锁失败，它不会阻塞并返回。在这种情况下，您可以从函数中返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:08:50.207

在其他地方创建布尔变量，在启动方法时设置为真，在方法退出时设置为假，在运行方法之前检查变量是否为假然后运行否则退出方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:25:14.233

这是一个用于此目的的辅助方法：

```
static class Throttle
{
    public static void RunExclusive(ref int isRunning, Action action)
    {
        if (isRunning > 0) return;

        bool locked = false;
        try
        {
            try { }
            finally
            {
                locked = Interlocked.CompareExchange(ref isRunning, 1, 0) == 0;
            }

            if (locked) action();
        }
        finally 
        { 
            if (locked) 
                Interlocked.Exchange(ref isRunning, 0); 
        }
    }
} 
```

并像这样使用它：

```
private int _isTuning = 0;
private void Tune() { ... }

...

Throttle.RunExclusive(ref _isTuning, Tune); 
```

# javascript - Javascript如何找到滚动事件的来源

> ID：12412213
> 
> 赞同：13
> 
> 时间：2012-09-13T18:06:03.947
> 
> 标签：javascript, jquery, events, scroll

我有一个有趣的错误发生，我不知道如何调试它。每次在我的网站上加载页面时，都会触发滚动事件。页面没有明显移动，我当然没有通过鼠标或键盘触发滚动。我知道滚动事件正在触发，因为我输入了一行代码

```
$(window).bind('scroll', function (e) {console.log(e)}); 
```

果然在每个页面上我都会在控制台日志中收到一点“jQuery.Event”消息。当我断点它时，我的调用堆栈以 jQuery.even.dispatch.apply(eventHandle.elem, arguments) 结束，这并没有给我很多工作。

这是问题。如何找出触发此滚动事件的原因？jquery 事件对象中是否有一个属性可以告诉我滚动是由用户触发还是由脚本触发？在这种情况下，你会怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-17T21:22:27.677

好吧，看起来 jQuery 将所有事件绑定数据隐藏在一个隐藏的属性中。[这篇文章](https://stackoverflow.com/a/2518441/1558430)描述了让你至少知道正在运行什么的方法——找出处理程序在哪个文件中的位置仍然是你的责任。

在涉及事件的情况下`scroll`：

```
var scrollHandlers = jQuery._data(window, 'events')['scroll'];
for (var i = 0; i < scrollHandlers.length; i++) {
    console.error(scrollHandlers[i].handler);  // or console.debug, whatever proves they exist
} 
```

# asp.net-mvc-3 - MVC ELMAH v/s Application_Error

> ID：12412214
> 
> 赞同：2
> 
> 时间：2012-09-13T18:06:20.943
> 
> 标签：asp.net-mvc-3, exception-handling, elmah, error-logging, application-error

**背景**

我在我的 MVC Web 应用程序中设置了[[HandleError]](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)用于异常处理，但后来它无法处理一些异常，所以我被建议继续使用替代[**Application_Error**](http://prideparrot.com/blog/archive/2012/5/exception_handling_in_asp_net_mvc)（[我的 SO Post](https://stackoverflow.com/questions/12183653)）我也最终使用了[**ELMAH**](http://code.google.com/p/elmah/)，这似乎更好。

好吧，ELMAH 摇滚！但我无法找到如何显示格式化异常（就像我对 Application_Error 所做的那样）

## **ELMAH v/s Application_Error**

**ELMAH** - 提供（几乎）开箱即用的异常日志记录和其他功能，如电子邮件。它完全依赖于 web.config 和它需要的一堆文件。能够在 xml / 数据库（如配置）中记录异常，并且能够发送电子邮件、rss 等。提供一个页面，用户可以在其中查看完整的异常日志并深入了解详细信息。

> **优点：**出错时不显示格式化异常。使 web.config 有点笨重。ELMAH 文件集为 2.8mb（超过我的整个 Web 应用程序 zip 大小的两倍）。无法格式化错误/电子邮件。它依赖于 System.Data.SQLite.dll，它依赖于 CPU 架构（x64 或 x86）所以[发布](https://stackoverflow.com/questions/1278929)

**Application_Error** - 捕获所有异常，我们能够导航用户以显示格式化错误。我们控制显示和通过电子邮件发送的内容。完全托管的代码（不依赖 CPU）没有额外的 web.config 设置。没有额外的dll。

> **优点：**没有隐式异常日志记录（我们需要编码）。没有像 ELMAH 这样的日志查看器。电子邮件、日志记录 - 我们必须管理所有内容。

结论：首先，请告诉我 ELMAH 是否可以“完全”替换我的 Application_Error。此外，我没有找到太多关于如何配置使用 ELMAH 显示/通过电子邮件发送的错误消息。还是它们必须**共存** *（Application_Error 显示格式化错误，ELMAH 显示几乎所有其他内容）*

请提出建议并分享您的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:21:28.007

我可以使用 ELMAH（除了向用户显示格式化的异常详细信息 - 或者至少我没有找到任何相关信息）

我想知道我的帖子中缺少什么来吸引 SO 观众。Atif 本人回答了我的主题 - 更快，更简单！

> [https://groups.google.com/forum/?fromgroups=#!topic/elmah/Md9DslGgwNo](https://groups.google.com/forum/?fromgroups=#!topic/elmah/Md9DslGgwNo)

# javascript - 修改本地存储？

> ID：12412217
> 
> 赞同：7
> 
> 时间：2012-09-13T18:06:45.137
> 
> 标签：javascript, local-storage

我正在使用 simplecartjs 为在线商店提供动力。它将数据存储在本地存储中，如下所示：

```
{"SCI-1":{"quantity":1,"id":"SCI-1","price":20,"name":"Mattamusta -teippi","size":"Tyhjä"},"SCI-3":{"quantity":1,"id":"SCI-3","price":19,"name":"Mohawk .vaimennusmatto 48 x 39cm"},"SCI-5":{"quantity":2,"id":"SCI-5","price":8,"name":"Car Speaker -hajuste","color":"Green Tea"},"SCI-7":{"quantity":1,"id":"SCI-7","price":50,"name":"Asennuspaketti"},"SCI-9":{"quantity":1,"id":"SCI-9","price":30,"name":"Quartz-kalvot","color":"Yellow","size":"50cm x 30cm"},"SCI-11":{"quantity":1,"id":"SCI-11","price":30,"name":"Quartz-kalvot","color":"True Blue","size":"50cm x 30cm"}} 
```

我想在它关闭**之前添加这条线。**

```
"SCI-12":{"quantity":1,"id":"SCI-12","price":5,"name":"Toimituskulut"} 
```

但是，产品的数量将取决于用户，因此**SCI-12**必须随着项目的数量而增长。

**编辑**实际上，它不必使用**SCI-1**，它可以是任何东西，只要它在项目之后。

**EDIT2** 这就是我正在尝试的......但没有运气。

```
$("#matkahuolto").click(function(){
    var value_object = '"Toimituskulut":{"quantity":1,"id":"Toimituskulut","price":5,"name":"Toimituskulut"}';
    var json_object = JSON.parse(localStorage.your_json); // convert string to object

    json_object["simpleCart_items"] = value_object; // add value

    localStorage.your_json = JSON.stringify(json_object);  // store it again.

    });

    $("#posti").click(function(){
    var json_object = JSON.parse(localStorage.your_json); // convert string to object

    json_object["simpleCart_items"] = value_object; // add value

    localStorage.your_json = JSON.stringify(json_object);  // store it again.

    }); 
```

**EDIT3 本地存储**的屏幕截图。 ![本地存储](../Images/3e7cee875b5cc068feb7da9c2adce3bb.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T20:33:07.550

您需要了解的第一件事是项目如何存储在[localStorage](http://hacks.mozilla.org/2009/06/localstorage/)中，这基本上就像一个哈希图/字典，因为项目存储在键值对中。

例如，要存储 a`string` `localStorage`你会做类似的事情

```
localStorage["myKey"] = "some value"; 
```

要检索值，您只需反转

```
var myValue = localStorage["myKey"]; 
```

接下来要意识到的是，您实际上*只能*将字符串存储在 localStorage 中，因此如果要存储对象，您需要首先将其转换为字符串表示形式。这通常通过将对象转换为[JSON](http://www.json.org/)来完成，JSON是一种紧凑的符号，用于将对象表示为字符串。要将对象转换为 JSON，您只需使用该`JSON.stringify`方法，并解析项目您使用该`JSON.parse`方法

例如将对象转换为 JSON

```
var someObject = {id: 1, name: 'Test'};

var jsonSomeObject = JSON.stringify(someObject); 
// jsonSomeObject looks like "{"id":1,"name":"test"}" 
```

并从 JSON 中读取对象

```
someObject = JSON.parse(jsonSomeObject); 
```

所以现在在你的情况下假设你的对象包含适当的数据，你需要做的就是`stringify`你的对象并`localStorage`使用一些键将它添加到，

```
var jsonData = JSON.stringify({"SCI-12":{"quantity":1,"id":"SCI-12","price":5,"name":"Toimituskulut"}});

localStorage["aKey"] = jsonData; 
```

以及当您以后想要访问这些数据时（大概是在返回页面之后）

```
var mySCI = JSON.parse(localStorage["aKey"]) 
```

如果您尝试更新 localStorage 中的特定条目，那么您只需将其读入然后覆盖它，例如

```
var mySCI = JSON.parse(localStorage["aKey"]);
mySCI.SCI-12.quantity = 2;
localStorage["aKey"] = JSON.stringify(mySCI); 
```

请记住，虽然大多数浏览器都内置了对 JSON 的支持，但一些较旧的浏览器不支持，如果这是一个问题，您可以包含 Douglass Crockfords [JSON-js](https://github.com/douglascrockford/JSON-js)脚本来提供支持。

**编辑：**

根据您刚刚发布的屏幕截图，您可以看到在 localStorage 中存储值的键实际上是 simpleCart_items （而不是您的代码中使用的 your_json ），并且正在存储的对象有一个存储的对象在“SCI-1”键下）（可能还有“SCI's”下的其他键）。所以你需要做的是如下所示

```
 $("#matkahuolto").click(function(){
    var value_object = {quantity: 1, id: 1, name: "someName"} ; 
    var jsonObject = JSON.parse(localStorage["simpleCart_items"]);
    json_object["SCI_1"] = value_object; // add value

 localStorage["simpleCart_items"] = JSON.stringify(json_object);  // store it again.

});

$("#posti").click(function(){
 // convert string to object
 var json_object = JSON.parse(localStorage["simpleCart_items"]); 

json_object["SCI-1"] = value_object; // add value

 localStorage["simpleCart_items"] = JSON.stringify(json_object);  // store it again.

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:17:53.643

LocalStorage 将所有数据存储为文本字符串。因此，在将其转换为文本字符串之前对其进行修改是最容易的。

否则，您需要将 json 字符串拉入对象，添加属性，将其转换回字符串并存储。

**示例代码**

```
var json_object = JSON.parse(localStorage.your_json); // convert string to object
json_object[key] = value_object; // add value
localStorage.your_json = JSON.stringify(json_object);  // store it again. 
```

**笔记**

这就是 indexedDB 的用途。
人们可能想将其视为替代品。

# windows-7 - 用户成功退出特定应用程序时注销

> ID：12412223
> 
> 赞同：1
> 
> 时间：2012-09-13T18:06:57.787
> 
> 标签：windows-7

当他成功退出特定应用程序时，我想从其 Windows 会话中注销用户。
让我们来看以下用例：
1\. John Doe 登录到其 Windows 会话
2\. 他打开 Windows 写字板文本编辑器（“特定应用程序”的示例）并添加一些文本
3\. 他保存并成功退出应用程序
4\. John Doe 自动从其 Windows 会话中注销

我想找到使用 Windows 标准机制的解决方案。
我已经尝试使用本地组策略、事件查看器和任务计划程序的组合找到解决方案。但是，我无法触发**特定应用程序**的事件。

这是我的（不成功的）尝试：

*本地组策略*
1\. 打开**本地计算机策略 > Windows 设置 > 安全设置 > 本地策略 > 审核策略**节点
2\. 打开**审核过程跟踪**属性策略
3\. 选中**成功**复选框并单击**确定**以验证
4\. 执行**GPUpdate /Force**以应用新策略

*事件查看器*
1\. 启动写字板并成功退出（正如 John Doe 所做的那样）
2.在 Windows 事件查看器中**查看事件查看器 > Windows 日志 > 安全**日志
3\. 找到事件后，右键单击它并选择**将任务附加到此事件...**
4\. 到达**操作**向导页面，选择**启动程序**选项并单击**下一步**
5\. 使用以下选项填写字段**程序/脚本：关闭**和**添加参数（可选）：/ l /f /t 10**

主要问题是**Event ID: 4689** for a successful **Process Termination**适用于所有成功退出的应用程序，而不仅仅是我的 WordPad 进程！

是否可以仅在写字板终止过程上触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-30T10:42:28.270

对于“将任务附加到此事件”，答案是否定的。但是，您可以通过登录脚本或注册表在登录时运行以下脚本。

```
strComputer = "."

Set objWMIService = GetObject("winmgmts:{(Security)}\\" & _
        strComputer & "\root\cimv2")

Set colEvents = objWMIService.ExecNotificationQuery _    
    ("Select * From __InstanceDeletionEvent WITHIN 1 Where " _
        & "TargetInstance isa 'Win32_Process'")

Do
    Set objEvent = colEvents.NextEvent.TargetInstance
    cmdLine = objEvent.CommandLine
    if InStr(LCase(cmdLine), "wordpad.exe")  then
       wscript.Echo("Wordpad exited. Logging off...")
       Set WshShell = WScript.CreateObject("WScript.Shell")
       WshShell.Run "logoff" 

    end if 

Loop 
```

# dos - DOS 级联命令字符串中的延迟扩展

> ID：12412224
> 
> 赞同：0
> 
> 时间：2012-09-13T18:07:00.537
> 
> 标签：dos, delayedvariableexpansion

我已经问过有关 DOS 中的级联命令的其他问题，但显然我对要考虑的全部内容还没有那么自信。

有人可以看一下我系统上的以下代码和输出，看看他们是否可以建议什么语法是错误的（注意，我已经手动断行了）：

```
%comspec% /v:on /k "(for /f "tokens=2*" %a in ('reg query hkcu\software\microsoft
\windows\currentversion\policies\system /v DisableTaskMgr') do @set DisableTaskMg
r=%b) 2>nul & set DisableTaskMgr& pause & (if defined programfiles^(x86^) (set
"ProgramFiles(x32)=%programfiles(x86)%") else (set "ProgramFiles(x32)=%programfil
es%")) & !ProgramFiles(x32)!\Mozilla\Firefox\Firefox.exe -chrome chrome://browser
/content & echo. & if defined DisableTaskMgr (echo DisableTaskMgr reg key existed
prior to running, and... & (set DisableTaskMgr=%DisableTaskMgr:~2,3% & echo !
DisableTaskMgr! & reg add hkcu\software\microsoft\windows\currentversion\policies
\system /v DisableTaskMgr /t REG_DWORD /d %DisableTaskMgr% & if %DisableTaskMgr%
eql 0 (echo Previous state was Task Manager enabled) else (echo Previous state
was Task Manager DISabled))) else (echo DisableTaskMgr reg key DID NOT exist pri
or to running & reg delete hkcu\software\microsoft\windows\currentversion\polici
es\system /v DisableTaskMgr /f)" 
```

.
![在此处输入图像描述](../Images/a4949bef1916b3f402008ae61411880e.png)

我曾尝试删除部分代码以修复个别部分，但我尝试和错误的尝试证明我不知道什么是错误的，而且我不会自己解决这个问题非常快 ：（

![在此处输入图像描述](../Images/606dd36df0d527d1515601fee2f8c658.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:37:06.797

您的 IF 比较运算符是错误的。你有`eql`- 它应该是`equ`。

我不知道这是否是你唯一的问题——你对那个声明的野兽有一个可怕的维护问题。

您最好创建一个具有相同逻辑但格式良好的批处理文件。然后，您可以简单地调用批处理文件，而不是尝试将整个复杂过程嵌入为一个复杂的命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T09:00:09.647

我可以在这里看到你的问题！这是你的代码！****咧嘴****

说真的，即使您打算保持这种混乱状态，我还是建议将其拆分为组成组件以进行调试。您甚至可以通过将`()`块内的内容放入单独的子例程中来避免有时神秘的块错误。转这种东西...

```
if statement (
  code block 1
  code block 1
  code block 1
  code block 1
) else if (
  code block 2
  code block 2
  code block 2
  code block 2
) 
```

...进入这种事情：

```
if statement (
  call :CodeBlock1
) else if (
  call :CodeBlock2
)
goto :eof

:CodeBlock1
  code
  code
  code
  code
goto :eof

:CodeBlock2
  code
  code
  code
  code
goto :eof 
```

尝试将其作为单行进行调试意味着始终牢记整个事物及其交互方式。并且基本上不得不猜测哪个看起来相似的代码实际上创建了您要修复的错误。

我个人浪费了很多时间来尝试修复完美的代码，而没有意识到我正在查看的错误实际上在代码块的更下方。

找到并修复错误后，如果您愿意，可以再次将其全部塞回一行。克服挑战并不一定意味着要以最艰难的方式去做。根据定义，克服挑战最简单的方法也是克服挑战。

# jquery - 我想用 Ajax 和 jQuery 进行扫描，看看数据库中是否已经存在该名称

> ID：12412227
> 
> 赞同：-3
> 
> 时间：2012-09-13T18:07:10.207
> 
> 标签：jquery, ajax, zend-framework

我想用 Ajax 和 jQuery 进行扫描，看看数据库中是否已经存在该名称，是否必须返回一条消息。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:24:40.037

您将希望在您使用的任何具有数据库的服务器端系统上编写某种 Web 服务接口。然后，您可以使用 jQuery getJson：[http ://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

您的 Web 服务将返回 JSON，而 getJSON 会自动将其转换回 javascript 对象，因此您的 javascript 代码可以根据结果做出某种决定。

请注意，仅 javascript 无法与您的数据库交互，您需要有某种 ajax 可以连接的 http 接口。

# regex - 正则表达式捕获以 UUID 结尾但不是其他任何内容的 URI

> ID：12412229
> 
> 赞同：3
> 
> 时间：2012-09-13T18:07:12.703
> 
> 标签：regex

我想通过 javascript 正则表达式匹配看起来像这样的 URI（包括路径和 UUID）：

```
/account/0006a8a6-b301-4168-b7de-964773a1ec66 
```

我最接近的正则表达式是这样的：

```
^\/([a-zA-Z0-9_\.~-]+)\/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}) 
```

可以很好地捕获上述内容 - 我得到一个匹配项，它捕获为两组。

但是，如果我将其作为 URI 输入：

```
/account/0006a8a6-b301-4168-b7de-964773a1ec66DSSSSSS 
```

正则表达式仍然匹配并捕获两个组，第二个匹配仍然只是 UUID，但我需要它实际上使匹配失败并且由于末尾附加的 DSSSSS 而不能捕获任何内容。我怎样才能改变我的正则表达式来完成这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:09:31.760

您忘记添加行尾[锚点](http://www.regular-expressions.info/anchors.html) `$`

```
^\/([a-zA-Z0-9_\.~-]+)\/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:11:43.387

我看到您正在使用行首锚 (^)。尝试使用结束线锚 ($)。

```
^/([a-zA-Z0-9_.~-]+)/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})$ 
```

# java - 创建文件 Java 时转义正斜杠

> ID：12412230
> 
> 赞同：3
> 
> 时间：2012-09-13T18:07:12.593
> 
> 标签：java, file, escaping

我正在创建一些文件，并且正在从数据库中获取文件名。

有一个文件名叫做

> CUA/ICOR 数字收藏。

但是，由于正斜杠，“CUA”被视为目录。

我[在 Java Regex 中找到了正斜杠](https://stackoverflow.com/questions/9575116/forward-slash-in-java-regex)

我试过了：

```
String fileName = "CUA/ICOR Digital Collection";
fileName = fileName.replaceAll("/", "\\\\/");  // OP: CUA\/ICOR Digital Collection But No success

fileName = fileName.replaceAll("/", Matcher.quoteReplacement("\\/"));  // OP: CUA\/ICOR Digital Collection But No success

fileName = fileName.replaceAll("/", Matcher.quoteReplacement("\\\\/"));  // OP: CUA\\/ICOR Digital Collection But No success

File file = new File(exportPath, fileName + ".xls"); 
```

我正进入（状态

```
File Not Found Exception At 'C:\export\CUA\ICOR Digital Collection.xls' 
```

所以，现在我怀疑这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:11:17.540

在 Windows 上，文件不能包含`/\:*?"<>|`

你最好将`/`字符转换为下划线之类的东西`(_)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:14:55.700

如果你在`Windows`....我**不认为你的文件名**可以有变量`\`

您可以尝试将其转换为 a `space`or `underscore`....

所以它会是这样的......

`CUA_ICOR Digital Collection`

**或者**

`CUA ICOR Digital Collection.`

# c# - 如何在 EF 中执行日期部分比较

> ID：12412231
> 
> 赞同：7
> 
> 时间：2012-09-13T18:07:13.513
> 
> 标签：c#, entity-framework, tsql, linq-to-entities, datetime-comparison

我听到人们说日期时间比较仅由于时间部分而不起作用，因为日期时间有时间部分。

在 sql 中我总是这样比较日期时间，它工作正常

```
select * from employee
where convert(varchar,dob,112) > '20111201' // this yyyymmdd format. 
```

我怎么能在 LINQ 查询中模拟这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T18:22:47.010

如果您使用的是 .NET 4 或更高版本，只需使用[`EntityFunctions.TruncateTime`](http://msdn.microsoft.com/en-us/library/dd395596%28v=vs.100%29.aspx)helper 方法。这将为您将这种类型的 datetime-to-date 转换转换为 SQL。

```
from e in EfEmployeeContext
where EntityFunctions.TruncateTime(e.DOB) > new DateTime(2011,12,01); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:18:53.000

要记住的一件事是，对表示数据库列的 DateTime 结构的操作不会转换为 SQL。因此，您不能编写如下查询：

```
from e in EfEmployeeContext
where e.DOB.Date > new DateTime(2011,12,01); 
```

...因为 e.DOB 代表数据库中的 DOB 列，EF 不知道如何翻译 Date 子属性。

但是，根据您想要的日期，有一个简单的解决方法：

*   如果您想包括在 2011 年 12 月 1 日拥有 DOB 的所有员工以及在该日期之后出生的员工，则只需查询：

    ```
    from e in EfEmployeeContext
    where e.DOB > new DateTime(2011,12,01); 
    ```

*   如果您只想包括 2011 年 12 月 1 日之后出生的员工，请查询：

    ```
    from e in EfEmployeeContext
    where e.DOB >= new DateTime(2011,12,02); 
    ```

简而言之，可以根据需要设置标准，即您要比较的常量或文字 DateTime。您只是不能对表示 where 谓词中的 DB 列的属性进行彻底修改。这意味着您不能将一个 DateTime 列与另一个 DateTime 列的投影进行比较，例如：

```
 //get all employees that were hired in the first six months of the year
    from e in EfEmployeeContext
    where e.HireDate < new DateTime(e.HireDate.Year, 7, 1); 
```

# lua - wxLua - 如何实现取消按钮？

> ID：12412239
> 
> 赞同：2
> 
> 时间：2012-09-13T18:07:44.170
> 
> 标签：lua, wxwidgets, coroutine, cancel-button

我有一个带有“运行”按钮的 wxLua Gui 应用程序。根据选择的选项，运行可能需要很长时间，所以我想实现一个“取消”按钮/功能。但看起来 wxLua 中的所有东西都在一个 Gui 线程上运行，一旦你点击 Run，按 Cancel 什么都不会，Run 总是会完成。

Cancel 基本上将一个变量设置为 true，并且正在运行的进程会定期检查该变量。但是运行时不会发生取消按钮按下事件。

我从未使用过协同程序；如果 Run 过程定期产生“取消检查”过程，那么 Cancel 事件会发生吗？

还是有其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:39:28.013

（以下假设“运行”是指在同一进程中长时间运行的操作，而**不是**使用 wxExecute 或 wxProcess 运行外部进程。）

“取消”事件不会被触发，因为通过执行您的运行逻辑，您还没有给 UI 处理点击事件的机会。

为避免阻塞 UI，您需要执行以下操作。当您单击“运行”按钮时，围绕要运行的函数创建一个协程：

```
coro = coroutine.create(myLongRunningFunction) 
```

您的 Run 事件此时已完成。然后在 EVT_IDLE 事件中，只要它不完整，你就会恢复这个协程。它看起来像这样：

```
if coro then -- only if there is a coroutine to work on
  local ok, res = coroutine.resume(coro, additional, parameters)
  -- your function either yielded or returned
  -- you may check ok to see if there was an error
  -- res can tell you how far you are in the process
  -- coro can return multiple values (just give them as parameters to yield)
  if coroutine.status(coro) == 'dead' then -- finished or stopped with error
    coro = nil
    -- do whatever you need to do knowing the process is completed
  end
end 
```

只要您的进程未完成，您可能需要请求更多 IDLE 事件，因为某些操作系统不会触发 IDLE 事件，除非触发了其他一些事件。假设您的处理程序有`event`参数，您可以`event:RequestMore(true)`请求更多 IDLE 事件（[RequestMore](http://docs.wxwidgets.org/2.8/wx_wxidleevent.html#wxidleeventrequestmore)）。

您的长时间运行的流程需要在正确的时间调用 coroutine.yield() （不要太短，因为您会浪费时间来回切换，也不要太长时间让用户注意到 UI 中的延迟）；您可能需要对此进行试验，但是基于计时器的调用之间有 100 毫秒左右的时间可能会起作用。

您可以像现在一样在 IDLE 事件处理程序或长时间运行的函数中检查 Cancel 值。我描述的逻辑将使您的应用程序 UI 有机会按您的预期处理 Cancel 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:27:08.133

我不使用 WXWidgets，但我在使用 IUP 的 lua 脚本中实现取消按钮的方式是设置一个取消标志，该标志在按下按钮时设置，并在运行期间检查进度显示。

用法是这样的

```
ProgressDisplay.Start('This is my progress box',100)
for i=1,100 do
    ProgressDisplay.SetMessage(i.." %")
    fhSleep(50,40)  -- Emulate performing the task 
    ProgressDisplay.Step(1)
    if ProgressDisplay.Cancel() then
        break
    end
end 
ProgressDisplay.Reset()
ProgressDisplay.Close() 
```

如果您想查看 ProgressDisplay 的定义，请参阅：

[http://www.fhug.org.uk/wiki/doku.php?id=plugins:code_snippets:progress_bar](http://www.fhug.org.uk/wiki/doku.php?id=plugins:code_snippets:progress_bar)

# objective-c - iOS 边界在旋转到横向后发生变化，然后又回到纵向

> ID：12412240
> 
> 赞同：13
> 
> 时间：2012-09-13T18:07:44.727
> 
> 标签：objective-c, ios, uiview

当我的应用程序启动时，我的视图边界的 NSLog 显示以下内容：

```
NSLog(@"My view frame: %@", NSStringFromCGRect(self.view.bounds));
My view frame: {{0, 0}, {320, 548}} 
```

然后我旋转模拟器并得到以下信息：

```
NSLog(@"My view frame: %@", NSStringFromCGRect(self.view.bounds));
My view frame: {{0, 0}, {320, 548}} 
```

然后当我将模拟器旋转回肖像时，我得到了这个：

```
NSLog(@"My view frame: %@", NSStringFromCGRect(self.view.bounds));
My view frame: {{0, 0}, {568, 300}} 
```

我用来调整元素的两种方法是这些，它们还没有完成，因为我目前正在为新 iPhone 修复它们。

```
-(void) resizeForLandscape
{
    newsLabel = (UILabel *)[self.view viewWithTag:50];
    weatherLabel = (UILabel *)[self.view viewWithTag:51];
    sportsLabel = (UILabel *)[self.view viewWithTag:52];
    entertainmentLabel = (UILabel *)[self.view viewWithTag:53];
    videosLabel = (UILabel *)[self.view viewWithTag:54];
    moreLabel = (UILabel *)[self.view viewWithTag:55];

    NSLog(@"resizeForLandscape called");
    webView.frame = CGRectMake(0, 31, self.view.frame.size.width, self.view.frame.size.height - 75);    
    button.frame = CGRectMake(0, 0, image.size.width -30, image.size.height -15);
    myLabel.frame = CGRectMake(230, 100, 80, 21);
    label.frame = CGRectMake(0, 0, self.view.bounds.size.height + 15, 30);

    NSLog(@"My view frame: %@", NSStringFromCGRect(self.view.bounds));
    NSLog(@"my status bar height is %f", [UIApplication sharedApplication].statusBarFrame.size.height);
    NSLog(@"my status bar width is %f", [UIApplication sharedApplication].statusBarFrame.size.width);

    newsLabel.frame = CGRectMake((self.view.bounds.size.height - 346) / 2 + 12, self.view.bounds.size.width - 38, 43, 21);
    weatherLabel.frame = CGRectMake(newsLabel.frame.origin.x + 64, self.view.bounds.size.width - 38, 42, 21);
    sportsLabel.frame = CGRectMake(newsLabel.frame.origin.x + 126, self.view.bounds.size.width - 38, 42, 21);
    entertainmentLabel.frame = CGRectMake(newsLabel.frame.origin.x + 185, self.view.bounds.size.width - 38, 66, 21);
    videosLabel.frame = CGRectMake(newsLabel.frame.origin.x + 269, self.view.bounds.size.width - 38, 42, 21);
    moreLabel.frame = CGRectMake(newsLabel.frame.origin.x + 325, self.view.bounds.size.width - 38, 42, 21);

    spacer1.width = (self.view.bounds.size.height - 346) / 2;
    spacer2.width = 40;
    spacer3.width = 28;
    spacer4.width = 42;
    spacer5.width = 35;
    spacer6.width = 24;
}

-(void) resizeForPortrait
{
    newsLabel = (UILabel *)[self.view viewWithTag:50];
    weatherLabel = (UILabel *)[self.view viewWithTag:51];
    sportsLabel = (UILabel *)[self.view viewWithTag:52];
    entertainmentLabel = (UILabel *)[self.view viewWithTag:53];
    videosLabel = (UILabel *)[self.view viewWithTag:54];
    moreLabel = (UILabel *)[self.view viewWithTag:55];

    NSLog(@"resizeForPortrait called");

    webView.frame = CGRectMake(0, 44, self.view.frame.size.width, self.view.frame.size.height -88);
    button.frame = CGRectMake(0, 0, image.size.width, image.size.height);
    myLabel.frame = CGRectMake(145, 152, 80, 21);
    label.frame = CGRectMake(0, 0, 315, 40);

    NSLog(@"My view frame: %@", NSStringFromCGRect(self.view.bounds));

    NSLog(@"my status bar height is %f", [UIApplication sharedApplication].statusBarFrame.size.height);
    NSLog(@"my status bar width is %f", [UIApplication sharedApplication].statusBarFrame.size.width);

    float myWidth = MIN(self.view.bounds.size.height, self.view.bounds.size.width);
    float myHeight = MAX(self.view.bounds.size.height, self.view.bounds.size.width);

    newsLabel.frame = CGRectMake(newsLabel.frame.origin.x, myHeight - 18, 43, 21);
    weatherLabel.frame = CGRectMake(newsLabel.frame.origin.x + 43, myHeight - 18, 42, 21);
    sportsLabel.frame = CGRectMake(newsLabel.frame.origin.x + 97, myHeight - 18, 42, 21);
    entertainmentLabel.frame = CGRectMake(newsLabel.frame.origin.x + 138, myHeight - 18, 66, 21);
    videosLabel.frame = CGRectMake(newsLabel.frame.origin.x + 213, myHeight - 18, 42, 21);
    moreLabel.frame = CGRectMake(newsLabel.frame.origin.x + 258, myHeight - 18, 42, 21);

    spacer1.width = (myWidth - 346) / 2;
    spacer2.width = 20;
    spacer3.width = 18;
    spacer4.width = 25;
    spacer5.width = 28;
    spacer6.width = 14;
} 
```

调用者：

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft || toInterfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        [self resizeForLandscape];
    } else {
        [self resizeForPortrait];
    }
}

- (void) getOrientationandResize
{    
    if (UIDeviceOrientationIsLandscape([UIApplication sharedApplication].statusBarOrientation)) {
        [self resizeForLandscape];
    } else {
        [self resizeForPortrait];
    }
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    [self getOrientationandResize];
} 
```

我的头快要爆炸了。不仅视图被颠倒了，而且从宽度上抢走了 20 个像素并赋予了高度。任何人都可以向我解释这一点，以及我如何/应该在我的视图中对元素进行编码以解释它吗？

我的故事板如下：

![在此处输入图像描述](../Images/7911838c58339b9699b8ee8ad42fb4df.png)

我的初步看法： ![在此处输入图像描述](../Images/ffd4a87e40634b3ed79dc07c0dc64d4d.png)

第一次旋转后（仍然很好） ![在此处输入图像描述](../Images/42a540090edaea8109b4f5db82161292.png)

旋转回纵向（由于边界值而全部搞砸了） ![在此处输入图像描述](../Images/22d076d9103ad7c8fd5013dec4cc208b.png)

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-13T19:11:30.717

你几乎不应该在`willRotateToInterfaceOrientation:duration:`. 当系统发送给您时`willRotateToInterfaceOrientation:duration:`，**它并没有将您的视图框架更新为新的大小**。因此，通过咨询`self.view.frame`，您使用的是当前（旧）方向的框架，**而不是**新（尚未旋转到）方向的框架。

您也不应该在 中进行布局`viewDidAppear:`，因为当您收到`viewDidAppear:`时，您的视图已经在屏幕上。您需要在视图出现在屏幕上**之前进行布局。**

您需要以适当的方法进行布局。最好的布局是在`layoutSubviews`自定义`UIView`子类的方法中。把它放在那里可以让你的视图逻辑与你的控制器逻辑分开。

进行布局的下一个最佳位置是视图控制器的`viewWillLayoutSubviews`or`viewDidLayoutSubviews`方法。

如果您将布局代码放在`layoutSubviews`、`viewWillLayoutSubviews`或`viewDidLayoutSubviews`中，系统将在您的视图出现在屏幕上之前以及在自动旋转的动画块内**自动**调用该方法。在这两种情况下，它都会在向您发送消息之前更新您的视图框架以获得正确的方向。

如果您需要在自动旋转动画开始之前隐藏视图，然后再次显示它，您可以在`willRotateToInterfaceOrientation:duration:`和中执行此操作`didRotateFromInterfaceOrientation:`。

如果您只想在自动旋转期间而不是在初始视图布局期间执行特殊动画**，**您可以在 中执行此操作`willAnimateRotationToInterfaceOrientation:duration:`，这在自动旋转的动画块内调用。

您可能会发现这个答案很有帮助：[UIViewController 返回无效帧？](https://stackoverflow.com/questions/9539676/uiviewcontroller-returns-invalid-frame/9540935#9540935)

# algorithm - 关于遗传算法的困惑

> ID：12412250
> 
> 赞同：1
> 
> 时间：2012-09-13T18:08:30.660
> 
> 标签：algorithm, genetic-algorithm

我的书（人工智能一种现代方法）说遗传算法从一组*k*随机生成的状态开始，称为种群。每个状态都表示为一个有限字母表上的字符串——最常见的是一个由 0 和 1 组成的字符串。例如，8 个皇后状态必须指定 8 个皇后的位置，每个皇后在一列 8 个方格中，因此需要 8 * log(2)8 = 24 位。或者，状态可以表示为 8 位数字，每个数字的范围从 1 到 8。

[ [http://en.wikipedia.org/wiki/Eight_queens_puzzle](http://en.wikipedia.org/wiki/Eight_queens_puzzle) ]

我不明白表达式 8 * log(2)8 = 24 bits ，为什么是 log2 ^ 8？这些 24 位应该是做什么用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:19:19.713

如果我们在维基百科页面上举第一个例子，解决方案可以编码为 [2,4,6,8,3,1,7,5] ：第一个数字给出 A 列中皇后的行号，第二个对于 B 列中的女王，依此类推。现在，我们将从 0 开始，而不是从 1 开始行编号。然后使用 [1,3,5,7,0,6,4] 对解决方案进行编码。任何位置都可以这样编码。
我们只有 0 到 7 之间的数字，如果我们用二进制 3 位 (=log2(8)) 编写它们就足够了：

```
000 -> 0
001 -> 1
...
110 -> 6
111 -> 7 
```

一个位置可以使用 8 乘以 3 位进行编码，例如从 [1,3,5,7,2,0,6,4] 我们得到 [001,011,101,111,010,000,110,100] 或更简单地说 001011101111010000110100 : 24 位。
另一方面，位串 000010001011100101111110 解码为 000.010.001.011.100.101.111.110 然后 [0,2,1,3,4,5,7,6] 并给出 [1,3,2,4,5,8, 7] : A 列中的皇后在第 1 行，B 列中的皇后在第 3 行，依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:19:33.740

存储可能的正方形（8 种可能性 0-7）所需的位数是 log(2)8。请注意，二进制的 111 是十进制的 7。您必须为 8 列指定正方形，因此需要 3 位 8 次

# python - 在 python 中迭代 xml 元素时缺少一些文本

> ID：12412264
> 
> 赞同：3
> 
> 时间：2012-09-13T18:09:33.310
> 
> 标签：python, xml, xpath, lxml

我在 Mac OS X 10.6.8 上的 Python 2.7.3 中运行以下代码。

```
import StringIO
from lxml import etree
f = open('./foo', 'r')
doc = ""
while 1:
    line = f.readline()
    doc += line
    if line == "":
        break
tree = etree.parse(StringIO.StringIO(doc), etree.HTMLParser())
r = tree.xpath('//foo')
for i in r:
    for j in i.iter():
        print j.tag, j.text 
```

文件 foo 包含

```
<foo> AAA <bar> BBB </bar> XXX </foo> 
```

输出是

```
foo AAA
bar BBB 
```

为什么我没有收到文字`XXX`？我如何访问它？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:28:20.117

试试这个：

```
from lxml import etree

tree = etree.fromstring("<foo> AAA <bar> BBB </bar> XXX </foo>")
foos = tree.xpath('//foo')

for foo in foos:
    for j in foo.iter():
        print j.tag, j.text, j.tail 
```

输出：

```
foo  AAA  None
bar  BBB   XXX 
```

该[`tail`](http://lxml.de/api/lxml.etree._Element-class.html#tail)属性包含元素结束标记之后的文本。

`tail`与其他 XML 模型（例如 DOM）相比，这是 lxml 和 ElementTree 的一个特点。有关详细信息，请参阅[http://infohost.nmt.edu/tcc/help/pubs/pylxml/web/etree-view.html](http://infohost.nmt.edu/tcc/help/pubs/pylxml/web/etree-view.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T18:13:20.267

你也必须采取

```
node.tail 
```

考虑到（或检查）。

# model-binding - 十进制和 Nancy 模型绑定的全球化问题

> ID：12412266
> 
> 赞同：1
> 
> 时间：2012-09-13T18:09:41.940
> 
> 标签：model-binding, nancy

我是 Nancy 的新手，我正在尝试使用 Nancy.ModelBinding 命名空间绑定十进制属性，如下所示：

```
var model = this.Bind<AddPaymentModel>(); 
```

我的应用程序使用的是非美国文化 (pt-BR)，其中小数的表示方式不同（4.50 将是 4,50）并且上面的代码会引发错误，即使 CurrentCulture 已正确设置为 pt-BR。我正在发布 JSON，我认为它可能与 JSON 反序列化器有关......

我的堆栈跟踪的一部分：

```
Nancy.RequestExecutionException: Oh noes! ---> System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.Exception: 450,00 is not a valid value for Decimal. ---> System.FormatException: Input string was not in a correct format.
at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
at System.Number.ParseDecimal(String value, NumberStyles options, NumberFormatInfo numfmt)
at System.Decimal.Parse(String s, NumberStyles style, IFormatProvider provider)
at System.ComponentModel.DecimalConverter.FromString(String value, NumberFormatInfo formatInfo)
at System.ComponentModel.BaseNumberConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
--- End of inner exception stack trace ---
at System.ComponentModel.BaseNumberConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
at System.ComponentModel.TypeConverter.ConvertFromInvariantString(String text)
at Nancy.Json.JavaScriptSerializer.ConvertToType(Type type, Object obj)
at Nancy.Json.JavaScriptSerializer.ConvertToObject(IDictionary`2 dict, Type type)
at Nancy.Json.JavaScriptSerializer.ConvertToType(Type type, Object obj)
at Nancy.Json.JavaScriptSerializer.ConvertToType[T](Object obj)
at Nancy.Json.JavaScriptSerializer.Deserialize[T](String input)
--- End of inner exception stack trace ---
at System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor)
at System.Reflection.RuntimeMethodInfo.UnsafeInvokeInternal(Object obj, Object[] parameters, Object[] arguments)
at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
at Nancy.ModelBinding.DefaultBodyDeserializers.JsonBodyDeserializer.Deserialize(String contentType, Stream bodyStream, BindingContext context)
at Nancy.ModelBinding.DefaultBinder.DeserializeRequestBody(BindingContext context)
at Nancy.ModelBinding.DefaultBinder.Bind(NancyContext context, Type modelType, String[] blackList) 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T11:08:19.457

您可以尝试切换到 Nancy 的 Newtonsoft.JsonNet 序列化程序。

[http://nuget.org/packages/Nancy.Serialization.JsonNet](http://nuget.org/packages/Nancy.Serialization.JsonNet)

这是一个“包罗万象”的示例实现

```
using System;
using System.Collections.Generic;
using Nancy;
using Nancy.Bootstrapper;
using Nancy.Serialization.JsonNet;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

namespace Application
{
    public class Bootstrapper : DefaultNancyBootstrapper
    {

        protected override NancyInternalConfiguration InternalConfiguration
        {
            get
            {
                return NancyInternalConfiguration.WithOverrides(
                c => c.Serializers.Insert(0, typeof(ModifiedJsonNetJsonSerializer)));
            }
        }

        public class ModifiedJsonNetJsonSerializer : JsonNetSerializer
        {
            public ModifiedJsonNetJsonSerializer()
                : base(new List<JsonConverter> { new FloatConverter() })
            { }

            public class FloatConverter : JsonConverter
            {
                public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
                {
                    var floatValue = (float)value;
                    writer.WriteValue(string.Format("{0:0.00}", floatValue));
                }

                public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
                {
                    var jobject = JToken.Load(reader);
                    var str = jobject.Value<string>();
                    float number;
                    try
                    {
                        number = float.Parse(str);
                    }
                    catch (FormatException)
                    {
                        str = str.IndexOf(".", StringComparison.Ordinal) > -1 ? str.Replace('.', ',') : str.Replace(',', '.');
                        number = float.Parse(str);
                    }
                    return number;
                }

                public override bool CanConvert(Type objectType)
                {
                    return objectType == typeof(float) || objectType == typeof(Single);
                }
            }
        }
    }
} 
```

# php - 在 PHP 中编程时，属性“值”需要打开引号

> ID：12412269
> 
> 赞同：5
> 
> 时间：2012-09-13T18:09:57.273
> 
> 标签：php, xml, zoho

您好，感谢您的帮助，

我正在使用 PHP 编写 XML 请求，我遇到的问题是当我在值字段中使用变量时，它返回错误。但是，当我手动输入值时，它可以完美运行。在字段 name='Serial_Number' 下，您将看到 $MREPSerial 是变量，假设在 PHP 中我们有 $MREPSerial = 'A-000-1042'; 下面的 XML 会出错。但是，如果我仅用 XML 中的值替换 $MREPSerial，它将是成功的。任何帮助将不胜感激。谢谢！

```
$MREPSerial  = htmlspecialchars(strtoupper($_POST['NSMREP']));
echo "Hi".$MREPSerial;
<ZohoCreator>
            <applicationlist>
                <application name='ajout-de-materiel'>
                    <formlist>
                        <form name='MREP'>
                            <update>
                                <criteria>
                                    <field name='Serial_Number' compOperator='Equals' value={$MREPSerial}></field>
                                    <reloperator>AND</reloperator>
                                    <field name='MREP_Type' compOperator='Equals' value='0'></field>                            
                                </criteria>
                                <newvalues>
                                    <field name='Is_being_Used' value='TRUE'></field>
                                </newvalues>
                            </update>    
                        </form>
                    </formlist>
                </application>
            </applicationlist>
        </ZohoCreator>"; 
```

... echo 上的返回响应（包括我回显的 XML）

```
A-000-1012HI! <?xml version="1.0" encoding="UTF-8" ?>
<response><errorlist><error><code>2830</code><message><![CDATA[Open quote is expected for attribute "value" associated with an  element type  "field".]]></message></error></errorlist></response> 
```

如果我将它更改为 '".$MREPSerial."，则回显的返回响应。是：

```
A-000-1012HI! <?xml version="1.0" encoding="UTF-8" ?>
<response><result><form name="MREP"><update><criteria><field name="Serial_Number" compOperator="Equals" value=""></field><reloperator>AND</reloperator><field name="MREP_Type" compOperator="Equals" value="0"></field></criteria><newvalues><field name="Is_being_Used"><value><![CDATA[TRUE]]></value></field></newvalues> <status>Failure, No Records Found With Specified Criteria</status></update></form></result></response> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:12:22.390

您需要在 value 属性的实际值周围加上引号，如下所示：

```
<field name='Serial_Number' compOperator='Equals' value='{$MREPSerial}'></field> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:17:36.480

刚看到你的`";`关闭标签...

试试这个

```
 <field name='Serial_Number' compOperator='Equals' value='".$MREPSerial."'></field> 
```

# jquery - Jquery添加动态下拉列表

> ID：12412274
> 
> 赞同：0
> 
> 时间：2012-09-13T18:10:17.150
> 
> 标签：jquery

我们有一些简单的代码如下。我们在每一行都有一个添加按钮，它可以相应地添加动态行，这很好用。现在的问题是我们需要更复杂一些，在 Serial 列中我们需要另一个添加按钮，在此列中我们也可以添加多个下拉列表。所以我们不知道如何修改它以启用此功能？任何想法？

```
<head> 

        <link rel="stylesheet" type="text/css" href="my1.css" media="all" /> 
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.5.1.min.js"></script> 
        <script type="text/javascript" src="jquery.validate.js"></script> 

        <script type="text/javascript"> 

        $(document).ready(function() {

            function checkRows(form) {
                //$(form).validate().resetForm();
                //alert("Length : "+$('table.dynatable tbody tr', form).length);
                if ($('table.dynatable tbody tr', form).length > 2) {
                      alert("Call setup multiple row");

                }
            }

            var form = $("#form1");
            checkRows(form);
            setupFormValidation(form);

            var prot = $('tr.prototype').clone().removeClass('prototype');
            $(form).data('prototype', prot);

            var id = 1;

            // Add button functionality
            $("table.dynatable button.add").click(function() {
                var form = this.form;
                id++;

                // Get a new row based on the prototype row
                //var prot = master.find(".prototype").clone();
                var prot = $(form).data('prototype').clone();
                prot.find('[name^="id"]').attr("value", id);
                prot.find('[name^="locationFrom"]').attr('name', 'locationFrom[' + id + ']');
                prot.find('[name^="locationFrom"]').attr('id', 'locationFrom' + id + '');
                prot.find('[name^="locationFrom"]').attr('value', '');
                prot.find('[name^="serial"]').attr('name', 'serial[' + id + ']');
                prot.find('[name^="serial"]').attr('id', 'serial' + id + '');
                prot.find('[name^="serial"]').attr('value', '');

                $("#dynamicRow").find('tbody').append(prot);
                setupFormValidation(form);

                return false;
            });

            function setupFormValidation(form) 
            {       
                      //alert("validate :");        
                    $(form).validate();

            }

                      $('table.dynatable tbody tr select[name^="locationFrom"]').live('change',handleLocationFromUpdate);  
                      function handleLocationFromUpdate(index)
                      {
                          if($(this).closest('tr').next().length == 0 && $(this).closest('tr').prev().length == 0)
                          {
                            var nextValue = $('select[name^="locationFrom"]', $(this).closest('tr').next('tr'));
                            if(nextValue.val()==$(this).val())
                            $(this).val('');
                          }
                          else if($(this).closest('tr').next().length == 0 && $(this).closest('tr').prev().length > 0)
                          {
                            //alert("Last Field");
                            var prevValue = $('select[name^="locationFrom"]', $(this).closest('tr').prev('tr'));                            
                            if(prevValue.val()==$(this).val())
                            $(this).val('');
                          }
                          else
                          {
                            var prevValue = $('select[name^="locationFrom"]', $(this).closest('tr').prev('tr'));
                            var nextValue = $('select[name^="locationFrom"]', $(this).closest('tr').next('tr'));                            
                            if(prevValue.val()==$(this).val() || nextValue.val()==$(this).val())
                            $(this).val('');
                          }

                     }

                     $('table.dynatable tbody tr select[name^="serial"]').live('change',handleSerialUpdate);  
                      function handleSerialUpdate(index)
                      {
                            var sCheck = new Array ();

                $('select[name^="serial"]').each(function(i) {

                       //alert("VALUE IS : "+$(this).val()+"  "+$("option:selected", this).text() );
                       jQuery.inArray($(this).val(), sCheck);
                       if($(this).val()>0)
                       {
                         if (jQuery.inArray($(this).val(), sCheck) == -1) {
                                                   sCheck.push($(this).val());
                                             }
                                             else {
                                                alert("Serial "+$("option:selected", this).text()+" Selected More Than Once");
                                                $(this).val('');
                                                return false;
                                             }
                                         }
                });

                     }
            // Remove button functionality
            $("table.dynatable button.remove").live("click", function() {

                if ($('table.dynatable tbody tr', form).length > 2) 
                {
                var form = this.form;

                $(this).closest("tr").remove();
                }

                $('select[name^="locationFrom"]').each(function(i) {
                    if($(this).closest('tr').next().length > 0 && $(this).closest('tr').prev().length == 0)
                                      {
                                        alert("first Field");
                                        var nextValue = $('select[name^="locationFrom"]', $(this).closest('tr').next('tr'));
                                        if(nextValue.val()==$(this).val())
                                        $(this).val('');
                                      }
                                      else if($(this).closest('tr').next().length == 0 && $(this).closest('tr').prev().length > 0)
                                      {
                                        alert("Last Field");
                                        var prevValue = $('select[name^="locationFrom"]', $(this).closest('tr').prev('tr'));                            
                                        if(prevValue.val()==$(this).val())
                                        $(this).val('');
                                      }
                                      else
                                      {
                                        alert("middle Field");
                                        var prevValue = $('select[name^="locationFrom"]', $(this).closest('tr').prev('tr'));
                                        var nextValue = $('select[name^="locationFrom"]', $(this).closest('tr').next('tr'));                            
                                        if(prevValue.val()==$(this).val() || nextValue.val()==$(this).val())
                                        $(this).val('');
                                      }
                });

                var sCheck = new Array ();

                $('select[name^="serial"]').each(function(i) {

                       //alert("VALUE IS : "+$(this).val()+"  "+$("option:selected", this).text() );
                       //jQuery.inArray($(this).val(), sCheck)

                     if($(this).val()>0)
                       {
                         if (jQuery.inArray($(this).val(), sCheck) == -1) {
                                                   sCheck.push($(this).val());
                                             }
                                             else {
                                                alert("Serial "+$("option:selected", this).text()+" Selected More Than Once");
                                                $(this).val('');
                                                return false;
                                            }
                                         }
                });

            });

            jQuery('.dOnly').live('keyup', function () 
            {     
                 this.value = this.value.replace(/[^0-9\.]/g,''); 
            });
        });
        </script> 
        <style type="text/css"> 
            .dynatable {
                border: solid 1px #000; 
                border-collapse: collapse;
            }
            .dynatable th,
            .dynatable td {
                background-color:#ccc; 
                font-size:14px;
                font-color:#ffffff;
                font-family:Calibri;
            }
            .dynatable .prototype {

            }
            label.error 
            { 
                display: block; 
                color:red;
            }

            td { vertical-align: top; }

        </style> 
</head> 
<body>

        <form action="" method="post"  enctype="multipart/form-data" id="form1" > 

        <table id="table1">
        <tr>

                    <td>
                    Route Name:<input class="required text" type="text" name="routeName" id="routeName" value="" />

                    </td>   

                    </tr>
        </table>
        <table class="dynatable" id="dynamicRow"> 
            <thead> 
                <tr> 
                    <th>ID</th> 
                    <th>Location</th> 
                    <th>Serial</th>                     
                    <th><button class="add">Add</button></th> 
                </tr> 
            </thead> 
            <tbody> 
                    <tr class="prototype">

                        <td><input type="text" name="id[1]" value="1" /></td> 
                        <td><select class='required' id='locationFrom1' name='locationFrom[1]' >
                        <option value=''>Select Location</option>
                        <option value='1'>Loc 1</option>
                        <option value='2'>Loc 2</option>
                        <option value='3'>Loc 3</option>
                        <option value='4'>Loc 4</option>
                        <option value='5'>Loc 5</option>
                        </select></td>
                        <td><select class='required' id='serial1' name='serial[1]' >
                        <option value=''>Select Serial</option>
                        <option value='1'>Serial 1</option>
                        <option value='2'>Serial 2</option>
                        <option value='3'>Serial 3</option>
                        <option value='4'>Serial 4</option>
                        <option value='5'>Serial 5</option>
                        </select></td>                                  

                        <td><button class="remove">Remove</button></td>
                    </tr> 

            </tbody>     
        </table> 
        <input class="buttons" type="submit" name="Submit" value="Submit" /> 
        </form> 
    </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:18:55.190

首先，对于事件处理，我将使用委托而不是实时，以便您可以在指定容器中定义事件：http: [//api.jquery.com/delegate/](http://api.jquery.com/delegate/)

您可以使用以下方法动态添加按钮：

```
$('<button class="dynamic-button">my button</button>').appendTo($('#row_1'));

$('#mycontainer').delegate('.dynamic-button', 'click', function() {

    $(this).parent().append('<select><option>my dynamic drop down</option></select>');    

}); 
```

# galleria - 如何在 drupal 中 gzip 压缩 Galleria javascript？

> ID：12412280
> 
> 赞同：1
> 
> 时间：2012-09-13T18:10:36.963
> 
> 标签：galleria, pagespeed

我有一个 Drupal 7 网站，我正在尝试根据[这个网站](http://www.webpagetest.org)进行优化，除了“压缩文本”，我有一个“C”之外的所有内容都有 A。这是它的报告：

```
GZIP encode all appropriate text assets: 79/100
119.1 KB total in compressible text, target size = 94.4 KB - potential savings = 24.7 KB

FAILED - (7.7 KB, compressed = 1.9 KB - savings of 5.8 KB) - /sites/all/libraries/galleria/themes/azur/galleria.azur.css
FAILED - (4.5 KB, compressed = 2.0 KB - savings of 2.5 KB) - /sites/all/libraries/galleria/themes/azur/galleria.azur.min.js 
```

我将如何将 Galleria 配置为在 drupal 环境中进行 gzip 压缩？我正在使用 boost 模块和一些自定义的 .htaccess 规则。

谢谢！

# c# - 在哪里可以找到可重用的 ASP.NET MVC UI 组件？

> ID：12412281
> 
> 赞同：0
> 
> 时间：2012-09-13T18:10:56.620
> 
> 标签：c#, asp.net-mvc

我是 MVC 的新手，仍在适应 WebForms 的剧烈转变。[当我发现http://nuget.org/packages/TinyMCE.JQuery](http://nuget.org/packages/TinyMCE.JQuery)是一个安装 HTML 编辑器组件的 nuget 包时，我发现现成组件的想法并没有完全消失，我有点高兴需要添加一个 UIHint 属性来使用它。

我的问题是我在哪里可以找到更多这样的东西，这将帮助我更接近我习惯使用 WebForms/AjaxToolkit 的效率水平（尽管我显然需要继续学习 MVC 最佳实践）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:00:06.013

MVC 的好处是您不需要服务器控件，您现在可以自由使用任何 HTML/CSS/JS

如果你想要一些有凝聚力的东西，试试： [http ://www.kendoui.c​​om/web.aspx](http://www.kendoui.com/web.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:17:10.097

NuGet 中有很多东西，只需在 NuGet.org 上搜索即可

# php - 构建 SQL 查询 - 返回一些行一次，一些不返回

> ID：12412285
> 
> 赞同：0
> 
> 时间：2012-09-13T18:11:17.350
> 
> 标签：php, mysql, select, userid

我需要构建一个超出我编程能力的 SQL 查询。好的，这是我的要求：

假设我有一个表，其中包含：id、**user_id**、**email**和**amount**列。这个查询，应该只 SELECT **user_id**一次！如果我匹配了一次 user_id，查询将继续，但如果在另一行再次匹配相同的 user_id，我们应该跳过它。

主要问题来了……

想象一下，我们抓取了一次 user_id，并跳过了具有该 user_id 的所有其他行，现在我需要对同一 user_id的**数量**列中的所有内容**求和。**

 **我想我有点复杂了，我会尝试说明我的问题：

![我的问题的插图](../Images/bad400bf5f05091f9601ba354e9fb6d9.png)

如果仅通过 SQL 无法解决此问题，那么 PHP 答案也可以。

我正在尝试创建一个用户列表（没有重复的用户）并添加他们支付的金额。

根据图片，**user_id *56***支付**90.00** (12 + 45 + 33)

有人可以告诉我如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:13:14.123

假设表的名称是`users`

```
SELECT user_id, email, SUM(amount) FROM users GROUP BY user_id 
```**

# apache - cURL - 打开服务器根目录之外的文件

> ID：12412289
> 
> 赞同：0
> 
> 时间：2012-09-13T18:11:45.583
> 
> 标签：apache, curl

我想知道，如何访问服务器**根目录之外的**文件？

例如，/home/username/FILE.mp3

我目前用来打开文件的代码如下：

```
<?php
$location = "ABSOLUTE-PATH/FILE.mp3";

$ch = curl_init($location);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_FILETIME, true);
$data = curl_exec($ch);
$timestamp = curl_getinfo($ch, CURLINFO_FILETIME);
curl_close($ch);
if ($data === false) {
  echo 'CURL Failed';
  exit;
}
//Get file size
if (preg_match('/Content-Length: (\d+)/', $data, $matches)) {
  $contentLength = (int)$matches[1];
}

$begin  = 0;
$end    = $contentLength - 1;

if (preg_match('/bytes=\h*(\d+)-(\d*)[\D.*]?/i', $_SERVER['HTTP_RANGE'], $matches))
{
    $begin  = intval($matches[1]);
    if (!empty($matches[2]))
    {
        $end    = intval($matches[2]);
    }
}

if (isset($_SERVER['HTTP_RANGE']))
{ header('HTTP/1.1 206 Partial Content'); }
else
{ header('HTTP/1.1 200 OK'); }

header('Accept-Ranges: bytes');
header('Content-Length: ' . $contentLength);
header("Content-Range: bytes $begin-$end/$contentLength");
header('Content-Type: audio/mpeg');
header('Cache-Control: public, must-revalidate, max-age=0');

if ($timestamp != -1) { //otherwise unknown
    header("Last-Modified: " . gmdate("D, d M Y H:i:s", $timestamp) . " GMT");
}

ob_clean();
flush();
echo ($data);
exit;
?> 
```

我知道 cURL 不适用于相对路径，我假设根目录之外的文件被视为相对链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:15:01.470

为什么要使用 cURL？通常，cURL 将是您用来通过 HTTP 与不同服务器通信的东西。为什么不使用`file`,`file_get_contents`或`fopen`类似的？

# .htaccess - 使用 .htaccess 删除 URL 的最后一个字符

> ID：12412290
> 
> 赞同：0
> 
> 时间：2012-09-13T18:11:57.463
> 
> 标签：.htaccess, mod-rewrite

不知何故，谷歌设法在我的网站上获取了一些带有 ) 的 URL，这导致了一堆 404 链接。链接看起来像这样：

> “http://mysite.com/page.php?id=42523”

但谷歌在其搜索结果中的内容是：

> “http://mysite.com/page.php?id=42523)”

.htaccess 有没有一种方法可以确定 url 是否以 ) 结尾并将其重定向到正确的 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:14:46.480

尝试将其放入文档根目录的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^(.*)\)$
RewriteRule ^(.*)$ /$1?%1 [L,R=301] 
```

# css - Google Chrome 中的边距折叠不同于其他浏览器元素

> ID：12412294
> 
> 赞同：3
> 
> 时间：2012-09-13T18:12:27.707
> 
> 标签：css, html, google-chrome, margin

我终于找出了问题的原因，但我无法确定解决方案，因此需要您的帮助！

我正在尝试设置按钮的样式，它在 FireFox 和 Internet Explorer 中看起来很棒，但在 Chrome 中却不行！我在这里使用负边距，但即使它们是正边距，问题仍然存在。

这是代码，简化以说明问题：

```
<div style="display: inline-block;">
    <span style="display: block; margin: -20px; width: 100px; height: 100px;"> div </span>
</div> <!-- DIV works the same in all browsers -->

<button style="display: inline-block;">
    <span style="display: block; margin: -20px; width: 100px; height: 100px;"> button </span>
</button> <!-- BUTTON ignores margins in Chrome only --> 
```

​ 这是 FireFox 中的预期结果：

![预期的](../Images/40cd794384038be440401f101b93dd8c.png)

这是我在 Chrome 中看到的问题：

![实际在 Chrome](../Images/60912bfe03a2c23621c625f9871dd62e.png)

自己看：http: [//jsfiddle.net/ScottRippey/SZV45/13/](http://jsfiddle.net/ScottRippey/SZV45/13/)

在我看来，边缘被忽略了。但是，我似乎无法禁用按钮的边距折叠！
我试过了：`display: inline-block; position: absolute; margin: 1px; padding: 1px; border: 1px solid white;`

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:05:33.747

丢弃负数`margin`，将`width`/移动`height`到`.button`（并调整为`margin`），然后`position`改用（[示例](http://jsfiddle.net/SZV45/17/)）：

```
<div class="button">
    <span class="inner"> div </span>
</div>

<button class="button">
    <span class="inner"> button </span>
</button> 
```

```
.button {
    display: inline-block;
    background: rgba(255,0,0,0.5);
    border: none;
    padding: 0;
    margin: 20px;
    position: relative;
    width: 60px;
    height: 60px;
    vertical-align: top;
}
.inner {
    display: block;
    background: rgba(0,0,255,0.5);
    position: absolute;
    top: -20px;
    bottom: -20px;
    left: -20px;
    right: -20px;
} 
```

# iis - 子文件夹的 IIS 7 重写

> ID：12412298
> 
> 赞同：1
> 
> 时间：2012-09-13T18:12:36.377
> 
> 标签：iis, iis-7, url-rewriting, rewrite

我正在尝试为子文件夹设置一些重写规则。

**例子**

重定向以下

*   /一些文件夹
*   /某个文件夹/

至

*   /somefolder/default.aspx

> ```
> <rewrite>
>             <rules>
>                 <rule name="Some Folder">
>                     <match url="^/somefolder$" />
>                     <action type="Rewrite" url="/Somefolder/default.aspx" />
>                 </rule>
>             </rules>
>         </rewrite> 
> ```

# c++ - 必须将文件编译为不同扩展类型的原因

> ID：12412300
> 
> 赞同：1
> 
> 时间：2012-09-13T18:12:50.920
> 
> 标签：c++, gcc, g++, mingw, gnu

最近我不得不在我正在处理的 sqlite 程序的 makefile 中使用这个命令：

```
gcc -g -c sqlite3.c -o sqlite3.o
g++ -g -c main.cpp -o main.o
g++ sqlite3.o main.o -o sqliteex 
```

我必须直接将 sqlite3.c 文件编译到我的程序中才能使用 sqlite3.h 接口（包含在带有#include SQL/sqlite3.h 的 main.cpp 文件中）。但是为什么我需要使用 gcc 来执行此操作并创建 sqlite3.o，然后将这两个文件作为 .o 文件编译到我的可执行文件中？

编辑：我的猜测是 gcc 和 g++ 都可以编译 .o 文件，如果是这种情况，总是将东西编译为 .o 文件是一个好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:26:33.177

> 但是为什么我需要使用 gcc 来执行此操作并创建 sqlite3.o，然后将这两个文件作为 .o 文件编译到我的可执行文件中？

你*不需*要这样做。您*这样*做的原因是指定 sqlite.c 是**C**代码而不是**C++**代码。你可以这样做：

```
g++ main.cpp -x c sqlite3.c -o sqliteex 
```

此外，有可能（但完全不确定）sqlite 代码可以编译为 C++，如下所示：

```
g++ main.cpp sqlite3.c -o sqliteex 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:18:42.570

引用自维基百科：

单一编译单元是一种针对 C/C++ 语言的计算机编程技术，它可以减少编译时间并帮助编译器执行程序优化，即使编译器本身缺乏对整个程序优化或预编译头文件的支持。

[http://en.wikipedia.org/wiki/Single_Compilation_Unit](http://en.wikipedia.org/wiki/Single_Compilation_Unit)

开发主要是编辑->编译直到成功循环。当您有单独编译的文件时，您可以只重新编译已修改的文件，这使得重建速度更快。最后一行不是编译，而是将编译的目标文件链接到目标可执行文件。

同样正如 Mysticial 所指出的，您混合了 C 和 C++

# c# - 这个文本编辑控件是如何完成的？

> ID：12412303
> 
> 赞同：1
> 
> 时间：2012-09-13T18:12:59.320
> 
> 标签：c#, .net, visual-studio-2010

在 VS2010 中，当您编辑标签组件的文本时，会出现一个弹出窗口，以多行格式显示整个文本。有谁知道这个弹出式多行文本编辑框是如何完成或调用的？我想在我正在创建的 C# 程序中执行此操作。

可以在[此处](http://www.pkhlineworks.ca/screenshot.jpg)找到屏幕截图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:18:35.860

它被称为工具提示 - 可以在[此处找到文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.aspx)

**更新：**

要进行编辑，请参阅使用[MultiLineStringEditor的](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.multilinestringeditor.aspx)[这篇](https://channel9.msdn.com/Forums/TechOff/449554-Text-Box-Style-Multiline-Property-Grid-Text)文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:49:29.970

如果您在属性表中谈论多行文本编辑器，这是属性网格的一部分，而不是独立的 IFAIK。

# visual-studio-2012 - 如何在Visual Studio 2012中设置默认折叠的所有代码块

> ID：12412304
> 
> 赞同：3
> 
> 时间：2012-09-13T18:13:00.230
> 
> 标签：visual-studio-2012

在 vs2010 中有一个大纲选项来设置所有代码块默认显示为折叠。在 vs2012 中有什么方法可以做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T22:55:50.533

不作为默认值。

我知道这是一种解决方法，但由于 Visual Studio 在关闭和重新打开文件时保留大纲的折叠/展开状态，您可以使用大纲 -> 折叠到定义命令在打开文件时快速折叠文件并且状态将被保留下次打开该文件时。如果您使用键盘快捷方式，它会很快完成并且不那么烦人。

如果那太痛苦了，您可能需要找到一个可以做您想做的事情的扩展程序，尽管我目前还没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:40:44.920

这不是默认可用的，但是您可以在编辑代码文件时按+`CTRL` 以折叠所有内容。`M``O`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-05T16:04:25.680

[从MSDN](https://social.msdn.microsoft.com/Forums/vstudio/en-US/4a694c02-f930-4787-a231-9b6932cb6121/collapse-to-defintions-by-default-ie-open-files-already-collapsed-to-defintions?forum=vseditor)看一下这个解决方法（虽然只适用于 VS2012）。

> **您能否通过单击工具->宏->宏 IDE**打开 marco IDE。
> 
>  **您可以在项目 MyMacros 中找到一个名为 EnvironmentEvents 的模块。
> 
> 那么您能否尝试在 EnvironmentEvents 中添加此代码？**

 **```
Private opened As Boolean

Private Sub WindowEvents_WindowActivated(ByVal GotFocus As EnvDTE.Window, ByVal LostFocus As EnvDTE.Window) Handles WindowEvents.WindowActivated
    If GotFocus.Document Is Nothing Then
        Return
    End If
    If GotFocus.Document.FullName.EndsWith(".cs") And opened = True Then
        DTE.ExecuteCommand("Edit.CollapsetoDefinitions")
    End If
    opened = False
End Sub

Private Sub DocumentEvents_DocumentOpened(ByVal Document As EnvDTE.Document) Handles DocumentEvents.DocumentOpened
    opened = True
End Sub 
```**

# javascript - 如果我将显示更改为阻止，表格不会占用 100%

> ID：12412306
> 
> 赞同：0
> 
> 时间：2012-09-13T18:13:07.147
> 
> 标签：javascript, html, dom, internet-explorer-7

我有一个非常简单的html：

```
 <table id="root" >
        <tr>
        <th>Version</th>
        <th>User Id</th>
        <th>Operation Type</th>
        <th>Time</th>
        </tr>
        <tr>
        <td>390</td>
        <td>vr32090</td>
        <td>U</td>
        <td>2012-09-12 19:41:19:129</td>
        </tr>
        <tr>
        <td>389</td>
        <td>vr32090</td>
        <td>U</td>
        <td>2012-09-12 19:41:04:554</td>
        </tr>
    </table>

<style>

#root {
    width:100%;
}

</style>

<script>
    document.getElementById("root").style.display = "block";
</script> 
```

如果我注释掉脚本部分，表格按照样式占用 100%，但如果执行脚本，表格只占用所需的空间。我该如何解决？我需要脚本，它是更复杂页面的一部分，我尽可能简单地说明问题。

PS 好的，这可以通过设置 display = "table" 来解决。问题是我需要在 IE7 中使用它，它不支持这种显示类型。我该怎么做才能使其在 IE7 中也达到 100%？

# windows - 在 Mac 上传输本地 git repo

> ID：12412316
> 
> 赞同：3
> 
> 时间：2012-09-13T18:13:40.223
> 
> 标签：windows, macos, git, shared, repository

我正在开发一个 iOS 项目。我刚刚在 Mac 上为我的项目创建了一个本地存储库。由于某些原因，我必须将其传输到 Windows 机器以将其放置在共享文件夹中。我无法从我的 Mac 访问该共享驱动器。

如何继续创建可以共享的存储库？我正处于将所有代码都提交到本地仓库中的地步。请指教..

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:19:48.597

你有几种可能：

*   只需将 repo 复制到 USB 密钥或外部磁盘，然后传输到 PC。Git repos 总是可以传输的，你不需要做任何特别的事情：磁盘上的格式总是一样的。尽管您可能会遇到文件编码（Windows 或 UTF-8）的一些问题：最好将两个 git 都配置为使用 UTF-8。或者，您可以压缩您的 repo 文件夹并将其解压缩到 PC 上。
*   上传到保管箱或类似的文件传输服务。和上面一样。
*   在 github 或类似的公共 git 服务上共享代码。这是迄今为止最好的选择，尽管（如果代码不是开源许可证）它可能会花钱。上传到github，PC端下载。

希望这可以帮助。

# python - Python类返回值

> ID：12412324
> 
> 赞同：29
> 
> 时间：2012-09-13T18:14:08.440
> 
> 标签：python, class, return

我正在尝试创建一个返回值而不是自我的类。

我将向您展示一个与列表进行比较的示例：

```
>>> l = list()
>>> print(l)
[]
>>> class MyClass:
>>>     pass

>>> mc = MyClass()
>>> print mc
<__main__.MyClass instance at 0x02892508> 
```

我需要 MyClass 返回一个列表，`list()`而不是实例信息。我知道我可以创建列表的子类。但是有没有办法在没有子类的情况下做到这一点？

我想模仿一个列表（或其他对象）：

```
>>> l1 = list()
>>> l2 = list()
>>> l1
[]
>>> l2
[]
>>> l1 == l2
True
>>> class MyClass():
def __repr__(self):
    return '[]'

>>> m1 = MyClass()
>>> m2 = MyClass()
>>> m1
[]
>>> m2
[]
>>> m1 == m2
False 
```

为什么是`m1 == m2`假的？这就是问题。

如果我没有回复你们所有人，我很抱歉。我正在尝试你给我的所有解决方案。我不能使用`def`，因为我需要使用 setitem、getitem 等函数。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-13T19:08:15.507

我认为您对正在发生的事情感到非常困惑。

在 Python 中，一切都是对象：

*   `[]`（列表）是一个对象
*   `'abcde'`（字符串）是一个对象
*   `1`（整数）是一个对象
*   `MyClass()`（一个实例）是一个对象
*   `MyClass`（一个类）也是一个对象
*   `list`（一个类型——很像一个类）也是一个对象

它们都是“价值”，因为它们是事物而不是指称事物的名称。（变量是引用值的名称。）值与 Python 中的对象没有什么不同。

当您调用一个类对象（如`MyClass()`or `list()`）时，它会返回该类的一个实例。（`list`实际上是一个类型而不是一个类，但我在这里简化了一点。）

当您*打印*一个对象（即获取一个对象的字符串表示）时，会调用该对象的[`__str__`或`__repr__`魔术方法](http://www.rafekettler.com/magicmethods.html#representations)并打印返回值。

例如：

```
>>> class MyClass(object):
...     def __str__(self):
...             return "MyClass([])"
...     def __repr__(self):
...             return "I am an instance of MyClass at address "+hex(id(self))
... 
>>> m = MyClass()
>>> print m
MyClass([])
>>> m
I am an instance of MyClass at address 0x108ed5a10
>>> 
```

所以你所要求的，“我需要 MyClass 返回一个列表，比如 list()，而不是实例信息，”没有任何意义。 `list()`返回一个列表实例。`MyClass()`返回一个 MyClass 实例。如果你想要一个列表实例，只需获取一个列表实例。如果问题是这些对象在您使用*它们或在控制台中查看它们**时是什么样子`print`*，那么创建一个`__str__`and`__repr__`方法来表示它们，因为您希望它们被表示。

## 更新关于平等的新问题

再一次，`__str__`并且`__repr__`仅用于*打印*，不以任何其他方式影响对象。仅仅因为两个对象具有相同的`__repr__`值并不意味着它们相等！

`MyClass() != MyClass()`因为你的类没有定义它们如何相等，所以它回退到默认行为（`object`类型），即对象只等于它们自己：

```
>>> m = MyClass()
>>> m1 = m
>>> m2 = m
>>> m1 == m2
True
>>> m3 = MyClass()
>>> m1 == m3
False 
```

如果要更改此设置，请使用[比较魔术方法之一](http://www.rafekettler.com/magicmethods.html#comparisons)

例如，您可以拥有一个等于一切的对象：

```
>>> class MyClass(object):
...     def __eq__(self, other):
...             return True
... 
>>> m1 = MyClass()
>>> m2 = MyClass()
>>> m1 == m2
True
>>> m1 == m1
True
>>> m1 == 1
True
>>> m1 == None
True
>>> m1 == []
True 
```

我认为你应该做两件事：

1.  看看[这个在 Python 中使用魔法方法的指南](https://rszalski.github.io/magicmethods/)。
2.  `list`如果您想要的非常类似于列表，请证明您为什么不进行子类化。如果子类化不合适，您可以委托给一个包装的列表实例：

    ```
    class MyClass(object):
        def __init__(self):
            self._list = []
        def __getattr__(self, name):
            return getattr(self._list, name)

        # __repr__ and __str__ methods are automatically created
        # for every class, so if we want to delegate these we must
        # do so explicitly
        def __repr__(self):
            return "MyClass(%s)" % repr(self._list)
        def __str__(self):
            return "MyClass(%s)" % str(self._list) 
    ```

    现在这将像一个列表而不是一个列表（即，没有子类化`list`）。

    ```
    >>> c = MyClass()
    >>> c.append(1)
    >>> c
    MyClass([1]) 
    ```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-09-13T18:49:31.420

如果你想要的是一种将你的类变成一种没有子类化的列表`list`的方法，那么只需创建一个返回列表的方法：

```
def MyClass():
    def __init__(self):
        self.value1 = 1
        self.value2 = 2

    def get_list(self):
        return [self.value1, self.value2...]

>>>print MyClass().get_list()
[1, 2...] 
```

如果您的意思是`print MyClass()`打印一个列表，只需覆盖`__repr__`：

```
class MyClass():        
    def __init__(self):
        self.value1 = 1
        self.value2 = 2

    def __repr__(self):
        return repr([self.value1, self.value2]) 
```

编辑：我看到你的意思是如何让对象**比较**。为此，您覆盖该`__cmp__`方法。

```
class MyClass():
    def __cmp__(self, other):
        return cmp(self.get_list(), other.get_list()) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-06-14T04:00:27.287

用于`__new__`从类返回值。

正如其他人所建议的那样`__repr__`，`__str__`甚至`__init__`（以某种方式）可以给您想要的东西，但是`__new__`对于您的目的而言，这将是一个语义上更好的解决方案，因为您希望返回实际对象而不仅仅是它的字符串表示形式。

阅读此答案以了解更多信息`__str__`和`__repr__` [https://stackoverflow.com/a/19331543/4985585](https://stackoverflow.com/a/19331543/4985585)

```
class MyClass():
    def __new__(cls):
        return list() #or anything you want

>>> MyClass()
[]   #Returns a true list not a repr or string 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-10-26T02:23:26.977

```
class MyClass():
    def __init__(self, a, b):
        self.value1 = a
        self.value2 = b

    def __call__(self):
        return [self.value1, self.value2] 
```

测试：

```
>>> x = MyClass('foo','bar')
>>> x()
['foo', 'bar'] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-09-13T18:31:26.697

您正在描述一个函数，而不是一个类。

```
def Myclass():
    return [] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-11T23:30:37.513

对我来说有效的命题是`__call__`在创建小数字列表的课堂上：

```
import itertools

class SmallNumbers:
    def __init__(self, how_much):
        self.how_much = int(how_much)
        self.work_list = ['₀', '₁', '₂', '₃', '₄', '₅', '₆', '₇', '₈', '₉']
        self.generated_list = ['₀', '₁', '₂', '₃', '₄', '₅', '₆', '₇', '₈', '₉']
        start = 10
        end = 100
        for cmb in range(2, len(str(self.how_much)) + 1):
            self.ListOfCombinations(is_upper_then=start, is_under_then=end, combinations=cmb)
            start *= 10
            end *= 10

    def __call__(self, number, *args, **kwargs):
        return self.generated_list[number]

    def ListOfCombinations(self, is_upper_then, is_under_then, combinations):
        multi_work_list = eval(str('self.work_list,') * combinations)
        nbr = 0
        for subset in itertools.product(*multi_work_list):
            if is_upper_then <= nbr < is_under_then:
                self.generated_list.append(''.join(subset))
                if self.how_much == nbr:
                    break
            nbr += 1 
```

并运行它：

```
if __name__ == '__main__':
        sm = SmallNumbers(56)
        print(sm.generated_list)
        print(sm.generated_list[34], sm.generated_list[27], sm.generated_list[10])
        print('The Best', sm(15), sm(55), sm(49), sm(0)) 
```

结果

```
['₀', '₁', '₂', '₃', '₄', '₅', '₆', '₇', '₈', '₉', '₁₀', '₁₁', '₁₂', '₁₃', '₁₄', '₁₅', '₁₆', '₁₇', '₁₈', '₁₉', '₂₀', '₂₁', '₂₂', '₂₃', '₂₄', '₂₅', '₂₆', '₂₇', '₂₈', '₂₉', '₃₀', '₃₁', '₃₂', '₃₃', '₃₄', '₃₅', '₃₆', '₃₇', '₃₈', '₃₉', '₄₀', '₄₁', '₄₂', '₄₃', '₄₄', '₄₅', '₄₆', '₄₇', '₄₈', '₄₉', '₅₀', '₅₁', '₅₂', '₅₃', '₅₄', '₅₅', '₅₆']
₃₄ ₂₇ ₁₀
The Best ₁₅ ₅₅ ₄₉ ₀ 
```

# java - 表达式java的非法启动

> ID：12412326
> 
> 赞同：2
> 
> 时间：2012-09-13T18:14:10.593
> 
> 标签：java, compiler-construction

我知道这对某人来说真的很简单，我不明白为什么编译器会抱怨这个。我一直在寻找一些答案，我能找到的只是一个括号问题，但我认为这不是我的问题。我是 Java 新手，所以任何帮助都会很棒。这是应该是基本累加器程序的代码。

```
public class BasicAccumulator implements Accumulator {
  {
    private int digit;
    private int value;

  }

  public int basicAccumulator(int digit, int value)
  {
    digit = 0;
    value = 0;
  }

  public void addDigit(int digit);
  {
    digit = digit + value;
  }

  public void plus();
  {
    value = digit + digit;
  }

  public void minus();
  {
    value = digit - digit;
  }

  public void clear();
  {
    value = 0;
  }

  public int displayValue();
  {
    return value;
  }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:14:34.800

```
public void plus(); 
```

删除分号。它应该是：

```
public void plus()
{ ...
} 
```

`displayValue()`,minus(), clear() 也一样。它应该是：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:39:27.653

我将直接在您的代码中发表我的评论：

```
public class BasicAccumulator implements Accumulator {

    //I'd delete this brackets and leave just the private declarations initialized
    //in zero.
    {
        private int digit;
        private int value;    
    }

    //I'm making this an initializing constructor by using the parameters
    //it defines. If you want both digit and value to be set to 0 (or any other value
    //by default) you can make a no argument constructor and invoke it.
    public BasicAccumulator(int digit, int value)
    {
        this.digit = digit;
        this.value = value;
    }

    public void addDigit(int digit); //This semicolon is wrong. Delete it.
    {
        digit = digit + value;
    }

    public void plus(); //This semicolon is wrong. Delete it.
    {
        value = digit + digit;
    }

    public void minus(); //This semicolon is wrong. Delete it.
    {
        value = digit - digit;
    }

    public void clear(); //This semicolon is wrong. Delete it.
    {
        value = 0;
    }

    public int displayValue(); //This semicolon is wrong. Delete it.
    {
        return value;
    }

} 
```

我不知道这是一个例子还是什么，但逻辑也有一些问题，但我会把这些留给你（`minus`特别是方法，因为它总是将值设置为 0）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:17:35.747

```
public void plus();
public void minus();
public void clear();
public int displayValue(); 
```

**上面的代码行是错误..**

```
public void plus();
{
    value = digit + digit;
} 
```

让它变成这样……

```
public void plus()
{
    value = digit + digit;
} 
```

对其余方法执行此操作.....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:24:35.387

您发布的代码存在三个问题。

1.  在所有方法之后都有分号。只有当你有一个抽象方法（`abstract`在抽象类或接口中声明）时才使用它。
2.  看起来您尝试在初始化程序块中创建`digit`和。`value`拆下它们周围的支架。
3.  构造函数不返回值，因此返回类型永远不会包含在其签名中。你有`public int basicAccumulator`，但应该只是`public BasicAccumulator`. 另外，请注意区分大小写。

这是您的固定代码：

```
public class BasicAccumulator implements Accumulator {

    private int digit;
    private int value;

    public BasicAccumulator(int digit, int value) {
        digit = 0;
        value = 0;
    }

    public void addDigit(int digit) {
        digit = digit + value;
    }

    public void plus() {
        value = digit + digit;
    }

    public void minus() {
        value = digit - digit;
    }

    public void clear() {
        value = 0;
    }

    public int displayValue() {
        return value;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T18:19:18.117

在函数 addDigit、加号、减号、清除和下面两个的签名之后，这些分号在做什么？删除它们。这将完成这项工作

# c - 发送功能如何工作

> ID：12412329
> 
> 赞同：1
> 
> 时间：2012-09-13T18:14:26.597
> 
> 标签：c, sockets, network-programming, send

我正在使用`ssize_t send(int sockfd, const void *buf, size_t len, int flags);`文件`socket.h`。我对此有些怀疑。

**疑问1**：如果假设我传递给的字符串`send`是长度`10`，而我在第三个参数中指定的长度是`15`。那么什么`send`只会发送 10 个字符或者它将发送 15 个字符（它通过读取最后 5 个字符的未分配内存来获得）。
在相反的情况下会发生什么意味着如果第二个参数的长度大于第三个参数。

**疑问2**：我假设第二个参数的长度等于第三个参数。现在，如果第二个参数是 - `"abc\0def\0qw"`。它的长度是 11。将`send`发送整个字符串或`\0`有任何效果。我认为它会发送整个字符串。发送的真正效果如何。

如果有人知道任何好的来源`send`，`recv`请深入讨论这些功能，请分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:16:56.167

*   该函数`send`将尝试发送与您告诉它的一样多的内容。如果缓冲区足够大，没有什么特别的事情发生。如果不是，则未定义会发生什么：它可能会发送垃圾，可能会崩溃，或者它可能会做任何其他事情

*   该函数`send`不关心缓冲区内容 - 它只关心要写入的指定字节数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:16:45.223

`send`对以 NUL 结尾的字符串一无所知（参数类型中有一条线索 - 它需要 a`void*`而不是 a `char*`）。

它只是从你给它的地址发送你给它的字节数。如果这意味着读取未分配的内存，那么它就会这样做，可能会在进程中崩溃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:18:24.393

该`send`函数对“字符串”一无所知。如果您给它一个指针，并告诉它在该指针之后发送接下来的 15 个字节，那么这正是*它将*尝试做的事情。（如果你给它一个不合适的值，你很可能会遇到**Seg-Fault**`len`或类似的问题）。

没有理由相信它会因为找到一个具有 value 的字节而停止`0x00`。毕竟，许多网络协议`0x00`到处都是。`send`每次碰巧找到该值时，您都不能停下来。

# ms-access - 复杂的嵌套 if 语句

> ID：12412336
> 
> 赞同：0
> 
> 时间：2012-09-13T18:15:01.773
> 
> 标签：ms-access, ms-access-2007

我希望有人可以修改我现有的查询，并根据下面列出的 2 个条件为我提供复制和粘贴的 SQL。非常感谢你，纳撒尼尔

**条件#1**。比较以下 3 个字段的值，输出 3 个字段的最小值（不包括空值）：

“最低标价”
“最低售价”
“lining_price_exception”

例如：如果“最低标价”= 3，“最低售价”=7，“lining_price_exception”=null，则输出应为 3。

**条件#2**。如果“overide_price”字段中的值不为空，则“overide_price”字段应替换条件 #1 的输出。如果“overide_price”中的值为空，则输出条件#1 中的值。

```
SELECT q.Part_ID, q.[lowest list price], q.[lowest price sold], 
       q.lining_price_exception, q.overide_price
FROM qry_to_determine_wmx_price_01 AS q; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:07:50.517

This should be complicated enough for you. Here is tested SQL no need to define any VBA methods which meets both criteria:

```
Select q.Part_ID, 
           q.[lowest list price], 
           q.[lowest price sold], 
           q.lining_price_exception, 
           q.overide_price,
           NZ(q.overide_price,
                 IIf(q.[lowest list price]<q.[lowest price sold] OR ISNULL(q.[lowest price sold]),
                       IIf(q.[lowest list price]<q.lining_price_exception or ISNULL(q.lining_price_exception),
                             NZ(q.[lowest list price],"No valid Price listed"),
                             q.lining_price_exception
                          ),
                       IIf(q.[lowest price sold]<q.lining_price_exception or ISNULL(q.lining_price_exception),
                             NZ(q.[lowest price sold],"No valid Price listed"),
                             q.lining_price_exception
                          )
                    )
                 ) as Actual_Low_Price        
from qry_to_determine_wmx_price_01 as q; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:52:57.927

如果您将从 Access 会话中运行查询，则可以使用自定义 VBA 函数来简化此操作。

`MinValue()`在立即窗口中测试功能...

```
? MinValue(4, Null, 2)
 2 
? MinValue(Null, Null, 2)
 2 
? MinValue(Null, Null, Null)
Null 
```

因此，您可以在这样的查询中处理您的**条件#1** ...

```
SELECT
    MinValue(
        q.[lowest list price],
        q.[lowest price sold], 
        q.lining_price_exception
    ) AS lowest_value
qry_to_determine_wmx_price_01 AS q; 
```

至于您的**条件#2**，我认为该`Nz()`功能会很有用。

```
Nz(q.overide_price, MinValue(q.[lowest list price], q.[lowest price sold],
q.lining_price_exception)) 
```

基本上，该`Nz()`表达式表示“`overide_price`如果不是 Null，则返回，否则从`MinValue()`表达式中返回值”。

这就是我提到的功能。

```
Public Function MinValue(ParamArray pValues() As Variant) As Variant
    Dim i As Long
    Dim iUbound As Long
    Dim varMin As Variant
    iUbound = UBound(pValues)
    varMin = Null
    For i = 0 To iUbound
        If Not IsNull(pValues(i)) Then
            If Not IsNull(varMin) Then
                If pValues(i) < varMin Then
                    varMin = pValues(i)
                End If
            Else
                varMin = pValues(i)
            End If
        End If
    Next
    MinValue = varMin
End Function 
```

# php - 使用 DOM 或 SIMPLE XML 修改 xml 节点？

> ID：12412338
> 
> 赞同：0
> 
> 时间：2012-09-13T18:15:18.620
> 
> 标签：php, xml, dom

我在这里有源 XML：http: [//www.grilykrby.cz/rss/pf-heureka.xml](http://www.grilykrby.cz/rss/pf-heureka.xml)。我想使用这个 xml 提要并在我自己的服务器上创建另一个修改。我想更改包含单词 Prislusenstvi 的每个节点 CATEGORYTEXT。我只是尝试了一些东西，但我只得到了所有类别的列表而没有更改 XML :-( **这是我的代码示例。**行 $kategorie="nejaka kategorie"; 不起作用。

```
<?php
$file = "http://www.grilykrby.cz/rss/pf-heureka.xml";
$xml=simplexml_load_file($file);
foreach ($xml->xpath('//SHOPITEM/CATEGORYTEXT') as $kategorie) {
echo $kategorie."<br />";
$kategorie="nejaka kategorie";
}
file_put_contents('test.xml', $xml->asXML()); 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:18:29.833

`$kategorie`只是循环中使用的临时变量，其中包含 xpath 查询返回的数据的副本。您需要直接在`$xml`对象中实际设置值。

在将 XML 内容解析为 simpleXML 对象之前，我个人也会考虑在 XML 内容本身内执行`str_replace`or 。`preg_replace`

**最终接受的答案**

```
<?php
$xml = simplexml_load_file('http://www.grilykrby.cz/rss/pf-heureka.xml');
$i=0;
foreach($xml -> SHOPITEM as $polozka) {
    if ($polozka -> CATEGORYTEXT == "Příslušenství") $xml -> SHOPITEM[$i] -> CATEGORYTEXT = "Some other text";
    $i++;
}
?> 
```

# android - 将 ImageButton 连接到可绘制背景中的屏幕边缘

> ID：12412339
> 
> 赞同：0
> 
> 时间：2012-09-13T18:15:18.513
> 
> 标签：android, xml, layout, button

试图让左上角的空白区域触摸屏幕边缘，但无法弄清楚我做错了什么。我不希望左边出现绿色，我希望白色覆盖它。

![在此处输入图像描述](../Images/d74913e8e013b98c2a64487f9c96ad46.png)

按钮代码：

```
<ImageView
    android:id="@+id/itempicture"
    android:layout_width="0dp"
    android:layout_height="fill_parent"
    android:layout_weight="2"
    android:background="@drawable/profilepicture" /> 
```

DRAWABLE/PROFILEPCTURE_DEFAULT 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item><shape>
            <gradient android:type="linear" android:angle="270" android:startColor="#FFFFFF" android:centerColor="#FFFFFF" android:endColor="#424242" />

            <stroke android:width="0dp"></stroke>

            <corners android:bottomRightRadius="35dp" />

            <padding android:bottom="5dp" android:left="5dp" android:right="5dp" android:top="5dp" />
        </shape></item>

</selector> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:23:05.603

在您的 DRAWABLE/PROFILEPCTURE_DEFAULT 代码中：

你有行填充 android:bottom="5dp" android:left="5dp" android:right="5dp" android:top="5dp"。

这会在对象的所有侧面放置内部间距。

删除到 android:left="5dp" 以摆脱左侧的间距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:25:22.860

`android:paddingLeft="0dp"`为了解决这个问题，我必须通过添加到主要的 LinearLayout xml 代码来更改保存对象的 LinearLayout 的填充。这与更改可绘制对象中的填充不同，这是错误的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:19:18.340

您在左侧使用填充，尝试删除它。

# c++ - 创建室内环境的实时 2D 地图

> ID：12412341
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:15:29.357
> 
> 标签：c++, matlab

我正在使用超声波传感器来获取有关室内环境的数据，即与每面墙的距离。我想使用它绘制周围环境的实时地图，请您指导哪个软件或哪个库最适合此目的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-09T20:12:32.423

如果您使用 arduino 或 raspberry 或任何其他此类电子套件来捕获超声数据，您可以将数据发送到串行端口，然后使用 Matlab 从该串行端口读取并使用它来绘制实时地图。[Matlab Arduino org 网站上](http://www.matlabarduino.org/serial-communication.html)提供了一个很好的分步示例，说明如何做到这一点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:21:38.580

如果你想要实时地图，我会使用 Labview->embedded MATLAB code / C++。Labview 具有出色的硬件/外设支持和操作，您可以在信号流表示中嵌入自定义代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:18:01.337

试试 OpenCV。它拥有图像处理所需的一切。可能是矫枉过正，但我​​不介意。

[http://opencv.org/](http://opencv.org/)

# java - 如何在另一个类中调用一个类的主要方法？

> ID：12412353
> 
> 赞同：0
> 
> 时间：2012-09-13T18:16:24.270
> 
> 标签：java, static, main

我有一个线程，当当前应用程序关闭时，必须启动`main()`另一个类的方法。
我包含`ClassName.main(someStringArray)`在`run()`线程中，但没有调用该方法。可能出了什么问题？
**我定义的线程**：

```
private class VideoCreator extends Thread{
        public VideoCreator(){
            pathToPass = savePath + "/" + "video.mov";
            passVect.add("-w");
            passVect.add("1280");
            passVect.add("-h");
            passVect.add("800");
            passVect.add("-f");
            passVect.add("25");
            passVect.add("-o");
            passVect.add(pathToPass);
        }
        @Override
        public void run(){
            try{
                jpegFiles = Files.newDirectoryStream(Paths.get(pathToPass).getParent(),"*.jpg");
                for(Path jpegFile : jpegFiles){
                    passVect.add(jpegFile.toString());
                }
            }catch(IOException e){

            }
            try{
                JpegImagesToMovie.main((String[])passVect.toArray());
            }catch(Exception e){
                System.out.println("Dammit Error!");
                e.printStackTrace();
            }
        }
        public void cleanUp(){

        }
        String pathToPass;
        Vector<String> passVect = new Vector<>(100,200);
        DirectoryStream<Path> jpegFiles;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:29:33.140

代替

```
(String[])passVect.toArray() 
```

你应该写

```
passVect.toArray(new String[passVect.size()]) 
```

或（更短但性能更低）

```
passVect.toArray(new String[0]) 
```

原因是它[`toArray()`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#toArray%28%29)总是会返回一个数组，即使它的所有成员都是字符串`Object[]`，你也无法将其转换为数组。`String[]`（顺便说一下，相反的情况是可能的：您可以`String[]`在期望的地方传递 a `Object[]`，它被[`Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)类的各种方法使用。事实上，从`toArray()`方法返回的东西*可能*是 a `String[]`，即使在符合标准的情况下实现它不是。这就是编译器没有抱怨的原因：它不知道也不关心方法的内部，从返回类型来看，显式转换为子类的数组是可能的如果数组是这样创建的。）

[`toArray(T[])`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#toArray%28T%5B%5D%29)如果您将该类型的数组作为参数传递，则该调用将返回所需类型的数组。如果传入的参数长度正确，则直接使用；否则将分配一个新数组。出于这个原因，首先分配正确的长度将避免沿途进行一次分配。

# google-chrome - Chrome 21 上的 WebSockets

> ID：12412354
> 
> 赞同：0
> 
> 时间：2012-09-13T18:16:25.677
> 
> 标签：google-chrome, websocket

我是 WebSockets 的新手。我阅读了很多关于这个主题的信息，我正在尝试构建一个简单的服务器来处理握手部分，但仍然无法让我的服务器正常工作。客户端发送请求，服务器将响应发送回客户端，但不会触发 WebSocket 的 onopen 事件。但是如果我关闭服务器，websocket 对象会触发它的 onclose 事件。

我从 chrome 得到的请求是：

```
GET / HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: 192.168.0.164:3215
Origin: http://lalala
Sec-WebSocket-Key: MyUY7duPdE1WbGXPOslYzw==
Sec-WebSocket-Version: 13
Sec-WebSocket-Extensions: x-webkit-deflate-frame 
```

我发回的回复：

```
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: 4IVZgO4OosW/b7upp7Qbh2q6a4I= 
```

我在服务器中使用的代码：

```
static void Main(string[] args)
    {
      var listener = new TcpListener(IPAddress.Parse("192.168.0.164"), 3215);
      listener.Start();
      Console.WriteLine(">> Started.");
      var client = listener.AcceptTcpClient();
      Console.WriteLine(">> Accepted.");
      while (true)
      {
        try
        {
          var stream = client.GetStream();
          var bytes = new byte[client.ReceiveBufferSize];
          stream.Read(bytes, 0, client.ReceiveBufferSize);
          var data = Encoding.ASCII.GetString(bytes);

          Console.WriteLine(data.Remove(data.IndexOf("\0\0\0")));
          var code = data.Remove(0, data.IndexOf("Sec-WebSocket-Key:") + 19);
          code = code.Remove(code.IndexOf("==") + 2);
          var response = string.Format(@"HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: " + GetServerResponseKey(code));
          Console.WriteLine(response);
          var encodedResponse = Encoding.UTF8.GetBytes(response);
          stream.Write(encodedResponse, 0, encodedResponse.Length);
        }
        catch (IOException)
        {
          Console.WriteLine(">> Client Disconnected.");
          Console.ReadKey();
          return;
        }
      }
    }

    private static string GetServerResponseKey(string key)
    {
      var keyForHash = String.Concat(key, "258EAFA5-E914-47DA-95CA-C5AB0DC85B11");

      var encoding = new UTF8Encoding();
      var temp = encoding.GetBytes(keyForHash);

      var hashProvider = new SHA1CryptoServiceProvider();
      var keyForBase64 = hashProvider.ComputeHash(temp);

      return Convert.ToBase64String(keyForBase64);

    } 
```

和客户端脚本：

```
 <script type="text/javascript">

        var socket;
        function connect()
        {
          socket = new WebSocket('ws://192.168.0.164:3215');
          setTimeout(bindEvents, 1000);
          setReadyState();
        }

        function bindEvents() {
            socket.onopen = function() {
                alert('handshake successfully established. May send data now...');
                setReadyState();
            };
            socket.onclose = function() {
                alert('connection closed');
            };
        }

        function setReadyState() {
          console.log('ws.readyState: ' + socket.readyState);
        }
        connect();

    </script> 
```

还有一些问题：

1-有没有办法找出我的浏览器使用的协议？

2-Chrome 21 使用哪种协议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:33:40.573

您的响应需要遵循 HTTP 请求/响应的规则，并且在每个标头和末尾的一对之间有一个回车 + 换行符。我不会在响应中使用新行，而是对它们进行转义：

“标头1\r\n标头2\r\n标头3\r\n\r\n”

“Sec-WebSocket-Version: 13”标头表明浏览器正在使用协议的第 13 版，即[IETF 6455](https://www.rfc-editor.org/rfc/rfc6455)。

# c# - 使用内联逗号拆分逗号分隔的 csv 文件

> ID：12412356
> 
> 赞同：1
> 
> 时间：2012-09-13T18:16:29.733
> 
> 标签：c#, asp.net, vb.net, csv, .net

我正在使用下面的代码拆分逗号分隔的 CSV 文件。它工作正常，但文件中的某些记录在数据中包含逗号，即使逗号被保留为分隔符。例如，一条记录包含一个描述文本，其中用户输入了逗号，而我的脚本输入了喜欢该记录的结尾。我怎么能以某种方式克服呢？

这是我的 CSV 文件中的一行示例。请注意，行尾的空记录可以没有“”括起来的字符：

"1","34353434","Adam","Traxx","343","这个人是老大，请尊重处理","",,"","",,",""," 0",,"

这就是我阅读和拆分的方式：

```
Sub ReadOnlineExample()
Dim line_read As String
Dim tempfilename As String
Dim i As Integer
Dim rows_skipped As Integer
Dim line_split(0 To 125) As String
Dim MortalityRates(0 To 125) As Double

 tempfilename = "C:\MortalityRateTable.csv"
 Dim sr As New System.IO.StreamReader(tempfilename)

'Split the line into individual data
line_split = line_read.Split(",")

'Save the split data into an array
For i = 0 To UBound(line_split)
  MortalityRates(i) = line_split(i)
Next i

End Sub 
```

任何人都可以帮忙吗？也许这只是一个我看不到的简单解决方案:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:18:00.783

使用适当的 CSV 解析器 -[文件助手](http://filehelpers.sourceforge.net/)是一个流行的选项。

还有一个来自 Microsoft 的解析器 - 在`Microsoft.VisualBasic.FileIO`命名空间中，[`TextFieldParser`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx).

这些解决了大多数手动解决方案在遇到问题之前不会考虑的 CSV 的微妙方面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T16:28:31.813

您的示例可能不正确。
句后的最后一部分说：`"",,"","",,","","0",,"`

有两个基本条件：

1.  分隔符标记调用 enclosint 整个内部字符串以引用标记（如果您有`x,y`，并且分隔符是逗号，则在 CSV 中您会得到`"x,y"`）
2.  引号被转义为双引号（如果你有`They say "Hey!"`CSV 你得到`"They say ""Hey!"""`）

其他字符串将在您键入时保存。

而且你不能用这个规则转移你的最后一部分。尝试将逗号更改为分号并导入 Excel。Excel 显示您的示例如下：

![在此处输入图像描述](../Images/1b281d70b3cb41c0f7319274ba31fb34.png)

在我的国家是标准的 CSV 分隔符分号。
我编写此代码用于解析 CSV。您可以尝试根据您的目的对其进行修改（分隔符是可变的）：

```
 public List<string> ParseCsvRow(char delimiter, string input)
    {
        List<string> result = new List<string>();
        string step = "";
        bool escaped = false;
        StringBuilder stringBuilder = new StringBuilder();
        int position = -1;

        do
        {
            if (++position >= input.Length)
            {
                result.Add(stringBuilder.ToString());
                stringBuilder = null;
                break;
            }
            step = input.Substring(position, 1);
            switch (step)
            {
                case "\"":
                    if (stringBuilder.Length == 0 && !escaped)
                    {
                        escaped = true;
                        continue;
                    }
                    if (position + 1 < input.Length)
                        step = input.Substring(++position, 1);
                    else
                        step = "";
                    if (step == "\"")
                    {
                        stringBuilder.Append("\"");
                        continue;
                    }
                    if (step.Equals(delimiter.ToString()) && escaped)
                    {
                        result.Add(stringBuilder.ToString());
                        stringBuilder.Clear();
                        escaped = false;
                        continue;
                    }
                    break;
                default:
                    if (step.Equals(delimiter.ToString()) && !escaped)
                    {
                        result.Add(stringBuilder.ToString());
                        stringBuilder.Clear();
                        continue;
                    }
                    stringBuilder.Append(step);
                    continue;
            }
        } while (true);
        return result;
    } 
```

# php - 如何上传文件并使用 SimpleXML 进行处理？

> ID：12412361
> 
> 赞同：1
> 
> 时间：2012-09-13T18:16:51.977
> 
> 标签：php, xml

我正在使用这种形式：

```
<form action="abc.php" method="post" name="fname">
   <input type="file" name="up" />
   <input type="submit" name="submit" value="Submit"/>
</form> 
```

由这个 PHP 处理：

```
$par = $_POST['up'];
$xml = @simplexml_load_file(file_get_contents($par));
$xml = $xml->getName();
echo $xml; 
```

它给了我这个错误信息：`unable to load external entity`。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T19:46:38.123

*   你需要你的`enctype="multipart/form-data"`属性`form`来接受一个文件：

    ```
    <form enctype="multipart/form-data" action="abc.php" method="post" name="fname"> 
    ```

*   文件进入`$_FILES`，而不是进入`$_POST`，所以你的`$par`初始化应该是：

    ```
    $par = $_FILES['up']; 
    ```

*   Dj Boris 所说的是正确的，你的呼吁`simplexml_load_file`应该是：

    ```
    $xml = simplexml_load_file($par['tmp_name']); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-24T05:03:45.187

其他答案都不正确。如果您通过`simplexml_load_file()` `$_FILES['index']`，您将收到一条错误消息，说明如下：

> simplexml_load_file() 期望参数 1 是有效路径，给定数组

解决方案是将位于`$_FILES`数组内的临时文件名传递给它。

解决方案：

```
$svg = simplexml_load_file($_FILES['up']['tmp_name']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:21:33.520

你在写：

```
simplexml_load_file(file_get_contents($par)); 
```

但是我觉得应该是

```
simplexml_load_file($par); 
```

根据[http://php.net/manual/de/function.simplexml-load-file.php](http://php.net/manual/de/function.simplexml-load-file.php)

# jquery - jqgrid 编辑表单失去浏览器自动填充功能

> ID：12412363
> 
> 赞同：6
> 
> 时间：2012-09-13T18:17:02.540
> 
> 标签：jquery, html, forms, jqgrid, autofill

我最近发布了这个问题：[jqgrid edit form autocomplete="off" by default, how to change to autocomplete="on"](https://stackoverflow.com/questions/12411836/jqgrid-edit-form-autocomplete-off-by-default-how-to-change-to-autocomplete-o)因为我注意到默认情况下 jqGrid 编辑表单为所有输入元素提供了`autocomplete="off"`属性。我认为这就是为什么 Web 浏览器不会为 jqGrid 编辑表单实现通常的自动填充功能的原因。修复此问题并使所有输入元素都具有该`autocomplete="on"`属性后，jqGrid 编辑表单仍然没有自动填充。

有谁知道为什么自动填写不适用于这些表格？表单是通过 ajax 提交的，所以我不确定这是否会影响它。

为了清楚起见，我**不是**在谈论[jQuery 的`autocomplete()`](http://docs.jquery.com/UI/Autocomplete). 我说的是现代网络浏览器（Chrome，FF）内置的表单自动填充功能。

例如，请[在此处查看](http://jsfiddle.net/fKhVX/1/)我的 jsfiddle 示例表单。您可以用您想要的任何内容填写表格，然后单击`submit`。刷新页面并再次填写。您的浏览器应该已经**记住并建议**了第一次填写的值。这就是发生在我身上的事情。

另一方面，如果您[在此处查看](http://www.trirand.com/blog/phpjqgrid/examples/editing_data/edit_dialog/default.php)jqGrid 编辑示例。选择一行并单击小编辑按钮（看起来像一支铅笔）。您不能更改第一个字段，但可以更改其他字段。在其他字段中放置您想要的任何内容，然后单击`submit`。刷新页面再试一次。我从许多计算机以及 FF 和 Chrome 中体验到的是，此表单不**记得**任何过去的条目。

这就是问题所在，你是否也遇到同样的事情？如果是这样，您知道是否可以使这些 jqGrid 表单与浏览器的自动填充功能兼容？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T23:20:34.030

虽然所有浏览器处理表单字段的存储和自动完成的方式略有不同，但它们都依赖于提交的表单来存储表单字段本身的值。由于 jqGrid 通过 AJAX 处理表单（更新按钮是链接而不是提交按钮），表单本身从未实际提交，这反过来又不允许浏览器存储字段值以供以后通过自动完成使用。

强制浏览器存储字段值的一种方法是创建一个`<iframe />`，克隆`<form />`，将克隆的附加`<form />`到 中`<iframe />`并将其作为 AJAX 表单提交过程的一部分提交。

以您的[JSFiddle](http://jsfiddle.net/fKhVX/11/)的这个修改版本为例。

在上面的示例中，填写“标准表格”并提交，重新加载页面，字段会按预期自动完成。填写“AJAX 表单”并提交、重新加载页面，并且这些字段不会自动完成。最后，填写“AJAX + iFrame 表单”并提交，重新加载页面，这些字段现在应该会自动完成。

*注意：以上示例在 Chrome、Safari 和 Firefox 上进行了测试。您的里程数可能会有所不同。

为了完整起见，这里是相关代码：

```
$('#iframe_submit').bind('submit', function(e){
    e.preventDefault(); // Prevents Standard Submit

    // Do AJAX Stuff Here...   

    // Create Clone of Form, Append to iFrame and Trigger Submit
    // This Forces Autocomplete to Register

    var $clone = $('#iframe_submit').clone();
        $clone.attr('id', 'iframe_clone'); // Only One ID Allowed

        $('<iframe />').appendTo('body').contents().find('body').append($clone);
        $('iframe').contents().find('#iframe_clone').submit();
    }); 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T02:52:59.837

尽管有一些代码可以准确地从您的问题中查看。我将跳转到一个假设，即由于浏览器限制，这完全有可能，具体取决于浏览器。但是也。这可能是几件事之一。要么您的表单元素未包含在`<form></form>`标签中，因此启用自动完成的浏览器无法获取您想要自动完成的元素。

2 你为你的元素使用了不起眼的名字。通常启用自动完成功能的浏览器会查找常用的表单元素名称，例如：first_name、firstname、name、email、username、street1、street_one.. 等等。

3 如果您通过 javascript 在类似功能的文档上动态加载网格，则完全有可能。自动完成功能已经检查了页面上是否有任何表单可以自动完成。在这种情况下，浏览器自动完成功能可能只是在您的文档准备好之前运行。如果事实证明是这样的话..这个帖子可能会帮助你走上正确的道路

[jQuery 自动完成触发更改事件](https://stackoverflow.com/questions/6431459/jquery-autocomplete-trigger-change-event)

# java - Java 按位与运算符

> ID：12412364
> 
> 赞同：2
> 
> 时间：2012-09-13T18:17:07.173
> 
> 标签：java, bit-manipulation, mask

我试图屏蔽一个整数，以便像这样单独分隔每个字节：

```
 int a = (0xffffffff & 0xff000000) >> 24;
     int b = (0xffffffff & 0x00ff0000) >> 16;
     int c = (0xffffffff & 0x0000ff00) >> 8;
     int d = 0xffffffff & 0x000000ff; 
```

在这种情况下，b、c 和 d 给出了正确答案，255，但是，无论我将其更改为什么，a 都会继续给我 -1 和其他负数，我什至尝试过：

```
 int a = (0xefffffff & 0xff000000) >> 24; 
```

它给了我-17。

有人知道我该如何解决这个问题，以便在这种边界情况下 a 给我 255 和其他正数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T18:18:50.010

这是因为符号扩展。如果最高位为 1，则`>>`移位 1。这是为了保留论证的符号。您想使用`>>>`which 总是在 0 中移位。或者，在移位后进行掩码：

```
int a = (0xffffffff >> 24) & 0x000000ff; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:20:09.010

你正在做一个有符号的转变，所以这个符号被保留了。

```
int a = (0xffffffff & 0xff000000) >>> 24; // unsigned shift. 
```

或者

```
int a = 0xffffffff >>> 24; // unsigned shift and all the bottom bits are lost anyway
int b = (0xffffffff >>> 16) & 0xFF;
int c = (0xffffffff >>> 8) & 0xFF;
int d = 0xffffffff & 0xFF; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:23:16.197

我认为你需要一个`unsigned shifting`，

试试这个方法...

`(0xffffffff & 0xff000000) >>> 24`

# javascript - javascript中数组的比较

> ID：12412370
> 
> 赞同：6
> 
> 时间：2012-09-13T18:17:29.897
> 
> 标签：javascript, arrays

我有两个数组说`a = [1,2,3]`和`b=[1,2,3]`

如果我这样做`(a==b)`，它会返回 false。如何比较具有相同值的两个数组？

`a[0]==b[0]`将返回 true，但我们如何比较两个数组而不是两个不同数组中的 2 个相同元素？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:20:11.080

您有 2 个选项。

第一个是使用自己制作的某种函数，它将遍历两个数组中的每个键并比较它们。

第二个选项是使用`isEqual` from `_.underscore`（一个非常好的 JS 库，[http://underscorejs.org/#isEqual](http://underscorejs.org/#isEqual)）这将适用于数组和对象。

我会使用第二个，因为它更容易。

```
var a = {'a' : '1', 'b' : '2', 'c' : '3'};
var b = {'a' : '1', 'b' : '2', 'c' : '3'};
_.isEqual(a, b) // --> true 
```

请注意，对象中的顺序无关紧要，因此您可以

```
var a = {'a' : '1', 'b' : '2', 'c' : '3'};
var b = {'c' : '3', 'b' : '2', 'a' : '1'}
_.isEqual(a, b) // --> also true 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T18:20:29.760

```
function array_compare(a, b)
{
    // if lengths are different, arrays aren't equal
    if(a.length != b.length)
       return false;

    for(i = 0; i < a.length; i++)
       if(a[i] != b[i])
          return false;

    return true;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-13T18:21:39.057

如果您知道您的阵列中会发生什么（不），您可以使用[`join`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)：

```
a.join() == b.join() 
```

我知道，这远非防弹，但它可以在某些情况下使用（当您知道两个数组中的顺序相同时）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T18:18:25.887

`(a==b)`正在做参考比较而不是内容比较。

[Underscore.js](http://underscorejs.org/#isEqual)为此带来了一些功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-13T18:20:56.443

如果要比较 2 个数组，可以使用`JSON.stringify`

```
JSON.stringify([1,2,3]) === JSON.stringify([1,2,3]); //=> true 
```

它还将比较数组中的 [嵌套] 对象，或数组中的 [嵌套] 数组：

```
JSON.stringify([1,2,3,{a:1,b:2}]) === 
  JSON.stringify([1,2,3,{'a':1,b:2}]); //=> true

JSON.stringify([1,2,3,{a:1,b:2,c:{a:1,b:2}}]) === 
  JSON.stringify([1,2,3,{'a':1,b:2,c:{a:1,b:2}}]); //=> true

JSON.stringify([1,2,3,{a:1,b:2,c:[4,5,6,[7,8,9]]}]) === 
  JSON.stringify([1,2,3,{'a':1,b:2,c:[4,5,6,[7,8,9]]}]); //=> true 
```

在[这个 jsfiddle](http://jsfiddle.net/KooiInc/VXgss/)中，我对这个想法进行了一些尝试

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-13T18:23:16.763

尝试使用 javascripts **[Join()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)**方法将两个数组转换为字符串，然后对字符串进行压缩：

**[加入（）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)：** `The string conversions of all array elements are joined into one string.`

```
var a1 = array1.join();
var a2 = array2.join();

if(a1 == a2){
  //do something
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-13T18:25:38.280

您必须编写代码来比较数组的每个元素以实现您的目标。

```
// this is one way of doing it, and there are caveats about using instanceOf. 
// Its just one example, and presumes primitive types.
function areArrayElementsEqual(a1, a2)
{
    if (a1 instanceof Array) && (a2 instanceof Array)
    {
        if (a1.length!=a2.length)
            return false;
        else{
           var x;
           for (x=0;x<a1.length; x++)
              if (a1[x]!=a2[x])
                 return false;
        }
    }

    return true;

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-13T18:25:02.580

这是我发现的最短方式：

```
""+ar1==""+ar2 
```

[小提琴](http://jsfiddle.net/Pmt4q/4/)

# visual-studio-2010 - WCF 服务 - 将代码文件与代码隐藏文件相关联

> ID：12412373
> 
> 赞同：0
> 
> 时间：2012-09-13T18:17:44.403
> 
> 标签：visual-studio-2010, wcf

我正在从碎片手动重建 WCF 服务。我添加了一个 MyService.svc 文件 MyService.svc.cs 文件。

我现在怎么让后者成为前者的代码隐藏？这不仅仅是编辑项目文件以添加依赖项并编辑 svc 文件以指向代码隐藏文件的问题。这些，也不是组合，对我有用。

我还尝试了右键单击从项目中删除然后包含，我似乎记得曾经在一个或另一个版本的 Visual Studio 中用于 asp.net 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:54:15.733

我刚开始工作。从项目中删除然后包含在项目中确实有效。诀窍是确保文件具有相同的名称，但扩展名除外。尽管我在问题中将它们都称为 MyService，但实际上它们的名称不同，这就是它不起作用的原因。

所以：

1.  确保根名称相同。
2.  您无需编辑项目文件或标记文件以指向后面的代码。
3.  右键单击并从项目中排除。
4.  确保显示所有文件处于活动状态（解决方案资源管理器顶部）
5.  按住 Ctrl 并单击以选择这两个文件。
6.  右键单击并选择包含在项目中。

它们将作为标记和代码关联起来。

# apache-flex - flex datagrid：elemenst内部不刷新：怎么办？

> ID：12412374
> 
> 赞同：0
> 
> 时间：2012-09-13T18:17:48.980
> 
> 标签：apache-flex, flex4.5

我在 flex4.5 中有一个 3 列的组件

当我添加一些元素时，有时这些元素中的一个会变得不可见：当我调整浏览器的大小时，它会再次出现。

没有规则：它是随机发生的，并且元素总是可用的：我尝试使用referesh，更新，但这没有帮助。

关于为什么会发生这种情况以及如何解决该错误的任何想法？

```
 <mx:DataGrid id="rowcolordatagrid1" left="10" right="10" top="49" variableRowHeight="true" 
                                         bottom="58" borderColor="#CCCCCC" color="#5A5A5A" dataProvider="{questions_dp}" symbolColor="#CCCCCC">
                <mx:columns>                        
                    <mx:DataGridColumn dataField="data" headerText="{xml.questions}" itemRenderer="QuestionRenderer" sortable="false"/>
                    <mx:DataGridColumn width="150" headerText="{xml.action}" itemRenderer="ActionRenderer" sortable="false"/>
                    <mx:DataGridColumn dataField="priority" headerText="{xml.priority}" itemRenderer="PriorityRenderer" width="100"  />
                </mx:columns>
            </mx:DataGrid> 
```

当然我试过 questions_dp.refresh();

![线条消失了！](../Images/7ab3957a0991b718906deb6d4c0b03c7.png)

但是当我调整或最小化我的浏览器时，这些空白行又出现了！这些行有时会发生：我会说某些行有 20% 的机会是不可见的。

回复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:37:50.293

我认为原因是因为您的项目呈现。

删除“QuestionRenderer”并重试。

如果第一列没问题，请检查所有渲染类：您是否忘记在渲染类中的每个覆盖方法中调用 super.method(..) ？

# xml-rpc - 如何通过 Bugzilla 的 XML-RPC API 在错误描述中插入换行符

> ID：12412376
> 
> 赞同：1
> 
> 时间：2012-09-13T18:17:53.750
> 
> 标签：xml-rpc, bugzilla

我不确定这是 Bugzilla 问题还是 XML-RPC 问题：使用 XML-RPC API 的 Bug.create 方法在 Bugzilla 中创建错误时，如何输入多行描述？

description 参数采用字符串值，但空格（包括换行符）似乎被去除了，我最终得到了单行描述，而不是多行文本。

以下不起作用：

```
<?xml version="1.0"?>
<methodCall>
    <methodName>Bug.create</methodName>
    <params>
        <param>
            <value>
                <struct>
                    <member>
                        <name>product</name>
                        <value><string>Development</string></value>
                    </member>
                    <member>
                        <name>component</name>
                        <value><string>Component01</string></value>
                    </member>
                    <member>
                        <name>summary</name>
                        <value><string>Bug created via API</string></value>
                    </member>
                    <member>
                        <name>description</name>
                        <value>
                            <string>This bug was created through the Bugzilla XML/RPC interface

Here is the second line of the description
and the third line.</string>
                        </value>
                    </member>
                    <member>
                        <name>version</name>
                        <value><string>1</string></value>
                    </member>
                    <member>
                        <name>severity</name>
                        <value><string>enhancement</string></value>
                    </member>
                    <member>
                        <name>op_sys</name>
                        <value><string>All</string></value>
                    </member>
                    <member>
                        <name>platform</name>
                        <value><string>All</string></value>
                    </member>
                    <member>
                        <name>priority</name>
                        <value><string>P5</string></value>
                    </member>
                    <member>
                        <name>assigned_to</name>
                        <value><string>example@example.com</string></value>
                    </member>
                </struct>
            </value>
        </param>
    </params>
</methodCall> 
```

我最终得到以下描述：

```
This bug was created through the Bugzilla XML/RPC interfaceHere is the second line of the descriptionand the third line. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:56:27.543

我想出了一种方法：使用 base64 值而不是字符串值进行描述。

如果有人知道不同的方式，请告诉我。

这有效：

```
<?xml version="1.0"?>
<methodCall>
    <methodName>Bug.create</methodName>
    <params>
        <param>
            <value>
                <struct>
                    <member>
                        <name>product</name>
                        <value><string>Development</string></value>
                    </member>
                    <member>
                        <name>component</name>
                        <value><string>Component01</string></value>
                    </member>
                    <member>
                        <name>summary</name>
                        <value><string>Bug created via API</string></value>
                    </member>
                    <member>
                        <name>description</name>
                        <value>
                            <base64>VGhpcyBpcyBsaW5lIG9uZQ0KDQpibGFuayBsaW5lIGFib3ZlDQpUaGlzIGlzIHRoZSB0aGlyZCBsaW5lIG9mIHRleHQ=</base64>
                        </value>
                    </member>
                    <member>
                        <name>version</name>
                        <value><string>1</string></value>
                    </member>
                    <member>
                        <name>severity</name>
                        <value><string>enhancement</string></value>
                    </member>
                    <member>
                        <name>op_sys</name>
                        <value><string>All</string></value>
                    </member>
                    <member>
                        <name>platform</name>
                        <value><string>All</string></value>
                    </member>
                    <member>
                        <name>priority</name>
                        <value><string>P5</string></value>
                    </member>
                    <member>
                        <name>assigned_to</name>
                        <value><string>xxx@xxx.com</string></value>
                    </member>
                </struct>
            </value>
        </param>
    </params>
</methodCall> 
```

结果：

```
This is line one

blank line above
This is the third line of text 
```

# java - Black Berry - 如何在这个 FieldChangeListener.fieldChanged 中避免这个无限循环

> ID：12412377
> 
> 赞同：1
> 
> 时间：2012-09-13T18:17:53.950
> 
> 标签：java, blackberry

我需要格式化用户在 EditField 上输入的字符串。这是我的代码：

```
input = new BorderedEditField(20, BasicEditField.FILTER_NUMERIC);

input.setChangeListener(new FieldChangeListener() {             
    public void fieldChanged(Field field, int context) {
        input.setText(pruebaTexto(input.getText()));
    }
});

public static String pruebaTexto(String r){
    return r+"0";
} 
```

但它以明显由于无限循环而导致的stackoverflow错误结束。代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:23:19.457

您可以通过检查这是否是内部更新来防止递归。对于 Blackberry，这是通过检查`context`

```
input.setChangeListener(new FieldChangeListener() {
    public void fieldChanged(Field field, int context) {
        if (context != FieldChangeListener.PROGRAMMATIC) {
            input.setText(pruebaTexto(input.getText()));
        }
    }
}); 
```

这是一个非黑莓特定的解决方案，适用于任何类型的听众：

```
input.setChangeListener(new FieldChangeListener() {
    private boolean internalCall = false;
    public void fieldChanged(Field field, int context) {
        if (!internalCall) {
            internalCall = true;
            try {
                input.setText(pruebaTexto(input.getText()));
            }
            finally {
                internalCall = false;
            }
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T02:55:24.563

检查[`net.rim.device.api.ui.FieldChangeListener`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/FieldChangeListener.html).

当方法[`void fieldChanged(Field field, int context)`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/FieldChangeListener.html#fieldChanged%28net.rim.device.api.ui.Field,%20int%29)被调用时，您可以**`context`**根据值检查参数[`FieldChangeListener.PROGRAMMATIC`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/FieldChangeListener.html#PROGRAMMATIC)。

如果 **`context`**等于 [`FieldChangeListener.PROGRAMMATIC`](http://www.blackberry.com/developers/docs/6.0.0api/net/rim/device/api/ui/FieldChangeListener.html#PROGRAMMATIC)，则更改是以编程方式进行的，否则是用户交互。

# objective-c - 将 MKMapview 缩放到当前用户位置最近的两个 MKAnnotations

> ID：12412379
> 
> 赞同：0
> 
> 时间：2012-09-13T18:17:59.460
> 
> 标签：objective-c, xcode, mkmapview, mkannotation, mapkit

将 MKMapview 缩放到当前用户位置最接近的两个或三个 MKAnnotations 的最佳方法是什么？

我有一个从 plist 加载的 GPS 坐标列表（准确地说是 328），每个点都是地图上的注释。我想将视图限制在用户当前位置周围最近的两个注释点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:37:23.377

大致来说，步骤是：

1.  查找当前位置，转换为 MKMapPoint
2.  迭代您的注释列表，`MKMetersBetweenMapPoints`用于查找与当前位置的距离
3.  节省 2 或 3 个最小距离
4.  使用这三个距离中最大的一个来制作一个区域`MKCoordinateRegionMakeWithDistance`
5.  以当前位置居中地图
6.  使用缩放到区域`[mapView setRegion:region animated:TRUE]`

# c# - 如何仅在 MVC3 应用程序中选择某个元素时创建新的下拉列表？

> ID：12412383
> 
> 赞同：2
> 
> 时间：2012-09-13T18:18:16.323
> 
> 标签：c#, javascript, asp.net-mvc-3, client-side

我的视图上有一个 DropDownFor，并且我希望**仅在**选择第一个 DropDownFor 中的特定 SelectList 项目时创建另一个 DropDownFor。

澄清一下，如果我的 DropDownFor 有两个可能的选择，“A”和“B”，如果选择了“B”，我希望在页面上显示另一个 DropDownFor。如果选择了“A”，我希望页面不再发生任何事情。

我该如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:29:27.687

这样的事情应该可以解决问题：

# 脚本（使用 jQuery）

```
$(document).ready(function() {
    $('#optionOne').change(function (){
        if($(this).val() === 'b') {
            $('#options').append("<select><option>newset</option></select>");
        }            
    });
});​ 
```

# 标记

```
<div id="options">
    <select id="optionOne">
        <option>a</option>
        <option>b</option>
    </select>
​&lt;/div>​ 
```

上述代码的 JSFiddle 示例——http: [//jsfiddle.net/NpSPj/1/](http://jsfiddle.net/NpSPj/1/)

# javascript - RegEx 删除所有样式，但保留颜色和背景颜色（如果存在）

> ID：12412388
> 
> 赞同：4
> 
> 时间：2012-09-13T18:18:25.480
> 
> 标签：javascript, regex

我仍然无法使用正则表达式，因此无法找到最终解决方案来使用带有 Javascript 的 RegEx 从 <p style="">...</p> 中去除所有样式，但**保留颜色和背景-如果它们存在，则为颜色**。

我发现了什么：

**1\. 使用 RegEx 删除完整的 style="..." 元素：**

```
htmlString = (htmlString).replace(/(<[^>]+) style=".*?"/i, ''); 
```

**2\. 使用 RegEx 删除某些样式：**

```
htmlString = (htmlString).replace(/font-family\:[^;]+;?|font-size\:[^;]+;?|line-height\:[^;]+;?/g, ''); 
```

挑战：如果我们删除了所有分配的样式（不存在颜色），并且样式为空（我们有 style="" 或 style=" "），那么 style 属性也应该被删除。

我想我们需要两行代码？

任何帮助表示赞赏！

**示例 1（列入白名单的“颜色”仍然存在）：**

```
<p style="font-family:Garamond;font-size:8px;line-height:14px;color:#FF0000;">example</p> 
```

应该变成：

```
<p style="color:#FF0000;">example</p> 
```

**示例 2（所有样式都死了）：**

```
<p style="font-family:Garamond;font-size:8px;line-height:14px;">example</p> 
```

应该变成：

```
<p>example</p> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T21:27:42.343

首先，概念证明。查看[Rubular 演示](http://rubular.com/r/RnSHLUXjcx)。

正则表达式是这样的：

```
/(<[^>]+\s+)(?:style\s*=\s*"(?!(?:|[^"]*[;\s])color\s*:[^";]*)(?!(?:|[^"]*[;\s])background-color\s*:[^";]*)[^"]*"|(style\s*=\s*")(?=(?:|[^"]*[;\s])(color\s*:[^";]*))?(?=(?:|[^"]*)(;))?(?=(?:|[^"]*[;\s])(background-color\s*:[^";]*))?[^"]*("))/i 
```

分解，意思是：

```
(<[^>]+\s+)                           Capture start tag to style attr ($1).

(?:                                   CASE 1:

    style\s*=\s*"                     Match style attribute.

    (?!                               Negative lookahead assertion, meaning:
        (?:|[^"]*[;\s])               If color found, go to CASE 2.
        color\s*:[^";]*
    )

    (?!
        (?:|[^"]*[;\s])               Negative lookahead assertion, meaning:
        background-color\s*:[^";]*    If background-color found, go to CASE 2.
    )

    [^"]*"                            Match the rest of the attribute.

|                                     CASE 2:

    (style\s*=\s*")                   Capture style attribute ($2).

    (?=                               Positive lookahead.
        (?:|[^"]*[;\s])
        (color\s*:[^";]*)             Capture color style ($3),
    )?                                if it exists.

    (?=                               Positive lookahead.
        (?:|[^"]*)                    
        (;)                           Capture semicolon ($4),
    )?                                if it exists.

    (?=                               Positive lookahead.
        (?:|[^"]*[;\s])
        (background-color\s*:[^";]*)  Capture background-color style ($5),
    )?                                if it exists.

    [^"]*(")                          Match the rest of the attribute,
                                      capturing the end-quote ($6).
) 
```

现在换人，

```
\1\2\3\4\5\6 
```

应该始终构建您期望留下的东西！

**如果不清楚，这里的技巧是将“否定”案例放在第一位，这样*只有当否定案例失败*时，捕获（例如样式属性本身）才会被填充，当然，替代案子。否则，捕获默认为无，因此即使样式属性也不会显示。**

要在 JavaScript 中执行此操作，请执行以下操作：

```
htmlString = htmlString.replace(

    /(<[^>]+\s+)(?:style\s*=\s*"(?!(?:|[^"]*[;\s])color\s*:[^";]*)(?!(?:|[^"]*[;\s])background-color\s*:[^";]*)[^"]*"|(style\s*=\s*")(?=(?:|[^"]*[;\s])(color\s*:[^";]*))?(?=(?:|[^"]*)(;))?(?=(?:|[^"]*[;\s])(background-color\s*:[^";]*))?[^"]*("))/gi,

    function (match, $1, $2, $3, $4, $5, $6, offset, string) {
        return $1 + ($2 ? $2       : '') + ($3 ? $3 + ';' : '')
                  + ($5 ? $5 + ';' : '') + ($2 ? $6       : '');
    }

); 
```

请注意，我这样做是为了好玩，而不是因为应该这样解决这个问题。另外，我知道分号捕获很hacky，但这是一种方法。并且可以推断出如何扩展样式的白名单，查看上面的细分。

# javascript - 简单的淡入淡出不起作用

> ID：12412397
> 
> 赞同：0
> 
> 时间：2012-09-13T18:19:04.300
> 
> 标签：javascript, html, css

我用 CSS 制作了一个简单的盒子，我试图通过使用 setInterval 对象动态改变它的不透明度来淡化它。

[http://jsfiddle.net/5gqRR/7/](http://jsfiddle.net/5gqRR/7/)

CSS

```
#box {
margin:0px auto;
margin-top:10px;
height:50px;
width:50px;
background:black;
} 
```

JAVASCRIPT

```
var fade;
function select(id) {
    return document.getElementById(id);
}
function disBox() {
    fade=setInterval(function(){
        select("box").style.opacity-=0.1;   
    },300);
    if (select("box").style.opacity==0) {
        clearInterval("fade");
        select("box").style.display="none";
    }   
    else {
        select("box").style.display="block";    
    }
} 
```

问题是“-=”运算符开始从 0 而不是 1 中减去不透明度。有人可以解释为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:11:37.567

您对不透明度的检查应该在循环内。

```
function select(id) {
    return document.getElementById(id);
}

// Run at loading
window.onload = function () {
    // Preload variables
    var box = select('box'), opacity = 1, fade;

    // Looping
    fade = setInterval(function(){
        // Calculate and applying opacity
        opacity = Math.max( 0, opacity - 0.1 );
        box.style.opacity = opacity;

        // Stoping loop when box isn't visible
        if ( !opacity )
            clearInterval(fade);
    },30);
}; 
```

​演示：http: [//jsfiddle.net/5gqRR/8/](http://jsfiddle.net/5gqRR/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:25:01.050

您不能将`onload`事件设置为`div`元素。取而代之的是，您可以这样做：

***HTML***

```
<div id="box"></div> 
```

***JavaScript***

```
var fade;
function select(id) {
    return document.getElementById(id);
}
function disBox() {
    fade = setInterval(function(){
        select("box").style.opacity-=0.1;    
    },300);
    if (select("box").style.opacity==0) {
        clearInterval("fade");
        select("box").style.display="none";
    }    
    else {
        select("box").style.display="block";    
    }
}

window.onload = (function() {
    disBox();
})(); 
```

***[演示](http://jsfiddle.net/5gqRR/4/)***

### 根据编辑

```
select("box").style.opacity = 1;  // add this line to set initial opacity
fade = setInterval(function(){
            select("box").style.opacity-=0.1;    
        },300); 
```

# visual-studio-2010 - 更新到 Visual Studio 2012 后缺少 CRT

> ID：12412399
> 
> 赞同：1
> 
> 时间：2012-09-13T18:19:09.607
> 
> 标签：visual-studio-2010, visual-studio-2012

我今天卸载了 VS2010 附带的所有内容并安装了 VS2012 express。

当我尝试编译之前在 VS2010 中创建的项目时，一切正常。但是当exe开始运行时，提示msvcr100d.dll文件丢失...

我知道这个调试版本的 dll 甚至不包含在任何可再发行库中。通常它应该包含在 VS2010 或 VS2012 中。那么除了重新安装VS2010还有什么办法可以解决这个问题呢？

我检查了 system32 文件夹，只有 msvcr110d 而不是 msvcr100d，如何告诉我的项目将依赖关系从 2010 更改为 2012

# android - 如何保持 Galaxy S2 屏幕处于活动状态（Android 操作系统）？

> ID：12412401
> 
> 赞同：0
> 
> 时间：2012-09-13T18:19:16.063
> 
> 标签：android, samsung-mobile, setting

在三星 Galaxy S2 中，我在哪里可以找到保持屏幕活动的选项？我已经通过**Menu->Configuration->Application->Development**（以及所有其他菜单）进行了搜索，但是Application 视图中缺少**Development**选项（该视图是一种应用程序管理器，而不是选项设置）。

我知道保持 amoled 显示器处于活动状态（即像素燃烧）存在很多问题，但我真的需要这个功能，因为每次接近转动时点击我的设备屏幕变得非常烦人不活动。

Bellow 是我的**设置-> 开发人员选项**屏幕截图：

![在此处输入图像描述](../Images/4ca9eedba6dbf8b9276ae3a2a629f0c5.png)

特别注意：我已经准备好制造商已经删除了保持屏幕活动的选项。这是真实的信息吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:01:53.030

尝试使用以下代码以编程方式设置值

```
Settings.System.putInt(getActivity().getContentResolver(),Settings.System.STAY_ON_WHILE_PLUGGED_IN,(BatteryManager.BATTERY_PLUGGED_AC | BatteryManager.BATTERY_PLUGGED_USB)); 
```

# debugging - Nvidia Nsight 2.2 OpenGL 着色器调试器 - 不工作？

> ID：12412408
> 
> 赞同：1
> 
> 时间：2012-09-13T18:19:36.670
> 
> 标签：debugging, opengl, shader, nsight

我在两台计算机上配置了 NVidia 的 Parallel Nsight 2.2 系统。目标有一个 Geforce 450 gts，驱动程序版本为 301.42，主机有一个 Quadro 1000M，驱动程序版本相同。加载最简单的 OpenGL 3.0 程序（使用着色器显示彩色三角形）运行良好，但我似乎无法让 Nsight 着色器调试器工作。

一切似乎都正常，我可以打开 NSight->Windows->Shaders List 窗口，双击一个着色器，打开源代码并选择一行并设置一个断点。出现一个大红点表示已设置断点，但断点永远不会命中，所以我被卡住了。

有没有人让 OpenGL 着色器调试器与 Parallel Nsight 2.2 一起工作？

顺便说一句，NSight->New Analysis Activity 效果很好。我可以创建所有 openGL 调用的跟踪并毫无问题地查看它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T10:55:28.343

OpenGL 着色器调试器需要尚未发布的驱动程序。您需要比 306.37 更新的驱动程序才能获得良好的调试体验。

-s

# html - 将贝宝下拉菜单更改为图片

> ID：12412409
> 
> 赞同：0
> 
> 时间：2012-09-13T18:19:36.620
> 
> 标签：html, css, forms, paypal

我的贝宝表格是：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
           <input type="hidden" name="currency_code" value="GBP">
             <input type="hidden" name="hosted_button_id" value="BZDFVPOK8XKQ">
<input type="hidden" name="on0" value="Size">
                  <input type="hidden" name="cmd" value="_s-xclick">
            <select name="os0">
                    <option>Please Select</option>
                      <option value="small">small</option>
                      <option value="medium">medium</option>
                      <option value="large">large</option>

                </select>
          <input type="image" src="images/buyitnow.png"  style="width:100px; height:30px; padd" border="0" name="submit" alt="PayPal — The safer, easier way to pay online.">
            </form> 
```

我想将下拉菜单更改为 3 张图像 S、M、L，以便用户可以选择图像，而不必从下拉菜单中进行选择。这可能吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:37:07.117

看来您需要单选按钮而不是下拉菜单！

使用 CSS 将每个单选按钮显示为图像。您可能还需要一些 javascript。

* * *

试试这个插件[http://www.thheuer.com/2011/10/jquery-plugins-image-radio-buttons/](http://www.thheuer.com/2011/10/jquery-plugins-image-radio-buttons/)

# html - 保留标签 HTML 之间的空白

> ID：12412416
> 
> 赞同：0
> 
> 时间：2012-09-13T18:20:04.420
> 
> 标签：html, whitespace

我认为 html 应该在内联标签之间制作空格，`<a>one</a><a>two</a>`但它似乎只有在这些标签之间有行结束时才有效。请看我的例子：http: [//jsfiddle.net/pwF7f/](http://jsfiddle.net/pwF7f/)

那么即使元素在一行上也有可能有这个空格吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:21:24.940

当 HTML 不在源代码中时，它不会发明空格。你总是可以说：

```
 <a>one</a> <a>two</a> 
```

如果你想要空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:37:30.527

这不是空格，但请尝试`<a>one</a>&nbsp;<a>two</a>`或

```
<a>one</a>&nbsp;
<a>two</a> 
```

如果你想要一个不间断的空间

在我看来，它比`<a>one</a> <a>two</a>`.

您可以创建例如这样的东西

```
<a>one</a>&nbsp;|&nbsp;
<a>two</a>&nbsp;|&nbsp;
<a>three</a>&nbsp;|&nbsp;
<a>four</a> 
```

与此代码比较：

`<a>one</a> | <a>two</a> | <a>three</a> | <a>four</a>`|

在 html 中使用 php echo 时还有其他问题。那么`&nbsp;`是必须的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:42:51.690

除了在元素之间放置空格或不间断空格外，您还可以使用 CSS 创建水平间距，例如通过设置`padding-right: 0.5em`第一个元素。

相邻的内联元素被视为真正相邻，它们之间没有任何空格是有原因的：在某些情况下，您确实想要这样做，例如在*n* ^(th)中（它应该以特定样式呈现为“nth”，而不是“n th ”）。

这是一个旧的可访问性建议，连续链接之间应该有一些非空白字符。这不像最初提出的那样有必要，但它是一个很好的指导方针——当然*至少*应该有一些空白。

# .net - 使用 Enterprise Library 记录到自定义 Windows 事件日志不起作用

> ID：12412419
> 
> 赞同：0
> 
> 时间：2012-09-13T18:20:11.927
> 
> 标签：.net, logging, windows-7, event-log, enterprise-library-5

我已将 Enterprise Library 5.0.505 Logging Application Block 配置为将 .NET 4 应用程序中的事件记录到自定义 Windows 事件日志中。“自定义”意味着日志是特定于应用程序的，并在 Windows 7 事件查看器 MMC 管理单元中的“应用程序和服务日志”下显示为条目。我已按照[日志记录应用程序块文档](http://msdn.microsoft.com/en-us/library/ff664639%28v=pandp.50%29)中的步骤正确配置它，包括设置自定义日志，但事件被记录到默认应用程序日志中。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:20:11.927

“把它关掉再打开”。创建自定义事件日志后，Windows 似乎需要重新启动。完成此操作后，日志条目将按预期保存在自定义日志中。

# c++ - dlopen 和隐式库加载：同一个库的两个副本

> ID：12412423
> 
> 赞同：2
> 
> 时间：2012-09-13T18:20:21.267
> 
> 标签：c++, c, linux

我有 3 样东西：开源应用程序（我们称之为 APP）、闭源共享库（我们称之为 OPENGL）和 OPENGL 的开源插件（我们称之为 PLUGIN）[也是共享库]。
操作系统：Linux。

APP和PLUGIN之间需要共享数据，所以APP与PLUGIN链接，运行时系统会自动加载。

在那个APP调用属于OPENGL的eglInitialize之后，这个函数再次加载PLUGIN。

之后，我在 APP 内存中有两个 PLUGIN 副本。

我知道是因为PLUGIN有全局数据，调试后发现有两份全局数据。

那么质疑我如何解决这种行为？我想要一个 PLUGIN 实例，供 APP 和 OPENGL 使用。而且我无法更改 OPENGL 库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:39:56.123

这显然很大程度上取决于图书馆正在做什么，但总的来说应该有一些解决方案。

首先请注意，通常如果多次加载同名的共享库，它将继续使用同一个库。这主要适用于通过标准加载/链接机制进行加载。如果库自行调用`dlopen`，它仍然可以获得相同的库，但它取决于`dlopen`. 尝试阅读 dlopen 上的文档以了解它的工作原理以及如何操作它。

您还可以尝试在链接器命令中更早地定位 PLUGIN，以便它首先加载，从而可能避免以后的双重加载。如果您必须动态加载插件，这显然无济于事。您还可以检查是否`LD_PRELOAD`可以解决链接顺序。

作为最后的手段，您可能不得不求助于使用`LD_LIBARY_PATH`并从真实的接口库中放入接口库。这个只会将调用传递给真正的调用，但会拦截重复的负载并将它们分流到前一个负载。

这只是一个需要考虑的大方向。您的实际答案将在很大程度上取决于您的代码以及其他共享库的功能。始终首先研究链接器加载顺序，因为它是最容易检查的，然后是 dlopen 标志，然后再进入其他选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:35:04.177

我怀疑 OPENGL 正在加载带有`RTLD_LOCAL`标志的 PLUGIN。这通常是您在加载插件时想要的，这样多个插件就不会发生冲突。

我们在 Java 下加载代码时也遇到过类似的问题：我们会加载十几个不同的模块，但它们无法相互通信。我们的解决方案可能对您有用：我们为插件编写了一个包装器，并告诉 Java 包装器就是插件。`dlopen` 然后，该插件使用with加载其他每个共享对象`RTLD_GLOBAL`。这在插件之间有效。但是，我不确定它是否会允许插件返回主插件（但我认为应该）。而 IIRC，在链接 main 时，您需要特殊选项才能使其符号可用。我认为 Linux 将 main 中的符号视为已加载 main `RTLD_LOCAL`。（也许 `--export-dynamic`？自从我不得不这样做以来已经有一段时间了，我记不清了。）

# visual-studio-2010 - 如何从嵌套模板块生成 T4 模板中的代码块？

> ID：12412425
> 
> 赞同：1
> 
> 时间：2012-09-13T18:20:25.343
> 
> 标签：visual-studio-2010, dynamic, code-generation, t4

我在我的代码块中动态创建类和变量名例如：

```
if (new<#=et.Name#> == null) 
```

对于名为 Site 的实体模型，这会生成：

```
 if (newSite == null) 
```

但我想做的是评估项目的类型，然后根据该类型生成代码。出于我的特定目的，我想编写一个代码块，根据该实体的键值的数据类型动态创建一个新的主键。所以我想在我的模板中做这样的事情：

```
<#if ( new<#=et.Name#>.<#=primaryKey.Name#>.GetType() == typeof( Guid ) ) {#>
   if (new<#=et.Name#>.<#=primaryKey.Name#> == Guid.Empty )
      new<#=et.Name#>.<#=primaryKey.Name#> = Guid.NewGuid();
<#} #> 
```

随后为名为 Site 的实体模型生成的代码如下所示：

```
if ( newSite.SiteKey == Guid.Empty )
   newSite.SiteKey = Guid.NewGuid(); 
```

从逻辑上讲，这看起来好像会起作用。但是，我无法找到正确的语法来嵌套模板块并评估这些值然后放置在条件中。注意嵌套在语句块中的表达式块。因此，上面的代码生成示例不起作用，因为 Visual Studio 抱怨语法的各种问题。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T05:27:06.357

如果类型在您正在构建的程序集中，您可以使用

```
<#@ assembly name="$(TargetPath)"#> 
```

我在[代码优先的 View Gen T4 模板中使用了这个技巧](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)

# regex - 如何在busybox sed中检索捕获的组正则表达式

> ID：12412429
> 
> 赞同：2
> 
> 时间：2012-09-13T18:20:28.790
> 
> 标签：regex, sed, busybox

我正在编写一个脚本来启动 TS-7400 ARM SBC，我希望它能够读取通过 SD 卡上的配置文件传递的一些参数和可选内核参数。我调用了我的配置文件`syscfg.conf`，它是使用`KEYWORD=value`对组织的，但是由于内核参数本身可以具有相同的语法，所以我想到了像这样分隔值：

```
CMDLINE_ARGS="elevator=noop scheduler=noop" 
```

在常规 bash 中进行测试时，我能够使用以下任一方法隔离内核命令行参数：

```
$ grep CMDLINE_ARGS syscfg.conf | sed 's/CMDLINE_ARGS="\(.*\)"/\1/'
elevator=noop scheduler=noop

$ grep CMDLINE_ARGS syscfg.conf | cut -d'"' -f2
elevator=noop scheduler=noop

$ awk -F'"' '/CMDLINE_ARGS/ {print $2}' syscfg.conf
elevator=noop scheduler=noop 
```

但是当它在 TS-LINUX 上运行时，这是一个基于 busybox 的精简 Linux，用于引导自定义内核或应用程序，它不像在常规 bash 中那样工作。虽然该`awk`命令甚至不存在，但该`cut`版本运行良好，但`sed`返回此：

```
CMDLINE_ARGS="elevator=noop scheduler=noop" 
```

为什么busybox的`sed`实现会这样？我希望它只输出分隔符`\1`之间的任何字符的“”组-正则表达式，而不是返回整个字符串。有什么办法可以让它像在 bash 中一样工作吗？`"``"(.*)"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T21:02:42.227

```
sed '/CMDLINE_ARGS=/ {s/CMDLINE_ARGS=.//;s/.$//;}' syscfg.conf 
```

如果报价有问题或管道有问题，可以试试这个（我怀疑其中一个部分有外壳替换）

# wpf - 在托管应用程序中加载非托管 dll 时 windowsbase.dll 中的 Stackoverflow 异常

> ID：12412432
> 
> 赞同：0
> 
> 时间：2012-09-13T18:20:48.877
> 
> 标签：wpf, unmanaged, managed, loadlibrary

我正在尝试使用来自托管应用程序的 loadlibrary 加载一个未管理的 DLL，在对 dll 进行调用时，我得到一个 stackoverflow 异常：

“WindowsBase.dll 中发生了‘System.StackOverflowException’类型的未处理异常”

该 dll 在其他 MFC 应用程序中得到了很好的使用，所以我不认为这是一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:52:37.760

以防万一有人遇到同样的问题，因为我调用的 DLL 是一个 Borland DLL，它抛出异常，导致 WPF 崩溃。包装 DLL 并在单独的线程中调用它解决了这个问题。

# html - Flask 提供静态 html 页面

> ID：12412435
> 
> 赞同：0
> 
> 时间：2012-09-13T18:21:20.737
> 
> 标签：html, static, web, flask

我正在通过 Flask 框架实现一个 Web 应用程序。这个 Web 应用程序将提供结构类似于 java doc 的静态 html 页面。

**代码：**

从烧瓶进口烧瓶，send_from_directory，url_for

```
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello World!"

@app.route("/report")
def view_report():
    url_for('static', filename='report/flexmonkey/html/')
    return send_from_directory('static', 'report/flexmonkey/html/index.html')

if __name__ == "__main__":
    app.run(debug=True) 
```

index.html：

```
<html xmlns:lxslt="http://xml.apache.org/xslt" xmlns:stringutils="xalan://org.apache.tools.ant.util.StringUtils">
<head>
<META http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Unit Test Results.</title>
</head>
<frameset cols="20%,80%">
<frameset rows="30%,70%">
<frame src="overview-frame.html" name="packageListFrame">
<frame src="allclasses-frame.html" name="classListFrame">
</frameset>
<frame src="overview-summary.html" name="classFrame">
<noframes>
<h2>Frame Alert</h2>
<p>
                This document is designed to be viewed using the frames feature. If you see this message, you are using a non-frame-capable web client.
            </p>
</noframes>
</frameset>
</html> 
```

**目录结构：**

```
~/workspace/testReport/static/report/flexmonkey/html $ ls
allclasses-frame.html  alltests-fails.html  automation  overview-frame.html    stylesheet.css
alltests-errors.html   all-tests.html       index.html  overview-summary.html 
```

**错误信息：**

```
127.0.0.1 - - [13/Sep/2012 11:01:25] "GET /overview-frame.html HTTP/1.1" 404 -
127.0.0.1 - - [13/Sep/2012 11:01:25] "GET /allclasses-frame.html HTTP/1.1" 404 -
127.0.0.1 - - [13/Sep/2012 11:01:25] "GET /overview-summary.html HTTP/1.1" 404 - 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:26:37.017

如果您只想提供静态文件，则不需要使用 Flask。从您拥有 html 文件的目录中，键入`python -m SimpleHTTPServer`然后浏览`http://localhost:8000/`

对于 Python 3，请键入`python -m http.server`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-07T07:18:37.450

默认情况下，flask 会将 /static 文件夹中的任何内容作为静态文件提供，除非重新定义为`app = Flask(__name__, static_url_path='some_other_folder')`. 因此，将所有 html 文件放在 static 文件夹下并运行一个简单的烧瓶服务器：

```
from flask import Flask, send_from_directory

app = Flask(__name__)

@app.route('/')
def root():
    return send_from_directory('','index.html') # serve root index.html

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080, debug=True) 
```

然后访问`http://localhost:8080/static/report/flexmonkey/html/overview-summary.html`，你应该得到它。

# javascript - JavaScript 代理模式解释

> ID：12412438
> 
> 赞同：1
> 
> 时间：2012-09-13T18:21:32.817
> 
> 标签：javascript, dom-events, proxy-pattern

我研究了 JavaScript 代理模式，但我仍然没有得到，我可以从中受益。因此，我想为您提供两个示例，并请您指出它们之间的区别。

请看下面的代码：

*   `addEventListener`这两个调用有什么区别？其中一个`handleDrop`以常规方式打电话。另一个使用代理模式。
*   使用代理模式方法我将获得什么？

我测试了这两个函数，它们都`handleDrop`成功调用了。

```
DndUpload.prototype.buildDropZone = function ()
{
    var self = this,

    this.dropZone.addEventListener('drop', function (e) { self.handleDrop.call(self, e) }, false);
    this.dropZone.addEventListener('drop', self.handleDrop, false);

    DndUpload.prototype.handleDrop = function (e)
    {
        alert("test");
        ...
    };
} 
```

您可以为我提供很好的参考，其中包含对 JavaScript 中代理模式的非常清晰的解释。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T19:29:13.600

因此，您在示例中所描述的与其说是对代理模式的演示，不如说是对“调用对象”及其在 JavaScript 中的工作方式的混淆演示。

在 JavaScript 中，函数是“一流的”。这实质上意味着函数是数据，就像任何其他数据一样。因此，让我们考虑以下情况：

```
var fn = (function () { return this.x; }),
    a = {
        x : 1,
        fn : fn,
    },
    x = 2,
    nothing = (function (z) { return z; }); 
```

所以，我们有一个对象`a`，它有两个属性：`fn`和`x`。我们还有变量`x`, `fn`（它是一个返回函数`this.x`）和`nothing`（它返回它传递的任何东西）。

如果我们评估`a.x`，我们得到`1`。如果我们评估`x`，我们得到`2`。很简单吧？现在，如果我们评估`nothing(a.x)`，那么我们得到`1`。这也很简单。但重要的是要意识到`1`与属性关联的值与`a.x`对象没有任何关系`a`。它独立存在，可以简单地作为值传递。

在 JavaScript 中，函数的工作方式相同。作为属性的函数（通常称为“方法”）可以作为简单引用传递。但是，这样做时，它们可能会与对象断开连接。`this`当您在函数中使用关键字时，这一点变得很重要。

关键字引用“`this`调用对象”。*这是在评估该函数时*与该函数关联的对象。设置函数的调用对象有三种基本方法：

1.  如果使用点运算符（例如）*调用*`a.fn()`函数，则将相关对象（在示例中，`a`）设置为调用对象。
2.  如果使用函数`call`或`apply`属性调用函数，那么您可以显式设置调用对象（我们将在稍后了解为什么这很有用）。
3.  如果没有通过方法 1 或方法 2 设置调用对象，则使用全局对象（在浏览器中，通常称为`window`）。

所以，回到我们的代码。如果我们调用`a.fn()`，它将评估为`1`。这是意料之中的，因为`this`函数中的关键字将`a`由于使用点运算符而被设置为。但是，如果我们简单地调用`fn()`，它将返回`2`，因为它引用了`x`全局对象的属性（意味着使用了我们的全局对象`x`）。

现在，这就是事情变得棘手的地方。如果你打电话怎么办：`nothing(a.fn)()`？您可能会惊讶于结果是`2`. 这是因为传入`a.fn`传递`nothing()`了对 的引用`fn`，但不保留调用对象！

这与您的编码示例中的概念相同。如果您的函数`handleDrop`要使用`this`关键字，您会发现它具有不同的值，具体取决于您使用的处理程序形式。这是因为在您的第二个示例中，您传递了对 的引用`handleDrop`，但与我们的`nothing(a.fn)()`示例一样，当它被调用时，调用对象引用已丢失。

因此，让我们在拼图中添加其他内容：

```
var b = {
    x : 3
}; 
```

您会注意到，虽然`b`有一个`x`属性（因此满足`fn`使用的要求`this`），但它没有引用 的属性`fn`。因此，如果我们想调用设置为的`fn`函数，似乎我们需要向 . 添加一个新属性。但是我们可以使用上述方法来显式设置为调用对象：`this``b``b``apply``fn``b`

```
fn.apply(b); //is 3 
```

这可用于通过创建新函数“包装器”将调用对象“永久”绑定到函数。它并不是真正的永久绑定，它只是创建一个新函数，用所需的调用对象调用旧函数。这样的工具通常是这样写的：

```
Function.prototype.bind = function (obj) {
    var self = this;
    return function() { 
        return self.apply(obj, arguments);
    };
}; 
```

因此，在执行该代码后，我们可以执行以下操作：

```
nothing(a.fn.bind(a))(); //is 1. 
```

这没什么难的。事实上，该`bind()`属性是内置在 ES5 中的，其工作方式与上面的简单代码非常相似。我们的`bind`代码实际上是一种非常复杂的方法来做一些我们可以做的更简单的事情。由于`a`has`fn`作为属性，我们可以使用点运算符直接调用它。我们可以跳过`call`and的所有令人困惑的用法`apply`。我们只需要确保当函数被调用时，它是使用点运算符调用的。我们可以在上面看到如何做到这一点，但在实践中，它更简单、更直观：

```
nothing(function () { return a.fn(); })(); //is 1 
```

一旦你了解了数据引用如何存储在闭包范围内，函数如何成为一等对象，以及调用对象如何工作，这一切都变得非常容易理解并且相当直观。

至于“代理”，它们也利用相同的概念来挂钩功能。因此，假设您想计算`a.fn`被调用的次数。您可以通过插入代理来做到这一点，就像这样（利用我们`bind`上面代码中的一些概念）：

```
var numCalls = (function () {
    var calls = 0, target = a.fn;

    a.fn = (function () {
         calls++;
         return target.apply(a, arguments);
    });

    return (function () {
        return calls;
    });
}()); 
```

所以现在，无论何时调用`numCalls()`，它都会返回被调用的次数，`a.fn()`而无需实际修改 ! 的功能`a.fn`。这很酷。但是，您必须记住，您确实更改了 引用的函数`a.fn`，因此回顾我们代码的开头，您会发现`a.fn`它不再相同，`fn`并且不能再互换使用。但现在原因应该很明显了！

我知道这基本上是在几页文本中进行的一周 JavaScript 教育，但这很简单。一旦你理解了这些概念，许多 JavaScript 模式的功能、有用性和威力就会变得很容易理解。

希望这能让事情更清楚！

**更新：**感谢@pimvdb 指出我不必要地使用`[].slice.call(arguments, 0)`. 我已将其删除，因为它是不必要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:36:12.227

基本上，`self.handleDrop`直接传递在功能上等同于传递以下函数：

```
function() {
  return self.handleDrop.apply(this, arguments);
} 
```

因为一切都传递给原始函数：

*   `this`价值_
*   论据
*   返回值

考虑到这一点，比较您的函数如下：

```
function(e) { self.handleDrop.call(self, e) }
function() { return self.handleDrop.apply(this, arguments); } 
```

与您的代理方式的区别是：

*   它不会通过返回值。
*   它不会传递所有参数（只有第一个，`e`）
*   它不会传递`this`值，而是使用预定义的值：`self`.

现在，前两项在这里没有什么区别，因为`addEventListener`它不关心返回值，而且它也只传递一个参数。

但第三项很重要：它`this`在函数中设置了不同的值。默认情况下，`this`是您将事件绑定到的元素（它由浏览器设置）。使用代理方式，您可以设置另一个`this`值。

现在，在您的代码段中，尚不完全清楚为什么每次`buildDropZone`调用时都要设置原型函数。通常你只定义一次原型函数。但是当你的处理程序`handleDrop`使用代理方式调用时，`this`是指`DndUpload`实例，这与原型函数大体一致。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T18:46:50.703

考虑下面的代码：

```
function printThis() {
  console.log(this);
}

var someObject = {
  performTest : function() {
    var self = this;

    someOtherObject.higherOrderFunction(printThis);
    someOtherObject.higherOrderFunction(function(){printThis.call(self)});
  }
}

var someOtherObject = {
  higherOrderFunction : function(f) {
      f();
  }
} 
```

会`someOtherObject.higherOrderFunction(printThis)`返回什么？怎么样`someOtherObject.higherOrderFunction(function(){printThis.call(self)})`

第一个问题的答案取决于您调用 someObject.performTest() 的对象和方式。如果我只是从全局上下文中调用 someObject.performTest() ，它可能会打印`Window`.

`someObject`无论如何，第二个总是会打印实例。

当您想要精确控制函数的执行上下文时，您称之为闭包或“代理模式”会派上用场。

注意：`this`在 javascript 中的行为与在其他语言中的行为不同（例如在 Java 中）。

# grails - 访问图像文件并在 grails 中查看它们

> ID：12412444
> 
> 赞同：0
> 
> 时间：2012-09-13T18:21:51.247
> 
> 标签：grails

> **可能重复：**
> [在 grails 中重定向](https://stackoverflow.com/questions/12410831/redirect-in-grails)

我有一个图片域，其中包含有关每个图像的以下信息：

```
String orgName
String newName
String urlOrg
String urlWeb
String urlThumb
Date   date
String caption 
```

我正在努力寻找一种方法来查看这些。我尝试将以下内容放在我的观点中：

```
<img src="${urlOrg}" alt="image"/> 
```

并让我的控制器像这样传递 urlOrg：

```
test(){
     [urlOrg : pictureInstance.urlOrg]
     } 
```

这不起作用，它只是在浏览器中给我一个长网址。我已经坚持了好几个小时，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:12:39.447

你为什么不尝试使用`<g:img>`？

您只需指定`dir=(something in /web-app/)`文件的目录和名称`file=(name you saved in the DB)`

这一切都在[此处的文档中进行了解释](http://grails.org/doc/2.1.0/ref/Tags/img.html)

# xml - 有没有办法在 Relax NG Compact 语法中限制 XML 属性的字符串长度？

> ID：12412448
> 
> 赞同：1
> 
> 时间：2012-09-13T18:22:02.453
> 
> 标签：xml, string, relaxng, string-length

我有一个属性，我想将其限制为最大 25 个字符。XML 模式是在 Relax NG Compact 语法中定义的。有没有办法指定这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:25:05.487

[是](http://www.relaxng.org/compact-tutorial-20030326.html#id2814737)的。

```
attribute myExample {
  xsd:string { maxLength = "25" }
} 
```

# jquery - jQuery 响应式导航

> ID：12412449
> 
> 赞同：0
> 
> 时间：2012-09-13T18:22:05.777
> 
> 标签：jquery, drupal, css, responsive-design

我使用 jQuery 脚本和 HTML/CSS 构建了一个响应式导航。但是，如果我查看主菜单项的子菜单项，我想添加一个活动类。

您在此处找到的当前结果：http: [//www.neofelis.de](http://www.neofelis.de/)

在 init.js 和 global.css 中，您可以找到源代码。

下一个问题是：如何在非活动菜单中向上滑动。示例：第一个主菜单在移动设备下向下滑动，我单击下一个主菜单项向上滑动。然后我希望另一个菜单滑入。

```
 $('body', context).once('accordionmenu', function () {
        $('body').bind('responsivelayout', function (e, d) {        

        //Define your drupal menu id (only works with core menu block)
          var menuid = "#block-menu-block-1";        

        //This condition will act under the 'mobile' size, and will not be executed on ie6 and ie7
          if (d.to == 'mobile' && !$('html').hasClass('ie6') && !$('html').hasClass('ie7')) {       

             //Remove the ´hover´ event in the dropdown menu scrip below              
             $(menuid+' li').unbind();

             //Add a span tag that will aft as the expand button, you can change the output of that button here
             $(menuid+" ul.menu li.expanded").prepend( $("<span class='over' href='#'>Down</span>") );     

             //Create an open/close action on the accordion after clicking on the expand element         
             $(menuid+' ul.menu span.over').click(function (event) {     
                 event.preventDefault();
                 if ($(this).siblings('ul').is( ":visible" )){
                 $(this).siblings('ul').slideUp('fast');  
                 } else {           
                 $(this).siblings('ul').slideDown('fast');  
             }                       
             });             
          }               
          //this condition will work for all sizes exept mobile, but will act on ie6 and ie7 browsers     
          if (d.to != 'mobile' | $('html').hasClass('ie7') ) {            
             //remove the expand elements from the accordion menu
             $(menuid+" span.over").remove();    
             //hide the open accordion items removing the display block style
             $(menuid+" ul li ul").removeAttr("style");  
             //Simple hide/show event for the dropdown menus 
             $(menuid+' li').hover(
                 function(){
                 $('ul:first', $(this)).show();
                 },
                 function(){
                 $('ul', $(this)).hide();
                 }
              );
          }             

        });
      });
    }
  }     
}(jQuery)); 
```

# jsp - 使用 Hbase REST 或 Hive 查询在 JSP 上显示数据？

> ID：12412451
> 
> 赞同：0
> 
> 时间：2012-09-13T18:22:18.667
> 
> 标签：jsp, hadoop, hbase, hive

如何在 JSP 上显示 HBase 数据？我应该使用 Hbase REST 还是 Hive 查询？哪个会花费更少的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:32:33.760

HBase API（REST、Java 或 thrift）将提供更好的性能。但是您应该仔细地为您的数据建模，以便它最适合您的预期查询。

# php - PHP Try Catch Exceptions 它是如何工作的

> ID：12412453
> 
> 赞同：0
> 
> 时间：2012-09-13T18:22:32.473
> 
> 标签：php

我是新来尝试在 php 中捕获的，我正在玩它。

当我尝试这个时，它工作正常

```
try {

    if (!$connect)
    {
        throw new Exception("it's not working");
    }
} catch (Exception $e) {
    $e->getMessage();
} 
```

当我尝试这个时，它不起作用

```
try {       
    if (!$connect) {
        throw new MyException("it's not working");
    }       
} catch (MyException $e) {
    echo $e->getMessage();
} 
```

我只更改了异常的名称，有人可以解释我哪里出错了。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:24:00.117

为了使用自定义异常，您需要扩展 Exception 类：

[http://php.net/manual/en/language.exceptions.extending.php](http://php.net/manual/en/language.exceptions.extending.php)

```
/**
 * Define a custom exception class
 */
class MyException extends Exception
{
    // Redefine the exception so message isn't optional
    public function __construct($message, $code = 0, Exception $previous = null) {
        // some code

        // make sure everything is assigned properly
        parent::__construct($message, $code, $previous);
    }

    // custom string representation of object
    public function __toString() {
        return __CLASS__ . ": [{$this->code}]: {$this->message}\n";
    }

    public function customFunction() {
        echo "A custom function for this type of exception\n";
    }
} 
```

# python - 如何添加到我在 Python 中迭代的循环

> ID：12412454
> 
> 赞同：1
> 
> 时间：2012-09-13T18:22:41.910
> 
> 标签：python, loops

我正在搜索脚本列表，在每个脚本中，我都在解析它，除此之外，还找到了下标。

每当我找到一个下标时，我都想将它添加到我正在搜索的脚本列表中。

我想出了这个while循环：

```
while keep_checking == True:
    TMP = deepcopy(FILE_LIST)
    for fname in TMP:
        if not fname in processed:
            SCL_FILE = fname
            break
    handleSCL(SCL_FILE)
    processed.add(SCL_FILE)
    if processed == FILE_LIST:
        keep_checking = False
        break 
```

上面的代码完成了这项工作，但我觉得`dirty. handleSCL()`正在搜索文件并将任何新的下标添加到`FILE_LIST`.

有更清洁的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:35:05.490

我会使用类似于 A* 寻路算法的方法（只是没有寻路部分）。

*   打开列表：~~放置~~尚未检查的文件。
*   关闭列表：~~放置~~已检查的文件。

首先将您的第一个文件添加到 openlist；然后遍历 openlist 中的每个元素。对于每个元素，查找所有文件，对于每个新文件，检查它是否在任一列表中。如果两者都没有，请将其添加到 openlist。完成元素后，将其添加到 closedlist。

这是一种非常有效且干净的方式，可以在不重复的情况下遍历所有元素。

编辑：经过进一步考虑，您可以使用一个有序列表，并遍历它，将新文件添加到列表末尾。[beginning-current] 是封闭列表，[current-end] 是开放列表。由于排序和路径成本计算，A* 需要两个列表，但您正在执行完整搜索，因此您不需要该功能。然后，您只需要为单个列表添加一个“如果不存在则添加”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:41:54.820

你的循环需要一些清理！

`break`将跳出while循环，不需要keep_checking。也不需要TMP，直接在for循环中使用。

```
while processed != FILE_LIST:
    for fname in deepcopy(FILE_LIST):
        if not fname in processed:
            SCL_FILE = fname
            break

    handleSCL(SCL_FILE)
    processed.add(SCL_FILE) 
```

将以更少的代码完成相同的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:33:20.833

经过深思熟虑，我最终编写了一个快速的自定义队列。

```
class PerQueue(object):

    def __init__(self):
        self._init()
        self.all_files = set()
        self.current   = None
        self.files     = set()
        self._init     = False
        self.cur_files = set()

    def _setflag(self, value):
        self._init = value
        for item in self.all_files:
            if item.startswith('ss'):
                self.cur_files.add(item)

    def _getflag(self):
        return self._init

    def empty(self):
        n = self._empty()
        return n

    def pushMany(self, itemList):
        for item in itemList:
            self.push(item)

    def push(self, item):
        if not item in self.all_files and not item in self.files:
            self._put(item)

    def pop(self):
        # I don't want errors
        if not self.empty():
            self.current = self._get()
            self.all_files.add(self.current)
            if self.init:
                self.cur_files.add(self.current)
        else:
            self.current = None
        return self.current

    def _init(self):
        self.files = set()

    def _empty(self):
        return not self.files

    def _get(self):
        return self.files.pop()

    def _put(self, item):
        self.files.add(item)

    init = property(_getflag, _setflag) 
```

这使我能够处理几个特殊条件（使用 all_files 和 cur_files）以及 init 标志。最多我们有几百个文件随时处理，所以我不担心大小限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-26T07:55:54.543

这会更干净......在这一点上可能没有必要：

```
for fname in deepcopy(FILE_LIST):
     handleSCL(fname) 
```

# android - Android：更新 ListView

> ID：12412465
> 
> 赞同：0
> 
> 时间：2012-09-13T18:23:16.653
> 
> 标签：android, listview, simplecursoradapter

好吧，我已经阅读了近 50 个与此问题相关的链接，但我的代码仍然无法正常工作。

我有一个扩展 SimpleCursorAdapter 类的自定义适配器，我使用该适配器在 onCreate 方法上填充 ListView

```
private void populateListView()
{
    String[] from = new String[] { SchemaHelper.TASK_DESCRIPTION, SchemaHelper.TASK_CREATED_ON, SchemaHelper.TASK_ID };

    int[] to = new int[] {R.id.lv_row_description, R.id.lv_row_created_on};

    tasksCursor = schemaHelper.getTasks();

    startManagingCursor(tasksCursor);

    tasksAdapter = new TasksAdapter(this, R.layout.tasks_listview_row, tasksCursor, from, to);

    setListAdapter(tasksAdapter);
} 
```

该应用程序是一个简单的任务管理器，我想在用户提交新任务时更新 ListView 内容，而无需再次调用 setListAdapter()。

我已经尝试过 notifyDataSetChanged（在 ui 线程上运行）、无效、重新查询（已弃用）......几乎所有内容。

我做错了什么？

编辑：这是我向数据库添加新任务的方法

```
private void addTask(String description)
{
    String message = "";

    schemaHelper.open();

    if(schemaHelper.isAlreadyInDatabase(description))
    {
        message = getString(R.string.task_already_exists);
    }
    else
    {
        message = getString(R.string.task_succesfully_added);

        schemaHelper.insertTask(description);

        populateListView();

        newTask.setText("");
    }

    schemaHelper.close();

    Toast.makeText(getApplicationContext(), message, Toast.LENGTH_SHORT).show();
} 
```

适配器类：

```
private class TasksAdapter extends SimpleCursorAdapter
{
    private LayoutInflater layoutInflater;

    private Cursor cursor;

    public TasksAdapter(Context context, int layout, Cursor c, String[] from, int[] to)
    {
        super(context, layout, c, from, to);

        cursor = c;

        cursor.moveToFirst();

        layoutInflater = LayoutInflater.from(context);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        if(cursor.getPosition() < 0)
        {
            cursor.moveToFirst();
        }
        else
        {
            cursor.moveToPosition(position); // Here throws the error
        }

        View row = layoutInflater.inflate(R.layout.tasks_listview_row, null);

        TextView description = (TextView) row.findViewById(R.id.lv_row_description);

        TextView createdOn = (TextView) row.findViewById(R.id.lv_row_created_on);

        description.setText(cursor.getString(cursor.getColumnIndexOrThrow(SchemaHelper.TASK_DESCRIPTION)));

        createdOn.setText(getString(R.string.added_on) + " " + TaskHelper.formatDateWithSuffix(cursor.getString(cursor.getColumnIndexOrThrow(SchemaHelper.TASK_CREATED_ON))));

        return row;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:36:25.223

如果您不想使用`requery()`，您可以简单地使用相同的查询传递一个新的 Cursor：

```
tasksCursor.close();
tasksCursor = schemaHelper.getTasks();
startManagingCursor(tasksCursor);
tasksAdapter.changeCursor(tasksCursor); 
```

* * *

我假设当您打电话时，`addTask()`您已经打过`populateListView()`一次电话。尝试更改`addTask()`为：

```
private void addTask(String description)
{
    String message = "";

    schemaHelper.open();

    if(schemaHelper.isAlreadyInDatabase(description))
    {
        message = getString(R.string.task_already_exists);
    }
    else
    {
        message = getString(R.string.task_succesfully_added);

        schemaHelper.insertTask(description);

        // Remove call to populateListView(), just update the Cursor 
        tasksCursor.close();
        tasksCursor = schemaHelper.getTasks();
        startManagingCursor(tasksCursor);
        tasksAdapter.changeCursor(tasksCursor);

        newTask.setText("");
    }

    schemaHelper.close();

    Toast.makeText(getApplicationContext(), message, Toast.LENGTH_SHORT).show();
} 
```

如果这“不起作用”，请更具体。它会抛出错误吗，如果是这样，那是什么样的？

* * *

您在适配器中做了太多的工作。请在 Google Talks 上观看 Android 的 Romain Guy 讨论[适配器和`getView()`](http://www.google.com/events/io/2009/sessions/TurboChargeUiAndroidFast.html). 但是，由于您只想将一个特殊字符串传递给您的`createdOn`TextView，让我们做一些非常不同的事情并覆盖`setViewText()`：

尝试这个：

```
public class TasksAdapter extends SimpleCursorAdapter {
    String prefix;
    public TasksAdapter(Context context, int layout, Cursor cursor, String[] from, int[] to) {
        super(context, layout, cursor, from, to);
        // This is constant so set it once and consider adding the space to the end of the String in strings.xml
        prefix = getString(R.string.added_on) + " ";
    }

    @Override
    public void setViewText(TextView v, String text) {
        if(v.getId() == R.id.lv_row_created_on)
            v.setText(prefix + TaskHelper.formatDateWithSuffix(text));
        else
            super.setViewText(v, text);
    }
} 
```

其余数据由 SimpleCursorAdapter 的现有方法处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:30:24.903

我不太了解 taskCursor 和 taskAdapter，但我猜我使用了 ArrayAdapter，看看我的代码并得出你自己的结论。

```
 //LISTVIEW database CONTATO
    ListView user = (ListView) findViewById(R.id.lvShowContatos);
    //String = simple value ||| String[] = multiple values/columns
    String[] campos = new String[] {"nome", "telefone"};

    list = new ArrayList<String>();
    Cursor c = db.query( "contatos", campos, null, null, null, null, "nome" + " ASC ");
    c.moveToFirst();
    String lista = "";
    if(c.getCount() > 0) {
        while(true) {
           list.add(c.getString(c.getColumnIndex("nome")).toString());
            if(!c.moveToNext()) break;
        }
    }

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, list);

    user.setAdapter(adapter); 
```

# ios - Titanium - 视图上的点击事件被忽略

> ID：12412469
> 
> 赞同：1
> 
> 时间：2012-09-13T18:23:20.257
> 
> 标签：ios, events, titanium, appcelerator

我正在研究 Titanium 并为 iOS 设备开发。在我的应用程序中，我有一个`tableview`由函数创建的行填充的部分，该函数使用从`HTTPClient`对象响应接收到的数据。每行都有一个视图，在视图内有一个按钮和标签。

该按钮有一个`click`工作正常的事件。我向存储按钮的视图添加了一个单击事件，但是当我单击视图时，不会触发该事件，但是如果我单击该按钮，则会触发按钮的事件和视图的事件。这不是它应该表现的方式，因为我希望视图的事件做一些与按钮事件完全不同的事情。

为什么当我点击视图时视图的点击事件没有被触发？为什么单击按钮时会触发事件？

这是我创建行的方式：

```
function addToDo(title, priority){

    var that = {};      
    var row = Ti.UI.createTableViewRow({height:80});        
    that.currentPriority = priority;        
    that.resolveColor = function(tmpPriority){          
        switch(tmpPriority){                
            case 0: backgroundColorPriority = "#da362a"; break;
            case 1: backgroundColorPriority = "#da6c2a"; break;
            case 2: backgroundColorPriority = "#da962a"; break;
            case 3: backgroundColorPriority = "#dacb2a"; break;                         
        }               
        return backgroundColorPriority;
    }

    var rowLayout = Ti.UI.createView({
        backgroundColor : 'transparent'
    });

    var checkbox = Ti.UI.createButton({
        top: 25,
        left: 5,
        width: 30,
        height: 30,
        borderColor: 'white',
        borderWidth: 2,
        borderRadius: 1,
        backgroundColor: '#b1b1b1',
        backgroundImage: 'NONE',
        zIndex:10,
        value: false //value is a custom property in this case here.
    });
    rowLayout.add(checkbox);

    //Attach some simple on/off actions
    checkbox.on = function(item) {
        this.backgroundColor = '#62b425';

        item.currentRow.backgroundColor = "#101010";
        this.value = true;
    };

    checkbox.off = function(item) {
        this.backgroundColor = '#b1b1b1';
        item.currentRow.backgroundColor = item.resolveColor(item.currentPriority);
        this.value = false;
    };

    checkbox.addEventListener('click', function(e) {
        if(false == e.source.value) {
            e.source.on(that);
        } else {
            e.source.off(that); 
        }
    });

    // Create a Label.
    var todoTitleLabel = Ti.UI.createLabel({
        text : title,
        color : 'white',
        font : {fontSize:11},
        left : 40,
        textAlign : 'center'
    });

    // Add to the parent view.
    rowLayout.add(todoTitleLabel);

    row.add(rowLayout);

    rowLayout.addEventListener('click', function(e){
        // Whatever I put here isn't executed when I click on the rowLayout, instead I have to click the button to fire this event, that shouldn't happen
    });

    var backgroundColorPriority = that.resolveColor(that.currentPriority);      
    row.backgroundColor = backgroundColorPriority
    that.currentRow = row;
    return that.currentRow;

} 
```

此函数在 HTTPClient onload 中调用：

```
var clientTask = Ti.Network.createHTTPClient({
    onload : function(e){
        var responseTask = JSON.parse(this.responseText);
        var entriesTask = responseTask.tasks;
        var todoSectionView = Ti.UI.createTableViewSection({
            headerTitle : responseTask.name
        });
        data.push(todoSectionView);
        for( var j=0; j < entriesTask.length; j++){
           var tmpRow = addToDo(entriesTask[j].name, entriesTask[j].priority);
           todoSectionView.add(tmpRow);
        }
        // add the data to the tableview
        table.data=data;
        self.updateLayout();
    },
    timeout : 60000
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:45:29.923

我可能会通过为 todoTitleLabel 创建一个事件处理程序或给它一个与行不同的背景颜色来测试这一点，以查看我是否能够单击行本身。也许它上面的物体挡住了它？也许您可以通过将点击事件添加到标签来完成您想要做的事情？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T13:05:20.310

不要将事件监听器添加到行、节或行布局中。它会在iOS上引起问题。

相反，将事件监听器添加到您的表视图中，例如：

```
tableView.addEventListener('click', function(e){
   var rowNumber = e.index;
   alert(rowNumber);
}); 
```

该示例将提醒所选行的编号。

# ruby - 处理这个大文本文件的最高效方式是什么？

> ID：12412474
> 
> 赞同：2
> 
> 时间：2012-09-13T18:23:56.043
> 
> 标签：ruby

当我将文本文件读入内存时，由于新行，它会将我的文本带入末尾并带有 '\n' 。

```
["Hello\n", "my\n", "name\n", "is\n", "John\n"] 
```

这是我阅读文本文件的方式

```
array = File.readlines('text_file.txt') 
```

我需要对这个文本数组进行大量处理，所以我想知道是否应该在第一次创建数组时删除“\n”，或者当我使用正则表达式对每个元素进行处理时，性能明智。

我写了一些（诚然不好的）测试代码来删除“\ n”

```
array = []
File.open('text_file.txt', "r").each_line do |line|
    data = line.split(/\n/)
    array << data
end
array.flatten! 
```

如果我在第一次创建数组时应该删除“\n”，有没有更好的方法来做到这一点？

如果我想将文件读入 Set 而不是（为了性能），是否有类似于 readlines 的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:35:00.247

我会使用[String#chomp](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-chomp)：

```
lines = open('text_file.txt').lines.map(&:chomp) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T18:29:47.780

您需要运行基准测试，使用 Ruby 的内置[基准](http://ruby-doc.org/stdlib-1.9.3/libdoc/benchmark/rdoc/Benchmark.html)来确定您最快的选择。

但是，根据经验，我发现“啜饮”文件，即一次读取所有文件，并不比使用带有[`IO.foreach`or`File.foreach`](http://www.ruby-doc.org/core-1.9.3/IO.html#method-c-foreach)的循环快。这是因为 Ruby 和底层操作系统会在读取发生时进行文件缓冲，从而允许您的循环从内存发生，而不是直接从磁盘发生。`foreach`不会像那样为您剥离行终止符`split`，因此您需要添加 a`chomp`或者`chomp!`如果您想改变读入的行：

```
File.foreach('/path/to/file') do |li|
  puts li.chomp
end 
```

或者

```
File.foreach('/path/to/file') do |li|
  li.chomp!
  puts li
end 
```

此外，slurping 存在不可扩展的问题。您最终可能会尝试读取比内存更大的文件，从而使您的机器陷入瘫痪，而逐行读取则永远不会这样做。

* * *

以下是一些性能数据：

```
#!/usr/bin/env ruby

require 'benchmark'
require 'fileutils'

FILENAME = 'test.txt'
LOOPS = 1

puts "Ruby Version: #{RUBY_VERSION}"
puts "Filesize being read: #{File.size(FILENAME)}"
puts "Lines in file: #{`wc -l #{FILENAME}`.split.first}"

Benchmark.bm(20) do |x|
  x.report('read.split')           { LOOPS.times { File.read(FILENAME).split("\n") }}
  x.report('read.lines.chomp')     { LOOPS.times { File.read(FILENAME).lines.map(&:chomp) }}
  x.report('readlines.map.chomp1') { LOOPS.times { File.readlines(FILENAME).map(&:chomp) }}
  x.report('readlines.map.chomp2') { LOOPS.times { File.readlines(FILENAME).map{ |s| s.chomp } }}
  x.report('foreach.map.chomp1')   { LOOPS.times { File.foreach(FILENAME).map(&:chomp) }}
  x.report('foreach.map.chomp2')   { LOOPS.times { File.foreach(FILENAME).map{ |s| s.chomp } }}
end 
```

结果：

```
Ruby Version: 1.9.3
Filesize being read: 42026131
Lines in file: 465440
                           user     system      total        real
read.split             0.150000   0.060000   0.210000 (  0.213365)
read.lines.chomp       0.470000   0.070000   0.540000 (  0.541266)
readlines.map.chomp1   0.450000   0.090000   0.540000 (  0.535465)
readlines.map.chomp2   0.550000   0.060000   0.610000 (  0.616674)
foreach.map.chomp1     0.580000   0.060000   0.640000 (  0.641563)
foreach.map.chomp2     0.620000   0.050000   0.670000 (  0.662912) 
```

在今天的机器上，一个 42MB 的文件可以很安全地读入 RAM。我看到的文件比我们的一些生产主机的内存大得多。虽然`foreach`速度较慢，但​​如果没有足够的内存，它也不会通过吸收所有内存来让机器瘫痪。

在 Ruby 1.9.3 上，使用该`map(&:chomp)`方法而不是旧形式的`map { |s| s.chomp }`，要快得多。旧版本的 Ruby 并非如此，因此请谨慎购买。

另外，请注意，在我几年前的 Mac Pro 上，上述所有操作都在不到一秒的时间内处理了数据。总而言之，我会说担心加载速度是过早的优化，真正的问题是加载数据后要做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:35:08.297

如果您想摆脱结束换行符，您可以使用[String#chomp](http://rdoc.info/stdlib/core/String#chomp-instance_method)或[String#rstrip](http://rdoc.info/stdlib/core/String#rstrip-instance_method)。我的首选方法是 chomp。

因此，您可以轻松地执行以下操作：

```
lines.map! { |line| line.chomp }
# or
lines.map! { |line| line.rstrip } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:39:03.147

```
mvelez@argo:~$ cat test.txt
Hello
my
name
is
John 
```

一个班轮：

```
arr = File.open("test.txt",'r').read.split 
```

分解这个`irb`

```
irb(main):002:0> f = File.open("test.txt",'r')
=> #<File:test.txt>
irb(main):003:0> file_contents = f.read
=> "Hello\nmy\nname\nis\nJohn\n\n"
irb(main):004:0> file_contents.split
=> ["Hello", "my", "name", "is", "John"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T18:33:55.737

在这些情况下，我更喜欢使用 strip 而不是 split ，并在第一次处理线路后立即执行此操作。在 readline 之后使用 split 是过度杀伤 imo。所以代码片段将是

```
array = []
File.open('text_file.txt', "r").each_line do |line|
    array << data.strip
end 
```

# string - 有没有办法在不删除分隔符的情况下在处理中拆分字符串？

> ID：12412478
> 
> 赞同：1
> 
> 时间：2012-09-13T18:24:22.283
> 
> 标签：string, split, processing, delimiter

这是我的代码：

```
String abc = "abcdefghijklmnopqrstuvwxyz";

String [] abc1 = split(abc,b);

println (abc1); 
```

...而这里的价值在于打印的内容：

```
[0] "a"
[1] "cdefghijklmnopqrstuvwxyz" 
```

'b' 是否可以包含在任何一个拆分字符串中？我不是一个经验丰富的程序员，所以任何帮助一如既往地非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:52:49.537

我猜你正在寻找[String](http://processing.org/reference/String.html)的[substring()](http://processing.org/reference/String_substring_.html)和[indexOf()](http://processing.org/reference/String_indexOf_.html)方法：

```
String abc = "abcdefghijklmnopqrstuvwxyz";

println(abc.substring(0,abc.indexOf("b")));  //start to b
println(abc.substring(abc.indexOf("b")));    //b to end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:07:25.967

另一种选择是只添加'b'。你知道你的分隔符是什么，你知道它在哪里，所以你可以手动重新添加它：

```
for (int i=0; i<abc.length; i++) {
    if (i > 0) {
        abc[i] = 'b' + abc[i] + 'b';
    }
}
abc[0] = abc[0] + 'b';
abc[abc.length-1] = 'b' + abc[abc.length-1]; 
```

不过，使用 substring() 和 indexOf() 更为正统。

# ruby-on-rails - 如何从规范或 Rails 控制台调用类、after_create 方法

> ID：12412480
> 
> 赞同：0
> 
> 时间：2012-09-13T18:24:29.193
> 
> 标签：ruby-on-rails, ruby

我有以下

```
class Item < ActiveRecord::Base
    after_create TellMe
end

class TellMe
  def self.after_create(model)
end 
```

并希望能够做类似的事情：

```
i=Item.new :name => 'my test name'
i.send(:TellMe.after_create) 
```

类似于我如何在公共方法上调用发送？看起来我可以

```
i.instance_eval 'TellMe.after_create(self)' 
```

但感觉有点丑（除其他外）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T22:54:24.553

触发回调的唯一方法是做一个合格的事件，在这种情况下，创建一个项目。

作为您想要的解决方法，您可以创建另一个方法，该方法将完全执行回调将执行的操作，并且您可以像平常一样访问它

```
Class Item < ActiveRecord::Base

  def tellme(params)
    TellMe.function(params)
  end

end 
```

# python - Python Shell 错误

> ID：12412483
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:24:39.100
> 
> 标签：python

我一直在 python shell-版本 2.7.3 中使用此代码，我收到此错误。代码似乎没问题，我不明白我哪里出错了。

这是错误：

```
Traceback (most recent call last):
      File "C:\Python27\problem8euler.py", line 25, in <module>
        num.append(int(char))
    ValueError: invalid literal for int() with base 10: '' 
```

这是我的代码：

```
string = # that really long number, edited out for page-width-sanity 

num = [] 

for char in string: 
    num.append(int(char)) 

answers = [] 

i = 0 

while i <= len(num) - 5: 
    k = i + 1 
    l = i + 2 
    m = i + 3 
    n = i + 4 
    prod = ( num[i] * num[k] * num[l] * num[m] * num[n]) 
    answers.append(prod) 
    i += 1 

print max(answers) 
```

该代码是我对 Project Euler 问题 8 的解决方案。

评论将不胜感激我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:28:15.067

`string`包含一个空格字符。您调用`int`中的每个字符`string`，但`int(' ')`失败了：

```
>>> int(' ')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 10: '' 
```

只需删除空格字符即可解决问题，或跳过 中的空格`string`，如下所示：

```
string = '1 2'
num = [int(c) for c in string if not c.isspace()] 
```

（该`[.. for ..]`构造称为[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)。）

# java - 在 Android 中结合 Handler 和 AsyncTask - 明显的缺陷？

> ID：12412487
> 
> 赞同：2
> 
> 时间：2012-09-13T18:24:54.113
> 
> 标签：java, android

我有一个简单的 Android 应用程序，它使用 AsyncTasks 进行 I/O。一个常见的模式：

*   用户单击按钮
*   作为响应，onClick 处理程序实例化并 .execute()s 一个 AsyncTask
*   AsyncTask 完成后，应该以某种方式更新 UI

根据 AsyncTask 的文档，完成 UI 更新的正确方法是覆盖 AsyncTask 类中的 onPostExecute - 这将在执行后在 UI 线程上被调用，因此可以触摸小部件等。

但是，我认为 onPostExecute 应该对 UI 元素有任何形式的硬引用似乎是错误的。我更愿意将 I/O 任务和 UI 代码分开。相反，这似乎是我应该将不透明回调传递给 AsyncTask 的明显情况——回调保留对 UI 元素的引用，因此我们在代码中保持隔离和可重用性。一个经典的委托模式（或者可能是监听器、事件等，这里有很多选项）。

例如，下面的代码对我来说似乎是错误的：

```
 class QueryJobsDBTask extends AsyncTask<Void, Void, ArrayList<ContentValues>> {

    @Override
    protected void onPostExecute(ArrayList<ContentValues> freshJobsData) {
        someList.clear();
        someList.addAll(freshJobsData);

        // BUG why does my DB query class hold UI references?
        someAdapter.notifyDataSetChanged();
    } 
```

经过一番研究，看起来 Handler 类是在这里完成委托模式的最直接和最轻量级的方式。我可以为 I/O 编写可重用的 AsyncTask，并通过 Handler 实例为每个实例指定上下文 UI 更新回调。所以我实现了这个新的支持 Handler 的基类

```
 public abstract class HandlerAsyncTask<Params, Progress, Result> extends AsyncTask<Params, Progress, Result> {
    private Handler preExecuteHandler, postExecuteHandler;

    public void setPreExecuteHandler(Handler preExecuteHandler) {
        this.preExecuteHandler = preExecuteHandler;
    }

    public void setPostExecuteHandler(Handler postExecuteHandler) {
        this.postExecuteHandler = postExecuteHandler;
    }

    @Override
    protected void onPreExecute() {
        if (preExecuteHandler != null) {
            preExecuteHandler.sendMessage(Message.obtain());
        }
    }

    @Override
    protected void onPostExecute(Result result) {
        if (postExecuteHandler != null) {
            Message msg = Message.obtain();
            msg.obj = result;
            postExecuteHandler.sendMessage(msg);
        }
    }
} 
```

瞧，我所有的 I/O 任务现在都从 UI 中正确分区了——我仍然可以在需要时通过 Handler 实例指定简单的 UI 更新回调。这对我来说似乎直截了当、灵活且优越……所以我当然想知道我错过了什么。

**当前的框架解决方案如何优越？**这种方法是否存在一些重大缺陷？据我所知，代码执行和线程的拓扑在运行时是完全相同的，只是代码耦合更松散（堆栈上还有一些额外的帧）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:41:08.053

这与其说是优势问题，不如说是目的和用例。AsyncTask 通常在 Activity 中编写为私有类（或匿名内联声明），因此继承了 Activity 对无论如何都需要更新的各种 UI 元素的引用。

如果 AsyncTask 具有足够的大小和/或复杂性，应该将其拉出到自己的类中，并且可以被其他类重用，那么使用 Handlers 进行更好的解耦是一个好主意。只是它通常不是必需的，因为 AsyncTask 正在完成特定于定义它的 Activity 的某些事情，而对于简单的那些，相应的处理程序代码甚至可能比整个 AsyncTask 本身更大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:49:51.947

这是在小型项目中分离 UI/Background 任务的优雅解决方案，尽管传递 Runnables 更加优雅。请记住，AsyncTask 是 Thread/Handler 的包装器，因此您正在加倍处理已经在幕后进行的线程消息传递。这里的缺陷是，如果您将 AsyncTask 设计为可重用，则需要确保您正在运行的 IO 都是线程安全的，因为各种 AsyncTask 之间没有关于谁处于活动状态或访问哪个资源。如果您需要将后台任务排队而不是仅仅触发它们，则 IntentService 可能更合适。

# iphone - 从其他 uiview 控制器类启用按钮

> ID：12412490
> 
> 赞同：0
> 
> 时间：2012-09-13T18:25:04.780
> 
> 标签：iphone, ios

我正在尝试从其他 uiviewcontroller 的 uiviewcontroller 类启用按钮，但我无法启用它。这是我正在做的代码

```
@implementation InAppClass
- (void)recordTransaction:(SKPaymentTransaction *)transaction 
{    

if ([transaction.payment.productIdentifier isEqualToString:idstring])
  {               
  generateAdviceViewController *objgenerate= [[generateAdviceViewController alloc]init ];
    [objgenerate enableDisableMethod];
    [objgenerate release];
   }
}
@end

@implementation generateAdviceViewController
-(id)enableDisableMethod
{
[self->generateButton setEnabled:TRUE];
return self;
}
@end 
```

我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:21:38.147

看起来您在加载 generateAdviceViewController 的视图之前启用了生成按钮...在您创建 generateAdviceViewController 后请参阅此视图，如下所示：

```
[objgenerate view]; 
```

然后调用 enableDisableMethod。

代码看起来很奇怪。只是例子吗？

# vb6 - vb6 oracle9i 应用程序，逻辑错误记录集保持为空

> ID：12412496
> 
> 赞同：0
> 
> 时间：2012-09-13T18:25:40.473
> 
> 标签：vb6, oracle9i, recordset

目前我正在从事一个项目，该项目迫使我在我的应用程序中使用 Vb6 作为前端，使用 Oracle 9i 作为后端。我需要从 oracle 中的表中检索数据，并以 VB6 形式显示。我为此使用了一个记录集，但由于某种原因，即使相关表中存在有效记录，它也不包含任何记录。谁能告诉我怎么了？任何帮助，将不胜感激。我的代码如下 -

```
Private Sub Command1_Click()
Dim sql As String
Set rs = New ADODB.Recordset
sql = "select test23.phoname from test23 where test23.ops='" + Text1.Text + "'"
rs.Open sql, con, adOpenStatic, adLockOptimistic
If rs.EOF = False Then
    Form7.Show
    Form7.Label2.Caption = rs.Fields("phoname")
End If
End Sub 
```

if 语句从不执行，因为记录集似乎总是空的。如果我删除 EOF 条件，我会收到运行时错误 3021。我的 sql 查询有问题吗？表 test23 已经存在于我的 oracle 数据库中，其属性为 serialno、phoname 和 ops。谢谢-罗恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:34:34.070

几年前，我自己也曾为此苦苦挣扎。问题可能出在几个方面：特别是连接、Oracle 驱动程序、Oracle 主目录或查询本身。

我强烈建议您下载免费版本的 TOAD，这将允许您测试您的连接（我假设是某种 ODBC），然后您可以使用 TOAD 手动执行查询。

你有任何例外吗？

希望从此您可以更正您的代码/连接/查询。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:41:32.937

我还要指出 adoOpenStatic 和 adoLockOptimistic 是互斥的属性值，因为乐观锁定仅适用于可更新的记录集，而静​​态记录集不可更新（除了 adoLockBatchOptimistic 的批处理模式）。这可能会以某种方式混淆 Oracle OLEDB 提供程序。

# c - Xcode 从 OpenCL 内核生成看似无效的代码

> ID：12412499
> 
> 赞同：0
> 
> 时间：2012-09-13T18:26:03.797
> 
> 标签：c, xcode, macos, opencl

Xcode 自动生成用于将 OpenCL 内核提交到调度队列的代码，但它似乎生成了无法为我的内核之一编译的无效代码。问题在于结构定义：

```
typedef struct {
    float4 position;    ///< The point position.
    float4 velocity;    ///< The point velocity.
    float intensity;    ///< The point intensity.
    int links[6];       ///< The point links specified as indexes for other points in the array.
    float align;        ///< Dummy for alignment.
} PointElement; 
```

此代码由 Xcode 生成：

```
typedef struct  {
  cl_float4 position;
  cl_float4 velocity;
  cl_float intensity;
  int [6] links;
  cl_float align;
} _PointElement_unalign; 
```

我不是晦涩的 C 语法变体专家，但它肯定`int [6] links;`不是有效的 C，因此无法编译。

为什么 Xcode 会这样做？我自己做错了什么还是这是一个错误？

# powershell - 仅使用 PowerShell 递归子文件夹 x 级数

> ID：12412500
> 
> 赞同：2
> 
> 时间：2012-09-13T18:26:18.413
> 
> 标签：powershell

下面的 PowerShell 脚本将列出所有共享文件夹（不包括隐藏的共享文件夹），然后列出所有子文件夹，最后获取每个子文件夹的 ACL 信息并导出为 CSV 文件。

但是，我正在尝试设置它可以钻入的子文件夹的限制。例如，如果我将其设置为 3，则脚本将获取前三个子文件夹的 ACL 信息。我怎样才能做到这一点？

输入：

```
path=\\server\sharefolder0\subfolder01\subfolder02
path=\\server\sharefolder1\subfolder11\subfolder12\subfolder13\subfolder14
path=\\server\sharefolder2 
```

预期结果：

```
path=\\server\sharefolder0
path=\\server\sharefolder0\subfolder01
path=\\server\sharefolder0\subfolder01\subfolder02
path=\\server\sharefolder1
path=\\server\sharefolder1\subfolder11
path=\\server\sharefolder1\subfolder11\subfolder12
path=\\server\sharefolder2 
```

这是代码：

```
$getSRVlist = Get-Content .\server.txt
$outputDirPath=".\DirPathList.txt"
$outputACLInfo=".\ACLInfo.CSV"
$header="FolderPath,IdentityReference,Rights"
Del $outputACLInfo
add-content -value $header -path $outputACLInfo
foreach ($readSRVlist in $getSRVlist)
{
   foreach ($readShareInfoList in $getShareInfoList=Get-WmiObject Win32_Share
   -computerName $readSRVlist | Where {$_.name -notlike "*$"} | %{$_.Name})
   {
      foreach ($readDirPathList in
      $getDirPathList=get-childitem \\$readSRVlist\$readShareInfoList -recurse
      | where {$_.PSIsContainer})# | %{$_.fullname})
      {
         $getACLList=get-ACL $readDirPathList.fullname | ForEach-Object
         {$_.Access}
         foreach ($readACLList in $getACLList)
         {
            $a = $readDirPathList.fullname + "," +
            $readACLList.IdentityReference + "," +  $readACLList.FileSystemRights
            add-content -value $a -path $outputACLInfo
         }
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T18:44:45.367

递归是你的朋友。试试这个：

```
$maxDepth = 3

function TraverseFolders($folder, $remainingDepth) {
  Get-ChildItem $folder | Where-Object { $_.PSIsContainer } | ForEach-Object {
    if ($remainingDepth -gt 1) {
      TraverseFolders $_.FullName ($remainingDepth - 1)
    }
  }
}

TraverseFolders "C:\BASE\PATH" $maxDepth 
```

**编辑：**现在我明白你的意思了。要检查给定路径的前三个父文件夹，请尝试以下操作：

```
$server   = "\\server\"
$path = ($args[0] -replace [regex]::escape($server), "").Split("\\")[0..2]
for ($i = 0; $i -lt $path.Length; $i++) {
  Get-ACL ($server + [string]::join("\", $path[0..$i])
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-08-30T14:46:38.457

在较新版本的 powershell 中，可以使用`-DEPTH`参数，One liner 可以帮助-

```
 get-childitem -path \\server\folder -Depth 2 -Directory | Select-object -Property Name, Fullname 
```

它将搜索 2 个嵌套文件夹，并提供该特定文件夹的文件夹名称和完整路径。在版本**-PSVersion 5.1.17134.858中测试**

# wpf - WPF XAML 事件中的空“发件人”

> ID：12412501
> 
> 赞同：0
> 
> 时间：2012-09-13T18:26:23.123
> 
> 标签：wpf, xaml, event-handling

我在这里读到 Sender 在事件处理程序中永远不应该为空（[Konrad Rudolph对“](https://stackoverflow.com/users/1968/konrad-rudolph)[处理 NULL 的最佳方式](https://stackoverflow.com/questions/3812984/best-way-to-handle-a-null)”的回答）。

但是，我的事件处理程序从 WPF XAML 获得了一个空发送者。

这是 XAML：

```
<Storyboard x:Name="Storyboard"  CurrentTimeInvalidated="StoryboardChanged"> 
```

在主窗口中，这是事件处理程序：

```
private void StoryboardChanged(object sender, EventArgs e)
{
        try
        {
            #region VerifyInputs

            Validator.Verify(sender); <------------------- aborts on null 
```

所以，我的问题是： **我应该如何修复我的 XAML 以便 WPF 发送一个非空的“发件人”值？**

**编辑**：用我不假思索的 Validator.Verify 复制/粘贴来解决问题的应用程序。这个方法只是检查参数是否为空：

> ```
>  public static void Verify(Object theObj)
>     {
>         if (theObj == null)
>         {
>             string errMsg = "theObj is null";
>             Debug.Assert(theObj != null, errMsg);
>             throw new ApplicationException(errMsg);
>         }
>     } 
> ```

* * *

**编辑**：

中止，中止，中止

对不起。发件人不为空，e 为

:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:34:10.643

我认为问题可能是您的 Validator 类期望发件人是什么。对于 CurrentTimeInvalidated 事件处理程序，“发送者”不是 Storyboard，而是 System.Media.Animation.Clock。如果您的验证器验证方法期待其他内容，它将被视为#null。

（即，如果签名类似于 Verify(object sender) 并且您的实现执行类似于“sender as Storyboard”之类的操作，它将以空值结束。）

# c# - 服务器端重定向 (HttpResponse.Redirect) 会再次命中负载均衡器吗？

> ID：12412504
> 
> 赞同：6
> 
> 时间：2012-09-13T18:26:46.243
> 
> 标签：c#, asp.net, redirect, load-balancing

Web 服务器位于负载平衡器后面。我正在做一个 HttpResponse.Redirect("anotherpage") 。这个重定向会再次通过负载均衡器吗？我很困惑，因为这是服务器端重定向，而不是来自客户端的重定向。

我想知道这一点以确定重定向的 url 是否由负载均衡器确定的不同 Web 服务器提供服务。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:28:33.433

HttpResponse.Redirect 实际上不是服务器端重定向。在响应流中设置它实际上会向浏览器发送一个 302“临时移动”响应，指示它尝试另一个 URL（“anotherroute”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T21:00:45.363

如果您不希望这种行为，您可以使用 Server.Transfer(url); 这里有一个很好的解释：http: [//www.developer.com/net/asp/article.php/3299641/ServerTransfer-Vs-ResponseRedirect.htm](http://www.developer.com/net/asp/article.php/3299641/ServerTransfer-Vs-ResponseRedirect.htm)

# java - Endeca 导航引擎无法处理请求

> ID：12412505
> 
> 赞同：0
> 
> 时间：2012-09-13T18:27:00.133
> 
> 标签：java, navigation, runtime-error, endeca

我们在我们的项目中使用endeca。有一个运行良好的endeca应用程序。所有机器都指向该应用程序并且工作正常。但是一段时间后在其中一台机器上。它抛出ENEException说endeca导航引擎无法处理请求。我们无法复制它，但这种情况每天发生四次。作为临时解决方案，我们需要重新启动该机器上的应用程序（Web）服务器，一切都很好。我们无法弄清楚它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T15:57:30.863

可能是与网络相关的问题，但如果没有更多细节就很难说。你可以试试：[https ://endecacommunity.com/](https://endecacommunity.com/)

这是一个优秀的 Endeca 支持论坛

# mysql - MySQL：innoDB 和 MyISAM 之间的索引差异

> ID：12412509
> 
> 赞同：0
> 
> 时间：2012-09-13T18:27:16.493
> 
> 标签：mysql, indexing, innodb, myisam

innoDB 和 MyISAM 中的索引之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:31:15.823

参考这个：

[https://dba.stackexchange.com/questions/1/what-are-the-main-differences-between-innodb-and-myisam](https://dba.stackexchange.com/questions/1/what-are-the-main-differences-between-innodb-and-myisam)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-13T18:35:13.397

InnoDB 是一个完全[符合 ACID](https://en.wikipedia.org/wiki/ACID)的数据库，支持事务、[MVCC](https://en.wikipedia.org/wiki/Multiversion_concurrency_control)、复制，并且像现代文件系统一样保存更改日志，以便在突然崩溃或硬件故障的情况下，它可以恢复到数据库的最后一个已知良好状态.

MyISAM 是 MySQL 的原始数据库引擎，专注于速度而不是可靠性。它缺乏事务支持并且不使用日志，因此如果数据库崩溃，它很容易损坏。在这方面，它很像 Linux`ext2`文件系统。这是一个高端计算机可能拥有全部256MB内存而9GB硬盘被认为是大的时代的产物。

虽然在过时的硬件上 MyISAM 是必需的，但在现代硬件上 InnoDB 实际上表现更好。自推出以来，它一直在不断改进，并进行了积极优化。MySQL 的每个版本都继续提升 InnoDB 的性能，而 MyISAM 基本上保持不变，纯粹是为了遗留问题。

因此，除非您有充分的理由，否则您应该将 InnoDB 用于所有新应用程序。

# iphone - 将间接指针强制转换为 Objective-C 指针

> ID：12412510
> 
> 赞同：12
> 
> 时间：2012-09-13T18:27:31.813
> 
> 标签：iphone, objective-c, ios, ipad

我有以下代码：

```
 OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)attrDictionary, (CFTypeRef *)&value); 
```

这会导致以下错误：

```
Implicit conversion of an indirect pointer to an Objective-C pointer to 'CFTypeRef *' (aka 'const void **') is disallowed with ARC 
```

关于如何解决这个问题的任何想法？我尝试过更改`CFTypeRef *`为 an`id *`但没有成功

这是完整的方法：

```
+ (NSData *)keychainValueForKey:(NSString *)key {
  if (key == nil) {
    return nil;
  }

  NSMutableDictionary *attrDictionary = [self attributesDictionaryForKey:key];

  // Only want one match
  [attrDictionary setObject:(id)kSecMatchLimitOne forKey:(id)kSecMatchLimit];

  // Only one value being searched only need a bool to tell us if it was successful
  [attrDictionary setObject:(id)kCFBooleanTrue forKey:(id)kSecReturnData];

  NSData *value = nil;
  OSStatus status = SecItemCopyMatching((CFDictionaryRef)attrDictionary, (CFTypeRef *)&value);
  if (status != errSecSuccess) {
    DLog(@"KeychainUtils keychainValueForKey: - Error finding keychain value for key. Status code = %d", status);
  }
  return [value autorelease];
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-13T18:42:47.150

您可以将其转换为`void *`：

```
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)attrDictionary,
    (void *)&value); 
```

如果您使用的是 Objective-C++，您可能需要转换两次：

```
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)attrDictionary,
    (CFTypeRef *)(void *)&value); 
```

或者您可以使用临时变量：

```
CFTypeRef cfValue = NULL;
OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)attrDictionary, &cfValue);
NSData *value = (__bridge id)cfValue; 
```

# java - 在 Eclipse 的 Java 调试器中，如何在某个类的每个对象创建上设置断点？

> ID：12412511
> 
> 赞同：9
> 
> 时间：2012-09-13T18:27:30.473
> 
> 标签：java, eclipse, debugging, breakpoints

每当实例化特定类型（类/接口）的对象时，我想让 Eclipse 的 Java 调试器调试挂起受监视的进程。

作为一种解决方法，我可以设置断点

*   在该类型的所有构造函数上
*   在该类型的超类型和子类型的所有构造函数上

但

*   这很尴尬
*   忽略使用默认构造函数的实例化
*   可能会导致我不想挂起的类的对象实例化出现误报调试挂起。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:34:56.470

您不需要在超类和子类上设置断点。如果您在您感兴趣的类的每个构造函数上放置一个断点，那么每次创建该类的对象或其子类时，调试器都会命中其中一个断点。

这不适用于接口，因为它们永远不会被构造。我想不出一种方法来处理接口。

请记住，如果您根本没有定义任何构造函数，则默认构造函数仅存在于一个类中，因此只要您至少有一个构造函数，就不可能在不使用其中一个构造函数的情况下实例化该类型的对象你写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T18:40:02.363

[请参阅此线程](https://stackoverflow.com/questions/1876430/how-to-set-a-breakpoint-on-a-default-java-constructor-in-eclipse)上[Carlos Heuberger](https://stackoverflow.com/users/85421/carlos-heuberger)的答案。

如果需要，您还可以在特定的类加载上设置断点。请参阅本教程以供[参考](http://www.vogella.com/articles/EclipseDebugging/article.html#advanced_class)

# c# - GridView 在页面更改时不会更改

> ID：12412513
> 
> 赞同：0
> 
> 时间：2012-09-13T18:27:54.713
> 
> 标签：c#, asp.net, .net, data-binding, gridview

Gridview：页面更改时数据不会更改。

嗨，我正在使用 c# 开发一个 asp.net 网站。我有一个带有分页的 gridview，gridview 是从 sql 数据库填充的，并且在 PageIndexChanging 我有：

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    BindGridControl();

    gridView.PageIndex = e.NewPageIndex;
    gridView.DataBind();
} 
```

例如，如果我单击第 2 页，则下一行数据显示正常。但是如果我点击回到第 1 页，数据不会改变，它会继续显示第 2 页的数据。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:39:52.213

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
   gridView.PageIndex = e.NewPageIndex;
   BindGridControl();  
   gridView.DataBind();
} 
```

您的 BindGridControl() 是否加载数据并将其设置为您的 gridView 数据源？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:44:01.487

您可以颠倒指令的顺序

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{

    gridView.PageIndex = e.NewPageIndex;

        BindGridControl();

    gridView.DataBind();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-06T08:59:41.457

我也有这个问题很久了。我想出了这个，它终于对我有用。

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    BindGridControl(e.NewPageIndex);
} 
```

然后在您的 BindGridControl 函数中：

```
protected void BindGridControl(int pageNumber = 0)
{ 
    SqlConnection sqlConn = new SqlConnection(ConfigurationManager.ConnectionStrings[connect‌​ion].ConnectionStrin‌​g);
    SqlDataReader dr;
    SqlCommand cmd;
    cmd = new SqlCommand();
    cmd.Connection = sqlConn;
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandText = "sp_load";
    sqlConn.Open();
    dr = cmd.ExecuteReader();
    DataTable dt = new DataTable();
    dt.Load(dr);
    GridView1.PageIndex = pageNumber;
    GridView1.DataSource = dt;
    GridView1.DataBind();
    sqlConn.Close();
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-12T23:59:50.570

尝试

```
protected void GridView1_PageIndexChanging（对象发送者，GridViewPageEventArgs e）
{

    gridView.PageIndex = e.NewPageIndex;

    绑定网格控件（）；

    数据绑定（）；
}

```

# windows - MsiVerifyPackage WinAPI 函数如何验证 MSI？

> ID：12412515
> 
> 赞同：1
> 
> 时间：2012-09-13T18:27:56.370
> 
> 标签：windows, winapi, windows-installer

Windows 文档声明 MsiVerifyPackage 函数验证文件是否为安装包。这里验证了多少？如果内容文件中的字节损坏/不正确，会被捕获吗？还是只是检查 MSI 数据是否可读？

该功能的 MSDN 页面在这里：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa370508 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370508(v=vs.85).aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T19:40:10.267

我认为你错过了 API 的重点。SDK doco 会告诉您它的作用：

> MsiVerifyPackage 函数验证给定文件是否为安装包。

但你真正要问的是“它是如何”做的？API 的全部意义在于将您从实现细节中抽象出来。如果没有访问源代码，这个问题是无法回答的。即使那样，我也不确定是否应该回答它，因为您可能会依赖这种行为。

顺便说一句，你真正的问题是什么？我怀疑这不仅仅是无聊的好奇心，而且在某个地方还有一些真正的问题。

# ios - Xcode 4.2 中的自定义 UITableViewCell 类

> ID：12412517
> 
> 赞同：0
> 
> 时间：2012-09-13T18:27:59.723
> 
> 标签：ios, uitableview

我一直在关注[这个 Apple Doc](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7)，将我在 .xib 中布局的自定义 UITableViewCell 添加到我的项目中。该文档的一个问题是它似乎是为旧版本的 Xcode 编写的。

我可以加载自定义单元格所在的 UITableViewController，但单元格都是空白的。我的自定义单元格包含多个 UILabel，并且具有非默认背景颜色。我运行时出现的表格具有默认的白色背景并且没有标签。如果我更改故事板上的 UITableView 的视图 -> 背景，单元格背景的颜色会发生变化，但标签仍然不会出现。

有趣的是数据仍然在我的表格的单元格中。UITableViewController 本身被称为另一个控制器的弹出框。当我选择其中一个单元格时，来自各种`label.text`s 的字符串应该加载到弹出框委托上的它们自己的标签中，并且该代码工作正常（除非我尝试在弹出框中包含 UINavigationBar，但这可能是另一个完全问题）。

我对 iOS 开发还很陌生，所以如果有什么我遗漏或不清楚的地方，请告诉我。

编辑 - 清理代码，现在与我最初发布时的问题完全不同，但仍然在同一个主题上。我应该删除旧问题并将其作为一个新问题一起发布，还是我只是编辑它可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T20:06:16.130

我仍然不完全确定我之前所做的事情出了什么问题，但我设法得到了我想要的。我最初将 UITableViewController 放到我的情节提要上，设置了一个弹出框 segue（也在情节提要上）并尝试使用`performSegueWithIdentifier`. 相反，我现在完全在我的代码中创建弹出框（我在 SO 上找到了一个很好的教程，通过“以编程方式显示弹出框”），我的故事板上没有任何内容。这似乎是显示弹出窗口的最有记录和最稳定的方式。一旦我以这种方式显示它，我的自定义单元格就会完全按照我想要的方式显示。

# maven-3 - 使用 Maven3 通过 ssh 运行远程命令

> ID：12412519
> 
> 赞同：8
> 
> 时间：2012-09-13T18:28:02.500
> 
> 标签：maven-3, maven-wagon-plugin

我正在使用 wagon-maven-plugin 将我的 WAR 文件 scp 到服务器。它工作正常。我的下一步是在服务器上执行一些命令（mkdir 等）。有没有一个插件可以帮助我做到这一点？有没有办法使用 wagon-maven-plugin 解决它？

我对 mvn 比较陌生。任何帮助，将不胜感激。

有什么建议么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-20T02:28:18.607

我能够使用 exec-maven-plugin 运行 ssh 命令。它是一个强大的 Maven 插件，可以进行各种 hack 并运行命令。对于任何对解决方案感兴趣的人

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>exec-maven-plugin</artifactId>
  <version>1.2.1</version>
  <executions>
    <execution>
      <phase>install</phase>
      <goals>
        <goal>exec</goal>
      </goals>
    </execution>
  </executions>
  <configuration>
    <executable>sh</executable>
    <arguments>
      <!-- Shell script location -->
      <argument>runscript.sh</argument>
      <!-- arg #1 -->
      <argument>${file_1}</argument>
    </arguments>
  </configuration>
</plugin> 
```

我发现的另一个解决方案是运行 maven-antrun-plugin。我不推荐它，因为它运行 ANT 任务并且对它有很多依赖。但如果您需要通过 maven 运行 ant 任务，它会很方便。

```
<plugin>
  <inherited>false</inherited>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-antrun-plugin</artifactId>
  <version>1.6</version>
  <configuration>
    <target>
      <loadproperties srcFile="deploy.properties" />
      <ftp action="send" server="server"
           remotedir="/a/b" userid="usr"
           password="pw" depends="no"
           verbose="yes" binary="yes">
        <fileset dir="modules/my-module/target">
          <include name="file.zip" />
        </fileset>
      </ftp>

      <!-- calls deploy script -->
      <sshexec host="host" trust="yes"
               username="usr" password="pw"
               command="sh /my/script.sh" />

      <!-- SSH -->
      <taskdef name="sshexec"
               classname="org.apache.tools.ant.taskdefs.optional.ssh.SSHExec"
               classpathref="maven.plugin.classpath" />
      <taskdef name="ftp"
               classname="org.apache.tools.ant.taskdefs.optional.net.FTP"
               classpathref="maven.plugin.classpath" />
    </target>
  </configuration>
  ...
  <dependencies>
    <dependency>
      <groupId>commons-net</groupId>
      <artifactId>commons-net</artifactId>
      <version>1.4.1</version>
    </dependency>
    <dependency>
      <groupId>ant</groupId>
      <artifactId>ant-commons-net</artifactId>
      <version>1.6.5</version>
    </dependency>
    <dependency>
      <groupId>ant</groupId>
      <artifactId>ant-jsch</artifactId>
      <version>1.6.5</version>
    </dependency>
    <dependency>
      <groupId>jsch</groupId>
      <artifactId>jsch</artifactId>
      <version>0.1.29</version>
    </dependency>
  </dependencies>
</plugin> 
```

希望有帮助！

# objective-c - 将 NavigationController 添加到当前视图

> ID：12412526
> 
> 赞同：1
> 
> 时间：2012-09-13T18:28:35.963
> 
> 标签：objective-c, ios, uiviewcontroller, pushviewcontroller, presentmodalviewcontroller

我正在使用 UIScrollView 显示一些图像，当用户选择图像的一部分时，我需要呈现或推送另一个视图。此 ScrollView 仅以编程方式创建。我如何以编程方式向它添加一个导航控制器并呈现另一个视图？

我试过这种方式，但只给我以下错误：

> 不支持推送导航控制器'

```
 StatesViewController * controller = [[StatesViewController alloc]initWithNibName:@"StatesViewController" bundle:nil];

    UINavigationController * Navcontroller = [[UINavigationController alloc] initWithRootViewController:controller];

    [self presentModalViewController: Navcontroller animated: YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:43:13.080

这可能会帮助你。

```
 NextViewController *nextViewController=[[NextViewController alloc]initWithNibName:@"NextViewController" bundle:nil];
    UINavigationController *navBar=[[UINavigationController alloc]initWithRootViewController:nextViewController];
    [self.navigationController presentModalViewController:navBar animated:YES]; 
```

# android - Android Spinner 创建动态更改所选项目背景颜色

> ID：12412527
> 
> 赞同：0
> 
> 时间：2012-09-13T18:28:38.007
> 
> 标签：android, spinner

我正在动态创建一个 Spinner，如下面的代码：

```
private void createCoordinationSpinner() {
    TextView tvwCoordination = new TextView(this);
    this.spinnerCoordination = new Spinner(this);

    //Some code to setup textview... 

    LinearLayout.LayoutParams paramsSpinnerCoordination = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
    paramsSpinnerCoordination.setMargins(10, 0, 10, 0);

    this.spinnerCoordination.setLayoutParams(paramsSpinnerCoordination);
    this.spinnerCoordination.setBackgroundResource(R.drawable.rounded_border);
    this.spinnerCoordination.setPrompt("Coordination");
    this.spinnerCoordination.setOnItemSelectedListener(spinnerItemClickListener);

    //Adding both views to an existing LinearLayout, that is possible to have another views, instead of spinner
    linearSchoolCoordination.addView(tvwCoordination, 0);
    linearSchoolCoordination.addView(spinnerCoordination, 1);
    linearSchoolCoordination.setGravity(Gravity.BOTTOM);
}

//Thats the line that sets the adapter:
adapterCoordination = new ItemSpinnerAdapter(context, R.layout.coordinationspinnerlayout, arrayCoordination); 
```

rounded_border.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"> 
    <solid android:color="@color/gray_dialog" /> 
    <padding android:left="8dp" 
        android:top="8dp" 
        android:right="8dp" 
        android:bottom="8dp" /> 
    <corners android:radius="20dp" /> 
</shape> 
```

协调微调器布局.xml：

```
<LinearLayout   android:orientation="vertical" 
                android:background="@color/transparent2" 
                android:layout_height="fill_parent" 
                android:layout_width="fill_parent" 
                xmlns:android="http://schemas.android.com/apk/res/android"> 

    <LinearLayout
        android:id="@+id/linearLayout2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@color/transparent2"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@color/transparent2"
            android:gravity="center_vertical" >

            <ImageView  android:layout_height="wrap_content" 
                        android:layout_width="wrap_content" 
                        android:id="@+id/imageSpinnerItem" 
                        android:src="@drawable/itemlistviewicon_nochildren" 
                        android:layout_marginTop="5dp" 
                        android:layout_marginLeft="8dp" 
                        android:layout_marginBottom="5dp"/> 

            <TextView   android:layout_height="wrap_content" 
                        android:layout_width="wrap_content" 
                        android:id="@+id/tvwSpinnerCoordination" 
                        android:layout_marginLeft="10dp" 
                        android:textSize="16dip" 
                        android:textColor="@color/black" 
                        android:text="TextView" 
                        android:layout_weight="1"/> 

            <ImageView  android:layout_height="20dp" 
                        android:layout_width="20dp" 
                        android:id="@+id/imageSpinnerDownArrow" 
                        android:src="@drawable/spinnerdownarrow" 
                        android:layout_marginTop="5dp" 
                        android:layout_marginBottom="5dp" 
                        android:layout_marginRight="10dp"/> 
        </LinearLayout> 

        <View   android:background="@color/silver" 
                android:layout_height="1dp" 
                android:layout_width="fill_parent" 
                android:id="@+id/linearSpinnerSeparator"/> 

    </LinearLayout> 

</LinearLayout> 
```

最后是适配器 ItemSpinnerAdapter.java：

```
public class ItemSpinnerAdapter extends ArrayAdapter<CoordinationData> 
{
    private int tvwID;
    private List<CoordinationData> coordinationList;

    public ItemSpinnerAdapter(Context context, int textViewResourceId, List<CoordinationData> coordinationList) 
    {
        super(context, textViewResourceId, coordinationList);

        this.tvwID = textViewResourceId;
        this.coordinationList = coordinationList;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) 
    {
        ViewHolder holder;
        View view = convertView;

        if (view == null) 
        {
           LayoutInflater layInf = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
           view = layInf.inflate(tvwID, null);

           holder = new ViewHolder();
           holder.tvwDescription = (TextView) view.findViewById(R.id.tvwSpinnerCoordination);
           holder.description = coordinationList.get(position).getCoordinationName();

           view.findViewById(R.id.linearSpinnerSeparator).setVisibility(View.GONE);
           view.setTag(holder);

        } 
        else 
        {
            holder = (ViewHolder) view.getTag();
            holder.description = coordinationList.get(position).getCoordinationName();
        }

        if (holder.tvwDescription != null) 
            holder.tvwDescription.setText(holder.description);

        return view;
    }

    @Override
    public View getDropDownView(int position, View convertView, ViewGroup parent) 
    {
        ViewHolder holder;
        View view = convertView;

        if (view == null) 
        {
            LayoutInflater layInf = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            view = layInf.inflate(tvwID, null);

            holder = new ViewHolder();
            holder.tvwDescription = (TextView) view.findViewById(R.id.tvwSpinnerCoordination);
            holder.tvwDescription.setTextSize(TypedValue.COMPLEX_UNIT_SP, 20);
            holder.description = coordinationList.get(position).getCoordinationName();

            view.findViewById(R.id.imageSpinnerDownArrow).setVisibility(View.GONE);
            view.setTag(holder);

        } 
        else 
        {
            holder = (ViewHolder) view.getTag();
            holder.description = coordinationList.get(position).getCoordinationName();
        }

        if (holder.tvwDescription != null) 
            holder.tvwDescription.setText(holder.description);

    return view;
}

public class ViewHolder 
{
    TextView tvwDescription;
    String description;
}
} 
```

将它添加到我活动的 XML 布局文件中已经存在的 LinearLayout 中。与我的 CustomSpinnerAdapter 一起，它运行良好。但我仍然需要更改一些属性并且我被卡住了......由于我的应用程序使用蓝色文本和背景，我想设置微调项突出显示颜色的选择。它的默认值为橙色。

由于我正在为 API 10 进行开发，因此我使用了有限的 Spinner 方法。

有什么建议么？提前致谢！

编辑：是否可以更改提示标题背景颜色？

EDIT2：添加更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:48:30.010

**编辑**：

您正在使用微调器，因此您需要实现`[getDropDownView][1]`.

* * *

如果要更改视图的选定颜色，则需要像这样创建一个 Color List Drawable

在颜色/list_color.xml

```
<selector>
  <item android:state_selected="true">SomeColor</item>
</selector> 
```

在你看来

```
<YourView
  android:background="@color/list_color" /> 
```

有关更多信息，请参阅[此资源](http://developer.android.com/guide/topics/resources/color-list-resource.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T20:35:14.177

经过长时间寻找解决方案，

我发现由于我正在开发**的 API 版本，我****无法动态设置样式**或更改其选择颜色。

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T11:27:39.723

```
take the custum adapter 

mySpinner.setOnItemSelectedListener(new OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> parent, View arg1,
                    int position, long arg3) {

                _position = position;
                LinearLayout linear_ayout = (LinearLayout)parent.getChildAt(0);
                linear_ayout.setBackgroundColor(Color.TRANSPARENT);
                TextView tv = (TextView) linear_ayout.getChildAt(0);
                tv.setTextColor(Color.WHITE);

                gname_spinner=mySpinner.getSelectedItem().toString();
                if (mySpinner.getSelectedItem().toString().equalsIgnoreCase("All Groups")) 
                    filItemAdapter("A", ""); 
                    else
                    filItemAdapter("G", mySpinner.getSelectedItem().toString());
            }

            @Override
            public void onNothingSelected(AdapterView<?> parent) {
                Logger.d("******", "not selected");
                 filItemAdapter("A", "");
            }

        });

    MyCustomAdapter custom_adapter = new MyCustomAdapter(
                getApplicationContext(), R.layout.custum_spinner_group,
                group_list);

        mySpinner.setAdapter(custom_adapter);

public class MyCustomAdapter extends ArrayAdapter<String> {

        List<String> group_list;

        public MyCustomAdapter(Context context, int textViewResourceId,
                List<String> group_list) {
            super(context, textViewResourceId, group_list);
            this.group_list = group_list;

        }

        @Override
        public View getDropDownView(int position, View convertView,
        ViewGroup parent) {
            return getCustomView(position, convertView, parent);
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) { 
            return getCustomView(position, convertView, parent);
        }

        public View getCustomView(int position, View convertView,
                ViewGroup parent) {
            LayoutInflater inflater = getLayoutInflater();
            View row = inflater.inflate(R.layout.custum_spinner_group, parent, false);
            TextView text_group = (TextView) row.findViewById(R.id.text_group_name);
            LinearLayout layout = (LinearLayout) row
                    .findViewById(R.id.layout_group_name);
            text_group.setText(group_list.get(position));           

            if (position == _position) {

                layout.setBackgroundColor(getResources().getColor(R.color.spinner_background));
                text_group.setTextColor(getResources().getColor(R.color.white));

                } else {

                layout.setBackgroundColor(Color.TRANSPARENT);
                text_group.setTextColor(getResources().getColor(R.color.spinner_background));
                }

            Log.d("selected group", ":"+text_group.getText());

            return row;

        }
    } 
```**

# php - 除了在特定其他类的实例中之外，有没有办法防止类被实例化？

> ID：12412529
> 
> 赞同：3
> 
> 时间：2012-09-13T18:28:45.013
> 
> 标签：php, oop

我有两个类`A`，并且`B`都继承自同一个父级。在 PHP 中，有没有办法确保`B`除了在类中之外不能实例化该类`A`？

（类`B`不是 的孩子`A`。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:56:21.237

使用[debug_backtrace](http://php.net/manual/en/function.debug-backtrace.php)：

```
class Ancestor{}

class A extends Ancestor{

    public function buildB()
    {

        return new B;

    }

}

class B extends Ancestor{

    public function __construct(){

        $backtrace = debug_backtrace();
        if( $backtrace[1]['class'] !== 'A' )
            throw new Exception("Don't you dare!");

        echo "Built successful!\n";

    }

} 
```

试试看：

```
//Everything ok this way:
$a = new A;
$a -> buildB();

// You will have an exception in any other case:
try{

    $b = new B; 

}catch(Exception $e){

    echo $e -> getMessage();

} 
```

编辑：如果你想确保`B`只在`A`'s 代码中创建，你也可以这样做 - 只需将`buildB`^^.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:46:14.400

是的。

如何实现它是，让 class`B`的构造函数接受一个参数。`A`并为生成对象的类定义一个方法`B`。

`$argument == null`如果||则死亡或抛出异常 `!($argument instanceof A)`.

示例代码：

```
class X {
    public $i = 0;
    public function getI() {
        return $i;
    }
    public function setI($x) {
        $i = $x;
    }
}

class A extends X {
    public function setI($x) {
        $i = $x * 2;
    }
    public function makeB($var){
        $b = new B($var);
    }
}

class B extends X {
    public function __construct($a) {
        if (null == $a) {
            echo "no arguments given!\r\n";
            //exit;
        }else if (!($a instanceof A)) {
            echo "disallowed\r\n";
            //exit;
        }else{
            echo "initialized b\r\n";
        }
    }
    public function setI($x) {
        $i = $x * 3;
    }
}

$a = new A();

$a->makeB();
$a->makeB(new X());
$a->makeB(&$a); 
```

输出：

```
Warning: Missing argument 1 for A::makeB(), called in file.php
no arguments given!
disallowed
initialized b 
```

[你可以在这里](http://codepad.org/KGjG7oPe)看到一个演示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:40:08.837

我不是从 php 的角度考虑这一点，而是更多地从 oop 方面考虑......认为你可以完成它的唯一方法是如果你将 B 的构造函数设为私有，然后公开一个接受 A 的参数和 out 的静态方法B 的参数，那么该方法可以私下实例化 B 并通过 out 参数将其返回给 A。

```
//Pseudocode, language-indifferent

    class A{
       var _B;

       public B GetMeAnInstanceOfB(){
          _B=B.CreateInstanceOfB(this);
       }

       //alternate
       public B GetMeAnotherInstanceOfB(){
          _B=new B(this);
       }
    }

    class B{
       private B();
       //alternate
       private B(A);
       static B CreateInstanceOfB(A){
          return new(b);
       }
    } 
```

这真的很粗糙，可能到处都是坑洼，但有一个刺。从技术上讲，A 的子类仍然可以得到 B，所以如果你密封了这个类（被阻止的子类），那将关闭那扇门。

有趣的问题，当然...

**编辑：**这个mod确实不能解决问题，但也许（？）更好 - 我已经为B创建了一个公共构造函数，它以A作为参数，并且B的实例化现在只发生在A中。唯一的问题是它仍然存在 JDelage 指出的相同问题 - 如果我实例化 A，我可以构建一个 B...

# c# - 将 IUnknowns 的 SAFEARRAY 转换/转换为接口指针的可迭代数组

> ID：12412533
> 
> 赞同：3
> 
> 时间：2012-09-13T18:28:55.353
> 
> 标签：c#, c++, com, safearray, iunknown

我在 C# 中有以下接口，其中一个具有相同名称（没有我）的类实现它。

```
[ComVisible(true)]
[Guid("B2B134CC-70A6-43CD-9E1E-B3A3D9992C3E")]
public interface IOrder
{
    long GetQuantity();
    long GetOrderType();
    long GetPositionType();
} 
```

公共类 Order 的实现： IOrder 只是三个私有字段和一个带有所需 3 个参数的构造函数。

在其他地方，我有以下方法，其结果是我想在 C++ 非托管代码中工作，通过 COM 和 .tlb/.tlh 文件传输到那里。

```
public ScOrder[] GetOrders()
{
    //constant return value for simplicity
    return new Order[] {    
        new Order(1, 2, 3),
        new Order(4, 5, 6)
    };
} 
```

我已经设法使用 C# 托管代码在 C++ 非托管代码之间进行基础工作。

但是类数组被证明是一个不同的挑战......

我承认，对我来说，COM 是新的，令人困惑，C++ 早已被遗忘......，但我正在开发这两个库，所以我不会放弃；我希望 C++ DLL 在某些程序和我的 C# 代码之间充当代理。

**澄清：**我既没有使用 MFC 也没有使用 ATL。我在 C++ 代码中使用#import 来获取 C# 生成的接口和类指针以及其他我不太了解的 COM 内容。

经过一个小时的研究，我只是去这里寻求帮助>.<

以下是我想要实现的 C++ 代码。

```
//this is how the instance of C# gets created, read it from the internets
//this type has the method GetOrders
IProxyPtr iPtr;
CoInitialize(NULL);
iPtr.CreateInstance(CLSID_Proxy);

IOrderPtr* ordArr; 
//IOrderPtr is just a pointer to the interface type transferred
//right? So IOrderPtr* should represent the array of those pointers, right? 

SAFEARRAY* orders;
iPtr->GetOrders(&orders); 
```

现在，我需要一些我还不明白的 COM 魔法来将 SAFEARRAY* 转换为 IOrderPtr* 或其他东西，这样我就可以遍历返回的整个数组并调用“Order”类型的方法

*   获取数量（）
*   获取订单类型（）
*   获取位置类型（）

因此，对于第一个周期，我将获得值 1、2、3，对于第二个周期，我将获得值 4、5、6。

因为我是 C++ 和 C# 库的作者，所以我可以跳过所有这些 COM 疯狂的东西，并制作方法来获取集合计数和其他方法来获取特定索引上的属性值。

但这似乎并不好。我怀疑我想要的机制很简单，但我在谷歌上找到的所有答案总是缺少一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:17:25.107

在不知道您是否在 C++ 客户端中使用 MFC、ATL 或其他库的情况下，很难简化它，因此我将使用 Win32 API（这些库提供帮助类以更简单地使用安全数组）

但是，我将假设您通过`#import`Interop 类型库使用 C# lib，因此您可以使用生成的智能指针类。我还将假设您返回 IUnknowns 的 SAFEARRAY 而不是包含 IUnknowns 的变体的 SAFEARRAY - 这可以通过在 C# 接口上指定适当的编组属性来修改，例如：

```
[return: MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_UNKNOWN)] 
// [return: MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_VARIANT)]
IOrder[] GetOrders(); 
```

以下是 C# 类型的实现（示例解决方案的链接位于答案的底部）：

```
[ComVisible(true)]
[Guid("F3071EE2-84C9-4347-A5FC-E72736FC441F")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IProxy
{
    [return: MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_UNKNOWN)] 
    IOrder[] GetOrders();
}

[ComVisible(true)]
[Guid("8B6EDB6B-2CF0-4eba-A756-B6E92A71A48B")]
[ClassInterface(ClassInterfaceType.None)]
public class Proxy : IProxy
{
    public IOrder[] GetOrders() { return new[] {new Order(3), new Order(4)};        }
}

[ComVisible(true)]
[Guid("CCFF9FE7-79E7-463c-B5CA-B1A497843333")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IOrder
{
    long GetQuantity();
}

[ComVisible(true)]
[Guid("B0E866EB-AF6D-432c-9560-AFE7D171B0CE")]
[ClassInterface(ClassInterfaceType.None)]
public class Order : IOrder
{
    private int m_quantity;
    public Order(int quantity) { m_quantity = quantity; }
    public long GetQuantity() { return m_quantity; }
} 
```

服务器必须使用 构建和注册`Regasm`。为简单起见，我会`regasm /codebase /tlb $path`尽量避免在 GAC 中签名和注册。

客户端代码应该是这样的：

```
#import "Server.tlb" no_namespace // you should use namespaces! this is a demo

int _tmain(int argc, _TCHAR* argv[])
{
  CoInitialize(NULL);      // init COM

  IProxyPtr proxy(__uuidof(Proxy));         // instantiate the proxy
  SAFEARRAY* orders = proxy->GetOrders();   // to return orders

  LPUNKNOWN* punks;   
  HRESULT hr = SafeArrayAccessData(orders, (void**)&punks); // direct access to SA memory
  if (SUCCEEDED(hr))
  {
    long lLBound, lUBound;  // get array bounds
    SafeArrayGetLBound(orders, 1 , &lLBound);
    SafeArrayGetUBound(orders, 1, &lUBound);

    long cElements = lUBound - lLBound + 1; 
    for (int i = 0; i < cElements; ++i)  // iterate through returned objects
    {                              
      LPUNKNOWN punk = punks[i];     // for VARIANTs: punk = punks[i].punkVal
      IOrderPtr order(punk);         // access the object via IOrder interface
      long q = order->GetQuantity(); // and voila!
      std::cout << "order " << i + 1 << ": Quantity " << q << std::endl;
    }       
    SafeArrayUnaccessData(orders);
  }
  SafeArrayDestroy(orders);
  return 0;
} 
```

示例项目[可以在这里找到](http://dl.dropbox.com/u/19961668/ComInterop.zip)。请注意，您必须在第一次构建时手动注册 .tlb，项目不会这样做，但您可以根据需要添加构建后步骤

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:55:04.550

与 SAFEARRAYS 合作令人头疼。只是没有办法解决它。

由于 SAFEARRAY 是一种结构，因此您不能像在 C# 中那样将其转换为方便的 IOrder* 数组并使用这些项目。

这是谷歌向我展示的一些东西。他们看起来很有帮助。

[http://edn.embarcadero.com/article/22016](http://edn.embarcadero.com/article/22016)

[http://digital.ni.com/public.nsf/allkb/7382E67B95238D2B862569AD005977F0](http://digital.ni.com/public.nsf/allkb/7382E67B95238D2B862569AD005977F0)

如果您在 C++ 项目中使用 ATL，那么您有一个 CComSafeArray 包装器：

[http://msmvps.com/blogs/gdicanio/archive/2011/02/04/simplifying-safearray-programming-with-ccomsafearray.aspx](http://msmvps.com/blogs/gdicanio/archive/2011/02/04/simplifying-safearray-programming-with-ccomsafearray.aspx)

# java - 在 Java 中使用 Amazon SQS 和 SNS

> ID：12412535
> 
> 赞同：6
> 
> 时间：2012-09-13T18:29:14.123
> 
> 标签：java, amazon-s3, amazon-web-services, amazon-sqs, amazon-sns

我第一次遇到 Amazon SQS 和 Amazon SNS。我将在我的 Java 工作场所使用这些。

关于这些，我有几个问题，

1.  我没有那么多 Java 知识，我不能说我已经达到了那么高级，但是是的，我可以说我有中级知识。那么我可以触摸这些区域吗？

2.  这些服务到底是什么，它们有什么用处？一个真实世界的例子会很有用。

任何建议或意见都会很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T21:45:19.460

我不会说您需要高级 Java 知识才能使用它们 - 但为什么不尝试自己判断呢？适用于 Java 的 AWS 开发工具包可在[http://aws.amazon.com/sdkforjava/获得](http://aws.amazon.com/sdkforjava/)

[在http://aws.amazon.com/sns/](http://aws.amazon.com/sns/)和[http://aws.amazon.com/sqs/](http://aws.amazon.com/sqs/)上有介绍性信息以及详细文档的链接。

当您需要通过 Internet 在系统的各个部分之间发送可靠的异步消息时，SQS 非常有用。它为您节省了设置自己的可靠消息传递服务的工作量和费用，并提供了可扩展性。当消息不必立即到达但不能丢失时，它很有用。账单（销售记录）和其他非时间关键的金融交易就是一个例子。请注意，SQS 提供“至少一次”行为——在极少数情况下，它可能会多次传递消息。

SNS 是发布订阅的，而不是基于队列的；它是一种使用主题和订阅而不是普通队列的更受消费者驱动的消息传递方式。当信息的生产者可能不知道信息的所有潜在消费者以及他们的确切需求时，这种风格很有用。[请参阅位于http://aws.amazon.com/sns/faqs/#0](http://aws.amazon.com/sns/faqs/#0)的 FAQ 中的示例应用程序

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T09:38:28.450

它们应该用于支持您的软件组件之间的可靠通信，我认为这里的主要问题是为什么您应该将您的服务分成几个组件/层。

我想出了一些用例：

*   **可能影响 Web 响应**的长时间运行过程：最常见的示例是订单处理，其中支付/信用卡收费可能有点慢，您创建一个服务，让用户快速响应，然后向 SQS 队列发送消息，它会触发一个后台组件来完成所有繁重的工作；

*   **不同的可扩展性配置文件**：一个常见的示例是您上传视频并将其编码到多个平台的 Web 应用程序，您可能希望创建具有不同组件、视频上传/浏览（许多服务器）和视频编码较少服务器但具有更高的容量，用法将类似于前面的示例。

*   **触发并行活动**的执行：订单处理完成后，您必须向您的客户发送电子邮件，通知仓库准备海关交货，告诉运输服务在仓库取货并交付到客户地址，然后您应该使用发布业务事件的 SNS 主题，并让 3 个组件监听执行以下操作：

    1.  邮件格式化和发送
    2.  仓库服务电话
    3.  运输服务呼叫

可能还有许多其他使用场景，如果您告诉您的解决方案需要做什么，也许我们可以更准确地提供帮助。

# css - 具有字符限制的居中 css textarea

> ID：12412539
> 
> 赞同：2
> 
> 时间：2012-09-13T18:29:25.900
> 
> 标签：css, textarea, centering, character-limit

我是 stackoverflow 的新手，也是 web 开发的新手。我相信我要做的第一部分应该很容易，但我很难弄清楚。

第一种风格显然以我的背景图像为中心，这似乎工作正常。我接下来要做的是向页面添加 3 个元素。1\. 一个图形， 2\. 一个固定大小的文本区域，将输入的字符数限制为 300 个字符，以及 3\. 一个提交按钮。

我希望所有这些元素都居中。textarea 应该直接居中，图形应该对齐到文本区域的左边缘并在其上方 10px 处，提交按钮应对齐到右侧并在其下方 10px 处。

这是我所拥有的：

```
html { 

        background: url(field1.jpg) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;  

    }

#box {

    position: absolute;
    background-image:url(textarea.png);
    height: 250px;
    width: 550px;
    border-radius: 5px;
    margin: -125px 0 0 -275px;
    top: 50%;
    left: 50%;

}

#button {

    position: absolute;
    background-image:url(button.png);
    height: 55px;
    width: 151px;
    top: 260px;
    left: 399px;
    border-radius: 5px;
}

#graphic {

    position: absolute;
    background-image:url(graphic.png);
    height: 58px;
    width: 184px;
    top: -328px;
    left: -399px;
} 
```

```
<div id="box"></div>
<div id="button"></div>
<div id="graphic"></div> 
```

我有 3 个 DIV，一个用于我的 HTML 中的每个元素，我想知道如何添加文本区域，以便它只是中心框中的一个光标，限制为 300 个字符。

目前，我只想让所有内容都与 textarea 正常工作。然后我会从框中提交文本，存储它，并用它来做很多事情。任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:45:36.587

像这样？[http://jsfiddle.net/zFcHp/3/](http://jsfiddle.net/zFcHp/3/) - 我将其限制为 10 而不是 300，因为 300 对测试来说真的很烦人:)。只需更改 maxlength 属性。

Also be aware that you STILL need to check the length of the string coming back from the client, since anyone with firebug, or any one of a hundred other tools can unset your limitation on the client side and send you anything they like. They could even download the code for Firefox, and modify it to violate any web standards rule they want then recompile... Never trust the client to enforce anything!

# vb.net - 如果某些字符是中文，我们如何将 utf-8 字符分成单词？

> ID：12412544
> 
> 赞同：0
> 
> 时间：2012-09-13T18:29:54.400
> 
> 标签：vb.net, utf-8

我做一个程序。该程序得到一个 utf8 字符串并将其拆分为单词。对于拉丁字符，这很简单。根据空间划分。对于汉字，也很简单。每个字符都是一个词。

如果字符串是混合的怎么办？

我应该怎么办？

我想我可以检测到这个字符是否是中文，或者这个字符是空格分隔的单词还是没有分隔的单词。

这样做的标准方法是什么？

例如我想拆分

或者，也许我应该根据任何非字母数字（包括非拉丁脚本和重音符号上的其他字母数字？）进行拆分。如果是这样，我应该如何进行？是否有一个正则表达式可以匹配任何不是字母数字、重音词、希伯来语 alibeth、阿拉伯语 abjad 等等的东西？

我喜欢马成

```
I
Like
Horse 
```

我想把北小金駅南口第1个自転车驻车场分成

```
北
小
金
駅
南
... 
```

因为中文中的每个字符都是单词。

使这个问题变得棘手的是汉字和西方字符之间的分词不同。西文用空格隔开，汉字用空隔开。

我想我们可以在拆分之前先检测字符是否为中文。那会很好，但是我也不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:32:39.877

使用正则表达式 - 使用元字符`\b`应该捕获*所有*单词边界字符，无论与它们相关联的语言。

```
Regex.Split(myString, "\b", RegexOptions.None) 
```

# c# - 确保 Windows 窗体具有响应性

> ID：12412545
> 
> 赞同：0
> 
> 时间：2012-09-13T18:29:54.653
> 
> 标签：c#, winforms

我编写了一个应用程序，它采用一个主文件夹并复制主文件夹的所有子文件夹中的所有文件。它可以工作，但是当我复制大量文件时，表单将在一段时间内“无响应”，直到完成。

这是我正在使用的代码。

```
 private void buttonCopy_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            ArrayList existingFiles = new ArrayList();
            string existingFileName = "";
            string thePath = folderSelect.Text;
            DirectoryInfo di = new DirectoryInfo(thePath);
            FileInfo[] allFiles = di.GetFiles("*.*", System.IO.SearchOption.AllDirectories);

            foreach (FileInfo file in allFiles)
            {
                string fullName = file.FullName;
                string fileName = System.IO.Path.GetFileName(fullName);
                bool fileExists;
                fileExists = File.Exists(folderSave.Text + System.IO.Path.DirectorySeparatorChar + fileName);
                if (!fileExists)
                {
                    file.CopyTo(folderSave.Text + System.IO.Path.DirectorySeparatorChar + fileName);
                }
                else
                {
                    existingFileName += fileName + "\n";
                    existingFiles.Add(existingFileName);
                }

            }
            if (existingFiles.Count != 0)
            {
                System.Windows.MessageBox.Show(existingFiles.Count + " Files already exists!\n\n" + existingFileName);
            }
            System.Windows.MessageBox.Show("Files copied successfully!");
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:31:40.720

你需要调查一下`Threading`。[http://msdn.microsoft.com/en-us/library/aa645740(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645740(v=vs.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:33:40.517

你可以试试`asynchnous`治疗

```
public class AsyncCopy
    {
        public delegate void CopyDelegate(string sourceFile, string destFile);

        public static void AsynFileCopy(string sourceFile, string destFile)
        {
            CopyDelegate del = new CopyDelegate(FileCopy);
            IAsyncResult result = del.BeginInvoke(sourceFile, destFile, CallBackAfterFileCopied, null);
        }

        public static void FileCopy(string sourceFile, string destFile)
        { 
            // Add here your code for copy
        }

        public static void CallBackAfterFileCopied(IAsyncResult result)
        {
            // Add here your callback logic
        }
    } 
```

# python - 元组的平均元组

> ID：12412546
> 
> 赞同：2
> 
> 时间：2012-09-13T18:29:56.697
> 
> 标签：python, tuples

在一般意义上，我如何平均一个元组中的值，使得：

```
(1,2,3),(3,4,5) 
```

变成：

```
(2,3,4) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-13T18:39:28.853

你可以[`zip`](http://docs.python.org/library/functions.html#zip)这样使用：

```
In [1]: x = ((1, 2, 3), (4, 5, 6))

In [2]: [sum(y) / len(y) for y in zip(*x)]
Out[3]: [2, 3, 4] 
```

* * *

另一种方法在元组中使用`lambda`超过 2 个元组并导致浮点数而不是整数：

```
>>> x = ((10, 10, 10), (40, 55, 66), (71, 82, 39), (1, 2, 3))
>>> print tuple(map(lambda y: sum(y) / float(len(y)), zip(*x)))
(30.5, 37.25, 29.5) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-13T18:37:20.110

```
x = ((1,2,3),(3,4,5))

from numpy import mean  # or write your own mean function
tuple(map(mean, zip(*x)))
# (2.0, 3.0, 4.0) 
```

或者：

```
from numpy import mean
tuple(mean(x, axis=0)) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-09-22T08:56:49.943

```
 private Tuple<int, double> CalcuteAverageTulpeList(List<Tuple<int, double>> tupleParameters)
    {
        int totalLtGain = 0;
        double totalMeasured = 0;

        foreach (var tupleParameter in tupleParameters)
        {
            totalLtGain = totalLtGain + tupleParameter.Item1;
            totalMeasured = totalMeasured + tupleParameter.Item2;
        }
        int averageLtGain = totalLtGain / tupleParameters.Count();
        double averageMeasured = totalMeasured / tupleParameters.Count();
        return new Tuple<int, double>(averageLtGain, averageMeasured);
    } 
```

# paypal - PayPal Sandbox API SSL 握手错误突然开始使用 PayPal PHP SDK？

> ID：12412547
> 
> 赞同：5
> 
> 时间：2012-09-13T18:29:57.350
> 
> 标签：paypal, paypal-sandbox

直到今天，我一直在使用新的 PayPal PHP SDK 成功开发 PayPal 的沙箱，该 SDK 预先配置为使用此沙箱 URL：

[https://api.sandbox.paypal.com/2.0/（Chrome](https://api.sandbox.paypal.com/2.0/)
中的 URL 当前返回：“错误 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL 协议错误。”）

但是今天我的 webapp 由于 SSL 握手失败而崩溃： `Uncaught exception 'PPConnectionException' with message 'error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure' in ./paypal-sdk-1.0.92/lib/PPHttpConnection.php:185`

自昨天以来（我的 web 应用程序上次工作时）发生的唯一事件是我重置了我的沙盒“卖家”帐户，[根据这篇文章](https://stackoverflow.com/questions/7173066/paypal-express-checkout-10410-invalid-token)可能已经重置了 API 凭据。由于我已经手动更新了 API 凭据，并且已经验证它们是正确的，所以我不能说它们在这一点上是否有过错误。

经过大量搜索，我发现其他网络文章说 URL 应该是：

[https://api-3t.sandbox.paypal.com/2.0/（Chrome](https://api-3t.sandbox.paypal.com/2.0/)
中的 URL 返回 SOAP 响应。）

所以我将我的 PayPal PHP SDK 包含的 URL 从[https://api.sandbox.paypal.com/2.0/](https://api.sandbox.paypal.com/2.0/)更改为[https://api-3t.sandbox.paypal.com/2.0/](https://api-3t.sandbox.paypal.com/2.0/)并且它再次完美运行。这里发生了什么？非“3t”沙盒 URL 现在是否被破坏了？

**编辑：**在收到@Win 和@JoelP 的反馈后，我已[通过 PayPal SDK github 提交了一份错误报告，因此 PayPal 的](https://github.com/paypal/SDKs/issues/22)某人可以解释今天发生的变化，并修复 SDK 以在使用签名凭据时具有正确的 URL。

**编辑 2：** [PayPal](https://github.com/paypal/SDKs/blob/cfbcdac57414ea776df5507233a72b0d269f9ab0/Merchant/merchant-php-sdk/config/sdk_config.ini#L26)几天前解决了这个问题。它将在下一个版本中可用。[https://github.com/paypal/SDKs/issues/22#issuecomment-8660682](https://github.com/paypal/SDKs/issues/22#issuecomment-8660682)

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T18:40:42.940

[证书和签名](https://cms.paypal.com/us/cgi-bin/?&cmd=_render-content&content_ID=developer/howto_api_endpoints)之间的区别

![在此处输入图像描述](../Images/3a08bc349a00a356290eeb2cd0aec6cc.png)

签名是访问 PayPal API 的[首选方式](https://stackoverflow.com/questions/5256316/java-paypal-api-call-certificate-is-requierd/5668166#5668166)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-21T04:06:42.503

问题已修复，代码已推送到 master 分支。在接下来的几天里，您应该会在 x.com 上看到更新后的 sdk 包。

在此处参考 GitHub 问题[https://github.com/paypalx/SDKs/issues/22](https://github.com/paypalx/SDKs/issues/22)

谢谢，普拉萨纳。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T19:10:54.470

我无法回答这个问题，但我可以说我刚刚发现了同样的问题。我确认 jimp 将 SDK 的服务端点配置更改为的解决方法：

```
service.EndPoint="https://api-3t.sandbox.paypal.com/2.0/" 
```

解决了我的问题。（这在 Paypal SDK config/sdk_config.ini 文件中）。

就我而言，我使用的是 PHP SDK。我没有更改沙盒帐户上的任何内容。我最好的猜测是原始 URL 只是暂时关闭了。（Firefox 显示“安全连接失败”警报）。

# sql - SQL 当一个结果有两行输出时，如何求和？

> ID：12412548
> 
> 赞同：2
> 
> 时间：2012-09-13T18:29:58.523
> 
> 标签：sql, oracle

我在下面有这个查询：

```
Select
count(CDT) as Actions
From Player_Tapjoy
Where
Trunc(CDT) >= To_Date('2012-sep-01','yyyy-mon-dd')
And Trunc(CDT) < To_Date('2012-sep-12','yyyy-mon-dd')
Union All
Select 
Count(CDT) As Actions
From Player_aux_pt
Where
Site = 'AppCircle' And
Trunc(CDT) >= To_Date('2012-sep-01','yyyy-mon-dd')
And Trunc(CDT) < To_Date('2012-sep-12','yyyy-mon-dd') 
```

这个输出给了我两行，一个用于每个选择函数。如何将这些组合起来以获得两个选择函数的总和？最重要的是，我如何按 CDT（日期）对其进行分组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:36:22.850

我认为您正在寻找这样的东西，按日期分组：

```
select cdt, sum(actions) as actions_sum
    from (  select trunc(cdt) as cdt, count(cdt) as actions
              from player_tapjoy
             where trunc(cdt) >= to_date('2012-sep-01', 'yyyy-mon-dd') and
                   trunc(cdt) < to_date('2012-sep-12', 'yyyy-mon-dd')
          group by trunc(cdt)
          union all
            select trunc(cdt) as cdt, count(cdt) as actions
              from player_aux_pt
             where site = 'AppCircle' and
                   trunc(cdt) >= to_date('2012-sep-01', 'yyyy-mon-dd') and
                   trunc(cdt) < to_date('2012-sep-12', 'yyyy-mon-dd')
          group by trunc(cdt))
group by cdt 
```

# wordpress - Wordpress：在 WHILE 循环中获取 current_post 索引号

> ID：12412552
> 
> 赞同：18
> 
> 时间：2012-09-13T18:30:08.180
> 
> 标签：wordpress, while-loop

如何`index number`在 WHILE 循环中获取当前帖子？

```
$index_query = new WP_Query( array( 'post_type' => 'post', 'orderby' => 'modified', 'posts_per_page' => '-1', 'order' => 'DESC' ) );
while ( $index_query->have_posts() ) : $index_query->the_post();

    // echo current post index number

endwhile; 
```

尝试了以下方法，但没有结果。

```
$index_query->post->current_post; 
```

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-13T18:56:34.417

你应该使用

```
$index_query->current_post; 
```

[http://codex.wordpress.org/Class_Reference/WP_Query#Properties](http://codex.wordpress.org/Class_Reference/WP_Query#Properties)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-09-21T05:20:35.900

我可以通过使用此代码

```
$wp_query->current_post 
```

# javascript - JQuery Animate：在动画期间更改道具的目的地

> ID：12412557
> 
> 赞同：0
> 
> 时间：2012-09-13T18:30:44.633
> 
> 标签：javascript, jquery, animation, mouseevent

我用鼠标滚动了一个图像。

图像滚动到基于窗口高度的鼠标位置百分比的位置。

```
$(imageContainer).mouseenter(function(e){
    var scrollingTo = ((e.pageY/$(this).height())-.083) * ( $(imageContainer).prop('scrollHeight') - $(imageContainer).height() );
    hijacked = true;
    $(imageContainer).animate({scrollTop:scrollingTo},300,function(){hijacked=false;});
}).mousemove(function(e){
    if(hijacked) return;
    var scrollingTo = ((e.pageY/$(this).height())-.083) * ( $(imageContainer).prop('scrollHeight') - $(imageContainer).height() );
    $(imageContainer).scrollTop(scrollingTo);
}); 
```

所以。在那一行

```
$(imageContainer).animate({scrollTop:scrollingTo},300,function(){hijacked=false;}); 
```

我想要那个 scrollingTo 改变。因为在动画期间，用户可以移动鼠标，改变 scrollingTo 变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:22:31.447

好吧，我设法一起制作了一种动态改变动画的骇人听闻的方法。我对 jQuery 的内部动画队列的理解不是很好，但据我所知，除了让它停止之外，没有办法改变排队的动画。无论如何，这是改变位置的示例的关键代码，它应该适用于滚动（以[小提琴形式](http://jsfiddle.net/zDY48/5/)）：

```
$(document).ready(function () {
    var last_update = 0;
    $(document).on("mousemove", function (e) {
        if (Date.now() - last_update > 50) {
            $mover = $("#mover");
            $mover.stop(); 
            $mover.animate({ left: e.pageX, top: e.pageY}, 200, "linear");            
            last_update = Date.now();
        }
    });                    
}); 
```

有一些技巧可以让它发挥作用，我将通过它们并尝试解释我认为它们如何适应滚动：

*   主要思想是，在 mousemove 上，先前的事件被取消，并开始一个新的事件。我认为这不需要任何滚动更改。

*   某些形式的动画在动画过程中会加速/减速 - 在不断变化的动画中保持这一点太难了（至少在没有编写自定义动画函数的情况下），因此动画缓动设置为“线性”。

*   快速变化的动画需要时间（尤其是对于像 mousemove 这样常见的事件），因此动画的变化频率是有限制的。在对动画进行更改之前，确保在最后 0.05 秒内没有进行任何更改（这是通过“last_update”完成的）。

我相信如果您只是将动画属性换成自己的（scrollTop），这应该可以满足您的需求。

# iphone - 如何远程运行 iPhone、iPad 应用程序到设备上，我是芝加哥的纽约客户？

> ID：12412558
> 
> 赞同：1
> 
> 时间：2012-09-13T18:30:46.040
> 
> 标签：iphone, ios, xcode

我住在纽约，我的客户在芝加哥生活和工作，我正在为他的公司开发在 iphone 和 ipad 上运行的 IOS 应用程序，到目前为止，我一直在向他发送应用程序的截图。

我确实觉得有必要找到一种方法让它在他的 iphone 和 ipad 上运行，以便让他对解决方案有一个外观和感觉并浏览它。今天我可以在我自己的设备上运行，这些设备连接到我的 mac 并在我从 XCode 编译时安装......

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:32:23.263

您可以向他发送[Ad Hoc](https://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/YourFirstAppStoreSubmission/TestYourApponManyDevicesandiOSVersions/TestYourApponManyDevicesandiOSVersions.html)构建，但我真的建议使用[TestFlight](http://www.testflightapp.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:32:44.120

您将创建临时构建并将其发送给他们。您将需要获取他们设备的 UDID 并为其进行特殊构建。您可以查看供应门户中的苹果文档以了解如何执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:48:13.040

如果您不想为每个设备使用 UDID 或构建（就像 Ad-Hoc 构建一样），请查看[企业分发](https://developer.apple.com/programs/ios/enterprise/)。我已经做到了，真的很舒服。不过，我也建议在此之前检查一下[TestFlight 。](https://testflightapp.com/)

# c# - 刷新 GridView 数据

> ID：12412561
> 
> 赞同：0
> 
> 时间：2012-09-13T18:31:06.913
> 
> 标签：c#, jquery, webforms

在我第一次加载我的`aspx`页面时，我有一个`GridView`被填满的。

在我的`ASPX`页面中，我处理单选按钮上的点击事件

```
 $("#ctl00_contentConteudo_rbBuscas_1").click(function () {
        $.get("../Gerenciar/ListaUsuarioProvisorio.aspx?Documentacao=s&r=" + Math.random(2), {}, function (data) {                
        });
    }); 
```

所以，当我的单选按钮被点击时，这种力量会再次传递我的页面加载。

**ASPX**

```
<div id="infoGrid" runat="server">
    <cc1:GridView ID="grdImoveis" CssClass="StyleGrid" Width="100%" runat="server" ShowHeader="false"
        AutoGenerateColumns="False" DataSourceID="dsGrid" BorderWidth="0px" GridLines="None"
        AllowPaging="True" EnableModelValidation="True" >
        <AlternatingRowStyle BackColor="White" CssClass="EstiloDalinhaAlternativaGrid" HorizontalAlign="Center" />
        <RowStyle CssClass="EstiloDalinhaGrid" HorizontalAlign="Center" />
        <Columns>
            <asp:BoundField HeaderText="Nome" DataField="NomeCompleto" />
            <asp:BoundField HeaderText="Cargo" DataField="DescricaoCargo1" />
            <asp:BoundField HeaderText="Data Cadastro" DataField="DataHora" />
            <asp:TemplateField ControlStyle-CssClass="acoes_lista_imovel" HeaderText="Curso">
                <ItemTemplate>
                    <div class="acoes_lista_imovel">
                        <%# montaIcones(Eval("Usuario_Id").ToString())%>
                    </div>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </cc1:GridView>
    <asp:SqlDataSource ID="dsGrid" runat="server"></asp:SqlDataSource>
</div> 
```

**代码背后**

在我后面的代码中，我`PageLoad`只是调用我的`CarregaLista`方法，这填充了我的`GridView`

```
protected void CarregaLista()
        {            
                string documentacao = Request.QueryString["Documentacao"].ToString();

                if (documentacao.Equals("s"))
                {
                    string select = string.Empty;
                    select += "SELECT top 10 San_Credenciada.Apelido, San_Usuario.NomeCompleto, San_Usuario.Usuario_Id, San_Usuario.DescricaoCargo1, "
                        + "CONVERT(varchar, San_Usuario.DataHora, 103) AS DataHora "
                        + "FROM San_Usuario "
                        + "JOIN San_Credenciada "
                        + "ON San_Usuario.Credenciada_Id = San_Credenciada.Credenciada_Id "
                        + "WHERE San_Usuario.Excluido = 0 "                        
                        + "GROUP BY San_Credenciada.Apelido, San_Usuario.NomeCompleto, San_Usuario.Usuario_Id, "
                        + "San_Usuario.DescricaoCargo1, San_Usuario.DataHora "
                        + "ORDER BY San_Usuario.DataHora ASC ";

                    dsGrid.ConnectionString = c.Con;
                    dsGrid.SelectCommand = select;
                    dsGrid.DataBind();
                    grdImoveis.DataBind();
                    dsGrid.Dispose();
                }
            }
} 
```

**带更新面板**

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional" >
    <ContentTemplate>
                <asp:RadioButton ID="RadioButton2" runat="server" Text="Curso Básico Netimóveis" />
                <asp:RadioButton ID="RadioButton1" runat="server" Text="Buscar Lista de Presença" />
                <asp:RadioButton ID="rdBuscas" runat="server" OnCheckedChanged="Click" Text="Curso Documentação Imobiliária" />
        <cc1:GridView ID="grdImoveis" CssClass="StyleGrid" Width="100%" runat="server" ShowHeader="false"
            AutoGenerateColumns="False" DataSourceID="dsGrid" BorderWidth="0px" GridLines="None"
            AllowPaging="True" EnableModelValidation="True" >
            <AlternatingRowStyle BackColor="White" CssClass="EstiloDalinhaAlternativaGrid" HorizontalAlign="Center" />
            <RowStyle CssClass="EstiloDalinhaGrid" HorizontalAlign="Center" />
            <Columns>
                <asp:BoundField HeaderText="Nome" DataField="NomeCompleto" />
                <asp:BoundField HeaderText="Cargo" DataField="DescricaoCargo1" />
                <asp:BoundField HeaderText="Data Cadastro" DataField="DataHora" />
                <asp:TemplateField ControlStyle-CssClass="acoes_lista_imovel" HeaderText="Curso">
                    <ItemTemplate>
                        <div class="acoes_lista_imovel">
                            <%# montaIcones(Eval("Usuario_Id").ToString())%>
                        </div>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </cc1:GridView>

        <asp:SqlDataSource ID="dsGrid" runat="server"></asp:SqlDataSource>
        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="rdBuscas" />
        </Triggers>        
        </asp:UpdatePanel> 
```

我的问题是我`GridView`没有用这个查询刷新。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:36:42.290

您可以使用`Ajax`基于`UpdatePanel`和`Triggers``UpdateMode="Condition"`

您可以使用此代码（在触发器上调整您的 GridView 和单选按钮的 Id）

```
<asp:ScriptManager ID="ScriptManager1" runat="server" >
</asp:ScriptManager>

<asp:UpdatePanel ID="UpdatePanel1" runat="server" ModeUpdate="Conditional">
    <ContentTemplate>

        <asp:GridView ID="GridView1" runat="server">
            <Columns>
                  ......
            </Columns>
        </asp:GridView>

       <asp:RadioButton ...../> 

    </ContentTemplate>

    <Triggers>
          <asp:AsyncPostBackTrigger ControlID="YourRadioButtonId" EventName="Click" />
    </Triggers>
</asp:UpdatePanel> 
```

# javascript - D3 流图的数组格式

> ID：12412563
> 
> 赞同：1
> 
> 时间：2012-09-13T18:31:10.037
> 
> 标签：javascript, graph, d3.js, stream-graph

[https://github.com/mbostock/d3/wiki/Stack-Layout](https://github.com/mbostock/d3/wiki/Stack-Layout)

[http://mbostock.github.com/d3/ex/stream.html](http://mbostock.github.com/d3/ex/stream.html)

![在此处输入图像描述](../Images/e34fb1dce3adfe375f092cf94db6e770.png)

我正在尝试使用 D3.js 制作流图。查看示例，我们看到数据是通过辅助函数制定的`stream_layers(n, m)`。在此示例中，返回一个数组，如 API 中所述。API 描述输入 x、y 和 y0。但该示例使用 x, y0, y1。

我的数据集的公式类似于 API 中描述的数据集：

```
{
    "name": "apples",
    "values": [
      { "year": -2000, "y":  91},
      { "year": -1950, "y": 290}
 ]
},
{  
  "name": "oranges",
  "values": [
    { "year": -2000, "y":  9},
    { "year": -1950, "y": 49}
  ]
} 
```

堆叠此数据集的辅助函数会是什么样子？该示例返回一个 3D 数组（一维表示层数，一维表示样本数，一维表示`m`每个样本的 y 值）。

# c# - 为什么用@分配字符串？

> ID：12412564
> 
> 赞同：0
> 
> 时间：2012-09-13T18:31:14.903
> 
> 标签：c#

> **可能重复：**
> [C# 中字符串前面的@ 是什么？](https://stackoverflow.com/questions/556133/whats-the-in-front-of-a-string-in-c)

这是我长期以来一直质疑但从未费心去弄清楚的问题。当我下载第三方库时，我经常看到在字符串`@`之前使用符号的字符串分配。

```
string myString = @"Some text"; 
```

但是，如果我只是这样做，似乎绝对没有区别

```
string myString = "Some text"; 
```

那么在`@`做什么呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:32:09.193

它表示[逐字字符串文字](http://msdn.microsoft.com/en-us/library/aa691090%28v=vs.71%29.aspx)，并允许您*不必*转义某些字符：

```
string foo = @"c:\some\path\filename.exe"; 
```

与：

```
string foo = "c:\\some\\path\\filename.exe"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:32:19.583

```
string reason = @"this string literal mea\ns something different with an @ in front than without"; 
```

如果没有@，上面的字符串将有一个换行符，而不是单词“means”中的'n'。使用@，“意思”这个词看起来就像你看到的一样。此功能对于文件路径之类的内容特别有用：

```
string path = @"C:\Users\LookMa\NoDoubleSlashes.txt"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:32:59.177

它是逐字字符串文字。它可以让你做类似的事情，`@"C:\"`而不是`"C:\\"`，并且在正则表达式和文件路径中特别有用，因为这些通常使用编译器不应该解析的反斜杠。有关更多信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/362314fe.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:32:51.810

在这种情况下没有区别。'@' 所做的只是允许您省略转义反斜杠。如果您使用 '@' 并希望在字符串中包含双引号，则需要将双引号加倍。

# mysql - MYSQL：如何禁止用户更改密码？

> ID：12412569
> 
> 赞同：1
> 
> 时间：2012-09-13T18:31:38.593
> 
> 标签：mysql, passwords, privileges

用户可以在登录时执行命令“SET PASSWORD”，我想知道是否 any1 知道是否可以禁用它。正如搜索的那样，似乎不是。

谢谢你

# java - 运行java程序时eclipse中的内部错误

> ID：12412574
> 
> 赞同：1
> 
> 时间：2012-09-13T18:31:56.133
> 
> 标签：java, eclipse, internal

今天早些时候 Eclipse 冻结了我，所以我在命令提示符中输入了“top”并杀死了它。现在，当我尝试运行 java 应用程序时，出现此错误：

```
eclipse\plugins\org.eclipse.jdt.debug_3.7.0.v20110509 
```

这就是详细信息下显示的所有内容。

我以前工作的程序都没有运行，我不知道这是什么。我有运行 1.6 和 1.7 Java 的 Eclipse 1.5.0，具体取决于什么程序。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:18:10.543

您可能杀死了部分过程，但不是全部。有可能一个 java 进程正在运行并引用此作业。我会尝试重新启动您的计算机，看看它是否会停止引用该 jar 的任何进程。

除了重新启动之外，另一个选项是使用（在 linux 中）pstree，为您的用户过滤以查看是否有任何其他作业正在引用该 jar 和/或 java。

编辑：另一个路径是查看日志文件。在 linux 上，它们位于 /var/log 中。这是该方向的链接：http: [//docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-Desktop/html/felog.html](http://docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-Desktop/html/felog.html)

# php - 为什么我不能用php将数据插入我的sql db

> ID：12412579
> 
> 赞同：-4
> 
> 时间：2012-09-13T18:32:07.863
> 
> 标签：php, mysql

它相当令人沮丧，我相信它很容易解决。据我所知，我的代码是正确的，这让我相信存在服务器问题。我已经创建了数据库，我可以从命令行将数据插入表中。如果它有帮助，我正在使用 WAMP。

```
<?php

$host="localhost"; // Host name 
$username="root"; // Mysql username 
$password="permission"; // Mysql password 
$db_name="login"; // Database name 
$tbl_name="members"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form 
$myusername=$_POST['username']; 
$mypassword=$_POST['password']; 
$myfname=$_POST['fname'];
$mylname=$_POST['lname'];
$myemail=$_POST['email'];

// To protect MySQL injection 
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// username taken
echo "Username already taken";
exit();
}

//protection against sql injection
if (get_magic_quotes_gpc())
{
function stripslashes_deep($value)
{
$value = is_array($value) ?
array_map(stripslashes_deep, $value) :
stripslashes($value) ;
return $value;
}
$_POST = array_map(stripslashes_deep, $_POST);
$_GET = array_map(stripslashes_deep, $_GET);
$_COOKIE = array_map(stripslashes_deep, $_COOKIE);
$_REQUEST = array_map(stripslashes_deep, $_REQUEST);
}

//insert form into DB members

'INSERT INTO members SET
username="' . $myusername . '",
password="' . $mypassword . '",
email="' . $myemail . '",
fname="' . $myfname . '",
lname="' . $mylname . '",';

session_register("myusername");
session_register("mypassword"); 
header("location:registersuccess.html");
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:36:28.427

除了 SQL 注入问题之外，您还有一个不必要的尾随逗号。

改变：

```
lname="' . $mylname . '",'; 
```

至：

```
lname="' . $mylname . '"'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:36:48.263

这可能是因为你有一个额外的尾随逗号： `lname="' . $mylname . '",';`应该是`lname="' . $mylname.'"';`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:37:59.033

另外，如果您不知道如何进行查询，则如下所示：

```
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

/* Create table doesn't return a resultset */
if (mysqli_query($link, "CREATE TEMPORARY TABLE myCity LIKE City") === TRUE) {
    printf("Table myCity successfully created.\n");
} 
```

参考。 [http://php.net/manual/en/mysqli.query.php](http://php.net/manual/en/mysqli.query.php)

# c - 如何概括我的代码

> ID：12412583
> 
> 赞同：0
> 
> 时间：2012-09-13T18:32:26.363
> 
> 标签：c, bitmap, bit-manipulation

我正在研究一些位图字体。这里的想法是给我两个文件（input.txt 和 font.txt）。我必须从 input.txt 中读取一个字符串并使用 font.txt 的内容对其进行转换，然后将相应的输出打印到另一个名为 output.txt 的文件中。font.txt 中的每个字符由 16x8 的网格表示。

我只是实现了一个简单的 [rogram 来将单个字符 A 转换为位图，如下所示。有人可以帮我减少代码。
谢谢你。

```
int main()
{
    unsigned int arr[]=
                       {
                        0x00,0x00,0x10,0x38,
                        0x6c,0xc6,0xc6,0xfe,
                        0xc6,0xc6,0xc6,0xc6,
                        0x00,0x00,0x00,0x00
                        };

  int i,k,j;
  int bin[8];
  int c=7;
  for(i=0;i<16;++i)
  {

        bin[0]=arr[i]>>7;
        bin[1]=(arr[i]>>6)&1;
        bin[2]=(arr[i]>>5)&1;
        bin[3]=(arr[i]>>4)&1;
        bin[4]=(arr[i]>>3)&1;
        bin[5]=(arr[i]>>2)&1;
        bin[6]=(arr[i]>>1)&1;
        bin[7]=arr[i]&1;
      k=0;  
      for(j=0;j<4;j++){
      if(bin[k]==0 && bin[k+1]==0)
          {
            printf("..");
          }
          else if(bin[k]==0 && bin[k+1]==0)
          {
            printf(".C");
          }
          else if(bin[k]==0 && bin[k+1]==0)
          {
            printf("C.");

          }
          else
          {
            printf("AA");
      }
k=k+2;      
      }
   printf("\n");

  }
} 
```

输出：

```
........
........  
..AA....  
..AAAA..  
AAAAAA..  
AA..AAAA  
AA..AAAA  
AAAAAAAA  
AA..AAAA  
AA..AAAA  
AA..AAAA  
AA..AAAA  
........  
........  
........  
........ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:49:23.480

这会产生与您相同的输出，但我忽略了“.C”和“C”的逻辑。因为你的代码也是如此。;-)

```
#include <stdio.h>
int main() {
    unsigned int arr[]=
                       {
                        0x00,0x00,0x10,0x38,
                        0x6c,0xc6,0xc6,0xfe,
                        0xc6,0xc6,0xc6,0xc6,
                        0x00,0x00,0x00,0x00
                        };

  int i,j;
  for(i=0;i<16;++i) {
    unsigned char letter = arr[i];
    for(j =0; j < 7; j++) {
        const char *str = "..";
        if(letter & 0x80) str = "AA";
        fputs(str,stdout);
        letter <<= 1;
    }
    putchar('\n');
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:52:06.207

像这样的东西

```
 int main()
    {
        unsigned int arr[]=
                           {
                            0x00,0x00,0x10,0x38,
                            0x6c,0xc6,0xc6,0xfe,
                            0xc6,0xc6,0xc6,0xc6,
                            0x00,0x00,0x00,0x00
                            };

      int i,k,j;
      int bin[8];
      for(i=0;i<16;++i)
      {
          for(j=0;j<8;j++)
          {
            bin[j]=arr[j]>>(7-i2);
          }
          for(k=0;k<8;k+=2){
              if(bin[k]==0 && bin[k+1]==0)
              {
                printf("..");
                continue;
              }
              printf("AA");   
          }
         printf("\n");
      }
    } 
```

我删除了 printf(".C") 和 printf("C.") 因为他们从来没有打电话

# asp.net - 是什么导致在 VS 2010 的编译时出现间歇性的“对象引用未设置为对象的实例”？

> ID：12412588
> 
> 赞同：1
> 
> 时间：2012-09-13T18:32:43.497
> 
> 标签：asp.net, vb.net, visual-studio-2010

如果这不是一个真正的编码问题，我很抱歉（这取决于我的代码是否导致了我认为的问题）。

我见过这个问题：[跟踪间歇性“对象引用未设置为对象的实例”。构建错误](https://stackoverflow.com/questions/209465)

但是，它并没有太大帮助（尽管如果您阅读评论，您会发现我认为它确实帮助了一段时间）。

当我尝试发布我的网站时，偶尔会收到没有文件或行引用的错误：

```
Pre-compiling Web Site

Building directory '/App_Code/'.
Building directory '/'.: Publication (web): Object reference not set to an instance of an object.

Pre-compilation Complete
------ Skipped Publish: Project X:\, Configuration: Debug Any CPU ------ 
```

我知道“对象引用未设置为对象的实例”的常见原因，但这似乎有点不同，不应该是运行时错误吗？不是构建错误？

奇怪的是，它似乎是随机发生的（大约 25%-33% 的时间）。我可以尝试发布它并让它失败。然后再试一次，不做任何改变，它工作正常。

在将我的一些函数（VB.net btw）移动到 App_Code 文件夹中的新文件后，我开始收到此错误，以便站点的所有页面都可以访问它们。

如果您需要更多信息，请告诉我。

谢谢，

编辑：经过进一步调查，似乎只有在我尝试在将更改保存到其中的任何文件后几秒钟内发布网站时才会发生。什么可能导致这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T05:28:36.420

同样的错误发生在我身上，我删除了网站中已经在bin中的自定义控件的dll，然后我发布了网站，并成功了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:57:57.757

**如果**您的项目中有任何自定义/用户控件，它们实际上是在设计时运行的，并且可能会给出对象引用错误。这也可能在构建期间发生。在这种情况下，引用的属性是 NOTHING 并引发错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T04:35:31.267

我在 Windows 窗体项目中遇到了类似的问题。

无论我尝试在 windows 窗体上移动自定义控件，然后尝试保存窗体，VS2010 都会返回“对象未设置为对象的实例”。

我怀疑错误在我继承的代码的抽象层的深处，但是如果不检查每一行代码，就无法确定要走多远。

我对这个问题的解决方案是这样的。

1.  打开另一个 Visual Studio 2010 实例
2.  菜单：调试 | 附加到进程..
3.  搜索“devenv.exe xxx YourApplicationName...”并选择它
4.  点击“附加”
5.  菜单：调试 | 例外..
6.  勾选投掷列中的所有框，然后“确定”

您的 VS2010 的第二个实例没有调试您的第一个实例，包括所有自定义控件。

返回VS2010的第一个实例，并重复最初导致错误的操作，VS2010的第二个实例将在有错误的代码行处中断。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-07-04T13:15:05.327

你可能想看看这个链接 vs2012 中有一个错误

[https://connect.microsoft.com/VisualStudio/feedback/details/749901/error-when-i-click-publish-object-reference-not-set-to-an-instance-of-an-object](https://connect.microsoft.com/VisualStudio/feedback/details/749901/error-when-i-click-publish-object-reference-not-set-to-an-instance-of-an-object)

# jquery - ajax - 渲染两个局部视图

> ID：12412591
> 
> 赞同：0
> 
> 时间：2012-09-13T18:32:57.257
> 
> 标签：jquery, asp.net-mvc

在单击按钮时，我使用 jquery $.ajax 获取一些数据，调用控制器操作方法并返回强类型的局部视图。数据显示在表格中。

当数据可用时，我还需要呈现另一个强类型的局部视图（与 resultSetView 的模型相同）以显示 resultSetView 的页面导航按钮。

我该怎么做第二部分？

```
$.ajax({
            type: "POST",
            url: $form.attr('action'),
            data: $form.serialize(),
            error: function (xhr, status, error) {
                //do something about the error   
            },
            success: function (response) {
                $("#resultSetDiv").html(response);
                //need to reload pageNavigationDiv
            }
        }); 
```

标记就像

```
<div id="pageNavigation >
    @Html.Partial("_pageNavigationView")
</div>
<div id="resultSetDiv">
     @RenderSection("_resultSetView")
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:42:40.097

`JSON`以以下格式从您的操作方法发送响应

```
{
    "success": "true",
    "currentPage": "3",
    "totalPages": "12",
    "viewString": "<div>Somecontent</div>"
} 
```

viewString 中的值将是要加载到 resultSetDiv 的 HTML 标记。

```
success: function (response) {
          if(response.sucesss=="true")
          {
              $("#resultSetDiv").html(response.viewString);
              $("#yourPageNumber").html(response.currentPage);
          }
} 
```

这个[答案](https://stackoverflow.com/a/3027713/40521)解释了如何以 JSON 格式发送 ViewResult

# hibernate - 休眠标准+没有结果的投影

> ID：12412593
> 
> 赞同：0
> 
> 时间：2012-09-13T18:33:05.693
> 
> 标签：hibernate, criteria, projection, hibernate-criteria

我需要所有姓名为 <> null 的不同的人：

```
List<Criterion> conditions = new ArrayList<Criterion>();
conditions.add(Restrictions.ne("name", null));
Projection projection = Projections.distinct(Projections.property("name"));
List<People> result = dao.findByCriteria(conditions, projection); 
```

在哪里：

```
public List<T> findByCriteria(List<Criterion> list, Projection projection) {

   try {                
        Criteria criteria = getSession().createCriteria(entityClass);
        if (list != null) {
            for (int i = 0; i < list.size(); i++) {
                criteria.add(list.get(i));
            }
        }
        if (projection != null) {
            criteria.setProjection(projection);
        }
        List result = criteria.list();
        return result;
   } catch (Exception e) {
        // log
   }
} 
```

生成的查询是：

```
Hibernate: select distinct this_.name as y0_ from Mrdb this_ where this_.name<>? 
```

但我没有结果！事实上，仅使用投影或仅使用标准列表查询工作正常，但使用两者都没有结果。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T12:59:35.683

尝试：

```
conditions.add(Restrictions.isNotNull("name")); 
```

生成的查询将是这样的：

```
Hibernate: select distinct this_.name as y0_ from Mrdb this_ where this_.name is not null 
```

**编辑：**

正如[@JBNizet](https://stackoverflow.com/users/571407/jb-nizet)在问题评论中所说：

> （生成的）查询很好，但是在 SQL 中，就像在 HQL 中一样，将某些内容与 null 进行比较总是会导致 false。要与 null 进行比较，必须始终使用 is null 或 is not null。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T11:07:06.847

为什么不在标准中添加对该字段的限制？

例如，对于`fieldName`您实体中的字段：

```
Criteria criteria = getSession().createCriteria(entityClass);
criteria.add(Restrictions.isNotNull("fieldName")); 
```

# android - android ndk - ANativeWindow_lock 不一致？

> ID：12412594
> 
> 赞同：1
> 
> 时间：2012-09-13T18:33:10.577
> 
> 标签：android, c, android-ndk

我正在为 android 2.3 编写代码。
我写了这个程序；它从 (0,0) 到 (99,99) 绘制一条 100 像素长的白色对角线。

有一个错误：代码仅在第一次执行时才能正确绘制屏幕。
每次之后，它都会画两条较短的对角线；一条黄绿线和一条蓝线。
每条线出现大约一半的正确长度。
黄绿线似乎从 (0,0) 开始，但蓝色线似乎从 (200,0) 左右开始

我注意到每次执行代码时，**ANativeWindow_Buffer.format**可能会有所不同，不知道是否相关。

有谁知道发生了什么？

谢谢您的帮助

```
#include <android/log.h>
#include <android_native_app_glue.h>

ANativeWindow_Buffer buffer;

void Out( int x, int y ) {

    uint16_t * pPixel = buffer.bits;

    /* Compute correct x,y */
    pPixel += ( x + ( y * buffer.stride ) );

    /* put a white pixel there */
    *pPixel = -1;

}

void drawscreen( struct android_app * app ) {

    unsigned u;

    for ( u = 0; u < 100; u++ ) {

        Out( u, u );

    }

}

static void android_handle_cmd( struct android_app * app, int32_t cmd ) {

    switch ( cmd ) {

        case APP_CMD_INIT_WINDOW:

            // The window is being shown.
            if ( NULL == app->window ) {

                return;

            }

            if ( 0 > ANativeWindow_lock( app->window, &buffer, NULL ) ) {

                return;

            }

            drawscreen( app );

            ANativeWindow_unlockAndPost( app->window );
            break;

    }

}

void android_main( struct android_app * app ) {

    app_dummy();

    app->onAppCmd     = android_handle_cmd;

    for ( ;; ) {

        int events;

        int iRet;

        struct android_poll_source * source;

        iRet = ALooper_pollAll( -1, NULL, &events, (void**)&source );

        if ( NULL != source ) {

            source->process( app, source );
            continue;

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T18:51:32.500

也许尝试：

```
 int32_t w = ANativeWindow_getWidth(app->window);
  int32_t h = ANativeWindow_getHeight(app->window);
  ANativeWindow_setBuffersGeometry(app->window, w, h, WINDOW_FORMAT_RGB_565); 
```

在调用drawscreen之前

# python - 将python源代码拆分为多个文件？

> ID：12412595
> 
> 赞同：80
> 
> 时间：2012-09-13T18:33:10.687
> 
> 标签：python

我有一个代码，我希望将其拆分为多个文件。在 matlab 中，可以简单地调用一个`.m`文件，只要它没有被特别定义为任何东西，它就会像被调用代码的一部分一样运行。示例（已编辑）：
**test.m**（matlab）

```
function [] = test()
    ... some code using variables ...
    test2 
```

**test2.m** (matlab)

```
... some more code using same variables ... 
```

调用`test`运行 test 中的代码以及 test2 中的代码。

python是否有类似的方法将`... some more code ...`, 放入外部文件中，就像在调用它的文件中一样简单地读取它？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-13T18:38:29.983

当然！

```
#file  -- test.py --
myvar = 42
def test_func():
    print("Hello!") 
```

现在，这个文件（“test.py”）在 python 术语中是一个“模块”。我们可以导入它（只要它可以在我们`PYTHONPATH`的.`PYTHONPATH``use_test``test.py`

```
#file -- use_test.py --
import test
test.test_func()  #prints "Hello!"
print (test.myvar)  #prints 42

from test import test_func #Only import the function directly into current namespace
test_func() #prints "Hello"
print (myvar)     #Exception (NameError)

from test import *
test_func() #prints "Hello"
print(myvar)      #prints 42 
```

除了通过使用允许您将多个文件视为单个模块的特殊文件之外，您还可以做更多的事情`__init__.py`），但这回答了您的问题，我想我们会把剩下的留到下一次。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-12-28T19:37:42.810

我现在正在研究 python 中的模块用法，并认为我会从两个角度回答 Markus 在上面的评论中提出的问题（“如何在嵌入模块时导入变量？”）：

1.  变量/函数，和
2.  类属性/方法。

以下是我将如何重写主程序 f1.py 以演示 Markus 的变量重用：

```
import f2
myStorage = f2.useMyVars(0) # initialze class and properties
for i in range(0,10):
    print "Hello, "
    f2.print_world()
    myStorage.setMyVar(i)
    f2.inc_gMyVar()
print "Display class property myVar:", myStorage.getMyVar()
print "Display global variable gMyVar:", f2.get_gMyVar() 
```

以下是我将如何重写可重用模块 f2.py：

```
# Module: f2.py
# Example 1: functions to store and retrieve global variables
gMyVar = 0
def print_world():
    print "World!"
def get_gMyVar():
    return gMyVar # no need for global statement 
def inc_gMyVar():
    global gMyVar
    gMyVar += 1  

# Example 2: class methods to store and retrieve properties
class useMyVars(object):
    def __init__(self, myVar):
        self.myVar = myVar
    def getMyVar(self):
        return self.myVar
    def setMyVar(self, myVar):
        self.myVar = myVar
    def print_helloWorld(self):
        print "Hello, World!" 
```

当 f1.py 在此处执行时，输出将如下所示：

```
%run "f1.py"
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Hello, 
World!
Display class property myVar: 9
Display global variable gMyVar: 10 
```

我认为马库斯的重点是：

*   要多次重用模块的代码，请将模块的代码放入函数或类中，
*   要重用作为属性存储在模块中的变量，请在类中初始化属性并添加“getter”和“setter”方法，这样就不必将变量复制到主程序中，
*   要重用存储在模块中的变量，请初始化变量并使用 getter 和 setter 函数。setter 函数会将变量声明为全局变量。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-09-13T18:38:21.047

Python 有导入和命名空间，这很好。在 Python 中，您可以导入到当前命名空间中，例如：

```
>>> from test import disp
>>> disp('World!') 
```

或者使用命名空间：

```
>>> import test
>>> test.disp('World!') 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-13T18:38:54.913

您可以通过简单地导入第二个文件在 python 中执行相同的操作，顶层代码将在导入时运行。我建议这充其量是混乱的，而不是一个好的编程习惯。你最好把你的代码组织成[模块](http://docs.python.org/tutorial/modules.html)

例子：

F1.py：

```
print "Hello, "
import f2 
```

F2.py：

```
print "World!" 
```

运行时：

```
python ./f1.py
Hello, 
World! 
```

编辑澄清：我建议的部分是“混乱”，`import`只是为了产生输出的副作用，而不是创建单独的源文件。

# javascript - 函数返回值而不用给定参数替换变量

> ID：12412596
> 
> 赞同：3
> 
> 时间：2012-09-13T18:33:21.517
> 
> 标签：javascript, anonymous-function, currying, lambda-calculus

对我提出问题的愚蠢方式感到抱歉，这里有一些解释：我正在用 javascript 中的 lambda-calculus 进行试验，但遇到了一些小困难。（你不必知道任何关于 lambda 演算的知识来帮助我）

我有这个功能（教堂数字 1 顺便说一句）：

```
function num1(c) {
return function(x){
    return c(x);
}
 }

alert(num1) 
```

表现如预期，并给出与上面完全相同的东西。

```
alert(num1(num1)) 
```

表现出乎意料并给出：

```
function (x) {
    return c(x);
} 
```

为什么javascript不用函数num1替换'c'？但

```
alert(num1(num1)(num1)) 
```

给出：

```
function (x) {
    return c(x);
} 
```

并表明第一个 c 实际上已按预期被函数替换。如果'c'不会被替换，那么就会发生这种情况：

```
(num1(num1)(num1))=

(function (x) {return c(x);}(num1=

c(function num1(c) {
    return function(x){
        return c(x);
    }
}) 
```

所以总而言之，代码正在做它应该做的事情，但它不会输出替换了“c”的函数。我能做些什么？稍后，我将使用更多功能，然后我将无法区分`num1(asd)`，`num1(jkl)`因为“c”没有被替换。

非常感谢您的帮助！

别人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:52:26.937

你为什么不试试这个：

```
function num1(c) {
   function rv(x){
    return c(x);
  }
   rv.showBinding = function() {
     return c;
   }

   return rv;

} 
```

然后：

```
alert(num1);
alert(num1(num1).showBinding()); 
```

# wordpress - 使用 htaccess 访问带有漂亮 url 的 wordpress 帖子

> ID：12412599
> 
> 赞同：0
> 
> 时间：2012-09-13T18:33:28.580
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite

我有一个 wordpress 网站，目前显示类似的帖子

```
http://mysite.com/index.php?p=1 
```

现在我想通过写 url 来访问同样的东西

```
http://mysite.com/1 
```

什么是重写规则来做到这一点.. 我看到 .htaccess 从 url 和正则表达式中隐藏 index.php 但无法正确执行所需的操作！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:40:15.333

在文档根目录的 htaccess 文件中，最好在任何与 wordpress 相关的重写规则之前，添加以下内容：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?([0-9]+)$ /index.php?p=$1 [L,QSA] 
```

# vb.net - 为什么一个类不能识别另一个类的公共成员变量

> ID：12412600
> 
> 赞同：0
> 
> 时间：2012-09-13T18:33:29.597
> 
> 标签：vb.net, dll, dllimport

我有两个课程如下

```
 Public Class A_one     'This project does not have a dll generated even after a build. Any reason why ?
    Public Structure struct
        Dim xyz as String
        Dim p as String
    End Structure
    Public Sub xyz(...)
        ClassB_one_Obj = New ClassB_one_Obj(SampleStruct) 

        ClassB_one_Obj.send_struct(sampleStruct)   
    End Sub

    Public Class B_one       'In a different project 
    Public Sub send_struct(ByVal sampleStruct As A_one.struct)  'Throwing error here **"Type A_one.struct not defined"** 
```

任何人都可以解释为什么我会收到错误。是不是因为我没有在 Class B_one 中添加 class A_one 的 dll 引用？我试图添加 A_one 的引用 dll，但在 obj/bin 文件夹中也找不到它。任何人都可以指出我的工作吗？

**编辑/更新：**认为作为主要可执行文件的类 A_one 创建了类 B_one 的对象，这就是我们不能在 B_one 中创建类 A_one 的对象的原因，因为存在类似死锁的情况。

我们不能从另一个类创建主类（启动类）的对象是真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:02:48.867

是的，错误是因为项目 B 没有引用项目 A，所以它对该类型一无所知。

在 Visual Studio 中，转到项目 B、引用、添加的属性。如果项目 A 与 B 位于同一解决方案中，请将其添加为项目/解决方案引用，否则您可以浏览 DLL。如果使用 DLL 方法，则必须确保项目 A 的项目类型设置为类库并且已成功构建。如果它未设置为类库项目，它很可能已构建为 EXE 文件（如果您需要项目 A 作为独立可执行文件，您也可以添加对 EXE 文件的引用）。

# php - PHPUnit：为自定义断言编写测试

> ID：12412601
> 
> 赞同：2
> 
> 时间：2012-09-13T18:33:36.143
> 
> 标签：php, unit-testing, phpunit

对于我们的 PHPUnit 测试，我们有时会编写自定义断言。今天我发现了一个自定义断言，它并没有断言它应该是什么。如果我为断言本身编写了单元测试，似乎可以避免这个问题。

我看到的唯一问题是我不太确定如何处理编写测试以断言它应该失败，而不会导致测试本身失败。换句话说，对于需要字符串 'foo' 的测试，我想做类似的事情：

```
public function testAssertFoo()
{
   $var = 'bar';
   $callable = array( $this, "assertFoo" );
   $this->assertTestFails( $callable, $var );
} 
```

当然，没有 assertTestFails 断言。但是有没有一种干净的方法来做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T23:22:01.937

假设`assertFoo`使用 PHPUnit 的内置断言，例如`assertEquals`，您可以简单地捕获`PHPUnit_Framework_ExpectationFailedException`断言失败时抛出的那个。

```
function testAssertFoo() {
    try {
        $this->assertFoo('bar');
        self::fail("assertFoo should fail for 'bar'");
    }
    catch (PHPUnit_Framework_ExpectationFailedException $e) { /* test passed */ }
}

function assertFoo($value) {
    self::assertEquals('foo', $value);
} 
```

# facebook - 为什么 FB 针对不同的访问令牌返回同一对象的不同结果？

> ID：12412609
> 
> 赞同：0
> 
> 时间：2012-09-13T18:33:52.390
> 
> 标签：facebook, api, facebook-graph-api

Facebook上有[活动。](https://www.facebook.com/events/321074447988833/)我正在使用 FQL 来检索信息，并且不同访问令牌的结果不同。
选择查询

```
select eid, name, start_time, end_time, update_time, timezone, from event where eid in (321074447988833) 
```

1)[生成](https://developers.facebook.com/tools/explorer/?fql=select%20eid,%20name,%20pic_big,%20description,%20privacy,%20start_time,%20end_time,%20update_time,%20timezone,%20location,%20venue%20from%20event%20where%20eid%20in%20%28321074447988833%29)访问令牌：
[https ://graph.facebook.com/fql?q=select%20eid,%20name,%20pic_big,%20description,%20privacy,%20start_time,%20end_time,%20update_time,%20timezone,% 20location,%20venue%20from%20event%20where%20eid%20in%20(321074447988833)&access_token=XXXXX](https://graph.facebook.com/fql?q=select%20eid,%20name,%20pic_big,%20description,%20privacy,%20start_time,%20end_time,%20update_time,%20timezone,%20location,%20venue%20from%20event%20where%20eid%20in%20(321074447988833)&access_token=XXXXX)
结果：

```
"start_time": "2012-09-12",
"end_time": null, 
```

2）真实用户访问令牌：
结果：

```
"start_time": 1347440400,
"end_time": 1347526800, 
```

为什么在第一个示例中我们没有“end_time”（这是正确的），但在第二个示例中我们有它并且 start_time 和 end_time 之间的差异是一天。所以看起来事件需要 2 天时间接受一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:56:07.950

Graph API Facebook 应用程序必须启用[事件时区迁移。](https://developers.facebook.com/blog/post/2012/08/01/platform-migration--events-timezone-support/)

当前方法是返回事件时间的 UNIX 时间戳，就好像它发生在转换为 GMT 的太平洋时间一样。

启用迁移后，Facebook 现在返回带有时间和时区的[ISO-8601](http://www.w3.org/TR/NOTE-datetime)格式的日期字符串。

目前计划在 12 月将迁移推广到所有应用程序。

# python - python文件返回没有这样的文件或目录

> ID：12412616
> 
> 赞同：2
> 
> 时间：2012-09-13T18:34:03.107
> 
> 标签：python, linux

我编写了一个 python 脚本来查询 freebase 一个开源数据库。我在windows中编写了文件并将其移植到linux。我已经更改了文件的权限并添加了适当的标头，但 linux shell 返回为：

> 没有这样的文件或目录

这是文件：

```
#! /usr/bin/env python
import urllib
import string

#query freebase to find results containing graduates from the University of Texas

query1=[{
  "name": null,
  "type": "/people/person",
  "!/education/education/student": [{
    "!/education/educational_institution/students_graduates": [{
      "id": "/en/university_of_texas"
    }]
  }]
}]

query2=[{
  "id": "/en/university_of_texas",
  "/education/educational_institution/students_graduates": [{
    "student": {
      "name": null
    },
        "degree": {
      "name": null
    },
    "end_date": null,
    "major_field_of_study": [{
      "name": null
    }]
  }]
}]

html = urllib.urlopen("https://www.googleapis.com/freebase/v1/mqlread?query="+query2)

library = json.loads(html)

name_dic = {}

for e in library["result"]:

    name_dic[e["student"]["name"]] = [e["degree"]["name"],int(e["end_date"]),e["major_field_of_study"][0]["name"]]

conn = sqlite3.connect('data.db')
c = conn.cursor()
t=[]

for key in name_dic.iterkeys():
    t.append((key, name_dic[key][0],name_dic[key][1],name_dic[key][2]))
try:
    c.executemany('insert into people values(?,?,?,?)',t)
    print "entities found and saved"
except sqlite3.IntegrityError:
    for k in t:
        try:
            c.execute('insert into people values (?,?,?,?)',k)
            print (str(k[0])+" was added")
        except sqlite3.IntegrityError:
            print "Could not save entities"
conn.commit() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-23T11:11:48.897

我最近遇到了同样的问题。问题是移植文件的文件格式仍然是dos格式并且包含特殊字符。在脚本文件命令上运行*dos2unix*解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:49:20.887

在 shell 上运行以下命令：

$哪个蟒蛇

更改第一行

#！/usr/bin/env 蟒蛇

至

#!_output_of_which_python_

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:42:00.023

如果您的 Linux 系统中缺少 /usr/bin/env，您将收到以下错误：

```
-bash: ./test.py: /usr/bin/env: bad interpreter: No such file or directory 
```

（其中 test.py 是您的脚本的名称）

如果缺少 python（它不应该，现在大多数 Linux 系统都依赖它），你会得到：

```
/usr/bin/env: python: No such file or directory 
```

我可以看到python脚本本身没有任何东西会给你任何其他类似的错误，所以我怀疑它是这两个之一。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-09-13T18:45:18.440

像这样运行它：

```
python /path/to/file.py 
```

然后你可以稍后解决剩下的问题。

# python - Python中的Google App Engine文件夹网址

> ID：12412621
> 
> 赞同：2
> 
> 时间：2012-09-13T18:34:25.067
> 
> 标签：python, google-app-engine, url

在 google App Engine 中，如果我已经有一个页面设置，那么所有内容都会被重定向到 main.py，如下所示：

```
www.foobar.appspot.com/ 
```

将始终转到 main.py

main.py 的设置方式与 hello world 教程几乎相同（除了它调用了我编写的更多函数，但这无关紧要）。

现在我的问题是，我怎样才能以“文件夹”的格式设置多个页面，或者真的用 url 做任何事情......（阅读文档时我没有太多运气）

```
www.foobar.appspot.com/admin/ 
```

会去上课什么的，这显然会处理所有的管理功能（现在我喜欢一个你好世界）。我真的不不，我会让那个网址转到什么脚本，我对谷歌应用引擎的网址一无所知。我看过人们在 main.py 脚本中有多个类的帖子，但我不知道如何更改 yaml 文件以适应它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:46:19.523

您的 main.py 将需要查看 URL 并将其路由到您使用的任何处理程序函数。

这是一个常见的任务，大多数 web 框架都有一些方法来处理它。例如，如果您使用的是 webapp2：

[http://webapp-improved.appspot.com/guide/routing.html](http://webapp-improved.appspot.com/guide/routing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:38:55.783

URL 映射到 python 脚本`app.yaml`；您在那里的第一个匹配 /admin 的正则表达式将确定执行的内容。

在 Python 文件本身中，您还需要处理发送给它们的 URL（如何执行此操作取决于您使用的框架；请参阅您的文档以了解如何进行路由。）

# c++ - C++ recvfrom 不接收所有（二进制）数据

> ID：12412623
> 
> 赞同：0
> 
> 时间：2012-09-13T18:34:40.777
> 
> 标签：c++, linux, dns, binary

我正在尝试在 Linux 2.6.32 上的 C++ 中接收 DNS 请求（带有 DNS 标头的 DNS 内容）。当我使用 netcat 通过 UDP 编写字符串时，该代码有效。但是，如果我执行“nslookup google.com”，它只会收到以下信息：

```
root@EliteBook:/home/.../dns# xxd request.bin  
0000000: 8a2b 01 
```

如果我使用“tcpdump -x 'udp port 53' 它会显示更多字节。

我的 C++ 代码：

```
#include <string>
#include <iostream>
#include <string.h>
#include <arpa/inet.h>
#include <netinet/in.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <unistd.h>

#define BUFLEN 1024*6
#define NPACK 10
#define PORT 53

using namespace std;

void diep(const string &s)
{
        perror(s.c_str());
        exit(1);
}

int main()
{
        struct sockaddr_in si_me;
        struct sockaddr si_other;
        int slen=sizeof(si_other);
        int s;                                          // UDP Socket
        char buf[BUFLEN];
        buf[0] = 'X';
        buf[1] = 'Y';
        buf[2] = 'Z';

        if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP))==-1)
                diep("Failed to create socket!");

        memset((char *) &si_me, 0, sizeof(si_me));
        si_me.sin_family = AF_INET;
        si_me.sin_port = htons(PORT);
        si_me.sin_addr.s_addr = htonl(INADDR_ANY);
        if (bind(s, (const sockaddr*) &si_me, sizeof(si_me))==-1)
                diep("bind");

        for (int i=0; i<NPACK; i++) {
                if (recvfrom(s, buf, BUFLEN, 0, &si_other, (socklen_t*) &slen)==-1)
                        diep("recvfrom()");

                struct sockaddr_in *si_other_in = (struct sockaddr_in *)&si_other;

                cout << "Pkg arrived: " << buf << " " << inet_ntoa(si_other_in->sin_addr) << ":" << ntohs(si_other_in->sin_port) << endl;

                FILE * pFile;
                pFile = fopen ("request.bin","wb");
                if (pFile!=NULL)
                {
                        fputs (buf, pFile);
                        fclose (pFile);
                }
        }
        close(s);

        return 0;
} 
```

编译这个

```
g++ -Wall main.cpp -o dns 
```

那么，我的错是什么，是我忘记了什么还是必须使用其他调用来读取二进制数据？

PS: localhost 是 /etc/resolv.conf 中的第一个名称服务器

**编辑：**

我查看了 recvfrom 的返回值，它告诉我：

```
size: **27**
Pkg arrived: �. 127.0.0.1:36686
size: **45**
Pkg arrived: l 127.0.0.1:38952 
```

那应该没问题。为什么我的缓冲区不能保存所有字节？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:37:28.653

您大多忽略[`recvfrom()`](http://pubs.opengroup.org/onlinepubs/7908799/xns/recvfrom.html). 该返回值告诉您收到了多少字节。

从[手册页](http://pubs.opengroup.org/onlinepubs/7908799/xns/recvfrom.html)：

> 成功完成后，`recvfrom()`返回消息的长度（以字节为单位）

如果没有这些信息，您将无法知道您没有收到所有字节。

> 那么，我的错是什么，是我忘记了什么还是必须使用其他调用来读取二进制数据？

您正在很好地*读取*二进制数据，但是您正在错误地*写入*它。您`std::cout << buf`对每个的调用和调用`fputs(buf, pFile)`都是在字符串中操作的，而不是在二进制数据上。具体来说，它们每个都将字节写入到第一个零值字节，但不包括第一个零值字节。

要修复您的程序，请记录来自 recvfrom 的答案，跳过对 的调用`cout << buf`，并将您的替换`fputs()`为`fwrite`.

```
// UNTESTED
for (int i=0; i<NPACK; i++) {
    int bufsize;
    if ( (bufsize = recvfrom(s, buf, BUFLEN, 0, &si_other, (socklen_t*) &slen))==-1)
        diep("recvfrom()");

        struct sockaddr_in *si_other_in = (struct sockaddr_in *)&si_other;

        cout << "Pkg arrived: " << bufsize << " " << inet_ntoa(si_other_in->sin_addr) << ":" << ntohs(si_other_in->sin_port) << endl;

        FILE * pFile;
        pFile = fopen ("request.bin","wb");
        if (pFile!=NULL)
        {
            fwrite(buf, 1, bufsize, pFile);
            fclose (pFile);
        }
    }
} 
```

# haskell - 保证类型族将派生某些类

> ID：12412627
> 
> 赞同：5
> 
> 时间：2012-09-13T18:35:00.090
> 
> 标签：haskell, type-families

我有以下内容：

```
{-# LANGUAGE TypeFamilies #-}

class Configuration c where
    data Pig c
    data Cow c

    parsePig :: GenParser Char st (Pig c)
    parseCow :: GenParser Char st (Cow c)

data Farm c =
    { pigs :: [Pig c]
    , cows :: [Cow c]
    } deriving Show 
```

`deriving Show`由于这条线，这失败了。我不知道如何强制所有`Configuration`实例确保它们`data Pig`和`data Cow`实现都是`Show`.

我知道我可以让它拥有`showPig`和`showCow`方法并写出整个复杂的`show`实例，但实际上事情比这更复杂，那将是相当痛苦的。

有没有一种简单、优雅的方法来保证类型族实例本身就是某些类的实例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T18:59:50.333

您可以使用仅为实例`StandaloneDeriving`手动指定约束。`Show`

```
{-# LANGUAGE StandaloneDeriving, FlexibleContexts, UndecidableInstances #-}
deriving instance (Show (Pig c), Show (Cow c)) => Show (Farm c) 
```

但是，只要您不尝试使用它们，这仍然可以让您拥有未实现的`Configuration`实例。`Cow``Pig``Show``show`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:00:54.313

既然您说您想*强制*的所有实例`Configuration`具有`Pig c`和`Cow c`实现`Show`，那么更简单的方法是简单地在类的上下文中约束类型族，如下所示：

```
{-# LANGUAGE TypeFamilies, FlexibleContexts #-}

class (Show (Pig c), Show (Cow c)) => Configuration c where
    data Pig c
    data Cow c

data Farm c = Farm { pigs :: [Pig c],
                     cows :: [Cow c] } deriving (Show) 
```

编辑：

正如@hammar 在他的评论中指出的那样，前面的代码不会编译。`StandaloneDeriving`正如他所建议的那样，解决此问题的一种方法是使用。另一种方式是这样的：

```
{-# LANGUAGE TypeFamilies, FlexibleContexts, GADTSyntax #-}

class (Show (Pig c), Show (Cow c)) => Configuration c where
    data Pig c
    data Cow c

data Farm c where
    Farm :: Configuration c => { pigs :: [Pig c],
                                 cows :: [Cow c] } -> Farm c deriving (Show) 
```

这两种方法得到的结果略有不同，如果你调用@hammar 的方法将*需要*一个约束，而我的方法将*提供*所述约束。`Configuration``show`

# php - PHP: 500 Error to error page

> ID：12412633
> 
> 赞同：1
> 
> 时间：2012-09-13T18:35:33.680
> 
> 标签：php, .htaccess

As a prelude, I know what a HTTP 500 is, and I know how to fix them.

On PHP 5.3, i'm running a production environment with show_errors off. When there are any fatal errors, the user gets a plain white 500 page in response. I'm trying to create a 500 error page just in case there any any errors; just so it is more user friendly.

I used to be able to do

```
ErrorDocument 500 500.html 
```

It doesn't seem to be working anymore, however - even thought my 404

```
ErrorDocument 404 404.html 
```

Works fine.

Curious to see solutions regarding this - Thank you for your time.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:41:52.467

Fatal errors don't produce 500 errors in and of themselves, they would return 200 with blank page typically (if no output had been flushed to browser at the point of the error) . Plus this will not help you anyway, as Apache would be no longer involved when PHP is having the error.

Maybe you could register a shutdown function to send 500 header (to get 500 result) and display the content you want to display.

# android - 应用内结算返回空签名

> ID：12412636
> 
> 赞同：1
> 
> 时间：2012-09-13T18:35:55.363
> 
> 标签：android, in-app-purchase, in-app-billing

我正在测试我的应用内计费功能，但由于某种原因，我不明白为什么在被调用时我总是得到一个空签名（`inapp_signature`捆绑额外的字段） 。`com.android.vending.billing.PURCHASE_STATE_CHANGED`

根据[该](http://developer.android.com/guide/google/play/billing/billing_testing.html#billing-testing-static)表的第二行，我将能够获得签名的静态响应签名。为什么它没有发生？

我已经在我的开发者帐户中设置了一个测试帐户（我没有发布该应用程序）并尝试获取该签名但没有成功！

有没有人经历过这个？任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:41:44.300

如果您还没有包含计费的 APK 的已发布版本，那么您将需要使用开发者设备。即一个与您的开发者控制台具有相同帐户的帐户。

您还需要在设备上安装与部署到 Google Play 的版本相同的 APK。事实上，根据记忆，部署（不一定发布）到 Google Play 的最新 APK 需要安装在您设备上的那个。

从部署到 Google Play 到保证手机的 GP 实例可以看到部署到 GP 的版本，您需要等待大约一个小时（可能会有所不同）。

# oracle11g - Oracle解释计划：基数返回一个巨大的数字但查询没有返回记录

> ID：12412638
> 
> 赞同：5
> 
> 时间：2012-09-13T18:36:02.103
> 
> 标签：oracle11g, sql-execution-plan

我编写了一个复杂的 oracle sql 查询，解释计划统计信息如下所示：成本：209,201 字节：187,944,150 基数：409,675

现在 DBA 调整了查询​​，统计数据如下所示： 成本：42,996 字节：89,874,138 基数：209,226

我的第一个问题是，如果数字较低，是否自动意味着更好的性能？哪个数字最相关？成本/基数/字节？我的第二个问题是：我理解基数是读取的行数。但是当我运行查询时，它返回“0”行！我的印象是，对于两个应该返回相同结果集的查询，基数必须相同。这我猜是错的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T15:00:16.000

成本、字节、基数……都是根据输入（如提供给优化器的统计信息）的估计。所以他们自然而然地毫无意义，但可以给出一个想法。用 Oracle Performance Tuning Guide 的话说“最好使用 EXPLAIN PLAN 来确定一个访问计划，然后通过测试证明它是最优计划。在评估计划时，检查语句的实际资源消耗。”

对于第二个问题：理论上等效的查询应该返回相同的基数。您的表格的静态数据可能已经过时了。

# sql - 在 MS Query 中使用多个 INNER JOIN 的 FROM 子句中的子查询的语法

> ID：12412647
> 
> 赞同：1
> 
> 时间：2012-09-13T18:36:43.013
> 
> 标签：sql, excel, ms-query

几天来，我一直在尝试 (grrr) 使用 MS Query 中的手动 SQL 语句窗口从连接 ODBC 的数据库中提取数据。我可以看到我想做的事情，但是我对语法很感兴趣（我很确定它是特定于 MS Query 的）。

问题是这样的：

我有四个表：`waybill, waybill_item, rail_bl`和`rail_bl_item`，它们之间包含有关通过运输设施处理的重量的信息，货物要么被运送到卡车（运单）或铁路（铁路）上。`waybill`和表分别包含卡车和铁路货物的`rail_bl`日期数据；而`waybill_item`和`rail_bl_item`包含有关这些物品重量的数据。

我想要一个表格，该表格将返回每天处理的总重量 - 铁路和卡车运输。IE

```
DATE | WEIGHT
date1, (truck_weight_for_date1+rail_weight_for_date1)
date2, (truck_weight_for_date2+rail_weight_for_date2)
date3, (truck_weight_for_date3+rail_weight_for_date3)
etc 
```

通过执行查询，

```
SELECT waybill.creation_date, sum(waybill_item.weight)
FROM waybill
INNER JOIN waybill_item
ON waybill.id = waybill_item.waybill_id
WHERE waybill.creation_date > '01/01/2012'
GROUP BY waybill.creation_date
UNION
SELECT rail_bl.creation_date, sum(rail_bl_item.total_weight)
FROM rail_bl
INNER JOIN rail_bl_item
ON rail_bl.id = rail_bl_item.rail_bl_id
WHERE rail_bl.creation_date > '01/01/2012'
GROUP BY rail_bl.creation_date
ORDER BY waybill.creation_date DESC 
```

我能够*在单独的记录中*获得包含给定日期的卡车总重量和给定日期的铁路总重量的两列结果，所以我的结果如下所示：

```
DATE | WEIGHT
date1, truck_weight_for_date1
date1, rail_weight_for_date1
date2, truck_weight_for_date2
date2, rail_weight_for_date2
date3, truck_weight_for_date3
date3, rail_weight_for_date3
etc 
```

我遇到的问题是，我无法让 MS Query 接受将上述查询用作子查询，然后对每个日期的记录求和。即使尝试将我的查询作为子查询进行测试也不起作用。

例如，尝试

```
SELECT * FROM
(
SELECT waybill.creation_date, sum(waybill_item.weight)
FROM waybill
INNER JOIN waybill_item
ON waybill.id = waybill_item.waybill_id
WHERE waybill.creation_date > '01/01/2012'
GROUP BY waybill.creation_date
UNION
SELECT rail_bl.creation_date, sum(rail_bl_item.total_weight)
FROM rail_bl
INNER JOIN rail_bl_item
ON rail_bl.id = rail_bl_item.rail_bl_id
WHERE rail_bl.creation_date > '01/01/2012'
GROUP BY rail_bl.creation_date
)
ORDER BY waybill.creation_date DESC 
```

返回“无法添加表 '('”错误。其他语法变体返回类似错误。

有谁知道 - 或者即使 - MS Query 能够执行这样的子查询？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:41:31.433

为了将其用作子查询，您需要在两个地方使用别名。首先，列需要一个名称。其次，派生表需要一个名字：

```
select *
from (SELECT waybill.Creation_date, sum(waybil_item.weight) as Weight
      . . .
      union all
      . . .
     ) t
order by 1 desc 
```

顺便说一句，你想要 UNION ALL 而不是 UNION。如果您碰巧在给定日期有相同的值，UNION 会消除它们。

# iphone - UITableView 中的默认清单

> ID：12412649
> 
> 赞同：0
> 
> 时间：2012-09-13T18:36:50.153
> 
> 标签：iphone, ios, uitableview

我想为`UITableView`. 另外，我需要默认选择一个单元格。这是我的实现`cellForRowAtIndexPath`：

```
NSUInteger row = [indexPath row];
NSUInteger oldRow = [lastIndexPath row];    
cell.accessoryType = (row == oldRow && lastIndexPath != nil) ? UITableViewCellAccessoryCheckmark : UITableViewCellAccessoryNone;

if (indexPath.row == selectedRow ) {
    cell.accessoryType = UITableViewCellAccessoryCheckmark;
 }
else {
    cell.accessoryType = UITableViewCellAccessoryNone;
 } 
```

`didSelectRowAtIndexPath`有这个代码：

```
if (!self.lastIndexPath) {
    self.lastIndexPath = indexPath;
}

if ([self.lastIndexPath row] != [indexPath row])
{
    UITableViewCell *newCell = [tableView cellForRowAtIndexPath: indexPath];
    newCell.accessoryType = UITableViewCellAccessoryCheckmark;

    UITableViewCell *oldCell = [tableView cellForRowAtIndexPath:self.lastIndexPath]; 
    oldCell.accessoryType = UITableViewCellAccessoryNone;

    self.lastIndexPath = indexPath;  
}
else {
    UITableViewCell *newCell = [tableView cellForRowAtIndexPath: indexPath];
    newCell.accessoryType = UITableViewCellAccessoryCheckmark;
} 
```

使用此代码，我可以获得默认复选标记，但每当我选择另一行时，第一行保持选中状态，直到我不单击该单元格。那么，如果我想选择我想要的结果，我应该怎么做？

`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:14:05.050

我认为代码有点太复杂了。您只需要一个属性：

`NSInteger _selectedRow;`

这在最初定义时将提供默认的选定行。它还将保持先前的选择（在查找要“取消选择”的单元格时）：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CELL_IDENTIFIER];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CELL_IDENTIFIER];
    }

    if ([indexPath row] == _selectedRow) {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    }

    cell.textLabel.text = [NSString stringWithFormat:@"Row %d", indexPath.row];

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    if (_selectedRow >= 0) {
        [tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:_selectedRow inSection:0]].accessoryType = UITableViewCellAccessoryNone;
    }
    _selectedRow = [indexPath row];
    [tableView cellForRowAtIndexPath:indexPath].accessoryType = UITableViewCellAccessoryCheckmark;

    [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

创建此视图时，如果您分配：

`_selectedRow = 1;`

然后将自动选择第二行。值`-1`表示没有默认选择，上述两种方法将自动添加/删除点击行的复选标记。

# android - 不寻常的android逻辑运算符无法比较两个字符串

> ID：12412655
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:37:24.613
> 
> 标签：android, string, compare, logic, operator-keyword

我正在尝试一个简单的检查。如果字符串名称语言环境具有“es”作为值。

```
public String locale = 
    Locale.getDefault().getLanguage().toLowerCase().toString();

// ...

Log.v(tag, "Idioma del sistema: «" + locale +"»");
if (locale != "es") {
    showDialog(R.string.warningTitleDialog, 
        "We are sorry that this tool is only available in Spanish " +
        "language. See Author menu item for more information. [" + 
        locale + "]");
    locale = "en";
} 
```

`adb logcat`将“es”显示为字符串“locale”的内容，但条件内的代码正在执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:47:34.307

似乎问题不在于 android 或逻辑，这在 JAVA 中。试试这个，告诉我们发生了什么

```
if(!locale.equals("en"))
{
   //Your Code
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:57:40.377

切勿将 != 或 == 与字符串相关联。尝试这样的方法等于：

```
if(locale.equals("es")) 
```

如果字符串 locale 和 "es" 包含相同的字符序列，这将返回 true。因为equals()方法比较的是String对象中的字符。== 运算符比较两个对象引用以查看它们是否引用同一个实例。

请参阅[Java 中 == 与 equals() 之间的区别是什么？](https://stackoverflow.com/questions/7520432/java-vs-equals-confusion)了解更多信息。

# ruby-on-rails-3 - Rails 3 + Simple Form：使用 f.association 时指定标签类

> ID：12412665
> 
> 赞同：3
> 
> 时间：2012-09-13T18:37:53.567
> 
> 标签：ruby-on-rails-3, simple-form

`f.association`使用而不是`f.input`simple_form时如何指定标签类？

例如，这有效：

```
f.input :name, :label_html => { :class => 'some-class' } 
```

但这并不

```
f.association :periods, :as => :check_boxes, :label_html => { :class => 'some-class' } 
```

这意味着与标签相关的标签`:name`将包含某个类作为其类的一部分，但与标签相关的标签`:periods`不会。有什么方法可以在不更改`f.association`为的情况下做到这一点`f.input`？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-22T08:51:24.360

我认为您不能为每个标签添加自定义类，但您可以为每个项目包装器添加自定义类，例如：

```
<%= simple_form_for(@user) do |f| %>
  <%= f.association :group, as: :check_boxes, item_wrapper_class: 'custom-class' %>
  <%= f.button :submit %>
<% end %> 
```

# java - 使用 JDOM 将数据附加到现有文件

> ID：12412668
> 
> 赞同：0
> 
> 时间：2012-09-13T18:38:07.767
> 
> 标签：java, xml, jdom

我正在使用下面的代码。但是，当我运行代码时，我想将新的 XML 附加到另一个下方的同一个 TXT 文件中。使用 JDOM 是否可行。请帮助我..

xmlOutput.output(doc, new FileWriter("c:\updated.txt")); 是需要修改的吗？

```
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import org.jdom2.Document;
import org.jdom2.Element;
import org.jdom2.JDOMException;
import org.jdom2.input.SAXBuilder;
import org.jdom2.output.Format;
import org.jdom2.output.XMLOutputter;

public class Replacer {
    public static void main(String[] args) {
          try {

            SAXBuilder builder = new SAXBuilder();
            File xmlFile = new File("c:\\file.xml");
            String temp = "1234567";

            Document doc = (Document) builder.build(xmlFile);
            Element rootNode = doc.getRootElement();

            System.out.println("Root Node is --> "+rootNode);

            Element ShipmentLines = rootNode.getChild("ShipmentLines");

            Element ShipmentLine = ShipmentLines.getChild("ShipmentLine");

            Element Containers = rootNode.getChild("Containers");

            Element Container = Containers.getChild("Container");

            ShipmentLine.getAttribute("OrderNo").setValue(temp);

            Container.getAttribute("ContainerScm").setValue(temp);

            XMLOutputter xmlOutput = new XMLOutputter();

            xmlOutput.setFormat(Format.getPrettyFormat());
            xmlOutput.output(doc, new FileWriter("c:\\updated.txt"));

          } catch (IOException io) {
            io.printStackTrace();
          } catch (JDOMException e) {
            e.printStackTrace();
          }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:15:40.187

JDOM 不直接支持附加到现有文件，但它只需要少量的额外代码。只需将输出写入 StringWriter，获取字符串，然后将字符串附加到现有文件。一种可能的实现：

```
XMLOutputter xmlOutput = new XMLOutputter();
xmlOutput.setFormat(Format.getPrettyFormat());
StringWriter out = new StringWriter();
xmlOutput.output(doc, out);
FileUtils.writeStringToFile(new File("c:\\updated.txt"), out.toString(), true); 
```

我在这里使用 commons-io FileUtils 类作弊。请参阅 [使用 Apache Commons I/O 将数据附加到文件中](https://stackoverflow.com/questions/2966333/append-data-into-a-file-using-apache-commons-i-o)

如果 commons-io 对您的应用程序不可用或不实用，则编写您自己的 append-string-to-file 方法。

# java - 获取Tomcat中http端口对应的https端口号

> ID：12412671
> 
> 赞同：3
> 
> 时间：2012-09-13T18:38:25.783
> 
> 标签：java, jakarta-ee, tomcat, servlets

我正在尝试最小化我的 webapp 的配置，而我要删除的一件事是端口号映射：

*   http：80 -> https：443
*   http：9080 -> https：9443

由于配置已经存在于 conf/server.xml 中，我不想在我的应用程序中复制这些设置。不得不更改（并记住更改）多个配置文件是一件痛苦的事。此外，应用程序不应该关心它被部署到什么环境/容器中，只要它支持 http 和 https。

我在 web.xml 中配置了以下内容，但除了重定向之外，我还需要能够构建 https URL：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>secure</web-resource-name>
        <url-pattern>/https/*</url-pattern>
    </web-resource-collection>
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>
</security-constraint> 
```

上面的块告诉 servlet 容器将 http 请求重定向到它的 https 对应项。显然，Tomcat 知道请求来自哪个连接器，在 server.xml 中查找该连接器的“redirectPort”属性并使用该连接器构建 https URL。

根据这些先前/相关的问题，似乎没有标准或特定于 tomcat 的方式来获取请求的相应 https 端口：

*   [Tomcat：如何在 Java 中获取安全端口号？](https://stackoverflow.com/questions/1233871/tomcat-how-to-get-the-secure-port-number-in-java)
*   [获取 HTTPS 的 JSP 页面的服务器名称和端口号](https://stackoverflow.com/questions/11115128/get-server-name-and-port-number-of-jsp-page-for-https)

**TL; DR：我的问题是，您有什么想法可以为不安全的请求获取相应的 https 端口号，而无需在您的 web 应用程序中明确配置它们？**

我的一个想法是使用与当前请求相同的端口号从 webapp 对自身进行 http 调用到安全约束后面的路径，并从响应中解析重定向位置。当然，响应应该被缓存。有没有更直接的方法？

**编辑：**为该想法添加了代码的[答案。](https://stackoverflow.com/a/12417601/846977)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T03:08:51.060

如果有人想知道如何实现我在问题中提供的想法，这里有一些示例代码我放在一起来测试它。我不认为我会采用这个解决方案。

这适用于问题正文中的安全约束块。

```
private static final String HTTPS_CONSTRAINED_PATH = "/https";

private static ConcurrentHashMap<String, Integer> resolvedHttpsPortMap = new ConcurrentHashMap<String, Integer>();
private static final ReentrantLock portMapLock = new ReentrantLock();

public static int resolveHttpsPort(HttpServletRequest request) {
    if (request.isSecure()) return request.getServerPort();
    String key = request.getServerName() + ":" + request.getServerPort();
    Integer port = resolvedHttpsPortMap.get(key);
    if (port == null) {
        portMapLock.lock();
        try {
            port = resolvedHttpsPortMap.get(key);
            if (port == null) {
                URL url = new URL(request.getScheme(), request.getServerName(), request.getServerPort(), request.getContextPath() + HTTPS_CONSTRAINED_PATH);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                if (conn.getResponseCode() != 301 && conn.getResponseCode() != 302
                        && conn.getResponseCode() != 303 && conn.getResponseCode() != 307) {
                    throw new IllegalStateException("Got unexpected response code " + conn.getResponseCode() + " from URL: " + url);
                }
                String location = conn.getHeaderField("Location");
                if (location == null) {
                    throw new IllegalStateException("Did not get a Location header in the response from URL: " + url);
                }
                URL locationUrl = new URL(location);
                port = locationUrl.getPort();
            }
        } catch (Exception e) {
            logger.warn("Could not determine corresponding HTTPS port for '" + key + "'", e);
        } finally {
            if (port == null) port = -1;
            resolvedHttpsPortMap.put(key, port);
            portMapLock.unlock();
        }
    }
    return port;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T22:12:31.980

我完全不明白为什么您需要知道安全端口号。如果正在访问的资源被标记为需要 SSL，Tomcat 将发送重定向到 https: 和适当的安全端口。这就是 server.xml 中的配置的用途。

# ruby-on-rails - 在 Rails 视图中迭代目录内容

> ID：12412677
> 
> 赞同：0
> 
> 时间：2012-09-13T18:38:59.853
> 
> 标签：ruby-on-rails

我正在尝试将幻灯片嵌入到我正在使用 rails 构建的网站中。这需要我在 rails 视图中创建一个无序列表的图像。重点是：

1）我想要一个目录，并且将目录中的每个图像都包含在幻灯片中 2）我不希望在每个请求中都读取目录内容（此幻灯片将在布局中，并且可见在所有页面中）3）我希望能够将图片放在目录中并通过幻灯片将其拾取

[我想在这个问题](https://stackoverflow.com/questions/5804747/listing-linking-to-contents-of-directory-in-rails)中简单地使用 Dir.glob ，但这违反了要求 2。

然后我想我可以列出站点启动时存在的文件，并将其存储在应用程序控制器中。但这违反了要求 3。或者我可以以某种方式即时更新此列表。

是否有捷径可寻？我是在无缘无故地让我的生活变得困难吗？我的意思是我可以对图像进行硬编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:06:28.353

Maybe you could use a page cache as a solution for requirement 2, but then in step 3 you have to also delete page cache manually, or you may use something like [rb-inotify](https://github.com/nex3/rb-inotify) for automation.

# java - 不知道为什么我得到这个 NullPointerException 应该在这个位置有数据

> ID：12412679
> 
> 赞同：0
> 
> 时间：2012-09-13T18:39:05.773
> 
> 标签：java, android

我的代码中出现 NullPointerException，并且我用几种不同的方式编写了相同的预期结果，但我仍然总是以错误告终。

这是有问题的代码：

```
ArrayList<String> titleOne = new ArrayList<String>(); 
    titleOne.add(getFirstTitle.getFirstJSONTitle(creditOne)); 
```

这是包含有问题的方法的 getFristTitle 类：

```
public class getFirstTitle extends AsyncTask<String, Void, String > {

public static String TAG_CAST = "cast";
public static String TAG_TITLE = "title";

static ArrayList<String> firstCast = null;
static String title = null;
static JSONArray castArray;
String creditURLOne = null;

protected String doInBackground(String... creditOne) {
    // TODO Auto-generated method stub
    creditURLOne = creditOne.toString();

    return getFirstJSONTitle(creditURLOne);

}
final static String getFirstJSONTitle(String creditURLOne){

    Log.d("crediturl in title method contains", creditURLOne);
    JSONParser jParser = new JSONParser();

    JSONObject jSon = jParser.getJSONFromUrl(creditURLOne);

    try{
        castArray = jSon.getJSONArray(TAG_CAST);
        Log.d("castarray in title method contains", castArray.toString());
        for(int i=0; i < castArray.length(); i++){
            JSONObject f = castArray.getJSONObject(i);
            title = f.getString(TAG_TITLE);
            Log.d("title contains", title);
            firstCast.add(title);

            Log.d("firstCast contains", firstCast.toString());
        }

    }
    catch(JSONException e){
        Log.e("Error", e.toString());
        return null;
    }

    return firstCast.toString();

}
} 
```

如您所见，我有一些 Logging 语句，这里是 logcat 的输出：

```
09-13 11:20:17.681: I/Process(837): Sending signal. PID: 837 SIG: 9
09-13 11:30:49.621: W/KeyCharacterMap(865): No keyboard for id 0
09-13 11:30:49.627: W/KeyCharacterMap(865): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
09-13 11:30:57.917: D/searchurlone(865): http://api.themoviedb.org/3/search/person?api_key=bb0b6d66c2899aefb4d0863b0d37dc4e&query=christopher_guest
09-13 11:30:58.027: D/dalvikvm(865): GC_FOR_MALLOC freed 8231 objects / 370392 bytes in 67ms
09-13 11:30:58.187: D/dalvikvm(865): GC_FOR_MALLOC freed 742 objects / 40504 bytes in 43ms
09-13 11:30:58.308: D/JSON Contents(865): {"page":1,"results":[{"adult":false,"id":13524,"name":"Christopher Guest","profile_path":"/fhEQq0q2aR2sh4HU824xunoyAce.jpg"}],"total_pages":1,"total_results":1}
09-13 11:30:58.318: D/JSONArray idOne(865): 13524
09-13 11:30:58.457: D/dalvikvm(865): GC_FOR_MALLOC freed 462 objects / 31288 bytes in 44ms
09-13 11:30:58.578: D/JSON Contents(865): {"page":1,"results":[{"adult":false,"id":26510,"name":"Eugene Levy","profile_path":"/5bs50OKUwLcjrznBnIua9wpLRJ4.jpg"}],"total_pages":1,"total_results":1}
09-13 11:30:58.578: D/creditOne contains(865): http://api.themoviedb.org/3/person/13524/credits?api_key=bb0b6d66c2899aefb4d0863b0d37dc4e
09-13 11:30:58.587: D/crediturl in title method contains(865): http://api.themoviedb.org/3/person/13524/credits?api_key=bb0b6d66c2899aefb4d0863b0d37dc4e
09-13 11:30:58.728: D/dalvikvm(865): GC_FOR_MALLOC freed 1078 objects / 243496 bytes in 44ms
09-13 11:30:58.977: D/JSON Contents(865): {"cast":[{"id":881,"title":"A Few Good Men","character":"Dr. Stone","original_title":"A Few Good Men","poster_path":"/4HNgFBkmfkJEbywBAKQQmEQpo95.jpg","release_date":"1992-12-11","adult":false},{"id":2493,"title":"The Princess Bride","character":"Count Tyrone Rugen","original_title":"The Princess Bride","poster_path":"/7DVvPfYpSNO6xim2Z7vtOu5aqp7.jpg","release_date":"1987-10-01","adult":false},{"id":10773,"title":"Mrs Henderson Presents","character":"Lord Cromer","original_title":"Mrs Henderson Presents","poster_path":"/ua1ZWxGE9tYJnJLQh06xgiCvUjo.jpg","release_date":"2005-09-09","adult":false},{"id":11031,"title":"This Is Spinal Tap","character":"Nigel Tufnel","original_title":"This Is Spinal Tap","poster_path":"/hTb29XWr5jm9itLcgkDaBfNvCpl.jpg","release_date":"1984-09-08","adult":false},{"id":13370,"title":"A Mighty Wind","character":"","original_title":"A Mighty Wind","poster_path":"/xkux7Pa89gi3YQGGKeAEAAA28rD.jpg","release_date":"2003-04-16","adult":false},{"id":13785,"title":"Best In Show","character":"Harlan Pepper","original_title":"Best In Show","poster_path":"/72eH7l8qN1y6EWC2R3BAMq62dEH.jpg","release_date":"2000-09-19","adult":false},{"id":16448,"title":"Waiting For Guffman","character":"Corky St. Clair","original_title":"Waiting For Guffman","poster_path":"/3WTPgKNE5gZVm3zNWvBhbbXYxXr.jpg","release_date":"1996-01-31","adult":false},{"id":18360,"title":"Night at the Museum 2: Battle of the Smithsonian","character":"Ivan the Terrible","original_title":"Night at the Museum 2: Battle of the Smithsonian","poster_path":"/qbU6AxmO69bBwu6Tw8HtcRoltAA.jpg","release_date":"2009-05-22","adult":false},{"id":23082,"title":"The Invention of Lying","character":"Nathan Goldfrappe","original_title":"The Invention of Lying","poster_path":"/x2CsqtcSqGcrkpMIQCUum5JDiHg.jpg","release_date":"2009-09-14","adult":false},{"id":48279,"title":"The Missing Link","character":"No Lobes","original_title":"Le chaînon manquant","poster_path":"/kHzAu0ZLFtiwV0PLV3iEGxtxRIc.jpg","release_date":"1980-05-21","adult":false},{"id":14729,"title":"The Long Riders","character":"Charlie Ford","original_title":"The Long Riders","poster_path":"/kPBOddG81QREMIR8Gir0i7rJ2q5.jpg","release_date":"1980-05-16","adult":false},{"id":83726,"title":"Beyond Therapy","character":"Bob","original_title":"Beyond Therapy","poster_path":"/sfmObsPgtuQOo99b9e59QOQsMe3.jpg","release_date":"1987-02-27","adult":false},{"id":50237,"title":"Shame of the Jungle","character":"Chief M'Bulu / Short / Nurse (voice: English version)","original_title":"Shame of the Jungle","poster_path":"/6eIui4lTo12bt7xPiwomcSqNmuu.jpg","release_date":"1979-09-14","adult":false},{"id":106273,"title":"Lemmings","character":"Various","original_title":"Lemmings","poster_path":"/g09OMzNEzCQLzc2XoLntwMPUsqk.jpg","release_date":null,"adult":false},{"id":73247,"title":"Heartbeeps","character":"Calvin","original_title":"Heartbeeps","poster_path":"/miWjN4ehccUnh0CKR3wG3udKVf0.jpg","release_date":"1981-12-18","adult":false}],"crew":[{"id":11031,"title":"This Is Spinal Tap","original_title":"This Is Spinal Tap","department":"Writing","job":"Author","poster_path":"/hTb29XWr5jm9itLcgkDaBfNvCpl.jpg","release_date":"1984-09-08","adult":false},{"id":11031,"title":"This Is Spinal Tap","original_title":"This Is Spinal Tap","department":"Sound","job":"Original Music Composer","poster_path":"/hTb29XWr5jm9itLcgkDaBfNvCpl.jpg","release_date":"1984-09-08","adult":false},{"id":13370,"title":"A Mighty Wind","original_title":"A Mighty Wind","department":"Directing","job":"Director","poster_path":"/xkux7Pa89gi3YQGGKeAEAAA28rD.jpg","release_date":"2003-04-16","adult":false},{"id":13370,"title":"A Mighty Wind","original_title":"A Mighty Wind","department":"Writing","job":"Writer","poster_path":"/xkux7Pa89gi3YQGGKeAEAAA28rD.jpg","release_date":"2003-04-16","adult":false},{"id":13785,"title":"Best In Show","original_title":"Best In Show","department":"Directing","job":"Director","poster_path":"/72eH7l8qN1y6EWC2R3BAMq62dEH.jpg","release_date":"2000-09-19","adult":false},{"id":13785,"title":"Best
09-13 11:30:59.017: D/castarray in title method contains(865): [{"release_date":"1992-12-11","original_title":"A Few Good Men","id":881,"title":"A Few Good Men","adult":false,"poster_path":"\/4HNgFBkmfkJEbywBAKQQmEQpo95.jpg","character":"Dr. Stone"},{"release_date":"1987-10-01","original_title":"The Princess Bride","id":2493,"title":"The Princess Bride","adult":false,"poster_path":"\/7DVvPfYpSNO6xim2Z7vtOu5aqp7.jpg","character":"Count Tyrone Rugen"},{"release_date":"2005-09-09","original_title":"Mrs Henderson Presents","id":10773,"title":"Mrs Henderson Presents","adult":false,"poster_path":"\/ua1ZWxGE9tYJnJLQh06xgiCvUjo.jpg","character":"Lord Cromer"},{"release_date":"1984-09-08","original_title":"This Is Spinal Tap","id":11031,"title":"This Is Spinal Tap","adult":false,"poster_path":"\/hTb29XWr5jm9itLcgkDaBfNvCpl.jpg","character":"Nigel Tufnel"},{"release_date":"2003-04-16","original_title":"A Mighty Wind","id":13370,"title":"A Mighty Wind","adult":false,"poster_path":"\/xkux7Pa89gi3YQGGKeAEAAA28rD.jpg","character":""},{"release_date":"2000-09-19","original_title":"Best In Show","id":13785,"title":"Best In Show","adult":false,"poster_path":"\/72eH7l8qN1y6EWC2R3BAMq62dEH.jpg","character":"Harlan Pepper"},{"release_date":"1996-01-31","original_title":"Waiting For Guffman","id":16448,"title":"Waiting For Guffman","adult":false,"poster_path":"\/3WTPgKNE5gZVm3zNWvBhbbXYxXr.jpg","character":"Corky St. Clair"},{"release_date":"2009-05-22","original_title":"Night at the Museum 2: Battle of the Smithsonian","id":18360,"title":"Night at the Museum 2: Battle of the Smithsonian","adult":false,"poster_path":"\/qbU6AxmO69bBwu6Tw8HtcRoltAA.jpg","character":"Ivan the Terrible"},{"release_date":"2009-09-14","original_title":"The Invention of Lying","id":23082,"title":"The Invention of Lying","adult":false,"poster_path":"\/x2CsqtcSqGcrkpMIQCUum5JDiHg.jpg","character":"Nathan Goldfrappe"},{"release_date":"1980-05-21","original_title":"Le chaînon manquant","id":48279,"title":"The Missing Link","adult":false,"poster_path":"\/kHzAu0ZLFtiwV0PLV3iEGxtxRIc.jpg","character":"No Lobes"},{"release_date":"1980-05-16","original_title":"The Long Riders","id":14729,"title":"The Long Riders","adult":false,"poster_path":"\/kPBOddG81QREMIR8Gir0i7rJ2q5.jpg","character":"Charlie Ford"},{"release_date":"1987-02-27","original_title":"Beyond Therapy","id":83726,"title":"Beyond Therapy","adult":false,"poster_path":"\/sfmObsPgtuQOo99b9e59QOQsMe3.jpg","character":"Bob"},{"release_date":"1979-09-14","original_title":"Shame of the Jungle","id":50237,"title":"Shame of the Jungle","adult":false,"poster_path":"\/6eIui4lTo12bt7xPiwomcSqNmuu.jpg","character":"Chief M'Bulu \/ Short \/ Nurse (voice: English version)"},{"release_date":null,"original_title":"Lemmings","id":106273,"title":"Lemmings","adult":false,"poster_path":"\/g09OMzNEzCQLzc2XoLntwMPUsqk.jpg","character":"Various"},{"release_date":"1981-12-18","original_title":"Heartbeeps","id":73247,"title":"Heartbeeps","adult":false,"poster_path":"\/miWjN4ehccUnh0CKR3wG3udKVf0.jpg","character":"Calvin"}]
09-13 11:30:59.017: D/title contains(865): A Few Good Men
09-13 11:30:59.027: D/AndroidRuntime(865): Shutting down VM
09-13 11:30:59.027: W/dalvikvm(865): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
09-13 11:30:59.037: E/AndroidRuntime(865): FATAL EXCEPTION: main
09-13 11:30:59.037: E/AndroidRuntime(865): java.lang.IllegalStateException: Could not execute method of the activity
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.view.View$1.onClick(View.java:2072)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.view.View.performClick(View.java:2408)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.view.View$PerformClick.run(View.java:8816)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.os.Handler.handleCallback(Handler.java:587)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.os.Handler.dispatchMessage(Handler.java:92)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.os.Looper.loop(Looper.java:123)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.app.ActivityThread.main(ActivityThread.java:4627)
09-13 11:30:59.037: E/AndroidRuntime(865):  at java.lang.reflect.Method.invokeNative(Native Method)
09-13 11:30:59.037: E/AndroidRuntime(865):  at java.lang.reflect.Method.invoke(Method.java:521)
09-13 11:30:59.037: E/AndroidRuntime(865):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
09-13 11:30:59.037: E/AndroidRuntime(865):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
09-13 11:30:59.037: E/AndroidRuntime(865):  at dalvik.system.NativeStart.main(Native Method)
09-13 11:30:59.037: E/AndroidRuntime(865): Caused by: java.lang.reflect.InvocationTargetException
09-13 11:30:59.037: E/AndroidRuntime(865):  at com.tot.tipofthetongue.Main.displayResults(Main.java:84)
09-13 11:30:59.037: E/AndroidRuntime(865):  at java.lang.reflect.Method.invokeNative(Native Method)
09-13 11:30:59.037: E/AndroidRuntime(865):  at java.lang.reflect.Method.invoke(Method.java:521)
09-13 11:30:59.037: E/AndroidRuntime(865):  at android.view.View$1.onClick(View.java:2067)
09-13 11:30:59.037: E/AndroidRuntime(865):  ... 11 more
09-13 11:30:59.037: E/AndroidRuntime(865): Caused by: java.lang.NullPointerException
09-13 11:30:59.037: E/AndroidRuntime(865):  at com.tot.tipofthetongue.getFirstTitle.getFirstJSONTitle(getFirstTitle.java:48)
09-13 11:30:59.037: E/AndroidRuntime(865):  ... 15 more

My title contains the entry a Few Good Men but it doesn't seem to be looping through and adding the other titles in the array (there are certainly many more) as you can see in the logcat next to castarray in title method contents. I need to loop through that JSON and get all the titles into a new arraylist not sure why it isn't working. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:41:14.883

```
 ArrayList<String> firstCast = null; 
```

你的 firstCast 是`null`，你正在尝试

```
firstCast.add(title); 
```

当您对空引用执行任何操作时，您将获得`NullPointerException`.

改变

```
 ArrayList<String> firstCast = null; 
```

到

```
ArrayList<String> firstCast = new ArrayList<String>(); 
```

# c# - 使用c#将纯文本（标题）导出到excel

> ID：12412680
> 
> 赞同：2
> 
> 时间：2012-09-13T18:39:14.247
> 
> 标签：c#, sql-server-2008, export-to-excel

使用 C#、Visual Studio 2008 和 .NET Framework 3.5。我可以直接从DataGridView导出记录到excel，问题是我需要导出其他数据（纯文本）。

这是我现在的excel：

![没有表头的Excel表格](../Images/0ef45291257d7ee5b496b0fdd7769a9e.png)

这就是我需要显示标题（表格顶部的行）的方式：

![excel 更多信息](../Images/5062dbf536076e50655e25dc162fa597.png)

这就是我现在的做法：

```
protected void btnExcel_Click(object sender, EventArgs e)
{
    Response.Clear();
    Response.AddHeader("content-disposition","attachment;filename=InformeEstudios.xls");
    Response.ContentType = "application/vnd.xls";
    StringWriter sw = new StringWriter();
    HtmlTextWriter htw = new HtmlTextWriter(sw);
    myGridView1.RenderControl(htw);
    Response.Write(sw.ToString());
    Response.End();
}
public override void  VerifyRenderingInServerForm(Control control)
{
     //base.VerifyRenderingInServerForm(control);
}

//MY METHOD
private void BinData()
{
    SqlConnection conex = new SqlConnection("Data Source=xx.xxx.x.xx;Initial   
    Catalog=MYDATABASE;User ID=MYUSER;Password=MYPASS");
    SqlDataAdapter ad = new SqlDataAdapter("select ROW1, ROW2 from MYTABLE", conex);
    DataSet ds = new DataSet();
    ad.Fill(ds);
    myGridView1.DataSource = ds;
    myGridView1.DataBind();
} 
```

我怎样才能做到这一点，**我怎样才能手动编写这两个标题行**。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:50:25.210

control.RenderControl(...) 只是输出html。所以先输出自己的html..然后调用rendercontrol。

# html - 如果未选择下拉菜单，则在提交时不发送 GET 变量

> ID：12412682
> 
> 赞同：0
> 
> 时间：2012-09-13T18:39:23.673
> 
> 标签：html, forms, drop-down-menu, get, submit

我有一个表单，用于过滤仅包含下拉列表的搜索结果。我使用 GET 而不是 post，以便可以轻松地与 URL 共享结果。

```
 <form action="" name='filter' method="GET">
      <select name="Make" id="Make">
          <option selected="selected" value ="nothing">All</option>             
          <option  value="Toyota">Toyota</option>           
          <option value="Honda">Honda</option>
      </select>
      <input type="submit" value="Filter">
    </form> 
```

就像现在一样，如果用户不更改选择，它将为 get 变量 Make 提交值“nothing”。它们是多个下拉列表，与模型年份等的下拉列表相同。

如果不使用 Make 变量，它是否可能不会显示在 URL 中？

现在，如果提交该代码，它将显示 website.com/?Make=nothing。我尝试删除该值，然后显示 website.com/?Make=All。如果选择“全部”，我不希望 make 出现在 URL 中。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:43:59.890

您没有`submit`按钮 :)
您可以添加一个在提交时运行的 JS，并检查它的值，`"Make"`以防它`"nothing"`只是执行简单的重定向而不是提交表单。就像是：

```
var e = document.getElementById("Make");
var val = e.options[e.selectedIndex].value;
if (val === 'nothing'){
  window.location = "http://www.google.com/"
} 
```

# iphone - Xcode中重复声音的问题

> ID：12412687
> 
> 赞同：1
> 
> 时间：2012-09-13T18:39:29.837
> 
> 标签：iphone, objective-c, c, xcode, audio

当一帧撞到另一帧时，它会播放声音，所以我在 do 加载器中使用此代码，以便加载声音

我使用框架

`#import <AVFoundation/AVFoundation.h>`

`- (void)viewDidLoad`

```
 NSString *path1 = [[NSBundle mainBundle] pathForResource:@"ballbounce" ofType:@"mp3"];
theaudio1 = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path1] error: NULL]; 
```

然后用它来播放声音

```
[audio1 play]; 
```

但有时声音不播放，声音片段只有 0.7 秒长，只是发出简单的噪音。

像

```
enemy.center = CGPointMake(enemy.center.x+pos.x,enemy.center.y+pos.y);

    if (enemy.center.x > 308 || enemy.center.x < 10)

    {
        [theaudio1 play];
        pos.x = -pos.x;

    }
    if (enemy.center.y > 400 || enemy.center.y < 100)
    {
        [theaudio1 play];
        pos.y = -pos.y ;
    } 
```

声音有时会快速连续播放，有时声音不播放是否有更好的方法可以编写此代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T10:31:46.760

在调用之前调用实例上的`prepareToPlay`方法。它预加载音频播放器的缓冲区。`AVAudioPlayer``play`

另外，如果可以的话，初始化你的播放器从记忆中播放，因为它只是一个很短的声音。请参阅类文档`initWithData:error`中的方法描述。`AVAudioPlayer`

# java - Hibernate：如果引用不存在则保存

> ID：12412689
> 
> 赞同：0
> 
> 时间：2012-09-13T18:39:37.607
> 
> 标签：java, hibernate, merge

我有以下课程：

```
@Entity
public class ClassA {
  @Column
  @Id
  private Long id;
  @ManyToOne(cascade = javax.persistence.CascadeType.ALL)
  @JoinColumn...
  private ClassB classB;
  public ClassA(ClassB classB){
    this.classB = classB;
  }
  //....
  //....
}

@Entity
public class ClassB {
  @Column
  @Id
  private Long id;

  @Column(unique=true) //important
  private String name;
  public ClassB(String name){
    this.name = name;
  }
  //....
  //....
} 
```

我想保存`ClassA`并`ClassB`仅在`ClassB`尚不存在时保存。

```
ClassB b = new ClassB("myName");
ClassA a = new ClassA(b);
session.merge(a); // fine
ClassA a2 = new ClassA(b);
session.merge(a2); // problem with b 
```

当然，我可以检查`ClassB`它是否存在并加载它，但我想提高效率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:24:55.070

如果 classB 存在并且 classB 被管理，则 getEntityManager.contains(b) 返回 true。

```
ClassB b = new ClassB("myName");

    if(getEntityManager.contains(b)){
   ClassA a = new ClassA(b)
    session.merge(a);
    }
   else{
    session.merge(b);
    ClassA a = new ClassA(b)
    session.merge(b);
     } 
```

# c++ - Boost函数组成

> ID：12412692
> 
> 赞同：1
> 
> 时间：2012-09-13T18:39:55.210
> 
> 标签：c++, boost, boost-function, function-composition

假设我想要一个函数`double adapter(double)`，有没有一种通用的方法可以用 a 组合它`boost::function<double(...)> functor`来产生另一个`boost::function<double(...)> functor2`where `functor2(...) == adapter(functor(...))`？特别是，如果有一种方法可以在不使用 C++11 的情况下做到这一点，那就太酷了。

**编辑**澄清一下，我很想知道是否有办法编写可以处理 any 的东西`boost::function<double(...)>`，即具有不同长度签名的东西，而不必为 1、2、3 等参数多次复制和粘贴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:05:37.900

如果没有 c++11，就会有大量的复杂性，包括可变参数和转发。

使用 C++11，它可以完成，主要是通过专门化`std::is_bind_expression`. 在绑定中使用此函数对象时，它会调用与在调用绑定函数对象期间提供的所有参数一起存储的函数对象。请注意，这适用于任何函数对象，而不仅仅是`std::function`.

这适用于 GCC 4.7。

```
#include <functional>
#include <utility>
#include <type_traits>

namespace detail
{
template<typename Func>
struct compose_functor
{

   Func f;

   explicit compose_functor(const Func& f) : f(f) {};

   template<typename... Args>
   auto operator()(Args&&... args) const -> decltype(f(std::forward<Args>(args)...))
   {
    return f(std::forward<Args>(args)...);
   }

};

}

template<typename Func>
 detail::compose_functor
<Func> compose(Func f)
{
   return detail::compose_functor<Func>(f);
}

namespace std
{
   template<typename T>
   struct is_bind_expression< detail::compose_functor<T> > : true_type {};
}
#include <numeric>

int adapter(double d)
{
    return (int)d;
}

int main()
{
    std::function<int(double)> f1 = std::bind(adapter, compose(std::negate<double>()));
    std::function<int(double, double)> f2 = std::bind(adapter, compose(std::plus<double>()));

    // 1.5 -> -1.5 -> -1
    std::cout << f1(1.5) << std::endl;
    // 2.3+4.5 = 6.8 -> 6
    std::cout << f2(2.3, 4.5) << std::endl;
} 
```

# asp.net-mvc - MVC3 自定义模板 t4 和 DataAnnotations

> ID：12412697
> 
> 赞同：2
> 
> 时间：2012-09-13T18:40:09.917
> 
> 标签：asp.net-mvc, templates, data-annotations, t4, scaffolding

这是我的带有 DataAnnotations 的模型

```
[DisplayName("Title1"),Display(Name="Title2")]
public class MyClass
{
  [Display(Name = "My Class Name")]
  public string class_name { get; set; }
} 
```

我想知道如何在我的 T4 模板 Index.cs.t4 中访问 MyClass 类的这些 DataAnnotations（即 DisplayName 属性）

```
<# } #>
@{
  ViewBag.Title = "<#= viewDataType.Name   #>";
  <# if (!String.IsNullOrEmpty(Model.Layout)) { #>
  Layout = "<#= Model.Layout #>";
<# } #>
} 
```

而是放置 viewDataType.Name 我想拥有 MyClass 类的 DisplayName 属性的值

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T13:24:35.583

[MVC 脚手架](http://mvcscaffolding.codeplex.com/)模板使用不同于标准 ASP.NET MVC 模板工作方式的 Visual Studio 对象模型。Model.ViewDataType 是 Visual Studio [EnvDTE.CodeType](http://msdn.microsoft.com/en-us/library/envdte.codetype%28v=vs.100%29.aspx)类而不是[Type](http://msdn.microsoft.com/en-us/library/system.type%28v=vs.100%29.aspx)类。EnvDTE.CodeType 具有可用于获取显示名称的 attributes 属性。

下面是一些示例代码，可用于从 CodeType 获取显示名称。您可以将此代码放在自定义 T4 模板 (Index.cs.t4) 的末尾。

```
<#+
string GetDisplayName(EnvDTE.CodeType type) {
    if (type != null) {
        foreach (var attribute in type.Attributes.OfType<EnvDTE.CodeAttribute>()) {
            if (attribute.Name == "DisplayName") {
                return attribute.Value;
            }
        }
    }
    return "";
}
#> 
```

然后在您的自定义 T4 模板中，您可以将**viewDataType.Name替换为对****GetDisplayName()**的调用。我还删除了“ **<#= viewDataType.Name #> ”周围的引号，因为 T4 模板会围绕从****<#= GetDisplayName(viewDataType) #>**返回的结果生成引号。

```
<# var viewDataType = (EnvDTE.CodeType) Model.ViewDataType; #>
<# if(viewDataType != null) { #>
@model IEnumerable<<#= viewDataType.FullName #>>
<# } #>
@{
    ViewBag.Title = <#= GetDisplayName(viewDataType) #>;
<# if (!String.IsNullOrEmpty(Model.Layout)) { #>
    Layout = "<#= Model.Layout #>";
<# } #>
} 
```

如果您随后删除您的 Index.cshtml 视图并使用脚手架重新创建它，您应该会在 ViewBag.Title 中设置显示名称。

```
@{
    ViewBag.Title = "Title1";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T14:44:45.290

**更新**

我完全删除了我的答案和回答，让您参考准确回答您问题的帖子*（并且答案被接受为适用于两者）*：

*   [如何从代码中访问 DisplayName 数据注释值？](https://stackoverflow.com/questions/3485737/how-can-i-access-the-displayname-data-annotation-value-from-code)
*   [如何访问字段的 System.ComponentModel.DataAnnotations 显示名称属性](https://stackoverflow.com/questions/9293258/how-to-access-the-system-componentmodel-dataannotations-display-name-property-fo?lq=1) 希望这会有所帮助。

# php - 偏移量 37 处的非法字符“X”

> ID：12412699
> 
> 赞同：0
> 
> 时间：2012-09-13T18:40:11.740
> 
> 标签：php, xml, curl, illegal-characters

我正在使用带有 cURL 的 xml 来联系加拿大邮政并获取运输标签。

这是我使用的代码。

**平台是ExpressionEngine**

```
<?php
 /**
 * Sample code for the CreateShipment Canada Post service.
 * 
 * The CreateShipment service is used to create a new shipping item, to 
 * request the generation of a softcopy image of shipping labels, and to provide 
 * links to these shipping labels and other information associated with the 
 * shipping item.. 
 *
 * This sample is configured to access the Developer Program sandbox environment. 
 * Use your development key username and password for the web service credentials.
 * 
 **/

// Your username, password and customer number are imported from the following file     
// CPCWS_Shipping_PHP_Samples\REST\shipping\user.ini
$userProperties = parse_ini_file(realpath(dirname($_SERVER['SCRIPT_FILENAME'])) . '/../user.ini');

$username = $userProperties['username']; 
$password = $userProperties['password'];
$mailedBy = $userProperties['customerNumber'];
$mobo = $userProperties['customerNumber'];

// REST URL
$service_url = 'https://ct.soa-gw.canadapost.ca/rs/' . $mailedBy . '/' . $mobo . '/shipment';

// Create CreateShipment request xml
$groupId = '4326432';
$requestedShippingPoint = 'H2B1A0';
$mailingDate = '2012-10-24';
$contractId = '0040662521';

$xmlRequest = <<<XML
<?xml version="1.0" encoding="UTF-8"?>
<shipment xmlns="http://www.canadapost.ca/ws/shipment">
    <group-id>{$groupId}</group-id>
    <requested-shipping-point>{$requestedShippingPoint}</requested-shipping-point>
    <expected-mailing-date>{$mailingDate}</expected-mailing-date>
    <delivery-spec>
        <service-code>DOM.EP</service-code>
            <sender>
                <name>Bulma</name>
                <company>Capsule Corp.</company>
                <contact-phone>1 (514) 820 5879</contact-phone>
                <address-details>
                    <address-line-1>502 MAIN ST N</address-line-1>
                    <city>MONTREAL</city>
                    <prov-state>QC</prov-state>
                    <country-code>CA</country-code>
                    <postal-zip-code>H2B1A0</postal-zip-code>
                </address-details>
            </sender>
            <destination>
                <name>Ryuko Saito</name>
                <company>Kubere</company>
                <address-details>
                    <address-line-1>23 jardin private</address-line-1>
                    <city>Ottawa</city>
                    <prov-state>ON</prov-state>
                    <country-code>CA</country-code>
                    <postal-zip-code>K1K4T3</postal-zip-code>
                </address-details>
            </destination>
        <options>
            <option>
                <option-code>DC</option-code>
            </option>
        </options>
        <parcel-characteristics>
            <weight>15</weight>
            <dimensions>
                <length>6</length>
                <width>12</width>
                <height>9</height>
            </dimensions>
            <unpackaged>true</unpackaged>
            <mailing-tube>false</mailing-tube>
        </parcel-characteristics>
        <notification>
            <email>ryuko.saito@kubere.com</email>
            <on-shipment>true</on-shipment>
            <on-exception>false</on-exception>
            <on-delivery>true</on-delivery>
        </notification>
        <print-preferences>
            <output-format>8.5x11</output-format>
        </print-preferences>
        <preferences>
            <show-packing-instructions>true</show-packing-instructions>
            <show-postage-rate>false</show-postage-rate>
            <show-insured-value>true</show-insured-value>
        </preferences>
        <settlement-info>
            <contract-id>{$contractId}</contract-id>
            <intended-method-of-payment>Account</intended-method-of-payment>
        </settlement-info>
    </delivery-spec>
</shipment>
XML;

$curl = curl_init($service_url); // Create REST Request
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, true);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($curl, CURLOPT_CAINFO, realpath(dirname($argv[0])) . '/../../../third-party/cert/cacert.pem'); // Signer Certificate in PEM format
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $xmlRequest);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($curl, CURLOPT_USERPWD, $username . ':' . $password);
curl_setopt($curl, CURLOPT_HTTPHEADER, array('Content-Type: application/vnd.cpc.shipment-v2+xml', 'Accept: application/vnd.cpc.shipment-v2+xml'));
$curl_response = curl_exec($curl); // Execute REST Request
if(curl_errno($curl)){
    echo 'Curl error: ' . curl_error($curl) . "\n";
}

echo 'HTTP Response Status: ' . curl_getinfo($curl,CURLINFO_HTTP_CODE) . "\n";

curl_close($curl);

// Example of using SimpleXML to parse xml response
libxml_use_internal_errors(true);
$xml = simplexml_load_string('<root>' . preg_replace('/<\?xml.*\?>/','',$curl_response) . '</root>');
if (!$xml) {
    echo 'Failed loading XML' . "\n";
    echo $curl_response . "\n";
    foreach(libxml_get_errors() as $error) {
        echo "\t" . $error->message;
    }
} else {
    if ($xml->{'shipment-info'} ) {
        $shipment = $xml->{'shipment-info'}->children('http://www.canadapost.ca/ws/shipment');
        if ( $shipment->{'shipment-id'} ) {
            echo  'Shipment Id: ' . $shipment->{'shipment-id'} . "\n";                 
            foreach ( $shipment->{'links'}->{'link'} as $link ) {  
                echo $link->attributes()->{'rel'} . ': ' . $link->attributes()->{'href'} . "\n";
            }
        }
    }
    if ($xml->{'messages'} ) {                  
        $messages = $xml->{'messages'}->children('http://www.canadapost.ca/ws/messages');       
        foreach ( $messages as $message ) {
            echo 'Error Code: ' . $message->code . "\n";
            echo 'Error Msg: ' . $message->description . "\n\n";
        }
    }
}

?> 
```

**我在下面收到错误**

HTTP 响应状态：500 错误代码：服务器错误消息：/rs/0000000000/0000000000/shipment 偏移量 37 处的非法字符“X”

（我将客户编号更改为“0000000000”）

有人可以解释上述消息的含义吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:24:49.313

提供者可能（像*所有*“企业”提供者一样）没有使用适当的 XML 解析器。尝试在 PI 的结束字符之前放置一个空格，否则完全删除 PI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:31:35.410

37 个字符将您放在 XML Prolog 的末尾

```
<?xml version="1.0" encoding="UTF-8"?> 
```

主机不处理此问题，或者您可能遇到 DOS/UNIX 行尾问题。

首先，尝试删除 XML Prolog，看看是否有帮助。

如果这没有帮助，那么（取决于您的编辑器）将 PHP 源代码另存为 UNIX 文件，以使行尾标记正确。如果这不起作用，请尝试将其保存为 DOS 文件。

# python - 使用 gevent 访问外部 http 服务时出现间歇性问题

> ID：12412701
> 
> 赞同：8
> 
> 时间：2012-09-13T18:40:17.190
> 
> 标签：python, exception, gevent, gunicorn, python-requests

首先，版本：

*   gevent - v0.13.7
*   gunicorn - v0.14.2
*   请求 - 0.11.2

我们最近升级了在 gunicorn 后面运行的服务器，以使用 gevent 异步工作人员，而不仅仅是普通的同步工作人员。一切都很好，但是我们现在在尝试通过 http 访问 3rd 方服务时遇到了一个问题，我只是不知道如何追踪可能是什么问题。

简短的堆栈跟踪如下所示：

```
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/requests/sessions.py", line 295, in post
  return self.request('post', url, data=data, **kwargs)
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/requests/sessions.py", line 252, in request
  r.send(prefetch=prefetch)
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/requests/models.py", line 625, in send
  raise ConnectionError(sockerr)
ConnectionError: [Errno 66] unknown 
```

另一个不同的堆栈跟踪，但我们认为这是同一个问题：

```
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/requests/packages/urllib3/connectionpool.py", line 94, in connect
  sock = socket.create_connection((self.host, self.port), self.timeout)
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/gevent/socket.py", line 637, in create_connection
  for res in getaddrinfo(host, port, 0, SOCK_STREAM):
File "/home/deploy/.virtualenvs/bapp/lib/python2.7/site-packages/gevent/socket.py", line 769, in getaddrinfo
  raise
DNSError: [Errno 66] unknown 
```

起初，我认为这可能与`libevent-dns`这个[google groups issue](https://groups.google.com/forum/?fromgroups=#!topic/gevent/eC0hj3LJ7_E)相关。我检查了我们的`/etc/resolv.conf`，只有一个 dns 解析服务：

```
[me@host:~]$ cat /etc/resolv.conf
; generated by /sbin/dhclient-script
nameserver 10.3.0.2 
```

我查了一下ERRNO66是什么：[https](https://github.com/libevent/libevent/blob/master/include/event2/dns.h#L162) ://github.com/libevent/libevent/blob/master/include/event2/dns.h#L162 ,"/**发生未知错误*/"。我没有太多运气找到有用的东西..听起来它无法与 dns 服务器对话？

我认为它可能与`python-requests`，看看[如何启用请求异步模式？](https://stackoverflow.com/questions/9501663/how-enable-requests-async-mode)因为`python-requests`取决于`urllib3`，它是根据`httplib`; 但是，事实证明，作者在今年早些时候`gevent`删除了[此](https://bitbucket.org/denis/gevent/changeset/d50a522a264bf28b6facb809731d3b41c5a49f51#chg-gevent/monkey.py)`httplib`提交中的补丁，而没有对原因发表任何评论。

是否有人对如何调试此问题有任何想法，或者可能对这里发生的事情有所了解？

提前致谢！

# 更新 - 太平洋夏令时间下午 12:50

在 freenode 上进行了一些对话之后，#gevent 和 #gunicorn 频道似乎有了更多的见解：

### #gevent

*   gevent v0.13.7 仍然支持`patch_all`with`httplib=True`
*   我问“修补它是否有意义？”，回答是否定的。
*   建议使用 gevent 1.0（即使它是 beta 版）。
*   来自@schmir 的引用：

    > “patch httplib 使用 libevent http 客户端库。我不信任 libevent。如果您使用它，我的建议是关闭它”

### #独角兽

*   `<Damianz>`你的平台是什么？我已经看到这个问题出现在它尝试 ipv6 并且只是失败的 Windows 盒子上。（我在 CentOS 5 上）
*   `<dmishe>`我在mac上看到过类似的，看起来gevent beta修复了它

听起来一般建议是放弃 gevent v0.13.7 并升级到 gevent 1.0b。

如果能解决这个问题，我会跟进。同时，任何可以提供建议的人，我都会非常感激。

# 更新 #2 - 生产 4 天，太平洋夏令时间下午 1:15

看起来升级到`gevent`已经解决了这个问题——如果没有其他人插话，我会添加我的答案并接受它，但只有在生产中没有发生任何事件的一周之后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T07:39:36.007

升级到 gevent 1.0b 已经消除了这个问题。

# php - jQuery Autocomplete 在字段中输入错误的值

> ID：12412702
> 
> 赞同：0
> 
> 时间：2012-09-13T18:40:21.007
> 
> 标签：php, jquery, jquery-ui, autocomplete, jquery-autocomplete

好的，所以我正在使用 jQuery 自动完成功能来处理我在美国的位置和州的数据库，目标是用户开始输入城市、城镇等，然后我显示城市（我的数据库中的位置）、州（我的地区） DB）邮编（我的数据库中的邮政编码）给他们，当他们选择一个时，它会填写城市州和邮政编码字段。我的问题是，当我选择一个选项时，州和邮政编码正确填写，但是城市字段需要邮政编码的价值，我想不出来。。这是我的 JS 代码，后面是单独的 PHP 文件，用于提取我的数据库数据。我在 PHP 方面比 JS 更有经验，但你永远不知道你在哪里会犯错...

JS/jQuery 文件：

```
$(document).ready(function(){
var ac_config = {
    source: "autocomplete-l.php",
    select: function(event, ui){
        $("#scity").val(ui.item.location);
                    $("#sstate").val(ui.item.region);
        $("#szip").val(ui.item.postalCode);
    },
    minLength:1
};
$("#scity").autocomplete(ac_config);
}); 
```

和 PHP 文件：

```
$cities = array();
$sth = $dbh->prepare("SELECT * FROM locations WHERE country = 'US'");
$sth->execute();

while($row = $sth->fetch(PDO::FETCH_ASSOC)) {
$cities[]=$row;
}

$term = trim(strip_tags($_GET['term']));

$matches = array();
foreach($cities as $city){
if((stripos($city['location'], $term) !== false)){
    // Add the necessary "value" and "label" fields and append to result set
    $city['value'] = $city['location'];
    $city['value'] = $city['region'];
    $city['value'] = $city['postalCode'];
    $city['label'] = "{$city['location']}, {$city['region']}{$city['postalCode']}";
    $matches[] = $city;
    }
}

$matches = array_slice($matches, 0, 100);
print json_encode($matches); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:18:50.323

`event.preventDefault();`在选择函数内部调用。

否则，自动完成将继续执行默认操作：

*用户从菜单中选择某些内容后，该**值**将插入到**输入元素中***

输入元素是`$("#scity")`

```
$("#scity").autocomplete(ac_config); 
```

值是邮政编码：

```
$city['value'] = $city['postalCode']; 
```

请注意以下几行：

```
$city['value'] = $city['location'];
$city['value'] = $city['region'];
$city['value'] = $city['postalCode']; 
```

...你覆盖`$city['value']`

你只能使用这个：

```
$city['value'] = $city['location']; 
```

并从选择功能中删除该行：

```
$("#scity").val(ui.item.location); 
```

（因为 $.autocomplete 会 `$("#scity")` 自动设置值）

# python - 将参数传递给 apscheduler 处理函数

> ID：12412708
> 
> 赞同：31
> 
> 时间：2012-09-13T18:40:53.487
> 
> 标签：python

我正在使用 apscheduler 并尝试将参数传递给在启动计划作业时调用的处理程序函数：

```
from apscheduler.scheduler import Scheduler
import time

def printit(sometext):
    print "this happens every 5 seconds"
    print sometext

sched = Scheduler()
sched.start()

sometext = "this is a passed message"
sched.add_cron_job(printit(sometext), second="*/5")

while True:
    time.sleep(1) 
```

这样做会给我以下错误：

```
TypeError: func must be callable 
```

是否可以将参数传递给函数处理程序。如果没有，是否有任何替代方案？基本上，我需要每个计划的作业返回一个我在创建计划时传入的字符串。谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-13T18:42:29.423

`printit(sometext)`不是可调用的，它是调用的结果。

您可以使用：

```
lambda: printit(sometext) 
```

这是一个稍后调用的可调用对象，它可能会执行您想要的操作。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-08-18T21:28:11.457

由于这是我遇到相同问题时发现的第一个结果，因此我添加了一个更新的答案：

根据当前 apscheduler (v3.3.0) 的[文档](http://apscheduler.readthedocs.io/en/latest/modules/schedulers/base.html#apscheduler.schedulers.base.BaseScheduler.add_job)，您可以在函数中传递函数参数`add_job()`。

因此，在 OP 的情况下，它将是：

```
sched.add_job(printit, "cron", [sometext], second="*/5") 
```

# java - 在 jar 中引用/包含 xsd 文件

> ID：12412709
> 
> 赞同：5
> 
> 时间：2012-09-13T18:40:57.387
> 
> 标签：java, xsd, maven-jaxb2-plugin

我想向我们的项目添加一个 xsd 文件，该文件依赖于 jar 中另一个 xsd 中定义的类型。我们使用 jaxb 从 xsds 生成 Java 类。我如何参考 SchemaContainingFooTypeIsInaJAR.xsd 以便正确解析“FooType”并生成正确的 Java 类

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:include schemaLocation="SchemaContainingFooTypeIsInaJAR.xsd"/>
<xs:complexType name="FooMoreType">
    <xs:complexContent>
        <xs:extension base="FooType">
            <xs:sequence>
                <xs:element name="something" type="xs:boolean" minOccurs="0">
                    <xs:annotation>
                        <xs:documentation xml:lang="en">
                            something something
                        </xs:documentation>
                    </xs:annotation>
                </xs:element>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
</xs:schema> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T21:27:59.733

您可能对这些功能感兴趣：

*   [http://confluence.highsource.org/display/MJIIP/User+Guide#UserGuide-CompilingaschemafromaMavenartifact](http://confluence.highsource.org/display/MJIIP/User+Guide#UserGuide-CompilingaschemafromaMavenartifact)
*   [http://confluence.highsource.org/display/MJIIP/User+Guide#UserGuide-Usingcatalogs](http://confluence.highsource.org/display/MJIIP/User+Guide#UserGuide-Usingcatalogs)

简而言之，您可以编写一个目录文件，该文件将指向 JAR 文件中的模式：

```
REWRITE_SYSTEM "some/url/a.xsd" "maven:org.jvnet.jaxb2.maven2:maven-jaxb2-plugin-tests-episodes-a!/a.xsd" 
```

免责声明：我是 maven-jaxb2-plugin 的主要开发人员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:47:43.227

请参阅[XML Schema 参考](https://stackoverflow.com/questions/3979053/xml-schema-reference)和[JAXB SchemaFactory 源顺序必须遵循模式之间的导入顺序？](https://stackoverflow.com/questions/3558333/jaxb-schemafactory-source-order-must-follow-import-order-between-schemas/3558845#3558845)

共识似乎是：您需要提供自己的解析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-18T22:02:30.783

替换你的行：

`<xs:include schemaLocation="SchemaContainingFooTypeIsInaJAR.xsd"/>`

和

`<xs:include schemaLocation="jar:file:///path/to/jar/thing.jar!/path/inside/jar/to/file.xsd"/>`

# c - c 赋值运算符 =

> ID：12412712
> 
> 赞同：0
> 
> 时间：2012-09-13T18:41:17.710
> 
> 标签：c

任何人都可以请。解释下面的 c 程序是如何工作的：特别是函数 'fun' 是如何分配给的`(*p)() = fun`；我需要知道编译器是如何编译这段代码的。

```
#include<stdio.h>
int fun(); /* function prototype */

int main()
{
    int (*p)() = fun;
    (*p)();
    return 0;
}
int fun()
{
    printf("Hello World\n");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:49:18.513

每个函数都存在于内存中的某个地方。该声明：

```
int (*p)() = fun; 
```

将函数 fun 的内存位置分配给 p。然后是一行：

```
(*p)(); 
```

正在调用存在于 p 指向的内存位置的函数。

互联网上到处都是关于“函数指针”的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:46:14.293

如果您查看由`gcc`(with `-O0`) 生成的代码：

```
 movl    $_fun, -4(%ebp)
    movl    -4(%ebp), %eax
    call    *%eax 
```

它将`fun`函数的地址存储在堆栈中的一个变量中，然后简单地间接调用该地址。

# matlab - 在 MATLAB 中扫描图像以查找矩阵中的特定点

> ID：12412717
> 
> 赞同：1
> 
> 时间：2012-09-13T18:41:35.787
> 
> 标签：matlab, image-processing

我有一张尺寸为 480（高）乘 640（宽）的图像。我还有一个大小为 [1 x 280] 的矩阵。这 280 个值是可以在图像中找到的点。

我想找出可以在图像的特定部分中找到的矩阵中的哪些点。我做了一个嵌套`for`循环来指定我要扫描的位置以搜索点，但是我在“扫描”时遇到了麻烦。

```
% matrixC = [435 560 424 132 453 ........ 596] for example of size 280
for height = 1:480
    for width = 635:640
    W = C(max);
    end
end 
```

这仅将 W 显示为 C 的最大值，但我只需要在 1 到 480 之间的高度和 635 到 640 的宽度之间显示 C 的最大值。如何编写代码以仅扫描我感兴趣的特定部分，如果在该部分中找到 10 个数字，我该如何选择它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:50:30.853

您可以在图像矩阵中使用[ismember](http://www.mathworks.com/help/matlab/ref/ismember.html)和直接索引来获取“is”或“is-not”值的二进制矩阵。

```
imageC = randi(256, 480, 640); % random image
vectorW = randi(256, 1, 280);  % random vector of points 

imagePart = imageC(1:480, 635:640); % select section by indexing
imageMember = ismember(imagePart, vectorW);  % check membership 
```

**更新**（更改`vectorW`为，添加对 3 通道图像的处理，以及实际点值返回）：您可以通过替换前两行将 `C`自己的图像`imageC`和矢量应用于以下内容。`C`

```
imageC = randi(256, 480, 640, 3); % (random) image [480 x 640 x 3]
C = randi(256, 1, 280);  % (random) vector of points [1 x 280]

imagePart = imageC(1:480, 635:640, :); % select section by indexing [480 x 6 x 3]
imageMember = ismember(imagePart, C);  % check membership [480 x 6 x 3] 
pointsInImage = unique(imagePart(imageMember)); % unique set of points from C found in imagePart 
```

# java - 如何将 1000000 格式化为 1,000,000 等

> ID：12412718
> 
> 赞同：3
> 
> 时间：2012-09-13T18:41:35.443
> 
> 标签：java

如何在 Java 中将数值转换为包含点或逗号？我尝试在网上搜索，但没有找到好的答案。有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:44:10.860

该类`java.text.NumberFormat`将使用适合您的语言环境的分隔符来执行此操作。例子：

```
import java.text.NumberFormat;

System.out.println(NumberFormat.getInstance().format(1000000));

==>1,000,000 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T18:43:14.360

有一个名为的类`NumberFormat`将处理以某种格式打印数字，并将`String`表示数字的数字解析为实际的`Number`.

`DecimalFormat`是 的具体子类`NumberFormat`，您可以使用`DecimalFormat`逗号作为分组分隔符来格式化数字：

```
NumberFormat myFormat = new DecimalFormat("#,###"); 
```

您还可以`DecimalFormat`用于货币格式。

同样，`DateFormat`处理解析和打印日期。

javadocs 在这里：[`NumberFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/NumberFormat.html), [`DecimalFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html).

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-13T18:43:11.270

看看[NumberFormat](http://docs.oracle.com/javase/7/docs/api/java/text/NumberFormat.html)和[DecimalFormat](http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html)。

```
new DecimalFormat("#,###,###").format(1000000); 
```

# objective-c - 横向模式下 UIActionSheet 上的 UIPickerView 显示为黑屏

> ID：12412721
> 
> 赞同：1
> 
> 时间：2012-09-13T18:41:51.137
> 
> 标签：objective-c, ios, uipickerview, landscape, uiactionsheet

我有一个应用程序，我通过 UIActionSheet 更新表格行。在工作表上，我展示了一个 UIPickerView。UIPickerView 在 iphone 上可以正常工作并且在纵向上看起来很棒。但是当我在横向模式下打开它时，它仍然有效，但轮廓区域显示为黑色，未选中的数字也是黑色的。

下面是截图和代码。有什么明显的错误吗？

![在此处输入图像描述](../Images/2eed4b5018a615ed009cb51da5a3113d.png)

```
// create enough space for the UIPicker to show up above the selection button
NSString *title = @"\n\n\n\n\n\n\n\n\n\n\n\n";

if ((UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation)) &&
    (UI_USER_INTERFACE_IDIOM() != UIUserInterfaceIdiomPad)) {
    title = @"\n\n\n\n\n\n\n\n\n";
}

UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:title delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:NSLocalizedString(@"Choose", @"Click to finilize Value - Timer"), nil];
[actionSheet showInView:viewController.view];

UIDatePicker *pickerView = [[UIDatePicker alloc] init];
[pickerView setDatePickerMode: UIDatePickerModeCountDownTimer];
if (timerInterval == 0) timerInterval = 5;
[pickerView setMinuteInterval: timerInterval];
[pickerView setCountDownDuration: [timerRec.timerDuration intValue]];

pickerView.tag = 101;

if ((UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation)) &&
    (UI_USER_INTERFACE_IDIOM() != UIUserInterfaceIdiomPad)) {
    pickerView.frame = CGRectMake(0,0, 50,50);
}

//pickerView.delegate = self;
//pickerView.dataSource = self;
//ickerView.showsSelectionIndicator = YES;

[actionSheet addSubview:pickerView]; 
```

# ios - 绘制一个角度并用渐变颜色填充它

> ID：12412724
> 
> 赞同：1
> 
> 时间：2012-09-13T18:41:58.687
> 
> 标签：ios, core-graphics, quartz-2d, drawrect, radial-gradients

我正在制作一个自定义控件，直到我的客户说“我想要渐变”之前它都很好。所以我在这里。我需要画一个角度并用渐变色填充它。我之前的代码是这样的：

```
- (void)drawRect:(CGRect)rect{
CGContextBeginPath(context);
CGContextMoveToPoint(context, self.center.x, self.center.y);
CGContextAddArc(context, self.center.x, self.center.y, radius, radians(180), radians(minValue - 180), 0);
CGContextClosePath(context);
CGContextSetFillColorWithColor(context, gray);
CGContextFillPath(context);
} 
```

使用 CGContextAddArc() 函数，我可以绘制我的角度并使用 CGContextSetFillColorWithColor() 函数绘制它，然后关闭路径并*瞧瞧*。但现在我需要用渐变来绘制。我知道也许我应该使用 CGContextDrawRadialGradient，但不知道如何将它与弧一起使用。我已经尝试通过 StackOVerFlow 中的其他问题和阅读文档来解决这个问题，但我就是无法理解。

# mysql - mysql - 查询以找出我没有的？

> ID：12412726
> 
> 赞同：1
> 
> 时间：2012-09-13T18:42:05.513
> 
> 标签：mysql, sql

好的，我有一张桌子，我有一个包含数千条记录的 Id 列......我还有另一个像这样的逗号分隔的 Id 列表

```
1, 2, 457, 558, 998 
```

我想检查这个 people 表，看看 5 条记录中的哪条不存在......

我试过

```
select id from people where id not in (1, 2, 457, 558, 998) 
```

但这会返回所有其他一千条记录，而不仅仅是这 5 条中未找到的记录

任何想法我错过了什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:45:26.410

```
select a.id
from (
    select 1 as id
    union all
    select 2
    union all
    select 457
    union all
    select 558
    union all
    select 998
) a 
left outer join people p on a.id = p.id
where p.id is null 
```

如果您要检查的值在表中，您可以这样做：

```
select c.id
from MyCheckValues c
left outer join people p on c.id = p.id
where p.id is null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:45:47.677

也许是这样的：

```
Select id from people where id in (1, 2, 457, 558, 998)
and id not in ( select id from people ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:48:47.863

```
SELECT id FROM people WHERE id IN (1, 2, 457, 558, 998) 
```

如果您有多个“id”，则使用：

```
SELECT DISTINCT(id) FROM people WHERE id IN (1, 2, 457, 558, 998) 
```

# android - 安卓开发

> ID：12412727
> 
> 赞同：0
> 
> 时间：2012-09-13T18:42:10.130
> 
> 标签：android, eclipse, android-mapview

我是 android 开发的新手，正在尝试制作一个 android 应用程序，以便在 3 天内提交。我指的是[这个](https://developers.google.com/maps/documentation/android/hello-mapview)目的，但是当我在步骤 6 中找不到所谓的 HelloGoogleMaps.java 时陷入了死胡同。我发现的只是 Main Activity.java 有人可以从这里指导我吗，因为我没有太多时间并且不理解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:45:53.740

您需要使用您希望定位/构建的 API 级别的 Google API 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T20:41:06.400

沙贡

看看这个

[http://mobiforge.com/developing/story/using-google-maps-android](http://mobiforge.com/developing/story/using-google-maps-android)

# sql - SQL Trim 来自 Varchar Sybase 的非数字

> ID：12412728
> 
> 赞同：0
> 
> 时间：2012-09-13T18:42:14.913
> 
> 标签：sql, string, sybase, string-parsing

我有一些 varchar 数据，其中包含数值，我试图只去掉数字部分。我将其作为同时执行许多其他操作的存储过程的一部分来执行，因此我希望将其作为内联查询的一部分来执行。

我在此列中的数据值如下所示（添加单个刻度以显示 varchars 的结尾）：

```
'1.25', '< 5 min', '2.35 minutes', '50.43 min' 
```

我想从这个专栏中得到的是：1.25、5、2.35、50.43

我的问题似乎是如何确定单选中数值的长度，所以我可以在最后去掉字符。除了选择一个值（我的数字并不总是相同的长度）之外，我不确定我能做什么。我只想要数值的原因是因为我需要将其转换为浮点数以获取目标值。

这是我尝试过的：

```
 SUBSTRING(my_data, PATINDEX('%[0-9]%', my_data), 4) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:09:40.537

这有点复杂，但它适用于您的示例。

```
declare @val varchar(10)
select @val='50.43 min'
select 
  case
     when PATINDEX('%[a-z]%',col) = 0
       then col
     else rtrim(SUBSTRING(col,1,PATINDEX('%[a-z]%',col)-1))
   end        
from
 ( select SUBSTRING(@val,PATINDEX('%[0-9]%',@val),PATINDEX('%[0-9]%',@val)
   +len(@val)+1) as col ) t 
```

[在这里](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks101.htm)您可以找到有关字符串函数的文档。

# ruby-on-rails-3 - RoR：为什么 rake db:migrate 不输出任何东西？

> ID：12412730
> 
> 赞同：0
> 
> 时间：2012-09-13T18:42:18.003
> 
> 标签：ruby-on-rails-3, database-migration

我将 add_column :microposts, :type, :string 添加到我的数据库迁移之一（如果重要的话，不是最近的迁移）。并且还运行了 rake db:reset。所以我肯定做出了改变。但是现在如果我运行 rake db:migrate 或 bundle exec rake db:migrate，它不会输出任何东西。如果我运行跟踪...

```
alex@alex-ThinkPad-T410:~/rails_projects/final2$ rake db:migrate --trace
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Invoke rails_env (first_time)
** Execute rails_env
** Execute db:load_config
** Execute db:migrate
** Invoke db:_dump (first_time)
** Execute db:_dump
** Invoke db:schema:dump (first_time)
** Invoke environment 
** Invoke db:load_config 
** Execute db:schema:dump 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:48:15.460

你写了：

> 我将 add_column :microposts, :type, :string 添加到我的数据库迁移之一（如果重要的话，不是最近的迁移）。

这听起来很可疑，就好像您刚刚将文本添加到迁移文件中一样。那是行不通的。迁移状态机不会注意到实际文本文件的变化。请检查

```
rake db:migrate:status 
```

您应该改为创建一个新的迁移

```
rails g migration AddTypeToMicropost type:string 
```

然后再次运行 rake

# android - 如何保持特定组的可扩展列表视图始终打开

> ID：12412732
> 
> 赞同：0
> 
> 时间：2012-09-13T18:42:31.457
> 
> 标签：android, expandablelistview

如何保持特定组的可扩展列表视图始终打开。

我有一个可展开的列表视图，如果用户从子视图中选择某些内容，我希望它处于打开状态。

我可以在点击孩子时访问 groupId，但我不知道之后如何让它保持打开状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:55:00.377

您可以保存孩子的父组的 id 并覆盖`ExpandableListView.OnGroupCollapseListener()`。

如果是您要保持开放的组，请致电`expandGroup()`。

# sql - 我可以在 WHERE 子句中使用 CASE 表达式吗？

> ID：12412738
> 
> 赞同：2
> 
> 时间：2012-09-13T18:42:48.937
> 
> 标签：sql, sql-server

我不确定如何在 sql 中编写查询。
这是我到目前为止所尝试的。

```
where
  case 
       when a.book_id like 'AB%' then a.book_id = b.school_id,   --1   
       when a.book_id like 'CB%' then a.book_id = b.college_id.  --2
  end 
```

**案例 1 和 2 的解释。**

1-我相信是好的。
2-当`a.book`以字母 CB 开头时，例如`CBQ123`，只需取`Q123`= `b.college_id`。

b.college_id 前面没有 CB。

**编辑以添加示例**

```
select 
       a.Name,
       a.ID,
       a.Due,
       b.school_id,
       b.college_id
from Student a and FinishedStudent b
where
  case 
       when a.book_id like 'AB%' then a.book_id = b.school_id,   --1   
       when a.book_id like 'CB%' then a.book_id = b.college_id.  --2
  end 
```

如果 a.book = CBQ111 那么 Q111 在 FinishedStudent 表中而不是 CBQ11，所以我只需要比较最后 3 个字符。

**使用案例 2 示例进行编辑**

```
 when a.book_id ='CBQ111' then a.book_id(Q111) = b.college_id.  --2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:53:40.500

只是一个小的语法问题。在 T-SQL 中，`CASE`是一个返回值的表达式，因此您需要将输出与某些内容进行比较——它不像其他语言（如 VB）中的流控制语句。

```
where a.book_id = case 
       when a.book_id like 'AB%' then b.school_id    --1   
       when a.book_id like 'CB%' then b.college_id   --2
  end 
```

根据评论中添加的单词问题的加扰，也许你真正想要的是：

```
WHERE (a.book_id LIKE 'AB%' AND a.book_id = b.school_id)
   OR (a.book_id LIKE 'CB%' AND SUBSTRING(a.book_id, 3, 255) = b.college_id) 
```

还有其他方法可以编写最后一行，但如果 book_id 有索引，LIKE 过滤器可能仍然有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:54:18.520

编辑：纠正问题并清理代码。

您可以将其放在 WHERE 子句中，但我更喜欢将其放在联接中。

```
select 
       a.Name,
       a.ID,
       a.Due,
       b.school_id,
       b.college_id
from Student a
  join FinishedStudent b on a.book_id = 
    case 
       when a.book_id like 'AB%' then b.school_id,   --1   
       when a.book_id like 'CB%' then b.college_id.  --2
    end 
```

# image - 带坐标的图像叠加

> ID：12412740
> 
> 赞同：0
> 
> 时间：2012-09-13T18:43:02.090
> 
> 标签：image, coldfusion, overlay, coordinates

我最近有一个项目，它试图自动“模拟”带有标准徽标的图像。例如，我有 1000 张产品图片，并且我有一个徽标图片需要放置（叠加）在每张图片的顶部。我知道我可以使用 ColdFusion 的 imageOverLay() 函数来做到这一点。但是，我假设这总是将覆盖的图像放在底层图像的中间（假设它们具有相同的宽度和高度参数）。我想知道是否有任何方法可以指定叠加图像左上角的 X/Y 坐标，并将叠加图像放置在该位置？

一个网站的例子：

[http://www.internalsearch.expandedproductsearch.com/catalog/48/](http://www.internalsearch.expandedproductsearch.com/catalog/48/)

您会注意到所有产品都有正确放置在产品上的图像。我可以向你保证，这不是手工完成的。他们必须有一种方法来指定每个产品的叠加图像应该放在哪里，然后它会自动将叠加图像（徽标）放在那个位置。谁能想到其他方法来做到这一点？是否有某种高级图像库可以与 ColdFusion 一起使用？

任何信息将不胜感激！谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:23:37.207

我相信这在[Adob​​e 论坛](http://forums.adobe.com/message/4696716#4696716)上得到了回答，你是正确的@Leigh；`imagePaste`是解决方案。

*我仍然无法对问题发表评论，因此将其发布为答案。*

# io - Ubuntu 或 Mac 上是否有工具可以监控程序的 CPU 和 I/O 使用情况以及 I/O 等待时间？

> ID：12412741
> 
> 赞同：1
> 
> 时间：2012-09-13T18:43:04.340
> 
> 标签：io, cpu, cpu-usage, iowait

我想确定我的应用程序是 IO 还是 CPU 受限。是否有这样的工具来确定您的应用程序的运行时间有多少用于 CPU 等待/IO 等待/在 CPU 上运行等？我正在从终端运行我的应用程序。我听说实际上有这样一个用于 linux 的工具，但我不知道它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:44:24.560

您可以使用`mpstat`and的组合`iostat`（我不相信前者可用于 OS X）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:47:59.980

[这](http://www.omgubuntu.co.uk/2011/11/5-system-monitoring-tools-for-ubuntu)是 ubuntu 的前 5 个监控工具的列表。你可以收集相当多的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-22T02:51:08.917

我想你可以试试 nmon。它可以在大多数 Linux 环境中使用。

# scala - Scala 不可变映射协方差

> ID：12412752
> 
> 赞同：0
> 
> 时间：2012-09-13T18:43:29.563
> 
> 标签：scala, covariance

我试图掌握Scala中的协变和逆变。我有一组像这样的类 **Message1 和 Message2 是 Message 的子类型**

```
sealed trait Parser[T <: Message]{
  //... blah blah
}

class Parser1 extends Parser[Message1]{
}

class Parser2 extends Parser[Message2]{
} 
```

现在我有另一个模块（工厂），它将映射存储在不可变的 Map 中

```
var myMap = Map[String,Parser[Message]()
myMap += Map("Message1" -> new Parser1)
myMap += Map("Message2"-> new Parser2) 
```

现在这不编译。我错过了什么？

这是我得到的编译错误

```
[error]  found   : scala.collection.immutable.Map[java.lang.String,s.p.h.m.Parser1]
[error]  required: (String, s.p.h.m.Parser[c.s.m.Message])
[error]   myMap += Map("Message1" -> new Parser1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:47:32.403

你得到的错误是什么？`Parser`由于您的类层次结构，您在这里看起来不会有任何类型错误。

但是，您似乎正在尝试更改不可变映射，这*会*导致错误。此外，您应该将*地图对*添加到地图而不是*新地图*。试试这个：

```
val myMap = Map[String,Parser]()
val myMap1 = myMap + ("Message1" -> new Parser1)
val myMap2 = myMap1 + ("Message2" -> new Parser2) 
```

如果您真的想使用而不是为每个更新`+=`创建一个新的，那么您可以使用而不是默认（不可变）映射类型。`val`[`scala.collection.mutable.Map`](http://www.scala-lang.org/api/current/scala/collection/mutable/Map.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T06:19:55.643

您已经看到您需要`++=`将另一个映射的条目添加到映射中，而`+`需要一个条目（键和值的元组）。如果要保留`var`，则需要确保它`Parser`是协变的，`T`以便将`Parser[Message1]`其视为`Parser[Message]`( 因为 的结果`+`将是现有条目和新条目的最接近的超类型，然后在这种情况下将保留`Map[String,Parser[Message]]`并且因此它可以再次存储在`myMap`）：

```
trait Message; class Message1 extends Message; class Message2 extends Message

sealed trait Parser[+T <: Message]  // !
class Parser1 extends Parser[Message1]
class Parser2 extends Parser[Message2]

var myMap = Map.empty[String,Parser[Message]]
myMap += "Message1" -> new Parser1
myMap += "Message2"-> new Parser2
myMap ++= Map( "Message1b"-> new Parser1, "Message2b"-> new Parser2 ) 
```

# android - 将 facebook like 按钮添加到 Android 应用程序以重定向到 facebook 粉丝页面

> ID：12412754
> 
> 赞同：-2
> 
> 时间：2012-09-13T18:43:37.057
> 
> 标签：android, facebook-like

我正在开发一个 android 应用程序，并想添加一个类似 facebook 的按钮，当单击该按钮时，会将用户重定向到 facebook 上的应用程序粉丝页面，有没有办法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:13:18.050

创建[ImageView](http://developer.android.com/reference/android/widget/ImageView.html)使用 facebook like 按钮作为图像，[并将](http://developer.android.com/reference/android/view/View.html#setOnClickListener%28android.view.View.OnClickListener%29)其[OnClickListener](http://developer.android.com/reference/android/view/View.OnClickListener.html)设置为您自己的实现，该实现使用[Intent](http://developer.android.com/reference/android/content/Intent.html)[启动活动](http://developer.android.com/reference/android/content/Context.html#startActivity%28android.content.Intent%29)，即动作是[ACTION_VIEW](http://developer.android.com/reference/android/content/Intent.html#ACTION_VIEW)和[Uri](http://developer.android.com/reference/android/net/Uri.html)您的 facebook like 页面。看起来像这样：

```
ImageButton img = new ImageButton(this);
//set img's image to the fb like image

img.setOnClickListener(new View.OnClickListener() {
    public void onClick(View view) {
        Intent open = new Intent(Intent.ACTION_VIEW, Uri.parse("http://..."));
        startActivity(open);
    }
}); 
```

# c# - 模拟 ORA-3113：通信通道上的文件结尾

> ID：12412755
> 
> 赞同：0
> 
> 时间：2012-09-13T18:43:39.263
> 
> 标签：c#, oracle, plsql

我有一个 C# Windows IIS 服务器 (Windows Server 2003) 应用程序连接到托管在 Linux 上的 Oracle 数据库（Red Hat 5.3 上的 10gR2）。Oracle 会间歇性地抛出 ORA-3113: end-of-file on communication channel 错误。这搞砸了 C# 中的 OracleConnection 对象。然后，任何尝试使用 OracleConnection 的新 OracleCommands 都失败，说明连接已关闭。

我已经查看了此错误生成的 Oracle 跟踪文件，并将问题与网络硬件故障隔离开来，并正在努力修复它。

但是，我需要使我的 C# 代码更健壮，并通过关闭并且不再使用该连接对象来适当地响应此错误。在 C# 中很容易捕获异常，但我无法在开发环境中重现网络问题以证明我的代码可以正常工作并自行清理。

```
try
{
  oracleCommand.ExecuteNonQuery();
}
catch(OracleException exception)
{
  if(exception.Code == 3113)
    CloseAndCleanup();
} 
```

我尝试在表上编写一个 PL/SQL 触发器，当我尝试将其插入表中时会引发 ORA-3113。

```
CREATE OR REPLACE TRIGGER SCHEMA.TABLE
BEFORE DELETE OR INSERT OR UPDATE
ON SCHEMA.TABLE
FOR EACH ROW
DECLARE
  CONNECTION_LOST_CONTACT   EXCEPTION;
  PRAGMA EXCEPTION_INIT (CONNECTION_LOST_CONTACT, -3113);
BEGIN
  RAISE CONNECTION_LOST_CONTACT;
END; 
```

这会引发正确的错误，但不会破坏 C# 中的 OracleConnection 对象。我仍然可以向 OracleConnection 发送命令并且它可以工作。

**如何准确模拟 ORA-3113 错误？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T19:09:18.350

`ORA-3113`意味着分配给客户端的服务器进程/线程意外死亡或被故意杀死。`ORA-3113`您可以通过手动终止服务器进程/线程来产生错误。杀死会话不会产生该错误。

要重现该错误，您可以采取以下步骤：

1）确定与您的会话关联的服务器进程/线程

```
select p.spid  -- process ID
     , s.program  -- your oracle client
  from v$process p
  join v$session s
    on p.addr = s.paddr 
```

在服务器端

2）使用`orakill`（windows）或`kill -9 ..`（Linux）杀死服务器线程/进程

窗口示例

```
c:\> orakill ORACLE_SID spid 
```

之后，您将获得`ORA-3113`客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:48:08.660

您可以从一些 PL-SQL 代码（例如在触发器中）手动抛出该异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:57:23.130

您可以*终止*会话。

```
alter system kill 'sid,serial#' immediate 
```

您可以查询[V$SESSION](http://docs.oracle.com/cd/E11882_01/server.112/e25513/dynviews_3016.htm#REFRN30223)或[V$MYSTAT](http://docs.oracle.com/cd/E11882_01/server.112/e25513/dynviews_2071.htm#REFRN30158)[`sys_context`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions184.htm#SQLRF06117)并解决它，但使用`USERENV`命名空间可能更好。

```
select sys_context('USERENV','SESSIONID') from dual 
```

将为您获取当前会话 id ( `sid`)，然后您可以查询 V$SESSION 以获取`serial#`.

此过程将终止运行它的会话：

```
create or replace procedure kill_my_session is

   l_sid v$session.sid%type;
   l_serial v$session.serial#%type;

begin

   select sid, serial#
     into l_sid, l_serial
     from v$session
    where sid = (select sys_context('USERENV','SESSIONID') from dual)
          ;

   execute immediate 'alter system kill session '''|| l_sid  
                       || ',' || l_serial# || ''' immediate';

end; 
```

当然，您总是可以手动完成，这可能更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T13:22:56.627

我知道最初的问题是针对 Linux 上的 Oracle 系统设置。对于在**Windows**上运行 Oracle 数据库 XE 的其他人来说，有一种简单的方法可以重现这一点。

进入正在运行的服务（在控制面板\系统和安全\管理工具中找到）并简单地停止名为**OracleServiceXE**的进程。这也会导致 ORA-03113 出现。

# css - 如何给出具有位置的DIV：绝对；其内容的宽度？

> ID：12412756
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:43:49.470
> 
> 标签：css

我试图让 div 的宽度根据其内容水平扩展，内容是浮动 div，我希望它们显示为 我使用
的一行 ，但它不适用于 IE 和 FF（它在谷歌浏览器） 这是我的 HTML 代码：
`white-space: nowrap;`

```
<div class="floating_menu_container">    
    <div class="floating_menu">
        <div class="floating_menu_item account">
            <div class="sub_floating_menu">
                <div class="sub_floating_menu_item"></div>
                <div class="sub_floating_menu_item"></div>
            </div>
        </div>

    </div>
</div> 
```

这是CSS代码：

```
.floating_menu_container{
position: absolute;
top: 25px;
left: 5px;
height: 50px;
z-index: 5;
}

.floating_menu_container .floating_menu{
height: 0px;
width: 40px;
background: #4D75A6;
z-index: -1;
position: absolute;
top: 35px;
left: 7px;
}

.floating_menu_container .floating_menu .floating_menu_item{
width: 30px;
height: 30px;
background: #94acc9;
border: 1px solid #6991c2;
margin: 7px 0px 4px 4px;
cursor: pointer;
position: relative;
}

.floating_menu_container .floating_menu .floating_menu_item .sub_floating_menu{
height: 30px;
position: absolute;
top: 0px;
background: #4D75A6;
left: 42px;
border: 1px solid #003980;
z-index: 10;
cursor: default;
white-space: nowrap;
}

.floating_menu_container .floating_menu .floating_menu_item .sub_floating_menu .sub_floating_menu_item{
width: 20px;
height: 20px;
background: #94acc9;
margin: 5px;
float: left;
cursor: pointer;
} 
```

这是[jsfiddle](http://jsfiddle.net/uUGbk/)
上的示例，我想根据其内容使用 class='sub_floating_menu' 扩展 div

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:09:22.390

`width: 20px;`从您的`.sub_floating_menu_item`, `height: 30px;`from中删除`.sub_floating_menu`并替换`float: left;`为`display: inline-block;`应该可以解决问题，小演示：[小链接](http://jsfiddle.net/glee/CZbne/5/)。

# xml - 包含多行的 MERGE 命令以插入或更新

> ID：12412760
> 
> 赞同：0
> 
> 时间：2012-09-13T18:44:05.917
> 
> 标签：xml, sql-server-2008, merge, insert-update

我有一个这样的 XML：

```
<Job>
<Piece PieceID="0001">
  <OperatorID>O1</OperatorID>
  <MachineID>M1</MachineID>
<Status>OK</Status>
</Piece>
<Piece PieceID="0002">
  <OperatorID>O1</OperatorID>
  <MachineID>M1</MachineID>
<Status>ERROR</Status>
</Piece>
</Job> 
```

此 XML 通过 XML 类型参数传递到存储过程，该存储过程对其进行解析并将值存储在表中的单独列中 -`PieceID, OperatorID, MachineID, Status`即列。

如果每个片段不存在，则此存储过程必须插入​​每个片段，如果该片段已经存在于 table 中，则必须更新它`X`。在上面的示例中，一旦操作员修复了机器中的错误并重新运行作业，状态可能会显示为 OK for `PieceID 0002`。在这种情况下，`PieceID=0001`应该忽略。

如果只有一块要处理（`MERGE`SQL Server 2008 中的命令？），我知道该怎么做；我无法有效地完成几百件。

请为这个问题提出一种有效的方法。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:01:03.570

您可以使用 MERGE 更新批量数据，而不仅仅是单行：

```
MERGE [TargetTable]
USING [SourceTable]
ON [TargetTable].PieceId= [SourceTable].PieceId
WHEN MATCHED AND status <> [SourceTable].Status THEN
UPDATE SET status = [SourceTable].Status 
```

您可以对新数据使用 INSERT，例如

```
INSERT ..... WHERE PieceId NOT IN (SELECT PieceId FROM targetTable) 
```

# jquery - 动态创建的手风琴不起作用。为什么？

> ID：12412761
> 
> 赞同：0
> 
> 时间：2012-09-13T18:44:09.913
> 
> 标签：jquery, jquery-ui

有人能告诉我为什么这架手风琴不工作吗？

ajax 调用工作正常，并且手风琴 div 使用与手风琴 2 div 相同的结构创建（用于检查手风琴是否正常工作！）

div 用适当的类装饰：

```
<div id=​"accordion" class=​"ui-accordion ui-widget ui-helper-reset ui-accordion-icons" role=​"tablist">​ 
```

但仅此而已。没有任何动态创建的内容被触及。并且 div 只是像正常一样呈现（即没有格式，只是链接和文本交替，而不是手风琴！）

如您所见，我尝试将对手风琴（）的调用分散到各处，但无济于事。

这显然与条目是动态创建的事实有关。但是谷歌搜索似乎发现其他人在类似的设置下也很好。

PS我累了，一无所知，所以这可能是愚蠢的！

```
 <script>
        $(document).ready(function() {

            $("#accordion").accordion({
                header: "h3"
            });

            $.ajax({
                type: "GET",
                url: "/api/blog",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(blogs) {
                    for (var i in blogs) {
                        $('#accordion').append(
                            $('<div/>').append(
                                $('<h3></h3>').append(
                                    $('<a href="#"/>').append(
                                        blogs[i].Title
                                    )
                                )
                            ).append(
                                $("<div/>").append(
                                    blogs[i].Body
                                )
                            )
                        );
                    }
                    $("#accordion").accordion({
                        header: "h3"
                    });
                }
            });
            $("#accordion").accordion({
                header: "h3"
            });
            $("#accordion2").accordion({
                header: "h3"
            });
        });
    </script>
</head>
    <body>
    <div id="accordion"></div>
    <div id="accordion2">
            <div>
                <h3><a href="#">First</a></h3>
                <div>Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.</div>
            </div>
            <div>
                <h3><a href="#">Second</a></h3>
                <div>Phasellus mattis tincidunt nibh.</div>
            </div>
            <div>
                <h3><a href="#">Third</a></h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:49:18.410

对于一个你初始化你的手风琴两次太多次尝试删除其中两个：

```
$("#accordion").accordion({
                header: "h3"
            }); 
```

但保留 ajax 函数内部的初始化，以便在初始化手风琴之前填充内容。

# ruby-on-rails - Rails - HAML 元素属性用单引号包裹

> ID：12412768
> 
> 赞同：1
> 
> 时间：2012-09-13T18:44:32.123
> 
> 标签：ruby-on-rails, ruby-on-rails-3, html, haml

我有一个 Rails 网站，目前我的一些标签属性是用单引号生成的。我不确定这是否会导致标记无效，但基于 validator.w3.org，它是有效的并且在 HTML 5 doctype 上运行。

但我很好奇为什么我的标签，特别是元标签是用单引号生成的。我生成这样的标签：

```
%meta{:content => "width=device-width, initial-scale=1.0", :name => "viewport"} 
```

它会生成这个：

```
<meta content='width=device-width, initial-scale=1.0' name='viewport'> 
```

它还对其他元标记（如关键字和描述元标记）使用单引号。我只是想尝试使其保持一致，并尽可能对所有内容使用双引号。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T22:05:13.700

使用`tag`rails 助手应该让你保持一致：

```
tag 'meta', {:content => "width=device-width, initial-scale=1.0", :name => "viewport"}, true 
```

# c# - 通过 linq to xml 选择属性值

> ID：12412769
> 
> 赞同：2
> 
> 时间：2012-09-13T18:44:34.490
> 
> 标签：c#, xml, linq-to-xml

在我的 xml 文件中，我如何 通过 linq to xml 选择元素`TagId`中的属性值`ServiceAssignment`

**注意：字符串属性中的此 xml 不在 xml 文件中**

```
<AnchoredXml xmlns="urn:schema:Microsoft.Rtc.Management.ScopeFramework.2008" SchemaWriteVersion="1">
  <Key ScopeClass="Global">
    <SchemaId Namespace="urn:schema:Microsoft.Rtc.Management.Settings.ServiceAssignment.2008" ElementName="ServiceAssignments" />
    <AuthorityId Class="Host" InstanceId="00000000-0000-0000-0000-000000000000" />
  </Key>
  <Dictionary Count="1">
    <Item>
      <Key />
      <Value Signature="2ffb6b0d-0239-4016-b08b-40520d1687ff">
        <ServiceAssignments xmlns="urn:schema:Microsoft.Rtc.Management.Settings.ServiceAssignment.2008">
          <ServiceAssignment TagId="659550892">
            <Component Name="Registrar">
              <ServiceId xmlns="urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008" SiteId="1" RoleName="Registrar" Instance="1" />
            </Component>
            <Component Name="PresenceFocus">
              <ServiceId xmlns="urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008" SiteId="1" RoleName="UserServices" Instance="1" />
            </Component>
          </ServiceAssignment>
          <ServiceAssignment TagId="911048693">
            <Component Name="Registrar">
              <ServiceId xmlns="urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008" SiteId="1" RoleName="Registrar" Instance="2" />
            </Component>
            <Component Name="PresenceFocus">
              <ServiceId xmlns="urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008" SiteId="1" RoleName="UserServices" Instance="2" />
            </Component>
          </ServiceAssignment>
        </ServiceAssignments>
      </Value>
    </Item>
  </Dictionary>
</AnchoredXml> 
```

我尝试这段代码，但给了我一个空异常

```
var MyList = doc.Root.Elements("ServiceAssignment").Select(c=>c.Attribute(("TagId")).Value).ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:55:44.463

您在文档中有命名空间的元素，因此您需要将它们包含在查询中。

```
XNamespace itemNs = "urn:schema:Microsoft.Rtc.Management.ScopeFramework.2008";
XNamespace assignmentNs = "urn:schema:Microsoft.Rtc.Management.Settings.ServiceAssignment.2008";
var query =
    from item in doc.Descendants(itemNs + "Item")
    from assignment in item.Descendants(assignmentNs + "ServiceAssignment")
    select (long)assignment.Attribute("TagId"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:51:37.513

您可以尝试使用此代码

```
var result = from item in XElement.Load("YourFile.xml").Root.Elements("ServiceAssignment")
             where item.Attribute("TagId") == value
             select item ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:01:15.243

您的 XML 包含名称空间，因此您不能只比较全名。
如果你不关心命名空间，你可以使用[`XName.LocalName`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xname.localname.aspx)：

```
var result = from element in doc.Root.Descendants()
             where element.Name.LocalName == "ServiceAssignment"
             select (int)element.Attribute("TagId"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T19:02:57.113

```
string xmlString =
                @"<AnchoredXml xmlns='urn:schema:Microsoft.Rtc.Management.ScopeFramework.2008' SchemaWriteVersion='1'>
  <Key ScopeClass='Global'>
    <SchemaId Namespace='urn:schema:Microsoft.Rtc.Management.Settings.ServiceAssignment.2008' ElementName='ServiceAssignments' />
    <AuthorityId Class='Host' InstanceId='00000000-0000-0000-0000-000000000000' />
  </Key>
  <Dictionary Count='1'>
    <Item>
      <Key />
      <Value Signature='2ffb6b0d-0239-4016-b08b-40520d1687ff'>
        <ServiceAssignments xmlns='urn:schema:Microsoft.Rtc.Management.Settings.ServiceAssignment.2008'>
          <ServiceAssignment TagId='659550892'>
            <Component Name='Registrar'>
              <ServiceId xmlns='urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008' SiteId='1' RoleName='Registrar' Instance='1' />
            </Component>
            <Component Name='PresenceFocus'>
              <ServiceId xmlns='urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008' SiteId='1' RoleName='UserServices' Instance='1' />
            </Component>
          </ServiceAssignment>
          <ServiceAssignment TagId='911048693'>
            <Component Name='Registrar'>
              <ServiceId xmlns='urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008' SiteId='1' RoleName='Registrar' Instance='2' />
            </Component>
            <Component Name='PresenceFocus'>
              <ServiceId xmlns='urn:schema:Microsoft.Rtc.Management.Deploy.Topology.2008' SiteId='1' RoleName='UserServices' Instance='2' />
            </Component>
          </ServiceAssignment>
        </ServiceAssignments>
      </Value>
    </Item>
  </Dictionary>
</AnchoredXml>";

var doc = XDocument.Parse(xmlString);       
var TagIds = doc.Descendants()
                .Elements()
                .Where(e => 
                            e.HasAttributes && 
                            e.Name.LocalName.Equals("ServiceAssignment") && 
                            e.Attribute("TagId") != null)
                .Select(e => e.Attribute("TagId").Value); 
```

# php - 如何从没有标准地址写入格式的源中提取 PHP 中的地址？

> ID：12412772
> 
> 赞同：0
> 
> 时间：2012-09-13T18:44:49.113
> 
> 标签：php, extract

我有一堆包含地址的消息（来自推特）。它们有很多种（你可以想象随机抽样的人输入一个地址。城市位置总是已知的，所以他们通常只输入道路名称和编号/区域）

有没有图书馆可以提取这些？我试过寻找但什么也没找到。

如果没有，关于我如何做到这一点的任何建议？目前我只是在提取 [previous word + [rd/ave/street/lane/blvd]] 之类的东西，但它并不那么准确。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:53:11.480

我知道没有图书馆这样做..但是在阅读您的问题时想到了一个疯狂的想法。

使用 google maps geocoding api 查找您的地址的 long 和 lat。然后使用反向地理编码 api 从您的 lat 和 long 中查找地址，因为它将被整齐地格式化为 json 对象。

相当混乱，但这是我能想到的最好的。（有一个好处是你已经有了你的地址坐标:)

# jquery - jquery-ui按钮不起作用

> ID：12412777
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:45:18.347
> 
> 标签：jquery, jquery-ui

# html

```
<input type="checkbox" name="bar" value="1" id="id_bar" />
<label for="id_bar">Bar</label> 
```

# 静态文件

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script>
<script type="text/javascript" src="/static/js/vendor/jquery-ui-1.8.23.custom.min.js"></script>
<link rel="stylesheet" href="/static/css/overcast/jquery-ui-1.8.23.custom.css" /> 
```

# 脚本

```
$(document).ready(function(){
    var checkboxes = $('input[type=checkbox]');
    try{
        $(checkboxes).button();     
    }
    catch(e)
    {
        alert(e);
    }
}); 
```

# 怀疑

我没有收到任何错误，脚本运行得很好，但即使在执行命令后，复选框也没有变化，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:52:03.450

您正在寻找按钮集而不是按钮

来自[jquery ui docs](http://docs.jquery.com/UI/Button "jQuery UI 文档")：radio 和 checkbox 使用 buttonset()

```
 $(document).ready(function() {
    $("#radio").buttonset();
  }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:51:39.353

试试这个：

```
$(document).ready(function(){
   var checkboxes = $('input[type=checkbox]');
   try{
       checkboxes.button();      
   }
   catch(e)
   {
      alert(e);
   }
}); 
```

或交替

```
$(document).ready(function(){
   try{
       $('input[type=checkbox]').each(function(index){
           $(this).button();   
       });     
   }
   catch(e)
   {
      alert(e);
   }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:52:43.153

你试过这些吗？

```
var checkboxes = $('input[type="checkbox"]'); 
```

和

```
checkboxes.button(); 
```

**更新** 或

```
checkboxes.buttonset(); 
```

**更新 2**

```
<form>
    <div id="radio">
        <input type="radio" id="radio1" name="radio" /><label for="radio1">Choice 1</label>
        <input type="radio" id="radio2" name="radio" checked="checked" /><label for="radio2">Choice 2</label>
        <input type="radio" id="radio3" name="radio" /><label for="radio3">Choice 3</label>
    </div>
</form> 
```

接着

```
<script>
    $(function() {
        $( "#radio" ).buttonset();
    });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:53:17.900

我知道这是一个过度声明，但是 Jquery UI 在带有样式按钮和表单时并不友好。

我建议[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/) 因为它们使用简单的类样式。

回到回答你的问题。
var checkboxes 通常意味着有多个复选框。所以也许使用.each()？

```
$('input[type=checkbox]').each(function(index, value) {
  $(this).click();
}); 
```

如果需要，您可以使用 $(this).is(':checked') 来查看复选框是否被选中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T18:48:47.187

你有没有尝试过：

```
$(checkboxes).click(); 
```

# php - 化简分数

> ID：12412782
> 
> 赞同：9
> 
> 时间：2012-09-13T18:45:28.973
> 
> 标签：php

如何在 PHP 中简化分数？

例如，转换`40/100`为`2/5`.

我能想到的唯一方法是对两个数字进行质数分解并比较相似的结果，但我也不确定如何做到这一点。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-13T18:50:19.573

当您简化分数时，您将分子和分母除以它们的最大公约数。

所以你只需要计算这两个数字的 GCD。没有内置函数，但很容易实现[欧几里得算法](http://en.wikipedia.org/wiki/Euclids_algorithm)：

```
function gcd($a,$b) {
    $a = abs($a); $b = abs($b);
    if( $a < $b) list($b,$a) = Array($a,$b);
    if( $b == 0) return $a;
    $r = $a % $b;
    while($r > 0) {
        $a = $b;
        $b = $r;
        $r = $a % $b;
    }
    return $b;
} 
```

然后将顶部和底部除以它。

```
function simplify($num,$den) {
    $g = gcd($num,$den);
    return Array($num/$g,$den/$g);
}
var_export(simplify(40,100)); // Array(2,5) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:53:37.707

如果你有 PHP`gmp`扩展，你可以这样做。

```
$num = 40;
$den = 100;
$gcd = gmp_intval(gmp_gcd((string)$num, (string)$den));

$new_num = $num / $gcd;
$new_den = $den / $gcd; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-11-22T15:27:33.883

这是一个简单的递归 PHP 函数

```
 <?php

  function reduceFraction($numerator, $denominator)
  {
    $gcd = findGreatestCommonDenominator($numerator, $denominator);

    return [$numerator / $gcd, $denominator / $gcd];
  }

  function findGreatestCommonDenominator($a, $b)
  {
    return $b ? findGreatestCommonDenominator($b, $a % $b) : $a;
  }
} 
```

用法 ：

```
 <?php $reduced = reduceFraction(40,100); // returns [2,5] ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T18:48:38.830

该算法非常简单：

*   从字符串中提取两个值。
*   找到它们的最大公约数（$gcd）（例如，使用[欧几里得算法](http://en.wikipedia.org/wiki/Euclidean_algorithm)）
*   将两个值除以 $gcd
*   使用找到的值重建字符串

# python - Django 自定义管理仪表板错误

> ID：12412786
> 
> 赞同：3
> 
> 时间：2012-09-13T18:45:46.773
> 
> 标签：python, django, django-grappelli

我尝试使用 django-grappelli 仪表板，但管理界面出现错误。

```
Django Version: 1.4.1
Exception Type: ImportError
Exception Value:    
No module named dashboard

In template /.../lib/python2.7/site-packages/grappelli/dashboard/templates/admin/index.html, error at line 32
31  {% block content %}
32  {% grp_render_dashboard %}
33  {% endblock %} 
```

我可以在更改之前使用 grappelli 管理界面。采取的步骤是根据[手册](http://django-grappelli.readthedocs.org/en/latest/dashboard_setup.html)。我将这些添加到我的 settings.py

```
 GRAPPELLI_INDEX_DASHBOARD = 'myproj.dashboard.CustomIndexDashboard'
    ...
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.contrib.auth.context_processors.auth",
    "django.core.context_processors.request",
    "django.core.context_processors.i18n",
    'django.contrib.messages.context_processors.messages',
)

    INSTALLED_APPS = (
        'grappelli.dashboard',
        'grappelli',
        'django.contrib.admin',
         ... 
```

dashboard.py 位于根目录 (myproj) 中。它有一个类。

```
 class CustomIndexDashboard(Dashboard):

myproj
├── admin
│   ├── css
:
├── dashboard.py
├── grappelli
│   ├── images
│   │   ├── backgrounds
├── myapp
│   ├── __init__.py
│   ├── __init__.pyc 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-13T19:44:38.283

好的，它开始工作了。dashboard.py 需要移动到 myproj/myproj

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-25T00:53:58.123

我也遇到过同样的问题！感谢您的回答，但您的回答似乎过于简单，以至于我最初无法理解。请允许我详细说明，以便其他人能够解决类似的问题。

假设你有一个这样的目录结构：

```
 myproj
    ├── myproj

    ├── settings.py
    ├── manage.py
    ├── urls.py
    ├── grappelli
    │   ├── ...
    ├── myapp
    │   ├── __init__.py
    │   ├── __init__.pyc 
```

执行以下操作后：

```
 python manage.py customdashboard 
```

`dashboard.py`是在（第一个）目录中生成的，`myproj`目录结构如下所示：

```
myproj
├── myproj
├── dashboard.py
├── settings.py
├── manage.py
├── urls.py
├── grappelli
│   ├── ...
├── myapp
│   ├── __init__.py
│   ├── __init__.pyc 
```

您应该将`dashboard.py`文件放在`myproj/myproj`目录中。然后你登录到管理站点，你会发现它有效。这在[仪表板设置中没有明确描述](http://django-grappelli.readthedocs.org/en/latest/dashboard_setup.html)

# mysql - mysql多对多搜索

> ID：12412794
> 
> 赞同：3
> 
> 时间：2012-09-13T18:46:23.840
> 
> 标签：mysql, many-to-many

我有以下表格

```
CREATE TABLE IF NOT EXISTS `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8  ;

CREATE TABLE IF NOT EXISTS `skill` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8  ;

CREATE TABLE IF NOT EXISTS `user_skill` (
  `user_id` int(11) NOT NULL,
  `skill_id` int(11) NOT NULL ,
  PRIMARY KEY (`user_id`,`skill_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8  ; 
```

该表`user_skill`充当多对多表。现在我想选择所有具有**至少**`skill_id`1 和 2的用户。我怎样才能在 mysql 中做到这一点

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:50:33.210

```
select u.id, u.name
from `user` u
inner join `user_skill` us on u.id = us.user_id
where us.skill_id in (1, 2)
group by u.id
having count(distinct us.skill_id) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:48:36.350

天真的方式，使用`WHERE EXISTS`：

```
SELECT id
FROM `user` u
WHERE EXISTS(SELECT 1 FROM user_skill s WHERE s.user_id = u.id AND s.skill_id = 1)
AND EXISTS(SELECT 1 FROM user_skill s WHERE s.user_id = u.id AND s.skill_id = 2) 
```

使用两个连接：

```
SELECT u.id
FROM `user` u
INNER JOIN user_skill s1 ON s.user_id = u.id AND s.skill_id = 1
INNER JOIN user_skill s2 ON s.user_id = u.id AND s.skill_id = 2 
```

使用`HAVING COUNT`：

```
SELECT u.id
FROM `user` u
INNER JOIN user_skill s ON s.user_id = u.id
WHERE s.skill_id IN (1,2)
GROUP BY u.id
HAVING COUNT(*) = 2 
```**

# ruby-on-rails - ActiveRecord：从另一个模型链接

> ID：12412798
> 
> 赞同：0
> 
> 时间：2012-09-13T18:46:36.087
> 
> 标签：ruby-on-rails, activerecord

我有一个标签和任务的标签系统（标签通过 TagTask 有很多任务，反之亦然）

我想做的是创建一个范围，返回所有标签中提供的所有任务。因此，在 Tag 模型中，它看起来像这样：

```
def self.combined_tasks(tag_ids)
    tasks = []
    tag_ids.each do |tag_id|
      tasks << self.find(tag_id).tasks
    end

    tasks.inject { |result, elem| result & elem }
end 
```

困难在于，我想不出任何可链接的方式来在 Task 模型中创建一个范围来有效地做到这一点。通过以下方式将其转交给 Tag 模型

```
def self.in_all_tags(tags_ids)
  tags = Tag.combined_tasks(tag_ids)
end 
```

有效，但可以理解的是，它似乎不能链接到其他范围。

任何建议表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:16:35.320

尝试：

```
Task.joins(:tag_tasks).where(tag_tasks: {tag_id: tag_ids}).uniq 
```

# ruby - 一个实例变量可以访问同一个类中的另一个吗？

> ID：12412800
> 
> 赞同：1
> 
> 时间：2012-09-13T18:46:55.870
> 
> 标签：ruby, chess

我正在用 Ruby 编写一个国际象棋引擎。

我有一个`Game`类，它由两个属性组成：

*   `:board`，我`Board`班级的一个实例。
*   :log，一系列动作，用于保存和加载游戏。

该类`Board`由两个属性组成：

*   `:white`，我`Player`班级的一个实例。
*   `:black`，我`Player`班级的一个实例。

该类`Player`由片段位置组成，表示为位串：

```
:pawns, :knights, ..., :king 
```

我希望`Player`该类具有`in_check?`指示该播放器是否处于检查状态的方法。但是，这需要`@white`知道`@black,`哪个值是类中的一个实例`Board`。

有没有一种方法可以访问变量`@black`，`@white`而无需将黑色块的位置作为参数显式传递给该`in_check`方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:53:14.353

让`@white`和`@black`分别向董事会询问支票。

* * *

更新：

好吧，我想我这边有很多假设，所以让我们把这些写下来，看看我们是否有一些共同点：

```
class Board

  def initialize
    ...
    @black = Player.new(self, other_args*)
    @white = Player.new(self, other_args*)
    ...
  end

  def am_i_in_check?(player)
    case player
    when @black
      return does_white_check_black?
    when @white
      return does_black_check_white?
    end
  end

  ...
end

class Player
  ...
  def initialize(board,...)
    ...
    @board=board
    ...
  end
  ...

  def wants_to_know_whether_it_is_checked
    @board.am_i_in_check?(self)
    ...
  end
  ...
end 
```

我想上面隐藏了错别字，但它现在应该描述我的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:01:11.970

第一个玩家可以`"you're in check"`在迈出一步之后或之前将消息传递给另一个玩家。访问变量不是一个好主意，它会导致未来的问题，而是传递消息。

# sql - OneToMany 关系和加入 where 子句

> ID：12412801
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:47:06.740
> 
> 标签：sql

有没有人有一个非常好的示例，其中有两个具有 OneToMany 关系的表，其中以表 B 作为目标进行左联接比使用 WHERE 子句以表 A 作为目标进行左联接有用。

```
Table A (ManyToOne with Table B)
Pk
Number
Fk

Table B
Pk
IsActive 
```

我的意思是，我可以像这样写一个连接

```
select * from TableA as a left outer join TableB as b on b.pk=a.fk where b.isActive=false and a.Number < 15 
```

而不是写

```
select * from TableB as b left outer join TableA as a on b.pk=a.fk where b.isActive=false and a.Number < 15 
```

我的意思是，如果我在 noSQL 系统上支持连接，我什么时候需要支持第二个，因为有人不能把它重写为上面的第一个，并且有一个很好的用例，所以我可以总结一下大概什么时候用？

我问的原因是对象查询语言，我想知道在这种情况下是否需要支持执行 where 子句（或者如果我只是不允许这样的事情）......

```
 select b from TableB as b left fetch join b.tableAList as a where b.isActive=true and a.xxxxx = something 
```

但不是那么无效，因为 b 有很多 a 行，所以 a.xxxx 是无效的，因为它是一个列表，并且只能是 a.size ，这将是该 b 行的 a 行列表中的行数。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:51:03.893

您的两个示例都是有效的内部连接。

当您执行左外连接时，第二个表中的值为 NULL。您的 WHERE 子句是：

```
where b.isActive=false and a.Number < 15 
```

NULL 值将导致此操作失败，删除从第二个表中添加的所有“虚拟”行。

如果你真的想要一个左外连接，那么你需要将它们包含在 ON 子句而不是 WHERE 子句中。

但是，总的来说，`A LEFT OUTER JOIN B`它们`B LEFT OUTER JOIN A`是完全不同的。第一个保留 A 中的所有行，以及 B 中的匹配行（如果没有匹配，则为 NULL 值）。第二个保留 B 中的所有行，以及 A 中的所有匹配行（如果没有匹配，则为 NULL 值）。

# java - 升级 Java 后找不到 Sun.security

> ID：12412802
> 
> 赞同：3
> 
> 时间：2012-09-13T18:47:06.927
> 
> 标签：java, playframework, java-7, scribe, pkcs#11

我有一个使用 Play 2.0 创建的应用程序。我实现了 scribe-java 库来使用一些 OAuth 服务。直到今天一切都很好，但是当我升级 jdk 并重新启动服务器时，我无法使用 scribe-java 库。似乎它使用了一些类`sun/security/pkcs11/P11Key`，如 sun.security 包中的 和`sun/security/pkcs11/Length`，但找不到它。

“java -version”返回：

> java版本“1.7.0_03”
> 
> OpenJDK 运行环境 (IcedTea7 2.1.1pre) (7~u3-2.1.1~pre1-1ubuntu3)
> 
> OpenJDK 64 位服务器 VM（构建 22.0-b10，混合模式）

玩 2.0 堆栈跟踪：

```
! @6bk5o8md2 - Internal server error, for request [GET /user/service/google/oauth_callback/?code=[SECRET]] ->

play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NoClassDefFoundError: sun/security/pkcs11/P11Key]]
        at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [play_2.9.1.jar:2.0.2]
        at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [play_2.9.1.jar:2.0.2]
        at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
        at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.2]
        at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.2]
        at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.jar:2.0.2]
Caused by: java.lang.NoClassDefFoundError: sun/security/pkcs11/P11Key
        at sun.security.pkcs11.P11ECKeyFactory.generatePublic(P11ECKeyFactory.java:234) ~[sunpkcs11.jar:na]
        at sun.security.pkcs11.P11ECKeyFactory.implTranslatePublicKey(P11ECKeyFactory.java:103) ~[sunpkcs11.jar:na]
        at sun.security.pkcs11.P11ECKeyFactory.engineGeneratePublic(P11ECKeyFactory.java:152) ~[sunpkcs11.jar:na]
        at java.security.KeyFactory.generatePublic(KeyFactory.java:334) ~[na:1.7.0_03]
        at sun.security.x509.X509Key.buildX509Key(X509Key.java:223) ~[na:1.7.0_03]
        at sun.security.x509.X509Key.parse(X509Key.java:170) ~[na:1.7.0_03] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:09:45.000

又一次更新&&升级后，jdk从2.1.1pre升级到2.3.2，问题解决。发生的事情是甲骨文浪费了我 2 个小时，糟透了。:(

# php - 重定向到 2 页

> ID：12412808
> 
> 赞同：-5
> 
> 时间：2012-09-13T18:47:55.553
> 
> 标签：php, redirect

我有一个 PHP 页面，我想先将其重定向到一个页面（例如 google.com），然后再重定向到另一个页面（例如 bing.com）。

为此，我使用以下内容：

```
header('Location: http://google.com');
header('Location: http://bing.com'); 
```

问题是脚本在第一个“标题”处停止。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:54:52.097

恐怕您所描述的行为是不可能的。您究竟希望它如何工作？一个浏览器窗口如何同时访问两个页面？毕竟，浏览器在收到响应之前无法解释您的响应标头。因此，您显示的两行代码之间没有任何步骤，浏览器在同一响应中接收它们。

考虑网络的请求/响应性质，重新考虑您正在尝试做什么以满足您正在解决的需求。你说：

> 我想先将其重定向到一个页面（例如 google.com），然后再重定向到另一个页面（例如 bing.com）

那里有一个事件顺序：

1.  用户请求您的页面。
2.  您的页面响应重定向到第 1 页。
3.  用户请求页面 1。
4.  第 1 页回应。
5.  用户请求第 2 页。
6.  第 2 页回应。

您要插入的步骤在上面的 4 到 5 之间。自然，您无法修改或以任何方式控制 Google 的响应，因此您无法控制无法控制的第 1 页响应重定向到第 2 页。（事实上，即使他们这样做了，它要么是内容，要么是重定向...不是两者。）

在我的脑海中，可能有一种解决方法可能适合您的需求。您可以使用框架将用户留在您的页面上，同时向他们展示这些其他页面的内容。在您可以控制的父框架内，您可以使用 JavaScript 设置各种计时器和其他事件，将用户从第 1 页引导到第 2 页。（它是即时的吗？如果是这样，为什么还要为第 1 页而烦恼？是片刻之后吗？应该是什么导致从第 1 页重定向到第 2 页？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T10:36:38.040

好吧，也许您想同时打开 2 个页面。你可以通过javascript控制它。

类似于以下代码：

```
var open_link_google = window.open('','_parent');
open_link_google.location="http://www.google.com";

var open_link_yahoo = window.open('','_blank');
open_link_yahoo.location="http://www.yahoo.com"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-02T09:09:17.927

类似于以下代码：

```
var open_link_google = window.open('','_parent');
open_link_google.location="http://www.google.com";

var open_link_yahoo = window.open('','_blank');
open_link_yahoo.location="http://www.yahoo.com"; 
```

# oracle - 使用 Jetty/Gradle 加载 Oracle 驱动程序的 ClassNotFoundException

> ID：12412814
> 
> 赞同：2
> 
> 时间：2012-09-13T18:48:23.380
> 
> 标签：oracle, jetty, gradle

`java.lang.ClassNotFoundException: oracle.jdbc.pool.OracleConnectionPoolDataSource`当我试图通过 Gradle 运行 Jetty 时遇到了一个异常并且我已经没有想法了。gradle 中的 jetty 配置指向一个 env 文件：

`[jettyRun, jettyRunWar]*.jettyEnvXml = file('../resources/jetty/jetty-env.xml')`

在该文件中是 JNDI 配置：

```
<New id="OracleDS" class="org.mortbay.jetty.plus.naming.Resource">
  <Arg>java:comp/env/OracleDS</Arg>
  <Arg>
    <New class="oracle.jdbc.pool.OracleConnectionPoolDataSource">
      ...
    </New>
  </Arg>
</New> 
```

我一直在尝试向该文件添加一个 extraClasspath，设置 jetty.home 系统属性，并将依赖项添加到 jar（到 webapp 和 buildscript）。我也尝试过更简单的`OracleDataSource`课程。任何具体的建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:11:47.707

将库文件作为标准依赖项添加到 webapp 就可以了。

`providedRuntime files("$projectDir/../lib/ojdbc14.jar")`

不幸的是，我开始采用更多受应用服务器影响的方法。不幸的是，这些选项都没有提供太多反馈，因此通过 --debug 输出的 grepping 表明该解决方案导致库被一致加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T08:20:59.903

我遇到了同样的问题并使用'additionalRuntimeJars'属性解决了它：

```
jettyRun {
    additionalRuntimeJars = configurations.myJettyRuntime // for oracle classes
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-28T05:55:41.833

将 Oracle 依赖项添加到 Jetty 插件配置中

# javascript - 如何在 Javascript 中获取调用函数的名称？

> ID：12412815
> 
> 赞同：4
> 
> 时间：2012-09-13T18:48:23.863
> 
> 标签：javascript

考虑以下示例。

```
var obj = function(){};

function apply(target, obj) {

    if (target && obj && typeof obj == "object") {
        for (var prop in obj) {
            target[prop] = obj[prop];
        }
    }

    return target;
}

apply(obj.prototype, {
    firstFunction: function (){
        this.secondFunction();
    },
    secondFunction: function (){
        // how do I know what function called me here?
        console.log("Callee Name: '" + arguments.callee.name + "'");
        console.log("Caller Name: '" + arguments.callee.caller.name + "'");
    }
});

var instance = new obj();

instance.firstFunction(); 
```

更新

这两个答案真的很棒。谢谢你。然后我研究了在对象中调用递归或父函数的问题，并在这里找到了解决方案。这将允许我在不使用 arguments.callee/caller 属性的情况下检索函数名称。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/function](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/function)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:05:20.957

函数的*名称*是该函数的不可变属性，在初始函数表达式中设置。

```
var notTheName = function thisIsTheName() { ... }

someObj.stillNotTheName = function stillTheName() { ... } 
```

如果您的函数表达式没有名称，则（不出所料）无法通过名称来识别它。将函数分配给变量并没有给它命名；如果是这种情况，您将无法确定分配给多个变量的表达式的名称。

您应该通过将`firstFunction`'`name`属性表示为

```
firstFunction: function firstFunction(){
    this.secondFunction();
} 
```

此外，`arguments.callee`已弃用。请参阅[为什么 JavaScript 中不推荐使用 arguments.callee.caller 属性？](https://stackoverflow.com/questions/103598/why-was-the-arguments-callee-caller-property-deprecated-in-javascript)对历史的一个很好的解释`arguments.callee`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T18:54:53.463

给函数起名字

喜欢：

```
 var obj = function(){};

function apply(target, obj) {

    if (target && obj && typeof obj == "object") {
        for (var prop in obj) {
            target[prop] = obj[prop];
        }
    }

    return target;
}

apply(obj.prototype, {
    firstFunction: function   firstFunction(){
        this.secondFunction();
    },
    secondFunction: function    secondFunction(){
        // how do I know what function called me here?
        console.log("Callee Name: '" + arguments.callee.name + "'");
        console.log("Caller Name: '" + arguments.callee.caller.name + "'");
    }
});

var instance = new obj();

instance.firstFunction(); 
```

看看这个[问题](https://stackoverflow.com/questions/7999485/why-is-arguments-callee-caller-name-undefined)

# paypal - NSS：未找到客户端证书（未指定昵称）

> ID：12412825
> 
> 赞同：8
> 
> 时间：2012-09-13T18:48:49.967
> 
> 标签：paypal

使用 Paypal API，是的，我已经检查了我的配置文件，是的，我已经检查了用户名和密码……我没有想法。我正在使用从下载的 ExpressCheckout API，每次尝试调用 setExpressCheckout 方法时，都会出现以下错误：

NSS：未找到客户端证书（未指定昵称）

我知道这与 SSL 错误有关，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T00:09:31.450

8 月 3 日和 8 月 5 日，PayPal 更新了以下 API 端点的 SSL 证书：

*   api.paypal.com
*   api-3t.paypal.com
*   api-aa.paypal.com
*   api-aa-3t.paypal.com

如果您需要将新的 PayPal SSL 证书导入您的应用程序或系统密钥库/信任库，您可以从[https://ppmts.custhelp.com/app/answers/detail/a_id/920/](https://ppmts.custhelp.com/app/answers/detail/a_id/920/)下载它们。如果您通常不将 PayPal SSL 证书导入您的密钥库/信任库，则您无需执行任何操作。

对于沙盒，请使用此链接：[https](https://ppmts.custhelp.com/app/answers/detail/a_id/924) ://ppmts.custhelp.com/app/answers/detail/a_id/924下载新的 SSL 证书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-21T15:09:30.530

检查您向其发送请求的贝宝的服务器域。它应该是 api.paypal.com 用于基于证书的授权和 api-3t.paypal.com 用于基于签名的授权。

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_nvp_NVPAPIOverview#id084E30V0RE9](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_nvp_NVPAPIOverview#id084E30V0RE9)

# image - Bash 确定文件大小

> ID：12412827
> 
> 赞同：1
> 
> 时间：2012-09-13T18:49:13.100
> 
> 标签：image, bash

仍在学习 bash，但我对我的脚本有一些疑问。

我的脚本目标是访问带有 jpg 图像的文件夹，如果图像为 34.9kb，它将返回文件不存在。34.9kb 是显示“图像不存在”的图像大小。

```
#!/bin/bash

#Location
DIR="/mnt/windows/images"

file=file.jpg
badfile=12345
actualsize=$(du -b "$file" | cut -f 1)
if [ $actualsize -ge $badfile ]; then
    echo $file does not exist >> results.txt
else
    echo $file exists >> results.txt
fi 
```

我需要它将每一行打印到一个名为 results.txt 的 txt 文件中。我做了一些研究，有些人要么建议使用`du -b`，要么`stat -c '%s'`但我看不出使用其中一种的利弊。打印文件会在 if else 之后出现还是留在 if 因为我为每个文件打印？我需要在同一行打印名称和结果。回显文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:56:13.323

`stat -c '%s'`只会给你文件大小而不是别的，同时`du -b`会在输出中包含文件名，所以你必须使用例如`cut`或`awk`只获取文件大小。对于您的要求，我会选择`stat`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T09:08:35.120

根据您的问题和您对[以下问题](https://stackoverflow.com/questions/12426526/loop-a-line-command-in-bash)的评论，我假设您想要做的是：

1.  遍历特定目录中的所有 *.jpg 文件
2.  根据图像的大小运行不同的命令
    *   具体来说，如果文件大小为 40318 字节，则要打印*“[filename] 不存在” 。*

如果我的假设很接近，那么这应该让你开始：

```
# Location
DIR="/home/lsc"
# Size to match
BADSIZE=40318

find "$DIR" -maxdepth 1 -name "*.jpg" | while read filename; do
    FILESIZE=$(stat -c "%s" "$filename")  # get file size
    if [ $FILESIZE -eq $BADSIZE ]; then
        echo "$filename has a size that matches BADSIZE"
    else
        echo "$filename is fine"
    fi
done 
```

请注意，我使用了“ `find ... | while read filename`”而不是“ `for filename in *.jpg`”，因为前者可以更好地处理包含空格的路径。

另请注意，`$filename`它将包含文件的完整路径（例如`/mnt/windows/images/pic.jpg`）。如果您只想打印没有路径的文件名，您可以使用：

```
echo ${filename##*/} 
```

或者：

```
echo $(basename $filename) 
```

第一个使用更高效但可读性较差的[Bash 字符串操作](http://tldp.org/LDP/abs/html/string-manipulation.html)，后者通过调用[`basename`](http://linux.die.net/man/1/basename).

# jquery - 在 jquery attr() 中使用 javascript replace()

> ID：12412835
> 
> 赞同：2
> 
> 时间：2012-09-13T18:49:26.257
> 
> 标签：jquery

我想使用 jquery 在我的页面上选择一个特定的锚标记，并将 replace() 方法应用于它（我试图用 %27 替换 '，我在提交表单时遇到撇号问题......）而且我不确定该怎么做。我开始写这个：

```
 $(".view-subscription-admin tbody td.views-field-nothing a").attr("href 
```

然后意识到我不确定如何将它与替换功能一起使用。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:50:59.423

```
$(".view-subscription-admin tbody td.views-field-nothing a")
              .attr("href", function(i, oldHref) {
                   return oldHref.replace('&#039', '%27');
               }); 
```

***[`.attr()`](http://api.jquery.com/attr)***方法支持回调函数，在该参数中，您可以执行替换代码并返回`href`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T02:03:52.233

我不确定为什么建议的答案对我不起作用，但其他人给了我一个不同的建议，这个建议有效：

```
$(document).ready(function() {
  $(".view-subscription-admin tbody td.views-field-nothing a").each(function(i) {
            var oldHref= $(this).attr('href');
            var newHref = oldHref.replace('&#039;', '%27');
            $(this).attr('href',newHref);
  });
}); 
```

# c# - 如何创建一个通用例程来计时方法？

> ID：12412840
> 
> 赞同：3
> 
> 时间：2012-09-13T18:49:31.743
> 
> 标签：c#, .net

我需要测量应用程序上下文中许多不同方法的执行情况。

.NET 当然有 Stopwatch 类，它允许使用它的 .Start() 和 .Stop() 方法轻松地对一段代码进行计时。

但是，以正常方式使用 Stopwatch 类需要我用 Stopwatch 对象的实例装饰每个方法并调用它的 .Start() 和 .Stop() 方法。

我需要在数百种方法上使用秒表功能，并且不想用这段代码污染每个方法。我还希望能够打开和关闭计时。

有没有一种简单的方法可以在我自己的代码中实现通用计时解决方案？如果是这样，怎么做？代码分析器会这样做，所以我认为它一定是可能的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T18:56:37.620

只是一个想法。声明一个方法如下

```
public static long Measure(Action action)
{
    Stopwatch sw = Stopwatch.StartNew();
    action();
    return sw.ElapsedMilliseconds;
} 
```

并用作

```
var duration = Measure(() => MyMethod(param1)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:21:13.567

您还可以查看 AOP 并为 Timing 方法动态创建一个包装器（但仅适用于非静态公共方法）。

如果您使用 IoC，您基本上只需要使用装饰器注册类型，这当然可以自定义并在需要时打开和关闭，甚至在特定方法上。

我之前使用 Castle:DynamicProxy 来实现这一点（用于计时和错误记录）。

编辑：一个例子（来自城堡的旧版本：动态代理）

```
TimerInterceptor : IInterceptor
{
    public void Intercept(IInvocation invocation)
    {
        Stopwatch watch = new Stopwatch();
        watch.Start();
        invocation.Proceed();
        watch.Stop();
        //here you have the value which could be used to log (which I assume you want)
    }
}

new ProxyGenerator().CreateInterfaceProxyWithTarget<IMyInterface>(implementedObject, new TimerInterceptor()); 
```

# php - php 文件仅在文件以 php 代码开头时才有效

> ID：12412844
> 
> 赞同：1
> 
> 时间：2012-09-13T18:49:43.700
> 
> 标签：php, html, setcookie

我是 php 新手，想知道我对交错 html 和 php 代码的规则缺少什么。

这是我第二次遇到 php 文件只有在我的 php 标签位于文件开头时才有效的情况。我的所有文件都不是这种情况。我想知道为什么会这样。

这是一个例子：

我的文件结构如下：

```
<?php

... my php code

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Authentication</title>
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
<div id="container">
</div>
</body>
</html> 
```

但是当我在顶部移动那个 html 块时（这是我最终想要的，因为我在我的 php 代码中使用了一些 echo 语句），并且只在底部留下以下内容：

```
</div>
</body>
</html> 
```

然后某些部分的 php 代码不起作用。例如，我的 setcookie 函数不再设置 cookie（尽管它不会出错），而我仍然可以正常运行 sql 查询或 echo 语句。我遇到了一个类似的问题，直接从教程站点中提取了一个完全不同的代码：该示例仅在代码以

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:51:44.660

在将任何输出发送到浏览器之前，PHP 必须执行某些操作（例如写入 cookie），因为这些操作涉及设置响应标头（始终在任何其他内容之前发送）。这似乎是这里的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:52:59.593

根据[文档](http://php.net/setcookie)：

> **setcookie()**定义了一个 cookie 与其余的 HTTP 标头一起发送。与其他标头一样，必须在脚本的任何输出*之前*发送 cookie （这是协议限制）。这要求您在任何输出之前调用此函数，包括`<html>`和`<head>`标记以及任何空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:55:53.483

看看这些链接，他们会解释一些事情，永远不要忘记在 stackOverflow 上提问

[http://www.w3schools.com/php/php_cookies.asp](http://www.w3schools.com/php/php_cookies.asp)

[http://php.net/manual/en/features.cookies.php](http://php.net/manual/en/features.cookies.php)

[http://www.w3schools.com/php/php_sessions.asp](http://www.w3schools.com/php/php_sessions.asp)

[http://it.php.net/manual/en/session.examples.basic.php](http://it.php.net/manual/en/session.examples.basic.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:56:36.497

回答您的问题，您几乎可以将标签放置在 html 代码中的任何位置，只要它的结构正确。

但是，php 中有些函数要求在执行之前不输出任何内容，例如 setcookie、setsession、header .. 等。

这里的输出是；一种。php 代码中的 echo 语句。湾。函数所在标签之前的 html 代码。

至于 php 中的某些代码不起作用。通常，如果您的代码有任何问题，则该 php 代码不起作用。因此，最好在此之前检查它的语法是否正确。

# asp.net - 由于验证器，无法离开页面

> ID：12412845
> 
> 赞同：0
> 
> 时间：2012-09-13T18:49:48.550
> 
> 标签：asp.net, validation

我的验证器有问题。我在联系表单上进行了验证，以确保垃圾邮件，但我的问题是，当我转到该页面并想要返回默认站点时，由于验证器，它不会让我这样做。文本框中没有写入任何内容，也没有单击“发送”按钮。

任何有想法的人，我能做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:58:02.223

如果您要使用特定按钮而不是浏览器的后退按钮“返回”，请在按钮`CausesValidation="false"`的属性中进行设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:53:47.220

这可能是由于您单击返回的**按钮/任何其他提交控件将**[**CausesValidation**](http://msdn.microsoft.com/de-de/library/system.web.ui.webcontrols.button.causesvalidation.aspx)设置为 true？此属性将导致您的所有验证器控件执行检查，因此，如果存在任何无效控件/值，则阻止用户更改页面。

*任何时候都可以在浏览器中点击后退按钮，*并且验证器控件无法阻止。

# asp.net - ASP.NET：当我的页面执行存储过程时，如何显示加载图像？

> ID：12412848
> 
> 赞同：2
> 
> 时间：2012-09-13T18:49:59.923
> 
> 标签：asp.net, vb.net, progress-bar, loading

我有一个正在处理的页面，它可以正常工作，因为我按下一个按钮并执行一个存储过程。问题是存储过程需要一段时间才能完成，我希望用户知道正在取得进展并且它没有卡住。那么有没有一种好方法可以让用户对正在取得的进展有所了解？我打算只是简单地显示一个动画 gif，但不知道如何做到这一点。或者，如果有更优选的方法可以做到这一点，我会全神贯注。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:56:03.007

通常，让网站命令花时间是一个坏主意，但是当您必须让 Microsoft 拥有一个与 ASP.Net 一起使用的 Ajax 库时 - 这包括一个进度条控件，当您执行长时间任务时会出现该控件

可以在这里找到 ASP.Net Ajax 的站点；[http://www.asp.net/ajax](http://www.asp.net/ajax)

包含进度指示器的 Ajax Control Toolkit 在这里；[http://www.asp.net/ajaxlibrary/act.ashx](http://www.asp.net/ajaxlibrary/act.ashx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:03:31.983

是的，您绝对可以在存储过程执行时使用动画 .gif 向用户显示。您需要使用 ASP.NET AJAX 来完成此操作，特别是使用 UpdatePanel 和 UpdateProgress 控件。

查看指导您实施 UpdateProgress 控件的以下 URL：[http ://www.asp.net/AJAX/Documentation/Live/mref/T_System_Web_UI_UpdateProgress.aspx](http://www.asp.net/AJAX/Documentation/Live/mref/T_System_Web_UI_UpdateProgress.aspx)

“指定 UpdateProgress 控件的内容”部分讨论了使用 ProgressTemplate 显示动画图像，通知用户页面上的进度。

——泰勒

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:54:29.993

如果您执行 AJAX 调用，您可以使用 jQuery 显示加载图形。请参阅这篇文章[如何在 jQuery 中显示加载微调器？](https://stackoverflow.com/questions/68485/how-to-show-loading-spinner-in-jquery)

# jquery - jquery.cookies 在 IE8 中不起作用

> ID：12412849
> 
> 赞同：0
> 
> 时间：2012-09-13T18:50:17.677
> 
> 标签：jquery, internet-explorer, cookies, jquery-cookie

我正在使用[这个插件](https://github.com/carhartl/jquery-cookie)来建立一个 cookie

一切正常，但在 IE7 和 IE8 中

这是我的 JS 代码：

```
jQuery(document).ready(function() {

    jQuery(function() {
          if (jQuery.cookie('shownDialog') != 'true') {
            window.onload = document.getElementById('lightbox-22556401244951').click(); 
          }
            jQuery.cookie('shownDialog', 'true', {expires: 7});
    });

}); 
```

不知道为什么它不能只在 IE7 和 IE8 中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:55:13.567

您将所有内容包装在 ready 函数中，因此`window.onload`已经触发。将您的代码更新为：

```
 jQuery(function() {
          if (jQuery.cookie('shownDialog') != 'true') {
            jQuery('#lightbox-22556401244951').trigger("click"); 
          }
            jQuery.cookie('shownDialog', 'true', {expires: 7});
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:24:43.650

该`ready`事件通常发生在`load`事件之前，但 IE 没有`ondomready`事件，因此 jQuery 模拟它。这意味着该`ready`事件有时可能`load`在 IE 中的事件之后发生。

使用该`load`方法绑定事件，然后它会一直触发。如果`load`事件已经触发，jQuery 将直接调用事件处理程序：

```
jQuery(document).ready(function() {

  jQuery(function() {
      if (jQuery.cookie('shownDialog') != 'true') {
        jQuery(window).load(function() {
          document.getElementById('lightbox-22556401244951').click();
        });
      }
        jQuery.cookie('shownDialog', 'true', {expires: 7});
  });

}); 
```

# xml - “Double Eval”XPath 表达式有一个尾随分号......让我很适合

> ID：12412851
> 
> 赞同：2
> 
> 时间：2012-09-13T18:50:19.550
> 
> 标签：xml, xpath, infopath

在将“Double Eval”XPath 表达式与 MS InfoPath 结合使用来捕获重复结构的内容时遇到尾随分号问题。我需要从结果中消除尾随分号。这是表达式：

`eval(eval(Repeater, 'concat(my:Node1DropDown, ";")'), "..")`

上述表达式的结果可以在以下 XML 中的“Node1Eval”中看到。除了结果中的尾随分号外，表达式会很好。

```
<?xml version="1.0" encoding="UTF-8"?><?mso-infoPathSolution solutionVersion="1.0.0.4" productVersion="14.0.0" PIVersion="1.0.0.0" href="file:///C:\Documents%20and%20Settings\Chris\Local%20Settings\Application%20Data\Microsoft\InfoPath\Designer3\e2c7e5c6af2049e9\manifest.xsf" ?><?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<my:myFields xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2012-08-28T16:45:10" xmlns:xd="http://schemas.microsoft.com/office/infopath/2003" xml:lang="en-us">
<my:Master_Section>
    <my:group2>
        <my:Repeater>
            <my:Node1DropDown>Lasers</my:Node1DropDown>
            <my:Node2DropDown>Lemon</my:Node2DropDown>
        </my:Repeater>
        <my:Repeater>
            <my:Node1DropDown>Sharks</my:Node1DropDown>
            <my:Node2DropDown>Apple</my:Node2DropDown>
        </my:Repeater><my:Repeater>
            <my:Node1DropDown>Monkeys</my:Node1DropDown>
            <my:Node2DropDown>Lemon</my:Node2DropDown>
        </my:Repeater>
    </my:group2>
    <my:Node1Eval>Lasers;Sharks;Monkeys;</my:Node1Eval>
    <my:Node2Eval>Lemon;Apple;Lemon;</my:Node2Eval>
</my:Master_Section>
</my:myFields> 
```

我猜想添加一些与返回项目的位置相关的逻辑可以帮助消除尾随分号。

问题的*真正*症结在于分号*始终*存在。我需要该`Node1Eval`字段为**空**，直到它实际上具有要显示的值。如果不是，那么它将与`[text()]`我尝试运行的 XPath 表达式测试混淆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:57:03.177

表示你的

> eval(eval(Repeater, 'concat(my:Node1DropDown, ";")'), "..")

由**X**，它将是

> 子字符串（**X**，1，字符串长度（**X**）-1）

最终给予

> substring(eval(eval(Repeater, 'concat(my:Node1DropDown, ";")'), ".."); 1, 字符串长度(eval(eval(Repeater, 'concat(my:Node1DropDown, ";" )'), "..")) - 1)

**更新：**
如果您通过“ **substring(eval(eval(** ”) 进行搜索，您可以确认它在 Infopath 中经常用于重复控件，例如，[本讨论](http://www.infopathdev.com/forums/t/8411.aspx?PageIndex=1)

> 我需要 Node1Eval 字段为空，直到它实际上具有要显示的值

在 Infopath Designer 中，在您的规则操作（或默认值）上，无论您在何处插入和编辑 Xpath 表达式，按**fx** > 双击**Repeater** > 按**Filter data...**按钮并插入您希望的任何条件。
对于 Node1DropDown 非空白的情况，它可能会导致

```
eval(eval(Repeater[Node1DropDown != ""], 'concat(my:Node1DropDown, ";")'), "..") 
```

# ruby-on-rails - rails - 如何注入空间

> ID：12412856
> 
> 赞同：0
> 
> 时间：2012-09-13T18:50:41.743
> 
> 标签：ruby-on-rails, erb

我需要在erb中注入这样的东西：

```
"This is item number 3" 
```

所以我用：

```
<%= t(:this_is_item_number) + " " + @item.id %> 
```

有没有更好的方法在注射内增加空间？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:05:23.633

**en.yml**

```
en:
  this_is_item_number: This is item number %{number} 
```

* **.erb**

```
<%= t(:this_is_item_number, number: 3) %> 
```

**结果**

> 这是项目编号 3

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:56:48.567

你经常看到

```
"#{t(:this_is_item_number)} #{@item.id}" 
```

# android - Android Launcher 显示选项卡活动

> ID：12412857
> 
> 赞同：1
> 
> 时间：2012-09-13T18:50:52.630
> 
> 标签：android, tabs

我有一个使用 TabWidgets 来显示 4 个选项卡的 Android 应用程序。每个选项卡都会打开一个活动。一切正常。现在我打开启动器，我看到的是我的所有选项卡也是应用程序。我有“POI”、“Routes”、“Map”、“E-Bike”作为选项卡，这四个选项卡也在启动器中，超出了真正的应用程序。

这是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:54:17.793

我猜您在 Manifest 中的每个活动声明中都有以下意图过滤器。仅在需要在 Launcher 上显示的那些活动中使用此功能。

```
<intent-filter>
   <action android:name="android.intent.action.MAIN" />
   <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

# dll - 为经典 ASP 注册 COM 组件

> ID：12412858
> 
> 赞同：3
> 
> 时间：2012-09-13T18:50:55.330
> 
> 标签：dll, com, asp-classic, activex, windows-server-2008-x64

我正在将带有 IIS 6 的旧 Windows 2003 服务器（32 位）升级到带有 IIS 7.5 的 Windows 2008 服务器（64 位）。我正在新机器上安装必要的 DLL（我只需要两个）。第一个工作得很好。第二个，ASPIMAGE.DLL 引起了一些麻烦。

这是我所做的（与 XZIP.DLL 相同的过程）：

*   将 ASPIMAGE.DLL 移动到 C:\Windows\SYSWOW64
*   `C:\Windows\SYSWOW64\regsvr32.exe C:\Windows\SYSWOW64\ASPIMAGE.DLL`- 我收到提示“ASPIMAGE.DLL 中的 DLLRegisterServer 成功”。我已经运行了多次 - 我希望这不是问题。
*   在应用程序池中将“启用 32 位应用程序”设置为 True。重新启动站点和 AppPool 只是为了确定。
*   尝试运行代码（在 Win2003 机器上运行良好）：

> 我收到此错误：
> 
> 服务器对象错误“ASP 0177：800703e6”
> 
> Server.CreateObject 失败
> 
> /scripts/update/resize.asp，第 2 行
> 
> 800703e6

请注意，我也尝试过将此作为替代品，但我遇到了同样的问题（看起来注册正常，但代码看不到它）： [http ://code.google.com/p/aspnetimage/](http://code.google.com/p/aspnetimage/)

任何想法是什么问题？这对我来说很奇怪，因为它似乎注册得很好，但是 ASP 找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T14:22:42.577

我能够通过使用 AspNetImage 作为替代品来解决这个问题`LoadPicture()`： http: [//www.w3schools.com/vbscript/func_loadpicture.asp](http://www.w3schools.com/vbscript/func_loadpicture.asp)。

[http://code.google.com/p/aspnetimage/](http://code.google.com/p/aspnetimage/)

# c# - 是否有 WPF 复选框控件切换事件？

> ID：12412860
> 
> 赞同：4
> 
> 时间：2012-09-13T18:51:01.553
> 
> 标签：c#, wpf, checkbox, toggle

考虑到 WPF 控件，我如何知道复选框的值是否已更改（切换）？

我知道有常见的`Checked`, `Unchecked`,`Clicked`事件，但是当值发生变化时，无论它是如何变化的，事件如何？

我浏览了这些事件，但没有发现任何东西，但也许我错过了显而易见的事情（因为过去发生过很多次）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T18:53:56.470

您可以将`IsChecked`依赖属性绑定到布尔值。在那个绑定的属性设置器上，你可以操纵你想要的（独立地，如果它把它设置为真或假）。这正如预期的那样工作。

在你看来：

```
 <Grid>
    <CheckBox ... IsChecked="{Binding ShowPending}"/>
  </Grid> 
```

在您的 DataContext ViewModel 或 CodeBehind 上。

```
 private bool showPending = false;

  public bool ShowPending
  {
      get { return this.showPending; }
      set 
      { 
         //Here you mimic your Toggled event calling what you want!
         this.showPending = value; 
      }
  } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-23T04:56:52.620

我知道这已经有一个公认的答案，但是绑定在这方面有点过分了。

只需编写一个事件处理程序并将其连接到 Checked 和 Unchecked 事件，然后检查事件处理程序内的 IsChecked 属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T19:12:24.460

离开兰道夫的答案，只需创建一个代表您的窗口的类。在新类中，创建一个名为 BlahIsChecked 的属性。在类和新属性的设置器中实现 INotifyPropertChangedEvent，使用属性名称触发事件。

```
class Blah : INotifyPropertyChanged
{
    // Used for triggering the event
    public event PropertyChangedEventHandler PropertyChanged;

    // Called when the property changes
    protected void OnPropertyChanged(String propertyName)
    {
        // Retrieve handler
        PropertyChangedEventHandler handler = this.PropertyChanged;
        // Check to make sure handler is not null
        if(handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    private bool _blahIsChecked;
    public bool BlahIsChecked
    {
        get {
            return _blahIsChecked;
        }
        set {
            _blahIsChecked = value;
            OnPropertyChanged("BlahIsChecked);
        }
    }
} 
```

现在，去你的 wpf 类并说 this.DataContext = new MainModel(); 您可以在 WPF 或 c# 中执行此操作。

现在在您的复选框 xaml 中执行以下操作

```
<checkbox Checked="{Binding BlahIsChecked, Mode=TwoWay}"/> 
```

我是凭记忆做到的，但应该让你开始。祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T19:22:53.400

您最好的选择可能是`IsChecked`物业。但是，如果您需要一个事件，您可以查看创建一个并使用该方法[`DependencyPropertyDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.aspx)注册一个处理程序。[`AddValueChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.addvaluechanged.aspx)

我认为这与您收到有关复选框值已更改的事件通知一样接近。创建描述符并添加处理程序如下所示：

```
var dpd = DependencyPropertyDescriptor.FromProperty(CheckBox.IsChecked, typeof(CheckBox));
dpd.AddValueChanged(...); 
```

# iphone - 带有 UIWebview 的 IP 摄像机流适用于 IOS 5 但不适用于 IOS 6

> ID：12412865
> 
> 赞同：8
> 
> 时间：2012-09-13T18:51:04.097
> 
> 标签：iphone, ios, ip, ipod, ios6

嗨，我在我的网站上流式传输网络摄像机，我将我的网站嵌入到 UIWebview 上，在 IOS 5 上运行正常，但是当我在 IOS 6 上打开我的应用程序时，只显示图像而不是视频。在我的网站上我正在使用`<iframe width="640" height="480" src="http://112.214.96.41:87/videostream.cgi?user=user&pwd=" frameborder="0"></iframe>` 请有人帮助我，还有另一种方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T09:52:03.963

如果你想在 UIWebView 中显示 IP 摄像机，你可以这样做：（假设 webView 是你的 UIWebView 的出口）

```
NSString * stream = @"http://login:password@ip:port/stream/"

NSString * html = [NSString stringWithFormat:@"<img name=\"Cam\" src=\"%@\" width=\"100%%\" height=\"100%%\" alt=\"Live Feed\" style=\"background-color: #000000\" />", stream];

[webView loadHTMLString:html baseURL:nil]; 
```

stream 是正确的 url，具体取决于相机的型号。

它适用于 iOs5 和 iOs6。

# java - Java Webapp 在 Eclipse 中运行良好，但在 Tomcat 中运行良好

> ID：12412867
> 
> 赞同：1
> 
> 时间：2012-09-13T18:51:09.557
> 
> 标签：java, spring, tomcat, servlets, configuration

我有一个小的 Java/Spring MVC REST /Maven 应用程序，它在 Eclipse 中运行得很好，而且当我从提示符运行以下命令时：

> mvn clean tomcat6:run

我的问题是当我这样做时：

> mvn 清洁包

并将生成的war文件推送到我的独立Tomcat实例中的“webapps”文件夹中，该服务不再工作。

独立的 Tomcat 启动得很好，日志中没有错误。有趣的是，当我在 Eclipse 中或通过 mvn 命令运行应用程序时，独立实例在端口 8989 和 8080 上进行侦听。

一旦应用程序在独立的 Tomcat 中启动，如果我尝试使用 RESTClient 访问我的服务，我会返回 404。我的自定义 404 实际上，不是通用的。

像我的 index.html 这样的静态内容也很好。

这是我的 web.xml 文件：

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
  <display-name>Skunk User Interface</display-name>

  <context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>file:///${APPS_CONFIG}/log4j.xml</param-value>
  </context-param>

  <listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
  </listener>

  <servlet>
    <servlet-name>skunk</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/skunk-servlet.xml
    </param-value>
  </context-param>

  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>

  <servlet-mapping>
    <servlet-name>skunk</servlet-name>
    <url-pattern>/skunk/*</url-pattern>
  </servlet-mapping>

  <!-- Healthcheck mapping -->
  <servlet-mapping>
    <servlet-name>skunk</servlet-name>
    <url-pattern>/health/*</url-pattern>
  </servlet-mapping>

  <error-page>
    <error-code>404</error-code>
    <location>/WEB-INF/404.htm</location>
  </error-page>
</web-app> 
```

还有臭鼬-servlet.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:c="http://www.springframework.org/schema/c"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:cache="http://www.springframework.org/schema/cache"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
         http://www.springframework.org/schema/mvc
         http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
         http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context-3.1.xsd
         http://www.springframework.org/schema/tx
         http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
         http://www.springframework.org/schema/aop 
         http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
         http://www.springframework.org/schema/cache 
         http://www.springframework.org/schema/cache/spring-cache-3.1.xsd">

    <tx:annotation-driven/>

    <!-- Load configuration settings -->
    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="ignoreUnresolvablePlaceholders" value="true" />
    </bean>

    <bean class="org.springframework.web.context.support.ServletContextPropertyPlaceholderConfigurer">
      <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE" />
      <property name="searchContextAttributes" value="true" />
      <property name="contextOverride" value="true" />
      <property name="ignoreResourceNotFound" value="true" />
      <property name="locations">
        <list>
          <value>classpath:config/application.properties</value>
          <value>file:///${APPS_CONFIG}/application.properties</value>
        </list>
      </property>
    </bean>

  <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
  </bean>

  <bean id="namedParameterJdbcTemplate" class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate" 
    c:dataSource-ref="dataSource" />

  <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource">
      <ref bean="dataSource"/>
    </property>
    <property name="hibernateProperties">
      <props>
        <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
      </props>
    </property>
  </bean>

  <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager" 
    p:sessionFactory-ref="sessionFactory" />

  <!-- Auto scan the components -->
  <context:component-scan base-package="com.skunk.myapp" />
  <mvc:annotation-driven/>

    <cache:annotation-driven />

    <bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheCacheManager">
        <property name="cacheManager" ref="ehcache"/>
    </bean>
    <bean id="ehcache" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
    <property name="configLocation" value="classpath:/ehcache.xml"/>
    </bean> 

  <aop:aspectj-autoproxy proxy-target-class="true" />

</beans> 
```

该配置中是否有任何内容可以解释为什么对调度程序 servlet 的任何请求都返回 404 而不是路由到控制器？

谢谢

* * *

**更新：**

从 Tomcat Standalone 添加日志输出。

catalina.[日期].log：

```
Sep 13, 2012 1:47:28 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files\Java\jdk1.6.0_31\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;.
Sep 13, 2012 1:47:28 PM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Sep 13, 2012 1:47:28 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 673 ms
Sep 13, 2012 1:47:28 PM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Sep 13, 2012 1:47:28 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.32
Sep 13, 2012 1:47:28 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor host-manager.xml
Sep 13, 2012 1:47:29 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor manager.xml
Sep 13, 2012 1:47:29 PM org.apache.catalina.startup.HostConfig deployWAR
INFO: Deploying web application archive skunk.war
Sep 13, 2012 1:47:44 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
Sep 13, 2012 1:47:44 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory examples
Sep 13, 2012 1:47:44 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory ROOT
Sep 13, 2012 1:47:44 PM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Sep 13, 2012 1:47:44 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Sep 13, 2012 1:47:44 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/19  config=null
Sep 13, 2012 1:47:44 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 16106 ms 
```

localhost.[日期].log：

```
Sep 13, 2012 1:47:39 PM org.apache.catalina.core.ApplicationContext log
INFO: Set web app root system property: 'webapp.root' = [C:\Users\my.user\Tomcat\webapps\skunk\]
Sep 13, 2012 1:47:39 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing log4j from [file:///${APPS_CONFIG}/log4j.xml]
Sep 13, 2012 1:47:39 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
Sep 13, 2012 1:47:43 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring FrameworkServlet 'skunk'
Sep 13, 2012 1:47:44 PM org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
Sep 13, 2012 1:47:44 PM org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextInitialized() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:00:52.940

如果您只是复制`yourproject.war`到 Tomcat 的`webapps`文件夹并让默认部署程序启动（扩展`yourproject.war`为名为 的目录`yourproject`），那么您应该知道默认的 Tomcat 逻辑是使您的应用程序在`/yourproject`.

如果您希望应用程序在根上下文 ( ) 下可用，`/`则应适当配置 Tomcat。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:09:20.377

所以这是你的组合。

App - Environment Status
Eclipse->Working
Eclipse Embedded TOMCAT -> working
Standalone TOMCAT -> Not working

查看 Eclipse Tomcat 首选项，它可能添加了类路径和库路径，这将使 Tomcat 能够识别。过去也遇到过类似的问题。

此外，您的静态内容也可以正常工作。这意味着 Eclipse 类路径中存在一些要运行的重要 jar，这在独立 Tomcat 中不可见。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T21:18:02.013

弄清楚了。我不得不从这里更改 web.xml 中的 servlet 映射：

```
 <servlet-mapping>
    <servlet-name>skunk</servlet-name>
    <url-pattern>/skunk/*</url-pattern>
  </servlet-mapping> 
```

对此：

```
 <servlet-mapping>
    <servlet-name>skunk</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping> 
```

为了能够使用 url 访问服务：

```
http://localhost:8080/skunk/myService 
```

我在那里的原始映射意味着我必须输入：

```
http://localhost:8080/skunk/skunk/myService 
```

为我服务……*叹息*

感谢你们！

# c# - 有效地找到最近的字典键

> ID：12412869
> 
> 赞同：38
> 
> 时间：2012-09-13T18:51:31.990
> 
> 标签：c#, sorting, dictionary

我在 a 中有一对日期和货币值`SortedDictionary<DateTime, decimal>`，对应于在合同定义的复利日期计算到未来的贷款余额。有没有一种有效的方法来找到最接近给定值的日期键？（具体来说，最近的键*小于或等于*目标）。关键是仅存储值更改时的数据，但有效地回答“x日期的余额是多少？”这个问题。对于范围内的任何日期。

有人问了一个类似的问题（[什么 .NET 字典支持“查找最近的键”操作？](https://stackoverflow.com/questions/1690929/what-net-dictionary-supports-a-find-nearest-key-operation)），当时的答案是“不”，至少来自回答的人，但那是差不多 3 年前的事了。

[How to find point between two keys in sorted dictionary](https://stackoverflow.com/questions/5301164/how-to-find-point-between-two-keys-in-sorted-dictionary)提出了天真地遍历所有键的明显解决方案。我想知道是否存在任何内置的框架函数来利用键已经在内存中索引和排序的事实 - 或者是一个内置的框架集合类，它更适合这种查询。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-13T18:56:38.037

由于`SortedDictionary`按键排序，因此您可以创建一个排序的键列表

```
var keys = new List<DateTime>(dictionary.Keys); 
```

然后有效地对其执行[二进制搜索](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1.binarysearch)：

```
var index = keys.BinarySearch(key); 
```

正如文档所说，如果`index`是正数或零，则密钥存在；如果它是负数，那么如果它存在，那么它`~index`是在哪里`key`找到的索引。因此，“立即更小”的现有键的索引是`~index - 1`。确保正确处理`key`小于任何现有键和`~index - 1 == -1`.

`keys`当然，上述方法只有在构建一次然后重复查询时才有意义；因为它涉及迭代整个键序列并在此之上进行二进制搜索，如果您只搜索一次，那么尝试这个是没有意义的。在那种情况下，即使是简单的迭代也会更好。

## 更新

正如 digEmAll 正确指出的那样，您还可以切换到`SortedList<DateTime, decimal>`以便[`Keys`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.sortedlist-2.keys)集合实现`IList<T>`（SortedDictionary.Keys 没有）。该接口提供了足够的功能来手动对其执行二进制搜索，因此您可以使用例如[此代码](https://stackoverflow.com/questions/594518/is-there-a-lower-bound-function-in-c-sharp-on-a-sortedlist)并将其作为`IList<T>`.

您还应该记住，如果项目未按已排序的顺序插入，则其`SortedList`性能比`SortedDictionary`构建期间更差，尽管在这种特殊情况下，日期很可能按时间（排序）顺序插入，这将是完美的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-07-23T15:02:58.480

因此，这并不能直接回答您的问题，因为您专门要求 .NET 框架内置的东西，但面临类似的问题，我发现以下解决方案效果最好，我想在这里发布它以供其他人使用搜索者。

我使用了[`TreeDictionary<K, V>`](http://www.itu.dk/research/c5/Release1.0/c5doc/types/C5.TreeDictionary%602.htm)来自[C5 Collections](http://www.itu.dk/research/c5/index.html) ( [GitHub](https://github.com/sestoft/C5/) / [NuGet](http://www.nuget.org/packages/C5) ) 的，它是一个红黑树的实现。

它有`Predecessor`/`TryPredecessor`和`WeakPredessor`/`TryWeakPredecessor`方法（以及类似的后继方法）可以轻松找到离键最近的项目。

我认为，在您的情况下更有用的是`RangeFrom`//允许您检索键之间的一系列键值对的方法。`RangeTo``RangeFromTo`

请注意，所有这些方法也可以应用于`TreeDictionary<K, V>.Keys`集合，这样您也可以只使用键。

它确实是一个非常简洁的实现，并且应该在 BCL 中包含类似的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-26T05:12:33.600

如果您需要将查询与插入相交错（除非您的数据是预先排序的，或者集合总是很小），那么就不可能有效地找到最近的键`SortedList`，`SortedDictionary`或者任何其他“内置”.NET 类型。

正如我在您引用的另一个问题中提到的那样，我创建了三个与 B+ 树相关的数据结构，它们为任何可排序的数据类型提供查找最近键功能[`BList<T>`：`BDictionary<K,V>`和`BMultiMap<K,V>`](http://www.codeproject.com/Articles/612301/The-List-Trifecta-Part). 这些数据结构中的每一个都提供`FindLowerBound()`与`FindUpperBound()`C++`lower_bound`和`upper_bound`.

这些在 Loyc.Collections NuGet 包中可用，`BDictionary`通常使用的内存比`SortedDictionary`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-17T22:11:10.910

```
 public static DateTime RoundDown(DateTime dateTime)
    {
        long remainingTicks = dateTime.Ticks % PeriodLength.Ticks;
        return dateTime - new TimeSpan(remainingTicks);
    } 
```

# c - 访问C中指针结构内的指针数组

> ID：12412874
> 
> 赞同：1
> 
> 时间：2012-09-13T18:51:42.247
> 
> 标签：c, arrays, pointers, struct

我在这个网站上寻找这个问题的答案已经很久了，但似乎仍然无法实现我的目标。没有我要添加的赋值语句，代码可以编译并正常工作。这段代码中的所有内容都是指针这一事实让我很困惑，但我无法改变这一点，它不是我的代码。我基本上只是想覆盖`x_array`（仅在 的第一个索引中`bs`）的所有值作为存储在`y_array`. 这是程序结构：

```
typedef struct
{
  double *x_array;
} b_struct;
typedef struct
{
  b_struct *bs;
} a_struct;

void fun_1(a_struct *as);
void allocate_b(b_struct *bs);
void allocate_a(a_struct *as);
int main(void)
{
  a_struct *as
  as = (a_struct *)malloc(sizeof(a_struct));
  allocate_a (as);
  fun_1 (as);
  // everything internal to sa is deallocated in separate functions
  free (as);
  return (0);
}
void allocate_a(a_struct *as)
{
   int i;

   if ((as->bs =(b_struct *)malloc(5*sizeof(b_struct))) == NULL)
   {
     printf("Error: Not enough memory!\n");
     exit(1);
   }
     for(i=0;i<5;i++) allocate_b (&(as->bs[i]));
  return;
}
void allocate_b(b_struct *bs)
{
  if ((bs->x_array =(double *)malloc(10*sizeof(double))) == NULL)
    {
      printf("Error: Not enough memory!\n");
      exit(1);
    }
  return;
}

void fun_1(a_struct *as)
{
  int i;
  double y_array[10]; // the values i need are read into this array
  // the following line is what will not compile
  for (i=0; i<10; i++) as->bs[0]->x_array[i]=y_array[i];
  return;
} 
```

我尝试了许多添加排列，`&`但`*()`每次我得到：

```
error: expression must have pointer type 
```

代码非常长且复杂，我试图解析出与我的具体问题相关的内容。我试图让它成为一个完整的程序，但如果我搞砸了一些语法，我很抱歉。希望这足以理解赋值语句工作需要发生的事情。有人可以解释如何访问这些嵌套指针结构和指针数组的每一层吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:56:21.000

> ```
> for (i=0; i<10; i++) as->bs[0]->x_array[i]=y_array[i]; 
> ```

在您的代码`bs[0]`中不是指针，而是`b_struct`. 将该行更改为：

```
for (i=0; i<10; i++)
    as->bs[0].x_array[i]=y_array[i];
            ^^^ 
```

# ms-access-2007 - Access 2007 后端是否需要工作组文件？

> ID：12412877
> 
> 赞同：1
> 
> 时间：2012-09-13T18:51:47.220
> 
> 标签：ms-access-2007

我知道当我（曾几何时）我是一名 Access 开发人员（Access 97）时，我曾经需要这些东西，但是我是否需要一个工作组文件来与其他两个用户共享一个后端数据库？

我做了拆分数据库的事情，并给了每个人自己的前端副本，我认为只需将后端部分放在共享文件位置就可以了。

其他人可以读取数据库并运行表单等，但他们不能添加行 - 我仍然可以。

我错过了什么？

# android - 在冰淇淋三明治中滚动时，ScrollView 不会调用 onDraw

> ID：12412880
> 
> 赞同：0
> 
> 时间：2012-09-13T18:52:10.213
> 
> 标签：android, drawing, scrollview

从 Ice Cream Sandwich（可能还有 Honeycomb）开始，我观察到 ScrollView 的行为发生了变化。

在 Gingerbread 中，孩子的 onDraw() 在滚动时被调用，并且剪切矩形正确地考虑了滚动位置。

在 ICS 中，滚动时永远不会调用孩子的 onDraw()。此外，剪裁矩形始终包含完整视图。

你知道我怎样才能恢复旧的行为吗？

提前致谢，

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:52:10.213

好的，将输入问题，我有一个想法，它似乎解决了“问题”。

它与硬件加速有关。您需要覆盖 ScrollView，并在其构造函数中禁用硬件加速，如下所示：

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
  try {
    Method setLayerType = getClass().getMethod("setLayerType", Integer.TYPE, Paint.class);
    setLayerType.invoke(this, View.LAYER_TYPE_SOFTWARE, null);
  } catch (NoSuchMethodException e) {
  } catch (IllegalArgumentException e) {
  } catch (IllegalAccessException e) {
  } catch (InvocationTargetException e) {
  }
} 
```

之后在滚动的时候会调用child的onDraw()，clip rect就可以了！

# python - 导入词汇表

> ID：12412882
> 
> 赞同：1
> 
> 时间：2012-09-13T18:52:17.253
> 
> 标签：python

我正在麻省理工学院的开放课件上学习 CS/Python。他们希望我设计一个刽子手游戏，并给了我一些用于导入单词表并从那里生成随机单词的初步代码。此代码本身会返回错误：“不能有无缓冲的文本 I/O。” 这是代码：

```
import random
import string

WORDLIST_FILENAME = "words.txt"

def load_words():
     print("Loading word list from file...")
     # inFile: file
     inFile = open(WORDLIST_FILENAME, 'r', 0)
     # line: string
     line = inFile.readline()
     # wordlist: list of strings
     wordlist = string.split(line)
     print("  ", len(wordlist), "words loaded.")
     return wordlist

def choose_word(wordlist):
     return random.choice(wordlist) 
```

MIT 课程没有使用我正在使用的 Python 3.0，所以那里可能有问题；如您所见，我已经将“print”从声明更新为与 Python 3.0 兼容的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:56:22.507

抛出此错误是因为您尝试在关闭缓冲的情况下读取**文本文件（第三个参数设置为 0）：**

```
inFile = open(WORDLIST_FILENAME, 'r', 0) 
```

将上面的行替换为

```
inFile = open(WORDLIST_FILENAME, 'r') 
```

它应该可以工作。

来自 python 文档：

> buffering 是一个可选整数，用于设置缓冲策略。 **传递 0 关闭缓冲（仅在二进制模式下允许）**，1 选择行缓冲（仅在文本模式下可用），整数 > 1 表示固定大小的块缓冲区的大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T18:56:45.197

`0`从`open`内置函数调用中删除。来自 python 文档：

> Buffering 是一个可选整数，用于设置缓冲策略。传递 0 以关闭缓冲（仅在二进制模式下允许）。

# dom - 仅在 IE9+ 中调用 jquery document.ready 和 window.load 后 getElementById 不在 DOM 中

> ID：12412884
> 
> 赞同：3
> 
> 时间：2012-09-13T18:52:40.933
> 
> 标签：dom, internet-explorer-9, onload, getelementbyid, document-ready

当我运行我的页面时，有时 getElementById 调用会找到元素，有时却找不到。绝对是时间问题。这仅在 IE9 中发生，而不在 IE 兼容模式（7 或 8）中发生，也不会在任何其他浏览器（Firefox、Opera、Safari 和 Chrome）中发生。无法创建小提琴，因为当我将页面剥离以适合小提琴并将其沙箱化时，问题就消失了。我的 getElementById javascript 调用位于 head 部分，据我了解，除非您在 DOM 准备就绪或窗口加载的情况下等待它们，否则此时将无法找到元素。我尝试将我的 getElementById javascript 包装在 jquery 的 $(document).ready 函数中，但这没有任何效果。我还尝试将它包装在我认为必须工作的 jquery 的 $(window).load 函数中，但这也没有效果。

[如果我尝试使用此 window.onload 解决方案 ( addLoadEvent](http://www.javascriptworkshop.com/2006/12/05/waiting-for-the-dom-to-load/) )等待元素，则它可以工作并找到它。那么为什么不使用 jquery 的 document.ready 或 window.load API？

我确实尝试在它引用的标记的 html 之后将脚本向下移动到页面中，但这没有任何效果，因为问题仍然存在并且找不到元素。我也把它移到了最后，但也没有效果。我对这个特定的结果感到困惑，因为我认为将 javascript 移动到最后会使这些元素可用（或者我读过），但似乎情况并非如此。有谁知道这是为什么？

我之前确实提到它只发生在 IE9 中。此外，只有在初始页面加载时才会出现问题，并且任何页面刷新都会使问题消失。我猜可能是由于缓存。

我正在使用 asp.net 4.0，这并不重要（或者我认为）。javascript 位于 html 部分上方的 .aspx 页面中，而不是外部 js 文件中。我确实尝试将它移动到外部文件只是为了彻底，但这并没有像预期的那样产生任何效果。

所以，总而言之，

1.  为什么 jquery API 不起作用？和
2.  为什么将 javascript 移到页面下方（或最后）也不起作用？

**内部 Javascript 代码片段：**

```
//        addLoadEvent(setupstuff);

//        function addLoadEvent(func)
//        {
//            var oldonload = window.onload;

//            if (typeof window.onload != 'function')
//            {
//                window.onload = func;
//            }
//            else
//            {
//                window.onload = function ()
//                {
//                    if (oldonload)
//                    {
//                        oldonload();
//                    }
//                    func();
//                };
//            }
//        }

    var txtLocation = '<%=txtLocation.ClientID%>';

    // JQuery plugin - JQueryLive (waits for element)
    $('#' + txtLocation).livequery(function ()
    {
        setupstuff();
    });

    //$(document).ready(function () //didn't work
    //$(window).load(function() //didn't work
    function setupstuff()
    {
        // search text watermark toggling
        var hasWatermark = $('#' + txtLocation).hasClass('txtLocationWatermark');

        var searchText;
        if (document.getElementById(txtLocation))
        {
            searchText = document.getElementById(txtLocation).value;
        }
        else
        {
            alert('Element ' + txtLocation + ' not found in DOM!');
            return;
        }
        //var searchText = $('#' + txtLocation).val(); //doesn't work either 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T00:55:21.483

升级到最新版本的 jQuery 修复了这个问题，因为在以前的版本之一（jQuery 1.7.?）中存在一个带有 .ready() 函数的错误，该函数记录在发行说明中。

# ajax - JSF：ui:include 和（损坏的）视图范围

> ID：12412886
> 
> 赞同：1
> 
> 时间：2012-09-13T18:52:50.447
> 
> 标签：ajax, jsf-2, mojarra, view-scope, uiinclude

我有一个 JSF 页面，其中包含一些常见元素，然后是 4 个根据各种用户操作动态加载和包含的部分。我有封装各种包含功能的 bean，结构如下所示：

```
mainview.xhtml 
     --backed by--> mainViewBean (request scope) 
       --with managed property--> mainViewView (view scope)

include1.xhtml
     --backed by--> include1Bean (request scope)
       --with managed property--> mainViewBean

include2.xhtml
     --backed by--> include2Bean (request scope)
       --with managed property--> mainViewBean

include3.xhtml
     --backed by (and with component bindings to)--> include3Bean (request scope)
       --with managed property--> mainViewBean

include4.xhtml
     --backed by--> mainViewBean 
```

在主视图页面上，每个包含都通过一系列条件渲染的 h:panelGroups 包含在 BalusC 在这些问题中的描述中：

[https://stackoverflow.com/a/9897016/945403](https://stackoverflow.com/a/9897016/945403)

[https://stackoverflow.com/a/7113961/945403](https://stackoverflow.com/a/7113961/945403)

视图范围 bean 包含一些关于用户活动的当前状态、他们当前正在查看的项目等的各种视图信息。

每个包含的视图都通过 ajax 和非 ajax 帖子执行各种任务。我的问题是某些面板中的某些操作似乎会导致视图范围被破坏，并且似乎没有押韵或理由。对于下面概述的错综复杂的工作流程，我提前道歉，但我会尽量做到清楚。

如果我在 include3.xhtml 中执行 ajax 操作，它们只会在 include 中呈现组件，我可以整天这样做，并且视图范围仍然存在。如果我执行非 ajax 帖子，刷新将更新（并可能添加以前未渲染的）include4.xhtml。然后，我可以随后在任何其他包含中执行操作。

如果我在 include1.xhtml 中执行一个 ajax 操作，它只调用它自己的支持 bean 中的方法，并且只更新它自己的组件，那么视图范围仍然存在。如果我执行调用 include3Bean 中的方法并更新包含 include2.xhtml 和 include3.xhtml 的 div 的 ajax 操作，则视图范围仍然存在，只要我继续在 include1.xhtml 中执行操作，视图范围就会保留。一旦我尝试在另一个包含中执行另一个操作，视图范围就会被破坏。

在这一点上，我对自己认为问题一定在于我正在更新不同的包含，而不是从中调用操作。但这似乎不是问题（或至少是唯一的问题），我现在将解释。

include2.xhtml 有一个 ajax 动作，当它被触发时，调用 mainViewBacking 中的一个方法并更新包含 include2.xhtml 和 include3.xhtml 的 div。如果我继续执行此操作，或在 include2.xhtml 中执行任何其他操作（包括非 ajax 操作），一切都会按预期工作并且视图范围仍然存在。但是，如果我随后在 include3.xhtml 中执行操作，则视图范围被破坏。奇怪的是我*可以*在 include1.xhtml 中执行操作，只要我愿意，他们将继续访问视图范围，但如果我尝试返回并在 include2.xhtml 或 include3 中执行操作。 xhtml，视图范围再次丢失。

我在这一点上有点卡住了，我什至不知道如何去找出问题所在。我假设一些关于刷新（以及删除或添加）包含的内容会导致视图范围丢失，但从之前链接的问题来看，这似乎不是问题，因为 ui 的实际 src 值:includes 不是动态生成的。而且我确实关闭了 mainview.xhtml 的部分状态保存。

这些动态显示的 ui:includes 有什么东西会破坏视图范围吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T14:37:51.877

## 编辑 2014-02-28：

在查看最新的omnifaces 展示时，我注意到BalusC 已经实现了一个脚本，它应该可以解决同样的问题，并且可能以比我下面的代码更好的方式来完成它。

[http://showcase.omnifaces.org/scripts/FixViewState](http://showcase.omnifaces.org/scripts/FixViewState)

## 原答案：

事实证明，这是 BalusC 在此处描述的 JSF 中的一个错误：http: [//balusc.blogspot.com/2011/09/communication-in-jsf-20.html#AjaxRenderingOfContentWhichContainsAnotherForm](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#AjaxRenderingOfContentWhichContainsAnotherForm)

不幸的是，由于某种原因，他的解决方案对我来说并没有始终如一地工作。结果，我编写了自己的（稍微烦人的）工作，如果他们需要，我会在这里提供给其他人。

我将以下 javascript 添加到 mainview.xhtml 页面：

```
var lastForm = null;

        function getViewStateFromLastForm(callingElement){

            var currentForm = $(callingElement).closest("form");
            var formId = currentForm.attr("id");

            if(lastForm != null ){
                var viewState = $("#" + lastForm).children("[name='javax.faces.ViewState']").val();
                currentForm.children("[name='javax.faces.ViewState']").remove();

                $('<input/>').attr({
                    type: 'hidden',
                    id: 'javax.faces.ViewState',
                    name: 'javax.faces.ViewState',
                    autocomplete: 'off',
                    value: viewState
                }).appendTo(currentForm);
            }
            lastForm = formId;

        } 
```

然后，提交给服务器的各个包含页面上的每个按钮`getViewStateFromLastForm(this);`在其 onclick 属性中都有一个调用。

# sql - 基于sql查询字符串

> ID：12412892
> 
> 赞同：1
> 
> 时间：2012-09-13T18:53:16.200
> 
> 标签：sql, oracle

我有一列包含这样的数据

```
 1  Virginia - VA,Maryland -MD,null
     2  California - CA,Nebraska - NE,Minnesota - MN
     3  Wyoming - WY,null,null 
```

等等。有没有办法我可以使用字符串函数修改列，使其看起来像普通的 sql？

```
 1 VA,MD
     2 CA,NE,MN
     3 WY 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:05:40.877

假设您对数据无能为力，您可以使用以下方法提取这些值[`REGEXP_REPLACE`](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions130.htm)：

```
SELECT id, REPLACE(REGEXP_REPLACE(column_name, '[^-]+ - ?([A-Z]{2},?)', '\1'), 
           ',null', '')
FROM your_table 
```

这是一个有效的**[演示](http://sqlfiddle.com/#!4/144e7/3)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T19:04:38.460

是的当然。

```
select substr(column_name, -2) from table_name 
```

虽然如果你能让你的数据提供者为你做这件事会更好。

如果数据比指示的更脏并且您使用的是 Oracle 10g 或更高版本，您可以使用[正则表达式路线](http://psoug.org/reference/regexp.html)，但这里似乎不需要。

```
select regexp_substr('California - CA', '[[:alpha:]]{2}$') from dual; 
```

这是一个小[SQL Fiddle](http://www.sqlfiddle.com/#!4/09778/4)来演示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T18:59:24.720

是的，它可以做到。但是有一个很大的`but`，SQL 是一种查询语言，并不意味着格式化字符串或使用它们。更好地规范化您的数据库，因为将所有数据保存在一个列中是一个很好的指标，表明您在表的规范化方面仍有工作要做。最好在您的应用程序中完成这项工作，而不是在使用 sql 的数据库上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T19:10:49.920

不要将列修改为您认为您想要的样子。在单个列中存储多个值是不好的。一劳永逸地修复表格：

```
SELECT col1 AS ID, SUBSTR(SUBSTR(col2, 1, INSTR(col2, ',', 1, 1)-1), -2) AS STATE
FROM badTable
WHERE SUBSTR(SUBSTR(col2, 1, INSTR(col2, ',', 1, 1)-1), -4) <> 'null'
UNION ALL
SELECT col1 AS ID, SUBSTR(SUBSTR(col2, 1, INSTR(col2,',', 1, 2)-1), -2) AS STATE
FROM badTable
WHERE SUBSTR(SUBSTR(col2, 1, INSTR(col2,',', 1, 2)-1), -4) <> 'null'
UNION ALL
SELECT col1 AS ID, SUBSTR(col2, -2) AS STATE
FROM badTable
WHERE SUBSTR(col2, -4) <> 'null' 
```

[SQL Fiddle 与此工作](http://sqlfiddle.com/#!4/b1b58/7)

# python - 如何在给定均值和标准差的情况下计算正态分布中的概率？

> ID：12412895
> 
> 赞同：114
> 
> 时间：2012-09-13T18:53:34.780
> 
> 标签：python, statistics, scipy, probability

如何在 Python 中给定均值、std 的正态分布中计算概率？我总是可以根据这个问题中的 OP 的定义明确地编码我自己的函数：[Calculating Probability of a Random Variable in a Distribution in Python](https://stackoverflow.com/questions/9448246/calculating-probability-of-a-random-variable-in-a-distribution-in-python)

只是想知道是否有库函数调用将允许您执行此操作。在我的想象中，它会是这样的：

```
nd = NormalDistribution(mu=100, std=12)
p = nd.prob(98) 
```

Perl 中有一个类似的问题：[如何计算 Perl 中给定正态分布的点的概率？](https://stackoverflow.com/questions/1377003/how-can-i-compute-the-probability-at-a-point-given-a-normal-distribution-in-perl). 但我没有在 Python 中看到一个。

`Numpy`有一个`random.normal`功能，但它就像采样，不完全是我想要的。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-09-13T19:03:15.167

[scipy.stats](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html)中有一个：

```
>>> import scipy.stats
>>> scipy.stats.norm(0, 1)
<scipy.stats.distributions.rv_frozen object at 0x928352c>
>>> scipy.stats.norm(0, 1).pdf(0)
0.3989422804014327
>>> scipy.stats.norm(0, 1).cdf(0)
0.5
>>> scipy.stats.norm(100, 12)
<scipy.stats.distributions.rv_frozen object at 0x928352c>
>>> scipy.stats.norm(100, 12).pdf(98)
0.032786643008494994
>>> scipy.stats.norm(100, 12).cdf(98)
0.43381616738909634
>>> scipy.stats.norm(100, 12).cdf(100)
0.5 
```

[需要注意的一件事——只是一个提示——是参数传递有点宽泛。由于代码的设置方式，如果你不小心写`scipy.stats.norm(mean=100, std=12)`了`scipy.stats.norm(100, 12)`or `scipy.stats.norm(loc=100, scale=12)`，那么它会接受它，但会默默地丢弃那些额外的关键字参数并给你默认值 (0,1)。]

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-09-13T19:32:11.347

Scipy.stats 是一个很棒的模块。只是为了提供另一种方法，您可以直接使用

```
import math
def normpdf(x, mean, sd):
    var = float(sd)**2
    denom = (2*math.pi*var)**.5
    num = math.exp(-(float(x)-float(mean))**2/(2*var))
    return num/denom 
```

这使用此处找到的公式：[http ://en.wikipedia.org/wiki/Normal_distribution#Probability_density_function](http://en.wikipedia.org/wiki/Normal_distribution#Probability_density_function)

去测试：

```
>>> normpdf(7,5,5)  
0.07365402806066466
>>> norm(5,5).pdf(7)
0.073654028060664664 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2017-12-05T05:18:07.990

这里有[更多信息](https://docs.scipy.org/doc/scipy/reference/tutorial/stats.html)。首先，您正在处理一个冻结分布（在这种情况下冻结意味着它的参数设置为特定值）。要创建冻结分布：

```
import scipy.stats
scipy.stats.norm(loc=100, scale=12)
#where loc is the mean and scale is the std dev
#if you wish to pull out a random number from your distribution
scipy.stats.norm.rvs(loc=100, scale=12)

#To find the probability that the variable has a value LESS than or equal
#let's say 113, you'd use CDF cumulative Density Function
scipy.stats.norm.cdf(113,100,12)
Output: 0.86066975255037792
#or 86.07% probability

#To find the probability that the variable has a value GREATER than or
#equal to let's say 125, you'd use SF Survival Function 
scipy.stats.norm.sf(125,100,12)
Output: 0.018610425189886332
#or 1.86%

#To find the variate for which the probability is given, let's say the 
#value which needed to provide a 98% probability, you'd use the 
#PPF Percent Point Function
scipy.stats.norm.ppf(.98,100,12)
Output: 124.64498692758187 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2019-02-28T19:47:32.427

开始`Python 3.8`，标准库将[`NormalDist`](https://docs.python.org/3.8/library/statistics.html?highlight=normaldist#statistics.NormalDist)对象作为[`statistics`](https://docs.python.org/3.8/library/statistics.html)模块的一部分提供。

它可用于获取给定*均值*( ) 和*标准差*( ) 的***概率密度函数***( [`pdf`](https://docs.python.org/3.8/library/statistics.html#statistics.NormalDist.pdf)- 随机样本 X 接近给定值 x 的可能性)：*`mu`*`sigma`**

 **```
from statistics import NormalDist

NormalDist(mu=100, sigma=12).pdf(98)
# 0.032786643008494994 
```

另请注意，该`NormalDist`对象还提供***累积分布函数***（`cdf`- 随机样本 X 小于或等于 x 的概率）：

```
NormalDist(mu=100, sigma=12).cdf(98)
# 0.43381616738909634 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2019-06-19T04:36:14.460

如果您想找到 x mean = 1 的 2 个值之间的区域；标准差 = 2；x 在 [0.5,2] 之间的概率

```
import scipy.stats
scipy.stats.norm(1, 2).cdf(2) - scipy.stats.norm(1,2).cdf(0.5) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-25T15:44:03.903

答案中提到的维基百科引用的公式不能用于计算正态概率。您必须使用该公式编写数值积分近似函数才能计算概率。

该公式计算概率密度函数的值。由于正态分布是连续的，因此您必须计算积分才能获得概率。维基百科网站提到了 CDF，它没有正态分布的封闭形式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-01-08T13:58:03.080

请注意，**probability**与前面的一些答案所指的**probability density** 不同。*概率*是变量具有特定值的机会，而*概率密度*是变量接近特定值的机会，即在一定范围内的概率。因此，要获得概率，您需要计算给定区间内概率密度函数的积分。作为一个近似值，您可以简单地将概率密度乘以您感兴趣的区间，这将为您提供实际概率。`pdf()`

 **```
import numpy as np
from scipy.stats import norm

data_start = -10
data_end = 10
data_points = 21
data = np.linspace(data_start, data_end, data_points)

point_of_interest = 5
mu = np.mean(data)
sigma = np.std(data)                                   
interval = (data_end - data_start) / (data_points - 1)
probability = norm.pdf(point_of_interest, loc=mu, scale=sigma) * interval 
```

上面的代码将为您提供变量在 -10 到 10 之间的正态分布中具有 21 个数据点的精确值 5 的概率（意味着间隔为 1）。您可以使用固定的间隔值，具体取决于您想要达到的结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-24T23:12:46.127

我写了这个程序来为你做数学。只需输入汇总统计信息。无需提供数组：

[人口比例的一个样本 Z 检验：](https://gist.github.com/db5023/76f1e4d494a5b5ccb604ee03a29a0ec8)

要对平均值而不是比例执行此操作，请相应更改 z 的公式

**编辑：**
这是链接中的内容：

```
import scipy.stats as stats
import math

def one_sample_ztest_pop_proportion(tail, p, pbar, n, alpha):
    #Calculate test stat

    sigma = math.sqrt((p*(1-p))/(n))
    z = round((pbar - p) / sigma, 2)

    if tail == 'lower':
        pval = round(stats.norm(p, sigma).cdf(pbar),4)
        print("Results for a lower tailed z-test: ")

    elif tail == 'upper':
        pval = round(1 - stats.norm(p, sigma).cdf(pbar),4)
        print("Results for an upper tailed z-test: ")

    elif tail == 'two':
        pval = round(stats.norm(p, sigma).cdf(pbar)*2,4)
        print("Results for a two tailed z-test: ")

    #Print test results
    print("Test statistic = {}".format(z))   
    print("P-value = {}".format(pval))
    print("Confidence = {}".format(alpha))

    #Compare p-value to confidence level
    if pval <= alpha:
        print("{} <=  {}. Reject the null hypothesis.".format(pval, alpha))
    else:
        print("{} > {}. Do not reject the null hypothesis.".format(pval, alpha))

#one_sample_ztest_pop_proportion('upper', .20, .25, 400, .05)

#one_sample_ztest_pop_proportion('two', .64, .52, 100, .05) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-01T16:33:46.170

您可以使用内置在数学库中的错误函数，如他们[网站上](http://docs.python.org/dev/library/math.html#math.erf)所述。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-24T11:25:23.063

我想说：提问者在问“如何计算给定数据点在给定均值和标准差的正态分布中的可能性？” 而不是“如何在给定均值和标准差的情况下计算正态分布中的概率？”。

对于“概率”，它必须在 0 和 1 之间，但对于“可能性”，它必须是非负的（不一定在 0 和 1 之间）。

您可以`multivariate_normal.pdf(x, mean= mean_vec, cov=cov_matrix)`在[scipy.stats.multivariate_normal](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.multivariate_normal.html)中使用来计算它。****

# grails - Grails 应用程序生成不正确的 sql

> ID：12412897
> 
> 赞同：0
> 
> 时间：2012-09-13T18:53:38.480
> 
> 标签：grails, grails-orm

我正在使用 Grails 2.1.0 和 Oracle 11。

我有一个域类，我试图连接到 Oracle 数据库中的表。当生成 SQL 以填充 list() 方法时，我得到 ORA-00918: column ambiguously defined。发生该错误是因为两次使用相同的别名请求了表的主键。这是生成的 SQL：

```
select * from ( select this_.BENCHMARK_CUSIP as BENCHMARK1_4_0_, this_.acronym as acronym4_0_, this_.as_of_date as as3_4_0_, this_.ask_price as ask4_4_0_, this_.ask_yield as ask5_4_0_, this_.benchmark_cusip as benchmark1_4_0_, this_.bid_price as bid6_4_0_, this_.bid_yield as bid7_4_0_, this_.coupon as coupon4_0_, this_.coupon_frequency as coupon9_4_0_, this_.is_on_the_run as is10_4_0_, this_.last_update_time as last11_4_0_, this_.last_update_user as last12_4_0_, this_.maturity as maturity4_0_, this_.name as name4_0_, this_.price as price4_0_, this_.source as source4_0_, this_.yield as yield4_0_ from BENCHMARK this_ ) where rownum <= ? 
```

正如你所看到的 this_.benchmark_cusip 因为 benchmark1_4_0 出现了两次。

这是我的域类

```
class Benchmark {
    String benchmarkCusip
    String acronym
    String name
    Double coupon
    java.math.BigDecimal couponFrequency
    Date maturity
    String isOnTheRun
    Date asOfDate
    Double bidYield
    Double yield
    Double askYield
    Double bidPrice
    Double price
    Double askPrice
    String source
    String lastUpdateUser
    Date lastUpdateTime

static mapping = {
    table 'BENCHMARK'        
    version false
   columns{id column:'BENCHMARK_CUSIP', generated:'assigned'}

} 
```

控制器只是定义为 def scaffold = true。

我假设我有一些配置错误，但对于我的生活，我无法在我可以从办公室访问的有限数量的网站上找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:10:08.143

通常我这样做：

```
class Benchmark {
  ...

  static mapping = {
    table 'benchmark'
    id column: 'benchmark_cusip', name: 'benchmarkCusip'
  }

} 
```

# php - 适用于 SQL Server 的 PHP 的 Microsoft Drivers 2.0 是否还在某处？

> ID：12412899
> 
> 赞同：3
> 
> 时间：2012-09-13T18:53:44.033
> 
> 标签：php, sql-server

所以 3.0 版在[Microsoft 的下载站点](http://www.microsoft.com/en-us/download/details.aspx?id=20098)。此外，该页面上有一行说

> 请注意，2.0 驱动程序的下载链接将在不久的将来被弃用

是的，这太棒了，但在要求之下

> PHP 5.3.6 或 PHP 5.4

我正在使用 5.2.x，对于我正在设计的应用程序，我真的不应该那么高。我只是无法通过谷歌搜索找到我需要的 php_sqlsrv.dll 文件的副本，但我确信它仍然在某个地方。有谁知道我在哪里可以得到副本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T18:56:25.120

[在PDO_SQLSRV](http://php.net/manual/en/ref.pdo-sqlsrv.php)的 PHP 文档页面上，有您需要的版本的下载。

[`SQLSRV20.EXE`](http://download.microsoft.com/download/C/D/B/CDB0A3BB-600E-42ED-8D5E-E4630C905371/SQLSRV20.EXE)（下载.microsoft.com）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-29T06:53:23.603

可以在这里找到 [http://technet.microsoft.com/en-us/library/cc296170(v=sql.105).aspx](http://technet.microsoft.com/en-us/library/cc296170(v=sql.105).aspx)

此行下方*的驱动程序版本 2.0 需要 Microsoft SQL Server 2008 R2 Native Client。单击下面的相应链接：*

[下载 X86 包](http://go.microsoft.com/fwlink/?LinkID=188400&clcid=0x409)

# javascript - 进度回调总是在 jquery-file-upload 插件中显示 100% 上传

> ID：12412901
> 
> 赞同：15
> 
> 时间：2012-09-13T18:53:47.443
> 
> 标签：javascript, jquery, jquery-plugins, file-upload

我想为 blueimp jquery-file-upload 插件实现一个进度条，但`progress`回调仅在上传开始并且 data.loaded == data.total 后立即触发一次。

```
<input data-url="/ads/32/photos" id="image" name="image" type="file" />

$(".upload-btn input").fileupload({
    dataType: "json",
    progress: function (e, data) {
        alert(data.loaded + "/" + data.total);
    },
    done: function (e, data) {
        alert("done");
    }
}); 
```

几秒钟后（上传完成时）完成回调被触发，我可以通过服务器日志确认上传成功。当我尝试使用`progressall`回调时，我也会得到相同的行为。

不确定它是否相关，但我目前不包括 jquery.fileupload-fp.js 库，因为添加它可以防止任何上传活动发生。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-10-22T15:03:56.253

进度函数`alert`是字符串“100%”吗？我对插件不熟悉，但函数中的表达式将所有内容都转换为`alert`类型。所以我希望它显示字符串“x/y”。`progress``String`

无论如何，您应该将`progress`功能更改为

```
alert( data.loaded / data.total ); // no quotes, no +'s 
```

如果这些属性 (`total`和`loaded`) 是正确的，那么它应该会给你你想要的行为。

编辑：为了澄清发生了什么，如果这回答了您的问题：`+`运算符根据其操作数的数据类型以不同的方式表现。如果将`+`两个数字放在一起，则它可以用作算术加法运算符。如果*其中一个*运算符是字符串，`+`则会首先将其他操作数更改为字符串，然后将它们*连接*起来。最终结果将是一个字符串，而不是一个数字。

```
var two = "2"; // two is a String data type
alert(two + 2); // Returns "22" as a String

var two = 2;
alert(two + 2); // Returns 4 
```

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Addition](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Addition)

# sql - 数据库结构 - 如何将用户链接到工作？

> ID：12412903
> 
> 赞同：3
> 
> 时间：2012-09-13T18:53:55.337
> 
> 标签：sql, database, database-design

我正在启动一个项目，人们可以在其中注册、登录他们的帐户并根据他们的位置和行业等搜索工作。

这些是我已经确定到目前为止我需要的表格，但是，我希望每个用户都能够申请工作并跟踪他们申请的工作。

例如，他们单击作业上的“应用”按钮，并将该特定作业添加到他们的帐户某处，然后允许我按照“SELECT * jobs WHERE（此用户已申请）”的行运行查询。

**tblUser：**
-userID
-firstname
-surname
-dob
-email
-address

**tblJob**
-jobID
-Title -Description -Position
(
全职*/兼职)*
-Salary
-DatePosted
***-userID?? <--作为FK？***-位置 ID -行业
ID

**tblIndustry**
-IndustryID
-IndustryName

**tblLocation**
-LocationID
-LocationName

这是否正确且有效？另外，对我可以添加的任何额外功能有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:55:53.903

你需要一张新桌子

```
user_applications
-----------------
user_id
job_id
application_dt
status 
```

类似的东西。不要将他的用户 ID 直接放在作业表中，如您所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:56:01.780

您可能想要一个`tblJobApplications`带有外键的表`tblUser`和`tblJob`表。

你会像这样查询它

```
SELECT * {or pick your specific fields here}
FROM tblJobApplications AS ja
INNER JOIN tblJob AS j ON ja.job_id = j.job_id
WHERE ja.user_id = ? 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:56:51.560

您需要多对多类型的关系，因此只需创建一个新表，该表将具有来自作业的 id 和来自用户的 id。此外，您需要制作两个主键。

编辑：

每次有人申请一份工作时，您都会在该表中插入工作的 ID 和用户的 ID。

# magento - Magento - 特定类别的产品列表

> ID：12412905
> 
> 赞同：0
> 
> 时间：2012-09-13T18:54:14.517
> 
> 标签：magento, grid, block

> **可能重复：**
> [如何在 magento 电子商务中从特定类别中获取产品](https://stackoverflow.com/questions/454462/how-to-get-products-from-a-particular-category-in-magento-ecommerce)

我想为 Magento 1.7 构建一个显示产品网格（名称、描述价格、带链接的小图像）的模板（.phtml 文件），类似于默认的“新产品”块。这是我到目前为止...

```
<?php

 $category=Mage::getModel('catalog/category')->load(4);  
 $category=$category->getProductCollection();
 foreach($category->getAllIds() as $id)
{
    $product=Mage::getModel('catalog/product')->load($id);
    echo $product->getName()."<br/>";
    echo $product->getUrl()."<br/>";
    echo $product->getImageUrl()."<br/>";
    echo $product->getImageDescription()."<br/><br/>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:26:25.973

您的代码中有几个错误，让我强调一下：

1.  `$category=$category->getProductCollection();`- 这是一个非常糟糕的做法。您将产品集合分配给以前是类别的变量。在这样的代码中很容易迷失方向。请记住为您的变量使用有意义的命名约定。这个应该是`$productCollection=$category->getProductCollection();`

2.  不是循环您已经拥有的集合，而是获取 id 数组，并循环遍历它们，在每个循环期间加载对象。这将导致内存泄漏和代码执行的大量时间。`foreach`语句应该是这样的： `foreach ($productCollection as $product)`.

3.  你实际上没有在这里问过问题。你说你要制作网格，并发布你的代码，但问题出在哪里？

4.  如果你想创建产品网格，请查看它是如何在 Magento 核心目录模块中完成的：块`Mage_Catalog_Block_Product_List`和模板 catalog/product/list.phtml

# implementation - 在遗传算法中应用变异来解决旅行商问题

> ID：12412909
> 
> 赞同：2
> 
> 时间：2012-09-13T18:54:22.857
> 
> 标签：implementation, genetic-algorithm, traveling-salesman, mutation

我正在从事一项小型学术任务，以使用遗传算法 (GA) 解决旅行商问题 (TSP)。我正在遵循一个非常简单的经典表示，将城市和旅游存储在数组中，例如，10 个城市的旅游可以表示为 9-1-0-4-3-8-6-5-2-7 等等。对 GA 有相当基本的了解，我对您将遵循哪种方法将不同类型的突变应用于 TSP 有点困惑。假设我们的路线表示为路线，突变率用变量 m_rate 表示。

**[1] 简单插入突变**

假设我们有：1-2-3-4-5-6-7-8-9。然后我们选择一个随机城市，比如索引 5，然后选择一个随机插入索引，比如 2，那么突变的染色体是：1-2-6-3-4-5-7-8-9。

现在这是我正在做的应用突变：

```
for (int i=0; i<route.length; i++) {
 if (m_rate<Math.random()) {
 // Pick a random city
 int randomCity =  0 + (int)(Math.random() * ( ((route.length-1) - 0) + 1));
 // Do the insertion and shift the array where appropriate
 }
} 
```

换句话说，我正在遍历路线中的每个城市并查看突变条件是否成立 (m_rate>Math.random())，如果是，那么我会在该索引处停下来，然后随机选择一个插入点，而不使用变异概率变量。只要没有遇到数组的末尾，我就会继续将相同的东西应用于其他所有剩余的城市或索引。这是正确的方法吗？应用第一个突变后，我应该停止还是跳出循环？突变概率是否应该以某种方式参与选择插入点？虽然这对我来说似乎没有多大意义。如果有可能不止一个城市在染色体或路线上发生突变，染色体有没有可能发生突变？换句话说，如果我最终进行第二次或第三次突变将染色体反转为其初始形式（突变之前）会发生什么？

**[2] 相互交换突变。**

在染色体中选择一个随机城市，然后选择第二个随机城市并交换两者。例如，在路线 1-5-2-8-0-9-3-7-4-6 中。如果我们最终选择索引 2 和索引 7，那么突变的染色体是：1-5-7-8-0-9-3-2-4-6。

我正在遵循与上述插入突变类似的方法，遍历路线中的每个城市并检查概率条件，然后直接选择一个随机城市进行交换，而不应用任何类型的突变率。上面同样的问题在这里适用..

**[3] 反转突变。**

这是最棘手的一个。给定一个像这样的染色体：1-2-3-4-5-6-7-8-9，我们选择一个像索引 2 到索引 5 的突变切割，然后反转那个子路径 ==> 1-2-6-5- 4-3-7-8-9。

但是你如何应用这个？你是不是循环遍历路线，然后根据突变率选择一个城市，然后直接选择另一个指标来确定子路线的长度？突变一次并退出？在这种实现中，如果我们的突变切割最终是 0-9 或 0-(length-1) ，整个染色体或路线是否可以突变以反转整个事物？在这种情况下，突变率的真正价值是什么？我有点迷失在这里...

我提前道歉，因为它太长了。但我会很感激任何关于这些问题的评论，或者如果有人可以指导我到任何详细讨论这些事情的资源。我看过很多研究论文，但没有多少人接触过这种细节和细节。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:45:04.960

选择突变时，您有几个选项：

*   您可以允许突变产生无效/非法的染色体并对其进行差评。这意味着 GA 将同时搜索正确性（清除非法结果）和最佳结果。
*   您可以编写一个仅产生有效/合法输出的突变函数。

第一个选项可以让您编写更简单、更自然的染色体突变。但是，您可能需要扩展表示（例如，允许 12 或 15 个插槽用于 10 个城市的游览），并且算法将需要更长的时间才能收敛。如果必须评估正确性，您的评分函数可能会更昂贵。您可以灵活地解释染色体的解释方式（例如，忽略第二次出现的目的地）。

出于同样的原因，第一个选项也可以简化您的交叉实现。

第二种选择通常会更快地收敛，但可能更难避免影响结果的变异函数中的细微偏差。

您建议的表示和突变类似于 TSP 的非 GA 近似值，它依赖于交换，然后进行改进测试。模拟退火是决定接受哪些转置的一种方法。

GA 实现可能需要一种完全不同的染色体来使交叉和突变自然。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T05:18:22.957

我认为最好的选择是使用反转进行突变和交叉使用 OX（有序）。我写了一个 GA 来解决 TSP，它工作得很好。在我的情况下，当应用反转时，我选择两个随机点（它可能是整个字符串）但不是相同的点。最好的结果是突变率为 0.2/0.3，交叉率为 0.8，但这取决于您的选择机制.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T22:46:42.863

反演通常是解决 TSP 的最佳工作变异算子。您可以下载并使用[HeuristicLab](http://dev.heuristiclab.com)进行试验，其中包括更多这样的变异算子和交叉。它允许您定义实验，您可以在其中与每个操作员一起运行 GA 几次，看看哪个效果最好。有一些视频教程可以帮助您入门。它是开源的，因此您还可以查看实现。

# header - 页面渲染时如何使用jquery检查响应头

> ID：12412910
> 
> 赞同：2
> 
> 时间：2012-09-13T18:54:25.983
> 
> 标签：header, response

是否可以检查 $(document).ready 函数中的响应标头？在我们的一个 java 应用程序中，在一些 html 页面前面放置了一个过滤器，该过滤器用于通过设置响应头信息来确定是否应采取某些操作。我需要在用户单击链接进入此 html 页面后立即知道该信息。

# dart - 我可以使用编辑器在生产模式下运行 Dart 程序吗？

> ID：12412913
> 
> 赞同：2
> 
> 时间：2012-09-13T18:54:42.293
> 
> 标签：dart

我想在生产模式而不是检查模式下运行我的 Dart 程序。我正在使用飞镖编辑器。我可以控制运行时模式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T18:54:42.293

确实可以！在“管理启动”中找到“以选中模式运行”复选框。取消选中此项将在生产模式下运行您的 Dart 程序。

请记住，在生产模式下，静态类型注释被忽略。

# asp.net - 如何编辑 web.config 以停止提供 .NET Web 应用程序的特定文件类型

> ID：12412915
> 
> 赞同：8
> 
> 时间：2012-09-13T18:54:43.853
> 
> 标签：asp.net, .net, iis, web-config

我想阻止用户通过浏览器访问某种类型的文件。例如，IIS 服务器默认阻止访问 .config 和 .vb 文件，给出错误消息“您请求的页面类型未提供，因为它已被明确禁止”，我想添加其他文件类型到这种行为。

有什么可以添加到应用程序的 web.config 文件中的吗？我宁愿不通过使用该`<authorization>`元素阻止目录访问来处理它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-26T13:34:27.750

在 IIS 7+ 中，可以在应用程序级别完成请求过滤。在 web.config 中添加以下代码：

```
<system.webServer>
    <security>
        <requestFiltering>
            <fileExtensions>
                <add fileExtension=".vbs" allowed="false" />
            </fileExtensions>
        </requestFiltering>
    </security>
</system.webServer> 
```

对于 IIS 6，上述方法不起作用，但您可以模仿 .cs 文件等页面存在的默认阻止行为，尽管您可能必须在服务器端进行更改。首先，将以下内容添加到您应用的 web.config 中：

```
<system.web>
    <httpHandlers>
        <add path="*.vbs" verb="*" type="System.Web.HttpForbiddenHandler" validate="True"/>
    </httpHandlers>
</system.web> 
```

如果 asp.net 设置为处理该文件类型，例如 .cs，那么您就完成了。但是，如果您要阻止的文件类型由 IIS 处理，而不是 asp.net（如 .vbs），这还不够。您必须在 IIS 管理器中进行更改以映射文件扩展名，如下[所示](http://blog.tylerholmes.com/2008/10/stop-aspnet-from-serving-specific-file.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:56:42.280

您可以尝试使用`location`Web.Config 中的节点

```
<location path=".">
        <system.web>
            <authorization>
                <!-- Order and case are important below -->
                <allow roles="Admin"/>
                <deny users="*"/>
            </authorization>
        </system.web>
    </location> 
```

使用路径`"."`将应用于当前文件夹和所有嵌套文件夹。可以提供更具体的路径。您还可以在文件夹层次结构中嵌套 web.configs，以轻松地使一个文件夹或多或少地被允许。

链接：http: [//msdn.microsoft.com/fr-fr/library/b6x6shw7.aspx](http://msdn.microsoft.com/fr-fr/library/b6x6shw7.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T19:01:08.680

**为什么要将非 Web 服务的文件存储在通过 IIS 可用的文件夹中**？我通常会做类似的事情：

```
\www.mywebsite.com\wwwroot\
\www.mywebsite.com\secureimages\
\www.mywebsite.com\virutaldirectories\ 
```

在 IIS 中，我的 wwwroot 是我网站的根目录，而我的 MVC 应用程序是通过[This.File](http://msdn.microsoft.com/en-us/library/dd492492%28v=vs.108%29.aspx)来自 secureimages 目录的服务图像，因此除非我通过编程方式允许，否则这些图像不可用。我假设您的程序也在提供文件，如果是这样，这些文件不需要以任何方式提供给 IIS 直接作为文件提供服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T20:38:46.647

如果您使用的是 IIS 7，这可以在 ApplicationHost.config 级别上完成。

[http://www.iis.net/learn/get-started/planning-your-iis-architecture/introduction-to-applicationhostconfig](http://www.iis.net/learn/get-started/planning-your-iis-architecture/introduction-to-applicationhostconfig)

请求过滤部分： [http ://www.iis.net/configreference/system.webserver/security/requestfiltering](http://www.iis.net/configreference/system.webserver/security/requestfiltering)

文件将显示为 404 返回码。

*注意：由于此配置位于根级别，因此更改适用于该服务器上运行的所有应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T18:56:29.113

您必须设置 IIS 以通过 .NET 管道运行这些文件请求。一个更好的策略是一开始就阻止来自 IIS 的项目。这样一来，您就不必为了阻止文件而通过 .NET 管道运行 PDF 等开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-13T21:06:16.130

请求过滤应该这样做。它没有明确的扩展名。您可以在 URL 上使用正则表达式。

[IIS 7.0 请求过滤和 URL 重写](http://www.iis.net/learn/extensions/url-rewrite-module/iis-request-filtering-and-url-rewriting)

# windows - Windows XP 上的 Vc++ 2012 Express

> ID：12412919
> 
> 赞同：2
> 
> 时间：2012-09-13T18:54:56.017
> 
> 标签：windows, visual-c++, windows-xp

我很高兴得知最近发布了 Visual Studio 2012 Express for Desktop。

[http://www.microsoft.com/en-us/download/details.aspx?id=34673](http://www.microsoft.com/en-us/download/details.aspx?id=34673)

但后来我发现我显然不能使用它。我仍然在 XP 上，因为我现在买不起升级，而且这些工具根本无法安装。我安装了 2008 和 2010 似乎可以正常工作，但无论出于何种原因，2012 都没有。

基本上，我只需要编译器（而不是 Visual Studio IDE）。我使用 CodeBlocks 作为我的 IDE。有谁知道是否可以只安装和使用编译器？我非常希望将 C++11 与它带来的新优化一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:01:06.777

我相信编译器只是[.NET 框架](http://www.microsoft.com/net)，或者至少我理解 SharpDevelop 使用它来编译其代码。所以，我的猜测是 Visual Studio 2012 使用的是 .NET 4.5，这意味着你在 XP 上运行时运气不佳。微软已经开始结束它的生命周期。

# ruby-on-rails - gem bootstrap-sass 和 gem twitter-bootstrap-rails 有什么区别

> ID：12412921
> 
> 赞同：15
> 
> 时间：2012-09-13T18:55:05.640
> 
> 标签：ruby-on-rails, ruby, twitter-bootstrap

我正在努力希望有一天能够从内存中构建一个 Rails 应用程序。我正在关注 Hartl 的书，今天决定尝试使用 Rails casts 中的快速操作，因为它看起来很简单。它们都涉及 twitter boostrap。这是我需要帮助的地方

**根据 Hartl 的教程gem bootstrap-sass**工作正常，根据 RailsCasts 教程
**gem twitter-bootstrap-rails**没有工作，因为我必须安装 Python 等。

所以，作为一个完全不懂编程和网络开发的菜鸟，我想知道如果它们都依赖于 Twitter Bootstrap 产品，它们之间有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-13T19:40:19.730

第一个是将 bootstrap less 文件转换为 sass 文件。要集成它，您必须将这些文件复制到您的项目中。要更新它，您必须再次复制这些文件的新版本。

第二个使用较少，它是一个提供一些额外功能（如生成器）的 gem。集成是通过捆绑器和进一步更新完成的。

我更喜欢第一个解决方案。更容易保持控制。它也没有那么神奇，因此集成更简单，错误意识更少。

这是可用的 rails 引导解决方案的一个很好的[比较和解释](http://rubysource.com/twitter-bootstrap-less-and-sass-understanding-your-options-for-rails-3-1/)。

# html - 边距和图像问题

> ID：12412924
> 
> 赞同：2
> 
> 时间：2012-09-13T18:55:25.767
> 
> 标签：html, css, margin

对于我的生活，我无法弄清楚为什么这里的某些图像上的边距不能正确渲染。在第一个和第二个横向图像之后，边距与其上方的图像/容器重叠。

任何人都可以解释一下吗？

[http://jsfiddle.net/JeffPannone/rDw6R/17/](http://jsfiddle.net/JeffPannone/rDw6R/17/)

*对不起大家。我之前提供了错误的 jsfiddle 链接。我在这里更正了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:59:01.310

一种选择是设置`overflow:auto`为 div。

**[jsFiddle 示例](http://jsfiddle.net/j08691/rDw6R/9/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:57:56.747

您的图像的边距可能会从 div 中[折叠](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)出来，因为您的 div 没有边框或填充。

我正在添加一些 W3C 文档，但是要在几行中为您提供关于边距崩溃的清晰描述有点过分。只需点击上面的链接了解详细信息。

一个简单的解决方法是向`1px 0`div 添加一个填充。

[http://jsfiddle.net/rDw6R/1/](http://jsfiddle.net/rDw6R/1/)

# maven - Maven：在本地文件系统中使用插件

> ID：12412927
> 
> 赞同：0
> 
> 时间：2012-09-13T18:55:41.650
> 
> 标签：maven

我是 Maven 新手并制作了一个 hello world maven 插件（如此处教程：[http](http://maven.apache.org/guides/plugin/guide-java-plugin-development.html) ://maven.apache.org/guides/plugin/guide-java-plugin-development.html ）。

我还有一个 hello world maven*项目*（不是插件），如下所述：[http ://maven.apache.org/guides/getting-started/maven-in-five-minutes.html](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)

现在，我希望项目包含 hello-world 插件，因为该插件有一个我想要运行的“sayhi”目标。

我该怎么做呢？什么是绝对最简单、最快的方式，什么是最“正确”的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:05:09.003

1.  在插件上运行`mvn install`，以便将其安装在本地 Maven 存储库中。
2.  在另一个项目中，在`<plugin>`下面添加一个元素`<build>`：

例如：

```
<build>
    <plugins>
        <plugin>      
            <groupId>your-groupid</groupId>
            <artifactId>your-artifactId</artifactId>
            <version>...</version>
        </plugin>
    </plugins>
    ... 
```

# java - 目录流 以随意的方式列出文件

> ID：12412938
> 
> 赞同：-1
> 
> 时间：2012-09-13T18:56:15.623
> 
> 标签：java, image-processing, path, directory

我必须从文件夹中检索一组 JPG 文件，以便我可以用它创建电影。问题是文件以随意的方式列出，因此以随意的方式处理。这是一个屏幕截图：
![在此处输入图像描述](../Images/916f757fb9275cb6c260ac8da0f09fb0.png)

我需要它们按顺序排列为 img0,img1 .....imgn
我该怎么做？
**我开发了一个自定义排序方案，但出现异常。编码在这里给出：“

```
try{
                int totalImages = 0;
                int requiredImage = 0;
                jpegFiles = Files.newDirectoryStream(Paths.get(pathToPass).getParent(), "*.JPG");
                Iterator it = jpegFiles.iterator();
                Iterator it2 = jpegFiles.iterator();
                Iterator it3 = jpegFiles.iterator();
                while(it.hasNext()){
                    it.next();
                    totalImages++;
                }
                System.out.println(totalImages);
                sortedJpegFiles = new String[totalImages];
                while(it2.hasNext()){
                    Path jpegFile = (Path)it2.next();
                    String name = jpegFile.getFileName().toString();
                    int index = name.indexOf(Integer.toString(requiredImage));
                    if(index!=-1){
                        sortedJpegFiles[requiredImage] = jpegFile.toString();
                    }
                    requiredImage++;
                }
                for(String print : sortedJpegFiles){
                    System.out.println(print);
                }

            }catch(IOException e){
                e.printStackTrace();  
            } 
```

**例外**：

```
Exception in thread "AWT-EventQueue-0" java.lang.IllegalStateException: Iterator already obtained
    at sun.nio.fs.WindowsDirectoryStream.iterator(Unknown Source)
    at ScreenshotDemo.SCapGUI$VideoCreator.run(SCapGUI.java:186)
    at ScreenshotDemo.SCapGUI$1.windowClosing(SCapGUI.java:30)
    at java.awt.Window.processWindowEvent(Unknown Source)
    at javax.swing.JFrame.processWindowEvent(Unknown Source)
    at java.awt.Window.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$200(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:59:39.827

# 自定义比较器

您必须提取数字部分，可能使用一些正则表达式，然后使用它进行排序。自定义[`Comparator`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)可能会为您封装自定义数值比较。

```
import java.util.*;
import java.util.regex.*;

// Sort strings by last integer number contained in string.
class CompareByLastNumber implements Comparator<String> {
    private static Pattern re = Pattern.compile("[0-9]+");
    public boolean equals(Object obj) {
        return obj != null && obj.getClass().equals(getClass());
    }
    private int num(String s) {
        int res = -1;
        Matcher m = re.matcher(s);
        while (m.find())
            res = Integer.parseInt(m.group());
        return res;
    }
    public int compare(String a, String b) {
        return num(a) - num(b);
    }
    public static void main(String[] args) {
        Arrays.sort(args, new CompareByLastNumber());
        for (String s: args)
            System.out.println(s);
    }
} 
```

# 避免`IllegalStateException`

`DirectoryStream`参考您更新的问题：您遇到的异常是因为您尝试多次迭代。引用[其参考](http://docs.oracle.com/javase/7/docs/api/java/nio/file/DirectoryStream.html)：

> 虽然`DirectoryStream`extends `Iterable`，它不是通用的`Iterable`，因为它只支持一个`Iterator`; 调用迭代器方法以获得第二个或后续迭代器 throws `IllegalStateException`。

所以你看到的行为是可以预料的。您应该将所有文件收集到一个列表中。这些方面的东西：

```
List<Path> jpegFilesList = new ArrayList<>();
while (Path p: jpegFiles)
  jpegFilesList.add(p);
sortedJpegFiles = new String[jpegFilesList.size()];
for(Path jpegFile: jpegFilesList) {
  …
} 
```

*请注意，这个关于 IllegalStateException 的问题与您提出的原始问题截然不同。所以最好单独提出一个问题。请记住，SO[不是论坛](https://meta.stackexchange.com/a/92110)。所以请坚持每个问题一个问题。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T18:59:59.507

这些文件是按字典顺序排列的，这对人类来说可能看起来不自然，但对于计算机来说却是完全合乎逻辑的。
如果您不想自己做，有几种算法可以根据“人类逻辑”进行排序，一个例子是[The Alphanum Algorithm](http://www.davekoelle.com/alphanum.html)。

# java - Gdata youtube api 用户提要返回 -1

> ID：12412945
> 
> 赞同：1
> 
> 时间：2012-09-13T18:56:27.887
> 
> 标签：java, xml, xml-parsing, youtube-api, gdata

我一直在关注 youtube 教程，并将真实性令牌作为会话长度令牌并将其存储在数据库中。现在当我做

```
String feedUrl = "http://gdata.youtube.com/feeds/api/users/default/uploads";
VideoFeed videoFeed = service.getFeed(new URL(feedUrl), VideoFeed.class);
System.out.println(videoFeed.getStartIndex());
System.out.println(videoFeed.getXmlBlob().getBlob()); 
```

`default`是经过身份验证的默认用户。我为 xml blob 收到 -1`startindex`和 null。有谁知道这个问题？

我可以成功地将视频从网络浏览器上传给经过身份验证的用户。

# events - 在 Ember 视图中捕获图像加载/错误

> ID：12412956
> 
> 赞同：1
> 
> 时间：2012-09-13T18:56:47.973
> 
> 标签：events, ember.js, onload, onerror

试图在 EmberJS 视图把手模板中捕获图像的加载和错误事件。我可以让它连接起来的唯一方法是在 didInsertElement 视图函数中捕获 jQuery 事件。但这不是一种非常 Ember 的做事方式，我尝试像使用单击事件一样绑定事件，但没有运气。

这是一个显示问题的 JSFiddle：http: [//jsfiddle.net/qCaA2/5/](http://jsfiddle.net/qCaA2/5/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T10:57:47.497

这是我能想到的最优雅的：

[http://jsfiddle.net/4Je9L/5/](http://jsfiddle.net/4Je9L/5/)

我本来希望这样做，但它不起作用，我不确定为什么不这样做：

[http://jsfiddle.net/7JXhA/3/](http://jsfiddle.net/7JXhA/3/)

如果您查看加载事件的 jQuery 文档 (http://api.jquery.com/load-event/)，似乎这些事件可能无法像其他 DOM 事件那样通过委托来处理。这可能是根本问题。

# python - 找不到 Django 包测试

> ID：12412958
> 
> 赞同：3
> 
> 时间：2012-09-13T18:56:55.923
> 
> 标签：python, django, unit-testing

我手头有一个奇怪的问题。

我正在创建一个 django 包，并想为它提供一些测试用例。

该包名为 ajax_forms，完整路径是我的 PYTHONPATH 的一部分。该目录还包含一个测试目录（带有`__init__.py`文件）、一个 tests.py 文件（包含测试）和一个 urls.py 文件。

现在我想运行测试。

ajax_forms 父目录在 INSTALLED_APPS 中有一个带有 ajax_forms 的示例项目设置。

但我似乎不能让测试运行：

```
 >> ./manage.py test ajax_forms
Creating test database for alias 'default'...

----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK
Destroying test database for alias 'default'... 
```

没有找到测试，所以我尝试更具体：

```
 >> ./manage.py test ajax_forms.tests
....
raise ValueError("Test label '%s' does not refer to a test" % label)
ValueError: Test label 'ajax_forms.tests' does not refer to a test
(ajax-validation) 
```

甚至 ./manage.py ajax_forms.tests.tests.AjaxFormViewTest 也不会找到测试并给出与上述相同的错误。

但是尝试从 ./manage.py shell 导入测试用例可以正常工作

```
In [2]: from ajax_forms.tests.tests import AjaxFormViewTest 
```

我有点不知所措，不知道发生了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T19:04:12.873

你需要把`from tests import *`你的`__init__.py`文件

Django 将在您的应用程序中查找名为测试的包/模块，然后查询其命名空间以获取测试用例。在这种情况下，它将查看您的测试包的命名空间（来自**init** .py 文件），并且在那里什么也没有发现。通过在`__init__.py`文件中进行导入，您将测试模块中的测试用例导入到测试包的命名空间中，django 将能够找到它们并运行它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T19:16:35.927

这个问题的另一个解决方案是使用更智能的测试运行器。您可以尝试`nose`-`django_nose`它会在这种情况下发现测试。如果您不想安装其他应用程序，@Ctrlspc 解决方案是解决此问题的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:43:53.993

您可以`models.py`在应用程序中添加一个文件，将新应用程序添加到已安装的应用程序中，django 将找到 tests.py 文件，而无需向`__init__.py`.

我猜@Ctrlspc 方法和这个方法都有点脏。所以任何选择都可以

# python - 泡菜依赖失败

> ID：12412959
> 
> 赞同：2
> 
> 时间：2012-09-13T18:57:06.787
> 
> 标签：python, cross-platform, pickle, python-2.x

取消在 Linux 上创建的对象并（尝试）在 Windows 上取消腌制时，我遇到了模块依赖失败。泡菜在 Linux 中正确解压，但在 Windows 中失败。两个系统都运行 Python 2.6。

我研究了 pickle 手册页（特别关注让 unpickle 环境与 pickle 环境相同），以及这里的几条很好的建议——但我仍然很难过。大多数人建议确保 sys.modules 正确并已加载。以下是一些片段，显示了我正在尝试的内容：

酸洗代码：

```
...
pickle_fp = self.getPickleFile('wb')
pickler = Pickler(pickle_fp, protocol=2)
pickler.dump(archive)
pickle_fp.close()
... 
```

在 unpickling 代码中，我添加了一行来打印 sys.modules 字典，以便我们可以看到存在的模块：

```
...
pickle_fp = self.getPickleFile('rb')
unpickler = Unpickler(pickle_fp)
pprint.pprint(sys.modules)
package = unpickler.load()
pickle_fp.close()
... 
```

当我在 Linux 中运行 unpickle 时，它​​工作得很好。当我尝试在 Windows 上解压缩在 Linux 上生成的泡菜时，我得到：

```
...
ImportError: No module named photo_data 
```

至于环境，`pprint.pprint(sys.modules)`生产，在Linux上

```
...
'photo_data': <module 'photo_data' from 
'/home/xxx/Desktop/PythonPhoto/photo_data.pyc'>,
... 
```

在 Windows 上

```
...
'photo_data': <module 'photo_data' from                       
'C:\Users\xxx\git\PhotoManagement\Photo\src\photo_data.pyc'>,
... 
```

所以在我看来，我已经`photo_data`在环境中获得了模块。我尝试在没有协议的情况下使用 pickle（默认为 0），并尝试运行 unix2dos 来剥离字符。我被正式难住了。

谢谢你的帮助！

* * *

根据评论中的建议，我生成了最简单的不起作用的案例。我正在酸洗的课程如下所示：

```
class photo_data:
    def __init__(self):
        self.isdir = False
        self.size = 0
        self.mtime = -(sys.maxint - 1) #Set default time to very old
        self.timestamp = datetime.datetime.strptime('1700:1:1 00:00:00', '%Y:%m:%d %H:%M:%S')
        self.gotTags = False
        self.signature = ''
        self.fileMD5 = ''
        self.userTags = ''
        self.inArchive = False
        self.candidates = []
        self.dirpaths = []
        self.filepaths = []      

class photo_collection:  #This class should be data only

    def __init__(self):
        self.host = ''
        self.path = ''
        self.photo = dict()
        self.pickle = None
        self.datasetChanged = False

    def __getitem__(self, key):
        return self.photo[key]

    def __setitem__(self, key, value):
        self.photo[key] = value 
```

在我的用例中，`photo_collection`对象被实例化，字典`self.photo`中填充了`photo_data`. 在系统之间工作的最简单的情况是其中包含一张照片的目录，而任意复杂的情况*在*系统内工作。在系统之间不起作用的最简单的情况是一个包含一张照片的目录和一个也包含一张照片的子目录。

根据要求，我附上了两个保存在`format = 0`. 如果你比较它们，我会发现程序以不同的顺序下降文件树（可能并不奇怪，因为我在系统和操作系统之间复制了目录），但除此之外，它们似乎以相同的结构打开和关闭，而不是文件-具体数据。我看不到如何将文件上传到单独的位置，因此我将它们直接包含在此处。

这是 Windows 生成的泡菜：

```
(iphoto_data
photo_collection
p0
(dp1
S'path'
p2
S'C:\\Users\\scott_jackson\\Desktop\\phototest'
p3
sS'host'
p4
S'4DAA1001312'
p5
sS'pickle'
p6
NsS'datasetChanged'
p7
I01
sS'photo'
p8
(dp9
S'C:\\Users\\scott_jackson\\Desktop\\phototest\\img_4697.jpg'
p10
(iphoto_data
photo_data
p11
(dp12
S'isdir'
p13
I00
sS'dirpaths'
p14
(lp15
sS'filepaths'
p16
(lp17
sS'timestamp'
p18
cdatetime
datetime
p19
(S'\x07\xda\x04\x12\x124&\x00\x00\x00'
p20
tp21
Rp22
sS'gotTags'
p23
I01
sS'signature'
p24
S'9b2ca527b2bf0865d9b87ecd2a68d417'
p25
sS'fileMD5'
p26
S''
p27
sS'candidates'
p28
(lp29
sS'mtime'
p30
F1347576558.0
sS'inArchive'
p31
I00
sS'userTags'
p32
S'NA'
p33
sS'size'
p34
L6489323L
sbsg3
(iphoto_data
photo_data
p35
(dp36
g13
I01
sg14
(lp37
S'C:\\Users\\scott_jackson\\Desktop\\phototest\\060101 Nags Head'
p38
asg16
(lp39
g10
asg18
g19
(S'\x06\xa4\x01\x01\x00\x00\x00\x00\x00\x00'
p40
tp41
Rp42
sg23
I00
sg24
g27
sg26
g27
sg28
(lp43
sg30
I-2147483646
sg31
I00
sg32
g27
sg34
I0
sbsS'C:\\Users\\scott_jackson\\Desktop\\phototest\\060101 Nags Head\\img_1150.jpg'
p44
(iphoto_data
photo_data
p45
(dp46
g13
I00
sg14
(lp47
sg16
(lp48
sg18
g19
(S'\x07\xd6\x01\x01\x11\t#\x00\x00\x00'
p49
tp50
Rp51
sg23
I01
sg24
S'5925063685af0d741a23fe6d75523741'
p52
sg26
g27
sg28
(lp53
sg30
F1347751812.0
sg31
I00
sg32
g33
sg34
L538233L
sbsS'C:\\Users\\scott_jackson\\Desktop\\phototest\\060101 Nags Head'
p54
(iphoto_data
photo_data
p55
(dp56
g13
I01
sg14
(lp57
sg16
(lp58
g44
asg18
g19
(S'\x06\xa4\x01\x01\x00\x00\x00\x00\x00\x00'
p59
tp60
Rp61
sg23
I00
sg24
g27
sg26
g27
sg28
(lp62
sg30
I-2147483646
sg31
I00
sg32
g27
sg34
I0
sbssb. 
```

这是 Linux 生成的 pickle：

```
(iphoto_data
photo_collection
p0
(dp1
S'path'
p2
S'/home/scott/phototest'
p3
sS'host'
p4
S'barney'
p5
sS'pickle'
p6
NsS'datasetChanged'
p7
I01
sS'photo'
p8
(dp9
S'/home/scott/phototest/060101 Nags Head/img_1150.jpg'
p10
(iphoto_data
photo_data
p11
(dp12
S'isdir'
p13
I00
sS'dirpaths'
p14
(lp15
sS'filepaths'
p16
(lp17
sS'timestamp'
p18
cdatetime
datetime
p19
(S'\x07\xd6\x01\x01\x11\t#\x00\x00\x00'
p20
tp21
Rp22
sS'gotTags'
p23
I01
sS'signature'
p24
S'5925063685af0d741a23fe6d75523741'
p25
sS'fileMD5'
p26
S''
p27
sS'candidates'
p28
(lp29
sS'mtime'
p30
F1347751812.0842018
sS'inArchive'
p31
I00
sS'userTags'
p32
S'NA'
p33
sS'size'
p34
I538233
sbsS'/home/scott/phototest/060101 Nags Head'
p35
(iphoto_data
photo_data
p36
(dp37
g13
I01
sg14
(lp38
sg16
(lp39
g10
asg18
g19
(S'\x06\xa4\x01\x01\x00\x00\x00\x00\x00\x00'
p40
tp41
Rp42
sg23
I00
sg24
g27
sg26
g27
sg28
(lp43
sg30
I-9223372036854775806
sg31
I00
sg32
g27
sg34
I0
sbsS'/home/scott/phototest/img_4697.jpg'
p44
(iphoto_data
photo_data
p45
(dp46
g13
I00
sg14
(lp47
sg16
(lp48
sg18
g19
(S'\x07\xda\x04\x12\x124&\x00\x00\x00'
p49
tp50
Rp51
sg23
I01
sg24
S'9b2ca527b2bf0865d9b87ecd2a68d417'
p52
sg26
g27
sg28
(lp53
sg30
F1347576558.5344362
sg31
I00
sg32
g33
sg34
I6489323
sbsg3
(iphoto_data
photo_data
p54
(dp55
g13
I01
sg14
(lp56
S'/home/scott/phototest/060101 Nags Head'
p57
asg16
(lp58
g44
asg18
g19
(S'\x06\xa4\x01\x01\x00\x00\x00\x00\x00\x00'
p59
tp60
Rp61
sg23
I00
sg24
g27
sg26
g27
sg28
(lp62
sg30
I-9223372036854775806
sg31
I00
sg32
g27
sg34
I0
sbssb. 
```

请随意将这些粘贴到您最喜欢的“比较”编辑器中；我对泡菜知之甚少，无法发现问题。

在此先感谢您的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T00:50:51.413

我已经通过在我的 Mac OS X 机器上保存带有 CRLF (Windows) 行结尾的泡菜来重现您的问题。

泡菜机器对换行非常讲究。如果使用非二进制传输模式保存或复制泡菜（例如，在 Windows 上使用文本编辑器重新保存、使用 ASCII FTP 传输复制、从网站保存为文本文件等），泡菜*将*被添加 CR 字符。

现在，问题是 pickle.py 中的这一行：

```
module = self.readline()[:-1] 
```

如果您提供的文件`Unpickler`已打开`'rb'`但包含 CRLF，则这些行将显示为`module = "photo_data\r"`，这不是有效的模块名称。导入后，错误将显示为

```
ImportError: No module named photo_data 
```

在（非常偷偷摸摸！）之后有一个*未打印*的回车。`photo_data`

解决方案是确保您以二进制方式传输文件，并且*不要*`unix2dos`在 pickle 上运行或任何类似的实用程序。或者，如果使用协议 0（文本）泡菜，则可以安全地使用`'rU'`（通用换行模式）打开泡菜文件。

另请参阅[Pickled 文件不会在 Mac/Linux 上加载](https://stackoverflow.com/questions/283766/pickled-file-wont-load-on-mac-linux)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-03T13:01:38.317

**我今天遇到了类似的问题：正如@nneonneo**在他的回答中解释的那样，由于 CRLF 行结尾，在 linux 上腌制的对象无法在 Windows 上加载。

问题是 git 认为`.pkl`对象是文本文件，并且它应该规范化行尾。因此，当我在 linux 机器上推送带有二进制`.pkl`文件的项目，并在 windows 机器上拉取它们时，行尾是 CRLF 而不是 unix 行尾。解决方案是将`.gitattributes`文件添加到 repo

```
*.pkl binary 
```

强制 git 根本不操作文件。

[然后，您可以按照此处](https://help.github.com/articles/dealing-with-line-endings/#refreshing-a-repository-after-changing-line-endings)的建议“刷新”更改。我改为在 Windows 机器上删除并再次克隆该项目。

# ios - 在 UIDeviceOrientation 更改后为 iOS 中的 OpenGLES 调整 2D 屏幕坐标系

> ID：12412960
> 
> 赞同：1
> 
> 时间：2012-09-13T18:57:13.107
> 
> 标签：ios, opengl-es

我有一个 iOS OpenGLES 2D 项目（绘制精灵），我在其中成功检测到 UIDeviceOrientation 更改。我相信我接下来需要根据设备的方向相应地调整屏幕坐标，我想知道是否有人对最佳方式有任何技巧或见解。

当然，我可以对每个方向进行一些转换并将其输入到绘制到 OpenGLES 的代码中，但这似乎过于复杂。这意味着有某种类型的逻辑来自定义旋转每个绘图并为每个方向以不同的方式跟踪精灵的方向。

我只是想知道是否有人对最有效的方法有想法。（要确保我们没有过度思考）。最好的解决方案是将屏幕坐标自动重置为每个方向的默认方向坐标系。但是，手动操作当然是可行的。

# android - 如果未满足清单权限，则强制 adb install 失败

> ID：12412963
> 
> 赞同：1
> 
> 时间：2012-09-13T18:57:17.030
> 
> 标签：android, adb

Galaxy Tab 2 7" 没有出现在市场上，事实证明这是由于没有自动对焦。

adb 将 apk 安装在设备上而不会引发任何投诉。

`adb install`如果不满足 Manifest 权限，如何强制失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:01:15.857

我以前遇到过同样的问题。ADB 与功能无关，但我发现在开发期间检查 Application.onCreate 中所需的功能很有帮助。

# objective-c - [__NSCFSet stringByAppendingFormat:]：无法识别的选择器发送到实例

> ID：12412964
> 
> 赞同：0
> 
> 时间：2012-09-13T18:57:20.890
> 
> 标签：objective-c, ios, nsstring

我有一个 pinpad 类，每次输入后都会对其上的按钮进行打乱。该类作为一个单独的项目可以完美地工作，但是当添加到一个特定的项目时，我会收到一条`[__NSCFSet stringByAppendingFormat:]: unrecognized selector sent to instance`消息。这是触发该消息的方法：

```
-(void)touchedButtonInCell:(id)sender
{
    // Obtain the current number string entered from the pinpad.
    _pinpadNumber = [_pinpadNumber stringByAppendingFormat:@"%i", [sender tag]];

    // Verification of values
    NSLog(@"%i", [sender tag]);
    NSLog(@"%@", _pinpadNumber);

    // Check the entry of the PINPAD_NUMBER_LENGTH character/number
    if ([_pinpadNumber length] >= PINPAD_NUMBER_LENGTH)
    {
        // Trigger delegate method to handle the pin pad number received.
        if ([_delegate respondsToSelector:@selector(receivedPinPadNumber:)])
        {
            [_delegate receivedPinPadNumber:_pinpadNumber];
        }
        // Reset the contents of the pin pad number string
        _pinpadNumber = @"";
    }

    // Ensure all elements are scrambled for next number entry.
    [self scramblePinpadGridView];
} 
```

如果我注释顶部的 _pinpadNumber = [_pinpadNumber 行，它会打印适当的值。当我取消注释该行时，它只在第一次工作，并在触摸第二个按钮时崩溃。

我已经为此苦苦挣扎了两天多。我真的希望有人可以对此有所了解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:20:08.023

首先，构建和分析您的代码。修复发现的任何错误。

接下来，您可能没有使用 ARC 和这条线......

```
_pinpadNumber = [_pinpadNumber stringByAppendingFormat:@"%i", [sender tag]]; 
```

...正在将一个自动释放的对象分配给`_pinpadNumber`. 在第一次执行时，`_pinpadNumber`很可能`nil`（除非你将它初始化到`@""`其他地方——它可能是一个有效的对象。

在下一次通过时，自动释放的对象已从池中排出并*繁荣*，您的应用程序因您看到的错误而崩溃。

您可以打开僵尸检测并可能会看到僵尸消息。

# javascript - 脚本哈希值，丢失一个字母数字字符

> ID：12412968
> 
> 赞同：0
> 
> 时间：2012-09-13T18:57:41.957
> 
> 标签：javascript, jquery

我不得不将我所有的 .html 文件重命名为 .php 以便我可以使用 php gzip 压缩。无论如何，开关破坏了我的一个脚本。它是一个加载内容并为其设置动画的脚本。它从各个页面抓取内容并将其加载到容器中。脚本的那部分工作正常。

使用 .html 扩展名时，脚本会愉快地将正在查看的页面附加到 URL，如：www.site.com/#ABOUT

但是现在我已将所有内容从 .html 重命名为 .php，总是缺少一个字母，例如：www.site.com/#ABOU <--- 缺少一个“T”

或者，www.site.com/#CONTAC <--- 缺少一个“T”

www.site.com/#NEWSLETTE <--- 缺少一个“R”

这是执行此附加功能的脚本部分：

```
var hash = window.location.hash.substr(1);
var href = $('#nav li a').each(function(){
    var href = $(this).attr('href');
    if(hash==href.substr(0,href.length-5)){
        var toLoad = hash+'.php #content';  <--- .php (was: .html)
        $('#content').load(toLoad)
    }                                           
}); 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:00:02.010

```
href.substr(0,href.length-5) 
```

由于您从 .html 切换到 .php，因此您想要

```
href.substr(0,href.length-4) 
```

## .php 比 .html 短 1 个字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T19:00:09.810

我不会说这是正确的方法，但改变它应该有效：

```
if(hash==href.substr(0,href.length-4)){
    var toLoad = hash+'.php #content';  <--- .php (was: .html)
    $('#content').load(toLoad)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:02:05.417

如果`href.substr(0,href.length-5)`打算删除`.html`，您可能需要将其更改为`href.substr(0,href.length-4)`删除`.php`。

# facebook - 总是显示喜欢页面的人

> ID：12412969
> 
> 赞同：0
> 
> 时间：2012-09-13T18:57:42.840
> 
> 标签：facebook, facebook-graph-api, facebook-like

我有一个带有“赞”按钮的网站。当我（或任何其他用户）登录到 facebook 时，他可以看到一些喜欢该页面的人的列表。

但是，如果用户没有登录到 FB，则 fb like 会显示一个无聊的“125 人喜欢该页面”。

如何始终显示姓名+照片列表？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:06:52.707

What you are looking for is not the regular ["like button" plugin](https://developers.facebook.com/docs/reference/plugins/like/). You are looking for the "like box" plugin. [You can find the documentation and code here.](https://developers.facebook.com/docs/reference/plugins/like-box/)

Make sure to enable the "show faces" option so that you see the profile pictures. You can also disable the stream and header to only show the like's. You can also customize the width and height to fit more pictures in the plugin.

# xmlstarlet - xmlstarlet 用星号计数

> ID：12412980
> 
> 赞同：1
> 
> 时间：2012-09-13T18:58:16.180
> 
> 标签：xmlstarlet

我有这个带有 xmlstarlet 的行命令来返回文件 client_state.xml 中有多少 name=$VALOR。但我想选择一个带有星号的值，比如 $VALOR*

```
xmlstarlet sel -t -v "count(/client_state/workunit[name='$VALOR'])" client_state.xml 
```

我该怎么做？

谢谢

费利佩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T13:06:36.563

我假设“带星号”是指将星号用作通配符。对于这种情况，您可以使用 XPath 函数[starts-with() ：](http://www.w3.org/TR/xpath/#function-starts-with)

```
xmlstarlet sel -t -v "count(/client_state/workunit[starts-with(name, '$VALOR')])" client_state.xml 
```

# android - “使用 myApp 完成操作”

> ID：12412990
> 
> 赞同：1
> 
> 时间：2012-09-13T18:59:26.460
> 
> 标签：android

在联系人列表中，您可以向左滑动联系人以发送消息。当用户执行此操作时，我需要我的应用程序出现在菜单中，例如 whatsApp 或 Skype。菜单是：

“使用以下命令完成操作：

- 消息传递

-我的应用程序“

这可能吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:06:18.290

您需要为`intent filter`您需要应用程序处理的操作添加一个。您需要将这些添加到您的清单中。

在您的代码中实施`public void onNewIntent(Intent intent)`并采取必要的措施。

看看这个[SO Post](https://stackoverflow.com/questions/4068910/android-intent-filter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:09:35.820

您的应用程序需要处理该操作`android.intent.action.CALL`。

要处理此操作，您的应用程序需要注册以下[intent-filter](http://developer.android.com/guide/components/intents-filters.html)。

```
<activity>
  <intent-filter>
    <action android:name="android.intent.action.CALL" />
    <category android:name="android.intent.category.DEFAULT" />
  </intent-filter>
</activity> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:11:10.373

为了使您的应用程序出现在列表中，您需要有一个针对唯一数据类型的意图过滤器。如果多个应用程序能够处理相同的数据，您的应用程序可能不会显示，但您的应用程序和任何其他具有相同过滤器的应用程序会显示一个列表。

通常，默认应用程序都没有名称 mimetype 的意图过滤器。因此，通过添加下面的意图过滤器，您的应用程序将显示出来。但是，如果您提及正确的数据总是更可取的，这样您的应用程序将只显示联系人中存在的数据。Whatsapp 和 Skype 实现自己的自定义 Mimetype 并将此数据添加到每个联系人。如果有多个应用程序处理名称 mimetype，您可能必须做同样的事情

```
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:mimeType="vnd.android.cursor.item/name" />
</intent-filter> 
```

# python - 在 Python 中使用 lxml 解析标头错误的文本文件

> ID：12412994
> 
> 赞同：9
> 
> 时间：2012-09-13T18:59:40.710
> 
> 标签：python, lxml

我想用 lxml 的 etree 解析文本文件（本地存储）。但是我所有的文件（数千个）都有标题，例如：

```
-----BEGIN PRIVACY-ENHANCED MESSAGE-----
Proc-Type: 2001,MIC-CLEAR
Originator-Name: webmaster@www.sec.gov
Originator-Key-Asymmetric:
 MFgwCgYEVQgBAQICAf8DSgAwRwJAW2sNKK9AVtBzYZmr6aGjlWyK3XmZv3dTINen
 TWSM7vrzLADbmYQaionwg5sDW3P6oaM5D3tdezXMm7z1T+B+twIDAQAB
MIC-Info: RSA-MD5,RSA,
 AHxm/u6lqdt8X6gebNqy9afC2kLXg+GVIOlG/Vrrw/dTCPGwM15+hT6AZMfDSvFZ
 YVPEaPjyiqB4rV/GS2lj6A==

<SEC-DOCUMENT>0001193125-07-200376.txt : 20070913
<SEC-HEADER>0001193125-07-200376.hdr.sgml : 20070913
<ACCEPTANCE-DATETIME>20070913115715
ACCESSION NUMBER:       0001193125-07-200376
CONFORMED SUBMISSION TYPE:  10-K
PUBLIC DOCUMENT COUNT:      7
CONFORMED PERIOD OF REPORT: 20070630
FILED AS OF DATE:       20070913
DATE AS OF CHANGE:      20070913 
```

在这种情况下，第一个`<`直到第 51 行（在所有情况下都不是第 51 行）。xml 部分开始如下：

```
</SEC-HEADER>
<DOCUMENT>
<TYPE>10-K
<SEQUENCE>1
<FILENAME>d10k.htm
<DESCRIPTION>FORM 10-K
<TEXT>
<HTML><HEAD>
<TITLE>Form 10-K</TITLE>
</HEAD>
 <BODY BGCOLOR="WHITE">
<h5 align="left"><a href="#toc">Table of Contents</a></h5> 
```

我可以用 lxml 即时处理这个吗？或者我应该使用流编辑器来省略每个文件的标题？谢谢！

这是我当前的代码和错误。

```
from lxml import etree
f = etree.parse('temp.txt')

XMLSyntaxError: Start tag expected, '<' not found, line 1, column 1 
```

编辑：

FWIW，这是[文件](http://www.sec.gov/Archives/edgar/data/1006830/000119312507200376/0001193125-07-200376.txt)的链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T19:51:30.507

鉴于这些文件有一个标准，可以编写一个适当的解析器，而不是猜测事情，或者希望 beautifulsoup 做对了。这并不意味着它是您的最佳答案，但它肯定是工作。

根据[http://www.sec.gov/info/edgar/pdsdissemspec910.pdf](http://www.sec.gov/info/edgar/pdsdissemspec910.pdf)上的标准，您所拥有的（在 PEM 外壳内）是由提供的 DTD 定义的 SGML 文档。因此，首先转到第 48-55 页，提取那里的文本，然后将其保存为“edgar.dtd”。

我要做的第一件事是安装[SP](http://www.jclark.com/sp/)并使用它的工具来确保文档确实是有效的并且可以被那个 DTD 解析，以确保你不会浪费大量时间在不会平移的东西上出去。

Python 带有一个验证 SGML 解析器，sgmllib。不幸的是，它从未完全完成，并且在 2.6-2.7 中已弃用（并在 3.x 中删除）。但这并不意味着它不会起作用。所以，试试看它是否有效。

如果没有，我不知道 Python 中有什么好的替代方案；大部分 SGML 代码都是用 C、C++ 或 Perl 编写的。但是你可以很容易地包装任何 C 或 C++ 库（我将从 SP 开始），只要你愿意编写自己的 C/Cython/boost-python/whatever 或使用 ctypes 包装。只需要封装顶层函数，不需要构建一套完整的绑定。但是，如果您以前从未做过类似的事情，那么这可能不是学习的最佳时机。

或者，您可以包装一个命令行工具。SP 带有 nsgmls。还有另一个用 perl 编写的同名好工具（我认为是[http://savannah.nongnu.org/projects/perlsgml/](http://savannah.nongnu.org/projects/perlsgml/)的一部分，但我并不肯定。）还有许多其他工具。

或者，当然，您可以用 perl（或 C++）而不是 Python 编写整个事情，或者只编写解析层。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T21:19:40.730

您可以通过剥离封装边界并将其间的所有内容分成标题和第一个空行处的封装文本，轻松获取**PEM**（隐私增强消息，在[RFC 1421中指定）的封装文本。](http://www.ietf.org/rfc/rfc1421.txt)

SGML 解析要困难得多。这是一个似乎适用[于 EDGAR 文档](http://www.sec.gov/Archives/edgar/data/1326801/000119312512325997/d371464d10q.htm)的尝试：

```
from lxml import html

PRE_EB = "-----BEGIN PRIVACY-ENHANCED MESSAGE-----"
POST_EB = "-----END PRIVACY-ENHANCED MESSAGE-----"

def unpack_pem(pem_string):
    """Takes a PEM encapsulated message and returns a tuple
    consisting of the header and encapsulated text.  
    """

    if not pem_string.startswith(PRE_EB):
        raise ValueError("Invalid PEM encoding; must start with %s"
                         % PRE_EB)
    if not pem_string.strip().endswith(POST_EB):
        raise ValueError("Invalid PEM encoding; must end with %s"
                         % POST_EB)
    msg = pem_string.strip()[len(PRE_EB):-len(POST_EB)]
    header, encapsulated_text = msg.split('\n\n', 1)
    return (header, encapsulated_text)

filename = 'secdoc_htm.txt'
data = open(filename, 'r').read()

header, encapsulated_text = unpack_pem(data)

# Now parse the SGML
root = html.fromstring(encapsulated_text)
document = root.xpath('//document')[0]

metadata = {}
metadata['type'] = document.xpath('//type')[0].text.strip()
metadata['sequence'] = document.xpath('//sequence')[0].text.strip()
metadata['filename'] = document.xpath('//filename')[0].text.strip()

inner_html = document.xpath('//text')[0]

print(metadata)
print(inner_html) 
```

结果：

```
{'filename': 'd371464d10q.htm', 'type': '10-Q', 'sequence': '1'}

<Element text at 80d250c> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T20:48:34.877

尽管问题定义暗示您想从第一个“<”开始解析，但我认为这不是一个好主意。这些看起来像 PEM 标头（如果不是，它们是从 RFC(2)822 派生的其他东西），并且它们可能包含“<”字符。例如，您可能会发现`Originator-Name: "Foo Bar" <foo@bar.edu>`有一天。您正在查看的特定文件可能永远不会，但除非您可以确定，否则最好不要依赖它。

如果您想将其实际解析为带有 XML 正文的 RFC822 消息，这很容易：

```
with file('temp.txt') as f:
  rfc822.Message(f).rewindbody()
  x = etree.parse(f) 
```

但从技术上讲，这对 PEM 无效（因为 PEM 的 header-body 格式实际上是 RFC822 的一个分支，而不是通过引用合并它）。对于其他各种类似的不完全 RFC822 格式，它甚至可能*实际上*并不有效。实际上，您所关心的只是标题和正文如何分开，这是一个非常简单的规则：

```
with file('temp.txt') as f:
  while f.readline():
    pass
  x = etree.parse(f) 
```

另一种选择是依赖于（明显的）事实，即主体始终是 SEC-DOCUMENT 节点：

```
with file('temp.txt') as f:
  text = f.read()
body = '<SEC-DOCUMENT>' + text.split('<SEC-DOCUMENT>, 1)[1]
x = etree.fromstring(body) 
```

最后一点：通常，一旦您看到 RFC822 标头，就会提出格式是否实际上是完整的 RFC2822 + 可选 MIME 的问题。任何地方都没有内容标题这一事实意味着您在这里可能是安全的，但您可能想要 grep 大量的它们（或者，如果某处有文件格式的定义，则略过它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T20:55:08.123

您可以为此使用[BeautifulSoup ：](http://www.crummy.com/software/BeautifulSoup/)

```
>>> from BeautifulSoup import BeautifulStoneSoup
>>> soup = BeautifulStoneSoup(xmldata)
>>> print soup.prettify()
-----BEGIN PRIVACY-ENHANCED MESSAGE-----
Proc-Type: 2001,MIC-CLEAR
Originator-Name: webmaster@www.sec.gov
Originator-Key-Asymmetric:
 MFgwCgYEVQgBAQICAf8DSgAwRwJAW2sNKK9AVtBzYZmr6aGjlWyK3XmZv3dTINen
 TWSM7vrzLADbmYQaionwg5sDW3P6oaM5D3tdezXMm7z1T+B+twIDAQAB
MIC-Info: RSA-MD5,RSA,
 AHxm/u6lqdt8X6gebNqy9afC2kLXg+GVIOlG/Vrrw/dTCPGwM15+hT6AZMfDSvFZ
 YVPEaPjyiqB4rV/GS2lj6A==
<sec-document>
 0001193125-07-200376.txt : 20070913
 <sec-header>
  0001193125-07-200376.hdr.sgml : 20070913
  <acceptance-datetime>
   20070913115715
ACCESSION NUMBER:       0001193125-07-200376
CONFORMED SUBMISSION TYPE:  10-K
PUBLIC DOCUMENT COUNT:      7
CONFORMED PERIOD OF REPORT: 20070630
FILED AS OF DATE:       20070913
DATE AS OF CHANGE:      20070913
  </acceptance-datetime>
 </sec-header>
 <document>
  <type>
   10-K
   <sequence>
    1
    <filename>
     d10k.htm
     <description>
      FORM 10-K
      <text>
       <html>
        <head>
         <title>
          Form 10-K
         </title>
        </head>
        <body bgcolor="WHITE">
         <h5 align="left">
          <a href="#toc">
           Table of Contents
          </a>
         </h5>
        </body>
       </html>
      </text>
     </description>
    </filename>
   </sequence>
  </type>
 </document>
</sec-document> 
```

# google-maps-api-3 - 打开错误的信息窗口 Google Maps v3

> ID：12412999
> 
> 赞同：1
> 
> 时间：2012-09-13T19:00:02.720
> 
> 标签：google-maps-api-3, infowindow

> **可能重复：**
> [Google Maps JS API v3 - 简单的多标记示例](https://stackoverflow.com/questions/3059044/google-maps-js-api-v3-simple-multiple-marker-example)

在我的项目中，您可以在地图上创建标记，然后打开一个信息窗口以放置一些信息并保存在数据库中，但是当您创建一个标记，然后是另一个标记时，如果您单击第一个标记，它会打开第二个标记的信息窗口。

有什么问题？这是我的代码：（这是一个简化的代码，[在这里可以访问](http://www.inventoresdegaragem.com/dbteste/indexMK.html)完整的代码）

```
var marker;
var infoWindow;
function goma()
{
  google.maps.event.addDomListener(teste, 'click', function() 
   {
     doMark = true;     
     doMark2 = false;           
    });
    markNow()

    function markNow(){   

//Marker1
google.maps.event.addListener(map, "click", function(event) 
{

    if (doMark == true && doMark2 == false){

    marker = new google.maps.Marker({
                 position: event.latLng, 
                 map: map, icon: 'Imagens/Oficina.png',
                 shadow: 'Imagens/Oficinasombra.png',
                 draggable : true,
                 animation: google.maps.Animation.DROP});
    google.maps.event.addListener(marker,'click',showWindow);

    doMark = false;
    }

    //Marker2
    else if (doMark2 == true && doMark == false){

   marker = new google.maps.Marker({
                 position: event.latLng, 
                 map: map, icon: 'Imagens/Lojas.png',
                 shadow: 'Imagens/Oficinasombra.png',
                 draggable : true,
                 animation: google.maps.Animation.DROP});
    google.maps.event.addListener(marker,'click',showWindow);

    doMark2 = false;
    }
}
);
var html = "<table>" +
   "<tr><td>Nome:</td> <td><input type='text' id='name'/> </td> </tr>" +
   "<tr><td>Endereco:</td> <td><input type='text' id='address'/></td> </tr>" +
   "<tr><td>Tipo:</td> <td><select id='type'>" +
   "<option value='oficina' SELECTED>oficina</option>" +
   "<option value='restaurante'>restaurante</option>" +
   "</select> </td></tr>" +
   "<tr><td></td><td><input type='button' value='Salvar' onclick='saveData()'/>     </td></tr>";

}

function showWindow(event) 
{
infoWindow.setContent(html); 
infoWindow.open(map,marker); 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T19:42:17.547

如您所见，调用`infowindow.open(map, marker)`调用最后一个标记。您需要识别单击的标记以将信息窗口附加到此标记。

更改`infowindow.open(map, marker);`为`infowindow.open(map, this);`

由于您指示的页面不起作用，我不得不使用旧版本来运行演示。这是我的 markNow() 代码

```
function markNow(){   

google.maps.event.addListener(map, "click", function(event) 
{
    if (doMark == true){
    alert("Marker 1 Chosen");
    marker = new google.maps.Marker({
    position: event.latLng,
    map: map,
    icon: 'Imagens/Oficina.png',
    });
    }
    if (doMark2 == true){
    alert("Marker 2 Chosen");
    marker = new google.maps.Marker({ 
    position: event.latLng,
    map: map,
    icon: 'Imagens/Lojas.png',
    });
    }
    //if (doMark ==1)
    google.maps.event.addListener(marker, "click", function() 
    {
        infowindow.open(map, this);

    }

    );

}
);
var html = "<table>" +
   "<tr><td>Nome:</td> <td><input type='text' id='name'/> </td> </tr>" +
   "<tr><td>Ensdereco:</td> <td><input type='text' id='address'/></td> </tr>" +
   "<tr><td>Tipo:</td> <td><select id='type'>" +
   "<option value='oficina' SELECTED>oficina</option>" +
   "<option value='restaurante'>restaurante</option>" +
   "</select> </td></tr>" +
   "<tr><td></td><td><input type='button' value='Salvar' onclick='saveData()'/>        </td></tr>";

infowindow = new google.maps.InfoWindow({content: html});
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T06:14:18.847

实际上，应该为函数 markNow( ) 中的每个标记附加一个单独的侦听器-

```
 marker = new google.maps.Marker({
                     position: event.latLng, 
                     map: map, icon: 'Imagens/Oficina.png',
                     shadow: 'Imagens/Oficinasombra.png',
                     draggable : true,
                     animation: google.maps.Animation.DROP});
google.maps.event.addListener(marker,'click',showWindow); 
```

进而-

```
function showWindow(event) 
{
infoWindow.setContent(html); 
infoWindow.open(map,marker); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T21:21:59.797

这是闭包的一个问题，因为您的循环变量总是引用最后一个值。

请参阅[Google Maps JS API v3 - 简单的多标记示例](https://stackoverflow.com/questions/3059044/google-maps-js-api-v3-simple-multiple-marker-example)。