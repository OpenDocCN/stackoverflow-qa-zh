# StackOverflow 问答 11513000-11513999

# python - 按条件合并具有不同列信息的文件

> ID：11513001
> 
> 赞同：2
> 
> 时间：2012-07-16T21:42:02.760
> 
> 标签：python, perl, unix, sed, awk

我有三个文件，每个文件中的信息都不会以任何方式重叠 - 但是，它们需要以特定方式相互合并才能有用。

第一个文件不同于后两个文件，它们的设置方式相同。文件 1 如下所示：

```
rs101   12  126890980   A   G   
rs102   4   114553253   A   C   
rs103   9   172776204   C   T 
```

文件 2 如下所示：

```
1   178 0.12    0.26    0.02    
1   1458    0.35    0.37    0.021   
1   318 0.99    0.105   0.08 
```

文件 3 如下所示：

```
 1  3567    0.78    0.67    0.005   
 0  0   0   0   0   
 1  3567    0.34    -0.15   0.001 
```

我想要一个将这些文件合并到文件以生成第三个文件的脚本：

```
rs101   12  126890980   A   G
1   178 0.12    0.26    0.02
1   3567    0.78    0.67    0.005
rs102   4   114553253   A   C   
1   1458    0.35    0.37    0.02
0   0   0   0   0
rs103   9   172776204   C   T
1   318 0.99    0.105   0.08
1   3567    0.34    -0.15   0.001 
```

问题是，如果这些文件合并不正确，它们在运行分析时将无法提供正确的信息 - 我可以在每个文件的末尾添加一个唯一的列（例如，rs# 可以在文件一中打印两次（一次在第一列中，在最后一列中一次），然后可以在文件 2 和 3 末尾的另一列中添加相应的 rs 编号）。然后我可以手动抽查合并是否正确发生。任何见解或建议表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:10:41.380

一种方法，使用`paste`：

```
paste -d "\n" file1.txt file2.txt file3.txt 
```

结果：

```
rs101   12  126890980   A   G   
1   178 0.12    0.26    0.02    
1  3567    0.78    0.67    0.005   
rs102   4   114553253   A   C   
1   1458    0.35    0.37    0.021   
0  0   0   0   0   
rs103   9   172776204   C   T
1   318 0.99    0.105   0.08
1  3567    0.34    -0.15   0.001 
```

这假设您的每个输入文件都包含相同数量的行。要检查每个文件（从而避免潜在的合并问题），请使用`wc`：

`wc -l file1.txt file2.txt file3.txt`

结果：

```
3 file1.txt
3 file2.txt
3 file3.txt
9 total 
```

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T03:17:58.150

在命令行上使用 Perl：

```
perl -e '
    @fh = map {open my $fh, $_; $fh} @ARGV;
    print map <$_>.'', @fh until grep eof, @fh;
' file1.txt file2.txt file3.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:59:45.200

一种使用方式`perl`：

```
perl -e '
    open $fh1, q|<|, shift;
    open $fh2, q|<|, shift;
    open $fh3, q|<|, shift;
    while ( $l1 = <$fh1>, 
            $l2 = <$fh2>,
            $l3 = <$fh3> ) {
        printf qq|%s|, join qq||, $l1, $l2, $l3;
    }
' File1 File2 File3 
```

输出：

```
rs101   12  126890980   A   G   
1   178 0.12    0.26    0.02    
1  3567    0.78    0.67    0.005   
rs102   4   114553253   A   C   
1   1458    0.35    0.37    0.021   
0  0   0   0   0   
rs103   9   172776204   C   T
1   318 0.99    0.105   0.08
1  3567    0.34    -0.15   0.001 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T23:38:51.773

在 shell 中使用**文件描述符-**

```
while IFS= read -r lineA && IFS= read -r lineB <&3 && IFS= read -r lineC <&4 ; do   
echo "$lineA"; echo "$lineB"; echo "$lineC"
done <file1 3<file2 4<file3 
```

# javascript - 网页突出显示更多信息框

> ID：11513010
> 
> 赞同：0
> 
> 时间：2012-07-16T21:42:27.443
> 
> 标签：javascript, html

有谁知道当您突出显示一个单词时， [Arachnode.net](http://arachnode.net/)这个页面使用什么来提供更多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:49:51.043

它使用[CloudFlare Highlight](https://www.cloudflare.com/apps/highlight)。

# text - 端口 80 上的基于文本的代理

> ID：11513014
> 
> 赞同：1
> 
> 时间：2012-07-16T21:42:52.233
> 
> 标签：text, proxy, port

我的互联网访问仅限于端口 80 和 443。这些端口只有在带有适当的 Content-Type 时才会获得数据，因此您无法下载任何 flv 文件。是否有解决方案或混合解决方案来通过 php 脚本路由整个流量？因此，例如，系统中可能会运行一些东西来捕获整个流量，将传出流量隐藏到对 php 脚本的请求中，然后该脚本将充当我的计算机，获取响应并将响应转换为文本。由于允许使用文本，因此在我的机器上运行的程序会将文本转换回传入流量。有点像代理。可能吗？

# java - 突出显示和选择图像的部分Android？

> ID：11513020
> 
> 赞同：0
> 
> 时间：2012-07-16T21:43:10.217
> 
> 标签：java, android, highlight

我试图弄清楚如何只为android突出显示图像的某些部分。一旦我可以突出图像的特定部分，我会做更多，但我似乎无法弄清楚这一点。

例如，我有一个人体图像。我只是希望能够选择其中的一部分，例如大脑、手臂、胃、心脏等。我正在使用从 png 文件中在线找到的图像，让我知道使用它创建图像是否更好java.drawable 或者如果我可以使用下载的图像。

在 Java 中解决这个问题的最佳方法是什么？我能想到的唯一方法是用另一个选定的图像替换图像，但我不想处理 20 个不同的图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:52:19.410

您可以使用[在 android 中覆盖两个图像中描述的方法来覆盖突出显示颜色或突出显示图像以设置图像视图](https://stackoverflow.com/questions/2739971/overlay-two-images-in-android-to-set-an-imageview)

# django - Django：如何在 AJAX 脚本中访问模型 ID？

> ID：11513023
> 
> 赞同：0
> 
> 时间：2012-07-16T21:43:20.303
> 
> 标签：django

我想知道正确的方法是什么，

我是否在我的 ModelForm 中创建 HiddenInput 字段，并从视图中将要编辑的模型的 primaryKey 传递到 hiddenInput 字段中，然后从 AJAX 脚本中获取这些 hiddenInput 字段以像这样使用它？

```
item.load(
        "/bookmark/save/" + hidden_input_field_1,
        null,
        function () {
          $("#save-form").submit(bookmark_save);
        }
); 
```

还是有一些更聪明的方法，我不知道？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T04:09:18.060

这取决于您要如何实现。基本思想是编辑 1\. 你需要获取现有的实例， 2\. 将提供的信息保存到这个对象中。

对于＃1，您可以通过多种方式进行操作，例如传递`ID`或任何其他主键（例如 url 中的属性）`http://myserver/edit_object/1`，或者`ID`作为隐藏输入传递，然后您必须通过模板进行操作。

对于#2，我想你已经知道了。做类似的事情

```
inst = MyModel.objects.get(id=input_id) # input_id taken as per #1
myform = MyForm(request.POST, instance=inst)
if myform.is_valid():
    saved_inst = myform.save() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T22:32:22.627

我刚在 django IRC 房间里问过，它说：

> 由于 django 模板引擎不处理 js，因此这是不可能的。

因此，无法在 AJAX 脚本中访问从 django 视图传入的 id 或对象。

# javascript - Firefox 脚本标签中的 async 属性

> ID：11513028
> 
> 赞同：3
> 
> 时间：2012-07-16T21:43:47.833
> 
> 标签：javascript, html, firefox, asynchronous

我正在尝试在 Firefox 13.0.1 中测试以下代码，但它无法正常工作：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Exercise 1</title>
        <script type="text/javascript" async src="example1.js"></script>
        <script type="text/javascript" async src="example4.js"></script>
        <script type="text/javascript" src="example3.js"></script>
    </head>
    <body>
        <p>Hello world</p>
    </body>
</html> 
```

//example1.js:

```
alert("I'm the example 1"); 
```

//example3.js

```
alert("I'm the example 3"); 
```

//example4.js

```
alert("I'm the example 4"); 
```

当我打开包含上述 html 代码的文件时，会发生以下情况：

**我编辑我遵循的流程**

1.  首先，脚本“example3.js”被执行，然后出现一个带有文本“I'm the example 3”的弹出窗口。之后，我在弹出窗口中单击“确定”按钮。
2.  其次，执行脚本“example4.js”，然后出现一个带有文本“I'm the example 4”的弹出窗口。之后，我在弹出窗口中单击“确定”按钮。
3.  第三，执行脚本“example1.js”，然后出现一个带有文本“I'm the example 1”的弹出窗口。之后，我在弹出窗口中单击“确定”按钮。
4.  最后，应该显示正文内容（带有文本“Hello World”的段落），但它不在 Firefox 中，而是在 Chrome 中。在 Firefox 中，页面加载不会停止。

如果我在执行最后一个脚本后在 Firefox 中打开 Firebug，我意识到浏览器没有接收到 body 元素。

![在此处输入图像描述](../Images/16128d6fae3f5e5c9c0bbce65893fa0b.png)

我不知道我的代码是正确的还是来自 Firefox 的错误。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T20:20:23.613

这是 Firefox 中已报告的错误：[https ://bugzilla.mozilla.org/show_bug.cgi?id=692754](https://bugzilla.mozilla.org/show_bug.cgi?id=692754)

# iphone - 节点的位置始终为空。Cocos3d

> ID：11513032
> 
> 赞同：1
> 
> 时间：2012-07-16T21:44:32.237
> 
> 标签：iphone, xcode, cocos2d-iphone, cocos3d

我正在尝试在 cocos3d 中获取相机的位置，但是遇到了麻烦。这是我的 initializeWorld 的样子

```
[self addContentFromPODFile: @"leggo.pod"];

CC3Camera* cam2 = (CC3Camera*) [self getNodeNamed:@"Camera"];
[self addChild:cam2];

//the location and rotation is just for testing
//cam2.location = cc3v(0,57.101,71.694);
//cam2.rotation = cc3v(-38,0,0);

CC3Vector camLoc = cam2.location;
NSLog(@"cam2 position is x=%@ y=%@ z=%@", camLoc.x, camLoc.y, camLoc.z ); 
```

谁能告诉我为什么 camLoc.x、camLoc.y 和 camLoc.z 的值总是空的？我尝试在延迟后获取位置，但它们仍然为空。我没主意了。似乎我正在接近这个[类似的问题](http://www.cocos2d-iphone.org/forum/topic/22348)，但我仍然无法弄清楚。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:08:59.700

它们为空，因为您使用了错误的格式字符串。%@ 仅适用于 id 类型，但坐标是简单的浮点值。而是使用这个：

```
NSLog(@"cam2 position is x=%f y=%f z=%f", camLoc.x, camLoc.y, camLoc.z); 
```

PS：学会使用调试器。如果您设置了一个简单的断点并查看了局部变量，您会立即看到这些值并不是真正的“空”。

# opencv - 如何在opencv中识别标记的轮廓

> ID：11513036
> 
> 赞同：1
> 
> 时间：2012-07-16T21:44:52.870
> 
> 标签：opencv

我附加的代码仅识别未标记的轮廓，仅在 1 和零标记的掩码上执行。我的输入蒙版图像实际上标有每个轮廓的 1,2,3,4....。例如，第一个轮廓标记为 1，第二个轮廓标记为 2，而不是所有轮廓只有 1。如何修改我的代码，以便我可以根据标记的图像分别分离每个轮廓。示例轮廓 1 是一个单独的图像，轮廓 2 是另一个单独的图像。

cvFindContours(maskImg, storage, &contours, sizeof(CvContour), CV_RETR_CCOMP, CV_CHAIN_APPROX_NONE, cvPoint(0, 0));

```
CvSeq *r;
int objectIndex = 0;
int fov = atoi(seriesName) + 1;
for(r = contours; r != NULL; r = r->h_next){
    /* Save each object in separate mask file. */

    /* Clear the mask object image buffer. */
    cvSet(objectMaskImg, cvScalarAll(0), NULL);
    /* Set the color of the external area and hole area of object. */
    CvScalar externalColor = cvScalarAll(0xff);
    CvScalar holeColor = cvScalarAll(0x00);
    /* Recognize child contour. */
    int maxLevel =  -1; 
    /* Fill interiors */
    int thinkness = CV_FILLED; 
    int lineType = 8; /* 8-connected */
    cvDrawContours(objectMaskImg, r, externalColor, holeColor, maxLevel, thinkness, lineType, cvPoint(0,0)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:29:38.177

`AND`您可以在掩码和 FindContours 返回的轮廓之间使用逻辑吗？或者我不太明白你在做什么。

# html - 带有变换矩阵的画布中的奇怪线条

> ID：11513037
> 
> 赞同：0
> 
> 时间：2012-07-16T21:45:14.990
> 
> 标签：html, animation, canvas, matrix

我是使用 HTML5 画布绘图的新手，现在，我完成了以下演示：

[https://dl.dropbox.com/u/4423757/demo2Canvas.html](https://dl.dropbox.com/u/4423757/demo2Canvas.html)

所以这是我的问题：

*   我怎样才能使银色阴影中的红线消失？

*   在这种情况下应该使用 SVG 吗？

**谢谢！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:50:58.243

您不应该使用 SVG，因为制作动画要困难得多，而 SVG 甚至对此都没有效率。

关于主要问题，我无法解决它，但我认为这是由于阴影被绘制在完全相同的位置（具有“155%”的位置）造成的。所以为了解决这个问题，假设我是对的，阴影需要更厚。

# c# - 访问 Master 中的部分视图元素 ID 和名称

> ID：11513038
> 
> 赞同：0
> 
> 时间：2012-07-16T21:45:15.193
> 
> 标签：c#, asp.net-mvc, linq-to-sql, partial-views

我有一些以列表格式显示输出的强类型部分视图。这是部分之一：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<Student.Models.vwStudent>>" %>

<table>
        <tr>
            <th>
                Student ID
            </th>           
            <th>
                Past Due Amount
            </th>
            <th>
                Past Due Days
            </th>            
        </tr>

        <% if (Model != null)
           foreach (var item in Model) { %>

        <tr>
            <td>
                <%=Html.TextBox("StudentID",item.StudentID) %>
            </td>

            <td>
                <%=Html.TextBox("PastDueAmount",item.PastDueAmount) %>
            </td>
            <td>
                <%=Html.TextBox("PastDueDays",item.PastDueDays) %>
            </td>            
        </tr>

    <% } %>

    </table> 
```

这是我在master中访问以上部分的方式：

```
<% using(Html.BeginForm("SaveStudentInvoice", "StudentInvoice")) %>
<% { %>
<% Html.RenderPartial("DisplayStudentInvoiceList"); %>
<input type="button" id="Submit" name="Submit" value="Submit" />
<% } %> 
```

现在，我在 master 中有一个“保存”按钮，当我点击它时，应该将学生 ID、逾期金额和逾期天数保存在表格中。如何访问主视图中的部分视图元素 ID 和名称以进行插入？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:52:05.167

在 ASP.NET MVC 视图/MasterPages 中不进行插入。它们显示数据。它是执行插入的控制器操作。您显示的部分视图示例仅将学生数据详细信息显示为标签。如果您想将它们发送回服务器（用于插入），您应该使用 HTML `<form>`( `<% using (Html.BeginForm("someAction", "someController")) { %>`) 和输入字段（`Html.EditorFor`帮助程序）而不是简单的标签。

# sql - SQL 合并以防止对投票进行双重投票

> ID：11513044
> 
> 赞同：2
> 
> 时间：2012-07-16T21:45:47.243
> 
> 标签：sql, merge

我正在开发一个民意调查应用程序。SQL 模式是：

`polls -> * options (poll_id) -> * answers (option_id)`

或者：“投票有很多选项，选项可以有答案（又名投票）”

每次投票我只能允许**每个用户**投一票。这是合并子句（显然不起作用）：

```
 merge into answers
  using (select count(*)
         from answers, options, polls
         where answers.option_id = options.id
         and options.poll_id = polls.id
         and polls.id = {poll_id}
         and answers.owner_id = {owner_id}) votes
  on (votes = 0)
  when matched then
  insert into answers values (NULL, {option_id}, {owner_id}, NOW()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:59:26.337

如果您从不想更新，那么应该做一个简单的插入。我根本不认为需要合并：

```
insert into answers (some_value, option_id, owner_id, last_modified)
select null, {option_id}, {owner_id}, current_timestamp
from dual
where not exists (select 1 
                  from answers a
                    join options o on o.id = a.option_id
                    join polls p on p.id = o.poll_id
                  where a.owner_id = {owner_id}
                    and p.id = {polls_id} 
```

我明确列出了插入子句的列，因为不这样做是不好的编码风格。我当然只是猜到了你的列名，因为你没有向我们展示你的表定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:59:51.907

尝试这个：

```
MERGE INTO answers
USING 
(SELECT options.id 
             FROM options, polls
             WHERE options.poll_id = polls.id
             AND polls.id = {poll_id}
) options
ON (answers.option_id = options.id AND answers.owner_id = {owner_id})
WHEN NOT MATCHED THEN
    INSERT INTO answers VALUES (NULL, {option_id}, {owner_id}, SYSDATE)
WHEN MATCHED THEN
    -- Do what you need to do for an update 
```

# jquery - 使用 jQuery 的动态宽度 - 自定义选择框

> ID：11513046
> 
> 赞同：1
> 
> 时间：2012-07-16T21:46:06.160
> 
> 标签：jquery, css, dynamic, width, drop-down-menu

我已经使用 CSS 和 jQuery 制作了一个自定义选择框，直到今晚我以为我已经完成了......但没有......

代码可以在这里查看和播放[http://jsfiddle.net/nvv35/5/](http://jsfiddle.net/nvv35/5/)

问题是当使用 Firefox、IE 或 Safari 时，选择框的宽度不正确。如果您使用 Chrome 查看演示，您不会发现任何问题。jQuery 代码为“标签”设置了所需的宽度，并且该框看起来非常完美，但在前面提到的浏览器中却没有。

选择标签太短了。而不是获得与下拉列表中最长的孩子相同的宽度，而是在文本之后立即被切断..我只是找不到问题所在..

所以，我需要你们的帮助，伙计们。

**更新**

最终代码：http: [//jsfiddle.net/nvv35/9/](http://jsfiddle.net/nvv35/9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:56:20.210

`parseInt($(this).next(".selectBox").css("border-width"), 10)`结果是NaN。

JsFiddle：http: [//jsfiddle.net/nvv35/8/](http://jsfiddle.net/nvv35/8/)

将您的代码更改如下：

**更新：**要正确获取边框宽度，需要指定边框的特定一侧。（检查：[如何在 jQuery/javascript 中获取边框宽度](https://stackoverflow.com/questions/3787502/how-to-get-border-width-in-jquery-javascript)）

```
$(document).ready(function() {
  $("select").css("display", "none");
  $(".selectContainer").css("display", "inline-block");
  $(".selectHead").each(function() {
    var newWidth = $(this).next(".selectBox").outerWidth();
      var borderWidth = parseInt($(this).next(".selectBox").css("border-left-width").replace(/[^0-9]/g,""), 10) ;
      if(isNaN(borderWidth)) borderWidth  = 0;
    newWidth = newWidth - (borderWidth * 2);
    $(this).css("width", newWidth + "px");
  });
  $(".selectHead").on("click", function() {
    $(this).next(".selectBox").show();
    $(this).closest(".selectContainer").on("mouseleave", function() {
      $(this).find(".selectBox").hide();
    });
  });
  $("li", ".optionsBox").on("click", function() {
    var newValue = $(this).attr("id").replace(/(.*)-/,"");
    $(this).closest(".selectContainer").next("select").val(newValue);
    $(this).closest(".selectBox").prev(".selectHead").html($(this).html());
    $(this).closest(".selectBox").find(".optionSelected").removeClass("optionSelected");
    $(this).addClass("optionSelected");
    $(this).closest(".selectBox").hide();
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T13:28:30.577

```
function customSelect(){
 $('.custom-select a.open').on('click', function () {
    if ( $(this).next().hasClass('active') ) {
        $(this).next().removeClass('active').slideUp(250);
    }
    else{
        $(this).next().addClass('active').slideDown(250);
    }
});

$('.custom-select ul.options li').on('click', function () {
    var value = $(this).data('value');        
    $(this).parent().removeClass('active').slideUp(250);
    $(this).parent().parent().prev().attr('value', value);
    $(this).parent().prev().text(value);
});
}
customSelect(); 
```

- 查看更多信息：[http ://www.pointmycode.com/customize-select-box-with-css-and-jquery/](http://www.pointmycode.com/customize-select-box-with-css-and-jquery/)

# c# - 当我不知道确切的树层次结构时搜索树项

> ID：11513051
> 
> 赞同：1
> 
> 时间：2012-07-16T21:46:31.923
> 
> 标签：c#, ui-automation, coded-ui-tests

我正在尝试在编码的 UI 测试中选择一个树项，但我不知道整个层次结构。

例子：

> *   mssql 连接
>     *   表
>         *   *未知*
>             *   名

有没有办法在不指定整个路径的情况下搜索此 FirstName 树项并指定它的深度如此之多？

看起来任何搜索配置属性都不会执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T19:19:09.443

如果 FirstName 在树中是唯一的，那么您可以使用 PInvoke，并且您不需要指定深度：

```
 public static List<IntPtr> GetChildWindows(IntPtr parent)
    {
        var result = new List<IntPtr>();
        var listHandle = GCHandle.Alloc(result);
        try
        {
            var childProc = new User32.EnumWindowsProc(EnumWindow);
            User32.EnumChildWindows(parent, childProc, GCHandle.ToIntPtr(listHandle));
        }
        finally
        {
            if (listHandle.IsAllocated)
                listHandle.Free();
        }
        return result;
    }

    private static bool EnumWindow(IntPtr handle, IntPtr pointer)
    {
        var gch = GCHandle.FromIntPtr(pointer);
        var list = gch.Target as List<IntPtr>;
        if (list == null)
        {
            throw new InvalidCastException("GCHandle Target could not be cast as List<IntPtr>");
        }
        list.Add(handle);
        // Modify this to check to see if you want to cancel the operation, then return a null here
        return true;
    }

    public delegate bool EnumWindowsProc(IntPtr hWnd, IntPtr lParam);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool EnumChildWindows(IntPtr window, EnumWindowsProc callback, IntPtr i);

    // sample usage:
    public void findWindowUser32()
    {
        foreach (IntPtr child in GetChildWindows(User32.FindWindow(null, "Untitled - Notepad")))
        {
            StringBuilder sb = new StringBuilder(100);
            User32.GetClassName(child, sb, sb.Capacity);

            if (sb.ToString() == "Edit")
            {
                uint wparam = 0 << 29 | 0;
                User32.PostMessage(child, WindowsConstants.WM_KEYDOWN, (IntPtr)Keys.H, (IntPtr)wparam);
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T00:04:03.047

当您的控件映射到 UI 映射中时，可能使用了完整的层次结构，例如

mssql 连接 -Tables --Unknown1 ---FirstName

导致 4 个映射控件。

您可以手动编辑 uimap .xml 文件，小心删除 -Unknown1 元素，并确保关闭 MatchExactHierarchy。这样搜索最初会失败，继续使用启发式方法在树中查找比直接子级更深的元素，并且应该找到您的控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-10T06:03:10.610

```
 public static UITestControl GetTreeItem(UITestControl TreeControl, string ItemName, bool ContainsTrue = true)
    {
        AutomationElement tree = AutomationElement.FromHandle(TreeControl.WindowHandle);
        System.Windows.Automation.ControlType controlType = tree.Current.ControlType;
        //Get collection of tree nodes.
        AutomationElementCollection treeNodeCollection = null;
        treeNodeCollection = tree.FindAll(TreeScope.Descendants,
                new System.Windows.Automation.PropertyCondition(AutomationElement.ControlTypeProperty,
                        System.Windows.Automation.ControlType.TreeItem));
        UITestControl ReqTreeItem = new UITestControl();
        foreach (AutomationElement item in treeNodeCollection)
        {
            if ((item.Current.Name == ItemName) && (!ContainsTrue))
            {
                ReqTreeItem = UITestControlFactory.FromNativeElement(item, "UIA");
                break;
            }
            if ((item.Current.Name.Contains(ItemName)) && (ContainsTrue))
            {
                ReqTreeItem = UITestControlFactory.FromNativeElement(item, "UIA");
                break;
            }
        }
        return ReqTreeItem;
    } 
```

# ruby-on-rails - 如何使用 Rails 发条 gem 运行 rake 任务？

> ID：11513058
> 
> 赞同：11
> 
> 时间：2012-07-16T21:47:23.253
> 
> 标签：ruby-on-rails, heroku, rake

从时钟系统调用 rake 任务的语法是什么？我尝试了各种语法，但似乎没有任何效果。（我对发条特别感兴趣，因为 Heroku 支持它。）

这是我的clock.rb，使用与gem 使用的相同语法：

```
module Clockwork
  puts "testing clockwork!"
  every(30.seconds, 'Send Messages') {
    rake 'scheduler:send_messages'
    }
end 
```

这是我在 scheduler.rake 中的 rake 任务：

```
task :send_messages => :environment do
  puts "rake task run successfully!"
end 
```

当我开始发条流程时，会发生以下情况：

```
$ clockwork lib/clock.rb
testing clockwork!
I, [2012-07-16T14:42:58.107245 #46427]  INFO -- : Starting clock for 1 events: [ Send Messages ]
I, [2012-07-16T14:42:58.107364 #46427]  INFO -- : Triggering 'Send Messages'
attempting to run rake task!
E, [2012-07-16T14:42:58.107437 #46427] ERROR -- : undefined method `rake' for Clockwork:Module (NoMethodError) 
```

这每 30 秒运行一次。可以看到，clock.rb 执行成功。但我一生都无法弄清楚运行 rake 任务的语法。不幸的是，发条自述文件没有帮助：

[https://github.com/tomykaira/clockwork](https://github.com/tomykaira/clockwork)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T04:27:19.843

`rake`不是方法，所以你不能在这里调用它。

您可以退出并调用它，例如

```
every(30.seconds, 'Send Messages') {
  `rake scheduler:send_messages`
} 
```

或者更确切地说，使用 heroku API 调用一个新的分离进程。这是我现在首选的方法：

```
Heroku::API.new.post_ps('your-app', 'rake scheduler:send_messages') 
```

Heroku::API 可从 heroku.rb 获得：[https ://github.com/heroku/heroku.rb](https://github.com/heroku/heroku.rb)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-19T03:11:16.630

你可以传入一个块来`every`执行你的 rake 任务：

```
every(1.day, "namespace:task") do
  ApplicationName::Application.load_tasks
  Rake::Task['namespace:task'].invoke
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-03T10:21:53.587

您可以将以下方法添加到您的`clock.rb`文件中：

```
def execute_rake(file,task)
require 'rake'
rake = Rake::Application.new
Rake.application = rake
Rake::Task.define_task(:environment)
load "#{Rails.root}/lib/tasks/#{file}"
rake[task].invoke
end 
```

然后打电话

```
execute_rake("your_rake_file.rake","your:rake:task") 
```

在你的处理程序中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-06T08:37:51.777

第一次调用任务使用`Rake::Task['...'].invoke`效果很好，但需要重新启用任务才能稍后再次调用。

```
 ApplicationName::Application.load_tasks

    module Clockwork do
        every(10.minutes, "namespace:task") do
          Rake::Task['namespace:task'].invoke
          Rake::Task['namespace:task'].reenable
        end
    end 
```

否则，该任务将在第一次被调用，但之后不会再被调用，直到时钟进程重新启动。

# objective-c - 正在调用 dealloc，我不知道为什么

> ID：11513060
> 
> 赞同：0
> 
> 时间：2012-07-16T21:47:29.197
> 
> 标签：objective-c, dealloc

我有一些按钮、文本字段和方法的视图。当我加载视图，切换到另一个视图，然后切换回来时，我的应用程序崩溃了。我`NSLog`在每个方法中添加了一个，以查看崩溃前的最后一个方法调用是什么，它是`-(void)dealloc{`

我想知道为什么调用此方法？每次重新加载视图时都会调用它吗？我已经仔细检查了我的代码，我绝对不会在任何地方调用它。

* * *

编辑：发现我的问题，我正在发布一个用于存储视图的数组。感谢@Darren，我找到了我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:52:46.423

当不再需要某个类并将其从内存中删除时，将调用 Dealloc。当您没有更多指针指向视图中的任何内容时，它就会被释放。

你如何切换到/从视图？

如果你设置了一个指向视图的（强）指针，那么它不会被自动释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:52:46.447

`-dealloc`每当对象的引用计数降至 0 时都会调用它。要找出您的问题，请找出`-dealloc`调用了什么对象。调用堆栈上的第二种方法是什么？第三？首先被`-dealloc`发送到一个有效的对象指针？

有几种方法可以处理这种事情。一个好的第一步是打开 NSZombies（谷歌）。`dealloc`如果您正在向无效对象发送消息（例如，），这会让您知道。通常，这会导致崩溃，但使用 NSZombies 你会得到一个很好的错误消息。

# c++ - 我应该删除函数中的本地指针吗？(C++)

> ID：11513062
> 
> 赞同：6
> 
> 时间：2012-07-16T21:47:43.623
> 
> 标签：c++, pointers

一个问题：

我应该删除在函数中获取的指针（不是创建的，只是获取的）吗？例子：

```
#include <SomeObject>

#define SAFE_DELETE(p) { if (p) { delete (p); (p) = NULL; } }

class DraftObject
{
public:

    DraftObject() : _x(0) {}
    ~DraftObject(){}

    int CalculateSomething()
    {
        AnotherObject* aObj = SomeObject::getInstance()->getAObjPointer();

        /* Do some calculations and etc... */
        _x += aObj->GetSomeIntValue();

        SAFE_DELETE(aObj) // <-- Would you recomend this here?

        return _x;
    }

protected:
    int _x;
}; 
```

aObj 将在其他情况下以及在 SomeObject 实例中重用。我可以继续并总是调用`SomeObject::getInstance()->getAObjPointer()`我需要的一切，但`SomeObject::getInstance()->getAObjPointer()->GetSomeIntValue()`不像`aObj->GetSomeIntValue()`我个人认为的那样可读。我知道如果我使用 boost 中的某些东西（shared_ptr、weak_ptr 甚至 auto_ptr），我不必担心，但我对它的工作方式更加好奇。不会删除指针会造成内存泄漏情况，还是删除指针会从内存中删除它，以便它将在其他范围内消失（实例对象以及它可能被使用的任何其他地方）？

有什么想法吗？

干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:50:09.807

这取决于。

如果`SomeObject::getInstance()->getAObjPointer();`每次调用返回不同的对象，可能是的。否则，没有。**这应该记录在案**。

另外，您的“安全删除”：

```
#define SAFE_DELETE(p) { if (p) { delete (p); (p) = NULL; } } 
```

完全**没用**。而且丑陋。如果我在代码中看到这一点，我会去取笑编写它的程序员。如果`p`是`NULL`，则删除是安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:49:44.560

不，不要使用`delete`，因为这将释放对象的内存，您以后将无法使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:57:16.510

它应该记录在 API 中。

一些库返回的指针不应该被用户删除，因为它们也保存在内部数据结构中。其他人正在创建应该由用户删除的指针。

假设您实际上已经为自己编写了这个类和函数，如果您不在其他任何地方（包括在内部函数中）使用此实例，您可能希望删除函数末尾的指针。

# c# - 异步方法不在桌面上阻塞但在服务器上阻塞？

> ID：11513064
> 
> 赞同：5
> 
> 时间：2012-07-16T21:47:55.033
> 
> 标签：c#, .net, async-await

我做了一个简单的异步方法来异步调用 SQL 存储过程。

在我的控制台程序中，我在循环中调用此方法 1000 次，并在每次调用之间休眠 1 毫秒（Thread.Sleep）。我在进入循环之前启动一个秒表，并在退出循环时停止它，并显示在循环中花费的时间。

在我的开发机器（Win7 - VS 2012 RC）上，我可以看到我期望看到的内容：

```
Completed in 1006 ms 
```

这似乎是合乎逻辑的，考虑到对 async 方法的调用几乎立即返回（当到达第一个`await`关键字时），因此在等待之前执行代码时只会产生很小的开销（6 毫秒）。

但是，当我在安装了 .NET Framework 4.5 RC 的服务器计算机 (Win2008 R2 SP1) 上运行完全相同的代码时，代码运行良好，但执行时间与我预期的相差甚远，与在我的开发机器上运行程序时获得的一个：

```
Completed in 15520 ms 
```

这意味着以某种方式调用的异步方法并没有真正异步调用，并且第一个等待似乎以某种方式阻塞？

这是我正在调用的异步方法的代码：

```
public async void CallSpAsync()
{
  var cmd = new SqlCommand("sp_mysp");
  {  
     var conn = new SqlConnection(connectionString);
     {
       cmd.Connection = conn;
       cmd.CommandType = CommandType.StoredProcedure;

       [...Filling command parameters here - nothing interesting...]

       await cmd.Connection.OpenAsync();                    
       await cmd.ExecuteNonQueryAsync();

       cmd.Dispose();
       cmd.Connection.Dispose();
     }
  }
} 
```

这是主程序测试代码（循环）：

```
Stopwatch sw = new Stopwatch();
sw.Start();
for (int i = 0; i < 1000; i++)
{
   CallSpAsync();
   Thread.Sleep(1);
}
sw.Stop(); 
```

我在两台机器上运行完全相同的可执行文件（在 Release 中编译的控制台程序）。

我很想弄清楚为什么在服务器机器上运行程序时没有真正异步调用该方法。

任何的想法 ？

谢谢 ！

**编辑**

该问题与运行正常的 async/await 无关，但由于服务器上的计时器分辨率（由 StopWatch 使用）比我的工作站上的时间少 15 倍。代码根本没有运行得更慢，只是计时器的分辨率导致了不正确的经过时间计算。

请参阅下面 James Manning 的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:44:05.943

这可能是服务器机器上计时器分辨率的函数。检查 ClockRes 实用程序。[您可以在我对*高精度 DateTime.UtcNow*](http://blogs.msdn.com/b/kirillosenkov/archive/2012/05/16/high-precision-datetime-utcnow-on-windows-server-os.aspx)的评论中获得更多详细信息。

# javascript - 将 HTML 转换为 Sencha

> ID：11513065
> 
> 赞同：0
> 
> 时间：2012-07-16T21:47:59.397
> 
> 标签：javascript, jquery, html, sencha-touch

我对煎茶很陌生，可能不知道你需要什么。我正在尝试使用 ajax 提取 HTML 页面的一些内容。例如， id = "content" 的 div 中的文本。

我想把这个提取出来的内容放到一个面板或者容器中煎茶。

这是我的观点：

```
Ext.define("myapp.view.Main", {
   extend: 'Ext.tab.Panel',

   requires: ['Ext.TitleBar'],

   config: {
       tabBarPosition: 'bottom',

       items: [
          {
            title: 'Welcome',
            iconCls: 'home',

            styleHtmlContent: true,
            scrollable: true,

            html: FUNCTION_TO_GET_CONTENT   .join("")
         }
      ]
   }
}); 
```

我想知道是否有任何方法可以让 HTML 页面的内容显示在面板中，但我不知道如何。有人可以帮助我理解这一点以及如何最好地解决这个问题吗？

更新：

基本上我想做的是复制这个 JQuery 语句的结果：

```
 $("#mylocaldiv").load("sourcePage.html #mainDiv"); 
```

然后将结果附加到选项卡面板中的 html 属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T13:42:20.513

首先，为您的视图添加一个别名（确保它前面是`widget.`

```
Ext.define("myapp.view.Main", {
    extend: 'Ext.tab.Panel',
    alias: 'widget.Main',
    ...
}); 
```

然后通过执行以下任一操作来获取您的视图：

```
myView = Ext.Viewport.down('Main'); 
```

或者

```
myView = Ext.ComponentQuery.query('Main'); 
```

现在您可以像这样访问您的项目：

```
myView.items.items 
```

而且由于您的面板是唯一的项目，因此它将是零项目。然后，您可以使用它的`setHtml`方法来附加 html：

```
myView.items.items[0].setHtml('your html here'); 
```

在将 html 文件加载到面板方面，我相信 Sencha 删除了 Ext.dom.Element.load()。我会使用一个简单的 Ajax 请求，然后在成功回调中将结果附加到面板中。请参见此处：[将 html 文件加载到面板中](https://stackoverflow.com/questions/9156991/load-an-html-file-into-a-panel)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T04:42:53.437

sencha 不是构建大型应用程序的好工具，所以最好选择另一个。我试过了，它浪费了我的时间，根本没有用，windows 面板和更多使用不使用 css 的图像开发的。如果我们用它构建大型应用程序，我们可能会降低应用程序的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T03:08:54.417

观看此[视频](https://vimeo.com/37974749)。

它将帮助您解决问题，并让您对 Sencha Touch 有更深入的了解。

# javascript - 自动 _.bindAll() 在主干.js

> ID：11513066
> 
> 赞同：2
> 
> 时间：2012-07-16T21:48:05.920
> 
> 标签：javascript, backbone.js, underscore.js

有没有办法自动为一个主干.js 对象做一个 _.bindAll ？

不久前我在和某人交谈，他们说有，但我不知道从哪里开始寻找。

例子：

```
var TheView = Backbone.View.extend({

    initialize: function() {
        // HOW CAN I AVOID HAVING TO DO THIS?---->
        _.bindAll(this,'render','on_element_01_click', 'on_element_02_click');
    },

    events: {
        'click #element_01': 'on_element_01_click',
        'click #element_02': 'on_element_02_click',
    },

    render: function(){
        return this;
    },

    on_element_01_click: function(){

    },

    on_element_02_click: function(){

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:49:24.510

改为这样做：

```
_.bindAll(this); 
```

将绑定此视图中的所有功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T17:57:17.440

如果你想在你的视图中构建，我已经学会了一种更简单的技术`bindAll`（这对于像 AJAX 回调方法这样的事情很方便，这些方法不像事件处理程序那样自动绑定）。基本上你只需重写构造函数来执行自动绑定。

```
var BoundModel = Backbone.Model.extend({
    constructor: function() {
        Backbone.Model.apply(this, arguments);
        if (this.boundMethods) {
            _(this).bindAll.apply(this, this.boundMethods);
        }
    }
})

var SubclassOfBoundModel = Backbone.Model.extend({
     boundMethods: ['handleFetchResponse'],
     initialize: function () {
         this.model.on('sync', this.handleFetchResponse);
     }
     handleFetchResponse: function() {
         // this function is bound to the model instance
     }
}) 
```

当然，如果您只想绑定所有方法，则可以省略“boundMethods”部分，只需：

```
 constructor: function() {
        Backbone.Model.apply(this, arguments);
        _(this).bindAll();
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:55:39.947

我自己尝试过这样做，并且能够使用以下方式使其工作：

```
function bindOnExtend(clazz) {
    var originalExtend = clazz.extend;
    clazz.extend = function() {
        var newSubClass = originalExtend.apply(this, arguments);
        var originalInitialize = newSubClass.prototype.initialize;
        newSubClass.prototype.initialize = function() {
            // The constructor will get broken by bindAll; preserve it so _super keeps working
            var realConstructor = this.constructor;
            _.bindAll(this);
            this.constructor = realConstructor;
            originalInitialize.apply(this, arguments);
        };
        return bindOnExtend(newSubClass);
    };
    return clazz;
}

var BoundModel = Backbone.Model.extend();
bindOnExtend(BoundModel);

var BoundView = Backbone.View.extend();
bindOnExtend(BoundView); 
```

但是，我不会推荐它。这样做将为每个模型/视图/您实例化的任何内容上的每个方法关闭。这不仅会略微增加整体内存使用量，而且如果您不小心，还会增加内存泄漏的可能性。此外，它会使您的堆栈跟踪更长几行，因为它们必须通过 bindOnExtend。

以我的经验，不得不做“ `_.bindAll(this, ...`”是值得的，因为：

1）它使我的代码对任何追随我的人更清晰/明显 2）它鼓励我限定 my `bindAll`，而不是仅使用 1-arg 形式 3）我讨厌涉水通过长堆栈跟踪

但是，如果你想要它，上面的代码应该可以工作。

# c++ - 在 C++ 中使用回调接口时避免使用 C++ 中的静态成员函数

> ID：11513071
> 
> 赞同：4
> 
> 时间：2012-07-16T21:48:27.147
> 
> 标签：c++, callback, function-pointers

我想访问这个静态成员函数中的数据。现在成员函数是静态的，因此我可以将它与用 C 编写的第三方 API 一起使用，该 API 具有用于回调目的的 typdef 函数指针。根据下面的信息，为了在我的类的其他非静态成员函数中使用来自以下函数成员的数据，绕过创建静态函数的需要的最佳方法是什么。也许有一种方法仍然可以使用这个静态函数，但仍然可以克服无法将静态变量与非静态变量混合的问题。我的代码按原样工作，但无法访问以下回调函数中的数据。

```
void TextDetect::vtrCB(vtrTextTrack *track, void *calldata) /*acts as a callback*/
{
/*specifically would like to take data from "track" to a deep copy so that I don't loose   scope over the data withing that struct */

} 
```

在用 C 编写的相关 API 中，我被迫使用以下两行代码：

```
 typedef void (*vtrCallback)(vtrTextTrack *track, void *calldata);
 int vtrInitialize(const char *inifile, vtrCallback cb, void *calldata); 
```

这是我班级的标题：

```
 #include <vtrapi.h>
 #include <opencv.hpp>

 class TextDetect {
const char * inifile;
vtrImage *vtrimage;
int framecount;
 public:
TextDetect();
~TextDetect();
static void vtrCB(vtrTextTrack *track, void *calldata);
int vtrTest(cv::Mat);
bool DrawBox(cv::Mat&);

  };

  TextDetect::TextDetect() : inifile("vtr.ini")
  {
if (vtrInitialize(inifile, vtrCB /*run into problems here*/, NULL) == -1)
    std::cout << "Error: Failure to initialize" << std::endl;
vtrimage = new vtrImage;
framecount = 0;

  }

  void TextDetect::vtrCB(vtrTextTrack *track, void *calldata) /*acts as a callback*/
 {
/*specifically would like to take data from "track" to a deep copy so that I don't loose   scope over the data withing that struct */

 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T21:54:58.207

我不确定我是否了解您的确切情况，但这是将 C++ 方法包装到 C 回调 API 中的标准习惯用法：

```
/*regular method*/
void TextDetect::vtrCB(vtrTextTrack *track)
{
   // do all the real work here
}

/*static method*/
void TextDetect::vtrCB_thunk(vtrTextTrack *track, void *data)
{
   static_cast<TextDetect *>(data)->vtrCB(track);
} 
```

然后，假设应该调用的函数`vtrInitialize`也是一个`TextDetect`方法，你可以这样编写调用：

```
 vtrInitialize(inifile, TextDetect::vtrCB_thunk, static_cast<void *>(this)); 
```

# biztalk - 使用 WCF-SQL 适配器更新表

> ID：11513072
> 
> 赞同：1
> 
> 时间：2012-07-16T21:48:28.297
> 
> 标签：biztalk, biztalk-2010

我创建了一个编排，我试图从`Request`表中获取所有带有`Created`状态的行。我想用`Completed`状态更新这些行。

我编写了一个 SP 来获取所有带有`Created`状态的行，并且我能够在我的编排中获取这些值（我尝试将这些值发送到一个平面文件，并且我能够在输出文件中看到这些值。）

我编写了另一个 SP 来`Completed`通过传递`RequestID`. 我将转换控件添加到我的编排中，以`RequestID`将从选择 SP 接收到的映射到`RequestID`更新 SP 中的参数。我编译并部署了这个项目，但在运行时出现以下错误：

> 执行发送管道失败：“Microsoft.BizTalk.DefaultPipelines.XMLTransmit，Microsoft.BizTalk.DefaultPipelines，版本=3.0.1.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”来源：“XML 汇编程序”发送端口：“LogPort” URI：“C:\Data\Log\%MessageID%.xml” 原因：缺少根元素。

我想我在映射中做错了什么。但我不确定如何以正确的方式做到这一点。我正在使用 BizTalk 2010、VS 2010 和 SQL Server 2008。我想知道如何执行以下操作：

1.  如何调试 BizTalk 项目。
2.  如何使用更新过程映射选择查询的结果。

# android - 将新数据加载到 android 列表 - 应该如何（从 1.5 到 4.1）

> ID：11513074
> 
> 赞同：1
> 
> 时间：2012-07-16T21:48:39.673
> 
> 标签：android

今天我在思考 Android 框架是如何工作的，但我不确定一件事 - 开发人员（我）应该如何编写列表以显示来自**少数来源**的自定义数据。我创建了一些应用程序，但对我来说保持应用程序的**干净和快速**对我来说很重要。

所以 - 我有一个应用程序，例如新闻阅读器。我使用 Fragments、ListFragments、列表项的自定义布局和 BaseAdapter 来显示许多列表和活动中的数据。这里没有什么新鲜事，也没有什么特别的。起初我将所有数据**从网络服务器下载到应用程序中的 sqlite**，所以我确定它的速度和稳定性。然后接下来呢？

我应该从 Java 列表（列表项）创建列表项，然后将其传递给 baseadapter，还是我应该只使用 SQLite Cursor->list 项的方式？刷新列表、添加新项目和删除它们有什么更好的方法？请记住，我的 ListFragment 和 baseadapter 在单独的类中。

我不确定，所以我显然不知道我应该如何刷新并将新项目加载到我的列表中。我只想保持应用程序干净，没有很多 3rd 方库（所以我不关心 EndlessList 或类似的东西）。

**tl;博士**

当我使用少数来源显示数据时，我应该如何为速度目的创建列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:17:39.487

我不确定我是否理解您的全部问题，但关于适配器使用哪个数据源的部分，这是我的想法：

我认为这取决于您正在处理的数据量。如果它足够小，您可以将所有内容保存在内存中的 List 中，但您还需要确保数据不会随时间增长。

不幸的是，使用游标作为数据源也不是解决可能的“内存不足”异常问题的安全选择。每个查询都有一个[限制](https://stackoverflow.com/questions/1407442/android-sqlite-and-huge-data-sets)，因为游标的实现显然会将整个结果集加载到内存中。

因此，如果您正在处理大量数据或可能随时间增长的数据（如消息、用户创建的项目），您需要有一个适配器在内部与数据窗口一起工作，该数据窗口将固定数量的项目加载到内存中一次。该窗口始终在内存中保留一堆项目，这些项目当前可以通过 ListView（通过上下滚动）查看和快速访问。

假设该窗口包含例如 200 个项目。当达到该窗口的上限/下限时，适配器需要加载下一个相邻窗口。您可以在 GMail 应用程序中观察到这种行为（“正在加载对话......”）。

我会让该数据位于光标中，而不是先将其传输到列表中，因为您可以像使用列表一样使用光标。

# c# - 将 gridview 数据导出到 doc 文件时添加标题

> ID：11513075
> 
> 赞同：3
> 
> 时间：2012-07-16T21:48:42.197
> 
> 标签：c#, asp.net, database, htmltextwriter, stringwriter

我有一些 Sql Server 数据库，我用这种方法返回数据：

```
protected DataTable GetProductsData()
{
            if (ddTipRaport.SelectedItem.Text == "Toate Cerintele")
            { DataTable dt = new DataTable();
                System.Data.SqlClient.SqlConnection con = new System.Data.SqlClient.SqlConnection(
             "Data Source=BOGDAN-PC\\BOGDAN;Initial Catalog=ePlanning;Integrated Security=SSPI;Connect Timeout=10;TrustServerCertificate=True ");
                System.Data.SqlClient.SqlCommand comm = new System.Data.SqlClient.SqlCommand();
                comm.CommandText = "Select PS.titlu_cerinta as 'Categorie Cerinta', P.id_subcerinta as 'ID',p.titlu_subcerinta as 'Titlu Cerinta',p.data_crearii as 'Data Crearii',p.autor as 'Autor',p.revizuita as'Revizuita',p.revizuitor as'Revizuitor',p.prioritate as 'Prioritate(Importanta)',p.acoperire as 'Stare Acoperire' from subCerinteProiect P inner join cerinteProiect PS on P.id_cerinta=PS.id_cerinta where PS.id_proiect = " + (Request.QueryString["proiect"]).ToString() + " order by PS.id_cerinta desc";
                comm.Connection = con;
                con.Open();
                SqlDataAdapter da = new SqlDataAdapter(comm);

                da.Fill(dt);
                con.Close();
                return dt;
            } 
```

然后我用这个方法把它全部写在一个文档中：

```
 protected void ExportDataTableToWord()
  {
            Response.ClearContent();
            Response.ClearHeaders();
            Response.Buffer = true;
            Response.Charset = "";
            Response.ContentType = "application/vnd.ms-word";
            Response.AddHeader("content-disposition", "attachment;filename=Raport_"+ DateTime.Now.ToShortDateString()+"_"+DateTime.Now.ToShortTimeString()+".doc");

            StringWriter sWriter = new StringWriter();

            HtmlTextWriter hWriter = new HtmlTextWriter(sWriter);

            GridView GridView1 = new GridView();
            GridView1.RowStyle.HorizontalAlign = HorizontalAlign.Center;
            GridView1.DataSource = GetProductsData();
            GridView1.DataBind();
            GridView1.RenderControl(hWriter);

            Response.Write(sWriter.ToString());

            Response.End();
 } 
```

我的问题是，如何在导出的网格视图上方添加标题，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:57:27.430

您要查找的属性称为标题[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.caption.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.caption.aspx)

例如

```
GridView1.Caption = "StackOverFlow Grid..."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:02:07.540

我用了这个，效果很好，试试看是不是你想要的

```
 string datestyle = @"<style>.date { mso-number-format:'Short Date'; }</style>";
    foreach (GridViewRow oItem in gvEdit.Rows)
        oItem.Cells[4].Attributes.Add("class", "date");
    Response.Clear();
    Response.AddHeader("content-disposition", "attachment; filename=SupplierList.xls");
    Response.ContentType = "application/vnd.xls";
    System.IO.StringWriter WriteItem = new System.IO.StringWriter();
    System.Web.UI.HtmlTextWriter htmlText = new HtmlTextWriter(WriteItem);
    Response.Write(datestyle);
    gvEdit.RenderControl(htmlText);
    Response.Write(WriteItem.ToString());
    Response.End(); 
```

我留下对我有帮助的链接

[http://forums.asp.net/t/1666667.aspx](http://forums.asp.net/t/1666667.aspx)

[http://shawpnendu.blogspot.com/2009/03/export-gridview-data-to-excelword-text.html](http://shawpnendu.blogspot.com/2009/03/export-gridview-data-to-excelword-text.html)

# php - 通过 PHP 发送电子邮件

> ID：11513076
> 
> 赞同：1
> 
> 时间：2012-07-16T21:48:49.563
> 
> 标签：php

我目前正在尝试使用以下示例从 hmtl 表单发送电子邮件：

[http://www.freecontactform.com/email_form.php](http://www.freecontactform.com/email_form.php)

当我单击提交按钮时，它转到下一页，但它都以纯文本形式出现，并且什么也没做。我还有另一个步骤来制作这个 php 文件吗？在我的文件夹中，它说它保存为 php 文件。

我已经完全按照示例的要求完成了，我提出了这个问题。我不做什么？

或者你能建议一种更好的方法来做我正在尝试的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:50:20.363

最可能的问题是您的服务器未配置为运行 PHP 文件。也许您没有安装 PHP，或者如果您使用共享主机，那么您可能没有启用 PHP。

或者您尝试从您自己的计算机上运行它，除非您安装服务器软件，否则它将无法工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:25:02.240

即使您安装了服务器软件 ex。wamp 等。您将需要设置一个邮件服务器以从服务器发送邮件。我会建议得到一个主机。如果您只是在测试，那么您现在也可以使用免费主机。那里有很多。

# listview - 每次显示页面时停止 jQuery Mobile 初始化列表视图

> ID：11513083
> 
> 赞同：2
> 
> 时间：2012-07-16T21:49:33.260
> 
> 标签：listview, jquery-mobile

鉴于这种情况`jQuery Mobile`；第一页上有一个按钮的两页，它打开了带有列表视图的第二页，我想防止`listview`每次显示第二页时重新初始化。

```
<body>
    <div data-role="page" data-theme="c" id="page1">
    <div data-role="content">
        <a id="page1button" href="#page2" data-transition="none" data-role="button">Select an item</a>
        </div>
    </div>
    <div data-role="page" id="page2" data-dom-cache="true">
        <div data-role="content">
            <ul data-role="listview" data-theme="c" data-filter="true">
                <li data-icon="false"><a href="#page1">ABC</a></li>
                <li data-icon="false"><a href="#page1">BCD</a></li>
                <li data-icon="false"><a href="#page1">CDE</a></li>
                <li data-icon="false"><a href="#page1">DEF</a></li>
            </ul>
        </div>
    </div>
</body> 
```

此示例代码仅在列表视图中显示 4 个项目（为了保持代码简短），但如果列表视图中有更多项目，我的问题可以更好地说明，足够的项目将导致`listview`滚动条。

因此，例如，在一个`iPad`中，如果`listview`有 80 个项目，那么您会注意到，如果您在第二页上并且向下滚动到底部并选择列表底部的一个项目，jQuery Mobile 会滚动回页面1.到目前为止，没有问题。但是当您单击按钮*返回*第 2 页时，将`listview`重新初始化并再次滚动到顶部。这就是我想要防止发生的事情；我希望能够转到第 1 页，然后返回第 2 页，`listview`并且与我离开时的状态相同。

所以我只想`listview`初始化*一次*，而不是每次显示页面。有谁知道这个`listview`初始化发生在哪个事件中？是否可以禁用此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:02:57.400

jQuery Mobile 不保留页面之间的滚动位置。不过，您应该能够捕获一些页面导航事件并保留它；当您恢复它时，您可以使用它`silentScroll`来恢复位置，而不会触发许多您不想触发的事件。

# c++ - Ubuntu 上的 wxMkdir

> ID：11513087
> 
> 赞同：0
> 
> 时间：2012-07-16T21:49:48.163
> 
> 标签：c++, ubuntu, wxwidgets

我尝试使用[wxMkdir](http://docs.wxwidgets.org/2.8/wx_filefunctions.html#wxmkdir)函数在我的 c++ 程序中创建一个新目录。该目录 `/home/test/Documents/MATLAB/mydata/demo`已经存在。但是下面的代码

```
wxString dataDirectory = wxT("/home/test/Documents/MATLAB/mydata/demo/A");

if(! wxDirExists(dataDirectory))
{
    wxMkdir(dataDirectory); 

} 
```

会弹出一个运行时错误对话框，说

> 无法创建目录“/home/test/Documents/MATLAB/mydata/demo/A”（错误2：没有这样的文件或目录）

并且不会创建目录`A`下的目录。`demo`但是，如果我将所需的目录更改为`/home/test/Documents/MATLAB/mydata/A`，一切正常。

那么在 wxWidgets 的 Ubuntu 实现中[wxMkdir](http://docs.wxwidgets.org/2.8/wx_filefunctions.html#wxmkdir)是否存在最大目录深度？但是，在 Mac 下不会出现此问题。我在网上搜索并找不到任何有意义的东西。有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:14:31.710

如果`mkdir`失败并出现“没有这样的文件或目录”错误，通常意味着父目录不存在（或者是一个悬空符号链接）。大概同样适用于`wxMkdir`.

是否`/home/test/Documents/MATLAB/mydata/demo`已经存在？只是为了确定，它是一个目录吗？

~~（如果这不是问题，我将删除此答案并将其添加为评论。）~~

# java - PHP exec() 不调用 .jar

> ID：11513091
> 
> 赞同：-1
> 
> 时间：2012-07-16T21:50:01.400
> 
> 标签：java, php, jar, exec

几周前，我正在研究如何从 PHP 脚本中运行 .jar。我遇到了一些麻烦，SELinux 使事情变得复杂，但我终于弄明白了。

但是，我似乎并没有完全弄清楚——PHP 不一致。我有两个罐子，PHP 正在调用一个，而不是另一个。

这是代码：

```
 $command = "java -jar GA.jar ". $_SESSION['options']['GA']['popsize'] ." ". $_SESSION['options']['GA']['congens'] ." ". $filename;
    echo $command;

    $output = array();
    exec($command, $output);
    print_r($output);

    exec('java -jar testJava.jar 5', $output);
    print_r($output); 
```

我将其打印出来`$command`，以便我知道该命令正在正确构建。

无论如何，不​​会调用 GA.jar，但会调用 testJava.jar。我不明白为什么会这样。两者都从命令行工作。两者都是用语法调用的。

我认为这可能与权限有关，但它们似乎是相同的：

```
-rwxr-xr-x 1 apache   apache     13723 Jul 12 13:45 GA.jar
-rwxr-xr-x 1 apache   apache       781 Jul 13 19:02 testJava.jar 
```

我想也许它与文件的权限有关`testfiles/PHPout`，但 GA.jar 只需要从中读取，它应该有权这样做；

```
-rwxrwxrwx 1 apache apache 189 Jul 16 15:46 testfiles/PHPout 
```

如果您想知道实际的输出是什么，`$output`它包含来自 testJava.jar 的预期输出，但在 GA.jar 中是完全空的。

阻止 PHP 调用 GA.jar 但允许 testJava.jar 可能涉及哪些其他因素？

（作为记录，这是在一台运行 Redhat 和 Apache 服务器的机器上。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:35:28.783

尝试添加`2>&1`到命令的末尾以将错误输出重定向到`$output`变量并查看是否有任何结果。

也尝试`system`或`passthru`看看它是否有任何区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T21:30:57.820

我已经弄清楚问题出在哪里了。我问我的问题还为时过早，我没有做我应该做的一切来诊断这个问题。.jar 在早期执行一些 fortran 代码。出于某种原因，正确执行 fortran 代码的能力受到执行 .jar 的使用的影响 - 因此，当从命令行运行时，作为我自己的用户，它运行良好，但是当从 PHP 运行时，作为 apache，它运行陷入麻烦。

# ruby-on-rails - 如何将omniauth身份的auth_key从“电子邮件”覆盖到其他东西？

> ID：11513101
> 
> 赞同：1
> 
> 时间：2012-07-16T21:51:14.763
> 
> 标签：ruby-on-rails, omniauth, identity

我正在实施 Omniauth-Identity，我已经看到 Ryan Bates 的 Railcast 正在这样做。当他浏览登录视图时，他不经意地提到登录字段默认为电子邮件，但可以自定义。当我尝试使用存储在“登录”列下的身份表中的用户名登录时，我只收到一个 MySql 错误

```
 Unknown column 'identities.email 
```

这是预期的，因为如上所述 Identity 默认为此 auth_key。在 gem 的源代码中有这个定义

```
 def auth_key(method = false)
      @auth_key = method.to_s unless method == false
      @auth_key = nil if @auth_key == ''

      @auth_key || 'email'
    end 
```

所以我假设在某个地方我应该能够调用 auth_key(login) 并且它会查询我数据库中的正确列。我的问题是在哪里。我尝试在我的模型中覆盖该方法，用“登录”替换“电子邮件”，但它没有做任何事情。

我像 Ryan Bates 一样从我的会话/新视图中调用 /auth/identity/callback。非常感谢，如果很明显很抱歉，但我在互联网上能找到的似乎都是 Railscasts 教程的反刍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:16:49.010

最初我试图通过重新定义 auth_key 来覆盖 gem 代码...我很肯定我只是尝试编写

```
 auth_key("login") 
```

在我的 identity.rb 中，但我想我没有在我发布问题后立即这样做。无论哪种方式，我希望它可以帮助其他人。

# android - MyTouch 3g - 访问 Google.com 时 WebView 崩溃（地理位置？）

> ID：11513103
> 
> 赞同：3
> 
> 时间：2012-07-16T21:51:18.443
> 
> 标签：android, webview, crash

没有强制关闭对话框；我的应用程序在加载大部分页面后才退出。LogCat 中也没有堆栈跟踪，但有时我会看到此错误：

`E/geolocationService(580): Caught security exception registering for location updates from system. This should only happen in DumpRenderTree.`

但是当我访问其他使用地理定位的网站时，它们不会崩溃。

我尝试在调试模式下运行，我发现了这个错误：

`E/ActivityManager(89): ANR in com.google.android.apps.docs`

`E/ActivityManager(89): Reason: Broadcast of Intent { act=android.net.conn.CONNECTIVITY_CHANGE flg=0x30000000 cmp=com.google.android.apps.docs/.receivers.NetworkChangeReceiver (has extras) }`

接下来是一些 CPU 负载统计信息。（谷歌搜索此错误时没有有用的结果）。

我尝试添加必要的权限：

```
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_GPS" />
<uses-permission android:name="android.permission.ACCESS_ASSISTED_GPS" />
<uses-permission android:name="android.permission.ACCESS_LOCATION" /> 
```

以及在代码中启用地理位置：

```
 mWebView.getSettings().setJavaScriptEnabled(true);

        mWebView.getSettings().setAppCacheEnabled(true);
        mWebView.getSettings().setDatabaseEnabled(true);
        mWebView.getSettings().setDomStorageEnabled(true);

        mWebView.getSettings().setGeolocationEnabled(true);
        mWebView.getSettings().setGeolocationDatabasePath(<path>); 
```

我也尝试过覆盖 WebChromeClient.onGeolocationPermissionsShowPrompt() 以始终返回 true（或 false），但没有任何帮助。

地理位置不必工作；让它不崩溃对我来说已经足够了。

我正在使用运行 Android 2.2.1 的 T-Mobile myTouch 3g。

编辑：此外，这个问题不会发生在 Xoom 或 Galaxy SII Skyrocket 上。

# html - 带有页脚和内容的液体布局分为两部分

> ID：11513104
> 
> 赞同：0
> 
> 时间：2012-07-16T21:51:57.513
> 
> 标签：html, css

我想建立一个液体布局，其页脚保持在页面末尾，竞争空间分为两个 div。我已经在 stackoverflow 上看到了这两种行为分开的两个示例。我该如何实施？

请注意，我的左右列没有内容。这是因为我将在其中放置背景图像和其他 div。

我已经有一个例子：http: [//jsfiddle.net/kpDDM/14/](http://jsfiddle.net/kpDDM/14/)

我的示例有问题，因为当我的内容区域有很多内容时，内容区域没有垂直扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:21:51.713

在这里，[http://jsfiddle.net/kpDDM/16/](http://jsfiddle.net/kpDDM/16/)

添加`position:fixed;`到`.footer`，`overflow:hidden`从中删除`.all`。

**编辑**

[http://jsfiddle.net/kpDDM/18/](http://jsfiddle.net/kpDDM/18/)

# macos - libmemcached 和 PHP memcached 库：在 OS X 上崩溃——超时？

> ID：11513106
> 
> 赞同：1
> 
> 时间：2012-07-16T21:52:05.563
> 
> 标签：macos, memcached, osx-lion, homebrew, libmemcached

我使用 Homebrew 进行所有安装，但在这里遇到了一些麻烦......

所以我有一个 PHP 应用程序，无论出于何种原因，它都使用“memcache”和“memcached”模块。任何。

系统是 OS X Lion，10.7.4。Apache 是 Apple 随操作系统 Apache/2.2.21 提供的库存。我正在使用 Homebrew 的 PHP 5.3.14。

我安装了我需要的一切：

`brew install libmemcached memcached php53 php53-memcache php53-memcached`

并进行配置——将 Apache 设置`httpd.conf`为指向 PHP .so 文件，并将 memcache 和 memcached 扩展添加到我的`php.ini`

我加载了我的应用程序......它使 httpd 崩溃了！

这是我得到的故障转储（长转储）：[https ://gist.github.com/3125309](https://gist.github.com/3125309)

如果我`brew uninstall libmemcached`弹回 httpd，我就可以正常访问我的应用程序，但是 memcached 实际上并没有工作，因为它（dur）找不到 libmemcached。

我真的很想让 memcached 在本地正常工作，但我不确定这里发生了什么。这只是 PHP 的一个问题；我可以使用 Python 的`python-memcached`模块来访问它（但我不确定它是否使用 libmemcached）。

有什么想法吗？我在故障转储中没有看到任何看起来有用的东西:(

编辑：啊，行号很有帮助！这是关联的 libmemcached 源代码块：

```
 #ifdef HAVE_SNDTIMEO
  if (server->root->snd_timeout)
  {
    struct timeval waittime;

    waittime.tv_sec= 0;
    waittime.tv_usec= server->root->snd_timeout;

    int error= setsockopt(server->fd, SOL_SOCKET, SO_SNDTIMEO,
                      &waittime, (socklen_t)sizeof(struct timeval));
    assert(error == 0); 
  }
#endif 
```

所以这听起来像是一个超时问题？但是我的 memcached 在本地主机上，它不应该超时......除非它没有尝试连接到正确的服务器。

不过，为什么这会导致完整的 httpd 崩溃？

EDIT2：我在禁用 SNDTIMEO 和 RCVTIMEO 的情况下重新编译，现在我很高兴启动并运行......但是，A）为什么配置脚本确定可以启用它们，B）为什么它会导致 httpd 崩溃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T19:52:51.337

我能够通过构建我自己的 libmemcached 来解决这个问题，移除依赖于 RCVTIMEO 和 SNDTIMEO 的代码位，然后针对该自定义 libmemcached 构建 php-memcached。

我仍然不确定为什么我的系统报告 SNDTIMEO 和 RCVTIMEO 在它们不起作用时可用于 libmemcached 配置脚本。这使得 OS X 自制版本对我来说无法使用。我很惊讶其他人没有遇到这个问题。

# javascript - 谷歌浏览器和 FPS 的奇怪行为

> ID：11513107
> 
> 赞同：17
> 
> 时间：2012-07-16T21:52:16.823
> 
> 标签：javascript, google-chrome, html5-canvas

我编写了一个小引擎，在 Canvas2D 中使用 javascript 显示 5 个精灵。一切正常并且完全优化。

FPS 在 30 到 60 之间波动 - 但有趣的是，当 google javascript 控制台打开时，它以恒定的 60 fps 显示！

还有其他人经历过这种情况吗？

注意我正在使用 requestAnimationFrame

**编辑：**

示例：http: [//jsfiddle.net/jrPNy/1](http://jsfiddle.net/jrPNy/1)

玩弄“粒子”数，这样你的 fps 就在 40-50 左右。比打开控制台，它上升到 60 fps。（铬 21.0.1180.83）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T02:17:50.417

正如问题作者在评论中所说，这与可见的画布区域有关。打开控制台会降低视口的高度，这在正常尺寸的显示器上意味着要渲染的内容更少。60 FPS 是显示刷新率给出的软限制；做比这更多的帧没有意义，因为在普通显示器上每秒显示超过 60 帧是不可能的。

我在我的机器上测试了这个，降低了 CPU 速度，这样我就不会总是得到 60FPS。在提供的 Fiddle 示例中，我通常有大约 24FPS。打开控制台将可见画布缩小到其原始大小的 60% 左右，FPS 平均增加到 30。调整控制台的大小会相应地影响 FPS：只有 10% 的画布可见，FPS 在 42 左右摆动，而在一个非常小的控制台和整个画布可见的情况下，FPS 略低于原始值，达到 23。无论控制台的状态如何，CPU 速度都将 FPS 保持在恒定的 60。

现在，鉴于生成屏幕的 JavaScript 仍在运行，无论画布有多少可见，影响所需处理能力的是画布的实际渲染，以及将画布图像合成到其余部分的方式HTML，在浏览器窗口上，最后到屏幕上。越来越多的工作转移到 GPU 上，所以当合成过程的每个阶段都在 OpenGL 中完成时，FPS 应该总是最大化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-10T14:45:06.657

我在我的 macbook 上使用 chrome 也经历了同样的事情。似乎 osx 坞站导致帧速率变慢，当您打开控制台时，视口会移离坞站足够远，以使帧速率回到 60fps。如果您将窗口从扩展坞移开，则帧速率会上升。如果您自动隐藏扩展坞，您可以在不打开控制台的情况下以 60fps 全屏显示。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-06T19:34:55.863

Google chrome 使用 vsync 意味着它将 FPS 限制为您的屏幕 FPS 限制，大多数屏幕为 60 FPS，因此您的 google 会尽可能匹配，但不会超过它。可能有一个删除 vsync 的程序，但我知道 Nvidia 驱动程序可以控制它，但你需要 GTX 610 或 hight 才能做到这一点

# android - 动态改变 SharedPreferences

> ID：11513113
> 
> 赞同：0
> 
> 时间：2012-07-16T21:52:48.873
> 
> 标签：android, sharedpreferences

我目前正在使用 SharedPreferences 开发一个应用程序，并且我正在尝试动态更改出现在 Prefs 活动屏幕上的值。在屏幕上，我有一个偏好列表视图，其中包含一年中的月份和两个编辑框，用于存储与所选月份相关的信息。选择一个月后，我希望发生一些事情：

1.  在选定月份的数据库中插入一行（如果之前没有选择过）——这我可以开始工作了
2.  将 sharedpreference 编辑框的值更改为存储在数据库行中的值——这是我遇到问题的地方
3.  更新编辑框时，它们应该根据所选月份更新数据库中的相应行——没有问题。

所以，基本上，我的问题在于项目#2。我有一个功能可以检查何时从列表中选择了新月份：

```
public void setMonth(SharedPreferences sp) {
            ContentValues cv = new ContentValues();
    cv.clear();

    int sel_month = Integer.valueOf(sp.getString("pActivityMonth", String.valueOf(this.month))); //listvew works with strings, convert to int
    int stored_new = 0; //default value
    int stored_ren = 0; //default value

    Log.d(TAG, String.valueOf(sel_month));

    String[] col = { Database.C_MONTH, Database.C_QNEW, Database.C_QRENEW };
    String[] arg = { String.valueOf(sel_month) };

    Cursor c = db.query(Database.RR_TABLE, col, Database.C_MONTH + "=?", arg, null, null, null);

    if (c.getCount()<1) { //New month, insert row
        cv.put(Database.C_MONTH, sel_month);
        db.insertWithOnConflict(Database.RR_TABLE, null, cv, SQLiteDatabase.CONFLICT_IGNORE);
    } else { //row exists, get stored values
        Log.d(TAG, "cursor count: " + String.valueOf(c.getCount()));
        c.moveToFirst();
        stored_new = c.getInt(c.getColumnIndex(Database.C_QNEW));
        stored_ren = c.getInt(c.getColumnIndex(Database.C_QRENEW));
        Log.d(TAG, "stored_new: " + String.valueOf(stored_new));
    }

            //Change edittext preferences to stored values
    editor.putString("pNewQuota", String.valueOf(stored_new));
    editor.putString("pRenewQuota", String.valueOf(stored_ren));
    editor.apply();
    editor.commit();

} 
```

因此，我选择了一个新月份（七月），单击其中一个 edittext 选项来更新信息（假设我输入了 20），然后选择一个不同的月份（八月），默认值为 0。如果我然后单击再次在 edittext 上，对话框继续显示 20 而不是 0。如果我将此 0 更改为其他值，它将存储在数据库的正确行中，但随后此值在更改为另一个月后继续存在（例如，回到七月）。我的 Logcat 显示该函数正在获取正确的值，并且 putString 正在运行。PreferenceScreen 不能自行刷新吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T16:46:32.603

如果我理解正确，您似乎有一个 PreferenceActivity 使用 SharedPreferences 和一个 SQLiteDatabase 来持久化/保存相同的数据。虽然 PreferenceActivity 看起来像是为数据输入而设计的预构建 ListView，但它实际上更多：PreferenceActivity 会自动将 Preferences 保存并加载到 SharedPreferences，SharedPreferences 是分配给您的应用程序并由 Android 操作系统管理的特殊数据存储区。

尽管旨在存储首选项，但如果需要，您可以使用 SharedPreferences 来保存一些数据；可以通过首选项自动进行，也可以通过调用编辑器手动进行。您可以通过多种方式中断和/或修改此持久性，例如创建首选项子类来替换行为，使用 OnPreferenceChangeListener 来修改行为，或通过调用 setPersistent(boolean) 来切换持久性。

> *以这种方式使用 PreferenceActivity 的替代方法是使用 AdapterView 或 ListActivity 创建一个 Activity，并使用 SimpleCursorAdapter 自动将数据绑定到视图。*

为了回答您关于在 PreferenceActivity 中对 SharedPreferences 进行持久更改的问题，我在上下文中提供了一些粗略概述的示例代码，并概述了几个潜在的问题点。它并不是为了代表一个可用的解决方案，而是为了让您了解您需要什么以及在哪里，我希望以一种清晰（如果冗长）的方式，不应该太难适应您的项目。

```
 /* Preference value modification example. 
     * This is a code sample with some context, not a solution.
     * @author codeshane.com
     * */
    public class StackOverflow_Question_11513113 extends PreferenceActivity {
        /*

        */
        class MyPreferenceActivity extends PreferenceActivity {
            //Preference keys that were either set in xml, or possibly in source via .setKey():
            private final String pref_group_key = "some_prefs_key";
            private final String list_pref_key = "some_list_key";
            private final String edittext_pref_key = "some_edittext_key";

            private PreferenceActivity mPreferenceActivity; /* the activity */
            private SharedPreferences mSharedPreferences; /* auto-saving preferences */
            private Editor mEdit;
            private PreferenceScreen mPreferenceScreen; /* root of the preference hierarchy */
            private PreferenceGroup mPreferenceGroup; /* optional grouping of preferences */
            private ListPreference mListPreference; /* a pop-up selectable-items-list */
            private EditTextPreference mEditTextPreference; /* a pop-up text entry box */
            private int stored_new;
            private int stored_ren;

            /* ... */

            public void setMonth() { /*SharedPreferences sp*/

                /* ... */

                //int stored_new = 0; //default value
                //int stored_ren = 0; //default value

                /* ... */

                /* Should only call either apply() or commit(), not both; calling a .commit() after an .apply() can block the thread (always fun),
                 * not to mention they essentially do the same thing, just synchronously vs asynchronously.
                 * http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#apply()
                 * */
                // mEdit.apply();    //API level 9+, void, asynchronous.
                // mEdit.commit(); //API level 1+, returns boolean, synchronous.
            }
            /* ... */

            @Override
            public void onCreate(Bundle savedInstanceState) {
                /* Called once when the Activity is created. */
                super.onCreate(savedInstanceState);
                addPreferencesFromResource(R.xml.affirm_prefs);
                /* ... */
            }
            @Override
            protected void onResume() {
                super.onResume();
                /* Called when the Activity is created or comes to foreground. */
                if (null==mSharedPreferences){init(this);}
                 mSharedPreferences.registerOnSharedPreferenceChangeListener(onSharedPreferenceChangeListener);
                /* manually load data from shared preferences that IS NOT REPRESENTED 
                 * by a Preference already, or for which Persistent has been manually
                 * set to false. */
                stored_new = mSharedPreferences.getInt("stored_new", 0); //If not found, assigns a default value of 0.
                stored_ren = mSharedPreferences.getInt("stored_ren", 0); //If not found, assigns a default value of 0.
            }
            @Override
            protected void onPause() { /* Called when the Activity goes to background. */
                super.onPause();
                mSharedPreferences.unregisterOnSharedPreferenceChangeListener(onSharedPreferenceChangeListener);
                /* manually save data to shared preferences that IS NOT REPRESENTED 
                 * by a Preference already, or for which Persistent has been manually
                 * set to false. */
                mEdit.putInt("stored_new", stored_new);
                mEdit.putInt("stored_ren", stored_ren);
                mEdit.commit();
            }
            private boolean init(PreferenceActivity activity){
                mPreferenceActivity = activity; // or PreferenceActivity.this;
                mSharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);
                mPreferenceScreen = mPreferenceActivity.getPreferenceScreen();
                mPreferenceGroup = (PreferenceGroup)mPreferenceScreen.findPreference(pref_group_key);
                mListPreference = (ListPreference)mPreferenceScreen.findPreference(list_pref_key);
                mEditTextPreference = (EditTextPreference)mPreferenceScreen.findPreference(edittext_pref_key);
                return true;
            }
            /* When registered to a preference, this listener is notified of changes before saving. 
             * */
            OnPreferenceChangeListener onPreferenceChangeListener = new OnPreferenceChangeListener(){
                public boolean onPreferenceChange(Preference preference, Object newValue) {
                    boolean persistNewValue = true;
                    /* This occurs when a user has changed a preference, but before it is persisted */
                    /* this is a good place for your "setMonth" logic,
                     * at least in a PreferenceActivity*/
                    updateElement(preference, newValue);
                    changeMoreStuffBonusMethod(preference);
                    return persistNewValue;
            }};
            /* When registered to SharedPreferences, this listener is notified of all saves to SharedPreferences, even if the data is the same
             * */
            OnSharedPreferenceChangeListener onSharedPreferenceChangeListener = new OnSharedPreferenceChangeListener(){
                public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {

                }
            };
            private boolean updateElement(Preference prefUpdating, Object value){
                if (null==prefUpdating) return false;
                /* This function is for manually changing the value before it
                 * is saved by the PreferenceActivity. */

                /* ... */

                /* Can match exact instances, such as our mListPreference */
                if (mListPreference.equals(prefUpdating)) {
                    /* set selected item by item's index id */
                    mListPreference.setValueIndex(0);
                    /* or set selected item by item's key*/
                    mListPreference.setValue("item_key");            
                }

                /* Can also match by Class, such as any EditTextPreference */
                if (prefUpdating instanceof EditTextPreference){
                    EditTextPreference etp = (EditTextPreference)prefUpdating;
                    String oldText = etp.getText();
                    etp.setText("Some new text in edit text box"); /* or */
                    etp.setText(String.valueOf(stored_new)); /* or */
                    etp.setText(oldText.trim()); /* remove leading/trailing whitespace */
                    etp.setText(dataModel.get(prefUpdating.getKey())); /* if you use a model.. */
                }

                /* ... */
            }
            private void changeMoreStuffBonusMethod(Preference prefUpdating){
                /* Change the preference text */
                prefUpdating.setTitle("Click Me!");
                prefUpdating.setSummary("I am a cool preference widget!");

                /* Change the pop-up list (not items) text */
                if (prefUpdating instanceof ListPreference){
                    ListPreference lp = (ListPreference)prefUpdating;
                    lp.setDialogTitle("I am the pop-up.");
                    lp.setDialogMessage("Select something from my list.");
                }
                /* If persistent, PreferenceActivity should handle saving: */
                Log.v(TAG,prefUpdating.getClass().getSimpleName()+".isPersistent="+String.valueOf(mListPreference.isPersistent()));
            }
        }
    } 
```

# android - 将凹凸 sdk 与 Corona sdk 或 trigger.io 一起使用

> ID：11513115
> 
> 赞同：2
> 
> 时间：2012-07-16T21:53:01.020
> 
> 标签：android, iphone, ios, coronasdk, trigger.io

我想知道是否可以将凹凸 sdk (http://bu.mp/company/api) 与 corona 或 trigger.io 一起使用，或者我是否必须在 Objective C 中编写应用程序才能使用凹凸 sdk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:54:04.577

目前无法将凹凸 sdk 与 Trigger.io 一起使用，因为我们不允许用户将任意原生插件添加到我们的框架中。

但是，插件在我们的中期路线图上，当我们的插件接口准备好编码时，我们将再次在这里发布。如果您想抢先体验，请发送电子邮件至 support@trigger.io

# asp.net-mvc - asp.net mvc 发生与网络相关或特定于实例的错误

> ID：11513116
> 
> 赞同：2
> 
> 时间：2012-07-16T21:53:07.280
> 
> 标签：asp.net-mvc, entity-framework, repository-pattern, dbcontext

我正在尝试设置一个带有可移植区域（在单独的项目中）和通用存储库的 asp.net mvc。

我使用 IContext 接口为实现该接口的每个上下文生成数据库：

```
public class Context : DbContext
    {
        public List<IContext> Contexts {get;set;}

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);

            foreach (IContext context in Contexts)
                context.Setup(modelBuilder);
        }
    } 
```

和 IContext 的实现：

```
public class TaskListContext : Context, IContext
    {
        public DbSet<Task> Tasks { get; set; }

        void IContext.Setup(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Task>().ToTable("Tasks");
            modelBuilder.Entity<Task>().HasKey(task => task.Id);            
        }
    } 
```

当我运行此代码时：

```
Context context = new Context();
            context.Contexts = new List<IContext>();
            context.Contexts.Add(new ModuleContext());

            String assemblyPath = ControllerContext.HttpContext.Server.MapPath(String.Format("~/bin/{0}", "TaskList.dll")); //it is in a seperate project.

            Assembly assembly = Assembly.LoadFrom(assemblyPath);

            var contexts = from t in assembly.GetExportedTypes()
                              where typeof(IContext).IsAssignableFrom(t)
                              select t;
            foreach (Type t in contexts)
            {
                IContext cont = (IContext)Activator.CreateInstance(t);
                context.Contexts.Add(cont);             
            }

            context.Database.CreateIfNotExists(); 
```

数据库和表按预期创建。

但是当我想用存储库模式查询数据库时，我得到一个错误。

查询：

```
TaskListRepository Rep = new TaskListRepository();
            var task = Rep.FindBy(t => t.Id==2); 
```

存储库：

```
public class TaskListRepository : GenericRepository<TaskListContext, Task>, ITaskListRepository
    {
    } 
```

抽象存储库：

```
public abstract class GenericRepository<C, T> :
    IGenericRepository<T>
        where T : class
        where C : DbContext, new()
    {

        private C _entities = new C();

        public C ConcreteContext
        {

            get { return _entities; }
            set { _entities = value; }
        }

        public virtual IQueryable<T> GetAll()
        {
            IQueryable<T> query = _entities.Set<T>();
            return query;
        }

        public IQueryable<T> FindBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate)
        {

            IQueryable<T> query = _entities.Set<T>().Where(predicate);
            return query;
        }

        public virtual void Add(T entity)
        {
            _entities.Set<T>().Add(entity);
        }

        public virtual void Delete(T entity)
        {
            _entities.Set<T>().Remove(entity);
        }

        public virtual void Edit(T entity)
        {
            _entities.Entry(entity).State = System.Data.EntityState.Modified;
        }

        public virtual void Save()
        {
            _entities.SaveChanges();
        }
    } 
```

然后我得到这个错误：

建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

堆栈跟踪：

```
[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +6351920
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412
   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity) +6366506
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject) +180
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout) +6366917
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +6366793
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +352
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +831
   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +49
   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +6368598
   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +78
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +2194
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +89
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +6372110
   System.Data.SqlClient.SqlConnection.Open() +300
   System.Data.SqlClient.SqlProviderServices.UsingConnection(SqlConnection sqlConnection, Action`1 act) +132
   System.Data.SqlClient.SqlProviderServices.UsingMasterConnection(SqlConnection sqlConnection, Action`1 act) +3981391
   System.Data.SqlClient.SqlProviderServices.GetDbProviderManifestToken(DbConnection connection) +10513049
   System.Data.Common.DbProviderServices.GetProviderManifestToken(DbConnection connection) +44

[ProviderIncompatibleException: The provider did not return a ProviderManifestToken string.]
   System.Data.Common.DbProviderServices.GetProviderManifestToken(DbConnection connection) +11121429
   System.Data.Entity.ModelConfiguration.Utilities.DbProviderServicesExtensions.GetProviderManifestTokenChecked(DbProviderServices providerServices, DbConnection connection) +94

[ProviderIncompatibleException: An error occurred while getting provider information from the database. This can be caused by Entity Framework using an incorrect connection string. Check the inner exceptions for details and ensure that the connection string is correct.]
   System.Data.Entity.ModelConfiguration.Utilities.DbProviderServicesExtensions.GetProviderManifestTokenChecked(DbProviderServices providerServices, DbConnection connection) +357
   System.Data.Entity.ModelConfiguration.Utilities.DbConnectionExtensions.GetProviderInfo(DbConnection connection, DbProviderManifest& providerManifest) +108
   System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection) +118
   System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext) +237
   System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input) +279
   System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +888
   System.Data.Entity.Internal.InternalContext.Initialize() +50
   System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +45
   System.Data.Entity.Internal.Linq.InternalSet`1.Initialize() +151
   System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext() +50
   System.Data.Entity.Infrastructure.DbQuery`1.System.Linq.IQueryable.get_Provider() +140
   System.Linq.Queryable.Where(IQueryable`1 source, Expression`1 predicate) +135
   MonackFr.Repository.GenericRepository`2.FindBy(Expression`1 predicate) in D:\code\MonackFr\MonackFr\MonackFr.Library\Repository\GenericRepository.cs:34
   MonackFr.Mvc.Areas.TaskList.Controllers.TaskController.Index() in D:\code\MonackFr\MonackFr\MonackFr.Mvc\MonackFr.Mvc\Areas\TaskList\Controllers\TaskController.cs:18
   lambda_method(Closure , ControllerBase , Object[] ) +113
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +261
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +39
   System.Web.Mvc.Async.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41() +34
   System.Web.Mvc.Async.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33() +129
   System.Web.Mvc.Async.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49() +954935
   System.Web.Mvc.Async.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult) +15
   System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +33
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +955452
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +28
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +67
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +53
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__4(IAsyncResult asyncResult) +42
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +54
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375 
```

连接字符串：

```
<connectionStrings>
      <add name="Context" providerName="System.Data.SqlClient" connectionString="Data Source=localhost;Initial Catalog=monackfr;User Id=sa;Password=*******" />       
  </connectionStrings> 
```

我真的再也看不到了？有谁知道出了什么问题？连接字符串应该是正确的：它正在创建数据库和表。

问候，

威廉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T08:07:49.167

EF 有很多有用的约定。其中之一是 EF 尝试自动找出连接字符串。

如果您没有另外指定并且配置文件中没有连接字符串，EF 将根据`DbContext`类型名称创建一个具有数据库名称的连接字符串。

因此，当您使用它时，可以在您的配置`Context`中找到您的连接字符串。`name="Context"`但是当你使用`TaskListContext`它时找不到连接字符串，`name='TaskListContext'`所以它会为你生成一个连接字符串，这将导致你得到的异常。

`name='TaskListContext'`为避免这种情况，您可以在 app/web.config中添加一个新的连接字符串

或者，您可以使用[DbContext 构造函数](http://msdn.microsoft.com/en-us/library/gg679467%28v=vs.103%29.aspx)重载之一来明确指定连接。根据您当前的设计，它应该如下所示：

```
public class Context : DbContext
{
    public Context()
    {
    }

    public Context(string nameOrConnectionString) : base(nameOrConnectionString)
    {
    }

    //.. rest of Context 
}

public class TaskListContext : Context, IContext
{
    public TaskListContext() : base("Context")
    {
    }

     //.. rest of TaskListContext 
} 
```

`IContext`通过在所有派生类型中进行此修改， EF 将为`"Context"`每个 DbContext 使用从配置文件中命名的相同连接字符串。

# android - 应用程序未在 4.x 设备的 Google Play 中显示

> ID：11513119
> 
> 赞同：0
> 
> 时间：2012-07-16T21:53:10.860
> 
> 标签：android, android-market-filtering

我最近发布了关于 Play 商店不允许我在没有 minSdkVersion 的情况下发布我的应用程序的帖子，但是每当我将其设置为高于“1”的任何值时，我的应用程序都无法正常工作（[minSdkVersion 破坏程序](https://stackoverflow.com/questions/11441701/minsdkversion-breaking-program)）。

所以这个人建议将我的 minSdkVersion 设置为 1，这很有效。但是现在当我提交我的应用程序时，即使开发者网站说：

```
API level: 1-16+
Supported screens: normal-xlarge
OpenGL textures: all 
```

但是[应用程序](https://play.google.com/store/apps/details?id=com.unparalleledsoftware.applist&feature=more_from_developer#?t=W251bGwsMSwxLDEwMiwiY29tLnVucGFyYWxsZWxlZHNvZnR3YXJlLmFwcGxpc3QiXQ)只显示它支持 4.x 下的 Android，我在我的 4.0.4 设备上开发它。我试着四处搜索，发现有些人的服务会弄乱它支持的手机，所以我删除了我所有的服务，因为我真的不需要提交这个版本的应用程序。它仍然没有工作。所以我不知道还能做什么，这是我的 AndroidManifest.xml 如果它有帮助的话......我一直在试图弄清楚为什么我的应用程序现在一周没有工作，仍然没有。我尝试将 targetSdkVersion 设置为 14，但我的应用程序仍然中断。我清理了我的代码，从已经很短的 200 行应用程序中取出所有内容，但它仍然无法正常工作。有什么我不能在 android 应用程序中使用的东西 4\. 0 我在我的应用程序中使用？还是只是我的 AndroidManifest？太感谢了！

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.unparalleledsoftware.app.list"
android:versionCode="5"
android:versionName="2.02" >

<uses-sdk
    android:minSdkVersion="1" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

我应该注意，我使用的是 Theme.Holo.Light，但即使我将其更改为 DeviceDefault 它也不起作用。

编辑：

我在我的朋友三星 Galaxy S3 上搜索了该应用程序（它没有出现在他手机上的 Play 商店中），当我通过谷歌搜索该应用程序并点击谷歌上的“安装”按钮并在 Google Play 商店中打开它时并且能够安装。当我在手机 Galaxy Note 上执行相同操作时，它在 Google Play 商店中打开，但随后显示“不兼容”。为什么？它们都在同一版本的操作系统上。为什么我的不兼容，One X 也不兼容，但三星 Galaxy S3 工作...？

编辑：使用 targetSdkVersion 编译时出现这些错误/问题，[http ://pastebin.com/mxgWNLdM](http://pastebin.com/mxgWNLdM)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:21:06.730

它在我这边显示为“需要 Android 1.0 及更高版本”，而且您的清单也没有任何问题。它会显示在所有设备上。

但是，如果您的目标是运行 Android 3.0 之前版本的设备，则应避免使用 Holo 主题。最佳实践是创建两个主题 - 一个用于 API 级别 1-10，一个用于 API 级别 11+，并确保 v11 使用 Holo 主题作为父样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:33:59.153

我在上面发布了完整的 Manifest 文件，然后我建议向其中添加`<supports-screen>`条目（上方`<applicaion>`），如下所示：

```
<supports-screens android:largeScreens="true" 
                  android:normalScreens="true"
                  android:smallScreens="true"
                  android:anyDensity="true" /> 
```

由于 Play 的过滤机制，缺少它（如果不是故意的）会导致应用程序无法用于任何它应该使用的设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T05:15:57.413

您的清单文件只有一个 minSdk 设置，这是奇怪/坏的，因为根据文档，如果您不设置 targetSdk，它将默认为 minSdk 级别。[Android Manifest - 使用 SDK 元素](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)。问题是 1 的 API 设置真的很老，我不会对 Market/Play 有问题感到惊讶。如果你在 ICS 上开发了这个，你应该真的有一个 targetSdk。此外，如果它是为 API 级别 14 开发的，那么您也应该有一个 support-screen 元素。

在最坏的情况下，我会创建一个新项目并复制该 manfest 文件以查找任何缺失的元素。如果您仍然遇到 targetSdk 和 support-screens 的问题，请打开详细的构建消息并查看是否有任何问题。

# c# - C# 中的 Quickbase API 示例

> ID：11513122
> 
> 赞同：3
> 
> 时间：2012-07-16T21:53:18.770
> 
> 标签：c#, api, quickbase

我对 API 的使用相当陌生，直到今天才接触过 Quickbase。我正在研究 Quickbase API，似乎我看到的所有示例都是用 XML 或类似的变体编写的。有没有办法用 C# 编写代码来做我在 Quickbase 网站的 API 文档上看到的相同的事情？如果您知道任何代码示例，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T21:56:21.380

有一个[QuickBase C# SDK](https://github.com/QuickbaseAdmirer/QuickBase-C-Sharp-SDK)可以帮助您入门。

```
using System;
using Intuit.QuickBase.Client;

namespace MyProgram.QB.Interaction
{
    class MyApplication
    {
        static void Main(string[] args)
        {
            var client = QuickBase.Client.QuickBase.Login("your_QB_username", "your_QB_password");
            var application = client.Connect("your_app_dbid", "your_app_token");
            var table = application.GetTable("your_table_dbid");
            table.Query();

            foreach(var record in table.Records)
            {
               Console.WriteLine(record["your_column_heading"]);
            }
            client.Logout();
        }
    }
} 
```

还有一个[QuickBase API Wrapper](http://icanhascode.blogspot.com/2009/12/quickbase-c-api-wrapper.html)示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-25T05:13:46.010

早在 2009 年，我[为 QuickBase 编写了一个 .NET API，](https://github.com/brettryan/QuickBaseNET)它使平台的工作变得容易，它还支持上传和下载附件。

```
IQuickBaseService svc = new QuickBaseService("user", "pass", "URL", "token");
Schema schema = svc.GetSchema("DBID");
Console.WriteLine("Schema : {0}", schema.Name);
Console.WriteLine("Variables - ");
for (KeyValuePair<string, string> ent in schema.Variables.OrderBy(en => en.Key)) {
    Console.WriteLine("Var: {0} = {1}", ent.Key, ent.Value);
}
for (Query q : schema.Queries) {
    // Work with queries.
}
// schema.Children
// schema.Fields
// ...
svc.SignOut(); 
```

执行查询很简单。

```
QueryResult res;
res = svc.Query("tableid", 1); // Execute query number 1
res = svc.Query("tableid", "{{140.EX.'1'}}") // execute QB query text

foreach (QueryRow row in result.Rows) {
    // Do something with row, use get<type>, not all shown here.
    // row.GetBool(1);
    // row.GetInt(1);
    // row.GetLong(1);
    // row.GetFloat(1);
    // row.GetDouble(1);
    // row.GetDecimal(1);
    // row.GetString(1);
    // row.GetDate(1);
    // row.GetDateTime(1);
    // row.GetObject(1);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T05:33:04.957

QuickBase SDK 代码现已移至 github [https://github.com/QuickbaseAdmirer/QuickBase-C-Sharp-SDK](https://github.com/QuickbaseAdmirer/QuickBase-C-Sharp-SDK)

# python - 如何根据时间戳对 InstrumentedList 进行排序？

> ID：11513123
> 
> 赞同：3
> 
> 时间：2012-07-16T21:53:19.690
> 
> 标签：python, sqlalchemy, pyramid

目前`InstrumentedList`，我的金字塔应用程序中有一个代表一对多关系的关系。关系是通过以下方式构建的：

```
Class project:
 submissions = relationship('Submission', backref='project') 
```

我想遍历项目列表中的每个提交。但是，我希望我的提交按时间戳（一个`datetime`对象）排序

以下是我目前对提交的内容进行迭代的方式：

```
for project in projects:
    for submission in project.submissions:
        # Do some stuff with each submission here 
```

问题是每当重新加载应用程序时，我为每个项目提交的顺序都会发生变化。我需要顺序一致并按时间戳排序，我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T08:46:13.987

You'll need to specify an ordering in your relationship definition, using the [`order_by` parameter](http://docs.sqlalchemy.org/en/rel_0_7/orm/relationships.html#relationships-api):

```
class Project(Base):
    # ...
    submissions = relationship('Submission',
        backref='Project', order_by='Submission.timestamp') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-17T01:48:58.940

@martjin 答案完全可以，但是如果您想按**降序排列**表格，请使用**desc()**函数：

```
class Project(Base):
    # ...
    submissions = relationship('Submission',
        backref='Project', order_by='Submission.timestamp.desc()') 
```

# vim - 在 vim 颜色文件中突出显示

> ID：11513125
> 
> 赞同：0
> 
> 时间：2012-07-16T21:53:48.573
> 
> 标签：vim, macvim

我正在尝试在 vim 中编辑我的配色方案，我记得当我使用 Fedora 时，我可以在更改颜色时轻松预览颜色。

如果我有这样的一行：

```
let ColourAssignment['String']          = {"GUIFG": 'LightYellow', "CTERMFG": '118'} 
```

这个词`ColourAssignment`会被高亮为我设置的颜色`'string'`。

我现在使用的是 mac，但我拥有与使用 fedora 时相同的插件和 .vimrc。

有谁知道我需要设置什么，或者我可以使用什么插件来再次获得这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T07:22:40.543

这并不完全符合您的要求（它突出显示颜色本身，而不是突出显示组名称），但我强烈推荐[Colorizer 插件](http://www.vim.org/scripts/script.php?script_id=3567)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:53:59.423

我找到了我正在寻找的确切解决方案，事实证明强盗配色方案中包含一个语法文件，它允许此功能。

存储库是： [https ://github.com/vim-scripts/bandit.vim](https://github.com/vim-scripts/bandit.vim)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:31:28.770

也许你想要`:hi String guifg=LightYellow ctermfg=118`和`:syn match String /ColourAssignment/`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T11:39:12.770

或者，有在线 Vim 配色方案编辑器，例如：

*   [http://bytefluent.com/vivify/](http://bytefluent.com/vivify/)
*   [http://www.vimtax.com/](http://www.vimtax.com/)

# python - 在 PyQt 应用程序中嵌入 IPython Qt 控制台

> ID：11513132
> 
> 赞同：33
> 
> 时间：2012-07-16T21:54:22.803
> 
> 标签：python, qt, pyqt4, ipython

我想在我正在开发的 PyQt 应用程序中嵌入一个 IPython qt 控制台小部件。下面提供的代码（并改编自[https://stackoverflow.com/a/9796491/1332492](https://stackoverflow.com/a/9796491/1332492)）为 IPython v0.12 实现了这一点。但是，这在 IPython v0.13 中`self.heartbeat.start()`与`RuntimeError: threads can only be started once`. 注释掉这一行会打开小部件，但不会响应用户输入。

有谁知道如何实现 IPython v0.13 的等效功能？

```
"""
Adapted from
https://stackoverflow.com/a/9796491/1332492
"""
import os
import atexit

from IPython.zmq.ipkernel import IPKernelApp
from IPython.lib.kernel import find_connection_file
from IPython.frontend.qt.kernelmanager import QtKernelManager
from IPython.frontend.qt.console.rich_ipython_widget import RichIPythonWidget
from IPython.config.application import catch_config_error
from PyQt4 import QtCore

class IPythonLocalKernelApp(IPKernelApp):
    DEFAULT_INSTANCE_ARGS = ['']

    @catch_config_error
    def initialize(self, argv=None):
        super(IPythonLocalKernelApp, self).initialize(argv)
        self.kernel.eventloop = self.loop_qt4_nonblocking

    def loop_qt4_nonblocking(self, kernel):
        """Non-blocking version of the ipython qt4 kernel loop"""
        kernel.timer = QtCore.QTimer()
        kernel.timer.timeout.connect(kernel.do_one_iteration)
        kernel.timer.start(1000*kernel._poll_interval)

    def start(self, argv=DEFAULT_INSTANCE_ARGS):
        """Starts IPython kernel app
        argv: arguments passed to kernel
        """
        self.initialize(argv)
        self.heartbeat.start()

        if self.poller is not None:
            self.poller.start()

        self.kernel.start()

class IPythonConsoleQtWidget(RichIPythonWidget):
    _connection_file = None

    def __init__(self, *args, **kw):
        RichIPythonWidget.__init__(self, *args, **kw)
        self._existing = True
        self._may_close = False
        self._confirm_exit = False

    def _init_kernel_manager(self):
        km = QtKernelManager(connection_file=self._connection_file, config=self.config)
        km.load_connection_file()
        km.start_channels(hb=self._heartbeat)
        self.kernel_manager = km
        atexit.register(self.kernel_manager.cleanup_connection_file)

    def connect_kernel(self, connection_file, heartbeat=False):
        self._heartbeat = heartbeat
        if os.path.exists(connection_file):
            self._connection_file = connection_file
        else:
            self._connection_file = find_connection_file(connection_file)

        self._init_kernel_manager()

def main(**kwargs):
    kernelapp = IPythonLocalKernelApp.instance()
    kernelapp.start()

    widget = IPythonConsoleQtWidget()
    widget.connect_kernel(connection_file=kernelapp.connection_file)
    widget.show()

    return widget

if __name__ == "__main__":
    from PyQt4.QtGui import QApplication
    app = QApplication([''])
    main()
    app.exec_() 
```

v0.13 的回溯

```
RuntimeError                              Traceback (most recent call last)
/Users/beaumont/terminal.py in <module>()
     80     from PyQt4.QtGui import QApplication
     81     app = QApplication([''])
---> 82     main()
        global main = <function main at 0x106d0c848>
     83     app.exec_()

/Users/beaumont/terminal.py in main(**kwargs={})
     69 def main(**kwargs):
     70     kernelapp = IPythonLocalKernelApp.instance()
---> 71     kernelapp.start()
        kernelapp.start = <bound method IPythonLocalKernelApp.start of     <__main__.IPythonLocalKernelApp object at 0x106d10590>>
     72 
     73     widget = IPythonConsoleQtWidget()

/Users/beaumont/terminal.py in start(self=<__main__.IPythonLocalKernelApp object>, argv=[''])
     33         """
     34         self.initialize(argv)
---> 35         self.heartbeat.start()
        self.heartbeat.start = <bound method Heartbeat.start of <Heartbeat(Thread-1, started daemon 4458577920)>>
     36 
     37         if self.poller is not None:

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/threading.pyc in start(self=<Heartbeat(Thread-1, started daemon 4458577920)>)
    487             raise RuntimeError("thread.__init__() not called")
    488         if self.__started.is_set():
--> 489             raise RuntimeError("threads can only be started once")
        global RuntimeError = undefined
    490         if __debug__:
    491             self._note("%s.start(): starting thread", self)

RuntimeError: threads can only be started once 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T14:51:33.243

好的，这段代码似乎可以解决问题（即它在 Qt 小部件中放置了一个非阻塞 ipython 解释器，它可以嵌入到其他小部件中）。传递给`terminal_widget`添加到小部件命名空间的关键字

```
import atexit

from IPython.zmq.ipkernel import IPKernelApp
from IPython.lib.kernel import find_connection_file
from IPython.frontend.qt.kernelmanager import QtKernelManager
from IPython.frontend.qt.console.rich_ipython_widget import RichIPythonWidget
from IPython.utils.traitlets import TraitError
from PyQt4 import QtGui, QtCore

def event_loop(kernel):
    kernel.timer = QtCore.QTimer()
    kernel.timer.timeout.connect(kernel.do_one_iteration)
    kernel.timer.start(1000*kernel._poll_interval)

def default_kernel_app():
    app = IPKernelApp.instance()
    app.initialize(['python', '--pylab=qt'])
    app.kernel.eventloop = event_loop
    return app

def default_manager(kernel):
    connection_file = find_connection_file(kernel.connection_file)
    manager = QtKernelManager(connection_file=connection_file)
    manager.load_connection_file()
    manager.start_channels()
    atexit.register(manager.cleanup_connection_file)
    return manager

def console_widget(manager):
    try: # Ipython v0.13
        widget = RichIPythonWidget(gui_completion='droplist')
    except TraitError:  # IPython v0.12
        widget = RichIPythonWidget(gui_completion=True)
    widget.kernel_manager = manager
    return widget

def terminal_widget(**kwargs):
    kernel_app = default_kernel_app()
    manager = default_manager(kernel_app)
    widget = console_widget(manager)

    #update namespace                                                           
    kernel_app.shell.user_ns.update(kwargs)

    kernel_app.start()
    return widget

app = QtGui.QApplication([])
widget = terminal_widget(testing=123)
widget.show()
app.exec_() 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-12-16T12:17:52.730

@ChrisB 接受的答案适用于 IPython 0.13 版，但不适用于较新的版本。从github 上的 IPython 内核存储库的[示例部分，](https://github.com/ipython/ipykernel/tree/master/examples)[这](https://github.com/ipython/ipykernel/blob/master/examples/embedding/inprocess_qtconsole.py)是在 v1.x+（当前使用 4.0.1 测试）中执行此操作的方法，它具有控制台和内核在同一进程中的功能。

这是一个基于官方示例的示例，它提供了一个可以轻松插入应用程序的便利类。它设置为在 Python 2.7 上与 pyqt4 和 IPython 4.0.1 一起使用：

（注意：您需要安装[ipykernel](https://github.com/ipython/ipykernel)和[qtconsole](https://github.com/jupyter/qtconsole)软件包）

```
# Set the QT API to PyQt4
import os
os.environ['QT_API'] = 'pyqt'
import sip
sip.setapi("QString", 2)
sip.setapi("QVariant", 2)
from PyQt4.QtGui  import *
# Import the console machinery from ipython
from qtconsole.rich_ipython_widget import RichIPythonWidget
from qtconsole.inprocess import QtInProcessKernelManager
from IPython.lib import guisupport

class QIPythonWidget(RichIPythonWidget):
    """ Convenience class for a live IPython console widget. We can replace the standard banner using the customBanner argument"""
    def __init__(self,customBanner=None,*args,**kwargs):
        if not customBanner is None: self.banner=customBanner
        super(QIPythonWidget, self).__init__(*args,**kwargs)
        self.kernel_manager = kernel_manager = QtInProcessKernelManager()
        kernel_manager.start_kernel()
        kernel_manager.kernel.gui = 'qt4'
        self.kernel_client = kernel_client = self._kernel_manager.client()
        kernel_client.start_channels()

        def stop():
            kernel_client.stop_channels()
            kernel_manager.shutdown_kernel()
            guisupport.get_app_qt4().exit()            
        self.exit_requested.connect(stop)

    def pushVariables(self,variableDict):
        """ Given a dictionary containing name / value pairs, push those variables to the IPython console widget """
        self.kernel_manager.kernel.shell.push(variableDict)
    def clearTerminal(self):
        """ Clears the terminal """
        self._control.clear()    
    def printText(self,text):
        """ Prints some plain text to the console """
        self._append_plain_text(text)        
    def executeCommand(self,command):
        """ Execute a command in the frame of the console widget """
        self._execute(command,False)

class ExampleWidget(QWidget):
    """ Main GUI Widget including a button and IPython Console widget inside vertical layout """
    def __init__(self, parent=None):
        super(ExampleWidget, self).__init__(parent)
        layout = QVBoxLayout(self)
        self.button = QPushButton('Another widget')
        ipyConsole = QIPythonWidget(customBanner="Welcome to the embedded ipython console\n")
        layout.addWidget(self.button)
        layout.addWidget(ipyConsole)        
        # This allows the variable foo and method print_process_id to be accessed from the ipython console
        ipyConsole.pushVariables({"foo":43,"print_process_id":print_process_id})
        ipyConsole.printText("The variable 'foo' and the method 'print_process_id()' are available. Use the 'whos' command for information.")                           

def print_process_id():
    print 'Process ID is:', os.getpid()        

def main():
    app  = QApplication([])
    widget = ExampleWidget()
    widget.show()
    app.exec_()    

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-12-09T23:01:08.620

在 PyQt5 中工作的 2016 年更新：

```
from qtpy import QtGui
from qtconsole.rich_jupyter_widget import RichJupyterWidget
from qtconsole.inprocess import QtInProcessKernelManager
from IPython.lib import guisupport

class ConsoleWidget(RichJupyterWidget):

    def __init__(self, customBanner=None, *args, **kwargs):
        super(ConsoleWidget, self).__init__(*args, **kwargs)

        if customBanner is not None:
            self.banner = customBanner

        self.font_size = 6
        self.kernel_manager = kernel_manager = QtInProcessKernelManager()
        kernel_manager.start_kernel(show_banner=False)
        kernel_manager.kernel.gui = 'qt'
        self.kernel_client = kernel_client = self._kernel_manager.client()
        kernel_client.start_channels()

        def stop():
            kernel_client.stop_channels()
            kernel_manager.shutdown_kernel()
            guisupport.get_app_qt().exit()

        self.exit_requested.connect(stop)

    def push_vars(self, variableDict):
        """
        Given a dictionary containing name / value pairs, push those variables
        to the Jupyter console widget
        """
        self.kernel_manager.kernel.shell.push(variableDict)

    def clear(self):
        """
        Clears the terminal
        """
        self._control.clear()

        # self.kernel_manager

    def print_text(self, text):
        """
        Prints some plain text to the console
        """
        self._append_plain_text(text)

    def execute_command(self, command):
        """
        Execute a command in the frame of the console widget
        """
        self._execute(command, False)

if __name__ == '__main__':
    app = QtGui.QApplication([])
    widget = ConsoleWidget()
    widget.show()
    app.exec_() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-11T18:04:50.577

带有一些清理功能的 IPython 0.13 版本：

```
#coding: utf-8
'''
Updated for IPython 0.13
Created on 18-03-2012
Updated:   11-09-2012
@author: Paweł Jarosz
'''

import atexit

from PySide import QtCore, QtGui

from IPython.zmq.ipkernel import IPKernelApp
from IPython.lib.kernel import find_connection_file
from IPython.frontend.qt.kernelmanager import QtKernelManager
from IPython.frontend.qt.console.rich_ipython_widget import RichIPythonWidget
from IPython.config.application import catch_config_error

DEFAULT_INSTANCE_ARGS = ['qtconsole','--pylab=inline', '--colors=linux']

class IPythonLocalKernelApp(IPKernelApp):
    @catch_config_error
    def initialize(self, argv=DEFAULT_INSTANCE_ARGS):
        """
        argv: IPython args

        example:

            app = QtGui.QApplication([])
            kernelapp = IPythonLocalKernelApp.instance()
            kernelapp.initialize()

            widget = IPythonConsoleQtWidget()
            widget.set_default_style(colors='linux')

            widget.connect_kernel(connection_file=kernelapp.get_connection_file())
            # if you won't to connect to remote kernel you don't need kernelapp part, just widget part and:

            # widget.connect_kernel(connection_file='kernel-16098.json')

            # where kernel-16098.json is the kernel name
            widget.show()

            namespace = kernelapp.get_user_namespace()
            nxxx = 12
            namespace["widget"] = widget
            namespace["QtGui"]=QtGui
            namespace["nxxx"]=nxxx

            app.exec_()
        """
        super(IPythonLocalKernelApp, self).initialize(argv)
        self.kernel.eventloop = self.loop_qt4_nonblocking
        self.kernel.start()
        self.start()

    def loop_qt4_nonblocking(self, kernel):
        """Non-blocking version of the ipython qt4 kernel loop"""
        kernel.timer = QtCore.QTimer()
        kernel.timer.timeout.connect(kernel.do_one_iteration)
        kernel.timer.start(1000*kernel._poll_interval)

    def get_connection_file(self):
        """Returne current kernel connection file."""
        return self.connection_file

    def get_user_namespace(self):
        """Returns current kernel userspace dict"""
        return self.kernel.shell.user_ns

class IPythonConsoleQtWidget(RichIPythonWidget):

    def connect_kernel(self, connection_file, heartbeat = False):
        """
        connection_file: str - is the connection file name, for example 'kernel-16098.json'
        heartbeat: bool - workaround, needed for right click/save as ... errors ... i don't know how to 
                          fix this issue. Anyone knows? Anyway it needs more testing
            example1 (standalone):

                    app = QtGui.QApplication([])
                    widget = IPythonConsoleQtWidget()
                    widget.set_default_style(colors='linux')

                    widget.connect_kernel(connection_file='some connection file name')

                    app.exec_()

            example2 (IPythonLocalKernelApp):

                    app = QtGui.QApplication([])

                    kernelapp = IPythonLocalKernelApp.instance()
                    kernelapp.initialize()

                    widget = IPythonConsoleQtWidget()

                    # Green text, black background ;)
                    widget.set_default_style(colors='linux')

                    widget.connect_kernel(connection_file='kernelapp.get_connection_file())

                    app.exec_()

        """
        km = QtKernelManager(connection_file=find_connection_file(connection_file), config=self.config)
        km.load_connection_file()
        km.start_channels(hb=heartbeat)
        self.kernel_manager = km
        atexit.register(self.kernel_manager.cleanup_connection_file)

def main():

    app = QtGui.QApplication([])
    kernelapp = IPythonLocalKernelApp.instance()
    kernelapp.initialize()

    widget = IPythonConsoleQtWidget()
    widget.set_default_style(colors='linux')

    widget.connect_kernel(connection_file=kernelapp.get_connection_file())
    # if you connect to outside app kernel you don't need kernelapp part, 
    # just widget part and:

    # widget.connect_kernel(connection_file='kernel-16098.json')

    # where kernel-16098.json is the kernel name
    widget.show()

    namespace = kernelapp.get_user_namespace()
    nxxx = 12
    namespace["widget"] = widget
    namespace["QtGui"]=QtGui
    namespace["nxxx"]=nxxx

    app.exec_()

if __name__=='__main__':
    main() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-24T19:57:12.253

可能帮助其他人研究这个：我遇到了这个例子：

[https://github.com/gpoulin/python-test/blob/master/embedded_qtconsole.py](https://github.com/gpoulin/python-test/blob/master/embedded_qtconsole.py)

经过测试并与 PySide、IPython 2.1.0、Python 3.4.1 一起使用。看来我什至可以直接使用 matplotlib。

```
from IPython.qt.console.rich_ipython_widget import RichIPythonWidget
from IPython.qt.inprocess import QtInProcessKernelManager
from PySide import QtGui, QtCore

class EmbedIPython(RichIPythonWidget):

    def __init__(self, **kwarg):
        super(RichIPythonWidget, self).__init__()
        self.kernel_manager = QtInProcessKernelManager()
        self.kernel_manager.start_kernel()
        self.kernel = self.kernel_manager.kernel
        self.kernel.gui = 'qt4'
        self.kernel.shell.push(kwarg)
        self.kernel_client = self.kernel_manager.client()
        self.kernel_client.start_channels()

class MainWindow(QtGui.QMainWindow):

    def __init__(self, parent=None):
        super(MainWindow, self).__init__(parent)

        self.textEdit = QtGui.QTextEdit()

        but1 = QtGui.QPushButton('write')
        but1.clicked.connect(self.but_write)

        but2 = QtGui.QPushButton('read')
        but2.clicked.connect(self.but_read)

        self.a = {'text': ''}
        self.console = EmbedIPython(testing=123, a=self.a)
        self.console.kernel.shell.run_cell('%pylab qt')

        vbox = QtGui.QVBoxLayout()
        hbox = QtGui.QHBoxLayout()
        vbox.addWidget(self.textEdit)
        vbox.addWidget(self.console)
        hbox.addWidget(but1)
        hbox.addWidget(but2)
        vbox.addLayout(hbox)

        b = QtGui.QWidget()
        b.setLayout(vbox)
        self.setCentralWidget(b)

    def but_read(self):
        self.a['text'] = self.textEdit.toPlainText()
        self.console.execute("print('a[\\\'text\\\'] = \"'+ a['text'] +'\"')")

    def but_write(self):
        self.textEdit.setText(self.a['text'])

if __name__ == '__main__':
    import sys
    app = QtGui.QApplication(sys.argv)
    main = MainWindow()
    main.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-03T22:08:15.460

更新答案：

*   蟒蛇 3.8
*   IPython 7.22.0
*   QtConsole 5.0.3

根据之前的答案修改。

```
from qtpy.QtWidgets import QApplication
from qtconsole.rich_jupyter_widget import RichJupyterWidget
from qtconsole.inprocess import QtInProcessKernelManager
from IPython.lib import guisupport

class ConsoleWidget(RichJupyterWidget):

    def __init__(self, customBanner=None, *args, **kwargs):
        super(ConsoleWidget, self).__init__(*args, **kwargs)

        if customBanner is not None:
            self.banner = customBanner

        self.font_size = 10
        self.kernel_manager = QtInProcessKernelManager()
        self.kernel_manager.start_kernel(show_banner=False)
        self.kernel_manager.kernel.gui = 'qt'
        self.kernel_client = self._kernel_manager.client()
        self.kernel_client.start_channels()

        def stop():
            self.kernel_client.stop_channels()
            self.kernel_manager.shutdown_kernel()
            guisupport.get_app_qt4().exit()

        self.exit_requested.connect(stop)

    def push_vars(self, variableDict):
        """
        Given a dictionary containing name / value pairs, push those variables
        to the Jupyter console widget
        """
        self.kernel_manager.kernel.shell.push(variableDict)

    def clear(self):
        """
        Clears the terminal
        """
        self._control.clear()

    def print_text(self, text):
        """
        Prints some plain text to the console
        """
        self._append_plain_text(text)

    def execute_command(self, command):
        """
        Execute a command in the frame of the console widget
        """
        self._execute(command, False)

if __name__ == '__main__':
    app = QApplication([])
    widget = ConsoleWidget()
    widget.show()
    app.exec_() 
```

# spring-mvc - MappingJacksonJsonView 返回顶级json对象

> ID：11513133
> 
> 赞同：5
> 
> 时间：2012-07-16T21:54:25.883
> 
> 标签：spring-mvc, jackson

我转换为控制器以使用 ContentNegotiatingViewResolver 而不是 MessageConverters 来支持多种输出类型。使用 json，我正在使用 MappingJacksonJsonView：

```
<bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="order" value="1" />
    <property name="mediaTypes">
        <map>
            <entry key="html" value="text/html"/>
            <entry key="json" value="application/json" />
            <entry key="xml" value="application/xml" />
        </map>
    </property>
    <property name="defaultViews">
        <list>
            <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />
            <bean class="org.springframework.web.servlet.view.xml.MarshallingView">
                <constructor-arg>
                    <bean class="org.springframework.oxm.xstream.XStreamMarshaller" />
                </constructor-arg>
            </bean>                         
        </list>
    </property>
    <property name="ignoreAcceptHeader" value="true" />
    <property name="defaultContentType" value="application/json" />
</bean> 
```

使用以下控制器逻辑：

```
@RequestMapping(value = "/id/{id}", method = RequestMethod.GET)
public ModelAndView getById(@PathVariable (value="id") String id) {
    MyObject ret = doGetById(id);
    ModelAndView modelAndView = new ModelAndView("common/single");
    modelAndView.addObject("myObject", ret);
    return modelAndView;
} 
```

当我访问 /id/1234.json 时返回的 json 类似于：

```
{
   myObject: {
        field1:"abc",
        field2:"efg"
   }
} 
```

有没有办法让我将 myObject 设置为结果的顶级节点，所以它看起来像这样：

```
{
    field1:"abc",
    field2:"efg"
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T15:19:34.690

正在发生的事情是 Spring MVC 正在使用 ModelAndView 并将其序列化为 JSON。由于 ModelAndView 看起来就像一张地图，在这种情况下，您在地图中只有一个条目，其键名为 myObject，这就是 JSON 响应所查看的内容。为了只获取您的对象，您需要只返回您的对象而不是 ModelAndView，并让 Jackson 将您的对象序列化为 JSON。

与其返回 ModelAndView，不如返回一个 MyObject 并用 注释该方法`@ResponseBody`，因此您的控制器方法变为

```
@RequestMapping(value="/id/{id}", method=RequestMethod.GET, produces="application/json")
public @ResponeBody MyObject getById(@PathVariable (value="id") String id) {
    return doGetById(id);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-15T01:13:31.287

您应该能够使用以下方法删除外部节点[`MappingJacksonJsonView.setExtractValueFromSingleKeyModel(true)`](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/servlet/view/json/MappingJacksonJsonView.html#setExtractValueFromSingleKeyModel%28boolean%29)：

> 设置是否将包含单个属性的模型序列化为映射，或者是否从模型中提取单个值并直接序列化。
> 
> 设置此标志的效果类似于将 MappingJacksonHttpMessageConverter 与 @ResponseBody 请求处理方法一起使用。

例如：

```
private final MappingJacksonJsonView view = new MappingJacksonJsonView();

public MyController() {
     view.setExtractValueFromSingleKeyModel(true);
}

@RequestMapping(value = "/id/{id}", method = RequestMethod.GET)
public ModelAndView getById(@PathVariable (value="id") String id) {
    MyObject ret = doGetById(id);
    ModelAndView modelAndView = new ModelAndView();
    modelAndView.setView(this.view);
    modelAndView.addObject("myObject", ret);
    return modelAndView;
} 
```

如果您更喜欢通过配置执行此操作，这也应该有效：

```
<bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
    <property name="extractValueFromSingleKeyModel" value="true" />
</bean> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-22T13:49:04.330

我遇到了同样的问题，以下解决方案对我有用。

```
<bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
   <property name="prefixJson" value="true" />
</bean> 
```

# mysql - 仅当 if 语句为真时才执行 INSERT

> ID：11513134
> 
> 赞同：0
> 
> 时间：2012-07-16T21:54:28.763
> 
> 标签：mysql

我想执行一行 INSERT，但前提是 if 条件为真。

这是伪代码中的一个基本示例（只是为了简化问题）。

```
"If there is a user id = 5 in the users table (using SELECT), execute: INSERT INTO someOtherTable ... ()" 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:00:10.800

如果 users.id 是主键或至少是唯一的

```
INSERT INTO someOtherTable
SELECT 123, 456, 'a string value'
FROM users
WHERE id = 5 
```

对于非唯一测试，您可以使用特殊表 DAUL

```
INSERT INTO someOtherTable
SELECT 123, 456, 'a string value'
FROM DUAL
WHERE 5 IN (SELECT id FROM users WHERE id = 5) 
```

# css - 我可以只更改页面上一两个链接的“已访问”颜色吗？

> ID：11513137
> 
> 赞同：2
> 
> 时间：2012-07-16T21:54:35.593
> 
> 标签：css, hyperlink

我只想更改页面上两个链接的访问颜色。我有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T21:59:07.553

仅在您想要不同访问颜色的链接上放置一个类，例如：

```
<a class="different">Different</a> 
```

然后在 CSS 中以任何您想要的方式设置已访问过的链接类的样式，例如：

```
.different:visited {color:chartreuse;} 
```

这使用[:visited 伪类](https://developer.mozilla.org/En/CSS/%3avisited)来设置仅访问过的链接的样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:02:00.927

是的，有办法做到这一点。给这两个链接一个特殊的 CSS 类，然后`:visited`像往常一样使用选择器。在本例中，我将其命名为`.special`.

```
<a href="...">Link one</a>
<a href="..." class="special">Link two</a> 
```

然后，在您的样式表中：

```
a:visited {
    color: purple;
}

a.special:visited {
    color: pink;
} 
```

“链接一”在访问时将显示为紫色。链接二，当被访问时，将显示为粉红色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T22:06:59.040

如果您不想或不能按照@Adam 的建议将类添加到您的锚标签：

```
a[href='https://www.google.com/']:visited { color:#FF0000; }
a[href='https://www.facebook.com/']:visited { color:#0000FF; } 
```

# jquery - jquery - 获取图片填充设置的图像的src

> ID：11513138
> 
> 赞同：1
> 
> 时间：2012-07-16T21:54:39.340
> 
> 标签：jquery, image, responsive-design, src

我正在使用[Scott Jehl 的图片填充](https://github.com/scottjehl/picturefill)在我的网站上响应地提供图像。我的代码如下所示：

```
<div data-picture id="front-image">
    <div data-src="image.jpg"></div>
    <div data-media="(min-width: 600px)" data-src="image-medium.jpg"></div>
    <div data-media="(min-width: 900px)" data-src="image-large.jpg"></div>
    <noscript><img src="image.jpg"></noscript>
</div> 
```

页面经过 Picturefill 处理后，代码如下所示：

```
<div data-picture="" id="front-image">
    <div data-src="image.jpg"></div>
    <div data-media="(min-width: 600px)" data-src="image-medium.jpg"></div>
    <div data-media="(min-width: 900px)" data-src="image-large.jpg"></div>
    <noscript><img src="image.jpg"></noscript>
    <img alt="" src="image-large.jpg">
</div> 
```

注意主 div 末尾的新 img 标签；那是脚本生成的（在这种情况下，因为我的浏览器窗口很大，所以它是大图像）。

我想获取该图像的 src，但是当我执行类似的操作时

```
$(function() {
   var src = $('#front-image img').attr('src');
   // do other stuff with that variable once I have it
}); 
```

在 Picturefill 之后调用的 javascript 文件中，var 为空。

我最好的猜测是文档已经“准备好”，并且在 Picturefill 魔术发生*之前评估了 js。*我怎样才能让我的代码等到 Picturefill 完成其职责，以便我可以从该 img 标签中获取 src？

[这里完全不是 javascript 人，所以很明显，如果有另一种方法可以获取 src 或者我的猜测完全错误，请纠正我！]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T20:51:10.233

Picturefill 很棒，但我在处理真实图像时遇到了一些类似的挑战。

我最终创建了[jquery.pikshur](https://github.com/geekytime/jquery.pikshur)插件，它与图片填充基本相同，但让您对元素有更多的控制，包括允许图像的 onLoad 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:46:51.967

我最终做了@raminson 建议的第一件事 - 拼接出一段图片填充脚本（在本例中是使用 matchmedia 的部分）并使用它来确定哪个图像对于这个屏幕尺寸是正确的加载。

```
 $("#front-image div").each(function() {
            var media = $(this).attr( "data-media" );
                if( !media || (matchMedia &&matchMedia( media ).matches ) ){
                    var imgsrc = $(this).attr("data-src");
                    // do stuff with the img src
                }
            }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:01:47.487

on 选项是使用`DOMNodeInserted`事件，它在插入新`node`元素后触发。

```
$(document).on('DOMNodeInserted', function() {
   var src = $('#front-image > img').attr('src');
}) 
```

# java - 将for循环输入的数字相加

> ID：11513139
> 
> 赞同：0
> 
> 时间：2012-07-16T21:54:49.317
> 
> 标签：java

我的目标是使用 for-loop 添加用户输入的数字。

这是我的代码：

```
import java.io.*;
class Student {
    public static void main (String args[]){
    int mks=0, i=0 ,percnt=0;
    BufferedReader br = new BufferedReader (new InputStreamReader(System.in));
        try {
            System.out.println("Enter Marks Of Student ");      

            for (i=0;i<=4;i++){
            mks= Integer.parseInt(br.readLine());
            mks=mks+i;
            }
        }catch (Exception e) {}
        percnt=mks/5;

        System.out.println("GRAND TOTAL = "+mks+ " PERCENTAGE"+percnt);
    }
} 
```

我正在使用此代码获得最后输入的标记 + 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:58:13.500

> “我的目​​标是添加用户使用 for 循环输入的数字”

您需要累积用户输入的每个整数：

```
mks += Integer.parseInt(br.readLine()); 
```

> “我得到最后输入的分数 + 4 使用此代码”

这是因为您的代码：

```
mks= Integer.parseInt(br.readLine());  // Get the integer the user entered
mks=mks+i;        // Add i (which in the case of the last iteration is 4) 
```

正在设置`mks`每次循环重新启动时的值。此外，如果您尝试计算用户输入的所有数字，则无需将循环计数器添加`i`到累加器变量`mks`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:09:33.263

你的代码应该是这样的。

```
int mks=0, i=0 ,percnt=0;
BufferedReader br = new BufferedReader (new InputStreamReader(System.in));
try {
    System.out.println("Enter Marks Of Student ");

for (i=0;i<=4;i++){
    mks+=Integer.parseInt(br.readLine())+i;
    //mks=mks+i;
}
}catch (Exception e) {}
percnt=mks/5;
System.out.println("GRAND TOTAL = "+mks+ " PERCENTAGE"+percnt); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T21:58:53.637

每次“mks= Integer.parseInt(br.readLine());” 被调用时，它会覆盖 mks 的先前值。所以最后一次运行它时，你会得到最后一行输入 +4（当时 i 的值）。

如果您想对所有加载标记的值求和，您应该创建一个不会被覆盖的新变量。或者，您可以这样做

```
mrks = mrks + Integer.parseInt(br.readLine()) + i 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:59:20.377

您将在每次循环迭代时重新初始化您的累加器 (mks) 变量。

您需要在循环之外定义一次，值为 0，然后在每次循环迭代中添加它。

另外，摆脱 `mks=mks+i`

最后，捕捉异常并忽略它们对你没有任何好处。当出现异常时，您至少应该显示一条错误消息。否则，只需在子句中声明异常`throws`，并让它传播（即让它终止程序）。

# .net - 来自 ASPxGridView 的 DevExpress 详细信息视图

> ID：11513144
> 
> 赞同：0
> 
> 时间：2012-07-16T21:55:22.537
> 
> 标签：.net, devexpress, aspxgridview

首先，我是 DevExpress 的新手。我已经进行了大量搜索，但还没有找到我想要做的解决方案：从基于行键的 ASPxGridView 打开详细信息页面。

我看过子详细信息示例，但由于我有多个相关表，每个表可能包含太多行，无法很好地嵌套在网格中显示，我想为此视图创建一个单独的页面。

我已经完成了主网格。我还没想通的是

1.  如何根据行键在列中创建链接。
2.  创建相关详细信息页面的最佳方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:35:13.493

您可以在 GridView 中有一个列（其中包含一个超链接），单击该列会调用一个 JavaScript 函数。JS 函数会执行适当的操作来拉出详细信息视图，根据您的需要，该视图可以是页面重定向或 Ajax 弹出详细信息视图。

```
 <dxwgv:GridViewDataTextColumn Caption="Details">
    <EditFormSettings Visible="False" />
    <DataItemTemplate>
        <a href="showDetails('<%# Container.KeyValue.ToString() %>')"> Show Details </a>
    </DataItemTemplate>
</dxwgv:GridViewDataTextColumn> 
```

JS代码...

```
<script type="text/javascript">
    function showDetails(rowId){
        //Your Logic of how to display Details for the Row id
    }    
</script> 
```

# java - 需要输入“pass”两次才能前进

> ID：11513146
> 
> 赞同：2
> 
> 时间：2012-07-16T21:55:26.717
> 
> 标签：java, validation, blackjack

感谢您阅读本文。我正在使用 java 创建一个简单的通用版本的二十一点。其他一切都很好，除了当它问你“击中或传球”并且你输入 pass 时，你必须输入两次才能重新调整它，我似乎无法找出原因。这是我在 pastebin 上的代码，以便于阅读： http: [//pastebin.com/GF7Rzusx](http://pastebin.com/GF7Rzusx)

来自 pastebin 的相关代码：

```
 public void ask()
    {
        System.out.println("Hit or Pass?");
        if (in.next().equalsIgnoreCase("Hit"))
        {
            hit();
        }
        if (in.next().equalsIgnoreCase("Pass"))
        {
            pass();
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:00:49.453

如果输入的字是`"Pass"`从标准输入读取然后丢失，则不存储。必须存储它以便在后续检查中再次可用：

```
String input = in.next();

if (input.equalsIgnoreCase("Hit"))
{
    hit();
}
else if (input.equalsIgnoreCase("Pass"))
{
    pass();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T22:00:40.730

你当然想要：

```
public void ask()
{
    System.out.println("Hit or Pass?");
    String answer = in.next();
    if (answer.equalsIgnoreCase("Hit"))
    {
        hit();
    } else if (answer.equalsIgnoreCase("Pass"))
    {
        pass();
    }
} 
```

每次调用`in.next()`它都会丢弃先前的输入并期望另一个令牌（输入）。

## 例子

想象一下如果你有会发生什么：

```
System.out.println(in.next());
System.out.println(in.next()); 
```

它期望输入什么，输出什么？

## 代码的主要区别

请注意，新代码有两个不同之处：

1.  您只需调用`in.next()`一次，因此只需要一个输入，该输入存储为`answer`.
2.  如果答案还不是“命中”，您只需检查答案是否为“通过”。

请参阅[Java Scanner.next 文档](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#next%28%29)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T22:01:38.867

在第 112 行，您执行以下操作：

```
in.next() 
```

这将读取一个字符串标记。所以如果你写pass，这个函数会返回“pass”。

问题是你没有保存这个值。相反，您在第 116 行再次运行 in.next()，这将要求您再次编写 pass。

相反，您希望将 in.next() 返回的字符串存储在第 112 行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T22:13:18.720

这是因为 ask() 方法的结构方式。由于您有两个 if 语句，因此在检查响应是否“命中”时调用 in.next() 一次，然后在检查“通过”时调用第二次。当您输入“pass”时，第一个 if 语句调用 next()，它返回“pass”并检查是否等于“hit”，然后继续。那么当第二个 if 语句调用 next() 时，没有下一个要返回的条目，所以你必须再次输入“pass”。但是，当您输入“hit”时，这会起作用，因为这是检查的第一种情况。

重构所以 ask 只调用一次 next() 应该可以解决问题。

# google-chrome - 出国时如何设置 Chrome 以我的语言搜索

> ID：11513147
> 
> 赞同：0
> 
> 时间：2012-07-16T21:55:26.230
> 
> 标签：google-chrome, settings

每次我出国时，Chrome 都会使用当地语言进行搜索。我正在使用 Mac OX 10.5.9 和 Chrome 17.0.963。我在 chrome://settings/searchEngines 中更改为 www.google.co.uk 但仍然忽略了这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T12:33:44.473

您可以使用 Google NCR（无国家识别）“hack”：

1.  设置您的默认语言偏好：[http ://www.google.com/preferences#languages](http://www.google.com/preferences#languages)
2.  使用“ncr”谷歌门户：[http ://www.google.com/ncr](http://www.google.com/ncr)

也可以看看：

[http://support.google.com/websearch/bin/answer.py?hl=en&answer=873](http://support.google.com/websearch/bin/answer.py?hl=en&answer=873)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T12:11:55.657

显然这与多功能框有关，您可以在设置下进行设置：

铬：//设置/浏览器

当我提出这个问题时，我以前从未见过这个。这是解释：

[https://support.google.com/chrome/bin/answer.py?hl=en&answer=1618699](https://support.google.com/chrome/bin/answer.py?hl=en&answer=1618699)

# asp.net - Safari 的 ASP.NET 问题

> ID：11513148
> 
> 赞同：0
> 
> 时间：2012-07-16T21:55:28.113
> 
> 标签：asp.net, security, safari

我正在使用我们的承包商网站跟踪客户问题。我有不少客户抱怨他们无法访问他们的帐户（在安全的服务器上）。用户将收到服务器错误。当我要求他们尝试使用不同的浏览器时，问题就消失了。

我不知道从哪里开始寻找 Safari 与我们的服务器存在问题的原因。该站点是使用 ASP.NET 构建的。我对 Safari 问题以及 Safari 如何处理数据传输几乎一无所知。我不知道 Safari 是否不喜欢我们保存 cookie 的方式，是验证问题还是什么。

“登录”按钮似乎正在向服务器发送请求，因为我们的承包商正在获取错误日志。（不幸的是，他们没有向我们发送这些错误日志，所以我自己无法真正审查它们。当您要求查看他们的日志时，承包商不喜欢它。）

有没有人有最模糊的建议？你在 Safari 上遇到过类似的错误或奇怪的问题吗？

# r - 在 R 中可视化纵向分类数据的好方法

> ID：11513149
> 
> 赞同：29
> 
> 时间：2012-07-16T21:55:31.873
> 
> 标签：r, graphics, visualization, data-visualization

[**更新：**虽然我已经接受了一个答案，但如果您有其他可视化想法（无论是 R 还是其他语言/程序），请添加另一个答案。关于分类数据分析的文本似乎没有太多关于可视化纵向数据，而关于纵向数据分析的文本似乎没有太多关于可视化类别成员随时间推移的主题内变化。对这个问题有更多的答案将使它成为解决标准参考文献中没有得到太多报道的问题的更好资源。]

一位同事刚刚给了我一个纵向分类数据集来查看，我试图弄清楚如何在可视化中捕获纵向方面。我在这里发帖，因为我想在 R 中执行此操作，但请让我知道交叉发布到 Cross-Validated 是否有意义，因为通常不鼓励交叉发布。

快速背景：数据跟踪通过学术咨询计划的学生从学期到学期的学术地位。数据为长格式，有五个变量：“id”、“cohort”、“term”、“standing”和“termGPA”。前两个标识学生和他们在咨询计划中的术语。最后三个是记录学生的学术地位和 GPA 的术语。我在下面粘贴了一些示例数据，使用`dput`.

我创建了一个马赛克图（见下文），按队列、地位和学期对学生进行分组。这显示了每个学期在每个学术地位类别中的学生比例。但这并没有捕捉到纵向方面——随着时间的推移跟踪个别学生的事实。我想跟踪具有给定学术地位的学生群体随着时间的推移所经历的路径。

例如：在 2009 年秋季（“F09”）获得“AP”（学术缓刑）的学生中，有多少部分在未来仍是 AP，有多少部分进入其他类别（例如，GS，“良好的信誉”）？自进入咨询计划以来，随着时间的推移，群组之间在类别之间的移动方面是否存在差异？

我不太清楚如何在 R 图形中捕捉这种纵向方面。该`vcd`软件包具有可视化分类数据的功能，但似乎并未解决*纵向*分类数据。是否有可视化纵向分类数据的“标准”方法？R是否有为此设计的包？长格式适合这种类型的数据还是使用宽格式会更好？

我将不胜感激有关解决此特定问题的建议，以及对文章、书籍等的建议，以了解更多有关可视化纵向分类数据的信息。

这是我用来制作马赛克图的代码。该代码使用下面列出的数据`dput`。

```
library(RColorBrewer)

# create a table object for plotting
df1.tab = table(df1$cohort, df1$term, df1$standing,
            dnn=c("Cohort\nAcademic Standing", "Term", "Standing"))

# create a mosaic plot
plot(df1.tab, las=1, dir=c("h","v","h"), 
     col=brewer.pal(8,"Dark2"),
     main="Fall 2009 and Fall 2010 Cohorts") 
```

这是马赛克图（附带问题：是否有任何方法可以使 F10 队列的列直接位于 F09 队列的列下方并具有与 F09 队列的列相同的宽度，即使 F10 队列中的某些术语没有数据？） ：

![在此处输入图像描述](../Images/0ff93bc8b445fd24f5645d0c691349c7.png)

这是用于创建表格和绘图的数据：

```
df1 =
structure(list(id = c(101L, 102L, 103L, 104L, 105L, 106L, 107L, 
108L, 109L, 110L, 111L, 112L, 113L, 114L, 115L, 116L, 117L, 118L, 
119L, 120L, 121L, 122L, 123L, 124L, 125L, 101L, 102L, 103L, 104L, 
105L, 106L, 107L, 108L, 109L, 110L, 111L, 112L, 113L, 114L, 115L, 
116L, 117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L, 101L, 
102L, 103L, 104L, 105L, 106L, 107L, 108L, 109L, 110L, 111L, 112L, 
113L, 114L, 115L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, 123L, 
124L, 125L, 101L, 102L, 103L, 104L, 105L, 106L, 107L, 108L, 109L, 
110L, 111L, 112L, 113L, 114L, 115L, 116L, 117L, 118L, 119L, 120L, 
121L, 122L, 123L, 124L, 125L, 101L, 102L, 103L, 104L, 105L, 106L, 
107L, 108L, 109L, 110L, 111L, 112L, 113L, 114L, 115L, 116L, 117L, 
118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L, 101L, 102L, 103L, 
104L, 105L, 106L, 107L, 108L, 109L, 110L, 111L, 112L, 113L, 114L, 
115L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L, 
101L, 102L, 103L, 104L, 105L, 106L, 107L, 108L, 109L, 110L, 111L, 
112L, 113L, 114L, 115L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, 
123L, 124L, 125L), cohort = structure(c(1L, 1L, 1L, 1L, 2L, 1L, 
1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 
1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 
2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 
1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 
1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 
2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 
1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L), .Label = c("F09", "F10"), class = c("ordered", 
"factor")), term = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 
5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 
5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 
6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 
7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 
7L, 7L, 7L, 7L, 7L, 7L, 7L), .Label = c("S09", "F09", "S10", 
"F10", "S11", "F11", "S12"), class = c("ordered", "factor")), 
    standing = structure(c(2L, 4L, 1L, 4L, NA, 4L, 1L, NA, NA, 
    NA, NA, 2L, 2L, 1L, 4L, 4L, 1L, 3L, NA, NA, 4L, 3L, 1L, 4L, 
    NA, 2L, 1L, 3L, 3L, NA, 1L, 2L, NA, NA, NA, NA, 2L, 4L, 3L, 
    4L, 4L, 4L, 2L, NA, NA, 4L, 2L, 4L, 4L, NA, 3L, 4L, 6L, 6L, 
    1L, 4L, 4L, 1L, 1L, 1L, 1L, 1L, 4L, 6L, 4L, 4L, 1L, 4L, 1L, 
    2L, 4L, 3L, 1L, 4L, 1L, 6L, 1L, 6L, 6L, 7L, 4L, 4L, 2L, 2L, 
    4L, 2L, 6L, 4L, 6L, 7L, 4L, 2L, 4L, 1L, 2L, 4L, 6L, 6L, 4L, 
    2L, 2L, 3L, 6L, 6L, 7L, 4L, 4L, 3L, 4L, 4L, 6L, 2L, 1L, 6L, 
    6L, 4L, 2L, 1L, 7L, 2L, 4L, 6L, 6L, 4L, 4L, 3L, 6L, 4L, 6L, 
    2L, 4L, 4L, 6L, 4L, 4L, 6L, 3L, 2L, 6L, 6L, 4L, 2L, 6L, 3L, 
    4L, 4L, 6L, 6L, 4L, 4L, 5L, 6L, 4L, 6L, 4L, 4L, 4L, 5L, 4L, 
    4L, 6L, 6L, 2L, 6L, 6L, 4L, 3L, 6L, 6L, 4L, 4L, 6L, 6L, 4L, 
    4L), .Label = c("AP", "CP", "DQ", "GS", "DM", "NE", "WD"), class = "factor"), 
    termGPA = c(1.433, 1.925, 1, 1.68, NA, 1.579, 1.233, NA, 
    NA, NA, NA, 2.009, 1.675, 0, 1.5, 1.86, 0.5, 0.94, NA, NA, 
    1.777, 1.1, 1.133, 1.675, NA, 2, 1.25, 1.66, 0, NA, 1.525, 
    2.25, NA, NA, NA, NA, 1.66, 2.325, 0, 2.308, 1.6, 1.825, 
    2.33, NA, NA, 2.65, 2.65, 2.85, 3.233, NA, 1.25, 1.575, NA, 
    NA, 1, 2.385, 3.133, 0, 0, 1.729, 1.075, 0, 4, NA, 2.74, 
    0, 1.369, 2.53, 0, 2.65, 2.75, 0, 0.333, 3.367, 1, NA, 0.1, 
    NA, NA, 1, 2.2, 2.18, 2.31, 1.75, 3.073, 0.7, NA, 1.425, 
    NA, 2.74, 2.9, 0.692, 2, 0.75, 1.675, 2.4, NA, NA, 3.829, 
    2.33, 2.3, 1.5, NA, NA, NA, 2.69, 1.52, 0.838, 2.35, 1.55, 
    NA, 1.35, 0.66, NA, NA, 1.35, 1.9, 1.04, NA, 1.464, 2.94, 
    NA, NA, 3.72, 2.867, 1.467, NA, 3.133, NA, 1, 2.458, 1.214, 
    NA, 3.325, 2.315, NA, 1, 2.233, NA, NA, 2.567, 1, NA, 0, 
    3.325, 2.077, NA, NA, 3.85, 2.718, 1.385, NA, 2.333, NA, 
    2.675, 1.267, 1.6, 1.388, 3.433, 0.838, NA, NA, 0, NA, NA, 
    2.6, 0, NA, NA, 1, 2.825, NA, NA, 3.838, 2.883)), .Names = c("id", 
"cohort", "term", "standing", "termGPA"), row.names = c("101.F09.s09", 
"102.F09.s09", "103.F09.s09", "104.F09.s09", "105.F10.s09", "106.F09.s09", 
"107.F09.s09", "108.F10.s09", "109.F10.s09", "110.F10.s09", "111.F10.s09", 
"112.F09.s09", "113.F09.s09", "114.F09.s09", "115.F09.s09", "116.F09.s09", 
"117.F09.s09", "118.F09.s09", "119.F10.s09", "120.F10.s09", "121.F09.s09", 
"122.F09.s09", "123.F09.s09", "124.F09.s09", "125.F10.s09", "101.F09.f09", 
"102.F09.f09", "103.F09.f09", "104.F09.f09", "105.F10.f09", "106.F09.f09", 
"107.F09.f09", "108.F10.f09", "109.F10.f09", "110.F10.f09", "111.F10.f09", 
"112.F09.f09", "113.F09.f09", "114.F09.f09", "115.F09.f09", "116.F09.f09", 
"117.F09.f09", "118.F09.f09", "119.F10.f09", "120.F10.f09", "121.F09.f09", 
"122.F09.f09", "123.F09.f09", "124.F09.f09", "125.F10.f09", "101.F09.s10", 
"102.F09.s10", "103.F09.s10", "104.F09.s10", "105.F10.s10", "106.F09.s10", 
"107.F09.s10", "108.F10.s10", "109.F10.s10", "110.F10.s10", "111.F10.s10", 
"112.F09.s10", "113.F09.s10", "114.F09.s10", "115.F09.s10", "116.F09.s10", 
"117.F09.s10", "118.F09.s10", "119.F10.s10", "120.F10.s10", "121.F09.s10", 
"122.F09.s10", "123.F09.s10", "124.F09.s10", "125.F10.s10", "101.F09.f10", 
"102.F09.f10", "103.F09.f10", "104.F09.f10", "105.F10.f10", "106.F09.f10", 
"107.F09.f10", "108.F10.f10", "109.F10.f10", "110.F10.f10", "111.F10.f10", 
"112.F09.f10", "113.F09.f10", "114.F09.f10", "115.F09.f10", "116.F09.f10", 
"117.F09.f10", "118.F09.f10", "119.F10.f10", "120.F10.f10", "121.F09.f10", 
"122.F09.f10", "123.F09.f10", "124.F09.f10", "125.F10.f10", "101.F09.s11", 
"102.F09.s11", "103.F09.s11", "104.F09.s11", "105.F10.s11", "106.F09.s11", 
"107.F09.s11", "108.F10.s11", "109.F10.s11", "110.F10.s11", "111.F10.s11", 
"112.F09.s11", "113.F09.s11", "114.F09.s11", "115.F09.s11", "116.F09.s11", 
"117.F09.s11", "118.F09.s11", "119.F10.s11", "120.F10.s11", "121.F09.s11", 
"122.F09.s11", "123.F09.s11", "124.F09.s11", "125.F10.s11", "101.F09.f11", 
"102.F09.f11", "103.F09.f11", "104.F09.f11", "105.F10.f11", "106.F09.f11", 
"107.F09.f11", "108.F10.f11", "109.F10.f11", "110.F10.f11", "111.F10.f11", 
"112.F09.f11", "113.F09.f11", "114.F09.f11", "115.F09.f11", "116.F09.f11", 
"117.F09.f11", "118.F09.f11", "119.F10.f11", "120.F10.f11", "121.F09.f11", 
"122.F09.f11", "123.F09.f11", "124.F09.f11", "125.F10.f11", "101.F09.s12", 
"102.F09.s12", "103.F09.s12", "104.F09.s12", "105.F10.s12", "106.F09.s12", 
"107.F09.s12", "108.F10.s12", "109.F10.s12", "110.F10.s12", "111.F10.s12", 
"112.F09.s12", "113.F09.s12", "114.F09.s12", "115.F09.s12", "116.F09.s12", 
"117.F09.s12", "118.F09.s12", "119.F10.s12", "120.F10.s12", "121.F09.s12", 
"122.F09.s12", "123.F09.s12", "124.F09.s12", "125.F10.s12"), reshapeLong = structure(list(
    varying = list(c("s09as", "f09as", "s10as", "f10as", "s11as", 
    "f11as", "s12as"), c("s09termGPA", "f09termGPA", "s10termGPA", 
    "f10termGPA", "s11termGPA", "f11termGPA", "s12termGPA")), 
    v.names = c("standing", "termGPA"), idvar = c("id", "cohort"
    ), timevar = "term"), .Names = c("varying", "v.names", "idvar", 
"timevar")), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-17T07:38:09.610

以下是绘制数据的一些想法。我使用了ggplot2，并且在某些地方重新格式化了数据。

## 图1

![在此处输入图像描述](../Images/fbfc10d124a4d3ba1b9d882db7172de2.png) 我使用堆叠条形图来模拟您的马赛克图并解决对齐问题。

## 图 2

![在此处输入图像描述](../Images/d3fd7d9289c475df682cbe70ccc1bc3d.png) 每个学生的数据点由一条灰线连接，这让人想起平行坐标图。为点着色显示分类地位。在 y 轴上使用 GPA 有助于分散点以减少过度绘制，并显示站立和 GPA 的相关性。一个主要问题是许多有效`standing`数据点因为缺少匹配的 termGPA 值而丢失。

## 图 3

![在此处输入图像描述](../Images/871e626fc38f4c0077eacecfad873c44.png) 在这里，我创建了一个名为 initial_standing 的新变量，用于分面。每个面板都包含在队列和 initial_standing 中匹配的学生。将 id 绘制为文本会使该图有点混乱，但在某些情况下可能很有用。

## 图 4

![在此处输入图像描述](../Images/bdf41168ef7bd8af3a8fccd0c48353bd.png) 这个图就像一个热图，其中每一行都是一个学生。我控制`id`轴的顺序以强制 initial_standing 和群组分组保持在一起。如果您有更多行，您可能需要考虑按某种类型的聚类对行进行排序。

```
library(ggplot2)

# Create new data frame for determining initial standing.
standing_data = data.frame(id=unique(df1$id), initial_standing=NA, cohort=NA)

for (i in 1:nrow(standing_data)) {
    id = standing_data$id[i]
    subdat = df1[df1$id == id, ]
    subdat = subdat[complete.cases(subdat), ]
    initial_standing = subdat$standing[which.min(subdat$term)]
    standing_data[i, "initial_standing"] = as.character(initial_standing)
    standing_data[i, "cohort"] = as.character(subdat$cohort[1])
}

standing_data$cohort = factor(standing_data$cohort, levels=levels(df1$cohort))
standing_data$initial_standing = factor(standing_data$initial_standing,
                                        levels=levels(df1$standing))

# Add the new column (initial_standing) to df1.
df1 = merge(df1, standing_data[, c("id", "initial_standing")], by="id")

# Remove rows where standing is missing. Make some plots tidier.
df1 = df1[!is.na(df1$standing), ]

# Create id factor, controlling the sort order of the levels.     
id_order = order(standing_data$initial_standing, standing_data$cohort)
df1$id = factor(df1$id, levels=as.character(standing_data$id)[id_order])

p1 = ggplot(df1, aes(x=term, fill=standing)) +
     geom_bar(position="fill", colour="grey20", size=0.5, width=1.0) +
     facet_grid(cohort ~ .) +
     scale_fill_brewer(palette="Set1")

p2 = ggplot(df1, aes(x=term, y=termGPA, group=id)) + 
     geom_line(colour="grey70") + 
     geom_point(aes(colour=standing), size=4) + 
     facet_grid(cohort ~ .) +
     scale_colour_brewer(palette="Set1")

p3 = ggplot(df1, aes(x=term, y=termGPA, group=id)) +
     geom_line(colour="grey70") + 
     geom_point(aes(colour=standing), size=4) + 
     geom_text(aes(label=id), hjust=-0.30, size=3) +
     facet_grid(initial_standing ~ cohort) +
     scale_colour_brewer(palette="Set1")

p4 = ggplot(df1, aes(x=term, y=id, fill=standing)) + 
     geom_tile(colour="grey20") +
     facet_grid(initial_standing ~ ., space="free_y", scales="free_y") +
     scale_fill_brewer(palette="Set1") +
     opts(panel.grid.major=theme_blank()) +
     opts(panel.grid.minor=theme_blank())

ggsave("plot_1.png", p1, width=10, height=6.25, dpi=80)
ggsave("plot_2.png", p2, width=10, height=6.25, dpi=80)
ggsave("plot_3.png", p3, width=10, height=6.25, dpi=80)
ggsave("plot_4.png", p4, width=10, height=6.25, dpi=80) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-18T18:03:12.017

在研究我的问题时，我发现了一些其他选项，我将在此处列出。

许多相对较新的 R 包被设计用于可视化和分析“生活史”或“多状态序列”数据。这个想法是，随着时间的推移，人们（或物体）进入和退出各种类别——例如，职业变化、婚姻和离婚、健康和疾病，或者就我而言，大学学术地位的类别。

用于可视化序列或生活史数据的 R 包包括@timriffe 在上面的评论中提到的[biograph](http://cran.r-project.org/web/packages/Biograph/index.html)和[TraMineR](http://traminer.unige.ch/)。传记包的作者 Frans Willekens 有一本关于传记包的书，*传记。使用 R 对生命史进行多态分析*，将于今年秋天由 Springer 发表。TraMineR 在上面的链接中有详细的用户手册，还有一篇较短的[JSS 文章](http://www.jstatsoft.org/v40/i04/paper)。JSS 在风险分析的上下文中还有一个[关于多状态模型的特殊问题](http://www.jstatsoft.org/v38)，讨论了用于多状态建模的其他 R 包。

我还发现了一些专门的软件，旨在可视化类别之间随时间的变化。[Parallel Sets](http://eagereyes.org/parallel-sets)是一个简单的免费程序，用于生成基本的可视化，尽管它的灵活性有限。[Lifeflow](http://www.cs.umd.edu/hcil/lifeflow/)更加复杂。它也是免费的，但您必须向创建者发送电子邮件请求副本。

一旦我有机会尝试这些工具，我会在这个答案中添加更多细节。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-01-23T17:31:59.323

我希望在我写一个 R 包来解决这个问题之前找到@bdemarest 的答案，但是由于 OP 要求额外的更新，我将分享一个更多的解决方案。bdemarest 在图 4 中建议的是我一直称之为水平线图的类型。

在开发`longCatEDA`R 包时，我们发现对数据进行排序对于制作有用的绘图至关重要（`example(sorter)`有关技术细节，请参阅下面评论中链接的报告），尤其是在问题规模变大的情况下。例如，我们从 3 年（>1000 天）数千名参与者的每日饮酒数据（禁欲、使用、滥用）开始解决问题。

将水平线图应用于@eipi10 的数据的代码如下。图 1 按 分层`term`，图 2 按第一个状态分层，与 @bdemarest 的图 4 一样，尽管由于分层排序，结果并不相同。

# 图1

![按项分层的水平线图](../Images/ad684655c474088dc682b9cb42d5c204.png)

# 图 2

![按初始状态分层的水平线图](../Images/6f1744f2ae73bc801b1603975be00e19.png)

```
# libraries
install.packages('longCatEDA')
library(longCatEDA)
library(RColorBrewer)

# transform data long to wide
dfw <- reshape(df1,
           timevar = 'term',
           idvar = c('id', 'cohort'),
           direction = 'wide')

# set up objects required by longCat()
y <- dfw[,seq(3,15,by=2)]
Labels <- levels(df1$standing)
tLabels <- levels(df1$term)
groupLabels <- levels(dfw$cohort)

# use the same colors as bdemarest
cols <- brewer.pal(7, "Set1")

# plot the longCat object
png('plot1.png', width=10, height=6.25, units='in', res=100)
par(bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
lc <- longCat(y=y, Labels=Labels, tLabels=tLabels, id=dfw$id) 
longCatPlot(lc, cols=cols, xlab='Term', lwd=8, legendBuffer=0)
legend(8.1, 25, legend=Labels, col=cols, lty=1, lwd=4)
dev.off()

# stratify by term
png('plot2.png', width=10, height=6.25, units='in', res=100)
par(bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
lc.g <- sorter(lc, group=dfw$cohort, groupLabels=groupLabels)
longCatPlot(lc.g, cols=cols, xlab='Term', lwd=8, legendBuffer=0) 
legend(8.1, 25, legend=Labels, col=cols, lty=1, lwd=4)
dev.off()

# stratify by first status, akin to Figure 4 by bdemarest
png('plot2.png', width=10, height=6.25, units='in', res=100)
par(bg='cornsilk3', mar=c(5.1, 4.1, 4.1, 8.1), xpd=TRUE)
first <- apply(!is.na(y), 1, function(x) which(x)[1])
first <- y[cbind(seq_along(first), first)]
lc.1 <- sorter(lc, group=factor(first), groupLabels = sort(unique(first)))
longCatPlot(lc.1, cols=cols, xlab='Term', lwd=8, legendBuffer=0) 
legend(8.1, 25, legend=Labels, col=cols, lty=1, lwd=4)
dev.off() 
```

# javascript - 在 # 破坏相对路径之前，backbone.js 缺少斜线

> ID：11513151
> 
> 赞同：0
> 
> 时间：2012-07-16T21:55:40.510
> 
> 标签：javascript, url, backbone.js

我在客户端使用backbone.js，在服务器端使用express.js。问题是，使用backbone.js 路由，用户可以在# 之前有或没有斜杠，这会破坏AJAX 中的相对路径。

快乐路径网址：

```
localhost:3000/ab/#/cd
// now if
// $.ajax({ "url" : "pay", ... });
// the request url would be
localhost:3000/ab/pay 
```

在幸福的道路上一切看起来都很棒，但是......

悲伤的路径网址：

```
localhost:3000/ab#/cd
// with same AJAX, the request url becomes
localhost:3000/pay 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:03:53.753

好吧愚蠢的问题

由于斜线在 # 之前，它会生成一个新的浏览器请求，并且不在主干的控制范围内

我想不出保留相对路径的方法，所以我只是在后端进行了强制重定向

# jquery - 用jquery选择不相邻的元素

> ID：11513155
> 
> 赞同：2
> 
> 时间：2012-07-16T21:55:51.047
> 
> 标签：jquery, selector

我有一个 html 文件，它的结构几乎是这样的：

```
<div id="text-container">
   <h1>Title 1</h1>
   <div class="text"></div>
   <div class="text"></div>
   <div class="text"></div>
   <div class="text"></div>
   <h1>Title 2</h1>
   <div class="text"></div>
   <div class="text"></div>
   <div class="text"></div>
   <h1>Title 3</h1>
   ...
 </div> 
```

这些文件是动态构建的，因此标题和文本类 div 的数量可能会有所不同。我想要实现的是插入一个元素以便能够从一个标题跳转到下一个标题，所以我有点在 prev() 或 next() 之后，但元素不必是兄弟姐妹。

谁能指出我正确的方向？

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T21:59:50.653

如果您想要`.next()`超越下一个元素的功能，请尝试`.nextUntil`+`.next`

```
$("#text-container").click(function() {
    var $nextTitle = $(this).nextUntil("h1").next();
    alert($nextTitle.text());
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:06:14.547

这里是：使用一些三元运算符：（只需`btn`为您的`.prev`和`.next`按钮添加一个类）

## *[演示](http://jsbin.com/uqohot/5/edit)*

```
$('h1').each(function(){
   $(this).data('myTopPosition', $(this).position().top );
});

var howMany = $('h1').length;
var curr = 0; // zero based so the first 'H1' is actually '0'

function correct(){
    var corr = curr === -1 ? curr=howMany-1 : curr = curr%howMany;
}

$('.btn').click(function(){
  var whatBtn= $(this).hasClass('next') ? curr++ : curr-- ;
    correct();
    var goToPos = $('h1').eq(curr).data('myTopPosition');
    $('html, body').stop().animate({ scrollTop: goToPos },1500);
}); 
```

# php - 获得玩家的喜欢

> ID：11513157
> 
> 赞同：0
> 
> 时间：2012-07-16T21:56:03.153
> 
> 标签：php, facebook, facebook-php-sdk, facebook-fql, privacy

我有一个 Facebook iframe 应用程序，当玩家登录该应用程序时，我希望检测他们是否喜欢附加到我的应用程序的社区页面。我通过进行以下 FQL 调用来解决这个问题：

```
SELECT page_id FROM page_fan WHERE uid=me() AND page_id="<my_fan_page_id>" 
```

我还阅读了有关[user_likes](https://developers.facebook.com/docs/authentication/permissions/)权限的需求，您可以在用户批准应用程序时向他们请求该权限。我担心我可能需要此权限才能获得所需的信息，但在我最初的测试中，我似乎不需要。即使我没有请求许可，我似乎还是在拉下玩家的点赞信息。

遗憾的是，一位朋友有一个帐户，但不会向我的应用程序提供此信息。进一步挖掘，我对[Graph API Explorer](http://developers.facebook.com/tools/explorer/)进行了试验，发现当我以他的身份登录并尝试关于他的页面的更一般的请求时，查询仍然返回一个空数组。该查询是：

```
SELECT page_id FROM page_fan WHERE uid=me() 
```

我假设这意味着用户帐户设置中有一个隐私设置，默认情况下允许 FB 用户阻止提供此信息，是吗？如果是这样，这是用户安全设置中的哪个设置，这是否意味着保证此信息被拉下的唯一方法是请求 user_likes 权限？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T12:43:46.067

这不是一个特殊的隐私设置，但是是的，您需要 user_likes 权限才能查询用户喜欢的页面。

# facebook - 为标记为“本机”的应用订阅实时更新

> ID：11513160
> 
> 赞同：3
> 
> 时间：2012-07-16T21:56:13.143
> 
> 标签：facebook, facebook-graph-api, real-time, native, facebook-oauth

当我按照以下说明进行操作时：http: [//developers.facebook.com/docs/reference/api/realtime/](http://developers.facebook.com/docs/reference/api/realtime/)

即： 1) 使用以下命令检索 access_token： `https://graph.facebook.com/oauth/access_token?client_id=<APP_ID>&client_secret=<APP_SECRET>&grant_type=client_credentials`

2) 发出订阅请求`https://graph.facebook.com/<app-id>/subscriptions?access_token=...`

我收到错误：

```
{"error":{"message":"(#15) This method is not supported for native apps","type":"OAuthException","code":15}} 
```

我的应用在“应用类型”下被标记为原生应用`https://developers.facebook.com/apps/<app id>/advanced`。但是，需要明确的是，我正在从**服务器**（我打算用作回调服务器的同一台服务器）发出订阅请求。

**所以，问题：**

1.  我应该通过其他方式获得 access_token 吗？我获取访问令牌（“ `grant_type=client_credentials`”）的方式是否意味着我正在获取一个应该用于客户端而不是服务器的访问令牌？
2.  我做错了什么吗？或者，这只是一个错误/文档错误？实时 API 文档中没有任何地方说本机应用程序不允许使用实时 API。

**相关问题：**
[如何订阅 Facebook Realtime API？](https://stackoverflow.com/questions/8800452/how-do-i-subscribe-to-facebook-realtime-api)基本上是我的同一个问题，但它不在 facebook.stackoverflow.com 上，它的回答是非答案，所以我认为适合重新发布。

[http://facebook.stackoverflow.com/questions/11141333/using-real-time-updates-from-facebook-graph-api-with-a-client-application](http://facebook.stackoverflow.com/questions/11141333/using-real-time-updates-from-facebook-graph-api-with-a-client-application)是一个相关问题，但我再次订阅来自*SERVER*的请求，而不是来自客户端的请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:35:49.993

如果你设置了 canvas_url，你可以做 client_credentials。所以设置本机和画布（服务器）。它将托管您的应用程序的网站版本，这是 FB 授予这种 access_token 所需的。

# objective-c - NSInteger 以相反的顺序转换为字节数组

> ID：11513162
> 
> 赞同：2
> 
> 时间：2012-07-16T21:56:19.023
> 
> 标签：objective-c, bytearray

在过去的几个小时里，我一直在敲打我的头，这似乎是一项非常容易的任务。

我的应用程序正在通过 tcpip 与服务器通信。该协议要求每个请求的前 4 个字节是流的长度，顺序相反。例如，如果长度为 13，我需要提供（十进制）{0,0,0,13}；如果是 300，我需要提供 {0,0,44,256}。然后，实际数据如下。

显然，这在 Java 和 VB 中都是非常简单的事情（例如 BitConverter.GetBytes(sendString.Length).Reverse().ToArray()）。但是在 obj-c 中我无法让它工作，我尝试了 NSString/NSData/NSArray 之间的各种转换，但没有运气。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T22:10:05.923

服务器以大端顺序（最高有效字节在前）请求数据。Big-endian 是 Internet 协议（包括 IP、TCP、UDP、DNS 等）的标准网络字节顺序。碰巧您正在为 little-endian 平台进行编译，因此您需要交换字节。

**但是**，您不应该*依赖*于小端平台。相反，您应该使用[Core Foundation 字节交换函数使您的代码](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFByteOrderUtils/Reference/reference.html#//apple_ref/doc/uid/20001449)*独立*于本地（主机）字节顺序。

具体来说，您应该使用`CFSwapInt32HostToBig`将 4 字节 int 转换为 big-endian 顺序。在 little-endian 平台上，这会重新排列字节。在大端平台上，这没有任何作用。

同样，您应该使用`CFSwapInt32BigToHost`将从服务器收到的 4 字节整数转换为主机字节顺序。

或者，您可以使用[标准 POSIX 字节交换函数](http://pubs.opengroup.org/onlinepubs/7908799/xns/htonl.html)。该`htonl`函数代表`host-to-network-long`，并将 32 位 int 从主机顺序转换为网络（大端）顺序。该`ntohl`函数将 32 位 int 从网络顺序转换为主机顺序。（在创建这些函数时，一些流行的操作系统有 16 位整数和 32 位长整数。你相信吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:04:17.523

```
NSInteger a = 300; //13;
char* aa = &a;
Byte b[] = {0,0,0,0};
memcpy(&b[0], &aa[3], 1);
memcpy(&b[1], &aa[2], 1);
memcpy(&b[2], &aa[1], 1);
memcpy(&b[3], &aa[0], 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:03:49.107

如重复问题的已接受答案所示，Foundation 提供了字节交换功能。在这种情况下，由于您处理的是 long ，您可能需要`NSSwapLong`.

# php - PHP strpos函数中针的长度有限制吗？

> ID：11513166
> 
> 赞同：0
> 
> 时间：2012-07-16T21:56:50.253
> 
> 标签：php, strpos

我的问题很简单：

1.  strpos 针的长度是否有限制？
2.  如果是这样，有没有办法绕过它？

似乎我的长针不会触发位置，而我的短针会触发。

例子：

```
if (strpos($data, "You were not able to complete this job. Please try again at a later date. Do not hit your back button.") !== false)
//solves as false

if (strpos($data, "You were not able") !== false)
//returns the position 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:13:35.710

*问题出在其他地方：*虽然可能存在*一些*实施限制（例如 2GB？），但不是这个限制。

大概较长的针与输入*不匹配：*

*   额外的空间？请记住，浏览器会“折叠”连续的 HTML 空白。因此，来自浏览器的“复制粘贴”可能与 cURL 读取的内容*不同。*（这也可以扩展到其他未在浏览器中呈现为文本的源。）

*   看起来像空间但不是的东西？（制表符还是换行符？）

*   或其他导致输入（和/或针刺）与预期不同的东西..

# android - Android Quote 应用程序，下一步和后退按钮

> ID：11513173
> 
> 赞同：4
> 
> 时间：2012-07-16T21:57:05.010
> 
> 标签：android, arrays, list, back, quote

我正在尝试制作一个简单的报价应用程序，但是每次我在下一个按钮之后点击后退按钮时，它都会转到下一个数组而不是倒退。我使用 int num 来跟踪用户所在的报价。这是我的后退按钮

```
package me.me.quote;

public class Startme extends Activity {
 Random gen= new Random();
int num;

 String[] quotes = new String[15];

public void next(View N){
         quotes[0]= "Love is timeless";
            quotes[1]= "I hate you";
            quotes[2]= "arggg!";
            quotes[3]= "The end is near";
            quotes[4]= "Leave be";

            if(num == 5){
                num =0;}

           TextView text = (TextView) findViewById(R.id.Quote);
           text.setText(quotes[num++]);

           TextView number = (TextView) findViewById(R.id.Qn);
            number.setText(""+num);

        }
public void back(View B){

 quotes[0]= "Love is timeless";
   quotes[1]= "I hate you";
   quotes[2]= "arggg!";
   quotes[3]= "The end is near";
   quotes[4]= "Leave be";

 TextView text = (TextView) findViewById(R.id.Quote);
 text.setText(quotes[num--]);

 TextView number = (TextView) findViewById(R.id.Qn);
    number.setText(""+num);}

  public void rand(View G)  {

 num = gen.nextInt(5);

  quotes[0]= "Love is timeless";
  quotes[1]= "I hate you";
  quotes[2]= "arggg!";
  quotes[3]= "The end is near";
  quotes[4]= "Leave be";
  TextView text = (TextView) findViewById(R.id.Quote);
  text.setText(quotes[num]);

TextView number = (TextView) findViewById(R.id.Qn);
number.setText(""+num);         
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.setContentView(R.layout.startquotes);

    TextView Dark=(TextView)findViewById(R.id.Quote); 
    Typeface face=Typeface.createFromAsset(getAssets(), "fonts/font1.ttf"); 
    Dark.setTypeface(face); 

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:34:38.923

//布局文件 text.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textView"
            android:layout_width="wrap_content"
            android:layout_height="50dp"
            android:layout_alignParentTop="true"
            android:text="VISIBLE EVERY TIME"
            android:visibility="visible" />

        <Button
            android:id="@+id/back"
            android:layout_width="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_height="wrap_content"
            android:layout_below="@+id/textView"
            android:text="NEXT" >
        </Button>

        <Button
            android:id="@+id/next"
            android:layout_alignParentRight="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/textView"
            android:text="BACK" >
        </Button>

    </RelativeLayout> 
```

///活动类

```
 import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    import android.widget.TextView;

    public class Test extends Activity {

        Button next;
        Button back ;
        TextView quoteText;
        int currentSelectedQuote=0;
        String[] quote={"QUOTE1","QUOTE2","QUOTE3","QUOTE4","QUOTE5",};

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            // TODO Auto-generated method stub
            super.onCreate(savedInstanceState);

            setContentView(R.layout.text);

            quoteText=(TextView)findViewById(R.id.textView);

            quoteText.setText(quote[currentSelectedQuote]);

             next=(Button)findViewById(R.id.next);

             next.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    currentSelectedQuote++;

                    if(currentSelectedQuote == 5){
                        currentSelectedQuote =0;}

                    quoteText.setText(quote[currentSelectedQuote]);

                }
            });
             back=(Button)findViewById(R.id.back); 

             back.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {

                    if(currentSelectedQuote==0)
                    {
                        currentSelectedQuote=4;
                    }
                    else
                    {
                    currentSelectedQuote--;
                    }

                    quoteText.setText(quote[currentSelectedQuote]);

                    // TODO Auto-generated method stub

                }
            });

        }

    } 
```

# php - 为什么我得到不是 text/xml 类型的错误响应：text/html？

> ID：11513177
> 
> 赞同：2
> 
> 时间：2012-07-16T21:57:17.087
> 
> 标签：php, web-services, nusoap

我是使用 SOAP 与 Web 服务通信的新手，我最近在 php 中编写了一个客户端来与 Web 服务通信，但得到了这个错误消息：

“错误响应不是文本/xml 类型：文本/html”

我发送出去的格式有问题吗？请在下面找到请求：

```
Request

POST /MobileCashPayout.asmx HTTP/1.0
Host: www.mtn.com
User-Agent: NuSOAP/0.9.5 (1.123)
Content-Type: text/xml; charset=ISO-8859-1
SOAPAction: ""
Content-Length: 971

<?xml version="1.0" encoding="ISO-8859-1"?><SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><ns5667:Payout xmlns:ns5667="http://tempuri.org"><__numeric_0 xsi:type="xsd:string">testmerc</__numeric_0><__numeric_1 xsi:type="xsd:string">testmerc</__numeric_1><__numeric_2 xsi:type="xsd:string">256750000005</__numeric_2><__numeric_3 xsi:type="xsd:string">256753986532</__numeric_3><__numeric_4 xsi:type="xsd:string">256750000005</__numeric_4><__numeric_5 xsi:type="xsd:string">100.00</__numeric_5><__numeric_6 xsi:type="xsd:string">2222</__numeric_6><__numeric_7 xsi:type="xsd:string"></__numeric_7><__numeric_8 xsi:type="xsd:string">BETNET</__numeric_8></ns5667:Payout></SOAP-ENV:Body></SOAP-ENV:Envelope> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:02:02.127

您可能想尝试发送“Accept: text/xml”标头来通知服务器您正在等待 XML 响应。

# java - Android反向WAV文件

> ID：11513179
> 
> 赞同：2
> 
> 时间：2012-07-16T21:57:29.270
> 
> 标签：java, android, linux, file, io

我正在开发适用于 android 的音频处理应用程序，并创建了一个用于反转`WAV`文件的类。在我的 PC 上的 Java SE 上一切正常。但是，android上的代码非常慢“由于连续读取和写入少量数据，通常约为2个字节”。

这个过程几乎要花很长时间才能交付，我实际上相信将文件上传到服务器来处理可能是一种非常有效的方法。我尝试过使用通道、文件映射和缓冲 I/O。一切都以非常糟糕的表现告终。

我现在使用的逻辑：

1.  读取前 44 个字节并将它们写入一个新文件“反向文件”。
2.  计算要移动的块大小“每个样本的字节数 * 通道数”
3.  从第一个文件的末尾读取该数据量并将其写入反向文件“我也尝试写入缓冲区，当它完全写入反向文件时”。

任何想法如何提高性能？我应该放弃目前的方法吗？

# python - 如何检查列表项是否在字典中。如果是这样，打印与之关联的数据

> ID：11513184
> 
> 赞同：1
> 
> 时间：2012-07-16T21:58:04.830
> 
> 标签：python, dictionary

我有一个名为的名称列表`names`。我还有 2 个字典，其中包含一个嵌套字典列表，这些字典都具有`names`与名称关联的键和其他数据。我想要做的是检查列表中的名称是否在两个字典之一中，如果是，则打印仅与该名称关联的数据。我在 python 文档中找不到任何这些东西

```
names = ['barry','john','george','sarah','lisa','james']

dict1 = {'results':[{'name':'barry','gpa':'2.9','major':'biology'},
                  {'name':'sarah','gpa':'3.2','major':'economics'},
                  {'name':'george','gpa':'2.5','major':'english'}]}

dict2 = {'staff':[{'name':'john','position':'Lecturer','department':'economics'},
                {'name':'lisa','position':'researcher','department':'physics'},
                {'name':'james','position':'tutor','department':'english'}]}

for x in names:
    if x in dict1:
        print gpa associated with the name
    elif x in dict2:
        print position associated with the name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:04:41.043

```
for _name in names:
    if _name in [person['name'] for person in dict1['results']]: pass
    elif _name in [person['name'] for person in dict2['staff']]:pass 
```

至少是这样的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:14:50.430

您为两个`dict`s 使用的结构不是非常理想 - 每个都只包含一个元素，它是每个人的相关数据的列表。如果您可以使用名称作为键对每个人使用单独的元素进行重组，那么这将成为一个微不足道的问题。

```
dict1 = {'barry': {'gpa':'2.9','major':'biology'},
         'sarah': {'gpa':'3.2','major':'economics'},
         'george': {'gpa':'2.5','major':'english'}}

dict2 = {'john': {'position':'Lecturer','department':'economics'},
         'lisa': {'position':'researcher','department':'physics'},
         'james': {'position':'tutor','department':'english'}} 
```

由于您似乎无法以这种格式获取数据，因此您必须对其进行转换：

```
dict_results = dict((d['name'], d) for d in dict1[results])
if name in dict_results:
    print dict_results[name]['gpa'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:18:25.680

这应该让你有个想法：

```
for name in names:
  print name, ":"
  print "\t", [x for x in dict2["staff"] if x["name"] == name]
  print "\t", [x for x in dict1["results"] if x["name"] == name] 
```

印刷

```
barry :
  []
  [{'major': 'biology', 'name': 'barry', 'gpa': '2.9'}]
john :
  [{'department': 'economics', 'position': 'Lecturer', 'name': 'john'}]
  []
george :
  []
  [{'major': 'english', 'name': 'george', 'gpa': '2.5'}]
sarah :
  []
  [{'major': 'economics', 'name': 'sarah', 'gpa': '3.2'}]
lisa :
  [{'department': 'physics', 'position': 'researcher', 'name': 'lisa'}]
  []
james :
  [{'department': 'english', 'position': 'tutor', 'name': 'james'}]
  [] 
```

如果您从数据库中获取这些数据，您可能更应该研究问题的 SQL 前沿。为这样的操作创建了一个数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T07:47:16.710

```
names = ['barry','john','george','sarah','lisa','james']

dict1 = {'results':[{'name':'barry','gpa':'2.9','major':'biology'},
                  {'name':'sarah','gpa':'3.2','major':'economics'},
                  {'name':'george','gpa':'2.5','major':'english'}]}

dict2 = {'staff':[{'name':'john','position':'Lecturer','department':'economics'},
                {'name':'lisa','position':'researcher','department':'physics'},
                {'name':'james','position':'tutor','department':'english'}]}

import itertools

for x in itertools.chain(dict1['results'], dict2['staff']):
    for n in names:
        if n in x.values():
            print x 
```

或者第二部分可以是：

```
ns = set(names)
for x in itertools.chain(dict1['results'], dict2['staff']):
    if x['name'] in ns:
        print x 
```

# css - div 上的不可见 div 在 IE8 中不起作用

> ID：11513188
> 
> 赞同：9
> 
> 时间：2012-07-16T21:58:18.833
> 
> 标签：css, internet-explorer, html, invisible

我正在尝试通过 facebook 评论插件创建一个不可见的 div，以便在编辑器视图中禁用该插件的功能。这个不可见的 div 可以在除 IE8 之外的所有浏览器中使用。我怎样才能解决这个问题？

HTML：

```
<div id="container">
   <div id="coveriframe"></div>   
    <div data-bind-component="fbml: fbml">(RENDER JS COMMENTS VIA KO)</div>
</div> 
```

**在 IE8 中尝试：**

[http://jsfiddle.net/pkbz4/19/](http://jsfiddle.net/pkbz4/19/)

*   上面的代码适用于所有其他主要浏览器。微软？

样式表：

```
 #container {
        width: 100%;
        height: 100%;
        position: relative;
    }

    #navi, 
    #coveriframe {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }

    #coveriframe {
        z-index: 10;
   } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-30T22:56:42.377

我在 IE8 中做过几次。对我有用的解决方案是为 div 分配背景颜色，然后将不透明度设置为 0。然后 IE8 将 div 识别为在其余内容之上“存在”。我还发现设置`position: absolute`和所有四个方向都为 0 比 100% 的宽度和高度更可靠。像这样：

```
#coveriframe {
  position: absolute;
  top: 0; 
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 3007;
  background: #fff;
  filter: alpha(opacity=0);
  opacity: 0;
} 
```

这是我对您的 jsfiddle 的更新：http: [//jsfiddle.net/pkbz4/21/](http://jsfiddle.net/pkbz4/21/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T22:21:42.763

**[CSS 规范 说：](http://www.w3.org/TR/CSS21/visudet.html#the-height-property "CSS 规范：")**

> 该百分比是相对于生成框的包含块的高度计算的。如果包含块的高度没有明确指定（即，它取决于内容高度），并且该元素不是绝对定位的，则该值计算为'auto'。

基本上，在旧版本的 IE（包括 IE8）中，百分比高度基于父元素的高度。如果父元素没有明确的高度，则忽略百分比并将其设置为 Auto（在本例中为 0px）。

因此，要解决此问题，您需要明确设置 #coveriframe 或其父级的高度/宽度。**您可以尝试的一件事是将html**和**body**的高度设置为 100%（我假设这些是父元素）。

```
html, body { height:100%; }

#container {
    width: 100%;
    height: 100%;
    position: relative;
}

#navi,
#coveriframe {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
}

#coveriframe {
    z-index: 10;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:13:37.973

你为什么要在 javascript 中做，它在所有浏览器中都运行良好，我会让我的例子希望你能工作：

-----------------DIV-----------------

> `<div id="div1" style="display: block;"> <div class="mainbody"> <br /> </div></div>`

-----------------JavaScript----------------

```
 function showHideDiv(divX) {

        if (divX == "1") {
            document.getElementById("div1").style.visibility = "visible";
            document.getElementById("div2").style.visibility = "hidden";

    } 
```

-----------------按钮HTML----------------

`<li><a href="#cuenta" onclick="showHideDiv(0)">click_Aqui</a></li>`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-01T09:52:22.993

问题是，当鼠标悬停在透明背景上时，最高 ie9 的 Internet Explorer 无法识别鼠标悬停。Zach Shipley 的回答提供了一个很好的解决方案。

但是，如果您想为透明 div 或文本添加边框或元素，最简单的方法是添加 1px 透明 png 作为背景。

```
#coveriframe {
  position: absolute;
  top: 0; 
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 3007;
  background-image: url("pixel-transparent.png");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T12:22:48.360

确保您将固定的高度和宽度设置为`DIV`.

正如上面提到的 Shaquin Trifonoff 有时`100%`或任何长度`%`可能无法正常工作`IE8`。`%`在这种情况下，我总是试图避免。

代码片段：-

```
html,body{ //This makes your page expandable as per screen resolution 
 height:100%;
}

#your-hide-div{
  height:100px;
  width: 100px;
  display:block;
} 
```

# git - 我应该使用 Git Branch 来获取额外的日志代码来解决令人讨厌的仅限生产的错误吗？

> ID：11513192
> 
> 赞同：0
> 
> 时间：2012-07-16T21:58:27.363
> 
> 标签：git, git-branch, error-logging

我有一个实时网站，其中错误仅在 PROD 中出现。我在想，与其在我的 prod 分支上实现一些日志记录，不如创建一个特殊的短期日志记录分支，并将其签入 PROD，并首先在我的登台服务器中对其进行测试。然后，一旦解决了问题，我就可以切换回主干分支。

我意识到在 PROD 中进行测试是错误的，但我们无法在登台服务器中重现此错误。我是否错过了一种方法，或者您能否评论将分支（与主干的分歧不大）投入生产的危险？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:16:27.043

最简单的方法是从 PROD 分支到短期测试分支。您应该在看到问题的提交/标记处进行分支。

使用此分支进行任何更改并修复问题。在暂存服务器上验证您的 FIX 后，将更改合并回 PROD 分支。

```
git checkout PROD
git branch my_short_lived_branch
<DEPLOY short_lived_branch on Staging Server to confirm issue is reproducible>
<DEBUG and FIX the issue>
<DEPLOY and confirm the FIX>
git checkout PROD
git merge --no-ff my_short_lived_branch
<DEPLOY on Staging server and confirm the issue is fixed>
<IF the issue is fixed, deploy the changes to your production server> 
```

# c# - 复制粘贴 Excel 数据时，颜色丢失

> ID：11513199
> 
> 赞同：2
> 
> 时间：2012-07-16T21:58:58.480
> 
> 标签：c#, asp.net, excel, infragistics, netadvantage

冒着让这个问题被遗忘或被关闭为“过于本地化”的风险，我想我会发布这个问题，因为我的老板经常抱怨它，这让我摸不着头脑。

我们使用[Infragistics NetAdvantage](http://www.infragistics.com/products/dotnet/) [Excel 控件](http://www.infragistics.com/products/aspnet/excel-exporter/)即时创建 Excel 报告。一些单元格，我们添加填充颜色，如下所示：

```
sheet.Rows[i].Cells[0].CellFormat.FillPattern = FillPatternStyle.Solid;
sheet.Rows[i].Cells[0].CellFormat.FillPatternForegroundColor = Color.FromArgb(127, 127, 127); 
```

这很好用，报告看起来很好：

![工作图像](../Images/88231c0b963e4fa9e05030d040512dda.png)

但是，如果我的经理选择 Excel 中的所有单元格，将数据复制到剪贴板，然后将这些单元格*粘贴*到另一个 Excel 文件中，所有颜色都会转换为一些奇怪的 3 位调色板：

![在此处输入图像描述](../Images/30b0e0847769a8cb2c3e14c11e121f28.png)

现在，每种填充颜色都是纯红色 (#FF0000)、纯绿色 (#00FF00)、纯蓝色 (#0000FF) 或黄色 (#FFFF00)。它是任何给定颜色的全部或全部。那个深灰色的标题甚至变成了全白。

一件有趣的事情是，如果我在 Excel 中手动更改其中一个单元格的填充颜色，然后复制并粘贴它，我手动设置的颜色会在 Infragistics 生成的单元格抖动时完美复制。

这只发生在 Excel 文件之间复制时，而不是 Excel 文档中的工作表之间。有没有人遇到过这个问题，或者是否有任何 Excel 专家从技术角度知道可能导致此问题的原因？

这是 Excel 2007 和 Infragistics Build 8.2.20082.1000。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:35:23.490

这在 NetAdvantage 2012 第 1 卷中得到解决，其中对 excel 引擎使用的颜色模型进行了更改。Mike 在[Infragistics 论坛](http://www.infragistics.com/community/forums/p/71779/363041.aspx#363041)上的回复也提到了这一点。

解决此问题的最佳选择是使用 NetAdvantage 2012 第 1 卷中的 excel 引擎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-24T16:57:24.420

所以我遇到了同样的问题，无法弄清楚为什么复制的格式不会延续到另一个工作表中。所以，没有官方的“修复”，但是我意识到它并没有延续，因为我在一个完全独立的 Excel 文档中。本质上，您必须在同一个 Excel 表中复制和粘贴文档。因此，当您打开要复制的项目时，请从您的复制表中打开您的其他 Excel 表（文件、打开）。粘贴后，它将保存您的所有格式。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T15:57:45.347

我还为那些不想（或负担不起）升级的人找到了解决方案。像这样简单地创建工作簿：

```
Workbook b = new Workbook(WorkbookPaletteMode.StandardPalette); 
```

将解决问题。但是，显然您将无法使用任何完全自定义的颜色。它们将四舍五入到最接近的标准颜色，这在我们的例子中非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:11:32.450

不同的版本会以不同的方式呈现颜色，这似乎就是您所看到的

这篇文章很好地解释了这一点[http://answers.officewriter.com/workbook-colors-are-not-displayed-as-expected-in-older-versions-of-excel](http://answers.officewriter.com/workbook-colors-are-not-displayed-as-expected-in-older-versions-of-excel)

有一个用于创建自定义调色板的工具，它应该比创建自己的调色板更容易为您解决这个问题。

[http://excelcampus.com/tools/color-palette-conversion](http://excelcampus.com/tools/color-palette-conversion)

![在此处输入图像描述](../Images/ca322c300620b396275c550d789ba687.png)

Excel 保存首选项允许您更改或保留使用的颜色 ![在此处输入图像描述](../Images/601bca15e2642d3f0a235614361ac9f9.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-13T21:18:00.903

好的，我想在遇到此处和其他地方描述的相同问题后，我已经解决了这个问题......看看这个！首先转到您粘贴到的页面并突出显示整个页面，然后转到打印区域和“清除打印区域”。然后去粘贴区域删除单元格，即使那里什么也没有！突出显示行（即使那里什么都没有）。删除行。现在从头开始复制和粘贴，您应该能够粘贴所有原始颜色和公式！

# javascript - 具有主干集合的可排序表

> ID：11513213
> 
> 赞同：0
> 
> 时间：2012-07-16T22:00:07.333
> 
> 标签：javascript, backbone.js

我想创建一个可使用集合属性排序的表。到目前为止，我已经能够使用两个属性使选项卡表可排序，但我希望能够基于排序键属性的值进行排序。例如，当“task_status = 'open'”

这是我现在正在工作的

```
var TaskCollection = Backbone.Collection.extend({
        //Model
        model:Task,
        //url
        url:"./api/tasks",

        //construct
        initialize: function() {
            this.sort_key = 'end';
            this.fetch();
        },

        comparator: function(a,b) {
            a = a.get(this.sort_key);
            b = b.get(this.sort_key);
            return a > b ?  1
                 : a < b ? -1
                 :          0;
        },

        sort_by_status: function() {
            this.sort_key = 'task_status';
            this.sort();
        },

        sort_by_task_tag: function() {
            this.sort_key = 'task_group';
            this.sort();
        }
    }); 
```

这会对集合进行排序，但不会颠倒顺序，或者允许我按属性的特定值进行排序。如何修改它才能工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:25:32.773

在比较器中，有一个用于“反转”的状态变量，并将其取值为 1 和负 1。将其乘以前一个返回值。在集合上设置状态变量然后再次排序应该可以完成任务。

# c# - 获取已删除 DataGridView 行的单元格值

> ID：11513219
> 
> 赞同：6
> 
> 时间：2012-07-16T22:00:45.293
> 
> 标签：c#, winforms, datagridview

我的datagridview itemDelete 函数：

```
this.dgv_items.RowsRemoved += this.dgv_items_itemDelete;

private void dgv_items_itemDelete(object sender, DataGridViewRowsRemovedEventArgs e)
{
    try
    {
        int row = e.RowIndex;
        string name = dgv_items.Rows[row].Cells[0].Value.ToString();
        deleteFromDB(name);
    }
    catch (Exception) { }
} 
```

但是当我们到达此代码时，该行将被删除，这意味着`dgv_items.Rows[row].Cells[0].Value`如果行是下一行，则获取该值。

我想获取已`Cells[0]`删除行的值，因此我也可以从数据库文件中删除该项目。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T22:37:33.843

[`UserDeletingRow`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.userdeletingrow.aspx)您可以改为处理该事件。请注意，它支持事件取消。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:23:29.453

当您使用 RowEnter 事件选择行时，您可以将单元格的值临时保存在变量中：

```
private void dgv_items_RowEnter(object sender, DataGridViewCellEventArgs e)
        {
            try
            {
                // tempValue is a class var
                tempValue = dgv_items.Rows[e.RowIndex].Cells[0].Value.ToString();
            }
            catch (Exception ex) { 
                MessageBox.Show(ex.Message);
            }
        } 
```

然后在删除之前检索 tempValue。

# delphi - DataSnap REST 服务器 - 启用 HTTP KeepAlive

> ID：11513222
> 
> 赞同：0
> 
> 时间：2012-07-16T22:00:59.147
> 
> 标签：delphi, http, rest, keep-alive, datasnap

我正在使用 Delphi XE2 构建 DataSnap HTTP REST 服务器以在 Windows 2008 上作为服务运行。我在某处读到默认情况下，DataSnap 服务器项目的 HTTP 'KeepAlive' 是禁用的，如果是这样，有人可以帮助如何启用这个。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T10:53:41.530

服务器有一个属性`KeepAlive`，应该设置为`true`。

# php - 在 PHP 中覆盖没有继承的实例方法？

> ID：11513223
> 
> 赞同：0
> 
> 时间：2012-07-16T22:01:04.450
> 
> 标签：php

好的，我知道这可能是不可能的，但我会试一试。也许我的知识不是那么好。请不要投反对票，这只是出于好奇，这可能是由于糟糕的 OO 设计。

假设类定义为`A`：

```
class A
{
    public function build()
    {
        $data = $this->fetchData();
        ...
    }

    public function fetchData()
    {
        // Database eavy query
        return $this->repository->fetchDataForCharting();
    }
} 
```

然后，在不使用良好且体面的 OO 设计的情况下，您创建将从存储库`B`中使用`fetchDataForCharting`的类，用于执行其他一些不同的计算：

```
class B
{
    public $data;

    public function getMonthlyLimit()
    {
        // Database eavy query
        $data = $this->getData();
    }

    public function getData()
    {
        return isset($this->data) ? $this->data :
            $this->repository->fetchDataForCharting();
    }
} 
```

有时你只需要`A`，有时你只需要`B`，有时两者都需要。有没有`fetchData`在运行时覆盖的方法？我的意思是`$.extend()`jQuery 中的一些东西：

```
$b = new B();
$b->getMonthlyLimit(); // $b->data filled

$a = new A();

// Override fetchData
$a = extend($a, 'fetchData', function() use($b) { return $b->data; });

$a->build(); // Just 1 query 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:03:37.307

没有适当的方法来修改/替换/添加类方法。

该[`runkit`](http://php.net/manual/en/book.runkit.php)扩展有[`runkit_method_redefine()`](http://php.net/manual/en/function.runkit-method-redefine.php)，[`runkit_method_add()`](http://php.net/manual/en/function.runkit-method-add.php)但都是实验性的和丑陋的（它们采用代码字符串，而不是像您的匿名函数那样的闭包对象）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:09:14.703

我不清楚您要做什么，但是在 PHP 中，您可以通过编写 B 类声明来让 calss B 扩展 A 类：

```
Class B extends Class A {
   ...
} 
```

您可以在 B 类中覆盖 fetchData 函数，例如

```
public function fetchData {
    // do something different than in class A
} 
```

或者

```
public function fetchData {
    // execute the Class A functionality first
    parent::fetchData();

    // now do something in addition to what is in Class A functionality
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:14:22.800

最简洁的答案是不。

最接近您所要求的内容是：

```
class A
{
  public function __construct()
  {
    $this->bar = function()
    {
    };
  }

  public function foo()
  {
    $bar = $this->bar;
    $bar();
  }
}

$a = new A();
$a->bar = function()
{
  // override
};
$a->foo(); 
```

需要 PHP 5.4`$this`支持。但请记住，人们在 JavaScript 中做这种事情是因为它没有“真正的”面向对象编程。你不应该仅仅为了模仿 JavaScript、Ruby、Python 等。

需要明确的是：在 PHP 中，继承或组合或依赖注入可能是您尝试做的事情的正确方法。（上面的 hack 绝对*不是*你应该做的。）

# magento - 无法解决“找不到货币'USD'”错误

> ID：11513229
> 
> 赞同：0
> 
> 时间：2012-07-16T22:01:35.370
> 
> 标签：magento, backend, frontend

我在前端和后端收到此消息：处理您的请求时出错。

当我删除缓存文件夹（var/cache、/tmp 和 /session）时，我让前端再次工作，直到我访问商店中的任何页面，其中包含价格。后端更难再次工作（现在不是）。

检查错误日志，我得到一大堆以“找不到货币'美元'”开头的错误日志。这一切都是在一些小的更改之后开始发生的，包括我通过编辑 /lib/Zend/Locale/Data/es.xml （西班牙语规范）在这里：

```
 <currencyFormats>
    <currencyFormatLength>
     <currencyFormat>
        <pattern>Â¤Â #,##0.00</pattern>
     </currencyFormat>
   </currencyFormatLength>
   <unitPattern count="other">{0} {1}</unitPattern>
 </currencyFormats> 
```

我尝试恢复到以前的格式，然后将原始文件复制回来。一定是别的什么地方坏了，我找不到。

以下是错误日志中最后步骤的摘要（您都需要它们吗？）

a:5:{i:0;s:24:"找不到货币'USD'";i:1;s:3740:"#0 /home/content/32/9343032/html/app/code/core/ Mage/Core/Model/Locale.php(575): Zend_Currency->__construct('USD', Object (Zend_Locale))

#1 /home/content/32/9343032/html/app/code/core/Mage/Directory/Model/Currency.php(233): Mage_Core_Model_Locale->currency ('EUR')

#2 /home/content/32/9343032/html/app/code/core/Mage/Directory/Model/Currency.php(216): Mage_Directory_Model_Currency->formatTxt(NULL, Array)

#3 /home/content/32/9343032/html/app/code/core/Mage/Directory/Model/Currency.php(197): Mage_Directory_Model_Currency->formatPrecision(NULL, 2, Array, true, false)

#4 /home/content/32/9343032/html/app/code/core/Mage/Adminhtml/Block/Dashboard/Bar.php(82): Mage_Directory_Model_Currency->format(NULL)

请在这里帮我...

谢谢米格尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T10:32:14.177

清除缓存，从 var/session 中删除所有会话文件并刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-06T06:19:45.983

首先从管理面板系统->配置->检查您的 Magento 语言环境设置

General->General->Locale Option Locale // 检查选择了哪个选项。

如果选项是英语（英国）

请更新语言环境文件..或检查是否有可用的货币设置。

转到 cpanel 并打开 magento 文件：lib/Zend/Locale/Data/en.xml

```
 <currency type="USD">
            <displayName>US Dollar</displayName>
            <displayName count="one">US dollar</displayName>
            <displayName count="other">US dollars</displayName>
            <symbol>$</symbol>
        </currency> 
```

或者您可以添加以下选项

```
<numbers>

        <currencyFormats>
            <currencyFormatLength>
                <currencyFormat>
                    <pattern>¤#,##0.00;(¤#,##0.00)</pattern>
                </currencyFormat>
            </currencyFormatLength>
            <unitPattern count="one">{0} {1}</unitPattern>
            <unitPattern count="other">{0} {1}</unitPattern>
        </currencyFormats>

        add the below lines

         <currencies>
          <currency type="USD">
                <displayName>US Dollar</displayName>
                <displayName count="one">US dollar</displayName>
                <displayName count="other">US dollars</displayName>
                <symbol>$</symbol>
            </currency>
            <currency type="USN">
                <displayName>US Dollar (Next day)</displayName>
                <displayName count="one">US dollar (next day)</displayName>
                <displayName count="other">US dollars (next day)</displayName> 
            </currency>
        </currencies>

    </numbers> 
```

在所有更改之后..请清除 magento 缓存..以正常工作所有更改

# c# - .NET 类型推断：无法推断“T GetValue”的使用 (T defaultValue = default(T))"？

> ID：11513230
> 
> 赞同：3
> 
> 时间：2012-07-16T22:01:35.037
> 
> 标签：c#, .net, generics

我有一个简单的方法：

```
public static T GetValue<T>(SqlDataReader reader, int columnIndex, T defaultValue = default(T))
{
    return reader.IsDBNull(columnIndex) ? defaultValue : (T)reader[columnIndex];
} 
```

及其用法：

```
string s = SqlUtils.GetValue<string>(reader, nameOrd); 
```

我问自己，为什么我必须指定`<string>`从用法中是否清楚返回参数的类型是字符串？但显然我必须这样做，否则编译器会抱怨`The type arguments cannot be inferred from the usage...`。我的逻辑在哪里失败？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T22:03:02.167

> 我的逻辑在哪里失败？

无处。根据规范[`25.6.4 Inference of Type Arguments`](http://en.csharp-online.net/ECMA-334%3a_25.6.4_Inference_of_type_arguments)（因此，如果您想使用 C#，规范只是告诉您泛型类型推断仅使用返回类型是不可能的。或者简单地使用其他一些允许这样做的 CLS 语言。C# 没有。

# nhibernate - 带有 ResultSetTransformer 的 NHibernate 未来查询

> ID：11513240
> 
> 赞同：5
> 
> 时间：2012-07-16T22:02:10.253
> 
> 标签：nhibernate, resulttransformer

我正在尝试使用 nhibernate 查询任意 sql 数据，只要我不使用 Futures 功能，它就可以正常工作，但是，当我使用 Futures 时，数据不会传递到 ResultSetTransformer。

示例代码：

```
public class TestResultSetTransformer : IResultTransformer
{
    public object TransformTuple(object[] tuple, string[] aliases)
    {
        return tuple;
    }

    public IList TransformList(IList collection)
    {
        return collection;
    }
}
public void Foo(ISession sess){
        var x = sess.CreateSQLQuery("select * from MailEvent").SetResultTransformer(new TestResultSetTransformer()).Future<object[]>();
        var xprime = sess.CreateSQLQuery("select * from MailEvent").SetResultTransformer(new TestResultSetTransformer()).List<object[]>();
        foreach(var y in x)
        {

        }
} 
```

在此示例中，期货查询返回具有正确行数的空对象数组列表，当我对其进行调试时，object[] 元组为空，但是对于列表查询，它按预期工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:08:44.887

您可能希望尝试这样的事情：

```
public class MailEvent
{
    public virtual int Id{get;set;}
    public virtual string Message{get;set;}
}

public IEnumerable<MailEvent> GetMailEvents(ISession session)
{
    return session.CreateSQLQuery("select Id, Message from MailEvent")
                  .SetResultTransformer(Transformers.AliasToBean<MailEvent>())
                  .Future<MailEvent>();        
} 
```

假设您知道目标格式，这应该将任意 SQL 数据转换为您需要的数据

# objective-c - UISearchDisplayController 未在 searchResultsTableView 中显示结果

> ID：11513248
> 
> 赞同：4
> 
> 时间：2012-07-16T22:03:08.273
> 
> 标签：objective-c, ios, uitableview, search, uisearchdisplaycontroller

我有一个`UISearchDisplayController`正确连接到`UITableView`IB 中自定义的标题。但是，当我搜索任何内容时，`searchResultsTableView`只会显示“无结果”，而且我似乎找不到代码不正确的地方。

**`searchResults`财产**

```
- (NSMutableArray *)searchResults {
    if (!_searchResults) {
        _searchResults = [[NSMutableArray alloc] initWithCapacity:self.listingPreviews.count];
    }

    return _searchResults;
} 
```

**表视图数据源方法**

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    // Return the number of rows in the section.
    NSInteger numberOfRows = 0;

    if (tableView == self.tableView) {
        numberOfRows = self.listingPreviews.count;
    } else {
        numberOfRows = self.searchResults.count;
    }

    return numberOfRows;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Listing";
    ListingPreviewTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (!cell) {
        cell = [[ListingPreviewTableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell.
    if (tableView == self.tableView) {
        cell.listingPreview = [self.listingPreviews objectAtIndex:indexPath.row];
    } else {
        NSLog([[self.searchResults objectAtIndex:indexPath.row] title]);
        cell.listingPreview = [self.searchResults objectAtIndex:indexPath.row];
    }

    return cell;
} 
```

**搜索栏委托方法**

```
- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText {
    NSInteger searchTextLength = searchText.length;

    for (ListingPreview *listingPreview in self.listingPreviews) {
        if ((listingPreview.title.length >= searchTextLength) && ([listingPreview.title rangeOfString:searchText].location != NSNotFound)) {
            [self.searchResults addObject:listingPreview];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T05:46:05.750

试试这个：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Listing";
ListingPreviewTableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:CellIdentifier];

// Configure the cell.
if (tableView == self.tableView) {
    cell.listingPreview = [self.listingPreviews objectAtIndex:indexPath.row];
} else {
    NSLog([[self.searchResults objectAtIndex:indexPath.row] title]);
    cell.listingPreview = [self.searchResults objectAtIndex:indexPath.row];
}

return cell; 
```

}

请注意，更改适用于：

ListingPreviewTableViewCell *cell = [ **self.tableView** dequeueReusableCellWithIdentifier:CellIdentifier];

这样你就可以从你自己的 tableView 中提取一个 Cell，而不是从 UISearchDisplayController 创建的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:00:21.330

似乎您的代码中没有任何内容会强制 searchDisplayController 重新加载它的 searchResultTableView。

标准方法是设置`UISearcDisplayController's`委托（注意协议 - `UISearchDisplayDelegate`）并实现`– searchDisplayController:shouldReloadTableForSearchString:`

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString {

    // perform your search here and update self.searchResults
    NSInteger searchStringLength = searchString.length;

    for (ListingPreview *listingPreview in self.listingPreviews) {
        if ((listingPreview.title.length >= searchStringLength) && ([listingPreview.title rangeOfString:searchString].location != NSNotFound)) {
            [self.searchResults addObject:listingPreview];
        }
    }

    // returning YES will force searchResultController to reload search results table view
    return YES;
} 
```

# html - 如何在一定时间后（在网页上）停止 GIF 动画？

> ID：11513250
> 
> 赞同：2
> 
> 时间：2012-07-16T22:03:15.417
> 
> 标签：html, animation, gif

> **可能重复：**
> [以编程方式停止 GIF 动画](https://stackoverflow.com/questions/3688460/stopping-gif-animation-programmatically)

当我打开一个带有动画 GIF 的页面，并且该选项卡在窗口中处于活动状态时，它会占用 CPU。

我想知道是否有一种方法可以标记 HTML，以便 GIF 将播放指定的时间或循环次数。

或者也许我最好使用静态图像并将其源设置为悬停时的 GIF（我相信大多数移动浏览器通过允许在点击时设置悬停来修补）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:29:18.280

我使用 Fireworks 制作动画 gif，您可以从 Fireworks 中调整这些设置，而无需对 html 进行任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T03:09:25.827

我不相信 HTML 或 DOM 提供对 GIF 动画的任何控制，但您可以通过图像生成工具对循环次数进行有限的控制。

例如，在 Photoshop 中：

![在此处输入图像描述](../Images/a3a385f2298b68997ff8205f691c7fd0.png)

IE9 和 Chrome 尊重循环计数；我想所有的浏览器都会这样做，尽管我在规范中找不到关于循环应该如何表现的提及。

[GIF89a 规范](http://www.w3.org/Graphics/GIF/spec-gif89a.txt)

如果您无法修改图像，或者想在不同时间停止它们，也许只需使用一点 JavaScript 将动画 GIF 替换为静态 GIF。

# ios - iOS CLLocationManager 在一个单独的类中

> ID：11513259
> 
> 赞同：17
> 
> 时间：2012-07-16T22:04:02.830
> 
> 标签：ios, xcode, core-location, cllocationmanager

我有多个需要获取用户位置的视图控制器，所以我想创建一个单独的类，ViewController 可以调用该类来获取用户的最新位置。

locationManager:didUpdateToLocation:fromLocation 返回 void。一旦计算出用户的纬度和经度，如何将纬度和经度数据传回我的 ViewControllers？

我可以尝试在我的 locationManaging 类中编写 getter 和 setter，但如果这样做，我怎么知道何时从我的 ViewController 类中调用纬度 getter 和经度 getter 方法？如何让 ViewController 的主线程等待来自 locationManaging 类的纬度和经度值？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-16T22:29:19.303

正如 user1071136 所说，单例位置管理器可能是您想要的。创建一个类，NSObject 的子类，只有一个属性 a `CLLocationManager`。

LocationManagerSingleton.h：

```
#import <MapKit/MapKit.h>

@interface LocationManagerSingleton : NSObject <CLLocationManagerDelegate>

@property (nonatomic, strong) CLLocationManager* locationManager;

+ (LocationManagerSingleton*)sharedSingleton;

@end 
```

LocationManagerSingleton.m:

```
#import "LocationManagerSingleton.h"

@implementation LocationManagerSingleton

@synthesize locationManager;

- (id)init {
    self = [super init];

    if(self) {
        self.locationManager = [CLLocationManager new];
        [self.locationManager setDelegate:self];
        [self.locationManager setDistanceFilter:kCLDistanceFilterNone];
        [self.locationManager setHeadingFilter:kCLHeadingFilterNone];
        [self.locationManager startUpdatingLocation];
        //do any more customization to your location manager
    }

    return self;
}    

+ (LocationManagerSingleton*)sharedSingleton {
    static LocationManagerSingleton* sharedSingleton;
    if(!sharedSingleton) {
        static dispatch_once_t onceToken;
        dispatch_once(&onceToken, ^{
            sharedSingleton = [LocationManagerSingleton new];
        }
    }

    return sharedSingleton;
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
    //handle your location updates here
}

- (void)locationManager:(CLLocationManager *)manager didUpdateHeading:(CLHeading *)newHeading {
    //handle your heading updates here- I would suggest only handling the nth update, because they
    //come in fast and furious and it takes a lot of processing power to handle all of them
}

@end 
```

要获取最近收到的位置，只需使用`[LocationManagerSingleton sharedSingleton].locationManager.location`. 预热 GPS 可能需要几秒钟才能获得准确的位置。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-16T22:18:41.133

创建一个具有`latitude`和`longitude`属性的单例类，`startLocating`以及`endLocating`。在类中，创建一个`CLLocationManager`实例，并将其委托设置为单例。在`startLocating`and中，调用实例`endLocating`的相应方法。`CLLocationManager`使委托方法更新`latitude`和`longitude`属性。在其他`ViewControllers`方面，请阅读此单例`latitude`和`longitude`属性。

要知道何时从另一个读取这些属性`ViewController`，请在这些属性上设置观察者（请参阅[NSKeyValueObserving 协议参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueObserving_Protocol/Reference/Reference.html)

在执行此操作之前，请在 Internet 上查找现有代码。

完成此操作后，使用许可许可证将其上传到 GitHub。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-30T20:00:02.173

基于上述答案，这就是我所做的，您可以在 github [https://github.com/irfanlone/CLLocationManager-Singleton-Swift上找到完整的示例](https://github.com/irfanlone/CLLocationManager-Singleton-Swift)

只需将此文件导入您的项目，然后您可以选择实现 LocationUpdateProtocol 或收听位置更新通知

```
import MapKit

protocol LocationUpdateProtocol {
    func locationDidUpdateToLocation(location : CLLocation)
}

/// Notification on update of location. UserInfo contains CLLocation for key "location"
let kLocationDidChangeNotification = "LocationDidChangeNotification"

class UserLocationManager: NSObject, CLLocationManagerDelegate {

    static let SharedManager = UserLocationManager()

    private var locationManager = CLLocationManager()

    var currentLocation : CLLocation?

    var delegate : LocationUpdateProtocol!

    private override init () {
        super.init()
        self.locationManager.delegate = self
        self.locationManager.desiredAccuracy = kCLLocationAccuracyBest
        self.locationManager.distanceFilter = kCLLocationAccuracyHundredMeters
        locationManager.requestAlwaysAuthorization()
        self.locationManager.startUpdatingLocation()
    }

    // MARK: - CLLocationManagerDelegate

    func locationManager(manager: CLLocationManager, didUpdateToLocation newLocation: CLLocation, fromLocation oldLocation: CLLocation) {
        currentLocation = newLocation
        let userInfo : NSDictionary = ["location" : currentLocation!]

        dispatch_async(dispatch_get_main_queue()) { () -> Void in
            self.delegate.locationDidUpdateToLocation(self.currentLocation!)
            NSNotificationCenter.defaultCenter().postNotificationName(kLocationDidChangeNotification, object: self, userInfo: userInfo as [NSObject : AnyObject])
        }
    }

} 
```

用法：

```
class ViewController: UIViewController, LocationUpdateProtocol {

    var currentLocation : CLLocation!

    override func viewDidLoad() {
        super.viewDidLoad()

        NSNotificationCenter.defaultCenter().addObserver(self, selector: "locationUpdateNotification:", name: kLocationDidChangeNotification, object: nil)

        let LocationMgr = UserLocationManager.SharedManager
        LocationMgr.delegate = self

    }

    // MARK: - Notifications

    func locationUpdateNotification(notification: NSNotification) {
        let userinfo = notification.userInfo
        self.currentLocation = userinfo!["location"] as! CLLocation
        print("Latitude : \(self.currentLocation.coordinate.latitude)")
        print("Longitude : \(self.currentLocation.coordinate.longitude)")

    }

    // MARK: - LocationUpdateProtocol

    func locationDidUpdateToLocation(location: CLLocation) {
        currentLocation = location
        print("Latitude : \(self.currentLocation.coordinate.latitude)")
        print("Longitude : \(self.currentLocation.coordinate.longitude)")
    }

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-16T20:17:28.700

这是我在 swift 中实现位置管理器单例时所做的。它基于 user1071136 的策略，以及[这种 swift 模式](https://stackoverflow.com/a/24073016/3330743)。

```
//
//  UserLocationManager.swift
//
//  Use: call SharedUserLocation.currentLocation2d from any class

import MapKit

class UserLocation: NSObject, CLLocationManagerDelegate {

    var locationManager = CLLocationManager()

    // You can access the lat and long by calling:
    // currentLocation2d.latitude, etc

    var currentLocation2d:CLLocationCoordinate2D?

    class var manager: UserLocation {
        return SharedUserLocation
    }

    init () {
        super.init()
        if self.locationManager.respondsToSelector(Selector("requestAlwaysAuthorization")) {
            self.locationManager.requestWhenInUseAuthorization()
        }
        self.locationManager.delegate = self
        self.locationManager.desiredAccuracy = kCLLocationAccuracyBest
        self.locationManager.distanceFilter = 50
        self.locationManager.startUpdatingLocation()
    }

    func locationManager(manager: CLLocationManager!, didUpdateLocations locations: [AnyObject]!) {
        self.currentLocation2d = manager.location.coordinate

    }
}

let SharedUserLocation = UserLocation() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-12T11:27:17.430

在学习单例类获取用户位置的过程中，我下载了这段代码[https://github.com/irfanlone/CLLocationManager-Singleton-Swift](https://github.com/irfanlone/CLLocationManager-Singleton-Swift)。在使用它在 Xcode8.3.3 Swift 3 上运行后，我无法在调试控制台中获得任何输出。事实上，我什至无法显示这个位置授权 dlalog。我怀疑来自单例的数据没有传递给视图控制器，但是我无法解决这个问题，你能看出什么问题吗？谢谢。

Swift 3 的更正代码是：

```
//The singleton:
import MapKit

protocol LocationUpdateProtocol {
func locationDidUpdateToLocation(_ location : CLLocation)
}

let kLocationDidChangeNotification = "LocationDidChangeNotification"

class UserLocationManager: NSObject, CLLocationManagerDelegate {

static let SharedManager = UserLocationManager()

fileprivate var locationManager = CLLocationManager()

var currentLocation : CLLocation?

var delegate : LocationUpdateProtocol!

fileprivate override init () {
    super.init()
    self.locationManager.delegate = self
    self.locationManager.desiredAccuracy = kCLLocationAccuracyBest
    self.locationManager.distanceFilter = kCLLocationAccuracyHundredMeters
    locationManager.requestAlwaysAuthorization()
    self.locationManager.startUpdatingLocation()
}

// MARK: - CLLocationManagerDelegate
func locationManager(manager: CLLocationManager,didUpdateToLocation newLocation: CLLocation, fromLocation oldLocation: CLLocation) {
    currentLocation = newLocation
    let userInfo : NSDictionary = ["location" : currentLocation!]

    DispatchQueue.main.async() { () -> Void in
        self.delegate.locationDidUpdateToLocation(self.currentLocation!)
        NotificationCenter.default.post(name: Notification.Name(kLocationDidChangeNotification), object: self, userInfo: userInfo as [NSObject : AnyObject])
    }
}

}

  // The ViewController
    import UIKit
    import CoreLocation

 class ViewController: UIViewController, LocationUpdateProtocol {

var currentLocation : CLLocation!

override func viewDidLoad() {
    super.viewDidLoad()

    NotificationCenter.default.addObserver(self, selector: #selector(ViewController.locationUpdateNotification(_:)), name: NSNotification.Name(rawValue: kLocationDidChangeNotification), object: nil)

    let LocationMgr = UserLocationManager.SharedManager
    LocationMgr.delegate = self

}

// MARK: - Notifications

func locationUpdateNotification(_ notification: Notification) {
    let userinfo = notification.userInfo
    self.currentLocation = userinfo!["location"] as! CLLocation
    print("Latitude : \(self.currentLocation.coordinate.latitude)")
    print("Longitude : \(self.currentLocation.coordinate.longitude)")

}

// MARK: - LocationUpdateProtocol

func locationDidUpdateToLocation(_ location: CLLocation) {
    currentLocation = location
    print("Latitude : \(self.currentLocation.coordinate.latitude)")
    print("Longitude : \(self.currentLocation.coordinate.longitude)")
}

} 
```

# html - 仅在一个 div 中的滚动条

> ID：11513260
> 
> 赞同：4
> 
> 时间：2012-07-16T22:04:03.567
> 
> 标签：html, css

比如说，我有两个`divs`这样的：

```
<body>
    <div id="header">
        MY CONTENTS
    </div>
    <div id="main">
        MY OTHER CONTENTS
    </div>
</body> 
```

第一个`div`有属性`position:fixed;`和`width:100%;`CSS，另一个`div`只是一个div，里面有很多内容。

好的，和往常一样，右侧有一个滚动条。但是这个滚动条会影响所有的`divs`. 我希望滚动条只影响第二个`div`，可能吗？

`overflow:auto`我用,尝试了一切`overflow:hidden`，`overflow:scroll`但我没有达到我的目标......

* * *

**编辑**：这里是我的 jsfiddle：http: [//jsfiddle.net/upcfp/](http://jsfiddle.net/upcfp/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:04:43.423

好的，我解决了我的问题，我使用了这段代码：

```
body{
overflow: hidden;
}
#main{
overflow: scroll;
}
#maincontent{
height: 1500px;
} 
```

我在#main 的内容中指定了高度，它刚刚工作，感谢大家！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:06:46.423

尝试：

```
#div2 {
  overflow-y: scroll;
} 
```

那只会在需要时放置滚动条。要始终显示它们，请使用`overflow-y: scroll;`. 我在第二个 div 的 ID 前面加上了前缀，`div`因为一般来说，您不应该只使用数字作为 ID 或属性。

表示该`#`规则将应用于 ID 后面的元素`#`。如果您希望将其应用于所有人，`div`那么您将使用一个类。

演示：http: [//jsfiddle.net/6EVtN/](http://jsfiddle.net/6EVtN/)

在没有看到更多代码的情况下，问题可能是由于浏览器兼容性造成的。上面的示例在 Mozilla Firefox 13.0.1 和 IE 8 中进行了测试。

更新演示：http: [//jsfiddle.net/j4uAM/](http://jsfiddle.net/j4uAM/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:24:56.267

你想做这样的事情吗？

[jsfiddle 示例 1](http://jsfiddle.net/5VaQP/1/)

我编辑了你的 jsfiddle 并删除了一些不需要的部分：

[你的jsfiddle的编辑版本](http://jsfiddle.net/upcfp/4/)

好像有一个

```
</div> 
```

#header 中缺少，但这是您想要得到的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T22:32:54.380

这是[你](http://jsfiddle.net/purmou/6AZvm/2/)的想法吗？

这是一个简单的方法。我的标题在顶部，绝对定位，高度为 100 像素。在此之下，我有主要内容区域，其高度为 100%，透明顶部边框为 100 像素（因此内容显示在绝对定位的标题下方）。

CSS 中的`box-sizing`属性允许我们将整个元素适应我们指定的宽度和高度，包括填充和边框。所以包括上边框在内，主要内容的高度是100%，滚动条只出现在主要内容的div上。

`html`顺便说一句，这里的技巧是将两者的高度设置`body`为 100%。否则这是行不通的。

CSS：

```
html,body {
    height:100%;
}
#header {
    position:absolute;
    width: 100%;
    height: 100px;
    background:#c3c3c3;
    z-index:1;
}
#main {
    background: #eee;
    height:100%;
    border-top:100px solid transparent;
    -webkit-box-sizing:border-box;
    -moz-box-sizing:border-box;
    box-sizing:border-box;
    overflow:auto;
}​ 
```

[这](http://jsfiddle.net/purmou/upcfp/5/)是您使用我的解决方案的小提琴。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-08-01T01:27:03.460

这是一个完美的解决方案，但我不知道如何在 stackoverflow 中保留代码格式：

```
<script>
$("#cart").bind("mousewheel", function(e){
var intElemScrollHeight = document.getElementById("cart").scrollHeight;
var intElemClientHeight = document.getElementById("cart").clientHeight;
if( intElemScrollHeight - $("#cart").scrollTop() === intElemClientHeight) {
    $(document).bind("mousewheel", function(event) {
        event.preventDefault();
    });
}
if(e.originalEvent.wheelDelta /120 > 0 ) {
    if($("#cart").scrollTop() != 0) {
        $(document).unbind("mousewheel"); 
    } else {
        event.preventDefault();
    }
}});
$("#cart").on("mouseleave", function(event) {
   $(document).unbind("mousewheel");
});
</script> 
```

# apache - Magento + htaccess + mod_rewrite：强制尾部斜杠和强制小写 URL

> ID：11513261
> 
> 赞同：1
> 
> 时间：2012-07-16T22:04:14.140
> 
> 标签：apache, .htaccess, magento, mod-rewrite

我正在尝试对我的 Magento 商店的 htaccess 文件进行一些更改，以在所有不是文件且不是 .html（产品页面）的 URL 的末尾强制使用斜杠。同时，我也试图在 URL 中强制使用小写字母。这两个都是出于 SEO 原因，因为指向 /category、/Category 和 /category/ 的链接都被 Google 视为不同的页面。

这是 .htaccess 的重写部分：

```
<IfModule mod_rewrite.c>

Options +FollowSymLinks
RewriteEngine on

RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteCond %{REQUEST_URI} !^/(media|skin|js)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule .* index.php [L]

</IfModule> 
```

我看到了这两个片段，第一个用于强制小写，第二个用于斜杠：

```
RewriteMap  lc int:tolower
RewriteCond %{REQUEST_URI} [A-Z]
RewriteRule (.*) ${lc:$1} [R=301,L] 
```

和...

```
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ http://domain.com/$1/ [L,R=301] 
```

但是，我不确切知道如何或在何处将这些插入现有的重写中，因此一切都按预期工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:12:29.470

把它放在你的 .htaccess 中：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /

RewriteCond %{REQUEST_URI} [A-Z]
RewriteRule (.*) ${lc:$1} [L,R=301]

RewriteCond %{REQUEST_URI} !(.*)/$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !^index.php
RewriteCond %{REQUEST_URI} !\.(html|jpg|png|gif)$
RewriteRule ^(.*)$ $1/ [L,R=301]

RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteCond %{REQUEST_URI} !^/(media|skin|js)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule .* index.php [L]

</IfModule> 
```

并将其放入您的 vhost 配置或 httpd.conf 中：

```
RewriteMap  lc int:tolower 
```

# node.js - 如何比较和更新 2 个模型？

> ID：11513262
> 
> 赞同：0
> 
> 时间：2012-07-16T22:04:16.020
> 
> 标签：node.js, mongodb, mongoose

我希望能够比较 2 个模型。

场景：我有从第 3 方来源创建的对象。我想定期检查以确保我目前拥有的信息是最新的。所以我会创建一个新模型（未保存）并从我的数据库中提取我现有的模型；现在我想比较这两种模型，如果我创建的第 3 方模型与数据库中当前存在的模型之间存在差异，我想用新信息更新我数据库中的模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T07:32:03.417

如果可能，最简单的方法是：

*   `last_modified`将原始第 3 方来源的时间戳保存为`last_sync`文档中的时间戳
*   只比较时间戳

否则，您将不得不迭代两个模型的字段（不包括那些不应比较的字段，例如`_id`）并寻找要应用的更改。

[仅update()](http://www.mongodb.org/display/DOCS/Updating#Updating-update%28%29)整个文档可能会花费更少的时间，或者使用[$set](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)对字段更具选择性。

# javascript - 主干视图原型事件绑定

> ID：11513263
> 
> 赞同：0
> 
> 时间：2012-07-16T22:04:26.800
> 
> 标签：javascript, backbone.js, prototype

我正在创建一个 Backbone.js 插件，它在给定提供的 JSON 数据的情况下提供基本的网格布局。我的问题是我不确定如何在不更改插件本身的情况下将事件绑定到 View 类。我宁愿不这样做——我宁愿让插件的用户能够扩展视图，或者改变它的原型来绑定自定义事件。

插件中的 View 是一个基本视图，没有绑定任何事件。它还包含一些其他功能，为简单起见，我省略了这些功能。

```
FlipCard.CardView = Backbone.View.extend({

    tagName: 'div',

    className: 'card',

// and more

}); 
```

我尝试在单独的 app.js 文件中使用原型属性来绑定事件，但它们似乎没有被触发。

```
FlipCard.CardView.prototype.events = {
    'click .card' : 'alert'
};

FlipCard.CardView.prototype.alert = function(){
    alert("hello!");
}; 
```

而且我对 .extend({}) 函数很熟悉，但是除非我能以某种方式通知插件使用视图的*扩展*版本，否则这将不起作用……我宁愿不这样做。

关于我应该在这里做什么的任何想法？

编辑：原来这是一个愚蠢的错误。因为视图有“.card”类，并且我试图将点击事件绑定到“.card”，所以没有必要放入“点击.card”。相反，事件应该是：

```
FlipCard.CardView.prototype.events = {
    'click' : 'alert'
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:11:41.717

如果有人要使用他们的插件，他们会`FlipCard.CardView`以与您扩展相同的方式扩展您的插件`Backbone.Model`

```
myApp.Views.myCardView = FlipCard.CardView.extend({
    events: {
        'click .card' : 'alert'
    },
    alert: function() {
        alert("hello!");
    }
} 
```

这会创建一个插件视图的扩展版本，其中绑定了事件，并且它不会以任何方式改变插件。然后，用户将照常实例化它：

```
var someView = new myApp.Views.myCardView(); 
```

# asp.net-mvc - 如何在mvc中保留复选框选择？

> ID：11513264
> 
> 赞同：0
> 
> 时间：2012-07-16T22:04:36.120
> 
> 标签：asp.net-mvc

我有一个 MVC 站点/视图，在顶部显示了一系列复选框，这些复选框对应于我的 webgrid 记录中可用的年份。我想点击复选框来过滤 webgrid 中的数据。我有这个工作，但是当我单击 webgrid 中的标题对其进行排序时，我的复选框重置为未选中状态。

我习惯于 webform 编程，所以一直依赖视图状态来维护选择。

我如何在 MVC 世界中做到这一点？

这是我在视图中显示复选框的代码：

```
 @using (Ajax.BeginForm(new AjaxOptions { InsertionMode=InsertionMode.Replace,UpdateTargetId="myGrid"}))
{
    foreach (var y in Model.Years)
    {
      <input type="checkbox" name="cbYears" value="@y.Value" />
      <label for="cbYears">@y.Value</label>
    }
<br />
<input type="submit" value="Filter Results" />
} 
```

网格显示在局部视图中。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T06:41:21.760

> 我如何在 MVC 世界中做到这一点？

当您在网格中执行排序时，您必须在请求中发送过滤选项。这个想法是每当您执行排序时，您必须以查询字符串或表单提交当前过滤器选项、当前分页和与请求中的网格相关的其他内容，这样您就不需要维护状态因为请求中提供了所有需要的信息。

例如。如果你看到 jqgrid 它提供了许多选项，如排序、过滤、分页、分组等。首先说我已经过滤了特定列/值的网格，然后如果我进行排序，那么网格会附加当前过滤的列/值和排序在请求中将所有内容列为查询字符串，因此在服务器端我不需要保留任何状态，因为所有内容都在查询字符串中可用。

您也遵循类似的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:25:05.750

很高兴这些能帮上忙！

[MVC3 WebGrid 页面/排序问题与页面上其他地方的复选框](https://stackoverflow.com/questions/8164546/mvc3-webgrid-page-sort-issue-with-a-checkbox-elsewhere-on-the-page)

[http://websitesorcery.com/post/2012/03/19/CheckBox-Issue-with-MVC-3-WebGrid-Paging-Sorting.aspx](http://websitesorcery.com/post/2012/03/19/CheckBox-Issue-with-MVC-3-WebGrid-Paging-Sorting.aspx)

# android - Service Async Task 中的繁重操作会冻结屏幕

> ID：11513267
> 
> 赞同：0
> 
> 时间：2012-07-16T22:04:49.333
> 
> 标签：android, service, upload, android-asynctask

我开发了一个应用程序，其目的之一是将文件上传到服务器。平均而言，文件很大，上传需要很多时间，所以为了确保它能够被处理到最后，我将 IO 的关键部分移到了 IntentService 中。每次上传的 IntentService 都会启动一个 AsyncTask 来执行 IO 工作。不幸的是，在后台进行上传时，屏幕滚动会冻结几次。我认为 IntentService+AsyncTask 的组合应该足够了......我会很感激任何关于如何解决它的建议......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:25:32.447

我认为您可能在滥用 IntentService。我假设您是`AsyncTask.execute(...)`从`IntentService.onHandleIntent(Intent)`.

创建 IntentService 是为了在非 UI 线程上一次执行一项后台任务。这意味着它`onHandleIntent(Intent)`是从后台线程调用的，不应创建 AsyncTasks。此外，一旦`onHandleIntent(Intent)`完成（如果您所做的只是启动 AsyncTask，它会立即执行此操作），该服务将被关闭。

我知道这并不能直接回答您的问题，但它可能会指出问题的原因。请注意，如果您需要能够同时处理多个请求，那么您最好的选择就是扩展 Service 并将工作请求排入 Executor 中`onStartCommand(...)`。

[编辑] 有关正确使用的更多信息，`IntentService`请查看[此](http://developer.android.com/reference/android/app/IntentService.html#onHandleIntent%28android.content.Intent%29)内容。

# ios - 我得到了我发布的打开图表操作的确认，但没有看到任何帖子

> ID：11513269
> 
> 赞同：1
> 
> 时间：2012-07-16T22:04:58.927
> 
> 标签：ios, facebook, sdk

我正在使用新的 Facebook IOS SDK 3.0 并将 Scrumptious 示例集成到我的应用程序中。我已经正确地为我的应用程序指定了命名空间和操作。当我点击“宣布”时，我得到“已发布打开图形操作，id：xxxxx”，所以看起来我的帖子是成功的。我假设该帖子将转到我的个人 Facebook 新闻流，因为我以我的身份登录，但是我什么也没看到。是否需要对我的应用程序执行任何操作才能使其处于活动状态？或者我可能忽略的其他设置？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T04:30:40.333

原来我没有在我的 Facebook 帐户上启用时间线，所以我没有看到这些帖子。一旦我启用它，我就能看到它们。我也可以在我的活动日志中看到它们。我现在有另一个标签问题，但至少我现在可以发布。谢谢。

# wpf - WPF - 将网格行绑定到模型列表

> ID：11513270
> 
> 赞同：0
> 
> 时间：2012-07-16T22:05:02.547
> 
> 标签：wpf, data-binding

所以我有一个人员列表，并希望我的网格中的每一行都对应于列表中的一个元素。
诀窍是 - 我希望一个人的每个属性都有不同的控制。

例如，我希望 name 属性使用文本框，age 属性使用下拉框，isfemale 属性使用复选框。

换句话说，我想要一个重复行的网格，如果不同的控件，行是一个集合。

编辑：如何将数据网格中的每一列设置为不同类型的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:08:08.243

那你在找`DataGrid`吗？

[http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.aspx)

行+列的表，每列有不同的控件？

*如果您真的希望它看起来*像一个列表，您可以隐藏列标题，并调整网格的样式以使其看起来像一个列表。

# linq - 如果您使用实体投影，您会获得 IQueryable 的好处吗？

> ID：11513271
> 
> 赞同：2
> 
> 时间：2012-07-16T22:05:13.820
> 
> 标签：linq, entity-framework, entity-framework-4, linq-to-entities, linq-to-objects

可以说我有这样的方法：

```
IQueryable<MyFlatObject> GetMyFlatObjects()
{
    using (var context = new MyEntities())
    {
        return context.MyEntities.Select(x => new MyFlatObject()
                                                  {
                                                     Property1 = x.PropertyA,
                                                     Property2 = x.PropertyB,
                                                     Property3 = x.PropertyC,
                                                  });
    }
} 
```

现在，如果我打电话：

```
MyService.GetMyFlatObjects().Where(x => x.Property1 == "test"); 
```

完整性检查。此过滤器不会传播到我的数据库存储区（就像我刚刚查询了我的实体一样），而是我将取回所有结果并使用 LINQ-to-objects 进行过滤。正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:20:41.277

我想，这是不对的。首先，它不查询任何内容，因为您只是将 an 扩展`IQueryable<T>`到 new `IQueryable<T>`。如果您调用`ToList()`或执行任何其他导致查询执行的操作，您将收到异常，因为上下文已在`using`块的末尾释放。如果您不处置上下文，`Where`过滤器将被转换为 SQL 并在数据库中执行。我相信它的行为方式与`Where`您`PropertyA` *在*`Select`.

# javascript - Opera 中的 JSON 解析抛出“非法数字格式（尾随小数点）”

> ID：11513272
> 
> 赞同：0
> 
> 时间：2012-07-16T22:05:15.107
> 
> 标签：javascript, json, opera, syntax-error

什么样的 JSON 可能会导致 Opera 12（在其他浏览器中不会发生）抛出以下错误：

> `SyntaxError: JSON.parse: Illegal number format (trailing decimal dot)`

*客户告诉我他们收到了这个错误，但由于他们技术不高，我无法引导他们深入挖掘字符串。我试图自己重现错误，但到目前为止还没有成功。因此，我不知道导致此问题的 JSON 字符串。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:06:40.730

如果您有一个带有尾随点的数字文字，则可能会导致此错误，例如

```
{
  n: 1234.
} 
```

# html - Docbook - 抑制 TOC

> ID：11513273
> 
> 赞同：0
> 
> 时间：2012-07-16T22:05:43.000
> 
> 标签：html, docbook

我正在使用 1.77 xsl 转换将 docbook 转换为 html。但是当它被转换时，它会自动生成一个目录。你如何改变这种行为？

我发现了这个： [禁用文档目录](https://stackoverflow.com/questions/1088063/disable-table-of-contents-for-documents)

所以我猜测 html xsl 转换将是演示系统？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:24:16.097

转换时，您可以使用该`Transformer#setParameter(String, Object)`方法指定不生成 TOC，如下所示：

```
transformer.setParameter("generate.toc", "nop"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T21:36:48.177

Elaborate DocBook 格式旨在使用 xsl 样式表进行自定义。

### 也可以看看

[编写用于格式化的 DocBOOK 自定义层](http://xml.web.cern.ch/XML/www.sagehill.net/xml/docbookxsl/CustomMethods.html#CustomDriverFile "编写自定义层")

[使用 XSL 自定义目录](http://xml.web.cern.ch/XML/www.sagehill.net/xml/docbookxsl/GeneralCustoms.html#TOCcontrol "自定义目录")

### custom_formatting.xsl：DocBook XSL 自定义层示例

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:fo="http://www.w3.org/1999/XSL/Format"
    version="1.0"> <!-- change this to 2.0 if your tools support it -->
    <xsl:import href="http://docbook.sourceforge.net/release/xsl/current/fo/docbook.xsl"/>

    <!--uncomment this to suppress toc when using XSL 1.0 or 2.0
    <xsl:param name="generate.toc">article</xsl:param>
    <xsl:param name="generate.toc">book</xsl:param>
    -->

    <!--uncomment this to suppress toc when using XSL 2.0
    <xsl:param name="generate.toc">
        article nop
        book nop
    </xsl:param>
    -->

</xsl:stylesheet> 
```

### 如何使用 customize_formatting.xsl

将您的工具指向使用 customize_formatting.xsl 而不是现成的 docbook.xsl。然后，将所有格式自定义设置在该`<xsl:stylesheet>`部分的正文中。

对于 TOC 抑制，您可以取消注释相应的行。

一些（或者可能全部）XSL 1.0 工具有一个怪癖，似乎阻止它们处理`<xsl:param name="generate.toc">`. `article`通过仅使用单个单词或`book`代替正确的空格分隔对，我已经成功地抑制了 TOC 。

# ruby-on-rails-3 - Rails JSON 意外令牌错误

> ID：11513274
> 
> 赞同：0
> 
> 时间：2012-07-16T22:05:59.927
> 
> 标签：ruby-on-rails-3, json

我对我在 JSON 中看到的问题感到困惑。我正在使用我的控制器将一些值（从我的公用文件夹中的文件中读取）注入到 fxn 调用中。

**应用程序/视图/比较/graphs.html.haml**：

```
 - tmp = File.readlines(txt)
  :javascript
    generate_plot(#{tmp.first}) 
```

它在我的 html 中生成：

```
<script>
  //<![CDATA[
    generate_plot([[[22.0,307.0,491.0,35.0,580.0,40.0,387.0,28.0,34.0,519.0,4.0,59.0,33.0,448.0,24.0,341.0],["2011-04-27T05:32:00-06:00","2011-04-27T05:32:00-06:00","2011-05-20T02:49:00-06:00","2011-05-20T02:49:00-06:00","2010-10-12T23:27:00-06:00","2010-10-12T23:27:00-06:00","2010-11-21T19:20:00-07:00","2010-11-21T19:20:00-07:00","2011-11-03T08:59:00-06:00","2011-11-03T08:59:00-06:00","2011-02-22T03:24:00-07:00","2011-02-22T03:24:00-07:00","2010-08-17T20:26:00-06:00","2010-08-17T20:26:00-06:00","2011-11-09T06:15:00-07:00","2011-11-09T06:15:00-07:00"]],[[24.0,463.0,566.0,31.0,864.0,57.0,28.0,596.0,717.0,47.0,31.0,28.0,596.0,35.0,597.0,622.0,463.0,24.0,463.0,24.0,719.0,51.0,556.0,30.0,51.0,891.0,30.0,556.0,494.0,38.0,23.0,443.0,581.0,28.0,581.0,28.0,556.0,30.0,622.0,31.0],["2010-10-15T10:04:00-06:00","2010-10-15T10:04:00-06:00","2010-09-20T04:24:00-06:00","2010-09-20T04:24:00-06:00","2010-01-08T02:10:00-07:00","2010-01-08T02:10:00-07:00","2010-09-02T20:40:00-06:00","2010-09-02T20:40:00-06:00","2010-07-08T13:11:00-06:00","2010-07-08T13:11:00-06:00","2010-02-22T23:10:00-07:00","2010-09-15T04:13:00-06:00","2010-09-15T04:13:00-06:00","2010-05-08T19:01:00-06:00","2010-05-08T19:01:00-06:00","2010-02-22T23:10:00-07:00","2010-01-10T18:59:00-07:00","2010-01-10T18:59:00-07:00","2010-06-23T14:10:00-06:00","2010-06-23T14:10:00-06:00","2010-04-04T21:57:00-06:00","2010-04-04T21:57:00-06:00","2010-01-09T11:01:00-07:00","2010-01-09T11:01:00-07:00","2010-04-30T02:10:00-06:00","2010-04-30T02:10:00-06:00","2010-10-08T13:59:00-06:00","2010-10-08T13:59:00-06:00","2010-03-03T13:12:00-07:00","2010-03-03T13:12:00-07:00","2010-06-29T15:06:00-06:00","2010-06-29T15:06:00-06:00","2010-02-14T05:47:00-07:00","2010-02-14T05:47:00-07:00","2010-06-18T05:23:00-06:00","2010-06-18T05:23:00-06:00","2010-05-12T20:05:00-06:00","2010-05-12T20:05:00-06:00","2010-03-04T19:18:00-07:00","2010-03-04T19:18:00-07:00"]],2])
  //]]>
</script> 
```

我检查并重新检查了我的输入，但我收到此错误：

**意外的令牌错误，**

当我简单地删除括号和函数调用时，我的 Json 是有效的：

[http://jsfiddle.net/VVL8C/](http://jsfiddle.net/VVL8C/)

我不确定还有什么问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:17:13.603

这是一个有效的 JSON 示例

```
var myJSONObject = {"bindings": [
        {"ircEvent": "PRIVMSG", "method": "newURI", "regex": "^http://.*"},
        {"ircEvent": "PRIVMSG", "method": "deleteURI", "regex": "^delete.*"},
        {"ircEvent": "PRIVMSG", "method": "randomURI", "regex": "^random.*"}
    ]
}; 
```

> [http://www.json.org/js.html](http://www.json.org/js.html)

最后而不是`,2])` 尝试

```
,[[2],[""]] ) 
```

# javascript - 使用正则表达式从段落的开头和结尾删除断点

> ID：11513275
> 
> 赞同：0
> 
> 时间：2012-07-16T22:06:07.797
> 
> 标签：javascript, html, regex

我有我的 html 片段，如下所示

* * *

```
<B>Summary:</B><BR><BR><BR><BR><BR>
<P><BR><SPAN style="WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; LETTER-SPACING: normal; DISPLAY: inline !important; FONT: 13px Verdana, Arial, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; FLOAT: none; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">Web developer can also use Regular Expression in JavaScript. Now I describe some simple examples of using Regular Expression in JavaScript.</SPAN></P><BR>
<P><BR><A href="http://www.yahoo.com">www.yahoo.com</A></P><BR>
<P><BR><A href="http://www.orkut.com">www.orkut.com</A></P><BR><BR> 
```

* * *

> `I want to remove all the <BR> tags between </B> and <P> tags(</B><BR><BR><BR><BR><BR> <P>)`

. 我怎样才能使用 javascript 正则表达式来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:19:23.447

如果正好有 5 个：

```
var str = "<B>...";
str = str.replace(/(<BR>){5}/, ''); 
```

# java - Runnable 中的同步方法

> ID：11513277
> 
> 赞同：0
> 
> 时间：2012-07-16T22:06:20.807
> 
> 标签：java, concurrency, synchronized, runnable

我正在编写一个 Runnable 类，它将消息打包在一起一段时间或直到达到给定的大小，然后再通过网络发送它们。它旨在允许其他线程在通过某些设置方法运行时更改某些内部参数（例如数据包大小）。使用内部对象锁使部分`run()`逻辑与设置器互斥是否正确？

像这样的东西：

```
public class Packer implements Runnable {
    private BlockingQueue<byte[]> msgQueue;
    private Object lock = new Object();
    private Packet packet;
    private boolean running = false;

    public synchronized void append(byte[] payload) throws InterruptedException {
        msgQueue.put(payload);
    }

    public synchronized void setPacketCapacity(int size) {
        synchronized (lock) {
            // check to see if we need to flush the current packet first, etc.
            packet.setCapacity(size);
        }
    }
    public void run() {
        running = true;
        while (running) {
            try {
                byte[] msg = msgQueue.take();
                synchronized (lock) {
                    packet.add(msg);
                    // check if we need to flush the packet, etc.
                }
            } catch (InterruptedException ex) {
                logger.warn("interrupted");
                running = false;
            } catch (Exception e) {
                logger.error(e);
            }
        }
        logger.warn("stop");
    }
} 
```

相关地，另一个线程告诉这个runnable停止（和刷新）的正确方法是什么？

由于该`run()`方法可能正在等待内部队列`msgQueue`，因此简单地设置可能还不够`running=false`，我可能不得不中断线程。或者，我可以向内部队列发送一个特殊的“流结束”消息，但如果队列已满，我可能需要等待一段时间才能被接受。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-29T08:31:57.213

1.  由于您使用一个锁定对象锁定您的`setter`和内部的逻辑`run()`，因此它是正确的。我建议您`synchronized`从 setter 方法签名中删除，因为您已经使用锁定对象锁定了其中的所有代码
2.  您可以像这样删除`boolean running`并写下您的`run()`：

    ```
    public void run() {
      while (true) {
        try {
            byte[] msg = msgQueue.take();
            synchronized (lock) {
                packet.add(msg);
                // check if we need to flush the packet, etc.
            }
        } catch (InterruptedException ex) {
            logger.warn("interrupted");
            Thread.currentThread.interrupt();
            return;
        } catch (Exception e) {
            logger.error(e);
        }
      }
      logger.warn("stop");
    } 
    ```

调用`thread.interrupt()`将强制`run()`方法中的代码转到设置中断标志的 InterruptedException 捕获块并从中返回`run()`

# jquery - jQuery：操作多个 div 的独特功能（单击标题显示说明）

> ID：11513279
> 
> 赞同：0
> 
> 时间：2012-07-16T22:06:22.223
> 
> 标签：jquery, function

我有一个包含许多显示产品（标题和描述）的 div 的页面，但描述是隐藏的，当单击标题时，描述具有 slideToggle 效果

**DIVS HTML**

```
<first><h4>Product1</h4></first>
<span><div><ocultar>Description</ocultar></div></span>

<second><h4>Product2</h4></second>
<span><div><ocultar2>Description</ocultar></div></span>

....
...
...
And third, fourth, etc... 
```

我想要一个以独特功能优化此功能的功能..

```
$("ocultar").slideToggle("slow");
$("first").click(function () {
    $("ocultar").slideToggle("slow");
});
$("ocultar2").slideToggle("slow");
$("second").click(function () {
    $("ocultar2").slideToggle("slow");
});
...
...
... 
```

我希望能帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:10:35.877

您可以做的是向您的元素添加一个类属性，这将更容易使用 jQuery 进行操作。

```
<div class="title"><h4>Product1</h4></div>
<div class="description"><ocultar>Description</ocultar></div>

<div class="title"><h4>Product1</h4></div>
<div class="description"><ocultar>Description</ocultar></div> 
```

这个 jQuery 现在会将自身附加到具有 class 属性的元素上的每个单击事件，`title`并显示具有 class 属性的最接近的 div `description`。

```
// jQuery 1.7+

$(".title").on('click',function(){
  $(this).next('div.description').slideToggle("slow");
}); 
```

## [演示](http://jsfiddle.net/QC7My/5/)

# java - 矩阵计算太慢了

> ID：11513280
> 
> 赞同：2
> 
> 时间：2012-07-16T22:06:27.320
> 
> 标签：java, jscience

我正在开发名为[Lights Out](https://en.wikipedia.org/wiki/Lights_Out)的游戏。所以为了解决这个问题，我必须在模块 2 中计算**AX = B**的答案。因此，我选择[`jscience`](http://jscience.org/api/org/jscience/)库。在这个游戏中，A 的大小是 25x25 矩阵，X 和 B 都是 25x1 矩阵。我写了如下代码：

`AllLightOut.java`班级 ：

```
public class AllLightOut {
    public static final int SIZE = 5;

    public static double[] Action(int i, int j) {
        double[] change = new double[SIZE * SIZE];
        int count = 0;

        for (double[] d : Switch(new double[SIZE][SIZE], i, j))
            for (double e : d)
                change[count++] = e;

        return change;
    }

    public static double[][] MatrixA() {
        double[][] mat = new double[SIZE * SIZE][SIZE * SIZE];

        for (int i = 0; i < SIZE; i++)
            for (int j = 0; j < SIZE; j++)
                mat[i * SIZE + j] = Action(i, j);

        return mat;
    }

    public static SparseVector<ModuloInteger> ArrayToDenseVectorModule2(
            double[] array) {
        List<ModuloInteger> list = new ArrayList<ModuloInteger>();

        for (int i = 0; i < array.length; i++) {
            if (array[i] == 0)
                list.add(ModuloInteger.ZERO);
            else
                list.add(ModuloInteger.ONE);
        }

        return SparseVector.valueOf(DenseVector.valueOf(list),
                ModuloInteger.ZERO);
    }

    public static SparseMatrix<ModuloInteger> MatrixAModule2() {
        double[][] mat = MatrixA();
        List<DenseVector<ModuloInteger>> list = new ArrayList<DenseVector<ModuloInteger>>();

        for (int i = 0; i < mat.length; i++) {
            List<ModuloInteger> l = new ArrayList<ModuloInteger>();
            for (int j = 0; j < mat[i].length; j++) {
                if (mat[i][j] == 0)
                    l.add(ModuloInteger.ZERO);
                else
                    l.add(ModuloInteger.ONE);
            }

            list.add(DenseVector.valueOf(l));
        }

        return SparseMatrix.valueOf(DenseMatrix.valueOf(list),
                ModuloInteger.ZERO);
    }

    public static double[][] Switch(double[][] action, int i, int j) {
        action[i][j] = action[i][j] == 1 ? 0 : 1;

        if (i > 0)
            action[i - 1][j] = action[i - 1][j] == 1 ? 0 : 1;

        if (i < action.length - 1)
            action[i + 1][j] = action[i + 1][j] == 1 ? 0 : 1;

        if (j > 0)
            action[i][j - 1] = action[i][j - 1] == 1 ? 0 : 1;

        if (j < action.length - 1)
            action[i][j + 1] = action[i][j + 1] == 1 ? 0 : 1;

        return action;
    }
} 
```

主要课程如下：

```
public class Main {
    public static void main(String[] args) {
        double[] bVec = new double[] { 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
                1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0 };

        SparseMatrix<ModuloInteger> matA = AllLightOut.MatrixAModule2();
        SparseVector<ModuloInteger> matB = AllLightOut
                .ArrayToDenseVectorModule2(bVec);

        ModuloInteger.setModulus(LargeInteger.valueOf(2));
    Vector<ModuloInteger> matX = matA.solve(matB);

        System.out.println(matX);
    }
} 
```

我运行了这个程序大约 30 分钟，但没有结果。我的代码是否包含致命错误或错误？为什么需要太长时间？

感谢您的关注 ：）

**编辑** 这一行发生的减速`Matrix<ModuloInteger> matX = matA.inverse();`。请注意，`JScience` [基准测试结果](http://jscience.org/doc/benchmark.html)，这个库的速度非常快，但我不知道为什么我的程序运行速度太慢！

**EDIT2** 请注意，当我尝试时`SIZE = 3`，我得到了真正的答案。例如： MatA ：

> ```
> {{1, 1, 0, 1, 0, 0, 0, 0, 0},
> {1, 1, 1, 0, 1, 0, 0, 0, 0},
> {0, 1, 1, 0, 0, 1, 0, 0, 0},
> {1, 0, 0, 1, 1, 0, 1, 0, 0},
> {0, 1, 0, 1, 1, 1, 0, 1, 0},
> {0, 0, 1, 0, 1, 1, 0, 0, 1},
> {0, 0, 0, 1, 0, 0, 1, 1, 0},
> {0, 0, 0, 0, 1, 0, 1, 1, 1},
> {0, 0, 0, 0, 0, 1, 0, 1, 1}} 
> ```

垫子：

> {1, 1, 1, 1, 1, 1, 1, 0, 0}

垫：

> {0, 0, 1, 1, 0, 0, 0, 0, 0}

但是当我尝试时`SIZE = 5`，速度变慢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-21T23:25:12.737

> 这条线发生的放缓`Matrix<ModuloInteger> matX = matA.inverse();`

那将是因为系数矩阵对于（或 4、9、11、14、16，...？）`matA`是不可逆的。`SIZE == 5`

我有点惊讶图书馆没有检测到这一点并抛出异常。如果库试图反转 中的矩阵`solve()`，那将产生相同的后果。

某些尺寸的系数矩阵的奇异性的结果是，并非这些尺寸的所有谜题都是可解的，而其他谜题有多个解。

由于我们正在计算模 2，我们可以使用 bits 或`boolean`s 来模拟我们的状态/切换，`XOR`用于加法和`&`乘法。我已经使用高斯消元法制作了一个简单的求解器，也许它可以帮助你（我没有花太多时间考虑设计，所以它并不漂亮）：

```
public class Lights{
    private static final int SIZE = 5;

    private static boolean[] toggle(int i, int j) {
        boolean[] action = new boolean[SIZE*SIZE];
        int idx = i*SIZE+j;
        action[idx] = true;
        if (j > 0)      action[idx-1] = true;
        if (j < SIZE-1) action[idx+1] = true;
        if (i > 0)      action[idx-SIZE] = true;
        if (i < SIZE-1) action[idx+SIZE] = true;
        return action;
    }
    private static boolean[][] matrixA() {
        boolean[][] mat = new boolean[SIZE*SIZE][];
        for(int i = 0; i < SIZE; ++i) {
            for(int j = 0; j < SIZE; ++j) {
                mat[i*SIZE+j] = toggle(i,j);
            }
        }
        return mat;
    }
    private static void rotateR(boolean[] a, int r) {
        r %= a.length;
        if (r < 0) r += a.length;
        if (r == 0) return;
        boolean[] tmp = new boolean[r];
        for(int i = 0; i < r; ++i) {
            tmp[i] = a[i];
        }
        for(int i = 0; i < a.length - r; ++i) {
            a[i] = a[i+r];
        }
        for(int i = 0; i < r; ++i) {
            a[i + a.length - r] = tmp[i];
        }
    }
    private static void rotateR(boolean[][] a, int r) {
        r %= a.length;
        if (r < 0) r += a.length;
        if (r == 0) return;
        boolean[][] tmp = new boolean[r][];
        for(int i = 0; i < r; ++i) {
            tmp[i] = a[i];
        }
        for(int i = 0; i < a.length - r; ++i) {
            a[i] = a[i+r];
        }
        for(int i = 0; i < r; ++i) {
            a[i + a.length - r] = tmp[i];
        }
    }
    private static int count(boolean[] a) {
        int c = 0;
        for(int i = 0; i < a.length; ++i) {
            if (a[i]) ++c;
        }
        return c;
    }
    private static void swapBits(boolean[] a, int i, int j) {
        boolean tmp = a[i];
        a[i] = a[j];
        a[j] = tmp;
    }
    private static void addBit(boolean[] a, int i, int j) {
        a[j] ^= a[i];
    }
    private static void swapRows(boolean[][] a, int i, int j) {
        boolean[] tmp = a[i];
        a[i] = a[j];
        a[j] = tmp;
    }
    private static void xorb(boolean[] a, boolean[] b) {
        for(int i = 0; i < a.length; ++i) {
            a[i] ^= b[i];
        }
    }
    private static boolean[] boolBits(int bits, long param) {
        boolean[] bitArr = new boolean[bits];
        for(int i = 0; i < bits; ++i) {
            if (((param >> i) & 1L) != 0) {
                bitArr[i] = true;
            }
        }
        return bitArr;
    }
    private static boolean[] solve(boolean[][] m, boolean[] b) {
        // Move first SIZE rows to bottom, so that on the diagonal
        // above the lowest SIZE rows, there are unit matrices
        rotateR(m, SIZE);
        // modify right hand side accordingly
        rotateR(b,SIZE);
        // clean first SIZE*(SIZE-1) columns
        for(int i = 0; i < SIZE*(SIZE-1); ++i) {
            for(int k = 0; k < SIZE*SIZE; ++k) {
                if (k == i) continue;
                if (m[k][i]) {
                    xorb(m[k], m[i]);
                    b[k] ^= b[i];
                }
            }
        }
        // Now we have a block matrix
        /*
         * E 0 0 ... 0 X
         * 0 E 0 ... 0 X
         * 0 0 E ... 0 X
         * ...
         * 0 0 ... E 0 X
         * 0 0 ... 0 E X
         * 0 0 ... 0 0 Y
         *
         */
        // Bring Y to row-echelon form
        int i = SIZE*(SIZE-1), j, k, mi = i;
        while(mi < SIZE*SIZE){
            // Try to find a row with mi-th bit set
            for(j = i; j < SIZE*SIZE; ++j) {
                if (m[j][mi]) break;
            }
            if (j < SIZE*SIZE) {
                // Found one
                if (j > i) {
                    swapRows(m,i,j);
                    swapBits(b,i,j);
                }
                for(k = 0; k < SIZE*SIZE; ++k) {
                    if (k == i) continue;
                    if (m[k][mi]) {
                        xorb(m[k], m[i]);
                        b[k] ^= b[i];
                    }
                }
                // cleaned up column, good row, next
                ++i;
            }
            // Look at next column
            ++mi;
        }
        printMat(m,b);
        boolean[] best = b;
        if (i < SIZE*SIZE) {
            // We have zero-rows in the matrix,
            // check whether the puzzle is solvable at all,
            // i.e. all corresponding bits in the rhs are 0
            for(j = i; j < SIZE*SIZE; ++j) {
                if (b[j]) {
                    System.out.println("Puzzle not solvable, some lights must remain lit.");
                    break;
//                     throw new IllegalArgumentException("Puzzle is not solvable!");
                }
            }
            // Pretending it were solvable if not
            if (j < SIZE*SIZE) {
                System.out.println("Pretending the puzzle were solvable...");
                for(; j < SIZE*SIZE; ++j) {
                    b[j] = false;
                }
            }
            // Okay, puzzle is solvable, but there are several solutions
            // Let's try to find the one with the least toggles.

            // We have the canonical solution with last bits all zero
            int toggles = count(b);
            System.out.println(toggles + " toggles in canonical solution");
            int freeBits = SIZE*SIZE - i;
            long max = 1L << freeBits;
            System.out.println(freeBits + " free bits");
            // Check all combinations of free bits whether they produce
            // something better
            for(long param = 1; param < max; ++param) {
                boolean[] base = boolBits(freeBits,param);
                boolean[] c = new boolean[SIZE*SIZE];
                for(k = 0; k < freeBits; ++k) {
                    c[i+k] = base[k];
                }
                for(k = 0; k < i; ++k) {
                    for(j = 0; j < freeBits; ++j) {
                        c[k] ^= base[j] && m[k][j+i];
                    }
                }
                xorb(c,b);
                int t = count(c);
                if (t < toggles) {
                    System.out.printf("Found new best for param %x, %d toggles\n",param,t);
                    printMat(m,c,b);
                    toggles = t;
                    best = c;
                } else {
                    System.out.printf("%d toggles for parameter %x\n", t, param);
                }
            }
        }
        return best;
    }
    private static boolean[] parseLights(int[] lights) {
        int lim = lights.length;
        if (SIZE*SIZE < lim) lim = SIZE*SIZE;
        boolean[] b = new boolean[SIZE*SIZE];
        for(int i = 0; i < lim; ++i) {
            b[i] = (lights[i] != 0);
        }
        return b;
    }
    private static void printToggles(boolean[] s) {
        for(int i = 0; i < s.length; ++i) {
            if (s[i]) {
                System.out.print("(" + (i/SIZE + 1) + ", " + (i%SIZE + 1) + "); ");
            }
        }
        System.out.println();
    }
    private static void printMat(boolean[][] a, boolean[] rhs) {
        for(int i = 0; i < SIZE*SIZE; ++i) {
            for(int j = 0; j < SIZE*SIZE; ++j) {
                System.out.print((a[i][j] ? "1 " : "0 "));
            }
            System.out.println("| " + (rhs[i] ? "1" : "0"));
        }
    }
    private static void printMat(boolean[][] a, boolean[] sol, boolean[] rhs) {
        for(int i = 0; i < SIZE*SIZE; ++i) {
            for(int j = 0; j < SIZE*SIZE; ++j) {
                System.out.print((a[i][j] ? "1 " : "0 "));
            }
            System.out.println("| " + (sol[i] ? "1" : "0") + " | " + (rhs[i] ? "1" : "0"));
        }
    }
    private static void printGrid(boolean[] g) {
        for(int i = 0; i < SIZE; ++i) {
            for(int j = 0; j < SIZE; ++j) {
                System.out.print(g[i*SIZE+j] ? "1" : "0");
            }
            System.out.println();
        }
    }
    public static void main(String[] args) {
        int[] initialLights = new int[] { 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
                1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0 };
        boolean[] b = parseLights(initialLights);
        boolean[] b2 = b.clone();
        boolean[][] coefficients = matrixA();
        boolean[] toggles = solve(coefficients, b);
        printGrid(b2);
        System.out.println("--------");
        boolean[][] check = matrixA();
        boolean[] verify = new boolean[SIZE*SIZE];
        for(int i = 0; i < SIZE*SIZE; ++i) {
            if (toggles[i]) {
                xorb(verify, check[i]);
            }
        }
        printGrid(verify);
        xorb(b2,verify);
        if (count(b2) > 0) {
            System.out.println("Aww, shuck, screwed up!");
            printGrid(b2);
        }
        printToggles(toggles);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T23:41:36.923

如果可以避免，您几乎永远不想计算矩阵的实际逆。这样的操作是有问题的并且非常耗时。查看 JScience 的文档，您是否考虑过使用解决方法？类似于 matX = matA.solve(matB) 的东西应该会给你你正在寻找的东西，我怀疑他们是否使用逆来计算它，尽管我还没有深入研究 JScience，所以这不是不可能的。

# ios - 如何使用 Xcode 调试器打印出属性的内容？

> ID：11513283
> 
> 赞同：16
> 
> 时间：2012-07-16T22:06:42.597
> 
> 标签：ios, xcode, gdb, lldb

我正在编写一个 iOS 应用程序，我需要使用内置 Xcode 调试器的帮助。假设我有一个名为的对象`HomeViewController`，它具有三个属性

```
@property (nonatomic) BOOL finished;
@property (nonatomic, strong) NSArray *myArray;
@property (nonatomic, strong) NSString *myName;

@synthesize finished = _finished, myArray = _myArray, myName = _myName; 
```

假设我在这个类中有一个断点。我将如何查看这些属性的内容？我已经尝试过诸如 之类的东西，`po myName`但我不知道如何做到这一点。我尝试过使用 LLDB，但我一直收到这个人遇到的相同错误（[lldb 无法打印变量值并出现“错误：对 'id' 的引用不明确”](https://stackoverflow.com/questions/9515630/lldb-fails-to-print-variable-values-with-error-reference-to-id-is-ambiguous)）。这个问题的公认答案是，LLDB 坏了，我应该只使用 GDB；但是，我拒绝接受如此基本的东西被破坏了。 `print myName``print [self myName]`

尽管如此，我也尝试过使用具有上述类似命令的 GDB；但是，我也无法让 GDB 工作。请帮忙

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-16T23:06:31.310

放置断点后，运行，程序在断点处停止，将光标悬停在要查看的变量/值上，如下所示：

![在此处输入图像描述](../Images/7f5c1ba39629f0c0ecad8421882629f7.png)

您还可以放置一个`NSLog(@"%@", yourLabel.text);`来查看该标签/其他对象类型的内容。

另一种选择是在控制台中运行 GDB，如下所示：

```
gdb
attach <your process name> 
```

然后使用`po`(print-object) 命令查看变量的值，如下所示：

```
po variableName 
```

要查看原始类型（`int`、`float`、`long`、`double`、`char`等）的值，您可以`print`在控制台中运行 GDB 时使用该命令，如下所示：

```
print yourPrimitiveVariable 
```

希望这可以帮助！

编辑：

使用该命令，您可以使用属性名称 ( ) 或 ivar 名称 (可能)`po`打印出对象的值。我在这里演示：`self.myProperty``_myProperty`

![在此处输入图像描述](../Images/7d15166700b4ab87cfeb70114d6250fe.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-11T12:19:45.133

尝试在调试区域中使用以下表达式来打印对象，

```
p self.view.bounds.size.width 
```

或使用，

```
po self.view 
```

p - Print 仅用于打印普通/简单值，而 po - Print Object 与 NSLog 相同以打印对象的值

# java - 在列表中循环遇到问题 >

> ID：11513285
> 
> 赞同：2
> 
> 时间：2012-07-16T22:06:52.187
> 
> 标签：java

这是我宣布我的清单的方式。当它应该在我的一个列表中返回一对（这是一个字符串，int 对）时，it.next() 似乎正在返回我的集合。有任何想法吗？方法 getFirst() 对于 Object 类型是未定义的。似乎如果我这样做，它会解决这个问题。

字符串 m=((对) it.next()).getFirst();

```
List <HashSet<Pair>>  addresses = new ArrayList <HashSet<Pair>> ();

for (int i = 0; i < 100; i++) {
    Iterator it = (addresses.get(i)).iterator();
    while (it.hasNext()){
        String m = it.next().getFirst()); //getFirst returns a string
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T22:14:13.107

试试这个，它编译得很好：

```
List<Set<Pair>> addresses = new ArrayList<Set<Pair>>();
// fill the list of addresses

for (int i = 0; i < 100; i++) {
    Iterator<Pair> it = addresses.get(i).iterator();
    while (it.hasNext()) {
        String m = it.next().getFirst();
    }
} 
```

当然，你必须用成对的集合来填充地址列表，这样才能做一些有用的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:23:10.603

确保删除 while 循环内行尾的额外括号。它应该看起来像这样

`String m = it.next().getFirst();`

# iphone - 在 Xcode 中编译 sqlite 项目时出错

> ID：11513286
> 
> 赞同：0
> 
> 时间：2012-07-16T22:06:57.093
> 
> 标签：iphone, ios, xcode, sqlite, compilation

我正在处理以下试图连接到数据库的代码，但我被困在这一点上：

```
#import "ToDos.h"
#import "AppDelegate.h"

static sqlite3 *database = nil;

@implementation ToDos
@synthesize todoID, title, descr, isDirty, isDetailViewHydrated;

- (void) dealloc    {

}

+ (void) getInitialDataToDisplay:(NSString *)dbPath {

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    if (sqlite3_open([dbPath UTF8String], database) == SQLITE_OK) {

//      const char *sql = "select * from todos";
//      sqlite3_stmt *selectstmt;
//      if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {
//          
//          while(sqlite3_step(selectstmt) == SQLITE_ROW) {
//              
//              NSInteger primaryKey = sqlite3_column_int(selectstmt, 0);
//              ToDos *coffeeObj = [[ToDos alloc] initWithPrimaryKey:primaryKey];
//              coffeeObj.title = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 1)];
//              
//              coffeeObj.isDirty = NO;
//              
//              [appDelegate.todosArray addObject:coffeeObj];
//              // [coffeeObj release];
//          }
//      }
    }
    else
        sqlite3_close(database); //Even though the open call failed, close the database connection to release all the memory.
}

- (id) initWithPrimaryKey:(NSInteger) pk {
    // [super init];
    todoID = pk;

    isDetailViewHydrated = NO;

    return self;
}

@end 
```

问题接缝在指针中......

```
static sqlite3 *database = nil; 
```

和

```
if (sqlite3_open([dbPath UTF8String], database) == SQLITE_OK) { 
```

但这是尝试启动应用程序时的错误消息

![在此处输入图像描述](../Images/4c3c4c20556aed3abb033226fd94ca11.png)

教程中的代码相同，它可以工作:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:38:53.217

1.  正如[La bla bla 所说](https://stackoverflow.com/questions/11513286/trying-to-compile-getting-error-xcode#comment15214748_11513286)，您似乎还没有将 sqlite3 库添加到您的项目中。在左侧 Xcode 的项目文件导航树中，单击目标（​​树的顶部）。查看目标设置时，单击“Build Phases”，转到“Link Binary With Libraries”，单击“+”按钮，然后添加`libsqlite3.0.dylib`到您的项目中。

2.  你需要`sqlite3_open([dbPath UTF8String], &database);`. 你正在更新你的`database`指针，所以不要忘记那个＆符号。

3.  此外，在失败时，调用没有意义`sqlite3_close`，因为`database`可能仍然是 NULL，如果您`sqlite3_close`使用 NULL 数据库指针调用，可能会导致问题（崩溃？），因为无法打开数据库。

4.  在您注释的代码中，您正在执行`sqlite3_prepare`and `sqlite3_step`，但您没有执行 final `sqlite3_finalize`。批评注释代码是不公平的，但我只是想确保你在时机成熟时不要忘记这一点。:)

5.  顺便说一句，`sqlite3_open`如果数据库不存在，将为您创建数据库。如果您不想这样做（即，如果您只希望在成功找到先前创建的数据库的情况下成功），请`sqlite3_open_v2([dbPath UTF8String], &database, SQLITE_OPEN_READWRITE, NULL);`改用。许多初次使用数据库的用户忘记将其包含在目标的“复制捆绑资源”列表中，并且在`sqlite3_open`提示他们已成功打开数据库时感到困惑，而实际上它可能刚刚创建了一个新数据库而没有找不到你想要的那个。但是，如果要打开数据库来创建数据库，请忽略我刚才所说的。但如果没有，请考虑`sqlite3_open_v2`。

6.  最后，一旦你成功地打开了你的数据库，我鼓励你总是检查你的`sqlite3_errmsg`命令，如果你的任何后续命令失败了。很多时候，一些随机的 sqlite3 命令不起作用，程序员只能摸不着头脑，但他们忘记检查`sqlite3_errmsg`. 我知道这不是这里的问题，而只是对新的 sqlite3 程序员的最后建议。

# jquery - 访问 iframe 中的 URL 更改

> ID：11513289
> 
> 赞同：0
> 
> 时间：2012-07-16T22:07:05.717
> 
> 标签：jquery, url, dom, iframe, parent

我有一些现有的 JavaScript 代码，我无法更改，它们已加载到 iframe 中。iframe 中的初始页面是本地页面，但`<input type="button"...>`来自 JavaScript 的链接（实际上是 's）转到外部内容。当单击 iframe 中的按钮转到外部 URL 时，我正在寻找一种方法来更改 iframe 所在的主页。

我可以以某种方式访问​​ iframe 中的本地页面 css 类吗？如果做不到这一点，可以使用 .unload() 代替 .click 吗？我只设法使用 .unload 来捕获父框架中的页面更改。

```
<iframe name="venueFrame" id="venueFrame" frameBorder="0" src=""><p>Your browser does not support iframes.</p></iframe>
<script>
    function selectVenue(page){
        compleateURL='venuemaps/'+page;
        document.getElementById('venueShadow').style.display="block";
        $("#venueFrame").attr({src:compleateURL});
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:28:13.047

没有看到任何代码很难知道，但是您可以通过执行绑定到 iframe 上的单击

```
$('#iframe').bind('click', function(e) {
    //Stuff to do
}); 
```

每当点击 iframe 内的任何内容时，都会发生这种情况。如果您尝试根据链接更改特定内容，那么您将很难做到这一点。

# mysql - 在插入触发器MySQL之前选择整个[NEW]行

> ID：11513291
> 
> 赞同：1
> 
> 时间：2012-07-16T22:07:11.947
> 
> 标签：mysql, triggers

我有一个包含这个的触发器：

```
SET v1 = CONCAT_WS(',',NEW.ID, NEW.Name, NEW.Type, NEW.Value); 
```

可以将其简化为类似这样以包含整个新行吗？：

```
SET v1 = CONCAT_WS(',',NEW.*); 
```

（我已经尝试了上述的变体，但是它们会导致语法错误）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:19:00.277

不，没有简单的方法可以做到这一点。您必须引用每一列。

唯一真正的解决方法是使用表元数据来帮助您生成所需的语句，然后将该语句包含在您的过程中。

即使可能，您也不希望在 TRIGGER 中动态执行此操作。

```
SELECT CONCAT('NEW.`',GROUP_CONCAT(c.column_name 
       ORDER BY ORDINAL_POSITION SEPARATOR '`,NEW.`'),'`')
  FROM information_schema.columns 
 WHERE table_schema = DATABASE() 
   AND table_name = 'mytable' 
```

这应该会给你一个看起来像这样的字符串：

```
NEW.`ID`,NEW.`Name`,NEW.`Type`,NEW.`Value` 
```

您可以将其粘贴到触发器主体中。（当然你可以扩展 CONCAT 来生成整行。）

缺点是当新列添加到表中时，不会自动包含这些列；这将需要更改触发器。如果一列被删除或重命名，您的触发器将开始抛出异常；再次需要修复触发器。

* * *

**更新**

**问：**如何将此字符串转换为 MySQL 查询？

```
@query = "CONCAT_WS(',','CCC','64',NEW.Record,NEW.ID,NEW.Name,NEW.User_ID,NEW.State_Record,NEW.Hash);" 
```

我不会将其转换为查询。我只是将它用作触发器主体中的静态代码行（没有双引号），就像您在触发器中的原始语句一样。

```
SET v1 = CONCAT_WS(',','CCC','64',NEW.Record,NEW.ID,NEW.Name,NEW.User_ID,NEW.State_Record,NEW.Hash); 
```

（不清楚你打算用那个字符串做什么。）

如果您尝试创建一个 SELECT 语句，您可以尝试从字符串末尾删除该分号，并在其前面添加一个 SELECT 关键字。但我不认为是新的。在该上下文中将识别对当前行的列值的引用。这可能会发生，但您需要进行测试。

如果我需要做类似的事情，我会使用用户变量来做，

```
SET @new_id = NEW.ID;
SET @new_name = NEW.Name;

SELECT @new_id, @new_name 
```

我完全不清楚您将如何处理查询返回的结果集，例如。如果您尝试审核对表的更改，规范模式是将列值插入到更改日志表中，

```
INSERT INTO mytable_changelog (ID, Name) VALUES (NEW.ID, NEW.Name); 
```

这实际上取决于您要完成的工作。

# c# - ORA-12154 仅在运行集成测试时

> ID：11513292
> 
> 赞同：0
> 
> 时间：2012-07-16T22:07:38.713
> 
> 标签：c#, c#-4.0

我有一个集成测试套件（这是一个类库），其中一个测试连接到我的数据库并插入记录。但是，在执行此操作时，我收到以下错误：

> ORA-12154: TNS: 无法解析指定的连接标识符

我的 TNSNAMES 等工作正常。我这么说是因为我有一个控制台应用程序，它调用同一行代码并且它工作正常。它能够检索并保存到数据库。这两个项目都在同一个解决方案中。据我所见，没有涉及括号问题，我检查了项目路径等，没有什么值得注意的。

我正在使用 Resharper 调试器触发测试。我有一台安装了 32 位 oracle 客户端的 64 位机器。

为了了解发生这种情况的原因，我将类库（具有我的集成测试）转换为控制台应用程序，放入一个 main 方法并从 main 运行相同的代码，它就可以工作了。

我在 x86 配置上运行应用程序/类库。

关于为什么会发生这种情况的任何指示？

谢谢，-迈克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:18:34.127

这是使用 Oracle 时最常见的错误，如果您使用的是 TNSNAMES.ORA 文件，请确保 TNSNAMES 被列为 Oracle Net 配置文件 (SQLNET.ORA) 中 NAMES.DIRECTORY_PATH 参数的值之一

希望这会有所帮助，请参阅链接以获取更多帮助[http://ora-12154.ora-code.com/](http://ora-12154.ora-code.com/)

# c# - 如何使用 c# 和 Visual Studio 2010 将输出添加到 Windows 窗体应用程序？

> ID：11513293
> 
> 赞同：0
> 
> 时间：2012-07-16T22:07:43.413
> 
> 标签：c#, visual-studio-2010, c#-4.0

[http://www.question-defense.com/wp-content/uploads/2009/02/intel-945gm-driver.gif](http://www.question-defense.com/wp-content/uploads/2009/02/intel-945gm-driver.gif)

如何创建一个显示我希望用户看到的输出的应用程序？（如上图）我尝试使用列表框，但动态更新它时遇到问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:12:31.147

使用 RichTextBox，并在需要向其输出文本时调用 RichTextBox.AppendText()。

[http://msdn.microsoft.com/en-en/library/3tdc88y7.aspx](http://msdn.microsoft.com/en-en/library/3tdc88y7.aspx)

[http://msdn.microsoft.com/en-en/library/system.windows.forms.richtextbox(v=vs.80).aspx](http://msdn.microsoft.com/en-en/library/system.windows.forms.richtextbox(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:14:59.447

您可以在 TextBox 控件中显示输出，为此您需要设置文本框的属性 Multiline = true

# ios - 处理 UILocalNotifications 的设计模式（如何知道用户在分支应用程序中的位置）

> ID：11513295
> 
> 赞同：0
> 
> 时间：2012-07-16T22:08:02.327
> 
> 标签：ios, push-notification, uilocalnotification

我有一个使用 UILocalNotifications 的应用程序（尽管这个问题也与 PushNotifications 相关）。当用户收到本地通知时，根据应用程序的状态和他们在通知警报中所做的选择，我想呈现一个特定的 viewController。问题是它们当前可能通过 segue 或模态 ViewController 处于“推送”视图控制器中，并且我目前没有跟踪用户在可能的分支中的位置。

我想知道是否有任何类型的设计模式或标准方式来处理这样的混合演示模式应用程序？特别是如果有任何内置方法可以确定哪个是活动的 ViewController，而无需我设置面包屑系统。这很重要，例如，如果用户已经在查看要作为 localNotification 调用的视图控制器。

我意识到我的需要/解释有点混乱。如果有人需要更多信息，我将对其进行编辑和更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:04:18.073

好的 - 我想我通过 Apple docs [View Controller Programming Guide for iOS: Presenting View Controllers from Other View Controllers找到了解决方案](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ModalViewControllers/ModalViewControllers.html#//apple_ref/doc/uid/TP40007457-CH111-SW1)

> 呈现的视图控制器链中的每个视图控制器都有指向链中围绕它的其他对象的指针。换句话说，呈现另一个视图控制器的呈现视图控制器在它的presentingViewController 和presentingViewController 属性中都有有效的对象。您可以根据需要使用这些关系来跟踪视图控制器链。例如，如果用户取消当前操作，您可以通过关闭第一个呈现的视图控制器来移除链中的所有对象。换句话说，关闭视图控制器不仅会关闭该视图控制器，还会关闭它呈现的任何视图控制器。

所以我可以通过关闭链中的第一个模态视图控制器来取消任何模态视图控制器链。

我可以使用以下方法确定当前是否存在模式视图控制器：

```
 self.window.rootViewController.presentedViewController 
```

如果该属性为 null，则当前不存在模式 viewController。并且为了完整性（hackishness ..）我可以测试presentedViewController有一个presentViewController等：

```
self.window.rootViewController.presentedViewController.presentedViewController 
```

# jquery - 带有div的jquery appendTo（），奇怪的行为

> ID：11513297
> 
> 赞同：0
> 
> 时间：2012-07-16T22:08:06.570
> 
> 标签：jquery, appendto

我正在使用 Jquery，制作包含多个 div 的表格单元格。div 包含一些数据和一个单选按钮。我的代码有效，但我想知道为什么我必须使用“中间人”变量。对我来说似乎真的很奇怪，非常令人沮丧，我很好奇为什么。也许我只是不明白这一点。这是我的代码

```
 // my radio button
    var rad_button = $('<input type="radio"...'
    // my object, div w some attributes, text
    var my_Object = $('<div class="selected...'
    rad_button.prependTo(my_Object);

    var middle_man = my_Object;
    middle_man.appendTo(bigger_object); 
```

这是我可以让它工作的唯一方法。我尝试了更直接的方法：

```
 my_object.appendTo(bigger_object); 
```

但这没有用。谁能告诉我为什么这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:02:52.243

您不能将您的附加调用链接到您正在创建的表格单元格上吗？

```
$('<td />')
  .append($('<input />', { 'type':'radio' }))
  .append($('<div />', { 'class':'selected' })); 
```

应该输出 HTML

```
<td>
  <input type="radio" />
  <div class="selected"></div>
</td> 
```

没有中间人。

# ios - 无法在 ios 中使用 facebook sdk 发布到朋友墙

> ID：11513299
> 
> 赞同：0
> 
> 时间：2012-07-16T22:08:11.677
> 
> 标签：ios, facebook

我已尝试使用 openGraph 和正常对话框，如下所示，

`[facebook requestWithGraphPath:[NSString stringWithFormat:@"/%@/feed",@"friends_fb_id" ] andParams:variables andHttpMethod:@"POST" andDelegate:self];`

和

`[facebook dialog:@"feed" andParams:params andDelegate:self]`

我给这两种方法的参数为

`NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys: @"friends_fb_id", @"to", @"I'm using the Hackbook for iOS app", @"name", @"Hackbook for iOS.", @"caption", @"Check out Hackbook for iOS to learn how you can make your iOS apps social using Facebook Platform.", @"description", @"http://m.facebook.com/apps/hackbookios/", @"link", @"http://www.facebookmobileweb.com/hackbook/img/facebook_icon_large.png", @"picture", nil];`

在委托方法中，它正确返回 Post_id，因此它成功完成，但我看不到朋友墙上的帖子。如果尝试使用 SDK 附带的 Hackbook 应用程序，它可以完美运行。

可能的解决方案是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T07:51:51.713

您是否在登录期间忘记启用`publish_actions`或权限？`publish_stream`

```
// login to FB
-(void) FBLogin
{
    NSArray *permissions = [[NSArray alloc] initWithObjects:@"publish_actions",@"publish_stream", nil];
    [FBSession openActiveSessionWithPermissions:permissions allowLoginUI:YES completionHandler:^(FBSession *_session, FBSessionState _status, NSError *_error) {
        //  do some login handling code here
    }];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:17:51.387

您正在使用字符串“friends_fb_id”，这不是实际的 id 吗？

我也遇到过类似的情况，正在收到正确的回复，所以它正在发布，它只是发布到错误的地方。确保 id 是正确的。

# maven - 如何在 Maven 中解压工件？

> ID：11513300
> 
> 赞同：2
> 
> 时间：2012-07-16T22:08:24.357
> 
> 标签：maven, tar

如何解压缩用于编译源代码的工件？

解压前是否需要复制 tar 文件？

我有类似下面的东西......

```
 <build>
      <plugins>
        <plugin>
          <artifactId>abcId</artifactId>
          <version>1</version>
          <executions>
            <execution>
              <id>abc untar</id>
              <phase>process-resources</phase>
              <goals>
                <goal>exec</goal>
              </goals>

            <configuration>
              <executable>tar</executable>
              <workingDirectory>???</workingDirectory>
              <arguments>
                <argument>xvf abc.tar</argument>
              </arguments>
            </configuration>
            </execution>
          </executions>
        </plugin>
      </plugins>
    </build> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T08:04:32.673

您可以`untar`使用`dependency:unpack`. `maven dependency plugin`这是[示例](http://maven.apache.org/plugins/maven-dependency-plugin/examples/unpacking-artifacts.html)的修改版本。

```
 <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-dependency-plugin</artifactId>
         <version>2.4</version>
         <executions>
           <execution>
             <id>unpack</id>
             <phase>process-resources</phase>
             <goals>
               <goal>unpack</goal>
             </goals>
             <configuration>
               <artifactItems>
                 <artifactItem>
                   <groupId>artifact-groupId</groupId>
                   <artifactId>the-artifact</artifactId>
                   <version>a.b</version>
                   <type>tar</type>
                   <outputDirectory>${project.build.directory}/artifactLocation</outputDirectory>
                 </artifactItem>
               </artifactItems>
             </configuration>
           </execution>
         </executions>
       </plugin> 
```

# c - 自动局部变量是否存储在C中的堆栈中？

> ID：11513305
> 
> 赞同：1
> 
> 时间：2012-07-16T22:09:15.000
> 
> 标签：c, memory, gcc, local-variables

好的，我知道 main() 自动局部变量存储在堆栈中，任何函数自动局部变量也存储在堆栈中，但是当我在 gcc 版本 4.6.3 上尝试以下代码时：

```
#include <stdio.h>

    int main(int argc, char *argv[]) {

        int var1;
        int var2;
        int var3;
        int var4;
        printf("%p\n%p\n%p\n%p\n",&var1,&var2,&var3,&var4);
        } 
```

结果是：

```
0xbfca41e0
0xbfca41e4
0xbfca41e8
0xbfca41ec 
```

根据堆栈顶部的结果 var4 和堆栈底部的 var1 以及现在指向 var1 地址下方的地址的堆栈指针....但是为什么 var4 在堆栈顶部而 var1 在底部。 ..它在 var1 之后声明，所以我从逻辑上认为 var1 应该在堆栈的顶部，并且在 var1 之后声明的任何变量都应该在内存中低于它......所以在我的例子中是这样的：

```
>>var1  at 0xbfca41ec
>>var2  at 0xbfca41e8
>>var3  at 0xbfca41e4
>>var4  at 0xbfca41e0
>>and stack pointer pointing here  
.. 
```

## ..

编辑1：

阅读@AusCBloke 的评论后，我尝试了以下代码：

```
#include <stdio.h>

 void fun(){
 int var1;
 int var2;
 printf("inside the function\n");
 printf("%p\n%p\n",&var1,&var2);

 }

 int main(int argc, char *argv[]) {

int var1;
int var2;
int var3;
int var4;

printf("inside the main\n");
printf("%p\n%p\n%p\n%p\n",&var1,&var2,&var3,&var4);
fun();
return 0;
} 
```

结果：

```
inside the main
0xbfe82d60
0xbfe82d64
0xbfe82d68
0xbfe82d6c
inside the function
0xbfe82d28
0xbfe82d2c 
```

所以 fun() 堆栈框架内的变量低于 main() 堆栈框架内的变量，根据堆栈的性质，这是正确的，..但在同一个堆栈框架内，不必从上到下排序。

谢谢@AusCBloke .....你的评论对我帮助很大

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T22:15:51.590

不需要按照声明它们的顺序分配这些变量。它们可以由编译器移动，甚至完全优化。如果您需要相对地址保持不变，请使用`struct`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:17:25.953

具有自动存储持续时间的对象通常存储在堆栈中，但语言标准不需要它。事实上，[标准](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)（链接是最新的预发布 C11 草案）甚至没有提到“堆栈”这个词。

不幸的是，“堆栈”这个词是模棱两可的。

在最抽象的意义上，堆栈是一种数据结构，其中最近添加的项目首先被删除（后进先出，或 LIFO）。`static`关于具有自动存储持续时间的对象（即，在没有关键字的函数中定义的对象）的生命周期的要求意味着*某种*类似于堆栈的分配。

“堆栈”一词也通常用于指代内存的连续区域，通常由指向最顶部元素的“堆栈指针”控制。堆栈通过将堆栈指针移离基址而增长，并通过将其移向基址而收缩。（它可以向任一方向增长，朝向更高或更低的内存地址。）大多数 C 编译器使用这种连续堆栈来实现自动对象——但并非所有编译器都这样做。IBM 大型机系统已经有 C 编译器，它们从类似堆的结构中为函数调用分配存储空间，并且嵌套调用的地址不需要统一按升序或降序排列。

这是一个不寻常的实现，并且有很好的理由表明这种方法不常用（连续堆栈更简单、更高效，并且通常由 CPU 支持）。但是 C 标准是精心编写的，以避免需要特定的方案，并且精心编写的可移植 C 代码无论编译器选择哪种方法都可以正常工作。**你不需要知道**。你真正需要知道的`var1`只是它的地址是`&var1`. 如果你写`if (&var1 < &var2) { ... }`，那么你可能做错了什么（那个表达式的行为是未定义的，顺便说一句）。

这是标准的 C 答案。我看到你的问题被标记为[gcc](/questions/tagged/gcc "显示标记为“gcc”的问题")。据我所知，所有版本的 gcc 都使用连续堆栈。但即便如此，利用这一点也很少有任何好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:33:47.677

在许多（大多数）现代平台上，堆栈从内存中的较高地址增长到较低地址。IE。当您启动程序时，堆栈指针会立即放入内存中的某个地址，该地址由程序中的最大堆栈大小决定。一旦东西被压入堆栈，堆栈指针实际上会*向下*移动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T22:11:58.370

我可能是错的，但堆栈从较低的内存地址开始，然后被添加到。所以 var4 在上面是正确的。毕竟是栈！

编辑：它背后的汇编代码在内存堆栈的底部有堆栈指针，每当添加数据时，堆栈指针都会递增，以便下一个变量落在顶部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T22:16:09.627

我有 99.9999% 的把握答案是**肯定的。**此外，堆栈在英特尔架构机器上向下增长，而不是向上增长。较低的区域成为堆栈的虚拟“顶部”（可以说是颠倒的）。

所以从技术上讲，变量在堆栈内存中的顺序是正确的**。**

**编辑：**不过，这可能仍然是特定于编译器的。

# verilog - 如何初始化一个整数数组？

> ID：11513312
> 
> 赞同：3
> 
> 时间：2012-07-16T22:09:33.157
> 
> 标签：verilog

我有：

```
integer test[7:0]; 
```

但我不能这样做：

```
test[0] = 0; 
```

或者

```
assign test[0] = 0; 
```

或者

```
intial
begin
test[0]=0;
end 
```

或者

```
integer test[7:0] = {0,0,0,0,0,0,0,0,0}; 
```

有任何想法吗？仅以0为例，我需要它是26、40、32、18、50、0、20、12

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:14:18.553

你确定吗`initial`不起作用（你可能有错字......）？

```
initial begin
  for(int i=0; i<8; i++) begin
    test[i] = i;
  end
  $display(test[4]);
end 
```

在 systemverilog 中，类似以下的内容将起作用。这些被称为“分配模式”：

```
integer test[7:0] = '{26, 40, 32, 18, 50, 0, 20, 12}; // note the ' 
```

我怀疑上述任何一个都是可综合的，除非可能是针对 FPGA 的。

# jquery - 在jQuery中获取图像的原始宽度和高度

> ID：11513313
> 
> 赞同：11
> 
> 时间：2012-07-16T22:09:39.727
> 
> 标签：jquery, image, preloading

我需要获取给定特定来源的图像的原始宽度和高度。我目前的方法是：

```
img.tag = "<img style='display:none;' src='" + img.src + "' />";
img.Owidth = 0;
img.Oheight = 0;

$(img.tag).load(function() {
    img.Owidth = $(this).width();
    img.Oheight = $(this).height();
}).appendTo(img.parent()); 
```

和是加载图像的原始尺寸`Owidth`。`Oheight`我想知道是否有更好的方法来做到这一点：

*   图像可能已经加载，但显示的大小与其原始大小不同。
*   图像尚未加载

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-16T22:25:20.900

## 跨浏览器：

***[jsFiddle 演示](http://jsfiddle.net/roXon/ayhLB/38/)***

```
$("<img/>").load(function(){
    var width  = this.width,
        height = this.height; 
    alert( 'W='+ width +' H='+ height);
}).attr("src", "image.jpg"); 
```

* * *

## HTMLImageElement 属性/符合 HTML5 的浏览器

如果您想调查所有 HTMLImageElement[属性](http://api.jquery.com/prop/)**：** https: [//developer.mozilla.org/en/docs/Web/API/HTMLImageElement](https://developer.mozilla.org/en/docs/Web/API/HTMLImageElement)
其中许多属性已经在现代、**兼容 HTML5 的浏览器**中可用，并且可以使用 jQuery 的方法访问[`.prop()`](http://api.jquery.com/prop/)

***[jsFiddle 演示](http://jsfiddle.net/roXon/ayhLB/39/)***

```
var $img = $("#myImage");

console.log(
    $img.prop("naturalWidth") +'\n'+  // Width  (Natural)
    $img.prop("naturalHeight") +'\n'+ // Height (Natural)
    $img.prop("width") +'\n'+         // Width  (Rendered)
    $img.prop("height") +'\n'+        // Height (Rendered)
    $img.prop("x") +'\n'+             // X offset
    $img.prop("y")                    // Y offset ... 
); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-10-01T00:14:47.303

对于 Chrome 和 Firefox（希望很快 IE），您可以使用...

```
var width = $('img').prop('naturalWidth');
var height = $('img').prop('naturalHeight'); 
```

# c# - wpf上下文菜单左键单击

> ID：11513315
> 
> 赞同：2
> 
> 时间：2012-07-16T22:10:03.203
> 
> 标签：c#, wpf, user-interface, contextmenu

是否可以将上下文菜单附加到 wpf 控件并在左键单击时打开它（而不是更习惯的右键单击）？我想仅使用 xaml 来实现这一点（这应该是我的控件视图模板的一部分）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-12-29T18:43:04.570

这是一种在左键单击时显示上下文菜单的方法：

`Border`在元素上创建一个新的左键处理程序：

```
<Border x:Name="Win"
        Width="40"
        Height="40"
        Background="Purple"
        MouseLeftButtonUp="UIElement_OnMouseLeftButtonUp"> 
```

然后添加：

```
private void UIElement_OnMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
    e.Handled = true;

    var mouseDownEvent =
        new MouseButtonEventArgs(Mouse.PrimaryDevice,
            Environment.TickCount,
            MouseButton.Right)
        {
            RoutedEvent = Mouse.MouseUpEvent,
            Source = Win,
        };

    InputManager.Current.ProcessInput(mouseDownEvent);
} 
```

它的作用是，它基本上将左键单击映射到右键单击。为了可重用性，您可以将其包装到附加的行为中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T21:45:46.450

以下是我将如何做一个简单的例子来说明我的建议：

XAML：

```
<Window x:Class="LeftClickMenu.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow">
    <Grid>
        <Border Width="400" Height="300" Background="#ccc" BorderBrush="#333" 
                BorderThickness="1"
                MouseLeftButtonDown="Border_MouseLeftButtonDown"
                MouseRightButtonUp="Border_MouseRightButtonUp">
            <Border.ContextMenu>
                <ContextMenu x:Name="myContextMenu">
                    <MenuItem Header="Menu Item 1" />
                    <MenuItem Header="Menu Item 2" />
                    <MenuItem Header="Menu Item 3" />
                    <MenuItem Header="Menu Item 4" />
                    <MenuItem Header="Menu Item 5" />
                </ContextMenu>
            </Border.ContextMenu>
        </Border>
    </Grid>
</Window> 
```

和代码隐藏：

```
using System.Windows;
using System.Windows.Input;

namespace LeftClickMenu
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void Border_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            myContextMenu.IsOpen = true;
        }

        private void Border_MouseRightButtonUp(object sender, MouseButtonEventArgs e)
        {
            e.Handled = true;
        }
    }
} 
```

我还添加了额外的**MouseRightButtonUp**事件来禁止右键单击上下文菜单弹出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:59:03.733

1.  如本文所述，创建一种以编程方式打开子菜单的方法： [在 WPF 中以编程方式显示菜单](https://stackoverflow.com/questions/1165562/show-menu-programmatically-in-wpf)

2.  为 LeftMouseButtonDown 创建一个事件并在 XAML 中调用该事件。

# iphone - 如何将 wifi 网络添加到 iOS 中的已知网络列表中？

> ID：11513318
> 
> 赞同：3
> 
> 时间：2012-07-16T22:10:11.033
> 
> 标签：iphone, ios

我正在开发一个应用程序，该应用程序需要将 wifi 网络（即 SSID 和密码）添加到手机的已知网络列表中，以便即使第一次看到它也会自动连接到该网络。

我已经在 Android 上做过这个，现在我将开始在 iPhone 版本上工作。

**问题**：在 iPhone 上，是否可以让我的应用程序（第一次运行时）将 wifi 网络添加到设备的已知设备列表中，如果可以，是否有关于如何操作的提示？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:23:49.043

不幸的是，这在 iOS 上是不可能的。

Apple 不提供任何公共 API 来添加网络 SSID 或密码。

您最多可以做的是让您的应用程序能够管理公共网络的用户身份验证（就像 Boingo 和 The Cloud 之类的事情一样）。在这种情况下，当用户加入网络时，您的应用程序可以启动并提供身份验证，而不是打开网页进行身份验证 - 但这是您所能做到的。

我们在开发论坛中要求 Apple 澄清这一点，并被告知这绝对不可能。（当我有更多时间时，我会尝试为您挖掘该帖子的链接。否则，在开发论坛上搜索您的查询，它可能会出现）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T12:55:09.870

所以似乎在 iOS 6 中，可能有办法做到这一点。Boingo 似乎允许用户打开“自动登录”，它将登录/验证接入点，而无需用户手动交互/验证（虽然我自己没有尝试过）。iOS 6 中是否有新的 API 调用现在允许这样做？[见这篇文章](http://www.boingo.com/pr/articles/?a=2013-01-29-boingo-releases-enhanced-wi-finder-app-for-ios-6&id=761&date=2013-01-29)。

# j - 如何在对矩阵上执行标量积？

> ID：11513319
> 
> 赞同：1
> 
> 时间：2012-07-16T22:10:12.843
> 
> 标签：j

我有一个`M`包含对的矩阵（即大小为 2 的数组）。给定一对`p`，如何获得`M'`包含 的标量积`p`和 的每个元素的结果的二维矩阵`M`？

```
 (0, 0) (0, 1)                             8 5
M = (1, 0) (1, 1)       p = (2, 2)       M' = 5 2
    (2, 0) (2, 1)                             4 1 
```

`M`并被`p`定义：

```
M =. 3 2 2 $ 0 0 0 1 1 0 1 1 2 0 2 1
p =. 2 2 
```

我在 J 有一个标量积的实现：

```
sp =. +/ @: *: @: - 
```

它适用于对：

```
 0 0 sp p
8
    0 1 sp p
5 
```

但不是在完整矩阵上，因为长度不好：

```
 p sp M
|length error: sp
|   p     sp M 
```

我应该如何处理？这对 J 天才来说可能很容易，但我只是一个可怜的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:09:32.930

利用

```
p sp"1 M
 8 5
 5 2
 4 1 
```

您想`sp`在这里读取 M 的第一级单元格：

```
<"1 M
┌───┬───┐
│0 0│0 1│
├───┼───┤
│1 0│1 1│
├───┼───┤
│2 0│2 1│
└───┴───┘ 
```

所以`sp"1`将适用于每个单元格（`p sp 0 0`，，`p sp 0 1`等）。`sp`（无限秩）尝试对整个矩阵 M 应用一次 sp。

同样`sp"2`适用`sp`于 M 的二阶单元：

```
<"2 M
 ┌───┬───┬───┐
 │0 0│1 0│2 0│
 │0 1│1 1│2 1│
 └───┴───┴───┘ 
```

所以

```
p sp"2 M
 8 5
 2 5
 0 5 
```

（对`p sp 2 2 $ 0 0 0 1`：`p sp 2 2 $ 1 0 1 1`和`p sp 2 2 $ 2 0 2 1`）

# c# - 通过具有最佳性能的自定义函数订购列表 C#

> ID：11513320
> 
> 赞同：0
> 
> 时间：2012-07-16T22:10:13.577
> 
> 标签：c#, .net

说我有一个功能

```
public float GetOBJECTActivity(OBJECT ob){

   // returns some float
} 
```

在另一个函数中，我得到一个 OBJECT ( `List<OBJECT>`) 列表，我想根据`GetOBJECTActivity`函数结果（降序或升序）对其进行排序。

如何在 C# 中以最佳性能做到这一点？我会在我的项目中做很多类似的操作，我想确保我使用最快和最优雅的方式。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:20:58.350

```
static int MyActivityComparison(OBJECT a, OBJECT b)
{
    float x = GetOBJECTActivity(a);
    float y = GetOBJECTActivity(b);

    // ascending
    return x.CompareTo(y);

    // descending
    // return y.CompareTo(x);
}

list.Sort(MyActivityComparison); 
```

或者使用 lambda 表达式，如果您不想定义独立函数：

```
list.Sort((a, b) =>
    {
        float x = GetOBJECTActivity(a);
        float y = GetOBJECTActivity(b);
        return x.CompareTo(y);     // ascending
        // return y.CompareTo(x);  // descending
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:16:07.847

制作一个[Comparer](http://msdn.microsoft.com/en-us/library/cfttsh47.aspx)，然后将该比较器与[List.Sort()一起使用](http://msdn.microsoft.com/en-us/library/3da4abas.aspx)

到目前为止，让您的列表排序的最快和最优雅的方法是让内置函数来完成。

很多类型（浮点数、字符串、整数）都内置了比较器，所以如果你知道这些是你要使用的唯一类型，那么你可以调用`List.Sort()`

# android - 如何更改特定 ListView 行的颜色/图片 - Android？

> ID：11513322
> 
> 赞同：0
> 
> 时间：2012-07-16T22:10:26.110
> 
> 标签：android, android-listview, listactivity

我正在尝试根据特定条件仅更改一个（可能更多） ListView 行。我已经阅读了许多关于类似问题的答案和大量其他教程，但我无法做出任何事情。

我想要实现的正是当来自 SQLite 的行设置为特定值时，设置行背景（更简单的版本）或行图片（我认为更难的版本）与其他设置不同。

我有扩展 ListActivity 的 Activity，我正在设置 ListView 适配器，如下所示：

```
private void refreshList() {
    mySQLiteAdapter = new MyDBAdapter(this);
    mySQLiteAdapter.open();
    String[] columns = { MyDBAdapter.KEY_TITLE, MyDBAdapter.KEY_GENRE,
            MyDBAdapter.KEY_PRICE, MyDBAdapter.KEY_ID };

    Cursor contentRead = mySQLiteAdapter.getAllEntries(false, columns,
            null, null, null, null, MyDBAdapter.KEY_TITLE, null);

    SimpleCursorAdapter adapterCursor = new SimpleCursorAdapter(this,
            R.layout.row, contentRead, columns, new int[] {
                    R.id.text1, R.id.detail });

    this.setListAdapter(adapterCursor);
    mySQLiteAdapter.close();
} 
```

此函数在 onCreate 方法和 onResume 中调用。我想设置不同的颜色/图像，其中列的值`MyDBAdapter.KEY_PRICE`等于 5。R.layout.row 是我的带有行设计的 xml 文件。

也许有人可以帮我解决这个问题？或者至少显示描述它的教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:22:57.653

只需扩展 SimpleCursorAdapter 并覆盖 bindView()：

```
public class MyAdapter extends SimpleCursorAdapter {
    public MyAdapter(Context context, int layout, Cursor c, String[] from, int[] to) {
        super(context, layout, c, from, to);
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
        super.bindView(view, context, cursor);
        if(cursor.getLong(cursor.getColumnIndex(MyDBAdapter.KEY_PRICE)) == 5)
            view.setBackgroundColor(0xff00ff00);
        else // this will be the default background color: transparent
            view.setBackgroundColor(0x00000000);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:19:05.250

您可以尝试创建在 SimpleCursorAdapter 上扩展的自定义适配器，在其中，在方法 bindView 上，您可以查看您寻找的条件是否已完成，并在该方法上实现您想要的。

[http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html#bindView(android.view.View, android.content.Context, android.database.Cursor)](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html#bindView%28android.view.View,%20android.content.Context,%20android.database.Cursor%29)

希望有所帮助:)

# php - JavaScript 正则表达式仅添加正斜杠规则

> ID：11513325
> 
> 赞同：0
> 
> 时间：2012-07-16T22:10:36.213
> 
> 标签：php, javascript, regex

好的，我需要一个规则，该规则只能在 , 或“C”可以是 A-Za-z 的情况下报告`/`为`C:\`真`\\`。我目前拥有的是： `/^(\\(\\[^\s\\]+)+|([A-Za-z]:(\\)?|[A-z]:(\\[^\s\\]+)+))(\\)?$/`

这适用于查找路径，例如： `\\a` `\\a\b\c\d\e\f` `C:\` `C:\a\b\c\d\e\f`

现在虽然我需要一个正则表达式来验证我目前拥有的方式，理想情况下为正斜杠版本添加一条规则，例如：`/a`和`/a/b/c/d/e/`

我在这里的实际问题是如何获取我目前拥有的内容并对其进行更改，以便我可以仅找到`/`,`C:\`或`\\`并且仅在“C”可以是 A-Za-z 的情况下报告正确。不过，在这两个方面都提供帮助将是额外的好处。当我尝试自己更改正则表达式时，我被卡住并继续破坏任何正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:14:02.020

您列出了三个选项：

*   `/`
*   `[a-zA-Z]:\`
*   `\\`

所以你只需要：

```
/^(?:\/|[a-zA-Z]:\\|\\\\)$/ 
```

# java - Java MyFile 扩展文件

> ID：11513327
> 
> 赞同：1
> 
> 时间：2012-07-16T22:11:29.570
> 
> 标签：java, extends

我对 java 非常陌生，并试图扩展 File 类以使用下面的类向它添加更多方法和属性

```
import java.io.File;

public class RecordingFile extends File {
private static final long serialVersionUID = -4774703382591639948L;
String RecordingNameFormatted;
String RecordingDurationFormatted;
String RecordingSizeFormatted;
String RecordingDateFormatted;
String RecordingBitrateFormatted;

public RecordingFile(String path) {
    super(path);
    File f = new File(path);
    RecordingNameFormatted = f.getName().replace(".mp3", "");
    RecordingDurationFormatted = Utils.millisecondsToHours(Utils.getMp3DurationPureJava(f));
    RecordingSizeFormatted = Utils.humanReadableByteCount(f.length(), true);
    RecordingDateFormatted = Utils.longToDate(f.lastModified());
    RecordingBitrateFormatted = Utils.getBitratePureJava(f) +"Kbps";
}
} 
```

以上不能正常工作。我什至不确定是否

```
 File f = new File(path); 
```

应该在那里。例如，当我尝试这个

```
ArrayList<RecordingFile> ret = new ArrayList<RecordingFile>();
    RecordingFile filesDir = new RecordingFile(path);
    if (!filesDir.exists()) {
        filesDir.mkdirs();
    }
    RecordingFile[] list = filesDir.listFiles(); 
```

Eclipse 告诉我“类型不匹配：无法从 File[] 转换为 RecordingFile[]”我如何才能通过添加更多属性/方法来扩展 File 类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:15:41.280

内置的东西都不知道你的类，所以它们不可能返回你的新类型。我认为您正在寻找的可能是Java中尚不存在的*扩展方法。*

[Java 等价于 C# 扩展方法](https://stackoverflow.com/questions/4359979/java-equivalent-to-c-sharp-extension-methods)

为了使用你的东西，你必须创建一个方法，给定任何 File 对象的集合，返回你的新类型。然后，您必须在要使用您的类型的任何地方调用它。

所以这条线看起来像

```
RecordingFile[] list = convertToRecordingFiles(filesDir.listfiles()); 
```

我将 convertToRecordingFiles 的实现留作练习 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:23:02.383

问题是当您调用 listFiles() 时，您正在调用 File 方法 listFiles()，它返回一个 File 类型的数组。由于继承，您的 RecordingFile 类型是文件，但文件不是 RecordingFile。因此，当您现在调用 listFiles 时，没有问题，因为它返回一个 RecordingFiles 数组，其中是文件，但方法指定它们是文件类型。

如上所述，您可以编写一个将文件转换为 RecordingFiles 的实用程序方法。

或者，您可以只转换方法调用的结果，因为它返回的文件实际上是 RecordingFiles。因此将行更改为：RecordingFile[] list = (RecordingFile[])filesDir.listFiles();

在我看来，最干净的选择是在你的新类上重载方法：给 RecordingFile 一个方法 listFiles()，它返回一个 RecordingFiles 列表（提示：你可以完全按照我上面指定的方式编写方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:15:13.690

如果您正在扩展，`File`那么您的类实例*也是* `File`s。调用超级构造函数就足够了，然后这将包含 File 的所有公共和受保护字段和方法以及您添加的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-08T22:02:36.520

在树视图中列出（虚拟）文件系统方面，我必须覆盖 File 类。所以我选择了 John 的答案来解决它。这是对以前从未覆盖过课程的人的一些帮助。

```
@Override
public MyFile[] listFiles() {
    File[] theFiles = super.listFiles();
    if (theFiles == null || theFiles.length == 0) return null;

    MyFile[] myFiles = new MyFile[theFiles.length];
    for (int i = 0; i < theFiles.length; i++) {
        myFiles[i] = new MyFile(theFiles[i].getAbsolutePath());
    }
    return myFiles;
} 
```

# .net - .net 不要运行不在列表中的测试

> ID：11513329
> 
> 赞同：1
> 
> 时间：2012-07-16T22:11:49.693
> 
> 标签：.net, unit-testing

我已将 6 个单元测试放入有序测试中。运行解决方案中的所有测试运行通过的有序测试，但继续单独运行 6 个测试，这导致其中一些测试失败。如何强制它不运行这些测试？似乎禁用它们也会在有序测试中禁用它们。

# sql - 在sqlalchemy中，当输入多个单词时，可以or_查看两列吗？

> ID：11513333
> 
> 赞同：0
> 
> 时间：2012-07-16T22:12:07.043
> 
> 标签：sql, sqlalchemy

我有以下命令可以按预期工作：

```
DBSession.query(Users).filter(or_(Users.first_name.contains(search_term),Users.last_name.contains(search_term))).all() 
```

我在我的用户表中搜索名字和姓氏，所以我可以`bob smith`通过搜索`bob`或找到`smith`，但是当我搜索时我没有得到任何结果`bob smith`。这显然是因为 bob 在 first_name 列中，而不是`bob smith`因此失败。但是有没有办法在 sqlalchemy 中进行这种搜索？

我知道最糟糕的是我可以创建一个全名的列，但我想我会问一下，以防万一。我还将其标记为 sql，以防万一它可能使用原始 sql，然后我将尝试根据原始查询找出 sqlalchemy 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:19:52.737

实现这一点的最简单方法是使用[混合属性](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/hybrid.html)扩展：

```
from sqlalchemy.ext.hybrid import hybrid_property

class User(Base):
    #...
    first_name = Column(String, nullable=False)
    last_name = Column(String, nullable=False)

    @hybrid_property
    def full_name(self):
        return self.first_name + " " + self.last_name

    @hybrid_property
    def _full_name_last_first(self):
        """ @note: used only for search [last, first].  """
        return self.last_name + ", " + self.first_name

def test_search(search_term):
    q = session.query(User)
    q = q.filter(
            or_(
                User.first_name.contains(search_term),
                User.last_name.contains(search_term),
                User.full_name.contains(search_term),
                User._full_name_last_first.contains(search_term),
                ),
            )
    q = q.order_by(User.id)
    return q.all()

r1 = test_search('John Williams')
assert len(r1) == 1

r1 = test_search('Williams, Jo')
assert len(r1) == 1 
```

# c# - .NET 延迟加载/预先计算的属性

> ID：11513342
> 
> 赞同：0
> 
> 时间：2012-07-16T22:12:38.023
> 
> 标签：c#, .net, properties

我的班级有复杂的财产：

```
 private Image m_LogoImage=null;

    public Image LogoImage
    {
        get
        {
            if (m_LogoImage == null && File.Exists(Data.LogoFileUrl))
            {
                DrawingImage image = DrawingImage.FromFile(Data.LogoFileUrl);
                m_LogoImage = Image.GetInstance(image, new Color(1, 1, 1));
            }
            return m_LogoImage;
        }
    } 
```

LogoImage.get 非常慢且消耗资源，客户端第一次调用它时，该属性会计算图像并将结果存储在私有变量 m_LogoImage 中。
这在我看来非常基本。.NET 支持自动属性 ​​( `public string P {get;set;}`)。它是否支持自动存储复杂的属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:21:49.917

有许多基于状态的问题，因此没有用于延迟加载的语言级别机制。

但是，您可以使用[`Lazy<T>`](http://msdn.microsoft.com/en-us/library/dd642331.aspx)该类来完成此功能。

```
 private Lazy<Image> logo = new Lazy(() => LoadImage()); 

 public Image LogoImage
    {
        get
        {
            return logo.Value;
        }
    } 
```

您还可以使用空合并运算符 ( `??`) 对可空类型进行延迟加载。

```
get 
{
    return image ?? (image = LoadImage());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:18:09.770

不 - 它不支持“自动存储复杂属性” - 从那时起它意味着它必须支持“自动加载复杂属性” - 这必须是可定制的......然后你最终会用 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:24:37.240

从外观上看：`DrawingImage.FromFile(Data.LogoFileUrl);`您的数据来自某种静态对象。您当前基于每个类实例的加载方法是在每个新实例上一遍又一遍地加载相同的对象。您可以通过在初始运行时将数据预加载到静态对象中进行优化。例如：

```
private static Image _m_LogoImage = DrawingImage.FromFile(Data.LogoFileUrl);

public Image LogoImage
{
    get  {  return _m_LogoImage; }
} 
```

# c# - 我可以在没有只读用户的情况下为我的 EDM 创建只读连接吗？

> ID：11513343
> 
> 赞同：0
> 
> 时间：2012-07-16T22:12:38.207
> 
> 标签：c#, .net, sql-server, entity-framework

我正在编写一个连接到 2 个不同数据库模式的应用程序。这些模式之一应该是只读的。有没有办法将连接设置为只读？我无法创建只读用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:26:16.967

将连接模式属性设置为 ModeRead

配置模式 = 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:41:23.733

一个更好的方法是根据用户是否被允许修改数据来禁用你的 UI 元素。您的方法存在的问题是 EF API 并非设计用于只读模式。使用只读连接时调用`SaveChnages`并抛出异常。

您可以执行类似的操作来防止 EF 在只读连接上更新。

```
public class MyContext : DbContext
{
    private bool isReadOnly;
    public MyContext(string conn, bool isReadOnly)
    :base(conn)
    {
         this.isReadOnly = isReadOnly;
    }

    public override int SaveChanges()
    {
         if (isReadOnly)
         {
              return 0; //or throw exception
         }

         return base.SaveChanges();
    }
} 
```

这`ObjectContext`有点棘手。您可以取消设置`SavingChanges`事件中的所有更改。

# java - 如何在 Java 中实现“快速反平方根”？

> ID：11513344
> 
> 赞同：18
> 
> 时间：2012-07-16T22:12:38.613
> 
> 标签：java, floating-point, square-root

我听说[过这里讨论](https://stackoverflow.com/questions/1349542/john-carmacks-unusual-fast-inverse-square-root-quake-iii)过的“快速平方根平方根”，我想把它放在我的 Java 程序中（只是为了研究目的，所以忽略任何关于本机库更快的内容）。

我正在查看代码，C 代码直接将 转换`float`为`int`带有一些 C 指针魔法的。如果您尝试在 Java 中使用强制转换来执行此操作，则它不起作用：java 会截断浮点数（正如您所期望的那样），并且您无法获得原始指针（就像在 C 中那样）。那么你是怎么做到的呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-16T22:12:38.613

### 请记住在使用它之前对您的代码进行基准测试。

如果事实证明你不需要它，或者它在你使用的 CPU 架构上速度较慢，那么最好不要在你的项目中使用这个钝代码。

* * *

Java 库有一种方法可以从浮点数获取原始位。

正如`java.lang.Float`( [http://docs.oracle.com/javase/6/docs/api/java/lang/Float.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Float.html) ) 的 Javadoc 中所见，我们拥有该`floatToIntBits`功能，以及`intBitsToFloat`.

这意味着我们可以用 Java 编写“快速反平方根”，如下所示：

```
public static float invSqrt(float x) {
    float xhalf = 0.5f * x;
    int i = Float.floatToIntBits(x);
    i = 0x5f3759df - (i >> 1);
    x = Float.intBitsToFloat(i);
    x *= (1.5f - xhalf * x * x);
    return x;
} 
```

这是双打的版本：

```
public static double invSqrt(double x) {
    double xhalf = 0.5d * x;
    long i = Double.doubleToLongBits(x);
    i = 0x5fe6ec85e7de30daL - (i >> 1);
    x = Double.longBitsToDouble(i);
    x *= (1.5d - xhalf * x * x);
    return x;
} 
```

来源：[http ://www.actionscript.org/forums/showthread.php3?t=142537](http://www.actionscript.org/forums/showthread.php3?t=142537)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-03T05:34:33.270

[对于 Riking 的回答](https://stackoverflow.com/a/11513345/3357935)，即使是双倍也可以返回 0.9983227945440889 之类的东西作为一的平方根。

为了提高准确性，您可以使用我制作的这个版本：

```
public static double Q_rsqrt(double number){
    double x = number;
    double xhalf = 0.5d*x;
    long i = Double.doubleToLongBits(x);
    i = 0x5fe6ec85e7de30daL - (i>>1);
    x = Double.longBitsToDouble(i);
    for(int it = 0; it < 4; it++){
        x = x*(1.5d - xhalf*x*x);
    }
    x *= number;
    return x;
} 
```

您可以根据需要编辑 for 循环终止前多长时间，但 4 次似乎可以将其降低到双精度的最大精度。如果你想要完美的准确性（或者如果你不应该打扰你的长小数字符串），请使用这个版本。

# html - 表格中的 Z-index 和工具提示（DOM 出现顺序）

> ID：11513350
> 
> 赞同：0
> 
> 时间：2012-07-16T22:13:35.943
> 
> 标签：html, css, debugging, z-index

好的，所以我正在尝试覆盖工具提示上所有父级 div / 元素的 z-index，并且证明我需要使用的表设置很困难。

[http://jsfiddle.net/Z9H4U/5/](http://jsfiddle.net/Z9H4U/5/)

在前面的 JS Fiddle 中，悬停在底行 (#3)，您将看到工具提示在悬停时覆盖了第 2 行中的“内容”一词。这是因为 Z-index 是从各自的父母（我认为）继承的，因此是平等的。因此，堆栈顺序由 DOM 本身的出现顺序决定。出于这个原因，工具提示会覆盖其上方行中的任何内容，而无法涵盖其下方行中的任何内容。

我正在寻找解决方案，我知道这可能是不可能的，但我只是希望我错了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:06:38.400

那么你为什么不把 td 元素的 z-index 属性去掉呢？

[你的jsfiddle的编辑版本](http://jsfiddle.net/Z9H4U/4/)

我想这就是你想要得到的，对吧？:)

顺便说一句：“‘位置：相对’对表格行组、表格标题组、表格页脚组、表格行、表格列组、表格列、表格单元格和表格的影响-caption 元素未定义。”，因此您可能不想在 td 元素中使用相对位置，而是在 td 元素中使用子 div 或类似的东西:)

我在第一行添加了一个带有 position: relative 的 div，你可以看到差异（如果你使用例如最新的 firefox）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T21:04:49.793

我很确定这个特定的 Z-index 问题是无法避免的。我与@r3bel 广泛讨论的答案并没有考虑到我的特定用例，而且 JS Fiddle 并不是一个完全正确的解决方案。

我最终使用了 Twitter Bootstrap 的`bootstrap-popover.js`插件，该插件将弹出框附加到`<body>`动态确保它在 z-index 堆栈中的位置得到尊重。

# html - 将样式表链接到 html 文档的问题

> ID：11513354
> 
> 赞同：0
> 
> 时间：2012-07-16T22:14:21.130
> 
> 标签：html, css

我正在尝试自学html/css。我无法让 Aptana 识别我的 CSS 样式表。

这是我的 html 文件 (index.html) 的内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Josh's Worthwhile Practice</title>
        <meta name="author" content="Joshua Soileau" />
        <link rel="stylesheet" href="style.css" type="text/css"/>
        <!-- Date: 2012-07-11 -->
    </head>
    <body>
        <div id="nav">
            <ul>
                <li><h4>Solutions</h4><p>what we do</p></li>
                <li><h4>Work</h4><p>what we've done</p></li>
                <li><h4>Team</h4><p>who we are</p></li>
                <li id="nav_logo">LOGO</li>
                <li><h4>Blog</h4><p>stuff we say</p></li>
                <li><h4>Contact</h4><p>talk to us</p></li>
                <li><h4>Client</h4><p>login</p></li>
            </ul>
        </div>
    </body>
</html> 
```

这是我的 .css 文件（style.css，与 index.html 在同一目录中）

```
* {
    clear: both;
    padding: 0;
    margin: 0;
}

body {
    background-color: #eee;
    font-family: Arial, Helvetica, sans-serif;
}

#nav {
    color: #121415;
    width: 100%;
    height: 30px;
} 
```

我的 html 代码中有链接标签：

```
<link rel="stylesheet" href="style.css" type="text/css"/> 
```

但是当我在浏览器或 Aptana 预览窗格中打开 index.html 时，它只显示纯 html，而我的 css 没有被拉入。

我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:36:50.347

我找到了我的答案。我在文件中留下了一个空的 css 标签，而 Aptana 不喜欢它。这是我的错，我把它放在这篇文章之外，因为我认为它不相关。

我有：

```
#nav li {} 
```

很抱歉没有给你们所有的信息，你们都非常有帮助，我帮助我学习了一些新东西。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:16:27.620

尝试删除该`type="text/css"`属性。`type`如果指定了 a 并且与文件返回的标头不完全匹配`Content-Type`，并且在本地加载文件时没有标头，大多数现代浏览器都会抱怨`Content-Type`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:16:36.633

您的 style.css 文件必须与 index.html 位于同一位置才能正常工作。

预览时在浏览器的地址栏中看到什么？

如果将 index.html 替换为 style.css 会发生什么？你能看到CSS文件吗？

如果您直接打开 index.html 文件，它是否可以在没有 Aptana 预览的情况下工作？

还要打开 firebug 或开发人员工具并点击网络选项卡以检查浏览器是否正在请求 CSS 文件以及是否报告了任何错误。还要检查响应标头。

您可能还想验证 Aptana 在生成预览后对您的源所做的操作。在预览浏览器中查看源代码是否会显示与样式表完全相同的链接/路径？

您是否有与此用户在 Aptana 的预览中使用绝对路径的类似问题：[Aptana Studio 3 preview questions with absolute path](https://stackoverflow.com/questions/8669664/aptana-studio-3-preview-problems-with-absolute-path)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T22:32:46.963

我很确定 aptana 对文件和其他 html/css 标签具有自动完成功能，因此请尝试

```
<link rel="stylesheet" href=" 
```

我相信，当您输入此内容时，应该会开始为您提供文件夹中的所有文件歇斯底里的设置。如果它不尝试`/`或喜欢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T22:38:32.297

尝试将它放在一个文件夹中，例如 CSS

```
<link href="CSS/aki.css" rel="stylesheet"
    type="text/css" /> 
```

# python - 将python包鸡蛋存放在神器中是个好主意吗？

> ID：11513360
> 
> 赞同：5
> 
> 时间：2012-07-16T22:14:46.717
> 
> 标签：python, artifactory

目前我正在开发自动化测试框架。这个测试框架有不同的包。这些包将在不同的项目中引用，并且可以由开发人员在本地进行修改。我想管理python包鸡蛋。我正在考虑使用 Artifactory。我试图为 Python 寻找 Artifactory 帮助，但我找不到任何有用的东西。
我应该使用 Artifactory 还是 PIP ？

**编辑：**
python中是否有任何方法或命令可以帮助我将鸡蛋放入神​​器中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T05:30:29.700

与简单的共享目录/SCM 二进制存储相比，更喜欢二进制存储库管理器的原因有很多：

1.  细粒度的安全性。
2.  代理和缓存远程存储库的能力。
3.  更有效地处理二进制文件（因为它是为此量身定制的工具）。
4.  与其他团队和世界共享二进制文件更加安全和容易。
5.  与生态系统中的许多工具集成。
6.  搜索和操作设施。
7.  管理工具。

Artifactory 公开了非常丰富的[REST API](http://wiki.jfrog.org/confluence/display/RTF/Artifactory%27s+REST+API)，任何工件的部署都可以通过一个简单的 HTTP PUT 请求来实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-18T16:51:56.317

看看防御水果项目。它提供了以前在 Python 和 Artifactory 之间缺少的粘合剂。 [http://teamfruit.github.io/defend_against_fruit/](http://teamfruit.github.io/defend_against_fruit/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T23:35:29.293

您可以使用“内部”PyPi（使用`easy_install -f ...`或`pip -f ...`）。

对于服务器，您可以只让 Apache 提供一个包含所有鸡蛋或类似[http://pypi.python.org/pypi/pypiserver的目录](http://pypi.python.org/pypi/pypiserver)

# jsf - 在不使用重定向的情况下导航到页面时未触发 JSF preRenderView

> ID：11513366
> 
> 赞同：0
> 
> 时间：2012-07-16T22:15:15.077
> 
> 标签：jsf, jsf-2, java-ee-6, icefaces-3

我创建了一个 preRender 方法，当用户导航到该特定页面时要调用它，我使用：

```
<f:metadata>
    <f:event listener="#{targetClass.prerender()}"
        type="preRenderView">
    </f:event>
</f:metadata> 
```

但问题是当我导航到此页面时不会调用此方法，除非我使用

```
<redirect /> 
```

在 faces-config.xml 文件中。但是，我不想使用重定向，所以 url 总是指向登录页面。

谢谢你。

# applet - java applet 对于新的 Web 内容来说是不是一个糟糕的选择？

> ID：11513367
> 
> 赞同：7
> 
> 时间：2012-07-16T22:15:28.120
> 
> 标签：applet

我在一家政府科学机构工作，该机构通过我们的网站提供大量技术信息。Web 开发并不是我们真正的强项，但我们过得去。我们当前的许多内容都是通过 Java 小程序交付的。最近我们收到来自用户的反馈，他们无法访问网站的各个部分，因为他们的浏览器（主要是 Safari 和 Firefox）由于安全问题而禁用了 Java。当然，这两种情况都可以通过升级和/或更改偏好来解决，但对于非精明的用户来说，这仍然会产生过高的障碍。

所以我的问题是 Java 小程序的未来可能是什么？这是一种可能会变得不那么常见的方法，并且不能/不会运行它们的浏览器配置的比例会增加吗？正如我提到的，我的组织（和我自己）不是 Web 开发专家，所以我们对趋势没有很好的了解。是否应该用 Java 小程序以外的其他东西编写新内容（我们最近开发的内容使用 JavaScript）。我们是否应该计划转换小程序以应对支持的减少？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T22:26:29.650

当前的趋势很明显是在客户端浏览器中*减少对 Java 小程序的支持。*它从来没有真正运作得很好，现在有更好的方法在网站中呈现动态信息。

今天构建一个依赖 Java 小程序进行内容交付的新网站将是一个糟糕的技术选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-28T06:37:49.520

正如所指出的，使用 Java 小程序进行内容交付确实是一个糟糕的技术选择。
现代浏览器几乎可以做任何小程序可以提供的事情。因此，如今小程序的使用变得相当多余。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T17:29:36.140

Firefox 和 Chrome 正在推动 JavaScript 和 Native Client，并出于政治原因而非安全原因禁用了 Java。短时间里哪里出现了一些特定版本的Java Plugin哪里出了安全问题。Apple 屏蔽了这些版本，而 FF 和 Chrome 则以此为借口完全禁用它。

什么技术最好完全取决于您的用例。如果开发时间是最重要的因素，我会说使用 Swing 框架的 Applet 是可行的方法。您可以使用 Netbeans 中的 Swing 设计器快速制作 GUI:s。基于 Swing 的 GUI 的性能也优于 Flash 或 HTML+JavaScript。

但请记住，浏览器支持将受到限制，用户会收到安全问题等，但是如果您公开的数据对用户来说足够有趣，这无关紧要。

如果我在哪里设计一个需要在所有浏览器中运行良好的启动网站，适合搜索引擎等 Applet 将是一条死胡同。

如果我在哪里设计一个复杂的网站来呈现现有用户群已经需要的数据，我会选择 Java Applets。

作为第三种选择，您可以两者都做。使用 HTML+JavaScript 制作一个简化的网站，使用 Swing 制作一个更高级的 Applet 版本。即使对于需要吸引新用户的网站，这也是一个可行的选择，其中一些材料可以被搜索引擎访问，并且首页可以在所有浏览器中使用。

# xml - 使用 Qt 解析格式不正确的 XML

> ID：11513368
> 
> 赞同：1
> 
> 时间：2012-07-16T22:15:29.680
> 
> 标签：xml, qt, qtxml

我想使用 Qt 来解析格式不正确的 XML 文档：

```
<log_data>
//lots of data
</log_data>
<log_data>
//more data
</log_data>

//etc. 
```

这是否可能，或者 Qt XML 解析库是否绝对需要格式良好的 XML？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:20:46.150

只需`<root>`在它之前和`</root>`之后添加一个，您就有一个有效的 XML 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T07:46:13.103

创建骨架文档 wrapper.xml：

```
<!DOCTYPE wrapper [
<!ENTITY e SYSTEM "real.xml">
]>
<wrapper>&e;</wrapper> 
```

其中 real.xml 是您真正想要阅读的 XML 片段；然后将您的 XML 解析器指向 wrapper.xml。

# facebook-c#-sdk - 如何在单个 fql 查询中请求有关多个 URL 的详细信息？

> ID：11513374
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:19.990
> 
> 标签：facebook-c#-sdk, facebook-fql

我做了一个 fql 查询，它返回有关单个 url 的详细信息。在这一点上，我为网站上的每个页面创建了一个新查询——这显然不是很有效。有没有办法创建一个返回所有页面及其详细信息的查询。例如：我现在得到的：

```
<fql_query_response xmlns="http://api.facebook.com/1.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" list="true">
<link_stat>
<url>www.facebook.com</url>
<normalized_url>http://www.facebook.com/</normalized_url>
<share_count>50783153</share_count>
<like_count>2482551</like_count>
<comment_count>2371768</comment_count>
<total_count>55637472</total_count>
<commentsbox_count>0</commentsbox_count>
<comments_fbid>10150187081535131</comments_fbid>
<click_count>243646</click_count>
</link_stat>
</fql_query_response> 
```

我需要的：

```
<fql_query_response xmlns="http://api.facebook.com/1.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" list="true">
<link_stat>
<url>www.facebook.com</url>
<normalized_url>http://www.facebook.com/</normalized_url>
<share_count>50783153</share_count>
<like_count>2482551</like_count>
<comment_count>2371768</comment_count>
<total_count>55637472</total_count>
<commentsbox_count>0</commentsbox_count>
<comments_fbid>10150187081535131</comments_fbid>
<click_count>243646</click_count>
</link_stat>

<link_stat>
<url>www.yahoo.com</url>
<normalized_url>http://www.yahoo.com/</normalized_url>
<share_count>50783153</share_count>
<like_count>2482551</like_count>
<comment_count>2371768</comment_count>
<total_count>55637472</total_count>
<commentsbox_count>0</commentsbox_count>
<comments_fbid>10150187081535131</comments_fbid>
<click_count>243646</click_count>
</link_stat>
</fql_query_response> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T03:40:26.490

您应该尝试关闭此问题，以便将其标记为已解决。

回顾一下，您的 IN() 和对域字符串的引用出现了一些问题

```
 IN('www.facebook.com, www.yahoo.com') 
```

应该

```
 IN('www.facebook.com', 'www.yahoo.com') 
```

[http://api.facebook.com/method/fql.query?query=SELECT%20url,%20normalized_url,%20share_count,%20like_count,%20comment_count,%20total_count,%20commentsbox_count,%20comments_fbid,%20click_count%20FROM%20link_stat% 20WHERE%20url%20IN](http://api.facebook.com/method/fql.query?query=SELECT%20url,%20normalized_url,%20share_count,%20like_count,%20comment_count,%20total_count,%20commentsbox_count,%20comments_fbid,%20click_count%20FROM%20link_stat%20WHERE%20url%20IN) ('www.facebook.com',%20'www.yahoo.com')

# node.js - 从 Node 更新 Mongo 文档

> ID：11513375
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:22.747
> 
> 标签：node.js, mongodb, socket.io

所以我将文档插入到 mongo db 中

```
io.sockets.on('connection', function (socket) {
    connectLog(socket.handshake.address.address);

function connectLog(ipAddress) {
   db.collection('tracking', function (err, collection) {
        var currentTime = new Date();
        var doc={"ip":ipAddress, "connect": currentTime, "culture": "en" };
        collection.insert(doc, function () { });
    });

} 
```

我有另一个活动

```
function logout(id, disconnect) { 
```

我想更新（或替换？）该记录并添加`disconnect: (time)`到其中。我该怎么做呢？通过这种方式，我可以判断一个人何时连接以及何时断开聊天。

我正在使用 socket.io，所以我会知道他们确切的断开连接时间

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:57:21.780

首先，阅读有关显式与隐式断开连接的内容：[Socket.io：如何处理关闭连接？](https://stackoverflow.com/questions/6562391/socket-io-how-to-handle-closing-connections). 基本上，您的显式注销处理程序（这很好！）应该调用与断开处理程序相同的代码，以防用户没有机会显式注销。

因此，除了您的注销代码之外，您还需要：

```
socket.on('disconnect', handleDisconnect) 
```

在该断开/注销处理程序中，您将希望找到该用户的最新连接文档并对其进行更新。

```
collection.findAndModify(
 {"address" : address}, //same address 
 [['connect', 'descending']], //the most recent, findAndModify only changes the first doc
 {$set: {disconnect: currentTime}}, //set the disconnect time
 function(err, object){/*deal with errors*/}
) 
```

# database - 在重复的时间范围内查找带有时间戳的对象

> ID：11513376
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:25.810
> 
> 标签：database, django, django-models, django-queryset

是否可以执行一个 QuerySet 过滤器，从指定的重复时间跨度返回对象？

例如，给定相隔几天的开始日期和结束日期，我希望能够找到：

*   在开始和结束之间的每一天获取时间戳在下午 2 点到 7 点之间的所有对象
*   获取时间戳在 1am 和 8am 之间的每一天（星期六或星期日）的所有对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:07:09.430

**未测试**

对于第一种情况，假设 MyModel 并且您的时间戳称为 date 您可以执行以下操作：

```
import datetime

start_date = datetime.date(2012,7,1)
end_date = datetime.date(2012,7,16)
start_time = datetime.time(14,0)
end_time = datetime.time(19,0)
date_range = end_date - start_date

range_list = None
for days in xrange(date_range.days):
    d = start_date + datetime.timedelta(days)
    if range_list is None:
        range_list = Q(date__range = (datetime.datetime.combine(d, start_time), datetime.datetime.combine(d, end_time)))
    else:
        range_list = range_list|Q(date__range = (datetime.datetime.combine(d, start_time), datetime.datetime.combine(d, end_time)))

MyModel.objects.filter(range_list) 
```

# c# - 如何使用 C# 运行预先存在的 Windows 服务

> ID：11513377
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:25.047
> 
> 标签：c#, wpf, service

> **可能重复：**
> [C# 以编程方式启动 Windows 服务](https://stackoverflow.com/questions/6667799/c-sharp-start-windows-service-programmatically)

我想从 wpf 应用程序内部启动/停止预先存在的 Windows 服务。关于如何做到这一点的任何指示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:17:42.660

您正在寻找[ServiceController](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.aspx)类，更具体地说是[Start](http://msdn.microsoft.com/en-us/library/yb9w7ytd.aspx) / [Stop](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.stop.aspx)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:20:43.257

```
Process.Start("net start myService"); 
```

# assembly - 汇编语言 - masm32 - 乘法

> ID：11513381
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:30.150
> 
> 标签：assembly, masm, masm32

我将 3 个数字相乘，即使有进位也能很好地工作。我想添加第四个数字来乘以仅用于学习目的。

在我乘以 3 个数字后，我转移到 EDX 并打印。效果很好。在我添加第四个数字后，我想我乘以 32 位 x 32 位？所以它存储到 EDX:EAX 中？

然后我需要将 EAX 转换为 EDX 以便它们一起打印吗？我不确定我是否为第四个号码做对了？

```
.data?
  num1 dd ?
  num2 dd ?
  num3 dd ?
  num4 dd ?

.data
sum dd 0
prod dd 0
prod2 dd 0 
```

这是提示

```
mov EAX, sval(input("Enter first number: "))
mov num1, EAX
mov EAX, sval(input("Enter second number: "))
mov num2, EAX
mov EAX, sval(input("Enter third number: "))
mov num3, EAX

mov EAX, sval(input("Enter fourth number: "))
mov num4, EAX 
```

这是逻辑

```
mov EAX, num1
mov EBX, num2
mul BL                 ; 8 bit x 8 bit ----> AX / 16bit

mov EBX, num3
mul BX     ; 16bit x 16bit --->DX:AX

shl EDX, 16  ; shift low to high             ;high / low in EDX
mov DX, AX     ; mov in all reg

mov ECX, num4   ; 32bit x 32bit ---> EDX:EAX
mul CX
mov prod2, EAX  ; for printing 
```

我不确定我是否应该将 num4 移动到 ECX 并乘以 CX 我应该乘以 32 位吗？我对第四个数字做错了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T00:30:49.323

32 位乘法使用`EAX`寄存器。您的第三次乘法代码是 16 位的，因为您的`MUL`操作数使用 16 位寄存器，所以乘法是`AX x CX`. 32 位乘法需要 32 位操作数，因此在您的代码中，您需要使用`ECX`而不是`CX`. 此外，32 位乘法的准备工作不完整，因为值仍然放在`EDX`寄存器中。

所以代码应该是这样的：

```
mov EAX, num1
mov EBX, num2
mul BL         ; 8 bit x 8 bit ---> AX / 16bit

mov EBX, num3
mul BX         ; 16bit x 16bit ---> DX:AX

shl EDX, 16    ; shift low to high  ;high / low in EDX
mov DX, AX     ; mov in all reg
mov EAX, EDX   ; prepare EAX for 32bit x32bit

mov ECX, num4
mul ECX        ; 32bit x 32bit ---> EAX x ECX ---> EDX:EAX
mov prod2, EAX ; for printing 
```

请注意，32 位乘法可能会导致 64 位值`EDX:EAX`，因此请确保您的*打印*功能`EDX`考虑了寄存器。

# visual-studio - 用于折叠自定义节点的 Visual Studio 宏

> ID：11513387
> 
> 赞同：0
> 
> 时间：2012-07-16T22:16:45.443
> 
> 标签：visual-studio

如果我有类似的东西：

```
namespace SomeNameSpace
{
    #region Usings

    using System.Collections.Generic;
    using System.Security;

    #endregion

    /// <summary> Implements a dictionary with several keys.                               </summary>
    /// <typeparam name="Value"> What type of elements we will be storing in the dictionary</typeparam>
    public class MultiKeyDic<Value>
    {

         /// <summary>  a very long summary that can be
         /// collapsed and expanded. </summary>
         public int SomeInt {get;set;}

         public void someMethod()
         {

         }
    }
} 
```

如何创建一个可以找到所有可扩展位置（节点）的宏。如果我想折叠所有节点，我将不得不按`someMethod()`, `summary of SomeInt`, `class MultiKeyDic`,`summary of class MultiKeyDic`和`#region Usings`finally的顺序折叠节点`namespace`。

我知道命令`ctrl`++`M`会`O`折叠所有内容，但我不想折叠所有内容。例如，我可能不想折叠评论。如果我折叠所有内容，然后展开扩展父节点的评论。

* * *

到目前为止，我已经创建了这个可以找到大多数节点的宏：

```
Sub VisitAllNodes()
    Dim i As Integer
    Dim fileCM As FileCodeModel
    Dim elts As EnvDTE.CodeElements
    Dim elt As EnvDTE.CodeElement

    fileCM = DTE.ActiveDocument.ProjectItem.FileCodeModel
    elts = fileCM.CodeElements
    For i = 1 To elts.Count
        elt = elts.Item(i)
        CollapseE(elt, elts, i)
    Next
End Sub

'' Helper to OutlineCode. Recursively outlines members of elt.
''
Sub CollapseE(ByVal elt As EnvDTE.CodeElement, ByVal elts As EnvDTE.CodeElements, ByVal loc As Integer)
    Dim epStart As EnvDTE.EditPoint
    Dim epEnd As EnvDTE.EditPoint

    epStart = elt.GetStartPoint(vsCMPart.vsCMPartWholeWithAttributes).CreateEditPoint()
    epEnd = elt.GetEndPoint(vsCMPart.vsCMPartWholeWithAttributes).CreateEditPoint() ' Copy it because we move it later.
    epStart.EndOfLine()
    If ((elt.IsCodeType()) And (elt.Kind <> EnvDTE.vsCMElement.vsCMElementDelegate)) Then
        Dim i As Integer
        Dim mems As EnvDTE.CodeElements

        mems = elt.Members
        For i = 1 To mems.Count

            Dim temp As EnvDTE.CodeElement = mems.Item(i)
            Dim t As String = [Enum].GetName(GetType(EnvDTE.vsCMElement), temp.Kind)
            MsgBox("Found member (" & t & ") at line# " & temp.StartPoint.Line)

            CollapseE(mems.Item(i), mems, i)
        Next
    ElseIf (elt.Kind = EnvDTE.vsCMElement.vsCMElementNamespace) Then
        Dim i As Integer
        Dim mems As EnvDTE.CodeElements

        mems = elt.Members
        For i = 1 To mems.Count

            Dim temp As EnvDTE.CodeElement = mems.Item(i)
            Dim t As String = [Enum].GetName(GetType(EnvDTE.vsCMElement), temp.Kind)
            MsgBox("Found member (" & t & ") at line# " & temp.StartPoint.Line)

            CollapseE(mems.Item(i), mems, i)
        Next
    End If

    'Return
    ' collapse the element

    If (epStart.LessThan(epEnd)) Then
        loc = loc + 1
        If (loc <= elts.Count) Then
            epEnd.MoveToPoint(elts.Item(loc).GetStartPoint(vsCMPart.vsCMPartHeader))
            epEnd.LineUp()
            epEnd.EndOfLine()
        End If
        epStart.OutlineSection(epEnd)
    End If
End Sub 
```

它看起来比实际情况更复杂。在任何文档上运行它，它将显示所有属性、类、枚举等，但由于某种原因，它找不到注释或区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T19:40:36.607

第一个函数`IncludeMember`用于确定要排除的成员类型。例如在这个例子中我不折叠命名空间和使用指令：

```
' filter some mebers. for example using statemets cannot be collapsed so exclude them. 
    Function IncludeMember(ByVal member As EnvDTE.CodeElement)

        If member.Kind = vsCMElement.vsCMElementIDLImport Then
            Return False
        ElseIf member.Kind = vsCMElement.vsCMElementNamespace Then
            Return False  ' I do not want to colapse enums
        End If

        Return True

    End Function

    Sub CollapseNodes()

        ' activate working window
        DTE.Windows.Item(DTE.ActiveDocument.Name).Activate()

        ' expand everything to start

        Try
            DTE.ExecuteCommand("Edit.StopOutlining")
        Catch
        End Try

        Try
            DTE.ExecuteCommand("Edit.StartAutomaticOutlining")
        Catch
        End Try

        ' get text of document and replace all new lines with \r\n
        Dim objTextDoc As TextDocument
        Dim objEditPt As EnvDTE.EditPoint
        Dim text As String
        ' Get a handle to the new document and create an EditPoint.
        objTextDoc = DTE.ActiveDocument.Object("TextDocument")
        objEditPt = objTextDoc.StartPoint.CreateEditPoint
        ' Get all Text of active document
        text = objEditPt.GetText(objTextDoc.EndPoint)
        text = System.Text.RegularExpressions.Regex.Replace( _
                        text, _
                        "(\r\n?|\n\r?)", ChrW(13) & ChrW(10) _
                    )

        ' add new line to text so that lines of visual studio match with index of array
        Dim lines As String() = System.Text.RegularExpressions.Regex.Split(vbCrLf & text, vbCrLf)

        ' list where whe will place all colapsable items
        Dim targetLines As New System.Collections.Generic.List(Of Integer)

        ' regex that we will use to check if a line contains a #region
        Dim reg As New System.Text.RegularExpressions.Regex(" *#region( |$)")

        Dim i As Integer
        For i = 1 To lines.Length - 1

            If reg.Match(lines(i)).Success Then
                targetLines.Add(i)
            End If

        Next

        Dim fileCM As FileCodeModel
        Dim elts As EnvDTE.CodeElements
        Dim elt As EnvDTE.CodeElement

        Dim projectItem = DTE.ActiveDocument.ProjectItem

        Dim temp = projectItem.Collection.Count

        Dim b = DirectCast(DirectCast(projectItem.Document, EnvDTE.Document).ActiveWindow, EnvDTE.Window).ContextAttributes

        fileCM = projectItem.FileCodeModel
        elts = fileCM.CodeElements
        For i = 1 To elts.Count
            elt = elts.Item(i)
            CollapseE(elt, elts, i, targetLines)
        Next

        ' now that we have the lines that we will plan to collapse sort them. it is important to go in order
        targetLines.Sort()

        ActivateWorkingWindow()

        ' go in reverse order so that we can collapse nested regions
        For i = targetLines.Count - 1 To 0 Step -1

            DTE.ExecuteCommand("Edit.Goto", targetLines(i))

            DTE.ExecuteCommand("Edit.ToggleOutliningExpansion")

        Next

    End Sub

    '' Helper to OutlineCode. Recursively outlines members of elt.
    ''
    Sub CollapseE(ByVal elt As EnvDTE.CodeElement, ByVal elts As EnvDTE.CodeElements, ByVal loc As Integer, ByRef targetLines As System.Collections.Generic.List(Of Integer))
        Dim epStart As EnvDTE.EditPoint
        Dim epEnd As EnvDTE.EditPoint

        epStart = elt.GetStartPoint(vsCMPart.vsCMPartWholeWithAttributes).CreateEditPoint()
        epEnd = elt.GetEndPoint(vsCMPart.vsCMPartWholeWithAttributes).CreateEditPoint() ' Copy it because we move it later.
        epStart.EndOfLine()
        If ((elt.IsCodeType()) And (elt.Kind <> EnvDTE.vsCMElement.vsCMElementDelegate) Or elt.Kind = EnvDTE.vsCMElement.vsCMElementNamespace) Then
            Dim i As Integer
            Dim mems As EnvDTE.CodeElements

            mems = elt.Members
            For i = 1 To mems.Count

                CollapseE(mems.Item(i), mems, i, targetLines)

            Next

        End If

        If (epStart.LessThan(epEnd)) Then
            If IncludeMember(elt) Then
                targetLines.Add(epStart.Line)
            End If
        End If

    End Sub 
```

# android - 如何模仿 ActionBar 菜单？

> ID：11513391
> 
> 赞同：0
> 
> 时间：2012-07-16T22:17:09.957
> 
> 标签：android, user-interface, android-actionbar, widget

是否可以在不使用 ActionBar 的情况下创建类似的东西？我只需要“按钮”，它会在点击后滚动一些项目...... ![在此处输入图像描述](../Images/fe94dd1ff640e71d4d515344e975d403.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:22:18.927

ActionBarSherlock 在您的情况下可能有用：http: [//actionbarsherlock.com/](http://actionbarsherlock.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:21:46.473

“肮脏”的方法是将您的按钮链接到一个不可见的 Spinner，一旦按下按钮，它就会变得可见。然后它只是绑定微调器的 onSelect 事件并对其进行主题化的情况。

# javascript - 如何检测innerHTML何时完成

> ID：11513392
> 
> 赞同：18
> 
> 时间：2012-07-16T22:17:11.840
> 
> 标签：javascript

我已经做了很多搜索来解决这个问题，但到目前为止还没有找到一个可以跨浏览器工作的解决方案。

我需要的是一个原始的javascript函数，一旦innerHTML成功插入dom，它将获取一个元素并运行回调。

例如

```
 var element = document.getElementById('example');
        element.innerHTML = newhtml;

    waitUntilReady(element, function(){
            //do stuff here...
    }); 
```

所以总结一下，我需要能够检查元素的内容并在 innerHTML 完成时触发回调。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:20:24.670

不需要这样的功能。分配给`innerHTML`将在继续运行任何脚本之前立即执行此操作。

如果您确实需要延迟执行（例如允许浏览器重绘），请使用`setTimeout`延迟`1`（或其他短时间间隔）。

# c# - WP7 上的定时器调度更改乱序

> ID：11513396
> 
> 赞同：2
> 
> 时间：2012-07-16T22:17:39.363
> 
> 标签：c#, windows-phone-7, timer, begininvoke, dispatch

我正在尝试在 Windows Phone 7 上制作倒数计时器，这对我的应用程序非常重要。但是我找不到任何方法来每隔一秒更新一次 UI 规则中的文本。

```
Timer dt = new System.Threading.Timer(delegate
{
 Dispatcher.BeginInvoke(() =>
   {
      newtime = oldtime--;
      System.Diagnostics.Debug.WriteLine("#" + counter.ToString() + 
                                         " new: " + newtime.ToString() + 
                                         " old: " + oldtime.ToString());
      counter++;
      oldtime = newtime;
   }
}, null, 0, 1000); 
```

运行我的应用程序控制台输出后看起来像这样：

> ```
> #1 new: 445 old: 446
> #2 new: 444 old: 445
> #3 new: 445 old: 446
> #4 new: 443 old: 444
> #5 new: 444 old: 445
> #6 new: 442 old: 443
> #7 new: 443 old: 444
> #8 new: 441 old: 442 
> ```

我不知道如何摆脱那些不需要的调用（#3、#5、#7 等）

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:34:22.230

尝试以下模式：

```
DispatcherTimer _timer = new DispatcherTimer { Interval = TimeSpan.FromMilliseconds(200) };
int _timeLeft = 50;
Stopwatch watch = new Stopwatch();
public MainPage()
{
InitializeComponent();
_timer.Tick += TimerTick;
_timer.Start();
textBlock1.Text = _timeLeft.ToString();
watch.Start();
}
void TimerTick(object sender, EventArgs e)
{

    if ((_timeLeft - (int)watch.Elapsed.TotalSeconds) <= 0)
    {
        watch.Stop();
        _timer.Stop();
        textBlock1.Text = null;
    }
    else
    {
        textBlock1.Text = (_timeLeft - (int)watch.Elapsed.TotalSeconds).ToString();
    }
} 
```

顺便说一句，Shawn 的代码在我的设备上运行良好，但如果您遇到问题，只需使用 a`Stopwatch`并从您的时间变量中减去经过的时间。此外，运行`DispatcherTimer`速度更快（当然对于这种技术），例如 200 毫秒，以获得更高的准确度（一切都已在上面实现）。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T07:47:50.013

查看代码和注释，我怀疑您的应用程序的错误不在于 Timer 代码，而是与初始化 Timer 的任何内容有关 - 我怀疑计时器被构造了两次。

如果没有看到您发布的块之外的代码，很难调试它，但是您描述的症状表明您正在初始化多个计时器和多个堆栈/闭包变量`oldTime`，并且`newTime`

在一个简单的层面上，您可以尝试保护 Timer 构造 - 例如，使用以下内容：

```
public class MyClass
{

// existing code...

private bool _timerStarted;

private void StartTimer()
{

if (_timerStarted)
{
    Debug.WriteLine("Timer already started - ignoring");
    return;
}

_timerStarted = true;

var newTime = 500;
var oldTime = 500;
var counter = 1;

Timer dt = new System.Threading.Timer(delegate
{
 Dispatcher.BeginInvoke(() =>
   {
      newtime = oldtime--;
      System.Diagnostics.Debug.WriteLine("#" + counter.ToString() + 
                                         " new: " + newtime.ToString() + 
                                         " old: " + oldtime.ToString());
      counter++;
      oldtime = newtime;
   }
}, null, 0, 1000);
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:33:19.517

您应该改用[DispatcherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer%28v=VS.95%29.aspx)。以下示例显示了一个计时器从十开始倒计时。

```
DispatcherTimer _timer = new DispatcherTimer { Interval = TimeSpan.FromSeconds(1) };
int _timeLeft = 10;

public MyClass()
{
    InitializeComponent();
    _timer.Tick += TimerTick;
    _timer.Start();
    MyTextBox.Text = _timeLeft.ToString();
}

void TimerTick(object sender, EventArgs e)
{
    _timeLeft--;
    if (_timeLeft == 0)
    {
        _timer.Stop();
        MyTextBox.Text = null;
    }
    else
    {
        MyTextBox.Text = _timeLeft.ToString();
    }
} 
```

# c# - 从对象转换函数表达式树

> ID：11513400
> 
> 赞同：1
> 
> 时间：2012-07-16T22:17:54.953
> 
> 标签：c#, .net, linq, lambda, expression-trees

我最终遇到了一种情况，即*函数表达式树* `Expression<Func<TClass, TProperty>>`被分配给*对象*类型的全局变量，然后在代码中我需要使用表达式调用不同的方法。我无法更改全局对象类型；它必须是对象。

除非我将对象转换为`Expression<Func<TClass, TProperty>>`. 问题是在调用第二种方法时我不知道*TProperty是什么。*

我创建了一个快速演示应用程序来说明这一点（用 VS2010 编写的 c# 控制台应用程序）——真正的应用程序看起来不像这样。

```
using System;
using System.Linq.Expressions;

namespace FuncExpressionTree
{
    public class ViewModel
    {
        public string StringProperty { get; set; }
        public int IntProperty { get; set; }
    }

    public class Helper<T>
        where T : ViewModel
    {
        private object _global;

        public void Execute()
        {
            AssignToGlobal((T vm) => vm.StringProperty);

            ProcessGlobal();

            AssignToGlobal((T vm) => vm.IntProperty);

            ProcessGlobal();
        }

        public void AssignToGlobal<TClass, TProperty>(Expression<Func<TClass, TProperty>> expression)
        {
            _global = expression;
        }

        public void ProcessGlobal()
        {
            // invalid cast exception thrown when IntProperty is assigned to _global
            AssignToGlobal((Expression<Func<T, string>>)_global);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            (new Helper<ViewModel>()).Execute();
        }
    }
} 
```

如果我们专注于`Execute()`方法。

1.  为字符串属性分配了第一个*全局*表达式。
2.  ProcessGlobal 执行并工作，因为我正在转换为`Expression<Func<T, string>>`.
3.  为 int 属性分配下一个*全局*表达式。
4.  ProcessGlobal 再次执行，但此时抛出了无效的强制转换异常。如果我将其更改为强制转换，它会起作用，`Expression<Func<T, int>>`但字符串属性将不起作用。还会`Expression<Func<T, object>>`引发无效的强制转换异常。

我觉得我错过了一些东西，并且应该可以使用`System.Linq.Expressions`命名空间做一些事情来动态调用第二种方法（例如，上面示例中 ProcessGlobal 中的 AssignToGlobal）。

那么我怎样才能让它以一种通用的方式工作呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:39:37.260

```
 public void ProcessGlobal()
    {
        var globalType = _global.GetType(); // globalType = Expression<Func<TClass, TProperty>>
        var functionType = globalType.GetGenericArguments()[0]; // functionType = Func<TClass, TProperty>
        var functionGenericArguments = functionType.GetGenericArguments(); // v = [TClass, TProperty]
        var method = this.GetType().GetMethod("AssignToGlobal").MakeGenericMethod(functionGenericArguments); //functionGenericArguments = AssignToGlobal<TClass, TProperty>
        method.Invoke(this, new[] { this._global }); // Call AssignToGlobal<TClass, TProperty>)(this._global);
    } 
```

# jquery - coffeescript 不更新 dom 元素

> ID：11513401
> 
> 赞同：0
> 
> 时间：2012-07-16T22:17:56.187
> 
> 标签：jquery, ruby-on-rails, coffeescript

我是咖啡脚本的新手，我遇到了绑定到事件的问题。我有一个 div，它是通过 ajax 更新的，然后我想在返回的部分上定义一些额外的 jquery 事件。这一切都在rails 3.2上运行。我的 js.erb 很好地返回了这部分：

```
$('#top_box').empty()
$('#top_box').append('<%= escape_javascript(render :partial => 'form') %>') 
```

表单部分有一个文本字段，我想在其上进行一些额外的事件处理，即

```
$('#link_long').on('click',function(){ $('#link_long').val("" );}) 
```

当我将上面的行添加到 js.erb 文件中时，一切正常，但我想看看如何在咖啡中做到这一点。所以，我把那句话翻译成咖啡，比如

```
$ ->
  $('#link_long').on 'click', ->
    $('#link_long').val("") 
```

生成的咖啡的js代码是

```
(function() {

 $(function() {
 return $('#link_long').on('click', function() {
 return $('#link_long').val("");
 });
 });

}).call(this); 
```

但是咖啡脚本永远不会起作用。有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:22:55.573

这有点猜测，但您可能在附加部分之前绑定了事件。`$('#link_long')`找不到你的元素，因为它还不存在，所以什么也没有发生。您的 JS -> CS 翻译中的中断可能是将点击处理程序移动到它自己的`$ ->`回调中，这 - 我再次猜测 - 在其中运行的那个之前运行`append`。在任何情况下，拥有多个相互依赖的文档就绪处理程序都是自找麻烦。

最明显的选择是 append 之后的 bind：

```
$('#top_box').append('<%= escape_javascript(render :partial => 'form') %>')
$('#link_long').on 'click', -> $('#link_long').val("") 
```

另一种选择是绑定文档，然后通过选择器进行过滤（在触发事件时完成过滤，因此您可以在所选元素存在之前进行绑定）：

```
$(document).on('click', '#link_long', -> $('#link_long').val("")) 
```

# c# - 如何在窗口周围画一个矩形？（当我知道它的手柄时）

> ID：11513405
> 
> 赞同：1
> 
> 时间：2012-07-16T22:18:37.583
> 
> 标签：c#, .net, winforms, draw

我想要的效果是：

![在此处输入图像描述](../Images/8beeb4ed5c6a30e5f71dbaf5be587f6d.png)

是的..它在间谍中具有类似的效果..当我在没有边框样式的 WindowForm 或 WindowForm 内的控件上执行此操作时，它可以完美地工作。

但是，当涉及到具有 FormBorder 的 WindowForm 时，它会失败！矩形在表单内形成：

![在此处输入图像描述](../Images/e9f9972d78df1be8144697bcb177088f.png)

为了绘制矩形，我使用了[CodeProject](http://www.codeproject.com/Articles/9741/Screen-Captures-Window-Captures-and-Window-Icon-Ca)的源代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:10:09.850

正如前面评论中提到的，您可以使用 GetDesktopWindow() API 在桌面上绘图。

# coffeescript - .hamlc 模板的 Sublime Text 2 中的 Haml 语法高亮显示

> ID：11513409
> 
> 赞同：8
> 
> 时间：2012-07-16T22:18:50.313
> 
> 标签：coffeescript, syntax-highlighting, sublimetext2, hamlc, jst

我安装了 HAML textmate 包，它显示 .haml 模板的语法高亮显示，但我也有名为的 Coffee HAML 模板

```
layout.jst.hamlc 
```

我也想添加语法高亮。

Ruby Haml 语法足够好，所以我通常只是将语言更改为 Ruby Haml，但是当我再次关闭并打开文件时，Sublime Text 2 忘记了它，我不得不一次又一次地分配它。

有没有办法为 .hamlc 文件自动分配 ruby​​ Haml 语法高亮？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-17T00:33:32.247

在语言选择菜单中（单击右下角的“纯文本”），最顶部是“以当前扩展名打开所有内容”，它会扩展为另一个语言列表。从那里选择`User`> `Rails`> `Ruby Haml`，它会记住 hamlc 文件。

![截屏](../Images/5eef96f04c1cca166794ecb74644618b.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-01T15:48:50.817

我刚刚为 Sublime的[包控制添加了一个](http://wbond.net/sublime_packages/package_control)[**hamlc**语法定义。](https://github.com/jisaacks/CoffeeScriptHaml)

# c - getter 函数如何知道是否调用了 setter 函数？

> ID：11513413
> 
> 赞同：1
> 
> 时间：2012-07-16T22:18:58.063
> 
> 标签：c

我已经为 C 中结构的某些成员编写了 setter 和 getter API。我希望只有在调用 setter API 时才调用 getter 函数。否则，应将默认值分配给函数的成员。有没有办法找出 struct 的成员是否被赋值？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:22:59.660

> 有没有办法找出 struct 的成员是否被赋值？

不可以。您需要自己通过一组单独的变量来跟踪这一点，或者通过将结构的值初始化为它们通常不能具有的值（例如 -1 ，但在这种情况下，每段代码都需要遵守在正常使用中不使用此类特殊值的约定）

# json - grails JSON 绑定到 LinkedHashSet 而不是 JSONArray 以实现深度嵌套关系

> ID：11513416
> 
> 赞同：1
> 
> 时间：2012-07-16T22:19:17.243
> 
> 标签：json, grails, data-binding

我在 JSON 请求中绑定了层次结构的三个层次：

```
Group -> Zone -> Segment
(1) -> (n) -> (n) 
```

在我的命令对象中，我有：

```
class GroupCommand {
    Long id 
    Set zones

} 
```

绑定 JSON 请求时，区域会正确绑定，我会得到一个 LinkedHashSet，我可以获取它的属性并与我的域对象一起使用。但是，当我开始迭代服务中的细分时：

```
groupCommand.zones.each { zone -> 
    zone.segments.each { segment ->
        //Would like to get LinkedHashMap here also
        //but get JSONArray
    }
} 
```

如上所述，理想情况下，我希望深度嵌套的 Segments 也绑定到 LinkedHashMap，但它绑定到 JSONArray。

关于如何将其绑定到 LinkedHashMap 的任何建议，因为我想避免在我的服务中操作 JSONArray 从而将我的服务与 JSON 格式耦合。

如果有一种方法可以使用 getter 在命令级别进行转换，我也完全赞成。

谢谢

编辑：

使用

```
List zones = org.apache.commons.collections.list.LazyList.decorate(new ArrayList(), new org.apache.commons.collections.functors.InstantiateFactory(ZoneCommand.class)) 
```

似乎可以工作，但底层对象仍然是 JSON 元素。然后我尝试使用：

```
List<RateZoneCommand> zones = org.apache.commons.collections.list.LazyList.decorate(new ArrayList(), new org.apache.commons.collections.functors.InstantiateFactory(ZoneCommand.class)) 
```

至少我得到一个错误，表明它试图转换：

```
Validation error: ... org.codehaus.groovy.grails.web.json.JSONArray to required type java.util.List for property zones; nested exception is java.lang.IllegalStateException: Cannot convert value of type [org..JSONObject] to required type [ZoneCommand] for property zones[0]: no matching editors or conversion strategy found. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:53:54.867

为每个级别创建一个命令类。`Zone`将- 和 -命令标记`Segment`为`@Validateable`.

在您的`GroupCommand`中，添加：

```
List zones = org.apache.commons.collections.list.LazyList.decorate(new ArrayList(), new org.apache.commons.collections.functors.InstantiateFactory(ZoneCommand.class)) 
```

在您的`ZoneCommand`中，添加：

```
List segments = org.apache.commons.collections.list.LazyList.decorate(new ArrayList(), new org.apache.commons.collections.functors.InstantiateFactory(SegmentCommand.class)) 
```

在您的表单中，只需使用`group.zones[0].segments[0]`. 如果您更改命令类的字段类型，请记住重新启动 grails 服务器。

# javascript - JQuery，在动态内容上切换一个类

> ID：11513419
> 
> 赞同：0
> 
> 时间：2012-07-16T22:19:39.203
> 
> 标签：javascript, jquery

我需要在来自 JSON 的生成内容块中添加一个类。我相信它在toggleClass 上咆哮，因为HTML 实际上还没有生成。我想我可能需要以某种方式使用 .on() 或 .live() 。

我没有收到错误，只是没有添加课程。同样，因为我相信表格内容是动态构建的。

这是相关的代码。

```
// The data variable is a block of JSON
for(i=1; i < data.length; i++){
 foo += '<tr id="'+data[i][2]+'">test</tr>';

 // Here's where I am trying to add the class, but it is not working. We check to see if a value in our JSON is true, if so - we change the class.
if(data[i][1]){
 $("#"+data[i][2]).toggleClass("newClass"); // finds the ID by unique name
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:37:42.630

toggleClass 仅适用于 DOM 对象，在您调用它时，该元素不作为 DOM 对象存在，仅作为字符串的一部分。

您可以等待切换类，直到将元素添加到 DOM 之后，将类添加到字符串中，或​​者（我的偏好）在将它们注入 DOM 之前将它们转换为元素。就像是：

```
$(foo).toggleClass("newClass").appendTo("#whatever")' 
```

# javascript - jquery：将 style.css 的链接替换为 game.css？

> ID：11513420
> 
> 赞同：1
> 
> 时间：2012-07-16T22:19:43.043
> 
> 标签：javascript, jquery, css, replace

尝试替换整个页面的内容（作品）+还将style.css的链接替换为game.css，并带有查询

```
$.get('/games/14', function(data){  var $page = $(data);
    $('head').append('<link rel="stylesheet" href="style2.css" type="text/css" />');
    //$('#layout').empty().append($page);
    $('body').empty().append($page);
}) 
```

无论我尝试什么，我似乎都无法将“style.css”更改为“game.css”，Jquery Guru 知道如何做到这一点？谢谢 ！

更新：尝试了下面的建议仍然有问题，这就是我现在正在使用的（不替换 .css 文件）

```
 $.get('/games/14', function(data){
$("link[href='style.css']").attr({href: 'game.css'});
var $page = $(data);
$('body').empty().append($page);
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:58:55.350

来吧，刚刚测试了这个，它工作。

```
<!DOCTYPE HTML>
<html>
<head>
    <script src="jquery-1.7.2.min.js"></script>
    <link href="/assets/frontend.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
    <script>
        $("link[href='/assets/frontend.css']").attr('href', '/assets/game.css');
    </script>
</body>
</html> 
```

为了回答您在下面的评论，我使用[Firebug](http://getfirebug.com/)对其进行了测试。使用控制台选项卡，我可以看到它首先尝试加载**assets/frontend.css**，运行 JS，然后尝试加载**assets/game.css**。

![加载](../Images/edb0fe3eefeb93ea0d0dc8f591bf1a94.png)

然后，我在 firebug 的 HTML 选项卡中检查了 DOM，发现链接元素的 href 属性已更新。

![在此处输入图像描述](../Images/ee7fd6f41282dc3e8a1d17892c22679e.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:24:41.527

使用 href 属性“style.css”定位链接元素，并将该元素的 href 属性替换为“game.css”：

```
$("link[href='style.css']").attr({href: 'game.css'}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:25:41.150

您可以使用 jQuery 的`attr()`函数来更改 href。

```
$("link[href=style.css]").attr('href', 'game.css'); 
```

您可能会想要使用一个更坚如磐石的选择器，但这样就可以了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T23:08:14.810

`href`其他答案中建议的属性替换由不同的浏览器不一致地处理（即可能不会触发重新流动/重新渲染）。相反，必须删除原始样式元素，并`href`在其位置插入具有所需样式的新元素。使用 jQuery 的一种直观方式：

```
$('link[href$="style.css"]').replaceWith('<link href="game.css" ... ></link>'); 
```

# silverlight - Silverlight 异步单元测试

> ID：11513422
> 
> 赞同：3
> 
> 时间：2012-07-16T22:20:03.900
> 
> 标签：silverlight, unit-testing, silverlight-toolkit, silverlight-5.0

Silverlight 单元测试框架有一个奇怪的问题。每次执行的第一个方法都会失败。我用完全相同的代码进行了第二次测试，它通过了。第一次调用它的奇怪之处在于它实际上等待超时*，然后*执行存储库调用（如果你关心的话，它下面是一个 HTTP PUT）。这是代码-第一个每次都失败，第二个每次都通过：

```
 [TestMethod]
    public void AuthShouldSucceed()
    {
        var autoResetEvent = new AutoResetEvent(false);

        _authRepository.Authenticate(_username, _password, response =>
        {
            Assert.IsTrue(response);
            autoResetEvent.Set();
        });
        if (!autoResetEvent.WaitOne(Constants.Timeout))
        {
            Assert.Fail("Test timed out.");
        } 
    }

    [TestMethod]
    public void AuthShouldSucceed2()
    {
        var autoResetEvent = new AutoResetEvent(false);

        _authRepository.Authenticate(_username, _password, response =>
        {
            Assert.IsTrue(response);
            autoResetEvent.Set();
        });
        if (!autoResetEvent.WaitOne(Constants.Timeout))
        {
            Assert.Fail("Test timed out.");
        } 
    } 
```

**编辑：** 我的最终解决方案是对 Vladmir 解决方案的修改：

```
 [TestMethod]
    [Asynchronous]
    public void AuthShouldSucceed()
    {
        var complete = false;
        var result = false;

        _authRepository.Authenticate(_username, _password, response =>
        {
            complete = true;
            result = response;
        });

        EnqueueConditional(() => complete);
        EnqueueCallback(() => Assert.IsTrue(result));
        EnqueueTestComplete();
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T08:11:25.377

如果您使用的是 Silverlight 单元测试框架，请尝试通过以下方式重写您的测试：

```
 [TestMethod]
    [Asynchronous]
    public void AuthShouldSucceed()
    {
        var done = false;
        var authResult = false;
        _authRepository.Authenticate(_username, _password, response =>
        {
            var done = true;
            authResult = response;
        });

        EnqueueConditional(() => done);
        EnqueueCallback(() => Assert.IsTrue(authResult));
        EnqueueTestComplete();
    } 
```

您的测试类应派生自 SilverlightTest 类：

```
[TestClass]
public class MyTests: SilverlightTest 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T22:46:23.187

总结所有书面内容，您应该了解为 Silverlight 编写单元测试的几个要点。

* * *

**`[Asynchronous]`**
测试方法的属性表明您正在测试包含异步操作的部分，并希望同步它们以进行测试。Silverlight 单元测试框架中的异步本身有点扭曲。所有的“入队”指令都类似于“推迟这个直到发生某些事情”，这不是传统编程异步含义所具有的意义。

* * *

**`EnqueueConditional`**
换句话说，就是等到条件满足。这是异步测试中最重要的部分之一。在条件变为合法后`EnqueueCallbacks`，直到下一个`EnqueueConditional`将被执行。

[*重要的提示：*](https://stackoverflow.com/questions/1905353/waiting-for-event-triggering-in-silverlight-unit-tests)

> `EnqueueConditional`在计时器/后台线程上重复调用传递给它的谓词，每次检查它是否返回true。

这就是为什么你应该避免在条件中使用繁重、复杂的逻辑。

* * *

**`EnqueueCallback`**
推迟代码执行，直到`EnqueueConditional`它满足条件。`Actoin`它将一个或一个数组排入队列`Actions`。

* * *

**`EnqueueDelay`**
在继续之前将最小毫秒数/时间延迟排入队列。

* * *

**`EnqueueTestComplete`**
在使用异步测试时，将要调用的动作排入队列，该动作**`TestComplete`**表示测试已完成。

*重要说明（来自文档）：*

> 如果您使用自己的方法来完成，例如 HtmlTimer 或其他线程方法，则 在使用 Timeouts 时测试超时*后可能会发生此调用。*因此，请非常小心，因为您可以完成对*下一个*测试的调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T08:15:15.950

您可以在 TestMethod 中使用 Asynchronous 关键字

```
[TestMethod]
[Asynchronous]
[Description("This test checks when NULL is passed")]

public void Testing()
{
 bool done = false;
 EnvViewModel test = new EnvViewModel ();
 .
 .

 test.AsyncCallBackCompleted += (() => done = true);

 EnqueueCallback(() => test.DataCommand.Execute(null));
 EnqueueConditional(() => done);
 EnqueueCallback(() => Assert.IsTrue(test.AADTDecisionModelList.Count == 0, 
                                             "The result does not have any data."));

 EnqueueTestComplete();
} 
```

并在 ViewModel 中创建一个委托以用于正在测试的每个方法......

```
public delegate void AsynCallComplete();
public event AsynCallComplete AsyncCallBackCompleted;
public void InformCallbackCompleted()
{
     if (AsyncCallBackCompleted != null)
     {
          AsyncCallBackCompleted();
     }
} 
```

# azure - 使用 build 创建 azure 包

> ID：11513425
> 
> 赞同：0
> 
> 时间：2012-07-16T22:20:19.637
> 
> 标签：azure, azure-deployment

我只是将我的项目从 sdk 1.3 升级到 1.7，我注意到现在当我构建应用程序时，包（cspkg）不是随构建一起创建的。我已经去点击发布来创建一个包。有没有办法告诉 VS 在每次触发构建时创建一个包。

也使用 msbuild 有办法做同样的事情。我在一个解决方案下有多个项目，其中大部分只是库，然后是这个 azure 应用程序。有没有办法用参数指定单个 msbuild 语句来告诉 azure 应用程序创建包以及构建其他项目。此外，当我指定调试时，应创建调试包，当我指定发布开关时，应创建发布包。

我怎么能在我的构建服务器上做同样的事情，我有一个 .proj 文件，它指定要构建的 sln。我怎么能提到在那里构建包的开关。

谢谢，库纳尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:45:58.820

您可以在 Windows Azure 应用程序构建设置中配置 CSPACK 命令（确保从 SDK 1.7 路径启动 CSPACK.exe，否则您将在 SDK 1.6 项目中遇到一些与架构相关的错误）作为构建后事件。这样，当您构建时，成功构建后 CSPACK 命令将运行并打包您的应用程序。同样的方式你可以配置你的 MSBuild 配置。我刚刚测试过，它对我有用。

请访问[此 MSDN 文章，](https://azure.microsoft.com/en-us/documentation/articles/cloud-services-model-and-package/#servicepackagecspkg)了解有关打包云服务的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T02:14:24.487

您也可以使用 msbuild 执行此操作。[请参阅此问题](https://stackoverflow.com/q/18117994/746754)的解决方案部分。

# c# - 如何检索 MVC 页面上所有输入的所有值

> ID：11513426
> 
> 赞同：1
> 
> 时间：2012-07-16T22:20:22.947
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, model-view-controller, razor

我有一个使用 c# 和 Razor 开始的 MVC 3 项目。我有一个页面，将使用大约 20 个输入字段。我创建 ViewModel 以将数据传递给 View 以创建页面。当用户提交表单时，我对如何获取字段的值感到困惑。

我的控制器是否必须为页面上的每个输入字段都有一个参数？有什么方法可以让控制器获取页面上的所有数据，然后我可以解析它？参数列表会很大。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:22:27.260

您可以在后续操作中使用传递给视图的相同模型作为参数。

一个例子：

```
//This is your initial HTTP GET request.
public ActionResult SomeAction() {
    MyViewModel model;

    model = new MyViewModel();
    //Populate the good stuff here.

    return View(model);
}

//Here is your HTTP POST request; notice both actions use the same model.
[HttpPost]
public ActionResult SomeAction(MyViewModel model) {
    //Do something with the data in the model object.
} 
```

第二种方法中的模型对象将自动从 HTTP 请求中包含的数据填充（技术名称是“模型绑定”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:32:01.287

在您的控制器的操作中，期望收到您传递回视图的相同“模型”。如果您正确生成了“输入控件”（通过使用`Html.TextBoxFor()`或通过将属性设置为`Name`模型属性的相同名称），这将起作用。

```
public ActionResult MyAction(MyViewModel model) 
{ 
... 
} 
```

注意 MVC 将使用 ModelBinder 来确定如何根据用户提交的字段来创建和填充预期操作的对象的属性。

如果你想捕获用户的所有输入，你可以让你的动作接收一个类型的对象`FormCollection`：

```
public ActionResult MyAction(FormCollection values) 
{ 
... 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:25:01.557

请在您的控制器中创建一个 mvc 操作，将模型作为参数

```
Like this:

[HttpPost] or [HttpGet]
public ActionResult Employee(EmployeeModel employee)
{
// now you will have all the input inside you model properties
//Model binding is doen autoamtically for you
} 
```

# iphone - iOS - 如何绘制一个带有数字/字符的圆圈？

> ID：11513445
> 
> 赞同：3
> 
> 时间：2012-07-16T22:21:58.747
> 
> 标签：iphone, objective-c, ios, cocoa

我想创建一个 UIView，它会显示一个带有数字或字符的彩色圆圈。我已经看到了创建圆圈的示例，但是我将如何实现呢？

我想在屏幕上放置多个这些视图并用线条连接它们。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-11-14T05:21:35.783

```
// Swift, iOS8
var letterLabel = UILabel(frame: CGRect(x: 50, y: 0, width: 100, height: 100))
letterLabel.layer.cornerRadius = 50
letterLabel.textAlignment = NSTextAlignment.Center
letterLabel.layer.borderWidth = 10
letterLabel.layer.backgroundColor = UIColor.blueColor().CGColor
letterLabel.font = UIFont(name: "Hoefler Text", size:75.0)
letterLabel.text = "A" 
```

![在此处输入图像描述](../Images/e03d7732ffdc7751de27c38cbdb1cd51.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:38:00.960

如果你已经知道如何画一个圆圈，那么你已经解决了一半:) 假设圆圈是在一个`UIView`被调用的`circleView`.

现在您要创建一个`UILabel`来绘制字母。

```
UILabel* circleLabel = [[UILabel alloc] init];
[circleLabel setText:@"letter goes here"]; 
```

现在您想将标签放在 顶部`circleView`，因此将其添加为子视图：

```
[circleView addSubview:circleLabel]; 
```

此时，根据 的大小`circleView`和字体大小`circleLabel`，标签可能在也可能不在圆的中心。使用 上的`setFrame`功能`circleLabel`调整其在 中的位置`circleView`。

# php - 实现贝叶斯分类器（在 PHP 中）

> ID：11513448
> 
> 赞同：0
> 
> 时间：2012-07-16T22:22:14.053
> 
> 标签：php, nlp, classification, bayesian

我有一个关于朴素贝叶斯分类器的理论问题。假设我已经使用以下训练数据训练了分类器：

```
class word  count
-----------------
pos   good  1
      sun   1
neu   tree  1
neg   bad   1
      sad   1 
```

假设我现在将“好太阳很好”归类。现在有两种选择：

1) 对保持静态的训练数据进行分类。意思是“好”和“太阳”都来自正面类别，将此字符串归类为正面。分类后，训练表保持不变。因此，所有字符串都根据静态训练数据集进行分类。

2) 您对字符串进行分类，然后更新训练数据，如下表所示。因此，下一个字符串将根据一组比这个更“高级”的训练数据进行分类。到（自动）分类结束时，最初作为简单训练集的表格将变得越来越大，已经扩展了许多单词（并更新了字数）

```
class word  count
-----------------
pos   good  2
      sun   2
      great 1
neu   tree  1
neg   bad   1
      sad   1 
```

在我的 NMB 实现中，我使用了第一种方法，但我现在怀疑我应该使用后者。请赐教:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T12:29:52.487

您实现的方法确实是构建分类器（而不仅仅是贝叶斯分类器）的流行且被接受的方式。

使用“未标记”数据（即您没有基本事实的数据）来更新分类器，是一种更先进、更复杂的技术，有时称为“半监督学习”。使用这类算法可能适合也可能不适合您的特定任务——这通常是一个反复试验的问题。

如果您确实决定将未标记的数据合并到您的模型中，您可能应该尝试其中一种流行的算法，例如[EM](http://www.kamalnigam.com/papers/thesis-nigam.pdf)。

# python - 如何避免以“0”开头的python数字文字被视为八进制？

> ID：11513456
> 
> 赞同：11
> 
> 时间：2012-07-16T22:22:42.663
> 
> 标签：python, octal, pep

我正在尝试编写一个小型 Python 2.x API 来支持获取 `job`by `jobNumber`，其中`jobNumber`以整数形式提供。有时用户会提供一个`jobNumber`以 0 开头的整数文字，例如`037537`. （这是因为它们被 R 宠坏了，R 是一种理智地认为 . 的语言`037537==37537`。）然而，Python 认为以“0”开头的整数文字是八进制，因此`037537!=37537`，而不是`037537==16223`。这让我觉得这是对最小意外原则的公然冒犯，幸运的是，这看起来在 Python 3 中已修复——参见[PEP 3127](http://www.python.org/dev/peps/pep-3127)。

但我现在坚持使用 Python 2.7。所以我的用户这样做：

```
>>> fetchJob(037537) 
```

默默地得到错误的工作（16223），或者这个：

```
>>> fetchJob(038537)
File "<stdin>", line 1
 fetchJob(038537)
            ^
SyntaxError: invalid token 
```

Python 拒绝八进制不兼容的数字。

似乎没有提供任何东西`__future__`来让我获得 Py3K 行为——它必须以某种方式内置到 Python 中，因为它至少需要对词法分析器进行更改。

有谁知道在这种情况下我可以如何保护我的用户免于得到错误的工作？目前我能想到的最好的方法是更改​​该 API，使其采用字符串而不是 int。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T22:31:12.887

> 目前我能想到的最好的方法是更改​​该 API，使其采用字符串而不是 int。

是的，我认为考虑到这种情况，这是一个合理的选择。

另一种选择是确保所有工作编号至少包含一位大于 7 的数字，以便添加前导零会立即给出错误而不是错误结果，但这似乎比使用字符串更大。

最后的选择可能是教育您的用户。只需五分钟左右就可以解释不添加前导零以及如果这样做会发生什么。即使他们由于旧习惯而忘记或意外添加了零，如果他们以前听说过，他们更有可能发现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-05T17:03:07.813

也许您可以将输入作为字符串，去掉前导零，然后转换回 int？

```
test = "001234505"
test = int(test.lstrip("0"))  # 1234505 
```

# c# - 详细版本更好还是更详细？

> ID：11513457
> 
> 赞同：0
> 
> 时间：2012-07-16T22:22:52.133
> 
> 标签：c#, winforms, generics, data-binding, datasource

我一直在以这种方式填充组合框（getRoundingMethodVals() 返回一个列表`<String`>）：

```
comboBoxRounding.DataSource = RateSetupData.getRoundingMethodVals(); 
```

...但我在 StackOverflow 上看到了以下答案：

```
comboBox1.DataSource = new BindingSource(dict, null); 
```

...这让我想知道是否应该将代码更改为：

```
comboBoxRounding.DataSource = new BindingSource(RateSetupData.getRoundingMethodVals(), null); 
```

这是一个六分之一的其他情况吗？还是一种方式比另一种方式具有强大的优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:59:30.373

取决于你想做什么。如果您只需要填充组合框以供用户选择一个值，那么您的第一种方法效果很好。这是一种单向数据流：从 lsit 到 control。在您的情况下，一个简单的 List(Of String) 不需要绑定源。

但是，如果您有一个更复杂的对象并希望更改组合框值以更改该对象的值，则可以使用 BindingSource。这将创建双向数据流。（对于这种情况，您可以使用实现许多 BindingSource 接口的 BindingList。）

# objective-c - 在不显示标签栏的情况下推送视图会删除视图的底部

> ID：11513462
> 
> 赞同：0
> 
> 时间：2012-07-16T22:23:15.727
> 
> 标签：objective-c, xcode, uiviewcontroller, uitabbarcontroller, tabbar

我试图在隐藏 uitabbar 时推送视图。被推送的视图内部有另一个视图，位于底部。每当推送此视图时，不会显示 uitabbar（这很好），但不会显示我添加的底部视图。

如何隐藏标签栏但仍显示我在底部添加的视图？

谢谢！

# linux - 如何在 Linux 中运行多个命令？做一个程序？

> ID：11513465
> 
> 赞同：2
> 
> 时间：2012-07-16T22:23:32.653
> 
> 标签：linux, command

首先，我想让您知道我是 Linux 新手。我进行了搜索，但我真的不知道我在寻找什么。

我需要做一个简单的程序，在终端中一个接一个地执行不同的命令，因为我不想每次需要时都手动运行它们。我该怎么做？我想我不能只制作一个双击触发的可执行文件，或者我可以吗？

**更新：**
当我发布这个问题时，我只是一个设法安装基于 Linux 的操作系统的孩子。我不认识其他任何拥有 Linux 或 CS 的人。我没有人问“愚蠢的问题”。我不知道如何表达自己。我一直在寻找一个 shell 脚本指南，但我找到的“linux 编程”只是 C，这超出了我的深度。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-16T22:26:53.857

您所指的简单程序通常称为“ [shell](http://en.wikipedia.org/wiki/Unix_shell)脚本”。本质上，您只需在一个文件中收集一些您想要的命令，然后执行它们。您还可以对更复杂的脚本进行某种流控制（循环、if-else 语句等）。

要构建一个简单的[bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29) shell 脚本，我们称之为它`myscript.sh`，按照以下步骤操作：

在“myscript.sh”源文件的第一行放置（见下面的*注释*）

```
#!/bin/bash 
```

然后是您的命令，例如用于演示目的

```
echo "hello, I'm coming from the script file"
ls -l 
```

保存文件。

要使这个文件“可执行”类型

```
$ chmod +x myscript.sh 
```

然后你应该能够从命令行运行这个文件

```
$ ./myscript.sh 
```

您会看到 echo 命令的输出“*你好，我来自脚本文件*”，然后是长格式的目录列表。

以下是[bash 教程](http://linuxconfig.org/Bash_scripting_Tutorial)和[Bash 初学者指南的](http://tldp.org/LDP/Bash-Beginners-Guide/html/)链接。

[最后，有时您可以使用aliases](http://en.wikipedia.org/wiki/Alias_%28command%29)将几个命令串在一起，尽管大多数人只是“别名”较短版本的常用命令，为命令创建缩写。

*注意重新定位`bash`*：

要找出你的`bash`shell 在哪里，你总是可以输入`which bash`，它会返回一个路径/目录，所以如果它不同，就把它放在顶部。例如，如果它说`/usr/bin/bash`您将把`#!/usr/bin/bash`它放在`#!/bin/bash`脚本的第一行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T22:27:32.737

尝试编写一个 shell 脚本：

```
#!/bin/bash

command1
command2 | grep 'something' | pager
foo | perl -ne 'print' 
```

另存为`something.sh`.

用 . 将其标记为可执行文件`chmod +x something.sh`。

然后`cd`到它所在的目录并运行`./something.sh`.

是否可以双击启动脚本取决于您的配置，但由于大多数脚本创建文本输出，这通常没有意义。使用`.desktop`文件创建单个 (!) 命令（或您的桌面环境 (gnome/kde/xfce) 支持的任何文件类型）的快捷方式。

如果您的需求超出了一些简单的 bash，请查看脚本语言，例如面向对象的 Python 或经典的 *nix 管理语言 Perl。

查看@Levon 的帖子了解更多详情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:25:17.763

您正在寻找的是一个脚本。最常见的类型是用 bash 编写的。一个不错的选择是用 python 编写它们。

查看 bash 脚本示例以帮助您入门，或查看[http://www.diveintopython.net/](http://www.diveintopython.net/)以开始使用 Python

# c - 如何编写比特流

> ID：11513466
> 
> 赞同：7
> 
> 时间：2012-07-16T22:23:44.917
> 
> 标签：c, bit-manipulation, bitstream

**我正在考虑使用C**将一些数据写入位流。有两种方法可以想到。一种是将可变位长符号连接成一个连续的位序列，但这样我的解码器可能很难将这些符号从这个连续的位流中分离出来。另一种方法是为哪个符号分配相同数量的比特，这样解码器可以轻松恢复原始数据，但可能会浪费比特，因为符号具有不同的值，这反过来会导致比特流中的许多比特零（我猜这是浪费位）。

任何提示我应该做什么？

我是编程新手。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:08:12.380

听起来您正在尝试做一些类似于 Huffman 压缩方案的事情？我会逐字节（char）并跟踪我读取最后一个符号的字节内的偏移量。

假设您的任何符号都不会大于 char。它看起来像这样：

```
struct bitstream {
   char *data;
   int data_size;           // size of 'data' array
   int last_bit_offset;     // last bit in the stream 

   int current_data_offset; // position in 'data', i.e. data[current_data_offset] is current reading/writing byte
   int current_bit_offset;  // which bit we are currently reading/writing
}

char decodeNextSymbol(bitstream *bs) {

}

int encodeNextSymbol(bitstream *bs, char symbol) {

} 
```

decodeNextSymbol 和 encodeNextSymbol 的匹配代码必须使用 C 按位​​运算（例如，'&'（按位与）和 '|'（按位或）。然后我会列出所有符号的列表，以最短的优先，然后做一个匹配最短符号的while循环。例如，如果你的一个符号是'101'，那么如果流是'1011101'，它将匹配第一个'101'并继续匹配流“1101”的其余部分您还必须处理符号值从一个字节溢出到下一个字节的情况。

# facebook - setsize 今天停止工作

> ID：11513468
> 
> 赞同：0
> 
> 时间：2012-07-16T22:24:06.797
> 
> 标签：facebook, iframe, height, facebook-javascript-sdk

我有几个 iframe 应用程序今天停止垂直调整大小。有没有其他人注意到一个问题？这是我的代码的一小段摘录，它在几个应用程序上调整大小：

```
if (appsettings.minheight != "null") 
{
    FB.XFBML.parse();
    FB.Canvas.setSize({ width: '810px', height: appsettings.minheight + "px" });        
    FB.Canvas.scrollTo(0,0);
} 
```

appsettings.minheight 确实有一个值，而且最近运行良好。从文档：

> ```
> Note: this method is only enabled when Canvas Height is set to "Settable (Default: 800px)" in the Developer App. 
> ```

我仔细检查了这一点，应用程序设置都设置为流畅，但这种情况已经有一段时间了。我今天早些时候尝试切换到固定（并设置一个值），但仍然没有运气。我没有名为“可设置”的设置。

谢谢，

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T14:19:54.517

尝试不使用[文档](https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setSize/)中的“px” ：`FB.Canvas.setSize({ width: 640, height: 480 });`

# python - 为什么会有idlelib.sys

> ID：11513477
> 
> 赞同：0
> 
> 时间：2012-07-16T22:24:46.720
> 
> 标签：python, import, python-2.7, python-2.x

我所做的是以下内容：

```
Python 2.7.2 (default, Jun 12 2011, 15:08:59) [MSC v.1500 32 bit (Intel)] on win32
Type "copyright", "credits" or "license()" for more information.
>>> import sys
>>> print sys.modules['idlelib.sys']
None
>>> 'idlelib.sys' in sys.modules
True 
```

为什么会有这个空模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:16:34.333

似乎它标志着模块加载缓存未命中，请参见[此处](http://mail.python.org/pipermail/python-dev/2001-April/014136.html)。

# arrays - 一维数数组聚类

> ID：11513484
> 
> 赞同：102
> 
> 时间：2012-07-16T22:25:01.023
> 
> 标签：arrays, cluster-analysis, data-mining, dimension, partition-problem

所以假设我有一个这样的数组：

```
[1,1,2,3,10,11,13,67,71] 
```

有没有一种方便的方法可以将数组分区成这样的东西？

```
[[1,1,2,3],[10,11,13],[67,71]] 
```

我查看了类似的问题，但大多数人建议使用 k-means 来聚类点，例如[scipy](http://docs.scipy.org/doc/scipy/reference/cluster.vq.html#)，对于像我这样的初学者来说使用起来非常混乱。另外我认为 k-means 更适合二维或更多维聚类，对吧？有什么方法可以根据数字将 N 个数字的数组划分为多个分区/聚类？

有些人还建议进行严格的范围划分，但它并不总是按预期呈现结果

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-07-17T05:38:50.717

不要对一维问题使用多维聚类算法。一个维度比你天真的想的要特殊*得多*，因为你实际上可以对它进行*排序*，这让事情变得容易多了。

事实上，它通常甚至不称为聚类，而是例如分割或自然中断优化。

您可能想查看[Jenks Natural Breaks Optimization](https://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)和类似的统计方法。**[核密度估计](https://en.wikipedia.org/wiki/Kernel_density_estimation)**也是一种很好的查看方法，具有强大的统计背景。密度的局部最小值是将数据分成集群的好地方，这样做有统计上的原因。KDE 可能是对一维数据进行聚类的最可靠的方法。

使用 KDE，一维数据表现得更好，这一点再次变得明显。在一维中，您有局部最小值；但在 2D 中，您可能有鞍点和这样的“可能”分裂点。请参阅此[鞍点的维基百科插图](http://en.wikipedia.org/wiki/File:Saddle_pt.jpg)，了解这样的点可能适合或不适合拆分集群。

有关如何在 Python 中执行此操作的示例，请参[见此答案（绿色标记是集群模式；红色标记是数据被切割的点；y 轴是密度的对数似然）：](https://stackoverflow.com/a/35151947/1060350)

[![KDE 与 Python](../Images/1bc0aee71a8c8898a215e4f96a858c16.png)](https://i.stack.imgur.com/inGb2.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2021-07-06T13:02:46.080

这个简单的算法有效：

```
points = [0.1, 0.31,  0.32, 0.45, 0.35, 0.40, 0.5 ]

clusters = []
eps = 0.2
points_sorted = sorted(points)
curr_point = points_sorted[0]
curr_cluster = [curr_point]
for point in points_sorted[1:]:
    if point <= curr_point + eps:
        curr_cluster.append(point)
    else:
        clusters.append(curr_cluster)
        curr_cluster = [point]
    curr_point = point
clusters.append(curr_cluster)
print(clusters) 
```

上面的示例将点聚类到一个组中，使得组中的每个元素最多`eps`远离组中的另一个元素。这类似于具有 的聚类`DBSCAN`算法`eps=0.2, min_samples=1`。正如其他人所指出的，一维数据可以让您直接解决问题，而不是使用更大的枪，例如`DBSCAN`.

对于一些`<1000`包含我测试过的元素的小型数据集，上述算法要快 10-100 倍。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-18T10:14:33.700

您可以寻找离散化算法。一维离散化问题与您所要求的非常相似。他们根据频率、分箱策略等决定截止点。

[weka](https://waikato.github.io/weka-wiki/discretizing_datasets/)在其离散化过程中使用以下算法。

> weka.filters.supervised.attribute.Discretize
> 
> 使用 Fayyad & Irani 的 MDL 方法或 Kononeko 的 MDL 标准
> 
> weka.filters.unsupervised.attribute.Discretize
> 
> 使用简单的分箱

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-05-20T01:30:35.913

[CKwrap](https://github.com/djdt/ckwrap#readme)是一个快速而直接的 k-means 聚类函数，虽然文档有点少。

## 示例用法

点安装ckwrap

```
import ckwrap

nums= np.array([1,1,2,3,10,11,13,67,71])
km = ckwrap.ckmeans(nums,3)

print(km.labels)
# [0 0 0 0 1 1 1 2 2]

buckets = [[],[],[]]
for i in range(len(nums)):
    buckets[km.labels[i]].append(nums[i])
print(buckets)
# [[1, 1, 2, 3], [10, 11, 13], [67, 71]]
exit() 
```

我希望作者打算让您使用 nd 数组功能，而不是创建列表列表。

其他措施：

```
km.centers
km.k
km.sizes
km.totss
km.betweenss
km.withinss 
```

底层算法基于这篇[文章](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5148156/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-28T18:39:52.893

迟到的回应，只是为了记录。[您可以使用Ckmeans.1d.dp](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5148156/)对一维数组进行分区。

这种方法保证了最优性，它是 O(n^2)，其中 n 是观察次数。实现是在 C++ 中，在 R 中有一个包装器。

# javascript - 如何格式化Javascript循环html表

> ID：11513486
> 
> 赞同：0
> 
> 时间：2012-07-16T22:25:02.147
> 
> 标签：javascript, ajax

我的表格列是`amount, price, value, date, notes`

`addCommas`并且`round`是格式化函数

json数据看起来像这样

```
[{"amount":"19905405",
  "price":"3.7",
  "value":"736500",
  "date":"2012-02-29", 
  "notes":""
},
{"amount":"10000000",
 "price":"2",
 "value":"200000",
 "date":"2011-12-05",
 "notes":"test one only"
 }] 
```

在里面`$.ajax({... success:function(store){...`这是我绘制表格的javascript循环

```
$("#table_a").empty();

var table = '<tbody><tr><td style="ba.....rest of header row string';
$.each(store, function(row, i) {
   table += '<tr>';
   table += '<td><span>' + addCommas(round(i/1000000,2)) + "m" + '</span></td>';
   table += '<td><span>' + i + '</span></td>';
   table += '<td><span>' + "$" + addCommas(round(i/1000000,2)) + "m" + '</span></td>';
   table += '<td><span>' + i + '</span></td>';
   table += '<td><span>' + i + '</span></td>';
   table += '</tr>';
});
table += '</tr></tbody>';
$("#table_a").append(table); 
```

最终结果目前看起来像这样

![在此处输入图像描述](../Images/1639246fb6b5b01ae313a95f14b44609.png)

如何正确循环以将格式添加到单元格数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:24:19.897

知道了...

```
$("#table_a").empty();

var table = '<tbody><tr><td style="ba.....rest of header row string';
$.each(store, function(i, data) {
   table += '<tr>';
   table += '<td><span>' + addCommas(round(store[i].amount/1000000,2)) + "m" + '</span></td>';
   table += '<td><span>' + store[i].price + '</span></td>';
   table += '<td><span>' + "$" + addCommas(round(store[i].value/1000000,2)) + "m" + '</span></td>';
   table += '<td><span>' + store[i].date + '</span></td>';          
   table += '<td><span>' + store[i].notes + '</span></td>';
   table += '</tr>';
});
table += '</tr></tbody>';
$("#table_a").append(table); 
```

谢谢菲尔杰克逊

[https://stackoverflow.com/a/2529958/1185018](https://stackoverflow.com/a/2529958/1185018)

# php - PHP mkdir 在 rmdir 之后不起作用

> ID：11513488
> 
> 赞同：2
> 
> 时间：2012-07-16T22:25:06.477
> 
> 标签：php, permissions, mkdir, rmdir

我有一段代码可以测试目录是否存在，如果存在则将其删除，并在其上创建一个新目录。它应该相当简单。

```
if(is_dir($directory)){
    $files = new RecursiveIteratorIterator(
              new RecursiveDirectoryIterator($directory,RecursiveDirectoryIterator::SKIP_DOTS),
              RecursiveIteratorIterator::CHILD_FIRST
            );
    foreach($files as $fileinfo){
        $todo = ($fileinfo->isDir() ? 'rmdir' : 'unlink');
        $todo($fileinfo->getRealPath());
    }
    rmdir($directory);
    //var_dump(is_dir($directory));
}

clearstatcache();
mkdir($directory,0744); 
```

如果该目录尚不存在，则`mkdir()`工作正常。但是如果目录确实存在，`rmdir()`循环就会完成它的工作，但是 PHP 会抛出一个错误：

```
PHP Error[2]: mkdir(): Permission Denied 
```

注释`var_dump()`行告诉我 PHP 仍然认为`$directory`是一个目录，即使在`rmdir()`调用之后。所以我用`clearstatcache()`它来更新它，但它仍然不会检测到该目录已被删除。当我在文件系统中查找时，该目录实际上已被删除。

如果我再次运行脚本（当目录消失时），它工作得很好。

谁能弄清楚如何解决这个错误？如果它有所作为，我将在我的 Win7/XAMPP 开发环境中将其作为 PHP 命令行脚本运行。

编辑：

感谢 Wee Kiat 和 Phillip 的回答。解决方案是使用`unset($files)`before`rmdir()`关闭递归迭代器，该迭代器仍然保持`$directory`打开状态并导致`mkdir()`阻塞。请参阅下面的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T03:09:45.553

似乎 $files 是导致问题的变量，您需要做的是在 foreach 循环之后取消设置 $files，您将能够 mkdir()。

```
if(is_dir($directory)){
    $files = new RecursiveIteratorIterator(
              new RecursiveDirectoryIterator($directory,RecursiveDirectoryIterator::SKIP_DOTS),
              RecursiveIteratorIterator::CHILD_FIRST
            );
        foreach($files as $fileinfo){
            $todo = ($fileinfo->isDir() ? 'rmdir' : 'unlink');
            $todo($fileinfo->getRealPath());
        }

    unset($files);

    rmdir($directory);
    //var_dump(is_dir($directory));
}
mkdir($directory,0744); 
```

但我不知道为什么 $files 会导致问题。有任何想法吗？

# ruby-on-rails - ajax 和 rails 3.x

> ID：11513489
> 
> 赞同：0
> 
> 时间：2012-07-16T22:25:10.230
> 
> 标签：ruby-on-rails, ajax

我正在尝试在 Rails 应用程序中使用 Ajax 更新我的 index.html.erb 文件中的 div，但在这一点上，由于缺乏良好的解释性教程，我完全感到困惑和沮丧（据我所知） ） 在网上。

我目前有一个 index.html.erb 文件，其中包括以下块：

```
<table  border="1">
<% @dbs.each do |db| %>
<tr>
    <td ><%= link_to db, :action => :show, :db => db,  :remote => true %></td>
</tr>
<% end %>
</table>
<div id="collections">

</div> 
```

我的索引控制器只是在那里初始化@dbs var，就是这样，它没有任何respond_to块。我想更新#collections div，但我很难理解如何去做？

更新 - 控制器类：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:56:15.370

您可以使用以下代码创建 show.js.erb：

```
comment_partial = '<%= escape_javascript(
  render('my_partial')
) %>';
$('collection').html(comment_partial); 
```

显然，使用部分不是强制性的。它只是带有 JQuery 的 JS。

您应该替换此代码：

```
respond_to do |format|
  format.js
end 
```

这样 ：

```
render :format => :js 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:55:46.743

在控制器的视图文件夹中创建一个 show.js.erb 文件，并编写类似的 js 代码

```
$("#collections").dostuff(); 
```

# java - Java arraylist 添加数量

> ID：11513496
> 
> 赞同：1
> 
> 时间：2012-07-16T22:26:00.643
> 
> 标签：java, arrays, if-statement, add

我在比较从另一个类导入的 myProduct.setRefno(product.getRefno()) 的属性以及描述、价格和数量时遇到问题。我需要能够输入 a`refno`并且如果篮子容器中存在参考编号，那么我只添加数量而不是所有项目详细信息：

目前程序的工作方式如下：

```
ref1 description1 price1 1(qty)
ref2 description2 price2 1(qty)
ref1 description1 price1 1(qty) 
```

但是我希望它是：

```
ref1 description1 price1 2(qty)
ref2 description2 price2 1(qty) 
```

如果它是相同的 refno，那么它只添加数量。

```
public class Zapper {

    public static void main(String[] args) throws ItemException {
        System.out.println("\n\nThis is Purchases\n\n");

        Products stock=new Products();// Define Variable 
        Products basket=new Products();// Define Variable 
        Purchase product;
        String refno;
        int offer;
        int count;
        int grandtotal;         
        char option;//char variable option

        boolean finished=false;//variable "boolean" set 

        while (!finished) { 
            try {
                option=Console.askOption("\n A)dd P)rint R)emove Q)uit");
                stock.open("stock.lin");
                switch (option) {   
                    case 'A': 
                        product= new Purchase();
                        refno= Console.askString("Enter Ref No:..");
                        product=(Purchase)stock.find(refno);//cast operator 
                        if ( product == null) {
                            System.out.println("Cannot find Ref No");
                        } else {
                            product.print("");
                            Purchase myProduct = new Purchase();
                            myProduct.setRefno(product.getRefno());
                            myProduct.setDescription(product.getDescription());
                            myProduct.setPrice(product.getPrice());
                            myProduct.setQty(1);
                            myProduct.setOffer(product.getOffer());
                            basket.add(myProduct);//add the value of item into Container stock  
                        }
                        break;//end of case statement Add

                    case 'R': 
                        refno= Console.askString("Enter Ref No:..");
                        Product myProduct = new Product();
                        myProduct=(Purchase)basket.find(refno);//cast operator
                        myProduct.setQty(1);
                        if ( myProduct == null)
                            System.out.println("Cannot find Ref No");

                        else {
                            basket.remove(myProduct);
                            basket.print("");   
                        }
                        break;//end of case statement Find

                    case 'P': 
                        basket.print("\nYou have purchased...");
                        break;//end of case statement Print             
                    case 'Q': 
                        finished=true;
                        break;//end of case statement "Q" 
                    case '\0':/*Do Nothing*/
                        break;//end of case statement "Do Nothing"
                    default:    
                        System.out.println("Error: Invalid Option ");
                        break;//end of case statement default
                }
            } catch (ItemException e) {
                System.out.println(e.getMessage());
            } catch (IOException e) {
                System.out.println(e.getMessage());
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }   
        }
        System.out.println("\n\nPurchases Finished \n\n");
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:49:55.950

您只需要更改班级`add`中的 - 方法即可。`Products`假设您将`Purchase`-objects 存储在`Product`类的 List 中，它可能看起来像这样：

```
private List<Purchase> products; 

public void add(Purchase product) {
    String refNo = product.getRefno();
    for (Purchase p : this.products) { //for every product
        if (p.getRefno().equals(refNo)) { //if two refNumbers equals
            p.setQty(p.getQty() + product.getQty()); //add the desired quantity
            return; //force method to abort
        }
    }
    this.products.add(product); //otherwise, add the new product
} 
```

虽然，我不得不说我发现你的一些类名称有点不寻常。请记住，它们应该始终对它们实际代表的内容给出一个很好的提示，例如，您的`Purchase`类看起来更像`Product`. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:18:22.290

如果您使用一些适当的 OOP 编码技术，您的很多问题都会消失。

让我们从类的结构开始。

```
public class Zapper {
    public static void main(String[] args) throws ItemException {
        System.out.println("\n\nThis is Purchases\n\n");

        Products stock=new Products();// Define Variable 
        Products basket=new Products();// Define Variable 
        Purchase product;
        String refno;
        int offer;
        int count;
        int grandtotal;         
        char option;//char variable option

        //Do the work...
    }
} 
```

首先，在任何情况下都不应该 main 抛出异常，更不用说像 ItemException 这样的特定异常。所有这些事情都应该由程序优雅地处理。其次，您实例化了一堆真正应该作为类中的成员字段保存的对象，`Zapper`.

这可能更符合您的要求：

```
public class Zapper {
    //These things will stay throughout the program
    private Products stock = new Products();
    private Products basket = new Products();
    private Purchase product;
    private boolean quitSignalReceived = false;
    private Set<Option> options;//A list of keyboard inputs

    public static void main(String[] args) {
        System.out.println("\n\nInitiating Purchase of items\n\n"); //use a proper entrance message to your program

        Zapper zapper = new Zapper();//Create an object! Sets up all class variables on construction.
        zapper.run();//Let a method handle running the program.

        System.out.println("\n\nPurchases Finished \n\n");//Say goodbye!
    }

    public void run() {
        //actually does the work!
    }
} 
```

现在你只需要专注于做什么`run()`。具体来说，它处理您的“主循环”：

```
public void run() {
    boolean finished = false;
    stock.open("stock.lin"); //Should happen every time we enter the run() loop
    while (!finished) {
      option=Console.askOption("\n A)dd P)rint R)emove Q)uit");
      processOption(option);
      if (quitSignalReceived) {
          //Do anything that MUST happen before the program quits.
          finished = true;
      }
    }
} 
```

您已经敏锐地注意到此时我们需要在其中添加选项并对其进行处理。

```
public Zapper() {
   this.options.add(new AddOption());
   this.options.add(new QuitOption());
   //etc.
}

public class Option {
  //Constructor, etc.

  process(String option) {
    for (Option o : options) {
      if (o.getKey.equals(option)) {
        o.process(this);
      }
    }
  }
} 
```

这自然需要一个抽象类 Option，您可以将其子类化：

```
public abstract class Option {
  public String getKey();//returns the keyboard key associated with this option
  public void process(Zapper z); //actually does what you need the option to do. 
} 
```

让我们考虑一下您的“A”案例：

```
case 'A': 
                    product= new Purchase();
                    refno= Console.askString("Enter Ref No:..");
                    product=(Purchase)stock.find(refno);//cast operator 
                    if ( product == null) {
                        System.out.println("Cannot find Ref No");
                    } else {
                        product.print("");
                        Purchase myProduct = new Purchase();
                        myProduct.setRefno(product.getRefno());
                        myProduct.setDescription(product.getDescription());
                        myProduct.setPrice(product.getPrice());
                        myProduct.setQty(1);
                        myProduct.setOffer(product.getOffer());
                        basket.add(myProduct);//add the value of item into Container stock  
                    }
                    break;//end of case statement Add 
```

首先，你是`new()`你的产品，它实例化了一个对象。两行之后，您将变量完全设置为另一个对象。其次，您从不返回对象的方法中获取该对象`Purchase`，您应该不惜一切代价避免这种情况，并至少封装以防止未来的变化。然后你就会`if`反对`null`——这是你应该始终避免的另一种做法。

在添加产品的情况下，您希望 Option 子类的 process 方法如下所示。

```
public void process (Zapper zap) {
    refno= Console.askString("Enter Ref No:..");
    Purchase stockItem;
    bool success = zap.getPurchase(refno, item);
    if ( !success ) {
        System.out.println("Item not in stock.");//Errors should make sense!
    } else {
        zap.addToBasket(stockItem);
    }
} 
```

这需要将以下方法添加到`Zapper`：

```
public bool findPurchase(String refno, Purchase item) {
    item = this.stock.find(refno);
    if (item == null) { return false; }
}

public void addToBasket(Purchase item) {
    //actually do the work to add it to your purchases.
} 
```

和产品：

```
//This method copies the object into a new object and returns it.
public Purchase getPurchaseItem() {
    Purchase myProduct = new Purchase();
    myProduct.setRefno(product.getRefno());
    myProduct.setDescription(product.getDescription());
    myProduct.setPrice(product.getPrice());
    myProduct.setQty(1);
    myProduct.setOffer(product.getOffer());
} 
```

现在，请注意，如果您更改此设置，则会为您完成大量工作： private Products stock = new Products(); 私人产品篮=新产品（）；

为此： private Map stock = new HashMap(); 私有地图篮 = new HashMap();

在这种情况下，您对 increment-or-add 的调用将如下所示：

```
if (basket.containsKey(item)){
    int quantity = basket.get(item) + 1;
    basket.set(item, quantity);
} else {
    basket.set(item, 1);
} 
```

虽然这很长，但它涉及许多可以清理此代码的方法，将责任放在它所属的地方和最简单的地方，并解决你的问题。如果`Map`该类不足以满足您的需求，您可能会考虑这样一种情况，即您有一个`Item`包含库存商品的`PurchasedItem`类和一个扩展该商品的类，这就是您购买的东西。那完全是另外一回事了。

# python - Python对文件夹中的文件进行操作-'for file in folder'

> ID：11513497
> 
> 赞同：3
> 
> 时间：2012-07-16T22:26:11.130
> 
> 标签：python, file, memory, directory

我知道一个文件夹的路径，并且对于文件夹中的每个文件我都想做一些操作。所以基本上我正在寻找的是一种`for file in folder`代码，它可以让我访问变量中的文件。

这样做的 Python 方法是什么？

谢谢

编辑 - 示例：我的文件夹将包含一堆 XML 文件，并且我已经有一个 python 例程来将它们解析为我需要的变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:29:53.060

这将允许您访问和打印当前目录中的所有文件名：

```
import os

for filename in os.listdir('.'):
   print filename 
```

[os](http://docs.python.org/library/os.html)模块包含有关可用的各种功能的更多信息。[os.listdir()](http://docs.python.org/library/os.html?highlight=listdir#os.listdir)函数还可以采用您想要指定的任何其他路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T22:30:24.357

[glob](http://docs.python.org/library/glob.html)库看起来有用吗？

它将执行一些模式匹配，并接受绝对地址和相对地址。

```
>>> import glob
>>> for file in glob.glob("*.xml"):    # only loops over XML documents
        print file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-04T22:33:27.343

对于从 python 3.5 或更高版本开始的人来说，我们现在拥有优越的 os.scandir() ，它比 os.listdir() 具有巨大的性能改进

有关改进/好处的更多信息，请查看[https://benhoyt.com/writings/scandir/](https://benhoyt.com/writings/scandir/)

# javascript - 创建 JavaScript 函数以更改先前声明的变量

> ID：11513498
> 
> 赞同：0
> 
> 时间：2012-07-16T22:26:12.040
> 
> 标签：javascript, string, function, variables, getelementbyid

我无法在包含大量 PHP 和 JavaScript 的页面上更改变量。

这部分对我来说工作正常：

```
<script language="javascript" type="text/javascript">
function changebg(my)
{
    document.getElementById("imglayer").style.backgroundImage ='url('+ my.src +')';
    document.getElementById("cropframe").style.backgroundImage ='url('+ my.src +')';
}
var test2 = new String("url('+ my.src +')");
</script>

<img src="../../uploads/595MCoDFyArFFe.jpg" width="50" height="50" onclick="changebg(this)" >
<img src="../../uploads/P6l6J8aqzli6gh.jpg" width="50" height="50" onclick="changebg(this)" >
<img src="../../uploads/stXWS8fL4L3nvs.jpg" width="50" height="50" onclick="changebg(this)" > 
```

稍后调用 div ID。

我的问题是我需要动态更改另一个变量：

```
<script type="text/javascript">
    var test1 = new String( "<?php $src_name = '" );
    var test2 = new String( "956ENbXjzTlkBo.jpg" );
    var test3 = new String( "'; // modify this, original file?>");" );
    document.write( String( test1, test2, test3 );
</script> 
```

我需要`var test2`用 div ID 抓取的另外两个进行更改。如何更改该字符串值？这甚至可能吗？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:40:27.420

首先，这不是 Java（即使在 Java 中你也不需要它）。你不应该使用`new String(…)`; 只需使用字符串文字：

```
var test1 = "…"; 
```

等等

其次，字符串是不可变的；您不能更改字符串值/对象；您只能创建和分配一个新字符串。但是，您也可以创建一个用户定义的`Object`实例，该实例具有根据其他值（如变量值）返回值的方法：

```
var test2 = {
  toString: function () {
    return "foo" + test1 + "bar";
  }
}; 
```

[`document.write()`DOM 方法](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-75233634)将其参数隐式转换为字符串，这是通过调用 hull 对象`toString()`或`valueOf()`方法来完成的，以先可用者为准（请参阅[ECMAScript 语言规范，5.1 版，第 9.8 节](http://ecma-international.org/ecma-262/5.1/#sec-9.8)）。所以

```
document.write(test2); 
```

相当于

```
document.write(String(test2)); 
```

（[第 15.5.1 节](http://ecma-international.org/ecma-262/5.1/#sec-15.5.1)）或

```
document.write(test2.toString()); 
```

它将写入 的值所`toString()`引用的对象的方法的返回值`test2`。（对于输出的动态变化，您需要使用其他 DOM 功能，例如标准兼容[`textContent`](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent)、[`nodeValue`](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-F68D080)或专有[`innerHTML`](http://www.w3.org/TR/2008/WD-html5-20080610/dom.html#innerhtml0)属性。）

顺便说一句，`String`构造函数只考虑一个参数（见上文），因此`new String(x, y, z)`等价于`new String(x)`. 也许您正在寻找连接：`new String(x + y + z)`. 但是，如果至少一个操作数是 类型`String`，`x + y + z`就足够了；如果没有，`String(x) + y + z`或者`"" + x + y + z`工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:45:03.230

只需使用正确的引号：

```
var test2 = new String("url(" + my.src + ")"); 
```

或者简单地说：

```
var test2 = "url(" + my.src + ")"; 
```

但是，您不能通过从 Javascript 编写 php 代码来更改 php 变量。当 Javascript 运行时，php 脚本已经结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:47:48.363

首先，您在构建字符串时采用了一种非常奇怪的方式。我认为这样做的目的是，在所有这些结束时，最终得到一个如下所示的字符串：

```
<?php $src_name = 'X'; // modify this, original file ?> 
```

（这会输出 PHP，它不会被您的 Web 服务器解释，但我假设您知道这一点并且您出于其他原因输出它。）

`x`在其他 DOM 元素中可用的某些数据在哪里（`img`可能是您的元素之一，因为文件名相似）。如果您想在将来发生一些任意事件后更新`x`已打印到页面的此值。你需要给自己一些有形的元素来更新——例如，一个`span`元素。

试试*这个*：`document.write()`_

 *```
document.write("&lt;?php $src_name = '<span id=\"my-element\">X</span>'; // modify this, original file ?&gt;"); 
```

请注意，我已将您的 < 和 > 更改为它们的编码等效项。

然后，您可以`span`在以后更新您使用的 JavaScript 的内容（见下文）。这不会更改您声明的*变量*，而是更改页面的内容。由于您只是在最后打印您的字符串（或者，因为 String() 不会像您认为的那样连接给定的字符串），所以在我看来这就是您的意思试图完成。

```
document.getElementById("my-element").innerText = "NEW VALUE"; 
```

同样，这本身并不更新*变量*，只是更新您正在打印到页面的文本。无论如何，这似乎是您的最终目标，如果我错了，请纠正我。*

# database - 多个表或多个字段

> ID：11513501
> 
> 赞同：0
> 
> 时间：2012-07-16T22:26:22.700
> 
> 标签：database, cakephp, database-design, relational-database

最好的方法是什么？为什么？

这是我数据库设计的一部分的快速浏览，我正在寻找组织这些数据的最佳方法。

```
"Leads" has many "Students", Leads has many "Contacts"

"Students" belongs to "Leads" and belongs to "People"
   id, person_id, lead_id

"Contacts" belongs to "Leads" and belongs to "People"
   id, person_id, lead_id 
```

我希望能够表明哪个联系人将成为“付款人”，以及一个联系人是否是主要联系人。

我原本以为我会再添加两个这样的表：

```
"PrimaryContacts" belongs to "Contacts"
   id, contact_id
"Payer" belongs to "Contacts"
   id, contact_id 
```

然后我意识到添加另外两个表似乎有点过头了，我可以像这样在初始联系人表中轻松表示

```
"Contacts"
  id, person_id, lead_id, type, payer 
```

然后我可以将类型设置为 1 或 2，表示主要或次要，然后付款人字段将是 1 或 2，表示他们正在支付或不支付。

以一种或另一种方式做这件事有什么好处，或者这有关系吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:34:34.030

我不得不承认我对您的要求有点困惑，但是从字面上解释您所说的似乎会导致以下数据库模型：

![在此处输入图像描述](../Images/2125c36c9e6349bd91e1daea76b3e45e.png)

* * *

该`Contacts.payer`标志使您可以拥有任意数量的付款人，无论他们的主要状态如何。

在这种情况下，确实不需要单独的`Payer`表。

* * *

是`Leads.primary_contact_id`一个 NULL-able FK `Contacts`，这让你有 0 或 1 个主要联系人每个潜在客户（为避免 0 个主要联系人的可能性，你需要一个 NOT NULL，但这会导致插入周期，这必须通过延迟约束来解决，这在 MySQL 中不受支持）。

**但是**，这并不能保证主要联系人属于其自己的潜在客户（即，即使匹配`Contacts.lead_id`也可能不同）。那是问题吗？如果是，您将需要一个自由的应用程序来识别关系和复合 PK，这可能是 ORM 的一个问题。`Leads.lead_id``Contacts.contact_id``Leads.contact_id`

单独`PrimaryContacts`的表将具有与`Leads.primary_contact_id`（假设您的 PK 正确）非常相似的效果，甚至会出现允许 0 个主要联系人和潜在客户不匹配的问题。从数据库的角度来看，仅仅拥有一个“向后”的 FK 更简单、更有效（尽管我不确定从 CakePHP 的角度来看是否仍然如此）。

不幸的是，我对 CakePHP 并不熟悉——希望你能够自己“翻译”这个模型。

# ruby-on-rails - Twitter Bootstrap 列在某些屏幕尺寸上无法正确显示

> ID：11513503
> 
> 赞同：0
> 
> 时间：2012-07-16T22:26:44.870
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在使用 Twitter Bootstrap 开发一个网站。

我有一排有 4 列：

```
%ul.thumbnails
  %li.span3
  .thumbnail
    %a{href:"#"}
      %img{src:"http://placehold.it/260x180", alt:""}
    .thumb_info
      %h5= truncate("Dot. The world smallest stop motion", length:25)
      %p
        %i.icon-eye-open
        11
        %i.icon-heart
        1  

 %li.span3
  .thumbnail
    %a{href:"#"}
      %img{src:"http://placehold.it/260x180", alt:""}
    .thumb_info
      %h5= truncate("Dot. The world smallest stop motion", length:25)
      %p
        %i.icon-eye-open
        11
        %i.icon-heart
        1
 %li.span3
  .thumbnail
    %a{href:"#"}
      %img{src:"http://placehold.it/260x180", alt:""}
    .thumb_info
      %h5= truncate("Dot. The world smallest stop motion", length:25)
      %p
        %i.icon-eye-open
        11
        %i.icon-heart
        1
 %li.span3
  .thumbnail
    %a{href:"#"}
      %img{src:"http://placehold.it/260x180", alt:""}
    .thumb_info
      %h5= truncate("Dot. The world smallest stop motion", length:25)
      %p
        %i.icon-eye-open
        11
        %i.icon-heart
        1 
```

我正在使用响应式设计，因此列会适应。但是，在某些碎石显示器上，我得到了一个糟糕的结果。

这是我在正常的碎石尺寸上得到的理想结果：

![期望的结果](../Images/d9df4e9d8a2132a6089a2efd20a81bd9.png)

这就是我缩小浏览器窗口时得到的结果

![结果不好](../Images/955eb640683d9e2fc6786402f8875a8c.png)

但是，如果我缩小更多，结果看起来像第一个......

我的猜测是图片格式（260x180）不适合 4 列。就是不知道什么尺码好...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:44:16.260

您需要将使用引导网格 .span{n} 类的元素包装在 .row 类中。.row 类的负边距吸收了 .span{n} 类的左边距。

您的代码可能如下所示：

```
.row
  %ul.thumbnails
    %li.span3
       ... your content here ...
    %li.span3
       ... your content here ...
    %li.span3
       ... your content here ...
    %li.span3
       ... your content here ... 
```

这里的文档中有一个示例：http: [//twitter.github.com/bootstrap/scaffolding.html#gridSystem](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)

或者，在此处查看 Twitter 提供的示例布局：http: [//twitter.github.com/bootstrap/examples.html](http://twitter.github.com/bootstrap/examples.html)

# c# - 如何使用 Selenium 1 C# 检索 html 表值（文本）

> ID：11513513
> 
> 赞同：-1
> 
> 时间：2012-07-16T22:27:55.960
> 
> 标签：c#, html, .net, selenium, html-table

如果这样的问题已经得到解决，我深表歉意。
我正在尝试使用 Selenium（webdriver）检索网站的 HTML 表中显示的文本。我在 Visual Studios 2010 中使用 C# 进行编程。Html 如下所示：

```
<tbody>
<tr>
    <tr id="RFCol">
        <th class="subhead">
            <cufon class="cufon cufon-canvas" alt="BROCHURE " style="width: 60px; height: 12px;">
            <cufon class="cufon cufon-canvas" alt="FARE" style="width: 24px; height: 12px;">
        </th>
        <td class="">
            <span id="RFCol1" class="RFCol">
                <del>$5,190</del>
            </span>
        </td>
        <td class="">
            <span id="RFCol2" class="RFCol">
                <del>$6,660</del>
            </span>
        </td>
        <td class="">
        <td class="">
        <td class="">
    </tr>
    <tr id="PFCol">
    <tr id="CSDCol">
    <tr id="PFCol">
</tbody> 
```

粗体字是我所追求的。我正在尝试将文本存储在字符串变量中，以准备将其写入文本文件。任何帮助将不胜感激，因为我无法做到这一点。下面是我的一些尝试。我尝试使用 xpath 来检索值，但不能。

```
IWebElement table_element11 = selenium.FindElement(By.XPath("/html/body/form/div[3]/div/div[2]/div[4]/table/tbody/tr[2]/td/span/del")); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-17T19:46:49.600

```
"//del[contains(., '$')]" 
```

使用此 XPath 将为您提供页面上包含 $ 符号的所有“del”元素。从这一点开始，您可以使用您希望访问数据的方法，就像您在评论中所说的那样。

# ios - 如何在 iOS 的后台线程中创建计时器

> ID：11513516
> 
> 赞同：1
> 
> 时间：2012-07-16T22:28:09.813
> 
> 标签：ios, multithreading, background, nstimer

我需要创建两个计时器。一个在 UI 线程上，另一个在后台线程上。这些计时器彼此独立。

我将使用的场景；我基本上需要这个来测试 UI 线程的响应能力。UI 线程中的 TIMEr 在 UI 线程中每 200 毫秒更新一次 lastUpdatedDatetime 属性。还有一个后台线程每 200 毫秒轮询一次这个 lastupdatedDatetime 属性。

有谁知道我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:47:44.560

NSTimer 的重点是能够安排在线程（通常是主线程）上运行的东西，同时它正在处理运行循环上的其他事件。如果您想要在后台线程上做的只是每 200 毫秒轮询一次，那么不使用 NSTimer 而只是让后台线程休眠要容易得多。因此，像往常一样在主线程和后台线程上设置一个 NSTimer 执行以下操作：

```
while (stillRunning) {
    usleep(200*1000);
    // Do something with lastUpdatedDatetime
} 
```

这种技术会浪费线程，但对于测试目的而言，可能比使用 Grand Central Dispatch 更具确定性。

请记住，如果 lastUpdatedDatetime 是一个 NSDate，它应该被设置为一个原子属性，这样当你在后台线程上访问它时，你肯定会收到一个有效的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:39:04.040

查看 dispatch_async 和 dispatch_after

dispatch_async 会让你触发对另一个线程的调用，这就是我用来做主线程更改的方法。

dispatch_after 会让你延迟 dispatch_async 几秒钟。

这两者结合起来会让你在线程之间来回走动。

[这是Grand Central Dispatch上的文件](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)

# android - 兼容性包的最低 API 要求是什么？

> ID：11513517
> 
> 赞同：0
> 
> 时间：2012-07-16T22:28:10.510
> 
> 标签：android, package, compatibility, backwards-compatibility

我知道 Compatibility Package 非常有用并提供向后兼容性。我不确定的一件事是，包中的所有库都可以在所有版本的 Android 上使用吗，比如说 2.1 以上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:32:05.983

> 注意：支持包包含多个支持库。每个都有不同的最低 API 级别。例如，一个库需要 API 级别 4 或更高，而另一个库需要 API 级别 13 或更高（v13 是 v4 的超集，包括额外的支持类以使用 v13 API）。最低版本由目录名称表示，例如 v4/ 和 v13/。

[http://developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)

要支持 2.1，请使用兼容性库“v4”。

# backbone.js - 保存没有新属性的模型时，骨干网仍然向服务器发送 PUT

> ID：11513518
> 
> 赞同：0
> 
> 时间：2012-07-16T22:28:11.990
> 
> 标签：backbone.js

当在from上侦听`change`事件时，知道何时应该再次将自身重新呈现给用户配置文件。`ProfileView``EditView`

如果用户只是从 中单击“更新个人资料”`EditView`但没有更改任何属性*（即他不想编辑他的个人资料）*，`PUT`仍然会发送但没有`change`事件，因此用户被卡在编辑页面上，直到一个属性被改变了..

为什么如果没有更改任何属性，骨干网仍会将其发送到服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:47:38.637

在我看来，您的应用程序中的逻辑有缺陷。IE。如果他不想编辑他的个人资料，为什么用户会单击“更新个人资料”？在这种情况下，您可能需要另一种导航方法。如果您告诉 Backbone 保存模型，那么它必须将数据发送到服务器来执行此操作，因为它不知道您不需要它（您可能正在记录保存尝试或从服务器返回更新的值）。也许看看利用 changedAttributes 方法来决定是否需要触发保存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:39:52.883

回答您的问题，您可以检查模型是否更改，并且仅在更改时调用保存其他方式直接调用重定向。

首先，检查这个基本示例以了解“changedAttributes”：

```
var ProfileModel = Backbone.Model.extend({
    defaults : {
        title : 'hi',
        name : 'there'
    }
}); 
var profile = new ProfileModel();

//Nothing changed so it returns false
console.log( profile.changedAttributes({title: 'hi'}) );

//Title changed so it return a hash with it
console.log( profile.changedAttributes({title: 'hi2'}) ); 
```

现在计算您的代码，它必须执行以下操作：

```
var collectedProfile = {
   firstName : this.$('.firstName').val(),
   lastName : this.$('.lastName').val(),
};

if( model.changedAttributes( collectedProfile ) ){
    //instead of listen for the changed listen directly the server response
    model.save(collectedProfile, {success : this.handlerServerResponse })
}else{
    //model did not changed do not needed to call the server
    this.doRedirect();
}

//in your view:
handlerServerResponse : function(){
   //server process completed so let's redirect
   this.doRedirect();
} 
```

# javascript - 如何使用主干和主干提交表单。验证

> ID：11513530
> 
> 赞同：1
> 
> 时间：2012-07-16T22:29:48.840
> 
> 标签：javascript, backbone.js, validation

我正在使用 Backbone 版本 0.9.2、
jquery 版本 1.7.2 和
[Backbone.Validation v0.5.2](https://github.com/thedersen/backbone.validation)。

我的 html 看起来像 (1)、backbone.view (2) 和backbone.model (3)。

看来我的实现不再起作用了。
当我单击提交按钮时，它会执行一个 POST 请求而不进行任何表单验证。

任何想法为什么以及如何解决这个问题？

请参阅我的代码中的注释。

谢谢。

(1)

```
<form method="POST" class="form1">
        <div class="control-group">
            <label for="reason" class="control-label">Reason</label>
            <div class="controls">
                <textarea id="reason" name="reason" required="required" /></textarea>
            </div>
        </div>
        <!-- other codes -->
</form> 
```

(2)

```
var myView = Backbone.View.extend({

    initialize: function () {
        this.model = new MyModel();

        this.model.bind('validated:invalid', function(model, attrs) {
            console.log('validated:invalid', model, attrs); // It does not work
        });
        this.model.bind('validated:valid', function(model) {
            console.log('validated:valid', model); // It does not work
        });
   },

    events: {
        'click [data-tid="submit"]': 'submitForm'
    },

    submitForm: function (event) {
        event.preventDefault();
        this.model.set(data);
        this.model.save({
            success: function () {
        // some code
            }
        });
    } 
```

(3)

```
var MyModel = Backbone.Model.extend({

    urlRoot: 'someUrl',

    validation: {
        reason: {
            required: true,
            msg: 'Reason is required'
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T08:40:01.327

在初始化中创建模型后，您需要调用 Backbone.Validation.bind(this)。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-23T03:01:51.923

您可以使用表单验证。我认为您需要收听提交事件。

Backbone 可以正常工作。

```
 events: {      
   'submit': 'submit'
 } 
```

# c# - 再次使用多个 IEntityChangeTracker 接口实例

> ID：11513532
> 
> 赞同：0
> 
> 时间：2012-07-16T22:30:03.713
> 
> 标签：c#, mysql, winforms, entity-framework

我正在尝试尽可能部分地使用上下文，因为我希望我的软件被多个用户使用并且我已经遇到了上下文集成的问题......所以我正在做的是这样调用上下文：

```
entityManager = new EntityManager();

IEnumerable<customers_question_set> customersQuestionSets = 
entityManager.GetTradersCustomersQuestionSets(trader.id).ToArray<customers_question_set>();

entityManager = null; 
```

这样，我相信，我不仅用 =null 关闭所有内容，而且还通过 .ToArray() 将对象从上下文中分离出来。

但是现在我正在尝试将新项目添加到数据库中，但遇到了问题。这是我的行动：

```
private void button1_Click(object sender, EventArgs e)
    {
        trader trader = new trader();
        trader.companies.Add(parent.GetCompany());
        trader.login = textBox1.Text;
        trader.password_hash = Hasher.ToSha256Hash(textBox2.Text);

        EntityManager entityManager = new EntityManager();
        entityManager.SaveTrader(trader);
        entityManager = null;

        this.RefreshLists();
    }

public class EntityManager
{

    private mentor11Entities Mentor11Entities = new mentor11Entities();

    private mentor11Entities GetMentor11()
    {
        return this.Mentor11Entities;
    }

    public void SaveTrader(trader trader)
    {
        GetMentor11().traders.AddObject(trader);
        GetMentor11().AcceptAllChanges();
        GetMentor11().SaveChanges();
    }

[...]

} 
```

错误发生在 GetMentor11().traders.AddObject(trader) - 如果它是我什至没有从任何地方带走的新成员，如何分离它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:25:49.927

由于有很多人对此有疑问，并且在互联网上没有简单的（对于我这样的初学者）我能找到的解释......我将分享我如何解决我的问题。

1.  毕竟，我已经将 EntityManager 设为静态。

2.  我发现了“StoreWins”刷新类型（它确保输出始终与服务器中的一样）

所以它看起来像这样并且工作正常：

```
public static void SaveTrader(trader trader)
    {
        Mentor11Entities.Refresh(System.Data.Objects.RefreshMode.StoreWins, Mentor11Entities.traders);
        GetMentor11().AddTotraders(trader);
        GetMentor11().SaveChanges();
        GetMentor11().AcceptAllChanges();
        Mentor11Entities.Refresh(System.Data.Objects.RefreshMode.StoreWins, Mentor11Entities.traders);
    } 
```

# c# - 如何通过FTP检查文件是否存在于远程文件夹中？

> ID：11513534
> 
> 赞同：1
> 
> 时间：2012-07-16T22:30:05.507
> 
> 标签：c#, .net

我想检查远程文件夹的内容，并确定该文件夹中是否存在特定文件（我只检查文件名，所以冷静：D）

示例：我想检查文件夹中是否`/testftp`包含`textfile.txt`文件。

我这样做是为了获取文件夹内容：

```
 FtpWebRequest request = (FtpWebRequest)WebRequest.Create("myftpaddress");
        request.Method = WebRequestMethods.Ftp.ListDirectoryDetails;

        request.Credentials = new NetworkCredential("uid", "pass");

        FtpWebResponse response = (FtpWebResponse)request.GetResponse();

        Stream responseStream = response.GetResponseStream();
        StreamReader reader = new StreamReader(responseStream);
        Console.WriteLine(reader.ReadToEnd());

        Console.WriteLine("Directory List Complete, status {0}", response.StatusDescription);

        reader.Close();
        response.Close(); 
```

它在控制台中写道：

```
-rw-r--r--   1 6668   userftp 91137 jul 16 23:20 file1.txt
-rw-r--r--   1 468    userftp   137 jul 16 18:40 file2.swf 
```

并将完整的流响应写入控制台，如何仅获取文件名？有没有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:32:58.723

尝试下载文件会更容易。如果您得到指示该文件不存在的[StatusCode ，您就知道它不存在。](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.statuscode.aspx)

可能比过滤`ListDirectoryDetails`.

**更新**

为了澄清，您需要做的就是：

```
FtpWebResponse response = (FtpWebResponse) request.GetResponse();
bool fileExists = (response.StatusCode != BAD_COMMAND); 
```

我认为 BAD_COMMAND 将是[FtpStatusCode](http://msdn.microsoft.com/en-us/library/system.net.ftpstatuscode) .CantOpenData 但我不确定。这很容易测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:38:23.667

```
string listing = reader.ReadToEnd();

// find all occurrences of the fileName and make sure
// it is bounded by white space or string boundary.

int startIndex = 0;
bool exists = false;
while (true)
{
    int index = listing.IndexOf(fileName, startIndex);
    if (index == -1) break;

    int leadingIndex = index - 1;
    int trailingIndex = index + fileName.Length;

    if ((leadingIndex == -1 || Char.IsWhiteSpace(listing[leadingIndex]) &&
        (trailingIndex == list.Length || Char.IsWhiteSpace(listing[trailingIndex]))
    {
        exists = true;
        break;
    }

    startIndex = trailingIndex;
} 
```

正则表达式版本：

```
string pattern = string.Format("(^|\\s){0}(\\s|$)", Regex.Escape(fileName));
Regex regex = new Regex(pattern);

string listing = reader.ReadToEnd();
bool exists = regex.IsMatch(listing); 
```

# objective-c - 在 UITextView 而不是 UITextFields 上调用 UIKeyboard 方法

> ID：11513536
> 
> 赞同：1
> 
> 时间：2012-07-16T22:30:15.713
> 
> 标签：objective-c, nsnotifications

我`UITextView`在底部有评论。由于它在页面底部，每当有人编辑它时，都会调用一个方法来改变页面的视图，这样你仍然可以看到评论框。我的问题是，当用户正在编辑时，也会调用相同的方法`UITextFields`。

这就是我所拥有的。首先我声明一个通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(keyboardWillShow:) 
                                             name:UIKeyboardWillShowNotification 
                                           object:self.view.window]; 
```

然后方法本身

```
- (void)keyboardWillShow:(NSNotification *)notif{

...

} 
```

我的第一个想法是添加一个条件，检查对象是否为 TextView，然后才执行代码。但是由于我没有将对象传递给方法，所以无论如何要告诉方法我正在处理什么类型的对象

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:10:45.870

文本字段和文本视图也会发送通知。在 textFieldShouldBeginEditing 和 textViewShouldBeginEditing 实现中，您可以设置一个标志，您可以在键盘WillShow 方法的实现中读取该标志——键盘通知在文本字段或文本视图通知之后发送。

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField {
    self.sender = @"text field";
    return YES;
}

- (BOOL)textViewShouldBeginEditing:(UITextView *)textView {
    self.sender = @"text view";
    return YES;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(keyboardWillShow:) 
                                                 name:UIKeyboardWillShowNotification 
                                               object:self.view.window];

}

- (void)keyboardWillShow:(NSNotification *)notif{
    NSLog(@"%@",self.sender);
} 
```

# iphone - 当 UIWebView 不是全屏时，UIWebView 中的 jQuery Mobile 剪切内容

> ID：11513539
> 
> 赞同：4
> 
> 时间：2012-07-16T22:30:38.203
> 
> 标签：iphone, ios, ipad, jquery-mobile

我有一个`UIWebView`小于全屏的（特别是 540x560 像素）。我的问题是我的[jQuery 移动](http://jquerymobile.com/)内容被截断，而不是像我期望的响应式网站那样调整大小。我在[这里](http://cl.ly/2M2S1Y0u1d2e)上传了一个有问题的示例项目。任何想法如何解决这一问题？

![例子](../Images/6eeaac6d80668b6bd141e9308c99ba96.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T06:32:26.267

检查 html 头部中的以下标记，它告诉浏览器使视口的宽度与设备宽度相同

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

删除该标签将删除水平滚动

**编辑：**

您不能从[http://jquerymobile.com/demos/1.1.1/docs/lists/index.html](http://jquerymobile.com/demos/1.1.1/docs/lists/index.html)中删除元标记，因此将其托管在本地服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-22T01:15:41.397

将视口的宽度和高度设置为 UIWebView 的任何高度。这将注册浏览器窗口的“底部”，并且如果它是适当的高度，则应防止您的内容被截断。

见这里：http: [//developer.apple.com/library/ios/ipad/#DOCUMENTATION/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-22T05:19:30.703

好的@Kevin，只有你要做的就是`UIWebView`在`KSViewController.xib`. 如果您想让您的应用程序成为 Web 应用程序，只需在 Xcode 项目中添加您喜欢的框架和文件夹即可。

![在此处输入图像描述](../Images/e0a90ff709f910231edaac7926bf0739.png)

![在此处输入图像描述](../Images/6a0773d479501a9498f9f72478b6d563.png)

**希望这可以帮助。:)**

# c# - Windows 窗体应用程序 - 我应该使用哪种数据库类型？

> ID：11513540
> 
> 赞同：2
> 
> 时间：2012-07-16T22:30:39.743
> 
> 标签：c#, sql, database, winforms

我希望有人能帮助我。我最近开始开发连接到远程 sql server 数据库的 windows 窗体应用程序。我很高兴开发它，直到潜在客户询问他们是否能够购买整个应用程序但他们不希望应用程序通过互联网连接到数据库。

我主要使用 php/mysql 开发网站，但为这个特定项目迁移到 c#。我熟悉 sql，但不确定如果客户希望在自己的计算机上拥有整个应用程序，我应该使用什么数据库。在发布应用程序时，我考虑过将数据库安装作为先决条件（尽管我目前不确定如何执行此操作），但我对这是否合适或可能导致更多问题持保留态度。我想创建一个可以安装到单台计算机并且几乎不需要管理的应用程序。有人可以建议在这种情况下处理数据存储的最佳方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:40:04.763

因为您已经在远程站点上运行了一个 SqlServer 数据库，所以最好的路径应该是使用 SqlServer Express 2012 的 LocalDB 版本。有关部署， [请参阅此链接。](https://stackoverflow.com/questions/9655362/localdb-deployment-on-client-pc)

如果您不使用存储过程、视图和触发器，那么 SQL CE 也可能是一个选项，但您将不具备文件二进制兼容性，您应该导入架构和数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:39:42.093

SQL CE 是一种紧凑的轻量级方式。

[http://blogs.msdn.com/b/sqlservercompact/archive/2011/01/12/microsoft-sql-server-compact-4-0-is-available-for-download.aspx](http://blogs.msdn.com/b/sqlservercompact/archive/2011/01/12/microsoft-sql-server-compact-4-0-is-available-for-download.aspx)

# towerjs - 新应用不会使用 Jade 模板搭建脚手架

> ID：11513541
> 
> 赞同：0
> 
> 时间：2012-07-16T22:30:40.277
> 
> 标签：towerjs

在搭建新的 Tower js 应用程序时，我执行

```
tower new demo --views jade 
```

但我仍然得到默认的 CoffeeKup 布局。

对此的任何帮助都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:18:20.840

此功能尚未实现，目前仅设置了命令行标志。以下是生成器模板：

*   [库/塔/服务器/发电机/发电机/塔](https://github.com/viatropos/tower/tree/026416121143dd9a7caf35e9dd1ec5e3ca195dae/lib/tower/server/generator/generators/tower)
*   [库/塔/服务器/发电机/发电机/塔/视图/模板](https://github.com/viatropos/tower/tree/026416121143dd9a7caf35e9dd1ec5e3ca195dae/lib/tower/server/generator/generators/tower/view/templates)

要添加此功能，只需将命令行标志连接到`viewGenerator.coffee`and`appGenerator.coffee`文件：

*   视图生成器脚本：[src/tower/server/generator/generators/tower/view/viewGenerator.coffee#L19](https://github.com/viatropos/tower/blob/026416121143dd9a7caf35e9dd1ec5e3ca195dae/src/tower/server/generator/generators/tower/view/viewGenerator.coffee#L19)
*   生成器对象被传递了一个`program`变量：[src/tower/server/generator.coffee#L20](https://github.com/viatropos/tower/blob/026416121143dd9a7caf35e9dd1ec5e3ca195dae/src/tower/server/generator.coffee#L20)
*   这是应用程序生成器命令解析器，用于查看在 src/tower/server/command/new.coffee 上设置`program`的[变量](https://github.com/viatropos/tower/blob/026416121143dd9a7caf35e9dd1ec5e3ca195dae/src/tower/server/command/new.coffee)

所以所有需要做的就是将该`viewGenerator.coffee`脚本修改为：

```
for view in views
  @template "#{view}.coffee", "app/views/#{@view.directory}/#{view}.#{@program.engine}" 
```

我会帮助实现这一点，但目前没有时间，致力于将 dev 分支合并到 master。希望有帮助。

# wpf - 为什么设置 datagrid.Items.SortDescriptions(#).Direction 会出错？

> ID：11513543
> 
> 赞同：0
> 
> 时间：2012-07-16T22:30:42.763
> 
> 标签：wpf, vb.net, datagrid

我有一个 wpf 数据网格，我想以编程方式对其进行排序，就好像用户单击了标题一样。经过一番搜索，我找到了使用这个的参考：

```
datagrid_selected.Items.SortDescriptions(2).Direction = ComponentModel.ListSortDirection.Ascending 
```

看起来它会工作。Intellisense 说 Direction 是一个 getter 和 setter，但是当我尝试将它分配给某个东西时，我得到“表达式是一个值，因此不能成为分配的目标”错误。作为一个二传手，我应该能够将其分配给一个值，对吧？知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:56:47.043

看起来 SortDescriptions 是装箱的值。

相反，请尝试以下操作。

```
var sortDescription = grid.Items.SortDescriptions[0];
sortDescription.Direction = System.ComponentModel.ListSortDirection.Ascending;
grid.Items.SortDescriptions[0] = sortDescription; 
```

# mysql - MySQL GROUP BY 顺序

> ID：11513549
> 
> 赞同：0
> 
> 时间：2012-07-16T22:31:20.460
> 
> 标签：mysql, sql

请考虑以下表结构和数据：

```
+--------------------+-------------+
|     venue_name     |  listed_by  |
+--------------------+-------------+
| My Venue Name      |      1      |
| Another Venue      |      2      |
| My Venue Name      |      5      |
+--------------------+-------------+ 
```

我目前正在使用 MySQL 的`GROUP BY`功能来选择唯一的场地名称。但是，这仅返回 的第一次出现`My Venue Name`，但我想根据条件返回它（在这种情况下，`listed_by`字段的值 > 2.

基本上这是我想要实现的一些伪代码：

```
Select all records
Group by name
if grouped, return the occurance with the higher value in listed_by 
```

是否有允许此功能的 SQL 语句？

编辑：我应该提到查询中还涉及其他字段，并且该`listed_by`字段也需要在查询的其他地方使用。这是我们使用的原始查询：

```
SELECT  l1.field_value AS venue_name, 
    base.ID AS listing_id,
        base.user_ID AS user_id,
        IF(base.user_ID > 1, 'b', 'a') AS flag,
        COUNT(img.ID) AS img_num
        FROM ( listingsDBElements l1, listingsDB base )
        LEFT JOIN listingsImages img ON (base.ID = img.listing_id AND base.user_ID = img.user_id and img.active = 'yes')
        WHERE  l1.field_name = 'venue_name'
               AND l1.field_value LIKE '%name%'
               AND base.ID = l1.listing_id
               AND base.user_ID  = l1.user_id
               AND base.ID = l1.listing_id
               AND base.user_ID  = l1.user_id
               AND base.active = 'yes'
    GROUP BY  base.Title  ORDER BY  flag desc,img_num desc 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:34:16.677

只要您没有提及其他领域 - 这是最简单的解决方案：

```
 SELECT venue_name,
         MAX(listed_by)
    FROM tblname
   WHERE listed_by > 2
GROUP BY venue_name 
```

对于其他字段，它可能看起来像（假设没有`venue_name + listed_by`成对重复）：

```
 SELECT *
      FROM tblname t1
INNER JOIN (SELECT venue_name,
                   MAX(listed_by) max_listed_by
              FROM tblname
             WHERE listed_by > 2
          GROUP BY venue_name) t2 ON t1.venue_name = t2.venue_name
                                 AND t1.listed_by = t2.max_listed_by 
```

# sql - SQL 报告在一行组中显示结果

> ID：11513551
> 
> 赞同：1
> 
> 时间：2012-07-16T22:31:38.650
> 
> 标签：sql, tsql

我试图达到以下结果：

```
ID |  Part  | QTY| Boxes| Reference
1  | ABC123 | 20 | 0    | REF0001
2  | ABC345 | 10 | 0    | REF0001
3  | ABC487 | 5  | 1    | REF0001
4  | SEF453 | 4  | 0    | REF0002
5  | ABDS12 | 82 | 4    | REF0002
6  | EFR488 | 64 | 0    | REF0003
7  | XCV345 | 58 | 0    | REF0003
8  | SSFS33 | 23 | 3    | REF0003 
```

现在我得到

```
ID |  Part  | QTY| Boxes| Reference
1  | ABC123 | 20 | 1    | REF0001
2  | ABC345 | 10 | 1    | REF0001
3  | ABC487 | 5  | 1    | REF0001
4  | SEF453 | 4  | 4    | REF0002
5  | ABDS12 | 82 | 4    | REF0002
6  | EFR488 | 64 | 3    | REF0003
7  | XCV345 | 58 | 3    | REF0003
8  | SSFS33 | 23 | 3    | REF0003 
```

如您所见，每个引用的框数量重复每一行，并且每个引用我只需要出现一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:29:21.833

分配每个引用分组的行号会将共享相同引用的最高 ID 标记为 1；主查询检查此标记，如果不满足则输出零。

```
; with q as
(
  select *,
         row_number() over (partition by Reference
                            order by ID desc) rn
    from
    (
        your-query-here
    ) a
)
select q.ID, 
       q.Part, 
       q.QTY, 
       case when rn = 1 then q.Boxes else 0 end as Boxes, 
       q.Reference
  from q
 order by q.ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:01:08.690

好吧，这是一种方法。. .

```
with t as (<your current query>)
select ID, Part, QTY,
       max(Boxes) over (partition by Reference) as Boxes,
       Reference
from t 
```

# c++ - 填充指向向量的指针向量

> ID：11513559
> 
> 赞同：2
> 
> 时间：2012-07-16T22:32:14.523
> 
> 标签：c++, memory, vector, new-operator

我有一个指向向量的指针向量：

```
main(...)
{
  //...
  std::vector< std::vector<double> * > ds = getDS(...)
  //...
}

std::vector<std::vector<double> * > getDS(int m, ...)
{
  std::vector<std::vector<double> * > wavefunctions = *(new std::vector<std::vector<double>*>(m));
  int n = int( params.rmax() / params.dr() );
  std::ifstream input_wf;
  input_wf.open(filename.c_str());
  input_wf.setf(std::ios::showpoint | std::ios::scientific);
  for(int i=0; i < nbasis; i++)
  {
    std::vector<double> *wf = new std::vector<double>(n);
    //(wavefunctions[i]) = new std::vector<double>(n);
    for (unsigned int ir=0; ir < wf->size(); ir++)
      input_wf >> ( *wf )[ir];
    wavefunctions.push_back(wf);
  }
  input_wf.close();
  return wave functions;
} 
```

`wavefunctions[0]->at(some legal value)`但是，在调试期间，当我通过循环一次后尝试访问时，我不断收到 EXC_BAD_ACCESS 错误。（那里*应该*有一些东西，但我不确定为什么没有......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:41:26.287

下一行，

```
 std::vector<std::vector<double> * > wavefunctions = *(new std::vector<std::vector<double>*>(m)); 
```

在您的情况下存在问题，原因有两个 -

1.  它会导致内存泄漏，因为创建的对象`new`被*复制*到`wavefunctions`中，然后指向它的指针丢失。这不是Java...
2.  它在您的向量中分配`m`条目。Subsequent`push_back`添加到该`m`条目中，因此当您尝试访问时，您实际上访问的是在此行中创建的条目，而不是循环`wavefunctions[0]`中推送的第一个条目。`for`

要解决此问题，请将行更改为

```
std::vector<std::vector<double> * > wavefunctions;
wavefunctions.reserve(m); 
```

该`reserve`方法确保您不会在`push_back`'s 期间进行重新分配。

最后一点，根据具体情况，编译器可能会也可能不会优化函数返回时执行的向量的固有副本。可以肯定的是，您可能想了解更多关于 r 值引用 ( `&&`) 或简单地按地址返回向量（即，作为类型`vector<...> *`和返回类型的另一个参数`void`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:47:37.057

~~该代码看起来应该对我有用，但是动态分配太多了。（尽管您拼写了返回值。）~~ user1071136 发现了错误。

大多数时候，你永远不应该输入`delete`，而且几乎永远不要输入`new`。您也可以在其构造函数中打开一个流，然后流关闭自己，您不必这样做。您还忘记检查流状态，看看它是否读入了任何值。

```
std::vector<std::vector<double>> getDS(int m, ...)
{
  std::ifstream input_wf(filename.c_str());
  input_wf.setf(std::ios::showpoint | std::ios::scientific);

  int n = int( params.rmax() / params.dr() );
  std::vector<std::vector<double>> wavefunctions(m, std::vector<double>(n));
  //m by n vector is fully constructed, and ready to read!
  for(int i=0; input_wf && i<nbasis; i++)
  {
    for (unsigned int ir=0; input_wf  && ir<wf->size(); ir++)
      input_wf >> wavefunctions[i][ir];
  }
  if (!input_wf)
      throw std::runtime_error("improper data in the file!");
  return wavefunctions;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:41:47.000

```
std::vector<std::vector<double> * > wavefunctions = *(new std::vector<std::vector<double>*>(m)); 
```

这在我看来很可疑。我相信你的意思是做两件事之一。

在堆栈上声明它并返回它的副本。

```
 std::vector<std::vector<double> * > wavefunctions; 
```

在堆上声明它并从你的函数返回一个指针。（这使得调用者负责删除分配的内存。）

```
std::vector<std::vector<double> * > *wavefunctions = new std::vector<std::vector<double>*>(m); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:25:06.177

首先，你为什么要维护一个指针向量？这样做几乎没有充分的理由（我想不出一个，但我不知道一切。）如果您需要存储指针，则存储智能指针。您正在否定向量为您管理内存的能力。

```
std::vector<std::vector<double> * > wavefunctions = *(new std::vector<std::vector<double>*>(m)); 
```

在这里，您`new`创建一个向量，立即取消引用它并将其复制到您的本地向量。那里有内存泄漏，因为`new`'d 向量（及其指针）丢失了，您只需复制它并将其丢弃。同样，将指针存储在向量中是一个坏主意，而且您的分配方法总是错误的。

只需使用 a`vector<vector<double> >`并让向量为您管理动态内存（尽管最好对该主题进行更多研究，以便您了解代码在做什么。）

我什至有点犹豫要不要这么说，但是在使用向量来模拟锯齿状数组时*可能会出现性能问题。*问题是数据的局部性之一，但这仅适用于性能敏感代码中的紧密循环，并且有许多因素可能使这一点没有实际意义。

# c++ - 从对象的不同角度找到一个好的单应性？

> ID：11513561
> 
> 赞同：11
> 
> 时间：2012-07-16T22:32:22.867
> 
> 标签：c++, opencv, computer-vision, feature-detection, orb

我正在使用特征提取（sift，orb）进行对象检测。

我想从对象（训练图像）的不同角度提取 ORB 特征，然后将它们与查询图像进行匹配。

我面临的问题是：我怎样才能从来自不同角度的图像的关键点创建一个好的单应性，当然有不同的大小？

## 编辑

我正在考虑为每个有 3-4 个匹配的火车图像创建一个单应性，然后计算一些“平均”单应性......

例如，当您从每个火车图像中说只有 1-2 个匹配项时，就会出现问题，此时您甚至无法创建 1 个单应性

创建单应性的代码

```
 //> For each train images with at least some good matches ??
  H = findHomography( train, scene, CV_RANSAC );
  perspectiveTransform( trainCorners, sceneCorners, H); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T16:15:52.530

我认为这样做没有意义，因为当您谈论单应性时，一对图像 A 和 B 与一对图像 B 和 C 无关。您将获得不同的**良好匹配**集和不同的单应性，但单应性将是不相关的，并且没有错误最小化是有意义的。

所有最小化都必须在匹配、关键点和描述符内，仅考虑这对图像。

有一个类似于您在 FREAK 描述符中提出的想法。您可以使用一组图像训练选定的对。这意味着 FREAK 将根据一组图像决定提取描述符的最佳模式。在此培训之后，您应该找到更强大的数学，这将为您提供更好的单应性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T07:00:46.397

要找到一个好的单应性，您需要准确匹配关键点。你需要 4 场比赛。

最常见的方法是 DLT 与 RANSAC 相结合。DLT 是一种线性变换，可以找到将关键点投影到场景中的单应性 3x3 矩阵。RANSAC 找到满足数学模型的最佳内点/异常值集，因此它将找到最好的 4 个点作为 DLT 的输入。

**编辑**

您需要找到稳健的关键点。SIFT 应该做到这一点，规模和视角不变。我认为您不需要使用不同的图像进行训练。找到平均单应性没有意义。您需要为检测到的对象找到唯一的单应性，并且该单应性将是标记和检测到的对象之间的转换。单应性是精确的，寻找均值是没有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:54:35.677

您是否尝试过从对象视图中获取关键点的方法：train_kps_1、train_kps_2...然后将这些数组与场景匹配，然后从这几个数组中选择最佳匹配，从而得到一个良好匹配的数组。最后使用该结果查找单应性作为“火车”。

这里的关键是如何选择最佳匹配，这是一个不同的问题，你可以在这里找到一个不错的答案：

[http://answers.opencv.org/question/15/how-to-get-good-matches-from-the-orb-feature/](http://answers.opencv.org/question/15/how-to-get-good-matches-from-the-orb-feature/)

也许在这里：

[http://answers.opencv.org/question/2493/best-matches/](http://answers.opencv.org/question/2493/best-matches/)

# multithreading - OpenCV 多线程错误 [使用 Qt]

> ID：11513564
> 
> 赞同：0
> 
> 时间：2012-07-16T22:32:41.277
> 
> 标签：multithreading, qt, opencv

**到现在为止我学到了一件事，我用 OpenCV 做错了，Qt 在错误中没有任何作用**

我试图在不同的线程中运行两种方法，但它给了我错误：

> [xcb] 出队时队列中有未知请求
> [xcb] 这很可能是一个多线程客户端，并且 XInitThreads 尚未被调用
> [xcb] 中止，对此感到抱歉。
> Blurring_Images：../../src/xcb_io.c:178：dequeue_pending_request：断言“！xcb_xlib_unknown_req_in_deq”失败。
> 程序意外结束。

* * *

这是我的代码：

```
void Dialog::blurImages(int b)
{
    QtConcurrent::run(this,&Dialog::homogenour_blur,b);
    QtConcurrent::run(this,&Dialog::gaussianBlur,b);
}

void Dialog::homogenour_blur(int b)
{
    cv::blur(img,img1,cv::Size(b,b));
    showImage("Homogenous Blur",img1);
}

void Dialog::gaussianBlur(int b)
{
    cv::GaussianBlur(img,img2,cv::Size(b,b),b);
    showImage("Gaussian Blur",img2);
} 
```

而如果我注释掉一个电话（如下所示），它运行良好

```
void Dialog::blurImages(int b)
{
    QtConcurrent::run(this,&Dialog::homogenour_blur,b);
    //QtConcurrent::run(this,&Dialog::gaussianBlur,b);
} 
```

真的很烦人，求救！！

**编辑：** 我没有调用 showImage()，而是将其替换为实际的 OpenCV 调用（见下文）：

```
void Dialog::homogenour_blur(int b)
{
    cv::blur(img,img1,cv::Size(b,b));
    //showImage("Homogenous Blur",img1);
    cv::imshow("Homogenous Blur",img1);
}

void Dialog::gaussianBlur(int b)
{
    cv::GaussianBlur(img,img2,cv::Size(b,b),b);
    //showImage("Gaussian Blur",img2);
    cv::imshow("Gaussian Blur",img2);
} 
```

现在我得到的错误是：

> 原始图像：X 服务器：0 上的致命 IO 错误 11（资源暂时不可用）。
> 原始图像：X 服务器上的致命 IO 错误 0（成功）：0。
> 致命错误：销毁后访问了全局静态“KGlobalSettings *s_self()”。定义在 ../../kdeui/kernel/kglobalsettings.cpp:190
> 程序意外完成。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-16T01:21:17.390

致所有相关人员：

解决 Jaydeep 的问题

> [xcb] 出队时队列中有未知请求
> 
> [xcb] 这很可能是一个多线程客户端并且 XInitThreads 没有被调用
> 
> [xcb] 中止，抱歉。

和

> 错误：未在此范围内声明“XInitThreads”

通过链接 X11，包括 xlib，并调用 XInitThreads。

包含 xlib 和调用 XInitThreads 的示例：

```
// main.cpp
#include <thread> 
#include <X11/Xlib.h>

int main() {
   XInitThreads();
   // . . . 
} 
```

链接示例：

```
g++ main.cpp -o my_program -std=c++0x -pthread -lX11 /* -pthread if you're on Linux */ 
```

当然，不要忘记链接您的应用程序可能需要的其他文件

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-08-10T11:37:36.700

imshow() 方法似乎不是线程安全的。如果你使用python，可以这样解决：

```
self.img_lock = threading.Lock()

with self.img_lock:
  cv2.imshow()
  cv2.waitKey(1)
```

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2012-07-17T00:38:20.317

线程关闭。

我不知道为什么会出现问题，但我已经解决了..

感谢RA。表现出极大的兴趣:)

# google-drive-api - 使用 .NET API 的 Google Drive 导出链接为空

> ID：11513566
> 
> 赞同：2
> 
> 时间：2012-07-16T22:32:52.683
> 
> 标签：google-drive-api

类似于这个问题[Getting public URL to file in Google Drive using .NET API](https://stackoverflow.com/questions/11265798/getting-public-url-to-file-in-google-drive-using-net-api)。

使用 Google.APIs.Drive.v2 API 我可以列出文件`DriveService.Files.List()`。这将返回一个文件集合。

这些项目有一个属性`exportLinks`，但是该属性对于我的所有文件都是空的。

请指教。谢谢。

注意：文件所在的文件夹使用 Visible with Link 共享。

**更新**：根据克劳迪奥的要求添加一个结果条目：

```
 {
  "kind": "drive#file",
    "id": "0B3huP1kT5Jg7ckIwM1JFODhqQnM",
    "etag": "\"-tJAWr_lbRQU2o8gZ0X7BCBIlVk/MTM0MTA3MDYwODUxOQ\"",
    "selfLink": "https://www.googleapis.com/drive/v2/files/0B3huP1kT5Jg7ckIwM1JFODhqQnM",
    "alternateLink": "https://docs.google.com/file/d/0B3huP1kT5Jg7ckIwM1JFODhqQnM/edit",
    "thumbnailLink": "https://lh4.googleusercontent.com/DLv5EK327dWfKyE4OHVvqmtPNAJBh564NHWoMo_xNzjdsG9cyYgYPpca3K5VdmHfqQ=s220",
    "permissionsLink": "https://www.googleapis.com/drive/v2/files/0B3huP1kT5Jg7ckIwM1JFODhqQnM/permissions",
    "title": "WILDCHIL-BLAVEC-FULL-001.png",
    "mimeType": "image/png",
    "labels": {
     "starred": false,
     "hidden": false,
     "trashed": false,
     "restricted": false,
     "viewed": false
    },
    "createdDate": "2012-06-30T15:36:48.519Z",
    "modifiedDate": "2012-06-30T15:36:48.519Z",
    "modifiedByMeDate": "2012-06-30T15:36:46.095Z",
    "parents": [
     {
      "kind": "drive#parentReference",
      "id": "0B3huP1kT5Jg7MjNfMHZLcEdVbHM",
      "selfLink": "https://www.googleapis.com/drive/v2/files/0B3huP1kT5Jg7ckIwM1JFODhqQnM/parents/0B3huP1kT5Jg7MjNfMHZLcEdVbHM",
      "parentLink": "https://www.googleapis.com/drive/v2/files/0B3huP1kT5Jg7MjNfMHZLcEdVbHM",
      "isRoot": false
     }
    ],
    "downloadUrl": "https://doc-10-94-docs.googleusercontent.com/docs/securesc/aarkh960uprlp23t4c9u2f081smlqd2o/noa9bibpnrmajuo2632hl6ocidpf1q0j/1342476000000/03524686860055462013/03524686860055462013/0B3huP1kT5Jg7ckIwM1JFODhqQnM?h=16653014193614665626&e=download&gd=true",
    "userPermission": {
     "kind": "drive#permission",
     "etag": "\"-tJAWr_lbRQU2o8gZ0X7BCBIlVk/9STkNeCmz61YXorH3hoJimnEgfM\"",
     "id": "current",
     "role": "owner",
     "type": "user"
    },
    "originalFilename": "WILDCHIL-BLAVEC-FULL-001.png",
    "fileExtension": "png",
    "md5Checksum": "ebfa9523688cc5e0aee4cce74c288819",
    "fileSize": "701686",
    "quotaBytesUsed": "701686",
    "ownerNames": [
     "Swcatalog-canada"
    ],
    "lastModifyingUserName": "Swcatalog-canada",
    "editable": true,
    "writersCanShare": true
   }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:11:43.400

并非所有文件格式都支持 exportLinks，png 就是其中之一。要了解所有可能的导入/导出组合，请请求关于提要并检查`importFormats`和`exportFormats`字段：

[https://developers.google.com/drive/v2/reference/about#resource](https://developers.google.com/drive/v2/reference/about#resource)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-05T07:50:55.377

如果您在 Google 文档中遇到缺少 exportLinks 的情况，请仔细检查您的权限范围。

# symfony - Symfony 单元测试和容器

> ID：11513569
> 
> 赞同：3
> 
> 时间：2012-07-16T22:32:57.323
> 
> 标签：symfony, phpunit

在 Symfony 2 中进行单元测试时，我正在测试的控制器没有收到服务容器，导致测试失败`Call to a member function get() on a non-object`

我不能从测试控制器使用 $this->forward，因为它也没有服务容器。

我找到了这个参考，但似乎我会因为错误的原因使用它，有没有人有这方面的经验？

[http://symfony.com/doc/current/book/testing.html#accessing-the-container](http://symfony.com/doc/current/book/testing.html#accessing-the-container)

编辑：这是我的测试：

```
<?php

namespace HvH\ClientsBundle\Tests\Controller;

use HvH\ClientsBundle\Controller\ClientsController;

use Symfony\Bundle\FrameworkBundle\Test\WebTestCase;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\HeaderBag;
use Symfony\Component\HttpFoundation\Session;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;

class ClientsControllerTest extends WebTestCase
{

    public function testGetClientsAction()
    {

        $client = static::createClient();
        $container = $client->getContainer();
        $session = $container->get('session');
        $session->set('key', 'value');
        $session->save();

        $request = new Request;
        $request->create('/clients/123456', 'GET', array(), array(), array(), array(), '');

        $headers['X-Requested-With'] = "XMLHttpRequest";
        $request->headers->add($headers);

        /* This doesn't work */
        /*
        $controller = new Controller;
        $status = $controller->forward( 'HvHClientsBundle:Clients:getClients', array('request' => $request) );        
        */

        $clients_controller = new ClientsController();
        $status = $clients_controller->getClientsAction($request);

        $this->assertEquals(200, $status);
    }

} 
```

**这是客户端控制器失败的部分**

```
<?php

namespace HvH\ClientsBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use HvH\APIschemaBundle\Controller\Validation;

//FOSRestBundle
use FOS\RestBundle\View\View;

class ClientsController extends Controller
{

    //Query all clients
    public function getClientsAction(Request $request)
    {
        $request_type = $request->headers->get('X-Requested-With');

        if($request_type != 'XMLHttpRequest') {
            return $this->render('HvHDashboardBundle:Dashboard:dashboard.html.twig' );          
        }

        //get any query strings
        $query_strings = $request->query->all();
        $definition = $this->get("service.handler")->definition_handler(__CLASS__, __FUNCTION__);
        //once data has been prepared 
        return $this->get('fos_rest.view_handler')->handle($view);

    }    
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:46:32.447

我认为控制器没有获得容器的原因是因为您试图直接实例化并与之交互，而不是使用客户端模拟请求（请参阅Symfony2 书的[测试部分中的功能测试部分）。](http://symfony.com/doc/master/book/testing.html)

您需要更多类似的东西（不确定路线是否正确）：

```
public function testGetClientsAction()
{
    $client = static::createClient();

    $client->request(
        'GET', '/clients/123456', 
        array(), /* request params */ 
        array(), /* files */
        array('X-Requested-With' => "XMLHttpRequest"),
    );

    $this->assertEquals(200, $client->getResponse()->getStatusCode());  
} 
```

另请注意，request() 方法返回一个爬虫实例，该实例提供辅助方法来验证响应的内容（如果需要）。

# php - 将 div 标签连接到 db 结果

> ID：11513571
> 
> 赞同：0
> 
> 时间：2012-07-16T22:32:59.423
> 
> 标签：php, zend-framework, concat

我从数据库表中获取一些数据`tableA`，需要返回`'name'`div 标签内的列。

```
$divtag1 = '<div style="color:#1569C7; font-weight:bold">';
$select = $this->select()
->from(array('ta' => 'tableA'),
array('ta.id', 
      'name' => new Zend_Db_Expr("concat($divtag1 . ta.name . '</div>')"),
      'date' => new Zend_Db_Expr("date(ta.date)")
));

$result = $this->getAdapter()->fetchAll($select); 
```

我收到一个错误：

```
SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '
. ta.name . '
') AS `name`, da' 
```

问题是 concat() 函数正在为自己解释 $divtag1 中的引号，我不希望这样。有人可以帮我解决这个问题吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:34:42.253

尝试

```
'name' => new Zend_Db_Expr("concat('$divtag1', ta.name, '</div>')"), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:52:34.273

有两个更正：

1.  引用 $divtag1 变量；谢谢@Parahat Melayev
2.  在 concat() 中使用逗号而不是点。

最终解决方案是：

```
$divtag1 = '<div style="color:#1569C7; font-weight:bold">';
$select = $this->select()
->from(array('ta' => 'tableA'),
array('ta.id', 
      'name' => new Zend_Db_Expr("concat($divtag1 , ta.name , '</div>')"),
      'date' => new Zend_Db_Expr("date(ta.date)")
));

$result = $this->getAdapter()->fetchAll($select); 
```

# php - 无法在 Godaddy 托管中使用 .htaccess 更改 url

> ID：11513572
> 
> 赞同：2
> 
> 时间：2012-07-16T22:33:03.727
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我必须用 .htaccess 更改 url

.htaccess 存储在链接文件夹中。

我的 .htaccess 文件是

```
Options -Multiviews
Options +FollowSymlinks
RewriteEngine on
RewriteRule   ^([1-9a-z]*)$ index.php\?u=$1 [L] 
```

当我打开这个

'http://example.com/link/index.php?u=3ujkzf'

网址有效。

但是当我打开

'http://example.com/link/3ujkzf' 短链接

我得到了默认的 Godaddy 托管错误页面。

请帮忙..

谢谢阅读。。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:36:29.710

如果您的项目位于该`link`文件夹中，则需要包括：

```
RewriteRule   ^link/([1-9a-z]*)$ /link/index.php?u=$1 [L] 
```

顺便说一句，重写规则第二部分的问号不需要转义

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:38:55.317

尝试添加 RewriteBase /

就在 RewiteEngine On 下方

# wordpress - 为现有的 Wordpress 网站创建一个移动网站

> ID：11513582
> 
> 赞同：0
> 
> 时间：2012-07-16T22:33:57.350
> 
> 标签：wordpress, wordpress-theming, mobile-website

我想为已经存在的 Wordpress 网站建立一个移动网站。如果用户从移动设备浏览，我更喜欢自动将用户重定向到移动站点。我还需要定期更改页面的内容，并且可能需要随着时间的推移添加更多页面。但我不想为桌面和移动设备创建同一页面的两个不同副本。

请提出解决这种情况的最佳选择。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:00:19.670

我认为您几乎必须设计您的主题以根据需要动态更改其正在执行的操作。这可能只是激活正确样式表的问题，或者可能更复杂。

有一本关于这个主题的好书，你可能想看看。

[http://www.amazon.com/Professional-Development-WordPress-Programmer-ebook/dp/B004T6RKT0/ref=dp_kinw_strp_1?ie=UTF8&m=AG56TWVU5XWC2](https://rads.stackoverflow.com/amzn/click/com/B004T6RKT0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T07:27:07.663

您想要两个具有相同内容的站点，但您不想输入两次内容，并且出于某种原因您不希望该站点具有响应性。这让事情变得困难。

从理论上讲，您可以让两个站点从同一个数据库中获取信息，但实际上构建响应式站点更有意义。

无论如何，如果您必须有两个站点，您可以从使用[这个 PHP 类](http://detectmobilebrowsers.mobi/)检测移动设备开始。

# outlook - 是否可以直接查看 Outlook (VSTO) 加载项的标准输出和标准错误？

> ID：11513585
> 
> 赞同：2
> 
> 时间：2012-07-16T22:34:19.000
> 
> 标签：outlook, vsto, add-in, outlook-addin

我的代码在 Outlook 加载项上下文之外运行良好，但在 Outlook 加载项中运行时显然失败。我觉得如果我只能阅读 stderr 和 stdout 流，我可能会弄清楚它为什么会崩溃。

在我开始编写自定义代码来查找错误之前，我想知道 Outlook 是否已经在某处记录了这些流以用于加载项。

# html - 将数据从 MS Access 发送到 html 表单

> ID：11513588
> 
> 赞同：0
> 
> 时间：2012-07-16T22:34:34.980
> 
> 标签：html, ms-access, vba

我想从 MS Access 将数据发送到 html 表单。

我想做这样的事情：

`http://webaddress/form.php?what=something`

来自 Visual Basic。我可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:55:34.623

我会试一试，并假设您*没有*托管 MS-Access 数据库中的页面。

您需要做的是在您的项目中引用 Microsoft Web 浏览器控件，并将带有参数的 URL 传递给该控件。然后，您可以监视控件以查看服务器是否向您发送了错误代码，以及来自服务器的消息。

这是一个链接：http: [//support.microsoft.com/kb/304643](http://support.microsoft.com/kb/304643)

# c - 取消 getchar()

> ID：11513593
> 
> 赞同：3
> 
> 时间：2012-07-16T22:34:48.393
> 
> 标签：c, pthreads, getchar

我有一个进行大量处理的小程序。您可以通过按回车键来打印进度。

我实现这一点的方法是在主线程中完成处理，同时我有一个 pthread 在 getchar() 上不断循环以等待输入键。

问题是当我完成处理时。发生这种情况时，主线程完成，但仍等待按 enter，因为 getchar() 被阻塞。

如何“取消”getchar()？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:58:26.940

我能想到的最便携的解决方案是：

*   用于`pipe()`构造两个 FD，一个是 reader，另一个是 writer。给读者你的`read()`循环；将作者交给需要终止读者的人。
*   从读取线程中使用`select()`以等待标准输入和读取器管道的可读性。
*   如果标准输入变得可读，则读取一个字符，处理它，然后重新启动循环。
*   如果阅读器管道变得可读，则关闭它并终止循环。

现在，您所要做的就是关闭管道的另一端，这将唤醒阅读器线程，`select()`然后它应该终止。

传统方法涉及使用信号，但是这种基于管道的解决方案允许您检查标准输入上的输入以及检查是否应该使用相同的轮询机制终止。

* * *

请注意，混合`getchar()`和`select()`将不起作用，因为`getchar()`将在后台有效使用，并且即使有可用数据，`fread()`执行的缓冲`fread()`也可能导致阻塞。`select()`改为使用`read()`。这是我用来测试这种方法的示例程序。

```
#include <stdio.h>
#include <pthread.h>
#include <unistd.h>
#include <sys/select.h>

void * entry_point(void * p) {
    int readpipe = *(int *)p;
    fd_set rfds;

    char c;

    for (;;) {
        FD_ZERO(&rfds);
        FD_SET(STDIN_FILENO, &rfds);
        FD_SET(readpipe, &rfds);

        while (select(readpipe + 1, &rfds, NULL, NULL, NULL) == 0);

        if (FD_ISSET(readpipe, &rfds)) {
            close(readpipe);
            break;
        }

        if (FD_ISSET(STDIN_FILENO, &rfds)) {
            if (read(STDIN_FILENO, &c, sizeof(c)) > 0) {
                printf("Read: %d\n", c);
            }
        }
    }

    printf("Thread terminating\n");

    pthread_exit(NULL);
}

int main() {
    pthread_t thread;
    int r;
    int pipes[2];

    pipe(pipes);

    if (r = pthread_create(&thread, NULL, entry_point, &pipes[0])) {
        printf("Error: %d\n", r);
        return 1;
    }

    sleep(5);

    printf("Closing pipe and joining thread.\n");

    close(pipes[1]);
    pthread_join(thread, NULL);

    pthread_exit(NULL);
} 
```

示例运行：

```
$ time ./test
1
Read: 49
Read: 10
2
Read: 50
Read: 10
3
Read: 51
Read: 10
4
Read: 52
Read: 10
5
Read: 53
Read: 10
Closing pipe and joining thread.
Thread terminating

real    0m5.004s
user    0m0.004s
sys     0m0.000s 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:42:43.067

假设您想走这条路，您可以使用 pthread_kill 强制您的 getchar 线程退出。请参阅[Pthread 库中的终止线程](https://stackoverflow.com/questions/2084830/kill-thread-in-pthread)。同样，虽然不是最佳编程实践。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:19:40.823

有一个共享变量怎么样。然后在每次 getchar() 返回后，它都会获取一个锁，然后检查是否设置了这个共享变量。如果不是，那么它会执行您所做的任何事情，如果已设置，则线程退出。这样，当 main 退出时，它会获取一个锁，设置变量，释放锁，打印到标准输入，然后等待另一个线程退出。有点复杂，但它应该工作。〜本

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-16T22:47:32.247

使用 printf() 将字符写入标准输入。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-16T22:49:39.197

我真的很喜欢关闭标准输入的想法。这很好，可能会奏效。

以下关闭标准输入： close(0); fclose（标准输入）；关闭（STDIN_FILENO）；守护进程(0, 0);

您也可以从主线程向标准输入写入特殊的字符序列或 EOF，然后将其关闭。

# c# - 带有可变图像的简单 WPF 按钮控件模板？

> ID：11513597
> 
> 赞同：1
> 
> 时间：2012-07-16T22:34:58.227
> 
> 标签：c#, wpf, button, controls, controltemplate

我还是 WPF 的新手（用它编写我的第一个应用程序），但基本上我想要（或认为我想要）创建一个具有 3 个图像（空闲、悬停、onClick）但我可以更改图像的控件. 所以现在我有：

```
 <Rectangle Height="29" Width="35" Margin="0,2,0,0"
                       HorizontalAlignment="Left" VerticalAlignment="Top" 
                       Name="BTN_OpenDeviceSettings" ToolTip="Open Device Settings"
                       Fill="{DynamicResource device_grid___open_grid}"
                       MouseEnter="BTN_OpenDeviceSettings_MouseEnter"
                       MouseLeave="BTN_OpenDeviceSettings_MouseLeave"
                       MouseLeftButtonDown="BTN_OpenDeviceSettings_MouseLeftButtonDown"
                       MouseLeftButtonUp="BTN_OpenDeviceSettings_MouseLeftButtonUp">
                </Rectangle> 
```

而且效果很好。但我想将图形与代码分开，为了完成这项工作，我在我的 C# 代码中手动交换了填充图像。我见过这样的代码：

```
<Button Name="btnNext" Padding="15,3" HorizontalAlignment="Right" Click="OnButtonClick">
    <Image Width="90" Height="90">
        <Image.Style>
            <Style TargetType="Image">
                <Setter Property="Source" Value="/resources/a.png" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Source" Value="/resources/b.png" />
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Image.Style>
    </Image>
</Button> 
```

所以我认为这就是我想要的。但理想情况下，我将拥有许多这样的按钮，所以我可以创建一些东西以便我这样做：

```
<MyButton>
  <Images idleImage="someimage.png" hoverImage="someOtherImage.png" clickImage="someOtherOtherImage.png" onCLick="some_cSharp_method_to_call" />
</MyButton> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:43:41.837

第一个解决方案：您可以为按钮创建一个控件模板（或样式，如果您打算仅在按钮中显示图像），它将声明哪些图像将用于重叠/单击/其他操作。此样式将由您想要的所有按钮共享，因为它将具有指定的键。

第二种解决方案：您可以子类化按钮并为悬停/空闲/单击的图像声明 3 个依赖属性。然后，您将需要一些默认模板（如果按钮仅显示图像，则为样式），您的子类按钮将使用该依赖项属性。

# javascript - 我需要用 Javascript 重写我的客户端库吗？

> ID：11513601
> 
> 赞同：0
> 
> 时间：2012-07-16T22:35:27.080
> 
> 标签：javascript, html, api, client

对于我的 IOS 应用程序，客户端通过 C 中相当大的客户端库与服务器交互。我正在网站上重新创建应用程序，我想知道是否需要用 javascript 重写这个库。是否可以说，通过本地存储将原始静态客户端库传输到客户端并以某种方式执行？或者将其作为插件下载（我将如何做到这一点）？这只是猜测。任何可能的解决方案的想法都会非常有帮助。它需要在客户端，因为它通过 tcp 流式传输和解码视频源。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:45:56.653

当您的 iOS 应用程序使用 C 语言库时，唯一的方法（有点实验性）是使用[Google Native Client](http://code.google.com/p/nativeclient/)，这是一种沙盒技术，用于从 Web 浏览器安全地运行 Intel x86 或 ARM 本机代码的子集。但到目前为止，它仅在 Chrome 上可用。否则，您必须用 Javascript 编写它才能跨平台并从几乎每个 Web 浏览器中运行它。此外，您可以修改我们的 iOS 应用程序并使其*[混合](http://publib.boulder.ibm.com/infocenter/wchelp/v7r0m0/index.jsp?topic=/com.ibm.commerce.starterstores.doc/concepts/csmmobileapphybridi.htm)*，然后您可以在您的 iOS 应用程序和客户端 Web 浏览器中使用相同的 Javascript 库。

# facebook - autologoutlink="true" 导致 Firefox 14 中的登录按钮宽度增加

> ID：11513603
> 
> 赞同：0
> 
> 时间：2012-07-16T22:35:56.070
> 
> 标签：facebook, button, login, xfbml, facebook-fbml

最近（不确定是什么时候）我网站上的 fb:login-button 在 Firefox 中的宽度开始缓慢增加。我可以通过设置 autologoutlink="false" 来阻止这种情况的发生，但我想将其设置为 true。您可以在以下站点上看到这一点，因为“备份”按钮从左到右穿过页面。

[http://grepbook.co.uk/](http://grepbook.co.uk/)

# json - 带有 mongorecord 的 DateTimeField 的 JSON 中的自定义格式

> ID：11513604
> 
> 赞同：1
> 
> 时间：2012-07-16T22:36:17.627
> 
> 标签：json, scala, mongodb, datetime, lift

我正在使用lift-mongodb-record 2.4。我所有的 MongoRecord 模型都包含以下[DateTimeField](http://scala-tools.org/mvnsites/liftweb-2.3/net/liftweb/record/field/DateTimeField.html)字段，例如：

```
object created_at extends DateTimeField(this) 
```

当我在这个模型上调用 asJSON 时，它会将日期解析为字符串，例如

```
Mon, 16 Jul 2012 21:26:58 GMT 
```

我更喜欢其他格式（例如 ISO 8601，取决于实际用例）

*我将如何以及在哪里设置自定义格式？*

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T12:53:49.960

覆盖*asJValue* 和*setFromJValue*应该可以解决问题，因为默认实现使用所谓的互联网日期，如下所示：

```
val statusDate = new DateTimeField(this){

  val sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
  override def asJValue = {
    asJString(v => sdf.format(v.getTime))
  }

  override def setFromJValue(jvalue: JValue) = setFromJString(jvalue) {
    v =>tryo {
        sdf.parse(v)
      }.map(d => {
      val cal = Calendar.getInstance
      cal.setTime(d)
      cal
    })
  }
} 
```

# c# - RestSharp - 无法将 System.String 的对象转换为 System.Generic.IDictionary 类型

> ID：11513607
> 
> 赞同：4
> 
> 时间：2012-07-16T22:36:44.570
> 
> 标签：c#, .net, http, rest

我是 RestSharp 的新手。我在 python 中有一个 Restful Service writtein，它返回一条 Json 消息。我使用 RestSharp 编写了一个 C# 客户端，将 json 消息反序列化为对象。

响应内容为 "\"[{\\"coupon\\": 4.5, \\"cusip\\": \\"912810QB7\\", \\"currface\\": 1000000, \\"origface\ \": 1000000}]\""

response.data 为空。

响应对象中的内部异常是“无法将 'System.String' 类型的对象转换为 'System.Collections.Generic.IDictionary`2[System.String,System.Object]'。”

以下是我的代码：

```
public class QuartzServiceAdapter
{
    const string BaseUrl = "http://localhost:7666/ahs/";

    public QuartzServiceAdapter() { }

    public T Execute<T>(RestRequest request) where T : new()
    {
        var client = new RestClient();
        client.BaseUrl = BaseUrl;
        var response = client.Execute<T>(request);
        return response.Data;
    }

    public List<RootObject> GetBond()
    {
        var request = new RestRequest(Method.GET);
        request.OnBeforeDeserialization = resp => { resp.ContentType = "application/json"; };
        request.Resource = "getabond";
        //request.RootElement = "RootObject";
        return Execute<List<RootObject>>(request);
    }
} 
```

[我使用http://json2csharp.com/](http://json2csharp.com/)创建了以下对象

```
public class RootObject
{
    public double coupon { get; set; }
    public string cusip { get; set; }
    public int currface { get; set; }
    public int origface { get; set; }
} 
```

关于反序列化为什么失败的任何想法？先感谢您！

# c# - 通过读取 web.config 来更改 Web 服务的 url

> ID：11513609
> 
> 赞同：1
> 
> 时间：2012-07-16T22:37:27.050
> 
> 标签：c#, web-services, asmx

我有一个使用 asmx Web 服务的 WCF 应用程序。我在应用程序的一百万个地方使用网络服务：

```
 public string LogOnUser(string username, string password, string db)
    {
        var wsi = new ASMXServiceInterface();
        return wsi.LogIn();
      }

    public string GetNotes(string username, string password, string db)
    {
        var wsi = new ASMXServiceInterface();
        return wsi.GetNotes();
      }

    etc, etc etc... 
```

当然我想在contructor中设置服务的url，但是它在reference.cs中自动生成，如果我在那里改变它，它可以工作，但是如果我更新我的引用（我会）它丢失了，我必须手动再来一遍：

```
 /// <remarks/>
    public ASMXServiceInterface()
    {
        this.Url = 
    System.Web.Configuration.WebConfigurationManager.AppSettings["RQTCSServiceURL"];
   } 
```

Web 服务 url 需要是动态的，因为它已经实现了不同的版本。如何在我的 WCF 项目中设置我的 Web 服务的 url，以便可以在 web.config 中更改服务的 url 而无需在 reference.cs 中进行更改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:43:12.497

您可以通过将 UrlBehaviour 转换为动态来更改 web 服务的自动生成 url

请参阅有关如何操作的示例[http://www.codeproject.com/Articles/12317/How-to-make-your-Web-Reference-proxy-URL-dynamic](http://www.codeproject.com/Articles/12317/How-to-make-your-Web-Reference-proxy-URL-dynamic)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T22:42:04.150

您可以通过向您的 web.config 添加一个密钥来执行此操作，例如：

```
<add key="webserviceURL" value ="https://mywebservice.com/WebService.asmx" /> 
```

然后在您的代码中，执行以下操作：

```
private static WebService createWebService() {
        WebService service= new WebService();

        string url = ConfigurationManager.AppSettings["webserviceURL"];
        if ( !string.IsNullOrEmpty(url) ) {
            service.Url = url;
        }

        return service;
    } 
```

# java - Java - 如何将特殊字符放入字符串中

> ID：11513610
> 
> 赞同：0
> 
> 时间：2012-07-16T22:37:27.680
> 
> 标签：java

Java 似乎有很好的字符串处理。尽管如此，我还是遇到了最简单的问题。我需要动态字符串（它们在运行时更改），因此 String 类型不是一个好的选择，因为它们是不可变的。所以我正在使用 char 数组。设置有点痛苦，但至少它们是可修改的。我想创建一个字符串常量，其中包含回车/换行对（或其他控制字符）。在 C/C++ 中，您只需这样做：

```
char myString[100];
myString = "This is a string with a CR/LF pair\x0D\x0A"; 
```

是的，我知道在 java 中你可以使用“\r”。是的，我知道你可以使用：

```
myString[34] = 0x000D;
myString[35] = 0x000A; 
```

而在 Java 中，您真的不能使用字符串文字常量来初始化 char 数组（可以吗？？）。那么如何初始化一个 char 数组是个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:40:07.627

你可以做

```
char[] myString = 
   "This is a string with a CR/LF pair\u000D\u000A".toCharArray(); 
```

如果那是问题。

此外，还有 StringBuilder 可以处理可变字符串（它只是包装了一个 char[]）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:40:24.650

使用[`String.ToCharArray`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#toCharArray%28%29)：

```
char[] chars = "This is a string\r\n".ToCharArray(); 
```

您也可以使用[`StringBuilder`](http://docs.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)可变的 a。

# c# - HttpModule 不适用于 ajax 请求

> ID：11513611
> 
> 赞同：0
> 
> 时间：2012-07-16T22:37:31.370
> 
> 标签：c#, .net, ajax, httpmodule

我有一个关于 .net HttpModule 的问题。我创建了一个 HttpModule 来捕获网站的请求，它可以捕获除 ajax 请求之外的所有网站页面。

这是我的 web.config。Moduler.FilterModuler 是我创建的。谢谢。

```
 `<httpModules>
       <add name="handleTimeOut" type="Moduler.FilterModuler"/>
   </httpModules>

    <system.webServer>
       <validation validateIntegratedModeConfiguration="false"/>
<modules>
<remove name="ScriptModule"/>
<add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
 </modules>
  <handlers>
    <remove name="WebServiceHandlerFactory-Integrated"/>
    <remove name="ScriptHandlerFactory"/>
    <remove name="ScriptHandlerFactoryAppServices"/>
        <remove name="ScriptResource"/>
        <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add name="ScriptResource" verb="GET,HEAD" path="ScriptResource.axd" preCondition="integratedMode" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
</handlers></system.webServer>` 
```

这是我的模块。

```
 namespace Moduler
    {
        public class FilterModuler : IHttpModule, IReadOnlySessionState
        {
    private class ResponseCaptureStream : Stream
    {
        private readonly Stream _streamToCapture;
        private readonly Encoding _responseEncoding;

        private string _streamContent;
        public string StreamContent
        {
            get { return _streamContent; }
            private set
            {
                _streamContent = value;
            }
        }

        public ResponseCaptureStream(Stream streamToCapture, Encoding responseEncoding)
        {
            _responseEncoding = responseEncoding;
            _streamToCapture = streamToCapture;

        }

        public override bool CanRead
        {
            get { return _streamToCapture.CanRead; }
        }

        public override bool CanSeek
        {
            get { return _streamToCapture.CanSeek; }
        }

        public override bool CanWrite
        {
            get { return _streamToCapture.CanWrite; }
        }

        public override void Flush()
        {
            _streamToCapture.Flush();
        }

        public override long Length
        {
            get { return _streamToCapture.Length; }
        }

        public override long Position
        {
            get
            {
                return _streamToCapture.Position;
            }
            set
            {
                _streamToCapture.Position = value;
            }
        }

        public override int Read(byte[] buffer, int offset, int count)
        {
            return _streamToCapture.Read(buffer, offset, count);
        }

        public override long Seek(long offset, SeekOrigin origin)
        {
            return _streamToCapture.Seek(offset, origin);
        }

        public override void SetLength(long value)
        {
            _streamToCapture.SetLength(value);
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            string str = _responseEncoding.GetString(buffer, offset, count);
            _streamContent += str;
        }

        public override void Close()
        {
            _streamContent = _streamContent.Replace("$Social Work$", "hello world");
            byte[] data = _responseEncoding.GetBytes(_streamContent);
            _streamToCapture.Write(data, 0, data.Length);
            _streamToCapture.Close();
            base.Close();
        }
    }
    public void Dispose()
    {

    }

    public void Init(HttpApplication context)
    {
        context.BeginRequest +=new EventHandler(context_BeginRequest);
        context.ReleaseRequestState += new EventHandler(context_ReleaseRequestState);
    }

    protected void context_ReleaseRequestState(object sender, EventArgs e)
    {
        HttpApplication application = (HttpApplication)sender;
        string[] temp = application.Request.CurrentExecutionFilePath.Split('.');
        if (temp.Length > 0 && temp[temp.Length - 1].ToLower() == "aspx")
        {
            application.Response.Filter = new ResponseCaptureStream(application.Response.Filter, application.Response.ContentEncoding);
        }

    }

    protected void context_BeginRequest(object sender, EventArgs e)
    {
        HttpApplication application = (HttpApplication)sender;
        using (StreamWriter sw = new StreamWriter("C:\\work\\request.txt"))
        {
            sw.Write(application.Request.CurrentExecutionFilePath);
        }
    }

    public FilterModuler()
    {
        //
        // TODO: Add constructor logic here
        //
    }
} 
```

}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:02:00.977

我用这个例子解决了一个类似的问题 could not capture the HttpModule events solicudes AJAX

[HttpModule 处理 Ajax 调用](http://www.codeproject.com/Articles/29573/Using-HttpModule-to-Handle-Ajax-Calls)
我希望你的功能

# silverlight - 在 Silverlight 中拖动具有透明背景的图像

> ID：11513613
> 
> 赞同：0
> 
> 时间：2012-07-16T22:38:04.763
> 
> 标签：silverlight, image, drag, transparent

我有一个画布（拼图）和一个透明背景的子 png 图像列表（拼图部件）。仅当鼠标悬停在图像的非透明部分上时，我才需要拖动这些图像。因此，我的实现如下所示：

```
 public class Puzzle : Canvas
    {
        public Puzzle()
        {
            Background = new SolidColorBrush(Colors.Transparent);
            MouseLeftButtonDown += Puzzle_MouseLeftButtonDown;
        }

        public void Load(PuzzleSettings settings)
        {
            foreach (var child in Children)
            {
                //child.MouseLeftButtonDown -= OnMouseLeftButtonDown;
                child.MouseLeftButtonUp -= OnMouseLeftButtonUp;
                child.MouseMove -= OnMouseMove;
            }
            Children.Clear();

            foreach (var part in settings.Parts)
            {
                var puzzlePart = new PuzzlePart(part);
                //puzzlePart.MouseLeftButtonDown += OnMouseLeftButtonDown;
                puzzlePart.MouseLeftButtonUp += OnMouseLeftButtonUp;
                puzzlePart.MouseMove += OnMouseMove;

                Children.Add(puzzlePart);
            }
        }

        /// Finds all PuzzleParts under mouse pointer and first of them with non-
        /// transparent pixel (dragging PuzzlePart)
        private void Puzzle_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            var elements = VisualTreeHelper.FindElementsInHostCoordinates(e.GetPosition(null), this);

            foreach (var element in elements)
            {

                if (!(element is PuzzlePart))
                    continue;

                var part = element as PuzzlePart;

                if (!IsTransparentPixel(part, e.GetPosition(part)))
                {
                    OnMouseLeftButtonDown(part, e);
                    break;
                }
            }
        }

        /// Checks if specific pixel of PuzzlePart is transparent
        private bool IsTransparentPixel(PuzzlePart part, Point point)
        {
            var uri = new Uri(part.Settings.ImagePath, UriKind.Relative);
            var bitmapImage = new BitmapImage {CreateOptions = BitmapCreateOptions.None, UriSource = uri};
            var writableBitmap = new WriteableBitmap(bitmapImage);

            // check bounds
            if (point.X < 0.0 || point.X > writableBitmap.PixelWidth - 1 ||
                point.Y < 0.0 || point.Y > writableBitmap.PixelHeight - 1)
                return false;

            var row = (int)Math.Floor(point.Y);
            var col = (int)Math.Floor(point.X);

            int pixel = writableBitmap.Pixels[row * writableBitmap.PixelWidth + col];
            byte[] pixelBytes = BitConverter.GetBytes(pixel);

            if (pixelBytes[0] == 0x00)
                return true;

            return false;
        }

        private bool _isDragging;

        private Point _lastPosition;

        private double _offsetX;

        private double _offsetY;

        private int _lastZIndex;

        #region Puzzle part dragging

        /// Performs PuzzlePart dragging
        private void OnMouseMove(object sender, MouseEventArgs e)
        {
            if (_isDragging)
            {
                var puzzlePart = (PuzzlePart) sender;

                Point p = e.GetPosition(this);
                double x = p.X - _offsetX;
                double y = p.Y - _offsetY;

                var displacementX = puzzlePart.Settings.ControlPoint.Position.X - x;
                var displacementY = puzzlePart.Settings.ControlPoint.Position.Y - y;

                if (Math.Sqrt(displacementX * displacementX + displacementY * displacementY) < _sensivity)
                {
                    x = puzzlePart.Settings.ControlPoint.Position.X;
                    y = puzzlePart.Settings.ControlPoint.Position.Y;
                }

                // Set the new position for the puzzle part control.
                puzzlePart.SetValue(LeftProperty, x);
                puzzlePart.SetValue(TopProperty, y);
            }
        }

        /// Ends drag operation
        private void OnMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
        {
            var element = (UIElement)sender; 

            _isDragging = false;
            element.ReleaseMouseCapture();
            _lastPuzzlePart = (PuzzlePart) element;
        }

        /// Begins drag operation
        private void OnMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {

            var puzzlePart = (PuzzlePart) sender;
            puzzlePart.CaptureMouse();
            _isDragging = true;
            SetZIndex(puzzlePart, _lastZIndex++);
            _lastPosition = e.GetPosition(puzzlePart);
            _offsetX = _lastPosition.X;
            _offsetY = _lastPosition.Y;
        }

        #endregion
    } 
```

当 PuzzlePart 位于 Canvas 顶部时，它工作得很好，但是当 PuzzlePart 不在顶部时，我在拖动时遇到性能问题，它需要通过检查鼠标悬停在像素上来找到拖动图像。我不明白是什么问题。我的 XAML 代码：

```
<phone:PhoneApplicationPage
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" xmlns:eim="clr-namespace:Microsoft.Expression.Interactivity.Media;assembly=Microsoft.Expression.Interactions"
    xmlns:Controls="clr-namespace:KidsABCPuzzle.Controls;assembly=KidsABCPuzzle.Controls"
    x:Class="KidsABCPuzzle.Views.PuzzleView"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Landscape" Orientation="Landscape"
    mc:Ignorable="d" d:DesignHeight="480" d:DesignWidth="800"
    shell:SystemTray.IsVisible="False">
    <phone:PhoneApplicationPage.Resources>
        <Storyboard x:Name="LoadedStoryboard">
            <DoubleAnimation Duration="0:0:1" To="0.6" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="border" d:IsOptimized="True">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </phone:PhoneApplicationPage.Resources>

    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Image Source="../Images/Level1.png"/>
        <Border x:Name="border" Background="White" Opacity="0.0">
            <i:Interaction.Triggers>
                <i:EventTrigger>
                    <eim:ControlStoryboardAction Storyboard="{StaticResource LoadedStoryboard}"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </Border>
        <Controls:Puzzle x:Name="puzzle"/>
    </Grid>
</phone:PhoneApplicationPage> 
```

和拼图部分：

```
<Style TargetType="Controls:PuzzlePart">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Controls:PuzzlePart">
                <Grid>
                    <Image x:Name="Image"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

    /// <summary>
    /// Represents puzzle part
    /// </summary>
    [TemplatePart(Name = "Image", Type = typeof(Image))]
    public class PuzzlePart : ContentControl
    {
        /// <summary>
        /// Image of puzzle part
        /// </summary>
        public Image Image { get; private set; }

        public PuzzlePartSettings Settings { get; set; }

        /// <summary>
        /// Default constructor
        /// </summary>
        /// <param name="point"> Intialization placement. </param>
        public PuzzlePart(ControlPoint point)
        {
            DefaultStyleKey = typeof(PuzzlePart);

            Settings.ControlPoint = point;
        }

        public PuzzlePart(PuzzlePartSettings settings)
        {
            DefaultStyleKey = typeof (PuzzlePart);

            Settings = settings;
        }

        /// <summary>
        /// Applies default template
        /// </summary>
        public override void  OnApplyTemplate()
        {
            base.OnApplyTemplate();
            Image = (Image)GetTemplateChild("Image");

            if (Settings != null 
                && !string.IsNullOrEmpty(Settings.ImagePath))
            {
                Image.Source = new BitmapImage(new Uri(Settings.ImagePath, UriKind.Relative));
            }
        }
    } 
```

# cocos2d-iphone - 未能及时恢复 Crashlog

> ID：11513615
> 
> 赞同：2
> 
> 时间：2012-07-16T22:38:12.213
> 
> 标签：cocos2d-iphone, crash, crash-reports

我试图找出“未能及时恢复”的问题。在我们的一个测试设备（它是具有最新操作系统的 iPhone 4S）中，它经常发生，而在我自己的设备中，它似乎根本没有发生。

无论如何，我得到了一些崩溃日志。我无法追查原因的根源。我知道这个问题可能是

1.当一个进程阻塞主线程太久时。

2.当出现内存问题时。

我认为内存不是什么大问题，因为它似乎发生在用户离开主菜单并返回时。主菜单中没有发生任何事情，因此它可能是一项运行时间过长的任务。

以下是崩溃日志的摘录：

![](../Images/2b680ea373b4738e20d37e09ef32a6d6.png)

有人可以帮助我或指导我谁可以追踪问题的原因吗？反正有没有关闭看门狗定时器（可能不是吧？）另外，突出显示的线程指的是什么？

1.  我已经检查了我的 applicationDidBecomeActive 和 applicationWillEnterForeground 以确保那里没有发生任何事情。

2.  据我所知，此时没有进行同步调用。可达性是否使用同步调用来检查互联网？我该如何检查呢？

3.  我不会在恢复时进行任何大数据传输。

4.  我注意到 GameCenter 在恢复您的应用程序时会自动登录或检查登录。有没有办法防止这种情况发生？这可能会导致超时问题吗？

我试着做一个时间档案，但我不明白如何用它来分析。如果你能为此提供一个很好的资源，那就太棒了。

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T23:06:42.297

您当前处于“尝试查找问题模式”。您应该切换到“尝试找出这到底是一个多大的问题”模式。

所以去寻找另一个4S（实际上尽可能多）以排除这是一个特定于设备的问题。如果它发生在所有4S上，应该更容易查明。如果没有，请让其他人检查它，讨论可能的原因。当您陷入死胡同时，对等编程方法通常会有所帮助。

如果问题仅在该设备上，您可能需要检查它是否损坏（或“越狱”），或者可能只需要硬重启（保持电源和家庭 10 秒以上）。

如果它只发生在某些设备上而不是所有设备上，请尝试找出它们的共同点。这可能是语言/区域设置或听写，实际上是用户可能更改的任何类型的设置。如有必要，编写一个记录器，将尽可能多的设置记录到您的（Web）服务器，以便您可以逐一比较设置并快速丢弃那些不同步的设置。

如果只有极少数设备受到影响，您也可以忽略该问题，并希望用户的其他崩溃日志能够揭示问题的关键。

最后，总是可以选择在终止时禁用挂起，而是在按下主页按钮时终止应用程序（就像在 iOS 4 之前一样）。当然，除非应用程序必须在后台运行。

# php - 验证表单 php 4 个输入，必须填写一个

> ID：11513619
> 
> 赞同：0
> 
> 时间：2012-07-16T22:38:50.640
> 
> 标签：php

我有一张表格，我需要填写一个字段。我正在尝试但没有任何成功。

请指出我做错了什么。

```
if($text1=='' && $text2=='' && ($text3!='' || $text4!='' || $text5!='' || $text6!='')){

                    $abc->redirect('../xxxx.php');  
                    exit;

                    }

<tr>
<td>title: $</td>
<td><input type="text" id="dailyprice" name="text1" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
<td>Desc: $</td>
<td><input type="text" id="weeklyprice" name="text2" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
</tr>

<tr>
<td>Daily Price: $</td>
<td><input type="text" id="dailyprice" name="text3" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
<td>Weekly Price: $</td>
<td><input type="text" id="weeklyprice" name="text4" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
</tr>
<tr>
<td>Weekend Price: $</td>
<td><input type="text" id="weekendprice" name="text5" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
<td>Monthly Price: $</td>
<td><input type="text" id="monthlyprice" name="text6" style="height: 25px; border: 1px solid #888; width: 80px;"></td>
</tr> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:59:13.960

如果我理解正确，然后尝试这样的事情。

```
if ((empty($text1) && empty($text2)) || (empty($text3) && empty($text4) && empty($text5) && empty($text5)) {
     $abc->redirect('../xxxx.php');
     exit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:59:14.253

试试这个

```
if(isset($text1)== True && isset($text2)== True)) || (isset($text3)==True xor isset($text4)=True xor isset($text5)==true xor isset($text6)==true) 
```

# ruby-on-rails - Bundler: You are trying to install in deployment mode after changing your Gemfile

> ID：11513623
> 
> 赞同：93
> 
> 时间：2012-07-16T22:39:05.543
> 
> 标签：ruby-on-rails, capistrano, bundler

I'm pretty new to bundler and capistrano, and I'm trying to use them together. When I try to deploy, I get the message:

> You are trying to install in deployment mode after changing your Gemfile. Run `bundle install' elsewhere and add the updated Gemfile.lock to version control.

I don't know how to satisfy the system that's complaining, and I don't understand why the complaint is coming up because I read in [the doc](http://gembundler.com/man/bundle-install.1.html):

> If a Gemfile.lock does exist, and you have updated your Gemfile(5), bundler will use the dependencies in the Gemfile.lock for all gems that you did not update, but will re-resolve the dependencies of gems that you did update. You can find more information about this update process below under CONSERVATIVE UPDATING.

I interpret that to mean that the Bundler can handle the fact that my Gemfile is not whatever it expected. Any help?

*Specs: Ruby 1.9.3, Rails 3.2.3, Capistrano 2.12.0, Bundler 1.1.4, Windows 7, deploying to a Posix machine.*

**Edit:** My Gemfile includes logic blocks like the following:

```
unless RbConfig::CONFIG['host_os'] === 'mingw32'
  # gem 'a' ...
end 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-07-16T23:04:57.667

The error message you're getting regarding `Gemfile.lock` may be because your `Gemfile` and `Gemfile.lock` don't agree with each other. It sounds like you've changed something in your Gemfile since you last ran `bundle install` (or `update`). When you `bundle install`, it updates your Gemfile.lock with any changes you've made to Gemfile.

Make sure you run `bundle install` locally, and check-in to source control your newly updated `Gemfile.lock` after that. Then try deploying.

**Edit**: As recognised in the comments, a conditional in the Gemfile resulted in a valid Gemfile.lock on one platform, invalid on another. Providing a [:platform](http://gembundler.com/man/gemfile.5.html#PLATFORMS-platforms-) flag for these platform-dependent gems in the Gemfile should solve the asymmetry.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-05-23T12:00:29.687

vi .bundle/config

change the BUNDLE_FROZEN option from '1' to '0'

do "bundle install"

* * *

OR

run "bundle config"

see if the "frozen" value is true set it to false

bundle config frozen false

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-11-12T21:46:45.387

### Watch out for global Bundler config.

I had a global config on my dev environment in `~/.bundle/config` that I did not have in my CI / Production environment that caused the `Gemfile.lock` that was generated in my dev environment to be different than the one in my CI / Production environment.

In my case I was setting `github.https` to true in my dev environment but had no such config in my CI / Production environment. This caused the two `Gemfile.lock` files to be different.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-05-24T22:17:16.103

When you see the following...

```
$ bundle install
You are trying to install in deployment mode after changing
your Gemfile. Run `bundle install` elsewhere and add the
updated Gemfile.lock to version control.

If this is a development machine, remove the Gemfile freeze
by running `bundle install --no-deployment`.

You have added to the Gemfile:
* source: rubygems repository https://rubygems.org/
* rails (~> 3.2)
. . . 
```

... Then, the problem is most likely that you have outdated .gem files in your vendor/cache directory.

Perhaps, you previously ran `$bundle install --deployment` which put some "outdated" .gem files in the cache?

In any case, you can get past this error by running: `bundle install --no-deployment`

That's one of the many great things about Rails... the error messages often tell you exactly what to do to fix the problem.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-12-22T08:39:22.087

My specific problem was related to what reported by @JoshPinter, i.e. dev-vs-deploy host discrepancies in the protocol used by bundler to retrieve gems from github.

To make a long story short, all I had to was modify the following `Gemfile` entry...

```
gem 'activeadmin', github: 'activeadmin' 
```

...to this secure syntax ([see reference](http://bundler.io/git.html)):

```
gem 'activeadmin', git: 'https://github.com/activeadmin/activeadmin.git' 
```

And my deployments are back to normal.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-09-25T19:02:42.420

The solution for me was slightly different than the others listed here. I was trying to upgrade from sidekiq to sidekiq-pro (which requires bundler 1.7.12+), but I kept getting the "You are trying to install in deployment mode after changing your Gemfile" message from travis-ci

Inspecting the console output of travis-ci revealed that an older version of bundler was being used.

In my case, I had to edit the travis.yml file to add:

`before_install: - gem update bundler`

This forced travis-ci to use the latest version of bundler, and made the error message go away.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-10-03T18:58:01.793

I don't care. This is what I did. It fixed it.

```
rm -rf .bundle 
rm -rf Gemfile.lock
bundle install 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-10-25T21:33:33.323

```
rm -fr .bundle 
```

Fixed the problem for me.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-08-25T01:04:16.597

Another cause of the error:

This is a bit foolish, but i'm sure someone else will make the same mistake.

For Rails 4 Heroku added the gem rails_12factor. If you were using it before they added it, then you'll have these two gems:

```
gem 'rails_log_stdout',  github: 'heroku/rails_log_stdout'
gem 'rails3_serve_static_assets', github: 'heroku/rails3_serve_static_assets' 
```

You have to remove them when you add the new one. (they're included). I think you can get away with it until you touch them lines in your gem file, then Heroku notices the duplication and cries out with the above error.

good luck with Rails 4.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-12-11T23:35:12.803

After this command, you can do your normal bundle install again:

```
bundle install --no-deployment 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-16T22:52:36.107

I ran into something similar before. One way to fix it, I think, but may take more space on your server than you want, is to run

```
bundle install --deployment 
```

and then try to deploy. This does something like install all of your gems into the vendor folder, which I believe is generally good to avoid... but will still probably work. My app used to behave like this, my solution was removing exact versions to download from in my Gemfile, and then rebundling and deploying.

```
gem 'rails_admin', :git => 'git://github.com/sferik/rails_admin.git', :branch => 'master' 
```

to

```
gem 'rails_admin' 
```

Or you can do what it suggests, and Git your project off the production server onto a local machine, bundle it, and then repush onto your server. This solution might not be 100% correct but some of it worked for me... just thought I'd share. Goodluck

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-06-26T08:41:46.307

In our case we were using a feature that wasn't available in an old version of bundler which ran on our production machine. Therefore it was enough to upgrade bundler, i.e. do a `gem update bundler`.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-02-08T18:38:02.313

This might be a dangerous idea, but if absolutely must test something in a production deploy environment, you can edit the .bundle/config file

```
# This value is normally '1' 
# Set it to '0'
BUNDLE_FROZEN: '0' 
```

Now invoke bundle, in my case I needed to update a specific gem, so this my command

```
RAILS_ENV=production bundle update <whatever gem> 
```

You should probably change it back after the update, so things work like you expect, afterwards. Again, this is probably unsupported, and YMMV

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-09-28T02:20:29.087

I ran into this deploying a Nesta app after some gem updates. What worked for me was to **delete the Gemfile.lock**, run `bundle install` to re-generate it, and deploy again.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-01-14T15:20:23.087

I ran into a similar issue however I did both `bundle install` and `bundle update` and Heroku still rejected my push.

I fixed the issue by just deleting Gemfile.lock and then running `bundle install` again. I then added, committed, and pushed that to my git repo. After that I had no problem pushing to Heroku.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-12-24T05:31:53.167

for heroku, you don't have to change the syntax in the `Gemfile`. you can just add `BUNDLE_GITHUB__HTTPS` (note the double underscore) as an environment variable and set it to `true` (in your heroku app's dashboard under the `Settings` tab in the `Config Vars` section). this will switch the protocol from `git://` to `https://` for all such requests.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-07-13T00:48:48.200

I had the error message when attempting push to Heroku. I found the following solution fixed.

1.  Git pull origin master
2.  Git status
3.  Git commit
4.  Git push origin master
5.  Git push heroku master

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-07-12T06:13:34.673

This issue can be related to submodules pointing to old versions of code. For me, I resolved this issue by updating my submodules

If you have submodules, try running:

`git submodule update --init`

`bundle install`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-01-28T18:13:04.860

I read a dozen solutions on different resources but didn't find exactly what could help me in this situation

So I did find a solution. Exactly saying i read the error message attentively and there was a sollution: **Run bundle install elsewhere**. "Elsewhere" was my Cloud9 where i developed my app. So my steps

1.  copy Gemfile and Gemfile.lock from server to local machine with `rsync` command
2.  insert these two files into my RoR project (i used Cloud9)
3.  open Gemfile and make changes that i want. In my case i added gem 'thin'
4.  in terminal cd to my app on Cloud9 and run `bundle install`. in this case you will have a **changed** version of Gemfile.lock
5.  copy **new** Gemfile and Gemfile.lock on server using `rsync`
6.  cd to my app folder and again run `bundle install --deployment --without development test` DONE! Wish GOOD luck for all!

# python - python: 带有 BeautifulSoup 的 Google 搜索刮板

> ID：11513624
> 
> 赞同：6
> 
> 时间：2012-07-16T22:39:14.197
> 
> 标签：python, screen-scraping, web-scraping, beautifulsoup, urllib

目标：通过搜索字符串在 google 上搜索并抓取 url、标题和与 url 标题一起发布的小描述。

我有以下代码，目前我的代码只给出前 10 个结果，这是一页的默认谷歌限制。我不确定如何在网页抓取期间真正处理分页。此外，当我查看实际页面结果和打印出来的内容时，存在差异。我也不确定解析跨度元素的最佳方法是什么。

到目前为止，我的跨度如下，我想删除`<em>`元素并连接其余的刺。最好的方法是什么？

```
<span class="st">The <em>Beautiful Soup</em> Theater Collective was founded in the summer of 2010 by its Artistic Director, Steven Carl McCasland. A continuation of a student group he <b>...</b><br /></span 
```

代码：

```
from BeautifulSoup import BeautifulSoup
import urllib, urllib2

def google_scrape(query):
    address = "http://www.google.com/search?q=%s&num=100&hl=en&start=0" % (urllib.quote_plus(query))
    request = urllib2.Request(address, None, {'User-Agent':'Mosilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11'})
    urlfile = urllib2.urlopen(request)
    page = urlfile.read()
    soup = BeautifulSoup(page)

    linkdictionary = {}

    for li in soup.findAll('li', attrs={'class':'g'}):
        sLink = li.find('a')
        print sLink['href']
        sSpan = li.find('span', attrs={'class':'st'})
        print sSpan

    return linkdictionary

if __name__ == '__main__':
    links = google_scrape('beautifulsoup') 
```

我的输出如下所示：

```
http://www.crummy.com/software/BeautifulSoup/
<span class="st"><em>Beautiful Soup</em>: a library designed for screen-scraping HTML and XML.<br /></span>
http://pypi.python.org/pypi/BeautifulSoup/3.2.1
<span class="st"><span class="f">Feb 16, 2012 &ndash; </span>HTML/XML parser for quick-turnaround applications like screen-scraping.<br /></span>
http://www.beautifulsouptheatercollective.org/
<span class="st">The <em>Beautiful Soup</em> Theater Collective was founded in the summer of 2010 by its Artistic Director, Steven Carl McCasland. A continuation of a student group he <b>...</b><br /></span>
http://lxml.de/elementsoup.html
<span class="st"><em>BeautifulSoup</em> is a Python package that parses broken HTML, just like lxml supports it based on the parser of libxml2\. <em>BeautifulSoup</em> uses a different parsing <b>...</b><br /></span>
https://launchpad.net/beautifulsoup/
<span class="st">The discussion group is at: http://groups.google.com/group/<em>beautifulsoup</em> &middot; Home page <b>...</b> <em>Beautiful Soup</em> 4.0 series is  the current focus of development <b>...</b><br /></span>
http://www.poetry-online.org/carroll_beautiful_soup.htm
<span class="st"><em>Beautiful Soup BEAUTIFUL Soup</em>, so rich and green, Waiting in a hot tureen! Who for such dainties would not stoop? Soup of the evening, <em>beautiful Soup</em>!<br /></span>
http://www.youtube.com/watch?v=hDG73IAO5M8
<span class="st"><span class="f">Jul 6, 2009 &ndash; </span>taken from the motion picture &quot;Alice in wonderland&quot; (1999) http://www.imdb.com/<wbr>title/tt0164993/<br /></wbr></span>
http://www.soupsong.com/
<span class="st">A witty and substantive research effort on the history of soup and food in all cultures, with over 400 pages of recipes, quotations, stories, traditions, literary <b>...</b><br /></span>
http://www.facebook.com/beautifulsouptc
<span class="st">To connect with The <em>Beautiful Soup</em> Theater Collective, sign up for Facebook <b>...</b> We&#39;re thrilled to announce the cast of <em>Beautiful Soup&#39;s</em> upcoming production of <b>...</b><br /></span>
http://blog.dispatched.ch/webscraping-with-python-and-beautifulsoup/
<span class="st"><span class="f">Mar 15, 2009 &ndash; </span>Recently my life has been a hype; partly due to my upcoming Python addiction. There&#39;s simply no way around it; so I should better confess it in <b>...</b><br /></span> 
```

Google 搜索页面结果具有以下结构：

```
<li class="g">
<div class="vsc" sig="bl_" bved="0CAkQkQo" pved="0CAgQkgowBQ">
<h3 class="r">
<div class="vspib" aria-label="Result details" role="button" tabindex="0">
<div class="s">
<div class="f kv">
<div id="poS5" class="esc slp" style="display:none">
<div class="f slp">3 answers&nbsp;-&nbsp;Jan 16, 2009</div>
<span class="st">
I read this without finding the solution:
<b>...</b>
The "normal" way is to: Go to the
<em>Beautiful Soup</em>
web site,
<b>...</b>
Brian beat me too it, but since I already have
<b>...</b>
<br>
</span>
</div>
<div>
</div>
<h3 id="tbpr_6" class="tbpr" style="display:none">
</li> 
```

每个搜索结果都列在`<li>`元素下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T05:14:03.180

此列表理解将剥离标签。

```
>>> sSpan
<span class="st">The <em>Beautiful Soup</em> Theater Collective was founded in the summer of 2010 by its Artistic Director, Steven Carl McCasland. A continuation of a student group he <b>...</b><br /></span>
>>> [em.replaceWithChildren() for em in sSpan.findAll('em')]
[None]
>>> sSpan
<span class="st">The Beautiful Soup Theater Collective was founded in the summer of 2010 by its Artistic Director, Steven Carl McCasland. A continuation of a student group he <b>...</b><br /></span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:59:57.740

我构造了一个简单的 html***正则表达式***，然后在清理后的字符串上调用 replace 函数以删除点

```
import re

p = re.compile(r'<.*?>')
print p.sub('',str(sSpan)).replace('.','') 
```

前

```
<span class="st">The <em>Beautiful Soup</em> is a collection of all the pretty places you would rather be. All posts are credited via a click through link. For further inspiration of pretty things, <b>...</b><br /></span> 
```

后

```
The Beautiful Soup is a collection of all the pretty places you would rather be All posts are credited via a click through link For further inspiration of pretty things, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-13T08:52:09.430

要从`span`标签中获取文本元素，您可以使用[提供](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#get-text)`.text`的/`get_text()`方法。做所有艰苦的举重，您无需担心如何摆脱标签。`beautifulsoup` `Bs4``<em>`

代码和[完整示例](https://replit.com/@DimitryZub1/Scrape-Google-Search-Actual-Pagination-Python-SerpApi#main.py)（Google[不会显示超过 ~400 个结果](https://support.google.com/websearch/thread/25885806?hl=en&msgid=25963793)。）：

```
from bs4 import BeautifulSoup
import requests, lxml, urllib.parse

def print_extracted_data_from_url(url):
    headers = {
        "User-Agent":
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19582"
    }
    response = requests.get(url, headers=headers).text

    soup = BeautifulSoup(response, 'lxml')

    print(f'Current page: {int(soup.select_one(".YyVfkd").text)}')
    print(f'Current URL: {url}')
    print()

    for container in soup.findAll('div', class_='tF2Cxc'):
        head_text = container.find('h3', class_='LC20lb DKV0Md').text
        head_sum = container.find('div', class_='IsZvec').text
        head_link = container.a['href']
        print(head_text)
        print(head_sum)
        print(head_link)
        print()

    return soup.select_one('a#pnnext')

def scrape():
    next_page_node = print_extracted_data_from_url(
        'https://www.google.com/search?hl=en-US&q=coca cola')

    while next_page_node is not None:
        next_page_url = urllib.parse.urljoin('https://www.google.com',
                                             next_page_node['href'])

        next_page_node = print_extracted_data_from_url(next_page_url)

scrape() 
```

输出：

```
Results via beautifulsoup

Current page: 1
Current URL: https://www.google.com/search?hl=en-US&q=coca cola

The Coca-Cola Company: Refresh the World. Make a Difference
We are here to refresh the world and make a difference. Learn more about the Coca-Cola Company, our brands, and how we strive to do business the right way.‎Contact Us · ‎Careers · ‎Coca-Cola · ‎Coca-Cola System
https://www.coca-colacompany.com/home

Coca-Cola
2021 The Coca-Cola Company, all rights reserved. COCA-COLA®, "TASTE THE FEELING", and the Contour Bottle are trademarks of The Coca-Cola Company.
https://www.coca-cola.com/

Together Tastes Better | Coca-Cola®
Coca-Cola is pairing up with celebrity chefs, talented athletes and more surprise guests all summer long to bring you and your loved ones together over the love ...
https://us.coca-cola.com/ 
```

* * *

或者，您可以使用来自 SerpApi 的[Google 搜索引擎结果 API来实现此目的。](https://serpapi.com/search-api)这是一个带有免费计划的付费 API 查看[Playground](https://serpapi.com/playground?q=london&gl=us&hl=en&num=100)进行测试。

要集成的代码：

```
import os
from serpapi import GoogleSearch

def scrape():

  params = {
    "engine": "google",
    "q": "coca cola",
    "api_key": os.getenv("API_KEY"),
  }

  search = GoogleSearch(params)
  results = search.get_dict()

  print(f"Current page: {results['serpapi_pagination']['current']}")

  for result in results["organic_results"]:
      print(f"Title: {result['title']}\nLink: {result['link']}\n")

  while 'next' in results['serpapi_pagination']:
      search.params_dict["start"] = results['serpapi_pagination']['current'] * 10
      results = search.get_dict()

      print(f"Current page: {results['serpapi_pagination']['current']}")

      for result in results["organic_results"]:
          print(f"Title: {result['title']}\nLink: {result['link']}\n") 
```

输出：

```
Results from SerpApi

Current page: 1
Title: The Coca-Cola Company: Refresh the World. Make a Difference
Link: https://www.coca-colacompany.com/home

Title: Coca-Cola
Link: https://www.coca-cola.com/

Title: Together Tastes Better | Coca-Cola®
Link: https://us.coca-cola.com/

Title: Coca-Cola - Wikipedia
Link: https://en.wikipedia.org/wiki/Coca-Cola

Title: Coca-Cola - Home | Facebook
Link: https://www.facebook.com/Coca-Cola/

Title: The Coca-Cola Company | LinkedIn
Link: https://www.linkedin.com/company/the-coca-cola-company

Title: Coca-Cola UNITED: Home
Link: https://cocacolaunited.com/

Title: World of Coca-Cola: Atlanta Museum & Tourist Attraction
Link: https://www.worldofcoca-cola.com/

Current page: 2
Title: Coca-Cola (@CocaCola) | Twitter
Link: https://twitter.com/cocacola?lang=en 
```

> 免责声明，我为 SerpApi 工作。

# c# - 自定义 MessageBox（对话框）Windows 窗体 C#

> ID：11513626
> 
> 赞同：0
> 
> 时间：2012-07-16T22:39:37.297
> 
> 标签：c#, winforms, dialog, messagebox, showdialog

为了尝试使用对话框而不是 MessageBox，我使用了以下代码：

```
 static public DialogResult ShowDialog(string title, string largeHeading, string smallExplanation,
        string leftButton, string rightButton, Image iconSet)
    {
        using (BetterDialog dialog = new BetterDialog(title, largeHeading, smallExplanation, leftButton,
            rightButton, iconSet))
        {
            DialogResult result = dialog.ShowDialog();
            return result;
        }
    } 
```

有关更多详细信息，请在此处找到此[代码](http://www.dotnetperls.com/customized-dialog)

然后我使用了一个按钮点击事件来调用对话框如下：

```
 private void btnDialog_Click(object sender, EventArgs e)
    {
        BetterDialog dialogBox = new BetterDialog("Special Dialog", "large heading", "small explanation", null, "Ok", null);
        dialogBox.ShowDialog(this);
    } 
```

我得到了错误：

'DotNetPerls.BetterDialog' 不包含带有 6 个参数的构造函数。

怎么了，请问有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:49:36.700

我猜想`BetterDialog`接受 6 个参数的构造函数是私有的（或受保护的）而不是公共的......

这意味着使用它的接口不是通过构造函数，而是仅通过静态方法：

```
private void btnDialog_Click(object sender, EventArgs e)
{
    DialogResult result = BetterDialog.ShowDialog("Special Dialog", "large heading", "small explanation", null, "Ok", null);
    if (result == DialogResult.OK)
    {
       // Do what you want to do when OK button is pressed
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T11:56:19.927

将图片框添加到您的表单并使用`Image.FromFile()`.

# c# - Microsoft Charts for .Net 4，饼图外观

> ID：11513628
> 
> 赞同：2
> 
> 时间：2012-07-16T22:39:42.043
> 
> 标签：c#, .net, mschart, pie-chart

如何在标签中显示百分比和名称，例如。“赢家 32%”和“输家 68%”。我目前只有一个百分比显示使用以下代码：

```
Chart1.Series[0].Label = "#PERCENT{P0}"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:59:50.660

解决方案很简单：

```
Chart1.Series[0].Label = "#VALX #PERCENT{P0}"; 
```

'#VALX' 显示 x 值，因此结合 '#PERCENT{P0}' 会生成一个类似“winners 32%”的标签，其中“winners”是我的 x 值。

# python - 应用过滤器后sqlalchemy更改查询对象？

> ID：11513635
> 
> 赞同：0
> 
> 时间：2012-07-16T22:40:23.640
> 
> 标签：python, sqlalchemy

假设我有一个查询对象

```
query = session.query(SomeModel) \
    .filter(SomeModel.foo == 'bar') \
    .filter(SomeModel.active == True) 
```

您能否在执行查询之前修改对象列表，保持所有相同的过滤器

IE

```
.change_query(SomeModel.id, SomeModel.name) 
```

这样生成的查询对象是：

```
session.query(SomeModel.id, SomeModel.name) \
    .filter(SomeModel.foo == 'bar') \
    .filter(SomeModel.active == True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:58:00.963

哇已经找到答案了。如果人们正在搜索这个，将保持打开状态：

```
query = query.with_entities(SomeModel.id, SomeModel.name) 
```

# php - XML解析中的保留字？

> ID：11513640
> 
> 赞同：0
> 
> 时间：2012-07-16T22:41:02.967
> 
> 标签：php, xml, parsing, xml-parsing

我有以下内容：

```
<?php

#Load in File
$xmlUrl ="http://sports.espn.go.com/espn/rss/mlb/news";
$ConvertToXml = simplexml_load_file($xmlUrl);

# -> Setup XML
$newsStory = $ConvertToXml->channel;

# -----> Load News Stories
for($i = 0;$i<sizeof($newsStory); $i++){

    // Source of Article Info-->
    $SrcTitle=$newsStory[$i]->title;
    $SrcLink=$newsStory[$i]->link;

    // Actual News Article Info -->
    $title=$newsStory[$i]->item->title;
    $desc=$newsStory[$i]->item->description;

    echo '<hr>';
    echo '<strong>'.'Title:'.$title.'</strong>'.'(via: <a href=\''.$SrcLink.'\'>'.$SrcTitle.'</a>'.'<br />';
    //echo 'Link:'.$link.'<br />';
    echo 'Description'.$desc.'<br>';
    echo '<hr>';
} 
```

当它应该输出大约 10 个结果时，它只输出 1 个结果......

这一行：`$SrcLink=$newsStory[$i]->link;`“链接”字在这里似乎可能是一个“保留”字，因为它在我的编辑器上是紫色的，如下图所示：

![图像](../Images/0ac02254b311598f1f068ec248900d32.png)

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:45:51.890

不知道为什么您的 IDE 会突出显示紫色，但问题是：

```
$newsStory = $ConvertToXml->channel; 
```

需要改为：

```
$newsStory = $ConvertToXml->channel->item; 
```

RSS 提要中的每个条目都位于 <item> 标记中，因此您需要循环访问这些条目以获取实际提要条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:44:22.647

颜色编码经常遇到这个问题。由于该词被用作属性名称（如 所示`->`），因此它实际上可以是任何东西 - 在这种情况下没有保留字。

我建议`var_dump(count($newsStory))`这样您就可以确切地看到有多少元素要循环。如果是`1`，那么你的变量可能有问题`$newsStory`- 你也可以`var_dump`。

# android - 应用内结算，无法让 RESULT_DEVELOPER_ERROR 消失

> ID：11513643
> 
> 赞同：3
> 
> 时间：2012-07-16T22:41:15.417
> 
> 标签：android, in-app-billing, android-billing

我正在尝试在 android 上进行应用内计费，但​​在尝试初始化事务时不断获得以下 logcat 输出：

```
// from logcat, BillingService:
Billing service connected
CheckBillingSupported
CheckBillingSupported response code: RESULT_OK
RestoreTransactions 
   restoreTransactions received RESULT_OK
     request id: 12345
     request id: -1
handleCommand() action: [com.android.vending.billing.RESPONSE_CODE].
RestoreTransactions: RESULT_DEVELOPER_ERROR 
```

我的设置：

1.  我在清单中有计费权限。
2.  计费服务和接收方在清单中定义。
3.  我的应用程序**没有发布**，我只是有一个草稿。
4.  我创建了一个应用内项目，并发布了它。
5.  我添加了一个测试帐户，但不确定它在这一点上是否有所作为。
6.  市场上的草稿 apk 和我手机上的 apk 都使用相同的密钥在发布模式下签名，并且具有相同的 versionCode。

我已经在另一个应用程序中进行了应用内购买，但在这种情况下，我已经发布了该应用程序的一个版本。在这种情况下（如 #3 中所述），我从未发布过一次 apk。我们是否必须发布应用程序一次才能使其正常工作？我假设不是，

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T16:44:17.913

看起来您已经遵循了文档中的所有要求，所以我认为解决方案就是等到 Google Play 服务器赶上。

在将应用程序的新版本 apk 上传到 Google Play 后不久尝试恢复交易时，我遇到了同样的问题。似乎需要一些时间（可能是几个小时）才能在 Google 服务器上完全处理新的 apk，以便它正确响应**所有**类型的计费请求。例如，我在响应 CHECK_BILLING_SUPPORTED 时得到了 RESULT_OK，而不必等待太久，但是在 RESTORE_TRANSACTIONS 中遇到了问题（RESULT_DEVELOPER_ERROR 作为异步响应）。但是当我在几个小时后再次尝试使用相同版本的 apk 时，我也得到了 RESULT_OK 以响应 RESTORE_TRANSACTIONS，而没有对代码进行任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T20:00:29.100

您可能会收到此错误的另一个原因是，如果您尝试一次获取超过 20 个 SKU。此限制记录在 AIDL 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T22:50:52.090

您不需要在 Google Play 上发布应用程序，草稿就足够了。

您提到的 6 点没问题，但我想您需要检查文档中提到的额外要求：

```
RESULT_DEVELOPER_ERROR: 
```

> 表示应用程序正在尝试发出应用内计费请求，但应用程序尚未在其清单中声明 com.android.vending.BILLING 权限。还可以指示应用程序未正确签名，或者您发送了格式错误的请求，例如缺少 Bundle 密钥的请求或使用无法识别的请求类型的请求。

# php - PHP - 获取当前脚本的名称和目录，不包括域？

> ID：11513646
> 
> 赞同：0
> 
> 时间：2012-07-16T22:41:40.523
> 
> 标签：php, path, dns

我正在制作产品目录。目录结构从域根开始有 3 层深。

比如说，我有一个橙子的产品页面。橙子属于一个称为柑橘的子类别，属于一个称为水果的类别，该类别位于一个名为 products 的目录中。所以这个页面的真正路径是`http://www.mydomain.com/products/fruit/citrus/orange.php`

现在，我将如何仅获得以下信息：`/fruit/citrus/orange`运行时`orange.php`

我试过了：`dirname(__FILE__);`但这给出了一个输出，`http://www.mydomain.com/products/fruit/citrus/orange`其中包括我不想要的域。

任何人都可以就我如何完成这样的事情提供任何建议或建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:45:37.833

```
$levels = 3;
$temp = array();

$parts = explode('/', $_SERVER['REQUEST_URI']);
for ($i = 0; $i < $levels; $i++) {
  $temp[] = pathinfo(array_pop($parts), PATHINFO_FILENAME);
}
$temp[] = '';

$result = implode('/', array_reverse($temp)); 
```

# java - Java 中的泛型方法和类型推断

> ID：11513650
> 
> 赞同：8
> 
> 时间：2012-07-16T22:41:49.517
> 
> 标签：java, generics, type-inference

鉴于以下不太有用的代码：

```
package com.something;

import java.util.ArrayList;
import java.util.Collection;

//Not a generic class!
public class Test {

  public <T> void plain(T param1, T param2) {}
  public <T> void fancy(T param1, Collection<T> param2) {}

  public void testMethod() {

    //No error
    fancy("", new ArrayList<String>());

    //Compiler error here!
    fancy("", new ArrayList<Integer>());

    //No error
    plain("", new ArrayList<Integer>());

  }

} 
```

（如有错误，请纠正我的理解！）

第二次调用`fancy()`是编译器错误，因为 Java 无法推断两个参数之间的任何公共类型（无法推断`Object`，因为第二个参数必须是`Collection`.）

调用`plain()`不是编译器错误，因为 Java 推断出两个参数之间的公共*类型*`Object`。

我最近遇到了具有类似于`plain()`.

我的问题是这样的：

**`plain()`的签名对任何事情都有用吗？**

也许编写该代码的人认为`plain()`' 的签名会强制两个参数在编译时具有相同的类型，但显然情况并非如此。

编写带有类似签名的方法`plain()`而不是仅仅将两个参数都定义为`Object`s 有什么区别或好处吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:46:39.007

虽然编译器不会推断出人们可能想要的泛型类型，但它*会*强制执行明确指定的类型约束。以下调用导致类型错误。

```
this.<String>plain("", new ArrayList<Integer>()); /* Compiler error. */ 
```

> Test 类型的参数化方法 <String>plain(String, String) 不适用于参数 (String, ArrayList<Integer>)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T22:55:55.227

我想您可以说它充当某种文档，以便用户知道您希望两个参数属于同一类型。当然，*任何*两个对象在某种程度上都属于同一类型（它们都是`Object`），所以这是一个没有意义的陈述。

长话短说，这是一个无用的签名。

当然，如果`plain`返回一个 type `T`，那就另当别论了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:17:58.483

> 第 2 次调用 fancy() 是编译器错误，因为 Java 无法推断两个参数之间的任何公共类型（无法推断 Object，因为第二个参数必须是 Collection。）

好吧，我不确定这是否是原因，我会说原因是泛型类型`T`in`Collection<T>`是一个不变量，其值决定了第一个参数的类型`T`。

例如，这是有效的：

```
fancy("", new ArrayList<CharSequence>()); //compiles Ok 
```

因为`String`都是`CharSequences`。`CharSequence`一旦从 推断出类型，预计第一个参数是 a `ArraysList<CharSequence>`。

但是，这是无效的：

```
fancy((CharSequence)"", new ArrayList<String>()); //compiler error 
```

因为预计第一个参数的类型是 be `String`，我们不能确保实际上所有`CharSequences`的都是 type `String`，对吧？

因此，AFAIK，类型不兼容的原因是在这种情况下是由于泛型的性质，而不是因为第二种类型是`Collection`.

# c# - 函数或方法或函数成员或方法成员？

> ID：11513654
> 
> 赞同：1
> 
> 时间：2012-07-16T22:42:11.560
> 
> 标签：c#

一些 C# 作者在他们的书中将 C# 方法称为函数。他们可能来自 C 或类似的编程背景。C#中有什么叫做函数成员的东西吗？我的理解在 C# 中没有称为“函数”的概念。我在这里想念什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:48:46.833

**一些背景..**

在 C# 和其他语言中，方法通常被称为函数。函数通常被称为方法。在我第一年的编程学习期间，我被教导一切都是函数，而在我第二年的编程中，我被告知所有作为函数的东西现在都是一种方法（所以它是双向的）。

**什么是方法或函数？**

*   一组执行特定任务的语句
*   多次执行的代码是函数的良好候选者
*   只需要在必要时更改公共代码
*   功能分解

[![功能性的](../Images/4bb044caff3e5ad32fcc950debb476ff.png)](https://i.stack.imgur.com/WhS9P.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/q3ctjp2h.lad.png)）]

学分（[UCOL](https://ucol.ac.nz/)，北帕默斯顿，Edmund Teo，2008 年）

**好的....但是什么是函数（或方法）成员？**

> 函数成员是包含可执行语句的成员。函数成员始终是类型的成员，不能是命名空间的成员。C# 定义了以下类别的函数成员：
> 
> *   方法
> *   特性
> *   活动
> *   索引器
> *   用户定义的运算符
> *   实例构造函数
> *   静态构造函数
> *   析构函数

取自 MSDN *7.4 Function members*，在此处阅读更多内容[。](https://www.microsoft.com/en-us/download/details.aspx?id=55979)

**通用方法/函数的架构。**

[![方法](../Images/c4d6aefb4dd224399aa3c20e707e4cd0.png)](https://i.stack.imgur.com/la2bk.png)
[（来源：[iforce.co.nz](http://iforce.co.nz/i/hc4hcnw4.rq1.png)）]

信用（[UCOL](https://ucol.ac.nz/)，北帕默斯顿，亚伦斯蒂尔，2009）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:49:41.763

我经常看到诸如函数和方法之类的术语可以互换使用。我确信有一个正式的定义，但实际上，它似乎是一种宗教的东西。我在教育过程中一直学习术语“方法”，这是我个人的喜好。据我所知，越来越多的人开始使用“方法”这个词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:03:00.803

方法只是非数据类中例程/操作/事物的语言无关名称。

函数和过程等，作为语言结构，引入了许多模糊基本原理的包袱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-13T01:01:28.707

**功能：**
接受输入并产生输出（数据、行为）的事物的通用术语。数学中还有一个术语函数。

**方法：**
是面向对象编程主题中常用的函数。它是执行某事的“对象”的一部分。也许有一段历史为什么使用“方法”这个词。当你有一个“对象”时，你会调用它的属性来做什么？一项技能？人才？行动？技术？行为？方法？最合适的术语是什么？

**成员函数：**
是 c/c++ docs/reference/topics/etc 中常用的术语。对我来说，与“方法”这个词相比，这是一个更准确、更容易理解的术语。但我们在这里讨论的是编码而不是纯粹的面向对象编程。

***总之：***
**方法**==**成员函数**，它们都是**函数**。

对于**方法成员**......你从哪里得到这个词？！;))
我猜它似乎与方法和成员函数相同。

# sql - Rails 3查询has_one关联的匹配属性，它是has_many关联的子集

> ID：11513656
> 
> 赞同：1
> 
> 时间：2012-07-16T22:42:13.583
> 
> 标签：sql, ruby-on-rails-3

标题令人困惑，但请允许我解释一下。我有一个具有不同时间戳的多个数据点的汽车模型。我们几乎总是关心其最新状态的属性。所以模型 has_many 状态，以及一个 has_one 可以轻松访问它的最新状态：

```
class Car < ActiveRecord::Base
  has_many :statuses, class_name: 'CarStatus', order: "timestamp DESC"
  has_one :latest_status, class_name: 'CarStatus', order: "timestamp DESC"

  delegate :location, :timestamp, to: 'latest_status', prefix: 'latest', allow_nil: true

  # ...
end 
```

为了让您了解状态的含义：

```
loc = Car.first.latest_location   # Location object (id = 1 for example)
loc.name                          # "Miami, FL" 
```

假设我想要一个（可链接的）范围来查找最新位置 id 为 1 的所有汽车。目前我有一种复杂的方法：

```
# car.rb
def self.by_location_id(id)
  ids = []
  find_each(include: :latest_status) do |car|
    ids << car.id if car.latest_status.try(:location_id) == id.to_i
  end
  where("id in (?)", ids)
end 
```

使用 SQL 可能有更快的方法来执行此操作，但不确定如何仅获取每辆车的最新状态。可能有许多 location_id 为 1 的状态记录，但如果这不是其汽车的最新位置，则不应包括在内。

为了使它更难......让我们添加另一个级别并能够按位置名称进行范围。我有这个方法，预加载状态及其位置对象以便能够访问名称：

```
def by_location_name(loc)
  ids = []
  find_each(include: {latest_status: :location}) do |car|
    ids << car.id if car.latest_location.try(:name) =~ /#{loc}/i
  end
  where("id in (?)", ids)
end 
```

这将使上面的位置与“miami”、“fl”、“MIA”等相匹配……有人对我如何使它更简洁/高效有任何建议吗？以不同的方式定义我的关联会更好吗？或者可能需要一些我承认没有的 SQL 忍者技能。

使用 Postgres 9.1（托管在 Heroku cedar 堆栈上）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T17:39:45.323

好的。由于您像我一样使用 postgres 9.1，因此我将对此进行尝试。首先解决第一个问题（按最后状态的位置过滤的范围）：

该解决方案利用 PostGres 对分析函数的支持，如下所述：http: [//explainextended.com/2009/11/26/postgresql-selecting-records-holding-group-wise-maximum/](http://explainextended.com/2009/11/26/postgresql-selecting-records-holding-group-wise-maximum/)

我认为以下内容为您提供了您需要的部分内容（自然替换/插入您对“？”感兴趣的位置 ID）：

```
select * 
from (
  select cars.id as car_id, statuses.id as status_id, statuses.location_id, statuses.created_at, row_number() over (partition by statuses.id order by statuses.created_at) as rn 
  from cars join statuses on cars.id = statuses.car_id
) q
where rn = 1 and location_id = ? 
```

此查询将返回`car_id`、`status_id`、`location_id`和一个时间戳（默认情况下称为 created_at，但如果其他名称更易于使用，您可以为其命名）。

现在说服 Rails 基于此返回结果。因为您可能希望对此使用预先加载，所以 find_by_sql 几乎没有了。不过，我发现了一个技巧，`.joins`用于加入子查询。这大概是它的样子：

```
def self.by_location(loc)
  joins(
    self.escape_sql('join (
    select * 
    from (
      select cars.id as car_id, statuses.id as status_id, statuses.location_id, statuses.created_at, row_number() over (partition by statuses.id order by statuses.created_at) as rn 
      from cars join statuses on cars.id = statuses.car_id
    ) q
    where rn = 1 and location_id = ?
    ) as subquery on subquery.car_id = cars.id order by subquery.created_at desc', loc)
  )
end 
```

Join 将充当过滤器，只为您提供子查询中涉及的 Car 对象。

注意：为了像上面那样引用 escape_sql，您需要稍微修改 ActiveRecord::Base。为此，我将其添加到应用程序中的初始化程序（我将其放在 app/config/initializers/active_record.rb 中）：

```
class ActiveRecord::Base
  def self.escape_sql(clause, *rest)
    self.send(:sanitize_sql_array, rest.empty? ? clause : ([clause] + rest))
  end
end 
```

这允许您调用`.escape_sql`任何基于 AR::B 的模型。我发现这非常有用，但是如果您有其他方法来清理 sql，请随意使用它。

对于问题的第二部分-除非有多个具有相同名称的位置，否则我只需`Location.find_by_name`将其转换为 id 以传递到上述位置。基本上是这样的：

```
def self.by_location_name(name)
 loc = Location.find_by_name(name)
 by_location(loc)
end 
```

# dotnetnuke - dotnetnuke：指向外部文件的链接不起作用

> ID：11513657
> 
> 赞同：0
> 
> 时间：2012-07-16T22:42:31.883
> 
> 标签：dotnetnuke

我们目前正在运行 DotNetNuke 4.0.6。在门户网站上，我们创建了一些链接来访问位于文件共享上的文件。当我们设置它们并保存页面时，当我们单击该链接时，什么也没有发生。

我目前已将链接设置为：链接类型 - URL 协议 - 其他 URL - file://///myfileshare/filesharename/folder1/folder2/myitem.pdf

如果我选择其他任何内容（http、https、ftp），它就不起作用。当我将鼠标悬停在链接上时，它看起来可以正确呈现。

谁能帮助解释为什么会发生这种情况？我是否缺少设置或选择了错误的项目？

编辑器中的文本是这样的：

服务站 请记住，时事通讯中提供的信息是保密的，不应在公司外部共享。
阅读更多...（其中“阅读更多”是链接）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:08:21.153

这里有一些您想记住的项目。

1.  用户需要有权访问该共享，因此这可能是您的问题
2.  看起来您的链接中有一些额外的//。应该是 file://，可能需要在编辑器中切换到 HTML 视图来修改。

# php - PHP 显示空白 inf IE 和 Firefox 但不是 Safari

> ID：11513658
> 
> 赞同：0
> 
> 时间：2012-07-16T22:42:39.760
> 
> 标签：php, internet-explorer, firefox

我是 php 新手，有一个简单的“告诉朋友”代码。假设会出现一个弹出窗口并显示消息已发送给朋友。这在 Safari 中效果很好，但在 IE 和 Firefox 中显示为空白。

下面是代码：

```
<?php
if(isset($_POST['email'])) {

$email_to = "speedyblindsdfw@gmail.com";
$email_subject = "Check this site out!"; 

function died($error) {
    //error code 
    echo "We are very sorry, but there were error(s) found with the form you submitted. ";
    echo "These errors appear below.<br /><br />";
    echo $error."<br /><br />";
    echo "Please go back and fix these errors.<br /><br />";
    die();
  }

  // validation expected data exists
  if(!isset($_POST['senders_email']) ||
    !isset($_POST['email'])) {
    died('We are sorry, but there appears to be a problem with the form you submitted.');       
  }

$email_from = $_POST['senders_email']; // required
$email = $_POST['email']; // not required

$error_message = "";
$email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
if(!preg_match($email_exp,$email_from)) {
$error_message .= 'The Email Address you entered does not appear to be valid.<br />';
}

if(strlen($error_message) > 0) {
died($error_message);
}

 function clean_string($string) {
  $bad = array("content-type","bcc:","to:","cc:","href");
  return str_replace($bad,"",$string);
}
$email_message .= "I was on this site today & thought you would be interested.";
$email_message .= "\nwww.primaresidential.com\n\n";
$email_message .= "Dear " .clean_string($email). ",";       
$email_message .= "\nYour friend, " .clean_string($email_from). " had linked";
$email_message .= "our site to your email, we hope you enjoy our site as much as they did!"; 
$email_message .= "\n\nPrima Residential Services."; 

//email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();    
 @mail($email_to, $email_subject, $email_message, $headers);
 @mail($email, $email_subject, $email_message, $headers);  
 ?>

  <!----HTML CODE------>

  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>PrimaResidential Serivces- Emailer</title> 
       <style type="text/css" media="all">@import "css/style.css";</style>  
       <style type="text/css" media="all">@import "css/style.css";</style>

      </head>
    <br/><br/><br/><br/><br/>
        <div class="boxbg all-round" id="page-container-Popup">
        <br/><br/><br/><br/><br/><center>
        <h2>Your email was successfully sent.</h2><br>
        <br><h3>Thank you for spreading the word.<br>
           <font size="1"> Be sure to check your email in the next 2-3 business days for a little surprise.</font></h3>
        <br/></center>

        </div>
        <a href="javascript:window.close()">Close Window</a>      

     </body>
     </html>

     <?php
      }
     ?> 
```

如果您看到我做错了什么或需要添加什么，请告诉我。谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:46:55.390

您没有包含`<body>`标签，因此浏览器被迫猜测。您还两次导入相同的样式表。过多的`<br>`标签可能会将实际内容推离屏幕底部，或者如果元素有`overflow:hidden`. 总体而言，我建议您解决大量问题，看看是否有帮助。

# mysql - 选择具有不同值的行

> ID：11513663
> 
> 赞同：0
> 
> 时间：2012-07-16T22:43:32.973
> 
> 标签：mysql, sql

我想从表的末尾选择具有 10 个不同 soru_id 的行。它必须只返回红色标记的行。表结构和红色标记的行如下图所示。我该怎么做？
[http://i47.tinypic.com/2132iir.jpg](http://i47.tinypic.com/2132iir.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:46:20.197

假设 soru_id 决定表的开始/结束

尝试这个：

```
SELECT DISTINCT soru_id
  FROM <YOUR_TABLE>
 ORDER BY date_created DESC 
 LIMIT 10; 
```

如果您需要整行而不是单独的 soru_id。然后试试这个：

```
SELECT *
FROM <YOUR_TABLE> a
JOIN
  ( SELECT soru_id,
           MAX(date_created) date_created
   FROM <YOUR_TABLE>
   GROUP BY soru_id LIMIT 10) b ON a.soru_id = b.soru_id
AND a.creation_date = b.creation_date 
```

# javascript - Radio onClick - 将 img src 替换为直到第二次点击才会触发的标题

> ID：11513666
> 
> 赞同：0
> 
> 时间：2012-07-16T22:44:06.007
> 
> 标签：javascript, onclick, image, radio

这是一个脚本，它将 img src 替换为单击的任何收音机的标题标签。

```
var imgFldr = '/uploads/2012/07/';
$("input[type='radio']").click(function() {
$('#'+this.name).attr('src', imgFldr+this.title);
});

<input type="radio" name="lift" id="standard_left" value="Standard left" title="Cellular-Lift-Type-Standard-Left.jpg" onclick="doCalc();">Standard left<br>
<input type="radio" name="lift" id="standard_right" value="Standard right" title="Cellular-Lift-Type-Standard-Right.jpg" onclick="doCalc();">Standard right<br>
etc. etc. 
```

一旦您单击一个收音机，然后单击另一个，一切都会完美运行。该页面从未选择任何收音机开始，然后您选择一个并且它不会更改图像。第二次点击它确实改变了它。

有什么我需要改变的，让脚本知道一开始就没有选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:06:13.673

我找到了解决方案。我需要 .ready 处理程序。

```
$(document).ready(function() {
    var imgFldr = 'http://18004blinds.com/shopping/wp-content/uploads/2012/07/';
        $("input[type='radio']").click(function() {
        $('#'+this.name).attr('src', imgFldr+this.title);
    });
}); 
```

# ios - 为什么我的附件按钮会向左移动以获得更高的表格单元格？

> ID：11513670
> 
> 赞同：1
> 
> 时间：2012-07-16T22:44:25.633
> 
> 标签：ios, uitableview

我的 iOS 应用程序中有一个包含三个表格单元格的表格，每个单元格都有一个自定义附件按钮。其中一个细胞需要比其他细胞高；它是 60 像素而不是 45 像素。在这种情况下，附件按钮会滑到左侧，而如果它们的高度相同，则附件按钮会对齐。

附件按钮由相同的代码创建，因此它们应该相同。该问题似乎与 UITableViewCell 本身有关。

它最终看起来像这样。我未能在屏幕抓取中包含上边框，但上单元格是较高的单元格。有谁知道我该如何解决这个问题？

![未对齐的附件视图：](../Images/efae19a4cbaa357723fc80965047105f.png)

这是如何创建单元格的示例。它们仅在名称上有所不同；高度由 tableView 指定： heightForRowAtIndexPath:

```
 cell = [[UITableViewCell alloc] init];
    label = [[UILabel alloc] initWithFrame:[cell frame]];
    [label setText:@"Favorites"];
    [cell.contentView addSubview:label];
    [cell setAccessoryType:UITableViewCellAccessoryDetailDisclosureButton];
    button = [UIButton buttonWithType:UIButtonTypeCustom];
    image = [UIImage imageNamed:@"GT.png"];
    [button setBackgroundImage:image forState:UIControlStateNormal];
    button.frame = CGRectMake(0.0, 0.0, image.size.width, image.size.height);
    [cell setAccessoryView:button]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:11:48.130

您正在设置附件视图和附件类型。**做一个或另一个。**我会摆脱`setAccessoryView:button`.

```
[cell setAccessoryType:UITableViewCellAccessoryDetailDisclosureButton];
[cell setAccessoryView:button]; 
```

另外，你为什么这样做：

```
cell = [[UITableViewCell alloc] init]; 
```

你应该在`cellForRowAtIndexPath`你应该有这样的东西创建你的单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = nil;
    if (cell == nil){
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = @"Some Text";
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    return cell;
} 
```

# r - R中带有空白条目的行

> ID：11513676
> 
> 赞同：2
> 
> 时间：2012-07-16T22:45:15.930
> 
> 标签：r, dataframe

我有一个 721 x 26 的数据框。有些行的条目是空白的。它不是 NULL 或 NA，而是像下面这样为空。如何删除具有此类条目的那些行？

```
1         Y    N        Y          N            86.8
2         N    N        Y          N            50.0
3                                               76.8
4         N    N        Y          N            46.6
5         Y    Y        Y          Y            30.0 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:06:39.617

这个问题的答案取决于您对可能出现在“空白”字符串中的事物的偏执程度。这是一种相当谨慎的方法，它将匹配零长度的空白字符串`""`以及由一个或多个`[[:space:]]`字符组成的任何字符串（即“制表符、换行符、垂直制表符、换页符、回车符、空格和可能的其他与语言环境相关的字符” ，根据`?regex`帮助页面）。

```
## An example data.frame containing all sorts of 'blank' strings
df <- data.frame(A = c("a", "", "\n", " ", " \t\t", "b"),
                 B = c("b", "b", "\t", " ", "\t\t\t", "d"),
                 C = 1:6)

## Test each element to see if is either zero-length or contains just
## space characters
pat <- "^[[:space:]]*$"
subdf <- df[-which(names(df) %in% "C")] # removes columns not involved in the test
matches <- data.frame(lapply(subdf, function(x) grepl(pat, x))) 

## Subset df to remove rows fully composed of elements matching `pat` 
df[!apply(matches, 1, all),]
#   A B C
# 1 a b 1
# 2   b 2
# 6 b d 6

## OR, to remove rows with *any* blank entries
df[!apply(matches, 1, any),]
#   A B C
# 1 a b 1
# 6 b d 6 
```

# java - 导入 org.apache.commons.httpclient.*

> ID：11513677
> 
> 赞同：1
> 
> 时间：2012-07-16T22:45:36.780
> 
> 标签：java

我使用导入以下包的代码：

```
import org.apache.commons.httpclient.*; 
```

我使用日食。我去了[http://hc.apache.org/downloads.cgi](http://hc.apache.org/downloads.cgi)并下载了 Jar 文件，并将它们添加到我的项目中。仍然 eclipse 为此出错。

> 线程“main”java.lang.Error 中的异常：未解决的编译问题：HttpClient 无法解析为类型

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T22:50:07.307

如果您使用的是这些模块的最新 (4.x) 版本，它们已经被重构了很多。例如，包名称 now `org.apache.http.client`。[必须修改](https://stackoverflow.com/questions/6615394/migrating-from-httpclient-3-x-to-4-x?lq=1)旧的示例代码。查看新项目的[Javadocs](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/index.html)和[快速入门](http://hc.apache.org/httpcomponents-client-ga/quickstart.html)。

（不鼓励的）替代方法是获取旧的（3.x）版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T22:53:43.150

我建议使用[Maven](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)来管理您的 3rd 方依赖项。它负责处理 jar 文件和所有相关的依赖项。

httpclient 的 Maven 依赖项是：

```
 <dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.2.1</version>
    <scope>compile</scope>
  </dependency> 
```

# c# - 如何通过 C#.NET 代码创建 Windows 文件和文件夹快捷方式？

> ID：11513681
> 
> 赞同：2
> 
> 时间：2012-07-16T22:45:53.690
> 
> 标签：c#, .net, windows, svn, shortcut

我正在使用 .NET 为我们的数据仓库构建一个存储库文件夹和文件结构，在版本控制中具有许多依赖项。目前我有代码用 C# 代码创建虚拟文件和文件夹（见下文）。但是，有对象被共享。所以我想创建 Windows 文件的快捷方式以及 Windows 文件夹和文件的快捷方式。在 C# 中实现此目的的代码是什么样的？

***通过 C#.NET 代码创建文件夹：***

```
string activeDir = @"C:\Source\EDW\dw-objects\trunk\table-objects";
string objectName = reader[0].ToString();
string newPath = System.IO.Path.Combine(activeDir, objectName);
System.IO.Directory.CreateDirectory(newPath); 
```

***代码因文件格式而异***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:58:48.477

请使用 ShellClass 创建快捷方式，您还需要使用 Environment.SpecialFolder.DesktopDirectory 从桌面获取特殊目录

> 可以在这里找到一个非常好的示例逐步显示[http://www.codeproject.com/Articles/146757/Add-Remove-Startup-Folder-Shortcut-to-Your-App](http://www.codeproject.com/Articles/146757/Add-Remove-Startup-Folder-Shortcut-to-Your-App)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T22:55:24.073

看看[这篇文章](http://www.codeproject.com/Articles/15633/Manipulating-NTFS-Junction-Points-in-NET)，它向您展示了如何使用 c# 操作 NTFS 连接点。因为您将要访问您需要有接合点而不是 shrotcuts 的文件夹，因为一个之后是机器处理而一个不是。

# .net - Web 服务和调度引擎

> ID：11513691
> 
> 赞同：0
> 
> 时间：2012-07-16T22:46:48.183
> 
> 标签：.net, web-applications, service, polling

我已经对这个主题进行了很多搜索，但我似乎永远无法找到一个共同的答案。大多数开发人员使用什么来为电子邮件、采购订单等创建调度系统？例如，如果我在网站上下单，交易完成后，什么样的服务会将订单发送给第三方公司？这必须是某种在服务器上运行并重试直到成功的进程。如果是 Windows 服务器，这些网站是否使用带有轮询的 Windows 服务？这些天看起来有点原始，考虑到几乎所有的网站都需要这种类型的东西来下订单。另外，Linux上使用什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:53:07.243

您可能希望查看基于队列的系统，例如与远程处理系统（例如 SOAP 客户端）绑定的 ActiveMQ。

您可以使用 SOAP 客户端发送请求，如果您收到响应，则您确认 ActiveMQ 并将其从队列中弹出，如果您不这样做，则该项目将保留在队列中以供下一个引擎/处理器尝试使用. 由于这种方法，您可以拥有多个代理来侦听下一条消息并独立工作，因此可以轻松扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:02:17.230

正如 John Mitchell 所建议的那样，还有许多旧技术仍在使用，例如 SOAP。

如今，正如您所说，最流行的消息传递服务是使用 api 的标准 http（当需要更安全的连接时使用 https）。

通常这些 api 使用 json 数据格式，尽管有些也支持其他格式，如 xml。

# javascript - jQueryUI - 将可拖动的内容移回原始位置，即使在放入 droppable 之后也是如此

> ID：11513694
> 
> 赞同：2
> 
> 时间：2012-07-16T22:47:10.750
> 
> 标签：javascript, jquery, jquery-ui

我有一个可拖动的元素，我将其拖入各种可放置区域之一。但是，我希望可拖动项目*始终*返回到其原始位置，即使它被拖动到可放置区域（当可拖动区域被拖放到它们上时，可放置区域处理它们自己的事件）。有没有办法做到这一点？

我注意到从 draggable 中的 stop() 函数返回 true 或 false 会影响它返回到原始位置以及它是否触发 droppable 的 drop() 函数。有没有办法单独处理这些？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T23:05:05.063

这有点像黑客，但是当你有

```
$('yourelement').draggable({revert:true}); 
```

无论它是否下降，都会恢复它。它仍然会在可放置元素上触发放置事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:02:39.600

你想让你的droppables接受其他元素吗？如果没有，您可以将 droppable 的 'accept' 选项设置为 'false'

```
$('.foo').droppable('option','accept',false); 
```

# c++ - 在一帧上计算SIFT或ORB后，如何实时跟踪视频中的对象？

> ID：11513695
> 
> 赞同：9
> 
> 时间：2012-07-16T22:47:31.203
> 
> 标签：c++, opencv, tracking, object-detection

基本上，我想检测一个对象，然后在视频中（逐帧）跟踪它。

我可以在第一帧上检测到它，例如 ORB 或 SIFT。但是对于接下来的帧（或者说接下来的 XX 帧），我想避免再次计算所有关键点（ORB 或 SIFT）以再次检测它。

考虑到我想在视频中实时跟踪它，我该怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T11:23:50.177

一个常见的选项是使用**patchtracker**。这意味着您只需在前一帧关键点周围 8 个像素的区域中搜索关键点。您可以执行`cv::matchTemplate()`关键点周围的区域，而不是使用 SIFT。

执行**金字塔搜索**有助于提高帧速率。您首先以较低的比例搜索，如果找不到关键点，则将比例加倍。

如果 patchtracker 由于图像移动太快而失败，您只需再次应用 SIFT 重新初始化系统。我会使用 FAST 而不是 SIFT。您可以使用 SIFT 作为标记，然后使用 FAST 实时检测关键点，生成 SIFT 描述符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T23:07:02.073

检测和跟踪视频中的对象是一个非常大的话题，具体方法取决于您的应用程序。没有灵丹妙药！如果您实现了检测部分，如果您需要跟踪的对象是彩色的，您可以尝试通过颜色（可能是 HSV 颜色空间）可能性的均值偏移进行跟踪，或者尝试模板匹配，或者..您需要更具体地了解您的需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-03T18:19:04.083

您可以使用 OpticalFlow 进行**简单跟踪**，以下是执行此操作的步骤...

1.  使用哈里斯角检测器或 SIFT 特征检测器查找移动物体的角。

2.  将这些角和上一个图像（您在其中找到要跟踪的对象的角）和下一个图像提供给光流函数，它将计算下一个图像中同一对象的角..

以下是链接：

[链接1](https://stackoverflow.com/questions/10329340/opencv-how-to-track-objects-after-optical-flow)

[链接2](http://opencv.willowgarage.com/documentation/c/video_motion_analysis_and_object_tracking.html)

[代码](http://robots.stanford.edu/cs223b05/notes/CS%20223-B%20T1%20stavens_opencv_optical_flow.pdf)

注意：如果您要解决遮挡处理、多人跟踪等问题，那么光流本身无法解决问题。为此，需要使用卡尔曼滤波器或粒子滤波器......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-01T18:42:42.503

您可以使用 TLD 或 CLM 实现几乎完美的实时跟踪。一旦您检测到感兴趣的对象，使用该边界框来启动捕食者跟踪。你可以在这里找到关于 CMT [https://www.gnebehay.com/cmt/](https://www.gnebehay.com/cmt/)

和这里的顶级域名 [https://www.gnebehay.com/tld/](https://www.gnebehay.com/tld/)

# avfoundation - 多个 AVCaptureVideoPreviewLayers

> ID：11513704
> 
> 赞同：4
> 
> 时间：2012-07-16T22:47:59.047
> 
> 标签：avfoundation, avcapturesession

如何一次在屏幕上显示多个相机预览？如果我启动一个新的 AVCaptureSession，另一个会停止。如果我用与另一个会话相同的会话初始化一个新的 AVCaptureVideoPreviewLayer，另一个 AVCaptureVideoPreviewLayer 将停止显示相机源。我怎样才能克服这个问题，并在屏幕上的两个不同位置显示相机馈送？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-02-06T10:45:44.853

```
// in this method get CameraView Buffer Image and set Preview view

 - (void)captureOutput:(AVCaptureOutput *)captureOutput
   didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
   fromConnection:(AVCaptureConnection *)connection
{
@autoreleasepool
{
    NSLog(@"Capturecall");
    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    /*Lock the image buffer*/
    CVPixelBufferLockBaseAddress(imageBuffer,0);
    /*Get information about the image*/
    uint8_t *baseAddress = (uint8_t *)CVPixelBufferGetBaseAddress(imageBuffer);
    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);
    size_t width = CVPixelBufferGetWidth(imageBuffer);
    size_t height = CVPixelBufferGetHeight(imageBuffer);

    /*Create a CGImageRef from the CVImageBufferRef*/
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef newContext = CGBitmapContextCreate(baseAddress, width, height, 8, bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst);
    CGImageRef newImage = CGBitmapContextCreateImage(newContext);
    /*We release some components*/
    CGContextRelease(newContext);
    CGColorSpaceRelease(colorSpace);
    UIImage *image= [UIImage imageWithCGImage:newImage scale:1.0 orientation:UIImageOrientationRight];
    CGImageRelease(newImage);
    dispatch_async(dispatch_get_main_queue(),
                   ^{

                     UIImage * blurredImage=[imagefilters GaussianBlurWithImage:image AndRadius:_brightnessValue];
                       [self.backgroundpreview setImage:blurredImage];

                    });

    CVPixelBufferUnlockBaseAddress(imageBuffer,0);
}} 
```

# python - python 属性装饰器

> ID：11513705
> 
> 赞同：18
> 
> 时间：2012-07-16T22:48:13.050
> 
> 标签：python, decorator

> **可能重复：**
> [关于如何在 python 中使用属性功能的真实示例？](https://stackoverflow.com/questions/6304040/real-world-example-about-how-to-use-property-feature-in-python)

`@property`我对以下代码中看到的装饰器有疑问。有人可以完全解释为什么有人会使用`@property`装饰器吗？我知道`@property`这相当于`isActive = property(isActive)`但是方法属性实际上对它的参数做了什么？如果我要从类中调用该`isActive`方法，`InputCell`实际会发生什么？提前致谢。

```
class InputCell(object):
    def __init__(self, ix, iy, inputData):
        self.ix = ix
        self.iy = iy
        self.InputData = inputData

    @property
    def isActive(self):
        return self.InputData[self.ix][self.iy] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-16T23:16:22.287

它只是语法糖。它允许方法调用看起来像变量访问或赋值。

这可能有用的一种方法是，如果您想将以前*是*简单变量的东西更改为实际使用其他代码计算或验证的东西。如果将其设为属性，则可以在不破坏任何现有代码的情况下执行此操作。另一种方式是对象属性的缓存、延迟初始化等。

# iphone - 使用 XCode 4 从 DetailView 访问 UITableView 单元格并在它们之间滑动

> ID：11513706
> 
> 赞同：0
> 
> 时间：2012-07-16T22:48:19.477
> 
> 标签：iphone, xcode, uitableview, uiswipegesturerecognizer

我正在制作我的第一个应用程序，并且正在使用带有 Storyboard 的 XCode 4。多亏了这个地方、大量的教程、Apple 的档案数据库和一些我，我正在慢慢地掌握基础知识。这是一个从 plist 填充的应用程序。plist 是一个带有字典的数组，字典中包含有关挪威不同红酒的信息。首先，plist 填充了一个 TableView。我正在使用 NSSortDescritor 对 TableView 进行排序，并在导航栏中添加了一个按钮，以便在我希望它由另一个值显示时使用。它看起来像这样：

RootTableViewController.h：

```
#import <UIKit/UIKit.h>

@interface RootTableViewController : UITableViewController <UIActionSheetDelegate> {
NSMutableArray *sortedObjects;
}

-(IBAction)sortButtonPressed:(id)sender;

@end 
```

RootTableViewController.m：

```
#import "RootTableViewController.h"
#import "ObjectCell.h"
#import "DetailViewController.h"

@interface RootTableViewController ()

@end

@implementation RootTableViewController

- (IBAction)sortButtonPressed:(id)sender;

{
    UIActionSheet *sort = [[UIActionSheet alloc]
   //InitWithStyle etc for sheet
}

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex 
{
 NSSortDescriptor *sortDesc;

if (buttonIndex == 0) {
        sortDesc = [[NSSortDescriptor alloc] initWithKey:@"Name" ascending:YES];
        [sortedWines sortUsingDescriptors:[NSArray arrayWithObject:sortDesc]];
        }
if (buttonIndex == 1) {
        sortDesc = [[NSSortDescriptor alloc] initWithKey:@"Country" ascending:YES];
        [sortedWines sortUsingDescriptors:[NSArray arrayWithObject:sortDesc]];
}
[self.tableView reloadData];
}

- (void)viewDidLoad
{
[super viewDidLoad];

NSString *myfile = [[NSBundle mainBundle]
                    pathForResource:@"Objects" ofType:@"plist"];

sortedObjects = [[NSMutableArray alloc]initWithContentsOfFile:myfile];

NSSortDescriptor * sortDesc = [[NSSortDescriptor alloc] initWithKey:@"Popularity" ascending:YES];
[sortedObjects sortUsingDescriptors:[NSArray arrayWithObject:sortDesc]];
[super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (void)viewWillAppear:(BOOL)animated {
    [self.tableView deselectRowAtIndexPath:[self.tableView indexPathForSelectedRow] animated:YES];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [sortedObjects count];
}

//(I’m using a Custom Cell for the TableView)

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"objectCell";

    ObjectCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {

    cell = [[[ObjectCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }

    cell.nameLabel.text = [[sortedObjects objectAtIndex:indexPath.row] valueForKey:@"Name"];
    cell.countryLabel.text = [[sortedObjects objectAtIndex:indexPath.row] valueForKey:@"Country"];
    return cell;
}

#pragma mark - Table view delegate
//Then the selected object is sent to the DetailViewController in this segue:

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([[segue identifier] isEqualToString:@"DetailSegue"]) {

        NSIndexPath *selectedRowIndex = [self.tableView indexPathForSelectedRow];
        DetailViewController *detailViewController = [segue destinationViewController];

        detailViewController.selectedObject = [sortedObjects objectAtIndex:selectedRowIndex.row];
    }
}

@end 
```

然后 DetailViewController 接收所选对象以使用其中的数据填充 Labels 和 ImageViews。

DetailViewController.h：

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController 

@property (nonatomic, strong) IBOutlet UILabel *districtLabel;
@property (nonatomic, strong) IBOutlet UILabel *countryLabel;
@property (nonatomic, strong) IBOutlet UIImageView *bottleImageView;

@property (nonatomic, strong) NSString *selectedObject;

@end 
```

DetailViewController.m：

```
#import "WinesDetailViewController.h"

@interface WinesDetailViewController ()

@end

@implementation WinesDetailViewController

@synthesize districtLabel,countryLabel,bottleImageView;

@synthesize selectedObject;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
    // Custom initialization
    }
    return self;
}

- (void)viewDidAppear:(BOOL)animated
{
    self.title = [selectedObject valueForKey:@"Name"];
    [super viewDidAppear:animated];
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    districtLabel.text = [selectedObject valueForKey:@"District"];
    countryLabel.text = [selectedObject valueForKey:@"Country"];
    bottleImageView.image = [UIImage imageNamed:[selectedObject valueForKey:@"Image"]];

self.navigationController.navigationBar.translucent = YES;
self.wantsFullScreenLayout = YES;

//Then I’ve added recognizers for left and right swiping:

UISwipeGestureRecognizer *leftGesture = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeDetectedLeft:)];
leftGesture.direction = UISwipeGestureRecognizerDirectionLeft;
[self.view addGestureRecognizer:leftGesture];

UISwipeGestureRecognizer *rightGesture = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeDetectedRight:)];
rightGesture.direction = UISwipeGestureRecognizerDirectionRight;
[self.view addGestureRecognizer:rightGesture];

}

//And the voids to handle the swipes:

- (void)swipeDetectedRight:(UISwipeGestureRecognizer *)sender
{
//Access previous cell in TableView
}

- (void)swipeDetectedLeft:(UISwipeGestureRecognizer *)sender
{
//Access next cell in TableView
}

//Some more besic code for the view..

@end 
```

如您所见，我在 DetailViewController 中添加了 UISwipeGestureRecognizers，因为我想在向右滑动时使用上一个单元格的数据重新加载它，并在向左滑动时重新加载下一个单元格。现在我不知道如何处理检测到的滑动空白，如何从 DetailView 到达 selectedRowIndex 并滑动单元格？我是编程新手，很长时间以来一直在尝试解决这个问题，所以代码示例会很棒，所以如果你知道我的意思，答案不会导致 100 个新问题。如果你能帮助我，非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:57:39.403

解决此问题的一种方法是通过“prepareForSegue”方法将“排序”数据源数组传递给 DetailViewController 和索引路径。

RootTableViewController.h：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([[segue identifier] isEqualToString:@"DetailSegue"]) {

        NSIndexPath *selectedRowIndex = [self.tableView indexPathForSelectedRow];
        DetailViewController *detailViewController = [segue destinationViewController];

        detailViewController.selectedObject = [sortedObjects objectAtIndex:selectedRowIndex.row];

        //added code
        detailViewController.detailsDataSource = [[NSArray alloc]initWithArray:sortedObjects];
        detailViewController.detailIndex = selectedRowIndex.row;
    }
} 
```

然后您可以重新加载 DetailViewController 的 UI 元素。这是新属性的声明。

DetailViewController.h：

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController 

@property (nonatomic, strong) IBOutlet UILabel *districtLabel;
@property (nonatomic, strong) IBOutlet UILabel *countryLabel;
@property (nonatomic, strong) IBOutlet UIImageView *bottleImageView;

@property (nonatomic, strong) NSString *selectedObject;

// added code
@property (strong, nonatomic) NSArray *detailsDataSource;
@property int detailIndex;
@end 
```

***不要忘记合成新属性*** @synthesize detailsDataSource,detailIndex;

```
//And the voids to handle the swipes:

- (void)swipeDetectedRight:(UISwipeGestureRecognizer *)sender
{
//Access previous cell in TableView
    if (detailIndex != 0) // This way it will not go negative
          detailIndex--;  

    districtLabel.text = [[detailsDataSource objectAtIndex: detailIndex] valueForKey:@"District"]];
    countryLabel.text =  [[detailsDataSource objectAtIndex: detailIndex]  valueForKey:@"Country"];
    bottleImageView.image = [UIImage imageNamed:[[detailsDataSource objectAtIndex: detailIndex] valueForKey:@"Image"]];
}

- (void)swipeDetectedLeft:(UISwipeGestureRecognizer *)sender
{
//Access next cell in TableView
    if (detailIndex != [detailsDataSource count]) // make sure that it does not go over the number of objects in the array.
    detailIndex++;  // you'll need to check bounds 

    districtLabel.text = [[detailsDataSource objectAtIndex: detailIndex] valueForKey:@"District"]];
    countryLabel.text =  [[detailsDataSource objectAtIndex: detailIndex]  valueForKey:@"Country"];
    bottleImageView.image = [UIImage imageNamed:[[detailsDataSource objectAtIndex: detailIndex] valueForKey:@"Image"]];
}

//Some more besic code for the view..

@end 
```

试试这个，它可能对你有用。否则，我想您可能想看看 Scrollview 和“分页”。iPhone/iPad 用户已经习惯了这种 UI 设计，您也许可以对其进行修改以适应您正在做的事情。

# c++ - Boost (1.50.0) 线程库与 MinGW 的链接

> ID：11513710
> 
> 赞同：2
> 
> 时间：2012-07-16T22:49:20.673
> 
> 标签：c++, boost, linker, mingw

我正在尝试链接 boost 1.50.0 的线程库并且遇到了一些问题。问题是找不到线程的实现。

我在这里、随机站点和官方手册上进行了检查，并得出结论认为只有一个原因（因为我链接的实际库包含正确的文件）。**MinGW 中没有自动链接**。这意味着没有可用线程的平台实现（因此错误）。

我得到的错误之一是：

*对` *imp* __ZN5boost6thread4joinEv'的未定义引用*

来自**myTread.join()**。

所以我的问题是，除了 boost 线程库（在本例中名为*libboost_thread-mgw46-mt-1_50.a* ）之外，我还需要链接什么库（或多个库）？

此外，是否有任何关于 boost 中所有库依赖项的文档？

我当然可能完全错了，所以任何帮助表示赞赏！

目前我只链接提升库；线程、计时和系统。

**编辑**

为了澄清，我正在链接以下命令：

*g++ -LPATH_TO_BOOST\lib -o test-boost-thread.exe src\test-boost-thread.o -lboost_thread-mgw46-mt-1_50 -lboost_chrono-mgw46-mt-1_50 -lboost_system-mgw46-mt-1_50*

我试过改变图书馆的位置，但这没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:55:11.370

在您的情况下，给定您发布的文件名，链接器行将是`-lboost_thread-mgw46-mt-1_50`(remove `lib`and `.a`// `.so`) `.lib`。可能有（或者您可能想要创建）一个指向它的符号链接，如`libboost_thread.a -> libboost_thread-mgw46-mt-1_50.a`，在这种情况下，您可以使用更短的`-lboost_thread`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:08:22.030

嗯，好像我完全忘记了 BOOST_THREAD_USE_LIB 标志。设置它使它工作。

虽然奇怪的错误。

# ruby-on-rails - 带有垂直文本的 Rails Prawn PDF 标题

> ID：11513712
> 
> 赞同：2
> 
> 时间：2012-07-16T22:49:36.497
> 
> 标签：ruby-on-rails, prawn

我有一个在rails中生成的有效的虾文件。我使用 text_box() 构建表格以将文本包装在标题中，以便将 text_box 和文本旋转 90 度。它工作得很好，直到标题在下一页上重现......在这种情况下，表格标题是完整的，但由于每个 text_box 的定位方式，文本（在 text_box() 内）不会被复制。我想知道是否有人对旋转文本有更好的想法，以便它只是在表头中。除了这种方法，我无法得到任何东西来生产我想要的东西。

你可以在这里查看我的功能 PDF...
[http://flightrecord.herokuapp.com/vfrlarge.pdf?rating=6](http://flightrecord.herokuapp.com/vfrlarge.pdf?rating=6)

表数据非常广泛，所以我只包括我如何生成表头：

```
def flights_table

table **flight_data_rows**, :width => 1200 do

self.header = true

def **flight_data_rows**
   y_pos = 518
  height = 500
       x = 155
    size = 7 
[[

text_box("Lesson", :at => [5, y_pos], :rotate => 90, :size => size), 
text_box("Date", :at => [24, y_pos+6], :size => size),                                 
text_box("CFI", :at => [66, y_pos+6], :size => size),                                  
text_box("N# / Type", :at => [109, y_pos+6], :size => size),                            
text_box("Total Time", :at => [x, y_pos],   :rotate => 90, :size => size, :width => 300),

]] +

@data.map do |data|
[
data.the_data,
data.the_data,
data.the_data,
data.the_data,
data.the_data
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T01:53:09.130

从 1.0.0rc1 开始，这似乎不是对虾的可行选择。我尝试了很多方法，但都没有奏效。我终于完全删除了标题行……希望以后能完成这个项目。我会给 wicked_pdf 一个机会。

# facebook - 在 iframe 中询问 facebook 权限对话框

> ID：11513715
> 
> 赞同：2
> 
> 时间：2012-07-16T22:49:39.617
> 
> 标签：facebook, iframe, permissions

我试图将 facebook 权限对话框放在 iframe 中，但由于缺乏 Facebook 文档而没有取得太大进展，并且围绕网络的无证黑客不再起作用。

news.yahoo.com 做了一些我想效仿的事情。

当您单击新闻文章时，它会显示使用 facebook 登录。在初始 oauth 对话框对用户进行身份验证（不请求权限）之后，雅虎弹出来自雅虎 URL 的另一个对话框，其中包含作为 IFrame 的权限对话框。

有人知道可以使用哪些 API 来完成此操作吗？

提琴手跟踪表明雅虎 URL 正在调用：

带有 permissions.request 方法的 uiserver.php 端点。

[https://www.facebook.com/connect/uiserver.php?method=permissions.request&app_id=194699337231859&display=iframe&redirect_uri=https%3A%2F%2Fopen.login.yahoo.com%2Fopenid%2Fyrp%2Fsc_check&cancel_url=https%3A% 2F%2Fopen.login.yahoo.com%2Fopenid%2Fyrp%2Fsc_check&perms=user_birthday%2Cuser_likes%2Cemail%2Cpublish_actions&response_type=code&locale=en_US](https://www.facebook.com/connect/uiserver.php?method=permissions.request&app_id=194699337231859&display=iframe&redirect_uri=https%3A%2F%2Fopen.login.yahoo.com%2Fopenid%2Fyrp%2Fsc_check&cancel_url=https%3A%2F%2Fopen.login.yahoo.com%2Fopenid%2Fyrp%2Fsc_check&perms=user_birthday%2Cuser_likes%2Cemail%2Cpublish_actions&response_type=code&locale=en_US)

当我尝试使用 FB 的 javascript SDK 执行此操作时：FB.ui({ method: 'permissions_request', perms: 'read_stream,publish_stream,user_photos', display: 'iframe' },
function(response){ alert("badfood") ; 警报（响应）; });

它转到另一个端点：facebook.com/dialog/permissions_request？...

我从 facebook 收到 500 个服务器错误，但没有有用的调试信息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:13:53.260

一些事情。

1）首先添加参数`show_error=true`。这将告诉您更多关于真正导致错误的原因。

2) Facebook 有多种方式可以显示任何对话框。在提琴手请求中，注意`display=iframe`参数。这主要用于画布应用程序，但也可用于常规 iFrame 显示。它在灯箱中打开身份验证对话框。

3）尝试同步加载SDK。删除 Facebook 告诉您在页面顶部的正文标记后包含的异步引用，并使用辅助方法。包括`all.js`and `fb-root`div 标签并在您调用`FB.init`之前加载。`FB.ui`

4）检查[回声工具](http://developers.facebook.com/tools/echo)。

> 这个工具可以打印出你的 GET 参数或你的 . 它还可以解码已启用 OAuth 2.0 Beta 迁移的 Canvas 应用程序中使用的 signed_request 参数。这在调试 Canvas 身份验证时非常有用。

[http://developers.facebook.com/docs/reference/dialogs/](http://developers.facebook.com/docs/reference/dialogs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T03:44:52.183

由于存在点击劫持的风险，不允许也不可能在 iframe 中加载 auth/permissions 对话框。您看到正在执行此操作的站点与 Facebook 签订了允许他们执行此操作的特殊协议。

# iphone - 在自定义 UITableViewCell 中管理 UITextFields 的委托

> ID：11513719
> 
> 赞同：11
> 
> 时间：2012-07-16T22:49:58.973
> 
> 标签：iphone, objective-c, ios, ipad, uitableview

所以我环顾四周，这里似乎没有任何东西可以准确地解释这样做的正确方法。我在自定义 UITableViewCell 中有 7 个 UITextField。

我的问题是：管理这些 UITextFields 的代表的正确方法是什么？

由于自定义单元格在技术上是项目“模型”部分的一部分，我宁愿让控制 UITableView 的控制器也控制表格单元格中的文本字段，但我不知道如何为文本字段（在 UITableViewCell 的子类中创建）到此视图控制器。

只使 UITableViewCell 的子类符合 UITextField 委托并管理其中的所有内容是不好的做法吗？如果是这样，我还应该怎么做呢？

谢谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T08:52:46.890

将单元格文本字段的委托设置为您的视图控制器应该没有问题。

这是你需要做的：

1）视图控制器需要实现`UITextFieldDelegate`协议

2) 为自定义单元格中的文本字段声明一个属性

```
@property (nonatomic, retain) IBOutlet UITextField *textField; 
```

3）然后在方法中将视图控制器设置为文本字段的委托 `cellForRowAtIndexPath`

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *cellIdentifier = @"Cell";

    MyCustomCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if (cell == nil) 
    {  
        // use this if you created your cell with IB
        cell = [[[NSBundle mainBundle] loadNibNamed:@"MyCustomCell" owner:self options:nil] objectAtIndex:0];   

        // otherwise use this  
        cell = [[[MyCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease]; 

        // now set the view controller as the text field delegate  
        cell.textField.delegate = self;
    }

    // configure cell...

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-17T01:08:28.373

在我看来，单元格应该管理键盘，因为它是持有 UITextField 的那个。您可以将您的单元格设置为 UITextField 委托。在我自己的应用程序中，我已经这样做了，然后让我的单元格有它自己的代表。UITextField 的任何方法或应该由控制器处理的任何新方法都可以通过单元格委托传递给控制器​​。

通过这种方式，单元仍然可以是通用的，而无需了解应用程序实际在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:49:54.730

我的建议是用一个值对每个 textField 进行“标记”（即设置标记），该值对表中的部分、行和 7 个文本视图之一进行编码，然后将 UIViewController 设为委托。

所以你需要限制这些的大小——比如你永远不会有超过 100 行。因此，您将其编码为：

.tag = 1000*section + 100*row +

当您收到一条消息时，您可以让一个方法/函数获取标签并将其解码为部分、行、标签，然后执行您需要完成的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:52:59.057

要将您的 TableViewController 声明为委托`<UITextFieldDelegate>`，请`@interface`在 TableViewController 的 .h 文件的末尾包含。

```
@interface MyTableViewController : UITableViewController <UITextFieldDelegate> 
```

然后，通过 ctrl 拖动`@interface`. 每个 UITextField 都通过 IBOutlet 连接到其各自的属性。最后，在 .m 文件中包含以下函数以向委托人显示您要返回的字段...。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [aTextField resignFirstResponder];
    return YES;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T14:19:23.317

Swift 版本（基于 Eyal 的回答）

```
class MyViewController: UIViewController, ... , UITextFieldDelegate {

    @IBOutlet var activeTextField: UITextField!  //doesn't need to connect to the outlet of textfield in storyboard

    ....

    func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {

    ....

    var cellTextField = self.view.viewWithTag(101) as? UITextField
    cellTextField!.delegate = self;
    ....
} 
```

# android - 带有 stlport_shared 的 NDK 用于独立二进制文件？

> ID：11513723
> 
> 赞同：0
> 
> 时间：2012-07-16T22:50:10.630
> 
> 标签：android, c++, android-ndk

我想从 C++ 源代码编译一个独立的二进制文件，它使用一些基本的 STL 东西，如字符串、向量等。

如果我用'stlport_static'编译它一切正常。

但是，使用 'stlport_shared' 我在设备上执行二进制文件时收到此错误消息：link_image[1965]: 14649 could not load required library 'libstlport_shared.so' for '/data/prog' (load_library[1120]: Library 'libstlport_shared .so' 未找到）无法链接可执行文件

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T16:48:16.770

on java code put static block with the loadlibrary of the libstlport_shared.so on application.mk put app_stl - stlport_shared on android.mk check if there is local_static_library with libstlport and ld_libs with static stl and remove in both case.

It should work now

# ios - iOS 什么时候应该 @property 在 .h 中，什么时候在 .m 中

> ID：11513724
> 
> 赞同：3
> 
> 时间：2012-07-16T22:50:23.463
> 
> 标签：ios, xcode

我知道其他类可以调用的方法应该在头文件中。但是当@property 应该在头文件中以及何时应该在实现文件中时，我有点困惑。

你是如何做出这个决定的，它有什么不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:05:23.673

您希望公开向其他类公开的任何属性都放在 .h 文件中。“私有”属性（双关语）以匿名类别或类扩展名进入实现文件。例如，您还可以将属性的 .h 版本设为只读，将 .m 版本设为可读写。

## 具有在私有类别中定义的属性的实现文件

```
@interface CPClassFileName ()
@property (nonatomic, retain) NSString *string;
@end

@implementation
...
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:05:28.993

如果您希望其他类（或开发人员）知道您的 ivars 有访问器，请将 @property 放在标题上。

换个说法：如果你想要“公共”getter / setter，你把@property放在标题上。如果您希望它们是私有的，您可以将 @property 放在 .m 文件中。

# javascript - 根据来自服务器的初始标记填充 knockoutJS 视图模型对象

> ID：11513725
> 
> 赞同：3
> 
> 时间：2012-07-16T22:50:26.753
> 
> 标签：javascript, asp.net-mvc, razor, knockout.js

我的网络服务器返回一个带有一些结构化标记的页面。我需要使用 knockoutJS 将标记表示形式作为 JSON 对象 - 淘汰视图模型对象。

该页面基本上（在初始加载后）`<div data-bind="foreach: ExistingNamings">`具有几个封闭的 div，这些 div 实际上包含应该进入视图模型对象的 ExistingNamings 数组的内容。

是否可以根据调用时提供的标记剔除“解析”和现有标记并填充视图模型`ko.applyBindings`？

KNJS 的教程显示了相反的情况——我们在 JS 中有一个数据生成代码，它在调用 applyBindings 时被推送到一个 html 中。

PS 我的服务器端是 ASP.NET MVC，我看到有人建议[http://knockoutmvc.com/](http://knockoutmvc.com/) - 一种为 js 文件生成初始化代码的方法。这样，它“好像”视图模型是通过 javascript 初始化的。这是处理初始数据的唯一方法，还是我确实可以解析标记？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:54:43.873

您可以使用 razor 直接将 C# 模型序列化为 JSON，如下所示：

```
var serverModel = @Html.Raw(Json.Encode(Model)); 
```

或者，显然：

```
var serverProperty = @Html.Raw(Json.Encode(Model.Property)); 
```

唯一失败的情况是当您有循环引用时，如果您将实体模型直接放入其中，就会发生这种情况。如果您这样做，请为它们创建一个 ViewModel，以消除循环导航属性。

**更新：**

要将其添加到您的 viewModel 中，请将其添加到 Razor 视图的底部：

```
<script type="text/javascript">
    var serverModel = @Html.Raw(Json.Encode(Model));    
    //Define KO viewModel, either here, or by including via script tag in header    
    ko.applyBinding(new ViewModel(serverModel));
</script> 
```

# c# - 注册表设置访问控制

> ID：11513730
> 
> 赞同：0
> 
> 时间：2012-07-16T22:51:16.727
> 
> 标签：c#, .net, security, registry

```
string user = @"NT AUTHORITY\NETWORK SERVICE";
RegistryKey key = Registry.LocalMachine.OpenSubKey(@"SYSTEM\CurrentControlSet\services\eventlog");
RegistrySecurity regSec = new RegistrySecurity();
RegistryAccessRule rule = new RegistryAccessRule(
                user,
                RegistryRights.FullControl,
                InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit,
                PropagationFlags.InheritOnly,
                AccessControlType.Allow);
regSec.AddAccessRule(rule);

key.SetAccessControl(regSec); 
```

我收到 System.Unauthorizedaccessexception：“无法写入注册表项。” 在 `key.SetAccessControl(regSec);`

我以管理员身份运行该应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:36:04.643

我认为网络服务帐户默认情况下没有对注册表的写入权限。

请参阅[http://msdn.microsoft.com/en-us/library/ff647402.aspx#paght000015_registryaccess](http://msdn.microsoft.com/en-us/library/ff647402.aspx#paght000015_registryaccess)

该异常可能与应用程序是否以管理员身份运行无关。

# python - 列出数字之间的差异

> ID：11513731
> 
> 赞同：-1
> 
> 时间：2012-07-16T22:51:21.847
> 
> 标签：python, numpy, python-2.7

我有几秒钟的时间输入从最小到最大的有序数据。

```
 start_time[s] = [10, 20, 30, 40, 50, 61, 79, 80]

 end_time[s] = [8, 9, 15, 31, 41, 60] 
```

列表的大小与生成的日志文件时间戳数据不同

我想得到 end_time 和 start_time 最小值之间的正差的输出

我的代码如下：

```
 for item1 in end_time:   
    for item2 in start_time:  
      if (item1 > item2):
         new_item = item1 - item2
         new_list.append(new_item) 
```

> > > [5、21、11、1、31、21、11、1、50、40、30、20、10]

理想的输出将如下生成：

> > > [5、11、11、20]

5 ...这是通过取 15 的 end_time - 10 的 start_time，为什么？它的第一个 end_time > start_time (8,9 也是 end_times 小于 10)

11 ...这是通过取下一个 end_time 31（我不想使用 15，因为我会重复计算），然后减去下一个 start_time 20 得到 11。

11...这是通过取以下 41 的 end_time 并减去 30 的 start_time 得到 11。

20...这将是最后一个条目，它取 end_time 的 60 并使用 start_time 的 40 给出 20 的差值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:27:28.547

我假设两个列表都是按顺序排列的，这就是您的示例数据所显示的。

```
timeDeltas = []
idxStart = 0
idxEnd =  len(end_time)
for start in start_time:
    for i in range(idxStart, idxEnd)
        delta = 0
        end = end_time[i]
        if end > start:
            delta = end - start
            idxStart = i
        else:
            timeDeltas.append(delta)
            break 
```

请注意，我没有进行完整性检查（例如，可以一遍又一遍地使用相同的结束时间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:25:23.867

我就是这样做的

```
start_time = [10, 20, 30, 40, 50, 61, 79, 80]
end_time = [8, 9, 15, 31, 41, 60]
time_difference = [(min(start_time) - et) for et in end_time if min(start_time) > et]
[2,1] 
```

你的问题可能有点模棱两可。我假设您严格想要正时差。

你想要的输出是什么？

# .net - Json.NET 4.5 中不支持 DefaultValueHandling

> ID：11513732
> 
> 赞同：6
> 
> 时间：2012-07-16T22:51:33.557
> 
> 标签：.net, json.net

我正在使用 JSON.NET 4.5 并关注这篇[博](http://james.newtonking.com/archive/2009/10/23/efficient-json-with-json-net-reducing-serialized-json-size.aspx)文，试图让我的用户对象正确序列化。

我已经把头撞在墙上好几个小时了；无论我做什么，当 Json.NET 设置为“该值类型的默认统一值”时，我都无法让 Json.NET 忽略整数，也就是 0。

```
[DataContract]    
public class User
{
    [DataMember]
    public int Id { get; set; }

    [DataMember]
    public string Name{ get; set; }

    [DataMember]
    public string Email{ get; set; }        
} 
```

这是对其进行序列化的调用：

```
var user = new User()
{
    Id = 0,
    Name = "John Doe",
    Email = null
}

string body = JsonConvert.SerializeObject(user, Formatting.Indented, new JsonSerializerSettings()
{
    DefaultValueHandling = DefaultValueHandling.Ignore
}); 
```

生成的 JSON 是：

```
{
    "Id": 0,
    "Name": "John Doe"
} 
```

电子邮件被省略，因为它为空。Id 应该被省略，因为它是 0。我还尝试在 Id 上显式设置 [DefaultValue(0)] 属性，但没有效果。

我做错了什么，还是这是一个错误？

## 更新

再看一遍之后，DefaultValueAtribute**被**授予整数。因此，此代码将导致 0 的 ID 未被序列化。

```
[DataContract]    
public class User
{
    [DataMember]
    [DefaultValue(0)]
    public int Id { get; set; }

    [DataMember]
    public string Name{ get; set; }

    [DataMember]
    public string Email{ get; set; }        
} 
```

不是所说的行为，但至少它可以让我继续我的生活。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T09:24:50.720

这似乎是一个错误。根据[文档中的示例，](http://james.newtonking.com/projects/json/help/index.html?topic=html/T_Newtonsoft_Json_DefaultValueHandling.htm)不应需要 DefaultValueAttribute。这很有用，例如当您无法编辑要序列化的类型时。

我[在 Github](https://github.com/JamesNK/Newtonsoft.Json/issues/38)上为它提出了一个问题，以及一个补丁/黑客（针对 4.5r8）。

# c# - SQL条件语句？

> ID：11513735
> 
> 赞同：2
> 
> 时间：2012-07-16T22:52:30.577
> 
> 标签：c#, sql, compact-framework, sql-server-ce

我正在尝试为 SQLCE 和紧凑框架中的表编写查询，但查询需要读取具有两个条件的每一行。

任何给定行中的列“位置”可能为空，也可能不为空，如果不为空，则需要检查其值，如果为空，则应选择该行，即：

```
if( location!= null )
{
    if( d == "location" )
         SELECT;
}
else
    SELECT; 
```

有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:53:27.770

用于`OR`测试任一条件是否为真。

```
SELECT col1, col2, ..., coln
FROM yourtable
WHERE location IS NULL OR location = 'location' 
```

# php - 日期计算之间的差异不起作用

> ID：11513739
> 
> 赞同：0
> 
> 时间：2012-07-16T22:52:49.390
> 
> 标签：php, date

我有以下代码根据天数的差异计算“borg”的数量。我回显了我的`$days`变量以检查差异有多少天。据此，我在某一天的差异是 38 天。为什么当我回显时`$borg`，它仍然显示 0 的数量？在这个例子中，`$days = 38`。

```
$vandaag = date($format, strtotime('today'));
$verschil = $interval->d;
$diff = strtotime($retourdatum) - strtotime($vandaag);

$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
echo $days;
if($days > 0)
{
    $borg = 80;
}
if($days<0 && $days>-7)
{
    $borg = 65;
}
if($days>-7 && $days<-14)
{
    $borg = 50;
}
if($days>-14 && $days<-21)
{
    $borg = 35;
}
if($days>-21 && $days<-28)
{
    $borg = 20;
}
if($days>-28 && $days<-35)
{
    $borg = 5;
}
else
{
    $borg = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:56:33.073

因为您的 last`else`将始终设置`$borg`为 0 ，除非其对应`if`的已评估。

`$borg = 0;`解决方案是在所有语句之前定义`if`，并删除该`else`语句。

```
 $borg = 0;
 if( ... )
 {
 }
 ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:57:28.877

我并没有真正理解你在计算什么，但我清楚地明白为什么你在博格中总是有 0。

以下代码应该可以解决您的问题：

```
$vandaag = date($format, strtotime('today'));
$verschil = $interval->d;
$diff = strtotime($retourdatum) - strtotime($vandaag);
$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
echo $days;
if($days > 0)
{
    $borg = 80;
}
elseif($days<0 && $days>-7)
{
    $borg = 65;
}
elseif($days>-7 && $days<-14)
{
    $borg = 50;
}
elseif($days>-14 && $days<-21)
{
    $borg = 35;
}
elseif($days>-21 && $days<-28)
{
    $borg = 20;
}
elseif($days>-28 && $days<-35)
{
    $borg = 5;
}
else
{
    $borg = 0;
} 
```

这样 $borg = 0 代码只会在所有语句都为假的情况下执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:58:21.003

你应该使用 elseif。您执行每个 if 计算，然后以 if/else 状态结束它。结果是 $borg 可以是 5 或 0。

```
if($days > 0)
    $borg = 80;
elseif($days<0 && $days>-7)
    $borg = 65;
elseif($days>-7 && $days<-14)
    $borg = 50;
elseif($days>-14 && $days<-21)
    $borg = 35;
elseif($days>-21 && $days<-28)
    $borg = 20;
elseif($days>-28 && $days<-35)
    $borg = 5;
else
    $borg = 0; 
```

在此处阅读文档：[elseif](http://php.net/manual/en/control-structures.elseif.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T22:58:27.300

您的最后两个条件块是导致此*特定*问题的原因：

```
if($days>-28 && $days<-35)
{
    $borg = 5;
}
else
{
    $borg = 0;
} 
```

第一个适用于`$days`同时大于负 28*且*小于负 35*的情况*。这是不可能的，因此`else`始终适用，并且`$borg`始终为零。您的所有其他`if`陈述都没有以任何方式与最后两个相关联，因此它们总是被评估。至少三个你的其他`if`人有同样的问题：他们设定了一个不可能满足的条件。

我*认为*这就是你想要做的：当它变得更消极时，它的价值会变得更`$borg`小。`$days`如果您使用`else if`条件，则不必每次都重复和反转先前的条件，并且更容易看到您在做什么（例如，当您不小心翻转了`<`和时很有帮助`>`）：

```
$borg = 0;

if($days > 0)
{
    $borg = 80;
}
else if ($days > -7)
{
    $borg = 65;
}
else if ($days > -14)
{
    $borg = 50;
}
else if ($days > -21)
{
    $borg = 35;
}
else if ($days > -28)
{
    $borg = 20;
}
else if ($days > -35)
{
    $borg = 5;
} 
```

# c# - 将 XAML 绑定到 WPF 中的代码隐藏

> ID：11513740
> 
> 赞同：0
> 
> 时间：2012-07-16T22:52:56.260
> 
> 标签：c#, wpf, xaml, data-binding, code-behind

我有这个文本块：

```
<TextBlock x:Name="Coordinates" Text="Some Coordinates"/> 
```

如何从代码隐藏中访问此对象？我试图用“文本”的内容替换Locaton（）中的硬编码坐标：

```
private void DestinationButton_Click(object sender, RoutedEventArgs e)
{
    Location loc= new Location (20.2127297,-87.4625591);
    myMap.Center = loc;
    myMap.ZoomLevel = 8;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:58:46.920

不用查，我猜我会说：

```
this.Coordinates.Text = loc.ToString(); 
```

当然，这将取决于 ToString() 返回的内容 - 您可能必须覆盖它才能获得所需的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:05:01.997

编辑：根据您的评论，我认为您想要这样的东西。

```
<TextBlock x:Name="Coordinates" Text="20.2127297,-87.4625591"/> 
```

```
private void DestinationButton_Click(object sender, RoutedEventArgs e) 
{ 
   string[] doubles = this.Coordinates.Text.Split(',');
   var xCoord = double.Parse(doubles[0], System.Globalization.CultureInfo.InvariantCulture);
   var yCoord = double.Parse(doubles[1], System.Globalization.CultureInfo.InvariantCulture);

   Location loc= new Location (xCoord,yCoord); 
   myMap.Center = loc; 
   myMap.ZoomLevel = 8; 
} 
```

首先将 TextBlock-1 拆分`string`为单独的子字符串。然后解析它们`double`。

# mongodb - 如何在 MongoDB 中查找和替换所有内容？

> ID：11513745
> 
> 赞同：4
> 
> 时间：2012-07-16T22:53:18.787
> 
> 标签：mongodb

例如假设我插入数据如下

```
doc1 = [{url: 'http://domain.com/pic1.jpg'}, {url: 'http://domain.com/pic2.jpg'}]
doc2 = [{url: 'http://domain.com/pic3.jpg'}, {url: 'http://domain.com/pic4.jpg'}]
db.picture.insert(doc1)
db.picture.insert(doc2) 
```

我怎么能用'https'替换所有'http'？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T05:47:32.267

MongoDB 没有内置支持搜索和替换字符串的一部分。你可以用你最喜欢的脚本语言编写一个程序来做到这一点。

您可以使用正则表达式搜索来获取所有以“http:”开头的 URL：

```
db.picture.find({url: /^http:/}) 
```

您可以在程序中执行此操作以获取数据，然后在程序中对其进行修改，并使用新值更新或替换文档。

# javascript - 纯 JavaScript 沙箱

> ID：11513747
> 
> 赞同：0
> 
> 时间：2012-07-16T22:53:24.910
> 
> 标签：javascript, sandbox, trusted-vs-untrusted

这是纯 JavaScript 沙箱的可能解决方案吗？我的意愿是执行不受信任的代码字符串，而不授予对 DOM、窗口、this 等的访问权限，但允许用户访问 Math、JSON 和其他功能。我已经在 Chrome 上测试过了。

更新：我想提供保存服务器用户定义代码并使其可供其他用户使用的可能性。我正在寻找一种方法来拒绝访问文档 ni 以使其安全。

```
function safe(code,args)
{
    if (!args)
        args=[];
    return (function(){
      for (i in window) 
        eval("var "+i+";");
      return function(){return eval(code);}.apply(0,args);
    })();
}

ff=function()
{
    return 3.14;
}

console.log(safe("this;"));//Number
console.log(safe("window;"));//undefined
console.log(safe("console;"));//undefined
console.log(safe("Math;"));//MathConstructor
console.log(safe("JSON;"));//JSON
console.log(safe("Element;"));//undefined
console.log(safe("document;"));//undefined
console.log(safe("Math.cos(arguments[0]);",[3.14]));//-0.9999987317275395
console.log(safe("arguments[0]();",[ff]));//3.14 
```

我在一个旧帖子上提出了它：[https ://stackoverflow.com/a/11513690/76081](https://stackoverflow.com/a/11513690/76081)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:21:19.673

这是不安全的。以下构造将从`window`您的沙箱中获取全局对象：

```
(function(){return this;})() 
```

此时，您可以从中提取任何您想要的内容，包括`document`.

向 TJ Crowder 致敬，感谢他在[https://stackoverflow.com/a/2673780/149341](https://stackoverflow.com/a/2673780/149341)上的回答，他在其中描述了这个漏洞。

# sql-server-2008 - Microsoft 分布式事务协调器 (MS DTC) 已取消分布式事务

> ID：11513750
> 
> 赞同：1
> 
> 时间：2012-07-16T22:53:43.950
> 
> 标签：sql-server-2008, sql-server-2005, .net-2.0, asp.net-2.0, linked-server

**背景：** 我们有一个在 .NET framework 2.0 下开发的网站，它使用使用 Sql Server 2005 创建的数据库。我们还有一个在 .NET framework 4.0 下开发的网站，这个网站使用使用 Sql Server 2008 创建的数据库. 我们链接两个数据库（从 Sql Server 2005 到 Sql Server 2008）创建一个“Sql Server 2005 数据库上的链接服务器”。

**场景：** 当我们在 Sql Server 2005 中托管的数据库上创建记录时，我们有以下事务序列： 将记录插入到 Sql Server 2005 数据库中托管的表中。此插入在插入后执行触发器。在触发器内部，我们执行一个存储过程（托管在 Sql Server 2008 数据库中），这个存储过程是使用“链接服务器”执行的。此存储过程执行插入到托管在 Sql Server 2008 数据库中的表中。如果我们使用 Sql Server Management Studio 2005 手动执行插入到托管在 Sql Server 2005 数据库中的表中，一切都会很好地执行，但是如果我们尝试使用网站的 UI (.NET 2005) 创建记录，我们会得到这个错误：

**当前事务无法提交，也无法支持写入日志文件的操作。回滚事务。Microsoft 分布式事务协调器 (MS DTC) 已取消分布式事务。**

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:48:18.183

我确实发现在触发器中执行此类代码非常冒险。我会考虑删除触发器并创建执行所述操作的过程。

为了正确测试所有内容，您应该在两台服务器上的一个事务中调用 DML 操作，或者您应该通过调用“[开始](http://msdn.microsoft.com/en-us/library/ms188386.aspx)分布式事务”显式地开始分布式事务。如果您只是在其他服务器上更新某些内容（仅 1 个操作），则您没有使用分布式事务并且测试不正确。

# azure - Azure 环境中 Hadoop 中的 Runtime.exec()

> ID：11513753
> 
> 赞同：0
> 
> 时间：2012-07-16T22:54:13.827
> 
> 标签：azure, hadoop

这个问题与 Azure 环境中的 Hadoop 有关。

我正在尝试使用 Runtime.exec() 在 reduce 函数中执行批处理脚本。我无法在 Azure 环境中的 Hadoop 中运行它，而它在 Linux 上的 Hadoop 中运行良好。我在我的桌面（Windows 7）环境中测试了 Runtime.exec() 代码片段，它在那里运行良好。我确保在 Runtime.exec() 之后使用子进程的输出和错误流。

批处理脚本包含以下内容（单个命令）：

c:\hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\attempt_201207121317_0024_r_000001_0\work\tool.exe -fc:\hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\work\11_task_201207121317_0024_r_000001.out -ic: \hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\attempt_201207121317_0024_r_000001_0\work\input.txt

我使用分布式缓存分发 tool.exe 和 input.txt 文件，并从工作目录创建符号链接。tool.exe 和 input.txt 指向 jobcache 目录中的实际文件。

2012-07-16 04:31:51,613 INFO org.apache.hadoop.mapred.TaskRunner：创建符号链接：/hdfs/mapred/local/taskTracker/distcache/-978619214658189372_-1497645545_209290723/10.73.50.78tool.exe <-\hdfs \mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\attempt_201207121317_0024_r_000001_0\work\tool.exe 2012-07-16 04:31:51,644 INFO org.apache.hadoop.mapred.TaskRunner：创建符号链接：/hdfs/mapred /taskTracker/distcache/-4944695173898834237_1545037473_2085004342/10.73.50.78input.txt <- \hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\attempt_201\work4_1213007_00input_00.txt

减速器在运行时会出现以下错误。

命令执行错误：无法运行程序“cmd /q /cc:\hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\work\11_task_201207121317_0024_r_0000011513543720767963399.bat”：CreateProcess error=2，系统找不到指定的文件

在另一种情况下，我尝试运行相同但不使用绝对路径。子进程的输出流如下所示：

c:\hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0022\attempt_201207121317_0022_r_000000_0\work>tool.exe -f /hdfs/mapred/local/taskTracker/nabeel/jobcache/job_201207121317_0022/work/1_task_201207121317_0022_r_000000.out -i input.文本

我不知道作业工作目录路径和分布式缓存在 Azure 环境中的 Hadoop 中是如何工作的。如果我在这里遗漏了什么（或）在 Azure 环境中的 Hadoop 中使用 Runtime.exec() 时需要注意什么，请告诉我。

谢谢，

**. *,* ._** 回复发件人 | 回复群 | 通过网络帖子回复 | 开始一个新话题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:04:08.240

我不熟悉Hadoop。但是错误信息似乎很明显。如果您可以检查文件是否存在会更好。

c:\hdfs\mapred\local\taskTracker\nabeel\jobcache\job_201207121317_0024\work\11_task_201207121317_0024_r_0000011513543720767963399.bat

此致，

徐明

# ios - 完全删除 XCode 目标

> ID：11513755
> 
> 赞同：5
> 
> 时间：2012-07-16T22:54:37.110
> 
> 标签：ios, xcode

如何完全删除 XCode 目标，这样如果我创建一个具有相同名称的新目标，以前与之关联的文件/设置都不会保留？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T00:48:06.980

我认为你必须做很多手工工作才能做到这一点：

*   使用 alt-click 打开 .xcodeproj - 显示包内容
*   使用文本编辑器打开 project.pbxproj 现在查找`/* Begin PBXNativeTarget section */`，您将在下面找到目标列表。下面是可能会让您创建新项目的部分 - 要分析的标识符有很多交叉引用。您必须自己找到要删除的内容。
*   删除 xcuserdata 以清除用户对项目的偏好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-09T18:34:27.837

在 xCode 版本 9.2 (9C40b) 以后，您应该能够只需右键单击要删除的目标。xCode 将在幕后完成所有繁重的文件成员资格等工作。

# javascript - Jquery 切换链接颜色

> ID：11513756
> 
> 赞同：2
> 
> 时间：2012-07-16T22:55:02.290
> 
> 标签：javascript, jquery

我正在使用 Cufon，我有我的导航，我的所有内容都在一个页面上，它通过锚标签滚动到页面的该部分，但是当您单击链接将亮起的链接时，我想要导航保持可见：

这是我到目前为止所拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>

<link rel="stylesheet" type="text/css" href="style.css"/>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script src="cufon-yui.js" type="text/javascript"></script>
<script src="Veneer_400.font.js" type="text/javascript"></script>

<script type="text/javascript">
    Cufon.replace('h1 a', { 
        hover: true
    });
</script>

<style type="text/css">
h1 a.selected {
    color: red;
}​
</style>
</head>

<body>
<div class="home-link"><h1><a class="selected" href="#home">Home</a></h1></div>
<div class="hiw-link"><h1><a class="" href="#howitworks">How It Works</a></h1></div>
<div class="faq-link"><h1><a class="" href="#faq">Faq</a></h1></div>
<div class="prize-link"><h1><a class="" href="#prizes">Prizes</a></h1></div>
<div class="media-link"><h1><a class="" href="#media">Media</a></h1></div>
<div class="rules-link"><h1><a class="" href="#rules">Rules</a></h1></div>
<script type="text/javascript">
$('#home-link','#hiw-link','#faq-link','#prize-link','#media-link','#rules-link').toggleClass(selected, addOrRemove);
</script>
</body>
</html> 
```

所以基本上如您所见，我只是想将 selected 类添加到锚标记并将其从其他所有内容中删除，因此只有该链接是红色的。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T22:57:51.877

## *[jsBin 演示](http://jsbin.com/ufacok/edit#javascript,html,live)*

```
$('div[class$=link] h1 a').click(function(e){
    e.preventDefault();
    $('div[class$=link] h1 a').removeClass('selected');
    $(this).addClass('selected');    
    Cufon.refresh(); // Will refresh all `Cufon` text
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:29:59.427

由于您使用的是，`Cufon text`所以您需要`Cufon.refresh();`在将任何类更改为 后调用`Cufon text`，否则它不会生效。

```
$('div[class$=link] h1 a').click(function(e){
    e.preventDefault();
    $('div[class$=link] h1 a').removeClass('selected');
    $(this).addClass('selected');    
    Cufon.refresh(); // Will refresh all `Cufon` text
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T22:59:37.050

您正在使用 ID 选择器，而应该使用类选择器（因为您将 home-link 等分配给类属性而不是 div 元素的 id 属性）

试试这个：

```
var selected = "selected"; //Assuming you are storing it in a variable
$(function(){
    var allLinks = $('.home-link,.hiw-link,.faq-link,.prize-link,.media-link,.rules-link');
    allLinks.click(function(e){
        allLinks.find("h1 > a").removeClass(selected);
        $(this).find("h1 > a").addClass(selected);
    });
}); 
```

JsFiddle：http: [//jsfiddle.net/JsNBt/1/](http://jsfiddle.net/JsNBt/1/)

# python - Python：在导入的字符串中查找反斜杠

> ID：11513759
> 
> 赞同：0
> 
> 时间：2012-07-16T22:55:16.783
> 
> 标签：python, string, backslash

我正在尝试剪断始终采用以下形式的导入字符串中的第一个短语：

`"\first phrase\\...\ ... "`

第一个短语可以是任意长度并且包含多个单词

我最初尝试的代码是：

```
phrase = s[1:s.find('\',1,len(s))] 
```

这显然没有用。

`r'\'`不会编译（返回 EOL 错误）。

以下变体： `r'\\\'; r'\\\\\\\', "\\\", "\\\\\\\""`
解析为：`phrase = s[1:-1]`.

由于第一个字符始终是反斜杠，我也尝试过：

```
phrase = s[1:find(s[0:1],1,len(s))], but it wasn't having any of it. 
```

任何建议表示赞赏，这应该是一个 10 分钟的工作！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T22:57:06.807

字符串文字中的反斜杠需要转义。

```
'\\' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T22:59:02.443

我只是使用 split 命令，它将轻松处理您的多字需求：

```
>>> s='\\first phrase\\second phrase\\third phrase\\'
>>> print s
\first phrase\second phrase\third phrase\

>>> s.split('\\')
['', 'first phrase', 'second phrase', 'third phrase', '']

>>> s.split('\\')[1]
'first phrase' 
```

诀窍是确保反斜杠被反斜杠转义。
这就是为什么事实证明`\\`您正在搜索或拆分的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:01:42.863

你不能有一个'\'作为字符串的最后一个字符，即使它是一个原始字符串 - 它需要被写入`'\\'`- 事实上，如果你看你的问题，你会看到突出显示有点不稳定 -尝试按照建议进行更改，它可能会自行纠正...

# vb.net - 如何使用 GridView 外的按钮调用 GridView RowEditing？

> ID：11513761
> 
> 赞同：0
> 
> 时间：2012-07-16T22:55:29.467
> 
> 标签：vb.net

我有一个填充的网格视图和一个网格视图外部的按钮，我想在单击时启用对所选行的编辑。我在后面的代码中有这个。btn_click 事件中调用网格视图编辑的内容是什么？

```
Protected Sub GridView1_RowEditing(ByVal sender As Object, ByVal e As GridViewEventArgs)
    GridView1.EditIndex = e.NewEditIndex
    FillGrid()
End Sub

Protected Sub btnEdit_Click(ByVal sender as Object, ByVal e As System.EventArgs) Handles btnEdit.Click

    What goes here??

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-01T15:11:58.253

这种方法存在问题。“ **GridView1_RowEditing** ” 需要一个行索引，因此它可以相应地打开“ **EditItemTemplate** ”，对吗？但是，如果您想单击 Gridview 之外的按钮并使整个 Gridview 可编辑，则不应触发**GridView1_RowEditing**，因为您不知道要传递什么 editindex。您需要实现可编辑控件（文本框）作为“ **ItemTemplate** ”的一部分，而不是在“ **EditItemTemplate** ”中。此控件的可见性将由您创建的外部按钮控制，该按钮将标记可见性打开/关闭。

请查看以下链接，这演示了它应该如何实施。 [http://highoncoding.com/Articles/219_GridView_All_Rows_in_Edit_Mode.aspx](http://highoncoding.com/Articles/219_GridView_All_Rows_in_Edit_Mode.aspx)

# iphone - 从 VMWare 在 iPhone/iPad 上启动 Xcode 4.0.2 应用程序

> ID：11513769
> 
> 赞同：1
> 
> 时间：2012-07-16T22:56:18.733
> 
> 标签：iphone, ios, xcode, ipad, vmware

我想在我的 iPhone 和 iPad 上测试一个应用程序。iPhone 运行 5.1，iPad 运行 5.1.1

我收到此错误：

> **Xcode 无法使用所选设备运行。**没有提供兼容 iOS 版本的预置 iOS 设备。将 iOS 设备与最新版本的 iOS 连接以运行您的应用程序或选择 iOS 模拟器作为目标。

我拥有开发者许可证，并已按照 Apple 网站成员部分中的配置向导进行操作。我已经安装了它所说的所有东西（证书、钥匙串中的配置文件等），但仍然出现此错误。

我已经尝试在 4.3、4.2、4.1 以及基本上所有构建部分中可用的选项上编译它。

在 Xcode Organizer 中，我的设备旁边会显示一个橙色图标。这是此屏幕上的“错误”消息：

> “个人 iPad”上的 iOS 版本与使用此 iOS SDK 安装支持开发的任何 iOS 版本不匹配。请将设备恢复到以下列出的操作系统版本，或更新到最新版本的 iOS SDK；可在此处获得。

这一切都在 OS X 10.6.7 上的 VMWare 上。

我已经阅读了人们遇到类似问题的其他帖子，并尝试了提出的解决方案（主要包括尝试在旧版本上运行），但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:54:00.250

请注意您是如何使用低于您设备上的版本的 SDK 版本进行编译的？那是个问题。对于 iOS 5，您至少需要 Xcode 4.2（随 5.1 SDK 一起提供）。

# actionscript-3 - 我可以在 ActionScript 中使用多个元数据标签吗？

> ID：11513770
> 
> 赞同：1
> 
> 时间：2012-07-16T22:56:23.013
> 
> 标签：actionscript-3, apache-flex, actionscript, metadata

有没有办法将多个元数据标记应用于 ActionScript 类的单个属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:01:49.153

您可以将多个元数据标记应用于类的属性，只需在属性声明之前一个接一个地列出它们。像这样：

```
[Bindable] 
[Transient]
public var attribute: Object; 
```

# php - PDO Execute() 函数未绑定参数

> ID：11513772
> 
> 赞同：0
> 
> 时间：2012-07-16T22:56:30.830
> 
> 标签：php, pdo

我有以下功能。我希望它打印其参数中提供的表中的行数。

```
private function getTotalCount($tbl){
    $sql = "SELECT count(*) FROM :tbl ;";
    $sth = $this->db->prepare($sql);
    $sth->execute(array(
        ':tbl' => $tbl
    ));
    $data = $sth->fetch(PDO::FETCH_ASSOC);
    print_r($data);
} 
```

但该功能不打印任何东西......

当我将函数替换为如下内容时：

```
private function getTotalCount($tbl){
    $sql = "SELECT count(*) FROM $tbl ;";
    $sth = $this->db->prepare($sql);
    $sth->execute();
    $data = $sth->fetch(PDO::FETCH_ASSOC);
    print_r($data);
} 
```

然后它工作正常并打印行数。

**问题：**为什么 execute() 函数没有将 :tbl 参数绑定到 $tbl ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:22:11.260

遗憾的是 MySQL PDO 不接受 SQL 关键字、表名、视图名和字段名的参数。[这在主要手册](http://www.php.net/manual/en/pdo.prepare.php)中并没有真正出现，但在[评论](http://www.php.net/manual/en/pdo.prepare.php#71127)中提到了几次。

您在第二段代码中的解决方案是解决方法，尽管您可能希望先清理表名（检查表名白名单是理想的）。更多信息：[PHP PDO 语句可以接受表名或列名作为参数吗？](https://stackoverflow.com/questions/182287/can-php-pdo-statements-accept-the-table-name-as-parameter)

# mysql - 事务回滚后不执行查询

> ID：11513776
> 
> 赞同：0
> 
> 时间：2012-07-16T22:56:42.280
> 
> 标签：mysql, node.js, transactions, node-mysql

我想在 node-mysql 中执行事务（通过执行查询 START TRANSACTION、ROLLBACK、COMMIT）。我有这段代码：

```
conn.query("START TRANSACTION");
conn.query("INSERT INTO users (id, name, age) VALUES (1, 'Mat', '24')", function(e){
    if (e){
        conn.query("ROLLBACK", callback);
    }
    else{
        conn.query("COMMIT", callback);
    }
});

conn.query("INSERT INTO users (name, age) VALUES ('Mat', '24')", function(e, r){
    console.log(e); // null
    console.log(r); // {fieldCount: 0, affectedRows: 1, insertId: 2, serverStatus: 3, warningCount: 0, message: ''}
}); 
```

为了测试回滚情况，我故意将 id 设置为 1，这会导致索引重复错误。事务被回滚，但问题是事务之外的第二个插入没有执行。没有记录错误，而且 - 对我来说很奇怪 - 当我在第二次插入之后选择整个表时，结果中有新行。但在另一个连接中它消失了。所以看起来在连接结束时新创建的行被删除了。提交事务时不会出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:09:09.877

您的第二个`INSERT INTO`可以在您`ROLLBACK`的第一个`INSERT INTO`回调之前执行，因为它在回调之外执行。发生这种情况时，您的第二次插入也会回滚，因为您使用的是单个连接。将第二个插入移动到第一个的回调中以序列化事物。

# vba - 让两个单元格从同一页面打印

> ID：11513778
> 
> 赞同：0
> 
> 时间：2012-07-16T22:56:52.860
> 
> 标签：vba, excel

我想知道是否有可能拥有一个填充页面并打印它然后从列中转到下一个的宏，依此类推。

数字将在 Sheet2、C2 和 C4 上命名。这是一个模板，因此它应该删除空白，然后从 sheet1 的列表中刷新下一个数字和名称。

唯一的问题是可以设置它以便我可以选择起始单元格还是必须一次打印所有行？假设我今天只想打印 20 个，然后明天再打印 50 个可以完成....

目前有很多手动输入，所以任何帮助都会很棒。

我在下面有一个示例（名称已更改），该列最多可以有 500 个名称，需要打印以放置在每个文件夹中。下面正确输入数字我只是无法弄清楚如何在 sheet1 中包含单元格 D2 中的名称

```
Sub PrintLoop()
    Dim c As Range, LR As Long
    Application.ScreenUpdating = False
    LR = Sheets("sheet1").Range("C" & Rows.Count).End(xlUp).Row
    For Each c In Sheets("sheet1").Range("C2:C" & LR)
        Sheets("sheet2").Range("C2").Value = c.Value
        Sheets("sheet2").PrintPreview
    Next c
    Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:33:23.863

在运行之前只选择要打印的行...

```
Sub PrintLoop()

    Dim rw As Range

    Application.ScreenUpdating = False

    For Each rw In Selection.Rows
        With Sheets("sheet2")
            .Range("C2").Value = rw.EntireRow.Cells(3).Value
            .Range("C4").Value = rw.EntireRow.Cells(4).Value
            .PrintPreview
            '.PrintOut From:=1, To:=1, Copies:=1
        End With
    Next rw

    Application.ScreenUpdating = True

End Sub 
```

# sql-server - SSIS - 将多列值转换为空值

> ID：11513781
> 
> 赞同：1
> 
> 时间：2012-07-16T22:57:10.657
> 
> 标签：sql-server, sql-server-2008, ssis

我正在使用 SSIS (SQL Server 2008 R2) 将输入 CSV 文件转换为 SQL 表。输入文件中的五列（实数 - 例如 19.54271）有时会出现错误值（字符串 - 例如“NAN”），这会导致包失败。

检查这 5 列是否存在错误值“NAN”、将其转换为 NULL 值或已知错误数字 (-9999) 并将更正后的值写入同一个最终 SQL 表的最简单方法是什么？

到目前为止我有以下混乱，最后决定问是否有更简单的方法......

![在此处输入图像描述](../Images/39addb22c8ac07121ba71c30c572357a.png)

我目前的条件逻辑：
![在此处输入图像描述](../Images/ca4a1c2f2c028319252b6f920b952d77.png)

我的 Case1 派生列转换：
![在此处输入图像描述](../Images/2ccac0bfab5dd8f79d5ef8664b795711.png)

注意：仍然不确定我是否可以将其他派生列合并到一个实例中，但由于我的目的地只能有一个输入，我怀疑我需要...

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:18:23.300

当逻辑复杂或有多个评估时，SSIS 表达式会变得复杂且难以阅读。在您的情况下，您将完成一堆任务，这些任务单独完成的很少。

我会将它捆绑到一个脚本组件中。这样，您可以使用基本的 vb 或 c# 函数来评估您的所有列是否都正确转换为数字并在没有时分配默认值。此外，您可以实现 try/catch 场景并将错误优雅地发送到不同的输出缓冲区。

下面是一些如何将脚本组件用作转换的示例：

[http://www.bimonkey.com/2009/09/the-script-transformation-part-1-a-simple-transformation/](http://www.bimonkey.com/2009/09/the-script-transformation-part-1-a-simple-transformation/)

[http://www.sqlis.com/sqlis/post/The-Script-Component-as-a-Transformation.aspx](http://www.sqlis.com/sqlis/post/The-Script-Component-as-a-Transformation.aspx)

[http://www.codeproject.com/Articles/193855/An-indespensible-SSIS-transformation-component-Scr](http://www.codeproject.com/Articles/193855/An-indespensible-SSIS-transformation-component-Scr)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T21:15:26.420

如果我的逻辑比简单地将坏值转换为空值更复杂，那么使用脚本组件似乎是最好的方法。

但是，转换对象的逻辑相当简单，所以希望这可以帮助其他人：

包（请注意，我为数据源中的可疑列重定向行）：
![SSIS 包](../Images/b92ef2b6d8ce6ca733c12150e130232a.png)

条件拆分逻辑：[编辑：我发现每个案例条件都需要单独的处理路径。如果您正在评估多个表达式，您可以在一种情况下通过在它们后面附加 || 来完成。操作员。] ![案例条件逻辑](../Images/8f0a839194ef919dd5dda4f7eb25f01a.png)

派生列逻辑： ![派生列逻辑](../Images/008dcece121514b5a2d1b295e238016d.png)

# xml - 使用 objectify 和 GWT，我收到一个错误，其中 google latlng classdefn 不存在

> ID：11513782
> 
> 赞同：0
> 
> 时间：2012-07-16T22:57:15.097
> 
> 标签：xml, google-app-engine, gwt, objectify

因此，我正在创建一个 Web 应用程序，该应用程序具有一个服务器调用，可以保存解析的 xml 数据。我试图坚持的领域之一是 google latlng，在将类复制到服务器包之前，这工作正常。

```
16-Jul-2012 7:26:59 PM com.google.appengine.tools.development.ApiProxyLocalImpl log
SEVERE: javax.servlet.ServletContext log: Exception while dispatching incoming RPC call
com.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract java.util.ArrayList com.softwarewaffles.vanparking.client.PersistentService.getAllLocations()' threw an unexpected exception: java.lang.NoClassDefFoundError: Lcom/google/gwt/maps/client/geom/LatLng;
    at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.NoClassDefFoundError: Lcom/google/gwt/maps/client/geom/LatLng;
    at java.lang.Class.getDeclaredFields0(Native Method)
    at java.lang.Class.privateGetDeclaredFields(Unknown Source)
    at java.lang.Class.getDeclaredFields(Unknown Source)
    at com.googlecode.objectify.impl.ConcreteEntityMetadata.processKeyFields(ConcreteEntityMetadata.java:114)
    at com.googlecode.objectify.impl.ConcreteEntityMetadata.processKeyFields(ConcreteEntityMetadata.java:111)
    at com.googlecode.objectify.impl.ConcreteEntityMetadata.<init>(ConcreteEntityMetadata.java:69)
    at com.googlecode.objectify.impl.Registrar.register(Registrar.java:69)
    at com.googlecode.objectify.ObjectifyFactory.register(ObjectifyFactory.java:209)
    at com.googlecode.objectify.ObjectifyService.register(ObjectifyService.java:38)
    at com.softwarewaffles.vanparking.server.PersistentServiceImpl.getAllLocations(PersistentServiceImpl.java:55)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:114)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
    ... 34 more
Caused by: java.lang.ClassNotFoundException: com.google.gwt.maps.client.geom.LatLng
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:176)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 50 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:00:54.350

尝试在 WEB-INF/lib 下包含 gwt-maps.jar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:01:17.603

看起来 com/google/gwt/maps/client/geom/LatLng 不在您的类路径中~

# asp.net - 如何在网站的子文件夹中部署 .Net 应用程序？

> ID：11513784
> 
> 赞同：1
> 
> 时间：2012-07-16T22:57:16.677
> 
> 标签：asp.net, .net, iis-7

我有一个名为*BasicTestProject*的 .Net 4.0 项目，它包含一个名为*Default*的网络表单。

**默认.aspx：**

```
<%@ Page Language="C#" AutoEventWireup="true" 
         CodeBehind="Default.aspx.cs" Inherits="BasicTestProject.Default" %> 
```

**默认.aspx.cs：**

```
namespace BasicTestProject 
{
    public partial class Default : System.Web.UI.Page 
    {
       ...
    }
} 
```

我想将此应用程序的编译版本放在网站的子文件夹中：

*   网站根
    *   子文件夹
        *   **基础测试项目**

在网站根目录，我有一个基本的 web.config：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.web>
        <compilation targetFramework="4.0" />
    </system.web>
</configuration> 
```

我对上面的示例进行了测试，当我尝试访问子文件夹（*http://WebsiteRoot/SubFolder/BasicTestProject/Default.aspx*）中的站点时，这是我得到的错误：

```
Parser Error 

Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately. 

Parser Error Message: Could not load type 'BasicTestProject.Default'.

Source Error: 

Line 1:  <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="BasicTestProject.Default" %>
Line 2:  
Line 3:  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

Source File: /*WebsiteRoot*/*SubFolder*/BasicTestProject/default.aspx    Line: 1 

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

另外，我应该提到我已经尝试将我编译的 BasicTestProject 放在它自己的 IP 地址上，以便它位于根文件夹中。这按预期工作，我可以访问 Default.aspx。

**更新（答案）：**

在 IIS7 中，我右键单击 BasicTestProject 并将其转换为应用程序。

*   网站根
    *   子文件夹
        *   **基础测试项目**

我还必须授予应用程序池用户对 BasicTestProject 文件夹的权限。它现在是独立运行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:54:34.680

您是否将该子文件夹配置为 IIS 中的应用程序？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:07:05.563

我将详细说明@MikeC 的回答：在 IIS 中有“应用程序范围”的概念，它是属于同一概念“应用程序”的*文件系统树的子层次结构。*

每个单独的 IIS 网站的根也被标记为新应用程序范围的根。在作用域中执行的任何服务器端代码都在作用域所属的应用程序池中运行（例如，CGI 和 FastCGI 进程在作用域池的标识下启​​动）。ASP.NET 通过将应用程序范围的根定义为它期望找到`bin`目录的位置以及允许`web.config`定义更多选项来进一步实现这一点。

正如我所说，这适用于文件系统层次结构，所以如果您使用 URL 重写或 ASP.NET URL 路由，那么它会使事情复杂化。

（这最初是对 Mike 答案的评论回复，但它超出了消息长度）。

# java - 在Java Swing中将用户界面与域分开

> ID：11513785
> 
> 赞同：3
> 
> 时间：2012-07-16T22:57:24.927
> 
> 标签：java, swing, layer, 3-tier, code-separation

作为一名 Java Swing 新手，我在将用户界面逻辑与域逻辑分开时遇到了一些麻烦。

我有一个带有 JFrame 的小型（微不足道？）Swing 应用程序，其中包含一个 JLabel、JTextField 和一个 JButton。当按下 JButton 时，会弹出一个 JFileChooser 对话框。选择文件后，JTextField 包含文件的绝对路径。到目前为止没有什么壮观的。我要完成的下一件事是将文件的这个绝对路径“注入”到文件管理器类中，该类将在进行选择并更新 JTextField 时处理文件的实际处理（每次选择文件时）使用 JButton）。

我的问题：

1.  如何让文件管理器知道何时开始读取文件？（例如计算该文件中的行数）
2.  如何以在 UI 层内共享最少信息的方式实现域层？我应该向 UI 添加文件管理器实例吗？
3.  我应该使用 JTextField 的值作为对文件管理器的引用，还是应该使用 JButton 操作将值设置到文件管理器中？我的意思是：使用 JTextField 的 propertychangelistener 或使用 JButton 的 actionlistener？
4.  我应该使用 filebean 将文件的绝对路径存储在域层中还是直接将其插入文件管理器？不同之处在于：当我使用属性更改侦听器时，绝对文件路径的值可以在 UI 输入更改时更新，但是当我直接使用构造函数或设置器插入值时，我必须在文件管理器中处理更改而不是处理文件bean中的更改。
5.  如何在域逻辑内的文件管理器内引用 UI 中使用的文件bean？
6.  领域逻辑和业务逻辑一样吗？我的意思是：文件管理器类应该在包whatever.b-logic中，而filebean类应该在包whatever.domain中？

该应用程序分为几个包：

*   随便：主类
*   不管什么.presentation : 摇摆的东西
*   不管是什么域名：数据的东西
*   不管是什么逻辑：应用程序逻辑

我希望我足够清楚...

提前感谢您的清理工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:29:08.233

就个人而言，当我处理这类问题时，我会尝试将可重用性和责任（谁负责什么）作为主要要求。

也就是说，我尝试将我的模型设置在如此远的地方，以便他们不关心数据来自或去往的方式或地点，它们只是提供接口访问来实现它。

要将所有元素连接在一起，我依靠模型向客户端提供事件，因为模型不应该关心谁想知道，只需提供所需的功能。因此，为了向客户提供反馈，我将依赖一系列听众。

我会将侦听器分解为特定的工作，文件读取的此类通知将是它自己的侦听器，对模型的更改（添加/删除/更新）文件 bean 将是另一个。其他通知将需要不同的侦听器，这会阻止您创建实现并不想知道的怪物侦听器。

对于在模型中设置值，我会在属性设置器/获取器方面犯错。这将您的模型与实现分离（如果您以自动化方式使用模型怎么办？？）

如果可能，内部数据最好由模型管理。也就是说，如果您更改模型正在管理的文件 bean 上的属性，那么模型应该能够监视更改并进行处理。话虽如此，您可能在将来的某个时候想要一个哑模型，您可以在其中批量更新一系列文件 bean，然后要求模型自行更新。

我个人可能会提供模型在外部更新的方法，同时提供至少一种能够提供自我监控的实现，这使您可以灵活地为正确的情况选择正确的模型。

这里也存在内存泄漏的危险。如果您在不再需要文件 bean 时没有从文件 bean 中正确删除它们，您最终可能会阻止 bean 在以后被垃圾收集。

在可能的情况下，使用接口。在尝试将这些模型组合在一起时，这提供了很大的灵活性。

对于您所描述的，我将允许文件 bean 由文件管理器负责，以便文件管理器成为文件 bean 的容器。

取决于您的项目有多大以及您将来可能希望如何重用代码，这将极大地影响代码的布局。

我通常将 UI 代码放在一个 UI 包和子包中，但那只是我。我倾向于将接口内容与实现内容分开（通常物理上在单独的 Jar 文件中，但同样是我）。这意味着我只需要包含接口库和我可能使用的任何实现，如果需要（或直接根据需要）使用某种工厂来实际实例化实现。以 JDBC 驱动程序为例。

你想着眼于领域的责任。根据您的描述，我觉得文件 bean 属于文件管理器的职责范围，因此我将两者绑定在一起。

这只是我的观点

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T00:03:18.230

这里有一些建议：

*   使用`SwingWorker`，如图所示[，](https://stackoverflow.com/a/11372932/230513)在监听进度的同时保持 GUI 活跃。

*   使用（[此处](https://stackoverflow.com/a/4039359/230513)`Action`说明） 来封装功能。

*   Use `File`，一个方便的、跨平台的抽象。使用它来组合新的抽象，而不是提取非跨平台的部分。

附录：另见[*A Swing 架构概述*](http://java.sun.com/products/jfc/tsc/articles/architecture/)和[答案](https://stackoverflow.com/a/3072979/230513)。

# sql - 如何插入记录并确保整行是唯一的

> ID：11513789
> 
> 赞同：2
> 
> 时间：2012-07-16T22:57:46.937
> 
> 标签：sql

我想将多个值插入一行，但我想确保该行是唯一的，即没有重复的行。

我不确定如何执行此操作（如果只有一个值要检查，这很容易，例如：[SQL Server - 如何插入记录并确保它是唯一的](https://stackoverflow.com/questions/267804/sql-server-how-to-insert-a-record-and-make-sure-it-is-unique)）。

这是我的代码，但它不允许我在测试单列和多列组合时插入唯一行。

```
CREATE TABLE myCities (
    UserID int null,
    CityID int null 
)

DECLARE @UserID int, @CityID int
SET @UserID = 1
SET @CityID = 1

INSERT INTO myCities (UserID,CityID) 
SELECT @UserID,@CityID
        WHERE 
            @UserID NOT IN ( SELECT UserID FROM myCities WHERE UserID = @UserID )
        AND 
            @CityID NOT IN ( SELECT CityID FROM myCities WHERE CityID = @CityID ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:06:49.447

唯一可靠的方法是将检查放入数据库中。在这种情况下，在表上创建一个唯一键，这也将是它的主键，所以

```
-- syntax for MS/Sybase at least is
ALTER TABLE myCities
ADD CONSTRAINT uc_myCities UNIQUE (UserID,CityID) 
```

然后，当您插入重复项时，您将收到一个错误，您的代码将不得不处理它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T22:59:57.093

有时显而易见的事情就在眼前 - 使用 解决它`NOT EXISTS`，如下所示：

```
INSERT INTO myCities (UserID,CityID) 
SELECT @UserID,@CityID
        WHERE NOT EXISTS ( 
                   SELECT UserID FROM myCities 
                   WHERE 
                   UserID = @UserID and 
                   CityID = @CityID
                 ) 
```

# php - AWS 上的 Cron（或一般的分布式系统）

> ID：11513791
> 
> 赞同：8
> 
> 时间：2012-07-16T22:57:54.227
> 
> 标签：php, mysql, amazon-web-services, cron, lamp

我很惊讶我无法找到更多关于此的信息，但唉，我仍然找不到答案。我们最近转换为 AWS，将我们简单的网站迁移到更强大、更可靠的系统。目前让我感到困惑的是在分布式系统上管理 cron 作业，当该 cron 作业被推送到环境中的每个实例时。

这是用例：

## 背景

### 设置

我们正在运行一个传统的 LAMP 堆栈。可能是第一个问题，但这就是我们遇到的问题。

### 数据库表

```
table1

 - id int(11)
 - start date
 - interval int(11) (number of seconds)

table2

 - id int(11)
 - table1_id int(11)
 - sent datetime 
```

## 目标

目标是脚本每天运行一次并检查以下内容：

1.  当前日期已过`table1.start`
2.  `table1.start`< 当前日期
3.  `table1.interval`> 0
4.  今天正好是一个完整的间隔（如果间隔是 7 天 [以秒为单位] 并且它是第 6 天，则会失败）
5.  今天没有条目，`table2`并且`table2.sent`与`table2.table1_id`之前的检查相匹配。

如果所有这些检查都通过，我们在 table2 中为每个具有间隔的 table1 插入一个条目。这也意味着我们根据表 2 中的数据发送电子邮件。

## 问题

本质上，我们有两个查询，由上述块表示。问题在于，在分布式系统上，每个实例将同时运行 cron（或彼此相隔几毫秒）。`table2`没有“事务”的概念，因此如果一个实例在其他实例运行第一个查询之前没有机会插入，每个实例都会发送一封电子邮件。

## 解决方案？？？

我已经对此进行了大量研究，但我想出的唯一可能的解决方案如下：

### Cron 实例

设置一个负责运行 cron 作业的独立实例。虽然这肯定会（据我所知）工作，但对于一项成本不高且最多每天只需要运行一次的工作来说，这是非常昂贵的。

### PHP 调度程序

将 cron 设置为定期运行充当调度程序的 PHP 脚本。这是我们在研究表明这对于我们有限的时间和金钱来说是最简单的路线之后要走的路线。我遇到的问题是，这似乎只是将并发问题从消耗作业转移到了调度作业。您何时安排作业，以便不会从运行 cron 的每个实例同时安排多个作业？

这种方法似乎也很“笨拙”（借用我朋友最喜欢的一句话），我不得不同意。

### 交易

尽管我对此进行了相当多的研究，但始终通过数据库上的原子事务来解决并发问题，但据我所知，这在 LAMP 中并不容易实现。但也许我错了，我很高兴被证明是这样。

## 最后

因此，如果有人可以帮助我解决这个问题，我将不胜感激。也许我的谷歌搜索技能已经生疏了，但我无法想象我是唯一一个遭受这项（可能很简单）任务的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:31:12.430

我有一个类似的问题。而且我还有每分钟都必须运行的 cron 作业，但只能在单个主机上运行

我用这个 hack 解决了这个问题，它运行 amazon 自动缩放工具来确定它运行的盒子是否是这个自动缩放组中最后一个实例化的盒子。这显然假设您使用自动缩放，并且主机名包含实例 ID。

```
#!/usr/bin/env ruby

AWS_AUTO_SCALING_HOME='/opt/AutoScaling'
AWS_AUTO_SCALING_URL='https://autoscaling.eu-west-1.amazonaws.com'
MY_GROUP = 'Production'

@cmd_out = `bash -c 'AWS_AUTO_SCALING_HOME=#{ AWS_AUTO_SCALING_HOME }\
  AWS_AUTO_SCALING_URL=#{ AWS_AUTO_SCALING_URL }\
  #{ AWS_AUTO_SCALING_HOME }/bin/as-describe-auto-scaling-instances'`

raise "Output empty, should not happen!" if @cmd_out.empty?
@lines = @cmd_out.split(/\r?\n/)
@last = @lines.select {|l| l.match MY_GROUP }.reverse.
  detect { |l| l =~ /^INSTANCE\s+\S+\s+\S+\s+\S+\s+InService\s+HEALTHY/ }
raise "No suitable host in autoscaling group!" unless @last
@last_host = @last.match(/^INSTANCE\s+(\S+)/)[1]
@hostname = `hostname`
if @hostname.index(@last_host)
  puts "It's me!"
  exit(0)
else
  puts "Someone else will do it!"
  exit(1)
end 
```

将其保存为 /usr/bin/lastonly，然后在 cron 作业中执行：

```
lastonly && do_my_stuff 
```

显然它并不完美，但它对我有用，而且很简单！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-21T00:08:40.630

看看 Gearman 项目[http://www.gearman.org](http://www.gearman.org)。基本架构是您将拥有一台机器作为作业服务器，而所有其他机器将成为服务器的客户端。

您可以在作业服务器上设置 crontab，以向通过 Gearman 连接的所有客户端发送要执行的命令。然后，您可以使用 PHP 对您的 cron 作业进行切片和切块，并尽可能深入地了解 Map/Reduce。

这是一个关于概念及其工作原理的很好的教程：[http ://www.lornajane.net/posts/2011/Using-Gearman-from-PHP](http://www.lornajane.net/posts/2011/Using-Gearman-from-PHP)

不要对立即使用像 Gearman 这样的东西感到灰心。分布式 cron 系统可能很复杂，但一旦你了解它，你就会没事的。

FWIW，我们每分钟在 Amazon EC2 上的 Gearman 工作场中处理数千个 cron 脚本。我们非常喜欢它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-23T03:43:54.023

您可以使用队列使任务只运行一次。

# php - 在 foreach 中调用 JSON 中的父字段

> ID：11513792
> 
> 赞同：0
> 
> 时间：2012-07-16T22:57:59.500
> 
> 标签：php, arrays, object, json

我可能在这里遗漏了一些简单的东西，但无论如何我觉得最好问一下。

我有以下代码：

```
$newarray = json_decode($jsoncode);
$rad = 24;
foreach ($newarray->objname as $obj)
{
    echo "<map name='" . $mapname . "'>";
    echo "<area shape=\"circle\" coords='" . $obj->x . "," . $obj->y . "," . $rad . "' alt='" . $obj . "'>";
    echo '</map>';
} 
```

来自手动创建的 json 字符串：

```
$jsoncode = '{"objname":{"Forest 1":{"x":120,"y":120},"Forest 2":{"x":434,"y":225}}}'; 
```

尝试调用 $obj 变量以在 foreach 中使用时出现错误。有没有我必须添加的东西才能显示存储在变量中的名称？

PS我对其余代码没有问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:01:00.737

PHP 的`foreach`语法应该是这样的——

```
foreach ($array AS $key=>$object){ 
  ... 
} 
```

所以你的代码应该是这样的 -

```
foreach ($newarray AS $objectName => $obj) 
```

*   `$objectName`是 中的索引`$newarray`。
*   `$obj`是数组中的实际元素。

* * *

[http://php.net/manual/en/control-structures.foreach.php](http://php.net/manual/en/control-structures.foreach.php)

该文档对语句的语法有这样的`foreach`说法-

> `foreach (array_expression as $value)`
> `statement`
> `foreach (array_expression as $key => $value)`
> `statement`

# c# - 如何将子元素作为解码字符串添加到 XElement？

> ID：11513794
> 
> 赞同：4
> 
> 时间：2012-07-16T22:58:10.567
> 
> 标签：c#, .net, xml, linq-to-xml, xelement

我想通过这个测试。我应该使用什么来代替 Add 方法？

```
[TestMethod]
public void AddContentWithoutEncoding()
{
   var element = new XElement("Parent");

   element.Add("<Son>5</Son>");

   Assert.IsTrue(element.ToString() == "<Parent><Son>5</Son></Parent>");
} 
```

当前`element.ToString() = "<Parent>&lt;Son&gt;5&lt;/Son&gt;</Parent>"`的方法显然是对标签内容进行编码。

我有一个带有标签的大常量字符串，我需要将其添加到 XElement（因为我更频繁地使用它）。并且想要使用一些聪明的解决方案而不是`HttpUtility.HtmlDecode`- 只是添加解码的字符串而不是在添加后解码整个结果。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T23:03:18.597

尝试，

```
var element = new XElement("Parent");
foreach(string xml in list)
    element.Add(XElement.Parse(xml)); 
```

你可能还想在你的断言中......

```
Assert.IsTrue(element.ToString(SaveOptions.DisableFormatting) == ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:12:48.933

你可以这样做`XElement.Parse`，然后像这样添加：

```
var element = new XElement("Parent");

element.Add(XElement.Parse("<Sone>5</Sone>"));

Console.WriteLine(element.ToString(SaveOptions.DisableFormatting)); 
```

这给了我你正在寻找的输出。

# java - preparedStatement.getBigDecimal，其中值为 null

> ID：11513795
> 
> 赞同：1
> 
> 时间：2012-07-16T22:58:18.560
> 
> 标签：java, postgresql, jdbc

我有一个准备好的语句，当所有列中都有一个值时效果很好，但是当有一个空值时，我得到了这个错误。

```
Bad value for type BigDecimal : N 
```

请注意，当我尝试使用时会引发错误：

> priceListResult.getBigDecimal(6);

我的 Google foo 让我失望了，我无法找到任何有关这方面的信息。我原以为这将是一个相当普遍的问题。

任何帮助，甚至是背景信息来帮助我搜索这个，非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T07:57:55.970

将作为此问题的库存解决方案发布：

```
When dealing with the following 

    org.postgresql.util.PSQLException: Bad value for type BigDecimal : Y
        at org.postgresql.jdbc2.AbstractJdbc2ResultSet.toBigDecimal(AbstractJdbc2ResultSet.java:2710)
        at org.postgresql.jdbc2.AbstractJdbc2ResultSet.getBigDecimal(AbstractJdbc2ResultSet.java:2133 
```

主要来源或错误是格式错误的 SQL。始终检查您的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:26:26.847

我的错，

我在我的 SQL 中错过了一个逗号，所以计数被取消了。不知道为什么这没有引发错误？

# c++ - 在 fwrite 调用中循环，直到写入缓冲区大小 C/C++

> ID：11513799
> 
> 赞同：3
> 
> 时间：2012-07-16T22:58:37.617
> 
> 标签：c++, c, io, libcurl

我正在设计一个`C++`回调函数，它将`size_t size`字节从缓冲区写入 C++ 中的文件。但是，为了理智，我必须检查是否`fwrite`返回 a`errno`例如`EACESS`. 函数本身是 和 之间的`C`接口`C++`。果然，我写了一个伪代码（几乎是真实的代码）：

```
static size_t write_data(void *ptr, size_t size, size_t nmemb, void *stream){
     int nwritten = size;
     while(nwritten > 0){
          int written = fwrite(ptr, size, nmemb, (FILE*)stream);
          if(written < 0 && errno == EACESS){
                  // try again
                  written = 0;
          }
          /* check some other errors which may be recoverable 
          nwritten -= written;
     } 
```

该函数本身是从[libcurl](http://curl.haxx.se/libcurl/)调用的：

```
curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data); 
```

关键是要确保将`size_t written = size`字节写入文件。我使用 a`fwrite`而不是任何其他方法的原因是因为该函数`write_data`作为回调传递给执行`HTTP`请求的方法，进行一些文件传输并将文件内容写入本地文件。我不确定这种方法是否有效。你们能告诉我这种方法是否可行，或者我可能遇到的潜在麻烦吗？如果有更好的方法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:21:34.250

`fwrite`返回写入的成员数，因此当您编写需要提前的成员时`ptr`，如下所示：

```
size_t done = 0;

while (done < nmemb) {
    size_t written = fwrite((char*)ptr + done * size, size, nmemb - done, (FILE*)stream);
    done += written;
    if (done < nmemb) {
        /* Not all has been written. Some kind of error may have occurred. */
        if (ferror((FILE*)stream)) {
            ...
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:41:52.787

我认为您正在寻找的是强大的 i/o。此链接和强大的 io 包可能会对您有所帮助：[http ://csapp.cs.cmu.edu/public/ch10-preview.pdf](http://csapp.cs.cmu.edu/public/ch10-preview.pdf)

# mysql - 如何更改 MySQL 的列以具有另一个默认值？

> ID：11513804
> 
> 赞同：1
> 
> 时间：2012-07-16T22:59:01.933
> 
> 标签：mysql, database

现在服务器默认值为 1。如何将其更改为 0？

这是当前的列：

```
+----------------+--------------+------+-----+---------+----------------+
| Field          | Type         | Null | Key | Default | Extra          |
+----------------+--------------+------+-----+---------+----------------+
 friend_posting | tinyint(1)   | NO   |     | 1       |                | 
```

它没有外键或任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:19:11.993

[http://dev.mysql.com/doc/refman/5.1/en/alter-table.html](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)

```
ALTER TABLE table_name
  ALTER COLUMN friend_posting
  SET DEFAULT 0 
```

这当然不会改变现有的行；它们将需要明确更新。它只为新行设置默认值。

# php - Wordpress 二维码小部件

> ID：11513806
> 
> 赞同：0
> 
> 时间：2012-07-16T22:59:06.260
> 
> 标签：php, wordpress, widget, qr-code

基本上，我一直在尝试制作一个简单的 Wordpress 小部件，它显示带有当前页面 URL 的 QR 码。我正在使用解析 PHP 的简单文本小部件的修改版本。

```
function the_qrcode($permalink = '', $title = '') {
    if($permalink && $title == '') {
        $permalink = 'http://eternityofgamers.com/forums';
        $title = 'Forums';
    }

    echo '<img src="http://api.qrserver.com/v1/create-qr-code/?data=' .$permalink. '" alt="QR: ' .$title. '"/>;
} 
```

有人可以告诉我这有什么问题吗？当我将它添加到`functions.php`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:11:09.053

您将需要使用该[`urlencode()`](http://php.net/manual/en/function.urlencode.php)功能。一般来说，根据经验，所有查询字符串值都应该是 url 编码的。

```
function the_qrcode( $permalink = '' ) {
    if($permalink == '') {
        $permalink = 'http://eternityofgamers.com/forums';
    }

    echo '<img src="http://api.qrserver.com/v1/create-qr-code/?data='.urlencode($permalink);
} 
```

现在您可以使用以下方法创建 QR 码：

```
the_qrcode(the_permalink()); 
```

此外，您**缺少一个非常糟糕的等号**。`=`了解和之间的区别非常重要`==`。如果您不这样做，则无论上下文如何`=`，都`==`意味着两件事。`=`将右侧分配给左侧。`==`无论左右手边是否松散相等，都返回真或假（松散地因为如果两边的类型不同，将使用强制转换）。

看这个例子（[键盘演示](http://codepad.viper-7.com/Xb9ivH)）：

```
$a = 5;
$b = 10;

if($a = 6) {
    echo "This always appears because when you assign a truthy (all non-zero numbers are true) to a variable, true is returned.\n";
    echo "Also a should now equal six instead of five: " . $a . "\n";
}

if($b == 10) {
    echo "This will work as expected because == is a comparison not an assignment.\n";
    echo "And b should still be 10: " . $b;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:40:47.760

尝试：

```
<?php
    function the_permalink( $permalink ) {
        if ($permalink == '') {
            echo '<img src="http://api.qrserver.com/v1/create-qr-code/?data=http://eternityofgamers.com/forums" alt="QR Code">';
        } else {
            echo '<img src="http://api.qrserver.com/v1/create-qr-code/?data='.$permalink;
        }
    }
?> 
```

（*我已经纠正了一堆语法错误*）

# javascript - 上传前如何验证最大文件数？

> ID：11513811
> 
> 赞同：5
> 
> 时间：2012-07-16T22:59:33.507
> 
> 标签：javascript, jquery, jquery-plugins

嗨，我正在使用上传文件插件，我需要在上传文件之前验证添加的文件数量......像这样

```
 $('#fileupload').bind('fileuploadadd', function (e, data) {
        filestoupload++;
        var numOfDivs = $('.request').size();
        if (numOfDivs < filestoupload) {
            upload = false; // Is just an example.
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:35:31.263

使用 data.files.length

```
 $('#fileupload').bind('fileuploadsubmit', function (e, data) {
    var fileCount = data.files.length;
    if (fileCount < filestoupload) {
        upload = false; 
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T23:12:16.680

这对我有用，在您的文件上传定义上添加一个 beforesend，然后进行验证

```
 var maxfiles=3;
 $('#fileupload').fileupload(({
    url: postFileUrl,
    submit: function (event, files) {
        //check for max files THIS IS WHERE YOU VALIDATE
        //console.log(files.originalFiles.length);
        var fileCount = files.originalFiles.length;
        if (fileCount > maxFiles) {
            alert("The max number of files is "+maxFiles);
            throw 'This is not an error. This is just to abort javascript';
            return false; 
        }
    }
  }); 
```

到目前为止，抛出并不优雅，如果您碰巧实现了这一点并找到了避免这种情况的方法，请告诉我（现在是必要的，否则它将为每个上传的文件显示错误警报）

# c# - 我可以复制文件，但我的 C# 控制台应用程序不能

> ID：11513812
> 
> 赞同：0
> 
> 时间：2012-07-16T22:59:34.540
> 
> 标签：c#, file-io

我编写了一个控制台应用程序来帮助将代码加载到服务器，但我在运行它时遇到了问题。我收到“System.UnauthorizedAccessException：对路径 '\...' 的访问被拒绝。

该应用程序正在比较文件，并将不同的文件从暂存区域复制到服务器。它运行良好，直到我尝试复制，然后我得到这个错误（例如，我可以读取和比较文件，但不能修改它们）。如果我（手动）只是将文件从一个区域复制到另一个区域，则没有问题。

我的印象是控制台应用程序作为执行它的人运行。

有问题的代码是这样的：

```
File.Copy("correct staging path", "correct live path", true); 
```

我能够使用以下方法验证应用程序是否正在运行：

```
Environment.UserName (WindowsIdentity.GetCurrent().Name shows the same) 
```

目标路径是网络共享（例如 \\servername\path）

# javascript - 如何在 html5/jquery 世界中实现母版页/模板

> ID：11513814
> 
> 赞同：1
> 
> 时间：2012-07-16T22:59:38.543
> 
> 标签：javascript, asp.net, html

我正在开发一个全新的网络应用程序。我们正在评估诸如 htlm5/jquery/backbone.js 等与 RESTful Web 服务通信的技术。

对于第 1 页，这很好。对于第 2 页，我不想复制和粘贴任何内容。在 ASP.NET 世界中，我会使用母版页引入和定义、页眉、页脚等。

母版页是否有 javascript/客户端方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-24T13:49:55.980

在 HTML5 中只有两种方法可以做到这一点：

1.  使用`<iframe>`
2.  使用`JavaScript`

由于`<iframe>`是一个过时的概念，建议使用 JavaScript。

欲了解更多信息，请查看[此处](http://www.codeproject.com/Articles/114458/Master-Pages-using-HTML-and-JavaScript)。

# mysql - 无法将行插入具有外键字段的表中

> ID：11513821
> 
> 赞同：1
> 
> 时间：2012-07-16T23:00:18.287
> 
> 标签：mysql, foreign-keys, innodb

我正在开发一个广泛使用数据库的 PHP 应用程序。我设置数据库的同事设置表以使用外键。这是我正在使用的声明：

```
INSERT INTO patients (ethnicity, gender)
VALUES (1, 1);

INSERT INTO sessions (patient_id, submitted, age_in_years, video, annotated)
VALUES (LAST_INSERT_ID(), NOW(), 0, '', FALSE); 
```

第一条语句有效。但是，第二个语句出现以下错误。

#1452 - 无法添加或更新子行：外键约束失败（`<database name>/sessions`, CONSTRAINT `fk_sessions_1` FOREIGN KEY (`patient_id`) REFERENCES `patient` (`id`) ON DELETE CASCADE ON更新级联）

我已经确认`LAST_INSERT_ID()`返回预期值。

我怎样才能解决这个问题？

下面是我们如何设置`sessions`表

```
CREATE TABLE IF NOT EXISTS `sessions` (
  `id` int(11) NOT NULL auto_increment,
  `patient_id` int(11) NOT NULL,
  `severity` enum('Minimal Symptoms of Autism Spectrum Disorder','Mild-to-Moderate Symptoms of Autism Spectrum Disorder','Severe Symtoms of Autism Spectrum Disorder') default NULL,
  `submitted` datetime default NULL,
  `age_in_years` int(11) NOT NULL,
  `video` text NOT NULL,
  `annotated` tinyint(1) default '0',
  PRIMARY KEY  (`id`),
  KEY `fk_sessions_1` (`patient_id`),
  KEY `age_in_years` (`age_in_years`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

ALTER TABLE `sessions`
  ADD CONSTRAINT `fk_sessions_1` FOREIGN KEY (`patient_id`) REFERENCES `patient` (`id`) ON DELETE CASCADE ON UPDATE CASCADE; 
```

编辑：删除了不必要的细节。如果您觉得需要更多，请随时查看这篇文章的第一个版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:00:38.503

事实证明，当我的同事添加外键时，他在外键引用的表名中有一个拼写错误。

```
ALTER TABLE `sessions`
  ADD CONSTRAINT `fk_sessions_1` FOREIGN KEY (`patient_id`) REFERENCES `patient` (`id`) ON DELETE CASCADE ON UPDATE CASCADE; 
```

应该

```
ALTER TABLE `sessions`
  ADD CONSTRAINT `fk_sessions_1` FOREIGN KEY (`patient_id`) REFERENCES `patients` (`id`) ON DELETE CASCADE; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:40:25.427

错误告诉你究竟出了什么问题。

您正在尝试插入一个`sessons.patient_id`不存在于`patients.id`. 这就是外键约束的设计方式。无论 LAST_UPDATE_ID() 的值是否符合您的预期，您都需要确认该值在`patients.id`.

例子：

```
patients
---------------
id    |    name
---------------
1     |    john
2     |    jane 
```

如果您尝试将“3”插入`sessions.patient_id`，您将收到您看到的错误，`id`因为`patients`.

# html - Facebook社交登录插件和：编辑和定位用户信息，并将其存储以备后用

> ID：11513823
> 
> 赞同：-1
> 
> 时间：2012-07-16T23:00:38.877
> 
> 标签：html, css, facebook-social-plugins

请原谅我，因为我是菜鸟。

我已经能够使用此处找到的 facebook 社交插件让 fb-login-button 出现在我的网站顶部：

developer.facebook.com/docs/reference/plugins/login/

目前，当您登录我的网站时，会显示以下内容：

[http://s11.postimage.org/4i1255843/fb_Login_Mysite.jpg](http://s11.postimage.org/4i1255843/fb_Login_Mysite.jpg)

但是，我想将我的网站设置为更像 RT 网站，只显示人的名字，并且还可以在网站周围显示一些其他信息，如下所示：

[http://s12.postimage.org/6cm7yyn1/Rotton_Tom.jpg](http://s12.postimage.org/6cm7ylyn1/Rotton_Tom.jpg)

**我的问题是：** 我希望能够向登录的人显示或隐藏特定的 Facebook 信息，例如他们的姓名、他们有多少朋友使用该网站，然后将这些信息放置在网站周围或其他页面上选择。有谁知道如何做到这一点或一些文档会在哪里？

此外，当用户使用 Facebook 登录/注册时，我想存储他们给我的信息，例如他们的电子邮件地址、姓名等。有谁知道我如何将这些信息存储在数据库或其他地方？它是否存储在我的 Facebook 应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:07:26.873

对于您的名字和您想要显示的所有信息，首先您需要创建 MySQL 数据库并在其中创建一个表。您可以使用 phpMyAdmin 自动创建它。

然后，您需要将您的数据库与您的 PHP 站点连接起来，该站点使用您的注册和登录代码。

你说你是菜鸟，所以我没有详细介绍，因为这里有很棒的视频[教程](http://www.youtube.com/playlist?list=PLE134D877783367C7&feature=plcp)。只需观看这些视频，您就会了解有关创建登录和注册页面的所有信息。

要创建摘要，您需要学习 PHP 以获取某些元素并操作它们（在您的网站上显示它们等）。

希望我有所帮助！

# c# - .net 在某些击键时阻止 WebBrowser 上的 keyDown

> ID：11513824
> 
> 赞同：0
> 
> 时间：2012-07-16T23:00:44.710
> 
> 标签：c#, .net, browser, keydown, preventdefault

我使用 .NET Framework 4.5 (Visual Studio 2012 RC Professional) 在 Visual C# 中编写了一个应用程序。在这个应用程序中，我有一个 WebBrowser 元素。

`Ctrl + O`当我执行一些击键（例如

我试图用 WebBrowser 做一些事情`previewKeyDown`，但我不知道该怎么做。

你能帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:03:20.227

您应该`KeyPreview = true`在托管表格上进行设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:17:28.957

添加属性

PreviewKeyDown="WindowKeyDown"

```
 private void WindowKeyDown(object sender, KeyEventArgs e)
    {
    if (e.Key == Key.A && Keyboard.Modifiers == ModifierKeys.Control)
    {
        MessageBox.Show("CTRL + A Pressed!");
    }
    } 
```

[在此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.previewkeydown.aspx)查看此链接 或

# scala - 嵌入的 JSON 对象未使用 fromJSON 保存在 BsonRecordListField 中

> ID：11513826
> 
> 赞同：1
> 
> 时间：2012-07-16T23:01:18.690
> 
> 标签：scala, mongodb, lift, bson

我正在使用 lift-mongodb-record 2.4 来管理 RESTful JSON Web 服务的 MongoRecords。一切都很好，除了我遇到的一个问题：嵌入式 BsonRecordListFields 不会自动保存。

这是我的测试 JSON：

```
{"name":"test","control_points":[{"dx":64,"dy":97},{"dx":358,"dy":64},{"dx":211,"dy":80.5}]} 
```

但是通过打印模型`println(Artifact.fromJSON(request.body).get)`只会打印

```
class com.test.model.Artifact={name=test, control_points=} 
```

这些是我的模型类：

```
class ControlPoint private () extends BsonRecord[ControlPoint] {
  def meta = ControlPoint
  object dx extends DoubleField(this)
  object dy extends DoubleField(this)
}

object ControlPoint extends ControlPoint with BsonMetaRecord[ControlPoint]

class Artifact private () extends MongoRecord[Artifact] with ObjectIdPk[Artifact] {
  def meta = Artifact
  object name extends StringField(this, 1024)
  object control_points extends BsonRecordListField(this,ControlPoint)
}
object Artifact extends Artifact with MongoMetaRecord[Artifact] {} 
```

*为什么嵌入的东西没有保存？我在这里想念什么吗？*

多谢！马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T10:04:35.720

[正如电梯邮件列表中](https://groups.google.com/forum/?fromgroups#!topic/liftweb/nrKifiiEOQw)指出的那样，lift-json 将数字解析为整数，因为它们没有小数点。我只是通过客户端将字段更改为`IntField`并将所有日期解析为整数。`parseInt`

# asp.net-mvc-3 - 有没有比 if/else 更好的方法在 mvc 中实现基于角色的动作和视图？

> ID：11513834
> 
> 赞同：0
> 
> 时间：2012-07-16T23:02:23.307
> 
> 标签：asp.net-mvc-3, asp.net-mvc-3-areas, asp.net-roles

所以我在我的 mvc .net 应用程序中拥有三个角色，管理员、公司和员工，该应用程序在单独的数据库中使用 asp.net 成员资格。我现在将 .net 成员资格移到了不同​​的数据库中，因为每次我修改模型时，.net 成员资格表都会被删除。

无论如何，我在操作方法中使用 if/else 处理不同的角色。例如，在 Index() 操作中，我检查用户是否处于管理员角色，然后基于此创建模型和 linq 查询。如果用户是公司角色，则查询不同，如果用户是员工角色，则查询不同。检查下面的代码。if 条件后创建的模型传递给 View。

我觉得这不是处理角色的最佳方式。这是处理角色的最佳方式吗？我也在考虑不同的领域，但我对不同的角色使用相同的观点，我认为这可能不会有成效。

非常感谢任何建议/想法。

```
[Authorize]
    public class CompanyController : Controller
    {
        private MyDBContext db = new MyDBContext();

        //
        // GET: /Company/

        public ViewResult Index()
        {
            var viewModel = new CompanyIndexViewModel();
            if (Roles.IsUserInRole("administrators")) {
                viewModel = new CompanyIndexViewModel { Companies = db.Companies.ToList() };
            }
            else if (Roles.IsUserInRole("companies")) {
                viewModel = new CompanyIndexViewModel { Companies = db.Companies.Where(c => c.Username.ToLower().Equals(this.User.Identity.Name.ToLower())).ToList() };
            }
            else if (Roles.IsUserInRole("employees")) {
                string userName = this.User.Identity.Name.ToLower();
                var companies = db.Companies.Where(c => c.Appointments.Any(a =>
                                   a.Employee.Username.ToLower() == userName)).ToList();
                viewModel = new CompanyIndexViewModel { Companies = companies.ToList() };
            }

            return View(viewModel);
        }
.... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T04:03:10.060

我会做两件事：

首先，StanK 所说的并将其移出控制器动作。但是，我会将它一起移出控制器。这种逻辑一开始就不应该真正驻留在控制器中（无论是在动作中，还是在控制器中的私有方法中）。

可以这样想：如果你关于谁可以看到哪些公司发生变化的逻辑怎么办……你必须在各种不同的地方改变它。

其次，我将为 CompanyIndexViewModel 创建一个构造函数，该构造函数接受 Company 列表，而不是像那样内联初始化它。除了公司之外，CompanyIndexViewModel 是否包含其他任何内容？

```
// your controller
public ViewResult Index()
{
    var viewModel = CompanyIndexViewModel(CompanyService.GetCompaniesForCurrentUser());
    return View(viewModel);
} 
```

理想情况下，您还可以让您的控制器依赖于表示“CompanyService”的接口，并将其注入到您的控制器中。

[看一看这个博客](http://www.shahnawazk.com/2010/12/dependency-injection-in-aspnet-mvc-3.html)，它概述了将 Ninject 与 MVC 3 一起使用。为以后对您如此强大的东西进行设置非常简单。

如果您从我上面所说的内容中拿走一件事，最好从将您的逻辑移出控制器开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:17:21.713

我会将构建公司列表的代码移动到它自己的方法来整理控制器操作，这也将使确定当前用户的公司列表的逻辑可重用。

例如

```
private List<Company> GetCompaniesForCurrentUser()
{
    var userName = this.User.Identity.Name.ToLower();

    if (Roles.IsUserInRole("administrators"))
        return db.Companies.ToList();

    if (Roles.IsUserInRole("companies"))
        return db.Companies.Where(c => c.Username.ToLower().Equals(userName)).ToList();

    if (Roles.IsUserInRole("employees"))
        return db.Companies.Where(c => c.Appointments.Any(a =>
        a.Employee.Username.ToLower() == userName)).ToList();

    throw new AuthorizationException("User " + userName + " is not authorised.");

}

public ViewResult Index()
{
    var viewModel = new CompanyIndexViewModel { Companies = GetCompaniesForCurrentUser() };
    return View(viewModel);
} 
```

# php - Yii Design - 如何拆分视图逻辑？

> ID：11513835
> 
> 赞同：0
> 
> 时间：2012-07-16T23:02:23.593
> 
> 标签：php, templates, yii

MVC 对我来说是一个相当新的概念，我刚刚发现自己在做一些我不太确定是否会被认为是“好习惯”的事情。

我有一个处理所有用户相关操作的控制器`User`（从 扩展）。`CUserController`在这个控制器中，我`actionLogin`处理登录请求。现在在登录过程中，我需要根据情况显示3个不同的页面：

*   登录表单（输入用户名/密码）。
*   错误消息（如果用户详细信息匹配但帐户被标记为被阻止）。
*   登录成功页面（如果有新消息与帐户相关联）。

到目前为止，我已经这样处理它：

```
public function actionLogin(){
    ... perform some operations ...
    ... determine which page to display and set $scenario accordingly ...
    $this->render('login',array(
        'scenario'=>$scenario
    ));
} 
```

然后在`login.php`（视图文件）中：

```
... perform some common operations ...
switch($scenario){
    case "login":
        ...display login...
        break;
    case "error":
        ... display error ...
        break;
    .. etc. ...
} 
```

现在这使我的视图文件实际上显示了完全不同的页面（尽管密切相关）。

将我的视图拆分为不同的页面（例如`login-form.php`, `login-error.php`, `login-success.php`）并根据情况呈现不同的页面会更好，`actionLogin`还是我目前做的处理这个的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:25:07.573

最好的选择是尝试修复 Yii 对 MVC 设计模式的解释，我喜欢称之为 ORM-Template-Adapter 模式。

您的问题源于这样一个事实，即在适当的 MVC 启发结构中，*视图*应该是对象，负责**所有**表示逻辑并且每个都能够管理多个模板。

Yii 真正努力实现的 MVC 变体是 MVP：model-view-presenter。显着的区别在于 MVP 中的 View 是被动的（这不是“哑模板”的同义词）。你应该坚持下去。

我建议创建一个处理身份验证表示的类。并有 4 个模板：

*   布局 - 基本的东西，不会改变的 html 部分
*   登录 - 表单
*   错误-好吧..猜猜它的作用
*   成功

然后您的新的和改进的视图将根据来自`User` ~~控制器~~ *演示者*的输入来决定要组合哪些模板。

...或者您将更多的演示逻辑冷推到您的`User`“控制器”上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:25:36.870

我认为您试图在 MVC 比赛中不使用 MVC。为什么？actionLogin 只是动作登录。如果您需要一个错误页面（...如果您需要...），您可以创建 actionError()。但我不明白为什么。通常错误会显示在登录页面的消息中。将视图视为视图（仅 html、css、js）。将模型视为数据（数组、查询结果）。并将控制器视为一个获取视图并使用某些数据源渲染它的人。停止。您需要包含特定数据的特定视图吗？好吧：只需创建该视图，获取该数据。最后但同样重要的是，为您的混搭创建您自己的控制器。

# security - OAuth 访问令牌可以用作公共 ID 吗？

> ID：11513840
> 
> 赞同：0
> 
> 时间：2012-07-16T23:02:37.420
> 
> 标签：security, oauth

我的应用程序本质上是一个无状态代理，它将从服务中获取的一些数据转换为不同的格式，并即时提供给用户。由于数据不是机密的，唯一的身份验证方法将是一个大的、随机的 URL。尽管如此，我需要存储以获取数据的 OAuth 访问令牌确实提供了一些`write`我希望避免泄漏的功能。

我的问题是使用访问令牌作为 URL 上的公共标识符并只保护`secret`密钥是否安全，或者我是否应该生成随机 ID 并将它们链接到内部令牌。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T05:28:31.500

根据[OAuth 1 规范](http://oauth.net/core/1.0a)，访问令牌在接收和访问共享资源时以明文（带有签名请求）的形式传递。因此，只要您不泄露您的任何一个秘密，使用它们作为唯一标识符就不会增加您的攻击风险。

也就是说，控制 URL 的格式可能值得将两者链接在一起。IDP 可能会在某些时候出现您未预料到的格式、长度或唯一性错误，这可能会伤害您。

# java - Appengine 转换 Api (java)

> ID：11513841
> 
> 赞同：0
> 
> 时间：2012-07-16T23:02:38.057
> 
> 标签：java, google-app-engine, pdf, data-conversion

我想在 appengine 中将 pdf 转换为图像文件。理想情况下，我会将 pdf 作为 blob 上传并存储 pdf 和 pdf 的图像。转换也可以在不同的时间完成（任务队列）。

我还没有找到任何工作示例或这样做的良好文档。
官方文档在[这里](https://developers.google.com/appengine/docs/java/conversion/overview)。这是我在上传 servlet 上的实现。

```
@SuppressWarnings("serial")
public class UploadBlobServlet extends HttpServlet {

  private static final Logger log = Logger.getLogger(UploadBlobServlet.class.getName());

public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {

    BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();
    Map<String, BlobKey> blobs = blobstoreService.getUploadedBlobs(req);
    BlobKey blobKey = blobs.get("data");
    log.log(Level.WARNING,"blobKey: "+blobKey.getKeyString());

        if (blobKey != null) {
        resp.getWriter().println(blobKey.getKeyString());

        BlobstoreInputStream in=new BlobstoreInputStream(blobKey);
        byte[] b = IOUtils.toByteArray(is);
      //  try{
            in.read(b);
            Asset asset = new Asset(
                    "application/pdf", b, "testfile.pdf");
                Document document = new Document(asset);
                Conversion conversion = new Conversion(document, "image/png");

                ConversionService service =
                    ConversionServiceFactory.getConversionService();
                ConversionResult result = service.convert(conversion);

                if (result.success()) {
                  // Note: in most cases, we will return data all in one asset,
                  // except that we return multiple assets for multi-page images.
                FileService fileService=FileServiceFactory.getFileService(); 
                for (Asset ass : result.getOutputDoc().getAssets()) {
                    AppEngineFile file=fileService.createNewBlobFile("image/png", "testfile.png");
                    FileWriteChannel writeChannel=fileService.openWriteChannel(file, false);
                    writeChannel.write(ByteBuffer.wrap(b));
                    writeChannel.closeFinally();
                  }
                } else {
                    log.log(Level.WARNING,"error");

                } 
```

更新：已添加 byte[]=IOUtils.toByteArray(is); 并且仍然获得NPE ...

如果有人有经验，我也很好奇转换的质量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:39:19.883

要转换文档，您首先必须创建资产。通过将字节传递给构造函数来创建资产，如示例中所示。在您的情况下，您将需要使用类[BlobstoreInputStream](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/blobstore/BlobstoreInputStream)来读取 PDF 的字节。

```
BlobKey blobKey = new BlobKey("your-pdf-blobkey");
InputStream is = new BlobstoreInputStream(blobkey); 
```

然后您需要从此输入流中读取所有字节。

转换后，您可以访问转换后图像的字节，`asset.getData()`然后按照[此文档](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)将图像写入 blobstore。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:18:59.257

这是接收上传 pdf 并使用 Conversion api 将其转换为 png 的工作代码。上传完成后需要多部分post到上传url，必须通过以下方式获取：

```
 String url=blobstoreService.createUploadUrl("/upload"); 
```

只需将此代码放在 servlet 中并将其映射到 web.xml 中的“上传”。

转换质量很好，但是我确实注意到文本周围有点模糊。在我的情况下，png 大约大 25%。

```
public void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws IOException {

    BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();
    Map<String, BlobKey> blobs = blobstoreService.getUploadedBlobs(req);
    BlobKey blobKey = blobs.get("data");

        if (blobKey != null) {
        resp.getWriter().println(blobKey.getKeyString());
        BlobstoreInputStream in=new BlobstoreInputStream(blobKey);

        byte[] b = IOUtils.toByteArray(in);
        if(b!=null){
            log.log(Level.WARNING,"blobsize: "+b.length);
        }else{
            log.log(Level.WARNING,"b is null");

        }
            in.read(b);
            Asset asset = new Asset(
                    "application/pdf", b, "testfile.pdf");
                Document document = new Document(asset);
                Conversion conversion = new Conversion(document, "image/png");

                ConversionService service =
                    ConversionServiceFactory.getConversionService();
                ConversionResult result = service.convert(conversion);

                if (result.success()) {
                  // Note: in most cases, we will return data all in one asset,
                  // except that we return multiple assets for multi-page images.
                FileService fileService=FileServiceFactory.getFileService(); 
                for (Asset ass : result.getOutputDoc().getAssets()) {
                    AppEngineFile file=fileService.createNewBlobFile("image/png", "test3file.png");
                    FileWriteChannel writeChannel=fileService.openWriteChannel(file, true);
                    writeChannel.write(ByteBuffer.wrap(ass.getData()));

                    writeChannel.closeFinally();
                  }
                } else {
                    log.log(Level.WARNING,"error");

                } 
```

# javascript - 如何将 HTML ID 链接与 Bootstrap navbar-header 一起使用？

> ID：11513853
> 
> 赞同：3
> 
> 时间：2012-07-16T23:04:12.613
> 
> 标签：javascript, jquery, ruby-on-rails-3, html, twitter-bootstrap

在我的 Rails 应用程序中，我正在尝试构建一个简单的常见问题解答页面，该页面有一个侧边栏，当您单击某个主题时，它会向下移动到该问题。

所以我在侧边栏中的一段代码看起来像：

```
<li><a href="#work">How does it work?</a></li> 
```

然后我有一个与 id="work" 匹配的 h2。

当我对其进行测试时，它一直在超调，我认为是因为它从页面顶部开始显示内容，该页面被 Bootstrap 中的导航栏隐藏。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-04T01:10:40.307

有同样的问题。这是我想出的：

```
// listen for click events originating from elements with href starting with #
$('body').on('click.scroll-adjust', '[href^="#"]', function (e) {
  var $nav

  // make sure navigation hasn't already been prevented
  if ( e && e.isDefaultPrevented() ) return

  // get a reference to the offending navbar
  $nav = $('div.navbar')

  // check if the navbar is fixed
  if ( $nav.css('position') !== "fixed" ) return

  // listen for when the browser performs the scroll
  $(window).one('scroll', function () {
    // scroll the window up by the height of the navbar
    window.scrollBy(0, -$nav.height())
  });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T14:23:09.347

我纯粹使用 CSS/HTML 标记解决了这个问题——这可能对你有用，也可能对你不起作用，具体取决于你的结构。

首先，我在导航栏中引用的每个元素都是一个 div，因为我的页面被分成几个部分，每个 dav 都有类`container`，所以页面结构是：

```
<body>
 <div class="navbar navbar-fixed-top">
   <div class="navbar-inner">
     <div class="container">  
       <ul class="nav">
         <li class="active"><a href="#one">one</a></li>
         <li><a href="#two">two</a></li>
         <li><a href="#three">three</a></li>
         <li><a href="#four">four</a></li>
         <li><a href="#five">five</a></li>
       </ul>
     </div>
   </div>
 </div>

 <div class="container" id="one">  
   <h1>One</h1>
 </div>

 ...

 <div class="container" id="five">  
   <h1>Five</h1>
 </div> 
```

文档建议您将正文填充至少 40px 以补偿导航栏，这很好 - 但它只会在页面位于顶部时将内容向下推。正如你所做的那样，我发现从静态导航栏到页面`#`锚点的任何链接都在页面上太高了。

我的解决方案是填充每个锚定元素的顶部，因此我将以下 CSS 添加到我的页面 CSS（在标准引导程序和响应式样式表之间加载）：

```
.container {
  padding-top:  60px;
} 
```

这显然在我的页面上的每个部分之间增加了空间，但这在我的布局中实际上很有用。

值得记住的是，因为顶部也有这个填充，所以不需要在`<body>`标签的顶部应用填充。

# php - 存储和生成类别层次结构的最有效方法是什么？

> ID：11513855
> 
> 赞同：0
> 
> 时间：2012-07-16T23:04:32.793
> 
> 标签：php, mysql, hierarchy, hierarchical-data, categories

我正在用 PHP 创建一个基本的购物车，并且想知道，以具有无限子类别的层次结构格式存储和生成类别列表的最佳方法是什么？

目前我加载主要类别，然后`foreach`从数据库中获取子类别等等，在大型站点上会创建超过 100 个查询。

那么有什么更好的做事方式呢？

这是我当前的 MySQL 表结构：

```
cat_id  
cat_name
cat_desc
cat_parent_id
status
priority 
```

我的目标是**1个**查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:49:31.717

Wordpress 在这方面做得很好：

参见：[http](http://codex.wordpress.org/File:WP3.0-ERD.png) ://codex.wordpress.org/File:WP3.0-ERD.png和[http://codex.wordpress.org/WordPress_Taxonomy](http://codex.wordpress.org/WordPress_Taxonomy)

如果你走这条路 这个[法典页面](http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query)有一些问题查询逻辑，用于抓取你可能会发现有用的类别（[相关堆栈帖子](https://stackoverflow.com/questions/1155565/query-multiple-custom-taxonomy-terms-in-wordpress-2-8)）

关键是带有类别的表有一个条目，因此您可以让它知道该类别是否具有父类别（允许您将表连接到自身）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:50:16.693

查看这篇文章：[类别层次结构（PHP/MySQL）](https://stackoverflow.com/questions/4452472/category-hierarchy-php-mysql)

它使用一个查询从数据库中获取所有类别，然后操作数组以创建子类别。我修改了在 Codeigniter 中使用的答案，效果很好。如果您想使用 Codeigniter，可以在此处发布修改后的代码。

# wcf - 带有 WCF 服务的 Prism - 它们总是异步的吗？

> ID：11513857
> 
> 赞同：0
> 
> 时间：2012-07-16T23:04:36.780
> 
> 标签：wcf, asynchronous, prism

我已经开始在 MVVM 架构中构建 WPF 应用程序（使用 Prism 基础架构）。

我需要 WPF 应用程序连接到几个不同的 WCF 服务。

我有点困惑，因为我在网上找不到任何此类行为的样本。

我发现了一些连接到 WCF 服务的 Silverlight+Prism 示例，但它们**总是**异步进行。

是否有一个原因 ？（我的服务都是'同步'）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:00:46.077

Silverlight 仅支持异步 WCF 调用，这就是所有这些示例都这样做的原因。

Prism 中没有任何东西可以阻止您进行同步 WCF 调用，但您将无法为 Silverlight 多目标这些模块。在 UI 方面（即使在 WPF 中），您最好异步进行这些调用。

无论如何，您是否实现了服务同步或异步与客户端并不真正相关 - 在生成客户端代理时，您可以为每个操作生成异步开始/结束对。

# javascript - 从数据表中检索可见数据

> ID：11513858
> 
> 赞同：0
> 
> 时间：2012-07-16T23:04:40.790
> 
> 标签：javascript, jquery-datatables

我目前正在使用数据表来显示三列，其中包含不同数量的信息行。

该表已设置为，当单击列标题时，该表将根据该列进行排序。我正在尝试使用 fnGetData 来获取现在已排序的可见数据。但是，我的尝试只是返回初始化表的原始数据。

这大致是代码的样子：

```
$("#example").click(function() {
           oTable = $('#' + tableName).dataTable();

              var secondCellArray=[];
              $.each( oTable.fnGetData(), function(i, row){
                  secondCellArray.push( row[0],row[1],row[2]);
            })

             console.log( secondCellArray)
}); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-12-24T17:06:56.507

下划线 (_) 方法在这里特别有用。过去对我来说效果很好。它将返回一个对象数组。

```
oTable._('tr', {"filter":"applied"}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T23:10:40.770

该`fnGetData`方法是提取数据的正确方法（对于 Datatables 版本 <= 1.10）：

[http://legacy.datatables.net/api#fnGetData](http://legacy.datatables.net/api#fnGetData)

根据该文档，该功能将：

> 根据提供的参数获取整个表格、单个行或单个单元格的数据。

这是该文档中的一个示例：

```
oTable = $('#example').dataTable();

oTable.$('tr').click( function () {
   var data = oTable.fnGetData( this );
   // ... do something with the array / object of data for the row
}); 
```

* * *

注意：我的原始答案提到使用`fnGetData`不带参数（很久以前对我有用），并且文档建议应该仍然有效（“整个表的数据”），但是由于该答案被否决并且文档没有具体提供它的用法示例，我将避免建议以这种方式使用它。

* * *

当然，旧的数据表有点糟糕，所以很可能（除非你有很多围绕旧数据表构建的代码）你最好的选择是升级到最新版本（或完全升级到另一个表/网格库）。

# asp.net - 数据集更新，外键违规（但仅在 ASP.NET 中？）

> ID：11513859
> 
> 赞同：1
> 
> 时间：2012-07-16T23:04:49.897
> 
> 标签：asp.net, visual-studio-2010, tsql, webforms, dataset

我无法将相关行插入到我的数据库中。当我在 ASP.NET 应用程序中将新对象插入数据库时​​，我收到外键冲突错误，而在控制台应用程序中，我没有。

以下是重现问题的步骤：

1.  在新数据库上创建并运行以下 T-SQL 脚本：

    ```
    create table dbo.[Groups] (
        GroupId int identity primary key,
        Name nvarchar(64) not null
    )

    create table dbo.[Objects] (
        ObjectId int identity primary key,
        GroupId int not null foreign key references [Groups] on delete cascade,
        Name nvarchar(64) not null
    ) 
    ```

2.  设置一个名为“ConsoleProgram”的 C# 控制台应用程序。

3.  将一个名为“dsObjects”的新数据集添加到项目中。
4.  将表“组”和“对象”从服务器资源管理器拖到设计器中。
5.  编辑两个表之间的关系，将关系设置为“关系和外键约束”，更新规则为“级联”。
6.  将以下代码插入“Main”：

    ```
    // (assuming appropriate using statement for dsObjectsTableAdapters)
    var ds = new dsObjects();
    var mgr = new dsObjectsTableAdapters.TableAdapterManager {
        GroupsTableAdapter = new GroupsTableAdapter(),
        ObjectsTableAdapter = new ObjectsTableAdapter()
    };            
    mgr.GroupsTableAdapter.Fill( ds.Groups );
    mgr.ObjectsTableAdapter.Fill( ds.Objects );

    var row = ds.Groups.AddGroupsRow( "Fruits" );
    ds.Objects.AddObjectsRow( row, "Apple" );
    ds.Objects.AddObjectsRow( row, "Banana" );
    ds.Objects.AddObjectsRow( row, "Orange" );

    mgr.UpdateAll( ds ); 
    ```

7.  运行程序并验证新行是否已插入到相应的表中：

    ```
    GroupId     Name
    ----------- -------
    1           Fruits

    (1 row(s) affected)

    ObjectId    GroupId     Name
    ----------- ----------- -------
    1           1           Apple
    2           1           Banana
    3           1           Orange

    (3 row(s) affected) 
    ```

8.  删除新创建的数据。

9.  关闭解决方案。
10.  创建一个新的 ASP.NET Web 应用程序。
11.  重复步骤 3-5。
12.  将第 6 步中的代码插入到 Default.aspx 的 Page_Load 函数中。
13.  运行程序。
14.  请注意有关外键违规的异常（如果有）。
15.  再次运行控制台程序，注意数据已成功创建。
16.  重新创建数据库并再次运行 ASP.NET 应用程序并注意相同的异常。

我尝试使用 UpdateAll 方法按顺序更新表，两个项目的结果相同。

我完全不知道为什么这会在 ConsoleApplication 中工作，而不是在 ASP.NET 应用程序中工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:16:14.907

好的，经过一番搜索，我找到了解决问题的方法。在线程[http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/4d10fe87-2de8-42a8-8ef9-b9d46c0fd28d](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataset/thread/4d10fe87-2de8-42a8-8ef9-b9d46c0fd28d)中，暗示为了正确更新身份列数据集，必须在 INSERT 语句之后使用 SELECT 语句。在探索了“TableAdapter 配置向导”之后，我发现在“高级选项”下有一个“刷新数据表”选项，它在 INSERTions 之后添加了适当的 SELECT 语句。由于某些未知的原因，这在 ASP.NET Web 应用程序中默认未选中，而在控制台应用程序中默认选中。

选中此选项后，数据集更新将按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T09:46:51.060

我在我的 PC 上运行您的代码，但在我的控制台应用程序中出现以下错误。

```
Cannot make this change because constraints are enforced on relation FK__Objects__GroupId__2C3393D0, and changing this value will strand child rows. 
```

还有一件事，`var row = ds.Groups.AddGroupsRow( "Fruits" );`当我调试它时，以下代码返回一个包含 GroupID 和 Name 的数据行，我发现在添加第一条记录后它包含 GroupID = -1 和 Name = Fruits。ID 怎么可能是 = -1 ？

# node.js - 猫鼬点符号 $inc 更新

> ID：11513862
> 
> 赞同：5
> 
> 时间：2012-07-16T23:05:01.860
> 
> 标签：node.js, mongodb, mongoose

我有一个文件如下：

```
{
  "_id" : "1",

  "myplaylists" : [{
      "_id" : "2",
      "name" : "Playlist_0",
      "likes" : 712,
      "views" : 7110
    }],
  "name" : "First name, Last name"
} 
```

我想做一个更新并增加“myplaylists.likes”

我所做的是：

```
User.update( {'myplaylists._id': 2}, {$inc: { 'myplaylists.likes': 1 }} 
```

但由于 $inc 中的点符号，它似乎不起作用

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:50:23.023

使用[位置运算符](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator) `$`来识别要更新的匹配数组元素：

```
User.update( {'myplaylists._id': 2}, {$inc: { 'myplaylists.$.likes': 1 }} 
```

# mysql - MySQL - 独特但不是那么独特请

> ID：11513865
> 
> 赞同：1
> 
> 时间：2012-07-16T23:05:06.013
> 
> 标签：mysql, unique-constraint

我有一个`VARCHAR`字段（在 MySQL 数据库的表中），与整个集合中同一字段的任何其他行相比，我需要每个条目都是唯一的。

但是，在我删除这些唯一字符串之一后，我希望能够插入和更新该字段的其他记录，以便它们现在具有这个以前使用的唯一值。

问题是唯一约束似乎记住了所有“已删除的唯一字符串”，它不允许我更新或添加以前使用的字符串（但现在已删除）。

是否有另一个约束，我可以在其中指定该集合必须始终是不同的，但以前删除的唯一`VARCHARs`性不受限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:07:02.447

不，它不是那样工作的。

从表中删除一个值后，即使表上有唯一约束，也可以再次插入该值。

一个潜在的问题是如果您使用软删除 - 即通过将`is_deleted`字段设置为 1 将行标记为已删除。如果是这种情况，那么您是对的，软删除值将阻止唯一约束按预期工作。但这里的情况似乎并非如此。

# python - 防止包自行导入

> ID：11513866
> 
> 赞同：4
> 
> 时间：2012-07-16T23:05:17.690
> 
> 标签：python, namespaces

好的，让我们举个例子（下面的原始问题）。

我制作了一个名为“myproject”的包，它显示了我面临的问题。

1.  在此处下载包：[https ://dl.dropbox.com/u/11013311/myproject.zip](https://dl.dropbox.com/u/11013311/myproject.zip)
2.  安装包（例如：sudo python setup.py develop）
3.  打开一个 Ipython 会话并输入：“import myproject”
4.  如果您开始输入“myproject”。并点击两次选项卡以获取可用的方法/值...，您会看到“myproject.myproject”，它自己也显示出同样的问题。

你们中的一个人能够解释我做错了什么吗？*Andrew Alcock*的回答并不能帮助我解决这个问题，或者至少我看不出问题出在哪里。

当然，通过这样一个简单的示例，包`__init__.py`文件不需要那么复杂，但是在我的实际项目中，我确实需要`COOL`通过`myproject.COOL`.

感谢您的回答！

**编辑：**我奖励了*utapyngo*赏金，因为他的解决方案是有效的，而且我学到了更多东西（具有深度子模块的相对导入）。但我要感谢*Andrew*和*nehz*的回答（*nehz*还提供了解决我的问题的解决方案，但主观上我觉得它“不那么漂亮”；*Andrew*提供了有用的建议）。可惜我不能分享赏金。

**

## 原始问题：

**

我不确定我是否正确地表达了这个问题。我创建了一个包含许多子包的大型代码，为简单起见，我们将其称为“代码”。

问题是： 'CODE' 出现在命名空间中，所以我可以拥有`CODE.CODE`or`CODE.CODE.CODE`等​​...无限次，这对我来说看起来很奇怪，并且可能（我猜）暗示有问题（尽管代码运行良好没有警告）。

我猜这个问题与我`__init__.py`和我的代码结构有关，所以我在这里提供更多信息。

简化的代码结构：

```
CODE
  | __init__.py
  | tools
     | __init__.py
     | mytools.py
  | other
     | __init__.py
     | init.py
  | sub
     | __init__.py
     | module.py 
```

文件：（`__init__.py`第一个，在根目录`CODE`）

```
import CODE.tools.mytools as MyTools
import CODE.other.init

OBJ = CODE.other.init.function()
... 
```

该文件`mytools.py`不`OBJ`从 CODE 或任何其他可能导入的模块导入`OBJ`。 `init.py`可以导入模块，例如`mytools.py`. 最后，类似的模块`module.py`可以导入`mytools.py`或`OBJ`（从 CODE）。通常，所有导入都是使用绝对导入进行的，例如 in: `from CODE.sub.module import func`。

有人对这种行为有解释吗？我没有找到关于 SO 的任何相关问题，但这可能是由于我的措辞错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:25:25.667

问题是您导入的*包*（基本上是顶级 __init__.py 文件）在其他导入中包含对自身（*模块）的引用。*由于模块现在有一个包含自身的名称空间，因此您现在可以以 CODE.CODE 的形式访问它。... .CODE.MyTools。

我会建议：

1）在每个子包（工具，其他）中都有一个 __init__.py

2) 在 CODE 的模块中，不要“导入 CODE”或任何子包。而是直接导入您感兴趣的模块（文件）。

例如，在 CODE.sub.module.py 中：

不要：

```
import CODE.other     # "other" is a package (a directory) 
```

做：

```
import CODE.other.init    # "init" is a module (a file) 
```

理智就是这样。

编辑：重新构建您的具体示例

> 文件 mytools.py 不会从 CODE 或任何其他可能导入 OBJ 的模块中导入 OBJ。init.py 可以导入 mytools.py 等模块。

好的

> 最后，像 module.py 这样的模块可以导入 mytools.py 或 OBJ（来自 CODE）。

这是你的问题。不要在此处导入 CODE。如果您需要简化相当长的“CODE.other.init.function”，您可以使用 from .. import 语句来完成：

```
> from CODE.other.init import function as OBJ 
```

但是请注意，许多 Pythonite 不喜欢这个，因为它会导致混乱。

> 通常，所有的导入都是用绝对导入进行的，例如：from CODE.sub.module import func。

好的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T03:45:24.230

使用绝对导入后只需删除引用：

```
import atexit

import myproject.mymodule_one.suby as SubY
obj = SubY.myclass()
import myproject.mymodule_two.initialization

COOL = myproject.mymodule_two.initialization.create_cool()
del myproject 
```

编辑：仅供参考，删除引用不会卸载模块，并且 COOL 中的实例仍然有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T12:02:34.820

在您的主目录`__init__.py`中，您不必甚至不应该引用您的模块名称（谁知道，您将来可能想要重命名它）。

只需更换

```
import myproject.mymodule_... 
```

和

```
import mymodule_... 
```

现在没有`myproject.myproject`：

```
>>> dir(myproject)
['COOL', 'SubY', '__builtins__', '__doc__', '__file__', '__name__', '__package__',
 '__path__', '__version__', 'atexit', 'exit_report', 'mymodule_one', 'mymodule_two',
 'obj', 'toto'] 
```

# vba - 如何代表代理人在 Outlook 中发送电子邮件？

> ID：11513869
> 
> 赞同：2
> 
> 时间：2012-07-16T23:05:28.377
> 
> 标签：vba, ms-access, outlook, ms-access-2007, outlook-2007

我正在编写一个 VBA 脚本，它将向我们的客户发送电子邮件。我以前做过类似的系统，但这里的不同之处在于这些电子邮件将使用通用的 From 字段（因此收件人只能看到我们公司的名称，而不是发送它的个人）。这很容易手动完成。

目前，我正在使用带有通用[示例](http://msdn.microsoft.com/en-us/library/ff869311.aspx)的 SendUsingAccount 。但我不知道如何使用该代码，因为它本身不是这台机器上的实际帐户。我只有代理访问它。

那么，有人可以告诉我如何使用 VBA 代表其他人发送电子邮件吗？

（或者，我确实有该帐户的用户名和密码。因此，如果我需要登录该帐户来发送电子邮件，我也可以这样做）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:13:20.043

查看[MailItem.SentOnBehalfOfName 属性](http://msdn.microsoft.com/en-us/library/bb206695%28v=office.12%29.aspx)。您应该有权访问您要代表其发送的邮箱/配置文件。

## 例子：

```
Sub SendEmailOnBehalf()
  Dim msg As Outlook.MailItem

  Set msg = Outlook.CreateItem(olMailItem)
  With msg
    .SentOnBehalfOfName = "Jimmy's boss' name"
    .Subject = "Email from someone else"
    .Body = "Hello" & vbNewLine 
  End With
End Sub 
```

电子邮件会`From Jimmy Pena on behalf of Jimmy's Boss`在`From:`现场说。

# javascript - 更改切换 jquery 顶部的文本

> ID：11513872
> 
> 赞同：2
> 
> 时间：2012-07-16T23:05:59.307
> 
> 标签：javascript, jquery, html

我有一堆这样的，当用户单击最大化 div 时会展开以显示内容。内容向下切换后，底部的最小化链接可见。单击该链接时，它将正确切换，我只是在寻找一种更改第一个链接中的文本的方法，因为当前 jQuery 仅更改单击的链接的文本。有没有办法轻松做到这一点？有什么东西使用`Parent()`然后`Child()`重新回到顶级表中`a`？

切换时，它应该**同时** `#bridge`更改为 be`+ Expand`或`- Minimize`分别。

javascript

```
<script type="text/JavaScript" language="javascript">
    $(document).ready(function() {
        $(".expand").click(function(e) {
            e.preventDefault();
            var toggle = $(this).attr('href');

            var txt = $(this).text() == '+ Expand' ? '- Minimize' : '+ Expand';
            $(this).text(txt);
            $(toggle).slideToggle('fast', function() {                

            });

        });
    });
</script> 
```

HTML

```
<!--Drop Down -->
    <div>
        <b class='bdrround'>
        <b class='bdrround1'><b></b></b>
        <b class='bdrround2'><b></b></b>
        <b class='bdrround3'></b>
        <b class='bdrround4'></b>
        <b class='bdrround5'></b></b>
        <div class='bdrroundfg'>
            <table width='100%' class='pagehead'>
                <tr>
                    <td width='80%' class='pagehead'>
                    <h2><a name='bureau'></a>Approved Bridging Statements (Optional):</h2>
                </td>
                <td width='20%' class='pagehead'>                    
                        <p align='right'><a href='#bridge' id="expand" class='expand'>+ Expand</a></p>                           
                </td>
                </tr>
             </table>
            <div id='bridge' class='faqcontainer' style='display:none;'>
                <p>
                    <b>Operational Direction: </b>These should be used to bring the customer back into the conversation and 
                    to transition into FAQs, Resolving Objections and overall general conversational flow.  
                    These statements are designed to let the customer know that we are listening, that his/her opinion is 
                    important and that we realize the value of that opinion.
                </p>
                <p>
                    <b>BRIDGING STATEMENTS:</b>
                    <ul>
                        <li>Now with that in mind &hellip;</li>
                        <li>That's an excellent question&hellip;</li>
                        <li>I hear what you are saying and&hellip;</li>
                        <li>I can (certainly) understand that and&hellip;</li>
                        <li>That's a very good point&hellip;</li>
                        <li>Please keep in mind&hellip;</li>
                        <li>I can understand your hesitation, but&hellip;</li>
                        <li>I can appreciate that&hellip;</li>
                        <li>Thank you </li>
                        <li>Perfect </li>
                        <li>Great </li>
                        <li>One moment please </li>
                        <li>Excellent</li>
                        <li>That’s great, now&hellip;</li>
                        <li>That’s correct</li>
                        <li>Let me clarify that for you</li>
                    </ul>
                    <span class="note">Note to Rep: </span>Use of Mr. or Ms. can be added throughout the call as appropriate 
                        to help build rapport with the customer.
                </p>
                <p>
                    <span class="note">[Note to Rep: Ensure all service needs are satisfied before offering.]</span>
                </p>
                <p>
                    [<span class="note">Directional:</span> If during the servicing of the call the customer mentioned 
                    they were retired, unemployed, or working less than 30 hours per week, go to: 
                    <a href="#">PS Basic Counter Offer Transition</a>]
                </p>
                <p align='right'><a href="#bridge" id="A2" class='expand'>- Minimize</a></p>
            </div>
            <b class='bdrround'>
            <b class='bdrround5'></b>
            <b class='bdrround4'></b>
            <b class='bdrround3'></b>
            <b class='bdrround2'><b></b></b>
            <b class='bdrround1'><b></b></b></b>
        </div>
        <div class='hrSectDiv'></div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T05:52:29.017

不要使用`#some-id`href 来切换你的元素，而是放入一个可重用`var`的*全按钮的 common parent*。

## *[jsBin 演示](http://jsbin.com/exudod/2/edit#javascript,html,live)*

1.  `.slide_content`向所有可滑动元素 ( )添加一个类`.faqcontainer`（或者只使用`.faqcontainer`而不是提到的，我不确定它是否是一个通用类）

2.  完成后，我们必须找到共同的**父元素**： - 按钮和 - 一个可滑动的内容使用`.closest()`......太好了！你有一个！是`<div class='bdrroundfg'>` *！！！*
    让我们在 var 中使用他：`var common_parent = $(this).closest('.bdrroundfg');`

现在我们只需要让 jQ 检索那个元素——他的子按钮和他的可滑动内容：

```
 var slide_content = common_parent.find('.slide_content'); // the added class!
    var all_buttons   = common_parent.find('a.expand');       // both buttons 
```

单击时，我们需要切换第一个 ( `.eq(0)`) 按钮的文本

```
 var txt = $(this).text() === '+ Expand' ? '- Minimize' : '+ Expand';
     all_buttons.eq(0).text(txt); // target only the first one in the collection 
```

**您的代码应如下所示：**

```
 $(".expand").click(function(e) {
     e.preventDefault();
     var common_parent = $(this).closest('.bdrroundfg');
     var slide_content = common_parent.find('.slide_content'); // the added class!
     var all_buttons   = common_parent.find('a.expand');   

     var txt = $(this).text() === '+ Expand' ? '- Minimize' : '+ Expand';
     all_buttons.eq(0).text(txt);    // toggle text - first button only!     

     $(slide_content).slideToggle('fast', function(){
          // do something here...
     });

 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:23:59.147

尝试这个：

```
 if (this.id == 'A2') {
     $('#expand').text("+ Expand")
 } 
```

[演示](http://jsfiddle.net/CRUD8/)

# gcc - ICC 库搜索选项

> ID：11513875
> 
> 赞同：0
> 
> 时间：2012-07-16T23:06:15.787
> 
> 标签：gcc, static-libraries, intel, icc

GNU 编译器使用`-llib`选项来链接库，是否有类似的东西`icpc`？
（我已经指定了 -L 选项以在搜索路径中添加我的库）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T17:49:53.100

`icpc`，或据我所知的任何其他编译器，使用相同的选项来链接库，所以也可以使用`-llib`with`icpc`

# eclipse - 可以使 Eclipse 的“JPA 详细信息”视图的查询文本框更大吗？

> ID：11513876
> 
> 赞同：0
> 
> 时间：2012-07-16T23:06:16.677
> 
> 标签：eclipse, jpa, jpql, dali

我花了很长时间才弄清楚如何让 JPQL 自动完成以在 Eclipse 中工作。我可以看到发生的唯一地方是将 <mapping-file> 添加到我的 persistence.xml 并在映射 .xml 文件中我可以定义一个 <named-query> 。然后，如果我添加“JPA 详细信息”视图并选择要编辑的查询，我会得到一个很小的 ​​4 行文本框，我必须在其中编辑我的查询。只有在这个小文本框中，我才能获得内容帮助。

A）有没有办法让这个文本框变大？（我的查询很复杂，我需要更多的行）

B) 还有其他更大的地方可以获得 JPQL 内容协助吗？

（我在 Indigo 3.7 和 Juno 4.2 中有同样的问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T12:48:57.733

内容助手也可以通过 @NamedQuery 注解获得。如果您将配置存储在 XML 文件中或在 Entity 类上使用注释没有区别，那么您可以利用后者。一旦您开始编辑 @NamedQuery 的“查询”元素，就可以使用与 JPA 详细信息/查询中相同的内容助手。它给你足够的空间；但是，由于它是在 Java 代码中定义的 String 常量，因此在查询拆分为多行的情况下，您必须处理额外的引号和连接。同时，您将能够在 JPA 详细信息视图中查看此查询。

至于 JPA Details 视图，我怀疑这个 Query 编辑框是否可配置，除非修改插件源并重新构建。

**编辑**回应评论（3），-这是一个“方向”：

*   JPA 详细信息视图以及在 org.eclipse.jpt.jpa.ui 插件中定义的面板/窗格
*   命名查询编辑视图在类中定义，`NamedQueryPropertyComposite`并`NamedQueryProperty2_0Composite`相应地用于 JPA v1 和 JPA v2。
*   将命名查询编辑器框调整为 4 行的代码片段如下所示：

    ```
    adjustMultiLineTextLayout(
        4,
        provider.getStyledText(),
        provider.getStyledText().getLineHeight()
    ); 
    ```

.. 其中 4 是行数。

可以在此处找到源代码：:pserver:anonymous@dev.eclipse.org:/cvsroot/webtools（不确定它们针对的是哪个特定的 Eclipse 版本，但这绝对比 Indigo 附带的版本更新）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T17:35:32.850

我已经针对 Dali Eclipse 项目输入了一个错误，以使该文本区域更大并扩展它。一旦修复，就不需要破解。

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=386416](https://bugs.eclipse.org/bugs/show_bug.cgi?id=386416)

作为对评论 (4) 的回应 - 请针对您在复杂查询中看到的特定验证错误输入针对 Dali 的错误。如果它们是符合规范的 JPQL 查询，我们肯定要修复它们。如果它们包含任何特定于休眠的内容，则休眠工具扩展将负责该验证。

# c++ - 具有变量且参数 数量未知的 c++ 函数

> ID：11513885
> 
> 赞同：1
> 
> 时间：2012-07-16T23:07:11.357
> 
> 标签：c++, function

> **可能重复：**
> [C++ 中的参数数量可变？](https://stackoverflow.com/questions/1657883/variable-number-of-arguments-in-c)

我可以不设置具有可变参数数量的函数的参数数量吗？举个例子：下面的接口可以实现吗？

```
int sum(...) { ... }

sum(1, 2, 3, 4); // return 10 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:07:30.983

传统的[可变参数函数](https://en.wikipedia.org/wiki/Variadic_function)很杂乱并且不是类型安全的，但是在[C++11中，您可以使用](https://en.wikipedia.org/wiki/C%2B%2B11)[可变参数模板](https://en.wikipedia.org/wiki/Variadic_template)和（编译时）递归干净地做到这一点：

```
// Base case for recursion
template <typename T>
inline T sum(T n) {
  return n;
}

// Recursive case
template <typename T, typename... Args>
inline T sum(T n, Args... args) {
  return n + sum(args...);
} 
```

由于它是一个模板，这将适用于任何已`operator+`定义的类型：

```
std::cout << sum(1, 2, 3) << std::endl;  // Prints 6
std::cout << sum(3.14, 2.72) << std::endl;  // Prints 5.86 
```

但是，由于递归模板函数的返回类型仅取自第一个参数，如果在一次调用中混合不同的参数类型，您会得到令人惊讶的结果： `sum(2.5, 2)`按预期返回 4.5，但`sum(2, 2.5)`返回 2 因为返回类型是`int`，而不是`double`。如果您想花哨，可以使用新的[替代函数语法](https://en.wikipedia.org/wiki/C%2B%2B11#Alternative_function_syntax)来指定返回类型是自然类型的任何类型`n + sum(args...)`：

```
// Recursive case
template <typename T, typename... Args>
inline auto sum(T n, Args... args) -> decltype(n + sum(args...)) {
  return n + sum(args...);
} 
```

现在`sum(2.5, 2)`，`sum(2, 2.5)`两者都返回 4.5。

如果您的实际逻辑比求和更复杂，并且您不希望它内联，您可以使用内联模板函数将所有值放入某种容器（例如 a`std::vector`或`std::array`）并将其传递给非内联函数在最后做真正的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:21:58.493

您可能希望通过编写函数来获取类似 a 的`vector<int>`内容，您将使用花括号初始值设定项列表即时构建它：

```
int sum(std::vector<int> const &n) { 
    return std::accumulate(begin(n), end(n), 0);
} 
```

如果有可能数字可能是（例如）浮点数，您可能希望将其编写为模板：

```
template <class T>
T sum(std::vector<T> const &n) { 
   return std::accumulate(begin(n), end(n), T());
} 
```

无论哪种方式，您都会稍微不同地调用它：

```
int x = sum({1,2,3,4}); 
```

警告：这个特性是最近才添加到 C++ 中的，所以一些编译器（例如，VC++）还不支持它——尽管其他编译器（例如，g++ 4.7+）支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:13:39.807

不，你不能。

只是不要使用可变参数。他们吸收了所有可以想象的时尚，完全不值得任何人花时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:13:52.553

C++ 可变参数函数必须知道它传递了多少（以及什么类型）的参数。例如，printf 的格式字符串告诉它期望什么额外的参数。

您`sum`无法知道它是 4 个整数还是 10 个整数。您可以将第一个参数设为长度：

```
int sum(int howmany, ...) { ... } 
```

所以函数知道后面有多少个整数。但实际上你应该只传递一个数组（或向量，如果你感觉 C++'y）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T23:14:36.267

有多种方法可以解决您的问题。我会介绍几个：

方法一： - 创建一系列重载求和函数以满足您的需要。

缺点代码膨胀

这可以通过使用标头制作多个函数来实现：

```
int sum(int a);
int sum(int a, int b);
int sum(int a, int b, int c); 
```

ETC...

方法2：-创建一个带有链表的自定义类，并传入一个指向链表头部的指针。在这种情况下，这可能是您最好的举措，假设您不知道要传入的数据量。

函数头：

```
int sum(LinkedList *headPointer); 
```

方法3：-传入一个变量数组

函数头：

```
int sum(int input[]); 
```

方法4：-创建一个带有自动设置变量的函数

函数头：

```
int sum(int a=0, int b=0, int c=0, int d=0,... int n=0); 
```

# actionscript-3 - AS3：使用 E4X 双冒号运算符，命名空间存储在对象中

> ID：11513886
> 
> 赞同：0
> 
> 时间：2012-07-16T23:07:19.570
> 
> 标签：actionscript-3, xml-namespaces, e4x

给定以下示例 XML（这里我显示的是硬编码，但通常我从外部文件加载）：

```
var myXML:XML = new XML('
    <xmlout xmlns:ns1="http://some.namespace.com/ns1" xmlns:ns2="http://some.namespace.com/ns2" xmlns:ns3="http://some.namespace.com/ns3">
        <data>
            <item>
                <ns1:id>some_id</ns1:id>
            </item>
        </data>
    </xmlout>'); 
```

我将命名空间作为命名空间对象存储在一个对象中，例如：

```
var xmlNamespaces:Object = {};

for (var i:uint = 0; i < myXML.namespaceDeclarations().length; i++) {
    var ns:Namespace = myXML.namespaceDeclarations()[i]; 
    xmlNamespaces[ns.prefix] = new Namespace(ns.prefix, ns.uri);
} 
```

我正在尝试做类似的事情：

```
trace(myXML.data.item.xmlNamespaces["ns1"]::id.value); 
```

知道这是否可能吗？我没有任何成功。谢谢！

编辑：我应该注意我可以做到这一点，没有问题，使用：

```
default xml namespace = xmlNamespaces.ns1;
var id:String = myXML.data.item.id; 
```

我特别想弄清楚如何消除每次都必须设置默认命名空间......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T00:57:23.530

抱歉，我花了这么长时间才回复你，因为我相信你昨天可能需要它。
我今天在路上走了 8 个小时。
编写内联 XML`requires`使用单个`root node`来定义 XML 文档的正文。
您的第一个问题是您用单引号包裹了所有内容。取出来参数不是字符串。
如上所述，您的其他问题需要用根标签包装。
这段代码在 flash cs4 中编译得很好，如果你仍然不能让它工作，请告诉我。
请注意，在下面的代码中，我从不引用根节点。

```
var myXML:XML = new XML(
    <root>
        <xmlout xmlns:ns1="http://some.namespace.com/ns1" xmlns:ns2="http://some.namespace.com/ns2" xmlns:ns3="http://some.namespace.com/ns3">
            <data>
                <item>
                    <ns1:id>some_id</ns1:id>
                </item>
            </data>
        </xmlout>
    </root>);

var xmlNamespaces:Object = {};

for (var i:uint = 0; i < myXML.xmlout.namespaceDeclarations().length; i++) {
    var ns:Namespace = myXML.xmlout.namespaceDeclarations()[i]; 
    trace(ns.prefix + ' ' + ns.uri)
    xmlNamespaces[ns.prefix] = new Namespace(ns.prefix, ns.uri);
}
// output is 
// ns1 http://some.namespace.com/ns1
// ns2 http://some.namespace.com/ns2
// ns3 http://some.namespace.com/ns3 
```

# mysql - phpMyAdmin 不会停止抛出“#1130 - Host 'localhost' is not allowed to connect to this MySQL server”

> ID：11513888
> 
> 赞同：3
> 
> 时间：2012-07-16T23:07:52.557
> 
> 标签：mysql, database, phpmyadmin, privileges

我正在尝试进入`http://localhost/phpmyadmin/index.php`，但我不断收到：

```
Error
MySQL said: 

#1130 - Host 'localhost' is not allowed to connect to this MySQL server 
Connection for controluser as defined in your configuration failed.
phpMyAdmin tried to connect to the MySQL server, and the server rejected the connection. You should check the host, username and password in your configuration and make sure that they correspond to the information given by the administrator of the MySQL server. 
```

我已经尝试过[这里](http://www.linuxquestions.org/questions/linux-software-2/lost-root-access-in-mysql-486785/)、[这里](https://stackoverflow.com/questions/1878458/1130-host-localhost-is-not-allowed-to-connect-to-this-mysql-server)、[这里](https://stackoverflow.com/questions/1878458/1130-host-localhost-is-not-allowed-to-connect-to-this-mysql-server)以及[最后但并非最不重要的内容——这里](https://stackoverflow.com/questions/5885410/how-can-i-run-with-rootlocalhost-privileges-in-mysql)，但是没有任何效果。

我该如何解决这个烦人的消息？

最好的祝福

**编辑：**

从我`run`打到`cmd``C:\Users\internet>"C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql.exe" "--def aults-file=C:\ProgramData\MySQL\MySQL Server 5.5\my.ini" "-uroot" "--host=127.0. 0.1" "-p"`

然后我在：

```
C:\Users\internet>"C:\Program Files\MySQL\MySQL Server 5.5\bin\mysql.exe" "--def
aults-file=C:\ProgramData\MySQL\MySQL Server 5.5\my.ini" "-uroot" "--host=127.0.
0.1"  "-p"
Enter password: *******
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 23
Server version: 5.5.25 MySQL Community Server (GPL)

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

进而 ：

```
mysql> GRANT ALL on *.* to 'root'@'127.0.0.1' identified by '$roots_password' WI
TH GRANT OPTION;
Query OK, 0 rows affected (0.00 sec) 
```

但还是一无所获。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T08:35:21.207

改成`127.0.0.1`这样`localhost`：

```
mysql> GRANT ALL on *.* to 'root'@'localhost' identified by '$roots_password' WITH GRANT OPTION; 
```

由于缺少的主机 is`localhost`和 not `127.0.0.1`。

# c# - 将 Web 应用程序转换为网站

> ID：11513891
> 
> 赞同：4
> 
> 时间：2012-07-16T23:08:18.530
> 
> 标签：c#, asp.net, visual-studio-2010, web-site-project, web-application-project

我有 ac# .net VS2010 Web 应用程序，它只包含经典的 asp 文件。

我想做的是将 Web 应用程序转换为网站，以便更轻松地管理经典的 asp 文件。

如何从 Web 应用程序转换为网站？我研究了谷歌，发现了很多相反的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:51:24.793

我认为没有一种自动化的方法可以做到这一点。您可以在 Visual Studio 中创建一个新网站，然后将您的文件从 Web 应用程序复制到这个新网站中。确保进入每个 .aspx/.ascx 文件并编辑“代码隐藏”属性，使其读取“代码文件”（代码隐藏指令需要编译，因此在 ASP.NET 网站中不起作用）。您还需要删除 Designer/Designer.cs 文件。

希望你没有太多的文件，这样就不会成为太多的 PITA。

# r - r中的数据重组

> ID：11513895
> 
> 赞同：1
> 
> 时间：2012-07-16T23:08:35.700
> 
> 标签：r, dataframe, reorganize

我有以下类型的数据：

```
Person <- c("A", "B", "C", "AB", "BC", "AC",  "D", "E")
Father <- c(NA,  NA,  NA,   "A", "B", "C",    NA, "D")
Mother <- c(NA,  NA,  NA, "B",   "C", "A", "C",    NA)
var1 <- c(  1,   2,   3,     4,   2,   1,     6, 9)
var2 <- c(1.4, 2.3, 4.3,  3.4, 4.2, 6.1,   2.6, 8.2)
myd <- data.frame (Person, Father, Mother, var1, var2)

 Person Father Mother var1 var2
1      A   <NA>   <NA>    1  1.4
2      B   <NA>   <NA>    2  2.3
3      C   <NA>   <NA>    3  4.3
4     AB      A      B    4  3.4
5     BC      B      C    2  4.2
6     AC      C      A    1  6.1
7      D   <NA>      C    6  2.6
8      E      D   <NA>    9  8.2 
```

这是失踪（未知）。我想将数据重新组织成三人组（个人及其父亲和母亲）。例如，AB 个人的 trio 将包括来自其父亲 A 和母亲 B 的数据。

```
 Person Father Mother var1 var2
1      A   <NA>   <NA>    1  1.4
2      B   <NA>   <NA>    2  2.3
4     AB      A      B    4  3.4 
```

A、B、C 不能组成三人组，因为他们没有父母。在某些情况下，E 只有一个已知的父母父亲是 D。在这种情况下，三人组中只有两个成员。

```
 7      D   <NA>      C    6  2.6
  3      C   <NA>   <NA>    3  4.3 
```

如果母亲和父亲在两个三重奏中重复，则将回收相同的值。

因此预期的完整输出将是：

```
 Person Father Mother var1 var2  Trio 
1      A   <NA>   <NA>    1  1.4     1
2      B   <NA>   <NA>    2  2.3     1
4     AB      A      B    4  3.4     1

2      B   <NA>   <NA>    2  2.3     2
3      C   <NA>   <NA>    3  4.3     2
5     BC      B      C    2  4.2     2

1      A   <NA>   <NA>    1  1.4     3
3      C   <NA>   <NA>    3  4.3     3
6     AC      C      A    1  6.1     3

NA       <NA> <NA>    <NA>  NA  NA     4
3      C   <NA>   <NA>    3  4.3      4
7      D   <NA>      C    6  2.6      4

NA       <NA> <NA>    <NA>  NA  NA     5
7      D   <NA>      C      6  2.6     5
8      E      D   <NA>      9  8.2     5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:42:36.760

这大概是你想要的

```
Person <- c("A", "B", "C", "AB", "BC", "AC",  "D", "E")
Father <- c(NA,  NA,  NA,   "A", "B", "C",    NA, "D")
Mother <- c(NA,  NA,  NA, "B",   "C", "A", "C",    NA)
var1 <- c(  1,   2,   3,     4,   2,   1,     6, 9)
var2 <- c(1.4, 2.3, 4.3,  3.4, 4.2, 6.1,   2.6, 8.2)
myd <- data.frame (Person, Father, Mother, var1, var2,stringsAsFactors=F) 
```

请注意使用 myd 的定义略有变化`stringsAsFactors=F`

```
parentage<-function(x,myd){
    y<-myd[x,]
    p1<-as.character(y['Father'])
    p2<-as.character(y['Mother'])
    out<-y
    if(!is.na(p1)){
        out<-rbind(out,myd[myd$Person==p1,])
    }
    if(!is.na(p2)){
        out<-rbind(out,myd[myd$Person==p2,])
    }
    out$Trio=x
    out
}

ans<-lapply(seq_along(myd$Person),parentage,myd)

 > ans
[[1]]
  Person Father Mother var1 var2 Trio
1      A   <NA>   <NA>    1  1.4    1

[[2]]
  Person Father Mother var1 var2 Trio
2      B   <NA>   <NA>    2  2.3    2

[[3]]
  Person Father Mother var1 var2 Trio
3      C   <NA>   <NA>    3  4.3    3

[[4]]
   Person Father Mother var1 var2 Trio
4      AB      A      B    4  3.4    4
2       A   <NA>   <NA>    1  1.4    4
21      B   <NA>   <NA>    2  2.3    4

[[5]]
  Person Father Mother var1 var2 Trio
5     BC      B      C    2  4.2    5
2      B   <NA>   <NA>    2  2.3    5
3      C   <NA>   <NA>    3  4.3    5

[[6]]
   Person Father Mother var1 var2 Trio
6      AC      C      A    1  6.1    6
3       C   <NA>   <NA>    3  4.3    6
31      A   <NA>   <NA>    1  1.4    6

[[7]]
  Person Father Mother var1 var2 Trio
7      D   <NA>      C    6  2.6    7
3      C   <NA>   <NA>    3  4.3    7

[[8]]
  Person Father Mother var1 var2 Trio
8      E      D   <NA>    9  8.2    8
7      D   <NA>      C    6  2.6    8 
```

如果你想要一个数据框，你可以使用这个`plyr`包

```
library(plyr)
ans<-adply(seq_along(myd$Person),1,parentage,myd) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:42:00.683

我会将您的问题表示为一个[图](http://en.wikipedia.org/wiki/Graph_%28mathematics%29)，然后设计一个图遍历算法来收集您正在寻找的所有三重奏。

例如，在这里，您的问题中有一个三重奏的子集：

```
A    B    C
 \  / \  /
  vv   vv
  AB   BC 
```

您可以从没有任何边的顶点开始（AB 和 BC），并与它们的父节点创建一个三重奏。然后搬到他们的父母那里并重复这个过程。您将需要一种方法来跟踪您已经访问过哪些顶点（人），以避免多次探索相同的顶点。

R 有几个使用图表的包。例如，您可以查看[igraph](http://cran.r-project.org/web/packages/igraph/index.html)。

# android - Android - 无法打开 [SQL] 数据库错误

> ID：11513896
> 
> 赞同：1
> 
> 时间：2012-07-16T23:08:35.130
> 
> 标签：android, database, sqlite

我目前正在为 Android SDK 制作一个应用程序，它允许我打开/复制已经在应用程序之外创建的数据库。我无法让我的程序读取数据库中的表。根据我之前发布的一个[问题](https://stackoverflow.com/questions/11510354/android-cant-find-table-in-pre-made-database)的一些建议，我编写了一个类，它可以直接调用 SQLiteDatabase 并在 Android SDK 附带的 sqlite3 版本中创建我的数据库。现在，由于某种原因，我的程序甚至无法打开数据库。它似乎认识到它在那里，但是 Logcat（我正在使用带有 ADT 插件的 Eclipse Juno）现在一直告诉我它“无法打开数据库”。有谁知道可能是什么问题？

这是我的所有代码（为了彻底）：

```
public class MyDatabase
{
private static final String TABLE_OS = "OregonState";
private static final String COLUMN_ID = "_id";
private static final String COLUMN_NAME = "Name";
private static final String COLUMN_FIELD = "Field";

SQLiteDatabase database;
String path;

public MyDatabase()
{
        File file = new File("/scratch/android-sdk-linux/tools/os.sqlite");
        database = SQLiteDatabase.openOrCreateDatabase(file, null);
        path = database.getPath();
        database.close();
}

public long insert(ContentValues values, String name, String field)
{
    database = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    values.put("Name", name);
    values.put("Field", field);
    long id = database.insert(TABLE_OS, null, values);
    database.close();
    return id;
}

public long insert(ContentValues values, String name)
{
    database = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    values.put("Name", name);
    long id = database.insert(TABLE_OS, null, values);
    database.close();
    return id;
}

public int delete(int id)
{
    database = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    database.delete(TABLE_OS, COLUMN_ID + "=" + id, null);
    database.close();
    return 1;
}

public int update(ContentValues values, int id, String name, String field)
{
    database = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    values.put("Name", name);
    values.put("Field", field);
    database.update(TABLE_OS, values, COLUMN_ID + "=" + id, null);
    database.close();
    return 1;
}

public int update(ContentValues values, int id, String name)
{
    database = SQLiteDatabase.openDatabase(path, null, SQLiteDatabase.OPEN_READWRITE);
    values.put("Name", name);
    database.update(TABLE_OS, values, COLUMN_ID + "=" + id, null);
    database.close();
    return 1;
}

public Cursor get(int id)
{
    return database.query(TABLE_OS, new String[] {COLUMN_ID, COLUMN_NAME, COLUMN_FIELD}, COLUMN_ID + "=" + id, null, null, null, null);
}

public Cursor getAll()
{
    return database.query(TABLE_OS, new String[] {COLUMN_ID, COLUMN_NAME, COLUMN_FIELD}, null, null, null, null, null);
}
}

public class SQLTest extends Activity
{
SQLAdapter adapter;
MyDatabase database;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_sqltest);
    database = new MyDatabase();
    database.getAll();
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    getMenuInflater().inflate(R.menu.activity_sqltest, menu);
    return true;
} 

public long insert(String name, String field)
{
    ContentValues values = new ContentValues();
    long id = database.insert(values, name, field);
    return id;
}

public long insert(String name)
{
    ContentValues values = new ContentValues();
    long id = database.insert(values, name);
    return id;
}

public int delete(int id)
{
    int rowsDeleted = database.delete(id);
    return rowsDeleted;
}

public int update(int id, String name, String field)
{
    ContentValues values = new ContentValues();
    int rowsUpdated = database.update(values, id, name, field);
    return rowsUpdated;
}

public int update(int id, String name)
{
    ContentValues values = new ContentValues();
    int rowsUpdated = database.update(values, id, name);
    return rowsUpdated;
}

public void get(int id)
{
    Cursor cursor = database.get(id);
    TextView tv = new TextView(this);
    String table = "";
    if (cursor.moveToFirst())
        table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
    else
        table += "No hall found with ID: " + id;
    tv.setText(table);
    setContentView(tv);
    cursor.close();
}

public void getAll()
{
    TextView tv = new TextView(this);
    String table = "";
    try
    {
        Cursor cursor = database.getAll();
        if (cursor.moveToFirst())
        {
            do
            {
                table += "\n" + cursor.getString(0) + " " + cursor.getString(1) + " " + cursor.getString(2);
            } while (cursor.moveToNext());
        }
        cursor.close();
    } catch (Exception e) {}
    tv.setText(table);
    setContentView(tv);
}
} 
```

这也是我的 Logcat 日志：

```
07-16 15:27:08.364: E/Trace(810): error opening trace file: No such file or directory (2)
07-16 15:27:08.504: E/SQLiteLog(810): (14) cannot open file at line 30174 of [00bb9c9ce4]
07-16 15:27:08.504: E/SQLiteLog(810): (14) os_unix.c:30174: (2) open(/scratch/android-sdk-linux/tools/os.sqlite) - 
07-16 15:27:08.524: E/SQLiteDatabase(810): Failed to open database '/scratch/android-sdk-linux/tools/os.sqlite'.
07-16 15:27:08.524: E/SQLiteDatabase(810): android.database.sqlite.SQLiteCantOpenDatabaseException: unknown error (code 14): Could not open database
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnection.nativeOpen(Native Method)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:209)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:193)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnectionPool.openConnectionLocked(SQLiteConnectionPool.java:463)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:185)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:177)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteDatabase.openInner(SQLiteDatabase.java:804)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteDatabase.open(SQLiteDatabase.java:789)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:694)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:709)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:702)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at com.example.sql2.MyDatabase.<init>(MyDatabase.java:26)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at com.example.sql2.SQLTest.onCreate(SQLTest.java:20)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.Activity.performCreate(Activity.java:5008)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.os.Looper.loop(Looper.java:137)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at android.app.ActivityThread.main(ActivityThread.java:4745)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at java.lang.reflect.Method.invokeNative(Native Method)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at java.lang.reflect.Method.invoke(Method.java:511)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
07-16 15:27:08.524: E/SQLiteDatabase(810):  at dalvik.system.NativeStart.main(Native Method)
07-16 15:27:08.524: D/AndroidRuntime(810): Shutting down VM
07-16 15:27:08.524: W/dalvikvm(810): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
07-16 15:27:08.534: E/AndroidRuntime(810): FATAL EXCEPTION: main
07-16 15:27:08.534: E/AndroidRuntime(810): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.sql2/com.example.sql2.SQLTest}: android.database.sqlite.SQLiteCantOpenDatabaseException: unknown error (code 14): Could not open database
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
07-16 15:27:08.534: E/AndroidRuntime(810):  at   android.app.ActivityThread.access$600(ActivityThread.java:130)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.os.Looper.loop(Looper.java:137)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.ActivityThread.main(ActivityThread.java:4745)
07-16 15:27:08.534: E/AndroidRuntime(810):  at java.lang.reflect.Method.invokeNative(Native Method)
07-16 15:27:08.534: E/AndroidRuntime(810):  at java.lang.reflect.Method.invoke(Method.java:511)
07-16 15:27:08.534: E/AndroidRuntime(810):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
07-16 15:27:08.534: E/AndroidRuntime(810):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
07-16 15:27:08.534: E/AndroidRuntime(810):  at dalvik.system.NativeStart.main(Native Method)
07-16 15:27:08.534: E/AndroidRuntime(810): Caused by: android.database.sqlite.SQLiteCantOpenDatabaseException: unknown error (code 14): Could not open database
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteConnection.nativeOpen(Native Method)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:209)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteConnection.open(SQLiteConnection.java:193)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteConnectionPool.openConnectionLocked(SQLiteConnectionPool.java:463)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:185)
07-16 15:27:08.534: E/AndroidRuntime(810):  at  android.database.sqlite.SQLiteConnectionPool.open(SQLiteConnectionPool.java:177)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteDatabase.openInner(SQLiteDatabase.java:804)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteDatabase.open(SQLiteDatabase.java:789)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:694)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:709)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:702)
07-16 15:27:08.534: E/AndroidRuntime(810):  at com.example.sql2.MyDatabase.<init>(MyDatabase.java:26)
07-16 15:27:08.534: E/AndroidRuntime(810):  at com.example.sql2.SQLTest.onCreate(SQLTest.java:20)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.Activity.performCreate(Activity.java:5008)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
07-16 15:27:08.534: E/AndroidRuntime(810):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
07-16 15:27:08.534: E/AndroidRuntime(810):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T06:20:29.717

将此权限添加到您的项目

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:49:51.517

Logcat 显示该目录不存在。这并不奇怪，因为在 Android 设备的根目录下通常没有临时目录。

最好避免使用绝对路径名，因为您不能确定它们是否始终存在于您的应用程序可能运行的不同设备上。访问应用程序文件的正确方法是在打开文件时使用[Environment 。](http://developer.android.com/reference/android/os/Environment.html)例如：

```
File file = new File(Environment.getExternalStorageDirectory() + "/scratch/os.sqlite"); 
```

这通常存在于 sdcard 或内部存储器上指定为“sd 卡”的软链接目录中。所以这个例子会在scratch目录下的sdcard上打开一个文件。

如何将数据库文件放到设备或模拟器上取决于您。如果您使用的是模拟器，则可以使用文件资源管理器将文件推送到适当的目录中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-16T23:59:03.557

Android 默认压缩大于 1MB 的文件。旧版本的Android OS有一个bug，导致压缩的资源文件被错误读取。最简单的解决方法是使用资源文件扩展名，例如“.mp3”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:16:00.400

据我所知，Android 文件系统中没有“scratch”目录。你打电话时

```
File file = new File("/scratch/android-sdk-linux/tools/os.sqlite");
database = SQLiteDatabase.openOrCreateDatabase(file, null); 
```

我相信第二个语句会抛出一些错误，因为`/scratch/android-sdk-linux/tools/os.sqlite`文件路径不存在。尝试调用`file.mkdirs()`或`file.createNewFile()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T16:58:28.463

我对另一个问题的回答做出了回应，并使用两个单独的类以及适配器和帮助器重写了我的代码，结果证明它工作得很好。我提供了代码的[链接](https://stackoverflow.com/questions/9109438/using-already-created-database-with-android/9109728#9109728)，以防其他人像我一样在开发 SQLiteDatabase 时遇到问题。

# c# - 如何在对话框上自定义图标图像

> ID：11513901
> 
> 赞同：0
> 
> 时间：2012-07-16T23:09:14.477
> 
> 标签：c#, winforms, dialog, showdialog

我使用了一个按钮单击事件来调用对话框，如下所示：

```
private void btnDialog_Click(object sender, EventArgs e)
    {
    DialogResult result = BetterDialog.ShowDialog("Special Dialog", "large heading", "small explanation", null, "Ok", ***null***);
    if (result == DialogResult.OK)
    {
    // Action to perform ...
    }
    } 
```

如何指定给定文件夹中的图标图像以显示在对话框中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:12:49.450

尝试：

```
private void btnDialog_Click(object sender, EventArgs e)
{
   DialogResult result = BetterDialog.ShowDialog("Special Dialog", "large heading", "small explanation", null, "Ok", Image.FromFile(@"fullPath\FileName.ext"));
   if (result == DialogResult.OK)
   {
   // Action to perform ...
   }
} 
```

`BetterDialog`但它会改变对话框内的图像，（如果你想改变对话框标题的图标——我认为不修改代码是不可能的）

# php - 表单不会在 IE9 中发布选择值

> ID：11513902
> 
> 赞同：1
> 
> 时间：2012-07-16T23:09:29.950
> 
> 标签：php, internet-explorer

所有，我有以下页面： [http ://tinyurl.com/7lzr6qo](http://tinyurl.com/7lzr6qo)

原始表单代码为：

```
<form id="dj_feedback" name="dj_feedback" action="../test-save-feedback" method="post">
<br>
<h2>How was the Event?</h2>
<hr>
<table><tr><td width="100px" valign="middle">
<b>Person<font color="#FF0000"> * </font></b>
</td><td valign="middle">
<select name="dj_name" id="dj_name">
<option value="original"></option>
<?php
$qrydj = "Select user_id, first_name, last_name from users where role='employee'";
$resultdj = mysql_query($qrydj);
while($resultsetdj = mysql_fetch_array($resultdj)){
?>
<option value="<?php echo $resultsetdj['user_id']; ?>"><?php echo $resultsetdj['first_name']." ".$resultsetdj['last_name']; ?></option>
<?php
}
?>
</select></td>
</tr>
</table>
<button class="submit" name="submit_feedback" value="submit_feedback">Get Paid!</button>
</form> 
```

当我查看下拉源时，它在 select 上有一个值，然后在我的第二页上，我只有一个简单的 echo 语句来查看传递的内容，如下所示：

```
<?php
session_start();
$user_id = $_POST['dj_name'];

echo "The user id is: ".$user_id;
?> 
```

但是，当我发布此内容时，下拉菜单中选择的值不会被传递。然而，在其他浏览器中，这工作得很好。

有谁知道为什么这不能正常工作？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:40:09.293

您可能需要让 IE 知道按钮元素实际上是在提交表单 - 也许编辑您的按钮：

```
<button type="submit" class="submit" name="submit_feedback" value="submit_feedback">Get Paid!</button> 
```

请注意，类型属性是有效的： [http ://www.w3schools.com/tags/tag_button.asp](http://www.w3schools.com/tags/tag_button.asp)

和 html5： [http ://www.w3schools.com/html5/tag_button.asp](http://www.w3schools.com/html5/tag_button.asp)

# c# - C#：从 WMV 文件中检索视频编解码器信息

> ID：11513904
> 
> 赞同：1
> 
> 时间：2012-07-16T23:09:40.577
> 
> 标签：c#, video, format, codec, wmv

我很难从 WMV 文件中检索视频编解码器信息。我在 C# 中使用 .Net 2.0（我知道它很旧……但它是必需的）。我已经研究过在其他东西中使用 DirectShowLib，尽管我只是找不到在哪里找到这些信息。

作为参考，这是我想要获得的图片：http: [//imgur.com/yNSKo](http://imgur.com/yNSKo)

我想避免使用第 3 方 dll，但如果我必须这样做的话。如果有人可以提供帮助，我将不胜感激！

这是一些代码（尽管我认为它不值得盐分）：

```
 WindowsMediaPlayer wmp = new WindowsMediaPlayer();
        IWMPMedia mediaInfo = wmp.newMedia(fileName);
        MessageBox.Show(mediaInfo.getItemInfo("WM/Codec")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T07:49:03.373

好的，我找到了答案。我使用： http: [//www.codeproject.com/Articles/36338/Export-Windows-Media-Player-Music-Metadata-to-XML](http://www.codeproject.com/Articles/36338/Export-Windows-Media-Player-Music-Metadata-to-XML)作为指南。我添加了 WMP.dll 作为获取此信息的参考。一旦我添加了 WMP.dll，我所做的就是找到编解码器的十六进制并进行比较。仅当您每次都使用相同的特定编解码器时，这才有效。至少它会帮助您为编解码器提取十六进制值，并且您可以将十六进制值与 WMP 中文件属性中的视频编解码器相关联。

我希望这有助于下一个试图在他们的 WMV 中找到特定编解码器的人。

```
 private bool WMPCodecCheck(string fileName)
    {
        try
        {
            WindowsMediaPlayer wmp = new WindowsMediaPlayer();
            wmp.mediaCollection.add(fileName);
            IWMPMedia currentWMV = wmp.newMedia(fileName);
            media = wmp.mediaCollection;

            this.codecType = media.getMediaAtom("FourCC");

            IWMPPlaylist mediaList = null;

            IWMPMedia mediaItem;
            mediaList = media.getByAttribute("MediaType", "Video");

            for (int i = 0; i < mediaList.count; i++)
            {
                mediaItem = mediaList.get_Item(i);
                if (mediaItem.sourceURL.Equals(fileName))
                {
                    if (_hasCodec.Equals(GetCodec(mediaItem)))
                    {
                        //MessageBox.Show("Codec Exists!");
                        wmp.mediaCollection.remove(mediaItem, true);
                        return true;
                    }
                }
            }
            wmp.mediaCollection.remove(currentWMV, true);
            return false;
        }
        catch (Exception e)
        {
            Log.LogToFile("Codec Read Error." + e, LogType.Exception);
        }
        return false;
    }
    private string GetCodec(IWMPMedia mediaItem)
    {
        // Has Codec = 877474375
        // No Codec  = 861293911
        string codec = mediaItem.getItemInfoByAtom(codecType);
        if (string.IsNullOrEmpty(codec))
        {
            codec = mediaItem.getItemInfoByAtom(codecType);
        }
        //MessageBox.Show("Codec Hex Value: " + codec);
        return codec;
    } 
```

# android - 如何在按下按钮时在画布上绘制矩形（Android？）

> ID：11513906
> 
> 赞同：0
> 
> 时间：2012-07-16T23:09:43.090
> 
> 标签：android, button, android-canvas, buttonclick

我的项目现在实际上有很多行代码，所以我会通过只在此处包含重要的内容来节省您的时间。我希望有足够的信息来说明问题。

我有两个主要类：一个“GraphView”类，然后是主 Activity 的代码。在 GraphView 中，我创建了一个函数，它本质上是在画布上绘制一个矩形。它被称为drawPixel。在 GraphView 的 onDraw 方法中，我多次调用 drawPixel，它在屏幕上绘制矩形。现在，在主代码中，我以编程方式创建了一个布局和一个按钮。我想要的是，我不想在 GraphView 的 onDraw 方法中调用 drawPixel，而是想在单击按钮时绘制这些矩形。我尝试这样做：

```
someButton.setOnClickListener(new View.OnClickListener() { 
    @Override
    public void onClick(View v) {
        Canvas canvas = new Canvas(); 
        // TODO Auto-generated method stub
            for (int i=1; i<50; i++) {
                someGraphView.drawPixel(canvas, i, i); 
            }
        }
}); 
```

它没有用。当我通过 onDraw() 调用时，矩形正确绘制，但是当我从 setOnClickListener 方法内部调用它们时，它们根本不绘制。有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:43:58.553

一旦在你的视图上写了调用 invalidate() 。

# magento - 如何获得 Magento 中主要父商店的名称？

> ID：11513908
> 
> 赞同：0
> 
> 时间：2012-07-16T23:09:57.737
> 
> 标签：magento

我正在使用 Magento 的默认数据库转储，它为我提供了数据库中的默认内容。 ![获取magento商店名称](../Images/40501b9917f8b71e87c9b33777cdc6d4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:48:32.067

网站：`Mage::app()->getWebsite()->getName();`

店铺群：`Mage::app()->getGroup()->getName();`

# css - 使用 CSS 选择递归 div 布局中的最后一个 div

> ID：11513910
> 
> 赞同：3
> 
> 时间：2012-07-16T23:10:19.350
> 
> 标签：css, recursion, css-selectors

使用下面的 HTML，**我如何选择 DIV depper（没有子级）？**

我认为我可以使用 nth-last-child 但不起作用，因为所有 div 都有最后一个（也是第一个）！:D

PD：不可能在 DIV 中更深地使用 ID 或 CLASS 属性（因为它们是 Web 中存在的 HTML 文件）

**html:**

```
<div class="base">
    <div>
        <div>
            <div>
                <div>
                    <!-- recursive divs (quantity not defined...) -->
                </div>
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:19:22.507

遗憾的是，CSS 选择器无法查看父元素，因此您无法看到哪些元素没有`div`s 作为子元素。

如果您使用的是 jQuery，则可以执行以下操作来查找元素：

```
$('.base :not(:has(*))').addClass('deepest');​ 
```

演示：http: [//jsfiddle.net/EhZax/](http://jsfiddle.net/EhZax/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T23:17:03.270

你必须使用Javascript。这是一个使用 jQuery 的示例：

```
$('.base *').filter(function(){
    return ! $(this).find('> *').length;
}); 
```

在这里查看它的实际效果：http: [//jsfiddle.net/E6sec/](http://jsfiddle.net/E6sec/)

* * *

**更新：**如果你愿意，你可以创建自己的`:sterile`选择器。这是一个例子：

```
jQuery.expr[':'].sterile = function(el) {
    return ! el.children.length;
}; 
```

然后，您可以像使用任何其他伪选择器一样使用它：

```
$('.base :sterile');​ 
```

这是小提琴：http: [//jsfiddle.net/FBw5q/](http://jsfiddle.net/FBw5q/)

**PS**我使用的是原生的`el.children`，因为[它比任何 jQuery 的方法都快](http://jsperf.com/node-children-vs-this-find-vs-this-children)。但是，IE < 9 将包含注释为`children`. 如果这与您有关，您可以使用 jQuery 的`children()`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T23:14:25.690

为此，您需要 Javascript。仅使用 CSS 是不可能的

# java - 如何在 Salesforce 中使用带有 WHERE 子句的批量 API

> ID：11513915
> 
> 赞同：1
> 
> 时间：2012-07-16T23:10:46.083
> 
> 标签：java, salesforce, soql

我想使用 Salesforce 的 Bulk API 来运行这种格式的查询。

```
Select Id from Object where field='<value>'. 
```

我有数千个这样的字段值，并且想要检索这些对象的 Id。AFAIK，Salesforce 的批量查询仅支持一个 SOQL 语句作为输入。

一种选择可能是形成一个查询，如

```
Select Id,field where field in (<all field values>) 
```

但问题是 SOQL 有 10000 个字符的限制。

这里有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T14:00:03.537

您似乎正在尝试执行某种搜索查询。如果是这样，您可能会考虑使用[SOSL](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_sosl.htm)查询而不是 SOQL，只要您正在搜索的字段由 SFDC 编制索引。

否则，我同意 Born2BeMild 的观点。您的第二种方法更好，将您的值列表分成批次将有助于绕过限制。

如果您更详细地描述一些用例，也会有所帮助。通常，即使使用批量 API，对一组动态字段和值的查询也并不总是产生最佳性能。您最好将数据下载到本地数据库并以这种方式探索数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T08:42:01.523

您可以将它们分解为 200 个左右的值，并迭代地查询 Salesforce 以在内存中构建结果集或处理数据子集。

不过，您将不得不检查 SOQL 查询的最大数量的调控器限制。您应该能够在运行时通过 API 跟踪您的使用情况，以避免超过最大值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-16T21:59:09.430

问题是您正在达到州长限制。如果来自数据库，Saleforce 一次只能处理 200 条记录。因此，为了能够首先处理所有这些记录，您需要将所有记录添加到列表中，例如：

```
 List<Account> accounts= [SELECT id, name, FROM Account]; 
```

然后你可以使用列表帐户做你需要做的一切，然后当你完成后，你可以使用以下方法更新数据库：

```
Update accounts; 
```

此链接可能会有所帮助： [https ://help.salesforce.com/apex/HTViewSolution?id=000004410&language=en_US](https://help.salesforce.com/apex/HTViewSolution?id=000004410&language=en_US)

# c# - C# 窗体在程序结束时关闭

> ID：11513916
> 
> 赞同：0
> 
> 时间：2012-07-16T23:10:48.767
> 
> 标签：c#, forms

我有一个 Windows 窗体问题：

程序.cs：

```
Application.Run(new frmStart()); 
```

frmStart: on `btnLoad_Click`,

```
frmLoad formLoad = new frmLoad();
formLoad.Show();
this.Hide();   // if I do a this.Close();  after it shuts down and doesn't get to show the form 
```

frmLoad：开`btnCancel_Click`：

```
Application.Exit();   
// or this.Close(); 
// or even: base.Close(); 
```

表格消失了，但程序并没有结束，我还是要按蓝色的“停止调试”让它停止。

我一直在寻找...我知道可以使程序真正停止，而不仅仅是在您关闭第二个表单时冻结，即使您不将第一个表单保留在屏幕上，但不记得并且无法弄清楚如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:17:28.917

在**frmStart**添加：

```
public static frmStart Current; 
```

然后在**构造函数**中添加：

```
Current = this; 
```

然后在 frmLoad: 上**btnCancel_Click**：

```
frmStart.Current.Close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:18:46.110

你真的应该在两者上调用 Close() 。这是唯一干净的方法，否则第一个表单永远不会被告知关闭并且不会清理。

您可能知道这样做是安全的，但是稍后处理代码的其他人可能会在 OnClose 中以他们需要调用的第一种形式添加代码。当他们最终弄清楚为什么没有调用他们的代码时，他们会说你不好。

如果您同时关闭两者，那么您的应用程序将退出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:18:58.357

请使用 Application.ExitThread() 方法，该方法退出当前线程的消息循环并关闭线程上的所有窗口。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.application.exitthread](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.exitthread)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T23:23:45.350

确认，Application.ExitThread 上的 -1！

问题是您还没有关闭主窗体。最简单的方法是连接到第二个窗体的 Closed 事件并让它关闭主窗体。例如，打开第二个表单的代码更改为：

```
 var newForm = new frmLoad();
        newForm.FormClosed += (closedSender, closedE) => Close();
        newForm.Show();
        Hide(); 
```

这实质上是这样设置的，以便当 frmLoad 窗体关闭时，主窗体调用它的 Close() 方法。我为事件处理程序使用了 Lambda 表达式，但您可以轻松地创建一个接受 (object sender, EventArgs e) 的私有方法并将 .FormClosed 指向它。

*编辑：对不起，错过了您只想在某些状态下关闭。在这种情况下，在您的 frmLoad 上创建一个公共属性，例如：

公共布尔用户取消{得到; 私人套装；}

其中 Cancel 按钮在关闭表单之前将其设置为 True。主窗体中的事件处理程序更改为：

```
 var newForm = new frmLoad();
        newForm.FormClosed += (closedSender, closedE) =>
                                {
                                    if (newForm.UserCancelled)
                                        Close();
                                };
        newForm.Show();
        Hide(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T23:23:54.803

我对所有答案都投了赞成票。在您的主要表单中覆盖表单关闭并首先关闭辅助表单。

# javascript - 使用 onClick 传递多个变量

> ID：11513917
> 
> 赞同：1
> 
> 时间：2012-07-16T23:11:01.080
> 
> 标签：javascript

我想要许多不同的按钮（每个都使用 PHP 编写），使用 onClick 将 3 个或更多变量传递给函数，然后将其写入输入字段。

以下内容越来越接近，但我不确定如何将多个 var 数组传递给重写函数。

```
<HTML>
<HEAD>
<TITLE>Test Input </TITLE>
<SCRIPT LANGUAGE="JavaScript">
function writeText (var1, var2, var3) {
    form.inputbox1.value = var1
    form.inputbox2.value = var2
    form.inputbox3.value = var3
}
</SCRIPT>
</HEAD>
<BODY>
<FORM NAME="myform" ACTION="" METHOD="GET">
Enter something in the box: <BR>
<INPUT TYPE="button" NAME="button2" Value="Write" onClick="writeText(this.form)"><br>

  <input type="text" name="inputbox2"><br>
  <input type="text" name="inputbox3"><br>
  <input type="text" name="inputbox4">

</FORM>
</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T23:30:16.040

如果您尝试使用不同的按钮，每个按钮都向三个字段写入一组不同的值，那么就会出现一些问题。

1.  在 writeText 函数中，您没有指定应该写入哪个表单（除非 'form' 变量包含该表单）。
2.  您传递给 writeText 函数的参数实际上并不是您编写要使用的 writeText 函数的参数。

首先，要在概念上使用 writeText 函数将三个值写入字段，就像您编写的一样，您的按钮 HTML 应该如下所示：

```
<INPUT TYPE="button" NAME="button2" Value="Write" onClick="writeText('value1','value2','value3')">
```

此外，您需要更改“writeText”函数中的代码以指向您想要的字段。这样做的一种方法是将 ID 添加到您要写入的字段中，然后 getElementById，例如将您的字段更改为

```
<input type="text" name="inputbox1" id="inputbox1">
```

然后在javascript中使用：

```
var inputbox1 = document.getElementById('inputbox1');
if (inputbox1) { inputbox1.value = var1 }
```

所以具体来说，要将三个值从 onClick 传递给 writeText 函数，您需要使用

```
onClick="writeText('值写入 1','值写入 2','值写入 3');"
```

而不是

```
writeText(this.form)
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-24T14:20:32.037

以及如何处理——

```
$('#list_tasks').append('<button class="btn btn-default" onclick="buildMemberPerTask(' + res + ',' + res + ')"; type="submit">' + res.results[i].description + '</button>'); 
```

# magento - 在 Magento 中获取产品的所有关键字的有效方法是什么？

> ID：11513919
> 
> 赞同：0
> 
> 时间：2012-07-16T23:11:20.433
> 
> 标签：magento

我在 Magento Wiki 中找不到此文档，并且我不确切知道它所在的`core/`文件夹中的数据库表或类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:08:35.220

加载对象并在其上使用 getMetaKeyword()。请注意，类别使用 getMetaKeywords()

```
$_product = Mage::getModel('catalog/product')->loadByAttribute('sku',$sku))

$_product->getMetaKeyword(); 
```

由于 SKU 是静态属性，因此加载对象的更快方法是使用

```
$_product = Mage::getModel('catalog/product')->load($sku,'sku');

$_product->getMetaKeyword(); 
```

# javascript - Jquery 验证器似乎不起作用

> ID：11513921
> 
> 赞同：1
> 
> 时间：2012-07-16T23:11:37.217
> 
> 标签：javascript, jquery, jquery-plugins, jquery-validate

我很确定我遗漏了一些非常明显的东西，但我正在尝试验证我的一个具有所需条件的文本框，并且我正在使用 Jquery 验证器。我的代码如下所示：

```
 var validator = $("#ForgotPassword").validate({
                rules: {
                    EmailAddress: { required: true }
                },
                messages: {
                    EmailAddress: {
                        required: "Email address is required."
                    }
                }
            }); 
```

我的 DOm 如下所示：

```
<form id = "ForgotPassword" class="ui-helper-hidden"  title="Forgot Password" action="" method="GET">
                <p>Please enter the email address you registered with. We’ll send you an email with a password reset link.</p>
                <div class="inputwrapper _100">
                    <label for="Email">Email</label>
                    <input type="text" id="EmailAddress" name="Email" data-bind ="value : ForgotPasswordEmailAddress"/>
                    <span id="EmailAddress_Error" class="ui-helper-hidden errorMessage" ></span>
                </div>
            </form> 
```

但是当我在运行时对我的验证器对象进行监视时，我没有看到任何错误。是因为我看错了地方还是我的装订不对？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:25:23.393

请尝试此操作或粘贴其余验证码：

对于验证插件，您需要有名称 -`EmailAddress`在这种情况下：

希望对事业有所帮助`:)`

```
<form id = "ForgotPassword" class="ui-helper-hidden"  title="Forgot Password" action="" method="GET">
                <p>Please enter the email address you registered with. We’ll send you an email with a password reset link.</p>
                <div class="inputwrapper _100">
                    <label for="Email">Email</label>
                    <input type="text" id="EmailAddress" name="EmailAddress" class="EmailAddress" data-bind ="value : ForgotPasswordEmailAddress"/>
                    <span id="EmailAddress_Error" class="ui-helper-hidden errorMessage" ></span>
                </div>
            </form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:26:13.090

我认为问题在于规则和消息中的名称。您应该将其`Email`用作规则和消息，而不是`EmailAddress`因为那是控件上的 name 属性

# c++ - C++ 库中的快速梯度下降实现？

> ID：11513926
> 
> 赞同：9
> 
> 时间：2012-07-16T23:12:26.860
> 
> 标签：c++, visual-studio-2010, optimization, numerical-methods, gradient-descent

我正在寻找运行梯度下降优化以最小化变量实例化的成本。我的程序在计算上非常昂贵，所以我正在寻找一个可以快速实现 GD 的流行库。推荐的图书馆/参考资料是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T23:26:42.153

[GSL](http://www.gnu.org/software/gsl/)是一个很棒的（免费的）库，它已经实现了数学和科学兴趣的常见功能。

您可以在线阅读整个[参考手册](http://www.gnu.org/software/gsl/manual/html_node/)。四处寻找，[这](http://www.gnu.org/software/gsl/manual/html_node/Multimin-Algorithms-with-Derivatives.html)开始看起来很有趣，但我认为我们需要更多地了解这个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-18T03:38:25.937

听起来您对最小化方法相当陌生。每当我需要学习一组新的数值方法时，我通常会查看[数值食谱](http://numerical.recipes/)。这本书很好地概述了该领域最常见的方法、它们的权衡，以及（重要的是）在哪里可以查看文献以获取更多信息。它通常不是我停下来的地方，但它通常是一个有用的起点。

例如，如果您的函数成本很高，那么您的目标是最小化需要收敛的评估次数。如果您有梯度的解析表达式，那么基于梯度的方法可能对您有利，假设函数及其梯度在感兴趣的域中表现良好（缺乏奇异性）。

如果您没有分析梯度，那么您几乎总是最好使用仅评估函数（而不是其梯度）的[下坡单纯形法。](http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method)数值梯度很*昂贵*。

另请注意，所有这些方法都将收敛到局部最小值，因此它们对您最初启动优化器的点相当敏感。全局优化是完全不同的野兽。

最后的想法是，您可以找到的几乎所有用于最小化的代码都将相当有效。最小化的实际成本在成本函数中。您应该花时间分析和优化您的成本函数，并选择一种算法来最大限度地减少您需要调用它的次数（下坡单纯形法、共轭梯度法和[BFGS](http://en.wikipedia.org/wiki/BFGS_method)等方法都适用于不同类型的问题）。

在实际代码方面，除了已经提到的其他库之外，您还可以在[NETLIB找到很多不错的例程。](http://netlib.org/)大多数例程都在 FORTRAN 77 中，但不是全部；要将它们转换为 C，[f2c](http://www.netlib.org/f2c/)非常有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-17T01:07:04.153

对于这种优化工作，最受尊敬的库之一是[NAG 库](http://www.nag.co.uk/)。这些在世界各地的大学和工业中使用。它们可用于 C / FORTRAN。它们非常不自由，并且包含的​​不仅仅是最小化函数 - 涵盖了许多通用数值数学。

无论如何，我怀疑这个库对于你需要的东西来说太过分了。但这里是与最小化有关的部分：[局部最小化](http://www.nag.co.uk/numeric/CL/nagdoc_cl23/html/E04/e04conts.html) 和[全局最小化](http://www.nag.co.uk/numeric/CL/nagdoc_cl23/html/E05/e05conts.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-16T23:26:59.050

尝试对学生免费提供的[CPLEX 。](http://www-01.ibm.com/software/integration/optimization/cplex-optimizer/)

# mod-rewrite - 未应用简单的 mod 重写规则

> ID：11513931
> 
> 赞同：0
> 
> 时间：2012-07-16T23:12:49.743
> 
> 标签：mod-rewrite

这*应该*很简单。URL 区分大小写，因此我想重定向输入小写“m”的任何人。

知道为什么它不起作用吗？

```
RewriteRule ^www.junaphotography.com/100moments$ http://www.junaphotography.com/100Moments/ [L,QSA] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T22:13:36.733

A`RewriteRule`的正则表达式匹配（第一个参数）与不包含主机名的**URI匹配。**您可以省略主机名：

```
RewriteRule ^/?100moments/?$ http://www.junaphotography.com/100Moments/ [L,QSA] 
```

如果您绝对需要确保请求是针对`www.junaphotography.com`主机的，请添加`RewriteCond`：

```
RewriteCond %{HTTP_HOST} ^www.junaphotography.com$ [NC]
RewriteRule ^/?100moments/?$ http://www.junaphotography.com/100Moments/ [L,QSA] 
```

# c# - 在 RestSharp 中优雅地处理一个空的 json 对象

> ID：11513935
> 
> 赞同：10
> 
> 时间：2012-07-16T23:13:16.190
> 
> 标签：c#, .net, restsharp

我有以下代码：

```
public void GetJson()
{
    RestRequest request = new RestRequest(Method.GET);

    var data = Execute<Dictionary<string, MyObject>>(request);
}

public T Execute<T>(RestRequest request) where T : new()
{
    RestClient client = new RestClient(baseUrl);
    client.AddHandler("text/plain", new JsonDeserializer());

    var response = client.Execute<T>(request);

    return response.Data;
} 
```

问题是有时响应会是一个空的 json 数组`[]`。当我运行此代码时，我得到以下异常：无法将“RestSharp.JsonArray”类型的对象转换为“System.Collections.Generic.IDictionary`2[System.String,System.Object]”。

有没有办法优雅地处理这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-31T17:24:49.123

我自己通过以下方式解决了类似的问题。我曾尝试使用自定义反序列化器（因为我正在反序列化为一个复杂的对象），但最后下面的内容要简单得多，因为它只适用于我提出的多种请求中的一种。

```
request.OnBeforeDeserialization = (x =>
{
    x.Content = x.Content.Replace("[]", "{}");
}); 
```

在我为这个特定请求构造请求对象的地方，我使用该`OnBeforeDeserialization`属性设置了一个回调，它将不正确的替换`[]`为`{}`. 这对我有用，因为我知道我在其余部分中返回的数据`x.Content`将永远不会包含`[]`，除非在这种特殊情况下，即使在值中也是如此。

这可能对其他人有帮助，但绝对应该小心使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T14:20:13.540

我从来不需要 client.AddHandler 行，所以我不确定你是否需要它。不过，请为您的 Execute 方法尝试此操作：

```
public T Execute<T>(RestRequest request) where T : class, new()
{
    RestClient client = new RestClient(baseUrl);
    client.AddHandler("text/plain", new JsonDeserializer());

    try
    {
        var response = client.Execute<T>(request);
        return response.Data;
    }
    catch (Exception ex)
    {
        // This is ugly, but if you don't want to bury any errors except when trying to deserialize an empty array to a dictionary...
        if (ex is InvalidCastException && typeof(T) == typeof(Dictionary<string, MyObject>))
        {
            // Log the exception?
            return new T();
        }

        throw;
    }
} 
```

# ruby - 机械化解析错误

> ID：11513936
> 
> 赞同：1
> 
> 时间：2012-07-16T23:13:17.327
> 
> 标签：ruby, screen-scraping, mechanize

我最近开始在 ruby​​ 中使用 mechanize，它运行良好。今天尝试获取一个页面，但是由于某种原因输入字段没有被占用，请参考下面的代码：

```
agent = Mechanize.new
agent.add_auth(url, user, pass1, realm = nil, domain = nil)
agent.agent.http.verify_mode = OpenSSL::SSL::VERIFY_NONE
#agent.log = Logger.new(STDOUT)
page = agent.get(url)

page.forms.first.field_with(:name => 'Login[username]').value=user
page.forms.first.field_with(:name => 'Login[password]').value=pass2
page = agent.submit(page.forms.first)
page = page.link_with(:text => "Search").click
page = page.link_with(:text => "Spiral").click
pp page 
```

我试图解析的 html 页面包含这一行：

```
<input name="SpiralMatch_string" type="text" maxlength="128"> 
```

但是由于某种原因，当我转储当前“页面”的内容时，与此无关

还有一件事可能是相关的，这个字段下面有一个java运行，每次我在里面输入一些东西，页面的主要内容都是动态变化的。有没有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:43:43.463

听起来页面可能是通过 javascript 或 ajax 调用填充的。仅仅因为浏览器在“查看源代码”中向您显示了一些 html，并不意味着它实际上在响应中。您应该使用 charles 或 fiddler 之类的调试代理来查看响应的真实情况。

# java - 在安卓中是什么意思？

> ID：11513938
> 
> 赞同：-1
> 
> 时间：2012-07-16T23:13:31.043
> 
> 标签：java, android

```
public void onItemClick(AdapterView<?> parent, View v, int pos, long id) 
```

`<?>`上面代码中的含义是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:55:47.400

```
 Array<Int> arrayOfInts;
  Array<String> arrayOfStrings;
  Array<?>      arrayOfAnything;  // 

  Object o = arrayOfAnyting[0];
  if (arrayOfAnything[0] instanceof String){
    String s =(String) arrayOfAnything[0];

  }

 String s2 = arrayOfStrings[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:31:32.180

`AdapterView<?>parent`

是`<?>`通配符。

[参考](http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html)此特定功能的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:35:34.223

在 Java 泛型的概念中，这意味着您正在使用通配符。

所以这意味着任何 AdapterView 类型都可以在该签名中使用。

# javascript - 需要类似于 Google 通讯录的功能 - “新联系人”

> ID：11513943
> 
> 赞同：0
> 
> 时间：2012-07-16T23:13:57.423
> 
> 标签：javascript, jquery, contacts, google-contacts-api

我正在创建一个类似于 Google 联系人（以及 iPhone“新联系人”设置）的“联系人”表单，我需要一个类似的 JS 解决方案。功能将非常相似，因为我希望有电子邮件、电话、传真等的标准字段......但是一旦输入，您可以选择将其指定为家庭、工作、移动等，并可以选择添加一个额外的条目。

我知道这可能是在黑暗中拍摄的，但有谁熟悉在线解决方案来实现这一点？TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:26:52.993

看起来您的基本问题是您的焦点处理程序；如果您将其删除，则一切正常（除了您的联系人类型 UI 挂起）。我会推荐：

A) 让 focusout 处理程序检查其 e.target，如果 e.target 是具有联系人类型的 div，则返回 false（然后在单击事件解决后清除联系人类型选项）

B) 使用不同的机制来清除联系人类型选项

# java - 制作井字游戏；我怎样才能让tictactoe按钮在X和O之间交替？

> ID：11513951
> 
> 赞同：0
> 
> 时间：2012-07-16T23:15:09.003
> 
> 标签：java, arrays, jframe, jpanel, jbutton

我只需要让它在转弯时在“X”和“O”之间交替，但它只会给我 X。

```
import java.awt.GridLayout;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

import javax.swing.*;
public class tictactoe {
    public static final int FRAME_WIDTH = 700;
    public static final int FRAME_HEIGHT = 200;
    public static void main(String[] args)          
    {
        int slots = 9;

        final JButton[] gameButton = new JButton[9];

        JPanel ticTacToeBoard = new JPanel();
        ticTacToeBoard.setLayout(new GridLayout(3, 3));
        JButton clearButtons = new JButton("New Game");
        for (int i = 0; i < slots; i++)
        {
            gameButton[i] = new JButton();
            ticTacToeBoard.add(gameButton[i]);
            final int countTurns = i;

            gameButton[i].addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    Object clicked = e.getSource();
                    int turns = 1;
                    for (int p = 0; p < 9; p++)
                    {
                        if(clicked == gameButton[countTurns] && turns < 10)
                        {
                            if (!(turns % 2 == 0))
                            {
                                ((JButton)e.getSource()).setText("X");
                                turns++;
                            }
                            else
                            {
                                ((JButton)e.getSource()).setText("O");
                                turns++;
                            }
                        }
                    }
                }
            });

            final int integerHack = i; 

            clearButtons.addActionListener(new ActionListener(){
                @Override
                public void actionPerformed(ActionEvent e) {
                    gameButton[integerHack].setText("");
                }
            });
        }
        JButton exit = new JButton("Exit");
        exit.setActionCommand("EXIT");
        exit.addActionListener(new ActionListener(){
            @Override
            public void actionPerformed(ActionEvent e) {
                String cmd = e.getActionCommand();
                if (cmd == "EXIT")
                {
                    System.exit(FRAME_WIDTH);
                }
            }
        });

        JPanel rightPanel = new JPanel();
        JLabel wonLabel = new JLabel();
        rightPanel.setLayout(new GridLayout(1, 3));
        rightPanel.add(wonLabel);
        rightPanel.add(clearButtons);
        rightPanel.add(exit);
        JFrame mainFrame = new JFrame();
        mainFrame.setSize(FRAME_WIDTH, FRAME_HEIGHT);
        mainFrame.setVisible(true);
        mainFrame.setLayout(new GridLayout(1,2));
        mainFrame.add(ticTacToeBoard);
        mainFrame.add(rightPanel);
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:23:31.470

看你的`actionPerformed`方法。每次点击发生时，您设置`turns`为 1。因此，`!(turns % 2 == 0)`将始终评估为 true，并且您将始终绘制 X。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:06:44.927

首先，正如其他人所说，您希望在所有循环之外初始化“转弯”。

其次，我想指出一个错字：

```
 if(clicked == gameButton[countTurns] && turns < 10) 
```

应该

```
 if(clicked == gameButton[p] && turns < 10) 
```

...除非您真的想在每次单击按钮时将每个按钮的文本从 X 更改为 O 九次。

但即使修正这个错字也是没有意义的。当它是哪个特定按钮无关紧要时，为什么要循环查找特定按钮？无论如何，所有按钮都有相同的操作处理程序，只有九个单独的副本，因为您每次都创建九个相同的副本。

相反，因为所有按钮都做同样的事情，所以您应该为所有按钮设置一个操作处理程序。如果您不确定这是如何完成的，您可以在按钮制作循环之外创建它并将其分配给一个变量，然后在分配每个按钮的操作处理程序时放入该变量，例如

```
 gameButton[i].addActionListener(myActionListener); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:25:22.393

只是通过快速查看您的代码，我猜这是因为您的`turn`变量在所有`ActionListener`对象中都是本地的。因此，`turn`变量始终为 1，并且您始终会遇到第一个 if 情况。因此`turn`，一旦您在`actionPerformed`方法中获得回调，该变量总是会在堆栈上重新创建。为了快速修复和测试，尝试将 turn 变量放入`tictactoe`类中，看看是否有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T23:26:26.933

问题在于您的 actionPerformed 中的转数变量。如果你想跟踪它，你应该把它从你的方法中移出。

# r - 从重新编码的变量（原子向量）创建列联表

> ID：11513953
> 
> 赞同：0
> 
> 时间：2012-07-16T23:15:20.877
> 
> 标签：r

另一个愚蠢的请求。我正在尝试使用重新编码的变量创建列联表，其中任何答案都编码为“1”，非答案编码为“0”。

我的原始数据可能看起来像这样：一些变量是从字符串重新编码的，而另一些是从数字重新编码的。

```
id   var1       recode    var2    recode2  ...   var250   recode250
1    "hello"     1         1         1     ... 
2    "hi"        1         <NA>      0     ...
3                0         <NA>      0     ... 
4     "hola"     1         1         1     ... 
```

我已经编写了一些代码来对字符串进行重新编码，我使用列联表进行检查。

```
data$recode <- ifelse((as.numeric(data$var1)!=1), 1, 0) #RECODES STRINGS
table(data$recode)
    0     1
    1     3 
```

但是，我还需要将所有其他变量中的 NA 重新编码为 0。我尝试使用另一个 ifelse 语句来做到这一点：

```
 data <- ifelse(is.na(data), 0, 1) 
```

这些值似乎发生了变化，但现在当我尝试运行相同的列联表时，我收到以下错误消息：

```
 Error in data$recode : $ operator is invalid for atomic vectors 
```

手头的关键问题是我*需要能够为我的所有变量*（即报告百分比和频率）生成列联表，因此有助于如何正确地将我的所有 NA（在一系列列内）重新编码为 0 所以会很有帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:35:37.060

我认为您想强制`data$var1`字符，然后计算字符而不是使用`as.numeric`. `logical`您还可以使用变量是二进制 的事实，`as.numeric(c(TRUE, FALSE))`将给出`c(1, 0)`.

```
data <- data.frame(var1 = c('hello','hi','','lola'), 
                   var2 = c(1,NA,NA,1))

data$recode_1 <- as.numeric(nchar(as.character(data$var1)) > 0)
data$recode_2 <- as.numeric(!is.na(data$var2))
data

##    var1 var2 recode_1 recode_2
## 1 hello    1        1        1
## 2    hi   NA        1        0
## 3         NA        0        0
## 4  lola    1        1        1 
```

## 编辑——处理多列

要一次处理多列，请使用、`plyr`和中的函数。这些应用函数按列，按列分别用于离散数据，按列分别用于数值数据`colwise``catcolwise``numcolwise`

```
library(plyr)                   
recode_character <- function(.col){
 as.numeric(nchar(as.character(.col)) > 0 )
}

recode_numeric <- function(.col){
  as.numeric(!is.na(.col))
}
data_more <- data.frame(var1 = c('hello','hi','','lola'), var2 = c(1,NA,NA,1), var3 = c(1,1,NA,NA), var4 = c('again','with','','Missing'))

recoded_data <- cbind(catcolwise(recode_character)(data_more),
      numcolwise(recode_numeric)(data_more))

recoded_data

##   var1 var4 var2 var3
## 1    1    1    1    1
## 2    1    1    0    1
## 3    0    0    0    0
## 4    1    1    1    0 
```

# cocoa - 可可卸载驱动器但不弹出它

> ID：11513958
> 
> 赞同：2
> 
> 时间：2012-07-16T23:16:21.480
> 
> 标签：cocoa, nsworkspace

你知道你卸载驱动器**而不**弹出它。`NSWorkspace`有一些卸载驱动器的方法，但它也会弹出它们。

任何的想法 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T07:58:43.827

我正在按如下方式进行操作，它会卸载驱动器但不会弹出它。

（其实是想弹出磁盘，只能unmount磁盘。:P请分享如何弹出磁盘。）

```
DASessionRef session = DASessionCreate(kCFAllocatorDefault);

CFURLRef path = CFURLCreateWithString(NULL, CFSTR("<path_to_your_volume_here>"), NULL);
DADiskRef disk = DADiskCreateFromVolumePath(kCFAllocatorDefault, session, path);

DADiskUnmount(disk, kDADiskUnmountOptionDefault, __unmountCallback, NULL); 
```

这是我仍在处理的代码，正在开发和测试中。
我正在手动创建“路径”。您可以使用（和共享）更好的方法以通用方式获取音量路径。也许[这个答案](https://stackoverflow.com/a/12409675/1082289)暗示了正确的做法。

当我的开发完善和完成时，我会更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:48:52.403

为此，请在 DiskArbitration 框架中使用 DADiskUnmount。

[http://developer.apple.com/library/mac/#documentation/Darwin/Reference/DiscArbitrationFramework/DiskArbitration_h/index.html#//apple_ref/c/func/DADiskUnmount](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/DiscArbitrationFramework/DiskArbitration_h/index.html#//apple_ref/c/func/DADiskUnmount)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-09T14:15:43.570

要弹出磁盘，请按照您的说明卸载磁盘，然后在 __unmountCallback 中执行以下操作：

```
 DADiskRef disk2 = DADiskCopyWholeDisk(disk);
            DADiskEject(disk2,
                        kDADiskEjectOptionDefault,
                        NULL,
                        NULL); 
```

您可以将任何对象作为上下文传递给 DADiskUnmount()，然后，例如，使用它来确定是否应在 __unmountCallback 中弹出相应的磁盘。

# jquery - 关于nettuts《30天学jquery》的四个问题

> ID：11513962
> 
> 赞同：7
> 
> 时间：2012-07-16T23:16:53.817
> 
> 标签：jquery, this, init, var

我正在做一个关于 nettuts 的免费 jQuery 课程，名为 30 days to learn jquery by Jeffrey Way，我有四件事我真的很难过，首先是代码：

```
(function() {
    $('html').addClass('js');

    var contactForm = {
            container: $('#contact'),

        init: function() {
            $('<button></button>', {
                text: 'Contact Me'
            })
                .insertAfter('article:first-child   ')
                .on('click', this.show);
            },
        show: function() {
            contactForm.container.slideDown(500);
        }                       
    };

    contactForm.init(); 

})(); 
```

当您单击网站上的“联系我”按钮时，它基本上会滑下联系表格。我的问题是：

1.  “init”的全部意义是什么，你需要它吗？
2.  为什么整个 jquery 代码都在一个变量中？
3.  在一串代码上写着`.on('click', this.show);`你为什么需要`this`in `this.show`？
4.  最后，你为什么需要，为什么你`contactForm.container.slideDown(500);`不能只说`container.slideDown(500);`or `$('form.contact').slideDown(500);` （顺便说一下，向下滑动的表单的 id 是`contact`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T23:27:52.323

> “init”的全部意义是什么，你需要它吗？

此代码正在创建一个 javascript 对象，其中包含一个名为 的函数`init`，然后调用该函数。您可以轻松地将这段代码移到对象之外，但是您将无法重用它，并用它做其他面向对象的事情。

> 为什么整个 jquery 代码都在一个变量中？

在 Javascript（不仅仅是 jQuery）中，一切都是对象。函数是一个对象，对象是对象，等等。这段代码创建了一个带有 3 个变量的对象：`container`，它存储一个 jquery 对象；`init`，其中存储了一个函数；并`show`存储一个函数。然后将其分配给`contactform`变量。

> 在显示 .on('click', this.show); 的代码字符串上 为什么在 this.show 中需要这个？

`this.show`引用对象`.show()`上的方法`this`。在此上下文`this`中是`contactForm`对象，并且`show`是作为对象传递的 show 函数（但未调用）。这样做的效果是，当点击按钮时，会调用 show 函数。

> 最后，为什么需要contactForm.container.slideDown(500)；至于为什么你不能只说 container.slideDown(500); 或 $('form.contact').slideDown(500); （顺便说一下，向下滑动的表单的id是contact。

因为`container`是属于contactform 对象的属性（即变量）。您可以执行类似的操作，`$('#contact').slideDown(500);`但您已经引用了`$('#contact')`in `contactform.container`，不使用它会导致不必要的开销。

# mysql - 优化 MySQL 索引以进行查询（交易分时数据数据库）

> ID：11513966
> 
> 赞同：1
> 
> 时间：2012-07-16T23:17:10.280
> 
> 标签：mysql, optimization, indexing, create-table

我的 MySQL 数据库有超过 3.5 亿行，并且还在增长。它现在的大小是 32GB。我正在使用 SSD 和大量 RAM，但想寻求建议以确保我使用适当的索引。

```
CREATE TABLE `qcollector` (
  `key` bigint(20) NOT NULL AUTO_INCREMENT,
  `instrument` char(4) DEFAULT NULL,
  `datetime` datetime DEFAULT NULL,
  `last` double DEFAULT NULL,
  `lastsize` int(10) DEFAULT NULL,
  `totvol` int(10) DEFAULT NULL,
  `bid` double DEFAULT NULL,
  `ask` double DEFAULT NULL,
  PRIMARY KEY (`key`),
  KEY `datetime_index` (`datetime`)
) ENGINE=InnoDB;

show index from qcollector;
+------------+------------+----------------+--------------+-------------+-----------+--    -----------+----------+--------+------+------------+---------+---------------+
| Table      | Non_unique | Key_name       | Seq_in_index | Column_name | Collation |     Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+------------+------------+----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| qcollector |          0 | PRIMARY        |            1 | key         | A         |   378866659 |     NULL | NULL   |      | BTREE      |         |               |
| qcollector |          1 | datetime_index |            1 | datetime    | A         |    63144443 |     NULL | NULL   | YES  | BTREE      |         |               |
+------------+------------+----------------+--------------+-------------+-----------+------    -------+----------+--------+------+------------+---------+---------------+
2 rows in set (0.03 sec)

select * from qcollector order by datetime desc limit 1;
+-----------+------------+---------------------+---------+----------+---------+---------+--------+
| key       | instrument | datetime            | last    | lastsize | totvol  | bid     | ask    |
+-----------+------------+---------------------+---------+----------+---------+---------+--------+
| 389054487 | ES         | 2012-06-29 15:14:59 | 1358.25 |        2 | 2484771 | 1358.25 | 1358.5 |
+-----------+------------+---------------------+---------+----------+---------+---------+--------+
1 row in set (0.09 sec) 
```

一个典型的慢查询（全表扫描，这个查询需要 3-4 分钟）：

```
explain select date(datetime), count(lastsize) from qcollector where instrument = 'ES' and datetime > '2011-01-01' and time(datetime) between '15:16:00' and '15:29:00' group by date(datetime) order by date(datetime) desc;
+------+-------------+------------+------+----------------+------+---------+------+-----------+----------------------------------------------+
| id   | select_type | table      | type | possible_keys  | key  | key_len | ref  | rows      | Extra                                        |
+------+-------------+------------+------+----------------+------+---------+------+-----------+----------------------------------------------+
|    1 | SIMPLE      | qcollector | ALL  | datetime_index | NULL | NULL    | NULL | 378866659 | Using where; Using temporary; Using filesort |
+------+-------------+------------+------+----------------+------+---------+------+-----------+----------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:19:51.417

当您在列上使用`date`和`time`函数时，索引无法有效使用。您还可以将日期和时间存储在单独的列中并为它们编制索引，但这会占用更多存储空间。

您可能还需要考虑添加多列索引。上的索引`(instrument, datetime)`可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:48:32.110

有几个想法供您考虑：

*   覆盖索引（即包含查询中引用的所有列的索引）可能会有所帮助。这样的索引将需要更多的磁盘（SSD？）空间，但它将消除 MySQL 访问数据页以查找不在索引中的列的值的必要性。

    `ON qcollector (datetime,instrument,lastsize)` 或者

    `ON qcollector (instrument,datetime,lastsize)`

*   您真的需要`lastsize`从计数中排除具有 NULL 值的行吗？你可以返回所有行的计数吗？如果您可以改为返回`COUNT(1)`or `SUM(1)`，则查询不需要引用该`lastsize`列，因此索引中不需要它来使其成为覆盖索引。

    `COUNT(lastsize)`表达式等价于`SUM(IF(lastsize IS NULL,0,1))`

*   当日期时间范围只有 NULL 值时，是否需要返回日期，或者是否可以排除`lastsize`所有具有 NULL 的行？`lastsize`也就是说，您能否包含一个谓词，例如

    `AND lastsize IS NOT NULL`

在您的查询中？

这些可能会有所帮助。

* * *

我认为最大的问题是`TIME(datetime)`表达式上的谓词不是 sargable。也就是说，MySQL 不会对它们使用索引范围扫描操作。裸`datetime`列上的谓词是 sargable ......这就是为什么 EXPLAIN 将 datetime_index 显示为可能的键。

另一个大问题是查询正在对派生表达式进行`GROUP BY`操作`ORDER BY`，这将要求 MySQL 生成一个中间结果集（作为临时 MyISAM 表），然后处理该结果集。当有很多行要处理时，这可能是很多繁重的工作。

* * *

至于表更改，我会考虑使用单独的 DATE 和 TIME 列，并使用 TIMESTAMP 数据类型代替 DATETIME（如果您需要将日期和时间存储在一起）。我将重写查询以引用裸 DATE 和裸 TIME 列，并考虑添加一个覆盖索引，其中包含重写查询中引用的所有列，前导列是具有最高基数的列（并且在询问。）

# python - 我应该如何构建 GAE 数据存储以获取与关键字相关的职业？

> ID：11513967
> 
> 赞同：0
> 
> 时间：2012-07-16T23:17:24.317
> 
> 标签：python, database, google-app-engine, database-design, google-cloud-datastore

如果有人搜索“牙齿医生”，我想从谷歌应用引擎数据存储中返回牙医的条目。同样，“足科医生”将返回足病医生、“儿童医生”儿科医生等。

我应该如何找到相关的关键字，我应该将它们与医生条目一起存储在单独的表格中，还是根据要求获取它们？

我正在考虑为专业人士设立一个实体——它将包括他们的姓名、位置、联系信息等，但最重要的是，他们的职业的正式名称。并且，另一个表是单词与职业的关系。例如，“牙齿”将映射到牙医，但也映射到正畸医生。这会是最好的方法吗？

另外，有没有办法让谷歌按多种方式对结果进行排序？我想列出最相关的结果，但也优先考虑相关性稍低但更接近的医生。例如，如果用户搜索“牙齿”，我希望结果按以下顺序排列：1\. 0.5 英里外的牙医，2\. 0.2 英里外的正畸医生，3\. 5 英里外的牙医。我目前正在考虑的是跟踪搜索的关键字旨在返回某个专业的估计百分比可能性，然后将其计算到我将使用和排序的距离计算器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:27:34.763

我可能会选择专业和专业。专业实体然后引用适用的专业。专业实体将包含您的关键字。然后，您可以使用新的应用程序引擎搜索功能来索引和搜索专业（[搜索概述（Python）](https://developers.google.com/appengine/docs/python/search/overview)）并使用结果来查找专业人士。以这种方式为您的专业人员编制索引也会为您提供部分/全部您想要实施的基于位置的搜索。

# silverlight - Silverlight UI 线程阻塞

> ID：11513972
> 
> 赞同：0
> 
> 时间：2012-07-16T23:17:40.027
> 
> 标签：silverlight

有人可以告诉我如何处理 UI 线程和其他“工作”线程之间的 Silverlight 进程。

我有一个场景，我必须通过视图模型更新视图中的数百个复杂 UI 对象。每个项目都由其自己的视图模型支持。

如果每个视图模型都有一个属性，例如，称为 IsSelected，它通过行为更改背景颜色，我应该如何更改最小的 UI 线程阻塞？

如果我更新我的（几百个）视图模型，它会阻塞 UI 线程大约 4 秒。我如何确定阻塞的原因？有没有更有效的更新方式？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:31:09.253

肯定有比一次性完成更有效的方法。

一个非 Silverlight 特定的解决方案是使用 DispatcherTimer 延迟调用将这些更新间隔几毫秒，因此线程有一些“喘息空间”来继续执行路径。

但是您还应该考虑一下您的架构，如果您正在处理数百个虚拟机，则可能值得使用延迟加载并按顺序更新您的屏幕，按照对您的受众的重要性排序。

有关更多解释，请参见此答案：[https ://stackoverflow.com/a/1710868/21217](https://stackoverflow.com/a/1710868/21217)

# ckeditor - CKEditor 和 Ajax - 在第二个实例上不更新

> ID：11513973
> 
> 赞同：1
> 
> 时间：2012-07-16T23:17:45.490
> 
> 标签：ckeditor

我无法让我的 CKEditor 正常工作。

我正在使用 Jquery 插入我的实例。并为编辑器设置了我自己的Ajax保存功能。

我的实例总是插入得很好。编辑器按应有的方式出现，并且似乎可以正常工作。但是：事实证明，在我插入实例时 2\. - textarea 没有被更新 - 因此没有更新的数据发送到 Ajaxcall。它发送旧数据。

发送到 ajax 调用后，我销毁了我的实例：CKEDITOR.instances[currentInstance].destroy(); 而且编辑器似乎每次都被正确销毁。OnClick 然后我重新插入编辑器（相同的实例名称。我在销毁实例时也删除了文本区域，然后在重新插入实例时重新插入文本区域。相同的文本区域名称）。

谁能告诉我为什么我可以一次又一次地插入实例，但编辑器只在第一次更新文本区域？

我试过了：

```
for ( var instance in CKEDITOR.instances ) {
            CKEDITOR.instances[instance].updateElement(); } 
```

插入保存功能 - 就在 ajaxcall 之前。但是还是没有更新。

这是实例的构建。通过 Jquery，我将其插入为 html() ：

```
<script type="text/javascript">
    CKEDITOR.replace('tekstindhold233',
    { height:'250px',width:'575px' });
</script> 
```

这是保存功能：

```
CKEDITOR.plugins.add('popwebsave',
{
init: function(editor)
{
var pluginName = 'popwebsave';

editor.addCommand( pluginName,
{
exec : function( editor )
{

for ( var i in CKEDITOR.instances ){
   var currentInstance = i;
   break;
}
for ( var instance in CKEDITOR.instances ) {
            CKEDITOR.instances[instance].updateElement(); }

var sprog = $('#lan_holder').text();
var vis = $('#vis_holder').text();
var pageId = $('#pageId_holder').text();
var tekstIndhold = CKEDITOR.instances[currentInstance].getData();
var tekstIndholdBox = currentInstance.replace('tekstindhold','');
var contentOrden = $('#content_orden' + tekstIndholdBox).text();
var dataString = 'lan=' + sprog + '&tekstindhold=' + tekstIndhold + '&eid=' + tekstIndholdBox + '&vis=' + vis + '&id=' + pageId + '&contentOrden=' + contentOrden;

$("#tekstindhold_box" + tekstIndholdBox).animate({ 
    opacity: 0  
        } , { 
    duration: 500,  
    complete: function() {
    $("#textarea_box" + tekstIndholdBox).text('');

$.ajax({
type: "POST",
url: "includes/JQ_opdater_tekst.php",
data: dataString,
dataType: "json",
cache: false,
success: function(databack){  
$("#textarea_box" + tekstIndholdBox).animate({
        height: 100
      }, 500, function() {
        $("#tekstindhold_box" + tekstIndholdBox).html(databack.tekstindhold_db);
        $("#tekstindhold_box" + tekstIndholdBox).animate({
        opacity: 1
      }, 500, function() {

CKEDITOR.instances[currentInstance].destroy();

        });
});

    }

});

        }
    });

},
canUndo : true
});

/*
editor.addCommand(pluginName, 
new CKEDITOR.dialogCommand(pluginName)

);
*/

editor.ui.addButton('Popwebsave',
{
label: 'Gem',
command: pluginName,
className : 'cke_button_save'
});
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T09:16:46.110

没关系！我想到了。事实证明，该实例需要存在于 DOM 中，在 destroy() 上，我切换了事件的顺序，以便首先发生 destroy()，然后删除了 textarea。现在工作得很好。

# android - 获取应用详情页面上显示的应用的缓存大小

> ID：11513977
> 
> 赞同：0
> 
> 时间：2012-07-16T23:17:59.050
> 
> 标签：android

我需要确定我的应用程序的缓存大小。我目前正在使用在应用程序上下文中调用的 getCacheDir()。但是，我得到的大小小于应用程序详细信息页面上显示的缓存大小。我无法确定造成这种差异的原因。Android是如何进行缓存大小计算的？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:30:38.607

也许应该用这种方法计算实际尺寸：

```
getCacheDir().length() + getExternalCacheDir().length() 
```

# javascript - 如何将 Sencha Touch 2.0 整合到现有网页中？

> ID：11513980
> 
> 赞同：2
> 
> 时间：2012-07-16T23:18:30.090
> 
> 标签：javascript, html, css, sencha-touch, sencha-touch-2

基本上，我想将 HTML5/CSS3 网页与 Sencha Touch 框架结合起来（以利用它很棒的模型/商店/AJAX 功能）。

这样做的最佳方法是什么？目前我正在考虑在 Sencha 中创建一个顶级容器并将页面的 HTML 作为模板插入。但是，我将需要一些 DataView 对象，并且我不确定如何将它们放置在页面中，除非整个设计是使用 Sencha 对象完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T08:20:31.467

好吧，你已经很清楚了，你现在只需要弄湿你的脚。ST 将允许您在几乎任何组件中嵌入任何现有的 HTML 或 CSS。这将使您开始利用 ST 的非可视化工具，例如商店和模型。

但是，当您想开始包含其他 ST 可视化组件时，您可能会陷入困境。ST 组件本质上与它的布局系统相关联。这意味着如果您想放入列表或其他数据视图，它们的大小、对齐方式等都与它们父级的布局和其他属性相关联。如果它们只是放入自由格式的 HTML 中，它们可能看起来不正确。

我的建议是你咬紧牙关，在 ST 重新做整个网站。请记住，您仍然可以在新移动网站的 ST 面板和容器中重复使用大量现有的 HTML 片段。但重要的是，ST 现在构成了您的移动网站的“外壳”，这确保了您使用的任何 ST 组件都将被正确格式化。

# c# - 本地化网页文本的最佳实践（给定标准）？

> ID：11513988
> 
> 赞同：0
> 
> 时间：2012-07-16T23:19:17.893
> 
> 标签：c#, .net, iis, localization

我在一个现有网站的新项目中，它当前的本地化方案是这样的：

```
en_welcome.aspx
fr_welcome.aspx
de_welcome.aspx
es_welcome.aspx 
```

每一个都包含重要的业务逻辑。有人告诉我这样做的原因是，唯一的持久内存是 SQLServer，它已经被它打败了，所以不欢迎更多的数据库调用来获取本地化的语言字符串。然而，我们的 Web 服务器有大量 RAM，而我们的网站只有十几页左右，我无法想象所有语言字符串都超过 300kb，所以我们可以让 IIS 偶尔从数据库中将它们加载到内存中。

执行此操作的最佳方法是什么，我将如何在代码中访问它？这是一个可怕的想法吗？您将如何触发 Web 服务器从 DB 重新加载字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:21:41.903

这通常[使用资源文件进行](http://www.codeproject.com/Articles/5447/NET-Localization-using-Resource-file)管理。

resx 文件不是存储在您的数据库中，而是可以成为您的代码库的一部分，或者可以以您认为合适的任何其他方式提供（请参阅评论中对 Sisulizer 的建议）。您将有一个“welcome.aspx”页面，它使用字符串键（通常来自常量类）来查找用户语言中的每条消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:35:59.520

您可以通过缓存数据提供程序路由所有文本查找。例如 ICachedTextDataProvider.GetString(string key, CultureInfoculture) 或类似的东西。

然后可以使用字典创建数据提供者中的简单缓存：

```
static Dictionary<CultureInfo, Dictionary<string,string>> m_labelsByCulture; 
```

然后，您可以通过查找文化作为键来获得正确的标签字典。

就到期而言，您可以简单地保留最后更新的时间，并且无论何时提出请求，您都可以检查它已经持续了多长时间以及是否需要重新加载标签。您可以在全局范围内为所有标签设置此时间，或者如果您想让每种语言的性能更好，甚至单独标签 - 取决于您想要制作它的复杂程度以及您的性能问题。

这是一个非常基本的策略。不过，还有更复杂的缓存方法。

# c# - C# 或 Visual C# 都一样吗？

> ID：11513990
> 
> 赞同：0
> 
> 时间：2012-07-16T23:19:31.273
> 
> 标签：c#

在互联网或书籍的许多地方，我交替阅读了这两个词。两者相同还是不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:23:30.060

**Visual C#**是*微软*发布的一款开发工具，用于开发基于**C#** *语言*的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:20:40.600

C# 是一种可以通过多种方式实现的编程语言。Visual C# 是 Microsoft 通过其 .NET 框架实现的 C#。无论如何，如果您像 99% 的人一样使用 C#，那么您使用的是 Microsoft 的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:26:58.593

他们是一样的。实际上没有任何产品名为“Visual C#”

它可能与*Visual Studio*（Microsoft 实现 C# 的 IDE）、*Visual C# Express*（仅支持 C# 开发的 IDE 的免费受限版本）或*Visual Basic*（在相同的 IDE。

# css - 使用显示块设置两个 div 的样式，使它们之间没有双边框，并导致下一个项目转到新行

> ID：11513995
> 
> 赞同：0
> 
> 时间：2012-07-16T23:20:44.307
> 
> 标签：css

我有两个字母要彼此相邻显示，并且它们周围有边框：

**HTML**：

```
<div class="status">C</div>
<div class="status">A</div>

<a>A link</a> 
```

**CSS**：

```
.status{ 
    display: block;
    float:left; border: 3px solid gray;   
    font-size: 3em
} 
```

他们后面还有一个锚。

好的，这会产生带有边界的 C 和 A，但正如您所看到的：

[http://jsfiddle.net/FgqHa/1/](http://jsfiddle.net/FgqHa/1/)

它们之间的边界由 C 的边界和 D 的边界组成。因此它们之间的边界是两倍厚，即。6像素。

有人可以建议最好的方法，使两者之间的边界只有 3px？

此外，链接应该出现在下一行，但在字母的右侧。如何强制它到下一行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:25:38.483

这应该适用于元素的动态列表：[您编辑的 jsfiddle](http://jsfiddle.net/FgqHa/4/)。

神奇的是伪类`:first-child`（`:last-child`也是可能的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:23:14.000

将 设置`border-right:1.5px`在左侧和`border-left:1.5px`右侧，或者只给两者之一设置内边框。或者可能设置`margin-left:-3px`在正确的位置（不确定这是否可行）。

考虑一下，我可能会`border-right:0px`在左边一个，`border-left:3px`在左边一个，以防浏览器决定对半像素做一些奇怪的事情。

# vb.net - 移动到资源 vb.net 2010 中加载的 HTML 文件中的锚点

> ID：11513997
> 
> 赞同：1
> 
> 时间：2012-07-16T23:21:01.963
> 
> 标签：vb.net, webbrowser-control, vb.net-2010

我在我的应用程序的资源中加载了一个 HTML 文件，这是一本每章都有 ancor 的电子书。我无法像这样加载html文件

`WebBrowser1.DocumentText = My.Resources.Book.html`

但是我找不到任何跳到锚点的方法，我想这样做

```
WebBrowser1.DocumentText = My.Resources.Book.html#C1 
```

但这并没有奏效，我尝试了其他一些方法，但没有奏效，但是我可以单击 webbrowser 控件中章节的链接。

# php - 如何隐藏特定页面的 js 和 css 文件

> ID：11513999
> 
> 赞同：0
> 
> 时间：2012-07-16T23:21:15.507
> 
> 标签：php

我想从 php 页面隐藏未使用的 js 和 css 文件。

某些页面未使用某些js文件，因此我想将它们隐藏起来。通过隐藏它们，我可以使网页更快并在 pagetest 中获得好成绩。

我使用简单的 php 代码来隐藏一页的代码。效果很好，该页面的文件是隐藏的，对于其他页面，代码不起作用。它显示的是 text 而不是 link ，就像 textarea 中的文本一样。

```
<?php
    function curPageName() {
        return substr($_SERVER["SCRIPT_NAME"],strrpos($_SERVER["SCRIPT_NAME"],"/")+1);
    }
    $currentp=curPageName();

    if($currentp=="main1.php"){
        echo "";
    } else { 
        //works 
        echo "<link type=\"text/css\" rel=\"stylesheet\" href=\"../rws.css\"     />"; 
        /// not works 
        echo "<link type=\"text/css\" rel=\"stylesheet\" href=\"http://img.y.com/rws.css\"     />"; 
    }
?> 
```

该代码适用于`/rws.css`，如果我使用`http://url.com/rws.css`它不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:27:03.407

代码是否获得了正确的当前页面并且它正在进入 ELSE？

您可以使用单引号和双引号内的双引号来确保您不会错过任何转义。

```
if($currentp!="main1.php"){
  echo('<link type="text/css" rel="stylesheet" href="http://img.y.com/rws.css" />'); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:43:00.170

这里有一个例子：

```
<?php

function get_current_file_name () {
$Exploded_Data = explode(‘/’, $_SERVER['PHP_SELF']); //explode the path to current file to array
$Exploded_Data = array_reverse ($Exploded_Data); //reverse the arrays order cos php file name is always after last /
$CurrentPage = $Exploded_Data[0]; // assign the php file name to the currentpage variable
return $CurrentPage;
}

$CurrentPage = get_current_file_name ();

if($CurrentPage!="main1.php"){
    echo('<link type="text/css" rel="stylesheet" href="style1.css" />'); 
}
else if$CurrentPage!="main2.php"){
    echo('<link type="text/css" rel="stylesheet" href="style2.css" />'); 
}

?> 
```

您可以使用`__FILE__` 而不是 `$_SERVER['PHP_SELF']`