# StackOverflow 问答 12059000-12059999

# visual-foxpro - Vfp 报告为 jpg

> ID：12059005
> 
> 赞同：0
> 
> 时间：2012-08-21T16:13:47.903
> 
> 标签：visual-foxpro

我正在尝试使用 foxypreviewer 将 vfp 报告导出到 jpg 。

我使用这种语法

```
DO foxypreviewer.app

LABEL FORM report object type 11 TO ab 
```

它正在将所有页面转换为单个pdf。

我需要通过我的代码将所有页面分别保存在单个文件夹中的 jpg 文件中。

Foxypreviewer SaveAs 图像功能提供了我需要的相同过程。

这可能吗。如果是，请分享您的知识。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:41:28.657

我怀疑是否有直接从 VFP 中执行此操作的好方法。不过，在 Google 上搜索“将 pdf 转换为 jpg”会显示一些结果，因此也许您可以通过几个步骤来实现您的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-26T14:19:46.167

您也可以使用 foxypreviewer 来实现任何 vfp 报告（frx）到图像（1 个或更多）的转换，试试这个代码：

```
local m.yrep
m.yrep= addbs(justpath(sys(16,1)))
do locfile('Foxypreviewer.app',"app")
LOCAL loReport as "PreviewHelper" OF ("FoxyPreviewer.app" )
loReport = CREATEOBJECT("PreviewHelper")
WITH loReport as ReportHelper
SET POINT TO ","
SET DECIMALS TO 2
SET SEPARATOR TO "."
    .AddReport(getfile("frx"))
    .cDestFile =m.yrep+ "test.JPG"  
.RunReport()
local m.oo
m.oo=.cDestFile
ENDWITH
loReport = NULL
RELEASE loReport
run/n explorer  &oo
RETURN 
```

# c++ - 如何调试未知代码中的异常？

> ID：12059007
> 
> 赞同：5
> 
> 时间：2012-08-21T16:13:54.940
> 
> 标签：c++, debugging, exception, assembly

我有一个使用外部库的程序。其中一个库（负责相机硬件）启动一个线程并意外崩溃。有时每两分钟一次，有时不是一个小时。没有明显的诱因。线程没有捕获到异常，这会导致应用程序终止。:(

幸运的是，我可以`RaiseException()`在`kernel32.dll`. 调用堆栈上没有其他我知道它们的用途的函数。

调试器告诉我，这是一个 std::bad_alloc 异常。调试器是怎么知道的？我能以某种方式获得有关异常的更多信息吗？如有必要，我会查看反汇编，但我不知道从哪里获取信息。

我正在使用 Visual Studio C++ 2010，对汇编程序非常熟悉，并且对 WINAPI 有一些了解。我们想尽快发布这个软件，这个错误必须消失。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:21:46.300

改用 Windbg，这是一个核心调试器，它什么都不隐藏，而是“按原样”公开事物。使用`sxe`语法启用所需的异常（Windgb 将启用在任何 SEH 类型处中断，而不仅仅是 C++）。Windbg 对第一次机会异常和第二次机会异常也有明确的区分。然后您应该弄清楚这是引发的 C++ 异常还是更基本的 SEH 类型，例如可能是 AV。

# actionscript-3 - 使用 ActionScript 的持久 GUID

> ID：12059013
> 
> 赞同：2
> 
> 时间：2012-08-21T16:14:04.630
> 
> 标签：actionscript-3, flash, actionscript, guid

我需要通过在其中安装本地共享对象来**唯一标识访问我的网站的机器，并且还需要****持久**地，这意味着如果用户删除 .sol 文件，将创建另一个本地共享对象，但在访问我的时具有相同的 GUID再次网站。

我在 Google 上找到的所有 ActionScript 示例都满足唯一性，但不满足持久性，因为它们使用时间戳作为 GUID 的一个种子因素。忽略该因素（时间戳）可能会影响创建的 GUID 的唯一性。

我发现了一个 ActionScript，它还结合了 Capabilities.serverString 方法以最大限度地提高唯一性，但我觉得它也会以负面的方式影响机器的一个或多个功能属性（hasMP3、hasPrinting 等）的持久性。 ） 改变。

那么，创建一个独特且持久的跨删除 GUID 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:33:21.783

恐怕没有办法使用纯 ActionScript 或 JavaScript 来实现这一点，而且它依赖于持久性（如果无法读取 MAC 地址或 HDD 序列号，就生成 GUID 而言，您没有太多工作可做可靠）。

请注意，即使您*可以*生成符合您的标准的 GUID，它也可能被欺骗（就像任何客户端一样），因此对于任何重要的服务器端都不是很有用（假设它将被发送到服务器）。

# php - 这个旧的 PHP 代码是什么意思 - 变量名在一行？

> ID：12059015
> 
> 赞同：1
> 
> 时间：2012-08-21T16:14:06.643
> 
> 标签：php

我正在重构这堆丑陋的遗留代码，我遇到了这个：

```
// $log is a PEAR logging object 
$log->debug( 'some error message' ); 
```

紧随其后：

```
$foo;
$bar;
...
... 
```

即只是一个函数中的变量名的负载..这是做什么的？没有 ？

谢谢 ：）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:14:29.067

它们是没有赋值的变量声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T16:21:26.827

它们完全没有意义，根本不声明变量，因为 PHP 没有变量声明的概念，只有赋值，而且这些语句没有为变量赋值。请参阅[使用的示例，与`$variable;`](http://codepad.org/EpOJTKmi)[没有`$variable;`](http://codepad.org/Bp1w9AqG);的示例进行比较 他们有相同的结果。

也许这是一种编码风格。

# jquery - jQuery 图像滑块 - 添加简单的缩略图控制功能

> ID：12059025
> 
> 赞同：0
> 
> 时间：2012-08-21T16:14:33.677
> 
> 标签：jquery, image, carousel

我在我的网站上使用 Marco 的“背景图片滑块”。链接到下面的背景滑块演示/文档。

( [http://www.marcofolio.net/webdesign/advanced_jquery_background_image_slideshow.html](http://www.marcofolio.net/webdesign/advanced_jquery_background_image_slideshow.html) )

我想要做的是添加一些简单的缩略图，以便将用户转发到他们选择的滑块中的图像。像这样`< o o o o o >`的东西，正如您可能想象的那样，第二个“o”将您带到第二个图像，依此类推。

我正在尝试寻找一些变量或可以用来控制当前幻灯片但没有任何运气的东西。

这是插件代码的副本

```
/*
* Author:      Marco Kuiper (http://www.marcofolio.net/)
*/

// Speed of the automatic slideshow
var slideshowSpeed = 6000;

// Variable to store the images we need to set as background
// which also includes some text and url's.
var photos = [ {
    "title" : "",
    "image" : "image_1.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_2.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_3.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_4.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_5.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_6.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}, {
    "title" : "",
    "image" : "image_7.jpg",
    "url" : "",
    "firstline" : "",
    "secondline" : ""
}
];

$(document).ready(function() {

// Backwards navigation
$("#back").click(function() {
    stopAnimation();
    navigate("back");
});

// Forward navigation
$("#next").click(function() {
    stopAnimation();
    navigate("next");
});

var interval;
$("#control").toggle(function(){
    stopAnimation();
}, function() {
    // Change the background image to "pause"
    $(this).css({ "background-image" : "url(img/btn_pause.png)" });

    // Show the next image
    navigate("next");

    // Start playing the animation
    interval = setInterval(function() {
        navigate("next");
    }, slideshowSpeed);
});

var activeContainer = 1;    
var currentImg = 0;
var animating = false;
var navigate = function(direction) {
    // Check if no animation is running. If it is, prevent the action
    if(animating) {
        return;
    }

    // Check which current image we need to show
    if(direction == "next") {
        currentImg++;
        if(currentImg == photos.length + 1) {
            currentImg = 1;
        }
    } else {
        currentImg--;
        if(currentImg == 0) {
            currentImg = photos.length;
        }
    }

    // Check which container we need to use
    var currentContainer = activeContainer;
    if(activeContainer == 1) {
        activeContainer = 2;
    } else {
        activeContainer = 1;
    }

    showImage(photos[currentImg - 1], currentContainer, activeContainer);

};

var currentZindex = -1;
var showImage = function(photoObject, currentContainer, activeContainer) {
    animating = true;

    // Make sure the new container is always on the background
    currentZindex--;

    // Set the background image of the new active container
    $("#headerimg" + activeContainer).css({
        "background-image" : "url(img/" + photoObject.image + ")",
        "display" : "block",
        "z-index" : currentZindex
    });

    // Hide the header text
    $("#headertxt").css({"display" : "none"});

    // Set the new header text
    $("#firstline").html(photoObject.firstline);
    $("#secondline")
        .attr("href", photoObject.url)
        .html(photoObject.secondline);
    $("#pictureduri")
        .attr("href", photoObject.url)
        .html(photoObject.title);

    // Fade out the current container
    // and display the header text when animation is complete
    $("#headerimg" + currentContainer).fadeOut(function() {
        setTimeout(function() {
            $("#headertxt").css({"display" : "block"});
            animating = false;
        }, 500);
    });
};

var stopAnimation = function() {
    // Change the background image to "play"
    $("#control").css({ "background-image" : "url(img/btn_play.png)" });

    // Clear the interval
    clearInterval(interval);
};

// We should statically set the first image
navigate("next");

// Start playing the animation
interval = setInterval(function() {
    navigate("next");
}, slideshowSpeed);

}); 
```

以及我的 script.js 文件中的触发代码副本

```
 //index page image preloading code
    var imgArr = new Array( // relative paths of images
        'img/image_1.jpg',
        'img/image_2.jpg',
        'img/image_3.jpg',
        'img/image_4.jpg',
        'img/image_5.jpg',
        'img/image_6.jpg',
        'img/image_7.jpg'
    );

    var preloadArr = new Array();
    var i;

    /* preload images */
    for(i=0; i < imgArr.length; i++){
        preloadArr[i] = new Image();
        preloadArr[i].src = imgArr[i];
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:32:26.503

你可以试试**[哇滑块](http://wowslider.com/)**

它说“您可以为项目符号导航创建缩略图预览”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:23:11.683

我查看了插件代码，您似乎有两个选择：

1.  破解插件代码以允许您需要的东西
2.  选择另一个具有更多选项的插件，例如：http: [//goo.gl/RKYfS](http://goo.gl/RKYfS)

* * *

要将该功能添加到当前插件，您可以尝试以下操作：

1.  首先 - 启用按索引显示图像（将插件中的“导航”功能更新为此）：

    ```
    var navigate = function(direction) {

        // Check if no animation is running. If it is, prevent the action
        if(animating) return;

        // Check which current image we need to show
        if(direction == "next") {
            currentImg++;
            if(currentImg == photos.length + 1) currentImg = 1;
        } 
        else if (direction == "back"{
            currentImg--;
            if(currentImg == 0) currentImg = photos.length;
        }
        else if (typeof direction === 'number') {
            currentImg = direction;
        }

        // Check which container we need to use
        var currentContainer = activeContainer;
        if(activeContainer == 1) activeContainer = 2;
        else activeContainer = 1;

        showImage(photos[currentImg - 1], currentContainer, activeContainer);
    }; 
    ```

2.  第二 - 使用图像索引调用函数：

    ```
    $("#img1").on('click', function() {
        stopAnimation();
        navigate($(this).index());
    }); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:55:48.340

HTML

（假设“circle.png”是 <ooo> 控件图像）

```
<ul>
  <li><a id="slide1"><img src="circle.png" /></a></li>
  <li><a id="slide2"><img src="circle.png" /></a></li>
  <li><a id="slide3"><img src="circle.png" /></a></li>
   ....
</ul> 
```

jQuery

查看插件代码，似乎“currentImg”变量决定了在后台显示哪些图像，因此如果您设置 jQuery 来更改该变量的值，它应该可以解决。

```
$('#slide1').click(function() {
   stopAnimation();
   currentImg = 1;
});

$('#slide2').click(function() {
   stopAnimation();
   currentImg = 2;
});
 .... 
```

... 等等等等。

希望这可以帮助您，或者至少让您走上正轨。可能有点乱，但这就是我的做法。

# google-maps - 模拟谷歌映射在选定的标记处于视图中时缩放行为

> ID：12059026
> 
> 赞同：2
> 
> 时间：2012-08-21T16:14:38.077
> 
> 标签：google-maps, google-maps-api-3

[正如问题在放大地图时保持 InfoWindow in view](https://stackoverflow.com/questions/10496080/)中所指出的那样，v3 API 似乎发生了变化，这会影响 InfoWindows 可见时的默认行为。

Google 在他们自己的地图网站 ( [http://goo.gl/maps/8ymit](http://goo.gl/maps/8ymit "谷歌地图示例") ) 上的默认行为通过以不同方式处理缩放来解决此问题。如果当前选择的标记在视口中可见，则缩放的“中心”似乎设置为标记位置；否则它默认为地图的中心（或者在双击或鼠标滚轮滚动的情况下鼠标的位置）。

如何复制 Google 地图网站的行为？我知道如何获取当前选定标记的位置并判断它是否可见。但是，我没有任何运气将缩放活动的“中心”与设置地图的中心分开设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T21:10:52.180

解决方案涉及大量数学。这是一般大纲：

1.  计算当前缩放级别下当前地图视口的两条边之间显示的物理距离（通常以米为单位）。
2.  确定距标记最近边缘的像素距离。
3.  确定在新缩放级别下当前地图两条边之间显示的距离。
4.  使用步骤 2 中的像素距离，计算新的地图中心应该是什么，以使标记保持在相同的相对位置。
5.  设置地图缩放级别和中心点。

# 资源

*   [在 Pixel 和 LatLng 坐标之间转换](https://developers.google.com/maps/documentation/javascript/maptypes#CustomMapTypes)
*   [球面几何库](https://developers.google.com/maps/documentation/javascript/reference#spherical)

# php - 独特的 PHP 和 HTACCESS 域转发问题

> ID：12059030
> 
> 赞同：1
> 
> 时间：2012-08-21T16:14:50.247
> 
> 标签：php, .htaccess, redirect, http-status-code-301

我有一个托管在 Network Solutions 的站点以及两个域。“OldDomain”过去指向主机帐户，但现在“NewDomain”指向主机。

问题：如果不创建重定向循环，重定向“OldDomain”将不起作用。

我尝试了以下方法：

1）重定向OldDomain（带/不带“www”），并为NewDomain重定向非www：

```
RewriteCond %{HTTP_HOST} ^www.olddomain.com$ [OR]
RewriteCond %{HTTP_HOST} ^olddomain.com$
RewriteCond %{HTTP_HOST} ^newdomain.com [NC]
RewriteRule ^(.*)$ http://www.newdomain.com/$1 [R=301,NC] 
```

2) 使用 PHP 标头重定向：

```
$dom = $_SERVER['HTTP_HOST'];
if(strripos($dom, 'olddomain.com') >= 0) {
header("HTTP/1.1 301 Moved Permanently"); 
header("Location: http://www.newdomain.com/");
} 
```

选项 #1 不执行任何操作。选项 #2 将我置于重定向循环中，即使前两条`RewriteCond`规则已被注释掉。

我之前做过很多 .htaccess 重定向，但是这个让我很头疼，为什么它不正确。这只是网络解决方案问题吗？我从来没有遇到过任何其他主机的问题。顺便说一句，NS 支持告诉我必须付费才能将 OldDomain 转发到 NewDomain，因为它目前没有指向托管包。如果是这样，为什么我不能将两个域都指向同一个托管包，并且至少在索引页的标题中使用 PHP 重定向？

感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T20:12:14.517

选项 1 不执行任何操作，因为您的条件中有此逻辑

*   主机是`www.olddomain.com`
*   **或**主机是`olddomain.com`
*   **和**主机是`newdomain.com`

显然，主机不能既是`newdomain.com`旧域又是旧域之一。尝试添加一个附加`[OR]`的，还有一些`[NC]`：

```
RewriteCond %{HTTP_HOST} ^www.olddomain.com$ [OR,NC]
RewriteCond %{HTTP_HOST} ^olddomain.com$ [OR,NC]
RewriteCond %{HTTP_HOST} ^newdomain.com [NC]
RewriteRule ^(.*)$ http://www.newdomain.com/$1 [R=301,NC] 
```

选项 2，您可以查看主机是否包含`olddomain.com`：

```
if(strripos($dom, 'olddomain.com') >= 0) { 
```

这里的问题是如果找不到字符串，则`strripos()`返回**FALSE**`$dom` （也是 0），这意味着如果是`www.newdomain.com`，它将返回**FALSE**，或者`0`，并且`>= 0`将是 true，从而再次重定向。你需要做这样的事情：

```
if(strlen(strstr($dom, 'olddomain.com')) > 0) { 
```

# ruby-on-rails - 部署到 Heroku 时“无法通过 Bundler 安装 gem”

> ID：12059032
> 
> 赞同：0
> 
> 时间：2012-08-21T16:14:51.977
> 
> 标签：ruby-on-rails, macos, heroku

背景：我正在阅读 Michael Hartl 的“Ruby on Rails 3 Tutorial”一书。我已经到了设置heroku的地步。文本指示我使用 sqlite3，但似乎 heroku 不再允许使用 sqlite3 后端。所以，我正在尝试使用 postgres。

我正在使用 Mac，OS 10.6.8。

问题：我尝试做

```
$ git push heroku master 
```

然后我得到

```
Counting objects: 69, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (55/55), done.
Writing objects: 100% (69/69), 26.69 KiB, done.
Total 69 (delta 5), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.2.0.rc.2
       Running: bundle install --without development:test --path vendor/bundle --    binstubs bin/ --deployment
       You are trying to install in deployment mode after changing
       your Gemfile. Run `bundle install` elsewhere and add the
       updated Gemfile.lock to version control.
       You have added to the Gemfile:
       * pg
       You have deleted from the Gemfile:
       * sqlite3
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

关于“在其他地方运行'捆绑安装'”——在这种情况下，其他地方是什么意思？在另一个目录？我试过了，没有用。也没有要添加的 Gemfile.lock 文件。总结：我很困惑。

======

回应 hgmnz：

```
$ bundle install
Fetching gem metadata from https://rubygems.org/.........
Enter your password to install the bundled RubyGems to your system: 
( --- edited out ---)
Installing pg (0.14.0) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb 
checking for pg_config... yes
Using config values from /sw/bin/pg_config
checking for libpq-fe.h... yes
checking for libpq/libpq-fs.h... yes
checking for pg_config_manual.h... yes
checking for PQconnectdb() in -lpq... no
checking for PQconnectdb() in -llibpq... no
checking for PQconnectdb() in -lms/libpq... no
Can't find the PostgreSQL client library (libpq)
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
( -- edited out --- )

Gem files will remain installed in /Users/adamshaw/.bundler/tmp/14373/gems/pg-0.14.0 for   inspection.
Results logged to /Users/adamshaw/.bundler/tmp/14373/gems/pg-0.14.0/ext/gem_make.out
An error occured while installing pg (0.14.0), and Bundler cannot continue.
Make sure that `gem install pg -v '0.14.0'` succeeds before bundling. 
```

然后

```
$ sudo gem install pg -v '0.14.0' 
```

然后

```
Building native extensions.  This could take a while...
ERROR:  Error installing pg:
    ERROR: Failed to build gem native extension.

        /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb
checking for pg_config... yes
Using config values from /sw/bin/pg_config
checking for libpq-fe.h... yes
checking for libpq/libpq-fs.h... yes
checking for pg_config_manual.h... yes
checking for PQconnectdb() in -lpq... no
checking for PQconnectdb() in -llibpq... no
checking for PQconnectdb() in -lms/libpq... no
Can't find the PostgreSQL client library (libpq)
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
( --- edited out --- )

Gem files will remain installed in /Library/Ruby/Gems/1.8/gems/pg-0.14.0 for inspection.
Results logged to /Library/Ruby/Gems/1.8/gems/pg-0.14.0/ext/gem_make.out 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:35:50.063

嗯，这似乎表明您已经修改`Gemfile`了包含`pg`gem，但还没有运行`bundle install`（在您的开发机器上）来锁定这些 gem。运行`bundle install`将解决所有 gem 依赖项并生成一个新的`Gemfile.lock`. 那是您应该签入 git 然后尝试部署的文件。

在您的开发机器上运行以下命令：

```
bundle install
git add Gemfile.lock
git commit -m "Locking gems"
git push heroku # assumes default remote named heroku 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T21:19:03.437

您需要让 gem 安装程序知道您的 PostgreSQL 安装位置，因为它需要在安装时使用其中一些文件。

查看[在 osx 上安装 pg gem 时出错](https://stackoverflow.com/questions/5762131/error-installing-pg-gem-on-osx)

# android - Android 的连续布局

> ID：12059039
> 
> 赞同：0
> 
> 时间：2012-08-21T16:15:14.257
> 
> 标签：android, android-layout

我有一个任务 - 创建一个单元格网格，以便网格的右边缘连接到网格的左边缘。因此，当用户向右（或向左）滚动时，他永远不会到达停止点。这与地球的旋转方式相似，我不需要 3D 视图，只需要普通的 2D 视图。我应该从哪里开始？有没有关于这个主题的文章？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:22:16.737

最简单的制作方法是自定义 Adapter 使其“无穷无尽”

如果你在网上搜索“无尽适配器”之类的东西，你会想出一些例子

[这是一个Commonsware实现的链接，](https://github.com/commonsguy/cwac-endless)我没有深入挖掘，但看起来ListView可能比GridView更多，但如果是这样，它可能会被修改以支持GridView。

总体思路是让 getSize() 返回 Intenger.MAX，然后在 getItem() 中使用`position % actualSize`来确定需要返回的项目。您必须自己跟踪实际大小，因为您将覆盖内置方法来执行此操作，以便它返回较大的数字。

此外，这里有一个不同的 SO question 处理这个主题： [Endless Gridview](https://stackoverflow.com/questions/10923034/endless-gridview) Commonsware 甚至在那里提供了一个答案，暗示为此目的使用他的 EndlessAdapter。

# javascript - 更改多个 iframe 中的文本框属性

> ID：12059041
> 
> 赞同：2
> 
> 时间：2012-08-21T16:15:15.557
> 
> 标签：javascript, jquery, iframe, textbox

我正在处理的网页有 5 个 iframe，每个 iframe 显示另一个网页。有没有办法一次更改所有 iframe 中某些文本框的属性（例如显示和隐藏）？

像这样的东西：

```
$('iframe').contents().find('input[class=textboxclass]').show; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:10:36.647

`iframe`要在使用中访问文档`.contentDocument.documentElement` 并按类名使用`input.className`或仅`.className`作为选择器进行选择。

```
 $('iframe').each(function(){
    $(this.contentDocument.documentElement)
        .find('input.textboxclass')
        .show();
    }); 
```

**注意**：当然，这必须在所有 iframe 中的内容都已加载后完成。这就是为什么我猜[Ashirvad 的答案](https://stackoverflow.com/a/12059106/448232)使用的原因，`setTimeout()`尽管我必须补充说它并不总是可靠的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:19:39.120

```
setTimeOut(function(){   $('iframe').each(function(){
    $(this)
        .contents()
        .find('input[class=textboxclass]')
        .show();
});),3000); 
```

# java - 蚁耳更新不全爆耳

> ID：12059046
> 
> 赞同：5
> 
> 时间：2012-08-21T16:15:36.923
> 
> 标签：java, ant, ear

我正在使用 ant 1.8.2 并且我有一个很大的 Ear 文件。

需要对耳朵稍作改动，具体取决于安装期间的用户选择。

在安装过程结束时，我运行了一个 ant 脚本，它根据用户的选择更新 ear。这些文件只包含在耳朵里，如果用户有相关的许可……所以更新是必要的。

目前我正在爆炸整个耳朵，添加必要的文件，然后制作更新的耳朵。

我希望找到一种方法来删除和/或添加文件，而无需经历整个解压缩/更新/压缩过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T19:28:56.397

[ear 任务](http://ant.apache.org/manual/Tasks/ear.html)有一个`update`属性，您可以将其设置为 true。

这样文件将被添加到现有的 zipfile 中，而不是创建一个新的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T22:33:19.850

@oers 感谢您的建议，以下是我用来将文件添加到耳朵并替换 application.xml 文件的 POC。

```
<property name="ear.file1"  value="file1.ear"/>
<property name="ear.file2"  value="file2.ear"/>
<property name="text.file1" value="1.txt"/>
<property name="text.file2" value="2.txt"/>
<property name="xml.application1"   value="application.xml"/>
<property name="xml.application2"   value="application2.xml"/>

<target name="clean">
    <delete file="${ear.file1}"/>
    <delete file="${ear.file2}"/>
</target>

<target name="run">
    <!-- simple ear -->
    <ear earfile="${ear.file1}" appxml="${xml.application1}">
        <fileset dir="." includes="${text.file1}"/>
    </ear>  

    <!-- simple ear that will be updated -->
    <ear earfile="${ear.file2}" appxml="${xml.application1}">
        <fileset dir="." includes="${text.file1}"/>
    </ear>  
    <!-- ear update, both application.xml file and add another file. -->
    <ear earfile="${ear.file2}" appxml="${xml.application2}" update="true">
        <fileset dir="." includes="${text.file2}"/>
    </ear>  

</target>

<target name="main" depends="clean,run"/> 
```

# ruby-on-rails-3 - Mongo 连接失败

> ID：12059047
> 
> 赞同：0
> 
> 时间：2012-08-21T16:15:41.077
> 
> 标签：ruby-on-rails-3, cloud-foundry

我是新来的铁路。我想将一个简单的 Rails 应用程序推送到 cloudfoundry，但出现错误：

```
 ====> /logs/stderr.log <====
/var/vcap/data/dea/apps/mytestapp-0
-4a068e3fd2b22422bdd29f3762e9bc9b/app/rubygems/ruby/1.9.1/gems/mongo-
1.6.4/lib/mongo/connection.rb:420:in `connect': Fail:27017  (Mongo::ConnectionFailure) 
```

示例应用程序 gemfile：

```
source 'http://rubygems.org'
gem 'rails', '3.0.5'
gem 'mongo_mapper'
gem 'bson_ext' 
```

mongo.yml：

```
defaults: &defaults
host: 127.0.0.1
port: 27017

development:
<<: *defaults 
database: cloud_foundry_rails_tutorial_development

test:
<<: *defaults
database: cloud_foundry_rails_tutorial_test

# set these environment variables on your prod server
production: 
host: <%= JSON.parse( ENV['VCAP_SERVICES'] )['mongodb-2.0'].first['credentials']['hostname']  
rescue 'localhost' %>

port: <%= JSON.parse( ENV['VCAP_SERVICES'] )['mongodb-2.0'].first['credentials']['port']    
rescue '27017' %>

database: <%= JSON.parse( ENV['VCAP_SERVICES'] )['mongodb-2.0'].first['credentials']['db'] 
rescue 'cloud_foundry_rails_tutorial' %>

username: <%= JSON.parse( ENV['VCAP_SERVICES'] )['mongodb-2.0'].first['credentials']['username'] 
rescue '' %>

password: <%= JSON.parse( ENV['VCAP_SERVICES'] )['mongodb-2.0'].first['credentials']['password'] 
rescue '' %> 
```

上周我可以毫无问题地推送到 CF，但现在它不起作用？CF方面有什么改变吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:20:15.563

CloudFoundry.com 上周从 MongoDB 1.8 升级到 2.0，这可能会影响您的应用程序。如有必要，我将与 CF.com 工程团队核实并提交错误。

但是，由于您在 中手动指定连接信息`mongo.yml`，您是否禁用了服务的自动配置？为此，请创建文件`config/cloudfoundry.yml`并添加：

```
autoconfig: false 
```

有关 Ruby 应用程序中服务自动配置的更多信息，请参阅[http://blog.cloudfoundry.com/2012/03/12/using-cloud-foundry-services-with-ruby-part-1-auto-reconfiguration/](http://blog.cloudfoundry.com/2012/03/12/using-cloud-foundry-services-with-ruby-part-1-auto-reconfiguration/)

# sql - 在where子句中编写SQL case语句

> ID：12059049
> 
> 赞同：0
> 
> 时间：2012-08-21T16:15:49.280
> 
> 标签：sql, case

我有两个表，我在上面执行了内部联接。我有一个场景，我需要根据这两个条件从第一个表中获取值。

我的查询是

```
SELECT rm.ROUTE_ID
            , rm.ROUTE_CODE
            , rm.START_PLACE_ID
            , rm.END_PLACE_ID
            , rm.IS_ACTIVE
            , rm.LINKED_ROUTE
        FROM OPRS_ROUTE_MASTER rm
        INNER JOIN OPRS_ROUTE_HALTS rh
            ON rh.ROUTE_ID = rm.ROUTE_ID
        WHERE rh.PLACE_ID  = '51' 
```

现在我需要在 where 子句中再添加两个条件。

```
case 1: when rm.START_PLACE_ID > 0 then i need to append AND rm.START_PLACE_ID to where clause

case 2: when rm.END_PLACE_ID > 0 then i need to append AND rm.START_PLACE_ID to where clause 
```

如果两者都大于零，那么我需要将这两种情况都附加到 where 子句。

有人可以帮帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:20:00.463

除非我在您的要求中遗漏了某些内容，否则您可以`WHERE`使用`OR`或添加另一个过滤器`AND`

```
SELECT rm.ROUTE_ID
    , rm.ROUTE_CODE
    , rm.START_PLACE_ID
    , rm.END_PLACE_ID
    , rm.IS_ACTIVE
    , rm.LINKED_ROUTE
FROM OPRS_ROUTE_MASTER rm
INNER JOIN OPRS_ROUTE_HALTS rh
    ON rh.ROUTE_ID = rm.ROUTE_ID
WHERE rh.PLACE_ID  = '51'
OR (or AND)
(
    (rm.START_PLACE_ID > 0 OR rm.END_PLACE_ID > 0)
    AND rm.START_PLACE_ID = yourValue
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:22:37.060

大概是这样的？

```
SELECT rm.route_id, 
       rm.route_code, 
       rm.start_place_id, 
       rm.end_place_id, 
       rm.is_active, 
       rm.linked_route 
FROM   oprs_route_master rm 
       INNER JOIN oprs_route_halts rh 
               ON rh.route_id = rm.route_id 
WHERE  rh.place_id = '51' 
       AND ( rm.start_place_id <= 0 
              OR RM.start_place_id = xxx ) 
       AND ( rm.end_place_id <= 0 
              OR RM.start_place_id = yyy ) 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T18:03:18.483

我会设置这样的查询：

```
select rm.ROUTE_ID       ,
       rm.ROUTE_CODE     ,
       rm.START_PLACE_ID ,
       rm.END_PLACE_ID   ,
       rm.IS_ACTIVE      ,
       rm.LINKED_ROUTE
from OPRS_ROUTE_MASTER rm
join OPRS_ROUTE_HALTS  rh on rh.ROUTE_ID = rm.ROUTE_ID
                         and rh.PLACE_ID = '51'
where rm.START_PLACE_ID = case when rm.START_PLACE_ID > 0 then @myStartPlaceID else rm.START_PLACE_ID end
  and rm.END_PLACE_ID   = case when rm.END_PLACE_ID   > 0 then @myEndPlaceID   else rm.END_PLACE_ID   end 
```

如果表格行在所需列 (`START_PLACE_ID`或`END_PLACE_ID`) 中具有正值，则将该列与所需值进行比较，否则将与其自身进行比较。

这避免了使用交替（`OR`运算符）：使用`OR`可以降低执行计划，强制执行表或索引扫描而不是查找。

# php - imagemagick convert 命令在 php 脚本中不能正常工作，但可以从命令行工作

> ID：12059053
> 
> 赞同：2
> 
> 时间：2012-08-21T16:16:06.893
> 
> 标签：php, imagemagick, imagemagick-convert

在 php 中转换的系统调用工作了多年，但今年早些时候停止工作。如果使用 Putty 从命令行发出，我正在使用的所有命令都能正常工作。

我创建的用于调试的测试 php 文件是

```
<?  
$string = "convert  -verbose -resize 200x200  \"startline/main_menu.png\" \"image/temp222_main_menu.png\" ";
passthru($string);
?>

<IMG SRC='image/temp222_main_menu.png '  alt='main_menu'> 
```

未创建输出文件。我得到这个回应

```
startline/main_menu.png PNG 600x1024 600x1024+0+0 8-bit DirectClass 92.1KB 0.020u 0:00.020 
```

如果我用这个替换我的字符串

```
$string = "convert  -version -resize 200x200  \"startline/main_menu.png\" \"image/temp222_main_menu.png\" "; 
```

输出文件已创建但未调整大小。

我得到这个回应：

```
Version: ImageMagick 6.6.0-4 2012-04-26 Q16 http://www.imagemagick.org Copyright: Copyright (C) 1999-2010 ImageMagick Studio LLC Features: OpenMP 
```

有趣的是，这从 2008 年一直有效到今年年初。那可能是我切换到 PHP5 和新服务器的时候，不确定。这是在 1and1.com 上运行的

1and1 的技术支持人员表示，问题在于 outfile 不存在并结案。那不是很有帮助。

我想知道是否需要在我的 php.ini 文件中放入一些东西或其他东西。

* * *

我也试过这个： exec("/usr/bin/convert -resize 200x200 image/temp222_main_menu.png"); ?>

只是一个注释。我输入了详细信息，以便我可以确定我实际上正在运行程序，并且返回了一些输出。它还表明它正在加载正确的文件。这也是我使用 passthru 而不是 exec 或 system 的原因。这只是一个测试脚本。我在它坏掉之前使用的脚本没有使用 passthru，但是要发布的东西太多了。关键是执行的字符串在php中不起作用，但在命令行中起作用，所以它是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T19:37:57.577

您应该尝试这些步骤来调试问题。

**首先，**通过提供所有文件名和命令的完整路径来验证设置是否有效：

```
<?php  
exec("which convert");
?>

<?php  
exec("/path/to/convert  /path/to/a.png  -resize 200x200  /tmp/a200x200.png");
?> 
```

（显然，您必须根据自己的情况调整路径。）

**然后，**检查运行 PHP 的用户帐户是否甚至有权写入目标目录：

```
<?php  
exec("pwd");
exec("touch $(pwd)/image/temp222_main_menu.png");
?> 
```

* * *

我会将您的代码更改为此以使其完全正常工作：

```
<?php  
exec("/usr/bin/convert -resize 200x200  image/temp222_main_menu.png");
?>

<IMG SRC='image/temp222_main_menu.png'  alt='main_menu'> 
```

**笔记...**

1.  ...我删除了该`-verbose`部分（它只在*stderr* `startline/main_menu.png PNG 600x1024 600x1024+0+0 8-bit DirectClass 92.1KB 0.020u 0:00.020`上生成了一个附加行，这可能是 convert 命令从未完成转换的原因。

2.  ...我没有使用您的`-version`修改，因为它在您的上下文中没有意义（而且它也会导致跳过该`-resize`部分）。

3.  ...我删除了您`<IMG SRC=....`行中的一个空格。

4.  ...我切换到`exec(...)`

如果你坚持要在*stderr*输出中添加一些噪音，你可以尝试添加`-monitor`参数而不是`-verbose`...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T00:13:12.387

我刚刚经历了同样的问题。我注意到的真正奇怪的事情是，如果图像恰好是我试图调整大小的确切尺寸，那么它就起作用了。无论如何，这似乎是内存使用的问题，可以通过 PHP 中的配置设置来修复。浏览其他论坛后，我发现了这个并修复了它。

将此行放在调用 imagemagick 的 PHP 脚本的顶部：

```
putenv("MAGICK_THREAD_LIMIT=1"); 
```

# php - For 循环只迭代一次（simplehtmldom）

> ID：12059055
> 
> 赞同：1
> 
> 时间：2012-08-21T16:16:13.090
> 
> 标签：php, screen-scraping, web-scraping, simple-html-dom, phantomjs

我有一个循环 3 次的 for 循环，在循环内，a`shell_exec()`完成，调用二进制文件`phantomjs`并返回其输出。然后将此输出传递到 simplehtmldom 的`str_get_html()`

**问题：**当`str_get_html($html)`涉及到for循环并且`$html`由网页的HTML组成时，只执行第一个循环，而不是第二个或第三个循环。但是，如果我要使用一些简单的`<a>`标签 for `$html`， for 循环会完全迭代！

这里发生了什么，我该如何解决？

*请注意下面 2 个函数的区别（一个有效，一个只循环一次）是其中一个将一行注释掉，另一个将另一行注释掉。*

**父函数** *（`for`这里的循环没有完全迭代）*

```
public function action_asos() {

    // Site details
    $base_url = "http://www.mysite.com";

    // Category details
    $category_id = 7616;
    $per_page = 500;

    // Find number of pages in category
    $num_pages = 2;

    //THIS IS THE LOOP THAT CANNOT LOOP COMPLETELY!
    // Extract Product URLs from Category page
    for($i = 0; $i <= $num_pages; $i++) {
        echo "<h2>Page $i</h2>";
        $page = $i;
        $category_url = 'http://www.mysite.com/pgecategory.aspx?cid='.$category_id.'&parentID=-1&pge='.$page.'&pgeSize='.$per_page.'&sort=1';
        $this->extract_product_urls($category_url, $base_url);
    }
        echo "Yes.";
        flush();

} 
```

**PHP 代码（导致父函数中的循环只循环一次）**

```
public function extract_product_urls($category_url, $base_url) {

    set_time_limit(300);
    include_once('/home/mysite/public_html/application/libraries/simple_html_dom.php');

    // Retrieve page HTML using PhantomJS
    $html = $this->get_html($category_url);

    // Extract links
    $html = str_get_html($html);
    //$html = str_get_html('<a class="productImageLink" href="asdasd"></a>');
    foreach($html->find('.productImageLink') as $match) {
        $product_url = $base_url . $match->href;
        $product_url = substr($product_url, 0, strpos($product_url, '&'));  // remove metadata in URL string
        $this->product_urls[] = $product_url;
    }

    echo "done.";
    flush();

} 
```

**辅助函数**

```
/**
 * Gets the webpage's HTML (after AJAX contented has loaded, using PhantonJS)
 * @return [type] [description]
 */
public function get_html($url) {

    $url = escapeshellarg($url);    // prevent truncating after characters like `&`
    $script = path('base')."application/phantomjs/httpget.js";
    $output = shell_exec("phantomjs $script $url");

    return $output;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:20:46.190

试试这个：

```
while($match = $html->find('.productImageLink')) {
    if (!is_object($match)) {
        break;
    } 
    . 
    . 
    .  
} 
```

# recursion - 递归计算调和平均数和几何平均数

> ID：12059059
> 
> 赞同：1
> 
> 时间：2012-08-21T16:16:33.450
> 
> 标签：recursion

有没有人有一个关于如何递归计算谐波平均值和几何平均值的好例子。是否可以使用尾递归函数？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:57:40.347

您可以使用“递归”定义：

```
G(x1,x2,...,xn) = (x1 * G(x2,...,xn)^(n-1))^(1/n)
H(x1,x2,...,xn) = n / ( 1/x1 + (n-1)/H(x2,...,xn) ) 
```

这不是计算均值的有效方法，因为取幂/乘法执行 n 次。

使用列表作为输入参数 (N) 的简单 python 实现：

```
def G(N):
  if len(N) == 1: return N[0]
  return (N[0] * G(N[1:])**(len(N)-1))**(1/len(N))

def H(N):
  if len(N) == 1: return N[0]
  return len(N) / ( 1/N[0] + (len(N)-1)/H(N[1:]) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-12T15:24:03.297

对于几何平均值，我不能使用@Ante 的方法，因为在我的情况下，1）产品对于浮点数来说太小了，2）我一次都无法阅读完整的系列，但我发现了一个值一。因此，我找不到比使用对数更好的解决方案：

```
int iCount(0);
float GMeanLog(0);
for (int i=1;i<n;i++)
{
if (iCount > 0)
{
    iGMeanLog = GMeanLog+(log(val[i])-GMeanLog)/iCount;
    iCount++;
}
else
{
    iCount++;
    GMeanLog = log(val[i]);
}
} 
```

# c - C 在 struct free() 中动态分配 struct

> ID：12059065
> 
> 赞同：0
> 
> 时间：2012-08-21T16:16:45.980
> 
> 标签：c, struct, malloc, free

我有两个结构，“link_time”和“vehicle_information”，我在交通模拟插件中使用它们。我很难为我创建的两个自定义结构正确释放（和分配？）内存。

```
//global vardeclarations
//GLOBAL_VEHICLE_INFO contains all of the "vehicle_information" structs             
//representing all of the vehicles within the simulation
vehicle_information_template* GLOBAL_VEHICLE_INFO;
int lengthGLOBALVEHICLE;

vehicle_information_template* TEMP_VEHICLE_INFO;

//struct definitions
typedef struct link_time{

     float link_duration;
     float timestamp;

}link_time_template;

 typedef struct vehicle_information{
     int id;
     int current_link_id;
     float start_time;
     link_time_template* ltt; //individual vehicle link travel times array

}vehicle_information_template;

//function to add new "vehicle_information_template" to GLOBAL_VEHICLE_ARRAY
vehicle_information_template* addToGlobalVehicleArray(vehicle_information_template* target_array, int array_length, vehicle_information_template new_vinfo){
    int k;

    //allocate space for temp holding array, both the 'vehicle_information' struct and the 'link_time' struct within 'vehicle_information' struct

    TEMP_VEHICLE_INFO = malloc( sizeof(vehicle_information_template) * (array_length+1) );
    for(k=0;k<array_length+1;k++){
        TEMP_VEHICLE_INFO[k].ltt = malloc( sizeof(link_time_template) * NUM_LINKS);
    }

    //copy contents so that target_array can be free'd and resized
    for(k=0;k<array_length;k++){
        TEMP_VEHICLE_INFO[k] = target_array[k];
    }

    //add the new vehicle_info to the end of the TEMP_VEHICLE_INFO(newly resized)
    TEMP_VEHICLE_INFO[array_length] = new_vinfo;

       //****BREAKS HERE *****
    //free target_array (GLOBAL_VEHICLE_ARRAY) so that it can be resized to one element larger
//free the struct in the reverse order, freeing 'ltt' first, as it is a member of the larger struct 'vehicle_info'
    for(k=0;k<array_length;k++){
        free(target_array[k].ltt);
    }
    free(target_array);

    //reallocate GLOBAL_VEHICLE to 1 size larger to accomodate new element
    target_array = malloc(sizeof(vehicle_information_template) * (array_length+1) );
    //allocate space for "link_time" struct within "vehicle_information" struct
    for(k=0;k<array_length+1;k++){
        target_array[k].ltt = malloc(sizeof(link_time_template) * NUM_LINKS);
    }
    //copy contents from temp array to global array
    for(k=0;k<(array_length+1);k++){
        target_array[k] = TEMP_VEHICLE_INFO[k];
    }
    //free temp array struct
    for(k=0;k<array_length;k++){
        free(TEMP_VEHICLE_INFO[k].ltt);
    }
    free(TEMP_VEHICLE_INFO);
    //return newly sized global array
    return target_array; 
```

}

“vehicle_information”包含一个指针，用于分配动态大小的“link_time”数组。我在其他堆栈帖子中读到，如果我将指针声明为结构的最后一个成员，那么我可以控制这个成员，就好像它是一块动态内存（malloc、realloc、free）。我也知道每个 malloc 都需要一个免费的，我相信我做得对。

我为 'vehicle_info' 结构分配了内存，然后在 'vehicle_info' 中分配了 'link_time' 结构 'ltt'。我会假设我以相反的顺序释放，因为'ltt'在内存中链接到'vehicle_info？但是当我到达函数“vehicle_information_template* addToGlobalVehicleArray()”中的以下行时，HEAP 会抱怨并且我的程序崩溃：

```
 //free target_array (GLOBAL_VEHICLE_ARRAY) so that it can be resized to one element larger
//free the struct in the reverse order, freeing 'ltt' first, as it is a member of the larger struct 'vehicle_info'
    for(k=0;k<array_length;k++){
        free(target_array[k].ltt);
    }

    free(target_array); 
```

每次车辆进入模拟时，都应将其添加到“GLOBAL_VEHICLE_INFO”数组中。伪代码如下：

```
 ...
    //***vehicle enters network

    vehicle_information_template temp_v;
    int k;
    //set temp_v to the newly released vehicle's information so it can be added to GLOBAL_VEHICLE_INFO
    temp_v.id = qpg_VHC_uniqueID(v);
    temp_v.current_link_id = qpg_LNK_index(qpg_VHC_link(v));
    temp_v.start_time = -1.0;

    //allocate memory for temp_v.ltt
    temp_v.ltt = malloc(sizeof(link_time_template) * NUM_LINKS);
    //set link_duration and timestamp to dummy values
    for(k=1;k<=NUM_LINKS;k++){
        temp_v.ltt[k].link_duration = -1.0;
        temp_v.ltt[k].timestamp = -1.0;
    }

 //add temp_v to "GLOBAL_VEHICLE_INFO" using function
    GLOBAL_VEHICLE_INFO = addToGlobalVehicleArray( GLOBAL_VEHICLE_INFO, lengthGLOBALVEHICLE, temp_v);
    lengthGLOBALVEHICLE++;

    //free allocated temp_v.ltt (link_travel_time)
    free(temp_v.ltt); 
```

如果有人对我如何处理指针或内存有任何解决方案或建议，我会尽量做到对称，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:44:57.413

我在函数的第一行中看到了问题`addToGlobalVehicleArray`-您分配了内存，但随后又被代码行`TEMP_VEHICLE_INFO[k].ltt`覆盖而丢失了它。`TEMP_VEHICLE_INFO[k] = target_array[k]`

还建议使您的代码更加结构化 - 引入单独的函数`create_link_time_array()`/ `free_link_time_array()`，`create_veh_info_array()`/`free_veh_info_array()`以将服务代码从主控制流中移开，并使代码更加清晰易读。这将极大地帮助您避免此类问题。

或者更好 - 使用 C++ 并忘记这个手动内存控制地狱。

# c# - 以编程方式更改程序图标

> ID：12059066
> 
> 赞同：1
> 
> 时间：2012-08-21T16:16:56.390
> 
> 标签：c#, windows-7, windows-xp, icons

我正在开发 VS 2010/C#。

有谁知道如何以编程方式更改软件图标？

我实际上希望我的软件在同一软件安装中在 Windows 7 下有一个图标，在 Windows XP 下有另一个图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:58:56.090

如果是 winform 应用程序，您可以在主窗体的 formload 事件中编写以下代码。

使用此链接查找操作系统： [http ://andrewensley.com/2009/06/c-detect-windows-os-part-1/](http://andrewensley.com/2009/06/c-detect-windows-os-part-1/)

然后编写下面的代码来设置图标。

```
private void InvestorReportingFormLoad(object sender, EventArgs e)
        {
            this.Icon = Properties.Resources.coins;            
        } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-12-12T06:21:51.570

```
 this.Icon = Icon.ExtractAssociatedIcon(@"Stringpath"); 
```

# symfony - 致命错误：达到“100”的最大函数嵌套级别，正在中止

> ID：12059067
> 
> 赞同：0
> 
> 时间：2012-08-21T16:16:57.300
> 
> 标签：symfony, doctrine-orm, query-builder

我有这个实体：

```
Invoice hasMany PlannedCharge
PlannedCharge hasMany PartialCharge 
```

我需要知道发票是否已全额支付，以下 sql 也是如此：

```
SELECT 
    Invoice.id
FROM
    webfactory_sale_invoices Invoice
    AND
        0 <> 
        ((SELECT 
            SUM(PlannedCharge.ammount)
        FROM
            webfactory_sale_planned_charges PlannedCharge
        WHERE
            PlannedCharge.invoice_id = Invoice.id
        GROUP BY Invoice.id) - IFNULL((SELECT 
            SUM(PartialCharge.ammount)
        FROM
            webfactory_sale_planned_charges PlannedCharge
                INNER JOIN
            webfactory_sale_partial_charges PartialCharge ON PlannedCharge.id = PartialCharge.planned_charge_id
        WHERE
            PlannedCharge.invoice_id = Invoice.id
        GROUP BY Invoice.id), 0)) 
```

现在，通过 querybuilder 以这种方式转换为 DQL：

```
$qb->andWhere($qb->expr()->neq(0, $qb->expr()->diff(
    $qb->select('SUM(PlannedCharge.ammount)')
            ->from('WebFactorySaleBundle:PlannedCharge', 'PlannedCharge')
            ->where("PlannedCharge.invoice = {$invoiceAlias}")
            ->groupBy($invoiceAlias)
            , 
    $qb->select('SUM(PartialCharge.ammount)')
            ->from('WebFactorySaleBundle:PlannedCharge', 'PlannedCharge')
            ->innerJoin('WebFactorySaleBundle:PartialCharge', 'PartialCharge')
            ->where("PlannedCharge.invoice = {$invoiceAlias}")
            ->groupBy($invoiceAlias)
    )
)); 
```

我收到错误消息：致命错误：达到“100”的最大函数嵌套级别，正在中止！

我怎么写这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:51:37.930

我会更像这样：

```
SELECT 
    i.id, sum_planned, sum_partial, sum_planned - ifnull(sum_partial,0) AS saldo
FROM
    (SELECT id
    FROM webfactory_sale_invoices
    GROUP BY id
    ) i LEFT OUTER JOIN
    (SELECT 
         id, SUM(ammount) AS sum_planned
    FROM
        webfactory_sale_planned_charges 
    GROUP BY 
        id) pl ON 
        i.id = pl.id LEFT OUTER JOIN        
    (SELECT 
        id, SUM(ammount) AS sum_partial
    FROM
        webfactory_sale_partial_charges 
    GROUP BY 
        id) pa ON i.id = pa.id 
```

# xcode - Xcode 是否删除了 scm 图标？

> ID：12059070
> 
> 赞同：0
> 
> 时间：2012-08-21T16:17:05.270
> 
> 标签：xcode, svn, xcode4

我们使用 1.7 的 svn 服务器。但是我安装了 1.7 命令行。我已经将 Xcode 包中的 svn 应用程序软链接到 opt 版本。

我在管理器窗口中为我的存储库亮了绿灯，我可以更新。

我还可以在项目导航器中过滤源代码状态。但修改后的文件不会出现 SCM 修改图标。

这是 Xcode 4.4 中的更改还是错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:22:42.407

这不是 Xcode 4.4 的变化。对于 git 和本地 Subversion 存储库，SCM 图标出现在项目导航器中的文件旁边。还有其他问题，但我不知道它是什么。

# c - c中没有堆？

> ID：12059073
> 
> 赞同：32
> 
> 时间：2012-08-21T16:17:26.860
> 
> 标签：c, malloc

我刚开始阅读Brian Kernighan 和 Dennis Ritchie*的 The C Programming Language*，我发现了这个语句：

> 除了静态定义和函数的局部变量提供的堆栈规则之外，该语言没有定义任何存储分配工具；**没有堆**或垃圾收集。

那么这是否意味着由于`malloc()`函数从堆中返回一些内存地址，C 才喜欢访问堆内存？然后必须`malloc`用其他语言编写，很可能是汇编还是B？

这可能是一个愚蠢的怀疑，但我必须清除它。谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-21T16:21:43.333

C*语言*本身并没有直接指定堆或它应该如何工作，但确实提供了指针等。

`malloc`它的表兄弟是 C 标准库的一部分，并且是与 C 的任何标准实现链接的函数，它们*确实*提供对非静态或堆栈上的内存的访问。在每个平台上，这些函数实际获取和管理内存的方式可能不同。

C 是一门久负盛名的语言和库，现在它们似乎是一个整体。但是当 K&R 编写那本书时，这并不是那么明显，并且该声明澄清了属于语言本身的语法（相对于支持库通常提供的）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-21T16:22:10.373

我认为作者在谈论“语言”时非常准确。当您谈论 C 时，您拥有语言和标准库。在语言本身中，没有动态内存分配工具，但标准库提供了这些工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-21T16:21:01.340

语言中没有明确定义堆。但是，实现确实将它用于动态分配的内存。

请参阅有关各种分配的讨论，包括堆：

[http://en.wikipedia.org/wiki/C_dynamic_memory_allocation](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-21T16:19:22.470

malloc 从操作系统内核获取分配给它的内存。所有语言都这样做。这就是操作系统如何确保程序有可用空间的方式，尽管它不会或可能不会阻止它们，尤其是那些用 C 编写的程序，试图超越任何限制。

# mysql - 如何使用 SSL 连接对 Mysql 运行 Sequel 迁移

> ID：12059075
> 
> 赞同：1
> 
> 时间：2012-08-21T16:17:28.000
> 
> 标签：mysql, ruby, ssl, sequel

我正在尝试针对需要用户名/密码和 ssl 连接的 mysql 数据库运行迁移。如何参考 ca 证书进行 ssl 连接？如果我运行以下命令，它会上升`Error: Sequel::DatabaseConnectionError: Mysql::ServerError::AccessDeniedError: Access denied`

```
sequel -m db/migrations mysql://root:password@localhost/test 
```

我试图在命令行中添加 sslca= 参数，但没有接缝工作。

更新

是的，抱歉，如下所示，您可以看到工作和不工作的代码：

1）我使用连接到我的数据库的红宝石代码完美地工作

```
connection = Sequel.mysql2(
  "db_name",
  :user => "username",
  :password => "password",
  :host => "host",
  :port => "port",
  :sslca => File.expand_path(File.join('path', 'to', 'ca.pem')),
  :max_connections => 1
) 
```

2）这是不起作用的代码，我尝试将参数传递`sslca`为 --sslca= 带引号和不带引号但没有一个我可以建立连接

```
sequel -m db/migrations mysql://root:password@localhost/test sslca="path/to/ca.pem" 
```

我回来的错误是：

```
Error: Sequel::DatabaseConnectionError: Mysql2::Error: Access denied for user 'username'@'host' (using password: YES)/path/to/gems/mysql2-0.3.11/lib/mysql2/client.rb:44:in `connect' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:53:30.693

Sequel 的 mysql 适配器将以下 ssl 参数传递给 ruby​​-mysql 库：sslkey、sslcert、sslca、sslcapath、sslcipher。我不确定是否仅 sslca 就足够了，您可能还需要其他选项之一。

如果你不能让它与 Sequel 一起工作，我建议尝试直接使用 ruby​​-mysql 让它工作。如果你可以让它与 ruby​​-mysql 一起工作，但不能与 Sequel 一起工作，请告诉我如何，我可能也可以让它在 Sequel 中工作。

# android - Android：是否可以创建空心（空心）布局？

> ID：12059078
> 
> 赞同：1
> 
> 时间：2012-08-21T16:17:33.070
> 
> 标签：android, layout

抱歉，如果我的主题令人困惑，我不确定应该使用哪些词来描述我需要的布局。

目前，我正在做一个需要在地图视图上覆盖空心布局的项目，空心布局将用于显示远距离位置点，我发布了一张图片来说明我的意思。

![带有描边覆盖的地图视图](../Images/56a98e7c0bc8ae0f95cb369a23c4d9ba.png)

基本上整个屏幕都由 Mapview 填充，并且覆盖布局应该覆盖它而不覆盖中心，就像我在图像中显示的那样。

这是 xml 显示我为制作上述布局所做的工作

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<com.google.android.maps.MapView
android:id="@+id/MapView"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:enabled="true"
android:clickable="true"
android:apiKey="..."
/>

   <View
   android:layout_width="320dip"
   android:layout_height="50dip"
   android:layout_gravity="center_horizontal|top"
   android:background="#800ff4ff"
   android:textColor="#ffffffff" />

 <View
    android:layout_width="320dip"
    android:layout_height="50dip"
    android:layout_gravity="center_horizontal|bottom"
    android:background="#800ff4ff"
    android:textColor="#ffffffff"
  />

<View
    android:layout_width="50dip"
    android:layout_height="520dip"
    android:layout_gravity="center_vertical|right"
    android:background="#800ff4ff"
    android:textColor="#ffffffff" />

 <View
    android:layout_width="50dip"
    android:layout_height="520dip"
    android:layout_gravity="center_vertical|left"
    android:padding="20dip"
    android:background="#800ff4ff"
    android:textColor="#ffffffff" />

</FrameLayout> 
```

我使用框架布局来允许布局可以覆盖其他布局，并在每个边缘创建 4 个单独的以模拟我真正想要的（中心为空）。我只是不确定谁让布局只显示 4 面并保持中心不可见，如果有人可以帮助，请给我一些指导。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T21:35:28.863

您可以使用另一个简单的选项来满足您的要求。

*   创建具有定义形状的新可绘制资源。调用此资源（XML 文件）：*margin_border.xml*并将其放在 drawable 文件夹下。此 XML 的内容：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <shape xmlns:android="http://schemas.android.com/apk/res/android"
        android:shape="rectangle" >

        <stroke
            android:width="50dp"
            android:color="#800ff4ff" />

        <solid android:color="#00000000" />

    </shape> 
    ```

    **说明：** 此形状将充当您内部布局的边框/框架。作为边框的“stroke”属性可以是您想要的任何颜色，而“solid”属性具有透明颜色。

*   然后在你的主布局中使用这个形状：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <com.google.android.maps.MapView
            android:id="@+id/MapView"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:apiKey="..."
            android:clickable="true"
            android:enabled="true" />

        <!-- Set hollow layout -->
        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:background="@drawable/margin_border"
            android:padding="50dp" >
        </LinearLayout>

    </RelativeLayout> 
    ```

    **说明：** 主要布局是RelativeLayout。MapView 没有改变，除了所有方向的 alignParent 标志设置为 true，就像这里显示的一样。

    最后使用您想要的任何布局作为中心。我在背景引用可绘制形状时使用了 LinearLayout。

    注意：此布局的内边距必须与形状中的笔划宽度相同。在这种情况下，它是 50dp

这是它在我的手机上的样子（截图）：

![在此处输入图像描述](../Images/bd7c15344e2bea6c13b3168d43d482e0.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T21:22:28.187

您可以使用 FrameLayout 来实现这一点，但 framelayout 不像线性布局和相对布局那样给您太多的自由。因此，我建议您使用其中一种布局作为容器，并使用**可绘制的形状**作为背景。可绘制的形状将产生所需的效果。
这是形状可绘制的示例代码：

```
 <?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" >
    <solid
        android:color="#00000000" />
    <stroke 
        android:width="50dp"
        android:color="#ae00ffff"/>
</shape> 
```

在这里，笔画充当屏幕上的半透明区域。您可以更改宽度以符合您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T18:43:29.913

我的建议是您使用这样的 RelativeLayout：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<MapView android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

</MapView>

<FrameLayout
    android:id="@+id/top"
    android:layout_width="fill_parent"
    android:layout_height="50dip" >
</FrameLayout>

<FrameLayout
    android:id="@+id/bottom"
    android:layout_width="fill_parent"
    android:layout_height="50dip"
    android:layout_alignParentBottom="true" >
</FrameLayout>

<FrameLayout
    android:id="@+id/left"
    android:layout_width="50dip"
    android:layout_height="wrap_content"
    android:layout_above="@id/bottom"
    android:layout_below="@id/top" >
</FrameLayout>

<FrameLayout
    android:id="@+id/right"
    android:layout_width="50dip"
    android:layout_height="wrap_content"
    android:layout_above="@id/bottom"
    android:layout_alignParentRight="true"
    android:layout_below="@id/top" >
</FrameLayout>

</RelativeLayout> 
```

至少这是我能想到的最简单的方法！

# windows - Windows phone7：为每个状态创建具有不同背景图像的自定义按钮

> ID：12059079
> 
> 赞同：1
> 
> 时间：2012-08-21T16:17:41.803
> 
> 标签：windows, windows-phone-7, windows-phone-7.1, expression-blend

在我的 Windows phone7 应用程序中，我只需为按钮的每种状态（正常、鼠标悬停、按下、禁用）创建一个具有不同图像的自定义按钮。

如果我只想为具有不同背景颜色的每个状态创建一个自定义按钮，那么我将按照以下步骤完成此操作。

```
1\. Open the page with Expresion Blend
2\. Right click button -> Edit Template -> Edit a copy
3\. Select Background (In the "Objects and Timeline" Section)
4\. Select each "state" under the "state" tab and start adding backgroung color with the  "Pressed" state from the properties pannel.

* Ultimately Can add this as follows for all the buttons which require this custom style
Style="{StaticResource ButtonStyle1}" 
```

我尝试根据上述步骤以类似的方式为每个状态分配背景图像。

但问题是，当我自动添加一个状态所需的图像时，它也适用于所有其他状态。所以最终它最终为所有状态添加了相同的图像（最后为任何状态添加了图像）。

如果有人能解释在 windows phone7 的表达式混合中为每个状态创建具有不同图像的自定义按钮必须遵循的步骤，我将不胜感激。提前致谢....！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T18:00:07.233

添加图像时，您基本上是在设置按钮模板的外观，它与按钮状态无关。要实现您想要的，您可以创建一个包含两个图像的按钮模板，然后使用状态来显示或隐藏相应的图像。

```
1\. Edit Button Template
2\. Add images to the Grid level of the template
3\. Highlight each image item and Send to Back to make sure they are behind your border/content
4\. Select a State (e.g. Normal, Pressed), highlight one of the images and set the Visibility property to Visible.  Highlight the other image and set the Visibility property to Collapsed.
5\. Select the other States and do something similar depending on what you what shown. 
```

您的 XAML 应该看起来像这样。为简洁起见，删除了一些内容。

```
<ControlTemplate TargetType="Button">
<Grid Background="Transparent">
    <VisualStateManager.VisualStateGroups>
        <VisualStateGroup x:Name="CommonStates">            
        <VisualState x:Name="Normal">
            <Storyboard>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="image1">
                    <DiscreteObjectKeyFrame KeyTime="0">
                        <DiscreteObjectKeyFrame.Value>
                            <Visibility>Visible</Visibility>
                        </DiscreteObjectKeyFrame.Value>
                    </DiscreteObjectKeyFrame>
                </ObjectAnimationUsingKeyFrames>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="image2">
                    <DiscreteObjectKeyFrame KeyTime="0">
                        <DiscreteObjectKeyFrame.Value>
                            <Visibility>Collapsed</Visibility>
                        </DiscreteObjectKeyFrame.Value>
                    </DiscreteObjectKeyFrame>
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </VisualState>
        <VisualState x:Name="Pressed">
            <Storyboard>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="image1">
                    <DiscreteObjectKeyFrame KeyTime="0">
                        <DiscreteObjectKeyFrame.Value>
                            <Visibility>Collapsed</Visibility>
                        </DiscreteObjectKeyFrame.Value>
                    </DiscreteObjectKeyFrame>
                </ObjectAnimationUsingKeyFrames>
                <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="image2">
                    <DiscreteObjectKeyFrame KeyTime="0">
                        <DiscreteObjectKeyFrame.Value>
                            <Visibility>Visible</Visibility>
                        </DiscreteObjectKeyFrame.Value>
                    </DiscreteObjectKeyFrame>
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </VisualState>
        </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
    <Image x:Name="image1" HorizontalAlignment="Left" Margin="0,0,0,24" Source="/Images/image1.png" Stretch="Fill" Width="48"/>
    <Image x:Name="image2" HorizontalAlignment="Left" Margin="0,0,0,24" Source="/Images/image2.png" Stretch="Fill" Width="48"/>
    <Border x:Name="ButtonBackground" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="0" Margin="{StaticResource PhoneTouchTargetOverhang}">
        <ContentControl x:Name="ContentContainer" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" Padding="{TemplateBinding Padding}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
    </Border>
</Grid> 
```

# c++ - 带有 XULRunner 15 的 Linux 上的 XRE_InitEmbedding2 SIGSEGV

> ID：12059083
> 
> 赞同：0
> 
> 时间：2012-08-21T16:18:04.443
> 
> 标签：c++, linux, gtk, xulrunner, segmentation-fault

**一般**：

当使用 XULRunner 15 调用 XRE_InitEmbedding2 函数时，我总是在 Linux 上收到 SIGSEGV。

**详情**：

我正在尝试将 Mozilla（XULRunner 15.05b 64 位）浏览器组件嵌入到我在 Fedora 12 64 位上的 GTK 应用程序中。我创建了 Eclipse 项目，将其配置为使用所有必需的 XULRunner 库和包含文件并成功构建它。

这是应用程序代码：

```
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <gtk/gtk.h>

#include "nsXPCOM.h"
#include "nsXPCOMGlue.h"
#include "nsEmbedString.h"
#include "nsXULAppAPI.h"
#include "nsILocalFile.h"

using namespace std;

XRE_InitEmbedding2Type XRE_InitEmbedding2Delegate;

int main(int argc, char** argv) {

    nsDynamicFunctionLoad kXRESymbols[] = {
        {"XRE_InitEmbedding2", (NSFuncPtr*) &XRE_InitEmbedding2Delegate},
        {0, 0}
    };

    GtkWidget *window;
    gtk_init(&argc, &argv);

    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_widget_show(window);

    nsresult rv = XPCOMGlueStartup("/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/bin/libxpcom.so");
    if (NS_FAILED(rv)) {
        return rv;
    }

    rv = XPCOMGlueLoadXULFunctions(kXRESymbols);
    if (NS_FAILED(rv)) {
        return rv;
    }

    nsILocalFile *libXULDir;
    rv = NS_NewNativeLocalFile(nsEmbedCString("/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/bin"), PR_FALSE, &libXULDir);
    if (NS_FAILED(rv)) {
        return rv;
    }

    rv = XRE_InitEmbedding2Delegate(libXULDir, libXULDir, nsnull);
    if (NS_FAILED(rv)) {
        return rv;
    }
    cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
    return 0;
} 
```

我使用以下命令行编译了这个应用程序：

```
make all 
Building file: ../src/JavaXPCOMTest.cpp
Invoking: GCC C++ Compiler
g++ -DXPCOM_GLUE_USE_NSPR=1 -DXPCOM_GLUE=1 -I/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/include -I/usr/include/gtk-2.0 -I/usr/include/glib-2.0 -O0 -g3 -Wall -c -fmessage-length=0 -std=gnu++0x `pkg-config --cflags --libs gtk+-2.0` -MMD -MP -MF"src/JavaXPCOMTest.d" -MT"src/JavaXPCOMTest.d" -o"src/JavaXPCOMTest.o" "../src/JavaXPCOMTest.cpp"
Finished building: ../src/JavaXPCOMTest.cpp

Building target: JavaXPCOMTest
Invoking: GCC C++ Linker
g++ -L/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/lib -L/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/bin -Wl,-rpath-link,/home/Victor/Projects/JavaXPCOM/xulrunner-sdk/bin -o"JavaXPCOMTest"  ./src/JavaXPCOMTest.o   -lxpcomglue -lstdc++ `pkg-config --cflags --libs gtk+-2.0`
Finished building target: JavaXPCOMTest 
```

当我运行此应用程序时，我会在使用以下调用堆栈调用 XRE_InitEmbedding2Delegate 函数时收到 SIGSEGV：

```
Thread [1] 15449 (Suspended : Signal)   
    _dl_fixup() at 0x3dbd60dbec 
    _dl_runtime_resolve() at 0x3dbd614315   
    0x7fffee4031d3  
    0x7fffee429209  
    0x7fffee429223  
    0x7fffee42a943  
    0x7fffee42b7ae  
    0x7fffee42bb25  
    NS_InitXPCOM2_P() at 0x7fffee4063a9 
    XRE_InitEmbedding2() at 0x7fffed998ce7  
    <...more frames...> 
```

有人用 XULRunner 15 在 Linux 平台上重现了类似的问题吗？也许我使用了一些错误的命令行参数或者忘记在命令行中包含一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T15:40:02.980

它可能与这个[未答复的错误报告](https://groups.google.com/forum/?fromgroups=#!topic/mozilla.dev.embedding/TE2K5_3YvoQ)有关：

> 从 Firefox 10 开始，我们在创建（构造） MozApp 对象时遇到了崩溃。更准确地说，崩溃是通过调用 API 'XRE_InitEmbedding2()'（它的函数指针是有效的！）...直到 Firefox 版本 9，我们没有出现这种崩溃 - 仅从版本 10 开始。您可以在以下错误报告： [https ://bugzilla.mozilla.org/show_bug.cgi?id=724822](https://bugzilla.mozilla.org/show_bug.cgi?id=724822)

您也许可以使用嵌入式 API。但是无论如何，使用 gtkmozembed 注定要失败，因为作者正在撤回对它的所有支持，因此您发现的任何问题**都不会得到解决**：

*   mozilla.dev.embedding[中二进制嵌入公告的未来](https://groups.google.com/forum/#!topic/mozilla.dev.embedding/c_NMcO-N8wo/discussion)
*   [Ubuntu 退出 gtkmozembed](https://lists.ubuntu.com/archives/ubuntu-devel/2011-May/033229.html)

[WebKitGTK](http://webkitgtk.org/)通常用作替代浏览器组件（基于 WebKit），尽管我发现它在通过 NPAPI 运行 Adob​​e Flash 插件时不稳定。如果你能忍受它的限制，gtkhtml 会更简单，因此更可靠，可能更适合你。

最后，对于任何来到这里寻找 gtkmozembed 在 xulrunner 中与 SIGSEGV 崩溃的解决方案的人（就像我一样），答案可能是您忘记运行您的应用程序`run-mozilla.sh`，它[告诉 Mozilla 在哪里可以找到它的组件](https://bugzilla.mozilla.org/show_bug.cgi?id=358926#c5)。

# c - 常量指针应该被取消引用吗？

> ID：12059086
> 
> 赞同：2
> 
> 时间：2012-08-21T16:18:12.457
> 
> 标签：c, constants

在下面的代码中：

```
int a=5,b=6,c=7;;
int *const ptr = &a;

//if ptr = &b; is wrong since it is a pointer constant. 
```

引用指针是否适用？

```
*ptr = 8; //is it allowed? 
```

如果不是，那为什么？

那么顺从适用于哪些地方呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T16:21:56.613

```
int *const ptr = &a; 
```

在这种情况下，指针是常量，但它指向的数据不是常量。
所以你不能让指针指向其他变量，但你可以修改指向的值。

```
*ptr = 8; 
```

是允许的，因为它只更改存储在指针指向的地址处的值。

# php - php 用一个布尔变量修改表达式返回值

> ID：12059091
> 
> 赞同：1
> 
> 时间：2012-08-21T16:18:29.500
> 
> 标签：php, boolean

这听起来可能很幼稚，但在 PHP 中，是否可以用一个布尔值修改表达式的结果？

例如：

```
if(expression)
     //execute code 
```

现在，我该怎么做？

```
if(!expression)
    //execute code 
```

与另一个布尔值的控制？

像：

```
$bool = true;
if( ($bool? :!)expression ) // if($bool) => !expresion ; if(!$bool) => expression 
    //execute code 
```

所以基本上我想要拥有`!expression`什么时候`$bool`是真的，`expression`什么时候 $bool 是假的

我知道我可以：

```
$bool ? !expression : expression 
```

但它有两次相同的表达......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:26:26.373

所以基本上你想通过测试`$bool`是真的还是`expression`真的，但不是两者兼而有之。异或的教科书定义：

```
if( $bool xor expression)
    // execute code 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:23:33.127

```
if (expression == $bool) 
```

或许

```
if (expression != $bool) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T16:34:05.913

我不确定我是否理解你，但你可以将表达式的结果存储在变量中：

```
<?php
    $bool = false;
    $result = (1 == 2 || 1 == 1);
    if ($bool && !$result) {
    //do stuff
    echo '1';
    } else if (!$bool && $result) {
    //other stuff
    echo '2';
    } else {
    echo '3';
    }
?> 
```

或许

```
$bool = false;
$result = (1 == 2 || 1 == 1);
$newVar = ($bool ? !$result : $result); 
```

或者使用 eval 但这有点棘手。

# xslt - XLST 如何通过属性匹配两个 XML 节点？

> ID：12059093
> 
> 赞同：1
> 
> 时间：2012-08-21T16:18:46.890
> 
> 标签：xslt

我有一个我正在尝试转换的 XML，其中包含不同节点之间的关系，通过 ID 相关，但我不知道如何将它们“粘合”在一起。

XML 示例：

```
<order>
 <products>     
  <product id="1234">
   <item quantity="5" colour="red">
   <item quantity="2" colour="blue">
  </product> 
  <product id="9876">
   <item quantity="10" colour="teal">
  </product>
 </products>

 <prices>
  <productprice>
   <refProduct id="1234" />
   <price gross="9.99" />
  </productprice>
  <productprice>
   <refProduct id="9876" />
   <price gross="6.89" />
  </productprice>
 </prices>
</order> 
```

我想要的结果是能够通过 for-each 展示产品，并在旁边列出各自的价格。

感激地收到任何线索。

编辑：固定的叛徒产品元素，示例应该是正确的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:43:25.253

这是一个简单的概念证明，用于建立您想要的连接。输入 XML 格式不正确，因此我假设只有一个 products 元素，具有多个 product 子元素。

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <products>
            <xsl:for-each select="order/products/product">
                <product>
                    <xsl:variable name="productid" select="@id"/>
                    <xsl:attribute name="id">
                        <xsl:value-of select="$productid"/>
                    </xsl:attribute>
                    <xsl:attribute name="price">
                        <xsl:value-of
                            select="/order/prices/productprice[refProduct[@id = $productid]]/price/@gross"/>
                    </xsl:attribute>
                </product>
            </xsl:for-each>
        </products>
    </xsl:template>
</xsl:stylesheet> 
```

它导致以下输出：

```
<?xml version="1.0" encoding="utf-8"?>
<products>
    <product id="1234" price="9.99"/>
    <product id="9876" price="6.89"/>
</products> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:52:52.640

您的 XML 格式不正确，因此很难准确回答问题。但也许是这样的？

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <out>
      <xsl:apply-templates/>
    </out>
  </xsl:template>
  <xsl:template match="/root/order/products/product">
    <xsl:variable name="id" select="string(@id)" />
    <prod id="{@id}">
      <xsl:value-of select="/root/prices/productprice[refProduct/@id=$id]/price/@gross" />
    </prod>
  </xsl:template>
</xsl:stylesheet> 
```

显然，确切的 XPath 会根据您的 XML 结构的不同而有所不同，但是这样的东西会使产品与价格相匹配。如果您确实需要迭代产品，您可以将其移出到函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:54:21.303

在查找元素方面，这是使用**xsl:key**的理想情况。因此，对于您的示例，您可能想要查找产品的价格，因此您可以像这样定义您的密钥

```
<xsl:key name="prices" match="productprice" use="refProduct/@id" /> 
```

因此，这将允许您通过使用产品 ID 的值来访问**productprice元素。**具体来说，如果您定位在**产品**元素上，您将访问密钥以获取总价，如下所示：

```
<xsl:value-of select="key('prices', @id)/price/@gross" /> 
```

至于显示产品，一般来说，通常最好使用**xsl:apply-templates**而不是**xsl:for-each**，因为它更符合 XSLT 的“精神”。

```
<xsl:apply-templates select="products/product" /> 
```

可以在多个地方调用模板以减少代码重复，并且可以使代码更具可读性，尤其是通过减少代码缩进。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>
   <xsl:key name="prices" match="productprice" use="refProduct/@id" />

   <xsl:template match="/order">
      <table>
      <xsl:apply-templates select="products/product" />
      </table>
   </xsl:template>

   <xsl:template match="product">
      <tr>
         <td><xsl:value-of select="@id" /></td>
         <td><xsl:value-of select="key('prices', @id)/price/@gross" /></td>
      </tr>
   </xsl:template>
</xsl:stylesheet> 
```

应用于以下格式良好的 XML 时

```
<order>
   <products>
      <product id="1234">
         <item quantity="5" colour="red"/>
         <item quantity="2" colour="blue"/>
      </product>
      <product id="9876">
         <item quantity="10" colour="teal"/>
      </product>
   </products>
   <prices>
      <productprice>
         <refProduct id="1234"/>
         <price gross="9.99"/>
      </productprice>
      <productprice>
         <refProduct id="9876"/>
         <price gross="6.89"/>
      </productprice>
   </prices>
</order> 
```

以下是输出

```
<table>
  <tr>
    <td>1234</td>
    <td>9.99</td>
  </tr>
  <tr>
    <td>9876</td>
    <td>6.89</td>
  </tr>
</table> 
```

# c# - 在 .NET 中使用工业相机进行图像采集的任何资源？

> ID：12059094
> 
> 赞同：0
> 
> 时间：2012-08-21T16:18:48.640
> 
> 标签：c#, c++, camera

我知道很多人尝试将网络摄像头与他们在 .NET 中的程序连接起来，但令人惊讶的是，我找不到用于使用工业相机（例如 .NET 中的 AVT 相机）进行图像采集的好材料。

大多数来自相机制造商的 SDK 都提供了 C++ 示例代码，但我想创建一个 C# 应用程序。我想我最终将不得不在 C# 和 C++ 之间使用互操作，但仍然很高兴知道其他程序员以前做过什么。

# vb.net - 对象变量或未设置块变量，选择 my.settings ArrayList 的索引

> ID：12059096
> 
> 赞同：0
> 
> 时间：2012-08-21T16:18:54.053
> 
> 标签：vb.net, arraylist, indexing

我正在尝试以下列方式指定保存在 My.Settings 中的 ArrayList 的索引

```
My.Settings("Sup" & Selectedsupplier).Item(0) = Convert.ToDouble(Margin1TextBox.Text) 
```

我在指定索引时遇到问题，上面的代码给出了以下错误“对象变量或未设置块变量”。

我在 My.Settings 中有多个 ArrayList，命名为 Sup1、Sup2 到 Sup20 现在我希望能够将名称中的数字指定为变量，并且我希望能够从选定的 ArrayList 中选择一些索引。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:45:42.193

你的例子没有问题。您出现此错误的原因是未设置 ArrayList 设置对象。第一次运行您的应用程序时，需要通过为您的 ArrayList 设置分配一个新实例来初始化 UserSetting

这是一个检查设置然后分配值的功能。

```
Private Sub SetSettingValue(ByVal settingName As String, ByVal itemIndex As Integer, ByVal value As Double)
    Dim setting As ArrayList

    If (My.Settings(settingName) Is Nothing) Then
        My.Settings(settingName) = New ArrayList
    End If

    setting = CType(My.Settings(settingName), ArrayList)

    If (itemIndex >= setting.Count) Then
        Do
            setting.Add(Nothing)

        Loop While (itemIndex >= setting.Count)
    End If

    setting(itemIndex) = value
End Sub 
```

# haproxy - 如何在haproxy中添加uri前缀

> ID：12059097
> 
> 赞同：3
> 
> 时间：2012-08-21T16:18:58.107
> 
> 标签：haproxy

我有一个这样的 haproxy 配置：

```
frontend api
    mode http
    default_backend tomcat

backend tomcat
    mode http
    balance roundrobin
    option httpchk HEAD / HTTP/1.0
    server tomcat1 10.0.0.1:1234 weight 1 maxconn 512 check
    server tomcat2 10.0.0.2:1234 weight 1 maxconn 512 check 
```

这可行，但网址必须像：[http](http://api.example.com/project/api/get-something) : //api.example.com/project/api/get-something，我们想以某种方式设置 haproxy，以便网址[http://api.example.com /api/get-something](http://api.example.com/api/get-something)将得到相同的结果。

我尝试添加 url 前缀：

```
 server tomcat1 10.0.0.1:1234/project/ weight 1 maxconn 512 check
    server tomcat2 10.0.0.2:1234/project/ weight 1 maxconn 512 check 
```

但不支持。有没有办法只使用 haproxy 来做到这一点？我不想设置一个 apache 只是为了代理 tomcat。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T12:53:11.730

据我了解，您想重写`/api/`为`/project/`.

如果是，则将以下行添加到您的后端配置中：

```
reqrep ^([^\ :]*)\ /api/(.*)     \1\ /project/\2 
```

请注意，您必须在前端和服务器上启用选项 http-server-close 才能将重写规则应用于会话中的所有请求。

# java - 在“html级别”实现jsp缓存

> ID：12059100
> 
> 赞同：2
> 
> 时间：2012-08-21T16:19:12.117
> 
> 标签：java, jsp, caching

我想在“html 级别”实现一个 jsp 缓存。我的想法是：

```
for each request{
  if(exists("/cache/<product_id>/<product_name>.html")){
    response "/cache/product/1234/cat.html"
  }else{
    response database.getCat("1234")
  }
}

exists(String path){
   if(!file(path)){
     return false;
   }else{
      if((currentDate = file(path).createdAt) > CACHE_TIME){
         return false
      }else{
          return true
      }
   }
} 
```

因此，如您所见，如果页面自 CACHE_TIME 以来未显示，则仅转到数据库（或另一个繁重的进程）

例子：

用户 1 转到[http://mysite.com/products/1234/cat.jsp](http://mysite.com/products/1234/cat.jsp) 系统转到数据库并生成一个 html 文件 (products-1234-cat.html) 用户 1 看到页面 立即出现用户 2 并转到相同的 url 系统看到缓存存在，所以使用 products-1234-cat.html 响应（没有数据库，没有繁重的进程）。

我该如何实施？

我希望我清楚我想要什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:06:51.740

如果您使用 Apache，则最好使用 mem_cache 模块或类似的 [http://httpd.apache.org/docs/2.2/caching.html](http://httpd.apache.org/docs/2.2/caching.html)

但如果你真的有充分的理由使用应用程序级缓存，你应该以不同的方式来做。除非您添加一些额外的逻辑（我的意思是创建那些缓存的 html 文件时的竞速条件），否则您想要这样做的方式将不是线程安全的。

我将向 JSP 标记库 (customtag:cache) 添加一个新的自定义标记并将您的内容包装到此标记中。根据缓存 ttl 或其状态（暖、冷），我将呈现缓存标签内的实际内容或其缓存版本，这些版本可以存储在 HashMap 中。

# function - 用这种新的编程语言实现除法

> ID：12059101
> 
> 赞同：1
> 
> 时间：2012-08-21T16:19:13.913
> 
> 标签：function, puzzle

X 是一种新的编程语言，它只允许以下操作 -

1.  您可以将零分配给变量（如 a = 0 ）
2.  您可以将一个变量分配给另一个变量（ a=b ）
3.  您可以进行后增量操作（ a++ ）
4.  该语言中不存在负数。所以负数取0。
5.  loop(10){ //code } 将执行代码十次。
6.  您不能有比较运算符或 if 条件或按位运算符。

用这种语言编写一个函数来实现除法。

到目前为止我的解决方案 -

由于除法是重复减法，我将首先实现减法。

```
function decrement(var a)
{
    var x;
    loop(a)
    {
        x = a++;
     }
     return x;
}

function subtract( var a, var b )
{
    //returns a-b
     var x;
     loop(b)
     {
         x=decrement(a);
     }
     return x;
} 
```

现在，我如何使用这个减法实现除法函数？

或任何其他不使用此减法的解决方案也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T18:00:00.797

```
// Your function (corrected)
function decrement(var a)
{
    var x = 0;
    loop(a) 
    {
        x++; a++;
    }
    return x;
}

// Your function
function subtract(var a, var b)
{
    var x;
    loop(b)
    {
        x = decrement(a);
    }
    return x;
}

// This function returns the correct value if a is divisible by b. Otherwise it returns truncate(a/b) + 1
function divide(var a, var b)
{
    var c;

    c = 0;
    loop(a)
    {
        a = subtract(a, b);
        c++;
    }
} 
```

# version-control - HTTP 错误 404：在 hg 拉取期间未找 到

> ID：12059103
> 
> 赞同：0
> 
> 时间：2012-08-21T16:19:17.250
> 
> 标签：version-control, mercurial, http-status-code-404, bitbucket

我正在尝试从回购（托管@Bitbucket）中提取并继续收到以下错误：

> HTTP 错误 404：未找到

我可以毫无问题地导航到存储库。我已经尝试过 TortoiseHG 和命令行。一位同事能够毫无问题地访问同一个仓库，这意味着它在我的环境中。

有任何想法吗？

完全错误：

> % hg --repository C:\Users\Daniel\Documents\Projects - 2010\MyRepo pull --verbose --update --config ui.merge=internal:fail [https://bitbucket.org/dir/MyRepo](https://bitbucket.org/dir/MyRepo) HTTP 错误： 404（未找到）[命令返回代码 255，2012 年 8 月 21 日星期二 11:27:40] MyRepo%

另外值得注意的是 - 我可以毫无问题地克隆回购......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:22:40.647

您如何使用`https`or设置存储库`ssl`？

如果`ssl`那么：你不能在任何代理后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T21:49:39.237

每个 BitBucket 支持是一个“糟糕的部署”。不知道这对我（而不是我的同事）有何影响，但它现在正在发挥作用。

# bash - 计算文件的最快方法是什么？

> ID：12059109
> 
> 赞同：3
> 
> 时间：2012-08-21T16:19:43.787
> 
> 标签：bash

我们刚刚安装了一个海量文件管理设备，我们希望在该设备上存储来自供应商的数据。他们每天都通过 FTP 向它发送文件，现在，我们有大约 60,000 多个文件。

做`find . -name '*TXT' -exec ls '{}' \; | wc -l`会工作，虽然很慢。

有没有更快的方法来计算文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T16:21:01.400

为什么不只是

```
find . -name '*TXT' | wc -l 
```

? 您当前的命令不必要地`ls`为*每个*文件生成，并且该进程本身生成将非常慢。对我的系统进行快速测试表明速度提高了 40 倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T16:20:34.200

怎么样

```
find . -name '*TXT' | wc -l 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-21T16:45:13.930

使用 GNU find，这可能会稍微快一些：

```
find . -name '*.TXT' -printf x | wc -c 
```

或使用 POSIX

```
find . -name '*.TXT' -exec printf x%.s {} + | wc -c 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-21T19:54:46.883

用 bash：

```
shopt -s globstar nullglob 
```

然后，要么

```
files=(**/*.TXT)
nfiles=${#files[@]} 
```

或者

```
nfiles=$( printf "%s\n" **/*.TXT | wc -l ) 
```

# javascript - javascript/jQuery 调用执行函数，一旦先前的函数完成

> ID：12059110
> 
> 赞同：0
> 
> 时间：2012-08-21T16:19:54.907
> 
> 标签：javascript, jquery

我试图找到在 javascript（或 jQuery）中执行函数（resetMenuPosition（））的最简单方法，仅当先前的函数（collapseExpandMainMenu（this））完成时。

原始代码

```
$('.trmenuClass').click(function () {
    $.when(collapseExpandMainMenu(this))
     .done(function () {
         resetMenuPosition();
     });
}); 
```

我尝试了 jQuery 的不同变体，但我认为我误用了 jQuery，因为我没有完全掌握延迟对象的概念。

感谢任何 javascript 或 jQuery 建议。

谢谢，-蒂姆

编辑后包含 collapseExpandMainMenu(this) 代码

```
function collapseExpandMainMenu(i, callback) {
    isCollapsing = ($(i).find('div').attr('class')) == 'minusSign';
    currentScrollTop = $('#contents').scrollTop();

    var fav, Dash, Conn, Hire, Retain, Activityreports;
    var favSubmnuHt = 0, dashSubmnuHt = 0, connSubmnuHt = 0, hireSubmnuHt = 0, retainSubmnuHt = 0, activityreportsSubmnuHt = 0;

    /*submenu height determination*/
    $('.trmenuClass').each(function () {
        if ($('tr.favtrClass').toggle().is(":visible")) {
            fav = 1;
        }
        else {
            fav = 0;
        }

        if ($('tr.dashboardtrClass').toggle().is(":visible")) {
            Dash = 1;
        }
        else {
            Dash = 0;
        }

        if ($('tr.connecttrClass').toggle().is(":visible")) {
            Conn = 1;
        }
        else {
            Conn = 0;
        }

        if ($('tr.hiretrClass').toggle().is(":visible")) {
            Hire = 1;
        }
        else {
            Hire = 0;
        }

        if ($('tr.retaintrClass').toggle().is(":visible")) {
            Retain = 1;
        }
        else {
            Retain = 0;
        }

        if ($('tr.activityreportstrClass').toggle().is(":visible")) {
            Activityreports = 1;
        }
        else {
            Activityreports = 0;
        }

    })

    /*This gets the height of each dynamically created submenu along with bottom border*/
    var favBottomBorder = 0; var dashBottomBorder = 0; var connectBottomBorder = 0; var hireBottomBorder = 0;
    var retainBottomBorder = 0; var activityreportsBottomBorder = 0;
    $('.favtrClass').each(function () {
        favSubmnuHt = favSubmnuHt + 35;
        favBottomBorder = favBottomBorder + 1;
    })

    $('.dashboardtrClass').each(function () {
        dashSubmnuHt = dashSubmnuHt + 35;
        dashBottomBorder = dashBottomBorder + 1;
    })

    $('.connecttrClass').each(function () {
        connSubmnuHt = connSubmnuHt + 35;
        connectBottomBorder = connectBottomBorder + 1;
    })

    $('.hiretrClass').each(function () {
        hireSubmnuHt = hireSubmnuHt + 35;
        hireBottomBorder = hireBottomBorder + 1;
    })

    $('.retaintrClass').each(function () {
        retainSubmnuHt = retainSubmnuHt + 35;
        retainBottomBorder = retainBottomBorder + 1;
    })

    $('.activityreportstrClass').each(function () {
        activityreportsSubmnuHt = activityreportsSubmnuHt + 35;
        activityreportsBottomBorder = activityreportsBottomBorder + 1;
    })

    /*submenu height determination */
    var varFav = favSubmnuHt - favBottomBorder;
    var varDash = dashSubmnuHt - dashBottomBorder;
    var varConn = connSubmnuHt - connectBottomBorder;
    var varHire = hireSubmnuHt - hireBottomBorder;
    var varRetain = retainSubmnuHt - retainBottomBorder;
    var varActivityreports = activityreportsSubmnuHt - activityreportsBottomBorder;
    var rowCount = ($('#contents tr').length) * 35;

    /*determination which submenu is open and which is closed*/
    if (fav == 1) { favSubmnuHt; }
    else if (fav == 0) { rowCount = rowCount - favSubmnuHt; }

    if (Dash == 1) { dashSubmnuHt; }
    else if (Dash == 0) { rowCount = rowCount - dashSubmnuHt; }

    if (Conn == 1) { connSubmnuHt; }
    else if (Conn == 0) { rowCount = rowCount - connSubmnuHt; }

    if (Hire == 1) { hireSubmnuHt; }
    else if (Hire == 0) { rowCount = rowCount - hireSubmnuHt; }

    if (Retain == 1) { retainSubmnuHt; }
    else if (Retain == 0) { rowCount = rowCount - retainSubmnuHt; }

    if (Activityreports == 1) { activityreportsSubmnuHt; }
    else if (Activityreports == 0) { rowCount = rowCount - activityreportsSubmnuHt; }

    var heightOfSubMenuCombined = 0;
    var idTotoggleSubMenu = $(i).closest('tr').attr('id');  // changes from "this" to "i"
    if (idTotoggleSubMenu == "favoritestrId") {
        $('tr.favtrClass').toggle(browserVar, function () { });
        if (fav == 1) {
            rowCount = rowCount - favSubmnuHt;
            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });

            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);

            }
        }
        else if (fav == 0) {
            rowCount = rowCount + varFav;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);

            }
        }
        /*Code to toggle plus and minus sign*/
        if ($('#favoritesMinusSignId').hasClass('minusSign')) {
            $('#favoritesMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#favoritesMinusSignId').hasClass('plusSign')) {
            $('#favoritesMinusSignId').addClass('minusSign').removeClass('plusSign');
        }

    }
    else if (idTotoggleSubMenu == "dashboardtrId") {
        /*Code to toggle submenu and make bottom scrolling arrow slide up and down*/

        $('tr.dashboardtrClass').toggle(browserVar, function () { });

        if (Dash == 1) {
            rowCount = rowCount - dashSubmnuHt;
            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);

            }
        }
        else if (Dash == 0) {
            rowCount = rowCount + varDash;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }

        /*Code to toggle plus and minus sign*/
        if ($('#dashboardMinusSignId').hasClass('minusSign')) {
            $('#dashboardMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#dashboardMinusSignId').hasClass('plusSign')) {
            $('#dashboardMinusSignId').addClass('minusSign').removeClass('plusSign');
        }

    }
    else if (idTotoggleSubMenu == "connecttrId") {
        /*Code to toggle submenu and make bottom scrolling arrow slide up and down*/
        $('tr.connecttrClass').toggle(browserVar, function () { });

        if (Conn == 1) {
            rowCount = rowCount - connSubmnuHt;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }
        else if (Conn == 0) {
            rowCount = rowCount + varConn;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }

        /*Code to toggle plus and minus sign*/
        if ($('#connectMinusSignId').hasClass('minusSign')) {
            $('#connectMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#connectMinusSignId').hasClass('plusSign')) {
            $('#connectMinusSignId').addClass('minusSign').removeClass('plusSign');
        }
    }
    else if (idTotoggleSubMenu == "hiretrId") {
        /*Code to toggle submenu and make bottom scrolling arrow slide up and down*/
        $('tr.hiretrClass').toggle(browserVar, function () { });

        if (Hire == 1) {
            rowCount = rowCount - hireSubmnuHt;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }
        else if (Hire == 0) {
            rowCount = rowCount + varHire;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }

        /*Code to toggle plus and minus sign*/
        if ($('#hireMinusSignId').hasClass('minusSign')) {
            $('#hireMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#hireMinusSignId').hasClass('plusSign')) {
            $('#hireMinusSignId').addClass('minusSign').removeClass('plusSign');
        }

    }
    else if (idTotoggleSubMenu == "retaintrId") {
        /*Code to toggle submenu and make bottom scrolling arrow slide up and down*/
        $('tr.retaintrClass').toggle(browserVar, function () { });

        if (Retain == 1) {
            rowCount = rowCount - retainSubmnuHt;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }
        else if (Retain == 0) {
            rowCount = rowCount + varRetain;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }

        /*Code to toggle plus and minus sign*/
        if ($('#retainMinusSignId').hasClass('minusSign')) {
            $('#retainMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#retainMinusSignId').hasClass('plusSign')) {
            $('#retainMinusSignId').addClass('minusSign').removeClass('plusSign');
        }
    }
    else if (idTotoggleSubMenu == "activityreportstrId") {
        /*Code to toggle submenu and make bottom scrolling arrow slide up and down*/
        $('tr.activityreportstrClass').toggle(browserVar, function () { });

        if (Activityreports == 1) {
            rowCount = rowCount - activityreportsSubmnuHt;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }
        else if (Activityreports == 0) {
            rowCount = rowCount + varActivityreports;

            if (rowCount > $('#contents').height()) {
                $('.scrollDownArrow').css({ visibility: "visible" });
            }
            else {
                $('.scrollDownArrow').css({ visibility: "hidden" });
                $('.scrollUpArrow').hide();
                $('.scrollUpArrow').css({ visibility: "hidden" });
                $(document).ready(resizingScrollbar);
            }
        }

        /*Code to toggle plus and minus sign*/
        if ($('#activityreportsMinusSignId').hasClass('minusSign')) {
            $('#activityreportsMinusSignId').addClass('plusSign').removeClass('minusSign');
        }
        else if ($('#activityreportsMinusSignId').hasClass('plusSign')) {
            $('#activityreportsMinusSignId').addClass('minusSign').removeClass('plusSign');
        }
    }

    //setTimeout(function () {
        callback.call();
    //}, 400);
} 
```

使用 JQUERY 的代码。然后

```
$('.trmenuClass').click(function () {
    (collapseExpandMainMenu(this)).then(
        function () { resetMenuPosition(); },
        function () { alert("Please close and re-open the menu."); }
    );
}); 
```

resetMenuPosition() 的开头行

```
 console.log('#menuTableId.height: ' + $('#menuTableId').css('height').replace(/px/g, ''));
    alert('pause');
    console.log('#menuTableId.height: ' + $('#menuTableId').css('height').replace(/px/g, '')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:23:06.123

您`collapseExpandMainMenu`需要在完成时返回一个`$.Deferred()`（或一个承诺）对象并解决/拒绝。这是一个简单的例子：

```
var collapseExpandMainMenu = function () {
    var deferred = $.Deferred();

    setTimeout(function () {
        // some processing
        deferred.resolve('success!');
    }, 5000);

    return deferred.promise();
};

$.when(collapseExpandMainMenu(this))
    .done(function (message) {
        console.log(message); // logs "success!" after 5 seconds
    }
); 
```

工作示例：http: [//jsfiddle.net/3sGZh/](http://jsfiddle.net/3sGZh/)

旁注：承诺是无法解决/拒绝的延迟 - 您将其提供给消费者，以便他们可以响应解决/拒绝，但不能自己执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:23:03.600

只需使用回调：

```
$('.trmenuClass').on('click', function () {
    collapseExpandMainMenu(this, function() {
        console.log('success!'); // logs "success!" when animation completes
        resetMenuPosition();
    });
});

function collapseExpandMainMenu(elem, callback) {
     //do your stuff first, then call the callback
     $(elem).fadeIn(1000, function() {
          callback.call(); //waits until animation is complete
     });
} 
```

# c# - 将 PHP 密码解密转换为 C#

> ID：12059113
> 
> 赞同：0
> 
> 时间：2012-08-21T16:19:58.513
> 
> 标签：c#, php, encryption

我继承了一些 C# 代码，其中包含函数 &decrypt 的 PHP 页面被编译/转换为独立的 Windows EXE。我想采用这个 PHP 代码并将功能放入 C# 中。

```
function &decrypt($enc_text, $password)
{
    $iv_len = 16;
    $enc_text = base64_decode($enc_text);
    $i = $iv_len;
    $n = strlen($enc_text);
    $plain_text = '';
    $iv = substr($password ^ substr($enc_text, 0, $iv_len), 0, 512);
    while ($i < $n)
    {
        $block = substr($enc_text, $i, 16);
        $plain_text .= $block ^ pack('H*', md5($iv));
        $iv = substr($block . $iv, 0, 512) ^ $password;
        $i += 16;
        }
    return $plain_text;
} 
```

我发现了几个提到此代码的问题，但没有提供太多见解： [只想将代码解码为纯文本](https://stackoverflow.com/questions/6503033/just-want-to-decode-the-code-into-plain-text) 并将[“MD5解密”php函数转换为MySQL存储函数](https://stackoverflow.com/questions/8861208/md5-decrypt-php-function-to-mysql-stored-function)

有用的链接： [PHP base64_decode C# 等价物](https://stackoverflow.com/questions/656373/php-base64-decode-c-sharp-equivalent)

[http://nuronconsulting.com/c-pack-h.aspx](http://nuronconsulting.com/c-pack-h.aspx)

除了倒数第二个和第三个字符外，我可以获得正确的结果。我认为我的 base64 解码仍然关闭。

编辑：更新到正在使用的最新代码。删除了中间编辑。

```
 private string decipher(string ienc_text, string ipassword)
    {
        int iv_len = 16;
        byte[] toEncryptArray = Convert.FromBase64String(ienc_text);
        string encryptedStringx = System.Text.Encoding.Default.GetString(toEncryptArray);
        string encryptedString = Encoding.GetEncoding(28591).GetString(toEncryptArray);
        string password = ipassword;
        int i = iv_len;
        int n = encryptedString.Length;
        string plain_text = "";
        string iv = phpXOR(ipassword, encryptedString.Substring(0, iv_len));

        while (i < n)
        {
            string block = encryptedString.Substring(i, iv_len);

            string md5 = getMD5(iv);

            byte[] testPack = PackH(md5);
            string testPackstring = Encoding.Default.GetString(testPack);

            string tmp = phpXOR(block, testPackstring);

            plain_text += tmp;

            string block_iv = block + iv;
            string tmp_iv = block_iv;

            if (block_iv.Length > 512)
            {
                tmp_iv = block_iv.Substring(0, 512);
            }

            iv = phpXOR(tmp_iv, password);
            i += 16;
        }

        return plain_text;
    }

    public static byte[] PackH(string hex)
    {
        if ((hex.Length % 2) == 1) hex += '0';
        byte[] bytes = new byte[hex.Length / 2];
        for (int i = 0; i < hex.Length; i += 2)
        {
            bytes[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
        }
        return bytes;
    }

    string phpXOR(string text, string key)
    {
        byte[] result = new byte[key.Length];

        for (int c = 0; c < key.Length; c++)
            result[c] = (byte)(((byte)text[c]) ^ ((byte)key[c]));

        return Encoding.Default.GetString(result);
    }

    public static string getMD5(string iValue)
    {
        byte[] textBytes = System.Text.Encoding.Default.GetBytes(iValue);
        //byte[] textBytes = System.Text.Encoding.GetEncoding(28591).GetBytes(password);

        try
        {
            System.Security.Cryptography.MD5CryptoServiceProvider cryptHandler;
            cryptHandler = new System.Security.Cryptography.MD5CryptoServiceProvider();
            byte[] hash = cryptHandler.ComputeHash(textBytes);
            string ret = "";
            foreach (byte a in hash)
            {
                if (a < 16)
                    ret += "0" + a.ToString("x");
                else
                    ret += a.ToString("x");
            }
            return ret;
        }
        catch
        {
            throw;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:59:25.493

循环中的代码不完整（因此注释掉的代码），但是，我提出的问题得到了回答。编码、XOR 问题、php 包复制是通过问题中的有用链接完成的。

```
 private string decipher(string ienc_text, string ipassword)
    {
        int iv_len = 16;
        byte[] toEncryptArray = Convert.FromBase64String(ienc_text);
        string encryptedString = Encoding.GetEncoding("iso-8859-1").GetString(toEncryptArray);
        string password = ipassword;
        int i = iv_len;
        int n = encryptedString.Length;
        string plain_text = "";
        string iv = phpXOR(ipassword, encryptedString.Substring(0, iv_len));

        while (i < n)
        {
            string block = encryptedString.Substring(i, iv_len);

            string md5 = getMD5(iv);

            byte[] testPack = PackH(md5);
            string testPackstring = Encoding.GetEncoding("iso-8859-1").GetString(testPack);

            string tmp = phpXOR(block, testPackstring);

            plain_text += tmp;

            //string block_iv = block + iv;
            //string tmp_iv = block_iv;

            //if (block_iv.Length > 512)
            //{
            //    tmp_iv = block_iv.Substring(0, 512);
            //}

            //iv = phpXOR(tmp_iv, password);
            //i += 16;
        }

        return plain_text;
    }

    public static byte[] PackH(string hex)
    {
        if ((hex.Length % 2) == 1) hex += '0';
        byte[] bytes = new byte[hex.Length / 2];
        for (int i = 0; i < hex.Length; i += 2)
        {
            bytes[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
        }
        return bytes;
    }

    string phpXOR(string text, string key)
    {
        byte[] result = new byte[key.Length];

        for (int c = 0; c < key.Length; c++)
            result[c] = (byte)(((byte)text[c]) ^ ((byte)key[c]));

        return Encoding.Default.GetString(result);
    }

    public static string getMD5(string iValue)
    {
        byte[] textBytes = System.Text.Encoding.Default.GetBytes(iValue);

        try
        {
            System.Security.Cryptography.MD5CryptoServiceProvider cryptHandler;
            cryptHandler = new System.Security.Cryptography.MD5CryptoServiceProvider();
            byte[] hash = cryptHandler.ComputeHash(textBytes);
            string ret = "";
            foreach (byte a in hash)
            {
                if (a < 16)
                    ret += "0" + a.ToString("x");
                else
                    ret += a.ToString("x");
            }
            return ret;
        }
        catch
        {
            throw;
        }
    } 
```

# sql - TSQL 将结果集平均划分为组并更新它们

> ID：12059119
> 
> 赞同：7
> 
> 时间：2012-08-21T16:20:12.193
> 
> 标签：sql, tsql, sql-server-2005

我的数据库有 3 个表，如下所示：

![在此处输入图像描述](../Images/a16117bcf8806cc23c4f74de183c3c4e.png)

订单表有如下数据：

```
OrderID    OperatorID    GroupID        OrderDesc    Status    Cash    ...
--------------------------------------------------------------------------
      1             1          1      small order         1     100 
      2             1          1    another order         2       0 
      3             1          2      xxxxxxxxxxx         2    1000 
      5             2          2      yyyyyyyyyyy         2     150 
      9             5          1      xxxxxxxxxxx         1       0 
     10          NULL          2      xxxxxxxxxxx         1      10 
     11          NULL          3      xxxxxxxxxxx         1     120 
```

运算符表：

```
OperatorID    Name    GroupID    Active
---------------------------------------
      1       John          1         1
      2       Kate          1         1
      4       Jack          2         1
      5       Will          1         0
      6        Sam          3         1 
```

组表：

```
GroupID    Name
---------------
      1      G1
      2      G2
      3      X1 
```

如您所见，John 有 3 个订单，Kate 1、Will 1、Jack 和 Sam 没有。

现在我想根据一些条件将操作员分配给订单：

*   订单必须有现金>0
*   订单必须有 status=1
*   订单必须在第 1 组或第 2 组中
*   操作员必须处于活动状态（活动 = 1）
*   操作员必须在第 1 组或第 2 组中

这是我想要得到的结果：

```
OrderID    OperatorID    GroupID        OrderDesc    Status    Cash    ...
--------------------------------------------------------------------------
      1             1          1      small order         1     100       < change
      2             1          1    another order         2       0 
      3             2          2      xxxxxxxxxxx         2    1000       < change
      5             4          2      yyyyyyyyyyy         2     150       < change
      9             5          1      xxxxxxxxxxx         1       0 
     10             4          2      xxxxxxxxxxx         1      10       < change
     11          NULL          3      xxxxxxxxxxx         1     120 
```

我想改组订单并更新operatorID，以便每次调用此脚本时，我都会随机获得分配者operatorID，但是每个操作员的数量或订单数量都相同（接近相等，因为如果我有7个订单，则一个人将拥有3个并休息2）。

我可以使用`NTILE`将订单分配到组中，但我需要将 operatorID 分配给该组。

我认为我需要做这样的事情：

```
SELECT NTILE(2) OVER( order by orderID desc) as newID,* 
FROM
    orders(NOLOCK) 
```

这将使我的订单表分成相等的部分。我需要知道的是操作符表的长度（将其作为参数添加到 NTILE），之后我可以将结果与操作符连接（使用`row_number()`）

有更好的解决方案吗？

我的问题再次：**如何将结果集平均分成组并使用另一个表数据更新该记录集？**

**编辑：** 到目前为止，这是我的代码：[http ://sqlfiddle.com/#!3/39849/25](http://sqlfiddle.com/#!3/39849/25)

**编辑 2** 我更新了我的问题并添加了更多条件。

我想根据一些条件将操作员分配给订单：

*   订单必须有现金>0
*   订单必须有 status=1
*   订单必须在第 1 组或第 2 组中
*   操作员必须处于活动状态（活动 = 1）
*   操作员必须在第 1 组或第 2 组中

我将此查询构建为存储过程。
因此，第一步是在临时表中生成具有新分配的数据，并在第二步最终批准后根据该临时表更新主表。

我还有 2 个问题：

1.  是先把所有的订单和所有满足条件的算子全选到临时表，然后再洗牌，还是在一个大查询中全部做？

2.  我想将数组或组作为参数传递给我的过程。哪个选项最适合将数组传递给存储过程（SQL Server 2005）。

    我知道这被问了很多次，但我想知道是否最好创建一个单独的函数，将逗号分隔的字符串切割成表格（[http://www.sommarskog.se/arrays-in-sql-2005.html](http://www.sommarskog.se/arrays-in-sql-2005.html) ) 还是将所有内容都放在一个大胖程序中？:)

* * *

**最终答案：**可在[http://sqlfiddle.com/#!3/afb48/2获得](http://sqlfiddle.com/#!3/afb48/2)

```
SELECT o.*, op.operatorName AS NewOperator, op.operatorID AS NewOperatorId
FROM (SELECT o.*, (ROW_NUMBER() over (ORDER BY newid()) % numoperators) + 1 AS randseqnum
      FROM Orders o CROSS JOIN
     (SELECT COUNT(*) AS numoperators FROM operators WHERE operators.active=1) op
      WHERE o.cash>0 and o.status in (1,3)
     ) o JOIN
     (SELECT op.*, ROW_NUMBER() over (ORDER BY newid()) AS seqnum
      FROM Operators op WHERE op.active=1
     ) op
     ON o.randseqnum = op.seqnum ORDER BY o.orderID 
```

答案基于 Gordon 的 Linoff 答案。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:57:45.033

我不确定您是否真的想要更新查询或选择查询。以下查询根据您的条件为每个订单返回一个新运算符：

```
/*
with orders as (select 1 as orderId, 'order1' as orderDesc, 1 as OperatorId),
     operators as (select 1 as operatorID, 'John' as name)
 */
select o.*, op.name as NewOperator, op.operatorID as NewOperatorId
from (select o.*, (ROW_NUMBER() over (order by newid()) % numoperators) + 1 as randseqnum
      from Orders o cross join
     (select COUNT(*) as numoperators from operators) op
     ) o join
     (select op.*, ROW_NUMBER() over (order by newid()) as seqnum
      from Operators op
     ) op
     on o.randseqnum = op.seqnum order by orderid 
```

它基本上为连接的行分配了一个新的 ID。订单表获得一个介于 1 和随机分配的操作员数量之间的值。然后将其连接到运算符上的序列号。

如果您需要更新，那么您可以执行以下操作：

```
with toupdate as (<above query>)
update orders
    set operatorid = newoperatorid
    from toupdate
    where toupdate.orderid = orders.orderid 
```

你的两个问题：

*是先把所有的订单和所有满足条件的算子全选到临时表，然后再洗牌，还是在一个大查询中全部做？*

临时表的用户是应用程序的性能和要求问题。如果数据正在快速更新，那么是的，使用临时表是一个很大的胜利。如果您在相同的数据上多次运行随机化，那么它可能是一个胜利，特别是如果表太大而无法放入内存中。否则，假设您将条件放在最里面的子查询中，一次性运行不可能有很大的性能提升。但是，如果性能是一个问题，您可以测试这两种方法。

*我想将数组或组作为参数传递给我的过程。哪个选项最适合将数组传递给存储过程（SQL Server 2005）。*

嗯，切换到具有表值参数的 2008。这是 Erland Sommarskog 撰写的关于该主题的高度参考文章：http: [//www.sommarskog.se/arrays-in-sql-2005.html](http://www.sommarskog.se/arrays-in-sql-2005.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:46:33.353

抱歉——我认为你无法摆脱对记录集的计数......

```
DECLARE @myCount int
SELECT @myCount = Count(*) FROM Operators

SELECT
  a.OrderID, a.description, b.operatorName
FROM
  (
    SELECT NTILE(@myCount) OVER( ORDER BY NEWID()) AS newID, orderID, description
    FROM orders(NOLOCK)
  ) a
  INNER JOIN
  (
    SELECT NTILE(@myCount) OVER( ORDER BY NEWID()) AS newID, OperatorName, OperatorID
    FROM Operators
  ) b
  ON a.NewID = b.NewID
ORDER BY
   a.OrderID 
```

# rest - 官方 Twitter 移动应用程序如何连接用户？

> ID：12059120
> 
> 赞同：0
> 
> 时间：2012-08-21T16:20:14.453
> 
> 标签：rest, web-applications, twitter, oauth, oauth-2.0

我想知道官方 Twitter 移动应用程序 (android/IOS) 如何在不批准应用程序的情况下连接用户？

他们是否将自己的 REST API 与 OAuth 一起使用，但只有一个？ [https://dev.twitter.com/docs/auth/obtaining-access-tokens](https://dev.twitter.com/docs/auth/obtaining-access-tokens)

他们使用特殊的万能钥匙吗？这不是安全威胁吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:32:56.267

他们似乎像任何其他应用程序一样使用 OAuth 界面。如果您进入[twitter 设置页面](https://twitter.com/settings/applications)，您可以在其中撤销 OAuth 令牌，我会在那里看到移动 twitter 应用程序（iPhone、iPad、IOS 集成）并且它们可以被撤销。

# r - R - 过滤时间序列

> ID：12059123
> 
> 赞同：6
> 
> 时间：2012-08-21T16:20:23.923
> 
> 标签：r, time-series

我有一个时间序列

```
mainTimeSeries <- data.frame(time=seq(as.POSIXct("2012/1/1"), as.POSIXct("2012/1/5"), "hour"), value=sample(1:10, 1)) 
```

我想过滤掉另一个系列中存在的所有数据

```
badTimeSeries<-data.frame(startTime=seq(as.POSIXct("2012/1/3"), as.POSIXct("2012/1/4"), "hour"))
badTimeSeries$endTime <- badTimeSeries$startTime + 1800 
```

是否有过滤日期的现有功能？结果应该是 mainTimeSeries 的任何元素都不应该介于 badTimeSeries 的 startTime 和 endTime 之间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T16:34:44.260

`lubridate`在这里很有用。没有它，您需要编写自己的重叠检查，这有点痛苦......

```
library(lubridate)

badRange <- as.interval(days(1), as.POSIXct("2012/1/3"))

> mainTimeSeries %within% badRange
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[22] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[43] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[64]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> 
```

或者：

```
> mainTimeSeries[mainTimeSeries %within% badRange]
 [1] "2012-01-03 00:00:00 PST" "2012-01-03 01:00:00 PST" "2012-01-03 02:00:00 PST" "2012-01-03 03:00:00 PST"
 [5] "2012-01-03 04:00:00 PST" "2012-01-03 05:00:00 PST" "2012-01-03 06:00:00 PST" "2012-01-03 07:00:00 PST"
 [9] "2012-01-03 08:00:00 PST" "2012-01-03 09:00:00 PST" "2012-01-03 10:00:00 PST" "2012-01-03 11:00:00 PST"
[13] "2012-01-03 12:00:00 PST" "2012-01-03 13:00:00 PST" "2012-01-03 14:00:00 PST" "2012-01-03 15:00:00 PST"
[17] "2012-01-03 16:00:00 PST" "2012-01-03 17:00:00 PST" "2012-01-03 18:00:00 PST" "2012-01-03 19:00:00 PST"
[21] "2012-01-03 20:00:00 PST" "2012-01-03 21:00:00 PST" "2012-01-03 22:00:00 PST" "2012-01-03 23:00:00 PST"
[25] "2012-01-04 00:00:00 PST"
> 
```

* * *

仅使用基础 R：

```
bad_start <- as.POSIXct('2012/1/3')
bad_end   <- as.POSIXct('2012/1/4')
mainTimeSeries[mainTimeSeries > bad_end | mainTimeSeries < bad_start] 
```

# vb.net - 主页/索引默认为登录页面

> ID：12059126
> 
> 赞同：0
> 
> 时间：2012-08-21T16:20:44.907
> 
> 标签：vb.net, asp.net-mvc-3, authentication

我刚刚在我的家庭控制器中实现了以下内容：

```
<Authorize(Roles:="Administrator")> _
<Authorize(Roles:="Manager")> _
<Authorize(Roles:="General")> _
Function Index() As ActionResult
    Return View()
End Function 
```

但是，即使我已经登录到 /Home/Index 或者当它被 @RenderBody 调用时，它也会返回登录页面和以下 url：/Account/LogOn?ReturnUrl=%2f

我也没有更改全局文件中的任何路由。有什么建议么？

**更新**

后来我发现我添加的任何东西

```
<Authorize(Roles:="Administrator")> _ 
```

标签会不断向我询问密码？

我的 ViewStart 也是：

```
@Code

Dim r = Roles.GetRolesForUser()

If r.Contains("Administrator") Then
    Layout = "~/Views/Shared/_AdminLayout.vbhtml"
ElseIf r.Contains("Manager") Then
    Layout = "~/Views/Shared/_ManagerLayout.vbhtml"
ElseIf r.Contains("General") Then
    Layout = "~/Views/Shared/_GeneralLayout.vbhtml"
Else
    Layout = "~/Views/Shared/_NoUserLayout.vbhtml"
End If

End Code 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:51:29.337

尝试将它们组合成一个，而不是 3 个单独的属性，例如：

```
<Authorize(Roles:="General,Manager,Administrator")> 
```

# linux - 帮助管理 Linux 上多个版本的可执行文件的工具？

> ID：12059133
> 
> 赞同：2
> 
> 时间：2012-08-21T16:21:18.920
> 
> 标签：linux, unix

我们处于联网的 Linux 环境中，我正在寻找一种 FOSS 或通用系统级方法，用于管理每个会话使用的可执行文件和库的版本。可执行文件最好安装在网络上。可执行文件将是内部工具和商业软件包（如 Houdini、Maya 和 Nuke）的安装。

这样做的需要是我们希望安装多个版本的软件并可供艺术家使用，但需要一种简单的方法来选择要使用的版本。作为一个额外的好处，我希望能够跟踪用于生成给定输出作为元数据的软件版本。我曾在成功做到这一点的工作室工作过，但我并没有 100% 了解它是如何实现的。给定集中的每个可执行文件都被分配了该集中的单个超级版本。这样一来，工作室工具的“已批准包”都被折叠成一个已知可以协同工作的工具包。

由于它们的安装方式，一些程序使设置变得容易（就像将它们的安装目录添加到 $PATH 一样简单）。其他程序并不那么容易。我特别担心如何处理程序可能安装的库。需要的是一种通用的访问方法，我可以使用它来将所有内容包装到一个干净的前端。

有谁知道这样的系统在野外可用，还是我必须从头开始实施它？谷歌在寻找解决方案方面并不是很有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T19:50:47.123

[在http://modules.sourceforge.net/](http://modules.sourceforge.net/)查看“模块”系统；它在 HPC 中的应用非常广泛。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T17:12:27.860

有[eselect](http://www.gentoo.org/proj/en/eselect/)。我只在 funtoo（gentoo 的后代）上使用它，但它似乎正在做你需要的事情。它也完全用 BASH 编写，因此应该很可能移植到其他发行版。

# ember.js - 强制 EmberJS 路由到相同的 URL

> ID：12059138
> 
> 赞同：2
> 
> 时间：2012-08-21T16:21:38.997
> 
> 标签：ember.js

我注意到当您请求与您所在的路径相同时，EmberJS 中的路由器拒绝调用 connectOutlets。

我想我理解为什么会发生这种情况 - 如果路径没有改变，为什么要改变任何东西？

但是，我有一个动态的项目列表，我希望它们在用户单击顶部的选项卡时刷新，即使它与它们当前所在的选项卡相同。

有没有办法强制 EmberJS 在 URL 转到同一路径时调用 connectOutlets 或以其他方式通知我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:26:57.243

如果您传递不同的上下文，您只能重新进入当前状态。否则，您将不得不退出该状态。在您的情况下，也许您可​​以在模板中创建一个条件来更改要调用的操作，`refresh`而不是尝试转换到相同的状态。或者，您可以尝试使用随机生成的上下文进行一些技巧，稍后您将忽略这些上下文。

# c - 无法使用线程编码作为 fork() 的替代方案

> ID：12059143
> 
> 赞同：1
> 
> 时间：2012-08-21T16:21:50.477
> 
> 标签：c, multithreading, fork

我在 Windows 上编码，所以 fork() 不可用。现在，我需要运行 execl()，但它是我程序的终点！我想创建一个单独的线程来运行execl()，它创建成功，并且运行良好。但是线程结束后我的程序仍然结束。函数运行线程——它在 wScoreget 类中：——

```
 int refresh_score_now(){
            pthread_t t;
            if(pthread_create(&t,NULL,s.basicgetscore,&s)==-1){
                                printf("Error: wScoreget:3");
                                exit(4);
                                }

            void *a;
            if(pthread_join(t,&a)==-1){
                printf("Error: wScoreget: 4");
                exit(4);
                printf("Running thread.\n");
                getch();
            }

        } 
```

从主调用：-

```
 int main(){

    wScoreget new_ws;
    new_ws.refresh_score_now();
    printf("reached to the end\n");
    getch();
    } 
```

我期待控制台打印-“到达终点”但是在 execl() 上它退出了。注意： execl() 正在运行 curl。它的输出将发送到一个文本文件。现在，如果更改了标准输出，curl 会在控制台上显示下载时间和其他数据。无论如何，这些数据都会进入控制台。

有没有办法在不使用 CreateProcess 的情况下做到这一点？如果我使用 CreateProcess，我必须在 Windows 上安装哪些库（我使用的是 MingW + Codeblocks）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:29:49.907

尝试使用`spawn`或`posix_spawn`。它应该替换 fork + exec。

*   [http://en.wikipedia.org/wiki/Spawn_%28computing%29](http://en.wikipedia.org/wiki/Spawn_%28computing%29)
*   [http://linux.die.net/man/3/posix_spawn](http://linux.die.net/man/3/posix_spawn)

# java - 玩！框架 - 处理 POST 请求

> ID：12059147
> 
> 赞同：10
> 
> 时间：2012-08-21T16:22:01.380
> 
> 标签：java, http, web, playframework-2.0, web-development-server

这是处理登录 POST 请求的路径：

```
POST  /login/submit                 controllers.Users.loginSubmit(user : String, password : String) 
```

这是 login.scala.html：

```
<form method="post" action="???">
  <input type="text" name="username" /><br/>
  <input type="password" name="password" /><br/>

  <input type="submit" value="Login" />
</form> 
```

我有两个问题：

1.  行动的价值应该是什么？是“登录/提交”吗？
2.  你如何传递这个表单在 loginSubmit 函数中处理？

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-21T16:49:22.487

如果是`POST`表单，则无需在以下声明中声明参数`route`：

```
POST  /login/submit           controllers.Users.loginSubmit() 
```

模板：

```
<!-- syntax: @routes.ControllerName.methodName() -->
<form method="post" action="@routes.Users.loginSubmit()">
  <input type="text" name="username" /><br/>
  <input type="password" name="password" /><br/>

  <input type="submit" value="Login" />
</form> 
```

进口：

```
import play.data.DynamicForm;
import play.data.Form; 
```

控制器：

```
public static Result loginSubmit(){
    DynamicForm dynamicForm = Form.form().bindFromRequest();
    Logger.info("Username is: " + dynamicForm.get("username"));
    Logger.info("Password is: " + dynamicForm.get("password"));
    return ok("ok, I recived POST data. That's all...");
} 
```

## 模板表单助手

Play 的模板中也有[表单模板助手](http://www.playframework.org/documentation/2.0.2/JavaFormHelpers)可用于创建表单，因此可以执行以下操作：

```
@helper.form(action = routes.User.loginSubmit()) {
    <input type="text" name="username" /><br/>
    <input type="password" name="password" /><br/>

    <input type="submit" value="Login" />
} 
```

它们在处理大型和/或`pre-filled`表单时特别有用

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-07-04T05:24:46.163

在 Play Framework 版本 2.5.x [Form.form() 已弃用](https://www.playframework.com/documentation/2.5.0/api/java/play/data/Form.html)，您应该使用[**注入 FormFactory**](https://www.playframework.com/documentation/2.5.0/api/java/play/data/FormFactory.html)

在这里您可以找到示例：[Form 类中的方法 form(Class) 在 Play 中已弃用！框架](https://stackoverflow.com/a/36114338/6309821)

进口：

```
import play.data.DynamicForm;
import play.data.FormFactory; 
```

注入：

```
@Inject FormFactory formFactory; 
```

控制器：

```
public static Result loginSubmit(){
    DynamicForm dynamicForm = formFactory.form().bindFromRequest();
    Logger.info("Username is: " + dynamicForm.get("username"));
    Logger.info("Password is: " + dynamicForm.get("password"));
    return ok("ok, I recived POST data. That's all...");
} 
```

# javascript - Jquery 日期计算 JQUERY4U

> ID：12059153
> 
> 赞同：0
> 
> 时间：2012-08-21T16:22:28.500
> 
> 标签：javascript, jquery

我一直在尝试实现以下脚本，它看起来像是一个建立在 Jquery 之上的很棒的日期计算库。

[http://www.jquery4u.com/jquery-functions/datetime-functions-complete-listing/](http://www.jquery4u.com/jquery-functions/datetime-functions-complete-listing/)

我对 Jquery 和 Javascript 的基本知识不足以使其正常工作，因此我正在寻求使用方面的帮助。

我已将文件加载到我想使用它的页面的标题中，并尝试调用以下函数但未成功：

```
JQUERY4U.DATETIME.futureDateDays(1);
DATETIME.futureDateDays(1);
futureDateDays(1); 
```

各种其他尝试似乎都不起作用。我知道我可能错过了一些简单的东西。

我的目标是为 datetime 函数的结果设置一个变量。

此外，如果您能提供脚本中日期格式部分的使用示例，那就太好了。

我知道你们中的一些 Jquery 和 Javascript 忍者将能够在 90 秒内解决这个问题。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:39:10.027

这是一个 jsFiddle 应该有你需要的东西：

[http://jsfiddle.net/dKGkY/1/](http://jsfiddle.net/dKGkY/1/)

您需要三个函数，希望示例中有足够的内容来解释它们的作用。您显然可以根据自己的要求更改所需的任何内容，但希望这就是您所需要的！如果您需要帮助修改或使用它们，请告诉我。

# sql - 将临时表与选择查询合并

> ID：12059154
> 
> 赞同：0
> 
> 时间：2012-08-21T16:22:33.580
> 
> 标签：sql, tsql

我想将 TempTable 列“Rad”添加到如下所示的选择查询中：

表：临时表

```
Date        Rad.
----------------------
2012-08-09  610.345802
2012-08-10  589.090580
2012-08-11  525.193952
2012-08-12  518.484953
2012-08-13  251.790038
2012-08-14  461.892979 
```

表：每日

```
Date        Time      Precipitation   WindChill  DewPoint
----------------------------------------------------------
2012-08-09  00:00:00  0.000273        27.844708  19.1826
2012-08-09  00:10:00  0.697821        25.311829  19.2645
2012-08-09  00:20:00  2.097455        27.968444  19.4142
2012-08-09  00:30:00  1.033763        25.705078  19.3842
2012-08-09  00:40:00  1.008760        26.343726  19.4563
2012-08-09  00:50:00  0.973456        26.869532  19.5293
.
.
. 
```

表：预期结果

```
Date        Rad.        Precipitation  WindChill  DewPoint
----------------------------------------------------------
2012-08-09  610.345802  0.005789       28.903764  19.9802
2012-08-10  589.090580  0.763590       27.903685  19.7265
2012-08-11  525.193952  0.998734       24.574824  19.4351
2012-08-12  518.484953  0.334567       29.909372  20.4865
2012-08-13  251.790038  0.789032       27.902474  18.7653
2012-08-14  461.892979  0.123567       26.987688  18.9876 
```

有了这个查询，

```
SELECT Daily.[Date],    
       AVG(Daily.[Precipitation]) as [Precipitation],

       ##TempTable.[Rad.],

       AVG(Daily.[Wind Chill]) as [Wind Chill], 
       AVG(Daily.[Dew Point]) as [Dew Point]
FROM Daily
INNER JOIN ##TempTable
ON DAY(Daily.[Date]) = DAY(##TempTable.[Date])
GROUP BY Daily.[Date], ##TempTable.[Rad.] 
```

**问题是查询结果不是“匹配”或与两个表正确同步。因此，我扔了 14 行而不是 6 行。**

当前结果：

```
Date    Rad.            Date            Precipitation   Wind Chill  Dew Point
------------------------------------------------------------------------------------
2012-08-18  541.917573  2012-08-18  0.000000    1.460818    NULL
2012-08-12  518.484953  2012-08-12  0.000273    1.854153    NULL
2012-08-17  327.291210  2011-08-17  0.000000    0.000000    18.453193
2012-08-15  428.649430  2012-08-15  0.000536    1.170602    NULL
2012-08-09  610.345802  2012-08-09  0.000014    1.008784    NULL
2012-08-10  589.090580  2012-08-10  0.000000    1.402685    NULL
2012-08-13  251.790038  2012-08-13  0.000882    0.691585    NULL
2012-08-18  541.917573  2011-08-18  0.000000    0.000006    17.041953
2012-08-16  536.200291  2012-08-16  0.000028    1.120068    NULL
2012-08-19  597.631053  2011-08-19  0.000000    0.000006    16.056780
2012-08-19  597.631053  2012-08-19  0.000000    1.565405    NULL
2012-08-14  461.892979  2012-08-14  0.000390    1.196409    NULL
2012-08-17  327.291210  2012-08-17  0.001301    0.886275    NULL
2012-08-11  525.193952  2012-08-11  0.000000    2.076477    NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T04:49:52.053

我猜您`time`在查询中包含该字段。我使用了以下查询并返回了 6 条记录，但如果我包含了`time`我会得到更多：

```
select *
from temp t
inner join
(
  select dt,
    AVG([Precip]) as [Precipitation],
    AVG([Wind]) as [Wind Chill], 
    AVG([Dew]) as [Dew Point]
  from daily
  group by dt
) d
  on DAY(t.[Dt]) = DAY(d.[Dt]) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/29cd9/14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:31:52.377

您需要按以下方式分组`DAY(Daily.[Date])`：

```
SELECT DAY(Daily.[Date]),     
       AVG(Daily.[Precipitation]) as [Precipitation], 

       ##TempTable.[Rad.], 

       AVG(Daily.[Wind Chill]) as [Wind Chill],  
       AVG(Daily.[Dew Point]) as [Dew Point] 
FROM Daily 
INNER JOIN ##TempTable 
ON DAY(Daily.[Date]) = DAY(##TempTable.[Date]) 
GROUP BY DAY(Daily.[Date]), ##TempTable.[Rad.] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T19:26:49.257

```
SELECT DATEADD(DD, DATEDIFF(DD,0,Daily.[Date]),0) Date,    
       AVG(Daily.[Precipitation]) as [Precipitation],

       ##TempTable.[Rad.],

       AVG(Daily.[Wind Chill]) as [Wind Chill], 
       AVG(Daily.[Dew Point]) as [Dew Point]
FROM Daily
INNER JOIN ##TempTable
ON DATEADD(DD, DATEDIFF(DD,0,Daily.[Date]),0) = ##TempTable.[Date]
GROUP BY DATEADD(DD, DATEDIFF(DD,0,Daily.[Date]),0), ##TempTable.[Rad.] 
```

类似的东西就是你想要的。如果你使用这个`day(date)`函数，你会遇到问题，因为它只返回月份的日期。

# wpf - DataGridTemplateColumn 颜色

> ID：12059159
> 
> 赞同：1
> 
> 时间：2012-08-21T16:22:47.737
> 
> 标签：wpf, data-binding, binding, wpfdatagrid

我试图在 DataGrid 中创建一个列，它只不过是一个纯色的矩形。此列使用以下 XAML 定义。

```
<DataGrid x:Name="MeasurementGrid" AutoGenerateColumns="False"
          AlternatingRowBackground="Azure" SelectionUnit="FullRow"
          HeadersVisibility="Column" VerticalGridLinesBrush="AntiqueWhite"
          HorizontalGridLinesBrush="AntiqueWhite">
    <DataGrid.Columns>
        <DataGridTemplateColumn>
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <Rectangle Width="16" Height="16">
                        <Rectangle.Fill>
                            <SolidColorBrush Color="{Binding Path=Color, Mode=OneWay}" />
                        </Rectangle.Fill>
                    </Rectangle>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>                                
        <DataGridTextColumn Header="Energy" Width="75" Binding="{Binding Path=Energy}"></DataGridTextColumn>
        <DataGridTextColumn Header="Field Size" Width="100" Binding="{Binding Path=FieldSize}"></DataGridTextColumn>
        <DataGridTextColumn Header="Type" Width="200" Binding="{Binding Path=FriendlyType}"></DataGridTextColumn>
        <DataGridTextColumn Header="Depth" Width="75" Binding="{Binding Path=Depth}"></DataGridTextColumn>
    </DataGrid.Columns>
</DataGrid> 
```

问题是，虽然我的这个网格的数据源确实有一个名为“Color”的属性，但我的 XAML 中定义的solidcolorbrush 没有使用这个值。可以看出，我确实有其他列也绑定了，并且在运行时进行了适当的绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T12:31:36.527

作为 WPF 的新手，这个问题一开始并不明显。此 DataGrid 绑定到的自定义数据对象有一个名为“Color”的 System.Drawing.Color 类型的属性。由于 WPF 使用 System.Windows.Media.Color，我被迫创建自己的值转换器类。它在下面。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Data;
using System.Windows.Media;

namespace WpfTchartTest.Converters
{
    class WinFormsColorToWpfColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            System.Drawing.Color color = (System.Drawing.Color)value;

            System.Windows.Media.Color converted = System.Windows.Media.Color.FromArgb(
                color.A, color.R, color.G, color.B);

            return converted;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return null;
        }
    }
} 
```

然后，我只需将其作为资源添加到我的用户界面，并在绑定到 WinForms“颜色”时使用以下语法...

```
<UserControl.Resources>
        <conv:WinFormsColorToWpfColorConverter x:Key="WinFormsColorToWpfColor" />
</UserControl.Resources>

<SolidColorBrush Color="{Binding Path=Color, Converter={StaticResource ResourceKey=WinFormsColorToWpfColor}}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T20:47:38.393

对不起，我无法复制这个。

我在 Visual C# Express 2010 中创建了一个新的 WPF 应用程序，将您的 DataGrid 复制到 MainWindow.xaml，并修改了 MainWindow.xaml.cs 中的代码以包含以下内容：

```
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Media;

namespace MyNamespace
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            List<Color> colors = new List<Color>() { Colors.Red, Colors.Green, Colors.Blue };
            MeasurementGrid.ItemsSource = colors.Select(color => new Colored() { Color = color }).ToList();
        }
    }

    public class Colored
    {
        public Color Color { get; set; }
    }
} 
```

当我运行应用程序时，我在第一列得到了一个带有彩色矩形的网格。

（在实际应用程序中，该类`Colored`将实现`INotifyPropertyChanged`并且`colors`将是 a`ObservableCollection`而不是 a `List`。出于本演示的目的，我们将把这些细节放在一边。）

# java - 我试图调用的方法没有返回值

> ID：12059163
> 
> 赞同：1
> 
> 时间：2012-08-21T16:22:59.810
> 
> 标签：java, methods, symbols

我正在尝试将方法的返回分配给 int，但它给了我一个错误“找不到符号符号：变量 columnResult”

这是代码：

```
public void start() {
    String inputString = "XOXOXOO     X     XXO         X     OXO   ";

    columnResult();
    int column = columnResult;

    enterToken("X", inputString,column);    

  }
  private int columnResult(){
    System.out.println("Enter column for X:");
    String keyInput = Keyboard.readInput();
    int column1 = Integer.parseInt(keyInput);
    return column1;
  } 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:27:02.153

你应该直接写

```
int column = columnResult(); 
```

因为它是一个返回 int 的方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T16:25:30.130

尝试

```
int column = columnResult(); 
```

而不是 columnResult(); int 列 = 列结果；

您必须将函数的结果赋给整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:27:16.107

改成 -

```
int column = columnResult(); 
```

通过调用`columnResult();`而不是分配返回的值，您将失去它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T16:24:47.377

你应该做

```
int column = columnResult();

not 

int column = columnResult; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T16:25:31.607

```
columnResult();
int column = columnResult; 
```

应该

```
int column = columnResult(); 
```

# c++ - 将函数作为参数传递给不同的函数

> ID：12059164
> 
> 赞同：0
> 
> 时间：2012-08-21T16:23:01.660
> 
> 标签：c++, function-pointers

我正在尝试将函数作为参数传递给不同的函数。

由于某种原因，它不起作用。

```
//myClass.h
class MyClass
{
public:

typedef int (*MyClass::ptrToMember)(float, char);

  ptrToMember p1;
  MyClass::MyClass();
  void hello(ptrToMember fun);

  int SendIt (float a, char b); 

};

//MyClass.cpp
MyClass::MyClass(){
  p1 = &(MyClass::SendIt);
  hello(p1);

}
int MyClass::SendIt (float a, char b) 
{ 
  std::cout << "MyClass::SendIt "<<a<<std::endl; 

  return 1; 
}

void MyClass::hello(ptrToMember fun){

 int result = (*fun)(12, 'a');
  std::cout << result << std::endl;
} 
```

如果有人能告诉我我的错误是什么，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T16:25:18.587

```
typedef int (*MyClass::ptrToMember)(float, char);
             ^
// your mistake is here 
```

指向类成员函数的指针声明如下：

```
typedef int (MyClass::*ptrToMember)(float, char);
                      ^ 
```

并像这样调用（测试是类实例 - 也可以是'this'）：

```
 (test.*pointer)(parameters) // if test is automatically allocated 
```

或者

```
 (test->*pointer)(parameters) // if test is a pointer 
```

decleration 运算符是`::*`，而调用指向成员函数的指针的运算符是`.*`and `->*`。

**编辑：**

这一行：

```
p1 = &(MyClass::SendIt); 
```

实际上必须是：

```
p1 = &MyClass::SendIt; // without parentheses 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:25:08.593

说这个：

```
typedef int (MyClass::*ptrToMember)(float, char);

// ...

int result = (this->*fun)(12, 'a'); 
```

# nhibernate - Linq to Nhibernate - Select 中的调用方法会中断 IQueryable

> ID：12059170
> 
> 赞同：2
> 
> 时间：2012-08-21T16:23:09.667
> 
> 标签：nhibernate, linq-to-nhibernate

我需要`IQueryable`在基于域实体的业务逻辑程序集中。由于大量类似实体，我想为此目的使用自动映射器。

作品：

```
_repository.GetList<AgentDto>()
        .Select(dto => new Agent{Login = dto.Login, Password = dto.Password})
        .Where(...).ToList(); 
```

不起作用（我`Where`之前无法放置（另一个组件）`Select`）：

```
_repository.GetList<AgentDto>()
        .Select(dto => ToAgent(dto))
        .Where(...).ToList();

private Agent ToAgent(AgentDto dto)
    {
        return new Agent{Login = dto.Login, Password = dto.Password};
    } 
```

例外：

```
System.NotSupportedException was caught
  Message=CustomerInfo.Domain.Support.Agent ToAgent(CustomerInfo.DAL.DTO.AgentDto)
  Source=NHibernate
  StackTrace:
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitMethodCallExpression(MethodCallExpression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitExpression(Expression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitMemberExpression(MemberExpression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitExpression(Expression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitBinaryExpression(BinaryExpression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitExpression(Expression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitBinaryExpression(BinaryExpression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.VisitExpression(Expression expression)
       at NHibernate.Linq.Visitors.HqlGeneratorExpressionTreeVisitor.Visit(Expression expression, VisitorParameters parameters)
       at NHibernate.Linq.Visitors.QueryModelVisitor.VisitWhereClause(WhereClause whereClause, QueryModel queryModel, Int32 index)
       at Remotion.Linq.Clauses.WhereClause.Accept(IQueryModelVisitor visitor, QueryModel queryModel, Int32 index)
       at Remotion.Linq.QueryModelVisitorBase.VisitBodyClauses(ObservableCollection`1 bodyClauses, QueryModel queryModel)
       at Remotion.Linq.QueryModelVisitorBase.VisitQueryModel(QueryModel queryModel)
       at NHibernate.Linq.Visitors.QueryModelVisitor.Visit()
       at NHibernate.Linq.Visitors.QueryModelVisitor.GenerateHqlQuery(QueryModel queryModel, VisitorParameters parameters, Boolean root)
       at NHibernate.Linq.NhLinqExpression.Translate(ISessionFactoryImplementor sessionFactory)
       at NHibernate.Hql.Ast.ANTLR.ASTQueryTranslatorFactory.CreateQueryTranslators(String queryIdentifier, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 filters, ISessionFactoryImplementor factory)
       at NHibernate.Engine.Query.HQLExpressionQueryPlan.CreateTranslators(String expressionStr, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)
       at NHibernate.Engine.Query.HQLExpressionQueryPlan..ctor(String expressionStr, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)
       at NHibernate.Engine.Query.HQLExpressionQueryPlan..ctor(String expressionStr, IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)
       at NHibernate.Engine.Query.QueryPlanCache.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters)
       at NHibernate.Impl.AbstractSessionImpl.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow)
       at NHibernate.Impl.AbstractSessionImpl.CreateQuery(IQueryExpression queryExpression)
       at NHibernate.Linq.DefaultQueryProvider.PrepareQuery(Expression expression, IQuery& query, NhLinqExpression& nhQuery)
       at NHibernate.Linq.DefaultQueryProvider.Execute(Expression expression)
       at NHibernate.Linq.DefaultQueryProvider.Execute[TResult](Expression expression)
       at System.Linq.Queryable.Count[TSource](IQueryable`1 source, Expression`1 predicate)
       at CustomerInfo.BLL.Authentication.AgentManagementService.ValidateAgent(String agentLogin, String password) in D:\Projects\CustomerInfo\CustomerInfo.BLL\Authentication\AgentManagementService.cs:line 49
  InnerException: 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T16:44:29.843

您需要考虑 NHibernate Linq 提供程序是如何工作的。它无法处理你扔给它的所有东西。NHibernate 的 Linq 提供程序将 lambda 表达式转换为 HQL，并最终转换为 SQL。它只能支持有限的表达式子集。您作为表达式输入的任何内容都必须可转换为 SQL 并在数据库引擎本身中执行。

NHibernate Linq 提供程序是[可扩展](http://fabiomaulo.blogspot.com/2010/07/nhibernate-linq-provider-extension.html)的。如果您需要使用一些 NH Linq 提供程序不支持的表达式，并且您认为它们可以用 SQL 表示，您可以编写自己的[扩展](http://www.primordialcode.com/blog/post/nhibernate-3-extending-linq-provider-fix-notsupportedexception)。

但是，您的情况非常简单。你不需要扩展 NHibernate 来做到这一点。NHibernate Linq 提供程序不支持您的表达式，但 Linq to objects 支持。只需颠倒查询中的顺序，它应该可以按预期工作：

```
_repository.GetList<AgentDto>()
    .Where(...).ToList()
    .Select(dto => ToAgent(dto)).ToList(); 
```

`.ToList()`after`.Where()`将执行 NHibernate 查询并返回`AgentDto`对象列表。`.Select`之后的方法实际上是作为 Linq to objects 执行的 -`AgentDto`在内存中的对象列表上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-20T13:25:15.370

我认为，如果您只是将 Where 放在 Select 之前，就可以了。

# android - 获取选定的 ListView 项目时出现问题

> ID：12059180
> 
> 赞同：0
> 
> 时间：2012-08-21T16:24:05.473
> 
> 标签：android, listview, android-layout, android-listview

我在尝试在列表视图中选择项目时遇到问题。我的活动有一个选项卡式布局，其中一个布局中有一个 ListView。

以下是我填充 Listview 的方式： 这是我在 XML 中声明 ListView 的方式：

Category_list_display.xml

```
<?xml version="1.0" encoding="utf-8"?>
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/category_view"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:entries="@array/category_options">
</ListView> 
```

下面是我用于填充 ListView 的数组：

```
category_values.xml

<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="category_options">
        <item >Operating Systems</item>
        <item >Programming</item>
    </string-array>

</resources> 
```

下面是java代码：

```
 package com.cheats;

    import android.os.Bundle;
    import android.support.v4.app.FragmentTransaction;
    import android.view.Window;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.ArrayAdapter;
    import android.widget.ListView;
    import android.widget.TextView;
    import android.widget.Toast;
    import android.view.View;

    import com.actionbarsherlock.app.SherlockActivity;
    import com.actionbarsherlock.view.Menu;
    import com.actionbarsherlock.view.MenuItem;
    import com.actionbarsherlock.app.ActionBar;
    import com.actionbarsherlock.app.ActionBar.Tab;

    public class LandingPage extends SherlockActivity implements
            ActionBar.TabListener {

        private String[] tab_options = { "Categories", "Bookmarks", "Downloads" };
        private ListView category_tab_list;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setTheme(R.style.Theme_Sherlock_Light_DarkActionBar);
            requestWindowFeature(Window.FEATURE_NO_TITLE);
            setContentView(R.layout.splash_screen);

            getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
            for (int i = 0; i <= 2; i++) {
                ActionBar.Tab tab = getSupportActionBar().newTab();
                tab.setText("Tab " + i);
                tab.setTabListener(this);
                tab.setText(tab_options[i]);
                getSupportActionBar().addTab(tab);
            }
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {

            menu.add("New Update").setIcon(android.R.drawable.ic_menu_view)
                    .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);

            menu.add("Search")
                    .setIcon(R.drawable.ic_search)
                    .setActionView(R.layout.collapsible_edittext)
                    .setShowAsAction(
                            MenuItem.SHOW_AS_ACTION_ALWAYS
                                    | MenuItem.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW);

            return true;
        }

        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub
            int nTabSelected = tab.getPosition();

            switch (nTabSelected) {

            case 0:
                setContentView(R.layout.category_list_display);
                category_tab_list = (ListView) findViewById(R.id.category_view);
                category_tab_list.setOnItemClickListener(new OnItemClickListener() {
                    public void onItemClick(AdapterView<?> myAdapter, View myView,
                            int myItemInt, long mylng) {
                        int selectedPosition = myAdapter.getSelectedItemPosition();
                        Toast.makeText(getApplicationContext(), myItemInt, Toast.LENGTH_SHORT).show();                  
                    }
                });
                break;
            case 1:
                setContentView(R.layout.splash_screen);
                break;
            case 2:
                setContentView(R.layout.splash_screen);
                break;
            }
        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft) {
            // TODO Auto-generated method stub

        }
    } 
```

当我尝试运行上述代码时，我在 logcat 中得到以下信息：

```
 08-21 15:23:56.319: E/AndroidRuntime(1330): FATAL EXCEPTION: main
    08-21 15:23:56.319: E/AndroidRuntime(1330): android.content.res.Resources$NotFoundException: String resource ID #0x0
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.content.res.Resources.getText(Resources.java:201)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.widget.Toast.makeText(Toast.java:258)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at com.cheats.LandingPage$1.onItemClick(LandingPage.java:72)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.widget.AdapterView.performItemClick(AdapterView.java:284)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.widget.ListView.performItemClick(ListView.java:3513)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.os.Handler.handleCallback(Handler.java:587)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.os.Handler.dispatchMessage(Handler.java:92)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.os.Looper.loop(Looper.java:123)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at android.app.ActivityThread.main(ActivityThread.java:3683)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at java.lang.reflect.Method.invokeNative(Native Method)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at java.lang.reflect.Method.invoke(Method.java:507)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
    08-21 15:23:56.319: E/AndroidRuntime(1330): at dalvik.system.NativeStart.main(Native Method) 
```

我相信错误是由于适配器无法获得位置而出现的。我没有任何明确的适配器，因为我通过 XML 直接将数组链接到 ListView。我想以这种方式保留代码。有没有办法解决这个问题并将选定的值传递给具有新意图的新活动？

我将不胜感激任何帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T16:29:47.433

我能够通过执行以下操作来解决我的问题：

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    final String[] links = getResources().getStringArray(R.array.tut_titles);
    String link = links[position];
    Intent i = new Intent(Intent.ACTION_VIEW);  
    i.setData(Uri.parse(link));  
    startActivity(i);          
} 
```

# c++ - 记录谷歌测试

> ID：12059187
> 
> 赞同：10
> 
> 时间：2012-08-21T16:24:16.753
> 
> 标签：c++, doxygen, c-preprocessor, googletest

我最近开始使用谷歌测试来帮助我完成测试程序。它运行良好，但现在我的测试用例正在增长......

```
#include <gtest/gtest.h>

TEST(MyTest, FirstTest) {
    // stuff
};

TEST(MyTest, SecondTest) {
    // stuff
};

TEST(MyTest, ThirdTest) {
    // stuff
};

int main(int argc, char* argv[]) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}; 
```

我想为我的所有测试创建一个很好的自动生成的文档，这些测试将与我的程序文档分开。为此，我通常使用 doxygen，但谷歌测试使用宏，目前尚不清楚 doxygen 如何处理它。更准确地说，我们有

```
#define TEST(test_case_name, test_name)\
  GTEST_TEST_(test_case_name, test_name, \
             ::testing::Test, ::testing::internal::GetTestTypeId()) 
```

我试过

```
/** 
* @def TEST(MyTest, FirstTest)
* @brief My first test
*/
TEST(MyTest, FirstTest) {
    // stuff
}; 
```

但它不会在 doxygen 上产生任何输出......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-21T17:35:30.610

显然，您的问题刚刚得到了 Rob Kennedy 的回答。但尽管如此，我想提供一种完全不同的方法。

我使用`RecordProperty()`gtest 的方法`description`在测试日志 XML 中创建一个额外的属性，并将测试方法正在做什么的简短描述作为字符串文字传递给它。我创建了一个名为的小宏`TEST_DESCRIPTION`，它应该在任何测试用例中作为第一条语句调用：

```
#define TEST_DESCRIPTION(desc) RecordProperty("description", desc)

TEST(MyTest, SecondTest) {
    TEST_DESCRIPTION("This test does 'stuff'");
    // stuff
}; 
```

此外，我还有一个简单的 XSLT 转换，它从 XML 测试日志输出创建 HTML 测试报告并显示此`@description`属性。

这种方法的一个缺点是描述属性不会出现在禁用的测试中，因为`RecordProperty()`当然不会为那些测试执行。

整个事情是在我的老板要求单元测试的测试用例描述时发明的，我不想在单独的工具中描述这些（例如，我们有 Polarion 用于需求分析，你也可以在那里描述测试场景），因为这很可能很快变得不一致。

但也许 doxygen 可以提供额外的好处，因为它能够显示来自您的测试方法的调用引用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-21T17:33:57.600

您正在使用`@def`，但这是宏定义的命令。该命令后面没有`#define`语句，因此 Doxygen 忽略它。函数的 Doxygen 命令是`@fn`，因此请改用它。

还要记住，要让 Doxygen 记录全局函数，也需要记录封闭*文件。*

# c++ - 指针问题

> ID：12059188
> 
> 赞同：4
> 
> 时间：2012-08-21T16:24:20.867
> 
> 标签：c++, class, pointers

```
#include "stdafx.h"
#include <iostream>
#include <vector>
#include <string>

using namespace std;

class Person
{
    public:
    Person();
    Person(string input_name, int input_age);
    void read(string input_name, int input_age);
    void print() const;

    private:
    string name;
    int age;
};

Person::Person()
{
name = " ";
age = 0;
}

Person::Person(string input_name, int input_age)
{
name = input_name;
age = input_age;
}
void Person::read(string input_name, int input_age)
{
name = input_name;
age = input_age;
}

void Person::print() const
{
cout << "Name: " << name << " Age: " << age << endl;
}

class Car
{
public:
Car();
Car(string input_model, Person* p_input_owner, Person* p_input_driver);
void read(string input_model, Person* p_input_owner, Person* p_input_driver);
void print() const;

private:
string model;
Person* p_owner;
Person* p_driver;
};

Car::Car()
{
model = " ";
p_owner = NULL;
p_driver = NULL;
}

Car::Car(string input_model, Person* p_input_owner, Person* p_input_driver)
{
model = input_model;
p_owner = p_input_owner;
p_driver = p_input_driver;
}

void Car::read(string input_model, Person* p_input_owner, Person* p_input_driver)
{
model = input_model;
p_owner = p_input_owner;
p_driver = p_input_driver;
}

void Car::print() const
{
cout << "Model: " << model << " Owner: " << p_owner << " Driver: " << p_driver << endl;
}

int main()
{
vector<Person*> people(4);
vector<Car*> cars;
string input_name;
int input_age = 0;
string remainder;

for(int i = 0; i < people.size(); i++)          
{
    cout << "Enter the person's name: ";
    getline(cin, input_name);
    cout << "Enter the person's age: ";
    cin >> input_age;

    people[i]->read(input_name, input_age);
}

for(int i = 0; i < people.size(); i++)
{
    people[i]->print();
}

return 0;
} 
```

我正在尝试为学校编写一个程序，该程序使用 Person* 和 Car* 类型的向量。这是我到目前为止所拥有的，代码编译得很好，但是当我开始填充人物向量时，程序崩溃了，我得到了一个异常错误。

我不想让任何人为我做作业，只要给我指出正确的方向，我就可以继续前进。

感谢你给与我的帮助。

显然代码不完整，我目前只是试图填充人员向量。一旦可行，我将继续讨论汽车矢量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:26:26.077

您调用从未实例化的对象的成员函数，即从未分配的指针。也就是说，在调用之前，`people[i]->read`您应该为`people[i]`、like`new Person()`或分配一些东西`new Person(input_name,input_age)`。

一般来说，如果你有一行导致你的问题崩溃并且你不能通过阅读你的代码来解决它，你可能只是打印出所涉及的变量。喜欢`people[i]`。这可能`NULL`会给你一些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:31:03.903

在崩溃点，`people[i]`持有一个空指针，因此调用`read()`它会产生未定义的行为。至少，代码应该`Person`为每个指针创建一个对象。但：

难道`people`真的要持有指针？更自然的方法是让它简单地成为一个`vector<Person>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T04:10:28.433

```
#include "stdafx.h"
#include <iostream>
#include <vector>
#include <string>

using namespace std;
/*
Person class with members name and age
*/
class Person
{
public:
/*
default constructor
*/
Person();
/*
creates Person object with parameters
@param input_name the name of the person
@param input_age the age of the person
*/
Person(string input_name, int input_age); // constructor with inputs
/*
method to read person data
@param input_name the name of the person
@param input_age the age of the person
*/
void read(string input_name, int input_age);
/*
method that returns the age of the person
@return returns the age of the person
*/
int get_age() const;
/*
method that returns the name of the person
@return returns the name of the person
*/
string get_name() const;
/*
increments the age of the person by 1 year
*/
void update_age();

private:
string name;
int age;
};

Person::Person()
{
name = " ";
age = 0;
}

Person::Person(string input_name, int input_age)
{
name = input_name;
age = input_age;
}
void Person::read(string input_name, int input_age)
{
name = input_name;
age = input_age;
}

int Person::get_age() const
{
return age;
}

string Person::get_name() const
{
return name;
}

void Person::update_age()
{
age = age + 1;  
}

class Car
{
public:
/*
default constructor
*/
Car();
/*
creates an object of Car with parameters
@param input_model the model of the car
@param p_input_owner the owner of the car, type Person
@param p_input_driver the driver of the car, type Person
*/
Car(string input_model, Person* p_input_owner, Person* p_input_driver);
/*
method to read the car data
@param input_model the model of the car
@param p_input_owner the owner of the car, type Person
@param p_input_driver the driver of the car, type Person
*/
void read(string input_model, Person* p_input_owner, Person* p_input_driver);
/*
method that returns the model of the car
@return the model of the car
*/
string get_model() const;
private:
string model;
Person* p_owner;
Person* p_driver;
};

Car::Car()
{
model = " ";
p_owner = NULL;
p_driver = NULL;
}

Car::Car(string input_model, Person* p_input_owner, Person* p_input_driver)
{
model = input_model;
p_owner = p_input_owner;
p_driver = p_input_driver;
}

void Car::read(string input_model, Person* p_input_owner, Person* p_input_driver)
{
model = input_model;
p_owner = p_input_owner;
p_driver = p_input_driver;
}

string Car::get_model() const
{
return model;
}

int main()
{
int const NUMBER_OF_CARS = 3; // using a constant for the number of cars, can take this as input if desired
vector<Person*> people(NUMBER_OF_CARS * 2); // 2 people for each car, vector is 2 * NUMBER_OF_CARS
vector<Car*> cars(NUMBER_OF_CARS); // Sets the size of cars to the constant NUMBER_OF_CARS value

// declare variables
string input_name_owner;
string input_name_driver;
int input_age_owner = 0;
int input_age_driver = 0;
string remainder;
string input_model;
Person* temp_owner;
Person* temp_driver;

for(int i = 0; i < cars.size(); i++)            
{
    /*
    use 3 variables to increment the vectors to accurately to input the car, owner and driver
    Example of the math:
    a =      0   1   2   3   The cars vector elements
    a+b =    0   2   4   6   The people vector owner elements
    a+b+c =  1   3   5   7   The people vector driver elements
    no matter the size of the vectors, the input will populate the 
    vectors properly
    */
    int a = i;
    int b = i;
    int c = 1;

    // initialize all elements of the vectors
    cars[a] = new Car();
    people[a+b] = new Person();
    people[a+b+c] = new Person();
    // get user input
    cout << "Enter the model of the car: ";
    getline(cin, input_model);

    cout << "Enter the owner's name: ";
    getline(cin, input_name_owner);

    cout << "Enter the owner's age: ";
    cin >> input_age_owner;
    getline(cin, remainder); // empty the remainder of the input string

    cout << "\nEnter the driver's name: ";
    getline(cin, input_name_driver);

    cout << "Enter the driver's age: ";
    cin >> input_age_driver;
    getline(cin, remainder); // empty the remainder of the input string
    cout << endl;

    people[a+b]->read(input_name_owner, input_age_owner);
    people[a+b+c]->read(input_name_driver, input_age_driver);
    temp_owner = people[a+b];
    temp_driver = people[a+b+c];
    cars[a]->read(input_model, temp_owner, temp_driver);
}

for(int i = 0; i < cars.size(); i++)
{
    /*
    same theory for the output of the vector elements
    */
    int a = i;
    int b = i;
    int c = 1;
    cout << "Model: " << cars[a]->get_model() << endl;
    cout << "Owner's name: " << people[a+b]->get_name() << endl;
    cout << "Owner's age: " << people[a+b]->get_age() << endl;
    cout << "Driver's name: " << people[a+b+c]->get_name() << endl;
    cout << "Driver's age: " << people[a+b+c]->get_age() << endl;
    cout << endl;
}

// increment ages of owners and drivers by 1
for (int i = 0; i < people.size(); i++)
{
    people[i]->update_age();
}

// output the model, owner and driver with updated age
for(int i = 0; i < cars.size(); i++)
{
    int a = i;
    int b = i;
    int c = 1;
    cout << "Model: " << cars[a]->get_model() << endl;
    cout << "Owner's name: " << people[a+b]->get_name() << endl;
    cout << "Owner's age: " << people[a+b]->get_age() << endl;
    cout << "Driver's name: " << people[a+b+c]->get_name() << endl;
    cout << "Driver's age: " << people[a+b+c]->get_age() << endl;
    cout << endl;
}

// delete unused pointers   
for (int i = 0; i < cars.size(); i++)
{
    delete cars[i];
}
for (int i = 0; i < people.size(); i++)
{
    delete people[i];
}

// pause for user input
system("pause");

return 0;
} 
```

好的，谢谢大家的帮助，这里是“完成”的代码。它有效，但可能并不漂亮。任务是创建一个 Car 类，它有 3 个成员，汽车的型号、车主、具有姓名和年龄的 Person* 类型的对象以及汽车的司机，还有一个具有姓名和年龄的 Person*。从用户那里获取输入并将它们存储在 Car* 和 Person* 的向量中（为什么我不知道指针），将司机的年龄增加一年并输出汽车和司机。

再次感谢您让我朝着正确的方向前进。

希望获得有关如何使代码更高效并且仍然符合练习标准的反馈。

我把它按原样交了。

# ada - 在 Linux 中运行 GNAT GPS 的可执行文件的名称是什么？

> ID：12059192
> 
> 赞同：3
> 
> 时间：2012-08-21T16:24:31.910
> 
> 标签：ada, gnat, gnat-gps

它刚刚在我的机器上安装了这个。我正在尝试查找运行 GNAT GPS 的可执行文件的名称。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:55:57.213

对于 Linux 和 Mac OS X 上的 GNAT GPL，有一个脚本`gps`可以根据实际可执行文件的要求设置环境变量`gps_exe`，然后调用它。

对于 Debian（无论如何，挤压），只有`/usr/bin/gnat-gps`.

# size - 需要帮助以使用 php 获取系统信息

> ID：12059194
> 
> 赞同：-2
> 
> 时间：2012-08-21T16:24:35.347
> 
> 标签：size, monitor

这是否可以获得访问我网站的用户的屏幕/显示器大小？？？我正在使用 php 作为前端...

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:30:14.320

你可以通过使用javascript来做到这一点：

```
window.screen.availHeight
window.screen.availWidth 
```

# ios - OpenEars Text-to-Speech 质量非常低

> ID：12059198
> 
> 赞同：1
> 
> 时间：2012-08-21T16:24:51.293
> 
> 标签：ios, text-to-speech, openears

我正在设计一个类似英语词典的应用程序并使用[OpenEars TTS](http://www.politepix.com/openears/)进行发音，但语音质量不太好。有什么提高音质的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-18T18:09:16.930

如果你支持 iOS7 及以上版本，可以考虑使用[AVSpeechSynthesizer](https://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVSpeechSynthesizer_Ref/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-18T14:24:16.757

您可以做的是直接与他们联系并说明您的问题。这是他们联系网站的链接：[http ://www.politepix.com/contact/](http://www.politepix.com/contact/)

回答您的问题的最佳方法是在他们的论坛中，这里是链接：[http ://www.politepix.com/forums/forum/openearsforum/](http://www.politepix.com/forums/forum/openearsforum/)

他们也有私人支持服务，但这会花费你一些钱，但这里是链接：[http ://www.politepix.com/shop/openears-support-incident/](http://www.politepix.com/shop/openears-support-incident/)

# android - Android 将 JSON 数据解析为列表视图

> ID：12059199
> 
> 赞同：-1
> 
> 时间：2012-08-21T16:25:03.710
> 
> 标签：android, json, listview

好的，所以我发现本教程将 mi JSON 数据解析为 ListView (http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)，但我无法让它工作，我不知道发生了什么，我不断收到的错误是“例外：您的内容必须有一个列表视图，它是'android.r.id.list'”，这是我的代码：

```
package com.example.tweev;

import java.util.ArrayList;
import java.util.HashMap;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;

public class Tweev extends ListActivity {

    // url to make request
    //private static String url = "http://api.androidhive.info/contacts/ ";
    private static String url = "http://www.tweevenvivo.com/service/Tweev.getActiveShows";

    // JSON Node names
    private static final String TAG_DATA = "data";
    private static final String TAG_TWEEVERS = "tweevers";
    private static final String TAG_ID = "id";
    private static final String TAG_CATEGORY = "category";
    private static final String TAG_DESCRIPTION = "description";
    private static final String TAG_NAME = "name";
    private static final String TAG_HASHTAG = "hashtag";
    private static final String TAG_CHANNELS = "channels";  //contains "operators", "hour and "operator name"
    private static final String TAG_OPERATORS = "operators";    //contains "channel" with "code"
    private static final String TAG_OPCHANNEL = "channel";
    private static final String TAG_OPCODE = "code";
    private static final String TAG_CHHOUR = "hour";
    private static final String TAG_CHNAME = "name";
    private static final String TAG_IMAGE_SMALL = "image_small";
    private static final String TAG_IMAGE = "image";
    private static final String TAG_SHOW_ID = "show_id";

    // tweevs JSONArray
    JSONArray tweevs = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_tweev);
        TextView view = (TextView) findViewById(R.id.TextView01);
        String s="";
        for (int i=0; i < 500; i++) {
            s += "TEST "+i+" ";
        }
        view.setText(s);
        getData();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_tweev, menu);
        return true;
    }

    private void getData() {

        // Hashmap for ListView
        ArrayList<HashMap<String, String>> tweevList = new ArrayList<HashMap<String, String>>();

        // Creating JSON Parser instance
        JSONParser jParser = new JSONParser();

        // getting JSON string from URL
        JSONObject json = jParser.getJSONFromUrl(url);

        //Log.d(TAG_DATA, "json " + json);

        try {
            // Getting Array of Contacts
            tweevs =  json.getJSONArray(TAG_DATA);

            Log.d(TAG_DATA, "tweevs " + tweevs);

            // looping through All tweevs
            for(int i = 0; i < 10; i++) {//tweevs.length()
                JSONObject c = tweevs.getJSONObject(i);

                // Storing each json item in variable
                String tweevers = c.getString(TAG_TWEEVERS);
                String id = c.getString(TAG_ID);
                String category = c.getString(TAG_CATEGORY);
                String description = c.getString(TAG_DESCRIPTION);
                String name = c.getString(TAG_NAME);
                String hashtag = c.getString(TAG_HASHTAG);
                //String channels = c.getString(TAG_CHANNELS);
                String image_small = c.getString(TAG_IMAGE_SMALL);
                String image = c.getString(TAG_IMAGE);
                String show_id = c.getString(TAG_SHOW_ID);

                // operators is again a JSON Object
                JSONArray channels = c.getJSONArray(TAG_CHANNELS);

                for(int j = 0; j < channels.length(); j++) {
                    JSONObject channel = channels.getJSONObject(j);
                    JSONArray operators = channel.getJSONArray(TAG_OPERATORS);

                    for(int k = 0; k < operators.length(); k++){
                        JSONObject operator = operators.getJSONObject(k);

                        String channelName = operator.getString(TAG_OPCHANNEL);
                        String channelCode = operator.getString(TAG_OPCODE);
                    }
                    String chhour = channel.getString(TAG_CHHOUR);
                    String chname = channel.getString(TAG_CHNAME);

                    //Log.d(TAG_DATA, "operator channel "+ k + " ::: " +channelName+" __CODE__ "+channelCode);
                    //Log.d(TAG_DATA, "channel hour "+ j + " ::: " +chhour+" --channel name-- "+chname);
                    //Log.d(TAG_DATA, "operators "+ j + " ::: " +channel+" --- "+code);
                    //Log.d(TAG_DATA, "operators "+ j + " ::: " +operators);
                }

                //Log.d(TAG_DATA, "tweev "+ i + " ::: " +channels);

                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                // adding each child node to HashMap key => value
                map.put(TAG_ID, id);
                map.put(TAG_NAME, name);
                map.put(TAG_HASHTAG, hashtag);
                map.put(TAG_IMAGE_SMALL, image_small);

                // adding HashList to ArrayList
                tweevList.add(map);
            }

        } catch (JSONException e) {
            Log.d(TAG_DATA, "MOTHERFUCKER!");
            e.printStackTrace();
        }

        /**
         * Updating parsed JSON data into ListView
         * */
        ListAdapter adapter = new SimpleAdapter(this, tweevList,
                R.layout.list_items,
                new String[] { TAG_NAME, TAG_HASHTAG, TAG_IMAGE_SMALL }, new int[] {
                        R.id.name, R.id.name, R.id.hashtag });

        setListAdapter(adapter);

        // selecting single ListView item
        ListView lv = getListView();

        // Launching new screen on Selecting Single ListItem
        lv.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                /*
                // getting values from selected ListItem
                String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
                String cost = ((TextView) view.findViewById(R.id.email)).getText().toString();
                String description = ((TextView) view.findViewById(R.id.mobile)).getText().toString();

                // Starting new intent
                Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
                in.putExtra(TAG_NAME, name);
                in.putExtra(TAG_EMAIL, cost);
                in.putExtra(TAG_PHONE_MOBILE, description);
                startActivity(in);
                */
            }
        });

    }

} 
```

我的猜测是我的 XML 文件有问题，在他们的代码中，我看到他们使用了 OnCreate 函数的布局，而在创建 ListAdapter 时使用了另一个布局，我不明白为什么会这样，我也不知道这些布局的内容是什么...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:30:19.950

您的布局 XML 文件应该包含一个`ListView`带有 id的内容`@android:id/list`。像这样的东西

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">
    <!-- Main ListView 
         Always give id value as list(@android:id/list)
    -->
    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"/>

</LinearLayout> 
```

您上面提到的站点使用 3 种不同的布局 - main.xml 是上面粘贴的代码所指的内容。它用于主要活动。

第二个是list_item.xml。此布局定义列表视图中每个项目的显示方式。这是该布局的代码

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">  
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">
        <!-- Name Label -->
        <TextView
            android:id="@+id/name"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#43bd00"
            android:textSize="16sp"
            android:textStyle="bold"
            android:paddingTop="6dip"
            android:paddingBottom="2dip" />
        <!-- Description label -->
        <TextView
            android:id="@+id/email"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#acacac"
            android:paddingBottom="2dip">
        </TextView>
        <!-- Linear layout for cost and price Cost: Rs.100 -->
        <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        <!-- Cost Label -->
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#5d5d5d"
            android:gravity="left"
            android:textStyle="bold"
            android:text="Mobile: " >
        </TextView>
        <!-- Price Label -->
        <TextView
            android:id="@+id/mobile"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#acacac" 
            android:textStyle="bold"
            android:gravity="left">
        </TextView>
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

第三个也是最后一个布局是 single_list_item.xml。此布局定义了单击 list_item.xml 上的单个项目后列表中的每个项目如何显示。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">  
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">
        <!-- Name Label -->
        <TextView
            android:id="@+id/name"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#43bd00"
            android:textSize="16sp"
            android:textStyle="bold"
            android:paddingTop="6dip"
            android:paddingBottom="2dip" />
        <!-- Description label -->
        <TextView
            android:id="@+id/email"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#acacac"
            android:paddingBottom="2dip">
        </TextView>
        <!-- Linear layout for cost and price Cost: Rs.100 -->
        <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        <!-- Cost Label -->
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#5d5d5d"
            android:gravity="left"
            android:textStyle="bold"
            android:text="Mobile: " >
        </TextView>
        <!-- Price Label -->
        <TextView
            android:id="@+id/mobile"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="#acacac" 
            android:textStyle="bold"
            android:gravity="left">
        </TextView>
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

# c++ - getline() 带有 UNIX 格式字符的文本

> ID：12059205
> 
> 赞同：3
> 
> 时间：2012-08-21T16:25:27.807
> 
> 标签：c++, ascii, text-files, special-characters, getline

我正在编写一个从 .txt 文件中读取文本行的 C++ 程序。不幸的是，这个文本文件是由一个有 20 年历史的 UNIX 程序生成的，它包含许多奇怪的格式字符。

文件的前几行是纯英文文本，可以毫无问题地阅读。但是，每当一行包含一个或多个这些奇怪的字符与文本混合时，整行都会被读取为字符并且数据会丢失。

真正令人困惑的部分是，如果我手动删除前几行，以便文件中的第一个字符是这些不寻常的字符之一，那么文件中的所有内容都会被完美读取。不寻常的字符显然只是显示为小的 ascii 曲线-箭头、笑脸等，这很好。似乎在我不知情或不同意的情况下，根据阅读的第一行，自动做出了决定。

根据一些谷歌搜索，我怀疑问题可能与语言环境有关，但根据 Visual Studio 调试器，在这两种情况下，ifstream 对象的语言环境属性都是“C”。

读取数据的代码如下：

```
//Function to open file at location specified by inFilePath, load and process data
int OpenFile(const char* inFilePath)
{
    string line;
    ifstream codeFile;

    //open text file
    codeFile.open(inFilePath,ios::in);

    //read file line by line
    while ( codeFile.good() )
    {
       getline(codeFile,line);

       //check non-zero length
       if (line != "")
            ProcessLine(&line[0]);
    }

    //close line
    codeFile.close();

    return 1;
} 
```

如果有人对可能发生的事情或如何解决它有任何建议，他们将非常受欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T05:38:01.433

通过阅读您的问题，听起来您正在阅读二进制数据，这将导致 getline() 丢弃内容或只是跳过该行。

你有几个选择：

1.  如果您只需要数据文件中的行，您可以首先通过删除所有不可打印的字符（即那些奇怪的 ascii 字符的“官方”名称）来清理它们。在 UNIX 上，诸如此类的工具`strings`可以帮助您完成该过程。

    当然，您也可以在代码中以编程方式执行此操作，只需读取 X 数量的数据，将其存储在字符串中，然后删除那些超出标准 ASCII 字符范围的字符。这很可能会导致您丢失可能存储在文件中的任何 unicode。

2.  您更改程序以了解格式并基本上编写一个解析器，允许您以更理智的方式解析文档。

如果可以的话，我建议尝试第 1 种解决方案，看看结果是否合理并且仍然可以使用。您提到这是医疗数据，您是否知道这是什么文件格式？如果您正在尝试查找并访问 unix/linux 机器，您可以使用该实用程序`file`，也许它可以为您提供线索（最坏的情况下它会告诉您它只是数据）。

如果可能，请尝试获取一个“干净”文件，您可以发布其十六进制转储，以便我们可以尝试提供比我们目前提供的更好的帮助。使用 clean 我的意思是文件中没有个人识别信息。

* * *

对于数字 2，以二进制模式打开文件。您提到使用 Windows，std::fstream 对象中的二进制和非二进制文件的处理方式不同，而在 UNIX 系统上情况并非如此（在大多数系统上，我相信我会得到关于一个系统的评论：与此描述不符）。

```
codeFile.open(inFilePath,ios::in); 
```

会成为

```
codeFile.open(inFilePath, ios::in | ios::binary); 
```

而不是`getline()`你会想要非常熟悉[`.read()`](http://www.cplusplus.com/reference/iostream/istream/read/)哪些将允许在`ifstream`.

阅读会是这样的：

```
// This code has not been tested!
char input[1024];
codeFile.read(input, 1024);

int actual_read = codeFile.gcount();

// Here you can process input, up to a maximum of actual_read characters.

//ProcessLine() // We didn't necessarily read a line!
ProcessData(input, actual_read); 
```

* * *

提到的另一件事是，您可以更改`locale`当前流的 并更改它认为新行的分隔符，也许这将解决您的问题而无需使用未格式化的运算符：

[用只知道换行符的新语言环境为流灌输](https://stackoverflow.com/questions/1567082/how-do-i-iterate-over-cin-line-by-line-in-c/1567703#1567703)。此方法可能会或可能不会让您的 getline() 正常运行。

# jquery - 如何为 jquery 翻转计数器插件设置图像路径

> ID：12059209
> 
> 赞同：0
> 
> 时间：2012-08-21T16:25:34.397
> 
> 标签：jquery, ruby-on-rails, asset-pipeline

我正在使用 Rails 并想实现 FlipCounter。这是文档的链接 - [http://bloggingsquared.com/jquery/flipcounter/](http://bloggingsquared.com/jquery/flipcounter/)。

我认为它没有显示是因为图像路径。从文档：

```
 Here's an example. This image is located at img/flipCounter-custom.png, each digit is 50 pixels wide and 67 pixels tall. I can use it as a flipCounter with the following code:
    $("#grunge_counter").flipCounter({imagePath:"img/flipCountercustom.png",digitHeight:67,digitWidth:50, number:244}); 
```

它在具有默认路径的普通页面中工作（**不是 Rails 项目**）

我把js文件和html代码放在我的页面中。

这是包含的文件：

```
<link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
<link href="/assets/counter.css?body=1" media="all" rel="stylesheet" type="text/css" />
<link href="/assets/static_pages.css?body=1" media="all" rel="stylesheet" type="text/css" />
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery.easing.1.3.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery.flipCounter.1.2.pack.js?body=1" type="text/javascript"></script>
<script src="/assets/static_pages.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script> 
```

和纯 HTML：

```
 <div id="counter"><input type="hidden" name="counter-value" value="100" /></div> 
```

和 jQuery 来调用它：

```
 $("#counter").flipCounter(); 
```

但我需要使用类似的路径：

```
 $("#counter").flipCounter({imagePath:"//some path//flipCountercustom.png"}); 
```

但我没有设置它。我什至尝试在 application.html.erb 文件中创建 img 目录。

**编辑：尝试变体**：

```
 $("#counter").flipCounter({imagePath: <%= image_path("flipCounter-medium.png") %> );

       -------

       $("#counter").flipCounter({imagePath: "<%= image_path("flipCounter-medium.png") %>" );

       -------

       $("#counter").flipCounter({imagePath: <%= image_path("/images/flipCounter-medium.png") %> ); 
```

**图像放置在 assets/images 文件夹中**

有人可以建议为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T07:25:58.650

确保在加载文档时添加了它

```
 $(function() {
    $("#counter").flipCounter({imagePath: "<%= image_path('flipCountercustom.png') %>"} );
  }); 
```

我试过了，这对我有用。

如果你想直接使用 url 而不是 image_tag 使用

```
 $(function() {
    $("#counter").flipCounter({imagePath: "/assets/flipCountercustom.png') %>"}           
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:33:36.437

资产管道可能让您感到悲伤。image_path 助手（ActionView::Helpers::AssetTagHelper）可以修复你，试试：

```
$("#counter").flipCounter({imagePath: <%= image_path("flipCountercustom.png") %>} ); 
```

# html - 如何在 contentEditable div 中制作可点击的锚点？

> ID：12059211
> 
> 赞同：26
> 
> 时间：2012-08-21T16:25:40.707
> 
> 标签：html, contenteditable

我有以下代码：

```
<div contentEditable="true">
    Blah blah <a href="http://google.com">Google</a> Blah blah
</div> 
```

[小提琴](http://jsfiddle.net/GeVpe/)

有没有办法让这个`a`可点击，不可编辑，而不会将锚移到该 div 之外？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-21T16:32:40.313

只需将链接包装在另一个 div 中，如下所示：

```
<div contentEditable="true">

    <div contentEditable="false">
            Bla bla <a href="http://google.com">Google</a> Bla bla
    </div>
</div>​ 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-05-13T18:18:35.593

使链接本身不可编辑（至少在 HTML5 上有效）：

`<a contenteditable="false" href="http....... >`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-21T16:32:51.627

据我所知，如果不使用 Javascript 自己编程，就无法做到这一点。执行此操作的简单方法是在按下键`contentEditable`时禁用和重新启用。`Ctrl`所以当`Ctrl`被按下时，链接是可点击的，否则不可点击。这意味着您仍然可以编辑链接的内容。此功能类似于 Microsoft Word、IIRC。

代码可能如下所示：

```
var content = document.getElementById('content');

document.addEventListener('keydown', function(event) {
    if (event.keyCode === 17) {          // when ctrl is pressed
        content.contentEditable = false; // disable contentEditable
    }
}, false);

document.addEventListener('keyup', function(event) {
    if (event.keyCode === 17) {          // when ctrl is released
        content.contentEditable = true;  // reenable contentEditable
    }
}, false); 
```

[更新的小提琴](http://jsfiddle.net/GeVpe/6/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-02T23:48:15.603

为了获得可点击和可编辑的链接，我在链接中放置了一个 onclick-command。例子：

```
<a contenteditable="true" href="necessary?" onclick="document.location = 'www.xy.com';" ...>
    <img src="image.jpg" draggable="true" ...>
</a> 
```

缺点是：在 IE 中，链接必须点击两次。在移动 Safari 中显示了键盘（可以用 Javascript 隐藏）。

# android - 致命异常：主要用于数据包嗅探应用程序

> ID：12059212
> 
> 赞同：-1
> 
> 时间：2012-08-21T16:25:45.513
> 
> 标签：android, exception, main

我是 Android 编程的初学者，我正在做我的期末项目，我需要开发一个数据包嗅探应用程序。我在互联网上找到了一些代码，并试图将其扩展到我的项目中。但得到 FATAL EXCEPTION: main 和 following 错误。

这是代码：

```
public class Main extends Activity {

    // Variable declarations for handling the view items in the layout.
    private Button start_button;
    private Button stop_button;
    private Button read_button;
    private EditText parameters;

    // Variable declarations for handling the TCPdump process.
    private TCPdump tcpdump = null;
    private TCPdumpHandler tcpDumpHandler = null;
    private SharedPreferences settings = null;

    // Variable declarations for handling the options and reader activities.
    private Intent optionsIntent = null;
    private Intent readerIntent = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Associating the items in the view to the variables.
        start_button = (Button) findViewById(R.id.start_button);
        stop_button = (Button) findViewById(R.id.stop_button);
        read_button = (Button) findViewById(R.id.read_button);
        parameters = (EditText) findViewById(R.id.params_text);

        // Accessing the app's preferences.
        settings = getSharedPreferences(GlobalConstants.prefsName, 0);

        // Extracting the TCPdump binary to the app folder.
        if (RootTools.installBinary(Main.this, R.raw.tcpdump, "tcpdump") == false) {
            new AlertDialog.Builder(Main.this)
                    .setTitle(R.string.extraction_error)
                    .setMessage(R.string.extraction_error_msg)
                    .setNeutralButton(R.string.ok, null).show();
        }

        // Creating a new TCPdump object.
        tcpdump = new TCPdump();

        // Creating a TCPdump handler for the TCPdump object created after.
        tcpDumpHandler = new TCPdumpHandler(tcpdump, this, this, true);

        // Obtaining the command from the options that were saved last time
        // Shark was running.
        tcpDumpHandler.generateCommand();

        start_button.setOnClickListener(new OnClickListener() {
            // Setting the action to perform when the start button is pressed.
            public void onClick(View v) {
                startTCPdump();
            }
        });

        stop_button.setOnClickListener(new OnClickListener() {
            // Setting the action to perform when the stop button is pressed.
            public void onClick(View v) {
                stopTCPdump();
            }
        });

        read_button.setOnClickListener(new OnClickListener() {
            // Setting the action to perform when the open in reader button is
            // pressed.
            public void onClick(View v) {
                launchReader();
            }
        });

        BroadcastReceiver connectionReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                // Setting the action to be performed when the network status
                // changes.
                if ((tcpDumpHandler.checkNetworkStatus() == false)
                        && (tcpdump.getProcessStatus())) {
                    stopTCPdump();
                    new AlertDialog.Builder(Main.this)
                            .setTitle(
                                    getString(R.string.network_connection_down))
                            .setMessage(
                                    getString(R.string.network_connection_down_msg))
                            .setNeutralButton(getString(R.string.ok), null)
                            .show();
                }
            }
        };

        // Registering the BroadcastReceiver and associating it with the
        // connectivity change event.
        registerReceiver(connectionReceiver, new IntentFilter(
                "android.net.conn.CONNECTIVITY_CHANGE"));
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // Setting the action to perform when returning to this activity from
        // another activity which had been called.
        super.onActivityResult(requestCode, resultCode, data);
        if (resultCode == RESULT_OK && requestCode == 1) {
            if (tcpdump.getProcessStatus()) {
                new AlertDialog.Builder(Main.this)
                        .setTitle(getString(R.string.settings_changed))
                        .setMessage(getString(R.string.settings_changed_msg))
                        .setNeutralButton(getString(R.string.ok), null).show();
            }
            tcpDumpHandler.generateCommand();
        }
    }

    @Override
    public void onDestroy() {
        // Setting the action to perform when the Android O.S. kills this
        // activity.
        if (tcpdump.getProcessStatus()) {
            stopTCPdump();
        }
    }

    public boolean onCreateOptionsMenu(Menu menu) {
        // This code makes the activity to show a menu when the device's menu
        // key is pressed.
        menu.add(0, 0, 0, getString(R.string.options_text));
        menu.add(0, 1, 0, getString(R.string.about_text));
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {
        // Setting the action to perform when an option from the menu is
        // selected.
        switch (item.getItemId()) {
        case 0:
            optionsIntent = new Intent(Main.this, Options.class);
            startActivityForResult(optionsIntent, 1);
            return true;
        case 1:
            new AlertDialog.Builder(Main.this).setTitle(R.string.about_text)
                    .setMessage(getString(R.string.about_shark))
                    .setNeutralButton(getString(R.string.ok), null).show();
            return true;
        }
        return false;
    }

    /**
     * Calls TCPdumpHandler to try start the packet capture.
     */
    private void startTCPdump() {
        if (tcpDumpHandler.checkNetworkStatus()) {

            switch (tcpDumpHandler.start(parameters.getText().toString())) {
            case 0:
                Toast.makeText(Main.this, getString(R.string.tcpdump_started),
                        Toast.LENGTH_SHORT).show();
                break;
            case -1:
                Toast.makeText(Main.this,
                        getString(R.string.tcpdump_already_started),
                        Toast.LENGTH_SHORT).show();
                break;
            case -2:
                new AlertDialog.Builder(Main.this)
                        .setTitle(getString(R.string.device_not_rooted_error))
                        .setMessage(
                                getString(R.string.device_not_rooted_error_msg))
                        .setNeutralButton(getString(R.string.ok), null).show();
                break;
            case -4:
                new AlertDialog.Builder(Main.this).setTitle("Error")
                        .setMessage(getString(R.string.command_error))
                        .setNeutralButton(getString(R.string.ok), null).show();
                break;
            case -5:
                new AlertDialog.Builder(Main.this).setTitle("Error")
                        .setMessage(getString(R.string.outputstream_error))
                        .setNeutralButton(getString(R.string.ok), null).show();
                break;
            default:
                new AlertDialog.Builder(Main.this).setTitle("Error")
                        .setMessage(getString(R.string.unknown_error))
                        .setNeutralButton(getString(R.string.ok), null).show();
            }
        } else {
            new AlertDialog.Builder(Main.this)
                    .setTitle(getString(R.string.network_connection_error))
                    .setMessage(
                            getString(R.string.network_connection_error_msg))
                    .setPositiveButton(getString(R.string.yes),
                            new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog,
                                        int which) {
                                    startActivity(new Intent(
                                            Settings.ACTION_WIRELESS_SETTINGS));
                                }
                            }).setNegativeButton(getString(R.string.no), null)
                    .show();
        }
    }

    /**
     * Calls TCPdumpHandler to try to stop the packet capture.
     */
    private void stopTCPdump() {
        switch (tcpDumpHandler.stop()) {
        case 0:
            Toast.makeText(Main.this, getString(R.string.tcpdump_stoped),
                    Toast.LENGTH_SHORT).show();
            break;
        case -1:
            Toast.makeText(Main.this,
                    getString(R.string.tcpdump_already_stoped),
                    Toast.LENGTH_SHORT).show();
            break;
        case -2:
            new AlertDialog.Builder(Main.this)
                    .setTitle(getString(R.string.device_not_rooted_error))
                    .setMessage(getString(R.string.device_not_rooted_error_msg))
                    .setNeutralButton(getString(R.string.ok), null).show();
            break;
        case -4:
            new AlertDialog.Builder(Main.this).setTitle("Error")
                    .setMessage(getString(R.string.command_error))
                    .setNeutralButton(getString(R.string.ok), null).show();
            break;
        case -5:
            new AlertDialog.Builder(Main.this).setTitle("Error")
                    .setMessage(getString(R.string.outputstream_error))
                    .setNeutralButton(getString(R.string.ok), null).show();
            break;
        case -6:
            new AlertDialog.Builder(Main.this).setTitle("Error")
                    .setMessage(getString(R.string.close_shell_error))
                    .setNeutralButton(getString(R.string.ok), null).show();
            break;
        case -7:
            new AlertDialog.Builder(Main.this).setTitle("Error")
                    .setMessage(getString(R.string.process_finish_error))
                    .setNeutralButton(getString(R.string.ok), null).show();
        default:
            new AlertDialog.Builder(Main.this).setTitle("Error")
                    .setMessage(getString(R.string.unknown_error))
                    .setNeutralButton(getString(R.string.ok), null).show();
        }

    }

    /**
     * Tries to launch the reader activity.
     */
    private void launchReader() {
        readerIntent = new Intent(Main.this, Reader.class);
        if (FileManager.checkFile(GlobalConstants.dirName,
                settings.getString("fileText", "shark_capture.pcap"))) {
            if (tcpdump.getProcessStatus() == false) {
                startActivity(readerIntent);
            } else {
                new AlertDialog.Builder(Main.this)
                        .setTitle(getString(R.string.capture_in_progress_error))
                        .setMessage(
                                getString(R.string.capture_in_progress_error_msg))
                        .setPositiveButton(getString(R.string.yes),
                                new DialogInterface.OnClickListener() {
                                    public void onClick(DialogInterface arg0,
                                            int arg1) {
                                        stopTCPdump();
                                        startActivity(readerIntent);
                                    }
                                })
                        .setNegativeButton(getString(R.string.no), null).show();
            }
        } else {
            new AlertDialog.Builder(Main.this)
                    .setTitle(getString(R.string.file_error))
                    .setMessage(getString(R.string.file_error_msg))
                    .setNeutralButton(getString(R.string.ok), null).show();
        }
    }
} 
```

当我运行这个 Eclipse 时，我在日志中收到一个错误 cat 以下错误。我尝试了很多建议的解决方案，即使那样我也无法获得解决方案。

```
08-21 15:38:01.483: D/AndroidRuntime(499): Shutting down VM

08-21 15:38:01.483: W/dalvikvm(499): threadid=1: thread exiting with uncaught exception (group=0x4001d800)

08-21 15:38:01.504: E/AndroidRuntime(499): FATAL EXCEPTION: main

08-21 15:38:01.504: E/AndroidRuntime(499): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.shark/com.shark.Main}: java.lang.NullPointerException

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.os.Handler.dispatchMessage(Handler.java:99)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.os.Looper.loop(Looper.java:123)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread.main(ActivityThread.java:4627)

08-21 15:38:01.504: E/AndroidRuntime(499):  at java.lang.reflect.Method.invokeNative(Native Method)

08-21 15:38:01.504: E/AndroidRuntime(499):  at java.lang.reflect.Method.invoke(Method.java:521)

08-21 15:38:01.504: E/AndroidRuntime(499):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)

08-21 15:38:01.504: E/AndroidRuntime(499):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)

08-21 15:38:01.504: E/AndroidRuntime(499):  at dalvik.system.NativeStart.main(Native Method)

08-21 15:38:01.504: E/AndroidRuntime(499): Caused by: java.lang.NullPointerException

08-21 15:38:01.504: E/AndroidRuntime(499):  at com.shark.TCPdumpHandler.generateCommand(TCPdumpHandler.java:322)

08-21 15:38:01.504: E/AndroidRuntime(499):  at com.shark.Main.onCreate(Main.java:93)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)

08-21 15:38:01.504: E/AndroidRuntime(499):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)

08-21 15:38:01.504: E/AndroidRuntime(499):  ... 11 more 
```

我找到了错误发生的确切位置。据此，“closeShell”在以下代码中返回 null。进一步循环回三个类。

```
 public class RootShell {
protected Process process = null;
protected DataOutputStream os = null;
protected DataInputStream is = null;

private boolean deviceRooted = false;

/**
 * RootShell class constructor. Checks if the device is rooted.
 */
public RootShell() {
    deviceRooted = checkRootStatus();
}

/**
 * RootShell class destructor. Closes the shell if its not already closed.
 */
protected void finalize() {
    if (process != null)
        closeShell();
}

/**
 * Opens a root shell and waits for commands.
 * 
 * @return 0 Everything went OK.<br>
 *         -1 The shell has already been opened.<br>
 *         -2 The device isn't rooted.<br>
 *         -3 IOException when running the su command.
 */
public int openShell() {
    if (process == null) {
        if (deviceRooted) {
            // Trying to get root access.
            try {
                process = Runtime.getRuntime().exec("su");
            } catch (IOException e) {
                return -3;
            }

            // Getting an output stream to the root shell for introducing
            // commands.
            os = new DataOutputStream(process.getOutputStream());

            // Getting an input stream to the root shell for displaying
            // results.
            is = new DataInputStream(process.getInputStream());

            return 0;
        } else
            return -2;
    } else
        return -1;
}

/**
 * Runs the command in the root shell.
 * 
 * @param command
 *            The command which will be executed in the root shell.
 * @return 0 Everything went OK.<br>
 *         -1 The shell wasn't opened.<br>
 *         -2 The device isn't rooted.<br>
 *         -4 IOException when running the user command.<br>
 *         -5 IOException when flushing the DataOutputStream.
 */
public int runCommand(String command) {
    if (process != null) {
        if (deviceRooted) {
            try {
                os.writeBytes(command + "\n");
            } catch (IOException e) {
                return -4;
            }

            try {
                os.flush();
            } catch (IOException e) {
                return -5;
            }
            return 0;
        } else
            return -2;
    } else
        return -1;
}

/**
 * Closes a shell which is already open.
 * 
 * @return -1 The shell wasn't opened.<br>
 *         -2 The device isn't rooted.<br>
 *         -6 IOException when running the exit command.<br>
 *         -7 InterruptedException when waiting for the process to stop.
 */
public int closeShell() {
    if (process != null) {

        if (deviceRooted) {
            try {
                os.writeBytes("exit\n");
            } catch (IOException e1) {
                return -6;
            }

            try {
                process.waitFor();
            } catch (InterruptedException e) {
                return -7;
            }

            process.destroy();

            process = null;
            os = null;
            is = null;

            return 0;
        } else
            return -2;
    } else
        return -1;

}

/**
 * Checks if an Android device is rooted or not.<br>
 * Code borrowed from: http://www
 * .stealthcopter.com/blog/2010/01/android-requesting-root-access-in
 * -your-app/
 * 
 * @return true: The device is rooted.<br>
 *         false: The device isn't rooted.
 */
private static boolean checkRootStatus() {
    Process p;
    try {
        // Preform su to get root privileges
        p = Runtime.getRuntime().exec("su");

        // Attempt to write a file to a root-only
        DataOutputStream os = new DataOutputStream(p.getOutputStream());
        os.writeBytes("echo \"Do I have root?\" >/system/sd/temporary.txt\n");

        // Close the terminal
        os.writeBytes("exit\n");
        os.flush();
        try {
            p.waitFor();
            if (p.exitValue() != 255) {
                return true;
            } else {
                return false;
            }
        } catch (InterruptedException e) {
            return false;
        }
    } catch (IOException e) {
        return false;
    }
}

/**
 * @return A DataInputStream to the root shell.
 */
public DataInputStream getInputStream() {
    return is;
}

/**
 * @return A DataOutputStream to the root shell.
 */
public DataOutputStream getOutputStream() {
    return os;
}

/**
 * @return true if the shell is opened.<br>
 *         false if the shell isn't opened.
 */
public boolean getProcessStatus() {
    if (process != null)
        return true;
    else
        return false;
}
} 
```

我还发现，它给出了“08-22 19:05:19.701: I/System.out(275): e1java.io.IOException: Broken pipe”，它在“closeshell”中输入 try catch。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T08:10:10.667

您和其他多个地方`R`有什么？ 该错误是指但您没有提供它的代码。`R.id.start_button`
`tcpDumpHandler.generateCommand()`

# winapi - 为什么在对话框过程中使指针静态？

> ID：12059213
> 
> 赞同：1
> 
> 时间：2012-08-21T16:25:48.470
> 
> 标签：winapi, visual-c++

我正在浏览许多基本 win32 对话程序的示例。他们似乎采用了这种基本模式。

```
class Person
{
     char Name[63];
     int Age;
};

BOOL CALLBACK EditDlgProc ( HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
     static Person* person;
     switch(uMsg)
     {
     case WM_INITDIALOG:
         person = (Person*)lParam;
         return FALSE;
     case WM_COMMAND:
           .....
     }
     return FALSE;
} 
```

我想知道为什么要让人*静态*？

*   这是为了效率吗？（避免每次调用都将人员分配给 lParam）
*   这是用来分享的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:28:08.780

`person`它是在函数调用之间保持指针的状态`EditDlgProc()`。

它确保：

*   指针在程序的生命周期内只创建一次。
*   它在对函数的连续调用和
*   程序结束时只销毁一次。

> **这是为了效率吗？**

是的，可能。在不了解设计考虑的情况下很难说。

> **这是用来分享的吗？**

不可以。
请注意，`static`在这种情况下，变量的范围仅限于函数，因此不能这样共享。

# php - 将所有连续数字及其差异分组

> ID：12059219
> 
> 赞同：0
> 
> 时间：2012-08-21T16:26:26.647
> 
> 标签：php, arrays, associative-array

如何对关联数组中连续数字之间的所有差异进行分组？下面是我正在使用的数组

**需要将 (2,3)(7,8) 与他们的差异分组，忽略 (11,6,5,9)**

```
$array = array(
    2 =>"12",
    3 =>"12",
    11 => "16",
    6 => "15",
    5 => "14",
    7 => "16",
    8 => "17",
    9 => "18") 
```

下面是我用来对数组进行分组的代码，但它不起作用：

```
foreach ($array as $k => $v) {
    echo  $prev;
    if (isset($prev)) {
        if (($v - $prev) != 1) $newArray[] = $v;
    } else { $newArray[] = $v; }
    $prev = $v;
}
echo '<pre>';
print_r($newArray); 
```

目前我得到这个：

```
Array
(
    [0] => 12
    [1] => 12
    [2] => 16
    [3] => 15   
    [4] => 16
) 
```

**但我需要 O/P 是** `(2,3)=0`差异，`(7,8)=1`差异，即

```
array(
    [0]=>0,
    [1]=>1
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:03:30.117

所以给你。

```
$newArray = array();
foreach ($array as $k => $v) {
    if (isset($prev) && $k == $prev + 1) {
        $newArray[] = $v - $array[$prev];
    }
    $prev = $k;
} 
```

这会产生三个连续对的数组：

```
Array
(
    [0] => 0
    [1] => 1
    [2] => 1
) 
```

如果要在两对后停止，请在循环`$i = 0;`之前添加一个运行计数器并在循环内`foreach`退出：`if (++$i >= 2) break;``if`

```
$newArray = array();
$i = 0;
foreach ($array as $k => $v) {
    if (isset($prev) && $k == $prev + 1) {
        $newArray[] = $v - $array[$prev];
        if (++$i >= 2) break;
    }
    $prev = $k;
} 
```

# jquery - asp.net mvc jquery 对话框一对多数据更新

> ID：12059222
> 
> 赞同：0
> 
> 时间：2012-08-21T16:26:48.397
> 
> 标签：jquery, asp.net-mvc, modal-dialog, one-to-many

这是场景。我有一个创建订单的视图。该视图有一些要捕获的标题信息，如客户地址、交货方式等，还有一个网格来显示客户订购的产品列表。当客户想要添加产品时，我会显示包含产品信息的 jquery 对话框模式。当我点击对话框上的保存时，我遇到了几个问题。

1.  如何将数据传递回主视图并链接产品`List<Product>`数据并将其保存在 Order 类中？

2.  有没有更好的方法呢？我需要对话框模式而不是来回切换到不同的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:30:42.587

这取决于具体的要求。

我做了一些与你描述的非常相似的事情。我的模态对话框将 Ajax 回传到控制器以更新它正在编辑的实体并自行关闭。

然后，一旦模式对话框关闭（例如，如果您正在显示正在编辑的内容列表），我就会触发 HTML 的另一部分通过 Ajax 调用刷新。

# r - 加速时间序列模拟（用于引导程序）

> ID：12059227
> 
> 赞同：3
> 
> 时间：2012-08-21T16:27:02.063
> 
> 标签：r, time-series, statistics-bootstrap

我需要在具有非标准依赖性的时间序列上运行引导程序。所以要做到这一点，我需要创建一个通过时间调整来模拟时间序列的函数。

```
testing<-function(){
  sampleData<-as.zoo(data.frame(index=1:1000,vol=(rnorm(1000))^2,x=NA))
  sampleData[,"x"]<-sampleData[,"vol"]+rnorm(1000) #treat this is completely exognenous and unknown in connection to vol
  sampleData<-cbind(sampleData,mean=rollmean(sampleData[,"vol"],k=3,align="right"))
  sampleData<-cbind(sampleData,vol1=lag(sampleData[,"vol"],k=-1),x1=lag(sampleData[,"x"],k=-1),mean1=lag(sampleData[,"mean"],k=-1))

  #get estimate
  mod<-lm(vol~vol1+x1+mean1,data=sampleData)

  res<-mod$residuals

  for(i in 5:1000){
    #recursively estimate
    sampleData[i,"vol"]<-as.numeric(predict(mod,newdata=data.frame(sampleData[i-1,])))+res[i-3]

    #now must update other paramaters
      #first our rolled average
      sampleData[i,"mean"]<-mean(sampleData[(i-3):i,"vol"])

      #reupdate our lagged variables
      sampleData[i,"vol1"]<-sampleData[i-1,"vol"]
      sampleData[i,"mean1"]<-sampleData[i-1,"mean"]

  }

  lm(vol~vol1+x1+mean1,data=sampleData)
} 
```

当我运行此代码并测量我得到的运行时间时

```
system.time(testing())
user  system elapsed 
2.711   0.201   2.915 
```

这对我来说是一个小问题，因为将集成此代码以构建引导程序。这意味着这里花费的任何时间每一步都乘以大约 100。我更新了几千次。这意味着单次运行将需要数小时（到数天）才能运行。

有没有办法加快这段代码的速度？

亲切的问候，

马修

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:47:51.547

以下是如何避免`predict.lm`. 另请注意，我使用矩阵而不是动物园对象，这会慢一点。您可以看到这使您的代码变慢了多少。这是您为方便而付出的代价。

```
testing.jmu <- function() {
  if(!require(xts)) stop("xts package not installed")
  set.seed(21)  # for reproducibility
  sampleData <- .xts(data.frame(vol=(rnorm(1000))^2,x=NA), 1:1000)
  sampleData$x <- sampleData$vol+rnorm(1000)
  sampleData$mean <- rollmean(sampleData$vol, k=3, align="right")
  sampleData$vol1 <- lag(sampleData$vol,k=1)
  sampleData$x1 <- lag(sampleData$x,k=1)
  sampleData$mean1 <- lag(sampleData$mean,k=1)

  sampleMatrix <- na.omit(cbind(as.matrix(sampleData),constant=1))
  mod.fit <- lm.fit(sampleMatrix[,c("constant","vol1","x1","mean1")],
                    sampleMatrix[,"vol"])
  res.fit <- mod.fit$residuals

  for(i in 5:nrow(sampleMatrix)){
    sampleMatrix[i,"vol"] <-
      sum(sampleMatrix[i-1,c("constant","vol1","x1","mean1")] *
          mod.fit$coefficients)+res.fit[i-3]
    sampleMatrix[i,"mean"] <- mean(sampleMatrix[(i-3):i,"vol"])
    sampleMatrix[i,c("vol1","mean1")] <- sampleMatrix[i-1,c("vol","mean")]
  }

  lm.fit(sampleMatrix[,c("constant","vol1","x1","mean1")], sampleMatrix[,"vol"])
}
system.time(out <- testing.jmu())
#    user  system elapsed 
#    0.05    0.00    0.05 
coef(out)
#    constant        vol1          x1       mean1 
#  1.08787779 -0.06487441  0.03416802 -0.02757601 
```

将`set.seed(21)`调用添加到您的函数中，您会看到我的函数返回的系数与您的相同。

# cakephp - 保存相关模型数据（3级）

> ID：12059231
> 
> 赞同：0
> 
> 时间：2012-08-21T16:27:21.287
> 
> 标签：cakephp

真的很难将模型信息保存到几个级别。

首先，我有一个费用索赔——有很多费用（费用属于费用索赔）。

费用 HABTM 费用代码。（这些是火车票价，汽油费等）。

所以，我有一个添加新费用页面 - (ExpenseClaimsController /add)。

这有点像电子表格，它允许您输入多行（每行都是费用）。在每一行上都有一个下拉菜单来选择费用代码。问题是费用代码没有写入连接表 (expenses_expense_codes)。

如果我通过未使用且即将删除的费用控制器 /add 添加单个费用，则它可以正常工作，因此问题是保存相关模型，模型。无法弄清楚如何做到这一点，因为费用代码与费用索赔模型没有直接关系，因此在我执行费用索赔控制器/添加时不保存。

希望这是有道理的……

这是我的 ExpenseClaimsController 代码：

```
public function add() {
    if ($this->request->is('post')) {

        //debug($this->request->data);

        // Test
        $this->loadModel('ExpenseCode');

        // Create the claim and the expenses
        $this->ExpenseClaim->create();
        $this->ExpenseClaim->Expense->create();

        // Set the user ID
        $this->request->data['ExpenseClaim']['user_id'] = $this->Auth->user('id');

        // Set the claim status based on which submit btn was pressed
        if ($this->request->data['submit'] == 'Submit') {

            $this->request->data['ExpenseClaim']['claim_status_id'] = '2';

        } else {
            $this->request->data['ExpenseClaim']['claim_status_id'] = '1';
        }

        // Set the claim status
        $now = date('Y-m-d H:i:s');
        $this->request->data['ExpenseClaim']['date_submitted'] = $now;

        // Save both expenses and the expense claim         
        if ($this->ExpenseClaim->saveAll($this->request->data)) {
            $this->Session->setFlash('The expense claim has been saved', 'flash_success');
            $this->redirect(array('action' => 'index'));
        } else {
            $this->Session->setFlash('The expense claim could not be saved. Please, try again.', 'flash_failure');
        }
    }

    $users = $this->ExpenseClaim->User->find('list');
    $claimStatuses = $this->ExpenseClaim->ClaimStatus->find('list');
    $expenseCodes = $this->ExpenseClaim->Expense->ExpenseCode->find('list');
    $mileageRate = $this->Auth->user('mileage_rate');
    $this->set(compact('users', 'claimStatuses', 'expenseCodes', 'mileageRate'));

    // Set errors for top of page
    $this->set('errors', $this->ExpenseClaim->validationErrors);

} 
```

谁能指出我正确的方向？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T11:22:42.180

设法追踪问题，我不得不重命名 ExpenseClaim 中的字段添加到

```
$this->Form->input('Expense.0.ExpenseCode.ExpenseCode'); 
```

这然后解决了这个问题。

希望这会对某人有所帮助。

# django - 改进我的数据库查询的可能方法？

> ID：12059233
> 
> 赞同：0
> 
> 时间：2012-08-21T16:27:42.550
> 
> 标签：django, optimization, django-models

我目前正在使用附加的脚本从我的 django 数据库中获取一个独立且（希望）唯一的数据集，但是与最终文件大小（20MB 的格式化 XML）相比，完成所需的时间变得荒谬，我认为我有办法大幅改进它，但我没有这样做的经验。

在这组查询中，您是否可以发现任何地方让我的速度非常慢？

我很想参考 django 查询优化技术和教程！

此处游戏的目的是返回由一家公司提供的所有配件，包括在应用程序的另一个实例中重新创建该数据所需的所有数据。基本上我是在出口配件。本节只是关于将数据转换为我自己的序列化程序的正确格式。

TL：博士；帮助加快此代码的速度，同时保持相同的输出！需要~~10~~ 4分钟！

```
@print_timing
def get_fittings(company_id):
    print "i'm getting Fittings"

    models = []
    result = []
    company_list = []
    company_list.append(Company.objects.filter(pk=company_id))
    print "Got Company"

    address_list = []
    address_list.append(Address.objects.filter(company=company_id))
    print "Got Address"

    customer_list = []
    customer_list.append(Customer.objects.filter(company=company_id))
    print "Got Customers"

    supplier_list = []
    supplier_list_internal = Supplier.objects.filter(company=company_id)
    supplier_list.append(supplier_list_internal)
    print "Got Supplier"

    fitting_supplier_list = []
    fitting_supplier_list_internal = FittingSupplier.objects.filter(supplier__in=supplier_list_internal)
    fitting_supplier_list.append(fitting_supplier_list_internal)
    print "Got Fitting Supplier"

    supplies_list = []
    supplies_list.append(Supplies.objects.filter(supplier__in=supplier_list_internal))
    print "Got Supplies"

    costbook_number = setup.Costbook.objects.filter(type="fittings").aggregate(max_number=model.Max('number'))
    this_costbook_list = FittingItemSupplierCost.objects.filter(supplier__in=fitting_supplier_list_internal, costbook_number=costbook_number['max_number'])

    fitting_list = []
    for this_costbook in this_costbook_list:
        fitting_list.append(Fitting.objects.filter(uuid=this_costbook.fitting_item.fitting.uuid))
    print "Got Fitting List"

    manufacturer_list = []

    for fitting_queryset in fitting_list:
        for fitting in fitting_queryset:
            if fitting.manufacturer != None:

                company_list.append(Company.objects.filter(uuid=fitting.manufacturer.company.uuid))

                address_list.append(Address.objects.filter(company=fitting.manufacturer.company.uuid))

                customer_list.append(Customer.objects.filter(company=fitting.manufacturer.company.uuid))

                manufacturer_list.append(Manufacturer.objects.filter(uuid=fitting.manufacturer.uuid))

    contacts_list = []
    for addresses in address_list:
        contacts_list.append(Contact.objects.filter(address__in=addresses))

    print "Got Companys and Addresses and Contacts and Customers and Manufacturers"

    fitting_supplier_list = []
    for fitting_supplier in fitting_supplier_list:
        fitting_list.append(Fitting.objects.filter(uuid=fitting_supplier.fitting.uuid))
    print "Got Fittings"

    #empty the list of FittingSuppliers
    fitting_item_list = []
    image_list = []
    for fitting_queryset in fitting_list:
        for fitting in fitting_queryset:
            fitting_item_list.append(fitting.item_set.all())
            image_list.append(FileStore.objects.filter(filename=fitting.image))
    print "Got FittingItem and FileStore"

    for fitting_queryset in fitting_list:
        fitting_supplier_list.append(FittingSupplier.objects.filter(fitting__in=fitting_queryset))
    print "Got FittingSupplier"

    fitting_item_supplier_cost_list = []
    for fitting_supplier_queryset in fitting_supplier_list:
        fitting_item_supplier_cost_list.append(FittingItemSupplierCost.objects.filter(supplier__in=fitting_supplier_queryset, costbook_number=costbook_number['max_number']))
    print "Got FittingItemSupplierCost"

    for company in company_list:
        result.append(company)
        models.append("Company")

    for address in address_list:
        result.append(address)
        models.append("Address")

    for contacts in contacts_list:
        result.append(contacts)
        models.append("Contact")

    for customer in customer_list:
        result.append(customer)
        models.append("Customer")

    for supplier in supplier_list:
        result.append(supplier)
        models.append("Supplier")   

    for supplies in supplies_list:
        result.append(supplies)
        models.append("Supplies")

    for manufacturer in manufacturer_list:
        result.append(manufacturer)
        models.append("Manufacturer")

    for fitting in fitting_list:
        result.append(fitting)   
        models.append("Fitting")

    for fitting_item in fitting_item_list:
        result.append(fitting_item)
        models.append("FittingItem")

    for image in image_list:
        result.append(image)
        models.append("Filestore")

    for fitting_supplier in fitting_supplier_list:
        result.append(fitting_supplier)
        models.append("FittingSupplier")

    for fitting_item_supplier_cost in fitting_item_supplier_cost_list:
        result.append(fitting_item_supplier_cost)
        models.append("FittingItemSupplierCost")

    #result, models = get_fitting_packs(company_id, result, models)

    return result, models 
```

型号（有很多！）：

```
class Company(models.Model):
    uuid = UUIDField(primary_key=True)
    name =  models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Company Name'))
    internal_name = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Internal Name'))
    reference = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Reference'))
    company_status = models.ForeignKey(CompanyStatus, null=True, db_column='company_status_uuid',verbose_name=(_('Company Status')))
    vat_number = models.CharField(null=True, blank=True,max_length=255,verbose_name=(_('Vat Number')))
    registration_number = models.CharField(null=True, blank=True,max_length=255,verbose_name=(_('Company Number')))
    discount = models.FloatField(null=True, blank=True)
    notes = models.TextField(null=True, blank=True,max_length=255)
    jms_code = models.TextField(null=True, blank=True,max_length=255)
    logo = models.TextField(null=True, blank=True,max_length=255)
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True,verbose_name=_('Date Time'), serialize=False)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True,verbose_name=_('Date Time Updated'), serialize=False)
    hidden = models.NullBooleanField(null=True, blank=True,default=0, serialize=False)
    user = UserField(null=True, blank=True, serialize=False)
    is_modified = ModifiedField(serialize=False)
    companyid = models.IntegerField(null=True, blank=True, serialize=False)
    seqno = models.IntegerField(null=True, blank=True, serialize=False)

class Address(models.Model):
    uuid = UUIDField(primary_key=True)
    company = models.ForeignKey(Company, db_column='company_uuid',null=True,blank=True,verbose_name=_('Address'))
    group_name = models.CharField(null=True, blank=False,max_length=255,verbose_name=_('Corporate Group'))
    line1 = models.CharField(null=True, blank=False,max_length=255,verbose_name=_('Address Line 1'))
    line2 = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Address Line 2'))
    line3 = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Address Line 3'))
    town = models.CharField(null=True, blank=True,max_length=255)
    county = models.CharField(null=True, blank=True,max_length=255)
    postcode = models.CharField(null=True, blank=True,max_length=255)
    country_iso = models.CharField(null=True, blank=True,max_length=255)
    telephone = models.CharField(null=True, blank=True,max_length=255)
    fax = models.CharField(null=True, blank=True,max_length=255)
    email = models.CharField(null=True, blank=True,max_length=255)
    website = models.CharField(null=True, blank=True,max_length=255)
    description = models.CharField(null=True, blank=True,max_length=255)
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True, serialize=False)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True, serialize=False)
    user = UserField(null=True, blank=True, serialize=False)
    jms_code = models.CharField(null=True, blank=True,max_length=255)
    notes = models.CharField(null=True, blank=True,max_length=255, serialize=False)    
    is_modified = ModifiedField(serialize=False)

class Contact(models.Model):
    uuid = UUIDField(primary_key=True)
    address = models.ForeignKey(Address, db_column='address_uuid',null=True,blank=True,verbose_name=_('Address'))
    title = models.ForeignKey(Title,db_column='title_uuid',null=True, blank=True)
    forename = models.CharField(null=True, blank=True,max_length=255)
    surname = models.CharField(null=True, blank=True,max_length=255)
    position = models.CharField(db_column='job_title',null=True, blank=True,max_length=255)
    mobile = models.CharField(null=True, blank=True,max_length=255)
    direct_line = models.CharField(null=True, blank=True,max_length=255)
    email = models.CharField(null=True, blank=True,max_length=255)
    origin = models.IntegerField(null=True, blank=True)
    lead_source = models.IntegerField(null=True, blank=True)
    notes = models.TextField(null=True, blank=True, serialize=False)
    contact_status = models.ForeignKey(ContactStatus, db_column='contact_status_uuid',verbose_name=_('Contact Status'), serialize=False)
    contact_method = models.ForeignKey(ContactMethod, db_column='contact_method_uuid',verbose_name=_('Contact Method'), serialize=False)
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True, serialize=False)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True, serialize=False)
    user = UserField(null=True, blank=True, serialize=False)
    jms_code = models.CharField(null=True, blank=True,max_length=255)
    is_modified = ModifiedField(serialize=False)

class Customer(models.Model):
    uuid = UUIDField(primary_key=True)
    company  = models.ForeignKey(Company, db_column='company_uuid',null=True, blank=True)
    customer_sector = models.ForeignKey(CustomerSector, db_column='customer_sector_uuid',null=True, blank=True,verbose_name=_('Sector'))
    account_number = models.CharField(null=True, blank=True,max_length=255,verbose_name="Account No")
    reference  = models.CharField(null=True, blank=True,max_length=255)
    notes = models.TextField(null=True, blank=True)
    customer_status = models.IntegerField(null=True, blank=True)
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True)
    user = UserField(null=True, blank=True)
    jms_code = models.CharField(null=True, blank=True,max_length=255)

class Supplier(models.Model):
    uuid = UUIDField(primary_key=True)
    company  = models.ForeignKey(Company, db_column='company_uuid',null=True, blank=True)
    sector = models.ForeignKey(CustomerSector, db_column='sector_uuid',null=True, blank=True,verbose_name=_('Sector'))
    account_number = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Account No'))
    reference  = models.CharField(null=True, blank=True,max_length=255)
    notes = models.TextField(null=True, blank=True) 
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True)
    user = UserField(null=True, blank=True)
    jms_code = models.CharField(null=True, blank=True,max_length=255)

class Supplies(models.Model):
    uuid = UUIDField(primary_key=True)
    supplier  = models.ForeignKey(Supplier, db_column='supplier_uuid',null=True, blank=True)
    bought_in_control_panel  = models.ForeignKey('boughtin.BoughtInControlPanel', db_column='bought_in_control_panel_id',null=True, blank=True)

class Costbook(models.Model):
    COSTBOOK_TYPES = [
        ('glass', 'Glass'),
        ('timber', 'Timber'),
        ('fittings', 'Fittings'),
        ('misc', 'Miscellaneous'),
    ]
    uuid                = UUIDField(primary_key=True)
    number              = models.IntegerField(null=True, blank=True, editable=False)
    type                = models.CharField(null=True, blank=True, max_length=50, editable=False, choices=COSTBOOK_TYPES)
    name                = models.CharField(null=True, blank=True, max_length=255)
    date_created        = models.DateTimeField(null=True, blank=True, editable=False)
    date_modified       = models.DateTimeField(null=True, blank=True, auto_now=True, editable=False)
    user                = UserField(null=True, blank=True)

class FittingItemSupplierCost(CostbookCostEntry):
    cost_type = (
        (BI_COST_MANUAL, _('Default Cost')),
        (BI_COST_REQUEST, _('Request Cost'))         
    )

#    IMPORTANT: the following fields INHERITED from CostbookCostEntry (setp.models) 

#    uuid = UUIDField(primary_key=True)
#    costbook = models.ForeignKey(Costbook, db_column='costbook_uuid',null=True, blank=True)
#    costbook_number = models.IntegerField(null=True, blank=True, editable=False)
#    net_cost  = models.FloatField(_('Net Cost'),null=True, blank=True,default='0')
#    charge_out = models.FloatField(_('Charge out'),null=True, blank=True)

    rrp = models.FloatField(_('RRP'),null=True, blank=True)
    fitting_item = models.ForeignKey(FittingItem, db_column='fitting_item_uuid',null=True, blank=True, editable=False, related_name='supplier_cost_set')
    supplier = models.ForeignKey(FittingSupplier, db_column='fitting_supplier_uuid',null=True, blank=True)
    code = models.CharField(null=True, blank=False,max_length=255)
    cost_type = models.IntegerField(null=True, blank=True, choices=cost_type)
    user = UserField(null=True, blank=True, serialize=False)
    date_time_updated  = models.DateTimeField(null=True, blank=True, auto_now=True)  

class Fitting(models.Model):
    uuid                         = UUIDField(primary_key=True)
    bought_in_control_panel_file = models.ForeignKey(BoughtInControlPanelFile, db_column='bought_in_control_panel_file_id',null=True, blank=True)
    name                         = models.CharField(_('name'),null=True, blank=False,max_length=255)                           # Accessed by the get_name property
    code                         = models.CharField(_('Code'),null=True, blank=True,max_length=255)
    default_colour               = models.ForeignKey(Colour, db_column='default_colour_uuid',null=True, blank=True)
    material                     = models.ForeignKey(Material, db_column='material_uuid',null=True, blank=True)
    material_finish              = models.ForeignKey(MaterialFinish, db_column='material_finish_uuid',null=True, blank=True)
    pricing_type                 = models.IntegerField(_('pricing type'), choices=PRICING_TYPE)
    sales_description            = models.CharField(_('Sales Description'),null=True, blank=False,max_length=255)              # Accessed by the get_sales_description property
    purchase_description         = models.CharField(_('Purchase Description'),null=True, blank=False,max_length=255)           # Accessed by the get_purchase_description property
    workshop_description         = models.CharField(_('Workshop Description'),null=True, blank=False,max_length=255)           # Accessed by the get_workshop_description property
    notes                        = models.TextField(null=True, blank=True) 
    manufacturer                 = models.ForeignKey(Manufacturer, db_column='manufacturer_uuid',null=True, blank=True)
    manufacturer_code            = models.CharField(_('Manufacturer code'),null=True, blank=False,max_length=100)
    specification                = models.TextField(null=True, blank=False)
    limit_weight_min             = models.FloatField(_('Min Weight'), null=True, blank=True)
    limit_weight_max             = models.FloatField(_('Max Weight'), null=True, blank=True)
    limit_height_min             = models.FloatField(_('Min Height'), null=True, blank=True)
    limit_height_max             = models.FloatField(_('Max Height'), null=True, blank=True)
    limit_width_min              = models.FloatField(_('Min Width'), null=True, blank=True)
    limit_width_max              = models.FloatField(_('Max Width'), null=True, blank=True)
    fire_rating                  = models.ForeignKey(FireRating, db_column='fire_rating_id',null=True, blank=True)
    u_value                      = models.FloatField(_('U-value'),default=0)
    acoustic_rating              = models.FloatField(_('Acoustic Rating'),default=0)
    image                        = models.ImageField(_('Image'),upload_to=_fitting_image_upload_path, storage=DatabaseImageStorage(), null=True, blank=True)
    fitting_quantity_type        = models.ForeignKey(FittingQuantityType,db_column='fitting_quantity_type_id', null=True, blank=True)
    allow_profile                = models.BooleanField(default=0)
    profile_xml                  = models.TextField(null=False, blank=True)
    jms_default_cost             = models.FloatField(_('JMS Default Cost'),null=True, blank=True)
    disabled                     = models.BooleanField(default=0)
    date_time_updated            = models.DateTimeField(null=True, blank=True, auto_now=True)

class Manufacturer(models.Model):
    uuid = UUIDField(primary_key=True)
    company  = models.ForeignKey(Company, db_column='company_uuid',null=True, blank=True)
    account_number = models.CharField(null=True, blank=True,max_length=255,verbose_name=_('Account No'))
    reference  = models.CharField(null=True, blank=True,max_length=255)
    notes = models.TextField(null=True, blank=True)
    date_created = models.DateTimeField(null=True, blank=True, auto_now_add=True)
    date_modified = models.DateTimeField(null=True, blank=True, auto_now=True)
    user = UserField(null=True, blank=True)
    jms_code = models.CharField(null=True, blank=True,max_length=255)

class FittingItem(models.Model, BoughtinItemMixin):
    uuid = UUIDField(primary_key=True)
    bought_in_control_panel_file = models.ForeignKey(BoughtInControlPanelFile, db_column='bought_in_control_panel_file_id',null=True, blank=True)
    fitting = models.ForeignKey(Fitting, db_column='fitting_uuid',null=True, related_name = 'item_set')
    unit_size = models.FloatField('Base Quantity', null=False, blank=False)
    unit_count = models.IntegerField('Multiplier', null=False, blank=False)

class FileStore(models.Model):
    uuid = UUIDField(primary_key=True)
    filename = models.CharField(max_length=255)
    data_base64 = models.TextField(null=True, blank=False)
    size = models.IntegerField(null=False, blank=False)

class FittingSupplier(models.Model):
    uuid = UUIDField(primary_key=True)
    fitting = models.ForeignKey(Fitting, db_column='fitting_uuid',null=True, blank=True, related_name='supplier_set')
    supplier = models.ForeignKey(Supplier, db_column='supplier_uuid',null=True, blank=True)
    rating = models.IntegerField(null=True, blank=True)
    markup = models.FloatField(_('markup'),null=True, blank=True)
    disabled = models.IntegerField(null=True, blank=True)
    date_time_updated  = models.DateTimeField(null=True, blank=True, auto_now=True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:32:32.997

一些东西：

*   你不应该迭代查询集，除非你必须这样做。
*   你应该只得到你需要的东西。
*   你有很多冗余代码。
*   使用 django-debug-toolbar，并且很开心。
*   几乎可以肯定，您想要的信息可以在一两个查询集中返回。没有看到你的模型，很难知道如何最好地回答这个问题。
*   与上述相关，您的问题是什么？在您提供模型之后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:45:33.520

目前尚不清楚您要检索的内容，它看起来`result`包含或多或少与`company_id`. 你不只是需要配件吗？

无论如何，您经常会做一件事，那就是：

```
for x in a_previous_queryset:
    blop += list(Something.objects.filter(x=x.uuid)) 
```

在这里，您正在对 中的每个元素进行一次查询`a_previous_queryset`，而您可以这样做：

```
blop = Something.objects.filter(x__in=a_previous_queryset) 
```

这将为所有内容创建一个查询集。您的代码可能还有很多其他事情要做。

另外，我不知道你为什么`list`每次查询。

更广泛地说，你真的应该尝试理解，首先，每个查询实际上做了什么（阅读文档和 connection.queries 有好处），其次，django 提供的所有选项是什么（查询集上的文档很好为了那个原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:33:53.200

当您使用 DEBUG=True 运行 Django 时，会保留查询执行时间以供以后分析。这是Django 文档的[相关部分：](https://docs.djangoproject.com/en/dev/faq/models/#how-can-i-see-the-raw-sql-queries-django-is-running)

> 确保您的 Django DEBUG 设置设置为 True。然后，只需这样做：
> 
> ```
> from django.db import connection
> connection.queries [{'sql': 'SELECT polls_polls.id,polls_polls.question,polls_polls.pub_date FROM
> polls_polls', 'time': '0.002'}] 
> ```

# symfony1 - Doctrine 1.2 在加载一对一关系时不设置引用字段

> ID：12059234
> 
> 赞同：1
> 
> 时间：2012-08-21T16:27:55.190
> 
> 标签：symfony1, doctrine, one-to-one, relation

我有一对一关系的简单模式：

```
Site:
  columns:
    name: { type: string(255) }
User:
  columns:
    name: { type: string(255) }
    site_id: { type: integer }
  relations:
    Site: { foreignType: one } 
```

我正在覆盖 Site::save() 方法（当我从管理生成器编辑站点时调用），我需要对用户进行操作，并且用户再次引用站点：

```
echo $this->getUser()->getSite()->getName(); 
```

当调用 getSite() 时，$this 会被数据库中的值覆盖，因为 Doctrine 从 db 加载“Site”关系并根据身份映射替换 $this。显然，对对象的所有更改都会丢失。在阅读了一些代码后，我发现用户对象在 getUser() 之后没有设置 _references['Site']，这就是 Doctrine 尝试从数据库加载站点的原因。如果我预先

$this->getUser()->setSite($this);

，然后一切都按预期工作，并且不会进行其他查询。另一种解决方法是在查询中加入关系：

```
$this->site = Doctrine::getTable('Site')
  ->createQuery('s')
  ->leftJoin('s.User u')
  ->leftJoin('u.Site us')
  ->fetchOne(); 
```

但这是一种预期的行为吗？我怎样才能让 Doctrine 知道 $this === $this->getUser()->getSite()？我使用 symfony 1.4.18 和 Doctrine 1.2.4。谢谢你。

# ios - iOS 5，Storyboards，ARC：创建和设置自定义委托和数据源以进行编程。创建了 UITableView

> ID：12059235
> 
> 赞同：0
> 
> 时间：2012-08-21T16:28:02.253
> 
> 标签：ios, cocoa-touch, uitableview

这个问题的前传就[在这里](https://stackoverflow.com/questions/12042770/ios-5-storyboards-customize-programmatically-created-uitableview-for-every-uiv)。

我正在尝试为我以编程方式创建的 UITableView 创建和设置自定义委托和数据源。我已经四处搜索，但找不到任何明确的解决方案来解决我的问题。

同时，我创建了一个符合 UITableViewDelegate、UITableViewDataSource 协议的新类。在这堂课中：

tableView numberOfRowsInSection: 20 tableView cellForRowAtIndexPath: cell.textLabel.text=@"Nominals";

包含 UIView 的类：

创建 UITableView 的方法：

```
-(IBAction)segmentValueChaged:(id)sender
{
if(self.segment.selectedSegmentIndex==0)
{
    [self.coinageView removeFromSuperview];
    [self.view addSubview:nominalsView];
    [self populateNominals:self.subCountryID];
}
else 
{
    [self.nominalsView removeFromSuperview];
    [self.view addSubview:coinageView];
    [self populateCoinages:self.subCountryID];
}
}

-(void)populateNominals:(int)subCountryID
{
NominalsTableViewDelegate *del=[[NominalsTableViewDelegate alloc]init];
UITableView *nominalsTableView=[[UITableView alloc]initWithFrame:CGRectMake(0, 0, 320, 372) style:UITableViewStylePlain];
[nominalsTableView setDelegate:del];
[nominalsTableView setDataSource:del];
[self.nominalsView addSubview:nominalsTableView];
[nominalsTableView reloadData];
} 
```

最后，我得到了 EXC_BAD_ACCESS。邪恶在 [nominalsTableView setDelegate:del]; [nominalsTableView setDataSource:del]; 行。他们怎么了。

非常感谢您的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:44:06.467

我不确定您是否要在当前视图中添加新的 UITableView，但我会假设您正在这样做。

如果你有一个符合 UITableViewDelegate 的类。但是当我需要以编程方式创建 UITableView 时，我会创建一个新的 UITableView 类（带有 .h 和 .m），然后创建一个 MutableArray 并将其作为属性公开给父视图，以便它可以设置数据源。

从那里，您可以创建该类的一个实例以及数据源（您从子对象公开）。最后，您将视图添加到当前视图中。这种方法不需要设置委托，因为您的子类符合 tableview 委托协议。

如果您只是修改当前 tableview 中的数据，则使用 a`NSMutableArray`然后更改其中的数据。然后做一个

```
 [self.tableView reloadData]; 
```

希望这可以帮助！

**已编辑**

我可能误解了您的问题，您（很可能）需要做的是创建委托类的属性，然后创建您的委托类的实例并将其分配给该属性。

然后做一个

```
 [myTableView setDelegate:self.myProperty];
      [myTableView setDatasource:self.myProperty]; 
```

我相信，这会解决你糟糕的访问问题。

**再次编辑**

在 tableview 类的 .h 中创建一个属性，如下所示：

```
 @property (nonatomic, retain) NominalsTableViewDelegate *myDelegate; 
```

从那里然后在您的 .m 文件中，您执行类似于此的操作：

```
NominalsTableViewDelegate* delegateClass = [[NominalsTableViewDelegate alloc] init];
[self setMyDelegate:delegateClass];
[delegateClass release]; 
```

然后你可以这样设置你的 tableview 数据源：

```
[myTableView setDelegate:self.myDelegate];
[myTableView setDatasource:self.myDelegate]; 
```

***注意***：我目前无法使用机器来测试它，但只是为了给你指出一些东西。

# javascript - Socket.io 发送消息两次（或更多）

> ID：12059237
> 
> 赞同：4
> 
> 时间：2012-08-21T16:28:05.373
> 
> 标签：javascript, node.js, push-notification, socket.io, push

我在 node.js 的 server.js 文件中有此代码：

```
var app = require('http').createServer(handler), io = require('socket.io').listen(app);
var xml2js = require('xml2js'), parser = new xml2js.Parser(), fs = require('fs');

// creating the server ( localhost:8000 )
app.listen(8000);

/**
 * Esta función es la que envía el archivo js necesario para la comunicación
 * push con sockets
 * 
 * @param req
 * @param res
 */
function handler(req, res) {
    Request = require('url').parse(req.url, true);
    site = Request.query.site;
    entity = Request.query.entity;
    id = Request.query.id;

    fs.readFile(__dirname + '/client.js', 'utf8', function(err, data) {
        if (err) {
            console.log(err);
            res.writeHead(500);
            return res.end('Error loading client.js');
        }
        var dataString = data.toString();
        dataString = dataString.replace('confSite', site);
        dataString = dataString.replace('confEntity', entity);
        dataString = dataString.replace('confId', id);
        res.writeHead(200, {
            'Content-Type' : 'text/javascript;charset=UTF-8'
        });
        res.end(dataString);
    });
};

var listeners = {};
var parsers = {};
var listenersAndSockets = {};
var socketsOnListeners = {};
var watchers = {};
/**
 * Esta función es la que enviará la información que se actualice a los
 * clientes. Escuchará un archivo xml el cual envará al cliente una vez que este
 * haya cambiado
 */
io.sockets.on('connection', function(socket) {
    socket.on ('connect', function() {
        console.log('conectado');
    });
    socket.on('setup', function(config) {
        console.log('setup');
        var site = config.site;
        var entity = config.entity;
        var id = config.id;
        var listenerName = '' + site + entity + id + '';
        watchers[listenerName] = site + '/' + '/' + entity + '/' + id + '.xml';
        socketsOnListeners[socket.id] = listenerName;
        if (typeof socketsOnListeners[listenerName] == 'undefined') {
            socketsOnListeners[listenerName] = {};
        }
        socketsOnListeners[listenerName][socket.id] = socket.id;
        if (typeof listeners[listenerName] == 'undefined') {
            parsers[listenerName] = new xml2js.Parser();
            fs.stat(watchers[listenerName], function(err, stats) {
                if (err) {
                    fs.writeFile(watchers[listenerName], '');
                }
            });
            listeners[listenerName] = function(curr, prev) {
                fs.readFile(watchers[listenerName], function(err, data) {
                    parsers[listenerName].parseString(data);
                });
            };
            fs.watch(watchers[listenerName], listeners[listenerName]);
        }
        parsers[listenerName].addListener('end', function(result,a) {
            socket.volatile.emit('notification', result);
        });
    });

    socket.on('disconnect', function() {
        delete socketsOnListeners[socketsOnListeners[socket.id]][socket.id];
        if (socketsOnListeners[socketsOnListeners[socket.id]].lenght == 0) {
            fs.unwatch(watchers[socketsOnListeners[socket.id]]);
            delete watchers[socketsOnListeners[socket.id]];
        }
        delete socketsOnListeners[socket.id];
    });
}); 
```

在我的 test.html 我有这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Prueba de Push</title>
</head>
<body>

    <div id="div1">Este es un texto de prueba</div>

    <script src="http://10.0.0.113:8000/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://10.0.0.113:8000/?site=levelup&entity=noticia&id=1"></script>

    <script>
        function test(data) {
            console.log(data);
            jQuery('#' + data.id).html(data.content);
        }
    </script>

</body>
</html> 
```

Client.js 是这样的：

```
var socket = io.connect('http://10.0.0.113:8000');
var config = {
    site : 'confSite',
    entity : 'confEntity',
    id : 'confId'
};

socket.emit("setup", config);
socket.on('reconnect', function() {
    socket.emit("setup", config);
});
// on every message recived we print the new datas inside the #container div
socket.on('notification', function(data) {
    _efbn(data.callback, window, data.response, data);
});

/**
 * Función que ejecuta una función por nombre. Puede usar namespaces
 * (algo.algo.algo.funct)
 * 
 * @see http://stackoverflow.com/questions/359788/javascript-function-name-as-a-string/359910#359910
 */
function _efbn(functionName, context) {
    var args = Array.prototype.slice.call(arguments);
    args = [ args[2], args[3] ]; // Fix para IE.
    var namespaces = functionName.split(".");
    var func = namespaces.pop();
    for ( var i = 0; i < namespaces.length; i++) {
        context = context[namespaces[i]];
    }
    try {
        if (typeof context[func] == 'function') {
            return context[func].apply(this, args);
        }
    } catch (e) {
        console.log(e);
    }
    return null;
} 
```

在 Firefox 中，当我修改服务器上的文件时，我会收到两次或更多的通知。有什么办法可以防止这种情况发生吗？我在 node.js 上读过一些关于组的东西......这可能对我有帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:02:28.693

`setup`您开始在事件中观看文件。在客户端，`setup`事件可能会被多次发出（`reconnect`事件）。对于每个`watch`呼叫，新的侦听器将被添加到文件中。在设置之前，您需要检查`watch`文件中是否已经存在侦听器（对于此套接字）。`unwatch`在套接字关闭后您还需要文件。否则会出现内存泄漏。

**更新**

你也需要搬家

```
parser.addListener('end', function(result) {
    socket.volatile.emit('notification', result);
}); 
```

外部`setup`事件。

# android - Android ImageView 翻译动画

> ID：12059238
> 
> 赞同：0
> 
> 时间：2012-08-21T16:28:08.273
> 
> 标签：android, animation, imageview

我正在尝试为 ImageView 设置动画，将其缩小、淡出并将其翻译到屏幕的左上角。这就是我得到的：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">

<alpha
android:fromAlpha = "1.0"
android:toAlpha = "0"
android:duration = "900">
</alpha>
<scale
android:fromXScale = "1.0"
android:toXScale = "0" 
android:fromYScale = "1.0"
android:toYScale = "0" 
android:pivotX="0%"
android:pivotY="0%" 
android:duration = "900">
</scale>

<translate
    android:fromXDelta="0%" android:fromYDelta="0%" 
    android:toXDelta="-50.0%p" android:toYDelta="-50.0%p" 

    android:duration="900" 
    android:fillAfter="true" 
    />
</set> 
```

缩放和淡化效果很好，但翻译不准确。我希望它转到屏幕的左上角。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T10:19:24.000

动画完成后，您必须将对象移动到新坐标。您会看到，动画实际上并没有移动对象 - 它只是为图像设置动画。

# cocoa - NSDocument isLocked 10.7 的实现？

> ID：12059241
> 
> 赞同：0
> 
> 时间：2012-08-21T16:28:19.413
> 
> 标签：cocoa, nsdocument

如何检查文档是否在 10.7 中被锁定？

NSDocument 有一个方法 isLocked，但它仅在 10.8 上可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:41:37.170

这是我的实现：

```
+ (BOOL)isDocumentLocked:(NSDocument*)doc
{
  if (doc == nil)
  {
    return NO;
  }
  else if ([doc respondsToSelector:@selector(isLocked)]) // 10.8
  {
    return [doc isLocked];
  }
  else // OS X version < 10.8
  {
    NSError * error;
    BOOL isAutosavingSafe = [doc checkAutosavingSafetyAndReturnError:&error];
    if (!isAutosavingSafe)
    {
      return YES;
    }

    if (doc.fileURL == nil)
      return NO;

    NSFileManager* fm = [NSFileManager defaultManager];
    NSString* path = doc.fileURL.absoluteURL.path;

    if (![fm isWritableFileAtPath:path])
      return YES; // No writing permissions

    NSDictionary *attributes = [fm attributesOfItemAtPath:path error:&error];
    BOOL isLocked = [[attributes objectForKey:NSFileImmutable] boolValue];
    if (isLocked)
    {
      return YES;
    }
  }
  return NO;
} 
```

# jquery - html 下拉菜单触发 jquery / ajax 从 mysql 填充字段

> ID：12059247
> 
> 赞同：1
> 
> 时间：2012-08-21T16:28:58.257
> 
> 标签：jquery

编辑：这个问题相当复杂，大多数来这里作为示例（见标题）的人可能会感到失望。

因此，OP 创建了一个特殊的答案，其中包含一个使用 jQuery 进行操作的简单示例（参见标题）。

为了节省您的时间，这就是现在选择的答案（之前选择的答案是 OP 自己对原始问题的解决方案，所以没有伤害）。

如果这听起来像你要找的东西，你为什么还在读这个胡言乱语？去看看那个答案。

* * *

第一部分——

我认为这必须通过 Ajax/JQuery 来完成，但我需要帮助。这是我必须做的一个非常简化的示例。

MySQL DB 包含一个名为 USERS 的表，其中包含以下字段：
first_name
last_name
email
admin_level

下面的表格将允许更改指定用户的上述信息。用户列在 HTML 下拉列表中。下拉列表是通过 PHP 脚本从 MySQL 检索值填充的，但在此示例中已被硬编码以简化示例。

首先，操作员在下拉列表中选择用户名。然后，onchange 事件应该触发一个 jQuery(?) 脚本，该脚本将轮询数据库并获取所选用户的上述信息，然后填充下面的表单字段。

```
<div id="whiteboard"></div><br />
<br />
<form action="" method="POST" id="myform">
    <ul>
    <li>
        Choose Account:<br />
        <select name='staff_pick' style='width:200px;' onchange=get();>
            <option value = '1'>John Smith</option>
            <option value = '2'>Jane Doe</option>
            <option value = '3'>Bob Barker</option>
        </select>
    </li>
    <li>
        First Name:<br />
        <input type="text" name="first_name" id="first_name">
    </li>
    <li>
        Last Name:<br />
        <input type="text" name="last_name">
    </li>
    <li>
        Email:<br />
        <input type="text" name="email">
    </li>
    <li>
        Admin Level:<br />
        <input type="text" name="admin_level" value="3">
    </li>
    <li>
        <input type="submit" value="Update">
    </li>
    </ul>
</form> 
```

否则，如果有人能指出一个与这种情况非常匹配的综合教程，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:26:52.220

你是因为标题而来到这个问题的，你希望它会告诉你如何使用 jQuery 来检测对 html`<select>`下拉列表的更改，然后使用 AJAX 从 MySQL 数据库中获取值并返回答案。

这是一个有效的、经过测试的示例，可以帮助您入门。

首先，你需要三样东西：

1) 一个 MySQL 数据库，包含：
    1a - 一个名为`users`
    1b 的表 - 每行需要字段`user_id`, `first_name`, `last_name`
    1c - 一堆数据，有两个或三个名字为`Chris`
    1d 的用户 - 请注意，上述步骤中的大小写很重要（`user_id`不是`User_ID`）
    1e - 在步骤 1b 中，您可以创建`user_id`一个自增字段，类型 = int

2) 一个名为“example.php”的 php 文件，其中包含：

```
<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script type="text/javascript">
            $(function() {
//alert('Document is ready');

                $('#stSelect').change(function() {
                    var sel_stud = $(this).val();
//alert('You picked: ' + sel_stud);

                    $.ajax({
                        type: "POST",
                        url: "example_ajax.php",
                        data: 'theOption=' + sel_stud,
                        success: function(whatigot) {
//alert('Server-side response: ' + whatigot);
                            $('#LaDIV').html(whatigot);
                            $('#theButton').click(function() {
                                alert('You clicked the button');
                            });
                        } //END success fn
                    }); //END $.ajax
                }); //END dropdown change event
            }); //END document.ready
        </script>
    </head>
<body>

    <select name="students" id="stSelect">
        <option value="">Please Select</option>
        <option value="John">John Doe</option>
        <option value="Mike">Mike Williams</option>
        <option value="Chris">Chris Edwards</option>
    </select>

    <!-- **** The AJAX success fn will place found results into this DIV **** -->
    <div id="LaDIV"></div>

</body> 
```

3) 一个名为的 php 文件，`example_ajax.php`其中包含：

```
<?php

//Login to database (usually this is stored in a separate php file and included in each file where required)
    $server = 'localhost'; //localhost is the usual name of the server if apache/Linux.
    $login = 'abcd1234';
    $pword = 'verySecret';
    $dbname = 'abcd1234_mydb';
    mysql_connect($server,$login,$pword) or die($connect_error); //or die(mysql_error());
    mysql_select_db($dbname) or die($connect_error);

//Get value posted in by ajax
    $selStudent = $_POST['theOption'];
    //die('You sent: ' . $selStudent);

//Run DB query
    $query = "SELECT `user_id`, `first_name`, `last_name` FROM `users` WHERE `first_name` = '$selStudent' AND `user_type` = 'staff'";
    $result = mysql_query($query) or die('Fn test86.php ERROR: ' . mysql_error());
    $num_rows_returned = mysql_num_rows($result);
    //die('Query returned ' . $num_rows_returned . ' rows.');

//Prepare response html markup
    $r = '  
            <h1>Found in Database:</h1>
            <ul style="list-style-type:disc;">
    ';

//Parse mysql results and create response string. Response can be an html table, a full page, or just a few characters
    if ($num_rows_returned > 0) {
        while ($row = mysql_fetch_assoc($result)) {
            $r = $r . '<li> ' . $row['first_name'] . ' ' . $row['last_name'] . ' -- UserID [' .$row['user_id']. ']</li>';
        }
    } else {
        $r = '<p>No student by that name on staff</p>';
    }

//Add this extra button for fun
    $r = $r . '</ul><button id="theButton">Click Me</button>';

//The response echoed below will be inserted into the 
    echo $r; 
```

* * *

笔记：

`<head>`a) 我在主文件中包含了 javascript 。通常，我们将 javascript 保存在一个单独的文件中（例如 mycode.js），并且只在主文件中引用它，因此：

`<script type="text/javascript" src="mycode.js"></script>`

b) 这条线非常重要。没有它，jQuery 不会，ajax 也不会。

`<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:48:07.127

第二部分——

我在表单上方临时创建了一个 div（“白板”）来显示我从数据库中返回的内容。以下 PHP 脚本 (data3.php) 成功轮询数据库并检索所需数据：

```
include 'connect_to_db.php';
$id = mysql_real_escape_string($_POST['sent_id']);
$query = "SELECT `fname`, `lname`, `eml`,`priv` FROM `users` WHERE `id`='$id'";
$next_user = mysql_query($query);

echo mysql_fetch_assoc($next_user); 
```

所以数据又回来了，但我无法在 jQuery 中将数据从数组中取出。

在上述 HTML 文档的头部，jQuery/javascript 如下：

```
function get() {
   $.post('data3.php', {sent_id: myform.staff_pick.value },
      function(bounced) {
         var val0 = bounced[0];
         var val1 = bounced[1];
         var val2 = bounced[2];
         var val3 = bounced[3];
         var val4 = bounced[4];
      $('#whiteboard').html(val0+" "+val1+" "+val2+" "+val3+" "+val4).show();
   });
} 
```

但是...输出不正确。单词“A rra y”被输出到白板 div 中。如何获取 fn（名字）、ln、eml 等值？

然后...我如何将每个断开的返回值放入 myform 表单中的相应输入字段中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T19:33:08.337

第 III 部分 - 部分解决方案

必须有更好的（jQuery）方法来分解 jQuery 代码块内的 mysql_fetch_assoc 数组，所以如果有人可以提供帮助，我将不胜感激。

但是，将这个 kludge 写入 DATA3.PHP 文件现在正在工作，我现在在 jQuery 中分解了各个值：

DATA3.PHP 现在是：

```
//DATA3.PHP
include 'connect_to_db.php';
$id = mysql_real_escape_string($_POST['sent_id']);
$query = "SELECT `fname`, `lname`, `eml`,`priv` FROM `users` WHERE `id`='$id'";
$next_user = mysql_query($query);

$row = mysql_fetch_assoc($next_user);
echo $row['fname']."|".$row['lname']."|".$row['eml']."|".$row['priv']; 
```

主 index.php 文件中的 jQuery 脚本现在是：

```
function get() {
    $.post('data3.php', {sent_id: myform.staff_pick.value },
        function(bounced) {
            var valNew = bounced.split("|");
            $('#first_name').value = valNew[0] ;
            $('#last_name').value = valNew[1] ;
            $('#email').value = valNew[2] ;
            $('#admin_level').value = valNew[3] ;
            $('#whiteboard').html(valNew[1]).show();
        });
} 
```

我要解决的最后一个问题是输入框（在表单中）仍然不包含每个选定用户的更新值。但是，白板 div 始终包含正确的信息，并为每个新选择的用户正确更新。（我将该命令移到堆栈底部只是为了确保它仍然运行，并且确实如此。）所以，我很困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T20:14:27.227

最终解决方案：

语法错误......有什么办法。

主 index.php 文件中的 jQuery 脚本现在是：

```
function get() {
    $.post('data3.php', {sent_id: myform.staff_pick.value },
        function(bounced) {
            var valNew = bounced.split("|");
            $('#first_name').val(valNew[0]) ;
            $('#last_name').val(valNew[1]) ;
            $('#email').val(valNew[2]) ;
            $('#admin_level').val(valNew[3]) ;
            $('#whiteboard').html(valNew[1]).show();
        });
} 
```

您会注意到不正确的语法是：

```
$('#first_name').value = valNew[0] ; 
```

更正后的语法是：

```
$('#first_name').val(valNew[0]) ; 
```

我会把这个问题留几天，如果有人有更好的方法来做这件事，请回复。特别是，我想了解我如何才能返回

```
echo mysql_fetch_assoc($next_user); 
```

在最初的 DATA3.PHP 文件中（请参阅“第 III 部分部分解决方案”）并在 INDEX.PHP 主页面上的 jQuery 中正确处理。

# javascript - jQuery UI - 可排序手风琴不起作用

> ID：12059252
> 
> 赞同：2
> 
> 时间：2012-08-21T16:29:35.910
> 
> 标签：javascript, jquery, html, jquery-ui

我制作了一个嵌套的可排序手风琴，但有些东西不起作用。在 id 'accordian2' 中，每个项目的高度太小，并且显示垂直滚动条。'1' 项目的值被剪裁，因此只有一半显示。

有人可以告诉我我的代码有什么问题吗？

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>jQuery UI Example Page</title>
        <link type="text/css" href="css/custom-theme/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
        <script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.23.custom.min.js"></script>

    </head>
    <body>

    <script>
    $(function() {
        function create_accordian(str) {
            $( str )
                .accordion({
                    header: '> div > h3'
                })
                .sortable({
                    axis: 'y',
                    handle: 'h3',
                    stop: function( event, ui ) {
                        // IE doesn't register the blur when sorting
                        // so trigger focusout handlers to remove .ui-state-focus
                        ui.item.children( 'h3' ).triggerHandler( 'focusout' );
                    }
                });
        }
        create_accordian('#accordion');
        create_accordian('#accordion1');
        create_accordian('#accordion2');
        //create_accordian('#accordion3');
    });
    </script>

        <style type='text/css'>
            /*demo page css*/
            #accordion { font: 62.5% 'Trebuchet MS', sans-serif; margin: 10px;}
        </style>

            <div id='accordion'>
                <div class='group'>
                    <h3>
                        <a href='#'>1\. blah</a>
                    </h3>
                    <div>

                        <div id='accordion1'>
                            <div class='group'>
                                <h3>
                                    <a href='#'>blah</a>
                                </h3>
                                <div>
                                    <a href='#'>
                                        Edit Item
                                    </a>
                                    <br/>
                                    <span style='display:none;'>
                                        4900bc3b-a086-4d0c-89b8-09e3724aac8e
                                    </span>
                                </div>
                            </div>
                            <div class='group'>
                                <h3>
                                    <a href='#'>blah</a>
                                </h3>
                                <div>
                                    <a href='#'>
                                        Edit Item
                                    </a>
                                    <br/>
                                    <span style='display:none;'>
                                        0d59f87e-a294-4f85-beae-a0e266ab6a7e
                                    </span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class='group'>
                    <h3>
                        <a href='#'>2\. blah</a>
                    </h3>
                    <div>

                        <div id='accordion2'>
                            <div class='group'>
                                <h3>
                                    <a href='#'>blah</a>
                                </h3>
                                <div>
                                    1
                                </div>
                            </div>
                            <div class='group'>
                                <h3>
                                    <a href='#'>blah</a>
                                </h3>
                                <div>
                                    1
                                </div>
                            </div>
                            <div class='group'>
                                <h3>
                                    <a href='#'>blah</a>
                                </h3>
                                <div>
                                    1
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:53:08.857

@omega，在您的手风琴脚本中将**autoHeight选项设置为 false 。**例如。

```
function create_accordian(str) {
        $( str )
            .accordion({
                header: '> div > h3',
                autoHeight: false  // set this to false
            })
            .sortable({
                axis: 'y',
                handle: 'h3',
                stop: function( event, ui ) {
                    // IE doesn't register the blur when sorting
                    // so trigger focusout handlers to remove .ui-state-focus
                    ui.item.children( 'h3' ).triggerHandler( 'focusout' );
                }
            });
} 
```

[演示](http://jsfiddle.net/w963z/3/)

# node.js - DynamoDB REST API 可能的写入吞吐量

> ID：12059256
> 
> 赞同：3
> 
> 时间：2012-08-21T16:29:59.653
> 
> 标签：node.js, rest, amazon-ec2, amazon-web-services, amazon-dynamodb

我目前正在使用 NodeJS 和 DynamoDB 运行一些性能测试。特别是我对一个将项目保存到 DynamoDB 的 NodeJS 进程的可能写入吞吐量感兴趣。

我在 EC2 m1.medium 实例上运行了测试。要访问 DynamoDB，我使用 dynamo NodeJS 模块。在测试期间，我预置了一个具有 1000 个写入容量单位的 DynamoDB 表。我保留了大约 700 字节大小的项目。

这些测试的结果是最大。该系统的写入吞吐量约为 300 项/秒。在此吞吐量下，EC2 实例的虚拟 CPU 接近 100%。

考虑到调用 API 基本上是调用 HTTP REST 服务，与这篇文章相比，结果看起来有点现实：[Node.js' http.request 的性能如何？它可以处理多少并发请求？](https://stackoverflow.com/questions/6195177/what-is-the-performance-for-node-js-http-request-how-many-concurrent-request)

任何人都可以确认我的测试结果还是您遇到了不同的结果？有没有人测试过 AWS DynamoDB JAVA 或 C# 开发工具包？你有什么表现？

**更新：** 300 个项目/秒启用了[Nodetime](http://nodetime.com)。没有那个限制是大约**780 项/秒**，推送到 DynamoDB REST API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:43:13.817

您的瓶颈似乎是 m1.medium 实例。没有太多使用 node.js，我不能说另一个选项是否会表现得更好，但从我的观点来看，node.js 是您可以使用的更轻量级的选择之一。请记住，对 DynamoDB 等 AWS 服务的 REST 调用不仅仅是简单的 REST 调用，它们需要为每个请求创建一个签名，这需要一些基本的散列和加密技术，这可能就是 CPU 的行为方式。散列一个小字符串可能看起来并不多，但是当您必须每秒执行 300 次时，它很容易杀死 CPU。

我的建议是使用另一种实例类型，例如 c1.medium 将提供比 m1.medium 多 150% 的功能。除此之外，您还可以尝试在 python 或 php 中编写一个简单的测试脚本，以查看结果与 node.js 的比较。

# clojure - Clojure 中的惯用封装：如何将数据与链接行为捆绑在一起？

> ID：12059261
> 
> 赞同：22
> 
> 时间：2012-08-21T16:30:16.457
> 
> 标签：clojure, functional-programming, encapsulation

我试图弄清楚 Clojure 是否可以完全取代我在其他语言中习惯的范式。我不明白的一件事是如何在 Clojure 中惯用地实现封装（通过封装，我指的是数据与对该数据进行操作的方法（或其他函数）的捆绑）。

这是 OOP 的一个用例：

```
var apple = {
    type: "macintosh",
    color: "red",
    cost: 5
    markup: 1.5
    getInfo: function () {
        return this.color + ' ' + this.type + ' apple';
    }
    getPrice: function(){
        return this.cost * this.markup;
    }
} 
```

或类似地：

```
var person = {
    birthdate: '8/30/1980',
    firstname: 'leeroy',
    middleinitial: 'b',
    lastname: 'jenkins',
    getAge: function () {
        return -(new Date()
 - new Date(this.birthdate));
    }
    getFullFormattedName: function () {
        return capitalize(this.firstname+' '+this.middleinitial+' '+this.lastname;
    }
} 
```

以这种方式将行为与数据捆绑在一起通常很方便，但 Clojure 允许解决此问题的惯用方式是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-21T17:31:53.603

在惯用的 clojure 中，您的函数不*属于*数据，它们*对*这些数据进行操作。[使用映射](http://clojure.org/data_structures#Data%20Structures-Maps%20%28IPersistentMap%29)或[记录](http://clojure.org/datatypes)代替结构，并定义将这些结构作为参数的函数。例如，您的苹果示例可能如下所示：

```
; Define a record type with given fields
; `defrecord` macro defines a type and also two constructor functions,
; `->apple` and `map->apple`. The first one take a number of arguments
; corresponding to the fields, and the second one takes a map with
; field names as keys. See below for examples.
(defrecord apple [type color cost markup])

; Define several functions working on apples
; Note that these functions do not have any kind of reference to the datatype,
; they exploit map interface of the record object, accessing it like a map,
; so you can supply a real map instead of record instance, and it will work
(defn get-info [a] (str (:color a) " " (:type a) " apple"))
(defn get-price [a] (* (:cost a) (:markup a)))

; Example computation
; Bind `a` to the record created with constructor function,
; then call the functions defined above on this record and print the results
(let [a (->apple "macintosh" "red" 5 1.5)
      a-info (get-info a)
      a-price (get-price a)]
  (println a-info a-price))
; Will print the following:
; red macintosh apple 7.5

; You can also create an instance from the map
; This code is equivalent to the one above
(let [a (map->apple {:type "macintosh" :color "red" :cost 5 :markup 1.5})
      a-info (get-info a)
      a-price (get-price a)]
  (println a-info a-price))

; You can also provide plain map instead of record
(let [a {:type "macintosh" :color "red" :cost 5 :markup 1.5}
      a-info (get-info a)
      a-price (get-price a)]
  (println a-info a-price)) 
```

通常，当您想要具有可从 Java 代码获得的已知字段的静态对象时使用记录（`defrecord`生成适当的类；它还具有许多其他功能，如上面的链接所述），并且在所有其他情况下使用映射 - 关键字参数，中间结构、动态对象（例如从 sql 查询返回的对象）等。

因此在 clojure 中，您可以将*命名空间*视为一个封装单元，而不是*数据结构*。您可以创建一个命名空间，在其中定义您的数据结构，使用普通函数编写您想要的所有功能并将内部函数标记为私有（例如，使用`defn-`form 定义它们，而不是`defn`）。然后所有非私有函数将代表您的命名空间的接口。

如果您还需要多态性，则可以查看[multimethods](http://clojure.org/multimethods) and [protocols](http://clojure.org/Protocols)。它们为特殊和子类型类型的多态性提供了手段，即覆盖函数行为——类似于 Java 继承和方法重载可以做的事情。多方法更加动态和强大（您可以对参数的*任何*函数的结果进行分派），但协议更加高效和直接（除了继承和可扩展性之外，它们与 Java 接口非常相似）。

**更新：**回复您对其他答案的评论：

> 我正在尝试确定替代 OOP 方法的方法

了解究竟什么是“OOP 方法”是有帮助的。

传统面向对象语言（如 Java 或特别是 C++）中的任何方法本质上都是一个*普通**函数*，它接受一个名为. 由于这个隐含的论点，我们认为方法“属于”某个类，并且这些方法可以对它们“调用”的对象进行操作。*`this`*

 *但是，没有什么能阻止您编写友好的全局函数（在 C++ 中）或公共静态方法（在 Java 中），它们将对象作为其第一个参数并执行方法中可能执行的所有操作。没有人这样做是因为*多态性*，这通常是通过方法的概念来实现的，但我们现在不考虑它。

由于 Clojure 没有任何“私有”状态的概念（Java 互操作功能除外，但这是完全不同的事情），函数不需要以任何方式与它们操作的数据连接。您只需使用作为函数参数提供的数据，仅此而已。Clojure 中的多态功能以与 Java 不同的方式（多方法和协议，请参见上面的链接）完成，尽管有一些相似之处。但这是另一个问题和答案的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-12T08:34:40.573

创建一个在其词法范围内具有**this的闭包哈希图。**它与您的原始 Javascript 代码没有什么不同。

```
(defn apple-object [this]
  {:get-info  #(str (this :color) " " (this :type) " apple")
   :get-price #(* (this :cost) (this :markup))})

(defn person-object [this]
  {:get-age
   #(- (-> (java.util.Date.) (.getTime))
       (-> (this :birthdate) (.getTime)))

   :get-full-formatted-name
   #(clojure.string/join
     " "
     (map clojure.string/capitalize
          [(this :firstname) (this :middleinitial) (this :lastname)]))})

;;;; usage ;;;;

(def apple (apple-object
            {:type    "macintosh"
             :color   "red"
             :cost    5
             :markup  1.5}))

(apple :type)

((apple :get-info))

((apple :get-price))

(def person (person-object
             {:birthdate     (java.util.Date. 80 7 30)
              :firstname     "leeroy"
              :middleinitial "b"
              :lastname      "jenkins"}))

(person :birth-date)

((person :get-age))

((person :get-full-formatted-name)) 
```

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2012-08-22T01:29:47.240

不要这样做。您正在尝试在 FP 中编写 OOP。这和用英文写中文一样糟糕。*

# asp.net - 如何同时刷新数据库和应用程序？

> ID：12059264
> 
> 赞同：1
> 
> 时间：2012-08-21T16:30:26.087
> 
> 标签：asp.net, vb.net

我们有一个从表中获取数据的存储过程，让我们从一个 db1 中将其称为 table1 并填充一个表，在 db2 中称为 table2。

我们安排这个存储过程每隔 5 分钟执行一次这个功能。这工作正常。

鉴于用户大多在执行其他管理功能时离开他们的应用程序，我们创建了一个刷新按钮，在单击该按钮时刷新 GridView。

```
Protected Sub Refresh_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Refresh.Click
    ' Clean up text to return the GridView to it's default state
      strSearch.Text = ""
      SearchString = ""
      gridView1.DataBind()
End Sub 
```

我们希望同时单击此刷新按钮以使存储过程更新 table2 并同时刷新 GridView。

我知道`gridview1.Databind()`使用 table2 中的最新数据刷新 GridView，但是在刷新 GridView 之前，如何确保首先使用存储的 proc 使用 table1 中的数据更新 table2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:37:43.997

只需在调用 gridView1.DataBind() 之前从应用程序调用存储过程

这是从代码中调用存储过程的方式：

```
public object ExecuteStoredProcedureAsValue(SqlConnection conn, 
                                            string storedProcName, 
                                            List<SqlParameter> parameters) 
{
    using (var command = new SqlCommand(storedProcName, conn)) {
        command.CommandType = CommandType.StoredProcedure;

        if (parameters != null)
            parameters.ForEach(p => command.Add(param));

        object result = null;
        using (var reader = command.ExecuteReader()) {
            while (reader.Read())
            {
                result = reader[0];
                break;
            }
        }
        return result;
    }
} 
```

请注意，“conn”是 SqlConnection 对象。您应该在调用此代码之前初始化并打开 sql 连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:15:27.787

肯尼我已经为你准备了完整的vb代码，看看：

```
Private Sub CallRefresh()
     Dim connectionString As String = "Initial Catalog=myDataBase;data source=myServer;Integrated Security=SSPI;"
     Dim storedProcName As String = "ActivateServerTask"
     Dim conn As SqlConnection = New SqlConnection(connectionString)
     conn.Open()
     Dim command As SqlCommand = New SqlCommand(storedProcName, conn)
     command.CommandType = CommandType.StoredProcedure
     command.Parameters.Add(New SqlParameter("@taskId", 1))
     command.ExecuteNonQuery()
     command.Dispose()
     conn.Close()
     conn.Dispose()
 End Sub

 Protected Sub Refresh_Click(ByVal sender As Object, ByVal e As EventArgs) Handles     Refresh.Click       
      CallRefresh()
      gridView1.DataBind()       
 End Sub 
```

CallRefresh 打开连接，使用“taskId”参数执行“ActivateServerTask”存储过程，最后关闭连接...注意我正在使用具有集成安全性的 sql 连接。您可以在此处找到其他连接字符串：http: [//www.connectionstrings.com/](http://www.connectionstrings.com/)

快乐编码肯尼！

# javascript - getTimezoneOffset() 的有效值范围是多少？

> ID：12059265
> 
> 赞同：2
> 
> 时间：2012-08-21T16:30:37.143
> 
> 标签：javascript, timezone-offset

我的客户端浏览返回时区偏移值为1020，有效吗？如果它是有效的 Etc/GMT 区域是什么？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:33:27.473

如果它是 +1020，那将是 UTC 中的 -17（以前称为 GMT，正如 Collective Cognition 的评论中提到的那样），但这似乎是无效的：[http ://en.wikipedia.org/wiki/Time_zone](http://en.wikipedia.org/wiki/Time_zone)

# android - 如何连接没有公网IP的电脑？

> ID：12059270
> 
> 赞同：4
> 
> 时间：2012-08-21T16:30:52.730
> 
> 标签：android, delphi, networking

我有一个简单的应用程序想法，我需要知道如何从 Android 应用程序（客户端）连接到 Windows 应用程序（Delphi，服务器）。

不需要具体说明平台，我熟悉 Delphi 中使用 winsock 或 Indy 的网络，我相信我将能够在 Android 中找出适当的机制。

**我需要知道**的是如何连接到没有自己的公共 IP*并且*与客户端不在同一个网络中的服务器（计算机）（一个可以在本地路由器后面，而另一个可能正在连接例如，通过 3G 上网）。这应该是可能的，因为许多程序都是这样工作的（例如远程桌面程序，TeamViewer：一台计算机被分配了一个 ID，并且使用此 ID 其他计算机可以连接到它。）我将无法访问后面的路由器应用程序将运行，因此端口转发不是一个选项。

我有一个工作网络应用程序，但它只适用于局域网，所以我猜测需要另一种方法。

感谢您的回答

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:36:02.810

您可以放置​​一个中间服务器，它们都可以路由“nat traversal”。

否则，您将不得不在其中一台计算机的本地路由器上进行端口转发，以允许将传入连接转发到计算机。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-21T17:10:42.507

许多以这种方式工作的程序仍然使用具有公共 IP 的服务器。客户端连接到服务器的每一端都说“我在这里”。然后，公共服务器可以在两个客户端之间打乱数据。

这仍然留下了很多关于公共服务器和每个客户端之间的通信的问题 - 即拉取与推送以获取发送到服务器的数据并将其返回到第二个客户端。

您可能需要阅读[Copilot](http://www.joelonsoftware.com/articles/AardvarkSpec.html)（最初名为 Project Aardvark）的规范。Joel Spolsky 在项目启动时发布了规范。它谈到了他们对反射器服务的使用。

> **Reflector**
> 我们在服务器上运行的 Windows 服务，用于允许任何帮助者帮助任何受害者，即使他们都在防火墙后面。帮助者和受害者都连接到反射器。反射器检查他们是否被授权并在帮助者和受害者之间中继消息，直到付费时间用完

# javascript - 如何将悬停附加到 SVG 路径？

> ID：12059271
> 
> 赞同：0
> 
> 时间：2012-08-21T16:31:00.067
> 
> 标签：javascript, jquery

我正在动态绘制 svg 形状，我需要将悬停和单击侦听器附加到元素。出于某种原因，我无法让它工作。

我正在创建这样的svg：

```
function svgCreator(){
var objectName = this.name;
$('#container').append('<svg><path class="overlay" id="path_' +objectName +'"d="M5,723,5,716,205,612,226,717" /></svg>')
} 
```

后来我尝试附加悬停和单击事件：

```
function svgHover(){ //svgHover is a method of a generic object
var hotspotObject =this; //hotspotObject is storing the current object as a variable 
this.hotspotSvg.hover( //hotspotSvg is simply $('#path_' +this.name);
    function() { 
    alert('hovering');
    }, 
    function() { 
    $("#outlines").hide();
    }
).click(function() {

alert('You clicked me');
});

}; 
```

编辑：问题得到了解决，这根本不是因为 svg，而是因为我错误地附加了事件侦听器。我犯了责怪 svg 的错误，因为这是我正在尝试的全新事物。

# function - 如何编写 OpenCL 函数

> ID：12059276
> 
> 赞同：1
> 
> 时间：2012-08-21T16:31:22.760
> 
> 标签：function, pointers, reference, opencl

我是 OpenCL 的新手，我正在尝试在 OpenCL 中实现一个简单的功能。该函数应该从内核函数中调用。

```
void swap(int *a, int *b)
{
    int *temp = a;
    b = a;
    a = temp;
} 
```

但是在调用它时，交换不起作用。

有没有办法通过引用传递参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:40:28.037

您编写函数的方式，它没有做任何事情。您只是在分配指针。你需要有这个：

```
void swap(int *a, int *b)
{
    int temp = *a;
    *a = *b;
    *b = temp;
} 
```

据我所知，不允许使用参考参数。

# java - 如何使用 Apache HttpClient 发布 JSON 请求？

> ID：12059278
> 
> 赞同：103
> 
> 时间：2012-08-21T16:31:24.927
> 
> 标签：java, json, http, post, apache-commons-httpclient

我有以下内容：

```
final String url = "http://example.com";

final HttpClient httpClient = new HttpClient();
final PostMethod postMethod = new PostMethod(url);
postMethod.addRequestHeader("Content-Type", "application/json");
postMethod.addParameters(new NameValuePair[]{
        new NameValuePair("name", "value)
});
httpClient.executeMethod(httpMethod);
postMethod.getResponseBodyAsStream();
postMethod.releaseConnection(); 
```

它不断返回 500。服务提供商说我需要发送 JSON。Apache HttpClient 3.1+ 是如何做到的？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-08-21T17:36:17.593

Apache HttpClient 对 JSON 一无所知，因此您需要单独构建 JSON。为此，我建议从[json.org查看简单的](http://www.json.org/)[JSON-java](https://github.com/stleary/JSON-java)库。（如果“JSON-java”不适合你，json.org 有很多不同语言的库。）

一旦你生成了你的 JSON，你可以使用类似下面的代码来发布它

```
StringRequestEntity requestEntity = new StringRequestEntity(
    JSON_STRING,
    "application/json",
    "UTF-8");

PostMethod postMethod = new PostMethod("http://example.com/action");
postMethod.setRequestEntity(requestEntity);

int statusCode = httpClient.executeMethod(postMethod); 
```

**编辑**

注意 - 如问题中所要求的，上述答案适用于 Apache HttpClient 3.1。但是，为了帮助任何寻求针对最新 Apache 客户端实现的人：

```
StringEntity requestEntity = new StringEntity(
    JSON_STRING,
    ContentType.APPLICATION_JSON);

HttpPost postMethod = new HttpPost("http://example.com/action");
postMethod.setEntity(requestEntity);

HttpResponse rawResponse = httpclient.execute(postMethod); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2018-10-25T01:39:49.153

对于**Apache HttpClient 4.5**或更新版本：

```
 CloseableHttpClient httpclient = HttpClients.createDefault();
    HttpPost httpPost = new HttpPost("http://targethost/login");
    String JSON_STRING="";
    HttpEntity stringEntity = new StringEntity(JSON_STRING,ContentType.APPLICATION_JSON);
    httpPost.setEntity(stringEntity);
    CloseableHttpResponse response2 = httpclient.execute(httpPost); 
```

**笔记：**

1 为了使代码编译，`httpclient`包和`httpcore`包都应该被导入。

2 try-catch 块已被省略。

**参考**： [appache官方指南](http://hc.apache.org/httpcomponents-client-ga/quickstart.html)

> Commons HttpClient 项目现已结束，不再开发。它已被其 HttpClient 和 HttpCore 模块中的 Apache HttpComponents 项目所取代

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-03-20T01:02:33.137

正如**janoside**的出色回答中所述，您需要构造 JSON 字符串并将其设置为`StringEntity`.

要构造 JSON 字符串，您可以使用任何您熟悉的库或方法。Jackson 库就是一个简单的例子：

```
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.ObjectNode;
import org.apache.http.entity.ContentType;
import org.apache.http.entity.StringEntity;

ObjectMapper mapper = new ObjectMapper();
ObjectNode node = mapper.createObjectNode();
node.put("name", "value"); // repeat as needed
String JSON_STRING = node.toString();
postMethod.setEntity(new StringEntity(JSON_STRING, ContentType.APPLICATION_JSON)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-29T02:33:36.780

我使用 JACKSON 库将对象转换为 JSON 并设置请求正文，如下所示。这是完整的示例。

```
try (CloseableHttpClient httpclient = HttpClients.createDefault()) {

    HttpPost httpPost = new HttpPost("https://jsonplaceholder.typicode.com/posts");

    Post post = new Post("foo", "bar", 1);
    ObjectWriter ow = new ObjectMapper().writer();
    String strJson = ow.writeValueAsString(post);
    System.out.println(strJson);

    StringEntity strEntity = new StringEntity(strJson, ContentType.APPLICATION_JSON);
    httpPost.setEntity(strEntity);
    httpPost.setHeader("Content-type", "application/json");

    try (CloseableHttpResponse response = httpclient.execute(httpPost)) {
        System.out.println(response.getCode() + " " + response.getReasonPhrase());

        HttpEntity entity = response.getEntity();
        String result = EntityUtils.toString(entity);
        System.out.println(result);

        EntityUtils.consume(entity);
    } catch (ParseException e) {
        e.printStackTrace();
    }

} catch (IOException e) {
    System.out.println(e.getMessage());
} 
```

# grails - 如何在 Config.groovy 的 Grails 中使用 NodeBuilder 分配嵌套结构？

> ID：12059279
> 
> 赞同：2
> 
> 时间：2012-08-21T16:31:37.147
> 
> 标签：grails, builder

我正在尝试使用 Config.groovy 中的构建器语法绘制网站的导航结构，如下所示：

```
com.foo.demo.siteStructure = NodeBuilder.newInstance().site() {
    item(controller: 'sample', action: 'list')
    item(controller: 'address', action: 'list') {
        item(controller: 'city', action: 'list', title: 'Municipality')
    }
} 
```

这在调试器中产生的对象是：

```
site[attributes={}; value=[item[attributes={controller=sample, action=list}; value=[]], item[attributes={controller=city, action=list, title=Municipality}; value=[]]]] 
```

所以它似乎只深入了一层，并用它包含的一项替换了第二项。

如果我预先定义一个 Item 对象并使用，我会得到相同的单层嵌套`ObjectGraphBuilder`：

```
class Item {
    String controller
    String action
    String title
    SiteNode parent
    List<Item> items = []
} 
```

因此，看起来 ConfigSlurper 以某种方式破坏了结果。有没有更好的方法将嵌套结构标记为配置值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T20:09:54.257

我确实设法通过调整资源插件读取配置的方式来实现这一点。我首先将配置值更改为常规闭包：

```
com.foo.demo.siteStructure = {
    root {
        item(controller: 'sample', action: 'list')
        item(controller: 'address', action: 'list') {
            item(controller: 'city', action: 'list', title: 'Municipality')
        }
    }
} 
```

然后在单例中对 dsl 进行实际处理（类似这样）：

```
Node root
def menus = grailsApplication.config.com.foo.demo.siteStructure
if (menus instanceof Closure) {
    def builder = new NodeBuilder()
    menus.delegate = builder
    menus.resolveStrategy = Closure.DELEGATE_FIRST
    root = menus()
} 
```

# apache - 简单的 .htaccess 重写问题

> ID：12059280
> 
> 赞同：0
> 
> 时间：2012-08-21T16:31:39.880
> 
> 标签：apache, .htaccess

我是 .htaccess 的新手，需要一个简单的重写。

如何更改以下内容：

从

mysite.com/西雅图

至

mysite.com/?city=西雅图

我现在幸运地尝试了以下方法：

```
RewriteEngine On
RewriteRule ^/(.+)$ ?city=$1 [L] 
```

此外，如果用户仍然可以看到 mysite.com/seattle，那将是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:33:32.077

以下对我有用：

```
RewriteEngine On
RewriteRule ^(.+)$ index.php?city=$1 [QSA,L] 
```

请注意，目标文件名（`index.php`在这种情况下）是必需的，否则您将收到 500 错误。另请注意，我添加`QSA`以便正确附加查询字符串。

# javascript - 获取两个圆括号之间的文本

> ID：12059284
> 
> 赞同：59
> 
> 时间：2012-08-21T16:31:54.433
> 
> 标签：javascript, regex

如何`my`使用 JavaScript 中的正则表达式从以下句子中的两个圆括号之间检索单词？

> “这是（我的）简单文本”

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-08-21T16:34:49.190

```
console.log(
  "This is (my) simple text".match(/\(([^)]+)\)/)[1]
);
```

`\(`作为左大括号，`(`- 子表达式的开始，`[^)]+`- 除了右括号一次或多次（您可能希望替换`+`为`*`），`)`- 子表达式的结尾，`\)`- 右大括号。返回一个从中提取第二个元素的`match()`数组。`["(my)","my"]`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-21T16:35:35.010

```
var txt = "This is (my) simple text";
re = /\((.*)\)/;
console.log(txt.match(re)[1]);​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/TSuXq/)**

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-08-21T16:41:22.713

您也可以尝试非正则表达式的方法（当然如果有多个这样的括号，它最终将需要循环，或正则表达式）

```
init = txt.indexOf('(');
fin = txt.indexOf(')');
console.log(txt.substr(init+1,fin-init-1)) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-25T09:12:06.210

对于希望在多个括号中返回多个文本的任何人

```
var testString = "(Charles) de (Gaulle), (Paris) [CDG]"
var reBrackets = /\((.*?)\)/g;
var listOfText = [];
var found;
while(found = reBrackets.exec(testString)) {
  listOfText.push(found[1]);
}; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-05-09T22:53:54.110

使用它来获取最接近`(`和之间的文本`)`：

```
const string = "This is (my) (simple (text)"
console.log( string.match(/\(([^()]*)\)/)[1] )
console.log( string.match(/\(([^()]*)\)/g).map(function($0) { return $0.substring(1,$0.length-1) }) )
```

**结果**：`my`和`["my","text"]`。

**解释**

```
--------------------------------------------------------------------------------
  \(                       '('
--------------------------------------------------------------------------------
  (                        group and capture to \1:
--------------------------------------------------------------------------------
    [^()]*                   any character except: '(', ')' (0 or
                             more times (matching the most amount
                             possible))
--------------------------------------------------------------------------------
  )                        end of \1
--------------------------------------------------------------------------------
  \)                       ')' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-15T14:55:47.113

从字符串公式中获取字段。

```
var txt = "{{abctext/lsi)}} = {{abctext/lsi}} + {{adddddd}} / {{ttttttt}}";
re = /\{{(.*?)\}}/g;
console.log(txt.match(re)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-30T12:02:21.157

返回圆括号内的多个项目

```
 var res2=str.split(/(|)/);

  var items=res2.filter((ele,i)=>{
  if(i%2!==0) {
  return ele;
  }
}); 
```

# javascript - 检查用户名是否已经存在

> ID：12059285
> 
> 赞同：-6
> 
> 时间：2012-08-21T16:31:56.303
> 
> 标签：javascript, jquery, asp.net, ajax

我想在用户将用户名插入文本框或文本框失去焦点之后验证用户名是否已经存在。

jQuery 还是 Ajax？
请问有人有这样的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:34:15.417

在文本框的 onblur 事件中，获取文本框的值并使用 jQuery ajax，调用您检查它的服务器页面并返回适当的结果。根据结果​​向用户显示消息（可用或不可用）

在您的页面中包含 jQuery 并拥有此脚本

```
$(function(){
  $("#txtUserName").blur(function() {
     var userName=$(this).val();
     if(userName!="")
     {
       $.get("checkusername.aspx?username="+userName+"&t="+$.now(),function(data){
           if(data=="1")
           {
             $("#msgDiv").html("Not Available");             
           } 
           else
           {
             $("#msgDiv").html("Available :) ");
           } 

       });    
     }    
  });   

}); 
```

假设`checkusername.aspx`页面将读取查询字符串值并检查数据库并返回（Response.Write（））“1”或“0”

我更喜欢使用通用处理程序（.ASHX 文件）来进行服务器端检查，而不是使用 aspx 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:34:25.260

两个都。

使用 jQuery 对文本框的[onblur 事件](http://api.jquery.com/blur/)做出反应。然后，使用 jQuery 对控制器进行[ajax 调用](http://api.jquery.com/jQuery.ajax/)，以查看用户名是否已被占用。

```
$('#usernameTextBox').blur(function() {
  alert('Make your ajax call here.');
}); 
```

# mongodb - 在 Mongoose 中使用更改的嵌入式文档更新项目时，这些嵌入式文档不会更新

> ID：12059296
> 
> 赞同：1
> 
> 时间：2012-08-21T16:33:00.277
> 
> 标签：mongodb, mongoose

我正在使用 Mongoose 执行以下操作：

```
that.model.update({_id: dao._id}, dao,  { upsert: true }, cb); 
```

`dao`包含（除其他外）几个嵌入式文档的猫鼬表示在哪里。作为测试，在调用上面的更新方法之前，我从数组中删除了几个嵌入式文档。

结果是对嵌入式文档数组的更改没有保留。

有什么我忽略的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:02:02.723

很难确定没有看到更多代码，但如果`dao`是 Mongoose 模型实例，您应该`dao.save(cb);`改为调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T13:36:10.243

我通过执行以下问题中提出的类似操作解决了该问题：[https ://github.com/LearnBoost/mongoose/issues/571](https://github.com/LearnBoost/mongoose/issues/571)

为了完整起见，一些导致问题的背景。

我正在使用在应用程序启动时填充的 DDD 存储库。在后台，这会获取 Mongoose 对象（在我的情况下被视为 DAO）并被转换为缓存在存储库中的域对象。我需要域对象和猫鼬对象之间的这种分离，不要问。

这意味着`getById`，`getAll`以及 repo 的所有其他公共接口都可以使用域对象而不是 mongoose 对象。

`add`当做类似或在 repo 上的事情`update`时，这只会在内部更新 in-mem 缓存（同样，它只使用 domainobjects 而不是 mongoose-objects）

只有在`commit`repo 上进行操作时，可能更改的域对象集合才会被持久化。这是通过创建新的猫鼬对象而不是获取现有的猫鼬对象并更新它们来完成的。

这就是为什么我不能使用的`dao.save()`原因，因为当我保存一个不同的（刚刚​​创建的）猫鼬对象而具有相同 ID 的猫鼬对象可能已经存在于 Mongo 中时，它会引发重复 ID 错误。

来自说明解决方案的代码的一些相关片段：

> var dao = that.createDAO(domainobject);
> 
> ```
>  //https://github.com/LearnBoost/mongoose/issues/571
>       // Convert the Model instance to a simple object using Model's 'toObject' function
>       // to prevent weirdness like infinite looping...
>       var upsertData = dao.toObject();
> 
>       // Delete the _id property, otherwise Mongo will return a "Mod on _id not allowed" error
>       delete upsertData._id;
> 
>       that.model.update({_id: dao._id}, upsertData,  { upsert: true }, cb); 
> ```

# apache - 从 v1.4.1.1 升级到 v1.7 后无限重定向循环

> ID：12059299
> 
> 赞同：0
> 
> 时间：2012-08-21T16:33:20.627
> 
> 标签：apache, .htaccess, magento, mod-rewrite, redirect

从 v1.4.1.1 升级到 v1.7 后，我遇到了一个 magento 站点问题，导致无限重定向循环。我遵循了 magento 网站[http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/upgrading_magento上提供的指南](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/upgrading_magento)

升级过程中出现了几个错误，但常见错误和人们找到了简单的解决方案 magento 站点文件和数据库现在已完全升级到最新版本，但在最后一个障碍中，它通过前端和后端完全无法访问，因为到一个无限的重定向循环，似乎没有人对如何修复它有一个具体的答案。

我已经清除了所有 magentos 缓存/会话，一切都具有正确的权限（或者升级不会发生）我使用 apache v2.2 PHP 5.3.6 和 MySQL 5.5.9，这超出了 magento 有问题的 apache 1.3 + CGI 环境，所以我猜这可能与 .htaccess 有关，我在下面发布了我的 .htaccess 希望有人会发现一些东西 mod_rewrite 和 htaccess 并不是我的强项。

```
############################################
## uncomment these lines for CGI mode
## make sure to specify the correct cgi php binary file name
## it might be /cgi-bin/php-cgi

#    Action php5-cgi /cgi-bin/php5-cgi
#    AddHandler php5-cgi .php

############################################
## GoDaddy specific options

#   Options -MultiViews

## you might also need to add this line to php.ini
##     cgi.fix_pathinfo = 1
## if it still doesn't work, rename php.ini to php5.ini

############################################
## this line is specific for 1and1 hosting

    #AddType x-mapp-php5 .php
    #AddHandler x-mapp-php5 .php

############################################
## default index file

    DirectoryIndex index.php

<IfModule mod_php5.c>
php_flag magic_quotes_gpc off 
php_flag short_open_tag on 

############################################
## adjust memory limit

#    php_value memory_limit 256m
    php_value memory_limit 512m
    php_value max_execution_time 36000

############################################
## disable magic quotes for php request vars

    php_flag magic_quotes_gpc off

############################################
## disable automatic session start
## before autoload was initialized

    php_flag session.auto_start off

############################################
## enable resulting html compression

    #php_flag zlib.output_compression on

###########################################
# disable user agent verification to not break multiple image upload

    php_flag suhosin.session.cryptua off

###########################################
# turn off compatibility with PHP4 when dealing with objects

    php_flag zend.ze1_compatibility_mode Off

</IfModule>

<IfModule mod_security.c>
###########################################
# disable POST processing to not break multiple image upload

    SecFilterEngine Off
    SecFilterScanPOST Off
</IfModule>

<IfModule mod_deflate.c>

############################################
## enable apache served files compression
## http://developer.yahoo.com/performance/rules.html#gzip

    # Insert filter on all content
    ###SetOutputFilter DEFLATE
    # Insert filter on selected content types only
    #AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript

    # Netscape 4.x has some problems...
    #BrowserMatch ^Mozilla/4 gzip-only-text/html

    # Netscape 4.06-4.08 have some more problems
    #BrowserMatch ^Mozilla/4\.0[678] no-gzip

    # MSIE masquerades as Netscape, but it is fine
    #BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

    # Don't compress images
    #SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png)$ no-gzip dont-vary

    # Make sure proxies don't deliver the wrong content
    #Header append Vary User-Agent env=!dont-vary

</IfModule>

<IfModule mod_ssl.c>

############################################
## make HTTPS env vars available for CGI mode

    SSLOptions StdEnvVars

</IfModule>

<IfModule mod_rewrite.c>

############################################
## enable rewrites

    Options +FollowSymLinks
    RewriteEngine on

############################################
## you can put here your magento root folder
## path relative to web root

    #RewriteBase /magento/

############################################
## uncomment next line to enable light API calls processing

#    RewriteRule ^api/([a-z][0-9a-z_]+)/?$ api.php?type=$1 [QSA,L]

############################################
## rewrite API2 calls to api.php (by now it is REST only)

    RewriteRule ^api/rest api.php?type=rest [QSA,L]

############################################
## workaround for HTTP authorization
## in CGI environment

    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

############################################
## TRACE and TRACK HTTP methods disabled to prevent XSS attacks

    RewriteCond %{REQUEST_METHOD} ^TRAC[EK]
    RewriteRule .* - [L,R=405]

############################################
## redirect for mobile user agents

    #RewriteCond %{REQUEST_URI} !^/mobiledirectoryhere/.*$
    #RewriteCond %{HTTP_USER_AGENT} "android|blackberry|ipad|iphone|ipod|iemobile|opera mobile|palmos|webos|googlebot-mobile" [NC]
    #RewriteRule ^(.*)$ /mobiledirectoryhere/ [L,R=302]

############################################
## always send 404 on missing files in these folders

    RewriteCond %{REQUEST_URI} !^/(media|skin|js)/

############################################
## never rewrite for existing files, directories and links

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l

############################################
## rewrite everything else to index.php

    RewriteRule .* index.php [L]

</IfModule>

############################################
## Prevent character encoding issues from server overrides
## If you still have problems, use the second line instead

    AddDefaultCharset Off
    #AddDefaultCharset UTF-8

<IfModule mod_expires.c>

############################################
## Add default Expires header
## http://developer.yahoo.com/performance/rules.html#expires

    ExpiresDefault "access plus 1 year"

</IfModule>

############################################
## By default allow all access

    Order allow,deny
    Allow from all

###########################################
## Deny access to release notes to prevent disclosure of the installed Magento version

    <Files RELEASE_NOTES.txt>
        order allow,deny
        deny from all
    </Files>

############################################
## If running in cluster environment, uncomment this
## http://developer.yahoo.com/performance/rules.html#etags

    #FileETag none 
```

或在pastebin [http://pastebin.com/UDuL5pcd中查看](http://pastebin.com/UDuL5pcd)

抱歉应该说它一直在尝试重定向到 www.mydomain.com/index.php/install

即使没有名为 install 的目录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:46:43.457

`app/etc/`您应该在具有适当凭据的目录中拥有 local.xml 。

如果你有它，那么你将不再看到这个安装页面。

# c# - 一定时间后关闭程序的最佳方法

> ID：12059304
> 
> 赞同：1
> 
> 时间：2012-08-21T16:33:40.920
> 
> 标签：c#, application-shutdown

我正在使用一个控制台应用程序，它扫描多个图像目录并重新调整大小，然后在图像超过一定大小时保存图像。一旦目录完成处理，日志就会被推送到 Web 服务页面。

此实用程序将在晚上运行给定的小时数，但必须在第二天正常办公时间之前关闭，无论它是否完成了当前文件夹的处理。

我知道关闭程序的 3 个选项：

1.  通过**计划任务**设置“X 小时后关闭”：我对此选项的担忧是它可能会在进程中间关闭程序，例如在保存图像和登录到服务器之间。
2.  处理完每个图像后，**检查`DateTime`**是否在一定时间后关闭它
3.  **用户 a`Timer`**，将刻度设置为几个小时，一旦调用刻度处理程序，然后将布尔标志设置为 false。处理完每个图像后，检查布尔标志，看看是否该关闭程序了。

与比较 DateTime 相比，计时器选项是否具有性能优势？

有没有更好的方法？也许我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:37:41.623

检查`DateTime`处理之间的处理似乎是这里最好的方法。

即使您使用 a `Timer`，您可能仍希望检查计时器事件触发的当前时间，以确保该退出。仅根据截止时间检查时间似乎是最简单的选择。

# c# - 中继器控制中的解密？

> ID：12059305
> 
> 赞同：1
> 
> 时间：2012-08-21T16:33:49.430
> 
> 标签：c#, asp.net

我有一个中继器控件，它绑定到我的数据库中的一个表。其中一个数据列是加密的，因此它返回一个字节数组。我有一个解密函数，我运行它以获得适当的值。如何使用此函数在转发器控件绑定中显示正确的值？

编辑：

为了更清楚地说明，我想要（可能的）等价物：

```
Text='<%# _encryptor.Decrypt(Container.DataItem.SSN) %>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T18:51:15.853

如果您有大量数据，我会自己坚持使用 Container.DataItem 以避免反射开销。看起来你很接近。

```
Text='<%# _encryptor.Decrypt( Container.DataItem("SSN") ) %>' 
```

编辑：您可能还需要在此处进行显式转换

```
Text='<%# _encryptor.Decrypt( (MyObject)Container.DataItem("SSN") ) %>' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:04:05.743

你的方法看起来很接近。只需确保`EVAL()`在解密之前使用该值即可。

```
Text='<%# _encryptor.Decrypt(Eval("SSN").ToString) %>' 
```

# spring - 多个应用程序上下文，多个调度程序 servlet？

> ID：12059307
> 
> 赞同：25
> 
> 时间：2012-08-21T16:33:56.647
> 
> 标签：spring, spring-mvc, servlets

到目前为止，我曾经认为一个 Web 应用程序只能有一个`dispatcher-servlet`我们在`web.xml`

*   我这样想对吗？
*   我可以在单个 Web 应用程序中拥有多个调度程序 servlet 吗？如果是，如何？
*   在什么情况下我们可能需要这个？
*   整个 Web 应用程序中可以只有一个应用程序上下文吗？
*   我们如何定义多个应用程序上下文？
*   可以`dispatcher-servlet`存在于非弹簧应用程序中吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-21T16:56:28.913

> 您可以在单个 Web 应用程序中拥有多个调度程序 servlet 吗？

当然，引用[官方文档](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/web/servlet/DispatcherServlet.html)（**粗体**其实也有！）

> **Web 应用程序可以定义任意数量的 DispatcherServlets**。每个 servlet 将在其自己的命名空间中运行，使用映射、处理程序等加载自己的应用程序上下文。只有由 ContextLoaderListener 加载的根应用程序上下文（如果有）将被共享。

* * *

> 如何？

只需声明几个名称不同但使用`org.springframework.web.servlet.DispatcherServlet`类的 servlet。还要确保`yourServletName-servlet.xml`文件可用。

* * *

> 在什么情况下我们可能需要这个？

`DispatcherServlet`非常灵活。不仅 Spring MVC 使用，还有 Spring WS、Spring 对[hessian](/questions/tagged/hessian "显示标记为“hessian”的问题")的支持等。

* * *

> 此外，整个 Web 应用程序中是否只有一个应用程序上下文？

已经回答，也在引用的文档中：每个应用程序上下文`DispatcherServlet`+ 一个主要 Web 应用程序上下文。

* * *

> 我们如何定义多个应用程序上下文？

见上文，只需创建多个`DispatcherServlet`s。

* * *

> 调度程序 servlet 可以存在于非 Spring 应用程序中吗？

`DispatcherServlet`本身就是一个 Spring 上下文（Spring 应用程序），因此：不。可以在`DispatcherServlet`没有父（主）应用程序上下文的应用程序中声明，因此：是的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-29T22:38:41.697

> 在什么情况下我们可能需要这个？

^([或])
多个调度程序 servlet 的优点^([或])
为什么我们需要多个调度程序 servlet？

*简单的答案是以多种形式拥有[DispatcherServlet 的功能](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/DispatcherServlet.html)*

## Dispatcher servlet 功能

* * *

*   Dispatcher Servlet 使用[HandlerMapping](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/HandlerMapping.html)实现来控制请求到处理程序对象的路由。默认为[BeanNameUrlHandlerMapping](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/handler/BeanNameUrlHandlerMapping.html)和[RequestMappingHandlerMapping](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/RequestMappingHandlerMapping.html)。
*   它的视图解析策略可以通过[ViewResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/ViewResolver.html)实现指定，将符号视图名称解析为 View 对象。默认为[InternalResourceViewResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/view/InternalResourceViewResolver.html)。
*   它的异常解决策略可以通过[HandlerExceptionResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/HandlerExceptionResolver.html)指定，例如将某些异常映射到错误页面。
*   解决多部分请求的策略由[MultipartResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/multipart/MultipartResolver.html)实现确定。
*   它的语言环境解析策略由[LocaleResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/LocaleResolver.html)确定。
*   它的主题解析策略由[ThemeResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/ThemeResolver.html)决定。

* * *

我将尝试解释一些由`DispatcherServlet`

**声明多个分派器 servlet**
考虑我们有两个分派器 servlet(DS)，其中 DS1、DS2 配置有不同的 url 模式( `**.simple, **.beanName`)，它们使用不同的分派器 servlet 配置，如下所示。

```
DispatcherServlet     - simpleUrlHandlerDispatcherServlet
contextConfigLocation - /WEB-INF/simpleUrlHandlerMapping.xml
<url-pattern>*.simple</url-pattern>

DispatcherServlet     - beanNameUrlHandlerDispatcherServlet
contextConfigLocation - /WEB-INF/beanNameUrlHandlerMapping.xml
<url-pattern>*.beanName</url-pattern> 
```

**^([优势一：])我们可以为不同的 URL 设置不同的 HandlerMapping**

*DS1 bean 名称 url 处理程序映射配置*

```
<bean name="/hello.beanName" class="com.pvn.mvc.HelloController" />
<bean name="/hi.beanName" class="com.pvn.mvc.HiController" /> 
```

*DS2 简单 url 处理程序映射配置*

```
<bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="mappings">
        <props>
            <prop key="/hello.simple">simpleHello</prop>
            <prop key="/hi.simple">simpleHi</prop>
        </props>
    </property>
</bean> 
```

**^([优势 2：])我们可以为不同的 URL 集使用不同的视图解析器。**

**DS1 的**InternalResourceViewResolver**
，它只处理`prefix + returned String + suffix`.
**[TilesViewResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/view/tiles3/TilesViewResolver.html)** for DS2
它的实现由 apache tile 提供，这是一个基于布局/骨架的插件高级功能，如下所示。 或者，如果我们为不同的 URL匿名用户
[![在此处输入图像描述](../Images/687781c2497df22e478869050c9d7a78.png)](https://i.stack.imgur.com/bA0Cv.png) 集使用不同布局的 TilesViewResolver - 登录用户的不同布局 - 不同的布局** 

 ****^([优势 3：])我们可以为不同的 URL 集使用不同的主题解析器。**
这些解析器持续监控 cookie/会话以解析主题并提供样式表/主题合格（如下图所示）。下面仅给出[CookieThemeResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/theme/CookieThemeResolver.html)。
注意：这不是关于主题配置，而是关于主题解析器配置。

[![在此处输入图像描述](../Images/40a79f9a6237cd630d0b408920998a35.png)](https://i.stack.imgur.com/g8rdM.png)

**^([优势 4：])我们可以为不同的 URL 集使用不同的语言环境解析器。**
这些解析器持续监控 cookie/session/accept-header 以解析区域设置并加载合格的应用程序消息（如下图所示）。下面仅给出[CookieLocaleResolver](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/servlet/i18n/CookieLocaleResolver.html)。
注意：这不是关于语言环境配置，而是关于语言环境解析器配置。
[![在此处输入图像描述](../Images/26bea5b05e0bee96477fc2d78c415383.png)](https://i.stack.imgur.com/7mpYw.png)**

# c# - 我无法将浏览器控件中的文本设置为我需要的内容

> ID：12059322
> 
> 赞同：0
> 
> 时间：2012-08-21T16:34:49.600
> 
> 标签：c#, dom, webbrowser-control, domdocument

```
 System.Windows.Forms.HtmlDocument document = this.webBrowser1.Document;
            HtmlElementCollection hec = this.webBrowser1.Document.GetElementsByTagName("input");
            foreach (HtmlElement el in hec)
            {
                if (el.GetAttribute("name").Equals("_MYPW"))
                {
                    var form = this.webBrowser1.Document.Forms[0]; //form element 
                    var input = form.Children[0]; //input element 
                    input.SetAttribute("_MYPW", "type some text"); //set the input value 
                }
            } 
```

我想为

```
<input name="_MYPW" type=password> 
```

我怎样才能做到这一点？上面的代码不能正常工作。它不输入任何文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:36:23.060

您正在设置`_MYPW`属性。

您可能想要设置`value`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:08:10.790

```
if (el.GetAttribute("name").Equals("_MYPW"))
{                        
    el.SetAttribute("value", "some text");
    clickNextButton(hec);
} 
```

这键入文本

# django - 用于 python/geos 的 heroku buildpack

> ID：12059324
> 
> 赞同：2
> 
> 时间：2012-08-21T16:34:59.097
> 
> 标签：django, heroku, django-haystack, geos, buildpack

我在 heroku 上运行我的 django 应用程序。我想使用他们的 websolr 插件通过 django haystack 向应用程序添加空间搜索。

django haystack 中的空间搜索依赖于 GEOS C 库，默认情况下未部署在 heroku 上。

因此，为了使用空间搜索，我按照[https://devcenter.heroku.com/articles/buildpack-binaries](https://devcenter.heroku.com/articles/buildpack-binaries)创建了 GEOS 的二进制包。

为了部署二进制文件，我[为 python 分叉了 heroku buildback](https://github.com/dtornow/heroku-buildpack-python.git)并修改了 bin/compile 以包括：

```
AWESOME_VM_BINARY="http://vulcan-dtornow.herokuapp.com/output/05391114-f314-4aa7-9aab-bc09025d4898"

mkdir -p /app/.heroku/vendor/geos
curl $AWESOME_VM_BINARY -o - | tar -xz -C /app/.heroku/vendor/geos -f - 
```

我将自定义构建包添加到我的应用程序中，重新部署但我仍然无法访问该库。当我运行 ls 时，geos 文件夹不显示

```
heroku run ls /app/.heroku/vendor 
```

知道我缺少什么吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-14T09:04:18.457

另一种选择是使用仅包含地理空间库的 buildpack 并将其与 python buildpack 结合使用。这是一个更干净的分离：

[https://github.com/cyberdelia/heroku-geo-buildpack/](https://github.com/cyberdelia/heroku-geo-buildpack/)

结合

[https://github.com/heroku/heroku-buildpack-multi](https://github.com/heroku/heroku-buildpack-multi)

要使用它`.buildpacks`，请向您的存储库添加一个看起来像这样的文件

```
https://github.com/cyberdelia/heroku-geo-buildpack.git
https://github.com/heroku/heroku-buildpack-python.git 
```

（multi buildpack 的使用也在 multi buildpack repo 中进行了说明）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T19:11:28.660

您应该能够使用已在[此处创建的 GeoDjango buildpack](https://github.com/cirlabs/heroku-buildpack-geodjango/)

# ruby-on-rails - 与 nginx+Passenger 分开运行 Thin Faye 实例

> ID：12059325
> 
> 赞同：1
> 
> 时间：2012-08-21T16:35:10.220
> 
> 标签：ruby-on-rails, nginx, thin, faye

我有几个由 Passenger+nginx 1.2 运行的 Rails 应用程序。

我需要向其中一个添加一些 Comet 功能，但我不想添加任何功能`tcp_module`并重建 nginx，我只需要在我的应用程序[http://faye.myapp.com:9292](http://faye.myapp.com:9292)的子域上运行单独的 Faye+Thin 实例（在同一台 Ubuntu 机器上）和直接监听客户端。

这个问题有优雅的解决方案吗？

# ruby-on-rails-3 - Queue_Classic：如何在没有 Procfile 的 Heroku 上自动运行 rake 任务

> ID：12059326
> 
> 赞同：0
> 
> 时间：2012-08-21T16:35:22.623
> 
> 标签：ruby-on-rails-3, heroku, queue

我需要知道如何在 Heroku 上自动运行 queue_classic (rake qc:work) rake 任务。我尝试使用 Procfile，但我使用的是 Bamboo，但出现下一个错误：“Heroku 推送被拒绝，Bamboo 堆栈不支持 Procfile”

任何想法？？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T12:35:55.440

在 heroku 上有一个插件，即 heroku-scheduler，它是免费的。将此插件添加到您的应用程序中。它将出现在您的应用程序插件列表中，单击它，您将进入工作人员仪表板，您可以在其中添加工作，例如

```
bundle exec rake task_name
```

并安排任务。

# sql - 如何执行引用表变量的 SQL 字符串？

> ID：12059327
> 
> 赞同：18
> 
> 时间：2012-08-21T16:35:25.633
> 
> 标签：sql, sql-server

我在 SQL Server 2008 中有一个表变量

```
 DECLARE @specsAndModel TABLE
    (
        specName VARCHAR(50)
        ,specVal VARCHAR(50)
    )
    INSERT INTO @specsAndModel
    VALUES('[modelNumber]', 'F00-B4R') 
```

然后，我稍后构建了一个名为 的字符串`@query`，我最终尝试将其传递给`EXECUTE`，如下例所示：

```
 DECLARE @query NVARCHAR(MAX);
    SET @query = 'SELECT specName, specVal FROM @specsAndModel'
    EXECUTE(@query) 
```

但是，SQL Server 给了我错误消息：`Must declare the table variable "@specsAndModel".`

搜索后，我认为这可能与[执行上下文](http://msdn.microsoft.com/en-us/library/ms187096(SQL.105).aspx)有关，但我一直无法解决问题。

我甚至可以在调用执行函数时使用表变量吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-21T16:48:49.117

您正在创建的表是一个表变量，在其初始范围之外不可用。有几种方法可以解决此问题：

创建一个全局临时表*（免责声明：如果多个用户同时尝试运行它，这可能会导致问题。）*：

```
create table  ##specsAndModel 
(
    specName VARCHAR(50)
    ,specVal VARCHAR(50)
)
INSERT INTO ##specsAndModel
VALUES('[modelNumber]', 'F00-B4R')

DECLARE @query NVARCHAR(MAX);
SET @query = 'SELECT specName, specVal FROM ##specsAndModel'
EXECUTE(@query) 
```

创建一个本地临时表而不是全局：

```
create table  #specsAndModel 
(
    specName VARCHAR(50)
    ,specVal VARCHAR(50)
)
INSERT INTO #specsAndModel
VALUES('[modelNumber]', 'F00-B4R')

DECLARE @query NVARCHAR(MAX);
SET @query = 'SELECT specName, specVal FROM #specsAndModel'
EXECUTE(@query) 
```

在动态 SQL 中执行创建表（丑陋）：

```
DECLARE @query NVARCHAR(MAX);
SET @query = 'DECLARE @specsAndModel TABLE
(
    specName VARCHAR(50)
    ,specVal VARCHAR(50)
)
INSERT INTO @specsAndModel
VALUES(''[modelNumber]'', ''F00-B4R'')
SELECT specName, specVal FROM @specsAndModel'
exec(@query) 
```

与其使用临时表，不如创建一个实际表，然后在完成后将其删除 *（免责声明：如果多个用户同时尝试运行它，这可能会导致问题。）*：

```
create TABLE specsAndModel 
(
    specName VARCHAR(50)
    ,specVal VARCHAR(50)
)
INSERT INTO specsAndModel
VALUES('[modelNumber]', 'F00-B4R')

DECLARE @query NVARCHAR(MAX);
SET @query = 'SELECT specName, specVal FROM specsAndModel'
EXECUTE(@query)  

drop table specsAndModel 
```

这是有关临时表和表变量的讨论的链接：

[我应该使用#temp 表还是@table 变量？](http://databases.aspfaq.com/database/should-i-use-a-temp-table-or-a-table-variable.html)

编辑：您可以使用以下方法传入表变量`sp_executesql`：

```
create type specsAndModel as table (
    specName VARCHAR(50)
    ,specVal VARCHAR(50)
 )
go
declare @t specsAndModel
insert @t VALUES('[modelNumber]', 'F00-B4R')

exec sp_executesql N'select specName, specVal from @var', N'@var specsAndModel readonly', @t 
```

使用全局 ##temp 表和永久表都会存在风险，因为如果多个用户尝试运行该进程，则可能会发生冲突。

使用本地 #temp 表或使用`sp_executesql`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T16:49:46.747

您还必须在字符串中创建表变量。

```
DECLARE @query NVARCHAR(MAX);
SET @query = 'DECLARE @specsAndModel TABLE  ( specName VARCHAR(50) ,specVal VARCHAR(50))'
SET @Query = @Query + ' INSERT INTO  @specsAndModel VALUES(''modelNumber'',''abcd''); SELECT specName, specVal FROM @specsAndModel'
EXEC (@query) 
```

# android - Android ImageView：适合宽度

> ID：12059328
> 
> 赞同：84
> 
> 时间：2012-08-21T16:35:30.117
> 
> 标签：android, android-layout, android-imageview

我下载图像并使用`Imageview`. 我试过`ScaleType`, 来缩放图像。

如果图像高度大于宽度`ScaleTypes` `fitStart`，则不工作`fitEnd`。`fitCenter`Android 缩小照片并根据高度调整它，但我看到一些额外的空白空间作为宽度的一部分。

我想根据宽度缩小照片以使其适合宽度，我不在乎是否有一些额外的空白空间作为高度的一部分，或者如果高度太长，如果它不在视图中也没关系（如果可能的话？）。

`ScaleType.XY`缩放照片并将所有内容放入其中`ImageView`，并且不关心图像的高度/重量比。

```
<ImageView 
                android:id="@+id/background"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:adjustViewBounds="true"
                android:scaleType="fitStart"
            /> 
```

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2013-04-03T12:06:29.467

我最终使用了这段代码：

```
<ImageView 
                android:id="@+id/background"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:adjustViewBounds="true"
                android:scaleType="centerCrop"
                android:src="@drawable/name"
            /> 
```

确保使用`src`而不是设置图像`background`。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2014-09-08T15:01:35.240

`android:adjustViewBounds="true"`做这项工作！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-08-22T20:10:56.877

[在这里](https://stackoverflow.com/questions/4677269/how-to-stretch-three-images-across-the-screen-preserving-aspect-ratio/4688335#4688335)找到的这个优雅的解决方案对你来说就像一个魅力。

基本上，您只需要创建一个扩展的小类，`ImageView`并简单地覆盖该`onMeasure`方法即可根据需要调整宽度和高度。在这里，它通过使用以下方式缩放以适应宽度：

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    int width = MeasureSpec.getSize(widthMeasureSpec);
    int height = width * getDrawable().getIntrinsicHeight() / getDrawable().getIntrinsicWidth();
    setMeasuredDimension(width, height);
} 
```

你会像这样使用这个特殊`ImageView`的：

```
<your.activity.package.AspectRatioImageView 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="center_vertical"
    android:src="@drawable/test" /> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-05-06T11:32:29.387

如果您只是想填充屏幕的宽度并具有成比例的高度（并且知道图像的比例），那么有一个简单的方法，您可以在 OnCreate() 中执行此操作：

```
setContentView(R.layout.truppview_activity);
trupImage = (ImageView) findViewById(R.id.trupImage);

Display display = getWindowManager().getDefaultDisplay();
DisplayMetrics outMetrics = new DisplayMetrics();
display.getMetrics(outMetrics);
float scWidth = outMetrics.widthPixels;
trupImage.getLayoutParams().width = (int) scWidth;
trupImage.getLayoutParams().height = (int) (scWidth * 0.6f); 
```

其中 0.6 是比例调整（如果您知道图像的 w & h，当然也可以自动计算）。

PS：
这里是 XML 方面：

```
 <ImageView
        android:id="@+id/trupImage"
        android:layout_width="match_parent"
        android:background="@color/orange"
        android:layout_height="match_parent" 
        android:adjustViewBounds="true" 
        android:scaleType="fitCenter" /> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-10-30T18:57:58.547

如果你想让图像适合整个父块
，它将拉伸图像

```
 android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scaleType="fitXY" 
```

如果你想用图像的原始比例来拟合图像的整个父级，
它会裁剪掉图像的某些部分

```
 android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:adjustViewBounds="true"
        android:scaleType="centerCrop" 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-12-29T11:56:40.577

这对我有用。

创建一个类扩展 ImageView

```
 package com.yourdomain.utils;

    import android.content.Context;
    import android.graphics.drawable.Drawable;
    import android.util.AttributeSet;
    import android.widget.ImageView;

    public class ResizableImageView extends ImageView {

        public ResizableImageView(Context context, AttributeSet attrs) {
            super(context, attrs);
        }

        @Override 
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            Drawable d = getDrawable();

            if (d != null) {
                int width = MeasureSpec.getSize(widthMeasureSpec);
                int height = (int) Math.ceil((float) width * (float) d.getIntrinsicHeight() / (float) d.getIntrinsicWidth());
                setMeasuredDimension(width, height);
            } else {
                super.onMeasure(widthMeasureSpec, heightMeasureSpec);
            }
        }
    } 
```

在 xml 中使用以下而不是 ImageView

```
 <com.yourdomain.utils.ResizableImageView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:src="@drawable/test" /> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-21T16:56:21.537

我认为你不能只用 XML 来做，你需要调整自己的大小，位图

```
Display display = getWindowManager().getDefaultDisplay();
int width = display.getWidth();

        try {
            ((ImageView) findViewById(R.id.background))
                    .setImageBitmap(ShrinkBitmap(width));
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } 
```

然后

```
private Bitmap ShrinkBitmap(int width)
        throws FileNotFoundException {

    BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
    bmpFactoryOptions.inJustDecodeBounds = true;
    Bitmap bitmap = BitmapFactory.decodeResource(getResources(),
            R.drawable.img, bmpFactoryOptions);
    int widthRatio = (int) android.util.FloatMath
            .ceil(bmpFactoryOptions.outWidth / (float) width);

    bmpFactoryOptions.inSampleSize = widthRatio;

    if (bmpFactoryOptions.inSampleSize <= 0)
        bmpFactoryOptions.inSampleSize = 0;
    bmpFactoryOptions.inPreferredConfig = Bitmap.Config.ARGB_8888;
    bmpFactoryOptions.inJustDecodeBounds = false;
    bitmap = BitmapFactory.decodeResource(getResources(),
            R.drawable.img, bmpFactoryOptions);
    return bitmap;

} 
```

和布局

```
 <ImageView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/background"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
  /> 
```

# c# - 编辑图像的细节

> ID：12059333
> 
> 赞同：2
> 
> 时间：2012-08-21T16:36:03.083
> 
> 标签：c#, image, metadata

我正在处理新项目，我需要在 C# 中编辑图像的详细信息，例如标签、评论、作者等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:44:03.163

我从这里获取了这段代码：http: [//www.codeproject.com/Articles/43266/Reading-and-Writing-Photo-Metadata-Programmaticall](http://www.codeproject.com/Articles/43266/Reading-and-Writing-Photo-Metadata-Programmaticall)

微软有一套工具叫做 Pro Photo Tools，可以添加和引用到 VS。将 DLL 引用到您的项目，并使用与提供的代码类似的代码。

这是一种硬编码的方法，但应该很容易制作一个小表格来控制它。

```
try
{ 
  var img_path = @"@C:\[PATH TO YOUR IMAGE FILE].jpg";
  var p = (new MetadataPolicyManager()).loadPolicy(@"C:\[PATH TO POLICY FILE]" + 
       @"\Microsoft.PhotoToolboxFoundation.ToolboxPolicy.xml"); 

  imgProxy = new ImageFileProxy(img_path, p); 
  object desc = imgProxy.Data[p.getTagIndex("Description")];
  Console.WriteLine("Description: " + desc.ToString());

  imgProxy.Data[p.getTagIndex("Description")] = "Description modified!"; 
  imgProxy.commit(); 
} 
catch (Exception ex) 
{
  // write exception handler 
} 
```

# vim - 在 vimdiff 中更改分屏的大小

> ID：12059335
> 
> 赞同：33
> 
> 时间：2012-08-21T16:36:12.353
> 
> 标签：vim

我只知道处理 vimdiff 的两个命令：

`Ctrl-w Ctrl-w``Ctrl-w =`如果由于例如调整终端大小而变得不均匀，则切换窗口并使两个窗口的宽度相等。

例如，如何使左侧屏幕比右侧大得多？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-21T16:38:59.330

您可以使用 中的任何窗口命令`vimdiff`，例如`CTRL-w <`将左侧窗口缩小一列。这也可以与计数结合使用，例如`CTRL-W 5>`使右侧窗口 5 列更小。请参阅帮助页面`:help CTRL-w`以获取窗口命令列表。

此外，您可以使用鼠标通过单击两个窗口之间的边界并将其拖动到一个方向来更改窗口的大小。您可能必须通过先发出来启用鼠标支持`:set mouse=a`。

# sqlite - 使用 SqlCe 作为数据库并使用 Sqlite 进行单元测试

> ID：12059340
> 
> 赞同：1
> 
> 时间：2012-08-21T16:36:19.720
> 
> 标签：sqlite, unit-testing, sql-server-ce

目前我正在使用 SqlCe 作为我的项目的数据库并使用 Sqlite 进行单元测试，因为它很简单（例如允许使用 Inmemory）。我只是想知道，将来这可能会导致争议或奇怪吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T18:15:32.200

如果在单元测试中使用不同的持久性机制会导致问题，那么问题可能是由以下原因引起的：

1.  你的单元测试
2.  您的一般应用程序架构

您为对象编写的测试不应依赖于它们的依赖项的实现方式，这样做会自动意味着您的**单元**测试变成**集成**测试。

[你应该使用Persistence Ignorance](http://thinkddd.com/blog/2009/02/12/there-is-no-database/)的概念来设计你的对象，这意味着它们的实现方式使得它们的实现不依赖于底层数据源的实现方式。在企业应用程序内部实现 PI 的常用方法是使用[存储库模式](http://martinfowler.com/eaaCatalog/repository.html)。这抽象了您的对象用于从数据源本身的底层实现访问数据源的接口。这意味着，理论上，您可以为不同的数据源创建新的提供者，而无需更改依赖于它们的对象的实现。

**例如：**

假设您有一个名为的实体`Customer`，您将其保存在 SqlCe 数据库中。您可以创建一个名为的接口，该接口`ICustomerRepository`由`SqlCeCustomerRepository`您在主应用程序内部使用的 a 实现。这样，在您的单元测试中，`SqlLiteCustomerRepository`如果您发现这是一种创建模拟数据源的简单方法，您可以将其换成 a。为了让事情变得更简单，您可以创建一个在后台`InMemoryCustomerRepository`使用`List<T>`的对象来存储和检索您的对象。关键是如何实现数据源并不重要，只要它符合您在存储库接口上设置的合同。

这种模式的好处也超越了单元测试，并延伸到应用程序的一般维护中。假设您想扩展您的体系结构并使用 SQL Server 而不是 SQL CE，使用诸如存储库之类的抽象将有助于限制系统中为实现这一目标所需的更改量，从而减少开发时间，减少错误，和更快乐的客户。

# java - 如何从 LDAP 中检索属性“title”的所有不同值？

> ID：12059342
> 
> 赞同：1
> 
> 时间：2012-08-21T16:36:24.353
> 
> 标签：java, ldap

我正在尝试通过 Java 从 LDAP 获取字段的所有不同值。但我不知道该怎么做。

LDAP 中有一个名为“title”的属性。我想获得该字段的所有不同值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T10:15:03.973

没有 LDAP API 直接支持它，比如 SQL 中的 SELECT DISTINCT。您将必须检索所有值并过滤掉重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T14:50:49.667

要从 LDAP 目录服务器数据库中检索属性，LDAP 客户端必须连接到服务器，使用 BIND 请求建立身份验证状态，并将搜索请求传输到服务器，并解释响应。搜索请求至少包括：

*   一个基础对象，上面的搜索不返回条目
*   一个作用域，可以是基础对象本身（基础），从属于基础对象的一级，或者整个子树（从属于基础对象的所有对象
*   限制响应的过滤器
*   要从匹配搜索请求参数的条目中检索的属性列表。

要检索具有别名的所有属性，`title`请使用以下过滤器：`(title=*)`具有上述适当的基础对象和范围。LDAP 目录服务器将返回所有具有`title`属性的对象。如果`title`是多值的，对象可能包含多个`title`。LDAP 客户端负责对结果进行排序。没有`SELECT DISTINCT`设施。如果具有`title`属性的条目数量对于客户端来说太大，客户端可以使用简单分页结果请求控制来控制条目从 LDAP 目录服务器返回的速率。

不要将 JNDI (java.naming.*) 用于新代码。请改用[UnboundID LDAP SDK](https://www.unboundid.com/products/ldap-sdk/)。

### 也可以看看

*   [LDAP：编程实践](http://www.ldapguru.info/ldap/ldap-programming-practices.html)
*   [LDAP：ldapsearch](http://ff1959.wordpress.com/2011/07/27/mastering-ldapsearch/)
*   [示例代码](https://code.google.com/p/ldap-sample-code)

# jquery - RichFaces 4：渲染组件上的 jquery 效果

> ID：12059343
> 
> 赞同：0
> 
> 时间：2012-08-21T16:36:31.797
> 
> 标签：jquery, richfaces

有没有办法正确`fadeIn()`（或任何其他效果）新鲜`rendered`成分？

例如：

```
<h:panelGrid id="sampleGrid" columns="2" rendered="#{bean.showGrid}">
     ...
</h:panelGrid> 
```

呈现上述内容时，我尝试：

```
jQuery(#{rich:element('sampleGrid')}).hide().fadeIn('fast'); 
```

不打电话也能达到同样的效果`hide()`吗？

如果一个动作发生并且组件是`rendered="false"`. 那么如何处理一个`fadeOut()`效果呢？在这种情况下，元素不再是 DOM 树的一部分，那么是否有可能展示效果呢？

所以，总结一下：当组件的渲染状态发生变化时，哪种方式是让 jQuery 产生效果的正确方法？

# ios - UIAlertView 取消按钮使应用程序崩溃

> ID：12059344
> 
> 赞同：0
> 
> 时间：2012-08-21T16:36:39.410
> 
> 标签：ios, automatic-ref-counting, uialertview, nszombie

好的，所以我刚刚开始 iOS 开发。我将首先解释我的应用程序的流程：
1\. 加载了一个名为“appViewController”的视图。
2.`[self presentViewController: controller animated: YES completion:nil];`这会加载一个 webview
3\. 完成 webview 后，我将其关闭并以这种方式加载一个新的 UINavigation：

```
[self dismissViewControllerAnimated:YES completion:^{
        formViewController *fv = [ [formViewController alloc] init ];
        UINavigationController *navController = [[[UINavigationController alloc] initWithRootViewController:fv] autorelease];
        navController.navigationBar.hidden = YES;
        [presentingViewController presentModalViewController:navController animated:YES];

    }]; 
```

5.formViewController 有一个按钮，该按钮附加了事件，以便以这种方式显示警报

```
UIAlertView *av = [[UIAlertView alloc] initWithTitle:@"Oops!"
                                           message:@"test"
                                          delegate:nil
                                 cancelButtonTitle:@"OK"
                                 otherButtonTitles:nil];
[av show]; 
```

到目前为止，一切都按预期工作。现在，当我单击“确定”（取消）按钮时，应用程序崩溃，NSZombieEnabled 说
**-[appViewController _deepestDefaultFirstResponder]: message sent to deallocated instance 0x6e6a570 lldb**

这里发生了什么？为什么它试图再次向 appViewController 发送消息？[av show] 后没有代码

注意：我正在使用 ARC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:18:42.230

如果您使用 arc，则代码中的自动释放无效。

这似乎您的根视图控制器在某个时候被释放，并且当响应者链被遍历时，产生的悬空指针被访问。

为了验证这一点，我将在 appViewController 上实现 dealloc 方法并查看它是否被调用。

```
dealloc {
  NSLog(@"Problems ahead.");
} 
```

如果在您期望它发生之前调用了它（对于根视图控制器可能根本不会），您需要找出发生这种情况的原因。您可能在某处缺少强有力的参考。检查您的应用程序委托并确认您对窗口有强引用，并且您将控制器设置为根视图控制器（前提是您没有使用情节提要）。

Zombies 工具非常适合调试此类问题。它将列出有问题的对象的所有保留和释放。[这是一个简短的介绍](http://www.markj.net/iphone-memory-debug-nszombie/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:17:44.973

有几件事。

1.  您正在混合 presentViewController 和 presentModalViewController。如果您是 iOS 新手，您应该始终使用 presentViewController。无需习惯使用即将被弃用的方法（请参阅此问题的回答[PresentModalViewController 和 presentViewController 之间的区别？](https://stackoverflow.com/questions/8365263/difference-between-presentmodalviewcontroller-and-presentviewcontroller)

2.  一般来说，除非绝对必要，否则不应自动释放。因为当使用 presentViewController（和 presentModalViewController）呈现控制器时，它会被保留，您可以在之后轻松释放。我会这样重组：

> ```
> UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:fv];
> navController.navigationBar.hidden = YES;
> [presentingViewController presentModalViewController:navController animated:YES];
> [navController release]; 
> ```

3..您包含的代码部分位于何处？就像，你按下一个按钮，视图被关闭还是什么？

# javascript - 使用 tinymce 在 webkit 中未触发图像的 dragend 事件

> ID：12059346
> 
> 赞同：1
> 
> 时间：2012-08-21T16:36:47.037
> 
> 标签：javascript, jquery, webkit, tinymce

在tinymce编辑器中，如果我在这样的图像上绑定dragend事件

```
_imagePlugin.editor.dom.bind(_imagePlugin.editor.dom.select('img'), 'dragend', function(){console.log('aaaa');}); 
```

我没有在 chrome 或 safari 中获得控制台日志，但我在 Firefox 中获得了它们。尽管在所有三个中都触发了“拖动”事件。

最新的 chrome 和 firefox 版本，tinymce 是 3.4.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T09:24:12.760

在这种情况下，您可以从将在 dragend 事件之前触发的拖动事件中获取图像。您只需要添加一个拖动处理程序并保存该事件的目标，以便稍后在拖动处理程序中使用它。

# java - Java 中 Google OAuth 2 进程中的状态参数

> ID：12059347
> 
> 赞同：2
> 
> 时间：2012-08-21T16:36:59.283
> 
> 标签：java, oauth-2.0, google-apps, google-api-java-client

我需要有关如何使用 Java 客户端库将“状态”参数添加到对 Google OAuth 2 服务的授权请求的快速帮助。根据文档，据说 OAuth 提供者往返此参数以通过授权过程保持应用程序状态。我的应用程序需要它来确定哪个用户在做什么。我在网上搜索过，我遇到了很多垃圾。请帮帮我，我没时间了。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:10:18.660

使用类，`com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAuthorizationRequestUrl`设置和。然后调用该方法来构建请求字符串，然后附加到字符串（您要往返的数据在哪里）。`clientID``redirectURL``scope``build()``&state=stateData``stateData`

希望这对其他人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:28:57.997

有时（取决于您的实现）您有一个`AuthorizationRequestUrl`. 调用它的[`setState(String state)`](http://javadoc.google-oauth-java-client.googlecode.com/hg/1.10.1-beta/com/google/api/client/auth/oauth2/AuthorizationRequestUrl.html#setState%28java.lang.String%29)方法来设置`state`参数。

# actionscript-3 - 本地共享对象 localPath

> ID：12059349
> 
> 赞同：0
> 
> 时间：2012-08-21T16:37:09.500
> 
> 标签：actionscript-3, flash, shared-objects, local-shared-object

我正在创建一个 .swf 电影，它将在社区的访问者机器上存储一个本地共享对象。

基本上，.swf 电影是论坛社区插件的一部分。我的意思是我事先不知道 .swf 电影的完整路径。

即一个人可能有他的社区：

www.domain1.com/forum 或 www.domain2.com/forums 或 www.domain3.com/community

等等......无论如何，.swf 电影将位于 www.domainX.com/{some unknown folder}/{known1}/{known2}/movie.swf

我希望你能理解到目前为止的一切。

我的问题是使用什么参数作为 getLocal 方法的 localPath 来存储 LSO。

到目前为止我所做的是： SharedObject.getLocal("guid", "/");

在 #SharedObjects\X9X9X9X9\www.domain1.com 中创建一个 guid.sol 文件

如果我这样做： SharedObject.getLocal("guid"); （也就是说，完全省略了 localPath 参数，因此它将使用完整路径），它将在 #SharedObjects\X9X9X9X9\www.domain1.com\community\public\cache 中创建一个 guid.sol 文件

那么，在不知道社区将驻留的文件夹名称的情况下，如何在完整路径之前存储 LSO 两个文件夹？

如：#SharedObjects\X9X9X9X9\www.domain1.com\community 或 #SharedObjects\X9X9X9X9\www.domain1.com\forum 或 #SharedObjects\X9X9X9X9\www.domain1.com\whatever

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T15:07:38.513

好吧，我找到了这个...

```
urlArr = _root._url.split("/");
pathLso = urlArr[urlArr.length - 3]; //As I wanted the 3rd from the end chunk
lsoObj = SharedObject.getLocal("guid", pathLso); 
```

# javascript - 如何在没有 JavaScript 的情况下强制页面显示？

> ID：12059350
> 
> 赞同：0
> 
> 时间：2012-08-21T16:37:09.617
> 
> 标签：javascript, browser

除非您的浏览器启用了 JavaScript，否则主要网站（例如 Google 群组）现在拒绝显示任何内容。[w3m](http://en.wikipedia.org/wiki/W3m)和[Dillo](http://en.wikipedia.org/wiki/Dillo)等一些超轻量级浏览器不支持 JavaScript。

这些浏览器可以结合哪些策略来强制显示仅 JavaScript 的网站？

**编辑：**为了防止大量不相关的回复，我会指出我所要求的*是*可能的并且已经完成。[NetSurf](http://en.wikipedia.org/wiki/NetSurf)做得很好，而[Dillo](http://en.wikipedia.org/wiki/Dillo)做得很糟糕。

我正在寻求将此功能添加到超轻型浏览器的最佳方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:38:52.187

如果一个站点决定在不使用 javascript 的情况下不显示任何内容，那么没有 javascript 的浏览器将无法改变这一点。

如果内容在通过 javascript 检索和呈现之前根本不存在，那么非 javascript 浏览器就无法解决这个问题。

唯一的选择是请求网站的作者制作一个可以通过纯 HTML 运行且不依赖于 javascript 的网站版本，或者获得支持 javascript 的浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:40:42.900

选项 1：实现 JavaScript 支持

选项 2：根据具体情况，重新实现站点使用 JavaScript 实现的所有基本功能（并使其与更改保持同步）。

# record - NAudio - 如何仅从左声道或右声道录制？

> ID：12059352
> 
> 赞同：0
> 
> 时间：2012-08-21T16:37:20.787
> 
> 标签：record, naudio

我需要同时从两个源录制，一个连接到我麦克风的左声道，另一个连接到右声道。可以用 NAudio 做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:17:14.033

是的，但是您将同时从两个通道录制，因此样本将交错到达。假设您正在录制 16 位音频，您将从录制的缓冲区中取出两对两个字节，并将一对写入一个 WAV 文件，另一对写入另一个。

在此处查看[我的答案，](https://stackoverflow.com/questions/12075062/saving-each-wav-channel-as-a-mono-channel-wav-file-using-naudio/12149659#12149659)展示如何对现有的多通道 WAV 文件执行此操作。

# layout - 创建自定义亚马逊网上商店设计

> ID：12059353
> 
> 赞同：1
> 
> 时间：2012-08-21T16:37:21.653
> 
> 标签：layout, amazon, webstore

我正在尝试创建一个亚马逊网上商店，界面令人震惊。

我见过一些公司已经建立了非常不错的商店，但不知道他们是如何使用亚马逊给你的界面来实现这一点的，因为他们几乎不可能定制一件东西。

有人可以说明我需要做什么来为我的商店创建一个完全定制的设计吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:22:26.600

我在创建自定义布局方面很幸运……功能是我卡住的地方。似乎我们被迫使用他们的小部件等......虽然你可以很容易地改变它们的外观。

我通过使用 Google Chrome 的检查元素工具 (F12) 成功了。我能够找到驱动宽度、高度等不同小部件的 CSS。此外，我能够为搜索小部件编写自己的 CSS。

你的问题大约有 1.5 个月大......所以我想你现在可能已经学会了。

如果您有任何问题，我很乐意就我所知道的提供帮助。

# mysql - MySQL 计数已关闭

> ID：12059356
> 
> 赞同：0
> 
> 时间：2012-08-21T16:37:35.543
> 
> 标签：mysql, count

我不知道为什么我的数字彼此相差很大。

没有最大 id 的查询：

```
SELECT id, DATE_FORMAT(t_stamp, '%Y-%m-%d %H:00:00') as date, COUNT(*) as count
FROM test_ips
WHERE id > 0
AND viewip != ""
GROUP BY HOUR(t_stamp)
ORDER BY t_stamp ASC; 
```

我得到：

```
1     2012-07-18 19:00:00     1313
106     2012-07-18 20:00:00     1567
107     2012-07-19 09:00:00     847
225     2012-07-19 10:00:00     5095
421     2012-07-19 11:00:00     205
423     2012-07-19 12:00:00     900
461     2012-07-19 13:00:00     619
490     2012-07-20 15:00:00     729
575     2012-07-20 16:00:00     1682
1060     2012-07-20 17:00:00     2063
2260     2012-07-20 18:00:00     1417
5859     2012-07-20 21:00:00     1303
7060     2012-07-20 22:00:00     1340
8280     2012-07-20 23:00:00     1211
9149     2012-07-21 00:00:00     1675
10418     2012-07-21 01:00:00     721
11127     2012-07-21 02:00:00     825 
```

但是，如果我添加一个最大 ID：

```
AND id <= 8279 
```

我得到：

```
1     2012-07-18 19:00:00     1313
106     2012-07-18 20:00:00     1201
107     2012-07-19 09:00:00     118
225     2012-07-19 10:00:00     196
421     2012-07-19 11:00:00     2
423     2012-07-19 12:00:00     38
461     2012-07-19 13:00:00     20
490     2012-07-20 15:00:00     85
575     2012-07-20 16:00:00     483
1060     2012-07-20 17:00:00     1200
2260     2012-07-20 18:00:00     1200
5859     2012-07-20 21:00:00     1201
7060     2012-07-20 22:00:00     1220 
```

这些数字彼此相差甚远。有点傻。

编辑：这是我的表结构：

```
id  t_stamp             bID      viewip                 unique
1   2012-07-18 19:22:20     5    192.168.1.1        1
2   2012-07-18 19:22:21     1    192.168.1.1        1
3   2012-07-18 19:22:22     5    192.168.1.1        0
4   2012-07-18 19:22:22     3    192.168.1.1        1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:40:38.923

您没有按 ID 分组，我认为您打算这样做。

尝试：

```
SELECT id, DATE_FORMAT(t_stamp, '%Y-%m-%d %H:00:00') as date, COUNT(*) as count
FROM test_ips
WHERE id > 0
    AND viewip != ""
GROUP BY id, DATE_FORMAT(t_stamp, '%Y-%m-%d %H:00:00')
ORDER BY t_stamp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:08:37.017

您的查询不一致。

在您的选择语句中，您显示的是完整日期。

但是您按小时对数据进行分组。因此，您的计数语句正在计算一天中每个小时的所有数据。

以您的第一个结果为例：

`1 2012-07-18 19:00:00 1313`

1313 的计数包含小时为 19:00 的所有日期（7/18、7/19、7/20、7/21、7/22 等）的记录。

但是您设置查询的方式看起来应该是 2012-07-18 19:00:00 的所有记录的计数。

因此，当您添加 AND id <= 8279" 7/21 的日期和 7/20 的某些日期或不再计算在内时，您的计数值现在较低。

我猜你的意思是按日期和小时分组，而不仅仅是按小时分组。

# python - 试图将 numpy 数组（通过循环生成）写入 csv 格式

> ID：12059357
> 
> 赞同：0
> 
> 时间：2012-08-21T16:37:40.720
> 
> 标签：python, csv, numpy

我有一个在每次迭代中生成一维 numpy 数组的代码。我希望将数组附加到 CSV 文件的末尾，以便我可以从 Excel 中读取所有数据。我目前正在尝试以下方法：

```
for loop in range(0,10):
    # The following part generates the array 
    Array1 = numpy.array([4.3])  
    Array2 = numpy.array([10.2])
    Array3 = numpy.concatenate((Array1,Array2),axis=0)

    # The following part tries to generate a CSV writable array. But it fails :S
    if (loop == 0):
        ArrayMain = Array3
    else:
        # Trying to append the new array with the previous array
        ArrayMain = numpy.asarray(ArrayMain,Array3)  

# Trying to write the array into a .txt. file in .csv format
numpy.savetxt("ArrayMain.csv", ArrayMain, delimiter=",",fmt='%.3f') 
```

此代码给出错误。知道如何纠正它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:45:51.713

我认为您需要使用 append 函数将新数组附加到先前的数组中， asarray 函数将输入转换为数组。

```
 else:
        # Trying to append the new array with the previous array
        ArrayMain = numpy.append(ArrayMain,Array3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:44:35.167

你真的应该记住，`ndarrays`它并不是真的被设计成这样附加的。

如果您在循环之外立即编写 CSV 文件，则应考虑改用数组列表。

```
base = []
for i in range(10):
    base.append(...)
np.savetxt("ArrayMain.csv", base, ...) 
```

如果您附加的数组`base`具有相同的大小（`np.savext`将数组列表转换为数组本身），这将起作用。

或者，您可以先打开要写入的文件，然后`np.savetxt`在每次迭代时使用其句柄更新它。在这种情况下，不要忘记在最后关闭它......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:57:23.033

莫斯塔法是对的。numpy.asarray 不附加列表

```
numpy.asarray([1,2]) -> array([1,2]) 
```

即它实际上所做的是将列表转换为数组。您可以使用他定义的 append 函数。或者我个人的最爱

numpy.r_

用法：

```
numpy.r_[array([1,2]), array([3,4])] -> array([1,2,3,4])

also:

numpy.r_[array([1,2]), 3, [4,5], 6, array([7,8])] -> array([1, 2, 3, 4, 5, 6, 7, 8]) 
```

如您所见，它可用于一次性连接各种列表、数组和单个元素。

# c - 定位给定文件中的所有子字符串实例

> ID：12059362
> 
> 赞同：1
> 
> 时间：2012-08-21T16:37:52.700
> 
> 标签：c, string, substring

我目前正在开发一个函数来查找 html 文件中引用的所有图像，目前我正在尝试在文件中找到这些子字符串：`".bmp"` `".gif"` `".jpg"` `".png"`并且还想找到它们的根，例如：`/images/foo/`然后使用这两个子字符串来制作一个新的字符串：`/images/foo/bar.jpg`我知道我将如何连接字符串，但我不知道如何定位实际的子字符串，我现在感到非常不知所措，非常感谢一些帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:45:17.077

这个问题的“正确”答案应该敦促您使用为工作而构建的工具。聪明的人写东西是[`libxml`](http://xmlsoft.org/)有原因的。重新发明轮子只会让事情变得更加困难。`libxml`例如，您可以轻松地遍历 XML 树，如下所示：

```
for (cur_node = a_node; cur_node; cur_node = cur_node->next) {
    if (cur_node->type == XML_ELEMENT_NODE) {
        printf("node type: Element, name: %s\n", cur_node->name);
} 
```

“错误”的答案是想出一些“技巧”来查找图像字符串的开头，方法是查找图像标记 ( ) 的开头或Doug 在评论中提到`<img`的引用。`"`

你会注意到我在引文中指出了正确和错误。我是个纯粹主义者，强烈建议使用面向 XML 的解决方案，因为它完全可概括且易于扩展（明天您可能会说：哦，我还需要锚文本）。DOM 解析器可以轻松解决每个后续问题。

但是，如果您正在研究概念验证或原型（甚至可能是家庭作业），其中一切都格式良好并且您没有在野外发布您的代码，那么“错误”的方法可能就足够了。

# php - PHP 增量运算符

> ID：12059366
> 
> 赞同：2
> 
> 时间：2012-08-21T16:38:16.040
> 
> 标签：php, auto-increment, string-concatenation

```
<?php
 $s = "pa99";
 $s++;
 echo $s;
?> 
```

上面的代码输出到“pb00”我想要的是“pa100”等等。

但如果它的“pa”，我希望它转到“pb”，它与增量运算符配合得很好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-21T16:41:19.050

正如迈克尔所说，你正在尝试增加一个字符串 - 它不能那样工作（tm）。你想要做的是：

```
<?php
 $s = "pa"; //we're defining the string separately!
 $i = 99; //no quotes, this is a number
 $i++;
 echo $s.$i; //concatenate $i onto $s
?> 
```

没有按照您要求的方式自动增加字符串（aa、ab 等）的方法。您可以将每个字母转换为 1-26 之间的数字并递增它们，然后在溢出时递增前一个。不过，这有点乱。

要将整数与字符串分开，请尝试以下操作：

[PHP将字符串拆分为整数元素和字符串](https://stackoverflow.com/questions/4537994/php-split-string-into-integer-element-and-string)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-21T16:40:22.250

从文档：

> PHP 在处理字符变量而不是 C 的算术运算时遵循 Perl 的约定。例如，在 PHP 和 Perl 中 $a = 'Z'; $a++; 将 $a 变成 'AA'，而在 C 中 a = 'Z'; 一个++；将 a 转换为 '['（'Z' 的 ASCII 值是 90，'[' 的 ASCII 值是 91）。请注意，字符变量可以递增但不能递减，即使如此，也仅支持纯 ASCII 字符（az 和 AZ）。增加/减少其他字符变量没有效果，原字符串不变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:43:56.573

```
<?php

  $s_letter = substr($s,0,2);
  $s_number = substr($s,2,9);

  $s_letter++; $s_number++;

  $s_result = $s_letter.$s_number;

  echo $s_result;

?> 
```

# ember.js - {{each}} 中的 Ember.js {{action}}

> ID：12059367
> 
> 赞同：3
> 
> 时间：2012-08-21T16:38:17.287
> 
> 标签：ember.js

假设我有以下模板

```
{{#each item in controller}}
    <a {{action "doSomething" item}}>{{item.name}}</a>
{{/each}} 
```

现在我在路由器中定义了以下操作。

```
doSomething: function(router, event){
    event.context.get('name');
} 
```

以这种方式访问​​该物业有什么问题吗？我只是问，因为我在其他任何地方都没有见过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T20:04:40.007

这样做完全没有错。这就是上下文的目的。

# android - Android：根据设备的屏幕尺寸更改方向更改选项

> ID：12059369
> 
> 赞同：0
> 
> 时间：2012-08-21T16:38:39.850
> 
> 标签：android, manifest, tablet, screen-size

Android Manifest 有没有办法根据屏幕尺寸而有所不同？如果设备是平板电脑（即 xlarge 屏幕尺寸），我希望 android:configChanges 不包括“方向”

此外，我希望 android:screenOrientation 根据使用的设备而有所不同。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:47:38.607

我知道没有办法在 AndroidManifest.xml 中做一些复杂的事情，但是你可以通过`Activity.setRequestedOrientation()`方法以编程方式完成它。将其包装在实用程序类中并相应地查询您的环境很容易。一个警告虽然 - 如果调用此方法确实导致方向更改，您的 Activity`onCreate()`将被第二次调用。如果您选择走这条路线，另一件事可能会派上用场，如果以下评估为真：

```
if((cfg.screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE) {...} 
```

然后你在平板设备上，或者至少你的布局是从 layout-large 加载的（如果你有的话）。综上所述，以下内容会将平板电脑锁定为横向模式，将手机锁定为纵向模式：

```
 if ((cfg.screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE) {
         return true;
      } else if ((cfg.screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_NORMAL) {
         return false;
      } else if ((cfg.screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_SMALL) {
         return false;
      } else {
         // Assume that all other ratings are tablets or possibly even larger devices; there is an
         // extra large spec however it is only available OS versions 3.x and above so there is no clean way to query for this state.
         return true;
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T10:37:08.940

请看看这个............支持屏幕 android:resizeable=["true"| "假"] android:smallScreens=["真" | "假"] android:normalScreens=["真" | "假"] android:largeScreens=["真" | "假"] android:xlargeScreens=["真" | "假"] android:anyDensity=["真" | "false"] android:requiresSmallestWidthDp="integer" android:compatibleWidthLimitDp="integer" android:largestWidthLimitDp="integer ......它将处理你的屏幕

# java - 读/写数据库错误

> ID：12059371
> 
> 赞同：0
> 
> 时间：2012-08-21T16:38:44.987
> 
> 标签：java, android, file

我在一个 android 应用程序上有一个读写操作。在 onCreate 上，将读取文件并将其显示到编辑文本中并且可以进行编辑。当按下保存时，数据将被写入将在 onCreate 时读取的同一文件中。但我得到了一个错误。目录中没有这样的文件。我不明白。按下保存按钮时，我正在创建文件。有任何想法吗？

Java代码：

```
 EditText Name;
 EditText Age;
 EditText Height;
 EditText Weight;
 EditText MedHistory;

@Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.activity_medicalhistory);

     Name = (EditText) findViewById(R.id.medhistName);
     Age = (EditText) findViewById(R.id.medhistAge);
     Height = (EditText) findViewById(R.id.medhistHeight);
     Weight = (EditText) findViewById(R.id.medhistWeight);
     MedHistory = (EditText) findViewById(R.id.MedHist);

     int i = 0;

     String MedHistData[] = new String[5];

     try {
            File myFile = new File("/data/data/Project.Package.Structure/files/MedicalHistory.txt");
            FileInputStream fIn = new FileInputStream(myFile);
            BufferedReader myReader = new BufferedReader(new InputStreamReader(fIn));
            String aDataRow = "";
            while ((aDataRow = myReader.readLine()) != null)
            {
                MedHistData[i] = aDataRow;
                i++;
            }
            i = 0;
            Name.setText(MedHistData[0]);
            Age.setText(MedHistData[1]);
            Height.setText(MedHistData[2]);
            Weight.setText(MedHistData[3]);
            MedHistory.setText(MedHistData[4]);
            myReader.close();

        } catch (Exception e) {
            Toast.makeText(getBaseContext(), e.getMessage(),
                    Toast.LENGTH_SHORT).show();
        }

     Button Save = (Button) findViewById(R.id.SaveBtn);
     Save.setOnClickListener(new OnClickListener() {

     public void onClick(View v) {
            try {
                File myFile = new File("/data/data/Project.Package.Structure/files/MedicalHistory.txt");
                myFile.createNewFile();
                FileOutputStream fOut = new FileOutputStream(myFile);
                OutputStreamWriter myOutWriter = new OutputStreamWriter(fOut);
                myOutWriter.append(Name.getText() + "\n");
                myOutWriter.append(Age.getText() + "\n");
                myOutWriter.append(Height.getText() + "\n");
                myOutWriter.append(Weight.getText() + "\n");
                myOutWriter.append(MedHistory.getText());
                myOutWriter.close();
                fOut.close();
                Toast.makeText(getBaseContext(),
                        "Medical History Saved'",
                        Toast.LENGTH_SHORT).show();
            } catch (Exception e) {
                Toast.makeText(getBaseContext(), e.getMessage(),
                        Toast.LENGTH_SHORT).show();
            }
        }
        }); 

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:09:07.910

您应该使用 openFileInput() 方法打开文件进行读取，使用 openFileOutput() 进行写入。这些函数分别返回 FileInputStream 和 FileOutputStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:45:43.507

我的猜测：您没有对该文件的写访问权限。您只能访问特定文件夹以在 android 中写入。看一下

[http://developer.android.com/guide/topics/data/data-storage.html#filesInternal](http://developer.android.com/guide/topics/data/data-storage.html#filesInternal)

他们有一个关于如何编写文本文件的简单示例。

# javascript - 使用精灵的html5画布

> ID：12059372
> 
> 赞同：2
> 
> 时间：2012-08-21T16:38:46.620
> 
> 标签：javascript, html, canvas

我想在 html5 画布上下文中使用精灵。

我想用鼠标拖动它。所以在拖动鼠标时显示区域会发生变化。

它应该看起来像一个宽度为 21 且高度为 90 的窗口，其中只有一部分精灵可见。当我向下或向上拖动精灵时，我希望可见部分发生变化。

我想我可以用 drawImage (slice) 方法做到这一点，但它不能按我想要的方式工作......

你能帮帮我吗？

```
<html>
    <head>
        <script type="text/javascript">

            var y = 30;
            var canvas;
            var context;
            var imageHours;

            function clearClock(context) {
                context.clearRect(0, 0, 300, 500);
            }

            function init(){
                canvas = document.getElementById("uhr");
                context = canvas.getContext("2d");

                imageHours = new Image();
                imageHours.src = "07.png";

                context.drawImage(imageHours, 0, y, 21, 90, 50, 50, 21, 90);

                var down = false;

                canvas.addEventListener('mousedown', function(event) { down = true; }, false);  
                canvas.addEventListener('mouseup', function() { down = false; }, false);
                canvas.addEventListener('mousemove', function(event){
                    if(down){                   
                        if(event.layerY > 50 && event.layerY < 140){
                            y = event.layerY;           
                        }                       
                        clearClock(context);
                        context.drawImage(imageHours, 0, y, 21, 90, 50, 50, 21, 90);                        
                    }
                }, false);              
            }           
        </script>
    </head>
    <body onload="init();">
        <canvas id="uhr" height="500px" width="300px"/>
    </body>
</html> 
```

雪碧： ![雪碧：](../Images/64809701374fa94f383b25d9d735d392.png)

编辑：我在我的 mainPost 中添加了评论。我试图这样做的原因是..我不想为此使用图书馆..因为我想学习这样的东西......使用图书馆并不能帮助我学习......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:05:22.437

你的问题有点令人困惑。我认为下次创建小提琴将是一个好主意，它可以帮助人们帮助你。

我认为这就是你想要做的-> [jsFiddle](http://jsfiddle.net/mateuszwijas/4dgHa/)

我发现的两个问题：

1.  你的 y 值是错误的，它会导致图像不显示。
2.  您需要在 mouseup 上更新/重绘您的图标。您正在设置为 false 但在这种情况下 mousemove 不会重绘图标。

编辑：

我在[这里](http://jsfiddle.net/mateuszwijas/4dgHa/6/)更新了小提琴，这应该是你想要的，也是你应用程序的一个很好的起点。我鼓励您在画布上阅读更多内容，尤其是在使用图像方面。Mozzila 开发网络对此有很好的[介绍](https://developer.mozilla.org/en-US/docs/Canvas_tutorial/Using_images)，请查看它以详细解释为什么此代码会以这种方式工作。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:57:25.640

为了完成你需要的事情，你必须建立一个显示列表。那么事情就会变得容易。

如果您不介意使用图书馆，请查看以下链接。这些支持显示列表和多个对象。

1.  [http://www.createjs.com/#!/EaselJS](http://www.createjs.com/#!/EaselJS)
2.  [http://www.kineticjs.com/](http://www.kineticjs.com/)

# php - 是否可以在 codeigniter 中不使用 iframe 的情况下不重新加载页面的特定部分

> ID：12059374
> 
> 赞同：0
> 
> 时间：2012-08-21T16:38:55.457
> 
> 标签：php, codeigniter-2

例如。我的`div`所有视图中都有一个，但我仍然必须每次都重新加载它，从而减慢页面加载速度。那么有没有办法不重新加载页面的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:43:29.583

您应该考虑使用 Ajax... AJAX 是与服务器交换数据并更新网页的一部分的艺术 - 无需重新加载整个页面。

检查这个页面，这是一个简单的一步一步来学习非常基础的东西：http: [//www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:40:26.417

您可以使用 Ajax，只重新加载您需要的页面部分。

# php - Magento Bundle 产品数量相同

> ID：12059377
> 
> 赞同：1
> 
> 时间：2012-08-21T16:39:13.920
> 
> 标签：php, magento

希望这里的 Magento 大师可以帮助我。

这里的场景：

一个父捆绑产品有 4 个子产品 A1 A2 B1 B2；A1 和 B1 本身是一个捆绑包（必须一起购买，并且数量相同）对于 A2 和 B2 也是如此，所以本质上它是一个捆绑包（默认情况下，magneto 不允许这样做）。

这是我看到的选项：1）覆盖 Magento 的过滤器并允许捆绑捆绑（有风险，很多逻辑可能会变坏） 2）创建一个允许捆绑捆绑的新产品类型（非常困难，需要大量内置在要重写的逻辑中）3）在数量上建立一个模板级别的力量来匹配（基于特殊属性等）4）预先存在的模块（找不到）

有没有人对最好的方法有任何想法/建议？

谢谢

# maven - 配置 Maven 在运行测试时查看本地目录

> ID：12059380
> 
> 赞同：0
> 
> 时间：2012-08-21T16:39:37.023
> 
> 标签：maven

我们正在使用 JBehave，在运行测试时，我们需要在运行测试时将本地文件夹和 jar 添加到类路径中。问题是本地文件夹可能因系统而异。我们希望通过查看该系统上安装的 jar 和该系统上定义的资源来运行测试。

如何向 maven 添加一个可以从系统更改为系统的依赖项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:59:52.813

测试由[maven-surefire-plugin](http://maven.apache.org/plugins/maven-surefire-plugin/)执行。该插件只有一个目标[surefire:test](http://maven.apache.org/plugins/maven-surefire-plugin/test-mojo.html)并且该目标支持[附加](http://maven.apache.org/plugins/maven-surefire-plugin/test-mojo.html#additionalClasspathElements)类路径元素的配置。

[您可以在此处](http://maven.apache.org/plugins/maven-surefire-plugin/examples/configuring-classpath.html#Additional_Classpath_Elements)找到使用示例。此页面上的示例配置如下所示：

```
<project>
  [...]
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.12.2</version>
        <configuration>
          <additionalClasspathElements>
            <additionalClasspathElement>path/to/additional/resources</additionalClasspathElement>
            <additionalClasspathElement>path/to/additional/jar</additionalClasspathElement>
          </additionalClasspathElements>
        </configuration>
      </plugin>
    </plugins>
  </build>
  [...]
</project> 
```

我会走这条路。要更改每个系统的本地文件夹位置，您可以使用环境变量或不同的 Maven[配置文件](http://maven.apache.org/pom.html#Profiles)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:05:19.737

您可以在`pom.xml`using中使用环境变量`${env.VARIABLE_NAME}`。如果您在 pom 中有本地文件夹的路径，则可以将其替换为变量。如果这样做，则必须在执行 maven 作业的每个系统上设置该变量。我找到了一些关于如何做到这一点的[linux](http://lowfatlinux.com/linux-environment-variables.html)和[windows指南。](http://www.itechtalk.com/thread3595.html)希望这适合您的问题。

# php - Ajax 从一个链接中获取多个值

> ID：12059381
> 
> 赞同：0
> 
> 时间：2012-08-21T16:39:40.810
> 
> 标签：php, javascript, jquery, ajax

我有一个链接，我想从中获取多个值以通过 Ajax 提交。那么我如何从这个链接中选择streamitem_creator/target/content 和type_id 来传递给share.php？

```
echo"<a title='Share ".$poster_name['fullusersname']."s status' href='include/share.php?streamitem_creator=".$streamitem_data['streamitem_creator']."&streamitem_target=".$_SESSION['id']."&streamitem_content=".$streamitem_data['streamitem_content']."&streamitem_type_id=4'/>Share</a>"; 
```

我已经在链接中提出了我的解决方案用户数据

关联

```
 echo'<a class="sharelink" title="Share '.$poster_name['fullusersname'].'s status" href="#"
     data-streamitem_creator='.$streamitem_data['streamitem_creator'].'
     data-streamitem_target='.$_SESSION['id'].'
     data-streamitem_content='.$streamitem_data['streamitem_content'].'
     data-streamitem_type_id=4>Share</a>'; 
```

AJAX

```
$(document).ready(function(){
$('.sharelink').click(function(e){

var streamitem_creator = $(this).data('streamitem_creator');
var streamitem_target = $(this).data('streamitem_target');
var streamitem_content = $(this).data('streamitem_content');
var streamitem_type_id = $(this).data('streamitem_type_id');

$.ajax({
type: "GET",
url: "../include/share.php",
data: { streamitem_creator: streamitem_creator, streamitem_target: streamitem_target, streamitem_content: streamitem_content, streamitem_type_id: streamitem_type_id }, 
success: function(msg){
$('#result').html(msg);
e.preventDefault(); 
}
});
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:44:30.770

要获取`<a>`元素 href 属性，您可以执行以下操作：

```
var link = $('a[href^="include/share.php?streamitem_creator"]').attr('href'); 
```

但使用 ID 会更具体、更简单。

要获取查询字符串值的数组，您可以执行以下操作：

```
var qs = link.split('?')[1].split('&'); 
```

但是当它全部在 PHP 中时，很难说出查询字符串是什么样子的？

# javascript - 带有 onclick joomla 的 startPanel

> ID：12059383
> 
> 赞同：0
> 
> 时间：2012-08-21T16:39:50.470
> 
> 标签：javascript, joomla

我试图在 Joomla 中显示和隐藏一个 div 但不起作用

这是我要隐藏的 div

```
<div id="muestra" style="display:none;">
   <? php JToolBarHelper::editListX(); ?>
</div> 
```

我正在调用 javascript 函数

```
echo $pane->startPanel('<span onclick="mostrar(muestra);">Proveedores</span>','id_panel') ; 
```

我的 javascript 是

```
function mostrar(id){
if (document.getElementById){ 
var el = document.getElementById(id); 
alert(el);
el.style.display = (el.style.display == 'none') ? 'block' : 'none'; 
}
}
window.onload = function(){
mostrar('muestra');
}
</script> 
```

第一次 el=Object，但第二次是 null 并且从不取值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:23:55.050

试试这个

**HTML：**

```
<div id="muestra" style="display:none;">
   <?php JToolBarHelper::editListX(); ?>
</div> 
```

**PHP：**

```
echo $pane->startPanel('<span onclick="mostrar();">Proveedores</span>','id_panel') ; 
```

**Javascript：**

```
<script type="text/javascript">
function mostrar(){
    if (document.getElementById('muestra').style.display == 'none') {
       document.getElementById('muestra').style.display = 'block';
    }
    else {
       document.getElementById('muestra').style.display = 'none';
    }
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T11:56:37.993

尝试用撇号环绕*muestra*：

```
echo $pane->startPanel('<span onclick="mostrar(\'muestra\');">Proveedores</span>','id_panel'); 
```

# php - 从中心裁剪并在 PHP 中调整大小（函数）

> ID：12059387
> 
> 赞同：2
> 
> 时间：2012-08-21T16:40:21.520
> 
> 标签：php, image, function, crop, image-resizing

我想要一个功能，可以在不丢失纵横比的情况下调整图像的特定高度和重量。所以首先我想裁剪它然后调整它的大小。

这是我到目前为止得到的：

```
function image_resize($src, $dst, $width, $height, $crop=1){

  if(!list($w, $h) = getimagesize($src)) return "Unsupported picture type!";

  $type = strtolower(substr(strrchr($src,"."),1));
  if($type == 'jpeg') $type = 'jpg';
  switch($type){
    case 'bmp': $img = imagecreatefromwbmp($src); break;
    case 'gif': $img = imagecreatefromgif($src); break;
    case 'jpg': $img = imagecreatefromjpeg($src); break;
    case 'png': $img = imagecreatefrompng($src); break;
    default : return "Unsupported picture type!";
  }

  // resize
    $originalW = $w;
    $originalH = $h;

  if($crop){
    if($w < $width or $h < $height) return "Picture is too small!";
    $ratio = max($width/$w, $height/$h);
    $h = $height / $ratio;
    $x = ($w - $width / $ratio) / 2;
    $w = $width / $ratio;
  }
  else{
    if($w < $width and $h < $height) return "Picture is too small!";
    $ratio = min($width/$w, $height/$h);
    $width = $w * $ratio;
    $height = $h * $ratio;
    $x = 0;
  }

  $new = imagecreatetruecolor($width, $height);

  // preserve transparency
  if($type == "gif" or $type == "png"){
    imagecolortransparent($new, imagecolorallocatealpha($new, 0, 0, 0, 127));
    imagealphablending($new, false);
    imagesavealpha($new, true);
  }

  imagecopyresampled($new, $img, 0, 0, ($originalW - $width)/2, ($originalH - $height)/2, $width, $height, $w, $h);

  switch($type){
    case 'bmp': imagewbmp($new, $dst); break;
    case 'gif': imagegif($new, $dst); break;
    case 'jpg': imagejpeg($new, $dst); break;
    case 'png': imagepng($new, $dst); break;
  }
  return true;
} 
```

该功能工作正常。但我还是有问题。例如：当我将（300 × 450）的肖像图像调整为（260 × 140）时，我得到一个我不想要的黑色侧边栏。

这是2张图片：

![postimage.org/image/6vvq5l5sn](../Images/44c9e4ac9f1b6462994ff32a4fa39fd2.png) ![在此处输入图像描述](../Images/08a52ee563c13ddc5bdb6540a93e9ff2.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-16T06:00:04.307

它对我有用。你可以试试：

```
$x=288; $y=202; // my final thumb
$ratio_thumb=$x/$y; // ratio thumb

list($xx, $yy) = getimagesize($image); // original size
$ratio_original=$xx/$yy; // ratio original

if ($ratio_original>=$ratio_thumb) {
    $yo=$yy; 
    $xo=ceil(($yo*$x)/$y);
    $xo_ini=ceil(($xx-$xo)/2);
    $xy_ini=0;
} else {
    $xo=$xx; 
    $yo=ceil(($xo*$y)/$x);
    $xy_ini=ceil(($yy-$yo)/2);
    $xo_ini=0;
}

imagecopyresampled($thumb, $source, 0, 0, $xo_ini, $xy_ini, $x, $y, $xo, $yo); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-12T17:03:27.183

适用于：

```
imagecopyresampled($new, $img, 0, 0, 0, 0, $width, $height, $w, $h); 
```

# jquery-ui - Jquery对某些功能无响应

> ID：12059388
> 
> 赞同：0
> 
> 时间：2012-08-21T16:40:23.293
> 
> 标签：jquery-ui, jquery, jquery-plugins, jqgrid

在这里，变量 $thislistitem（下面以粗体显示）在我的函数中的相同位置。我把它分开来加粗。专注于正在创建的 jquery ui 按钮和单击事件。

```
 function activatequalifdetails($subgrid, qualId){
            $subgrid.find('.itemcontrols').hide();
            $subgrid.find("#detailedsubjects ol").on("click", "li", function(event){
                event.stopPropagation();
                        var $itemwithfoucsclass = $(".focus");
/* <![CDATA[ */         if(($itemwithfoucsclass[0] != $(this)[0]) && ($itemwithfoucsclass.length !== 0)){           /* ]]> */ 
                            $.post('<c:url value="/highschooldetailedqualifications/highschoolqualdetailedajaxupdate/"/>'+$itemwithfoucsclass.find('.itemcontrols button:nth-child(1)').attr("qualdetailid"), {grade: $itemwithfoucsclass.find('.grade').val(), yearattained: $itemwithfoucsclass.find('.yearAttained').val()});
                        } 
```

**var $thislistitem = $(this);**

```
 $subgrid.find('#detailedsubjects ol li').not(this).removeClass('focus').find('.itemcontrols').hide();               
        $(this).addClass("focus").find('.itemcontrols').show();

            $(this).find('.itemcontrols button:nth-child(1)').button({
                icons: {
                    primary: "ui-icon-disk"
                },
                text: false
            }).unbind('click').click(function(){
                $.post('<c:url value="/highschooldetailedqualifications/highschoolqualdetailedajaxupdate/"/>'+$(this).attr("qualdetailid"), {grade: $thislistitem.find('.grade').val(), yearattained: $thislistitem.find('.yearAttained').val()}, function(data){
                    $thislistitem.removeClass('focus').find('.itemcontrols').hide();
                });
            });

            $(this).find('.itemcontrols button:nth-child(2)').button({
                icons: {
                    primary: "ui-icon-trash"
                },
                text: false
            }).unbind('click').click(function(){
                $.get('<c:url value="/highschooldetailedqualifications/highschoolqualdetailedajaxdelete/"/>'+qualId+'/'+$(this).attr("qualdetailid"), function(data){
                    $thislistitem.remove();
                });
            });

            $(this).find('.itemcontrols button:nth-child(3)').button({
                icons: {
                    primary: "ui-icon-closethick"
                },
                text: false
            }).unbind('click').click(function(){
                $thislistitem.removeClass('focus').find('.itemcontrols').hide()
            });             
    });//apply css class on click on any given item
} 
```

保存和删除的点击事件完美运行。然而，取消按钮（第 3 个按钮）的单击事件正在提供一些行为。第三个按钮的点击逻辑与保存的相同，唯一的区别是图标，不需要帖子ID。

当我单击取消按钮时，没有任何反应。如果我做

```
.unbind('click').click(function(){
                    $thislistitem.remove();
                }); 
```

对于第三个按钮，它可以工作。

如果我提醒一些测试文本，它可以正常工作。如果使用`removeClass()`什么都不会发生。我尝试按原样复制和粘贴保存功能，更改图标等，并保持 ajax 调用完好无损。这工作正常，焦点课程被删除。如果我删除 ajax 调用并运行上面函数中看到的逻辑，那么什么都不会发生。Firebug 什么也没报告。

我在此页面上按顺序加载了多个版本的 jquery（1.4.3、1.4.2、1.5.1、1.6.2 和 1.7.2）。这可能是我的问题吗？对于我用于其他事情的不同插件，我需要不同的版本。有任何想法吗 ？我完全被难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:05:30.863

好的，这就是我必须做的，这对我来说似乎是一个非常非常根本的错误。

```
 $(this).find('.itemcontrols button:nth-child(3)').button({
                icons: {
                    primary: "ui-icon-closethick"
                },
                text: false
            }).unbind('click').click(function(){
                $thislistitem.removeClass('focus').find('.itemcontrols').hide();
                return false;
            }); 
```

我需要做的就是添加**return false;** 按照我的逻辑。希望它可以帮助那里的人。

# jquery - 将项目添加到 类相同时的onClick

> ID：12059393
> 
> 赞同：1
> 
> 时间：2012-08-21T16:40:39.287
> 
> 标签：jquery

我正在尝试创建一个收藏夹功能（类似于 StackOverflow 上这篇文章左侧的星号），当用户单击一个元素时，该类中的另一个元素将被添加到列表中，主要的复杂性是所有div 具有相同的类但不同的内容。

因此，当您单击`.mydiv`相应跨度类中的数字时，应将其添加`<li>`为`<ul>`. 作为一个额外的好处，如果相反的情况也是如此，那就太好了，即再次单击 div 会从`<ul>`

HTML：

```
<div class="mydiv" > <span class="number">1</span> This is first div with same id. </div>
<div class="mydiv" > <span class="number">2</span> This is second div with same id. </div>
<div class="mydiv" > <span class="number">3</span> This is third div with same id. </div>
<ul id="favourites" > </ul>​ 
```

jQuery：

```
$('.mydiv').click(function() {
  $('#favourites').append('<li>' + text + '</li>');
});  ​ 
```

[http://jsfiddle.net/uv25u/](http://jsfiddle.net/uv25u/)

**编辑：我刚刚注意到，如果两个跨度具有相同的编号，那么您不能单独收藏它们，即。脚本感到困惑并认为两个 div 是相同的，因为它们具有相同的跨度编号，即使两个跨度编号相同，是否有解决方案来保持相同的功能？**

例如。如果 HTML 是这样的，我们可以让它工作吗：

```
<div class="mydiv" > <span class="number">1</span> This is first div with same id. </div>
<div class="mydiv" > <span class="number">2</span> This is second div with same id. </div>
<div class="mydiv" > <span class="number">2</span> This is third div with same id. </div>
<ul id="favourites" > </ul>​ 
```

ps如果脚本还自动向添加的添加了一个新的跨度`<li>`，当单击它时从列表中删除`<li>`那会很棒，这可能吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:45:45.663

```
$('.mydiv').click(function() {
    var number = $(".number", this).text(),
        $favourites = $("#favourites"),
        $li = $("[data-number=" + number + "]", $favourites);
    if ($li.length) {
        $li.remove();
    } else {
      $("<li>").text(number).attr("data-number", number).appendTo($favourites);
    }
}); 
```

[小提琴](http://jsfiddle.net/uv25u/16/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:46:10.573

尝试像下面这样，

```
$('.mydiv').click(function() {
   var num = $(this).find('.number').text();
   var $fav = $('#favourites');
   var $fav_li = $fav.find('.' + num + '_li');

   if ($fav_li.length) {
      $fav_li.remove();
   } else {
      $('#favourites').append('<li class="' + num + '_li">' + num + '</li>');
   }
}); 
```

**演示：http:** [//jsfiddle.net/uv25u/7/](http://jsfiddle.net/uv25u/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T17:01:32.753

小提琴： http: [//jsfiddle.net/uv25u/17/](http://jsfiddle.net/uv25u/17/) <-比较数字
**编辑：http:** [//jsfiddle.net/uv25u/20/](http://jsfiddle.net/uv25u/20/) <-比较整个内容

```
$('.mydiv').click(function() {
    if (! $(this).hasClass('favorite')) { // if not already favorite
      $('#favourites').append($('<li>'+$(this).html()+'</li>'));  // add the cliked item to the favourites as an li
      $(this).addClass('favorite');  // mark clicked item as favourite
   } else { // if already favorite
      var content = $(this).html(); // store content of clicked div
      $(this).removeClass('favorite');  // unmark clicked item as favourite
      $('#favourites li').each(function() {  // loop trough favourites
          if ($(this).html() == content) { // check if contents match
              $(this).remove(); // remove from favourites if match
          }
      });

   }

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T16:55:40.647

```
$('.mydiv').on('click', function() {
    var numb = $('.number', this).text(),
        elem = $('li', '#favourites').filter(function() {
            return $(this).text() === numb;
        });
    if (elem.length) {
        elem.remove();
    }else{
        $("#favourites").append('<li>' + numb + '</li>');
    }
});  ​ 
```

[**小提琴**](http://jsfiddle.net/8yv3V/1/)

# perl - 使用 Perl 做 XPath

> ID：12059394
> 
> 赞同：1
> 
> 时间：2012-08-21T16:40:40.013
> 
> 标签：perl, xpath

我在 Window 7 机器上使用 Perl 进行编码。我可以使用下面的 XPath 代码从 XML 中提取数据

```
use strict;
use warning;

use XML::LibXML;

my $parser = XML::LibXML->new();
        my $doc    = $parser->parse_file($newfile);
        my $query  = "/tradenet/message/header/unique_ref_no/date/text( )";
        my($node)   = $doc->findnodes($query);
        $node->setData("$file_seq_number"); 
```

但是，当我在不同的 XML 上使用相同的代码时，第二个文档的 xpath 如下所示：

```
/TradenetResponse/OutboundMessage/out:OutwardPermit/out:Declaration/out:Header/cac:UniqueReferenceNumber/cbc:SequenceNumeric 
```

连同 Perl 代码，提取代码如下所示：

```
my $parser = XML::LibXML->new();
    my $doc    = $parser->parse_file($newfile);
    my $query  = "/TradenetResponse/OutboundMessage/out:OutwardPermit/out:Declaration/out:Header/cac:UniqueReferenceNumber/cbc:SequenceNumeric/text( )";
    my($node)   = $doc->findnodes($query);
    $node->setData("$file_seq_number"); 
```

使用第二个代码，我无法从第二个 XML 中检索数据。我收到此错误“无法在 Perl.pl 第 5 行的未定义值上调用方法“setData””。

第二个 XPATH 地址中的“：”字符会影响代码吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T17:02:37.697

您必须定义 what `out`、`cac`和`cbc`mean 以便 XPath 查询找到适当的节点：

```
my $doc = $parser->parse_file($newfile);
my $xpath_context = XML::LibXML::XPathContext->new($doc->documentElement());

# These URIs need to be the same as the ones in the source document
$xpath_context->registerNs('out', 'http://example.com/out.xsd');
$xpath_context->registerNs('cac', 'http://example.com/cac.xsd');
$xpath_context->registerNs('cbc', 'http://example.com/cbc.xsd');

my $query  = "/TradenetResponse/OutboundMessage/out:OutwardPermit/out:Declaration/out:Header/cac:UniqueReferenceNumber/cbc:SequenceNumeric/text( )";
my ($node) = $xpath_context->findnodes($query); 
```

正如所承诺的，这是一个工作示例。一、测试输入文件：

```
<?xml version="1.0"?>

<!-- input.xml -->

<TradenetResponse xmlns:a="http://example.com/out.xsd"
                  xmlns:b="http://example.com/cac.xsd"
                  xmlns:c="http://example.com/cbc.xsd">
  <OutboundMessage>
    <a:OutwardPermit>
      <a:Declaration>
        <a:Header>
          <b:UniqueReferenceNumber>
            <c:SequenceNumeric>1234</c:SequenceNumeric>
          </b:UniqueReferenceNumber>
        </a:Header>
      </a:Declaration>
    </a:OutwardPermit>
  </OutboundMessage>
</TradenetResponse> 
```

这是有效的 Perl 脚本：

```
#!/usr/bin/perl

# parse.pl

use strict;
use warnings;
use XML::LibXML;

my $parser = XML::LibXML->new();

my $newfile = "input.xml";
my $doc = $parser->parse_file($newfile);
my $xpath_context = XML::LibXML::XPathContext->new($doc->documentElement());

# These URIs need to be the same as the ones in the source document
$xpath_context->registerNs('out', 'http://example.com/out.xsd');
$xpath_context->registerNs('cac', 'http://example.com/cac.xsd');
$xpath_context->registerNs('cbc', 'http://example.com/cbc.xsd');

# Query wrapped for clarity                                                                                                         
my $query = "/TradenetResponse/OutboundMessage/out:OutwardPermit" .
            "/out:Declaration/out:Header/cac:UniqueReferenceNumber" .
            "/cbc:SequenceNumeric/text()";

my ($node) = $xpath_context->findnodes($query);

print "Value: " . $node->getData() . "\n"; 
```

我的输出是：

```
sean@localhost:~xmltest$ ./parse.pl
价值：1234

```

# javascript - 如何在 jQuery 插件中创建公共方法

> ID：12059396
> 
> 赞同：0
> 
> 时间：2012-08-21T16:40:46.013
> 
> 标签：javascript, jquery, jquery-plugins, methods, public

我一直在使用下面的样板进行 jQuery 插件开发，效果很好。但我不确定公开“方法”的最佳方式。

```
 ;(function ( $, window, undefined ) {

              var pluginName = 'defaultPluginName',
                  document = window.document,
                  defaults = {
                    propertyName: "value"
                  };

              function Plugin( element, options ) {
                this.element = element;

                this.options = $.extend( {}, defaults, options) ;

                this._defaults = defaults;
                this._name = pluginName;

                this.init();
              }

              Plugin.prototype.init = function () {

              };

              $.fn[pluginName] = function ( options ) {
                return this.each(function () {
                  if (!$.data(this, 'plugin_' + pluginName)) {
                    $.data(this, 'plugin_' + pluginName, new Plugin( this, options ));
                  }
                });
              }

            }(jQuery, window)); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:00:46.047

只有函数可以是私有/本地的，而不是 jQuery 插件。

如果您正在使用 jQuery 并尝试在 jQuery 中添加自己的（自定义）函数，那么有一个最好的方法`jQuery.fn.yourFunctionname = function(){}`，因为 jQuery 已经在公共范围内，所以公共范围也是如此`jQuery.fn.yourFunctionname`（无论您在哪里定义 Plugin ，都可以在全球范围内使用）。

```
window.jQuery = jQuery;

$.fn.pluginName = function ( options ) {

    return this.each(function () {
    // code goes here
    });
} 
```

# php - 有没有办法在 Windows 上全局安装 Composer？

> ID：12059397
> 
> 赞同：56
> 
> 时间：2012-08-21T16:40:48.150
> 
> 标签：php, windows, composer-php

我已经阅读了Composer 的[全局安装文档](http://getcomposer.org/doc/00-intro.md#globally)，但它仅适用于 *nix 系统：

```
curl -s https://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer 
```

我会很高兴在 Windows 上做同样的事情，那是我开发机器的操作系统。我能跑

```
composer update 
```

从存在的任意文件夹中`composer.json`。解释`php.exe`器已经在`PATH`变量中。

有什么线索吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-08-21T16:43:56.020

当然。只需将 composer.phar 放在类似的地方`C:\php\composer.phar`，然后在 PATH`composer.bat`中的某个地方创建一个批处理文件，该文件执行以下操作：

```
@ECHO OFF
php "%~dp0composer.phar" %* 
```

"%*" 重复传递给 shell 脚本的所有参数。

然后你就可以`composer update`随心所欲地跑来跑去！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-03-13T18:29:01.413

> # 安装作曲家
> 
> 在 Windows 上，您可以使用 Composer [Windows Installer](https://getcomposer.org/Composer-Setup.exe)。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-07-25T09:41:12.380

转到 php.exe 所在的文件夹。

`C:\wamp\bin\php\php5.5.12\`

在那里打开cmd，然后执行下面的命令。

```
php -r "readfile('https://getcomposer.org/installer');" | php 
```

`composer.phar`将下载到同一文件夹中。

创建以驱动器命名的文件夹`composer`（`C://`或您希望的任何位置，对于接下来的步骤，请记住路径）。

将`composer.phar`文件移动到`C://composer`文件夹。

在同一文件夹中创建`composer.bat`文件，内容如下

```
@ECHO OFF
php "%~dp0composer.phar" %* 
```

创建`composer`没有任何扩展名的文件。

在 CMD 中运行命令`type NUL > composer`将有助于快速完成它，

打开该文件并将下面的内容放入其中。

```
#!/bin/sh
dir=$(d=$(dirname "$0"); cd "$d" && pwd)
# see if we are running in cygwin by checking for cygpath program
if command -v 'cygpath' >/dev/null 2>&1; then
    # cygwin paths start with /cygdrive/ which will break windows PHP,
    # so we need to translate the dir path to windows format. However
    # we could be using cygwin PHP which does not require this, so we
    # test if the path to PHP starts with /cygdrive/ rather than /usr/bin.
    if [[ $(which php) == /cygdrive/* ]]; then
        dir=$(cygpath -m $dir);
    fi
fi
dir=$(echo $dir | sed 's/ /\ /g')
php "${dir}/composer.phar" $* 
```

节省。

现在设置`path`，所以我们可以从 cmd 访问 composer。

*   显示桌面。

*   右键单击桌面上的我的电脑快捷方式。

*   单击属性。

*   您应该看到控制面板的一部分 - 控制面板\系统和安全\系统。

*   单击左侧菜单上的高级系统设置。

*   单击窗口底部的环境变量。

*   在用户变量列表中选择 PATH。

*   将您的 PHP 路径 (C:\composer) 附加到 PATH 变量中，并用分号与现有字符串分隔。

*   点击确定

重新启动您的机器。

或者，`explorer`仅在 CMD 中使用以下命令重新启动。

```
taskkill /f /IM explorer.exe
start explorer.exe
exit 
```

带有屏幕截图的原始文章：http: [//aslamise.blogspot.com/2015/07/installing-composer-manually-in-windows-7-using-cmd.html](http://aslamise.blogspot.com/2015/07/installing-composer-manually-in-windows-7-using-cmd.html)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-12-29T16:17:50.387

这可能对某人有用：

在 Windows 7 上，如果您使用 curl 安装了 Composer，则可以在类似的路径中找到它：

`C:\Users\<username>\AppData\Roaming\Composer`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-02T16:58:37.697

好吧，现在这个问题有点过时了，因为现在有一个官方安装程序“将安装最新的 Composer 版本并设置您的 PATH，以便您可以从命令行中的任何目录调用 composer。”

您可以在以下网址获得它： http: [//getcomposer.org/doc/00-intro.md#installation-windows](http://getcomposer.org/doc/00-intro.md#installation-windows)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-04T10:01:48.730

如果将批处理放在与 composer.phar 相同的文件夹中，则更通用一点：

```
@ECHO OFF
SET SUBDIR=%~dp0
php %SUBDIR%/composer.phar %* 
```

我会把它写成评论，但那里没有代码

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-18T19:45:05.023

开始>计算机：属性>更改设置>高级>环境变量>路径：编辑[在行尾添加此字符串（不带“”）`";C:\<path to php folder>\php5.5.3"`..打开cmd并输入composer就是这样:-)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-03-10T10:14:15.133

我使用 Composer-Setup.exe，它工作正常。以防万一您需要知道 composer.phar 在哪里（与 PhpStorm 一起使用）：

```
C:\ProgramData\ComposerSetup\bin\composer.phar 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-06-23T20:28:31.410

不幸的是，这里所有的好答案都对我不起作用。因此，在 Windows 10 上安装 Composer 后，我只需要安装它就可以了`system variable`。`environment variables`

[![Windows 10 环境变量 -> 系统变量](../Images/5707a2f1ae76479e00cdf7c01de1d70e.png)](https://i.stack.imgur.com/Nj8eR.jpg)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-24T14:30:47.557

另一种变体（参见[Lusitanian answer](https://stackoverflow.com/a/12059443/367456)）是将`.phar`文件注册为系统上的可执行文件，示例`phar.reg`文件：

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\.phar]
@="phar_auto_file"

[HKEY_CLASSES_ROOT\phar_auto_file\shell\open\command]
@="\"c:\\PROGRA~1\\php\\php.exe\" \"%1\" %*" 
```

只需替换`php.exe`PHP 可执行文件的路径即可。然后，您还可以扩展`%PATHEXT%`命令行变量，使用`.PHAR`它可以让您键入`composer`而不是`composer.phar`只要`composer.phar`在`%Path%`.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-01-10T15:54:51.020

抱歉，我只是想分享我的想法，对我来说最简单的方法是将 composer.phar 重命名为 composer.bat 并将其放入我的 PATH 中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-01-31T14:47:23.063

我遇到了同样的问题，当我检查 Windows 7 中的环境时，它指向不存在的 c:\users\myname\appdata\composer\version\bin。该文件实际上位于 C:\ProgramData\ComposerSetup\bin 修复了环境设置中的位置并且它有效

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-22T16:09:45.050

您可以使用此命令行安装它

```
 echo @php "%~dp0composer.phar" %* > composer.bat 
```

# c# - 使用 HtmlAgilityPack 选择内部文本

> ID：12059399
> 
> 赞同：3
> 
> 时间：2012-08-21T16:40:55.303
> 
> 标签：c#, html, html-agility-pack

我正在尝试使用 HtmlAgilityPack 提取一些内部文本。这是感兴趣的 HTML：

```
<select name="Archives" onchange="javascript:setTimeout(&#39;__doPostBack(\&#39;Archives\&#39;,\&#39;\&#39;)&#39;, 0)" id="Archives" style="width:200px;">
    <option selected="selected" value="Dashboard_Jul-2012">Dashboard_Jul-2012</option>
    <option value="Dashboard_Jun-2012">Dashboard_Jun-2012</option>
</select> 
```

我在用：

```
string output = htmlwriter.InnerWriter.ToString()
var doc = new HtmlDocument();
doc.LoadHtml(output);
string inner = doc.DocumentNode.SelectSingleNode("//option[@selected='selected']").InnerText; 
```

但我得到的只是空字符串。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:45:58.013

默认情况下，HTMLAgilityPack 将选项标签留空（您可以在[HtmlAgilityPack 中看到作者这样做的原因——<form> 是否出于某种原因关闭自身？](https://stackoverflow.com/questions/4218847/htmlagilitypack-does-form-close-itself-for-some-reason)）。要修复它，请在选择节点之前添加此行：

```
HtmlNode.ElementsFlags.Remove("option"); 
```

# c# - 使用 ServiceStack 下载文件（html 内容）

> ID：12059400
> 
> 赞同：10
> 
> 时间：2012-08-21T16:41:02.123
> 
> 标签：c#, servicestack

我将[Service Stack](http://www.servicestack.net/)用于一个简单的 Web 应用程序。

在这个应用程序中，我需要将一些内容“导出”到 Excel。所以这是我采用的方法：

1.  我使用 jQuery 获取表格的 HTML 内容，然后获取表格的 HTML 内容，然后发送到服务。
2.  服务将内容写入文件（使用一些 CSS）
3.  使用相同的服务，但使用一种`GET`方法，我读取文件并使用`ContentType:"application/vnd.ms-excel"`

我在其他时候使用了这种没有服务堆栈的方法，并且效果很好。该`XLS`文件具有正确的内容和一些颜色。

现在，当我使用`GET`方法（即用浏览器访问url）获取文件时，文件内容是错误的。

ServiceStack 允许下载一些格式：html、csv、jsv、json、xml。

html 格式显示一个默认的报告页面，唯一可以使用的格式是 jsv。

我的问题是：我怎样才能像普通的 html 文件一样下载文件？

一些代码：

```
public class ExcelService : RestServiceBase<Excel>
{   
    public override object OnGet (Excel request)
    {
        string file = request.nombre;
        //Response.Clear();
        HttpResult res = new HttpResult();
        res.Headers[HttpHeaders.ContentType] = "application/vnd.ms-excel";
        res.Headers[HttpHeaders.ContentDisposition] = "attachment; filename="+file+".xls";
        string archivo = System.IO.File.ReadAllText("tmp/"+file+".html");
        res.Response = archivo;
        return res;
    }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-21T18:18:48.457

[ServiceStack](http://www.servicestack.net)中的 HttpResult 构造函数作为支持文件下载的重载，例如：

```
return new HttpResult(new FileInfo("tmp/"+file+".html"), 
    asAttachment: true, 
    contentType: "application/vnd.ms-excel"); 
```

这将设置`ContentDisposition`文件下载所需的 HTTP 标头。

### 创建自己的 Http 结果

要对 HttpOutput 进行更细粒度的控制，您还可以创建自己的 Result 类。[以下是从ServiceStack 问题中的自定义响应中](https://stackoverflow.com/questions/6245616/does-servicestack-support-binary-responses/9843621#9843621)下载 Excel 电子表格的示例：

```
public class ExcelFileResult : IHasOptions, IStreamWriterAsync
{
    private readonly Stream _responseStream;
    public IDictionary<string, string> Options { get; private set; }

    public ExcelFileResult(Stream responseStream)
    {
        _responseStream = responseStream;

        Options = new Dictionary<string, string> {
             {"Content-Type", "application/octet-stream"},
             {"Content-Disposition", ""attachment; filename=\"report.xls\";"}
         };
    }

    public async Task WriteToAsync(Stream responseStream, CancellationToken token = default)
    {
        if (_responseStream == null) 
            return;

        await _responseStream.CopyToAsync(responseStream, token);
        await responseStream.FlushAsync(token);
    }
} 
```

# python - 使用“密钥”与 adodbapi 连接到 MS Access

> ID：12059405
> 
> 赞同：0
> 
> 时间：2012-08-21T16:41:26.663
> 
> 标签：python, key, adodbapi

我有一些链接到 Access 的代码，并且可以与 adodbapi 一起正常工作，除了一个我无法解决的琐碎问题。基本上我想用列标题“键”和“值”在 Access 中创建一个新表，但它似乎工作，除非我包含我不想要的逗号。我收到以下错误：

**adodbapi.adodbapi.DatabaseError：（-2147352567，'发生异常。'，（0，u'Microsoft JET 数据库引擎'，u'字段定义中的语法错误。'，无，5003292，-2147217900），无）**

```
import adodbapi

# create the DSN execution string and point it to the desired Database
database = 'D:\Temp.mdb' 
constr = 'Provider=Microsoft.Jet.OLEDB.4.0; Data Source=%s '  % database
conn = adodbapi.connect(constr)

# create a cursor
cur = conn.cursor()
# below doesnt work
cur.execute('CREATE TABLE OtherInfo(Key VARCHAR(100), Value VARCHAR(100))')  
# but this does
cur.execute('CREATE TABLE OtherInfo(Key2 VARCHAR(100), Value2 VARCHAR(100))')  
# so does this
cur.execute('CREATE TABLE OtherInfo('Key' VARCHAR(100), 'Value' VARCHAR(100))') 

# this also fails unless similar to above
cur.execute("INSERT INTO OtherInfo(Key,Value) VALUES('AppName','XXX')")

# close the cursor and connection
conn.commit()       # this saves all of the changes made above
cur.close()
conn.close() 
```

我怎样才能让它插入列标题和数据作为 {Key, Value} 而不必求助于“Key”等，因为使用该表的程序不能引用其他名称？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T08:13:06.933

想通了，它需要一个 [wrapper] 来工作，如下所示：

```
cur.execute('CREATE TABLE OtherInfo([Key] VARCHAR(100), [Value] VARCHAR(100))') 
```

感谢任何不厌其烦的人观看。

# html - 在高度为 100% 的 div 中垂直对齐

> ID：12059410
> 
> 赞同：11
> 
> 时间：2012-08-21T16:41:44.647
> 
> 标签：html, css

这是我的情况：我正在尝试用两个 DIV 填充整个页面（高度 100%，宽度 50%）。此外，DIV 中的内容要垂直居中对齐。

有没有一种简单的方法可以在没有黑客或 JavaScript 的情况下实现这一目标？

我试过了`body,html{height:100%;} .mydiv {display:table-cell;height:100%;vertical-align-middle}`

但这不起作用......并且使用该代码，我必须以像素而不是百分比指定宽度

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-21T17:20:32.307

# [现场演示](http://jsfiddle.net/YeH84/1/)

我刚刚做[了一个 jsFiddle 来](http://jsfiddle.net/YeH84/1/)展示我对解决方案的建议。在这里，我考虑到您希望两个`<div>`s 分别填充 50% 的宽度和 100% 的高度，并且您希望内容在中间垂直对齐。这是带有源代码的[简化工作解决方案。](http://jsfiddle.net/YeH84/18/)

## HTML

```
<div id="outer">
    <div id="table-container">
        <div id="table-cell">
            This content is vertically centered.
        </div>
    </div>
</div> 
```

## CSS

```
#outer {
    position:absolute;
    top:0;
    left:0;
    width:50%;
    height:100%;
}

#table-container {
    height:100%;
    width:100%;
    display:table;
}

#table-cell {
    vertical-align:middle;
    height:100%;
    display:table-cell;
    border:1px solid #000;
} 
```

作为参考，我使用[了本教程](http://www.barelyfitz.com/screencast/html-training/css/positioning/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:49:10.967

```
position: absolute;
top: 0;
bottom: 0; 
```

会给你一个填充到 100% 高度的盒子。确保您的 HTML 和 BODY 标签足够大：

```
html, body {
  height: 100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:10:00.487

你想要这种设计吗？=>[**示例小提琴**](http://jsfiddle.net/6JJJ8/)

# ruby-on-rails - Rails 3：在 Rails 应用程序中实现 Facebook 风格的“朋友列表”功能的最佳方式是什么？

> ID：12059414
> 
> 赞同：0
> 
> 时间：2012-08-21T16:41:55.150
> 
> 标签：ruby-on-rails

我有一个当前从 mySQL DB 获取数据的应用程序。我有一个`Person`包含列的表：`Name`, `Gender`, `Email`,`Hobby`等等。

我想实现一个“类似分组”的功能，以便用户可以按特定列（例如`Gender`）分类到一个组中

我所拥有的是这样的： ![在此处输入图像描述](../Images/263d308a95ed66bda3603351e450cfc5.png)

我想要实现的是按性别和一个小`+`标志创建两个组男孩/女孩，以便我们可以扩展它并查看组中的人： ![在此处输入图像描述](../Images/cfa2e5980d62ff9fd1ac74294486140b.png)

最好的方法是什么？更新：我的实现方式：

```
my_controller.rb:

def index
  @people = Person.find_by_sql(*some sql stuff*)
  @persons = @people.group_by { |t| t.gender }
end 
```

然后在视图文件中

```
view.html.erb
<% @persons.sort.each do |gender, person_list| %>
  <h2><%= gender %></h2>
  <% for person in person_list %>
    *some code here*
  <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:12:29.517

您可以使用范围。在您的 Person 模型文件中，添加以下内容：

```
scope :boys, where(:gender => "Male")
scope :girls, where(:gender => "Female") 
```

然后在您的控制器中，您可以为每个性别组创建变量。

```
@boys = Person.boys
@girls = Person.girls 
```

最后在你的视图中遍历@boys 和@girls。

# ruby-on-rails - rails 在模型中验证值在数组内

> ID：12059415
> 
> 赞同：27
> 
> 时间：2012-08-21T16:41:56.397
> 
> 标签：ruby-on-rails, arrays, validation, text, model

我有一个表单，我在其中传递了一个**名为的字段** `:type`，我想**检查它的值是否在允许的类型数组内，**以便**不允许任何人发布不允许的类型**。

数组看起来像

```
@allowed_types = [
   'type1',
   'type2',
   'type3',
   'type4',
   'type5',
   'type6',
   'type7',
   etc...
] 
```

我**试过使用** `validates_exclusion_of`or`validates_inclusion_of`但它似乎不起作用

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-21T16:50:14.187

首先，将属性从类型更改为其他内容，类型是用于单表继承等的保留属性名称。

```
class Thing < ActiveRecord::Base
   validates :mytype, :inclusion=> { :in => @allowed_types } 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-08-21T16:57:42.767

`ActiveModel::Validations`为此提供了一个辅助方法。一个示例调用是：

```
validates_inclusion_of :type, in: @allowed_types 
```

ActiveRecord::Base 已经是一个 ActiveModel::Validations，所以不需要包含任何东西。

[http://apidock.com/rails/ActiveModel/Validations/HelperMethods/validates_inclusion_of](http://apidock.com/rails/ActiveModel/Validations/HelperMethods/validates_inclusion_of)

此外，@RadBrad 是正确的，您不应将`type`其用作列名，因为它是为 STI 保留的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-07-24T13:34:06.550

只是为了那些懒惰的人（比如我）复制最新的语法：

```
validates :status, inclusion: %w[pending processing succeeded failed] 
```

*   `validates_inclusion_of`自 Rails 3 以来已过时。
*   `:inclusion=>`自 Ruby 2.0 以来，哈希语法已过时。
*   赞成将`%w`for word 数组作为默认的[Rubocop 选项](https://www.rubydoc.info/github/bbatsov/RuboCop/RuboCop/Cop/Style/WordArray)。

有变化：

默认类型为常量：

```
STATUSES = %w[pending processing succeeded failed]

validates :status, inclusion: STATUSES 
```

OP的原文：

```
validates :mytype, inclusion: @allowed_types 
```

# c# - 编辑分组数据更改行顺序

> ID：12059416
> 
> 赞同：0
> 
> 时间：2012-08-21T16:41:58.733
> 
> 标签：c#, .net, wpf, telerik, radgridview

```
<t:RadGridView AutoGenerateColumns="True" ShowGroupPanel="True" Name="gridView" />

    public MainWindow()
    {
        InitializeComponent();

        DataTable dt = new DataTable("Row Order Checker");
        dt.Columns.Add("Group by me");
        dt.Columns.Add("Data for editing");

        dt.Rows.Add("1", "data 1");
        dt.Rows.Add("1", "data 2");
        dt.Rows.Add("1", "data 3");

        gridView.ItemsSource = dt.AsDataView();
    } 
```

我在表单上添加了简单的 Telerik 网格。然后我按“按我分组”列对数据进行分组。然后我编辑了第一行并将“data 1”更改为“qwe”。行在分组数据的末尾移动。

如何避免这种奇怪的行为？我希望行留在同一个地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:48:04.007

你提到的不是一个奇怪的行为。它实际上使用其默认算法对列进行排序。为了实现您的方案，您需要修改代码如下：

XAML：

```
<telerik:RadGridView AutoGenerateColumns="False" ShowGroupPanel="True" Name="gridView">
            <telerik:RadGridView.Columns>
                <telerik:GridViewDataColumn DataMemberBinding="{Binding GroupByMe}" Header="Group By Me"   />
                <telerik:GridViewDataColumn DataMemberBinding="{Binding DataForEditing}" Header="Data For Editing" />
            </telerik:RadGridView.Columns>
        </telerik:RadGridView> 
```

代码背后：

```
DataTable dt = new DataTable("Row Order Checker");
dt.Columns.Add("Identifier", typeof(int));
dt.Columns.Add("GroupByMe");
dt.Columns.Add("DataForEditing");

dt.Rows.Add(1, "1", "data 1");
dt.Rows.Add(2, "1", "data 2");
dt.Rows.Add(3, "1", "data 3");

SortDescriptor sortDescriptor = new SortDescriptor();
sortDescriptor.Member = "Identifier";
sortDescriptor.SortDirection = ListSortDirection.Ascending;
gridView.SortDescriptors.Add(sortDescriptor);

gridView.ItemsSource = dt.AsDataView(); 
```

我所做的更改是：

*   引入唯一标识符列
*   在 Identifier 列上添加排序描述符
*   在 ui 上不显示标识符列

使用上面的代码，当您按“GroupByMe”列分组时，它仍然会在标识符列上排序。由于未显示标识符并且它保持不变，因此编辑的行保持原样而不改变其位置

希望这能回答你的问题。

Lohith (Tech Evangelist, Telerik India)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:51:33.393

添加一个自动增量列。还与 Group By 一起订购行，我认为您缺少 Using 语句？

# php - php mysql 在表文本区域行中插入

> ID：12059422
> 
> 赞同：0
> 
> 时间：2012-08-21T16:42:18.893
> 
> 标签：php, textarea, row, lines

我正在使用此表单将密钥一一导入数据库。如何使表单从 textarea 导入键（作为行）并将它们（作为行）保存在表格上。

这是我正在使用的代码：

HTML 代码：

```
<form action="<?php echo $editFormAction; ?>" method="post" name="form1" id="form1">
  <table align="center">
    <tr valign="baseline">
      <td nowrap="nowrap" align="right">Product Paket:</td>
      <td><select name="produktid">
        <?php
do {  
?>
        <option value="<?php echo $row_Paketa['paketaid']?>"><?php echo $row_Paketa['emripaketa']?></option>
        <?php
} while ($row_Paketa = mysql_fetch_assoc($Paketa));
  $rows = mysql_num_rows($Paketa);
  if($rows > 0) {
      mysql_data_seek($Paketa, 0);
      $row_Paketa = mysql_fetch_assoc($Paketa);
  }
?>
      </select></td>
    </tr>
    <tr valign="baseline">
      <td nowrap="nowrap" align="right">Serial Number:</td>
      <td><textarea cols="45" rows="5" name="seriali" /></textarea></td>
    </tr>
    <tr valign="baseline">
      <td nowrap="nowrap" align="right">Voucher Number:</td>
      <td><textarea cols="45" rows="5" name="kodiabonimit" /></textarea></td>
    </tr>
    <tr valign="baseline">
      <td nowrap="nowrap" align="right">&nbsp;</td>
      <td><input type="submit" value="Insert record" /></td>
    </tr>
  </table>
  <input type="hidden" name="MM_insert" value="form1" />
</form> 
```

PHP代码：

```
if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form1")) {
     $insertSQL = sprintf("INSERT INTO products (pid, produktid, seriali, kodiabonimit, data) VALUES (%s, %s, %s, %s, NOW())",
                       GetSQLValueString('', "int"),
                       GetSQLValueString($_POST['produktid'], "int"),
                       GetSQLValueString($_POST['seriali'], "text"),
                       GetSQLValueString($_POST['kodiabonimit'], "text")
                       );
  mysql_select_db($database, $ksam);
  $Result1 = mysql_query($insertSQL, $ksam) or die(mysql_error());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:40:41.780

```
if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form1")) {
$codi  = $_POST['kodiabonimit'];    
$serial = $_POST['seriali'];

$text = $codi;
$text1 = $serial;

$itemserial = explode("\n", $serial);
$itemcodi = explode("\n", $codi);

foreach(array_combine($itemcodi, $itemserial) as $text => $text1)
{
//code to insert into database 
```

# python - 关于 MySQLdb conn.autocommit(True)

> ID：12059424
> 
> 赞同：10
> 
> 时间：2012-08-21T16:42:20.110
> 
> 标签：python, mysql-python

我已经安装了 python 2.7 64bit，MySQL-python-1.2.3.win-amd64-py2.7.exe。

我使用以下代码插入数据：

```
class postcon:
    def POST(self):
        conn=MySQLdb.connect(host="localhost",user="root",passwd="mysql",db="dang",charset="utf8")  
        cursor = conn.cursor()
        n = cursor.execute("insert into d_message (mid,title,content,image) values(2,'xx','ccc','fff')")
        cursor.close()
        conn.close()
        if n:
            raise web.seeother('/') 
```

这导致将 n 打印为 1，但在 mysql 中客户端数据不可见。

谷歌说我必须添加`conn.autocommit(True)`.

但我不知道为什么 MySQLdb 将其关闭；

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-07-10T09:41:00.773

默认情况下 MySQLdb 自动提交为 false，

您可以像这样在 MySQLdb 连接中将 autocommit 设置为 True，

```
conn=MySQLdb.connect(host="localhost",user="root",passwd="mysql",db="dang",charset="utf8")
conn.get_autocommit()        #will return **False**
conn.autocommit(True)
conn.get_autocommit()        #Should return **True** now
cursor = conn.cursor() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-21T16:45:57.297

我不知道是否有特定原因将自动提交与 GAE 一起使用（假设您正在使用它）。否则，您可以手动提交。

```
class postcon:
    def POST(self):
        conn=MySQLdb.connect(host="localhost",user="root",passwd="mysql",db="dang",charset="utf8")  
        cursor = conn.cursor()
        n = cursor.execute("insert into d_message (mid,title,content,image) values(2,'xx','ccc','fff')")
        conn.commit() # This right here
        cursor.close()
        conn.close()
        if n:
            raise web.seeother('/') 
```

请注意，您可能应该检查插入是否成功，如果没有，则回滚提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-21T19:19:39.350

### [连接器/Python 连接参数](https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html)

连接数据库时可以直接开启自动提交：

```
import mysql.connector as db
conn = db.connect(host="localhost", user="root", passwd="pass", db="dbname", autocommit=True) 
```

或者

```
import mysql.connector
db = mysql.connector.connect(option_files='my.conf', autocommit=True) 
```

或打电话`conn.commit()`前打电话`close`。

# javascript - Chrome javascript调试器超时暂停，无法调试点击事件

> ID：12059427
> 
> 赞同：0
> 
> 时间：2012-08-21T16:42:34.710
> 
> 标签：javascript, debugging, google-chrome, webkit

几乎每个网页都有各种持续运行的超时和间隔，因此在 chrome 中使用暂停 javascript 按钮总是会中断这些事件，并且从未给我机会测试任何东西。

例如，我想了解当我单击页面上的某些内容时会发生什么。与其挖掘资源，不如暂停 js，单击事物，然后查看运行的代码会有所帮助。不幸的是，只要我单击暂停，它就会在页面的一个间隔事件上中断。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:29:11.957

我想你可能会发现这个小书签很有帮助……而且不仅可以在 Chrome 中使用（尽管这也是我喜欢开发的地方）

[视觉事件](http://www.sprymedia.co.uk/article/Visual+Event "视觉事件")

# paging - box v2 API 中有分页机制吗？

> ID：12059432
> 
> 赞同：0
> 
> 时间：2012-08-21T16:43:02.767
> 
> 标签：paging, box-api

我正在查看用于[检索文件夹项目](http://developers.box.com/docs/#folders-retrieve-a-folders-items)和[检索讨论评论](http://developers.box.com/docs/#dicussions-retrieve-the-discussions-comments)之类的 API，但我没有看到任何分页机制。

我错过了什么，或者他们不在那里有什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:29:19.947

[您可以在/user 端点](http://developers.box.com/docs/#users-get-all-the-users-in-an-enterprise)下看到我们的分页约定。我们还没有为任何其他端点实现这一点，但会在 v2[达到 GA](https://stackoverflow.com/a/10824276/1154983)之前实现。

# php - 文件写入错误

> ID：12059442
> 
> 赞同：0
> 
> 时间：2012-08-21T16:43:46.583
> 
> 标签：php, file

我正在使用此代码记录文件下载：

```
define('LOG_DOWNLOADS',true);
define('LOG_FILE','logs/downloads.log');

// log downloads
if (!LOG_DOWNLOADS) die();

$f = fopen(LOG_FILE, 'a+');
if ($f) {
  fputs($f, date("m.d.Y g:ia")."  ".$_SERVER['REMOTE_ADDR']."  ".$fname."\r\n");
  fclose($f);
} 
```

代码在本地输出日志文件时完美运行，例如：

```
08.21.2012 6:31pm  127.0.0.1  1.test1.mp3
08.21.2012 6:32pm  127.0.0.1  1.test2.mp3 
```

但不适用于我在 Godaddy 托管的域？现在知道为什么，也许是文件权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:48:06.297

尝试以下操作：

*   首先，去掉所有的`@`符号，这样你就可以准确地找出你得到的错误信息

*   检查是否`logs/downloads.log`存在，如果它做了什么是分配给它的权限？还建议提供完整路径`logs/downloads.log`

你可以试试这个脚本吗？我刚刚添加了更多条件检查，看看我们是否可以跟踪它导致问题的位置：

```
<?
error_reporting(E_ALL);
define('LOG_DOWNLOADS',true);
define('LOG_FILE','downloads.log');

// log downloads
if (!LOG_DOWNLOADS) die("Not logging downloads");

$f = fopen(LOG_FILE, 'a+');
if ($f) {
  if(!fputs($f, date("m.d.Y g:ia")."  ".$_SERVER['REMOTE_ADDR']."  ".$fname."\r\n"))
  {
    die("Could not write into file ". LOG_FILE);
  }
  if(!fclose($f))
  {
    die("Could not fclose file ". LOG_FILE);
  }
}
else
{
    die("Could not fopen file ". LOG_FILE);
}

die("Finished logging..");
?> 
```

# android - SCREEN_ORIENTATION_LANDSCAPE 倒置 - 为什么？

> ID：12059447
> 
> 赞同：12
> 
> 时间：2012-08-21T16:44:06.113
> 
> 标签：android, android-sensors, android-orientation

我正在使用以下代码根据用户偏好设置方向锁定：

```
 private void doLock(boolean locked) {
     if (locked) {
       int o = getResources().getConfiguration().orientation;
       if (o == Configuration.ORIENTATION_LANDSCAPE)
         setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);       
       else if (o == Configuration.ORIENTATION_PORTRAIT)
         setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);       
     } 
     else {
       setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR);
     }
 } 
```

它可以工作，除了我处于解锁模式 ( `SCREEN_ORIENTATION_SENSOR`) 且屏幕`LANDSCAPE`正确显示 (!) 的情况，然后调用`doLock(true)`并...

而不是屏幕锁定`LANDSCAPE`在其当前（正确的）横向视图中，它锁定到一个**倒置的**横向视图。即完全相同但垂直翻转（`y`变为`-y`）。

为什么会这样，我该如何解决这个问题以解决它？

我的[初步](http://android-developers.blogspot.com/2010/09/one-screen-turn-deserves-another.html)调查表明，除了常见的两个 ( , )之外还有[很多](http://developer.android.com/reference/android/R.attr.html#screenOrientation)可能性，包括但不适用于所有其他设备。`portrait``landscape``reverseLandscape`

有没有办法在所有设备中强制正确的`landscape`方向（从 切换时）？`sensor`

为了使这更清晰和更容易重现，以下是显示问题的步骤：

1.  从手机向右旋转（**顺时针**）开始，处于解锁模式（`SCREEN_ORIENTATION_SENSOR`），屏幕`LANDSCAPE`正确显示（！），
2.  然后调用`doLock(true)`
3.  `LANDSCAPE`它不是锁定在当前（正确的）横向视图中的屏幕，而是锁定到**倒置的**横向视图。即完全相同但垂直翻转（`y`变为`-y`）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T17:20:08.247

尝试以下通过代码禁用和启用方向（这将在 API 级别 7 及更高级别中工作）：

```
public static void disableRotation(Activity activity) {
    final int orientation = activity.getResources().getConfiguration().orientation;
    final int rotation = activity.getWindowManager().getDefaultDisplay()
            .getOrientation();

    // Copied from Android docs, since we don't have these values in Froyo
    // 2.2
    int SCREEN_ORIENTATION_REVERSE_LANDSCAPE = 8;
    int SCREEN_ORIENTATION_REVERSE_PORTRAIT = 9;

    if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.FROYO) {
        SCREEN_ORIENTATION_REVERSE_LANDSCAPE = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE;
        SCREEN_ORIENTATION_REVERSE_PORTRAIT = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT;
    }

    if (rotation == Surface.ROTATION_0 || rotation == Surface.ROTATION_90) {
        if (orientation == Configuration.ORIENTATION_PORTRAIT) {
            activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        } else if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
            activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
        }
    } else if (rotation == Surface.ROTATION_180
            || rotation == Surface.ROTATION_270) {
        if (orientation == Configuration.ORIENTATION_PORTRAIT) {
            activity.setRequestedOrientation(SCREEN_ORIENTATION_REVERSE_PORTRAIT);
        } else if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
            activity.setRequestedOrientation(SCREEN_ORIENTATION_REVERSE_LANDSCAPE);
        }
    }
}

public static void enableRotation(Activity activity) {
    activity.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-11-07T01:11:52.657

**简单实用>**

```
 <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

    <activity
        android:screenOrientation="sensorLandscape"
    </activity>

  </application> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-21T19:14:06.917

您所描述的不是错误，而是 Android 2.2 或更低版本的预期行为。

@forgivegod 提供了一种理论上正确的方法，除了对于 Android 2.2 或更低版本，即使是伪造的，也无法识别`screenOrientation.reverseLandscape`and`screenOrientation.reversePortrait`值（就像 @forgivegod 的代码一样）。

我敢打赌，当您顺时针旋转手机（旋转 = 3）而不是逆时针旋转（旋转 = 1）时，您会看到这个问题。

尝试使用 Android 2.3 或更高版本，看看会发生什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-21T16:51:04.560

尝试通用横向

```
private static final int ORIENTATION_90 = 1;
private static final int ORIENTATION_0 = 0;
private static final int ORIENTATION_180 = 2;
private static final int ORIENTATION_270 = 3;

switch (orientation)
    {
      default:
      case ORIENTATION_0: // Portrait
        //dostuff
        break;
      case ORIENTATION_90: // Landscape left
        //do stuff
        break;
      case ORIENTATION_180: // Upside down.
        //do stuff
        break;
      case ORIENTATION_270: // Landscape right
        //do stuff
        break;
      } 
```

# iphone - Xcode 保存：home vs stop 模拟器

> ID：12059451
> 
> 赞同：0
> 
> 时间：2012-08-21T16:44:21.267
> 
> 标签：iphone, database, xcode, sqlite, ios-simulator

当我按下播放然后在 Xcode 中停止时，我的代码将保存到我的 sqlite3 数据库中。但是，当我按播放然后按停止而不是按停止时，它不会保存。每次测试保存功能时，我都会打开终端并检查派生数据中的数据库。我没有任何代码：

`(void)applicationDidEnterBackground:(UIApplication *)application`

我也没有任何代码：

`(void)applicationWillTerminate:(UIApplication *)application`.

当用户按下按钮时，我直接保存到数据库中。模拟器中的主页按钮和 Xcode 中的停止按钮有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:32:39.380

Home 按钮将**最小化您的应用程序**（将调用 applicationDidEnterBackground）并按下停止按钮**终止您的应用程序**。通过快速双击主页按钮，您可以通过点击其中一个应用程序图标来查看最小化的应用程序，这将使您的应用程序从后台状态再次处于活动状态。

# c# - 使用 vb 返回 IEnumerable 时，Asp.net 4.5 模型绑定损坏？

> ID：12059456
> 
> 赞同：5
> 
> 时间：2012-08-21T16:44:41.883
> 
> 标签：c#, asp.net, vb.net, asp.net-4.5

我有一个gridview如下：

```
<asp:GridView ID="gv" runat="server" SelectMethod="gv_GetData" AllowPaging="true" AllowSorting="true" AutoGenerateColumns="true">
</asp:GridView> 
```

我在 c# 中有以下代码有效：

```
public IList<string> gv_GetData(int maximumRows, int startRowIndex, out int totalRowCount, string sortByExpression)
{
    List<string> l = GetTestData();
    totalRowCount = l.Count;
    return l;
}

private List<string> GetTestData()
{
    List<string> l = new List<string>();
    l.Add("a");
    l.Add("b");
    l.Add("c");
    return l;
} 
```

现在，在VB中我有：

```
Public Function gv_GetData(maximumRows As Integer, startRowIndex As Integer, ByRef totalRowCount As Integer, sortByExpression As String) As IList(Of String)
    Dim l As List(Of String) = GetTestData()
    totalRowCount = l.Count
    Return l
End Function

Private Function GetTestData() As List(Of String)
    Dim l As New List(Of String)()
    l.Add("a")
    l.Add("b")
    l.Add("c")
    Return l
End Function 
```

VB版总是产生如下错误：

> 当 DataBoundControl 启用分页时，SelectMethod 应该返回一个 IQueryable 或者应该具有所有这些强制参数：int startRowIndex、int maximumRows、out int totalRowCount

这可能是一个框架错误吗？还是我错过了一些过于明显的东西？

* * *

由下面的 nemesv 回答。新方法是：

```
Public Function gv_GetData(maximumRows As Integer, startRowIndex As Integer, <System.Runtime.InteropServices.Out()> ByRef totalRowCount As Integer, sortByExpression As String) As IList(Of String)
    Dim l As List(Of String) = GetTestData()
    totalRowCount = l.Count
    Return l
End Function 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T17:08:40.440

您需要`totalRowCount`用[OutAttribute标记](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.outattribute.aspx#Y1866)

```
<Out()> ByRef totalRowCount As Integer 
```

这在语义上与 c#`out`关键字等效。

# spring - spring 是否在内部对需要加载的属性引用执行 getBean？

> ID：12059458
> 
> 赞同：1
> 
> 时间：2012-08-21T16:44:54.647
> 
> 标签：spring

当我想在 main 方法中说一个 bean 时，我会在 id 上请求一个 getBean。当我们将属性定义为单个 bean 中其他 bean 的引用时，spring 容器是否会做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:31:16.763

> 当我们将属性定义为单个 bean 中其他 bean 的引用时，spring 容器是否会做同样的事情

最终是的，Spring 确实在应用程序容器中找到了与您的 bean 定义匹配的 bean。它是如何工作的，这对大多数用户来说不应该是太多关注的事情。因为通常知道如果你从 Spring 请求一个 bean 就足够了，它会与它的所有依赖项连接起来。

如果您对确切的接线机制感兴趣，源代码是学习的地方。

# gcc - 在 i686-w64-mingw32msvc/Linux 上检测 winsock

> ID：12059463
> 
> 赞同：2
> 
> 时间：2012-08-21T16:45:24.747
> 
> 标签：gcc, cross-compiling, autotools, winsock2

我有一个带有配置脚本的程序，我想在 Linux for Windows 上交叉编译。在 Ubuntu 11.10 中，我在 configure.in 中有这两行：

```
AC_CHECK_HEADERS(winsock2.h)
AC_CHECK_LIB([ws2_32], [_head_libws2_32_a]) 
```

这能够正确检测到正在为 Windows 交叉编译的东西，并将 winsock 添加到要链接的库列表中。

现在在 Ubuntu 12.04 上 i586-mingw32msvc 已被 i686-w64-mingw32msvc 所取代，这不再起作用。没有检测到标头和库（尽管至少有标头）。谁能指出我在 i686-w64-mingw32msvc/ubuntu 12.04 上检查 winsock 的正确方法？

# javascript - 防止从浏览器到应用商店的不需要的重定向

> ID：12059464
> 
> 赞同：1
> 
> 时间：2012-08-21T16:45:25.427
> 
> 标签：javascript, ios, mobile-safari

我一直在研究位于广告和应用商店之间的重定向页面。广告作为指向重定向页面的静态 URL 存在。重定向页面向第三方发送 ajax 请求，设置 cookie，然后重定向到 AppStore。一切都很好，并不少见。

重定向页面无法自行关闭，因此它在 Safari 中保留为选项卡。我遇到的问题是，如果页面已从缓存中清除，当用户返回 Safari 时，Safari 将重新加载它以触发重定向。我不希望用户意外地进入 AppStore。

一种解决方案是检查 cookie 是否存在，如果存在则不重定向，但这会留下用户点击另一个横幅广告而没有获得适当重定向的极端情况。我尝试在 URL 上附加一个锚点，以防止用户启动刷新，但 Safari 的自动刷新机制不尊重以编程方式添加的哈希。

如果我可以使用动态源来生成将用户定向到页面的 URL，我可以生成时间戳，但现在原始 URL 是静态的。有没有人有使用客户端代码的解决方案？或者这真的只能使用服务器端解决方案来解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T23:47:44.433

我最终选择进行两阶段重定向。用户单击横幅并被定向到：

```
http://myserver.example.com?someKey=someValue 
```

我有一个功能可以做到这一点：

```
// Do I have a visited param?
if ($.url(window.location.href).param('visited') === '1') {
    // Do I have a visited cookie?
    if (helper.retrieveCookie('VISITED') == undefined) {
        console.log('Setting visited cookie');
        helper.storeCookie('VISITED', '1');
        return 1; // Redirect to AppStore.
    }
    // Have param and cookie
    console.log('VISITED cookie set');
    console.log('Refreshed');
    return 2; // Don't redirect.
} else {
    // No param
    helper.removeCookie('VISITED');
    return 0; // Redirect to self with &visited=1
} 
```

所以基本上我们将有意义地通过代码两次，随后由于刷新而 N 次。在第一次通过时，我们执行 AJAX 请求，然后使用添加的参数重定向到我们自己。在第二遍中，我们设置了一个 cookie 并重定向到 AppStore。页面的任何后续加载都将具有 cookie 和参数，并且不会重定向。新的横幅点击将没有参数，因此它们将正常执行。

这不是最漂亮的解决方案，因为我们必须重新加载我们的重定向页面，但由于它的内容应该被缓存，所以命中应该是最小的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:58:03.237

在登录页面上添加 javascript 怎么样？

```
if (history.length < 2) 
  history.back();
else
  location.href = '/thankyoufordownloading.htm'; 
```

我自己没有测试过，但它可以工作。

# php - php复制其他文件夹中的文件

> ID：12059465
> 
> 赞同：0
> 
> 时间：2012-08-21T16:45:26.267
> 
> 标签：php, duplicates

有没有办法我可以使用 php 使根文件看起来也像它在其他文件夹中一样。

例如，我在根文件夹中有 index.php，我希望它在我访问 index.php 时也能像它在所有文件夹和子文件夹中的行为一样

当我执行 index.php 时，它也会在所有文件夹和子文件夹中执行

**请通过以下示例了解我的问题**

index.php 在根目录中，我在根目录中也有不同的文件夹，所以当我通过浏览器访问 index.php 时，它也会在其他文件夹中执行

```
http://mysite.com/index.php will also behave as if its in sub folder too
http://mysite.com/folder1/index.php
http://mysite.com/folder2/index.php
http://mysite.com/folder3/index.php 
```

index.php 不在这些文件夹中，但它也必须同时在这些文件夹中执行

我认为通过上面的例子不难理解。请相应地回答

**更新 2**

这是 index.php 代码

它扫描文件夹“files”“images”“txt”“related”并获取每个文件夹中的文件，然后写入includes.php（在根目录中）

```
$path = array("./files/","./images/","./txt/","./related/");

$path2= array("http://".$_SERVER['SERVER_NAME'].dirname($_SERVER["PHP_SELF"])."/files/","http://".$_SERVER['SERVER_NAME'].dirname($_SERVER["PHP_SELF"])."/images/","http://".$_SERVER['SERVER_NAME'].dirname($_SERVER["PHP_SELF"])."/txt/","http://".$_SERVER['SERVER_NAME'].dirname($_SERVER["PHP_SELF"])."/related/");

$start="";

$Fnm = "./include.php";

$inF = fopen($Fnm,"w");

fwrite($inF,$start."\n");

    $folder = opendir($path[0]);

    while( $file = readdir($folder) ) {

           if (($file != '.')&&($file != '..')&&($file != 'index.htm')) {

                $folder2 = opendir($path[1]);

                $folder3 = opendir($path[2]);
                $folder4 = opendir($path[3]);

                $imagename ='';

                $txtname ='';
                $related ='';

                while( $file2 = readdir($folder2) ) {

                    if (substr($file2,0,strpos($file2,'.')) == substr($file,0,strpos($file,'.'))){

                        $imagename = $file2;

                    }

                }
while( $file4 = readdir($folder4) ) {

                    if (substr($file4,0,strpos($file4,'.')) == substr($file,0,strpos($file,'.'))){

                        $related = $file4;

                    }

                }

while( $file3 = readdir($folder3) ) {

if (substr($file3,0,strpos($file3,'.')) == substr($file,0,strpos($file,'.'))){

                        $txtname = $file3;

                        $fh = fopen("/home3/socialb8/public_html/mysite.info/player/txt/$txtname", 'r');

                        $theData = fread($fh, filesize("/home3/socialb8/public_html/mysite.info/player/txt/$txtname"));

                        fclose($fh);

                    }

                }

                closedir($folder2);

                closedir($folder3);
                closedir($folder4);

            $result="{\nlevels: [\n{ file: \"$path2[0]$file\" }\n],\nimage: \"$path2[1]$imagename\",\ntitle: \"$file\",\ndescription: \"$theData\",\n 'related.file':'$path2[3]$related'\n},\n";

            fwrite($inF,$result);

           }

    }

    fwrite($inF,"");

    closedir($folder);

fclose($inF); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:08:09.263

如果您需要循环浏览目录并查看每个目录是否包含`$path`数组中列出的目录之一，您可以使用以下内容：

```
function readDirs()
{
    $path=array('images','etc...');
    $dirHandle = opendir('./');
    while($file = readdir($dirHandle))
    {
        if(is_dir($file) && $file != '.' && $file != '..')
        {
            $dirHandle2 = opendir($file);
            while($file2 = readdir($dirHandle2))
            {
                if(in_array($file2,$path))
                {
                    // do what you need to do
                }
            }
        }
    }
}
readDirs(); 
```

这将遍历根文件夹中的所有目录，并查看它们是否包含`$path`数组中列出的目录，如果是，您可以在`// do what you need to do`语句中弹出代码。

希望有帮助！

# git - Git Post-Receive Hook 未激活

> ID：12059475
> 
> 赞同：1
> 
> 时间：2012-08-21T16:46:05.277
> 
> 标签：git

我的 EC2 Amazon Linux 开发服务器上有一个 git 存储库。我正在使用 SSH 从笔记本电脑上的本地 git 存储库推送更改。

我已确认推送工作正常，因为我的本地 repo 的内容已镜像到开发服务器上。但是，我的接收后挂钩似乎没有触发。因为代码没有被检出到我的 html 目录中。

我什至尝试放置一个 echo 命令以至少确认钩子正在触发，但除了本地端的推送结果外，命令行中没有反馈。

```
#!/bin/sh
#
# An example hook script for the "post-receive" event.
#
# The "post-receive" script is run after receive-pack has accepted a pack
# and the repository has been updated.  It is passed arguments in through
# stdin in the form
#  <oldrev> <newrev> <refname>
# For example:
#  aa453216d1b3e49e7f6f98441fa56946ddcd6a20 68f7abf4e6f922807889f52bc043ecd31b7$
#
# see contrib/hooks/ for a sample, or uncomment the next line and
# rename the file to "post-receive".

#. /usr/share/git-core/contrib/hooks/post-receive-email
GIT_WORK_TREE=/var/www/html sudo git checkout -f 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:08:21.997

`sudo`可能不会保留`GIT_WORK_TREE`环境变量 - 它通常被配置为为其运行的命令提供经过清理的环境，尤其是当它们以`root`. `git`有一些命令行参数（特别是）可以完成`--git-dir`与`--work-tree`环境变量相同的事情。在这种情况下，您可能需要使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T22:15:45.160

我不知道这是否可以帮助您解决云服务器问题，但我必须手动编辑 /etc/fstab 文件。我的 /srv/git 文件夹被符号链接到一个硬盘驱动器，该硬盘驱动器是通过 fstab 文件使用“noexec,user”命令安装的。将其更改为“默认值”终于解决了我的问题。我花了8个小时才弄明白。你也可以试试

```
$cd /path/to/.git/hooks
$sudo chown git:git post-receive 
```

用于接收后文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:22:47.237

试试这个：

1.  不要忘记带有 --shared 选项的 init repo：

    $ git init --shared --bare repo/html.git

    $ sudo chgrp -R git repo/html.git

    $ sudo usermod -a -G git www-data

2.  将 Git 用户添加到 sudoers（允许 www-data 用户不通过）：

    $ sudo visudo

    默认值：git !authenticate

    git ALL=(www-data) NOPASSWD: /usr/bin/git

3.  我们的单行 post-receive hook：

    sudo -u www-data git --git-dir=/home/git/repo/html.git/ --work-tree=/var/www/html checkout -f

# javascript - 从函数返回数组

> ID：12059478
> 
> 赞同：34
> 
> 时间：2012-08-21T16:46:10.540
> 
> 标签：javascript, arrays, function

——由 Elliot B 解决。谢谢！也可以考虑其他修改。

这是结果。谢谢大家，快速解答！[http://dl.dropbox.com/u/18785762/Rust/index.html](http://dl.dropbox.com/u/18785762/Rust/index.html)

我正在用 javascript 编写游戏，我想将用于匹配块 ID 的文件保存在地图编译器的单独 .js 文件中，以便我可以轻松地编辑内容。但是，ID 存储在一个数组中，我似乎无法让它正确使用返回函数。有什么帮助吗？

drawmap.js：

```
function drawmap() {

    var images = BlockID();

    var level = [
    "ssssssssssssssssssssss",
    "sgggggggggCCCCCdddddss",
    "ssssssssss     sssssss"
    ];

    var top = 100;
    var left = 100;
    var mytop = top;
    var myleft = left;
    for (y=0; y<level.length; ++y) {
        var row = level[y];
        for (x=0; x < row.length; ++x) {
            var c = row.charAt(x);
            if(c != ' ') {
                img_create(images[c], mytop, myleft);
            }
            mytop += 13;
            myleft += 27;
        }
        mytop = top + (y+1)*13;
        myleft = left - (y+1)*27;
    }
} 
```

mapread.js：

```
function BlockID() {
    var IDs = new Array();
        images['s'] = "Images/Block_01.png";
        images['g'] = "Images/Block_02.png";
        images['C'] = "Images/Block_03.png";
        images['d'] = "Images/Block_04.png";
    return IDs;
} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-21T16:48:25.720

至少，改变这个：

```
function BlockID() {
    var IDs = new Array();
        images['s'] = "Images/Block_01.png";
        images['g'] = "Images/Block_02.png";
        images['C'] = "Images/Block_03.png";
        images['d'] = "Images/Block_04.png";
    return IDs;
} 
```

对此：

```
function BlockID() {
    var IDs = new Object();
        IDs['s'] = "Images/Block_01.png";
        IDs['g'] = "Images/Block_02.png";
        IDs['C'] = "Images/Block_03.png";
        IDs['d'] = "Images/Block_04.png";
    return IDs;
} 
```

有几个修复需要指出。**首先**，`images`未在您的原始函数中定义，因此为其分配属性值将引发错误。我们通过更改`images`为 来纠正这一点`IDs`。**其次**，你想返回一个`Object`，而不是一个`Array`。可以为对象分配类似于关联数组或哈希的属性值——数组不能。所以我们改变`var IDs = new Array();`to的声明`var IDs = new Object();`。

在这些更改之后，您的代码将运行良好，但可以**进一步简化**。您可以使用速记表示法（即对象文字属性值速记）来创建对象并立即返回它：

```
function BlockID() {
    return {
            "s":"Images/Block_01.png"
            ,"g":"Images/Block_02.png"
            ,"C":"Images/Block_03.png"
            ,"d":"Images/Block_04.png"
    };
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-21T16:52:22.833

您的`BlockID`函数使用未定义的变量`images`，这将导致错误。此外，您不应该在`Array`此处使用 - JavaScript 键值映射是普通对象：

```
function BlockID() {
    return {
        "s": "Images/Block_01.png",
        "g": "Images/Block_02.png",
        "C": "Images/Block_03.png",
        "d": "Images/Block_04.png"
    };
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-21T16:51:29.270

更整洁：

```
function BlockID() {
  return {
    "s":"Images/Block_01.png",
    "g":"Images/Block_02.png",
    "C":"Images/Block_03.png",
    "d":"Images/Block_04.png"
   }
} 
```

要不就

```
var images = {
  "s":"Images/Block_01.png",
  "g":"Images/Block_02.png",
  "C":"Images/Block_03.png",
  "d":"Images/Block_04.png"
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-18T09:30:05.777

考虑到在 JavaScript 中数组也是对象，这可以写成：

```
function BlockID() {
    return new Array(
        "Images/Block_01.png", 
        "Images/Block_02.png", 
        "Images/Block_03.png", 
        "Images/Block_04.png" 
       );
    } 
```

此代码将在浏览器窗口中显示数组的内容

```
window.onload=function(){
var s="";
var ar = BlockID(); //function return array
for(el in ar){
    s+=ar[el]+"</br>";
}
document.body.innerHTML=s; 
}; 
```

# java - 如何使用stuts2在jsp中显示保存在耳朵外的上传图像

> ID：12059479
> 
> 赞同：0
> 
> 时间：2012-08-21T16:46:13.117
> 
> 标签：java, jakarta-ee, struts2

在我的项目中，用户上传图像文件，这些文件保存在驱动器的上下文根目录之外。我需要在 jsp 中显示这些图像。我用struts2。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:06:11.530

看看这个[教程](http://www.mkyong.com/struts2/struts-2-dynamic-image-example/)。我认为这正是您正在寻找的。

**编辑**：

这个想法是告诉动作你想要什么图像。这是在请求中添加参数完成的。例如，在示例中，它使用参数`imageId`，但您可以更改此策略并使用不同的东西，例如图像名称。然后你应该以这种方式调用动作（根据教程）：

```
http://localhost:8080/myAppContext/ImageAction?imageId=darksouls.jpg 
```

另外，请记住@Dave Newton 的评论是一个很好的选择。请参阅this other [example](http://www.mkyong.com/struts2/struts-2-download-file-example/)。

# php - 将数据从php导出到excel

> ID：12059480
> 
> 赞同：0
> 
> 时间：2012-08-21T16:46:34.357
> 
> 标签：php

> **可能重复：**
> [从 PHP 导出到 Excel](https://stackoverflow.com/questions/4005814/export-from-php-to-excel)

我需要将从mysql数据库检索到的数据导出到excel。在导出到 Excel 之前，我需要对我的数据进行一些更改。我真的不明白我应该如何开始。

我应该去 PEAR 吗？或任何其他类库？或任何简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:48:00.893

您可以使用[phpexcel](http://phpexcel.codeplex.com/)库。它允许您写入和读取不同的电子表格文件格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:50:59.910

您可以阅读**[如何从 MySQL 生成完整的 Excel 电子表格](http://net.tutsplus.com/tutorials/php/how-to-generate-a-complete-excel-spreadsheet-from-mysql/)**并**[使用 PHP 读写 Excel 数据](http://www.ibm.com/developerworks/opensource/library/os-phpexcel/)**。

希望这可以帮助。

# windows - 将linux的剪贴板复制到网络中的windows剪贴板中

> ID：12059485
> 
> 赞同：0
> 
> 时间：2012-08-21T16:46:51.730
> 
> 标签：windows, linux, ssh, clipboard

我正在编写一个小工具，将 linux 的剪贴板复制到 Windows 剪贴板中。让我举个例子，网络连接中的linux和windows。我将 linux 中的某些内容复制到剪贴板，然后当我在 windows 中按下某些键时，让 CTRL+ALT+v 在 linux 中复制的内容应该在 linux 中打印。

我的想法是通过 ssh 连接在 linux 中执行一些脚本。该脚本应将剪贴板复制到 windows 中的某个文件中，然后 windows 应将文件内容放入 windows 剪贴板。

我的问题是从 Windows 连接 linux 并执行脚本。我怎样才能做到这一点？

如果您有更好的想法，请分享。

非常感谢 ：）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:56:38.353

[有一个名为Synergy](http://synergy-foss.org/)的免费、跨平台、开源程序，它完全符合您的描述（以及更多），我已经使用 Windows/Linux 连接对其进行了测试。您可以查看源代码并了解剪贴板功能是如何实现的，或者它可能已经满足您的需求。

# jquery - 选择元素仅显示第一个字符

> ID：12059486
> 
> 赞同：1
> 
> 时间：2012-08-21T16:46:52.913
> 
> 标签：jquery, html, internet-explorer-9

我有一个在 ajax 调用中填充了 jquery 的 select html 元素。一切似乎都很好，但在 IE9 中，选择框只显示文本的第一个字符。

这是重现行为的de jsfiddle：

[http://jsfiddle.net/PjDfS/](http://jsfiddle.net/PjDfS/)

我知道这里问了同样的问题[<select> 只显示所选选项的第一个字符](https://stackoverflow.com/questions/5908494/select-only-shows-first-char-of-selected-option)，但该解决方案在我的情况下不起作用。( [http://jsfiddle.net/PjDfS/2/](http://jsfiddle.net/PjDfS/2/) )

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T21:42:32.780

最后，工作代码：

[http://jsfiddle.net/PjDfS/5/](http://jsfiddle.net/PjDfS/5/)

我做了什么？最后，我回到旧的帖子答案并稍微改变我的第一种方法。

为了更清楚，将原始选择保留为“显示：无”，最后删除该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T20:10:59.487

我不知道为什么，但这种方式似乎有效：

[http://jsfiddle.net/PjDfS/4/](http://jsfiddle.net/PjDfS/4/)

另外，我不确定代码是否完全等效。无论如何它到目前为止工作......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:15:12.370

我认为IE9的问题在于

```
var messageFieldInput = $('#MessageFieldInputTemplate > .messageField-input').clone() 
```

这里 ：

```
var testObj = [];
testObj[0] = {
    text: 'description 1',
    value: 'value 1'
};
testObj[1] = {
    text: 'description 2',
    value: 'value 2'
};

$.get('/echo/json', function (data) {
    var messageFieldInput = $('#MessageFieldInputTemplate > .messageField-input'); //no .clone()
    $('#MessageFieldContainer').append(messageFieldInput);
    messageFieldInput.find('.editor-label').text('Label');

    $.get('/echo/json', function (data) {
        var fieldSelect = messageFieldInput.find('.editor-field > select');            

        $.each(testObj , function (index, item) {
            fieldSelect.append(
                $('<option/>', {
                    'value':item.value,
                    'text':item.text
})
            );
        });
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T17:15:25.147

尝试在标记内添加一个`option`，`select`然后使用脚本将其删除。

看起来这样一个选项的文本以某种方式“分配”了水平空间，并且您将无法获得不再正确显示的 ajax 填充文本。

更新：刚刚尝试过，但它更复杂.. 仅在您保留原始选项之前有效:(

# php - 在 Heroku 上使用 PHP 时如何设置静态资产缓存控制标头？

> ID：12059488
> 
> 赞同：1
> 
> 时间：2012-08-21T16:46:56.050
> 
> 标签：php, caching, heroku, http-headers

这值得尝试完成还是我应该将资产移动到 CloudFront（或其他一些 CDN）？

根据过去的经验，我对这个项目是否走 CDN 路线感到犹豫。我尝试使用 rake 任务来缩小和连接我的资产，然后将它们上传到 CloudFront。但是，当我部署项目（现在包含 rake 任务）时，Heroku 决定我的应用程序现在是 ROR 而不是 PHP，并且应用程序是 toast。

# powershell - Powershell 获取顶级父文件夹

> ID：12059493
> 
> 赞同：1
> 
> 时间：2012-08-21T16:47:20.167
> 
> 标签：powershell

我的最终目标是获取在最后一天修改了文件的顶级文件夹列表（对于给定路径）。

可能有很多方法可以做到这一点。我遇到问题的地方只是获取顶级文件夹。

这是我到目前为止所拥有的：

```
Get-ChildItem -Path "c:\data\*" -recurse | 
where-object {$_.lastwritetime -gt (get-date).addDays(-1)} |  
where-object {-not $_.PSIsContainer} | 
Foreach-Object { $_.DirectoryName} | 
sort -unique 
```

它获取所有目录，而不仅仅是顶级目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:56:22.837

这就是我将如何做到的

```
$dirs = dir "sometoplevelpath" |?{ $_.PsIsContainer }
$oneDayAgo = (Get-Date).AddDays(-1)

$dirs |?{ dir $_ -Recurse |?{!$_.PsIsContainer -and $_.LastWriteTime -gt $oneDayAgo } | select -first 1 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:45:23.970

您可以获取最终使用的文件夹列表，并比较它们的完整路径（不包含它们的名称），看看它是否与包含您感兴趣的文件夹的目录匹配：

```
$folders | Where-Object {$_.FullName.Replace($_.Name,"") -eq $superDirectory} 
```

其中 $superdDirectory 是包含“顶级目录”的目录的名称。在这种情况下，这听起来像“C:\”。

您还可以调查 PSParentPath 属性。

另一种方法是首先列出潜在的备份文件夹：

```
$targetFolders = Get-Item -Path "C:\data*" | Where-Object {$_.PSIsContainer} 
```

然后浏览该列表以查看他们是否有任何需要备份的项目，如果有，请采取行动。

```
$targetFolders | % {
    $folderItems = Get-ChildItem $_.FullName | ? {.... use your filter here}
    if (($folderItems | Measure-Object).Count -gt 0){
        #Backup the folder, or add $_.FullName to the list of folders that should be backed up.
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T18:01:57.640

尝试删除`-recurse`

```
Get-ChildItem -Path "c:\data*" | where-object {$_.lastwritetime -gt (get-date).addDays(-1)} | where-object {-not $_.PSIsContainer} | Foreach-Object {$_.DirectoryName} | sort -unique 
```

我也将其更改`$.`为`$_.`. 看看这是否有效。我得到它只给我顶级目录名称，但我没有任何可以作为模式运行的东西`"c\data*"`

# objective-c - 我需要有关并发模式下 NSOperation 中的线程的信息

> ID：12059495
> 
> 赞同：0
> 
> 时间：2012-08-21T16:47:27.580
> 
> 标签：objective-c, multithreading, concurrency, nsoperation, nsoperationqueue

我在并发模式下的 NSOperation 中有一个 NSURLConnection asynchrone。我知道默认情况下， NSOperationQueue 为 NSOperation 创建线程（非并发）。但是，在并发情况下，这是否意味着我在另一个线程中有一个线程？如果是，这是一个好习惯吗？

（一个例子：[http](http://www.dribin.org/dave/blog/archives/2009/05/05/concurrent_operations/) ://www.dribin.org/dave/blog/archives/2009/05/05/concurrent_operations/ ）

谢谢你:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:28:55.030

Dribin 的代码中存在一些错误，这些错误在一个[探索并发操作](https://github.com/dhoerl/Concurrent_NSOperations)的项目和一个较小的[轻量级并发 web fetcher](https://github.com/dhoerl/NSOperation-WebFetches-MadeEasy)中得到了解决。这里发生的是操作队列创建和管理一个或多个线程。NSURLConnection 使用单个线程 - 它不会创建另一个线程。所以这个模型实际上只消耗了一个线程。

# ios - 核心数据 NSNumber 矫枉过正？

> ID：12059497
> 
> 赞同：2
> 
> 时间：2012-08-21T16:47:31.120
> 
> 标签：ios, core-data, nsnumber

我应该使用 NSNumber 还是字符串来保存一个简单的“playerID 号”，现在它是一个整数，因为我想用 Core Data 保存它？

在我的数据模型中，我将 playerID 设置为 Integer 16，但 Core Data 希望 NSNumber 能够正常工作。这似乎是很多“无”的代码 - 示例；

```
NSInteger myValue = 1;
NSNumber *number = [NSNumber numberWithInteger:myValue];
p1.playerID = number;

// Instead of just;
p1.playerID = 1;
// or
p1.playerID.myIntValue; 
```

只是想知道将其设置为字符串然后根据需要来回转换值（playerID）是否更容易？对此有何智慧（经验）？谢谢 ：-）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T20:08:22.947

在您的实体上，定义`@property`如下：

```
@property (nonatomic) int32_t playerID; 
```

然后你就可以简单地设置它

```
p1.playerID = 1; 
```

这是非常优雅且非常快速的。

换句话说，不要将其定义为`NSNumber *`. 但即使你这样做了，性能仍然很出色。像这样阅读和编写代码更容易。另请注意，对于最新的 Xcode 版本，您可以`@(myInt)`使用`[NSNumber numberWithInt:myInt]`.

确保还检查如何将其用于枚举：[Best way to implement Enums with Core Data](https://stackoverflow.com/questions/1624297/best-way-to-implement-enums-with-core-data/13224056#13224056)（寻找我的答案）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:23:59.377

NSNumber 比 NSString 更有效地将值存储在内存中。因为 NSNumber 使用称为标记指针的运行时工具来提高速度并减少内存使用（[查看更多信息](http://www.mikeash.com/pyblog/friday-qa-2012-07-27-lets-build-tagged-pointers.html)）

另外我认为 NSNumber 在 CoreData 中占用的空间比 NSString 少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:52:34.623

在使用 Xcode 创建 NSManagedObject 文件时，您可以使用原始值生成属性。但是，您应该知道 NSNumber 是一个抽象类，运行时类类型将取决于用于创建 NSNumber 的值。

# javascript - 我可以获取使用 Ajax 调用的函数的返回码吗

> ID：12059502
> 
> 赞同：-3
> 
> 时间：2012-08-21T16:47:39.793
> 
> 标签：javascript, jquery, ajax, http-status-codes

> **可能重复：**
> [无法从 jQuery Ajax 调用中获得正确的返回值](https://stackoverflow.com/questions/3537434/cant-get-correct-return-value-from-an-jquery-ajax-call)

这是我之前问题的延伸：

我可以检查使用 Ajax 调用的函数的返回码，如下所示：

```
rc =  submitHandler($link, $modal);

function submitHandler($link, $modal) {

           $.ajax({
                url: oSubmit.href,
                dataType: 'json',
                type: 'POST',
                data: $form.serializeArray()
            })
            .done(function (json, textStatus, XMLHttpRequest) {
                json = json || {};
                if (json.success) {
                    submitSuccessModal(oSubmit, json);
                    return true;  <---------------------------------------
                } else {
                    submitFailModal(oSubmit, json);
                    return false;  <--------------------------------------
                }
                return false;
            })

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T16:51:39.240

可以为每个状态码分别添加一个功能块

```
$.ajax({
  statusCode: {
    404: function() {
      alert("page not found");
    },
    500: function() {
      alert("internal server error")
    },
    ...
  }
}); 
```

# java - Log4j 记录器和并发

> ID：12059503
> 
> 赞同：4
> 
> 时间：2012-08-21T16:47:45.740
> 
> 标签：java, concurrency, singleton, log4j

在单例类中有一个 org.apache.log4j.Logger 字段可以吗？由于在多个线程之间共享它可能是任何并发问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:49:25.987

不，不会有任何问题，因为它是线程安全的（即，如果多个线程同时访问它，它不会中断）。

见[http://logging.apache.org/log4j/1.2/faq.html#a1.7](http://logging.apache.org/log4j/1.2/faq.html#a1.7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:49:38.290

不，一个 Logger 对象可以被多个线程使用，你遇到什么问题了吗？

# ajax - 选择另一个的特定选项时禁用一个下拉菜单

> ID：12059504
> 
> 赞同：0
> 
> 时间：2012-08-21T16:47:51.800
> 
> 标签：ajax, drop-down-menu, jsf-2, primefaces

我在一种形式中有两个下拉菜单。第一个包含这些选项：

```
String[] decisions = {"acceptée", "rejettée"}; 
```

When "rejettée" is selected, I would like to disable the second dropdown.

这是两个下拉菜单的相关代码：

```
<p:selectOneMenu required="true" requiredMessage="veuillez choisir une decision" id="dec" value="#{editCommandController.myCom.decision}">  
    <f:selectItems value="#{editCommandController.decisions}" />            
</p:selectOneMenu>  
<p:selectOneMenu  id="etat" value="#{editCommandController.myCom.etat}">  
    <f:selectItems value="#{editCommandController.etats}" />   
</p:selectOneMenu> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:28:43.990

试试这个：

```
<h:outputLabel for="dec" value="Decision : " />
    <p:selectOneMenu required="true"
        requiredMessage="veuillez choisir une decision" id="dec"
        value="#{editCommandController.myCom.decision}">
        <f:selectItems value="#{editCommandController.decisions}" />
        <p:ajax update="etat" event="change"/>
    </p:selectOneMenu>
    <p:message for="dec" display="icon" />

    <h:outputLabel for="etat" value="Etat : " />
    <p:selectOneMenu id="etat" value="#{editCommandController.myCom.etat}" disabled="#{editCommandController.myCom.decision eq 'rejettée'}">
        <f:selectItems value="#{editCommandController.etats}" />
    </p:selectOneMenu>
    <p:message for="etat" display="icon" /> 
```

要在更改时设置一些默认值，请尝试以下操作：

```
<h:outputLabel for="dec" value="Decision : " />
<p:selectOneMenu required="true"
    requiredMessage="veuillez choisir une decision" id="dec"
    value="#{editCommandController.myCom.decision}" valueChangeListener="#{editCommandController.vclistener}">
    <f:selectItems value="#{editCommandController.decisions}" />
    <p:ajax />
</p:selectOneMenu>
<p:message for="dec" display="icon" />

<h:outputLabel for="etat" value="Etat : " />
<p:selectOneMenu id="etat" value="#{editCommandController.myCom.etat}" disabled="#{editCommandController.myCom.decision ne 'rejettée'}">
    <f:selectItems value="#{editCommandController.etats}" />
</p:selectOneMenu>
<p:message for="etat" display="icon" /> 
```

然后在支持 bean 中添加 selectItem 如果不存在，否则您可以跳过它：

```
public static List<SelectItem> etats = new ArrayList<SelectItem>() { {
    add(new SelectItem("Cheese", "Cheese"));
    add(new SelectItem("Pickle", "Pickle"));
    add(new SelectItem("Mustard", "Mustard"));
    add(new SelectItem("Lettuce", "Lettuce"));
}};

public void vclistener(ValueChangeEvent e){
    if(e.getNewValue().equals("rejettée")){
        EditCommandController.etats.add(0, new SelectItem("Ketchup", "Ketchup"));
        myCom.setEtat("Ketchup");
    }
    RequestContext.getCurrentInstance().update("etat");
}

public List<SelectItem> getEtats() {
    return etats;
}

public void setEtats(List<SelectItem> etats) {
    EditCommandController.etats = etats;
} 
```

# php - MySQL 预制函数

> ID：12059507
> 
> 赞同：0
> 
> 时间：2012-08-21T16:47:53.417
> 
> 标签：php, mysql, pdo

我有一小类预制的 MySQL 函数（例如函数'insert()'），其中传递了一些参数并执行了插入。这让我发展得更快。

我想知道是否已经完成了一些工作，例如 CodeIgniter 的，但只是一个我可以包含的类，而不必使用整个框架。最好是 PDO，PHP5，有什么好的可以推荐的吗？我已经用谷歌搜索了一段时间，但找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:53:02.477

我见过的最简单的是[NotORM](http://www.notorm.com/)。我想你不能比这更容易：

```
include "NotORM.php";
$pdo = new PDO("mysql:dbname=software");
$db = new NotORM($pdo); 
```

您可以使用[本教程](http://phpmaster.com/database-interaction-made-easy-with-notorm/)了解更多信息。

# .htaccess - 使用.htaccess 将旧站点的所有网址重定向到新站点上的index.php？

> ID：12059508
> 
> 赞同：0
> 
> 时间：2012-08-21T16:47:52.707
> 
> 标签：.htaccess, redirect, directory

几个问题，简单来说：

1.  .htaccess文件一般存放在public_html目录下吗？我想是的，不是吗？

2.  如果我没有找到这样的文件，我可以简单地创建它并使用 FTP 上传吗？

3（最重要的）。我需要将所有 URL 重定向到一个新 URL 的代码是什么，即[http://www.newsite.com](http://www.newsite.com)

仅此而已`Redirect 301 / http://www.newsite.com/`吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:32:08.750

> 仅此而已`Redirect 301 / http://www.newsite.com/`吗？

正确，这是您唯一需要的。它会将任何以开头的内容重定向`/`到`http://www.newsite.com/`. 例子：

你去`http://oldsite.com/some/path/to/file.php`，你会被重定向到`http://www.newsite.com/some/path/to/file.php`。

如果您希望所有内容都简单地转到新站点的文档根目录，您可以使用 a`RedirectMatch`代替：

```
RedirectMatch 301 .* http://www.newsite.com/ 
```

所以如果你去`http://oldsite.com/some/path/to/file.php`，你会被重定向到`http://www.newsite.com/`

并非所有 apache 安装都安装了 mod_rewrite，如果未安装，如果您尝试使用重写引擎，则会收到 500 服务器错误。但是，通常总是安装 mod_alias。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:10:05.617

问题 1：您是否可以仅将 .htaccess 上传到 public_html 取决于网络主机，但这可能会起作用。

问题 2：我会像这样设置重定向：

```
RewriteEngine On    
RewriteRule ^(.*) http://www.newsite.com/ [R=301,L] 
```

# python - 从 Python 项目创建单个可执行文件

> ID：12059509
> 
> 赞同：147
> 
> 时间：2012-08-21T16:47:58.143
> 
> 标签：python, compilation, exe, packaging, software-distribution

我想从我的 Python 项目中创建一个可执行文件。用户应该能够下载并运行它而无需安装 Python。如果我只是分发一个包，我可以使用 pip、wheel 和 PyPI 来构建和分发它，但这需要用户有 Python 并且知道如何安装包。我可以使用什么来从 Python 项目构建自包含的可执行文件？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2012-08-21T16:59:25.280

这里有一些常见的。我只包含了截至我上次编辑（2021 年 7 月）正在积极维护的项目。

除非另有说明，否则下面列出的所有程序都将生成专门针对其运行的操作系统的 exe。例如，在 Windows 中运行 Pyinstaller 将生成 Windows exe，但在 Linux 中运行 Pyinstaller 将生成 Linux exe。如果你想为多个操作系统生成一个 exe，你将不得不考虑使用虚拟机或类似[Wine](https://www.winehq.org/)的东西。

* * *

以下程序的工作方式都相似——它们将 Python 和您的程序捆绑在一起，有效地将它们组合在一起以生成可执行文件。

*   **PyInstaller：**

    [网站](https://www.pyinstaller.org/)|| [回购](https://github.com/pyinstaller/pyinstaller)|| [派皮](https://pypi.python.org/pypi/PyInstaller)

    在 Windows、Mac 和 Linux 上支持 Python 3.5 - 3.9。

*   **cx_冻结：**

    [网站](https://cx-freeze.readthedocs.io/en/latest/)|| [回购](https://github.com/marcelotduarte/cx_Freeze)|| [派皮](https://pypi.python.org/pypi/cx_Freeze)

    在 Windows、Mac 和 Linux 上支持 Python 3.6 - 3.9。

*   **py2exe：**

    [网站](https://www.py2exe.org/)|| [回购](https://github.com/py2exe/py2exe)|| [派皮](https://pypi.python.org/pypi/py2exe/)

    仅在 Windows 上支持 Python 3.6 - 3.9。

*   **py2app：**

    [网站](https://py2app.readthedocs.io/en/latest/)|| [回购](https://github.com/ronaldoussoren/py2app)|| [派皮](https://pypi.python.org/pypi/py2app/)

    仅在 Mac 上支持 Python 2.7 (?) 和 Python 3 (?)。目前没有记录支持的 Python 版本的确切范围。

* * *

当然，这不是唯一的做事方式：

*   **pynsist：**

    [网站](http://pynsist.readthedocs.org/en/latest/)|| [回购](https://github.com/takluyver/pynsist)|| [派皮](https://pypi.python.org/pypi/pynsist)

    Pynsist 将为您的程序创建一个 Windows 安装程序，它将直接在用户的计算机上安装 Python，而不是将其与您的代码捆绑在一起，并创建链接到您的 Python 脚本的快捷方式。

    pynsist 工具本身需要 Python 3.5+ 才能运行，但支持将任何版本的 Python 与您的程序捆绑在一起。

    Pynsist 将仅创建 Windows 安装程序，但可以在 Windows、Mac 和 Linux 上运行。有关更多详细信息，请参阅[他们的常见问题解答](http://pynsist.readthedocs.org/en/latest/faq.html#building-on-other-platforms)。

*   **努伊特卡：**

    [网站](http://nuitka.net/)|| [回购（Github 镜像）](https://github.com/kayhayen/Nuitka) || [派皮](https://pypi.python.org/pypi/Nuitka/)

    Nuitka 将从字面上编译您的 Python 代码并生成一个 exe（与其他项目相反，它仅包含 Python）来尝试和加速您的代码。作为副作用，您还将获得一个可以分发的方便的 exe。请注意，您的系统上需要有可用的[C++ 编译器](http://nuitka.net/doc/user-manual.html#requirements)。

    在 Windows、Mac 和 Linux 上支持 Python 2.6 - 2.7 和 Python 3.3 - 3.9。

*   **赛通：**

    [网站](http://cython.org/)|| [回购](https://github.com/cython/cython)|| [派皮](https://pypi.python.org/pypi/Cython/)

    Cython 类似于 Nuitka，因为它是一个 Python 编译器。但是，它不会直接编译您的代码，而是将其编译为 C。然后您可以获取该 C 代码并将[您的代码转换为 exe](https://stackoverflow.com/q/2581784/646543)。您需要在您的系统上安装一个可用的 C 编译器。

    在 Windows、Mac 和 Linux 上支持 Python 2.6 - 2.7 和 Python 3.3 - 3.9。

* * *

我个人的偏好是使用 PyInstaller，因为它对我来说最容易启动和运行，旨在与各种流行的库（如 numpy 或 pygame）很好地配合使用，并且与各种操作系统和 Python 版本具有很好的兼容性。

但是，我也成功地使用 cx_Freeze 构建了各种 exe，没有太大的困难，所以你也应该考虑尝试一下这个程序。

我还没有机会广泛尝试 pynist、Nuitka 或 Cython，但它们似乎是非常有趣和创新的解决方案。如果您在使用第一组程序时遇到问题，可能值得尝试这三个程序中的一个。由于它们的工作方式与 Pyinstaller/cx_freeze 风格的程序根本不同，它们可能会在第一组失败的奇怪边缘情况下成功。

特别是，我认为 pynist 是一种很好的方式来回避完全分发代码的整个问题：Mac 和 Linux 已经对 Python 提供了本机支持，仅在 Windows 上安装 Python 可能确实是最干净的解决方案。（缺点是您现在需要担心针对多个版本的 Python + 安装库）。

Nuitka 和 Cython（以我有限的经验）似乎工作得很好。同样，我自己并没有对它们进行广泛的测试，所以我的主要观察是它们似乎需要更长的时间来生成一个 exe，而不是“冻结”风格的程序。

* * *

综上所述，将 Python 程序转换为可执行文件不一定是分发代码的唯一方法。要了解有关其他可用选项的更多信息，请参阅以下链接：

*   [https://packaging.python.org/overview/#packaging-python-applications](https://packaging.python.org/overview/#packaging-python-applications)
*   [https://docs.python-guide.org/shipping/packaging/#for-linux-distributions](https://docs.python-guide.org/shipping/packaging/#for-linux-distributions)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-21T16:58:43.630

[pyinstaller](http://www.pyinstaller.org/)仍在积极开发中。您可以在 GitHub 上查看[最新更改。](https://github.com/pyinstaller/pyinstaller/commits/develop)

它支持所有三个主要平台：

*   Windows（32 位和 64 位）
*   Linux（32 位和 64 位）
*   Mac OS X（32 位和 64 位）

它支持 Python 2.6 和 2.7 版本。它不支持 Python 3，但有一个实验性的[Python 3 分支](https://github.com/pyinstaller/pyinstaller/tree/python3)。

# 更新

从 3.2.1 版开始，它支持 Python 2.7、3.3-3.5

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2020-08-07T04:58:11.567

更好地使用`pip install auto-py-to-exe`它提供了一个漂亮的 UI，其中包含创建可执行文件所需的所有选项。

安装后只需输入`auto-py-to-exe`终端或命令提示符。

[![自动 py 到 exe](../Images/27b4671a4831ecaae1f19e02c31d52f7.png)](https://i.stack.imgur.com/kXzRw.png)

# php - file_get_contents 在端口 8282 上不起作用

> ID：12059512
> 
> 赞同：1
> 
> 时间：2012-08-21T16:48:11.197
> 
> 标签：php, post, file-get-contents

我得到了以下基本脚本，它发出基本的 POST 请求（我只是想让它工作，在我添加更多东西之后）：

```
#   Variables
$URL = 'http://******:8282/api/incoming_shipment/';

$postdata = http_build_query(
    array(
        'contract_id'       => 'Showcare-R124276',
        'shipment_from'     => 'Montréal',
        'shipment_to'       => 'Chicago',
        'shipping_time'     => '2012-08-16 14:51:01',
        'tracking_cie'      => 'Poste Canada',
        'tracking_type'     => 'Standard',
        'tracking_number'   => 'EP645 9834 123 9773'
    )
);

$opts = array('http' =>
    array(
        'method'  => 'POST',
        'header'  => 'Content-type: application/x-www-form-urlencoded',
        'content' => $postdata
    )
);

$context = stream_context_create($opts);

$result = file_get_contents($URL, FALSE, $context);

print_r($result); 
```

结果给我：

```
Warning: file_get_contents(http://******:8282/api/incoming_shipment/) [function.file-get-contents]: failed to open stream: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. in D:\Inetpub\hightechhandling\api\api_push_contract.php on line 31

Fatal error: Maximum execution time of 30 seconds exceeded in D:\Inetpub\hightechhandling\api\api_push_contract.php on line 31 
```

但是当我使用浏览器访问网页时，它可以完美运行。我已经尝试过 cURL 和 fsocketopen 但这也没有用。请问有什么帮助吗？谢谢..

**编辑**我添加了`set_time_limit (500);`，现在第二个错误当然消失了......但第一个错误仍然存​​在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:13:33.200

好的，找到问题了。太愚蠢了。问题是因为发出请求的服务器（PHP 文件所在的位置）启用了防火墙，并且防火墙仅允许端口 21、22、80、3306 和 1433 用于外部请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-19T04:30:44.303

对于 CentOS，`file_get_contents()`用于访问 80 以外端口上的 URL 在权限被拒绝的情况下不起作用。它仅在 selinux 设置为“禁用”或“允许”时才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T05:10:05.487

如果出于安全考虑不想禁用selinux，可以修改selinux策略允许httpd监听8282

列出 httpd 允许的端口： semanage port -l | grep -w http_port_t

添加端口 8282：semanage port -a -t http_port_t -p tcp 8282

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T16:57:06.433

## 来自 PHP 手册

> 无效 set_time_limit ( int $seconds )
> 
> 设置允许脚本运行的秒数。如果达到此值，脚本将返回致命错误。默认限制为 30 秒，如果存在，则为 php.ini 中定义的 max_execution_time 值。
> 
> 调用时， set_time_limit() 从零重新启动超时计数器。换句话说，如果超时是默认的 30 秒，并且在脚本执行 25 秒后调用了诸如 set_time_limit(20) 之类的调用，则脚本将在超时之前总共运行 45 秒。如果设置为零，则不施加时间限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T17:28:46.577

尝试这个：

```
'header' => implode("\r\n", array("Connection: close", "Content-type: application/x-www-form-urlencoded")), 
```

（尤其是连接：关闭位）

另外：你能用 curl 在命令行上复制这个问题吗？

# xcode - UITableView：隐藏单元格之间的边框/分隔符

> ID：12059513
> 
> 赞同：2
> 
> 时间：2012-08-21T16:48:15.443
> 
> 标签：xcode, uitableview, border, separator

是否可以隐藏 UITableView 的单元格之间的分隔符？但它应该为每个单元格单独配置（所以不是整个 TableView）。

我已经尝试过的是：

```
UIView *backView = [[[UIView alloc] initWithFrame:CGRectZero] autorelease];
backView.backgroundColor = UIColorFromRGB(CELL_COLOR_DEFAULT);
cell.backgroundView = backView; 
```

这里唯一的问题是，左右两侧也没有边框，但在这里我需要它。

谢谢 NG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:46:22.307

那么您是要在整个单元格周围设置边框还是仅在分隔符上设置边框？

您可以尝试添加类似

```
cell.layer.borderColor = [[UIColor blackColor]CGColor];
cell.layer.borderWidth = 10.0f; 
```

到您的 cellForRowAtIndexPath 方法（您可以决定是否显示给定单元格的边框）。

# java - 求偶数之和不超过四百万

> ID：12059521
> 
> 赞同：-3
> 
> 时间：2012-08-21T16:48:51.317
> 
> 标签：java

```
class fibo {

    //int firstNumber = 0;

    public static void main(String args[]){
        //int firstNumber = 0;
        int length = 4000000;
        int[] series = new int[length]; 
        //long[] sum = new long[4000000];
        long sum =0;
        series[0] = 0;
        series[1] = 1;
        for (int i = 2; i<4000000; i++){
            //firstNumber  = firstNumber + i;
            //System.out.println("fibo" + i);
            series[i] = series[i-1] + series[i-2];

            if(series[i] %2 == 0) {
                sum = sum + series[i];

            }

        }

        for(int j=0;j<length; j++){
            System.out.println("fibo Series" + series[j]);
        }               

    }

} 
```

我得到了答案，但方法不同。这段代码有什么问题？任何人都可以对此有所了解。

**当长度为 10 时，相同的代码有效。**我对此没有任何期望，但答案似乎不同。它的东西 -92719184589087346 是不正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T16:51:33.563

> 这段代码有什么问题？

好吧，它取前 400 万斐波那契数内的偶数之和，*而不是*小于 400 万的斐波那契数列中的偶数之和。

它还无缘无故地创建了它所看到的所有斐波那契数字的数组：您一次只需要最后两个，因此您可以在恒定空间中执行此操作*。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:57:45.047

我猜你想得到总和少于 400 万的总和？因为那不是你要计算的。您正在计算完全不同的第 4 百万个指数的总和。

您的答案错误的原因（除了您的逻辑错误）是 long 不能适合您正在计算的数字。斐波那契数列中的第 4 百万个条目是一个非常大的数字，以至于超出了您的多头。溢出将使其回绕到负片中（可能多次）。

# ios - CFRelease(addressBook) 使我的 iOS 应用程序崩溃

> ID：12059525
> 
> 赞同：3
> 
> 时间：2012-08-21T16:49:23.227
> 
> 标签：ios, memory-management, addressbook

```
- (void)tableView:(UITableView *)tableView 
accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath
{
    NSUInteger row = indexPath.row;

    if (row == NSNotFound)
        return;

    if (call.uid != kABRecordInvalidID)
    {
        ABAddressBookRef addressBook = ABAddressBookCreate();

        ABRecordRef person = ABAddressBookGetPersonWithRecordID(addressBook,
                                                                call.uid);

       // CFRelease(addressBook);// commenting out this makes the program not crash

}
} 
```

这是问题所在，静态代码分析告诉我有内存泄漏，因为我没有释放通讯簿。我尝试释放它，但如果我返回释放它的屏幕并再次调用此函数，应用程序就会崩溃。

所以想象一下我点击了附件按钮`uitableview`。我做了我必须做的事情并返回到原来的窗口，然后我再次点击附件按钮，`uitableview`程序崩溃并出现以下错误：

> -[Not A Type retain]：消息发送到已释放实例 0x618d810

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T16:55:37.713

通讯录不是（直接）导致崩溃的东西。

你没有保留你的人，你只是得到他/她的参考。尝试 `CFRetain`在你的人身上使用。

```
ABAddressBookRef addressBook = ABAddressBookCreate();
ABRecordRef person = ABAddressBookGetPersonWithRecordID(addressBook,
                                                        call.uid);
CFRetain(person);
CFRelease(addressBook); 
```

# paypal - 确定 PayPal 存款的公式？

> ID：12059527
> 
> 赞同：1
> 
> 时间：2012-08-21T16:49:27.637
> 
> 标签：paypal

我正在开发一个电子商务网站，让人们通过 PayPal 为他们的账户注资。为了不影响每天的存款，我们必须向客户收取 PayPal 的存款费用。贝宝需要 2.9 + .30。但是，如果我们收取 2.9 + .30 的费用，那么 PayPal 会根据新的总额收取费用。

因此，在 100 美元上，我们将收取 103.20 来存入 100，但 PayPal 现在收取 103.29，我们对该存款收取 0.09c。

在 PayPal 需要 2.9 + .30 之后，我如何创建一个论坛以准确保留他们的存款金额？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:11:21.047

您正在混淆百分比的加法和百分比**的****减法**：

恕我直言，正确看待这个问题的方法是说 PayPal 给你留下了原始余额的 97.1% -0.3

所以正确的值是**103.28661174...**，我到达`(100/0.971)+0.3`

试试这个：从 103.28661174 PayPal 将取 0.30，剩下 102.98661174，它将取 2.9%，或 2.98661174...，剩下 100

# bash - 通过 bash 脚本将参数传递给 /bin/bash

> ID：12059528
> 
> 赞同：6
> 
> 时间：2012-08-21T16:49:36.313
> 
> 标签：bash

我正在编写一个 bash 脚本，它接受许多命令行参数（可能包括空格）并通过登录 shell 将所有这些参数传递给程序（/bin/some_program）。从 bash 脚本调用的登录 shell 将取决于用户的登录 shell。假设用户在本例中使用 /bin/bash 作为他们的登录 shell……但它可能是 /bin/tcsh 或其他任何东西。

如果我知道有多少参数将传递给 some_program，我可以在我的 bash 脚本中加入以下几行：

```
#!/bin/bash
# ... (some lines where we determine that the user's login shell is bash) ...
/bin/bash --login -c "/bin/some_program \"$1\" \"$2\"" 
```

然后调用上面的脚本如下：

```
my_script "this is too" cool 
```

通过上面的例子，我可以确认 some_program 接收到两个参数，“this is too”和“cool”。

我的问题是......如果我不知道将传递多少个参数怎么办？我想将发送给 my_script 的所有参数传递给 some_program。问题是我无法弄清楚如何做到这一点。以下是一些*不起作用*的事情：

```
/bin/bash --login -c "/bin/some_program $@"     # --> 3 arguments: "this","is","too"
/bin/bash --login -c /bin/some_program "$@"     # --> passes no arguments 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T16:59:43.923

引用 bash 手册`-c`：

> 如果存在 -c 选项，则从字符串中读取命令。如果字符串后面有参数，则将它们分配给位置参数，**从 $0 开始**。

为我工作：

```
$ cat x.sh
#!/bin/bash
/bin/bash --login -c 'echo 1:$1 2:$2 3:$3' echo "$@"
$ ./x.sh "foo bar" "baz" "argh blargh quargh"
1:foo bar 2:baz 3:argh blargh quargh 
```

我不知道您是如何得出“没有争论”的结论的，也许您错过了`$0`一点？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:00:08.213

避免将变量嵌入到其他脚本中，而是将它们作为参数传递。在这种情况下：

```
bash --login -c 'some_program "$@"' some_program "$@" 
```

-c '...' 之后的第一个参数被视为 $0，所以我只是在那里放了 some_program。

附带说明一下，需要登录 shell 是一个奇怪的要求。用户没有登录吗？

# html - 如何使用纯 CSS 实现流畅的字体大小

> ID：12059530
> 
> 赞同：17
> 
> 时间：2012-08-21T16:49:37.763
> 
> 标签：html, css, fluid-layout

我将文本包裹在`<div>`s 中，并希望使整个内容变得流畅，包括文本的字体大小，即文本根据包含元素的大小调整自身大小。

我遇到了一个[Javasript + CSS 解决方案](https://stackoverflow.com/questions/4467934/css-javascript-fluid-font-size)，但只是想知道是否可以使用纯 CSS 来做到这一点？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-30T18:48:03.820

虽然吉姆给了你准确的信息，但它与所提出的问题略有不同。响应式设计（@media 查询）可以根据屏幕大小改变文本。据我了解，您问的是是否有纯 CSS 解决方案可用于流畅的文本大小（在窗口大小更改期间不断调整文本大小）。

这是新[字体大小技术](http://css-tricks.com/viewport-sized-typography/)的 css-tricks 解释的链接。请注意，这是新的和旧的浏览器很可能会出现一些问题，甚至更新的浏览器（Chrome + Safari）仍然不是没有错误的。

```
h1 {
  font-size: 5.9vw;
}
h2 {
  font-size: 3.0vh;
}
p {
  font-size: 2vmin;
} 
```

**编辑添加的代码**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-21T17:11:20.673

是的，看看 CSS 3 媒体查询。您可以根据视口宽度提供不同的样式规则。这包括更改字体大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-16T13:42:10.673

# 简答

你不能有流畅的字体大小，但是当[视口百分比长度](http://caniuse.com/#feat=viewport-units)广泛可用时你会。

# 长答案

您必须了解这两个术语：**响应式**和**流畅性**。

**响应**式意味着您让样式表对不同的窗口大小做出不同的响应。这是通过使用[CSS Media Queries](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Media_queries)完成的。虽然响应式是网页设计中*最时髦*的词之一，但它主要意味着将 CSS 硬编码为不同的绝对长度，直到你厌倦为止。

**流体**意味着您使用相对长度单位，例如百分比。当您使用相对长度单位时，每个尺寸都会自动计算。

## 例子

假设您`<div>`在文档正文中有一个，并且您希望它填满一半的窗口。

**响应式**解决方案是这样的：

```
@media (max-width: 1px) {
  body > div {
    width: 0.5px;
  }
}

@media (max-width: 2px) {
  body > div {
    width: 1px;
  }
}

@media (max-width: 3px) {
  body > div {
    width: 1.5px;
  }
}

@media (max-width: 4px) {
  body > div {
    width: 2px;
  }
}

/* Repeat until you reach gigabytes and hit operating systems' file size limitations. */ 
```

和**流体**解决方案：

```
body > div {
  width: 50%;
} 
```

## 所以？

今天限制我们的是，对视口相对长度单位没有广泛的支持。你能做的就是放弃“纯 CSS**流体**字体大小”的整个想法，转而使用**响应**式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-15T11:20:51.040

将 calc 与媒体查询一起使用以获得响应式和流畅的字体

```
@media screen and (min-width: 25em){
  div {  
    font-size: calc( 16px + (24 - 16) * (100vw - 400px) / (800 - 400) );
  }
} 
```

# ruby-on-rails - Rails 3：用户 has_many 关联 ID？

> ID：12059535
> 
> 赞同：0
> 
> 时间：2012-08-21T16:50:08.150
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的 Rails 3 应用程序中有 3 个模型：

**用户**

模型：

```
has_many :videos, :dependent => :destroy 
```

控制器：

```
before_filter :signed_in_user
def show
  @user = User.find(params[:id])
end

def signed_in_user
  unless signed_in?
    store_location
  redirect_to signin_path, notice: "Please sign in."
  end
end 
```

**视频**

模型：

```
belongs_to :user
has_many :surveys, :dependent => :destroy 
```

控制器：

```
before_filter :signed_in_user

def signed_in_user
  unless signed_in?
    store_location
  redirect_to signin_path, notice: "Please sign in."
  end
end

  def show
    @video = Video.find(params[:id])
    @original_video = @video.panda_video
    @h264_encoding = @original_video.encodings["h264"]
    @surveys = Survey.all
    @user = User.find(params[:id])
  end 
```

**民意调查**

模型：

```
belongs_to :video 
```

控制器：

```
 before_filter :signed_in_user

def signed_in_user
  unless signed_in?
    store_location
  redirect_to signin_path, notice: "Please sign in."
  end
end

  def show
    @survey = Survey.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @survey }
    end
  end 
```

所以在我的应用中，一个用户有很多视频，每个视频都有很多调查（又名评论）。想想烂番茄是如何运作的。用户已登录以访问视频或撰写评论。用户在登录时提交的任何评论都会自动与该用户相关联……这就是我试图通过我的应用程序来解决的问题。

如何将用户 ID 与评论相关联？现在，当用户登录时，他的名字会自动与所有评论相关联，无论他是否写过评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:19:49.220

您想通过以下`through`选项将 Video 类用作连接模型：

```
User
  has_many :surveys, :through => :videos

Survey
  has_one :user, :through => :video 
```

这应该让你这样做：

```
@user.surveys
@survey.user 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:06:42.820

是否有某种原因这不像以下那么简单：

```
User
  has_many :surveys

Survey
  belongs_to :user 
```

如果是这样，需要更多信息/代码才能获得有用的答案。

# java - 哈希集输入java

> ID：12059538
> 
> 赞同：-1
> 
> 时间：2012-08-21T16:50:32.877
> 
> 标签：java, hashset

我正在处理下面的问题并且非常接近，但在第 19 和 32 行我收到以下错误并且无法弄清楚。

> foreach 不适用于表达式类型 for (String place: s)

**问题：**

> 税务检查员可以使用两个文本文件，分别称为 unemployers.txt 和 taxpayers.txt。每个文件包含一组名称，每行一个名称。检查员将出现在这两个文件中的任何人视为狡猾的角色。编写一个程序，打印出不可靠字符的名称。充分利用 Java 对集合的支持。

**我的代码：**

```
class Dodgy {

public static void main(String[] args) {

    HashSet<String> hs = new HashSet<String>();

    Scanner sc1 = null;
try {sc1 = new Scanner(new File("taxpayers.txt"));} 
        catch(FileNotFoundException e){};
while (sc1.hasNextLine()) {
    String line = sc1.nextLine();
    String s = line;
    for (String place: s) {
        if((hs.contains(place))==true){
            System.out.println(place + " is a dodgy character.");
    hs.add(place);}
    }   
}

    Scanner sc2 = null;
try {sc2 = new Scanner(new File("unemployed.txt"));} 
        catch(FileNotFoundException e){};
while (sc2.hasNextLine()) {
    String line = sc2.nextLine();
    String s = line;
    for (String place: s) {
        if((hs.contains(place))==true){
            System.out.println(place + " is a dodgy character.");
    hs.add(place);}
}
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:55:27.060

您正在尝试迭代“字符串中的每个字符串”-这甚至意味着什么？

感觉就像您*只*需要遍历每个文件中的每一行......您不需要在一行*内*进行迭代。

其次 - 在您的第一个循环中，您只查看第一个文件，那么您怎么可能检测到狡猾的字符？

我会考虑将问题抽象为：

*   编写一个方法来读取文件并填充哈希集。
*   调用该方法两次以创建两个集合，然后找到交集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:52:46.247

Foreach 仅适用于[`java.lang.Iterable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Iterable.html)类型。由于 String 不是，因此错误也是如此。

如果您的意图是迭代字符串中的字符，则将“s”替换为“s.toCharArray()”，它会返回一个数组，即`java.lang.Iterable`.

# mobile - cocos2D 或 IwGame

> ID：12059539
> 
> 赞同：3
> 
> 时间：2012-08-21T16:50:37.307
> 
> 标签：mobile, cocos2d-x, marmalade

我开始为 Android 开发游戏应用程序，但随着我的进步，我决定切换到跨平台环境。性能非常重要，因为背景中有一些复杂的音频处理。经过几天的研究，我得出结论，最成功的选择是 Marmalade SDK。

现在我需要决定是否使用 IwGame 或 Cocos2D-X 或两者都用于开发。两者看起来都很棒而且很有趣。有没有人用过这些，可以分享经验吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:34:12.450

这取决于您的游戏对游戏引擎的依赖程度。`Cocos2D-x`是更多功能范围和重型游戏引擎，由许多开源开发人员贡献，而 IwGame 引擎由个人（或可能是个人团队）构建，仅用于`marmalade`.

我只使用 Iwgame 引擎进行 3D 游戏摄像机旋转，设置起来太容易了，一天之内我就可以让我的游戏运行良好。因此，如果您的需求不高，只需使用 IwGame 。

物理引擎喜欢`Box2D`并且`Chipmunks`据说可以更好地与 链接`Cocos2D-x`，但是我在果酱项目中单独使用它们并且根本没有遇到任何问题。因此，拥有更好的链接物理引擎并不是什么大不了的事。

要在 Cocos2D-x 上工作，您需要先学习它，而 IwGame 入门并不复杂。但是一旦你使用了 Cocos2D-x，你就可以更轻松地处理严肃的项目，而且你只想使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T17:57:46.667

IwGame 提供了一种非常强大的内置标记语言 (XOML)，它可以使布局游戏关卡、设计动画、创建用户界面变得非常容易。IwGame 还允许您将内容托管在远程服务器上并按需下载。哦，它还内置了对广告和应用内购买的支持。

Cocos2D 是更成熟的引擎，但我相信 IwGame 功能更丰富，更易于使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T23:12:42.940

我只使用 cocos2d-x（没有果酱）。我认为它在制作游戏时非常方便，但是设置过程和让你的第一款游戏运行起来并不是那么容易。

我没有尝试过 IwGame，所以我不能说太多。

您可以在我的个人资料中了解 cocos2d-x 游戏的外观。

# css - 列表样式图像的 Retina 资产

> ID：12059548
> 
> 赞同：6
> 
> 时间：2012-08-21T16:51:13.083
> 
> 标签：css, retina-display

有谁知道为视网膜显示器定制列表样式图像的好方法？媒体查询中通常的背景大小技巧不适用于列表样式图像。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:44:52.610

实现这一点的最佳方法是不使用列表样式图像，而是为列表中的每个 li 元素设置一个背景图像。

通过这种方式，您可以使用通常的背景大小技巧来支持视网膜显示。

# javascript - 您可以使用 jquery 查看目标是否包含标签吗？

> ID：12059560
> 
> 赞同：2
> 
> 时间：2012-08-21T16:52:34.537
> 
> 标签：javascript, jquery

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-21T16:54:59.010

您可以将其简化为单个选择器`.find("b,i,u")`并返回布尔比较`length > 0`。`<b><i><u>`如果在里面找到任何标签`#item`，总长度将为`> 0`：

```
return $("#item").find("b,i,u").length > 0; 
```

[概念证明](http://jsfiddle.net/8Kmqu/)

**编辑**：如果你真的想要一个`number`零或一个而不是`boolean`，请使用三元：

```
return $("#item").find("b,i,u").length > 0 ? 1 : 0; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-21T16:56:11.803

```
return document.querySelector("#item b, #item u, #item i") ? 1 : 0; 
```

不需要 jQuery。

如果您需要支持 IE7 及更早版本的浏览器，请尝试以下操作：

```
var elem = document.getElementById('item');
return elem.getElementsByTagName('b').length
     + elem.getElementsByTagName('i').length
     + elem.getElementsByTagName('u').length == 0 ? 0 : 1; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-21T16:56:47.183

也许使用该`.has()`方法。

```
$('li').has('ul') 
```

[jQuery有](http://api.jquery.com/has/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-21T16:57:15.440

你也可以用 .has() 函数来做到这一点

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T17:14:52.027

我不确定它是最有效的，但我会使用`.find`它。

```
function hasInline(targetElement) { 
  return ($(targetElement).find('b,u,i').length > 0); 
} 
```

我还建议扩展该功能，以便您可以指定要检查的任何内联标签，如下所示：

```
// NOTE: This will return true if the element has ANY of the tags provided.
function hasInlineTags(targetElement, listOfTags) { 
  return ($(targetElement).find(listOfTags.join(',')).length > 0); 
}

// Call it with whatever tags you want.
hasInlineTags($("div#item"), ['b','u','i']); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T17:19:19.717

如果您使用的是 jQuery：

```
var styleElements = $('b,u,i', $list) 
```

采用：

```
return (styleElements.length) ? 1 : 0; 
```

# wpf - 外面的画布覆盖图像

> ID：12059567
> 
> 赞同：0
> 
> 时间：2012-08-21T16:53:16.843
> 
> 标签：wpf

我在画布内有一个图像。当加载 UserControl 时，图像向上移动。

```
<Canvas x:Name="cnvMain"  Width="300" VerticalAlignment="Center" Height="200" SnapsToDevicePixels="True">
    <Image x:Name="Image1"    Width="200"  Stretch="None" Canvas.Bottom="0"  Source="ImageGallery/Desert.jpg" ></Image>
</Canvas> 
```

我使用了双动画。

```
 DoubleAnimation _Animation;
    private Storyboard _StoryBoard;

    private void UserControl_Loaded(object sender, RoutedEventArgs e)
    {

        _Animation = new DoubleAnimation();
        _Animation.From = -Image1.ActualHeight;
        _Animation.To = cnvMain.ActualHeight;
        _Animation.RepeatBehavior = RepeatBehavior.Forever;
        _Animation.Duration = new Duration(TimeSpan.Parse("0:0:10"));
        _Animation.FillBehavior = FillBehavior.Stop;
        Storyboard.SetTarget(_Animation, Image1);
        Storyboard.SetTargetProperty(_Animation, new PropertyPath(Canvas.BottomProperty));
        _StoryBoard = new Storyboard();
        _StoryBoard.Children.Add(_Animation);
        _StoryBoard.Begin();
    } 
```

这段代码运行良好。我的问题是画布没有像框架一样覆盖图像（图像尺寸大于画布，我希望查看画布内的图像区域）。当我将 Canvas 更改为 Grid 时，它会覆盖在图像之外，但动画不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:01:38.663

尝试并在您的画布上使用：[`ClipToBounds`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.cliptobounds.aspx)`="True"`

# jquery - 通过ajax跨域请求获取xml数据

> ID：12059569
> 
> 赞同：0
> 
> 时间：2012-08-21T16:53:22.497
> 
> 标签：jquery, ajax

我正在尝试访问一个使用 jquery 和 ajax 调用的 xml 文件。我发现除非您在 Web 服务器上进行一些配置更改，否则不允许跨域请求。

我正在这样做：

```
$(document).ready(function () {

$("#div1").jstree({

    "xml_data": {

        "ajax": {
            type: "GET",
            dataType: 'xml', 
            url: "http://192.168.101.1/img/tree.xml" 
```

我修改了 iis web.config 文件如下：

```
<?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <system.webServer>
      <httpProtocol>
        <customHeaders>
          <add name="Access-Control-Allow-Origin" value="*" />
        </customHeaders>
      </httpProtocol>
    </system.webServer>
  </configuration> 
```

回收的 II，但我仍然无法访问该 xml 文件。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T18:23:04.730

尝试向您的应用程序发送 ajax 请求，并从应用程序获取此 xml，以免打扰跨域调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:36:10.123

也许您需要在服务器中设置[您的 crossdomain.xml](https://serverfault.com/questions/303808/how-do-you-set-up-the-crossdomain-xml-for-site-whose-url-is-the-machine-name)。

放入项目根目录的示例：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
    <allow-access-from domain="*" />
    <site-control permitted-cross-domain-policies="master-only"/>
    <allow-http-request-headers-from domain="*" headers="*" secure="true"/>
</cross-domain-policy> 
```

也值得一读[文件的放置位置](https://stackoverflow.com/questions/213389/when-it-says-put-crossdomain-xml-in-the-root-where-would-that-be-on-iis)。

# entity-framework - 使用实体框架迁移添加新父表

> ID：12059571
> 
> 赞同：0
> 
> 时间：2012-08-21T16:53:30.890
> 
> 标签：entity-framework, entity-framework-migrations

我正在尝试使用迁移将父表添加到现有子表中。例如。我目前有`User`表，现在我想添加一个`Department`具有一对多关系的表：`Department has many User`。

我的问题是，在自动更新中，我是否可以在添加 FK 之前以某种方式为父表播种，以便我可以将所有子表更新为此默认播种`Department`？如果自动更新不能做到这一点，我该如何在代码中完成呢？

我目前所做的：使 FK 可以为空，创建父级并为其播种，然后将所有子`User`级 FK 更新为父级。但是现在我无法更改 FK 不可为空，因为会引发此错误：`Automatic migration was not applied because it would result in data loss.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:10:25.500

从可空切换到不可空被认为是数据丢失，因为在迁移之后，无法判断哪些行（如果有）为空。如果您对此感到满意，则可以使用 -Force 标志调用 Update-Database。

另一种选择是添加一个基于代码的迁移，它将：

1.  添加部门表
2.  插入默认部门
3.  使用插入部门的默认值将所需的 FK 列添加到 User

# mysql - 用于 PDO MySQL 查询中 LIKE 的 GET 值的 bindParam

> ID：12059575
> 
> 赞同：2
> 
> 时间：2012-08-21T16:53:41.010
> 
> 标签：mysql, pdo, get, sqlbindparameter, sql-like

有什么方法可以转换

```
$term = $_GET['p'];
$stmt = $dbh->prepare("
    SELECT      *
    FROM        posts
    WHERE       heading LIKE '%$term%'
    OR          full_text LIKE '%$term%'
    LIMIT       0 , 30
");
$stmt->execute();
$answer = $stmt->fetch(PDO::FETCH_ASSOC); 
```

进入类似的东西

```
$term = "'%" . $_GET['p'] . "%'";
$stmt = $dbh->prepare("
    SELECT      *
    FROM        posts
    WHERE       heading LIKE :term
    OR          full_text LIKE :term
    LIMIT       0 , 30
");
$stmt->bindParam(":term", $term);
$stmt->execute();
$answer = $stmt->fetch(PDO::FETCH_ASSOC); 
```

这样我就可以在查询中使用`bindParam(":term", $term);`而不是`'%$term%'`？

我已经看过这些[Using LIKE in bindParam for a MySQL PDO Query](https://stackoverflow.com/questions/11068230/using-like-in-bindparam-for-a-mysql-pdo-query)和 [Mysql, PDO - Like statement not working using bindParam](https://stackoverflow.com/questions/11000576/mysql-pdo-like-statement-not-working-using-bindparam)。但是他们没有为我的问题提供任何正确的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T16:56:34.270

将通配符连接到 SQL 中的变量：

```
$stmt = $dbh->prepare("
    SELECT      *
    FROM        posts
    WHERE       heading   LIKE CONCAT('%', :term, '%')
    OR          full_text LIKE CONCAT('%', :term, '%')
    LIMIT       0 , 30
");
$stmt->bindParam(':term', $_GET['p']);
$stmt->execute();
$answer = $stmt->fetch(PDO::FETCH_ASSOC); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-27T23:37:09.197

你只需要%。不要使用 ' （简单的 queto）

例如 ：

```
$term = "'%" . $_GET['p'] . "%'";
$stmt = $dbh->prepare("
    SELECT      *
    FROM        posts
    WHERE       heading LIKE :term
    OR          full_text LIKE :term
    LIMIT       0 , 30
");
$termWithQueto = "%".$term."%";
$stmt->bindParam(":term", $termWithQueto, PDO::PARAM_STR);
$stmt->execute();
$answer = $stmt->fetch(PDO::FETCH_ASSOC); 
```

# objective-c - 添加联系方式后无法返回应用

> ID：12059576
> 
> 赞同：1
> 
> 时间：2012-08-21T16:53:44.067
> 
> 标签：objective-c, ios, addressbook

我已经实现了一个将公司详细信息添加到设备电话簿的按钮。添加详细信息后，我无法从联系人屏幕再次返回应用程序。我必须点击主页按钮，然后重新启动应用程序。我一定在这里遗漏了一些基本的东西

```
 ABUnknownPersonViewController *unknownPersonViewController = [[ABUnknownPersonViewController alloc] init];
unknownPersonViewController.displayedPerson = (ABRecordRef)[self buildContactDetails];
unknownPersonViewController.allowsAddingToAddressBook = YES;
[self.navigationController pushViewController:unknownPersonViewController animated:YES];

}

- (ABRecordRef)buildContactDetails {
NSLog(@"building contact details");
ABRecordRef person = ABPersonCreate();
CFErrorRef  error = NULL;

//Contact picture
NSData *dataRef = UIImagePNGRepresentation(contact.image); 
ABPersonSetImageData(person, (__bridge_retained CFDataRef)dataRef, nil);

// Name
ABRecordSetValue(person, kABPersonFirstNameProperty, @"Don Juan", NULL);

//Phone number

ABMultiValueRef multiPhone = ABMultiValueCreateMutable(kABMultiRealPropertyType);
ABMultiValueAddValueAndLabel(multiPhone, (__bridge_retained CFStringRef)@"0000000000", kABWorkLabel, NULL);
ABRecordSetValue(person, kABPersonPhoneProperty, multiPhone, nil);
CFRelease(multiPhone);

// email
ABMutableMultiValueRef email = ABMultiValueCreateMutable(kABMultiStringPropertyType);
ABMultiValueAddValueAndLabel(email, @"hotmail.com", CFSTR("email"), NULL);
ABRecordSetValue(person, kABPersonEmailProperty, email, &error);
CFRelease(email);

// Start of Address
ABMutableMultiValueRef address = ABMultiValueCreateMutable(kABMultiDictionaryPropertyType);
NSMutableDictionary *addressDict = [[NSMutableDictionary alloc] init];
[addressDict setObject:@"High Street" forKey:(NSString *)kABPersonAddressStreetKey];
[addressDict setObject:@"0000" forKey:(NSString *)kABPersonAddressZIPKey];
[addressDict setObject:@"00000" forKey:(NSString *)kABPersonAddressCityKey];
ABMultiValueAddValueAndLabel(address,(__bridge_retained CFDataRef) addressDict,  kABWorkLabel, NULL);
ABRecordSetValue(person, kABPersonAddressProperty, address, &error);

// End of Address

if (error != NULL)
    NSLog(@"Error: %@", error);

return person;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T13:49:14.450

尝试这个 ：

做完之后`presentModalViewController`

为了`ABPersonViewController *view`

你应该`dismissModalViewControllerAnimated`

# java - 搜索特定 java 类的引用

> ID：12059577
> 
> 赞同：-6
> 
> 时间：2012-08-21T16:53:44.527
> 
> 标签：java, eclipse

我在 Eclipse 中寻找一个快捷方式，它将在其他地方显示所选 Java 类的引用。目前我右键单击 Java 类并选择`References`.

如果我能被告知这条捷径，那就太好了。

有没有我可以参考的指南来找出最常用的 Eclipse 快捷方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:00:20.973

在 Eclipse 中查找引用是通过`CTRL`++`SHIFT`键盘`G`快捷键完成的。只需确保鼠标光标位于类上并使用组合键即可。相同的快捷方式适用于方法或变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:37:58.933

在工作区中查找所选项目的所有参考：`CTRL`+ `SHIFT`+`G`
在当前类中查找所选项目的所有参考：`CTRL`+`U`

## 学习 Eclipse 快捷方式

如果您是从 Eclipse Shortcuts 开始的，我建议我们可能不值得尝试通过阅读它们来学习它们。

### 记住快捷方式的建议策略

试试这个：

1.  确定您最常进行的一项活动/动作。
    示例：
    `Open Resource`( `CTRL`++ `SHIFT`)`R`允许您在工作区中搜索和打开文件。
    `Switch Between Tabs`( `CTRL`+`Page Up`或`Page Down`)

2.  一旦您确定了上述经常使用的活动，请尽可能多地**使用它（考虑到我们确定了一个经常使用的操作开始，这应该不难）**

3.  重复 ：）

### 提示 - 快捷方式组

记住快捷方式可能很有用`Groups`。很多时候你会发现它们很直观，很容易记忆。

**示例 -`Execute`快捷方式组**

Eclipse 有这种多键快捷方式的概念（在 Eclipse 之前我没有遇到过），它要求您按一系列字符（例如 Alt + Shift + X），然后按另一个字符。这允许相关快捷方式的“*分组*”。

例如，要执行几乎所有您首先按`ALT`+ `SHIFT`+的内容`X`，然后根据您正在执行的内容来执行另一个字符。因此，可以使用以下组合：
`ALT`++ 、J ：执行 Java 类的主要方法`SHIFT`++ 、T ：运行 Junit 测试（这将运行特定测试或类中的所有测试，具体取决于按下此快捷方式时光标的位置）`X`
`ALT``SHIFT``X`

上面的内容很容易记住为 Alt + Shift + **X** ecute、**J** **ava**类或 JUnit测试。

现在这样做的好处是，一旦您习惯了上述快捷方式，您就可以将**X** ecute 更改为**D** ebug，就像您有两个新的快捷方式一样可以在调试模式下运行 Java 类或 JUnit 测试。

# javascript - 如何在三个数组之一中找到一个元素，然后返回父数组名称？

> ID：12059588
> 
> 赞同：0
> 
> 时间：2012-08-21T16:55:26.240
> 
> 标签：javascript

我正在尝试检查三个数组中的任何一个中是否存在一个元素。我不知道如何返回找到元素的数组的名称。谁能指导我正确的方向。

我编写了一个函数，它将搜索中的元素作为其参数，然后返回数组名称：

```
 var arr1 = ['a','b','c','d'];
 var arr2 = ['e','f','g','h'];
 var arr3 = ['i','j','k','l'];     

 function chkElem(elem)
 {
    var id = elem;
    var isFound = null;

    if(arr1.indexOf(id) || (arr2.indexOf(id) || (arr3.indexOf(id))))
    {
        isFound = ????      
    }
    return isFound;     
 } 
```

我不确定如何将父数组名称分配给“isFound”变量。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T16:58:45.013

你不应该在你的函数逻辑中使用“变量*名”。*相反，创建对象的数组属性并返回属性名称：

```
var arrays = {
    "arr1": ['a','b','c','d'],
    "arr2": ['e','f','g','h'],
    "arr3": ['i','j','k','l']
};
for (var name in arrays)
    if (arrays[name].indexOf(id) > -1)
        return name;
return null; 
```

或者，更好的是，使用数组数组搜索并返回索引：

```
var arrays = [
    ['a','b','c','d'],
    ['e','f','g','h'],
    ['i','j','k','l']
];
for (var i=0; i<arrays.length; i++)
    if (arrays[i].indexOf(id) > -1)
        return i;
return -1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T16:58:03.537

逐一测试：

```
if (arr1.indexOf(id) > -1) {
  isFound = arr1;
} else if (arr2.indexOf(id) > -1) {
  isFound = arr2;
} else if (arr3.indexOf(id) > -1) {
  isFound = arr3;
} 
```

或者，创建一个多维数组：

```
var arr = [
 ['a','b','c','d'],
 ['e','f','g','h'],
 ['i','j','k','l']
];

var isFound = null;

for (var i = 0; i < arr.length; i++) {
  if (arr[i].indexOf(elem) > -1) {
    isFound = arr[i];
    break;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T17:01:06.277

首先，要小心`indexOf()`陷阱——如果它找不到请求的字符串，它将返回 -1——这是真的——所以你需要像这样明确地检查：

```
if (arr1.indexOf(id) != -1) 
```

不是

```
if (arr1.indexOf(id)) 
```

true/falsy 概念还意味着，如果您的字符串是数组中的第一个元素，因此`indexOf()`返回 false，那么这是一个 false，因此即使进行了匹配，您的条件实际上也会失败！

其次，您不能返回数组的名称——或者更准确地说，是在 JS 内存中引用它的变量的名称。您可以：

1) 返回数组本身

```
if (arr1.indexOf(id) != -1) return arr1; 
```

2) 将您的数组存储在一个中心对象中并返回您在其中找到它的属性的名称

```
var arrs = {
    'one': ['foo', 'bar']
    /* two, three etc */
};

for(var i in arrs)
    if (arrs[i].indexOf('foo') != -1)
        return i; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T16:58:38.133

当你有一组东西时，将它们存储在一个数组中（如果它们是有序的）或一个对象（如果它们是命名的）。如果您发现一堆名称几乎相同的变量，那么您可能做错了什么。

```
 var things = [
    ['a','b','c','d'],
    ['e','f','g','h'],
    ['i','j','k','l']
 ]; 
```

然后你可以遍历它们：

```
for (var i = 0; i < things.length; i++) {
    var thing = things[i];
    if (thing.indexOf(id) > -1) { // indexOf returns -1 if not found, and the index (starting from 0) if it is. 
        return i;
    }
}
return null; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T17:13:00.267

```
var arr1 = ['a', 'b', 'c', 'd'];
var arr2 = ['e', 'f', 'g', 'h'];
var arr3 = ['i', 'j', 'k', 'l'];

function chkElem(elem) {
    var isFound;
    (isFound = arr1).indexOf(elem) > -1 || (isFound = arr2).indexOf(elem) > -1 || (isFound = arr3).indexOf(elem) > -1;
    return isFound;
}

alert(chkElem('f')); 
```

# javascript - 从外部触发 Raphael 事件

> ID：12059592
> 
> 赞同：5
> 
> 时间：2012-08-21T16:55:44.453
> 
> 标签：javascript, cucumber, dom-events, raphael

我的应用程序使用 Raphaël 将一组对象拖放到页面上，每个对象都有一个`click`处理程序绑定，当通过 JSON 加载对象时，该处理程序使用附加到对象的数据。这一切都很好。

我现在正在尝试使用 Cucumber 添加一些测试覆盖率（是的，我知道我应该首先构建测试，下次我会这样做）。我需要触发对第一个对象的单击以测试该对象的关联页面是否加载。我已经尝试为该对象找到适当的 SVG 路径并触发`click`针对它的事件，但这不起作用。我还尝试将每个 Raphaël 集合放入一个全局可用的对象中，但无法弄清楚如何`click`针对适当的对象触发 Raphaël 事件。

提出一些具体问题：

1）如何手动触发 Raphaël 事件？

2) 如果您有对 Raphaël 集拥有的 SVG 元素的引用，是否可以触发所述事件？

3) 如果没有，是否可以访问 Raphaël 持有的当前集合？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-09T13:19:16.533

您可以将此自定义方法添加到您的 raphael 元素中：

```
Raphael.el.trigger = function(eventName){
    for(var i = 0, len = this.events.length; i < len; i++) {
        if (this.events[i].name == eventName) {
            this.events[i].f.call(this);
        }
    }
} 
```

你可以像这样使用它：

```
var r = paper.rect(0,0,100,100).attr({"fill": "#f00"});

r.click(function(){
    this.attr("fill": "#0f0");
});

r.trigger("click"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T15:33:05.750

我发现首先找到 raphael 对象，然后遍历 DOM 可以让我找到他们的事件处理程序的功能。对于我来说，点击事件是第 0 个事件。

所以为了触发它，我所做的就是：

```
 raphobj.events[0].f(); 
```

不过要小心，因为如果在单击事件中引用“this”，它将不起作用。

# shell - 将 awk 的输出保存到 shell 脚本中的变量中

> ID：12059593
> 
> 赞同：0
> 
> 时间：2012-08-21T16:55:44.157
> 
> 标签：shell, variables, awk, split

我需要将此命令的输出保存到变量中

```
$scriptName | awk '{split($0,a,"_"); print a[1]}' 
```

我试图这样做，但没有奏效

```
schema=$( $scriptName | awk '{split($0,a,"_"); print a[1]}' ) 
```

请有人告诉我这样做吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:07:43.247

这是一个稍微简单的方法：

```
schema=`echo $scriptName |awk -F_ '{print $1}'` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T20:22:18.103

第三种选择：

```
$script | awk ' ... ' | read schema 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:58:03.173

尝试

```
schema="$( $scriptName | awk '{split($0,a,"_"); print a[1]}' )" 
```

（带引号）。但是你如何检查它是否有效？

# android - Android AppWidgetProvider 类不改变 TextView

> ID：12059595
> 
> 赞同：0
> 
> 时间：2012-08-21T16:55:51.090
> 
> 标签：android, appwidgetprovider

所以我想显示步数，但这不起作用。

小部件加载但 TextView 没有改变！

```
public class WidgetDisplay extends AppWidgetProvider {

public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds){
    super.onUpdate(context, appWidgetManager, appWidgetIds);
    RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.dwidgitlayout);
    SharedPreferences load_steps = context.getSharedPreferences("steps", 0);
    int step_value = load_steps.getInt("steps", 0);
    views.setTextViewText(R.id.dwidgit_steps, String.valueOf(step_value));
    appWidgetManager.updateAppWidget(appWidgetIds, views);

} 
```

}

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:02:48.743

该应用程序在哪个 android 版本上运行？因为 2.3 和 2.2 之间存在细微差别 ..on 2.3 方法 onUpdate() 根本没有被调用。

# .net - 我可以通过反射为 Castle.Proxy 对象属性赋值吗？

> ID：12059604
> 
> 赞同：1
> 
> 时间：2012-08-21T16:56:36.903
> 
> 标签：.net, vb.net, reflection, rhino-mocks, castle

我有一个控制器测试库，用于处理测试中的大量冗余代码。在内部，它需要一个通用`TDataSource`参数，该参数应该是一个包含`IDbSet`s 的接口，用于 EF 代码。在运行时，测试库使用 RhinoMocks 构建一个模拟 TDataSource `_MockDataSource = MockRepository.GenerateMock(Of TDataSource)()`。然后我使用反射来获取接口的所有 IDbSet 属性并将模拟数据库集分配给它们。（注意：这适用于虚拟类，只是接口不起作用）。

当我尝试通过`IDbSet(Of TEntity)`调用来设置其中一个属性的值时`propertyInfo.SetValue(dataSource, mockDbSet, Nothing)`，它不会设置实际值。没有例外，它只是不起作用。我认为这是因为该对象`dataSource`实际上并不`TDataSource`像类型指定的那样，而是以`Castle.Proxies.IFakeDataSourceForTestingProxyf53f1730dba4492f8cafb9c731133d32`某种方式拦截了我对`SetValue`. 我怎样才能解决这个问题！

下面失败方法的完整代码：

```
 Protected Sub InjectTestData(ParamArray data() As IEnumerable)
        Dim dataSourceType As Type = GetType(TDataSource)
        Dim dataSourceProperties() As PropertyInfo = dataSourceType.GetProperties(BindingFlags.Public Or BindingFlags.Instance)

        'match up supplied data and required data sets
        For i As Integer = LBound(data) To UBound(data) Step 1
            Dim [set] As IEnumerable = data(i)
            Dim setType As Type = [set].GetType()
            If Not setType.IsGenericType Then
                Throw New ArgumentException(String.Format("Parameter {0} of the data array was not a generic IEnumerable, could not add to any IDbSet.", i))
            End If

            Dim modelType As Type = setType.GetGenericArguments(0)
            Dim dbSetType As Type = GetType(IDbSet(Of )).MakeGenericType({modelType})

            Dim foundDbSet As Boolean
            For Each [property] As PropertyInfo In dataSourceProperties
                If dbSetType.IsAssignableFrom([property].PropertyType) Then
                    Dim fakeDbSet As Object = CreateFakeDbSet(modelType, [set])
                    [property].SetValue(_MockDataSource, fakeDbSet, Nothing)
                    foundDbSet = True
                End If
            Next
            If Not foundDbSet Then Throw New ArgumentException(String.Format("Could not find an IDbSet(Of {0}) property on {1} to match parameter {2}", modelType.Name, dataSourceType.Name, i))
        Next

        'add empty lists to any data sets which are still null
        For Each [property] As PropertyInfo In dataSourceProperties
            If [property].GetValue(_MockDataSource, Nothing) Is Nothing Then
                Dim modelType As Type = [property].PropertyType.GetGenericArguments(0)
                Dim fakeDbSet As Object = CreateFakeDbSet(modelType)
                [property].SetValue(_MockDataSource, fakeDbSet, Nothing)
            End If
        Next
    End Sub 
```

# gmail - cpanel 发送的邮件被标记为垃圾邮件

> ID：12059606
> 
> 赞同：0
> 
> 时间：2012-08-21T16:56:41.147
> 
> 标签：gmail, cpanel, spam-prevention, email-spam

我的网站使用最新版本的 cpanel
，但是当我通过 cpanel 电子邮件帐户向 gmail 发送电子邮件时，gmail 将其标记为垃圾邮件
，问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:07:31.530

这可能有很多原因，

1.  导致许多电子邮件服务将邮件标记为垃圾邮件的第一件事是您的 IP 地址，也许您的 IP 地址被列为垃圾邮件生成器 - 但我认为这对 GMail 不是很重要。
2.  您应该设置反向 DNS 记录，因为它也很重要。
3.  也许您正在发送带有错误协议参数的电子邮件 - 我认为 cpanel 做得很好，我不是 cpanel 经验丰富的人。
4.  从电子邮件中删除垃圾邮件标记有助于 GMail 将发件人从黑名单中删除。
5.  谷歌有很好的文档关于如何将电子邮件发送到 GMail 以不标记为垃圾邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:04:50.540

您可以检查您的邮件服务器是否未在垃圾邮件数据库中列出。这是一个：[http](http://www.spamhaus.org/query/bl?ip=173.194.32.21) ://www.spamhaus.org/query/bl?ip= 173.194.32.21 当我在gmail中打开垃圾邮件时，她说为什么它在垃圾邮件中......

# ios - 列出已安装的移动配置文件

> ID：12059608
> 
> 赞同：24
> 
> 时间：2012-08-21T16:56:55.017
> 
> 标签：ios, macos, provisioning-profile

在 OSX 上，有没有办法以编程方式获取机器上安装的所有 iOS 移动配置文件的列表（即您可以在 XCode 管理器中看到的列表）？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-21T18:05:52.837

它可能是同一个列表，但如果您查看，`~/Library/MobileDevice/Provisioning Profiles`您会发现配置文件的文件夹。所以你可以只使用该路径来生成一个列表（可能使用 NSFileManager）

或者搜索扩展名 .mobileprovision

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-08-24T14:57:10.400

命令行，

**第 1 步**：打开终端并运行此命令以**列出配置文件**，

```
cd ~/Library/MobileDevice/Provisioning\ Profiles && ls 
```

或者这个**在finder中打开文件夹**，

```
open ~/Library/MobileDevice/Provisioning\ Profiles 
```

# c++ - 为什么 wxWidgets 不能与 Code::Blocks + minGW 一起使用？

> ID：12059616
> 
> 赞同：0
> 
> 时间：2012-08-21T16:57:20.087
> 
> 标签：c++, wxwidgets, codeblocks

我如何让 wxWidgets 2.9.4 与 Code::Blocks + MinGW 一起工作？我已经构建了库（仅发布）并编写了一些代码。当我在**没有事件表**的情况下构建它时，它可以正常工作，但是使用它们会引发错误。

这是有事件表时构建消息的转储：

```
obj\Debug\main.o||In function `_ZN21wxEventTableEntryBaseC2EiiP14wxEventFunctorP8wxObject':|
C:\wxWidgets\include\wx\event.h|2870|undefined reference to `_wxTheAssertHandler'|
C:\wxWidgets\include\wx\event.h|2871|undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'|
obj\Debug\main.o||In function `_ZN20wxEventFunctorMethodI14wxEventTypeTagI14wxCommandEventE12wxEvtHandler7wxEventS3_EC1EMS3_FvRS4_EPS3_':|
C:\wxWidgets\include\wx\event.h|374|undefined reference to `_wxTheAssertHandler'|
C:\wxWidgets\include\wx\event.h|374|undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'|
obj\Debug\main.o||In function `_ZN20wxEventFunctorMethodI14wxEventTypeTagI14wxCommandEventE12wxEvtHandler7wxEventS3_EclEPS3_RS4_':|
C:\wxWidgets\include\wx\event.h|392|undefined reference to `_wxTheAssertHandler'|
C:\wxWidgets\include\wx\event.h|392|undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'|
||=== Build finished: 6 errors, 0 warnings ===| 
```

和另一个构建日志：

```
-------------- Build: Debug in G1BC ---------------

Compiling: main.cpp
Linking executable: bin\Debug\G1BC.exe
obj\Debug\main.o: In function `_ZN21wxEventTableEntryBaseC2EiiP14wxEventFunctorP8wxObject':
C:/wxWidgets/include/wx/event.h:2870: undefined reference to `_wxTheAssertHandler'
C:/wxWidgets/include/wx/event.h:2871: undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'
obj\Debug\main.o: In function `_ZN20wxEventFunctorMethodI14wxEventTypeTagI14wxCommandEventE12wxEvtHandler7wxEventS3_EC1EMS3_FvRS4_EPS3_':
C:/wxWidgets/include/wx/event.h:374: undefined reference to `_wxTheAssertHandler'
C:/wxWidgets/include/wx/event.h:374: undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'
obj\Debug\main.o: In function `_ZN20wxEventFunctorMethodI14wxEventTypeTagI14wxCommandEventE12wxEvtHandler7wxEventS3_EclEPS3_RS4_':
C:/wxWidgets/include/wx/event.h:392: undefined reference to `_wxTheAssertHandler'
C:/wxWidgets/include/wx/event.h:392: undefined reference to `wxOnAssert(char const*, int, char const*, char const*, char const*)'
collect2.exe: error: ld returned 1 exit status
Process terminated with status 1 (0 minutes, 4 seconds)
6 errors, 0 warnings 
```

Code::Blocks 说这段代码是问题所在： ![糟糕的代码](../Images/d6fccc7d976b9270c2075fde1258bf8f.png)

希望能帮到你，先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:33:15.483

您需要始终保持`DEBUG_FLAG=1`原样**，**否则断言将无法编译。

这是 MSW 的 install.txt 中所说的：

> 指定 wxWidgets 中的调试支持级别。请注意，这独立于 BUILD 和 DEBUG_INFO 选项。**默认情况下始终设置为 1 表示启用 > 调试支持：断言被编译到代码中（默认情况下它们在应用程序的发布版本中处于非活动状态，但可以启用），** wxLogDebug() 和 wxLogTrace() 可用并且**WXDEBUG**是定义。将其设置为 0 会完全禁用 wxWidgets 中的所有调试代码，而将其设置为 2 甚至会启用被认为不适合生产环境的耗时断言和检查。

# linux - Ubuntu 10.04 chroot 中的 LFS 7.1：无法运行命令“/tools/bin/env”：没有这样的文件或目录

> ID：12059624
> 
> 赞同：0
> 
> 时间：2012-08-21T16:57:42.737
> 
> 标签：linux, linux-from-scratch

我在 Ubuntu 12.04 中创建了 LFS 7.1，但问题发生在第 6.4 章：进入 Chroot 环境。我执行命令： chroot "$LFS" /tools/bin/env -i \ HOME=/root TERM="$TERM" PS1='\u:\w\$ ' \ PATH=/bin:/usr/bin :/sbin:/usr/sbin:/tools/bin \ /tools/bin/bash --login +h 我没有创建符号链接 /tools 而只是为每个命令使用 /mnt/lfs/tools。在我 ldd bash 之后，我发现它的输出是：

```
root@ubuntu:/mnt/lfs/tools# ldd ./bin/env
linux-gate.so.1 =>  (0xb7703000)
libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb754c000)
/mnt/lfs/tools/lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0xb7704000) 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T11:55:04.203

我认为这本书没有暗示这个符号链接是可选的......

创建第一个工具链时*需要使用该符号链接。*只有这样，您才能在主机系统和 chroot 系统中拥有相同的（阅读：文本上相同的）路径。这是必需的，因为在编译工具期间，用于查找其他工具和库（“/tools”）的路径将嵌入到刚刚创建的可执行文件中。（不使用符号链接会导致在可执行文件中嵌入路径“/mnt/lfs/tools”，该路径在 chroot 之后不再存在）。

如果你不想回到第 4.2 章，你可以试试这个：在你的 lfs 系统中创建路径 /mnt/lfs/tools 以指向工具在 chrooted 系统中所在的位置。换句话说，创建另一个符号链接，如下所示（在主机系统中）：

```
ln -s /tools /mnt/lfs/mnt/lfs/tools 
```

（是的，第二个参数读取 /mnt/lfs/mnt/lfs/tools，它包含 /mnt/lfs 两次）。然后继续 6.4 进入 Chroot...

但更好（更干净）的选择是删除第 5 章的结果并返回到 4.2。这次创建符号链接。

# c# - 从 c# 启动和跟踪进程

> ID：12059632
> 
> 赞同：0
> 
> 时间：2012-08-21T16:58:34.657
> 
> 标签：c#, process

我遇到了一些奇怪的东西，希望有人可以在这里阐明...

我有我的主应用程序 A，我需要从应用程序 A 启动另一个应用程序（应用程序 B）。应用程序 A 还需要知道应用程序 B 何时退出。我用来执行此操作的代码如下所示：

```
_applicationProcess.StartInfo = 
     new ProcessStartInfo { FileName = _currentExecutablePath, WorkingDirectory = dir };
_applicationProcess.Start(); 
```

我订阅了 Process (_applicationProcess) 上的 Exited 事件，以检测它何时完成。

这是踢球者。应用程序 A 和应用程序 B 共享一个库，该库在服务初始化时发送通知（这是连接到 kinect 服务，因为两个应用程序都是 Kinect 应用程序）。

奇怪的是，当应用程序 B 使用上面的代码启动时，应用程序 A 会收到服务已初始化的通知。呸！

我不想要这个。我希望应用 B 与应用 A 完全隔离，但我需要知道它何时结束。

我怎样才能做到这一点？

# python - 基于字符分解Python中的子字符串

> ID：12059634
> 
> 赞同：1
> 
> 时间：2012-08-21T16:58:40.837
> 
> 标签：python, string, character, substring, break

我正在尝试编写将获取字符串并从中删除特定数据的代码。我知道数据看起来像下面的行，我只需要“”标记内的数据，而不是标记本身。

```
inputString = 'type="NN" span="123..145" confidence="1.0" ' 
```

有没有办法在两个字符内获取一个字符串的子字符串来知道起点和终点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:03:28.617

`"`您可以使用正则表达式提取字符对之间的所有文本：

```
import re
inputString='type="NN" span="123..145" confidence="1.0" '
pat=re.compile('"([^"]*)"')
while True:
        mat=pat.search(inputString)
        if mat is None:
                break
        strings.append(mat.group(1))
        inputString=inputString[mat.end():]
print strings 
```

或者，更简单：

```
import re
inputString='type="NN" span="123..145" confidence="1.0" '
strings=re.findall('"([^"]*)"', inputString)
print strings 
```

两个版本的输出：

```
['NN', '123..145', '1.0'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:12:42.500

```
fields = inputString.split('"')
print fields[1], fields[3], fields[5] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:14:19.610

您可以在每个空格处拆分字符串以获取 'key="value"' 子字符串列表，然后使用正则表达式解析子字符串。

使用您的输入字符串：

```
>>> input_string = 'type="NN" span="123..145" confidence="1.0" '
>>> input_string_split = input_string.split()
>>> print input_string_split
[ 'type="NN"', 'span="123..145"', 'confidence="1.0"' ] 
```

然后使用正则表达式：

```
>>> import re
>>> pattern = r'"([^"]+)"'
>>> for substring in input_string_split:
      match_obj = search(pattern, substring)
      print match_obj.group(1)
NN
123..145
1.0 
```

正则表达式 '"([^"]+)"' 匹配引号内的任何内容（前提是至少有一个字符）。圆括号表示您感兴趣的正则表达式的位。

# linux - 自动构建 c/c++ 程序的 Web 界面？

> ID：12059645
> 
> 赞同：0
> 
> 时间：2012-08-21T16:59:29.307
> 
> 标签：linux, web-applications, build-automation

嗨，我有一些 c/c++ 项目正在开发中，并且使用 git 进行版本控制。我想制作/找到一个网络界面程序，它应该：

*   一键建立项目的前沿目标。
*   查看每个构建的构建错误/日志。
*   成功构建后，将构建目标（我的 deb 文件）导出到公共位置。

有没有现有的/类似的工具？还是我应该建立自己的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:02:49.460

您在谈论的是[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)，并且有许多可用的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:03:03.953

[Jenkins](http://jenkins-ci.org/)等持续集成服务器是一种变体

# eclipse - 将 IBM Websphere Application Server V8.5 添加到 Eclipse SpringSource Tool Suite v2.9.1 时出错

> ID：12059646
> 
> 赞同：0
> 
> 时间：2012-08-21T16:59:29.133
> 
> 标签：eclipse, websphere, websphere-liberty

我尝试将 IBM WAS V8.5 添加到 SpringSource Tool Suite v2.9.1，但失败并显示以下错误消息：

*当我在 Eclipse 中选择 C:\Program Files\IBM\WebSphere\AppServer 路径时缺少 lib/features 文件夹*（SpringSource Tool Suite v2.9.1）。

我已将 IBM Websphere WAS Liberty Profile Adapter 安装到 eclipse（SpringSource Tool Suite v2.9.1）中。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T07:00:02.777

我已经解决了这个问题，但手动安装了这些工具。

# python - 在 python 中解析 XML 文件以发送电子邮件

> ID：12059648
> 
> 赞同：1
> 
> 时间：2012-08-21T16:59:38.637
> 
> 标签：python, xml, xml-parsing

我正在用 python 编写代码，它不仅可以读取 xml，还可以将解析结果作为电子邮件发送。现在我在尝试读取 xml 中的文件时遇到了麻烦。我制作了一个简单的 python 脚本，我认为它至少可以读取文件，然后我可以尝试在 python 中发送电子邮件，但我在第 4 行收到语法错误。

root.tag '日志'

无论如何，这是我到目前为止编写的代码：

```
import xml.etree.cElementTree as etree

tree = etree.parse('C:/opidea.xml')
response = tree.getroot()
log = response.find('log').text
logentry = response.find('logentry').text
author = response.find('author').text
date = response.find('date').text
msg = [i.text for i in response.find('msg')] 
```

现在xml文件有这种格式

```
 <log>
<logentry
   revision="12345">
<author>glv</author>
<date>2012-08-09T13:16:24.488462Z</date>
<paths>
<path
   action="M"
  kind="file">/trunk/build.xml</path>
</paths>
 <msg>BUG_NUMBER:N/A
FEATURE_AFFECTED:N/A
   OVERVIEW:Example</msg>
</logentry>
</log> 
```

我希望能够发送此 xml 文件的电子邮件。现在虽然我只是想让 python 代码读取 xml 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:06:39.480

`response.find('log')`什么也找不到，因为：

> 查找（自我，路径，命名空间=无）
> 
> 按标签名称或路径查找第一个匹配的子元素。

在您的情况下`log`，不是子元素，而是根元素本身。不过，您可以直接获取其文本：`response.text`. 但是在您的示例`log`中，无论如何，元素中都没有任何文本。

编辑：抱歉，文档中的引用实际上适用于`lxml.etree`文档，而不是`xml.etree`.

我不确定原因，但所有其他调用`find`也返回`None`（您可以通过打印`response.find('date')`等方式找到它）。使用[`lxml`](http://lxml.de/)ou 可以`xpath`改用：

```
author = response.xpath('//author')[0].text
msg = [i.text for i in response.xpath('//msg')] 
```

在任何情况下，您对 的使用`find`都不正确`msg`，因为`find`总是返回单个元素，而不是它们的列表。

# asp.net - 如何让asp.net下载动态csv

> ID：12059652
> 
> 赞同：2
> 
> 时间：2012-08-21T16:59:48.667
> 
> 标签：asp.net, vb.net, csv

ENV：Asp.Net Vb / Visual Studio 2010 / .Net 4 IIS Express 和 IIS 6

我有一个名为 download.aspx 的页面，它从数据库创建 csv 数据，但无法让浏览器使用正确的文件名下载它。我的理解是 Content-Disposition 给它一个文件名，但下载始终是我的页面名称，而不是 download.aspx。

我确定我对它的工作原理有误解，我在这里搜索了指导，但似乎无法获得任何解决方案。我有以下内容：

```
 Response.Clear()
    Response.ContentType = "text/csv"
    Response.AppendHeader("Content-Disposition", "attachment: filename=leadership.csv")
    Response.Write("test,test,test")
    Response.Flush()
    Response.End() 
```

我试过“application/csv”和“application/x-download”没有区别。我也在具有相同文件名问题的 .ashx 文件中进行了尝试。我怎样才能让文件以leadership.csv 而不是download.aspx 的形式出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:02:14.423

Content-Dispostion 标头错误。价值

```
attachment: filename=leadership.csv 
```

应该是（带有可选空格）

```
attachment; filename=leadership.csv 
```

请注意，`:`用于分隔标头和值的 已更改`;`为用于分隔子值的 a。

此外，我建议使用*库*来生成 CSV，如果还没有的话..

# html - 底部边框不覆盖顶部边框

> ID：12059653
> 
> 赞同：0
> 
> 时间：2012-08-21T17:00:00.083
> 
> 标签：html, css

我正在为屏幕构建一系列选项卡，左侧的 div 在顶部边框方面与右侧的 div 的行为不同。

![在此处输入图像描述](../Images/9162fcafa19d3b161a8f6b67c2a45b13.png)

![在此处输入图像描述](../Images/5f463c2ed3bac8c09d618125fda7406d.png)

![在此处输入图像描述](../Images/41ca6c0ee0d080bd8c2e03bc71b3f2ba.png)

我在两个并排放置的 div 顶部有一个无序列表 (ul)，它们充当两列。为了帮助演示，我有两个 div 的顶部边框，让用户觉得这是内容。为了进一步帮助演示，我将活动选项卡的底部边框设置为白色，因此选项卡下方似乎没有边框，并且选项卡和内容区域是相同的空间。我遇到的问题是选项卡的底部边框覆盖右列但不是左侧，但在右侧顶部覆盖底部。

[http://jsfiddle.net/z39zV/](http://jsfiddle.net/z39zV/)

您将不得不调整屏幕大小以使屏幕显示问题，因为其中一项要求是具有扩展的右列。

我在 IE、Chrome 和 FF 中试过这个，它们都显示相同的东西。左列有一个浮动，所以它可能与此有关，但我不知道是什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:40:04.187

您可以将无序列表的位置属性设置为相对，以便将其放置在堆栈中更远的位置。这是小提琴。

[http://jsfiddle.net/z39zV/4/](http://jsfiddle.net/z39zV/4/)

我还建议将边框从 a 元素移动到它们的父 li 元素，并将两个较低的 div 包装在一个具有完整边框的 div 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:12:15.850

更新了jsfiddle：

[http://jsfiddle.net/z39zV/1/](http://jsfiddle.net/z39zV/1/)

您没有浮动两列，这是主要问题：

```
 .column_container_left {
        float: left;
        width: 200px;
        border-top:thin solid grey;                    
        border-bottom:thin solid grey;    
        border-left:thin solid grey;
        background-color: white;
        height: 500px;
    }

    .column_container_right {
        float: left;
        width: 200px;
        border-top:thin solid grey;                    
        border-bottom:thin solid grey;    
        border-right:thin solid grey;
        background-color: white;
        height: 500px;
    } 
```

# java - 为 Image 组件创建 Java 控件

> ID：12059654
> 
> 赞同：0
> 
> 时间：2012-08-21T17:00:02.377
> 
> 标签：java, jsf, xpages, xpages-extlib

[使用在 NSF 中创建 Java 控件](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Creating_a_Java_Control_in_an_NSF)的教程，我能够创建一个简单的 Java 控件。现在我想扩展它以便它显示图像，所以我按以下方式修改了代码：

这是现在扩展`UIGraphicEx`类而不是扩展类的示例控件类`UIComponentBase`。

```
package com.example.component;
import com.ibm.xsp.component.UIGraphicEx;
public class ExampleControl extends UIGraphicEx {
    public ExampleControl() {
        super();
        setRendererType("com.ibm.xsp.ImageEx");

    }
    @Override
    public String getFamily() {
        return "com.example.examplecontrol";
    }
} 
```

这是`xsp-config`上面定义的示例控件类的文件。我通过添加`<base-component-type>`value as`com.ibm.xsp.component.UIGraphicEx`并设置`<renderer-type>`为 来修改它`com.ibm.xsp.ImageEx`。

```
<faces-config>
    <faces-config-extension>
        <namespace-uri>http://example.com/xsp/control</namespace-uri>
        <default-prefix>eg</default-prefix>
    </faces-config-extension>
    <component>
        <description>Example</description>
        <display-name>Example Control</display-name>
        <component-type>com.example.examplecontrol</component-type>
        <component-class>com.example.component.ExampleControl</component-class>
        <component-extension>
            <base-component-type>com.ibm.xsp.component.UIGraphicEx</base-component-type>
            <component-family>com.example.examplecontrol</component-family>
            <renderer-type>com.ibm.xsp.ImageEx</renderer-type>
            <tag-name>exampleControl</tag-name>
            <designer-extension>
                <category>Example</category>
                <selected-event>onclick</selected-event>
            </designer-extension>
        </component-extension>
    </component>
</faces-config> 
```

我的渲染器类看起来像这样。`ResponseWriter`在这里，我没有使用类，而是将`UIComponent`对象转换为`UIGraphicEx`并设置其 URL（图像存在于同一数据库中）。

```
package com.example.renderkit.html_basic;
import javax.faces.render.Renderer;
import java.io.IOException;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import com.ibm.xsp.component.UIGraphicEx;
public class ExampleRenderer extends Renderer {
    @Override
    public void encodeBegin(FacesContext context, UIComponent component) throws IOException {
        UIGraphicEx g = (UIGraphicEx)component;
        g.setUrl("review_icon.gif");
        g.setRendered(true);
        System.out.println("-----------" + g.getUrl());
    }
    @Override
    public void encodeEnd(FacesContext context, UIComponent component) throws IOException {
    }
} 
```

当我将此控件放在 XPage 中时，没有给出输出，但是`System.out.println`方法中的语句`encodeBegin`会在控制台中启动。我在这里做错了什么？这是正确的方法吗？

我的最终目标是动态生成图像数据（基于一些输入），然后通过渲染器将其放入图像控制中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T22:38:23.103

请务必确保在组件 xsp-config 和 faces-config 中定义相同的族。另外，正如 Toby 所说，您没有向 ResponseWriter 写任何内容。您需要使用 ResponseWriter 将一些 html 输出到屏幕上。或者，如果您只想输出与 UIGraphicEx 渲染器完全相同的内容，请让您的渲染器扩展它（UIGraphicEx Renderer 类）并调用 super.encodeBegin() 和 super.encodeEnd()。

```
package com.example.renderkit.html_basic;
import javax.faces.render.Renderer;
import java.io.IOException;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import com.ibm.xsp.component.UIGraphicEx;
public class ExampleRenderer extends Renderer {
    @Override
    public void encodeBegin(FacesContext context, UIComponent component) throws IOException {
        UIGraphicEx g = (UIGraphicEx)component;
        g.setUrl("review_icon.gif");
        g.setRendered(true);
        ResponseWriter writer = context.getResponseWriter();
        writer.append("<img src='http://someserver/somedb.nsf/review_icon.gif' />");
        System.out.println("-----------" + g.getUrl());
    }
    @Override
    public void encodeEnd(FacesContext context, UIComponent component) throws IOException {
    } 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:19:00.357

编辑：您不能包装 xagent 并将其部署在服务器范围内。我建议使用 servlet 并通过 OSGI 插件部署它。

# ios - ios - 创建存档后不会出现 xCode 更改

> ID：12059655
> 
> 赞同：0
> 
> 时间：2012-08-21T17:00:04.207
> 
> 标签：ios, xcode, ios5

我刚刚创建了一个存档，现在我正在尝试添加更多更改，但由于某种原因，当我运行模拟器时，我所做的更改没有显示出来，并且旧版本的应用程序运行。

此外，我的存储库显示了更改的文件，但由于某种原因，xCode 编译了它们的先前版本。

有谁知道为什么会出现我所处的困境？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:08:54.100

您是否更改了捆绑 ID 以制作存档？如果你这样做，xcode 将构建应用程序，感觉就像安装新应用程序一样，但你实际上只看到以前的版本。

您应该删除手机上的所有版本，进行清理，然后再次运行以尝试修复此问题，除非还有其他事情发生。

# javascript - 旋转图像 Raphael.js

> ID：12059657
> 
> 赞同：1
> 
> 时间：2012-08-21T17:00:17.280
> 
> 标签：javascript, jquery, svg, rotation, raphael

我有以下 jQuery：

```
var paper = Raphael(0, 20, 500, 500);

var robot = paper.image("http://jackdent.co.uk/arrow-right.jpg", 0, 0, 20, 20);
robot.node.setAttribute('id', 'robot');

$('#submit').on('click', function () {
    $('#robot').rotate(90);
}) 
```

由于某些原因，我需要使用分配给它的 id 访问机器人元素。当客户端单击按钮时，我想将图像旋转 90 度。目前我的代码是错误的，我不知道为什么。

任何帮助将不胜感激，在此先感谢。

[在此处](http://jsfiddle.net/Vre9W/17/)查看实时示例

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T17:02:21.720

采用：

```
robot.rotate(90); 
```

代替

```
$('#robot').rotate(90); 
```

演示：http: [//jsfiddle.net/Vre9W/18/](http://jsfiddle.net/Vre9W/18/)

# css - 是否可以使用css下拉/左/右/上图像

> ID：12059660
> 
> 赞同：0
> 
> 时间：2012-08-21T17:00:29.073
> 
> 标签：css

我正在尝试使用仅使用 HTML 和 CSS 创建将在悬停时向任何方向退出的图像。

它的意思是：

*   未悬停：显示图像的一部分
*   hover：图像的剩余部分滑出（以 CSS 指定的方向）

我试过做什么：

a`<div>`保持 a`background-image`在某个高度处切断并在悬停时使用 css 动画滑出

```
<html>
<body>
<style>
    @-webkit-keyframes resize {
        0% {
        }
        100% {
            height: 446px;
        }
    }

    #pic {
        height: 85px;
        width: 500px;
        background-image: url(http://images5.fanpop.com/image/photos/31400000/Cow-cows-31450227-500-446.jpg);
    }

    #pic:hover {
        -webkit-animation-name: resize;
        -webkit-animation-duration: 1s;
        -webkit-animation-iteration-count: 1;
        -webkit-animation-delay: 0.5s;
        -webkit-animation-direction: normal;
        -webkit-animation-fill-mode: forwards;
    }
</style>
<div id="pic"></div>
<p class="center">Hover over me</p>
</body>
</html> 
```

这种方法的问题在于，这会将其他内容移出我不想要的方式。如果我想将图像向左、向右或向上滑动，这种方法也不起作用。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:30:44.247

我将您的代码放在小提琴上，并为您制定了一些示例：

*   下移：http: [//jsfiddle.net/rcCeP/](http://jsfiddle.net/rcCeP/)
*   向上移动：http: [//jsfiddle.net/rcCeP/1/](http://jsfiddle.net/rcCeP/1/)
*   向右移动：http: [//jsfiddle.net/rcCeP/2/](http://jsfiddle.net/rcCeP/2/)
*   向左移动：http: [//jsfiddle.net/rcCeP/3/](http://jsfiddle.net/rcCeP/3/) 为了好玩：
*   从中心：http: [//jsfiddle.net/rcCeP/4/](http://jsfiddle.net/rcCeP/4/)
*   在文档流中：http: [//jsfiddle.net/rcCeP/5/](http://jsfiddle.net/rcCeP/5/)（注意xtra包装器具有相对定位）
*   **我将如何做到这一点**，使用过渡而不是动画，在两个方向上工作并在旧浏览器上优雅地降级：http: [//jsfiddle.net/rcCeP/6/](http://jsfiddle.net/rcCeP/6/)

*我可以整天这样继续下去，这真的很有趣......*

防止内容被推送的关键是使图片位置绝对。这会将其从文档流中提取出来。然后方向就变成了使用位置和背景位置值的问题。

希望这可以帮助！

# node.js - Heroku 上的 Node.js Express 应用程序不会使用 Mongoose 连接到 MongoLab 数据库

> ID：12059661
> 
> 赞同：4
> 
> 时间：2012-08-21T17:00:35.983
> 
> 标签：node.js, mongodb, heroku, express, mongoose

我正在尝试让我的 node.js express 应用程序使用 Mongoose 连接到 Heroku 上的 MongoLab 数据库。我曾经`app.configure`将我的数据库 URI 设置为我的 MongoLab URI on `production`，正如您在 Heroku 日志中看到的那样，它肯定设置`dbURI`为 MongoLab URI。我已经明确设置`NODE_ENV`为`production`. 我的问题是什么？

**应用程序.js**：

```
var express = require('express');
var mongoose = require('mongoose')
  , dbURI = 'localhost';
var app = express();

app.configure('production', function () {
    console.log("production!");
    dbURI = 'mongodb://brad.ross.35:Brad1234@ds031347.mongolab.com:31347/heroku_app6861425';
    console.log(dbURI);
});

mongoose.connect(dbURI, 'test');
mongoose.connection.on('error', console.error.bind(console, 'connection error:'));

var postSchema = new mongoose.Schema({
    body: String
});

var Post = mongoose.model('Post', postSchema);

app.configure(function () {
    //app.use(express.logger());
    app.use(express.bodyParser());
    app.use(express.static(__dirname + '/static'));
});

app.set('views', __dirname + '/views');
app.set('view engine','jade');

app.get('/', function(request, response) {
    response.render('index');
});

app.post('/result', function(request, response) {
    var post = new Post({body: request.body.text});
    post.save(function (err) {
        if (err) {
            console.log("error!");
        } else {
            console.log("saved!");
        }
    });

    Post.find(function (err, posts) {
        if (!err) {
            console.log("found!");
            console.log(posts);
            response.render('result', {posts: posts});
        } else {
            console.log("error!");
            response.render('result', {posts: []});
        }
    });
});

app.get('/result', function (request, response) {
    Post.find(function (err, posts) {
        if (!err) {
            console.log("found!");
            console.log(posts);
            response.render('result', {posts: posts});
        } else {
            console.log("error!");
            response.render('result', {posts: []});
        }
    });
});

app.listen(process.env.PORT || 5000); 
```

**Heroku 日志**：

```
2012-08-21T16:52:21+00:00 heroku[web.1]: State changed from crashed to starting
2012-08-21T16:52:22+00:00 heroku[slugc]: Slug compilation finished
2012-08-21T16:52:23+00:00 heroku[web.1]: Starting process with command `node app.js`
2012-08-21T16:52:24+00:00 app[web.1]: production!
2012-08-21T16:52:24+00:00 app[web.1]: mongodb://brad.ross.35:PASSWORD@ds031347.mongolab.com:31347/heroku_app6861425
2012-08-21T16:52:24+00:00 app[web.1]: connection error: [Error: failed to connect to [ds031347.mongolab.com:31347/heroku_app6861425:27017]]
2012-08-21T16:52:25+00:00 heroku[web.1]: State changed from starting to up 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T19:36:01.813

传递 URI 时，无需单独传递数据库名称（这会使 mongoose 感到困惑）。

做就是了

```
var uri = 'mongodb://brad.ross.35:Brad1234@ds031347.mongolab.com:31347/heroku_app6861425'
mongoose.connect(uri) 
```

要使用测试数据库，请更改您的 uri：

```
var uri = 'mongodb://brad.ross.35:Brad1234@ds031347.mongolab.com:31347/test' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:34:53.103

我没有与 Mongoose 合作过，但是当我过去与 MongoLab 的连接问题时，这是由于连接到数据库和假定连接的客户端代码引起的竞争条件。通常，解决方案是绑定到`open`事件或提供由底层驱动程序调用的回调，然后再恢复需要连接的启动。这就是我所做的`Mongoskin`，我从来没有遇到过问题。

迈克

# c - C 指针指针和段错误

> ID：12059663
> 
> 赞同：1
> 
> 时间：2012-08-21T17:00:40.257
> 
> 标签：c, pointers, segmentation-fault

下面是我在 C 中的简单链表。我的问题在“headRef = &newNode;”中 这会导致分段错误。然后我尝试了“*headRef = newNode;” 这解决了段错误问题。尽管在我看来这两行代码以相同的方式工作，但为什么一个会导致 seg fault 而另一行不会呢？提前致谢。

```
struct node{
  int data;
  struct node* next;
};

void Push(struct node** headRef, int data){
  struct node* newNode = malloc(sizeof(struct node));
  if(!newNode) return;
  newNode->data = data;
  newNode->next = *headRef;
  headRef = &newNode;
  return;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:03:30.257

`newNode`已经是一个地址，你已经将它声明为一个指针：`struct node *newNode`。随着`*headRef = newNode`您将该地址分配给类似的指针， a`struct node *`到 a `struct node *`。

混淆`headRef = &newNode` *似乎*同样有效，因为类型一致：您分配给`struct node **`another `struct node **`。

但这是错误的，原因有二：

1.  您想更改函数参数`headRef`a的值`struct node *`。您已将*地址*传递`headRef`给函数，因为 C 是按值传递的，因此要更改变量，您需要它的地址。您要更改的这个变量**是**一个地址，因此您将一个指针传递给一个指针 a `struct node **`: 需要额外的间接级别，以便您可以在函数内更改地址，并将该更改反映在函数*外部*。因此，在函数中，您需要*取消引用*变量以获取您想要更改的内容：在您的函数中，您想要更改`*headRef`，**而不是** `headRef`.
2.  取地址`newNode`是创建不必要的间接级别。如上所述，您要分配的值是*持有* `newNode`的地址，而**不是**的地址*。* `newNode`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:05:08.403

您对通过指针的引用语义有一个基本的误解。这是核心示例：

```
// Call site:
T x;
modify(&x);         // take address-of at the call site...

// Callee:
void modify(T * p)  // ... so the caller takes a pointer...
{
    *p = make_T();  // ... and dereferences it.
} 
```

所以：调用者获取地址，被调用者取消引用指针并修改对象。

在您的代码中，这意味着您需要说`*headRef = newNode;`（在我们的基本示例中，您有`T = struct node *`）。你搞错了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:05:23.373

`headRef = &newNode`是局部赋值，所以赋值只在函数范围内有效`Push`。如果对 的更改`headRef`应该在`Push`您需要做的外部可见`*headRef = newNode`。此外，这两者并不等价。`headRef = &newNode`将节点指针的地址分配给指向节点指针的指针，而`*headRef = newNode`使用间接将节点的地址分配给指向节点的指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T17:05:36.120

您正在设置`headRef`保存位于堆栈上的变量的地址；一旦你的`Push()`函数返回，堆栈就不再有效，你可以指望它被覆盖。这是段错误的可靠方法。

# django - 没有办法在 django 1.4 上使用 mongodb 吗？

> ID：12059666
> 
> 赞同：0
> 
> 时间：2012-08-21T17:01:03.427
> 
> 标签：django, mongodb, django-nonrel, django-1.4

**我想在 django 1.4 上使用 mongodb ..**
还没有 nonrel ..
公会仍然适用于 1.3
[http://django-mongodb.org/topics/setup.html](http://django-mongodb.org/topics/setup.html)
还有其他方法吗？！？ ！
其他教程什么的？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:54:42.273

[Django nonrel](https://bitbucket.org/wkornewald/django-nonrel/src)是一个分支。因此，您不会完全使用 Django 1.3 或 1.4。Mongoengine 和[Pymongo](http://api.mongodb.org/python/current/)很容易上手，但你不会`django.contrib`在 mongodb 上使用像 auth 和 admin 这样的应用程序。如果您需要 contrib 应用程序并想使用 django ORM，我认为最好的方法是使用 Postgres。然后，您可以将 MongoDB 用于不同的事情。几年前我做了一个小小的[一次性实验，我还没有检查过。](https://github.com/skyl/djongobj)这个想法是像往常一样使用 Django 的 ORM，但能够将文档添加到实例和集合到类。您可以将其用作一种教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:41:53.577

Django in any branch does not have explicit support for no-rel databases.

However, integrating mongo for some things is fairly simple:

[http://mongoengine.org/](http://mongoengine.org/)

There is also the non-rel fork, which is mostly DIW in terms of active development.

# css - 确定我有多少样式规则的方法

> ID：12059667
> 
> 赞同：0
> 
> 时间：2012-08-21T17:01:04.547
> 
> 标签：css, ruby-on-rails, ruby, internet-explorer

我正在做一个网站。它非常大，有 100 多个样式表，而且我（再次）开始在 IE 中丢失样式。我已经将rails 配置为将我所有的CSS 编译到一个文件中，而我只会在IE 中丢失样式。IE 只能编译 4095 样式规则。

有没有一种快速简便的方法来确定网站有多少样式规则？我在各个地方都看过，但没有看到这样的选择。

此外，是否有一个用于 ruby​​/rails 的好工具可以最大限度地减少您的样式？

谢谢
-布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:39:53.250

通过命令行：您可以将 html 文件传递​​给 grep，并对 css 的出现进行字数统计。

```
grep css index.html | wc -l 
```

# java - 在 Java 中检测当前是否在没有 KeyEvent 的情况下按下了键 (CTRL)

> ID：12059669
> 
> 赞同：7
> 
> 时间：2012-08-21T17:01:06.277
> 
> 标签：java, ctrl

我需要能够查看`CTRL`在处理鼠标事件期间当前是否正在按下该键。我曾尝试使用 KeyListener，但由于焦点问题，尝试同时使用鼠标事件和键事件被证明是一个问题。

我基本上想要完成的是使用`CTRL`Windows 中的键选择多个对象。

如果在我的鼠标事件中，我可以检查键的状态会容易得多`CTRL`......

你能用Java做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-21T17:21:18.250

用于`getModifiers()`检测按下的键..

**例如：**

```
if ((event.getModifiers() & ActionEvent.CTRL_MASK) ==ActionEvent.CTRL_MASK) {
System.out.println("CTRL KEY PRESSED");
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-21T17:02:40.113

MouseEvent 从 InputEvent 扩展而来，我认为您仍然可以从该对象中获取修饰符，`getModifiers()`以查看是否按下了 ctrl 键。我还没有测试过这个。

# css - 媒体查询语法

> ID：12059671
> 
> 赞同：0
> 
> 时间：2012-08-21T17:01:16.497
> 
> 标签：css, media-queries

我知道它的主题很简单，但我发现 w3.com 上提供的语法相当复杂。任何人都可以解码它吗？理解它重要吗？

[这里的语法](http://www.w3.org/TR/css3-mediaqueries/#syntax)：

```
media_query_list
 : S* [media_query [ ',' S* media_query ]* ]?
 ;
media_query
 : [ONLY | NOT]? S* media_type S* [ AND S* expression ]*
 | expression [ AND S* expression ]*
 ;
media_type
 : IDENT
 ;
expression
 : '(' S* media_feature S* [ ':' S* expr ]? ')' S*
 ;
media_feature
 : IDENT
 ; 
```

它还指定了它下面的一些标记。任何人都可以请解码它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T07:49:45.620

这是语法的正式[EBNF](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form)定义。如果您正在寻找易于阅读的示例，请查看[标准的第 2 章](http://www.w3.org/TR/css3-mediaqueries/#media0)。

简而言之，`S`代表空格字符、`IDENT`标识符（如`foobar2`）、`*`零次或多次重复。让我们详细介绍一下：

```
media_query_list
 : S* [media_query [ ',' S* media_query ]* ]?
 ; 
```

表示 a `media_query_list`（即可以在 中的所有内容`@media ( here )`）由一个或多个 组成`media_query`，以逗号和可选间距分隔。例如，这些是有效`media_query_list`的 s：

```
media_query
 media_query,  media_query,   media_query,media_query 
```

的定义在`media_query`后面给出，在

```
media_query
 : [ONLY | NOT]? S* media_type S* [ AND S* expression ]*
 | expression [ AND S* expression ]* 
```

手段有`|`两种形式。任何一个

```
 media_type
 ONLY media_type
 NOT media_type 
```

（和可选表达式，用 连接`AND`），*或者*只是一个表达式，后面跟着可选的多个其他表达式，用 . 连接`AND`。

表达式定义如下：

```
expression
 : '(' S* media_feature S* [ ':' S* expr ]? ')' S* 
```

这意味着它总是在括号中，并且仅包含一个`media_feature`，或一个媒体功能，后跟一个`expr`. 例如，这些是有效的表达式：

```
(foo)
(foo: 2px) 
```

在这个定义中，`media_type`and`media_feature`可以是任意标识符。在实践中，它们将是浏览器识别的标识符，例如`print`、`screen`等`max-width`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-07T17:48:04.033

**对于那些可能对上述语法感到困惑的人**，请查看我的帖子[，](https://stackoverflow.com/a/23524569/1963978)了解我所理解的媒体查询语法的技术性解释。在这里有意义地重新发布太长了：

[https://stackoverflow.com/a/23524569/1963978](https://stackoverflow.com/a/23524569/1963978)

# objective-c - 如何在 Objective-C 中生成随机小写字母？

> ID：12059672
> 
> 赞同：2
> 
> 时间：2012-08-21T17:01:30.487
> 
> 标签：objective-c, random

我是语法新手，所以这就是我需要帮助的地方。从概念上讲，我明白了。但是语法对我来说是陌生的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T17:25:04.440

这是一个简洁的方法：

```
- (char)getRandomChar {
    return (char) (arc4random_uniform(26) + 'a');
} 
```

这假设您想要 'a' 到 'z'，没有任何带有变音符号的字母，例如 å、ä、á 等。

要将字符作为 NSString 返回：

```
- (NSString *)getRandomCharAsNString {
    return [NSString stringWithFormat:@"%c", arc4random_uniform(26) + 'a'];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-21T17:11:24.897

我将创建一个字符串“abcdefg ...”并在随机位置获取一个字符长的子字符串。
像这样：

```
NSString *letters = @"abcdefghijklmnopqrstuvwxyz";
NSInteger index = arc4random_uniform([letters length]);
NSString *randomLetter = [letters substringWithRange:NSMakeRange(index, 1)]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T17:14:08.267

Objective-c 是 C 的超集，这意味着您可以使用有效的 C 代码。

```
-(char)getRandomChar
{
     char test[] = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'};
     int r = arc4random() % 26;
     NSLog(@"%c", test[r]);
     return test[r];
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-27T14:14:58.460

这看起来不错的样子

```
NSLog(@"%c",'a'+ rand() % 26); 
```

# python - 使用 cgitb 获取 HTML 正文

> ID：12059674
> 
> 赞同：1
> 
> 时间：2012-08-21T17:01:35.013
> 
> 标签：python, cgi, cgitb

我正在使用 cgitb (python 2.7) 创建 html 文档服务器端。我有文件进行一堆查询，然后生成 html。我希望能够仅链接 html，因此如果我可以将 html 打印到新文件并将其链接，它将起作用。

有没有办法获取页面将在处理结束时生成的 html，以便我可以将其放入新文件中，而无需跟踪我迄今为止所做的一切？

编辑：在这里找到一个片段：[https ://stackoverflow.com/a/616686/1576740](https://stackoverflow.com/a/616686/1576740)

```
class Tee(object):
    def __init__(self, name, mode):
        self.file = open(name, mode)
        self.stdout = sys.stdout
        sys.stdout = self
    def __del__(self):
        sys.stdout = self.stdout
        self.file.close()
    def write(self, data):
        self.file.write(data)
        self.stdout.write(data) 
```

您必须在导入 cgi 后调用它，因为它以一种不太友好的方式覆盖标准输出。但工作就像一个魅力。

我只是 import cgi;....... Tee(filname, "w") 然后我有一个指向该文件的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:43:44.950

From the [Python Documentation](http://docs.python.org/library/cgitb.html)

> Optionally, you can save this information to a file instead of sending it to the browser.

In this case you would want to use

```
cgitb.enable(display=1, logdir=directory) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-21T15:22:19.820

```
import cgitb
import sys

try:
    ...
except:
    with open("/path/to/file.html", "w") as fd:
        fd.write(cgitb.html(sys.exc_info())) 
```

# javascript - 将侦听器函数添加到 JavaScript 对象

> ID：12059676
> 
> 赞同：6
> 
> 时间：2012-08-21T17:01:39.040
> 
> 标签：javascript, function, callback, listener

我有以下代码定义了一个`Car`. 每个`Car`都有颜色和`setColor(color)`功能。我想添加在被调用时`setColor(color)`调用的侦听器函数，并且我希望能够随时添加这些侦听器函数。这是一个合适的方法吗？有没有更清洁的方法？

```
function Car() {

    this._color = 'red';
    this._callbacks = {};

    this.setColor = function(color) {
        this._color = color;
        console.log(">>> set car color to " + color);
        if (this._callbacks['setColor']) {
            this._callbacks['setColor']();
        }
    };

    this.addListener = function(functionName, handler) {
        if (this._callbacks[functionName]) {
            var oldCallback = this._callbacks[functionName];
            this._callbacks[functionName] = function() {
                oldCallback();
                handler();
            }
        } else {
            this._callbacks[functionName] = function() {
                handler();
            }
        }
    };

}

var car = new Car();
car.setColor('blue');
car.addListener('setColor', function() { console.log("This is listener # 1"); });
car.setColor('green');
car.addListener('setColor', function() { console.log("This is listener # 2"); });
car.setColor('orange'); 
```

**输出：**

```
>>> setColor to blue
>>> setColor to green
This is listener # 1
>>> setColor to orange
This is listener # 1
This is listener # 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:11:33.027

我认为存储侦听器的数组将是一种更清洁的方法。此外，您应该使用原型对象，或将半私有属性设为真正的私有变量。

```
function Car() {
    this._color = 'red';
    this._callbacks = {setColor:[]};
};
Car.prototype.setColor = function(color) {
    this._color = color;
    console.log(">>> set car color to " + color);
    for (var i=0; i<this._callbacks['setColor'].length; i++)
        this._callbacks['setColor'][i]();
};
Car.prototype.addListener = function(functionName, handler) {
    this._callbacks[functionName].push(handler);
}; 
```

或者：

```
function Car() {
    var color = 'red';
    var callbacks = {};

    this.setColor = function(c) {
        color = c;
        console.log(">>> set car color to " + color);
        for (var i=0; 'setColor' in callbacks && i<callbacks['setColor'].length; i++)
            callbacks['setColor'][i]();
    };
    this.addListener = function(functionName, handler) {
        if (functionName in callbacks)
            callbacks[functionName].push(handler);
        else
            callbacks[functionName] = [handler];
    };
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:11:29.533

可能是这样的。

```
//the 'class'
function Car() {

    //set up a static listeners object - an array for each method
    Car.listeners = {setColor: []};

    //called by methods on invocation, to fire their listeners
    Car.executeListeners = function(methodName) {
        for (var i=0, len = Car.listeners[methodName].length; i<len; i++)
            Car.listeners[methodName][i].apply(this);
    };

    //method - on invocation, fire any listeners
    this.setColor = function(color) {
        this.color = color;
        Car.executeListeners.call(this, 'setColor');
    };
}

//instance
var car = new Car();

//add a listener to instance.setColor invocations
Car.listeners.setColor.push(function() {
    alert("hello - this car's color is "+this.color);
});

//set color (triggers listener)
car.setColor('orange'); 
```

请注意，您将prototype-esq 方法分配给实例而不是原型本身——继承的、可重用功能的地方。继承在性能方面也更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T17:08:38.513

如果它对您有用，那么我认为没有理由不使用它。关于这种方法的一些想法：

*   您不能设置处理程序的上下文，如果应该针对某个对象调用处理程序，则应该让该`addListener`方法采用上下文对象并执行`callback.call(context)`. 如果您不关心这一点，则无需担心。
*   如果早期的回调发生故障，后面的回调将不会被调用。不确定你是否关心这个，但如果你关心的话，你可以改为使用一个数组来存储所有回调，并遍历数组依次调用每个回调。您可能需要将对回调的调用包装在 try/catch 块中，以确保不断调用回调。
*   您想将当前颜色传递给回调吗？甚至是 Car 对象本身，例如`callback(this, this._color)`?
*   您的方法使用了相当数量的闭包。如果您发现性能成为一个问题，那么摆脱闭包会有所帮助。

要考虑的另一件事是使用`Object.defineProperty`，但这是一个更具风格的选择。

# computational-geometry - 用最少数量的矩形覆盖凹多边形

> ID：12059680
> 
> 赞同：3
> 
> 时间：2012-08-21T17:01:58.573
> 
> 标签：computational-geometry, combinatorics

我很想用最小的矩形覆盖一个简单的凹多边形。我的矩形可以是任意长度，但它们具有最大宽度，并且多边形永远不会有锐角。

我想过尝试将我的凹多边形分解为三角形，这些三角形生成一组最小重叠的矩形，最小限度地限制每个三角形，然后将这些矩形合并成更大的矩形。但是，我认为这不适用于多边形边缘的小凹口。由这些凹口上的反射顶点创建的三角形将创建错误的矩形。我正在寻找可以跨越/忽略缺口的矩形。

我对计算几何一无所知，所以我不确定如何开始提出这个问题。

我发现了其他类似的帖子，但不是我需要的：

*   [将多边形分割成最少数量的矩形和三角形](https://mathoverflow.net/questions/28303/split-polygon-into-minimum-amount-of-rectangles-and-triangles)
*   [用最少的正方形覆盖任意多边形](https://mathoverflow.net/questions/91279/covering-an-arbitrary-polygon-with-minimum-number-of-squares)
*   [找到 $k$ 矩形，使其覆盖最大点数](https://stackoverflow.com/questions/3476778/find-k-rectangles-so-that-they-cover-the-maximum-number-of-points)
*   [寻找覆盖一组矩形的最少矩形的算法](https://stackoverflow.com/questions/5919298/algorithm-for-finding-the-fewest-rectangles-to-cover-a-set-of-rectangles)

一些例子：黑色是输入。红色是可接受的输出。

![在此处输入图像描述](../Images/2893ec22da403b7e3cf2eccfd0a9f2a5.png)

另一个例子：首选第二个输出。但是，生成两个输出并使用另一个因素来确定偏好可能是必要的，而不是该算法的责任。

![在此处输入图像描述](../Images/5b17ec06ed4470b0f47c2afb173c2103.png)

![在此处输入图像描述](../Images/703feac513421c8281bcab725be48900.png)

模仿曲线的多边形极为罕见。在这种情况下，矩形的大部分区域都被浪费了。但是，这是可以接受的，因为每个矩形都遵循最大宽度约束。

![在此处输入图像描述](../Images/4bb06cdb0eee5a2b655fedb680a85aef.png)

另外，我发现这篇文章接近我需要的：

*   用Paul Iacob、Daniela Marinescu 和 Cristina Luca[的长方形作品覆盖](http://www.emis.de/journals/ASUO/mathematics/pdf6/75_86_PIacob_DMarinescu_CLuca.pdf)

也许更好的问题是“如何识别凹多边形的矩形部分？” ![在此处输入图像描述](../Images/2d9235e38ca0e26a4fda50f45071b536.png)

这是显示所需实现的图像： ![在此处输入图像描述](../Images/fd3cb9145f6d40705a3b02b19bc7c479.png)

绿色是实际的材料使用量。红色矩形是布局。蓝色是整个多边形的 MBR。我想我应该尝试获取小 MBR 并填充它们。左上角终止于多边形中间的 2-3 个绿色矩形很昂贵。这就是我想要最小化的。绿色矩形有最小和最大宽度和高度，但我可以使用尽可能多的行和列来覆盖一个区域。同样，我必须尽量减少不跨越输入的矩形数量。我还可以修改绿色矩形的形状以适应也非常昂贵的小地方。换句话说，让尽可能多的矩形尽可能多地跨越是理想的。

也许我应该简单地尝试识别这样的矩形区域： ![在此处输入图像描述](../Images/decfef31ba4263abccd3bb9b1c687fef.png)

或者，也许更好的方法是使用最大内接矩形而不是 MBR。我可以使用矩形不断地削减我的多边形，直到留下最大内接矩形不与原始多边形共享边的区域。其余区域必须采用启发式方法进行处理。

![在此处输入图像描述](../Images/b8e3df93423c8391b92ac04bc5f7d5fb.png)

我一直在与我公司的工程和制造部门合作，以进一步澄清这个问题。我仍在等待确认，但我现在认为返回最大内接矩形集的算法会起作用。虽然它没有完全覆盖形状，但它会优先考虑正交区域，同时将非正交区域留给一些启发式方法。唯一的技巧是最大化那些正交区域。

# java - 从java调用Perl，主要是正则表达式匹配

> ID：12059684
> 
> 赞同：1
> 
> 时间：2012-08-21T17:02:06.843
> 
> 标签：java, regex, perl

我想从 Java 高效地执行 Perl 代码。Perl 的目的主要是执行正则表达式匹配（在某些测试中，Perl 比 Java 更有效）

到目前为止，我发现使用它的可能性： http://metacpan.org/pod/Inline::Java:: [PerlInterpreter](http://metacpan.org/pod/Inline%3a%3aJava%3a%3aPerlInterpreter)

另一种选择是在 java 中使用 Runtime.exec() 来调用 Perl。

什么是最高效的解决方案？一个比另一个有优势吗？我真的看不到任何东西，除了 PerlInterpreter 仍然是实验性的，我不知道这是否会改变。你知道从 Java 调用 Perl 的任何其他选项吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:04:07.047

为什么你不喜欢你想要使用 Perl 的正则表达式功能的类[`java.util.regex.Pattern`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)？[`java.util.regex.Matcher`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html);-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-21T17:25:32.700

确实必须是一个非常特殊的情况，从 Java 执行 Perl 来处理正则表达式会产生更好的性能。不管 Perl 是否可以比 Java 更快地处理单个正则表达式，从 Java 启动 Perl 都会产生开销，以及 Java 中的线程开销来正确管理分叉进程。

最有可能的是，通过直接在 Java 中处理正则表达式可以获得更好的性能，除非您有非常大的数据要查询，这些数据可能有助于降低调用单独进程的启动成本。

推荐步骤：

*   首先在 Java 中实现您的解决方案。
*   如果 Java 解决方案对您的需求来说太慢，并且正则表达式部分是瓶颈，那么请探索其他选项。
*   要执行 Perl，Runtime.exec 或 Process 可以正常工作，只要确保运行必要的线程来耗尽 STDOUT 和 STDERR。

# websocket - 使用 netty 加速向 websocket 客户端发送响应

> ID：12059686
> 
> 赞同：1
> 
> 时间：2012-08-21T17:02:15.027
> 
> 标签：websocket, netty

我们有一个使用 websocket 和 netty 的网络应用程序。我们正在尝试推送大量数据流，并注意到一旦我们每秒达到大约 300-400 个响应，通道就会开始被标记为 NOT_WRITABLE，并且我们无法发送一些响应。

似乎 netty 正在等待套接字上的 ack。有什么方法可以禁用它，或者有什么方法可以加速它以便能够处理更多？chrome 中的 javascript 实现非常简单，我们似乎无法从这方面提高性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T05:22:03.630

似乎您的写入速度更快，然后数据可以“发送”给客户端。您可以尝试增加写入水印。见[1]。

您可能还想尝试一些 TCP 选项，例如“tcpNoDelay”和“sendBufferSize”。见[2]

[1] [http://static.netty.io/3.5/api/org/jboss/netty/channel/socket/nio/NioChannelConfig.html#setWriteBufferHighWaterMark(int](http://static.netty.io/3.5/api/org/jboss/netty/channel/socket/nio/NioChannelConfig.html#setWriteBufferHighWaterMark(int) ) [2] [http://static.netty.io/ 3.5/api/org/jboss/netty/channel/socket/SocketChannelConfig.html](http://static.netty.io/3.5/api/org/jboss/netty/channel/socket/SocketChannelConfig.html)

# google-app-engine - 如何解决 Google App Engine 不支持写入文件的问题？

> ID：12059694
> 
> 赞同：0
> 
> 时间：2012-08-21T17:02:53.453
> 
> 标签：google-app-engine

我有一个 GAE/Python 应用程序，它是一个管理程序，它允许世界各地的人们将大型 GAE 应用程序的模板文件翻译成他们的本地语言（我们不能使用自动翻译，因为涉及到许多成语等）。模板文件已被标记化，各种语言的文本片段存储在 GAE 数据存储中（涉及数千个模板文件）。

因此，我需要能够将文件写入文件夹。

我有以下代码：

```
with open("my_new_file.html", "wb") as fh:
    fh.write(output) 
```

我读过 GAE 会阻止文件的写入。如果这是真的，有什么办法可以绕过它吗？

如果我不能直接编写文件，是否有人对我如何完成同样的事情有建议（例如，使用网络服务执行某种往返下载然后上传文件）？

我是 GAE/Python 的新手，所以请具体说明。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:50:04.917

您可以在数据存储区中使用 google app engine blobstore 或 BlobProperty 来存储 blob/文件

用于使用 blobstore（最多 2GB） [https://developers.google.com/appengine/docs/python/blobstore/](https://developers.google.com/appengine/docs/python/blobstore/)

用于使用数据存储 blob（最多 1MB） [https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#Blob](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#Blob)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T20:22:02.943

文件系统在许多云系统中是只读的，GAE 也是。在虚拟世界中，操作系统和机器都是虚拟的，文件系统是存储任何东西的最不可靠的地方

我建议使用 BLOB、Google Cloud Storage、Google Drive 中的任何一个，甚至进一步设置并存储在任何外部提供商中，如 Amazon S3 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T16:50:52.127

使用文件 API： [https ://developers.google.com/appengine/docs/python/googlestorage/overview](https://developers.google.com/appengine/docs/python/googlestorage/overview)

添加一些额外的代码，您可以像使用普通的 Python 文件 API 一样使用它：

```
with files.open(writable_file_name, 'a') as f:
  f.write('Hello World!') 
```

虽然此特定链接描述了与 Google Cloud Storage (GCS) 相关的内容，但您可以轻松替换 GCS 特定的部分并将 blobstore 用作存储后端。

代码可以在这里找到： [http ://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/api/files/](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/api/files/)

# c - 将 ascii 代码（整数）转换为字符

> ID：12059695
> 
> 赞同：0
> 
> 时间：2012-08-21T17:02:55.310
> 
> 标签：c

我正在尝试将整数列表转换为字符（整数由空格、换行符和制表符分隔）。输入以 EOF 结束。例如，输入；72 101 108 108 111 44​​ 32 119 111 114 108 100 33 输出 你好，世界！

```
#include <stdio.h>
#include <ctype.h>
#define MAXBUFFERSIZE   100

void cleartoendofline( void );  /* ANSI function prototype */

void cleartoendofline( void )
{
    char ch;
        ch != '\n';
    //ch = getchar();
    //while( ch != '\n' )
        //ch = getchar();
}

main()
{
    char    ch;                     /* handles user input */
    char    buffer[MAXBUFFERSIZE];  /* sufficient to handle one line */
    int     char_count;             /* number of characters read for this line */
    int     exit_flag = 0;
    int     valid_choice;

    while( exit_flag  == 0 ) {
        printf("Enter integer(s)\n: ");
        //ch = getchar();
                scanf("%d",&ch)
        char_count = 0;
        while( (ch != '\n')  &&  (char_count < MAXBUFFERSIZE)) {
            buffer[char_count++] = ch;
            ch = getchar();
        }
        buffer[char_count] = 0x00;      /* null terminate buffer */
        printf("\nIntegers translates to:\n");
        printf("%s\n", buffer);

        valid_choice = 0;
        while( valid_choice == 0 ) {
            printf("Continue (Y/N)?\n");
            scanf(" %c", &ch );
            ch = toupper( ch );
            if((ch == 'Y') || (ch == 'N') )
                valid_choice = 1;
            else
                printf("\007Error: Invalid choice\n");
            cleartoendofline();
        }
        if( ch == 'N' ) exit_flag = 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:01:56.533

了解 和 之间的区别`scanf`，`getchar()`尤其是当它们呈现相同的输入时。

非常非常仔细地阅读文档`scanf`——其中有很多内容。

通过编写自己的专门例程而不是调用`scanf()`. 复制 C 标准中的功能通常是不好的做法，但如果目标是帮助您学习，那也没关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:21:36.843

固定例如

```
#include <stdio.h>
#include <ctype.h>
#define MAXBUFFERSIZE   100

void cleartoendofline( void );  /* ANSI function prototype */

void cleartoendofline( void ){
    while('\n'!=getchar());
}

main(){
    char    ch;                     /* handles user input delimiter*/
    int     num;                    /* user input number */
    char    buffer[MAXBUFFERSIZE];  /* sufficient to handle one line */
    int     char_count;             /* number of characters read for this line */
    int     exit_flag = 0;
    int     valid_choice;

    while( exit_flag  == 0 ) {
        printf("Enter integer(s)\n: ");
        scanf(" %d%c", &num, &ch);//read integer and delimiter
        char_count = 0;
        while( char_count < MAXBUFFERSIZE - 1) {//-1 for End of string
            buffer[char_count++] = (char)num;
            if(ch == '\n')break;
            scanf("%d%c", &num, &ch);
        }
        buffer[char_count] = 0x00;      /* null terminate buffer */
        printf("\nIntegers translates to:\n");
        printf("%s\n", buffer);

        valid_choice = 0;
        while( valid_choice == 0 ) {
            printf("Continue (Y/N)?\n");
            scanf(" %c", &ch );
            ch = toupper( ch );
            if((ch == 'Y') || (ch == 'N') )
                valid_choice = 1;
            else
                printf("\aError: Invalid choice\n");
            cleartoendofline();
        }
        if( ch == 'N' ) exit_flag = 1;
    }
} 
```

# ios - xcode 4.4.1+：发送的消息执行释放实例 - 未发生在 4.3.3

> ID：12059696
> 
> 赞同：-1
> 
> 时间：2012-08-21T17:02:59.863
> 
> 标签：ios, xcode

我有一个不使用 ARC 的旧应用程序。在尝试解决一个相当简单的更改时，我遇到了一个烦人的问题：

运行时：

```
NSMutableArray *arr=[[NSMutableArray alloc] initWithCapacity:0];
NSLog(@"arr=%08lx", (unsigned long)arr);
[arr release]; 
```

我在控制台中得到这个：

```
arr=06a2ca50
*** -[__NSArrayM class]: message sent to deallocated instance 0x6a2ca50 
```

单步执行发布声明后立即出现错误。

我不记得在升级到 4.4.1 之前看到过这个，xcode 4.4.1 中有什么新东西可以解释上述内容吗？

或者我只是在上面的代码中监督一些非常明显的东西？

**更新：**降级到 4.3.3 后问题消失了。目前正在寻找可能导致这种情况的原因。我无法使用新的/干净的项目进行复制。xcode 45-DP4 / iOS6 也有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T12:28:16.780

项目文件在调试方案的环境变量中有 NSZombieEnabled=YES。

我不确定为什么在 NSZombieEnabled=YES 的 4.4.1+ 下会出现此警告，因为没有标准分析和诊断工具报告内存问题。

如果有人对为什么会在 4.1.1+ 上出现此警告有更深入的了解，我很想学习。一般来说，我热衷于认真对待编译器或调试警告，并且不认为禁用它们是最佳选择..

# ios - UIButton 和选中的高亮状态

> ID：12059701
> 
> 赞同：1
> 
> 时间：2012-08-21T17:03:21.377
> 
> 标签：ios, ios5, uibutton

UIButton 具有正常/默认、突出显示和选定的图像。然后我有一个`IBAction`被调用的方法`Touch Down`。该方法更改突出显示的图像，具体取决于它是否被选中。但是当按钮被选中时，该方法被调用，因此高亮图像被改变，但是显示的是带有色调的正常/默认图像。我已经测试了使用的图像不在`nil`. 当处于选中状态的 UIButton 被按下时，会发生什么情况会显示带有颜色的正常状态。为什么不使用突出显示图像，是否有另一种显示选定突出显示图像的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:13:05.407

为什么要在 IBAction 方法中设置高亮状态？您只需要在创建按钮时为其设置突出显示的图像。它会自动切换。当没有分配突出显示的图像时，选择时添加色调是“选择”的默认行为。

如果您使用 Interface Builder，只需在此处分配突出显示的图像。

我假设您正在寻找将 IBAction 方法设置为`touchUpInside`事件的正常按钮选择行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:16:55.320

我通过使用选定的状态和通知（而不是通过 UI）解决了这个问题。当调用通知时，我将图像更改为默认状态，更改选定状态，然后更改选定状态的图像。

**更新**：我从另一个与我类似的问题中想出了一个更好的主意。做到这一点的方法是`setSelected`

```
- (void)setSelected:(BOOL)selected
{
    if ( selected )
    {
        [self setImage:[CFCHStyleSheet imageForTickButtonChecked] forState:UIControlStateNormal];
        [self setImage:[CFCHStyleSheet imageForTickButtonChecked] forState:UIControlStateSelected];
        [self setImage:[CFCHStyleSheet imageForTickButtonCheckedDisabled] forState:UIControlStateDisabled];
    }
    else
    {
        [self setImage:[CFCHStyleSheet imageForTickButtonUnchecked] forState:UIControlStateNormal];
        [self setImage:[CFCHStyleSheet imageForTickButtonUnchecked] forState:UIControlStateSelected];
        [self setImage:[CFCHStyleSheet imageForTickButtonUncheckedDisabled] forState:UIControlStateDisabled];
    }

    [super setSelected:selected];
} 
```

# ruby-on-rails - Net HTTP Persistent / Keep Alive with Ruby OAuth2 gem

> ID：12059704
> 
> 赞同：2
> 
> 时间：2012-08-21T17:03:29.150
> 
> 标签：ruby-on-rails, ruby, oauth-2.0, keep-alive

我试图弄清楚如何使用[OAuth2 gem](https://github.com/intridea/oauth2)启用 HTTP 保持活动。Oauth2 建立在 Faraday 之上，它似乎确实有[使用 net-http-persistent 的实验性支持](https://github.com/technoweenie/faraday/blob/master/lib/faraday/adapter/net_http_persistent.rb)。我能找到在法拉第启用它的唯一方法是使用：

```
Faraday.default_adapter = :net_http_persistent 
```

我有几个问题：

1.  是否在法拉第启用它又为 Oauth2 启用它？
2.  有没有办法测试 HTTP keep alive 是否真的在工作和启用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:46:30.147

我对 ruby​​ 不熟悉，但我相信您可以通过在 Windows 机器上运行[TCPview](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)并监视连接状态来测试一般的 http keep-alive 设置。（非常有用的程序）

还有一篇关于 serverfault 的帖子讨论了从服务器端对其进行监控：[https ://serverfault.com/questions/305388/how-to-test-keep-alive-is-working-on-client-end](https://serverfault.com/questions/305388/how-to-test-keep-alive-is-working-on-client-end)

如果您对测试它真的很偏执，您应该能够通过使用[wireshark](http://www.wireshark.org/)查看连接流来看到 http 标头中的保持活动位，但这可能有点过分。

附言。我看到你的团队赢得了 HACK-VT 的比赛，并决定看看你，因为你的 Ruby 演示文稿很棒。很高兴我真的可以回答一些问题！

# xslt - 与 OpenXML 的模板匹配

> ID：12059708
> 
> 赞同：0
> 
> 时间：2012-08-21T17:03:39.973
> 
> 标签：xslt, xpath, openxml

在我看来，这是非常简单的东西，但我无法弄清楚如何使用 XPath 选择以下格式的节点：

```
<w:p>
            <w:pPr />
            <w:customXml w:uri="DxDitaOXmlPub" w:element="msgnum">
              <w:r>
                <w:rPr>
                  <w:rStyle w:val="Dxmsgnum" />
                </w:rPr>
                <w:t>Consult your compliance officer.</w:t>
              </w:r>
            </w:customXml>
          </w:p> 
```

我尝试了以下样式表的多种变体：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" 
xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture" 
xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" 
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
xmlns:o="urn:schemas-microsoft-com:office:office" 
xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" 
xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" 
xmlns:v="urn:schemas-microsoft-com:vml" 
xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" 
xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" 
xmlns:w10="urn:schemas-microsoft-com:office:word" 
xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" 
xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" 
xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" 
xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" 
xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" 
xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape">

<!-- Identity Transform -->

<xsl:template match="/ | @* | node()" name="identity">
    <xsl:copy>
        <xsl:apply-templates select="@* | node() "/>
    </xsl:copy>
</xsl:template>

<xsl:template match="w:p[descendant::w:rPr/w:rStyle/@w:val='msgnum']">

    <w:p>
        <w:pPr>
            <w:pStyle w:val="ActionRequired" />
        </w:pPr>
        <w:customXml w:uri="DxDitaOXmlPub" w:element="Dxmsgnum">
            <w:r>
                <w:rPr>
                    <w:rStyle w:val="Dxmsgnum" />
                </w:rPr>
                <w:t>
                    <xsl:value-of select="descendant::w:t"/>
                </w:t>
            </w:r>
        </w:customXml>
    </w:p>

</xsl:template>

</xsl:stylesheet> 
```

想要的结果真的没什么花哨的，只是修改`w:pPr`元素以包含一个非空的 child `w:pStyle`：

```
 <w:p>
            <w:pPr>
                <w:pStyle w:val="ActionRequired" />
            </w:pPr>
            <w:customXml w:uri="DxDitaOXmlPub" w:element="Dxmsgnum">
                <w:r>
                    <w:rPr>
                        <w:rStyle w:val="Dxmsgnum" />
                    </w:rPr>
                    <w:t>
                        Consult your compliance officer.
                    </w:t>
                </w:r>
            </w:customXml>
        </w:p> 
```

我看不出样式表没有按原样执行我想要的任何原因，但我对 OpenXML 格式并不熟悉，所以也许有一些我不知道的时髦的东西？

编辑：我也尝试过`@w:element`如下匹配：

```
<xsl:template match="w:p[child::w:customXml/@w:element='msgnum']">

        <w:p>
            <w:pPr>
                <w:pStyle w:val="ActionRequired" />
            </w:pPr>
            <w:customXml w:uri="DxDitaOXmlPub" w:element="msgnum">
                <w:r>
                    <w:rPr>
                        <w:rStyle w:val="Dxmsgnum" />
                    </w:rPr>
                    <w:t>
                        <xsl:value-of select="descendant::w:t"/>OOGA BOOGA!
                    </w:t>
                </w:r>
            </w:customXml>
        </w:p>

</xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:56:54.070

试试这样的东西吗？正常复制节点，除了将所需的子元素插入到作为 aw:p 元素的子元素的空 w:pPr 元素中。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" >

    <!-- Identity Transform -->

    <xsl:template match="/ | @* | node()" name="identity">
        <xsl:copy>
            <xsl:apply-templates select="@* | node() "/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="w:pPr[parent::w:p//@* = 'msgnum']">
        <xsl:copy>
            <w:pStyle w:val="ActionRequired" />
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

编辑：你能澄清什么是可接受的支票吗？任何包含属性等于“msgnum”的元素？我修复了模板匹配以反映这种情况。

# facebook - Facebook 登录 - 自动刷新页面

> ID：12059709
> 
> 赞同：1
> 
> 时间：2012-08-21T17:03:48.743
> 
> 标签：facebook, login, facebook-like, refresh

我有个问题。当某人未登录 facebook 并使用 facebook 插件“点赞”时，他会被要求登录 facebook。他这样做了，他必须再次点击“喜欢”。

我想在这种情况下，就在那个人登录后自动刷新我的页面（用于更新其他信息）。有没有办法做到这一点 ？我应该使用一种 FB loggin 的侦听器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:35:00.933

在这种情况下，我认为不会 - 如果登录是由您自己的应用程序使用 Javascript SDK 处理的，您可以检测到登录（这是登录流程的必要部分）并在您的登录处理代码中添加一些内容以刷新 Like按钮，以便他们在刷新时知道用户已登录。

在用户通过like按钮本身触发登录的情况下，我认为没有任何方法可以检测到此事件

# java - 将应用程序 TransactionManager 注入 JPA EntityListener

> ID：12059712
> 
> 赞同：1
> 
> 时间：2012-08-21T17:03:58.583
> 
> 标签：java, spring, security, jpa, acl

我想使用 JPA EntityListener 来支持 spring 安全 ACL。在`@PostPersist`事件中，我创建了一个与持久化实体相对应的权限。

我需要这个操作来参与当前的交易。为此，我需要`TransactionManager`在`EntityListener`.

问题是，Spring 无法管理它，`EntityListener`因为它是在`EntityManagerFactory`实例化时自动创建的。在经典的 Spring 应用程序中，`EntityManagerFactory`它本身是在`TransactioManager`实例化期间创建的。

```
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean> 
```

所以我没有办法`TransactionManager`用构造函数注入，因为它还没有被实例化。

使`EntityManager`a`@Component`创建 的另一个实例`EntityManager`。实现 InitiliazingBean 并使用`afterPropertySet()`不起作用，因为它不是 Spring 托管 bean。

任何想法都会有所帮助，因为我陷入困境并且没有想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T15:36:09.437

除了 nodje 的指令之外，您还应该添加一件事 - 添加 AnnotationBeanConfigurerAspect 作为实体管理器的依赖项，否则将在初始化 spring 上下文之前创建实体侦听器：

```
<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
    depends-on="org.springframework.context.config.internalBeanConfigurerAspect"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T16:04:13.293

一种解决方案是在 EntityListener 上使用 Spring 的 @Configurable 注解。

理论上，它应该允许一个非 Spring 托管实例，在我的例子中为 EntityListener，进行方面编织，从而允许该实例获得 DI。

所以这里是不同的步骤：

*   将 @Configurable 添加到 EntityListener 并在要注入的字段上添加 @Autowired（此处为 TransactionManager）
*   添加`<context:spring-configured/>`到 Spring 上下文
*   使用 aspect-maven-plugin 进行编译时编织（参见下面的配置）

到目前为止一切顺利，但它对我不起作用。日志说 EntityListerner 是编织的：

```
[INFO] Extending interface set for type 'org.project.commons.security.DefaultEntityListener' (DefaultEntityListener.java) to include 'org.springframework.beans.factory.aspectj.ConfigurableObject' (AnnotationBeanConfigurerAspect.aj)
[INFO] Join point 'initialization(void org.springframework.beans.factory.aspectj.ConfigurableObject.<init>())' in Type 'org.project.commons.security.DefaultEntityListener' (DefaultEntityListener.java:38) advised by before advice from 'org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect' (spring-aspects-3.1.2.RELEASE.jar!AbstractDependencyInjectionAspect.class:78(from AbstractDependencyInjectionAspect.aj)) [with runtime test]
[INFO] Join point 'initialization(void org.springframework.beans.factory.aspectj.ConfigurableObject.<init>())' in Type 'org.project.commons.security.DefaultEntityListener' (DefaultEntityListener.java:38) advised by afterReturning advice from 'org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect' (spring-aspects-3.1.2.RELEASE.jar!AbstractDependencyInjectionAspect.class:87(from AbstractDependencyInjectionAspect.aj)) [with runtime test]
[INFO] Join point 'initialization(void org.project.commons.security.DefaultEntityListener.<init>())' in Type 'org.project.commons.security.DefaultEntityListener' (DefaultEntityListener.java:38) advised by afterReturning advice from 'org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect' (spring-aspects-3.1.2.RELEASE.jar!AbstractDependencyInjectionAspect.class:87(from AbstractDependencyInjectionAspect.aj)) [with runtime test] 
```

但我从来没有得到预期的注射。

有谁知道的，欢迎指教。。。

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>aspectj-maven-plugin</artifactId>
            <version>1.4</version>
            <configuration>
                <showWeaveInfo>true</showWeaveInfo>
                <proceedOnError>true</proceedOnError>
                <outxml>true</outxml>
                <source>1.6</source>
                <target>1.6</target>
                <complianceLevel>1.6</complianceLevel>
                <encoding>${encoding}</encoding>
                <aspectLibraries>
                    <aspectLibrary>
                        <groupId>org.springframework</groupId>
                        <artifactId>spring-aspects</artifactId>
                    </aspectLibrary>
                </aspectLibraries>
                <weaveDependencies>
                    <weaveDependency>
                        <groupId>org.project</groupId>
                        <artifactId>commons</artifactId>
                    </weaveDependency>
                </weaveDependencies>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>compile</goal>
                        <!--<goal>test-compile</goal>-->
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

# r - R中没有FPC的调查加权回归

> ID：12059720
> 
> 赞同：4
> 
> 时间：2012-08-21T17:04:22.270
> 
> 标签：r, regression, survey, sampling

我正在使用 R 中的 svydesign 包来运行调查加权 logit 回归，如下所示：

```
sdobj <- svydesign(id = ~0, weights = ~chweight, strata = ~strata, data = svdat)

model1 <- svyglm(formula=formula1,design=sdobj,family = quasibinomial) 
```

但是，文档说明了关于回归的警告，但没有指定有限总体校正 (FPC)：

```
 If fpc is not specified then sampling is assumed to be
with replacement at the top level and only the first stage of
 cluster is used in computing variances. 
```

不幸的是，我没有足够的信息来指定每个级别的人口（我抽样的很少）。任何有关如何在没有 FPC 信息的情况下指定调查权重的信息都会非常有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T06:28:32.553

你做对了。在这种情况下，“替换”是您想要的调查统计术语。

如果采样分数很低，则标准使用一个近似值，如果采样分数是无穷小或采样是有替换的，则该近似值将是精确的。没有人真正用替换进行调查，但近似值几乎是普遍的。有了这个近似值，你就不需要提供 fpc，相反，如果你不提供 fpc，svydesign() 会假设你想要这个近似值。

# asp.net - 如何从公共函数中引用中继器（或其他对象）？

> ID：12059724
> 
> 赞同：0
> 
> 时间：2012-08-21T17:04:52.133
> 
> 标签：asp.net, vb.net, function, repeater, global

我有一个 ASP.NET 4.0 (VB) 应用程序，其中有一堆中继器分布在多个页面和用户控件中。我正在尝试创建一个公共函数，我可以调用它来对我指定的任何转发器进行数据绑定和分页，但是在从该公共函数中引用转发器对象时遇到困难，以便该函数知道哪个转发器在哪个页面上正在调用它。有没有办法做到这一点，或者我的基础方法有缺陷？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:30:16.027

将您需要操作 ByRef 的任何控件作为参数传递到您的函数中（例如 = Page、Repeater 等）。如果您为每个转发器/页面执行不同的逻辑，那么制作一个包罗万象的函数来处理它似乎很愚蠢。如果大多数中继器在您的函数中遵循相同的代码路径，或者必须在所有这些中继器上调用函数中的某些内容，那么遵循此模型是有意义的。

# sql - 从同一表中的 1 行更新多行中的几列

> ID：12059726
> 
> 赞同：0
> 
> 时间：2012-08-21T17:05:02.257
> 
> 标签：sql, ibm-midrange

我们有一个包含多个字段的表，例如 300+。结构是这样的：storenum, Monval1, Monval2... Monval45, Monval46... Tuesval1, Tuesval2 等等。基本上对于值 1 到 53，一周中的每一天都有一个版本，因此 53 个字段 * 7 天加上一些其他随机字段。

我需要使用来自商店 1 的数据更新商店 3 到 285。我尝试了什么：

```
Update (Select MonVal1... SunVal53 from table1 
 where storenum in (3, 4,...284,285)) as Dest
From (Select MonVal1... SunVal53 from table1 
 where storenum =1) as Source 
```

但它是一个nogo。

我想做的事情甚至可以完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:17:33.523

您可以编写此模式的超长更新语句：

```
UPDATE badly_normalized_table
SET monval1 =   ( SELECT monval1 FROM badly_normalized_table WHERE ... )
WHERE pk = the_pk_you_want_to_upate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:27:29.470

```
Update table1 set
    MonVal1    = origin.MonVal1, 
    /* the orher fields here */
    SunVal53   = origin.SunVal53
from table1
inner join table1 as origin on origin.storenum = 1
where table1.storenum in (3, 4,...284,285) 
```

# .net - WinAPICodePack 中的 TaskDialog 在 .NET 4.0 上不起作用

> ID：12059736
> 
> 赞同：6
> 
> 时间：2012-08-21T17:06:16.267
> 
> 标签：.net, winapi, marshalling, windows-api-code-pack, overflowexception

我正在编写一个应用程序并想使用该`TaskDialogIndirect`函数 - 但是我不想编写大量的 P/Invoke 内容等，所以我包含了 WinAPICodePack。不过有一个问题！当我创建一个控件`TaskDialog`并将其添加到对话框时，一切正常。但是，运行这些`Show`方法会导致`OverflowException`在 mscorlib 中。我将此归结为一些指针处理和编组。

试验代码的结果是，我发现**必须**为 .NET 3.5 和包含应用程序**TOO**编译 DLL 。让我的应用程序在 .NET 4.0 上调用此错误...关于解决方法的任何想法 - 或者您甚至可以重现此错误吗？

另一个问题是我可以将`Icon`属性设置为我想要的任何东西，但根本不显示图标。我必须设置一个`Opened`动态设置图标的事件......

信息：在 Windows 8 Pro x64 RTM 上运行 Visual Studio 2012 RTM。应用程序是一个标准的 WPF 应用程序。

示例代码：

```
TaskDialog td = new TaskDialog();
td.Cancelable = true;
td.Caption = "Caption";
td.InstructionText = "Instructions";
td.Text = "Text";

TaskDialogCommandLink buttonElevation =
    new TaskDialogCommandLink("elevation", "Elevation Required Sample");
buttonElevation.UseElevationIcon = true;

td.Controls.Add(buttonElevation);
td.Show(); // OverflowException occurs here! 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T19:35:15.263

我修复了这个基本上是 32 位/64 位错误的问题。在`NativeTaskDialog.cs`文件中有一行很关键，它在函数中

```
IntPtr AllocateAndMarshalButtons(
    TaskDialogNativeMethods.TaskDialogButton[] structs) 
```

您需要找到以下行

```
 currentPtr = (IntPtr)((int)currentPtr + Marshal.SizeOf(button)); 
```

并将其替换为

```
 currentPtr = (IntPtr)(currentPtr.ToInt64() + Marshal.SizeOf(button)); 
```

# c# - 计算同时访问数据库的客户端数

> ID：12059738
> 
> 赞同：1
> 
> 时间：2012-08-21T17:06:23.933
> 
> 标签：c#, sql-server

我正在制作一个在线考试系统，它是一个窗口应用程序。我正在使用 SQL 服务器和 C#。有多个客户端和一台服务器。如何通过在同一台PC上安装客户端和服务器来计算可以同时访问服务器的客户端数量？这样做需要什么参数？
提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:50:06.967

`select count(*) from sys.dm_exec_sessions`是你的朋友！

如果您想知道用户列表以及他们上次执行的 SQL 语句，您可以使用如下语句：

```
    SELECT nt_domain + '\' + nt_user_name AS 用户、主机名、程序名、t.text
    FROM sys.dm_exec_sessions
    INNER JOIN sys.dm_exec_requests r ON s.session_id = r.session_id
    交叉应用 sys.dm_exec_sql_text(r.sql_handle) t
    ORDER BY nt_domain + '\' + nt_user_name AS 用户、主机名、程序名

```

# ruby-on-rails - 设计：我的客户数据不再可用

> ID：12059740
> 
> 赞同：0
> 
> 时间：2012-08-21T17:06:39.990
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我犯了一个大错误，我不知道如何解决它。

我最初以正确的方式安装了 Devise，但今天我决定使用以下终端行创建第二个用户实例：

```
rails g controller Users index 
```

现在我意识到这不是正确的做法，我决定使用以下命令销毁生成的代码：

```
rails destroy controller Users 
```

现在没有任何效果，访问注册视图时出现以下错误：

```
Routing Error
uninitialized constant CustomersController
Try running rake routes for more information on available routes. 
```

这是我的路线文件

```
 devise_for :users
  root :to => 'events#index' 
```

这种情况下我该怎么办？？？

# jquery - jQuery计算一些浏览器反转计算的复选框有多少？

> ID：12059743
> 
> 赞同：0
> 
> 时间：2012-08-21T17:06:44.003
> 
> 标签：jquery, math, browser, input

我写了一个简单的脚本来计算有多少勾选框被勾选并显示/隐藏它们的内容。它在某些浏览器中运行良好，但即使使用 FF 测试 2 个 mac 也都返回不同。IE。如果没有盒子，它会返回落后，更多的是应该改变显示的 div。

奇怪的是，一些浏览器正在逆转这一点，例如，如果所有的方框都打勾，它会显示落后而不是创新。

有任何想法吗？

```
<script type="text/javascript">
$(document).ready(function() {
$('input[type=checkbox]').change(function() {
//alert($('input:checked').size())
//if laggard
if ($('input:checked').size() < 1) {
$("div#four").show();
$("div#one").hide();
$("div#two").hide();
$("div#three").hide();
$("div#EM").hide();
}
//late majority
else if ($('input:checked').size() < 2) {
$("div#three").show();
$("div#one").hide();
$("div#two").hide();
$("div#four").hide();
$("div#EM").hide();
}
// early majority
else if ($('input:checked').size() < 4) {
$("div#two").hide();
$("div#one").hide();
$("div#three").hide();
$("div#four").hide();
$("div#EM").show();
}
// early adopter
else if ($('input:checked').size() < 6) {
$("div#two").show();
$("div#one").hide();
$("div#three").hide();
$("div#four").hide();
$("div#EM").hide();
}
else if ($('input:checked').size() < 7) {
$("div#one").show();
$("div#two").hide();
$("div#three").hide();
$("div#four").hide();
$("div#EM").hide();
}
   else {
  // do something here
$("div#four").show();
 $("div#one").hide();
 $("div#two").hide();
 $("div#three").hide();
 $("div#EM").hide();

}
});   
   $('#showMore').click(function() {
  $('#answer').show('slow', function() {
  });
});

    });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T18:30:27.770

`Laggard`单击所有复选框时会显示的唯一原因是您有 7 个或更多复选框。我在这里创建了一个 jsfiddle。

[http://jsfiddle.net/wirey00/a3Tx8/](http://jsfiddle.net/wirey00/a3Tx8/)

此外，这是编写代码的更短的方法

```
$('input[type=checkbox]').change(function() {
    var len = $('input:checked').length;  
    $('#four').toggle(len<1 || len > 6);
    $('#three').toggle(len==1);
    $('#two').toggle(len==4 || len==5);
    $('#one').toggle(len==6);
    $('#EM').toggle(len==2 || len==3);
});​ 
```

Using [.toggle()](http://api.jquery.com/toggle/) allows for you to pass in a `condition(true/false)` which determines if it is `shown(true)` or `hidden(false)`

# matlab - Matlab中的运行长度编码

> ID：12059744
> 
> 赞同：4
> 
> 时间：2012-08-21T17:06:47.040
> 
> 标签：matlab, run-length-encoding

我对 MatLab 很陌生，我有运行长度编码代码，但它似乎不起作用，你能帮我吗？

我有这个输入：

```
ChainCode  = 11012321170701000700000700766666666666665555555544443344444333221322222322 
```

我想把它变成 RLE 输出：

```
(1,2), (0,1), (1,1), (2,1), (3,1), (2,1), (1,2), (7,1), (0,1), (7,1), (0,1), 
(1,1), (0,3), (7,1), (0,5), (7,1), (0,2), (7,1), (6,13), (5,8), (4,4), (3,2), 
(4,5), (3,3), (2,2), (1,1), (3,1), (2,5), (3,1), (2,2) 
```

这是我的代码：

```
lengthcode = 1;
N = 1;

for i = 2:length(ChainCode)

    if x(i)==x(i-1)
        N = N + 1; 
        valuecode(N)  = x(i);
        lengthcode(N) = lengthcode(N) + 1;
    else 
        N = 1;
        lengthcode = 1;
    end

    i = i + 1;

end 
```

但这不起作用，我仍然对如何打印这样的输出感到困惑。

我希望你能帮助我。谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-08-28T14:32:21.913

这是一个没有循环、cellfun 或 arrayfun 的紧凑型解决方案：

```
chainCode = '11012321170701000700000700766666666666665555555544443344444333221322222322';
numCode = chainCode - '0'; % turn to numerical array

J=find(diff([numCode(1)-1, numCode]));
relMat=[numCode(J); diff([J, numel(numCode)+1])]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T18:08:39.030

通过坚持您的原始实现，以下简单的更改应该可以工作。

```
chainCode = '11012321170701000700000700766666666666665555555544443344444333221322222322';
numCode = chainCode - '0'; % turn to numerical array
relMat = [];
numCode = [numCode nan]; % dummy ending

N = 1;
for i = 1:length(numCode)-1   
    if numCode(i)==numCode(i+1)
        N = N + 1;
    else
        valuecode = numCode(i);
        lengthcode =  N;
        relMat = [relMat; valuecode lengthcode];
        N = 1;
    end
end 
```

您可以随意格式化输出。例如作为一个序列：

```
relMatT = relMat';
relSeq = relMatT(:)'; 
```

或将字符串格式化为建议的输出：

```
relString = [];
for i = 1:length(relMat)
    relString = [relString, sprintf('(%d, %d), ', relMat(i,1), relMat(i,2))];
end 
```

作为扩展，如果您的源序列中有字母数字，您应该修改上面的内容以便比较字符串而不是数字。

**更新**：要计算原始代码对中唯一代码对的出现次数，请`relMat`尝试查找这些对并按行计算零差异。例如：

```
relMatUnique = unique(relMat, 'rows'); % find unique pairs 
nPairs = length(relMatUnique);
nOccur = zeros(nPairs, 1);
for i = 1:nPairs
    pairInMat = bsxfun(@minus, relMat, relMatUnique(i,:)); % find pair in relMat
    nOccur(i) = sum(~sum(pairInMat, 2));
end
relMatOccur = [relMatUnique nOccur]; % unique pairs and number of occurrences 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T00:29:02.157

您可以避免 for 循环：

```
chainCode = '11012321170701000700000700766666666666665555555544443344444333221322222322';
numCode = chainCode - '0'; % turn to numerical array

% detect edges (changes)
edges = arrayfun( @(x,y) x ~= y,    ...
                  numCode(1:end-1), ...
                  numCode(2:end));
% get indexes
idx = find(edges);

% create tuples
relMat = cell2mat(arrayfun(         ...
  @(b,e) [ numCode(b) ; e-b+1 ],    ...
  [ 1 (idx + 1) ],                  ...
  [ idx length(numCode) ],          ...
  'UniformOutput', false)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T20:49:36.610

```
% Convert string to numeric array
ChainCodeString  = '11012321170701000700000700766666666666665555555544443344444333221322222322';
ChainCodeArray = ChainCodeString - '0';

% Initialize
CurrentRleValue = ChainCodeArray(1);
CurrentRleCount = 1;
RleCodeIndex = 1;

for i = 2 : length(ChainCodeArray)
    if ChainCodeArray(i)==ChainCodeArray(i-1)
        % Increment current run-length count
        CurrentRleCount = CurrentRleCount + 1;
    else
        % Store current run-length
        valuecode(RleCodeIndex) = CurrentRleValue;
        lengthcode(RleCodeIndex) = CurrentRleCount;
        RleCodeIndex = RleCodeIndex + 1;

        % Initialize next run-length
        CurrentRleValue = ChainCodeArray(i);
        CurrentRleCount = 1;
    end;
end; 
```

# c# - 在不同的线程中运行和控制浏览器控件

> ID：12059752
> 
> 赞同：1
> 
> 时间：2012-08-21T17:07:26.633
> 
> 标签：c#, webbrowser-control

我有我的主要 gui 类和一些子类。有 +- 3 个线程正在从各种互联网资源和 API 网关等收集数据。

现在，在其中一个线程中，我想运行一个 webbrowser 控件，这样我就可以在我的程序中添加一些自动浏览功能。每个子线程都应该能够自行打开网络浏览器。所以我创建了第二个 c# windows 窗体，它只包含 webbrowsing 控件。

我已经在这个新线程上为 webbrowser 控件使用了 ApartmentState.STA 设置。但是，form2 没有响应。

我试图调用 Application.Run(); 从这个线程，这使得 webbrowser/form2 响应。但随后我的主线程停止运行。

所以我有点不确定如何进行。我想要的有可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:14:16.053

这应该工作

```
var th = new Thread(() =>
{
    WebBrowserDocumentCompletedEventHandler completed = null;

    using (WebBrowser wb = new WebBrowser())
    {
        completed = (sndr, e) =>
        {
            //Do Some work

            wb.DocumentCompleted -= completed;
            Application.ExitThread();
        };

        wb.DocumentCompleted += completed;
        wb.Navigate(url);
        Application.Run();
    }
});

th.SetApartmentState(ApartmentState.STA);
th.Start();
th.Join(); 
```

也就是说，我会使用[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient%28v=vs.80%29.aspx)或[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)与[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)一起下载和解析 html 资源

# git - 使用 Git 更新 Codeigniter 项目

> ID：12059756
> 
> 赞同：0
> 
> 时间：2012-08-21T17:08:00.173
> 
> 标签：git, codeigniter

我正在开发一个 Codeigniter 项目，我想保持系统文件夹和应用程序文件夹中的配置更新，但我不熟悉 Git，我不知道我需要做什么。

Codeigniter 项目的结构如下：

```
/application
  - /config
/system
/index.php 
```

我以为我可以简单地替换系统文件夹，但它也依赖于应用程序中配置文件的一些更新。我将所有项目都保存在应用程序文件夹中。

我的配置文件中有一些自定义内容，因此手动操作可能会很耗时。

有人可以像我 5 岁那样向我解释如何开始吗？

该项目的完整路径是`C:\xampp\htdocs\MYSITE\system`

Codeigniter 存储库位于[https://github.com/EllisLab/CodeIgniter](https://github.com/EllisLab/CodeIgniter)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:11:33.030

我发现本教程非常易于遵循和使用。即使他们使用 CodeIgniter，我的存储库也能完美运行。

[http://toroid.org/ams/git-website-howto](http://toroid.org/ams/git-website-howto)

# mysql - 无法计算需要的结果

> ID：12059759
> 
> 赞同：1
> 
> 时间：2012-08-21T17:08:11.510
> 
> 标签：mysql, sql

我使用MySql。我有桌子：

邮件

```
id | user_id | date
1      2       2012/08/21
2      2       2012/08/22 
```

来电

```
id | user_id | date 
 1     2       2012/08/21
 2     2       2012/08/21 
```

我想在某个日期为用户获取电话和邮件的总和。例如：

```
date       | SUM
2012/08/21   3
2012/08/22   1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:10:52.093

```
SELECT date, COUNT(1) SUM
FROM (SELECT user_id, date FROM mails 
      UNION ALL 
      SELECT user_id, date FROM calls) t
GROUP BY date 
```

[**演示**](http://sqlfiddle.com/#!2/33fb2/2)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:15:33.540

假设 id、user_id 和 date 列在两个表中具有相同的数据类型：

```
SELECT date, count(id) as Sum FROM
(
  SELECT id, user_id, date from mails
  UNION ALL
  SELECT id, user_id, date from calls
) total
WHERE user_id = 2
GROUP BY total.date 
```

SQL小提琴[在这里](http://www.sqlfiddle.com/#!3/7132f/11)

# c# - 在给定字符串中查找关键字。最简单，最快，+ 到目前为止我所拥有的

> ID：12059760
> 
> 赞同：1
> 
> 时间：2012-08-21T17:08:12.920
> 
> 标签：c#, winforms, richtextbox

我正在制作一个语法着色工具。我目前正在编写查找和突出显示关键字的方法，例如 if then else .. 我相信有更好（更快，更美观）的方法来做到这一点。

下面是两种方法，第一种我尽量不使用除长度以外的任何字符串方法来尝试提高速度。

第二个我使用了字符串方法，但有人告诉我它们比第一种方法要慢。

哪种方式更快？对于第一个，只有在不正确的单词后面有一个空格时才会突出显示该单词，还有什么补救措施吗？

代码：

```
 private string[] m_keywords = new string[] { "GOTO", "IF", "THEN", "ELSE", "WHILE", "DO" };
    private int m_nShortestKeywordLength = 2;

    // lcpy_strLine is a copy in all uppercase of the current line I am processing

    private void ProcessKeywords(Color clr)
    {
        if(lcpy_strLine.Length > m_nShortestKeywordLength)
            for (int i = 0; i < m_keywords.Length; i++)
            {
                string curWord = m_keywords[i];
                int len = curWord.Length;
                for (int j = 0; j < lcpy_strLine.Length; j++)
                {
                    if (j + len < lcpy_strLine.Length)
                    {
                        int k = 0;
                        while (k < len && lcpy_strLine[j + k] == curWord[k])
                            k++;
                        if (k == len)
                        {
                            Console.WriteLine("Found Keyword");
                            SelectionStart = m_nLineStart + j;
                            SelectionLength = k;
                            SelectionColor = clr;
                        }
                    }
                }
            }
    }

    private void ProcessKeywords2(Color clr)
    {
        /*for (int i = 0; i < m_keywords.Length; i++)
            if (lcpy_strLine.Contains(m_keywords[i]))
            {
                int indx1 = lcpy_strLine.IndexOf(m_keywords[i]);
                SelectionStart = m_nLineStart + indx1;
                SelectionLength = m_keywords[i].Length;
                SelectionColor = clr;
            }*/

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:17:58.513

最简单的方法可能是正则表达式。它也会相当快。

```
private string[] m_keywords = new string[] { "GOTO", "IF", "THEN", "ELSE", "WHILE", "DO" };
private Regex keywordRegex = new Regex(@"\b(" + string.Join("|", m_keywords) + @")\b", RegexOptions.Compiled | RegexOptions.IgnoreCase); 
```

并且不需要大写该行：

```
private void ProcessKeywords(Color clr)
{
    foreach (Match m in keywordRegex.Matches(someLine)) {
        SelectionStart = m.Index;
        SelectionLength = m.Length;
        SelectionColor = clr;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:11:34.723

使用时`string.IndexOf`，需要指定`StringComparison.Ordinal`才能获得良好的性能。默认重载使用文化感知比较（例如，它认为“æ”等于“ae”），这比简单的逐字符比较昂贵得多。

# java - 必须在 GetStringUTFChars 之后调用 ReleaseStringUTFChars（将 char* 传递给 C 函数时）？

> ID：12059768
> 
> 赞同：7
> 
> 时间：2012-08-21T17:07:45.493
> 
> 标签：java, c++, c, java-native-interface

我对从 java 传递给 c 的对象有点困惑？是否应该在本机 jni 方法中删除它们，或者当方法返回时它们将被垃圾收集。例如：

如果我的 java 文件中有本地声明，`public native printString(String msg);`并且本地方法`const char *message = (jni_env)->GetStringUTFChars(msg, &iscopy);`用于获取字符串的 c 样式字符数组。`Shoud I call (jni_env)->ReleaseStringUTFChars(msg, message);`在用本机方法完成所有工作之后。如果是，那么为什么有必要？为什么 java 运行时环境不代表程序员这样做呢？在所有字符串被声明并从java环境传递之后。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T17:22:04.333

Get Characters 函数将字符固定在内存中，直到调用 Release 方法。Java 无法垃圾收集或以其他方式移动此数据，直到确定没有人在使用它。

Java VM 无法知道内存离开 Java 虚拟机后将使用多长时间，因此需要手动通知内存已用完。

# jquery - 选择距窗口顶部一定距离的元素

> ID：12059772
> 
> 赞同：0
> 
> 时间：2012-08-21T17:08:58.787
> 
> 标签：jquery

这很简单，虽然我遇到了麻烦。`.proj`页面上具有相同类 ( )的元素的多行。每个都占用 100% 的宽度。我希望在`div.proj`窗口顶部 200 像素内的那个有一个 class `.focused`，否则，如果它不在顶部附近，就有这个 class `.default`。我遇到的问题是挑出一个元素。

这就是我目前所处的位置，但它会找到所有元素`.proj`，而不仅仅是我正在寻找的元素。这是我到目前为止所拥有的，目前它根本不起作用。

```
$(document).scroll(function(){
    var proj = $('.proj'),
        top = proj.offset().top - $(document).scrollTop();
    if (top < 200 && !proj.is('.default')){
        $(proj).removeClass('focused').addClass('default');
    }
    if (top > 200 && proj.is('.default')){
        $(proj).removeClass('default').addclass('focused');
    }  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:43:52.723

我的示例适用于 200px 范围内的*每个*类元素。`.proj`对于挑选出单个元素，如果您的元素的高度> = 200px，它将起作用。如果不是，您应该告诉我们哪个是“挑出”单个元素的标准（例如最上面的？）在示例中，宽度不是 100%，但我希望这个概念很清楚

```
​$(window).scroll(checkScroll);

function checkScroll()
{
    $(".proj").each(function(i,e) {
            var tp = $(e).offset().top - $(document).scrollTop();
            $(e).toggleClass("focused",tp<200).toggleClass("default",tp>=200);
    });
}​​​​ 
```

检查 JSFiddle：http: [//jsfiddle.net/hnYnS/](http://jsfiddle.net/hnYnS/)

另请检查[http://jsfiddle.net/hnYnS/2/](http://jsfiddle.net/hnYnS/2/)以了解使用 100% 宽度并检查范围在 0 到 200px 之间的不同方法。

```
$(window).scroll(checkScroll);  
function checkScroll()
{
    $(".proj").each(function(i,e) {
            var tp = $(e).offset().top - $(document).scrollTop();
            var isOk = tp<200 && tp>=0;
            $(e).toggleClass("focused",isOk).toggleClass("default",!isOk);
        });
}​ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-21T17:26:00.373

我想你只是想交换你 < 和 >

```
$(document).scroll(function(){
var proj = $('.proj'),
    top = proj.offset().top - $(document).scrollTop();
if (top > 200 && !proj.is('.default')){
    $(proj).removeClass('focused').addClass('default');
}
if (top < 200 && proj.is('.default')){
    $(proj).removeClass('default').addclass('focused');
}  
}); 
```

如果这不能解决问题，您应该为它创建一个 jsfiddle，这样我们就可以确切地看到发生了什么。

# url - iFrame 上的 URL 长度问题

> ID：12059773
> 
> 赞同：0
> 
> 时间：2012-08-21T17:09:04.303
> 
> 标签：url, iframe, get, jboss6.x

大家好，我在调用具有特定 URL 长度的 iframe 时遇到了一些问题：完整的 URL 如下：

```
http://localhost:8080/autorizaciones/pages/administracion/autorizaciones/solicitarAutorizacion.jsf?nkttxms=6175141345567386080&nosjxms =%7B%22formActionURL%22%3A%22crearCotizacion.do%22%2C%22renderSection%22%3A%5B%22%27div_pagina%27%22%2C%22%27mensajes%27%22%5D%2C%22formName%22%3A%22cotizarRecotizarReservarForm%22%2C%22loadMenu%22%3Afalse%2C%22scriptParameters%22%3A%7B%22evalScripts%22%3Atrue%7D%2C%22viewParameters%22%3A%7B%22autorizaciones%22%3A%22%5B%7B%5C%22codigoSistema%5C%22%3A%5C%22SISPE%5C%22%2C%5C%22descripcion%5C%22%3A%5C%22Solicito+autorizacion+descuento+variable+del+5.0%25+para+la%28s%29+clasificacion%28es%29%3A+2226-PAVOS+CONGELADOS+%5C%22%2C%5C%22areaTrabajo%5C%22%3A%5C%22MULTICENTRO%5C%22%2C%5C%22tituloAutorizacion%5C%22%3A%5C%22AUTORIZACION+DESCUENTO+VARIABLE+GERENTE+COMERCIAL+5.0%5C%22%2C%5C%22filtroTipoAutorizacion%5C%22%3A%7B%5C%227%5C%22%3A%5B%7B%5C%22codigoComponente%5C%22%3A23%2C%5C%22valorComponente%5C%22%3A%5C%225.0%5C%22%2C%5C%22soloLectura%5C%22%3Atrue%7D%5D%7D%2C%5C%22filtroUsuariosAutorizadores%5C%22%3A%5B%5C%22FRM1458%5C%22%5D%2C%5C%22dataKeys%5C%22%3A%5B%7B%5C%22label%5C%22%3A%5C%22AREA+TRABAJO%5C%22%2C%5C%22value%5C%22%3A%5C%22101%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NUMERO+PEDIDO%5C%22%2C%5C%22value%5C%22%3A%5C%22%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22TOTAL+PEDIDO%5C%22%2C%5C%22value%5C%22%3A%5C%22925.6999999999999%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22VALOR+APLICAR+DESCUENTO%5C%22%2C%5C%22value%5C%22%3A%5C%22253.4%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NUMERO+DOCUMENTO%5C%22%2C%5C%22value%5C%22%3A%5C%221104627169%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NOMBRE+CONTACTO%5C%22%2C%5C%22value%5C%22%3A%5C%22OCHOA+VASQUEZ+PABLO+IVAN%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%5D%2C%5C%22secuencial%5C%22%3A1%7D%2C%7B%5C%22codigoSistema%5C%22%3A%5C%22SISPE%5C%22%2C%5C%22descripcion%5C%22%3A%5C%22Solicito+autorizacion+descuento+variable+del+5.0%25+para+la%28s%29+clasificacion%28es%29%3A+1602-CANASTAS+%5C%22%2C%5C%22areaTrabajo%5C%22%3A%5C%22MULTICENTRO%5C%22%2C%5C%22tituloAutorizacion%5C%22%3A%5C%22AUTORIZACION+DESCUENTO+VARIABLE+GERENTE+COMERCIAL+5.0%5C%22%2C%5C%22filtroTipoAutorizacion%5C%22%3A%7B%5C%227%5C%22%3A%5B%7B%5C%22codigoComponente%5C%22%3A23%2C%5C%22valorComponente%5C%22%3A%5C%225.0%5C%22%2C%5C%22soloLectura%5C%22%3Atrue%7D%5D%7D%2C%5C%22filtroUsuariosAutorizadores%5C%22%3A%5B%5C%22KFLOW100%5C%22%5D%2C%5C%22dataKeys%5C%22%3A%5B%7B%5C%22label%5C%22%3A%5C%22AREA+TRABAJO%5C%22%2C%5C%22value%5C%22%3A%5C%22101%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NUMERO+PEDIDO%5C%22%2C%5C%22value%5C%22%3A%5C%22%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22TOTAL+PEDIDO%5C%22%2C%5C%22value%5C%22%3A%5C%22925.6999999999999%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22VALOR+APLICAR+DESCUENTO%5C%22%2C%5C%22value%5C%22%3A%5C%22600.3%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NUMERO+DOCUMENTO%5C%22%2C%5C%22value%5C%22%3A%5C%221104627169%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%2C%7B%5C%22label%5C%22%3A%5C%22NOMBRE+CONTACTO%5C%22%2C%5C%22value%5C%22%3A%5C%22OCHOA+VASQUEZ+PABLO+IVAN%5C%22%2C%5C%22hasAction%5C%22%3Afalse%2C%5C%22isVisibleInManageTaskDescription%5C%22%3Atrue%7D%5D%2C%5C%22secuencial%5C%22%3A2%7D%5D%22%2C%22backgroundColor%22%3A%22%23F4F5EB%22%2 
```

我知道它的查询字符串上有很多数据，并且在传输大量数据时我**应该**使用**POST 。**然而，这就是系统创建它们的方式......在我发现问题之前已经完成了。主要问题是很多模块都依赖于此，更改它会导致无法完成最后期限（下周）。

现在我们在以下 iframe 中使用该 URL：

```
<iframe name="Contactos" width="100%" height="100%" align="middle" class="tabla_informacion" src="urlAbove" frameBorder="0">
</iframe> 
```

然而，当框架出现时，它只是显示一个空白屏幕，服务器上根本没有触发回调......

现在，如果我们减少 url 长度它可以正常工作。乍一看，我以为是**jBOSS AS 6**上的标头长度问题（默认为 8KB），所以我在 server.conf 文件中更改了它，并将其增加到 64KB。一点运气都没有...

但是当我使用**Firefox 的 Poster 插件**创建带有整个 URL 的 GET 请求时，它可以正常工作并且触发了服务器断点，这意味着它不是服务器的问题，至少在当前的 URL 长度下......

也许是浏览器限制？（我们正在使用 Internet Explorer ...）这是一个已知问题吗？或者在调用 iFrame 时我可能缺少一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:13:05.113

这很可能是浏览器限制。在 Firefox 中页面加载（或至少请求到达服务器）的事实是一个很好的提示。

您的 URL 是 4,097 个字符，[在 IE 中的限制是 2,083](http://support.microsoft.com/kb/208427)。

# c++ - 使用枚举类的 C++11 标准符合位掩码

> ID：12059774
> 
> 赞同：36
> 
> 时间：2012-08-21T17:09:04.380
> 
> 标签：c++, c++11, bit-fields, bitmask, enum-class

您可以使用枚举类实现标准符合（如 n3242 草案的 17.5.2.1.3 中所述）类型的安全位掩码吗？我读它的方式，如果类型 T 支持 |,&,^,~,|=,&= 和 ^= 运算符，则它是位掩码，并且您可以进一步执行 if(l&r) 其中 l 和 r 属于 T 类型. 列表中缺少运算符 != 和 == 并允许排序一个可能还想重载 <。

让操作员工作只是烦人的样板代码，但我不知道如何做 if(l&r)。至少以下内容不能使用 GCC 编译（除了非常危险，因为它允许错误的隐式转换为 int）：

```
enum class Foo{
    operator bool(){
        return (unsigned)*this;
    }
}; 
```

编辑：我现在确定枚举类不能有成员。但是，如何做 if(l&r) 的实际问题仍然存在。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-22T20:01:44.433

我认为您可以...您必须为位掩码添加运算符。我没有在这里做，但你可以很容易地重载任何关系运算符。

```
 /**
   *
   */
  // NOTE: I changed to a more descriptive and consistent name
  //       This needs to be a real bitmask type.
  enum class file_permissions : int
  {
    no_perms        = 0,

    owner_read      =  0400,
    owner_write     =  0200,
    owner_exe       =  0100,
    owner_all       =  0700,

    group_read      =   040,
    group_write     =   020,
    group_exe       =   010,
    group_all       =   070,

    others_read     =    04,
    others_write    =    02,
    others_exe      =    01,
    others_all      =    07,

    all_all     = owner_all | group_all | others_all, // 0777

    set_uid_on_exe  = 04000,
    set_gid_on_exe  = 02000,
    sticky_bit      = 01000,

    perms_mask      = all_all | set_uid_on_exe | set_gid_on_exe | sticky_bit, // 07777

    perms_not_known = 0xffff,

    add_perms       = 0x1000,
    remove_perms    = 0x2000,
    symlink_perms   = 0x4000
  };

  inline constexpr file_permissions
  operator&(file_permissions x, file_permissions y)
  {
    return static_cast<file_permissions>
      (static_cast<int>(x) & static_cast<int>(y));
  }

  inline constexpr file_permissions
  operator|(file_permissions x, file_permissions y)
  {
    return static_cast<file_permissions>
      (static_cast<int>(x) | static_cast<int>(y));
  }

  inline constexpr file_permissions
  operator^(file_permissions x, file_permissions y)
  {
    return static_cast<file_permissions>
      (static_cast<int>(x) ^ static_cast<int>(y));
  }

  inline constexpr file_permissions
  operator~(file_permissions x)
  {
    return static_cast<file_permissions>(~static_cast<int>(x));
  }

  inline file_permissions &
  operator&=(file_permissions & x, file_permissions y)
  {
    x = x & y;
    return x;
  }

  inline file_permissions &
  operator|=(file_permissions & x, file_permissions y)
  {
    x = x | y;
    return x;
  }

  inline file_permissions &
  operator^=(file_permissions & x, file_permissions y)
  {
    x = x ^ y;
    return x;
  } 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-21T21:31:39.487

我不完全确定你的接受标准是什么，但你可以只`operator &`返回一个带有适当转换的包装类和一个`explicit operator bool`：

```
#include <type_traits>

template<typename T> using Underlying = typename std::underlying_type<T>::type;
template<typename T> constexpr Underlying<T>
underlying(T t) { return Underlying<T>(t); }

template<typename T> struct TruthValue {
    T t;
    constexpr TruthValue(T t): t(t) { }
    constexpr operator T() const { return t; }
    constexpr explicit operator bool() const { return underlying(t); }
};

enum class Color { RED = 0xff0000, GREEN = 0x00ff00, BLUE = 0x0000ff };
constexpr TruthValue<Color>
operator&(Color l, Color r) { return Color(underlying(l) & underlying(r)); } 
```

当然，您所有其他运营商都可以继续返回`Color`：

```
constexpr Color
operator|(Color l, Color r) { return Color(underlying(l) | underlying(r)); }
constexpr Color operator~(Color c) { return Color(~underlying(c)); }

int main() {
    constexpr Color YELLOW = Color::RED | Color::GREEN;
    constexpr Color WHITE = Color::RED | Color::GREEN | Color::BLUE;
    static_assert(YELLOW == (WHITE & ~Color::BLUE), "color subtraction");
    return (YELLOW & Color::BLUE) ? 1 : 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-21T17:39:13.123

作用域枚举（那些使用`enum class`or创建的`enum struct`）不是类。它们不能有成员函数，它们只是提供封闭的枚举器（在命名空间级别不可见）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-21T20:48:11.837

> 列表中缺少运算符 != 和 ==

枚举类型、整数类型已经支持这些运算符，`std::bitset`因此无需重载它们。

> 并允许排序一个可能还想重载<。

为什么要对位掩码进行排序？(a|b) 是否大于 (a|c)？`std::ios::in`小于`std::ios::app`？_ 有关系吗？无论如何，关系运算符总是为枚举类型和整数类型定义的。

要回答主要问题，您将实现`&`为重载的**非成员**函数：

```
Foo operator&(Foo l, Foo r)
{
    typedef std::underlying_type<Foo>::type ut;
    return static_cast<Foo>(static_cast<ut>(l) & static_cast<ut>(r));
} 
```

我相信位掩码类型的所有必需操作都可以为作用域枚举定义，但不是诸如

> *Ci & Cj*非零且*Ci & Cj*为零

和：

> 在对象*X*中设置的值*Y 是*表达式*X & Y*非零。

 **由于作用域枚举不支持隐式转换为整数类型，因此您无法可靠地测试它是否为非零。你需要写信`if ((X&Y) != bitmask{})`，我认为这不是委员会的意图。

（我最初认为它们可用于定义位掩码类型，然后记得我曾尝试使用范围枚举来实现一个，但在测试零/非零时遇到了问题。）

编辑：我刚刚记得这`std::launch`是一个范围枚举类型和位掩码类型......所以显然范围枚举可以是位掩码类型！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-21T10:28:34.170

下面是枚举标志的简短示例。

```
#indlude "enum_flags.h"

ENUM_FLAGS(foo_t)
enum class foo_t
    {
     none           = 0x00
    ,a              = 0x01
    ,b              = 0x02
    };

ENUM_FLAGS(foo2_t)
enum class foo2_t
    {
     none           = 0x00
    ,d              = 0x01
    ,e              = 0x02
    };  

int _tmain(int argc, _TCHAR* argv[])
    {
    if(flags(foo_t::a & foo_t::b)) {};
    // if(flags(foo2_t::d & foo_t::b)) {};  // Type safety test - won't compile if uncomment
    }; 
```

ENUM_FLAGS(T) 是一个宏，在[enum_flags.h](https://sourceforge.net/projects/lordodinscpplib/files/enum_flags.h/download)中定义（少于 100 行，免费使用，没有限制）。**

# python - 排序python字典列表

> ID：12059781
> 
> 赞同：1
> 
> 时间：2012-08-21T17:10:04.790
> 
> 标签：python

我有这个代码：

```
from BeautifulSoup import BeautifulSoup

TABLE_CONTENT = [['958','<a id="958F" href="javascript:c_row(\'958\')" title="go to map"><img src="/images/c_map.png" border="0"></a>','USA','Atmospheric','<a href="javascript:c_ol(\'958\')" title="click date time to show origin_list (evid=958)">1945/07/16 11:29:45</a>','33.6753','-106.4747','','-.03','21','','','TRINITY','&nbsp;','&nbsp;','<a href="javascript:c_md(\'958\')" title="click here to show source data">SourceData</a>','&nbsp;'],['959','<a id="959F" href="javascript:c_row(\'959\')" title="go to map"><img src="/images/c_map.png" border="0"></a>','USA','Atmospheric','<a href="javascript:c_ol(\'959\')" title="click date time to show origin_list (evid=959)">1945/08/05 23:16:02</a>','34.395','132.4538','','-.58','15','','','LITTLEBOY','&nbsp;','&nbsp;','<a href="javascript:c_md(\'959\')" title="click here to show source data">SourceData</a>','&nbsp;']]

EVENT_LIST = []
for EVENT in TABLE_CONTENT:
    events = {}
    for index, item in enumerate(EVENT):
        if index == 0:
            events['id'] = item
        if index == 4:
            soup = BeautifulSoup(item)
            for a in soup.findAll('a'):
                events['date'] = ''.join(a.findAll(text=True))
        if index == 2:
            events['country'] = item
        if index == 3:
            events['type'] = item
        if index == 5:
            events['lat'] = item
        if index == 6:
            events['lon'] = item
        if index == 8:
            events['depth'] = item
        if index == 9:
            events['yield'] = item
        if index == 12:
            events['name'] = item
    sorted(events, key=lambda key: events['id'])
    EVENT_LIST.append(events)
    print '=== new record ==='
EVENT_LIST.sort(key=lambda x: x['id'])
print EVENT_LIST 
```

我遇到的第一个问题是，在 EVENT_LIST 中，字典对象的顺序与它们添加到列表中的顺序不同，例如，当我打印结果时，'lat' 和 'lon' 不是按顺序排列的：

```
[{'name': 'TRINITY', 'country': 'USA', 'lon': '-106.4747', 'yield': '21', 'lat': '33.6753', 'depth': '-.03', 'date': u'1945/07/16 11:29:45', 'type': 'Atmospheric', 'id': '958'}, {'name': 'LITTLEBOY', 'country': 'USA', 'lon': '132.4538', 'yield': '15', 'lat': '34.395', 'depth': '-.58', 'date': u'1945/08/05 23:16:02', 'type': 'Atmospheric', 'id': '959'}] 
```

还有更好的方法来编写这段代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:12:16.537

[https://stackoverflow.com/a/526131/735204](https://stackoverflow.com/a/526131/735204)

字典根据定义是无序的，因为它们在内部存储为哈希表。缺少排序是从哈希表中插入和删除键的算法的结果。因此，您永远不应该依赖字典的键以任何特定顺序。也许考虑使用元组或字典列表 - 后者将允许您维护键：值格式，同时还保证可靠的排序。

如果您真的打算使用字典，您可能还想查看 OrderedDict，尽管恕我直言，如果您使用字典并要求对其进行排序，那么您正在以错误的方式考虑数据，并且可能存在更简单的方法来做到这一点。[http://docs.python.org/library/collections.html#collections.OrderedDict](http://docs.python.org/library/collections.html#collections.OrderedDict)

对于好奇的人来说，这是一个很好的演示文稿，准确解释了 Python 字典为什么具有未定义的排序[http://blip.tv/pycon-us-videos-2009-2010-2011/pycon-2010-the-mighty-dictionary- 55-3352147](http://blip.tv/pycon-us-videos-2009-2010-2011/pycon-2010-the-mighty-dictionary-55-3352147)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:13:18.333

[您可以使用OrderedDict](http://docs.python.org/library/collections.html#collections.OrderedDict)容器保留插入字典的顺序。从手册：

> 返回一个 dict 子类的实例，支持常用的 dict 方法。OrderedDict 是一个 dict，它记住第一次插入键的顺序。如果新条目覆盖现有条目，则原始插入位置保持不变。删除条目并重新插入会将其移至末尾。

此功能仅在 2.7 版本后才出现。

@更好的方法：您可能会在之后更改`if index == ...`，`elif index == ...`因为如果索引为 2，则它永远不会是 5。或者您可以存储索引/键组合并使用它们来存储您的项目。示例（未尝试）：

```
combos={
        0: 'id',
        2: 'country',
        3: 'type',
        5: 'lat',
        6: 'lon',
        8: 'depth',
        9: 'yield',
        12: 'name' }

...

for index, item ...:
    if index == 4:
        soup = BeautifulSoup(item)
        for a in soup.findAll('a'):
        events['date'] = ''.join(a.findAll(text=True))
    elif index in combos:
        events[combox[index]]=item 
```

我想你应该已经明白了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:13:58.577

Python 中的字典默认是无序的。

您可以改用[OrderedDict](http://docs.python.org/dev/library/collections.html#collections.OrderedDict)。请注意，这仅在 Python 2.7+ 中可用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T17:17:11.627

更好的转换代码：

```
from BeautifulSoup import BeautifulSoup

HEADERS = ['id', None, 'country', 'type', 'date', 'lat', 'lon', None, 'depth', 'yield', None, None, 'name']
TABLE_CONTENT = [['958','<a id="958F" href="javascript:c_row(\'958\')" title="go to map"><img src="/images/c_map.png" border="0"></a>','USA','Atmospheric','<a href="javascript:c_ol(\'958\')" title="click date time to show origin_list (evid=958)">1945/07/16 11:29:45</a>','33.6753','-106.4747','','-.03','21','','','TRINITY','&nbsp;','&nbsp;','<a href="javascript:c_md(\'958\')" title="click here to show source data">SourceData</a>','&nbsp;'],['959','<a id="959F" href="javascript:c_row(\'959\')" title="go to map"><img src="/images/c_map.png" border="0"></a>','USA','Atmospheric','<a href="javascript:c_ol(\'959\')" title="click date time to show origin_list (evid=959)">1945/08/05 23:16:02</a>','34.395','132.4538','','-.58','15','','','LITTLEBOY','&nbsp;','&nbsp;','<a href="javascript:c_md(\'959\')" title="click here to show source data">SourceData</a>','&nbsp;']]

EVENT_LIST = []
for EVENT in TABLE_CONTENT:
    events = {}
    for index, item in enumerate(EVENT):
        if index != 4:
            events[HEADERS[index]] = item
        if index == 4:
            soup = BeautifulSoup(item)
            for a in soup.findAll('a'):
                events[HEADERS[index]] = ''.join(a.findAll(text=True))
    sorted(events, key=lambda key: events['id'])
    EVENT_LIST.append(events)
    print '=== new record ==='
EVENT_LIST.sort(key=lambda x: x['id'])
print EVENT_LIST 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T17:24:01.873

首先是关于您的代码的一些评论：

1.  `events`如果它在循环中，为什​​么要调用它？它只有一个`event`
2.  为什么要`events`为不同的事件重用变量？例如，如果事件格式错误，例如没有项目，这可能很危险
3.  `sorted`在您的代码中是无操作的，它没有副作用
4.  为什么将 CAPITAL 用于非常量变量？

字典上的问题不是真正的问题，而是一个特性：键是按其哈希排序的，因为`dict`它是基于哈希的。如果您确实需要保存订单，您可以使用`collections.OrderedDict`

顺便说一下，这里有一个例子：

```
import operator

event_list = []
for event in TABLE_CONTENT:
    event_dict = {}
    event_dict['id'] = event[0]
    event_dict['country'] = event[2]
    # ...
    event_dict['name'] = event[12]
    event_list.append(event_dict)
event_list = sorted(event_list, key = operator.itemgetter('id'))
print event_list 
```

# charts - 如何使用 drupal 模块图表将标签分配给 x 轴？

> ID：12059786
> 
> 赞同：1
> 
> 时间：2012-08-21T17:10:47.050
> 
> 标签：charts, google-visualization, drupal-6

我正在尝试使用[图表创建条形图，这是一个使用](https://www.drupal.org/project/chart)[谷歌图表工具](https://developers.google.com/chart/image/)的 drupal 模块。

我不知道如何在栏下放置标签。标签应该是“a”、“b”等。出于某种原因，只有第一个标签“a”显示在 x 轴上，并且它的直线显示在图形的中心。这是我的代码：

```
$chart = array(
  '#chart_id' => 'test_chart2',
  '#title' => chart_title(t('Bar Chart'), '0000ee', 15),
  '#type' => CHART_TYPE_BAR_V_GROUPED,
  '#size' => chart_size(400, 200),
  '#grid_lines' => chart_grid_lines(10, 10),
  '#bar_size' => chart_bar_size(25, 5),

 );

  $chart['#data'][] = array(10);
  $chart['#data'][] = array(20);
  $chart['#data'][] = array(30);
  $chart['#data'][] = array(40);
  $chart['#data'][] = array(50);
  $chart['#data'][] = array(60);
  $chart['#data'][] = array(70);
  $chart['#data'][] = array(80);

  $chart['#data_colors'][] = chart_unique_color('test_a');
  $chart['#data_colors'][] = chart_unique_color('test_b');
  $chart['#data_colors'][] = chart_unique_color('test_c');

  $chart['#mixed_axis_labels'][CHART_AXIS_Y_LEFT][0][] =   chart_mixed_axis_range_label(0, 200);
  $chart['#mixed_axis_labels'][CHART_AXIS_Y_LEFT][3][] = chart_mixed_axis_label(t('Hours'), 95);

  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][4][] = chart_mixed_axis_label(t('a'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][5][] = chart_mixed_axis_label(t('b'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][6][] = chart_mixed_axis_label(t('c'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][7][] = chart_mixed_axis_label(t('d'));  
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][8][] = chart_mixed_axis_label(t('e'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][9][] = chart_mixed_axis_label(t('f'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][10][] = chart_mixed_axis_label(t('g'));
  $chart['#mixed_axis_labels'][CHART_AXIS_X_BOTTOM][11][] = chart_mixed_axis_label(t('h'));

  return chart_render($chart); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T06:37:06.907

在 Drupal 6 中，在为图表模块应用此补丁[http://drupal.org/files/issues/chart.module-1169430.patch](http://drupal.org/files/issues/chart.module-1169430.patch)后，我使用了 CHART_TYPE_BAR_V 而不是 CHART_TYPE_BAR_V_GROUPED ，

```
$chart = array(
    '#chart_id' => $chart_id,
    '#title' => $title,
    '#type' => CHART_TYPE_BAR_V,
    '#size' => chart_size(700, 400),
    '#grid_lines' => chart_grid_lines(10, 10),
    '#bar_size' => chart_bar_size(55, 15),
  );
$chart['#data'][] = 10;
$chart['#data'][] = 20;
$chart['#data_colors'][] = C1;
$chart['#data_colors'][] = C2;
$chart['#mixed_axis_labels'][CHART_AXIS_X_TOP][1][] = chart_mixed_axis_label('a');
$chart['#mixed_axis_labels'][CHART_AXIS_X_TOP][1][] = chart_mixed_axis_label('b'); 
```

有关此补丁的更多详细信息，请参阅图表问题[https://www.drupal.org/node/1169430](https://www.drupal.org/node/1169430)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T08:03:51.077

chart_mixed_axis_label() 方法采用第二个百分比参数来定位值。

尝试给出百分比值。

```
chart_mixed_axis_label(t('a'), 10)
chart_mixed_axis_label(t('a'), 20)
chart_mixed_axis_label(t('a'), 30) 
```

等等。

# android - 在我的 android 应用程序中开始新声音之前停止以前的声音

> ID：12059787
> 
> 赞同：-1
> 
> 时间：2012-08-21T17:10:48.560
> 
> 标签：android, audio

此代码不起作用..任何人都可以帮助我。当我运行此代码时，会出现错误提示强制关闭应用程序。我想在
每次点击时开始一个新的声音。在这里，我使用 *图像作为我的按钮*。

```
package com.kle;

import java.io.IOException;

import com.kle.Kid.R;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
//import android.widget.Button;
import android.widget.ImageView;

public class Thirteen extends Activity implements OnClickListener{

int flag=1;
//Button b1;
MediaPlayer mp1,mp2,mp3,mp4,mp5,mp6,mp7,mp8,mp9,mp10;

ImageView iv;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.thirteen);

    iv=(ImageView) findViewById(R.id.imageView1);

    ImageView image1=(ImageView) findViewById(R.id.imageView1);
    ImageView image2=(ImageView) findViewById(R.id.imageView2);
    ImageView image3=(ImageView) findViewById(R.id.imageView3);
    ImageView image4=(ImageView) findViewById(R.id.imageView4);
    ImageView image5=(ImageView) findViewById(R.id.imageView5);
    ImageView image6=(ImageView) findViewById(R.id.imageView6);
    ImageView image7=(ImageView) findViewById(R.id.imageView7);
    ImageView image8=(ImageView) findViewById(R.id.imageView8);
    ImageView image9=(ImageView) findViewById(R.id.imageView9);
    ImageView image10=(ImageView) findViewById(R.id.imageView10);

    //b1= (Button) findViewById(R.id.button1);
    mp1= MediaPlayer.create(Thirteen.this, R.raw.one);
    mp2= MediaPlayer.create(Thirteen.this, R.raw.two);
    mp3= MediaPlayer.create(Thirteen.this, R.raw.three);
    mp4= MediaPlayer.create(Thirteen.this, R.raw.four);
    mp5= MediaPlayer.create(Thirteen.this, R.raw.five);
    mp6= MediaPlayer.create(Thirteen.this, R.raw.six);
    mp7= MediaPlayer.create(Thirteen.this, R.raw.seven);
    mp8= MediaPlayer.create(Thirteen.this, R.raw.eight);
    mp9= MediaPlayer.create(Thirteen.this, R.raw.nine);
    mp10= MediaPlayer.create(Thirteen.this, R.raw.ten);

    image1.setOnClickListener(this);
    image2.setOnClickListener(this);
    image3.setOnClickListener(this);
    image4.setOnClickListener(this);
    image5.setOnClickListener(this);
    image6.setOnClickListener(this);
    image7.setOnClickListener(this);
    image8.setOnClickListener(this);
    image9.setOnClickListener(this);
    image10.setOnClickListener(this);
    //b1.setOnClickListener(this);

}

public void onClick(View v) {
    // TODO Auto-generated method stub

    switch(v.getId()){

    case R.id.imageView1: {
        iv.setImageResource(R.drawable.kidone);
        mp2.stop();
        mp3.stop();
        mp4.stop();
        mp5.stop();
        mp6.stop();
        mp7.stop();
        mp8.stop();
        mp9.stop();
        mp10.stop();

        try {
            mp1.prepare();
        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        mp1.seekTo(0);
        mp1.start();

        break;
    }
    case R.id.imageView2: {
        iv.setImageResource(R.drawable.kidtwo);
        mp1.stop();
        mp3.stop();
        mp4.stop();
        mp5.stop();
        mp6.stop();
        mp7.stop();
        mp8.stop();
        mp9.stop();
        mp10.stop();

        try {
            mp2.prepare();
        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        mp2.seekTo(0);
        mp2.start();

        break;
    }
    case R.id.imageView3: {
        iv.setImageResource(R.drawable.kidthree);

        mp2.stop();
        mp1.stop();
        mp4.stop();
        mp5.stop();
        mp6.stop();
        mp7.stop();
        mp8.stop();
        mp9.stop();
        mp10.stop();

        try {
            mp3.prepare();
        } catch (IllegalStateException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        mp3.seekTo(0);
        mp3.start();

        break;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:20:58.840

首先，您必须检查您的 logcat 是否存在异常，以便您更容易找到问题的根源。现在解决您的问题：您正在停止未播放的媒体播放器...在停止媒体播放器之前添加检查：

```
private void stopPlaying(MediaPlayer mp)
{
     if (mp != null && mp.isPlaying())
     {
          mp.stop();
     }
} 
```

并调用：

```
stopPlaying(mp1);
stopPlaying(mp2);
stopPlaying(mp3);
... 
```

（虽然我更喜欢使用数组进行这种编码，因为它会使代码更具可读性和更易于维护 - 使用循环）。

# session - On Session Timeout Login.gsp 在标签内呈现，而不是重定向到新的 gsp 页面

> ID：12059791
> 
> 赞同：0
> 
> 时间：2012-08-21T17:11:00.390
> 
> 标签：session, grails, login, timeout

我是 Grails 的新手，正在开发一个只有 2 个控制器的项目，一个用于登录，另一个用于资源管理器（类似于 Windows 资源管理器，左侧面板显示树状结构，右侧将文件夹内容显示为桌子）

当用户访问应用程序时，应用程序按预期工作，如果用户尚未登录，则显示登录屏幕，如果他已登录，则显示资源管理器屏幕。

但是会话超时情况并非如此：假设会话超时并且用户单击资源管理器屏幕右侧面板中的链接，然后登录屏幕将显示在右侧面板中。

我正在使用 SecurityFilter 重定向到登录屏幕。

SecurityFilters.groovy

def 过滤器 = {

```
 loginCheck(controller:'*', action:'*') {
        before = {
    if (!session.idpuser && actionName != "login") {
                redirect(controller: "user", action: "login")                   
                return false 
            }
        }
    }
} 
```

用户控制器.groovy

定义登录（）{

```
if (request.get) {        
  return false
}
......  
 redirect(controller: "explorer", action: "file") 
```

}

explorerController.groovy

def 生成文件 = {

```
.....
render(template: 'list', model: [ dirList: dirList]) 
```

}

UrlMappings.groovy

静态映射 = {

```
 "/$controller/$action?/$id?"{
        constraints {
            // apply constraints here
        }
    }

    "/"(action:"file", controller: "explorer")  
    "500"(view:'/error')
} 
```

我认为 login.gsp 在右侧面板中呈现的原因是，当用户单击右侧面板中的链接时，会调用“generateFiles”操作，并将 login.gsp 呈现为 explorer.gsp 中的模板。但我不知道如何解决它:(

如果有人可以帮助我解决这个问题，我将不胜感激。请帮忙！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T14:51:33.677

由于这是一个基于 ajax 的站点，因此您需要在 ajax 响应处理程序中显式处理“您需要登录”响应，并在需要时强制用户进入登录页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:11:26.510

看起来我发现该解决方案可能不是一种有效的方法，但它确实有效。根据我从 Ajax 调用中得到的响应，我使用重定向到 Login.gsp

`window.location.href = '${createLink(controller='user', action='login')}'`

谢谢 cdeszaq 的提示。对此，我真的非常感激。

# python - 在 HTML 元素中自动换行 Qt Qlabel 文本

> ID：12059792
> 
> 赞同：3
> 
> 时间：2012-08-21T17:11:03.693
> 
> 标签：python, html, pyqt4, word-wrap, qlabel

**介绍：**

我正在尝试在 QT 中绘制分页论坛帖子。我最初的一些努力导致了`QFrame`嵌套标签（[此处](https://stackoverflow.com/questions/11677499/pyside-qt-auto-vertical-growth-for-textedit-widget-and-spacing-between-widgets)显示了屏幕截图）。从那时起，我不得不将引号与常规文本混合在一起，并且我需要动态标签以我当前的方法来做到这一点（即，一个帖子实例可能有 5 个引号和 7 个常规文本 = 13`QLabel`秒，并且每次我绘制一个新的帖子实例我重新创建了所有的`QLabel`s)。创建和销毁 QLabels 非常昂贵，而且我看到了视觉滞后。

所以我决定尝试一次`QLabel`使用`HTML`. [我选择了此处](http://www.microbion.co.uk/web/vertline.htm)概述的方法来使用模拟的垂直线将帖子元数据和帖子正文分开。

垂直线工作正常，但是我无法将帖子正文换行。我怀疑 QT 的 html 引擎很难强制执行，而且我不是 HTML 专家。

**问题：**

如何让以下代码自动换行到固定宽度（即垂直增长）。

```
from PyQt4.QtGui import QApplication, QLabel
import sys

html = '''
<table cellspacing="5" border="0" cellpadding="0">
<tr valign="top" align="left">
<td style="padding-right: 10px;" width="100">
  <p>#%s<br>
  <b>User:</b> %s<br>
  <b>posted at:</b> %s </p>
</td>
<td width="1" bgcolor="#00FFFF"><BR></td>
<td style="padding-left: 10px;" width="100" valign="top" align="left">
  <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Typi non habent claritatem insitam; est usus legentis in iis qui facit eorum claritatem. Investigationes demonstraverunt lectores legere me lius quod ii legunt saepius. Claritas est etiam processus dynamicus, qui sequitur mutationem consuetudium lectorum. Mirum est notare quam littera gothica, quam nunc putamus parum claram, anteposuerit litterarum formas humanitatis per seacula quarta decima et quinta decima. Eodem modo typi, qui nunc nobis videntur parum clari, fiant sollemnes in futurum. </p>
</td>
</tr>
</table>
''' % (1, "hassan", "sunday") 

app = QApplication(sys.argv)
l = QLabel(html)
l.show()
app.exec_()
sys.exit() 
```

结果是：

![在此处输入图像描述](../Images/217f6b0b86f83e59ed63090aad36e9c3.png)

注意：宽度不被尊重，也没有自动换行。

哦，如果您想炫耀，请随意设置帖子样式并显示引用区域：D

**编辑：**

我尝试更改 post body 小部件（而不是更改整个小部件），它是一个`QVBoxLayout`with `QLabel`s。`<p>`我用and将其更改为单个 QLabel `<blockquote>`。而且该组合可以正确换行。尽管工作正常，但布局+标签方法看起来更好。

所以也许我应该修改我的设计并维护一个 Quote Widgets + 常规文本标签列表，以便通过回收来摆脱视觉滞后。

尽管如此，如果有人可以从上面的代码中创建和设置合理的论坛帖子的 html 表示形式，它可能是一个更强大的解决方案。

**编辑2：**

虽然在我的情况下可能会获得基于 HTML 的样式来处理单个 QLabel，但在尝试让它工作之后，我得出的结论是，多 QLabel 方法以更可控的方式布置事情，而不需要太多努力我这边。我会坚持这一点。/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T18:26:11.783

在这种情况下，自动换行问题可能是由使用 引起的`QLabel`，而不是 html 引擎的任何限制。

默认情况下，[自动换行](http://doc-snapshot.qt-project.org/4.8/qlabel.html#wordWrap-prop)是关闭的，因此请尝试：

```
l = QLabel(html)
l.setWordWrap(True)
l.show() 
```

# php - 提交表单时如何根据下拉框中的值禁用html表单输入框

> ID：12059793
> 
> 赞同：1
> 
> 时间：2012-08-21T17:11:03.450
> 
> 标签：php, javascript, html, ajax

我有一个包含多个输入字段、客户姓名和地址的 html 表单。当用户提交表单时，这些字段中的值被发送到由 2 个表组成的数据库中。

我还有一个带有“是”和“否”选项的下拉框。当表单被选出“ no”选择时，我需要值以正常的方式发送到数据库，但随后，我不再清除新条目的输入字段用户在其中输入的值。而地址字段为新条目重置。

然后，用户可以在地址字段中输入新值并再次按提交，这些值将被添加到我的数据库的地址表中，其中客户 ID 是他们之前输入的姓名/姓氏。

这将重复，直到他们按下表单上的不同按钮，然后发送最终地址并重置整个表单以输入新的客户。

到目前为止，我已经设置好了，因此用户可以输入客户姓名和地址并按提交，然后它将被发送到数据库，并且表单将重置为另一个客户条目。

这是我的表格，有 4 个输入字段，

```
<form name="add" method="post" action="newCustomer.php">
<div id="leftcol">
<label><span>Name</span><br /> <input type="text" name="addFname" /></label>
<label><span>Surname</span> <input type="text" name="addLname" /> </label>
<label><span>Single Site?</span><Select name="field" onchange="showHide(this.value)

</label>
<div id="rightcol">
<label><span>Address line 1</span><input type="text" name="addSiteLine1" /></label>
<label><span>Address line 2</span><input type="text" name="addSiteLine2" /></label> 
```

到目前为止，我已尝试将其添加到我的 php 代码的底部

```
if($dropdown== "no"){
     disable_text(true);

     } 
```

disable text 是一个禁用文本的javascript函数，但这没有做任何事情。

我还尝试在表单提交时调用此函数，但随后我的 $_POST 方法无法获取值。当我使用只读而不是禁用再次尝试设置时，似乎什么也没发生。

我基本上是试图避免需要第二个表单/网页来添加客户地址，并试图避免为多个地址添加多个输入框（因为有些可能有 100 多个地址）

编辑

$Dropdown 在 php 中定义为：

```
$dropdown = $_POST['field']; 
```

形式为

```
<label><span>Single Site?</span><Select name="field" onchange="showHide(this.value);">
</label>
<Option value="yes">yes</option>
<Option value="no">no</option> 
```

正在调用该函数，当该函数禁用所有文本字段时，我可以看到它发生，它们会闪烁灰色然后页面会刷新，我会收到错误消息说

```
 $fName = $_POST['addFname']; 
```

无法定义。当我更改函数以使字段只读时似乎没有发生任何事情，它只会提交数据并清除表单以准备新输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:37:16.980

我可能不明白这个问题，如果我错了，请纠正我。你不能用javascript禁用字段并将字段值保存在会话变量中以带回表单吗？

```
document.getElementById('fieldToDisable').style.disabled= 'true'; 
```

制作会话变量标志，如果在页面加载时设置了该标志，则重新填写表单并禁用字段。

# c - C中的文件操作给出奇怪的输出

> ID：12059794
> 
> 赞同：0
> 
> 时间：2012-08-21T17:11:09.027
> 
> 标签：c, file-io

我正在运行一段 C 代码，它从 10 个[Dynamixel](http://support.robotis.com/en/software/dynamixel_sdk/api_reference.htm)伺服电机（ID、位置、角度、负载扭矩）获取信息并将它们打印到屏幕上，并将其写入日志文件（watchdog_log.txt）。

```
#include <stdio.h>
#include <stdlib.h>
#include <termio.h>
#include <unistd.h>
#include <string.h>
#include <dynamixel.h>
#include <math.h>
#include <dynamixelAX.h>
#include "utils_v2.h"
#include "low_level_v2AX.h"
#include "low_level_v2.h"

// Control table address
#define P_GOAL_POSITION_L       30
#define P_GOAL_POSITION_H       31
#define P_PRESENT_POSITION_L    36
#define P_PRESENT_POSITION_H    37
#define P_MOVING                46

// Defulat setting
#define DEFAULT_BAUDNUM         34 // 1Mbps
#define DEFAULT_BAUDNUM_AX  1
#define DEFAULT_ID              1

int main()
{
  FILE *fp;

  /* Get actuator ID from command line argument */
  int baudnum = 34;
  int baudnum_AX = 1;
  int deviceIndex = 0;
  int deviceIndex_AX = 1;
  int current;
  float load, angle;

  int i=0;
  int MOTOR_CHAIN[13]={-1,1,1,0,0,0,-1,1,1,0,0,0,-1};
  int MOTOR_CHAIN_AX[18]={2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2}; 
  int MOTOR_HOME[13]={404,444,3216,2037,2289,512,860,661,879,3474,1747,512};  //0, 6 and 12 are dummy
  int MOTOR_HOME_AX[18]={512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,};

  char report[1000];
  char buffer[50];

  strcpy(report,"***********\n");

  /* Initialise Open USB2Dynamixel */
  if( dxl_initialize(deviceIndex, baudnum) == 0 )
    {
      printf( "Failed to open USB2Dynamixel!-chain'0'\n" );
      printf( "Press Enter key to terminate...\n" );

    }
  else
    printf( "Successfully opened USB2Dynamixel 0!\n" );

 if( dxl_initializeAX(deviceIndex_AX, baudnum_AX) == 0 )
    {
      printf( "Failed to open USB2Dynamixel!-chain'1'\n" );
      printf( "Press Enter key to terminate...\n" );
    }
  else
    printf( "Successfully opened USB2Dynamixel 1!\n" );

  /*  Ping all devices */
  printf("Pinging devices...");

  for( i=0; i<=12; i++)
  {
    dxl_ping(i);

   if (dxl_get_result() == COMM_RXSUCCESS)
   { 
    current = (fabs(dxl_read_word(i, 0x34)-512)*10);
    load = dxl_read_word(i, 0x28);
    if (load>=1024)
    load=(load-1024)*0.1;
    else load=load*0.1;

    int theta = dxl_read_word(i, 36);
    angle = counttoangle(MOTOR_CHAIN[i], MOTOR_HOME[i], theta);
    printf("ID: %d success,      Load:  %3.1f,       Count =  %d,     Angle =   %3.2f\n", i, load, theta, angle) ;
    sprintf(buffer,"ID: %d success,      Load:  %3.1f,       Count =  %d,     Angle =   %3.2f\n",i, load, theta, angle);
    strcat(report,buffer);

   }
  else printf("ID: %d failure\n",i);
 }

//File operations
strcat(report,"***********\n\n\n");

fp = fopen("watchdog_log.txt","w"); /* append file (add text to a file or create a file if it does not exist.*/ 
fprintf(fp,"%s",report); /*writes to file*/
fclose(fp); /*done!*/** 

 /* Close device */
  dxl_terminateAX();
  return 0;
  } 
```

我在 Ubuntu 上使用“watch”命令每隔一秒运行一次代码，以不断监控屏幕上代码的输出。

```
watch -n 1 ./watchdog 
```

未进行文件操作时，终端输出正常。但是当文件写入完成时，终端会给出奇怪的输出：

**正常输出** ![正常输出](../Images/9663894d2982398b2a045efd42fc7edb.png)

**奇怪的输出** ![奇怪的输出](../Images/20b0772d7646cf8d23e9a0bcdd34a750.png)

对上述问题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T21:26:50.760

乍一看，问题在于您的变量： `char report[1000];` `char buffer[50];`

当您与他们一起工作时，他们会溢出。例如 `sprintf(buffer,"ID: %d success, Load: %3.1f, Count = %d, Angle = %3.2f\n",i, load, theta, angle);` 字符串的最小大小大于 50 字节！所以你可以尝试增加你的字符串变量的大小或计算需要的大小并将它们分配在堆中......

# objective-c - 将 UITapGestureRecognizer 添加到 UINavigationBar 会覆盖使用 ScrollToTop 的能力

> ID：12059795
> 
> 赞同：0
> 
> 时间：2012-08-21T17:11:11.960
> 
> 标签：objective-c, ios, uitableview, uigesturerecognizer

所以我在导航栏中添加了一个 TapGestureRecognizer 以“下拉”另一个视图，因此它是一个 UIPanGesture 识别器。问题是当添加此手势时，UITableView scrollToTop 方法不再起作用，即使在添加手势识别器之前或之后启用也是如此。

有没有人经历过或能想到一个简单的解决方案？

谢谢！

这是我的代码：

```
if (!pan) {
    _pan = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panaction:)];
   [_pan setMaximumNumberOfTouches:1];
}

_pan.delegate = self;
[self.navigationController.navigationBar addGestureRecognizer:_pan]; 
```

编辑：

好的，问题似乎是添加一个 UIView 作为子视图以便从 UINavigation 栏向下拖动，当我不添加子视图时，scrollToTop 工作正常，一旦添加它必须拦截状态栏下方的触摸事件。

# vb.net - 当单击复选框而不是单击按钮时，我想计算 datagridview 上的选中复选框

> ID：12059804
> 
> 赞同：1
> 
> 时间：2012-08-21T17:11:38.863
> 
> 标签：vb.net, datagridview, checkbox

我想计算单击复选框时在 datagridview 中选中的复选框的数量。

这是我的代码：

```
Dim count1 As Integer = 0
For Each row As DataGridViewRow In dgvAtt.Rows
  If row.Cells(1).Value = True Then
    count1 += 1
  End If
Next

txtCnton.Text = count1 
```

我已经在 CellContentClick、CellValueChanged 和 CellStateChanged 中调用了上述过程，但计数不正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T19:17:39.787

复选框计数与您的预期不同有两个可能的原因。最有可能的是，由于 datagridview 编辑控件在失去焦点时如何提交其值，因此复选框列的值滞后于复选框状态。

解决方法是按照[MSDN 上的描述处理 CurrentCellDirtyStateChanged 事件。](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcelldirtystatechanged.aspx#Y300)

所以你的代码会变成这样：

```
Sub dataGridView1_CurrentCellDirtyStateChanged( _
    ByVal sender As Object, ByVal e As EventArgs) _
    Handles dataGridView1.CurrentCellDirtyStateChanged

    If dataGridView1.IsCurrentCellDirty Then
        dataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit)
    End If 
End Sub 
```

然后您 CellValueChangedHander 更改为：

```
Public Sub dataGridView1_CellValueChanged(ByVal sender As Object, _
    ByVal e As DataGridViewCellEventArgs) _
    Handles dataGridView1.CellValueChanged

    If dataGridView1.Columns(e.ColumnIndex).Name = "CheckBoxes" Then 
        Dim count1 As Integer = 0
        For Each row As DataGridViewRow In dgvAtt.Rows
            If row.Cells("CheckBoxes").Value IsNot Nothing And row.Cells("CheckBoxes").Value = True Then
                count1 += 1
            End If
        Next

        txtCnton.Text = count1
    End If 
End Sub 
```

* * *

在上面的代码中，我还解决了计数不正确的第二个可能原因。在您的代码中，您通过单元格数组中的索引引用 datagridview 单元格。这几乎从来都不是最好的方法。相反，每一列都有一个可以在索引器中使用的名称。

# python - gstreamer 帮助消息覆盖我的 argparse 消息

> ID：12059806
> 
> 赞同：3
> 
> 时间：2012-08-21T17:11:42.667
> 
> 标签：python, helper, gstreamer, argparse

我正在尝试使用 argparse 来处理我的应用程序的命令行参数，但我在使用 gstreamer（我的应用程序使用）时遇到了一些问题。当我为我的应用程序提供 -h 选项时，它没有显示我为程序参数定义的帮助消息，而是显示一个奇怪的 gstreamer 帮助消息，省略了我的参数的帮助。

我的代码中有以下解析器定义：

```
parser = argparse.ArgumentParser()
parser.add_argument("-c", "--capture", help="Specifies the capture device.\n 0 - Webcam \n 1 - Kinect", type=int, choices=[0, 1], default=0)
parser.add_argument("-i", "--interval", help="Specifies the capture interval in seconds when the auto-capture is on", type=int, choices=[4, 5, 6, 7, 8], default=4)
args = parser.parse_args() 
```

当我使用 -h 启动程序时收到的消息是（我的语言环境是巴西葡萄牙语，但足以看到帮助消息的一般结构以及我的可选参数缺乏帮助）

```
Uso:
  FasTracker.py [OPÇÃO...] - GStreamer initialization

Opções de ajuda:
  -h, --help                        Exibe opções de ajuda
  --help-all                        Exibe todas as opções de ajuda
  --help-gst                        Exibir opções do GStreamer 
```

我做错了什么，还是有办法抑制 Gstreamer 帮助消息？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T03:11:59.460

我也有同样的问题。我正在使用 ubuntu 10.10 + python 2.6 + python-gst0.10 包。

最后我找到了这个错误：`import gst`在`parser.parse_args()`修改之前`sys`。要重现，请将以下代码放入`main.py`：

```
if __name__=='__main__':
    import argparse, sys
    pparser = argparse.ArgumentParser(description='my program')
    pparser.add_argument('--plot', action='store_true', default=False, help="Show a plot")
    pparser.add_argument('--log', action='store_true', default=False, help="Write log output")
    pparser.add_argument('filename', action='store', type=str)
    import gst
    args = pparser.parse_args(sys.argv[1:]) 
```

并运行`python main.py -h`。这会产生以下错误输出：

```
Usage:
  main.py [OPTION...] - GStreamer initialization

Help Options:
  -h, --help                        Show help options
  --help-all                        Show all help options
  --help-gst                        Show GStreamer Options 
```

如果我们删除`import gst`（或将语句移到 之后`parse_args`），那么输出是正确的：

```
usage: main.py [-h] [--plot] [--log] filename

my program

positional arguments:
  filename

optional arguments:
  -h, --help  show this help message and exit
  --plot      Show a plot
  --log       Write log output 
```

# java - Netty 回显服务器无法处理 100 多个频道

> ID：12059813
> 
> 赞同：0
> 
> 时间：2012-08-21T17:12:19.870
> 
> 标签：java, netty, nio

我想创建一个聊天服务器来处理不同房间的 100-500 个用户。
我决定使用 Netty 框架，因为基于事件的架构（这对我来说非常熟悉）。我从小型服务器开始，它对收到的所有内容都响应“NYA”。主要的：

```
 public class ChatServer{
    public static void main(String[] args) throws Exception {
        ExecutorService bossExec = new OrderedMemoryAwareThreadPoolExecutor(1, 400000000, 2000000000, 60, TimeUnit.SECONDS);
        ExecutorService ioExec = new OrderedMemoryAwareThreadPoolExecutor(4 /* число рабочих потоков */, 400000000, 2000000000, 60, TimeUnit.SECONDS);

        ChannelFactory factory = new NioServerSocketChannelFactory(bossExec,ioExec);
        ServerBootstrap bootstrap = new ServerBootstrap(factory);

        bootstrap.setPipelineFactory(new ChannelPipelineFactory(){
            public ChannelPipeline getPipeline(){
                return Channels.pipeline(new ChatChannelHandler());
            }
        });

        bootstrap.setOption("child.tcpNoDelay", true);
        bootstrap.setOption("child.keepAlive", true);
        bootstrap.setOption("reuseAddress", true);

        bootstrap.bind(new InetSocketAddress(5555));

        System.out.println("ChatServer started at last...");
    }
} 
```

处理程序：

```
public class ChatChannelHandler extends SimpleChannelUpstreamHandler {

    private final ChannelBuffer messageBuffer = ChannelBuffers.dynamicBuffer();
    private boolean processingMessage = false;
    private short messageLength;

    @Override
    public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) throws Exception {
        System.out.println("Connection from: " + e.getChannel().getRemoteAddress().toString());
    }

    @Override
    public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {
        e.getChannel().write(ChannelBuffers.copiedBuffer("NYA!", "UTF-8");
    }

    @Override
    public void exceptionCaught(ChannelHandlerContext ctx, ExceptionEvent e) {
        System.out.println("Exception: " + e.getCause());
        Channel ch = e.getChannel();
        ch.close();
    }
} 
```

我使用模拟程序创建 N 个连接，然后随机将内容写入服务器，暂停 1-5 秒。然后我连接我的基于 Flash 的客户端，看看它是如何工作的。所以问题是，在 10-90 个连接下，我的 flash 客户端立即从服务器获得响应，但是当模拟连接数超过 100 时，我的 flash 客户端保持沉默。我只是不明白为什么。
我发现，来自我的 100 多个客户端的所有消息都进入缓冲区，但 messageReceive 事件根本没有为它们触发。看起来事件队列达到了注册事件的某些限制，或者类似的东西。
我真的很难过，因为我读到更简单的服务器每秒处理 1k+ 请求。
如果有必要，我在 Windows 7 下工作。此外，我的服务器从不使用超过 2-3% 的 CPU。

我的模拟生成器：

```
public class ClientLoadEmulation implements Runnable {

    private String host;
    private int port;
    private static final int minStringLength = 5;
    private static final int maxStringLength = 40;
    private static final int minPause = (int) (1 * 1000);
    private static final int maxPause = (int) (5 * 1000);
    Random rand = new Random();

    public ClientLoadEmulation(String host, int port, int numThreads) {
        this.host = "192.168.0.100";
        this.port = 5555;
        for (int i = 0; i < numThreads; ++i) {
            new Thread(this).start();
            try {
                Thread.sleep(100);
            } catch (Exception ex) {
            }
        }
    }

    @Override
    public void run() {

        byte buffer[] = new byte[255];

        try {
            Socket s = new Socket(host, port);
            InputStream in = s.getInputStream();
            OutputStream out = s.getOutputStream();
            while (true) {
                String govno = "";
                ...STRING GENERATION STUFF CUTTED...
                ByteBuffer LENGTH_BUFFER = ByteBuffer.allocate(2);
                LENGTH_BUFFER.putShort((short) govno.length());
                LENGTH_BUFFER.flip();
                out.write(LENGTH_BUFFER.array());
                out.write(govno.getBytes("UTF-8"));
                //System.out.println(Thread.currentThread() + " wrote " + govno);

                int pause = minPause
                        + (int) (rand.nextDouble() * (maxPause - minPause));
                try {
                    Thread.sleep(pause);
                } catch (InterruptedException ie) {
                }
                }
        } catch (IOException ie) {
            System.out.println("ERROR: " + ie.getMessage());
        }
    }

    static public void main(String args[]) throws Exception {
        new ClientLoadEmulation("127.0.0.1", 5555, 100);
    }
} 
```

（对不起我的英语水平）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:28:46.843

我不确定您的示例，但是当我尝试运行您提供的 ChatServer 时，它不是在等待客户端连接，而是退出。

此外，我根本看不到端口 5555 设置（客户端期望的那个）。

请发布工作样本以进行检查。

# git - 恢复被 Git checkout 删除的文件

> ID：12059817
> 
> 赞同：6
> 
> 时间：2012-08-21T17:12:38.717
> 
> 标签：git

我不小心忘记了“git add”。我在使用“git checkout -b name”创建新分支之前创建的一堆文件，并且我所有未暂存的文件都已替换为头部的文件。

有没有办法检索这些文件？他们没有被藏起来，也没有被承诺。此外，我没有使用保留文件历史记录的 IDE。

我已经阅读了“git fsck --lost-found”，但在我尝试之前，有没有其他方法可以将未暂存的文件恢复到文件系统中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:16:57.070

不幸的是，没有办法（不是我发现的）。一旦我做了类似的事情，但我使用的是 Aptana Studio 并且可以恢复所有文件。

无论如何，一个好的做法是保持你的提交很小。当你这样做时，即使发生这样的事故，你也永远不会超过 30 分钟。

# php - 在 Wordpress 中显示来自特定标签的最新帖子

> ID：12059819
> 
> 赞同：0
> 
> 时间：2012-08-21T17:12:55.680
> 
> 标签：php, wordpress, tags, posts

我正在尝试更改我的 Wordpress 主题以显示来自特定标签的最新帖子。它目前总体上列出了最新的帖子。

这是它使用的部分代码：

```
<?php
    if ( is_home() ) {
        $args=array(
            'showposts'=> (int) get_option('aggregate_homepage_posts'),
            'paged'=>$paged,
            'category__not_in' => (array) get_option('aggregate_exlcats_recent')
        );
        if (get_option('aggregate_duplicate') == 'false') {
            global $ids;
            $args['post__not_in'] = $ids;
        }
        query_posts($args);
        global $paged;
    }
    $i = 0;
?>
<?php 
    if (have_posts()) : while (have_posts()) : the_post(); ?>
    <?php
        $i++;
        $et_is_latest_post = ( $paged == 0 && ( is_home() && $i <= 2 ) ) || !is_home();
    ?>
        <div class="post entry clearfix<?php if ( $et_is_latest_post ) echo ' latest'; ?>">
            <?php
                $thumb = '';
                $width = $et_is_latest_post ? 170 : 67;
                $height = $et_is_latest_post ? 110 : 67;
                $classtext = 'post-thumb';
                $titletext = get_the_title();
                $thumbnail = get_thumbnail($width,$height,$classtext,$titletext,$titletext,false,'Entry');
                $thumb = $thumbnail["thumb"];
            ?>

            <?php if($thumb <> '' && get_option('aggregate_thumbnails_index') == 'on') { ?>
                <div class="thumb thumbcont">
                    <a href="<?php the_permalink(); ?>">
                        <?php print_thumbnail($thumb, $thumbnail["use_timthumb"], $titletext, $width, $height, $classtext); ?>
                        <span class="overlay"></span>
                    </a>
<a class="thumb<?php $category = get_the_category(); echo $category[0]->category_nicename; ?>" href="<?php bloginfo('url'); ?>/<?php echo $category[0]->category_nicename; ?>"><?php echo $category[0]->cat_name; ?></a>
                </div>  <!-- end .post-thumbnail -->

            <?php } ?>

            <h3 class="title"><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
            <?php get_template_part('includes/postinfo'); ?>

            <p class="postsummery">
            <?php
              $excerpt = get_the_excerpt();
              echo string_limit_words($excerpt,20);
            ?>
            </p>

            <a href="<?php the_permalink(); ?>" class="more"><span><?php esc_html_e('Read More','Aggregate'); ?></span></a>
        </div>  <!-- end .post-->
<?php endwhile; ?>
    <?php if(function_exists('wp_pagenavi')) { wp_pagenavi(); }
    else { ?>
         <?php get_template_part('includes/navigation','entry'); ?>
    <?php } ?>
<?php else : ?>
    <?php get_template_part('includes/no-results','entry'); ?>
<?php endif; wp_reset_query(); ?> 
```

在做一些研究时，我发现了一些如何做到这一点的细节：http: [//codex.wordpress.org/Template_Tags/get_posts](http://codex.wordpress.org/Template_Tags/get_posts)

但是，我对 PHP 编码的了解非常有限，并且不了解我当前的代码如何与所提供的示例一起使用，我无法找到一种方法来做到这一点。你能指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:50:36.103

您只需在 array( 在第 3 行之后添加 'tag'=> 您想要列出的标签，为什么这是包含参数的数组，然后将传递给调用数据库的 get posts 函数，您需要的参数必须从中选择可以在这里找到[http://codex.wordpress.org/Class_Reference/WP_Query#Tag_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Tag_Parameters) 完整的代码看起来像这样

```
 <?php
    if ( is_home() ) {
        $args=array(
            'showposts'=> (int) get_option('aggregate_homepage_posts'),
            'paged'=>$paged,
            'tag'=>"the tag u want shown",
            'category__not_in' => (array) get_option('aggregate_exlcats_recent')
        );
        if (get_option('aggregate_duplicate') == 'false') {
            global $ids;
            $args['post__not_in'] = $ids;
        }
        query_posts($args);
        global $paged;
    }
    $i = 0;
?>
<?php 
    if (have_posts()) : while (have_posts()) : the_post(); ?>
    <?php
        $i++;
        $et_is_latest_post = ( $paged == 0 && ( is_home() && $i <= 2 ) ) || !is_home();
    ?>
        <div class="post entry clearfix<?php if ( $et_is_latest_post ) echo ' latest'; ?>">
            <?php
                $thumb = '';
                $width = $et_is_latest_post ? 170 : 67;
                $height = $et_is_latest_post ? 110 : 67;
                $classtext = 'post-thumb';
                $titletext = get_the_title();
                $thumbnail = get_thumbnail($width,$height,$classtext,$titletext,$titletext,false,'Entry');
                $thumb = $thumbnail["thumb"];
            ?>

            <?php if($thumb <> '' && get_option('aggregate_thumbnails_index') == 'on') { ?>
                <div class="thumb thumbcont">
                    <a href="<?php the_permalink(); ?>">
                        <?php print_thumbnail($thumb, $thumbnail["use_timthumb"], $titletext, $width, $height, $classtext); ?>
                        <span class="overlay"></span>
                    </a>
<a class="thumb<?php $category = get_the_category(); echo $category[0]->category_nicename; ?>" href="<?php bloginfo('url'); ?>/<?php echo $category[0]->category_nicename; ?>"><?php echo $category[0]->cat_name; ?></a>
                </div>  <!-- end .post-thumbnail -->

            <?php } ?>

            <h3 class="title"><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
            <?php get_template_part('includes/postinfo'); ?>

            <p class="postsummery">
            <?php
              $excerpt = get_the_excerpt();
              echo string_limit_words($excerpt,20);
            ?>
            </p>

            <a href="<?php the_permalink(); ?>" class="more"><span><?php esc_html_e('Read More','Aggregate'); ?></span></a>
        </div>  <!-- end .post-->
<?php endwhile; ?>
    <?php if(function_exists('wp_pagenavi')) { wp_pagenavi(); }
    else { ?>
         <?php get_template_part('includes/navigation','entry'); ?>
    <?php } ?>
<?php else : ?>
    <?php get_template_part('includes/no-results','entry'); ?>
<?php endif; wp_reset_query(); ?> 
```

# java - Apache HttpClient 3，多线程，每个请求都有不同的凭据

> ID：12059820
> 
> 赞同：1
> 
> 时间：2012-08-21T17:12:56.163
> 
> 标签：java, authentication, httpclient, connection-pooling

我正在使用带有**MultiThreadedHttpConnectionManager的****HttpClient 3**

 **如果我使用有效凭据连接到站点，然后使用无效凭据再次连接，则第二个连接会出人意料地工作。我假设这是因为连接管理器使用池连接并且不会重新验证已经过身份验证的主机。但是，如果我提供无效的凭据，我希望 HttpClient 失败，我该怎么做？

这是我使用方式的一部分`HttpClient`：

```
//run on each call
 HttpClient httpClient = new HttpClient(getMultiThreadedHttpConnectionManagerSingleton());

....
 httpClient.getState().setCredentials(
                authscope,
                new NTCredentials(
                        ntlmCredentials.getUsername(),//here i give wrong creds on the second attempt
                        ntlmCredentials.getPassword(),
                        localHostName, ntlmCredentials.getDomain())); 
```**

# c# - 通过类名调用静态函数作为c#中的字符串

> ID：12059821
> 
> 赞同：0
> 
> 时间：2012-08-21T17:12:56.320
> 
> 标签：c#, string, function, reflection, static

**我的问题**

我有一个我无法解决的问题。我不想使用这么多代码，因为我有多个扩展另一个类的类（在我的例子中它称为“数据”）。

我有一个日志文件，其中每个数据组都以特定的组名开头，例如“MitarbeiterSet”。抽象的 Data-Class 用于处理大量代码，其中我实现了诸如*“String[] data”*之类的变量（对于从日志文件中解析的数据，例如 < 101 4 3 6 3 30 80 2 0 0 1 300 >）或*"static String parseInduction"*，用于确定该类是否适合从中创建对象。

我有另一个名为 ParseMonitor 的类，它创建 StreamReader 来解析日志文件。所以如果找到了正确的类，我从正确的类中引入 setDataArray(StreamReader sr) 函数来解析数据数组。（此时我必须告诉你，我需要那些不同的类，因为我需要专门将它们上传到 sql 服务器。）

这个静态函数创建一个它自己的对象，并使用*parseLine(String line)*函数用给定行的数据填充对象。

**我需要的。**

我想调用任何类的静态函数，只要有这个类的名字。所以我不必使用那么多代码并且能够添加更多类。

稍后我想调用每个类并使用*uploadToServer()*将其上传到服务器。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:16:57.020

> 我想调用任何类的静态函数，只要有这个类的名字。

好吧，您可以使用[`Type.GetType(className)`](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)来获取 a `Type`（请注意，名称至少需要完全限定，包括命名空间，并且可能还需要程序集名称，具体取决于您的具体情况），然后[`Type.GetMethod`](http://msdn.microsoft.com/en-us/library/system.type.getmethod)获取`MethodInfo`. 最后，调用[`MethodBase.Invoke`](http://msdn.microsoft.com/en-us/library/1ttck9d7)调用该方法。

如果您可以使用`typeof(Foo)`而不是使用字符串，它将使代码更简单、更健壮。

（旁注：如果您的方法真的被称为`parseLine`,`parseInduction`等`setDataArray`，您应该考虑重命名它们以遵循 .NET 命名约定 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T18:04:39.030

由于您的静态方法无论如何都在创建其类的实例，因此我建议采用不同的方法：

创建一个所有包含的类都`ParseLine`可以实现的接口。（将返回类型更改为正确的类型）：

```
public interface IParseLine
{
    string ParseLine(string line);
} 
```

拥有所有包含`ParseLine()`implement的类`IParseLine`。

创建该类的一个实例，将其转换为`IParseLine`，然后执行该方法：

```
IParseLine pl = Activator.CreateInstance(Type.GetType(className)) as IParseLine;
if (pl != null)
{
    string parsedString = pl.ParseLine(line);
    // ...
} 
```

**从评论**编辑：****

 **> 我想创建一个while循环，可以这样表述：while{!sr.EndofStream){ line = sr.ReadLine(); for(int i = 0; i < classNames.length; i++){ if(line.Contains(classNames[i].MYINDICATOR){ 调用 classNames[i] 静态方法来解析以下行并创建其类的数据对象} }

我没有对此进行测试，但您可以将代码更改为类似这样（缓存 get 所需的反射`MYINDICATOR`）：

```
IList<KeyValuePair<string, Type>> typeIndicators = classNames.Select(x => {
    Type t = Type.GetType(x);
    string indicator = (string)t.GetField("MYINDICATOR", BindingFlags.Public | BindingFlags.Static).GetValue(null);
    return new KeyValuePair(indicator, t);
});

while (!sr.EndOfStream)
{
    line = sr.ReadLine();
    foreach (var types in typeIndicators)
    {
        if (line.Contains(types.Key))
        {
             IParseLine pl = Activator.CreateInstance(types.Value) as IParseLine;
             if (pl != null)
             {
                 string parsedString = pl.ParseLine(line);
             }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T10:29:49.433

我想我明白你来自哪里。在下面这个简单的例子中，我有一个带有方法的静态类（这没什么好奇怪的）。

```
public static class MyStaticClass
{
    public static DateTime GetTime()
    {
        return DateTime.Now;
    }
} 
```

如果我想使用反射调用该方法，我可以使用以下代码，但它确实假设**MyStaticClass**类可通过引用或在同一个项目等中使用。

```
MethodInfo method = typeof(MyStaticClass).GetMethod("GetTime");
object result = method.Invoke(null, null);

if (result is DateTime)
{
    Console.WriteLine(((DateTime)result).ToLongTimeString());
} 
```

当您没有对课程的参考时，您似乎要求的是一种这样做的方法。在这种情况下，请尝试以下操作：

```
MethodInfo method = Type.GetType("PocStaticReflect.MyStaticClass, PocStaticReflect, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null").GetMethod("GetTime");
object result = method.Invoke(null, null);

if (result is DateTime)
{
    Console.WriteLine(((DateTime)result).ToLongTimeString());
} 
```

注意完全限定的类名！

如果你得到这个工作，那么你可以简单地循环你的类名并调用你想要的方法。显然，您可能需要在*GetMethod()*调用中进行更多的错误检查和更多的细节，但是这个 shlud 会为您提供它的要点。在遍历文件夹中的程序集以获取应用程序的插件之前，我已经做了类似的事情。那个时候，每个类都实现了一个接口，使它们更容易定位，这可能是一个有用的路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T06:44:31.780

或者试试这个：

```
 private static object GetResultFromStaticMethodClass(string qualifiedClassName, string method)
 {
      Type StaticClass = Type.GetType(qualifiedClassName);
      MethodInfo methodInfo = StaticClass.GetMethod(method);
      object result = methodInfo.Invoke(null, null);
      return result;
 } 
```

采用：

```
object result = GetResultFromStaticMethodClass(
    "Utilities.StringHelper,DaProject",
    "ToList"
); 
```

**这将调用DaProject**项目（相同的程序集和项目名称）中的**Utilities**命名空间中的**StringHelper**类中的静态方法**ToList 。**

 ******如果需要参数，请在**methodInfo.Invoke(null, null)**调用的第二个参数中添加它们********

# android - 移动设备之间的实时 P2P 通信

> ID：12059822
> 
> 赞同：13
> 
> 时间：2012-08-21T17:12:57.133
> 
> 标签：android, real-time, p2p

我正在构建一个需要向其他设备发送实时信息的移动设备。我考虑过 XMPP，但我没有服务器，所以只能在设备之间进行通信。

有没有办法在没有服务器的移动设备之间使用 XMPP 进行通信（或将移动设备用作服务器）？

套接字是个好主意吗？即拥有一个服务器套接字和客户端套接字并以这种方式进行通信。

有没有更聪明的方法？我听说过 jWebSocket，但我真的不知道它是如何工作的，或者它是否值得。

**编辑**

过程如下：

1.  我使用 Parse 作为服务器/后端[http://parse.com](http://parse.com)
2.  当用户运行应用程序时，从解析服务器检索用户列表
3.  然后，用户拥有（可能拥有）其他客户端的 ip，然后尝试与它们通信。

问题
1\. Parse 不支持 XMPP 服务器或其他类型的服务器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T00:05:52.963

[您可能会考虑使用像http://jerklib.wikia.com/wiki/JerkLib_Wiki](http://jerklib.wikia.com/wiki/JerkLib_Wiki)这样的 IRC 客户端库。这样您就可以使用公共 IRC 服务器与您的其他设备进行通信...

我没有使用它，但我确实将它添加为书签以供进一步阅读，因为我认为它是一个新颖的概念......

我希望它有帮助...

# c# - 多线程 - 5 或 100 个线程？

> ID：12059825
> 
> 赞同：1
> 
> 时间：2012-08-21T17:13:02.513
> 
> 标签：c#, multithreading, thread-safety

我有一个**双核**处理器，现在假设我想制作一个垃圾邮件机器人程序，它会发送诸如“嘿，你好吗？”之类的垃圾邮件。

我的问题是，多少线程能够最快地弹出这些消息，运行 5 个线程或 100 个线程来阻止消息？（当然，这些数字并不特殊，仅作为示例）。所有线程都将以线程安全的方式运行。

**编辑：**至于之前的反对票，我并不是真的在写垃圾邮件程序，我只是提到它作为我的问题的一个例子，很抱歉造成误解

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T17:16:48.223

理想的线程数取决于您的硬件（在本例中为双核处理器），以及这些线程在做什么。如果它们是 CPU 密集型的，每个核心超过 1 个线程可能会减慢速度。

如果线程执行一些 IO，您将看到通过添加线程来整体提高性能。收益递减点完全取决于非 CPU 任务的性质和特定硬件。

要找到这一点，您必须测试各种线程总数。

您可以设计您的系统以自我调整正在使用的线程数。我曾经设计过一个在总 CPU 负载约为 70% 时运行最好（总吞吐量最高）的系统。为了优化该值，我添加了线程（线程之间有延迟），直到 CPU 达到 70%，+/- 5%。如果它超过 80%，我会通知一个或多个线程来完成它们当前的工作并终止。如果低于 60%，我会逐渐添加线程。像魅力一样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:19:04.770

故意创建比处理器更多的线程是一种标准技术，用于利用“空闲周期”，其中线程被阻塞等待某些东西，无论是 I/O、互斥体还是其他东西，通过为处理器提供一些其他有用的工作来完成做。

如果您的线程正在执行 I/O，那么这是加速的有力竞争者：当每个线程阻塞等待 I/O 时，处理器可以运行其他线程，直到它们也阻塞 I/O，希望这样第一个线程的数据准备就绪的时间，依此类推。

资料来源：[安东尼威廉姆斯](https://stackoverflow.com/questions/5987376/why-is-having-more-threads-than-cores-faster)

# ios - 从 JSON 日期填充 UITableView 单元格

> ID：12059830
> 
> 赞同：0
> 
> 时间：2012-08-21T17:13:26.753
> 
> 标签：ios, uitableview, nsarray, nsdictionary, nsjsonserialization

我很难用 json 提要日期字段填充 tableview 单元格。我认为这与我获取日期的方式有关

```
NSMutableArray *datesArray = [[NSMutableArray alloc] init];

    for (NSDictionary *tempDict in json){
        [datesArray addObject:[tempDict objectForKey:@"date"]];
    } 
```

如果可以，请提供帮助。我已经经历了我能想到的一切（仍在学习）。

.h 文件

```
#import <UIKit/UIKit.h>

@interface AvailabilityViewController : UIViewController <UITextFieldDelegate, UITableViewDelegate, UITableViewDataSource>
{

    NSDate *appointmentdate;
    UIActionSheet *dateSheet;
    UITextField *mydatetextfield;
    UILabel *pastDateLabel;
    NSArray *json;

}
//-(IBAction)getDataFromJson:(id)sender;

@property (strong, nonatomic) IBOutlet UITextField *mydatetextfield;
@property (nonatomic, retain) NSDate *appointmentdate;
@property (strong, nonatomic) IBOutlet UILabel *pastDateLabel;
@property (strong, nonatomic) IBOutlet UITableView *_tableView;
@property (nonatomic, retain) NSArray *json;
//-(void)setDate;
-(void)dismissDateSet;
-(void)cancelDateSet;

@end 
```

.m 文件

```
- (void)fetchedData:(NSData *)responseData {
    //parse out the json data

    NSError* error;
    //NSLog(@"string is %@", responseData);

    self.json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];

    NSLog(@"string is %@", responseData);
    if ([json isKindOfClass:[NSArray class]]) {
        NSLog(@"its an array");
    } else if ([json isKindOfClass:[NSDictionary class]]) {
        NSLog(@"its a dictionary");
    }  else if ([json isKindOfClass:[NSString class]]) {
        NSLog(@"its a string");
    }  else if ([json isKindOfClass:[NSNumber class]]) {
        NSLog(@"its a number");
    }  else if ([json isKindOfClass:[NSNull class]]) {
        NSLog(@"its a null");
    } else if (json == nil){
        NSLog(@"nil");
    }
    //NSArray* latestLoans = [json objectForKey:@"date"]; //2
    NSMutableArray *datesArray = [[NSMutableArray alloc] init];

    for (NSDictionary *tempDict in json){
        [datesArray addObject:[tempDict objectForKey:@"date"]];
    }

    NSLog(@"this is your datesArray %@", datesArray);
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return self.json.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
     cell.textLabel.text = [[self.json objectAtIndex:indexPath.row] objectForKey:@"date"];

    return cell;
    //[_tableView reloadData];
} 
```

这是我的 datesArray 的 NSLog

```
2012-08-21 10:09:39.303 GBSB[1409:15b03] this is your datesArray (
    "2012-08-13 12:00:00",
    "2012-08-13 10:00:00",
    "2012-08-13 13:00:00" 
```

这是 viewDidLoad 的样子

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL: 
                        kLatestKivaLoansURL];
        [self performSelectorOnMainThread:@selector(fetchedData:) 
                               withObject:data waitUntilDone:YES];

    });

}
- (void)fetchedData:(NSData *)responseData {
    //parse out the json data

    NSError* error;
    //NSLog(@"string is %@", responseData);

    self.json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];

    NSLog(@"string is %@", responseData);
    if ([json isKindOfClass:[NSArray class]]) {
        NSLog(@"its an array");
    } else if ([json isKindOfClass:[NSDictionary class]]) {
        NSLog(@"its a dictionary");
    }  else if ([json isKindOfClass:[NSString class]]) {
        NSLog(@"its a string");
    }  else if ([json isKindOfClass:[NSNumber class]]) {
        NSLog(@"its a number");
    }  else if ([json isKindOfClass:[NSNull class]]) {
        NSLog(@"its a null");
    } else if (json == nil){
        NSLog(@"nil");
    }
    //NSArray* latestLoans = [json objectForKey:@"date"]; //2
    NSMutableArray *datesArray = [[NSMutableArray alloc] init];

    for (NSDictionary *tempDict in json){
        [datesArray addObject:[tempDict objectForKey:@"date"]];
    }

    NSLog(@"this is your datesArray %@", datesArray);
    NSLog(@"this is the json %@", self.json);

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:35:16.523

您正在 fetchedData 方法中创建一个名为 json 的局部变量，并将解析后的响应放在那里。但是，因为这是一个局部变量，所以一旦您退出该方法，它就不再存在。

相反，您应该将解析后的响应数据放入您`json`在 .h 文件中声明的 viewController 的 @property 中。为此，请对您的`fetchedData:`方法进行以下更改：

```
self.json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error]; 
```

然后在你的`cellForRowAtIndexPath:`你可以像这样提取数据：

```
cell.textLabel.text = [[self.json objectAtIndex:indexPath.row] objectForKey:@"date"] 
```

你`numberOfRowsInSection:`也应该返回：

```
return self.json.count; 
```

编辑：

有关局部变量与 ivars 与属性的更多解释......

当您在 .h 文件中的视图控制器的 @interface 中声明此内容时：

```
NSArray *json; 
```

您正在为您的类创建实例变量 (ivar)。每当您的类的实例被实例化时，它都会有一个名为的成员变量`json`，您可以在类的方法中访问它。

当您声明这样的属性时：

```
@property (nonatomic, retain) NSArray *json; 
```

以及实现文件中的匹配@synthesize：

```
@synthesize json; 
```

编译器会自动为您生成一个 setter 和 getter 方法，因此您可以使用这些方法：

```
NSArray *theArray = [self json]; // getter
[self setJson:newArray];         // setter 
```

你可以在现代 Objective-C 中使用点符号来做同样的事情：

```
NSArray *theArray = self.json; // getter
self.json = newArray;          // setter 
```

您的属性最终由 ivar 支持，默认情况下，该 ivar 的名称与属性相同，如果它不存在，它将为您自动生成。（您还可以在 @synthesize 语句中指定支持 ivar 的名称，并且您会经常看到人们使用以下划线开头的 ivar 名称以帮助保持 ivar 名称和属性名称是什么，但我此处不再赘述）

您的对象的属性可以从其他类访问，而您的对象的 ivars 不能。

但回到你的问题。除了您的 ivar 和属性之外，您还创建了一个局部变量，也在`json`您的`fetchedData:`方法中命名。这个变量，因为你在方法体中声明了它，它只会在方法完成之前存在，届时它将被释放，如果不保留在其他地方，包含的数据将丢失。因为你给你的局部变量赋予了与你的 ivar 相同的名字，所以局部变量有效地隐藏了 ivar。

Apple 不建议直接使用 ivars，而是通过您的类属性（getter 和 setter 方法）进行所有访问。这就是为什么我建议使用`self.json`. 它还应该解决您的问题，因为保存到您的属性的值将在方法执行之后持续存在。

希望对一些人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:29:10.470

看起来“json”是一个 NSDictionary 的数组。

你不能这样做：

```
cell.textLabel.text = [json objectAtIndex:indexPath.row]; 
```

（即为 UILabel 的文本字段分配一个 NSDictionary）

但您可以执行以下操作：

```
cell.textLabel.text = [[json objectAtIndex:indexPath.row] objectForKey:@"date"]; 
```

# jquery - Richfaces 4.x 和 Jquery 最新冲突

> ID：12059831
> 
> 赞同：0
> 
> 时间：2012-08-21T17:13:29.780
> 
> 标签：jquery, jsf, richfaces

我有一组使用最新 jquery 库的 html 文件，我将这些文件转换为 xhtmls 并使用丰富的面孔来实现 ajax 功能。但似乎richfaces jquery 与我最新的jquery 发生冲突。怎么分离出来？我无法通过编写 Jquery.noconfilct() 来转换我的 Jquery 代码，因为它非常庞大。我想让页面将richfaces jquery 与实际的jquery 库分开处理。

# time - 如何从命令行将时钟小部件更改为 24 小时制

> ID：12059832
> 
> 赞同：0
> 
> 时间：2012-08-21T17:13:48.483
> 
> 标签：time, widget, config, clock, gnome

我们需要默认的 Gnome 时钟小部件以 24 小时格式显示时间，但需要完全从命令行完成（通过脚本，无 GUI）。

有人知道怎么做吗？某处有配置文件吗？

谢谢

编辑：应该说这是针对 rhel5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T12:37:51.523

我没有可用的 RHEL5 甚至 GNOME 2 系统来测试它，但是这个（或类似的东西）应该可以工作：

```
gconftool-2 -s -t string /apps/clock_applet/prefs/format 24-hour 
```

# ios - 如何观察 UIPopoverController 何时被解雇？

> ID：12059834
> 
> 赞同：2
> 
> 时间：2012-08-21T17:13:52.073
> 
> 标签：ios, uisplitviewcontroller, uipopovercontroller

`UISplitViewController`有委托方法：

```
-(void)splitViewController:(UISplitViewController *)svc popoverController:(UIPopoverController *)pc willPresentViewController:(UIViewController *)aViewController 
```

我希望从类似但不存在的委托方法中获取功能：

```
-(void)splitViewController:(UISplitViewController *)svc popoverController:(UIPopoverController *)pc willDismissViewController:(UIViewController *)aViewController 
```

`UISplitViewController`考虑到//通常考虑到这样做的最佳方法的想法不符合 KVO `UIPopoverController`，`UIKit`因此我无法向`UIPopoverController`' 的`isPopoverVisible`属性添加观察者。

谢谢

## 回答：

```
//Sent when switching to portrait
- (void)splitViewController:(UISplitViewController*)svc willHideViewController:(UIViewController *)aViewController withBarButtonItem:(UIBarButtonItem*)barButtonItem forPopoverController:(UIPopoverController*)pc
{  
    ...

    self.popoverController = pc;
    [self.popoverController setDelegate:self];
}

-(void)splitViewController:(UISplitViewController *)svc popoverController:(UIPopoverController *)pc willPresentViewController:(UIViewController *)aViewController
{
    NSLog(@"SHOWING POPOVER");
}

- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController
{
    NSLog(@"HIDING POPOVER");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:35:24.950

想通了，`UIPopoverController`除了`UISplitViewControllerDelegate`：

```
//Sent when switching to portrait
- (void)splitViewController:(UISplitViewController*)svc willHideViewController:(UIViewController *)aViewController withBarButtonItem:(UIBarButtonItem*)barButtonItem forPopoverController:(UIPopoverController*)pc
{  
    ...

    self.popoverController = pc;
    [self.popoverController setDelegate:self];
}

-(void)splitViewController:(UISplitViewController *)svc popoverController:(UIPopoverController *)pc willPresentViewController:(UIViewController *)aViewController
{
    NSLog(@"SHOWING POPOVER");
}

- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController
{
    NSLog(@"HIDING POPOVER");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:17:37.017

当你收到第一个委托通知时，你会收到一个对 UIPopoverController 的引用，它将显示隐藏的视图控制器。注册为其委托，然后使用[`-popoverControllerDidDismissPopover:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverControllerDelegate_protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIPopoverControllerDelegate/popoverControllerDidDismissPopover%3a)UIPopoverControllerDelegate 协议中的委托方法。

# android - Android从相机方向获取照片会使应用程序崩溃

> ID：12059835
> 
> 赞同：0
> 
> 时间：2012-08-21T17:13:52.037
> 
> 标签：android, android-intent, android-camera, android-camera-intent

我正在制作一个应用程序，它从相机意图中拍摄照片并将其放置到活动中，我遵循了谷歌开发人员的示例。

问题是当我启动相机意图时，如果我更改相机方向，有一次我保存照片时它会返回“无法恢复活动”或“无法启动活动组件信息”

我遵循了android开发人员的相机示例，但它只显示了如何防止丢失图像一次放置在活动中并更改方向。

我尝试添加以下内容，但没有成功

```
@Override
protected void onSaveInstanceState(Bundle outState){
  outState.putParcelable(URI_SAVED, selectedImageUri);
  super.onSaveInstanceState(outState);
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState){
  super.onRestoreInstanceState(savedInstanceState);
  Uri new_uri = savedInstanceState.getParcelable(URI_SAVED);
  selectedImagePath = getPath(new_uri).toString();
  Img.setImageURI(new_uri);
} 
```

你知道我在哪里可以找到一个很好的工作例子吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:21:32.620

该问题可以通过使用 getOptimalPreviewSize() 函数和 surfaceChanged() 来解决

# python - 如何从 python 获取（解析）XML 中的子子项

> ID：12059852
> 
> 赞同：1
> 
> 时间：2012-08-21T17:14:54.890
> 
> 标签：python, xml, parsing

我是 python 或编码新手，所以请耐心等待我的问题，

所以这是我忙碌的 XML

```
 <?xml version="1.0" encoding="utf-8"?>
<Total>
    <ID>999</ID>
    <Response>
        <Detail>
        <Nix>
            <Check>pass</Check>
        </Nix>  
        <MaxSegment>
            <Status>V</Status>
            <Input>
                <Name>
                    <First>jack</First>
                    <Last>smiths</Last>
                </Name>
                <Address>
                <StreetAddress1>100 rodeo dr</StreetAddress1>
                <City>long beach</City>
                <State>ca</State>
                <ZipCode>90802</ZipCode>
                </Address>
                <DriverLicense>
                    <Number>123456789</Number>
                    <State>ca</State>
                </DriverLicense>
                <Contact>
                <Email>x@me.com</Email>
                <Phones>
                    <Home>0000000000</Home>
                    <Work>1111111111</Work>
                </Phones>
                </Contact>
            </Input>
            <Type>Regular</Type>
        </MaxSegment>
        </Detail>
    </Response>
</Total> 
```

我想要做的是将这些值提取到下面漂亮干净的表格中：
![在此处输入图像描述](../Images/7ffbdc6a96cb566117772d7410fe8309.png)

到目前为止，这是我的代码..但我无法弄清楚如何获取子子项：

```
 import os
os.chdir('d:/py/xml/')

import xml.etree.ElementTree as ET
tree = ET.parse('xxml.xml')
root=tree.getroot()
x = root.tag
y = root.attrib
print(x,y)

#---PRINT ALL NODES---
for child in root:
    print(child.tag, child.attrib) 
```

先感谢您 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:42:58.337

您可以创建一个字典，将列名映射到提取相应值的 xpath 表达式，例如：

```
xpath = {
  "ID": "/Total/ID/text()",
  "Check": "/Total/Response/Detail/Nix/Check/text()", # or "//Check/text()"
} 
```

要填充表格行：

```
row = {name: tree.xpath(path) for name, path in xpath.items()} 
```

以上假设您使用[`lxml`](http://lxml.de/xpathxslt.html)支持完整的 xpath 语法。[ElementTree 仅支持 XPath 表达式的子集，](http://docs.python.org/library/xml.etree.elementtree.html)但在您的情况下可能就足够了（您可以删除“text()”表达式并`el.text`在这种情况下使用），例如：

```
xpath = {
  "ID": ".//ID",
  "Check": ".//Check",
}
row = {name: tree.findtext(path) for name, path in xpath.items()} 
```

要打印具有相应标签名称的所有文本：

```
import xml.etree.cElementTree as etree

for _, el in etree.iterparse("xxm.xml"):
    if el.text and not el: # leaf element with text
       print el.tag, el.text 
```

如果列名与标签名不同（如您的情况），那么最后一个示例不足以构建表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T18:02:05.570

这就是您可以遍历树并仅打印文本节点的方式：

```
def traverse(node):
    show = True
    for c in node.getchildren():
        show = False
        traverse(c)
    if show:
        print node.tag, node.text 
```

以你为例，我得到以下信息：

```
traverse(root)

ID 999
Check pass
Status V
First jack
Last smiths
StreetAddress1 100 rodeo dr
City long beach
State ca
ZipCode 90802
Number 123456789
State ca
Email x@me.com
Home 0000000000
Work 1111111111
Type Regular 
```

`(node.tag, node.text)`您可以存储元组或存储`{node.tag: node.text}`在字典中，而不是打印出来。

# c++-cli - 命令行界面。如何转换 std::vector 到 System.String^?

> ID：12059858
> 
> 赞同：1
> 
> 时间：2012-08-21T17:15:36.627
> 
> 标签：c++-cli, marshalling, std

我需要使用 CLIWrapper 公开一些非托管数据。

假设我有一个向量，但向量中间没有空字符（当然）。进行这种类型的分配/编组的最佳方法是什么？

以防万一……如果我从向量分配给cli::array，同样的操作会是什么样子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:27:25.540

您可以直接使用 String 类的构造函数。像这样：

```
#include "stdafx.h"
#include <vector>

using namespace System;

int main(array<System::String ^> ^args)
{
    std::vector<wchar_t> example;
    example.push_back('x');
    String^ str = gcnew String(&example[0], 0, example.size());
    Console::WriteLine(str);
    return 0;
} 
```

# wpf - 网格的可见性

> ID：12059859
> 
> 赞同：1
> 
> 时间：2012-08-21T17:15:50.153
> 
> 标签：wpf

我正在尝试在 WPF 中使用网格来模拟记分牌。但是在运行应用程序时它似乎不可见。

有什么建议么？

提前致谢。

这是网格 (XAML) 声明的顶部：

```
<Grid Height="170" HorizontalAlignment="Left" Margin="187,12,0,0" Name="grid1"
      VerticalAlignment="Top" Width="454" Opacity="100" OpacityMask="Black"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T21:00:04.703

布局元素本身通常不具有可见性。您需要将内容放在布局元素中才能有可见的项目。

# php - 为什么这个 DataTables Ajax 调用不能正常工作？

> ID：12059862
> 
> 赞同：0
> 
> 时间：2012-08-21T17:16:27.877
> 
> 标签：php, jquery, datatables

我正在尝试让 dataTables 插件处理网站的信息。我已经阅读了数据表的[文档](http://datatables.net/release-datatables/examples/data_sources/server_side.html)和[各种](http://datatables.net/forums/discussion/7949/getting-cannot-read-property-length-of-undefined-in-chrome-error/p1) [支持](http://datatables.net/forums/discussion/6101/cannot-read-property-length-of-undefined-with-ajax-source/p1)线程以及[各种](https://stackoverflow.com/questions/7629423/using-ajax-to-load-a-jquery-datatable) [StackOverflow](https://stackoverflow.com/questions/9566899/jquery-data-tables-server-side-processing-not-working-as-expected) [问题](https://stackoverflow.com/questions/7440184/jquery-datatables-and-initial-data-load)，但无济于事。根据上述文档，我拥有的代码应该可以正常工作......它没有。

Javascript：

```
$(document).ready( function(){
 $('#results_table').dataTable( {
  'bServerSide': true,
  'sAjaxSource': 'results.php',
  'fnServerParams': function ( aoData ) {
    aoData.push( { 't': Math.random() }); 
    }
   });
}); 
```

HTML 代码：

```
<div id='results'>
  <table id='results_table' >
   <thead>
    <tr>
    <th>Num</th>
    <th>Type</th>
    <th>Access date</th>
    <th>Access name</th>
   </tr>
  </thead>
 <tbody>
</div> 
```

PHP 片段（在检索/格式化 SQL 数据后：

```
$output = array('sEcho'=>1,'iTotalRecords'=>$count, 'iTotalDisplayRecords'=>$count, 'aaData'=> $results);
echo json_encode($output); 
```

返回的数据（测试总数的一小部分）：

```
{"sEcho":1,"iTotalRecords":3,"iTotalDisplayRecords":3,"aaData":[["1707052901-1A","D","Aug 17, 2012 1:54 PM","aqr"],["1707052901-1A","C","Aug 17, 2012 1:53 PM","aqr"],["2835602-4A","D","Aug 15, 2012 7:39 AM","aqr"]]} 
```

现在，当我用数据表加载页面时，我收到了一个*非常*有用的答案——

> 未捕获的类型错误：无法读取未定义 jquery.dataTables.min.js:49 的属性“长度”

并且该表没有填充信息。

**问题：**我做错了什么；为什么我对数据表的服务器端处理的实现不起作用？如何解决此问题以正确显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:45:50.700

```
aoData.push( { 't': Math.random() }); 
```

应该这样使用：

```
aoData.push( { 'name': 't', 'value':Math.random() }); 
```

不确定这是否是问题，但这解决了我在使用数据表时的一些问题

# sql-server - 联合两个表并计算列合并

> ID：12059863
> 
> 赞同：1
> 
> 时间：2012-08-21T17:16:31.450
> 
> 标签：sql-server, union

我不知道我对这个问题的措辞是否有问题，但这就是问题所在。我必须像您在下面看到的那样使用表格。我需要联合这两个表，但在此过程中将 Set1Count 除以 Set2Count。请帮忙。

* * *

（注意：我意识到可能还有另一种方法。这里是详细信息。两个表具有完全相同的记录数 - 它们只是基于两个不同的关系构建的。结果集必须具有与原件（不是合并，而是单独）。Set1Count 必须除以 Set2Count）

* * *

```
DECLARE @Set1 TABLE
    (
        Set1Count Int,
        Name varchar(50),
        [Month] Int,
        [Year] Int
    )

DECLARE @Set2 TABLE
    (
        Set2Count Int,
        Name varchar(50),
        [Month] Int,
        [Year] Int
    )

SELECT * FROM @Set1
UNION 
SELECT * FROM @Set2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:26:13.433

我猜这应该这样做：

```
DECLARE @Set1 TABLE
    (
        Set1Count Int,
        Name varchar(50),
        [Month] Int,
        [Year] Int
    )

DECLARE @Set2 TABLE
    (
        Set2Count Int,
        Name varchar(50),
        [Month] Int,
        [Year] Int
    )

SELECT S1.[Name], S1.[Month], S1.Year, Set1Count/NULLIF(Set2Count,0) Div
FROM @Set1 S1
INNER JOIN @Set2 S2
ON S1.[Name] = S2.[Name] AND S1.[Month] = S2.[Month]
AND S1.[Year] = S2.[Year] 
```

请注意，如果两个表上有相同的记录，这将正常工作，因为我使用的是`INNER JOIN`. 如果不是这种情况，那么您可能应该使用`FULL JOIN`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:21:32.980

将您的第一个选择更改为包含第二列，`null as set2Count`并将您的第二个选择更改为在第一个位置包含另一列，`null as set1Count`. 不过，在划分值之前，您需要决定如何加入集合。他们是按年和月加入的吗？或者，也许您根本不需要联合查询，而是加入它们然后分开？

# java - 如何可靠有效地从 Java 服务器中的 Apple Push Notifications Server 读取所有错误响应？

> ID：12059865
> 
> 赞同：1
> 
> 时间：2012-08-21T17:16:37.443
> 
> 标签：java, sockets, push-notification, apple-push-notifications

我正在研究 Java 中 Apple 推送通知的服务器端开发。我正在使用增强格式，以检测失败的消息并重新发送错误消息之后的消息。我知道 Apple 不保证推送通知的传递，但我希望能够知道 Apple 是否收到我的消息以及是否包含任何错误。

我注意到，当我尝试向 Apple 发送无效消息（无效的设备令牌、过大的有效负载等）时，我可以在套接字关闭之前再发送几条消息。当套接字关闭时，从Apple读取错误代码为时已晚，所以我不知道哪条消息是错误的（或者即使有错误消息，因为Apple表示即使没有连接也可能偶尔关闭错误）。

我在 JavaPN 的源代码中看到的处理此问题的方法是在发送每条消息（或一组消息）后立即读取来自 Apple 的响应。从套接字读取是否频繁执行，并等待超时以防没有可读取的内容。如果您不经常发送推送通知，这是可以接受的。

如果您尝试以高频率发送大量通知（比如说每秒数百条），您无法在每条消息后停下来等待 Apple 的响应（即使您只等待 20 毫秒的响应，那也会将您限制为每秒 50 条消息，并且您无法知道 Apple 编写错误响应需要多长时间，因此短暂的等待可能还不够）。如果您在每条消息后不停地阅读可能出现的错误，则在向 Apple 发送消息期间您的连接可能会被关闭，在这种情况下，您将无法获得导致连接关闭的消息的 Id .

我正在考虑的另一种方法是在单独的线程中执行读取和写入。这样，我就有更好的机会从 Apple 获取错误消息（在连接关闭之前），而不会影响我向 Apple 发送消息的速度。这种方法在编程上更加复杂，并且由于我的服务器预计将 APNs 发送到多个 iOS 应用程序，每个应用程序都需要自己的套接字和读取器/写入器线程，这将使我需要的线程数增加两倍。

APN 服务器的上述所有行为都是在尝试向 Apple 的沙盒服务器发送推送通知时学习的。我不确定 Apple 生产服务器的行为是否更好，我不确定在生产服务器上执行测试是否是个好主意。

我的问题 - 有没有办法在 Alpha 关闭连接之前可靠地读取错误响应，而不会牺牲性能？是否有可能在服务器关闭套接字后以某种方式从套接字读取输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T02:58:18.997

我遇到了和你一样的问题。而且我尝试了两种方法，但它们都不能在关闭连接之前可靠地读取 Apple 的错误响应：

1.  对于每个套接字，我启动了两个线程，一个用于连续写入，另一个用于阻塞读取。在大多数情况下，当写遇到“Socket Broken”异常时，读线程可以读到错误响应，但并不完全可靠。
2.  对于每个socket，我只启动了一个线程连续写入，遇到异常时，在try缓存块中，尝试读取错误响应。在大多数情况下，套接字是关闭的，所以我只看到一个异常。

# oracle - 如何使用 iBatis 从数据库中选择 BLOB 列

> ID：12059872
> 
> 赞同：4
> 
> 时间：2012-08-21T17:17:03.383
> 
> 标签：oracle, mapping, blob, ibatis

表的列之一是 BLOB 数据类型（Oracle 10g）。我们通过 iBatis 执行了一个简单的选择查询来选择 BLOB 列并使用 Struts2 和 JSP 显示它。

iBatis xml 文件中的结果标记的 jdbctype 为 java.sql.Blob

```
<result property="uploadContent" column="uploadcontent" jdbctype="Blob"/> 
```

我们应该提到 Blob 列的任何 typeHandler 类吗？**目前我们收到一个错误，说明列类型不匹配。**

注意：选择此列并将其映射到具有 java.sql.Blob 类型的属性的 java bean

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T21:26:33.460

我认为你不能在 Oracle 中使用 native 类型`jdbctype`和. 解决方案是创建自定义处理，然后映射它像 -`LOB``iBatis``typeHandler``LOB`

```
<result property="aClassStringProperty" column="aClobColumn" typeHandler="com.path.to.my.ClobTypeHandler"/> 
```

更多信息在`typeHandlerCallback` [这里](http://ibatis.apache.org/docs/java/user/com/ibatis/sqlmap/client/extensions/TypeHandlerCallback.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T11:58:56.860

不需要创建 typeHandler。对于**Oracle**， jdbctype 是**BLOB**

```
<result property="bytes" column="COLUMNBLOB"  jdbcType="BLOB" /> 
```

假设“字节”为字节 []。

重要的是：在select sql中，你必须这样设置jdbcType：

```
INSERT INTO X (COLUMNBLOB) VALUES #bytes:BLOB# 
```

我注意到**Postgresql**的这个 jdbctype是不同的。您必须设置：

```
<result property="bytes" column="COLUMNBLOB"  jdbcType="BINARY" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T16:52:20.680

[我在这里](http://www.coderanch.com/t/216835/ORM/databases/Blob-Clob-iBatis)找到了处理这个的人。

对于**CLOB**：

```
<result property="uploadContent" column="obfile" jdbctype="String" /> 
```

对于**BLOB**：

```
<result property="uploadContent" column="obfile" jdbctype="byte[]" /> 
```

**我仍在寻找它与 C# 一起使用！**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-29T19:32:41.380

我在使用 INSERT 时没有问题，我在选择 blob 类型时遇到的问题。我正在使用 Oracle 9i，这就是我所做的：

1.  将 Oracle JDBC 驱动程序添加到您的项目中，您也需要`mybatis`依赖项。如果您使用的是 Maven：

    ```
    <dependency>
        <groupId>com.oracle</groupId>
        <artifactId>ojdbc14</artifactId>
        <version>10.2.0.3.0</version>
    </dependency>
    <dependency>
        <groupId>org.mybatis</groupId>
        <artifactId>mybatis-spring</artifactId>
        <version>1.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.mybatis</groupId>
        <artifactId>mybatis</artifactId>
        <version>3.2.3</version>
    </dependency> 
    ```

2.  添加自定义 BaseTypeHandler 以从 Oracle BLOB类[中读取 byte[] ：](http://www.mybatis.org/mybatis-3/configuration.html#typeHandlers)

    ```
    @MappedTypes(byte[].class)
    public class OracleBlobTypeHandler extends BaseTypeHandler<byte[]> {
        @Override
        public void setNonNullParameter(PreparedStatement preparedStatement, int i, byte[] bytes, JdbcType jdbcType) throws SQLException {
            // see setBlobAsBytes method from https://jira.spring.io/secure/attachment/11851/OracleLobHandler.java
            try {
                if (bytes != null) {
                    //prepareLob
                    BLOB blob = BLOB.createTemporary(preparedStatement.getConnection(), true, BLOB.DURATION_SESSION);

                    //callback.populateLob
                    OutputStream os = blob.getBinaryOutputStream();
                    try {
                        os.write(bytes);
                    } catch (Exception e) {
                        throw new SQLException(e);
                    } finally {
                        try {
                            os.close();
                        } catch (Exception e) {
                            e.printStackTrace();//ignore
                        }
                    }
                    preparedStatement.setBlob(i, blob);
                } else {
                    preparedStatement.setBlob(i, (Blob) null);
                }
            } catch (Exception e) {
                throw new SQLException(e);
            }
        }

        /** see getBlobAsBytes method from https://jira.spring.io/secure/attachment/11851/OracleLobHandler.java */
        private byte[] getBlobAsBytes(BLOB blob) throws SQLException {

            //initializeResourcesBeforeRead
            if(!blob.isTemporary()) {
                blob.open(BLOB.MODE_READONLY);
            }

            //read
            byte[] bytes = blob.getBytes(1L, (int)blob.length());

            //releaseResourcesAfterRead
            if(blob.isTemporary()) {
                blob.freeTemporary();
            } else if(blob.isOpen()) {
                blob.close();
            }

            return bytes;
        }

        @Override
        public byte[] getNullableResult(ResultSet resultSet, String columnName) throws SQLException {
            try {
                //use a custom oracle.sql.BLOB
                BLOB blob = (BLOB) resultSet.getBlob(columnName);
                return getBlobAsBytes(blob);
            } catch (Exception e) {
                throw new SQLException(e);
            }
        }

        @Override
        public byte[] getNullableResult(ResultSet resultSet, int i) throws SQLException {
            try {
                //use a custom oracle.sql.BLOB
                BLOB blob = (BLOB) resultSet.getBlob(i);
                return getBlobAsBytes(blob);
            } catch (Exception e) {
                throw new SQLException(e);
            }
        }

        @Override
        public byte[] getNullableResult(CallableStatement callableStatement, int i) throws SQLException {
            try {
                //use a custom oracle.sql.BLOB
                BLOB blob = (BLOB) callableStatement.getBlob(i);
                return getBlobAsBytes(blob);
            } catch (Exception e) {
                throw new SQLException(e);
            }
        }
    } 
    ```

3.  将 type handlers 包添加到 mybatis 配置中。如您所见，我使用的是spring-mybatis：

    ```
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="typeHandlersPackage" value="package.where.customhandler.is" />
    </bean> 
    ```

4.  然后，*您可以从 Mybatis 的 Oracle BLOB 中读取 byte[]*：

    ```
    public class Bean {
        private byte[] file;
    }

    interface class Dao {
        @Select("select file from some_table where id=#{id}")
        Bean getBean(@Param("id") String id);
    } 
    ```

我希望这将有所帮助。这是对这个优秀答案的改编：这是对这个优秀答案的改编：[https](https://stackoverflow.com/a/27522590/2692914) ://stackoverflow.com/a/27522590/2692914 。

# php - 需要 XML 解析器错误开始标记

> ID：12059873
> 
> 赞同：4
> 
> 时间：2012-08-21T17:17:07.597
> 
> 标签：php, html, xml, steam

```
function retrieveProfile() 
{
    $url = "http://steamcommunity.com/profiles/{$this->steamID64}/?xml=1";
    $profileData = simplexml_load_string($url);

    if(!empty($profileData->error)) { return NULL; }

    $this->friendlyName  = (string) $profileData->steamID;  
} 
```

> 警告：simplexml_load_string() [function.simplexml-load-string]：实体：第 1 行：解析器错误：需要开始标记，未找到“<”
> 
> > 警告：simplexml_load_string() [function.simplexml-load-string]：[http ://steamcommunity.com/profiles/76561197991676121/?xml=1](http://steamcommunity.com/profiles/76561197991676121/?xml=1)
> > 
> > > 警告：simplexml_load_string() [function.simplexml-load-string]: ^

这是 XML 文件：

[http://steamcommunity.com/profiles/76561197991676121/?xml=1](http://steamcommunity.com/profiles/76561197991676121/?xml=1)

我不知道为什么它不起作用，是的，它有`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>`标题！也尝试`$profileData = new SimpleXMLElement(file_get_contents($url))`过，但我得到了相同的结果。

为什么会这样？我该如何解决？我正在搜索 3 个小时，只看到对我没有帮助的答案。
错误：http: [//img824.imageshack.us/img824/9464/errorszz.png](http://img824.imageshack.us/img824/9464/errorszz.png)

EDIT1：simplexml_load_string 是我的错误之一，但现在我在 simplexml_load_file 中遇到更多错误 - 告诉我文档是空的......（不是真的！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T17:19:37.877

您正在加载 URL 作为您的 XML 源。你应该有：

```
$profileData = simplexml_load_file($url); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T18:01:22.257

网址从 steamcommunity.com/profiles/76561197991676121/?xml=1 更改为[http://steamcommunity.com/id/virusbogdan/?xml=1](http://steamcommunity.com/id/virusbogdan/?xml=1)。显然，第一个链接返回 null，所以出现了错误。问题解决了 ！

# asp.net - 如何在日历控件中禁用当前日期的星期

> ID：12059875
> 
> 赞同：0
> 
> 时间：2012-08-21T17:17:18.627
> 
> 标签：asp.net, calendar

我正在尝试在日历控件中禁用当前日期的星期。谁能告诉我如何做到这一点。例如...今天是 2012 年 8 月 21 日。我希望在加载日历时应该将 8 月 20 日到 8 月 25 日的整周显示为禁用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:21:42.383

您好，您可以与 ondayrender 一起使用

```
<asp:Calendar ID="id" runat="server" ondayrender="Disabled_DayRender"></asp:Calendar>

protected void Disabled_DayRender(object sender, DayRenderEventArgs e)
    {
        if (condition) //specify your condition on yours days
        {
            e.Day.IsSelectable = false;
            e.Cell.ForeColor = System.Drawing.Color.Gray;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T10:48:59.210

您可以计算一年中的周数，然后将其与当前日期的周数进行比较。

```
 protected void Calendar1_DayRender(object sender, DayRenderEventArgs e)
   {
       if (GetNumber(e.Day.Date) == GetNumber(DateTime.Now.Date))
       {
           e.Day.IsSelectable = false;
           e.Cell.ForeColor = System.Drawing.Color.Gray;
       }
   }
   public static int GetNumber(DateTime dtDate)
   {
       System.Globalization.CultureInfo ciGetNumber = System.Globalization.CultureInfo.CurrentCulture;
       int returnNumber = ciGetNumber.Calendar.GetWeekOfYear(dtDate, System.Globalization.CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Sunday);
       return returnNumber;
   } 
```

这可以解决问题。感谢普林西。

# regex - 带有负匹配的 Lighttpd URL 重写

> ID：12059877
> 
> 赞同：0
> 
> 时间：2012-08-21T17:17:26.813
> 
> 标签：regex, mod-rewrite, url-rewriting, lighttpd

我正在尝试重写其中包含图像但没有“php”的网址，例如：

我想匹配这个：

```
http://domain.com/trees.jpg 
```

并将其重写为：

```
http://domain.com/viewimg.php?image=trees.jpg 
```

但不匹配这个：

```
http://domain.com/index.php?image=trees.jpg 
```

因为它里面有'php'，所以它根本不应该对那个url进行任何重写。

我不擅长正则表达式，但我一直在尝试多种变体，但都没有奏效。这是我尝试过的一种变体的示例：

```
url.rewrite-once = (
"(?!php\b)\b\w+\.(jpg|jpeg|png|gif)$" => "/viewimg.php?image=$1.$2"
) 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:13:35.403

这应该让你开始。`\.php`如果后面有字符串，它将失败匹配`\w+\.(jpg|jpeg|png|gif)`

图案：`(?<!.*\.php.*)\b(\w+\.(jpg|jpeg|png|gif))$`

代替：`viewing.php?image=$1`

测试：

```
http://domain.com/trees.jpg  --->  http://domain.com/viewing.php?image=trees.jpg
http://domain.com/index.php/trees.jpg  ---> http://domain.com/index.php/trees.jpg
http://domain.com/index.php/image=trees.jpg  ---> http://domain.com/index.php/image=trees.jpg 
```

**编辑：**

上面使用了非恒定长度的lookbehind，这[在很多平台上显然是不支持的](http://www.regular-expressions.info/lookaround.html)。如果没有这个，我不知道您是否可以在纯正则表达式中编写“当 ABC 不在其后面的字符串中时匹配 XYZ”。也许比我有更多正则表达式的人知道一种方法。

作为一种不太通用的解决方案，这将仅检查固定字符串`.php?image=`是否位于图像名称之前：

图案：`(?<!\.php\?image=)\b(\w+\.(jpg|jpeg|png|gif))$`

代替：`viewing.php?image=$1`

# eclipse - Eclipse：当其中一个构建器失败时，构建应该停止

> ID：12059881
> 
> 赞同：1
> 
> 时间：2012-08-21T17:17:40.373
> 
> 标签：eclipse, protocol-buffers

假设我的项目有两个构建器：第一个是 Ant 构建器（或者可能只是一个简单的命令行构建器），它使用 protoc 编译 Protocol Buffer 文件以生成中间 java 文件。第二个构建器编译 java 文件，包括生成的 protobuf 文件。

问题是，当第一个构建器阶段出现构建错误时，构建过程应该停止，但事实并非如此。当构建器失败时，它只会进入下一个阶段。有没有办法让它在失败时停止？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T21:23:38.853

没有简单的方法可以做到这一点。即使订购了 Eclipse 构建器，它们也不会被视为构建项目的分步说明。无论前一个构建器的输出如何，都会调用每个构建器。由每个构建器的实现来检测具有如此破坏性的问题，以至于没有必要运行构建器的其余逻辑。例如，如果 Java Builder 检测到某些类型的构建路径问题，它就会中止。

您可以通过禁用所有构建器并将整个构建实现为 Ant 脚本来强制执行您所追求的行为，但您将放弃很多来实现此行为。

# c# - Validation.HasError 未触发针对 IDataErrorInfo 验证的 DataGrid

> ID：12059887
> 
> 赞同：4
> 
> 时间：2012-08-21T17:18:13.307
> 
> 标签：c#, .net, wpf, xaml

我有一个使用内联样式的 DataGrid，它添加了用于报告错误消息的工具提示 - 我将它绑定到实现 IDataErrorInfo 的集合。

特别是，我有一个绑定到具有 IDataErrorInfo 逻辑的整数的列，以不允许超出特定范围的值 - 当我违反此规则时，将应用默认错误行为（例如，文本框以红色突出显示）而不是激活我的错误样式，但是，如果我通过在文本框中输入文本并导致 InvalidInputString 格式触发错误，它将触发我的错误样式，就像我想要的那样。

这是我的 XAML：

```
<DataGrid ItemsSource="{x:Static local:WeatherForecast.TomorrowsForecast}" AutoGenerateColumns="False">
        <DataGrid.Resources>
            <Style x:Key="errorStyle" TargetType="{x:Type TextBox}">
                <Setter Property="Padding" Value="-2"/>
                <Style.Triggers>
                    <Trigger Property="Validation.HasError" Value="True">
                        <Setter Property="Background" Value="PeachPuff"/>
                        <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors)[0].ErrorContent}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </DataGrid.Resources>

        <DataGrid.Columns>
            <DataGridTextColumn Header="City" Binding="{Binding Path=Planet}"/>
            <DataGridTextColumn Header="Low Temperature" Binding="{Binding Path=LowestTemp, ValidatesOnExceptions=True, ValidatesOnDataErrors=True}" EditingElementStyle="{StaticResource errorStyle}" />
            <DataGridTextColumn Header="High Temperature" Binding="{Binding Path=HighestTemp, ValidatesOnExceptions=True, ValidatesOnDataErrors=True}" EditingElementStyle="{StaticResource errorStyle}" />
        </DataGrid.Columns>
    </DataGrid> 
```

我简单的 IDateErrorInfo 逻辑是：

```
 public string this[string columnName]
    {
        get 
        {
            // Temperature range checks.
            if ((columnName == "LowestTemp") || (columnName == "HighestTemp"))
            {
                if ((this.LowestTemp < -273) || (this.HighestTemp < -273))
                {
                    return "Temperature can not be below the absolute cold (-273°C).";
                }
            }

            // All validations passed successfully.
            return null;

        }
    } 
```

为什么触发红色边框的默认错误验证行为，而不是我的样式？

**更新：**

在 DataGrid 外部完成时，这似乎工作正常，例如，如果我有两个杂散的文本框绑定到我的对象的一个​​实例

```
<TextBlock>Lowest Temp</TextBlock>
    <TextBox Width="100" DataContext="{StaticResource instance}" Text="{Binding Path=LowestTemp, NotifyOnValidationError=True, ValidatesOnExceptions=True, ValidatesOnDataErrors=True}" Style="{StaticResource errorStyle}" />
    <TextBlock>Highest Temp</TextBlock>
    <TextBox Width="100" DataContext="{StaticResource instance}" Text="{Binding Path=HighestTemp, NotifyOnValidationError=True, ValidatesOnExceptions=True, ValidatesOnDataErrors=True}" Style="{StaticResource errorStyle}" /> 
```

它工作正常！知道可能阻止此行为起作用的 DataGrid 内部是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-07T01:07:32.170

你缺少`NotifyOnValidationError=True`你的`DataGridTextColumn`

# php - PHP PDO登录脚本不起作用

> ID：12059888
> 
> 赞同：0
> 
> 时间：2012-08-21T17:18:18.033
> 
> 标签：php, sql, pdo, prepared-statement

这里的另一个新手.. 我正在尝试修复以下代码以防止 sql 注入并学习编写 php 和 sql 的新方法。

您的善意建议将不胜感激。

我修改了这个

```
<?php

class DB_Functions {

    private $db;

    function __construct() {

        require_once 'db_connect.php';

        $this->db = new DB_Connect();
        $this->db->connect();
    }

    public function getUser($uid, $password) {
        $result = mysql_query("SELECT * FROM users WHERE id = '$uid' AND pswd = '$password'") or die(mysql_error());

        $no_of_rows = mysql_num_rows($result);

        if ($no_of_rows > 0) {

            $result = mysql_fetch_array($result);
            return $result;    

        } else {

            return false;
        }
    }
}

?> 
```

对此，我没有得到相同的结果..

```
<?php

class DB_Functions {

    private $db;

    function __construct() {

        require_once 'db_connect.php';

        $this->db = new DB_Connect();
        $this->db->connect();
    }

    public function getUser($uid, $password) {
        $sql = $db->prepare("SELECT * FROM users WHERE id=:id AND pswd=:password");
        $result = $db->query($sql);
        $no_of_rows = mysql_num_rows($result);

        if ($no_of_rows > 0) {

            $result = mysql_fetch_array($result);
            return $result;    

        } else {

            return false;
        }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:22:48.920

您不能将 mysql 与 mysqli 或 PDO 混合使用。您需要查看错误日志，因为这是不可能的 - 您应该看到大量致命错误。

```
public function getUser($uid, $password) {
    $stmt = $db->prepare("SELECT * FROM users WHERE id=? AND pswd=?");
    $stmt->execute(array($uid, $password));
    return $stmt->fetch();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:27:06.170

下面是一些关于如何使用 PDO 和准备好的语句的示例代码：

```
$dbh = new PDO('mysql:host=hostname_or_ip;dbname=name_of_database', 'username', 'password');
$stmt = $dbh->prepare("SELECT * FROM users WHERE id = :id AND pswd = :password");
$stmt->bindValue('id', $id);
$stmt->bindValue('password', $password);
if ($stmt->execute()) {

    if ($user = $stmt->fetchObject()) {

       // here you go 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:27:18.213

你正在做的事情有很多问题，包括 Xeoncross 所说的。

我建议您看一下[本](http://www.kineticklink.com/pdo-with-mysql-db-usage-example/ "这")教程，以便更好地掌握 PDO。他非常清楚地引导你完成事情。

看看这个 tut 后尝试重写，然后如果你仍然有问题回来。

# r - 调整晶格中轴刻度之间的空间

> ID：12059889
> 
> 赞同：2
> 
> 时间：2012-08-21T17:18:20.373
> 
> 标签：r, data-visualization, lattice, trellis

`Dotplot()`我使用这些数据创建了一个简单的：

```
d <- data.frame(emot=rep(c("happy","angry"),each=2), 
           exp=rep(c("exp","non-exp"),2), accuracy=c(0.477,0.587,0.659,0.736), 
           Lo=c(0.4508,0.564,0.641,0.719), Hi=c(0.504,0.611,0.677,0.753)) 
```

和下面的代码：

```
library(Hmisc)
Dotplot(emot ~ Cbind(accuracy, Lo, Hi), groups=exp, data=d, 
        pch=c(1,16), aspect = "xy", par.settings = list(dot.line=list(col=0))) 
```

![在此处输入图像描述](../Images/2fe8ca0748870adf5a37a1256537f4bb.png)

我想要做的是减少 y 轴刻度之间的距离并减少绘图元素之间的距离 - 以便快乐/愤怒的水平误差线彼此靠近。我知道我可能可以通过使用`scales=list(...)`参数来实现这一点（还不确定如何），但我必须再次定义标签等。有更快的方法吗？解决起来似乎很简单，但我被卡住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:53:31.430

尽管 Hmisc ::Dotplot 正在使用 lattice，但仅添加一个 ylim 参数似乎就可以解决问题。您可以找出默认比例，因为这两个值是具有潜在 1/2 值的因子：

```
Dotplot(emot ~ Cbind(accuracy, Lo, Hi), groups=exp, data=d, ylim=c(0,3),
         pch=c(1,16), aspect = "xy", par.settings = list(dot.line=list(col=0))) 
```

# mysql - rmysql 返回数据类型

> ID：12059893
> 
> 赞同：0
> 
> 时间：2012-08-21T17:18:44.397
> 
> 标签：mysql, r, date, types, rmysql

我正在使用 R 和 RMySQL 从数据库中提取一些数据，并且日期作为因素返回。然后，我必须访问`as.Date()`此专栏。因为有很多记录，这需要很长时间。有没有办法强类型返回值`fetch`？也就是说，就像`read.csv`，例如，允许您指定列类型以防止 R 自动尝试识别它们，是否有类似的东西可用？我的数据库中的日期键入为`Date`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:37:36.137

厄运。RMySQL 文档中有这样说：“*时间变量作为字符数据导入/导出，因此您需要将它们转换为您喜欢的日期/时间表示。* ”所以您总是需要转换。

RODBC 似乎正确地支持严格的日期。

# hadoop - 基于 Hadoop 中 CPU 利用率的作业完成时间

> ID：12059894
> 
> 赞同：0
> 
> 时间：2012-08-21T17:18:46.363
> 
> 标签：hadoop, response, cpu

我正在做一个模拟，看看如何降低 Hadoop 中作业的完成时间。我唯一知道的是 CPU 利用率（因为它只是一个模拟）。我知道更高的 CPU 利用率意味着更高的完成时间。但我无法模拟这两者之间的关系！假设我在一台服务器上的 CPU 利用率为 35%，并且该服务器上任务“t”的完成时间是“c”。如果 CPU 利用率为 70%，关于“t”的完成时间我能说什么？

# jqgrid - jqGrid在格式化程序中获取行元素

> ID：12059895
> 
> 赞同：0
> 
> 时间：2012-08-21T17:18:52.620
> 
> 标签：jqgrid

我为 jqGrid 中的列创建了一个自定义格式化程序。是否可以修改该单元格的父 TR？正如我所看到的，格式化程序在 TR 之前执行，并将数据添加到 DOM，所以看起来我无法通过 rowID 获取行元素。我想根据我在格式化程序中收到的 rowObject 更改 TR 的样式/CssClass。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T07:56:25.117

您应该看一下`rowattr`回调（它从 jqGrid 4.3.2 开始可用），它允许在渲染期间修改行属性。以下拉取请求中提供了更详细的描述：

*   [rowattr回调的实现](https://github.com/tonytomov/jqGrid/pull/284)

# ruby - 如何在延迟加载图像的网页上使用 watir webdriver 捕获屏幕截图

> ID：12059906
> 
> 赞同：2
> 
> 时间：2012-08-21T17:19:39.577
> 
> 标签：ruby, watir, watir-webdriver

我正在使用 watir webdriver 对网页进行一些自动化测试。当用户将内容滚动到视图中时，页面有许多延迟加载的图像（使用 jquery lazyload 插件）

我在做

```
10.times do
    browser.send_keys :space
end 
```

要滚动视图中的项目并且加载正常，我也这样做

```
browser.div(:id => 'footer').wd.location_once_scrolled_into_view 
```

将它滚动到底部然后我做

```
browser.screenshot.save 
```

这似乎没有捕获通过 jquery 插件延迟加载的任何图像。

我该怎么做才能捕获整个页面

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T19:46:11.740

您可以做的最简单的事情是滚动到页面底部。计数图像，发送`space`，再次计数图像。如果图像数量增加，请`space`再次发送。如果数字相同，则您已加载所有图像。

像这样的东西（未经测试）：

```
old_image_count = 0
new_image_count = browser.imgs
while old_image_count < new_image_count
  old_image_count = browser.imgs
  browser.send_keys :space
  new_image_count = browser.imgs
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T19:53:10.970

Instead of:

```
browser.screenshot.save 
```

try:

```
browser.driver.save_screenshot("<path>/photo.jpg") 
```

# linux - 唯一标识文件

> ID：12059907
> 
> 赞同：2
> 
> 时间：2012-08-21T17:19:45.880
> 
> 标签：linux, file, filesystems

我想在本地数据库中索引文件，但我不明白如何识别每个单独的文件。例如，如果我将文件路径存储在数据库中，那么如果文件被移动或删除，则该条目将不再有效。我想无论文件发生什么情况，都有某种唯一标识文件的方法，但我在 Google 上没有成功。

这将特别适用于 *nix/Linux 和 ext4，所以请不要针对 windows 或 ntfs 或类似的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:31:50.490

除了上面的优秀建议之外，您还可以考虑使用文件的 inode number 属性，可以在带有`ls -i`.

在我的一个盒子上使用 index.php：

`ls -i`

产量

`196237 index.php`

然后我使用 重命名文件`mv index.php index1.php`，之后产生相同的结果`ls -i`：

`196237 index1.php`

（注意inode号是一样的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T17:22:28.860

尝试使用诸如`MD5`,之类的散列方案`SHA-1`，否则`SHA-2`这些方案将允许您按内容匹配文件。

基本上，当您第一次创建索引时，您将对所有要添加的文件进行哈希处理。这个字符串非常擅长判断两个文件是不同还是相同。然后，当您需要查看其中一个文件是否已经在索引中时，对其进行哈希处理，然后将生成的哈希与您的已知哈希表进行比较。

编辑：正如评论中所说，合并两个数据是一个好主意，这样您就可以更准确地跟踪更改

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:32:06.663

如果您不认为具有相同内容的文件相同并且只想跟踪移动/重命名的文件相同，那么使用它的 inode 号就可以了。否则，您将不得不对内容进行哈希处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T13:10:03.530

唯一美中不足的是 inode 可以在删除后重新分配（取决于平台） - 您需要记录文件创建时间戳以及设备 ID 以 100% 确定。使用 Windows 及其用户文件属性更容易。

# django - django South 使用自引用模型失败

> ID：12059913
> 
> 赞同：0
> 
> 时间：2012-08-21T17:20:35.847
> 
> 标签：django, heroku

我有一个自引用模型

```
class Category(models.Model):
category_name= models.CharField(max_length=255)
parent_category= models.ForeignKey('self',null=True,blank=True)
category_user_number=models.IntegerField(null=True, blank=True)
def __unicode__(self):
    return self.category_name 
```

当我使用 south 时，此模型在本地工作，但是当我上传到 heroku 时`parent_category`出现错误

```
column mysite_category.parent_category_id does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:36:20.550

`heroku run python manage.py migrate`推送到heroku时需要运行。

# c# - 如何为自动注入另一个对象的 Ninject 绑定对象指定参数值？

> ID：12059914
> 
> 赞同：0
> 
> 时间：2012-08-21T17:20:35.957
> 
> 标签：c#, dependency-injection, ninject

免责声明：我对 Ninject 和 DI 很陌生。另外，我没有和Ninject结婚。如果有人想解释这将如何在 Windsor、Unity、SourceMap 或其他东西中工作，我会全力以赴。

我有以下处理存储类型对象的类`TArchived`：

```
public class Archiver<TArchived> where TArchived : class
{
    public Archiver(Func<string> getName, IStore<TArchived> storage, Func<TArchived> getInitialState);
} 
```

创建的实例时，它会尝试在具有从 返回的名称的实例`Archiver`中查找。如果没有实例，它会创建一个具有从 . 返回的默认值的实例。`storage``getName()``getInitialState()`

下一个类用于`Archiver`存储项目列表。但是，虽然该项目列表的大小永远不会改变，但*该列表在编译时是未知的*。

```
public class MyClass
{
    public class Item
    {
        public string Value { get; set; }
    }

    public MyClass(Archiver<Item[]> archiver)
    {
        Archiver = archiver;
    }

    public static Item[] GetInitialState(IEnumerable<string> values)
    {
        return values.Select(value => new Item { Value = value }).ToArray();
    }

    public Archiver<Item[]> Archiver { get; private set; }
} 
```

我已经像这样设置了 Ninject：

```
public class Tests
{
    private IKernel Ninject { get; set; }

    public Tests()
    {
        Ninject = new StandardKernel();
        Ninject.Bind<IStore<MyClass.Item[]>>().To<MemoryStore<MyClass.Item[]>>();

        Ninject.Bind<Archiver<MyClass.Item[]>>().To<Archiver<MyClass.Item[]>>()
            .WithConstructorArgument("getName", new Func<string>(() => "TEST"))
            .WithConstructorArgument("getInitialState", new Func<MyClass.Item[]>(MyClass.GetInitialState(/* what here? */)));
    }

    [Fact]
    public void Test()
    {
        // testing options
        var tests = new[] { "A", "B" };

        var myClass = Ninject.Get<MyClass>();
    }

    [Fact]
    public void Test_2()
    {
        // different testing options
        var tests = new[] { "A", "B", "C" };

        var myClass = Ninject.Get<MyClass>();
    }
} 
```

但我很困惑为`getInitialState`参数添加什么。如果我想要不同的项目存储列表`MyClass`，我需要将不同的项目传递给`GetInitialState`函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:56:57.733

经过更多的实验，这些是我想出的最佳解决方案。我很想看到更好的方法。

```
[Fact]
public void Test()
{
    Ninject.Bind<Func<MyClass.Item[]>>().ToProvider<Func<MyClass.Item[]>>(new CallbackProvider<Func<MyClass.Item[]>>((ctx) => () => MyClass.GetInitialState(new[] { "A", "B" })));
    var myClass = Ninject.Get<MyClass>();
}

[Fact]
public void Test2()
{
    Ninject.Bind<Func<MyClass.Item[]>>().ToConstant<Func<MyClass.Item[]>>(() => MyClass.GetInitialState(new[] { "A", "B", "C" }));
    var myClass = Ninject.Get<MyClass>();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:35:44.247

您可以从绑定中拉出构造函数参数，并将其添加到解析点。所以使用这个绑定：

```
Ninject.Bind<Archiver<MyClass.Item[]>>().To<Archiver<MyClass.Item[]>>()
    .WithConstructorArgument("getName", new Func<string>(() => "TEST")); 
```

然后在每个单元测试中使用它，根据需要更改*getInitialState*的值：

```
var myClass = Ninject.Get<MyClass>()
    .WithConstructorArgument("getInitialState", 
        new Func<MyClass.Item[]>(MyClass.GetInitialState(new string[] { "1", "2", "3" }))
    ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T21:57:35.017

我没有深入研究您的问题，但在我看来，您正在寻找[命名范围](https://github.com/ninject/ninject.extensions.namedscope/wiki)或非常接近的东西，作为在更高级别管理此类事情的一种方式。我建议从那里链接到@Remo Gloor 关于这些主题的博客文章（并将任何缺失的文章添加到[NamedScope 扩展 wiki 中](https://github.com/ninject/ninject.extensions.namedscope/wiki)：D）。

# javascript - Phonegap 等待数据库事务完成

> ID：12059916
> 
> 赞同：2
> 
> 时间：2012-08-21T17:20:51.933
> 
> 标签：javascript, ios, database, cordova, wait

我正在创建一个 Phonegap 应用程序，它在第一次运行时会以不同的方式执行。我检测第一次运行的方式是查看其中一个数据库表是否存在。正如您可能从下面的代码中看出的那样，我正在检查（可能）指示表已经存在的错误，从而证明这不是应用程序的第一次运行。

```
function databaseExists(){
var exists;
database.transaction(function(tx){
    tx.executeSql('CREATE TABLE GLOBAL (uid, property, value)');
}, function(err){
    exists = true;
}, function(){
    exists = false;
});
return exists;
} 
```

然而，我的问题是 Javascript 代码的异步执行意味着函数在成功（或错误）函数设置它的值之前返回它的值。

此函数在应用程序的初始化阶段调用：

```
if (databaseExists()){
    // Do Something
} 
```

因此必须返回值而不是在事务的成功回调中执行函数。

有没有办法强制执行等到数据库事务完成或通过 database.transaction 对象返回值？

在此先感谢，乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T18:02:56.063

您需要以回调形式编写它：

```
var dataBaseExists(yep, nope) {
  database.transaction(function(tx) {
    tx.executeSql('CREATE TABLE GLOBAL (uid, property, value)');
  }, function(){
    if (yep) {
      yep.apply(this, arguments);
    }
  }, function(){
    if (nope) {
      nope.apply(this, arguments);
    }
  });
};

var itDoes = function() {
  console.log("great");
};

var itDoesNot = function() {
  console.log("what a pity");
};

databaseExists(itDoes, itDoesNot); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:14:19.547

您需要回调，但如果不需要检查表是否存在，您可以使用 localStorage 轻松完成。

例如

```
if(localStorage.getItem('init') === null){
   //init
   localStorage.setItem('init', true);
} 
```

您将避免处理数据库。

也许这会有所帮助“如果不存在则创建表......”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T20:42:17.680

我知道会有程序员不喜欢我的解决方案，但我喜欢它！

```
var myfEspereti=false;

function Espereti(pStatus)
{
    if (pStatus==="wait")
    {
        myfEspereti = true;
        while(myfEspereti)
        {

        }
    }
    else if (pStatus==="go")
    {
        myfEspereti=false;
    }
} 
```

然后在您想要等待异步调用时调用 Espereti（“等待”）。在异步调用中，当它完成时，调用 Espereti ("go") 就可以了！

# asp.net - 通过控制台应用程序的 WCF REST

> ID：12059921
> 
> 赞同：0
> 
> 时间：2012-08-21T17:21:23.020
> 
> 标签：asp.net, wcf, rest, console-application

我正在尝试联系托管在控制台应用程序中的基本 REST 服务（由于我们产品的特定原因，我们无法在 IIS 中托管）。我可以访问 localhost:8002/Session_REST/，并且 wsdl 显示正常。但是，如果我尝试 localhost:8002/Session_REST/HelloWorld_GET 或 localhost:8002/Session_REST/HelloWorld_GET/ - 我得到的只是 405 错误：找不到方法。

应用程序配置：

```
<?xml version="1.0"?>
<configuration>
    <system.serviceModel>
        <services>
            <service name="Proprietary.WebServices.Session_REST" behaviorConfiguration="servBehavior">
                <host>
                    <baseAddresses>
                        <add baseAddress="http://localhost:8002/Session_REST/"/>
                    </baseAddresses>
                </host>
                <endpoint address="xmlService" binding="webHttpBinding" behaviorConfiguration="restBehavior" contract="Proprietary.WebServices.ISession_REST">
                    <identity>
                        <userPrincipalName value="warren_thompson@proprietary.com" />
                    </identity>                    
                </endpoint>
                <endpoint address="mex" contract="IMetadataExchange" binding="mexHttpBinding" />
            </service>
        </services>
        <behaviors>
            <endpointBehaviors>
                <behavior name="restBehavior">
                    <webHttp helpEnabled="true"/>
                </behavior>
            </endpointBehaviors>
        </behaviors>
    </system.serviceModel>
    <startup>
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
    </startup>
</configuration> 
```

控制台应用程序：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceProcess;
using System.ServiceModel;
using Proprietary.WebServices;
using Proprietary.Framework;

namespace MyTestConsole
{
    class Program
    {
        static void Main(string[] args)
        {

            ServiceHost testServiceHost2 = null;

            try
            {
                testServiceHost2 = new ServiceHost(typeof(Session_REST));

                testServiceHost2.Open();
                Console.WriteLine("Server Started");
                Console.ReadLine();
            }
            finally
            {
                if (testServiceHost2 != null)
                {
                    ((IDisposable)testServiceHost2).Dispose();
                }
            }
        }
    }
} 
```

WCF 合约：使用系统；

```
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;
using Proprietary.Framework;
using System.IO;

namespace Proprietary.WebServices
{

    [ServiceContract]
    public interface ISession_REST
    {

        [OperationContract]
        [WebInvoke(BodyStyle = WebMessageBodyStyle.Bare, ResponseFormat = WebMessageFormat.Json)]
        string HelloWorld_POST();

        [OperationContract]
        [WebInvoke(Method="GET")]
        string HelloWorld_GET();
    }

} 
```

WCF 实现：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Activation;
using System.ServiceModel.Web;
using System.Text;

using Proprietary.Framework;
using Proprietary.WebSupport;
using System.Web.Script.Serialization;

namespace Proprietary.WebServices
{
    /// <summary>
    /// Represents a doclink web service session - Rest version.
    /// </summary>
    public class Session_REST : ISession_REST
    {
        string ISession_REST.HelloWorld_POST()
        {
            return "Hellow World via POST";
        }

        string ISession_REST.HelloWorld_GET()
        {
            return "Hello World via GET";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:05:47.017

好的 - 原来我没有注意端点地址 - 这是 xmlService - 所以我可以从 localhost:8002/Session_REST/xmlService/HelloWorld_GET 调用它。

服务方法 = baseaddress/endpointaddress/methodname/

# jquery - 强制触摸屏设备的悬停动作

> ID：12059926
> 
> 赞同：0
> 
> 时间：2012-08-21T17:21:38.827
> 
> 标签：jquery, mobile, touch

我正在为我的网站使用[jquery-lightbox 滑块](http://leandrovieira.com/projects/jquery/lightbox/)。我的网站针对移动设备进行了优化。问题是幻灯片上的“上一个”和“下一个”按钮仅在您将鼠标悬停在它们上方时才会显示......现在在触摸屏设备上，这是一个问题。如何强制通过悬停动作显示下一个和上一个按钮？

这是控制悬停动作的代码，但不知道这是否必要。我相信它可以在启动前端代码中定义：

```
$(function() {
        $('#gallery a').lightBox();
}); /*the initiating code*/ 
```

jquery-lightbox js文件悬停效果代码

```
function _set_navigation() {
            $('#lightbox-nav').show();

            // Instead to define this configuration in CSS file, we define here. And it´s need to IE. Just.
            $('#lightbox-nav-btnPrev,#lightbox-nav-btnNext').css({ 'background' : 'transparent url(' + settings.imageBlank + ') no-repeat' });

            // Show the prev button, if not the first image in set
            if ( settings.activeImage != 0 ) {
                if ( settings.fixedNavigation ) {
                    $('#lightbox-nav-btnPrev').css({ 'background' : 'url(' + settings.imageBtnPrev + ') left 15% no-repeat' })
                        .unbind()
                        .bind('click',function() {
                            settings.activeImage = settings.activeImage - 1;
                            _set_image_to_view();
                            return false;
                        });
                } else {
                    // Show the images button for Next buttons
                    $('#lightbox-nav-btnPrev').unbind().hover(function() {
                        $(this).css({ 'background' : 'url(' + settings.imageBtnPrev + ') left 15% no-repeat' });
                    },function() {
                        $(this).css({ 'background' : 'transparent url(' + settings.imageBlank + ') no-repeat' });
                    }).show().bind('click',function() {
                        settings.activeImage = settings.activeImage - 1;
                        _set_image_to_view();
                        return false;
                    });
                }
            }

            // Show the next button, if not the last image in set
            if ( settings.activeImage != ( settings.imageArray.length -1 ) ) {
                if ( settings.fixedNavigation ) {
                    $('#lightbox-nav-btnNext').css({ 'background' : 'url(' + settings.imageBtnNext + ') right 15% no-repeat' })
                        .unbind()
                        .bind('click',function() {
                            settings.activeImage = settings.activeImage + 1;
                            _set_image_to_view();
                            return false;
                        });
                } else {
                    // Show the images button for Next buttons
                    $('#lightbox-nav-btnNext').unbind().hover(function() {
                        $(this).css({ 'background' : 'url(' + settings.imageBtnNext + ') right 15% no-repeat' });
                    },function() {
                        $(this).css({ 'background' : 'transparent url(' + settings.imageBlank + ') no-repeat' });
                    }).show().bind('click',function() {
                        settings.activeImage = settings.activeImage + 1;
                        _set_image_to_view();
                        return false;
                    });
                }
            }
            // Enable keyboard navigation
            _enable_keyboard_navigation();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:53:59.387

只需将选项添加`fixedNavigation:true`到您的初始化代码中，这将使 Next 和 Prev 按钮始终可用

```
$('#gallery a').lightBox({fixedNavigation:true}); 
```

# java - 如何通过 Android 蓝牙使用串行通信（端口）发送数据？

> ID：12059928
> 
> 赞同：0
> 
> 时间：2012-08-21T17:21:45.190
> 
> 标签：java, android, bluetooth, serial-port, arduino

如何通过蓝牙使用串行通信（端口）发送数据？

我需要通过 Android 设备将串行数据发送到蓝牙模型（BlueSMiRF Silver）（连接到 Arduino 板）。

我真的坐了三天试图理解如何做到这一点......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T19:54:11.983

很高兴有更多关于你尝试了什么以及你被困在哪里的细节。

在 Android 端，第一步是与 BlueSMiRF 模块配对。您应该能够发现 BlueSMiRF 并从 android 上的“蓝牙设置”中配对。您可能必须将 BlueSMiRF 模块置于可发现模式（您可以为其设置密码）。

配对后，为了能够发送和接收数据，您需要使用蓝牙套接字进行连接。要与 BlueSMiRF 模块通信，您需要使用串行端口配置文件 (SPP) 并创建和 RFCOMM 套接字。例如，您可以[查看这篇文章](https://stackoverflow.com/questions/7986508/how-can-i-properly-connect-an-android-application-to-an-rfcomm-socket-on-a-bluet)。

# sql - MSSQL：避免 CHECK 约束的更新语句

> ID：12059929
> 
> 赞同：5
> 
> 时间：2012-08-21T17:21:53.303
> 
> 标签：sql, sql-server-2000, constraints

在 MS2000 中工作时，我有一个名为 JobOwners 的表，它将工作 (JPSID) 映射到拥有它们的员工 (EmpID)。它还包含他们开始拥有该工作的日期 (DateStarted)、他们停止拥有该工作的日期 (DateEnded) 以及所有权是否处于活动状态 (IsActive)。看起来像这样。

```
CREATE TABLE JobOwners
(
    LogID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
    JPSID int NOT NULL FOREIGN KEY REFERENCES JobsPerShift(JPSID),
    EmpID int NOT NULL FOREIGN KEY REFERENCES Employees(EmpID),
    DateStarted datetime,
    DateEnded datetime,
    IsActive tinyint NOT NULL   
) 
```

应该没有活动的 JPSID 重复，尽管不活动的重复应该没问题。通过一些研究，我发现我可以使用 CHECK 约束上的函数来完成此任务。

```
CREATE FUNCTION CheckActiveCount(@JPSID INT) 
RETURNS INT AS 
BEGIN
    DECLARE @result INT
    SELECT @result = COUNT(*) FROM JobOwners WHERE JPSID = @JPSID AND IsActive = 1
    RETURN @result
END
GO

ALTER TABLE JobOwners 
 ADD CONSTRAINT CK_JobOwners_IsActive
 CHECK ((IsActive = 1 AND dbo.CheckActiveCount(JPSID) <= 1) OR (IsActive = 0)) 
```

这工作得很好。它将允许我使用 IsActive 1 插入 JPSID 2，因为没有其他活动的 JPSID 2。它将允许我使用 IsActive 0 插入 JPSID 2，因为当 IsActive 为 0 时不应用检查。当我尝试时它拒绝但是再次插入带有 IsActive 1 的 JPSID 2，因为它与约束冲突。见下文。

```
INSERT INTO JobOwners
 VALUES(2,2,NULL,NULL,1)

(1 row(s) affected)

INSERT INTO JobOwners
 VALUES(2,2,NULL,NULL,0)

(1 row(s) affected)

INSERT INTO JobOwners
 VALUES(2,3,NULL,NULL,1)

INSERT statement conflicted with COLUMN FOREIGN KEY constraint... 
```

如果我尝试将其中一条非活动记录更新为活动记录，则会出现此问题。出于某种原因，它允许我。

```
UPDATE JobOwners SET IsActive = 1
 WHERE LogID = 3

(1 row(s) affected) 
```

如果我再次运行相同的语句，则它与约束冲突，但不是第一次。这个应用程序的前端永远不会将非活动记录更改为活动记录，它只会插入一条新记录，但这仍然不是我希望表格允许的事情。

我想知道是否最好将活动的工作所有者分开并为工作所有者的历史记录一个单独的表格，但我不确定这里的最佳实践。任何帮助将不胜感激。

谢谢你，
本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T17:59:32.780

存在一个已知问题，即某些操作将导致调用 UDF 被绕过的检查约束。该错误已在 Connect 上列出（在它被破坏并且所有链接都被孤立之前）并且已被确认，但由于无法修复而关闭。这意味着我们需要依靠变通方法。

我的第一个解决方法可能是一个而不是更新触发器。感谢 Martin 让我诚实并让我进一步测试 - 我发现我没有防止在同一个语句中将两行更新为 1。我已经更正了逻辑并添加了一个事务来帮助防止竞争条件：

```
CREATE TRIGGER dbo.CheckJobOwners ON dbo.JobOwners
INSTEAD OF UPDATE
AS
BEGIN
  SET NOCOUNT ON;
  BEGIN TRANSACTION;

  UPDATE j SET IsActive = 1 -- /* , other columns */
    FROM dbo.JobOwners AS j INNER JOIN inserted AS i
    ON i.LogID = j.LogID
    WHERE i.IsActive = 1 AND NOT EXISTS 
    (    -- since only one can be active, we don't need an expensive count:
      SELECT 1 FROM dbo.JobOwners AS j2
        WHERE j2.JPSID = i.JPSID
        AND j2.IsActive = 1 AND j2.LogID <> i.LogID
    )
    AND NOT EXISTS 
    (    -- also need to protect against two rows updated by same statement: 
      SELECT 1 FROM inserted AS i2
        WHERE i2.JPSID = i.JPSID
        AND i2.IsActive = 1 AND i2.LogID <> i.LogID
    );

  -- *if* you want to report errors:
  IF (@@ROWCOUNT <> (SELECT COUNT(*) FROM inserted WHERE IsActive = 1))
    RAISERROR('At least one row was not updated.', 11, 1);

  -- assume setting active = 0 always ok & that IsActive is not nullable
  UPDATE j SET IsActive = 0 -- /* , other columns */
    FROM dbo.JobOwners AS j INNER JOIN inserted AS i
    ON j.LogID = i.LogID
    WHERE i.IsActive = 0;

  COMMIT TRANSACTION;
END
GO 
```

（我使用而不是而不是后触发器的唯一原因是您只更新需要更新的行，而不是事后回滚（这不会让您只在多的情况下回滚无效更新） -行更新））。

这里有很多关于这个问题的很好的讨论：

[https://web.archive.org/web/20171013131650/http://sqlblog.com/blogs/tibor_karaszi/archive/2009/12/17/be-careful-with-constraints-calling-udfs.aspx](https://web.archive.org/web/20171013131650/http://sqlblog.com/blogs/tibor_karaszi/archive/2009/12/17/be-careful-with-constraints-calling-udfs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-09T19:51:07.587

**编辑：** 巨大的警告。请参阅 Aaron 对此[SO 问题](https://stackoverflow.com/q/18406895/528061)的评论，了解您可能希望避免组合 UDF 和 CHECK CONSTRAINTS 的原因。但是，由于（即使在阅读并理解了 Aaron 的担忧之后）我的答案在我们的系统中仍然可行，因为 1）我们的系统如何工作，以及 2）我们实际上希望 UPDATE 语句在他描述的场景中失败，所以我将答案留在这里. 一如既往，由您来确保您了解在此答案中使用脚本的后果。**你被警告了**

我按照亚伦（已接受）答案中的链接进行操作。在描述中有一段特定的文字引起了我的注意“（检查未作为参数传递的值）”。

这给了我一个想法。我有一个表，其中包含 CustomerId、ContactId、ContactType 列，所有类型均为“int”。PK 是 CustomerId 和 ContactId。我需要能够将每个 CustomerId 限制为只有一个“主要”联系人（ContactType = 1），但要添加尽可能多的“次要”和“其他”联系人。我已将我的 UDF 设置为仅接受 CustomerId 作为参数。因此，我也添加了 ContactType，但由于我只关心 ContactType = 1，因此我只是在函数内将 ContactType 参数硬编码为 1。它适用于 SQL2012，但我不知道其他版本。

这是一个测试脚本。我将一些语句“挤压”在一起以减少所需的滚动量。 **注意：**约束允许零个主要联系人，因为如果您没有首先删除现有的主要联系人，则无法将其他联系人设置为主要联系人。

```
CREATE TABLE [dbo].[CheckConstraintTest](
    [CustomerId] [int] NOT NULL,
    [ContactId] [int] NOT NULL,
    [ContactType] [int] NULL,
CONSTRAINT [PK_CheckConstraintTest] PRIMARY KEY CLUSTERED (
    [CustomerId] ASC,
    [ContactId] ASC
))
GO

CREATE FUNCTION dbo.OnlyOnePrimaryContact (
    @CustId int, @ContactType int ) RETURNS bit
AS BEGIN
    DECLARE @result bit, @count int
    SET @ContactType = 1 --only care about "1" but needed parm to force SQL to "care" about that column
    SELECT @count = COUNT(*) FROM CheckConstraintTest WHERE [CustomerId] = @CustId AND [ContactType] = @ContactType
    IF @count < 2 SET @result = 1
    ELSE  SET @result = 0
    RETURN @result
END
GO

ALTER TABLE [dbo].[CheckConstraintTest] WITH CHECK ADD CONSTRAINT [SinglePrimaryContact] CHECK  (([dbo].[OnlyOnePrimaryContact]([CustomerId],[ContactType])=(1)))
GO

ALTER TABLE [dbo].[CheckConstraintTest] CHECK CONSTRAINT [SinglePrimaryContact]
GO

INSERT INTO [CheckConstraintTest] (CustomerId, ContactId, ContactType) 
VALUES (1,1,1), (1,2,2), (1,3,2), (1,4,2), (2,1,1)

INSERT INTO [CheckConstraintTest] (CustomerId, ContactId, ContactType) 
VALUES (1,5,1) --This should fail

UPDATE [CheckConstraintTest] --This should fail
SET ContactType = 1
WHERE CustomerId = 1 AND ContactId = 2

UPDATE [CheckConstraintTest] --This should work
SET ContactType = 2
WHERE CustomerId = 1 AND ContactId = 1

INSERT INTO [CheckConstraintTest] (CustomerId, ContactId, ContactType) 
VALUES (1,5,1) --This should work now since we change Cust 1, Contact 1, to "secondary" in previous statement 
```

# php - 将新数组添加到多维数组项

> ID：12059930
> 
> 赞同：0
> 
> 时间：2012-08-21T17:22:00.310
> 
> 标签：php, multidimensional-array

我需要在不覆盖旧数据的情况下向数组添加一些细节。

目前，如果我 print_r($data)

```
 Array
 (
   [one] => Hello
   [two] => Hello World
 ) 
```

然后我有一个向数组添加一些数据的函数

```
 foreach ($rubric as $rs){
      if($rs['position']==1){$data['one']=$rs;}
  if($rs['position']==2){$data['two']=$rs;}
 } 
```

如果我 print_r($data) 这给了我以下信息

```
Array
(
   [one] => Array
      (
         [id] => 1
      )
   [two] => Array
      (
         [id] => 2
      )
) 
```

有没有人有任何想法

我想做的是......

```
 foreach ($rubric as $rs){
      if($rs['position']==1){$data['one']['details']=$rs;}
  if($rs['position']==2){$data['two']['details']=$rs;}
 } 
```

目的是在每个数组项中添加一个名为“详细信息”的新子数组...

那有意义吗？但是，如果我尝试运行该代码，则会收到以下错误

**遇到 PHP 错误 严重性：通知消息：数组到字符串的转换**

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:28:00.330

请参阅 [array_push](http://php.net/manual/en/function.array-push.php) [array_unshift](http://www.php.net/manual/en/function.array-unshift.php)。

数组推送将一个元素放在最后。数组 unshift 将一个数字添加到数组的开头。

也可以使用结构

```
$myArray['nameOfNewElement']=$newElement; 
```

这会将 $newElement 添加到数组 $myArray;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:38:05.107

您可以使用[array_merge](http://www.php.net/manual/en/function.array-merge.php)。

根据您的问题，这是解决方案：

```
// sample array
$rubric = array(0=> array("position"=>1),1 => array("position"=>2));
$data = array("one" => "Hello","two" => "hello world");
foreach ($rubric as $rs){
      if($rs['position']==1){
           $d= array_merge($data,$rs);
      }
      if($rs['position']==2){
          $d= array_merge($data,$rs);
      }
 }
print_r($d); 
```

这是工作演示：[http ://codepad.org/rgKiv542](http://codepad.org/rgKiv542)

希望，它会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T17:26:51.263

当您编写时`$data['one'] = $rs;`，您正在分配 $rs 以覆盖该值`"Hello"`。

也许你想做的是

```
$data['three'] = $rs['id']; 
```

# java - 在 Java 中按名称 ping 计算机

> ID：12059932
> 
> 赞同：6
> 
> 时间：2012-08-21T17:22:05.423
> 
> 标签：java, ping

我正在编写一个简单的程序，该程序从 MySQL 数据库中提取计算机名称，然后将这些名称存储到一个字符串数组列表中（这部分工作正常）。之后，我编写了一个类和一个将字符串作为参数（将是计算机名称）并尝试对其进行 ping 操作的方法。这是该类的代码：

```
public class Ping 
{
public void pingHost(String hostName)
{   
    try
    {
        InetAddress inet = InetAddress.getByName(hostName);
        boolean status = inet.isReachable(5000);
        if (status)
        {
            System.out.println(inet.getHostName() + " Host Reached\t" + inet.getHostAddress());
        }
        else
        {
            System.out.println(inet.getHostName() + " Host Unreachable");
        }

    }
    catch (UnknownHostException e)
    {
        System.err.println(e.getMessage() + " Can't Reach Host");
    }
    catch (IOException e)
    {
        System.err.println(e.getMessage() + " Error in reaching the Host");
    }
} 
```

问题是，`UnknownHostException`即使我可以手动 ping 它们或者我将计算机名称硬编码为“hostName”，我仍然会被大多数计算机抛出。

这是我的主要外观：

```
public static void main(String[] args) throws InstantiationException, IllegalAccessException, ClassNotFoundException, SQLException 
{
    ArrayList <String> list = new ArrayList<String>();  
    MySQLConnect myConnection = new MySQLConnect();
    myConnection.importData(list);
    Ping pingComputer = new Ping();
    pingComputer.pingHost(list.get(87));            
} 
```

现在我只是想尝试一台正在抛出`UnknownHostException`但可以手动ping通的计算机。有人知道为什么会这样吗？

编辑...

只是为了多解释一点。例如在 main 中，如果我将这些参数传递给`pingHost`：

```
pingComputer.pingHost("ROOM-1234"); 
```

它 ping 正常并返回正确的主机名/地址。但`list.get(87)`返回相同的主机名“ROOM-1234”但抛出`UnknownHostException`？这让我很困惑，不知道为什么它不起作用。

编辑

哇终于想通了。当我像“ROOM-1234”那样直接传递字符串时，ping 起作用的原因是因为没有空格并且从数组中获取，所以`list.get(87)`返回相同的东西但是当我检查时`charLength`，它返回了不同的值:) 所以我刚刚结束`trim`用于摆脱空白，现在它工作得很好。

```
pingComputer.pingHost(list.get(87).trim()); 
```

感谢所有的建议！

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-04-06T18:21:33.420

亲爱的，实际上您使用的代码是检查主机是否可访问。

使用以下类来 ping windows pc 使用 ping 方法，但对于 windows pc 以外的使用是可访问的。

```
package com.utils;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.InetAddress;
import java.net.UnknownHostException;

public class Ping {

    public Boolean IsReachable(String ipaddress) {
        try {            
            final InetAddress host = InetAddress.getByName(ipaddress);

            try {
                return host.isReachable(3000);
            } catch (IOException e) {
                e.printStackTrace();
            }
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
        return false;
    }

    public Boolean ping(String ipaddress) {
        Runtime runtime = Runtime.getRuntime();
        String cmds = "ping " + ipaddress;
        System.out.println(cmds);
        Process proc;

        try {
            proc = runtime.exec(cmds);
            proc.getOutputStream().close();
            InputStream inputstream = proc.getInputStream();
            InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
            BufferedReader bufferedreader = new BufferedReader(inputstreamreader);
            String line;

            while ((line = bufferedreader.readLine()) != null) {
                if (line.contains("Reply from " + ipaddress + ":")) {
                    return true;
                }
            }
        } catch (IOException e) {

            e.printStackTrace();
        }
        return false;
    }
} 
```

并使用如下代码

```
public static void main(String[] args) {
    ArrayList<String> list = new ArrayList<String>();
    MySQLConnect myConnection = new MySQLConnect();
    myConnection.importData(list);
    Ping ping = new Ping();

    if (ping.ping(list.get(87)) {
        System.out.prinln("Online / Host is reachable");
    } else {
        System.out.prinln("Offline /Host is unreachable");
    }
} 
```

但我建议通过 ip 地址 ping 比用计算机名 ping 更好。

# asp.net - 在 asp.net 中为多个电子邮件地址创建正则表达式的语法

> ID：12059933
> 
> 赞同：0
> 
> 时间：2012-08-21T17:22:20.230
> 
> 标签：asp.net, regex, syntax, validation

我想在 Asp.net 中为 RegularExpressionValidator 创建一个正则表达式...

我想创建以下表达式

（电子邮件地址（[,][SPACE]* 电子邮件地址）*）？

电子邮件地址 = \w+([-+.']\w+) *@\w+([-.]\w+)* .\w+([-.]\w+)*

请检查电子邮件地址是否正确，以及如何为上述表达式创建语法谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:27:44.650

建立在[使用正则表达式验证电子邮件地址的](https://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address)基础上，

```
ValidationExpression="(?:(?:^|,\s*)[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})\s*)+" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:29:07.753

你可以试试

```
ValidationExpression="^(([^<>()[\]\\.,;:\s@\""]+"

                        + @"(\.[^<>()[\]\\.,;:\s@\""]+)*)|(\"".+\""))@"

                        + @"((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"

                        + @"\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+"

                        + @"[a-zA-Z]{2,}))$" 
```

您可以使用此站点来创建您的正则表达式：RegexHero

# .net - 收集日志信息的标准化方式？

> ID：12059934
> 
> 赞同：1
> 
> 时间：2012-08-21T17:22:27.863
> 
> 标签：.net, logging

我们有数十个大型服务器端应用程序分散在企业各处——所有这些应用程序都有不同的记录信息和报告错误的方式。

我正在尝试构建一个仪表板（随着时间的推移），它可以一目了然地显示所有应用程序的运行状况，并查看应用程序可能遇到的任何问题。显然，最好采用单一的方式来记录信息。

显然，我可以自己推出，但我想知道是否已经存在解决这些挑战的标准。也许，允许客户端应用程序连接/查询服务器端应用程序（或读取它们的日志文件）而不会过多影响性能并获取状态信息。

PS 所有应用程序都是 .NET 2/3.5/4 中的 C# 混合。一些应用程序使用 Log4Net，其他应用程序使用自己的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:25:55.803

使用事件日志报告错误。有几十个应用程序可以监控它。

使用 SNMP 监控应用程序的运行状况。

日志记录仅用于诊断/调试恕我直言。

# clojure - 线程环境中的 Clojure 全局变量行为

> ID：12059936
> 
> 赞同：6
> 
> 时间：2012-08-21T17:22:38.737
> 
> 标签：clojure, global-variables

鉴于这可以按我的预期工作：

```
(do
  (println (resolve 'a)) ; nil 
  (def a "a")
  (println (resolve 'a))) ; #'user/a 
```

我想了解为什么这不会：

```
(future
  (println (resolve 'b)) ; #'user/b (shouldn't it be still undefined at this point?)
  (def b "b")
  (println (resolve 'b))) ; #'user/b 
```

我也想知道这是否是一个合适的解决方案（不完全解决同样的问题，但在我的上下文中做同样的工作）：

```
(def c (atom nil))
(future
  (println @c) ; nil
  (reset! c "c")
  (println @c)) ; c 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T18:16:56.460

这种行为是`def`表单编译方式的结果。

请注意，在任何情况下，作为一种风格问题，使用`def`不在顶级（或可能在顶级内 - 有关此案例的更多评论，请参见下文）的表单都是不受欢迎的。`let`另一方面，使用 Atom 的代码片段很好——如果它可以满足您的需求，就没有理由不使用它。

讲`def`故事：

1.  `def`表格汇编：

    当`def`遇到表单时，编译器会在当前命名空间中创建一个适当名称的*Var*。`def`（通过使用命名空间限定符号作为名称参数来尝试在当前命名空间之外的 Var 会`def`导致异常）。Var 起初是未绑定的，并且在`def`实际执行之前一直保持未绑定；对于顶级的`def`，那将是马上，但对于`def`隐藏在函数体内（或在`let`表单内——见下文），那将是函数被调用的时候：

    ```
    ;;; in the user namespace:

    (defn foo []
      (def bar "asdf")
     :done)
    ; => #'user/foo

    bar
    ; => #<Unbound Unbound: #'user/bar>

    ;;; let's change the namespace and call foo:

    (ns some.ns)
    (user/foo)
    ; => :done

    bar
    ; exception, the bar Var was created in the user namespace!

    user/bar
    ; => "asdf"
    ; the Var's namespace is fixed at compile time 
    ```

2.  第一个例子——`do`形式为：

    顶级`do`s 被视为它们的内容在`do`发生的地方被拼接到代码流中。因此，如果您`(do (println ...) (def ...) (println ...))`在 REPL 处键入，则相当于键入第一个`println`表达式，然后是`def`，然后是第二个`println`表达式（除了 REPL 只产生一个新提示）。

3.  第二个例子——用`future`：

    `(future ...)`扩展到接近`(future-call (fn [] ...))`. 如果`...`包含一个`def`表单，它将按照我们上面看到的方式进行编译。当匿名函数在其自己的线程上执行时，Var 将被创建，因此`resolve`将能够找到它。

4.  作为旁注，让我们看一下类似的片段及其输出：

    ```
    (let []
      (println (resolve 'c)) 
      (def c "c") 
      (println (resolve 'c)))
    ; #'user/c
    ; #'user/c
    ; => nil 
    ```

    原因和以前一样，`let`先编译，然后作为一个整体执行。这是在使用内部带有定义的顶级`let`表单时应该牢记的一点——只要没有副作用代码与定义混合，通常就可以了；否则必须格外小心。

# ruby-on-rails - 回形针更新后突然抛出一个奇怪的错误

> ID：12059939
> 
> 赞同：3
> 
> 时间：2012-08-21T17:22:55.227
> 
> 标签：ruby-on-rails, paperclip, ruby-on-rails-3.2

我不能再在我的 Rails 应用程序中呈现带有回形针 URL 的页面。我最近更新了我的 gem 包。我正在使用 Rails 3.2.8 和 Paperclip 3.1.4。我之前使用的是 Paperclip 2.7.0。

我认为失败的链接是：

```
ad.image.url(:medium) 
```

我的广告模型有这些声明：

```
Paperclip.interpolates :ad_subdomain do |attachment, style|
  attachment.instance.brand.subdomain
end

has_attached_file :image, 
                :default_url => '/images/blank.gif',
                :styles => { :medium => ["290x230>","jpg"],
                             :thumb => ["100x100>","jpg"] },
                :storage => :file,
                :path => "/mcp/ads/:style/:ad_subdomain/:basename.:extension" 
```

被抛出的错误是：

```
TypeError: wrong argument type Class (expected Module)
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip/attachment.rb:368:in `extend'
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip/attachment.rb:368:in `initialize_storage'
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip/attachment.rb:80:in `initialize'
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip/instance_methods.rb:5:in `new'
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip/instance_methods.rb:5:in `attachment_for'
from /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/paperclip-3.1.4/lib/paperclip.rb:191:in `block in has_attached_file' 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-21T17:47:53.890

出于某种原因，我有：

```
:storage => :file 
```

在我的声明中。那是行不通的。如果你想使用文件系统，你只需完全省略存储线，它将默认。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:26:32.857

查看 Paperclip github 页面上列出的要求：

> Paperclip 现在需要 Ruby 版本 >= 1.9.2 和 Rails 版本 >= 3.0（仅当您打算将 Paperclip 与 Ruby on Rails 一起使用时。）
> 
> 如果您仍在使用 Ruby 1.8.7 或 Ruby on Rails 2.3.x，您仍然可以在项目中使用 Paperclip 2.7.x。此外，本 README 中的所有内容可能不适用于您的 Paperclip 版本，您应该阅读 2.7 版的 README。

# matplotlib - 实时绘制数据

> ID：12059940
> 
> 赞同：1
> 
> 时间：2012-08-21T17:23:00.670
> 
> 标签：matplotlib, wxpython

我有一个程序向终端输出一个数字，一次一行。我的目标是让其他东西读取这些数字并将它们实时绘制成折线图。有人建议使用 matplotlib 和 wxpython，但我不确定如何实现这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:30:09.253

请参阅以下链接：

*   [wxPython 最好的实时绘图小部件是什么？](https://stackoverflow.com/questions/457246/what-is-the-best-real-time-plotting-widget-for-wxpython)
*   [Python中的简约实时绘图](https://stackoverflow.com/questions/9401857/minimalistic-real-time-plotting-in-python)
*   [http://eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis/](http://eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis/)
*   [http://wxpython-users.1045709.n5.nabble.com/real-time-data-plots-td2344816.html](http://wxpython-users.1045709.n5.nabble.com/real-time-data-plots-td2344816.html)

正如其中一些人指出的那样，您可能可以将 wx 的 PyPlot 用于非常简单的事情或使用 Chaco。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:30:42.077

我真的很喜欢这个用于 HTML5 图形的库。这是实时更新的演示：http: [//dygraphs.com/gallery/#g/dynamic-update](http://dygraphs.com/gallery/#g/dynamic-update)

您只是在寻求有关绘制库的建议吗？

# google-analytics - 谷歌分析分离平板电脑和移动流量

> ID：12059942
> 
> 赞同：6
> 
> 时间：2012-08-21T17:23:15.257
> 
> 标签：google-analytics

我有一个 GA 配置文件，我想在其中分离出平板电脑和移动设备的流量。谷歌有针对平板电脑和移动设备的开箱即用的高级细分市场；然而，谷歌的移动部分包括平板电脑流量。如何包括仅手机流量？

我尝试使用屏幕分辨率设置那些屏幕宽度小于 7xx 作为手机，但它会排除一些高分辨率手机，如 Galaxy Nexus。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T11:25:22.760

这是一个较旧的线程，但答案是新的并且有效。要将平板电脑流量与您网站的移动流量分开，您需要创建一个新的“高级细分”。

1.  登录谷歌分析
2.  转到您想要获取移动统计信息的客户资料
3.  点击页面顶部的“高级细分”链接（在灰色栏中）
4.  点击“+新建自定义细分”按钮
5.  输入此细分的名称，例如，移动设备（不是平板电脑）
6.  配置此项：[包括] 手机（包括平板电脑）[完全匹配] 是
7.  点击“添加'OR'语句
8.  配置此项： [排除] 平板电脑 [完全匹配] 是
9.  单击“保存段”按钮
10.  返回到“报告”都在 Google Analytics 中
11.  再次点击“高级细分”，选择新的“移动（非平板电脑）”自定义细分
12.  单击应用
13.  您的指标适用于非平板电脑的移动设备

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-19T23:56:16.227

Update Jul 2013: It's *finally* arrived in Analytics - [http://www.chrisbell.eu/separate-mobile-and-tablet-segmentation-finally-arrives-on-analytics/](http://www.chrisbell.eu/separate-mobile-and-tablet-segmentation-finally-arrives-on-analytics/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-29T11:31:28.193

自从发布最后一个答案以来，Google 已经创建了一个名为“平板电脑流量”的默认分段 - 使用此分段可以仅查看来自 Google 定义的平板电脑列表的流量。

值得注意的是，默认段“移动流量”包括“平板电脑流量”段。IE 以获取来自手机（不包括平板电脑）的访问，您将采样“移动流量”和“平板电脑流量”默认分段，并从“移动流量”分段中减去“平板电脑流量”分段。这将为您提供来自手机（手机）的流量和来自平板电脑的流量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T17:43:49.113

看起来 GA 现在没有一个简单的方法来做到这一点。我的想法是，您必须通过专门命名其移动设备型号来排除每个平板电脑。

例如，排除>移动设备型号>完全匹配> Apple iPad

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-18T20:55:06.130

Koozai 博客采用不同的方法从移动访问中排除平板电脑流量。作者使用操作系统对她的数据进行了分段，并排除了一些分辨率。

[http://www.koozai.com/blog/analytics/top-15-most-useful-advanced-segments-in-google-analytics/](http://www.koozai.com/blog/analytics/top-15-most-useful-advanced-segments-in-google-analytics/)

您可以在她的细分市场基础上构建并包括其他移动操作系统以及排除其他分辨率。

# asp.net-mvc - 401 未经授权的 ajax 请求

> ID：12059947
> 
> 赞同：1
> 
> 时间：2012-08-21T17:23:50.463
> 
> 标签：asp.net-mvc, iis, iis-7.5

我们最近将我们的网络服务器移到了一台新机器（基于 IIS）上，在我正在处理的 asp.net mvc 应用程序中，我注意到在 firebug 控制台中，每个请求都失败了两次，并出现 401 错误，最后第三次尝试成功. 这以前没有发生过，应用程序的运行速度似乎比以前稍慢，尽管这可能只是我的看法。

什么可能导致这个问题，我可以做些什么来避免它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T18:11:15.887

几周前我遇到了类似的问题，下面的帖子挽救了我的一天......

[https://serverfault.com/questions/137073/401-unauthorized-on-server-2008-r2-iis-7-5](https://serverfault.com/questions/137073/401-unauthorized-on-server-2008-r2-iis-7-5)

我希望这可以帮助你...

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-04-15T13:05:15.983

考虑尝试检查您的 IIS 池。或者可能是超时到期？

# spring - 在不使用控制器的情况下在 Spring 3 中为 url 映射 jsp

> ID：12059955
> 
> 赞同：4
> 
> 时间：2012-08-21T17:24:03.753
> 
> 标签：spring, spring-mvc, java-ee-6

如何在 spring 3 中为 url 映射 jsp 而无需请求映射到任何控制器。

例如。/login 到 login.jsp 之间没有任何用户定义的控制器

像 spring2.5 中的 URLFILENAMECONTROLLER 一样，在 spring 3 中类似

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-21T18:19:29.467

您可以使用Spring 文档中的[此](http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-config-view-controller)段落作为参考。简而言之，您可以通过多种方式使用`view-controller`注释其中一种。使用时的另一种方式`Java Config`：

```
@EnableWebMvc
@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {

  @Override
  public void addViewControllers(ViewControllerRegistry registry) {
    registry.addViewController("/login").setViewName("login");
  }

} 
```

如果视图解析器的定义与前面的答案相同，则 代码映射请求查看`/login`的位置。`/WEB-INF/views/login.jsp`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-21T17:59:00.163

你可以这样做：

```
<mvc:view-controller path="/login" view-name="login"/> 
```

假设您已经定义了一个 ViewResolver，如下所示：

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/" />
    <property name="suffix" value=".jsp" />
</bean> 
```

这会将请求解析`/login`到`/WEB-INF/views/login.jsp`页面

# angularjs - AngularJS 为路由内部定义的控制器保留 $params 变量

> ID：12059956
> 
> 赞同：8
> 
> 时间：2012-08-21T17:24:17.113
> 
> 标签：angularjs

是否可以在 AngularJS 中定义的路由中传递您自己的变量？

我这样做的原因是因为我必须处理同一页面的数据表示（一个是根据 JSON 数据过滤的视图），我需要做的就是给 $params 数组一个布尔标志让控制器功能知道该页面是过滤的还是未过滤的。

像这样的东西：

```
var Ctrl = function($scope, $params) {
  if($params.filtered) {
    //make sure that the ID is there and use a different URL for the JSON data
  }
  else {
    //use the URL for JSON data that fetches all the data
  }
};

Ctrl.$inject = ['$scope', '$routeParams'];

angular.modlule('App', []).config(['$routeProvider', function($routes) {

  $routes.when('/full/page',{
    templateURL : 'page.html',
    controller : Ctrl
  });

  $routes.when('/full/page/with/:id',{
    templateURL : 'page.html',
    controller : Ctrl,
    params : {
      filtered : true
    }
  });

}]); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-22T06:04:26.090

根据[`$routeProvider`文档](https://docs.angularjs.org/api/ngRoute/provider/%24routeProvider)，具有属性的`route`参数：`$routeProvider.when()``resolve`

> 应注入控制器的可选依赖关系映射。

像这样的东西应该工作：

```
function Ctrl($scope, isFiltered) {
  if(isFiltered) {
    //make sure that the ID is there and use a different URL for the JSON data
  }
  else {
    //use the URL for JSON data that fetches all the data
  }
}
Ctrl.$inject = ['$scope', 'isFiltered'];

angular.modlule('App', []).config(['$routeProvider', function($routeProvider) {

  $routeProvider.when('/full/page',{
    templateURL: 'page.html',
    controller: Ctrl
  });

  $routeProvider.when('/full/page/with/:id',{
    templateURL: 'page.html',
    controller: Ctrl,
    resolve: {
      isFiltered: function() { return true; }
    }
  });

}]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T20:57:38.290

AFAIK 目前无法为路线指定其他参数。[话虽如此，如果 :id 被定义为$routeParams](http://docs.angularjs.org/api/ng.%24routeParams)的一部分，则可以通过测试轻松涵盖您的用例。

问题是 AngularJS 会在“/full/page”或“/full/page/with/:id”上匹配你的路由，所以只需在控制器中测试 $routeParams 是否存在 id：

`if ($routeParams.id)`

你会知道在哪种情况下你是。

另一种方法是对不同的路由使用不同的控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T12:20:04.280

这样的方法必须适用于过滤器：

```
function caseFilterCtrl($scope, $routeParams, $http) {
    $http.get('./data/myDatas.json').success( function(data){
                                        var arr = new Array();
                                        for(var i=0; i < data.length; i++){
                                            if(data[i].filter == $routeParams.id){
                                                arr.push(data[i]);                              }
                                            }
                                        $scope.filtered= arr;
                                        });
    }

 caseFilterCtrl.$inject = ['$scope', '$routeParams', '$http']; //for minified bug issue 
```

和路线：

```
angular.module('myFilterApp', []).
    config(['$routeProvider', function($routeProvider){ 
                $routeProvider.when('/filter/:id', {templateUrl: './view/partial/filter.html', controller: caseFilterCtrl});
                $routeProvider.otherwise({redirectTo: '/filter/01'});
            }
            ]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-01T14:10:20.573

您可以直接通过`$route.current.$$route`.

```
function Ctrl($scope, $route) {
  var filtered = $route.current.$$route.params.filtered;
}

angular.modlule('App', []).config(['$routeProvider', function($routeProvider) {

  $routeProvider.when('/full/page/with/:id',{
    templateURL: 'page.html',
    controller: Ctrl,
    params : {
      filtered : true
    }
  });

}]); 
```

虽然它有效，但我仍然更喜欢一个`resolve`解决方案。`params`（或您选择的任何名称）可能会在未来版本中被 angularjs 覆盖。

# unicode - 源应该发送什么字符串来消除他们正在使用的字节编码的歧义？

> ID：12059957
> 
> 赞同：5
> 
> 时间：2012-08-21T17:24:24.930
> 
> 标签：unicode, encoding, decoding

我正在将字节流解码为 un​​icode 字符，而不知道一百个左右的发送者中的每一个都使用的编码。

许多发件人在技术上并不精明，无法告诉我他们使用的是什么编码。这将取决于他们用来生成数据的工具链的偶然性。

目前，发件人都是基于英国/英语的，使用各种操作系统。

我可以要求所有发件人向我发送一个特定的字符串，该字符串将明确地展示每个发件人使用的编码吗？

我知道有些库使用启发式来猜测编码 - 我也将追究它，作为运行时后备，但首先我想尝试确定正在使用的编码，如果可以的话。

（不要认为它是相关的，但我正在使用 Python）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T06:18:32.447

这个问题的完整答案取决于许多因素，例如各种上游系统使用的编码范围，以及您的用户将如何遵守将魔术字符序列键入文本字段的说明，以及他们的熟练程度在晦涩的键盘组合中键入魔术字符序列。

有一些非常简单的字符序列，只有部分用户才能输入。只有使用西里尔文键盘和编码的用户会发现键入“Ильи́ч” (Ilyich) 很容易，因此您只需区分支持西里尔文的编码，如 UTF-8、UTF-16、iso8859_5 和 koi8_r。同样，您可以提出日语、中文和韩语字符序列，以区分日语、简体中文、繁体中文和韩语系统的用户。

但让我们专注于西欧计算机系统的用户，以及 ISO-8859-15、Mac_Roman、UTF-8、UTF-16LE 和 UTF-16BE 等常见编码。一个非常简单的测试是让用户输入欧元字符“€”，U+20AC，然后查看生成的字节序列：

*   byte ['\xa4'] 表示 iso-8859-15 编码
*   bytes ['\xe2', '\x82', '\xac'] 表示 utf-8 编码
*   bytes ['\x00', '\xac'] 表示 utf-16be 编码
*   bytes ['\xac', '\x00'] 表示 utf-16le 编码
*   byte ['\x80'] 表示 cp1252 ("Windows ANSI") 编码
*   byte ['\xdb'] 表示宏编码
*   iso-8859-1 根本无法代表欧元字符。iso-8859-15 是 iso-8859-1 的支持欧洲的继任者。
*   美国用户可能不知道如何输入欧元字符。（好吧，这太刻薄了。3% 的人会知道。）

您应该检查这些字节序列中的每一个（解释为任何可能的编码）不是用户可能自己键入的字符序列。例如，iso-8859-15 Euro 符号的 '\xa4' 也可以是 '¤' 的 iso-8859-1 或 cp1252 或 UTF-16le 编码，'§' 的宏编码，或第一个字节数千个 UTF-16 字符中的任何一个，例如 U+A4xx Yi 音节或 U+01A4 LATIN SMALL LETTER OI。它不是 UTF-8 序列的有效第一个字节。如果您的一些用户在 Yi 中提交文本，您可能会遇到问题。

[Python 3.x 文档，](http://docs.python.org/3/library/codecs.html#standard-encodings) *7.2.3 [*。*](http://docs.python.org/3/library/codecs.html#standard-encodings)[*Standard Encodings*](http://docs.python.org/3/library/codecs.html#standard-encodings)列出了 Python 标准库可以轻松处理的字符编码。以下程序可让您了解测试字符序列如何通过各种编码方式编码为字节：*

 *```
>>> for e in ['iso-8859-1','iso-8859-15', 'utf-8', 'utf-16be', 'utf-16le', \
... 'cp1252', 'macroman']:
...     print e, list( euro.encode(e, 'backslashreplace')) 
```

因此，作为一种权宜之计，令人满意的技巧，如果编码有任何问题，请考虑告诉您的用户输入“€”作为文本字段的第一个字符。然后您的系统应该将上述任何字节序列解释为编码线索，并丢弃它们。如果用户想以欧元字符开始他们的文本内容，他们以“€€”开始字段；第一个被吞下，第二个仍然是文本的一部分。*

# javascript - 获取 cookie 的单值 javascript

> ID：12059958
> 
> 赞同：1
> 
> 时间：2012-08-21T17:24:24.753
> 
> 标签：javascript, cookies

我已经有一个检查 cookie 存在的脚本，但我需要它来获取 cookie 值，所以我可以在这样的 url 中使用它：

```
var lang = cookievalue;
location.replace(window.location.protocol+"//"+document.domain+"/"+cookievalue+window.location.pathname); 
```

那么通过javascript简单地获取cookie值的最简单方法是什么，我寻找的一切似乎都涉及拆分值和东西，这不是必需的，因为只有一个值（en，fr，es ETC）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T17:26:35.813

```
function getCookieValue(key) {
  var cookies = document.cookie.split('; ');
  for (var i = 0, parts; (parts = cookies[i] && cookies[i].split('=')); i++) {
    if (decode(parts.shift()) === key) {
      return decode(parts.join('='));
    }
  }
  return null;
}

function decode(s) {
  return decodeURIComponent(s.replace(/\+/g, ' '));
} 
```

然后，要获取名为 cookie 的值`my_cookie_name`，您可以使用`getCookieValue('my_cookie_name')`.

作为**替代方案**，您可以使用该[`jquery-cookie`](https://github.com/carhartl/jquery-cookie)插件。它使用起来非常简单 ( `$.cookie('my_cookie_name')`) 且轻量级。

# iphone - 为什么我看不到 iPod 的任何控制台日志？

> ID：12059959
> 
> 赞同：0
> 
> 时间：2012-08-21T17:24:41.743
> 
> 标签：iphone, ios, xcode, console, ipod-touch

我的 iPod touch 已连接到我的 Mac。我想查看 iPod 的控制台日志。

我连接了 xCode 和 console.app。

为什么我看不到控制台日志？![在此处输入图像描述](../Images/e951989eb4948fad694c10d3df5ccbb1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:35:35.933

黄灯表示 Xcode 没有将您的 iPod 识别为开发设备。在这种情况下，应该有一个“用于开发”按钮。

# javascript - window.onbeforeunload 提交表单

> ID：12059961
> 
> 赞同：1
> 
> 时间：2012-08-21T17:24:53.847
> 
> 标签：javascript, jquery

我正在使用 Facebook 的共享功能，目前它已设置为在私人计算机上使用。意思是，一旦这个人分享了一些东西，他们仍然会登录。

我遇到的问题是，一旦用户单击共享，它就会立即关闭窗口。

我希望使用`window.onbeforeunload`. 我正在尝试在窗口关闭之前运行此代码。我认为做这样的事情可以让它发挥作用。虽然没有任何运气。

```
 window.onbeforeunload = function() {
  $('#logout_form').submit();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:38:51.280

在处理程序期间您**唯一**可以可靠地做的`onbeforeonload`是决定是否弹出确认对话框。您不能从此类处理程序触发新操作，例如提交表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T17:48:46.560

黄昏是正确的，你不能提交表格。但有些事情你可以做。我使用了 Atmosphere，它在卸载时进行了 ajax 调用。

```
jQuery(window).unload(function() {
    jQuery.atmosphere.unsubscribe();
}); 
```

发出请求调用。您应该能够向服务器发布 ajax 帖子。

我发现了一个类似的例子： [Ajax post onbeforeunload doesn't work](https://stackoverflow.com/questions/10665912/ajax-post-onbeforeunload-doesnt-work)

# css - 带有渐变背景的 IE8 中的表格标题边框消失

> ID：12059964
> 
> 赞同：4
> 
> 时间：2012-08-21T17:25:14.597
> 
> 标签：css, internet-explorer-8, border, css-tables

我的表格在 IE8 中引起了问题。我无法让表格标题中的分隔边框出现在渐变上方（除了在一个位置，您可以在下图中看到）。边框在所有其他浏览器中都很好，甚至在 IE8 兼容模式下也是如此。有想法该怎么解决这个吗？ [这里](http://inspecttech.com/mockup/gridview.html)是一个测试站点，供大家查看应用代码。

![IE8和IE8兼容模式下表格标题边框对比](../Images/752b0e7b3c69961bee9733f1e86d62f4.png)

[这是表头的 CSS，但您可以在此处](http://inspecttech.com/mockup/inspecttech_styles.css)查看整个 CSS 文件：

```
.gridview th {
    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjxsaW5lYXJHcmFkaWVudCBpZD0iaGF0MCIgZ3JhZGllbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHgxPSI1MCUiIHkxPSIxMDAlIiB4Mj0iNTAlIiB5Mj0iLTEuNDIxMDg1NDcxNTIwMmUtMTQlIj4KPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwNTM4MyIgc3RvcC1vcGFjaXR5PSIxIi8+CjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzhmZDlmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgIDwvbGluZWFyR3JhZGllbnQ+Cgo8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0idXJsKCNoYXQwKSIgLz4KPC9zdmc+);
    background-image: -webkit-linear-gradient(90deg, #005383 0%, #90d9ff 100%);
    background-image: -moz-linear-gradient(90deg, #005383 0%, #90d9ff 100%);
    background-image: -o-linear-gradient(90deg, #005383 0%, #90d9ff 100%);
    background-image: -ms-linear-gradient(90deg, #005383 0%, #90d9ff 100%);
    background-image: linear-gradient(90deg, #005383 0%, #90d9ff 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#90d9ff, endColorstr=#005383);
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#90d9ff, endColorstr=#005383)";
    background-color: #005383;
    line-height: 18px;
    vertical-align: top;
    padding: 4px;
    font-weight: bold;
    text-align: center;
    border-left: 1px solid #005580;
    color: #fff;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:20:23.587

我尝试解决您的问题，但无法解决。我看到这发生在 IE8 和 IE9 文档和浏览器模式下。然而，不在 IE 7 中。但是当只使用

```
 background-image: url(data:image/.......); 
```

边框在 IE9 中工作......只剩下 IE 8 来解决。您可以使用 IE7 和 IE9 特定的条件注释a 来使用上面的代码（对于 IE9）和

```
filter: progid:DXImageTransform.Microsoft 
```

对于 IE7。关于IE8中的问题，这里有一个类似的帖子：

[在 IE8 中应用 css 渐变过滤器时表格单元格失去边框](https://stackoverflow.com/questions/3465346/table-cell-loses-border-when-css-gradient-filter-is-applied-in-ie8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T20:00:41.753

我找到了一个修复程序，但我对它不是很满意，因为它不再是有效的 HTML……但这似乎解决了旧版本 IE 中的问题：

```
<!--[if !IE]> -->
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- <![endif]--> 
```

我把这个给我的老板看，他不同意，所以我还在寻找解决方案！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T11:32:24.630

将此添加到我的 css 对我来说是一个解决方案：

```
table {
   border-collapse: separate;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-10T16:13:58.190

我搜索过的解决方案都没有奏效。对于 IE8，背景颜色仅适用于正文表行。每当我为标题行或标题列使用背景颜色时，边框就会消失。

对我有用的是为表格本身定义背景颜色。标题没有背景颜色。每个正文表行都需要定义背景颜色以覆盖表上定义的颜色（如果需要）。

# oracle - JPA 和 Hibernate NamedQuery 错误：列表中的最大表达式数为 1000

> ID：12059967
> 
> 赞同：0
> 
> 时间：2012-08-21T17:25:44.417
> 
> 标签：oracle, hibernate, jpa

当“in”表达式之一具有 1000 个或更多项目时，我有以下 Hibernate NamedQuery 会遇到问题。当我在 (:devices) 的 ma.deviceId 中有 1000 个或更多项目时，我得到*java.sql.SQLException: ORA-01795: maximum number of expressions in a list is 1000*

我需要处理的唯一“in”表达式是“and ma.deviceId in (:devices)”。有人对如何重写这个 NamedQuery 有任何想法吗？我正在使用 JPA 和休眠。

```
@NamedQuery(name = "Messages.findMessages", query = " SELECT ma from Messages ma JOIN FETCH ma.messagePayLoadXml mx LEFT OUTER JOIN FETCH ma.messageProperties  mp " +
                  " WHERE ma.customerId = :customerId and ma.time >= :startTime and ma.time <= :endTime " +
                  " and ma.deviceId in (:devices) and  mx.messageType = 'XML' and mx.alerts in " +
                  " ( select mtfm.messageType from MessageTypeFeatureMap mtfm where mtfm.feature in (:featureType) ) " +
                  " and ma.messageKey = mx.messageKey and ( mp.deleted = 0 or mp.deleted is null ) " +
                  " order by ma.time desc " ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:37:07.210

有2种方式。
1）将您的列表存储在中间表中并执行
`... IN (SELECT ... FROM intermediaryTable)`
2）将您的列表分成子列表，每个子列表最多 1000 个元素并将您的查询写为
`(... IN (subList1) OR ... IN (subList2) ...)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T17:45:48.633

对于我们的应用程序，我们针对这种情况做了一个简单的修复......

```
 If number of values are greater than 999
      QUERY = SELECT + FROM + WHERE + COND1 +
              ( FIELD IN ( 999 values ) OR FIELD IN ( 999 values )...)  + ORDER
 Else
      QUERY = SELECT + FROM + WHERE + COND1 + IN (...) + ORDER 
```

# c# - 如何允许插件通过公共属性公开 WPF 或 WindowsForms 控件？

> ID：12059968
> 
> 赞同：2
> 
> 时间：2012-08-21T17:25:43.817
> 
> 标签：c#, wpf, winforms, .net-4.0

我目前正在开发一个允许使用插件的应用程序。其中一项功能是该插件可以公开一个设置 UI，托管应用程序将嵌入某处供用户查看。

我想知道是否有某种方法可以向我的插件界面添加一个属性，以允许插件开发人员创建 wpf 或 winforms UI 并通过此属性公开它，同时保持属性类型化？（即不使用“对象”作为属性类型），或不使用单独的属性（即 WPFUI、WinFormsUI）等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T17:30:46.813

这两种技术的工作方式非常不同。我建议公开[Windows.Forms.Control](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx)或[FrameworkElement](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.aspx)，但不要同时公开（至少不是来自*同一个*插件 API）。

如果您公开 a `Control`，则使用[E​​lementHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost%28v=vs.100%29.aspx)提供 WPF 控件很简单。同样，a`FrameworkElement`可以由 Windows 窗体插件通过[WindowsFormsHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost%28v=vs.100%29.aspx)提供。

我在这里的决定将更多地取决于主机应用程序的开发方式。如果您使用的是 WPF，我强烈建议您将插件公开为`FrameworkElement`.，因为这为您提供了更多的灵活性。如果您的主应用程序将基于 Windows 窗体，那么仅公开 a 就很`Control`简单。

如果您不希望这种增加的复杂性，我实际上会推荐两个单独的 API - 一个用于 Windows 窗体用户，一个用于 WPF 用户，因为这使最终用户部分的简单性保持不变。根据插件机制，这通常很容易提供。

# oracle - 使用 SQLAlchemy 0.7.8 和 Oracle XE 生成“错误”类型

> ID：12059970
> 
> 赞同：4
> 
> 时间：2012-08-21T17:25:51.147
> 
> 标签：oracle, oracle11g, sqlalchemy

谁能告诉我为什么下面的 DateTime 类型会创建一个“DATE”对象而不是 DateTime（或更恰当地说，是一个 TIMESTAMP 类型），因为我必须强制如下行中的类型：

```
#!/bin/python

import sqlalchemy

from sqlalchemy import Column, Integer, String, DateTime, Index, MetaData
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import relationship
from sqlalchemy.orm import sessionmaker
from sqlalchemy.dialects import oracle

Base = declarative_base()

import logging

logging.basicConfig()
logging.getLogger('sqlalchemy.engine').setLevel(logging.INFO)

class TypeTest(Base):
    __tablename__ = "TYPETESTZ"
    thisisinteger = Column(Integer, primary_key = True)
    thisisnotadatetime = Column(DateTime)
    thisisdatetime = Column(oracle.TIMESTAMP)    

if __name__ == "__main__":
    engine = sqlalchemy.create_engine('oracle://richard:password@xe')
    metadata = Base.metadata
    metadata.create_all(engine) 
```

日志输出：

```
INFO:sqlalchemy.engine.base.Engine:SELECT USER FROM DUAL
INFO:sqlalchemy.engine.base.Engine:{}
INFO:sqlalchemy.engine.base.Engine:SELECT table_name FROM all_tables WHERE table_name = :name AND owner = :schema_name
INFO:sqlalchemy.engine.base.Engine:{'name': u'TYPETESTZ', 'schema_name': u'RICHARD'}
INFO:sqlalchemy.engine.base.Engine:
CREATE TABLE "TYPETESTZ" (
    thisisinteger INTEGER NOT NULL, 
    thisisnotadatetime DATE, 
    thisisdatetime TIMESTAMP, 
    PRIMARY KEY (thisisinteger)
)

INFO:sqlalchemy.engine.base.Engine:{}
INFO:sqlalchemy.engine.base.Engine:COMMIT 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T17:33:42.940

Oracle 没有`DateTime`数据类型。在 Oracle 中，a`Date`包含日期（即 2012 年 8 月 21 日）和时间（即下午 1:30），粒度为 1 秒。A `Timestamp`，没有其他限定符，仅允许您将粒度增加到纳秒（10^-9 秒）。`DateTime`SQLAlchemy 将 a转换为 Oracle似乎是合理的，`Date`除非有一些要求`DateTime`支持小数秒（在这种情况下您需要 a `Timestamp`）或时区（在这种情况下您需要 a `Timestamp with [local] time zone`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T22:15:26.103

要创建一个`TIMESTAMP`对象，您可能想要`Time`使用

```
from sqlalchemy import Column, Integer, String, Time, Index, MetaData 
```

虽然，只有在设置为时， `DateTime`in`sqlalchemy`才会获得带有 TIMEZONE 的 TIMESTAMP 。默认为。`TIMEZONE``TRUE``FALSE`

> 类 sqlalchemy.types.DateTime(timezone= **False** )
> 
> **init** (timezone=False) 构造一个新的 DateTime。
> 
> 参数：时区 - 布尔值。如果为 True，并且受后端支持，将生成“TIMESTAMP WITH TIMEZONE”。对于不支持时区感知时间戳的后端，无效。

设置`timezone=True`应该可以工作，因为 Oracle 确实支持带时区的时间戳，所以您可能必须设置它。

# sharepoint - 是否可以完全自定义共享点？

> ID：12059971
> 
> 赞同：0
> 
> 时间：2012-08-21T17:25:54.940
> 
> 标签：sharepoint

好吧，我收到了一份将 Sharepoint 完全定制为一个简单网站的工作，但是我在谷歌上找到的所有信息都没有帮助，我不知道有谁使用过这个，我以前从未见过这些标签，比如因为，所以我需要一些关于完全定制的信息，这可能吗？我从哪里开始？我已经安装了 sharepoint 2010 并添加了网站，但什么也做不了。

不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:31:19.560

看这里，我想你可以在那里找到答案[http://idratherbewriting.com/2008/06/21/customizing-your-sharepoint-site-read-these-10-conceptsgotchas-first/](http://idratherbewriting.com/2008/06/21/customizing-your-sharepoint-site-read-these-10-conceptsgotchas-first/)

# android - google+ 是如何实现这种布局的？

> ID：12059980
> 
> 赞同：4
> 
> 时间：2012-08-21T17:26:14.207
> 
> 标签：android, google-plus

Android 上的 Google+ 如何实现这种同时显示多个项目的水平滚动。

同样对于内存使用，他们将如何销毁屏幕外的东西并在它越来越接近屏幕时构建它？

我想创建类似的东西，但只能使用可点击的位图。

![在此处输入图像描述](../Images/a3580a3e0bbef1eed0b359b51a14da69.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:45:52.787

我的猜测是他们`Fragments`与其他`Adapters`.

这里是`Fragment`信息：http: [//developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

就像其他人提到的那样，他们可能使用了一些适配器视图，以及可滚动的。

# advantage-database-server - sp_RestoreDatabase 和 ADSSYS 密码

> ID：12059983
> 
> 赞同：3
> 
> 时间：2012-08-21T17:26:33.863
> 
> 标签：advantage-database-server

要使用过程 SP_RESTOREDATABASE 或 AdsBackup 实用程序恢复数据库，您需要提供 ADSSYS 密码作为参数。我们已使用加密保护我们的数据库，并且访问权限仅限于特定用户。但是任何使用 Data Architect 的人都可以在远程服务器信息/优势管理实用程序下的活动查询选项卡中进行恢复时检索 ADSSYS 密码。密码显示为明文。如果启用了查询日志记录，我想它也可以在日志中使用。

有没有办法阻止查询显示在日志或活动查询窗口中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T21:24:55.747

您应该使用参数化查询。在这种情况下，参数值将不可见：

```
execute procedure sp_restoredatabase( :backuploc, :password, :restoreloc, null ); 
```

然后提供参数的值`backuploc, password, and restoreloc`。

另请注意，v11.0 通常会限制该信息的可见性。它需要一个 DB:Admin 连接到一个字典，以便查看在该字典上执行的任何语句。

# java - SharedPreferences PreferenceManager 崩溃

> ID：12059985
> 
> 赞同：0
> 
> 时间：2012-08-21T17:26:34.910
> 
> 标签：java, android, sharedpreferences

我是 Java 开发新手。我正在制作一个使用 SharedPreferences 的应用程序。我使用的具体教程是这样的：
[http](http://blog.donnfelker.com/2011/02/17/android-a-simple-eula-for-your-android-apps/)
://blog.donnfelker.com/2011/02/17/android-a-simple-eula-for-your-android-apps/ 我对代码做了一些修改，但是它给了我一个错误：

```
public class SimpleEula extends Application {
    private String EULA_PREFIX = "eula";
    public Activity mActivity;

    public SimpleEula(Activity context) {
        mActivity = context;
    }

    public void showEula() {
        SharedPreferences sh_showEula;
        final String eulaKey = EULA_PREFIX;
        final SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(mActivity);
        ... 
```

我在每一行之后记录我的代码，我的应用程序在以下位置崩溃：

```
 final SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(mActivity); 
```

即使我将行更改为：

```
 final SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this); 
```

我仍然会崩溃。我不知道问题是什么。有人可以帮助我吗？

在此先感谢

**编辑：**
这些是 LogCat 中的错误：

```
08-21 20:44:58.905: E/AndroidRuntime(610): FATAL EXCEPTION: main
08-21 20:44:58.905: E/AndroidRuntime(610): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.test.test/com.test.test.MainActivity}: java.lang.NullPointerException
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.os.Looper.loop(Looper.java:137)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread.main(ActivityThread.java:4424)
08-21 20:44:58.905: E/AndroidRuntime(610):  at java.lang.reflect.Method.invokeNative(Native Method)
08-21 20:44:58.905: E/AndroidRuntime(610):  at java.lang.reflect.Method.invoke(Method.java:511)
08-21 20:44:58.905: E/AndroidRuntime(610):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-21 20:44:58.905: E/AndroidRuntime(610):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-21 20:44:58.905: E/AndroidRuntime(610):  at dalvik.system.NativeStart.main(Native Method)
08-21 20:44:58.905: E/AndroidRuntime(610): Caused by: java.lang.NullPointerException
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.preference.PreferenceManager.getDefaultSharedPreferencesName(PreferenceManager.java:371)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.preference.PreferenceManager.getDefaultSharedPreferences(PreferenceManager.java:366)
08-21 20:44:58.905: E/AndroidRuntime(610):  at com.test.test.SimpleEula.show(SimpleEula.java:23)
08-21 20:44:58.905: E/AndroidRuntime(610):  at com.test.test.MainActivity.onCreate(MainActivity.java:26)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.Activity.performCreate(Activity.java:4465)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
08-21 20:44:58.905: E/AndroidRuntime(610):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
08-21 20:44:58.905: E/AndroidRuntime(610):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:37:56.417

最好尝试使用`getApplicationContext()`应用程序类，

```
SharedPreferences prefs = PreferenceManager.
                                   getDefaultSharedPreferences(getApplicationContext()); 
```

我做什么，

```
public class SimpleEula extends Application {
    private Context mContext;

    @Override
    public void onCreate() {
        super.onCreate();

        mContext = this; // use this mContext
    }

    public void showEula() {
          SharedPreferences prefs = PreferenceManager.
                                   getDefaultSharedPreferences(mContext);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T10:52:22.987

NullPointerExepter 是由扩展 Activity 或 Application 类引起的。此代码有效：

```
public class SimpleEula {

    private String EULA_PREFIX = "eula";
    private Activity mActivity;

    public SimpleEula(Activity context) {
        mActivity = context;
    }

    public void show() {
        final String eulaKey = EULA_PREFIX;
        final SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(mActivity);
            ... 
```

现在它起作用了。感谢大家的帮助

# xserver - 在 GVim 中映射控制键 和 i_ctrl_v

> ID：12059990
> 
> 赞同：7
> 
> 时间：2012-08-21T17:26:48.790
> 
> 标签：xserver, vim, xmodmap

我有一个问题，我已经在 X 服务器级别解决了（顺便说一句：我正在运行 Ubuntu 12.04），但在 GVim 中没有。

我有一个带有字母的德语键盘布局，`ö`以及在 qwerty 键盘上的`ä`位置`[`和位置。`]`但现在我想更改 vim 的正常模式映射，以便我可以分别键入`ö`和`Ctrl`+ `ö`，就好像它是`[`和`CTRL`+一样`[`。`Ctrl`所以我创建了一个 xmodmap 文件并将+映射`ö`到`CTRL`+ `[`。现在 xserver 表现出正确的响应（例如，当我将`Ctrl`+映射`ö`到`Ctrl`+时，`u`我可以擦除 中的当前行`xterm`）。

但不知何故，这在 gVim 中不起作用，据我所知，gVim 帮助它`Ctrl`以一种特殊的方式处理像 +something 这样的转义序列（例如，插入模式下的`Ctrl`+与 中的行为形成对比）。但我不明白如何解决这个问题。谁能帮我？`ö``ö``xterm`

### 编辑：

我注意到当我在终端仿真器（即）中运行 Vim 时它*确实*`guake`有效，但在 GVim（我想开始工作）中却没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T15:45:09.713

如果我理解正确，请尝试使用如下`langmap`选项：

```
:set langmap=ö[,ä] 
```

# powershell - Powershell 和 NCover

> ID：12059998
> 
> 赞同：0
> 
> 时间：2012-08-21T17:27:19.433
> 
> 标签：powershell, ncover

试图从 PowerShell 调用 NCover 1.5.8。

```
invoke-expression "ncover.console.exe nunit-console-x86.exe Test.dll /labels /xml:test.xml //x coverage.xml //reg" 
```

并失败并显示消息“已分析的​​进程已终止。未建立 Profiler 连接。”。

如果从 cmd 控制台调用，

```
ncover.console.exe nunit-console-x86.exe Test.dll /labels /xml:test.xml //x coverage.xml //reg 
```

将成功运行。

powershell 中 NCover 的 //reg 开关有什么不同吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T17:44:19.113

首先，您不需要使用`Invoke-Expression`. 在 powershell 中，尝试以与 cmd 中完全相同的方式调用

```
ncover.console.exe nunit-console-x86.exe Test.dll /labels /xml:test.xml //x coverage.xml //reg 
```

如果您遇到相同的错误，是否可以暂时使用 cmd？

```
cmd.exe /c ncover.console.exe nunit-console-x86.exe Test.dll /labels /xml:test.xml //x coverage.xml //reg 
```