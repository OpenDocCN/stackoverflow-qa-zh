# StackOverflow 问答 10999000-10999999

# ruby-on-rails - rails 3中静态页面的子域

> ID：10999001
> 
> 赞同：2
> 
> 时间：2012-06-12T14:41:34.423
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个 Rails 3 应用程序，它需要有指向我的代码库中的静态页面的子域

例子：

**mk1.mysite.com**需要显示所在页面

**应用 > 视图 > 关于 > page.html.haml**

该页面位于**mysite.com/about/page.html**

问题：

如何通过访问子域 ( **mk1.mysite.com ) 配置路由以显示子目录 (** **mysite.com/about/page.html** ) 页面？

 **我的 routes.rb 中有这个

```
match '/' => 'about/page.html', :constraints => { :subdomain => 'mk1' } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:22:40.630

您的常规根路由在您的路由文件中的什么位置？它位于您在帖子中列出的行之前还是之后？

所以如果你有一条线

```
root :to => "foo#index" 
```

在您的路线文件中，上面

```
match '/' => 'about/page.html', :constraints => { :subdomain => 'mk1' } 
```

将首先调用根路由，而不会调用您的子域路由。**

# php - CakePHP 2.0 Jquery 自动完成/自动提示

> ID：10999005
> 
> 赞同：3
> 
> 时间：2012-06-12T14:41:49.493
> 
> 标签：php, jquery, cakephp, autocomplete, autosuggest

我是 Cake 和 Ajax/Jquery 的新手。

我试图让自动完成/自动提示在 CakePHP 2.0 中工作，但我发现的一切要么适用于 1.3，要么根本不适用于 Cake，我不知道该怎么做才能让它正常工作。

有人可以指出我正确的方向吗？

# hibernate - 使用 Hibernate 的 Spring Web Flow

> ID：10999008
> 
> 赞同：0
> 
> 时间：2012-06-12T14:41:54.597
> 
> 标签：hibernate, maven-3, spring-webflow

经过长时间的谷歌搜索后，我无法找到任何带有休眠示例示例的 Spring Web 流程。任何人都可以帮助我使用简单的 Spring Web 流程示例。我需要使用 Spring Web 流程创建一个登录表单。现在我仍然熟悉Spring web flow。如果任何示例应用程序（例如使用 Hibernate 连接到数据库的登录表单）都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T12:33:50.053

如果您找不到示例代码并不太难设置，SWF 只是一个控制器，并且在 Spring MVC 中注册为具有更多属性的控制器：

```
<!-- Creates a flow executor in Spring, responsible for creating and executing flows -->
<flow:flow-executor id="flowExecutor" flow-registry="flowRegistry" />

<!-- Load flow definitions and make them available to the flow executor -->
<flow:flow-registry id="flowRegistry">
    <flow:flow-location id="process-flow" path="/process/flows/process-flow.xml" />
</flow:flow-registry>

<!-- The FlowHandlerMapping helps DispatcherServlet to knowing that it should send flow requests to Spring Web Flow -->
<bean class="org.springframework.webflow.mvc.servlet.FlowHandlerMapping">
    <property name="flowRegistry" ref="flowRegistry" />
</bean>

<!-- The FlowHandlerAdapter is equivalent to a Spring MVC controller in that it handles requests coming in for a flow and processes those requests -->
<bean class="org.springframework.webflow.mvc.servlet.FlowHandlerAdapter">
    <property name="flowExecutor" ref="flowExecutor" />
</bean> 
```

一旦你有了，你只需要像使用任何其他 MVC 应用程序一样使用 Hibernate。也许您会对使用 FlowScoped PersistenceContext 感兴趣，它使 SWF 能够管理您的域对象 (http://static.springsource.org/spring-webflow/docs/2.3.x/reference/html/ch07s02.html)。

考虑阅读 SWF 官方文档 (http://static.springsource.org/spring-webflow/docs/2.3.x/reference/html/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T12:15:51.827

集成 Hibernate 和 Spring Web 流并非难事。它与 Spring MVC 相同。只需编写 Hibernate 配置文件。调用服务层，在服务层调用相应的 DAO。DAO 将与数据库交互的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-24T19:58:17.243

您需要正常配置休眠属性（使用引用表的 @ 注释等）。不要忘记在您的 DAO 中添加“@Service”注释。之后，您只需要转到控制您的流程的 xml 文件，并添加 DAO 的功能。

# android - android中的自定义地图

> ID：10999009
> 
> 赞同：0
> 
> 时间：2012-06-12T14:41:54.610
> 
> 标签：android, map

是否可以在不使用谷歌地图的情况下在 android 中绘制地图。请提出一些相同的好例子。任何形式的帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T14:55:12.817

您可以使用[地图任务](http://developer.mapquest.com/web/products/featured/android-maps-api)和[必应地图](http://bingmapsandroidsdk.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:50:32.720

你真正想做的是什么？这总是可能的，但您可以根据需要使用另一个视图并管理您自己的手势检测器，而不是使用本机 android mapview。

# string - 使用雅虎管道计算字符串的长度

> ID：10999015
> 
> 赞同：1
> 
> 时间：2012-06-12T14:42:05.300
> 
> 标签：string, replace, substring, yahoo-pipes

我正在使用雅虎管道从包括谷歌在内的各种来源获取文章，但是来自谷歌的文章在描述中包含标题和标题来源，雅虎管道中有没有办法删除标题和来源并保留文章的其余部分完好无损。我尝试使用子字符串，但是它需要每个文章可变的字符串长度。我想如果有办法计算标题和来源的长度并将其传递给子字符串模块，这可能会起作用。

任何帮助都会很棒。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T04:22:03.110

看看[http://pipes.yahoo.com/pipes/pipe.info?_id=8KZMRx473hGtVMYsP27D0g](http://pipes.yahoo.com/pipes/pipe.info?_id=8KZMRx473hGtVMYsP27D0g)，它可以用作子管道（即在循环内）来计算字符串的长度。添加第二个文本输入模块并修改管道以适应您的第二个文本字符串应该相对简单。

# java - 无法在java中执行cmd文件

> ID：10999018
> 
> 赞同：0
> 
> 时间：2012-06-12T14:42:19.137
> 
> 标签：java, processbuilder

我必须执行一个`xyz.cmd`目录中的文件`E:/abc`。所以要执行的文件的绝对路径是`E:/abc/xyz.cmd`. 执行时，文件本身会创建一个新窗口。

我的代码片段是：-

```
String path = “E:\\abc”;
String cmd = path + “\\xyz.cmd”;
ProcessBuilder processBuilder = new ProcessBuilder(cmd);
processBuilder.redirectErrorStream(true);
processBuilder.directory(new File(path));
processBuilder.start(); 
```

这不起作用，但没有给出错误或异常。但是 cmd 文件工作正常，可以使用资源管理器或 cmd-prompt 从其目录手动执行。尝试使用不同版本的jdk，但徒劳无功。我正在使用 Windows 7 操作系统。我也没有看到任务管理器中正在运行的进程。知道出了什么问题吗？相同的代码在具有相同配置的不同计算机上运行良好。

===编辑==== 这可能是一个安全问题吗？像执行程序的用户没有足够的权限来执行文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T14:48:40.283

您需要调用`cmd.exe`进程构建器字符串的第一部分，以便命令处理器能够调用 .cmd 文件。这也适用于 .bat 文件或任何操作系统类型的命令。例如，请看[这里](https://stackoverflow.com/questions/8890414/how-to-invoke-a-cmd-file-in-java-correctly-on-windows)。

另外，请看这里：[当 Runtime.exec() 不会](http://www.javaworld.com/jw-12-2000/jw-1229-traps.html)

**编辑**
你状态：

> 请理解，这不是没有在processbuilder中添加cmd.exe的问题；由于前面的命令， cmd.exe 将得到照顾。

到目前为止，我在您的帖子中没有看到任何文档证明这是真的，而且我的所有经验都强烈表明并非如此。

你还说：

> 这可能是一个安全问题吗？像执行程序的用户没有足够的权限来执行文件？

除非您捕获并显示进程的输入流，否则无法知道。事实上，如果你不捕获这个流，你可能会阻止你的进程运行。通常我们还必须捕获错误流，但是您已经将它们与

```
processBuilder.redirectErrorStream(true) 
```

请阅读我上面的“When Runtime.exec() won't”链接，了解更多关于捕获流的必要性。

# iphone - 如何在使用 MPMoviePlayerController 开始播放视频之前使用活动指示器？

> ID：10999019
> 
> 赞同：2
> 
> 时间：2012-06-12T14:42:19.587
> 
> 标签：iphone, mpmovieplayercontroller, uiactivityindicatorview

我需要使用 MPMoviePlayerController 在我的 UIViewcontroller 中播放视频。因此，在播放视频之前，我需要在视频缓冲之前显示一个活动指示器视图。视频开始播放后，我需要删除活动指示器。我不知道如何在视频开始播放后立即收到通知。对此的任何建议都会有很大帮助。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T14:49:36.760

您可能正在寻找这样的东西：

```
- (void)viewDidAppear:(BOOL)animated {
    NSLog(@"VIEW DID LOAD");
    // Register to receive a notification that the movie is now in memory and ready to play
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(movieLoadStateDidChange:)
                                                 name:MPMoviePlayerLoadStateDidChangeNotification
                                               object:nil];

}

-(void)movieLoadStateDidChange:(id)sender{
    NSLog(@"STATE CHANGED");
    if(MPMovieLoadStatePlaythroughOK ) {
        NSLog(@"State is Playable OK");
        NSLog(@"Enough data has been buffered for playback to continue uninterrupted..");
        aiv.hidden = YES;
        [aiv stopAnimating];
    }

} 
```

我还发现从这个链接也可以帮助你：[http ://www.sdkboy.com/?p=48](http://www.sdkboy.com/?p=48)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-29T13:32:09.933

if(MPMovieLoadStatePlaythroughOK) { - 此检查不正确。它总是正确的。

看一看： [UIActivityIndi​​cator 可以在全屏模式下显示在 MPMoviePlayerController 上吗？](https://stackoverflow.com/questions/3799299/can-a-uiactivityindicator-be-displayed-over-a-mpmovieplayercontroller-in-full-sc)

# python - 如何使用 Python 将 GMT 时间转换为 EST 时间

> ID：10999021
> 
> 赞同：16
> 
> 时间：2012-06-12T14:42:23.037
> 
> 标签：python, datetime, timestamp, timezone

我想将 GMT 时间转换为 EST 时间并获得时间戳。我尝试了以下但不知道如何设置时区。

```
time = "Tue, 12 Jun 2012 14:03:10 GMT"
timestamp2 = time.mktime(time.strptime(time, '%a, %d %b %Y %H:%M:%S GMT')) 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-12T14:47:25.597

时区没有内置在标准 Python 中——您需要使用另一个库。[pytz](http://pytz.sourceforge.net/)是一个不错的选择。

```
>>> gmt = pytz.timezone('GMT')
>>> eastern = pytz.timezone('US/Eastern')
>>> time = "Tue, 12 Jun 2012 14:03:10 GMT"
>>> date = datetime.datetime.strptime(time, '%a, %d %b %Y %H:%M:%S GMT')
>>> date
datetime.datetime(2012, 6, 12, 14, 3, 10)
>>> dategmt = gmt.localize(date)
>>> dategmt
datetime.datetime(2012, 6, 12, 14, 3, 10, tzinfo=<StaticTzInfo 'GMT'>)
>>> dateeastern = dategmt.astimezone(eastern)
>>> dateeastern
datetime.datetime(2012, 6, 12, 10, 3, 10, tzinfo=<DstTzInfo 'US/Eastern' EDT-1 day, 20:00:00 DST>) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-12T14:58:03.980

使用[pytz](http://pytz.sourceforge.net/)

```
from datetime import datetime
from pytz import timezone
fmt = "%Y-%m-%d %H:%M:%S %Z%z"
now_time = datetime.now(timezone('US/Eastern'))
print now_time.strftime(fmt) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-08-25T09:33:15.467

在**Python 3.9**中，时区处理通过[**zoneinfo**](https://docs.python.org/3/library/zoneinfo.html)模块内置到标准库中（对于较旧的 Python 版本，`zoneinfo`通过[backports.zoneinfo](https://github.com/pganssle/zoneinfo)使用）。

***前任：***

```
from zoneinfo import ZoneInfo
from datetime import datetime, timezone

time = "Tue, 12 Jun 2012 14:03:10 GMT"

# parse to datetime, using %Z for the time zone abbreviation
dtobj = datetime.strptime(time, '%a, %d %b %Y %H:%M:%S %Z')

# note that "GMT" (=UTC) is ignored:
# datetime.datetime(2012, 6, 12, 14, 3, 10)

# ...so let's correct that:
dtobj = dtobj.replace(tzinfo=timezone.utc)
# datetime.datetime(2012, 6, 12, 14, 3, 10, tzinfo=datetime.timezone.utc)

# convert to US/Eastern (EST or EDT, depending on time of the year)
dtobj = dtobj.astimezone(ZoneInfo('US/Eastern'))
# datetime.datetime(2012, 6, 12, 10, 3, 10, tzinfo=zoneinfo.ZoneInfo(key='US/Eastern'))
print(dtobj)
# 2012-06-12 10:03:10-04:00 
```

* * *

还有[`dateutil`](https://dateutil.readthedocs.io/en/stable/)，它遵循相同的语义：

```
import dateutil
# no strptime needed...
# correctly localizes to GMT (=UTC) directly
dtobj = dateutil.parser.parse(time) 

dtobj = dtobj.astimezone(dateutil.tz.gettz('US/Eastern'))
# datetime.datetime(2012, 6, 12, 10, 3, 10, tzinfo=tzfile('US/Eastern'))
print(dtobj)
# 2012-06-12 10:03:10-04:00 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T17:26:23.763

如果它是您的本地时区，并且给定时间的时区规则与现在相同，那么您可以使用仅限 stdlib 的解决方案（某些边缘情况除外）：

```
#!/usr/bin/env python
from email.utils import parsedate_tz, mktime_tz
from datetime import datetime

timestamp = mktime_tz(parsedate_tz("Tue, 12 Jun 2012 14:03:10 GMT"))
print(datetime.fromtimestamp(timestamp))
# -> 2012-06-12 10:03:10 
```

否则，您需要来自历史时区数据库的数据才能获得正确的 UTC 偏移量。[`pytz`模块](http://pytz.sourceforge.net/)提供[对 tz 数据库的](https://www.iana.org/time-zones/repository/tz-link.html)访问：

```
#!/usr/bin/env python
from email.utils import parsedate_tz, mktime_tz
from datetime import datetime
import pytz # $ pip install pytz

timestamp = mktime_tz(parsedate_tz("Tue, 12 Jun 2012 14:03:10 GMT"))
eastern_dt = datetime.fromtimestamp(timestamp, pytz.timezone('America/New_York'))
print(eastern_dt.strftime('%a, %d %b %Y %H:%M:%S %z (%Z)'))
# -> Tue, 12 Jun 2012 10:03:10 -0400 (EDT) 
```

注意：POSIX`timestamp` 在世界各地都是一样的，即，如果您想查找时间戳，您的本地时区并不重要（除非您的时区是“正确的”类型）。以下是[将 UTC 时间转换为时间戳的](https://stackoverflow.com/a/8778548/4279)方法。

# json - 将json文件导入mongo的正确方法

> ID：10999023
> 
> 赞同：41
> 
> 时间：2012-06-12T14:42:33.177
> 
> 标签：json, mongodb, nosql

我一直在尝试使用 mongo 导入一些数据，但我无法在我的文档描述中正确使用它。

这是我使用 mongoimport 导入的 .json 示例：[https ://gist.github.com/2917854](https://gist.github.com/2917854)

```
mongoimport -d test -c example data.json 
```

我注意到，尽管为每个商店创建了一个对象，但我的所有文档都被导入到一个唯一的对象中。

这就是为什么当我尝试查找商店或任何我想查询的东西时，所有文档都会返回。

```
db.example.find({"shops.name":"x"}) 
```

我希望能够使用点符号查询数据库以通过 id 获取产品，类似于：

```
db.example.find({"shops.name":"x","categories.type":"shirts","clothes.id":"1"} 
```

问题是所有文档都像单个对象一样导入。问题是：
我需要如何导入对象才能获得我想要的结果？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-12T15:28:43.543

[文档](http://www.mongodb.org/display/DOCS/Import+Export+Tools#ImportExportTools-mongoimport)指出：

> 此实用程序采用一个包含每行 1 个 JSON/CSV/TSV 字符串的文件并将其插入。

在您使用的结构中-假设要点上的错误已修复-您实际上是在导入一个只有`shops`字段的文档。

将数据分解为单独的商店文档后，使用类似的东西导入（商店是集合名称，比使用更有意义`example`）：

```
mongoimport -d test -c shops data.json 
```

然后你可以像这样查询：

```
db.shops.find({"name":x,"categories.type":"shirts"}) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-05-21T19:06:58.580

有一个参数`--jsonArray`：

> 接受在单个 JSON 数组中导入由多个 MongoDB 文档表示的数据

使用此选项，您可以为其提供一个数组，因此您只需要剥离外部对象语法，即开头的所有内容，包括`"shops" :`，以及`}`结尾的所有内容。

我自己使用了一个名为[jq](http://stedolan.github.io/jq/)的小工具，它可以从命令行中提取数组：

```
./jq '.shops' shops.json 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-10-29T17:40:21.967

**从 JSON 导入**

```
mongoimport --db "databaseName" --collection "collectionName" --type json --file "fileName.json" --jsonArray 
```

JSON 格式应该是这种格式。（对象数组）

```
[
    { name: "Name1", msg: "This is msg 1" },
    { name: "Name2", msg: "This is msg 2" },
    { name: "Name3", msg: "This is msg 3" }
] 
```

**从 CSV 导入**

```
mongoimport --db "databaseName" --collection "collectionName" --type csv --file "fileName.csv" --headerline 
```

更多信息

[https://docs.mongodb.com/getting-started/shell/import-data/](https://docs.mongodb.com/getting-started/shell/import-data/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-29T16:34:20.007

# 导入 JSON

该命令允许我们在特定数据库和集合中`mongoimport`导入人类可读的内容。`JSON`要导入`JSON`特定数据库和集合中的数据，请键入`mongoimport -d databaseName -c collectionName jsonFileName.json`

# scala - Scala：var List 与 val MutableList

> ID：10999024
> 
> 赞同：14
> 
> 时间：2012-06-12T14:42:38.153
> 
> 标签：scala, collections, immutability

在 Odersky 等人的 Scala 书中，他们说使用列表。我没有读完这本书的封面，但所有的例子似乎都使用了 val List。据我了解，还鼓励使用 vals 而不是 vars。但在大多数应用程序中，使用 var List 或 val MutableList 之间没有权衡吗？显然，我们尽可能使用 val 列表。**但是使用大量的 var 列表（或 var 向量等）是一种好习惯吗？**

我对来自 C# 的 Scala 很陌生。我有很多：

```
public List<T> myList {get; private set;} 
```

如果 C# 内置了不可变性，则可以很容易地将集合声明为 val，因为集合本身在构造后从未更改，即使在其生命周期中会从集合中添加和减去元素。因此，声明一个 var 集合几乎感觉像是离不变性迈出了一步。

针对回答和评论，Scala 的一大卖点是：它可以带来很多好处，而无需像 Lisp 或 Haskell 那样完全改变编写代码的方式。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-12T18:09:34.157

> 使用大量 var 列表（或 var 向量等）是一种好习惯吗？

我会说使用`var`不可变集合比使用`val`可变集合更好。在我的脑海中，因为

*   你对行为有更多保证：如果你的对象有一个可变列表，你永远不知道其他外部对象是否会更新它

*   你限制了可变性的程度；返回集合的方法将产生一个不可变的集合，因此您的一个对象内只有可变性

*   通过简单地将 var 分配给 val 很容易使 var 不可变，而要使可变集合不可变，您必须使用不同的集合类型并重新构建它

在某些情况下，例如具有大量 I/O 的时间相关应用程序，最简单的解决方案是使用可变状态。在[某些](https://stackoverflow.com/a/10015801/770361)情况下，可变解决方案更加优雅。但是，在大多数代码中，您根本不需要可变性。关键是使用具有更高阶函数的集合而不是循环，或者如果不存在合适的函数则使用递归。这比听起来简单。您只需要花一些时间了解 List （以及其他集合，它们大多相同）上的方法。最重要的是：

`map`：将您提供的函数应用于集合中的每个元素 - 使用而不是循环和更新数组中的值

`foldLeft`：从集合中返回单个结果 - 使用而不是循环和更新累加器变量

`for-yield`表达式：简化您的映射和过滤，尤其是对于嵌套循环类型的问题

归根结底，大部分函数式编程都是不变性的结果，你不能真正拥有一个没有另一个；然而，局部变量主要是一个实现细节：只要它不能脱离局部范围，一点可变性就没有错。所以使用带有不可变集合的变量，因为本地变量不会被导出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-12T15:12:07.890

您假设`List`必须是可变的，或者指向它的任何内容都必须是可变的。换句话说，您需要选择以下两个选项之一：

```
val list: collection.mutable.LinkedList[T]
var list: List[T] 
```

这是一种错误的二分法。你可以同时拥有：

```
val list: List[T] 
```

所以，你应该问的问题是*我该怎么做？*，但我们只能在您尝试并遇到特定问题时回答。没有通用的答案可以解决您的所有问题（嗯，有——单子和递归——但这*太*通用了）。

所以试试吧。您可能有兴趣查看[Code Review](http://codereview.stackexchange.com)，其中大多数 Scala 问题都与如何使某些代码更具功能性有关。但是，归根结底，我认为最好的方法是*尝试*，当您无法解决某些特定问题时求助于 Stack Overflow。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:13:28.687

以下是我如何看待函数式编程中的可变性问题。

**最佳解决方案：**值是最好的，所以函数式编程中最好的用法是值和递归函数：

```
val myList = func(4); 
def func(n) = if (n>0) n::func(n) else Nil 
```

**需要可变的东西：**有时需要可变的东西，或者让一切变得更容易。当我们面对这种情况时，我的印象是使用 mutables 结构，所以使用`val list: collection.mutable.LinkedList[T]`而不是`var list: List[T]`，这不是因为性能上的真正改进，而是因为 mutable 集合中已经定义了可变函数。

这个建议是个人的，当你想要性能时可能不推荐，但它是我在 scala 中用于日常编程的指南。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-27T09:27:10.373

我相信您无法将可变`val`/不可变的问题`var`与特定用例分开。让我再深入一点：你想问自己两个问题：

1.  我如何将我的收藏暴露在外面？
    1.  *我想要*当前状态的快照，并且无论对托管集合的实体所做的更改如何，此快照都不应更改。在这种情况下，您应该更喜欢 immutable `var`。原因是使用可变的唯一方法`val`是通过防御性副本。
    2.  *我想要一个*关于状态的视图，它应该改变以反映对原始对象状态的更改。在这种情况下，您应该选择 immutable `val`，并通过不可修改的包装器返回它（很像`Collections.unmodifiableList()`Java 中的做法，[这里](https://stackoverflow.com/questions/13487282/unmodifiable-view-of-a-mutable-scala-collection)有一个问题，询问如何在 Scala 中这样做）。我认为没有办法使用不可变的 var 来实现这一点，所以我相信你在这里的选择是强制性的。
    3.  *我只关心有没有副作用*。在这种情况下，这两种方法非常相似。使用不可变的`var`，您可以直接返回内部表示，因此可能会更清晰一些。
2.  我如何修改我的收藏？
    1.  *我通常进行批量更改*，即一次设置整个集合。这使得 immutable`var`成为更好的选择：您只需将输入中的内容分配给当前状态，就可以了。使用不可变的`val`，您需要先清除您的收藏，然后将新内容复制进去。肯定更糟。
    2.  *我通常会进行逐点更改*，即向/从集合中添加/删除单个元素（或其中几个元素）。这是我大多数时候实际看到的，集合只是一个实现细节，也是`trait`唯一暴露其状态逐点操作的方法。在这种情况下，一个可变的`val`可能通常在性能方面更好，但如果这是一个问题，我建议看看[Scala 的集合性能](http://docs.scala-lang.org/overviews/collections/performance-characteristics.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:13:14.130

如果有必要使用 var 列表，为什么不呢？为了避免问题，您可以例如限制变量的范围。前段时间有一个类似的问题，有一个很好的答案：[scala's mutable and immutable set when to use val and var](https://stackoverflow.com/questions/6489017/scalas-mutable-and-immutable-set-when-to-use-val-and-var)。

# streaming - red5 流媒体视频文件 vod

> ID：10999030
> 
> 赞同：1
> 
> 时间：2012-06-12T14:43:12.517
> 
> 标签：streaming, red5, mpeg, xuggler

我在服务器上有很多非常大的记录 mpeg.ts 文件（每个几个小时），我希望它们流式传输到网站。我正在考虑将 red5 与 xuggler 一起使用。我的客户可以请求一个文件，红色 5 可以将它流式传输到客户。Xuggler 可以即时将流转码为 Flash 视频。

这是一个好方法吗？有人可以指导我演示代码吗？

谢谢

# java - 为什么我的 Java 程序不使用 KeyListener 确认任何击键？

> ID：10999031
> 
> 赞同：4
> 
> 时间：2012-06-12T14:43:15.313
> 
> 标签：java, applet, keylistener

我真的不知道为什么我的程序无法识别键盘输入。我在整个程序中放置了打印语句来确定问题，并且我确定 keyPressed 方法永远不会激活。这是我为课堂项目制作的游戏，是的，我是一个相对初学者的程序员。提前致谢！（代码如下）

```
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.ImageIcon;
import javax.swing.JApplet;

public class Dodger extends JApplet implements Runnable, KeyListener {

Thread myThread;

public Image bg;
public Image pic;
public boolean loaded;

public int cx, cy, speed, x, y;

public void init(){
    setSize(800,800);
    loaded = false;
    x = 2;
    y = 400;
    cx = 0;
    cy = 0;
    speed = 3;
    myThread = new Thread(this);
    myThread.start();
    addKeyListener(this);
}

public void run(){
    loadpic();
    repaint();
    while (myThread!=null)
    {

        try{
            myThread.sleep(18);
        }catch(InterruptedException e){
            e.printStackTrace();
        }
        repaint();
    }
}

public void upMotion(){
    cy = cy + speed;
}

public void downMotion(){
    cy = cy - speed;    
}

public void leftMotion(){
    cx = cx - speed;
}

public void rightMotion(){
    cx = cx + speed;
}

@Override
public void keyPressed(KeyEvent k) {

    if (k.getKeyCode() == KeyEvent.VK_LEFT) {
        System.out.println("work");
        leftMotion();
    }

    if (k.getKeyCode() == KeyEvent.VK_RIGHT) {
        rightMotion();
    }

    if (k.getKeyCode() == KeyEvent.VK_UP) {
        upMotion();
    }

    if (k.getKeyCode() == KeyEvent.VK_DOWN) {
        downMotion();
    }
}

@Override
public void keyReleased(KeyEvent e) {
}

@Override
public void keyTyped(KeyEvent e) {
}

public void loadpic(){
    bg = new ImageIcon(getClass().getResource("back.png")).getImage();
    pic = new ImageIcon(getClass().getResource("smile.png")).getImage();
    loaded = true;
    repaint();
}

public void paint(Graphics g){
    g.drawImage(bg, 0, 0, this);
    g.drawImage(pic, cx, cy, this);
}   
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:12:39.000

当小程序可聚焦并具有焦点时，可以很好地检测到关键事件。管理焦点一直是小程序的一个问题。问题主要在于 Sun 从未费心指定理想情况下应该应用于可聚焦 HTML 元素和小程序的混合页面的焦点行为。

根据汤姆的建议，添加到末尾`init()`

```
setFocusable(true); 
```

为了安全起见，还要覆盖：

```
public void start() {
    this.requestFocusInWindow();
} 
```

顺便说一句，通常最好在 Swing中使用[键绑定。](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)它们还要求小程序具有输入焦点。

* * *

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:07:44.563

首先，您可能希望将您的类与您的 KeyListener 分开，因为它会使它更难阅读。

接下来，您想摆脱裸露`Thread`并将其包装在计时器中。

```
import javax.swing.Timer;

class Dodger extends JApplet {

    Timer imageUpdater; //replaces Thread

    /*...*/
    public void init() {
        /*etc*/
        loadpic();
        int repaintInterval = 100;
        imageUpdater = new Timer(repaintInterval,
            new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    repaint();
                }
            }
        );
        imageUpdater.start();
        addKeyListener(new KeyHandler());
        setFocusable(true);
     }

    /*...*/
    private class KeyHandler extends KeyAdapter {
        /* Note that with this implementation, you do not have to override
         * unnecessary methods, as KeyAdapter is an abstract class that
         * implements all of the methods of KeyListener.
         */
        @Override
        public void keyPressed(KeyEvent e) {
        /*...*/
        }
    }
    /*...*/
} 
```

其中大部分只是代码清理 - 实际问题可能会通过`setFocusable(true)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:07:24.963

我不确定它是否适用于小程序，但您`Thread`可能不允许发生事件调度。

尝试使用[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)运行您的“工作” 。

# python - 来自 itertools 库的 tee 函数

> ID：10999039
> 
> 赞同：5
> 
> 时间：2012-06-12T14:43:42.533
> 
> 标签：python, itertools

list 和 islice 对象都是可迭代的，但为什么会出现这种差异。

```
r = [1, 2, 3, 4]               
i1, i2 = tee(r)
print [e for e in r if e < 3]
print [e for e in i2]
#[1, 2]
#[1, 2, 3, 4]

r = islice(count(), 1, 5)          
i1, i2 = tee(r)
print [e for e in r if e < 3]
print [e for e in i2]
#[1, 2]
#[] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-12T14:47:00.487

这里的问题是`tee()`需要使用原始迭代器中的值，如果您开始使用原始迭代器中的值，它将无法正常运行。在您的列表示例中，迭代只是再次开始。在生成器示例中，它已用尽，不再产生任何值。

这是有据可查的：

> 一旦 tee() 进行了拆分，则不应在其他任何地方使用原始的可迭代对象；否则，在不通知 tee 对象的情况下，iterable 可能会被推进。

[来源](http://docs.python.org/library/itertools.html#itertools.tee)

编辑以说明列表和生成器之间的区别点：

```
>>> from itertools import islice, count
>>> a = list(range(5))
>>> b = islice(count(), 0, 5)
>>> a
[0, 1, 2, 3, 4]
>>> b
<itertools.islice object at 0x7fabc95d0fc8>
>>> for item in a:
...     print(item)
... 
0
1
2
3
4
>>> for item in a:
...     print(item)
... 
0
1
2
3
4
>>> for item in b:
...     print(item)
... 
0
1
2
3
4
>>> for item in b:
...     print(item)
... 
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:23:51.923

在您的列表推导中，您想替换`r`为`i1`.

# html - 将“联系我们”表单重定向到不同的电子邮件地址

> ID：10999040
> 
> 赞同：0
> 
> 时间：2012-06-12T14:43:42.367
> 
> 标签：html, perl, email

我有一个单一的联系我们表格，我想做的是`contact.html`在我的网站上随处使用这个单一的表格（而不是这个表格的多个副本），因为我的网站根据部门有不同的联系我们部分。

假设营销的联系我们表格应该通过电子邮件发送给`marketing@mydomian.com`，销售联系我们表格应该通过电子邮件发送给`sales@mydomian.com`，HR 的联系我们表格应该通过电子邮件发送给`hr@mydomain.com`。

如何在将提交重定向到相应部门的电子邮件地址时使用单一表单？

我正在使用 FormMail.pl 版本 3.14m1 进行电子邮件提交。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:24:02.220

在[本文档](http://nms-cgi.sourceforge.net/formmail_modules-3.14m1/EXAMPLES)的示例 4 中，如果您可以设置隐藏字段，则说明如何执行此操作。这可能是最好的解决方案。

* * *

如果您希望网站的所有不同部分都使用相同的表单，那`input type="hidden"`将无法正常工作。您必须检查引用 URL。

您可能已经编辑了 perl 脚本的配置部分。这就是它的样子。您不应该在本节末尾更改任何内容。

```
# USER CONFIGURATION SECTION
# --------------------------
# Modify these to your own settings. You might have to
# contact your system administrator if you do not run
# your own web server. If the purpose of these
# parameters seems unclear, please see the README file.
#
BEGIN
{ 
```

您仍然可以像在上面提到的示例中那样进行配置：

```
%recipient_alias   = (
   'hr' => 'hr@mydomain.com',
   'sales'  => 'sales@mydomian.com',
   'marketin' => 'marketing@mydomian.com',
); 
```

但是，如果没有隐藏字段，那么我们将不得不稍微改变一下：

```
$ENV{'HTTP_REFERER'} =~ m!mydomain.com/(\w+)/contact\.html/!;
@recipients = ($recipient_alias{$1}); 
```

我添加了一个正则表达式来找出请求来自哪个部门的联系表。我假设 URL 看起来像`http://www.mydomain.com/sales/contact.html`. 正则表达式将捕获部门并将其放在`$1`我们可以将其用作`%recipient_alias`哈希键的位置。`@recipients`我们取出数组中那个键的值。

我只是假设如果别名没有隐藏字段，将使用它。如果它不起作用，您应该更改哈希的名称。

我在[这里](http://nms-cgi.sourceforge.net/formmail_modules-3.14m1/FormMail.pl)找到了 FormMail.pl 的代码。我希望这是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:24:57.710

@Widor 在他的评论中提供了一些建议，其中之一可能最适合您。

`Referer`但我认为检查标头以查看请求来自哪个页面可能很有用。我想您将能够从中确定合适的收件人。

# javascript - 使用 jquery 显示/隐藏时不是预期的“效果”

> ID：10999046
> 
> 赞同：0
> 
> 时间：2012-06-12T14:43:55.687
> 
> 标签：javascript, jquery, html, css

尝试将显示/隐藏与鼠标悬停和鼠标悬停一起使用时，我遇到了意想不到的效果和一些其他错误。

我想做的是有一个框（div），当你将鼠标悬停在它上面时，会出现另一个框并向右滑动。

这是它的小提琴 [http://jsfiddle.net/XtXGR/](http://jsfiddle.net/XtXGR/)

现在有两个问题。一个是闪烁，另一个是它从左上角增长出现，我想要它做的是从左边出现。

任何帮助将不胜感激。谢谢

我想我知道是什么导致了类似问题的闪烁，但我仍然需要其他问题的帮助。谢谢！

哦，你也知道使用它的上下文是在带有项目表的页面上，每个项目都是我在上面发布的小提琴链接中的对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T14:56:32.733

主要问题是移到容器的不同子元素上会触发 a `mouseout`and`mouseover`组合，这就是为什么您会看到元素展开和折叠的原因。IE 使用`mouseenter`和`mouseleave`事件规避了这一点，其行为与 CSS 完全相同`:hover`。

说起来，jQuery[`hover`](http://api.jquery.com/hover/)函数也有这个特性。您应该使用它而不是`mouseover`and `mouseout`。

根据[`show`](http://api.jquery.com/show/)API，你应该使用[`slide`](http://docs.jquery.com/UI/Effects/Slide)效果来获得你想要的。

您的最终代码应如下所示：http: [//jsfiddle.net/XtXGR/28/](http://jsfiddle.net/XtXGR/28/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T14:57:18.500

几件事：

如果你想做一个淡入/淡出，这会更好：

```
$(document).ready(function(){
    $("div.item_container").hover(function() {
         $("div.item_body").fadeIn(500);
    }, function() {
         $("div.item_body").fadeOut(500);
    });

}); 
```

​另外，您应该将 div 浮动`.item_body`到左侧..

演示：http: [//jsfiddle.net/lucuma/XtXGR/33/](http://jsfiddle.net/lucuma/XtXGR/33/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T14:53:55.560

改用 CSS3 过渡效果如何？

看到这个：http: [//jsfiddle.net/EVDj6/2/](http://jsfiddle.net/EVDj6/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T14:54:49.737

像这样的东西？使用[幻灯片](http://docs.jquery.com/UI/Effects/Slide)将为您提供默认左侧效果的幻灯片。

```
$(document).ready(function(){
    $("div.item_container").on('hover',function(){
        $("div.item_body").toggle('slide',500);
    });
});​ 
```

[http://jsfiddle.net/XtXGR/25/](http://jsfiddle.net/XtXGR/25/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:02:59.347

您的代码中有很多问题。href 无效，并且元素的浮动不是 100% 正确的。主要问题之一是您的 CSS 中有 display:none。将 dispay:none 从 CSS 中取出，并将其内嵌在要显示/隐藏的项目上。当其默认状态为“隐藏”时，您需要将 display:none 内联。

看看这个小提琴，以更好地了解如何使用更有效的语法来解决这个问题：http: [//jsfiddle.net/fH3EC/1/](http://jsfiddle.net/fH3EC/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T15:03:25.927

我做了一些快速的东西，你可以为它发疯:) 动画很流畅，我希望它对你有用。

[http://jsfiddle.net/XtXGR/50/](http://jsfiddle.net/XtXGR/50/)

# javascript - Target.attr('class') 在 mozilla 中未定义

> ID：10999048
> 
> 赞同：1
> 
> 时间：2012-06-12T14:44:13.440
> 
> 标签：javascript, jquery, html, firefox, cross-browser

我对带有 Ubuntu 的最新 Mozilla Browser 13.0 有一个奇怪的问题。该代码在其他浏览器和以前版本的 mozilla 中都能完美运行。

这是代码

```
$(document).click(function(event) {
  var target = $(event.target);

  if (!target.attr('class').match(/^RefineClick/) && target.parents('.RefineClick').length == 0) {
   jQuery('.RefineClick').fadeOut();
  }
}); 
```

我收到以下错误： Target.attr('class').... is undefined

这是截图：http: [//i47.tinypic.com/dqoits.png](http://i47.tinypic.com/dqoits.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:54:35.650

嗯...为我工作？

[http://jsfiddle.net/acrashik/b9MCj/](http://jsfiddle.net/acrashik/b9MCj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:10:00.840

如果没有附加到单击的元素的类`target.attr('class')`返回`undefined`（从 v1.6 开始）；在 FF 中，这表示为您尝试调用时看到的错误`.match`。（在 chrome 中它会是“不能调用未定义的方法匹配”）

添加缺课检查；`if (typeof target.attr('class') === "undefined") return;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T08:48:40.553

您将该函数绑定到整个文档上的“单击”事件。因此，*任何*点击都会触发处理程序，包括那些没有设置类属性的元素。虽然如果您仅在具有定义的“类”属性的元素（在任何浏览器中）上测试它会正常工作，但它会抛出错误（在*任何*`.match()`浏览器中），因为您尝试在一个`undefined`值上调用该方法。

*“从 jQuery 1.6 开始，.attr() 方法为尚未设置的属性返回 undefined。”* [API 参考。](http://api.jquery.com/attr/)

既然你在使用 jQuery，谁不使用它的全部功能呢？它有一个内置[`.hasClass()`](http://api.jquery.com/hasClass/)方法：

```
$(document).click(function(event) {
    var target = $(event.target);

    if (!target.hasClass('RefineClick') && target.parents('.RefineClick').length == 0) {
        $('.RefineClick').fadeOut();
    }
}); 
```

请注意，该方法的输入是类名而不是类选择器。

# regex - Lisp 正则表达式匹配带有或不带有常量类型标识符的数字（ 3.2 或 3.2f ）

> ID：10999049
> 
> 赞同：4
> 
> 时间：2012-06-12T14:44:14.143
> 
> 标签：regex, emacs, numbers, lisp, font-lock

问题：我希望在 emacs 中创建一个数字字体锁定面孔，但我无法获得符合我需要的正则表达式。这是我所拥有的：

```
"\\<\\([0-9]*\\.?[0-9]*\\)+\\(d\\|f\\)?\\>" 
```

我希望它匹配的内容：

1.  2
2.  2.1
3.  2.1f 或 2.1d
4.  .1f 或 .1d

我不希望它匹配的内容

1.  2.
2.  2.f 或 2.d
3.  f 或 d

当前问题：

目前它主要工作，但它不匹配像 .2 或 .2f 这样的数字，因为它没有在数字之前拾取 (.)。它目前还匹配代码中任何位置的单个“f”或“d”，因此 f 或 d 等变量名得到匹配。我在这里想念什么？在过去一周左右的每个午休时间，我都在摆弄这个，我很难过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T14:54:27.570

您可以使用这样的正则表达式（PCRE 语法）：

```
(\d*\.\d+|\d+)[fd]? 
```

（根据需要锚定它。）

翻译成 Emacs 风格的正则表达式（由[Jon O](https://stackoverflow.com/users/725091/jon-o)提供）：

```
"\\<\\([0-9]*\\.[0-9]+\\|[0-9]+\\)[df]?\\>" 
```

# xml - ColdFusion 生成的 rss 提要中的格式描述

> ID：10999055
> 
> 赞同：1
> 
> 时间：2012-06-12T14:44:31.320
> 
> 标签：xml, xslt, coldfusion, rss, coldfusion-8

由于`cffeed`将所有内容都写入 XML，我不确定如何格式化我的提要描述中的文本。理想情况下，我希望能够将描述格式化为列表。HTML 字符被转义，HTML 特殊字符仅显示为文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T18:35:40.470

> 哇，我是个白痴。你完全正确。我将描述包裹在一个转义所有 HTML 字符的 XMLFormat() 函数中。一旦我删除它，提要就可以很好地处理 HTML。谢谢回复。

# javascript - 验证表单函数跳转到错误？

> ID：10999061
> 
> 赞同：0
> 
> 时间：2012-06-12T14:45:01.443
> 
> 标签：javascript, forms, validation

我有一个带有完美工作的验证脚本的表单。但是，我希望表单跳转到不验证或显示错误消息中的字段名称的字段。

我用来验证的代码是：

```
else
{
    var valid = document.formvalidator.isValid(f);
}

if (flag == 0 || valid == true) {
    f.check.value = '<?php echo JUtility::getToken(); ?>';//send token
}
else {
    alert('There was an error with the fields..');
    return false;
}
return true; 
```

如何获得警报以命名需要正确填写的字段或跳转到特定字段？

已编辑 ----------

你好，

感谢您到目前为止的帮助。我对 JS 很陌生。该表单位于 Joomla 的一个组件中。

验证表单的完整功能是

```
function validateForm(f){
    var browser = navigator.appName;
    if (browser == "Microsoft Internet Explorer"){
            var flag = 0;
            for (var i=0;i < f.elements.length; i++) {
                el = f.elements[i];
                 if ($(el).hasClass('required')) {
                     var idz= $(el).getProperty('id');
                        if(document.getElementById(idz)){
                            if (!document.getElementById(idz).value) {
                                document.formvalidator.handleResponse(false, el);
                                flag = flag + 1;
                            }
                       }
                 }
            }
    }
    else {
        var valid = document.formvalidator.isValid(f);
    }

    if(flag == 0 || valid == true){
        f.check.value='<?php echo JUtility::getToken(); ?>';//send token
    }
    else {
        alert('<?php echo JText::_('JBJOBS_FIEDS_HIGHLIGHTED_RED_COMPULSORY'); ?>');
        return false;
    }
    return true;
} 
```

外部js文件：

```
 var JFormValidator = new Class(
    {
        initialize : function() {
            this.handlers = Object();
            this.custom = Object();
            this.setHandler("username", function(b) {
                regex = new RegExp("[<|>|\"|'|%|;|(|)|&]", "i");
                return !regex.test(b)
            });
            this.setHandler("password", function(b) {
                regex = /^\S[\S ]{2,98}\S$/;
                return regex.test(b)
            });
            this.setHandler('passverify',
                    function (value) {
                    return ($('password').value == value);
            }
            ); // added March 2011
            this.setHandler("numeric", function(b) {
                regex = /^(\d|-)?(\d|,)*\.?\d*$/;
                return regex.test(b)
            });
            this
                    .setHandler(
                            "email",
                            function(b) {
                                regex = /^[a-zA-Z0-9._-]+(\+[a-zA-Z0-9._-]+)*@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,4}$/;
                                return regex.test(b)
                            });
            var a = $$("form.form-validate");
            a.each(function(b) {
                this.attachToForm(b)
            }, this)
        },
        setHandler : function(b, c, a) {
            a = (a == "") ? true : a;
            this.handlers[b] = {
                enabled : a,
                exec : c
            }
        },
        attachToForm : function(a) {
            a.getElements("input,textarea,select")
                    .each(
                            function(b) {
                                if (($(b).get("tag") == "input" || $(b)
                                        .get("tag") == "button")
                                        && $(b).get("type") == "submit") {
                                    if (b.hasClass("validate")) {
                                        b.onclick = function() {
                                            return document.formvalidator
                                                    .isValid(this.form)
                                        }
                                    }
                                } else {
                                    b.addEvent("blur", function() {
                                        return document.formvalidator
                                                .validate(this)
                                    })
                                }
                            })
        },
        validate : function(c) {
            c = $(c);
            if (c.get("disabled")) {
                this.handleResponse(true, c);
                return true
            }
            if (c.hasClass("required")) {
                if (c.get("tag") == "fieldset"
                        && (c.hasClass("radio") || c.hasClass("checkboxes"))) {
                    for ( var a = 0;; a++) {
                        if (document.id(c.get("id") + a)) {
                            if (document.id(c.get("id") + a).checked) {
                                break
                            }
                        } else {
                            this.handleResponse(false, c);
                            return false
                        }
                    }
                } else {
                    if (!(c.get("value"))) {
                        this.handleResponse(false, c);
                        return false
                    }
                }
            }
            var b = (c.className && c.className
                    .search(/validate-([a-zA-Z0-9\_\-]+)/) != -1) ? c.className
                    .match(/validate-([a-zA-Z0-9\_\-]+)/)[1]
                    : "";
            if (b == "") {
                this.handleResponse(true, c);
                return true
            }
            if ((b) && (b != "none") && (this.handlers[b])
                    && c.get("value")) {
                if (this.handlers[b].exec(c.get("value")) != true) {
                    this.handleResponse(false, c);
                    return false
                }
            }
            this.handleResponse(true, c);
            return true
        },
        isValid : function(c) {
            var b = true;
            var d = c.getElements("fieldset").concat($A(c.elements));
            for ( var a = 0; a < d.length; a++) {
                if (this.validate(d[a]) == false) {
                    b = false
                }
            }
            new Hash(this.custom).each(function(e) {
                if (e.exec() != true) {
                    b = false
                }
            });
            return b
        },
        handleResponse : function(b, a) {
            if (!(a.labelref)) {
                var c = $$("label");
                c.each(function(d) {
                    if (d.get("for") == a.get("id")) {
                        a.labelref = d
                    }
                })
            }
            if (b == false) {
                a.addClass("invalid");
                a.set("aria-invalid", "true");
                if (a.labelref) {
                    document.id(a.labelref).addClass("invalid");
                    document.id(a.labelref).set("aria-invalid", "true");
                }
            } else {
                a.removeClass("invalid");
                a.set("aria-invalid", "false");
                if (a.labelref) {
                    document.id(a.labelref).removeClass("invalid");
                    document.id(a.labelref).set("aria-invalid", "false");
                }
            }
        }
    });
document.formvalidator = null;
window.addEvent("domready", function() {
document.formvalidator = new JFormValidator() 
}); 
```

正如你们中的一些人在下面回答的那样，我将在哪里编辑代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:50:02.940

使用**jquery** js 库，滚动到元素（id 选择器或类）

```
<p class="error">There was a problem with this element.</p> 
```

这通过以下方式传递给 ScrollTo 插件。

```
$.scrollTo($('p.error:1')); 
```

见[源](http://www.hashbangcode.com/comment/1998)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:50:21.003

您可以让您的 isValid 例程返回错误消息，而不是返回布尔值。

在 isValid 中，您可以构建错误消息以包含有错误的字段名称。

您将检查“errorMessage.length == 0”，而不是检查“valid == true”。

如果您想关注一个错误字段（您只能关注一个），那么也可以在 isValid 例程中执行此操作。

```
function isValid(f) {
   var errorMessage = ""; 
   var errorFields = "";
   var isFocused = false;
   ...
   if (field has an error) {
       errorFields += " " + field.name;
       if (!isFocused) {
           field.focus();
           isFocused = true;
       }
   }
   ...
   if (errorFields.length > 0) {
      errorMessage = "Errors in fields: " + errorFields;
   }

   return (errorMessage);
} 
```

然后，在您的调用例程中：

```
var errorMessage = isValid(f);
if (flag == 0 || errorMessage.length == 0) {
    f.check.value='<?php echo JUtility::getToken(); ?>';//send token
}
else {
    alert(errorMessage);
    return false;
}
return true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T14:50:55.340

使用 jQuery 的 .each 循环遍历字段。在每次迭代中，正在调查的项目都将位于`this`变量下。

因此，`this.id`给出您要查找的元素的 id。存储这些以收集所有不正确的字段，然后突出显示它们或在消息中打印它们的名称。

请记住，这是基本思想，在您展示处理表单的代码之前，我无法给出实际答案。

亲切的问候，

D.

# c++ - 空嵌套元组错误

> ID：10999062
> 
> 赞同：6
> 
> 时间：2012-06-12T14:45:03.643
> 
> 标签：c++, c++11, nested, tuples

```
#include <iostream>
#include <tuple>
int main(){

auto bt=std::make_tuple(std::tuple<>(),std::tuple<std::tuple<>>()); //Line 1
auto bt2=std::make_tuple(std::tuple<>(),std::tuple<>());             //Line 2
} 
```

为什么第 1 行出现编译错误，而第 2 行编译正常？（在 Gcc 和 Clang 中测试）

有可能的解决方法吗？

铿锵的错误信息

```
/usr/include/c++/4.6/tuple:150:50: error: ambiguous conversion from derived class 'std::_Tuple_impl<0, std::tuple<>,
      std::tuple<std::tuple<> > >' to base class 'std::_Head_base<0, std::tuple<>, true>':
    struct std::_Tuple_impl<0, class std::tuple<>, class std::tuple<class std::tuple<> > > -> _Tuple_impl<0UL + 1, class std::tuple<class std::tuple<> > > -> _Head_base<1UL, class std::tuple<class std::tuple<> >, std::is_empty<class tuple<class tuple<> > >::value> -> class std::tuple<class std::tuple<> > -> _Tuple_impl<0, class std::tuple<> > -> _Head_base<0UL, class std::tuple<>, std::is_empty<class tuple<> >::value>
    struct std::_Tuple_impl<0, class std::tuple<>, class std::tuple<class std::tuple<> > > -> _Head_base<0UL, class std::tuple<>, std::is_empty<class tuple<> >::value>
      _Head&            _M_head()       { return _Base::_M_head(); }
                                                 ^~~~~
/usr/include/c++/4.6/tuple:173:33: note: in instantiation of member function 'std::_Tuple_impl<0, std::tuple<>,
      std::tuple<std::tuple<> > >::_M_head' requested here
        _Base(std::forward<_Head>(__in._M_head())) { }
                                       ^
/usr/include/c++/4.6/tuple:334:9: note: in instantiation of member function 'std::_Tuple_impl<0, std::tuple<>,
      std::tuple<std::tuple<> > >::_Tuple_impl' requested here
      : _Inherited(static_cast<_Inherited&&>(__in)) { }
        ^
gcc_bug.cpp:5:10: note: in instantiation of member function
      'std::tuple<std::tuple<>, std::tuple<std::tuple<> > >::tuple' requested here
        auto bt=std::make_tuple(std::tuple<>(),std::tuple<std::tuple<>>());
                ^
1 error generated. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T15:09:21.867

看起来您在 libstdc++ 中发现了一个错误！（此代码与 libc++ 一起工作）。简化的测试用例：

```
#include <tuple>

int main(){
    auto b = std::tuple<std::tuple<std::tuple<>>>{};
} 
```

* * *

问题是由于如何`std::tuple`在 libstdc++ 中实现的。元组实现使用具有多重继承的“递归”。你可以认为`tuple<X, Y, Z>`继承自`X`和`tuple<Y, Z>`。这意味着`tuple<tuple<>>`将从两者继承，`tuple<>`并且`tuple<>`将导致模棱两可的基本错误。当然真正的问题不是这样的，因为`tuple<tuple<>>`不会产生任何错误。

导致错误的真正实现是这样的：

```
template<size_t _Idx, typename _Head>
struct _Head_base : public _Head
{};

template<size_t _Idx, typename... _Elements>
struct _Tuple_impl;

template<size_t _Idx>
struct _Tuple_impl<_Idx> {};

template<size_t _Idx, typename _Head, typename... _Tail>
struct _Tuple_impl<_Idx, _Head, _Tail...>
    : public _Tuple_impl<_Idx + 1, _Tail...>,
      private _Head_base<_Idx, _Head>
{
    typedef _Tuple_impl<_Idx + 1, _Tail...> _Inherited;
    constexpr _Tuple_impl() = default;
    constexpr _Tuple_impl(_Tuple_impl&& __in) : _Inherited(std::move(__in)) {}
};

template<typename... _Elements>
struct tuple : public _Tuple_impl<0, _Elements...> {}; 
```

当我们实例化`tuple<tuple<tuple<>>>`时，我们得到这个继承层次结构：

![libstdc++中<code>tuple<tuple<tuple<>>></code>的继承图](../Images/829a4b63f0aa36fe4dbb16b3d4d0451e.png)

我们看到这`_Tuple_impl<1>`可以通过两条不同的路径到达。这还不是问题，问题出在移动构造函数中，它调用了`_Tuple_impl<1>`. 你想要哪个`_Tuple_impl<1>`？编译器不知道，所以它选择了放弃。

（在您的情况下，这是因为`_Head_base<0, tuple<>>`您正在实例化`tuple<tuple<>, tuple<tuple<>>>`，但原理是相同的。）

* * *

为什么 libc++ 没有同样的问题？主要原因有两个：

1.  `tuple<T...>`在 libc++ 中使用组合而不是继承来引用`__tuple_impl<...>`.
2.  结果，空基类优化`__tuple_leaf<tuple<tuple<>>>`不会启动，即`__tuple_leaf<tuple<tuple<>>>`不会继承自`tuple<tuple<>>`
3.  因此，不会发生不明确的基类问题。
4.  （正如@mitchnull 提到的，每个碱基都是唯一的，但这不是主要区别。）

![libc++中<code>tuple<tuple<tuple<>>></code>的继承图](../Images/d25b0a72748c42bb7c4dac8ca48dafad.png)

正如我们在上面看到的，如果`tuple<...>`使用继承而不是组合，OP`tuple<tuple<>, tuple<tuple<>>>`仍然会继承`__tuple_leaf<0, tuple<>>`两次，这可能是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:28:53.710

顺便说一下，对于那些必须使用 gcc 的人，让我给你一个快速而**肮脏**的修复（对于 4.8.0，已经提交了错误报告）：

解决方案是在元组实现中对 __empty_not_final 进行小修改，以防止 tuple<> 类型的空基优化：

```
template<typename _Tp>
    using __empty_not_final
      = typename conditional<__is_final(_Tp)||is_same<_Tp,tuple<>>::value,
false_type, is_empty<_Tp>>::type; 
```

代替

```
template<typename _Tp>
    using __empty_not_final
      = typename conditional<__is_final(_Tp), false_type, is_empty<_Tp>>::type; 
```

（注意，这只是 tuple<> 类型的临时解决方案，它并没有解决 KennyTM 描述的真正问题，即`struct A{}; auto d = std::tuple<std::tuple<std::tuple<A, A>, A>, A>{};`仍然无法编译）

# javascript - 防止 javascript 中的“全局”引用

> ID：10999070
> 
> 赞同：4
> 
> 时间：2012-06-12T14:45:39.587
> 
> 标签：javascript

我遇到了代码变量名称相互冲突的问题，即；

```
<script type="text/javascript">var a = "hello"; </script>
<script type="text/javascript">alert(a);//this works, when I want 'a' not to exist </script> 
```

关闭是唯一的选择吗？

来自ac#背景，就像是构造一个未引用的delegate实例，然后调用它inline，看起来有点乱

```
(function(){var a = "hello";})();
(function(){alert(a);})();//yes! working as expected 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T14:47:05.077

使用（立即自动执行的）函数来创建一个新的范围确实是要走的路。

这还有一个好处是您可以确保某些变量具有某些值。使用 jQuery 时，以下是常见的示例：

```
(function($, window, undefined) {
    // ...
})(jQuery, this); 
```

除非您有大量函数，每个函数中只有一个语句（如您的示例中），否则它也是完全可读的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T14:46:46.387

是的，关闭是您唯一的选择。在浏览器中，所有 JavaScript 文件都放在同一个全局范围内。

[IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)在 JavaScript中*很*常见。我不会称它们为乱七八糟的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T14:52:02.830

Javascript*仅*具有函数作用域，与具有块作用域的 C# 不同。以下代码是有效的 javascript 和 C#：

```
var x = 2;
while(true) {
    var y = 3;
    break;
}
//y is not accessible here in C#, but is in javascript 
```

创建新范围的唯一方法是创建并执行匿名函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T14:51:34.497

简而言之，内联的东西，那么你最好使用模块模式来创建一个闭包，从而模拟私有变量。

```
(function(){
    var a....
    })(); 
```

更好的长期方法是将对象用作命名空间。

```
var NS = {};
NS.a = 1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:12:38.560

只是提供一个不同的视角。可以在不使用闭包的情况下编写代码，并维护（可以说）安全的全局变量范围。

1.  定义一个对象，用作命名空间，具有适当的唯一名称（例如 MyAppContext），该名称将具有全局范围，如果您需要定义仅在您的应用程序中使用的类全局变量，请将它们附加到此对象。

    MyAppContext.appTitle = '应用程序标题';

2.  在您创建的脚本的开头`MyAppContect`确保它不存在。

3.  确保所有函数范围的变量都使用`var`关键字，这样你就知道你没有引用全局值。

显然，这种方法会带来一个风险，即您忘记使用`var`. [JSLint](http://www.jslint.com/)可以在这方面为您提供帮助。

如果我开始被激怒，我很高兴收回这个答案，但我相信这是使用闭包的可行替代方法。嘿！这是老学校

我也同意使用闭包更安全，但认为这可能会让你感兴趣。

# c# - C# 中的多客户端/服务器发现

> ID：10999073
> 
> 赞同：1
> 
> 时间：2012-06-12T14:45:53.283
> 
> 标签：c#, networking, network-programming, client, client-server

我正在用 C# 开发一个多客户端/多服务器程序，在深入了解细节之前，我想知道是否有人从事过类似的项目，并且可能能够分享他们的实施技巧/想法。

*   服务器将位于许多 PC 上，并监听来自客户端的传入连接（或者服务器应该广播，客户端监听？）。
*   当客户端启动时，它应该自动填充潜在服务器 IP 地址的列表。
*   当服务器关闭时，客户端应该从它的列表中删除该服务器。
*   当新服务器启动时，应通知客户端并将其添加到他们的列表中。
*   服务器也可以充当客户端，并且应该能够看到自己以及所有其他服务器。
*   从客户端发送到服务器的消息会影响服务器，应该将更改广播到所有连接的客户端。
*   我的服务器应该是 Windows 服务吗？这有什么优点/缺点？

关于我如何开始这方面的任何想法？我一直在研究 UDP 多播和 LAN 扫描。我正在使用 C# 和 .NET 4.0

编辑：找到这个：[http](http://code.google.com/p/lidgren-network-gen3/) ://code.google.com/p/lidgren-network-gen3/有没有人有任何经验并且可以推荐/不推荐它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:30:38.180

我建议`NetPeerTcpBinding`WCF 通信来创建对等网格。客户端和服务器都将使用对等解析器加入网格。您可以使用 PNRP 或创建自定义对等解析器（.Net 实际上为您提供了一个名为 的实现`CustomPeerResolverService`）。请参阅[对等网络文档](http://msdn.microsoft.com/en-us/library/ms733761)。

您还可以使用[DiscoveryProxy](http://msdn.microsoft.com/en-us/library/dd456796.aspx)实现发现服务。使用发现服务，服务可以宣布它们的端点。然后，发现服务可以服务查找请求（请参阅[FindCriteria](http://msdn.microsoft.com/en-us/library/ee816866.aspx)）以返回与请求匹配的端点。这称为托管发现。另一种模式是 Ad Hoc Discovery。每个服务都将通过 UDP 宣布它们的端点，并且发现客户端将在网络上探测这些端点。

我实际上已经结合 Peer 2 Peer WCF 网络实现了一个托管发现服务，以提供一个冗余的发现服务网格，所有这些服务都通过 P2P 共享已发布的服务端点。我发现使用 Managed Discovery 的性能要好得多，因为使用 UDP 探测的 Ad Hoc Discovery 速度较慢，并且在跨越某些网络边界时存在一些限制，而 Managed Discovery 利用已公布服务端点的集中存储库。

我认为任何一种/两种技术都可以导致您的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:41:26.680

这实际上是一个点对点风格的网络（几乎像 bittorrent），其中所有服务器都是客户端，但并非所有客户端都是服务器。

并且要求是每个客户端都应该包含所有其他服务器（反过来，客户端）的列表。

问题在于首先将服务器 IP 发送给客户端。您可以使用具有固定 DNS 的主服务器充当一种跟踪器，所有服务器都签入该跟踪器，客户端定期检查。

另一种选择（或其他方法）是使用对等交换式系统，其中每个客户端和服务器都使用本地网络上的 UDP 广播数据包来发现彼此，然后传输他们知道的服务器，有点像路由协议。但是，如果 PC 分布在非本地网络（例如 Internet）上，则它们自行发现彼此的可能性很小，因此此方法仅在与其他查找服务器的方法结合使用时才有用。此外，您可能必须处理路由器 UPnP 以允许客户端通过彼此的路由器 NAT 相互连接，因此对于您获得的收益而言，这种方法可能过于复杂。（但是，如果您只是在 LAN 上，这就是您所需要的！）

第三种选择（同样，这听起来很像 torrent 技术）是使用分布式哈希表来存储有关云中服务器 IP 的信息，而不必依赖中央主服务器。

我以前曾尝试过这样的项目（纯 P2P，无服务器消息传递系统），但始终无法让它工作。如果没有大量的对等点，或者没有一个主服务器来跟踪所有其他服务器，那么可靠地检索所有服务器的 IP 是非常困难的。

# java - 启用 GC 日志记录时，以编程方式打印通常在 JVM 退出时打印的堆使用情况

> ID：10999076
> 
> 赞同：4
> 
> 时间：2012-06-12T14:46:10.317
> 
> 标签：java, jmx

当我的 Java 应用程序 (Oracle JVM v1.6.0) 启用了 GC 日志记录时，它通常会在退出时打印以下输出：

```
PSYoungGen      total 6429824K, used 5483163K [0x0000000640000000, 0x0000000800000000, 0x0000000800000000)
  eden space 5483456K, 99% used [0x0000000640000000,0x000000078eaa6cc0,0x000000078eaf0000)
  from space 946368K, 0% used [0x00000007c63d0000,0x00000007c63d0000,0x0000000800000000)
  to   space 910208K, 0% used [0x000000078eaf0000,0x000000078eaf0000,0x00000007c63d0000)
 ParOldGen       total 3145728K, used 3145724K [0x0000000580000000, 0x0000000640000000, 0x0000000640000000)
  object space 3145728K, 99% used [0x0000000580000000,0x000000063ffff3a0,0x0000000640000000)
 PSPermGen       total 57984K, used 57686K [0x000000057ac00000, 0x000000057e4a0000, 0x0000000580000000)
  object space 57984K, 99% used [0x000000057ac00000,0x000000057e455ae0,0x000000057e4a0000) 
```

有没有一种方法可以在应用程序运行期间定期生成此输出？我知道[如何通过 JMX 以编程方式访问内存使用情况？](https://stackoverflow.com/q/1759831/7507)但坦率地说，我希望有一条捷径，而不是重新实现生成上述代码的代码。例如，也许向 JVM 发送终止信号会强制上述输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T19:38:24.350

MXBean 有什么问题？实施并不难。

我用过类似的东西：

```
 List<GarbageCollectorMXBean> gcList = ManagementFactory.getGarbageCollectorMXBeans();
    for(GarbageCollectorMXBean tmpGC : gcList){

        System.out.println("\nName: " + tmpGC.getName());
        System.out.println("Collection count: " + tmpGC.getCollectionCount());
        System.out.println("Collection time: " + tmpGC.getCollectionTime());
        System.out.println("Memory Pools: ");

        String[] memoryPoolNames = tmpGC.getMemoryPoolNames();
        for(String mpnTmp : memoryPoolNames){
            System.out.println("\t" + mpnTmp);
        }

    }

    System.out.println( "Memory Pools Info" );
    List<MemoryPoolMXBean> memoryList = ManagementFactory.getMemoryPoolMXBeans();
    for(MemoryPoolMXBean tmpMem : memoryList){

        System.out.println("\nName: " + tmpMem.getName());
        System.out.println("Usage: " + tmpMem.getUsage());
        System.out.println("Collection Usage: " + tmpMem.getCollectionUsage());
        System.out.println("Peak Usage: " + tmpMem.getPeakUsage());
        System.out.println("Type: " + tmpMem.getType());
        System.out.println("Memory Manager Names: ") ;

        String[] memManagerNames = tmpMem.getMemoryManagerNames();
        for(String mmnTmp : memManagerNames){
            System.out.println("\t" + mmnTmp);
        }
        System.out.println("\n");
    }

    MemoryUsage mu =ManagementFactory.getMemoryMXBean().getHeapMemoryUsage();
    MemoryUsage muNH =ManagementFactory.getMemoryMXBean().getNonHeapMemoryUsage();
    System.out.println(
            "Init :"+mu.getInit()+
            "\nMax :"+mu.getMax()+
            "\nUsed :"+mu.getUsed()+
            "\nCommited :"+mu.getCommitted()+
            "\nInit NH :"+muNH.getInit()+
            "\nMax NH :"+muNH.getMax()+
            "\nUsed NH:"+muNH.getUsed()+
            "\nCommited NH:"+muNH.getCommitted()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T14:55:11.267

您可以使用选项启动 JVM，以控制此类信息的运行时输出。

请参阅[java 工具文档](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/java.html)。

例如输出到控制台：

```
java -verbose:gc 
```

或输出到文件：

```
java -Xloggc:your.log.file 
```

使用这些选项中的任何一个，JVM 都会在 VM 运行时记录每个 GC 事件（而不仅仅是在它退出时）。

# wolfram-mathematica - 如何将函数 J 声明为 q 的函数？

> ID：10999083
> 
> 赞同：1
> 
> 时间：2012-06-12T14:46:40.910
> 
> 标签：wolfram-mathematica

您如何在 Mathematica 中编写以下内容？

```
J[x,t]=q[x,t]*D[q[x,t],x] 
```

我想在另一个等式中使用这个身份。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:34:28.663

以下是如何定义这样的函数：

```
J[x_, q_] := q*D[q, x] 
```

所以，例如，

```
J[x, q[x, t]] 
```

会给

```
q[x, t] * D[q[x, t], x] 
```

# algorithm - 给定节点关系数据结构，如何对父子列表进行排序？

> ID：10999094
> 
> 赞同：0
> 
> 时间：2012-06-12T14:47:12.813
> 
> 标签：algorithm, perl, graph, perl-data-structures, topological-sort

此图显示了父子关系树。它是定向的，没有循环。一个孩子可以有多个父母。

![](../Images/0998974a276ac27961a189d3da512639.png)

Perl 中对应的数组数组是：

```
(
    [A C],
    [B C],
    [D F G],
    [C E D],
    [E J X I],
    [I J]
) 
```

每个子数组中的**第一个**元素是其余元素的父元素，子数组的数量是至少有一个孩子的节点的数量。

# 问题

我想为每个节点分配一个数字，告诉它在图中的哪个级别。该级别还应该说明两个节点是否**独立**，我的意思是它们不是**直接**的父子关系。这个具体例子的答案应该（在许多其他答案中）是：

```
[A B C D E F G X I J]
[1 1 2 3 3 4 4 4 4 5] 
```

我的解决方案可以用任何语言实现，但首选 Perl。

尽管如此，建议的解决方案似乎都不适用于这个数组：

```
(
  [ qw( Z A   )],
  [ qw( B D E ) ],
  [ qw( A B C ) ],    
  [ qw( G A E  )],
  [ qw( L B E )]  
) 
```

一样

```
(
  [ qw/ M A / ],
  [ qw/ N A X / ],
  [ qw/ A B C / ],
  [ qw/ B D E / ],
  [ qw/ C F G / ], 
  [ qw/ F G / ]
  [ qw/ X C / ]
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:04:30.250

该[`Graph::Directed`](https://metacpan.org/module/Graph%3a%3aDirected)模块将使处理此类数据变得更简单。

多个源节点使其可能更复杂（例如，如果有另一个边缘`[Y, X]`），但只要所有源都在第一级，它就可以工作。

下面是一些代码，可以产生您所说的您期望的信息。它假设顶层以下的所有节点都可以从第一个源节点访问，并从那里测量它们的路径长度，忽略第二个源。

```
use strict;
use warnings;

use feature 'say';

use Graph::Directed;

my @data = (
  [ qw/ A C / ],
  [ qw/ B C / ],
  [ qw/ D F G / ],
  [ qw/ C E D / ],
  [ qw/ E J X I / ],
  [ qw/ I J / ],
);

my $graph = Graph->new(directed => 1);

for my $item (@data) {
  my $parent = shift @$item;
  $graph->add_edge($parent, $_) for @$item;
}

my ($source) = $graph->source_vertices;

for my $vertex (sort $graph->vertices) {
  my $path;
  if ($graph->is_source_vertex($vertex)) {
    $path = 0;
  }
  else {
    $path = $graph->path_length($source, $vertex);
  }
  printf "%s - %d\n", $vertex, $path+1;
} 
```

**输出**

```
A - 1
B - 1
C - 2
D - 3
E - 3
F - 4
G - 4
I - 4
J - 4
X - 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T17:41:26.543

[*这为每个节点计算从根节点到最短路径的长度。但是OP想要每个根的最短路径中最长的长度。*]

您所要做的就是找到根节点，然后进行广度优先遍历。

```
my %graph = map { my ($name, @children) = @$_; $name => \@children } (
    [qw( A C )],
    [qw( B C )],
    [qw( D F G )],
    [qw( C E D )],
    [qw( E J X I )],
    [qw( I J )]
);

my %non_roots = map { $_ => 1 } map @$_, values(%graph);
my @roots = grep !$non_roots{$_}, keys(%graph);

my %results;
my @todo = map [ $_ => 1 ], @roots;
while (@todo) {
   my ($name, $depth) = @{ shift(@todo) };
   next if $results{$name};

   $results{$name} = $depth;
   push @todo, map [ $_ => $depth+1 ], @{ $graph{$name} }
      if $graph{$name};
}

my @names  = sort { $results{$a} <=> $results{$b} || $a cmp $b } keys(%results);
my @depths = @results{@names};
print "@names\n@depths\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-17T11:42:59.917

最后，我想我已经解决了找到正确关卡的问题，使用了 Borodin 和 ikegami 的解决方案（谢谢大家，非常感谢您的努力）：

```
#!/usr/local/perl -w 

use strict;
use warnings;
use Graph::Directed;
use List::Util qw( min max );

# my @data = (
# [ qw/ M A/ ],
# [ qw/ N A X/ ],
# [ qw/ A B C / ],
# [ qw/ B D E F/ ],
# [ qw/ C F G / ], 
# [ qw/ F G / ],
# [ qw/ X C G/ ],
# [ qw/ L A B /],
# [ qw/ Q M D/]
# );

# my @data = (
# [ qw( Z A   )],
# [ qw( B D E ) ],
# [ qw( A B C ) ],    
# [ qw( G A E  )],
# [ qw( L B E )]  
# );

# my @data = (
# [ qw/ M A / ],
# [ qw/ N A X / ],
# [ qw/ A B C / ],
# [ qw/ B D E / ],
# [ qw/ C F G / ], 
# [ qw/ F G / ],
# [ qw/ X C / ]
# );

my @data = (
[ qw/ A M B C/ ],
[ qw/ B D F C/ ],
[ qw/ D G/ ],
[ qw/ F G/ ],
[ qw/ C G/ ],
[ qw/ M G/ ],  
);

sub createGraph{
my @data = @{$_[0]};
my $graph = Graph->new(directed => 1);

foreach (@data) {
  my ($parent, @children) = @$_;
  $graph->add_edge($parent, $_) for @children;
}

my @cycleFound = $graph->find_a_cycle;    
print "$_\n" for (@cycleFound);
$graph->is_dag() or die("Graph has cycles - unable to sort\n");
$graph->is_weakly_connected() or die "Graph not weakly connected - unable to analyze\n";  
return $graph;
}

sub getLevels{
my @data = @{$_[0]};
my $graph = createGraph \@data;

my @artifacts = $graph->topological_sort();
chomp @artifacts; 
print "--------------------------\n";
print "Topologically sorted list: \n";
print "$_ " for @artifacts;        
print "\n--------------------------\n";

print "Initial levels (longest path):\n";
my @sources = $graph->source_vertices;
my %max_levels = map { $_=>[]} @artifacts;
my @levels = ();
for my $vertex (@artifacts) {
    my $path = 0;
    foreach(@sources){
        if(defined($graph->path_length($_, $vertex))){
            if ($graph->path_length($_, $vertex) > $path){
                $path = $graph->path_length($_, $vertex)
            }
        }
    }
 printf "%s - %d\n", $vertex, $path;
 push @levels, $path;
 push @{$max_levels{$vertex}}, $path;
}
print "--------------------------\n";

for (my $i = 0; $i < @levels; $i++){ 
my $parent_level = $levels[$i];
my $parent = $artifacts[$i];                
    for (my $j = $i+1; $j < @levels; $j++){ 
        my $child = $artifacts[$j];
        for (@data){
            my ($p, @c) = @{$_};
            if($parent eq $p){
                my @matches = grep(/$child/, @c);
                if(scalar(@matches) != 0){
                    $levels[$j]  = 1 + $parent_level;
                    push @{$max_levels{$child}},$levels[$j];
                    $levels[$j] = max @{$max_levels{$child}};
                }
            }
        }
    }            
}
print "Final levels:\n";
my %sorted = ();
for (my $i = 0; $i < @levels; $i++){
    $sorted{$artifacts[$i]} = $levels[$i];
}
my @orderedList = sort { $sorted{$a} <=> $sorted{$b} } keys %sorted;
print "$sorted{$_} $_\n" for @orderedList;
print "--------------------------\n";   
return  \%max_levels;
}

getLevels \@data; 
```

输出：

```
 --------------------------
    Topologically sorted list:
    A M B D C F G
    --------------------------
    Initial levels (longest path):
    A - 0
    M - 1
    B - 1
    D - 2
    C - 1
    F - 2
    G - 2
    --------------------------
    Final levels:
    0 A
    1 M
    1 B
    2 F
    2 C
    2 D
    3 G
    -------------------------- 
```

# c# - 我在 C# 绘图应用程序中有一些错误？

> ID：10999095
> 
> 赞同：-1
> 
> 时间：2012-06-12T14:47:17.883
> 
> 标签：c#, system.drawing

我正在使用 Visual Studio 2010 制作绘图应用程序，但问题是当我尝试编译它说的程序时

1) 类型名称 'DrawingBoard' 不存在于类型 'DrawingBoard.DrawingBoard'**第 33 行**

2) 类型名称 'Toolbox' 不存在于类型 'DrawingBoard.DrawingBoard'**第 34 行**

3) 非静态字段、方法或属性“DrawingBoard.DrawingBoard.EditOption.get”**第 74 行需要对象引用**

该程序的代码在下面，我指出了单词问题的错误。如果您能帮助我，我将不胜感激。

```
using System.Drawing;

namespace DrawingBoard
{
    partial class WinForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;
        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.splitContainerMain = new System.Windows.Forms.SplitContainer();
            this.drawingBoard = new DrawingBoard.DrawingBoard();//problem
            this.toolBox = new DrawingBoard.Toolbox.ToolBox();//problem
            this.splitContainerMain.Panel1.SuspendLayout();
            this.splitContainerMain.Panel2.SuspendLayout();
            this.splitContainerMain.SuspendLayout();
            this.SuspendLayout();
            // 
            // splitContainerMain
            // 
            this.splitContainerMain.Dock = System.Windows.Forms.DockStyle.Fill;
            this.splitContainerMain.Location = new System.Drawing.Point(0, 0);
            this.splitContainerMain.Margin = new System.Windows.Forms.Padding(2);
            this.splitContainerMain.Name = "splitContainerMain";
            // 
            // splitContainerMain.Panel1
            // 
            this.splitContainerMain.Panel1.Controls.Add(this.drawingBoard);
            // 
            // splitContainerMain.Panel2
            // 
            this.splitContainerMain.Panel2.Controls.Add(this.toolBox);
            this.splitContainerMain.Size = new System.Drawing.Size(853, 553);
            this.splitContainerMain.SplitterDistance = 532;
            this.splitContainerMain.SplitterWidth = 3;
            this.splitContainerMain.TabIndex = 37;
            // 
            // drawingBoard
            // 
            this.drawingBoard.AllowDrop = true;
            this.drawingBoard.AutoScroll = true;
            this.drawingBoard.BackColor = System.Drawing.Color.White;
            this.drawingBoard.BackgroundImageAlpha = ((byte)(255));
            this.drawingBoard.BackgroundImageLayout = System.Windows.Forms.ImageLayout.Stretch;
            this.drawingBoard.BackgroundImageX = 0;
            this.drawingBoard.BackgroundImageY = 0;
            this.drawingBoard.BoundedCanvasHeight = 1140;
            this.drawingBoard.BoundedCanvasWidth = 810;
            this.drawingBoard.CanvasOriginX = 0;
            this.drawingBoard.CanvasOriginY = 0;
            this.drawingBoard.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.Default;
            this.drawingBoard.Dock = System.Windows.Forms.DockStyle.Fill;
            this.drawingBoard.EditOption = DrawingBoard.EditOption.Select; //problem
            this.drawingBoard.GridColor = System.Drawing.Color.Gainsboro;
            this.drawingBoard.GridSize = 0;
            this.drawingBoard.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.Default;
            this.drawingBoard.IsBoundedCanvas = true;
            this.drawingBoard.Location = new System.Drawing.Point(0, 0);
            this.drawingBoard.Name = "drawingBoard";
            this.drawingBoard.PaperOutsideColor = System.Drawing.Color.FromArgb(((int)(((byte)(230)))), ((int)(((byte)(230)))), ((int)(((byte)(255)))));
            this.drawingBoard.ShowPaperOutside = true;
            this.drawingBoard.Size = new System.Drawing.Size(532, 553);
            this.drawingBoard.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;
            this.drawingBoard.StickyEditOption = true;
            this.drawingBoard.TabIndex = 3;
            this.drawingBoard.TextRenderingHint = System.Drawing.Text.TextRenderingHint.AntiAlias;
            this.drawingBoard.Zoom = 1F;
            // 
            // toolBox
            // 
            this.toolBox.AutoSize = true;
            this.toolBox.Dock = System.Windows.Forms.DockStyle.Fill;
            this.toolBox.Drawingboard = null;
            this.toolBox.Location = new System.Drawing.Point(0, 0);
            this.toolBox.Margin = new System.Windows.Forms.Padding(4);
            this.toolBox.Name = "toolBox";
            this.toolBox.Size = new System.Drawing.Size(318, 553);
            this.toolBox.TabIndex = 1;
            // 
            // WinForm
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(192)))), ((int)(((byte)(255)))), ((int)(((byte)(192)))));
            this.ClientSize = new System.Drawing.Size(853, 553);
            this.Controls.Add(this.splitContainerMain);
            this.Name = "WinForm";
            this.Text = "DrawingBoard";
            this.splitContainerMain.Panel1.ResumeLayout(false);
            this.splitContainerMain.Panel2.ResumeLayout(false);
            this.splitContainerMain.Panel2.PerformLayout();
            this.splitContainerMain.ResumeLayout(false);
            this.ResumeLayout(false);

        }

        #endregion

        private System.Windows.Forms.SplitContainer splitContainerMain;
        private DrawingBoard drawingBoard;
        private global::DrawingBoard.Toolbox.ToolBox toolBox;

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:52:42.717

听起来您有命名空间问题，并且看起来`DrawingBoard.DrawingBoard`可能会引起混淆。尝试重命名您的命名空间以省略重复的名称。使用格式，例如`Solution.Project.Module`. 在你的情况下，它可能是`MySolution.DrawingBoard`.

# iphone - NSManagedObject：isUpdated 和 changedValues 不一致

> ID：10999097
> 
> 赞同：4
> 
> 时间：2012-06-12T14:47:25.480
> 
> 标签：iphone, objective-c, ios, core-data

我有一个核心数据实体类，它是 NSManagedObject 的子类。

我想用最后一个 modif 更新实体的属性。时间戳，所以我正在实现它的`willSave`方法。

我发现当调用该方法时，`isUpdated`返回 TRUE 但`changedValues`为空（与 相同`changedValuesForCurrentEvent`）。

你能解释一下怎么可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-01T12:37:15.410

state 方法`isUpdated`设置为`YES`当任何导致 KVO 通知的属性更新时，因此将属性重新设置为它的当前值将导致`isUpdated`设置为`YES`.

`changedValues`*返回实际*更改的属性。也许像这样的类别方法会有所帮助：

```
- (BOOL) isActuallyUpdated
{
    return self.changedValues.count > 0
} 
```

# php - Codeigniter 将表单字段合并到数据库中

> ID：10999102
> 
> 赞同：2
> 
> 时间：2012-06-12T14:47:46.290
> 
> 标签：php, database, codeigniter, model

我的视图页面上有两个表单字段，一个日期输入（带有日期选择器弹出窗口）和一个时间输入。

将这些值传递到模型中时，是否可以将它们合并在一起，以便它们都进入具有时间戳类型的单个数据库字段？例如 12/12/2012 + 14:20 并作为 2012/12/12 14:20:00 保存到数据库

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:06:37.097

如果您只想将它​​们连接在一起，并且您可以将组合字段作为字符串，您可以连接起来。

```
$date = $this->input->post('date');
$time = $this->input->post('time');

$timestamp = "$date "."$time"; 
```

您还需要在数据库模型中为这个新的时间戳字段创建一个字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T17:59:30.973

您还应该对日期进行某种验证，以确保是否适合您的数据库格式

如下所示：

```
$date = new DateTime($this->input->post("date");
$time = new DateTime($this->input->post("time");

$datetime = $date->format("Y-m-d") . $time->format("H:i:s"); 
```

然后在要插入的模型中使用 $datetime 变量。

# jquery - 使用 jquery 创建/渲染 html 表单

> ID：10999112
> 
> 赞同：3
> 
> 时间：2012-06-12T14:48:37.637
> 
> 标签：jquery, forms, creation

我构建了一个从 DB 表生成简单表单的脚本（经典 asp）。我给它一个表名，它会生成一个带有表单的 HTML 页面。对于表中的每个字段，它都会在表单中生成一个输入框。

我也很容易在每个页面中创建一个 javascript 对象来描述每个表单输入（预期值，可选或不可选，默认值等......）

我的问题是是否有一个 jquery 插件（或类似的东西）知道如何获取这样的数据，并用更合适的东西替换每个输入。

谢谢，阿米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:00:56.337

我不知道任何这样的插件，你可以（并且应该）做的是查看数据库中的数据类型，如果字段是 INT（SHORTINT，BIGINT），使用`<input type=number>`，如果是 BOOL，使用`<input type=checkbox>`, 如果它是一个 ENUM, 使用`<input type=radio>`, 等等。

这应该在**服务器端**完成，而不是客户端。不要依赖 JavaScript 来获得关键的可用性功能。

# c# - 从 C# 将变量传递给 powershell：输出文件位置变量

> ID：10999115
> 
> 赞同：0
> 
> 时间：2012-06-12T14:48:46.637
> 
> 标签：c#, powershell

我最近开始使用 C# 调用 powershell 脚本，并取得了一些成功:)

```
$spWeb = Get-SPWeb -Identity http://127.0.0.1 
$listTemplate = [Microsoft.SharePoint.SPListTemplateType]::DocumentLibrary 
$spWeb.Lists.Add($args, "", $listTemplate) > $myDirectory 
```

* * *

`$spWeb.Lists.Add`返回一个 SharePoint GUID。

**问题：**

> 我只是希望传入将写入 GUID 的目录/文件名。那怎么可能呢？

我在这里的 MSDN 论坛上发帖：http: [//goo.gl/5p0oz](http://goo.gl/5p0oz)但由于看似死胡同的线程，我继续在 stackoverflow 上进行搜索。这篇文章是通过 MSDN 响应找到的信息的累积收集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:36:36.290

您可以尝试使用`Set-Content cmdlet`，就像这样。您需要将 $myFile 作为字符串传递，然后 Set-Content 将为您完成剩下的工作 -

在您的脚本中，即`MyScript.ps1`此处，您将拥有这段代码 -

```
param([string]$parameter, [string]$myFile)
try
{
    $spWeb = Get-SPWeb -Identity http://127.0.0.1 
    $listTemplate = [Microsoft.SharePoint.SPListTemplateType]::DocumentLibrary 
    $guid = $spWeb.Lists.Add($parameter, "", $listTemplate)
    $guid | Set-Content $myFile
}
catch
{
    throw ("Failed. The error was: '{0}'." -f $_ )
} 
```

如何运行：打开 Powershell Prompt 并输入

`.\MyScript.ps1 "someparam1" "D:\Output.txt"`

**C#位 -**

```
private PowerShell _ps;
_ps = PowerShell.Create();

var parameter = new List<string>
                                {
                                    parameter,
                                    myFile
                                };

var sr = new StreamReader(@"C:\MyScript.ps1");
_ps.AddScript(sr.ReadToEnd()).AddParameters(parameter);
_ps.Invoke(); 
```

# javascript - 有条件地设置aspx控件的javascript属性？

> ID：10999123
> 
> 赞同：0
> 
> 时间：2012-06-12T14:49:31.517
> 
> 标签：javascript, asp.net, if-statement, conditional

我在项目中使用 DevExpress 树列表控件。其中一列允许单击时调用 javascript 函数的图标。当我们的单选按钮之一 index != 0; 时，我们现在需要不调用其中一个函数的一部分；

在 ClientSideEvents 类中，我将 CustomButtonClick 属性设置为根据在列中单击的按钮运行的 javascript。相关代码：

```
<ClientSideEvents 
                    CustomButtonClick="function(s, e) 
                                       {                                 
                                            switch(e.buttonID)
                                            {
                                                case 'scMarkRead':
                                                    treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                                    break;
                                                case 'scMarkUnread':
                                                    treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                                    break;
                                                case 'scStrike':                                                        
                                                    treeWatches.GetNodeValues(e.nodeKey, &quot;Database&quot;, addDB);                                                                                            
                                                    treeWatches.PerformCallback('scMarkRead|' + e.nodeKey);                                                    
                                                    break;
                                                case 'scCreateTask':
                                                    var fields = [&quot;Database&quot;, &quot;Filename&quot;, &quot;Name&quot;];
                                                    treeWatches.GetNodeValues(e.nodeKey, fields, createTask);
                                                    break;
                                                case 'scDelete':
                                                    treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                            } 
```

在“scStrike”的情况下，如果 radlstGroup.SelectedIndex != 0，我不想调用 treeWatches.PerformCallback.... 行。在其他地方，我能够将代码包装在条件 <% if else {} %> 和它工作得很好，但这是围绕我不想显示的控件。当我尝试下面的示例时，页面加载但我的树列表不会扩展。

```
 <ClientSideEvents 
                        CustomButtonClick="function(s, e) 
                                           {           
                                                var url = 'http://gcs.regscan.com/strike/Strike.aspx?db=';      

                                                switch(e.buttonID)
                                                {
                                                    case 'scMarkRead':
                                                        treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                                        break;
                                                    case 'scMarkUnread':
                                                        treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                                        break;
                                                    case 'scStrike':                                                        
                                                        treeWatches.GetNodeValues(e.nodeKey, &quot;Database&quot;, addDB);                                                                                            
<% if (radlstGroup.SelectedIndex == 0)
{%>                                                       
treeWatches.PerformCallback('scMarkRead|' + e.nodeKey); 
<%} %>                                                   
                                                        break;
                                                    case 'scCreateTask':
                                                        var fields = [&quot;Database&quot;, &quot;Filename&quot;, &quot;Name&quot;];
                                                        treeWatches.GetNodeValues(e.nodeKey, fields, createTask);
                                                        break;
                                                    case 'scDelete':
                                                        treeWatches.PerformCallback(e.buttonID + '|' + e.nodeKey);
                                                } 
```

在最坏的情况下，我确信我可以将 if 块放在控件的整个 div 周围，并在 else 中放置相同的代码而没有该行，但是为了省去一行而再次重复 100 多行代码似乎很愚蠢。有什么好的建议吗？

# c++ - 您可以在类或结构中使用线程局部变量吗

> ID：10999131
> 
> 赞同：30
> 
> 时间：2012-06-12T14:49:49.720
> 
> 标签：c++, c, multithreading, thread-local

像这样。

```
struct some_struct
{
 // Other fields
 .....
 __thread int tl;
} 
```

我正在尝试这样做，但编译器给了我这个错误。

```
./cv.h:16:2: error: '__thread' is only allowed on variable declarations
        __thread int tl; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-12T14:53:22.120

在 C 和 C++ 中，线程局部存储仅适用于静态变量或具有外部链接的变量。

本地（自动）变量通常在堆栈上创建，因此特定于执行代码的线程，但全局和静态变量在所有线程之间共享，因为它们驻留在数据或 BSS 段中。TLS 提供了一种机制，使这些全局变量对线程来说是本地的，这就是`__thread`关键字所实现的 - 它指示编译器在每个线程中创建变量的单独副本，而在词法上它仍然是全局或静态的（例如，它可以是由在同一执行线程中调用的不同函数访问）。

非静态类成员和结构成员放置在分配对象（类或结构）的位置 - 如果声明了自动变量，则放置在堆栈上，如果使用 或，则放置在`new`堆上`malloc()`。无论哪种方式，每个线程都会接收到变量的唯一存储位置，并且`__thread`在这种情况下不适用，因此会出现编译器错误。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-12T14:52:39.443

`gcc`对的使用施加以下[限制](http://gcc.gnu.org/onlinedocs/gcc-4.4.4/gcc/Thread_002dLocal.html)`__thread`：

> 说明`__thread`符可以应用于类的任何全局、文件范围的静态、函数范围的静态或静态数据成员。它可能不适用于块范围的自动或非静态数据成员。

该`__thread`修饰符由多个编译器支持。确切的限制因编译器而异，这并非不可想象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-07-01T02:56:13.867

你应该`__thread int tl;`改为`thread_local static int tl;`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-12T15:03:19.623

C11 标准**第 6.7.1 节第 2 段**

> 最多可以在声明中的声明说明符中给出一个存储类说明符，但 _Thread_local 可能与 static 或 extern 一起出现。120)

C11 标准**第 6.7.1 节第 3 段**

> 在块范围对象的声明中，如果声明说明符包括 _Thread_local，则它们还应包括 static 或 extern。如果 _Thread_local 出现在对象的任何声明中，它应该出现在该对象的每个声明中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-12T14:54:59.847

根据 Petzold 的旧书“Programming Windows”（第 1241 页），您可以使用以下关键字将变量标记为线程本地：__declspec（线程）。例如： __declspec (thread) int iGlobal = 1;

我怀疑这可以在课堂上完成。您也可以将变量设为静态。[编辑] 刚刚意识到你可能没有在 Windows 上运行......所以我想对于任何需要 Windows 答案的人来说，这可能是相关的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-14T06:18:44.283

这样写：

```
template <class T> struct S {
    thread_local static int tlm;
};
template <> thread_local int S<float>::tlm = 0; // "static" does not appear here 
```

如[https://en.cppreference.com/w/cpp/language/storage_duration中所述](https://en.cppreference.com/w/cpp/language/storage_duration)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-06T08:04:59.480

您还可以将结构本身指定为线程本地。例如;

```
#include <pthread.h>

thread_local struct gl_i_t{
    int a; 
    int b;
}GL_i_t; 
```

然后你可以在线程中使用 GL_i_t 变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-12T15:34:16.353

对于 C 来说，这没有多大意义，`static`（= 全局）成员只是 C++ 的一个特性。因此，新的 C11 标准（引入`_Thread_local`）不允许这样做。基本上所有地方都允许这些野兽，只要允许具有静态存储持续时间的变量。

对于 C++，这在类似于成员的类中可能是有意义的`static`，但如果 C++11 允许这样做，我不知道。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-29T13:11:39.973

您可以在 C++ 中`thread_local`用于`static`类或结构的成员。

```
struct some_struct
{
 // Other fields
 .....
 thread_local static int tl;
} 
```

这应该没问题。所以`some_struct::tl`在不同的线程中可能有不同的值。如果你想定义它，你必须`thread_local`再次添加：

```
thread_local int some_struct::tl = 10; 
```

# extjs - 在 EditorGridPanel 中上下移动行

> ID：10999134
> 
> 赞同：2
> 
> 时间：2012-06-12T14:50:01.923
> 
> 标签：extjs, grid, rows, extjs3

有没有人知道/知道 EditorGridPanel 中移动行的工作示例（或知道为什么它对我不起作用）？我发现了几个例子，我发现的例子使用了这种方法：

```
// calculate the new index, then remove the record from the store, and re-insert it at the new index
grid.getStore().remove(record);
grid.getStore().insert(index, record); 
```

就我而言，这失败了。它在网格中看起来不错，但实际上有 2 个 DELETE http 请求被发送到服务器，并且没有 PUT。当我重新加载页面时，这一点变得很明显 - 移动的行实际上已被删除。

他是我商店的基本配置：

```
var remoteJsonStore = new Ext.data.JsonStore({
            storeId: 'colStore',
            autoDestroy: false,
            autoSave: true,
            proxy: new Ext.data.HttpProxy({url:'/exercises/collect/data_rows'}),
            restful: true,
            format: 'json',
            disableCaching: false,
            autoLoad: true,
            writer: new Ext.data.JsonWriter({
              encode: false
            }),
            root: 'data',
            idProperty: 'data_row_id',
            fields: recordFields,
            baseParams:{section_id:GridUtils.properties[gridId]['section_id']},
            listeners:{
              exception:function(misc){
                 // stuff....
              },
              beforewrite:function(store, action, rs, options, arg){
                this.baseParams["position"]=rs.rowIndex;
              },
              beforesave:function(store, data){
                 // stuff....                }
              }
            }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T20:16:29.570

在实现 DnD 重新排序视图时，我遇到了类似的问题。问题是商店将每个 remove()d 记录标记为删除，即使您重新插入它也是如此。

阅读 Ext.data.Store 的 remove() 方法的源码，我找到了一个解决方案：

```
remove: function(records, /* private */ isMove) { 
```

看？我们可以传递第二个布尔参数来告诉商店我们只是在移动记录！但是被标记为私有且没有记录，我们在升级到新版本的框架时应该小心。

所以最终的解决方案是：

```
grid.getStore().remove(record, true); // just moving
grid.getStore().insert(index, record); 
```

***ExtJS 版本：4.1***

# eclipse - 问题视图指出在解决路径错误之前无法构建项目

> ID：10999144
> 
> 赞同：-3
> 
> 时间：2012-06-12T14:50:42.610
> 
> 标签：eclipse, java

我正在使用 Eclipse Indigo IDE，在将我的项目合规级别更改为 JDK 1.7 后，它给我的 java 项目文件一个红色感叹号，并且不编译我的任何源代码。有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:02:27.747

请检查您的项目是否正在自动构建。在工作台栏中项目-> 自动构建，如果未勾选则勾选它。你可以去清理项目。我希望如果您正确安装了 JRE，并且选择了正确的 windows->preferences->installed jre 检查，这将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:02:10.843

之前的回答是正确的，但您需要同时应用它们。

1º- 您需要在系统中安装 jvm 1.7 并在 Eclipse 中进行配置。2º- 转到项目属性-> 编译并选择版本 1.7 3º- 在项目属性-> 项目方面选择 Java 编译器 1.7

我希望能帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T14:54:52.960

查看“项目方面”并更改 Java 编译器后，在您的项目和属性上单击鼠标右键。我希望能帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T14:54:00.130

我认为您的 JDK 有问题，您在 IDE 中指定了一个在您的计算机中不存在的 jdk。安装它！

# php - 禁用 JS 时页面内容不同

> ID：10999152
> 
> 赞同：0
> 
> 时间：2012-06-12T14:50:58.443
> 
> 标签：php, javascript, jquery, cookies

我对启用 JS 的检测有一个小问题。不太大，因为我知道我在正确的轨道上。但这是我的交易：

当我尝试使用此代码在 JS (jQuery) 中设置 cookie 时

```
$(window).load(function(){
    $.cookies.set('c_jsEnabled', 'true');
}); 
```

或者只是在普通的 JS 中使用这个代码

```
function setCookie()
{
    document.cookie='c_jsEnabled=true';
}
<body onload="setCookie();"> 
```

然后尝试使用此代码在 PHP 中检测它

```
if($_COOKIE['c_jsEnabled'] == 'true')
{
    if(file_exists('./main.php'))
    {
        require_once ('./main.php');
    }
    echo getIndex();
}
else 
{
    if(file_exists('./noJS.php'))
    {
        require_once ('./noJS.php');
    }
    echo getIndex();
}
setcookie('c_jsEnabled', ''); 
```

需要 2 次页面刷新才能真正将正确的值放入 PHP。我的猜测是，这基本上意味着 PHP 脚本是在 JS 函数被触发之前执行的。这可能是因为上面显示的所有代码都在同一个脚本（index.php）中吗？

这对我来说是个问题，因为我想阻止人们在禁用 JS 时使用我的网站。

有没有办法在 php 尝试获取 cookie 变量之前设置 cookie？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T14:52:47.353

PHP*总是*在 JavaScript 之前“触发”，因为 PHP 在服务器上处理，然后发送 HTML 和 JavaScript 供浏览器处理和呈现。由于这个原因，你永远不能期望 JavaScript 在 PHP 之前执行。

在您的情况下，使用 JavaScript 设置 cookie，然后执行重定向以刷新页面，以便 PHP 可以获取 cookie 值并采取相应措施。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T14:53:32.360

您应该直接从 PHP 文件设置 cookie。这样，您就知道它的存在，更重要的是，您可以控制 cookie。您可以从客户端设置它，但这将始终在 HTML 发送到浏览器后执行，因此 PHP 文件将在下一个请求之前获取它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T14:58:12.157

PHP 仅在将内容发送到浏览器时发送 cookie 标头。Javascript 然后在此之后执行，因此您需要第二次加载页面来检测 cookie。

这可能会触发无限的重定向循环（特别是如果用户禁用了 cookie），所以要小心。

要对没有 Javascript 的用户禁用该站点，请考虑以下事项。

```
<div id="noscript" style="width:100%; height:100%; z-index:999; position:absoloute; top:0px; left:0px; background-color:#CC9900; display:block">
Please Enable Javascript!</div>
<script type="text/javascript">
document.getElementById('noscript').style.display = 'none';
</script> 
```

我发现`<noscript>`标签不可靠（如果我没记错的话，iOS 中有一个错误导致它只在有 Javascript 时才显示）。

**第二种选择：** 您可以让 PHP 检查 cookie。如果没有设置，让它重定向 ( `header("Location: aaa.html");`) 到带有 Javascript 的页面以设置 cookie 并重定向回来。（或者，让 PHP 输出 Javascript 来设置 cookie 重新加载页面。）然后您只需要担心“欺骗”cookie 的用户，尽管您也会锁定禁用 cookie 的用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T14:54:39.283

不 - PHP 总是在客户端 JavaScript 之前被调用，所以使用这种方法，您总是必须至少刷新一次页面。您最好开发您的网站，以便非 JS 用户有更差但仍然可以接受的体验，或者在最坏的情况下使用 <noscript> HTML 标记为这些用户提供替代内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T14:55:46.913

在页面呈现/执行之前，您无法在 PHP 中获取由 JavaScript 设置的 cookie。

但是，您可以[使用 PHP 设置 cookie](http://php.net/manual/en/function.setcookie.php)。这将确保无论 JavaScript 或多个页面刷新如何，它都已设置并可用。

# javascript - 有没有办法扩展 ThreeJS 对象？

> ID：10999155
> 
> 赞同：2
> 
> 时间：2012-06-12T14:51:05.610
> 
> 标签：javascript, oop, inheritance, three.js

我正在使用 ThreeJS 创建人们可以单击立方体的交互。然而，这些立方体在点击时表现不同（不同的颜色动画，以保持想法简单）。

我的想法是创建 THREE.Mesh 对象的扩展类并添加我的自定义函数和属性。这将有助于隔离多维数据集的不同行为并提供更清晰的代码。

我尝试使用[John Resigs 的函数来扩展类](http://ejohn.org/blog/simple-javascript-inheritance/)，但它似乎只适用于最终扩展他的“类”类的类。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:03:24.163

有几种方法可以在 Javascript 中创建基于类的系统。John Resig 的“类”是一个很棒的类，但它不是 Three.js 使用的继承类型。

注意[Cube 类文件](https://github.com/mrdoob/three.js/blob/master/src/extras/geometries/CubeGeometry.js)中的行：

```
THREE.Geometry.call( this ); 
```

Javascript 没有为类继承提供内置模型，因此除非您使用将继承融入类构造的库（如 John Resig 的），否则您必须显式调用 super 方法。

如果在您的类中调用，您的类将从 CubeGeometry 继承：

```
THREE.CubeGeometry.call( this ); 
```

您可能还希望将 CubeGeometry 设置为原型：

```
THREE.MyCubeGeometry.prototype = new THREE.CubeGeometry();
THREE.MyCubeGeometry.prototype.constructor = THREE.MyCubeGeometry; 
```

# qt - 客户端套接字发送但静默服务器套接字不接收

> ID：10999157
> 
> 赞同：1
> 
> 时间：2012-06-12T14:51:10.053
> 
> 标签：qt, sockets, tcp, serversocket, tcpsocket

我有一个客户端套接字，它在连接握手完成后将图像数据推送到服务器套接字。并且服务器套接字处理它们*而不响应任何东西*

几分钟后效果很好。但是一段时间后，服务器套接字停止获取这些数据。我不知道为什么？TCP中有没有这样的事情，比如如果客户端不断推送数据，服务器必须说些什么，否则对话就会停止？

我几年前写了这段代码。为了让它工作，我让服务器返回一个字符串“ACK”响应。但是，如果我将其更改为任何字符串，它将起作用。

但现在我想弄清楚为什么要重建程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:55:59.813

除非您需要发送方的接收方确认，否则与 TCP 的“单向”通信完全可以。但那是您的应用程序级协议。在传输级别，数据包仍然双向流动——TCP 在两个方向上保持序列号并向另一端确认它们。这允许检测丢弃/重复的数据包并重新传输，从而提供流的可靠性。在连接握手期间协商并在对话期间更新的窗口大小允许 TCP 减慢快速发送方的速度，而这会使慢速接收方不堪重负。

您真正需要做的是使用嗅探器（如wireshark）记录TCP连接，[`tcpdump(1)`](http://www.tcpdump.org/tcpdump_man.html)并[找出](http://www.wireshark.org/)“套接字停止获取这些数据”时线路上发生的情况。

# c++ - 无法修复对 vtable 的未定义引用

> ID：10999158
> 
> 赞同：0
> 
> 时间：2012-06-12T14:51:23.617
> 
> 标签：c++, virtual, vtable, undefined-reference

我已经搜索了一段时间，发现了*很多*涉及我遇到的问题的线程/页面，但我无法找到

1.  解释*为什么*会发生此错误
2.  针对我的具体情况的有效解决方案

以下是`Scanner.h`：

```
class BaseReader {

    public:

    virtual ~BaseReader();

    virtual const char* read() = 0;
    virtual long position() = 0;
    virtual long size() = 0;
    virtual void seek(long position) = 0;

};

class CharReader : public BaseReader {

    public:

    CharReader(const char* source);
    CharReader(const char* source, long size);

    ~CharReader();

    const char* read();
    long position();
    long size();
    void seek(long position);

    private:

    char* _source;
    long _position;
    long _size;

}; 
```

在`Scanner.cpp`我只是实现的构造函数之一`CharReader`。

我使用 Code::Blocks，但自己编译会导致完全相同的问题。

```
niklas@emerald:~/git/hiterator (CPP)$ g++ main.cpp hiterator/Scanner.cpp -o main
/tmp/cclNNwgl.o: In function `hiterator::CharReader::CharReader(char const*)':
Scanner.cpp:(.text+0x16): undefined reference to `vtable for hiterator::CharReader'
collect2: ld gab 1 als Ende-Status zurück 
```

* * *

@qdii：

```
#include "Scanner.h"
using namespace hiterator;

#include <stdlib.h>
#include <string.h>

CharReader::CharReader(const char* source) {
    _size = strlen(source);
    _source = (char*) malloc(_size + 1);
    memcpy(_source, source, _size + 1);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T14:54:14.397

你的程序不正确。所有虚函数都被视为已*使用*（*odr-used*），因此您需要为所有虚函数提供定义。一旦你解决了这个问题，这个问题应该会消失。

编译器抱怨 vtable 不可用。vtable-s 是一个实现细节，因此不被标准处理，但许多编译器会在定义第一个（非内联）虚函数的翻译单元中生成 vtable。在您的情况下，无论生成 vtable 的标准是什么，您都没有遵守它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T14:55:59.013

请参阅我在 GCC wiki 上写的内容，以解释[未定义的对 vtable 的 X](http://gcc.gnu.org/wiki/VerboseDiagnostics#missing_vtable)错误引用。

SO上还有很多关于链接器错误的现有问题，我相信*其中一个*有一个解释它的答案，例如[here](https://stackoverflow.com/a/9635742/981959)或[here](https://stackoverflow.com/a/7665856/981959)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T14:56:02.797

您声明但未定义`BaseReader`. 您需要在`.cpp`文件中为此提供定义，以便生成 vtable `BaseReader`。对`CharReader`.

# java - 在 3rd 方代码中捕获运行时异常

> ID：10999160
> 
> 赞同：1
> 
> 时间：2012-06-12T14:51:28.180
> 
> 标签：java, runtimeexception

我开发了一个框架，它允许其他人插入优化器的不同实现。这些优化器是异步运行的，我在异步代码中附加了在前后运行的监听器，以监控优化器的执行。例如：

```
public void async(Optimizer o){
   runListeners(o);
   o.run();
   runListeners(o);
} 
```

我的问题是一些懒惰的程序员`NullPointerExceptions`在他们的代码中抛出了一些东西，并阻止该方法第二次执行侦听器。我想过抓住`RuntimeException`，但这对我来说感觉不对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T14:54:29.753

任何时候你为插件创建一个框架来运行你都必须考虑如何处理插件抛出的异常，因为你通常不希望一个表现不佳的插件使你的整个程序崩溃。在这里捕获 Exception、RuntimeException 甚至 Throwable 没有任何问题（尽管错误可能仍然是中止的原因）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:54:12.940

```
runListeners(o);
try {
  o.run();
} finally {
  runListeners(o);  // this will get run even if you get NPE
  // now your program crashes with the NPE :)
} 
```

# c# - 设备发送 MDM 命令后不发送任何内容

> ID：10999166
> 
> 赞同：0
> 
> 时间：2012-06-12T14:51:50.623
> 
> 标签：c#, ios, apple-push-notifications, mdm

我成功地向设备发送了 MDM 推送通知，并且设备以空闲状态响应。但是，当我发送 MDM 命令时：

```
<?xml version=\"1.0\" encoding=\"utf-16\"?>
<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">
<plist version=\"1.0\">
  <dict>
    <key>CommandUUID</key>
    <string>4FB2550B-ADFD-425C-BF6C-92CEDE747F23</string>
    <key>Command</key>
    <dict>
      <key>RequestType</key>
      <string>InstalledApplicationList</string>
    </dict>
  </dict>
</plist> 
```

该设备不包含任何响应。它以某种方式关闭连接。我正在编写 XML，然后读取流以检查同一连接上的响应。当我关闭连接然后重新发送推送通知时，我得到了这个空响应：

```
PUT / HTTP/1.1
Host: 172.18.130.31:1234
User-Agent: MDM/1.0
Content-Length: 0
Accept: */*
Content-Type: application/x-apple-aspen-mdm
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive 
```

我也尝试了设备信息但无济于事：

```
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>CommandUUID</key>
    <string>7C28313A-BFE7-4430-A516-BB16C8F6F750</string>
    <key>Command</key>
    <dict>
      <key>RequestType</key>
      <string>DeviceInformation</string>
      <array>
        <string>DeviceName</string>
        <string>OSVersion</string>
        <string>BuildVersion</string>
        <string>ModelName</string>
        <string>Model</string>
        <string>ProductName</string>
        <string>SerialNumber</string>
        <string>DeviceCapacity</string>
        <string>AvailableDeviceCapacity</string>
        <string>BatteryLevel</string>
        <string>CellularTechnology</string>
        <string>IMEI</string>
        <string>MEID</string>
        <string>ModemFirmwareVersion</string>
      </array>
    </dict>
  </dict>
</plist> 
```

它应该发送一个确认状态或至少一个错误。请问我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T13:41:44.507

我也有这种症状，虽然我的问题不同。

您不应该签署您的 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T09:40:07.177

我解决了这个问题。我发送的 XML plist 中的编码是 16 而不是 8。

# jquery - jquerymobile - 下拉链接不起作用？禁用了吗？

> ID：10999171
> 
> 赞同：1
> 
> 时间：2012-06-12T14:52:07.863
> 
> 标签：jquery, mobile, hyperlink

我仅将 jquerymobile 用于其“vmousedown”和“taphold”功能。现在，每当我有一个多级 CSS 下拉菜单时，下拉菜单中的某些链接在 iPad 上不起作用。

每当我点击它时，它都会有一个“#”。我什至尝试将 'rel="external"' 和/或 data-ajax="false" 放在我的链接中，但这仍然不能解决问题。

有没有办法修改 jquerymobile 以便我只使用“vclick”、“vmouseodown”、“taphold”或任何触摸屏功能？我不需要 jquerymobile 如何处理链接。

# c# - MVC 中代码分析规则集 CA1506 的最佳解决方案是什么（我不想压制）

> ID：10999173
> 
> 赞同：2
> 
> 时间：2012-06-12T14:52:18.163
> 
> 标签：c#, asp.net-mvc-3, code-analysis

我正在使用 MVC3。运行代码分析时出现以下错误。

> CA1506：Microsoft.Maintainability：“MyController”与来自 25 个不同命名空间的 94 种不同类型相结合。重写或重构该类的方法以减少其类耦合，或考虑将某些类的方法移至与其紧密耦合的某些其他类型。95 以上的类耦合表示可维护性差，95 到 80 之间的类耦合表示可维护性中等，80 以下的类耦合表示可维护性好。

这是一个控制器类。

我可以知道减少控制器类耦合的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:18:50.700

正如@musefan 所提到的，听起来你需要重构。我刚刚查看了一个我正在使用的项目中的控制器，我认为它处于缺乏凝聚力和需要重构的边缘，并且它与大约 40 种类型相关联。

再看看控制器和它所服务的系统区域，看看你是否可以把它分成更少、更有凝聚力的类。

**编辑**

关于您的控制器为 Word、PDF 和 Excel 提供导出功能，我认为这意味着您的控制器中有逻辑，它知道将 Word 导出、PDF 导出和 Excel 导出放在一起的详细信息，包括您抽象出来的三种格式（页眉和页脚）。

如果我正确理解了这一点，您可以考虑的一种重构是将与页眉、页脚、结构和格式相关的所有逻辑移动到接口后面的不同类中，并让您的控制器引用该接口而不是引用各种类管理这些方面。这会将与控制器的各种类的耦合转移到其接口后面的新文档处理类中，并且可能会将耦合类的数量降低到 FxCop 认为可接受的水平以下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:10:49.210

听起来你的控制器太重了。我不知道这一定意味着您需要将功能拆分为多个控制器。相反，我怀疑这意味着您已经为控制器加载了很多逻辑。人们倾向于避免这种情况有几个原因，其中最重要的是它使控制器更难测试。更重要的是，这通常表明通常在可重用业务层中的逻辑已经渗入您的控制器层。鉴于控制器是特定于 mvc 的，因此当涉及到表示层时，您将业务层耦合到一个不可知的层。

因此，我的建议是仔细查看您的控制器，看看您是否可以战略性地重构。将业务逻辑移动到一个新的业务逻辑层（服务层），我怀疑这自然会解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T12:29:25.187

您应该像 Jimmy Bogard 在此视频中说明的那样节食控制器：http: [//www.viddler.com/v/b568679c](http://www.viddler.com/v/b568679c)

与来自 25 个不同命名空间的 94 种不同类型进行耦合似乎绝对是噩梦。我什至无法想象你的控制器是什么样子的。

请记住：添加类并将职责分离到类中很便宜。将所有代码放在一个类中是一场维护噩梦。一开始它可能看起来很便宜，但相信我，它很快就会变得像地狱一样。

# javascript - 创建文件类型的克隆后，chrome 和 IE 不包含值

> ID：10999174
> 
> 赞同：0
> 
> 时间：2012-06-12T14:52:19.913
> 
> 标签：javascript, jquery

我正在使用以下代码来创建 ajax 上传脚本。我当前的任务是使用 jquery 动态创建一个表单，所以我通过以下代码执行此操作

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<input id="files" name="file" type="file" value=""/>

<script>
$(document).ready(function () {

    $('#files').live('change', function () {
        var formId = 'jUploadForm';
        var form = $('<form action="" method="POST" name="' + formId + '" id="' + formId + '" enctype="multipart/form-data"></form>');
        var oldElement = $('#files');
        var newElement = $(oldElement).clone();

        $(oldElement).attr('id', 'files');
        $(oldElement).before(newElement);

        alert('fffffff');
        //alert(projectid);
        //return false;
        $(oldElement).appendTo(form);
    });
});
</script> 
```

aboce 代码中的错误是，在我选择的文件值之前附加 newElement 之后，我从浏览按钮中选择的任何内容都将消失，这些按钮将出现在克隆的文件类型中，但将从我拥有的原始文件类型中删除。上述问题仅发生在 chrome 和 IE 中它在 mozila 中工作正常请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T14:56:49.077

你不能放`oldElement`之前，`newElement`因为你还没有添加`newElement`到 DOM 中。

同样，您也不能追加`oldElement`到DOM，`form`因为`form`还没有添加到 DOM 中。

两者`newElement`都`form`必须在创建它们之后添加到文档中，然后才能对它们进行任何操作。

最后，你在运行时什么都不做，`$(oldElement).attr('id', 'files');`因为`oldElement`已经*是* `files`.

# jquery - 无法将 div 置于显示下一个 div 的控件附近

> ID：10999186
> 
> 赞同：0
> 
> 时间：2012-06-12T14:53:05.260
> 
> 标签：jquery, ruby-on-rails

感谢大家帮助我，我得到了这段代码，但我需要更多。

下载页面时，隐藏了一块 div，但是当我单击它显示的图像时，

但是：我想在该图像附近写一些文字并放入一些标签，但它会崩溃。

我的代码在视图中：

```
 <% @websites.each do |website| %>
   <div class="sub">
<%= link_to(image_tag("/images/caret-horizontal.png", id: "caret-horizontal"), '#') %>
     <%= website.name %>//when I put this in tag show doesn't work
     <div class="desc">
       <%= website.url %> 
   <%= website.category %> 
    <%= website.language %>
   </div>
    </div>
         <% end %> 
```

我的JavaScript：

```
 $(".sub a").click(function() {
    $(this).next("div").show("medium");
}); 
```

有人可以纠正我或解释怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:00:24.950

如果您在 div 之前的链接旁边放置一些标签，则`next()`无法正常工作？

文档：

```
Get the immediately following sibling of each element in the set of matched elements. 
```

使用`.siblings()`而不是`next()`......这将工作......

# java - 什么是 ？。java中的运算符？

> ID：10999187
> 
> 赞同：0
> 
> 时间：2012-06-12T14:53:07.367
> 
> 标签：java, operators

> **可能的重复：**
> [Java“？” 用于检查 null 的运算符 - 它是什么？（不是三进制！）](https://stackoverflow.com/questions/4390141/java-operator-for-checking-null-what-is-it-not-ternary)
> [Java 空指针安全访问器](https://stackoverflow.com/questions/4402132/java-null-pointer-safe-accessor)

最近我在一个 Java 论坛上读到了关于**? 的内容。**操作员。他们写的？无法进入java 7。任何人都可以解释到底是什么**吗？**是？

另外，我想知道这个运算符是否有任何特定的名称，比如**?:**被称为**三元运算符**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T14:55:38.013

它被称为[Null-safe 运算符](http://metoojava.wordpress.com/2010/11/15/java-7-awesome-features/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T14:57:54.190

我相信您的意思是 Null-safe 运算符，[在此处进行了解释](http://blog.joda.org/2009/01/java-7-null-default-and-null-safe_7527.html)。Java 7 正在考虑使用它，但后来放弃了。

Java 中的另一个常见用途`?`是三元运算符，它自黑暗时代以来一直在 Java 中，并在[此处](http://www.devdaily.com/java/edu/pj/pj010018)进行解释。

两者是完全不同的功能，但是唯一的共同点是它们`?`以某种方式使用 。

# java - 当我使用进度管理器杀死进度时，小部件没有响应

> ID：10999188
> 
> 赞同：3
> 
> 时间：2012-06-12T14:53:07.947
> 
> 标签：java, android, widget, kill, progress

我有一个带有小部件的android应用程序，但是当我使用进度管理器杀死应用程序时，我发现该小部件无法使用。我在小部件中有一些按钮。杀死应用程序后，我单击这些按钮并没有任何动作。是什么导致了这个问题？

# java - 获取 Reader / InputStream 的类 / 接口

> ID：10999199
> 
> 赞同：3
> 
> 时间：2012-06-12T14:53:43.390
> 
> 标签：java, io, inputstream, abstraction

简单的问题：是否有一个类或接口封装了 Reader 或 InputStream 的获取？

我想要的是能够例如从文件中读取两次，或者从 URL 读取两次，并尽可能地封装/抽象 Reader 或 InputStream 的创建

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:06:08.767

在[guava](http://code.google.com/p/guava-libraries/)中，有一个[`InputSupplier`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/InputSupplier.html)界面，似乎可以满足您的需求。

Guava 也有创建 inputSuppliers 的工厂，比如[`Resources`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Resources.html)或[`Files`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html)类——查看`newInputStreamSupplier`这些类中的方法以了解它是如何工作的。

# android - android gridview 在 Galaxy 3 上崩溃

> ID：10999204
> 
> 赞同：7
> 
> 时间：2012-06-12T14:54:00.440
> 
> 标签：android, gridview, galaxy

好的，我想我有一个真正的问题需要改变。[我在 Android 中实现了一个 gridView，按照 Android 开发者页面http://developer.android.com/resources/tutorials/views/hello-gridview.html](http://developer.android.com/resources/tutorials/views/hello-gridview.html)中的说明逐步进行了 更改，以便在单击视图时进行更改，将返回位图。这一切都适用于 Galxy Note 和 Galaxy S2 等高级手机，以及 Galaxy ace 等不太先进的手机，甚至是 2 年前的一些糟糕的 htc。但由于某种原因，由于 OutOfMemory 问题，它在带有 ICS 的 Galaxy 3 上崩溃了。当在 gridview 上使用大约一半的图像时，它确实有效（虽然有点慢）。这对任何人都有意义吗？

这是我对 ImageAdapter 的实现：

```
public class ImageAdapter extends BaseAdapter {
private Context mContext;
private int mWidth;
private int mHeight;

public ImageAdapter(Context c, int width, int height) {
    mContext = c;
    mWidth = width;
    mHeight = height;
}

public int getCount() {
    return mThumbIds.length;
}

public Object getItem(int position) {
    return null;
}

public long getItemId(int position) {
    return mThumbIds[position];
}

// create a new ImageView for each item referenced by the Adapter
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(new GridView.LayoutParams(mWidth, mHeight));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(8, 8, 8, 8);
    } else {
        imageView = (ImageView) convertView;
    }

    imageView.setImageResource(mThumbIds[position]);
    return imageView;
}

// references to our images
private Integer[] mThumbIds = {
        R.drawable.third_world , R.drawable.annoyinggirl,
        R.drawable.asianfather, R.drawable.awkawespeng,
        R.drawable.awkpeng, R.drawable.blankdad,
        R.drawable.collegesenior, R.drawable.courage,
        R.drawable.frog, R.drawable.frynotsure,
        R.drawable.goodguygreg, R.drawable.scumbag,
        R.drawable.raptor,R.drawable.keano,
        R.drawable.successkid, R.drawable.wonka,
        R.drawable.braceyourselves, R.drawable.onedoesnotsimply,
        R.drawable.firstworldproblem, R.drawable.amitheonlyone,
        R.drawable.badluckbrian, R.drawable.interestingman,
        R.drawable.toodamnhigh, R.drawable.def    
}; 
```

}

这是我主要的调用函数：

```
 private void changeToTemplateView(){
    setContentView(R.layout.templates);

    GridView gridview = (GridView) findViewById(R.id.gridview);
    gridview.setAdapter(new ImageAdapter(context, (int)(dstWidth * 1.4), (int)(dstHeight * 1.4)));

    gridview.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v, int position, long id) {

            Options opts = new Options();
            Bitmap bitmap = BitmapFactory.decodeResource(getResources(), (int) parent.getItemIdAtPosition(position), opts);

            //do stuff with bitmap          
        }
    });
} 
```

这是gridview的xml：

```
<?xml version="1.0" encoding="utf-8"?>
<GridView xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@+id/gridview"
android:layout_width="fill_parent" 
android:layout_height="fill_parent"
android:columnWidth="90dp"
android:numColumns="auto_fit"
android:verticalSpacing="10dp"
android:horizontalSpacing="10dp"
android:stretchMode="columnWidth"
android:gravity="center" 
```

/>

如果有人知道我在这里可能做错了什么，我将永远感激不尽

编辑：在崩溃之前，我在日志中收到一个错误：“FimgApiStretch:stretch failed”。此外，gridview 中的滚动不起作用。这与即使没有足够的缩略图导致滚动，应用程序仍然会崩溃的事实无关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:07:44.263

尝试用 match_parent 替换 fill_parent 因为根据我的信息，属性值 fill_parent 在 android 2.2 及更高版本上已弃用希望这会有所帮助

你可以看到这个链接[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html) 我希望这会对你有所帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T16:41:28.603

至于“为什么它会在 Galaxy 3 而不是在劣质手机上崩溃”的问题，答案是“我不知道”。但是，事实证明我一直在滥用gridview。对缩略图和整个图像使用相同的图像是一个坏主意。我所做的（这可能只不过是一种解决方法，但它有效）是使用 2 组图像，小的和全尺寸的 ines。这样做是这样的

设置缩略图：

```
private Integer[] mThumbIds = {
        R.drawable.third_world__small , R.drawable.annoyinggirl__small,
        R.drawable.asianfather__small, R.drawable.awkawespeng__small,
        R.drawable.awkpeng__small, R.drawable.blankdad__small,
        R.drawable.collegesenior__small, R.drawable.courage__small,
        R.drawable.frog__small, R.drawable.frynotsure__small,
        R.drawable.goodguygreg__small, R.drawable.scumbag__small,
        R.drawable.raptor__small,R.drawable.keano__small,
        R.drawable.successkid__small, R.drawable.wonka__small,
        R.drawable.braceyourselves__small, R.drawable.onedoesnotsimply__small,
        R.drawable.firstworldproblem__small, R.drawable.amitheonlyone__small,
        R.drawable.badluckbrian__small, R.drawable.interestingman__small,
        R.drawable.toodamnhigh__small, R.drawable.def__small    
};

public View getView(int position, View convertView, ViewGroup parent) {
    //clearAllResources();
    ImageView imageView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(new GridView.LayoutParams(mWidth, mHeight));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(8, 8, 8, 8);
    } else {
        imageView = (ImageView) convertView;
    }

    imageView.setImageResource(mThumbIds[position]);
    return imageView;
} 
```

然后，创建另一个数组：

```
private Map<Integer, Integer> mThumbIdToFullSizeId = new HashMap<Integer,Integer>();
public ImageAdapter(Context c, int width, int height) {
    mContext = c;
    mWidth = width;
    mHeight = height;
    mThumbIdToFullSizeId.put(R.drawable.third_world__small, R.drawable.third_world);
    mThumbIdToFullSizeId.put(R.drawable.annoyinggirl__small,R.drawable.annoyinggirl);
    mThumbIdToFullSizeId.put(R.drawable.asianfather__small, R.drawable.asianfather);
    mThumbIdToFullSizeId.put(R.drawable.awkawespeng__small, R.drawable.awkawespeng);
    mThumbIdToFullSizeId.put(R.drawable.awkpeng__small, R.drawable.awkpeng);
    mThumbIdToFullSizeId.put(R.drawable.blankdad__small, R.drawable.blankdad);
    mThumbIdToFullSizeId.put(R.drawable.collegesenior__small, R.drawable.collegesenior);
    mThumbIdToFullSizeId.put(R.drawable.courage__small, R.drawable.courage);
    mThumbIdToFullSizeId.put(R.drawable.frog__small, R.drawable.frog);
    mThumbIdToFullSizeId.put(R.drawable.frynotsure__small, R.drawable.frynotsure);
    mThumbIdToFullSizeId.put(R.drawable.goodguygreg__small, R.drawable.goodguygreg);
    mThumbIdToFullSizeId.put(R.drawable.scumbag__small, R.drawable.scumbag);
    mThumbIdToFullSizeId.put(R.drawable.raptor__small, R.drawable.raptor);
    mThumbIdToFullSizeId.put(R.drawable.keano__small, R.drawable.keano);
    mThumbIdToFullSizeId.put(R.drawable.successkid__small, R.drawable.successkid);
    mThumbIdToFullSizeId.put(R.drawable.wonka__small, R.drawable.wonka);
    mThumbIdToFullSizeId.put(R.drawable.braceyourselves__small, R.drawable.braceyourselves);
    mThumbIdToFullSizeId.put(R.drawable.onedoesnotsimply__small, R.drawable.onedoesnotsimply);
    mThumbIdToFullSizeId.put(R.drawable.firstworldproblem__small, R.drawable.firstworldproblem);
    mThumbIdToFullSizeId.put(R.drawable.amitheonlyone__small, R.drawable.amitheonlyone);
    mThumbIdToFullSizeId.put(R.drawable.badluckbrian__small, R.drawable.badluckbrian);
    mThumbIdToFullSizeId.put(R.drawable.interestingman__small, R.drawable.interestingman);
    mThumbIdToFullSizeId.put(R.drawable.toodamnhigh__small, R.drawable.toodamnhigh);
    mThumbIdToFullSizeId.put(R.drawable.def__small, R.drawable.def);
} 
```

然后，对于 getview 函数：

```
public long getItemId(int position) {

    return mThumbIdToFullSizeId.get(mThumbIds[position]);
} 
```

一切都会对记忆更加友好。我给 Muhannad 打勾，因为它给了我指向 [http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)的链接，这对我有很大帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T22:41:58.870

我有一个类似的问题。我的应用程序始终运行良好，没有任何问题，但在运行 Android 4 的设备上开始因*OutOfMemory*错误而崩溃。特别是，它在加载 GalleryView 适配器时崩溃。在阅读了许多官方文档（http://android.developer.com）的页面后，我了解到内存的使用与旧版本的 SO 不同，但最终解决了清单文件的问题。我将 Android 3.0 设置为项目构建目标，添加 android:targetSdkVersion="15"，将 android:largeHeap="true" 添加到应用程序标签，最后添加支持屏幕 android:anyDensity="false"

希望这也可以帮助你！

# delphi - 在 TCustomRichEdit 上方添加一个速度按钮

> ID：10999206
> 
> 赞同：0
> 
> 时间：2012-06-12T14:54:11.863
> 
> 标签：delphi, components, custom-controls, derived

我正在尝试创建一个 TCustomRichEdit，上面有一些速度按钮。我怎样才能完成这种行为？组件的高度需要是按钮+richedit。

```
[B][I][U]
+-------+
|A1REdit|
|       |
+-------+ 
```

目前我有以下代码：

```
private
  FBoldButton: TSpeedButton;

constructor TA1RichEdit.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);

  FBoldButton := TSpeedButton.Create(Self);
  FBoldButton.Parent := Self;
end;

destructor TA1RichEdit.Destroy;
begin
  FreeAndNil(FBoldButton);

  inherited;
end; 
```

这会在richedit 上绘制速度按钮（因为richedit 是父级），我需要按钮位于richedit 上方。在这段代码之后，richedit 不会像它应该的那样绘制自己。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:37:48.330

使用`TToolbar`.

还要在表格上加上 a`TImageList`和 a `TActionList`。

将 ImageList 分配给 ActionList 和 ToolBar。

然后，您可以将一些所谓的标准操作添加到您的 ActionList（“新操作”按钮上的下拉菜单）。

在`Format`类别中，您会找到`TRichEditBold`和。选择它们并单击。`TRichEditItalic``TRichEditUnderline``OK`

然后您将 3 个工具按钮添加到您的工具栏并将您的操作分配给它们。

Everything like the pressed state when something is selected that has this state and automatically setting bold, italic or underlined will be handled without writing any code.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T01:59:14.860

考虑制作一个框架。框架是制作“复合控件”的常用方法，不需要任何编码，在您的情况下，只需表单设计器和属性检查器即可完成。

单击文件-> 新建-> 框架（您可能必须单击文件-> 新建-> 其他，然后如果它不在您的新项目菜单中，则查找框架）。

现在添加按钮和 Rich Edit。将 Rich Edit 上的 Anchors 设置为 Top + Left + Right + Bottom（全部四个 On）。

现在你可以把这个“框架”放在你的应用程序的任何地方，它就像一个单独的控件。

我不喜欢 Frames 的地方在于，您不能阻止实例化框架的人编辑其布局，默认情况下，他们可以在框架内移动控件并添加更多控件，这实际上是一种关于 Frames 的痛苦。

您可以查看的第二种方法是“复合控件”。从 TPanel 继承，并添加 RIch Edit 和您的按钮，全部用代码编写。高度和布局代码由您自己编写，随心所欲。这与您所建议的区别在于您试图使 Rich Edit 包含其他控件，正如 David 明确表示的那样，这是不可能的。

# jquery - 未检索到 mysql 值时隐藏 div

> ID：10999209
> 
> 赞同：1
> 
> 时间：2012-06-12T14:54:22.827
> 
> 标签：jquery

我找到了几种在 div 为空但与 mysql 检索值无关时隐藏 div 的解决方案。

```
<button class="platform_category" id="platform_', $platform['platform_id'],'_category"><a href="', $platform['platform_url'],'" target="_tab">', $platform['platform_category1'],'</a></button> 
```

当 mysql-row 中没有数据时，Jquery 不会隐藏 div，因为它认为 $platform['platform_category1'] 是一个值，即使这只是检索 mysql 值的 php 代码，以防万一。

对于我正在使用的隐藏 jquery 代码：（如果我将 == 替换为 != 它会隐藏）

```
 $(function() {
    $('.platform_category').each(function() {
        if ($(this).html() == "") {
             $(this).hide();
       }
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T14:58:52.030

具有类的按钮具有`platform_category`作为`<a>`内部 html 的标记，因此`html()`方法在这里没有任何意义（它总是会返回`<a>`）。请尝试`text()`：

```
$('.platform_category').each(function() {
    if ($(this).text() == "") {
        $(this).hide();
    }
}); 
```

**好注释**（来自[@Blazemonger](https://stackoverflow.com/questions/10999209/hide-div-when-no-mysql-value-retrieved/10999295#comment14371987_10999295)）：最好使用`$.trim()`以下方法进行文本修剪：

```
if ($.trim($(this).text()) == "") {
    $(this).hide();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:01:58.410

我会使用过滤器来检查`.platform_category`. 见下文，

```
$(function() {
   $('.platform_category').filter(function() {
       return $.trim($(this).text()) == '';
    }).hide();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:01:35.397

问题是 $('.platform_category') 实际上不是空的，因为 div 中总是有一个锚标记。

您可以通过 PHP（最好的）或 JavaScript 两种方式来做到这一点

通过 PHP

```
 if ($platform['platform_category1'] != "") {
     <button class="platform_category" id="platform_', $platform['platform_id'],'_category">
        <a href="', $platform['platform_url'],'" target="_tab">',$platform['platform_category1'],'</a>   
      </button> 
```

如果你必须通过 JavaScript 来做

```
 $(function() {
    $('.platform_category').each(function() {
        if ($(this).find('a').html() == "") {
             $(this).hide();
       }
    }); 
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-12T14:55:25.687

```
$('.platform_category').each(function() {
    if ($.trim( $(this).text() )  ==  "") {
        $(this).hide();
    }
}); 
```

# magento - Magento 和 Campaign 监视器集成

> ID：10999217
> 
> 赞同：2
> 
> 时间：2012-06-12T14:54:37.510
> 
> 标签：magento

有没有一种简单的方法可以将活动监视器集成到 Magento (CE) 中。

具体来说，我希望客户在成功购买后注册到“客户”邮件列表。

我尝试了几个扩展，但未提供此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-02T20:47:55.257

这可能是一个旧帖子。但是有一个新的 Magento Campaign Monitor 扩展与较新的 Magento 版本兼容。你可以在这里找到它。 [https://github.com/weprovide/Magento_Campaign_Monitor](https://github.com/weprovide/Magento_Campaign_Monitor)

# django - 配置文件创建错误：重复键值...user_id 已存在

> ID：10999221
> 
> 赞同：0
> 
> 时间：2012-06-12T14:54:44.640
> 
> 标签：django, django-authentication, django-forms

我正在创建一个具有两种类型的用户配置文件（DoctorProfile 和 PatientProfile）的站点。每个扩展 UserProfile，它与 User 具有 OneToOneField 关系。

尝试通过 ModelForm 注册新用户时，遇到以下错误：

```
duplicate key value violates unique constraint "accounts_userprofile_user_id_key"
DETAIL:  Key (user_id)=(38) already exists. 
```

这似乎在创建 PatientProfile 时发生，它尝试创建用户。但是，用户已经使用`User.objects.create_user()`

如何配置它以便我只能创建一次用户？

这是我的（精简版）forms.py：

```
class PatientProfileForm(ModelForm):
    supplied_email = forms.CharField(max_length=256, label="Email Address", required=True)
    supplied_password = forms.CharField(max_length=256, label="Password", required=True, widget=forms.PasswordInput())
    supplied_password_confirm = forms.CharField(max_length=256, label="Password (again)", required=True, widget=forms.PasswordInput())

    def save(self, profile_callback=None):
        master_patient_profile = MasterPatientProfile(user=User.objects.create_user(username=self.cleaned_data['supplied_email'], email=self.cleaned_data['supplied_email'], password=self.cleaned_data['supplied_password']))
        master_patient_profile.save() 
```

models.py 的简化版本：

```
class UserProfile(models.Model):
    user = models.OneToOneField(User, null=True)
    address_line_1 = models.CharField(_('Address 1'), max_length=100)
    address_line_2 = models.CharField(_('Address 2'), max_length=100, blank=True)
    city = models.CharField(_('City'), max_length=50)
    state = models.CharField(_('State'), max_length=20)
    zipcode = models.CharField(_('ZIP Code'), max_length=5)

class PatientProfile(UserProfile):
    gender = models.ForeignKey(UserGender)
    phone_number = models.CharField(max_length=12)
    date_of_birth = models.DateField(null=True)

class DoctorProfile(UserProfile):
    specialty = models.ManyToManyField(DoctorSpecialty)
    professional_statement = models.TextField() 
```

**编辑：（**基于克里斯普拉特的建议）

表单的`save()`方法现在看起来像这样：

```
new_user, created = User.objects.get_or_create(username=self.cleaned_data['supplied_email'], email=self.cleaned_data['supplied_email'])
    if created:
        new_user.set_password(self.cleaned_data['supplied_password'])

    master_patient_profile = MasterPatientProfile(user=new_user) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:03:07.213

不要使用`create_user`. 这纯粹是一种方便的方法，只对实际的`User`创建形式真正有用。

在其他任何地方，您都应该使用`get_or_create`. 唯一的缺点是您无法使用它设置密码，因此您需要分两步完成。

```
user, created = User.objects.get_or_create(username=self.cleaned_data['supplied_email'], email=self.cleaned_data['supplied_email'])
if created:
    user.set_password(self.cleaned_data['supplied_password']) 
```

# sql-server - 组页脚和 Tablix 页脚之间的 RunningValue 不匹配

> ID：10999224
> 
> 赞同：1
> 
> 时间：2012-06-12T14:54:52.807
> 
> 标签：sql-server, reporting-services, ssrs-2008

我有一份报告以英制和公制单位显示患者的身高和体重。我有按 PID 分组的记录，在组外的 tablix 中有最后一个静态行。对于我正在查看的四个值，数据集有四个添加的计算字段。它们被定义为`"if name='WEIGHT' then value else ''"`，依此类推。在页脚和最后一行中，我都有表达

```
=RunningValue(Iif(Max(Fields!ObsValHeight.Value, "table1_PID") > "" 
            Or Max(Fields!ObsValHeightCM.Value, "table1_PID") > ""
        , Fields!PID.Value
        , Nothing
        )
    , CountDistinct
    , Nothing) 
```

不幸的是，总数不匹配。PID 的不同计数为 12893。组页脚中的运行总数显示为 12100，但 tablix 页脚中的表达式显示为 12257。任何人都可以在没有看到实际数据的情况下解释差异吗？谢谢。

# ios - 我可以在我的设备上免费测试我的应用程序吗？iOS

> ID：10999227
> 
> 赞同：-4
> 
> 时间：2012-06-12T14:54:54.153
> 
> 标签：ios, xcode

> **可能重复：**
> [在没有苹果开发者程序或越狱的设备上测试 iOS 应用程序](https://stackoverflow.com/questions/4952820/test-ios-app-on-device-without-apple-developer-program-or-jailbreak)

昨天我安装了 Xcode 4.3.2，我想在我的 iPod touch 上测试我的应用程序；）我应该怎么做才能在我的 iPod 上免费测试我的应用程序？（我付不起 99 美元）。我有一个越狱的 iPod。

[在没有苹果开发者程序或越狱的设备上测试 iOS 应用程序](https://stackoverflow.com/questions/4952820/test-ios-app-on-device-without-apple-developer-program-or-jailbreak)

这种方式不起作用:(应用程序会在一段时间后打开和关闭:(

请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:00:51.833

我从来没有尝试过，但是如果你有一个越狱的 iPod，那么在谷歌搜索中，[Jailcoder](http://jailcoder.com/)看起来像是一个解决方案。无论如何，您将需要您的 Apple 开发人员程序来分发您的应用程序。祝你好运！哦，如果你尝试这个，请告诉我们它是如何工作的！

# c# - .net 3.5 从 web.config 记录到文件

> ID：10999229
> 
> 赞同：1
> 
> 时间：2012-06-12T14:54:55.810
> 
> 标签：c#, .net, iis, logging, web-config

我有一个 .net 3.5 网站，当我在 Visual Studio 中运行它时运行良好。但是，当我们在 IIS 中运行它时，会出现一些错误。我想做的是向 web.config 添加某种类型的日志记录，以便将网站发生的事情记录到文件中。有什么好的方法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:02:17.397

如果您的代码使用内置的 .NET System.Diagnostics.Trace 函数输出日志信息，您可以使用 web.config 文件控制和配置这些跟踪的去向。

在您的代码中，使用如下调用

```
System.Diagnostics.Trace.TraceInformation("Your log info here"); 
```

在您的 web.config 中，设置一个事件日志跟踪侦听器，如下所示：

```
<configuration>
  <system.diagnostics>
    <trace autoflush="false" indentsize="4">
      <listeners>
        <add name="myListener" 
          type="System.Diagnostics.TextWriterTraceListener" 
          initializeData="TextWriterOutput.log" />
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

这会将跟踪输出从您的程序路由到文本文件 TextWriterOutput.log

更多信息：http: [//msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:58:37.913

我不明白“发生在文件中”是什么意思，但我添加日志的首选方法是使用[NLog](http://nlog-project.org/)。

NLog 可通过[NuGet](http://nuget.codeplex.com/)获得，功能强大且非常易于设置。对于不同类型的错误，您可以有不同的日志操作。例如，对于我的许多使用 NLog 的 Web 应用程序，我将大部分内容记录到文件中，但也有致命错误向操作团队发送电子邮件。

如果这不是您要查找的内容，请更新您的问题以更清楚地了解您要解决的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T14:58:42.770

最强大的（在我看来）日志框架之一是[ELMAH](http://code.google.com/p/elmah/)。它可以自动记录错误，您还可以实现自己的触发器以在日志中存储信息。

最重要的是，您可以在不更改代码库的情况下实现它。只需要更改 web.config 或 machine.config。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:11:50.560

您真的应该使用像 NLog 这样的良好日志框架（如其他地方所建议的那样）。但是，如果您只需要快速而肮脏的东西，请考虑向 Global.asax Application_Error 事件添加一些简单的错误处理，如下所示（从内存中释放）：

```
protected void Application_Error(object sender, EventArgs e)
{
    // Get error and log objects
    var exception = Server.GetLastError();
    var log = new System.IO.StreamWriter("c:\\path\\to\\log.txt");

    // Write out what you need and close the file
    log.WriteLine(exception.Message);
    log.Close();

    // Redirect to error page ..
} 
```

请记住确保您也具有打开/创建日志文件的必要权限。

# c# - 如何将导入的 XML 点拆分为单独的组？

> ID：10999232
> 
> 赞同：1
> 
> 时间：2012-06-12T14:55:00.207
> 
> 标签：c#, wpf, xml, geometry, point

我正在尝试导入一个 XML 文件，其中包含 drawLine 函数的点列表，它是典型的 drawLine 函数，给它你的 X1、Y1、X2、Y2 坐标，它会画线。我的 XML 文件中的内容如下：

```
<LINES>
  <LINE>
    <ID>J3U93</ID>
    <POINT X="454.5" Y="93.5"></POINT>
    <POINT X="454.5" Y="371"></POINT>
    <POINT X="433.5" Y="351"></POINT>
    <POINT X="433.5" Y="329.5"></POINT>
  </LINE>
  <LINE>
    <ID>U231U93</ID>
    <POINT X="23.5" Y="526"></POINT>
    <POINT X="417" Y="341.875"></POINT>
    <POINT X="380" Y="341.875"></POINT>
    <POINT X="188.5" Y="526"></POINT>
    <POINT X="23.5" Y="526"></POINT>
  </LINE>
   .
   .
</LINES> 
```

每条线在文件中都有一个 ID 来区分它，我的线将连接起来基本上形成 Z 形图案，即根据 LINE 标签内的点数量不同的转数。

我需要知道，或者如果你能指出我正确的方向，我如何将 ID 标签中的一组线与另一个 ID 标签中的另一组线分开？

到目前为止，我尝试过：

```
List<Point> Points;

XDocument lineDataXml = XDocument.Load(filename);

Points = (
     from point in lineDataXml.Descendants("LINE")
      select new Point 
      { 
          X = Double.Parse(point.Attribute("X").Value), 
          Y = Double.Parse(point.Attribute("Y").Value) 
      }).ToList();

 foreach(Point a in Points)
 {
     Console.WriteLine(a);
 } 
```

但这会返回 XML 中所有点的列表，而不知道哪些点属于哪个 ID。

您的帮助将不胜感激

彼得。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:09:34.503

试试这个，

```
XElement root = XElement.Load(file); // or .Parse(string)
var lines = root.Descendants("LINE")
    .Select(line =>
        new
        {
            Id = (string)line.Element("ID"),
            Points = line.Elements("POINT")
                .Select(p => new PointF
                {
                    X = (float)p.Attribute("X"),
                    Y = (float)p.Attribute("Y")
                }).ToArray()
        }).ToArray(); 
```

# sql - 获取原因 (ORA-8102 "index key not found")

> ID：10999239
> 
> 赞同：6
> 
> 时间：2012-06-12T14:55:21.813
> 
> 标签：sql, oracle, plsql

所以我有一个索引名为 IDX_ATS_CALC_END_TIME 的表。该列是一个时间戳值。此列还有一个触发器，当填充或更新另一列 (Interval_duration) 时会自动填充该列。

触发器如下：

```
TRIGGER "DATAMART"."TRG_ATS_CALC_END_TIME" 
    BEFORE INSERT OR UPDATE OF INTERVAL_DURATION ON DATAMART.AGG_TIME_SUMMARY
    FOR EACH ROW
    DECLARE
BEGIN
IF :New.INTERVAL_DURATION > 0 THEN
   :New.calc_end_time := :New.start_date_time  + pb_util.secondtointerval(:New.INTERVAL_DURATION);
ELSE
:NEW.CALC_END_TIME := :New.start_date_time;
END IF;

    EXCEPTION
    WHEN OTHERS THEN
      pb_util.logdata(1, 'TRG_ATS_CALC_END_TIME', 'Exception Thrown in interval:  ' || :New.Interval_DURATION, SQLERRM  || ' stack: ' || dbms_utility.format_error_backtrace);

END TRG_ATS_CALC_END_TIME; 
```

最初填充我的表时，没有问题。我的问题是，当我去对表执行插入/更新并尝试通过直接更改列或仅更新 interval_duration 列来修改此列时，我抛出了这个错误：

> ORA-08102: 找不到索引键，obj# 97523，文件 4，块 244 (2)

提到的索引是一个基于函数的索引。索引上使用的函数是 calc_end_time 列上的 sys_extract_utc。

我花了几天时间试图解决这个问题。我已经重建了索引，我尝试过删除并重新创建索引。这两个似乎是这个问题的常见答案，但它们对我不起作用。我使用以下方法分析了索引：

`ANALYZE INDEX IDX_ATS_CALC_END_TIME VALIDATE STRUCTURE;`

它回来时没有任何问题。

我唯一能够成功更新此列而不会出现此错误的方法是禁用触发器，执行更新，然后再次启用触发器。这对我来说不是一个可行的解决方案。

所以我想知道是否有人遇到过这种类型的问题，以及我可以尝试哪些其他步骤来解决这个错误。

**更新：** 您将在下面找到函数 pb_util.secondtointerval() 代码：

```
FUNCTION SecondToInterval
  (Seconds_IN NUMBER
  )
RETURN CONST.PBInterval
IS
  sec            NUMBER(20, 9);
  days           NUMBER;
  hours          NUMBER;
  minutes        NUMBER;
  seconds        NUMBER(20, 9);
  IntervalAsText NVARCHAR2(32);
  ReturnInterval INTERVAL DAY(9) TO SECOND(9);
begin
  sec     := NVL(Seconds_IN, 0);

  days    := trunc(sec/(24*60*60));
  sec     := sec - days*24*60*60;

  hours   := trunc(sec/(60*60));
  sec     := sec - hours*60*60;

  minutes := trunc(sec/60);
  sec     := sec - minutes*60;

  seconds := trunc(sec);

  sec     := sec - seconds;
  sec     := trunc(1000000000*sec);

  IntervalAsText := cast(days as nvarchar2)
    || ' ' || cast(hours as nvarchar2)
    || ':' || substr('00' || cast(minutes as nvarchar2), -2, 2)
    || ':' || substr('00' || cast(seconds as nvarchar2), -2, 2)
    || '.' || substr('000000000' || cast(sec as nvarchar2), -9, 9);

  --dbms_output.put_line(intervalastext);

  ReturnInterval := TO_DSInterval(IntervalAsText);
  --ReturnInterval := TO_DSInterval('999999999 23:59:59.999999999');
  --dbms_output.put_line(ReturnInterval);

  RETURN ReturnInterval;
EXCEPTION
    WHEN OTHERS THEN
   pb_util.logdata(1, 'PB_UTIL.SecondToInterval', 'ERROR(99A): ', intervalastext);
                dbms_output.put_line(intervalastext);
                RAISE;

end SecondToInterval; 
```

这是我的前任写的，但基本上它所做的只是将给定的数值转换为间隔值。

非常感谢任何帮助或建议。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:20:52.003

尝试以下操作：

```
SELECT *
  FROM ALL_OBJECTS
  WHERE OBJECT_ID = 97523 
```

这将告诉您 Oracle 遇到问题的对象。很可能是您怀疑的索引，但也可能不是。

分享和享受。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:13:46.287

我认为它正在发生，因为您的触发器具有非确定性函数-> pb_util.secondtointerval。我真的不知道这种方法的真正作用。尝试将一些静态值分配给 CALC_END_TIME 并检查您的触发器是否有效。

为了支持这一点，我在这里放置了一小段代码：

```
SQL> CREATE TABLE t (a INTEGER)
Table created.

SQL> CREATE OR REPLACE FUNCTION f (a INTEGER)
   RETURN INTEGER "DETERMINISTIC"
AS
   cnt   INTEGER;
BEGIN
   RETURN ROUND ("DBMS_RANDOM.VALUE (1, 100)");
END f;
Function created.

SQL> CREATE INDEX t_idx ON t (f(a)) COMPUTE STATISTICS
Index created.

SQL> INSERT INTO t
   SELECT ROWNUM
     FROM user_objects
5 rows created.

SQL> DELETE FROM t
DELETE FROM t
Error at line 28
ORA-08102: index key not found, obj# 48928, file 4, block 36 (2) 
```

希望能帮助到你 ！！

# svn - 有没有办法通过用户名过滤 Subversion 的命令行合并

> ID：10999241
> 
> 赞同：1
> 
> 时间：2012-06-12T14:55:25.953
> 
> 标签：svn, version-control, branching-and-merging

我正在使用`svn merge urlToSomeBranch`一个新拉的树干的工作颠覆副本。使用上面的命令，我可以根据文件或修订选择要合并的内容。但我真正想做的只是在需要时合并我所做的更改或其他团队成员的更改。有没有办法按我缺少的用户名过滤？我可以在我的 IDE 中做类似的事情，但可惜的是，我使用的那个在当前版本中受到合并错误的阻碍。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T06:34:07.037

不幸的是，SVN 不提供这样的功能。

我最近需要做这样的事情，我最终为此编写了一个脚本。使用 SVN 的 XML 输出和 PowerShell（如果你当然是在 Windows 下），它可以非常简单：

```
$CmdLine = "svn log <branchURL> --stop-on-copy --xml";

$Logs = [xml](Invoke-Expression $CmdLine);

foreach ($Commit in $Logs.log.entry)
{
  $Author = $Commit.author;
  if ($Author.CompareTo("YourUsername"))
  {
    $Revision = $Commit.revision;
    $OtherCmdLine = "svn merge -r$Revision <branchURL> <target>";
    $Result = Invoke-Expression $OtherCmdLine;
  }
} 
```

你显然可以做不同的事情，但这给出了主要思想。

如果您在基于 Unix 的系统下工作，则可以使用另一种脚本语言来实现相同的目的。

# plot - Gnuplot：具有不同键的多个直方图

> ID：10999245
> 
> 赞同：1
> 
> 时间：2012-06-12T14:55:41.167
> 
> 标签：plot, gnuplot, histogram

我想使用 gnuplot 在同一个图表上绘制多个 rowstacked 直方图。示例数据文件如下：

```
App1 20 30 50
App2 10 20 70 
```

我使用的脚本是这个

```
set terminal jpeg medium
set output "histo.jpeg"
set boxwidth 0.75 absolute
set style fill solid 1.00 border -1
set style data histogram
set style histogram rowstacked
set xtics 1000 nomirror
set ytics 100 nomirror
set mxtics 2
set mytics 2
set ytics 10
set yrange [0:120]
set ylabel "Total time"
set key below vertical

plot 'data' using 2 t "Idle", '' using 3 t "User space", '' using 4 :xtic(1) t "Kernel space" 
```

我得到的结果是这样的：![在此处输入图像描述](../Images/dd144fb544214d063de15fe9f17ae98b.png)

我想在每个直方图下方有单独的键，因为我想显示每个元素占用的时间量，这与一个图表不同。此外，可能出现在一个直方图上的某些元素不会出现在另一个直方图上。

我的目的是创建一个脚本来生成数据文件和 gnuplot 脚本来自动化这个过程。

我已经使用 jgraph 实现了上述目标，但在外观方面结果很差。

非常感谢，

斯巴普

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:03:27.960

不幸的是，没有干净的方法可以做到这一点。您可以通过第一次绘制数据（在多图中）然后制作“空”图以在事后添加更多键来实现类似的效果。

```
set boxwidth 0.75 absolute 
set style fill solid 1.00 border -1
set style data histogram
set style histogram rowstacked
set xtics 1000 nomirror
set ytics 100 nomirror
set mxtics 2
set mytics 2
set ytics 10
set yrange [0:120]
set ylabel "Total time"
set multiplot

#These might be helpful to keep all the "plots" aligned.
set lmargin at screen .2
set rmargin at screen .9
set tmargin at screen .9
set bmargin at screen .2

set key at first .5,screen .1 #could be "set key at screen 0.1,0.1"  You'll have to play around with it.

plot 'data' using 2 t "Idle", \
     '' using 3 t "User space", \
     '' using 4 :xtic(1) t "Kernel space"

unset xtics
unset xlabel
unset ytics
unset ylabel
unset title
unset border 
set xrange [GPVAL_X_MIN:GPVAL_X_MAX]

set key at first 1.5,screen .1 
plot NaN t "Idle (app2)" w boxes, \
     NaN t "User space (app2)" w boxes, \
     NaN t "Kernel space (app2)" w boxes

unset multiplot 
```

# r - 如何调整ggplot密度图中的x轴？

> ID：10999249
> 
> 赞同：4
> 
> 时间：2012-06-12T14:56:00.300
> 
> 标签：r, ggplot2

我试图了解我的数据在工作日的每小时频率。因此，我将不同的日期浓缩为一天，这样只有时间不同，并添加了一个表示星期几的列作为有序因子。

以下是我的数据的摘录：

```
my.log <- structure(list(Prorated = structure(c(1339535400, 1339536540, 1339524540, 1339480320, 1339537920, 1339529580, 1339500780, 1339532820, 1339522020, 1339522680, 1339465560, 1339529940, 1339472880, 1339508520, 1339519620, 1339536000, 1339526580, 1339514940, 1339518060, 1339512420, 1339513080, 1339500120, 1339543620, 1339485660, 1339496280, 1339526520, 1339514820, 1339531800, 1339531860, 1339501320), class = c("POSIXct", "POSIXt"), tzone = "%Y-%m-%d %H:%M:%S"), Wday = structure(c(1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 4, 1, 1, 3, 3, 4, 4, 5, 5, 5, 1, 2, 2, 2), .Label = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"), class = c("ordered", "factor"))), .Names = c("Prorated", "Wday"), row.names = c(NA, 30), class = "data.frame")

range(my.log$Prorated)
# here (n = 30):
# [1] "2012-06-12 01:46:00" "2012-06-12 23:27:00"
# w/ full data set (n = approx. 75000):
# [1] "2012-06-12 00:00:00" "2012-06-12 23:59:00" 
```

当我现在尝试使用以下代码绘制密度图时......

```
library("ggplot2")
library("scales")
p <- ggplot(my.log) + theme_bw() +
  geom_density(aes(Prorated, colour=Wday)) +
  scale_color_brewer("weekday", palette="Dark2") +
  scale_x_datetime("", breaks=date_breaks("4 hours"),
    labels=date_format("%H:00")) +
  opts(title="Distribution (KDE)")
print(p) 
```

*...两个数据集*的 x 轴不是从 00:00 开始，而是从凌晨 02:00 开始，因此整个密度图移到了第二天。（我想在这里张贴一张图片，但由于我是新手所以我不允许这样做。你可以在[ImageShack](http://imageshack.us/photo/my-images/857/rplotd.jpg/)找到它）

因此，我的问题**是：是否可以选择告诉 qqplot() 它应该在 00:00 开始其密度图？**

我检查了[相关问题](https://stackoverflow.com/search?q=[ggplot2]+scale)（或分别回答），但找不到任何问题。我想到的唯一选择是要么`xlim()`要么`scale_x_continuous(limits=...)`。但据我了解，两者都不是正确的。

前者会丢弃数据点（或不丢弃，因为输入 data.frame 的所有数据都已经在正确的范围内），而后者只会改变视点，结果会在 23:59 切断图表而不添加这些（现在隐藏）开始时的数据点......所以，当我使用

```
scale_x_datetime("", breaks=date_breaks("4 hours"), labels=date_format("%H:00"),
  limits=c(as.POSIXct("2012-06-12 00:00:00"), as.POSIXct("2012-06-12 23:59:00")) 
```

在上面的代码中，图表看起来错误/没有显示所有数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T17:58:58.890

这是时区问题。请参阅此相关问题： [ggplot 0.9.0 中 scale_datetime() 的适当时区参数语法是什么](https://stackoverflow.com/q/10339618/892313)

您可以通过将`labels`参数更改为`function(x) format(x, "%H:00", tz="UTC")`（或可能是其他一些适当的时区）来解决它。`POSIXt`我不得不更改您的示例数据，因为它具有用于数据框列的格式错误的 tzone 属性。

```
ggplot(my.log) + theme_bw() +
  geom_density(aes(Prorated, colour=Wday)) +
  scale_color_brewer("weekday", palette="Dark2") +
  scale_x_datetime("", breaks=date_breaks("4 hours"),
    labels=function(x) format(x,"%H:00",tz="UTC")) +
  opts(title="Distribution (KDE)") 
```

![在此处输入图像描述](../Images/a79a8971a865def247fb158204b0102f.png)

# amazon-ec2 - EC2 实例放置

> ID：10999252
> 
> 赞同：3
> 
> 时间：2012-06-12T14:56:09.623
> 
> 标签：amazon-ec2, amazon-web-services

我们有很多 m1.medium/large 实例在 ec2 中运行。一般来说，这些机器最适合我们的需求。但是，我们在节点之间获得了一些非常可怕的吞吐量。一些挖掘表明，这些节点位于不同的子网中，并且可能位于不同的数据中心。

为了获得更多的吞吐量，如果可能的话，我想尝试让 EC2 将这些节点更紧密地放在一起（network-wize）。我们的拓扑如下：

*   在 EBS 上托管一些中央存储数据的“服务器”节点，NFS 导出，始终开启。m1.大。
*   几个 80% 的时间都在工作的主要工作节点。m1-大
*   0-50 个从属节点，一次只开启几个小时。通常这些是 m1.smalls 或 m1.medium，但如果工作需要，也可以是 m1.large。

从节点挂载导出的 NFS 驱动器。

显然，如果从服务器在远离服务器的地方启动，我们会得到一些可怕的吞吐量。

我知道归置组，但是这些似乎需要更昂贵的实例类型和完全不同的可视化技术，并且当我们需要 40 个额外节点时，我们的归置组中可能没有空间容纳它们。

这将大大增加我们的成本并降低我们的灵活性。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:18:14.783

您需要在同一可用区中启动您的实例和置放群组：

[http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html)

可以在启动实例或创建置放群组时选择可用区 (ec2-create-placement-group)。这些区域通常是 A、B、C 或无偏好（默认 - 随机）。

同一可用区中的节点连接在同一个 10Gbps 网络上 - 这比在 SATA3 接口上运行的固态驱动器上的带宽 - 6Gbps 更好。

不同的区域位于同一地区（例如美国东北部），但通常相距很远，以便实施灾难恢复。它们肯定位于不同的数据中心，并且可能位于同一地区的不同州，例如美国东北部。亚马逊不公布实际位置。

请注意，似乎没有办法通过 AWS 管理控制台为置放群组创建指定可用区 - 您可能需要使用 API。

[http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-CreatePlacementGroup.html](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-CreatePlacementGroup.html)

我已经看到 EC2 上的整个可用区发生了几次故障 - 因此，如果您要将整个基础架构移动到相同的可用区，您的应用程序将面临风险，您需要某种灾难恢复或容错在 2 个区域之间实施。

希望这可以帮助。

# asp.net - 如何在asp.net中显示警告框

> ID：10999258
> 
> 赞同：2
> 
> 时间：2012-06-12T14:56:37.287
> 
> 标签：asp.net

我在我的页面中显示警报框，但之后我的页面崩溃了。

```
Response.Write("<script>alert('Selected items are removed successfully')</script>"); 
```

如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T15:03:01.393

这不是在 ASP.NET 上向客户端发送 javascript 代码的方式

你可以使用[`Page.ClientScript.RegisterStartupScript`](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)

```
 Page.ClientScript.RegisterStartupScript(
   this, 
   GetType(), 
   "ALERT", 
   "alert('Selected items are removed successfully')", 
   true); 
```

在这种情况下，您还可以使用[`Page.ClientScript.RegisterClientScriptBlock`](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptblock)

```
 Page.ClientScript.RegisterClientScriptBlock(
   this, 
   GetType(), 
   "ALERT", 
   "alert('Selected items are removed successfully')", 
   true); 
```

要了解和之间的差异`RegisterStartupScript`，`RegisterClientScriptBlock`您可以在此处查看

[RegisterStartupScript 和 RegisterClientScriptBlock 之间的区别？](https://stackoverflow.com/questions/666519/difference-between-registerstartupscript-and-registerclientscriptblock)

您还将了解为什么它们并不总是可以互换的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T14:59:25.100

Response.Write 在页面呈现之前直接写入输出流。如果您查看生成的页面代码，您将在任何 HTML 之前看到您的输出。这会破坏页面状态等。

您最可能想要的是类似于 RegisterStartupScript 方法的东西，用于在页面末尾写出适当的脚本块。

文档链接：http: [//msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx)

有关此方法的代码示例，请参阅@Claudio Redi 的帖子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:04:40.280

这是在网络表单回发期间触发 javascript 代码的语法：

```
 Dim scVal As String
    scVal = "<script type='text/javascript'>"
    scVal = scVal & " alert('Selected items are removed successfully');</script>"
    ScriptManager.RegisterStartupScript(Me.Page, Me.GetType(), "temp", scVal, False) 
```

# android - 哪个android库提供android::Mutex？

> ID：10999269
> 
> 赞同：2
> 
> 时间：2012-06-12T14:57:52.290
> 
> 标签：android, c++, c, android-ndk

> **可能重复：**
> [Android NDK - 未定义对 Android::Mutex、Android::AudioTrack 的引用](https://stackoverflow.com/questions/10984001/android-ndk-undefined-reference-to-androidmutex-androidaudiotrack)

有谁知道 Android NDK 提供了哪个共享库 android::Mutex？

凯文

# java - 在两个 Android 应用程序之间共享凭据

> ID：10999272
> 
> 赞同：4
> 
> 时间：2012-06-12T14:58:02.337
> 
> 标签：java, android, android-intent, android-2.2-froyo, android-sdk-2.3

我有两个应用程序。如果一个应用程序已安装在 Android 上。第二个应用程序应该使用第一个应用程序的凭据。如何在 Android 中实现共享应用凭据？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T17:22:27.103

首先，更新两个应用的清单，如下所示：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.yourpackage.firstapp" android:versionCode="1"
android:versionName="1.0.0" 
android:sharedUserId="com.your.userId">

<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.yourpackage.secondapp" android:versionCode="1"
android:versionName="1.0.0" 
android:sharedUserId="com.your.userId"> 
```

现在假设在您的第一个应用程序中，您将用户名/密码保存为 SharedPrefs 或一些 xml 文件。当第二个应用程序启动时，它现在可以访问第一个应用程序的私有目录，方法是在 /data/data/com.yourpackage.firstapp/shared_prefs/ 中查找 sharedprefs 文件

如果第一个应用程序的 shared_prefs 路径存在，那么您可以打开它并读取用户/通行证凭据。

# android - Android - 从 GeoPoint-Object 中获取坐标

> ID：10999275
> 
> 赞同：0
> 
> 时间：2012-06-12T14:58:07.767
> 
> 标签：android, coordinates, mylocationoverlay

看这个：

```
MyLocationOverlay myLocationOverlay = new MyLocationOverlay(this, mapView);

    myLocationOverlay.enableMyLocation();
    myLocationOverlay.enableCompass();
    GeoPoint myGeoPoint = myLocationOverlay.getMyLocation(); 
```

这很好用。但我需要将坐标保存在变量中。所以我尝试了这个：

```
myLocationLon = (double) myGeoPoint.getLongitudeE6(); 
```

当我运行应用程序时，最后一行使它崩溃。你能告诉我为什么这不起作用吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:01:39.190

`GeoPoint.getLongitudeE6()`并且`GeoPoint.getLatitudeE6()`都返回微度数（基本上是度数 * 1E6）。

所以你需要将微度转换为度，只需编写函数：

```
public double microDegreesToDegrees(int microDegrees) {
    return microDegrees / 1E6;
} 
```

接着

```
myLocationLon = microDegreesToDegrees(myGeoPoint.getLongitudeE6()); 
```

# git - git：“警告：更改只读文件”

> ID：10999278
> 
> 赞同：9
> 
> 时间：2012-06-12T14:58:21.993
> 
> 标签：git, commit, readonly

当我去使用提交更改到分支时，

```
git commit -a 
```

`vim`被打开，我去插入我的提交信息。我在终端收到此警告：

```
W10: Warning: Changing a readonly file 
```

为了继续提交，我必须使用`:x!`in强制写入`vim`，否则不会遇到任何问题。

至少，这似乎只是一种烦恼。有谁知道发生了什么和/或如何解决这个问题？

我在 Windows 7 上使用 Cygwin。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T13:03:35.497

如果文件`.git/COMMIT_EDITMSG`存在并且是只读的，最简单的做法就是删除它——git 会根据需要重新创建它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-22T00:25:12.880

删除文件并没有为我解决问题。手动设置 core.editor 配置。运行此命令后，我的问题就消失了。

git config --global core.editor "vim"

我不知道为什么，但这就是最终解决问题的原因。$EDITOR 之前设置为“vim”，并且在此修复之前未定义 core.editor。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T09:35:54.930

我有同样的问题....但是有一个 vi 实例在该文件打开的情况下仍在运行。我在屏幕上没有找到那个实例……所以我杀了它。

# java - 如何声明一个 ArrayList？

> ID：10999280
> 
> 赞同：0
> 
> 时间：2012-06-12T14:58:26.760
> 
> 标签：java, collections

> **可能重复：**
> [为什么要首选 Java 类的接口？](https://stackoverflow.com/questions/147468/why-should-the-interface-for-a-java-class-be-prefered)

我对 java 比较陌生，我刚刚开始使用集合框架。虽然`ArrayList`我遇到了人们声明它的两种方式。例如声明一个`ArrayList`of `String`s ：

```
List<String> l = new ArrayList<String>(); 
```

或者

```
ArrayList<String> al = new ArrayList<String>(); 
```

我应该使用这两者中的哪一个，它们之间有什么区别？

我知道调用的实际方法是在运行时决定的，因此调用的方法都只是`ArrayList`类的，但第一个声明仍然限制了可以调用的方法。

第一种方法，我听说，称为“对接口进行编码”。任何方法都将使用该变量调用`l`，因此只能调用`List`接口提供的方法，而在第二个示例中，我们不仅可以调用类提供的所有方法，还可以调用`List`类提供的所有方法`Object`（例如`finalize()`，`wait()`等）。那么为什么甚至首先人们甚至使用第一个声明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T15:01:17.250

您应该始终尽可能使用最少的特定接口。如果存在更合适的实现，这使得替换替代实现变得更容易。例如，方法`List`不关心列表是链表还是数组列表。您可以选择更合适的一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:02:28.923

我个人推荐使用`List<String> l = new ArrayList<String>();`

原因是您通常不需要知道您正在使用 ArrayList。您只需要像列表一样运行的东西。ArrayList 上有很多人们不需要访问的行为。考虑“确保容量”。他们不需要那个 - 他们只需要 List 操作。作为一般规则，您希望在“需要知道”的基础上限制数据和功能的公开，并且您列表的用户不需要知道（默认情况下）您使用了什么实现。

显然，例如，如果他们确实需要知道您使用的是 ArrayList 而不是 LinkedList，那么您可能希望使用 ArrayList 引用而不是 List 引用。但是，对于大多数目的来说，这不是必需的。

# sql - 查找同一张表中没有对应记录的记录

> ID：10999281
> 
> 赞同：0
> 
> 时间：2012-06-12T14:58:28.800
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有下表：

```
 ID | JobID | Data   | ResultType
---------------------------------
  1 | 12345 | XXXX   | 0
  2 | 12345 | YYYY   | 1
  3 | 23456 | AAAA   | 0
  4 | 23456 | BBBB   | 1
  5 | 34567 | FOOB   | 0
  6 | 45678 | BARB   | 0 
```

现在我需要构建一个查询来提供所有`JobIDs`没有条目的地方`ResultType = 1`

**编辑1：**

所以最后，我想得到只提供`JobIDs`34567 和 45678 的结果，因为`ResultType = 1`这些`JobIDs`.

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T15:02:45.463

使用此查询：

```
SELECT JobID 
From table1 a 
WHERE NOT EXISTS
 (SELECT 1 FROM table1 b WHERE b.JobID = a.JobID AND b.ResultType = 1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:01:17.537

就像是

```
select * from jobs where jobId not in 
          (select jobId from jobs where resultType = 1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:05:52.480

另一种方式（未测试）：

```
SELECT JobId FROM Jobs GROUP BY jobId HAVING max(ResultType) = 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:00:42.073

```
SELECT JobID FROM <TableName> WHERE ResultType <> 1 
```

这是你想要的吗 ？？？

# google-bigquery - 在 BigQuery 上上传和导入数据时从 bq 工具获取错误 - “后端错误”

> ID：10999282
> 
> 赞同：2
> 
> 时间：2012-06-12T14:58:30.027
> 
> 标签：google-bigquery

我收到错误消息：`BigQuery error in load operation: Backend Error`当我尝试在 BQ 上上传和导入数据时。我已经缩小了尺寸，增加了导入之间的时间，但没有任何帮助。奇怪的是，如果我等待一段时间并重试它就可以了。

在 BigQuery 浏览器工具中，它在某些行/字段中看起来像一个错误，但我检查并没有。显然这是一条假消息，因为如果我等待并重试上传/导入相同的文件，它会起作用。

Tnks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:52:14.113

我在 bigquery 后端查找了失败的作业，但找不到任何以“后端错误”终止的作业。我发现有几个失败了，因为在数据中发现了 ascii 空值。（查看错误流错误会很有帮助，而不仅仅是错误结果）。数据有可能在通往 bigquery 的过程中出现乱码……您确定数据在导入失败和成功导入相同数据之间没有变化吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:38:39.223

我发现当某个列中存在某些字符（在本例中为存储预测分析的原始结果的列）时，从大查询表导出到云存储中的 csv 会遇到相同的错误。通过从导出中删除该列，它解决了这个问题。

# scripting - 使用 GAS 创建动态模板

> ID：10999283
> 
> 赞同：0
> 
> 时间：2012-06-12T14:58:34.380
> 
> 标签：scripting, google-apps-script

我们刚刚决定为几个用户购买 Google Apps for Business，现在正在进行迁移试点。

我们有一个特定的问题，我们想看看它是否可以用 Google Apps 脚本解决。

**假设以下情况适用：**

目前我们在一个域中，并且我们在文档中设置了某些用户模板，例如用于传真的文档和用于备忘录的文档。这些模板背后有应用程序逻辑，因此模板会填写用户名和分支机构的值......我们想做的是在 Google Drive 中复制这种行为，但我不确定什么是最好的方法是实现这样的功能。

我们是否创建了一个电子表格并在脚本编辑器中从头开始编写完整的模板？或者是否可以在谷歌应用程序帐户上有一个模板，然后我们可以在打开时对其进行转换？我希望我对我们想要实现的目标有点清楚，但万一我不是；请随时问我更多问题。

我希望听到你们的声音！

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:18:46.153

您的问题更多地与对 Google Apps 的全球欣赏有关，而不是脚本问题...我不确定我应该在这里回答...作为个人意见，我认为文档将是获得所需内容的最佳工具。您必须创建几个带有个性化字段的模板，脚本将用“记录的用户”数据填充这些模板。document 和 doclist api 非常强大，还可以将创建的文档分类到文件夹中，并管理它们最终如何在用户之间共享。根据您在 javascript 编码方面的能力，它可以是非常容易和非常难以构建之间的任何东西...... :-)

# c# - 哪个是更好的 linq 查询？.Where(crit).FirstOrDefault() 还是 .Where(someCrit).FirstOrDefault(someOtherCrit)？

> ID：10999286
> 
> 赞同：1
> 
> 时间：2012-06-12T14:58:37.663
> 
> 标签：c#, sql, linq, nhibernate

想做一些重构......使用 NHibernate 我目前有这个查询

```
 public Widget FindByCode(string code)
 {
  return 
             _session
                 .Query<Widget>()
                 .Where(w => !w.IsDeleted)
                 .FirstOrDefault(w => w.Code == code);
  } 
```

我正在考虑使用这个

```
public Widget FindByCode(string code)
 {
  return 
             _session
                 .Query<Widget>()
                 .Where(w => !w.IsDeleted && w.Code == code)
                 .FirstOrDefault();
  } 
```

任何一个都比另一个更好吗？任何提示、链接或代码都会受到赞赏。干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:04:53.890

将谓词分成两块似乎让我感到困惑。我会将“过滤”代码保留在一个地方，然后将其全部放入`.Where`（您的第二个示例）或全部放入`.FirstOrDefault`. 后一种选择更简洁，使用的运算符更少，因此通常是理想的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:12:34.340

在 linq2objects 或 linq2sql 中，您可以像这样编写 FirstOrDefault：

```
public Widget FindByCode(string code)
 {
  return 
             _session
                 .Query<Widget>()
                 .FirstOrDefault(w => !w.IsDeleted && w.Code == code);
  } 
```

不确定NHibernate，但可能有效。您可以随时使用 NHProf 或常规 sql profiler 检查生成的 sql。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:07:22.047

第二个更好，因为它只会根据两个标准进行一次投影。第一个将根据第一个标准进行第一次投影，然后根据第二个标准应用第二次投影。我建议使用第二种方法。

# paypal - 贝宝集成错误代码10002

> ID：10999291
> 
> 赞同：1
> 
> 时间：2012-06-12T14:58:46.273
> 
> 标签：paypal

我正在使用贝宝直接付款，我在贝宝中的帐户已经是贝宝专业版。我已经请求了 api 用户名、密码和签名，并在我的代码中使用了它，但是在执行过程中出现了错误。请看下面

```
 TIMESTAMP: 2012-06-12T14:33:04Z
 CORRELATIONID: 26e967f0870e1
 ACK:   Failure
 VERSION:   87.0
 BUILD: 2945183
 L_ERRORCODE0:  10002
 L_SHORTMESSAGE0:   Authentication/Authorization Failed
 L_LONGMESSAGE0:    You do not have permissions to make this API call
 L_SEVERITYCODE0:   Error 
```

我在现场使用此设置 $API_Endpoint = 'https://api-3t.paypal.com/nvp';

有没有人可以帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T08:53:08.473

这是您在使用 Paypal Express Checkout 或 Paypal Website Payments Pro 时可能遇到的常见错误。这意味着您用于验证与 Paypal 的连接的登录信息有问题。

# php - $_SERVER['REQUEST_METHOD'] 仍然可行吗？

> ID：10999293
> 
> 赞同：11
> 
> 时间：2012-06-12T14:58:46.617
> 
> 标签：php

因此，一段时间以来，我一直在使用以下内容来检查我的帖子数据是否已设置。

```
if( ! empty( $_POST ) ) { } 
```

但是最近我看到很多帖子说上面是“hack”，下面是正确的“更好”的方式。

```
if( $_SERVER[ 'REQUEST_METHOD' ] === 'POST' ) { } 
```

最近我的意思是我最近才发现它。所有讨论后一种方法的帖子都来自 2009 年。编码标准有点老了，所以我认为可以就这个话题获得新的意见。

我开始明白这两种方法是不同的。第一个被认为是“hack”，它只检查是否设置了 post 数组，如果发出 post 请求，就会发生这种情况。第二个实际上检查服务器以查看是否已发出发布请求。我想第二个可能会更安全一些，但如果信息被清理了，我看不出它有多大的不同。

*   [来源](https://stackoverflow.com/questions/409351/post-vs-serverrequest-method-post)

我还看到了后者仅在 PHP 版本 <= 4 中使用的帖子，因为此时 PHP 仍在使用`$_REQUEST`全局，这是 PHP 编码人员用来确定某些请求参数的来源的方式。我不确定最后一个陈述有多准确，因为旧帖子中提出的问题与我的相同。他们使用全局而不是请求。然而，这是一篇比其他任何一篇文章（2011 年）都更新的文章，并且来自我信任的来源。所以我不知道该怎么做。

*   [来源](http://forums.devshed.com/php-development-5/if-server-request-method-get-vs-if-isset-post-781746.html)

以及在检查 get 时该怎么做？我看到有几个地方说服务器请求方法在这种情况下似乎不起作用，我只能假设这是因为 post 取代了 get 并且请求方法只能保存一个参数。因此，如果您同时拥有发布和获取数据，您会怎么做？对其中一篇文章的评论建议使用全局请求而不是发布和获取，但我一直认为这是一个坏主意。

*   [来源](http://forums.devshed.com/php-development-5/if-server-request-method-get-vs-if-isset-post-781746.html)
*   [来源](https://stackoverflow.com/questions/359047/php-detecting-request-type-get-post-put-or-delete)答案评论（nickf）

[这](https://stackoverflow.com/questions/10943060/isset-postsubmit-vs-serverrequest-method-post)是我能找到的最新来源，我在提交之前通过查看侧面的类似问题来做到这一点。它专门询问使用提交值来检查表单是否通过，但它也提到了请求方法。很多似乎表明后者仍在普遍使用。那么这个建议仍然有效吗？检查请求方法仍然是最佳选择吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T15:05:24.290

是的，它仍然存在，并且仍然 100% 可靠。`$_SERVER["REQUEST_METHOD"]`var 由 PHP 自己设置，根据用户连接使用的实际请求方法。用户不能发送查询参数或以其他方式影响该 var 的值，除非通过更改请求的类型。

您`if(!$_POST)`不可靠，因为可以执行帖子但不能通过它发送任何数据，例如*：*

```
<form method="post">
<input type="submit" />
</form> 
```

将生成这样一个空的 $_POST 数组 - 表单中没有命名的表单元素，因此不会发送任何数据，但仍然执行 POST。

我不会担心 PHP4 没有这个超全局。PHP 4 是石器时代的版本，支持 v4 但基于 v5 构建的代码必须包含许多丑陋/恶心的 hack 才能实现向后兼容性，以至于任何必须处理该代码的人都会遭受噩梦的折磨。PHP 4 应该被认为已经死了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T15:05:52.510

我总是使用`$_SERVER['REQUEST_METHOD'];`变量来检查请求方法。

该变量还表示请求是 ' `GET`'、' `HEAD`'、' `POST`' 还是 ' `PUT`' 请求。

[http://php.net/manual/en/reserved.variables.server.php](http://php.net/manual/en/reserved.variables.server.php)

# python - 在 Python 中修改 plist

> ID：10999294
> 
> 赞同：0
> 
> 时间：2012-06-12T14:58:49.203
> 
> 标签：python, plist

使用 plistlib 我可以将字典/列表结构序列化为 plist。这工作正常，我也可以用同一个库读回它。

问题是字典是“_internalDict”类型的，我似乎无法更改它们。例如，例如：

```
d = plistlib.readPlist('someplist.plist')
v = d['value'] # v is an _internalDict
v['val'] = 'new val' # works
del v # doesn't work
v = {'someotherkey': 'someothervalue'} # doesn't work either 
```

plist 似乎没有改变。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:11:27.530

您需要从`d`字典中删除密钥：

```
del d['value'] 
```

通过设置`v = d['value']`，您只是创建了一个指向与 相同值的新变量`d['value']`，但删除`v`不会从父结构中删除 dict。

要完全替换 dict，您需要再次操作父 dict：

```
d['value'] = { 'foo': 'bar' } 
```

如果你执行`v = { ... }`你正在做的事情就是为变量分配一个新`dict`值`v`的引用，替换对`d['value']` `dict`;的引用。你不是在操纵`d`字典中的原始值。

`plistlib._InternalDict`只是一个子类，`dict`它为属性访问提供警告，现在已弃用；否则它就像普通`dict`类型一样。

# sas - 使用 SAS 是否可以对长度超过 40 个字符的标签进行 XPORT？

> ID：10999297
> 
> 赞同：1
> 
> 时间：2012-06-12T14:58:58.177
> 
> 标签：sas

我正在尝试使用 SAS 9.2 创建 XPORT 文件。其中一个标签长度超过 40 个字符，并在`PROC COPY`.

我已经尝试过`PROC COPY`并`DATA`创建`XPORT`文件。这有可能解决还是我不走运？

```
333        /* Export Dataset */
334        OPTIONS VALIDVARNAME=ANY;
335        /*
336        PROC COPY IN=work OUT=xptout MEMTYPE=data;
337         SELECT MyDataSet;
338        RUN;
339        */

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.42 seconds
      cpu time            0.25 seconds

340        DATA xptout.MyDataSet;
341         SET work.MyDataSet;
342        RUN;

NOTE: The variable label {long label} has been truncated to {truncated label}.
NOTE: There were NNN observations read from the data set WORK.MyDataSet.
NOTE: The data set XPTOUT.MyDataSet has NNN observations and NN variables.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.09 seconds 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T20:24:05.563

多么可悲，但这是不可能的。[XPORT](http://support.sas.com/techsup/technote/ts140.html)格式是基于 80 个字符块的字节压缩格式。标签的 XPORT 变量描述中有 40 个字符的硬性限制。因此，虽然该列在 SAS 数据集中自身支持 256 个字符，但 XPORT 文件仅支持 40

:o(

# .net - 有没有更好的方法来删除 .NET 中字符串的尾随部分？

> ID：10999299
> 
> 赞同：5
> 
> 时间：2012-06-12T14:59:01.123
> 
> 标签：.net, vb.net, string

删除尾随部分是我使用代码

```
str.substring(0,str.length -2) 
```

有没有更好的办法？我特别不喜欢使用 str.length。

**编辑** 我希望问题尽可能简短和简单，我认为我只是忽略了一些 String 方法。我试着更精确。

我需要从字符串末尾删除给定数量的字符。我不想关心字符是什么，也不想引入删除更多字符的风险。

如果数字大于字符串长度，那么我们就会有一个异常（应该更早地验证字符串）。

我没有特别是长度的问题，但是两次引用一个变量（想象一个函数而不是一个变量）。我也不喜欢减法的必要性，但这只是个人喜好。

**VB.NET 解决方案**

这个问题被标记为 vb.net 所以有 vb.net 代码（应该在一个模块中）：

```
<System.Runtime.CompilerServices.Extension> _
Public Shared Function RemoveFromEnd(stringValue As String, removedCharacters As Integer) As String
    Return stringValue.Substring(0, stringValue.Length - removedCharacters)
End Function 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T15:33:08.687

如果您关心的只是您正在查看的美学，那么将此功能包装在扩展方法中是微不足道的：

```
 public static string RemoveFromEnd(this string stringValue, int removedCharacters)
    {
       return stringValue.Substring(0, stringValue.Length - removedCharacters);
    } 
```

所以你可以简单地使用

```
 str.RemoveFromEnd(2); 
```

并完成它。

如果您因为在非托管语言中运行缓慢而担心使用 string.length 的性能，请不要担心。由于 .Net 中的字符串是不可变的，因此 String.Length 在声明字符串时设置并且永远不会更改。因此，引用 String.Length 在*恒定*时间内完成（例如，Big-O(1)）并且非常快。相反，如果您对性能敏感，则应该关注 Substring 调用。在 .Net 中，子字符串*在线性*时间内完成（例如，Big-O(n)），其中 n 是原始字符串的长度。因此，它是您的代码行中的性能瓶颈。相对于字符串的长度，它会变慢。

但是，如果您正在处理很长的字符串，那么吞下它可能并不好。要解决这样的问题，您可以在扩展方法中使用 StringBuilder ：

```
 public static string RemoveFromEnd(this string stringValue, int removedCharacters)
    {
        var newString = new StringBuilder(stringValue);
        newString.Length = newString.Length - removedCharacters;
        return newString.ToString();
    } 
```

这应该是恒定的时间，但我需要仔细检查 Reflector 以确保 StringBuilder.Length 的行为方式与我认为的方式一致。但是，即使它是线性时间，它也相对于 removedCharacters 是线性的，这必然会低于原始字符串的长度。显然，权衡是在 StringBuilder 超出范围之前您使用的内存会稍微多一些，但如果您将它包装在一个可以快速完成的扩展方法中，这应该不是问题。

编辑：是的，StringBuilder.Length 只返回它正在跟踪的字符串的 String.Length，以便在恒定时间内返回，并且 StringBuilder 截断方法应该尽可能快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T15:13:25.430

看看这个相关的问题：

[从 .NET 中的字符串末尾修剪字符串 - 为什么会丢失？](https://stackoverflow.com/questions/7170909/trim-string-from-end-of-string-in-net-why-is-this-missing)

由于没有内置方法来执行此操作，因此您需要创建自己的方法（最好是扩展方法）：

```
public static string RemoveCharsFromEnd(this string input, int charactersToRemove) 
{
    if (input.Length > charactersToRemove) 
        return input.substring(0, input.Length - charactersToRemove);
    else
        return "";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T15:26:23.137

所以确实存在一种方法可以在`2`不使用的情况下删除字符串的第一个字符`str.Length`，即

```
str.Substring(2) 
```

因此你问如何从另一端做到这一点？我不认为该框架提供了这一点。您可以使用

```
str.Remove(str.Length - 2) 
```

但这使用`Length`.

这是一种使用 Linq 并且性能不佳的丑陋方式：

```
new string(str.Reverse().Skip(2).Reverse().ToArray()) 
```

当字符串太短时，丑陋的想法不会引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:02:12.767

这取决于您所说的“尾随部分”是什么意思。您是指内容后的空格吗？例如：

```
string test = "This is a test string.   "; // But you want "This is a test string." 
```

你想删除之后的空格吗？这可以通过`.Trim()`or`.TrimEnd()`命令实现。如果您不是这个意思，请说明问题所在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:03:22.593

```
 var test = " test";
        // Trim all trailing spaces
        test = test.Trim();
        // Trim only starting trailing spaces
        test = test.TrimStart();
        // Trim only ending trailing spaces
        test = test.TrimEnd();

        var test = "abcTest";
        // Trim all trailing abc
        var toRemove = new char[3];
        toRemove[0] = 'a';
        toRemove[1] = 'b';
        toRemove[2] = 'c';
        test = test.TrimStart(toRemove); 
```

您应该使用 Trim() 函数删除尾随部分

# html - 如何将非浮动 div 和浮动 div 放在同一行？

> ID：10999303
> 
> 赞同：0
> 
> 时间：2012-06-12T14:59:04.933
> 
> 标签：html, css, html-lists

目前列表项# 出现在右侧。如果从 document-export-icon 类中删除浮动，列表项 # 会正确显示在左侧，但标题和日期会移到下一行。我需要它们与导出图标位于同一行。

这是我到目前为止所拥有的：http: [//jsbin.com/owanod/2/edit#source](http://jsbin.com/owanod/2/edit#source)

这是它的外观：

![](../Images/c4819652b2ff1a1cc050ff52dc4e3253.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:02:01.467

我将这三个 CSS 规则添加到您的示例中：

```
.document-export-icon, .document-title-separate, .document-date {
    display: inline-block;
}
.document-date {
    position:absolute;
    right:0px;
}
.document-wrapper {
    position:relative;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/ma8Lb/1/)**。

# php - 这些正则表达式在这段代码中意味着什么？

> ID：10999304
> 
> 赞同：1
> 
> 时间：2012-06-12T14:59:17.677
> 
> 标签：php, regex, joomla, preg-replace

我试图更改 joomla 插件的某些部分，当我面对它的这一部分时，我不知道它在做什么。

有人可以向我解释这些正则表达式的`${4}`作用吗？

```
 $comStart = '';
    $comEnd = '';

    $output = JResponse::getBody();
    $output = preg_replace('/\<meta name=\"og\:/', '<meta property="og:', $output);
    $output = preg_replace('/\<meta name=\"fb:admins/', '<meta property="fb:admins', $output);
    $output = preg_replace('/<(\w+) (\w+)="(\w+):(\w+)" (\w+)="([a-zA-Z0-9\ \_\-\:\.\&\/\,\=\!\?]*)" \/>/i', $comStart.'<${1} ${2}="${3}:${4}" ${5}="${6}" >'.$comEnd, $output); 
```

仅供参考：此插件用于在文章中显示 facebook 和 opengraph 标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:04:29.407

> ## 严重注意！
> 
> 强烈建议不要使用正则表达式来解析/匹配 HTML/XML。认真的[不要做](https://stackoverflow.com/a/1732454/871050)

基本上，它是解析/匹配 HTML 的正则表达式。**这可能会产生不工作**、**难以维护**和**[精神错乱](https://stackoverflow.com/a/1732454/871050)**的轻微副作用。

这些`${N}`称为反向引用，它们引用正则表达式中匹配的第 N 个括号。

* * *

如果你需要在 PHP 中处理 HTML 字符串，你应该使用`DOMDocument`专门为此而设计的类。

### 例子

```
<?php

$html_string = <<<HTML
<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>

  <div id="target">
    This is the target DIV! <span>This span will change texts!</span>
  </div>

</body>
</html>
HTML;

$dom = new DOMDocument();
// Loading HTML from string...
$dom->loadHTML($html_string);

//Retrieve target and span elements
$target = $dom->getElementById("target");
$span = $target->getElementsByTagName("span")->item(0);

//Remove text, firstChild is the text node.
$span->removeChild($span->firstChild);
//Append new text
$span->appendChild(new DOMText("This is the new text!"));
//Change an attribute
$span->setAttribute("class", "spanny");

//Save HTML to string
$html_string = $dom->saveHTML();

echo $html_string; 
```

正则表达式不是坏的、邪恶的或可怕的，它们只是**工作的错误工具**，你不会用手提钻钉钉子吧？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:07:51.610

```
$output = preg_replace('/\<meta name=\"og\:/', '<meta property="og:', $output); 
```

`<meta name="og:`用替换字符串`<meta property="og:`。有点毫无意义——这里不需要正则表达式。

```
$output = preg_replace('/\<meta name=\"fb:admins/', '<meta property="fb:admins', $output); 
```

替换`<meta name="fb:admins`为`<meta property="fb:admins`。同样毫无意义 - 这里不需要正则表达式。

```
$output = preg_replace('/<(\w+) (\w+)="(\w+):(\w+)" (\w+)="([a-zA-Z0-9\ \_\-\:\.\&\/\,\=\!\?]*)" \/>/i', $comStart.'<${1} ${2}="${3}:${4}" ${5}="${6}" >'.$comEnd, $output); 
```

`<word1 word2="word3:word4" word5="word6withspecialcharacterslike-:.etc." />`用替换字符串`<word1 word2="word3:word4" word5=word6withspecialcharacterslike-:.etc." >`。所以它只在关闭之前删除一个斜杠`>`。非常可疑和类似巫毒教的正则表达式使用。

此外，所有这些正则表达式都非常不优雅（例如，许多毫无意义的转义），并表明编写这些正则表达式的人对正则表达式知之甚少。在 HTML 上放这样的东西是自找麻烦。

避免！避免！避免！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:07:10.207

每个`(\w+)`人都说找到一个单词并存储它。所以你正在这样做（在伪代码中）

```
find /(word1) (word2)="(word3)" (word4)="(manypossiblechars5)"/ignoring case

replace pattern with $comStart.<word1 word2="word3:word4" manypossiblechars5="word6">.$comEnd 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-12T15:08:53.697

第一个尝试将表单的标签替换`<meta name="og:...`为`<meta property="og:...`

第二个类似地替换以开头`<meta name="fb:admins...`的标签`<meta property="fb:admins...`

最后，第三个似乎采用了表单的标签并用and`<word word="word:word" word="something" \/>`包裹它们。`$comStart``$comEnd`

这是通过匹配标签的各个部分（放置`()`在它们周围）然后使用反向引用`${4}`来完成的，例如引用第 4 个匹配的部分。

这里`$comStart`and`$comEnd`都设置为 '' 所以这似乎有点毫无意义。它还设法同时摆脱了标签的结束斜线，但谁知道这是否是故意的！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-12T15:11:30.513

这些表达式尝试通过以下方式修复文档头代码：

1.  重写`<meta name="og:*"`为`
2.  重写`<meta name="fb:admins"`为`<meta property="fb:admins"`
3.  将带有悬垂斜杠的元标记重写为没有它的一个（假设它总是有两个属性。

> 这只是可怕的代码，只要你的模板中没有那些“错误”，你就可以把这些废话扔掉。

# android - Android 为什么操作系统会出现 onPause()

> ID：10999311
> 
> 赞同：1
> 
> 时间：2012-06-12T14:59:28.880
> 
> 标签：android, android-asynctask, onresume, onpause

我`Activity`创建了一个`AsyncTask`从文件加载数据并更新`onProgressUpdate()`经典书籍的 UI `AsyncTask`。但是 Android 是在 Activity 启动后
立即放置的。 `onPause()``AsyncTask`

我试图理解为什么（以及如何防止它）

这会导致所有`AsyncTask`UI 更新停止；然后，当`AsyncTask`完成时，它`Activity`不会自行恢复，我必须触摸屏幕或按一些操作栏按钮才能让它`onResume()`

编辑：
这是 logcat，（使用 aLogcat 应用程序来获取它）

< 将使用新的完整日志进行更新 >

临时（文件选择器之后的第一个 onPause()）：

```
06-12 22:08:48.744 11302 11302 D Viewer: + optionsItemSelected(itemID:2131296267)
06-12 22:08:48.754 11302 11302 D Viewer: + showFileChooser(path:/mnt/sdcard/Android/data/com.delphi.app/files, requestCode:0)
06-12 22:08:48.754 11302 11302 D Viewer: + onResume()
06-12 22:08:48.754 11302 11302 D Viewer: + onSaveInstanceState(outState:Bundle[{}])
06-12 22:08:48.754 11302 11302 D Viewer: + onPause()
06-12 22:08:48.754   189   443 I ActivityManager: START {act=android.intent.action.CHOOSER cmp=android/com.android.internal.app.ChooserActivity (has extras)} from pid 11302
06-12 22:08:48.764   189   489 D WindowManager: adjustConfigurationLw, config:{1.0 0mcc0mnc (no locale) layoutdir=0 sw800dp w800dp h1232dp xlrg port ?uimode ?night finger -keyb/v/h -nav/v} mLidOpen:-1 mHasDockFeature:true mHasHallSensorFeature:true config.hardKeyboardHidden:2
06-12 22:08:48.764 11302 11304 D dalvikvm: GC_CONCURRENT freed 244K, 5% free 6748K/7047K, paused 2ms+3ms 
```

临时的（第二个 onPause() ，有问题的一个）：

```
06-12 22:09:00.324 11302 11350 I LoaderTask: Publishing message 13
06-12 22:09:00.324 11302 11350 I LoaderTask: Adding message 14
06-12 22:09:00.324 11302 11350 I LoaderTask: Publishing message 14
06-12 22:09:00.354 11302 11350 I LoaderTask: Adding message 15
06-12 22:09:00.354 11302 11302 D MessageTable: + onLayout(changed:false, l:0, t:0, r:800, b:20)
06-12 22:09:00.354 11302 11350 I LoaderTask: Publishing message 15
06-12 22:09:00.364 11302 11302 D MessageTable: + getColumns()
06-12 22:09:00.364 11302 11302 D MessageTable: + getRowCount()
06-12 22:09:00.364 11302 11302 D MessageTable: + getRowAt(index:-1)
06-12 22:09:00.364 11302 11302 D MessageRow: + getColumns()
06-12 22:09:00.364 11302 11302 D MessageTable: + setHeaderColumns(cols:[I@41125668)
06-12 22:09:00.364 11302 11302 D MessageRow: + setColumns(cols:[I@41125668)
06-12 22:09:00.364 11302 11302 D Viewer: + onSaveInstanceState(outState:Bundle[{}])
06-12 22:09:00.364 11302 11302 D Viewer: + onPause()
06-12 22:09:00.364 11302 11302 D LoaderTask: + getState()
06-12 22:09:00.364 11302 11302 D LoaderTask: + pause()
06-12 22:09:00.364   189   489 D WindowManager: adjustConfigurationLw, config:{1.0 0mcc0mnc (no locale) layoutdir=0 sw800dp w800dp h1232dp xlrg port ?uimode ?night finger -keyb/v/h -nav/v} mLidOpen:-1 mHasDockFeature:true mHasHallSensorFeature:true config.hardKeyboardHidden:2 
```

应用程序结构，根据要求添加：

```
MainActivity
    Launch Viewer Activity on Button click

Viewer Activity
    Show layout, has a MessageTable (TableLayout)
    Launch ShowFileChosser  to choose a Records file
    Execute LoaderTask with given file

LoaderTask
    Open given file
    doInBackground()    
        Read one record
        Add the record to an ArrayList
        if not paused Publish record
    onProgressUpdate()
        Show record in MessageTable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:47:44.237

```
06-12 18:21:09.394 9512 9512 D Viewer: + onStop()
06-12 18:21:14.684 9512 9512 D Viewer: + onActivityResult(requestCode:0, resultCode:-1, data:Intent { dat=file:///mnt/sdcard/Download/Records.11111.MyLog.gzip }) 
```

您已经过滤了 logcat，因此很难看到所有正在发生的事情，但看起来您正在使用 Intent 在这 5 秒的间隙中从另一个活动中获取某些内容（文件名？）。

每当您转移到另一个活动时，您都应该期待一个 onPause()-onResume() 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T14:15:37.073

我终于找到了多次 onPause() 调用的原因。就我而言，有多次调用 ShowFileChooser()。

正如 Chris Stratton 所指出的，在转移到另一个活动之后，有 onPause()，在这种情况下，在调用 ShowFileChooser() 之后。
查看器活动在我选择文件时停止（调用 onStop()），然后根据众所周知的活动生命周期重新启动。然后再次调用 ShowFilechooser，产生第二次暂停/停止。

我正在向克里斯提供答案，因为他的评论让我思考和重新思考，直到我发现正在发生的事情。

# c# - 循环中的列表<>

> ID：10999315
> 
> 赞同：0
> 
> 时间：2012-06-12T14:59:40.480
> 
> 标签：c#, list, loops

我在循环中使用列表时遇到问题，如果你们中的任何人可以帮助我，我将不胜感激。我想创建一个列表并从值大于-999 的数组（在我的代码中命名：sarray）填充它。但问题是当值小于 -999 时，代码会转储列表的先前项，并且大小不是 40，而是 27（好像创建了新的列表列表）！

```
 List<double> nums = new List<double>();
        for (int i = 0; i < 50; i++)
        {
            if (sarray[i] > -999)
            {
                nums.Add(sarray[i]);

            }
        } 
```

这些是价值观：

> [31411.0857 31411.0902 31411.0847 31411.0858 31411.0859 31411.0479 31411.0649 31411.0895 31411.0944 31411.0207 31411.0683 31411.0717 31411.075 31411.0825 -999 -999 -999 -999 -999 -999 -999 -999 -999 -999 31411.0156 31411.0718 31411.0719 31411.0884 31411.0885 31411.0936 31411.0896 31411.0897 31411.0537 31411.066 31411.0661 31411.0556 31411.0701 31411.0731 31411.0952 31411.0716 31411.0776 31411.0803 31411.091 31411.0911 31411.0919 31411.0919 31411.0919 31411.0919 31411.0919 31411.0919]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:07:14.070

您所描述的内容不会发生在您显示的代码中。它将数组中从索引 0 到索引 49 中大于 -999 的所有值添加到列表中。

如果数组大于 50 项，则不会使用数组中的所有项。您应该在循环中使用数组的长度来获取所有项目：

```
for (int i = 0; i < sarray.Length; i++) 
```

（即使您知道数组始终是 50 项，最好仍然使用该`Length`属性。这样，即使您将来更改数组的长度，数组也将始终使用整个数组。）

### 编辑：

我用你的数据测试了你的代码，列表最终有 40 项。

```
double[] sarray = {
  31411.0857, 31411.0902, 31411.0847, 31411.0858, 31411.0859, 31411.0479,
  31411.0649, 31411.0895, 31411.0944, 31411.0207, 31411.0683, 31411.0717,
  31411.075, 31411.0825, -999, -999, -999, -999, -999, -999, -999, -999,
  -999, -999, 31411.0156, 31411.0718, 31411.0719, 31411.0884, 31411.0885,
  31411.0936, 31411.0896, 31411.0897, 31411.0537, 31411.066, 31411.0661,
  31411.0556, 31411.0701, 31411.0731, 31411.0952, 31411.0716, 31411.0776,
  31411.0803, 31411.091, 31411.0911, 31411.0919, 31411.0919, 31411.0919,
  31411.0919, 31411.0919, 31411.0919
};

List<double> nums = new List<double>();
for (int i = 0; i < 50; i++) {
  if (sarray[i] > -999) {
    nums.Add(sarray[i]);
  }
}

Console.WriteLine(nums.Count); 
```

输出：

```
40 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T15:02:44.507

[泛型列表在其重载的构造函数](http://msdn.microsoft.com/en-us/library/fkbw11z0)之一中采用可枚举，您可以使用 Linq`Where`扩展方法来约束要添加的项目：

```
var nums = new List<double>(sarray.Where(d => d > -999)); 
```

您声明它`-999`代表您的“空”值，在这种情况下，您可以将 更改`Where`为不假设有效值大于-999：

```
var nums = new List<double>(sarray.Where(d => d != -999)); 
```

我相信这种风格比制作自己的循环更清楚地表达了意图。

顺便说一句，`double.NaN`可能是无效值的更明显表示。

* * *

> 但问题是当值小于 -999

这是因为您只检查值大于 -999 的位置：`if (sarray[i] > -999)`

但是，您提供的值转储没有任何小于 -999 的项目，因此此检查就足够了 - 只要数据集保持不变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:04:42.680

用这个：

```
List<double> nums = new List<double>(sarray.Where(x => x > -999)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T15:05:54.053

像这样的东西可以工作，而不必自己迭代：

```
List<double> nums = (from value in sarray 
                     where (value > -999) select value).ToList<double>(); 
```

# xml - 返回第 n 级的 XML 结构

> ID：10999317
> 
> 赞同：2
> 
> 时间：2012-06-12T14:59:45.767
> 
> 标签：xml, linux, xslt, xpath, xquery

是否有一种简单的方法（可能使用 Linux 中的开源命令行工具）从给定的 XML 文档中去除超出给定阈值的所有级别，而不管结构如何？

输入：

```
<a att="1">
   <b/>
   <c bat="2">
      <d/>
   </c>
</a> 
```

输出，级别=1：

```
<a att="1"/> 
```

输出，级别=2：

```
<a att="1">
   <b/>
   <c bat="2"/>
</a> 
```

我尝试过 XPath，但无法限制级别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:18:03.227

在 XSLT 中非常简单：

```
<xsl:template match="*">
  <xsl:if test="count(ancestor::*) &lt;= $level">
    <xsl:copy>
      <xsl:copy-of select="@*"/>
      <xsl:apply-templates/>
    </xsl:copy>
  </xsl:if>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T17:44:52.593

在 XQuery 中它几乎与在 XSLT 中相同：

```
copy $output := $input
modify delete nodes $output//node()[count(ancestor::*) eq $level]
return $output 
```

[用 zorba 试试](http://www.zorba-xquery.com/html/demo#wvpJsujW71mBn9MIuCNKM0h9Bbk= "试试佐巴")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T17:57:47.860

或者不使用 XQuery 更新，再次解构树并将其组合在一起，直到达到最大级别：

```
declare function local:limit-level($element as element(), $level as xs:integer) {  
    if ($level gt 0)
    then
        element {node-name($element)} {
            $element/@*,
      (
        for $child in $element/node()  
        return local:limit-level($child, $level - 1)
      )
    }
  else ()
};

local:limit-level(/*, 2) 
```

# sql - SQL：如果参数为空，则选择所有行，否则只选择匹配的行

> ID：10999322
> 
> 赞同：4
> 
> 时间：2012-06-12T15:00:13.917
> 
> 标签：sql, sql-server-2008-r2, isnull

我有一个变量进入存储过程。该变量可以有值也可以为空。

*   如果变量为空，我需要选择表中的所有行（一些具有 NULL 值，一些具有实际数据）。
*   如果变量不为空，我只需要选择变量与列匹配的行。

我创建了这个条件语句来帮助解释我想要实现的目标：

```
if 

@status is null, select all the rows (rows with NULL for table.status, and rows with actual data for table.status)

else

select the rows where @status equals table.status 
```

这就是我想出的（其中之一）：

```
WHERE 
   book.book_nme LIKE @search_input AND
   book.book_desc LIKE @search_input AND 
   (book.author LIKE ISNULL(@author, book.author)) AND
   (bookStatus.status_desc LIKE ISNULL(@status, bookStatus.status_desc)) 
```

唯一的问题是如果`bookStatus.status_desc`为 NULL，那么它不会选择该行（当@status 为空时）

我很困惑，我也尝试查找 Coalesce，它似乎优先考虑了这些值，但是......我不知道该怎么做。

我应该在存储过程中创建一个巨大的 CASE 并有两个 select 语句吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:06:53.937

```
WHERE  book.book_nme LIKE @search_input AND
book.book_desc LIKE @search_input AND 
(@author IS NULL OR book.author LIKE @author) AND
(@status IS NULL OR bookStatus.status_desc LIKE @status) ... 
```

**更新**
添加了两个条件，for`@author`和`@status`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:09:48.133

如果您考虑一下您的描述，它会分解为：

*   当@status 为空时返回所有行
*   否则返回匹配@status 的行。

你可以表达你的 sql 的最后一行来匹配这样的：

```
(@status is null OR bookStatus.status_desc LIKE @status) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-30T11:08:56.417

我总是用这个：

WHERE 字段名 = ISNULL(@parameter, 字段名)

希望这有助于罗杰

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-11T21:45:01.107

`where(field1 like isnull(@parameter,field1))`

如果参数为 null 将检索 field1 中的所有数据，例如

`select field from table1`

这适用于sybase。

# eclipse - 替换产品 ico 文件时出现 Tycho 错误

> ID：10999323
> 
> 赞同：3
> 
> 时间：2012-06-12T15:00:17.313
> 
> 标签：eclipse, maven, tycho

我们正在使用 tycho v0.13 和 maven 3.0 来构建我们的产品。
我们在构建时收到以下错误/警告

> 错误 - 7 图标未在 C:\Users\AppData\Local\Temp\p2.brandingIron7115583353836584113\launcher.exe 使用 D:\Builds\workspace\plugins\icons\app-icon.ico 替换

ico 文件都是正确的。因此，窗口图标被标准的 eclipse 图标所取代。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:46:11.553

我对 Tycho 本身并不太熟悉，但在这里我相信它使用的是 p2 附带的品牌代码（最初来自 PDE/Build）。

该代码从原始启动器可执行文件中提取图标图像，并在提供的 ico 文件中搜索匹配的图像。如果找到与大小和位深度完全匹配的图像，则替换该图像。启动器中嵌入了 7 个图像，提供的 ico 应提供与大小和位深度相匹配的图像。

错误消息表明在可执行文件中找到的 7 个图标在提供的 ico 文件中没有匹配的大小/位深度。

3.7.2 中附带的启动器包含以下尺寸（顺序无关紧要）：

*   48x48 8 位（256 色）
*   32x32 8 位
*   24x24 8 位
*   16x16 8 位
*   48x48 32 位（RGB + Alpha）
*   32x32 32 位
*   16x16 32 位

在 4.2 (3.8) 中发布的启动器包含以下尺寸：

*   256x256，32 位（RGB / Alpha 通道）
*   48x48，32 位（RGB / Alpha 通道）
*   32x32、32 位（RGB / Alpha 通道）
*   16x16，32 位（RGB / Alpha 通道）
*   48x48，8 位（256 色）
*   32x32，8 位（256 色）
*   16x16，8 位（256 色）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-02T09:20:09.150

我们有一些令人沮丧的时刻，我们得到了关于丢失图标的错误，所以我决定深入研究它。以下是我的发现……基本上是在 Andrew Niefer 的回答中添加了额外的信息。

对于 Windows，在本机启动器中替换图像的过程如下所述。处理由 p2 类完成：*org.eclipse.pde.internal.swt.tools.IconExe*

此类查看本机启动器的资源并注意其中的位图：它们的大小和颜色深度。然后它查看提供的图像。这可以是单独的 BPM 列表或包含多个 BMP 的 ICO 文件。还注明了它们的尺寸和颜色深度。这仅在所有提供的图像都未压缩时才有效。当一个或多个图像被压缩时，进程停止并且在本机启动器中没有位图被替换。接下来，它会尝试将提供的 BMP 大小和颜色深度与本机启动器中的匹配，并且在它们匹配的地方，它们会在本机启动器中被替换。当本机启动器中的一个或多个位图在提供的图像中不可用时，以下消息将写入*System.err*：

```
Error - <n> icon(s) not replaced in […]using […] 
```

*IconExe*类有一个 main 方法，可以独立运行。它的第一个参数是需要修改的本机启动器，以下参数是提供的 BPM 或 ICO 文件。

对于 Eclipse 4.3(.x)，本机启动器包含 7 个位图：

*   256x256，32 位（RGB / Alpha 通道）
*   48x48，32 位（RGB / Alpha 通道）
*   32x32、32 位（RGB / Alpha 通道）
*   16x16，32 位（RGB / Alpha 通道）
*   48x48，8 位（256 色）
*   32x32，8 位（256 色）
*   16x16，8 位（256 色）

因此，要成功替换图像的过程，需要提供 7 个具有相同大小和深度的图像，或者作为单独的 BMP，或者在 ICO 中。

但是，当使用*tycho-p2-publisher-plugin*时，您不能提供 7 个单独的 BPM，因为*tycho-p2-publisher-plugin在**.product*文件中指定时不知道 256x256x32 图像。它的类*org.eclipse.tycho.model.Launcher*仅从 .product 文件中读取其他 6 个图像位置*，*因此，第 7 个图像（256x256x32 的图像）被跳过。因此，*IconExe*获得的列表是一个简短的图像，并且将始终报告：

```
Error - 1 icon(s) not replaced in […]using […] 
```

对我们有用的解决方案是将 7 个 BMP 合并到一个 ICO 文件中，并在*.product*文件中提供。

但请注意，一些可以创建 ICO 文件的图像处理应用程序在默认情况下倾向于压缩 256x256x32 图像。这就是让我们走错路的原因！所以要小心 ICO 文件中的所有图像都是**未压缩**的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T10:41:41.963

当我的 ICO 文件包含 3.7.2 时，我遇到了类似的问题

1.  更高分辨率的图像，例如 512x512
2.  一些图像被压缩。

我使用 Gimp 从我的 ICO 文件中删除了未使用的层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T15:42:33.903

只是添加到以前的答案：

1.  .ico 文件中的所有图像都应该是 BMP 格式，而不是 PNG。我已经看到至少有两个实用程序想要将 PNG 格式用于一个或多个图像。

2.  如果您的目标是 Eclipse 4.2，那么您将不得不等待 Tycho 0.16.0（或使用已经可用的 SNAPSHOT 版本）才能获得包含最新 IconExe 的版本，该版本可处理 256x256 位图。如果您的 .ico 文件包含其中之一，那么它会在旧 IconExe 中导致读取错误，并且您的任何图标都不会被替换（并且您会收到如打开消息中所示的错误）。请参阅[https://bugs.eclipse.org/bugs/show_bug.cgi?id=384509](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384509)。

# wordpress - 我该怎么做才能删除帖子而不显示 404？

> ID：10999328
> 
> 赞同：0
> 
> 时间：2012-06-12T15:00:26.780
> 
> 标签：wordpress, tags, duplicate-data

我想从我的网站上删除几篇旧帖子。如果帖子已在 Google 中编入索引，如何在不产生 404 错误的情况下执行此操作？

我有 4 个 wordpress 网站。Google 是否会因我将帖子从一个站点移动到另一个站点或复制它们而受到处罚？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:05:14.180

您可以使用插件将用户从旧 URL 重定向到新 URL，Google 最终应该会赶上。我会推荐类似[重定向（链接）的东西。](http://wordpress.org/extend/plugins/redirection/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T18:16:53.217

您可以使用网站管理员工具 (https://www.google.com/webmasters/tools) 从 Google 中删除链接

1 - 在网站管理员工具主页上，单击所需的站点。2 - 在仪表板上，单击左侧菜单上的优化。3 - 单击删除 URL。4 - 单击新删除请求。5 - 键入要从搜索结果中删除的页面的 URL（不是 Google 搜索结果 URL 或缓存页面 URL），然后单击继续。URL 区分大小写——使用与站点使用完全相同的字符和大小写。6 - 单击是，删除此页面。7 - 单击提交请求。

# php - PHP 和 Prototype 的 AJAX

> ID：10999335
> 
> 赞同：0
> 
> 时间：2012-06-12T15:00:50.477
> 
> 标签：php, javascript, ajax, codeigniter, for-loop

我有一个 php 函数，它返回 JSON 以响应 ajax 请求交付费用。这是php函数：

```
public function getDeliveryOptions($weight, $postcode)
{

    if($weight == 0)
    {

        return array(array("name" => "Non-Deliverable", "value" => "0.00"));

    }

    $this->db->where('dmc_lower_boundary <=', $weight);
    $this->db->where('dmc_upper_boundary >=', $weight);

    if(preg_match("([aA][bB](3[1-8]|4[1-5]|5[1-6])\s?[1-9][a-zA-Z]{2}|[fF][kK](19|20|21)\s?[1-9][a-zA-Z]{2}|[hH][sS][1-9]\s?[1-9][a-zA-Z]{2}|[iI][vV][1-9]{1,2}\s?[1-9][a-zA-Z]{2}|[kK][aA](27|28)\s?[1-9][a-zA-Z]{2}|[kK][wW][1-9]{1,2}?\s?[1-9][a-zA-Z]{2}|[pP][aA][2-8][0-9]\s?[1-9][a-zA-Z]{2}|[pP][hH]([156789]|1[056789]|[2-5][0-9]){1,2}\s?[1-9][a-zA-Z]{2}|[zZ][eE][1-9]\s?[1-9][a-zA-Z]{2})", $postcode))
    {

        $this->db->where("dm_id = ", 1);
        $this->db->or_where("dm_id =", 3);

    }
    elseif(preg_match("/([bB][tT][1-9]{1,2}\s?[1-9][a-zA-Z]{2}|[iI][mM][1-9]{1,2}\s?[1-9][a-zA-Z]{2}|[tT][rR](21|22|23|24|25)\s?[1-9][a-zA-Z]{2})/", $postcode))
    {

        $this->db->where("dm_id =", 1);
        $this->db->or_where("dm_id =", 4);

    }
    elseif(preg_match("/([gG][yY][1-9]\s?[1-9][a-zA-Z]{2}|[jJ][eE][1-4]\s?[1-9][a-zA-Z]{2})/", $postcode))
    {

        $this->db->where("dm_id =", 1);
        $this->db->or_where("dm_id =", 5);

    }
    else
    {

        $this->db->where("dm_id =", 1);
        $this->db->or_where("dm_id =", 2);

    }

    $this->db->group_by("dm_id");
    $query = $this->db->get("delivery_method_option_views");
    //print_r($query->result());
    //print_r(json_encode($query->result()));
    return(json_encode($query->result()));
} 
```

这是我的 javascript（使用原型）将结果发送到服务器并使用响应来创建单选按钮：

```
function updateDelivery()
{
if($('deliveryUpdate') == null)
{

    return false;

}

// This 'observes' our form submit - sort of like onsubmit
$('deliveryUpdate').observe('submit', function(evt) {

    // Stop the actual event from happening
    evt.stop();

    // This is the url we submit to - change it as needed
    var url = '/checkout/updateDelivery';

    //This will be the form and div we update
    var containerForm = $('deliveryUpdate');
    var optionsDisplay = $('deliveryOptions');

    // Grab all the info in the form
    var form_data = containerForm.serialize();
    var form = containerForm.innerHTML;

    // Here we make the request
    new Ajax.Request(url, {
        method: 'post',
        parameters: form_data,
        onCreate: function() {
            form = containerForm.innerHTML;
            containerForm.update(form+'<img src="/images/loader.gif" alt="loading..." class="loader" />');
        },
        onSuccess: function(transport) {
            containerForm.update(form);
            NVPResponse = transport.responseText;

            if(NVPResponse !== '[object Array]')
            {

                NVPResponse = new Array(NVPResponse);

            }
            alert(NVPResponse);
            options = "";
            for(i=0; i<NVPResponse.length; ++i)

            {

                options += '<label for="delivery">'+NVPResponse[i].dm_name+'</label><input type="radio" name="delivery" value="'+NVPResponse[i].dmc_price+'" />';

            }

            //optionsDisplay.update(NVPResponse);
            optionsDisplay.update(options);
        }

    });

});

} 
```

如果我只是更新 JSON 结果（对于邮政编码 ab31 2as），我会得到以下信息：

`Calculate Delivery Costs[{"dm_id":"1","dm_name":"Royal Mail","dm_admin_name":"Royal Mail","dmc_lower_boundary":"101","dmc_upper_boundary":"250","dmc_price":"3.65"},{"dm_id":"3","dm_name":"Courier","dm_admin_name":"Fed Ex Zone 4","dmc_lower_boundary":"101","dmc_upper_boundary":"250","dmc_price":"4.50"}]`

但是，如果我使用选项 var 进行更新，我会在标签文本和单选按钮值所在的位置得到“未定义”。这是在 onSuccess 函数的 for 循环中构建的。有任何想法吗？

**编辑**

我在 for 循环之前添加了以下代码，因为我试图将 JSON 字符串用作对象而不是对象：

```
NVPResponse = JSON.parse(NVPResponse); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:10:17.520

我不是原型方面的大专家，但在我看来，你`NVPResponse`是一个字符串，而不是转换为 javascript 对象。（请参阅[AJAX](http://www.prototypejs.org/learn/introduction-to-ajax)（特别是评估 JavaScript 响应）和[JSON](http://www.prototypejs.org/learn/json)的原型文档）。

您的代码似乎还有其他一些问题。

在 PHP 代码中：

```
if($weight == 0)
    {

        return array(array("name" => "Non-Deliverable", "value" => "0.00"));

    } 
```

你返回一个没有JSONing的数组，这是故意的吗？

此外，似乎还有一个逻辑错误：

```
$this->db->or_where("dm_id =", 3); 
```

dm_id = 3 的查询，无论您之前设置的任何“位置”如何，因此

```
$this->db->where('dmc_lower_boundary <=', $weight);
$this->db->where('dmc_upper_boundary >=', $weight); 
```

如果 dm_id = 3（或任何其他 or_where 当然）将被忽略。解决方案可以是这样的：

```
$this->db->where_in("dm_id", array(1,3)); 
```

**编辑：**

In this case the query you wrote works perfectly well, but you should notice that Codeigniter does not put parentheses around OR arguments in its queries, therefore combining OR and AND in the same query can be buggy. the way you wrote the code the query will look something like this (which works fine):

```
SELECT * FROM (`t_name`) 
WHERE `dmc_lower_boundary` <= $weight AND `dm_id` = 1 OR `dm_id` = 3 
```

writing the same query in a different order (or sometimes when writing complex queries) can give you a very different result:

```
SELECT * FROM (`t_name`) 
WHERE `dm_id` = 1 OR `dm_id` = 3 AND `dmc_lower_boundary` <= $weight 
```

after a few serious bugs I learned to be careful with "or_where" :)

# javascript - 从 FBML 切换到 Javascript SDK 和社交插件

> ID：10999344
> 
> 赞同：3
> 
> 时间：2012-06-12T15:01:13.977
> 
> 标签：javascript, facebook-javascript-sdk, fbml, facebook-social-plugins, xfbml

这个问题可能有点开放式。

我将如何从在我的应用程序中使用 FBML 切换到使用 Javascript SDK 和社交插件。我正在处理一个庞大的应用程序，所以很难说 FBML 是如何实现的，以及 SDK 现在应该如何实现。首先我决定换这条线。

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

对此：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" xmlns:fb="http://ogp.me/ns/fb#"> 
```

此外，这段代码（看起来像是加载了 sdk）在那里

```
window.fbAsyncInit = function() 
{               
//initialize
FB.init({
  appId   : myid,
  status  : true,
  cookie  : true,
  xfbml   : true
}); 
};
(
function() 
{
    var something = document.createElement('script');
    something.async = true;
    something.type = 'text/javascript';
    something.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(something);
}()
); 
```

还有什么需要做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:36:34.903

此外，您还需要：

1.  定义一个 HTML 元素：`<div id="fb-root"></div>`在`<body>`.
2.  搜索以 FBML 开头的元素`<fb:`并删除与 FBML 关联的元素。

# wordpress - WordPress + Multisite + IIS7，带有分页和“旧条目”链接的 URL 重写错误导致 404

> ID：10999345
> 
> 赞同：0
> 
> 时间：2012-06-12T15:01:13.823
> 
> 标签：wordpress

在具有标准 URL 重写规则的 IIS7 上使用 Multisite WordPress (3.3.2) 会导致尾部斜杠和分页链接出现问题

例如，如果您访问具有如下 URL 的多站点博客：http: [//mydomain.com/bloga](http://mydomain.com/bloga)（**没有**尾部斜杠），“旧条目”链接将变为[http://mydomain.com/bloga/bloga/page/ 2/](http://mydomain.com/bloga/bloga/page/2/) -- 它将 URL 中的 blog slug 加倍，导致 404 错误。此外，任何前一页链接 1 2 3 4 5 等也有错误的 URL。

如果您访问[http://mydomain.com/bloga/](http://mydomain.com/bloga/)（**带有**斜杠），“旧条目”链接是正确的[http://mydomain.com/bloga/page/2/](http://mydomain.com/bloga/page/2/)

我发现这个问题存在于多台服务器上，安装了全新的、无主题和无插件的 WordPress

标准的 URL 重写规则如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="WordPress Rule 1" stopProcessing="true">
                    <match url="^index\.php$" ignoreCase="false" />
                    <action type="None" />
                </rule>
                <rule name="WordPress Rule 2" stopProcessing="true">
                    <match url="^([_0-9a-zA-Z-]+/)?files/(.+)" ignoreCase="false" />
                    <action type="Rewrite" url="wp-includes/ms-files.php?file={R:2}" appendQueryString="false" />
                </rule>
                <rule name="WordPress Rule 3" stopProcessing="true">
                    <match url="^([_0-9a-zA-Z-]+/)?wp-admin$" ignoreCase="false" />
                    <action type="Redirect" url="{R:1}wp-admin/" redirectType="Permanent" />
                </rule>
                <rule name="WordPress Rule 4" stopProcessing="true">
                    <match url="^" ignoreCase="false" />
                    <conditions logicalGrouping="MatchAny">
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" />
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" />
                    </conditions>
                    <action type="None" />
                </rule>
                <rule name="WordPress Rule 5" stopProcessing="true">
                    <match url="^[_0-9a-zA-Z-]+/(wp-(content|admin|includes).*)" ignoreCase="false" />
                    <action type="Rewrite" url="{R:1}" />
                </rule>
                <rule name="WordPress Rule 6" stopProcessing="true">
                    <match url="^([_0-9a-zA-Z-]+/)?(.*\.php)$" ignoreCase="false" />
                    <action type="Rewrite" url="{R:2}" />
                </rule>
                <rule name="WordPress Rule 7" stopProcessing="true">
                    <match url="." ignoreCase="false" />
                    <action type="Rewrite" url="index.php" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

有没有人看到这个问题或知道解决方案？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:24:48.853

在 WP Trac 上报道： http: [//core.trac.wordpress.org/ticket/18034](http://core.trac.wordpress.org/ticket/18034)

注意到并希望在未来的版本中得到修复

# sql-server - Microsoft access db错误编辑记录

> ID：10999350
> 
> 赞同：0
> 
> 时间：2012-06-12T15:01:29.063
> 
> 标签：sql-server, ms-access, ms-access-2007

我有一个使用 SQLServer 2008 R2 作为数据库的 Access 应用程序。

当我尝试更新单个记录时，我收到此错误：

> “3179 microsoft Jet 数据库引擎停止了进程，因为您和另一个用户正试图同时更改相同的数据”

此错误仅附加在此特定记录（和其他一些记录）上，并在我每次尝试更新时附加。应用程序（和数据库）作为单个用户运行，**我没有**同时运行的线程更新相同的记录

![在此处输入图像描述](../Images/e5018ea0138d71e439223e90717fe024.png)

我在我尝试的每台机器上都收到此错误，因此它不应该与 SQLServer 相关。

**编辑**
我尝试在 SQL Server 中直接更新记录，没问题，更新没问题。

我发现问题是当我从 Microsoft 访问更新四个文本字段（es.Note）之一时。

当我运行下面的脚本时，我只对特定记录（Cod_stabile=6600015）有错误，其他记录没有问题。更新其他字段没关系，只有文本字段出现错误。

```
Dim rs as DAO.Recordset
Dim db As DAO.Database
Set db = CurrentDb

. . .

StrSql = "SELECT St_Stabili.* FROM St_Stabili WHERE (St_Stabili.Cod_Stabile='6600015') ;"
Set rs = db.OpenRecordset(StrSql)
rs.Edit
rs!Note = '-'
rs.update  <- error

. . .

StrSql = "SELECT St_Stabili.* FROM St_Stabili WHERE (St_Stabili.Cod_Stabile='6600016') ;"
Set rs = db.OpenRecordset(StrSql)
rs.Edit
rs!Note = '-'
rs.update  <- OK! 
```

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T10:56:27.633

检查 SQL Server 中的表是否有任何触发器根据您的更新更新记录。这对 MS Access 来说似乎是另一个用户更新了记录。如果您的 SQL Server 表有 TIMESTAMP，尤其是在触发器中，请小心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T05:46:47.500

我解决了更改用于更新 TEXT 字段的方法：

```
Dim UpdCommand As ADODB.command
    Set UpdCommand = New ADODB.command
    With UpdCommand
        .ActiveConnection = CurrentProject.Connection
        .CommandType = adCmdText
        .CommandText = "UPDATE St_Stabili SET NoteStabile= ?" _
                                      & ",NoteGenerali = ?" _
                                      & ",NoteConteggio = ?" _
                                      & ",NoteAmministratori = ?" _
                & " WHERE St_Stabili.Cod_Stabile = ?;"

        .Parameters.Append .CreateParameter("NotaSt", adVarChar, adParamInput, 300, Me!NoteStabile_x)
        .Parameters.Append .CreateParameter("NotaGen", adVarChar, adParamInput, 300, Me!NoteGenerali_x)
        .Parameters.Append .CreateParameter("NotaCon", adVarChar, adParamInput, 300, Me!NoteConteggio_x)
        .Parameters.Append .CreateParameter("NotaAmm", adVarChar, adParamInput, 300, Me!NoteAmministratori_x)
        .Parameters.Append .CreateParameter("Cod_Stabile", adVarChar, adParamInput, 15, Me!Cod_Stabile_x)
    End With

UpdCommand.Execute 
```

# javascript - 无法在严格模式下创建对象属性

> ID：10999351
> 
> 赞同：2
> 
> 时间：2012-06-12T15:01:33.480
> 
> 标签：javascript, mode, strict

如果我使用严格模式，则以下代码不起作用。它在 this.bar = 'foobar'; 上失败了 线。为什么会这样？如何在严格模式下创建对象属性？

```
<html>
<body>
<script>
"use strict";
var foo = (function () {
    this.bar = 'foobar';
    return this;
}());
alert(foo.bar);
</script>
</body>
</html> 
```

**编辑：** 感谢 James Allardice 指出问题。我错误地认为自执行函数正在创建一个对象，但事实并非如此。我需要执行以下操作之一：

```
"use strict";
var foo = new function () {
    this.bar = 'foobar';
};
alert(foo.bar); 
```

或者（这个 JSLint 更喜欢）

```
"use strict";
var foo = (function () {
    var obj = {};
    obj.bar = 'foobar';
    return obj;
}());
alert(foo.bar); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:04:37.587

在严格模式下，`this`不会引用窗口。在您的示例中，删除严格模式指令将导致`this`引用窗口。

由于在严格模式下，`this`在您的示例中`undefined`，您会收到错误消息。那是因为你不能在`undefined`.

来自[MDN](https://developer.mozilla.org/en/JavaScript/Strict_mode)（强调与您的情况相关的部分）：

> 首先，作为 this 传递给严格模式下的函数的值不会被装箱到对象中。对于**普通函数**， this 始终是一个对象：如果使用对象值 this 调用提供的对象；如果使用布尔值、字符串或数字调用此值，则被装箱；或者**全局对象，如果使用 undefined 或 null this 调用**...自动装箱是性能成本，但在浏览器中公开全局对象是一种安全隐患，因为全局对象提供对“安全”JavaScript 环境必须限制的功能的访问。因此对于严格模式函数，**指定的 this 使用不变**

# operating-system - 上下文切换是 O(1) 过程吗

> ID：10999360
> 
> 赞同：2
> 
> 时间：2012-06-12T15:01:58.547
> 
> 标签：operating-system

上下文切换是一个 O(1) 过程还是上下文切换量取决于各种可能影响它所花费时间的本地因素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:20:27.323

不，有很多不同的原因。主要是在同一进程的两个线程之间切换上下文，以及在不同进程的两个线程之间切换上下文意味着**地址空间的**变化。更改地址空间对于缓存和内存来说始终是一项代价高昂的操作。在 x86 上，您需要重新加载*页面目录*，在 PowperPC 上，您需要使*TLB*无效并重新加载，...

*从线程到内核时，更改地址空间不是强制性的。只是为了保持不变，我认为 Linux 总是加载内核地址空间（使用 PAE 工具并使用内核地址空间锁定 4 条目 PDBR 的条目，从 AS 上半部分开始，在 0xc0000000）。*

# javascript - 来自选择菜单的 HTML 表单表中的总值

> ID：10999362
> 
> 赞同：0
> 
> 时间：2012-06-12T15:02:01.220
> 
> 标签：javascript, jquery, html

我有一个简单的 HTML 表单，其中有一列有一个带有 2 个选项的选择菜单：中等或高。我需要找到单元格 =“中等”的所有行并计算同一行中另一个单元格的总数，并对单元格 =“高”的所有行重复此操作。这是一个 JS Fiddle，显示了一个完整的示例表：

[http://jsfiddle.net/8hn2H/](http://jsfiddle.net/8hn2H/)

在此示例中，Total Moderate 的结果为 1.6，Total High 的结果为 8.7（它是 Average Hours/Week 列中的值的总和）。行数不会预先固定 - 可能有 1 个或更多。

这是表单的实际 html：

```
<div class="span8"><br>
      <table id="activities" class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Activity</th>
            <th>Risk</th>
            <th>Hours/Week</th>
            <th>Weeks/Year</th>
            <th>Average Hours/Week</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input name="Activity"  id="Activity" type="text" value=""/></td>
            <td><div class="controls">
              <select id="Risk">
                <option></option>
                <option>Moderate</option>
                <option>High</option>
              </select>
            </div></td>
            <td><input class="span1" id="A1" type="text" value=""/></td>
            <td><input class="span1" id="B1" type="text" value=""/></td>
            <td><input class="span1" id="C1" type="text" value=""/></td>
            <td><button class="btn">Delete Activity</button></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Total Moderate</td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Total High</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:10:55.487

```
var moderateTotal = 0;
var highTotal = 0;
$("#activities").find("tr").each(function() {
    var tr = $(this);
    var level = tr.find("td:nth-child(2)").html();
    var value = tr.find("td:nth-child(5)").html();

    switch(level)
    {
        case "Moderate":
            moderateTotal += value*1;
        break;
        case "High":
            highTotal += value*1;
        break;
    }
});

$("#activities tr:last td:last").prev().html("High Total: " + highTotal);
$("#activities tr:last").prev().find("td:last").prev().html("Moderate Total: " + moderateTotal); 
```

我使用 jQuery[`.find()`](http://api.jquery.com/find/)和[`.each()`](http://api.jquery.com/each/)函数来遍历每一行。我`find`再次使用来查找级别和值（第 2 列和第 5 列）以及将值添加到总数中的 switch 语句。我需要`value*1`将字符串转换为整数，以便添加。这里的默认行为是连接。

最后两行设置表格单元格的值。如果你可以给它们一个特定的 ID，那么你就可以做到这一点会容易得多，`$("moderateTotal").html()`但由于没有给出，所以我使用了一些 jQuery 选择器来做到这一点。

[演示](http://jsfiddle.net/8hn2H/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:30:42.153

有很多方法可以解决这个问题，但我强烈建议您考虑使用 jQuery DataTables。它内置了对字段求和、排序、过滤等功能，并且比必须自制一些东西要容易得多。另外，它看起来比一个完全支持 Themeroller 的光秃秃的桌子要好得多。

这是一个带有页脚回调的简单示例：http: [//datatables.net/release-datatables/examples/advanced_init/footer_callback.html](http://datatables.net/release-datatables/examples/advanced_init/footer_callback.html)

因为表中的所有数据都可以通过 API 完全提供给您，所以很容易对其进行数学运算。您 -- 可以 -- 简单地根据中等或高标志过滤表并仅显示该数据，从而允许用户即时修改该视图。

而且，如果您的数据变得非常长，它有分页和 ajax 加载选项来提高用户级别的速度。

# matlab - 将阵列保存到磁盘

> ID：10999365
> 
> 赞同：3
> 
> 时间：2012-06-12T15:02:13.403
> 
> 标签：matlab, file-io

我有一个`Matlab`函数可以创建一个内部带有矩阵的单元格数组。它看起来像这样：

```
>> ind

ind = 

    [10x3  double]
    [10x11 double]
    [ 1x11 double]

>> ind{1}

ans =

   -0.0407    0.1806    0.3175
   -0.1630   -0.0477    0.3487
   -0.1704   -0.0903    0.2375
    0.4861   -0.0547    0.3547
    0.4440    0.1793    0.3329
   -0.3888   -0.0768   -0.3908
   -0.0429    0.2418    0.6098
    0.0263   -0.3948   -0.2316
    0.3766    0.5255   -0.1580
   -0.4005   -0.2788   -0.4579 
```

我希望能够将此单元格数组保存到文件中，然后再加载它。

哪种方法最快？有没有办法避免手工操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:06:14.677

一般解决方案很简单：

```
myvar = ind{1};
save myfilename myvar; 
load myfilename; 
```

如果没有指定变量，`save`/`load`处理工作区/文件中的所有变量。您可以保存/加载多个特定变量：

```
save myfilename;
save myfilename myvar1;
save myfilename myvar2;
save myfilename myvar1 myvar2;

load myfilename;
load myfilename myvar1;
load myfilename myvar2;
load myfilename myvar1 myvar2; 
```

由于文件中的变量被命名为无序检索，因此您无法保存表达式的结果，但必须始终通过变量（如答案一样）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T15:05:44.760

我不知道内置函数`save`是否是最快的方法，但是为什么在得到更好的建议之前不使用它呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T13:29:52.067

还可以取决于您要将其保存到的文件类型。如果要将其保存到 .xls (Excel) 文件，可以使用 xlswrite() 函数。以下内容来自 xlswrite() 函数的文档：

xlswrite(filename,A,sheet,range) 写入指定的工作表和范围。使用语法“C1:C2”指定范围，其中 C1 和 C2 是定义区域的两个相对角。

希望这会有所帮助，但我也同意卢卡的回答。

# objective-c - 如何使用 Xcode 中的简单按钮从另一个类调用方法

> ID：10999371
> 
> 赞同：0
> 
> 时间：2012-06-12T15:02:45.343
> 
> 标签：objective-c, ios

我正在尝试使用情节提要中的一个简单按钮从另一个类调用方法。这是我的文件：

视图控制器.m

```
//  ViewController.h

#import <UIKit/UIKit.h>
#import <Foundation/Foundation.h>
#import "PrintHello.h"

@interface ViewController : UIViewController <NSObject>{

PrintHello *printMessage;
}

@property (nonatomic, retain) PrintHello *printMessage;
@end 
```

视图控制器.m

```
//  ViewController.m
#import "ViewController.h"
@interface ViewController ()
@end

@implementation ViewController
@synthesize printMessage;

- (void)viewDidLoad{
[super viewDidLoad];
NSLog(@"ViewDidLoad loaded");
}

- (IBAction)Button01:(id)sender{

self.printMessage = [[PrintHello alloc] init]; // EDIT: THIS LINE WAS MISSING NOW IT WORKS

[self.printMessage Print];
NSLog(@"Button01 Pressed");    
}
@end 
```

打印你好.h

```
//  PrintHello.h
#import <Foundation/Foundation.h>

@interface PrintHello : NSObject
-(void) Print;
@end 
```

打印你好.m

// 打印你好.m

```
#import "PrintHello.h"
@implementation PrintHello 

-(void)Print{ NSLog(@"Printed");}

@end 
```

而且在storyBoard 中还有一个Button01 链接到Viecontroller。从日志中我知道：

加载 viewDidLoad 并在按下按钮时按下按钮:) 但是方法 Print 没有被调用？

我在哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:09:10.260

在你打电话之前`[self.printMessage Print];`，我认为你需要把`self.printMessage = [[PrintHello alloc] init];`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:13:21.197

正如 woz 所说，您还没有初始化 printMessage，所以该对象还不存在！您可能希望在 ViewController.m 文件的 viewDidLoad 中对其进行初始化，而不是在单击按钮时一遍又一遍地重新初始化对象。

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    self.printMessage = [[PrintHello alloc] init];
    NSLog(@"ViewDidLoad loaded");
} 
```

# php - PHP中的多个邮件附件

> ID：10999373
> 
> 赞同：0
> 
> 时间：2012-06-12T15:02:51.050
> 
> 标签：php, email, attachment

我想知道我是否可以在某件事上挑你的脑筋。

我的网站上有一个邮件脚本，可用于发送带有单个附件的电子邮件。发送单个附件就可以了。

我希望能够发送带有多个附件的电子邮件，但这样做时遇到了问题。

这是我在表单中的文件选择框：

```
<input type="file" name="attachment[]" id="attachment[]" multiple onfocus="this.style.backgroundColor='#e7e7e7'" onblur="this.style.backgroundColor='#ffffff'"/> 
```

Then, when the files are selected this is the php that handles it:

```
if (!empty($_FILES['attachment']['name'])) 
    {
        if(count($_FILES['attachment']['name'])>0) 
        {
            $count = 0;
            foreach ($_FILES['attachment']['name'] as $file) 
            {
                $name_of_file = $_FILES['attachment']['name'][$count];
                $file_name = $guid." - ".$name_of_file;
                $temp_name = $_FILES['attachment']['tmp_name'][$count];
                $file_type = $_FILES['attachment']['type'][$count];
                $file_size = $_FILES['attachment']['size'][$count];
                $count++;

                if ($file_size > 2048000)
                {
                    header ("refresh: 5; url=attach.php");
                    include ("header.php");
                    echo "File size is to big. Size must be no bigger than 2Mb. Please go <a href='attach.php'>back</a>";
                    include ("footer.php");
                    exit;
                }
                else
                {
                    $pics = array(".bmp", ".gif", ".jpg", "jpeg", ".png"); //5
                    $docs = array(".doc", "docx", ".odt", ".pdf", ".ppt", "pptx", ".rtf", ".txt", ".xls", "xlsx"); //10
                    $misc = array(".csv", ".htm", "html", ".php", ".pkt", ".rar", ".sql", ".xpi", ".zip"); //9

                    $base = basename($file_name);
                    $extension = substr($base, strlen($base)-4, strlen($base));
                    $extension = strtolower($extension);

                    if (in_array($extension,$pics))
                    {
                        $target = "".FILES."/".FUP_PICS."/";
                    }

                    if (in_array($extension,$docs))
                    {
                        $target = "".FILES."/".FUP_DOCS."/";
                    }

                    if (in_array($extension,$misc))
                    {
                        $target = "".FILES."/".FUP_MISC."/";
                    }

                    $target = $target.$base;

                    $allowed_extensions = array(".bmp", ".csv", ".doc", "docx", ".gif", ".htm", "html",
                                                ".jpg", ".JPG", "jpeg", "JPEG", ".odt", ".pdf", ".php", ".pkt", ".png", ".ppt", "pptx",
                                                ".rtf", ".sql", ".txt", ".xls", "xlsx", ".zip"
                                                );

                    if(in_array($extension,$allowed_extensions)) 
                    {
                        $from = mysql_real_escape_string($_POST['from']);
                        $emailto = mysql_real_escape_string($_POST['emailto']);
                        $bcc = mysql_real_escape_string($_POST['bcc']);
                        $subject = htmlspecialchars($_POST['subject']);
                        $message = htmlspecialchars($_POST['message'], ENT_NOQUOTES);
                        $message1 = htmlspecialchars_decode($_POST['message'], ENT_QUOTES);
                        if ($sendhash == 'Y')
                        {
                            $message1 .= "\n\nThe following is your unique message ID: ";
                            $message1 .= $guid;
                            $message1 .= "\n\nAttachment has been scanned for viruses and is virus free.";
                            $message1 .= "\n\nPlease make sure the first part of the file name matches the unique message ID. If it does not, please DO NOT open the file";
                            $message1 .= "\n\nTo verify the validity of the message, click the link below or copy and paste it into your browser:";
                            $message1 .= "\n\n ";
                            $message1 .= HTTP_PATH;
                            $message1 .= "verify.php?uid=";
                            $message1 .= urlencode($guid);
                            $message1 .= "\n\nPlease note, verification link expires on ";
                            $message1 .= $expirydate;
                        }
                        else
                        {
                        }
                        $message1 .= "\n\n--\nSent from Chris' Address Book";

                        foreach ($file as $files)
                        {
                        $files = $temp_name;
                        $content = chunk_split(base64_encode(file_get_contents($file)));
                        $uid = md5(uniqid(time()));

                        $header = "From: ".$from."\r\n";
                        $header .= "Reply-To: ".$from."\r\n";
                        $header .= "Bcc: ".$bcc."\r\n";
                        $header .= "MIME-Version: 1.0\r\n";

                        $header .= "Content-Type: multipart/mixed; boundary=\"".$uid."\"\r\n\r\n";
                        $header .= "This is a multi-part message in MIME format. \r\n";

                        $header .= "--".$uid."\r\n";
                        $header .= "Content-Transfer-Encoding: 7bit\r\n\r\n";
                        $header .= $message1."\r\n";

                        $header .= "--".$uid."\r\n";
                        $header .= "Content-Type: ".$file_type."; name=\"".$file_name."\"\r\n";
                        $header .= "Content-Transfer-Encoding: base64\r\n";
                        $header .= "Content-Disposition: attachment; filename=\"".$file_name."\"\r\n\r\n";
                        $header .= $content."\r\n";
                        }

                        if ($_POST['emailto'] == '')
                        {
                            $sqlp=mysql_query("SELECT * FROM ".PERSON." JOIN contact on contact.personID = person.adbkid WHERE email1 = '$bcc' OR email2 = '$bcc'");
                            $num=mysql_numrows($sqlp);
                        }
                        else
                        {
                            $sqlp=mysql_query("SELECT * FROM ".PERSON." JOIN contact on contact.personID = person.adbkid WHERE email1 = '$emailto' OR email2 = '$emailto'");
                            $num=mysql_numrows($sqlp);
                        }

                        while ($row = mysql_fetch_array($sqlp))
                        {
                            $adbkid = $row['adbkid'];
                            $id = $row['id'];
                        }

                            if ($num == 0)
                            {
                                $selfid = "EMAILSA";
                            }
                            else
                            {
                                $selfid = $adbkid;
                            }

                        if (mail($emailto, $subject, "", $header)) 
                        {
                            if ($sendhash == 'Y')
                            {
                                $sql=mysql_query("INSERT INTO ".EMAILS." (emailfrom, emailto, bcc, subject, message, getthedate, gettime, randhash, fileatt, fileext, showinsearch, expireit, showinverify, wasviewed, personID) VALUES ('$from', '$emailto', '$bcc', '$subject', '$message', '$getthedate', '$gettime', '$guid', '$file_name', '$extension', '$showinsearch', '$expireit', '$siv', '$wv', '$selfid')"); 
                                $lastid=mysql_insert_id();
                                $sqlr=mysql_query("INSERT INTO ".HASH." (randhash) VALUES ('$guid')");
                            }
                            else
                            {
                                $sql=mysql_query("INSERT INTO ".EMAILS." (emailfrom, emailto, bcc, subject, message, getthedate, gettime, fileatt, fileext, showinsearch, expireit, showinverify, wasviewed, personID) VALUES ('$from', '$emailto', '$bcc', '$subject', '$message', '$getthedate', '$gettime', '$file_name', '$extension', '$showinsearch', '$expireit', '$siv', '$wv', '$selfid')"); 
                                $lastid=mysql_insert_id();                          
                            }
                            $sqlone = "INSERT INTO ".SENTFILES." (filename, filetype, fileext, filesize, filetempname, dateadded, timeadded, fileguid, sentmailid) VALUES ('$file_name', '$file_type', '$extension', '$file_size', '$temp_name', '$getthedate', '$gettime', '$guid', '$lastid')";
                            $expire = mysql_query("UPDATE ".EMAILS." SET showinverify = 0 WHERE expireit < CURDATE()"); 
                            if (!mysql_query($sqlone,$conn))
                            {
                                die("Error: " . mysql_error().".");
                            }

                            header ("refresh: 5; url=$url");
                            include ("header.php");
                            $ful = (move_uploaded_file($temp_name, $target)) ? "".$file_name." was uploaded to ".$target."" : "".$file_name.", was not uploaded. Please try a manual upload.";
                            echo "<title>Success sending email</title>";
                            echo "Your message has been successfully sent. Message details have been added to the database.<p>$ful";
                            include ("footer.php");
                        }
                        else
                        {
                            header ("refresh: 5; url=$url");
                            include ("header.php");
                            echo "<title>Error sending email</title>";
                            echo "There seems to be an error sending your email.";
                            include ("footer.php");
                        }
                        exit;
                    }
                    else
                    {
                        header ("refresh: 5; url=attach.php");
                        include ("header.php");
                        echo "File type is not allowed. Please go <a href='attach.php'>back</a>";
                        include ("footer.php");
                        exit;
                    }
                }
            }
        } 
```

我遇到的问题是，当我尝试以这种方式发送电子邮件时，出现以下错误：

```
Warning: Invalid argument supplied for foreach() in /home/flattley/public_html/chriswilcox/cab/attach.php on line 150 
```

第 150 行是这样的：

```
foreach ($file as $files) 
```

我只是不知道我哪里出错了。如果我没有 foreach 循环，它就不会发送，或者只会发送第一个文件。

我知道我可以使用 phpmailer 之类的东西，但我希望自己能够做到这一点。我只是看不出我哪里出错了。

我已经在家中的本地 apache 上尝试了该脚本，但没有邮寄它，它可以很好地上传和移动多个文件 - 就像在我的主机上一样。当我添加邮寄选项时，一切都变成了梨形。

您能提供的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:11:51.820

如果你回顾你的代码：

```
foreach ($_FILES['attachment']['name'] as $file) 
```

`$file`已经是单个文件名。它不是一个数组。如前所述，我的[php 文档](http://php.net/manual/en/features.file-upload.multiple.php)。

我在您的代码中看到，您尝试获取上传文件的内容。为此，您可以执行以下操作：

```
foreach($_FILES['attachment']['tmp_name'] as $eachFile){
    $content = chunk_split(base64_encode(file_get_contents($file)));
    $uid = md5(uniqid(time()));

    $header = "From: ".$from."\r\n";
    $header .= "Reply-To: ".$from."\r\n";
    $header .= "Bcc: ".$bcc."\r\n";
    $header .= "MIME-Version: 1.0\r\n";

    $header .= "Content-Type: multipart/mixed; boundary=\"".$uid."\"\r\n\r\n";
    $header .= "This is a multi-part message in MIME format. \r\n";

    $header .= "--".$uid."\r\n";
    $header .= "Content-Transfer-Encoding: 7bit\r\n\r\n";
    $header .= $message1."\r\n";

    $header .= "--".$uid."\r\n";
    $header .= "Content-Type: ".$file_type."; name=\"".$file_name."\"\r\n";
    $header .= "Content-Transfer-Encoding: base64\r\n";
    $header .= "Content-Disposition: attachment; filename=\"".$file_name."\"\r\n\r\n";
    $header .= $content."\r\n";
} 
```

# android - 对话框构造函数里面有什么

> ID：10999374
> 
> 赞同：0
> 
> 时间：2012-06-12T15:02:56.027
> 
> 标签：android, android-asynctask, android-dialog

我知道它应该是上下文。究竟什么是上下文。通常当我在一个类中创建一个对话框时，我会做这样的事情：

```
final Dialog dialog = new Dialog(this); 
```

但现在我正在尝试在 AsyncTask<> 中创建一个对话框，因此我无法执行上述操作，因为 AsyncTask 显然不是上下文。AsyncTask 本身就是一个类，也就是说它现在不是一个子类。

```
public class popTask extends AsyncTask<Void, Void, String> {

Context con =

@Override
protected void onPostExecute(String result) {
    // TODO Auto-generated method stub
    super.onPostExecute(result);

    final Dialog dialog = new Dialog(con);
    dialog.setContentView(R.layout.custom);
    dialog.setTitle("New & Hot advertise");

    // set the custom dialog components - text, image and button
    TextView text = (TextView) dialog.findViewById(R.id.text);
    text.setText("Android custom dialog example!");
    ImageView image = (ImageView) dialog.findViewById(R.id.image);
    image.setImageResource(R.drawable.yoda);

    Button dialogButton = (Button) dialog.findViewById(R.id.dialogButtonOK);
    // if button is clicked, close the custom dialog
    dialogButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            dialog.dismiss();
        }
    });

    dialog.show();
}

@Override
protected String doInBackground(Void... params) {
    // TODO Auto-generated method stub
    return null;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:17:44.203

添加到萨米尔的答案

修改您的代码以具有构造函数，该构造函数采用调用类的上下文。

```
public class popTask extends AsyncTask<Void, Void, String> {

    private Context context;
    public popTask(Context context)
    {
        this.cotext=context;
    } 
```

接着`Dialog dialog = new Dialog(context);`

在您的呼叫活动中，像这样调用此 Asynctask

`new popTask(ActivityName.this).execute();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:14:15.063

以下是您可以从正在执行 AsyncTask 的活动发送上下文的两种方式：

```
popTask pTask = new popTask(mContext); //OR
pTask.execute(mContext); 
```

在您`popTask`创建一个私有变量时，您可以在其中设置您的上下文。

在第一个选项中，您需要为您的类提供一个`popTask`接受上下文的构造函数。

对于第二个选项，如果您没有向函数传递任何有意义的内容，则`doInBackground()`可以更改以下行：

```
public class popTask extends AsyncTask<Object, Void, String>

protected Object doInBackground(Object... params) {
this.mContext = (Context) params[0]; 
```

}

您将收到`doInBackground()`可以在类的私有 Context 变量中设置的上下文对象`popTask`，然后在`doInBackground()`函数中访问它。

# silverlight - Silverlight 中的只读日期选择器

> ID：10999378
> 
> 赞同：0
> 
> 时间：2012-06-12T15:03:06.750
> 
> 标签：silverlight, validation, datepicker, readonly

我正在 Silverlight 3.0 中制作应用程序。在该应用程序中，我使用 DatePicker 控件作为

```
<TextBlock FontSize="13" Height="23" Name="txtFromDate" Text="FromDate" Width="40" Canvas.Left="444" Canvas.Top="6" />
<controls:DatePicker Name="fromdatePicker" Height="23" Width="110" Canvas.Left="550" Canvas.Top="4"  /> 
```

在这里我不想手动输入日期（意味着文本块 txtFromDate 应该是只读的。）文本块中的值将是从日历中选择的任何日期。我不知道该怎么做？请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:33:45.160

假设您正在使用一种不错的 MVVM 方法：

`SeletectedDate`将日期选择器绑定到`DateTime`ViewModel 的属性（双向绑定）：

```
<sdk:DatePicker SelectedDate="{Binding MyDate, Mode=TwoWay}"/> 
```

将您的 Text 属性绑定`TextBlock`到相同的属性：

```
<TextBlock Text="{Binding MyDate}" /> 
```

# mfc - MFC CListCtrl 右键单击 标题

> ID：10999381
> 
> 赞同：1
> 
> 时间：2012-06-12T15:03:07.973
> 
> 标签：mfc, clistctrl

我有一个用 Visual Studio 6 编写的 MFC 应用程序，我正在向其中添加一些新功能。我想要做的是当用户右键单击属性页内列表控件上的标题列时显示上下文菜单。CListCtrl 类已添加查看类向导。

通过属性页的 ClassWizard，我添加了一个用于右键单击 listctrl 的处理程序。这确实被调用了，我添加了以下代码来确定 rclick 是否在标题部分上方，如果是，则在哪个标题项上。像这样

```
POINT Point;
GetCursorPos (&Point);
ScreenToClient(&Point);

HDHITTESTINFO HitTest;

//Offset of right scrolling  
HitTest.pt.x = Point.x+ m_ctrlRecordList.GetScrollPos(SB_HORZ); //Offset of right scrolling
HitTest.pt.y = Point.y;

//Send the Hit Test Message
m_ctrlRecordList.GetHeaderCtrl()->SendMessage(HDM_HITTEST,0,(LPARAM)&HitTest);

    // Check hit test result.

*pResult = 0; 
```

但是，命中测试总是返回 -1。

我尝试通过在属性页中处理标题控件的 HDN_ItemClick 消息来代替左键单击。这一切都是在 ClassWizard 中完成的，所以我希望能够在这里处理这个通知。但是，从我目前的研究来看，MFC 中可能存在一个错误，其中 ClassWizard 将此代码放入您的代码中，但此通知永远不会到达您的列表控件的父级。是这样吗？

最好的方法是什么？我更喜欢右键单击，但如有必要，左键单击会这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:27:58.803

您不能尝试在对话框中处理来自列表标题的消息，也不能在 CListCtrl 派生类中这样做。

MFC 对某些控件使用消息反射，并且仅用于某些消息/通知代码。

很可能您正在传递鼠标单击列表控件的坐标，因此命中测试失败。尝试这个：

添加从 CHeaderCtrl 派生的类。在对话框中声明派生类的成员变量。我假设您已经对列表控件进行了子类化（由向导插入了变量）。在**OnInitDialog**中写入以下内容：

```
// m_List is the dialog’s member of the subclassed list control, 
// m_header is a member variable of your new header class:
// insert this code after list control is already 
// initialized and all columns are added.
CHeaderCtrl* pHeaeder = m_List.GetHeaderCtrl();

m_Header.SubclassWindow(pHeaeder->m_hWnd); 
```

在派生类和弹出菜单中插入 WM_CONTEXTMENU 或 WM_LBUTTONUP 的处理程序。您将收到点击位置的 CPoint 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T12:43:15.313

我已经设法解决了这个问题，并认为我会添加答案，以防其他人遇到同样的问题。我最初发布的代码很好，但它需要放在从 CListCtrl 派生的类的 OnNotify 处理程序中。ClassWizard 允许您将反射处理程序添加到列表控件的父级，但消息永远不会到达那么远。

# java - 迭代器如何在添加时抛出 ConcurrentModificationException

> ID：10999388
> 
> 赞同：5
> 
> 时间：2012-06-12T15:03:27.300
> 
> 标签：java, iterator

当我们在当前节点之后添加一些对象或在当前节点之后删除一些对象时如何`Iterator`抛出。`ConcurrentModificationException`是否`Iterator`维护对基础集合的副本或引用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:06:31.730

迭代器维护对基础集合的引用。如果您添加或删除一个元素，迭代器可能会留在一个不可能的索引处，或者集合可能会从迭代器“从下面出来”改变。

因此，大多数集合不会在不通知您的情况下让迭代器损坏，而是在您尝试在迭代时修改集合时抛出 ConcurrentModificationException ，这样您就不会遇到不可预测的损坏迭代器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:07:52.993

根据合同，您不允许在迭代集合时修改集合（使用`Iterator.remove()`et al 除外）。

当您这样做时，集合不会随机失败，而是足以跟踪它被修改的次数，并`ConcurrentModificationException`在检测到并发修改时抛出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:17:44.480

ConcurrentModificationException 可能是你的朋友，你应该学会忍受它。但是，为了完整起见：

有一些非 Oracle 集合不会抛出 ConcurrentModificationException。它们更快（因为它们不花时间检查）并且显然更灵活，但在使用时需要更加小心。

Oracle 有四个（最后计数的）“并发”类，它们也不会在 java.util.concurrent 中抛出它（ConcurrentHashMap、ConcurrentLinkedQueue、ConcurrentSkipListMap 和 ConcurrentSkipListSet）。它们比它们的非并发等价物稍微慢一些，但它们是线程安全的*并且*它们不会*阻塞*。无论您做什么，它们都不会扰乱您的数据*，*但它们不会阻止*您*对其进行扰乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T04:54:28.373

对于删除，您可以使用 iterator.remove()，如下所示：

```
for (Iterator iterator = list.iterator(); iterator.hasNext();) {
Object object = iterator.next();
    /* ... */
    if (condition) {
       iterator.remove();
    } 
```

对于添加，您可以将简单的迭代器替换为 ListIterator，如下所示

```
ListIterator<Object> iterator = list.listIterator();
iterator.add(new Object()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:06:25.130

当然，迭代器有一个指向底层集合的链接，这样可以避免复制。例如，如果您查看 ArrayList 迭代器 (ListItr) 的源代码，您会发现它主要包含指向列表的链接和光标。

所以，不要在线程之间共享迭代器，也不要修改你正在迭代的集合。

# javascript - 这是 javascript，我应该把它放在哪里

> ID：10999389
> 
> 赞同：0
> 
> 时间：2012-06-12T15:03:29.973
> 
> 标签：javascript, html, file-upload

我遇到了这个 html 多文件上传教程：[http ://robertnyman.com/2010/12/16/utilizing-the-html5-file-api-to-choose-upload-preview-and-see-progress-for-多文件/](http://robertnyman.com/2010/12/16/utilizing-the-html5-file-api-to-choose-upload-preview-and-see-progress-for-multiple-files/)

我对网络编程很陌生，以至于无法理解如何从本教程中“完整代码”的两个部分制作代码，基本上是：

A. 一些 html 代码：

```
<h3>Choose file(s)</h3>
<p>
    <input id="files-upload" type="file" multiple>
</p>
<p id="drop-area">
    <span class="drop-instructions">or drag and drop files here</span>
    <span class="drop-over">Drop files here!</span>
</p>

<ul id="file-list">
    <li class="no-items">(no files uploaded yet)</li>
</ul> 
```

B. 还有一些 javascript：

```
(function () {
    var filesUpload = document.getElementById("files-upload"),
        dropArea = document.getElementById("drop-area"),
        fileList = document.getElementById("file-list");

    function uploadFile (file) {
[etc] 
```

我认识代码，但我不明白以 (function () 开头的部分代码应该进入我的代码的位置。

所以我的问题是：javascript 部分应该如何放在我的代码中。

[编辑]

感谢您的补充回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:06:39.340

`<script></script>`只需在上传表单后将javascript 放入标签中即可。

您链接到的帖子有它描述的代码的完整工作演示，可以在这里找到： [http ://robertnyman.com/html5/fileapi-upload/fileapi-upload.html](http://robertnyman.com/html5/fileapi-upload/fileapi-upload.html)

试验这种代码片段的一个好方法是将所需的部分粘贴到像[JSFiddle这样的工具中](http://jsfiddle.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:07:57.180

Javascript 被放置在`onClick`,`onMouseOver`等属性以及`<script type="text/javascript">`标签内。

它们可以位于`<head>`or`<body>`标记内的任何位置（将其放在您正在访问的元素之后，以便它们加载）。

[w3 Schools](http://w3schools.com/js/default.asp)有一个 Javascript 参考可以帮助您入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:09:37.220

*   创建一个扩展名为 .js 的文件，以便为 yourFile.js。

*   将您的 java 脚本代码放入其中...

*   在 HTML 文件的末尾放置以下内容：

`<script src="yourFile.js"></script>`

*   确保您的 js 与您的 html 位于同一目录中...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T15:09:58.233

就在标签之前，在这样的`</body>`标签之间`<script type="text/javascript"></script>`：

```
<body>

    <!-- other stuff -->

    <script type="text/javascript">
    (function () {
        // this is your function's core
    })();
    </script>

</body> 
```

或者在`<head></head>`标签内，也在 a 之间`<script type="text/javascript"></script>`，但你必须（可能）等到 DOM 正确加载。例如，使用 jQuery：

```
<head>

    <!-- other stuff -->

    <script type="text/javascript">
    $(function() {
        (function () {
            // this is your function's core
        })();
    });
    </script>

</head> 
```

或者甚至在外部 JavaScript 文件中，您也必须（可能）等待 DOM 正确加载。例如，再次使用 jQuery：

文件*myScripts.js*

```
$(function() {
    (function () {
        // this is your function's core
    })();
}); 
```

文件*myDocument.html*

```
<head>

    <!-- other stuff -->

    <script type="text/javascript" src="/path/to/myScripts.js"></script>

</head> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:10:13.413

由于代码包含`getElementById`但没有类似`window.onload`或任何其他延迟策略，因此必须将其放置在您希望它影响的表单之后。为了安全起见，您可以将它放在`<script>`紧挨着的标签中`</body>`。

# java - 如何获取 Java7 应用程序的 CPU、RAM 和网络使用情况

> ID：10999392
> 
> 赞同：8
> 
> 时间：2012-06-12T15:03:38.107
> 
> 标签：java, networking, cpu, java-7, ram

我找到了这篇较早的文章[how-to-monitor-the-computers-cpu-memory-and-disk-usage-in-java](https://stackoverflow.com/questions/47177/how-to-monitor-the-computers-cpu-memory-and-disk-usage-in-java) 并想问一下，java 7 中是否有新的东西。我想获得当前的 CPU- ，RAM-和网络-定期使用我的应用程序。它必须适用于 linux (mac) 和 windows。数据不能太详细，3个值就够了（cpu: 10%, Ram 4%, Network 40%）。如果数据仅用于应用程序而不是整个操作系统，那会很酷，但这也可以。

感谢帮助

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-15T22:12:41.240

回答我自己的问题；P 我写的一些代码......

网络数据：

```
public class NetworkData {

    static Map<String, Long> rxCurrentMap = new HashMap<String, Long>();
    static Map<String, List<Long>> rxChangeMap = new HashMap<String, List<Long>>();
    static Map<String, Long> txCurrentMap = new HashMap<String, Long>();
    static Map<String, List<Long>> txChangeMap = new HashMap<String, List<Long>>();
    private static Sigar sigar;

    /**
     * @throws InterruptedException
     * @throws SigarException
     * 
     */
    public NetworkData(Sigar s) throws SigarException, InterruptedException {
        sigar = s;
        getMetric();
        System.out.println(networkInfo());
        Thread.sleep(1000);     
    }

    public static void main(String[] args) throws SigarException,
            InterruptedException {
        new NetworkData(new Sigar());
        NetworkData.startMetricTest();
    }

    public static String networkInfo() throws SigarException {
        String info = sigar.getNetInfo().toString();
        info += "\n"+ sigar.getNetInterfaceConfig().toString();
        return info;
    }

    public static String getDefaultGateway() throws SigarException {
        return sigar.getNetInfo().getDefaultGateway();
    }

    public static void startMetricTest() throws SigarException, InterruptedException {
        while (true) {
            Long[] m = getMetric();
            long totalrx = m[0];
            long totaltx = m[1];
            System.out.print("totalrx(download): ");
            System.out.println("\t" + Sigar.formatSize(totalrx));
            System.out.print("totaltx(upload): ");
            System.out.println("\t" + Sigar.formatSize(totaltx));
            System.out.println("-----------------------------------");
            Thread.sleep(1000);
        }

    }

    public static Long[] getMetric() throws SigarException {
        for (String ni : sigar.getNetInterfaceList()) {
            // System.out.println(ni);
            NetInterfaceStat netStat = sigar.getNetInterfaceStat(ni);
            NetInterfaceConfig ifConfig = sigar.getNetInterfaceConfig(ni);
            String hwaddr = null;
            if (!NetFlags.NULL_HWADDR.equals(ifConfig.getHwaddr())) {
                hwaddr = ifConfig.getHwaddr();
            }
            if (hwaddr != null) {
                long rxCurrenttmp = netStat.getRxBytes();
                saveChange(rxCurrentMap, rxChangeMap, hwaddr, rxCurrenttmp, ni);
                long txCurrenttmp = netStat.getTxBytes();
                saveChange(txCurrentMap, txChangeMap, hwaddr, txCurrenttmp, ni);
            }
        }
        long totalrxDown = getMetricData(rxChangeMap);
        long totaltxUp = getMetricData(txChangeMap);
        for (List<Long> l : rxChangeMap.values())
            l.clear();
        for (List<Long> l : txChangeMap.values())
            l.clear();
        return new Long[] { totalrxDown, totaltxUp };
    }

    private static long getMetricData(Map<String, List<Long>> rxChangeMap) {
        long total = 0;
        for (Entry<String, List<Long>> entry : rxChangeMap.entrySet()) {
            int average = 0;
            for (Long l : entry.getValue()) {
                average += l;
            }
            total += average / entry.getValue().size();
        }
        return total;
    }

    private static void saveChange(Map<String, Long> currentMap,
            Map<String, List<Long>> changeMap, String hwaddr, long current,
            String ni) {
        Long oldCurrent = currentMap.get(ni);
        if (oldCurrent != null) {
            List<Long> list = changeMap.get(hwaddr);
            if (list == null) {
                list = new LinkedList<Long>();
                changeMap.put(hwaddr, list);
            }
            list.add((current - oldCurrent));
        }
        currentMap.put(ni, current);
    }

} 
```

CPU 数据：

```
public class CpuData {
    private static Sigar sigar;

    public CpuData(Sigar s) throws SigarException {
        sigar = s;
        System.out.println(cpuInfo());
    }

    public static void main(String[] args) throws InterruptedException, SigarException {
        new CpuData(new Sigar());
        CpuData.startMetricTest();
    }

    private static void startMetricTest() throws InterruptedException, SigarException {
        new Thread() {
            public void run() {
                while(true) 
                BigInteger.probablePrime(MAX_PRIORITY, new Random());
            };
        }.start();
        while(true) {
            String pid = ""+sigar.getPid();
            System.out.print(getMetric(pid));
            for(Double d:getMetric()){
                System.out.print("\t"+d);
            }
            System.out.println();
            Thread.sleep(1000);
        }       
    }

    public String cpuInfo() throws SigarException {
        CpuInfo[] infos = sigar.getCpuInfoList();
        CpuInfo info = infos[0];

        String infoString = info.toString();
        if ((info.getTotalCores() != info.getTotalSockets())
                || (info.getCoresPerSocket() > info.getTotalCores())) {
            infoString+=" Physical CPUs: " + info.getTotalSockets();
            infoString+=" Cores per CPU: " + info.getCoresPerSocket();
        }

        long cacheSize = info.getCacheSize();
        if (cacheSize != Sigar.FIELD_NOTIMPL) {
            infoString+="Cache size...." + cacheSize;
        }
        return infoString;
    }

    public static Double[] getMetric() throws SigarException {
        CpuPerc cpu = sigar.getCpuPerc();
        double system = cpu.getSys();
        double user = cpu.getUser();
        double idle = cpu.getIdle();
//      System.out.println("idle: " +CpuPerc.format(idle) +", system: "+CpuPerc.format(system)+ ", user: "+CpuPerc.format(user));
        return new Double[] {system, user, idle};
    }

    public static double getMetric(String pid) throws SigarException {
        ProcCpu cpu = sigar.getProcCpu(pid);
//      System.out.println(sigar.getProcFd(pid));
//      System.err.println(cpu.toString());
        return cpu.getPercent();
    }

} 
```

RAM-数据：

```
public class RamData {

    private static Sigar sigar;
    private static Map<String, Long> pageFoults;

    public RamData(Sigar s) throws SigarException {
        sigar = s;
        System.out.println(getMetric().toString());
    }

    public static void main(String[] args) throws SigarException,
            InterruptedException {
        new RamData(new Sigar());
        RamData.startMetricTest();
    }

    public static void startMetricTest() throws SigarException,
            InterruptedException {
        while (true) {
            Map<String, String> map = RamData.getMetric("" + sigar.getPid());
            System.out.println("Resident: \t\t"
                    + Sigar.formatSize(Long.valueOf(map.get("Resident"))));
            System.out.println("PageFaults: \t\t" + map.get("PageFaults"));
            System.out.println("PageFaultsTotal:\t" + map.get("PageFaultsTotal"));
            System.out.println("Size:    \t\t"
                    + Sigar.formatSize(Long.valueOf(map.get("Size"))));
            Map<String, String> map2 = getMetric();
            for (Entry<String, String> e : map2.entrySet()) {
                String s;
                try {
                    s = Sigar.formatSize(Long.valueOf(e.getValue()));
                } catch (NumberFormatException ex) {
                    s = ((int) (double) Double.valueOf(e.getValue())) + "%";
                }
                System.out.print("  " + e.getKey() + ": " + s);
            }
            System.out.println("\n------------------");
            Thread.sleep(1000);
        }
    }

    public static Map<String, String> getMetric() throws SigarException {
        Mem mem = sigar.getMem();
        return (Map<String, String>) mem.toMap();
    }

    public static Map<String, String> getMetric(String pid)
            throws SigarException {
        if (pageFoults == null)
            pageFoults = new HashMap<String, Long>();
        ProcMem state = sigar.getProcMem(pid);
        Map<String, String> map = new TreeMap<String, String>(state.toMap());
        if (!pageFoults.containsKey(pid))
            pageFoults.put(pid, state.getPageFaults());
        map.put("PageFaults", ""
                + (state.getPageFaults() - pageFoults.get(pid)));
        map.put("PageFaultsTotal", ""+state.getPageFaults());
        return map;
    }
} 
```

过程数据：

```
public class ProcessData {

    private static Sigar sigar;

    public ProcessData(Sigar s) throws SigarException {
        this.sigar = s;
        System.out.println(getMetric().toString());
        System.out.println(getMetric(getPidString()).toString());
    }

    public static void main(String[] args) throws SigarException {
        new ProcessData(new Sigar());
        System.out.println(ProcessData.getMetric());
        System.out.println(ProcessData.getMetric(getPidString()));
    }

    public static Map<String, String> getMetric() throws SigarException {
        ProcStat state = sigar.getProcStat();
        return (Map<String, String>) state.toMap();
    }

    public static Map<String, String> getMetric(String pid) throws SigarException {
        ProcState state = sigar.getProcState(pid);
        return (Map<String, String>) state.toMap();
    }

    public static long getPid() {
        return sigar.getPid();
    }

    public static String getPidString() {
        return ""+sigar.getPid();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:28:33.373

从那以后没有太大变化，除非它是由另一个小组完成的。以下是 Java 7 SE 中包含的一些重要更改。可悲的是，它们都不是您要寻找的。

[http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html](http://www.oracle.com/technetwork/java/javase/jdk7-relnotes-418459.html)

我之前使用过的 javamelody 非常简单，我能够在短时间内运行它 [https://code.google.com/p/javamelody/](https://code.google.com/p/javamelody/)
[http://demo.javamelody.cloudbees.net/monitoring](http://demo.javamelody.cloudbees.net/monitoring)

下面是另一种选择 [https://github.com/oshi/oshi](https://github.com/oshi/oshi)

**OSHI 不会为您提供每个进程的网络使用**
情况或延迟 检查：
[Java (Windows) - 按进程 ID，获取内存使用情况、磁盘使用情况、网络使用情况](https://stackoverflow.com/questions/44474799/java-windows-by-process-id-get-memory-usage-disk-usage-network-usage/63961626#63961626)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-29T04:30:52.373

为什么你不能像下面这样使用，

```
 try {
      for (String ni : sigar.getNetInterfaceList()) {         
        NetInterfaceStat netStat = sigar.getNetInterfaceStat(ni);   
        total+=netStat.getRxBytes();        
      }
    } catch (SigarException e) {
      e.printStackTrace();
    } 
```

有什么**区别**？？？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-21T15:36:57.423

我会使用 Metrics java 库： http: [//metrics.codahale.com/](http://metrics.codahale.com/)

它带有 Sigar 集成：[https ://github.com/cb372/metrics-sigar](https://github.com/cb372/metrics-sigar)

# sql - 如何使用 INSERT 语句的 OUTPUT 子句获取标识值？

> ID：10999396
> 
> 赞同：265
> 
> 时间：2012-06-12T15:03:49.110
> 
> 标签：sql, sql-server-2005, insert

如果我有一个插入语句，例如：

```
INSERT INTO MyTable
(  
  Name,
  Address,
  PhoneNo
)
VALUES
(
  'Yatrix',
   '1234 Address Stuff',
   '1112223333'
) 
```

如何使用 OUTPUT 子句设置`@var INT`新行的标识值（称为）？`Id`例如，我已经看到将 INSERTED.Name 放入表变量的示例，但我无法将其放入非表变量中。

我试过`OUPUT INSERTED.Id AS @var`, `SET @var = INSERTED.Id`，但都没有奏效。

* * *

## 回答 #1

> 赞同：534
> 
> 时间：2012-06-12T15:07:29.303

您可以将新插入的 ID 输出到 SSMS 控制台，如下所示：

```
INSERT INTO MyTable(Name, Address, PhoneNo)
OUTPUT INSERTED.ID
VALUES ('Yatrix', '1234 Address Stuff', '1112223333') 
```

您也可以从例如 C# 中使用它，当您需要将 ID 取回给您的调用应用程序时 - 只需使用`.ExecuteScalar()`(而不是`.ExecuteNonQuery()`) 执行 SQL 查询以读取结果`ID`。

或者如果您需要捕获新插入的`ID`T-SQL 内部（例如用于以后进一步处理），您需要创建一个表变量：

```
DECLARE @OutputTbl TABLE (ID INT)

INSERT INTO MyTable(Name, Address, PhoneNo)
OUTPUT INSERTED.ID INTO @OutputTbl(ID)
VALUES ('Yatrix', '1234 Address Stuff', '1112223333') 
```

这样，您可以将多个值放入`@OutputTbl`并对其进行进一步处理。您还可以在此处使用“常规”临时表 ( `#temp`) 甚至“真实”持久表作为“输出目标”。

# linux - 如何将 write() 优先于 mmap 更新（或延迟 mmap 页面缓存刷新）

> ID：10999397
> 
> 赞同：2
> 
> 时间：2012-06-12T15:03:50.547
> 
> 标签：linux, memory-management, mmap

我在具有 64G RAM 和大量磁盘空间的 debian-64 上运行专门的数据库守护程序。它使用磁盘上的哈希表（已映射）并通过常规 write() 调用将实际数据写入文件。当进行大量更新时，mmap 的很大一部分会变脏，页面缓存会尝试将其刷新到磁盘，从而产生大量随机写入，这反过来会降低对数据文件的常规（顺序）写入的性能.

如果可以延迟 mmaped 区域的页面缓存刷新，性能会提高（我假设），因为对脏页面的多个（或全部）更改将一次写入，而不是每次更新一次（最坏的情况，实际上当然，无论如何它聚合了很多变化）。

所以我的问题是：是否可以延迟内存映射区域的页面缓存刷新？或者是否可以优先考虑常规写入？或者有人有其他想法吗？madvise 和 posix_fadvise 似乎没有任何区别......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:42:52.633

您可以使用`/proc/sys/vm`. 例如，增加值 in`dirty_writeback_centisecs`使 pdflush 唤醒的频率稍低一些，增加值以`dirty_expire_centiseconds`允许数据在必须写出之前保持更长时间，并增加`dirty_background_ratio`以允许更多脏页在必须执行某些操作之前留在 RAM 中。有关所有值的作用的全面描述，
请参见[此处。](http://www.westnet.com/~gsmith/content/linux-pdflush.htm)

请注意，这将影响您机器上的**每个**进程，但是看看您如何运行一个巨大的数据库服务器，这很可能没有问题，因为您不希望任何其他东西在同一台机器上运行。

现在当然这会延迟写入，但它仍然不能完全解决脏页写回竞争的问题`write`（尽管如果有很多更新它可能会崩溃一些写入）。
**但是：**您*可以*使用[`sync_file_range`](http://man7.org/linux/man-pages/man2/arm_sync_file_range.2.html)系统调用来强制开始写出“写入”文件描述符 ( `SYNC_FILE_RANGE_WRITE`) 上给定范围内的页面。因此，虽然脏页将在稍后的某个未知时间（并且具有更长的宽限期）被写回，但您手动启动对您感兴趣的页面的写回。
这并不能提供任何保证，但它*应该*可以正常工作。

一定要绝对积极地阅读文档，最好阅读两遍。`sync_file_range`如果使用不当，很容易损坏或丢失数据。特别是，您必须确保元数据是最新的并在附加到文件时刷新，否则“成功写入”的数据将在崩溃的情况下“消失”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:21:54.850

我会尝试[mlock](http://linux.die.net/man/2/mlockall)。如果你`mlock`有相关的内存范围，它可能会阻止刷新的发生。完成后你可以`munlock`。

# php - 我可以从 mysql 表中提取 html 而不是纯文本吗？

> ID：10999398
> 
> 赞同：0
> 
> 时间：2012-06-12T15:03:58.517
> 
> 标签：php, mysql, html, text-extraction

我正在使用此代码从数据库中提取文本，它运行良好，但去除了所有 HTML 标记。

```
$this->data['getshorty'] = utf8_substr(strip_tags(html_entity_decode($product_info['description'], ENT_QUOTES, 'UTF-8')), 0, 640); 
```

我宁愿能够提取包含 html 标记的字符串，然后选择在第一个或第二个段落中断处停止，而不是计算 640 个字符。这是可行的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:05:44.290

该函数`strip_tags()`删除所有 HTML。从行中删除此功能，它应该没问题。

```
$this->data['getshorty'] = utf8_substr(html_entity_decode($product_info['description'], ENT_QUOTES, 'UTF-8'), 0, 640); 
```

# google-chrome-extension - 页面加载后更改 chrome 中的 URL

> ID：10999399
> 
> 赞同：0
> 
> 时间：2012-06-12T15:04:08.267
> 
> 标签：google-chrome-extension

我编写了以下脚本来更改 Chrome 中选项卡的 URL，但无法弄清楚如何让它在每个页面上自动运行。

```
 var nytimes = /.*nytimes\.com.*/;
  var patt = /(&gwh=).*$/;

  function updateUrl(tab){
   if(tab.url.match(nytimes))
   {
    var newUrl = tab.url.replace(patt,"");
    chrome.tabs.update(tab.id, {url: newurl});
   }
  }
 chrome.tabs.onUpdated.addListener(function(tab) {updateUrl(tab);}); 
```

我把它放到我的背景页面，但它不起作用。我是否需要将代码放在其他地方才能运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T08:07:59.497

我强烈建议您阅读[内容脚本](http://code.google.com/chrome/extensions/content_scripts.html)。它们正是您正在寻找的，但您需要了解它们对 Chrome.* API 的访问权限有限，因此您必须使用[消息传递](http://code.google.com/chrome/extensions/messaging.html)才能使用您当前的功能。但是，通过使用内容脚本，您可能可以使用我提出的解决方案之一来简化此操作。

## 解决方案 1

假设您希望每次都将重定向发送到相同的 URL，您可以轻松地将扩展配置为仅在 NY Times 站点上运行您的内容脚本。例如;

### 内容脚本：`content.js`

```
location = 'http://example.com'; 
```

## 解决方案 2

但是，如果重定向 URL 可以变化，您可能希望将该逻辑抽象到您的[背景页面](http://code.google.com/chrome/extensions/background_pages.html)中。例如;

### 内容脚本：`content.js`

```
// Or you can pass a more specific section of the URL (e.g. `location.pathname`)
chrome.extension.sendRequest({href: location.href}, function(data) {
  location = data.url;
}); 
```

### 背景页面：`background.js`

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
  sendResponse({
    url: getUrl(request.href) // TODO: `getUrl` method containing your logic...
  });
}); 
```

## 重要的！

无论您采用哪种方法，您还需要请求许可才能在[清单文件](http://code.google.com/chrome/extensions/manifest.html)中的目标站点上运行内容脚本。

### 显现：`manifest.json`

```
{
  ...
  "content_scripts": [
    {
      "js": ["content.js"],
      "matches": ["*://*.nytimes.com/*"],
      "run_at": "document_start"
    }
  ],
  ...
} 
```

# maven - maven 发布：准备 IOException

> ID：10999403
> 
> 赞同：1
> 
> 时间：2012-06-12T15:04:28.733
> 
> 标签：maven, ioexception, maven-release-plugin, prepare

我正在尝试让 maven 的发布插件与 Perforce 一起使用。当我运行时：

```
mvn release:prepare -Dusername=PerforceUser -Dpassword=PerforcePassword 
```

我得到这个输出（删除了一些 IP/用户名/密码）：

```
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:                                                                                         [INFO]
[INFO] root-project
[INFO] project1
[INFO] project2
[INFO] project3
[INFO] project4
[INFO] project5
[INFO] project6
[INFO] project7
[INFO] project8
[INFO] project9
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building root-project 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-release-plugin:2.3.1:prepare (default-cli) @ root-project ---
[INFO] Verifying that there are no local modifications...
[INFO]   ignoring changes on: **\release.properties, **\pom.xml.next, **\pom.xml.releaseBackup, **\pom.xml.backup, **\pom.xml.bran
ch, **\pom.xml.tag
[ERROR] Path 'D:\Server\pom.xml' is not under client's root '/cygdrive/d/Server'.
[INFO] Checking dependencies and plugins for snapshots ...
What is the release version for "root-project"? (com.company:root-project) 1.0: :
What is SCM release tag or label for "root-project"? (com.company:root-project) root-project-1.0: :
What is the new development version for "root-project"? (com.company:root-project) 1.1-SNAPSHOT: :
[INFO] Transforming 'root-project'...
[INFO]   Updating project8 to 1.0
[INFO]   Updating project4 to 1.0
[INFO]   Updating project1 to 1.0
[INFO]   Updating project3 to 1.0
[INFO]   Updating project6 to 1.0
[INFO]   Updating project7 to 1.0
[INFO]   Updating project9 to 1.0
[INFO]   Updating project5 to 1.0
java.io.IOException: The filename, directory name, or volume label syntax is incorrect
    at java.io.WinNTFileSystem.canonicalize0(Native Method)
    at java.io.Win32FileSystem.canonicalize(Win32FileSystem.java:396)
    at java.io.File.getCanonicalPath(File.java:559)
    at org.apache.maven.scm.provider.perforce.command.edit.PerforceEditCommand.createCommandLine(PerforceEditCommand.java:109)
    at org.apache.maven.scm.provider.perforce.command.edit.PerforceEditCommand.executeEditCommand(PerforceEditCommand.java:51)
    at org.apache.maven.scm.command.edit.AbstractEditCommand.executeCommand(AbstractEditCommand.java:40)
    at org.apache.maven.scm.command.AbstractCommand.execute(AbstractCommand.java:59)
    at org.apache.maven.scm.provider.perforce.PerforceScmProvider.edit(PerforceScmProvider.java:210)
    at org.apache.maven.scm.provider.AbstractScmProvider.edit(AbstractScmProvider.java:560)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.writePom(AbstractRewritePomsPhase.java:631)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.transformProject(AbstractRewritePomsPhase.java:231)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.transform(AbstractRewritePomsPhase.java:125)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.execute(AbstractRewritePomsPhase.java:110)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:234)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:169)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:146)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:107)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.prepareRelease(PrepareReleaseMojo.java:291)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.execute(PrepareReleaseMojo.java:247)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)                            at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[ERROR] CommandLineException Exit code: 1 - Usage: add/edit/delete [-c changelist#] [ -d -f -k -n -v ] [-t type] files...
Missing/wrong number of arguments.

Command line was:p4 -d D:\Server -p *The-IP-of-Perforce* -u *PerforceUser* -P *PerforcePassword* edit
org.codehaus.plexus.util.cli.CommandLineException: Exit code: 1 - Usage: add/edit/delete [-c changelist#] [ -d -f -k -n -v ] [-t type] files...
Missing/wrong number of arguments.

Command line was:p4 -d D:\Server -p *The-IP-of-Perforce* -u *PerforceUser* -P *PerforcePassword* edit
    at org.apache.maven.scm.provider.perforce.command.edit.PerforceEditCommand.executeEditCommand(PerforceEditCommand.java:71)
    at org.apache.maven.scm.command.edit.AbstractEditCommand.executeCommand(AbstractEditCommand.java:40)
    at org.apache.maven.scm.command.AbstractCommand.execute(AbstractCommand.java:59)
    at org.apache.maven.scm.provider.perforce.PerforceScmProvider.edit(PerforceScmProvider.java:210)
    at org.apache.maven.scm.provider.AbstractScmProvider.edit(AbstractScmProvider.java:560)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.writePom(AbstractRewritePomsPhase.java:631)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.transformProject(AbstractRewritePomsPhase.java:231)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.transform(AbstractRewritePomsPhase.java:125)
    at org.apache.maven.shared.release.phase.AbstractRewritePomsPhase.execute(AbstractRewritePomsPhase.java:110)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:234)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:169)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:146)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:107)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.prepareRelease(PrepareReleaseMojo.java:291)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.execute(PrepareReleaseMojo.java:247)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO]
[INFO] root-project ........................................ FAILURE [22.348s]
[INFO] project1 ............................................ SKIPPED
[INFO] project2 ............................................ SKIPPED
[INFO] project3 ............................................ SKIPPED
[INFO] project4 ............................................ SKIPPED
[INFO] project5 ............................................ SKIPPED
[INFO] project6 ............................................ SKIPPED
[INFO] project7 ............................................ SKIPPED
[INFO] project8 ............................................ SKIPPED
[INFO] project9 ............................................ SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 22.967s
[INFO] Finished at: Tue Jun 12 15:41:53 BST 2012
[INFO] Final Memory: 8M/154M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-release-plugin:2.3.1:prepare (default-cli) on project root-project: Error writing POM: D:\Server\pom.xml (Access is denied) -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

当我在 cygwin 中运行它以及在普通的本机 Windows 命令提示符下运行它时，都会发生这种情况。

在我进行设置之前，我确信它至少可以将版本写入 pom 一次，但现在它没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T09:27:40.643

查看 perforce 源代码的[maven scm 提供程序，](http://maven.apache.org/scm/maven-scm-providers/maven-scm-provider-perforce/xref/org/apache/maven/scm/provider/perforce/command/edit/PerforceEditCommand.html)我可以看到在第 93 行它创建了基本的 p4 命令行

```
Commandline command = PerforceScmProvider.createP4Command( repo, workingDirectory ); 
```

然后在第 95 行它添加了编辑

```
command.createArg().setValue( "edit" ); 
```

然后*在*try-catch 中添加文件。但是第 109 行

字符串 canfile = file.getCanonicalPath();

正在抛出上面看到的 IOException 导致打印堆栈跟踪，这就是为什么没有添加文件并且 p4 命令的执行失败（这反过来导致“访问被拒绝”，因为它无法签出文件（因此是只读的）。

编辑：

它抛出 IOException 的原因是它在第 103 行创建文件时：

```
File file = new File( workingDirectory, fs.get( i ).getPath() ); 
```

返回一个绝对路径，所以`fs.get( i ).getPath()`文件最终看起来像

```
D:\Server\D:\Server\pom.xml (in my case) 
```

这显然是坏的。

我已将该行（以及本地[PerforceCheckInCommand.java中的类似行更改为：](http://maven.apache.org/scm/maven-scm-providers/maven-scm-provider-perforce/xref/org/apache/maven/scm/provider/perforce/command/checkin/PerforceCheckInCommand.html)

```
File file = null;
if(fs.get( i ).isAbsolute()) file = new File( fs.get( i ).getPath() );
else file = new File( workingDirectory, fs.get( i ).getPath() ); 
```

并重新安装了插件，现在一切正常。所以问题是插件中的一个错误导致我的特定设置失败。我已经提交了一份错误报告，所以希望没有其他人会遇到这种情况，但如果他们这样做，请下载插件 src，进行这两项更改并重新安装它（mvn install），它应该可以工作。

# mysql - Rails find_by 与 OR

> ID：10999405
> 
> 赞同：0
> 
> 时间：2012-06-12T15:04:30.950
> 
> 标签：mysql, ruby-on-rails-3, named-scope

我在我的 Rails 应用程序中设置了一个命名范围，用于通过其 ID（直接来自索引视图）或 UUID（来自电子邮件 - 基本上只是为了让用户无法输入任何 ID 和查看记录）

```
scope :by_uuid, lambda { |id| where('id = ? OR uuid = ?', id, id) } 
```

这是在 show 动作中使用的，所以 ID 来自 url，比如

```
services/114

services/74c083c0-8c29-012f-1c87-005056b42f8a 
```

这很好用，直到您获得诸如 74c083c0-8c29-012f-1c87-005056b42f8a 之类的 UUID 不幸的是，rails 转换为 int 值，我们得到 services/74 以及具有正确 UUID 的记录

将 .first 添加到范围将无济于事，因为每条记录的顺序可能不同，因此不起作用。

有没有办法防止 rails 像这样转换 ID 并按字面意思获取字符串？显然，不会有一个 ID 与之匹配的记录，但如果它与传递给它的字符串的整数值不相上下，我们可以取回任何东西。

使用动态查找器，例如

```
Service.find_by_uuid 
```

或者

```
Service.find_by_id 
```

按预期工作，但是我们需要能够以相同的方法（显示）使用 UUID 或 ID 检索记录。

有没有办法做类似的事情

```
Service.find_by_id_or_uuid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T13:34:33.470

我们通过对范围进行以下更改来解决此问题：

```
scope :by_uuid, lambda { |id| where('binary id = ? OR uuid = ?', id, id) } 
```

这确保了 id 字符串由其二进制值获取，而不是被转换为 int。但是，这**仅适用于基于 MYSQL的应用程序**

# php - 访问已删除用户的信息

> ID：10999407
> 
> 赞同：1
> 
> 时间：2012-06-12T15:04:33.823
> 
> 标签：php, database, logging

我想跟踪用户的信息，即使他们已从数据库中删除。

我想这样做有两个原因。首先，删除用户后，我想显示一条消息“$name 已成功删除”。其次，我想将已删除用户的名称写入日志文件。

我现在所拥有的不起作用，因为当从数据库中删除用户时，名称变为 NULL（我正在使用 $_SESSION 变量）。有没有办法访问这些信息？最聪明的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:07:06.580

您将一个额外的字段放入数据库中以表示该记录已“删除”，并在您尝试使用这些记录的任何地方进行适当的过滤，以便不会显示任何“deleted=true”记录，例如在登录时：

```
SELECT ...
FROM users
WHERE (username = '...') AND (password = '...') AND (deleted = FALSE) 
```

这样您就可以将整个用户记录保留在数据库中，但它不可用，因为它已被标记为已删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:07:21.293

最聪明的答案是不要删除用户。

在数据库中有一列标记用户已被删除，然后将其视为其余查询中不存在该记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:07:33.810

如果您想保留用户的“故事”并通过用户名或 id 访问它，为什么不在用户被删除时添加一个“活动”列，即“假”？

显然，当您创建用户时，该值将为“True”，并且与通用用户相关的每个操作（但如果您很聪明，我们只说登录）必须考虑该列值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T15:17:21.203

如果你只是想在删除确认页面上显示他们的名字，你可以简单地将名字作为 GET 参数传递：

```
$name = user_get_name($user_id);
user_delete($user_id);

header('Location: deleted.php?user=' . urlencode($name)); 
```

然后，在您的`deleted.php`中，执行以下操作：

```
echo 'User &quot;' . htmlspecialchars($_GET['user']) . '&quot; has been deleted.'; 
```

仅供参考，`htmlspecialchars`电话可以让您免受 XSS 攻击。

**更新：**确保您`session_start()`在第二个脚本中调用，并且在删除用户或将其注销时未取消设置会话变量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T15:07:31.363

绝对最好的方法是永远不要删除任何数据。

您只需在标记为“is_active”（默认值为 true）或“is_deleted”（默认值为 false）的表中添加一个位标志，以指示是否可以访问一条数据。

如果有人想删除那条信息，您可以交换标志值 - 您还确保在对该表执行的任何查询中使用该标志以仅查找活动数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T15:08:08.757

喜欢：

```
$username = $user->get_name(); // OR Copy the object and use the copy for logging and messages
......

$user->delete();

$log->write_log('...... $username....'); 
```

PS。请记住，在某些国家/地区删除配置文件后存储用户数据是违法的！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-12T15:08:11.100

在删除用户之前，您总是可以写入日志文件并显示消息？这样，您仍然可以在需要时访问他们的所有信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-12T15:37:50.500

在这里。我最终使用了会话变量（现在有效，这是我的愚蠢错误）。我认为这是最简单的方法，因为我只想要被删除的用户名。同时，也消除了是否将已删除用户信息保留在数据库中的窘境

# php - 使用 PHP 的 Facebook 应用程序上的 Facebook 登录/注销按钮

> ID：10999415
> 
> 赞同：-1
> 
> 时间：2012-06-12T15:04:57.003
> 
> 标签：php, facebook, facebook-graph-api

我在我的网站上创建了一个应用程序，该应用程序使用 facebook 使用 PHP 将照片发布到我的 facebook 相册。

我想通过执行以下操作来进一步增强它：

1.  为了使用该应用程序 - 我想要登录/注销（我认为可以这样做，但我不知道如何）

2.  为了让访问者使用该应用程序，他们必须在我的页面上按“赞”才能使用该应用程序。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:08:05.583

这是 PHP SDK 的链接：[https ://github.com/facebook/php-sdk](https://github.com/facebook/php-sdk)

这是最基本示例的链接：[https ://github.com/facebook/php-sdk/blob/master/examples/example.php](https://github.com/facebook/php-sdk/blob/master/examples/example.php)

这是 facebook SDK 文档的链接：http: [//developers.facebook.com/docs/reference/php/](http://developers.facebook.com/docs/reference/php/)

您可以使用最基本的示例 - 它执行登录和注销并升级它以满足您的需求。简而言之：它有一个登录和注销 URL，数据存储在会话中。您只需要使用打开的图表来检查用户是否喜欢您的页面。

# javascript - HTML 可变 div 高度与静态宽度大量 div

> ID：10999416
> 
> 赞同：-1
> 
> 时间：2012-06-12T15:04:57.363
> 
> 标签：javascript, html, css

我想每个人都知道这个网站[http://pinterest.com/](http://pinterest.com/)，我不想创建这样的网站，但我还有另一个目的，我想在 div 下创建具有静态宽度和高度始终可变值的 div。

我在这里制作了 HTML 代码：http: [//jsbin.com/ihekiv](http://jsbin.com/ihekiv)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<style type="text/css">
    div{
        margin: 5px;
    }
    .width-200{
        width: 200px;
    background-color: #FCF;
    }
    .float-left{
        float: left;
    }
</style>

</head>

<body>

    <div class="width-200 float-left color-01" style="height: 300px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

    <div class="width-200 float-left color-01" style="height: 250px;">
    </div>

</body>
</html> 
```

在我的 HTML 代码中，您可以清楚地看到 div 5 不在 div 1 下，我如何才能将 div 5 放在 div 1 下。可能是这个 div 会改变它的高度 可能是一些 div 会改变它的高度现在我想知道当 div 的高度变得可变时我该怎么做。谁能告诉我如何做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:10:20.107

CSS[无法做到这一点](https://stackoverflow.com/questions/6003171/css-two-columns-with-known-children-width/6003261#6003261)，因为您有可变数量的列。

相反，使用 jQuery Masonry： http: [//masonry.desandro.com/](http://masonry.desandro.com/)

还有一个无框架版本，Vanilla Masonry：http: [//vanilla-masonry.desandro.com/](http://vanilla-masonry.desandro.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T17:59:58.307

我唯一能做的就是

```
body {
-webkit-column-count: 5;
-webkit-column-gap: 0px;
-webkit-column-width: 200px;
} 
```

这不是一个好的解决方案，仅支持 webtkit。

# eclipse - Eclipse 和 Pydev 插件

> ID：10999418
> 
> 赞同：0
> 
> 时间：2012-06-12T15:05:04.980
> 
> 标签：eclipse, pydev

在 Eclipse 上安装和配置 PyDev 插件后，它工作正常。但是当我关闭 Eclipse IDE 并再次打开它并想要运行 python 程序时，我不能，因为没有 Python Run。

我该怎么办，有没有人遇到过这种类型的错误？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:27:34.497

我发现了问题，我不知道为什么，但是 eclipse 总是更改默认工作区，这会产生问题。当我将工作区设置回所需位置时，错误消失了，我能够编译并运行 python 程序。

# windows-phone-7 - 如何在 Windows Phone 的全景页面下包含画布？

> ID：10999422
> 
> 赞同：0
> 
> 时间：2012-06-12T15:05:21.387
> 
> 标签：windows-phone-7, expression-blend, blend

我有一个包含两个全景项目的全景页面，并希望在第二个全景项目中包含一个画布。因此，当我这样做时，我的画布中的第一个全景项目溢出。因为它应该被制作成大约需要一页半。所以它应该像 2 个半全景页面，其中包含两个项目，一个全景项目和一个画布项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:35:38.593

也许在您的第二个全景项目中的网格下放置另一个画布？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:35:50.570

确保所有边距值为零。有时，Expression Blend 会为子控件添加边距以适应全景控件的 ItemTemplate。请记住，画布不像其他组件那样工作，它的内容被映射到像素。

此外，如果您希望将项目设置为 1.5 页面宽度，请考虑将全景项目的方向更改为水平。

# android - Android 中的 Z 分层片段

> ID：10999423
> 
> 赞同：4
> 
> 时间：2012-06-12T15:05:22.873
> 
> 标签：android, android-fragments

可以将碎片“堆叠”在一起吗？

只是试图在没有真正考虑的情况下做到这一点，一切都变得有点疯狂。如果不可能，我可以（并且可能应该）创建一个 ViewGroup，但我只是想知道。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T15:19:25.267

是的，这是可能的。例如，通过将它们包装在`FrameLayout`这样的内部：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <fragment android:name="com.package.FragmentOne"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            />

    <fragment android:name="com.package.FragmentTwo"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            />

</FrameLayout> 
```

z-index 取决于布局中子项的顺序。在上面的这个例子`FragmentTwo`中，`FragmentOne`因为它是第二个孩子。

# xpages - 如果没有足够的条目隐藏页面

> ID：10999424
> 
> 赞同：0
> 
> 时间：2012-06-12T15:05:24.227
> 
> 标签：xpages

我创建了一个列出一些文档的重复控件。我想要一个页面，仅当条目数超过重复控件中指定的最大条目数时才显示。

是否可以找出重复控件中当前显示了多少条目？或者最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:11:06.440

以下是一些可以提供帮助的 SSJS：

```
var r:com.ibm.xsp.component.UIRepeat = getComponent("repeat1"); 
var count = r.getRowCount() // returns all entries
var pos = r.getFirst(); // returns current position of first entry
var rows = r.getRows(); // get rows of repeat controls

var curPage = pos / rows + 1;
var pagesTotal = ( count - (count % rows)) / rows + 1; 
```

**编辑：**

要计算当前显示条目的数量，您可以执行以下操作：

```
if( curPage == pagesTotal ){
   return (count % rows)
}else{
   return rows;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T11:49:13.247

这会有帮助吗？[http://www.mydominolab.com/2010/10/repeat-control-better-navigation.html](http://www.mydominolab.com/2010/10/repeat-control-better-navigation.html)

我想你可以简单地比较`getRowCount() > getRows()`

# javascript - 检测 Javascript 变量是否真的未定义

> ID：10999434
> 
> 赞同：3
> 
> 时间：2012-06-12T15:05:48.663
> 
> 标签：javascript

我们如何区分`var foo;`和`var foo=undefined;`？

`typeof foo`将返回两个“未定义”，`foo in window`并将返回两个 true；

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T15:08:27.487

`var foo`暗示`var foo=undefined`，除非当然`undefined`设置为`undefined`.

这可以在浏览器控制台中看到，如果您初始化一个变量但不给它一个值，它将具有值`undefined`（和类型`"undefined"`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:19:06.857

一个正确的例子可以创造奇迹：

```
function winFoo() {
  console.log('foo' in window);
}

function startFoo() {
  window.foo = 'bar';
}

function ovrFoo() {
  window.foo = undefined;
}

function removeFoo() {
  delete window.foo;
}

//window.foo === undefined
//window.foo hasn't been defined yet
winFoo(); //false
//so it makes sense that 'foo' is not in window
startFoo(); //window.foo === 'bar'
//window.foo has now been set to 'bar'
winFoo(); //true
//so it makes sense that 'foo' is in window
ovrFoo(); //window.foo === undefined
//window.foo has been overridden with a value of undefined
winFoo(); //true
//but the key 'foo' still exists in window, it just has a value of undefined
removeFoo(); //window.foo === undefined
//the key 'foo' has been removed from window and its value is therefor forgotten
winFoo(); //false
//so it makes sense that 'foo' is not in window 
```

[这是一个小提琴](http://jsfiddle.net/KChna/)

此外，在任何函数上下文之外声明都会使用if值进行`var foo`实例化（这意味着如果您在同一个代码块中多次调用，它不会覆盖现有值（如果有的话））。更重要的是，and语句实际上被提升到其范围的顶部，这意味着：`window.foo``undefined``!('foo' in window)``var foo``var``function`

```
console.log('foo' in window);
var foo;
console.log('foo' in window); 
```

将打印`true`两次而不是`false`后跟`true`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:13:53.770

> 我们如何区分`var foo;`和`var foo=undefined;`？

它们之间没有区别，**如果****这一**行先于`foo`. （不必如此。）JavaScript 引擎会看到这样的行`var foo=undefined;`：

```
// At top of scope
var foo; // `foo` will have the value `undefined`

// Where the var foo=undefined; line was
foo = undefined; 
```

请注意，它们是在不同时间发生的完全不同的事情。声明和“初始化”（实际上是一个赋值）是*分开*发生的。声明发生在进入执行单元时；初始化/分配稍后发生，作为逐步代码执行的一部分。（更多：[*可怜的误解`var`*](http://blog.niftysnippets.org/2008/03/poor-misunderstood-var.html)）

这意味着如果你有这个：

```
foo = 5;
alert(typeof foo); // "number"
var foo = undefined;
alert(typeof foo); // "undefined" 
```

...这不是错误，因为引擎处理的方式是：

```
var foo;
foo = 5;
alert(typeof foo); // "number"
foo = undefined;
alert(typeof foo); // "undefined" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:20:31.677

方式一：

```
if (null === var) 
```

（对于旧浏览器）：

```
if (void 0 != var) 
```

另一个：

```
if(var) 
```

并像这样使用它：

```
var un;
if (un==undefined)
{
alert('Yes');
} else {
alert('No');
} 
```

# ios - 为什么我的 Cordova/PhoneGap iOS 应用程序在设备旋转时不旋转？

> ID：10999435
> 
> 赞同：11
> 
> 时间：2012-06-12T15:05:49.780
> 
> 标签：ios, cordova, screen-orientation

我正在尝试制作一个[仅限风景的应用程序](https://stackoverflow.com/questions/10996676/phonegap-page-has-wrong-rotation-shows-as-portrait-in-landscape-mode)，但我根本无法产生任何旋转。

曾经有一个`autorotate`设置，`PhoneGap.plist`但在 phonegap 1.8.0 我可以找到它。它还存在吗？

我的应用程序没有轮换还有什么问题？

**更新**

我知道有一个网页只包含一个单词“测试”。我将目标设备设置为仅 iPad 并启用了所有四个方向。还有什么可能是错的？

是否需要有特殊的 html 文档类型？我需要包含一些cordova-1.8.0.js吗？我找不到适用于 iOS 的（！？！），所以我用 android 版本对其进行了测试。我读的 API 现在是一样的，所以我可以使用 android .js 文件吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-09-10T00:31:06.430

我尝试了上面的 JavaScript 解决方案，但没有得到任何乐趣在 Visual Studio 2015 中，我将 config.xml 更改为

```
<preference name="orientation" value="all" /> 
```

取自[Cordova 5 build 命令正在删除 iOS 设备方向设置](https://stackoverflow.com/questions/30848768/cordova-5-build-command-is-deleting-ios-device-orientation-settings)

我不需要javascript，只需要配置设置

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-01-28T22:52:51.923

PiTheNumber 的答案对于那些可以修改 Cordova 生成的本机代码的人来说看起来不错。

在Cordova 上的[这个 JIRA 问题](https://issues.apache.org/jira/browse/CB-751)之后，正如[这个博客中所解释的](http://www.williamquast.com/blog/pg-orientation)那样，您还可以使用 plist 值或**在您的 Javascript 代码中**定义一个 window.shouldRotateToOrientation 函数，这非常适合我。

```
window.shouldRotateToOrientation = function(degrees) {
 return true;
} 
```

这将为当前页面启用设备方向（因此，对于您的整个应用程序，如果它是大多数 Cordova 应用程序的“单页应用程序”）。请注意，您还可以根据以度数为单位的旋转值来决定启用它，或者甚至，为什么不，仅在某些视图上启用它，或者让用户在您的 HTML 应用程序中进行选择……很好，不是吗。

为了记录，我不需要做任何事情来获得 iOS 8 iPad 手柄旋转，而 iOS 6 和 iOS 7 iPhone 在当前的 Cordova 版本（4.2.0，cordova ios 平台版本）中默认不会处理它“iOS 3.7.0”）。这是因为可以在 Xcode 上为每个“设备类型”（平板电脑/手机）授予不同的旋转设置。需要注意的是，Cordova会先检查上面的JS函数是否存在，如果该函数不存在或者不允许旋转，就会使用Xcode的旋转设置。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-12T18:43:15.393

作为`Classes/MainViewController.m`回报：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    //return (interfaceOrientation == UIInterfaceOrientationPortrait);
    return true;
} 
```

对于**iOS >= 6**

```
- (BOOL)shouldAutorotate {
    return YES;
}
-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
} 
```

[资源](http://www.mobile.safilsunny.com/shouldautorotatetointerfaceorientation-called-ios-6/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-01-31T20:47:10.610

您可以添加 UISupportedInterfaceOrientations

platroms/ios/{ProjectName}/{ProjectName-info.plist

添加此行：

对于 iPhone：

```
<key>UISupportedInterfaceOrientations</key>
    <array>
      <string>UIInterfaceOrientationPortrait</string>
      <string>UIInterfaceOrientationLandscapeLeft</string>
      <string>UIInterfaceOrientationPortraitUpsideDown</string>
      <string>UIInterfaceOrientationLandscapeRight</string>
    </array> 
```

对于 iPad：

```
<key>UISupportedInterfaceOrientations~ipad</key>
    <array>
      <string>UIInterfaceOrientationPortrait</string>
      <string>UIInterfaceOrientationLandscapeLeft</string>
      <string>UIInterfaceOrientationPortraitUpsideDown</string>
      <string>UIInterfaceOrientationLandscapeRight</string>
    </array> 
```

# excel - MS Access VBA 脚本与 Excel 交互

> ID：10999444
> 
> 赞同：3
> 
> 时间：2012-06-12T15:06:27.410
> 
> 标签：excel, ms-access, vba

我正在尝试在 Microsoft Access 中编写一个 VBA 脚本，该脚本将与 Excel 工作表交互，遍历行，然后遍历行中的单元格，然后将信息拉回 Access 表中。

这是一些 sudo 代码-

```
For Each Row
    For Each Cell in the Row
        Read the Cell
        Create a new Record in the Access table with the info from the cell
    End For Each
End For Each 
```

您可以在下面的图片中看到最终结果的简化示例。

我们有什么-

![在此处输入图像描述](../Images/d84302a67d3b2e191da3f9499b420c93.png)

需要什么——

![在此处输入图像描述](../Images/cde8105a52cb1b6e40ed42399f37dc06.png)

我以前编码过，但从未在 VBA 中编码过；所以任何帮助将不胜感激！谢谢你的帮助！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:09:42.150

我建议您使用各种向导或 DoCmd 的 TransferSpreadsheet 方法链接 Excel 表，并使用链接的 Excel 表简单地运行操作查询。

联合查询是必需的。让我们称您的链接电子表格为 t。

```
SELECT * INTO Table1
FROM (
    SELECT [Seq#], "Name" As [Field Name], [Name] As [Field Value]
    FROM t
    UNION ALL
    SELECT [Seq#], "Location" As [Field Name], [Location] As [Field Value]
    FROM t
    UNION ALL
    SELECT [Seq#], "Car" As [Field Name], [Car] As [Field Value]
    FROM t ) imp

INSERT INTO Table1
SELECT * FROM (
    SELECT [Seq#], "Name" As [Field Name], [Name] As [Field Value]
    FROM t
    UNION ALL
    SELECT [Seq#], "Location" As [Field Name], [Location] As [Field Value]
    FROM t
    UNION ALL
    SELECT [Seq#], "Car" As [Field Name], [Car] As [Field Value]
    FROM t ) imp 
```

您可以通过删除字段和列名称中的空格和保留字来使生活更轻松。

通常最好列出要使用星号 (*) 的字段，如上所示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:07:01.513

首先按照@Remou 的建议创建一个指向您的 Excel 工作表的链接。在以下示例中，我将链接命名为“tblExcelData”。然后“tblDestination”将按照您的要求为工作表行的每个“单元格”存储单独的记录。In `tblDestination`,`Seq#`是长整数，并且`Field Name`和`Field Value`都是文本。

```
Public Sub foo20120612a()
    Dim db As DAO.Database
    Dim rsSrc As DAO.Recordset
    Dim rsDest As DAO.Recordset
    Dim fld As DAO.Field

    Set db = CurrentDb
    Set rsSrc = db.OpenRecordset("tblExcelData", dbOpenSnapshot)
    Set rsDest = db.OpenRecordset("tblDestination", _
        dbOpenTable, dbAppendOnly)
    Do While Not rsSrc.EOF
        For Each fld In rsSrc.Fields
            If fld.Name <> "Seq#" Then
                With rsDest
                    .AddNew
                    ![Seq#] = CLng(rsSrc![Seq#])
                    ![Field Name] = fld.Name
                    ![Field Value] = fld.value
                    .Update
                End With
            End If
        Next fld
        rsSrc.MoveNext
    Loop
    rsDest.Close
    Set rsDest = Nothing
    rsSrc.Close
    Set rsSrc = Nothing
    Set db = Nothing
End Sub 
```

# database - 如何以编程方式将数据库字段添加到 VB.NET 中的 Crystal Report

> ID：10999449
> 
> 赞同：1
> 
> 时间：2012-06-12T15:06:34.320
> 
> 标签：database, vb.net, crystal-reports

我希望能够以编程方式在我的水晶报表中添加或删除数据库字段。我熟悉以编程方式处理参数但不熟悉数据库字段，我只能弄清楚如何以编程方式执行您在 Database Expert 中所做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T19:52:22.423

Crystal Reports 不允许在运行时修改报表设计。

# java - jspinner标题边框被切断

> ID：10999453
> 
> 赞同：0
> 
> 时间：2012-06-12T15:06:47.360
> 
> 标签：java, swing, jspinner, titled-border

所以我的问题是，我以前在 Jspinners 上遇到过。是我用带标题的边框包围我的 jspinner。然而，在 gui 中，它削减了标题文本，因为 js 更小。那么如何根据标题的长度强制 gui 重新调整，或者如何让 jspinner 更长，我想提供足够的空间来容纳整个标题？

```
JTextField name= new JTextField(9);
name.setBorder(new TitledBorder("Name"));
//setup spinner date format
SimpleDateFormat datePattern = new SimpleDateFormat("MM/dd/yyyy");
JSpinner dob = new JSpinner(new SpinnerDateModel());
dob.setEditor(new JSpinner.DateEditor(dob, datePattern.toPattern()));
dob.setBorder(new TitledBorder("Date of Birth"));
JPanel childPanel = new JPanel();
childPanel.setLayout(new FlowLayout());
childPanel.add(name);
childPanel.add(dob);
childPanel.setBorder(new TitledBorder("Child Info")); 
```

然后：

```
JPanel mainPanel = new JPanel(); 
mainPanel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));        
mainPanel.add(childPanel);
childPanel.setAlignmentX(Component.LEFT_ALIGNMENT);
//there are more items in this panel, just omitted them, that's why using BoxLayout 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:01:43.410

只需将 JSpinner 添加到 JPanel，并将边框添加到面板：

```
 JPanel dobPanel = new JPanel();
    dobPanel.add(dob);
    dobPanel.setBorder(BorderFactory.createTitledBorder("Date of Birth")); 
```

编辑：还要注意，使用 BorderFactory 比创建 Border 实例更好：

> 只要有可能，该工厂将分发对共享 Border 实例的引用。

[http://docs.oracle.com/javase/7/docs/api/javax/swing/BorderFactory.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/BorderFactory.html)

# git - git pull 从错误的远程分支

> ID：10999454
> 
> 赞同：4
> 
> 时间：2012-06-12T15:06:51.887
> 
> 标签：git, branch, remote-branch

我的起源有一个`fixes`和一个`fixes_v3`分支。我的客户刚刚`fixes`。我做了一个`git pull git+ssh:/.../mygitrepo`，突然在我的客户端上我有了分支`fixes_v3`中的所有代码。`fixes`为什么会发生这种情况？现在我尝试`git pull ... mygitrepo fixes`，它只是告诉我它是最新的。

`git remote show origin`给出了这个：

```
HEAD branch: fixes
Local refs configured for 'git push':
  fixes  pushes to fixes  (fast-forwardable)
  master pushes to master (up to date) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:11:28.670

显然，您的分支机构正在跟踪虚假遥控器。执行 a`git remote show origin`查看哪个分支远程分支`fixes`合并。它可能会说类似

```
fixes merges with remote fixes_v3 
```

在撤消上一次合并后相应地进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-23T09:44:45.480

**快速修复？**

撤消所有本地提交。例如

选择要撤消的分支

```
git branch fixes 
```

删除本地提交

```
git reset --hard origin/fixes 
```

[资源](https://stackoverflow.com/a/5343267/939250)

**主题分支是如何搞砸的？**

就我而言，我在没有命名目的地的情况下进行了拉动：

```
git pull origin cifs_support 
```

由于没有本地`cifs_support`分支，来自的提交`origin/cifs_support`被添加到`master`.

**你安全吗？**

否。使用已接受答案中的建议检查您的配置：用于`git remote show origin`查看哪些分支受`git pull`and影响`git push`。如果分支跟踪错误，请尽快修复。

# php - 在 PHP 中显示多个表行

> ID：10999466
> 
> 赞同：0
> 
> 时间：2012-06-12T15:07:26.757
> 
> 标签：php, mysql

我对 PHP 有点陌生，遇到了一个问题。这是我所拥有的：

```
$select_all = "SELECT * FROM latesttest";

$result = mysql_query($select_all)
    or die(mysql_error());

$row = mysql_fetch_assoc($result);

foreach($row as $k=>$v){
    echo $k . "=" . $v . "<br />";
} 
```

这有效并给了我： V1=Test V2=1234 V3=Something 等。

但我希望以这种方式反映表格中每一行的结果。如果我运行 SELECT * FROM latesttest; 在 MySQL 中，我在这张表中有 4 条记录。如何以上述格式显示所有 4 行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:09:41.400

fetch_assoc() 仅将 SINGLE 结果行作为数组返回，因此您的 for() 循环只是迭代该行中的字段。代码应该是

```
while($row = mysql_fetch_assoc($result)) {
    foreach ($row as $key => $val) {
        echo "$key => $val<br />";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:10:25.117

```
while ($row = mysql_fetch_assoc($result)) {
  foreach($row as $k=>$v){
      echo $k . "=" . $v . "<br />";
  }
} 
```

达达！

# windows - 在 Windows 中确定 CPU 频率

> ID：10999470
> 
> 赞同：1
> 
> 时间：2012-06-12T15:07:33.507
> 
> 标签：windows, cpu, frequency, processor

在 Windows (7) 中找到确定 CPU 频率的可靠方法时我遇到了一些麻烦。

我尝试过使用 Perfmon，但它的最大采样频率为 1 Hz。另外，我没有内核级别的访问权限，所以我不能使用机器特定的寄存器。有许多 C 函数可以确定处理器的最大频率，但 SpeedStep 和 Turbo Boost 使这些方法不可靠，因为我尝试过使用以恒定速率运行的片上定时器，因此不会t 反映可变的处理器频率。

我知道诸如 CPU-Z 之类的程序能够直接测量 CPU 频率，但我不知道它们实际上是如何测量的。*非常*感谢任何帮助！

*编辑：我也一直在研究使用 ACPI 来监控 CPU P-States 的可能性......这是一个选项吗？*

*Edit2：我目前正在研究使用特定于机器的寄存器（[http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-software-developer-vol-3b-part -2-manual.pdf](http://www.intel.com/content/dam/doc/manual/64-ia-32-architectures-software-developer-vol-3b-part-2-manual.pdf) ) 来获取这些信息......我觉得这对于解决方案来说可能有点矫枉过正，但这是我目前获得的最佳线索。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T19:48:45.703

我能够通过分析 aperf 和 mperf 比率的 Windows 驱动程序确定 CPU 频率，如以下链接中所述：[硬件处理器计数器重置错误](https://stackoverflow.com/questions/11398912/hardware-processor-counters-incorrectly-resetting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-25T05:09:23.110

请检查[此](http://www.dima.to/blog/?p=101)链接。

*   在这个链接中，一个简单的 WDM **IOCTL**驱动程序与**应用程序**给出了很好的解释。我能够使用此代码找到频率。频率是使用 MSR（模型特定寄存器）APERF 和 MPERF 值计算的。

# javascript - 当用户单击文档中的任意位置时淡出弹出窗口

> ID：10999480
> 
> 赞同：-2
> 
> 时间：2012-06-12T15:07:58.183
> 
> 标签：javascript, jquery, html

我需要的是当弹出窗口出现并且用户单击文档中除弹出窗口之外的任何位置时，弹出窗口应该淡出。

我已经尝试过使用 target.attr 方法，但在 Mozilla 中失败了。

有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:10:18.470

您可以使用jQuery[淡出](http://api.jquery.com/fadeOut/)方法和[一种](http://api.jquery.com/one/)方法。

就像是 ：

```
jQuery("#yourpoup").click(function(){ return false; });
jQuery(document).one("click", function() { jQuery("#yourpoup").fadeOut(); }); 
```

根据[这个](https://stackoverflow.com/questions/2124684/jquery-how-click-anywhere-outside-of-the-div-the-div-fades-out)问题，使用 this 比使用 bind 更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:13:28.190

还有一个用于点击外部的 JQuery 插件，这将允许您处理除了弹出窗口之外的所有内容的点击。

[http://benalman.com/projects/jquery-outside-events-plugin/](http://benalman.com/projects/jquery-outside-events-plugin/)

```
$("#yourpopup").bind( "clickoutside", function(event){
$(this).fadeOut(500);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:14:36.687

如果您的弹出窗口是一个 JQuery 对话框，您可以看到这个线程：

[jQuery UI - 在外部单击时关闭对话框](https://stackoverflow.com/questions/2554779/jquery-ui-close-dialog-when-clicked-outside/10988431#10988431)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:31:55.820

以 jquery 为例，假设`$popup`是您的弹出元素

```
$('body').click(function(){
    // hide the popup here
});

$popup.click(function(e) {
    // do something here if needed
    e.stopPropagation();
}); 
```

关键是在弹出窗口中单击时，停止将事件冒泡到正文，因此不会触发附加到正文的函数。

# java - 调整保留jpg Exif信息的图像文件大小

> ID：10999483
> 
> 赞同：2
> 
> 时间：2012-06-12T15:08:06.343
> 
> 标签：java, parameters, image-resizing, exif

我想复制带有所有 Exif 图像数据的图像。

我有一个 Java 应用程序，它将 jpg 读入图像对象，调整大小，然后将图像对象写入另一个文件夹中的 jpg 文件。

问题是它丢失了所有漂亮的图像信息（相机、日期等）。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T03:08:46.283

虽然适用于 Android，但此解决方案是 Java 语言，应该有助于将所有 EXIF 元数据从一个文件复制到另一个文件：

[http://bricolsoftconsulting.com/copying-exif-metadata-using-sanselan/](http://bricolsoftconsulting.com/copying-exif-metadata-using-sanselan/)

请注意，Sanselan 最近已更名为 Commons Imaging，可在此处找到：

[http://commons.apache.org/imaging/](http://commons.apache.org/imaging/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-28T23:17:35.097

一种选择是像这样使用图像 IO：

```
try (ImageInputStream inputStream = new FileImageInputStream(new File("Landscape_3.jpg"))) {
        Iterator<ImageReader> readerIterator = ImageIO.getImageReaders(inputStream);
        ImageReader reader = readerIterator.next();
        reader.setInput(inputStream);
        Iterator<IIOImage> imageIterator = reader.readAll(null);
        IIOImage image = imageIterator.next();

        BufferedImage srcImage = (BufferedImage) image.getRenderedImage();
        AffineTransformOp scaleOp = new AffineTransformOp(AffineTransform.getScaleInstance(0.5, 0.5), AffineTransformOp.TYPE_NEAREST_NEIGHBOR);
        BufferedImage resultImage = scaleOp.createCompatibleDestImage(srcImage, null);
        resultImage = scaleOp.filter(srcImage, resultImage);
        image.setRenderedImage(resultImage);

        ImageWriter writer = ImageIO.getImageWriter(reader);
        try (ImageOutputStream outputStream = new FileImageOutputStream(new File("Landscape_3_preserve_exif.jpg"))) {
            writer.setOutput(outputStream);
            writer.write(image);
        }
        try (ImageOutputStream outputStream = new FileImageOutputStream(new File("Landscape_3_discard_exif.jpg"))) {
            writer.setOutput(outputStream);
            writer.write(image.getRenderedImage());
        }
    } 
```

陷阱：

*   它通常作为图像 io 框架很慢
*   对于一些罕见的图像，它莫名其妙地失败了。示例（javax.imageio.IIOException：不是 JPEG 文件：以 0xff 0xe2 开头）
*   它要求对源图像和目标图像使用相同的颜色模型。因此，您不能使用双线性或双三次插值

# ruby - 在irb中，为什么有一个预定义的变量“d”？

> ID：10999484
> 
> 赞同：1
> 
> 时间：2012-06-12T15:08:06.407
> 
> 标签：ruby, irb

由于某种原因，`d`在我输入 irb 后立即定义了一个名为的变量。知道它是什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:17:57.077

你`irbtools`有机会使用吗？如果是，则有一个名为 的预定义方法`d`，大致如下所示：

```
def d
  self.tap { |v| puts v }
end 
```

它可以用来调试这样的消息链：`obj.some_method.d.other_method`.

由于它是在`Object`级别定义的，因此如果您只是在 IRB 顶层调用它，它应该会返回`main`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T15:19:40.883

您可以使用开关运行`irb`以`-f`抑制加载`~/.irbrc`：

```
irb -f 
```

这将很快告诉您是否`d`来自您的某个地方`~/.irbrc`（很可能是 - 请参阅迈克尔的回答）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:10:24.643

不适合我：

```
$ irb
>> d
NameError: undefined local variable or method `d' for main:Object
        from (irb):1 
```

# sql - 如何从 t-sql 中的 xml 变量中获取节点名称和值

> ID：10999488
> 
> 赞同：15
> 
> 时间：2012-06-12T15:08:12.570
> 
> 标签：sql, sql-server, tsql, xpath, sql-server-2008-r2

我有以下 xml -

```
<Surveys xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="ImmForm XML Schema NHS Direct.xsd"><Svy SurveyName="WeeklyFluSurveillance2012/13-NHSDirectWeek40w/e07/10/2012" OrgCode="NHS Direct"><TotCR>222.10</TotCR><PerCF>0.40</PerCF><PerCFunder1>0.20</PerCFunder1><PerCF1to4>0.30</PerCF1to4><PerCF5to14>0.50</PerCF5to14><PerCF15to44>0.40</PerCF15to44><PerCF45to64>0.20</PerCF45to64><PerCF65plus>3.60</PerCF65plus>
<PerCFNE>4.22</PerCFNE>
<PerCFNW>6.50</PerCFNW>
<PerCFYH>0.80</PerCFYH>
<PerCFEM>1.00</PerCFEM>
<PerCFWM>1.50</PerCFWM></Svy></Surveys> 
```

我需要在具有 2 列（FieldName、FieldValue）的结果集中选择子节点名称及其值，例如 -

```
TotCR   222.10
PerCF     0.40
...
PerCFWM   1.50 
```

xml 中的节点会有所不同，并且可能并不总是相同。甚至这些值也可能是整数或文本。

你们能否建议如何在 SQL Server 2008 R2 中使用 OPENXML 来执行此操作？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-12T15:13:20.113

您可以使用该`local-name()`函数来获取 XML 节点的名称 - 尝试如下操作：

```
DECLARE @input XML =  '...your xml here.....'

SELECT
    NodeName = C.value('local-name(.)', 'varchar(50)'),
    NodeValue = C.value('(.)[1]', 'varchar(50)') 
FROM @input.nodes('/Surveys/Svy/*') AS T(C) 
```

这应该会给你一个类似的输出：

![在此处输入图像描述](../Images/c618e6794367a2394f7c2c0f63956e13.png)

# sql - 我可以使用 EclipseLink 对变量执行外连接吗？

> ID：10999489
> 
> 赞同：0
> 
> 时间：2012-06-12T15:08:20.247
> 
> 标签：sql, jpa, eclipselink

我有两个表 T1 和 T2，我想实现这样的目标：

```
Select * from t1 left outer join t2 on (t1.id = t2.id and t2.x = :val) where t2.x is null or t2.x = :val 
```

我有 T1 和 T2 的实体。

在 T1 中：

```
 @OneToOne(fetch = FetchType.LAZY)
 @JoinColumn(name = "ID", insertable = false, updatable = false)
 protected T2 t2; 
```

我尝试了以下 JPA 查询：

```
SELECT t1 FROM T1 LEFT JOIN t.t1 t2 WHERE t2.x IS NULL OR t2.x = :val 
```

但它并没有给我我想要的。问题是当我在 T2 中有某个 ID 的匹配记录时，我只会收到一个 T2.X 值的结果。我需要所有任何值的结果，即使它为空。

生成的 SQL 类似于：

```
SELECT * FROM T1 t1 LEFT OUTER JOIN T2 t2 ON (t2.ID = t1.ID) WHERE ((t2.X IS NULL) OR (t2.X = ?)) 
```

为什么我需要这个？我在 T1 中有一些详细信息，相同的信息可能在 T2 中可用。T2 中的信息具有优先权。如果数据在 T2 中不可用，我只使用 T1 中的默认数据。

可能是我看错了方向。因此，欢迎任何有关解决此问题的想法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:17:50.673

EclipseLink 在 2.4 中添加了 ON 子句支持，

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#ON](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#ON)

# c# - 在 C# 中将本地用户添加到本地组

> ID：10999499
> 
> 赞同：3
> 
> 时间：2012-06-12T15:08:57.800
> 
> 标签：c#, directoryentry

我可以很好地添加一个用户，但是我不能将它添加到本地组。我收到此错误：-

> 无法将成员添加到本地组或从本地组中删除，因为该成员不存在。

这是我正在使用的代码。我做错了什么？这只是本地机器，我绝对有权这样做，并且该组肯定存在。

```
 try
        {
            using (DirectoryEntry hostMachineDirectory = new DirectoryEntry("WinNT://" + serverName))
            {
                DirectoryEntries entries = hostMachineDirectory.Children;

                foreach (DirectoryEntry entry in entries)
                {
                    if (entry.Name.Equals(userName, StringComparison.CurrentCultureIgnoreCase))
                    {
                        // Update password
                        entry.Invoke("SetPassword", password);
                        entry.CommitChanges();
                        return true;
                    }
                }

                DirectoryEntry obUser = entries.Add(userName, "User");
                obUser.Properties["FullName"].Add("Used to allow users to login to Horizon. User created programmatically.");
                obUser.Invoke("SetPassword", password);
                obUser.Invoke("Put", new object[] {
                "UserFlags",
                0x10000
                });

                obUser.CommitChanges();

                foreach (string group in groups)
                {
                    DirectoryEntry grp = hostMachineDirectory.Children.Find(group, "group");
                    if (grp != null) { grp.Invoke("Add", new object[] { obUser.Path.ToString() }); }

                }
                return true;
            }
        }
        catch (Exception ex)
        {
            returnMessage = ex.InnerException.Message;
            return false;
        } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T16:25:21.917

我很久以前写了一些代码，它采用了与您不同的方法，但据我所知（就没有人向我报告过问题！）。对你有用吗？

```
 /// <summary>
    /// Adds the supplied user into the (local) group
    /// </summary>
    /// <param name="userName">the full username (including domain)</param>
    /// <param name="groupName">the name of the group</param>
    /// <returns>true on success; 
    /// false if the group does not exist, or if the user is already in the group, or if the user cannont be added to the group</returns>
    public static bool AddUserToLocalGroup(string userName, string groupName)
    {
        DirectoryEntry userGroup = null;

        try
        {
            string groupPath = String.Format(CultureInfo.CurrentUICulture, "WinNT://{0}/{1},group", Environment.MachineName, groupName);
            userGroup = new DirectoryEntry(groupPath);

            if ((null == userGroup) || (true == String.IsNullOrEmpty(userGroup.SchemaClassName)) || (0 != String.Compare(userGroup.SchemaClassName, "group", true, CultureInfo.CurrentUICulture)))
                return false;

            String userPath = String.Format(CultureInfo.CurrentUICulture, "WinNT://{0},user", userName);
            userGroup.Invoke("Add", new object[] { userPath });
            userGroup.CommitChanges();

            return true;
        }
        catch (Exception)
        {
            return false;
        }
        finally
        {
            if (null != userGroup) userGroup.Dispose();
        }
    } 
```

# c# - c# 读取字典中相同值的所有条目/

> ID：10999502
> 
> 赞同：3
> 
> 时间：2012-06-12T15:09:10.480
> 
> 标签：c#, dictionary

c# 新手。我正在尝试制作一个简单的系统，我可以在其中搜索对象列表以及它何时属于某个 ID。把它放在 List/ArrayList 中，这样我就可以读出来/做任何其他事情。

每个“项目”都有一个 locationID。当我进入这个位置并按“看”。该程序应该检查我在哪个位置，并只取出具有相同 ID 的“项目”。

在实践中。项目列表将非常大（以及位置）。因此，一次又一次地浏览列表似乎是一种浪费。这就是我想用字典的原因。但我似乎无法访问字典中的多个条目，只能在一个特定位置访问。

例如：

```
Dictionary<string, int> itemLoc = new Dictionary<string, int>();
itemLoc.Add("pen", 011);
itemLoc.Add("paper", 011);
itemLoc.Add("tv remote", 012);

//print everything in location 011 
```

抱歉缺少代码。我仍在想办法解决这个问题。我一直在研究 ArrayLists、Lists、Hashtables 和这些字典。但是没有一个，我已经能够有效地实现我正在寻找的东西。

我可以做一个 foreach，并检查每个条目。但就像上面提到的。这似乎是对处理的浪费。

任何想法或提示？非常感谢您在代码方面朝着正确的方向轻推。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:14:39.917

您正在做的是将整数值存储在您正在使用的字符串键的哈希指定的位置。

一个更好的主意是使用`Dictionary<int, List<string>>`（或任何 C# 为列表类提供的），`itemLoc.Add(011, new List<string>()); itemLoc.Get(011).Add("pen");`当您在某个位置添加第一项时执行类似操作（因此您想检查该位置是否作为字典中的键存在首先），然后是`itemLoc.Get(011).Add("paper");`之后。

请注意，我的语法可能不正确，因为我自己没有使用过 C#，但它不应该有那么不同。如果 C# 字典类有一个`AddIfAbsent()`-type 方法，那将有助于简化我提到的密钥检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:22:29.273

您没有就您的问题的限制向我们提供足够的信息。A`Dictionary<string, List<string>>`会执行得更快，但您尚未确定是否可以在多个位置拥有多个项目（例如，“纸张”可以在 011 和 012 中还是仅在 011 中？）在这种情况下，每次添加时都会有以确保该项目尚未在其他位置。

一种非常简单的方法是非常简单地将其分解，并根据您的结果进行优化。

```
class MyItem
{
    public string Name { get; set; }
    public string Location { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        List<MyItem> myItems = new List<MyItem>()
        {
            new MyItem() { Location = "011", Name = "pen" },
            new MyItem() { Location = "011", Name = "paper" },
            new MyItem() { Location = "012", Name = "tv remote" }
        };

        var specificItems = myItems.Where(f => f.Location == "011");

        foreach (var item in specificItems)
        {
            Console.WriteLine(item.Name);
        }

        Console.Read();
    }
} 
```

执行基准测试后，您可以考虑将其切换到某些东西（也许是`Dictionary<string, List<string>>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:13:37.930

根据定义，字典对每个键都有一个值。您不能使用单个键访问多个值。

但是，您可以使用 List 作为值。因此，如果您想在同一位置创建项目集合并稍后重用它，您可以将其存储在 key 为 locationID 的字典中： Dictionary>

我希望它有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:13:50.827

*字典提供从*键*到*值的映射，但反之则不然。您可以构建另一个字典，其中位置 ID 作为键，项目集合作为值，并以这种方式查找位置 ID

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:16:26.080

字典可以让您有效地根据位置找到项目，或者让您有效地根据项目找到位置，但不能两者兼而有之。（这并不是说以另一种方式执行它并不是非常低效，只是更少，通常是 O(n)，而不是更快。）

所以，你有几个可能性。最简单的就是简单地迭代`itemLoc.Values`并寻找你想要的东西。更复杂的是维护第二个集合 a `Dictionary<int, List<string>>`，它将存储每个位置的整个项目列表。这将使查找变得非常快速和容易，代价是维护数据（插入、更新、删除）的更多工作。

这完全取决于您要优化的内容。在最极端的情况下，您可以放弃`Dictionary<string,int>`并使用`Dictionary<int, List<string>>`独占，当您需要查找某个项目的位置时进行搜索——但您只想在这种查找类型非常罕见的情况下这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T15:19:46.000

我会推荐

```
Dictionary<int, List<string>> 
```

这样，您可以将多个项目添加到每个位置

例如

```
var locItems = new Dictionary<int, List<string>>();

List<string> items = new List<string>() { "item1", "Item2", "item3" };

locItems.Add(1, items);

// Get all items from location 1 ...
List<string> items = locItems[1];

foreach(string s in items)
    Console.WriteLine(s);

// Now add another item to the list
items.Add("Some new item");

// Since this is by ref - the list in the dict will be modified 
// so you don't need to worry about re-adding it to the dict 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-12T15:38:52.207

代码现在的样子，你只能拥有一支笔、纸等。这是因为您将它们用作字典的键。完成这项任务的更好方法是拥有一个

`Dictionary<int, List<string>>`

int 将是房间 id (001, 011, 等)，列表将是存储在每个房间中的对象。给定房间 ID，您现在可以遍历该房间中存储的所有内容的列表。

# c# - 从自定义安装程序安装后，c# 窗口服务未获取 log4net 设置

> ID：10999504
> 
> 赞同：1
> 
> 时间：2012-06-12T15:09:17.750
> 
> 标签：c#, windows-services, installation, windows-installer, log4net

我有一个客户端应用程序，它是一个带有 dll、exe 和配置文件的窗口服务器。

我为它创建了一个自定义安装程序，它将把它复制到程序文件中并更新它的配置。

这是我正在使用的代码

```
//read config and update
string path = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)+"\\EventLogTracer.exe"; //this is app.exe path not app.exe.config path
Configuration evetconfig =ConfigurationManager.OpenExeConfiguration(path);
evetconfig.AppSettings.Settings.Remove("baseUri");
 evetconfig.AppSettings.Settings.Add("baseUri", "https://192.168.1.79:443/rest");
evetconfig.Save(ConfigurationSaveMode.Modified);
ConfigurationManager.RefreshSection("appSettings"); 
```

我的 app.exe.config 文件中也有 log4net 配置。我根本没有碰它。我的安装程序也有相同的 log4net 设置。

现在我创建了它的 MSI 文件并通过安装它来运行不同的机器。

现在在我的本地机器上，它安装得很完美，它选择了所有设置和 log4net 设置。一切都很完美。

在我的 VM 机器上，我尝试安装它。它已安装并将数据发布到服务器。但它没有获取 log4net 设置，也没有写入任何日志。

这里有什么问题，我没有脑子。有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T15:40:52.957

我在 IIS 上部署的 WCF 应用程序遇到了类似的问题，结果证明这是与权限相关的问题。我知道您没有使用 IIS，但您的问题听起来也与权限有关。

生产中使用的是什么操作系统？服务器2008？如果是这样，他们是否比以前的 Windows 版本锁定了 Program Files 的权限？尝试完全控制将日志写入所有用户的文件夹，看看是否有效。如果是这样，您知道这是一个权限问题，然后您可以确定需要为哪些用户设置哪些特定权限（而不是让所有用户完全控制它）。

# tabs - 如何切换新打开的选项卡以观看测试执行

> ID：10999506
> 
> 赞同：0
> 
> 时间：2012-06-12T15:09:24.697
> 
> 标签：tabs, click, watir, radrails

我使用 Radrails 进行 watir 测试。这是我的代码：

```
ie.link(:text, "First").click
ie.link(:text, "Second").click
ie1 = Watir::IE.attach(:title, "Second") 
```

接下来我观察测试执行。我看到即窗户。单击第二个窗口后，将在新选项卡中的新浏览器窗口中打开。现在我想在这个新选项卡中操作，但是在 IE 中显示的是第一个选项卡。我想看看如何在名为 Second 的新选项卡中执行命令。有人可以建议如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:05:15.747

据我所知，Watir 对使用浏览器选项卡没有任何直接支持。

但是，如果您只想查看选项卡，则可以使用 IE 的键盘快捷键来处理选项卡 (http://windows.microsoft.com/en-us/windows7/internet-explorer-keyboard-shortcuts)。

假设打开的选项卡是最后一个，您可以使用以下命令切换到它：

```
ie.send_keys([:control, '9']) 
```

或者，如果它是下一个选项卡，您可以使用以下命令切换到它：

```
ie.send_keys([:control, :tab]) 
```

# android - 我正在尝试从 Android 访问 Web 服务，该服务的布局类似于下面的代码块：

> ID：10999510
> 
> 赞同：0
> 
> 时间：2012-06-12T15:09:35.043
> 
> 标签：android, xml, web-services, ksoap2, ksoap

目前我正在使用 ksoap2，但想使用行业中的任何标准方法。我可以访问“简单示例”（下）并使用 ksoap2 将诸如“弗兰克”之类的值写入日志没有问题，但复杂示例（下）让我难过。我已经看到很多示例显示我称之为“单级”的 xml，但没有一个像复杂示例那样遍历到 2 个或更多级别。

有什么帮助吗？

---简单示例---------------------------------------

```
<Category  xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org        /2001/XMLSchema-instance" xmlns="http://ACCUMobileWS.org/">
  <CategoryId>99</CategoryId>
  <Name>Frank</Name>
  <Description>Prison Break</Description>
  </Category>
<Category> 
```

--------复杂样本----------------------------- -

```
<SuperCategory xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ACCUMobileWS.org/">
  <Categories>
    <Category>
      <CategoryId>99</CategoryId>
      <Name>Frank</Name>
      <Description>Prison Break</Description>
    </Category>
    <Category>
      <CategoryId>101</CategoryId>
      <Name>Jim</Name>
      <Description>Breakig Bad</Description>
    </Category>
  </Categories>
</SuperCategory> 
```

问题是进入第二级，即“类别”数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:14:10.123

我不太了解 ksoap2，但如果您要处理大量 XML，那么您可能需要查看[Simple Framework](http://simple.sourceforge.net/)。我已经广泛使用了它，它能够轻松地将 XML 转换为 Java 对象，这使得处理许多对象的事情变得更容易。

如果您有兴趣，可以查看[这个编写良好的教程](http://www.javacodegeeks.com/2011/02/android-xml-binding-simple-tutorial.html)以获取设置帮助。

# mysql - 如何使用 GROUP BY 获取每个组的最新记录？

> ID：10999522
> 
> 赞同：61
> 
> 时间：2012-06-12T15:10:04.823
> 
> 标签：mysql, sql, greatest-n-per-group

假设我有一个名为`messages`列的表：

```
id | from_id | to_id | subject | message | timestamp 
```

我只想从每个用户那里获取最新消息，就像您在深入了解实际线程之前在 Facebook 收件箱中看到的那样。

这个查询似乎让我接近我需要的结果：

```
SELECT * FROM messages GROUP BY from_id 
```

但是，查询给了我来自每个用户的最旧消息，而不是最新消息。

我想不通这个。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-06-12T15:18:47.237

您应该找出`timestamp`每个组（子查询）中的最后一个值，然后将此子查询加入到表中 -

```
SELECT t1.* FROM messages t1
  JOIN (SELECT from_id, MAX(timestamp) timestamp FROM messages GROUP BY from_id) t2
    ON t1.from_id = t2.from_id AND t1.timestamp = t2.timestamp; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-04-21T18:27:22.303

试试这个

```
SELECT * FROM messages where id in (SELECT max(id) FROM messages GROUP BY from_id ) order by id desc 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-08-10T07:22:38.530

此查询返回每个 Form_id 的最后一条记录：

```
 SELECT m1.*
     FROM messages m1 LEFT JOIN messages m2
     ON (m1.Form_id = m2.Form_id AND m1.id < m2.id)
     WHERE m2.id IS NULL; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-15T13:53:42.703

只是补充德瓦特所说的，下面的代码不是根据问题排序的：

```
SELECT t1.* FROM messages t1
  JOIN (SELECT from_id, MAX(timestamp) timestamp FROM messages GROUP BY from_id) t2
    ON t1.from_id = t2.from_id AND t1.timestamp = t2.timestamp; 
```

“GROUP BY”子句必须在主查询中，因为我们需要首先重新排序“SOURCE”以获得所需的“分组”，所以：

```
SELECT t1.* FROM messages t1
  JOIN (SELECT from_id, MAX(timestamp) timestamp FROM messages ORDER BY timestamp DESC) t2
    ON t1.from_id = t2.from_id AND t1.timestamp = t2.timestamp GROUP BY t2.timestamp; 
```

问候，

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T15:18:57.973

这是一个标准问题。

请注意，MySQL 允许您从 GROUP BY 子句中省略列，而标准 SQL 不允许这样做，但是当您使用 MySQL 工具时，通常不会获得确定性结果。

```
SELECT *
  FROM Messages AS M
  JOIN (SELECT To_ID, From_ID, MAX(TimeStamp) AS Most_Recent
          FROM Messages
         WHERE To_ID = 12345678
         GROUP BY From_ID
       ) AS R
    ON R.To_ID = M.To_ID AND R.From_ID = M.From_ID AND R.Most_Recent = M.TimeStamp
 WHERE M.To_ID = 12345678 
```

我在 上添加了一个过滤器`To_ID`以匹配您可能拥有的内容。没有它，查询也可以工作，但通常会返回更多数据。嵌套查询和外部查询中都不需要声明条件（优化器应该自动将条件下推），但重复显示的条件不会有任何害处。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2012-06-12T15:12:14.833

你需要订购它们。

`SELECT * FROM messages GROUP BY from_id ORDER BY timestamp DESC LIMIT 1`

# c - 如何编写一个执行 malloc、格式化字符串然后返回格式化字符串的宏？

> ID：10999523
> 
> 赞同：0
> 
> 时间：2012-06-12T15:10:05.177
> 
> 标签：c, macros

我试过这个：

```
#define format(f, ...) \
                int size = strlen(f) + (sizeof((int[]){__VA_ARGS__})/sizeof(int)) + 1); \
                char *buf = malloc(size); \
                snprintf(buf, size, f, __VA_ARGS__); \
                buf 
```

但它会返回很多语法错误。我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:15:43.427

C 宏不是函数，而是 1:1 替换。因此，如果您想像这样使用宏：

```
mystring = format("%d", 5); 
```

你得到这个：

```
mystring = int size = strlen(f) + (sizeof((int[]){5})/sizeof(int)) + 1); \
            char *buf = malloc(size); \
            snprintf(buf, size, f, 5); \
            buf; 
```

这没有任何意义。在您的情况下，您最好定义一个内联函数，该函数在体面的编译器上的性能应该不会更差。

如果它*真的*必须是一个宏并且你在 GCC 上，你可以使用复合语句来实现你的目标。它允许您这样做：`mystring = ({ statement1, statement2, ..., statementN})`它将在本地范围内执行您的所有语句，然后分配`statementN`给`mystring`. 但是，它会使您的代码不可移植并且难以调试。

所以给你，但请不要在实际应用程序中使用它：

```
#define format(f, ...) \
    ({ int size = snprintf(NULL, 0, f, __VA_ARGS__) + 1;\
    char * buf = malloc(size);\
    snprintf(buf, size, f, __VA_ARGS__); buf; }) 
```

我是认真的。不要使用这个。使用内联函数。您还可以在普通函数中使用可变参数，使用`va_arg`and `va_start`：

```
inline char * format(f, ...) {
    va_list args;
    va_start(args, f);
    int size = vsnprintf(NULL, 0, f, args) + 1;
    char * buf = malloc(size);
    vsnprintf(buf, size, f, args);
    return buf;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:13:11.590

如果你在没有参数的情况下使用它，你应该输入

```
snprintf(buf, size, f, ## __VA_ARGS__); 
```

反而; 否则它不会截断结尾的逗号。

此外，如果你想使用格式字符串，你不能确定它`strlen(format) + length of every other elements`实际上是你得到的大小。您必须做出假设，然后使用安全功能。

使用这种宏语法也无法返回值。然而，使用 GNU 扩展是可能的。请参阅下面的修改后的答案。

还有，你想做什么

```
sizeof((int[]){__VA_ARGS__} 
```

? 这一点都不好。您无法找出可变参数列表的大小。

尝试这样的事情：

```
#define format(f, ...) \
            ({
            char *buf = malloc(4096); \
            snprintf(buf, 4096, f , ## __VA_ARGS__); \
            buf
        }) 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:14:30.790

不知道你想用第一行做什么。您似乎正在尝试计算参数的数量，但随后您将其传递给`malloc`并将返回值`malloc`用作大小..？！

分配空间的正确方法`snprintf`是首先调用`snprintf`缓冲区指针和大小为零，然后检查返回值。返回值加一（用于空终止）将为您提供需要分配并传递给第二次`snprintf`调用的大小。

另外，不要尝试使用宏来执行此操作；使用函数和`vsnprintf`。

# java - Java GUI 连接到串口

> ID：10999530
> 
> 赞同：0
> 
> 时间：2012-06-12T15:10:35.860
> 
> 标签：java, user-interface, connection, serial-port

我在 Netbeans 上制作了一个 Java GUI，以便在将通过串行端口连接到设备的计算机上运行。此 GUI 用于显示将存储在其他设备中的用户信息。像文本文件或从设备的传感器检索一些数据。我刚刚完成了接口的轮廓，现在是比较难的部分，因为这是第一次处理串口。另一个设备是beagleboard。我什至不确定从哪里开始，因为我在这个论坛上看过，但似乎没有什么与我的问题完全相关。我假设我应该通过端口与设备建立连接，并根据用户请求发送信息请求。

有什么建议吗？是否应该在程序的单独 java 类中建立连接？gui由一个主JFrame和两个辅助JFrame组成，我（计划）基本上有一个按钮来建立主框架中的连接。

提前致谢， 亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:26:43.657

> 是否应该在程序的单独 java 类中建立连接？

是的。一个 java 类应该足以建立连接、向 beagleboard 发送消息并接收响应。

> 我假设我应该通过端口与设备建立连接，并根据用户请求发送信息请求。

是的。您可以将请求格式化为 beagleboard 所需的任何格式。

这是我整理的一个类，以确保 Java 应用程序的单个实例运行。您将修改此为您的通信。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.UnknownHostException;

public class ApplicationInstanceManager {

    private static final boolean DEBUG = false;

    private static ApplicationInstanceListener subListener;

    /** Randomly chosen, but static, high socket number */
    public static final int SINGLE_INSTANCE_NETWORK_SOCKET = 44331;

    /** Must end with newline */
    public static final String SINGLE_INSTANCE_SHARED_KEY = "$$RabidNewInstance$$\n";

    /**
     * Registers this instance of the application.
     * 
     * @return true if first instance, false if not.
     */
    public static boolean registerInstance() {
        // returnValueOnError should be true if lenient (allows app to run on
        // network error) or false if strict.
        boolean returnValueOnError = true;
        // try to open network socket
        // if success, listen to socket for new instance message, return true
        // if unable to open, connect to existing and send new instance message,
        // return false
        try {
            final ServerSocket socket = new ServerSocket(
                    SINGLE_INSTANCE_NETWORK_SOCKET, 10, InetAddress
                            .getLocalHost());
            if (DEBUG)
                System.out.println("Listening for application instances on socket "
                    + SINGLE_INSTANCE_NETWORK_SOCKET);
            Thread instanceListenerThread = new InstanceListenerThread(socket);
            instanceListenerThread.start();
            // listen
        } catch (UnknownHostException e) {
            EclipseLogging.logError(RabidPlugin.getDefault(),
                    RabidPlugin.PLUGIN_ID, e);
            return returnValueOnError;
        } catch (IOException e) {
            return portTaken(returnValueOnError, e);

        }
        return true;
    }

    private static boolean portTaken(boolean returnValueOnError, IOException e) {
        if (DEBUG)
            System.out.println("Port is already taken.  "
                    + "Notifying first instance.");
        try {
            Socket clientSocket = new Socket(InetAddress.getLocalHost(),
                    SINGLE_INSTANCE_NETWORK_SOCKET);
            OutputStream out = clientSocket.getOutputStream();
            out.write(SINGLE_INSTANCE_SHARED_KEY.getBytes());
            out.close();
            clientSocket.close();
            System.out.println("Successfully notified first instance.");
            return false;
        } catch (UnknownHostException e1) {
            EclipseLogging.logError(RabidPlugin.getDefault(),
                    RabidPlugin.PLUGIN_ID, e);
            return returnValueOnError;
        } catch (IOException e1) {
            EclipseLogging
                    .logError(
                            RabidPlugin.getDefault(),
                            RabidPlugin.PLUGIN_ID,
                            "Error connecting to local port for single instance notification",
                            e);
            return returnValueOnError;
        }
    }

    public static void setApplicationInstanceListener(
            ApplicationInstanceListener listener) {
        subListener = listener;
    }

    private static void fireNewInstance() {
        if (subListener != null) {
            subListener.newInstanceCreated();
        }
    }

    public static void main(String[] args) {
        if (!ApplicationInstanceManager.registerInstance()) {
            // instance already running.
            System.out.println("Another instance of this application " + 
                    "is already running.  Exiting.");
            System.exit(0);
        }
        ApplicationInstanceManager
                .setApplicationInstanceListener(new ApplicationInstanceListener() {
                    public void newInstanceCreated() {
                        System.out.println("New instance detected...");
                        // this is where your handler code goes...
                    }
                });
    }

    public static class InstanceListenerThread extends Thread {

        private ServerSocket socket;

        public InstanceListenerThread(ServerSocket socket) {
            this.socket = socket;
        }

        @Override
        public void run() {
            boolean socketClosed = false;
            while (!socketClosed) {
                if (socket.isClosed()) {
                    socketClosed = true;
                } else {
                    try {
                        Socket client = socket.accept();
                        BufferedReader in = new BufferedReader(
                                new InputStreamReader(client.getInputStream()));
                        String message = in.readLine();
                        if (SINGLE_INSTANCE_SHARED_KEY.trim().equals(
                                message.trim())) {
                            if (DEBUG)
                                System.out.println("Shared key matched - "
                                        + "new application instance found");
                            fireNewInstance();
                        }
                        in.close();
                        client.close();
                    } catch (IOException e) {
                        socketClosed = true;
                    }
                }
            }
        }
    }
} 
```

# javascript - Facebook 视频播放器 API

> ID：10999532
> 
> 赞同：4
> 
> 时间：2012-06-12T15:10:38.890
> 
> 标签：javascript, api, facebook-graph-api, web-applications, video

我正在尝试开发一个网络应用程序，该应用程序涉及获取用户的 Facebook 视频并允许他们创建用户/观众交互性。为了做到这一点，我需要某种类似于 YouTube 和其他视频服务器提供的 Facebook 播放器 API（提供事件监听器、播放暂停、音量功能）。不过他们似乎没有，我已经四处寻找了一段时间。

理想情况下，我想联系 Facebook 并询问是否可以，但我也找不到任何联系信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:23:47.620

该播放器相当基本，但很容易找到：

它[链接自 Facebook.com 前端的每个 Facebook 视频页面](http://i.stack.imgur.com/UtLzv.png)：

在[Graph API](https://developers.facebook.com/docs/reference/api/video/)中：

HTTP GET [https://graph.facebook.com/2031763147233](https://graph.facebook.com/2031763147233)：

```
{
  "id": "2031763147233", 
  "from": {
    "name": "Facebook", 
    "category": "Product/service", 
    "id": "20531316728"
  }, 
  "name": "Facebook Video Calling", 
  "description": "Bring your conversations to life on Facebook. With face-to-face video 
  "embed_html": "<object width=\"400\" height=\"300\" ><param name=\"allowfullscreen\" value=\"true\" /><param name=\"movie\" value=\"http://www.facebook.com/v/2031763147233\" /><embed src=\"http://www.facebook.com/v/2031763147233\" type=\"application/x-shockwave-flash\" allowfullscreen=\"true\" width=\"400\" height=\"300\"></embed></object>", 
 //Other fields ommitted 
```

在[FQL](https://developers.facebook.com/docs/reference/fql/video/)中: `SELECT vid, title, embed_html FROM video WHERE vid = 3902879808751` :

```
{
  "data": [
    {
      "vid": 3902879808751, 
      "title": "Facebook Camera", 
      "embed_html": "<object width=\"400\" height=\"224\" ><param name=\"allowfullscreen\" value=\"true\" /><param name=\"movie\" value=\"http://www.facebook.com/v/3902879808751\" /><embed src=\"http://www.facebook.com/v/3902879808751\" type=\"application/x-shockwave-flash\" allowfullscreen=\"true\" width=\"400\" height=\"224\"></embed></object>"
    }
  ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T13:47:59.220

时间飞逝，现在有一个官方的 Facebook 视频播放器 Javascript API。

这是其文档的链接：[https ://developers.facebook.com/docs/plugins/embedded-video-player/api](https://developers.facebook.com/docs/plugins/embedded-video-player/api)

# c - gtk+ 菜单 鼠标滚轮速度

> ID：10999533
> 
> 赞同：2
> 
> 时间：2012-06-12T15:10:41.673
> 
> 标签：c, menu, gtk, mousewheel

我正在使用 C 语言开发文件浏览器小程序的孙子。

我的问题是我找不到在菜单中使用鼠标滚轮加速滚动的解决方案。在我的情况下，每次鼠标滚轮点击只移动 1/2 个条目，我想要的是 5 个条目。

编码：

```
 eintrag->menu = gtk_menu_new() ;
  gtk_signal_connect(GTK_OBJECT (eintrag->menu),"scroll-event",(GtkSignalFunc) scroll_test,NULL) ;

  if ( (n = scandir(parent->full_name,&dir_list,0,alphasort)) > 0 )
     {
     for ( i = 0 ; i < n ; i++ )
        {
        eintrag->item = gtk_image_menu_item_new_with_label(eintrag->filename) ;
        ,,,,
        }
     }

  ------------------------------------------------------------------------------------
  gboolean scroll_test(GtkWidget *widget,GdkEventScroll *event,void *nix) 
     {
     g_print("scroll %s %d %d \n",name,event->send_event,event->direction ;
     return FALSE ;
     } 
```

该代码是一个非常简单的 GTK 菜单，附带一个“scroll.event”。

第一次尝试是在 scroll_test CB 内发出一个额外的滚动事件。通过使用 g_signal_emit_by_name(widget,"scroll-event",widget,event,NULL)，即使我设置了一个带有新时间戳的新事件结构并将 ->send_event 设置为 TRUE，结果也会令人困惑。也许我在这里有一个 Parms 错误。

第二个尝试是创建一个 gtk_adjustment_new，使用 gtk_widget_set_scroll_adjustments 将其附加到菜单并更改 gtk_adjustment_set_step_increment。没变。

# asp.net - HTTP 错误 500.19 - 内部服务器错误

> ID：10999534
> 
> 赞同：3
> 
> 时间：2012-06-12T15:10:52.057
> 
> 标签：asp.net

在将我的 web 包部署到 IIS 后，我遇到了这个问题：

> HTTP 错误 500.19 - 内部服务器错误 无法访问请求的页面，因为该页面的相关配置数据无效。
> 
> 此配置部分不能在此路径中使用。当该部分锁定在父级别时会发生这种情况。锁定是默认情况下 (overrideModeDefault="Deny") 或由具有 overrideMode="Deny" 或旧 allowOverride="false" 的位置标记显式设置的。

```
Config Source:

119:     </modules>
120:     <handlers>
121:       <remove name="WebServiceHandlerFactory-Integrated" /> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:31:38.833

请参阅此页面上的场景 7 [Troubleshooting HTTP 500.19 Errors in IIS 7](http://blogs.msdn.com/b/webtopics/archive/2010/03/08/troubleshooting-http-500-19-errors-in-iis-7.aspx)，它看起来与您的错误消息几乎相同。

我认为的关键点之一如下：

> 这通常表明 ASP.NET 未安装或安装已损坏/不完整，因为安装 asp.net 会解锁该部分。因此，如果是这种情况，应该从服务器管理器安装 asp.net 功能（在 Windows Server 2008 中的 Web 服务器角色和 Vista/Windows7 中的程序功能 -> 应用程序服务器中）。这个 KB929772 讲述了 ASP.NET 安装失败的原因。

如果您只是在本地桌面 IIS 上而不是在服务器上执行此操作，则可能需要使用 aspnet_regiis 向 IIS 重新注册 .NET，尽管我不保证这会解锁该部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T11:24:31.407

我刚刚经历过：

> HTTP 错误 500.19 - 内部服务器错误

问题是（天哪）：

*   在我的本地开发 IIS 上，我为我的站点添加了新的 MIME 类型。
*   新的 MIME 类型自动添加到我的 web.config（在*system.webServer*部分下）。**我没有注意到**。
*   当我将应用程序发布到生产服务器时 - 一切（加载脚本/css/图像/等）都停止工作。（*500.19 - 内部服务器错误*）
*   在深入研究问题之后 - 我终于看到了异常消息：**重复 MIME 类型**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-06T21:25:09.793

我得到了这个错误。我用谷歌搜索了几个小时。我尝试了各种建议。经过数小时的挫折，结果发现我的 cshtml 文件中只有一个额外的双引号。我删除了报价，一切都恢复了。所以错误具有误导性。我发布这个以防其他人遇到同样的问题。

# bash - 每个循环上的 shell 脚本中的增量数

> ID：10999541
> 
> 赞同：4
> 
> 时间：2012-06-12T15:11:08.123
> 
> 标签：bash, shell

```
#!/bin/bash

echo SCRIPT: $0
echo "Enter Customer Order Ref (e.g. 100018)"
read P_CUST_ORDER_REF
echo "Enter DU Id (e.g. 100018)"
read P_DU_ID

P_ORDER_ID=${P_CUST_ORDER_REF}${P_DU_ID}

#Loop through all XML files in the current directory
for f in *.xml
do
  #Increment P_CUST_ORDER_REF here
done 
```

在 for 循环中，每次循环时如何将 P_CUST_ORDER_REF 增加 1

```
so it READs 10000028 uses it on first loop
2nd 10000029
3rd 10000030
4th 10000031 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T15:33:49.797

```
((P_CUST_ORDER_REF+=1)) 
```

或者

```
let P_CUST_ORDER_REF+=1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-12T15:12:42.447

```
P_CUST_ORDER_REF=$((P_CUST_ORDER_REF+1)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T16:02:32.683

您可以使用后增量运算符：

```
(( P_CUST_ORDER_REF++ )) 
```

我建议：

*   习惯性地使用小写或混合大小写的变量名，以避免与 shell 或环境变量的潜在名称冲突
*   扩展时引用所有变量
*   通常使用`-r`with read 来防止反斜杠被解释为转义
*   验证用户输入

例如：

```
#!/bin/bash
is_pos_int () {
    [[ $1 =~ ^([1-9][0-9]*|0)$ ]]
}

echo "SCRIPT: $0"

read -rp 'Enter Customer Order Ref (e.g. 100018)' p_cust_order_ref
is_pos_int "$p_cust_order_ref"

read -rp 'Enter DU Id (e.g. 100018)' p_du_id
is_pos_int "$p_dui_id"

p_order_id=${p_cust_order_ref}${p_du_id}

#Loop through all XML files in the current directory
for f in *.xml
do
    (( p_cust_order_ref++ ))
done 
```

# c# - Bouncy Castle C# PGP 解密示例

> ID：10999542
> 
> 赞同：7
> 
> 时间：2012-06-12T15:11:12.370
> 
> 标签：c#, encryption, bouncycastle, pgp

我昨天一直在寻找一整天，我似乎找不到在 c# 中使用 Bouncy Castle 进行 PGP 解密的工作示例

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T21:53:36.873

终于让它工作了。我在其他示例中遇到的主要问题是，我的私钥环包含一个用于签名的密钥，当尝试加载用于解密的密钥时，该密钥首先出现。这就是为什么我必须`ElGamalPrivateKeyParameters`在密钥上添加类型检查的原因。

下面是我的代码。不是很干净，但它的工作原理。

```
 private static PgpPrivateKey GetPrivateKey(string privateKeyPath)
    {
        using (Stream keyIn = File.OpenRead(privateKeyPath))
        using (Stream inputStream = PgpUtilities.GetDecoderStream(keyIn))
        {
            PgpSecretKeyRingBundle secretKeyRingBundle = new PgpSecretKeyRingBundle(inputStream);

            PgpSecretKey key = null;
            foreach (PgpSecretKeyRing kRing in secretKeyRingBundle.GetKeyRings())
            {
                foreach (PgpSecretKey secretKey in kRing.GetSecretKeys())
                {
                    PgpPrivateKey privKey = secretKey.ExtractPrivateKey("1234567890".ToCharArray());

                    if (privKey.Key.GetType() ==
                        typeof (Org.BouncyCastle.Crypto.Parameters.ElGamalPrivateKeyParameters))
                        //Org.BouncyCastle.Crypto.Parameters.ElGamalPrivateKeyParameters
                    {
                        return privKey;
                    }
                }

            }
        }

        return null;
    }

    public static void Decrypt(Stream input, string outputpath, String privateKeyPath)
    {
        input = PgpUtilities.GetDecoderStream(input);
        try
        {
            PgpObjectFactory pgpObjF = new PgpObjectFactory(input);
            PgpEncryptedDataList enc;
            PgpObject obj = pgpObjF.NextPgpObject();
            if (obj is PgpEncryptedDataList)
            {
                enc = (PgpEncryptedDataList)obj;
            }
            else
            {
                enc = (PgpEncryptedDataList)pgpObjF.NextPgpObject();
            }

            PgpPrivateKey privKey = GetPrivateKey(privateKeyPath);

            PgpPublicKeyEncryptedData pbe = enc.GetEncryptedDataObjects().Cast<PgpPublicKeyEncryptedData>().First();
            Stream clear;
            clear = pbe.GetDataStream(privKey);
            PgpObjectFactory plainFact = new PgpObjectFactory(clear);
            PgpObject message = plainFact.NextPgpObject();
            if (message is PgpCompressedData)
            {
                PgpCompressedData cData = (PgpCompressedData)message;
                Stream compDataIn = cData.GetDataStream();
                PgpObjectFactory o = new PgpObjectFactory(compDataIn);
                message = o.NextPgpObject();
                if (message is PgpOnePassSignatureList)
                {
                    message = o.NextPgpObject();
                    PgpLiteralData Ld = null;
                    Ld = (PgpLiteralData)message;
                    Stream output = File.Create(outputpath + "\\" + Ld.FileName);
                    Stream unc = Ld.GetInputStream();
                    Streams.PipeAll(unc, output);
                }
                else
                {
                    PgpLiteralData Ld = null;
                    Ld = (PgpLiteralData)message;
                    //Stream output = File.Create(outputpath + "\\" + Ld.FileName);
                    Stream output = File.Create(outputpath);
                    Stream unc = Ld.GetInputStream();
                    Streams.PipeAll(unc, output);
                }
            }
        }
        catch (Exception e)
        {
            throw new Exception(e.Message);
        }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-26T16:26:14.050

在程序终止之前，我遇到了 Ron Harlev 的 Decrypt 函数保存输出文件的问题。我在 Stream 周围添加了一些 using 语句来解决这个问题。我还替换了硬编码密码以支持输入参数。我希望有人觉得这很有用。

```
private static bool DecryptFile(Stream inputStream, string outputDir, char[] passPhrase, string privateKeyLoc)
    {
        try
        {
            using (var newStream = PgpUtilities.GetDecoderStream(inputStream))
            {
                PgpObjectFactory pgpObjF = new PgpObjectFactory(newStream);
                PgpEncryptedDataList enc;
                PgpObject obj = pgpObjF.NextPgpObject();
                if (obj is PgpEncryptedDataList)
                {
                    enc = (PgpEncryptedDataList)obj;
                }
                else
                {
                    enc = (PgpEncryptedDataList)pgpObjF.NextPgpObject();
                }

                PgpPrivateKey privKey = GetPrivateKey(privateKeyLoc, passPhrase, logger);

                PgpPublicKeyEncryptedData pbe = enc.GetEncryptedDataObjects().Cast<PgpPublicKeyEncryptedData>().First();

                using (Stream clear = pbe.GetDataStream(privKey))
                {
                    PgpObjectFactory plainFact = new PgpObjectFactory(clear);
                    PgpObject message = plainFact.NextPgpObject();

                    if (message is PgpCompressedData)
                    {
                        PgpCompressedData cData = (PgpCompressedData)message;
                        Stream compDataIn = cData.GetDataStream();
                        PgpObjectFactory o = new PgpObjectFactory(compDataIn);
                        message = o.NextPgpObject();
                        if (message is PgpOnePassSignatureList)
                        {
                            message = o.NextPgpObject();
                        }
                        PgpLiteralData Ld = null;
                        Ld = (PgpLiteralData)message;
                        using (Stream output = File.Create(outputDir + "\\" + Ld.FileName))
                        {
                            Stream unc = Ld.GetInputStream();
                            Streams.PipeAll(unc, output);
                        }
                    }
                }
            }

            return true;
        }
        catch (Exception e)
        {
            throw new Exception(e.Message);
            return false;
        }
    } 
```

# jakarta-ee - @Named + @RequestScoped 在 JSF 2.0 和 JBoss 7.1.1 中不起作用

> ID：10999543
> 
> 赞同：7
> 
> 时间：2012-06-12T15:11:22.603
> 
> 标签：jakarta-ee, jsf-2, cdi

我有一份工作`@ManagedBean`，我想用`@Named + @RequestScoped`豆子代替。

```
// Before
@ManagedBean
public class Login {
   ...
}

// After
import javax.enterprise.context.RequestScoped;
@Named
@RequestScoped
public class Login {
   ...
} 
```

只要我使用`@ManagedBean`. `@Named`没有`@RequestScoped`工作，但为每个 EL 表达式创建一个新实例。`@Named + @RequestScoped`但是会产生异常：**当请求缓存不活动时，无法添加请求范围的缓存项**

```
java.lang.IllegalStateException: Unable to add request scoped cache item when request cache is not active
    at org.jboss.weld.context.cache.RequestScopedBeanCache.addItem(RequestScopedBeanCache.java:51)
    at de.prosis.dafe.presentation.Login$Proxy$_$$_WeldClientProxy.getUsername(Login$Proxy$_$$_WeldClientProxy.java)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.el.BeanELResolver.getValue(BeanELResolver.java:302)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at org.apache.el.parser.AstValue.getValue(AstValue.java:169)
    at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
    at org.jboss.weld.el.WeldValueExpression.getValue(WeldValueExpression.java:50)
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    ... 
```

空`beans.xml`确实存在。是否有任何我不知道的陷阱或错误？我敢打赌我错过了一些东西，但它看起来确实像一个错误。我用谷歌搜索了异常消息，但除了引发它的类的来源之外什么也没找到。提前致谢！

**更新：** 它与我省略的代码有关。登录 bean 尝试在其构造函数中使会话无效，如果它是命名 bean（并非总是如此，如果我向 F5 发送垃圾邮件，它似乎在几次后工作）并作为托管 bean 工作。有人可以解释这种行为吗？

```
public Login() {
            HttpSession session = (HttpSession) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
            if (session != null) {
                session.invalidate();
            }
} 
```

代码来自该教程： [http ://www.greenkode.com/2011/09/user-authentication-and-authorization-using-jaas-and-servlet-3-0-login/](http://www.greenkode.com/2011/09/user-authentication-and-authorization-using-jaas-and-servlet-3-0-login/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T18:02:45.043

通过删除构造函数中会话的无效来修复它。我仍然不知道为什么@ManagedBean 有效而@Named 无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T12:15:37.493

我有同样的问题。从 @ManagedBean （正在工作）切换到 @Named 不起作用。我在 WEB-INF 中有一个 beans.xml 文件，它并没有像大多数人建议的那样解决问题。您可以添加 @Stateless 和 @Named 以使其工作，原因我不知道！如果有人能解释我很想听听。

无论如何，我猜测使@Named 工作的“真正”方法是：如果您导入正确的@RequestScoped 注释，@Named 将起作用；来自 javax.enterprise.context 包。javax.faces.bean 包中的@RequestScoped 注释与@Named 注释不兼容。如果你在@Named 旁边省略了正确的@RequestScoped，bean 将会触发，但它不会读取任何属性。

附言。我使用 Glassfish，所以我怀疑这是 JBoss 的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T08:20:56.783

我认为您要么**不在**[这些](http://docs.jboss.org/cdi/spec/1.0/html_single/#d0e5377)场景之一，要么JBoss AS 7 有另一个类似[这样](https://issues.jboss.org/browse/AS7-3129)的问题。

顺便说一句，请求范围的 bean 不需要是可序列化的。可能@SteveTaylor 将它与会话范围的 bean 混合在一起。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-15T21:37:22.333

对于那些仍在与这个问题作斗争的人，这对我有用（原因仍然不明）

我将 GF4 与 netbeans 一起使用。Netbeans 在 JSF 页面中也有一个很棒的 tabcompletion，它与注入的行为不一致。我（目前）只测试了请求范围，但我想它都在包中..

所以这是我使用的所有组合和结果（在解决方案之上）

## 最佳解决方案

```
import javax.faces.bean.RequestScoped; 
import javax.inject.Named; 
//=> Injection ok - Tab Completion OK 
```

* * *

## 其他较少或不充分的组合（信息）

```
import javax.faces.bean.RequestScoped;
import javax.annotation.ManagedBean; 
//=> Injection ok - Tab Completion NOK

import javax.enterprise.context.RequestScoped;
import javax.inject.Named; 
//=> Injection nok - Tab Completion OK 

import javax.enterprise.context.RequestScoped;
import javax.faces.bean.ManagedBean;
//=> Injection nok - Tab Completion OK 

import javax.faces.bean.RequestScoped;
import javax.faces.bean.ManagedBean;
//=> Injection nok - Tab Completion OK

import javax.enterprise.context.RequestScoped;
import javax.annotation.ManagedBean; 
//=> Injection nok - Tab Completion NOK 
```

# android - SplashScreen 不会转到主应用程序（ANDROID）

> ID：10999544
> 
> 赞同：-1
> 
> 时间：2012-06-12T15:11:23.270
> 
> 标签：android

> **可能重复：**
> [Android 中的 Splash 无法正常工作](https://stackoverflow.com/questions/10997510/splash-in-android-not-working)

我的启动画面保持静止。它不会让主应用程序运行。这是我正在使用的代码：我有三个文件：Splash.xml、Splash.java 和 SplashNew.java

```
 package com.timchecklist;

import android.app.Activity;
import android.content.Intent;
import android.graphics.Color;
import android.os.Bundle;

public class Splash extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Thread Timer = new Thread() {
            public void run() {

                try {
                    sleep(3000);
                    startActivity(new Intent("com.timchecklist.SPLASHNEW"));

                } catch (InterruptedException e) {
                    e.printStackTrace();
                } finally {
                    finish();
                }
            }
        };
        Timer.start();
    }

} 
```

SplashNew.java

```
 package com.timchecklist;

import android.app.Activity;
import android.os.Bundle;
import android.view.Window;

public class SplashNew extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.splash);

    }

} 
```

飞溅.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:background="@drawable/pic1"
    android:gravity="center"
    android:orientation="vertical" >

</LinearLayout>

AndroidManifest.xml

  <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.timchecklist"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".TimCheckListActivity"
            android:label="@string/app_name"
            android:theme="@android:style/Theme.NoTitleBar" >
        </activity>
        <activity
            android:name=".SplashNew"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

任何想法/帮助？

伙计们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:18:42.437

请`startActivity(new Intent("com.timchecklist.SPLASHNEW"));`改为`startActivity(new Intent(SplashNew.class));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:46:41.623

如果您在此期间没有任何工作要做，请不要让您的用户等待 3 秒等待启动屏幕。如果您必须为您的应用程序做一些工作，那么在您显示启动屏幕时在后台执行该工作。如果你强迫你的用户在使用你的应用时无缘无故地等待 3 秒，他们会很不高兴。

这是一篇[关于闪屏的好帖子，](http://blog.iangclifton.com/2011/01/01/android-splash-screens-done-right/)其中有一个实现它们的方法示例。

但是，如果您没有充分的理由让用户等待，那么我真的不能强调不要让他们等待。

**编辑：**另外，如果您坚持让您的用户至少等待一个*毫无意义*的启动屏幕，请实施某种方式来检查用户是否在启动过程中按下（退出您的应用程序），以及他们是否没有调用 startActivity ()。以你现在的方式，即使用户在启动过程中按下（如果你让他们*无缘无故*地等待 3 秒，他们会这样做。）你的线程仍然会调用 startActivity() 这将删除你的 Activity即使用户通过按下后退按钮退出。上面的链接谈到了这一点。

# algorithm - 考虑到gmail的+来检查唯一电子邮件的算法

> ID：10999548
> 
> 赞同：3
> 
> 时间：2012-06-12T15:11:31.587
> 
> 标签：algorithm, email, exploit, verify

我有一个带有免费赠品的注册表单，但人们通过注册为滥用它

```
jo+1@gmail.com
jo+2@gmail.com 
```

我可以在我的电子邮件记录上运行任何标准算法来验证这种情况吗？

一个我可以拿走`jo@gmail.com`并使之无效的地方`jo+1@gmail.com`。

另外我不知道`+`可以使用其他类似的符号。也许`.`？

**编辑：**了解我的数据库中可能有一百万封电子邮件开始

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:15:24.347

Gmail 无法识别其电子邮件地址中的点。地址也不区分大小写。

加号的意思是“忽略包括+之后的所有内容”。

`.`因此，首先您要通过删除所有s来清理电子邮件地址。然后检测是否有 a `+`，如果有，去掉`+`和之间的所有内容`@`。

# linux - 如何创建配置脚本？

> ID：10999549
> 
> 赞同：89
> 
> 时间：2012-06-12T15:11:32.523
> 
> 标签：linux, bash, makefile, configure

这听起来像是一个非常笼统的问题，但它就在这里。

我需要为我的应用程序创建一个配置脚本，这个配置的结果将是一个生成的`makefile`（基本`configure`的`make`，，，`make install`）。我的问题是，我从哪里开始构建这个？有我可以效仿的例子吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-06-17T12:33:52.740

要创建标准的“配置”脚本，您需要 GNU autoconf。您可能还需要 GNU automake 和 libtool。

有大量的文档和操作指南。谷歌搜索“autoconf automake howto”之类的东西。好的文档在官方手册页中：

*   **自动配置**：[http ://www.gnu.org/software/autoconf/](http://www.gnu.org/software/autoconf/)
*   **自动制作：[http :](http://www.gnu.org/software/automake/automake.html) **//www.gnu.org/software/automake/automake.html****
***   **库工具：[http :](http://www.gnu.org/software/libtool/libtool.html) **//www.gnu.org/software/libtool/libtool.html******

 ****Autoconf 将从“configure.ac”文件开始创建您的配置脚本。“Makefile.am”文件将指示 automake 如何通过配置字符串创建您的 makefile。需要 Libtool 来简化围绕代码处理的库。

您可以开始手动创建 configure.ac 文件，或者您可以使用“自动扫描”帮助程序，它可以帮助您为您创建一些半自动的东西。

然后，当你准备好时，这个会变魔术：

```
autoreconf -i 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2016-12-09T09:04:17.943

linux中有构建流程，
[![在此处输入图像描述](../Images/08bf416320b24083159df0a6add65daf.png)](https://i.stack.imgur.com/kuFHy.gif) 并且有一个非常好的教程
[https://thoughtbot.com/blog/the-magic-behind-configure-make-make-install](https://thoughtbot.com/blog/the-magic-behind-configure-make-make-install)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-08-10T19:41:56.277

有时，软件产品会附带没有配置脚本。查找 autogen.sh 脚本。它可能会运行：

```
aclocal || die "aclocal failed"
automake --add-missing --force-missing --copy --foreign || die "automake failed"
autoreconf || die "autoreconf failed" 
```****

# facebook - 从一致的 URL 提供资源：facebook vs Google Pagespeed

> ID：10999556
> 
> 赞同：19
> 
> 时间：2012-06-12T15:12:00.387
> 
> 标签：facebook, facebook-like, google-pagespeed

使用 Facebook 之类的按钮或框时存在一个常见问题，在使用 Google 的 pagespeed 在线服务时我得到了这个： **从一致的 URL** 提供资源以下资源具有相同的内容，但从不同的 URL 提供。从一致的 URL 提供这些资源以节省 1 个请求和 25.3KiB。- [http://static.ak.facebook.com/connect/xd_arbiter.php?version=7](http://static.ak.facebook.com/connect/xd_arbiter.php?version=7) - [https://s-static.ak.facebook.com/connect/xd_arbiter.php?version=7](https://s-static.ak.facebook.com/connect/xd_arbiter.php?version=7)

很明显，一个用于安全的 ssl 连接，另一个用于不安全的连接。有没有办法让 facebook 只加载一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-22T16:21:44.713

如果您希望 Facebook 只加载一个，则需要通过 https 提供包含页面。

这是一个演示：

访问：

[使用 HTTP 的 Facebook 网站](http://developers.google.com/speed/pagespeed/insights/?url=http://developers.facebook.com/docs/reference/plugins/like/#&mobile=false&_cachebusterhttp)

您会注意到它显示了来自xd_arbiter**的一致 URL 的服务资源，现在访问：**

[使用 HTTPS 的 Facebook 网站](http://developers.google.com/speed/pagespeed/insights/?url=https://developers.facebook.com/docs/reference/plugins/like/&mobile=false&tab=desktop)

您会注意到 Facebook 仅在我们通过 https 提供页面时加载了 https 版本。我不确定这是否是 Facebook 问题。向 Facebook 提交错误可能值得，您至少会得到一些有用的反馈，（我尝试过但找不到可以为这些东西提交错误的地方，[http://developers.facebook.com/bugs /](http://developers.facebook.com/bugs/)似乎不合适）

编辑：更新损坏的链接，Facebook 似乎已经修复了原始问题，这些链接不再显示他们过去强调的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T15:02:17.340

Facebook 支持[通过 SSL 返回图片](https://developers.facebook.com/docs/reference/api/using-pictures/#ssl)。这也可能适用于其他资源。

可能值得附加`?return_ssl_resources=1`到您的 url 以查看这是否适用于您的资源。Facebook 文档是出了名的不完整，因此该功能可能存在。希望有帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-13T15:00:45.297

js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";

我想问题就在这里。

您可以尝试添加 http: 以避免连接到 https：

我没有测试，也无法确认它有帮助或提出一些问题来喜欢按钮

# php - 在默认浏览器中打开 URL 的 Javascript 代码

> ID：10999559
> 
> 赞同：1
> 
> 时间：2012-06-12T15:12:20.933
> 
> 标签：php, javascript, jquery, html

> **可能重复：**
> [Javascript 强制在浏览器中打开链接](https://stackoverflow.com/questions/494644/javascript-force-open-a-link-in-a-browser)

我正在编写专门在 Internet Explorer 上运行的代码。

情景是

我在那个 IE 浏览器中有一个链接，上面写着“预览”。每当单击它时，该链接仅在 Internet Explorer 中打开。

我希望在客户端的默认 Web 浏览器而不是 IE 中打开链接。

工作环境是： 使用的语言是 HTML，以 JS、JQUERY 和 PHP 作为编码语言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:16:42.783

这是在操作系统级别而不是 JavaScript 控制的东西。正如对您帖子的评论所说，这只是一个坏主意。

# c# - 唯一目的是修改私有变量的虚拟方法是明智的设计吗？

> ID：10999560
> 
> 赞同：0
> 
> 时间：2012-06-12T15:12:25.120
> 
> 标签：c#, inheritance

oo设计基础在这里...

编辑：在第一次回答后澄清 - 我不是在问如何解决这个问题，而是从表面上看设计是否看起来很古怪。出于社会考虑，我不想指出原始代码。

我正在使用一些具有虚拟方法的代码，该方法除了修改类的私有成员变量之外什么都不做。我只想更改该修改的细节。这是我想要改变的唯一行为，但我不能引用私有成员，所以我不能只覆盖该方法。从表面上看，原作者的设计是错误的/奇怪的，还是说这没有足够的信息？

```
public class X
{
    private List<string> InterestingThings = new List<string>();

    public virtual void MethodIWantToOverride(string rawData)
    {

         string fixedData = ... 
         // do some fancy stuff to clean up data that I want to come thru 'dirty'
         InterestingThings.Add(fixedData);
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:14:44.673

它需要被定义为一个`protected`变量而不是`private`一个`virtual`方法来修改它。

我建议进行此更改并将方法保留为`virtual`，因为这样可以保证您不会破坏此类之外的任何内容。最初的开发人员可能打算覆盖派生类中的虚拟方法。如果您无法知道或测试是否是这种情况，则将方法保留为`virtual`并将`private`成员更改为`protected`。

[更多关于虚拟方法的阅读在这里](http://msdn.microsoft.com/en-us/library/9fkccyh4%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:33:11.030

将属性保留为私有可确保只有包含类才能看到它。将其设置为受保护将允许派生类也可以查看和使用它。如果您需要派生类来覆盖需要访问此属性的方法，就像上面所做的那样，您必须使属性和方法（至少）受到保护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T18:46:20.950

如果代码的目的是对添加到列表中的项目强制执行一些不变量，则要求将项目添加到列表中的所有尝试都通过虚拟方法来实现这一目标。将列表字段公开为`protected`允许派生类违反基类不变量。如果这就是您想要做的，并且如果您将维护代码实际依赖的不变量的所有部分，您可能会创建 list field `protected`，但我建议您至少考虑添加另一个受保护的可能虚拟的，基类方法以支持较弱不变量的方式对其进行变异。

# entity-framework - 当我尝试在 EF 4.3.1 中启用迁移时引发异常

> ID：10999561
> 
> 赞同：11
> 
> 时间：2012-06-12T15:12:25.557
> 
> 标签：entity-framework, entity-framework-4, entity-framework-migrations

我在我的 .Net 4.0 类库项目中使用 nuget 安装的实体框架 4.3.1。在这种情况下，当我在 PM 控制台中调用“Enable-Migrations”命令时，会收到以下异常：

> 使用“1”参数调用“LoadFrom”的异常：“Nelze načíst soubor nebo sestavení file:///D:\ Users\DvoracekR\Documents\Visual Studio 2010\Projects\WebCameras\packages\EntityFramework.4.3.1\到 ols\EntityFramework.PowerShell.Utility.dll nebo jeden z jejich závislých prvků. Systém nemůže nalé zt uvedený soubor。在 D:\Users\DvoracekR\Documents\Visual Studio 2010\Projects\WebCameras\packages\EntityFramework.5。0.0-rc\tools\EntityFramework.psm1:393 char:62 + $utilityAssembly = [System.Reflection.Assembly]::LoadFrom <<<< ((Join-Path $toolsPath Entity Framework.PowerShell.Utility.dll)) + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : DotNetMethodException
> 
> 您不能在空值表达式上调用方法。在 D:\Users\DvoracekR\Documents\Visual Studio 2010\Projects\WebCameras\packages\EntityFramework.5。0.0-rc\tools\EntityFramework.psm1:394 char:50 + $dispatcher = $utilityAssembly.CreateInstance <<<< ( + CategoryInfo : InvalidOperation: (CreateInstance:String) [], RuntimeException + FullyQualifiedErrorId : InvokeMethodOnNull
> 
> 使用“8”参数调用“CreateInstanceFrom”的异常：“Typ System.Data.Entity.Migrations.EnableMigrationsCommand ze sestavení EntityFramework.PowerShell, Version=4.3.1.0, Culture=neutral, P ublicKeyToken=b77a5c561934e089 nelze načíst。” 在 D:\Users\DvoracekR\Documents\Visual Studio 2010\Projects\WebCameras\packages\EntityFramework.5。0.0-rc\tools\EntityFramework.psm1:418 char:31>+ $domain.CreateInstanceFrom <<<< ( + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : DotNetMethodException

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-14T08:56:10.053

我解决了上述问题。

1.  我使用 NuGet 包管理器卸载了实体框架。
2.  我手动清除了包目录中以“实体”开头的子目录。
3.  我再次安装了 Entity Framework 4.3.1

现在迁移已正确启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-02T13:41:21.657

我知道这是一个老问题，并且已经有一个公认的答案，但我遇到了这个问题，并认为我会分享我为解决它所做的工作。

* * *

我的解决方案是在源代码控制中，我搞砸了我的本地项目。我决定从源代码控制重新开始，所以我创建了一个新文件夹并从 SVN 签出代码。

当我这样做时，我不再能够创建迁移。我得到了上面列出的相同错误。我试过`Uninstall-Package EntityFramework`了，但收到了关于 EntityFramework 中缺少文件/引用的类似消息。

我回到我的旧文件夹并查看`$Project\packages\EntityFramework.6.0.2\`并将其与我的新文件夹进行比较。缺少几个 DLL/Xml 文件，因为它们不在源代码管理中。它们位于`\tools\`,`\lib\net40`和`\lib\net45\`目录中。

我只是将这些文件复制到我的新项目中，关闭/重新打开 Visual Studio，并进行了重建。之后，一切正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T15:04:10.387

重新安装 NuGet 包对我不起作用。起作用的是将项目从网络驱动器移动到本地驱动器。运行比较表明，除了目录之外`obj`，`bin`所有文件的二进制文件都是相同的。

如果我没记错的话，我最后一次尝试`Update-Database`是在我将项目移动到网络驱动器之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T03:39:37.697

我通过向他发送项目与大学共享项目时遇到了这个问题。当他把它发回给我时，我发现当我尝试添加迁移时，返回的项目给了我这个错误。我通过使用原始项目中的文件夹覆盖返回项目中的 packages\EntityFramework.5.0.0 文件夹来解决问题。

如果我只是在自己的机器上移动项目，我不会遇到问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-11T15:37:09.940

我对在 Visual Studio 2017 上打开的 Visual Studio 2015 中的项目有同样的问题。这是我解决它的方法：

1.  **从工具**中手动删除实体框架-> **NuGet 包管理器**->**从解决方案管理 NuGet 包**
2.  搜索**实体框架**。
3.  不幸的是，存在依赖关系。所以强制只删除实体框架根本不能解决问题。因此，无论依赖项是什么，请从上述步骤中手动将其删除。
4.  最后再次安装**实体框架和**您可能已删除的任何依赖项。完成此操作后，我没有重新启动我的 Visual Studio，在键入 enable-migrations 后，一切正常。

为了分享我的经验，我尝试了这一步：

> 卸载包EntityFramework -Force

然后为每个项目安装它：

> 安装包EntityFramework

但对我没有用。所以我猜我必须手动卸载它，包括它的依赖项而不使用强制并再次安装它才能工作。但很高兴它做到了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-16T11:02:15.983

当在同一台物理机器上使用不同的虚拟机时，这个问题开始发生在我身上。

VMWare Fusion 默认与 OS X 共享配置文件目录，这反过来又在使用多个安装了 Visual Studio 的 VM 时产生了很多问题，实际上我安装的几乎每个应用程序都开始出现奇怪的行为。当时应该敲响警钟。

通过关闭文件夹共享解决了这个问题，这不是很明显，因为我没有选择不共享配置文件文件夹，只能添加/删除其他文件夹。

希望我的愚蠢帮助了那里的其他人:)

# python - request.POST 中的每个值都是一个列表

> ID：10999564
> 
> 赞同：1
> 
> 时间：2012-06-12T15:12:33.417
> 
> 标签：python, django, forms

我遇到了问题，因为 request.POST 中的每个值都在列表中。所以每当我这样做时：

```
MyForm(request.POST) 
```

没有任何验证通过，因为它们需要字符串而不是列表。错误消息是这样的：

```
[u'13/04/2000'] is not a valid date 
```

是否有设置或需要更改的内容，以便我可以将 request.POST 传递给表单？我真的不想为每个字段做类似 request.POST.get(..) 的事情。

好的，这是我的表格：

```
class FormAddCourse(forms.Form):
    career = choice_field(Career)
    assignature = choice_field(Assignature)
    start_date = forms.DateField(label = spanish('col_name', 'start_date', True),
                                 help_text = "Formato: dd/mm/aaaa")
    end_date = forms.DateField(label = spanish('col_name', 'end_date', True),
                               help_text = "Formato: dd/mm/aaaa")
    day_choices = [('Mo', 'Lunes'), ('Tu', 'Martes'), ('We', 'Miércoles'), ('Th', 'Jueves'),
                   ('Fr', 'Viernes'), ('Sa', 'Sábado'), ('Su', 'Domingo')]
    days = forms.MultipleChoiceField(label = spanish('col_name_plural', 'day', True),
                                     widget = CheckboxSelectMultiple,
                                     choices = day_choices)
    length_choices = (
        ('S', spanish('choices', 'semesterly', True)),
        ('Y', spanish('choices', 'yearly', True)),
        )
    length = forms.ChoiceField(label = spanish('col_name', 'length', True),
                               widget = RadioSelect,
                               choices = length_choices)
    hours = forms.CharField(widget = HiddenInput,
                            max_length = 300,
                            validators=[validate_hours]) 
```

这是我的观点：

```
def add_course_view(request):
    if request.method == "GET":
        form = FormAddCourse()
        c = {'form': form}
        return render_to_response('crud/courses/add.html', c, RequestContext(request))
    elif request.method == "POST":
        try:
            hours = get_hours(request.POST)
            form_data = {'hours': hours}
            form_data.update(request.POST.copy())
            form = FormAddCourse(form_data)
            if form.is_valid():           # This thing never passes
                career = form.cleaned_data['career']
                assignature = form.cleaned_data['assignature']
                start_date = form.cleaned_data['start_date']
                end_date = form.cleaned_data['end_date']
                days = form.cleaned_data['days']
                length = form.cleaned_data['length']
                hours = form.cleaned_data['hours']
                credits = calculate_credits(valid_hours)
                # alter database
                # course = Course.objects.create(career=career, assignature=assignature, start_date=start_date, end_date=end_date, days=days, length=length, credits=credits, hours=hours)
                if u'submit_another' in request.POST:
                    # Submit and add another
                    messages.add_message(request, messages.SUCCESS, u"El curso ha sido guardado. Agregue otro.")
                    return redirect('crud.views.add_course_view')
                else:
                    # Submit and end
                    messages.add_message(request, messages.SUCCESS, u"El curso ha sido guardado.")
                    return redirect('ssys.views.homepage')
        except FieldError as e:
            # return user to complete form with fields already filled
            pass 
```

至于验证函数，唯一的自定义函数是 validate_hours，它实际上是唯一通过的函数，因为我手动将小时数添加到 form_data。

好的，我想出了问题所在，我可以附加到 request.POST.copy() 但我不能将它附加到字典中。谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:25:07.323

`request.POST`是一个[QueryDict，它是类字典类但不是字典](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.POST)。

你可以试试

```
form_data = request.POST.copy()
form_data.update({'hours': hours})

#instead of
form_data = {'hours': hours}
form_data.update(request.POST.copy()) 
```

但是，根据您的代码，`hours`也是从中获取的`request.POST`。那么为什么不只使用表单来处理所有字段呢？如果你在表格中做起来有困难或者有任何特殊的逻辑考虑，你可以在问题中说清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:20:10.803

您应该按如下方式实例化表单：

```
form = MyForm(request.POST)
if form.is_valid():
    pass 
```

在 Django 中获得基本的表单验证不需要其他代码。如果您需要添加值，`request.POST`则考虑创建隐藏的输入字段并在表单中包含预期的值。

# c++ - 使用 partial_sum 的累积向量值

> ID：10999571
> 
> 赞同：0
> 
> 时间：2012-06-12T15:12:47.707
> 
> 标签：c++, vector

假设我拥有的向量是<1, 2, 3>，我想得到累加值向量<1, 3, 6>。我猜 C++ 函数 partial_sum 就是这样做的。但是当我执行时这个功能不起作用（程序错误）。是否正确使用了 partial_sum？

```
vector<float> vv, vvSum;
vv.push_back(1); vv.push_back(2); vv.push_back(3);

partial_sum(vv.begin(), vv.end(), vvSum.begin(), plus<float>());

for(unsigned int i = 0; i < vvSum.size(); ++i)
{
    cout << vv[i] << " " << endl;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:18:08.120

不，`partial_sum`使用不当。

`vvSum`向量为空。在那种情况下，`vvSum.begin()`是一个结束迭代器，因此不能用于输出。

您可以调用`vvSum.resize(vv.size());`使其与原始大小相同，或使用`std::back_inserter(vvSum)`迭代器，根据需要增加容器的大小。

# excel - 如何根据另一列中的标识符选择一列中的多个单元格？

> ID：10999573
> 
> 赞同：1
> 
> 时间：2012-06-12T15:12:54.753
> 
> 标签：excel

Excel n00b 在这里。我可以用 Excel 做一些简单的事情（简单，意思是大多数人做不到的事情，但远不如专家做的事情）。

我一直在尝试不同的方法从一张没有很好组合的表格中提取数据（我从当地政府下载定期报告，所以我无法控制基本的 Excel 文件）。

该表有一个标识符列（原告/被告），然后在其下方有两个空单元格（占下一列）。下一列在一个单元格中包含派对的名称，然后下面的单元格有他们的地址。问题是它被格式化为合并单元格，因此一个单元格中的地址与第三个单元格合并。另一个问题是条目之间周期性地存在一个或多个空白行。看起来像这样（对不起，丑陋的格式）

```
IDENTIFIER          PARTY/ADDRESS
Plaintiff           DOE JOHN
                    1313 Mockingbird Lane <-row (merged, contains entire address)
                    Winchester, MA 00000

Defendant           DOE JANE
                    100 Whatever Way
                    Boston, MA 000000 
```

首先，如果满足条件，我尝试做这样的事情来复制名称：

```
=IF(A2 = "Defendant:", B2, "") 
```

这将复制名称。除了我不知道如何复制下一个单元格（实际上是两个，因为合并），所以我最终会得到：

```
 DOE JANE
                    100 Whatever Way
                    Boston, MA 000000 
```

由于额外的行，我无法`IF`对地址应用相同的语句。尝试选择“空白”行将不起作用，因为它会选择标识符下方的空单元格并选择“空”合并单元格 - 它会扭曲整个工作表。

我还尝试了条件格式，例如：

```
=OR($A2 = "Defendant:") 
```

并将颜色应用于该行，但同样，我不知道如何选择地址单元格。当我过滤颜色时，它只显示“被告：姓名”。

如果可能的话，我希望避免使用 VBA。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:35:58.597

您可能对这两个功能感兴趣：

*   `MATCH()`查找包含某个值的第一个单元格的索引。
*   `OFFSET()`从特定单元格中选择具有一定数量的行/列的单元格。

例如，在您的情况下，您可以使用公式来选择原告的地址：

```
=OFFSET(B1, MATCH("Plaintiff", $A$2:$A$20, 0), 0)
         ^     ^  ^---------^  ^--------^  ^   ^
       offset  |       |            |      |   column offset
     from here |   search for       |   do exact
               |      this          |     match
               |                where to 
           row offset            search 
```

# iphone - UIPickerView 看起来像 UIDatePicker 但有几秒钟

> ID：10999575
> 
> 赞同：22
> 
> 时间：2012-06-12T15:13:02.963
> 
> 标签：iphone, ios, xcode, ios5

我正在制作一个计时器应用程序，需要向用户显示小时、分钟和秒。我尝试使用`UIDatePicker`，但它只显示小时和分钟作为选择。不是秒。在网上做了一些研究后，我发现没有办法获得秒数，我不得不从头开始`UIDatePicker`编写自己的。`UIPickerView`

所以我的问题是，是否有这样的示例代码，即有人写了`CustomUIPickerView`几个小时、分钟和秒，我可以合并到我的项目中？`UIDatePicker`有一个很好的 Hours & Mins 文本覆盖，当用户旋转表盘时会保持不变。如果有人在他们的自定义选择器中添加它会很好。`UIPickerView`如果没有必要，我不想从头开始编写自定义。谢谢你。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-13T02:27:21.343

好的伙计们，这里是获取小时/分钟/秒的代码`UIPickerView`。您可以添加 3 个标签，并有策略地将它们放置在选择器上。我也附上了一张图片。

如果你喜欢这个答案，那就给它评分吧！优秀的开发人员会分享知识，而不是像某些人建议的那样隐藏它。玩得开心编码！

![在此处输入图像描述](../Images/795dac5fa5179c40888c592e35446600.png)

在你的头 .h 文件中放这个

```
@interface v1AddTableViewController : UITableViewController
{

    IBOutlet UIPickerView *pickerView;    
    NSMutableArray *hoursArray;
    NSMutableArray *minsArray;
    NSMutableArray *secsArray;

    NSTimeInterval interval;

}

@property(retain, nonatomic) UIPickerView *pickerView;
@property(retain, nonatomic) NSMutableArray *hoursArray;
@property(retain, nonatomic) NSMutableArray *minsArray;
@property(retain, nonatomic) NSMutableArray *secsArray; 
```

在你的 .m 文件中放这个

```
@synthesize pickerView;
@synthesize hoursArray;
@synthesize minsArray;
@synthesize secsArray;
@synthesize interval;

- (void)viewDidLoad
{
    [super viewDidLoad];

    //initialize arrays
    hoursArray = [[NSMutableArray alloc] init];
    minsArray = [[NSMutableArray alloc] init];
    secsArray = [[NSMutableArray alloc] init];
    NSString *strVal = [[NSString alloc] init];

    for(int i=0; i<61; i++)
    {
        strVal = [NSString stringWithFormat:@"%d", i];

        //NSLog(@"strVal: %@", strVal);

        //Create array with 0-12 hours
        if (i < 13)
        {
            [hoursArray addObject:strVal];
        }

        //create arrays with 0-60 secs/mins
        [minsArray addObject:strVal];
        [secsArray addObject:strVal];
    }

    NSLog(@"[hoursArray count]: %d", [hoursArray count]);
    NSLog(@"[minsArray count]: %d", [minsArray count]);
    NSLog(@"[secsArray count]: %d", [secsArray count]);

}

//Method to define how many columns/dials to show
- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 3;
}

// Method to define the numberOfRows in a component using the array.
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent :(NSInteger)component 
{ 
    if (component==0)
    {
        return [hoursArray count];
    }
    else if (component==1)
    {
        return [minsArray count];
    }
    else
    {
        return [secsArray count];
    }

}

// Method to show the title of row for a component.
- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{

    switch (component) 
    {
        case 0:
            return [hoursArray objectAtIndex:row];
            break;
        case 1:
            return [minsArray objectAtIndex:row];
            break;
        case 2:
            return [secsArray objectAtIndex:row];
            break;    
    }
    return nil;
}

-(IBAction)calculateTimeFromPicker
{

    NSString *hoursStr = [NSString stringWithFormat:@"%@",[hoursArray objectAtIndex:[pickerView selectedRowInComponent:0]]];

    NSString *minsStr = [NSString stringWithFormat:@"%@",[minsArray objectAtIndex:[pickerView selectedRowInComponent:1]]];

    NSString *secsStr = [NSString stringWithFormat:@"%@",[secsArray objectAtIndex:[pickerView selectedRowInComponent:2]]];

    int hoursInt = [hoursStr intValue];
    int minsInt = [minsStr intValue];
    int secsInt = [secsStr intValue];

    interval = secsInt + (minsInt*60) + (hoursInt*3600);

    NSLog(@"hours: %d ... mins: %d .... sec: %d .... interval: %f", hoursInt, minsInt, secsInt, interval);

    NSString *totalTimeStr = [NSString stringWithFormat:@"%f",interval];

} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-03-11T21:28:48.223

与上面公认的解决方案不同，我想出了一些不那么可怕的东西。绝对不是完美的，但它具有预期的效果（我只在 iPhone 上的 iOS 7 中测试过，只适用于所写的纵向）。欢迎进行编辑以使其更好。相关显示代码如下：

```
// assumes you conform to UIPickerViewDelegate and UIPickerViewDataSource in your .h
- (void)viewDidLoad
{
    [super viewDidLoad];

    // assumes global UIPickerView declared. Move the frame to wherever you want it
    picker = [[UIPickerView alloc] initWithFrame:CGRectMake(0, 100, self.view.frame.size.width, 200)];
    picker.dataSource = self;
    picker.delegate = self;

    UILabel *hourLabel = [[UILabel alloc] initWithFrame:CGRectMake(42, picker.frame.size.height / 2 - 15, 75, 30)];
    hourLabel.text = @"hour";
    [picker addSubview:hourLabel];

    UILabel *minsLabel = [[UILabel alloc] initWithFrame:CGRectMake(42 + (picker.frame.size.width / 3), picker.frame.size.height / 2 - 15, 75, 30)];
    minsLabel.text = @"min";
    [picker addSubview:minsLabel];

    UILabel *secsLabel = [[UILabel alloc] initWithFrame:CGRectMake(42 + ((picker.frame.size.width / 3) * 2), picker.frame.size.height / 2 - 15, 75, 30)];
    secsLabel.text = @"sec";
    [picker addSubview:secsLabel];

    [self.view addSubview:picker];
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 3;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    if(component == 0)
        return 24;

    return 60;
}

- (CGFloat)pickerView:(UIPickerView *)pickerView rowHeightForComponent:(NSInteger)component
{
    return 30;
}

- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{
    UILabel *columnView = [[UILabel alloc] initWithFrame:CGRectMake(35, 0, self.view.frame.size.width/3 - 35, 30)];
    columnView.text = [NSString stringWithFormat:@"%lu", (long) row];
    columnView.textAlignment = NSTextAlignmentLeft;

    return columnView;
} 
```

结果：

![H/M/S 选择器](../Images/65382de044c7617816f3a7712cc4ce69.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-04-09T10:50:52.297

迅速实施

```
class TimePickerView: UIPickerView, UIPickerViewDataSource, UIPickerViewDelegate {
    var hour:Int = 0
    var minute:Int = 0

    override init() {
        super.init()
        self.setup()
    }

    required internal init(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        self.setup()
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        self.setup()
    }

    func setup(){
        self.delegate = self
        self.dataSource = self

        /*let height = CGFloat(20)
        let offsetX = self.frame.size.width / 3
        let offsetY = self.frame.size.height/2 - height/2
        let marginX = CGFloat(42)
        let width = offsetX - marginX

        let hourLabel = UILabel(frame: CGRectMake(marginX, offsetY, width, height))
        hourLabel.text = "hour"
        self.addSubview(hourLabel)

        let minsLabel = UILabel(frame: CGRectMake(marginX + offsetX, offsetY, width, height))
        minsLabel.text = "min"
        self.addSubview(minsLabel)*/
    }

    func getDate() -> NSDate{
        let dateFormatter = NSDateFormatter()
        dateFormatter.dateFormat = "HH:mm"
        let date = dateFormatter.dateFromString(String(format: "%02d", self.hour) + ":" + String(format: "%02d", self.minute))
        return date!
    }

    func numberOfComponentsInPickerView(pickerView: UIPickerView) -> Int {
        return 2
    }

    func pickerView(pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {
        switch component {
        case 0:
            self.hour = row
        case 1:
            self.minute = row
        default:
            println("No component with number \(component)")
        }
    }

    func pickerView(pickerView: UIPickerView, numberOfRowsInComponent component: Int) -> Int {
        if component == 0 {
            return 24
        }

        return 60
    }

    func pickerView(pickerView: UIPickerView, rowHeightForComponent component: Int) -> CGFloat {
        return 30
    }

    func pickerView(pickerView: UIPickerView, viewForRow row: Int, forComponent component: Int, reusingView view: UIView!) -> UIView {
        if (view != nil) {
            (view as UILabel).text = String(format:"%02lu", row)
            return view
        }
        let columnView = UILabel(frame: CGRectMake(35, 0, self.frame.size.width/3 - 35, 30))
        columnView.text = String(format:"%02lu", row)
        columnView.textAlignment = NSTextAlignment.Center

        return columnView
    }

} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-10-16T02:26:53.217

我不喜欢不依赖于添加`UILabel`为子视图的答案`UIPickerView`，因为如果 iOS 决定某天改变外观，硬编码框架将会中断。

一个简单的技巧是将小时/分钟/秒标签作为**具有 1 行的组件**。

小时/分钟/秒标签将远离它们的值，但这没关系。大多数用户甚至不会注意到这一点。你自己看：

[![在此处输入图像描述](../Images/fde3e3d36ae0aef60a50bea80b7d7105.png)](https://i.stack.imgur.com/GO1K0.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-01T19:00:50.177

我对@Stonz2 的版本做了一些细微的改进。计算标签的y位置也有错误。

这里是 .h 文件

```
@interface CustomUIDatePicker : UIPickerView <UIPickerViewDataSource, UIPickerViewDelegate>

@property NSInteger hours;
@property NSInteger mins;
@property NSInteger secs;

-(NSInteger) getPickerTimeInMS;
-(void) initialize;

@end 
```

这里是带有改进的 .m 文件

```
@implementation CustomUIDatePicker
-(instancetype)init {
 self = [super init];
 [self initialize];
 return self;
}

-(id)initWithCoder:(NSCoder *)aDecoder {
 self = [super initWithCoder:aDecoder];
 [self initialize];
 return self;
}

-(instancetype)initWithFrame:(CGRect)frame {
 self = [super initWithFrame:frame];
 [self initialize];
 return self;
}

-(void) initialize {
self.delegate = self;
self.dataSource = self;

int height = 20;
int offsetX = self.frame.size.width / 3;
int offsetY = self.frame.size.height / 2 - height / 2;
int marginX = 42;
int width = offsetX - marginX;

UILabel *hourLabel = [[UILabel alloc] initWithFrame:CGRectMake(marginX, offsetY, width, height)];
hourLabel.text = @"hour";
[self addSubview:hourLabel];

UILabel *minsLabel = [[UILabel alloc] initWithFrame:CGRectMake(marginX + offsetX, offsetY, width, height)];
minsLabel.text = @"min";
[self addSubview:minsLabel];

UILabel *secsLabel = [[UILabel alloc] initWithFrame:CGRectMake(marginX + offsetX * 2, offsetY, width, height)];
secsLabel.text = @"sec";
[self addSubview:secsLabel];
}

-(void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
if (component == 0) {
    self.hours = row;
} else if (component == 1) {
    self.mins = row;
} else if (component == 2) {
    self.secs = row;
}
}

-(NSInteger)getPickerTimeInMS {
return (self.hours * 60 * 60 + self.mins * 60 + self.secs) * 1000;
}

-(NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView {
return 3;
}
-(NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
 if(component == 0)
     return 24;

 return 60;
}

- (CGFloat)pickerView:(UIPickerView *)pickerView rowHeightForComponent:(NSInteger)component
{
return 30;
}

-(UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view
{
if (view != nil) {
    ((UILabel*)view).text = [NSString stringWithFormat:@"%lu", row];
    return view;
}
UILabel *columnView = [[UILabel alloc] initWithFrame:CGRectMake(35, 0, self.frame.size.width/3 - 35, 30)];
columnView.text = [NSString stringWithFormat:@"%lu", row];
columnView.textAlignment = NSTextAlignmentLeft;

return columnView;
}

@end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-19T03:15:33.903

我这里有一个简单的解决方案，你可以为 UIPickerView 实现 UIPickerViewDataSource 的 3 个方法

```
 - (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView{
    return 5;
}
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component{
    switch (component) {
        case 0:
            return 24;
            break;
        case 1:
        case 3:
            return 1;
            break;
        case 2:
        case 4:
            return 60;
            break;
        default:
            return 1;
            break;
    }
}

- (NSString*)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
    switch (component) {
        case 1:
        case 3:
            return @":";
            break;
        case 0:
        case 2:
        case 4:
            return [NSString stringWithFormat:@"%lu", (long) row];
            break;
        default:
            return @"";
            break;
    }
} 
```

[![在此处输入图像描述](../Images/2f8d7be94d49c52c600446da283b230f.png)](https://i.stack.imgur.com/DUyIr.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-01T20:39:27.503

一种选择是使用 ActionSheetPicker

[https://github.com/skywinder/ActionSheetPicker-3.0](https://github.com/skywinder/ActionSheetPicker-3.0)

并利用 ActionSheetMultipleStringPicker。您可以按照 ActionSheetPicker 文档中的示例代码进行操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-19T14:41:32.510

这是“小时/分钟/秒”叠加的另一种解决方案。它使用`pickerView(UIPickerView, didSelectRow: Int, inComponent: Int)`选择器视图的委托中的方法来更新视图的标签。

这样，无论屏幕方向如何，它都可以工作。**它仍然不是最佳**的，但它非常简单。

[![UIPickerView 示例](../Images/0ba20dc47bcbb994c3c7eb93165b5a90.png)](https://i.stack.imgur.com/NEWEC.png)

```
func pickerView(_ pickerView: UIPickerView, viewForRow row: Int, forComponent component: Int, reusing view: UIView?) -> UIView {
    let label = UILabel()
    label.text = String(row)
    label.textAlignment = .center
    return label
}

func pickerView(_ pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {

    if let label = pickerView.view(forRow: row, forComponent: component) as? UILabel {

        if component == 0, row > 1 {
            label.text = String(row) + " hours"
        }
        else if component == 0 {
            label.text = String(row) + " hour"
        }
        else if component == 1 {
            label.text = String(row) + " min"
        }
        else if component == 2 {
            label.text = String(row) + " sec"
        }
    }
} 
```

要在显示选择器视图时显示覆盖，必须以编程方式选择行...

```
func selectPickerViewRows() {

    pickerView.selectRow(0, inComponent: 0, animated: false)
    pickerView.selectRow(0, inComponent: 1, animated: false)
    pickerView.selectRow(30, inComponent: 2, animated: false)

    pickerView(pickerView, didSelectRow: 0, inComponent: 0)
    pickerView(pickerView, didSelectRow: 0, inComponent: 1)
    pickerView(pickerView, didSelectRow: 30, inComponent: 2)
} 
```

# php - 写出 html 文件的 PHP CMS 教程

> ID：10999590
> 
> 赞同：0
> 
> 时间：2012-06-12T15:13:27.953
> 
> 标签：php, mysql, html, content-management-system

我想创建一个写出平面 html 文件的 cms，因此不涉及数据库。

这个想法是 CMS 将允许编辑和更新文件（用 php 编写，如果需要，可以使用 mysql 数据库），然后将这些更改保存/写出到 html 文件，而不是拥有一个依赖于 php 站点mysql调用来获取数据。

我的问题；这样的事情已经存在了吗？我这样做是不是让自己的事情变得更加困难？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:18:15.813

只需在Google上[搜索](https://www.google.com/search?sugexp=chrome,mod=17&sourceid=chrome&ie=UTF-8&q=no%20database%20cms)[无数据库 cms](https://www.google.com/search?sugexp=chrome,mod=17&sourceid=chrome&ie=UTF-8&q=no%20database%20cms)，就会出现许多选项。有一种叫做[gpEasy](http://www.makeuseof.com/tag/gpeasy-simple-cms-no-database/)的软件可能适合您的需求。我不建议重写已经存在的东西

[这是一个关于无数据库 cms 的不错的博客](http://www.instantfundas.com/2009/09/blogging-without-database-7-database.html)

如果您已经在使用数据库来存储文件，那么使用 wordpress 之类的东西有什么问题？此外，如果您只是不喜欢 wordpress 而这是一个专为您设计的网站，为什么不使用您计算机上的程序来创建该网站，然后将该网站上传到您的服务器？

但是，如果您真的想制作自己的 cms，我的建议是看一下已经开发的 cms，然后对其进行修改以更好地满足您的需求，或者查看并创建自己的 cms。这将为您在创建自己的参考时提供很好的参考，因为您已经有一个可以使用的参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T13:22:34.887

准系统 CMS 听起来可能符合要求：

[http://barebonescms.com/](http://barebonescms.com/)

它不使用 MySQL，它的内置缓存系统输出静态 HTML 文件。它使用一点 PHP 来引导缓存，但根据网站的不同，这可以使用一些 Web 服务器规则（例如 .htaccess）完全绕过，或者只是将静态文件推送到生产盒上的正确位置并重命名它们（需要为每个页面使用一个子目录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:40:22.087

编写静态 html 页面的 CMS 需要什么？

如果是出于性能问题，您仍然可以制作“常规”CMS 并将输出缓存为 html 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T07:04:51.443

$gem 安装中间人

Middleman 是一个命令行工具，用于使用现代 Web 开发环境的所有快捷方式和工具创建静态网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-13T07:16:51.717

您也可以尝试使用您喜欢的 cms 或其他方式在本地制作完整站点，最后使用[httrack](http://www.httrack.com/)或任何等效程序对其进行传递以获取静态版本

# perl - CSH 将 $* 传递给 perl 脚本不起作用

> ID：10999594
> 
> 赞同：1
> 
> 时间：2012-06-12T15:13:35.730
> 
> 标签：perl, csh

我正在用 csh 编写一个 shell 脚本，其中一个功能是执行一个接受参数的 perl 脚本。

csh 脚本本身接受命令行参数（存储为 $* 中的空格分隔值），我将其传递给 perl 脚本。

我的问题是当我运行时：

`perl myscript.pl --args $*`

perl 脚本只获取 $* 中的第一个参数。但是，如果我运行：

`echo $*`从 csh 脚本中，它会正确打印出所有参数。

可以传递任意数量的参数（因此我不能将我的参数存储在静态变量中并传递它们）。

有谁知道为什么会这样以及我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:32:15.307

您需要`$*`在 csh 脚本中引用：

```
perl myscript.pl --args "$*" 
```

这里是`myscript.pl`：

```
use warnings;
use strict;
use Getopt::Long;
use Data::Dumper;

my %opt;
GetOptions(\%opt, 'args=s');
print Dumper(\%opt); 
```

我是这样称呼它的：

```
script.csh arg1 arg2

$VAR1 = {
          'args' => 'arg1 arg2'
        }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:17:56.217

如果您希望参数以数组结尾而不在每个参数之前放置 --args，您可以使用 Getopt::Long 的实验性多值语法：

```
GetOptions("args=s{,}" => \@my_args); 
```

见[https://metacpan.org/module/Getopt::Long#Options-with-multiple-values](https://metacpan.org/module/Getopt::Long#Options-with-multiple-values)

# session - Elmah - 记录会话特定信息

> ID：10999595
> 
> 赞同：2
> 
> 时间：2012-06-12T15:13:36.690
> 
> 标签：session, elmah

我想将会话中的一些附加信息添加到 Elmah 日志中。它是会话中的 UserID，因此我们知道错误与谁有关。我一直在尝试将 ErrorLog_Logged 添加到 global.ascx。如何向错误详细信息添加一些附加信息，以便我可以在 axd 文件中看到用户 ID。干杯，克里斯。

# java - 当你不知道它所包含的参数类型时如何设计一个抽象方法（构建一个框架）

> ID：10999597
> 
> 赞同：1
> 
> 时间：2012-06-12T15:13:38.763
> 
> 标签：java, design-patterns, frameworks

我正在设计一个框架来管理我们的移动客户端上的某些 api 调用和其他长期运行的任务。我将在一个基本的 java 程序上设计和实现它，然后可以将它传递给客户端开发人员以扩展框架中的类并实现它们的具体类，它们在其中执行特定于上下文的工作。

有一个地方，管理器会向正在等待任务的组件发送通知。现在在`AbstractManager`我有一个方法称为`registerClient(Messenger m)`客户端可以将自己注册为侦听器，以便他们可以知道任务何时完成。

现在，如果我想让它保持抽象，我不能说它是一个`Messenger`对象，每个应用程序和平台可能使用不同的通知实现。我该如何设计它以便`registerClient`可以以任何方式实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:19:28.173

您可以提供一个接口（例如`IMessenger`），每个信使对象都需要实现该接口并使其成为参数的类型

```
registerClient(IMessenger m) 
```

如果您为接口选择了正确的方法（与您现在的大部分方法相同`Messenger`），您可以提供可以在`registerClient()`方法中使用的接口的多个实现

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:17:13.287

使其通用，因此您的方法将是 registerClient(T messenger)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:17:31.210

创建 API 时，**接口**和**泛型**是你最好的朋友。当然，您并不确切知道会发生什么，但是通过为用户提供他们必须实现的界面，您可以确定您可以使用他们决定使用的任何具体实现来完成您需要的工作。

# java - 是否可以在 Java 中将文件编码为数据 URI？

> ID：10999600
> 
> 赞同：0
> 
> 时间：2012-06-12T15:13:49.277
> 
> 标签：java, file, data-uri, data-url

我需要在 Java 中将文件编码为数据 URI，我可以按以下格式检索它吗？

```
data:application/octet-stream;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA== 
```

我一直在寻找类似的东西，但到目前为止还没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T01:16:04.637

我认为没有专门用于创建它的实用程序函数，但它应该很简单：

```
import org.apache.commons.codec.binary.Base64;

byte[] toEncode = { 0xaa, 0xbb, 0xcc };
Base64 base64NoLineWrap = new Base64(0);
String encodedData = base64NoLineWrap.encodeBase64String(toEncode);
String dataUri = "data:application/octet-stream;base64," + encoded; 
```

# mysql - MySQL共享表或每个数据库中的表

> ID：10999601
> 
> 赞同：-1
> 
> 时间：2012-06-12T15:13:49.707
> 
> 标签：mysql, database, performance, select

我有这样的情况，在我的系统中有很多数据库，对于一些查询，我需要使用同一个表“小时”，它基本上有一个字段“h”并存储小时，如“00”，...，“23 '。

我的问题是关于效率，是创建单独的数据库并将该表存储在那里还是在每个数据库中都有这个表更好。我的查询将如下所示：

```
SELECT ... FROM hours CROSS JOIN some_table ... 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:17:02.147

无论哪种方式，您都必须修改所有“非本地”查询才能使用该表

```
SELECT ...
FROM sometable
CROSS JOIN dbname.hours 
```

如果它卡在自己的数据库中，那么您必须修改所有查询。如果它在“真实”数据库之一中，您只需修改 n-1 个查询。另外，如果您为不同的数据库使用多个不同的 mysql 帐户，则必须对该表授予适当的权限。

# android - 使用套接字的 Android 文件传输

> ID：10999602
> 
> 赞同：0
> 
> 时间：2012-06-12T15:13:49.993
> 
> 标签：android, sockets, android-wifi, android-internet

我一直在研究一个android程序。该程序的一部分使用套接字连接与 Web 服务交互，发送平均约为 320 kB 的文件。在桌面上运行的代码传输大约需要 1.5 分钟。使用我的安卓手机 (Atrix) 似乎需要大约一个小时。手机连接到wifi，所以我没想到它需要这么长时间。我最初的想法是添加一个 wifi 锁，但它没有任何帮助。

我在异步任务中运行了实际的上传（为了阅读，我将其中的一些设为伪）

```
@Override
protected void onPreExecute() 
{
    //Before starting the task show the uploading dialog
    uploadingDialog.show();

}
@Override
protected void onPostExecute(final Boolean success) {
    //After the task close the dialog
    uploadingDialog.dismiss();
}
@Override
protected Boolean doInBackground(String... params) {
    //Upload the files in the background

    //keep track of upload results
    boolean uploaded = true;
    boolean temp;

    //lock wifi on and stop the program from sleeping
    _keepOnStart();

    //Upload each file individually
    for(int i=0; i <= fileNameList.size()-1; i++){
        //this method does the actual writing to the socket/converts
        //the file to a byte array etc.
        temp = serverConnection.uploadWord(fileNameList.get(i));
        if(temp == false) {
            uploaded = false;
        }
    }
    _keepOnStop();
    return uploaded;
}
private void _keepOnStart() {
    if (_powerManagement == null) {
        _powerManagement = (PowerManager) ctx.getSystemService(Context.POWER_SERVICE);
    }
    if (_wakeLock == null) {
        _wakeLock = _powerManagement.newWakeLock(   PowerManager.PARTIAL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP | PowerManager.ON_AFTER_RELEASE,
                                                    "0 Backup power lock");
    }
        _wakeLock.acquire();
        WifiManager wifiManager = (WifiManager) ctx.getSystemService(Context.WIFI_SERVICE);
        if (wifiManager != null) {
            _wifiLock = wifiManager.createWifiLock("0 Backup wifi lock");
            _wifiLock.acquire();
        }
}

private void _keepOnStop() {
    if ((_wifiLock != null) && (_wifiLock.isHeld())) {
        _wifiLock.release();
    }
    if ((_wakeLock != null) && (_wakeLock.isHeld())) {
        _wakeLock.release();
    }
} 
```

在代码的桌面版本上，我只是在计时“serverConnection.uploadWord(fileNameList.get(i));” 具有设定的文件名。该方法本身从文件中获取字节数据，创建一个要发送到服务器的数据包，然后将其发送出去。

我的一些清单权限：

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

我想知道是否有人可以为此提供解释。我的假设是设备正在使用它的数据连接，但同时设备上只允许使用后台数据，并且我看到过去 7 天没有数据使用。

（非常感谢任何和所有帮助。如果我不清楚，请告诉我。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:29:11.383

对于任何关注相同事物的人。看来这是正确的做法。大量时间是在发送数据之前完成的非常低效的编码方案的衍生物。（它没有很好地扩展）

# php - 在 CodeIgniter 中加载配置并设置配置值

> ID：10999607
> 
> 赞同：0
> 
> 时间：2012-06-12T15:13:54.817
> 
> 标签：php, codeigniter, config

我尝试使用后端和前端创建应用程序。文件夹结构如下（只显示配置文件位置来说明问题）

```
+root
|-admin
|-application
  |—backend
    |—config
      |—config.php
  |—frontend
    |—config 
      |—config.php
|-system 
```

使用后端管理面板，我尝试更改后端和前端 config.php 值中的配置值。但我无法在前端 config.php 文件中更改它。我不需要基于数据库的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:49:55.110

阅读[文档](http://codeigniter.com/user_guide/libraries/config.html)我得到了这个：

`Note: CodeIgniter always tries to load the configuration files for the current environment first. If the file does not exist, the global config file (i.e., the one in application/config/) is loaded. This means you are not obligated to place all of your configuration files in an environment folder − only the files that change per environment.`

因此，基于这些信息，我认为问题出在您何时调用它，可能是您的路径有问题。

# java - 通过 JDBC 通过 MYSQL 存储过程插入韩语字符给出错误

> ID：10999609
> 
> 赞同：1
> 
> 时间：2012-06-12T15:14:01.927
> 
> 标签：java, mysql, unicode, jdbc, utf-8

我相信我正在为 jdbc 连接使用正确的 queryString 参数

```
jdbc:mysql://localhost:3306/databasename?useUnicode=true&characterEncoding=utf8&noAccessToProcedureBodies=true 
```

我的数据库已[正确设置](http://dev.mysql.com/doc/refman/5.1/en/faqs-cjk.html#qandaitem-B-11-1-2)为支持 utf-8（默认字符变量）。

```
character_set_client utf8
character_set_connection utf8
character_set_database latin1
character_set_filesystem binary
character_set_results utf8
character_set_server latin1
character_set_system utf8 
```

我的 sproc 在必要时将每个参数定义为 utf8

```
IN _shortDesc MEDIUMTEXT character set utf8, 
```

通过 MySQLWorkbench 调用存储过程按预期工作。但是，从 Java 调用它会导致异常

```
java.sql.SQLException: Incorrect string value: '\xAC\xED\x00\x05t\x00...' for column '_shortDesc' 
```

有趣的是，将相关字段的 sproc 定义更改为`utf16`or`ucs2`不会导致表中出现错误的韩文字符。

在 Java 中构建 sql 参数时，我也尝试过使用字节数组

```
getBytes(Charset.forName("UTF-8")) 
```

但是仍然抛出异常。

设置它以通过存储过程将 CJK 字符通过 Java 正确传递到 MySQL 的正确方法是什么？

***编辑*** 我正在使用 spring 框架中的 SimpleJdbcCall

```
DriverManagerDataSource ds = new DriverManagerDataSource();
ds.setDriverClassName("com.mysql.jdbc.Driver");
ds.setUrl("jdbc:mysql://server/test?characterEncoding=utf8");
ds.setUsername("user");  
ds.setPassword("pass");

// must explicitly declare params
SimpleJdbcCall jdbc = new SimpleJdbcCall(ds)
    .withProcedureName("sp_gms_addGameTranslationsTest");

SqlParameterSource in = new MapSqlParameterSource()
    .addValue("_test", "그러나 사디라");

jdbc.execute(in); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T13:47:47.850

根本问题是我正在使用 springframework`SimpleJdbcCall`来执行存储过程。这通过使用数据库元数据为您解决问题来简化配置。通过在使用该对象时显式声明我的输入参数，调用工作正常。

例如

```
DriverManagerDataSource ds = new DriverManagerDataSource();
ds.setDriverClassName("com.mysql.jdbc.Driver");
ds.setUrl("jdbc:mysql://server/test?characterEncoding=utf8");
ds.setUsername("user");  
ds.setPassword("pass");

// must explicitly declare params
SimpleJdbcCall jdbc = new SimpleJdbcCall(ds)
    .withProcedureName("sp_gms_addGameTranslationsTest")
    .declareParameters(
        new SqlParameter("_test", Types.VARCHAR)
);

SqlParameterSource in = new MapSqlParameterSource()
    .addValue("_test", "그러나 사디라");

jdbc.execute(in); 
```

我意识到这个答案不可能从我原来的问题中得出，所以我添加了一个编辑。

# xml - 使用 XML 修改带有链接的 Docx

> ID：10999610
> 
> 赞同：1
> 
> 时间：2012-06-12T15:14:05.250
> 
> 标签：xml, hyperlink, ms-word, nant, docx

我目前的目标有点复杂，但我会尽力解释它。我们有一个软件在过去几个月一直在生成所有使用的 XML 日志。其他人已经从这些数据中解析出他们认为需要的文档并将其全部放入可读的 HTML 格式中。

我的工作是找到一种方法将他们生成的可读 HTML 文件与预先存在的 Word (.docx) 文档链接起来。我目前有一个 NAnt 脚本，它读取包含日志的目录并创建一个 XML 文档，格式如下：

```
<root> 
    <HTML address=...>
        <ProductName name=...>
            <FunctionName name=...>
            </FunctionName>
        </ProductName>
    </HTML>
</root> 
```

word 文档本身包含保存函数名称的表。这些表格位于包含产品名称的标题下方。我需要在表内的函数名称周围包装与函数关联的地址的链接，以便阅读文档的人可以轻松单击函数名称并查看函数的文档。

我没有在程序上修改 word 文档的经验，所以我真的很想得到这方面的帮助，因为这似乎是一个相当复杂的过程。如果可以以任何方式简化流程，我可以轻松地重新排序 XML 节点。

到目前为止我研究过的东西：

*   在研究 docx 的格式之前，我想编写另一个脚本来简单地搜索相关数据，然后将超链接标签包裹在它周围。不幸的是，一旦我查看了 docx，格式似乎比这要复杂得多。

*   在那之后，我决定通过 Visual Studio 2010 研究使用 C#。不幸的是，由于我没有使用 C# 的经验（我只使用过 C 和 C++），所以它相当混乱。我花了几天时间寻找指南和参考资料，但这些都非常分散，我似乎找不到我要找的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T23:12:35.480

工具包的三种技术：

1.  **自定义 XML 数据绑定**。有了这个，您可以将 XML 文档注入您的 docx，并自动显示数据（通过 XPath 链接）。虽然不在超链接内，所以这可能不适合您。虽然您可以在 Word 中首次打开 docx 时运行 AutoOpen 宏，以将文本转换为超链接。

2.  **替代块**。有了这个，你可以在你的 docx 中包含 HTML。不过，您需要修改 docx。（见下文 3）

3.  **平面 OPC XML**。这是将 docx 表示为单个 XML 文件，Word 2007 或更高版本可以愉快地读取或写入。使用它，您可以使用您选择的工具对超链接的内容进行字符串替换。如果需要，您还可以使用此表示形式轻松地将内容注入 AltChunks。

替换超链接的小挑战是您必须在两个地方进行。首先，在文档本身 (document.xml) 中向用户显示的链接文本，其次是目标 URL（在关系部分中）。这些通过 relId 绑定在一起。

如果你使用 AltChunk，你可以在一个地方替换。不确定您的文档有多长，以及如果您有数百个 AltChunk（即使它们基本上只包含一个超链接），您是否会遇到性能问题。

这是一个包含 HTML AltChunk 的 Flat OPC XML 文件的示例（您应该能够将其保存并拖动到 Word 或执行 File > Open）：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<pkg:package xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">
    <pkg:part pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:name="/_rels/.rels">
        <pkg:xmlData>
            <rel:Relationships xmlns:rel="http://schemas.openxmlformats.org/package/2006/relationships">
                <rel:Relationship Id="rId1" Target="word/document.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"/>
            </rel:Relationships>
        </pkg:xmlData>
    </pkg:part>
    <pkg:part pkg:contentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml" pkg:name="/word/document.xml">
        <pkg:xmlData>
            <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" >
                <w:body>
                    <w:altChunk r:id="rId2"/>
                    <w:sectPr>
                        <w:pgSz w:code="1" w:h="15840" w:w="12240"/>
                        <w:pgMar w:bottom="1440" w:left="1440" w:right="1440" w:top="1440"/>
                    </w:sectPr>
                </w:body>
            </w:document>
        </pkg:xmlData>
    </pkg:part>
    <pkg:part pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:name="/word/_rels/document.xml.rels">
        <pkg:xmlData>
            <rel:Relationships xmlns:rel="http://schemas.openxmlformats.org/package/2006/relationships">
                <rel:Relationship Id="rId2" Target="../chunk.html" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"/>
            </rel:Relationships>
        </pkg:xmlData>
    </pkg:part>
    <pkg:part pkg:compression="store" pkg:contentType="text/html" pkg:name="/chunk.html">
        <pkg:binaryData>PGh0bWw+PGJvZHk+PHA+PGEgaHJlZj0iaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tIj5TdGFja092ZXJmbG93PC9hPjwvcD48L2JvZHk+PC9odG1sPg==</pkg:binaryData>
    </pkg:part>
    <pkg:part pkg:contentType="application/vnd.openxmlformats-package.relationships+xml" pkg:name="/_rels/chunk.html.rels">
        <pkg:xmlData>
            <rel:Relationships xmlns:rel="http://schemas.openxmlformats.org/package/2006/relationships"/>
        </pkg:xmlData>
    </pkg:part>
</pkg:package> 
```

二进制数据是

```
"<html><body><p><a href="http://stackoverflow.com">StackOverflow</a></p></body></html>" 
```

base64 编码（根据 Flat OPC XML 格式的要求）。

# iphone - iphone获取3G DNS主机名和ip地址

> ID：10999612
> 
> 赞同：4
> 
> 时间：2012-06-12T15:14:11.443
> 
> 标签：iphone, dns

是否可以在 Objective C / C / C++ 中获取 3G / Cell 数据连接的当前 DNS 服务器 IP 地址？

环顾四周，找不到确切的答案。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-13T20:14:40.690

```
#include <arpa/inet.h>
#include <ifaddrs.h>
#include <resolv.h>
#include <dns.h>

// 
- (NSString *) getDNSServers 
{
    NSMutableString *addresses = [[NSMutableString alloc]initWithString:@"DNS Addresses \n"];

    res_state res = malloc(sizeof(struct __res_state));

    int result = res_ninit(res);

    if ( result == 0 )
    {    
        for ( int i = 0; i < res->nscount; i++ )
        {
            NSString *s = [NSString stringWithUTF8String :  inet_ntoa(res->nsaddr_list[i].sin_addr)];
            [addresses appendFormat:@"%@\n",s];
            NSLog(@"%@",s);
        }
    }
    else 
        [addresses appendString:@" res_init result != 0"];

    return addresses;
    } 
```

# .htaccess - .htaccess 移动重定向到子文件夹和桌面视图按钮

> ID：10999615
> 
> 赞同：0
> 
> 时间：2012-06-12T15:14:17.467
> 
> 标签：.htaccess, mobile, desktop

我有一个 .htaccess 文件，其中包含以下内容：

```
RewriteCond %{REQUEST_URI} !^/mobiledirectoryhere/.*$
RewriteCond %{HTTP_USER_AGENT} "android|blackberry|ipad|iphone|ipod|iemobile|opera mobile|palmos|webos|googlebot-mobile" [NC]
RewriteRule ^(.*)$ /mobiledirectoryhere/ [L,R=302] 
```

一切都很好，从手机查看时效果很好 - 它检测并直接进入移动站点所在的子文件夹。但我想弄清楚的是如何在移动网站底部有一个链接，允许用户查看桌面版本。当他们在桌面版本上时，我希望他们能够回到移动设备上......

谁能帮我？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:26:47.067

至于“查看桌面版”链接，应该只是移动端的HTML修改吧？

但是，为了在用户选择该选项后让他们留在桌面站点上，您需要实现一种方法来跟踪他们的客户端偏好，例如 cookie。下面是一些关于在重写规则中添加基于 cookie 的条件的信息：[How to do htaccess redirect based on cookie value](https://stackoverflow.com/questions/3978726/how-to-do-htaccess-redirect-based-on-cookie-value)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:31:25.387

是的，使用 cookie。您可以使用 [CO] 标志设置它们，并通过 %{HTTP_COOKIE} 条件询问它们，例如将 cond 添加到规则

```
 RewriteCond %{HTTP_COOKIE} !force_desktop 
```

并检测（未）设置的 URI 以清除/设置 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:38:00.677

我不会使用 cookie，因为这对于首次访问者或 cookie 设置为禁用的用户可能无法正常工作。我会添加一个预定义的 GET 参数，强制网站转到非移动版本。

一个示例：如果您的域是 www.fancysite.com，则可能是 www.fancysite.com/nomobile。对于“nomobile” URL，您在 .htaccess 中定义自动转发。将此重写规则使用 [L] 条件，以便忽略其他条件。如果“nomobile”字符串不存在，您的（已经工作的）用户代理检测就会启动，并且用户会到达移动站点。

请参阅这些以获取一些详细信息（尤其是在“条件”下）：

[http://www.addedbytes.com/for-beginners/url-rewriting-for-beginners/](http://www.addedbytes.com/for-beginners/url-rewriting-for-beginners/)

[http://www.cheatography.com/davechild/cheat-sheets/mod-rewrite/](http://www.cheatography.com/davechild/cheat-sheets/mod-rewrite/)

# google-maps-api-3 - 我怎样才能找到表面的类型（地名）是那个点？

> ID：10999617
> 
> 赞同：0
> 
> 时间：2012-06-12T15:14:29.730
> 
> 标签：google-maps-api-3

我对 lat-long 有一个观点，我想知道那个点是什么类型的表面（地名）：房子、道路、土地等。我怎么能用 google api 做到这一点？我找不到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:05:31.257

Google 地图 API 没有提供解决方案来解决这个问题。

# jquery - 模拟点击jQuery, 歌剧

> ID：10999621
> 
> 赞同：4
> 
> 时间：2012-06-12T15:14:35.173
> 
> 标签：jquery, file, file-upload, opera

我有没有显示的表格和输入类型的文件，我还做了一个按钮。当你点击它应该打开下载对话框。这种组合适用于除 Opera 之外的所有浏览器。如果删除显示开始工作：无；

```
<form id="imageform" method="post" enctype="multipart/form-data" action='' style="display: none;">
    <input type="file" name="photoimg" id="photoimg" />
</form>
<input type="button" id="upload" value="upload"> 
```

查询：

```
$('#upload').on("click", function () {
    $('#photoimg').click();
}); 
```

请解释一下，如何避免这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:16:22.883

如果你使用`visibility: hidden`代替会更好`display:none`

或者您可以尝试使用纯 CSS。例如：

```
#photoimg {
   left: -99999px
} 
```

或者

```
#photoimg {
   z-index: -999
} 
```

或者

```
#photoimg {
   width: 0px
} 
```

或类似的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T03:19:24.247

`display: none`您可以这样做，而不是制作文件输入元素：

```
<div style="width:0;height:0;overflow:hidden;">
    <form id="imageform" method="post" enctype="multipart/form-data" action="">
        <input type="file" name="photoimg" id="photoimg" accept="image/*"
           onchange="document.getElementById('imageform').submit();" />
    </form>
</div>
<button id="upload" onclick="document.getElementById('photoimg').click();">
Upload</button> 
```

# delphi - 德尔福、二维码、WMF

> ID：10999623
> 
> 赞同：0
> 
> 时间：2012-06-12T15:14:36.270
> 
> 标签：delphi, crc, metafile

我得到了一份“新工作”来使用 QR 过滤器“归档”一些数据。

当数据结构修改并保存到数据库时，我们使用 WMF 过滤器开始“静默打印”，我捕获文件，并将它们全部存储在日志记录中，在数据库 BLOB 中。

一切都很好，但后来他们需要避免重复相同的报告。

我们禁用了“时间戳 QR 字段”，但记录重复了。

我在数据库中放入了一些 CRC，并从页面数据 (WMF) 中计算出来。

有趣的是，当我退出程序时，新生成的 WMF 发生了变化——因此 CRC 也发生了变化。

我认为这是由 QR 引起的，然后我用一个简单的 Delphi 程序进行了检查：

```
procedure TForm1.BitBtn1Click(Sender: TObject);
var
    WMF : TMetaFile;
    mfc : TMetaFileCanvas;
begin
    WMF := TMetaFile.Create;
    mfc := TMetaFileCanvas.Create(WMF, 0);
    try
        WMF.Width := 1000;
        WMF.Height := 1000;
        mfc.Brush.Color := clRed;
        mfc.FillRect(Rect(0, 0, 100, 100));
    finally
        mfc.Free;
        WMF.SaveToFile('test1.wmf');
        WMF.Free;
    end;
end; 
```

当我重新启动应用程序时，新的 wmf 文件与以前的不同。

我认为我解决了将 wmf 拉伸到 bmp.Canvas 中的问题，但这减慢了日志记录，因为每个 bmp 都是 4 MB，并且有 10 个页面我必须在 4 * 10 MB 上进行 CRC ...（WMF每页只有 85-100 KB，而 4 MB 位图）

所以我正在寻找一些可以在 WMF 上计算 CRC 的简单方法，也许如果我可以完全拆分 WMF 标头，那么我就可以解决这个问题......我现在不知道。

你有什么想法吗？请告诉我！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:45:32.607

将报告导出为文本，然后比较其 crc。

这是最简单的解决方案。

您也可以枚举元文件元素，但这会更加困难。

# python - 多个协议的单一工厂？

> ID：10999627
> 
> 赞同：0
> 
> 时间：2012-06-12T15:14:43.370
> 
> 标签：python, twisted

我正在尝试实现一个侦听 2 个独立 TCP 端口的网络协议。一种用于控制信息，一种用于数据信息。我知道我需要两个单独的协议类，因为涉及两个端口。我希望有一个工厂来创建这两种协议，因为它们之间共享状态信息和数据，并且它们必须实现一个协议。

这可能吗？如果是，如何？如果没有，我怎样才能实现类似的目标？

我知道在 2 个端口之间划分协议是不寻常的，但这是给定的情况。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:26:51.853

您的工厂`buildProtocol`可以退回您希望退回的任何东西。这取决于你。

但是，如果您只使用两个不同的工厂，您可能会发现事情要简单得多。这并不排除共享状态。只需让它们共享一堆属性，或者将所有状态集中到一个新对象上，然后让工厂共享*该*对象。

# java - 使用 Spring-Test-MVC 单元测试 Spring-Security - 集成 FilterChain / ServletFilter

> ID：10999631
> 
> 赞同：4
> 
> 时间：2012-06-12T15:15:01.553
> 
> 标签：java, spring, spring-mvc, spring-security, servlet-filters

所以我们几乎达到了测试驱动我们的 spring web-mvc 应用程序的目标。我们正在使用 Spring Security 来保护 URL 或方法，并且我们希望使用 Spring-Web-Mvc 来测试控制器。问题是：Spring 安全性依赖于 web.xml 中定义的 FilterChain：

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping> 
```

虽然 spring-web-mvc 即使使用[自定义上下文加载器](https://github.com/SpringSource/spring-test-mvc/blob/master/src/test/java/org/springframework/test/web/server/samples/context/GenericWebContextLoader.java)也只能加载通常的应用程序上下文内容：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(loader = WebContextLoader.class, locations = {
        "file:src/main/webapp/WEB-INF/servlet-context.xml", "file:src/main/webapp/WEB-INF/dw-manager-context.xml" })
public class MvcTest {

    @Inject
    protected MockMvc mockMvc;

    @Test
    public void loginRequiredTest() throws Exception {

        mockMvc.perform(get("/home")).andExpect(status().isOk()).andExpect(content().type("text/html;charset=ISO-8859-1"))
        .andExpect(content().string(containsString("Please Login")));
    }

} 
```

如您所见，我们设置了我们的网络应用程序，以便在调用 /home 时会提示匿名用户登录。这与 web.xml 一起工作正常，但我们不知道如何将其集成到我们的测试中.

有什么方法可以向 spring-test-mvc 添加过滤器？

现在我想我可能必须从开始`GenericWebContextLoader`，深入研究`MockRequestDipatcher`哪些实现`RequestDispatcher`，以某种方式添加一个过滤器，然后告诉`GenericWebContextLoader`使用我的实现......但我对整个网络堆栈非常不熟悉，并且更喜欢一个更简单的解决方案，可以帮助我避免深入研究这些东西......

有什么想法/解决方案吗？

无论如何，我将如何手动添加过滤器？web.xml 不能是唯一这样做的地方......

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T09:42:24.943

也许你可以模拟过滤器链。Spring中有一个[类](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/mock/web/MockFilterChain.html)可以做到这一点。代码看起来像：

```
 MockHttpServletRequest request = new MockHttpServletRequest();
     request.setServletPath("/foo/secure/super/somefile.html");

     MockHttpServletResponse response = new MockHttpServletResponse();
     MockFilterChain chain = new MockFilterChain(true);

     filterChainProxy.doFilter(request, response, chain); 
```

然后，您可以将 org.springframework.web.filter.DelegatingFilterProxy 实例添加到代码中的链中。就像是：

另请参阅[此](http://forum.springsource.org/showthread.php?53466-Spring-security-unit-test)论坛主题。

# powershell - Powershell将可执行文件输出到文本文件中

> ID：10999635
> 
> 赞同：1
> 
> 时间：2012-06-12T15:15:17.153
> 
> 标签：powershell

我正在尝试为工作编写一个 Powershell 脚本，它将获取 w32tm.exe \monitor 的输出并将所有内容输出到文本文件中。我正在尝试以下代码，但是由于我能够创建文本文件，因此出现了问题，但其中没有写入任何内容：

```
#Take output of w32tm.exe and output into a plain text file
$file = "C:\Documents and Settings\a411882\My Documents\Scripts\timeScript.txt"
$executable = "w32tm.exe /monitor"
invoke-expression $executable | out-file -filepath $file 
```

我在这里做错了什么？我是 Powershell 的新手，因此我们将不胜感激任何建议！

编辑：当我运行它时，我可以在控制台上显示所有数据，但是我希望将数据写入文本文件。

编辑2：我设法让一切最终输出。我想尝试避免使用 > 运算符写出到文本文件，希望能在 out-file cmdlet 上学到更多知识，但是做一个简单的调用表达式 $executable > $file 设法完成工作。我仍然不明白为什么 cmdlet 不能正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:53:19.920

也许`Invoke-Expression`没有正确地将输出发送到标准输出？我没想到，但奇怪的事情发生了。尝试`w32tm.exe`自己运行：

```
$file = "C:\Documents and Settings\a411882\My Documents\Scripts\timeScript.txt"
w32tm.exe /monitor | Out-File -FilePath $file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-04T08:33:55.637

您可以使用`Start-Process`which 还允许您重定向错误输出：

```
Start-Process w32tm.exe -ArgumentList "/monitor" -Wait -RedirectStandardOutput "output.txt" -RedirectStandardError "error.txt" 
```

# c# - Accessing an existing database table using fluent nhibernate

> ID：10999636
> 
> 赞同：0
> 
> 时间：2012-06-12T15:15:21.793
> 
> 标签：c#, fluent-nhibernate

I am a beginning at nhibernate and I am trying to connect to a pre-existing database table using fluent-nhibernate. The table has no id field, and I am stuck as to how to get queries to work. I get an error - "Field ID does not exist in ".

The table is in a DB2 database, so some of tools for autogenerating code are not applicable.

**Update**

The file and the class looks rather like the following (where where WHO is the primary key)

```
public class Nougal
{
    public virtual string WHO { get; set; }
    public virtual string YN1 { get; set; }
    public virtual string YN2 { get; set; }
    public virtual string YN3 { get; set; }
    public virtual string YN4 { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:29:55.960

You must have some sort of id in order to have NH properly mapping your table as an entity to fit it properly in the identity map of the session. Usually this is represented by the primary key in your table. Even if not defined in the table try to identify what distinguish each record and map it as the table identifier. This could possibly be a composite-id.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T19:32:26.817

I have it working, I had to create a map, and point the Id field at the column that is being used as primary key.

```
public class FILENAMEMap : ClassMap<FILENAME>
{
    public FILENAMEMap()
    {     
        Table("FILENAME");
        Id(x => x.Id).Column("WHO");
        Map(x => x.YN1).Column("YN1");
        Map(x => x.YN2).Column("YN2"); 
```

I think that this has done it, so thanks for pointers, etc.

# jquery - 将 DOM 元素保存到另一个页面中以供后用（Chrome 扩展程序）

> ID：10999641
> 
> 赞同：4
> 
> 时间：2012-06-12T15:16:11.293
> 
> 标签：jquery, google-chrome-extension

我正在尝试保存一个 DOM 节点以将其插入到同一网站的另一个页面中。

我在我的扩展中使用 jQuery。我在 content_script.js 中所做的是：

```
var variableToStore = localStorage["variableToStore"];

if (variableToStore == null) {
    localStorage["variableToStore"] = jQuery("#myDomNode").clone();
    variableToStore = localStorage["variableToStore"];
}

variableToStore.insertAfter(jQuery("#someelementofanotherpage")); 
```

我做错了什么？localStorage 无法保存 DOM 对象？如果没有，我怎样才能实现我的目标？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:25:25.837

简而言之，不，您不能将 DOM 元素存储在本地存储中。即使使用 jStorage 插件，您也不能将 DOM 元素存储在本地存储中，如介绍文本中所述：http: [//www.jstorage.info/](http://www.jstorage.info/)

您可以将 JavaScript 的 HTML 编码字符串存储在本地存储中，然后将其转换回 html（请参阅[此 Q&A](https://stackoverflow.com/questions/1219860/javascript-jquery-html-encoding)以获得该领域的帮助）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-10T04:56:15.770

Francois 的解决方案有效，但是 clone() 不反映 JQuery 修改，所以我必须先运行它：

```
$("input").each(function(){
    $(this).attr("value", $(this).val());
}); 
```

我用 jStorage 来存储表单的整体状态。

（我没有足够的声誉来评论，对不起）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:36:07.003

您可以使用 html 代码保存一个字符串，试试这个：

```
var div=$('<div></div>');
$("#myDomNode").clone().appendTo(div);
localStorage["variableToStore"] = escape(div.html());
...
var variableToStore = unescape(localStorage["variableToStore"]);
$(variableToStore).appendTo($("#someelementofanotherpage")); 
```

# c++ - 函数大小与执行速度

> ID：10999643
> 
> 赞同：2
> 
> 时间：2012-06-12T15:16:16.513
> 
> 标签：c++, multithreading, performance, function

我记得在某处听到“大型函数可能具有更高的执行时间”，因为代码大小、CPU 缓存或类似的东西。

如何判断函数大小是否对我的应用程序造成了性能影响？我该如何优化呢？我有一个 CPU 密集型计算，我已经分成（与 CPU 内核一样多的线程）。主线程一直等到所有工作线程都完成后再继续。

我碰巧在 Visual Studio 2010 上使用 C++，但我不确定这是否真的很重要。

### 编辑：

我正在运行一个光线追踪器，它每像素发射大约 5,000 条光线。我创建 (cores-1) 个线程（每个额外内核 1 个），将屏幕分成几行，并将每一行分配给一个 CPU 线程。我`trace`在每个线程上运行该函数每个像素大约 5,000 次。

我实际上正在寻找加快速度的方法。 *我可以*通过重构来减小主跟踪函数的大小，我想知道我是否应该期望看到性能提升。

很多人似乎在这里回答了错误的问题，我正在寻找**这个**特定问题的答案，即使你认为我可以通过优化函数的内容做得更好，我想知道*是否*有功能大小/性能关系。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:21:41.643

这并不是函数的大小，而是运行时被缓存的代码的总大小。您不会通过将代码拆分为更多较小的函数来加快速度，除非其中一些函数根本没有在您的关键代码路径中调用，因此不需要占用任何缓存。此外，如果编译器决定内联它们，您将代码拆分为多个函数的任何尝试都可能被编译器反转。

因此，实际上不可能说您当前的代码是否“影响性能”。与您可以以不同方式构建代码的众多方式中的哪一种相比，这是一个成功吗？而且你不能合理地期望这种变化会对性能产生任何特别的影响。

我想您正在寻找的是很少执行的指令（您的分析器会告诉您它们是什么），但位于执行很多指令的附近（因此需要在缓存中很多，并将在它们周围拉入缓存线）。如果您可以将经常执行的代码聚集​​在一起，您将从指令缓存中获得更多收益。

但实际上，这并不是一条非常富有成效的优化路线。你不太可能有很大的不同。如果不出意外，您通常执行的代码可能已经非常小并且已经相邻，它会在某个地方有一些紧密的循环（您的分析器会告诉您在哪里）。最低级别的缓存线通常很小（大约 32 或 64 字节），因此您需要对代码进行一些非常精细的重新排列。C++ 在你和目标代码之间放置了很多东西，这阻碍了在内存中仔细放置指令。

诸如此类的工具`perf`可以为您提供有关缓存未命中的信息-其中大多数不适用于可执行代码，但在大多数系统上，您要避免哪些缓存未命中并不重要：如果您可以避免一些，那么您将加快您的速度码起来。也许不是很多，除非有很多失误，但有一些。

不管怎样，你是在什么背景下听到的？我听到的最常见的一种说法是，函数内联有时会适得其反，因为有时代码膨胀的开销大于避免的函数调用开销。我不确定，但如果您的编译器支持，配置文件引导的优化可能会有所帮助。一个相当合理的配置文件引导优化是优先在执行次数较多的调用站点内联，使较冷的代码更小，首先加载和修复的开销更少，并且（希望）对指令的破坏性更小当它被拉入时缓存。比我更了解编译器的人会认真考虑这是否是一个*好的*profile-guided optimization，因此决定是否实现它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:19:06.653

除非您要手动调整到汇编级别，以包括锁定缓存中的特定代码行，否则您不会看到一个大函数和多个小函数之间的显着执行差异。在这两种情况下，您仍然需要执行相同数量的工作，这将成为您的瓶颈。

然而，将事物分解成多个较小的函数会更容易维护和阅读——尤其是在 6 个月后，当你忘记了你最初做了什么的时候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:18:02.493

函数大小不太可能成为应用程序的瓶颈。你在函数中所做的比它的物理尺寸更重要。有些事情你的编译器可以用小函数做它不能用大函数做的事情（即内联），但通常这不是一个很大的区别。

您可以分析代码以查看真正的瓶颈在哪里。我怀疑调用一个大函数不是问题。

但是，出于代码可读性的原因，您应该将函数分解为更小的函数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-12T15:19:03.450

这实际上与函数大小无关，而与您在其中所做的事情有关。根据您的工作，可能有一些方法可以优化它。

# java - 为什么我在 Java 中的建筑不能正确绘制？

> ID：10999646
> 
> 赞同：0
> 
> 时间：2012-06-12T15:16:23.940
> 
> 标签：java, drawing, awt, polygon, graphics2d

我正在尝试绘制一个带有程式化边缘的矩形，但不幸的是边缘仅覆盖左侧和顶部。

```
public Graphics2D Draw(Graphics2D b, long cameraX, long cameraY) {
    //let's do the drawing stuff, yay
    renderImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g = renderImage.createGraphics();
    int[] xPs= new int[pointsarray.length];
    int[] yPs= new int[pointsarray.length];
    int i=0;
    for (Pair p:pointsarray){
        xPs[i]=p.pair[0];
        yPs[i]=p.pair[1];
        i++;
    }
    g.setColor(color);
    g.fillPolygon(xPs, yPs, xPs.length);
    g.setColor(color.darker());
    g.drawPolygon(xPs, yPs, xPs.length);
    b = super.Draw(b, cameraX, cameraY);
    return b;
} 
```

是的，它是一个多边形。我必须保持这个可扩展的。

编辑：这就是 pointsarray 现在的样子。

```
 pointsarray = new Pair[4];

    pointsarray[0] = new Pair(0,0);
    pointsarray[1] = new Pair(0,height);
    pointsarray[2] = new Pair(width,height);
    pointsarray[3] = new Pair(width,0); 
```

渲染方法：（这被第一种方法覆盖）（我也承认 -renderImage.getWidth()/2 部分是错误的）

```
public Graphics2D Draw(Graphics2D b ,long cameraX, long cameraY) {
    AffineTransform t = AffineTransform.getRotateInstance(r);
    AffineTransformOp op = new AffineTransformOp(t,AffineTransformOp.TYPE_BILINEAR);
    b.drawImage(renderImage, op, (int)(cameraX-x), (int)(cameraY-y));
    return b;
} 
```

JFrame 最终渲染：

```
public void paintComponent(Graphics g) {
    Graphics2D r = (Graphics2D) g;
    Graphics2D b = (Graphics2D) r.create(); // i herd you liek buffers
    b.clearRect(0, 0, getWidth(), getHeight()); // clear the buffer
    // let's draw some... stuff
    long newCameraX = cameraX;
    long newCameraY = cameraY;
    // background
    b.setColor(Color.WHITE);
    b.fillRect(0, 0, getWidth(), getHeight());
    b.setColor(Color.BLACK);
    for (Entity entity : entities) {
        entity.Draw((Graphics2D) b, cameraX + (this.getSize().width / 2),
                cameraY + (this.getSize().height / 2));
    }

    // we're done drawing. let's put the stuff back in the first thing
    r = b;
    cameraX = newCameraX;
    cameraY = newCameraY;
} 
```

对类：

```
public class Pair {
    public int[] pair = {0,0}; 

    public Pair(int num1, int num2) {
        pair[0] = num1;
        pair[1] = num2;
    }
    //you mad?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:47:16.660

基本上，您正在绘制超出图像的多边形的底部和右侧部分。 [Java Graphics.fillPolygon：如何同时渲染右边缘和下边缘？](https://stackoverflow.com/questions/7701097/java-graphics-fillpolygon-how-to-also-render-right-and-bottom-edges)

# objective-c - 区域设置的 NSDate 问题

> ID：10999647
> 
> 赞同：1
> 
> 时间：2012-06-12T15:16:25.647
> 
> 标签：objective-c, nsdate, nsdateformatter, nslocale

我正在开发一个 iPad 应用程序，该应用程序与我为与数据库通信而构建的私有 PHP API 对话。这个 API 必须传输三个日期，一个开始时间，一个结束时间和当前时间。

我想测试当前时间是否在日期范围之间。所以我把时间（比如 16:50:00）转换成 NSDates：

```
NSDateFormatter *former = [[NSDateformatter alloc] init];
[former setDateFormat:@"HH:mm:ss"];
[former setLocale:[NSLocale currentLocale]];

NSDate *fromDate = [former dateFromString:@"10:15:00"];
NSDate *nowDate = [former dateFromString:@"13:25:00"];
NSDate *toDate = [former dateFromString:@"16:30:00"]; 
```

当我现在使用 记录日期时，`NSLog(@"\n%@\n%@\n%@", fromDate, nowDate, toDate);`我发现语言环境不正确。

似乎 NSDateFormatter 只是忽略了语言环境设置。我还记录了正确的 currentLocales 标识符（在我的例子中是“de_DE”）。语言环境仍然是 +0000。

我该如何解决这个问题？谢谢，致以诚挚的问候，朱利安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T04:49:50.557

好的，我已经删除了之前的答案，请尝试以下

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
NSTimeZone *zone = [NSTimeZone localTimeZone];
[formatter setTimeZone:zone];
[formatter setDateFormat:@"HH:mm:ss"];

NSDate *date = [formatter dateFromString:@"10:15:00"];

NSLog(@"Time %@",[formatter stringFromDate:date]); 
```

# javascript - FF 3.6 中的 jQuery Masonry 错误

> ID：10999650
> 
> 赞同：0
> 
> 时间：2012-06-12T15:16:43.743
> 
> 标签：javascript, jquery, jquery-masonry, firefox3.6

我有一个页面，其中包含使用 jQuery Masonry 插件布置的一些图块。但是我在 FF 4 及以下版本中遇到错误：

$("#flextiles").masonry 不是函数

我正在为它为什么不工作而烦恼，它可以在所有其他浏览器中工作 - 甚至是 IE6！

[这是页面](http://www.bhs.co.uk/webapp/wcs/stores/servlet/TopCategoriesDisplay?storeId=13077&catalogId=34096)

有人有什么想法吗？

加载砌体插件和初始化的相关代码是：

```
function buildGrid() {
    $('#flextiles').masonry({
        itemSelector: 'li',
        columnWidth: 235
    });
}

$.getScript("http://bhuk.stage.arcadiagroup.ltd.uk/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color35/cms/templates/static/template-0000008049/js/masonry.min.js", function() {
    buildGrid();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:22:04.527

Fwiw 我刚刚在运行 XP 的 VM 上安装了 FF 3.6 并加载了您的链接。它工作正常，我没有 JS 错误。折叠下方的东西看起来是共济会的。

你在多少台机器上试过这个？在特定的机器上可能有一些东西正在承载这个（附加组件或间谍软件）我建议您尝试禁用所有“扩展”并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:21:36.480

我真的一点也不担心FF 4！这几天是第12版。我自己是 Masonry 的粉丝，它是一个不错的插件，但如果它不适用于 FF4，它真的不会打扰我。

检查统计数据！

*   [W3 Schools- 浏览器](http://www.w3schools.com/browsers/browsers_firefox.asp)
*   [浏览器版本](http://gs.statcounter.com/#browser_version-ww-monthly-201105-201205)

# hibernate - postgres tablefunc 模块使用 hql hibernate 查询？

> ID：10999651
> 
> 赞同：0
> 
> 时间：2012-06-12T15:16:46.937
> 
> 标签：hibernate, postgresql, crosstab

您知道如何在 HQL 查询中使用 postgres 交叉表 (tablefunc) 函数吗？您需要向 Hibernate 注册该功能吗？

这是我得到的错误：

```
unexpected token: CROSSTAB near line 1, column 34 [SELECT * from CROSSTAB('select ... 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T22:14:07.050

您不能在 HQL 中执行此操作，因为 HQL 是一种独立于数据库实现的不同语言。如果您想使用特定于 PostgreSQL 的功能（例如交叉表），您将需要本[机查询接口](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch13.html)。

# c# - 将黑白位图转换为布尔数组

> ID：10999652
> 
> 赞同：2
> 
> 时间：2012-06-12T15:16:51.727
> 
> 标签：c#, arrays, bitmap, boolean, imaging

> **可能重复：**
> [在 C# 中将位图转换为布尔数组的快速方法？](https://stackoverflow.com/questions/10414805/fast-way-to-convert-a-bitmap-into-a-boolean-array-in-c)

在我的项目中，我有一个资源是一个黑白位图，我用它来保存一些 4x4 黑白精灵。在我可以有效地使用这些数据之前，尽管我需要将其转换为二维多维（或锯齿状，没关系）布尔数组，其中 false 表示白色，黑色表示 true。

这是我目前的解决方案：

```
 public Bitmap PiecesBitmap = Project.Properties.Resources.pieces;
    bool[,] PiecesBoolArray = new bool[4, 16]; // 4 wide, 16 high (4 4x4 images)

    for (int x = 0; x < 4; x++)
            {
                for (int y = 0; y < 16; y++)
                {
                    if (PiecesBitmap.GetPixel(x, y) == Color.Black)
                    {
                        PiecesBoolArray[x, y] = true;
                    }
                    else
                    {
                        PiecesBoolArray[x, y] = false;
                    }

                }
            } 
```

因为我会经常调用这个函数（使用不同的位图），有没有更有效的方法呢？.GetPixel 有点慢，感觉就像我在这里错过了一些技巧。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:20:18.667

使用 Bitmap.LockBits。你会在网上找到教程。

# c - c中具有最大值和最小值的随机数生成器

> ID：10999657
> 
> 赞同：0
> 
> 时间：2012-06-12T15:17:18.120
> 
> 标签：c, random, numbers, generator

> **可能重复：**
> [在 C 中，如何从 rand() 中获取特定范围的数字？](https://stackoverflow.com/questions/1202687/in-c-how-do-i-get-a-specific-range-of-numbers-from-rand)

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main(int argc, char** argv) {

srand(time(NULL));
int r = rand();

printf("%d\n", r);

return (EXIT_SUCCESS); } 
```

我有这个代码，我想制作 1-6 的随机数并用它们填满一个板 [40] 有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:19:47.353

```
int main(int argc, char** argv) {
    int i;
    int array[40];
    srand(time(NULL));
    for (i=0; i<40; i++)
        array[i] = rand()%6 + 1
    return (EXIT_SUCCESS);  
} 
```

# .net - 使鼠标倾斜水平滚动总是重复

> ID：10999659
> 
> 赞同：1
> 
> 时间：2012-06-12T15:17:26.170
> 
> 标签：.net, vb.net, winforms, mouseevent, mousewheel

我正在设计一个底部停靠水平滚动条的表单。我想使用鼠标倾斜按钮添加对横向滚动的支持，并找到[了这个解决方案](https://stackoverflow.com/questions/6612352/detecting-horizontal-mouse-wheel-movement)，经过一番修改后，它似乎可以解决问题——也就是说，虽然表单只在其表面上绘制了 GDI 图形。

但是，从那时起，我在表单中添加了一些控件，发现当鼠标悬停在其中任何一个上时*，*倾斜操作只会一次触发一次，而不是像鼠标悬停在任何其他部分上时那样重复触发的形式。

要了解我的意思（如果您有一个带有倾斜按钮的鼠标）将水平滚动条停靠在表单的底部，请添加一些其他控件并粘贴以下代码：

```
Public Class Form1
    Const WM_MOUSEHWHEEL As Integer = &H20E

    Protected Overrides Sub WndProc(ByRef m As Message)
        MyBase.WndProc(m)
        If Me.IsDisposed OrElse m.HWnd <> Me.Handle Then Return 
        Select Case m.Msg
            Case WM_MOUSEHWHEEL
                With HScrollBar1
                    If CType(m.WParam, Integer) < 0 Then '______________ Left Scroll
                        If .Value > 0 Then .Value -= 1
                    Else '______________________________________________ Right Scroll
                        If .Value < (.Maximum - .LargeChange + 1) Then .Value += 1
                    End If
                End With
                m.Result = CType(1, IntPtr) 'Indicates the message has been handled
        End Select
    End Sub

    Private Sub HScrollBar1_ValueChanged(sender As Object, e As System.EventArgs) Handles HScrollBar1.ValueChanged
        Console.WriteLine(HScrollBar1.Value)
    End Sub
End Class 
```

当鼠标悬停在窗体的空白部分上时，您会看到横向滚动重复，但在控件上时只有“单次”。

我猜解决方案存在于消息`.Result`价值的某个地方，但我不知道应该是什么。事实上，我什至不确定我是否返回了正确的值，因为原始解决方案中的代码向 DirectCast 函数抛出了一个异常，所以我将它换成了 CType，这似乎可以正常工作。我试过用 Spy++ 解决它，但我看不到任何明显的东西。

请问有什么想法吗？

* * *

**更新**

我注意到当我在 Spy++ 中包含“子”窗口时，有两个 (0x020E) 消息和两个返回值，1 然后 0。我认为消息正在通过表单传递到控件。所以我想现在的问题是：可以防止消息传递给控件吗？或者可以截取控件的返回值并转换为1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T15:29:45.360

我设法想出了一个解决方法，但我确信一定有比这更好的方法。我所做的是为表单上使用的每种类型的控件添加一个类，并从控件继承。然后，我为每个类添加了一个 WndProc 过程，以便`1`始终为`WM_MOUSEHWHEEL`这些控件处理的消息返回该过程。例如，这是按钮类：

```
Public Class scButton
    Inherits Button
    Protected Overrides Sub WndProc(ByRef m As Message)
        MyBase.WndProc(m)
        If Me.IsDisposed OrElse m.HWnd <> Me.Handle Then Return
        If m.Msg = Win32Messages.WM_MOUSEHWHEEL Then m.Result = New IntPtr(1)
    End Sub
End Class 
```

然后只需更改表单设计器代码中的引用即可。

正如我所说，我确信一定有比这更好的方法。如果你必须为大量不同的控件类做这件事会很痛苦，但在我的例子中，我只需要它来做一些基本的控件。

* * *

我将这个开放了几天，希望有人会提出更好的解决方案，但没有任何结果，所以我将接受我自己的答案。

# php - 通过 PHP 导入 CSV

> ID：10999663
> 
> 赞同：0
> 
> 时间：2012-06-12T15:17:34.923
> 
> 标签：php, csv, import

我正在使用以下内容将 .CSV 导入应用程序：

```
if (($handle = fopen($file, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        echo "<p> $num fields in line $row: <br /></p>\n";
        $row++;
        for ($c=0; $c < $num; $c++) {
            echo $data[$c] . "<br />\n";
        }
    }
    fclose($handle);
} 
```

它有点工作，但它远非完美。我想首先取出行头并将它们放入一个数组中，然后循环每一行以获取数据集。

它似乎有划界问题，因为第一行（头部）也包括第二行的一些部分。

我直接从 Excel 导出了 .csv 文件。想知道是否有编码技巧等我可能会丢失。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:21:12.940

听起来你的`1000`限制还不够长；您应该将其设置为该文件的足够高的值......或设置`0`为无限制（不推荐，因为它往往会更慢）。

将它设置为`4096`or`8192`先，看看它是如何进行的。

```
// use 8kB buffer for reading comma delimited line
while (($data = fgetcsv($handle, 8192, ",")) !== FALSE) { 
```

**更新**

好的，再想一想，也许您应该检查文件并确认几件事：

1.  分隔符真的是逗号吗？（我猜你已经建立了这个）
2.  字符串附件总是双引号吗？
3.  字符串是否用反斜杠（默认）或另一个双引号转义？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:59:31.207

`fgetcsv`并不总是正确检测行尾。

在 fgetcsv 调用之前尝试使用：

```
ini_set('auto_detect_line_endings', true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-07T16:51:19.913

我改为 8192 并得到相同的结果

```
while (($data = fgetcsv($handle, 8192, ",")) !== FALSE) {
...
} 
```

然后做了这个并得到了相同的结果

```
$handle = fopen($_FILES['filename']['tmp_name'], "r");
ini_set('auto_detect_line_endings', true);
    while (($data = fgetcsv($handle, 8192, ",")) !== FALSE) {
         $data = array_map('mysql_real_escape_string', $data); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-12T15:26:46.803

你为什么不使用file()？

```
 $trimmed = file('somefile.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES); 
```

# php - 我在 GAC_MSIL 中看到一个 DLL，但没有程序集

> ID：10999665
> 
> 赞同：0
> 
> 时间：2012-06-12T15:17:51.283
> 
> 标签：php, .net, vb.net, com, com-interop

我正在查看我的 ClassLibrary1.dll 里面

```
C:\Windows\Microsoft.NET\assembly\GAC_MSIL\ClassLibrary1\v4.0_1.0.0.0__2efc1c0b243a0c09 
```

由于这个原因，它被自动放置在那里：

```
C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools>gacutil.
exe /i "C:\Users\wherever\ClassLibrary1.dll"
Microsoft (R) .NET Global Assembly Cache Utility.  Version 4.0.30319.1
Copyright (c) Microsoft Corporation.  All rights reserved.

Assembly successfully added to the cache

C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools> 
```

但是之后在里面找不到相应的组件

```
C:\Windows\assembly 
```

我究竟做错了什么？我希望能够通过以下代码使用该类库：

```
<?php
 $obj = new DOTNET("ClassLibrary1", "Version=1.0.0.0", "Culture=neutral", "PublicKeyToken=2efc1c0b243a0c09", "ClassLibrary1.Class1"); 
 $output=$obj->HelloWorld();
 echo $output;
?> 
```

该类如下所示：

```
Public Class Class1
    Public Sub HelloWorld()
        MsgBox("hello, world")
    End Sub
End Class 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:38:53.097

我认为这是一个 .net 4 程序集？如果是这样，请注意 \Windows\assembly 中没有列出任何 .net 4 程序集。

那是因为 .net 4 程序集位于不同的位置。这没什么好担心的，只要您可以在 GAC 中使用该程序集即可。

# c# - 在保留标题的同时合并多个 Word 文档 - .Net 办公自动化

> ID：10999666
> 
> 赞同：0
> 
> 时间：2012-06-12T15:17:54.233
> 
> 标签：c#, ms-word, office-interop

我想合并多个word文档，同时保留每个文档的页眉和页脚。下面的代码正在合并文档，但也合并了页眉和页脚：

```
public static void Merge(List filesToMerge, string outputFilename)
{
    Application wordApplication = null;
    Document wordDocument = null;

    try
    {
        // Create a new Microsoft Word application object
        wordApplication = new Application();
        wordApplication.Visible = false;
        wordApplication.ScreenUpdating = false;

        // Create a new file based on our template
        object defaultTemplate = @"Normal.dotm";
        wordDocument = wordApplication.Documents.Add(ref defaultTemplate);

        // Make a Word selection object.
        Selection selection = wordApplication.Selection;

        // Loop thru each of the Word documents
        foreach (string file in filesToMerge)
        {
            // Insert the files to our template
            selection.InsertFile(file);
            object pageBreak = WdBreakType.wdSectionBreakNextPage;
            selection.InsertBreak(ref pageBreak);
        }

        // Save the document to it's output file.
        object outputFile = outputFilename;
        wordDocument.SaveAs(ref outputFile);
    }
    catch (Exception ex)
    {
        Console.WriteLine("Error while conversion. Details: " + ex);
    }
    finally
    {
        MSWordCleanup(wordApplication, wordDocument);
    }
}
```

反正有这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:42:58.393

完成这些培训课程可能会对您有所帮助：http: [//office.microsoft.com/en-us/word-help/headers-and-footers-from-basic-to-elaborate-RZ001021662.aspx](http://office.microsoft.com/en-us/word-help/headers-and-footers-from-basic-to-elaborate-RZ001021662.aspx)

虽然这不会以“自动化形式”为您提供答案，但可能足以让您找出答案。

# nginx - nginx不向上游转发

> ID：10999670
> 
> 赞同：1
> 
> 时间：2012-06-12T15:18:02.317
> 
> 标签：nginx, python-2.7, paster

我有一个粘贴服务器，它设置为使用 nginx 代理托管多个应用程序。出于某种原因，似乎没有从 nginx 向上游发送请求。我在客户端收到 404 错误，我可以在日志中找到的唯一“错误”是 nginx_error.log 中的以下行（大约每 5 秒生成一次）：

> 2012/06/12 10:29:37 [info] 22289#0: *49 客户端在读取客户端请求行时提前关闭连接，客户端：192.168.10.135，服务器：本地主机

Google 上的一些优质时间表明这不是一个破坏应用程序的问题，但这是我现在必须继续进行的全部内容。

nginx.access.log 每 5 秒打印一次以下行：

> --[12/Jun/2012:10:31:13 -0400]-4000--

尽管应用程序中有几条日志消息，但没有将用户操作的条目打印到应用程序日志中。

作为参考，我的 nginx.cfg 看起来像：

```
daemon             off; 
error_log          /APP_DIRECTORY/logs/nginx_error.log info; 
pid                /APP_DIRECTORy/var/nginx.pid; 
worker_processes   1;  
working_directory  /APP_DIRECTORY/var/;  

events {
  worker_connections 1024; 
}

http {   
  # the three parameters for *_temp_path MUST be here or nginx will not start   
  client_body_temp_path /APP_DIRECTORY/var/lib/nginx/body;   
  proxy_temp_path       /APP_DIRECTORY/var/lib/nginx/proxy;   
  fastcgi_temp_path     /APP_DIRECTORY/var/lib/nginx/fastcgi;   
  include               /etc/nginx/mime.types;   
  default_type          application/octet-stream;  

  log_format            main $http_x_forwarded_for - [$time_local] "$request" $status $body_bytes_sent  "$http_referer" "$http_user_agent";  
  sendfile              on;   
  keepalive_timeout     0;   
  tcp_nodelay           on;  

  gzip                  on;   
  Gzip_proxied          any;   
  gzip_types            text/plain text/html application/json application/xml;

  upstream app_paste {
    server 127.0.0.1:8001;
    #server 127.0.0.1:8002;
    #server 127.0.0.1:8003;
    #server 127.0.0.1:8004;
    #server 127.0.0.1:8005;
    #server 127.0.0.1:8006;
    #server 127.0.0.1:8007;
    #server 127.0.0.1:8008;
    #server 127.0.0.1:8009;
    #server 127.0.0.1:8010;
    #server 127.0.0.1:8011;
    #server 127.0.0.1:8012;   
  }

  server {
    listen 8000;
    server_name localhost;
    access_log /app_DIRECTORY/logs/nginx.access.log main;

    location /crossdomain.xml {
      root /APP_DIRECTORY/www;
    }

    location /v1 {
      proxy_pass http://app_paste;
    }

    location /v2 {
      proxy_pass http://app_paste;
    }   
  } 
} 
```

我的应用程序配置如下所示：

```
[DEFAULT]  
loglevel = INFO  
beaker.session.cookie_expires = true  
beaker.session.lock_dir = .
beaker.session.type = mongodb  
beaker.session.url = mongodb://MONGO_HOST:MONGO_PORT/beaker.sessions?slaveok=true  
beaker.session.skip_pickle = true  

[composite:main]  
use = egg:Paste#urlmap  
/v1/cust1 = cust1  

[app:cust1]  
paste.app_factory = appservice.main:make_app  
company = customer1  
db_host = DB_HOST  
db_port = DB_PORT  
db_name = DB_NAME  
DATA_COLLECTION = customer_data  
USERS_COLLECTION = customer_users  
REPORT_PARAM_1 = REPORT_PARAM_1_DATA  
REPORT_PARAM_2 = REPORT_PARAM_2_DATA  
REPORT_PARAM_3 = REPORT_PARAM_3_DATA  
REPORT_PARAM_4 = REPORT_PARAM_4_DATA  
REPORT_PARAM_5 = REPORT_PARAM_5_DATA  
REPORT_PARAM_6 = REPORT_PARAM_6_DATA  

[server:main]  
use = egg:Paste#http    
host = 0.0.0.0  
port = %(app_port)s 
```

什么可能导致此问题？我的配置有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:05:57.937

我更改了处理配置文件的方式，以使用传递给我的应用程序工厂的参数，而不是从应用程序手动解析文件。由于某种原因，我根本不明白，这似乎已经解决了问题。@mikhailov，感谢您的所有时间和帮助。

# php - 在 php 中将 xml 解析为 json，同时在 textNode 旁边有子节点

> ID：10999677
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:18.243
> 
> 标签：php, xml, json, simplexml

我需要将一些 xml 从外部 XML-API 解析为 JSON，为此，我使用[了 IBM 提供的这个非常好的小库，](http://www.ibm.com/developerworks/xml/library/x-xml2jsonphp/!)它目前运行良好。不幸的是，我发现一些文本节点在一些简单的文本节点旁边有子节点，并且没有作为子子节点被发现：

简化示例：

```
<?php

$str = 
'<topics>
  <topic>Objekte mit Data Dictionary Views verwalten
    <sub_topics>
      <sub_topic>Data Dictionary erläutern</sub_topic>
      <sub_topic>Dictionary Views</sub_topic>
      <sub_topic>Views USER_OBJECTS und ALL_OBJECTS</sub_topic>
      <sub_topic>Tabellen- und Spalteninformationen</sub_topic>
      <sub_topic>Dictionary Views nach Constraint-Informationen abfragen</sub_topic>
      <sub_topic>Dictionary Views nach View-, Sequence-, Index- und Synonyminformationen abfragen</sub_topic>
      <sub_topic>Tabellen Kommentare hinzufügen</sub_topic>
      <sub_topic>Dictionary Views nach Kommentarinformationen abfragen</sub_topic>
    </sub_topics>
  </topic>
  <topic>Große Datensets bearbeiten
    <sub_topics>
      <sub_topic>Daten mithilfe von Unterabfragen bearbeiten</sub_topic>
      <sub_topic>Daten mit einer Unterabfrage als Quelle abrufen</sub_topic>
      <sub_topic>INSERT-Anweisungen mit einer Unterabfrage als Ziel</sub_topic>
      <sub_topic>Schlüsselwort WITH CHECK OPTION in DML-Anweisungen</sub_topic>
      <sub_topic>Anweisung INSERT für mehrere Tabellen – Varianten</sub_topic>
      <sub_topic>Anweisung INSERT für mehrere Tabellen</sub_topic>
      <sub_topic>Zeilen in einer Tabelle zusammenführen</sub_topic>
      <sub_topic>Über einen Zeitraum erfolgte Datenänderungen überwachen</sub_topic>
    </sub_topics>
  </topic>
  <topic>Daten in verschiedenen Zeitzonen verwalten
    <sub_topics>
      <sub_topic>Zeitzonen</sub_topic>
      <sub_topic>CURRENT_DATE, CURRENT_TIMESTAMP und LOCALTIMESTAMP</sub_topic>
      <sub_topic>Datum und Uhrzeit in einer Sessionzeitzone vergleichen</sub_topic>
      <sub_topic>DBTIMEZONE und SESSIONTIMEZONE</sub_topic>
      <sub_topic>DATE und TIMESTAMP – Unterschiede</sub_topic>
      <sub_topic>Datentypen INTERVAL</sub_topic>
      <sub_topic>EXTRACT, TZ_OFFSET und FROM_TZ</sub_topic>
      <sub_topic>TO_TIMESTAMP, TO_YMINTERVAL und TO_DSINTERVAL</sub_topic>
    </sub_topics>
  </topic>
</topics>';

$xml = simplexml_load_string($str, 'SimpleXMLElement', LIBXML_XINCLUDE);

print_r($xml);

?>

SimpleXMLElement Object
(
  [topic] => Array
  (
    [0] => Objekte mit Data Dictionary Views verwalten
    [1] => Größe Datensets bearbeiten
    [2] => Daten in verschiedenen Zeitzonen verwalten
  )
) 
```

当我将 xml 字符串减少为仅使用条目时，simplexml_load_string 会发现子节点 - 但会减少“标题”：

```
<?php

$str = '<topic>Objekte mit Data Dictionary Views verwalten
      <sub_topics>
        <sub_topic>Data Dictionary erläutern</sub_topic>
        <sub_topic>Dictionary Views</sub_topic>
        <sub_topic>Views USER_OBJECTS und ALL_OBJECTS</sub_topic>
        <sub_topic>Tabellen- und Spalteninformationen</sub_topic>
        <sub_topic>Dictionary Views nach Constraint-Informationen abfragen</sub_topic>
        <sub_topic>Dictionary Views nach View-, Sequence-, Index- und Synonyminformationen abfragen</sub_topic>
        <sub_topic>Tabellen Kommentare hinzufügen</sub_topic>
        <sub_topic>Dictionary Views nach Kommentarinformationen abfragen</sub_topic>
      </sub_topics>
    </topic>';

$xml = simplexml_load_string($str);
print_r($xml);
?>

SimpleXMLElement Object
(
    [sub_topics] => SimpleXMLElement Object
        (
            [sub_topic] => Array
                (
                    [0] => Data Dictionary erläutern
                    [1] => Dictionary Views
                    [2] => Views USER_OBJECTS und ALL_OBJECTS
                    [3] => Tabellen- und Spalteninformationen
                    [4] => Dictionary Views nach Constraint-Informationen abfragen
                    [5] => Dictionary Views nach View-, Sequence-, Index- und Synonyminformationen abfragen
                    [6] => Tabellen Kommentare hinzufügen
                    [7] => Dictionary Views nach Kommentarinformationen abfragen
                )

        )

) 
```

..现在我想知道除了使用xpath手动爬入可疑区域之外，是否还有其他解决方案，对这些子子项使用数组转换，然后合并数组。

这是我需要解析的完整 xml 文件的一个示例：[http ://education.oracle.com/pls/web_prod-plq-dad/catalogs.xml_desc?p_id=D49988DE20&p_org_id=34&p_lang=D](http://education.oracle.com/pls/web_prod-plq-dad/catalogs.xml_desc?p_id=D49988DE20&p_org_id=34&p_lang=D)

提前致谢

**编辑：** 为了解决这个问题，我使用了一个不同的库，它以更复杂的方式打印出数组，并且能够与子元素、属性和节点值分开：[http ://www.criticaldevelopment.net/xml/doc.php](http://www.criticaldevelopment.net/xml/doc.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:23:45.900

如果您可以通过 AJAX 请求访问此数据，我建议您使用 jQuery.post() 或 jQuery.get() 函数，它可以像解析 json 一样解析您的 XML，反之亦然。

它是 javascript，但它绝对是最简单的方法（据我所知），无需花费数小时进行编码和搜索即可进行治疗，也许不是最适合您需求的解决方案，但它是您应该考虑的一种方式。

# php - Drupal 7 user_save 不发送注册电子邮件

> ID：10999680
> 
> 赞同：1
> 
> 时间：2012-06-12T15:18:23.987
> 
> 标签：php, drupal-7

我正在以编程方式创建一个 drupal 用户帐户，代码如下。除了遵循标准用户创建规则的 Drupal 之外，一切似乎都可以正常工作，主要是发送一封电子邮件以确认电子邮件地址。因此，用户是在 Drupal 中创建的，但确认电子邮件永远不会发送。

电子邮件在安装中工作正常。如果我使用标准注册表单，用户会按预期收到电子邮件并可以完成注册过程。

关于我需要做什么才能让 user_save 知道发送确认电子邮件的任何提示？

```
function _webform_submit($form, &$form_state) {
    $data = $form_state['values']['submitted_tree'];
    drupal_set_message('Data is: <pre>' . print_r($data, TRUE) . '</pre>'); 

    if (array_key_exists('create_user', $data)) {
        drupal_set_message('Found create_user.');
        $name = $data['email'];
        $account_id = db_query("SELECT uid FROM {users} WHERE name = :name", array(':name' => $name))->fetchField();

        $account = new stdClass();
        if ($account_id) {
            //$account->uid = $account_id;
            drupal_set_message("Found existing user");
        } 
        else {

            $pass = user_password();
            drupal_set_message("Creating a new user: " . $name . " with pw: " . $pass );
            $account->is_new = TRUE;
            $account->status = TRUE;

            foreach($data as $key => $value) {
                //If this is an array, likely checkboxes.
                if (gettype($value) == 'array') {
                foreach($value as $arr_key => $arr_val) {
                        $edit[$arr_val]['und'][0]['value'] = '1';
                    }
                }
                else {
                    $edit[$key]['und'][0]['value'] = $value;
                }
            }
            $edit['name'] = $name;
            //$edit['pass'] = $pass;
            $edit['mail'] = $name;
            $edit['status'] = 1;
            $edit['init'] = $name;

            user_save($account, $edit); 
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:40:11.760

找到答案 - user_save 不处理任何通知，您需要直接处理它。我用了：

```
_user_mail_notify('register_no_approval_required', user_save($account, $edit)); 
```

# objective-c - 远程调试 iOS 性能

> ID：10999681
> 
> 赞同：1
> 
> 时间：2012-06-12T15:18:25.233
> 
> 标签：objective-c, ios, remote-debugging, performance-testing

我有一个显示性能问题的 iOS 应用程序。问题是开发人员无法重现它。并且可以重现问题的用户在物理上离开发人员很远。这意味着我们不能使用 Instruments 来帮助调试问题。

无论如何我们可以做方法级别的计时吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-12T15:22:35.170

您可以对进行证明的人说，并且有问题会向您发送崩溃的调试日志。开发人员可以尝试找出问题所在。

# c#-2.0 - 在同一路径上多次保存bmp图像C#

> ID：10999682
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:34.843
> 
> 标签：c#-2.0

所以，我正在研究我的油漆应用程序。每次我进行更改时，当前屏幕状态都会被复制并作为位图图像保存在我的磁盘上（这样我就可以在我的绘画事件中使用它）。

当我最小化并将窗口恢复到正常状态然后尝试绘制时，就会出现问题。这会触发我的事件对更改做出反应，程序会尝试保存图像---->>> kabooom。

它说“GDI+ 中发生了一般错误”。所以，我一直在浏览各种论坛以寻找答案，但没有一个给我真正的答案，他们都提到了错误的路径等，但我很确定那是不是问题。我是否必须处理位图或对流做些什么？

```
 int width = pictureBox1.Size.Width;
        int height = pictureBox1.Size.Height;

        Point labelOrigin = new Point(0, 0); // this is referencing the control
        Point screenOrigin = pictureBox1.PointToScreen(labelOrigin);

        int x = screenOrigin.X;
        int y = screenOrigin.Y;

        Rectangle bounds = this.Bounds;
        using (Bitmap bitmap = new Bitmap(width, height))
        {
            using (Graphics g = Graphics.FromImage(bitmap))
            {
                g.CopyFromScreen(new Point(x, y), Point.Empty, bounds.Size);
            }
            bitmap.Save(_brojFormi + ".bmp", System.Drawing.Imaging.ImageFormat.Bmp);                
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:26:43.700

您正在*将图像保存到磁盘*，以便*在其他活动中使用它*？哇。

为什么不只使用类全局变量来存储位图？

```
class MyForm
{
    Bitmap currentImage = null;
    Graphics gfx = null;

    private void btnLoad_Click(object sender, EventArgs e)
    {
        // ...
        currentImage = new Bitmap(fileName);
        gfx = Graphics.FromImage(currentImage);
    }

    private void pbEditor_Paint(object sender, PaintEventArgs e)
    {
        if (currentImage != null && gfx != null)
        {
             lock(currentImage) e.Graphics.DrawImage(currentImage, ...);
        }
    }

    private void pbEditor_Click(object sender, MouseEventArgs e)
    {
        // quick example to show bitmap drawing
        if (e.Button == MouseButtons.Left)
            lock(currentImage) currentImage.SetPixel(e.Location.X, e.Location.Y, Colors.Black);
    }
} 
```

# ruby - 哈希键作为方法标识符

> ID：10999684
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:36.140
> 
> 标签：ruby, hash

我有一些这样的红宝石代码：

```
my_hash = {
  key1: "value", 
  key2: "value"
}

def key1
  do_something
end

def key2
  do_something_else
end 
```

如您所见，键和方法具有相同的名称。我现在想将哈希键“转换”为方法名称为哈希键的方法调用

作为背景，我有一个 ncurses 菜单，其中哈希值是标签，我只传递键。And when a menu entry is selected I want to execute the correct method without too much coding overhead like figuring out in a if or case statement which entry was selected.

这有可能吗？如果是，我该怎么做？

这件事对我来说有点难以解释，我希望你明白我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:25:16.930

用于[`send`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)以符号名称调用方法：

```
my_hash.each { |k,_| send k } 
```

这将调用哈希中的所有方法。您可以只选择一个并使用`send`as 来调用它，而不是迭代。

# python - 在change_form Django中处理输入按钮

> ID：10999685
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:36.337
> 
> 标签：python, django, button

我是 Django 和 python 的新手。我有个问题。有没有办法，在单击输入按钮后被重定向到同一个 change_form 页面而不被 Django 传递到 change_list 页面？这是我的意思的用户界面：

![](../Images/fb7b331d34cae3b6eddbc14b43297d0e.png)

（在所有字段集下输入按钮）希望你能理解我的意思并给我一些回应。谢谢 ：）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:40:19.327

更改 submit_line.html 模板

我改变了：

```
{% if show_save %}<input name="_save" type="submit" value="{% trans 'Save' %}" class="default" {{ onclick_attrib }}/>{% endif %} 
```

至：

```
{% if show_save %}<input name="_continue" type="submit" value="{% trans 'Save' %}" class="default" {{ onclick_attrib }}/>{% endif %} 
```

这将导致默认保存按钮充当保存并继续按钮。

这个[stackoverflow-question](https://stackoverflow.com/questions/3894493/django-override-admin-change-form-html-template-display-associated-model-in-te)或[django 文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#overriding-admin-templates)可以帮助您正确更改 submit_line-template

完成“submit_line.html”：

```
{% load i18n %}
<div class="submit-row">
{% if show_save %}<input type="submit" value="{% trans 'Save' %}" class="default" name="_continue" {{ onclick_attrib }}/>{% endif %}
{% if show_delete_link %}<p class="deletelink-box"><a href="delete/" class="deletelink">{% trans "Delete" %}</a></p>{% endif %}
{% if show_save_as_new %}<input type="submit" value="{% trans 'Save as new' %}" name="_saveasnew" {{ onclick_attrib }}/>{%endif%}
{% if show_save_and_add_another %}<input type="submit" value="{% trans 'Save and add another' %}" name="_addanother" {{ onclick_attrib }} />{% endif %}
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:22:38.847

如果您在谈论 django 管理员，则有三个按钮：

> *   保存并添加新的
> *   **保存并继续编辑**（需要点这个）
> *   节省

如果您在谈论自己的应用程序，请在表单中添加下一个参数，在表单验证中捕获它并相应地重定向

**编辑：**

我看到您创建了一个自定义按钮，您可以覆盖 ModelAdmin 中的保存/输入方法并重定向到您想要的任何位置。只需在表单中添加一个隐藏的下一个输入。

**例子：**

设置.py

```
TEMPLATE_CONTEXT_PROCESSORS = (
    # other stuff
    "django.core.context_processors.request",
) 
```

您的变更表格模板：

```
<input type="hidden" name="next" value="{{request.path}}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:29:09.300

enter 按钮，将导致底层 html-form 被提交。这与 django 或 python 无关，是特定于浏览器的。

django change_form 有三个提交按钮，最后一个将使用。

有多种方法可以做到这一点：

*   覆盖hange_form-template 并添加一些jquery 来响应按键事件（回车）并触发选择的按钮。

*   重新排列这些按钮

# xcode4.2 - 如何将文件添加到 xcode pbxproj 文件？

> ID：10999692
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:51.397
> 
> 标签：xcode4.2

我想让 xcode 项目与 Visual Studio 项目保持同步。我怎样才能做到这一点？

顺便说一句，xcode 如何管理文件引用？pbxproj 文件中没有路径信息，每个文件引用只有一个“幻数”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T20:33:16.580

对于您的第一个问题，我怀疑唯一合理的方法是使用跨平台构建工具，例如 make 或 ANT，并为每个目标单独包含。如果您随后使用每个平台的本机工具 Xcode 和 VS 包装这些 makefile，这可能会更容易管理。

您的第二个问题令人费解，因为 pbxproj 文件确实具有每个文件的显式路径以及搜索路径集，请参见下面的示例。

492991C11534DE51003993BA /* KeyboardButton.m */ = {isa = PBXFileReference; 文件编码 = 4; lastKnownFileType = sourcecode.c.objc; 名称 = 键盘按钮.m; 路径 = GUI/iPad/Session/Keyboard/KeyboardButton.m；源树 = ""; };

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-20T08:42:39.523

将文件添加到 XCode 项目是很奇怪的。例如，我还没有发现 XCode 如何计算对象字典的哈希值。

但是经过一些分析后，我编写了一个小工具来将文件添加到 xcode 项目中。它正好符合我的需求，但可以扩展。如果您有扩展需要添加文件，请随时通过 github 与我联系，例如*仅为选定目标添加构建规则*，但我尚未实现，因为我认为 >99% 不需要此功能的项目。

XCodeControl项目本身就是一个[macOS](https://github.com/ikrabbe/XCodeControl) XCode 项目，因为它最容易阅读和修改 .pbxproj 文件，这些文件是`NSDictionary`对象的简单序列化。当然，苹果在其序列化中添加了一些盐，因此[XCodeControl](https://github.com/ikrabbe/XCodeControl)的输出看起来与苹果产生的完全不同，但它仍然可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-26T02:38:26.653

# .pbxproj 文件格式

如果您对`.pbxproj`文件格式感兴趣，可以查看此[http://www.monobjc.net/xcode-project-file-format.html](http://www.monobjc.net/xcode-project-file-format.html)

哈希码由 生成`UUID`。

您可以查看这个问题[project.pbxproj hashing for files - 使用什么哈希以及如何使用？](https://stackoverflow.com/questions/22648347/project-pbxproj-hashing-for-files-what-hash-is-used-and-how)

# 如何更改 pbxproj？

## 1\. Ruby 的 CocoaPods：

Cocoapods 有一个用于编辑 Xcode 项目的 Ruby API。 [https://github.com/CocoaPods/Xcodeproj](https://github.com/CocoaPods/Xcodeproj)

## 2\. Python 工具`pbxproj`：

如果要`.pbxproj`手动添加文件，可以试试python工具`pbxproj`

通过以下方式安装：`sudo pip install pbxproj`

更多信息，请访问[https://github.com/kronenthaler/mod-pbxproj/wiki/CLI](https://github.com/kronenthaler/mod-pbxproj/wiki/CLI)

玩得开心~

# android - 选中项目时使用选取框使文本滚动

> ID：10999694
> 
> 赞同：0
> 
> 时间：2012-06-12T15:18:57.013
> 
> 标签：android, android-listview, textview

我使用可检查的列表视图（我已设置：）`Mylistview.setChoiceMode(1)`。

在每一行内，我有 2 个 ImageViews 和 2 个 TextViews。

我希望当我的项目被选中时，如果文本太长，TextViews 中的文本会滚动。因此，在我的行的 XML 中，我为我的两个 TextViews 分配了以下内容：

```
android:singleLine="true" 
android:ellipsize="marquee" 
android:marqueeRepeatLimit="marquee_forever" 
```

不幸的是，这只会在项目获得焦点且未选中时才会滚动。

所以我想到的解决方案是：

1）制作我自己的自定义TextView类，并在检查时使其聚焦（我不知道是否可能？）

2）即使我们处于触摸模式，也将焦点放在选中的项目上（使用`SetFocusableInTouchMode`）

我还没有完成第二个解决方案，如果我想制作自己的自定义 TextView，我不知道哪个方法会覆盖。

你能帮我在检查项目时让文本滚动吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:24:14.293

您需要执行以下操作。

```
int scrollAmount = mTextView.getLayout().getLineTop(mTextView.getLineCount())
        -mTextView.getHeight();

// if there is no need to scroll, scrollAmount will be <=0
if(scrollAmount>0)
    mTextView.scrollTo(0, scrollAmount);
else
    mTextView.scrollTo(0,0); 
```

# scala - 划分 Scala 迭代器会导致 GCoverhead/JavaHeapSpace 问题

> ID：10999703
> 
> 赞同：1
> 
> 时间：2012-06-12T15:19:12.650
> 
> 标签：scala, iterator, duplicates, slice, divide

我正在使用 Scala 处理大数据，因此内存和时间对我来说比通常更重要。我试图通过细分大型源文件`Iterator[String]`获得的初始值来提高某些评估的速度，`getLines`以便并行进行一些子评估并合并结果。我通过递归地`slice`将迭代器分成两半并调用每个子迭代器上的递归函数来做到这一点。现在，我想知道为什么我得到 GCoverhead 或 JavaHeapSpace 异常，虽然“关键”元素只在递归步骤之前评估一次（为了获得迭代器的大小），但我认为不在递归步骤中，因为`slice`再次返回一个迭代器（这在实现上是非严格的）。在连接子列表之前，以下（简化！）代码将无法应用于 ~15g 文件。

我`.duplicate`在每个步骤中使用。我查了api，文档`.duplicate`说“实现可能为一个迭代器迭代的元素分配临时存储空间，但另一个迭代器还没有。”，但还没有元素被迭代。有人可以给我一个提示，那里出了什么问题以及如何解决这个问题？太感谢了！

```
type itType = Iterator[String]
def src = io.Source.fromFile(args(0)).getLines

// recursively divide into equal size blocks in divide&conquer fashion
def getSubItsDC(it: itType, depth: Int = 4) = {
    println("Getting length of file..")
    val totalSize = src.length
    println(totalSize)
    def rec(it_rec: itType = it, depth_rec: Int = depth, size: Int = totalSize): 
        List[itType] = depth_rec match {
            case n if n > 0 => 
                println(n)
                val (it1, it2) = it_rec.duplicate
                val newSize = size/2
                rec(it1 slice (0,newSize), n-1, newSize) ++ 
                    rec(it2 slice (newSize,size), n-1, newSize)
            case n if n == 0 => List(it_rec)
    }
    println("Starting recursion..")
    rec()
}
getSubItsDC(src) 
```

在 REPL 中，代码以任意大小的迭代器运行同样快（当硬编码 totalSize 时），因此我假设了正确的惰性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:29:42.750

我认为您最好使用`itr grouped size`来获得`Iterator[Iterator[String]]`(a `GroupedIterator`)：

```
scala> val itr = (1 to 100000000).iterator grouped 1000000
itr: Iterator[Int]#GroupedIterator[Int] = non-empty iterator 
```

这将允许您分块处理文件的某些部分。

### 为什么您的解决方案使用太多内存

复制 an`Iterator`显然**是**一种操作，这意味着 Iterator 可能必须缓存其计算值。例如：

```
scala> val itr = (1 to 100000000).iterator
itr: Iterator[Int] = non-empty iterator

scala> itr filter (_ % 10000000 == 0) foreach println
10000000
....
100000000 
```

但是当我复制时：

```
scala> val (a, b) = (1 to 100000000).iterator.duplicate
a: Iterator[Int] = non-empty iterator
b: Iterator[Int] = non-empty iterator

scala> a filter (_ % 10000000 == 0) foreach println

//oh dear, garbage collecting
Exception in thread "main" java.lang.OutOfMemoryError: GC overhead limit exceeded 
```

在这个例子中，当我运行时`a`，为了`b`重复，`a`已经迭代*但`b`没有*迭代的元素需要被缓存

# cocos2d-iphone - Cocos2D - 重新声明帧缓存？

> ID：10999705
> 
> 赞同：0
> 
> 时间：2012-06-12T15:19:23.077
> 
> 标签：cocos2d-iphone

我在我的主课上声明了这个：

```
[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"atlas.plist"];
CCSpriteBatchNode *batchNode = [CCSpriteBatchNode batchNodeWithFile:@"atlas.png"]; 
```

现在我在另一个班级，我想创建一个新的 batchNode 但从 atlas 获取 spriteFrames，这是在主类上声明的。我怎么做？我需要在我的其他班级再次使用这些相同的行吗？通过这样做，我是否会将多余的图像导入到 sharedSpriteFrameCache 中？我的想法是节省内存，而不是浪费。

有什么线索吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:21:12.977

`[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"atlas.plist"];`假设您没有删除这些精灵帧，则无需再次调用。

您将需要创建另一个批处理节点来放置精灵。

如果你再次尝试将精灵帧添加到缓存中，你不会浪费空间，精灵帧只会添加一次，但是当 cocos2D 解析文件并确定每个精灵帧是否确实存在时，你会浪费时间已经添加。

# asp.net - asp.net viewstate 字符编码特殊字符

> ID：10999710
> 
> 赞同：1
> 
> 时间：2012-06-12T15:19:42.597
> 
> 标签：asp.net, character-encoding, viewstate

我正在尝试查看是否有其他人遇到过这种情况以及是否有可能的解决方案。当用户输入一个特殊字符（比如版权符号）时，它会正确显示，但是在我将数据保存到视图状态 a ? 出现。

有没有其他人遇到过这个问题，我怎样才能让数据保存符号。我知道首选的方法是让他们编码，但他们是平面设计师，不明白。我使用的编辑器（obout）也插入了未编码的符号，所以我的手也被绑在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T00:38:17.840

在挖掘了所有内容之后，其中一个存储过程引用了一个 varchar 而不是 nvarchar，所以这就是问题所在。

nvarchar 列可以存储任何 Unicode 数据。varchar 列仅限于 8 位代码页。

# c# - 根据表格Btns添加的方法

> ID：10999713
> 
> 赞同：-2
> 
> 时间：2012-06-12T15:19:50.757
> 
> 标签：c#, winforms, class

使用 Winforms C#

有没有办法重用一个方法，但是当用户在表单上选择另一个按钮时，这些方法会在旧图上添加一个图。让我再解释一下。

我有一个带有“加法”方法的课程

```
`double weightIn = 0.01;

public double addition(double weightOut)
{
    return weightOut = (weightIn + 0.12);
}` 
```

我有两个 Btns。Btn1 和 Btn2。

当我选择 Btn1 时，我执行了该方法，结果为 0.13

我需要它，所以当我选择 Btn2 时它会发生变化，将 0.12 添加到该结果中。

另外，如果再次选择 Btn 1，我需要它回到 0.13。

我该怎么做呢？我曾尝试使用 flags1、flags2 并这样做，但没有成功。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:28:44.790

您可以使用布尔值（标志）来确定它是否已被添加，可能会更改按钮的背景颜色以反映状态。正如其他人所说，复选框听起来更有意义，但我会在这里尽我所能。

您还可以使用与按钮相对应的双精度数组。

```
double[] bttn=new double[6]{0,0,0,0,0,0};

double weighin {get { 
                      double temp=0;
                      foreach (double d in bttn) 
                      temp=temp+d;
                      return d;
                     }
                } 
```

然后在按钮点击事件

```
private void Button_Click(object sender, EventArgs e)
{
    switch ((Control)sender).Name)
    {
        //so what happens here is, if the value is 0 make it the value indicated else make it 0
        case "Button0":bttn[0] = bttn[0]==0 ? 0.01 : 0;
                       break;
        case "Button1":bttn[1] = bttn[0]==0 ? 0.12 : 0;
                       break;
        case "Button2":bttn[2] = bttn[0]==0 ? 0.24 : 0;
                       break;
        case "Button3":bttn[3] = bttn[0]==0 ? 0.48 : 0;
                       break;
        case "Button4":bttn[4] = bttn[0]==0 ? 0.96 : 0;
                       break;
        case "Button5":bttn[5] = bttn[0]==0 ? 1.92 : 0;
                       break;
    }
} 
```

然后要使用它，您只需使用称重。它将添加数组的所有元素。

```
double MyWeight = weighin; 
```

我没有测试任何这段代码的语法

# wpf - WPF 统一网格布局

> ID：10999715
> 
> 赞同：1
> 
> 时间：2012-06-12T15:20:04.063
> 
> 标签：wpf, layout, grid, uniformgrid

我有一个`ItemsControl`计划在其中托管水果对象的列表。我有一个`Fruit`对象列表，它们都有自己的`DataTemplate`s。我有一个`Grape`对象，一个`Orange`对象和一个`Kiwi`对象。

我想使用 a`UniformGrid`以使所有单元格都具有相同的大小，但我希望`Kiwi`对象仅跨越 1 个单元格，我希望`Grape`跨越 2 个单元格（`ColumnSpan = 2`）并且我希望`Orange`控件跨越 4 个单元格（`ColumnSpan = 2`和`RowSpan = 2`）

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:05:16.507

a 中的项目`UniformGrid`不能跨越多个单元格。

为什么不使用常规`Grid`而不是设置行/列的高度/宽度，`*`以便它们的大小都相同？如果您希望单元格是高度与宽度匹配的完美正方形，请务必将 Grid 绑定`Height`到`Width`，反之亦然。

应该注意的是，您需要在 中应用 Grid 定位属性`ItemContainerStyle`，而不是在项目本身上，因为在将该项目添加到之前，`ItemsControl`将每个元素包装在 a中（有关更多详细信息，请参阅我的博客[文章](http://rachel53461.wordpress.com/2011/09/17/wpf-itemscontrol-example/)）`ContentPresenter``ItemsPanel`

```
<ItemsControl ItemsSource="{Binding MyCollection}">
    <!-- ItemsPanelTemplate -->
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
            </Grid>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <!-- ItemContainerStyle -->
    <ItemsControl.ItemContainerStyle>
        <Style>
            <Setter Property="Grid.Column" 
                    Value="{Binding ColumnIndex}" />
            <Setter Property="Grid.Row" 
                    Value="{Binding RowIndex}" />

            <!-- Can either use a DataTrigger to determine these values, 
                 or store them on the object itself -->
            <Setter Property="Grid.RowSpan" 
                    Value="{Binding RowSpan}" />
            <Setter Property="Grid.ColumnSpan" 
                    Value="{Binding ColumnSpan}" />
        </Style>
    </ItemsControl.ItemContainerStyle>
</ItemsControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:45:04.567

您不能在统一网格中进行行或列跨越 - 请参阅下面的 stackoverflow 问题

[WPF：是否可以在 UniformGrid 中进行行/列跨度？](https://stackoverflow.com/questions/10603452/wpf-is-it-possible-to-do-a-row-column-span-in-uniformgrid)

但是，如果您的项目具有统一的尺寸，则可以使用 WrapPanel 实现类似的效果。这是一个例子

```
<ItemsControl Width="300">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel IsItemsHost="True" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.Items>
        <Rectangle Fill="Orange" Height="100" Width="100" />
        <Rectangle Fill="Red" Height="100" Width="100" />
        <Rectangle Fill="Blue" Height="100" Width="100" />
        <Rectangle Fill="Green" Height="100" Width="200" />
        <Rectangle Fill="Yellow" Height="100" Width="100" />
        <Rectangle Fill="Brown" Height="100" Width="100" />
        <Rectangle Fill="Black" Height="100" Width="200" />
    </ItemsControl.Items>
</ItemsControl> 
```

# core-data - 以老式方式提供 UITableView 核心数据

> ID：10999717
> 
> 赞同：1
> 
> 时间：2012-06-12T15:20:07.557
> 
> 标签：core-data, uitableview, nsfetchedresultscontroller

有没有人有一个例子来说明如何*有效地*为 UITableView 提供来自核心数据模型的数据，最好包括使用部分（通过引用的属性），*而不*使用 NSFetchedResultsController？

在 NSFetchedResultsController 可用之前这是如何完成的？理想情况下，样本应该只获取正在查看的数据，并在必要时提出额外的请求。

谢谢，

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:09:30.563

作为记录，我同意 CommaToast 的观点，即实施替代版本的`NSFetchedResultsController`. 事实上，我想不出我会提倡这样做的场合。

话虽如此，出于教育的目的，我想：

*   在创建时，针对托管对象上下文`NSFetchedResultsController`运行相关`NSFetchRequest`以创建初始结果集；
*   随后——如果它有一个委托——它`NSManagedObjectContextObjectsDidChangeNotification`从托管对象上下文中侦听。收到该通知后，它会更新其结果集。

获取请求位于谓词之上，并且谓词不能总是分解为它们引用的键（例如，如果您创建一个 via `predicateWithBlock:`）。此外，尽管插入和删除的列表非常明确，但已更改对象的列表并未提供有关这些对象如何更改的线索。所以我想它只是针对更改和插入记录的组合集重新运行 fetch 请求中提供的谓词，然后适当地累积结果，从删除的集中删除它之前考虑过的任何结果。

每当处理具有获取限制的获取请求时，您可能可以做更有效的事情。明显的观察结果，直接从我的脑海中浮现：

*   如果您已经有足够的对象，则这些对象都没有被删除或修改，并且新插入或修改的对象都没有比您拥有的对象更高的排序位置，那么显然没有要传播的更改，您无需运行新查询；
*   即使你丢失了一些你拥有的东西，如果你保留了最低的那个，那么你就有了所有没有改变的东西的上限，所以如果改变和插入的东西和你已经拥有的东西一起做更多那么足够了，您还可以避免新的查询。

逻辑扩展似乎是，只有当您出现在删除、插入和更改修改您的排序列表的位置时，您才需要重新询问托管对象上下文，以便 - 在将其削减到给定的获取限制之前 -底部的对象不是您上次拥有的对象。原因是您对未持有的存储对象与插入和修改一无所知；你只知道那些你没有持有的人与你以前拥有的人相比如何。

# r - 将调和函数拟合到 R 中的时间序列中

> ID：10999725
> 
> 赞同：1
> 
> 时间：2012-06-12T15:20:34.100
> 
> 标签：r, cycle, trigonometry

![在此处输入图像描述](../Images/62fd2d7de3955138e183a53d87eba0db.png)

我从另一个回归中得到了以下时间序列的残差。一个指数是一天。您可以直接观察年份周期。

目的是通过它拟合调和函数，以解释底层时间序列的进一步部分。

我非常感谢您关于使用哪个函数来估计正确参数的想法！从 acf 我们得知还有一个周周期。然而，这个问题我稍后会用 sarima 来解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T08:46:08.793

这似乎是傅立叶变换的设计目的。

尝试

```
fftobj = fft(x)
plot(Mod(fftobj)[1:floor(length(x)/2)]) 
```

该图中的峰值对应于拟合中具有高系数的频率。Arg(fftobj) 将为您提供阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T11:55:30.370

好吧，我试过了，但它提供了一个看起来像指数分布的预测。我同时以另一种方式解决了这个问题。我为每个月添加了一个因子组件并绘制了一个回归。在下一步中，我对该回归的结果进行了平滑处理，得到了一个比调和函数更准确的年内模式。例如，在 6 月和 7 月期间（大约 185 点），通常有一个低水平，但也有大量的峰值。

# css - 绕过覆盖“helvetica”字体系列的@font-face 声明

> ID：10999728
> 
> 赞同：9
> 
> 时间：2012-06-12T15:20:51.393
> 
> 标签：css, font-face, bookmarklet

我有一个小书签，可以将小部件插入任何网站的页面。`@font-face`具有以下 CSS声明的某个站点破坏了小部件的样式：

```
@font-face {
    font-family: "helvetica";
    src: url("http://cdn2.yoox.biz/Os/fonts/helveticaneueltstdmdcn.eot?iefix") format("eot"),
         url("http://cdn2.yoox.biz/Os/fonts/helveticaneueltstdmdcn.woff") format("woff"),
         url("http://cdn2.yoox.biz/Os/fonts/helveticaneueltstdmdcn.ttf") format("truetype"),
         url("http://cdn2.yoox.biz/Os/fonts/helveticaneueltstdmdcn.svg#svgFontName") format("svg");
} 
```

我的书签插入的小部件到处都使用 helvetica，在这个站点上它看起来很糟糕，因为浏览器将 helvetica 映射到该`@font-face`名称的声明，而不是标准的 helvetica 系统字体。

问题：有没有办法覆盖/绕过这个`@font-face`声明或创建另一个`@font-face`映射到系统 helvetica 字体的声明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T15:44:04.213

除非样式表通过在小部件的样式表之后引用样式表来覆盖它，否则`!important`这可能会起作用：

```
@font-face {
    font-family: 'ProperHelvetica'; /* Make a name for the "proper" Helvetica */
    src: local('helvetica'); /* Assign it to the Helvetica font on the user's system */
}
.your-widget {
    font-family: 'ProperHelvetica', helvetica, sans-serif !important; /* Make everything 
in your widget use the "proper" Helvetica and if the user doesn't have it,
use the site's helvetica. */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:37:14.110

您可以添加以下 css 来创建映射到本地安装字体的自定义字体名称：

```
@font-face{
    font-family: mycustomuniquefontname;
    src: local("Helvetica");
} 
```

对于小部件的样式，您应该使用这个：

```
font-family: mycustomuniquefontname, Helvetica, sans-serif; 
```

如果您使用更多字体样式，例如粗体和斜体，则必须定义所有字体：

```
@font-face{
    font-family: mycustomuniquefontname;
    src: local("Helvetica");
}
@font-face{
    font-family: mycustomuniquefontname;
    src: local("Helvetica Bold");
    font-weight: bold;
}
@font-face{
    font-family: mycustomuniquefontname;
    src: local("Helvetica Italic");
    font-style: italic;
}
@font-face{
    font-family: mycustomuniquefontname;
    src: local("Helvetica Bold Italic");
    font-weight: bold;
    font-style: italic;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:34:29.687

当我提交这个问题时，我得到了一些启发。我发现的作品如下......

创建以下 css 规则：

```
@font-face {
    font-family: 'RealHelvetica';
    src: local('helvetica');
} 
```

在需要真正 helvetica 系统字体的元素中，将字体系列指定为“RealHelvetica”，而不仅仅是 helvetica：

```
.widget {
    font-family: 'RealHelvetica',helvetica,sans-serif !important;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:39:18.093

将您的小部件包装在 iframe 中。不知道这是否是最好的解决方案，但它是*一个*解决方案。

[http://jsfiddle.net/bwcNX/](http://jsfiddle.net/bwcNX/)

```
var $frame = $('<iframe style="width:200px; height:100px;">');
$('body').append( $frame );
setTimeout( function() {
    var $doc = $($frame[0].contentWindow.document.documentElement);
    $doc.html("<head><title>abc</title></head><body><div>def.</div></body></html>");
    $doc.find('div').append('<div>ghi.</div>');
}, 1 ); 
```

奖励：将来应该证明您的小部件可以抵抗大多数其他 CSS 或字体相关问题。

# java - Neo4j 在创建之前检查节点是否存在？

> ID：10999730
> 
> 赞同：8
> 
> 时间：2012-06-12T15:21:09.103
> 
> 标签：java, neo4j

我有一种感觉，这一切都错了。但不管怎么说。

我有一个 sql 数据库，它本质上是一个有目的的非规范化表，我构建它是为了让这个任务对我来说更容易，所以我可以从一个表中获取内容。

我所拥有的是一对表，如下所示：

```
user_lo | user_hi | something_else | other stuff
1000    | 1234    | 1231251654     | 123
1050    | 1100    | 1564654        | 45648
1080    | 1234    | 456444894648   | 1 
```

等等。

所以对于我的 neo4j 图形数据库，我希望每个用户 id 作为一个节点，其他的东西不太重要，但基本上是关系中的东西。

我只希望每个用户有一个节点，所以我的感觉是，如果我做这样的事情：

```
while (rs.next()) {
    node_lo = db.createNode();
    node_lo.setProperty("user_id", rs.getInt(1));
    node_hi = db.createNode();
    node_hi.setProperty("user_id", rs.getInt(2));
} 
```

当我们第二次添加 user_id 为 1234 的节点时，它只会创建一个新节点，但我想要的是它只是抓住这个节点而不是创建它，这样我就可以将它添加到 1080 的关系中这个案例。

那么这样做的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T15:40:05.900

你看过[CREATE UNIQUE](http://docs.neo4j.org/chunked/stable/query-create-unique.html)吗？

如果您不能使用 Cypher，也许您可​​以使用[唯一节点](http://docs.neo4j.org/chunked/snapshot/transactions-unique-nodes.html#transactions-get-or-create)？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T02:44:48.810

使用索引搜索，如果没有找到，则创建一个新的。

```
Index<Node> userIndex = graphDatabaseService.index().forNodes('UserNodes');

IndexHits<Node> userNodes = userIndex.get('id', 1234);

if(!userNodes.hasNext()){
    //Create new User node
} else {
    Node userNode = userNodes.next();
} 
```

这是您正在寻找的操作类型吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T22:24:18.957

您可能希望使用 Neo4j 提供的[UniqueNodeFactory](http://docs.neo4j.org/chunked/snapshot/transactions-unique-nodes.html#transactions-get-or-create)。

```
 public Node getOrCreateUserWithUniqueFactory( String username, GraphDatabaseService graphDb )
{
    UniqueFactory<Node> factory = new UniqueFactory.UniqueNodeFactory( graphDb, "UserNodes" )
    {
        @Override
        protected void initialize( Node created, Map<String, Object> properties )
        {
            created.setProperty( "id", properties.get( "id" ) );
        }
    };

    return factory.getOrCreate( "id", id );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T13:30:33.003

规范化您的 SQL 表，使其看起来像节点和关系。然后在您的迁移中使用密码，您可以通过类似的方式使迁移重新运行

```
start a = node:node_auto_index('id:"<PK_Value>"')
delete a

create a = {id: "<PK_VALUE>", etc} 
```

对于节点，因为你应该在你的多对多中间表中：

```
start LHS = node:node_auto_index('id:"<LHS_PK>"'),
      RHS = node:node_auto_index('id:"<RHS_PK>"')
create unique LHS=[:<relType> {<rel props>}]->RHS 
```

现在您最终将没有重复，并且可以根据需要重新运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-06T16:20:35.310

使用此函数： 其中：ID 是您要检查是否已存在的键类型：是节点的类型（标签）此函数将创建节点并返回它，然后您可以添加更多属性。

```
public static Node getOrCreateUserWithUniqueFactory( long ID, GraphDatabaseService graphDb, String Type )
{
    UniqueFactory<Node> factory = new UniqueFactory.UniqueNodeFactory( graphDb, Type )
    {
        @Override
        protected void initialize( Node created, Map<String, Object> properties )
        {

            created.addLabel( DynamicLabel.label( Type ) );
            created.setProperty( "ID", properties.get( "ID" ) );
        }
    };

    return factory.getOrCreate( "ID", ID );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-14T15:03:40.787

使用密码查询，您可以使用以下语法创建唯一节点，

```
CYPHER 2.0 merge (x:node_auto_index{id:1}) 
```

在进行 REST 调用时，可以进行批量插入，例如

```
$lsNodes[] = array(

            'method'=> 'POST', 'to'=> '/cypher',

            'body' => array(
                'query' => 'CYPHER 2.0 merge (x:node_auto_index{id_item:{id}})',
                'params'    =>  array('id'=>1)
            ),
            'id'=>0

        );

        $sData = json_encode($lsNodes); 
```

类似地，对于在批处理请求中创建关系，请执行以下操作

```
$lsNodes[] = array(

                        'method'=> 'POST', 'to'=> '/cypher',

                        'body'  => array(
                            'query'     => 'start a=node:node_auto_index(id={id1}), b = node:node_auto_index(id={id2}) create unique a-[:have{property:30}}]-b;',
                            'params'    => array(
                                'id1'  => 1, 'id2'=>  2
                            )
                        ),
                        'id'    => 0

                    );
$sData = json_encode($lsNodes); 
```

# php - Google API：通过 Google Talk 通知日历条目更改

> ID：10999731
> 
> 赞同：0
> 
> 时间：2012-06-12T15:21:10.910
> 
> 标签：php, google-calendar-api, google-talk

我在 Google Talk 中有一个日历和一些用户，我想在事件发生变化时通知它们。

所以我需要使用 Calendar API 和 Talk API，两者都在 API 控制台中启用。

有谁知道我如何利用它？最好使用PHP。

也许这是以前做过的或者其他人可以使用的。提前感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:43:01.260

你几乎不需要Talk API；Google Talk 是 XMPP - 看看这个与 PHP 连接的问题：

[PHP 聊天机器人：Google Talk](https://stackoverflow.com/questions/1220340/php-chat-bot-google-talk)

此外，看起来有人已经在 java 中做了类似的事情：

[http://code.google.com/p/notifical/](http://code.google.com/p/notifical/)

# iis-7 - IIS 7 URL 重写匹配 URL

> ID：10999735
> 
> 赞同：1
> 
> 时间：2012-06-12T15:21:20.417
> 
> 标签：iis-7, url-rewriting

我正在尝试使用 URL Rewrite 模块在 IIS 7 中设置规范的默认 URL。我认为我误解了“匹配 URL”字段的使用方式。以下似乎没有做任何事情：

```
 <rewrite>
        <rules>
            <rule name="EnforceDefaultPage">
                <match url="^http://(?:www\.)?mydomain\.com(?:/)?(?:blog\.aspx)?$" />
                <action type="Redirect" url="http://www.mydomain.com/blog" appendQueryString="false" />
            </rule>
        </rules>
    </rewrite> 
```

我注意到在很多示例中人们使用 HTTP_HOST 变量添加了一个条件......但这与匹配 url 有什么关系？似乎我应该能够省略任何条件，因为我的正则表达式完全符合我的要求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:20:34.483

啊，我终于想通了。显然，有多少 URL 可用于匹配取决于 web.config 在目录层次结构中的位置。由于我将代码放在 web 根目录的 web.config 中，它只能匹配域名之后的任何内容（即它可以匹配 ' [http://www.blog.com/](http://www.blog.com/)中的 'blog.com/' 之后的所有内容'）。

我在这里找到了答案：[http ://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-configuration-reference](http://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-configuration-reference)

"请注意，传递给分布式规则的输入 URL 字符串始终与定义规则的 Web.config 文件的位置相关。例如，如果请求[http://www.mysite.com/content /default.aspx?tabid=2&subtabid=3](http://www.mysite.com/content/default.aspx?tabid=2&subtabid=3)，并且在 /content 目录中定义了重写规则，然后该规则将这个 URL 字符串 default.aspx 作为输入。”

# php - url解析器的正则表达式

> ID：10999740
> 
> 赞同：5
> 
> 时间：2012-06-12T15:21:46.387
> 
> 标签：php, regex, preg-match, regular-language

```
<?php

    $string = 'user34567';

            if(preg_match('/user(^[0-9]{1,8}+$)/', $string)){
                echo 1;
            }

?> 
```

我想检查字符串是否有单词**user**后跟数字，最多可以是 8 个符号。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T15:23:47.183

你实际上非常接近：

```
if(preg_match('/^user[0-9]{1,8}$/', $string)){ 
```

“必须在字符串开头匹配”的锚点应该一直在前面，然后是“用户”文字；然后你指定字符集`[0-9]`和乘数`{1,8}`。最后，您以“必须在字符串末尾匹配”锚点结束。

对您的原始表达的一些评论：

1.  匹配字符串的`^`开头，因此将其写入此表达式中的任何其他位置，但开头不会产生预期的结果
2.  是`+`乘数；`{1,8}`也是一个，但表达式后只能使用一个乘数
3.  除非您打算使用在表达式中找到的数字，否则不需要括号。

顺便说一句，`[0-9]`你也可以使用`\d`. 这是一个缩短正则表达式的自动字符组，尽管这个特定的字符组并没有保存太多字符；-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:28:44.417

通过使用`^`and `$`，你只在模式是唯一的东西时匹配。那是你要的吗？如果是这样，请使用以下内容：

```
preg_match( '/^user[0-9]{1,8}[^0-9]$/' , $string ); 
```

如果您想在一行中的任何位置找到此模式，我会尝试：

```
preg_match( '/user[0-9]{1,8}[^0-9]/' , $string ); 
```

与往常一样，您应该使用 RegexPal 之类的参考工具单独进行正则表达式测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:23:53.903

你很接近，这是你的正则表达式：`/^user[0-9]{1,8}$/`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T15:23:57.697

请尝试以下正则表达式：

`/^user([0-9]{1,8})$/`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T15:23:58.337

使用这个正则表达式：

```
/^user\d{1,8}$/ 
```

# extjs - ExtJS 4.1：如何在组合框中设置预选项目？

> ID：10999741
> 
> 赞同：0
> 
> 时间：2012-06-12T15:21:48.677
> 
> 标签：extjs, extjs4.1

我正在使用 ExtJS 4.1，我需要创建一个包含客户列表的组合框，并且我想在其中设置一个特定的预选项目，但我不知道该怎么做。这是创建我的组合框的代码：

```
xtype: 'combobox',
fieldLabel: 'customer',
name: 'customer_id',
allowBlank:false,
afterLabelTextTpl: required,
//data store
store: Ext.create('Ext.data.Store', {
    autoDestroy: true,
    model: 'customer_model',
    autoLoad: true,
    proxy: {
        type: 'ajax',
    url: 'load.php?item=customer',            
    reader: {
        type: 'json',
        successProperty: 'success',
        root: 'data'
    }
    }
}),
valueField: 'id',
displayField: 'company',
typeAhead: true,
queryMode: 'remote',
emptyText: '' 
```

如您所见，我的组合框由数据存储填充，该数据存储基于名为“customer_model”的数据模型构建。这是数据模型的代码：

```
Ext.define('customer_model', {
    extend: 'Ext.data.Model',
    fields: [
        {type: 'int', name: 'id'},
        {type: 'string', name: 'company'},
        {type: 'string', name: 'vat'},
        {type: 'string', name: 'ssn'},
        {type: 'int', name: 'ref_id'}
    ]
}); 
```

好吧，我想配置我的组合框，以便在加载页面时自动选择某个项目，例如 id 等于 1 的客户。谁能帮我 ？提前致谢。恩里科。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:55:34.140

在 Ext.js 3.2.1 中，您可以这样做：

```
combobox.setValue(id); 
```

这假定组合框配置为使用 id 作为 valueField。您的代码似乎表明是这种情况。您还需要引用要设置值的 id 值。这里需要注意的是，您需要确保此代码仅在模型加载后执行，否则组合框将不会显示任何内容。您可以通过在 ajax 调用的回调方法或商店的加载事件中设置组合框来确保这一点。

我查看了 Ext.js 4.1 的文档，并且这种方法似乎仍然存在。我相信这应该可以解决问题。

编辑：清晰度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T11:28:29.503

以编程方式使用 combo.setValue(val) 或以声明方式：

```
{
    xtype: 'combo',
    value: val,
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-13T12:52:56.607

如果要选择商店的第一个值，可以执行 combo.select(combo.getStore().getAt(0)) 它将选择组合商店索引 0 处的值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T11:17:55.610

感谢克里斯托弗的帮助，我编写了我的代码的工作版本，我决定在这里发布它，也许它可能对某人有用......：

```
buttons: [{
    text: 'Load',
    handler: function(){
        var form = this.up('form').getForm();
        var combobox = form.findField('ref_id_combo');
        formPanel.getForm().load({
            url: <?php echo "'update_loader.php?id=".$_GET['id']."&item=customer',"; ?>
            waitMsg: 'Loading...',
            success: function(form, action) {
                combobox.setValue(<?php echo  get_property_id("ref_id","customer",$_GET['id']);?>);
            }
        });
    }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-17T05:08:52.707

如果您先创建自己的商店，则可以使用`afterrender: function(combo){}`

```
listeners: {
    afterrender: function (combo) {
        var record = yourStore.getAt(0);
        var abbr= record.get('abbr');
        combo.setValue(abbr);
    }
} 
```

# multithreading - vxworks 任务名称可以有空格或特殊字符吗？

> ID：10999742
> 
> 赞同：0
> 
> 时间：2012-06-12T15:21:53.367
> 
> 标签：multithreading, scheduled-tasks, vxworks

vxworks 任务名称的合法字符是什么？

void startTask( void ) { char taskname[ 100 ] = "foo";

任务生成（任务名称，...）}

而且，taskSpawn 是否复制任务名称？因为显然 taskname 只是函数范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T11:14:14.100

任务名称可以是任何字符串，但 VxWorks 会在前面附加一个“t”并将其限制为 10 个字符。IE 如果您的任务名称是“我的新任务”，它将显示为“tMy New Ta”。为了直接回答您的问题，是的，它会复制名称，因此您可以动态创建不需要驻留在全局内存中的任务名称。

# ruby - PhusionPassenger::Rack::ApplicationSpawner 中的异常 PhusionPassenger::UnknownError

> ID：10999744
> 
> 赞同：1
> 
> 时间：2012-06-12T15:21:56.213
> 
> 标签：ruby, sinatra

我正在为我的应用程序使用 sinatra，我将确切的副本从 devserver1 复制到 devserver2，但仅在 devserver1 上有效。

我在我的 devserver2 apache error.log 上得到了这个：

> PhusionPassenger::Rack::ApplicationSpawner 中的异常 PhusionPassenger::UnknownError（nil:NilClass (NoMethodError) 的未定义方法 `<<'）（进程 5516，线程 #）：

任何帮助深表感谢。

仅供参考：我正在使用 rvm 和 ruby​​-1.9.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T07:24:38.990

发现了错误。该应用程序正在访问具有 HTTP 身份验证的远程服务，它无法通过该身份验证，因此它超时。现在我的下一个问题是如何让应用绕过 HTTP 身份验证。

# oauth-2.0 - 为什么 OAuth 是一种可行的技术来防止 RESTful API 的 CSRF？

> ID：10999745
> 
> 赞同：2
> 
> 时间：2012-06-12T15:22:06.513
> 
> 标签：oauth-2.0, csrf, csrf-protection

[我对这个问题](https://stackoverflow.com/questions/2267637/what-are-some-viable-techniques-for-combining-csrf-protection-with-restful-apis)有一个确切的情况：将 csrf 保护与 RESTful API 结合起来有哪些可行的技术？

给出的一个[答案](https://stackoverflow.com/a/2267747/80353)是关于使用

*   使用 SSL 的基本身份验证
*   每个应用程序 1 个 API 密钥
*   身份验证

我已经确信实施 OAuth2.0，您将拥有每个应用程序的 access_token、client_id、client_secret。

但是，我不知道这实际上有助于防止 CSRF。

我的观点是，归根结底，您仍然需要 ssl。

因为在 OAuth2.0 中，当客户端应用程序代表资源所有者发送请求时，它们需要与数据参数一起发送，例如 client_id、client_secret 和 access token。

如果没有 HTTPS，如果 client_id、client_secret 和 access token 是通过泄漏或中间人知道的，那么仍然存在 CSRF 的机会，尽管由于 access token 的到期期限而很小。

我的理解正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T11:05:58.167

如果资源仅受 OAuth 2 保护，并且攻击者获得了 client_id、client_secret 和访问令牌，则根本不需要 CSRF。攻击者可以直接发送请求以使用受保护的资源并将被服务，因为 OAuth 2 不过滤请求的来源，它只需要一个访问令牌。

通常，您绝对应该对身份验证服务器和受保护资源都使用 HTTPS，以避免中间人攻击。但是，如果您使用“授权码授予”方案（即在您自己的 Web 应用程序中使用它），那么即使资源所有者也不知道访问令牌，他只能拦截授权码。因此，如果您的 Web 应用程序与授权服务器和受保护资源都有受信任的（例如 Intranet）连接，则可以安全地使用与受保护资源的未加密连接。

# powershell - Powershell 提示输入

> ID：10999755
> 
> 赞同：1
> 
> 时间：2012-06-12T15:22:36.323
> 
> 标签：powershell

我有几行在远程目录中查找的 powershell 代码

```
Get-ChildItem "\\box_lab001\f$\output files" -force | 
    Where-Object {!$_.PsIsContainer -AND $_.lastWriteTime -lt (Get-Date).AddMinutes(-5) } | 
    Select-Object LastWriteTime,@{n="Path";e={convert-path $_.PSPath}} | 
    Tee-Object "\\\box_lab001\c$\Users\john\Documents\output files_root.txt" | 
    Remove-Item -force 
```

我想要做的是让这个在多个盒子中可扩展，如果用户在 box_lab01 上看到问题，槽 10。然后他可以使用一个要求输入的开关运行脚本。然后它会单独运行命令，每次都替换 box_lab###，可能吗？

`C:\powershell.ps1 -input what boxes are having the issue? use three digit numbers only, comma separated`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T19:13:46.193

您想要添加一个参数，该参数将一组值作为输入。然后，您可以使用这些来检查每台机器：

```
[CmdletBinding()]
param(
    [int[]]
    # The numbers of the machines whose output files should be removed.
    $MachineNumbers
)

$MachineNumbers | ForEach-Object {
    $machineRoot = '\\box_lab{0:d3}' -f $_ 
    Get-ChildItem ('{0}\f$\output files' -f $machineRoot) -force | 
        Where-Object {!$_.PsIsContainer -AND $_.lastWriteTime -lt (Get-Date).AddMinutes(-5) } | 
        Select-Object LastWriteTime,@{n="Path";e={convert-path $_.PSPath}} | 
        Tee-Object ('{0}\c$\Users\john\Documents\output files_root.txt' -f $machineRoot)  | 
        Remove-Item -force 
```

该代码`('\\box_lab{{0:d3}}' -f $_)`将从用户传递的每个数字转换为一个零填充的三个字符串（这似乎是您的计算机命名方案）。然后你会这样调用你的脚本：

```
 Remove-OutputFiles -MachineNumbers (1..10)
 Remove-OutputFiles -MachineNumbers 1,2,3,4,5 
```

您可以给`MachineNumbers`参数一个合理的默认值，这样如果没有传递任何参数，它就会命中一组默认机器。

我还将将该`[CmdletBinding()]`属性添加到您的脚本，以便您可以传递`-WhatIf`给您的脚本并查看哪些文件将被删除而不实际删除它们：

```
Remove-OutputFiles -MachineNumbers (1..3) -WhatIf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:51:38.487

是的。

您可以使用[`Read-Host`](http://technet.microsoft.com/en-us/library/ee176935.aspx)提示输入。您可以使用`param(...)`向脚本添加参数：

```
param($input = $null)
if ($input) {
    $foo = Read-Host -Prompt $input
} 
```

然后，您可以使用以下方法获取各个数字`-split`：

```
$numbers = $foo -split ',' 
```

循环它们：

```
$numbers | ForEach-Object {
  ...
} 
```

您可以`$_`在块内使用来引用当前编号。

# c# - 获取当前 AD 站点中最近的域控制器，无需硬编码信息

> ID：10999758
> 
> 赞同：5
> 
> 时间：2012-06-12T15:22:44.170
> 
> 标签：c#, active-directory, ldap, directoryservices, domaincontroller

对于 Active Directory 在站点之间复制数据的时间过长的情况，我需要确保本地 AD 副本包含最新信息。

*   如何获取当前站点的域控制器列表？

[我在Codeproject](http://www.codeproject.com/Articles/18102/Howto-Almost-Everything-In-Active-Directory-via-C)或[StackOverflow](https://stackoverflow.com/search?q=%2bDomainController%20%2bsite)上没有找到任何东西

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T01:55:07.773

解决所有这些麻烦可能是浪费精力。除非您在查找域控制器的内置逻辑方面遇到问题，否则您应该使用返回一个的内置方法。根据微软的说法，它会自动尝试找到关闭的：[http](http://technet.microsoft.com/en-us/library/cc978016.aspx) ://technet.microsoft.com/en-us/library/cc978016.aspx 。

只需使用静态`DomainController.FindOne`方法并传入您的`directorycontext`.

**更新**
好吧，试试下面的代码，让我知道它是如何为你工作的。它每次 ping，返回往返时间，如果 -1（无连接）则跳过它。标记 PDC 状态（如果存在）。按 PDC 状态排序，然后是 ping 往返。

```
 static void Main(string[] args)
    {
        var dcsInOrder = (from DomainController c in Domain.GetCurrentDomain().DomainControllers
                          let responseTime = Pinger(c.Name)
                          where responseTime >=0
                          let pdcStatus = c.Roles.Contains(ActiveDirectoryRole.PdcRole)
                          orderby pdcStatus, responseTime
                          select new {DC = c, ResponseTime = responseTime} 
                          ).ToList();

        foreach (var dc in dcsInOrder)
        {
            System.Console.WriteLine(dc.DC.Name + " - " + dc.ResponseTime);
        }

        System.Console.ReadLine();
    }

    private static int Pinger(string address)
    {
        Ping p = new Ping();
        try
        {
            PingReply reply = p.Send(address, 3000);
            if (reply.Status == IPStatus.Success) return (int)reply.RoundtripTime;
        }
        catch { }

        return -1;

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T16:33:28.613

首先，我将回答您实际提出的问题：

```
System.DirectoryServices.ActiveDirectory.ActiveDirectorySite.GetComputerSite().Servers 
```

但似乎您在问如何确保您正在与可能的最近的域控制器交谈。Windows 并不完全提供此功能，它会做的最好的事情是在运行代码的同一站点中为您提供域控制器。

我认为首先要检查的是您的站点和子网配置是否正确。运行 Active Directory 站点和服务，并确保将子网和域控制器分配给正确的站点。

[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675900%28v=vs.85%29.aspx)（以及 Peter 的回答中的 Technet 文章）说您必须通过 DNS 名称搜索 DC Locator 才能尝试在当前站点中查找 DC。不知道Domain类的Name属性是不是DNS域名。

我必须假设 DomainController.FindOne 是[`DsGetDcName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675983%28v=vs.85%29.aspx). 在该链接中，您可以找到如何为该功能打开跟踪。如果您仍然有问题，您可以使用它，或者您应该只 PInvoke 这个函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T17:44:59.117

这是一个没有 DC 硬编码的代码示例。欢迎评论和批评。

```
 /// <summary>
    /// For best results ensure all hosts are pingable, and turned on.  
    /// </summary>
    /// <returns>An ordered list of DCs with the PDCE first</returns>
    static LinkedList<DomainController> GetNearbyDCs()
    {
        LinkedList<DomainController> preferredDCs = new LinkedList<DomainController>();
        List<string> TestedDCs = new List<string>();

        using (var mysite = ActiveDirectorySite.GetComputerSite())
        {
            using (var currentDomain = Domain.GetCurrentDomain())
            {
                DirectoryContext dctx = new DirectoryContext(DirectoryContextType.Domain, currentDomain.Name);
                var listOfDCs = DomainController.FindAll(dctx, mysite.Name);

                foreach (DomainController item in listOfDCs)
                {
                    Console.WriteLine(item.Name );
                    if (IsConnected(item.IPAddress))
                    {
                        // Enumerating "Roles" will cause the object to bind to the server
                        ActiveDirectoryRoleCollection rollColl = item.Roles;
                        if (rollColl.Count > 0)
                        {
                            foreach (ActiveDirectoryRole roleItem in rollColl)
                            {
                                if (!TestedDCs.Contains(item.Name))
                                {
                                    TestedDCs.Add(item.Name);
                                    if (roleItem == ActiveDirectoryRole.PdcRole)
                                    {
                                        preferredDCs.AddFirst(item);
                                        break;
                                    }
                                    else
                                    {

                                        if (preferredDCs.Count > 0)
                                        {
                                            var tmp = preferredDCs.First;
                                            preferredDCs.AddBefore(tmp, item);
                                        }
                                        else
                                        {
                                            preferredDCs.AddFirst(item);
                                        }
                                        break;
                                    }
                                } 

                            }
                        }
                        else
                        {
                            // The DC exists but has no roles
                            TestedDCs.Add(item.Name);
                            if (preferredDCs.Count > 0)
                            {
                                var tmp = preferredDCs.First;
                                preferredDCs.AddBefore(tmp, item);
                            }
                            else
                            {
                                preferredDCs.AddFirst(item);
                            }
                        }
                    }
                    else
                    {
                        preferredDCs.AddLast(item);
                    }
                }
            }
        }
        return preferredDCs;
    }
    static bool IsConnected(string hostToPing)
    {
        string pingurl = string.Format("{0}", hostToPing);
        string host = pingurl;
        bool result = false;
        Ping p = new Ping();
        try
        {
            PingReply reply = p.Send(host, 3000);
            if (reply.Status == IPStatus.Success)
                return true;
        }
        catch { }
        return result;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-12T16:07:50.353

这是我使用 powershell 的方法，但我确信它是 c# 等中的简单实现。如果正确设置了 DHCP，则子网中的主 DNS 服务器应该是最近的域控制器。所以下面的代码应该获取第一个 DNS IP 并将其解析为最近的 DC 的主机名。这不需要 RSAT 或凭据，并且不包含当前域的特定属性。

```
$NetItems = @(Get-WmiObject -Class Win32_NetworkAdapterConfiguration -Filter "IPEnabled = 'True'" -ComputerName $env:COMPUTERNAME)
foreach ($objItem in $NetItems)
{
    if ($objItem.{DNSServerSearchOrder}.Count -ge 1)
    {
        $PrimaryDNS = $objItem.DNSServerSearchOrder[0]
        $domain = $objItem.DNSDomain
        break
    }
}
[System.Net.Dns]::GetHostbyAddress($PrimaryDNS).hostname -replace ".$($domain)","" 
```

# mysql - 在 SQL 语句中使用 % 的性能变化

> ID：10999759
> 
> 赞同：0
> 
> 时间：2012-06-12T15:22:47.787
> 
> 标签：mysql, sql, indexing

我正在编写 SQL 查询，并且在查询中使用了 % 符号。例子：

```
SELECT * FROM TABLE A where state='NewYork%' 
```

我的问题是在变量位置使用 % 如何影响 MySQL 的性能？它如何与索引一起使用？

```
Ex 1: SELECT * FROM TABLE A where state='NewYork%'

Ex 2: SELECT * FROM TABLE A where state='%NewYork'

Ex 3: SELECT * FROM TABLE A where state='%NewYork%'

Ex 4: SELECT * FROM TABLE A where state='New%York' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:24:41.737

如果您不使用`LIKE`运算符，则很可能`%`会被视为与任何其他字符相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:26:07.377

`foo LIKE 'abc%'`如果您的查询看起来像或， MySQL 可以使用索引`foo LIKE 'abc%def%'`。它可以将索引用于第一个通配符之前的任何部分或字符串。如果您需要匹配字符串中任意位置的单词，您可能需要考虑使用`FULLTEXT`索引。

有关索引的更多详细信息：http: [//dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html](http://dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html)

全文搜索：[http ://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

在此处查看一些性能提示：http: [//forge.mysql.com/wiki/Top10SQLPerformanceTips](http://forge.mysql.com/wiki/Top10SQLPerformanceTips)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:30:16.913

我想你的意思是喜欢，

```
SELECT * FROM TABLE A where state like 'NewYork%'

Ex 1: SELECT * FROM TABLE A where state like 'NewYork%'

Ex 2: SELECT * FROM TABLE A where state like '%NewYork'

Ex 3: SELECT * FROM TABLE A where state like '%NewYork%'

Ex 4: SELECT * FROM TABLE A where state like 'New%York' 
```

如果您的引擎是 MyIsam、Aria 或 Innodb（mysql 5.6+），最好的方法是在该字段上建立全文索引，现在谈论`'%'`（通配符）您的 4 个示例中的最佳性能将在：

```
Ex 1: SELECT * FROM TABLE A where state like 'NewYork%' 
```

因为Mysql有一个单词列表，它会更快地识别以....开头的单词而不是以....结尾的单词。

# java - KSoap2 和 KvmSerializable - 如何发送复杂的对象，如 Stringarrays

> ID：10999763
> 
> 赞同：1
> 
> 时间：2012-06-12T15:23:07.973
> 
> 标签：java, android, web-services, ksoap2

我想将一个复杂的对象从我的 Ksoap 客户端发送到我的网络服务。这是我的类类别的一个对象。该代码基于本教程的示例：

[http://seesharpgears.blogspot.de/2010/10/ksoap-android-web-service-tutorial-with.html](http://seesharpgears.blogspot.de/2010/10/ksoap-android-web-service-tutorial-with.html)

Web 服务正在运行，并且 WSDL 文件显示类别对象。但是，如果我将类别对象发送到我的肥皂网络服务，则会出现以下错误：

> [错误] 尝试调用服务方法 getCategoryObject org.apache.axis2.AxisFault 时发生异常：未知类型 {http://ws.chathura.com}Category Logcat 显示以下内容：06-12 11:08:57.576: W /System.err(777)：SoapFault - 故障代码：'soapenv:Server' 故障字符串：'未知类型 {http://ws.chathura.com}Category' 故障：'null' 详细信息：org.kxml2.kdom.Node@ 4054a528

这是我在 Tomcat 7 上运行的 Java Webservice：

```
package com.chathura.ws;

import java.util.Vector;

public class HelloWorldWS
{

 public Category getCategoryObject(Category obj)
 {
  Category C1 = new Category();

    C1.setCategoryId(1);
    C1.setDescription("server desc");
    C1.setName("server Name");

    System.out.println(obj.getCategoryId());

    return C1;
 }
} 
```

这是我在 WebServer 上的类别类：

```
package com.chathura.ws;

public class Category {
 private int CategoryId;
 private String Name;
 private String Description;
 /**
  * @return the categoryId
  */
 public int getCategoryId() {
  return CategoryId;
 }
 /**
  * @param categoryId the categoryId to set
  */
 public void setCategoryId(int categoryId) {
  CategoryId = categoryId;
 }
 /**
  * @return the name
  */
 public String getName() {
  return Name;
 }
 /**
  * @param name the name to set
  */
 public void setName(String name) {
  Name = name;
 }
 /**
  * @return the description
  */
 public String getDescription() {
  return Description;
 }
 /**
  * @param description the description to set
  */
 public void setDescription(String description) {
  Description = description;
 }

} 
```

这是 WSDL 文件：

```
 This XML file does not appear to have any style information associated with it. The document tree is shown below.
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:ns1="http://org.apache.axis2/xsd" xmlns:ns="http://ws.chathura.com" xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:ax21="http://ws.chathura.com/xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" targetNamespace="http://ws.chathura.com">
<wsdl:documentation>Please Type your service description here</wsdl:documentation>
<wsdl:types>
<xs:schema attributeFormDefault="qualified" elementFormDefault="qualified" targetNamespace="http://ws.chathura.com/xsd">
<xs:complexType name="Category">
<xs:sequence>
<xs:element minOccurs="0" name="categoryId" type="xs:int"/>
<xs:element minOccurs="0" name="description" nillable="true" type="xs:string"/>
<xs:element minOccurs="0" name="name" nillable="true" type="xs:string"/>
</xs:sequence>
</xs:complexType>
</xs:schema>
<xs:schema xmlns:ax22="http://ws.chathura.com/xsd" attributeFormDefault="qualified" elementFormDefault="qualified" targetNamespace="http://ws.chathura.com">
<xs:import namespace="http://ws.chathura.com/xsd"/>
<xs:element name="getCategoryObject">
<xs:complexType>
<xs:sequence>
<xs:element minOccurs="0" name="obj" nillable="true" type="ax21:Category"/>
</xs:sequence>
</xs:complexType>
</xs:element>
<xs:element name="getCategoryObjectResponse">
<xs:complexType>
<xs:sequence>
<xs:element minOccurs="0" name="return" nillable="true" type="ax21:Category"/>
</xs:sequence>
</xs:complexType>
</xs:element>
</xs:schema>
</wsdl:types>
<wsdl:message name="getCategoryObjectRequest">
<wsdl:part name="parameters" element="ns:getCategoryObject"/>
</wsdl:message>
<wsdl:message name="getCategoryObjectResponse">
<wsdl:part name="parameters" element="ns:getCategoryObjectResponse"/>
</wsdl:message>
<wsdl:portType name="HelloWorldWSPortType">
<wsdl:operation name="getCategoryObject">
<wsdl:input message="ns:getCategoryObjectRequest" wsaw:Action="urn:getCategoryObject"/>
<wsdl:output message="ns:getCategoryObjectResponse" wsaw:Action="urn:getCategoryObjectResponse"/>
</wsdl:operation>
</wsdl:portType>
<wsdl:binding name="HelloWorldWSSoap11Binding" type="ns:HelloWorldWSPortType">
<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
<wsdl:operation name="getCategoryObject">
<soap:operation soapAction="urn:getCategoryObject" style="document"/>
<wsdl:input>
<soap:body use="literal"/>
</wsdl:input>
<wsdl:output>
<soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:binding name="HelloWorldWSSoap12Binding" type="ns:HelloWorldWSPortType">
<soap12:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
<wsdl:operation name="getCategoryObject">
<soap12:operation soapAction="urn:getCategoryObject" style="document"/>
<wsdl:input>
<soap12:body use="literal"/>
</wsdl:input>
<wsdl:output>
<soap12:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:binding name="HelloWorldWSHttpBinding" type="ns:HelloWorldWSPortType">
<http:binding verb="POST"/>
<wsdl:operation name="getCategoryObject">
<http:operation location="getCategoryObject"/>
<wsdl:input>
<mime:content type="text/xml" part="parameters"/>
</wsdl:input>
<wsdl:output>
<mime:content type="text/xml" part="parameters"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:service name="HelloWorldWS">
<wsdl:port name="HelloWorldWSHttpSoap11Endpoint" binding="ns:HelloWorldWSSoap11Binding">
<soap:address location="http://localhost:8080/WebProject_KomplexObjects/services/HelloWorldWS.HelloWorldWSHttpSoap11Endpoint/"/>
</wsdl:port>
<wsdl:port name="HelloWorldWSHttpSoap12Endpoint" binding="ns:HelloWorldWSSoap12Binding">
<soap12:address location="http://localhost:8080/WebProject_KomplexObjects/services/HelloWorldWS.HelloWorldWSHttpSoap12Endpoint/"/>
</wsdl:port>
<wsdl:port name="HelloWorldWSHttpEndpoint" binding="ns:HelloWorldWSHttpBinding">
<http:address location="http://localhost:8080/WebProject_KomplexObjects/services/HelloWorldWS.HelloWorldWSHttpEndpoint/"/>
</wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

这是我的 Android 测试应用程序：

```
 package de.bachelor.marcel;

    import java.util.Vector;

    import org.ksoap2.SoapEnvelope;
    import org.ksoap2.serialization.PropertyInfo;
    import org.ksoap2.serialization.SoapObject;
    import org.ksoap2.serialization.SoapSerializationEnvelope;
    import org.ksoap2.transport.AndroidHttpTransport;

    import android.app.Activity;
    import android.os.Bundle;
    import android.widget.TextView;

    public class WSClientKomplexeObjekteActivity extends Activity {

     private static final String SOAP_ACTION = "http://ws.chathura.com/getCategoryObject";
        private static final String METHOD_NAME = "getCategoryObject";
        private static final String NAMESPACE = "http://ws.chathura.com";
        private static final String URL = "http://192.168.2.102:8080/WebProject_KomplexObjects/services/HelloWorldWS?wsdl";

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
            /*
             * Create Category with Id to be passed as an argument
             * 
             * */
            Category C = new Category();
            C.CategoryId = 1;
            C.Description = "Das ist die Beschreibung";
            C.Name = "ObjektName"; 

            /*
             * Set the category to be the argument of the web service method
             * 
             * */

            PropertyInfo objekt = new PropertyInfo();
            objekt.setName("obj");
            objekt.setValue(C);
            objekt.setType(C.getClass());

            Request.addProperty(objekt);

            /*
             * Set the web service envelope
             * 
             * */
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

            envelope.setOutputSoapObject(Request);

            envelope.addMapping(NAMESPACE, "Category",new Category().getClass());
            AndroidHttpTransport androidHttpTransport = new AndroidHttpTransport(URL);
            /*
             * Call the web service and retrieve result ... how luvly <3
             * 
             * */
            try
            {
                androidHttpTransport.call(SOAP_ACTION, envelope);
                SoapObject response = (SoapObject)envelope.getResponse();
                C.CategoryId =  Integer.parseInt(response.getProperty(0).toString());
                C.Name =  response.getProperty(1).toString();
                C.Description = (String) response.getProperty(2).toString();
                TextView tv = (TextView)findViewById(R.id.textview1);
                tv.setText("CategoryId: " +C.CategoryId + " Name: " + C.Name + " Description " + C.Description);
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }
        }
    } 
```

这是来自 Android 客户端的类别类：

```
package de.bachelor.marcel;

import java.util.Hashtable;

import org.ksoap2.serialization.KvmSerializable;
import org.ksoap2.serialization.PropertyInfo;

public class Category implements KvmSerializable 
{

 public int CategoryId;
 public String Description;
    public String Name;

    public Category(){}

    public Category(int categoryId, String description, String name) 
    {

        CategoryId = categoryId;
        Name = name;
        Description = description;
    }

 @Override
 public Object getProperty(int arg0) 
 {
  switch(arg0)
        {
        case 0:
            return CategoryId;
        case 1:
            return Description;
        case 2:
         return Name;
        }
  return null;
 }

 @Override
 public int getPropertyCount() 
 {
  return 3;
 }

 @Override
 public void getPropertyInfo(int arg0, Hashtable arg1, PropertyInfo arg2) 
 {
  switch(arg0)
        {
        case 0:
            arg2.type = PropertyInfo.INTEGER_CLASS;
            arg2.name = "CategoryId";
            break;
        case 1:
            arg2.type = PropertyInfo.STRING_CLASS;
            arg2.name = "Description";
            break;
        case 2:
            arg2.type = PropertyInfo.STRING_CLASS;
            arg2.name = "Name";
            break;
        default:break;
        }

 }

 @Override
 public void setProperty(int arg0, Object arg1) 
 {
  switch(arg0)
        {
        case 0:
            CategoryId = Integer.parseInt(arg1.toString());
            break;
        case 1:
         Description = arg1.toString();
            break;
        case 2:
            Name = arg1.toString();
            break;
        default:
            break;
        }

 }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:31:51.170

尝试使用

```
private static final String NAMESPACE = "http://ws.chathura.com/xsd"; 
```

在您的 android 活动中，并将 getter 和 setter 添加到`Category`客户端中的类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T10:11:16.373

好的，我已经尝试了您的提示，现在我非常接近解决方案：

我发现，我需要 2 个命名空间（一个接收一个发送）

所以我做了以下更改：

```
private static final String NAMESPACE = "http://ws.chathura.com";
private static final String NAMESPACE2 = "http://ws.chathura.com/xsd"; 
```

还有这个：

```
SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
...
...
envelope.addMapping(NAMESPACE2, "Category",new Category().getClass()); 
```

现在我的 Webservice 收到了我的 Object **Category**，但是 Category ( `CategoryID`) 中的第一个属性没有被传输，并且 LogCat 显示以下异常：

```
 06-13 09:59:17.459: W/System.err(647): java.lang.RuntimeException: Unknown Property: categoryId
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.readSerializable(SoapSerializationEnvelope.java:200)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.readInstance(SoapSerializationEnvelope.java:444)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:387)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:273)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:389)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:151)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:140)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.transport.Transport.parseResponse(Transport.java:100)
06-13 09:59:17.469: W/System.err(647):  at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:197)
06-13 09:59:17.479: W/System.err(647):  at com.androidclient.ws.WSClientActivity$1$1.run(WSClientActivity.java:91)
06-13 09:59:17.479: W/System.err(647):  at java.lang.Thread.run(Thread.java:1019) 
```

我在没有 的情况下第二次对其进行了测试`CategoryID`，但随后是`Description`未知属性:-(

怎么了？

> ***编辑：***

我认为例外是因为`envelope.addMapping`. 我能做什么，只使用一个命名空间？

# ios5 - 如何在iOS中实现指定小部件仅在拉起时出现的效果？

> ID：10999766
> 
> 赞同：0
> 
> 时间：2012-06-12T15:23:23.293
> 
> 标签：ios5

我注意到当打开内置的“消息”应用程序时，默认情况下您不会看到搜索框小部件。只有当您将视图拉起时，您才能看到它。这正是一个有趣的效果。好吧，我真的很想实现类似的效果，但我应该从什么开始呢？

有什么线索吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:58:13.280

啊哈！似乎找到了答案。我查看了这篇文章并尝试了一下，它确实有效。干杯!

[仅当用户拉下表格时才显示搜索栏](https://stackoverflow.com/questions/7615747/showing-the-searchbar-only-when-user-pull-down-the-table)

# sql - 在 Oracle 中使用 select 子句传递表参数

> ID：10999771
> 
> 赞同：1
> 
> 时间：2012-06-12T15:23:51.877
> 
> 标签：sql, oracle, plsql

我有两种类型：

```
 CREATE OR REPLACE TYPE id_type AS OBJECT
   (
     id NUMBER(19, 0)
   );

   CREATE OR REPLACE TYPE id_table AS TABLE OF id_type; 
```

我有一个函数 A(param IN id_table)。

现在，如果我有另一个函数使用第一个函数，我应该如何传递像 A(SELECT 1 FROM DUAL) 这样的参数？我只能手动创建一个 id_table var，填充它然后传递给 A() 函数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:28:07.443

你可以做类似的事情

```
DECLARE
  l_ids     id_table;
  l_return  <<data type>>;
BEGIN
  SELECT id_type( 1 )
    BULK COLLECT INTO l_ids
    FROM dual;
  l_return := a( l_ids );
END; 
```

但是，`id_type`在这种情况下为什么你有一个并不明显。简单地声明似乎更合乎逻辑`id_table`

```
CREATE OR REPLACE TYPE id_table
    AS TABLE OF NUMBER(19,0); 
```

您是否真的打算通过从对偶中选择来填充集合也不是很明显。如果你真的想要一个单元素集合，你可以简单地初始化它。但是，我猜您确实打算通过查询表来填充集合，而不是`DUAL`在这种情况下您更喜欢`BULK COLLECT`

```
DECLARE
  l_ids     id_table := new id_table( id_type( 1 ) );
  l_return  <<data type>>;
BEGIN
  l_return := a( l_ids );
END; 
```

# java - java关闭解决方法

> ID：10999777
> 
> 赞同：0
> 
> 时间：2012-06-12T15:24:05.153
> 
> 标签：java

我有 5 个按钮，我需要遍历它们以执行一些初始化操作，如下面的代码所示。但是，Java 阻止我将 i 传递给函数 ScreenFactory.produce() 因为它不是最终的，因为我读到了一些关闭问题。从那以后我不能让它成为最终的，它会阻止循环中的增量。解决办法是什么？

```
for(int i = 0; i < 5; ++i) {
            levelButtons[i].setAction(ActionType.GENERAL_ACTION, new GameAction() {

                @Override
                public void execute(int screenID) {
                    Game.instance.changeScreen( ScreenFactory.produce(ScreenFactory.GAME_SCREEN, i));
                }
            });

            TouchHandler.instance.register(levelButtons[i]);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:28:33.963

`tmp`您可以在您标记的循环内创建一个临时变量（例如） `final`，使用 的值对其进行初始化`i`并传递`tmp`给`produce()`调用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:30:16.493

一个简单的解决方法是在闭包内创建一个 final 变量并将其赋值为`i`：

```
for(int i = 0; i < 5; ++i) 
{
   final int finalI = i;
   levelButtons[i].setAction(ActionType.GENERAL_ACTION, new GameAction() 
   {
       @Override
       public void execute(int screenID) 
       {
         Game.instance.changeScreen( ScreenFactory.produce(ScreenFactory.GAME_SCREEN, finalI));
       }
    });
    TouchHandler.instance.register(levelButtons[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:28:20.160

在将 i 传递给 ScreenFactory 之前将其加载到另一个变量中。

# xcode4 - 在 Xcode 中，您可以在应用程序运行但在断点处暂停时重新编译应用程序的一部分吗？

> ID：10999780
> 
> 赞同：0
> 
> 时间：2012-06-12T15:24:17.133
> 
> 标签：xcode4, recompile

在 Xcode 中，您可以在应用程序运行但在断点处暂停时重新编译应用程序的一部分吗？

我认为有办法做到这一点。我想我记得听说 Xcode 4 会有这种能力，或者类似的东西。

如果我可以在应用程序暂停时更改变量的值，以缩小错误发生的范围，这也会很有用。

这似乎不太可能做到，但我想至少我会问，是否有任何其他原因，而不仅仅是为了让我每天吃一份不起眼的馅饼：D

（我正在为 iOS 编译我的应用程序。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:36:13.457

哇，那太好了！我现在正在上斯坦福的课程，老师特别说如果您更改代码或任何需要编译的工作，您必须重新编译整个项目。

因此，假设他是正确的，我怀疑这是 xCode 中的当前功能。希望他们会添加这样的东西！

# c# - 通过 C# 创建 VCS 文件，但 Outlook 或 C# 不喜欢我的日期

> ID：10999782
> 
> 赞同：4
> 
> 时间：2012-06-12T15:24:27.467
> 
> 标签：c#, vcalendar

我正在尝试在 C# 中创建一个 .vcs 文件。基本上在 Outlook 中，如果您添加日历约会，它会在 Outlook 中创建一个文件，如下所示：

![在此处输入图像描述](../Images/0823361221dfdf84837e0604850af9f9.png)

您实际上可以导出此文件，右键单击它并在您喜欢的文本编辑器中打开它。它看起来像这样：

```
BEGIN:VCALENDAR
PRODID:-//Flo Inc.//FloSoft//EN
BEGIN:VEVENT
DTSTART:6/12/2012 12:00:00 PM
DTEND:6/12/2012 1:00:00 PM
LOCATION:Meeting room 1
DESCRIPTION;ENCODING=QUOTED-PRINTABLE:Learn about assets.
SUMMARY:asset management training.
X-MICROSOFT-CDO-BUSYSTATUS:OOF
PRIORITY:5
END:VEVENT
END:VCALENDAR 
```

所以我遇到的问题是上面的 DTSTART 和 DTEND 的实际时间。您可以看到，当我打开 Outlook 文件时，它显示为上午 11:00（如屏幕截图所示），但在文本文件中我将其显示为下午 12:00。

所以我有一个应用程序（培训应用程序），我可以在其中动态创建这些 vcs 文件之一。使用 C# 我收集主题、位置、描述和日期（带时间），如下所示：

```
 protected void btnOutlook_Click(object sender, EventArgs e)
        {
            string location;
            string description;
            string subject;
            string fromTime;
            string toTime;

            location = txtLocation.Text;
            description = txtDescription.Text;
            subject = lblTitle.Text;
            fromTime = ddlFromTimeHH.SelectedItem.Text + ":" + ddlFromTimeMM.SelectedItem.Text + ddlFromTimeAMPM.SelectedItem.Text;
            toTime = ddlToTimeHH.SelectedItem.Text + ":" + ddlToTimeMM.SelectedItem.Text + ddlToTimeAMPM.SelectedItem.Text;

            string begin = lblDate.Text + " " + fromTime;
            string end = lblDate.Text + " " + toTime;
            string format = "dd/MM/yyyy h:mmtt";

            DateTime trainingDateBegin;
            DateTime trainingDateEnd;

            if (DateTime.TryParseExact(begin, format, CultureInfo.InvariantCulture, DateTimeStyles.None, out trainingDateBegin))
            {
                //good date
            }

            if (DateTime.TryParseExact(end, format, CultureInfo.InvariantCulture, DateTimeStyles.None, out trainingDateEnd))
            {
                //good date
            }

            OpenVCSFile("vcsFile.aspx?TrainingDateBegin=" + trainingDateBegin + "&TrainingDateEnd=" + trainingDateEnd + "&Location=" + location + "&Subject=" + subject + "&Description=" + description, "Utilities", "toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=0,width=800,height=500,left=10,top=20");
        } 
```

因此，在上面的代码中，fromTime 变成了例如上午 7:00，而 toTime 变成了上午 8:00。然后我使用 DateTime.TryParseExact 将日期与时间合并，这样它就变成了`06/01/2012 7:00 am`for`beginDate`和 for`endDate`它变成了 for `06/01/2012 8:00 am`。

到目前为止一切顺利......然后我只是调用一个函数 OpenVCSFile ，它只是一些 javascript 来打开传入的 url，如下所示：

```
protected void OpenVCSFile(string url, string name, string att)
        {
            Response.Write("<script language='JavaScript'>");
            Response.Write("x=window.open('" + url + "', '" + name + "','" + att + "');");
            Response.Write("x.focus();");
            Response.Write("</script>");
        } 
```

然后这会调用`vcsFile.aspx`我可以填写 Outlook 值的页面...

```
protected void Page_Load(object sender, EventArgs e)
        {
            DateTime beginDate;
            DateTime endDate;
            string location;
            string description;
            string subject;

            beginDate = Convert.ToDateTime(Request.QueryString["TrainingDateBegin"]);
            endDate = Convert.ToDateTime(Request.QueryString["TrainingDateEnd"]);

            location = Request.QueryString["Location"];
            description = Request.QueryString["Description"];
            subject = Request.QueryString["Subject"];

            MemoryStream mStream = new MemoryStream();
            StreamWriter writer = new StreamWriter(mStream);

            writer.AutoFlush = true;

            //header
            writer.WriteLine("BEGIN:VCALENDAR");
            writer.WriteLine("PRODID:-//Flo Inc.//FloSoft//EN");
            writer.WriteLine("BEGIN:VEVENT");

            //BODY
            writer.WriteLine("DTSTART:" + beginDate);   //why dont the times come out right...
            writer.WriteLine("DTEND:" + endDate);       //same here
            writer.WriteLine("LOCATION:" + location);
            writer.WriteLine("DESCRIPTION;ENCODING=QUOTED-PRINTABLE:" + description);
            writer.WriteLine("SUMMARY:" + subject);
            writer.WriteLine("X-MICROSOFT-CDO-BUSYSTATUS:OOF");

            //FOOTER
            writer.WriteLine("PRIORITY:5");
            writer.WriteLine("END:VEVENT");
            writer.WriteLine("END:VCALENDAR");

            //MAKE IT DOWNLOADABLE
            Response.Clear(); //clears the current output content from the buffer
            Response.AppendHeader("Content-Disposition", "attachment; filename=AddToOutlookCalendar.vcs");
            Response.AppendHeader("Content-Length", mStream.Length.ToString());
            Response.ContentType = "application/download";
            Response.BinaryWrite(mStream.ToArray());
            Response.End();
        } 
```

除了最重要的部分，我执行此操作的部分之外，一切似乎都有效：

```
writer.WriteLine("DTSTART:" + beginDate);   //why dont the times come out right...
 writer.WriteLine("DTEND:" + endDate);       //same here 
```

正如您在 Outlook 屏幕截图中看到的那样，日期是正确的，但时间总是错误的......通常 Outlook 会在上午 10:00 到上午 11:00 之间打开它。但它从来不需要我给它的时间。例如，在我的 c# 代码中，这里是监视屏幕：

```
trainingDateBegin {12/6/2012 12:00:00 PM}
trainingDateEnd {12/6/2012 1:00:00 PM} 
```

所以我的应用程序在 2012 年 12 月 6 日的日期通过，时间为 12:00:00 pm 到 12/6/2012 1:00:00 pm。但是当这里生成 vcs 文件时，结果是：

![在此处输入图像描述](../Images/a96e9d56493fcf55945650b1aed71333.png)

（如果图像没有显示基本上 Outlook 有所有正确的信息：主题，位置，开始日期结束日期但时间错误。它说上午 11 点到下午 12 点。它几乎就像它使用我的系统时钟 EST）...

有谁知道我可能做错了什么。对不起，很长的帖子：（。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T15:38:00.730

我认为这与时区有关；您可以添加时区或（更简单）在文件中使用 UTC 时间。

如果确实添加了时区，则需要使用 vCal 版本 2，因为 Outlook 不支持版本 1 中的时区。

* * *

编辑：这是取自[维基百科文章 VCalendar](http://en.wikipedia.org/wiki/VCalendar)的语法示例。此事件发生在 1997 年 7 月 14 日 17:00 (UTC) 到 1997 年 7 月 15 日 03:59:59 (UTC)：

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//hacksw/handcal//NONSGML v1.0//EN
BEGIN:VEVENT
UID:uid1@example.com
DTSTAMP:19970714T170000Z
ORGANIZER;CN=John Doe:MAILTO:john.doe@example.com
DTSTART:19970714T170000Z
DTEND:19970715T035959Z
SUMMARY:Bastille Day Party
END:VEVENT
END:VCALENDAR 
```

# nhibernate - 一个常见的业务场景，但在 NHibernate 中没有优雅的方式

> ID：10999784
> 
> 赞同：0
> 
> 时间：2012-06-12T15:24:34.903
> 
> 标签：nhibernate

这是我的简单情况：对于大多数企业来说很常见......

*   假设我们有由**Items组成的****Orders 。**[ 亲子]
***   系统中有 2 个用户：UserA 和 UserB*   UserA 创建一个包含 3 个项目的订单。并将其保存到数据库中。*   同时UserB打开UserA之前保存的Order来读取Items of Order。*   然后 UserA 从 Orders 中删除 Item 1 并保存。一切都好*   最后 UserB 删除第 3 项并尝试保存...**

 **NHibernate 给出“StaleObjectStateException”...

那么如何处理这种情况，以便删除 İtem1 和 Item3 并且我们没有“StaleObjectStateException”......使用 NHibernate？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:32:21.983

我认为您应该捕获异常并让用户知道该项目已被其他人更新，从数据库重新加载实体并让用户在检查新数据后决定要做什么。

如果您不想让用户同时编辑同一个实体，您也可以使用悲观锁定。

查看[NHibernate 文档](http://nhforge.org/doc/nh/en/index.html#transactions)以获取有关并发控制策略的更多信息。

[Ayende Rahien 的这篇](http://ayende.com/blog/3946/nhibernate-mapping-concurrency)文章也是一个很好的参考。**

# bittorrent - PEX 协议（磁力链接）如何找到它的第一个 IP？

> ID：10999786
> 
> 赞同：21
> 
> 时间：2012-06-12T15:24:38.677
> 
> 标签：bittorrent, dht, magnet-uri

我试图了解磁链接如何工作，因为我已经读过他们使用 DHT 和 PEX 来获取对等点，但是如果我是网络中的一个新节点，我如何才能找到只有散列的对等点文件？！它不是总是需要到已知主机的链接吗？

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-18T19:29:34.363

bittorrent DHT 可以通过多种方式进行引导。它只需要任何其他可访问的 DHT 节点的 IP 和端口。

当前客户通常使用以下几种策略：

*   从前一个会话的长寿命节点缓存中引导
*   使用 DNS A/AAAA 记录映射到具有已知端口的已知节点（例如 router.bittorrent.com 或 dht.transmissionbt.com）
*   使用[嵌入在 .torrent 文件中的节点](http://bittorrent.org/beps/bep_0005.html#torrent-file-extensions)
*   通过通过其他方式（例如传统跟踪器）建立的 bittorrent 连接 从 bittorrent 客户端检索[DHT 端口。](http://bittorrent.org/beps/bep_0005.html#bittorrent-protocol-extension)
    *   如果对等点[嵌入在磁力链接](http://bittorrent.org/beps/bep_0009.html#magnet-uri-format)中，则还可以通过端口消息在其上搭载 DHT 引导程序
*   [通过LSD](http://bittorrent.org/beps/bep_0014.html)发现多播邻居
*   从 IPv4 到 IPv6 DHT 的交叉对话，反之亦然（如果需要）

其他方式，例如用户可配置的引导列表、DNS SRV 记录到活动节点的循环映射，或者 - 如果其他一切都失败 - 手动添加您朋友的 IP。

一旦一个节点加入网络，上面提到的第一个策略就会启动，它不太可能需要再次引导。

因此，尽管为了方便起见，大多数实现依赖于单个/几个网络入口点，但协议本身也足够灵活，可以分散入口点。

只是为了强调： DHT 中的*任何*节点都可以用来加入网络。专用引导节点是一个实现细节，不是协议的一部分，如有必要，可以用其他发现机制代替。

# java - weka 培训和 java 培训的不同结果

> ID：10999792
> 
> 赞同：1
> 
> 时间：2012-06-12T15:25:09.987
> 
> 标签：java, artificial-intelligence, weka, ikvm, neural-network

我正在尝试使用 weka 的 java api 创建一个“自动训练”，但我想我做错了什么，每当我使用 MultiLayerPerceptron 和 10 交叉验证或 66% 百分比拆分通过 weka 的界面测试我的 ARFF 文件时，我都会得到一些令人满意的结果（大约 90%），但是当我尝试通过 weka 的 API 测试同一个文件时，每个测试基本上都返回 0% 匹配（每一行都返回 false）

这是 weka 的 gui 的输出：

=== 测试拆分评估 === === 总结 ===

```
Correctly Classified Instances          78               91.7647 %
Incorrectly Classified Instances         7                8.2353 %
Kappa statistic                          0.8081
Mean absolute error                      0.0817
Root mean squared error                  0.24  
Relative absolute error                 17.742  %
Root relative squared error             51.0603 %
Total Number of Instances               85 
```

=== 按等级划分的详细准确度 ===

```
 TP Rate   FP Rate   Precision   Recall  F-Measure   ROC Area  Class
                 0.885     0.068      0.852     0.885     0.868      0.958    1
                 0.932     0.115      0.948     0.932     0.94       0.958    0
Weighted Avg.    0.918     0.101      0.919     0.918     0.918      0.958 
```

=== 混淆矩阵 ===

```
 a  b   <-- classified as
 23  3 |  a = 1
  4 55 |  b = 0 
```

这是我在java上使用的代码（实际上是在.NET上使用IKVM）：

```
var classifier = new weka.classifiers.functions.MultilayerPerceptron();
classifier.setOptions(weka.core.Utils.splitOptions("-L 0.7 -M 0.3 -N 75 -V 0 -S 0 -E 20 -H a")); //these are the same options (the default options) when the test is run under weka gui

string trainingFile = Properties.Settings.Default.WekaTrainingFile; //the path to the same file I use to test on weka explorer
weka.core.Instances data = null;
data = new weka.core.Instances(new java.io.BufferedReader(new java.io.FileReader(trainingFile))); //loads the file
data.setClassIndex(data.numAttributes() - 1); //set the last column as the class attribute

cl.buildClassifier(data);

var tmp = System.IO.Path.GetTempFileName(); //creates a temp file to create an arff file with a single row with the instance I want to test taken from the arff file loaded previously
using (var f = System.IO.File.CreateText(tmp))
{
    //long code to read data from db and regenerate the line, simulating data coming from the source I really want to test
}

var dataToTest = new weka.core.Instances(new java.io.BufferedReader(new java.io.FileReader(tmp)));
dataToTest.setClassIndex(dataToTest.numAttributes() - 1);

double prediction = 0;

for (int i = 0; i < dataToTest.numInstances(); i++)
{
    weka.core.Instance curr = dataToTest.instance(i);
    weka.core.Instance inst = new weka.core.Instance(data.numAttributes());
    inst.setDataset(data);
    for (int n = 0; n < data.numAttributes(); n++)
    {
        weka.core.Attribute att = dataToTest.attribute(data.attribute(n).name());
        if (att != null)
        {
            if (att.isNominal())
            {
                if ((data.attribute(n).numValues() > 0) && (att.numValues() > 0))
                {
                    String label = curr.stringValue(att);
                    int index = data.attribute(n).indexOfValue(label);
                    if (index != -1)
                        inst.setValue(n, index);
                }
            }
            else if (att.isNumeric())
            {
                inst.setValue(n, curr.value(att));
            }
            else
            {
                throw new InvalidOperationException("Unhandled attribute type!");
            }
        }
    }
    prediction += cl.classifyInstance(inst);
}

//prediction is always 0 here, my ARFF file has two classes: 0 and 1, 92 zeroes and 159 ones 
```

这很有趣，因为如果我将分类器更改为让我们说 NaiveBayes，结果与通过 weka 的 gui 进行的测试相匹配

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:53:30.697

您正在使用一种已弃用的方式来读取 ARFF 文件。请参阅本[文档](http://weka.wikispaces.com/Use+WEKA+in+your+Java+code)。试试这个：

```
 import weka.core.converters.ConverterUtils.DataSource;
 ...
 DataSource source = new DataSource("/some/where/data.arff");
 Instances data = source.getDataSet(); 
```

请注意，该文档还显示了如何直接连接到数据库，并绕过临时 ARFF 文件的创建。此外，您可以从数据库中读取并手动创建实例来填充 Instances 对象。

最后，如果简单地将代码顶部的分类器类型更改为 NaiveBayes 解决了问题，那么检查你的 weka gui 中的 MultilayerPerceptron 选项，看看它们是否与默认值不同（不同的设置可能导致相同的分类器类型产生不同的结果）。

**更新：**看起来您在代码中使用的测试数据与在 weka GUI 中使用的测试数据不同（来自数据库与原始训练文件的折叠）；也可能是您的数据库中的特定数据实际上看起来像`class 0`MLP 分类器。要验证是否是这种情况，您可以使用 weka 接口将您的训练 arff 拆分为训练/测试集，然后在您的代码中重复原始实验。如果结果与 gui 相同，则您的数据有问题。如果结果不同，那么我们需要更仔细地查看代码。您将调用的函数是这个[（来自文档）](http://weka.sourceforge.net/doc.dev/weka/core/Instances.html#trainCV%28int,%20int%29)：

```
public Instances trainCV(int numFolds, int numFold) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-29T18:02:09.327

我有同样的问题。

与 Java 中的交叉验证相比，Weka 在 Explorer 中给了我不同的结果。

有帮助的东西：

```
Instances dataSet = ...;
dataSet.stratify(numOfFolds); // use this
         //before splitting the dataset into train and test set! 
```

# linux - 用另一个 makefile 包装 GNU makefile

> ID：10999800
> 
> 赞同：1
> 
> 时间：2012-06-12T15:25:35.853
> 
> 标签：linux, compilation, makefile, gnu-make

这是以下[问题](https://stackoverflow.com/questions/10971615/error-while-runing-parallel-make)。

我有`Makefile.real`（`Makefile`来自上[一个问题](https://stackoverflow.com/questions/10971615/error-while-runing-parallel-make)）：

```
all: a b

a:
        echo a
        exit 1

b:
        echo b start
        sleep 1
        echo b end 
```

现在我想创建`Makefile`一个简单的包装`Makefile.real`：

*   它`make`使用`Makefile.real`与调用相同的 args 调用
*   它应该打印错误消息 id `Makefile.real`failed **这是我的目标**- 在并行制作结束时打印错误消息（请参阅[问题](https://stackoverflow.com/questions/10971615/error-while-runing-parallel-make)）

因此，以下命令应以错误消息终止：

```
make -j1 a b (1)
make -j2 a b (2) 
```

我怀疑`Makefile`应该接近：

```
%:
      $(MAKE) -f Makefile.real $(MAKECMDGOALS); \
      res=$$?; if [ $$res != 0 ]; then echo "Failed!!!"; fi; exit $$res 
```

问题是目标 '%' 将被调用两次 for`a`和`b`for (2)。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T07:44:16.627

这是我结束的解决方案

```
ifneq ($(REAL_MAKE),1)
# run_make will be called once (it's .PHONY target), 
# even if make is called with several targets
%: run_make
        @:

.PHONY: run_make
run_make:
        $(MAKE) $(MAKECMDGOALS) REAL_MAKE=1; \
        if [ $$? -ne 0 ]; then               \
            echo "*** Error ***" >&2;        \
            exit 1;                          \
        fi

else  # REAL_MAKE defined (actual makefile)

### HERE comes original make we want to wrap ###

endif  # # REAL_MAKE defined (actual makefile) 
```

# drupal - 在 Drupal 7 的首页上不呈现寻呼机

> ID：10999801
> 
> 赞同：0
> 
> 时间：2012-06-12T15:25:45.883
> 
> 标签：drupal, drupal-7, drupal-theming

我看到里面有一个寻呼机数组`$page`。但它不打印寻呼机。

```
content (Array, 4 elements)
    system_main (Array, 5 elements)
        nodes (Array, 6 elements)
        pager (Array, 2 elements)
            #theme (String, 5 characters ) pager
            #weight (Integer) 5 
```

我尝试使用 theme('pager') 在页面上打印它，但它不起作用。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T05:01:27.483

我遇到了类似的问题。虽然，我无法解决问题。但是我修改了流程并通过执行以下步骤获得了类似的结果。

*   我创建了一个带有完整寻呼机的视图，我在其中根据需要配置了寻呼机。（另外，在首页检查分页是否正常工作。）
*   转到管理>>配置>>站点信息>>前面给出视图名称。（代替节点名称）

您会发现您的分页将正常工作。

# shared-libraries - 使用共享库时未定义的引用

> ID：10999805
> 
> 赞同：0
> 
> 时间：2012-06-12T15:26:18.457
> 
> 标签：shared-libraries, undefined-reference

**我想将一个程序用作另一个程序的共享库。**

我开始如下：我有一个我使用编译的应用程序：

```
/usr/bin/g++ -I/usr/include/libxml2  -Xlinker -zmuldefs -fPIC -c a.cpp
/usr/bin/g++ -I/usr/include/libxml2  -Xlinker -zmuldefs -fPIC -c b.cpp
/usr/bin/g++ -I/usr/include/libxml2  -Xlinker -zmuldefs -fPIC -c c.cpp 
```

然后，我使用以下命令从该文件中获取的对象创建了一个共享对象库：

```
g++ -fPIC -Xlinker -zmuldefs -shared -o libabc.so a.o b.o c.o 
```

在此之后，我得到了我复制到的 libabc.so 文件

```
sudo cp libabc.so /usr/local/lib/libabc.so 
```

现在，当我使用以下命令编译将使用这个新创建的库**libabc.so**的原始应用程序时：

```
/usr/local/lib/libabd.so: undefined reference to `xmlXPathNewContext' 
```

我从第一个应用程序中包含的库 libxml2 中使用的所有函数都出现错误，并且具有此未定义引用的函数实际上是我包含在第一个程序中的库，我的意思是我已经测试过它。所以请任何人在我需要更正的地方指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:11:37.910

我没有看到用于将应用程序链接到库的命令行，但我认为添加`-lxml2`到传递给链接器的标志应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T18:22:24.590

您可能还必须使用 传递路径`-I/path/to/library`，或者将其导出到`LD_LIBRARY_PATH`.

# c# - BCP 导出自动将空字符串转换为 NUL

> ID：10999808
> 
> 赞同：2
> 
> 时间：2012-06-12T15:26:30.207
> 
> 标签：c#, encoding, bcp, xp-cmdshell

总之，在这篇文章中，[xp_cmdshell 查询长度太大](https://stackoverflow.com/q/10995117/626442)，我设法解决了我在使用 xp_cmdshell 时遇到的查询大小限制问题。我写这么长的查询的原因是为了试图解决另一个问题，即 bcp 似乎将空字符串（来自包含空字符串字段的表）转换为一些编码字符（'NUL' 或 'r'，或者其他的东西）。这影响了我可以使用导出的数据的用途。我的出口查询是

```
string strBcp = String.Format(
    "declare @sql varchar(8000) " +
    "select @sql = 'bcp \"SELECT * FROM [{0}]..[ivwTmpDrgDataView];\" ' +" +
    "'queryout \"{1}\\DRGData.txt\" -c -t -T -S ' + @@servername " +
    "exec master..xp_cmdshell @sql;",
    strDatabase,
    strDataDir); 
```

这工作正常，但在导出的文件数据库值被转换

```
NULL -> Empty String (Which is fine!)
Empty String -> Some strange character 
```

我可以用 C# 读取 .txt 文件，然后重新编码 -**将我的“奇怪字符”转换回它应该是什么，一个空字符串的最佳方法是什么？**

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:34:18.617

这是设计使然，如果`bcp`将空字符串和空字符串都转换为相同的输出（假设是空字符串），那么以后将无法消除它们的歧义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-29T03:44:45.550

BCP 将 NULL 转换为空字符串，因此请使用 NULL 而不是空字符串。

[更多说明](http://aartemiou.blogspot.com.au/2015/03/handling-null-character-x00-when.html)

[bcp 实用程序](https://msdn.microsoft.com/en-us/library/ms162802.aspx?f=255&MSPPError=-2147217396)

# javascript - 如何使 twitter bootstrap .popover 在 .submit 事件中工作

> ID：10999814
> 
> 赞同：1
> 
> 时间：2012-06-12T15:26:46.293
> 
> 标签：javascript, jquery, html, twitter-bootstrap

我试图让 twitter bootstrap 的 .popover 在 .submit jquery 事件中工作，但是在我单击表单上的提交按钮后没有任何反应。我正在更改输入字段的“rel”属性，以便当用户单击提交按钮时，会在该字段中添加一个弹出框。如果我在加载页面之前以常规方式设置 rel 属性，则会显示弹出窗口。

这是输入字段：

```
<label class="control-label" for="input-name" id="input_name_label">Name *</label>
        <div class="controls">
            <input rel="" data-original-title="Title" data-content="Random Text" type="text" class="span3" name="name" id="input-name">
        </div> 
```

这是jquery函数：

```
<script>
    $("#project_form").submit(function(e) {
            for(i=0;i< $("label").length;i++){
                    var str=$("label").eq(i).text();
                    if(str.charAt(str.length-1)=="*"){
                            $("label").eq(i).attr('rel','popover');
                            console.log($("label").get(i));
                            e.preventDefault();
                            $('input[rel="popover"]').popover('show');
                    }
                    console.log(str.charAt(str.length-1));
            }
            $("#preferences").val($("#sortable").sortable('toArray'));
    });
    </script> 
```

该函数查找带有 * 作为最后一个字符的标签，并应该为它们分配一个弹出事件。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:45:45.330

问题是我将 rel 属性分配给标签字段而不是输入字段。是的，基本的编程错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:29:18.397

完成后`rel="popover"`，您需要通过激活将处理程序附加到它：

```
$('[rel="popover"]').tooltip(); 
```

希望这可以帮助！:)

# encryption - 虚拟机远程解密

> ID：10999818
> 
> 赞同：0
> 
> 时间：2012-06-12T15:26:48.443
> 
> 标签：encryption, virtual-machine

我希望通过提供可供下载的 VM 来为潜在客户提供产品的免费试用。

但是，我们可以通过远程磁盘加密/解密来控制许可/试用。

基本上，我正在寻找一种方法来获取全盘加密的虚拟机来调用远程主机并检查许可证是否仍然有效，然后将解密密钥传递给它。

所以问题是，有没有人听说过/见过/做过这个？可能吗？

提前感谢您的任何回复。

红砖

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:35:58.973

考虑相关风险：

1.  用户下载试用 VM。
2.  您在试用期内解密。
3.  **一些**用户会复制文件而不会购买产品。

# javascript - 这两种创建元素的方式有什么区别？

> ID：10999820
> 
> 赞同：3
> 
> 时间：2012-06-12T15:27:08.443
> 
> 标签：javascript

```
var a = document.createElement('div');

a.id = "myDiv"; 
```

和

```
var a = document.createElement('div').id = "myDiv"; 
```

它们之间有什么区别，第一个有效而第二个无效？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T15:29:50.063

设置`id`元素的 不会*返回*元素。它`"myDiv"`实际上返回，因此 var`a`被设置为`"myDiv"`而不是 div 本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:30:42.590

第二个不起作用，因为 createElement 的“返回”值用于设置 id。由于这是一个赋值而不是链接，它不会将新元素的引用返回给“a”，因此会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:30:14.400

第二个不起作用，因为您正在创建一个元素，但会立即对其执行操作。该`a`变量被设置为字符串“myDiv”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:30:25.027

`foo = 'bar'`as 语句实际上返回一个值，即`'bar'`.

```
a = document.createElement('div'); //this sets `a` to DOM Node

a = document.createElement('div').id = 'myDiv'; //this sets `a` to 'myDiv'
//it's the same as
document.createElement('div').id = 'myDiv';
a = 'myDiv'; 
```

* * *

# 永远不要这样做

如果您想`a`在一行中同时设置 ID 和变量，可以使用括号：

```
(a = document.createElement('div')).id = 'myDiv'; 
```

那是因为`a = document.createElement('div')`重新调整了新创建的 DOM 节点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:34:03.117

如果你真的想要一条捷径，你可以写：

```
(window.a=document.createElement('div')).id="myDiv"; 
```

小提琴：http: [//jsfiddle.net/F23cD/](http://jsfiddle.net/F23cD/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T15:46:00.233

在第一条语句中，您将创建的“div”类型元素放入变量“a”，然后将“a”的元素属性“id”设置为“myDiv”。然后“a”现在是元素。

在第二个声明中，您：

1.  创建“div”类型的元素：document.createElement('div')
2.  将元素属性“id”设置为“myDiv”和
3.  也将“a”设置为“myDiv”

然后，“a”现在是“myDiv”而不是元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-18T18:04:55.990

// 用这个

a.setAttribute("id","myDiv");

# python - 找不到我博客的确切源代码

> ID：10999822
> 
> 赞同：1
> 
> 时间：2012-06-12T15:27:32.170
> 
> 标签：python, html, html-parsing, screen-scraping, web-scraping

我进入了一个处理网页 HTML 解析的项目。所以，我拿起我的[博客](http://withmycam.blogspot.com)（Bloggers Blog - Dynamic Template）并尝试阅读它的内容。不幸的是，我没有查看博客网页的“实际”来源。

这是我观察到的：

1.  我点击`view source`了我博客的一篇随机文章，并试图找到其中的内容。我找不到任何东西。都是 JavaScript。

2.  所以，我把网页保存到我的笔记本电脑上并再次检查了来源，这次我找到了内容。

3.  我还检查了`developers tools`在浏览器中使用的源代码，并再次找到了其中的内容。

4.  现在，我尝试了python方式

    ```
    import urllib
    from bs4 import BeautifulSoup

    soup = BeautifulSoup( urllib.urlopen("my-webpage-address") )
    print soup.prettify() 
    ```

    我什至没有在其中找到 HTML 代码中的内容。

最后，为什么我在case1、4中找不到源代码中的内容。

我应该如何获得实际的 HTML 代码？我希望听到任何可以完成这项工作的 python 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:31:25.987

内容通过 JavaScript (AJAX) 加载。它不在“源”中。

在第 2 步中，您将保存*结果*页面，而不是原始源。在第 3 步中，您将看到浏览器正在呈现的内容。

第 1 步和第 4 步“不起作用”，因为您正在获取页面的源（不包含内容）。您需要实际运行 JavaScript，这对于屏幕抓取工具来说并不容易。

# jquery - 无法弄清楚如何使用 jquery 清除选择框的文本

> ID：10999823
> 
> 赞同：1
> 
> 时间：2012-06-12T15:27:34.307
> 
> 标签：jquery, jquery-ui, select, combobox

因此，如果它有所作为，我正在使用 JQuery UI。我有一个变成自动完成的选择框，但我认为我**应该**能够像任何旧的选择框一样清除它......

我已经尝试了我在网上阅读的所有内容：

```
$("#edit_ts_form_projects").val("0");
$("#edit_ts_form_projects").val(" ");
$("#edit_ts_form_projects nth-option(0).(selected, "selected");//or something like this, cant remember the synax 
```

所有选择中第一个项目为空白的人，只有一个空格：

```
<option value=" "> </option>
<option value=""> </option>
<option value="..">..</option> 
```

但无论如何，选择框仍然会有东西（我希望下拉部分保持完整，我只想清除文本框。

有任何想法吗？可能是因为我正在使用 JQuery UI 发生这种情况吗？

这是我正在使用的 jquery UI 控件的链接：

[jQuery UI 组合框](http://jqueryui.com/demos/autocomplete/#combobox)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:38:07.380

尝试如下，

```
$('#combobox').next().find('input').val(''); 
```

`#combobox`原始代码中下拉列表的 ID 在哪里。

**演示：http:** [//jsfiddle.net/skram/vakKq/1/](http://jsfiddle.net/skram/vakKq/1/)

# php - 删除多个括号的正则表达式

> ID：10999835
> 
> 赞同：0
> 
> 时间：2012-06-12T15:28:25.167
> 
> 标签：php, regex, parentheses

我需要一个正则表达式，如果找到它可以删除字符串中不必要的/额外的括号。

例子：

```
Bob Barker LIVE! (((Don't Miss out!))) 
```

想要的结果：

```
Bob Barker LIVE! (Don't Miss out!) 
```

我不在乎用户是否是他们，只要他们不过度使用它们，并确保关闭它们。

感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:32:20.173

您可以使用正则表达式 + 递归有效地做到这一点。这样做直到它停止做任何事情：

`s/\(\([^()]*)\)\)/\(\1\)/g`

现在发表一些评论：

1) 我将把 sed/perl 样式转换为 PHP 样式的正则表达式留给您。

2) 很难阅读，因为 ( ) 是特殊字符。基本上我是说“只要不包含任何or就`((...))`替换every 。老实说，我没有测试我写下的烂摊子，但有了这个想法，你应该能够修复。`(...)``...``(``)`

这总是成对地删除它们。

基本上这里的道德是：您问了一个简单的正则表达式无法解决的问题 - 成对删除需要比语言允许的更多状态。但是，如果您遍历简单的正则表达式并从内到外吃掉双打，那么这个是唾手可得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:31:00.793

这很容易。

```
preg_replace('~[\(\)]+~', '', $string); 
```

编辑：我没有阅读你的整个问题。你仍然需要括号，而不是重复。

```
preg_replace(array('~\(+~', '~\)+~'), array('(', ')'), $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:32:29.597

试试这个：

```
preg_replace( '/\(+(.*?)\)+/', '($1)', 'Bob Barker LIVE! (((Don\'t Miss out!)))'); 
```

[演示](http://codepad.viper-7.com/urC93o)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:32:46.190

这不适用于嵌套括号，但是使用正则表达式*很难*做到正确（并且取决于引擎甚至不可能）：

```
preg_replace(array('/\(+/', '/\)+/'), array('(', ')'), $text); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T16:05:17.660

你可以试试这个：

```
preg_replace("([\\(]{1,})", "(", preg_replace("([\\)]{1,})", ")", $your_string)); 
```

# svn - 企业架构师和颠覆

> ID：10999844
> 
> 赞同：2
> 
> 时间：2012-06-12T15:28:49.673
> 
> 标签：svn, enterprise-architect

我正在尝试允许在 Enterprise Architect 中使用 Subversion，但遇到了一些问题：

我创建了一个 eap 文件，将其导入，然后签出该文件并在 Enterprise Architect 中打开它。然后我配置了项目的版本控制设置，并将其定向到我的 SVN 客户端。我选择了一个包，使用“将分支添加到版本控制”，然后“签出”。我做了一些更改，然后“签入”。在我的 subversion 日志中，我看到确实签入了文件。然后，使用 Subversion，我签出了一个干净的副本，并打开了 eap 文件。令我惊讶的是，那里没有显示任何更改（或我的基线）。但是在我做了“获取最新”之后 - 变化就在那里（但不是基线）。

我究竟做错了什么？应该是这样吗？因为我希望当我签出一份干净的副本时，它将是最新的。Enterprise Architect 不就是这种情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T05:25:39.797

外部版本控制（CVS、Subversion、TFS 等）的预期用途是对单个包进行版本控制，而不是对 .EAP 文件进行版本控制。“获取最新”和其他版本控制命令仅适用于包，它们对 .EAP 文件没有影响。

这样，每个建模者都可以维护自己的 .EAP 文件，并选择要包含哪些版本的受控包以及它们应该放置在他们的 EA 项目中的哪个位置。当然，您也可以自己拥有几个不同的 .EAP 文件。

因此，将 .EAP 文件视为您通常检查 Subversion 树的目录。该目录本身不会签入存储库，如果您愿意，您可以将相同的内容签出到几个不同的目录中。

这种方法（这是使用 EA 实现团队建模的三种方法之一）确实意味着存储在 .EAP 文件中的某些内容根本不受版本控制，主要是各种项目设置。如果您有特定的存储需求，请首先查看它们是否可以从 EA 导出（查看帮助文件以获取“导出参考数据”）。

如果您最终仍需要存储项目本身，我会将其放置在不同的 Subversion 目录中，该目录不会被包标记和分支；这只会让人感到困惑。

最后，如果您只是为您的模型设置 Subversion 存储库，我建议您也看看 EA 的基线功能。这是一种不涉及 Subversion 的版本控制的不同方式，并且在我看来更易于管理 - 但您需要确保为您的 .EAP 文件制定了有效的备份策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-07T07:53:00.337

a/ 使用上下文菜单“包控制 > 文件属性”...获取锁定文件的名称

b/ 在本地 SVN 中找到这个文件

c/ 使用 SVN 上下文菜单，“SVN Get Lock”，选中“Steal the locks”选项

d/ 然后你可以通过“Release lock...”来释放SVN中的锁，或者直接使用Check in EA等。

注意：我使用的是 Tortoise SVN。

# java - 如何在 Java 中指定网络接口

> ID：10999846
> 
> 赞同：6
> 
> 时间：2012-06-12T15:28:52.780
> 
> 标签：java

我想在我的 Java 代码中使用 WiFi 连接。如何使用特定的 WiFi 网络接口从 Internet 下载文件？

换句话说，如何强制 java 通过特定的网络接口发送数据包？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T15:32:27.687

[`NetworkInterface`](http://docs.oracle.com/javase/6/docs/api/java/net/NetworkInterface.html)您可以使用该类查询可用的网络接口。然后使用该`bind()`方法将此接口绑定到 Socket。

```
NetworkInterface ni = NetworkInterface.getByName("eth0");
Socket socket = new Socket();
socket.bind(ni.getInetAddresses().nextElement()); 
```

这都是在 Java 教程中指定的：http: [//docs.oracle.com/javase/tutorial/networking/nifs/definition.html](http://docs.oracle.com/javase/tutorial/networking/nifs/definition.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:31:54.900

`NetworkInterface nif = NetworkInterface.getByName("bge0");`

看这里：

[http://docs.oracle.com/javase/tutorial/networking/nifs/definition.html](http://docs.oracle.com/javase/tutorial/networking/nifs/definition.html)

# css - CSS 特异性还是继承？

> ID：10999847
> 
> 赞同：4
> 
> 时间：2012-06-12T15:28:54.170
> 
> 标签：css, css-selectors, css-specificity

我在这里查看了类似的问题，但我没有找到一个特别针对我的案例的问题。

如果我正确阅读了这篇文章：http: [//css-tricks.com/specifics-on-css-specificity/](http://css-tricks.com/specifics-on-css-specificity/)

那么正在发生的事情对我来说没有意义。有人可以解释这是由于地方，继承还是特殊性吗？我已经删除了所有不相关的 CSS。

CSS

```
a:link {font-size:0.875em;color:#005984}
.button {color:#fff} 
```

HTML

```
<a class="button">Awesome call to action</a> 
```

我最终得到一个带有蓝色文本而不是白色的按钮。现在， a 是一个元素，所以它应该比 .button 类具有更低的特异性，不是吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T15:30:29.037

这是由于[特殊性](http://www.w3.org/TR/CSS21/cascade.html#specificity)：虽然`a`它是一个元素类型选择器，它没有类选择器那么具体，但它伴随着一个`:link`伪类，它同样特定于你的`.button`类。因此，类型 + 伪类将比类更具体。

这里没有继承，因为我可以看到没有应用于您的元素的父元素样式。[继承](http://www.w3.org/TR/CSS21/cascade.html#inheritance)是指采用父元素的样式。当您看到显示蓝色而不是白色的链接时，这就是[级联](http://www.w3.org/TR/CSS21/cascade.html#cascade)工作，而不是继承。

局部性不是 CSS 术语（至少不在其词汇表中），所以我不确定您的意思。

如果你需要你的号召性用语按钮是白色的，只需给它一个`a`选择器，这样你的选择器同样具体，最后的声明将优先：

```
a:link {font-size:0.875em;color:#005984}
a.button {color:#fff} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:32:42.607

> 选择器的特异性计算如下：
> - 统计选择器中 ID 选择器的数量（= a）
> - 统计选择器中的类选择器、属性选择器和伪类的数量（= b）
> - 统计类型的数量选择器中的选择器和伪元素 (= c)
> - 忽略通用选择器
> 
> 否定伪类中的选择器与其他选择器一样计算，但否定本身不计为伪类。
> 
> 连接三个数字 abc（在具有大基数的数字系统中）给出了特异性。

所以：

> `a:link`
> - a=0
> - b=1
> - c=1
> - 结果 = 011
> 
> `.button`
> - a=0
> - b=1
> - c=0
> - 结果 = 010
> 
> **结果**：`a:link`高于`.button`。

修复：无论如何，除了标签`:link`之外什么都不能工作，所以指定是多余的。改为使用，这将解决问题（提供*后*定义）`a``a:link``:link``.button` *`:link`*

# ruby-on-rails - rails、devise、heroku 和多个测功机

> ID：10999853
> 
> 赞同：1
> 
> 时间：2012-06-12T15:29:38.973
> 
> 标签：ruby-on-rails, login, heroku, devise

我们有一个在 Heroku 上运行的应用程序，它有多个测功机。假设应用程序有 2 个 dyno，当用户登录时，第一个 dyno 正在为他服务。如果由于某种原因，随后的请求由第二个测功机提供服务，他将显示为未登录。

解决这个问题的唯一方法（根据我们的测试）似乎是将会话存储设置为 cookie 存储。以前有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:22:26.070

我认为您可能没有正确配置其他会话存储。

你有没有像 memcached 或 redis 那样连接缓存服务，所以每个 dyno 都会寻找一个共享位置来查找会话信息？

[来自 Ruby 的 Heroku 内存缓存](https://devcenter.heroku.com/articles/memcache#using_memcache_from_ruby "来自 Ruby 的 Heroku 内存缓存")

# iphone - 未检测到旋转

> ID：10999855
> 
> 赞同：0
> 
> 时间：2012-06-12T15:29:41.127
> 
> 标签：iphone, xcode, resize, orientation

我在用：

```
 if (UIInterfaceOrientationLandscapeLeft | UIInterfaceOrientationLandscapeRight)
{
    viewofimage.frame = CGRectMake(130, 45, 220, 115);
    share.frame = CGRectMake(205, 161, 70, 70);
    invite.frame = CGRectMake(8, 161, 70, 70);
    contact.frame = CGRectMake(402, 161, 70, 70);
    invitation.frame = CGRectMake(3, 227, 81, 21);
    sharing.frame = CGRectMake(200, 227, 81, 21);
    contacting.frame = CGRectMake(397, 227, 81, 21);
}
else
{
    viewofimage.frame = CGRectMake(20, 64, 280, 206);
    invite.frame = CGRectMake(8, 285, 70, 70);
    share.frame = CGRectMake(125, 285, 70, 70);
    contact.frame = CGRectMake(242, 285, 70, 70);
    invitation.frame = CGRectMake(3, 358, 81, 21);
    sharing.frame = CGRectMake(120, 358, 81, 21);
    contacting.frame = CGRectMake(237, 358, 81, 21);
} 
```

旋转时在某些位置设置按钮和标签。唯一的问题是，当我离开该视图控制器并转到另一个控制器时，使用相同的代码，它不会将按钮和标签移动到定义的 CGRECTMAKE 值。它仅在选定的视图控制器旋转时移动它们。如何让其他视图控制器检测它的方向，并在到达它们时正确调整其大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:40:00.310

每次检测到旋转时，视图控制器都会调用此方法。我假设这就是您目前拥有此代码的地方

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft || toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
    {
        viewofimage.frame = CGRectMake(130, 45, 220, 115);
        share.frame = CGRectMake(205, 161, 70, 70);
        invite.frame = CGRectMake(8, 161, 70, 70);
        contact.frame = CGRectMake(402, 161, 70, 70);
        invitation.frame = CGRectMake(3, 227, 81, 21);
        sharing.frame = CGRectMake(200, 227, 81, 21);
        contacting.frame = CGRectMake(397, 227, 81, 21);
    }
    else
    {
        viewofimage.frame = CGRectMake(20, 64, 280, 206);
        invite.frame = CGRectMake(8, 285, 70, 70);
        share.frame = CGRectMake(125, 285, 70, 70);
        contact.frame = CGRectMake(242, 285, 70, 70);
        invitation.frame = CGRectMake(3, 358, 81, 21);
        sharing.frame = CGRectMake(120, 358, 81, 21);
        contacting.frame = CGRectMake(237, 358, 81, 21);
    }
} 
```

-=-=-=-=-=-=-=-=-

如果您想在移动到不同的 viewController 时检测方向并相应地放置对象……那么您可以像这样检测您所处的方向：

```
-(void)viewWillAppear:(BOOL)animated
{
    UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];
    if (orientation == UIInterfaceOrientationLandscapeLeft || orientation == UIInterfaceOrientationLandscapeRight)
    {
        viewofimage.frame = CGRectMake(130, 45, 220, 115);
        share.frame = CGRectMake(205, 161, 70, 70);
        invite.frame = CGRectMake(8, 161, 70, 70);
        contact.frame = CGRectMake(402, 161, 70, 70);
        invitation.frame = CGRectMake(3, 227, 81, 21);
        sharing.frame = CGRectMake(200, 227, 81, 21);
        contacting.frame = CGRectMake(397, 227, 81, 21);
    }
    else
    {
        viewofimage.frame = CGRectMake(20, 64, 280, 206);
        invite.frame = CGRectMake(8, 285, 70, 70);
        share.frame = CGRectMake(125, 285, 70, 70);
        contact.frame = CGRectMake(242, 285, 70, 70);
        invitation.frame = CGRectMake(3, 358, 81, 21);
        sharing.frame = CGRectMake(120, 358, 81, 21);
        contacting.frame = CGRectMake(237, 358, 81, 21);
    }
} 
```

-=-=-=-=-=-=-=-=-

供进一步参考：

[如何以编程方式确定 iPhone 界面方向？](https://stackoverflow.com/questions/634745/iphone-orientation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:42:48.420

将 UIView 的 autoMaskSubView 设置为 false 使用此方法：

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{

if (interfaceOrientation = UIInterfaceOrientationLandscapeLeft || interfaceOrientation = UIInterfaceOrientationLandscapeRight)
{
viewofimage.frame = CGRectMake(130, 45, 220, 115);
share.frame = CGRectMake(205, 161, 70, 70);
invite.frame = CGRectMake(8, 161, 70, 70);
contact.frame = CGRectMake(402, 161, 70, 70);
invitation.frame = CGRectMake(3, 227, 81, 21);
sharing.frame = CGRectMake(200, 227, 81, 21);
contacting.frame = CGRectMake(397, 227, 81, 21);
}
else
{
viewofimage.frame = CGRectMake(20, 64, 280, 206);
invite.frame = CGRectMake(8, 285, 70, 70);
share.frame = CGRectMake(125, 285, 70, 70);
contact.frame = CGRectMake(242, 285, 70, 70);
invitation.frame = CGRectMake(3, 358, 81, 21);
sharing.frame = CGRectMake(120, 358, 81, 21);
contacting.frame = CGRectMake(237, 358, 81, 21);
}

return YES; 
} 
```

# javascript - Google Map API V3 - 单击标记将更多信息内容显示为覆盖（如在 Google 地图中）

> ID：10999858
> 
> 赞同：10
> 
> 时间：2012-06-12T15:29:45.977
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我们使用 Google Map Api V3 在 HTML 容器中加载谷歌地图。我们有一个位置搜索表。提交时，我们将获取可用位置并在地图中设置标记。加载标记后，单击每个标记，我们需要显示标题、地址详细信息和设计，就像我们在谷歌地图中所拥有的一样。（在谷歌地图中 - 当点击红色标记时，我们可以看到更多信息覆盖框，其中包含其他详细信息，如星星、方向、附近搜索、保存到地图等。）

我们是否已经内置了 api 函数来加载上面的覆盖框。或者我们没有像我们目前在谷歌地图中那样加载细节的功能。

当我在谷歌和地图文档中搜索时，我可以看到显示覆盖窗口和在框中写入内容的选项。但我没有看到根据需要加载内容的选项。

我已经粘贴了下面的代码以供参考。

```
 var map = null;
       gmap_ready = function (){
    var myLatlng = new google.maps.LatLng(43.834527,-103.564457);
    var myOptions = {
      zoom: 3,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions); 
```

}

```
 function fnLoadMarkers(){
var locations  = [
    ['S Dakota', 43.834527,-103.564457, 1],
    ['Texas', 31.428663,-99.418947, 2],
    ['California', 36.668419,-120.249025, 3],
    ['Newyork', 43.197167,-76.743166, 4],
    ['Missouri', 38.410558,-92.73926, 5]
];
setMarkers(map,locations);
   }
 function setMarkers(map, locations) {
var image = 'images/marker.gif';

for (var i = 0; i < locations.length; i++) {
    var currLocation = locations[i];
    var latLng = new google.maps.LatLng(currLocation[1], currLocation[2]);
    var marker = new google.maps.Marker({
        position: latLng,
        map: map,
        icon: image,
        title: currLocation[0],
        zIndex: currLocation[3]
    });
    google.maps.event.addListener(marker, 'click', function() {
        var latitude = this.position.lat();
        var longitude = this.position.lng();
        window.open("http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q="+latitude+","+longitude+"&sll="+latitude+","+longitude+"&sspn=0.172749,0.4422&ie=UTF8&ll="+latitude+","+longitude+"&spn=0.162818,0.4422&z=11&iwloc=A");
    });
  } 
```

}

如果有任何关于如何实现这些结果的提示，那将会很有帮助。另外，请指导，是否可以通过Google API V3。

提前致谢，

问候

斯里尼瓦桑

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-13T18:37:27.353

我不明白您为什么要从 Google Maps API 标记打开一个新的 Google Maps 窗口？您不能通过 URL 在 Google 地图上添加信息窗口。

我就是这样做的。

```
<!DOCTYPE html>  
<html>  
<head>  
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>  
<link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />  
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>  
<script type="text/javascript"> 
// Initiate map 
function initialize(data) { 
  // Make position for center map 
  var myLatLng = new google.maps.LatLng(data.lng, data.lat); 

  // Map options  
  var myOptions = { 
    zoom: 10, 
    center: myLatLng, 
    mapTypeId: google.maps.MapTypeId.HYBRID 
  }; 

  // Initiate map 
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions); 

  // Info window element 
  infowindow = new google.maps.InfoWindow(); 

  // Set pin 
  setPin(data); 
} 
// Show position 
function setPin(data) { 
  var pinLatLng = new google.maps.LatLng(data.lng, data.lat); 
  var pinMarker = new google.maps.Marker({ 
    position: pinLatLng, 
    map: map, 
    data: data 
  }); 

  // Listen for click event  
  google.maps.event.addListener(pinMarker, 'click', function() { 
    map.setCenter(new google.maps.LatLng(pinMarker.position.lat(), pinMarker.position.lng())); 
    map.setZoom(18); 
    onItemClick(event, pinMarker); 
  }); 
} 
// Info window trigger function 
function onItemClick(event, pin) { 
  // Create content  
  var contentString = pin.data.text + "<br /><br /><hr />Coordinate: " + pin.data.lng +"," + pin.data.lat; 

  // Replace our Info Window's content and position 
  infowindow.setContent(contentString); 
  infowindow.setPosition(pin.position); 
  infowindow.open(map) 
} 
</script>  
</head>  
<body onload="initialize({lat:-3.19332,lng:55.952366,text:'<h2>Edinburgh</h2><i>Nice city!</i>'})"> 
  <div id="map_canvas">  
</div>  
</body>  
</html> 
```

# c++ - GCC 编译器是否支持经典 C++？

> ID：10999859
> 
> 赞同：2
> 
> 时间：2012-06-12T15:29:46.727
> 
> 标签：c++, linux, gcc, hp-ux

此问题与通过 HP-UX 可执行文件进行移植的过程有关。在 HP-UX 上，可执行文件是使用 HP-UX ACC 编译器编译和链接的。鉴于编译器早在 1996 年，它似乎不支持标准 C++（今天使用的 C++ 标准）。相反，它基于 HP-UX 称为经典 C++ 的 C++ 标准进行编译。我想知道 GCC 是否支持经典 C++ 的选项？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:37:15.757

在 gcc 文档中没有找到类似的东西，但我可能弄错了。

但是，您可以使用以下两个准则（来自[HP 文档](http://h21007.www2.hp.com/portal/site/dspp/menuitem.863c3e4cbcdc3f3515b49c108973a801?ciid=eb08b3f1eee02110b3f1eee02110275d6e10RCRD#porting)）从 Classic 移植到 Standard C++：

(1.) IOstream 标头：

`<iostream.h>`映射到`<iostream>`

`<fstream.h>`映射到`<fstream>`和可选`<iostream>`

`<strstream.h>`映射到`<strstream>`

`<iomanip.h>`映射到`<iomanip>`

`<iosfwd>`请注意，如果只需要声明 ostream 和 istream 而不需要特定的插入和提取运算符，则可以使用新的头文件。这将取代使用以下内容的情况：

```
class ostream; // replace by #include <iosfwd>
ostream& operator<<(ostream&, foo); // change based on (2) below 
```

(2.) 源映射：

执行以下一项（或多项）操作。这些更改适用于 IOstream 标头和容器标头。添加以下 using 指令。这适用于 -AA 或 -AP。

```
namespace std {} using namespace std;
cout << "hi guy" << endl; 
```

添加特定的 using 声明。这仅适用于 -AA。

```
using std::cout;
using std::endl;
cout << "hi guy" << endl; 
```

在每个符号前添加 std::。这仅适用于 -AA。

```
std::cout << "hi guy" << std::endl; 
```

# php - codeigniter restful web service + 数据库查询

> ID：10999866
> 
> 赞同：0
> 
> 时间：2012-06-12T15:30:11.157
> 
> 标签：php, mysql, xml, database, rest

请原谅我即将提出的问题，大声笑。（我对此非常陌生）

我已阅读[本教程](http://net.tutsplus.com/tutorials/php/working-with-restful-services-in-codeigniter-2/)。

我已经通过编辑 autoload.php 文件设置了自动连接到数据库。

我正在创建自己的控制器，称为 dsapi.php（代码如下），我希望该`ad_get()`函数从我的简单数据库中检索所有数据，以便可以在我开发的 android 应用程序中使用它。

我查看了 [此指南页面](http://codeigniter.com/user_guide/database/examples.html)并尝试写一些东西，但如您所见，我很无能为力。我什至接近我想要的？

```
class dsapi extends REST_Controller {

    function ad_get()
    {
        **$query = $this->db->query('SELECT index, title, detailed FROM ads');

        foreach ($query->result_array() as $row)
        {
            echo $row['index'];
            echo $row['title'];
            echo $row['detailed'];
        }

        $this->response($query, 200);**
    }

    function ad_put()
    {
        // create a new user and respond with a status/errors
    }

    function ad_post()
    {
        // update an existing user and respond with a status/errors
    }

    function ad_delete()
    {
        // delete a user and respond with a status/errors
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:54:09.117

[模型](http://codeigniter.com/user_guide/general/models.html) 和代码示例的[视频教程描述](http://codeigniter.com/tutorials/watch/blog/)

```
 class Blogmodel extends CI_Model 
 {
 var $title   = '';
 var $content = '';
 var $date    = '';

 function __construct()
 {
     // Call the Model constructor
     parent::__construct();
 }

 function get_last_ten_entries()
 {
     $query = $this->db->get('entries', 10);
     return $query->result();
 }

 function insert_entry()
 {
     $this->title   = $_POST['title']; // please read the below note
     $this->content = $_POST['content'];
     $this->date    = time();

     $this->db->insert('entries', $this);
 }

 function update_entry()
 {
     $this->title   = $_POST['title'];
     $this->content = $_POST['content'];
     $this->date    = time();

     $this->db->update('entries', $this, array('id' => $_POST['id']));
 }} 
```

# regex - 字符串格式，使用正则表达式 - 删除给定字符，并插入换行符

> ID：10999872
> 
> 赞同：0
> 
> 时间：2012-06-12T15:30:17.710
> 
> 标签：regex, string, format, notepad++, space

我有一个包含奇怪格式的 URL 的文件，字符由空格字符分隔。

```
h t t p : / / w w w . y o u t u b e . c o m / u s e r / A S D        
h t t p : / / m o r c c . c o m / f  r  m / i n d . p h p ? t o p i c = 5 7 . 0 
```

我想让它看起来像：

```
http://www.youtube.com/user/ASD
http://morcc.com/frm/ind.php?topic=57.0 
```

我使用记事本++，我认为正则表达式可以为我解决这个问题，不幸的是我不知道正则表达式。我想删除字符之间的 ' ' 字符（空格），并将它们保留为列出的格式，因此将 /s 替换为 '' 不是解决方案，因为它变得一团糟：/我想我还应该插入一个 /n在“http”发生之前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:36:11.920

你不能用空字符串''替换空格''吗？替换 \s 无法按照您的意愿工作，因为换行符也匹配。

如果这不起作用，你可以，如你所说，`\s`用 '' 替换，然后`http`用`\nhttp`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:34:44.477

正则表达式是相当基本的。查看示例页面。第二个例子似乎有你要找的东西：[http ://www.regular-expressions.info/examples.html](http://www.regular-expressions.info/examples.html)

编辑：另外，我假设你知道这一点，但可以肯定的是，正则表达式本身不会做你想做的事。您打算使用哪种语言使用正则表达式，以便人们可以提供更详细的响应？

正则表达式参考页 [书签它;)] - [http://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

# serial-port - 在不安装驱动程序的情况下以编程方式模拟串口

> ID：10999873
> 
> 赞同：1
> 
> 时间：2012-06-12T15:30:18.410
> 
> 标签：serial-port, driver, device, simulation, usermode

com0com 是一个拥有虚拟串口的好程序。我的问题：是否有任何库可用于在我的应用程序中以编程方式模拟串行端口（COM、USB 等），而无需为此类虚拟设备安装额外的软件？

类似于在用户空间中制作虚拟设备？操作系统：Windows

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T12:40:44.503

****HHD Software Ltd**的**免费虚拟串行端口**对您有好处（许可证免费软件）。**

 **![在此处输入图像描述](../Images/ebe387bf7a269564c8cc106d5aed1abd.png)

摘抄：

> 该设备驱动程序实现了虚拟串口设备的功能。与大多数其他设备驱动程序不同，它在**用户模式空间**中运行，使系统更加稳定和安全。

[阅读更多](http://www.hhdsoftware.com/free-virtual-serial-ports#ixzz21dZnpold)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-25T12:42:08.427

所有类似的软件都使用特殊的内核模式驱动程序。无法从用户空间创建虚拟 COM 端口。**

# android - 在 Android 应用程序中使用 SOAP 和 REST 服务

> ID：10999886
> 
> 赞同：0
> 
> 时间：2012-06-12T15:30:51.093
> 
> 标签：android, web-services

我试图创建一个示例应用程序来使用基于 SOAP 和 REST 的服务。当我尝试使用 KSOAP 2 API 开发使用 SAOP 服务的应用程序时，我收到*“操作超时”*作为响应。

当我尝试使用 REST 服务的应用程序时，它适用于本地服务，但如果我尝试连接互联网服务，我也会收到*“操作超时”*作为响应。

我认为代理是问题，所以我在模拟器中配置了代理设置，我现在可以通过模拟器中的浏览器访问服务。

请有任何建议或帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T10:00:49.470

如果您能够在模拟器的浏览器中访问 Web 服务，那么您可以在 android 应用程序中访问。

我看到您的代码只是替换了该行`String result= androidHttpTransport.responseDump;`

通过`SoapObject soapresult = (SoapObject) envelope.bodyIn;` 并添加这一行`String result = soapresult.getProperty(0).toString();`

如果您仍然有任何问题，请写信给我。

# mysql - MySQL - 邻接列表模型 - 获取深度

> ID：10999888
> 
> 赞同：4
> 
> 时间：2012-06-12T15:30:56.307
> 
> 标签：mysql, adjacency-list

我有一个组织表，其中包含一个`id`、一个`parent_id`和一个`name`列。此表中大约有 50k 行。只有一个顶级父级，其余的都在此之下。在 Oracle 中，我可以使用`level`伪列轻松检索特定组织的当前深度：

```
SELECT id, parent_id, level, name
FROM organizations
START WITH parent_id = 1
CONNECT BY PRIOR id = parent_id 
```

我不知道在 MySQL 中执行上述操作的正确方法是什么。我需要在一个查询中获取整个树以及节点的深度。

StackOverflow 上有很多与此有关的问题，但似乎都没有一个很好的答案，主要是指向具有可疑解决方案的博客的链接。当然，这以某种直接的方式是可行的吗？

不幸的是，以任何方式修改表都不是一种选择，因此嵌套集是不可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T17:43:08.080

这太搞笑了。我昨天刚刚在一个类似的问题上获得了 +50 赏金：[使用 MySQL 查询遍历行来制作递归树](https://stackoverflow.com/questions/10646833/using-mysql-query-to-traverse-rows-to-make-a-recursive-tree/11035966#11035966)

我在 DBA StackExchange 中引用[了如何使用存储过程执行此操作](https://dba.stackexchange.com/a/7161/877)（2011 年 10 月 24 日）

我将发布相同的存储过程以及我的 DBA StackExchange 答案中的示例：

获取任何给定节点的父节点的代码

```
DELIMITER $$
DROP FUNCTION IF EXISTS `junk`.`GetParentIDByID` $$
CREATE FUNCTION `junk`.`GetParentIDByID` (GivenID INT) RETURNS INT
DETERMINISTIC
BEGIN
    DECLARE rv INT;

    SELECT IFNULL(parent_id,-1) INTO rv FROM
    (SELECT parent_id FROM pctable WHERE id = GivenID) A;
    RETURN rv;
END $$
DELIMITER ; 
```

获取任何给定节点的祖先的代码

```
DELIMITER $$
DROP FUNCTION IF EXISTS `junk`.`GetAncestry` $$
CREATE FUNCTION `junk`.`GetAncestry` (GivenID INT) RETURNS VARCHAR(1024)
DETERMINISTIC
BEGIN
    DECLARE rv VARCHAR(1024);
    DECLARE cm CHAR(1);
    DECLARE ch INT;

    SET rv = '';
    SET cm = '';
    SET ch = GivenID;
    WHILE ch > 0 DO
        SELECT IFNULL(parent_id,-1) INTO ch FROM
        (SELECT parent_id FROM pctable WHERE id = ch) A;
        IF ch > 0 THEN
            SET rv = CONCAT(rv,cm,ch);
            SET cm = ',';
        END IF;
    END WHILE;
    RETURN rv;
END $$
DELIMITER ; 
```

获取任何给定节点的家谱（或后代）的代码

```
DELIMITER $$

DROP FUNCTION IF EXISTS `junk`.`GetFamilyTree` $$
CREATE FUNCTION `junk`.`GetFamilyTree` (GivenID INT) RETURNS varchar(1024) CHARSET latin1
DETERMINISTIC
BEGIN

    DECLARE rv,q,queue,queue_children VARCHAR(1024);
    DECLARE queue_length,front_id,pos INT;

    SET rv = '';
    SET queue = GivenID;
    SET queue_length = 1;

    WHILE queue_length > 0 DO
        SET front_id = FORMAT(queue,0);
        IF queue_length = 1 THEN
            SET queue = '';
        ELSE
            SET pos = LOCATE(',',queue) + 1;
            SET q = SUBSTR(queue,pos);
            SET queue = q;
        END IF;
        SET queue_length = queue_length - 1;

        SELECT IFNULL(qc,'') INTO queue_children
        FROM (SELECT GROUP_CONCAT(id) qc
        FROM pctable WHERE parent_id = front_id) A;

        IF LENGTH(queue_children) = 0 THEN
            IF LENGTH(queue) = 0 THEN
                SET queue_length = 0;
            END IF;
        ELSE
            IF LENGTH(rv) = 0 THEN
                SET rv = queue_children;
            ELSE
                SET rv = CONCAT(rv,',',queue_children);
            END IF;
            IF LENGTH(queue) = 0 THEN
                SET queue = queue_children;
            ELSE
                SET queue = CONCAT(queue,',',queue_children);
            END IF;
            SET queue_length = LENGTH(queue) - LENGTH(REPLACE(queue,',','')) + 1;
        END IF;
    END WHILE;

    RETURN rv;

END $$ 
```

为了演示一切的执行，这里是示例数据

```
USE junk
DROP TABLE IF EXISTS pctable;
CREATE TABLE pctable
(
    id INT NOT NULL AUTO_INCREMENT,
    parent_id INT,
    PRIMARY KEY (id)
) ENGINE=MyISAM;
INSERT INTO pctable (parent_id) VALUES (0);
INSERT INTO pctable (parent_id) SELECT parent_id+1 FROM pctable;
INSERT INTO pctable (parent_id) SELECT parent_id+2 FROM pctable;
INSERT INTO pctable (parent_id) SELECT parent_id+3 FROM pctable;
INSERT INTO pctable (parent_id) SELECT parent_id+4 FROM pctable;
INSERT INTO pctable (parent_id) SELECT parent_id+5 FROM pctable;
SELECT * FROM pctable; 
```

这是查看所有父母、祖先和家谱的查询

```
SELECT
    id,parent_id,
    GetParentIDByID(id),
    GetAncestry(id),
    GetFamilyTree(id)
FROM pctable; 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T15:58:57.340

没有 CTE/子查询因子分解的 SQL 中没有递归，因此在“纯 SQL”中，特别是在 MySQL 中实现的任意级别深度下，特别是绝对没有办法做到这一点。请参阅[如何将 MSSQL CTE 查询转换为 MySQL？](https://stackoverflow.com/questions/8833535/how-to-transform-a-mssql-cte-query-to-mysql)

这就是为什么您找到的所有答案都是黑客，以解决引擎的这个非常具体的限制。如果您仍然需要，您可以尝试此解决方案：[Generating Depth based tree from Hierarchical Data in MySQL (no CTEs)](https://stackoverflow.com/questions/5291054/hierarchical-sql-problem/5291159#5291159)。（当然，限制意味着解析查询并不奇怪，在 LangSec 的意义上，它允许进行各种有益的解析，并消除了一些安全问题，但对你没有帮助。）

`Lefts Join`你只剩下一堆耗尽层次结构的s，很抱歉让你失望并使用了一个糟糕的双关语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-15T08:37:41.680

@idok，如果您有多个孩子的相同父 ID，该函数将返回“截断不正确的 DOUBLE 值”错误，我从 dba 找到了以下修复，它由 Sivakumar Natarayan 提供

```
WHILE queue_length > 0 DO
    IF queue_length = 1 THEN
    SET front_id = queue;
        SET queue = '';
    ELSE
    SET front_id = SUBSTR(queue,1,LOCATE(',',queue)-1);
        SET pos = LOCATE(',',queue) + 1;
        SET q = SUBSTR(queue,pos);
        SET queue = q;
    END IF; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-15T17:18:45.033

Mysql 不支持递归 sql。当您只有 1 个维度时，您可以在 parent_id = id 上使用左连接。

# c - 调用 C 中的函数和未定义/未指定行为时的序列点

> ID：10999889
> 
> 赞同：4
> 
> 时间：2012-06-12T15:30:58.033
> 
> 标签：c, undefined-behavior, language-lawyer, sequence-points, unspecified-behavior

我试图确定我对 C 中序列点的理解——只是想检查一些东西。目前，我认为 (1) 是未定义的，而 (2) 只是未指定的，基于在 (2) 中，在评估`g`and的参数后存在序列点`h`（因此我们不会`i`在序列点之间修改两次） ，但参数的评估顺序`f`仍未指定。我的理解正确吗？

```
#include <stdio.h>

int g(int i) {
    return i;
}

int h(int i) {
    return i;
}

void f(int x, int y) {
    printf("%i", x + y);
}

int main() {
    int i = 23;
    f(++i, ++i); // (1)
    f(g(++i), h(++i)); // (2)
    return 0;
} 
```

编辑：

似乎这里的关键点是编译器是否可以在调用`g`或`h`调用之前自由执行这两个增量 - 我从下面的答案中理解是，尽管我很感激确认是这种情况。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T15:38:27.020

不正确。序列点指定允许的操作顺序的*部分顺序*。在情况（2）中，有序列点：

1.  在行尾的分号处 (1)
2.  在评估`g`（即`++i`）的参数之后但在调用之前`g`
3.  在评估`h`（即`++i`）的参数之后但在调用之前`h`
4.  在评估参数之后`f`（即之后`f`和`g`已经返回）但在调用之前`f`
5.  从返回后`f`

所以偏序看起来像这样，从上到下：

```
 1
   / \
  /   \
 2     3
  \   /
   \ /
    4
    |
    | 
    5 
```

2 和 3 没有相互排序，因为参数的评估顺序是未指定的。由于`i`在序列点 1 和 4 之间被修改了两次，因此行为未定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:33:29.063

不，根据 6.5.2.2 10，在实际调用之前，子表达式参数的评估之间没有序列点。

一种看待它的方式是未指定*行为*是否未定义。`++i`如果实现在任何调用`g`或之前对两个子表达式进行排序，`h`则行为未定义，但如果`++i`尽可能晚地评估子表达式（分别在调用`g`和之前`h`），则行为未指定。但是，由于实现始终可以自由地在任何允许的未指定行为之间进行选择，因此总体结果是未定义的。

# io - Hadoop 中的文本阅读器类

> ID：10999891
> 
> 赞同：2
> 
> 时间：2012-06-12T15:31:15.510
> 
> 标签：io, hadoop

我有一个目录 OUTPUT，其中包含 Map Reduce 作业的输出文件。输出文件是使用 TextOutputFormat 编写的文本文件。

现在我想从输出文件中读取键值对。如何使用 hadoop 中的一些现有类来做到这一点。我可以做到的一种方法如下

```
FileSystem fs = FileSystem.get(conf);
FileStatus[] files = fs.globStatus(new Path(OUTPUT + "/part-*"));
for(FileStatus file:files){
  if(file.getLen() > 0){
    FSDataInputStream in = fs.open(file.getPath());
    BufferedReader bin = new BufferedReader(new InputStreamReader(
        in));
    String s = bin.readLine();
    while(s!=null){
      System.out.println(s);
      s = bin.readLine();
    }
    in.close();
  }
} 
```

这种方法可行，但会大大增加我的任务，因为我现在需要手动解析每一行中的键值对。我正在寻找更方便的东西，可以直接让我读取某些变量中的键和值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:39:10.423

您是否被迫`TextOutputFormat`在上一份工作中使用作为您的输出格式？

如果没有，则考虑使用 SequenceFileOutputFormat，然后您可以使用 SequenceFile.Reader 以键/值对的形式读回文件。您还可以使用“查看”文件`hadoop fs -text path/to/output/part-r-00000`

**编辑**：您也可以使用`KeyValueLineRecordReader`该类，您只需将 FileSplit 传递给构造函数。

# c# - 如何加载实体框架预编译的视图

> ID：10999896
> 
> 赞同：4
> 
> 时间：2012-06-12T15:31:37.787
> 
> 标签：c#, .net, entity-framework, query-optimization

我发现我可以通过使用该`EdmGen.exe`工具预编译我的视图来提高我的应用程序的性能。

这一切都很好，但是我或我的大学都无法弄清楚项目**如何**实际使用生成的 .cs 文件。似乎没有任何对在任何地方生成的类的引用，那么它是如何被包含在内的呢？

任何人都可以对此有所了解，因为它真的很令人沮丧，不知道它是如何工作的！

* * *

## 编辑

我们已经确定[EntityViewGenerationAttribute](http://msdn.microsoft.com/en-us/library/system.data.mapping.entityviewgenerationattribute.aspx)用于标记预编译视图的类类型，但这必须意味着它通过反射加载。如果是这样的话，有没有办法明确地将预编译的视图类用于某个视图的代码中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-21T07:56:27.430

您可以尝试更改生成的代码。这样就返回了一个不同的视图。但是，如果您不返回视图，我希望 EF 会失败。

这个想法是生成的类适用于 DBContext 中的所有集合。实际上，如果视图与您拥有的上下文不匹配（哈希比较），您将收到运行时错误。

例如

```
 /// <Summary>
    /// The constructor stores the views for the extents and also the hash values generated based on the metadata and mapping closure and views.
    /// </Summary>
    public ViewsForBaseEntitySets24F9763E92A9F77E970A08557E1855C7579989F684539A5FB429069F966B9B7B()
    {
        this.EdmEntityContainerName = "Ef6Ctx3";
        this.StoreEntityContainerName = "CodeFirstDatabase";
        this.HashOverMappingClosure = "d7686982aa7cffcf874313838914e93f78d4d7d6d345d19261ef5edc8b4e96dd";
        this.HashOverAllExtentViews = "7b8857ee3ee44d13b2479e43c54dbdfb6bc8914e222c7891afcfcd9a29b06b2f";
        this.ViewCount = 2;
    } 
```

## 但是对于给定的视图，您可以返回不同的字符串

```
 /// <Summary>
    /// return view for CodeFirstDatabase.pocotest
    /// </Summary>
    private System.Collections.Generic.KeyValuePair<string, string> GetView0()
    {
        return new System.Collections.Generic.KeyValuePair<string, string>("CodeFirstDatabase.pocotest", @"
SELECT VALUE -- Constructing pocotest
    [CodeFirstDatabaseSchema.pocotest](T1.pocotest_Id, T1.pocotest_f1, T1.pocotest_f2, T1.pocotest_f2a, T1.pocotest_f3, T1.pocotest_f5, T1.pocotest_f6b)
FROM (
    SELECT 
        T.Id AS pocotest_Id, 
        T.f1 AS pocotest_f1, 
        T.f2 AS pocotest_f2, 
        T.f2a AS pocotest_f2a, 
        T.f3 AS pocotest_f3, 
        T.f5 AS pocotest_f5, 
        T.f6b AS pocotest_f6b, 
        True AS _from0
    FROM Ef6Ctx3.poco1s AS T
) AS T1");
    } 
```

# c++ - 合并内容相似但参数不同的函数

> ID：10999899
> 
> 赞同：1
> 
> 时间：2012-06-12T15:31:42.747
> 
> 标签：c++, design-patterns

给定以下（伪）代码：

```
typedef std::map<const unsigned int, unsigned long int> ModelVector;
typedef std::vector<unsigned long int> EncryptedVector;

int test1 (const EncryptedVector &x)
{
    //compute ModelVector y
    data = kenel1(x, y);
    //compute output
}
int test2 (const EncryptedVector &xx)
{
    //compute ModelVector y
    data = kenel2(xx, y);
    //compute output
}
int test3 (const EncryptedVector &x, const EncryptedVector &xx)
{
    //compute ModelVector y
    data = kenel3(x, xx, y);
    //compute output
}
int test4 (const EncryptedVector &x, const EncryptedVector &xSquared)
{
    //compute ModelVector y
    data = kenel4(x, xSquared, y);
    //compute output
} 
```

因为变量 y 和 output 在所有 4 个函数中的计算相同，并且由于我有一个“全局”对象，它允许我通过 switch 语句选择适当的内核函数，所以我想知道是否有更优雅的方式来编写它们，最好是以某种方式合并它们...

例如，像这样的东西（伪代码）将是一个不错的选择：

```
int test (const EncryptedVector &x, const EncryptedVector &xx, const EncryptedVector &xSquared)
{
    //compute ModelVector y
    //switch (kernel) -> select the appropriate one
    //compute output
}

test (x, NULL, NULL);//test1
test (NULL, xx, NULL);//test2
test (x, xx, NULL);//test3
test (x, NULL, xSquared);//test4 
```

或者，更好的是，我可以使用不同的参数组合多次声明 test，所有这些都回退到上面的那个（即使我会失去 x 和 xx 之间的语义区别）。

上述方法的问题是 C++ 不允许我传递 NULL 而不是 std::vector ，我认为我最好重复代码 4 次而不是通过指针传递变量而不是通过引用传递它们。 ..

有没有其他方法可以做到这一点？

* * *

编辑：这是内核函数的原型：

```
int kernel1 (const EncryptedVector &x, const ModelVector &y);
int kernel2 (const EncryptedVector &xx, const ModelVector &y);
int kernel3 (const EncryptedVector &x, const EncryptedVector &xx, const ModelVector &y);
int kernel4 (const EncryptedVector &x, const EncryptedVector &xSquared, const ModelVector &y); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:29:28.157

您最初的 4 个方法不是根据传递的参数的*类型*，而是根据传递的参数的*语义*`test`来选择不同的行为（例如，`kernel`调用不同的函数）。更不用说他们有完全不同的名字这一事实。

 **如果您能以某种方式将此参数化从一种语义更改为一种类型，则可以使用您提出的将所有 4 种方法组合为一个的方法。

这意味着拥有一个具有所有 3 个参数的函数，这正是您所建议的：

```
int test (const EncryptedVector &x, const EncryptedVector &xx, const EncryptedVector &xSquared) 
```

...问题当然是您不能通过`NULL`引用传递。你需要通过一个实际的`vector`. 您可以传递一个空的临时向量，如下所示：

```
test (x, EncryptedVector(), EncryptedVector());  //test1 
```

...然后根据`empty()`传入的状态在内部选择方法`vector`：

```
int test (const EncryptedVector &x, const EncryptedVector &xx, const EncryptedVector &xSquared)
{
    //compute ModelVector y
    //switch (kernel) -> select the appropriate one
      if( xx.empty() && xSquared.empty() )
      {
        // kenel1 method
      }
      else if( x.empty() && xSquared.empty() )
      {
        // kenel2 method
      }
      else if( ... etc ... )

    //compute output
} 
```

也许对于您的使用来说，这已经足够了，但以上至少引发了几个新问题。

一是`if`陈述链。这引入了复杂性，无论是在执行时间的因素方面，还是在可维护性方面更重要的方面。我知道我不想保留 4 页的`if`声明。

其他问题包括使用空 s 笨拙地调用方法，以及您仍然可以使用无效的s组合`vector`调用这一事实。`test``vector`

因此，回到使用基于类型的行为选择而不是语义选择。如果您没有为`test()`' 的参数指定具体类型，而是指定了 a`template`怎么办？

```
template<class VectorX, class VectorXX, class VectorXSquared>
int test(const VectorX& x, const VectorXX& xx, const VectorXSquared& xSquared); 
```

现在你还可以提供一个特殊的`NullVector`类型：

```
class NullVector {}; // Empty Class 
```

...然后`test`为您的每个有效用例明确专门化该功能（上面，您列出了 4 个有效用例）。

现在的调用`test`变成了这样：

```
test(x,NullVector(),NullVector());  // First Use Case 
```

这还有一个额外的好处。如果您不提供非专用版本的实现`test`，则任何使用无效参数调用的尝试`test`都将无法编译和链接。例如，在您列出的用例中，它们都没有使用 3 个有效`EncryptedVector`对象，所以这应该无法编译：

```
test(x, xx, xSquared); 
```

...确实，如果您不提供`test`.

好吧，说了这么多，也许没有得到很好的解释。所以这是一个完整的示例，我希望能帮助说明我在说什么：

```
#include <vector>
#include <string>
using namespace std;

typedef vector<string> EncryptedVector;

class NullVector{}; // Empty Class

int kernel1(const EncryptedVector& x)
{
    return 1;
}

int kernel2(const EncryptedVector& xx)
{
    return 2;
}

int kernel3(const EncryptedVector& x, const EncryptedVector& xx)
{
    return 3;
}

int kernel4(const EncryptedVector& x, const EncryptedVector& xSquared)
{
    return 4;
}

template<class VectorX, class VectorXX, class VectorXSquared> 
int test(const VectorX& x, const VectorXX& xx, const VectorXSquared& xSquared);

template<> int test<>(const EncryptedVector& x, const NullVector&, const NullVector&)
{
    return kernel1(x);
}

template<> int test<>(const NullVector&, const EncryptedVector& xx, const NullVector&)
{
    return kernel2(xx);
}

template<> int test<>(const EncryptedVector& x, const EncryptedVector& xx, const NullVector&)
{
    return kernel3(x, xx);
}

template<> int test<>(const EncryptedVector &x, const NullVector&, const EncryptedVector &xSquared)
{
    return kernel4(x,xSquared);
}

int main()
{
    EncryptedVector x, xx, xSquared;  // each somehow populated

    ///*** VALID USE-CASES ***///
    test(x,NullVector(),NullVector());
    test(NullVector(),xx,NullVector());
    test(x,xx,NullVector());
    test(x,NullVector(),xSquared);

    ///*** INVALID USE CASES WILL FAIL TO COMPILE&LINK ***///
    test(x,xx,xSquared);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:38:38.287

您可以发送一个包含附加参数并具有计算内核（kenel？）的函数的对象（如果我没记错的话，它称为函子）。

```
// Main function, looks more generic now
template <class F>
int test1234(F functor)
{
    //compute ModelVector y
    data = functor(y);
    //compute output
}

...

// Functors involve some tedious coding, but at least your main calculation is clean
struct functor_for_kernel1
{
    const EncryptedVector &x;
    functor_for_kernel1(const EncryptedVector &x): x(x) {}
    int operator(const ModelVector &y) {return kernel1(x, y);
};

struct functor_for_kernel2 // easy
...

struct functor_for_kernel3
{
    const EncryptedVector &x, const EncryptedVector &xx;
    functor_for_kernel3(const EncryptedVector &x, const EncryptedVector &xx): x(x), xx(xx) {}
    int operator()(const ModelVector &y) {return kernel3(x, xx, y);
};

struct functor_for_kernel4 // easy
...

// Usage of the unified function
test1234(functor_for_kernel1(x));
test1234(functor_for_kernel2(xx));
test1234(functor_for_kernel3(x, xx));
test1234(functor_for_kernel4(x, xx)); 
```**

# c - C中函数的动态接口

> ID：10999905
> 
> 赞同：3
> 
> 时间：2012-06-12T15:31:56.287
> 
> 标签：c

假设你有一个函数`read_key`，通常它会做一些事情。您应该能够用他的功能替换它，`read_key_myfunction`并且它可以做其他事情。一般的方法当然是构建一个数组并注册函数指针或使用简单的 switch 语句（或两者）。

但我的目标更广泛一些：人们应该能够编写他们的 C 语言而不干扰我的代码，并且它仍然应该注册。当然，我告诉他们要实现哪个接口。

他们现在基本上做的是为我的软件编写一个库，我根据配置选项动态加载它。可以把它想象成 OpenSSL 引擎：任何人都可以编写自己的引擎，将其编译为 dll/so 并分发。他们不需要修改（或知道）OpenSSLs 代码，只要他们坚持定义的接口。

我只想要我的程序相同的（它最终将成为 OpenSSL 引擎功能的包装器）。

一位同事建议我应该在每个文件中使用*相同*的函数并动态加载库。这听起来对我来说是一个很好的解决方案，但我不太满意，因为我没有看到 OpenSSL 在其引擎代码中使用任何非引擎特定的函数。

*如果有些事情不清楚这里是我的具体例子：*

我正在扩展一个名为 sscep 的程序，它实现了自动证书更新协议。将来应该在 HSM 中进行大量加密（现在应该在 Windows 密钥管理中进行（由 OpenSSL 的 capi 引擎访问））。

虽然 OpenSSL 已经提供了一个通用接口，但我需要事先做一些事情，这取决于所使用的引擎。我还想为其他人打开快速扩展它的可能性，而不必深入研究我的代码（就像我之前的人那样）。

如果有人有任何想法，将不胜感激看到某种指南。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:38:07.503

您所描述的通常称为插件架构/插件框架。您需要将跨平台的 dlopen/LoadLibrary 功能与一些用于注册和执行导出函数查找的逻辑相结合。您应该能够在互联网上找到有关如何执行此操作的示例。

# xaml - 如何将 XAML 画笔转换为 Direct2D 画笔？

> ID：10999908
> 
> 赞同：0
> 
> 时间：2012-06-12T15:32:12.357
> 
> 标签：xaml, direct2d, microsoft-metro

我正在开发 Metro Style 应用程序。在 Metro 中，您可以[混合使用 XAML 和 DirectX](http://msdn.microsoft.com/en-us/library/windows/apps/hh825871.aspx)。我正在创建一个 XAML 用户控件，它使用共享表面在 Direct2D 中呈现某些内容。我希望能够在 XAML 中指定一个画笔，我可以使用它来填充 Direct2D 中的几何图形。

我认为我需要能够将[Windows::UI::Xaml::Media::Brush](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.brush.aspx)转换为[ID2D1Brush](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371173%28v=vs.85%29.aspx)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:45:08.003

Direct2D 接口与 XAML 类有着密切的对应关系。但是，有几件事您将无法仅使用 复制或模拟`ID2D1Brush`，例如`Transform`vs. `RelativeTransform`。如果您查看类似`TileBrush`or的内容，情况会变得更糟`LinearGradientBrush.MappingMode`。您需要创建自己的包装器，`ID2D1RenderTarget`其中考虑的因素比通常可用的更多。

Direct2D 是一个低级绘图 API，而 XAML 类是更大的表示/UI 框架的一部分（它是缩减的 WPF/Silverlight）。如果您不担心无法复制或模拟的属性，那么只需创建一些静态实用程序方法来在两者之间进行转换。

# symfony - Symfony2 最佳实践 - 需要用户的捆绑包的正确组织

> ID：10999912
> 
> 赞同：0
> 
> 时间：2012-06-12T15:32:22.920
> 
> 标签：symfony, bundles

我已经与 Symfony2 合作了几个星期，并且喜欢它。

但是，我对一个方面有点困惑。假设我有两个包，每个包都有一个“用户”实体，用于存储有关该用户的信息。

但是，我希望能够使用站点管理员选择的任何身份验证进行实际身份验证（即使它不是我的捆绑包中的用户实体之一）。

组织这些实体并将它们全部链接起来的最佳实践是什么，同时在实际身份验证中保持灵活性。

谢谢。

* * *

更新：这是一个澄清。

想象一下，我有两个捆绑包：论坛和维基。

现在，对于用户来说，这两个系统想要存储很多不同的数据。所以，每个人都会有一些地方来存储它们（比如两个不同的表）。但是，它们都不存储认证信息，只存储其他信息。

这个想法是，无论使用哪种身份验证方法，他们都能够获得该令牌，然后确定他们应该在自己的包中使用哪些用户数据。这样，捆绑包将能够独立于彼此以及独立于身份验证方法工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:49:07.303

我认为您想避免拥有多个用户实体。要快速将一些最佳实践集成到您的应用程序中，请查看[FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)。这将为您提供允许用户注册、登录等所需的大约 80% 的功能。在扩展 FOSUserBundle 的应用程序中创建您自己的 UserBundle。例如，您的 User 实体可能如下所示：

```
use FOS\UserBundle\Entity\User as BaseUser;

/**
 * Extend the FOSUserBundle base User class.
 * @ORM\Entity
 * @ORM\Table(name="user")
 */
class User extends BaseUser {
    ...
} 
```

将此扩展的用户实体 ( `YourApp\UserBundle\Entity\User`) 引用为项目中所有其他捆绑包中的规范用户实体。

# mysql - 为什么 SQL 查询的结果没有按我期望的顺序返回？

> ID：10999913
> 
> 赞同：4
> 
> 时间：2012-06-12T15:32:25.847
> 
> 标签：mysql, sql, sql-server, postgresql, sqlite

如果在表中插入项目，然后我编写查询，例如`select * from table`，为什么结果不是我期望的顺序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T15:32:26.190

可以通过在语句中使用“Order by”子句来强制查询的顺序。SQL 数据库实际上并不了解您将事物放入的顺序，或者以给定的顺序存储数据。这意味着您需要告诉 SQL 您想要项目的顺序。例如：

```
Select * from Table
  order by column1 desc 
```

把它想象成把一些东西交给你的朋友拿着——她稍后会为你准备好所有的东西，但同时她会把它存放在某个地方。当你不想为其他东西腾出空间时，她可能会移动它，或者可能会按照你给她的相同顺序把它交还给她，但你没有告诉她保持秩序，所以她不会.

数据库需要能够在后台移动事物，因此它们的构建方式本质上并不知道任何顺序 - 当您将其提供给数据库时，您需要知道顺序，以便您可以将其放回稍后订购您想要的。order 子句允许 SQL 对数据强加一个顺序，但它不记得或自己有一个。

**要点**：即使 SQL 在最后 100 万次没有 order by 语句的情况下以正确的顺序返回项目，也不能保证它会这样做。即使表上存在聚集索引，也不能保证按您期望的顺序返回结果。特别是当 SQL 版本发生变化时，不显式使用 order by 子句可能会破坏假设查询将按照他们想要的顺序的程序！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:46:19.027

以插入的顺序期望结果是一种常见的误解。即使使用聚集索引，结果集也可能不如预期。强制命令的唯一方法是使用“order by”子句。订单与预期不同的原因可能会有所不同。查询可能是并行执行的，结果集可能会被合并，也可能是由于查询优化计划，同时试图尽可能快地返回结果集。

# c# - SQL Server "SELECT COUNT(field) FROM tblname" 返回 null

> ID：10999918
> 
> 赞同：1
> 
> 时间：2012-06-12T15:32:34.417
> 
> 标签：c#, sql-server

这很奇怪。我的 c# 应用程序中有一个非常简单的 SQL 查询，它计算 SQL Server 表中的记录。代码片段如下：

```
 // Returns the number of ports defined for a given slot.
    int returnval = 0;
    connection.Open();
    SqlCommand command = new SqlCommand("SELECT COUNT(Slotted_Port_UID) FROM tblSlottedCardPorts WHERE Slot_ID = @SlotID ", connection);
    command.Parameters.AddWithValue("@SlotID", EquipmentSlotID);
    SqlDataReader reader = command.ExecuteReader();
    if (reader.HasRows)
    {
        if (!reader.IsDBNull(0))
        {
            returnval = reader.GetInt32(0);
        }
    }
    reader.Close();
    connection.Close();
    return returnval; 
```

当我将 SQL 语句直接复制并粘贴到 SQL server mgmt studio 中时，查询按预期返回，返回 0 或正整数，具体取决于行数。但是，尽管代码通过了 .HawRows 条件，但它在 reader.IsDBNull(0) 条件下失败。tblSlottedCardPorts 存在，Slotted_Port_UID 列是唯一整数。对此有何建议？我不明白为什么 COUNT 会返回 Null 值，因为不涉及连接或其他因素。

感谢您对此的任何建议！

米切尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T15:36:48.270

对于这种类型的查询 - 使用`.ExecuteScalar()`而不是数据读取器

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T15:34:21.447

您需要打电话`Read`才能到达第一行。

```
if (reader.HasRows)
{
    reader.Read();
    if (!reader.IsDBNull(0))
    {
        returnval = reader.GetInt32(0);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-02T15:13:41.313

更简单的说法是

```
 int returnval = 0;
        using (SqlConnection con = new SqlConnection(connStr))
        {
                SqlCommand command = new SqlCommand("SELECT COUNT(Slotted_Port_UID) FROM tblSlottedCardPorts WHERE Slot_ID = @SlotID ", connection);
                command.Parameters.AddWithValue("@SlotID", EquipmentSlotID);
                returnval = Convert.ToInt32(command.ExecuteScalar());

        } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-15T20:36:26.060

我在 SQL 中有这样的东西：

```
declare @NumberOfRecords int;
select @NumberOfRecords=count(*) from ...
return @NumberOfRecords; 
```

存储过程从 SQL Management Studio 运行正常，但从代码调用时返回 null。删除`@NumberOfRecords`变量后，查询从代码中工作：

```
select count(*) from ... 
```

# wcf - 在 WCF customBinding 中同时接受 UsernameToken 和 BinarySecurityToken

> ID：10999924
> 
> 赞同：2
> 
> 时间：2012-06-12T15:32:45.180
> 
> 标签：wcf, web-services, ws-security

我正在使用 customBinding 端点构建 WCF Web 服务，并且无法接受另一方发送给我的 WS-Security 标头。我们都遵循英国国家卫生服务局制定的规范，因此我无法修改要求。

标头的基本结构`<wsse:Security>`应如下所示，根据规范：

```
<wsse:Security>
    <wsu:Timestamp xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurityutility-1.0.xsd" wsu:Id="6CCF6A2B-11A6-11DF-86D1-236A99759561" >
        <wsu:Created>2012-06-12T09:00:00Z</wsu:Created>
        <wsu:Expires>2012-06-12T09:15:00Z</wsu:Expires>
    </wsu:Timestamp>
    <wsse:UsernameToken>
        <wsse:Username>SomeUsername</wsse:Username>
    </wsse:UsernameToken>
    <wsse:BinarySecurityToken EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wsssoap-message-security-1.0#Base64Binary" ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-
200401-wss-x509-token-profile-1.0#X509v3" wsu:Id="30b91ede-35c2-11df-aac9-97f155153931 ">xxx...</wsse:BinarySecurityToken>
    <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
        <SignedInfo>
            <CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#RSA-SHA1" />
            <Reference URI="#6CCF6A2B-11A6-11DF-86D1-236A99759561" />
            <Transforms>
                <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>xxx...</DigestValue>
        </SignedInfo>
        <SignatureValue>xxx...</SignatureValue>
        <KeyInfo>
            <wsse:SecurityTokenReference>
                <wsse:Reference URI="#30b91ede-35c2-11df-aac9-97f155153931 "/>
            </wsse:SecurityTokenReference>
        </KeyInfo>
    </Signature>
</wsse:Security> 
```

在我的 Web 服务中，我尝试使用以下绑定：

```
<customBinding>
    <binding name="wsHttpSoap11" >
        <textMessageEncoding messageVersion="Soap11WSAddressingAugust2004" />
        <security authenticationMode="MutualCertificate">
        </security>
        <httpTransport/>
    </binding>
</customBinding> 
```

（我使用 customBinding 的原因是我必须同时支持**WS-Addressing**和**WS-Security** over **SOAP 1.1**，并从[这个答案](https://stackoverflow.com/a/5418950/483162)中得到建议。）

如果我通过 Fiddler 运行示例请求，我的 WCF 跟踪中会出现以下错误：

> 找不到“ **System.IdentityModel.Tokens.UserNameSecurityToken** ”令牌类型的令牌身份验证器。根据当前的安全设置，不能接受该类型的令牌。

我相信这是因为它无法验证`<UsernameToken>`. 如果我将绑定安全更改为：

```
<security authenticationMode="UserNameForCertificate"> 
```

然后我得到这个错误：

> 找不到“ **System.IdentityModel.Tokens.X509SecurityToken** ”令牌类型的令牌身份验证器。根据当前的安全设置，不能接受该类型的令牌。

我相信这是因为它现在无法验证`<BinarySecurityToken>`！

因此，问题是：

1.  我对错误消息原因的假设是否正确（它在当前配置中只能处理一个令牌）？
2.  如何将其配置为接受两个令牌？

**更新**

感谢@Yaron，我现在添加了一个自定义绑定扩展，并且**UserNameSecurityToken**和**X509SecurityToken**都在验证。

但是，它现在在验证 XML 签名的阶段失败了。HTTP 响应中返回的异常是：

> 消息安全验证失败。

如果我深入研究服务跟踪查看器中的堆栈跟踪，我会看到：

> System.Security.Cryptography.CryptographicException...
> 
> 签名验证失败。
> 
> 在 System.IdentityModel.SignedXml.VerifySignature(HashAlgorithm hash, AsymmetricSignatureDeformatter deformatter) 在 System.IdentityModel.SignedXml.StartSignatureVerification(SecurityKey verificationKey) ...

谁能帮我弄清楚为什么会这样？我现在有点迷路了。我尝试使用[一些示例代码](http://msdn.microsoft.com/en-us/library/ms229950%28v=vs.90%29.aspx)来尝试手动验证签名，但它说签名无效。在我回到供应商处之前，我如何确定它是否存在？这是应该工作的东西吗？我们应该在某个地方共享一些证书吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T17:19:39.170

您将需要从代码创建绑定。

```
 var b = new CustomBinding();
        var sec = (AsymmetricSecurityBindingElement)SecurityBindingElement.CreateMutualCertificateBindingElement(MessageSecurityVersion.WSSecurity10WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10);
        sec.EndpointSupportingTokenParameters.Signed.Add(new UserNameSecurityTokenParameters());
        sec.MessageSecurityVersion =
            MessageSecurityVersion.
                WSSecurity10WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10;
        sec.IncludeTimestamp = true;
        sec.MessageProtectionOrder = System.ServiceModel.Security.MessageProtectionOrder.EncryptBeforeSign;

        b.Elements.Add(sec);
        b.Elements.Add(new TextMessageEncodingBindingElement(MessageVersion.Soap11, Encoding.UTF8));
        b.Elements.Add(new HttpTransportBindingElement()); 
```

（有些值是估计的，因为我无法通过您的帖子判断您使用的是哪个肥皂版本或是否应用了 ssl）

您可能稍后运行的另一个问题是您需要在 ServiceContract 属性上有 ProtectionLevel.SignOnly，但这与这个问题无关。

# android - 重新加载 SharedPreferences 数据

> ID：10999927
> 
> 赞同：1
> 
> 时间：2012-06-12T15:32:48.270
> 
> 标签：android, android-activity, sharedpreferences, reload

我正在制作一个具有主要活动和其他几个活动的 android 应用程序。主要活动（以及其他一些活动）从 SharedPreferences 加载数据。但是，当我启动一个新活动时，它有一些选项可以更改我在主活动中使用的 SharedPreferences 中的数据，然后我使用后退按钮返回主活动，那里的数据仍然相同（与在我更改它之前），一旦我返回主要活动，我必须以某种方式从 SharedPreferences 重新加载数据，这怎么可能？？？请帮助我，并提前非常感谢！

主要活动代码：

```
package com.mycompanyname.myappname;

import java.util.Calendar;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class myActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
TextView nextAirFilterCleaningTextView, nextPistonChangingTextView, nextOilChangingTextView;
Button manageButton;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //Import views
    manageButton = (Button)findViewById(R.id.manageButton);
    nextAirFilterCleaningTextView = (TextView)findViewById(R.id.nextAirFilterCleaningTextView);
    nextPistonChangingTextView = (TextView)findViewById(R.id.nextPistonChangingTextView);
    nextOilChangingTextView = (TextView)findViewById(R.id.nextOilChangingTextView);

    //Setup onClickListener for the buttons
    manageButton.setOnClickListener(this);

    //Check if the user has been using his motorcycle
    android.content.Context ctx = getApplicationContext();
    Intent i = new Intent(ctx, UsageActivity.class);
    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    ctx.startActivity(i);

    //Load first time use screen
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
    boolean previouslyStarted = prefs.getBoolean(getString(R.string.pref_previously_started), false);
    if(!previouslyStarted){
    SharedPreferences.Editor edit = prefs.edit();
    edit.putBoolean(getString(R.string.pref_previously_started), Boolean.TRUE);
                edit.commit();
                android.content.Context ctx5 = getApplicationContext();
                Intent i5 = new Intent(ctx5, FirsttimeusageActivity.class);
                i5.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                ctx5.startActivity(i5);
}

    //Load information from SharedPreferences
    SharedPreferences settings = getSharedPreferences("settingsInfo", 0);
    nextAirFilterCleaningTextView.setText("Next air filter cleaning: " + settings.getString("daysTillAirFilterCleaning", "") + " days");
    nextPistonChangingTextView.setText("Next piston changing: " + settings.getString("hoursTillPistonChange", "").toString() + " hours of usage left");
    nextOilChangingTextView.setText("Next oil changing: " + settings.getString("hoursTillOilChange", "").toString() + " hours of usage left");
}
@Override
public boolean onCreateOptionsMenu(Menu meny) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menubuttons, meny);
    return true;
}
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch(item.getItemId()) {
    case R.id.NewEvent:
        //Create new calendar event
        Calendar cal = Calendar.getInstance();              
        Intent intent = new Intent(Intent.ACTION_EDIT);
        intent.setType("vnd.android.cursor.item/event");
        intent.putExtra("beginTime", cal.getTimeInMillis());
        intent.putExtra("allDay", true);
        intent.putExtra("rrule", "FREQ=YEARLY");
        intent.putExtra("endTime", cal.getTimeInMillis()+60*60*1000);
        intent.putExtra("title", "");
        startActivity(intent);
        break;
    case R.id.About:
        //Load about activity and screen
        android.content.Context ctx6 = getApplicationContext();
        Intent i6 = new Intent(ctx6, AboutActivity.class);
        i6.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctx6.startActivity(i6);
        break;
    case R.id.settings:
        //Load settings activity and screen
        android.content.Context ctx4 = getApplicationContext();
        Intent i4 = new Intent(ctx4, settingsActivity.class);
        i4.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctx4.startActivity(i4);
        break;
    case R.id.Homepage:
        //Load webpage by using custom activity
        android.content.Context ctx = getApplicationContext();
        Intent i = new Intent(ctx, Activity.class);
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctx.startActivity(i);
        break;
    case R.id.famoustracks:
        android.content.Context ctx7 = getApplicationContext();
        Intent i7 = new Intent(ctx7, Activity.class);
        i7.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctx7.startActivity(i7);
        break;
        }
    return true;
}
public void onClick(View src) {
    switch(src.getId()) {
    case R.id.manageButton:
        android.content.Context ctx1 = getApplicationContext();
        Intent i1 = new Intent(ctx1, ManageActivity.class);
        i1.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        ctx1.startActivity(i1);
        break;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:20:41.417

我修好了它：

```
@Override
public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
    //Load information from SharedPreferences
    SharedPreferences settings = getSharedPreferences("settingsInfo", 0);
    nextAirFilterCleaningTextView.setText("Next air filter cleaning: " + settings.getString("daysTillAirFilterCleaning", "") + " days");
    nextPistonChangingTextView.setText("Next piston changing: " + settings.getString("hoursTillPistonChange", "").toString() + " hours of usage left");
    nextOilChangingTextView.setText("Next oil changing: " + settings.getString("hoursTillOilChange", "").toString() + " hours of usage left");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:39:14.633

只要您的活动仍然存在，您就可以使用监听器。有关详细信息，请参阅此答案：

[如何更新主要活动以知道首选项已更改？](https://stackoverflow.com/questions/10617363/how-to-update-main-activity-to-know-that-prefs-are-changed/10617535#10617535)

# sql - DB2 z/OS 按列表更新

> ID：10999930
> 
> 赞同：0
> 
> 时间：2012-06-12T15:32:58.487
> 
> 标签：sql, db2, zos

我在文本文件中有一个 3k ID 的列表。我应该找到具有此类 ID 的行并更新它们。我希望能像这样工作

```
WITH RECORD_ID
(ID) AS (
'12345',
...
'32134')
UPDATE MY_TABLE T
SET T.NAME = REPLACE(T.NAME, X'03', '')
WHERE EXISTS (SELECT 1 FROM RECORD_ID R WHERE R.ID = T.ID); 
```

但这不起作用。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:30:30.263

您不能只在 DB2 中的 CTE 中有一个值列表，您必须将`UNION ALL`这些值放在一起：

```
WITH RECORD_ID (ID) AS (
    SELECT '12345' FROM SYSIBM.SYSDUMMY1 UNION ALL
    -- ...
    SELECT '32134' FROM SYSIBM.SYSDUMMY1
)
UPDATE MY_TABLE T
SET T.NAME = REPLACE(T.NAME, X'03', '')
WHERE EXISTS (SELECT 1 FROM RECORD_ID R WHERE R.ID = T.ID); 
```

应该管用。

不过，我同意@X-Zero 的观点……似乎一个`IN`子句中的值列表更合适，除非您有特定的原因要使用 CTE。

# python - 无法从 Python 调用 Azure 服务总线

> ID：10999931
> 
> 赞同：2
> 
> 时间：2012-06-12T15:32:59.677
> 
> 标签：python, azure

尝试运行 hello world 示例以将某些内容放在队列中，创建一个队列......每当我调用 azure 时，我都会收到错误消息。

这是代码：

```
from azure.servicebus import *

bus_service = ServiceBusService(service_namespace='testtest', account_key='my_access_token', issuer='my_issuer')
bus_service.create_topic('mytopic') 
```

这是我回来的错误：

```
$ /c/Python27/python pythontest.py
Traceback (most recent call last):
  File "pythontest.py", line 4, in <module>
    bus_service.create_topic('mytopic')
  File "c:\Python27\lib\site-packages\azure\servicebus\servicebusservice.py", line 1
42, in create_topic
    request.headers = _update_service_bus_header(request, self.account_key, self.iss
uer)
  File "c:\Python27\lib\site-packages\azure\servicebus\__init__.py", line 185, in _u
pdate_service_bus_header
    request.headers.append(('Authorization', _sign_service_bus_request(request, acco
unt_key, issuer)))
  File "c:\Python27\lib\site-packages\azure\servicebus\__init__.py", line 192, in _s
ign_service_bus_request
    return 'WRAP access_token="' + _get_token(request, account_key, issuer) + '"'
  File "c:\Python27\lib\site-packages\azure\servicebus\__init__.py", line 233, in _g
et_token
    connection.send(request_body)
  File "c:\Python27\lib\site-packages\azure\http\winhttp.py", line 313, in send
    self._httprequest.send(request_body)
  File "c:\Python27\lib\site-packages\azure\http\winhttp.py", line 198, in send
    ctypes.memmove(safearray.pvdata, request, len(request))
WindowsError: exception: access violation writing 0x0000000000000000 
```

无论我将某些内容放在队列上还是创建队列、创建主题、向主题发送消息等，它总是给我同样的错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:21:20.980

这是您使用的确切代码吗？至少account_key不对，应该是base64格式

```
bus_service = ServiceBusService(service_namespace='testtest', account_key='my_access_token', issuer='my_issuer') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T22:19:07.550

当从 64 位 Python 使用时，这是 azure 库的问题。

使其工作的更改很小，因此我在此处为您列出了它们。该修复程序也将很快推送到 github + pypi。

**对azure/http/winhttp.py**进行以下更改：

将**c_size_t**添加到导入语句

```
from ctypes import c_void_p, c_long, c_ulong, c_longlong, c_ulonglong, c_short, c_ushort, c_wchar_p, c_byte, c_size_t 
```

将**CoInitialize(0)**替换为

```
CoInitialize(None) 
```

用这个替换**Com 相关的 APIs**部分

```
_ole32 = oledll.ole32
_oleaut32 = WinDLL('oleaut32')
_CLSIDFromString = _ole32.CLSIDFromString
_CoInitialize = _ole32.CoInitialize
_CoInitialize.argtypes = [c_void_p]

_CoCreateInstance = _ole32.CoCreateInstance

_SysAllocString = _oleaut32.SysAllocString
_SysAllocString.restype = c_void_p
_SysAllocString.argtypes = [c_wchar_p]

_SysFreeString = _oleaut32.SysFreeString
_SysFreeString.argtypes = [c_void_p]

_SafeArrayDestroy = _oleaut32.SafeArrayDestroy
_SafeArrayDestroy.argtypes = [c_void_p]

_CoTaskMemAlloc = _ole32.CoTaskMemAlloc
_CoTaskMemAlloc.restype = c_void_p
_CoTaskMemAlloc.argtypes = [c_size_t] 
```

# svn - SVN 合并优先级

> ID：10999935
> 
> 赞同：0
> 
> 时间：2012-06-12T15:33:07.473
> 
> 标签：svn, tortoisesvn

我们在 SVN 中有一个项目，它只在一个主干上。我需要在不影响主要开发的情况下向代码添加一些注释，因此在一个共同点上分支。

不幸的是，开发人员需要恢复到我之前添加的注释（在主干上）之前的代码版本。所以，我所有的评论都被有效地从主干工作副本中编辑了出来。我认为这是通过覆盖或复制完成的，因为我在日志中看不到任何版本控制的证据。（顺便说一句，在我的评论被添加到这里之前，他会更好地分支吗？现在有点晚了，但对于未来的应用程序可能值得了解。）

过了一会儿，我从主干合并到我的分支，结果丢失了我之前从文件中的所有评论。（它们显然仍在旧版本的存储库中。）它们存在于我的分支文件中，但我认为主干编辑优先，因为它们后来？

我只是想知道如何最好地解决这个问题并阻止它在未来发生，除了根本不分支？没有合并冲突，因为我的评论是与现有代码分开的块。

此外，除了手动编辑它们之外，重新获得我的代码注释的最佳方法是什么？它们是广泛的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:41:28.413

我刚刚在测试存储库中使用单个文件尝试了 malenkiy_scot 的建议，并认为它正在做我想要的。为了澄清，我采取的步骤如下：1）将我的文件与包含我的评论块的特定早期版本合并，选中“忽略祖先”框。2）从主干合并更改（在此之后我的评论仍然存在） 3）重新集成分支。

我认为这就是建议的内容，但无论如何它似乎可以按我的意愿工作，并且会为我节省大量打字时间，非常感谢您的帮助。

# java - Eclipse RPC SelectionChanged 事件监听器

> ID：10999940
> 
> 赞同：0
> 
> 时间：2012-06-12T15:33:37.910
> 
> 标签：java, events, listener, rpc, selectionchanged

如何将 text.getText() 传递给 selectionChanged ？铸造似乎不起作用。我在按钮按下时使用它。这是完整的课程，但是 StackOverflow 不允许我在不逐行解释的情况下在这里放更多文本。

```
Listener listener = new Listener() {
    public void handleEvent(Event event) {
        if (event.widget == button3) {
            viewer.setSelection(text.getText());
        }
    }

public class OpisView extends ViewPart implements ActionListener,ISelectionListener {

    public final static String VIEW_ID="DetailsView";
    private String path;
    public Composite x ;
    private TableViewer viewer;
            //public static final String VIEW_ID = "com.example.rcpmvc.calculator";

            @Override
            public void createPartControl(final Composite parent) {
                final Text text = new Text(parent, SWT.NONE);

                getViewSite().getPage().addSelectionListener(this);
                viewer = new TableViewer(parent, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL);
                PlatformUI.getWorkbench().getHelpSystem().setHelp(viewer.getControl(), "Widoki.OpisView");
                text.setText("");
                x = parent;

                parent.setLayout(new GridLayout(2, false));
                GridData gridData = new GridData();
                gridData.widthHint = 50;
                gridData.heightHint = 30;
                getSite().setSelectionProvider(viewer);
                getViewSite().getPage().addSelectionListener(this);

                final Button button1 = new Button(parent, SWT.PUSH);
                final Button button2 = new Button(parent, SWT.PUSH);
                final Button button3 = new Button(parent, SWT.PUSH);

                Listener listener = new Listener() {
                      public void handleEvent(Event event) {
                        if (event.widget == button1) {

                            FileRead x = new FileRead();
                            try {
                                x.Add(text.getText(),path);
                                showMessage("Pomyslnie otagowano " +  path + ", tagiem " + text.getText());
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }

                        } 
                        if (event.widget == button2) {

                            FileRead x = new FileRead();
                            try {
                                x.Remove(text.getText(),path);
                                showMessage("Pomyslnie usunieto tag " + text.getText() + " z pliku " + path);
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }

                        }
                        if (event.widget == button3) {

                                text.getText();

                        }
                      }
                    };

                text.addListener(SWT.KeyDown, listener);
                button1.setLayoutData(gridData);
                button1.addListener(SWT.Selection, listener);
                button1.setText("Dodaj");

                button2.setLayoutData(gridData);
                button2.addListener(SWT.Selection, listener);
                button2.setText("Usuń");

                button3.setLayoutData(gridData);
                button3.addListener(SWT.Selection, listener);
                button3.setText("Wyszukaj");

                // Set the sorter for the table

                //sGridLayoutFactory.fillDefaults().numColumns(3).spacing(3, 0).margins(0, 0).applyTo(parent);

                GridLayoutFactory.swtDefaults().numColumns(3).spacing(0, 0).margins(0, 0).applyTo(parent);

            }

            private void showMessage(String message) {
                MessageDialog.openInformation(
                    x.getShell(),
                    "Opis",
                    message);
            }

            public void selectionChanged(IWorkbenchPart part, ISelection selection) {
                if (selection instanceof IStructuredSelection) {
                    Object obj = ((IStructuredSelection) selection).getFirstElement();

                    if (obj instanceof String) {

                        path = (String) obj;
                    }
                }   
            }

} 
```

你能帮我解决这个问题吗？我真的有一段时间不能整理了...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:53:28.190

这真的是一个[java](/questions/tagged/java "显示标记为“java”的问题")问题！

但解决方案是添加 final 关键字....

```
final Text text = new Text(parent, SWT.NONE);
Listener listener = new Listener() {
   public void handleEvent(Event event) {
      if (event.button == SWT.BUTTON3) {
         viewer.setSelection(text.getText());
      }
   }
};
text.addListener(SWT.KeyDown, listener); 
```

# c# - 来自视图模型的条件绑定？

> ID：10999941
> 
> 赞同：0
> 
> 时间：2012-06-12T15:33:41.453
> 
> 标签：c#, wpf

我有几个带有两个列的列表视图。
我正在为另一个应用程序构建一个统计应用程序。
每行应该有两列。（名称，总和）或（名称，计数）
问题是模型有三个（名称，总和，计数）。我想要一个通用开关来确定应该在所有 6 个列表视图中显示哪一列。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:08:20.327

为您的列表视图实现不同的[ItemTemplate](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate.aspx)并根据您的目的切换它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:42:26.300

您可以使用 ListView 的样式，并且只添加您想要的列，具体取决于显示您所追求的视图的属性。

CountSumSwitch 是我在 MainWindow 中的一个布尔依赖属性，您将其切换为 true 以显示所有列表视图中的计数，而将其切换为 false 以显示所有列表视图中的总和。

```
 <Style TargetType="{x:Type ListView}">
        <Style.Triggers>
            <!-- This binding needs to point to some global propery that you'll change to switch views.-->
            <DataTrigger Binding="{Binding CountSumSwitch}" Value="True">
                <Setter Property="View">
                    <Setter.Value>
                        <GridView>
                            <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}" />
                            <GridViewColumn Width="140" Header="Count" DisplayMemberBinding="{Binding Count}" />
                        </GridView>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding CountSumSwitch}" Value="False">
                <Setter Property="View">
                    <Setter.Value>
                        <GridView>
                            <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}" />
                            <GridViewColumn Width="140" Header="Sum" DisplayMemberBinding="{Binding Sum}" />
                        </GridView>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style> 
```

编辑：

为了展示这一点，我将添加一个示例，它显示了一个绑定到集合的列表视图，其中带有一个复选框来切换所使用的列。创建一个新的 WPF 应用程序，用这个替换 MainWindow 类

```
public partial class MainWindow : Window
    {

        public bool CountSumSwitch
        {
            get { return (bool)GetValue(CountSumSwitchProperty); }
            set { SetValue(CountSumSwitchProperty, value); }
        }

        public static readonly DependencyProperty CountSumSwitchProperty = DependencyProperty.Register("CountSumSwitch", typeof(bool), typeof(MainWindow), new UIPropertyMetadata(false));

        public List<TheItem> ITems
        {
            get { return (List<TheItem>)GetValue(ITemsProperty); }
            set { SetValue(ITemsProperty, value); }
        }

        public static readonly DependencyProperty ITemsProperty = DependencyProperty.Register("ITems", typeof(List<TheItem>), typeof(MainWindow), new UIPropertyMetadata(null));

        public MainWindow()
        {
            InitializeComponent();

            Random rnd = new Random();

            ITems = new List<TheItem>(new TheItem[]
            {
                new TheItem () { Name = "Item 1", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 2", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 3", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 4", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 5", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 6", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 7", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 8", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
                new TheItem () { Name = "Item 9", Count = rnd.Next(100), Sum = rnd.Next (100)}, 
            });

            CountSumSwitch = false;
        }

        public class TheItem
        {
            public string Name { get; set; }
            public int Count { get; set; }
            public int Sum { get; set; }
        }
    } 
```

并将这段代码放在 MainWindow.xaml

```
<Window x:Class="WpfApplication6.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <Style TargetType="{x:Type ListView}">
            <Style.Triggers>
                <!-- This binding needs to point to some global propery that you'll change to switch views.-->
                <DataTrigger Binding="{Binding CountSumSwitch}" Value="True">
                    <Setter Property="View">
                        <Setter.Value>
                            <GridView>
                                <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}" />
                                <GridViewColumn Width="140" Header="Count" DisplayMemberBinding="{Binding Count}" />
                            </GridView>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                <DataTrigger Binding="{Binding CountSumSwitch}" Value="False">
                    <Setter Property="View">
                        <Setter.Value>
                            <GridView>
                                <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}" />
                                <GridViewColumn Width="140" Header="Sum" DisplayMemberBinding="{Binding Sum}" />
                            </GridView>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <CheckBox IsChecked="{Binding CountSumSwitch}"/>
        <ListView ItemsSource="{Binding ITems}" Margin="0,83,0,0"/>
    </Grid>
</Window> 
```

# wpf - 如何将 StereoLithography (.stl) 文件加载到 WPF？

> ID：10999942
> 
> 赞同：2
> 
> 时间：2012-06-12T15:33:43.600
> 
> 标签：wpf, 3d

加载模型后，我希望能够旋转它并在它周围放置点。

如果有一种解决方法，比如将其转换为 3D MAX 然后加载它也会很好，尽管我很高兴不这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:14:55.290

很简单，这是文件格式规范。小心 ASCII 和二进制类型。

[http://en.wikipedia.org/wiki/STL_(file_format](http://en.wikipedia.org/wiki/STL_(file_format) )

关于旋转，寻找一个轨迹球实现，像这样：

[http://www.cse.ohio-state.edu/~crawfis/Graphics/VirtualTrackball.html](http://www.cse.ohio-state.edu/~crawfis/Graphics/VirtualTrackball.html)

# linux - 如何在包 debuild 中包含目录

> ID：10999948
> 
> 赞同：6
> 
> 时间：2012-06-12T15:34:02.603
> 
> 标签：linux, unix, ubuntu, debian, packaging

将按以下步骤创建一个简单的 Debian 软件包，以下步骤将是初学者的教程

考虑我有一个文件让我们说 test.sh 它只会在屏幕上打印测试

```
#!/bin/sh
set -e
echo "this is sample debian package created " >&2 
```

安装debian包后应该是什么输出？A）在使用“dpkg -i test-1.0.deb”安装软件包后，我想将上面我命名为 test.sh 的文件放在 /home/bla/Desktop/ 中

为了实现上述过程，请按照以下步骤操作

```
mkdir test-1.0
cd test-1.0
#in order to place test.sh in /home/bla/Desktop, simply create the same directory structure in the test folder using this command

mkdir -p home/bla/Desktop/
cp test.sh home/bla/Desktop/
cd ..
cd ..
cd ..
mkdir DEBIAN
cd DEBIAN 
```

添加具有以下内容的控制文件

```
Package: test
Version: 1.0
Section: devel 
Priority: optional
Architecture: all
Essential: no
Depends:  bash
Pre-Depends: no
Recommends: no
Maintainer: test <test@test.test>
Replaces: no
Provides: no
Description: A sample testpackage in order to demonstrate how to create debian packages 
```

软件包已准备好从测试文件夹中取出并输入 dpkg --build test-1.0/

您的软件包已准备就绪，您可以使用 dpkg -i test-1.0.deb 安装它

如果我想对 dh_make 和 debuild 执行相同的过程，我无法在安装后添加我希望放置 test.sh 的目录结构

我遵循的步骤：

1.  `mkdir test-1.0`
2.  复制上面的目录结构

    ```
    cd test-1.0/ && mkdir -p home/bla/Desktop/
    cp test.sh home/bla/Desktop/ 
    ```

3.  `dh_make -n -s -e test@test.com`

4.  `cd debian`
5.  `rm *.ex *.EX`
6.  `cd ..`
7.  `debuild -us -uc`

不管我的 test.sh 之后根本没有包含在包中，我不知道这是我从 debian 手册中了解到的原因

有人知道怎么做吗，请尽快告诉我..，我只想知道如何在使用 debuild/dpkg-buildpackage 构建 debian 包时将文件包含在包中，就像我在第一个过程中所做的那样简单的

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T17:56:17.033

***使用dh* *** ***和 dpkg-buildpackage 的***AQ/D 示例：

*1）*准备工作目录和测试文件（我们将打包应该安装到*“/any/dir”的**“foo”*脚本）：

 *```
mkdir test-0.0.1
cd test-0.0.1
echo -e "#\!/bin/sh\necho \"hi, i'm foo\"" > foo
chmod +x foo 
```

*2）*创建简单的*Makefile*来处理安装：

```
binary:
    # we are not going to build anything

install:
    mkdir -p $(DESTDIR)/any/dir
    cp foo $(DESTDIR)/any/dir 
```

*3）*生成包骨架：

```
dh_make -i --createorig 
```

*3a)*可选择调整 debian 控制文件

*4）*构建包：

```
dpkg-buildpackage -A -uc 
```

*5）*测试生成的包内容：

```
dpkg-deb -c ../test_0.0.1-1_all.deb | grep any

drwxr-xr-x root/root         0 2012-06-12 20:54 ./any/
drwxr-xr-x root/root         0 2012-06-12 20:54 ./any/dir/
-rwxr-xr-x root/root        30 2012-06-12 20:54 ./any/dir/foo 
```

* * *

***编辑：****不使用Makefile*的示例（如果您不打算*构建*任何东西）：

*1）*创建测试数据：

```
mkdir test-0.0.1
cd test-0.0.1
mkdir contents
touch contents/a
touch contents/b 
```

*2）*创建包骨架：

```
dh_make -i --createorig 
```

*3)*创建***debian/test.install***文件，内容如下：

```
contents/   /usr/share/mycontents 
```

*4）*构建包：

```
dpkg-buildpackage -A -uc 
```

*5）*检查内置包：

```
dpkg-deb -c ../test_0.0.1-1_all.deb | grep contents

drwxr-xr-x root/root         0 2012-06-13 11:44 ./usr/share/mycontents/
drwxr-xr-x root/root         0 2012-06-13 11:38 ./usr/share/mycontents/contents/
-rw-r--r-- root/root         0 2012-06-13 11:37 ./usr/share/mycontents/contents/a
-rw-r--r-- root/root         0 2012-06-13 11:38 ./usr/share/mycontents/contents/b 
```*

# audio - 需要 AVI、WMV、WMA、MP3、MP4、WAV 等视频和音频格式的文档

> ID：10999950
> 
> 赞同：2
> 
> 时间：2012-06-12T15:34:08.513
> 
> 标签：audio, video, encoding, wmv

我需要制作一个视频和音频编码器来将原始视频和音频样本转换为 AVI、WMV 格式。我正在搜索互联网但没有成功。

我正在寻找至少 AVI 和 WMV、WAV、WMA 格式的文档。我需要这个来制作或尝试制作一个编码器，以便在浏览器中使用 Silverlight 从网络摄像头保存原材料。

提前致谢。

# django - Django 翻译和 gettext：%（字符串插值）运算符的弃用

> ID：10999954
> 
> 赞同：10
> 
> 时间：2012-06-12T15:34:19.580
> 
> 标签：django, string, internationalization, deprecated, string-interpolation

尽管 Django Django 还不支持 Python 3，但它最终会支持，所以我想让我的代码尽可能地“面向未来”。

从 Python 2.7 开始，字符串插值运算符 ( `%`) 已被弃用。我意识到每个需要翻译的字符串都在使用`%`插值语法。在 Django 文档中没有提到新`str.format`方法（字符串格式化的“新”官方方式）......

也许库有限制`gettext`，但我不这么认为，因为字符串在 .PO 文件中看起来相同。

问题是我是否可以使用新的字符串`format`方法进行翻译。

老办法：

```
class Post(models.Model):
    title = models.CharField(max_length=50)
    date = models.DateField()
    # ...
    def __unicode__(self):
        return _('%(title)s (%(date)s)') % {
            'title': self.title,
            'date': self.date,
        } 
```

“新”方式：

```
class Post(models.Model):
    title = models.CharField(max_length=50)
    date = models.DateField()
    # ...
    def __unicode__(self):
        return _('{title} ({date})').format(
            title=self.title,
            date=self.date,
        ) 
```

此外，`ugettext_lazy`并不真正返回字符串，而是`Promises`仅在需要时才评估的对象。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-12T16:53:34.737

你可以安全地使用它。例如

```
ugettext_lazy('{foo}').format(foo='bar') 
```

Django 使用的翻译程序`xgettext`不关心要翻译的内容。它只是在`.py`文件中搜索关键字，例如`ugettext_lazy`或`_`收集可翻译的字符串（参考[xgettext](http://www.gnu.org/software/gettext/manual/html_node/xgettext-Invocation.html)和[Django 代码](https://github.com/django/django/blob/master/django/core/management/commands/makemessages.py#L191)的手册）

此外，上述`.format()`方法是代理对象提供的包装器，如：

```
>>> ugettext_lazy(u'{foo}').format
<bound method __proxy__.__wrapper__ of <django.utils.functional.__proxy__ object at 0x102f19050>> 
```

上面的调用`.format()`将`u'{foo}'`被翻译成一些 unicode `value`，然后`value.format`用实际参数调用。你可以看到翻译`value.format`发生在不同的阶段。

# c++ - OpenMP 是否复制私有对象？

> ID：10999955
> 
> 赞同：5
> 
> 时间：2012-06-12T15:34:21.050
> 
> 标签：c++, parallel-processing, openmp, fstream, noncopyable

我正在编写一个读取大文件（3x280 GB）并对文件中的数据进行拟合的程序。并行化这样的程序非常方便，这可以通过 OpenMP 轻松完成。

我不明白的是如何在 OpenMP 中获取私有变量。众所周知，fstream 的对象是不可复制的，直观地说，这使我无法将其用作私有对象。所以文件的阅读器是共享的。

后来我遇到了一些问题，我想尝试将 fstreams 设为私有，......你猜怎么着？有效！！！这怎么可能？！如果对象是不可复制的，OpenMP 如何为每个内核使用同一对象的不同副本？

这就是我的程序的样子：

```
fstream dataReaderX(Dirs[0].c_str(), ios::in | ios::binary);
fstream dataReaderY(Dirs[1].c_str(), ios::in | ios::binary);
fstream dataReaderZ(Dirs[2].c_str(), ios::in | ios::binary);
#pragma omp parallel num_threads(cpus_num) shared(...) private(...,dataReaderX,dataReaderY,dataReaderZ)
{
...
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T18:25:34.933

`firstprivate`变量被复制，而不是`private`- 对于后者，调用默认构造函数：

**第 2.9.3.3 节 -`private`条款：**

> 新列表项已初始化，或者具有未定义的初始值，就好像它是在没有初始化程序的情况下在本地声明的一样。未指定调用用于类类型的不同私有变量的任何默认构造函数的顺序。未指定调用用于类类型的不同私有变量的任何 C/C++ 析构函数的顺序。

下面是一个简单的演示代码：

```
#include <fstream>
#include <stdio.h>
#include <omp.h>

int main (void)
{
   std::fstream reader("test.txt", std::ios::in);
   printf("Main thread: reader.is_open() = %d\n", reader.is_open());
   #pragma omp parallel private(reader)
   {
      printf("Thread %d: reader.is_open() = %d\n",
             omp_get_thread_num(), reader.is_open());
   }
   return 0;
} 
```

这是预期的输出：

```
Main thread: reader.is_open() = 1
Thread 1: reader.is_open() = 0
Thread 0: reader.is_open() = 0
Thread 3: reader.is_open() = 0
Thread 2: reader.is_open() = 0 
```

一件有趣的事情是英特尔 C++ 编译器因内部错误（断言失败）而出错 - 使用版本 11.1、12.0 和 12.1 进行了测试。另一方面，GNU C++ 编译器遵循标准（上面的输出来自`g++`）。`firstprivate`尽管英特尔 C++ 编译器再次因内部错误而出错，但两个编译器都在使用时抱怨。

这听起来可能很愚蠢，但您是否检查过您在使用的特定编译器中是否启用了 OpenMP 支持？

# android - Android：如何找到我的位置

> ID：10999956
> 
> 赞同：0
> 
> 时间：2012-06-12T15:34:20.993
> 
> 标签：android, gps

我已经阅读了很多关于 stackoverflow 的帖子，但我没有找到我需要的答案。使用 gps 或使用网络提供商查找我的位置非常简单，但是有一个问题。我的应用程序首先检查 gps 是否处于活动状态，如果没有，我将用户发送到 gps 选项页面。之后，用户可以返回第一个活动。我在此活动和第二个活动中使用当前位置。我只将监听器放在第一个活动中，并在函数“onLocationUpdate()”中将我的纬度和经度保存在我的全局应用程序变量中。如果我启动应用程序，然后我设置启用 gps，然后我打开我的第二个活动，纬度和经度等于 0.0，但如果我启动活动，然后我设置启用 gps，然后我等待 30 秒，它工作。是否存在一种消除这种延迟的方法？使用 Network_Provider 更快，但它不像 gps 那样精确！

代码片段是：

```
locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    boolean gpsStatus = locationManager
            .isProviderEnabled(LocationManager.GPS_PROVIDER);
    if (!gpsStatus) {

        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                this);

        alertDialogBuilder.setTitle("The GPS is off!");

        alertDialogBuilder
                .setMessage("Turn on the GPS?")
                .setCancelable(false)
                .setPositiveButton("Yes",
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                Intent intent1 = new Intent();
                                intent1.setClassName(
                                        "com.android.settings",
                                        "com.android.settings.SecuritySettings");
                                startActivity(intent1);
                                dialog.cancel();
                            }
                        })
                .setNegativeButton("No",
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                dialog.cancel();
                            }
                        });

        // create alert dialog
        AlertDialog alertDialog = alertDialogBuilder.create();

        // show it
        alertDialog.show();

    }
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000L, 500.0f, locationListener); 
```

这部分用于检查 gps 是否启用。是否存在无需进入设置页面即可启用 GPS 的方法？

```
 LocationListener locationListener = new LocationListener() {

    @Override
    public void onLocationChanged(Location location) { // update
        if (location != null) {

            msg_r.setLatitude(location.getLatitude());
            msg_r.setLongitude(location.getLongitude());
        }
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
}; 
```

这是我的听众。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:40:54.060

您应该阅读 Reto Meier 关于构建基于位置的应用程序的文章：

1.  [如何构建不糟糕的基于位置的应用程序](http://blog.radioactiveyak.com/2011/06/how-to-build-location-based-apps-that.html)
2.  [深入了解位置](http://android-developers.blogspot.de/2011/06/deep-dive-into-location.html)
3.  [深入了解位置第 2 部分](http://blog.radioactiveyak.com/2011/06/deep-dive-into-location-part-2-being.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:40:51.627

GPS 需要时间来获取您当前的位置。没有办法解决它。`getLastKnownLocation()`如果您希望它更快，或者像您说的那样您可以使用网络提供商，您可以使用该方法。然而，最后一个已知位置可能根本不准确。

GPS 直到第一次调用时才准备好`onLocationUpdate()`。因此，您可以让用户停留在第一个活动上，直到此事件发生，然后允许用户转到第二个活动。或者让第二个活动获取位置更新。你可以做不同的事情。

至于在不进入设置页面的情况下启用 GPS，你不能。我找不到问题，但 CommonsWare 几个小时前刚刚回答了这个问题，指出这不可能发生，因为这是一个隐私问题。

# ios - 加载图像还是使用 CGGradient 更有效？

> ID：10999961
> 
> 赞同：4
> 
> 时间：2012-06-12T15:34:48.923
> 
> 标签：ios, performance, user-interface, gradient

我正在我的一个应用程序中尝试一些新 UI 的东西。我想知道，添加渐变背景等 UI 元素的最有效方法是什么（请记住应用程序的大小以及速度/内存消耗）。

在 Inkscape 或 Illustrator 中创建元素，然后通过 UIImage>UIIMageView 加载它们会更好吗？还是最好使用[CGGradient](https://stackoverflow.com/a/422208/329900)或[CAGradientLayer](https://stackoverflow.com/a/1931498/329900)？

另外，我经常想知道这些事情，我想知道是否有人可以解释我如何为自己测试这些事情（速度、内存消耗、整体性能）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:17:45.533

CAGradientLayers 非常好。我几乎总是喜欢使用 CGGradient 或使用 CAGradientLayer 绘制渐变而不是使用图像，特别是因为你不需要包括视网膜/非视网膜、iPhone/iPad 组合，并且更改颜色成为调整一行代码而不是在您的成像软件中重新生成一系列图像的问题。

如果您也在 drawRect 中进行其他绘图，请使用 CGGradient 进行绘制。如果您只想要背景，请使用 CAGradientLayer。

您可以使用 Instruments 分析性能（产品 --> XCode 中的配置文件）

*   如果有滚动/动画，核心动画工具将为您提供每秒帧数
*   时间分析器工具将向您显示哪些功能正在占用您的时间
*   各种内存工具将向您显示内存消耗

# ruby-on-rails - Cucumber：如何检查列中的特定文本？

> ID：10999969
> 
> 赞同：4
> 
> 时间：2012-06-12T15:35:45.760
> 
> 标签：ruby-on-rails, ruby, cucumber

我正在尝试使用 cucumber 在我的应用程序中检查 Ruby on Rails 视图的内容。该视图在表格中显示信息。我希望能够仅检查该表的一列的内容。当我使用 web 步骤定义`"I should see"`时，它会检查整个页面。有什么简单的方法可以做到这一点吗？

例如：`column.should have_content("text")`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T17:22:06.747

Capybara 的内置作用域可能比那些 xpath 更容易维护

```
within "#id_for_your_tr"
  within('td', :class=> 'class_for_your_column')
    page.should have_content "foo"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:48:04.197

使用水豚+黄瓜，说你的步骤是

```
Then I should see the following (#MYTABLE)
    |  FOO     | 94040     | "friendly"  |
    |  BAR     | 94050     | "competition"| 
```

步骤定义

```
Then /^I should see the following games:$/ do |expected_table|
  table_results = page.find('#DOM_ID')
end 
```

我为你定义的复杂方法

```
When /^(.*) in the "([^\"]*)" column of the "([^\"]*)" row$/ do |
action, column_title, row_title|
  col_number = 0
  all(:xpath, "//*[(th|td)/descendant-or-self::*[contains(text(),
'#{column_title}')]]/th").each do |element|
    col_number += 1
    break if element.has_content?(column_title)
  end
  within :xpath, "//*[(th|td)/descendant-or-self::*[contains(text(),
'#{row_title}')]]/td[#{col_number}]" do
    When action
  end
end 
```

要检查正在生成的表结构，您可以使用检查行数是 X page.should have_selector('table tr', :count => X)

# sql - 如何通过 ADODB 检索自动编号字段

> ID：10999973
> 
> 赞同：1
> 
> 时间：2012-06-12T15:35:55.787
> 
> 标签：sql, ms-access, adodb

上下文：MS Access 和 JScript

我有一个表，我在其中插入一个字段的数据，以便自动编号将触发并给我该记录的唯一 ID，即

```
oConn.Execute( "INSERT INTO tbl (DateTimeStamp) VALUES (" + newNow + ");"); 
```

在这种情况下，newNow 是一个 Double 值，它会自动强制转换为 Date。

完成后，我想检索应该在插入点填写的自动编号 ID 字段。到目前为止，我一直在为这些东西使用 ADODB.Recordset，但一直在试验 ADODB.Connection 的 Execute()，希望它可能更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:51:44.817

作为`oConn`ADODB.Connection，在 VBA 中，以下内容可以方便地检索从该连接插入的最后一个自动编号值。看看这是否转换为 JScript。

```
oConn.Execute("SELECT @@Identity")(0) 
```

您可以要求数据库引擎显式执行此操作，而不是自动将双精度值转换为日期/时间。

```
"INSERT INTO tbl (DateTimeStamp) VALUES (CDate(" + newNow + "));" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:39:58.827

您可以将 @@Identity 与 MS Access 一起用于您的连接。

```
SELECT @@identity 
```

# blackberry - 黑莓粗体上的应用程序不水平滚动

> ID：10999975
> 
> 赞同：0
> 
> 时间：2012-06-12T15:36:03.847
> 
> 标签：blackberry

我正在使用 Blackberry 5.0 API 开发应用程序。我有 Horizo​​ntalFieldManager，我要向其中添加 2 个标签和一个 Buttonfield。我已经设置`HORIZONTAL_SCROLL`了屏幕和管理器。

在模拟器上，我在某种程度上成功地水平滚动。我单击标签并左右拖动。然后它滚动。我在屏幕中看不到 Horizo​​ntalScrollBar。

当我在设备（Blackberry Bold 9000）上运行应用程序时，它不会水平滚动。我不知道如何将它拖到左边或类似的东西，因为没有可见的滚动条。

任何人都可以建议使用 5.0 API 和 Blackberry Bold 9000 是否可以进行水平滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:10:55.787

要添加滚动条，您必须在构造函数中包含一个标志：

```
HorizontalFieldManager hfm = new HorizontalFieldManager(Manager.HORIZONTAL_SCROLL | Manager.HORIZONTAL_SCROLLBAR); 
```

您还可以包括`Manager.USE_ALL_WIDTH`让它使用所有可用空间。

关于粗体，请确保管理器中至少有一些字段是可聚焦的。

# python - argparse：预期一个参数

> ID：10999976
> 
> 赞同：9
> 
> 时间：2012-06-12T15:36:03.977
> 
> 标签：python, argparse

我按以下方式设置了 argparse 参数：

```
parser = argparse.ArgumentParser(description='foobar')
parser.add_argument('url', metavar='URL')
parser.add_argument('-k', dest='kindle_type', default='kindle3')
parser.add_argument('-n', dest='gallery_name', default='Gallery')
parser.add_argument('-d', dest='dropbox_dir')
args = parser.parse_args()

print parser.parse_args(['imgur_url', '-k']) 
```

但是，当我运行时`script.py -k kindledx http://url.com`，我收到以下错误：`gallery2kindle.py: error: argument -k: expected one argument`

当我在标志“-k”之后使用“kindledx”时，不是调用了参数吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T15:45:28.077

> 当我在标志“-k”之后使用“kindledx”时，不是调用了参数吗？

是的，如果你添加一个`print args`after `args = parser.parse_args()`，你可以看到解析工作：

```
~/coding$ python ap.py -k kindledx http://url.com
Namespace(dropbox_dir=None, gallery_name='Gallery', kindle_type='kindledx', url='http://url.com') 
```

但在这一行

```
print parser.parse_args(['imgur_url', '-k']) 
```

您*没有*将参数传递给 k。比较

```
print parser.parse_args(['imgur_url', '-k', 'kindledx']) 
```

产生

```
Namespace(dropbox_dir=None, gallery_name='Gallery', kindle_type='kindledx', url='imgur_url') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-21T08:24:57.830

由于这是谷歌搜索此错误的第一个结果，我想分享如果您遵循与`/`Linux 中的 Windows 兼容的建议，它可能会发生：

```
arg_parser = argparse.ArgumentParser(
    prefix_chars='-+/', description='desc') 
```

即使看起来有效，这也会导致`-option /path/path`抛出。`expected one argument`您需要在上面引用它`-option '/path/path'`或删除它来修复它。`/``prefix_chars`

# iphone - 流式音频 iPhone/iPad 应用程序 xcode

> ID：10999977
> 
> 赞同：0
> 
> 时间：2012-06-12T15:36:05.367
> 
> 标签：iphone, ipad, xcode4

有没有办法在后台制作音频流而不是使用整个页面？

这是我目前拥有的：

```
NSURL *url = [NSURL URLWithString:@"http://s6.voscast.com:8550/listen.pls"];
    NSURLRequest *req = [NSURLRequest requestWithURL:url];
    [player loadRequest:req]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:56:42.480

我刚决定使用PhoneGap

# python - urllib2.HTTPError：HTTP 错误 405：此 URL 不支持 HTTP 方法 POST

> ID：10999982
> 
> 赞同：0
> 
> 时间：2012-06-12T15:36:31.263
> 
> 标签：python, urllib2, recaptcha

我正在编写一个脚本，它需要使用指定的公钥获得 reCAPTCHA 质询，所以如果我用以下命令打开它`urllib2`：

```
chp = urllib.urlencode(dict({'k': key}))
chg = urllib2.urlopen('http://www.google.com/recaptcha/api/challenge', chp).read() 
```

然后我可以从那里得到挑战并返回它，但是当它这样做时，我得到了错误：

`urllib2.HTTPError: HTTP Error 405: HTTP method POST is not supported by this URL`

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:38:57.533

改用 GET 请求：

```
chp = urllib.urlencode(dict({'k': key}))
chg = urllib2.urlopen('http://www.google.com/recaptcha/api/challenge?' + chp).read() 
```

正如[`urllib2`文档](http://docs.python.org/library/urllib2.html)所述：

> data 可以是一个字符串，指定要发送到服务器的附加数据，或者如果不需要此类数据，则为 None。目前 HTTP 请求是唯一使用数据的请求；当提供数据参数时，HTTP 请求将是 POST 而不是 GET。

您通过将其作为第二个位置参数`chp`传递给方法来作为 POST 数据传入。`urlopen`使用 a 将其连接到 URL`?`会使其成为 GET 请求。

# c++ - 为什么 C++ 仍然有一个 delete[] AND 一个删除运算符？

> ID：10999985
> 
> 赞同：5
> 
> 时间：2012-06-12T15:36:51.310
> 
> 标签：c++, arrays, memory-management, syntax

使用单个关键字很难实现删除数组吗？效率低吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-12T15:43:30.073

首先，让我总结一下两者的作用：为*一个*`delete`对象调用析构函数并释放内存；*调用一些*对象的析构函数并释放内存。*`delete[]`*

 **可以将它们折叠成相同的操作：“调用*一些*对象的析构函数并释放内存。”。毕竟*一个*是*一些*数字。

两者都对指针进行操作`delete`。`delete[]`像这个：

```
foo* ptr; 
```

仔细看看。并告诉我我们应该调用多少个析构函数`delete`。你不能。编译器也不能。这只能在运行时知道。有关对象数量的信息必须存储在*某个地方*。这意味着，对于 的每次使用`new[]`，都会分配一些额外的内存来跟踪该数字。

C++ 是建立在“你不为你不使用的东西付费”的原则之上的，这就是非数组形式存在的原因：因为`delete`总是只删除一个对象，`new`不需要分配任何额外的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-12T15:42:10.517

问题不在于复杂性，而在于参数`delete`是单个指针，并且无论分配单个元素还是数组，该类型都完全相同。下面的实现是完全不同的，因为被破坏的元素数量不同。

这实际上是与 C 向后兼容的问题......如果从一开始就没有要求，我们可能不会有 C++（它不会赶上这么多），但类型`new T[N]`可能与类型不同of`new T`和类型系统可用于检测`delete`需要调用的类型。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-12T15:45:21.267

这是因为 C++ 设计的最重要原则之一是不用为不用的东西付费。 `new[]`/`delete[]`有额外的成本，并且人们认为它们的实用性（我在 25 年的 C++ 中从未使用过。）非常有限，因此没有理由将此成本添加到非数组`new`/`delete`中。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-06-12T15:40:33.687

如果易于实现，就不能从语言事件中删除此类功能。在这样的更改之后，你愿意来修复我所有的代码吗？**

# gdb - 如何用 GDB 反汇编 win16

> ID：10999988
> 
> 赞同：0
> 
> 时间：2012-06-12T15:37:07.253
> 
> 标签：gdb, disassembly

我需要调试弹跳球病毒（注意它是用**win16** asm编写的）来完成我的论文。尝试使用 GDB 但它说：

> 不是可执行格式。文件格式无法识别。

我的问题是：是否可以使用 GDB 来完成它？

如果是，我该怎么办？如果不是，除了 Win 的 debug.exe，我还能使用什么调试器？

# lotus-domino - 使用 lotusscript 从 vpuserinfo.nsf 导出 Sametime 好友列表

> ID：10999989
> 
> 赞同：0
> 
> 时间：2012-06-12T15:37:09.437
> 
> 标签：lotus-domino, lotusscript, lotus, sametime

我知道我们可以使用以下方法访问 vpuserinfo.nsf 的自定义数据：`byteArray = notesDocument.GetItemValueCustomDataBytes( itemName$ , dataTypeNam$)`

但我不知道“8193”的数据类型名称。有人可以告诉我字段“8193”是什么数据类型名称吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T17:58:31.320

数据类型名称是“ubqOpaque”

示例：doc.GetItemValueCustomDataBytes("8193", "ubqOpaque")

请注意，编写 datstream 不仅仅涉及更改值。字节数组等的开头有几个字节，表示该字段的大小和事物的大小。所以不是很直接，也没有记录。

# python - 无论 Content-Type 标头如何，在 Python Flask 中获取原始 POST 正文

> ID：10999990
> 
> 赞同：153
> 
> 时间：2012-06-12T15:37:10.627
> 
> 标签：python, flask, werkzeug

以前，我问[过如何获取 Flask 请求中收到的数据，](https://stackoverflow.com/q/10434599)因为`request.data`它是空的。答案解释`request.data`为原始帖子正文，但如果解析表单数据，则将为空。如何无条件获得原始帖子正文？

```
@app.route('/', methods=['POST'])
def parse_request():
    data = request.data  # empty in some cases
    # always need raw data here, not parsed form data 
```

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2014-05-27T21:06:57.973

用于[`request.get_data()`](http://werkzeug.pocoo.org/docs/wrappers/#werkzeug.wrappers.BaseRequest.get_data)获取原始数据，无论内容类型如何。数据被缓存，您随后可以随意访问`request.data`, `request.json`, `request.form`。

如果你`request.data`先访问，它会先调用`get_data`一个参数来解析表单数据。如果请求具有表单内容类型（`multipart/form-data`、、`application/x-www-form-urlencoded`或`application/x-url-encoded`），则将使用原始数据。`request.data`在这种情况下`request.json`将显示为空。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-06-12T16:25:25.097

[`request.stream`](https://werkzeug.palletsprojects.com/wrappers/#werkzeug.wrappers.BaseRequest.stream)是由 WSGI 服务器传递给应用程序的原始数据流。阅读时不进行解析，尽管您通常需要`request.get_data()`。

```
data = request.stream.read() 
```

如果之前由`request.data`其他属性读取，则该流将为空。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-22T20:29:43.267

我创建了一个 WSGI 中间件，用于存储流中的原始主体`environ['wsgi.input']`。我将值保存在 WSGI 环境中，因此我可以从`request.environ['body_copy']`我的应用程序中访问它。

这在 Werkzeug 或 Flask 中不是必需的，因为`request.get_data()`无论内容类型如何都会获取原始数据，但可以更好地处理 HTTP 和 WSGI 行为。

这会将整个正文读入内存，例如，如果发布了一个大文件，这将是一个问题。如果缺少标头，这将不会读取任何内容`Content-Length`，因此它不会处理流请求。

```
from io import BytesIO

class WSGICopyBody(object):
    def __init__(self, application):
        self.application = application

    def __call__(self, environ, start_response):
        length = int(environ.get('CONTENT_LENGTH') or 0)
        body = environ['wsgi.input'].read(length)
        environ['body_copy'] = body
        # replace the stream since it was exhausted by read()
        environ['wsgi.input'] = BytesIO(body)
        return self.application(environ, start_response)

app.wsgi_app = WSGICopyBody(app.wsgi_app) 
```

```
request.environ['body_copy'] 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-10-28T21:20:00.283

`request.data`如果`request.headers["Content-Type"]`被识别为表单数据，则为空，将被解析为`request.form`. 要获取原始数据而不考虑内容类型，请使用`request.get_data()`.

`request.data`调用`request.get_data(parse_form_data=True)`，这导致表单数据的不同行为。

# java - 使用 c3p0 池连接数据库 mysql

> ID：10999996
> 
> 赞同：0
> 
> 时间：2012-06-12T15:37:40.783
> 
> 标签：java, mysql, jndi, connection-pooling, c3p0

```
ComboPooledDataSource cpds = new ComboPooledDataSource(); 
cpds.setDriverClass( "com.mysql.jdbc.Driver" ); //loads the jdbc driver 

cpds.setJdbcUrl( "jdbc:mysql://localhost:3306/dragon" ); 
cpds.setUser("root"); 
cpds.setPassword("password");
cpds.setMaxPoolSize(50); 
```

我创建了一个包含以下代码的 java 文件来配置 ComboPooledDataSource 对象。现在这段代码是否足以建立与数据库的池连接？

如果没有，我还应该做什么？

另外请告诉我如何在这里实现 JNDI。

请解释一下，因为我是初学者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T15:01:00.100

首先...创建代码以在包含静态方法或变量的类中启动连接，如下所示..

```
 private static ComboPooledDataSource cpds = new ComboPooledDataSource();
        public static void MakePool()
        {
               try 
               {
                 cpds=new ComboPooledDataSource();
                 cpds.setDriverClass("com.mysql.jdbc.Driver");
                 cpds.setJdbcUrl("jdbc:mysql://localhost:3306/att_db");
                 cpds.setUser("root");
                 cpds.setPassword("dragon");
                 cpds.setMaxPoolSize(MaxPoolSize);
                 cpds.setMinPoolSize(MinPoolSize);
                 cpds.setAcquireIncrement(Accomodation);
             } 
             catch (PropertyVetoException ex) 
             {
                 //handle exception...not important.....
              }

}
public static Connection getConnection()
{
           return cpds.getConnection();
} 
```

一旦你完成创建另一个用于服务器操作的类......

并从池中获取连接...

```
 try{

               con=DatabasePool.getConnection();
               // DatabasePool is the name of the Class made earlier....
               .
               .
               .
               .  // Server operations as u wanted.....
               .
               .
             }
             catch(SQL EXCEPTION HERE)
             {
                  .....
             }
             finally
             {     
               if(con!=null)
               {
                      con.close();      
               }
             } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:54:46.067

我不熟悉 JNDI，所以我不会解决这个问题（您可能需要一个单独的问题来详细说明您的目标），但我相信您确实正确配置了 ComboPooledDataSource。

您应该能够使用这样的代码测试您的数据源（为简单起见，排除了异常处理）：

```
ArrayList<Object[]> data = new ArrayList<Object[]>();

Connection connection = cpds.getConnection();
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery("select a_column from a_table;");

int columnCount = resultSet.getMetaData().getColumnCount();

while (resultSet.next()) {
    Object[] rowData = new Object[columnCount];

    for (int i = 0; i < columnCount; i++) {
        rowData[i] = resultSet.getObject(i + 1);
    }

    data.add(rowData);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:52:12.647

您使用 c3p0 管理 jdbc 连接，不应使用 jdni。如果你想使用 jndi ，你需要在 web 容器中配置连接。像Tomcat

```
<Context>   
    <Resource name="jdbc/springflow" auth="Container" 
        type="javax.sql.DataSource"
        maxActive="100" maxIdle="30" maxWait="10000" username="root"
        password="" driverClassName="com.mysql.jdbc.Driver"     
        url="jdbc:mysql://localhost:3306/test" />
</Context> 
```

你可以使用 jndi 之类的`context.lookup("java:jdbc/springflow")`。

# symfony - 在 Symfony 2 中处理超过 maxFilesize 的文件

> ID：10999999
> 
> 赞同：1
> 
> 时间：2012-06-12T15:37:45.867
> 
> 标签：symfony

我正在 Symfony 2 中的博客/画廊上工作，并且几乎逐字逐句地遵循 Symfony 2 书中的 Doctrine File Uploads 部分。文件上传通常可以正常工作，但是如果文件超过一定大小（我认为无论 UploadedFile::getMaxFilesize() 是什么），那么在创建 new UploadedFile() 时会引发 FileNotFound 异常，因为请求包含对该文件不包含文件本身。

我假设这需要在表单验证期间进行处理，但我无法在网上找到很多关于如何处理的信息。任何指向最佳行动方案的指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T17:21:43.647

注意将 php.ini 中的 upload_max_filesize 参数设置为比您的值更高的值

```
/**
 * @Assert\File(maxSize="6000000")
 */ 
```

注解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:52:10.103

[我想你可以在How to handle File Uploads with Doctrine](http://symfony.com/doc/current/cookbook/doctrine/file_uploads.html)页面的食谱中找到所有需要的信息。

注意注释：

```
/**
 * @Assert\File(maxSize="6000000")
 */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-12T13:11:40.767

Symfony sets maxSize also in this file :

```
src/AppBundle/Resources/config/validation.yml 
```

or in old versions :

```
src/Acme/BlogBundle/Resources/config/validation.yml 
```

be sure to change it too.