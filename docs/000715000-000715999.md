# StackOverflow 问答 000715000-000715999

# c# - Linq 的 OnValidate 事件不会被触发

> ID：715002
> 
> 赞同：0
> 
> 时间：2009-04-03T17:58:05.040
> 
> 标签：c#, .net, linq, linq-to-sql

我在事件 OnValidate 中验证 linq 设计器中创建的表的数据。

插入记录时会触发此事件，但更新记录时不会触发此事件。

我有这个代码：

```
public bool Save(int id, string marca, string modelo, string año, string motor,
    bool disponible, RuleList issues)
{
    Usado u;
    if (id == 0)
    {
        u = new Usado();
        u.IdUsado = GetNextIdUsado();
        u.FechaCreacion = DateTime.Now;
    }
    else
    {
        u = GetUsadoById(id);
    }
    u.Marca = marca;
    u.Modelo = modelo;
    u.Año = año;
    u.Motor = motor;
    u.Disponible = disponible;
    if (id == 0)
    {
        DataBase.Usados.InsertOnSubmit(u);
    }
    return Execute(issues, DataBaseOperation.Save);
} 
```

当 id 等于 0 时，我进行插入，否则我进行更新。

为什么会发生这种情况？提前感谢您提供任何线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T22:47:40.443

您的更新是否会导致对象发生更改，或者您是否分配了与原始值相同的所有值？您可能必须确保某些值是不同的，以便 LINQ 对其进行任何处理。使用 GetChangeset().Updates.Count 检查更改。（你的 SubmitChanges 在哪里？）

# ruby-on-rails - 如何在其他控制器登录视图中使用 restful_authentication？

> ID：715009
> 
> 赞同：1
> 
> 时间：2009-04-03T18:00:07.373
> 
> 标签：ruby-on-rails, restful-authentication

我安装了 restful_authentication 及其工作，登录页面允许我登录，但我有另一个名为 admin 的控制器，并希望在 admin 控制器中嵌入一个登录视图。实际上登录视图的 url 是：localhost:3000/login（它有效，我需要这样用户才能登录）。我需要： localhost:3000/admin/login （包含管理员视图及其供管理员和员工登录）。我希望管理员/登录视图 form_for 调用：controller => restful_authentication，：action => 身份验证。怎么做？TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T18:26:32.833

您最好的选择可能是使用默认登录控制器 restful_authentication 提供并将其保留在原处。这将使您将来可以更轻松地升级该插件。然后，如果您想要一个单独的登录表单，要么将登录表单拆分为部分以供重用，要么实现您自己的但将其指向默认表单使用的同一控制器。最后，为了实现对某些控制器/操作的管理要求，这是一个很好的解决方案：

[http://refactormycode.com/codes/20-restful_authentication-role-requirements](http://refactormycode.com/codes/20-restful_authentication-role-requirements)

# ruby - Ruby eval 在 irb 和文件中的行为不同

> ID：715010
> 
> 赞同：4
> 
> 时间：2009-04-03T18:00:13.223
> 
> 标签：ruby, eval

此代码适用于 irb：

```
irb(main):037:0> eval <<-EOS
irb(main):038:0" #{attribute} = "host"
irb(main):039:0" puts machine
irb(main):040:0" EOS
host
=> nil
irb(main):041:0> puts machine
host
=> nil
irb(main):042:0> puts attribute
machine
=> nil
irb(main):043:0> 
```

但是，当我尝试执行与 ruby​​ 脚本相同的代码时，出现以下错误：

```
../autosys/convert_jil_to_zapp.rb:40: undefined local variable or method `machine' for main:Object (NameError)
        from ../autosys/convert_jil_to_zapp.rb:29:in `each_line'
        from ../autosys/convert_jil_to_zapp.rb:29
        from ../autosys/convert_jil_to_zapp.rb:27:in `each'
        from ../autosys/convert_jil_to_zapp.rb:27
pi929c1n10 /ms/user/h/hirscst/ruby/autosys 77$ gvim try.rb
pi929c1n10 /ms/user/h/hirscst/ruby/autosys 78$ chmod +x try.rb
pi929c1n10 /ms/user/h/hirscst/ruby/autosys 79$ ./try.rb
host
./try.rb:8: undefined local variable or method `machine' for main:Object (NameError) 
```

谁能解释为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T18:46:22.553

这是因为该`machine`变量在运行时尚未定义`eval`。一个更简洁的例子：

### 在 IRB 中工作，但不能作为脚本

```
eval 'x = 3'
puts x # throws an exception when run as a script
=> 3 
```

### 在 IRB 和脚本中工作

```
x = 1
eval 'x = 3'
puts x
=> 3 
```

[引用 Matz 的](http://groups.google.com/group/comp.lang.ruby/browse_thread/thread/a954f8aaf698a0b9/e1c761b71b63b82e?#422ad5daee216181)话：

> 局部变量应在编译时确定，因此首先在 eval'ed 字符串中定义的局部变量只能从其他 eval'ed 字符串访问。此外，它们在 Ruby2 中会更加短暂，因此这些变量不会被外部访问。

不同之处在于，在 IRB 中，*所有内容*都在进行评估，因此它们都在同一个范围内。也就是说，您实际上是在 IRB 中执行此操作：

```
eval 'x = 3'
eval 'puts x' 
```

它既适用于 IRB，也适用于脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:08:42.410

因为您正在定义一个`machine`在 IRB 中命名的方法或变量，而不是在您的 Ruby 脚本中。

# mysql - MYSQL：复杂查询问题

> ID：715020
> 
> 赞同：1
> 
> 时间：2009-04-03T18:03:36.227
> 
> 标签：mysql, complexity-theory, self-join

我正在使用民意调查：每个民意调查都有很多选项，用户可以在民意调查中投票一次。因此，我有一个包含以下字段的“投票”表：

*   id（投票的id）
*   option_id（所选投票选项的 ID）
*   user_id（用户的id）
*   poll_id（投票的id）

**所以这就是我想要做**的：给定一个 poll_ids 数组，我想让一个查询返回每个投票中投票最多的选项。因此，如果我给出 1 和 2 的 poll_id，我想取回投票 1 和 2 的投票最多的选项。我尝试了以下方法：

```
SELECT
   t1.poll_id,
   t1.option_id,
   count(t1.option_id) AS num_votes,
   t2.option_id AS user_vote 
FROM 
   votes AS t1 
JOIN 
   votes AS t2 
ON 
   t1.id = t2.id
WHERE 
   t1.poll_id IN (30,40)
GROUP BY
   t1.option_id; 
```

这几乎可以解决问题......但是为我提供的*所有*投票选项以及所提供的每个投票的相应投票，而不仅仅是投票最多的选项。如果有人有任何想法，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T18:09:09.973

```
SELECT  (
        SELECT  option_id
        FROM    votes v
        WHERE   v.poll_id = p.id
        GROUP BY
                option_id
        ORDER BY
                COUNT(*) DESC
        LIMIT 1
        ) cnt
FROM    polls p
WHERE   p.id IN (1, 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:13:50.417

我认为您不需要自我加入来解决此问题，但 Quassnoi 的回答似乎是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:17:36.473

Quassnoi的回答会做到这一点。您不需要加入表格，只需使用 count(*) 操作返回总和，然后按该总和排序，看看谁做得最好。GROUP BY 告诉 mysql 引擎要计算哪些类别，在您的情况下计算不同的轮询选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-16T21:50:18.477

这样的事情会做吗？

```
SELECT count({$row['k_id']}) as k_page 
FROM keywords_relations 
WHERE k_id = '{$row['k_id']}' AND percent > '{$row['percent']}' 
ORDER BY DESC 
```

# javascript - 如何与 AS2 文件中的索引进行通信，由 AS3 文件加载

> ID：715021
> 
> 赞同：1
> 
> 时间：2009-04-03T18:03:37.820
> 
> 标签：javascript, actionscript-3, actionscript-2

我们正在将 actionscript2 swf 加载到 actionscript3 swf 中。as3 使用 satay 方法嵌入到索引页中。

是否可以从 actionscript2 页面中获取索引页面上的变量集，而不使用 as3 页面作为中介（因为这不是一个选项）？

我们已经尝试过 ExternalInterface，但我们如何直接针对嵌入的 flash 文件呢？

或者，在从 as3 文件加载变量时，是否可以将变量发送到 as2 文件？（一个 la get vars？还是一个 flash vars？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T18:16:20.393

您谈到直接针对嵌入式闪存文件，但您要求设置一个 javascript 变量。这有点令人困惑。

所以，你是在 as2 的页面上设置一个 js 变量，对吧？

看看[这篇博文](http://blog.intuitymedialab.eu/2007/07/13/actionscript-javascript-communication-externalinterface/)，因为它有一些优点

如果您不喜欢 ExternalInterface，这是[另一种与 js 交谈的方式。](http://forums.creativecow.net/thread/190/862597)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T19:05:57.513

我认为您正在寻找的是[swfbridge](http://www.gskinner.com/blog/archives/2007/07/swfbridge_easie.html)

您要做的是创建一个 as2 包装器 swf，用于加载您要使用的 as2 文件。您可以将要在原始 as2 文件中使用的任何函数或属性添加到包装器中，然后使用桥接器从 as3 代码中调用它们。

需要做一些事情，但他提供的示例显示了它是如何工作的。

# python - 为基本图像文件 I/O 和 Python 处理寻找 PIL 的更好替代方案？

> ID：715030
> 
> 赞同：15
> 
> 时间：2009-04-03T18:07:07.793
> 
> 标签：python, image-processing, python-imaging-library

对于基本图像文件 I/O 和 Python 中的处理， PIL（ [Python 成像库](http://www.pythonware.com/products/pil/)）是否有更好的替代品？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T23:35:58.370

试试枕头： http: [//pypi.python.org/pypi/Pillow](http://pypi.python.org/pypi/Pillow)

它是 PIL 的一个分支，但由 Plone 社区维护。这很棒，因为它正在被维护（与它的前身相比）并且它向后兼容 PIL。现有代码将与 Pillow 一起使用。

他们主要关注包装问题，AFAIK 这是 PIL 最大的痛苦。

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-31T17:46:26.040

如果“更好”是指“更快”或“更少的内存密集型”或（我的实验中最大的）“能够处理更大的图像”，那么您可能可以使用 Python 接口来连接 VIPS：

[http://www.vips.ecs.soton.ac.uk/index.php?title=Python](http://www.vips.ecs.soton.ac.uk/index.php?title=Python)

但是，如果“更好”意味着“在 Python 中经过良好测试”或“对 Windows 友好”，那么 VIPS 将不符合要求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T18:48:51.487

并不真地。PIL 几乎是每个人都使用的。我自己从来没有遇到过任何困难。*但是*，如果您真的不喜欢它，您可以查看 PythonMagick 或 PythonMagickWand，它们是 ImageMagick 的包装器，可能更符合您的口味。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-18T17:25:29.913

我建议[使用 Python Wand](http://dahlia.kr/wand/)，它是一个基于 ctypes 的简单[ImageMagick](http://www.imagemagick.org/) Python 绑定。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-09T16:02:34.907

[Wand](http://dahlia.kr/wand/)是一个很棒的库，用于简单的操作，如图像文件格式转换、裁剪、调整大小、水印和基本合成。它建立在 ImageMagick 的 MagicWand C 库之上，但公开了一个漂亮的 Pythonic API。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-04T14:51:57.440

我不知道你的任务，但[OpenCV](http://opencv.willowgarage.com/wiki/)有[Python 绑定](http://opencv.willowgarage.com/documentation/python/index.html)，你可以阅读文档，看看它是否适合你必须做的事情。

# .net - .NET 紧凑框架的 GPS 库

> ID：715031
> 
> 赞同：9
> 
> 时间：2009-04-03T18:07:36.297
> 
> 标签：.net, windows-mobile, compact-framework, gps

我正在考虑为**Windows Mobile**设备编写简单的应用程序，用户可以在其中简单地输入目的地坐标，该应用程序将计算距离并显示到目的地的方向。

但是我还没有找到任何**免费**的，最好是具有简单 API 的**开源**库来与**GPS**一起工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T12:42:02.427

我最近使用了开源[SharpGPS](http://www.codeplex.com/SharpGPS)。它应该支持比 SDK 中的示例更多的设备，但两种解决方案都适用于我的所有硬件。

[SharpGPS](http://www.codeplex.com/SharpGPS)确实使访问更多结构化信息变得更加容易，例如视野中的卫星及其所在位置，并且有一个出色的示例应用程序。但其中大部分将在需要 GPS 信息的应用程序中使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T22:25:35.210

[OpenNETCF 串行库](http://www.opennetcf.com/FreeSoftware/OpenNETCFIOSerial/tabid/252/Default.aspx)中有一组 GPS 类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T18:13:50.197

[Windows Mobile 5.0 SDK](http://www.microsoft.com/downloads/details.aspx?familyid=83A52AF2-F524-4EC5-9155-717CBE5D25ED&displaylang=en)中有一个示例 GPS 应用程序，但您需要对其进行[修复](http://peterfoot.net/FixingTheWindowsMobile50GPSSampleCode.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-28T12:13:02.310

GPS.NET 现在[在 CodePlex 上免费提供](http://gps3.codeplex.com/)。

# html - 如何绕过选择中的 Safari 选项重新排序？

> ID：715035
> 
> 赞同：1
> 
> 时间：2009-04-03T18:08:48.307
> 
> 标签：html, safari, html-select

我正在为客户的网站编写管理面板，在少数地方，我需要列出国家/地区列表。他想首先获得加拿大和美国，因为他的市场主要是美国和加拿大。

所以，我写了这样的东西：

```
<select name="customerCoutry">  
    <option value="US">United States</option>
    <option value="CA">Canada</option>
    <option value="FR">France</option>
    [...]
</select> 
```

在 Firefox 和 Internet Explorer 中，它看起来不错，我有一个下拉菜单，美国第一，加拿大第二，法国第三，等等。

但在 Safari 中，它按字母顺序排列国家名称。所以我有很多国家（澳大利亚，...），加拿大，（其他），法国，（其他），美国，（其他）。您知道是否可以禁用此 Safari 功能？例如`<select name="customerCoutry" soriting="none">`，一个特殊的元标记，我可以在我的页面中插入其他东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:22:10.940

我还在 Safari 中对其进行了测试，它运行良好。如果这仍然是一个问题，请检查字母顺序是否基于选项值或选项标签；如果在选项值上，只需对值进行编号，例如“0US”、“1CA”等。如果是基于实际选择标签，那么您可能需要对标签进行编号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:02:23.667

最后我找到了问题，不幸的是，答案与问题并不相符（您认为我需要对其进行编辑以帮助其他用户吗？）。

问题如下。我通过 ajax 发送一个在国家的 Json 中解析的数组，按我想要显示的顺序排序。

```
[{"CountryID":"37","CountryCode":"CA","CountryName":" Canada"},{"CountryID":"229","CountryCode":"US","CountryName":"United States"},[...] 
```

我收到这个（长）数组，并将它添加到一个数组中，其中键是 CountryID 是数据库中国家记录的 ID，大致而言，这个 ID 似乎与字母顺序几乎相同。当我使用`for ( item in countryArray ) {...}`循环浏览数组时会发生此问题。Safari 似乎按排序顺序浏览每个项目，而不是 Firefox，它按添加元素的顺序浏览每个项目。

感谢您的帮助！尤其是 Perspx，你的回答给了我寻找解决方案（和正确的问题）的提示。:)

再次感谢您，祝您周末愉快！

# vb.net - VB.NET 是否支持虚拟事件？

> ID：715042
> 
> 赞同：0
> 
> 时间：2009-04-03T18:10:50.047
> 
> 标签：vb.net, events, compiler-construction

继续[这个问题](https://stackoverflow.com/questions/714893/how-virtual-events-work-in-c)。VB.NET 是否支持虚拟事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T18:16:05.933

## VB 是否支持虚拟事件的 CLR 概念

不。这是我们已经考虑支持但在给定语言周期中没有达到我们当前标准的内容。

## VB 是否支持自定义事件的层次结构的想法

是的。您可以使用自定义事件语法来允许层次结构控制的事件。

```
MustInherit Class Base
    Public Custom Event Event1 As EventHandler
        AddHandler(ByVal value As EventHandler)
            AddEvent1(value)
        End AddHandler

        RemoveHandler(ByVal value As EventHandler)
            RemoveEvent1(value)
        End RemoveHandler

        RaiseEvent(ByVal sender As Object, ByVal e As System.EventArgs)
            RaiseEvent1(sender, e)
        End RaiseEvent

    End Event

    Protected MustOverride Sub AddEvent1(ByVal value As EventHandler)
    Protected MustOverride Sub RemoveEvent1(ByVal value As EventHandler)
    Protected MustOverride Sub RaiseEvent1(ByVal sender As Object, ByVal e As EventArgs)

End Class 
```

# scrum - 我们应该针对哪些最佳实践来交付出色的产品？

> ID：715047
> 
> 赞同：-1
> 
> 时间：2009-04-03T18:13:05.627
> 
> 标签：scrum, ucd

我所在的 Web 开发团队与遵循以用户为中心的设计原则的用户体验团队合作。我们一起在 Scrum 中工作。

我们应该针对哪些最佳实践来交付出色的产品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:18:46.157

斯图尔特，从你的问题和随后的评论来看，听起来你有一个人的问题，而不是一个项目管理的问题。Scrum 非常适合以客户为中心的优先级、迭代交付，但如果潜在的人际交互存在缺陷，您将面临一场艰苦的战斗。

因此，为了响应“您应该针对哪些最佳实践来交付出色的产品”，请从社交方面开始。如果它是一个大团体，也许你有一个人力资源部门可以提供帮助。听起来有点团队建设和相互尊重将是一个很好的起点，然后您可以从事实际创建软件的业务。

# domain-driven-design - 实例化根实体时是否创建聚合对象？

> ID：715049
> 
> 赞同：1
> 
> 时间：2009-04-03T18:13:14.927
> 
> 标签：domain-driven-design

或者您是否定义了一个包含根实体对象的新对象？

```
public class SomeAggregateName()
{
   public EntityRoot root {get;set;}
   public Entity entity {get;set;}
} 
```

或者这是隐含的聚合吗？

```
public class EntityRoot()
{ 
   public Entity entity {get;set;}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T14:15:05.557

聚合通常是隐含的——即，它是实体。

您的示例使其更难遵循，因为您实际上没有域。

但是，让我们举一个包含 OrderLines 的 Order Aggregate Root 的经典示例。订单是一个实体——它也是聚合根。OrderLine 包含在 Order Aggregate 中，因此不能直接在 Order Aggregate 之外访问。

```
// This is the Order Aggregate Root
public class Order
{
    private IList<OrderLine> OrderLines { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T07:01:08.877

一个相关的问题：

例如，如果我想使用 FluentNHiberate 来初始化我的域实体，它要求我的 Order 类看起来像这样：

```
public class Order
{
    public virtual IList<OrderLine> OrderLines { get; set; }
} 
```

这违反了聚合内部实体的封装。关于如何在不破坏封装的情况下做到这一点的任何想法？

* * *

好的，找到它（可用的解决方案之一），将 OrderLines 成员更改为私有并将其添加到映射文件中：

```
HasMany(Reveal.Property<Order, IEnumerable<OrderLine>>("OrderLines"))
.Inverse()
.Cascade
.All(); 
```

# javascript - 将 XML 发送到服务器进行测试

> ID：715053
> 
> 赞同：0
> 
> 时间：2009-04-03T18:13:51.460
> 
> 标签：javascript, html, xml

我需要测试我编写的一个程序，该程序从浏览器接收 XML 作为文本上传。我正在寻找一种工具，它可以让我一遍又一遍地发送相同的内容，而不必每次都生成新的内容。

我正在寻找可以将文本文件发送到服务器的应用程序

或者

一种使用 JavaScript 和 HTML 的方法

这个问题的解决方案不涉及 Ethereal / Wireshark（尽管它是一个使用完整的工具）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T18:17:59.627

使用卷曲：

```
echo '<xml />' | curl -X POST -H 'Content-type: text/xml' -d @- http://myurl 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:21:58.820

取决于您要依赖“浏览器”方面的程度。

如果您只想要一个发送文件内容或文件本身的 POST 请求，您可以使用 Zend_Http 或 snoopy 之类的 PHP 库。

Snoopy 是一个模拟 Web 浏览器的 php 类，你可以在 source forge 上找到它。[http://sourceforge.net/projects/snoopy/](http://sourceforge.net/projects/snoopy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:39:11.307

你见过[硒](http://seleniumhq.org/)吗？您可以在此自动化您的浏览器端测试，从而自动化您的 XML 提交

# sharepoint - WSS 日志文件越来越失控

> ID：715059
> 
> 赞同：1
> 
> 时间：2009-04-03T18:15:00.367
> 
> 标签：sharepoint, wss, virtualization

我正在使用 Microsoft 的 WSSv3 演示 Virtual PC 演示，并且 VHD 越来越失控。

使用[文件夹大小](http://foldersize.sourceforge.net/)，我能够将其追溯到 WSS 日志文件。
今天我有两个日志文件变得过大。

1) 30 分钟内 2.5GB，然后

2）2小时内2.1GB

我正在尝试使用[LTFViewer](http://www.swiftgear.com/ltfviewer/features.html)查看内容，但由于查看器冻结，文件可能会太大周围的日志文件具有以下内容，每 5 分钟重复一次

```
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch.  
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch.  
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch. 
w3wp.exe (0x0C44)        General   Entering MRU trim routine.    
w3wp.exe (0x0C44)        General   Initial table size: 41125202 in 222 entries   
w3wp.exe (0x0C44)        General   Final table size: 41125202 in 222 entries     
w3wp.exe (0x0C44)        General   Exiting MRU trim routine.     
w3wp.exe (0x071C)        General   Entering MRU trim routine.    
w3wp.exe (0x071C)        General   Initial table size: 19857672 in 90 entries    
w3wp.exe (0x071C)        General   Final table size: 19857672 in 90 entries  
w3wp.exe (0x071C)        General   Exiting MRU trim routine.     
OWSTIMER.EXE (0x06C0)    General   Entering MRU trim routine.    
OWSTIMER.EXE (0x06C0)    General   Initial table size: 0 in 0 entries    
OWSTIMER.EXE (0x06C0)    General   Final table size: 0 in 0 entries  
OWSTIMER.EXE (0x06C0)    General   Exiting MRU trim routine.     
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch.  
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch.  
OWSTIMER.EXE (0x06C0)    E-Mail    The Incoming E-Mail service has completed a batch. 
```

同样，这只是今天才开始，我的主机上的硬盘空间不足。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:04:43.053

弄清楚了

以下行每毫秒记录 x30 次。

```
Timestamp
04/03/2009 09:48:47.86 

Process
OWSTIMER.EXE (0x0DE8)

TID
0x06D0

Area
Windows SharePoint Services

Category
Timer

EventID
5uuf

Level
Monitorable

Message
The previous instance of the timer job 'Config Refresh', id
'{975F79C9-1B0D-4D14-BD60-C531FF142500}' for service
'{6C881CF7-F11F-457B-A757-68862E0059E6}' is still running, so the
current instance will be skipped. Consider increasing the interval
between jobs. 
```

这篇博文描述了如何修复

[http://blogs.vertigo.com/personal/steventap/Blog/archive/2007/01/19/managing-sharepoint-2007-moss-application-log-size.aspx](http://blogs.vertigo.com/personal/steventap/Blog/archive/2007/01/19/managing-sharepoint-2007-moss-application-log-size.aspx)

谢谢大卫，

要总结博客文章，请更改您的诊断日志记录级别。如果在本地虚拟机中开发，还建议将这些日志写入 VHD 外部的共享文件夹

管理中心 > 操作 > 记录和报告 > 诊断记录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T18:56:39.080

可以通过对象模型 (SPDiagnosticsService) 对日志文件设置限制，但不能通过 STSADM 命令行工具 - 直到现在：

[http://stsadm.blogspot.com/2008/06/trace-log-settings.html](http://stsadm.blogspot.com/2008/06/trace-log-settings.html)

这是 STSADM 的插件，可让您将日志移动到不同的驱动器、限制日志文件计数和日志时间。

-Oisin

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-10T22:45:32.010

我在我的日志中看到了同样的事情，但史蒂夫建议的修复没有奏效。

起作用的是确保时钟设置在正确的时间。时钟被调到过去 20 分钟。一旦我将服务器上的时间更新为正确，错误就停止了。

# web-applications - Web 应用程序和客户端/服务器应用程序有什么区别？

> ID：715063
> 
> 赞同：9
> 
> 时间：2009-04-03T18:16:07.553
> 
> 标签：web-applications, client-server

我从另一个[问题](http://www.sqlite.org/whentouse.html)中得到了这个。

在 sqlite 的适当用途下，它具有：

> SQLite 运行良好的情况
> 
> •网站
> 
> SQLite 通常可以很好地作为中低流量网站（也就是说，所有网站的 99.9%）的数据库引擎。当然，SQLite 可以处理的网络流量取决于网站使用其数据库的程度。一般来说，任何每天点击量少于 100K 的网站都可以使用 SQLite。10 万次点击/天的数字是保守估计，而不是硬性上限。SQLite 已被证明可以处理 10 倍的流量。
> 
> 另一个 RDBMS 可能工作得更好的情况
> 
> •客户端/服务器应用程序
> 
> 如果您有许多客户端程序通过网络访问公共数据库，则应考虑使用客户端/服务器数据库引擎而不是 SQLite。SQLite 将在网络文件系统上工作，但由于与大多数网络文件系统相关的延迟，性能不会很好。此外，许多网络文件系统实现的文件锁定逻辑包含错误（在 Unix 和 Windows 上）。如果文件锁定不能正常工作，则两个或多个客户端程序可能同时修改同一数据库的同一部分，从而导致数据库损坏。因为这个问题是由底层文件系统实现中的错误引起的，所以 SQLite 无法阻止它。
> 
> 一个好的经验法则是，在通过网络文件系统从多台计算机同时访问同一个数据库的情况下，您应该避免使用 SQLite。

* * *

### 我的问题：

我将在这里展示我的无知，但这两者有什么区别？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-03T18:37:01.937

“Web 应用程序”是一种通常使用浏览器作为客户端的应用程序。Web 应用程序是客户端/服务器应用程序。换句话说，您可以将客户端/服务器应用程序视为超类，其中 Web 应用程序是子类。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T18:19:06.550

“web”应用程序意味着浏览器是客户端

客户端/服务器应用程序意味着自定义客户端应用程序。想想 Outlook 连接到交换，虽然它可能使用网络连接，但它是交换服务器的自己的客户端。

**编辑：**

更具体到您发布的 sqlite 文本，它们的意思是客户端应用程序不应该直接访问您的 sqllite DB，而应该使用某种服务器端接口（即 json Web 服务）

但在我看来，这条经验法则适用于所有数据库引擎。如果我使用 SQL Server 或 Oracle，我绝对会避免让客户端应用程序直接连接到数据库，这有很多潜在的问题，首先是安全性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T18:37:54.727

有几点需要注意的区别：

Web 应用程序假定客户端是 Web 浏览器，并且客户端和服务器之间的通信是无状态的 (HTTP)。它还倾向于假设客户端“瘦”并且在浏览器中完成的信息处理很少。

客户端-服务器应用程序假定客户端是“厚”客户端，并且客户端和服务器之间的通信保持状态（这不一定是真的）。通信几乎可以是任何协议。老式的客户端-服务器或 2 层应用程序确实让每个客户端都直接连接到数据库——出于各种原因，我建议不要这样做，第一是安全性。这可能是您在说 SQLite 不合适时发布的来源的意思。

3+ 层类型的应用程序仍然可以进行有状态的客户端-服务器通信，但中间层将处理实际的数据库通信。在这种情况下，网络上的延迟并不重要，SQLite 可以工作（因为它更像是一个 Web 应用程序）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-26T08:20:32.533

区别 b/n 客户端/服务器应用程序和 Web 应用程序服务器

1）客户端服务器应用程序遵循两层架构，但网络服务器应用程序遵循三层或“n”层架构。

2）在客户端服务器应用程序中，我们不会使用 Web 服务器，但在 Web 服务器应用程序中将使用相同的。

3）客户端服务器应用程序主要用于Intranet领域，但Web服务器应用程序用于Internet领域。

4）客户端服务器中的安全问题非常少，因为有最少的用户，但在 Web 服务器中，安全问题是最大的，因为最终用户更多。

5）客户端服务器不考虑性能问题，但会考虑Web服务器应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-30T08:43:40.950

1.  Web 应用程序在浏览器上运行，客户端-服务器应用程序作为 .exe 运行。
2.  Web 应用程序在服务器上运行，客户端-服务器应用程序在客户端运行。
3.  Web 应用程序是瘦客户端，客户端-服务器应用程序是胖客户端。
4.  Web 应用程序不需要安装在客户端系统中，客户端-服务器应用程序需要安装在客户端系统中 5.Web 应用程序需要低维护，客户端-服务器应用程序需要高维护

[http://webvsclientserverbysujan.blogspot.in/2014/01/WebVsDesktoApppbysujan.blogspot.com.html](http://webvsclientserverbysujan.blogspot.in/2014/01/WebVsDesktoApppbysujan.blogspot.com.html)

# jasper-reports - 如何配置 iReport 3.5 以使 JasperReports 与较低版本兼容？

> ID：715065
> 
> 赞同：2
> 
> 时间：2009-04-03T18:16:28.163
> 
> 标签：jasper-reports, ireport

有人可以告诉我如何配置 iReport 3.5 (nb) 以使用“兼容模式”并为较低版本的 JasperReports 生成报告 XML，即 JasperReports 1.x 语法？iReport 3.0有这个功能，现在3.5好像找不到了。感谢您的任何回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-05T23:06:45.100

工具 -> 选项 -> 常规 -> 兼容性

我在这里使用 iReport 3.5 (nb)，它的兼容性只延伸到 2.0.2 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-09T15:57:09.653

在 ireport 3.6.2 中，它位于工具 -> 选项 -> iReport -> 常规 -> 兼容性下

# matlab - 对象数组方法调度

> ID：715066
> 
> 赞同：1
> 
> 时间：2009-04-03T18:16:42.920
> 
> 标签：matlab, matlab-class

在 MATLAB 的新对象模型中（`classdef`等）：如果我有一个对象数组，并且我调用一个普通方法，是为每个对象调用的方法，还是为整个数组调用的方法，即传入方法的单个对象，还是整个数组？我知道在旧模型中，它是作为整个数组发送的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T20:10:07.657

如果你有：

```
classdef MyObject

methods
    function foo(obj)
    ...
end 
```

然后你打电话

```
>> foo(myObjArray) 
```

然后对 foo() 的单个调用将接收整个数组。从那里您可以编写代码来处理 obj 的标量情况或 obj 的向量情况。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-03T18:21:04.330

这取决于您的方法是否是矢量化的。举个简单的例子：

## 未矢量化

```
function result = mySimpleMultiply(a,b)

result = a*b; 
```

## 矢量化

```
function result = myVectorizedMultiply(a,b)

result = a.*b; 
```

# regex - mod_rewrite 参数数量/反向引用限制

> ID：715069
> 
> 赞同：5
> 
> 时间：2009-04-03T18:17:58.393
> 
> 标签：regex, apache, mod-rewrite

显然，您可以在 htaccess RewriteRules 中访问多少反向引用有一个限制 (9)。

但是我们有一个需要超过 9 个参数的 RewriteRule，如下所示：

```
RewriteRule ^([^/]+)/b([0-9]+)(/a([0-9]+))?(/v([0-9]+))?(,([0-9]+))?(/(ajax|share))?(,complete)?$ /index.php?control=sites&site=brands&control_file=version_select&name=$1&campaign_id=$2&answer=$4&page=$8&option=$10&video_id=$6&page_type=research [L] 
```

因此，当您尝试访问“$10”时会发生什么，它使用了 $1 并在其旁边放了一个 0。

有没有人能够解决这个问题，任何替代解决方案或任何东西？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T18:29:44.573

实际上，您不需要捕获所有内容。`"?:"`为您不想重用的东西编写非捕获组（用 介绍），这应该会给您一些喘息的空间。比较：

```
你的： 我的：
------------------------- ------------- --
^([^/]+)/b $1 ^([^/]+)/b $1
([0-9]+) $2 ([0-9]+) $2
(/a([0-9]+))？$4 (?:/a([0-9]+))? 3 美元
(/v([0-9]+))？$6 (?:/v([0-9]+))? 4 美元
(,([0-9]+))？8 美元 (?:,([0-9]+))？5 美元
(/(ajax|share))？10 美元！(?:/(ajax|share))? 6 美元
（，完成）？11 美元！（，完整）？$ 7

```

但是单独使用 mod_rewrite，你不能超过 9 个反向引用。如果您需要更多，请使用替代方法 - 例如仅捕获重写中最重要的部分，并对应用程序中的其余 URL 进行一些字符串处理。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T18:25:37.767

一个，虽然很愚蠢，但想法是分两步进行重写，也就是说，将两个`RewriteRule`s 与第一条规则链接起来，将其重写为某种中间格式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T18:23:41.280

一种解决方案可能是使用相同的正则表达式，没有捕获，并将请求传递给 index.php

然后使用 index.php 通过正斜杠分解请求 URI，您可以从那里处理数据。

# .net - 在暴露给 COM 的 C# 对象上实现 ISupportErrorInfo

> ID：715073
> 
> 赞同：3
> 
> 时间：2009-04-03T18:18:46.940
> 
> 标签：.net, asp-classic, error-handling, com-interop

我正在用 C# 编写一个 COM 对象，我想使用它理解的机制向 vba/asp 客户端软件提出错误 - Err 对象。

在过去的好日子里，这意味着在 COM 对象上实现 ISupportErrorInfo，但我找不到有关如何在 C# 对象中实现该接口的任何信息。

有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T18:29:39.597

您应该能够通过从托管代码中抛出自定义异常来模拟这一点。所有 CCW 都会自动实现 ISupportErrorInfo ( [Reference](http://msdn.microsoft.com/en-us/library/111chfb8.aspx) ) 并了解如何为抛出的异常返回错误信息。

您需要做的就是创建一个自定义异常（如果当前的异常不适合您）并通过设置基本 Exception.HResult 成员来提供适当的 HResult。

# java - Java Swing 的十六进制查看器/编辑器 GUI 组件？

> ID：715081
> 
> 赞同：5
> 
> 时间：2009-04-03T18:21:14.470
> 
> 标签：java, swing, components, hex

我正在寻找可以在我的 Swing GUI 中使用的体面的十六进制查看器（只读；我不需要编辑器）GUI 组件。外面有什么吗？我想我可以自己写，但我希望避免这样做。（也很高兴能够将某些字节渲染为彩色/粗体以突出显示有问题的特定字节。）

编辑：这是用于显示内存中 ByteBuffer 的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-26T08:09:05.940

你试过[http://fifesoft.com/#/hexeditor](http://fifesoft.com/#/hexeditor)吗？

HexEditor 是一个十六进制编辑器组件，用 Swing 编写。其功能集包括：

剪切、复制、粘贴、删除 撤消/重做文件内容的 ASCII 视图 输入验证

它是在 BSD 风格的许可证下发布的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T18:52:26.127

[Java 十六进制编辑器组件](http://sourceforge.net/projects/jhecomponent/)。它很旧但工作正常

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-13T07:30:49.253

我目前正在开发

[http://hexedit-lib.sourceforge.net/](http://hexedit-lib.sourceforge.net/)

组件本身在某种程度上已经成熟，但仍然缺少一些功能（如复制/剪切/粘贴）。还有一个 GUI，它提供了一个工作的 HexEditor，它显示了如何使用。工作正在进行中 ;）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-27T21:58:26.640

在 Apache License V2 下用 Swing 编写的十六进制组件/编辑器。

[http://deltahex.exbin.org](http://deltahex.exbin.org)

它也应该可以用作查看器组件，并且您应该能够使用自定义实现为覆盖画家的字符着色。

# stack-trace - 远程故障排除

> ID：715088
> 
> 赞同：0
> 
> 时间：2009-04-03T18:22:59.550
> 
> 标签：stack-trace

我正在尝试解决我无法访问的机器上的一些问题。这些问题非常断断续续，无法在本地重现。我正在考虑让他们安装 WinDbg，以便他们可以生成进程的堆栈跟踪/转储。这是最好的方法吗？你用什么方法来解决这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T18:28:47.103

如果您正在使用 Windows 系统，您可以要求另一台机器的所有者允许您的机器远程桌面访问。这样一来，您就可以访问其他系统的所有详细信息，就像它是您自己的系统一样。如果您正在使用 linux 机器，您可以通过 ssh 客户端访问另一台机器的命令行，另一台机器的所有者必须授予用户 ssh 访问权限并告诉您该用户名和密码。然后通过进一步询问root密码，您可以在其他系统的命令行上工作，这在linux机器上是最强大的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:31:56.800

试试[副驾驶](https://www.copilot.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T19:09:35.447

如果您可以将其构建到您的代码及其 Windows 中，您可以让它在崩溃时自动生成崩溃转储。为此，您必须编写自己的异常处理程序，并使用 SetUnhandledExceptionFilter API 函数挂钩它。然后，您的处理程序可以调用 MiniDumpWriteDump 为您写出一个小型转储。如果用户向您发送了 mini-dump，您可以将其加载到 windbg 并获取堆栈跟踪和其他信息（运气好）。

我过去曾成功使用过它，但它很棘手。特别是，您机器上的编译符号必须是分布式构建中的符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T18:25:12.617

我最终创建了一个 .bat 文件，该文件使用 cdb.exe（包含在 WinDbg 中）来生成我需要的转储。它工作得很好，我永远不需要触摸远程机器。更好的是，用户不需要任何技术知识。只需安装 WinDbg 并运行 .bat 文件。

# c# - SQL 报告：空参数

> ID：715090
> 
> 赞同：6
> 
> 时间：2009-04-03T18:23:42.030
> 
> 标签：c#, sql, reporting-services

我发现在 SQL 报告中可能存在问题。我的页面上有一个 ReportViewer，我正在使用以下方法发送参数：

```
List<ReportParameter> myParams = new List<ReportParameter>();

myParams.Add(new ReportParameter("Start_Date", StartDate));
myParams.Add(new ReportParameter("End_Date", EndDate));

ReportViewer1.ServerReport.SetParameters(myParams); 
```

这很好用！但是，当我尝试将参数设置为 null 时，在运行该查询后，它会保留以前的值，而不是将其设置为 null。

我在上述代码之后执行的另一个事件上运行此代码：

```
List<ReportParameter> myParams = new List<ReportParameter>();

myParams.Add(new ReportParameter("Start_Date")); 
// I even tried omiting this line.  
//(This is the null parameter I wish to pass)
myParams.Add(new ReportParameter("End_Date", EndDate));

ReportViewer1.ServerReport.SetParameters(myParams); 
```

有没有人遇到过解决方法或不同的技术来使它工作？

此外，如果我最初不定义参数，然后分配参数，然后不定义参数，它会保持分配的值。（这些都是回发，每个事件）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T19:16:59.687

做这样的事情..我已经在我自己的小测试项目中对其进行了测试，它似乎有效。

```
List<ReportParameter> myParams = new List<ReportParameter>();

ReportParameter p = new ReportParameter("Start_Date");
p.Values.Add(null);
myParams.Add(p);

//myParams.Add(new ReportParameter("Start_Date")); 
// I even tried omiting this line.  
//(This is the null parameter I wish to pass)
myParams.Add(new ReportParameter("End_Date", EndDate));

ReportViewer1.ServerReport.SetParameters(myParams); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T00:26:38.060

你有没有试过打电话：

```
ReportViewer1.Reset(); 
```

在两个电话之间？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:47:16.450

那些 StartDate 和 EndDate 变量是 DateTime 类型的吗？也许这与 DateTime 变量不能设置为 null 的事实有关，它们是 DateTime.MinValue 。尝试将参数设置为 DateTime.MinValue 并进行相应处理。

# c# - 如何将当前屏幕捕获为图像？

> ID：715094
> 
> 赞同：5
> 
> 时间：2009-04-03T18:24:36.380
> 
> 标签：c#, winforms, .net-3.5, screenshot

我想为用户添加在我的应用程序中捕获当前屏幕并通过电子邮件发送的功能。我有一个非常非技术性的用户群，所以我需要它尽可能简单。我打算让他们点击一个名为 Help Me 的菜单项！然后它将捕获当前的应用程序屏幕，希望是 jpg 或 png，然后打开 Outlook 并将图像添加为附件。

我正在阅读 Code Project 上的这篇[ScreenCapture](http://www.codeproject.com/kb/graphics/ScreenCaptureByHolzhauer.aspx)帖子，但它有点旧，并不是我想要的，所以我想我会检查是否有更好的方法来做到这一点。

我该如何开始呢？是否有库或内置功能是否足够？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T18:29:23.577

你链接的那个帖子是正确的方法，他们只是让它变得非常复杂。你会想要使用[`Graphics.CopyFromScreen`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.copyfromscreen.aspx).

```
Rectangle bounds = this.Bounds;

using(Bitmap ss = new Bitmap(bounds.Width, bounds.Height))
using(Graphics g = Graphics.FromImage(ss))
{
  g.CopyFromScreen(this.Location, Point.Empty, bounds.Size);
  ss.Save("test.jpg", ImageFormat.Jpeg);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T18:28:03.953

检查[Graphics.CopyFromScreen](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.copyfromscreen.aspx)方法。

# security - 来自工作站的端口扫描；病毒扫描不显示任何恶意软件

> ID：715096
> 
> 赞同：0
> 
> 时间：2009-04-03T18:25:26.720
> 
> 标签：security

工作站正在扫描 LAN 中的端口；但是病毒扫描没有发现任何东西（McAffee、Sophos、MS）。

是清理硬盘的唯一选择吗？

是否有任何这种描述的新恶意软件尚未被防病毒软件供应商拾取以进行扫描。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:34:27.823

您可以使用[wireshark](http://www.wireshark.org/)找出到底发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:29:47.460

你怎么知道它是“扫描端口”？我已经看到一些过度活跃的 Windows 防火墙产品进入核战争模式并通过拦截一个 ICMP 回显（ping）数据包来尖叫血腥谋杀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:30:46.240

尝试查找正在执行端口扫描的进程（也许使用[netstat](http://en.wikipedia.org/wiki/Netstat)？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T18:31:35.193

还有其他可能性。出于正当的原因，我在以前的工作中运行了端口扫描。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T18:38:55.503

如果没有人从它运行合法的端口扫描：

1.  立即将其从网络中拔出。
2.  如果你有时间，把它拉到一个专用的私人循环上，看看它在做什么。
3.  如果您这样做，请准备好扫描软件，以安全模式重新启动系统，然后运行扫描。
4.  如果您这样做，请检查注册表中的典型已知位置以查找启动文件，以查看是否有任何异常。

无论您是否找到任何东西，擦除 HD 并从图像中恢复。与重新映像相比，您将花费更多时间尝试清洁系统，并且您不会 100% 确定系统已清洁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T18:39:47.077

如果不是所有的防病毒/反恶意软件产品，任何和所有的恶意软件都可以很容易地被大多数人检测到。即使是相对不熟练的人也可以使用可用的工具或服务来做到这一点。

清洁机器的唯一方法是擦拭它。总是。公司机器应该足够简单，每个人只需擦拭它就可以节省时间。但是，如果问题经常再次出现或怀疑数据丢失或被盗 - 请联系专业人员。

杀毒软件只是为了过滤掉一般的垃圾噪音，它不会捕捉到定向/真实的攻击。

但是正如有人所说，您确定机器正在做非法的事情而不仅仅是正常运行吗？你需要一些网络技能来决定我猜......但如果它行为不端并且你找不到原因 - 擦除它。轻松选择。

即使您确实发现了某种病毒或恶意软件，您也应该彻底清除它——因为这足以表明机器可能会受到进一步的威胁，而您不会检测到。

主机安全中有一句话，如果主机被感染，无论你对它做什么，它都不再是你的主机，除了完全擦除它（即使这样也很乐观，因为有时有办法将恶意软件存储在可编程 rom 中就像在易受攻击的网卡的固件或其中的其他一些非易失性存储中一样）。

# couchdb - 什么时候适合使用 couchDB？

> ID：715101
> 
> 赞同：7
> 
> 时间：2009-04-03T18:27:56.340
> 
> 标签：couchdb

我目前正在编写一个应用程序，在非常不同的层有很多不同的数据持久性需求，我一直想知道......什么时候合适，什么时候不适合使用 couchDB 来满足我的持久性需求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T04:24:16.190

看：

*   [CouchDB 与 RDBMS 相比有哪些优势](https://stackoverflow.com/questions/644695/what-are-the-advantages-of-couchdb-vs-a-rdbms)
*   [为什么我应该使用基于文档的数据库而不是关系数据库？](https://stackoverflow.com/questions/441441/why-should-i-use-document-based-database-instead-of-relational-database)
*   [基于文档的数据库与关系数据库的优缺点](https://stackoverflow.com/questions/337344/pros-cons-of-document-based-database-vs-relational-database)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-08T07:10:33.697

在非关系数据库之上实现了两个生产系统之后，我得出结论，非关系数据库需要更接近 sql 才能真正“替代”它。我将替代理解为“您获得相同的功能，而质量、工作量或成本没有巨大差异”。

简短的回答：不经常

长答案。非关系数据库的主要好处是高可用性、无模式和可扩展性。所有这一切都伴随着巨大的代价。如果您的应用程序需要查询灵活性（和/或，排序顺序，..）并且没有大数据或性能要求，那么您最好使用 mysql 或更好的 postgres 等传统数据库。非关系数据库的主要挑战是，如果您需要新的方法来组合数据（如用户按时间顺序喜欢的所有帖子），您将需要新的文档来插入和查看以实现查询。Couchdb 是基于文档的，有利于灵活性，因为您不需要在数据库中维护模式，并且可以“忘记”缺少新字段的旧数据。

非关系数据库需要推送架构。当您插入或更新数据时，需要推送所有可能查询的所有数据（甚至是罕见的管理员查询）。这需要 cpu 和磁盘的成本，但您可以获得快速查询。在基于 SQL 的数据库中，您可以只插入行并作为慢查询付出代价。CouchDB 在第一次查询时构建索引，在插入时构建其他一些数据库（MongoDB、Google App Engine）

Couchdb 查询被定义为功能强大但很难编写、维护和调试的 javascript 视图。视图更改意味着如果您有数百万或更多文档，couchdb 需要重新索引所有非常慢的文档。普通管理员无法解读来自 couchdb 的错误消息。

Couchdb 维护需要一些手动操作来压缩数据文件和索引，新版本虽然具有自动压缩，但使用它需要小心。压缩需要安排在非高峰期等。不过，这可以很容易地编写脚本。数据库转储、备份和此类工具还很幼稚。

简而言之，如果您不需要 couchdb 的性能或可扩展性，那么不值得付出努力。就我个人而言，我认为使用 sql db、redis 和 memcache 堆栈可以“模拟”大多数非关系数据库的性能优势。至少只要没有太多数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T18:36:08.427

你有关系要求吗？CouchDb（如您所知）没有普通数据库的关系结构。

CouchDb 的 RESTful 特性对您的工作是否重要？

也许最重要的是，谁将支持这一进程，他们是否有能力处理 CouchDb？这是一个相当小众的工具，要找到有经验的人并不容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T23:02:03.753

我会说，这真的是一个个案。CouchDB 只是一种数据库，根据您的项目，它可能是完美的选择，也可能是令人痛苦的限制——就像 RDBMS 可能是完美的选择或噩梦一样。

更多细节？

# c# - 在 C# 中动态执行代码

> ID：715102
> 
> 赞同：0
> 
> 时间：2009-04-03T18:28:00.537
> 
> 标签：c#, pointers

我想使用指针动态控制代码执行，基本上是没有堆栈帧的函数指针。执行不会返回到调用位置，而是返回到单个点。

```
TopOfLoop:
...
Jump(x)

x1:
...
continue

x2:
...
continue

etc. 
```

这在c#中可能吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T18:29:58.333

也许通过使用`**goto**`声明？

参考 MSDN：http: [//msdn.microsoft.com/en-us/library/13940fs2.aspx](http://msdn.microsoft.com/en-us/library/13940fs2.aspx)

但是，不推荐使用这种编码方式。尝试改用委托：

```
 Func<T,TResutl> or Action<T> 
```

*   [函数委托](http://msdn.microsoft.com/en-us/library/bb549151.aspx)
*   [行动代表](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)

## 样本：

```
using System;

public class LambdaExpression
{
   public static void Main()
   {
      Func<string, string> convert = s => s.ToUpper();

      string name = "RIA Guy";
      Console.WriteLine(convert(name));   
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T18:31:41.807

就函数指针而言，您可能想看看 c# 中的委托。至于其余的，已经被其他人覆盖了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T18:45:36.750

这看起来也可以使用 SWITCH，并且可以避免代码中的“goto”（尽管它可能会编译相同）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T18:30:00.063

你可以使用[goto](http://msdn.microsoft.com/en-us/library/13940fs2(VS.71).aspx)。我不会，但它会做你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T18:32:03.960

您当然可以使用回调调用委托，但我不确定如何在 goto 之外完成“执行不返回调用位置”部分。

# c# - .net 中跨多个系统的主从控制架构

> ID：715113
> 
> 赞同：0
> 
> 时间：2009-04-03T18:30:21.577
> 
> 标签：c#, .net, security, model-view-controller, network-programming

我一直在分析我的下一个项目并编写需求，我想做的一件事是通过 64 个串行端口（16 个端口 x 4 个 Windows 电脑）进行通信

最好的是我能想到这样做是一个主/从应用程序模型，其中主应用程序由操作员控制，从属只需执行由主控发出的命令（远程过程调用？我还不擅长术语，我是初级工程师）我的问题如下：

**在 .net 中，发出上述命令并从远程进程接收响应的最佳方式是什么？**

**是否有一种通用的设计模式来处理这种情况？**

**如果用户无法直接访问 4 个系统中的 3 个（甚至可能是全部 4 个），我如何确保在远程计算机上生成从属进程？崩溃恢复在这里也是一个问题，有没有一种简单的方法可以告诉远程 pc 执行某些操作？这似乎是一个巨大的安全问题。**

编辑：格洛梅克问（简而言之）

> 会有人在奴隶上使用软件吗？为什么用户无法访问系统？

该系统严格来说是比萨盒，没有显示器，这些是最低工资测试操作员测试产品，4 台计算机之间应通过网络通信相互通信，但 4 台计算机随后与 64 个被测单元进行通信，这些单元都具有 RS232 串行通信。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T20:38:03.517

> 在 .net 中，发出上述命令并从远程进程接收响应的最佳方式是什么？

您可以查看 .NET Remoting。其他有效的选项是将它们实现为服务器（例如soap）。

一种典型的方法可能是使用队列。

> 是否有一种通用的设计模式来处理这种情况？

为此，请查看企业集成模式（Gregor Hohpe 和 Bobby Woolf）。很棒的书。

> 如果用户无法直接访问 4 个系统中的 3 个（甚至可能是全部 4 个），我如何确保在远程计算机上生成从属进程？崩溃恢复在这里也是一个问题，有没有一种简单的方法可以告诉远程 pc 执行某些操作？这似乎是一个巨大的安全问题。

编写一个依赖于身份验证的 API。您可以使用启用了 Windows 身份验证的 Web 服务。Web 服务也可用于查询衍生进程的状态。

这也可以使用基于消息的方法来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:47:10.873

Regarding the authentication, you could use certs from your ICA (if you have one).

# javascript - 如何使复选框触发功能？

> ID：715124
> 
> 赞同：2
> 
> 时间：2009-04-03T18:34:39.913
> 
> 标签：javascript, html, checkbox, label

我在 <label> 中有一个复选框，我希望该复选框在选中或未选中时触发一个功能。我在复选框上附加了一个 onchange 触发器，但在 IE6 中，触发器仅在焦点离开复选框后触发，而在 FF3 和 Chrome 中，它会立即触发。我删除了 onchange 触发器并将 onclick 触发器附加到 <label> 但是现在当标签被单击一次时触发器会触发两次（有人知道为什么吗？）...

我的问题是：当通过单击它或它的标签选中或取消选中复选框时，如何使复选框触发一个功能。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T18:53:28.527

假设您不想要一个花哨的 ASP / JQuery 解决方案，只需将该函数附加到复选框本身的 onClick 就可以正常工作。

（当然，如果您想让函数根据复选框是否被选中而表现不同，则需要检查函数中复选框的当前状态。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T01:03:13.770

正如“Electrons_Ahoy”所说，您应该能够简单地将`onclick`处理程序附加到复选框元素。当用户单击标签而不是复选框时，也应该调用此处理程序。

HTML：

```
<label><input type="checkbox" id="myCheckbox" />My Checkbox</label> 
```

JavaScript：

```
document.getElementById("myCheckbox").onclick = function() {
    if (this.checked) {
        alert("Checkbox was checked.");
    }
    else {
        alert("Checkbox wasn't checked.");
    }
}; 
```

上面的代码似乎在 Safari 4 和 Firefox 3 中正常工作（我不确定它在 IE 中如何工作）。

史蒂夫

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:19:56.647

不确定使用[Prototype](http://prototypejs.org)是否适合您，但如果是这样，您会这样做（假设 Prototype 1.6。针对早期版本编写的代码会略有不同）：

HTML：

```
<label><input type="checkbox" id="myCheckbox" />My Checkbox</label> 
```

JS：

```
$('myCheckbox').observe('click', function(cbox)
    {
        var cbox = $('myCheckbox');
        //do work in here.
        //cbox is the DOM element that represents your checkbox
    }
); 
```

这样做比“裸” JS 方法（在我看来）稍微好一点，而且也更安全一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T11:41:06.670

感谢您的所有回复。

@Electrons_Ahoy 和@Steve：你很紧张。我的问题是我将复选框放在标签内，所以我做了以下操作：我将复选框放在标签外，仅将 onclick 触发器放在复选框上，它工作正常。

我还弄清楚了为什么当复选框在标签内并且 onclick 触发器在标签上时触发两次：这是因为当我单击标签时，模拟了对复选框的单击并且复选框在标签内单击是在标签上模拟，duuuuuhhh :)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-03T18:40:42.083

您可能需要打开 autopostback 属性：

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkbox.autopostback.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkbox.autopostback.aspx)

```
 <asp:CheckBox id="checkbox1" runat="server"
                AutoPostBack="True"
                Text="Include 8.6% sales tax"
                TextAlign="Right"
                OnCheckedChanged="Check_Clicked"/> 
```

# python - WeakValueDictionary 用于保存任何类型

> ID：715125
> 
> 赞同：1
> 
> 时间：2009-04-03T18:34:46.167
> 
> 标签：python

有没有办法解决 WeakValueDictionary 的限制，以允许它保存对内置类型（如 dict 或 list）的弱引用？可以在扩展模块中的 C 级别做某事吗？我真的需要一个可以容纳（几乎）任何类型的对象的弱引用容器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:01:08.897

根据[Python 文档](http://docs.python.org/library/weakref.html)`dict`，您可以创建对and的子类的弱引用`list`……这不是一个完美的解决方案，但是如果您能够创建自定义子类`dict`并使用它而不是 native `dict`，它应该就足够了。（我自己从来没有真正这样做过）

# agile - 如何让用户/客户参与迭代开发？

> ID：715126
> 
> 赞同：0
> 
> 时间：2009-04-03T18:34:59.037
> 
> 标签：agile, change-management

当您的（外部）客户的用户没有时间/意愿积极参与迭代开发时，您会怎么做？你如何“强迫”他们牵连？请记住，他们通常必须在完成所有常规职责的同时执行此操作，并且赞助软件项目的 IT 部门无权让一些关键用户免于他们的常规工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:39:42.273

*你*不能强迫他们。他们的管理层可以，但显然对这个项目不感兴趣。这意味着他们认为这不会产生任何好处或提高生产力。这反过来意味着您的软件无论如何都不会被使用。

他们是你需要说服的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:37:41.153

让他们知道 SCRUMM 是短暂的会议。如果他们不在那里，让他们知道该项目可能会偏离轨道。让他们知道，如果他们出现，他们会立即获得意见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:38:34.910

我确保合同是时间和材料，因为您将在最后一刻更改范围，并且您希望避免消耗该成本。

除此之外，您不能强迫他们使用该产品。您可以期望的最好的结果就是发布更改并让他们知道。我的内部客户正面临这个问题，他们错过了我们软件的一两个版本，当他们最终重新使用它时迷失了方向。

我能做的最好的事情就是与他们沟通，了解变化以及他们看待变化的重要性，但归根结底就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T18:44:07.613

我认为非常清楚地表明最频繁的参与者获得最多的输入是至关重要的。我们的最新应用程序有一个客户，在其他人往往偶尔出席的每次会议中都会出现该应用程序。因此，调整和/或添加到应用程序的功能对一个客户更有用。如果你能让他们明白他们的反馈真正塑造了他们可能想要的最终产品。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T17:29:03.920

敏捷要求满足特定的进入标准。其中之一是拥有产品所有者和客户协作。虽然您可以做一些事情来简化产品负责人的角色，但消除这个角色是实施敏捷的关键障碍。所有者确定产品待办事项（技术债务除外）上的内容，并为团队确定待办事项的优先级。如果你在没有产品积压的情况下工作，那么你就不是价值驱动的。

最好教育你的商业伙伴。为此，通过与成功实施敏捷的公司或团队共度一周，让他们沉浸在敏捷中。一旦你买了继续。没有商业伙伴的支持算了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-23T15:44:25.740

我发现让客户感兴趣的最好方法是向他们展示一些有形的东西。这通常意味着某种用户界面，即使很少或没有真正的后端代码。当人们可以将您为他们构建的产品形象化时，他们会变得热情，并且可以在这些条件下提供更有效的输入和批评。然后，为了维持反馈周期，最重要的是确保你接受他们的意见，并表明他们的意见是有价值的。当客户看到项目不断发展并感受到该过程的一部分时，他们很难保持愤世嫉俗和不感兴趣。

# asp.net-mvc - Asp.NET 的照片库服务

> ID：715138
> 
> 赞同：0
> 
> 时间：2009-04-03T18:40:01.740
> 
> 标签：asp.net-mvc, web-controls, photo-gallery

嗨，我需要为我的应用程序添加照片支持。搜索该站点，我发现对 nGallery 的引用。任何其他。我使用 ASP.NET MVC。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:50:00.157

你想用它做什么？有很多用于 jQuery 的幻灯片/图库类型的插件可以在 ASP.NET MVC 站点中很好地工作。我正在使用[Cycle](http://www.malsup.com/jquery/cycle/)插件在我的一个网站上播放幻灯片。还有[Galleria](http://www.webappers.com/2008/03/05/galleria-simple-but-nice-jquery-image-gallery/)，看起来还不错。谷歌搜索“ [jQuery 画廊](http://www.google.com/search?q=jquery+gallery)”（查看更多内容无意冒犯。

# c++ - 你为什么要投一个作业的 lhs ？

> ID：715139
> 
> 赞同：6
> 
> 时间：2009-04-03T18:40:03.800
> 
> 标签：c++

我遇到了一些归结为以下内容的代码：

```
enum BAR { /* enum values omitted */ }

class Foo{
public:
  void set(const BAR& bar);
private:
  uint32_t bits;
};

void Foo::set(const BAR& bar)
{
 (uint32_t&)bits = bits | bar;
} 
```

我不明白 Foo::set 赋值中 c 样式转换的意义。你为什么要投一个作业的 lhs ？我疯了，还是有目的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T18:55:26.977

在这种情况下，我看不出强制转换的任何原因，因为被强制转换的东西与强制转换的类型相同。通常，它可用于强制使用特定的赋值运算符。

我现在重复我的口头禅：如果您的代码包含强制转换，则代码或设计可能有问题，您应该检查两者以消除强制转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T19:11:58.763

我同意 Neil Butterworth 的观点，这种情况下的演员阵容是不必要的，而且它是一种明确的“代码味道”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T19:09:39.720

据我所知，即使 BAR 是用 uint32 范围之外的值定义的，它也什么都不做。在我看来像噪音。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T19:19:08.403

如果不知道背景，我不能肯定地说，但看起来有人可能已经采用了一些现有的 C 代码并将其包装在 C++ 类中。演员表可能是 c 代码的剩余部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T22:02:22.283

我不确定这是否合法。演员表不是左值...

无论哪种方式，它看起来都毫无意义。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-03T18:43:55.490

如果您只想允许分配某些值（例如，对分配的检查就像对根据强制转换键入的​​变量一样进行，而不是让任何事情都通过，就好像您扩大了 rhs 一样）。

# apache - IIS 可以从 RAM 中提供最常用的静态文件吗？

> ID：715143
> 
> 赞同：1
> 
> 时间：2009-04-03T18:41:32.313
> 
> 标签：apache, iis, caching, webserver, windows-server-2008

我可以设置一个 IIS 服务器，以便它将最常用的静态文件（二进制）从磁盘缓存到 RAM 中，并根据请求从 RAM 提供服务吗？

更新：[Apache Caching Guide](http://httpd.apache.org/docs/2.2/caching.html#inmemory)中的[mod_mem_cache](http://httpd.apache.org/docs/2.2/mod/mod_mem_cache.html)似乎是我正在寻找的。IIS中有任何等效的东西吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:22:31.920

即使 IIS 实际上并未设置为自行执行缓存，对于仅从磁盘加载并通过网络发送的真正静态文件（即图像、.css、.js），您最终可能会使用Windows 本身内置的内存中文件缓存。在任务管理器中，您会注意到物理内存部分中的“系统缓存”指标；这显示了操作系统为缓存使用了多少空间。因此，只要您在谈论真正的静态文件，就不需要添加显式缓存。

编辑：
有关更多详细信息，这里有几个关于 Windows 缓存的链接（您可能可以通过 Google 找到更多信息）：

*   [http://msdn.microsoft.com/en-us/library/aa364218(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa364218(VS.85).aspx)
*   [http://support.microsoft.com/kb/895932](http://support.microsoft.com/kb/895932)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T19:02:30.970

IIS 应该已经这样做了。在 .Net 中，这就是输出缓存将为您做的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T19:18:49.993

这里有一点关于 IIS 6.0 的文件缓存：[http](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a0483502-c6da-486a-917a-586c463b7ed6.mspx?mfr=true) ://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a0483502-c6da-486a-917a-586c463b7ed6.mspx?mfr=true 。正如大卫所提到的，IIS 很可能已经为您做到了这一点。

[IIS 7.0 输出缓存](http://technet.microsoft.com/en-us/library/cc732475.aspx)

IIS 6.0 文件缓存行为包含在 IIS 7.0 输出缓存中。如果默认超时时间太短，您可以[定义自己的规则。](http://technet.microsoft.com/en-us/library/cc770547.aspx)[内核缓存](http://technet.microsoft.com/en-us/library/cc731903.aspx)利用了操作系统缓存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T18:45:29.810

如果您有大量 RAM，请设置 RAM 磁盘

[http://www.tweakxp.com/article37232.aspx](http://www.tweakxp.com/article37232.aspx)链接到一个免费的。让您的应用程序将相关文件复制到该驱动器并将您的 wwwroot 设置为指向该位置。

但是，此数据在两次启动之间并不安全。

我还运行一个大型 IIS 站点并提供大量静态文件。windows文件缓存很好，我在网络延迟方面遇到了更多问题。第一个字节的时间等我的磁盘永远不会绑定。但是如果你有一个已知的问题，ram disk 会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T18:46:23.783

Nate Bross 所说的可能是将它们保存在 ram 中的最可靠方法，假设 RAM 磁盘是在启动时从某个真实磁盘动态创建的。

*此外*，您可以为文件设置一个 asp.net 处理程序 (*.ashx) 以使用 ASP.Net 中内置的缓存。它会首先尝试从缓存中提供服务，并且仅在需要时才加载它们。这样做的好处是，如果文件可能偶尔更改，您可以不时轻松地使缓存过期，并允许 IIS 在它决定现在需要更多内存用于其他事情时重新声明该内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T19:00:45.293

在 ASP.NET 中：

```
Response.Cache.SetExpires(DateTime.Now.AddDays(1));
Response.Cache.SetCacheability(HttpCacheability.Public);
Response.Cache.SetValidUntilExpires(true); 
```

这就是说，不是 ASP 解决方案是最好的，而是 IIS 遵循缓存指令，可以选择缓存在 RAM 中。

但是，如果 ASP/ASP.NET 不是一个选项，我相信您可以在 IIS 管理管理单元中向 IIS 发出信号以缓存单个文件，方法是将内容到期时间设置为未来 1 天或更长时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T18:43:55.507

您可以设置一个 ram 驱动器，然后将文件移动到那里并在那里设置 IIS 虚拟目录。

# c++ - 创建 boost::graph edge_weight 属性映射

> ID：715144
> 
> 赞同：3
> 
> 时间：2009-04-03T18:41:37.587
> 
> 标签：c++, boost, graph-theory, boost-graph

使用带有捆绑属性的 boost::graph。我希望能够使用各种不同的可能边缘加权方案来运行搜索。如果可能的话，我不想为捆绑的属性创建一个额外的类，并根据搜索类型传递不同的权重图，而无需创建新图表或修改图表中的所有现有属性。

我可以为 edge_weight_t 手动构建 property_map 吗？这是我到目前为止所得到的：

```
typedef boost::property_map<SSPSGraph_t, boost::edge_weight_t>::type WeightMap;
typedef boost::property<boost::edge_weight_t, float> DistanceProperty; 
```

我只想能够做到

```
WeightMap distances;
edge_descriptor_t e = some_edge_or_another;
float d=some_derived_distance_value; 
```

并将距离[e]分配给适当的值——

```
distances[e]= ? 
```

还是我只需要分解并为捆绑的属性组成一个新结构——我一直试图避免的事情——并从中创建权重图？boost::graph 的新功能；不要假设我在这里没有做完全愚蠢的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T18:45:47.037

我不确定我是否理解你的问题。以下是一些可能对您有所帮助的提示：

boost::property_map，你用来定义 WeightMap 要求你在你的图表中添加相应的属性（你只做了定义 DistanceProperty 所需的一半）：

```
typedef boost::property<boost::edge_weight_t, float> DistanceProperty;

typedef boost::adjacency_list<boost::vecS, boost::vecS, boost::undirS, boost::no_property, DistanceProperty> MyGraph; 
```

如果这还没有完成， boost::property_map 无论如何都不会帮助你。

如果您不想为要尝试的每个不同方案添加不同的权重属性，则另一种方法是在图形定义之外定义此类属性。这可以做到 - 使用 std::map 和[boost::associative_property](http://www.boost.org/doc/libs/1_38_0/libs/property_map/associative_property_map.html)（这很简单，但具有地图的效率） - 使用[boost::vector_property_map](http://www.boost.org/doc/libs/1_38_0/libs/property_map/vector_property_map.html)，它更有效（感谢底层的 std::vector），但是需要一个标识符property_map，即一个property_map，它可以从提供的边缘中提取一个数字标识符（理想情况下在0和num_edges（）-1之间）。此 property_map 通常在图中定义。

如果我的回答对您没有帮助（或不够），请在您的问题中更准确一点，以便我更新我的答案！

# flash - 在 Flash 中拖动蒙版上的对象

> ID：715148
> 
> 赞同：0
> 
> 时间：2009-04-03T18:42:44.060
> 
> 标签：flash, actionscript-2, cs3

我在 Flash 中有一个小任务，我遇到了一些麻烦。

首先，我有 2 层。第一个是具有各种颜色的渐变，在此之上是第二层，这是一个形状补间（电影剪辑）。对于那些使用 CS4 的人来说，这是一个经典的补间。我正在使用 CS3 和 Actionscript 2

我已经完成了补间的形状，很简单，变成手里剑，回到圆形。

问题是，我需要对其进行编程，以便仅当我将鼠标移到圆圈上时才会发生这种情况。如果我将鼠标从圆圈/手里剑移开，它应该永远保持我离开该区域时的形状。因此，如果它是从圆圈到手里剑的一半，并且我将鼠标从该区域移开，它应该保持在中间的形式，而不是跳回圆圈。

其次，我需要能够拖动形状，并且在拖动它时，补间形状必须像正常情况下一样。释放它不会让它停止“补间”，只有在它的区域移动我的鼠标。渐变背景提供了不断变化的颜色的良好效果。

我已将形状补间命名为“circle_mc”。

我无法实现的：
1）形状对我的鼠标悬停做出反应
2）使形状可拖动。

有人可以给我一些提示，也许是关于此的文章或示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T19:20:45.700

如果我的操作正确，您应该能够在形状补间所在的“circle_mc”剪辑中放置类似于以下脚本的内容。这将允许您创建执行相同操作的剪辑的多个实例。我上传了一个测试供您检查。如果这根本不是你的意思，请告诉我。您还可以创建一个外部类用作图形的基类并将代码放在那里。

```
var hasRolledOver:Boolean = false;

this.onPress = function():Void
{
    this.startDrag();
}

this.onRelease = function():Void
{
    this.stopDrag();
}

this.onRollOver = function():Void
{
    if (!hasRolledOver)
    {
        this.gotoAndPlay(2);
        hasRolledOver = true;
    }
}

this.onRollOut = function():Void
{
    this.stop();
} 
```

[http://typeoneerror.com/media/as/test.fla.zip](http://typeoneerror.com/media/as/test.fla.zip)

# objective-c - 什么是花栗鼠？（除了是一个物理引擎）

> ID：715149
> 
> 赞同：3
> 
> 时间：2009-04-03T18:42:56.197
> 
> 标签：objective-c, cocoa-touch, cocos2d-iphone, chipmunk

希望这个问题不像我担心的那样愚蠢，但它可能仍然很愚蠢。

我是 Objective-C 和 Cocoa 的新手。事实上，总的来说，我对 C 完全陌生。我正在尝试使用[Cocos2d-iPhone](http://www.sapusmedia.com/cocos2d-iphone-api-doc/)实现 iPhone 游戏。这是我以前用 Flash 制作的游戏，所以我认为这将是一个很好的方法来学习 Objective C、cocoa 和 cocos2d。

我遇到的一个大问题是理解为什么所有的[Chipmunk](http://wiki.slembcke.net/main/published/Chipmunk)代码看起来都与所有普通的 Objective-C 代码不同。例如，有类似的东西

```
chipmunkBody->position.x 
```

我以为会是

`chipmunkBody.position.x`或者也许`[[chipmunkBody position] x]`（可能是坏例子）。

一直在咬我的一种方法是使用 cpVect。cpVect 非常重要，但我一生都无法弄清楚如何传递它。CGPoint，没问题，我可以制作指针，在方法中传递它们等等，但是第二次我使用 cpVect 代替，它是“欢迎来到 Errorville，填充你”。

所以这就是问题，Chipmunk 是什么，所以我可以开始了解更多关于使用它的信息。

谢谢-t

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T18:46:25.267

我没有使用过 Chipmunk，但它可能是用 C/C++ 编写的。这就是原因。

**编辑：**是的，它是用 C 语言编写的。

`chipmunkBody`是指向结构的指针，箭头运算符 ( `->`) 是通过 C 中指向结构的指针访问结构成员的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T02:42:49.930

如果您正在寻找一种通过 Objective-C 方式使用 Chipmunk 的简单方法，这里有一篇关于名为 SpaceManager 的 Objective-C 类的不错的小帖子：[http ://www.mobile-bros.com/?p= 126](http://www.mobile-bros.com/?p=126)

# javascript - Internet Explorer Javascript 性能问题

> ID：715158
> 
> 赞同：5
> 
> 时间：2009-04-03T18:46:14.673
> 
> 标签：javascript, internet-explorer, performance

Internet Explorer 中的 JavaScript 性能很差。那里没有消息。但是，有一些提示和技巧可以加快速度。例如，有这个[三](http://blogs.msdn.com/ie/archive/2006/08/28/728654.aspx) [部分](http://blogs.msdn.com/ie/archive/2006/11/16/ie-javascript-performance-recommendations-part-2-javascript-code-inefficiencies.aspx) [系列](http://blogs.msdn.com/ie/archive/2007/01/04/ie-jscript-performance-recommendations-part-3-javascript-code-inefficiencies.aspx)。我仍然发现自己无法从中获得体面的表现。也许你们中的一些人知道还能做什么，这样它会更快？

我想做的是用 Javascript 从头开始​​创建一个中等大小的表。比如说，300 行，每行 10 个单元格。在我的计算机上执行此操作大约需要 5-6 秒。好吧，当然，这是一个 5 岁的钻机，但这仍然太多了。这是我的虚拟代码：

```
<html>
  <body>
    <script type="text/javascript">
      function MakeTable(parent)
      {
        var i, j;
        var table = document.createElement('table');
        var insertRow = table.insertRow;
        for ( i = 0; i < 300; i++ )
        {
          var row = insertRow(-1);
          for ( j = 0; j < 10; j++ )
          {
            var cell = row.insertCell(-1);
            cell.innerHTML = i + ' -  ' + j;
          }
        }
        parent.appendChild(table);
      }
    </script>
    <div onclick="MakeTable(this);">Click Me!</div>
  </body>
</html> 
```

**补充：**嗯，显然字符串连接（使用array.join）是唯一的方法。嗯，当然很伤心。希望以“正确的”DOM方式来做。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T18:55:30.657

这是我在寻找答案时发现的一个有趣的链接：该页面使用五种不同的脚本/方法来生成表格。
根据他们的测试，使用字符串远远快于使用 DOM / Table 元素。 [http://www.quirksmode.org/dom/innerhtml.htm](http://www.quirksmode.org/dom/innerhtml.html) l

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:01:31.253

IE 性能问题的主要原因之一是 DOM 操作。您希望尽可能高效地进行 DOM 操作。这可以包括，根据您的情况（基准！）：

*   离线创建你的 DOM 结构；将顶级元素保留在文档之外（创建，但不附加），然后在准备好时将其附加到文档中，而不是在创建时将每个元素附加到 DOM 中
*   编写 innerHTML 而不是 DOM 操作

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-03T18:54:46.463

您可以尝试 'Duff's Device'：通过多次重复代码来展开循环：

```
for (var i = 0; i < count / 4; i++) {
  doSomething();
  doSomething();
  doSomething();
  doSomething();
} 
```

显然，这会在除以 4 时留下余数，原来的 Duff's Device 有一种巧妙的方法，即使用与循环混合的 switch 语句跳转到循环的中间。Javascript 不支持这一点，但您可以手动处理其余行。数字 4 也是随机的，数字本身可以通过性能测试得出。

另见： [http ://www.websiteoptimization.com/speed/10/10-3.html](http://www.websiteoptimization.com/speed/10/10-3.html)

# inheritance - 扩展现有的弹性组件

> ID：715162
> 
> 赞同：2
> 
> 时间：2009-04-03T18:46:40.943
> 
> 标签：inheritance, flex3, components, extend

这是一个非常基本的问题，但我似乎无法正确回答。

如果我想扩展现有组件，正确的方法是什么？例如，这个线程谈论它，但没有给出一个例子：[Flex DateChooser events for individual days?](https://stackoverflow.com/questions/710646/flex-datechooser-events-for-individual-days)

仅向组件的现有功能添加跟踪（“这是我的功能”）的简单示例将很有帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:59:45.513

制作扩展 ActionScript 中的 Button 组件的组件的简单示例：

```
package custom
{
   import mx.controls.Button;
   import flash.events.MouseEvent;

   public class CustomButton extends Button {

      public function CustomButton() {
         super();
      }

   override protected function clickHandler(event:MouseEvent):void {
      trace('clickHandler is overwritten!');
   }
} 
```

您可以像这样在 MXML 中输入组件：

```
<custom:CustomButton id=”customBtn” label=”Custom Button” /> 
```

希望对一些人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:51:57.517

使用[代理](http://livedocs.adobe.com/flex/3/langref/flash/utils/Proxy.html)。链接中的示例。

# nhibernate - 如何在 NHibernate 中执行 WHERE a*b = param1

> ID：715163
> 
> 赞同：0
> 
> 时间：2009-04-03T18:46:56.763
> 
> 标签：nhibernate

我需要在 NHibernate 中创建一个查询，该查询将搜索两列的乘积，如下所示：

其中 a*b = 参数 1

抛开效率不谈（假设我有很少的行或实际查询将有额外的条件来利用某些索引）我如何在 NHibernate 中做到这一点？该解决方案最好使用 DetachedCriteria。我知道我可以将本机 SQL 与 Expression.Sql() 一起使用，但还有其他更好的方法吗？我可以在 HQL 中执行此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:24:02.837

正如您所提到的，您可以使用 HQL 或 Expression.Sql 来执行此操作。HQL 支持许多不同的 SQL 表达式；请参阅[本节](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/queryhql.html#queryhql-expressions)。

例如：

```
session.CreateQuery("from test t where t.a * t.b = 4").List(); 
```

# asp.net - 设计决策 - Javascript 数组或 http 处理程序

> ID：715166
> 
> 赞同：1
> 
> 时间：2009-04-03T18:48:15.997
> 
> 标签：asp.net, javascript, ajax, json

我正在构建一个允许用户选择颜色和大小的网页。一旦他们选择了这些，我需要执行查找以查看库存是否存在并基于此更新一些 UI 元素。

我在想将所有单个产品数据放入多维 JavaScript 数组（任何页面实例只有 10-50 条记录）并围绕它编写一些客户端例程，这将是可行的方法，原因有两个。一是因为它使 UI 保持快速，二是因为它最大限度地减少了对服务器的回调。我担心这个解决方案是代码异味。

作为替代方案，我正在考虑使用更纯粹的 AJAX 方法来使用 HTTP 处理程序和 JSON，或者可能是两者的混合。我的问题是您对使用 ASP.Net 2.0 堆栈解决此问题的最佳方法有何看法？

[编辑]

我还应该提到，此页面将在 SharePoint 环境中运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T19:18:27.950

假设数据是静态的，我会投票选项#1。在 JavaScript 数组中存储和检索数据元素相对简单，并且完全在您的控制范围内。回调服务器会引入很多可能的故障点。此外，我认为将数据保存在页面中将需要更少的代码，并且对于对 JavaScript 有更基本理解的任何人来说都更具可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T19:43:11.183

我反对 Ajax 执行此类任务，并投票（并实施）第一个选项。

据我了解，如果 JS 部分是由您的服务器端编写的，您将不会产生[代码异味。](http://en.wikipedia.org/wiki/Code_smell)

从用户的角度来看，Ajax 是无线浏览的体验杀手，因为任何小故障或错误服务都会失败，或者只是将交互时间延长 20 倍（！）。

我在我的站点中实现了比您的记录更多的记录，并且用户喜欢它。由于我的一些用户使用互联网咖啡或可疑的酒店 wifi，否则它将无法正常工作。

此外，Ajax 使您的服务器与客户端交互代码更加复杂，IMO，这是 Web 编程中最棘手的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:51:03.617

到目前为止，我会选择你的第二个选项。只要 AJAX 调用没有在这种情况下执行长时间运行的进程，它就应该非常快。

我工作的应用程序使用 AJAX 和 HttpHandler 进行了大量工作，而且我们的调用执行速度很快。只需确保您最小化响应中返回的 JSON 的大小即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T18:54:33.267

选择你的第二个选项。如果涉及的项目很少，那么 AJAX 调用应该执行得相当好。您将使您的代码远离客户端，希望能防止客户端脚本可能导致的任何基于浏览器的问题，并拥有一个更干净的应用程序。

**编辑**

还要考虑客户端脚本可以由用户修改。如果用户的选择没有发生其他验证，这可能允许他们配置缺货的产品。

# jquery - jQuery mouseover 调用点击

> ID：715170
> 
> 赞同：2
> 
> 时间：2009-04-03T18:49:25.073
> 
> 标签：jquery, ajax, click, mouseover

jQuery 新手，但对它非常着迷并且非常喜欢它。但是，这个问题开始让我失望。非常感谢任何帮助。上周花了很多时间试图从中做出正面或反面。如果此问题之前已发布，我深表歉意。

我有一个产品清单。每个产品都包含在一个`<div>`. `<span>`每个 div 内部都有一个用于产品信息的浮动对象和一个`<a>`用于访问产品的相应 URL。此列表是使用 ASP.NET 以编程方式生成的。

```
<div id="prod1">
   <span id="infoProd1" class="prodInfo" />
   <a class="prodURL" href="url1">Name of product #1</a>
</div>
   :
   : 
```

不幸的是，我没有 URL，因为这只是在防火墙后面的开发平台中。该站点与下面的站点非常相似。我希望这有帮助。

```
+----------+------------------------------+
|  #prod1  |                              |
+----------+                              |   Each #prodNum div looks like:
|  #prod2  |    overlay and frame divs    |
+----------+       appear over here       |  +-- #prod1 -----------------+
|  #prod3  |     with product details     |  |               |           |
+----------+       only if .prodInfo      |  |  .prodURL     | .prodInfo | 
|          |         is clicked.          |  |               |           |
|    :     |                              |  +---------------------------+
|          |                              |   
+----------+------------------------------+ 
```

每个产品的信息（包括照片）都存储在数据库中。
根据用户在跨度（*即 prodInfo*）上的操作，所需的过程是：

*   **悬停**将显示一个带有一些产品信息和一些详细信息（例如价格）的小弹出窗口。
*   **点击**将显示（动画）一个半透明的叠加层和一个 <div id="frame"> 包含有关产品的所有信息，包括照片。

我在框架内有一个图像，单击该图像会隐藏覆盖/框架。
使用 jQuery Ajax 提取信息（包括照片）`$.get()`。
使用 jQuery，我能够在第一遍（第一次**点击**）中实现这一点。但是，在我关闭“框架”并隐藏叠加层，然后将**鼠标悬停**在任何“prodInfo”上之后，它会显示应有的小弹出窗口，但同时也会显示叠加层和“框架”，就好像我一样调用**click**。

这是两个事件的简化 jQuery 代码：

```
$(".prodInfo").mouseover(
  function(e) {   // function fired when 'moused over'
    var popupItem = $("#div_infoPopupItem");  // absolute positioned popup
    var prod = $(this).attr('id');
    var prd;

    popupInit(popupItem, e); // changes the top/left coords

    $.ajax({            
      type    : 'GET',
      url     : 'prodInfo.aspx',
      data    : 'id=' + prod,
      success :

        function(prodInfo, status) {
          var prodStr = '<b>No product name.</b>';

          prd = prodInfo.split('::');  // product info delimited by '::'
          prodStr = '<div class="popupInfo_head">' + prd[0] + '</div>' +
                    '<div style="margin:2px;">' + prd[1] + '</div>';
                    // and so on...

          popupItem.html(prodStr);
          return false;
        },
    error :
      function() {
        popupItem.html('Error in collecting information.');
      }
    });

    popupItem.animate({ opacity : .94 }, { queue:false, duration: 120 });
    return false;
  }
);

$(".prodInfo").click(
  function(e) {
    var prod    = $(this).attr('id');
    var frame   = $("#div_frame");
    var overlay = $("#div_overlay");
    var info;
    var img     = new Image();

    document.getElementById('div_frame').scrollTop = 0;
    $.get('prodInfo.aspx', { id: prod },
      function (result) {
        info = result.split(';;');     // name ;; status ;; description ;; price, etc.

        $(this).ajaxSuccess(
          function (e, request, settings) {
            img.src = 'prodImage.aspx?id=' + prod;
            img.id  = 'prodImg';

            //populate the frame with prod info
            $(img).load(function () {
              $("#prodInfoImage")
                  .css('background', 'transparent url("prodImage.aspx?id=' + prod + '") no-repeat 50% 50%');
              switch (info[1]) {
                case '0':
                    $("#prodStatus")
                        .removeAttr("class")
                        .addClass("status_notavail")
                        .text('Not available');
                        break;
                case '1':
                    $("#prodStatus")
                        .removeAttr("class")
                        .addClass("status_avail")
                        .text('Available');
                        break;
              } // switch

              $("#prodInfoDesc")
                  .empty()
                  .append(info[2]);
              $("#prodInfoExtra")
                  .empty()
                  .append(info[3]);

              $("#prodName").text(info[0]);
            }
          )
          .error(
            function() {
              return false;
            }
          );  // image load

          // animate overlay, frame and display product info
          overlay .animate({ top   : '0' }, { queue: false, duration: 280 })
                  .animate({ height: '100%' }, 280, '',
                    function() {
                      frame.animate({ opacity : .92 }, 320);
                      return false;
                    }
                  );
          return false;
          }
        );     // ajax success
      }
    );  // get
  }
); 
```

下面是位于框架内的“关闭”图像的事件定义。

```
$("#img_close").click(
  function (e) {
    $("#div_frame")
      .animate({ opacity: 0}, 100, '', 
        function() {
          $("#div_overlay")
            .animate({ top   : "50%" }, { queue: false, duration: 120 })
            .animate({ height: "0px" }, 120);
        }
      );

      return false;
  }
); 
```

如前所述，这只会在第一次点击之前按计划工作。在我单击*prodInfo* `span`并关闭框架/覆盖后，*prodInfo*上的下一个鼠标悬停实际上会调用鼠标悬停和单击（显示覆盖/框架）。

编辑：感谢所有回复的人。我将尝试使用您的每个建议对其进行调试。

编辑（2）： *Mahalo*给所有评论和回复的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:56:52.617

我无法完全想象您拥有的整个设置，但这是我首先想到的。这可能是事件冒泡的情况，将单击事件同时传递给关闭按钮和跨度。也许当您单击关闭事件时，跨度单击也可能触发，但框架被关闭事件隐藏。查看绑定函数以获取有关停止默认操作和事件冒泡的更多信息：http: [//jquery.bassistance.de/api-browser/#bindStringObjectFunction](http://jquery.bassistance.de/api-browser/#bindStringObjectFunction)

正如 Don 所提到的，示例 URL 肯定会有很大帮助！

编辑：

经过进一步检查，我认为这是您在 click() 事件中附加 ajaxSuccess 事件的方式。每当发出任何 ajax 请求时，它可能仍然处于活动状态并触发。

再次编辑：

我刚刚用我自己的代码测试证实了这一点，这似乎肯定是问题所在。事实上，每次点击它都会附加 ajaxSuccess 函数，所以如果你点击了五次，它就会执行五次该函数。由于 AJAX 请求是在 mouseover 事件中发出的，因此它还会触发先前附加的 ajaxSuccess 函数并显示您的叠加层和框架。

要解决此问题，请尝试以下操作：

代替：

```
 $.get('prodInfo.aspx', { id: prod },
  function (result) {
    info = result.split(';;');     // name ;; status ;; description ;; price, etc.

    $(this).ajaxSuccess( 
```

尝试：

```
 $.get('prodInfo.aspx', { id: prod },
  function (result, statusText) {
    info = result.split(';;');     // name ;; status ;; description ;; price, etc.

    if ( statusText == 'success' ) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T19:44:12.880

我要赌一把，并说问题是您在第一次鼠标悬停/单击时生成/显示弹出窗口，然后将其渲染为不透明。在第二次鼠标悬停时，看起来旧的 div 被抓住并再次可见。

除此之外，如果您可以提供一个链接到您遇到此问题的页面的 URL，我可以更深入地了解一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T20:21:17.207

问题可能是您没有隐藏鼠标悬停时单击时创建的内容。因此，当您再次将鼠标悬停时，您将显示第一个，但由于第一个现在包含单击事件项，因此它也显示它。您需要在鼠标悬停时隐藏单击事件项，因此它也不会显示。

# c# - 不安全上下文中的位图编辑 - 如何避免不稳定？

> ID：715172
> 
> 赞同：0
> 
> 时间：2009-04-03T18:50:24.803
> 
> 标签：c#, interop, bitmap, rendering, unsafe

我试图在不安全的上下文中使用位图，并且看到其中不稳定，例如，程序第一次运行但第二次失败。这是代码：

```
private static void RenderBitmap(Graphics g)
{
  const int width = 150, height = 150;
  using (Bitmap bmp = new Bitmap(width, height, 
    System.Drawing.Imaging.PixelFormat.Format24bppRgb))
  {
    Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
    System.Drawing.Imaging.BitmapData bmpData =
      bmp.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite, 
        bmp.PixelFormat);
    NativeMethods.RenderText(Graphics.FromImage(bmp).GetHdc(), bmpData.Scan0,
      "This works only first time round", "Segoe", 10, 
      new RGBA(255, 0, 0, 255), width, height);
    bmp.UnlockBits(bmpData);
    g.DrawImage(bmp, new Rectangle(width, height, width, -height));
  }
} 
```

看到这不起作用，我有几个问题。`RenderText`如果本机方法直接操作位图内存，我正在做的事情是否安全且正确？我`HDC`从位图获取的方式是否正确，还是应该使用`g`从绘图方法传递的参数？

我得到的错误是：

> " System.AccessViolationException 未处理 Message="尝试读取或写入受保护的内存。这通常表明其他内存已损坏。"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:14:36.137

该`NativeMethods.RenderRext`方法不能安全地处理位图数据，因为它不知道位图的扫描线有多宽，也不知道它是否倒置存储在内存中。这些症状表明该方法正在写入位图之外的内存，覆盖了您在应用程序中需要的其他内容。

该`BitmapData.Stride`属性具有该方法处理数据所需的信息。它包含以字节为单位的扫描线宽度，如果它为负数，则表示位图倒置存储在内存中。简单来说Scan0就是第一条扫描线的地址，Scan0+Stride就是第二条扫描线的地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:12:12.953

好吧，在经历了很多痛苦和折磨之后，我找到了一个解决方案：我没有传递一个要填充的内存缓冲区，而是传递了一个设备上下文（HDC）来渲染。到目前为止似乎工作！

感谢所有回答的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T19:14:16.587

也许这是一个愚蠢的问题，但是为什么不使用 .NET 附带的 TextRenderer 类而不是使用 p/invoke 呢？

```
TextRenderer::DrawText Method (IDeviceContext, String, Font, Point, Color) 
```

[http://msdn.microsoft.com/en-us/library/4ftkekek.aspx](http://msdn.microsoft.com/en-us/library/4ftkekek.aspx)

-Oisin

# ruby-on-rails - 在rails中将参数值作为查询字符串传递给redirect_to

> ID：715179
> 
> 赞同：30
> 
> 时间：2009-04-03T18:52:49.387
> 
> 标签：ruby-on-rails, ruby, redirect, query-string

这应该很简单，但我似乎找不到一个简单的答案。

如何将当前请求中的参数值传递给 redirect_to 调用？我有一些表单值想传递到 GET 重定向的查询字符串中

我想做类似的事情：

```
redirect_to @thing, :foo => params[:foo] 
```

并被发送到：

```
http://things/4?[foo][key1]=val1&[foo][key2]=val2 
```

谢谢！

另外-对于redirect_to :back 如何处理？

```
redirect_to :back, :foo => params[:foo] 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-04T13:49:41.213

“记录”形式[`redirect_to`](http://api.rubyonrails.org/classes/ActionController/Base.html#M000637)的第二个参数仅用于响应状态。您必须使用另一种形式的 redirect_to，例如“String”形式。例如：

```
redirect_to thing_path(@thing, :foo => params[:foo]) 
```

这将适用于`params[:foo]`您提到的嵌套参数。或者，正如 Drew 在下面评论的那样，您可以使用[polymorphic_url](http://api.rubyonrails.org/classes/ActionDispatch/Routing/PolymorphicRoutes.html)（或 _path）：

```
redirect_to polymorphic_path(@thing, :foo => params[:foo]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T01:19:47.427

添加到乔丹的答案：

如果您不知道`@thing`可能是什么类型的对象，可以使用通用`polymorphic_url`方法。这是当您传入一个对象时在内部调用的方法`redirect_to`。

# flash - XSL 和 Flash XML 中断转义

> ID：715180
> 
> 赞同：0
> 
> 时间：2009-04-03T18:53:03.643
> 
> 标签：flash, xml-encoding

我有一个在 Flash 中加载的 XSL 文件，其中包含以下代码段：

```
<xsl:text>&#x2022;</xsl:text> 
```

我这样加载它：

```
_root.brochure_xsl = new XML();
_root.brochure_xsl.onLoad = function() {
    _root.SendPdfXml();
}
_root.brochure_xsl.ignoreWhite = true;
_root.brochure_xsl.load(_root.appSettings.XmlDataLocation +"xml/brochure.xsl"); 
```

在事件中，我跟踪结果如下：

```
send_lv.XslContent = _root.brochure_xsl.toString();
trace(send_lv.XslContent); 
```

在结果跟踪中，它将片段转换为项目符号。

```
<xsl:text> 
```

*

```
</xsl:text> 
```

我希望它保持编码状态，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:59:00.573

这当然是一个编码问题。该`toString()`方法是可疑的，但您必须检查。你能逐个字符地转储 XML 的内容吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:00:53.547

如果您在 XML 中对其进行两次编码会怎样：

```
<xsl:text>&amp;#x2022;</xsl:text> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-22T15:18:44.670

通过不使用 XML 对象进行修复。相反，只使用了一个 URL 加载器。

# artificial-intelligence - 那里有什么样的人工智能工作？

> ID：715181
> 
> 赞同：19
> 
> 时间：2009-04-03T18:53:08.557
> 
> 标签：artificial-intelligence, neural-network, data-mining

在我的计算机科学学年中，我爱上了人工智能的许多方面。从专家系统、神经网络到数据挖掘（分类）。我想知道，如果我要专业地转变这种学术热情，那里有哪些与人工智能相关的工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T18:59:44.253

您会对使用基于 AI 的方法的领域数量感到惊讶。从优化工业控制、流程管理和优化，到业务规则和财务建模，再到文本分析、机器翻译、搜索引擎……

几乎在人类习惯于根据数据做出复杂决策的任何地方，现代电子通信和采集方法产生的数据量已经变得太多，没有软件就无法处理。而且只有“智能”（或至少不那么愚蠢）的软件才能处理数据的复杂性、规则的复杂性和众多的故障模式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T18:56:11.453

人工智能课程教授。;)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-03T18:56:55.867

对我来说最明显的答案是游戏。

我认为游戏对人工智能来说是一个非常有趣的挑战，因为你本质上是在[以一种有趣的方式](http://www.gamasutra.com/view/feature/3947/intelligent_mistakes_how_to_.php)玩[输](http://www.gamedev.net/columns/events/gdc2008/article.asp?id=1344)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T19:05:52.460

我知道我所在城市的一家软件公司正在使用作为工程硕士项目开发的人工智能来检测欺诈性银行/金融交易。这是很有趣的东西。他们寻找奇怪的经常性付款，或根据已知的恐怖组织比较帐号……等等。我不确定有多少人在做类似的工作，但我敢肯定，随着这些天金融机构的封锁，这些类型的应用程序将变得更加普遍（它正在为他们工作）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T19:16:17.973

除了直接应用——人工智能人通常也是天生的算法人，这种知识无处不在。

# monitoring - 分享你的小窍门/脚本/.conkyrc

> ID：715188
> 
> 赞同：-1
> 
> 时间：2009-04-03T18:54:45.560
> 
> 标签：monitoring, conky

我刚刚开始修改[conky](http://conky.sourceforge.net/)，我希望 StackOverflow 人群可以分享他们使用这个工具完成的一些很酷的事情。

专门针对开发人员的脚本和 .conkyrc 文件尤其值得一看。以开发人员为中心的功能的一些很好的例子是 repository-monitors 或 heck，甚至是监控 StackOverflow 的东西。

该功能实际外观的屏幕截图也将受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-17T12:05:15.333

我有一个旧的 AT 调制解调器，它可以识别连接到我的计算机的来电显示，因此它会记录来电，并将它们与我通讯录中的号码相匹配。我已经设置好显示日志中的最后几个条目。

（来电还会触发一个脚本，使用 osd_cat 在屏幕上显示通话详细信息，并暂停音乐播放器。）

除此之外，只是通常的天气预报和系统信息摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:38:44.363

这个链接今天刚刚出现在reddit上，有一些非常好的conky布局：[http ://www.linuxhaxor.net/2009/05/07/8-beautiful-conky-desktop-monitor-setup/](http://www.linuxhaxor.net/2009/05/07/8-beautiful-conky-desktop-monitor-setup/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-01T22:59:03.513

我刚刚编写了一个 bash/shell 脚本，它使用 grep 从 txt 文件中获取今天的电视节目。这是txt文件的格式：

```
Monday:
Family Guy (2nd May)

Tuesday:
House
The Big Bang Theory (3rd May)

Wednesday:
The Bill
NCIS
NCIS LA (27th April)

Thursday:
South Park

Friday:
FlashForward

Saturday:

Sunday:
HIGNFY
Underbelly 
```

这是保存在 ~/bin 中并可执行的 shell 脚本：

```
#!/bin/bash
MYDATE=$(date +%A)
grep -A10000 $MYDATE /path/to/to_watch/list.txt | grep -B10000 -m1 ^$ 
```

这是要添加到您的 .conkyrc 文件中的行（在“文本”下方）

```
$color${execi 3600 tv_today} 
```

我认为正则表达式/grep 的东西需要一些工作（它不喜欢 crlf 换行符）但它有效。

希望这能给一些人一些与 Conky 相关的酷东西的想法......

编辑 2010-05-02：

感谢用户 tiftik 为 bash 脚本提供了更优雅的 awk/regex 替换：

```
#!/bin/bash
awk '/^'`date +%A`':$/,/^$/ {if ($0~/[^:]$/) print $0}' /path/to/to_watch/list.txt 
```

# linux - 使用通过 RPM 交付的产品执行发布周期

> ID：715197
> 
> 赞同：0
> 
> 时间：2009-04-03T18:57:07.037
> 
> 标签：linux, build, release, rpm

我刚开始第一次使用通过 Linux RPM 机制而不是作为独立安装程序交付的产品，并意识到这会使测试/发布周期变得更加棘手。

当我与安装程序一起工作时，我们只需更改构建系统中的构建编号以将构建标记为测试或发布候选而不是开发快照，并告诉人们只安装候选构建以进行测试。使用 RPM 这样做的问题在于，如果我们更改编号系统，我们将破坏交付机制，安装的机器将无法再分辨出哪个是 RPM 的最新版本。

我想到的解决这个问题的最好方法是将候选 RPM 放在一个完全独立的 RPM 存储库中，但这也变得复杂，因为我们有多个 RPM 来自同一存储库，它们处于不同的发布周期，所以我们将尝试从新存储库中提取 RPM A 的候选发布版本，同时仍希望从开发存储库中获取 RPM B 的开发快照。

这对于 Linux 软件来说一定是一个非常普遍的问题，所以有人能告诉我最佳实践吗？提前致谢 .....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:08:48.863

Linux 世界中的一种常见方法是制定一个广泛宣传的版本号约定，以指示构建是开发还是发布。对于 Linux 内核本身，奇数点版本 (2.5, 2.7) 是开发版本，而偶数点版本 (2.4, 2.6) 是版本。

快速浏览[RPM 指南](http://rpm5.org/docs/rpm-guide.html)似乎表明使用这样的方案可能是最好的选择。

# tfs - 使用 TFS 编辑合并签入

> ID：715201
> 
> 赞同：1
> 
> 时间：2009-04-03T18:57:52.807
> 
> 标签：tfs

TFS 是否支持编辑/合并/签入模型？看起来我们必须使用源代码浏览器显式检查文件才能关闭只读位。我习惯于启用写入的文件，并且只需要在签入之前进行合并。支持那个型号吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:04:35.877

是的。确实如此。

右键单击 TFS 项目并选择 Team Project Settings > Source Control ... 从那里您可以启用多个签出。

也就是说，您仍然必须使用源代码管理资源管理器来签出文件；除非您使用 Visual Studio 编辑它，否则 VS 会自动检出该文件。

如果您需要在源代码管理资源管理器之外使用它，您可以下载 TFS Power 工具，该工具将上下文菜单添加到常规文件资源管理器以进行签入/签出 / 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-18T18:07:47.693

是的，但它不像 SVN 那样舒服，您仍然必须使用源代码管理资源管理器来签出文件，这将随着[TFS 11 和本地工作空间而改变](http://blogs.msdn.com/b/bharry/archive/2011/08/02/version-control-model-enhancements-in-tfs-11.aspx)

# c# - 在c#中显示一个类的消息框？

> ID：715206
> 
> 赞同：29
> 
> 时间：2009-04-03T18:59:40.727
> 
> 标签：c#, class, messagebox

如何让类与表单交互以显示消息框？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-03T19:03:07.833

```
using System.Windows.Forms;
...
MessageBox.Show("Hello World!"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-03T19:02:39.253

```
System.Windows.MessageBox.Show("Hello world"); //WPF
System.Windows.Forms.MessageBox.Show("Hello world"); //WinForms 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T19:01:37.587

试试这个：

```
System.Windows.Forms.MessageBox.Show("Here's a message!"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T19:01:27.010

```
using System.Windows.Forms;

public class message
{
    static void Main()
    {  
        MessageBox.Show("Hello World!"); 
    }
} 
```

# .net - 什么是指定可枚举 Windows 控件的接口？

> ID：715208
> 
> 赞同：1
> 
> 时间：2009-04-03T19:00:24.233
> 
> 标签：.net, winforms, interface, combobox, enumerable

我有一个方法可以验证组合框控件，如下所示：

```
Public Function ValidateComboBox(ByVal objMessageMode As Errors.MessageMode, ByVal cboInput As ComboBox) As Boolean

    Dim blnValidated As Boolean

    'no value--invalidate'
    If cboInput.SelectedValue Is Nothing Then
        Errors.InvalidateField(cboInput, Errors.errFieldBlank, Me.ErrorProviderPurchaseTag, objMessageMode)
        blnValidated = False

        'value--validate'
    Else
        Errors.ValidateField(cboInput, Me.ErrorProviderPurchaseTag)
        blnValidated = True
    End If

    Return blnValidated

End Function 
```

我想要的是能够将任何控件替换为实现“SelectedValue”对象行为的参数。有我可以指定的接口吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T19:09:24.820

[ComboBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.aspx)不实现接口，而是从抽象类[ListControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.listcontrol.aspx)继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T19:21:50.097

我不相信有。我创建了每种不同类型的控件实现的自己的接口（通常是 I(Product)Field，它还包含其他帮助信息）。然后，在验证中，我只是对此进行了验证；它不是世界上最好的设计，但它就像一种魅力。

请注意，这还涉及对每种类型的控件（编辑框、组合框等）进行子类化，但是，我通常已经将它们子类化用于其他目的，所以我不认为这是一个问题。

# vb.net - 是否可以在 VB.NET 中获取引用方法？

> ID：715216
> 
> 赞同：8
> 
> 时间：2009-04-03T19:01:36.977
> 
> 标签：vb.net

看这个例子：

```
''//file1.vb
Sub Something()
    ''//...
    Functions.LogInfo("some text")
    ''//...
End Sub

''//functions.vb
Sub LogInfo(ByVal entry as String)

    Console.WriteLine(entry)

End Sub 
```

我可以在 LogInfo 中获取名称“Something”吗？

抱歉这篇文章的简短性，我不知道如何正确地表达这个问题。我会根据需要澄清和详细说明。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T19:04:09.827

（编辑：删除了对自身的不必要使用[`StackTrace`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)- 如果您想打印出更多信息而不仅仅是一帧，这将很有用。）

您可以使用[`StackFrame`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.aspx)该类，但它非常昂贵（IIRC）并且由于内联而可能稍微不正确。

编辑：这样的事情：（NoInlining 是为了确保它的行为正常......）

```
Imports System.Diagnostics
Imports System.Runtime.CompilerServices

Public Class Test

    Shared Sub Main()
        Something()
    End Sub        

    <MethodImpl(MethodImplOptions.NoInlining)> _
    Shared Sub Something()        
        Functions.LogInfo("some text")
    End Sub

End Class

Public Class Functions

    <MethodImpl(MethodImplOptions.NoInlining)> _
    Public Shared Sub LogInfo (ByVal entry as String)
        Dim frame as StackFrame = new StackFrame(1, False)
        Console.WriteLine("{0}: {1}", _
                          frame.GetMethod.Name, _
                          entry)
    End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T19:07:47.650

看看[如何找到调用当前方法的方法？](https://stackoverflow.com/questions/171970/how-can-i-find-the-method-that-called-the-current-method).

翻译成VB（希望如此）：

```
Imports System.Diagnostics
''// get call stack
Dim stackTrace As New StackTrace()

''// get calling method name
Console.WriteLine(stackTrace.GetFrame(1).GetMethod().Name) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T19:09:06.460

您可以使用 StackFrame 或 StackTrace。但是由于内联，您的行为在发布版本与在调试器中运行时可能会有所不同。所以你的结果可能不是你所期望的：

C＃：

```
System.Diagnostics.StackFrame sf = new StackFrame(1);
sf.GetMethod().Name; 
```

VB：

```
Dim sf as new StackFrame(1)
sf.GetMethod().Name 
```

# 编辑

抱歉刚刚意识到您要求使用 vb.net。我编辑了我的回复，但 vb 语法可能不正确

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T08:52:50.500

System.Reflection.MethodBase.GetCurrentMethod.Name 做同样的事情，似乎更容易掌握

# c - 混合 Objective-C 和 C 的陷阱和陷阱是什么？

> ID：715219
> 
> 赞同：6
> 
> 时间：2009-04-03T19:02:05.760
> 
> 标签：c, objective-c

冒着过度简化的风险，我担心的事情可能会非常复杂，在混合 C 和 Objective-C 时我应该注意什么？

编辑：澄清一下，我以前从未使用过 C，我正在通过 Cocoa 学习 Objective-C。我也在使用Chipmunk Dynamics引擎，它是C。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T19:14:27.180

我会反过来说：您可能会冒着使简单得离谱的事情过于复杂的风险:-)

好吧，我有点油嘴滑舌。正如其他人所指出的，Objective-C 实际上只是 C 语言的最小扩展集。当您编写 Objective-C 代码时，您实际上是在编写 C。您甚至可以访问 Objective-C 运行时支持的内部机制使用作为语言一部分的一些方便的 C 函数（不......我不建议你实际这样做，除非你真的知道你在做什么）。

大约我唯一遇到过稍微棘手的时刻是当我想将 Objective-C 实例方法作为回调传递给 C 函数时。比如说，我正在使用一个纯 C 跨平台库，它具有接受回调的函数。我可能会从对象实例中调用该函数来处理一些数据，然后希望该 C 函数在完成后调用我的实例 BACK，或者作为获取额外输入等的一部分（C 中的常见范例）。这可以通过时髦的函数包装和我见过的其他一些创造性方法来完成，如果你需要这样做，谷歌搜索“用于 c 回调的objective-c 方法”或类似的东西会给你带来好处。

唯一的建议是确保您的对象适当地管理`malloc`它们创建的供 C 函数使用的任何手动编辑的内存。如果确实完成了，您将希望您的objective-c 类在dealloc 上整理该内存。

除此之外，请清除 C 上的任何参考并玩得开心！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T19:03:56.363

您不能“混合”C 和 Objective-C：Objective-C 是 C 的超集。

现在，另一方面，C++ 和 Objective-C...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T19:14:42.220

Objective C 是 C 的超集，所以它*不应该*冲突。

除此之外，正如[这里](https://stackoverflow.com/questions/715149/what-is-chipmunk-apart-from-being-a-physics-engine)所指出的，纯 C 具有不同的约定（显然，因为没有内置机制）来处理 OO 编程。在 C 中，对象只是一个带有函数指针的 (struct *)。

# c# - 结果中省略了excel中的第一项（DataSet，OleDB）

> ID：715220
> 
> 赞同：0
> 
> 时间：2009-04-03T19:02:10.737
> 
> 标签：c#, .net, excel, dataset, oledb

[样本.xlsx]

```
Column 0, Row 0 = "ItemA"    
Column 0, Row 1 = "ItemB"    
Column 0, Row 2 = "ItemC"    
Column 0, Row 3 = "ItemD" 
```

[应用]

```
DataSet dsData = new DataSet();    
string strConn = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=Sample.xlsx;Extended Properties='Excel 12.0;'";    
OleDbDataAdapter daGetExcel = new OleDbDataAdapter("SELECT * FROM [Sheet1$]", strConn);    
daGetExcel.Fill(dsData);        

foreach (DataRow row in dsData.Tables[0].Rows) 
{ 
    lbExcelData.Items.Add(row[0].ToString()); 
} 
```

`lbExcelData`是窗体上的 ListBox 控件。

[结果]

> “项目B”、“项目C”、“项目D”

[问题]

为什么第一项“ItemA”被忽略？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T19:04:10.403

对于 Excel，在连接字符串的扩展属性设置中设置 HDR=NO。

“提供者=Microsoft.ACE.OLEDB.12.0；数据源=Sample.xlsx；扩展属性='Excel 12.0;HDR=NO'”

[http://connectionstrings.com/excel-2007](http://connectionstrings.com/excel-2007)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T19:08:22.140

我相信在这种情况下您的连接字符串应该是：

```
string strConn = @"Provider=Microsoft.ACE.OLEDB.12.0;
    Data Source=Sample.xlsx;Extended Properties='Excel 12.0;HDR=NO;'"; 
```

# iphone - 如何将图像加载到自定义 UITableViewCell？

> ID：715224
> 
> 赞同：0
> 
> 时间：2009-04-03T19:03:01.390
> 
> 标签：iphone, uitableview

这是我需要做的：

将 66px x 66px 的图像加载到 MainViewController 表中的表格单元格中。每个 TableCell 都有一个独特的图像。

但是怎么做？我们会用`cell.image`吗？

```
cell.image = [UIImage imageNamed:@"image.png"]; 
```

如果有，在哪里？是否需要 if/else 语句？

为了加载每个单元格的标签，MainViewController 使用 NSDictionary 和 NSLocalizedString，如下所示：

```
 //cell one
    menuList addObject:[NSDictionary dictionaryWithObjectsAndKeys:
    NSLocalizedString(@"PageOneTitle", @""), kTitleKey,
    NSLocalizedString(@"PageOneExplain", @""), kExplainKey, nil]];

    //cell two
    menuList addObject:[NSDictionary dictionaryWithObjectsAndKeys:
    NSLocalizedString(@"PageOneTitle", @""), kTitleKey,
    NSLocalizedString(@"PageOneExplain", @""), kExplainKey, nil]]; 
```

...

```
 // this is where MainViewController loads the cell content
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
MyCustomCell *cell = (MyCustomCell*)[tableView dequeueReusableCellWithIdentifier:kCellIdentifier];

if (cell == nil)
{
cell = [[[MyCustomCell alloc] initWithFrame:CGRectZero reuseIdentifier:kCellIdentifier] autorelease];

} 
```

...

```
 // MyCustomCell.m adds the subviews
- (id)initWithFrame:(CGRect)aRect reuseIdentifier:(NSString *)identifier
{
self = [super initWithFrame:aRect reuseIdentifier:identifier];
if (self)
{
// you can do this here specifically or at the table level for all cells
self.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

// Create label views to contain the various pieces of text that make up the cell.
// Add these as subviews.
nameLabel = [[UILabel alloc] initWithFrame:CGRectZero]; // layoutSubViews will decide the final frame
nameLabel.backgroundColor = [UIColor clearColor];
nameLabel.opaque = NO;
nameLabel.textColor = [UIColor blackColor];
nameLabel.highlightedTextColor = [UIColor whiteColor];
nameLabel.font = [UIFont boldSystemFontOfSize:18];
[self.contentView addSubview:nameLabel];

explainLabel = [[UILabel alloc] initWithFrame:CGRectZero]; // layoutSubViews will decide the final frame
explainLabel.backgroundColor = [UIColor clearColor];
explainLabel.opaque = NO;
explainLabel.textColor = [UIColor grayColor];
explainLabel.highlightedTextColor = [UIColor whiteColor];
explainLabel.font = [UIFont systemFontOfSize:14];
[self.contentView addSubview:explainLabel];

  //added to mark where the thumbnail image should go 
  imageView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 66, 66)];
  [self.contentView addSubview:imageView];
}

return self;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T19:18:38.513

如果每个单元格的图像都相同，即它是该类型单元格的一部分，则可以使用 self.image = [UIImage imageNamed:"blabla"]; 在 MyCustomCell 的初始化中加载它。

否则，如果不同单元格的图像会有所不同，将其放在 tableView:cellForRowAtIndexPath 中会更合乎逻辑：

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-08T20:27:38.050

是的，不推荐使用 cell.image。在默认的 TableViewCell 中使用 imageview.image。我不确定为什么需要自定义单元格来执行标准 tableviewcell 已经完成的操作（标题、副标题和使用 UITableViewStyleSubtitle 的图像）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T22:44:16.147

现在可以了。你是对的，Seventoes，关于把它放进去`tableView:cellForRowAtIndexPath:`

`indexPath.row`是我想念的。工作结果是这样的：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        MyCustomCell *cell = (MyCustomCell*)[tableView dequeueReusableCellWithIdentifier:kCellIdentifier];

        if (cell == nil)
        {
            cell = [[[MyCustomCell alloc] initWithFrame:CGRectZero reuseIdentifier:kCellIdentifier] autorelease];

        }

if (indexPath.row == 1)
{
cell.image = [UIImage imageNamed:@"foo.png"];
}
else if (indexPath.row == 2)
cell.image = [UIImage imageNamed:@"bar.png"];
}
...
else
{
cell.image = [UIImage imageNamed:@"lorem.png"];
}

return.cell;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-26T20:48:31.120

一个更好的方法是 if-else mess 是以正确的顺序将图像推送到 NSMutableArray 上，然后使用

cell.image = [myImages objectAtIndex:indexPath.row];

# project-planning - 软件设计期...其他开发人员在做什么？

> ID：715225
> 
> 赞同：2
> 
> 时间：2009-04-03T19:03:04.057
> 
> 标签：project-planning

我是一名新的软件架构师/主管，为软件开发人员团队提出软件设计。我正在提出需求规范、接口头文件、visio 软件设计文档和构建计划等。

我的问题是：团队的其他成员在此期间做什么？我当然会让他们参与设计，但我们不需要整个团队都积极地致力于我一直在做的事情。

有没有适合新软件架构师的好书？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T19:10:40.683

一般来说，各个阶段是重叠的，所以在设计等过程中会有一些编码。除此之外还有很多事情要做。他们可能正在审查将要使用的不熟悉的技术，设置源代码控制系统，审查业务需求，审查您的文档以确保它们有意义且清晰。除了编程，还有很多其他的工作要做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T19:11:25.690

软件团队在负责设计时所做的工作因公司而异。在我的公司，我们尝试在开发人员完成其他项目或解决错误的同时进行设计。

我在开始一个全新项目时采用的另一种方法是让开发人员也参与设计工作 - 对需求有很好理解的人可以帮助您设计系统的较小部分并为它们编写规范。其他人可以在模型、框架上工作。这对于我在上一份工作中领导的小型软件团队（总共 4 名开发人员）来说效果很好。

我还发现让其他团队成员研究我不确定的部分（或者甚至验证我认为应该有效的事情确实有效）很有用，例如：

*   调查外部 API 是否提供我们需要的功能
*   编写小型概念证明或技术演示
*   创建一个 API 模型（头文件、接口或 REST 端点）来调查 API 看起来是否有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T19:13:50.443

停止做你所做的无用的事情，并开始使用它们进行编码！;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T19:14:38.913

如果与另一个正在进行的项目没有重叠，让他们参与进来就很好，也许可以通过让他们原型化并展示替代技术（API、框架、库等）的优缺点来进一步推动它。 .) 您的项目可以使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T20:29:17.500

正如其他人所说，您通常希望在项目的第一部分和第一次迭代期间有一个加速期。**你打算迭代地构建它，不是吗？**从一个核心团队开始（不超过 3-4 人，因为您将需要彼此进行大量沟通）来帮助您探索需求，获得**基本数据模型**，识别和设置任何**框架**，识别并设置**构建**和**测试**工具。一些编码活动通常发生在设计阶段：对于**UI 模型**，技术敏感区域**的超前原型**（无论你有什么风险都应该通过解释性编码来减轻：无论是**新技术**、未记录的**集成系统**接口或**不稳定的需求**）。

但是设计阶段的编码人员应该帮助设计，以获得他们的支持，并在第一次迭代期间帮助培训团队的其他成员。在此过程中，您的角色是确保主要的[非功能性需求](http://en.wikipedia.org/wiki/Nonfunctional_requirements)（例如，已知的、优先的、设计满足的以及可以测试的）。您还应该与项目负责人或其他负责人员配备和融资的人员合作，以勾勒出所需的迭代和人员配备水平。确保解决方案可以迭代构建，并旨在在第一次迭代期间仅实现一个基本结构，以建立信心并消除风险。（有时，您可以将主要风险推到第二次迭代，并将第一次迭代的重点放在信心和团队建设上。）

当然，请确保您没有设计每个细节。您应该能够在下一次迭代中使用每个设计工件（并在以后根据需要对其进行详细说明）。由于更改设计决策的成本很高，因此请尝试推迟它们。但是，有些会影响整个解决方案（例如，数据模型或您的安全方法），并且绝对必须至少预先概述。这不是瀑布。这只是不要闭上眼睛，并希望一个可行的架构会神奇地出现。

但是设计会在整个迭代过程中进行。只是你做的越少，对解决方案的影响就越小（除非你不走运......然后事情变得昂贵）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-02-24T10:42:29.003

作为一个新的软件架构师，我可以推荐一些帮助我理解架构师角色的书籍（但当然不是掌握它）：

*   Fundamentals of Software Architecture An Engineering Approach：
    这本书对软件架构及其许多方面进行了很好的现代概述，如果您是初学者或扩展您的知识，这是一个很好的起点。

*   实践中的软件架构：
    解释什么是软件架构，为什么它很重要，以及如何以规范和有效的方式设计、实例化、分析、发展和管理它。

*   软件架构师手册：
    本书将带您了解所有重要概念，从设计原则到您在软件架构职业生涯的各个阶段的不同考虑。它首先涵盖软件架构的基本原理、好处和目的。

*   Clean Architecture：A Craftsman's Guide to Software Structure and Design：
    了解软件架构师需要实现什么以及如何实现它，掌握基本的软件设计原则并了解设计和架构如何出错。

*   Software Architecture: The Hard Parts：
    一本高级架构书，通过这本书，您将学习如何批判性地思考分布式架构所涉及的权衡取舍。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T19:10:00.827

通常他们可以从事另一个项目，但是...

我让我的团队审查项目规范/要求，并整理出一个基本/初步结构，让他们已经在思考应用程序并解决具体问题。

当我们开会讨论计划时，他们已经知道项目是什么和需要什么，在某些情况下，他们提出了我可能错过或忽略的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T19:24:19.200

如果您的团队没有任何其他项目可做，请您团队中经验丰富的程序员提出原型，以便您可以根据客户的需求创建需求文档。

对团队中使用的技术不熟悉的程序员也可以利用这段时间来熟悉您的团队将开发项目所使用的技术。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T19:38:10.993

尽管现在为时已晚，但解决此问题的一个好方法是在架构师当前的项目结束之前将其转移。开始让他腾出 25% 的精力，然后在新项目开始前一两个月将他的精力提高到 75-100%（可能更多取决于有多少分析和客户互动）。

在一个微不足道的项目中（比如说 2 个人年），这可能没有必要，但如果有人至少在所有人都跳上船之前没有正确进行分析，那么任何比这更大的项目都可能最终陷入混乱。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T19:50:44.660

# 建筑师！=设计师

很有可能您的所有开发人员都可以帮助设计；让他们。建筑师不必成为“孤狼”，自己做所有事情。您列出了指导方针、原则和脚手架，粗略的布线，让您的开发人员充实细节——无论是绘制 Visio 图表还是构建原型以减少未知数/风险。

迁移到 Agile/XP 并远离瀑布方法，你会发现团队有更多的帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T20:17:28.263

在进行一般设计时，让程序员**创建概念验证**非常方便。尤其是系统的某些部分，如果它们不能按照您计划的方式工作，最终可能会成为阻碍，因此您可以考虑替代方案并调整设计。

这将帮助您在完全朝着某个方向前进之前做出正确的设计决策。

只是做一个设计，然后继续并开始编码是搞砸项目的肯定方法。你不会意识到你的设计是不可行的（或者只是很糟糕），直到你编码到一半，到那时进行彻底的改变已经太晚了。

您将在设计过程中浪费时间来缓解不存在的问题，并且在实施过程中您会遇到无法预料的问题。

# visual-studio-2008 - 在 Visual Studio 中创建项/项目模板

> ID：715228
> 
> 赞同：1
> 
> 时间：2009-04-03T19:03:23.777
> 
> 标签：visual-studio-2008

我试图弄清楚如何创建项目模板，但根据我目前遇到的在线文章，所有文章都指向文件菜单选项下的导出模板向导工具。我的问题是这个功能不存在，我似乎找不到它。

我正在使用 Visual Studio Team System 2008。

所以我想知道几件事。VSTS 2008 是否故意不包含此选项？或者您是否以不同的方式创建项目/项目模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:07:03.377

> 上述步骤之一提到单击“文件”菜单的“导出模板”选项，但您最初可能看不到它。在这种情况下：
> 
> *   右键单击菜单栏并选择“自定义...”
>     *   单击文件类别，然后单击“重新排列命令”
>     *   单击“添加...”按钮，然后在弹出的对话框中单击“文件”类别
>     *   向下滚动直到您看到“导出模板...”，然后突出显示它并单击确定。
>     *   使用“上移/下移”按钮将其放置在您想要的位置
>     *   单击“关闭”几次
> 
> 现在您可以使用“导出模板”，并且可以按照上述步骤操作！

*来源：* [MSDN：如何创建项目模板](http://msdn.microsoft.com/en-us/library/xkh1wxd8.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-18T20:21:54.520

使用 VS 2010，您可以做更多...您可以在此处获得完整的示例：[带向导的多项目模板：Visual Studio 2010 示例](http://vsix.codeplex.com/)

# mysql - MySql存储过程的参数与影响列同名，可以吗？

> ID：715229
> 
> 赞同：8
> 
> 时间：2009-04-03T19:03:37.003
> 
> 标签：mysql, stored-procedures

我有一个包含两列名称、值的序列表，并且我有一个存储过程，用于递增提供名称的值

```
DROP PROCEDURE IF EXISTS p_generate_sequence;
delimiter |
CREATE PROCEDURE p_generate_sequence (name VARCHAR(30))
BEGIN
    START TRANSACTION;
    -- Variable "name" equal to column "name", how to reference?
    UPDATE sequences_table SET value = value + 1 WHERE name = name;
    SELECT value FROM sequences_table WHERE name = name;
    COMMIT;
END |
delimiter ; 
```

请注意，该参数称为“名称”。

是否有任何方法可以使用与受影响表的列名同名的参数？

**注意：**我对更改参数的名称，甚至列的名称都不感兴趣，只是想知道它是否可能，以及如何。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T19:17:28.280

是的，通过别名限定您的表列。

例如

```
delimiter //
create procedure foo( id int )
begin
 select * from users u where u.id = id;
end
//

call foo( 123 ) 
```

返回用户 ID = 123

# python - python dict更新差异

> ID：715234
> 
> 赞同：6
> 
> 时间：2009-04-03T19:04:34.443
> 
> 标签：python, diff, dictionary

python是否有任何内置功能来通知dict更新时哪些字典元素发生了变化？例如，我正在寻找一些这样的功能：

```
>>> a = {'a':'hamburger', 'b':'fries', 'c':'coke'}
>>> b = {'b':'fries', 'c':'pepsi', 'd':'ice cream'}
>>> a.diff(b)
{'c':'pepsi', 'd':'ice cream'}
>>> a.update(b)
>>> a
{'a':'hamburger', 'b':'fries', 'c':'pepsi', 'd':'ice cream'} 
```

我正在寻找更改值的字典，如 a.diff(b) 的结果所示

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-03T19:23:17.783

不，但您可以将 dict 子类化以提供更改通知。

```
class ObservableDict( dict ):
    def __init__( self, *args, **kw ):
        self.observers= []
        super( ObservableDict, self ).__init__( *args, **kw )
    def observe( self, observer ):
        self.observers.append( observer )
    def __setitem__( self, key, value ):
        for o in self.observers:
            o.notify( self, key, self[key], value )
        super( ObservableDict, self ).__setitem__( key, value )
    def update( self, anotherDict ):
        for k in anotherDict:
            self[k]= anotherDict[k]

class Watcher( object ):
    def notify( self, observable, key, old, new ):
        print "Change to ", observable, "at", key

w= Watcher()
a= ObservableDict( {'a':'hamburger', 'b':'fries', 'c':'coke'} )
a.observe( w )
b = {'b':'fries', 'c':'pepsi'}
a.update( b ) 
```

请注意，此处定义的超类 Watcher 不会检查是否存在“真正的”变化；它只是指出发生了变化。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-05-25T12:02:03.867

## 一年之后

我喜欢以下解决方案：

```
>>> def dictdiff(d1, d2):                                              
        return dict(set(d2.iteritems()) - set(d1.iteritems()))
... 
>>> a = {'a':'hamburger', 'b':'fries', 'c':'coke'}
>>> b = {'b':'fries', 'c':'pepsi', 'd':'ice cream'}
>>> dictdiff(a, b)
{'c': 'pepsi', 'd': 'ice cream'} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T19:13:35.827

不，它没有。但是写一个字典diff函数并不难：

```
def diff(a, b):
  diff = {}
  for key in b.keys():
    if (not a.has_key(key)) or (a.has_key(key) and a[key] != b[key]):
      diff[key] = b[key]
  return diff 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T19:33:22.610

一个简单的差异函数很容易编写。根据您需要它的频率，它可能比 S.Lott 更优雅的 ObservableDict 更快。

```
def dict_diff(a, b):
    """Return differences from dictionaries a to b.

    Return a tuple of three dicts: (removed, added, changed).
    'removed' has all keys and values removed from a. 'added' has
    all keys and values that were added to b. 'changed' has all
    keys and their values in b that are different from the corresponding
    key in a.

    """

    removed = dict()
    added = dict()
    changed = dict()

    for key, value in a.iteritems():
        if key not in b:
            removed[key] = value
        elif b[key] != value:
            changed[key] = b[key]
    for key, value in b.iteritems():
        if key not in a:
            added[key] = value
    return removed, added, changed

if __name__ == "__main__":
    print dict_diff({'foo': 1, 'bar': 2, 'yo': 4 }, 
                    {'foo': 0, 'foobar': 3, 'yo': 4 }) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T19:33:08.540

```
def diff_update(dict_to_update, updater):
    changes=dict((k,updater[k]) for k in filter(lambda k:(k not in dict_to_update or updater[k] != dict_to_update[k]), updater.iterkeys()))
    dict_to_update.update(updater)
    return changes

a = {'a':'hamburger', 'b':'fries', 'c':'coke'}
b = {'b':'fries', 'c':'pepsi'}
>>> print diff_update(a, b)
{'c': 'pepsi'}
>>> print a
{'a': 'hamburger', 'c': 'pepsi', 'b': 'fries'} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T19:13:30.990

不是内置的，但您可以迭代 dict 的键并进行比较。不过可能会很慢。

更好的解决方案可能是构建更复杂的数据结构并使用字典作为底层表示。

# ocr - 用于文档 OCR/可读性的图像处理/增强算法？

> ID：715240
> 
> 赞同：9
> 
> 时间：2009-04-03T19:06:00.447
> 
> 标签：ocr

我正在寻找算法、论文或软件来增强传真、来自手机摄像头的图像以及其他类似来源的可读性和 OCR。

我主要对简单的增强感兴趣（例如，你可以使用 ImageMagick 做的事情），但我也对更复杂的技术感兴趣。我已经在与供应商交谈，所以对于这个问题，我主要是在寻找算法或开源软件。

进一步澄清：我不是在寻找 OCR 软件或算法；我正在寻找算法来清理图像，使其看起来对人眼更具可读性，并且可能用于 OCR。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T20:59:08.677

我在编写一些软件进行书籍扫描时遇到了类似的问题；漂浮在互联网上的是一个名为[pagetools](http://sourceforge.net/projects/pagetools/files)的程序，它使用称为 Radon 变换的相当聪明的数学技巧来拉直扫描的页面。

我还写了一个小程序，可以将页面上的空白区域变白；当 OCR 算法不必与背景噪声抗衡时，它们往往会做得更好。我所做的是寻找距离深色像素超过一个小半径的浅色像素，然后将它们提升为纯白色。

不过，已经有几年了，所以我手头没有确切的实现细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T22:22:08.650

一个简单的图像过滤器是“中值过滤器”，它是一种非常简单、易于实现的过滤器，可帮助清理扫描/拍摄的文本。 [http://en.wikipedia.org/wiki/Median_filter](http://en.wikipedia.org/wiki/Median_filter)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T19:32:33.597

根据要求，链接到维基百科：[光学字符识别](http://en.wikipedia.org/wiki/Optical_character_recognition)

微软研究院：[光学字符识别论文](http://research.microsoft.com/en-us/um/people/minka/papers/ocr.html)

CiteSeerX :[关于光学字符识别的论文](http://citeseerx.ist.psu.edu/search;jsessionid=CE7A66BBB7AEF2FC900FD2BCEE051491?q=optical+character+recognition&submit=Search&sort=rel)

# mysql - 此应用程序连接到数据库的最佳方式

> ID：715246
> 
> 赞同：1
> 
> 时间：2009-04-03T19:07:34.937
> 
> 标签：mysql, database, delphi

我有一个 Delphi 应用程序，它通过 TTimer 每 60 秒访问一个数据库（通常是 MySql）。该应用程序或多或少是一个无人值守的公告板。如果网络中断，应用程序需要继续运行并在连接恢复时连接回数据库。通常它可能是通过宽带传输的，因此连接可能并不总是最好的。

我正在使用 TAdoConnection 组件。它在应用程序启动时打开并保持打开状态。每当我需要进行新查询时，我都会将 Connection 设置为打开的 TAdoConnection。但是我发现如果网络中断，这不是很可靠。

在这种情况下连接到数据库的最佳方式是什么？我已经看到了可以将连接字符串直接构建到 TAdoQuery 中的方法。这是正确的方法吗？或者这是过度的资源密集型？有时我需要打开 5-10 个查询来获取所有信息。

或者如何在 TTimer.OnTimer 事件中执行此操作：

创建 TAdoConnection

进行所有查询

免费的 TAdoConnection

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T19:18:01.697

您应该使用单个 TAdoConnection 对象来避免为每个组件设置连接字符串。保持连接对象关闭并在需要访问数据时打开它。像这样的东西：

```
procedure OnTimer;
begin
  MyAdoConnection.Open;
  try
    // Data access code here
    ...
  finally
     MyAdoConnection.Close;
  end; 
end; 
```

您还可以放置另一个`try/except`块`MyAdoConnection.Open`来捕捉网络不可用的情况。

关于问题的第二部分，最好将所有数据访问组件放在需要运行数据访问过程时创建的数据模块中。然后，您可以将所有数据访问代码放在该数据模块中，并将其与其余代码分开。

您可以尝试在数据模块的 OnCreate 事件中打开连接，但在打开连接时要小心处理可能的异常。在 OnDestroy 事件中关闭连接。然后您可以像这样使用该数据模块：

```
procedure OnTimer;
var myDataModule : TMyDataModule;
begin
  myDataModule  := TMyDataModule.Create;
  try
    // Data access code here
    myDataModule.DoSomeDatabaseWork;
  finally
     myDataModule.Free;
  end; 
end; 
```

# algorithm - 出于好奇：序列号是如何生成的？提示，算法？

> ID：715251
> 
> 赞同：42
> 
> 时间：2009-04-03T19:08:49.363
> 
> 标签：algorithm, generator, validation, serial-number

我想知道序列号生成器和验证器是如何工作的。我的目标是生成一个由仅由数字和字母组成的五部分的序列号。

我喜欢将编码作为一种爱好，并且不会称自己为专业程序员。但是，我对这些有趣的功能如何在技术上发挥作用以拓宽我的思维非常感兴趣。

感谢任何提示、经验或书面算法。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-03T19:44:15.423

[Brandon Staggs](http://www.brandonstaggs.com/) wrote a good article on [Implementing a Partial Serial Number Verification System](http://www.brandonstaggs.com/2007/07/26/implementing-a-partial-serial-number-verification-system-in-delphi/). The examples are written in Delphi, but could be converted to other languages.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-03T19:18:54.907

好吧，传统上序列号是序列号。所以生产线下的第一个例子有sn 0001，然后下一个是0002，下一个是0003。我认为大多数人都可以计算出这个算法。

我认为您实际上是在询问产品密钥，它使用与公钥消息签名类似的机制 - 产品密钥是加密值，程序有一个公钥允许它验证密钥是否有效，但只有软件供应商拥有“签署”产品密钥的密钥。[关于数字签名](http://en.wikipedia.org/wiki/Digital_signature)的维基百科文章具有一般机制；唯一的附带条件是，对于用户输入的密钥，它必须比 PGP 的密钥短很多。

如果您被限制为非常短的序列号，那么它不太可能大到足以存储典型签名机制的结果，在这种情况下，只使用校验和的一些变体是很常见的。这具有易于逆向工程的缺点 - 它的安全性是因为算法是“秘密”的，而不是由于任何加密属性。每个产品都有自己的算法，它们通常很快就会被破解。

如果您有 5 个 5 个字符的块，则您有 36^25 个组合，大于 2^128，因此可以使用生成 128 位的标准数字签名算法之一，然后将该值转换为基数 36。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-03T19:25:14.753

给自己一个[公钥/私钥对](http://en.wikipedia.org/wiki/Public-key_cryptography)。生成具有某些识别特征（例如可被 10000 整除）的[序列号](http://www.research.att.com/~njas/sequences/)（10000、20000、30000、40000 ......）。使用您的私钥加密该号码。[使用一些人类可读的系统（ base 32](http://en.wikipedia.org/wiki/Base_32)或[64](http://en.wikipedia.org/wiki/Base64) ）对该值进行编码，并将这些值分成组，以便人们更容易解析。在每次销售您的应用时分发编码的序列号。

在应用程序的某个地方，您隐藏了公钥。当用户输入编码的序列号时，首先将其解码回二进制。使用公钥对其进行解密。检查它是否能被 10000 整除。

困难的部分是在实现中——将公钥隐藏在应用程序中，这样就不能轻易替换它。选择一些您可以轻松识别但不会用完值的序列。 [混淆](http://en.wikipedia.org/wiki/Obfuscated_code)应用程序，使某人无法轻易跳过整个检查。ETC...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-03T21:25:47.583

A GUID ("Globally Unique Identifier") could be an easy way to solve this:

[http://en.wikipedia.org/wiki/Globally_Unique_Identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)

Guids contain 16 bytes and are most commonly written in text as a sequence of hexadecimal digits such as:

```
3F2504E0-4F89-11D3-9A0C-0305E82C3301 
```

And most programming languages should be able to generate a GUID with one of the available libraries.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T19:43:01.463

您可以使用随机数生成器并将输出存储在数据库中。在激活请求的情况下，您只需检查序列号是否在数据库中并将序列号标记为“已使用”。

当然，这需要互联网连接，但不利于“一次购买，多次使用”的方法，如果需要支持，您可以重新激活该序列号以再次重新安装。

稍后编辑：您还必须使用加密和经过身份验证的连接进行 Internet 验证，例如 HTTPS 连接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T19:17:51.790

这里有很多信息：

[http://en.wikipedia.org/wiki/Luhn_algorithm](http://en.wikipedia.org/wiki/Luhn_algorithm)

[http://en.wikipedia.org/wiki/Check_digit](http://en.wikipedia.org/wiki/Check_digit)

# silverlight - 如何将 ® 翻译成 Silverlight 文本表示

> ID：715260
> 
> 赞同：1
> 
> 时间：2009-04-03T19:11:24.443
> 
> 标签：silverlight, text, binding, silverlight-2.0

我调用 Web 服务以获取绑定到 TextBlock 的 Text 属性的信息。有时，信息将包含 HTML 的编码特殊字符 - 最值得注意的是我认为 (r) 符号的 ®。silverlight TextBlock 只显示原始文本而不是 (r)。当然，我可以删除文本，但似乎这里有人会知道如何将这样的 HTMl 代码翻译成 TextBlock 可以理解的内容。我的第一个虽然是带有正则表达式替换的 iValueConverter？

有人做过其中之一吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:18:25.750

您只需要使用 HtmlDecode：

```
System.Windows.Browser.HttpUtility.HtmlDecode(yourStringHere) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:17:41.197

我相信你应该使用`&#174;`而不是`$#174;`. 我不确定 silverlight，但 WPF 会自动翻译这些文字。

我承认，如果 text 属性正在被数据绑定，我认为这不一定会起作用。如果是这种情况，那么 IValueConverter 就可以了。否则，您还可以在绑定值之前在对象中搜索/替换这些文字。这可以在您的 ViewModel 中完成（如果您正在关注 MVVM）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T19:18:31.163

在 HTML 中，像 > 这样的实体 用 ASCII 表示它们的十进制值，所以它就像用它的十进制值替换表达式一样简单。

我假设 $#174; 是一个错字，你的意思是 ®

# security - .htaccess 用于 IIS？

> ID：715264
> 
> 赞同：3
> 
> 时间：2009-04-03T19:12:22.007
> 
> 标签：security, iis, .htaccess

有没有办法直接在 IIS 中获得基于 URI 的访问控制，该控制与静态内容、ASP、WCF 服务和其他任何看起来像 HTTP 请求的东西一起工作？

特别是我希望访问控制尽可能地防弹，最好在IIS 甚至试图弄清楚用什么来服务请求*之前做出决定。*

*   [这个链接](http://techpatterns.com/forums/about458.html)有点暗示这不能完成，但它已经过时了，如果我正在寻找的东西不存在，我会感到非常惊讶。
*   [这个链接](http://ask.metafilter.com/66260/Easiest-way-to-get-htaccess-like-access-control-with-IIS-6)有一些其他的选择（和一个不那么“激进”的社区）

一个理想的解决方案是能够声明给定 URL（例如 ）下的所有内容（静态*和*`https://dns.name/some/path/*`动态内容）都需要登录，并且用户必须在某个组中。另外，我宁愿使用用户名/密码文件（至少现在）而不是 AD 或某些 Windows 帐户系统来设置它。

简而言之，我想要访问控制，我不想编写代码来获得它。

* * *

[这](https://stackoverflow.com/questions/257936/-htaccess-or-htpasswd-equivalent-on-iis)似乎相关，但我不确定它是否完全相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:14:31.767

您可以在 web.config 文件中设置 ASP.NET 或 WCF Web 应用程序的访问规则。

[如何：控制 ASP.NET 应用程序中的授权权限](http://support.microsoft.com/default.aspx/kb/316871)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T19:19:20.367

如果您有权访问 IIS 并且知道 .htaccess 语法，则可以使用[ISAPI_Rewrite 3](http://www.helicontech.com/isapi_rewrite/)。精简版是免费的。

# python - 如何遍历命令行上传递的所有文件行？

> ID：715277
> 
> 赞同：19
> 
> 时间：2009-04-03T19:15:37.287
> 
> 标签：python, stdin

我通常在 Perl 中这样做：

随便什么.pl

```
while(<>) {
    #do whatever;
} 
```

然后`cat foo.txt | whatever.pl`

现在，我想在 Python 中做到这一点。我试过`sys.stdin`了，但我不知道该怎么做，就像我在 Perl 中所做的那样。如何读取输入？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-03T19:17:06.643

试试这个：

```
import fileinput
for line in fileinput.input():
    process(line) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-03T19:19:50.320

```
import sys
def main():
    for line in sys.stdin:
        print line
if __name__=='__main__':
    sys.exit(main()) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T19:20:25.137

像这样的东西：

```
import sys

for line in sys.stdin:
    # whatever 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T19:20:46.247

```
import sys

for line in sys.stdin:
    # do stuff w/line 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-10-16T22:52:36.577

我讨厌打死马，但我可以建议使用纯函数吗？

```
import sys

def main(stdin):
  for line in stdin:
    print("You said: " + line.strip())

if __name__ == "__main__":
  main(sys.stdin) 
```

这种方法很好，因为 main 完全依赖于它的输入，您可以使用任何符合行分隔输入流范例的东西对其进行单元测试。

# java - 在java中将xml：base添加到xml文件

> ID：715287
> 
> 赞同：0
> 
> 时间：2009-04-03T19:18:22.880
> 
> 标签：java, xml, jena

我想将 xml:base 声明添加到 java 中的 xml 文件。我目前在由某些第三方代码生成的 OutputStream 中有 xml 输出。

文件开头是这样的：

```
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns="http://www.mycompany.com/myNS#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"> 
```

我希望它看起来像这样：

```
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns="http://www.mycompany.com/myNS#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xml:base="http://www.mycompany.com/myNS"> 
```

我一定是脑子里放了屁什么的，因为我想不出一个务实的好方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T17:12:07.207

您可以`xml:base`通过获取适当的 RDFWriter 并将其`xmlbase`属性设置为您选择的`xmlbase`. 下面的代码从一个字符串中读取一个模型（这个问题的重要部分是关于如何编写模型，而不是它来自哪里），然后用 RDF/XML 将其写入两次，每次使用不同的`xml:base`.

```
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.rdf.model.ModelFactory;
import com.hp.hpl.jena.rdf.model.RDFWriter;

public class ChangeBase {
    public static void main(String[] args) throws IOException {
        final String NS = "http://example.org/";
        final String text = "" +
                "@prefix ex: <"+NS+">.\n" +
                "ex:foo a ex:Foo .\n" +
                "ex:foo ex:frob ex:bar.\n"; 
        final Model model = ModelFactory.createDefaultModel();
        try ( final InputStream in = new ByteArrayInputStream( text.getBytes() )) {
            model.read( in, null, "TTL" );
        }
        // get a writer for RDF/XML-ABBREV, set its xmlbase to the NS, and write the model
        RDFWriter writer = model.getWriter( "RDF/XML-ABBREV" );
        writer.setProperty( "xmlbase", NS );
        writer.write( model, System.out, null );

        // change the base to example.com (.com, not .org) and write again
        writer.setProperty( "xmlbase", "http://example.com" );
        writer.write( model, System.out, null );
    }
} 
```

输出是（请注意，在第一种情况下，基数是`htttp://example.org/`，而在第二种情况下，它是`http://example.com`（区别是 .org 与 .com）：

```
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:ex="http://example.org/"
  xml:base="http://example.org/">
  <ex:Foo rdf:about="foo">
    <ex:frob rdf:resource="bar"/>
  </ex:Foo>
</rdf:RDF> 
```

```
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:ex="http://example.org/"
  xml:base="http://example.com">
  <ex:Foo rdf:about="http://example.org/foo">
    <ex:frob rdf:resource="http://example.org/bar"/>
  </ex:Foo>
</rdf:RDF> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-03T20:08:30.123

经过一番挖掘，这就是我所做的。

注意：我让第三方应用程序将 xml 写入 StringWriter 而不是名为“writer”的输出流。'outputStream' 是生成的 XML 将被写入的流的名称。

```
ByteArrayInputStream inputStream = new ByteArrayInputStream(writer.toString().getBytes());
Document myXML = 
     DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(inputStream);
myXML.getDocumentElement().setAttribute("xml:base", namespace);
Transformer transformer = TransformerFactory.newInstance().newTransformer();
StreamResult result = new StreamResult(outputStream);
DOMSource source = new DOMSource(myXML);
transformer.transform(source, result); 
```

我真的认为这会更容易。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-06T19:35:48.040

ByteArrayInputStream 不会针对大文件进行扩展，而且我不喜欢使用临时文件的想法。我还认为将整个文件加载到 DOM 中只是为了添加`xml:base`标签是矫枉过正的。

这是使用管道和简单的手动解析代码来添加标签的替代解决方案。

```
PipedInputStream pipedInput = new PipedInputStream();
PipedOutputStream pipedOutput = new PipedOutputStream(pipedInput);
new Thread(new ModelExportThread(model, pipedOutput)).start();
int bufferSize = 1024;
byte[] bytes = new byte[bufferSize];            
StringBuffer stringBuffer = new StringBuffer();
int bytesRead = pipedInput.read(bytes, 0, bufferSize);
boolean done = false;
String startRDF = "<rdf:RDF";
while (bytesRead > 0) {
    if (!done) {
        stringBuffer.append(new String(bytes, 0, bytesRead));
        int startIndex = stringBuffer.indexOf(startRDF);
        if ((startIndex >= 0)) {
            stringBuffer.insert(startIndex + startRDF.length(), " xml:base=\"" + namespace + "\"");
            outputStream.write(stringBuffer.toString().getBytes());
            stringBuffer.setLength(0);
            done = true;
        }
    } else {
        outputStream.write(bytes, 0, bytesRead);
    }
    bytesRead = pipedInput.read(bytes, 0, bufferSize);
}
outputStream.flush(); 
```

这是写入输出管道的线程代码。

```
public class ModelExportThread implements Runnable {

    private final OntModel model;
    private final OutputStream outputStream;

    public ModelExportThread(OntModel model, OutputStream outputStream) {
        this.model = model;
        this.outputStream = outputStream;
    }

    public void run() {
        try {
            model.write(outputStream, "RDF/XML-ABBREV");
            outputStream.flush();
            outputStream.close();
        } catch (IOException ex) {
            Logger.getLogger(OntologyModel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

} 
```

# database - 数据的生命周期是多久？

> ID：715299
> 
> 赞同：3
> 
> 时间：2009-04-03T19:19:38.043
> 
> 标签：database, lifetime

最近，我发现自己陷入了数据库混乱，管理层希望能够从数据库中删除数据，但仍希望该数据出现在其他地方。示例：他们想要删除产品 whizbang 的所有实例，但他们仍然希望 whizbang 出现在销售报告中。（如果他们在前一个日期运行了一个）。

现在我可以添加一个字段，比如 is_deleted，它将跟踪该产品是否已被删除，因此仍然保留我的所有引用，但在一段时间内，我有可能容纳大量死数据。（永远不会再次访问的数据）。如何处理这不是我的问题。

我很想知道，根据您的经验，数据的平均寿命是多少？也就是说，在被替换或删除之前，数据的平均存活时间或有效时间是多少？我知道这与您所存储的数据类型有关，但肯定所有数据都有某种寿命？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T19:25:27.327

数据永远存在……或者通常它应该存在。一种常见的做法是为记录设置结束和/或开始日期。因此，对于您的 whizbang，您有一个开始日期（这样它就不会在正式发布之前出现在销售报告中）和一个结束日期（这样它就会在生命周期结束后从报告中删除）。使用正确的日期作为您的报告和应用程序的标准，您不会看到 whizbang，除非您应该看到数据，并且数据仍然存在（理论上应该是无限的）。

正如 Koistya Navin 所提到的，在某个时间点将数据移动到数据仓库也是一种选择，但这在很大程度上取决于您的“旧”数据有多大，以及您需要多长时间保持它随时可供访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:49:52.837

我们的许多客户将数据在线保存 2 年。之后，它被移动到备份磁盘，但如果需要，它可以联机。

考虑添加一列“到期”或“生效日期”。这将允许您将产品标记为过时，但如果满足时间范围，报告将返回该产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T19:23:03.963

通常最好将这些数据移动到单独的数据库（数据库仓库）并保持工作数据库的清洁。在数据仓库中，您的数据可以保存多年而不会影响您的应用程序。

参考：维基百科的[数据仓库](http://en.wikipedia.org/wiki/Data_warehouse)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T19:23:56.223

我一直在寻找统治机构的目标。例如，美国国税局希望您保留 7 年的历史记录，或者出于安全原因，我们保留 3 年的日志信息等。所以我想您可以做两件事，确定您的数据的生命周期，我会说 3 年足够了，然后您可以添加 is_deleted 标志和日期，这样您就可以标记一些数据以尽早删除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T19:26:09.977

是的，所有数据都有生命周期。是的，它与您拥有的数据类型有关。

一些数据具有以秒为单位的生命周期（例如身份验证令牌），而另一些数据则具有虚拟永恒（比存储它的介质和格式更长，例如所有权记录）。

您将不得不更具体地了解您所设想的数据类型，或者在您自己的组织中进行人口普查以了解材料的通常生命周期。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T19:26:11.630

我们的特殊风味各不相同。我们有一些数据（绝大多数）在 3 个月后会失效（硬产品限制），但可以在以后的任何日期恢复。

我们还有其他数据实际上是不朽的。

在实践中，我们提供的大部分数据都是新鲜的，并且经常需要几周，最多一个月，然后才会被零星使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T19:26:21.363

“大量死数据”是多少？

由于处理能力和数据存储如此便宜，除非有充分的理由，否则我不会清除旧数据。您还需要考虑法律影响。大型（甚至小型）公司可能对旧数据有非常长的保留政策，以便在法官传唤他们时为自己节省数百万美元。

我会与您拥有的任何法律部门核实，并了解数据需要存储多长时间。这是最安全的赌注。

另外，问问自己删除旧数据有什么好处。唯一的好处是更整洁的数据库吗？如果是这样，我不会这样做。你会看到 10 倍的性能提升吗？如果是这样，我会这样做。不过，这确实是一个复杂的问题，我们很难掌握所有必要的信息来为您提供好的建议。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T19:27:24.497

我有几个项目，客户想要所有的历史数据（可以追溯到 19 年前）。相当多的旧数据格式不正确，导入新系统将是一场噩梦。我们说服他们，他们不需要 10 年后的记录，但就像你说的那样，这一切都与你所保存的数据类型有关。

附带说明一下，数据存储现在非常便宜，如果它不影响您的应用程序的性能，我会把它留在原处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T19:28:59.097

> [...] 但当然所有数据都有某种寿命？

没有任何一种我们可以有意义地谈论的寿命。许多数据一经创建或记录就毫无用处。这些数据可以立即丢弃而没有任何影响。另一方面，一些数据具有足够的价值，它将比托管它的当前系统寿命更长。如果亚马逊要完全替换他们当前的基础设施，他们存储的客户历史记录仍然非常有价值。

正如你所说，这是相对的。每种类型的数据都有自己的生命周期，与另一种数据的生命周期无关。没有有意义的“数据的平均寿命”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T19:33:33.967

> 我有存储大量死数据的潜力。（永远不会再次访问的数据）。

但是当他们执行这些报告时，他们会访问这些数据。

在此之前，您需要以某种形式保存数据。移动到另一张桌子或像您提到的那样进行切换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T19:52:16.090

呃...冒着过于简单化的风险...听起来使用 DateDeleted 而不是一点点可以解决您的保留时间问题。

# python - 如何使用 python 的 lxml 在我的 xml 文档中打印实体编号而不是实体名称？

> ID：715304
> 
> 赞同：4
> 
> 时间：2009-04-03T19:20:45.700
> 
> 标签：python, xml, lxml

我正在使用 lxml 和 python 生成 xml 文档（仅使用 etree.tostring(root) ），但目前生成的 xml 显示 html 实体与命名实体（ < ; ）而不是它们的数值（ < ; ） . 我究竟该如何改变它以使结果使用数值而不是名称？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T21:50:14.590

最终，看起来 python 代码将调用libxml2 库中的[xmlNodeDumpOutput](http://www.opensource.apple.com/darwinsource/WWDC2003/libxml2-3/libxml2/doc/html/libxml-tree.html#XMLNODEDUMPOUTPUT)。

不幸的是，看起来没有任何方法可以配置它来控制这些实体的表示方式。查看 xmlEncodeEntitiesReentrant 中的 entity.c，< > 和 & 字符被硬编码为始终使用适当的 XML 实体，因此似乎没有办法强制它使用数值。

如果您需要这个，您可能必须对字符串执行另一次传递，并`outputString.replace("&lt;","&#60;")`为这些字符手动执行“”。

# perl - WWW::Mechanize 和“HTTP::Message content must be bytes at...”

> ID：715306
> 
> 赞同：1
> 
> 时间：2009-04-03T19:20:53.547
> 
> 标签：perl, www-mechanize

我正在编写一个简单的程序，它必须更改波兰拍卖网站上的一些数据。

其中一个步骤涉及加载编辑页面、更改一个值并提交它。

可以在此处查看示例页面：http: [//depesz.com/various/new_item.php.html](http://depesz.com/various/new_item.php.html) - 这只是此类编辑页面的静态副本。

我的 perl 代码的相关部分：

```
$agent->form_number( 1 );
$agent->submit();
$agent->form_number( 1 );

my $q = $agent->current_form()->find_input( 'scheme_id' );
$agent->field('scheme_id', '1025');
# $agent->field('description', encode('utf-8', $agent->value("description")));
# $agent->field('location', encode('utf-8', $agent->value("location")));
# $agent->field('transport_shipment_description', encode('utf-8', $agent->value("transport_shipment_description")));
$agent->submit;
print $agent->response->decoded_content . "\n"; 
```

第一次提交后，我得到了我显示的页面。然后我将 scheme_id 字段中的值更改为 1025，并提交表单。

之后我得到：

```
HTTP::Message content must be bytes at /usr/local/share/perl/5.8.8/HTTP/Request/Common.pm line 91 
```

我试图在表单上的文本字段上重新编码值 - 因此 agent->field(... encode) 行，但它没有帮助。

目前我不知道表单上的什么会使 WWW::Mechanize 以这种方式失败，但我显然无法自行修复。

有没有办法调试这种情况？或者也许我应该做些不同的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T20:44:19.943

确保您的 LWP 和 WWW-Mechanize 模块是最新的。如果我没记错的话，LWP 在 2008 年底修复了一些编码问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T21:13:31.623

我也有同样的问题。解决它： `my $newcontent = encode('utf-8', $file);` 在发布内容之前！

谢谢，迈克

见[http://www.perlmonks.org/?node_id=647935](http://www.perlmonks.org/?node_id=647935)

# asp.net-mvc - MVC 中的模型

> ID：715307
> 
> 赞同：5
> 
> 时间：2009-04-03T19:21:20.067
> 
> 标签：asp.net-mvc, model-view-controller, data-modeling

我刚刚开始使用 ASP.NET MVC，试图首先了解这一理念。我想我很清楚控制器和视图所扮演的角色，但我对模型部分有点困惑。一些消息来源说它是域模型，有人说它是数据模型，有人说它是绑定到视图的对象。

恕我直言，这些是非常不同的事情。那么请有人可以一劳永逸地解决这个问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-03T19:25:28.713

模型是“应用程序操作的信息的特定领域表示”。这不仅仅是数据模型，因为它比 MVC 模式所考虑的级别更低，而且（例如）它是封装数据并让您对它们执行处理的类。

来自 MS 的 Scott Guthrie 在[他的公告](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)中使用了这个定义：

> 基于 MVC 的应用程序中的“模型”是负责维护状态的应用程序组件。通常这种状态会保存在数据库中（例如：我们可能有一个 Product 类，用于表示 SQL 中 Products 表中的订单数据）。

进一步阅读：

*   [MVC 维基百科](http://en.wikipedia.org/wiki/Model-view-controller)文章
*   [C2 上](http://c2.com/cgi/wiki?ModelViewController)的MVC 模式

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T19:29:59.110

我实际上喜欢添加一个额外的层以使事情更清晰。基本上，“模型”是特定于域的东西，并且知道如何自我持久化（假设持久性是域的一部分）。

IMO，我提到的另一层我称为 ViewModel ...有时，传递给视图的“模型”实际上与域无关...它将包含验证信息、用户显示信息等内容，用于在视图中显示的查找列表值。

我认为这就是你所面临的脱节:-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T19:31:33.723

当他们说它是域模型时，您的建议来源是正确的。在许多情况下，它也将与您的数据模型非常紧密地对齐。

域模型和数据模型的不同之处在于数据模型在形式（而非内容）上是相对静态的，而您的域模型添加了域的特定约束和规则。例如，在我的数据模型（数据库）中，我将血压表示为 smallints（收缩压和舒张压）。在我的*域模型中，*我有一个“血压读数”对象，它保存两个读数中的每一个的值，并且还对可接受值的范围施加了额外的限制（例如，收缩压的范围远小于 smallints 的范围）。它还增加了对这些值的定性判断（150/90 的 BP 为“高”）。

问题域的这些方面的添加使得域模型不仅仅是数据模型。在某些领域（例如，那些可以更好地使用完全面向对象的数据模型呈现并且在关系模型上映射不佳的领域），您会发现两者有很大的不同。但是，我创建的所有系统都具有非常高的重叠度。事实上，我经常通过存储过程、用户定义类型等将相当数量的域约束推送到数据模型本身。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T19:28:07.023

你应该看一下[这个](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)一步一步的教程。

来自其中一章：第 26 页

在模型-视图-控制器框架中，术语“模型”指的是代表应用程序数据的对象，以及与之集成验证和业务规则的相应领域逻辑。该模型在许多方面都是基于 MVC 的应用程序的“心脏”，我们稍后将看到它从根本上驱动它的行为。

希望它有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T19:31:33.223

例如，如果您正在建立一个网站来管理核电站的运营，那么模型就是工厂的模型，包含当前运行参数（温度等）的属性，启动/停止方法发电等。嗯……在这种情况下，模型实际上是真实工厂与孤立模式的投影，但你明白了。

# shell - 如何在 Debian postinst 脚本中获取新安装的版本？

> ID：715313
> 
> 赞同：11
> 
> 时间：2009-04-03T19:23:14.977
> 
> 标签：shell, debian, packages

根据[Debian Policy Manual](http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html)，我的 postinst 脚本在升级和配置时被调用，作为“postinst configure *old-version* ”，其中*old-version*是以前安装的版本（可能为 null）。我想确定*new-version*，即当前正在配置（升级到）的版本。

环境变量`$DPKG_MAINTSCRIPT_PACKAGE`包含包名；似乎没有等效的`_VERSION`字段。 `/var/lib/dpkg/status`在 postinst 运行后更新，所以我似乎也无法从那里解析它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T23:08:02.243

`.postinst`这是我发现解决此问题的最佳方法是在您的（或其他控制文件）中使用占位符变量：

```
case "$1" in
    configure)
        new_version="__NEW_VERSION__"
        # Do something interesting interesting with $new_version...
        ;;
    abort-upgrade|abort-remove|abort-deconfigure)
        # Do nothing
        ;;
    *)
        echo "Unrecognized postinst argument '$1'"
        ;;
esac 
```

然后在 中`debian/rules`，在构建时将占位符变量替换为正确的版本号：

```
# Must not depend on anything. This is to be called by
# binary-arch/binary-indep in another 'make' thread.
binary-common:
    dh_testdir
    dh_testroot
    dh_lintian
    < ... snip ... >

    # Replace __NEW_VERSION__ with the actual new version in any control files
    for pkg in $$(dh_listpackages -i); do \
        sed -i -e 's/__NEW_VERSION__/$(shell $(SHELL) debian/gen_deb_version)/' debian/$$pkg/DEBIAN/*; \
    done

    # Note dh_builddeb *must* come after the above code
    dh_builddeb 
```

在 中找到的结果`.postinst`片段`debian/<package-name>/DEBIAN/postinst`将如下所示：

```
case "$1" in
    configure)
        new_version="1.2.3"
        # Do something interesting interesting with $new_version...
        ;;
    abort-upgrade|abort-remove|abort-deconfigure)
        # Do nothing
        ;;
    *)
        echo "Unrecognized postinst argument '$1'"
        ;;
esac 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-22T21:34:26.973

```
VERSION=$(zless /usr/share/doc/$DPKG_MAINTSCRIPT_PACKAGE/changelog* \
     | dpkg-parsechangelog -l- -SVersion') 
```

与其他解决方案相比的优势：

*   无论更改日志是否压缩都有效
*   使用 dpkg 的 changelog 解析器代替正则表达式、awk 等。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-15T09:29:42.530

将以下内容添加到`debian/rules`：

```
override_dh_installdeb:
    dh_installdeb
    for pkg in $$(dh_listpackages -i); do \
        sed -i -e 's/__DEB_VERSION__/$(DEB_VERSION)/' debian/$$pkg/DEBIAN/*; \
    done 
```

它将`__DEB_VERSION__`用版本号替换您的 debian 脚本中出现的任何 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-13T19:00:14.170

我在 postinst 脚本中使用了以下有点脏的命令：

```
NewVersion=$(zcat /usr/share/doc/$DPKG_MAINTSCRIPT_PACKAGE/changelog.gz | \
  head -1 | perl -ne '$_=~ /.*\((.*)\).*/; print $1;') 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-16T08:12:59.837

当 postinst 运行时，所有的包文件都已经安装并且 dpkg 的数据库已经更新，所以你可以得到刚刚安装的版本：

```
dpkg-query --show --showformat='${Version}' packagename 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T20:45:16.480

为什么不能在打包时将版本硬编码到 postinst 脚本中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-14T12:10:22.137

尝试这个：

```
VERSION=`dpkg -s $DPKG_MAINTSCRIPT_PACKAGE | sed -n 's/^Version: //p'` 
```

# c# - 在 Windows Mobile 中管理网络状态的最佳方法

> ID：715318
> 
> 赞同：6
> 
> 时间：2009-04-03T19:24:16.797
> 
> 标签：c#, windows-mobile, compact-framework

我有一个 .NET Compact Framework 3.5 程序，用作“偶尔连接”的业务线 (LOB) 应用程序。如果它可以看到在线 Web 服务，它将使用该服务进行数据访问，但如果网络连接丢失，它将使用本地缓存。

处理所有连接选项和状态更改的最佳方式是什么？

*   OpenNetCF 的 ConnectionManager 类？
*   Microsoft.WindowsBile.State.SystemState？
*   API 调用？

您如何理解 WiFi、Cradle 和 GPRS 之间的区别并使用可用的最佳方法？

有人对此有任何指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T19:02:41.130

我只是创建一个简单的共享类，我可以这样调用：

```
If MyConnectionClass.IsConnected then
     'Do connected stuff
Else
     'Do local save
End If 
```

然后我所有的实际业务类/功能都可以使用它来从 UI 代码中隐藏这种讨厌的东西。

MyConnectionClass 的 IsConnected 属性将具有以下内容：

```
Public ReadOnly Property IsConnected As Boolean
   Get
    Try

        Dim HostName As String = Dns.GetHostName()
        Dim thisHost As IPHostEntry = Dns.GetHostByName(HostName)
        Dim thisIpAddr As String = thisHost.AddressList(0).ToString

        return (thisIpAddr <> Net.IPAddress.Parse("127.0.0.1").ToString())

    Catch ex As Exception
        Return False
    End Try
   End Get
End Property 
```

还建议您使用后台线程轮询连接状态，然后在状态更改时向主应用程序线程触发事件。下面是详细的写法：

[在 .NET Compact Framework 中测试和响应网络连接](http://msdn.microsoft.com/en-us/library/aa446548.aspx)

**编辑：**

现在，对于**GPRS**支持：

如果您使用 Web 请求或 Web 服务，框架将为您处理连接。如果您深入研究 TCPClient 或 UDPClient，则需要自己使用连接管理器 API 来处理它，如下所示：

```
public class GPRSConnection
{
    const int S_OK = 0;
    const uint CONNMGR_PARAM_GUIDDESTNET = 0x1;
    const uint CONNMGR_FLAG_PROXY_HTTP = 0x1;
    const uint CONNMGR_PRIORITY_USERINTERACTIVE = 0x08000;
    const uint INFINITE = 0xffffffff;
    const uint CONNMGR_STATUS_CONNECTED = 0x10;
    static Hashtable ht = new Hashtable();

    static GPRSConnection()
    {
        ManualResetEvent mre = new ManualResetEvent(false);
        mre.Handle = ConnMgrApiReadyEvent();
        mre.WaitOne();
        CloseHandle(mre.Handle);
    }

    ~GPRSConnection()
    {
        ReleaseAll();
    }

    public static bool Setup(Uri url)
    {
        return Setup(url.ToString());
    }

    public static bool Setup(string urlStr)
    {
        ConnectionInfo ci = new ConnectionInfo();
        IntPtr phConnection = IntPtr.Zero;
        uint status = 0;

        if (ht[urlStr] != null)
            return true;

        if (ConnMgrMapURL(urlStr, ref ci.guidDestNet, IntPtr.Zero) != S_OK)
            return false;

        ci.cbSize = (uint) Marshal.SizeOf(ci);
        ci.dwParams = CONNMGR_PARAM_GUIDDESTNET;
        ci.dwFlags = CONNMGR_FLAG_PROXY_HTTP;
        ci.dwPriority = CONNMGR_PRIORITY_USERINTERACTIVE;
        ci.bExclusive = 0;
        ci.bDisabled = 0;
        ci.hWnd = IntPtr.Zero;
        ci.uMsg = 0;
        ci.lParam = 0;

        if (ConnMgrEstablishConnectionSync(ref ci, ref phConnection, INFINITE, ref status) != S_OK &&
            status != CONNMGR_STATUS_CONNECTED)
            return false;

        ht[urlStr] = phConnection;
        return true;
    }

    public static bool Release(Uri url)
    {
        return Release(url.ToString());
    }

    public static bool Release(string urlStr)
    {
        return Release(urlStr, true);
    }

    private static bool Release(string urlStr, bool removeNode)
    {
        bool res = true;
        IntPtr ph = IntPtr.Zero;
        if (ht[urlStr] == null)
            return true;
        ph = (IntPtr)ht[urlStr];
        if (ConnMgrReleaseConnection(ph, 1) != S_OK)
            res = false;
        CloseHandle(ph);
        if (removeNode)
            ht.Remove(urlStr);
        return res;
    }

    public static void ReleaseAll()
    {
       foreach(DictionaryEntry de in ht)
       {
           Release((string)de.Key, false);
       }
       ht.Clear();
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct ConnectionInfo
    {
        public uint cbSize;
        public uint dwParams;
        public uint dwFlags;
        public uint dwPriority;
        public int bExclusive;
        public int bDisabled;
        public Guid guidDestNet;
        public IntPtr hWnd;
        public uint uMsg;
        public uint lParam;
        public uint ulMaxCost;
        public uint ulMinRcvBw;
        public uint ulMaxConnLatency;
    }

    [DllImport("cellcore.dll")]
    private static extern int ConnMgrMapURL(string pwszURL, ref Guid pguid, IntPtr pdwIndex);

    [DllImport("cellcore.dll")]
    private static extern int ConnMgrEstablishConnectionSync(ref ConnectionInfo ci, ref IntPtr phConnection, uint dwTimeout, ref uint pdwStatus);

    [DllImport("cellcore.dll")]
    private static extern IntPtr ConnMgrApiReadyEvent();

    [DllImport("cellcore.dll")]
    private static extern int ConnMgrReleaseConnection(IntPtr hConnection, int bCache);

    [DllImport("coredll.dll")]
    private static extern int CloseHandle(IntPtr hObject);
} 
```

要使用它，请执行以下操作：

```
public void DoTcpConnection()
    {
        string url = "www.msn.com";
        bool res = GPRSConnection.Setup("http://" + url + "/");
        if (res)
        {
            TcpClient tc = new TcpClient(url, 80);
            NetworkStream ns = tc.GetStream();
            byte[] buf = new byte[100];
            ns.Write(buf, 0, 100);
            tc.Client.Shutdown(SocketShutdown.Both);
            ns.Close();
            tc.Close();
            MessageBox.Show("Wrote 100 bytes");
        }
        else
        {
            MessageBox.Show("Connection establishment failed");
        }
    } 
```

这是来自 Anthony Wong 的博客：

[安东尼·黄](http://blogs.msdn.com/anthonywong/archive/2006/03/13/550686.aspx)

请记住，您只需要它来处理较低级别的 TCP 或 UDP 内容。HTTPRequests 不需要这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T08:54:48.253

在 Microsoft.WindowsMo​​bile.Status 命名空间中使用[SystemState类怎么样？](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.status.systemstate.aspx)您可以监控系统的当前状态并在状态更改时获取通知。有关一些代码，请参见这篇[文章](http://forum.soft32.com/pda/connection-type-ftopict63639.html)。

SystemState 仅与连接的状态有关。您可以通过 ConnectionManager 使用特定的连接。我推荐阅读这篇[文章](http://msdn.microsoft.com/en-us/library/bb840031.aspx)。如果您使用的是 .NET Compact Framework 3.5，则包含托管 API。您还可以使用 OpenNetCF ConnectionManager。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T22:31:21.713

我尝试编写移动应用程序，因此他们甚至不知道其中涉及到网络。我在本地保留足够好的验证数据，然后将事务写入本地队列，该队列在连接时清除；队列阅读器包含一个计时器，可在未连接时重试。队列消息是双向的，因此也可以提供本地刷新。基本消息队列模式。

这使我能够以最简单的方式处理网络连接，使用高度可移植的基本套接字打开/关闭/读取/写入/ioctl 逻辑；并且您的连接根本不需要持续很长时间。（我不想想象在过去几年中与所有 MS 架构变化保持同步需要什么 - 恕我直言，这仍然没有解决。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-21T00:58:54.403

我发现网络连接的 Microsoft.WindowsMo​​bile.State.SystemState 报告不可靠。这是 6.0 及更早版本。我没有进行详尽的测试，但是当它说没有连接时它被放弃了。

# java - 如何最有效地共享 log4j 库

> ID：715319
> 
> 赞同：1
> 
> 时间：2009-04-03T19:24:18.983
> 
> 标签：java, batch-file, jar

我有几个批处理 java 命令行应用程序，计划部署为：

```
batch_apps
  app_1
    batch1.jar
    run_batch1.sh
  app_2
    batch2.jar
    run_batch3.sh
{...etc...} 
```

组织共享库池的最佳实践是什么 - 例如 log4j：

```
batch_apps
  app_1
    batch1.jar
    run_batch1.sh
  app_2
    batch2.jar
    run_batch3.sh
  libs
    log4j.jar
    ojdbc.jar 
```

?

并在每个应用程序自己的 jar 文件中包含单独的 log4j.xml？我知道我需要在清单或 run_batchX.sh 中将“libs”添加到类路径中（哪种方式更可取？）

我最想知道什么是最有效的设置性能。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:30:39.810

在安装目录的根目录下拥有一个共享的 libs 目录绝对是要走的路。由于库将在内存中加载一次，因此当 JVM 启动时，无论您选择何种解决方案，都不会影响性能。

我不会将类路径放在 jar 文件中，因为如果您需要重新定位 lib 目录，这将迫使您更改 jar。编辑脚本要简单得多。

出于同样的原因，我也不会将 log4j conf 文件包含在您的 jar 文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:28:30.717

您的应用程序似乎不共享单个 JVM 实例。（即它们是通过'java -jar batch1.jar'或类似的东西单独启动的。）因此，共享库.jar文件只会为您节省磁盘空间而不是RAM。

**如果应用程序不共享单个 JVM**，那么易于部署应该优先于磁盘空间。（你的时间比几个“浪费”的 MB 更有价值。）

在这种情况下，我建议让每个应用程序都自包含，或者在一个包含所有库的单个 .jar 文件中，或者在一个包含 .jar 文件的文件夹中。（即将每个应用程序的库放在该应用程序的文件夹中。）

**如果应用程序共享单个 JVM**，那么我会推荐共享库文件夹选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T19:35:41.717

这并不能直接回答您的问题，但我已经尝试过您提出的方法，但现在将为每个应用程序创建一个 jar（请参阅如何[使用 Ant](https://stackoverflow.com/questions/515428/clean-way-to-combine-multiple-jars-preferably-using-ant/518072#518072)进行操作）。这样，无需在类路径中包含任何内容：

```
java -jar myApp.jar 
```

是你所需要的全部。我觉得它更干净，但一切都值得商榷。

从性能的角度来看，它没有任何区别，因为每个应用程序都在其自己的 JVM 中运行。

唯一的缺点是每个 jar 文件中都会出现一些库。存储在 HD 上只会花费更多，但是这些天，MB 非常便宜 :-) 我随时都在存储价格上交换简单性（没有外部 lib 文件夹）和没有 jar 地狱（不将你的 jar 放在 Java ext 文件夹中） . 如果您的应用程序不包含 TB 的库，我认为这很好。

对于 Log4j 配置文件，我会在 jar 中放置一个默认文件，但提供一个示例配置文件（`log4j-custom.xml.sample)`有人可以在命令行中修改和指定该文件：

```
java -Dlog4j.configuration=log4j-custom.xml -jar myApp.jar 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T19:44:16.983

您可以使用 java 扩展机制。将它们放在 JAVA_HOME/lib/ext 中，所有应用程序都可以访问它们。当然，这可能不是所有部署的最佳选择，但它肯定更容易。

# git - Git status - 有没有办法只在特定目录中显示更改？

> ID：715321
> 
> 赞同：158
> 
> 时间：2009-04-03T19:24:25.473
> 
> 标签：git, directory, status

如图所示，我想查看自上次提交以来修改的文件列表`git status`，但我只关心位于单个目录中的文件。有没有办法做到这一点？我试过`git status <directory>`了，但这似乎做了一些完全不同的事情（列出所有更改的文件，就像我`git add <directory>`先写的那样）。

git-status 的文档并没有说明太多，除了它接受与 git-commit 相同的选项（但 git-commit 的目的不是显示已更改文件的列表）。

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2012-12-14T15:36:22.517

从目录中：

```
git status . 
```

* * *

您可以真正使用任何路径，请使用以下语法：

```
git status <directoryPath> 
```

例如路径为“my/cool/path/here”的目录

```
git status my/cool/path/here 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-03T19:34:02.657

`git status`采用与 相同的选项的原因`git commit`是，目的`git status`是显示如果您使用与传递给相同的选项进行提交会发生什么`git status`。在这方面`git status`是真的`git commit --preview`。

为了得到你想要的，你可以这样做显示分阶段的变化：

```
git diff --stat --cached -- <directory_of_interest> 
```

这显示了未分级的更改：

```
git diff --stat -- <directory_of_interest> 
```

或者这个同时显示：

```
git diff --stat HEAD -- <directory_of_interest> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-03T19:30:00.153

最简单的解决方案：

1.  进入目录
2.  `git status | grep -v '\.\.\/'`

当然，这会丢弃颜色。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-14T07:46:34.190

请注意，如果您简化检查 git stats 而无需转到 git 目录；

```
### 创建文件
须藤纳米/usr/local/bin/gitstat

###把这个放进去

#!/usr/bin/env bash

目录=$1

如果 [[ $dir == "" ]]; 然后
    echo "需要目录！"
    出口
菲

echo "'$dir' 的 Git 统计信息。"

git --git-dir=$dir/.git --work-tree=$dir diff --stat

### 给执行权限
sudo chmod +x /usr/local/bin/gitstat

```

并调用那个简单的脚本：`gitstat /path/to/foo-project`. 你也可以在`foo-project`做的时候使用它`gitstat .`，所以假设比 短`git status -s`，`git diff --stat`或者`git diff --stat HEAD`如果你总是使用控制台而不是 gui。

学分：

*   @查尔斯·贝利：[https ://stackoverflow.com/a/715373/362780](https://stackoverflow.com/a/715373/362780)
*   [工作目录之外的 Git 状态](http://www.bubblefoundry.com/blog/2011/02/git-status-from-outside-of-the-working-directory/)

# php - 反转字符串中以空格分隔的单词的顺序

> ID：715330
> 
> 赞同：3
> 
> 时间：2009-04-03T19:26:17.823
> 
> 标签：php, string, reverse

反转字符串中以空格分隔的单词的顺序的最佳方法是什么？

```
Hello everybody in stackoverflow 
```

变成

```
stackoverflow in everybody Hello 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T19:29:59.937

试试这个：

```
$s = 'Hello everybody in stackoverflow';
echo implode(' ', array_reverse(explode(' ', $s))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T03:00:38.777

在散文中是：

*   首先将字符串变成单词数组

```
$words = explode(' ', $string); 
```

*   其次，反转该数组中元素的顺序

```
$reversed_string = implode(' ', array_reverse($words)); 
```

阅读 PHP 中的字符串和数组函数的完整列表非常有帮助，并且可以节省大量时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T19:30:52.587

上面的答案， strrev 反转整个字符串。要颠倒单词的顺序：

```
$str = 'Hello everybody in stackoverflow';
$tmp = explode(' ', $str);
$tmp = array_reverse($tmp);
$reversed_str = join(' ', $tmp); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T19:31:11.120

```
$tmp = explode(' ', $string);
array_reverse($tmp);
$string = implode(' ', $tmp); 
```

# java - JTable - 拖放

> ID：715332
> 
> 赞同：11
> 
> 时间：2009-04-03T19:26:44.513
> 
> 标签：java, swing, drag-and-drop, jtable

好的，这个问题超出了我的范围。我正在尝试在 swing 中实现一个 GUI 小部件，它允许将文件拖放到 JTable 上，并允许拖动 JTable 的行以进行重新排序。想想 VLC 的播放列表或 iTunes 中的播放列表。

我从操作系统（资源管理器、查找器等）中删除文件工作得很好，但是一旦文件进入，我就无法重新排列表的行。问题是当我添加一个自定义的 TransferHandler 到 table，*从*table 中拖动会立即被杀死。这是一些示例代码：

```
import javax.swing.*;

public class TableTest
{
    public static void main (String [] argv)
    {
        // setup table data
        String [] columns = new String [] {"Foo", "Bar", "Baz", "Quux"};
        String [][] data = new String [][] {{"A", "B", "C", "D"},
                        {"1", "2", "3", "4"},
                        {"i", "ii", "iii", "iv"}};
        // create table
        JTable table = new JTable(data, columns);

        // set up drag and drop
        table.setDragEnabled(true);
        table.setDropMode(DropMode.INSERT_ROWS);
        table.setFillsViewportHeight(true);
        TransferHandler dnd = new TransferHandler() {
            // here be code to handle drops, and one would
            // presume drag exporting, too
        };
        table.setTransferHandler(dnd);
        JScrollPane scroll = new JScrollPane(table);

        // create and show window
        JFrame window = new JFrame();
        window.getContentPane().add(scroll);
        window.pack();
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setVisible(true);
    }
} 
```

按原样运行此代码，您将看到无法在表格上启动拖动。如果您在表格上注释掉对 setTransferHandler() 的调用，则可以进行拖动（即，当我开始拖动表格行时，我得到X'd out 圆形光标说我不能放在那里）。但是一旦为表设置了 TransferHandler，我就不能拖动任何行。问题必须出在 TransferHandler 中，但我已经彻底解决并调试了它，并确定一旦桌子上有 TransferHandler 就永远不会开始拖动。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-03-03T23:35:54.973

我有同样的问题，它与您自定义的 TransferHandler 实现无关。当您替换 TransferHandler 时，您还需要获取默认的 DragSource 并告诉它识别拖动手势。您可能还需要实现自己的 Transferable，因为您需要将其传递给 DragGestureEvent.startDrag() 方法。

```
 table.setTransferHandler(new MyTransferHandler());
    table.setDragEnabled(true);
    DragSource source = DragSource.getDefaultDragSource();
    source.createDefaultDragGestureRecognizer(table, DnDConstants.ACTION_COPY, new DragGestureListener() {

        @Override
        public void dragGestureRecognized(DragGestureEvent dge) {
            //grab the selected files from the table model
            ArrayList<File> files = new ArrayList<File>();
            for (int row : table.getSelectedRows()) {
                files.add((File) dm.getValueAt(row, 1));
            }

            //FileTransferable is a custom Transferable implementation
            Transferable transferable = new FileTransferable(files); 

            //and this is the magic right here
            dge.startDrag(null,transferable);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T19:16:18.797

您似乎没有正确使用 TransferHandler 。尝试通读本[教程](http://java.sun.com/docs/books/tutorial/uiswing/dnd/intro.html)。

[请参阅此处](http://java.sun.com/javase/6/docs/api/javax/swing/TransferHandler.html)的 TransferHandler 文档。空构造函数看起来不像是要在 TransferHandler 的子类之外使用。

而且您没有实现 Swing 组件上提供的标准 TransferHandler 中提供的任何功能。[请参阅此处](http://java.sun.com/docs/books/tutorial/uiswing/dnd/transferhandler.html)DnD 教程的摘录（我的粗体字）：

> 注意：如果您将自定义 TransferHandler 安装到 Swing 组件上，则会替换默认支持。例如，如果您将 JTextField 的 TransferHandler 替换为只处理颜色的，您将禁用它支持文本导入和导出的能力。 **如果您必须替换默认的 TransferHandler（例如，处理文本的），您将需要重新实现文本导入和导出功能。这不需要像 Swing 提供的那样广泛——它可以像支持 StringFlavor 数据风格一样简单，这取决于您的应用程序的需要。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T19:26:01.363

我认为问题在于空的 TransferHandler 实际上阻止了 DnD 事件的发生。这里有一个样本可能是相关的。

[http://www.java2s.com/Code/Java/Swing-JFC/ExtendedDnDDragandDropDemo.htm](http://www.java2s.com/Code/Java/Swing-JFC/ExtendedDnDDragandDropDemo.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-22T13:29:28.797

我不想深入了解正在发生的事情，所以我只是将我不感兴趣的方法委托给旧的 TransferHandler。

```
tree.setDragEnabled(true);
tree.setDropMode(DropMode.XXXX);
tree.setTransferHandler(new MyTransferHandler(tree.getTransferHandler()); 
```

从标准设置开始，但将旧的 TransferHandler 传递给您的自定义 TransferHandler。

```
private class MyTransferHandler extends TransferHandler {
  private TransferHandler delegate;

  public MyTransferHandler(TransferHandler delegate) {
    this.delegate = delegate;
  }

  public boolean canImport(JComponent comp, DataFlavor[] transferFlavors) {
    return delegate.canImport(comp, transferFlavors);
  }

  public boolean canImport(TransferSupport support) {
    return true;
  }

  protected Transferable createTransferable(JComponent c) {
    try {
      Method method = delegate.getClass().getDeclaredMethod("createTransferable", JComponent.class);
      method.setAccessible(true);
      return (Transferable) method.invoke(delegate, c);
    } catch (Exception e) {
      return super.createTransferable(c);
    }
  }

  public void exportAsDrag(JComponent comp, InputEvent event, int action) {
    delegate.exportAsDrag(comp, event, action);
  }

  protected void exportDone(JComponent source, Transferable data, int action) {
    try {
      Method method = delegate.getClass().getDeclaredMethod("exportDone", JComponent.class, Transferable.class,
          int.class);
      method.setAccessible(true);
      method.invoke(delegate, source, data, action);
    } catch (Exception e) {
      super.exportDone(source, data, action);
    }
  }

  public int getSourceActions(JComponent c) {
    return delegate.getSourceActions(c);
  }

  public Icon getVisualRepresentation(Transferable t) {
    return delegate.getVisualRepresentation(t);
  }

  public boolean importData(JComponent comp, Transferable t) {
    return delegate.importData(comp, t);
  }

  public boolean importData(TransferHandler.TransferSupport support) {
    return delegate.importData(support);
  }
} 
```

一个问题是 createTransferable(JComponent) 和 exportDone(JComponent, Transferable, int) 方法受到保护，因此您需要进行反射才能委托给这些方法。当我没有做这个反射委托时，这个策略就不起作用了。一旦我完成了这个委托，拖放就可以按预期工作，而无需更改 DragSource 或编写新的 Transferable。

# ajax - Ajax 中的 GET 与 POST

> ID：715335
> 
> 赞同：81
> 
> 时间：2009-04-03T19:28:06.150
> 
> 标签：ajax, semantics

**Ajax**请求的**GET**和**POST**有什么区别？

 **我看不出这两者之间有什么区别，除了当我使用**GET**时，参数是在 URL 中发送的，这对我来说并没有什么区别，因为所有请求都是在后台发出的，而用户没有找到任何不同之处。

编辑：什么是**PUT**和**DELETE**方法用于？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-04-03T19:31:13.367

GET 是为从服务器获取数据而设计的。POST（以及鲜为人知的朋友 PUT 和 DELETE）是为修改服务器上的数据而设计的。

GET 请求绝不应该导致从应用程序中删除数据。如果你有一个链接，你可以点击一个 GET 来删除数据，然后谷歌爬取你的网站可以点击你所有的“删除”链接。

规范的答案可以在[这里](http://www.cs.tut.fi/~jkorpela/forms/methods.html)找到，它引用了 HTML 2.0 规范：

> 如果表单的处理是幂等的（即它对世界状态没有持久的可观察影响），那么表单方法应该是 GET。许多数据库搜索没有明显的副作用，是查询表单的理想应用。
> 
> 如果与处理表单相关的服务有副作用（例如，修改数据库或订阅服务），则方法应该是 POST。

在您的 AJAX 调用中，您需要使用服务器支持的任何方法。您应该始终设计您的服务器，以便通过 POST/PUT/DELETE 调用修改数据的操作。其他评论有指向 REST 的链接，通常将 C/R/U/D 映射到“POST 或 PUT”（创建）/GET（读取）/PUT（更新）/DELETE（删除）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-03T19:30:56.313

如果您通过 HTTPS 发送大量数据或敏感数据，您将需要使用 POST。如果它只是一个简单的参数，我会使用 GET。

GET 请求对可以发送的数据量有限制。我忘记了确切的数字，但是如果您发送任何实质性内容，这可能会导致问题。

基本上 GET 和 POST 之间的区别在于，在 GET 请求中，参数在 URL 中传递，而在 POST 中，参数包含在消息正文中。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-03T19:33:47.570

它的 AJAX 与否无关紧要。它与您正在采取的行动有关。我建议遵循[REST](http://en.wikipedia.org/wiki/REST)的原则。其中对更新，删除等有进一步的规定......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T20:53:28.753

GET 请求更容易在 CSRF（跨站请求伪造）攻击中被利用。即虚假的 POST 请求需要在用户端启用 Javascript，而虚假的 GET 请求仍然可能仅使用 img、script 标签。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T19:33:54.340

许多 Web 服务器限制了可以作为 URL 的一部分传递的数据的长度，因此 GET 请求可能会以难以调试的奇怪方式中断。

此外，大多数服务器软件在访问日志中记录 URL，因此如果您在 GET 请求中传递敏感信息（例如密码），这很可能会以明文形式写入磁盘。

从 REST 的角度来看，GET 请求应该没有副作用——它们不应该修改数据。因此，如果您只是通过 ID 获取资源，这是有道理的，但如果您正在提交对资源的更改，您应该对 http 动词使用 PUT、POST 或 UPDATE。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-27T08:25:39.733

两者都用于发送一些数据并使用该数据接收一些响应。

GET：获取服务器中的信息存储。IE。搜索、推文、个人信息。如果要发送信息，则使用 process.php?name=subroto 获取请求发送请求所以它基本上通过 url 发送信息。网址不能处理超过 2083 个字符。所以对于博客文章，你能记得这是不可能的吗？

POST：发布与获取相同的操作。用户注册、用户登录、大数据发送、博文。如果您需要发送安全信息，请使用 post 或大数据，因为它不通过 url。

AJAX：$.get() 和 $.post() 包含的特征是 $.ajax() 的子集。它有很多配置。

$.get() 方法，是 $.Ajax() 的一种简写。使用 $.get() 时，不是传入对象，而是传入参数。至少，您需要前两个参数，即您要检索的文件的 URL（即“test.txt”）和一个成功回调。

概括：

```
$.get( url [, data ] [, success ] [, dataType ] )
$.post( url [, data ] [, success ] [, dataType ] ) // for sending secure or Large information
$.ajax( url [, settings ] )  // More Configaration 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-10T20:03:33.120

首先，一般信息。`GET`仅在读取数据时使用，`POST`在更改数据库、txt 文件等内容时使用。

但问题是，某些浏览器会缓存`GET`结果。我在 IE7 中遇到了`AJAX`请求问题，但最后我发现浏览器缓存了`GET`结果。我重新考虑了流程并将我的请求更改为`POST`.

`GET`因此，如果您不想缓存，请不要使用。

（当然你可以在 GET 操作中禁用缓存。但我不喜欢它）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T20:03:05.253

关于我，我更喜欢 POST。我保留访问我知道发送的值仅限于我拥有“控制”的数据的事件，例如，检索具有 id 的项目。例如，“getitem?id=123”、“deleteImtem?id=123”、... 对于其他情况，当我有一个可由用户填写的表单时，我更喜欢 POST。

就像 Ryan Smith 所说的，最好使用 POST 发送大量数据，并且在使用其他语言/特殊字符的情况下少担心（通常所有专业的 javascript 框架应该没有任何问题来处理，但是我认为使用 POST 的担忧更少）。

在我看来，从 REST 角度来看，您可以将其用于新项目（以保持与整个项目的一致性）。

最后，也许网络中使用的一些程序（URL 记录器（即：查看员工是否在非自动化站点上浪费时间，...）代理，...）或任何其他类型的工具可以拦截查询. 有些人会在报告中显示您使用 GET 发送的参数，将其视为不同的网页。但是在这种情况下，可能不是您的问题，而是从一个项目更改为另一个！;)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T19:40:59.253

无论您使用的是 Ajax 、`GET`HTML还是. 以下是相关定义：`POST``form``curl`

*   [得到](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3)
*   [邮政](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-03T19:34:01.300

如果您传递的任何参数包含可能在 URL 中弄乱的字符（例如空格），则使用 POST。否则，您可以使用 GET。

一般来说，如果你只是传递一些小参数，你会使用 GET。但是为了传递用户提交的信息，如博客条目、文本等，使用 POST 是一个很好的做法。

还有一些框架完全依赖基于分段的 url（例如，`site.com/products/133`而不是`site.com/products.php?id=333`这些框架取消设置 GET 变量以确保安全。在这种情况下，您将始终使用 POST。

# c# - 数据绑定到 C# 中的对象

> ID：715346
> 
> 赞同：19
> 
> 时间：2009-04-03T19:30:34.397
> 
> 标签：c#, .net, data-binding

Objective-c/cocoa 提供了一种绑定形式，其中控件的属性（即文本框中的文本）可以绑定到对象的属性。我正在尝试在带有 .Net 3.5 的 C# 中复制此功能。

我在文件 MyClass.cs 中创建了以下非常简单的类：

```
class MyClass
{
    private string myName;

    public string MyName
    {
        get
        {
            return myName;
        }

        set
        {
            myName = value;
        }
    }

    public MyClass()
    {
        myName = "Allen";
    }
} 
```

我还创建了一个带有 1 个文本框和 1 个按钮的简单表单。我在表单代码中初始化了 Myclass 的一个实例并构建了项目。使用 Vs2008 中的 DataSource Wizard，我选择了基于对象创建数据源，并选择了 MyClass 程序集。这创建了一个数据源实体。我将文本框的数据绑定更改为这个数据源；但是，没有达到预期的结果（文本框的内容将是“allen”）。此外，将文本放入文本框不会更新对象的名称属性。

我知道我在这里遗漏了一些基本的东西。在某些时候，我应该将我在表单代码中初始化的 MyClass 类的实例绑定到文本框，但这并没有发生。我在网上看到的一切似乎都掩盖了将 DataBinding 与对象一起使用（或者我完全错过了标记），因此非常感谢任何帮助。

编辑：

利用我从答案中学到的知识，我查看了 Visual Studio 生成的代码，它具有以下内容：

```
this.myClassBindingSource.DataSource = typeof(BindingTest.MyClass); 
```

如果我将其注释掉并替换：

```
this.myClassBindingSource.DataSource = new MyClass(); 
```

我得到了预期的行为。为什么VS生成的默认代码是这样的？假设这比有效的方法更正确，我应该如何修改我的代码以在 VS 生成的范围内工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T20:23:36.843

您必须将文本框的数据源指定为您的新数据源。但此外，您必须将数据源的数据源分配为您的类的实例。

```
MyDataSource.DataSource = new MyClass();
TextBox1.DataSource = MyDataSource; 
```

这应该适用于您的第一次通过。正如其他人所提到的，如果您要通过任何后台进程修改类属性，您可能需要在您的类上实现其他接口（INotifyPropertyChanged 等）。

如果您只是通过表单更新属性，则不需要此步骤。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-03T19:44:40.370

您应该为 MyClass 类型实现 INotifyPropertyChanged 接口：

```
public class MyClass : INotifyPropertyChanged
{
   private string _myName;

   public string MyName
   {
       get { return _myName; }
       set
       {
          if( _myName != value )
          {
              _myName = value;
              OnPropertyChanged("MyName");
          }
       }
   }

   public event PropertyChangedEventHandler PropertyChanged;

   private void OnPropertyChanged(string propertyName)
   {
       if( PropertyChanged != null )
           PropertyChanged( this , new PropertyChangedEventArgs(propertyName) );
   }       
} 
```

如果要支持简单的数据绑定，DataBinding 基础结构需要此接口。INotifyPropertyChanged 接口用于通知“绑定”属性已更改，因此 DataBinding 基础结构可以对其采取相应措施。

然后，您可以将 MyName 属性数据绑定到文本框的 Text 属性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-13T06:16:17.180

> `DataBinding.Add("TEXT", myObject, myObjectProperty)`我在方法中收到一条错误消息

这可能是因为您在属性声明中缺少显式 {get;set;} ！

坏的：

```
public string FirstName;    //<-- you will not be able to bind to this property! 
```

好的：

```
public string FirstName { get; set; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:08:43.807

看起来您可能需要 MyName 属性上的 Bindable 属性（并遵循 Frederik 的建议）：

```
 [System.ComponentModel.Bindable(true)] 
   public string MyName
   {
       get { return _myName; }
       set
       {
          if( _myName != value )
          {
              _myName = value;
              OnPropertyChanged("MyName");
          }
       }
   } 
```

通过： http: [//support.microsoft.com/kb/327413](http://support.microsoft.com/kb/327413)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T20:10:16.720

我面前没有任何代码，但我认为数据源有点像一个集合。您必须将 MyClass 的实例添加到数据源，这就是表单字段将绑定到的内容。还有一些方法可以在数据源中导航到 MyClass 的多个实例，但听起来您不需要那样做。检查数据源的文档。

我认为您不需要实现任何花哨的接口。我似乎记得数据源上有一种方法可以让您在更改某些值后刷新或重新绑定当前项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-17T04:58:11.430

```
using System.Collections.Generic;

public class SiteDataItem
{ 
private string _text; 
private string _url; 
private int _id; 
private int _parentId;

public string Text
{  
    get 
    { 
        return _text; 
    }  
    set 
    { 
        _text = value;
    } 
}

public string Url 
{  
    get 
    { 
        return _url; 
    }  
    set 
    { 
        _url = value;
    } 
}
public int ID 
{  
    get 
    { 
        return _id;
    }  
    set 
    { 
        _id = value;
    } 
}
public int ParentID 
{  
    get 
    { 
        return _parentId;
    } 
    set 
    { 
        _parentId = value;
    } 
}
public SiteDataItem(int id, int parentId, string text, string url)
{  
    _id = id;
    _parentId = parentId;
    _text = text;
    _url = url;
}

public static List<SiteDataItem> GetSiteData() 
{  
    List<SiteDataItem> siteData = new List<SiteDataItem>();
    siteData.Add(new SiteDataItem(1, 0, "All Sites", ""));  
    siteData.Add(new SiteDataItem(2, 1, "Search Engines", ""));
    siteData.Add(new SiteDataItem(3, 1, "News Sites", ""));
    siteData.Add(new SiteDataItem(4, 2, "Yahoo", "http://www.yahoo.com"));
    siteData.Add(new SiteDataItem(5, 2, "MSN", "http://www.msn.com"));  
    siteData.Add(new SiteDataItem(6, 2, "Google", "http://www.google.com"));  
    siteData.Add(new SiteDataItem(7, 3, "CNN", "http://www.cnn.com"));  
    siteData.Add(new SiteDataItem(8, 3, "BBC", "http://www.bbc.co.uk"));  
    siteData.Add(new SiteDataItem(9, 3, "FOX", "http://www.foxnews.com"));
    return siteData; 
}
} 
```

更多细节你可以阅读教程 dapfor。com

# security - 通过 HTTP 发送 Web 表单身份验证数据的最佳方式是什么？

> ID：715348
> 
> 赞同：6
> 
> 时间：2009-04-03T19:30:45.380
> 
> 标签：security, http, https, owasp

我认识的一家公司正在讨论加强其所有 Web 应用程序产品的密码安全策略。

现在，他们正在通过 HTTP 以 POST 形式发送用户名/密码验证，因此，它们是以明文形式发送的。

解决这个问题的最简单方法就是在我们所有的应用程序中都要求使用 HTTPS 登录，对吗？

好吧，有一些内部讨论是关于对密码进行某种滚动我们自己的客户端加密（密码+盐等）。

是否有公认的仅限 HTTP 的解决方案？

意见就像......好吧，每个人都有自己的意见，所以我正在寻找可以支持您的建议的可信安全文献。不要只是谷歌，然后把我发到一篇博客文章……我已经这样做了，而且做得更进一步。

我找到了 OWASP 的建议： [http ://www.owasp.org/index.php/Top_10_2007-A7#Protection](http://www.owasp.org/index.php/Top_10_2007-A7#Protection)

以及微软的：http: [//msdn.microsoft.com/en-us/library/aa302420.aspx](http://msdn.microsoft.com/en-us/library/aa302420.aspx)

**编辑：**给出使用 SSL 的建议是不够​​的。我需要某种支持文件。我知道滚动我们自己的客户端加密是不好的。我需要能够可靠地把它卖给同事和管理层。

此外，还提到了 HTTP Digest。看起来不错，但 Digest 仅用于 HTTP 身份验证，不适用于通过 POST 发送的数据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T19:32:47.200

我强烈**建议不要**使用您自己的解决方案（在安全敏感的环境中）。使用 SSL。这是一项经过验证的技术，并且易于实施。

推出自己的安全解决方案可能非常危险，即使实施得当（0.000001% 的机会），**也会**很昂贵。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T19:38:26.017

如果数据本身不太敏感，但密码很敏感，我建议使用[HTTP 摘要身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)（这与 HTTP 基本身份验证完全不同）。它通过直接 HTTP 非常安全，并且在服务器上实现一点也不难。没有任何东西通过网络发送可以揭示密码是什么，只是允许客户端向服务器证明他们拥有正确密码的信息。

如果您想对如何在您的应用程序中实现 HTTP 摘要身份验证有一个体面的解释，[Paul James 有一篇关于它的优秀文章](http://www.peej.co.uk/projects/phphttpdigest.html)。

HTTP 身份验证的唯一真正问题在于浏览器本身：UI 很糟糕，但可以通过[一些 Javascript 来克服](http://www.peej.co.uk/articles/http-auth-with-html-forms.html)。

您可以通过存储 A1 哈希来安全地存储密码。

**更新：**正如其他答案中提到的，虽然服务器可以通过不接受基本身份验证来避免 MITM 攻击，但客户端仍然容易受到攻击，因为它会。

**更新：**您不能通过 POST 保护数据，除非您 (a) 在客户端上使用 JavaScript 进行加密，或者 (b) 通过 SSL 进行所有操作。

您*可以*通过一点点魔术，将 HTTP 身份验证与表单一起使用。毕竟，我在上面链接到的那篇文章叫做“带有 HTML 表单的 HTTP Auth”。但这不会通过 POST 完成。

如果你*真的*需要它，请使用 POST，使用 SSL 并对数据库中的密码进行加盐。

如果你想避免 CSRF，我建议使用[formkeys](http://v2.talideon.com/ideas/formkeys)，虽然这个想法有很多不同的名称，但几年前我从黑客 Slashcode 中获得了这个名称供我自己使用，这是我第一次遇到它的地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T15:26:00.153

+1 对[Mehrdad 的回答](https://stackoverflow.com/questions/715348/what-is-the-best-way-to-send-web-form-authentication-data-over-http/715363#715363)。继续使用本土密码学是有风险的。

在看到本土客户端加密解决方案的漏洞之后，从这里的经验说起。大多数漏洞都是由于相同的原因 - 数据传输受到密钥加密的保护，但密钥本身以不安全的方式交换。

TLS/SSL 不仅解决了安全密钥交换问题，还解决了安全数据传输问题。

一旦建立了 TLS/SSL 会话，TLS/SSL 通过使用非对称密钥加密来来回交换用于加密信息的对称密钥来保护您的敏感信息。对称密钥是在运行时生成的，是客户端和服务器之间的共享密钥；一旦会话准备好传输数据，正是这个密钥用于加密所有其他流量。

服务器的公钥和私钥仅用于交换此共享密钥。破坏共享密钥的唯一已知方法是破坏服务器的私钥（以便随后可以解密密钥）。实际上，它需要服务器管理员的疏忽或恶意。

*如果您推出自己的加密解决方案，则必须以安全的方式交换对称密钥。*最简单的方法是使用 TLS/SSL；更难的方法是实现您自己的非对称密钥交换加密解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T19:39:52.860

仅 HTTP 的解决方案总是容易受到中间人攻击。

**编辑：** 网络跟踪将是证明 HTTP 不安全的一种简单方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T19:40:09.507

客户端加密对大多数 MITM 攻击无能为力。攻击者可以简单地删除您的脚本。

它只会防止被动嗅探。如果这对您来说足够好，您可以使用：

*   散列在 Javascript 中实现。初始登录很容易实现质询响应，但不要忘记，对于攻击者会话 cookie 几乎和密码一样好（您必须将登录限制为单个 IP 和/或使用脚本生成一次性 cookie每个请求，我想这将是困难而脆弱的解决方案）。
*   HTTP 摘要式身份验证。更安全，因为它可以使用一次性哈希、相互身份验证等，但标准 UI 绝对令人反感。

...只需使用 SSL。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T19:54:40.250

您将花费更多的时间和金钱来推出自己的解决方案，并且不能保证它是安全的。行业标准 SSL 易于实施，而且开箱即用的安全性远超您自己制作解决方案的能力。

时间==金钱

购买证书并花时间处理您的应用程序，而不是安全的登录表单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T20:12:58.617

好的，这是您唯一需要的答案：您的银行仅支持通过 SSL 登录/验证。如果有更好的方法来做到这一点，他们会的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T20:56:48.650

> 好吧，有一些内部讨论是关于对密码进行某种滚动我们自己的客户端加密（密码+盐等）。

我们需要解决的第一件事是传输中的数据与静态数据。从 OP 看来，最大的担忧是互联网上的用户名/密码。所以，你真的很关心传输中的数据。通过 SSL 的 HTTPS 是一种经过测试的方法（这是一个非常简单的修复方法！）。现在，如果您真的想为静态数据（在数据库中、文件服务器上等）滚动自己的数据，那是另一回事，但现有的数据加密方法将比您自己的滚动更好.

依靠客户端来保证您的安全是不好的。时期。在企业环境中，是的，您可以在某种程度上依赖标准设置。但是，最终，用户是愚蠢的，您可能会遇到禁用 javascript 或您推出的任何基于客户端的解决方案的人，所以他们最终还是以纯文本形式发送用户名/密码（即使您的服务器不知道如何处理它）因为它不是预期的格式。

Roll-your-own 不会受到现有解决方案的审查。由于代码，您最终可能会在混合中添加额外的安全问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-08-28T18:24:51.797

我们只是推出了一个网络/移动应用程序来做这些事情。它为登录创建随机 URL，使用 HTTPS 和用于数据库存储的散列/AES 加密方法。有一个简单的 JSON API 可以在没有我们的 UI 的情况下使用它，这是我们的文章，看看.. [http://blog.primestudiosllc.com/security/send-time-limited-secure-logins-with-timebomb-it](http://blog.primestudiosllc.com/security/send-time-limited-secure-logins-with-timebomb-it)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-06T13:49:04.160

你提到做你自己的加密加盐......我建议使用[javascript md5](http://pajhome.org.uk/crypt/md5/md5src.html)（雅虎也在他们的非ssl页面上使用它，或者他声称）......

而且你对密码进行双重哈希......有些人可能会争辩说双重哈希会使它容易受到冲突攻击。我不得不不同意，因为到目前为止人们只能在文件上进行 md5 签名冲突，其中大量数据是 md5'ed...

如果它是一个大型企业网站（并且有理由闯入），那么没有理由不使用 SSL。

# sql - 将一对多关系显示为 2 列 - 1 个唯一行（ID 和逗号分隔列表）

> ID：715350
> 
> 赞同：9
> 
> 时间：2009-04-03T19:30:53.397
> 
> 标签：sql, concatenation, one-to-many, informix, group-concat

我需要类似于这 2 个 SO 问题的内容，但使用 Informix SQL 语法。

*   [使用 SQL 将多个字段连接为一个](https://stackoverflow.com/questions/37696/concatenate-several-fields-into-one-with-sql)

*   [SQL 帮助：选择语句连接一对多关系](https://stackoverflow.com/questions/368459/sql-help-select-statement-concatenate-a-one-to-many-relationship)

我进来的数据是这样的：

```
id     codes

63592  PELL
58640  SUBL
58640  USBL
73571  PELL
73571  USBL
73571  SUBL 
```

我想看到它像这样回来：

```
id     codes 

63592  PELL
58640  SUBL, USBL
73571  PELL, USBL, SUBL 
```

另请参见[Informix 中的 group_concat()](https://stackoverflow.com/questions/489081/groupconcat-in-informix/)。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-04T06:42:44.797

我相信您需要的答案是一个用户定义的聚合，类似于这个：

```
CREATE FUNCTION gc_init(dummy VARCHAR(255)) RETURNING LVARCHAR;
    RETURN '';
END FUNCTION;

CREATE FUNCTION gc_iter(result LVARCHAR, value VARCHAR(255))
    RETURNING LVARCHAR;
    IF result = '' THEN
        RETURN TRIM(value);
    ELSE
        RETURN result || ',' || TRIM(value);
    END IF;
END FUNCTION;

CREATE FUNCTION gc_comb(partial1 LVARCHAR, partial2 LVARCHAR)
    RETURNING LVARCHAR;
    IF partial1 IS NULL OR partial1 = '' THEN
        RETURN partial2;
    ELIF partial2 IS NULL OR partial2 = '' THEN
        RETURN partial1;
    ELSE
        RETURN partial1 || ',' || partial2;
    END IF;
END FUNCTION;

CREATE FUNCTION gc_fini(final LVARCHAR) RETURNING LVARCHAR;
    RETURN final;
END FUNCTION;

CREATE AGGREGATE group_concat
    WITH (INIT = gc_init, ITER = gc_iter,
          COMBINE = gc_comb, FINAL = gc_fini); 
```

给定一个元素表（称为元素），其中一个名为 name 的列包含（很有趣）元素名称，以及另一个名为 atomic_number 的列，此查询产生以下结果：

```
SELECT group_concat(name) FROM elements WHERE atomic_number < 10;

Hydrogen,Helium,Lithium,Beryllium,Boron,Carbon,Nitrogen,Oxygen,Fluorine 
```

应用于该问题，您应该从以下位置获得所需的答案：

```
SELECT id, group_concat(codes)
    FROM anonymous_table
    GROUP BY id; 
```

* * *

```
CREATE TEMP TABLE anonymous_table
(
    id      INTEGER NOT NULL,
    codes   CHAR(4) NOT NULL,
    PRIMARY KEY (id, codes)
);

INSERT INTO anonymous_table VALUES(63592, 'PELL');
INSERT INTO anonymous_table VALUES(58640, 'SUBL');
INSERT INTO anonymous_table VALUES(58640, 'USBL');
INSERT INTO anonymous_table VALUES(73571, 'PELL');
INSERT INTO anonymous_table VALUES(73571, 'USBL');
INSERT INTO anonymous_table VALUES(73571, 'SUBL');
INSERT INTO anonymous_table VALUES(73572, 'USBL');
INSERT INTO anonymous_table VALUES(73572, 'PELL');
INSERT INTO anonymous_table VALUES(73572, 'SUBL');

SELECT id, group_concat(codes)
    FROM anonymous_table
    GROUP BY id
    ORDER BY id; 
```

输出是：

```
58640 SUBL,USBL
63592 PELL
73571 PELL,SUBL,USBL
73572 PELL,SUBL,USBL 
```

添加了额外的数据集以测试插入序列是否影响结果；它似乎没有这样做（代码按排序顺序排列；我不确定是否有办法改变 - 反转 - 该顺序）。

* * *

笔记：

1.  此聚合应该可用于任何可以转换为 VARCHAR(255) 的类型，这意味着任何数字或时间类型。不处理长 CHAR 列和 blob 类型（BYTE、TEXT、BLOB、CLOB）。
2.  普通的 LVARCHAR 将聚合大小限制为 2048 字节。例如，如果您认为需要更长的长度，请指定`LVARCHAR(10240)`（对于 10 KiB）。
3.  从 Informix 12.10.FC5 开始，工作的最大长度似乎是 16380；任何更长的时间似乎都会触发`SQL -528: Maximum output rowsize (32767) exceeded`，这让我感到惊讶。
4.  如果需要删除聚合，可以使用：

    ```
    DROP AGGREGATE IF EXISTS group_concat;
    DROP FUNCTION IF EXISTS gc_fini;
    DROP FUNCTION IF EXISTS gc_init;
    DROP FUNCTION IF EXISTS gc_iter;
    DROP FUNCTION IF EXISTS gc_comb; 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-07-06T08:46:07.987

Oracle 为此类需求提供了列表聚合器功能。

`SELECT id, LISTAGG(codes,',') as CODE_LIST FROM <TABLE> GROUP BY id`

输出会像

```
ID     CODE_LIST 
63592  PELL
58640  SUBL,USBL
73571  PELL,USBL,SUBL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T20:19:03.703

我不确定informix sql，但在MSSQL 或Oracle 中，您可以使用

DECODE 或 CASE 关键字，通过将它们连接在一起。但是，这需要您提前知道所有潜在值，这很脆弱。

我假设您不喜欢 STUFF 关键字的原因是因为 informix 不支持它？

Oracle 还支持 CONNECT BY 关键字，它可以工作，但同样可能不受 informix 支持。

可能最好的答案是在查询之后在您的客户端/数据层中构建此输出。是否有特殊原因必须在查询中完成此操作？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T20:31:54.170

此外，如果 informix 允许您创建用户函数，您可以创建一个函数，该函数返回一个带有连接值的字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-14T17:49:46.373

基于 Jonathan Leffler 示例和关于连接值排序的 RET 评论，使用 Informix 12.10FC8DE，我想出了以下用户聚合：

```
CREATE FUNCTION mgc_init
(
    dummy VARCHAR(255)
)
RETURNING
    SET(LVARCHAR(2048) NOT NULL);

    RETURN SET{}::SET(LVARCHAR(2048) NOT NULL);

END FUNCTION;

CREATE FUNCTION mgc_iter
(
    p_result SET(LVARCHAR(2048) NOT NULL)
    , p_value VARCHAR(255)
)
RETURNING
    SET(LVARCHAR(2048) NOT NULL);

    IF p_value IS NOT NULL THEN
        INSERT INTO TABLE(p_result) VALUES (TRIM(p_value));
    END IF;

    RETURN p_result;

END FUNCTION;

CREATE FUNCTION mgc_comb
(
    p_partial1 SET(LVARCHAR(2048) NOT NULL)
    , p_partial2 SET(LVARCHAR(2048) NOT NULL)
)
RETURNING
    SET(LVARCHAR(2048) NOT NULL);

    INSERT INTO TABLE(p_partial1)
        SELECT vc1 FROM TABLE(p_partial2)(vc1);

    RETURN p_partial1;

END FUNCTION;

CREATE FUNCTION mgc_fini
(
    p_final SET(LVARCHAR(2048) NOT NULL)
)
RETURNING
    LVARCHAR;

    DEFINE l_str LVARCHAR(2048);
    DEFINE l_value LVARCHAR(2048);

    LET l_str = NULL;

    FOREACH SELECT vvalue1 INTO l_value FROM TABLE(p_final) AS vt1(vvalue1) ORDER BY vvalue1
        IF l_str IS NULL THEN
            LET l_str = l_value;
        ELSE
            LET l_str = l_str || ',' || l_value;
        END IF;
    END FOREACH;

    RETURN l_str;

END FUNCTION;
GRANT EXECUTE ON mgc_fini TO PUBLIC;

CREATE AGGREGATE m_group_concat
WITH
(
    INIT = mgc_init
    , ITER = mgc_iter
    , COMBINE = mgc_comb
    , FINAL = mgc_fini
); 
```

连接的值将没有重复项并将被排序。

我使用 Informix `collections`（即`SET`不允许重复值）来尝试使代码保持简单。

方法是使用`SET`'s 来保留中间结果（并消除重复项），最后从 final 的有序值构建连接字符串`SET`。

使用`LVARCHAR`for`SET`元素是因为最初我使用的是`VARCHAR`，但内存消耗非常非常高。`VARCHAR`文档提示 Informix内部可能会将`CHAR`. 我进行了更改，实际上确实降低了内存消耗（但仍然很高）。

然而，这个总内存消耗比乔纳森的高大约 2 个数量级，并且在我进行的测试中慢了大约 2 倍（使用大约 300 000 行的表）。

所以要小心使用。它消耗大量内存并且没有经过广泛测试（它可能在某处泄漏内存）。

**编辑1：**

我之前的代码一定在某处泄漏了内存结构（或者 Informix 在内部保留了集合派生表，它可以生成很多这样的表）。

因此，仍然试图避免在 中编写聚合函数`C`，这是另一种选择，使用 Informix`BSON`内置函数，这将使用更少的内存并且速度更快。

```
CREATE FUNCTION m2gc_init
(
    dummy VARCHAR(255)
)
RETURNING
    BSON;

    RETURN '{"terms":[]}'::JSON::BSON;

END FUNCTION;

CREATE FUNCTION m2gc_iter
(
    p_result BSON
    , p_value VARCHAR(255)
)
RETURNING
    BSON;

    DEFINE l_add_array_element LVARCHAR(2048);

    IF p_value IS NOT NULL THEN
        LET l_add_array_element = '{ $addToSet: { terms: "' || TRIM(p_value) || '" } }';
        LET p_result = BSON_UPDATE(p_result, l_add_array_element);
    END IF;

    RETURN p_result;

END FUNCTION;

CREATE FUNCTION m2gc_comb
(
    p_partial1 BSON
    , p_partial2 BSON
)
RETURNING
    BSON;

    DEFINE l_array_elements LVARCHAR(2048);
    DEFINE l_an_element LVARCHAR(2048);
    DEFINE l_guard INTEGER;

    LET l_array_elements = NULL;
    LET l_guard = BSON_SIZE(p_partial2, 'terms.0');

    IF l_guard > 0 THEN
        WHILE l_guard > 0
            LET l_an_element = BSON_VALUE_LVARCHAR(p_partial2, 'terms.0');
            IF l_array_elements IS NULL THEN
                LET l_array_elements = '"' || l_an_element || '"';
            ELSE
                LET l_array_elements = l_array_elements || ', "' || l_an_element || '"';
            END IF;
            LET p_partial2 = BSON_UPDATE(p_partial2, '{ $pop: { terms: -1 } }');
            LET l_guard = BSON_SIZE(p_partial2, 'terms.0');
        END WHILE;
        LET l_array_elements = '{ $addToSet: { terms: { $each: [ ' || l_array_elements || ' ] } } }';        
        LET p_partial1 = BSON_UPDATE(p_partial1, l_array_elements);
    END IF;

    RETURN p_partial1;

END FUNCTION;

CREATE FUNCTION m2gc_fini
(
    p_final BSON
)
RETURNING
    LVARCHAR;

    DEFINE l_str_agg LVARCHAR(2048);
    DEFINE l_an_element LVARCHAR(2048);
    DEFINE l_iter_int INTEGER;
    DEFINE l_guard INTEGER;

    LET l_str_agg = NULL;
    LET l_guard = BSON_SIZE(p_final, 'terms.0');

    IF l_guard > 0 THEN
        LET p_final = BSON_UPDATE(p_final, '{ $push: { terms: { $each: [], $sort: 1 } } }');    
        LET l_iter_int = 0;
        WHILE l_guard > 0
            LET l_an_element = BSON_VALUE_LVARCHAR(p_final, 'terms.' || l_iter_int);
            IF l_str_agg IS NULL THEN
                LET l_str_agg = TRIM(l_an_element);
            ELSE
                LET l_str_agg = l_str_agg || ',' || TRIM(l_an_element);
            END IF;
            LET l_iter_int = l_iter_int + 1;
            LET l_guard = BSON_SIZE(p_final, 'terms.' || l_iter_int);
        END WHILE;
    END IF;
    RETURN l_str_agg;

END FUNCTION;

CREATE AGGREGATE m2_group_concat
WITH
(
    INIT = m2gc_init
    , ITER = m2gc_iter
    , COMBINE = m2gc_comb
    , FINAL = m2gc_fini
)
; 
```

聚合的返回值将被排序并且没有重复。

同样，这没有经过适当的测试。它只是一个 POC。

问题之一是它没有清理输入值。一些`BSON`操作函数接收通过连接字符串构建的参数，非转义字符可能会破坏这些参数。例如，带有引号的字符串值：)`'I"BrokeIt'`可能会引发各种错误（包括断言失败）。

我确信还有其他问题。

但是，此实现的内存消耗与 Jonathan 的示例中的数量级相同，并且慢了大约 60%（同样，只执行了非常基本的测试）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T20:22:47.470

我想在 Stack Overflow 上的另一个类似问题上向您指出[这个答案。](https://stackoverflow.com/questions/489081/groupconcat-in-informix/493025#493025)您正在寻找类似 MySQL 的`group_concat()`函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-09T15:34:39.677

**此解决方案支持用户指定的分隔符：**

**例子：**

```
SELECT id, group_concat(codes, '+')
    FROM anonymous_table
    GROUP BY id
    ORDER BY id; 
```

*这与Jonathan Leffler*的解决方案相同，但支持**分隔符**。如果未指定，默认分隔符是**','**。

**代码：**

```
CREATE ROW TYPE group_concat_t
(
   result   LVARCHAR,
   separator VARCHAR(1)
);

CREATE FUNCTION gc_init(dummy VARCHAR(255), separator VARCHAR(1) default ',' ) RETURNING group_concat_t;
    RETURN ROW('',separator)::group_concat_t;
END FUNCTION; 

CREATE FUNCTION gc_iter(result group_concat_t, value VARCHAR(255))
    RETURNING group_concat_t;
    IF result.result = '' THEN
        RETURN ROW(TRIM(value),result.separator)::group_concat_t ;
    ELSE
        RETURN ROW(result.result || result.separator || TRIM(value),result.separator)::group_concat_t;
    END IF;
END FUNCTION;

CREATE FUNCTION gc_comb(partial1 group_concat_t, partial2 group_concat_t)
    RETURNING group_concat_t;
    IF partial1 IS NULL OR partial1.result = '' THEN
        RETURN partial2;
    ELIF partial2 IS NULL OR partial2.result = '' THEN
        RETURN partial1;
    ELSE
        RETURN ROW(partial1.result || partial1.separator || partial2.result, partial1.separator)::group_concat_t;
    END IF;
END FUNCTION;

CREATE FUNCTION gc_fini(final group_concat_t) RETURNING LVARCHAR;
    RETURN final.result;
END FUNCTION;  

CREATE AGGREGATE group_concat
    WITH (INIT = gc_init, ITER = gc_iter,
          COMBINE = gc_comb, FINAL = gc_fini); 
```

# c# - 通用下拉列表

> ID：715356
> 
> 赞同：0
> 
> 时间：2009-04-03T19:31:25.487
> 
> 标签：c#, .net, asp.net, nhibernate

我想使用 C# 在 ASP.net 2.0 中创建通用下拉列表，基本概念是我初始化此列表的 Nhibernate 对象类型应该使用该对象基础表中的所有值填充下拉列表。任何建议我如何才能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:37:42.100

没有更多信息很难回答。

你是为桌面编程吗？如果有，是哪个？（linux、windows、mac）你在为网络编程吗？如果有的话，你的 Web 框架是什么？你在使用什么库？

有时，上下文可能是最重要的。提供更多详细信息，我们可能会引导您朝着正确的方向前进。

**编辑** 我是新来的，没有注意到您标记的选择。我的错。不幸的是，我不是 .NET 人。

从我的书签中查看此参考以获取大量示例：[http ://www.java2s.com/Tutorial/ASP.NET/CatalogASP.NET.htm](http://www.java2s.com/Tutorial/ASP.NET/CatalogASP.NET.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:56:06.160

您可以让您的类实现一个接口，该接口定义哪些属性代表下拉列表的键和值：

```
public interface IKeyValuePair
{
    int Key { get; }
    string Value { get; }
} 
```

然后创建一个接受`IEnumerable<KeyValuePair>`并填充下拉列表的方法。您可以使用 Linq Convert 扩展方法将 NHibernate 返回的集合转换为`IEnumerable<KeyValuePair>`.

# javascript - 我在哪里可以找到有关 JavaScript 内部结构的技术细节？

> ID：715359
> 
> 赞同：2
> 
> 时间：2009-04-03T19:31:58.510
> 
> 标签：javascript

我想检查 JavaScript 片段的结构，即一旦一个对象被解释，解释部分占用的内存空间的结构是什么，例如它有一个成员“数组”，可能是一个标题记录等。就像我可以将一个简单的 C 函数呈现为汇编代码一样，反之亦然。

我从来没有遇到过这样的信息？这对于各种解释器来说是高度专有的吗？它是没有人理解的秘密吗？它是一棵字符串值和字符串元数据的大树吗？我在哪里可以看到这种东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T19:34:13.593

它对于各种口译员来说是高度专有的。

以下是有关 V8 工作原理（chrome 引擎）的一些信息：

[http://code.google.com/p/v8/](http://code.google.com/p/v8/)

您可能还想看看 SquirrelFish (WebKit/Safari) 的源代码...

信息：[http ://trac.webkit.org/wiki/SquirrelFish](http://trac.webkit.org/wiki/SquirrelFish)

... 和 TraceMonkey (FF3.1+) 因为它们都可用。

信息：[https ://wiki.mozilla.org/JavaScript:TraceMonkey](https://wiki.mozilla.org/JavaScript:TraceMonkey)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:33:41.957

我认为这在很大程度上取决于您所谈论的 Javascript 引擎。一个不错的起点可能是查看[Google Chrome 的 Javascript 引擎 V8](http://code.google.com/p/v8/)。该链接将引导您访问 YouTube 上的一些视频，这些视频提供了一些关于它是如何设计的信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T19:35:37.893

好吧，由于 Firefox 是开源的，您可以查看代码......但我很确定您正在寻找的信息需要一段时间才能从代码中提取出来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T19:42:49.983

查看[犀牛](http://mxr.mozilla.org/mozilla/source/js/rhino/)的来源...

# c# - 从 C# 中的位图对象中获取 BITMAPV5HEADER 的任何方法

> ID：715365
> 
> 赞同：0
> 
> 时间：2009-04-03T19:33:09.303
> 
> 标签：c#, .net, gdi+, gdi

有没有办法从 C# 中的位图对象中获取 BITMAPV5HEADER？或者只是得到他们的价值观？我需要从位图中获取一些 ColorSpace 信息，但在 C# 中看不到这样做的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:38:07.250

似乎不是一种简单的方法，但是一种 hackish（并且可能非常错误）的方法是读取原始数据并将其转换为[`BITMAPV5HEADER`](http://msdn.microsoft.com/en-us/library/dd183381.aspx)结构。

结构

```
[StructLayout(LayoutKind.Sequential)]
public struct BITMAPV5HEADER
{
  uint bV5Size;
  long bV5Width;
  long bV5Height;
  int bV5Planes;
  int bV5BitCount;
  uint bV5Compression;
  uint bV5SizeImage;
  long bV5XPelsPerMeter;
  long bV5YPelsPerMeter;
  uint bV5ClrUsed;
  uint bV5ClrImportant;
  uint bV5RedMask;
  uint bV5GreenMask;
  uint bV5BlueMask;
  uint bV5AlphaMask;
  uint bV5CSType;
  IntPtr bV5Endpoints;
  uint bV5GammaRed;
  uint bV5GammaGreen;
  uint bV5GammaBlue;
  uint bV5Intent;
  uint bV5ProfileData;
  uint bV5ProfileSize;
  uint bV5Reserved;
} 
```

辅助方法

```
public static T RawStructureRead<T>(Stream stream) where T : struct
{
  T @struct;
  int size = Marshal.SizeOf(typeof(T));

  BinaryReader reader = new BinaryReader(stream);
  byte[] buffer = reader.ReadBytes(size);

  GCHandle handle = GCHandle.Alloc(buffer, GCHandleType.Pinned);
  @struct = (T)Marshal.PtrToStructure(handle.AddrOfPinnedObject(), typeof(T));
  handle.Free();

  return @struct;
} 
```

用法

```
using (FileStream stream = File.OpenRead("..."))
{
  BITMAPV5HEADER header = RawStructureRead<BITMAPV5HEADER>(stream);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T19:37:30.620

我对此表示怀疑。`BITMAPV5HEADER`用于 GDI 对象，而不是使用的 GDI + `Bitmap`。如果可能，我会使用标准 GDI 调用重新打开文件。

# maven-2 - Maven 程序集生成

> ID：715375
> 
> 赞同：3
> 
> 时间：2009-04-03T19:34:34.700
> 
> 标签：maven-2, maven-plugin

目前正在尝试以这样一种方式打包一个小型应用程序，以便我们的运维团队可以更轻松地部署它。我的要求是项目被编译和压缩。

我从命令行运行命令“mvn -DmyProfile clean generate-sources package”，并创建了一个 src.xml 文件，该文件详细说明了在声明使用 zip 格式作为输出的基础上，哪个文件应该放在哪里。

结果，我在目标文件夹中获得了 2 个文件，一个 jar 和一个 zip 文件。zip 文件的结构完全符合我的需要，除了我的属性文件没有从 POM 中注入正确的值。相反，所有的 {variables} 仍然存在。另一方面，jar 似乎注入了所有正确的值，但 jar 的结构不是我需要的。

关键是这个问题只是因为我试图将 Java Service Wrapper 添加到我的项目中并且需要有 src.xml 文件来声明所有新文件应该在项目文件夹结构中的位置。在此之前，完全相同的命令可以完美运行，甚至 jar 结构与 Eclipse 中的实际项目结构更加一致。

不是责怪 Java 服务包装器，只是想知道是否通过尝试让所有东西都为该部分工作，我没有与 MVN 程序集产生冲突。

任何帮助深表感谢。

谢谢，扬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:03:05.697

因此，事实证明 Maven 创建了一个“快照”jar，该 jar 包含在 Zip 存档内的 lib 文件夹中。该快照 jar 包含注入正确值的配置文件。换句话说，如果您使用类加载器而不是文件系统引用加载配置文件，它应该可以工作。

无论如何，我被告知不要将配置文件放在 Zip 存档的根目录下。因此，在我的情况下，Maven 只是在存档中推送而不注入它们的配置文件甚至不应该放在首位。

但这里是包含在 pom.xml 中的 src.xml 文件的新内容：

```
<assembly>
<id>bin</id>
<includeBaseDirectory>false</includeBaseDirectory>
<formats>
    <format>zip</format>
</formats>
<fileSets>
    <fileSet>
        <directory>src/main/bin</directory>
        <outputDirectory>/bin</outputDirectory>
        <includes>
            <include>**/*.sh</include>
        </includes>
        <fileMode>777</fileMode>
    </fileSet>
    <fileSet>
        <directory>lib</directory>
        <outputDirectory>/lib</outputDirectory>
        <includes>
            <include>**/*.jar</include>
        </includes>
    </fileSet>
    <!-- Wrapper files -->
    <fileSet>
        <directory>lib/wrapper</directory>
        <outputDirectory>/lib</outputDirectory>
        <includes>
            <include>**/*</include>
        </includes>
    </fileSet>
    <fileSet>
        <directory>src/main/bin/wrapper</directory>
        <outputDirectory>/bin/wrapper</outputDirectory>
        <includes>
            <include>**/*</include>
        </includes>
        <fileMode>777</fileMode>
    </fileSet>
    <fileSet>
        <directory>src/main/conf</directory>
        <outputDirectory>conf</outputDirectory>
        <includes>
            <include>**/*</include>
        </includes>
    </fileSet>
</fileSets>
<dependencySets>
    <dependencySet>
        <outputDirectory>/lib</outputDirectory>
        <includes>
            <include>*:jar:*</include>
        </includes>
        <excludes>
            <exclude>*:sources</exclude>
        </excludes>
    </dependencySet>
</dependencySets></assembly> 
```

这仍然会输出一个 jar 和一个 zip 存档，但由于 zip 包含快照 jar，现在一切都应该没问题。

除了......（这可能是另一篇文章，所以如果我离开这个问题的主题，请告诉我）

配置文件中注入的值不是我的 POM.xml 中的配置文件中的值。它们是我的 settings.xml 中的那些，它们位于我的 .m2 文件夹中。但是在 settings.xml 配置文件中关闭激活似乎并不能解决这个问题：

```
<activation>
<activeByDefault>false</activeByDefault>
</activation> 
```

这里再次是我运行的命令行：

```
mvn -Denv-prod clean generate-sources package 
```

其中“env-prod”是 pom.xml 中包含要注入的值的配置文件。

任何的想法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T22:43:09.143

好的，所以我找到了第二个问题的答案。maven命令出错了，我执行成功的是：

```
mvn clean package -P env-prod 
```

这将正确的值放在我的配置文件中的正确位置。请注意使用开关 -P 而不是 -D 来选择配置文件。

# metaprogramming - Purdue Compiler Construction Tool Set (PCCTS)：网站、教程、书籍？

> ID：715381
> 
> 赞同：0
> 
> 时间：2009-04-03T19:36:45.927
> 
> 标签：metaprogramming, compiler-construction

我是一名大学生，并被要求熟悉 PCCTS，Purdu 编译器构建工具集。我已获得[http://www.polhode.com/pccts.html的链接](http://www.polhode.com/pccts.html)

我必须在 PCCTS 中编写一些基本程序，然后在编译器优化中使用这些知识。

因此，谷歌上有一些结果可用于此目的，但需要一些时间才能找到所有有用的结果。如果有人知道更多关于这个主题的教程、书籍、网站或一些基本指导，那对我来说真的很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:40:42.093

也许通过这些链接是您的老师希望您做的事情之一？

# compact-framework - 紧凑框架上的 db4o 有什么竞争对手吗？

> ID：715382
> 
> 赞同：4
> 
> 时间：2009-04-03T19:36:46.597
> 
> 标签：compact-framework, db4o

我们一直在尝试使用 db4o 在紧凑框架上持久化对象。到目前为止，它在我们的测试中运行良好。然而，对于需要最少单元的小型初创公司来说，它们似乎是昂贵的一面。

有谁知道紧凑框架的任何类似对象数据库？一个免费用于商业用途的开源软件怎么样？:)

谢谢你。

编辑：我们真的在寻找一个对象数据库。此时我们不想创建自己的持久性框架，而是希望能够只保存/检索实际的对象树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T19:38:51.083

[SQL Server CE](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)、[VistaDB](http://www.vistadb.net)或[SQLite](http://www.sqlite.org)怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-02T18:32:24.000

Eloquera ( [http://www.eloquera.com](http://www.eloquera.com) ) 是一个免费用于商业用途的 .NET 对象数据库。

“Eloquera 是一个原生的 .NET 对象数据库。

*   用一行代码保存数据
*   1TB+ 最大数据库大小
*   项目清单
*   SQL 和 LINQ 查询
*   用户同时访问
*   安全设定
*   正版C/S架构，桌面模式可用
*   支持内存数据库，用于快速数据处理等
*   它完全免费用于商业用途。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-19T14:48:19.317

我没有使用它，我不确定商业许可是什么样的，但这可能值得一看：

[Perst - 一个开源的、面向对象的嵌入式数据库](http://www.mcobject.com/perst_features_benefits)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:19:20.520

Well, if you're using Java:

Berkeley DB look like it could be right up your alley

[link text](http://www.oracle.com/technology/products/berkeley-db/je/index.html)

Commercial, but IIRC license costs aren't very high.

[link text](http://www.progress.com/objectstore/pse_pro/index.ssp)

# c# - 当我不放置命名空间时，我的类在什么命名空间中？

> ID：715398
> 
> 赞同：3
> 
> 时间：2009-04-03T19:40:29.240
> 
> 标签：c#, .net, namespaces

如果我不在我的类中放置命名空间（vs.net 2008），我的类在哪个命名空间下构建？

**更新** 很奇怪，当我添加一个命名空间时，我似乎无法从我的用户控件中引用类方法。

如果我明确设置一个命名空间，并在我的控件中添加一个“使用...”，我仍然看不到它！

怎么会这样？

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Configuration;
/// <summary>
/// Summary description for Globals
/// </summary>
public class Globals
{
    public Globals()
    { }

    public static string ConnectionString
    {
        get
        {
            return ConfigurationManager.ConnectionStrings["MyDb"].ConnectionString;
        }
    }

} 
```

我的控制：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class MyStats : System.Web.UI.UserControl
{

    protected void Page_Load(object sender, EventArgs e)
    {

    //etc. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T19:44:17.513

如果您不提供命名空间，则您的类型没有命名空间。请记住，命名空间在编译后没有任何意义。它们只是附加到您键入的名称的开头，以创建一个更长的名称，该名称具有更大的唯一性。

**编辑：**我认为您可能有两个单独的程序集，一个应该引用另一个，但事实并非如此。如果两个项目在一个解决方案中，那么类查看器将显示所有项目中的所有类型，但这并不一定意味着 `ProjectA`引用`ProjectB`. 为了使用 in 中的类型`ProjectB`，`ProjectA`您需要确保项目引用存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:44:23.613

如您所说，该类将没有任何名称空间，无需使用子句即可访问它。

命名空间是一种通过分类（主要是根据它们的功能性）对类进行排序的功能

**编辑**

根据您的更新，我认为您的“全局”类可能会因为 global:: 子句而带来麻烦……您介意更改类的名称以查看它是否有效吗？

# c# - Ajax 日历和下拉列表显示问题

> ID：715402
> 
> 赞同：0
> 
> 时间：2009-04-03T19:41:34.387
> 
> 标签：c#, asp.net

我有一个 ajax 日历扩展器和下拉菜单放在它的正下方，问题出在 IE 中，每当日历控件弹出时，它就会在下拉菜单下弹出。我尝试了 z-index 但不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T19:48:58.113

日历是否在 DIV 中？如果是这样，我认为把它放在 iFrame 中可以解决这个问题。

编辑：[这](http://www.javascriptjunkie.com/?p=5)应该可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T07:32:31.243

提前道歉，但我怀疑日历的 z-index 是否高于 DropDownList 的 z-index，只是因为这就是我为自己解决完全相同的问题所要做的一切。

在我的 CSS 文件中，我添加了以下行：

```
.ajax__calendar_container { z-index:1000; } 
```

为了证明任何其他怀疑者是错误的，您能告诉我们您的日历容器和 DropDownList 的 z-index 是多少吗？

另外，你安装了[IE Developer Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)吗？（它在某些方面类似于 Firebug。）这将帮助您找到 DropDownList 和其他控件的所有 CSS 属性，即使它们的默认值保持不变。如果它真的不是 z-index，工具栏可以引导你更好地突出真正的问题。

# apache-flex - Flex 到 CF - URLRequest 不发布数据

> ID：715403
> 
> 赞同：0
> 
> 时间：2009-04-03T19:41:48.800
> 
> 标签：apache-flex, coldfusion

我有一个 Flex 表单，它使用 URLVariables、URLRequest 和 navigateToURL 收集信息，它将数据发送到处理信息并生成 PDF 的 ColdFusion 页面。对于 99% 的用户来说，一切都很好，但有些人报告说表单是空白的，这让我相信客户端的某些东西正在阻止他们传递数据。其他人在发布数据时发生过这种情况吗？可能是防火墙或 Flash 播放器设置？

视窗 -> IE7

感谢任何光唰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T20:47:23.433

我也会检查他们使用的 Reader 版本。很多时候，我试图找出一个 PDF 问题，却发现用户没有使用最新版本的 Adob​​e Reader。

当浏览器插件损坏时，我也看到过类似的情况。在这种情况下，唯一的解决方案是卸载并重新安装 Adob​​e Reader。

最后确保浏览器设置正确，不允许缓存。我工作中的很多人一直打电话给我，说我没有制作 PDF，而真正的罪魁祸首是他们的浏览器缓存。清除缓存并将浏览器设置为不缓存任何内容也可以解决问题。

最后，我不太确定没有收到 URLRequest 的整体是这里的问题，您应该将搜索扩展到其他领域。

# c - 我的会员价值发生了什么变化？

> ID：715412
> 
> 赞同：0
> 
> 时间：2009-04-03T19:43:33.943
> 
> 标签：c, objective-c, cocoa-touch, chipmunk

那里有一个笑话。

随便。在以下代码中，该`setForceVector`方法对其尝试更改的成员的值没有实际影响。通过检查日志，我可以看到正在调用该函数（由另一个对象处理 a `touchEvent`）。

我已经使用 NSLog 来检查`forceVectorfromControls`实际是否按预期出现，并且确实如此。

如果我`forceVector`在**init**或**step**方法中设置它的值，它会按预期工作。`setForceVector`但由于某种原因，它在方法中什么都不做。

`cpVect`是一个C结构，这和它有什么关系吗？

[http://pastebin.com/m78f3d63e](http://pastebin.com/m78f3d63e)

我难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:28:39.590

在没有意识到的情况下，这闻起来非常强烈，有两个不同的对象。尝试在方法中记录 self ，看看是否是同一个 GameLayer 做所有这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:03:29.170

cpVect 不应该是一个指针（第 10 行）吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T20:08:37.737

`@synthesize`将尝试生成另一个访问器方法，尽管我不确定当两者发生冲突时会发生什么。您是否尝试过不合成二传手？或者，您可以在变量上设置一个观察点，看看是什么改变了它吗？

# python - 在 Python 中从字符串转换为布尔值？

> ID：715417
> 
> 赞同：1002
> 
> 时间：2009-04-03T19:44:20.353
> 
> 标签：python, string, boolean

有谁知道如何在 Python 中将字符串转换为布尔值？我找到[了这个链接](http://codecomments.wordpress.com/2008/04/08/converting-a-string-to-a-boolean-value-in-python/)。但这看起来不是正确的方法。即使用内置功能等。

我问这个的原因是因为我`int("string")`从这里了解到。但是在尝试时`bool("string")`它总是返回`True`：

```
>>> bool("False")
True 
```

* * *

## 回答 #1

> 赞同：1077
> 
> 时间：2009-04-03T19:52:56.183

真的，您只需将字符串与您期望接受的表示 true 的字符串进行比较，因此您可以这样做：

```
s == 'True' 
```

或者检查一大堆值：

```
s.lower() in ['true', '1', 't', 'y', 'yes', 'yeah', 'yup', 'certainly', 'uh-huh'] 
```

使用以下内容时要小心：

```
>>> bool("foo")
True
>>> bool("")
False 
```

空字符串评估为`False`，但其他所有字符串评估为`True`。所以这不应该用于任何类型的解析目的。

* * *

## 回答 #2

> 赞同：482
> 
> 时间：2013-08-27T17:42:22.040

采用：

```
bool(distutils.util.strtobool(some_string)) 
```

*   **Python 2**：[http ://docs.python.org/2/distutils/apiref.html?highlight=distutils.util#distutils.util.strtobool](http://docs.python.org/2/distutils/apiref.html?highlight=distutils.util#distutils.util.strtobool)
*   **Python 3**：[https ://docs.python.org/3/distutils/apiref.html#distutils.util.strtobool](https://docs.python.org/3/distutils/apiref.html#distutils.util.strtobool)

> 真值为 y、yes、t、true、on 和 1；false 值为 n、no、f、false、off 和 0。如果 val 是其他值，则引发 ValueError。

请注意，它`distutils.util.strtobool()`返回整数表示，因此需要将其包装起来`bool()`以获取布尔值。

* * *

## 回答 #3

> 赞同：309
> 
> 时间：2009-04-03T19:56:44.100

```
def str2bool(v):
  return v.lower() in ("yes", "true", "t", "1") 
```

然后像这样调用它：

```
>>> str2bool("yes")
True
>>> str2bool("no")
False
>>> str2bool("stuff")
False
>>> str2bool("1")
True
>>> str2bool("0")
False 
```

* * *

**明确处理真假：**

您还可以使您的函数显式检查 True 单词列表和 False 单词列表。然后，如果它不在两个列表中，则可以抛出异常。

* * *

## 回答 #4

> 赞同：158
> 
> 时间：2012-12-04T15:38:14.847

JSON 解析器通常也可用于将字符串转换为合理的 Python 类型。

```
>>> import json
>>> json.loads("false".lower())
False
>>> json.loads("True".lower())
True 
```

* * *

## 回答 #5

> 赞同：121
> 
> 时间：2009-05-28T18:06:39.923

从 Python 2.6 开始，现在有`ast.literal_eval`：

```
>>> 导入 ast
>>> 帮助（ast.literal_eval）
关于 ast 模块中函数 literal_eval 的帮助：

文字评估（节点或字符串）
    安全地评估表达式节点或包含 Python 的字符串
    表达。提供的字符串或节点只能包含以下内容
    Python 文字结构：字符串、数字、元组、列表、字典、布尔值、
    和无。

```

这似乎可行，只要您**确定**您的字符串将是`"True"`or `"False"`：

```
>>> ast.literal_eval("真")
真的
>>> ast.literal_eval("False")
错误的
>>> ast.literal_eval("F")
回溯（最近一次通话最后）：
  文件“”，第 1 行，在
  文件“/opt/Python-2.6.1/lib/python2.6/ast.py”，第 68 行，在 literal_eval 中
    返回 _convert(node_or_string)
  文件“/opt/Python-2.6.1/lib/python2.6/ast.py”，第 67 行，在 _convert
    raise ValueError('格式错误的字符串')
ValueError：格式错误的字符串
>>> ast.literal_eval("'False'")
'错误的'

```

我通常不会推荐这个，但它是完全内置的，根据您的要求可能是正确的。

* * *

## 回答 #6

> 赞同：71
> 
> 时间：2018-08-22T21:27:55.080

如果您知道字符串将是`"True"`or `"False"`，则可以使用`eval(s)`.

```
>>> eval("True")
True
>>> eval("False")
False 
```

仅当您确定字符串的内容时才使用它，因为如果字符串不包含有效的 Python，它将引发异常，并且还将执行字符串中包含的代码。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-09-25T21:16:55.090

此版本保留了 int(value) 等构造函数的语义，并提供了一种简单的方法来定义可接受的字符串值。

```
def to_bool(value):
    valid = {'true': True, 't': True, '1': True,
             'false': False, 'f': False, '0': False,
             }   

    if isinstance(value, bool):
        return value

    if not isinstance(value, basestring):
        raise ValueError('invalid literal for boolean. Not a string.')

    lower_value = value.lower()
    if lower_value in valid:
        return valid[lower_value]
    else:
        raise ValueError('invalid literal for boolean: "%s"' % value)

# Test cases
assert to_bool('true'), '"true" is True' 
assert to_bool('True'), '"True" is True' 
assert to_bool('TRue'), '"TRue" is True' 
assert to_bool('TRUE'), '"TRUE" is True' 
assert to_bool('T'), '"T" is True' 
assert to_bool('t'), '"t" is True' 
assert to_bool('1'), '"1" is True' 
assert to_bool(True), 'True is True' 
assert to_bool(u'true'), 'unicode "true" is True'

assert to_bool('false') is False, '"false" is False' 
assert to_bool('False') is False, '"False" is False' 
assert to_bool('FAlse') is False, '"FAlse" is False' 
assert to_bool('FALSE') is False, '"FALSE" is False' 
assert to_bool('F') is False, '"F" is False' 
assert to_bool('f') is False, '"f" is False' 
assert to_bool('0') is False, '"0" is False' 
assert to_bool(False) is False, 'False is False'
assert to_bool(u'false') is False, 'unicode "false" is False'

# Expect ValueError to be raised for invalid parameter...
try:
    to_bool('')
    to_bool(12)
    to_bool([])
    to_bool('yes')
    to_bool('FOObar')
except ValueError, e:
    pass 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2020-04-21T09:53:44.793

> 更新
> 
> **注意：**如果它直接从用户那里获取输入，则永远不要使用`eval()`，因为它很容易被滥用：
> 
> `eval('os.system(‘rm -rf /’)')`
> 
> 但是干杯！研究还发现这`eval()`不是邪恶的，对于受信任的代码来说是完全可以的。您可以使用它来将布尔字符串（例如`"False"`和）转换`"True"`为布尔类型。

我想分享我的简单解决方案：使用`eval()`. 如果字符串完全采用标题格式或始终首字母大写`True`，则它将字符串转换为正确的布尔类型，否则该函数将引发错误。`False``True``False`

例如

```
>>> eval('False')
False

>>> eval('True')
True 
```

当然，对于动态变量，您可以简单地使用`.title()`来格式化布尔字符串。

```
>>> x = 'true'
>>> eval(x.title())
True 
```

这将引发错误。

```
>>> eval('true')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<string>", line 1, in <module>
NameError: name 'true' is not defined

>>> eval('false')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<string>", line 1, in <module>
NameError: name 'false' is not defined 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-02-17T18:57:43.370

这是我的版本。它检查正值和负值列表，引发未知值的异常。它不接收字符串，但任何类型都应该这样做。

```
def to_bool(value):
    """
       Converts 'something' to boolean. Raises exception for invalid formats
           Possible True  values: 1, True, "1", "TRue", "yes", "y", "t"
           Possible False values: 0, False, None, [], {}, "", "0", "faLse", "no", "n", "f", 0.0, ...
    """
    if str(value).lower() in ("yes", "y", "true",  "t", "1"): return True
    if str(value).lower() in ("no",  "n", "false", "f", "0", "0.0", "", "none", "[]", "{}"): return False
    raise Exception('Invalid value for boolean conversion: ' + str(value)) 
```

样品运行：

```
>>> to_bool(True)
True
>>> to_bool("tRUe")
True
>>> to_bool("1")
True
>>> to_bool(1)
True
>>> to_bool(2)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 9, in to_bool
Exception: Invalid value for boolean conversion: 2
>>> to_bool([])
False
>>> to_bool({})
False
>>> to_bool(None)
False
>>> to_bool("Wasssaaaaa")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 9, in to_bool
Exception: Invalid value for boolean conversion: Wasssaaaaa
>>> 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-04-03T19:53:23.203

你总是可以做类似的事情

```
myString = "false"
val = (myString == "true") 
```

括号中的位将评估为 False。这只是另一种无需进行实际函数调用的方法。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2013-02-18T22:21:51.763

一个很酷的简单技巧（基于@Alan Marchiori 发布的内容），但使用 yaml：

```
import yaml

parsed = yaml.load("true")
print bool(parsed) 
```

如果这太宽，可以通过测试类型结果来细化。如果 yaml 返回的类型是 str，那么它不能转换为任何其他类型（无论如何我都能想到），所以你可以单独处理它，或者让它成为真的。

我不会对速度做出任何猜测，但是由于无论如何我都是在 Qt gui 下使用 yaml 数据，所以这具有很好的对称性。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2012-11-26T10:04:22.103

我不同意这里的任何解决方案，因为它们太宽容了。在解析字符串时，这通常不是您想要的。

所以这里是我正在使用的解决方案：

```
def to_bool(bool_str):
    """Parse the string and return the boolean value encoded or raise an exception"""
    if isinstance(bool_str, basestring) and bool_str: 
        if bool_str.lower() in ['true', 't', '1']: return True
        elif bool_str.lower() in ['false', 'f', '0']: return False

    #if here we couldn't parse it
    raise ValueError("%s is no recognized as a boolean value" % bool_str) 
```

结果：

```
>>> [to_bool(v) for v in ['true','t','1','F','FALSE','0']]
[True, True, True, False, False, False]
>>> to_bool("")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 8, in to_bool
ValueError: '' is no recognized as a boolean value 
```

为了清楚起见，因为看起来我的回答似乎以某种方式冒犯了某人：

关键是您不想只测试一个值并假设另一个值。我不认为您总是想将 Absolutely 一切都映射到未解析的值。这会产生容易出错的代码。

因此，如果您知道要在其中编写什么代码。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-03-16T17:47:14.640

dict（实际上是 defaultdict）为您提供了一种非常简单的方法来完成此技巧：

```
from collections import defaultdict
bool_mapping = defaultdict(bool) # Will give you False for non-found values
for val in ['True', 'yes', ...]:
    bool_mapping[val] = True

print(bool_mapping['True']) # True
print(bool_mapping['kitten']) # False 
```

将此方法定制为您想要的确切转换行为真的很容易——您可以用允许的 Truthy 和 Falsy 值填充它，并在未找到值或默认为 True 时让它引发异常（或返回 None），或默认为 False，或任何您想要的。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2019-09-17T15:27:37.440

我用

```
# function
def toBool(x):
    return x in ("True","true",True)

# test cases
[[x, toBool(x)] for x in [True,"True","true",False,"False","false",None,1,0,-1,123]]
"""
Result:
[[True, True],
 ['True', True],
 ['true', True],
 [False, False],
 ['False', False],
 ['false', False],
 [None, False],
 [1, True],
 [0, False],
 [-1, False],
 [123, False]]
""" 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2010-01-15T18:13:01.873

您可能已经有了一个解决方案，但对于其他正在寻找一种使用“标准”假值（包括 None、[]、{} 和“”以及 false、no 和 0 ）将值转换为布尔值的方法的人来说.

```
def toBoolean( val ):
    """ 
    Get the boolean value of the provided input.

        If the value is a boolean return the value.
        Otherwise check to see if the value is in 
        ["false", "f", "no", "n", "none", "0", "[]", "{}", "" ]
        and returns True if value is not in the list
    """

    if val is True or val is False:
        return val

    falseItems = ["false", "f", "no", "n", "none", "0", "[]", "{}", "" ]

    return not str( val ).strip().lower() in falseItems 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-10-15T14:23:49.170

另一种选择

```
from ansible.module_utils.parsing.convert_bool import boolean
boolean('no')
# False
boolean('yEs')
# True
boolean('true')
# True 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-07-11T20:45:35.230

转换为 bool 的通常规则是一些特殊的文字（`False`, `0`, `0.0`, `()`, `[]`, `{}`）是假的，然后其他一切都是真的，所以我建议如下：

```
def boolify(val):
    if (isinstance(val, basestring) and bool(val)):
        return not val in ('False', '0', '0.0')
    else:
        return bool(val) 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2016-03-23T17:39:39.903

如果您知道您的输入将是“真”或“假”，那么为什么不使用：

```
def bool_convert(s):
    return s == "True" 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2012-05-14T17:07:45.410

这是我写的版本。将其他几种解决方案合并为一个。

```
def to_bool(value):
    """
    Converts 'something' to boolean. Raises exception if it gets a string it doesn't handle.
    Case is ignored for strings. These string values are handled:
      True: 'True', "1", "TRue", "yes", "y", "t"
      False: "", "0", "faLse", "no", "n", "f"
    Non-string values are passed to bool.
    """
    if type(value) == type(''):
        if value.lower() in ("yes", "y", "true",  "t", "1"):
            return True
        if value.lower() in ("no",  "n", "false", "f", "0", ""):
            return False
        raise Exception('Invalid value for boolean conversion: ' + value)
    return bool(value) 
```

如果它得到一个字符串，它需要特定的值，否则引发异常。如果它没有得到一个字符串，就让 bool 构造函数找出它。测试了这些案例：

```
test_cases = [
    ('true', True),
    ('t', True),
    ('yes', True),
    ('y', True),
    ('1', True),
    ('false', False),
    ('f', False),
    ('no', False),
    ('n', False),
    ('0', False),
    ('', False),
    (1, True),
    (0, False),
    (1.0, True),
    (0.0, False),
    ([], False),
    ({}, False),
    ((), False),
    ([1], True),
    ({1:2}, True),
    ((1,), True),
    (None, False),
    (object(), True),
    ] 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2018-07-23T17:12:47.873

如果您可以控制返回`true`/的实体`false`，一种选择是让它返回`1`/`0`而不是`true`/ `false`，那么：

`boolean_response = bool(int(response))`

处理来自网络的响应的额外转换`int`，这些响应始终是字符串。

2021 年更新：“它们总是字符串”——这是一个幼稚的观察。这取决于库使用的序列化协议。高级库（大多数 Web 开发人员使用的库）的*默认序列化通常是在序列化为字节之前转换为字符串。*然后另一方面，它从字节反序列化为字符串，因此您丢失了任何类型信息。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2019-06-13T06:46:00.253

如果你喜欢我，只需要来自字符串的变量的布尔值。您可以使用 @jzwiener 前面提到的 distils。但是我无法按照他的建议导入和使用该模块。

相反，我最终在 python3.7 上以这种方式使用它

[![distutils 字符串在 python 中为 bool](https://i.stack.imgur.com/r5Pje.png)](https://i.stack.imgur.com/r5Pje.png)

```
from distutils import util # to handle str to bool conversion
enable_deletion = 'False'
enable_deletion = bool(util.strtobool(enable_deletion)) 
```

**distutils 是 python std lib 的一部分，因此无需安装。太棒了！**

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2021-06-21T10:48:45.350

您还可以评估任何字符串文字：

```
import ast
ast.literal_eval('True')  # True
type(ast.literal_eval('True'))  # <class 'bool'>

ls = '[1, 2, 3]'
ast.literal_eval(ls)  # [1, 2, 3]
type(ast.literal_eval(ls))  # <class 'list'> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2021-10-19T13:47:22.503

我完全同意@Jacob\ Gabrielson 的解决方案，但事情`ast.literal_eval`只适用于字符串值，`True`而不`False`适用于`true`or `false`。所以你只需要使用`.title()`它来工作

```
import ast
ast.literal_eval("false".title())
# or
ast.literal_eval("False".title()) 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2021-12-02T16:02:34.253

通过使用下面的简单逻辑，您可以将字符串 a = 'true' 或 'false' 转换为布尔值。

```
a = a.lower() == 'true' 
```

如果 a == 'true' 那么这将设置 a=True 并且如果 a == 'false' 然后 a=False。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2012-08-01T13:07:39.643

我喜欢为此使用三元运算符，因为对于感觉不应该超过 1 行的东西来说，它更简洁一些。

```
True if myString=="True" else False 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-08-09T21:37:50.293

我意识到这是一篇旧文章，但有些解决方案需要相当多的代码，这就是我最终使用的：

```
def str2bool(value):
    return {"True": True, "true": True}.get(value, False) 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2019-02-20T12:59:49.667

使用包[str2bool](https://github.com/symonsoft/str2bool) `pip install str2bool`

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2021-05-26T17:37:10.047

我还被要求将输入更改`bool`为函数，而主要输入仅为`True`或`False`in `string`。所以，我只是这样编码：

```
def string_to_bool(s):
    bool_flag = True
    if s == "False":
        bool_flag = False
    elif s == "True":
        bool_flag = True
    else:
        print("Invalid Input")
    return bool_flag 
```

您还可以检查它以获取更短的`True`和`False`喜欢`Y/N`等`y/n`。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-07-11T21:31:45.480

这是一个毛茸茸的内置方法，可以得到许多相同的答案。请注意，尽管 python 认为`""`是 false 并且所有其他字符串都是 true，但 TCL 对事物的想法却截然不同。

```
>>> import Tkinter
>>> tk = Tkinter.Tk()
>>> var = Tkinter.BooleanVar(tk)
>>> var.set("false")
>>> var.get()
False
>>> var.set("1")
>>> var.get()
True
>>> var.set("[exec 'rm -r /']")
>>> var.get()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/lib-tk/Tkinter.py", line 324, in get
    return self._tk.getboolean(self._tk.globalgetvar(self._name))
_tkinter.TclError: 0expected boolean value but got "[exec 'rm -r /']"
>>> 
```

这样做的好处是它对您可以使用的值相当宽容。将字符串转换为值是懒惰的，它接受和拒绝什么是卫生的（请注意，如果在 tcl 提示符下给出上述语句，它将擦除用户硬盘）。

不好的是它要求 Tkinter 可用，这通常但并非普遍正确，更重要的是，它需要创建一个相对较重的 Tk 实例。

什么被认为是真或假取决于 的行为`Tcl_GetBoolean`，它认为**`0`**、**`false`**、**`no`**和**`off`**是假的并且**`1`**、**`true`**、**`yes`**和**`on`**是真的，不区分大小写。任何其他字符串，包括空字符串，都会导致异常。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-04-29T11:01:15.643

```
def str2bool(str):
  if isinstance(str, basestring) and str.lower() in ['0','false','no']:
    return False
  else:
    return bool(str) 
```

想法：检查您是否希望将字符串评估为 False；否则 bool() 对任何非空字符串返回 True。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-01-29T08:09:54.540

这是我汇总的一些东西来评估字符串的真实性：

```
def as_bool(val):
 if val:
  try:
   if not int(val): val=False
  except: pass
  try:
   if val.lower()=="false": val=False
  except: pass
 return bool(val) 
```

或多或少与使用相同的结果，`eval`但更安全。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-11-03T01:03:09.847

我只需要这样做......所以聚会可能迟到了 - 但有人可能会觉得它很有用

```
def str_to_bool(input, default):
    """
    | Default | not_default_str | input   | result
    | T       |  "false"        | "true"  |  T
    | T       |  "false"        | "false" |  F
    | F       |  "true"         | "true"  |  T
    | F       |  "true"         | "false" |  F

    """
    if default:
        not_default_str = "false"
    else:
        not_default_str = "true"

    if input.lower() == not_default_str:
        return not default
    else:
        return default 
```

* * *

## 回答 #33

> 赞同：-8
> 
> 时间：2017-11-22T15:22:23.840

通过使用 Python 的内置`eval()`函数和`.capitalize()`方法，您可以将任何“true”/“false”字符串（无论首字母大写如何）转换为真正的 Python 布尔值。

例如：

```
true_false = "trUE"
type(true_false)

# OUTPUT: <type 'str'>

true_false = eval(true_false.capitalize())
type(true_false)

# OUTPUT: <type 'bool'> 
```

# javascript - 在javascript中切换iframe滚动？

> ID：715421
> 
> 赞同：0
> 
> 时间：2009-04-03T19:45:38.743
> 
> 标签：javascript, iframe, scroll, scrollbar

如何在 javascript 中切换 iframe 在开、关和自动之间的滚动？我尝试将 frame.scrolling 属性更改为“yes”、“no”和“auto”，但没有任何效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T19:51:23.193

尝试设置 CSS 属性（overflow-x 和 overflow-y，或者只是溢出）。

链接：[http ://www.w3schools.com/Css/pr_pos_overflow.asp](http://www.w3schools.com/Css/pr_pos_overflow.asp)

# c# - AdSense 和 Webstats 等系统如何工作？

> ID：715428
> 
> 赞同：1
> 
> 时间：2009-04-03T19:48:16.100
> 
> 标签：c#, asp.net, remote-access, click-tracking

我正在考虑使用远程数据并实际在外部网站中接收或发送数据。万维网中存在大量示例正在运行。例如：免费的在线网络工具，如网络统计或 Google 的 AdSense ....。
你知道在这样的网络服务中，一些代码会为发布者生成，发布者将生成的代码放在她的网页文档（HTML 文件）的正文中，之后的系统就会工作。我们可以统计主页的访问次数、广告点击次数等。

**现在这是我的问题：这样的系统是如何工作的？以及如何调查和搜索它们以了解如何对其进行编程？你能给我一些关键词吗？我应该寻找哪些标题？哪些技术与这种编程相关？
正是我想找到一些相关的参考资料来学习和开始在这些系统上的一些经验。**

如果我的 Q 不明确，如果您愿意，我会进一步解释...
帮助我，我很困惑。

* * *

考虑到我是一名程序员，想要对这样的系统进行编程以不使用它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T00:07:08.543

有几种不同的方法可以跟踪点击次数。

## 重定向跟踪

一种是将广告（或任何链接）链接到重定向脚本。您通常会向它传递某种 ID，以便它知道应该转发到哪个 URL。但是在将用户重定向到该页面之前，它可以首先在数据库中记录该点击，该数据库可以存储用户 IP、时间戳、浏览器信息等。然后它将用户（在他们不知道的情况下）转发到指定的 URL。

```
广告--->重定向脚本（点击记录）--->登陆页面
```

## 像素追踪

另一种方法是使用像素跟踪。这是您将“像素”或一段 Javascript 代码放在网页正文上的地方。像素只是一个图像（或冒充图像的脚本），然后访问页面的用户将请求该图像。托管像素的跟踪器可以通过该图像请求记录相关信息。一些系统将使用 Javascript 而不是图像（或两者都使用）来跟踪点击。这可能允许他们使用 Javascript 的函数获得更多信息。

```
广告--->登陆页面--->用户请求像素（记录点击）
```

这是一个像素示例：`<img src="http://tracker.mydomain.com?id=55&type=png" />` 我在最后添加了 png，因为某些系统可能需要有效的图像文件类型。

## 隐藏追踪

如果您不希望用户知道跟踪器是什么，您可以在登录页面上放置代码以将数据传递给您的跟踪器。这将在后端（服务器端）完成，因此对用户是不可见的。本质上，您可以在通过 GET 参数传递相关数据的同时“请求”跟踪器 URL。然后，跟踪器将在登录页面的服务器上以非常有限的服务器负载记录该数据。

```
广告 ---> 登陆页面请求跟踪器 URL 并同时呈现页面
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:02:33.010

恐怕你的问题真的不清楚。

您是否试图找出有关谁使用您的网站、您获得多少点击等信息？像谷歌分析这样的东西可能就是你所追求的——看看这里[http://www.google.com/analytics/](http://www.google.com/analytics/)

**编辑：**添加更多信息以回应评论。

啊，好的，所以你想知道当这些网站使用谷歌广告时谷歌如何跟踪这些网站的点击？好吧，关于 Google AdSense 如何工作的完整讨论恐怕超出了我的范围 - 您可能会在 Google 本身和 Wikipedia 上找到一些有用的信息。

简而言之，在非常基本的层面上，Google Ads 的工作原理实际上是首先将点击定向到 Google - 如果您查看 Google 广告的 URL（例如在此站点上），您会看到 URL 以“ `http://googleads.g.doubleclick.net...`”开头（ Google 自己的双击），该 URL 还包含许多其他信息，这些信息允许 Google 检测点击的来源以及将您重定向到哪里以查看实际的广告网站。

谷歌分析略有不同，因为它是您在页面中运行的一小部分 JavaScript，但它也基本上向谷歌报告该页面被点击、您何时登陆以及您在页面上花费了多长时间。

就像我说的那样，对此的全面讨论恐怕超出了我的范围，对不起。

# java - java异常链接问题

> ID：715429
> 
> 赞同：2
> 
> 时间：2009-04-03T19:48:18.940
> 
> 标签：java, exception, chaining

想象一下我有以下方法：

```
public static void funcA() {...}

public static void funcB() 
{
    byteBuffer.wrap(someByteArray, 0, someByteArra.length);
} 
```

在 JAVA API 中：

```
public static ByteBuffer wrap(byte[]array, int offset, int length)
{
    try {
        return new HeapByteBuffer(array, offset, length);
    } catch (IllegalArgumentException x) {
        throw new IndexOutOfBoundsException();
    }
} 
```

函数链：funcB() -> ByteBuffer.wrap()

我的问题是 funcB 为什么不需要围绕这个抛出异常的 java api 方法执行 try-catch 块。funcB 在没有 try-catch 块的情况下编译得很好。我相信答案与 java api 方法抛出异常但未声明为“抛出 IndexOutOfBoundsException”这一事实有关

函数链：funcA() -> funcB() -> ByteBuffer.wrap(...)

我的下一个问题是，当我将*funcB*更改为“funcB() throws IndexOutOfBoundsException”时，为什么 funcA 不需要捕获 funcB 抛出的异常？编译器是否深入挖掘并意识到 ByteBuffer.wrap(...) 没有声明为“wrap() throws IndexOutOfBoundsException”，所以所有调用者实际上不需要捕获任何东西，甚至是子调用者（在这种情况下是 funcB）被声明为“funcB throws IndexOutOfBoundsException”？

抱歉，如果这令人困惑或难以理解。

请帮忙。

吉布

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-03T19:49:47.750

[IndexOutofBoundsException](http://java.sun.com/javase/6/docs/api/java/lang/IndexOutOfBoundsException.html)扩展[了 RuntimeException](http://java.sun.com/javase/6/docs/api/java/lang/RuntimeException.html)。它是一个运行时异常，不需要检查。

请参阅[未经检查的异常 - 争议。](http://java.sun.com/docs/books/tutorial/essential/exceptions/runtime.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T20:18:27.527

异常层次结构的顶部是 java.lang.Throwable。这是一个检查异常（编译器强制你捕获它或声明你抛出它）。

在 Throwable 下面有 Exception，也是一个检查的异常，还有 Error，一个未经检查的异常（编译器不会警告你）。

在 Exception 下面有 RuntimeException，也是一个未经检查的异常。

Java 的设计者打算使用异常的方式是：

*   例外，可能出错的事情
*   错误，可能出错的低级事物，程序无法从中恢复
*   RuntimeException, programmer errors (like going past the end of an array, or calling a method on null).

The idea behind not having to catch unchecked exceptions is that they indicate failures (VM level, or programmer) that either you cannot handle (VM error) or should not exist in a properly debugged program (programmer mistake).

Not everyone agrees with the intent of the designers of Java on this and chose to use RuntimeException to mean things other than programmer mistake.

# sql - 为什么 SQL Server 会丢失一毫秒？

> ID：715432
> 
> 赞同：70
> 
> 时间：2009-04-03T19:49:19.733
> 
> 标签：sql, sql-server

我有一个结构如下的表：

```
CREATE TABLE [TESTTABLE]
(
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [DateField] [datetime] NULL,
    [StringField] [varchar](50),
    [IntField] [int] NULL,
    [BitField] [bit] NULL
) 
```

我执行以下代码：

```
BEGIN 
   INSERT INTO TESTTABLE (IntField, BitField, StringField, DateField) 
   VALUES ('1', 1, 'hello', {ts '2009-04-03 15:41:27.378'});  

   SELECT SCOPE_IDENTITY()  
END 
```

进而

```
select * from testtable with (NOLOCK) 
```

我的结果显示：

```
2009-04-03 15:41:27.*377* 
```

为`DateField`列。

任何想法为什么我似乎失去了一毫秒？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-04-03T20:00:04.870

SQL Server 仅将时间存储到大约 1/300 秒。这些总是落在 0、3 和 7 毫秒。例如，以最小增量从 0 开始计数：

00:00:00.000
00:00:00.003
00:00:00.007
00:00:00.010
00:00:00.013
...

如果您需要毫秒级的精度，那么就没有什么好办法了。我见过的最佳选择是将值存储在自定义数字字段中并在每次获取值时重新构建它，或者将其存储为已知格式的字符串。然后，您可以（可选地）将“近似”日期存储在本机日期类型中，以提高速度，但它引入了通常不需要的概念复杂性。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-04-03T20:01:00.877

SQL Server 2008 具有更高的精度。datetime2 类型将准确存储如下值：2008-12-19 09:31:38.5670514（精确到 100 纳秒）。

参考：[时间和日期时间2 - 探索 SQL Server 2008 的新日期/时间数据类型](http://rwgarrison.com/PASS/TimeDateTime2/)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-04-03T19:51:58.463

SQL Server[`datetime`](http://msdn.microsoft.com/en-us/library/aa258277%28v=sql.80%29.aspx)类型的分辨率只有 1/300 秒 (~3.33̅ ms)，因此您可能会看到舍入错误。

请参阅[MSDN 日期时间 SQL Server 参考](http://msdn.microsoft.com/en-us/library/aa258277(SQL.80).aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-03T19:51:39.650

SQL Server 仅精确到 1/300 秒。它将值四舍五入到最接近的 1/300。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T19:52:45.623

DATETIME 没有无限精度 - 您可能正在使用无法用可用位准确表示的值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T19:52:29.243

SQL Server 以 3 毫秒的精度存储日期时间值。（我听说过这个，但找不到官方参考。）

# windows-mobile - Windows Mobile 的开发要求

> ID：715436
> 
> 赞同：1
> 
> 时间：2009-04-03T19:49:51.090
> 
> 标签：windows-mobile

我需要哪些 SDK 和其他工具才能编写在 Motorola Q9M 上运行的程序，运行 Windows Mobile 6 Standard？我在哪里可以找到为这款手机编写“hello world”的完整教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:56:20.950

您将需要 Windows Mobile SDK 和移动设备中心。

[http://www.microsoft.com/downloads/details.aspx?FamilyID=06111a3a-a651-4745-88ef-3d48091a390b&displaylang=en#filelist](http://www.microsoft.com/downloads/details.aspx?FamilyID=06111a3a-a651-4745-88ef-3d48091a390b&displaylang=en#filelist)

[http://www.microsoft.com/windowsmobile/en-us/help/synchronize/device-center-download.mspx](http://www.microsoft.com/windowsmobile/en-us/help/synchronize/device-center-download.mspx)

这里有一些很棒的开发资源：

[http://msdn.microsoft.com/sv-se/windowsmobile/bb250560(en-us).aspx](http://msdn.microsoft.com/sv-se/windowsmobile/bb250560(en-us).aspx)

[http://channel9.msdn.com/wiki/mobiledeveloper/homepage/](http://channel9.msdn.com/wiki/mobiledeveloper/homepage/)

# c# - 如何启动浏览器并稍后将其定向到页面？

> ID：715441
> 
> 赞同：1
> 
> 时间：2009-04-03T19:51:15.783
> 
> 标签：c#, internet-explorer, browser, navigation

我需要启动一个浏览器，做一些工作，然后让浏览器导航到一个 URL（按那个顺序）。
第一部分当然很简单，我有一个 Process 对象。我不知道以后如何将其定向到目标页面？

如何将 Process 视为浏览器并使其导航到所需页面？任何帮助，指针，代码片段表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T22:48:41.923

无需启动浏览器然后导航到页面，只需告诉操作系统您要运行 URL。Windows 将选择正确的浏览器，并将用户导航到给定的 URL。

```
System.Diagnostics.Process.Start("http://www.StackOverflow.com"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T09:01:15.947

如果您不需要在生产中执行此操作，您可以使用 WatiN 等测试库来执行此操作：

```
using WatiN.Core;

 //Placeholder page to launch initial browser
 IE ie = new IE("http://www.google.com");

 DoSomeWork();

 //Now navigate to the page you want
 ie.GoTo("http://stackoverflow.com"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T22:34:52.130

我对这个问题的第一直觉是 DDE，但它似乎已在 Windows Vista 中停用，所以这并不好。很遗憾，因为它是 Windows 中用于进程间通信 (IPC) 的唯一一致机制……哦，我多么想念 Amiga 上的 Arexx。

无论如何，我相信以下内容会起作用，但不幸的是，由于它的工作方式，无论配置的浏览器如何，它都会启动 Internet Explorer。

1.  如果您的应用程序有一个窗体，则在其上创建一个 WebBrowser 控件。将此设置为不可见，因为我们仅将其用作启动设备而不是显示网页。
2.  在代码中，在要显示网页的位置，使用以下代码：

    webBrowser1.DocumentText = "window.open('[如何启动浏览器并稍后将其定向到页面？](https://stackoverflow.com/questions/715441/how-to-launch-a-browser-and-later-direct-it-to-a-page) ', 'BananasAreOhSoYummy');";

它的作用是告诉 WebBrowser 控件，它只是伪装的 IE，打开一个名为“BananasAreOhSoYummy”的新窗口。因为我们给了窗口一个名字，所以我们可以用不同的 URL 重复使用该行来更改特定浏览器窗口中的页面。（如果用户碰巧将其关闭，则会打开一个新窗口。）

我将考虑一种尊重用户默认浏览器选择的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:01:56.287

如果不需要 IE 的实际实例，可以使用 System.Windows.Forms.WebBrowser 控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T20:06:56.557

我认为与其向浏览器发送 url，不如向它发送 javascript，该 javascript 将运行并将浏览器定向到站点。

不确定这是否可行，但我看不出为什么它不会

# asp.net-mvc - 是否应该使用 MVC 操作来处理 ajax 请求？没有“观点”？

> ID：715442
> 
> 赞同：0
> 
> 时间：2009-04-03T19:51:17.077
> 
> 标签：asp.net-mvc

现在我正在使用 mvc 操作来处理 ajax 请求（不像我有其他选择......但似乎有点错误）

这似乎很奇怪，因为该动作没有“观点”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T20:00:17.070

有一个“视图”——不一定是 HTML 视图。结果可以作为原始字符串、JSON、HTML、XML 等返回。这些都是数据的表示（视图），但不一定是可以直接在浏览器中呈现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T20:02:14.570

MVC 的好处之一是控制器不依赖于任何特定的视图实现。它的工作是接收请求并将数据打包发送回视图。无论是 AJAX 调用、网页、XML 页面还是其他东西，都与控制器完全无关。它的关注点分离。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T19:53:39.630

是的。这就是这个框架的工作原理。Theres`Controller.JSON`将返回 JSON 对象的函数。

# c# - 将文件附加到 Outlook

> ID：715446
> 
> 赞同：2
> 
> 时间：2009-04-03T19:52:00.397
> 
> 标签：c#, .net, winforms, outlook

我有以下从[MSDN](http://msdn.microsoft.com/en-us/library/ms268870.aspx)获得的代码。该代码似乎最初是在 Add In 中使用的，因此我遇到了该`this.Application.CreateItem(...)`部分的问题。从我的 winform 应用程序中，我需要做些什么不同的事情？

```
private void AddAttachment(){

Outlook.MailItem mail =this.Application.CreateItem(Outlook.OlItemType.olMailItem)as Outlook.MailItem;

mail.Subject = "An attachment for you!";

OpenFileDialog attachment = new OpenFileDialog();

attachment.Title = "Select a file to send";
attachment.ShowDialog();

if (attachment.FileName.Length > 0)
{
    mail.Attachments.Add(
        attachment.FileName,
        Outlook.OlAttachmentType.olByValue,
        1,
        attachment.FileName);
    mail.Recipients.Add("Armando Pinto ");
    ((Outlook._MailItem)mail).Send();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T21:28:47.263

确保您处于 VSTO 项目中，以便加载 Office 参考。如果它在那里抱怨，可能是因为它不知道你要创建什么对象。

# ruby-on-rails - 如何在 MVC 下创建一个简洁的 RESTful 向导？

> ID：715447
> 
> 赞同：10
> 
> 时间：2009-04-03T19:52:02.737
> 
> 标签：ruby-on-rails, asp.net-mvc, model-view-controller, rest

我尝试在构建应用程序时尽可能地使用 RESTful，但我永远不确定的一件事是如何创建向导式工作流程，保持 RESTful 和简洁。

以多页注册流程为例。

**选项 1：**我可以为每个步骤创建一个控制器，并在用户进入该步骤（或返回该步骤）时调用 new 或 edit。我以 step1_controller、step2_controller 等结尾...

**选项 2：**我可以创建一个控制器，并使用参数、会话变量、状态机等来跟踪它们在注册过程中的位置。所以我有 signup_controller/step?id=1

第一个选项是严格的 REST，但不是很简洁，并且以一些额外的控制器结束。第二种选择更简洁，但打破了REST，我愿意这样做，但我不会掉以轻心。

有更好的选择吗？

我正在使用 ruby​​ on rails，但这个问题适用于其他 MVC 实现，例如 ASP.NET MVC

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T21:52:18.127

如果在这里应用一些 DDD 逻辑，它补充了 MVC 中的“M”，那么 UI 的状态（注册进度）属于应用层，它可以直接与域和基础设施层对话（四层：UI、应用程序、域和基础设施）。DDD的概念让你先“思考”如何在代码中解决方案。让我们一步一步来...

## 这是进度条

您要在此处保持的状态是注册的步骤或进度。所以，我的第一步是记录进度或“步骤”。例如，第 1 步：获取用户名/密码，第 2 步：获取电子邮件。在这种情况下，我将应用逻辑将模型“移动”到下一步。最有可能使用 RegistrationService (RegistrationService.NextStep()) 上的 NextStep() 方法。

## 啊，不过属于App层

我将在应用程序层中创建一个名为 RegistrationService 的服务。我会在这里放置一个名为 NextStep() 的方法。但请记住，域不会在这里保存模型的状态。在这种情况下，您希望将状态集中在应用程序层。所以在这种情况下，NextStep() 不会作用于模型对象（因为它不是域责任的一部分），而是作用于 UI。因此，您需要一些东西来保留注册过程的状态。

## 远离领域模型，ViewModel 怎么样？

所以现在我们知道我们必须在 UI 中保留某些东西的状态。MVC 允许一个称为 ViewModels 的概念（在 ASP.NET MVC 中，不确定 RoR 叫什么）。ViewModel 表示将由视图和/或部分视图显示的模型。

ViewModel 将是保存此对象状态的绝佳场所。让我们称之为 RegistrationProgressViewModel() 并在其上粘贴 NextStep() 方法。当然，这意味着应用层必须保留 RegistrationProgressViewModel 的位置，而应用层将根据 NextStep 操作更改其内部结构。如果它很复杂，您可能希望在应用程序层中创建一个 RegistrationProgressService() 并将 NextStep() 放在其中以抽象您的逻辑。

## 如何传递 ViewModel？

最后一部分是如何跟踪该对象的状态。由于 Web 应用程序是无状态的，因此您必须通过应用程序以外的其他方式保留控制权。在这种情况下，我将恢复为：1）将 ViewModel 序列化到客户端并让客户端来回传递它，或者 2）保留 ViewModel 的服务器端副本，并来回传递某种类型的标识符给客户并返回。

这是一个值得思考的好例子，因为我自己还没有这样做过。对于#2，保存此 ViewModel 状态的最安全和最保险的方法是将其持久化到基础设施层（是的，APP 层可以直接与基础设施层对话）。这对我来说似乎需要做很多工作，因为有些东西可能会消失，我的数据库中会有部分注册。

但是，#2 会将用户的私人信息（用户名、密码、电子邮件、CC # 等）全部保存在服务器端，而不是来回传递。

## 终于有答案了！

所以，经过它，我们想出了：

*   在 Application 层创建一个 RegistrationProgressViewModel()。
*   在应用层创建一个带有 NextStep(ViewModel vm) 方法的 RegistrationProgressService()。
*   执行 NextStep() 时，通过 Infrastructure 层将 ViewModel 持久化到数据库中。

这样，您永远不必跟踪 View 或 UI 本身上的“step?id=2”，因为随着您的前进，ViewModel 会不断更新和更新（经过身份验证、验证、持久化到 DB）。

因此，您的下一个关注点是在 UI 中“前进”。这可以通过 1 个控制器轻松完成，使用步骤或命名步骤。

我很抱歉，但我在下面编写 C# 代码，因为那是我的语言。

```
public class RegistrationController : Controller
{
  // http://domain.com/register
  public ActionResult Index()
  {
    return View(new RegistrationProgressViewModel);
  }

  // http://domain.com/register
  // And this posts back to itself.  Note the setting 
  // of "CurrentStep" property on the model below.
  //
  public ActionResult Index(
      RegistrationProgressViewModel model)
  {

    // The logic in NextStep() here checks the
    // business rules around the ViewModel, verifies its
    // authenticity, if valid it increases the
    // ViewModel's "CurrentStep", and finally persists
    // the viewmodel to the DB through the Infrastructure
    // layer.
    //
    RegistrationProgressService.NextStep(model);

    switch (model.CurrentStep)
    {
      case 2:
        // wire up the View for Step2 here.
        ...
        return View(model);
      case 3:
        // wire up the View for Step3 here.
        ...
        return View(model);
      case 4:
        // wire up the View for Step4 here.
        ...
        return View(model);
      default:
        // return to first page
        ...
        return View(model);
    }
  }
} 
```

您会注意到，这将验证模型内部状态的“业务逻辑”抽象为 RegistrationProcessService.NextStep() 方法。

好的练习。:)

最后，您的“RESTful” url 是一个漂亮而干净的 POST 到：/register，它需要一个具有特定属性的 ViewModel。如果 ViewModel 无效，/register 不会进入下一步。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T19:58:24.033

实际上，我不太关心在一次性向导中维护 REST。我认为，REST 是最重要的，它具有可重复的操作——您希望 url 基本上是可收藏的，这样无论您何时去那里，您都可以返回相同的数据视图。在多步骤向导中，您的依赖项无论如何都会破坏 REST 的这种观点。我的感觉是拥有一个具有潜在单独操作或使用查询参数来指示您正在执行的步骤的单个控制器。无论如何，这就是我构建激活向导（需要多个步骤）的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-25T09:15:14.313

尽管答案确实是非常不错的选择，但我仍然使用以下方法：

[巨人的肩膀| 使用 ASP.Net MVC 的 RESTful 向导](http://shouldersofgiants.co.uk/Blog/post/2009/09/16/A-RESTful-Wizard-Using-ASPNet-MVCe280a6-Perhaps.aspx)。

绝对值得一看。虽然我必须说，这里给出的答案让我想在有时间的时候重新制作这个巫师。

# iphone - 如果我选择了基于视图的应用程序模板，是否可以添加更多内容视图？

> ID：715451
> 
> 赞同：0
> 
> 时间：2009-04-03T19:52:32.707
> 
> 标签：iphone

我开始使用基于视图的应用程序模板进行编程。现在，我发现我需要更多的内容视图（即设置页面、统计页面）。我真的不想在 XCode 中创建一个新项目并为将我的 nib 文件移植到那个新项目而苦苦挣扎，因为它非常复杂。我只想添加内容视图。或者这会比仅仅制作一个新项目并将所有内容移植到其中更有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T20:07:34.713

向您的项目添加更多视图应该很容易。通常会创建一个包含新视图的新 nib 文件，以及一个 UIViewController（或其子类）来配合它。

对于模态视图，您可以使用`presentModalViewController:animated:`当前视图控制器的方法来显示新视图。

或者使用 UITabBar 让用户在不同的视图之间切换。

# flash - YouTube 播放器上的 HTML 层

> ID：715456
> 
> 赞同：1
> 
> 时间：2009-04-03T19:52:58.820
> 
> 标签：flash, dhtml

这里的任何人都成功地在使用 swfobject（v1.5 或 2.0）嵌入的 YouTube 播放器之上分层 HTML 内容？

我可以在网站的其他区域通过 Flash 分层 HTML。问题是特定于 YouTube 的播放器和 IE6/7。

我在 HTML 层上使用绝对定位和 z-index。

我将 wmode=transparent 作为参数传递给 flash

```
var params = { allowScriptAccess: "always",wmode: "transparent" };
var atts = { id: "myytplayer" };
swfobject.embedSWF("http://www.youtube.com/v/ID_OF_VIDEO&amp;border=0&amp;enablejsapi=1&amp;playerapiid=ytplayer","ytapiplayer", "426", "357", "8", null, null, params, atts); 
```

更新：事实证明，youtube 容器的绝对定位阻止了 html 层出现在前面。我将 wmode 设置为“透明”，它在所有浏览器中都可以使用。感谢以下建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T08:38:32.427

您需要将**wmode**设置为**opaque**并且它应该可以工作。我今天遇到了同样的问题，所以我在这里发布我的解决方案（在 Firefox、IE6、IE7 中测试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T21:05:23.163

去年我遇到了类似的问题，并通过使用 CS3 生成的“正常”嵌入解决了它，我建议你试一试（至少出于调试目的）。

# sql - SQL 在 Where 语句中使用别名

> ID：715462
> 
> 赞同：41
> 
> 时间：2009-04-03T19:54:41.297
> 
> 标签：sql

我很清楚如何在 where 语句中使用别名。

例子 ：

```
SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM MyTable
WHERE Col1 = 'MySearch' 
```

我使用 MSSQL 2005

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-06-26T10:57:58.613

您可以使用“拥有”而不是“在哪里”。

```
SELECT
    SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM
    MyTable
HAVING
    Col1 = 'MySearch' 
```

执行查询后执行“where”。小心在正确的条件下使用它，以免出现性能问题。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-03T19:59:37.960

不可能，但您可以执行以下操作：

```
SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM MyTable
WHERE SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3) = 'MySearch' 
```

无需子查询或 hack

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-03T19:59:17.823

使用子查询：

```
SELECT * 
FROM 
  (SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3) AS Col1 FROM MyTable)
WHERE Col1 = 'MySearch' 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-03T19:59:16.293

```
SELECT * FROM (
  SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
  FROM MyTable
)
WHERE Col1 = 'MySearch' 
```

（我知道这适用于 Oracle，我相信它是标准 SQL 并且适用于 MSSQL。）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-03T20:16:15.877

你可以这样做：

```
SELECT Col1
FROM ( SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3) AS Col1 ) AS x
WHERE Col1 = 'MySearch' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-30T20:48:16.737

使用 PostgreSQL 9.3+ OR Oracle 12c，现在有允许创建别名的横向连接。

横向连接是女巫内部的关节，您可以参考前面的表格。

```
SELECT col1, col2,col3
FROM MyTable m
JOIN LATERAL (
    SELECT SUBSTRING(m.Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1 
) x ON true
WHERE Col1 = 'MySearch' 
```

使用此语法，您不必使用可能会出现故障或重新复制所有列的“*”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T19:57:43.893

我认为这是不可能的，但也许你可以看看 Common Table Expressions over SQL 2005

像这样：

```
WITH MyCTE( Col1) AS
(
SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM MyTable
)
SELECT *
FROM MyCTE
WHERE Col1 = 'MySearch' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T20:00:53.963

使用视图或派生表。

使用派生表，您的示例将如下所示：

```
select col1 
from 
(SELECT SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM MyTable) 
where col1='Mysearch' 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T20:06:35.247

实际上，使用别名不会使您的查询更快，因为 SQL 优化器并不像您想象的那么愚蠢，所以我只是再次重复 SUBSTRING 表达式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T20:02:35.177

答案是你不能——你可以这样做

```
SELECT 
    SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3)  AS Col1
FROM 
    MyTable
WHERE 
    SUBSTRING(Column1, 1, 4) + SUBSTRING(Column1, 4, 3) = 'MySearch' 
```

# html - 无线电输入的替代方案

> ID：715471
> 
> 赞同：3
> 
> 时间：2009-04-03T19:57:19.997
> 
> 标签：html, css

我正在尝试制作一个系统，要求用户指定他们提交的内容类型，使用 PNG 图标来表示每种类型。理想情况下，我想要的是一组三个按钮（上面有图像），它们的行为类似于单选按钮 - 用户可以使用箭头键在它们之间切换，它们被视为一组，等等。然而，这似乎是不可能的，我能得到的最接近的是将图像放在预先存在的单选按钮旁边。有没有“伪造”这个功能的好方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T20:05:17.213

我建议使用单选按钮，因为用户会识别这些输入，并且它可以在没有 javascript 的情况下工作。

```
<form>
<input type="radio" name="sex" value="male" id="male"/><label for="male">Male</label>
<br />
<input type="radio" name="sex" value="female" id="female" /> <label for="female">Female</label>
</form> 
```

然后，您可以在标签内放一张图片，或者更好的是，放一张背景图片来补充文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:03:34.520

当然，为每个图像制作两个变体（正常和突出显示）并使用 JavaScript 记住选择了哪一个并切换图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T20:12:43.810

图片旁边的单选按钮怎么样。然后使用 JavaScript 隐藏单选按钮并在单击图像时更改（隐藏的）选定单选。将其与所选图像上的某种高亮效果相结合，您就有了一个有吸引力的界面，可以很好地降级。JQuery 或类似的 JavaScript 库将有助于实现这一目标。

# .net - 帮助我开始在 Visual Studio 2008 中进行单元测试

> ID：715472
> 
> 赞同：7
> 
> 时间：2009-04-03T19:57:41.757
> 
> 标签：.net, visual-studio, unit-testing, tdd

在花了几个小时在 StackOverflow 和其他网站上阅读单元测试和测试驱动开发之后，我知道了两件事：

1.  我想用它
2.  我不知道从哪里开始

这里有很多关于细节、最佳实践等的好帖子，但我正在寻找的是初学者教程/介绍——甚至可能是一本书。

我从哪里开始？假设我什么都不知道。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T20:04:08.387

获取书籍[Pragmatic Unit Testing in C# with NUnit](http://www.pragprog.com/titles/utc2/pragmatic-unit-testing-in-c-with-nunit)或[Test-Driven Development with Microsoft.NET](https://rads.stackoverflow.com/amzn/click/com/0735619484)并完成其中之一。这些原则将适用于许多不同的测试框架，尽管具体的习惯用法可能不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T20:01:27.787

[在http://www.asp.net/learn/](http://www.asp.net/learn/)观看单元测试相关的截屏视频和视频

还可以在这里查看（与单元测试相关的 MSDN 网络广播）：

[http://www.google.com/search?q=unit+testing+site%3Amsevents.microsoft.com](http://www.google.com/search?q=unit+testing+site%3Amsevents.microsoft.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T20:20:51.203

编写一个简单的计算器类，其中包含一些操作方法和指标属性。在编写类时创建单元测试。

然后阅读有效地使用遗留代码——它将向您展示如何将单元测试添加到旧的讨厌的项目中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T20:26:05.090

对我来说，我是从为我们的一些低级字符串操作代码编写单元测试开始的。我创建了一个新项目作为测试并链接到字符串库中。然后，我检查了每种方法并为它们编写了单元测试——边界条件、已知输入的预期输出等。起初它看起来像是一个盲目的练习，但后来......

我发现了一个BUG！！

我被卖了。

所以现在我正在添加到测试项目中，因为我在我们图书馆的食物链中向上移动。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T07:57:43.977

我会下载[ReSharper](http://www.jetbrains.com/resharper/)（以及以下插件：Exceptional、Agent Smith、Agent Johnsson），这是提高代码质量和加快开发速度的第一大工具。Resharper 不是免费的，但物有所值；）

然后下载Xunit：http: [//xunit.codeplex.com](http://xunit.codeplex.com)

创建测试很简单：

```
public class MyObjectTest
{
  MyObject _objectToTest = new MyObject();

  [Fact]
  private void TestStart()
  {
    _objectToTest.Start();
    Assert.True(_objectToTest.IsStarted);
  }
} 
```

与 xunit 集成的 ReSharper 会在每个测试方法旁边为您提供一个图标。该图标使您可以直接在 IDE 中测试（和调试）该方法，而无需启动整个程序。再简单不过了。

大多数开发人员会说测试驱动开发意味着您首先创建测试，然后创建对象。我通常从创建类开始，向其中添加强制方法，然后创建测试。它要快一点，当您开始构建测试时，您可能会开始重构该类。

创建类时，大部分时间都在记录每个方法。文档应该说明该方法存在的原因、它对参数的期望以及它返回的内容。如果你不能正确地描述它，你很可能不得不重构它。

# iphone - 在 osX 上的 SQLITE3 col 中插入数据时遇到问题

> ID：715486
> 
> 赞同：1
> 
> 时间：2009-04-03T20:00:23.840
> 
> 标签：iphone, sqlite, png, terminal

如何在 osx（命令行）上的 SQLITE3 中将文件数据（png）插入 col 以及用作容器的更好类型是什么？blob 还是二进制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T20:17:31.240

我认为 SQLite 监视器没有办法将二进制数据加载到列中。最好的办法是编写一个小程序来做你需要的事情——不应该超过几行 Perl、Ruby 或 Python。

# ruby - 我头上的“Programming Ruby”中的method_missing

> ID：715490
> 
> 赞同：2
> 
> 时间：2009-04-03T20:01:15.273
> 
> 标签：ruby, method-missing

**方法缺失**

*obj.method_missing( 符号 h , *args i ) → other_obj*

> 当 obj 收到无法处理的消息时由 Ruby 调用。symbol 是被调用方法的符号，args 是传递给它的任何参数。下面的示例创建了一个 Roman 类，它响应名称由罗马数字组成的方法，并返回相应的整数值。method_missing 的一个更典型的用途是实现代理、委托和转发器。

```
class Roman
  def roman_to_int(str)
    # ...
  end
  def method_missing(method_id)
    str = method_id.id2name
    roman_to_int(str)
  end
end
r = Roman.new
r.iv ! 4
r.xxiii ! 23
r.mm ! 2000 
```

我刚刚听说缺少方法，并在*[Programming Ruby](http://www.ruby-doc.org/docs/ProgrammingRuby/)*中找到了更多信息，但是书中引用的上述解释超出了我的理解。有没有人有更简单的解释？更具体地说，缺少方法是否仅由解释器使用，或者是否需要直接在程序中调用它（假设我只是在编写 Web 应用程序，而不是为 NASA 编写代码）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T20:29:51.117

最好不要将 ruby​​ 视为具有方法。当您调用 ruby​​ “方法”时，您实际上是在向该实例（或类）发送消息，并且如果您为消息定义了一个处理程序，它用于处理和返回一个值。

`method_missing`每当 ruby​​ 找不到合适的处理程序时，就会调用一个特殊的定义。您也可以将其视为一种`*`方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T20:07:28.147

对于不匹配任何方法的消息，它基本上是一个包罗万象的方法。它广泛用于动态查找器的活动记录中。这就是让你写这样的东西的原因：

```
SomeModel.find_by_name_and_number(a_name, a_number) 
```

该模型不包含该 find_by 的代码，因此调用了 method_missing 来查看是说 - 我识别该格式并执行它。如果没有，那么你会得到一个未找到方法的错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T21:18:12.313

Ruby 没有任何类型强制，同样在第一次解析脚本时也不会检查对象具有哪些方法，因为这可以在应用程序运行时动态更改。

method_missing 的作用是让您拦截和处理对给定对象不存在的方法的调用。这提供了几乎所有用 Ruby 编写的 DSL（特定领域语言）背后的强大功能。

在示例的情况下，'r.iv'、'r.mm' 等中的每一个实际上都是对 Roman 对象的方法调用。当然，它没有 'iv' 或 'mm' 方法，因此将控制权传递给 method_missing，它获取被调用方法的名称以及传递的任何参数。

method_missing 然后将方法名称从符号转换为字符串，并将其解析为罗马数字，将输出作为整数返回。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T20:18:04.017

在您提供的罗马示例中，它说明了如何在不显式定义方法的情况下扩展类的功能。

r.iv 不是一个方法，所以`method_missing`捕获它并调用`roman_to_int`方法 id "iv"

正如文档所述，当您想要在其他地方处理无法识别的方法时，它也很有用，例如代理、委托和转发器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T20:35:44.740

您不调用“ `method_missing`”（解释器调用它）。相反，您为要使其更灵活的类*定义它（覆盖它）。*正如其他评论中提到的，`method_missing`当类（或实例）没有（“显式”？）定义请求的方法时，解释器将调用您的版本。这使您有机会根据 ersatz 方法/消息名称进行编造。

你曾经用 Java 做过任何“反射”编程吗？使用此方法就好像要通过反射访问的类可以查看方法名称的字符串（对不起，“符号”），如果抛出了 no-such-method 异常，然后将某些内容作为该方法的即时实施。

动态编程是一种反思的“单向”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T21:30:23.140

既然您提到了 Web 应用程序，我猜您应该熟悉 Ruby on Rails。如何使用的一个很好的例子是可用`method_missing`的不同`find_by_<whatever>`方法。这些方法实际上都不存在！它们是在运行时合成的。所有这些魔法的发生都是因为 ruby​​ 如何拦截对不存在方法的调用。

[您可以在此处](http://www.thirdbit.net/articles/2007/08/01/10-things-you-should-know-about-method_missing/)阅读更多关于method_missing 和其他用途的信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-16T05:17:26.893

ActiveRecord 用于`method_missing`定义 find_by 方法。但是因为，`method_missing`基本上是最后的手段，这可能是一个严重的性能瓶颈。我发现 ActiveRecord 通过将新的 finder 方法定义为类方法来进行一些更棒的元编程！因此，对同一个 finder 方法的任何进一步调用都不会命中，`method_missing`因为它现在是一个类方法。有关 base.rb 中实际代码片段的详细信息，请单击[此处](http://www.kesava.me/blog/2011/08/15/dynamic-finders/)。

# objective-c - 如何在objective-c / UIKit中制作一种多维关联数组？

> ID：715493
> 
> 赞同：0
> 
> 时间：2009-04-03T20:01:51.920
> 
> 标签：objective-c, iphone

问题：我有一组图像，比如说 5。有一个结构在我的上下文中定义了一个“图像对象”。

每个这样的图像对象都有以下信息：

*   图像文件的名称（即“myImage.png”）
*   xOffsetPx
*   yOffsetPx
*   宽度
*   高度

图像应该显示在视图中非常特定的位置，因此我需要将所有这些信息存储在某种多维关联数组（或类似数组）中。图像的名称将是密钥或 ID。

一个月前，我在我的 1000 页 Objective-c 书中偶然发现了类似的内容，但现在找不到了。这里有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T20:06:22.390

除非我完全误解了这个问题——为什么不从这些属性中创建一个实际的对象（或结构）并将其存储为字典中的值呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T20:14:30.360

最简单的方法是只使用字典：

```
NSMutableDictionary *images;

NSDictionary *myPictureAttributes = [NSDictionary dictionaryWithObjects:
    [NSArray arrayWithObjects:[NSNumber numberWithFloat:30],
                              [NSNumber numberWithFloat:10],
                              [NSNumber numberWithFloat:15],
                              [NSNumber numberWithFloat:15], nil],
    forKeys:[NSArray arrayWithObjects:@"xOffsetPx",
                              @"yOffsetPx",
                              @"width",
                              @"height", nil]];
[images setObject:myPictureAttributes forKey:@"myImage.png"]; 
```

您可能希望您的属性是某种常量，以便编译器可以在您出现拼写错误时警告您。您还可以有一个简单的数据对象类，上面有一些属性，然后设置这些属性并将对象直接添加到字典中。根据您的具体要求，还有许多其他方法可以解决此问题，但 NSDictionary 是 Cocoa 中用于关联数组的基本集合类。

# c - 链接器如何决定要包含库的哪些部分？

> ID：715502
> 
> 赞同：8
> 
> 时间：2009-04-03T20:04:05.987
> 
> 标签：c, linker

假设库 A 有 a() 和 b()。如果我将我的程序 B 与 A 链接并调用 a()，b() 是否包含在二进制文件中？编译器是否查看程序中是否有任何函数调用 b()（可能是 a() 调用 b() 或另一个 lib 调用 b()）？如果是这样，编译器如何获得这些信息？如果不是，如果我链接到一个大库但只使用一个次要功能，这不是对最终编译大小的巨大浪费吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T20:09:07.877

看看[链接时优化](http://en.wikipedia.org/wiki/Link-time_optimization)。这必然取决于供应商。它还取决于您如何构建二进制文件。MS 编译器（至少从 2005 年开始）提供了一种叫做[函数级链接](http://msdn.microsoft.com/en-us/library/xsa71f43(VS.80).aspx)的东西——这是另一种去除不需要的符号的方法。[这篇](https://ribosome.helixcommunity.org/2005/devdocs/FuncLevelLinking)文章解释了如何使用 GCC 来实现相同的效果（这是旧的，GCC 必须继续前进，但内容与您的问题相关）。

另请查看[LLVM](http://llvm.org/docs/LinkTimeOptimization.html#phase3)实现（和示例部分）。

我建议你也看看John Levine 的[Linkers and Loaders —— 一本优秀的读物。](https://rads.stackoverflow.com/amzn/click/com/1558604960)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T20:42:26.673

这取决于。

如果库是共享对象或 DLL，则库中的所有内容都会被加载，但在运行时加载。通过在内存中使用该库的所有进程之间共享库（实际上是代码页）来抵消额外内存的成本。这对于 .so 之类的东西来说是一个巨大的胜利，而对于`libc`.so 来说则不然`myreallyobscurelibrary.so`。但是你可能不是在问共享对象，真的。

静态库是单个目标文件的简单集合，每个目标文件都是单独编译（或汇编）的结果，甚至可能不是用相同的源语言编写的。每个目标文件都有许多导出的符号，而且几乎总是有许多导入的符号。

链接器的工作是创建一个已完成的可执行文件，其中没有剩余的未定义导入符号。（当然，如果允许动态链接，我在撒谎，但请耐心等待。）为此，它从链接命令行上显式命名的模块开始（并且可能在其配置中隐含）并假定任何模块显式命名必须是完成的可执行文件的一部分。然后它会尝试查找所有未定义符号的定义。

通常，命名的对象模块期望从某些库中获取符号，例如`libc.a`.

在您的示例中，您有一个调用 function 的模块`a()`，这将导致链接器查找 export 的模块`a()`。

您说名为 A 的库（在 unix 上，可能`libA.a`）提供`a()`and `b()`，但您没有指定如何。你暗示了这一点`a()`，`b()`不要互相打电话，我会假设。

如果`libA.a`是从每个定义相应的单个函数的位置构建的，则链接器将包含`a.o`和忽略。`b.o``a.o``b.o`

但是，如果`libA.a`包含`ab.o`两个都定义的`a()`，`b()`那么它将包含`ab.o`在链接中，满足对 的需求`a()`，并包括未使用的功能`b()`。

正如其他人所提到的，有些链接器能够将单个功能从模块中分离出来，并且只包括那些实际使用的功能。在许多情况下，这样做是安全的。但通常最安全的做法是假设您的链接器不会这样做，除非您有特定的文档。

还有一点需要注意的是，大多数链接器会尽可能少地通过命令行上命名的文件和库，并在运行时构建它们的符号表。实际上，这意味着最好总是在链接命令行上的所有对象模块之后指定库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T20:15:54.973

这取决于链接器。

例如。Microsoft Visual C++ 有一个“启用函数级链接”选项，因此您可以手动启用它。

（我认为他们有理由不只是一直启用它……也许链接速度较慢或其他原因）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T20:20:18.787

通常（静态）库由从源文件创建的对象组成。如果引用了该对象提供的函数，则链接器通常会包含该对象。如果您的源文件只包含一个函数，那么链接器将只引入该函数。那里有更复杂的链接器，但大多数基于 C 的链接器仍然像概述的那样工作。有一些工具可以将包含多个函数的 C 源代码拆分为人为的更小的源文件，以使静态链接更加精细。

如果您使用的是共享库，那么您不会通过使用更多或更少的共享库来影响您的编译大小。但是，您的运行时大小将包括它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T20:34:11.403

学术地球上的这个[讲座](http://academicearth.org/lectures/naming)给出了一个很好的概述，在演讲的后半部分，IIRC 附近讨论了链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T20:08:02.420

它取决于链接器，但通常只有实际调用的函数才会包含在最终的可执行文件中。链接器通过在库中查找函数名称然后使用与该名称关联的代码来工作。

关于链接器的书籍很少，当您认为它们有多重要时，这很奇怪。一个好的文本可以在[这里](http://www.iecc.com/linker/)找到。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T20:08:55.177

没有任何优化，是的，它将被包括在内。但是，链接器可能能够通过静态分析代码并尝试删除无法访问的代码来进行优化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T21:21:52.943

这取决于链接器和库的构建方式。通常库是目标文件的组合（导入库是一个主要的例外）。较旧的链接器会以放入库中的目标文件的粒度将内容拉入输出文件图像。因此，如果函数`a()`和函数`b()`都在同一个目标文件中，那么它们都会在输出文件中——即使实际上只引用了这两个函数中的一个。

这就是为什么您经常会看到面向库的项目采用每个源文件一个 C 函数的策略的原因。这样，每个函数都打包在自己的目标文件中，链接器只提取引用的内容没有问题。

但是请注意，较新的链接器（当然是较新的 Microsoft 链接器）能够仅拉入被引用的目标文件的一部分，因此现在不需要强制执行每个源文件一个功能的策略 - 尽管有为了可维护性无论如何都应该这样做的合理论据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T20:33:40.640

它取决于传递给链接器的选项，但通常链接器会忽略库中未在任何地方引用的目标文件。

```
$ cat foo.c
int main(){}

$ gcc -static foo.c

$ size
   text    data     bss     dec     hex filename
 452659    1928    6880  461467   70a9b a.out

# force linking of libz.a even though it isn't used
$ gcc -static foo.c -Wl,-whole-archive -lz -Wl,-no-whole-archive

$ size
   text    data     bss     dec     hex filename
 517951    2180    6844  526975   80a7f a.out 
```

# tomcat - 如何更改ROOT应用程序？

> ID：715506
> 
> 赞同：135
> 
> 时间：2009-04-03T20:05:12.580
> 
> 标签：tomcat, tomcat6

我正在尝试将 Tomcat 6 网络服务器的默认应用程序更改为与“ROOT”不同的应用程序（在 webapps 文件夹内）。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2011-05-23T06:37:15.897

有以下三种方法：

*   首先从其`bin`目录 ( `sh shutdown.sh`) 中关闭您的 Tomcat。然后删除 Tomcat`webapps`文件夹 ( `rm -fr *`) 的所有内容。然后将 WAR 文件重命名为`ROOT.war`，最后从`bin`目录 ( `sh startup.sh`) 启动 Tomcat。

*   将您的战争文件保留`$CATALINA_BASE/webapps`在其原始名称下。在文件的 Host 元素中关闭 **autoDeploy**和**deployOnStartup**`server.xml`。在 中显式定义所有应用程序上下文`server.xml`，同时指定**path** 和**docBase**属性。您必须这样做，因为您已禁用所有 Tomcat 自动部署机制，并且 Tomcat 将不再部署您的应用程序，除非它在`server.xml`​​.

    > 第二种方法：为了对任何应用程序进行任何更改，您必须停止并重新启动 Tomcat。

*   将您的 WAR 文件放在外面`$CATALINA_BASE/webapps`（它必须在外面以防止双重部署）。放置一个名为`ROOT.xml`. `$CATALINA_BASE/conf/`此上下文文件中的单个元素必须具有 指向 WAR 文件位置的**docBase属性。**不应设置路径元素 -`.xml`在这种情况下，它是从文件名派生的`ROOT.xml`。有关详细信息，请参阅[Context 容器的文档](http://tomcat.apache.org/tomcat-6.0-doc/config/context.html)。

[参考](http://wiki.apache.org/tomcat/HowTo#How_do_I_make_my_web_application_be_the_Tomcat_default_application_.3F)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-08-14T08:22:56.840

在具有这些更改的 Tomcat 7 中，我可以访问`myAPP`at`/`和`ROOT`at`/ROOT`

```
<Context path="" docBase="myAPP"/>
<Context path="ROOT" docBase="ROOT"/> 
```

将上面添加到`<Host>`server.xml 中的部分

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-03-03T08:11:14.847

在 Tomcat 6 的标签中添加`<Context>`标签将解决该问题。`<Host>``server.xml`

如果您使用`path=""`空的，您可以使用类似`http://localhost/first.do`.

在上下文标签中设置属性`docBase="E:\struts-ITRCbook\myStrutsbook"`和`reloadable="true"`，然后结束上下文标签。

它应该看起来像这样：

```
<Host name="localhost"  appBase="webapps" 
        unpackWARs="true" autoDeploy="true"
        xmlValidation="false" xmlNamespaceAware="false">
    <Context path="" docBase="E:\struts-ITRCbook\myStrutsbook" reloadable="true">
    </Context>
</Host> 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-11-03T17:07:57.073

ROOT 默认应用程序通常是 Tomcat 管理器——它很有用，所以我想保留它。

所以我让***我的***应用程序 ROOT 并保持 TCmgr 的方式是这样的。

将 ROOT 重命名为别的东西

```
mv ROOT TCmgr 
```

然后创建了一个符号链接，ROOT 指向我要设为默认的应用程序。

```
ln -s <your app> ROOT 
```

为我工作，似乎是最简单的方法。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-03T20:09:42.227

根据 Apache Tomcat 文档，您可以通过创建 ROOT.xml 文件来更改应用程序。有关更多信息，请参见：

[http://tomcat.apache.org/tomcat-6.0-doc/config/context.html](http://tomcat.apache.org/tomcat-6.0-doc/config/context.html)

“可以使用名为 ROOT.xml 的文件定义默认 Web 应用程序。”

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-04-03T21:09:11.930

您可以通过以下方式以稍微 hack-y 的方式执行此操作：

1.  停止 Tomcat
2.  将 ROOT.war 移到一边，然后 rm -rf webapps/ROOT
3.  将你想要的 webapp 复制到 webapps/ROOT.war
4.  启动Tomcat

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-07-11T18:02:45.993

另一种解决方案是创建一个 servlet，将重定向发送到所需的默认 webapp，并将该 servlet 映射到 ROOT webapp 中的所有 url。

```
package com.example.servlet;

import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class RedirectServlet extends HttpServlet {

  @Override
  public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    response.sendRedirect("/myRootWebapp");
  }
} 
```

将上述类添加到
`CATALINA_BASE/webapps/ROOT/WEB-INF/classes/com/example/servlet`.
并将以下内容添加到
`CATALINA_BASE/webapps/ROOT/WEB-INF/web.xml`：

```
 <servlet>
    <display-name>Redirect</display-name>
    <servlet-name>Redirect</servlet-name>
    <servlet-class>com.example.servlet.RedirectServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>Redirect</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping> 
```

如果需要，您可以轻松地修改 RedirectServlet 以接受 init 参数，从而允许您设置默认 webapp 而无需修改源。

我不确定这样做是否会产生任何负面影响，但我确实对此进行了测试，它似乎确实有效。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-01-11T16:38:57.173

context.xml 配置对我不起作用。Tomcat 6.0.29 抱怨 docBase 在 appBase 内：...对于 Tomcat 5，这确实有效。

因此，一种解决方案是将应用程序放在 ROOT 文件夹中。

另一个非常简单的解决方案是将 index.jsp 放入 ROOT 以重定向到我的应用程序，如下所示： response.sendRedirect("/MyApplicationXy");

最好的问候，扬

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-24T16:24:35.170

配置 Tomcat`server.xml`并添加 Context 元素时出现问题。他只是不想使用我的配置： [http ://www.oreillynet.com/onjava/blog/2006/12/configuration_antipatterns_tom.html](http://www.oreillynet.com/onjava/blog/2006/12/configuration_antipatterns_tom.html)

如果您在`Unix-like`系统中：

1.  `mv $CATALINA_HOME/webapps/ROOT $CATALINA_HOME/webapps/___ROOT`
2.  `ln -s $CATALINA_HOME/webapps/your_project $CATALINA_HOME/webapps/ROOT`

完毕。

为我工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-04-26T09:44:21.487

更改 tomcat 根应用程序的终极方法。在 Tomcat 7 和 8 上测试。

1.  移动到 tomcat webapps 目录：

    我的机器上的示例：`~/stack/apache-tomcat/webapps`

2.  重命名、替换或删除 ROOT 文件夹。我的建议是重命名或创建备份副本。示例将 ROOT 重命名为 RENAMED_ROOT：

    `mv ROOT RENAMED_ROOT`

3.  将您的应用程序的war文件移动到tomcat webapps目录（它是旧ROOT文件夹的目录，在我的机器上：~/stack/apache-tomcat/webapps）

> War 文件必须有一个名称**ROOT.war**。如果需要，重命名您的应用程序：**yourApplicationName.war -> ROOT.war**

4.  重启tomcat。重新启动后，您的应用程序将成为 root。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T20:10:29.293

我会看看我的文档；有一种方法可以指定配置来更改根 Web 应用程序的路径远离 ROOT（或 ROOT.war），但它似乎在 Tomcat 5 和 6 之间发生了变化。

发现这个：

[http://www.nabble.com/Re:-Tomcat-6-and-ROOT-application...-td20017401.html](http://www.nabble.com/Re:-Tomcat-6-and-ROOT-application...-td20017401.html)

因此，似乎可以更改根路径（在 ROOT.xml 中），但有点损坏——您需要将 WAR 移到自动部署目录之外。介意我问为什么只是将文件重命名为 ROOT.war 不是一个可行的解决方案？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-10T15:56:16.737

这不是一个很好的解决方案，但一种方法是从 ROOT 应用程序重定向到 YourWebApp。为此，您需要修改 ROOT index.html。

```
<html>
    <head>
        <title>Redirecting to /YourWebApp</title>
    </head>
    <body onLoad="javascript:window.location='YourWebApp';">
    </body>
</html> 
```

或者

```
<html>
    <head>
        <title>Redirecting to /YourWebApp</title>
        <meta http-equiv="refresh" content="0;url=YourWebApp" />
    </head>
    <body>
    </body>
</html> 
```

参考：[http ://staraphd.blogspot.com/2009/10/change-default-root-folder-in-tomcat.html](http://staraphd.blogspot.com/2009/10/change-default-root-folder-in-tomcat.html)

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2014-01-17T15:36:11.117

在 Tomcat 7（在 Windows 服务器下）中，我没有向任何配置文件添加或编辑任何内容。我刚刚将 ROOT 文件夹重命名为其他文件夹，并将我的应用程序文件夹重命名为 ROOT，它运行良好。

# php - array_flip 某些键

> ID：715510
> 
> 赞同：0
> 
> 时间：2009-04-03T20:06:09.617
> 
> 标签：php, arrays

用键 2 翻转键 1 的好方法是什么？

```
// original
Array
(
    [0] => Text1
    [1] => World
    [2] => Hello
)

// after

Array
(
    [0] => Text1
    [1] => Hello
    [2] => World
) 
```

任何线索。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T20:08:57.533

如果就这么简单，

```
$tmp = $array[1];
$array[1] = $array[2];
$array[2] = $tmp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:09:40.433

```
$A = array("Text1", "Hello", "World");
$tmp = $A[2];
$A[2] = $A[1];
$A[1] = $tmp; 
```

# c++ - 单元测试和模拟 C++ 中的小型类值类

> ID：715530
> 
> 赞同：0
> 
> 时间：2009-04-03T20:09:28.797
> 
> 标签：c++, visual-studio, unit-testing, mocking, googletest

我正在尝试为现有的 c++ 项目设置一些单元测试。

设置如下：我选择了 Google Mock，其中包括 Google Test。我在 Visual Studio 解决方案中添加了另一个项目（称为测试）。要测试的单元位于另一个名为 Main 的项目中。计划是将我要测试的每个 cpp 文件添加到 Tests 项目中。Tests 项目可以访问 Main 中的所有头文件。

我在 Tests 项目中添加了一个 cpp 文件，它可以编译，但出现链接器错误。大多数是因为从 COleDateTime 派生的一个类，称为 CTimeValue。被测单元具有按值传递 CTimeValue 参数的方法，并且还声明了一些 CTimeValue 属性。

我想单独测试 UUT，并对所有依赖项使用模拟和伪造。我不知道如何使用 CTimeValue 来做到这一点。它用作值，不包含虚拟方法，但仍然相当复杂，值得单独进行单元测试。

CTimeValue 只是项目中许多这样的类之一。如何隔离使用这些用户定义类型的类的测试？

干杯，菲利克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T20:13:14.527

有时不能简单地嘲笑事物。在这种情况下，您可以做的是对相关类 (CTimeValue) 进行全面测试，并确保将该类的测试作为其他测试中的子套件运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T17:27:19.193

使用模拟对象，您只需要添加您的 UUT 使用的方法签名，因此也许您可以使用 google mock 创建一个模拟。当然，您将需要一个单独的 CTimeValue 类测试套件，如果您有，那么最好链接到实际对象中。您需要决定是否值得努力创建一个接口类来创建模拟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-13T10:52:08.873

模拟最适合与为彼此提供服务的对象一起工作，模拟的期望描述了它们之间的关系。模拟值对象没有多大意义。

# python - 如何在 Python 中通过 HTTP 与 UniProt 对话？

> ID：715538
> 
> 赞同：5
> 
> 时间：2009-04-03T20:11:22.270
> 
> 标签：python, http, user-agent, bioinformatics

我试图从 UniProt 获得一些结果，这是一个蛋白质数据库（细节并不重要）。我正在尝试使用一些从一种 ID 转换为另一种 ID 的脚本。我可以在浏览器上手动执行此操作，但无法在 Python 中执行此操作。

在[http://www.uniprot.org/faq/28](http://www.uniprot.org/faq/28)中有一些示例脚本。我尝试了 Perl，它似乎可以工作，所以问题是我的 Python 尝试。（工作）脚本是：

```
## tool_example.pl ##
use strict;
use warnings;
use LWP::UserAgent;

my $base = 'http://www.uniprot.org';
my $tool = 'mapping';
my $params = {
  from => 'ACC', to => 'P_REFSEQ_AC', format => 'tab',
  query => 'P13368 P20806 Q9UM73 P97793 Q17192'
};

my $agent = LWP::UserAgent->new;
push @{$agent->requests_redirectable}, 'POST';
print STDERR "Submitting...\n";
my $response = $agent->post("$base/$tool/", $params);

while (my $wait = $response->header('Retry-After')) {
  print STDERR "Waiting ($wait)...\n";
  sleep $wait;
  print STDERR "Checking...\n";
  $response = $agent->get($response->base);
}

$response->is_success ?
  print $response->content :
  die 'Failed, got ' . $response->status_line . 
    ' for ' . $response->request->uri . "\n"; 
```

我的问题是：

1）你会如何在 Python 中做到这一点？

2) 我是否能够大规模“扩展”它（即，在查询字段中使用大量条目）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T20:28:44.210

**问题1：**

这可以使用 python 的 urllibs 来完成：

```
import urllib, urllib2
import time
import sys

query = ' '.join(sys.argv)   

# encode params as a list of 2-tuples
params = ( ('from','ACC'), ('to', 'P_REFSEQ_AC'), ('format','tab'), ('query', query))
# url encode them
data = urllib.urlencode(params)    
url = 'http://www.uniprot.org/mapping/'

# fetch the data
try:
    foo = urllib2.urlopen(url, data)
except urllib2.HttpError, e:
    if e.code == 503:
        # blah blah get the value of the header...
        wait_time = int(e.hdrs.get('Retry-after', 0))
        print 'Sleeping %i seconds...' % (wait_time,)
        time.sleep(wait_time)
        foo = urllib2.urlopen(url, data)

# foo is a file-like object, do with it what you will.
foo.read() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:49:38.700

假设您使用的是 Python 2.5。我们可以使用[httplib](http://docs.python.org/library/httplib.html?highlight=httplib#module-httplib)直接调用网站：

```
import httplib, urllib
querystring = {}
#Build the query string here from the following keys (query, format, columns, compress, limit, offset)
querystring["query"] = "" 
querystring["format"] = "" # one of html | tab | fasta | gff | txt | xml | rdf | rss | list
querystring["columns"] = "" # the columns you want comma seperated
querystring["compress"] = "" # yes or no
## These may be optional
querystring["limit"] = "" # I guess if you only want a few rows
querystring["offset"] = "" # bring on paging 

##From the examples - query=organism:9606+AND+antigen&format=xml&compress=no
##Delete the following and replace with your query
querystring = {}
querystring["query"] =  "organism:9606 AND antigen" 
querystring["format"] = "xml" #make it human readable
querystring["compress"] = "no" #I don't want to have to unzip

conn = httplib.HTTPConnection("www.uniprot.org")
conn.request("GET", "/uniprot/?"+ urllib.urlencode(querystring))
r1 = conn.getresponse()
if r1.status == 200:
   data1 = r1.read()
   print data1  #or do something with it 
```

然后，您可以围绕创建查询字符串创建一个函数，您应该离开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T11:00:26.410

您最好使用 EBI 的蛋白质标识符交叉引用服务将一组 ID 转换为另一组 ID。它有一个非常好的 REST 接口。

[http://www.ebi.ac.uk/Tools/picr/](http://www.ebi.ac.uk/Tools/picr/)

我还应该提到 UniProt 提供了非常好的网络服务。尽管如果您出于某种原因使用简单的 http 请求，那么它可能没有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-05T18:22:05.330

看看这个`bioservices`。他们通过 Python 连接了许多数据库。 [https://pythonhosted.org/bioservices/_modules/bioservices/uniprot.html](https://pythonhosted.org/bioservices/_modules/bioservices/uniprot.html)

```
conda install bioservices --yes 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-25T09:18:54.970

作为对 O.rka 答案的补充：

**问题一：**

```
from bioservices import UniProt
u = UniProt()
res = u.get_df("P13368 P20806 Q9UM73 P97793 Q17192".split()) 
```

这将返回一个数据框，其中包含有关每个条目的所有信息。

**问题2：**相同的答案。这应该扩大规模。

**免责声明**：我是生物服务的作者

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-10T09:04:08.540

pip 中有一个 python 包，它完全符合你的要求

```
pip install uniprot-mapper 
```

# iphone - 是否可以在 CAKeyFrameAnimation 中向后播放路径？

> ID：715546
> 
> 赞同：18
> 
> 时间：2009-04-03T20:13:29.927
> 
> 标签：iphone, objective-c, core-animation, cgpath

我想根据 CGPath 为 CALayer 的位置设置动画，但我想倒着播放。

有什么方法可以使路径向后动画，或反转 CGPath？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-01-15T18:54:48.923

```
animation.speed = -1; 
```

?

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-15T18:22:55.633

这可能不是最好的解决方案，但它对我有用。我告诉动画自动反转，然后在中途开始它。但为了防止它再次动画回来，我需要提前终止它。

```
- (void) animate {
    CAKeyframeAnimation * pathAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
    pathAnimation.path = path;
    pathAnimation.duration = 15.0;
    pathAnimation.calculationMode = kCAAnimationPaced;
    pathAnimation.timeOffset = pathAnimation.duration;
    pathAnimation.autoreverses = YES;

    NSString * key = @"pathAnimation";
    [animatedView.layer addAnimation:pathAnimation forKey:key];
    [NSTimer scheduledTimerWithTimeInterval:pathAnimation.duration target:self selector:@selector(endAnimation:) userInfo:key repeats:NO];
}

- (void) endAnimation:(NSTimer *)timer {
    [animatedView.layer removeAnimationForKey:timer.userInfo];
} 
```

如果存在更好的方法，我想知道。

# python - 用 json 编码元组的最佳方法

> ID：715550
> 
> 赞同：46
> 
> 时间：2009-04-03T20:14:25.057
> 
> 标签：python, json

在 python 中，我有一个将元组映射到元组列表的字典。例如

`{(1,2): [(2,3),(1,7)]}`

我希望能够使用 javascript 对这些数据进行编码，所以我查看了 json 但似乎键必须是字符串，所以我的元组不能用作键。

处理此问题的最佳方法是将其编码为“1,2”，然后将其解析为我想要在 javascript 上的内容吗？或者有没有更聪明的方法来处理这个问题。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-03T20:25:57.680

你可以考虑说

```
{"[1,2]": [(2,3),(1,7)]} 
```

然后当您需要获取值时，您可以将键本身解析为 JSON 对象，所有现代浏览器都可以使用内置`JSON.parse`方法执行此操作（我在`jQuery.each`这里迭代，但您可以使用任何东西）：

```
var myjson = JSON.parse('{"[1,2]": [[2,3],[1,7]]}');
$.each(myjson, function(keystr,val){
    var key = JSON.parse(keystr);
    // do something with key and val
}); 
```

另一方面，您可能只想以不同的方式构造对象，例如

```
{1: {2: [(2,3),(1,7)]}} 
```

所以而不是说

```
myjson[1,2] // doesn't work 
```

这是无效的 Javascript 语法，你可以说

```
myjson[1][2] // returns [[2,3],[1,7]] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T20:29:27.500

如果您的键元组是真正的整数对，那么最简单且可能最直接的方法就是按照您的建议......将它们编码为字符串。您可以在单行中执行此操作：

```
>>> simplejson.dumps(dict([("%d,%d" % k, v) for k, v in d.items()]))
'{"1,2": [[2, 3], [1, 7]]}' 
```

这将为您提供一个 javascript 数据结构，然后您可以拆分其键以再次获取积分：

```
'1,2'.split(',') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T20:20:06.633

我的建议是：

```
{ "1": [
        { "2": [[2,3],[1,7]] }
       ]
} 
```

它仍在解析，但取决于您如何使用它，这种形式可能更容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T20:20:25.837

您不能将数组用作 JSON 中的键。你能做的最好的就是对其进行编码。对不起，但真的没有其他理智的方法可以做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T20:17:25.377

它可能只是一个二维数组吗？然后你可以使用整数作为键

# ms-access - MS Access：如何自动将文本列减少到适合存储在其中的数据的大小？

> ID：715558
> 
> 赞同：0
> 
> 时间：2009-04-03T20:15:49.093
> 
> 标签：ms-access, import, column-width

MS Access 有一个合格的文本文件导入向导。（文件 -> 获取外部数据 -> 导入。）不幸的是，无论在输入文件中找到的实际数据如何，文本列（字段）总是以 255 个字符大小导入。

如何在不手动执行一堆“ `SELECT Max(Len(_column_)) FROM _data_`”查询的情况下将这些 255 个字符的文本列减小到合理的大小？

*我已经有了解决方案，我将在下面发布。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T21:05:53.153

有什么理由这样做吗？减小字段大小只会减少字段可以存储的文本量，而不是文件占用磁盘的空间量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:17:09.823

我创建了一个工具，它将*在事后*扫描导入的表，报告在 Text 列中找到的实际最小和最大大小，并允许您一次更改所有列大小：

[http://www.glump.net/software/microsoft_access_table_optimizer](http://www.glump.net/software/microsoft_access_table_optimizer)

此工具不会影响 MS Access 导入向导，也不会替换它。因此，如果您要导入大量带有 Text 值的记录或列，您可能会在运行我的工具之前遇到空间问题。YMMV。

该工具是一个 VBA 代码模块，它 1) 创建给定表中所有列以及值的最小和最大长度的报告，以及 2) 在编辑报告表后，使用指定的新大小调整列的大小。

# excel - 从 SQL 粘贴到 Excel...Excel 想为我考虑

> ID：715564
> 
> 赞同：2
> 
> 时间：2009-04-03T20:16:35.097
> 
> 标签：excel, paste

组我正在将数据从 SQL 粘贴到 Excel，看来 Excel 正试图通过将我的一些数字转换为日期来读懂我的想法。即一个数字是 2-2131，当我将它粘贴到 excel 时，它显示 Feb-31 甚至 2-3291 wnats 是 Feb-61

别再优秀了！

这让我发疯，我似乎找不到解决这个问题的简单方法。我尝试将“特殊粘贴”作为文本，它仍然是格式。如果我创建连接并使用查询，我可以让它工作，但我只想能够复制粘贴数据以进行测试。

谁有一个简单的方法来解决我的头痛？

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T20:20:55.990

在粘贴文本*之前*将列格式化为文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T20:21:55.397

提前选择单元格并将格式标记为文本。（格式->单元格，从类别中选择“文本”，然后单击确定）。然后粘贴您的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-19T17:40:01.160

在粘贴代码之前按 F-2，然后将其放入一个单元格中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:20:29.050

在粘贴数据之前突出显示受影响的行，右键单击，选择`Format Cells...`，选择。`Text`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T20:31:08.633

将sql数据粘贴到excel后，将excel的日期时间格式改为用破折号分隔的简单数字。这样即使excel假设它是日期，它也会按原样显示数字。

# delphi - 在 Delphi 中从其他单位定义类型

> ID：715572
> 
> 赞同：2
> 
> 时间：2009-04-03T20:17:57.513
> 
> 标签：delphi, types, parameters, definition, delphi-units

```
Var
     A : Array [1..4] of Integer;
     B : Array [1..4] of Integer;

Begin
    A := B; 
```

不会像 loren-pechtel 所说的那样工作，[问题](https://stackoverflow.com/questions/714456/how-do-you-pass-an-array-by-reference-in-delphi/715401#715401) 是我的 A 和 B 在不同的单位。那么，有没有办法从另一个类中的现有类型定义类型定义？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T20:20:20.937

在某个单元的接口块中定义类型，然后将该单元通过`uses`子句包含在您需要该类型的其他单元中。

```
unit A;
interface
type
  TMyArray = array [1..4] of Integer;

... 
```

当您需要`TMyArray`在另一个单元中使用时：

```
unit B;
interface
uses A;

...
var x : TMyArray; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T20:51:02.113

或者，在单元 C 的接口部分定义您的类型，并在 A 和 B 中使用该单元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:31:09.147

Delphi 中的数组类型有点奇怪。*看起来*A 和 B是完全相同的类型，但 Delphi 并不认为它们是相同的。“Array [1..4] of Integer”出现了两次，所以Delphi认为有两种不同的类型。这只是德尔福的一个奇怪之处。我认为大多数其他语言都不会在意。在实践中这不是问题；这有点奇怪。也许有一个很好的理由。谁知道。正如其他人所说，解决方案是定义自己的类型，您可以将其放入一个单元中，其他单元可以使用。我只是提到这个数组类型的问题，因为它可能会让你感到困惑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T23:51:30.027

另一种方法，有点老派但仍然有效，是使用 ABSOLUTE 关键字来强制一个内存覆盖另一个，并使另一个类型兼容。例如，在单元 a 中，假设您有以下内容：

```
TYPE
  TArrayA = Array[1..4] of integer; 
```

然后在单元 b 中，您有以下内容：

```
TYPE
  TArrayB = Array[1..4] of integer; 
```

为了兼容性，您可以执行以下操作：

```
VAR
  InstanceA : TArrayA;
  InstanceB : TArrayB;
  InstanceBasA : TArrayA ABSOLUTE InstanceB; 
```

这样做是创建一个 ArrayA 类型的变量“InstanceBasA”，它覆盖与变量“InstanceB”相同的内存空间。这允许您执行以下命令：

```
InstanceA := InstanceBasA; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T00:00:29.147

将数据从变量 a 移动到变量 b 的另一种方法是使用 MOVE 命令。例如，要从 ArrayA 移动到 ArrayB，您可以执行以下操作：

```
var
  ArrayA : array[1..4] of Integer;
  ArrayB : Array[1..4] of Integer;
begin
  FillChar(ArrayB[1],SizeOf(ArrayB),#0);
  ArrayA[1] := 1234;
  ArrayA[2] := 3456;
  ArrayA[3] := 7890;
  ArrayA[4] := 9876;

  // This is where the move from ArrayA to ArrayB happens.
  Move( ArrayA[1], ArrayB[1], SizeOf(ArrayA) );

  Assert( ArrayA[4] = ArrayB[4], 'ArrayA[4] <> ArrayB[4]');
end; 
```

这是因为数组以线性方式布局，因此您复制从第一个数组位置开始的字节，以获得数组的长度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T07:56:50.640

您可以强制编译器通过对它们进行类型转换来假设它们属于同一类型：

```
type
  TIntArray = array[1..4] of integer;

begin
  Assert(SizeOf(ArrayA) = SizeOf(TIntArray));
  Assert(SizeOf(ArrayB) = SizeOf(TIntArray));
  TIntArray(ArrayA) := TIntArray(ArrayB); 
```

但是您应该确保两者实际上都是 array[1..4] ，否则您将覆盖一些内存。这就是我添加两个断言的原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T10:47:42.657

**只需在接口之后和实现**之前在**UnitB**中使用 UnitA ...!!!!

 *** * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-21T10:25:02.963

永远，永远，永远不要使用这样的代码：

```
// This is where the move from ArrayA to ArrayB happens.
Move( ArrayA[1], ArrayB[1], SizeOf(ArrayA) ); 
```

缺陷在哪里？您正在使用 SOURCE 大小来获取要移动的字节数，而不是 DESTINATION 大小！！！如果 SizeOf(A) > SizeOf(B) 你有一个缓冲区溢出并且你正在覆盖内存。如果你很幸运，你会得到一个 AV，如果你不是，你就有一个可利用的漏洞。始终使用目标大小要好得多，尽管这样您最终可以读取如果 Size(B) > Size(A) 不应该读取的内存，可能会暴露不需要的数据。无论如何，在移动数据时始终检查结构边界——一些公司在他们的代码中禁止这样的操作（即 memcpy() ）。

# sql - Execute a Stored Procedure in a SELECT statement

> ID：715579
> 
> 赞同：4
> 
> 时间：2009-04-03T20:19:43.857
> 
> 标签：sql, sql-server-2005, stored-procedures, select

For an instance I a select statement and it is returning 1000 rows. I need to execute a particular stored procedure for every row the the select statement is returning.

你知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T20:20:44.620

在您的选择中构造 EXECUTE 语句，如下所示：

```
SELECT 'EXEC sp_whatever ' + parameter stuff
FROM   your_table 
```

然后运行结果！或者，将您的结果粘贴到电子表格包中，并使用字符串连接来构造 EXEC 语句 - 只需创建一个公式并将其粘贴到 1,000 行中。我个人更喜欢第一种方法。

为了阐明“参数内容”，以存储过程为例，该存储过程采用`int`您想从您的列中获取的两个参数`your_table`。然后你会有这样的东西：

```
SELECT 'EXEC sp_whatever ' + CAST(field1 AS varchar) + ', ' + CAST(field2 AS varchar)
FROM    your_table 
```

这里不需要小心字符串字段 - 您冒着无意中将自己暴露于自己的 SQL 注入攻击的风险，就像任何 SQL 字符串连接一样。

*我正在阅读您的“例如”作为“这是一次性任务”。如果这是一项需要自动化的任务，那么其他答案之一可能是正确的方法。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-02T09:08:21.740

你可以这样做：

```
declare @execstatementsbatch nvarchar(max)

select @execstatementsbatch = ''

SELECT @execstatementsbatch = @execstatementsbatch   + 'EXEC UpdateQty ' + ItemCode +  ', '  + QtyBO +  '; ' 
FROM ITEMSPO 
INNER JOIN ..... 
<some conditions>

exec(@execstatementsbatch) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T20:23:55.487

*免责声明：我不确定我是否正确理解了您的问题。*

假设您使用的是 SQL Server 2005 及更高版本，您可以创建一个表值用户定义函数并在查询中使用该[`OUTER APPLY`运算符。](http://msdn.microsoft.com/en-us/library/ms175156.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T20:31:03.283

大多数 RDBMS 将允许您从存储过程结果集中选择行。只需将存储过程放在 FROM 子句中，就像对公用表表达式一样。例如：

```
SELECT sp.ColumnInResultSet, t.BaseTableColumnName
FROM sp_whatever ( Args) sp INNER JOIN BaseTable t ON t.ID = sp.ID; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-18T12:29:58.280

```
CREATE PROCEDURE dbo.usp_userwise_columns_value
(
    @userid BIGINT
)
AS 
BEGIN
        DECLARE @maincmd NVARCHAR(max);
        DECLARE @columnlist NVARCHAR(max);
        DECLARE @columnname VARCHAR(150);
        DECLARE @nickname VARCHAR(50);

        SET @maincmd = '';
        SET @columnname = '';
        SET @columnlist = '';
        SET @nickname = '';

        DECLARE CUR_COLUMNLIST CURSOR FAST_FORWARD
        FOR
            SELECT columnname , nickname
            FROM dbo.v_userwise_columns 
            WHERE userid = @userid

        OPEN CUR_COLUMNLIST
        IF @@ERROR <> 0
            BEGIN
                ROLLBACK
                RETURN
            END   

        FETCH NEXT FROM CUR_COLUMNLIST
        INTO @columnname, @nickname

        WHILE @@FETCH_STATUS = 0
            BEGIN
                SET @columnlist = @columnlist + @columnname + ','

                FETCH NEXT FROM CUR_COLUMNLIST
                INTO @columnname, @nickname
            END
        CLOSE CUR_COLUMNLIST
        DEALLOCATE CUR_COLUMNLIST  

        IF NOT EXISTS (SELECT * FROM sys.views WHERE name = 'v_userwise_columns_value')
            BEGIN
                SET @maincmd = 'CREATE VIEW dbo.v_userwise_columns_value AS SELECT sjoid, CONVERT(BIGINT, ' + CONVERT(VARCHAR(10), @userid) + ') as userid , ' 
                            + CHAR(39) + @nickname + CHAR(39) + ' as nickname, ' 
                            + @columnlist + ' compcode FROM dbo.SJOTran '
            END
        ELSE
            BEGIN
                SET @maincmd = 'ALTER VIEW dbo.v_userwise_columns_value AS SELECT sjoid, CONVERT(BIGINT, ' + CONVERT(VARCHAR(10), @userid) + ') as userid , ' 
                            + CHAR(39) + @nickname + CHAR(39) + ' as nickname, ' 
                            + @columnlist + ' compcode FROM dbo.SJOTran '
            END

        --PRINT @maincmd
        EXECUTE sp_executesql @maincmd
END

-----------------------------------------------
SELECT * FROM dbo.v_userwise_columns_value 
```

# interface - 为什么像 Ruby 和 Python 这样的动态语言没有像 Java 或 C# 那样的接口概念？

> ID：715604
> 
> 赞同：16
> 
> 时间：2009-04-03T20:26:58.893
> 
> 标签：interface, oop, dynamic-languages

令我惊讶的是，我对 Ruby 和 Python 等动态语言越来越感兴趣。声称它们是 100% 面向对象的，但是当我读到接口、方法重载、运算符重载等几个基本概念时，它们都缺失了。它是以某种方式内置在封面下，还是这些语言不需要它？如果后者是真的，他们是 100% 面向对象的吗？

编辑：根据一些答案，我看到重载在 Python 和 Ruby 中都可用，在 Ruby 1.8.6 和 Python 2.5.2 中是这种情况吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T20:29:11.870

由于后期绑定，他们不需要它。在 Java/C# 中，接口用于声明某个类具有某些方法，并在编译时进行检查；在 Python 中，在运行时检查方法是否存在。

Python 中的方法重载确实有效：

```
>>> class A:
...  def foo(self):
...    return "A"
...
>>> class B(A):
...  def foo(self):
...    return "B"
...
>>> B().foo()
'B' 
```

它们是面向对象的吗？我会说是的。这更像是一种方法，而不是任何具体语言是否具有特性*X*或特性*Y*。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-03T20:30:36.500

动态语言使用[鸭子类型](http://en.wikipedia.org/wiki/Duck_typing)。任何代码都可以在支持这些方法的任何对象上调用方法，因此接口的概念是无关紧要的。Python 确实支持[运算符重载](http://docs.python.org/reference/datamodel.html)（检查 - 3.3\. 特殊方法名称），[Ruby](http://kartik-log.blogspot.com/2006/01/operator-overloading-in-ruby.html)也是如此。

无论如何，您似乎专注于对[面向对象编程不重要](http://en.wikipedia.org/wiki/Object_oriented)的方面。主要关注的是封装、继承和多态等概念，Python 和 Ruby 100% 支持这些概念。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T20:31:48.430

我只能说python，但是过去[已经有关于接口](http://www.python.org/dev/peps/pep-0245/)的建议以及家庭编写的接口示例。

然而，python 动态处理对象的方式往往会在一定程度上减少对接口的需求（以及接口的好处）。

使用动态语言，您的类型绑定发生在运行时 - 接口主要用于对象的编译时间约束 - 如果这发生在运行时，它消除了对接口的一些需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T20:34:00.920

[基于名称的多态性](http://www.artima.com/weblogs/viewpost.jsp?thread=7590#poly)

“对于那些不熟悉 Python 的人，这里是基于名称的多态性的快速介绍。Python 对象有一个内部字典，其中包含每个属性和方法的字符串。当您在 Python 代码中访问属性或方法时，Python 只需查找字典中的字符串。因此，如果你想要的是一个像文件一样工作的类，你不需要从文件继承，你只需创建一个具有所需文件方法的类。

Python 还定义了一堆特殊的方法，它们被适当的语法调用。例如，a+b 等价于 a。**添加**(b)。Python 内部有几个地方直接操作内置对象，但基于名称的多态性在大约 98% 的情况下按预期工作。"

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T20:34:42.090

Python确实提供了运算符重载，例如，`__add__`如果你想重载+，你可以定义一个方法。

您通常不需要提供方法重载，因为您可以将任意参数传递给单个方法。在许多情况下，该单一方法可以有一个单一的主体，以相同的方式适用于所有类型的对象。如果您想为不同的参数类型使用不同的代码，您可以检查类型或双重调度。

正如 rossfabricant 指出的那样，由于鸭子类型，接口大多是不必要的。ABCs（抽象基类）或 Zope 接口在 Python 中涵盖了一些剩余的情况。

# function - 为什么在不传递任何参数时会出现“输入参数过多”错误？

> ID：715624
> 
> 赞同：7
> 
> 时间：2009-04-03T20:32:01.393
> 
> 标签：function, matlab, parameters, arguments

我正在 MATLAB 中编写一些简单的面向对象的代码。我正在尝试调用我的一个类方法，但其定义中没有输入或输出参数。

函数定义：

`function roll_dice`

函数调用：

`obj.roll_dice;`

执行此操作时，MATLAB 会说：

```
??? Error using ==> roll_dice
Too many input arguments.

Error in ==> DiceSet>Diceset.Diceset at 11
obj.roll_dice;
(etc...) 
```

任何人有任何想法可能导致它？是否有我不知道我正在传递的秘密自动参数？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T20:34:03.743

当您拨打电话时：

```
obj.roll_dice; 
```

它实际上相当于：

```
roll_dice(obj); 
```

`obj`传递给的“秘密”自动参数也是如此`roll_dice`。如果您重写该方法`roll_dice`以接受单个输入参数（即使您不使用它），事情应该可以正常工作。

或者，如果您确定您的方法`roll_dice`不会对类对象执行任何操作，则可以按照[Dan 的建议将其声明为](https://stackoverflow.com/questions/715624/matlab-too-many-input-arguments-when-not-passing-any/735905#735905)[静态方法](http://www.mathworks.com/help/techdoc/matlab_oop/brdqiu3.html)。

有关 MATLAB 中面向对象编程的更多信息，[请访问在线文档链接](http://www.mathworks.com/help/techdoc/matlab_oop/ug_intropage.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T20:59:28.507

我相信您也可以通过将 roll_dice 声明为静态方法来解决此问题。

# c# - 验证 xml 节点，而不是整个文档

> ID：715626
> 
> 赞同：4
> 
> 时间：2009-04-03T20:32:31.300
> 
> 标签：c#, xml, .net-2.0, xsd, xml-validation

我正在使用一些在 xml 中形成元素的 xml 'snippets'。我有架构，但我无法验证这些文件，因为它们不是完整的 xml 文档。这些片段包含必要的父元素以在其他工具中使用它们时形成有效的 xml，因此我没有太多选择将它们变成有效的 xml 或更改架构。

是否可以验证一个元素，而不是整个文档？如果没有，可以建议哪些解决方法？

我正在使用 .NET 2.0 框架使用 C#。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T20:36:05.767

我有一个类似的问题，我只能验证我的 XML 文档的一部分。我在这里想出了这个方法：

```
private void ValidateSubnode(XmlNode node, XmlSchema schema)
{
    XmlTextReader reader = new XmlTextReader(node.OuterXml, XmlNodeType.Element, null);

    XmlReaderSettings settings = new XmlReaderSettings();
    settings.ConformanceLevel = ConformanceLevel.Fragment;
    settings.Schemas.Add(schema);
    settings.ValidationType = ValidationType.Schema;
    settings.ValidationEventHandler += new ValidationEventHandler(XSDValidationEventHandler);

    using (XmlReader validationReader = XmlReader.Create(reader, settings))
    {     
        while (validationReader.Read())
        {
        }
    }
}

private void XSDValidationEventHandler(object sender, ValidationEventArgs args)
{
    errors.AppendFormat("XSD - Severity {0} - {1}", 
                        args.Severity.ToString(), args.Message);
} 
```

基本上，我将一个 XmlNode（我通过 .SelectSingleNode 从整个 XmlDocument 中选择）和一个​​ XML 模式传递给它，我从我的应用程序内的嵌入式资源 XSD 加载它。任何可能发生的验证错误都被填充到“错误”字符串构建器中，然后我在最后读出它，以查看是否记录了任何错误。

对我有用-您的里程可能会有所不同:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T20:45:56.853

有一种`XmlDocument.Validate`方法接受一个`XmlNode`作为参数，并且只验证这个节点。这可能是你正在寻找的...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T07:55:32.067

好的，这是另一种方法：

您可以使用 XSLT 转换将您的模式文件转换为以您的片段元素为根的新模式。假设您的原始架构是

```
<xs:schema id="MySchema" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="RootElement">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="NestedElement">
          <xs:complexType>
            <xs:attribute name="Name" type="xs:string" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

`NestedElement`您有要验证的类型片段：

```
<NestedElement Name1="Name1" /> 
```

然后您可以使用 XSLT 模板，例如

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="xs:element[@name='NestedElement']"
                xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:schema id="MySchema">
      <xsl:copy-of select="."/>
    </xs:schema>
  </xsl:template>
</xsl:stylesheet> 
```

创建一个具有`NestedElement`root 权限的新模式。生成的架构看起来像

```
<xs:schema id="MySchema" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="NestedElement">
    <xs:complexType>
      <xs:attribute name="Name" type="xs:string" use="required" />
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

然后，您可以使用类似的代码针对这个新模式验证片段文档

```
XmlSchema schema;
using (MemoryStream stream =    new MemoryStream())
using (FileStream fs = new FileStream("MySchema.xsd", FileMode.Open))
using(XmlReader reader = XmlReader.Create(fs)) {
  XslCompiledTransform transform = new XslCompiledTransform();
  transform.Load("SchemaTransform.xslt");
  transform.Transform(reader, null, stream);
  stream.Seek(0, SeekOrigin.Begin);
  schema = XmlSchema.Read(stream, null);
}
XmlDocument doc = new XmlDocument();
doc.Schemas.Add(schema);
doc.Load("rootelement.xml");
doc.Validate(ValidationHandler); 
```

`MySchema.xsd`是原始模式，`SchemaTransform.xslt`是转换（如上所示），`rootelement.xml`是包含单个片段节点的 XML 文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:36:49.777

您可以使用特殊的命名空间别名来指定要验证的元素，然后仅为该命名空间别名添加架构，而不为其他命名空间别名添加架构。这样，只有那些带有特殊命名空间前缀的元素才会被验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T22:37:45.903

似乎不可能做我渴望做的事。我目前的工作是创建一个空白模板 xml 文档。然后用我的代码段替换所需的元素。从那里开始，我相信 Validate 方法将是可行的。但是动态创建这个模板本身似乎是另一项艰巨的任务。似乎没有任何简单的方法可以创建“骨架”文档。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-10T18:33:13.747

我有同样的问题。甚至在这里寻求解决方案。我找到了一种解决方法。

问题是只能验证根元素。所以...我在内存中编辑方案并将要验证的元素/类型添加到根

```
public static void AddElementToSchema(XmlSchema xmlSchema, string elementName, string elementType, string xmlNamespace)
{
    XmlSchemaElement testNode = new XmlSchemaElement();
    testNode.Name = elementName;
    testNode.Namespaces.Add("", xmlNamespace);
    testNode.SchemaTypeName = new XmlQualifiedName(elementType, xmlNamespace);
    xmlSchema.Items.Add(testNode);
    xmlSchema.Compile(XMLValidationEventHandler);
} 
```

只需几行，您就不能修改或添加任何 XSD 文件 :) 通过对内存模式的这种简单更改，您可以使用用于验证完整文档的相同代码来验证片段。只需确保要验证的片段的根元素包含命名空间即可。:)

# visual-studio-2008 - XML 反序列化权限错误

> ID：715630
> 
> 赞同：0
> 
> 时间：2009-04-03T20:33:14.543
> 
> 标签：visual-studio-2008, iis-6, xml-serialization, windows-server-2003

我正在尝试使用 VS 2008 将网站发布到我计算机上的虚拟机上。该网站在调试时在 VS2008 中运行良好，但是当我发布它时，出现以下错误。

> 拒绝访问路径“C:\dummy.xml”。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.UnauthorizedAccessException：对路径“C:\dummy.xml”的访问被拒绝。
> 
> ASP.NET 无权访问请求的资源。考虑向 ASP.NET 请求标识授予对资源的访问权限。ASP.NET 有一个基本进程标识（通常是 IIS 5 上的 {MACHINE}\ASPNET 或 IIS 6 上的网络服务），如果应用程序不模拟，则使用该标识。如果应用程序通过 模拟，则身份将是匿名用户（通常是 IUSR_MACHINENAME）或经过身份验证的请求用户。
> 
> 要授予 ASP.NET 对文件的访问权限，请在资源管理器中右键单击该文件，选择“属性”并选择“安全”选项卡。单击“添加”以添加相应的用户或组。突出显示 ASP.NET 帐户，然后选中所需访问权限的复选框。

我将一个 XML 文件反序列化为一个由 xsd.exe 构建的类。文件和目录具有相同的权限，我可以从 Web 浏览器访问 xml 文件。用于运行/访问网站的服务帐户（IIS 中的目录安全设置）对文件夹和 xml 文件具有完全控制权限。

我正在使用 IIS 6 运行 Server 2003 R2。

关于如何纠正这个错误的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T21:23:41.630

设置一个 filemon ( [http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx) ) 来监控 'C:\dummy.xml'。当您收到错误检查时，请检查哪个 Windows 用户正在尝试访问该文件。

# ajax - Javascript：实现 Google Ad AJAX 效果

> ID：715634
> 
> 赞同：1
> 
> 时间：2009-04-03T20:34:03.620
> 
> 标签：ajax, xss

我需要创建一个可移植的脚本，以提供给其他人在他们的网站上实现，该脚本将动态显示我的数据库（MySQL）中的内容。

我知道 AJAX 存在跨站点问题，但似乎 Google 的广告以某种方式以跨浏览器/跨站点方式管理效果。

知道我必须给人们一个简单的剪切/粘贴片段以放入他们的网站......我怎样才能做到这一点？谷歌是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T20:43:29.963

他们使用[`<iframe>`](http://www.w3.org/TR/html401/present/frames.html#h-16.5)，因此广告是从他们的服务器提供的，并且可以与他们的数据库对话。不过，我实际上并不确定他们是否使用了广告中的任何类型的 AJAX；它们似乎主要是静态内容，带有一些用于调整格式的脚本（这是可选的，因为即使用户关闭了 JS，他们也希望他们的广告可见）。

请记住，您可以随时自行调查，看看他们做了什么。在 Firefox 上，使用[Firebug](http://getfirebug.com/)浏览网站上的 html、css 和脚本。在基于 WebKit 的浏览器（Safari、Chrome 等）上，您可以使用[Web Inspector](http://webkit.org/blog/197/web-inspector-redesign/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:41:02.450

Google 的广告代码是通过调用远程 JavaScript 文件的脚本标记加载的。在加载远程 javascript 文件时，通常使用 xmlhttp、iframe 和类似的 AJAX 请求实施的 AJAX 限制不适用。

加载 javascript 文件后，您可以在页面中创建链接回服务器上实际托管内容的 iframe（并向它们提供您希望的有关当前页面的任何数据）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T20:44:14.860

jQuery 在其 ajax 调用中内置了对 jsonp 的支持。如果你真的需要使用 ajax，你可能想考虑使用它。

[http://api.jquery.com/](http://api.jquery.com/)

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T21:01:24.210

您不需要 iFrame，也不需要 AJAX。真的，真的很简单！

您从 php/asp/whatever 中拉入一个实际上是构造文件的远程 JS 文件。在您的 JS 文件中，您有一个用于写入内容的 document.write 脚本。就是这么简单。

我们一直使用存储在不同站点上的媒体来执行此操作。这是一个例子。

您的服务器：file.php（输出 js）

```
<script>
document.write("I'm on a remote server");
</script> 
```

其他网站：

```
<script src='http://www.yourserver.com/file.php'></script> 
```

并且会输出脚本生成的内容。要定制内容，您可以在脚本调用上方放置脚本变量，以调整文件提取的内容。从那里开始很简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-07T02:01:39.810

我意识到这个问题已经存在一年了，但是我已经编写了一个库来帮助解决`document.write`部分问题（我不知道这是否违反了 TOS）[writeCapture.js](http://github.com/iamnoah/writeCapture)。这很简单：

```
$('#ads').writeCapture().html('<script src="whatever-your-adsense-code-is"> </script>'); 
```

该示例使用 jQuery，但您也可以单独使用它。

# search - 在 vi 编辑器中搜索字符串并获取计数

> ID：715643
> 
> 赞同：112
> 
> 时间：2009-04-03T20:37:49.460
> 
> 标签：search, count, vi

我想搜索一个字符串并使用 vi 编辑器查找文件中出现的次数。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2010-10-13T18:20:26.157

方法是

:%s/模式//gn

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-04-03T20:42:07.330

你需要`n`国旗。要计算单词，请使用：

```
:%s/\i\+/&/gn 
```

和一个特定的词：

```
:%s/the/&/gn 
```

请参阅[`count-items`](http://vimdoc.sourceforge.net/htmldoc/tips.html#count-items)文档部分。

如果您只是输入：

```
%s/pattern/pattern/g 
```

那么状态行也会为您提供 vi 中的匹配数。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-04-03T20:41:55.987

:%s/string/string/g 会给出答案。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-08-28T12:02:53.197

（类似于古斯塔沃所说，但另外：）

对于任何*以前的*搜索，您可以简单地执行以下操作：

```
:%s///gn 
```

不需要模式，因为它已经在搜索寄存器 ( `@/`) 中。

"%" -`s/`在整个文件中执行
"g" - 全局搜索（一行中有多个命中）
"n" - 防止任何替换`s/`--**没有任何内容被删除！**什么都不能撤消！
（请参阅：`:help s_flag`了解更多信息）

（这样，它与“*搜索视觉选择的文本*”完美配合，如[vim-wikia tip171](http://vim.wikia.com/wiki/Search_for_visually_selected_text)中所述）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-03T20:43:11.337

```
:g/xxxx/d 
```

这将删除所有带有模式的行，并报告删除了多少。撤消后将它们取回。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-18T02:27:05.660

采用

> :%s/模式/\0/g

当模式字符串太长并且您不想再次输入时。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-04-22T06:53:39.490

**简短的回答**：

> **:%s/待搜索字符串//gn**

**学习**：

VI编辑器有3种模式如下 [![在此处输入图像描述](https://i.stack.imgur.com/aNXlz.jpg)](https://i.stack.imgur.com/aNXlz.jpg)

*   `:`您正在进入 from `Command`to`Command-line`模式。现在，无论你写什么`:`都在 CLI（命令行界面）上
*   `%s`指定所有行。将范围指定为`%`意味着在整个文件中进行替换。所有出现替换的语法是`:%s/old-text/new-text/g`
*   `g`指定行中的所有匹配项。使用`g`flag ，您可以替换整行。如果`g`未使用此标志，则仅替换该行中的第一次出现。
*   `n`指定输出出现次数
*   `//`双斜线代表省略`replacement text`。因为我们只想找到。

获得出现次数后，您可以按`N`键逐个查看出现次数。

在行号 1 到 10 的特定范围内查找和计数：

> **:1,10s/你好//gn**

*   请注意，`%`整个文件由`,`单独的行号代替。

查找和替换行号 1 到 10 的特定范围：

> **:1,10s/helo/hello/gn**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-11T17:12:06.267

我建议这样做：

1.  搜索要么`*`对光标下的内容进行“有界搜索”，要么进行标准`/pattern`搜索。
2.  用于`:%s///gn`获取出现次数。或者您可以使用`:%s///n`来获取出现的行数。

******我真的可以找到一个插件，每次搜索都会给出“ N [2行上的 N] [1匹配 N”消息，但是唉。]

注意：不要被输出的棘手措辞所迷惑。前一个命令可能会给你一些类似于`4 matches on 3 lines`后者可能给你的东西`3 matches on 3 lines`。虽然在*技术上*是准确的，但后者具有误导性，应该说“3 行匹配”。因此，正如您所看到的，实际上永远不需要使用后者（仅“n”）形式。通过使用“gn”表格，您可以获得相同的信息、更清晰、更多。

# java - 在上传之前处理文件

> ID：715646
> 
> 赞同：1
> 
> 时间：2009-04-03T20:39:22.547
> 
> 标签：java, javascript, upload, client-server, swfupload

我得到了一张带有 SWFUpload 的表格。上传到服务器的文件在服务器端进行转换（视频被压缩，图像被调整大小等）

问题是 - 我可以将一些功能委托给客户端（如调整图像大小），为用户节省一些带宽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T20:42:25.177

通过 Javascript 进行视频压缩可能会使浏览器变慢，以至于不会节省带宽，而且如果有任何事情可能会惹恼最终用户。

# c# - 在 C# 中使用超时的通用尝试和重试？

> ID：715647
> 
> 赞同：6
> 
> 时间：2009-04-03T20:39:23.687
> 
> 标签：c#, .net

我正在寻找一种通用的尝试并在 C# 中使用超时重试。基本上，我想要以下内容：

```
bool stopTrying = false;
DateTime time = DateTime.Now;
while (!stopTrying)
{
    try
    {
        //[Statement to Execute]
    }
    catch (Exception ex)
    {
        if (DateTime.Now.Subtract(time).Milliseconds > 10000)
        {
            stopTrying = true;
            throw ex;
        }
    }
} 
```

在上述情况下，我等待 10 秒，但它应该是基于参数的可变超时。我不想在需要使用它的地方重复这个完整的代码。我的代码中有多个地方不是 API 内置的超时，如果应用程序还没有准备好执行语句，我会遇到异常。这也将避免在这些声明之前对我的应用程序中的延迟进行硬编码。

**澄清：**有问题的陈述可能类似于作业。如果我使用委托和method.Invoke，调用范围不是在委托内而不是原始方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T20:43:09.790

使用您的示例，解决方案很简单：

```
bool DoOrTimeout<T>(T method, TimeSpan timeout) where T : delegate // FIXME
{
    bool stopTrying = false;
    DateTime time = DateTime.Now;
    while (!stopTrying)
    {
        try
        {
            method.Invoke();
            stopTrying = true;
        }
        catch (Exception ex)
        {
            if (DateTime.Now.Subtract(time).Milliseconds > timeout.TotalMilliseconds)
            {
                stopTrying = true;
                throw;
            }
        }
    }
} 
```

只需`DoOrTimeout`使用委托作为第一个参数进行调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T21:24:34.793

这不是最漂亮的事情，但到目前为止我似乎工作得很好。并且它不使用异常来指示超时。

```
public static class TimeoutOperation
{
  private static readonly TimeSpan DefaultTimeout = new TimeSpan(0, 0, 10);
  private static readonly TimeSpan DefaultGranularity = new TimeSpan(0, 0, 0, 0, 100);

  public static ThreadResult<TResult> DoWithTimeout<TResult>(Func<TResult> action)
  {
    return DoWithTimeout<TResult>(action, DefaultTimeout);
  }

  public static ThreadResult<TResult> DoWithTimeout<TResult>(Func<TResult> action, TimeSpan timeout)
  {
    return DoWithTimeout<TResult>(action, timeout, DefaultGranularity);
  }

  public static ThreadResult<TResult> DoWithTimeout<TResult>(Func<TResult> action, TimeSpan timeout, TimeSpan granularity)
  {
    Thread thread = BuildThread<TResult>(action);
    Stopwatch stopwatch = Stopwatch.StartNew();
    ThreadResult<TResult> result = new ThreadResult<TResult>();

    thread.Start(result);
    do
    {
      if (thread.Join(granularity) && !result.WasSuccessful)
      {
        thread = BuildThread<TResult>(action);
        thread.Start(result);
      }

    } while (stopwatch.Elapsed < timeout && !result.WasSuccessful);
    stopwatch.Stop();

    if (thread.ThreadState == System.Threading.ThreadState.Running)
      thread.Abort();

    return result;
  }

  private static Thread BuildThread<TResult>(Func<TResult> action)
  {
    return new Thread(p =>
    {
      ThreadResult<TResult> r = p as ThreadResult<TResult>;
      try { r.Result = action(); r.WasSuccessful = true; }
      catch (Exception) { r.WasSuccessful = false; }
    });
  }

  public class ThreadResult<TResult>
  {
    public TResult Result { get; set; }
    public bool WasSuccessful { get; set; }
  }
} 
```

用法

```
var result = TimeoutOperation.DoWithTimeout<int>(() =>
  {
    Thread.Sleep(100);
    throw new Exception();
  });
result.WasSuccessful // = false
result.Value // = 0

var result = TimeoutOperation.DoWithTimeout<int>(() =>
  {
    Thread.Sleep(2000);
    return 5;
  });
result.WasSuccessful // = true
result.Value // = 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:30:58.897

看看这个问题。你所要求的正是我想要的用途之一。
[实现 C# 通用超时](https://stackoverflow.com/questions/299198/implement-c-generic-timeout)

警告：此示例使用 Thread.Abort。按照我原来的问题的链接阅读评论中的一些警告。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace Something
{
  public static class TimeoutWrapper
  {
    public static void Invoke(TimeSpan timeout, Action action)
    {
      Invoke(timeout, action, null);
    }
    public static void Invoke(TimeSpan timeout, Action action, Action abort)
    {
      Thread threadToKill = null;
      Action wrappedAction = () =>
      {
        threadToKill = Thread.CurrentThread;
        action();
      };

      IAsyncResult result = wrappedAction.BeginInvoke(null, null);
      if (result.AsyncWaitHandle.WaitOne(timeout, true))
      {
        wrappedAction.EndInvoke(result);
      }
      else
      {
        if (threadToKill != null)
        {
          try { threadToKill.Abort(); }
          catch { /* Ignore */ }
        }

        if (abort != null)
          abort();

        throw new TimeoutException();
      }
    }
  }
} 
```

只需使用适当的超时控制在循环中运行它即可。

```
DateTime endAt = DateTime.Now.AddMinutes(1);
Timespan timeout = new Timespan( 0, 0, 0, 5);
while( DateTime.Now < endAt )
{
    try
    {
        TimeoutWrapper.Invoke( timeout, () => DoSomething());
        break;
    } 
    catch( TimeoutException ex ) 
    { /* Do something */ }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:44:26.903

创建一个方法，该方法接受一个用于执行语句的 lambda 表达式和一个用于超时的参数。在该方法中，执行 try / catch 块中的 lambda 表达式并使用超时参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-29T14:02:15.973

此代码错误（无限循环）：

```
if (DateTime.Now.Subtract(time).Milliseconds > 10000) 
```

正确的是：

```
if (DateTime.Now.Subtract(time).TotalMilliseconds > 10000) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-10T18:09:50.010

这是一个简单的解决方案：

```
long TIMEOUT = 60000; // 1 minute
long INTERVAL = 1000; // 1 second

System.DateTime startTime = System.DateTime.Now;    

while (check_condition())
{
    System.Threading.Thread.Sleep(INTERVAL);
    long elapsedTime = System.DateTime.Now.Millisecond - startTime.Millisecond;

    if (elapsedTime > TIMEOUT)
    {
        throw new Exception("Timeout exceeded");
    }
} 
```

# java - 如何克隆 ArrayList 并克隆其内容？

> ID：715650
> 
> 赞同：299
> 
> 时间：2009-04-03T20:40:28.050
> 
> 标签：java, collections, clone, deep-copy

如何`ArrayList`在 Java 中克隆并克隆其项目？

例如我有：

```
ArrayList<Dog> dogs = getDogs();
ArrayList<Dog> clonedList = ....something to do with dogs.... 
```

而且我希望其中的对象`clonedList`与狗列表中的对象不同。

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-04-03T20:43:23.003

您将需要迭代这些项目，并一个一个地克隆它们，然后将克隆物放入您的结果数组中。

```
public static List<Dog> cloneList(List<Dog> list) {
    List<Dog> clone = new ArrayList<Dog>(list.size());
    for (Dog item : list) clone.add(item.clone());
    return clone;
} 
```

为此，显然，您必须让您的`Dog`类实现`Cloneable`接口并覆盖该`clone()`方法。

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2009-04-03T22:02:18.277

我个人会为 Dog 添加一个构造函数：

```
class Dog
{
    public Dog()
    { ... } // Regular constructor

    public Dog(Dog dog) {
        // Copy all the fields of Dog.
    }
} 
```

然后只需迭代（如 Varkhan 的回答所示）：

```
public static List<Dog> cloneList(List<Dog> dogList) {
    List<Dog> clonedList = new ArrayList<Dog>(dogList.size());
    for (Dog dog : dogList) {
        clonedList.add(new Dog(dog));
    }
    return clonedList;
} 
```

我发现这样做的好处是你不需要在 Java 中搞砸 Cloneable 的东西。它还与您复制 Java 集合的方式相匹配。

另一种选择可能是编写自己的 ICloneable 接口并使用它。这样你就可以编写一个通用的克隆方法。

* * *

## 回答 #3

> 赞同：148
> 
> 时间：2012-04-10T04:30:40.290

所有标准集合都有复制构造函数。使用它们。

```
List<Double> original = // some list
List<Double> copy = new ArrayList<Double>(original); //This does a shallow copy 
```

`clone()`设计有几个错误（见[这个问题](https://stackoverflow.com/questions/5092540/accessing-clone-from-java-lang-object)），所以最好避免它。

来自[Effective Java 2nd Edition](https://rads.stackoverflow.com/amzn/click/com/0321356683)，第 11 条：*明智地覆盖克隆*

> 鉴于与 Cloneable 相关的所有问题，可以肯定地说其他接口不应该扩展它，并且为继承而设计的类（第 17 条）不​​应该实现它。由于它的许多缺点，一些专业程序员干脆选择从不覆盖 clone 方法并且从不调用它，除非可能是复制数组。如果您为继承设计一个类，请注意，如果您选择不提供行为良好的受保护克隆方法，子类将无法实现 Cloneable。

本书还描述了复制构造函数相对于 Cloneable/clone 的许多优点。

*   他们不依赖于容易冒险的语言外对象创建机制
*   他们不要求强制遵守记录薄弱的约定
*   它们与正确使用 final 字段不冲突
*   他们不会抛出不必要的检查异常
*   他们不需要演员表。

考虑使用复制构造函数的另一个好处：假设您有一个`HashSet s`，并且您想将它复制为一个`TreeSet`. clone 方法无法提供此功能，但使用转换构造函数很容易：`new TreeSet(s)`.

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2015-11-03T19:36:05.030

Java 8 提供了一种新方法来优雅而紧凑地调用元素狗上的复制构造函数或克隆方法：[**Streams**、**lambdas**和**collectors**](https://docs.oracle.com/javase/tutorial/collections/streams/)。

**复制构造函数：**

```
List<Dog> clonedDogs = dogs.stream().map(Dog::new).collect(toList()); 
```

该表达式`Dog::new`称为[*方法引用*](https://docs.oracle.com/javase/tutorial/java/javaOO/methodreferences.html)。它创建一个函数对象，该对象调用一个构造函数，该构造函数`Dog`将另一只狗作为参数。

**克隆方法[1]：**

```
List<Dog> clonedDogs = dogs.stream().map(Dog::clone).collect(toList()); 
```

* * *

### `ArrayList`结果得到一个

或者，如果您必须`ArrayList`返回（以防您以后想修改它）：

```
ArrayList<Dog> clonedDogs = dogs.stream().map(Dog::new).collect(toCollection(ArrayList::new)); 
```

* * *

### 更新列表

如果您不需要保留`dogs`列表的原始内容，则可以改用该`replaceAll`方法并更新列表：

```
dogs.replaceAll(Dog::new); 
```

* * *

所有示例均假设`import static java.util.stream.Collectors.*;`.

* * *

### 收集`ArrayList`器

上一个示例中的收集器可以制成 util 方法。由于这是一件很常见的事情，我个人喜欢它简短而漂亮。像这样：

```
ArrayList<Dog> clonedDogs = dogs.stream().map(d -> d.clone()).collect(toArrayList());

public static <T> Collector<T, ?, ArrayList<T>> toArrayList() {
    return Collectors.toCollection(ArrayList::new);
} 
```

* * *

### [1] 注意事项`CloneNotSupportedException`：

要使此解决方案起作用， 的`clone`方法`Dog` *不得*声明它会抛出`CloneNotSupportedException`. 原因是 to 的参数`map`不允许抛出任何已检查的异常。

像这样：

```
 // Note: Method is public and returns Dog, not Object
    @Override
    public Dog clone() /* Note: No throws clause here */ { ... 
```

然而，这应该不是一个大问题，因为无论如何这都是最佳实践。（例如*Effectice Java*给出了这个建议。）

^(*感谢 Gustavo 注意到这一点。*)

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2015-02-18T13:05:05.160

基本上有三种方式无需手动迭代，

1 使用构造函数

```
ArrayList<Dog> dogs = getDogs();
ArrayList<Dog> clonedList = new ArrayList<Dog>(dogs); 
```

2 使用`addAll(Collection<? extends E> c)`

```
ArrayList<Dog> dogs = getDogs();
ArrayList<Dog> clonedList = new ArrayList<Dog>();
clonedList.addAll(dogs); 
```

3 使用`addAll(int index, Collection<? extends E> c)`带`int`参数的方法

```
ArrayList<Dog> dogs = getDogs();
ArrayList<Dog> clonedList = new ArrayList<Dog>();
clonedList.addAll(0, dogs); 
```

注意：如果在操作进行时修改了指定的集合，这些操作的行为将是不确定的。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-08-07T05:58:58.270

**我认为当前的绿色答案很糟糕**，您为什么会问？

*   它可能需要添加大量代码
*   它要求您列出所有要复制的列表并执行此操作

序列化的方式也很糟糕 imo，您可能必须在所有地方添加 Serializable 。

**那么解决方案是什么：**

Java 深度克隆库 *克隆库*是一个小型的开源（apache 许可证）Java 库，它可以深度克隆对象。对象不必实现 Cloneable 接口。实际上，这个库可以克隆任何 java 对象。如果您不希望修改缓存的对象或想要创建对象的深层副本，则可以在缓存实现中使用它。

```
Cloner cloner=new Cloner();
XX clone = cloner.deepClone(someObjectOfTypeXX); 
```

[在https://github.com/kostaskougios/cloning](https://github.com/kostaskougios/cloning)上查看

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-06-09T21:44:16.040

您可以使用 JSON（带有 JSON 库）对列表进行序列化然后反序列化。未序列化时，序列化列表不包含对原始对象的引用。

使用谷歌 GSON：

```
List<CategoryModel> originalList = new ArrayList<>(); // add some items later
String listAsJson = gson.toJson(originalList);
List<CategoryModel> newList = new Gson().fromJson(listAsJson, new TypeToken<List<CategoryModel>>() {}.getType()); 
```

您也可以使用其他 JSON 库（如 Jackson）来实现。

使用这种方法的优点是您可以解决问题而无需创建类、接口和克隆逻辑（如果您的对象内部有其他对象列表，这可能会很长）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-05-18T07:20:16.803

我一直使用这个选项：

```
ArrayList<Dog> clonedList = new ArrayList<Dog>(name_of_arraylist_that_you_need_to_Clone); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-03T20:46:06.790

您将需要`ArrayList`手动克隆（通过迭代它并将每个元素复制到一个新的`ArrayList`），因为`clone()`它不会为您完成。这样做的原因是包含在 中的对象`ArrayList`可能不会`Clonable`自己实现。

**编辑**：...这正是 Varkhan 的代码所做的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-08-18T21:06:56.657

**将 ArrayList 复制为 Deep Copy 的其他一些替代方法**

**备选方案 1** - 使用外部包 commons-lang3，方法**SerializationUtils.clone()**：

```
SerializationUtils.clone() 
```

假设我们有一个类 dog，其中类的字段是可变的，并且至少一个字段是 String 类型的对象并且是可变的 - 不是原始数据类型（否则浅拷贝就足够了）。

浅拷贝示例：

```
List<Dog> dogs = getDogs(); // We assume it returns a list of Dogs
List<Dog> clonedDogs = new ArrayList<>(dogs); 
```

现在回到狗的深拷贝。

Dog 类确实只有可变字段。

**狗类：**

```
public class Dog implements Serializable {
    private String name;
    private int age;

    public Dog() {
        // Class with only mutable fields!
        this.name = "NO_NAME";
        this.age = -1;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    @Override
    public String toString() {
        return "Dog{" +
                "name='" + name + '\'' +
                ", age=" + age +
                '}';
    }
} 
```

**请注意，Dog 类实现了 Serializable！这使得可以利用方法“SerializationUtils.clone(dog)”**

阅读主要方法中的注释以了解结果。它表明我们已经成功地制作了 ArrayList() 的深拷贝。在上下文中参见下面的“SerializationUtils.clone(dog)”：

```
public static void main(String[] args) {
    Dog dog1 = new Dog();
    dog1.setName("Buddy");
    dog1.setAge(1);

    Dog dog2 = new Dog();
    dog2.setName("Milo");
    dog2.setAge(2);

    List<Dog> dogs = new ArrayList<>(Arrays.asList(dog1,dog2));

    // Output: 'List dogs: [Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]'
    System.out.println("List dogs: " + dogs);

    // Let's clone and make a deep copy of the dogs' ArrayList with external package commons-lang3:
    List<Dog> clonedDogs = dogs.stream().map(dog -> SerializationUtils.clone(dog)).collect(Collectors.toList());
    // Output: 'Now list dogs are deep copied into list clonedDogs.'
    System.out.println("Now list dogs are deep copied into list clonedDogs.");

    // A change on dog1 or dog2 can not impact a deep copy.
    // Let's make a change on dog1 and dog2, and test this
    // statement.
    dog1.setName("Bella");
    dog1.setAge(3);
    dog2.setName("Molly");
    dog2.setAge(4);

    // The change is made on list dogs!
    // Output: 'List dogs after change: [Dog{name='Bella', age=3}, Dog{name='Molly', age=4}]'
    System.out.println("List dogs after change: " + dogs);

    // There is no impact on list clonedDogs's inner objects after the deep copy.
    // The deep copy of list clonedDogs was successful!
    // If clonedDogs would be a shallow copy we would see the change on the field
    // "private String name", the change made in list dogs, when setting the names
    // Bella and Molly.
    // Output clonedDogs:
    // 'After change in list dogs, no impact/change in list clonedDogs:\n'
    // '[Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]\n'
    System.out.println("After change in list dogs, no impact/change in list clonedDogs: \n" + clonedDogs);
} 
```

**输出：**

```
List dogs: [Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]
Now list dogs are deep copied into list clonedDogs.
List dogs after change: [Dog{name='Bella', age=3}, Dog{name='Molly', age=4}]
After change in list dogs, no impact/change in list clonedDogs:
[Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}] 
```

**评论：** 由于更改list dogs后对list clonedDogs没有影响/更改，那么ArrayList的深拷贝就成功了！

**备选方案 2** - 不使用外部软件包：

与备选方案 1 相比，在 Dog 类中引入了新方法“clone()”，并删除了“implements Serializable”。

```
clone() 
```

**狗类：**

```
public class Dog {
    private String name;
    private int age;

    public Dog() {
        // Class with only mutable fields!
        this.name = "NO_NAME";
        this.age = -1;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    /**
     * Returns a deep copy of the Dog
     * @return new instance of {@link Dog}
     */
    public Dog clone() {
        Dog newDog = new Dog();
        newDog.setName(this.name);
        newDog.setAge(this.age);
        return newDog;
    }

    @Override
    public String toString() {
        return "Dog{" +
                "name='" + name + '\'' +
                ", age=" + age +
                '}';
    }
} 
```

阅读下面主要方法中的注释以了解结果。它表明我们已经成功地制作了 ArrayList() 的深拷贝。在上下文中参见下面的“clone()”方法：

```
public static void main(String[] args) {
    Dog dog1 = new Dog();
    dog1.setName("Buddy");
    dog1.setAge(1);

    Dog dog2 = new Dog();
    dog2.setName("Milo");
    dog2.setAge(2);

    List<Dog> dogs = new ArrayList<>(Arrays.asList(dog1,dog2));

    // Output: 'List dogs: [Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]'
    System.out.println("List dogs: " + dogs);

    // Let's clone and make a deep copy of the dogs' ArrayList:
    List<Dog> clonedDogs = dogs.stream().map(dog -> dog.clone()).collect(Collectors.toList());
    // Output: 'Now list dogs are deep copied into list clonedDogs.'
    System.out.println("Now list dogs are deep copied into list clonedDogs.");

    // A change on dog1 or dog2 can not impact a deep copy.
    // Let's make a change on dog1 and dog2, and test this
    // statement.
    dog1.setName("Bella");
    dog1.setAge(3);
    dog2.setName("Molly");
    dog2.setAge(4);

    // The change is made on list dogs!
    // Output: 'List dogs after change: [Dog{name='Bella', age=3}, Dog{name='Molly', age=4}]'
    System.out.println("List dogs after change: " + dogs);

    // There is no impact on list clonedDogs's inner objects after the deep copy.
    // The deep copy of list clonedDogs was successful!
    // If clonedDogs would be a shallow copy we would see the change on the field
    // "private String name", the change made in list dogs, when setting the names
    // Bella and Molly.
    // Output clonedDogs:
    // 'After change in list dogs, no impact/change in list clonedDogs:\n'
    // '[Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]\n'
    System.out.println("After change in list dogs, no impact/change in list clonedDogs: \n" + clonedDogs);
} 
```

**输出：**

```
List dogs: [Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}]
Now list dogs are deep copied into list clonedDogs.
List dogs after change: [Dog{name='Bella', age=3}, Dog{name='Molly', age=4}]
After change in list dogs, no impact/change in list clonedDogs:
[Dog{name='Buddy', age=1}, Dog{name='Milo', age=2}] 
```

**评论：** 由于更改list dogs后对list clonedDogs没有影响/更改，那么ArrayList的深拷贝就成功了！

**注意 1：** 备选方案 1 比备选方案 2 慢得多，但更易于维护，因为您不需要更新任何方法，例如 clone()。

**注意 2：**对于替代 1，以下 maven 依赖项用于方法“SerializationUtils.clone()”：

```
<!-- https://mvnrepository.com/artifact/org.apache.commons/commons-lang3 -->
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-lang3</artifactId>
    <version>3.9</version>
</dependency> 
```

在以下位置查找更多 common-lang3 版本：

[https://mvnrepository.com/artifact/org.apache.commons/commons-lang3](https://mvnrepository.com/artifact/org.apache.commons/commons-lang3)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-10T13:45:30.377

为您的对象覆盖 clone() 方法

```
class You_class {

    int a;

    @Override
    public You_class clone() {
        You_class you_class = new You_class();
        you_class.a = this.a;
        return you_class;
    }
} 
```

并为 Vector obj 或 ArraiList obj 调用 .clone()....

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-10-01T20:59:54.027

一个讨厌的方法是用反射来做。像这样的东西对我有用。

```
public static <T extends Cloneable> List<T> deepCloneList(List<T> original) {
    if (original == null || original.size() < 1) {
        return new ArrayList<>();
    }

    try {
        int originalSize = original.size();
        Method cloneMethod = original.get(0).getClass().getDeclaredMethod("clone");
        List<T> clonedList = new ArrayList<>();

        // noinspection ForLoopReplaceableByForEach
        for (int i = 0; i < originalSize; i++) {
            // noinspection unchecked
            clonedList.add((T) cloneMethod.invoke(original.get(i)));
        }
        return clonedList;
    } catch (NoSuchMethodException | InvocationTargetException | IllegalAccessException e) {
        System.err.println("Couldn't clone list due to " + e.getMessage());
        return new ArrayList<>();
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-11-27T14:34:13.517

```
List<Dog> dogs;
List<Dog> copiedDogs = dogs.stream().map(dog -> SerializationUtils.clone(dog)).Collectors.toList()); 
```

这将深度复制每只狗

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-04T10:12:21.843

其他海报是正确的：您需要迭代列表并复制到新列表中。

但是...如果列表中的对象是不可变的 - 您不需要克隆它们。如果您的对象具有复杂的对象图 - 它们也需要是不可变的。

不变性的另一个好处是它们也是线程安全的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-03-20T23:31:25.787

这是使用通用模板类型的解决方案：

```
public static <T> List<T> copyList(List<T> source) {
    List<T> dest = new ArrayList<T>();
    for (T item : source) { dest.add(item); }
    return dest;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-04-04T16:20:19.507

使用 java 库的 commons-lang-2.3.jar 克隆列表的简单方法

链接[下载 commons-lang-2.3.jar](http://repo1.maven.org/maven2/commons-lang/commons-lang/2.3/commons-lang-2.3.jar)

如何使用

```
oldList.........
List<YourObject> newList = new ArrayList<YourObject>();
foreach(YourObject obj : oldList){
   newList.add((YourObject)SerializationUtils.clone(obj));
} 
```

我希望这个可以有所帮助。

:D

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-05-02T19:25:00.657

包裹`import org.apache.commons.lang.SerializationUtils;`

有一种方法`SerializationUtils.clone(Object);`

例子

```
this.myObjectCloned = SerializationUtils.clone(this.object); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-05-11T23:28:53.923

我刚刚开发了一个能够克隆实体对象和 java.util.List 对象的库。只需在[https://drive.google.com/open?id=0B69Sui5ah93EUTloSktFUkctN0U](https://drive.google.com/open?id=0B69Sui5ah93EUTloSktFUkctN0U)下载 jar并使用静态方法 cloneListObject(List list)。此方法不仅克隆 List，还克隆所有实体元素。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-11-07T09:48:15.560

以下对我有用..

在 Dog.java 中

```
public Class Dog{

private String a,b;

public Dog(){} //no args constructor

public Dog(Dog d){ // copy constructor
   this.a=d.a;
   this.b=d.b;
}

}

 -------------------------

 private List<Dog> createCopy(List<Dog> dogs) {
 List<Dog> newDogsList= new ArrayList<>();
 if (CollectionUtils.isNotEmpty(dogs)) {
 dogs.stream().forEach(dog-> newDogsList.add((Dog) SerializationUtils.clone(dog)));
 }
 return newDogsList;
 } 
```

这里从 createCopy 方法创建的新列表是通过 SerializationUtils.clone() 创建的。因此对新列表所做的任何更改都不会影响原始列表

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-08-12T17:41:40.060

简单的方法是

```
ArrayList<Dog> dogs = getDogs();
ArrayList<Dog> clonedList = new ArrayList<Dog>(dogs); 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2016-11-23T22:24:09.230

我想我找到了一种非常简单的方法来制作深拷贝 ArrayList。假设您要复制一个 String ArrayList arrayA。

```
ArrayList<String>arrayB = new ArrayList<String>();
arrayB.addAll(arrayA); 
```

让我知道它是否不适合你。

# visual-studio - 为什么 Nant 驱动的 MsBuild 编译到不同机器上的不同目录？

> ID：715652
> 
> 赞同：0
> 
> 时间：2009-04-03T20:41:20.187
> 
> 标签：visual-studio, msbuild, x86, nant, teamcity

我编写了一个执行 MSBUILD.exe 的 Nant 脚本，以在我的开发机器上编译一个项目。在我的开发机器上，项目将其输出构建到 bin\x86\Release 并且我的 Nant 脚本压缩了该目录的内容。然后我将所有内容提交给 SVN 并让 TeamCity 运行执行 MSBUILD.exe 的 Nant 脚本来编译项目并压缩输出，但输出是在 bin\Release 中创建的，并且 zip 文件是空的，因为它在 bin\x86\ 中查找释放。为什么会这样？

当我在 VS.NET 2008 中更改配置和平台时，我没有看到项目文件在更改时亮起。这些设置是否存储在项目文件、解决方案文件或用户配置文件中，因此不会传递到构建服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:02:07.827

快速修复：您可以使用标志 /property:OutDir=bin\x86\Release

您必须找到造成这种情况的根本原因。可能配置不正确。您可以将配置显式更改为 /p:Configuration=Release

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T10:25:41.663

您确定 ${project.config} 在本地环境和 TeamCity 环境中都指向同一个地方吗？

代理并不总是以 sem 环境变量作为本地机器运行。所以我会开始检查所有属性，看看它们在本地机器和 TeamCity 中指向的位置。

至于 /p:Configuration=${project.config}，您只能运行一个配置，但您可以使用 ; 指定更多属性 它们之间：

/p:Configuration=${project.config};OutDir=bin\x86\Release

# xbox360 - 如何购买 Xbox 360 和 PS3 SDK？

> ID：715655
> 
> 赞同：5
> 
> 时间：2009-04-03T20:42:16.923
> 
> 标签：xbox360, ps3

有谁知道我如何购买上述 SDK？调用标准的索尼/微软销售数字似乎并没有让任何知道我在说什么的人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T21:07:06.037

首先，SDK 是免费的，但不是公开的。如果您真的很感兴趣，您可能会发现它们在洪流网站上四处游荡。它们很有趣，但在没有任何实际硬件的情况下几乎没有用处。

所以我怀疑你真正的问题是“我怎样才能购买开发硬件？”

Devkits 只提供给经过批准的开发人员和发行商，并且成本大大高于消费硬件。一个简单的测试站（运行未签名的代码）可能要花费数千美元，一个完整的开发套件大约需要 1 万美元。（它们过去大约是 2 万美元，但现在“便宜”了）。

要获得任何购买机会，您需要成为注册开发者，根据您的公司、您的跟踪记录和您的发行商/财务支持，从“硬”到“不可能”不等。如果你是一个新开发者，既没有发布者也没有非常好的演示，恐怕你的机会实际上是零。

一种替代方法是查看 XNA studio 之类的东西，它允许您在消费者 Xbox 硬件上进行开发，并可能稍后通过 Xbox Live 销售您的游戏。这是您可以创建演示以尝试吸引兴趣的一种方式，但如果要成为“合适的”Xbox 或 Xbox Live Arcade 游戏，您以后可能必须从 C# 移植到 C/C++。

如果您对此感兴趣，请点击链接；

[http://www.scedev.net/common_licensing_info.php](http://www.scedev.net/common_licensing_info.php)

[http://www.xbox.com/en-US/dev/regdev.htm](http://www.xbox.com/en-US/dev/regdev.htm)

[http://creators.xna.com](http://creators.xna.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T20:54:31.637

你不能只是购买它们。首先，您必须在任一公司注册，然后一旦获得批准，您必须支付超过 2 万美元才能购买该设备。对于 MS，我会尝试他们的[XNA 站点之一](http://xna.com/)

# c# - 将 C 方法/类导入 C# 项目

> ID：715673
> 
> 赞同：1
> 
> 时间：2009-04-03T20:47:09.393
> 
> 标签：c#, .net, c, cross-language

我有一些 c 头文件和 ac lib，我想在 ac# 项目中导入和使用它们。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T20:48:57.127

使用`[System.Runtime.InteropServices.DllImport]`属性（[P/Invoke](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)）：

```
[DllImport("dllname.dll")]
static extern void MyFunctionName(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T20:51:34.107

迈赫达德所说的。

此外，欢迎来到编组的美妙世界。 [P/Invoke.Net](http://www.pinvoke.net/)是您最好的新朋友。

# jquery - jQuery Dialog 和 Datepicker 插件的问题

> ID：715677
> 
> 赞同：54
> 
> 时间：2009-04-03T20:47:31.857
> 
> 标签：jquery, jquery-ui-dialog

我有一个对话框，对话框上有一个日期选择器字段。

当我打开对话框并单击日期选择器字段时，日期选择器面板显示在对话框后面。

我尝试了更多属性：zindex、stack、bgiframe，但没有成功。

有人可以帮助我吗？

谢了。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-04-03T20:57:08.290

**旧答案**

`z-index`（注意连字符！）是重要的属性。确保将其设置为大于对话，并确保将其设置在正确的元素上。我们是这样做的：

```
#ui-datepicker-div 
{
 z-index: 1000; /* must be > than popup editor (950) */
} 
```

**API 变更 - 2010 年 4 月 17 日**

在日期选择器的 CSS 文件中，找到该`.ui-datepicker`项目并进行更改：

```
.ui-datepicker { width: 17em; padding: .2em .2em 0; z-index: 9999 !important; } 
```

使用**z-index: 9999 !important;** 在 Firefox 3.5.9 (Kubuntu) 中工作。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-04-13T15:11:33.557

对于 jquery-ui-1.8

```
<style type="text/css">
    .ui-datepicker
    {
        z-index: 1003 !important; /* must be > than popup editor (1002) */
    }
</style> 
```

由于 datepicker 有一个 element.style 将 z-index 设置为 1，因此需要很重要。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-29T08:02:17.200

这对我有用：

```
.ui-datepicker {
        z-index: 9999 !important;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-02T19:58:00.963

将以下样式放在“输入”文本元素中：“位置：相对；z-index：100000；”。

datepicker div 从输入中获取 z-index，但这仅适用于相对位置。

使用这种方式，您不必从 jQuery UI 修改任何 javascript。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-10T21:06:12.277

从 UI 版本 1.7.2 开始，ui-datepicker-div 不再是有效的 css 元素。“ui-datepicker”似乎是最外层的包装器，据我所知，将 z-index 设置为 99999 对我来说工作正常

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-25T06:48:09.720

对于 jquery-ui-1.7.2

```
<style type="text/css">
    .ui-datepicker
    {
        z-index: 1003; /* must be > than popup editor (1002) */
    }
</style> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-14T15:22:52.657

将此设置在页面顶部。它会正常工作：

```
<style type="text/css">
.ui-datepicker {z-index:10100;}
</style> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-04T06:47:51.473

我打电话给它工作

```
$("#ui-datepicker-div").css("z-index", "1003" ); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-13T20:33:35.660

我很震惊：

a) 这里没有人提到设置 datepicker z-Index 的编程解决方案 b) jQuery DatePicker 在将其绑定到元素时没有传递 z-Index 的选项。

我正在使用js方法来计算最高索引。我们默认只检查 div，因为这些元素很可能获得 z-index 值，并且比解析页面上的每个元素更快可以理解。

```
/* Get the highest zindex for elements on the page
*/
function getHighestZIndex(element){
    var index_highest = 0;
    var index_current;
    if(element == undefined){
        element = 'div';
    }
    $(element).each(function(){
        index_current = parseInt($(this).css("z-index"), 10);
        if(index_current > index_highest) {
            index_highest = index_current;
        }
    });
    return index_highest;
} 
```

因为我们必须使用 javascript 将 datepicker 绑定到一个元素，即 $('#some_element').datepicker()，所以当时我们设置目标元素的样式，以便 datepicker 从中提取 z-index。感谢 Ronye Vernaes（在他在本页的回答中）指出 datepicker() 将拾取目标元素的 z-Index，如果它有一个并且设置为 position: relative：

```
$(this.target).datepicker();
var zindex = e.getHighestZIndex();
zindex++;
$(this.target).css('position','relative');
$(this.target).css('z-index',zindex); 
```

this.target 是我们在 datepicker 字段中输入的元素。在绑定时，我们获取页面上最高的 z-index 并使元素的 z-index 高一级。单击日期选择器图标时，它将从输入元素中拾取该 z-index，因为正如 Ronye Vernaes 所提到的，样式位置：相对。

在此解决方案中，我们不会尝试猜测最高 z-Index 值将是多少。我们实际上得到了它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T20:58:05.387

该对话框在 iframe 中呈现，并呈现在其他所有内容（包括下拉菜单）之上。同时，日期选择器以普通 HTML 呈现并绝对定位。

听起来日期选择器是绝对相对于父页面而不是 iframe 呈现的。您是否尝试过将日历作为标准的、非绝对定位的博客放在对话框中？或者您可以使用下拉菜单。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-03-01T14:48:04.647

jquery datepicker 1.8.3版本的解决方法，要改变z-index值，通过css来改变也不是不可能。

这个工作正常：

```
jQuery('.ui-datepicker-trigger').click(function() {
        setTimeout(function() {
            jQuery('#ui-datepicker-div').css('z-index', 999);
        }, 500)
    }); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-09T20:54:10.267

> 日期选择器现在将弹出 z-index 设置为比其关联字段多一个，以将其保持在该字段的前面，即使该字段本身在弹出对话框中也是如此。默认情况下，z-index 为 0，因此 datepicker 以 1 结束。是否存在无法正确显示 datepicker 的情况？[jQuery 论坛帖子](https://forum.jquery.com/topic/z-index-1-datepicker-1-8#14737000000803068)

要获得 100 的 z-index。您需要输入，`z-index:99;`JQueryUI 会将日期选择器更新为`z-index:100`

`<input style="z-index:99;">` 或`<input class="high-z-index">`和 css `.high-z-index { z-index: 99; }`

您还可以指定要继承的 z-index 应该从您的对话框继承，并导致 jQueryUI 正确检测 z-index。

`<input style="z-index:inherit;">` 或`<input class="inhert-z-index">`和 css `.inherit-z-index { z-index: inherit; }`

# asp.net - ASP.NET 并发

> ID：715687
> 
> 赞同：0
> 
> 时间：2009-04-03T20:52:40.160
> 
> 标签：asp.net, concurrency

我有一个 ASP.NET 应用程序，它在 ASP.NET 页面生命周期的事件处理程序阶段启动长时间运行的操作。这发生在最终用户按下按钮时，会对数据库进行一堆查询，生成一堆地图，然后从地图的 jpeg 图像制作电影。此过程可能需要一分钟多的时间才能完成。

这是应用程序的链接 [http://maxim.ucsd.edu/mapmaker/cbeo.aspx](http://maxim.ucsd.edu/mapmaker/cbeo.aspx)

我尝试使用线程池中的线程，创建和启动我自己的线程并使用 AsyncCallback 框架。问题是新线程在不同的用户 ID 下运行。我假设主线程在 ASPNET 下运行，新线程在 AD\MAXIM$ 下运行，其中 MAXIM 是主机名。我知道这一点是因为它尝试连接到数据库时出错。

为什么新线程在不同的用户 ID 下？如果我能找出用户 ID 问题，我想做的是通过检查 Page_Load 方法中的 Session 变量来检查电影制作过程是否已完成，然后添加一个指向页面的链接以访问电影。

有没有人有任何在 EventHandler 回调中使用或创建线程的 ASP.NET 应用程序中使用并发的好例子？

谢谢，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T20:57:31.893

你读过这个吗？： http: [//msdn.microsoft.com/en-us/magazine/cc163725.aspx](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)

引用该链接中的一个相关部分（您应该阅读整个内容）：

> 在构建异步页面时要记住的最后一点是，不应启动从 ASP.NET 使用的同一线程池借用的异步操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:04:36.543

没有解决您询问的具体问题，但这可能很快就会出现：

在什么时候使用这个视频？

*   如果它显示在页面中或由用户下载，浏览器用来获取视频的生成的 html 是什么样的？浏览器必须使用单独的 http 请求在某处调用该视频，您可以通过创建单独的 http 处理程序（* .ashx 文件）来处理该请求并在页面中编写该处理程序的 url 来做得更好。
*   如果是为了存储或在其他地方查看，您应该考虑只保存此时创建视频所需的信息，并将实际工作推迟到最终请求视频时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T21:09:50.787

> 问题是新线程在不同的用户 ID 下运行。我假设主线程在 ASPNET 下运行，新线程在 AD\MAXIM$ 下运行，其中 MAXIM 是主机名。

ASPNET 是一个本地帐户，当请求通过网络传输时，它将使用计算机的凭据 (AD\MAXIM$)。

*可能*发生的情况是，您在请求中模拟运行 - 而没有在 ThreadPool 中运行。如果是这种情况，您也许可以存储请求的当前 WindowsIdentity，然后在 ThreadPool 中模拟该身份。

或者，只需让 ThreadPool 使用 Sql 身份验证（用户名和密码）访问数据库。

# objective-c - 如何访问超类实例 var？

> ID：715691
> 
> 赞同：0
> 
> 时间：2009-04-03T20:54:29.547
> 
> 标签：objective-c, iphone, cocoa, cocoa-touch

我有一个非常简单的用例，这给我带来了困难：

这是一些代码：

```
@interface Foo : UIViewController {
    id myVar;
}

@property (nonatomic, retain) id myVar;
@end    

@interface Bar : Foo {}                     
@end 
```

如果当我在 Bar.m 中编写代码并尝试以如下格式访问 myVar 时：

```
self.myVar or [self myVar] 
```

编译器抱怨 myVar 不是结构或联合。myVar 在 Foo 中合成。为什么我不能在子类中访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:00:45.990

你还记得在 Bar.m 中导入 Bar.h，在 Bar.h 中导入 Foo.h 吗？

# debugging - 是否有任何工具可以监视 64 位服务器上的 IIS 请求？

> ID：715698
> 
> 赞同：0
> 
> 时间：2009-04-03T20:58:16.683
> 
> 标签：debugging, iis-6

是否有任何工具可用于监视服务器上所有当前的 IIS 请求？我有一些挂起的请求，我希望能够确定哪些请求被挂起，然后终止这些特定请求，而不影响其余请求或服务器本身。

我知道 IIS 工具包有一个名为“Requests Viewer”的工具，它可以完成我需要的大部分工作，但它不适用于 64 位服务器。

有谁知道可以做到这一点的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:21:36.097

您是否尝试过[x64 跟踪诊断](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1312)工具？我以前没有运行过 IIS 请求查看器，但它肯定可以在 x64 上运行......

编辑：[跟踪诊断](http://www.microsoft.com/downloads/details.aspx?FamilyID=30D8DAAF-2961-4578-B563-DCB9EEB70C53&displaylang=en)专门将“Windows Server 2003 Service Pack 2 x64 Edition”称为受支持的操作系统。也许您还有其他问题？你确定你在 x64 上吗（是的 - 我知道，这是一个奇怪的问题，但有时你必须问......它可能是 ia-64（安腾））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:08:09.623

您可能能够在记录请求的 IIS 之前安装代理。

# netbeans - 如何在 Netbeans 中编译和运行无项目文件？

> ID：715699
> 
> 赞同：13
> 
> 时间：2009-04-03T20:58:27.023
> 
> 标签：netbeans

> Netbeans，实际上是任何 Java 编译器和执行器，都需要知道类路径才能编译和运行文件。当您只是在 Netbeans 中打开一个文件时，您不会告诉它任何这些信息。当您设置一个项目时，该过程会告诉 Netbeans Java 资源在哪里。

然而，其他 IDE 可以轻松做到这一点。这不是一个好习惯，但“鬼鬼祟祟”却简单快捷。

有没有办法在 Netbeans 中编译和运行不属于项目的文件？

**编辑：**如果文件不属于项目，选项将显示为灰色。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-23T20:11:46.620

使用 NetBeans 的最佳选择是创建一个虚拟的“尝试东西”项目，您知道该项目永远不会包含交付产品，但允许您进行试验，而不必每次都创建新项目。

您甚至可以通过这种方式收集不同类的代码片段。如果您`main()`为每个实验类添加一个方法，那么您只需更改为主项目类设置的内容即可在 IDE 中运行它们。这就是我所做的，而且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-07T12:34:23.083

为什么不使用可用于 Java、Ruby 等项目的“使用现有资源创建新项目”？

您可以这样做，netbeans 只会在您的项目目录中创建一个 nbproject 文件夹，一切都应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-24T08:04:16.480

此解决方案效果不佳，因为项目也是“类型化”的，而且我使用 4 种语言工作。我讨厌有一个“rubystuff”项目、一个“pythonstuff”项目、“javastuff”等等……

# .net - 集成FogBugz，它有哪些API/集成点？

> ID：715700
> 
> 赞同：3
> 
> 时间：2009-04-03T20:58:32.000
> 
> 标签：.net, fogbugz

除了登录 FogBugz 并使用它等之外，它还有哪些集成点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T21:02:23.800

它有一个非常完整的 API：[http ://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html)

它们是许多 IDE 的解决方案，您可以将其与源代码控制集成： [http ://www.fogcreek.com/FogBugz/Ecology.html](http://www.fogcreek.com/FogBugz/Ecology.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T21:13:03.587

[这里](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html)记录了一个 REST API 。[这里](http://www.fogcreek.com/FogBugz/blog/post/An-API-Tutorial-Plus-Excel-2007-Export-Plus-Zombies!.aspx)有一个有趣的教程。如果您发现任何问题，请告诉我们。我们想要一个完整的 API。

有一些[生态](http://www.fogcreek.com/FogBugz/Ecology.html)是围绕这个成长起来的。还[与许多源代码控制系统集成](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/Sourcecontrolintegration.html)。

**即将发布**：

我们的下一个版本中即将推出完整的插件架构。我们的开发人员 Alpha 版指日可待。如果您熟悉 .NET 语言，尤其是 C# .NET，并且对扩展 FogBugz 有一些想法，您可以在[此处](http://www.fogcreek.com/sendmail.html)注册以加入开发人员 Alpha 版。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:00:43.650

请参阅[FogBugz API 文档](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html)。

# f# - 计算表达式不执行 Let

> ID：715707
> 
> 赞同：3
> 
> 时间：2009-04-03T21:00:46.490
> 
> 标签：f#, monads, computation-expression

我正在使用 F# v 1.9.6.2，并且我定义了一个非常简单的计算表达式：

```
type MaybeBuilder() =
    member this.Let(x, f) =
        printfn "this.Let: %A" x
        this.Bind(Some x, f)
    member this.Bind(x, f) =
        printfn "this.Bind: %A" x
        match x with
        | Some(x) when x >= 0 && x <= 100 -> f(x)
        | _ -> None
    member this.Delay(f) = f()
    member this.Return(x) = Some x

let maybe = MaybeBuilder() 
```

我在代码中添加了一些打印语句来告诉我在计算表达式中调用了哪些方法。当我执行以下语句时：

```
maybe {
    let x = 12
    let! y = Some 11
    let! z = Some 30
    return x + y + z
} 
```

我希望控制台打印出以下内容：

```
this.Let 12
this.Bind 一些 12
this.Bind 一些 11
this.Bind 一些 30
```

但我的实际结果如下：

```
this.Bind: 一些 11
this.Bind: 大约 30
```

换句话说，F# 似乎没有执行该`Let`成员。当我重新编写`Let`抛出异常时，代码运行时没有异常。此外，当我完全注释掉该`Let`成员时，我*没有*收到一条错误消息说明`The field, constructor or member 'Let' is not defined`，并且代码按预期执行。

（我尝试使用 Reflector 调查代码，但通常情况下，反编译的 F# 被破坏，超出了可读性。）

**看起来[计算表达式的规范](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec2.aspx#_Toc207785614)已经改变。`let`绑定不再被视为语法糖，计算`Let`工作流程中不再需要成员吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T21:18:54.900

你自己有答案。来自描述如何翻译计算表达式的[F# 规范](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec2.aspx#_Toc207785614)：

```
{| let binds in cexpr |}C  = let binds in {| cexpr |}C) 
```

所以不，您不再需要明确定义 let ，它由编译器翻译。

更新：[9 月 CTP 的详细发行说明中](http://blogs.msdn.com/dsyme/archive/2008/08/29/detailed-release-notes-for-the-f-september-2008-ctp-release.aspx)提到了此更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:29:51.363

正确 - 您不能再为 let :( 提供绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:59:38.980

另请参阅 [http://cs.hubfs.net/forums/thread/6950.aspx](http://cs.hubfs.net/forums/thread/6950.aspx)

# javascript - Response.Redirect 和 OnBeforeUnload 可以一起玩吗？

> ID：715708
> 
> 赞同：2
> 
> 时间：2009-04-03T21:01:21.137
> 
> 标签：javascript, asp.net, ajax, dom-events, asp.net-ajax

有谁知道如何检测`OnBeforeUnload`服务器端代码发送的事件`Response.Redirect`？我想提示用户不要让他们在时间之前离开页面，但是当服务器重定向我时，它不应该提示用户。

我正在使用广泛使用的遗留代码，`Response.Redirect`我对改变重定向发生的方式不感兴趣。请不要建议我使用 X 重定向方法。

~~**应该**可以根据 XMLHttpRequest 对象中的响应代码来执行此操作，因为响应重定向应该发回 302 。~~

**编辑：** Response.Redirect 发回 200，在正文中带有重定向代码，然后`window.location.href = new page`在 ASP.Net 代码中执行。有没有办法获得服务器响应以确定这已经发生？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T21:53:27.407

我想出了一个解决方案。

当 PageRequestManager 正在处理来自服务器的响应时，它将设置 _processingRequest 标志。为了允许 response.redirect 通过，我更改了我的 javascript 来检查它。事件现在看起来像这样：

```
window.onbeforeunload = function() {
  var prm = Sys.WebForms.PageRequestManager.getInstance();
  if (!prm._processingRequest){ 
    return "Are you sure you want to leave?";
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:15:31.897

对于非 ajax 页面，你很不走运，因为页面永远不会发送到浏览器，只是 302 标头。所以没有机会进行 OnBeforeUnload 的 javascript 处理。

使用 ASP.NET AJAX 的 Response.Redirect 并没有真正执行 302。它通过 XMLHttpRequest 发回一条消息，而 ASP.NET AJAX 正在模拟 302。理论上你可以拦截它并执行你自己的处理......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T21:19:31.670

是的，`Response.Redirect`有一个重载让您决定是否终止请求（引发 a `ThreadAbortException`）。如果让`Response`finish（第二个参数传递false）；`OnBeforeUnload`也会运行。

但是，在这种情况下，简单地运行`OnBeforeUnload`对您没有帮助，因为您的客户端代码（提示）将在新页面发送到浏览器之前运行（并且，如果您重定向，它也只是 302 标头而不是真实页面）。

我会使用 AJAX 来查询服务器，如果它报告操作已完成，则允许在 Javascript 代码中进行重定向。

# svn - 在 Subclipse 中自动查找要合并的修订

> ID：715723
> 
> 赞同：0
> 
> 时间：2009-04-03T21:05:29.770
> 
> 标签：svn, subclipse

嗨，我有一个与 Subclipse 相关的问题。

在 SVN 中，当您将主干合并到您正在处理的分支时，您只需使用以下命令：

```
svn merge http://svn.example.com/rep/trunk 
```

并且您会自动获取上次将主干合并到分支中的所有新更改。

在 Subclipse 中，当您选择合并时，您必须选择要合并更改的修订范围。现在我知道在提交更改时通过适当的评论这不是一个大问题，但我想知道是否有一种自动方法可以简单地从分支的主干中获取所有新更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-30T19:58:26.590

新的 subclipse 版本 1.6 解决了这个问题...

# sql - 在一个 UPDATE 语句中使用和更新同一字段会导致未定义的行为吗？

> ID：715725
> 
> 赞同：0
> 
> 时间：2009-04-03T21:05:43.247
> 
> 标签：sql

这是一个例子

```
UPDATE duration = datediff(ss, statustime, getdate()), statustime = getdate() where id = 2009 
```

字段**持续时间**是否将被分配一个未定义的分配值，因为 statustime 在同一语句中被使用和分配？（即，如果先处理 datediff 则为正值，如果先处理 statustime 则为负）

我绝对可以在两个单独的语句中更新它，但我很好奇可以在一个语句中更新它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T21:10:11.753

不会。这两个值都是在进行任一分配之前计算的。

**更新：**
我追踪了[ANSI-92 规范](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)，UPDATE 语句的第 13.10 节说：

> `The <value expression>s are effectively evaluated for each row of T before updating any row of T.`

其他唯一适用的规则参见第 9.2 节，但仅单独处理一项分配。

这里有*一些*模棱两可的地方：它可以先计算和更新所有`statustime`行，`duration`然后再计算和更新所有行，并且在技术上仍然遵循规范，但这将是一种非常......奇怪......实现它的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T21:09:52.333

我的直觉说“不”，但这会因 SQL 实现、查询解析器等而异。在这种情况下，您最好的选择是在您的服务器上运行一个快速实验（将其包装在事务中以防止它修改数据），并查看您的特定实现的行为方式。

# actionscript-3 - 在 AS3 中创建自定义 trace() 类

> ID：715738
> 
> 赞同：4
> 
> 时间：2009-04-03T21:12:05.230
> 
> 标签：actionscript-3, debugging, logging

我有了扩展我的 trace() 消息的想法。

**为什么**

trace() 遍布我的代码，我想通过一个简单的命令打开/关闭它们，并可能向 trace() 添加某种优先级功能，即

```
myTrace.TraceMsg("loosehere",debugme, 0);
myTrace.TraceMsg("winhere",debugme, 1); 
```

当我运行时，只有具有更高优先级的那个，在这种情况下为“1”，显示。

我还想添加更多功能，例如将消息记录到文件等。

**问题**

跟踪（）如何工作？- 是否有可能以某种方式重载trace()？- 我将如何实现自定义 TraceMsg（这里有什么代码？）方法？

在我们最喜欢的搜索引擎上查找有关此主题的信息时遇到一些严重问题，因此将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-23T16:46:23.720

我想出了一种相当有效但乏味的方法来在仅限 Flash 的项目中使用我自己的 trace() 函数，但只需使用

```
trace("this", "that", "and that too"); 
```

我基本上在项目的每个类中都实现了一个 trace() 方法，它调用一个公共函数（这样我就可以从那里调用真正的 trace() 函数。

这就是我所做的：在每节课上我都称之为

```
include "trace_implementation.as"; 
```

.as 文件中有一个简单的方法实现（也可以是静态方法）。

```
public function trace(... arguments){
    for(var i in arguments){
        myTrace(arguments[i]);
    }
} 
```

并且 myTrace 函数在其自己的 myTrace.as 文件中定义

```
package pt.utils{
    import flash.external.ExternalInterface

    public function myTrace(_s:String):void{
        trace(_s);// this will call the original flash trace() function
        ExternalInterface.call("console.log", _s);// to get traces outside of flash IDE
            /*implement what you want here*/
    }
} 
```

**所以现在当我用“省略跟踪操作”编译时，我的整个调试都被忽略了，就像我简单地使用了 trace() 一样。**

这里真正好的部分是您可以根据您在跟踪中提供的指令实施自定义操作，因此：

```
trace(Debug.DEBUG_MESSAGE, "message to output in debug");
trace(Profile.START_PROFILING, this, 'name');
/*do heavy code*/
trace(Profile.STOP_PROFILING, this); 
```

然后从 myTrace 或 Tracer 类或任何东西发送它:)

希望这有助于未来的示踪剂。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T22:41:45.730

`trace()`它本身是一个顶级函数，而不是一个类，所以很遗憾我们不能扩展它。话虽如此，我们可以在一个简单的类中使用它来做它通常所做的事情，只有在这种情况下，跟踪是基于条件的（即布尔值 - 真|假等）。首先我们创建 Trace 类，我们不会自己实例化它，因为我们通过下面的类 Tracer 使用工厂设计模式。Tracer 是围绕单例设计模式构建的，当调用 Tracer 的 trace 方法时，它利用工厂模式来实例化 Trace 的实例。

```
//This class is handled by Tracer, which is right below it.
//You WILL NOT instantiate these, nor hold references.
package
{
    public class Trace
    {
        private function _value:*;
        private function _trace:Boolean;

        public function Trace(pValue:*, pTrace:Boolean):void
        {
          _value = pValue;
          _trace = pTrace;
        }
        public function get value():*
        {
           return _value;
        }
        public function get trace():Boolean
        {
           return _trace;
        }
    }
}
//This is the important class and the only one you will work with.
package
{
    /**
     *Utilizes Singleton and Factory design patterns.
     */
    public class Tracer
    {
        private var _traceArray:Array;
        private static var _instance:Tracer;

        public function Tracer(pvt:PrivateClass = null):void
        {
            if(pvt == null)
            {
                throw(new Error("You cannot instantiate this class directly, please use the static getInstance method."));
            }

            _init();
        }
        public static function getInstance():Tracer
        {
            if(Tracer._instance == null)
            {
                Tracer._instance = new Tracer(new PrivateClass());
            }
            return Tracer._instance;
        }
        public function trace(pValue:*, pTrace:Boolean):void
        {
           var trace:Trace = new Trace(pValue, pTrace);
           if(trace.pTrace)
           {
               trace(pValue);
           }
        }
        //Since we have the option for individual traces to be disabled
        //I provide this to get access to any and all later.
        public function traceAll():void
        {
            traceStr:String = _traceArray.toString();
        }
        public function get traceables():Array
        {
            return _traceArray;
        }
        //Here we provide a method to trace all, even if set to false in their constructor.
        private function _init():void
        {
            _traceArray = new Array();
        }
    }
}
//Here we create a class that is OUTSIDE of the package.
//It can only be accessed from within this class file.  We use this
//to make sure this class isn't instantiated directly.
class PrivateClass
{
    function PrivateClass():void
    {
        trace('can only be accessed from within this class file');
    }
}

//Now for use in doc class
package
{
    import flash.display.Sprite;
    import flash.events.Event;

    //No need to import Tracer and Trace, they are also in the
    //unnamed package.

    public class DocumentClass extends Sprite
    {
        private var _tracer:Tracer;

        public function DocumentClass():void
        {
            if(stage) _init();
            else addEventListener(Event.ADDED_TO_STAGE, _init);
        }
        private function _init(e:Event = null):void
        {
            _tracer = Tracer.getInstance();
            _tracer.trace(10*20, false);
            _tracer.trace(10*20, 0); //SAME AS ABOVE
            _tracer.trace("I love AS3", true); //traces
            _tracer.traceAll(); //Would trace: 200, 200, I love AS3
        }
    }
} 
```

请记住，这是不切实际的，很可能有一两个错误，但想法就在那里；也就是说，这没有经过测试，只是为了让您了解如何实现它。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T21:21:04.757

查看 Flex[日志记录](http://livedocs.adobe.com/flex/3/html/help.html?content=logging_09.html)API，尤其是部分：*使用日志记录 API 实现自定义记录器*。

也查一下[`TraceTarget`](http://livedocs.adobe.com/flex/3/langref/mx/logging/targets/TraceTarget.html)班级。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-03T00:25:35.360

你不能重写`trace`它自己，但为了便于输入，我喜欢创建一个名为 'tr' 的全局函数。一个鲜为人知的事实是您可以在 AS3 中创建全局函数，但这很容易。

`tr.as`在主源目录（不在子目录或包中）中创建一个名为的文件，其内容为：

```
package {
  public function tr(msg:String, ...):void {
    // add custom trace logic here
    trace("tr message: "+msg);
  }
} 
```

如果您需要有很多逻辑或静态存储变量等，最好创建一个单独的静态类，并调用全局 tr 函数，例如：

```
package {
  import org.code.MyTracer;
  public function tr(msg:String, ...):void {
    MyTracer.tr(msg); // all the tracing logic is inside the MyTracer class
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-18T06:12:21.903

这是我使用的一个超级简单的自定义跟踪功能。debugFlag 可以在包的其他地方设置为 true/false。

公共静态函数 myTrace(... vars) :void {

```
if (debugFlag) {
    var output:Array = new Array;
    for each (var arg in vars) {
             output.push(arg);
     }
    trace(output);
} 
```

}

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-23T17:19:00.223

在 AS2 中，可以通过执行以下操作来覆盖全局跟踪函数（取自内存，可能有点错误，但它的要点在那里）：

```
public static var realTrace:Function = _global["trace"];

// This is put in some init code somewhere
_global["trace"] = myTrace;

public static function myTrace(... args):void
{
    // Do whatever you want with args here, build a nice formatted string or whatever
    // before passing to realTrace. Using with MTASC one could add line numbers, class
    // names and all sorts of nice meta data. Or just return should you want to turn
    // tracing off.
    realTrace.apply(args);
} 
```

不幸的是，我还没有找到在 AS3 中做同样事情的方法。然而。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-15T19:11:35.143

Trace 是一个顶级函数，所以你不能覆盖它，据我所知，它不会触发任何事件。由于它是一个顶级函数（不包含在任何命名包中），您可以在没有导入语句的情况下使用它。

下面是一个顶级“Tracer”类的示例，您可以在没有 import 语句的情况下使用它来代替 trace。

只需调用“Tracer.write”或“Tracer.writeError”来跟踪错误对象。“Tracer.write”接受可变数量的参数，就像内置的跟踪函数一样。“Tracer.writeError”是一个帮助方法，可让您轻松跟踪错误对象。

**特征：**

1.  调用内置跟踪。
2.  将您对 Tracer.write 的所有调用记录为字符串数组。
3.  调用日志可通过 getText 作为字符串访问，它将数组中的所有元素与换行符连接起来，并且可以选择添加行号！
4.  当新行添加到日志时触发事件，因此如果您有某种日志显示窗口，则显示窗口可以侦听 Tracer 事件，以便在事件发生时实时更新日志显示。这对于在 Web 浏览器或独立播放器中运行时显示跟踪事件非常有用。

**-Tracer 类定义**

```
package
{
    import flash.events.EventDispatcher;

    public class Tracer extends EventDispatcher
    {
        private static var traced_text:Array = new Array( "--Start of Trace Log--" );
        public static var enabled:Boolean = true;
        private static var suspended:Boolean = false;
        public static var instance:Tracer = new Tracer();
        public static const newline:String = "\n"; //workaround for TextField.appendText bug.. use "\n" instead of "\r".  See note and link to bug post in getText method

        public function Tracer()
        {
        }

        static public function write( ...args ):void
        {
            if (enabled && !suspended)
            {
                trace.apply( null, args );
                var text:String = args.join( newline );
                var next_index:int = traced_text.length;
                traced_text.push( text );
                suspended = true; //prevent recursive calls from TracerEvent handler
                instance.dispatchEvent( new TracerEvent( text, next_index ) );
                suspended = false;
            }
        }

        static public function writeError( e:Error ):void
        {
            write( "errorID: " + e.errorID, "errorName: " + e.name, "errorMessage: " + e.message, "stackTrace: " + e.getStackTrace() );
        }

        static public function getText( include_line_numbers:Boolean ):String
        {
            var line_count:int = traced_text.length;
            var lines:Array = traced_text; //store pointer to traced_text; pointer may be changed to reference an altered array that includes line numbers
            if (include_line_numbers) //create temporary trace log copy with altered lines; allows quick call to join at end
            {
                var new_lines:Array = new Array();
                for (var i:int = 0; i < line_count; i++)
                    new_lines.push( i.toString() + ": " + lines[i] );
                lines = new_lines;
            }
            return lines.join( newline ); //do not include last newline character (workaround for bug in appendText method (https://bugs.adobe.com/jira/browse/FP-1982); I have to call appendText with newline character first, otherwise it has issues like not acknoledging the newline thats already there at the end).
        }

        static public function addEventListener(type:String, listener:Function, useCapture:Boolean = false, priority:int = 0, useWeakReference:Boolean = false):void 
        {
             instance.addEventListener(type, listener, useCapture, priority, useWeakReference);
        }

        static public function removeEventListener(type:String, listener:Function, useCapture:Boolean = false):void 
        {
            instance.removeEventListener(type, listener, useCapture);
        }

        static public function willTrigger(type:String):Boolean 
        {
            return instance.willTrigger(type);
        }

        static public function hasEventListener(type:String):Boolean 
        {
            return instance.hasEventListener(type);
        }
    }
} 
```

**-TracerEvent 类定义**

```
package
{
    import flash.events.Event;

    public class TracerEvent extends Event
    {
        public static const WRITE:String = "te_write";

        public var text:String;
        public var index:int; //index of newly traced text in the traced_text array (trace log)

        public function TracerEvent( text:String, index:int ) 
        {
            super( WRITE, false, false );
            this.text = text;
            this.index = index;
        }

        override public function clone():Event 
        {
            return new TracerEvent( text, index );
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-10T22:16:41.810

如下所述，没有办法覆盖跟踪（至少如果您希望跟踪到达输出流，则不会），但实际上很容易创建您自己的通用可访问的日志记录功能。另外，您甚至可以定义一个普遍可访问的布尔值来打开或关闭登录：

**log.as**（注意文件名必须反映函数名）

```
package {
    function log(... arguments):void {

        trace("Custom logging FTW!");
        if (logEnabled)
            trace(arguments);
    }
} 
```

**logEnabled.as**（注意文件名必须反映变量名）

```
package {
    var logEnabled:Boolean = true;
} 
```

**主文件**

```
package {

    import flash.display.MovieClip;

    public class Main extends MovieClip {

        public function Main() {
            log("Testing");
            logEnabled = false;
            log("Testing2");
        }
    }
} 
```

**回复**

```
Custom logging FTW!
Testing
Custom logging FTW! 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-02-03T18:01:46.283

您不需要覆盖它，只需在您的项目中创建一个函数并将其称为跟踪，然后任何跟踪调用都将指向 this.trace ;)

```
function trace(... arguments){  
    yourfunction(arguments);
} 
```

# c# - 寻找用于检测可移动驱动器（USB 闪存）的 C# 代码

> ID：715739
> 
> 赞同：5
> 
> 时间：2009-04-03T21:12:10.597
> 
> 标签：c#, windows-vista, usb-drive

我正在寻找一个 C# 代码片段，以便在将 USB 驱动器插入我的 Windows Vista（或 win7）PC 时通知我

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T21:16:12.473

Codeproject 上有一个名为[DriveDetector](http://www.codeproject.com/KB/system/DriveDetector.aspx)的类，听起来它可以满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T21:16:20.773

查看[WM_DEVICECHANGE](http://msdn.microsoft.com/en-us/library/aa363480(VS.85).aspx)。插入驱动器时应发送此消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T22:59:40.667

我知道这并不完全符合您的要求，但如果您想随时检查可用的设备，还有另一种方法。[您可以使用System.Management 命名空间](http://msdn.microsoft.com/en-us/library/ms257340(VS.80).aspx)中的 WMI 类，我使用过这种方法并且效果很好。

如果您看一下[这个答案](https://stackoverflow.com/questions/123927/how-to-find-usb-drive-letter/124025#124025)，它会显示如何枚举系统上的所有驱动器。然后，您可以查看驱动器类型以确定它是否是 U 盘。

# java - JSTL 格式标签？

> ID：715741
> 
> 赞同：0
> 
> 时间：2009-04-03T21:12:46.180
> 
> 标签：java, jsp, jstl

我有一个自定义`java.text.Format`并想在我的 JSP 中使用它。是否有可以使用自定义格式化对象的 JSP/JSTL 标记`java.text.Format`？我正在寻找类似的东西`<fmt:formatNumber>`，`<fmt:formatDate>`除了可以使用自定义格式。

我知道我可以编写自己的标签，但很好奇是否有现成的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:21:40.120

不，那里没有。您必须编写自己的自定义标签。

# sql - 单表继承还是两个表？

> ID：715745
> 
> 赞同：1
> 
> 时间：2009-04-03T21:14:52.150
> 
> 标签：sql, database, database-design, sti

假设我有一个包含以下列（单词列表）的表：

```
word: varchar
contributor: integer (FK) 
```

现在，假设我想为每个“单词”翻译。什么是最好的？有第二张桌子吗？

```
word: integer (FK)
translation: varchar
contributor: integer (FK)
lang: integer (FK) 
```

还是都在同一张桌子上？

```
word: varchar
translation_for: integer (FK - to the same table)
contributor: integer (FK)
lang: integer (FK) 
```

假设有两种情况，（1）我需要提取一个翻译后的词以及它翻译自的原始词，（2）我**只**需要提取翻译后的词。在这两种情况下，我都会更频繁地使用“原始”词（*SELECTing*和*UPDATEing/INSERTing*）。

那么，哪种方法最适合每种情况或一般情况？我倾向于第一种方法，因为那时我的“默认”选择不必由*lang*列限定。你怎么看？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:30:53.733

如果您现在不规范化数据库，我认为以后如果您想添加一种语言，您以后会受到伤害。有一个单词表，其中单词是默认语言。它有一个 ID。有一个带有 ID（即西班牙语，2）的语言表和一个包含单词 ID、语言 ID 以及最后是该语言的实际单词的翻译表。这是链接表。

使用视图进行查询，但对于插入和更新，取决于您的 DBMS，您可能需要硬查询。

这只是假设您正在尝试提供本地化，因此以后可能会添加更多语言。这样做比每次添加语言时都必须修改数据库以添加列更容易。如果您真的只需要一个翻译并且非常怀疑您是否需要另一个翻译，那么只需添加一列就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:27:47.220

由于您似乎希望“单词”具有与“翻译单词”不同的身份，因此 1 认为第一个选项更能满足您的需求。

通常，我认为设计更像：

```
PK (Key (varchar), Lang (FK)), Word (nvarchar) 
```

会更合适 - 你只通过它的 Key 和 Lang 值来引用文本。但是，看起来您正在用“原始单词”替换 Key - 所以它略有不同。

# php - 将字符串拆分为多个部分 PHP

> ID：715747
> 
> 赞同：1
> 
> 时间：2009-04-03T21:16:01.477
> 
> 标签：php, regex, string

有以下我需要拆分的字符串。

```
$string = "This is string sample - $2565";
$split_point = " - "; 
```

一：我需要能够使用正则表达式或任何其他匹配将字符串拆分为两部分，并指定要拆分的位置。

第二：也想为$做一个preg_match，然后只抓取$右边的数字。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T21:19:27.787

```
$split_string = explode($split_point, $string); 
```

和

```
preg_match('/\$(\d*)/', $split_string[1], $matches);
$amount = $matches[1]; 
```

如果您愿意，这一切都可以在一个正则表达式中完成：

```
$pattern = '/^(.*)'.preg_quote($split_point).'\$(\d*)$/'

preg_match($pattern, $string, $matches);
$description = $matches[1];
$amount = $matches[2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T21:20:12.247

```
$parts = explode ($split_point, $string);
/*
$parts[0] = 'This is string sample'
$parts[1] = '$2565'
*/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:30:46.917

提到了另外两个答案`explode()`，但您也可以限制将源字符串拆分成的部分数量。例如：

```
$s = "This is - my - string.";
list($head, $tail) = explode(' - ', $s, 2);
echo "Head is '$head' and tail is '$tail'\n"; 
```

会给你：

```
Head is 'This is' and tail is 'my - string.' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T00:45:07.877

`explode`是您特定情况的正确解决方案，但`preg_split`如果您需要正则表达式作为分隔符，这就是您想要的

# cocoa - 在 CGContext 中绘制 NSAttributedString 时看起来很难看的文本

> ID：715750
> 
> 赞同：10
> 
> 时间：2009-04-03T21:17:40.177
> 
> 标签：cocoa, text, core-animation, pyobjc

我想在 CoreAnimation 图层中显示字符串，但不幸的是 CATextLayer 是不够的，主要是因为在使用约束时很难使用，*并且*要包装文本。

我正在使用 NSLayoutManager，使用以下代码（PyObjC）：

```
NSGraphicsContext.saveGraphicsState()

# THIS SOLVES THIS ISSUE
CGContextSetShouldSmoothFonts(ctx, False)

graphics = NSGraphicsContext.graphicsContextWithGraphicsPort_flipped_(ctx, True)
NSGraphicsContext.setCurrentContext_(graphics)

height = size.height
xform = NSAffineTransform.transform();
xform.translateXBy_yBy_(0.0, height)
xform.scaleXBy_yBy_(1.0, -1.0)
xform.concat()

self.textContainer.setContainerSize_(size)

glyphRange = self.layoutManager.glyphRangeForTextContainer_(self.textContainer)

self.layoutManager.drawBackgroundForGlyphRange_atPoint_(glyphRange, topLeft)
self.layoutManager.drawGlyphsForGlyphRange_atPoint_(glyphRange, topLeft)

NSGraphicsContext.restoreGraphicsState() 
```

这一切都很好并且可以工作，但唯一的问题是它会产生难看的文本（尽管它*是*反锯齿的）。

这是 CATextLayer 版本：[![](https://i.stack.imgur.com/KwMp0.png)](https://i.stack.imgur.com/KwMp0.png)

这是 NSLayoutManager 版本：[![](https://i.stack.imgur.com/Nj6x0.png)](https://i.stack.imgur.com/Nj6x0.png)

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-03T21:24:18.383

我正在回答这个问题，因为 coretext-dev 档案不可搜索，Apple 的 Aki Inoue 刚刚回答了我的问题：

> 由于 CALayer 不能表示子像素颜色（又名字体平滑），您需要禁用它。我相信 CATextLayer 默认会这样做。
> 
> 做 CGContextSetShouldSmoothFonts(context, false)。

谢谢，阿基！

Milen Dzhumerov 的另一条评论：

> 我不相信这是准确的。我们正在使用亚像素抗锯齿将文本绘制到 CALayers 中。在绘制文本本身之前，您只需确保已在文本后面绘制。有关参考，请参阅[http://www.cocoabuilder.com/archive/message/cocoa/2008/3/28/202581](http://www.cocoabuilder.com/archive/message/cocoa/2008/3/28/202581)。

Milen 是正确的，如果您事先知道背景颜色，您可以这样做：

```
CGContextSetRGBFillColor(ctx, r, g, b, a)
CGContextFillRect(ctx, (topLeft, size))
CGContextSetShouldSmoothFonts(ctx, True) 
```

你会得到漂亮**的亚像素**抗锯齿文本。但是，如果您*不*知道背景颜色，则*需要*关闭字体平滑，否则会得到乱码结果。

# linux - 附加到进程输出以供查看

> ID：715751
> 
> 赞同：130
> 
> 时间：2009-04-03T21:17:56.573
> 
> 标签：linux, logging, command-line-interface

我如何将控制台/终端视图“附加”到应用程序输出，以便我可以看到它可能在说什么？

如何在不终止应用程序的情况下从应用程序输出中分离？

通常，如果您使用命令行启动一个健谈的应用程序，您会看到各种精彩的输出。但是，假设我正在运行一个特别健谈的程序，例如 KINO，并且我想在任何给定时刻查看它的输出，而无需通过命令行重新启动它。我不能; 至少我不知道怎么做。

* * *

## 回答 #1

> 赞同：352
> 
> 时间：2013-07-22T14:51:51.047

我想我在这里有一个更简单的解决方案。`/proc`只需在路径下可访问的伪文件系统下查找名称与您要查找的 PID 对应的目录。所以如果你有一个程序正在运行，它的 ID 是 1199，`cd`进入它：

```
$ cd /proc/1199 
```

然后查找`fd`下面的目录

```
$ cd fd 
```

此`fd`目录包含您的程序正在使用的文件描述符对象（0：stdin，1：stdout，2：stderr）以及`tail -f`您需要的对象 - 在本例中为 stdout）：

```
$ tail -f 1 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-12-07T13:17:14.530

我一直在寻找完全相同的东西，发现您可以这样做：

```
strace -ewrite -p $PID 
```

这不完全是您需要的，但它非常接近。

我尝试了重定向输出，但这对我不起作用。也许是因为该进程正在写入套接字，我不知道。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-03T21:20:31.543

这里有几个选项。一种是将命令的输出重定向到文件，然后使用'tail'实时查看添加到该文件的新行。

另一种选择是在“屏幕”内启动您的程序，这是一种基于文本的终端应用程序。屏幕会话可以附加和分离，但名义上只能由同一个用户使用，所以如果你想在用户之间共享它们，那就太麻烦了。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2019-08-21T09:11:08.040

对我来说，这有效：

1.  以进程所有者身份登录（甚至`root`被拒绝权限）

    ```
    ~$ su - process_owner 
    ```

2.  如许多其他答案中所述，跟踪文件描述符。

    ```
    ~$ tail -f /proc/<process-id>/fd/1 # (0: stdin, 1: stdout, 2: stderr) 
    ```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-09-16T06:15:03.817

您可以使用`reptyr`：

```
sudo apt install reptyr
reptyr pid 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-03T22:38:00.967

> 我如何将控制台/终端视图“附加”到应用程序输出，以便我可以看到它可能在说什么？

关于这个问题，我知道即使您在启动进程之前没有启动 sceen 命令，也可以捕获输出。

虽然我从未尝试过，但我发现了一篇有趣的文章，它解释了如何使用 GDB（并且无需重新启动进程）。

[从运行过程中重定向输出](http://etbe.coker.com.au/2008/02/27/redirecting-output-from-a-running-process/ "从运行过程中重定向输出")

基本上：

1.  检查您的进程的打开文件列表，感谢**/proc/xxx/fd**
2.  **使用 GDB**附加您的流程****
***   暂停时，关闭您感兴趣的文件，调用**close()**函数（您可以在 GDB 中使用您的进程的任何函数。我怀疑您的进程中需要调试符号..）*   打开调用**create()**或 open() 函数的新文件。（看看最后的评论，你会看到人们建议使用**dup2()**来确保使用相同的句柄）*   **分离**进程并让其运行。**

 **顺便说一句，如果您在 i386 机器上运行 linux 操作系统，评论正在谈论将输出重定向到新控制台的更好工具：***'retty'***。如果是这样，请考虑使用它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-10-08T02:40:31.217

我想远程观看本地运行的 yum 升级过程，所以虽然可能有更有效的方法可以做到这一点，但我是这样做的：

```
watch cat /dev/vcsa1 
```

显然你会想要使用 vcsa2、vcsa3 等，这取决于正在使用的终端。

只要我的终端窗口与运行命令的终端具有相同的宽度，我就可以每两秒看到它们当前输出的快照。其他地方推荐的其他命令对我的情况并不特别有效，但是那个成功了。

# java - Java：跨多个服务器同步线程

> ID：715754
> 
> 赞同：5
> 
> 时间：2009-04-03T21:18:51.517
> 
> 标签：java, multithreading, synchronization, jms, distributed

我有一个问题，我需要为 Windows 上的 Java 服务跨多个不同服务器同步处理多个线程。

在这个应用程序中，我有多个消费者线程从同一个 JMS 队列中提取消息。消息以 3 或 4 组的形式出现，我需要确保每个组中的消息完全按串行方式处理。我需要某种同步机制来确保线程 1 拉出一条消息，然后线程 2 从该组中拉下一条消息，线程 2 在开始处理它的消息之前等待线程 1 完成处理。

关于线程的分布式同步机制有什么建议吗？任何类型的解决方案都是好的（JMS 解决方案、分布式缓存等）

注意：我们使用的 JMS 提供者是 ActiveMQ。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T21:23:56.777

ActiveMQ 支持[消息组](http://activemq.apache.org/message-groups.html)，从字面上看，这应该正是您所需要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-05T19:44:58.947

您可能要考虑使用[Hazelcast](http://www.hazelcast.com)分布式锁。超级精简、简单且开源。

```
java.util.concurrent.locks.Lock lock = Hazelcast.getLock ("mymonitor");
lock.lock ();
try {
// do your stuff
}finally {
   lock.unlock();
} 
```

问候，

-塔利普

[Hazelcast](http://www.hazelcast.com) - 开源分布式队列、映射、集合、列表、锁

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:27:19.497

消息头中是否有类似组 ID 的内容？如果是这样，消费者可以创建一个`Selector`来按顺序处理组。

可以通过对组标识符进行哈希处理来将组分配给特定的消费者，或者它们可以使用诸如 Paxos 或虚拟同步之类的共识协议（通过单独的队列发送消息）来主动相互协调。

# c# - 在存储过程或应用程序中处理事务的最佳位置在哪里？

> ID：715755
> 
> 赞同：8
> 
> 时间：2009-04-03T21:18:54.510
> 
> 标签：c#, sql, transactions

当我的 C#.net 应用程序更新多个表中的记录时，我使用事务，因此如果在事务期间发生任何故障，我可以回滚。

哪一个是更好的做法？

- 使用带有 BEGIN TRANSACTION/ROLLBACK/COMMIT TRANSACTION 的存储过程；- 在应用程序中使用 TransactionScope，如下所示：

```
 using (TransactionScope ts = new TransactionScope())
    {
    } 

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T22:23:24.887

这不是业务逻辑问题，而是数据完整性问题，我觉得在存储过程中可以这样做。我喜欢让事务逻辑尽可能接近操作，以缩短它们的持续时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T21:22:10.103

TransactionScope 是一种在代码中管理事务的非常好的方法。它允许您跨多个方法嵌套事务代码，并在必要时自动扩展到分布式模式。

我更喜欢使用 TransactionScope 而不是存储的 proc 事务，因为它可以让您对代码进行更多控制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:22:24.690

或者你可以在两者中都这样做。检查链接：[http ://www.4guysfromrolla.com/webtech/080305-1.shtml](http://www.4guysfromrolla.com/webtech/080305-1.shtml)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T22:32:46.407

如果您的事务要转到一个数据库，则最好在存储过程中进行事务。另一种方式可能仅由逻辑问题引起（DBA 不喜欢您，或者他正在休假）。如果您在一个事务中调用不同的事务源（SQL Server 和 Oracle） - 除了在代码中执行事务之外别无选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T23:05:25.253

我强烈建议为页面设置一个过程并在那里管理所有 sql 操作。如果页面上有多个需要执行的任务需要多个过程，则只需让一个过程管理其他过程。如果需要，您的过程始终可以返回多个记录集。

*   您的页面将执行得更快 - 没有大量数据来回传输，只需一次拉动。sql 上的所有代码都已使用执行计划进行编译。
*   您将能够更有效地处理您的错误 - 在一个地方而不是在两个地方 - 拥有两个独立的系统来决定它是否足够重要以至于失败 - 来回传递任何错误以保持数据完整性。
*   您可以最大限度地减少故障点。如果事务进展顺利，但 Web 服务器出现问题，则 sql 服务器将等待响应。
*   您将节省大量的故障排除和调试时间。
*   它将帮助您在 sql server 上模块化您的代码。您可以重用存储过程来执行类似的任务，并最终得到一个更灵活、可扩展的健壮系统。高温高压

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T12:55:52.213

**以下是我关于何时使用交易的 2 条简单规则：**

*   如果该过程有多个数据更改语句，它将包含一个事务。
*   如果应用程序调用多个存储过程来更改数据，它将包含一个事务。

# python - 协程 vs 延续 vs 生成器

> ID：715758
> 
> 赞同：155
> 
> 时间：2009-04-03T21:19:20.483
> 
> 标签：python, generator, coroutine, continuations

coroutine 和 continuation 和 generator 有什么区别？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-04-03T22:05:22.870

我将从生成器开始，因为它们是最简单的情况。正如@zvolkov 所提到的，它们是可以重复调用而不返回的函数/对象，但是在调用时将返回（产生）一个值，然后暂停它们的执行。当他们再次被调用时，他们将从上次暂停执行的地方开始并再次执行他们的操作。

生成器本质上是一个缩减（非对称）协程。协程和生成器之间的区别在于，协程可以在初始调用后接受参数，而生成器不能。

想出一个使用协程的简单示例有点困难，但这是我最好的尝试。以这个（组成的）Python 代码为例。

```
def my_coroutine_body(*args):
    while True:
        # Do some funky stuff
        *args = yield value_im_returning
        # Do some more funky stuff

my_coro = make_coroutine(my_coroutine_body)

x = 0
while True:
   # The coroutine does some funky stuff to x, and returns a new value.
   x = my_coro(x)
   print x 
```

使用协程的一个例子是词法分析器和解析器。如果没有语言中的协程或以某种方式模拟，词法分析和解析代码需要混合在一起，即使它们实际上是两个独立的关注点。但是使用协程，您可以将词法分析和解析代码分开。

（我将讨论对称协程和非对称协程之间的区别。只要说它们是等价的就足够了，你可以从一个转换到另一个，而非对称协程——最像生成器——是更容易理解。我正在概述如何在 Python 中实现非对称协程。）

延续实际上是非常简单的野兽。它们都是代表程序中另一个点的函数，如果你调用它，将导致执行自动切换到函数代表的点。您每天都在使用非常受限的版本，甚至没有意识到这一点。例如，异常可以被认为是一种由内而外的延续。我会给你一个基于 Python 的延续伪代码示例。

假设 Python 有一个名为 的函数`callcc()`，这个函数有两个参数，第一个是函数，第二个是调用它的参数列表。该函数的唯一限制是它采用的最后一个参数将是一个函数（这将是我们当前的延续）。

```
def foo(x, y, cc):
   cc(max(x, y))

biggest = callcc(foo, [23, 42])
print biggest 
```

会发生的情况是，它`callcc()`会依次调用`foo()`当前的延续 ( `cc`)，即对程序中`callcc()`被调用点的引用。当`foo()`调用当前延续时，它本质上与告诉`callcc()`返回你调用当前延续所用的值相同，当它这样做时，它将堆栈回滚到创建当前延续的位置，即当你调用`callcc()`.

所有这一切的结果将是我们假设的 Python 变体将 print `'42'`。

我希望这会有所帮助，我相信我的解释可以改进很多！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-03T21:29:25.453

协程是轮流完成工作然后暂停以将控制权交给组中的其他协程的几个程序之一。

继续是您传递给某个过程的“指向函数的指针”，当该过程完成时将执行（“继续”）。

生成器（在 .NET 中）是一种语言构造，它可以吐出一个值，“暂停”方法的执行，然后在被要求输入下一个值时从同一点继续。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-08-31T02:51:31.927

在较新版本的 Python 中，您可以使用 向生成器发送值`generator.send()`，这使得 python 生成器有效地协同程序。

The main difference between python Generator, and other generator, say greenlet, is that in python, your `yield value` can only return back to the caller. While in greenlet, `target.switch(value)` can take you to a specific target coroutine and yield a value where the `target` would continue to run.

# email - 我可以为每个子域使用不同的邮件服务器吗？

> ID：715768
> 
> 赞同：21
> 
> 时间：2009-04-03T21:21:27.407
> 
> 标签：email, dns, mx-record

基本上，一些 GoDaddy DNS 帮助文本让我摸不着头脑。Godaddy 的 DNS 服务说：“您不能将您的域名设置为一次使用多个邮件提供商。” 但它并没有谈论多个子域名，每个子域有一个邮件提供商。

我认为我的组织中需要多个邮件服务器，其中不同的子域使用不同的邮件服务器。

也就是说，我组织中的某个人因使用 Google Apps 作为邮件服务器而受到攻击。

我们已经有一个 MX 记录，它服务于一些 GoDaddy 邮件转发，例如 user1@nonprofit.org 和 user2@nonprofit.org。我们不想打扰这些。他们的主人暂时对他们很满意。

如果我们设置像 staff.nonprofit.org 这样的子域并将其用于他的 Google Apps 邮件服务器，Google Apps Fanboy 先生是可以接受的。所以他会有一个像 user3@staff.nonprofit.org 这样的电子邮件地址。

鉴于已经有一条指向 GoDaddy 邮件转发服务的优先级 0 MX 记录，我是否可以为新的 staff.nonprofit.org 子域上的电子邮件地址设置另一个指向 Google Apps 邮件服务器的优先级 0 MX 记录？即使对于不同的子域，优先级是否也是专有的？

如果它不能处于相同的优先级，我是否需要使子域 MX 记录的优先级高于域 MX 记录并且一切仍然有效？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-03T21:31:21.687

您可以在子域/主机上设置 MX 记录就好了，您不必担心它们相对于主域记录的优先级；他们不互动。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T21:25:14.260

不同子域的不同 mx 记录应该可以工作

# sql - 我需要在更新作业期间“锁定”一个 Sql 表吗？

> ID：715785
> 
> 赞同：2
> 
> 时间：2009-04-03T21:24:38.100
> 
> 标签：sql

我有一个正在运行的 Web 应用程序，我想使用另一个应用程序访问 sql db，以使用新计算更新其中一个表。我的用户会在更新期间注意到什么吗？如果他们在我更新的同时访问，我会得到一个错误，还是有自动锁定？蒂亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T21:27:00.293

如果您的 RDBMS 有任何好处，它应该会为您处理好它。

不过，您可能希望确保“自动提交”已关闭，并且仅在您完成更新时提交。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T21:28:58.433

通常，在您进行更新时这些行将被锁定，并且任何可能使用这些行的 SQL 查询都将“挂起”，直到您的更新完成，然后返回正确的数据。

对此有一些极端情况例外，但一般来说，我不会担心它，除非您正在执行一些非常花哨的长时间运行的更新，这些更新会导致数据被锁定很长一段时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T21:33:17.067

根据他们的幸运程度，他们将看到更新前或更新后的值。通常这不是问题，因此您可以完全忽略锁定问题。但是，除非他们尝试自己锁定表，否则他们不会收到错误消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T21:34:47.483

这取决于您拥有的 DBMS 以及您使用的隔离级别。[请参阅此处了解 PostgreSQL 文档的内容。](http://www.postgresql.org/docs/8.1/static/transaction-iso.html)基本上，有许多不同的方式可以处理更新。一方面，与更新同时发生的读取可能会从部分提交的更新中获得不一致的数据。在另一端，事务是完全同步的。出于效率的原因，大多数 DBMS 倾向于在两者之间做一些事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T21:55:25.873

如果您使用具有事务能力的 RDBMS，则无需进行锁定，它会为您完成。如果没有，您需要锁定行或表，具体取决于您使用哪一个。

大多数 RDBMS 系统都支持事务，所以这不应该是值得担心的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T21:28:24.050

没有自动锁定。如果你想做的事情很快，那么就不需要自动锁定，因为多重访问的可能性**真的**很低。

但是，如果您打算运行一些长时间的更新，您应该认真考虑在进行更新时将维护页面放在首页。

# asp.net - Javascript ShareThis链接在回发时消失

> ID：715787
> 
> 赞同：0
> 
> 时间：2009-04-03T21:25:12.640
> 
> 标签：asp.net, javascript, ajax

我的 Masterpage 的页脚中有一个 ShareThis ( [http://www.sharethis.com](http://www.sharethis.com) ) 链接。他们提供的代码通过 Javascript 生成链接。到目前为止，我的网站非常简单 ( [http://www.quotidianword.com](http://www.quotidianword.com) )，只是一个放置电子邮件的地方。但是当输入电子邮件时，有一个 AJAX 回发，并且链接消失了！有什么办法可以防止这种情况发生吗？如何获取重新加载的链接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T21:27:46.847

好的，所以我想我想通了...它包含在同一个 UpdatePanel 中。我从那个 UpdatePanel 中取出它，现在它工作正常。但它不应该重新加载它吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T04:07:11.000

如果没有代码示例，我不确定——但我猜你在回发后没有运行代码。

请记住，`UpdatePanel`s 仍然运行整个页面生命周期`Init`—— 、`Load`、`PreRender`等。它们仅将`UpdatePanel`. 除此之外，它就像一个完整的回发一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T19:52:35.320

不，它正在调用 javascript。您需要重新加载 javascript。看看 ScriptManager.RegisterStartupScript

# vb6 - VB6 表单高度/宽度被命令行构建忽略

> ID：715789
> 
> 赞同：1
> 
> 时间：2009-04-03T21:25:33.747
> 
> 标签：vb6, adapter, truncation

我们正在尽快退出 VB6，但与此同时，我们已经开始在构建服务器上从命令行构建我们的 VB6 应用程序。

问题：构建服务器有一个基本的视频适配器，并导致表单被截断为基本适配器的分辨率，而不是表单本身的高度和宽度。

我们发现的一种解决方法需要进入每个表单的加载事件，并在“表单属性”窗口中手动将“高度”和“宽度”属性设置为观察到的大小。

啊..

此应用程序涉及数十种表单，更多应用程序将提供更多数十种表单。我想构建一个脚本来处理这个问题。

两个问题：

1）我在代码/项目/等中的哪里可以找到“属性”窗口中显示的表单的高度和宽度？搜索 *.frm 文件并没有找到任何赢家；也不会打开 *.frx 文件并将已知的高度或宽度转换为十六进制（然后搜索）。

2）除了编辑每个表格之外，我还能做些什么吗？

提前致谢。

乔恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T09:43:06.080

FRM 格式记录在 VB6[手册](http://msdn.microsoft.com/en-us/library/aa241723(VS.60).aspx)中。正如 Angry Jim 观察到的那样，它说高度和宽度存储在 Twips 中。它没有解释 ClientHeight 和 ClientWidth 但正如 OneNerd 和 cmsjr 所说，这是表单内部的大小（没有菜单栏和边框）。如果您有任何将 StartupPosition 设置为手动的表单，则构建服务器也可能会更改 ClientLeft 和 ClientTop。

永远不要在运行时设置表单的高度和宽度。其中包括菜单栏和边框，它们在不同版本的 Windows 上或具有不同主题的厚度不同。所以你会得到错误的尺寸。改为设置 ScaleHeight 和 ScaleWidth，它们是窗体内部的尺寸。VB6 运行时根据这些计算适当的高度和宽度。

And finally, **just buy a new build server** (or a new video card). Lead all the developers to the boss waving flaming torches and pitchforks, or perhaps just calmly explain the difference between the cost of a PC and the cost of developer time.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T01:30:40.130

如果您在记事本或任何纯文本编辑器中打开 .frm 文件，则表单大小从顶部开始定义几行：

**例如：**

```
 ClientHeight    =   8445
 ClientLeft      =   60
 ClientTop       =   450
 ClientWidth     =   9960 
```

我不确定你为什么会遇到这个问题 - 看起来很奇怪 - 但如果你的构建服务器导致问题，那么我看到的唯一选择是（1）更改你的构建服务器（或者升级视频卡），或者写入您提到的每个表单的加载事件中的代码，尽管如果您在IDE中设置了位置->中心，这可能会影响表单的居中，因此如果这是您想要的结果，请验证您的表单是否仍然居中.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T21:35:20.133

基于[此](http://msdn.microsoft.com/en-us/library/aa267517(VS.60).aspx)，我会说在属性窗口中看到的高度是一个计算值，其中包括表单的 ClientHeight（在 .frm 中）+ 边框和标题栏高度。所以 ClientHeight 可能是您正在寻找的数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T02:52:00.810

高度和宽度存储在 Twips（与设备无关的测量单位）中，因此您必须除以`Screen.TwipsPerPixelX`并`Screen.TwipsPerPixelY`获得正确的值。对于大多数显示器，这将是 15。（使用 OneNerd 示例中的宽度，9960 缇是 664 像素。）

# python - 从 cgi 脚本中启动 .py python 脚本

> ID：715791
> 
> 赞同：0
> 
> 时间：2009-04-03T21:26:00.140
> 
> 标签：python, cgi, scripting

我正在尝试在运行本地 cgi 服务器时从 cgi 脚本中启动 .py 脚本。cgi 脚本只是从 Google Earth 接收一些数据并将其传递给当前正在使用 execfile('script.py') 调用的 .py 脚本，该 execfile('script.py') 位于 cgi 脚本的末尾。

脚本运行完成，但是 script.py 包含一些打印语句，我需要在进程运行时对其进行监控。.py 中的任何错误都会打印到 localhost 控制台窗口，并且打印语句似乎已被缓冲。

有没有办法在 localhost 控制台运行时将输出从 .py 发送到另一个 python 控制台窗口？

似乎 subprocess 模块应该做我需要的，但我只能将输出发送到变量或日志文件。这很好，只是我需要实时查看打印语句。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:36:57.230

你说你从 CGI 脚本启动一个 python 脚本，但你没有指定 CGI 脚本是用什么语言编写的。因为 CGI 只是一个接口，所以不清楚 CGI 脚本是用什么语言编写的。我我将假设 python，因为这是最有意义的。

最好的方法是将您的消息写入日志文件。在您的“script.py”文件中，您应该打开一个日志文件以进行附加，而不是使用打印，如下所示：

```
logfile = file("/var/log/my-app-log.txt", "a") 
```

然后，无论您有这样的打印语句：

```
print("Starting to do step 2...") 
```

将其更改为 logfile.write() 语句，如下所示：

```
logfile.write("starting to do step 2...\n") 
```

请注意，您需要单独添加换行符，因为 file.write() 不会为您添加换行符。

然后，您可以使用 tail 之类的命令查看脚本中发生的情况：

```
tail -f /var/log/my-app-log.txt 
```

这将显示附加到您的日志文件的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T21:41:12.617

使用[popen2](http://docs.python.org/library/popen2.html)或[subprocess](http://docs.python.org/library/subprocess.html)启动控制台，同时将输出流重定向到该控制台。

# sql - 查询以返回具有重复项的记录的 1 个实例

> ID：715804
> 
> 赞同：3
> 
> 时间：2009-04-03T21:29:55.170
> 
> 标签：sql, database

信息：我正在使用 Microsoft SQL。
好的，标题令人困惑，但这是我正在使用的表的示例：

```
ID    Value    Signal    Read    Firmware    Date           Time
5     123      656       444       217       3/30/2009     11:00:00 AM
5     123      421       333       217       3/30/2009     04:00:00 PM
5     123      111       666       217       3/30/2009     05:00:00 PM
9     321      231       551       216       3/30/2009     09:00:00 AM
9     321      599       887       216       3/30/2009     09:30:00 AM 
```

所以我希望查询返回：

```
ID    Value    Signal    Read    Firmware    Date           Time
5     123      111       666       217       3/30/2009     05:00:00 PM
9     321      599       887       216       3/30/2009     09:30:00 AM 
```

我试过了：

```
SELECT DISTINCT ID, Value, Signal, Read, Firmware, Date, Time FROM .... 
```

但这会返回所有结果。我也尝试过 SELECT TOP 1... 但我无法让它发挥作用。我知道这很简单，但我对如何让它只显示 1 个唯一行感到困惑。
谢谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T21:47:33.770

你试过这个吗？

```
SELECT id, value, MIN(Signal), MIN(Read), MIN(Firmware), MIN(Date), MIN(Time)
FROM
  ...
GROUP BY
  ID, Value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T21:52:31.747

记录**是**不同的，有不同`Signal`的`Read`和`Time`值。您希望 SQL 服务器如何猜测您想要哪一个？

您的示例表明您对给定的最新记录感兴趣`Id`。如果这是真的，这个查询应该适合你：

```
SELECT table.*
FROM table
JOIN (SELECT Id, Date, MIN(Time) FROM Table GROUP BY Id, Date) AS selector
ON (table.Id = selector.Id AND table.Date = selector.Date and table.Time = selector.Time) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T21:32:49.470

```
SELECT
  ID, Value, Signal, Read, Firmware, Date, Time
FROM
  ...
GROUP BY
  ID, Value 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T21:37:54.370

```
SELECT Id, Value, Signal, Read, Firmware, Date, Time FROM table_name t1 WHERE t1.Id = (SELECT DISTINCT t2.Id FROM table_name t2) 
```

假设有一个检查使得具有相同 Id 的记录也具有相同的 Value

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T21:40:18.127

使用 TOP 1 WITH TIES

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T22:03:05.777

类似的查询（使用 CROSS APPLY 和带 TOP WITH TIES 的相关子查询）：

```
SELECT

        a.CustodianAccountNum,

        a.AccountName,

        a.AccountName2,

        a.AccountName3,

        a.AccountStartDate,

        a.AccountClosedDate,

        a.TaxableFederal,

        a.TaxableState,

        qq.ValuationDate,

        qq.MarketValue,

        cg.ClientGroupGUID as ClientGUID,

        c.ClientGUID as EntityGUID,

        convert (bit, case when b.cnt > 1 then 1 else 0 end) as IsDuplicate 

  FROM (

        SELECT      

              a.CustodianAccountNum,

              MIN(a.AccountID) as AccountID,

              count(*) as cnt

        FROM Accounts a

        WHERE

              a.AccountID in (SELECT AccountID from dbo.FnGetFilteredAccountIDs(@CurrentUserID)) -- apply permisssions

              and a.DeletedDate is null

        group by a.CustodianAccountNum

  ) b

  INNER JOIN Accounts a

  ON

        a.AccountID = b.AccountID

  INNER JOIN ClientAccounts ca

  ON

        a.AccountID = ca.AccountID

        and ca.DeletedDate is null

  INNER JOIN Clients c

  ON

        ca.ClientID = c.ClientID

        and c.DeletedDate is null

  INNER JOIN ClientGroups cg

  ON

        c.ClientGroupID = cg.ClientGroupID 

        and cg.DeletedDate is null

  CROSS APPLY 

  (

        SELECT 

              SUM(MarketValue) as MarketValue, 

              MIN(ValuationDate) as ValuationDate 

        FROM

              (SELECT TOP 1 WITH TIES arv.MarketValue, arv.ValuationDate 

              FROM AccountReturnValues arv 

              where 

                    arv.AccountId = a.AccountId 

                    and a.AccountClosedDate is null

              order by ValuationDate desc

              ) q

  ) qq 
```

# math - 生成桶大小的指数分布

> ID：715808
> 
> 赞同：2
> 
> 时间：2009-04-03T21:30:53.267
> 
> 标签：math, testing, statistics

给定一系列传入的项目，我想将每个传入的项目分配给一个桶。桶可以是一个新的（以前从未使用过的，其中有无限供应），也可以是现有的存储桶。如果我查看包含一项的存储桶数、包含两个项目的存储桶数、包含三个项目的存储桶数等，我希望这些存储桶计数遵循指数分布。我希望我说得对——如果 80% 的桶有 1 个项目，那么 16% 应该有两个，3.2% 应该有三个，等等。一般来说，大小为 k 的桶的数量应该是 1/p与大小为 k-1 的桶的数量一样多，并且大小为 1 的桶的比例应该是 (1-p) 以使数学计算正确。

如果我事先知道物品的数量，那就很容易了：我会知道每种尺寸有多少桶，所以我可以根据需要将物品堆放在每种尺寸的桶中。或者，如果我只是生成桶大小，即使我事先不知道总数也会很容易：每个新桶的大小为 (1-p) 为 1，大小为 (1-p)p 2、(1-p)p^2 尺寸 3、(1-p)p^3 尺寸 4 等。

但是我正在处理*项目*，所以当我收到一个项目时，我需要选择一个存储桶：现有存储桶或新存储桶。如果我做一个新的桶，那么我会多得到一个大小为 1 的桶。但如果我选择一个现有的大小为 k 的桶，那么我会多得到一个大小为 k+1 的桶，并且**少**一个大小为 k 的桶。那么选择大小为 k 的桶的概率应该是多少（其中 k 可以为零表示制作一个新桶）？它与 p 有什么关系？

我这样做是为了生成测试数据，其中我只知道每个桶的平均项目数（事实证明是 1.5），不知道提前的项目数，并认为桶大小的指数分布对于我的情况。我可能让它变得比它需要的更复杂，但我很惊讶，因为我认为这很容易。

也许是这样，但我只是错过了一些东西。（我也不知道如何用谷歌搜索它。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T15:23:01.440

指数分布支持整个正实数；您的分布支持正整数（它是离散概率分布），称为[几何分布](http://planetmath.org/?op=getobj&from=objects&id=3456)。^(( [W](http://en.wikipedia.org/wiki/Geometric_distribution) )) [概率通常用 1-(你的 p) 的参数来写，但这是一个微不足道的细节。]

实际上，当您只知道均值时，您选择几何分布是一个不错的选择：

> 在具有给定期望值 μ 的 {1, 2, 3, ... } 上支持的所有离散概率分布中，参数 p = 1/μ 的几何分布 X 是熵最大的分布。

您的问题很有趣（如何根据桶的大小分布逐步填充桶），我不知道最佳答案，但假设有足够多的项目，以下愚蠢的算法将起作用：

```
While there are items left:
    Pick a "bucket size" k according to the desired distribution
    /* E.g., for the geometric distribution with mean 1.5, 
       you could toss a coin with bias 0.667 until you get a head,
       then you'll get k=1 for 66.7% of the time, k=2 for 22.2%, k=3 for 7.4% etc., 
       with k being 1.5 on average (in expectation) */
    Put the next k items into one (new) bucket. 
```

请注意，您不需要知道项目的数量。假设这个数字足够大，那么问题（例如分布的差异和最后的“剩菜”）将不会有太大影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T22:07:41.883

这是我的两分钱：当您读入项目时，保留桶和项目的计数器，并使用它来计算每个桶的项目数。如果项目/存储桶阈值超过 1.5，则将下一个项目放入新存储桶中。如果没有，您将下一个项目分配到随机选择的现有存储桶中。

大多数随机数生成器都力求生成统计上可能的随机数集（例如，它们避免生成模式），所以我的数学直觉认为这应该足以满足您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:26:12.400

这就是我将如何做到的。

对于进入的每个项目，从 (0,1) 上的均匀分布中抽取一个数字。这是您[的几何分布的 CDF](http://en.wikipedia.org/wiki/Geometric_distribution)，正如上面的评论者所指出的，您正在寻找什么。那么你想要的桶是 ln((1-CDF)/(1-p))。假设您目前只在存储桶 1 和 2 中放置了物品，然后您得到了一个用于存储桶 5 的物品，没问题，只需使用哈希表来跟踪您到目前为止已填充的存储桶。

# database - 数据库中的历史行管理

> ID：715811
> 
> 赞同：9
> 
> 时间：2009-04-03T21:31:04.433
> 
> 标签：database, oracle, database-design, partitioning

与许多数据库一样，我正在设计一个数据库，该数据库应记录每个表中更改的行的先前版本。

这个问题的标准解决方案是为每个数据表保留一个历史表，并且每当需要更新数据表中的行时，将当前行的副本插入到历史表中，而不是数据表中的行得到更新。

这个解决方案对我的缺点：

*   维护 2 个表而不是 1 个，（以防表结构需要更改）
*   应用程序需要知道两个表而不是一个
*   表名可能需要简短以保持表名和历史表名的约定（例如 SOME_TABLE、SOME_TABLE_HIST）

我正在考虑一个不同的解决方案，想知道它是否可以。对于每个表，我们添加列 IS_LAST

*   当一行被插入到表中时，它将以 IS_LAST=1 插入。
*   当一行被更新时，原始行的副本将被复制到同一张表中，同时 IS_LAST=0 的更改，并且原始行将根据需要进行更新（仍然保持 IS_LAST=1）。

假设在我的情况下，行平均更新 1​​0 次。还假设应用程序执行的至少 90% 的操作仅发生在最新版本的行上。

我的数据库是 Oracle 10g，因此为了保持“活动”表的精简，我们可以将表拆分为 2 个分区：IS_LAST=1 分区和 IS_LAST=0 分区。

分区是解决历史数据保存问题的好方法吗？

此解决方案是否会限制这些表的其他分区潜力？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T22:06:02.790

第一个问题应该是：您将如何处理这些数据？如果您没有明确的业务需求，请不要这样做。

我做了类似的事情，经过 3 年的运行，大约有 20% 的“有效数据”，其余的是“以前的版本”。它是 1000 万 + 4000 万条记录。在过去三年中，我们有 2（两次）请求调查更改历史记录，两次请求都很愚蠢——我们记录了记录更改的时间戳，并被要求检查人员是否加班（下午 5 点之后）。

现在，我们被超大的数据库困住了，其中包含 80% 的数据，而这些数据没有人需要。

**编辑：**

既然您要求可能的解决方案，我将描述我们所做的。这与您正在考虑的解决方案有点不同。

1.  所有表都有代理主键。
2.  所有主键都是从单个序列生成的。这很好用，因为 Oracle 可以生成和缓存数字，所以这里没有性能问题。我们使用 ORM，我们希望内存中的每个对象（以及数据库中的相应记录）都具有唯一标识符
3.  我们使用ORM，数据库表和类之间的映射信息是以属性的形式。

我们用以下列记录单个存档表中的所有更改：

*   id（代理主键）
*   时间戳
*   原表
*   原始记录id
*   用户身份
*   事务类型（插入、更新、删除）
*   将数据记录为 varchar2 字段
    *   这是字段名/值对形式的实际数据。

事情是这样工作的：

*   ORM 有插入/更新和删除命令。
*   我们为所有业务对象创建了一个基类，它覆盖了插入/更新和删除命令
    *   插入/更新/删除命令使用反射以字段名/值对的形式创建字符串。代码查找映射信息并读取字段名称、关联值和字段类型。然后我们创建类似于 JSON 的东西（我们添加了一些修改）。当创建表示对象当前状态的字符串时，将其插入存档表。
*   当新的或更新的对象被保存到数据库表时，它被保存到他的目标表中，同时我们将一条具有当前值的记录插入到存档表中。
*   当对象被删除时，我们从他的目标表中删除它，同时我们在归档表中插入一条事务类型=“DELETE”的记录

临：

*   我们没有数据库中每个表的存档表。我们也不需要担心架构更改时更新存档表。
*   完整存档与“当前数据”分开，因此存档不会对数据库造成任何性能影响。我们将它放在单独磁盘上的单独表空间中，它工作正常。
*   我们创建了 2 个用于查看存档的表单：
    *   可以根据存档表上的过滤器列出存档表的通用查看器。过滤数据用户可以在表单上输入（时间跨度，用户，...）。我们在表单字段名/值中显示每条记录，并且每次更改都用颜色编码。用户可以查看每条记录的所有版本，并且可以查看更改的人员和时间。
    *   发票查看器 - 这个很复杂，但我们创建了显示发票的表单，与原始发票输入表单非常相似，但有一些额外的按钮可以显示不同的代。创建这种形式需要付出相当大的努力。表单被使用了几次，然后被遗忘了，因为在当前的工作流程中不需要它。
*   创建存档记录的代码位于单个 C# 类中。数据库中的每个表都不需要触发器。
*   性能非常好。在高峰期，系统被大约 700-800 名用户使用。这是 ASP.Net 应用程序。ASP.Net 和 Oracle 都在具有 8Gb RAM 的双 XEON 上运行。

缺点：

*   单表存档格式比每个数据表都有一个存档表的解决方案更难阅读。
*   搜索归档表中的非 id 字段很困难——我们只能`LIKE`在字符串上使用运算符。

因此，再次*检查存档的要求*。这不是一项微不足道的任务，但收益和使用可能是微乎其微的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T21:42:52.753

我将创建两个表：一个用于 IsLast 类型的值，另一个用于历史值。然后我会设置一个触发器，每次更新 isLast 时将值插入历史表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T10:36:52.923

由于您使用的是 Oracle，您可以查看[Oracle Flashback Technology](http://www.oracle.com/technology/deploy/availability/htdocs/Flashback_Overview.htm)。它记录数据库中所有变化的变化，包括数据和结构。它还记录时间戳和用户名。

我没用过，但看起来很有能力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T14:28:08.500

如果我有 1 或 2 张历史表格要保留，我会完全按照 Tuinstoel 的建议进行操作。但是如果你有几十个表来做这件事，我会更倾向于 zendar 描述的解决方案。原因是这样的。

你如何回答这样的问题，

*   自从昨天一切都好之后发生了什么变化？

*   用户 SMITHG 是否进行了任何更改？

这些问题需要对每个表进行一次查询，无论是单独的 _hist 表还是表内的分区。无论如何，这是一个庞大的查询列表。如果你有一个看起来像这样的中央桌子，那么它就是一块馅饼。

```
table_name, Column_name, PK, Before_value, After_value, User, timestamp 
```

插入只有 after 值，

删除只有之前的值，

更新两者都有，但仅适用于更改的列。

一些变化

如果您愿意，可以为 I/U/D 包含一列您可以排除插入的列值，只记录 PK 和 I，因为正确的值仍在表中。

由于这是 Oracle，您可以在 table_name 上进行分区，因此本质上您实际上每个真实表都有一个 hist“表”。

您可以轻松回答上述问题，我认为这些问题很简单，是最常被问到的问题。它可以处理您可以通过分区或 _hist 表回答的所有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-20T07:17:48.413

与其他人一样，我使用带有自定义保存和删除方法的基础对象的 ORM（Propel）。这些方法覆盖了 ORM 附带的标准保存和删除。他们检查哪些列已更改，并在更改表中为每个更改的列创建 1 行。

表的架构`change`：change_pk、user_fk、user_name、session_id、ip_address、method、table_name、row_fk、field_name、field_value、most_recent、date_time

示例：1、4232、'Gnarls Barkley'、'f2ff3f8822ff23'、'234.432.324.694'、'UPDATE'、'User'、4232、'first_name'、'Gnarles'、'Y'、'2009-08-20 10 :10:10';

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T03:12:00.607

这一切都取决于你有什么：

*   您运行的是标准版还是企业版？分区仅作为 Enterprise Edition 之上的一个选项包含在内。更多信息在[这里](http://www.oracle.com/database/product_editions.html)。
*   如果您正在寻找一个无需维护自己的代码的简单解决方案，您可能会考虑使用[Workspace Manager来执行此操作。](http://otn.oracle.com/products/workspace_mgr/content.html)但是，我发现了一些限制（例如，Oracle Text 索引维护似乎很困难，如果不是不可能的话，尽管我只在 10gR2 上看过它）。
*   否则，我会选择 zvolkov 的解决方案（带有触发器写入历史表的实时表）或 Mark Brady 的解决方案（更改日志）。我使用了这两种模式，每种模式都有其优点和缺点。
*   @zendar：闪回查询仅适用于您撤消的时间。这不是一个长期的解决方案，只是一个最多回顾几个小时的解决方案（取决于您指定的撤消保留时间）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T09:56:28.120

我会使用`IS_LAST=1`分区和`IS_LAST=0`分区系统。因为它是分区的，所以它会很快（分区修剪）并且您永远不必查询普通表和历史表的联合。

我会使用 IS_LAST='Y'/'N' 而不是 1/0。1 和 0 没有意义。

有一个特殊技巧可以帮助保证`IS_LAST='Y'`每个实体最多有一行：您可以创建一个基于唯一函数的索引，该索引具有返回 null when`IS_LAST='N'`并返回 id when的函数`IS_LAST='Y'`。这里解释：[http ://www.akadia.com/services/ora_function_based_index_1.html](http://www.akadia.com/services/ora_function_based_index_1.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T21:43:54.403

我想到的主要限制是您的表的很大一部分将是历史数据，这意味着索引问题并可能在您的 CRUD 查询中引入额外的复杂性。

是否有某些特殊原因您不想使用似乎通常解决这种情况的方法？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T21:51:12.920

你将如何定义主键？由于将历史记录行保留在同一个表中，因此会有许多行具有相同的主键。

此外，当单个“真实”行再次更改时，您似乎没有办法知道历史记录行的顺序。

（我参与的一个项目，我们使用 codesmith 生成了所有历史表和触发器，这非常有效。）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-06T04:21:23.480

如果您执行了将跟踪数据移动到历史表中的过程，那么基于时间跟踪它是否可以帮助您在每天以及在业务结束时或在午夜根据最低交易量时间实现您正在寻找的效果这会有帮助吗 ？？这样，您的所有更新都将被插入，并且也不需要锁定。问候，安迪

# ruby - Ruby：将转义字符串写入 YAML

> ID：715818
> 
> 赞同：9
> 
> 时间：2009-04-03T21:34:25.597
> 
> 标签：ruby, string, escaping, yaml

以下...

```
require 'yaml'
test = "I'm a b&d string"
File.open('test.yaml', 'w') do |out|
  out.write(test.to_yaml)
end 
```

...输出...

```
--- this is a b&d string 
```

我怎样才能让它输出

```
--- 'this is a b&d string' 
```

？？？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T21:52:23.057

如果您想在 YAML 中存储转义字符串，`#inspect`请在将其转换为 YAML 之前使用它进行转义：

```
irb> require 'yaml'
=> true
irb> str = %{This string's a little complicated, but it "does the job" (man, I hate scare quotes)}
=> "This string's a little complicated, but it \"does the job\" (man, I hate scare quotes)"
irb> puts str
This string's a little complicated, but it "does the job" (man, I hate scare quotes)
=> nil
irb> puts str.inspect
"This string's a little complicated, but it \"does the job\" (man, I hate scare quotes)"
=> nil
irb> puts str.to_yaml
--- This string's a little complicated, but it "does the job" (man, I hate scare quotes)
=> nil
irb> puts str.inspect.to_yaml
--- "\"This string's a little complicated, but it \\\"does the job\\\" (man, I hate scare quotes)\""
=> nil 
```

除非必须，否则 YAML 不会引用字符串。如果字符串包含不带引号存储它会丢失的内容，它会引用字符串 - 例如周围的引号字符或尾随或前导空格：

```
irb> puts (str + " ").to_yaml
--- "This string's a little complicated, but it \"does the job\" (man, I hate scare quotes) "
=> nil
irb> puts %{"#{str}"}.to_yaml
--- "\"This string's a little complicated, but it \"does the job\" (man, I hate scare quotes)\""
=> nil
irb> puts (" " + str).to_yaml
--- " This string's a little complicated, but it \"does the job\" (man, I hate scare quotes)"
=> nil 
```

但是，作为 YAML 使用者，字符串是否被引用对您来说并不重要。您永远不应该自己解析 YAML 文本 - 将其留给库。如果您*需要*在 YAML 文件中引用字符串，那对我来说很糟糕。

无论您的字符串中是否包含 '&'，YAML 都会保留该字符串：

```
irb> test = "I'm a b&d string"
=> "I'm a b&d string"
irb> YAML::load(YAML::dump(test))
=> "I'm a b&d string"
irb> YAML::load(YAML::dump(test)) == test
=> true 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-12-18T17:21:26.963

根据[YAML 1.2 规范](http://www.yaml.org/spec/1.2/spec.html)，JSON 文档是有效的 YAML 文档。

> 此修订的主要目标是使 YAML 作为官方子集与 JSON 兼容。

因此，有效的 JSON 字符串就是有效的 YAML 字符串。

```
require 'json'
'my string'.to_json  # => produces a valid YAML string 
```

这对于富含 ERB 语法的 YAML 文件非常有用，`string.to_yaml`在许多情况下这些文件将不起作用。

例子：

```
# openvpn.yml.erb
openvpn:
  cert: <%= ENV.fetch('OPENVPN_CERT').to_json %>
  key: <%= ENV.fetch('OPENVPN_KEY').to_json %> 
```

# sql - TSQL：使用With语句更新值？

> ID：715819
> 
> 赞同：3
> 
> 时间：2009-04-03T21:34:32.553
> 
> 标签：sql, sql-server-2005, tsql

我有一个表，其中有一列我想更新它的值。以下是 TSQL 代码示例：

```
WITH Pieces(id, newdesc) AS
(
SELECT itemid, REPLACE(REPLACE(description, 'DESC_A', 'DESC_B'), 'NEW_1', 'NEW_2')
  FROM myTable
  WHERE description like '%DESC_A%DESC_B%'
)
-- SELECT * FROM Pieces
UPDATE myTable SET description = newdesc // not working, how? 
```

此更新不起作用。通过注释掉 SELECT，我可以看到结果是我需要的。如何以批量方式对一组行进行此更改？不确定 WITH 语句是否可行？

以下是一些示例数据：

```
....
xxxDESC_AyyyDESC_Bwwww
aaaDESC_AxxDESC_Beee
.... 
```

更新的将是：

```
....
xxxNEW_1yyyNEW_2wwww
aaaNEW_1xxNEW_2eee
.... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T21:37:12.127

也许

```
UPDATE myTable 
SET description = newdesc
FROM Pieces
WHERE Pieces.id = myTable.itemid 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T23:12:54.190

顺便说一句，如果您真的想使用 CTE 进行更新（尽管我更喜欢更直接的更新），您可以。但是，您必须在 CTE 中包含更新的列，并且您要更新的表是 CTE 名称，而不是原始表名。像这样：

```
;WITH Pieces(id, description, newdesc) 
AS(
SELECT itemid, description, REPLACE(REPLACE(description, 'DESC_A', 'DESC_B'), 'NEW_1', 'NEW_2')  
FROM myTable  WHERE description like '%DESC_A%DESC_B%'
)
UPDATE Pieces SET description = newdesc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T22:02:01.740

这应该做你想要的。你不需要在这里。

```
UPDATE myTable SET description=REPLACE(REPLACE(description, 'DESC_A', 'NEW_1'), 'DESC_B', 'NEW_2')
WHERE description like '%DESC_A%' OR description like '%DESC_B%' 
```

如果这两个从不在同一个字段中，您可以使用两个单独的语句来更好地管理大表的资源。

```
UPDATE myTable SET description=REPLACE(description, 'DESC_A', 'NEW_1')
WHERE description like '%DESC_A%'
go    
UPDATE myTable SET description=REPLACE(description, 'DESC_B', 'NEW_2')
WHERE description like '%DESC_B%' 
```

高温高压

# iphone - UINavigationController 改变视图问题

> ID：715822
> 
> 赞同：0
> 
> 时间：2009-04-03T21:35:43.003
> 
> 标签：iphone

我在更改显示视图时遇到问题。

我的应用程序包含 2 个视图控制器。一个音频播放器和一个关于。音频视图控制器永远不会被释放，第二个在音频视图控制器推送时被释放。

我的应用程序还有一个 AppDelegate 对象，它由所有 UIViewControllers 共享。AppDelegate 类包含负责显示正确视图的 UINavigationController 实例。

因此，为了推动 about vire，我使用以下代码：

```
 [appDelegate.navigationController pushViewController:initialLoadingViewController animated:NO]; 
```

它运行良好，除了我第二次收到错误说同一个视图控制器已经存在。

我还尝试了 popToViewController ：出现了正确的视图，但所有按钮似乎都被禁用了，然后我的应用程序崩溃了。

所以我的问题是：更改当前 viewController 的最佳方法是什么？

非常感谢你的帮助。

蒂埃里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T21:59:16.223

很难说没有看到更多的代码，但听起来你正试图弹出一个你已经发布的视图控制器。当你将另一个视图控制器推入堆栈时，不要释放任何东西，看看是否能修复崩溃......

顺便说一句，appDelegate.navigationController 看起来很可疑 - 尝试使用 self.navigationController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T22:30:03.577

导航控制器维护着一堆视图控制器。我认为音频视图应该是第一个被看到的。这是根视图控制器。当用户请求它（或其他一些事件）时，您将 about 视图控制器推送到导航控制器视图堆栈（`pushViewController:animated:`）上。

要返回音频视图，只需使用 .pop 弹出 about 视图控制器`popViewControllerAnimated:`。之后，可以释放 about 视图控制器。如果您再次需要它，您需要再次分配它（即从 .nib 文件重新加载它）。

[苹果对视图控制器的介绍](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html "苹果对视图控制器的介绍")

# c++ - 打印字符串的位表示

> ID：715823
> 
> 赞同：0
> 
> 时间：2009-04-03T21:36:05.670
> 
> 标签：c++, printing, bit

如何打印字符串的位表示

```
std::string = "\x80";

void print (std::string &s) {

    //How to implement this
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T22:04:22.763

我会投票给`bitset`：

```
void pbits(std::string const& s) { 
    for(std::size_t i=0; i<s.size(); i++) 
        std::cout << std::bitset<CHAR_BIT>(s[i]) << " "; 
} 

int main() {
    pbits("\x80\x70"); 
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T21:47:47.607

小端还是大端？

```
for (int i = 0; i < s.length(); i++)
    for (char c = 1; c; c <<= 1) // little bits first
        std::cout << (s[i] & c ? "1" : "0");
for (int i = 0; i < s.length(); i++)
    for (unsigned char c = 0x80; c; c >>= 1) // big bits first
        std::cout << (s[i] & c ? "1" : "0"); 
```

`char`因为我听到一些关于在其他答案的评论中假设 a 是 8 位字节的可移植性的抱怨......

```
for (int i = 0; i < s.length(); i++)
    for (unsigned char c = ~((unsigned char)~0 >> 1); c; c >>= 1)
        std::cout << (s[i] & c ? "1" : "0"); 
```

这是从一个非常`C`-ish 的角度编写的……如果您已经在使用带有 STL 的 C++，那么您不妨一直使用 STL 位集功能，而不是使用字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T21:47:23.913

尝试：

```
#include <iostream>

using namespace std;

void print(string &s) {
  string::iterator it; 
  int b;

  for (it = s.begin(); it != s.end(); it++) {
    for (b = 128; b; b >>= 1) {
      cout << (*it & b ? 1 : 0); 
    }   
  }
}

int main() {
  string s = "\x80\x02";
  print(s);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T21:51:47.740

扩展 Stephan202 的答案：

```
#include <algorithm>
#include <iostream>
#include <climits>

struct print_bits {
    void operator()(char ch) {
        for (unsigned b = 1 << (CHAR_BIT - 1); b != 0; b >>= 1) {
            std::cout << (ch & b ? 1 : 0); 
        }
    }
};

void print(const std::string &s) {
    std::for_each(s.begin(), s.end(), print_bits());
}

int main() {
    print("\x80\x02");
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T22:49:16.930

接下来是最简单的解决方案：

```
const std::string source("test");
std::copy( 
    source.begin(), 
    source.end(), 
    std::ostream_iterator< 
        std::bitset< sizeof( char ) * 8 > >( std::cout, ", " ) ); 
```

*   一些 stl 实现允许将 std::setbase() 操纵器用于基数 2。
*   如果想要比现有更灵活的解决方案，您可以编写自己的操纵器。

**编辑：**
哎呀。有人已经发布了类似的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T21:51:24.307

很抱歉，我将此标记为重复。无论如何，要做到这一点：

```
void printbits(std::string const& s) {
   for_each(s.begin(), s.end(), print_byte());
}

struct print_byte {
     void operator()(char b) {
        unsigned char c = 0, byte = (unsigned char)b;
        for (; byte; byte >>= 1, c <<= 1) c |= (byte & 1);
        for (; c; c >>= 1) cout << (int)(c&1);
    }
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T04:24:11.697

如果你想手动完成，你总是可以使用查找表。静态表中的 256 个值几乎不是很多开销：

```
static char* bitValues[] = 
{
"00000000",
"00000001",
"00000010",
"00000011",
"00000100",
....
"11111111"
}; 
```

然后打印是一个简单的问题：

```
for (string::const_iterator i = s.begin(); i != s.end(); ++i)
{
    cout << bitValues[*i];
} 
```

# database - 在数据库中翻译文本的最佳方法是什么

> ID：715830
> 
> 赞同：2
> 
> 时间：2009-04-03T21:39:24.680
> 
> 标签：database, localization

我们这里有个问题。

我们需要将网站翻译成多种语言。我们已经使用 gettext 来翻译静态内容。但是我们必须将一些文本内容翻译成多种语言。

ui不是问题。

我们找到了两种翻译文本的方法。1\. 在我们的文本输入中使用 JSON 为什么这个解决方案不好。每个文本输入都需要更大，因为我们无法猜测属性的实际大小。

2.  使用保留对原始模型的引用并翻译每个字段的翻译表。它仍然需要大字段，因为我们无法通过记录定义字段大小。

3.  最后，我提出的最佳解决方案是创建一个翻译表。该表将保留其他表的外键。对于每次翻译，我们都会复制需要翻译的记录。在翻译表中，有 4 个字段，model_name(primary)、reference_id(primary)、translated_id(primary)、locale(primary)。该解决方案使同一模型无法以同一语言进行多次翻译。

4.  最后但并非最不重要的一点是，我们可以使用某人提议的东西……数据库 gettext。我们有一个包含字符串且仅包含字符串（键、文本、语言环境）的表，因此我们可以搜索模型，一个与模型中使用的字符串相同的字符串，然后使用我们找到的字符串。

我的观点是所有这些解决方案都是 hack，4 解决方案可能是看起来更好的解决方案。

由于我没有找到任何好的文档，我真的很想让这个问题大放异彩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T21:49:27.433

以下是我们处理多种语言的方法（我们也让一些专家研究了这个解决方案！）。

*   我们在数据库中有一个文本表（textid、key、nl、uk、de、fr）
*   我们有文本表的外键（例如来自 productnameid）
*   需要在 html 页面中翻译的静态文本用哈希包围：##name##
*   就在 html 内容从服务器发送到客户端之前，解析 htmlstream 以在哈希之间转换内容。
*   翻译的文本存储在缓存中，这使得该解决方案灵活且仍然快速

它对我们有用，我们构建的网站每小时浏览量超过 10 万次。

# version-control - bitrot 有任何可接受的尺寸吗？

> ID：715840
> 
> 赞同：7
> 
> 时间：2009-04-03T21:42:08.277
> 
> 标签：version-control, metrics

每个现代源代码控制系统都可以切分程序的历史。有许多工具可以静态和动态地分析代码。什么样的数学公式可以让我将文件中的活动量与该软件的部署数量相结合？我们发现即使一个程序完成了所有的单元测试，它也需要比我们在升级时预期的更多的工作。这种类型的测量应该是可能的，但是坐下来思考它的单位让我难住了。

**更新：**如果某些东西被发送到测试机器，我可以看到它的标记不那么烂。如果某些东西被发送到所有测试盒，我可以看到它得到一个新的标记。如果有东西投入生产，我可以点头并降低它的[bitrot](http://en.wikipedia.org/wiki/Bit_rot)分数。如果它的文件中有很多活动并且它永远不会被发送到任何地方，我就会把它搞砸。不要专注于代码假设我需要的任何数据都在手边。

什么样的提交分析（提交评论（如下所述）或提交之间的时间）是适用的公平数据？

**更新：** 我认为维度分析可能只是基于年龄。相对来说就困难一些了。旧代码很烂。每行代码的平均年龄仍然只是时间的度量。较大的源模块是否比更小、更复杂的源模块腐烂得更快？

**更新**代码覆盖率以行为单位。根据定义，经常执行的代码必须比从未执行的代码更糟糕。要准确测量 bitrot，您需要覆盖分析来充当阻尼器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T22:45:05.943

非常有趣的思路！

首先，什么**是**bitrot？维基百科上的[Software Rot](http://en.wikipedia.org/wiki/Software_rot)文章收集了几点：

*   环境变化：运行时的变化
*   未使用的代码：使用模式的变化
*   很少更新的代码：通过维护更改
*   重构：一种阻止比特腐烂的方法

根据[摩尔定律](http://en.wikipedia.org/wiki/Moore%27s_law)，`delta(CPU)/delta(t)`每 18 到 24 个月是一个常数因子 2。由于环境包含的不仅仅是 CPU，我认为这只是环境实际变化的一个非常弱的下限。*单位：OPS/$/s，每秒每美元的操作数随时间的变化*

`delta(users)/delta(t)`很难量化，但从新闻中“知识时代”一词的出现频率来看，我想说用户的期望也呈指数级增长。通过观察`$/flops`基础经济的发展告诉我们，供给增长快于需求，摩尔定律成为用户变化的上限。我将使用[功能点](http://en.wikipedia.org/wiki/Function_points)（“信息系统向用户提供的业务功能量”）作为需求量度。*单位：FP/s，所需功能点随时间的变化*

`delta(maintenance)/delta(t)`完全取决于组织，通常在发布前、快速修复和集成重大更改时非常高。随着时间的推移，对各种度量（如[SLOC](http://en.wikipedia.org/wiki/Source_lines_of_code)、[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)或已实现的功能点）的更改可以用作此处的替身。如果可能的话，另一种可能性是票务系统中的错误流失。随着时间的推移，我将继续使用已实现的功能点。*单位 = FP/s，实现的功能点随时间的变化*

`delta(refactoring)/delta(t)`可以衡量为**不**实施新功能所花费的时间。*单位 = 1，随着时间的推移重构所花费的时间*

所以bitrot会是

```
 d(env)     d(users)     d(maint)        d(t)
bitrot(t) = -------- * ---------- * ---------- * ----------------
              d(t)        d(t)        d(t)        d(refactoring)

             d(env) * d(users) * d(maint)
          = ------------------------------
                d(t)² * d(refactoring) 
```

与一个组合单位`OPS/$/s * FP/s * FP/s = (OPS*FP²) / ($*s³)`。

这当然只是维基百科文章已经说过的非常强制的伪数学符号：bitrot 源于环境的变化、用户需求的变化和代码的变化，而通过花时间重构来缓解它。每个组织都必须自己决定如何衡量这些变化，我只给出非常笼统的界限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T22:43:42.327

我不同意 Charlie 的观点：对源代码的轻微重构会导致非常大的[汉明距离](http://en.wikipedia.org/wiki/Hamming_distance)，并且不能很好地衡量代码在逻辑上被修改的程度。

我会考虑查看提交评论的长度。对于给定的程序员，相对较长的提交注释通常表明他们对代码进行了重大更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T23:56:19.093

最简单的答案怎么样？

```
foreach (file in source control){
  file.RotLevel = (Time.Now - file.LastTestedOrDeployed)
} 
```

如果一个文件很长时间没有被部署（生产或测试机器），它可能与“现实”不同步。环境可能已经改变，即使文件没有改变，它也可能不再起作用。所以在我看来，这是一个简单而准确的公式。为什么让它比这更复杂？涉及的变化数量似乎只会增加不确定性。如果一个文件最近被修改过，这是否意味着它已经更新以反映环境的变化（这使得它“不那么烂”），或者添加了新功能（增加了出错的风险，因此使它成为“更烂”）？对文件的修改可能意味着任何事情。

我能想到的唯一明确的因素是“自从我们上次验证文件*有效*以来已经多久了？”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T17:18:47.473

我想起了[基于证据的调度](http://www.joelonsoftware.com/items/2007/10/26.html)。提出一组合理的指标来指示比特腐烂（它的实际价值和特定变化减少了多少）。然后根据以后花费的时间确定它们的准确性。为此提出数字和规则可能很复杂。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T20:40:25.180

显而易见的答案是否定的。BItrot 没有任何可接受的尺寸。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T21:46:11.810

单元测试数量与代码总行数成反比？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T21:50:26.930

考虑两种可能的措施：编辑差异，如汉明或瓦格纳距离；和信息论熵。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T17:03:31.360

如果您真的有兴趣深入研究，可以进行一些研究。不久前，我正在研究一篇文章中的概念，该文章检查了[组织结构对软件质量](http://research.microsoft.com/apps/pubs/default.aspx?id=70535)的影响。我最终将这些想法归档在我的脑后，但你可能会发现它很有启发性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T11:28:20.090

由于我们不关心有效的代码，我会查看对文件所做的更改数量（不是更改有多大，只是更改文件的频率）以及这些更改修复了多少错误加上针对文件记录的打开错误的数量。结果应该是一个文件越烂越大的数字。

经常更改（配置等）而不修复大文件的文件将不会显示，因为等式的错误部分会很低。具有大量未解决的错误的文件将显示，更改通常会导致新错误的文件也会显示。更改*错误修复数量应该会随着时间的推移而逐渐消失（因为我们不关心旧热点）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-13T17:56:22.080

我对代码覆盖率和单元测试的唯一问题是单元测试只测试它们最初设计用于测试的内容，并且根据定义，它们是代码并且容易出现困扰常规代码的相同功能性软件腐烂。（它们只对所写的内容有好处，过了一段时间，这还不够）

但是高质量的单元测试显然会提供一些保护。

所以这些是我软件腐烂的重要因素：

1.  外部数据接口点数 (extDataIntfPts)
    *   数据质量/错误处理，单元测试（codeQuality）
    *   对 OS/VM 等底层实现的依赖。(osDep)
    *   插件等外部实现接口点的数量。(extIntfPts)
    *   代码的复杂性/简单的代码量（linesOfCode）

当系统在生产中运行时，随着它收集的数据集的增长，它会接触到更多种类的数据输入。根据定义，这将代码库暴露给更多的边缘情况和序列。

这可以通过数据处理、错误处理和单元测试的质量来缓解。

还有系统运行的底层环境的移动目标。缓和这种情况的一种方法是将应用程序放在 VM 中。

如果系统实现了插件，我可以看到随着更多插件的开发，代码库面临更大的失败机会。

复杂的代码！= 优雅的代码。如果它很优雅，它可能很简单。我在这里简单点说，代码越多，它经过良好测试的可能性就越小，但我想它可以被扭转。

所以，这是我的等式：

```
bitrot=((linesofcode/codeQuality)*(extDataInfPts+(osDep/change)+extIntfPts)*numberOfSecondsDeployed) 
```

判断 codeQuality 可能会涉及单元测试中代码覆盖率的度量。您可以针对它运行静态分析程序以确定潜在的错误，这也可能会有所帮助。我的意思是，在某些时候，真的很难得分，因为多线程代码的权重应该比 POJO 重得多。是的，应该考虑重构，但前提是有软件腐烂的证据。

归根结底，这是一门伪科学。这是我对伪科学的贡献。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-20T04:22:04.207

真正的比特腐烂（不是软件腐烂）具有物理存储量 * 时间的维度。

Bitrot 是由存储介质中的杂质放射性衰变引起的。

# email - HTML 电子邮件是什么样的？

> ID：715841
> 
> 赞同：7
> 
> 时间：2009-04-03T21:42:16.827
> 
> 标签：email, coding-style, web-standards, html-email

我正在尝试自动构建 html 电子邮件，并试图弄清楚电子邮件中是否有标准以及哪些属性有效，哪些必须存在。我需要一个吗？如果没有，是否必须有一个身体？我需要指定我使用的 Doctype 吗？

我在他们的示例中使用 Zend 框架，除了“样式”代码[http://framework.zend.com/manual/de/zend.mail.html-mails.html的内容之外，他们没有设置任何内容](http://framework.zend.com/manual/de/zend.mail.html-mails.html)

只是为了让你知道我为什么需要 HTML。这看起来很愚蠢，但我们公司正在编写支持软件，并且一个关键的“错误”或功能要求所有的 beta 测试人员都是基本的 HTML，因此他们可以通过使重要的单词变胖、斜体、下划线等来突出显示重要的单词。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T21:55:18.790

为 HTML 电子邮件编码我一直觉得是个废话。与浏览器不同，很少有邮件客户端遵循 W3C 的 HTML 标记标准。[MailChimp](http://www.mailchimp.com/)是一项非常贴心的服务，可让您在 30 个奇怪的电子邮件客户端（包括基于 Web 的客户端）中预览您的 HTML 电子邮件。

他们还提供免费的[指南](http://kb.mailchimp.com/article/how-to-code-html-emails)，其中包含一些有价值的注意事项。

简而言之，内联 CSS 将是您最好的选择（尤其是对于会去除某些 CSS 的 Web 客户端）。在这种情况下，表格的样式更可靠（虽然，作为一个标准的战士，我不敢这么说）。

至于 html 和 body 标签 - 我将它们发送到我的电子邮件中。你的指导校长应该是 KISS（保持简单，愚蠢！）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T21:49:42.033

用于电子邮件的 HTML 本质上与用于 Web 的 HTML 相同。不同之处在于您的电子邮件被视为处于不受信任的受限区域中，这意味着您不能使用 javascript 或任何其他脚本技术。

您可以在邮件中嵌入附件（如图像、样式表等）或从外部来源引用它们。事实是，如果您从外部来源引用它们，大多数电子邮件阅读器不会在未经用户批准的情况下下载它们。这意味着通常最好将 CSS 放在标题中的样式标签和内联附件等图像之间。

在 ThunderBird 或 Outlook 中阅读邮件时，显然存在差异。一种使用FireFox的渲染引擎，一种使用IE的引擎。这与为 Web 制作页面相同。

如果您考虑到这些要点，您应该能够毫无问题地制作漂亮的电子邮件。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T21:52:57.580

不要忘记包含文本版本。这可以帮助那些不想要 HTML 电子邮件的人。

说到不想要 HTML 电子邮件：HTML 通常用于垃圾邮件，因此与纯文本版本相比，过滤的电子邮件可能更多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T21:48:47.543

您正在寻找[MIME-type encoding](http://en.wikipedia.org/wiki/MIME)。它是包装 HTML（除其他外）的标准，因此邮件程序可以传输它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T23:08:26.243

大多数网络客户端（如 gmail）根本不会抓取外部样式表，可能是因为它可能会带来安全风险。

对于任何关键电子邮件（例如注册后的电子邮件激活），我们都将纯文本电子邮件标准化。对于营销电子邮件，我们主要使用内联样式、表格以及 90 年代网络上流行的任何内容。

电子邮件 html 没有取得与网络电子邮件相同的进展，请尽量坚持绝对基础。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-25T19:16:39.303

编写适用于所有电子邮件客户端的 HTML 电子邮件几乎是不可能的。期望使用许多解决方法来支持所有这些。如果您想查看哪些电子邮件客户端最支持 Web 标准，请访问[emailstandards.org。](http://www.email-standards.org/)他们有一个电子邮件客户端列表以及他们提供的 HTML 和 CSS 支持。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T21:52:26.567

我同意 Jeroen 的观点，即在文件本身中设置 HTML 电子邮件的样式，而不是引用外部 .css 文件。我过去遇到过问题。

# emacs - 如何使用 Emacs Tramp 双跳 ssh？

> ID：715855
> 
> 赞同：31
> 
> 时间：2009-04-03T21:49:00.210
> 
> 标签：emacs, ssh, tramp

我的校园只允许通过网关服务器进行 ssh 访问。因此，要访问我正在编码的集群，我必须 ssh 到网关，然后 ssh 到我正在使用的机器。连接有时非常慢，并且令人沮丧。

我很想使用类似 tramp 的东西，我知道它会在我的本地机器上打开缓冲区，并且只有在我保存到磁盘时才通过网络交谈。我对 tramp 一点也不熟悉，而且很难让它发挥作用，尤其是通过双跳。文档说这是通过在tramp中定义代理来完成的，但我无法理解语法。

有谁知道如何使用 emacs 通过双跳进行编码，或者有另一种解决方法来通过两个 ssh 跳来编辑代码？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-05-07T01:55:44.753

至少从 Emacs 24 开始，他们有一个新版本的 multi 你可以像这样打开路径：

```
 /ssh:bird@bastion|ssh:you@remotehost:/path 
```

我可以确认这适用于我的 Emacs 24.3.1 版本。文档在[此处](http://www.gnu.org/software/tramp/#Ad_002dhoc-multi_002dhops)对其进行了描述。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-20T15:19:22.600

如果您有 Emacs 24.3 或更高版本，请参阅[Joe 的回答](https://stackoverflow.com/a/16410046/113848)以获取下面描述的配置的替代方案。如果您将多次使用此双跳，则可能值得`tramp-default-proxies-alist`如下所述进行修改，或设置`tramp-save-ad-hoc-proxies`为`t`.

* * *

如果您有 Emacs 23.1 或更高版本，则`multi`不再支持该方法。您可以通过配置“代理”来获得相同的结果。

在您的`.emacs`配置文件中添加以下内容：

```
(add-to-list 'tramp-default-proxies-alist
                 '("HOSTB" nil "/ssh:USERA@HOSTA:")) 
```

其中 HOSTB 是 HOSTA 后面的目标主机。

然后键入`/ssh:USERB@HOSTB:`，emacs 将提示输入 HOSTA 密码，然后是 HOSTB 密码。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-03T21:54:24.363

您应该使用 ssh 进行双跳。在您的 .ssh/config 中：

```
Host <host that must be proxied too>
ProxyCommand ssh -qxT <gateway host> nc %h %p 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-13T00:00:24.083

在早期的 Emacs 版本中，Tramp 有一个`multi`方法。在 GNU Emacs 22 及更低版本上，您可以像这样使用它：

```
/multi:ssh:user1@host1:ssh:user2@host2:/foo/bar/baz 
```

打开。`/foo/bar/baz`_ `host2`在 XEmacs 上也可以进行同样的操作，但语法有所不同。您也可以使用不同的访问方法。

# open-source - E-texteditor的“开放公司”和开源模式真的开放了吗？

> ID：715880
> 
> 赞同：2
> 
> 时间：2009-04-03T21:55:23.940
> 
> 标签：open-source

E-Texteditor 最近[宣布](http://e-texteditor.com/blog/2009/opencompany)使用他们的开放公司模式进行开源。但是通读后我不确定这个模型是否真的是开放的。

我理解的方式是他们开放源代码和贡献者，这取决于贡献者获得徽章的数量（如在 stackoverflow 中），并从公司的收入流中获得相应的补偿。以下是步骤：

> 第一步：释放源
> 
> 源将可用，以便用户可以根据自己的需要研究和修改应用程序。如果他们想回馈他们的更改，他们可以提交以供审核。为了阻止盗版，一个很小但必不可少的核心（也包含许可代码）将被保密（至少在用户达到一定等级之前）。随后将逐步开放公司其他部门（网站、文档、错误跟踪等）。
> 
> 第二步：建立信任指标
> 
> 将建立基本的基础设施，以便参与者可以开始相互评分。算法和代码将作为开源发布，以便他们可以研究和讨论（并被其他人使用）。在我们达到一个公平的平衡之前，它可能需要相当长的时间和调整。
> 
> 第三步：补偿参与者
> 
> 公司的所有收入（减去运营费用）将通过信任指标传递并分配给参与者。

该公司仍然保留一些隐私以保留控制权，但这并不能使其真正开放。这与雇用开发人员并用股票期权和基于绩效的奖金来补偿他们有什么不同？

编辑：大卫布朗指出了[开发者的回应](http://e-texteditor.com/blog/2009/releasing-the-source)

> 虽然添加额外条款意味着许可证不能再被称为开源许可证，但它是开放公司的理想选择。这本质上是一个相互尊重的问题。如果我完全尊重你的所有权，你也会尊重我谋生的权利。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T06:09:40.147

如果“基本核心”阻止我们分叉项目或创建 mac 端口，它就不是真正的开源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:02:34.327

> 这与雇用开发人员并用股票期权和基于绩效的奖金来补偿他们有什么不同？

我想说不同之处在于**任何人都**可以成为开发人员。

> 该公司仍然保留一些隐私以保留控制权，但这并不能使其真正开放。

谷歌浏览器也是如此。它的实际开源部分是一个名为 Chromium 的项目。Google 对 Chromium 项目做出贡献，将其与 Chrome 的专有部分集成，然后向公众发布。

作为一个开源项目，它对我来说看起来非常好。这不是传统的做事方式。

**编辑：**看来 E 开发人员已经[回答了您的问题](http://e-texteditor.com/blog/2009/releasing-the-source)：

> 虽然添加额外条款意味着许可证不能再被称为开源许可证，但它是开放公司的理想选择。这本质上是一个相互尊重的问题。如果我完全尊重你的所有权，你也会尊重我谋生的权利。

# javascript - jQuery Ajax 在 IE 中调用很慢，但在 Firefox 中是即时的

> ID：715882
> 
> 赞同：4
> 
> 时间：2009-04-03T21:55:59.787
> 
> 标签：javascript, jquery, ajax, internet-explorer-6, pagemethods

我正在执行一个 jQuery`.ajax()`调用，它返回`List<string>`一个指定子网上的 IP 地址。我`[WebMethod]`在 .aspx 页面上使用 a 来返回值。ASP.NET 的内置 JSON 序列化程序神奇地返回了我的 Javascript 中使用的实际 JSON。

我已经分析了服务器端时间，填充和返回列表大约需要 8 毫秒，所以服务器端代码不是问题。

但是，当启动 Ajax 调用时，在 Internet Explorer 中，可能需要 3 秒以上的时间来填充返回的一小部分 IP 地址列表框。在 Firefox 中，列表框基本上是立即填充的。

我不完全确定瓶颈可能在哪里。我最好的猜测是问题出在 IE6 的 javascript 引擎上，但即便如此，仅添加 255 个列表项也不应该花费这么多时间。

谁能指出我为什么会发生这种情况的正确方向？

**示例代码**

```
$.ajax({
          type: "POST",
          url: $("Example.aspx/GetIPsOnNetwork",
          data: "{NetworkID: " + networkID + "}",
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function(data) {
            $('#ipAddresses').empty();
            // Loop through each IP address and add it to the listbox
            $.each(data.d, function(){
                var ip = this.toString();
                $(document.createElement('option')).attr('value', ip).text(ip).appendTo('#ipAddresses');
            });
          },
          error: function(msg) {
            alert('Error: ' + msg);
          }
        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T22:19:13.820

可能是渲染问题。试试这个

```
 success: function(data) {
        // Loop through each IP address and add it to the listbox
        var list = $("<select />");
        $.each(data.d, function(){
            var ip = this.toString();
            list.append($('<option />').val(ip).text(ip));
        });
        $('#ipAddress').empty().append(list.find('option'));
      }, 
```

基本上，您所做的是将选项加载到虚拟列表中，然后将内容添加到 ipAddresses 列表中。

我改变的另一件事是`document.createElement(...)`. 如果您查看它的内部结构，`$('<option />')`它会为您执行 createElement。

最后，我选择将数据追加到列表中，而不是调用`option.appendTo('#ipAddress')`，因为每次都必须找到 ipAddress 元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T22:29:41.453

我怀疑这可能是在 IE 中创建选项元素并将每个元素一一添加到 DOM 的速度不同。

在这条线上

```
$(document.createElement('option')).attr('value', ip).text(ip).appendTo('#ipAddresses'); 
```

你可以试试

```
var optionArray = [];
for (var i= 0; i < this.length; i++)
{
      optionArray[i] = $('<option>').val(ip).text(ip);
}
$('#ipAddresses').empty().append(optionArray.join("")); 
```

或者这个（data.d 是一个对象，对吧？）

```
var optionArray = [];
var i = 0;
$.each(data.d, function(key, value)
{
      optionArray[i++] = $('<option>').val(value).text(value);
});
$('#ipAddresses').empty().append(optionArray.join("")); 
```

你可能会发现[这篇关于 jQuery 的 append() 的文章](http://www.learningjquery.com/2009/03/43439-reasons-to-use-append-correctly)很有用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T23:15:25.463

与非标准但无处不在的 .innerHTML 属性相比，使用推荐的 DOM 创建方法创建元素非常慢。我曾经不得不更新一个大约有 100 行的表，就像您所经历的那样，浏览器越旧，使用元素创建的操作就越慢。如果可以，请创建一个虚拟 SELECT 元素并使用您的 OPTION 元素的串联 HTML 字符串手动填充它，然后在您的虚拟 SELECT 对象上使用 .innerHTML 。然后，您可以随意使用此元素做任何您想做的事情（使用 .replaceChild 等）。

虽然这是一种非标准的元素创建方式，但 .innerHTML 将伴随我们很长时间，而且速度很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-07T19:47:56.830

与 IE7 中的 innerHTML 相比，我发现 jquery 的附加非常慢。Firefox 和 Chrome 似乎使用 append 或 innerHTML 以相同的速度呈现。这可能与 Salaryman 所说的 DOM 创建方法有关。

# wpf - 在 wpf 树视图中导航所有项目

> ID：715883
> 
> 赞同：1
> 
> 时间：2009-04-03T21:57:44.403
> 
> 标签：wpf, treeview, tree

我希望能够遍历可视 ui 树以查找 ID 绑定到可视元素的 Tag 属性的元素。

我想知道我是怎么做到的。控件没有要遍历的子项。

我开始使用 LogicalTreeHelper.GetChildren，它似乎按预期工作，直到我点击 TreeView 控件......然后 LogicalTreeHelper.GetChildren 不返回任何孩子。

注意：目的是找到与数据项对应的可视化 UI 元素。也就是说，给定项目的 ID，找到显示它的 UI 元素。

编辑：我显然没有很好地解释这一点。我将一些数据对象绑定到 TreeView 控件，然后希望在给定业务对象 ID 的情况下以编程方式选择特定项目。我不明白为什么遍历可视化树并找到我想要的元素如此困难，因为数据对象的 ID 位于相应可视元素的 Tag 属性中。我正在使用 Mole，并且能够在其标签中找到具有适当 ID 的 UI 元素。我只是在代码中找不到视觉元素。LogicalTreeHelper 不会遍历树中的任何项目。ItemContainerGenerator.ContainerFromItem 也不检索树视图中的项目的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:07:50.530

看看这个[样本](http://www.codeproject.com/KB/WPF/TreeViewWithViewModel.aspx)。我发现这个示例写得很好，我相信使用 view-model 会解决你的问题。

**编辑：**关于视觉树的搜索。TreeView 和 TreeViewItem 都有 Items 属性，您可以遍历并搜索您的 Id。你不能用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T15:15:42.380

LogicalTreeHelper.GetChildren 查看控件的 LogicalChildren 属性，对于 TreeView（派生自 ItemsControl 类），该属性默认为 null。您可能必须检查 GetChildren 返回的对象的类型，当您遇到 TreeView 对象时，请执行一些特殊的处理逻辑。

该特殊逻辑可能会遍历树的 Items 并尝试将它们强制转换为 FrameworkElement（定义 Tag 属性的基类）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:00:57.687

问题是只`TreeViewItems`创建了可见的 - WPF 不会预先创建所有项目（由于大树可能花费的时间长度，我想）。

更好的方法是创建一个模仿树数据结构的数据结构，并使用数据绑定来告诉`TreeView`如何显示该数据。如果你愿意，我可以写一个简单的例子。

编辑：根据您的编辑，仅当已为该对象创建 UI 项时才有效，这不能保证。看一下[IItemContainerGenerator](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.aspx)接口（通过调用[ItemsControl.ItemContainerGenerator](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemcontainergenerator.aspx)检索。我相信它有一个方法可以返回`TreeViewItem`给定数据对象的 UI 容器（即）。这只有在之前创建了 UI 容器时才有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T18:38:44.047

我通过使用 VisualTreeHelper 递归可视化树做了类似的事情。查看Jim Baltzell-Gauthier 撰写的[这篇博](http://blogs.vertigo.com/personal/jimbg/Blog/Lists/Posts/Post.aspx?ID=4)文——它提供了一些帮助方法来遍历可视化树并按名称和类型返回元素，这类似于我在当前项目中使用的代码。您可以修改这些函数，让它检查标签值，而不是名称。

使用 Visual Tree 需要注意的一件事是，除非已加载视觉对象，否则它不存在 - 如果视觉对象尚未在您调用代码的点。

# java - 使用 java 应用程序通过网络连接到数据库

> ID：715886
> 
> 赞同：0
> 
> 时间：2009-04-03T21:58:23.713
> 
> 标签：java

嘿伙计们，你能再次帮助我吗，我希望我的餐厅系统通过网络连接到数据库，即当服务员使用手持计算机（PDA）下订单并将其发送给厨师时，我希望所有数据都通过网络保存在数据库中。我正在为这个系统使用java。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T22:00:32.600

有一个可爱的[Java 教程](http://java.sun.com/docs/books/tutorial/jdbc/index.html)。简单的方法是使用 JDBC。

# php - 如何使用 php 和 javascript 获取 mysite.com/myaction/#someanchor 等参数

> ID：715888
> 
> 赞同：1
> 
> 时间：2009-04-03T21:58:45.647
> 
> 标签：php, javascript

例如，我默认隐藏评论。

因此，如果我找到#comments，我就会知道我需要显示它们。

是否可以在页面加载时使用 php 或 javascript 捕获？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T22:00:47.203

使用 JavaScript，您可以访问该[`location.hash`](https://developer.mozilla.org/en/DOM/window.location)属性。

```
window.onload = function(){
  alert(location.hash);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:07:46.703

PHP 不知道#comments 位，因此您必须使用 javascript 来实现该功能

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:09:05.327

[在 php 中，您可以使用 parse_url() 函数http://php.net/parse-url](http://php.net/parse-url)访问 URL 的所有部分

```
<?php
  $url = 'http://username:password@hostname/path?arg=value#anchor';

  $url = parse_url( $url );

  echo $url['fragment'];  // will output 'anchor'
?> 
```

**编辑：** 我的道歉伙计们，虽然我的例子适用于服务器端生成的 url，但在这个问题的上下文中你是正确的。片段不是我广泛使用的方法，尽管我确实经常使用 parse_url，所以它立即浮现在脑海中。

为了给这个特定的问题提供一些增值内容，我会使用 jQuery 来显示最初隐藏的评论。如果您正在寻找那种东西，它很容易使用并且有一些漂亮的动画。

例如

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready( function() {
        $("a.toggleComments").click( function() {
            $(".comment").toggle();
            return false;
        });
    });
</script>
<style>
    .comment {
        display: none;
    }
</style>
</head>
<body>
  <p>Some text that is shown by default. <a href="#" class="toggleComments">Toggle Comments</a></p>
  <p class="comment">A comment paragraph, originally hidden</p>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T23:05:03.693

遗憾的是，PHPExperts 是错误的..

任何 url 的 #fragmant 部分实际上都不会发送到服务器。执行请求时，浏览器将删除 # 之后的所有内容。

dcaunts 的建议是正确的，你真的只能在 javascript 中使用它。

# python - 根据查询/slug 因素填充表单字段

> ID：715889
> 
> 赞同：0
> 
> 时间：2009-04-03T21:58:47.877
> 
> 标签：python, django-forms

我见过一些类似的问题，但没有什么能完全指出我希望的方向。我有一种情况，我有一个基于模型的标准 django 表单。此表单有一个下拉框，您可以在其中选择要发表评论的项目。现在我希望人们能够按项目浏览，然后单击链接以评论该特定项目。我想要的是，当用户单击该链接时，他们将看到相同的旧表单，但是，保管箱将默认为他们想要评论的项目。

有没有一种理智的方法可以用现有的形式做到这一点？我应该完全为这个需要创建一个单独的表格吗？

请注意，这不是一个真正的评论系统，也不打算这样做。我的一个想法是构建如下网址：

```
comment/?q=item1 
```

捕捉“item1”部分，然后通过保存功能强制将其放入表单中，同时将公司隐藏在表单中。从 UI 的角度来看，我对这个想法并不欣喜若狂。有什么想法或想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T23:02:06.837

如果我没看错你的问题，这是一个相当常见的用例，并且得到了 django 表单的良好支持。您可以对所描述的两种情况使用相同的表格。

假设要评论的项目具有主键 5。您将构建一个链接供用户单击，其 URL 如下所示：

```
<a href="/comment/5/">Comment on me</a> 
```

（这同样适用于 slug 字段，但请参阅下面关于标识符必须如何匹配字段选择中的 ID 的评论：/comment/my_item_1/）

您的视图将获取参数，并将其传递给`initial`参数中的表单：

```
def show_comment_form(request, item_id):
    form = MyCommentForm(initial={'item_drop_down':item_id}) 
```

表单将显示为预先选择的下拉列表。当然，要使这个示例正常工作，`item_id`参数必须匹配项目字段的选择标识符（如果它是从模型字段自动构建的，听起来，那可能是可用项目类的主键） .

我的意思是，如果选择看起来像：

```
choices = ( (1, 'Item 1'),
            (2, 'Item 2') ) 
```

然后`item_id`应该是 1 或 2，因为这就是结果`<select>`选项中的内容（即：）`<option value="1">Item 1</option>`。自动创建的 ModelForm 类将为您解决这个问题，否则请保持警惕。

您可以在 django 文档中找到更多信息：[动态初始值](http://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)

# perl - 如何在 Perl 中编写缓存 HTTP 代理？

> ID：715895
> 
> 赞同：4
> 
> 时间：2009-04-03T22:00:15.800
> 
> 标签：perl, http, caching, proxy

我打算使用[HTTP::Proxy](http://search.cpan.org/dist/HTTP-Proxy)模块在 Perl 中编写一个简单的 HTTP 代理。我很清楚如何创建代理和基本过滤器等基本任务。但我无法理解的是如何通过缓存手动强制提供文件。

基本上，场景是我在计算机 A 上运行此代理。计算机 B 上的用户访问 Web 时使用此代理。现在，这个代理将充当所有 B 请求的传递，直到他请求一个特定的 URL（一个文件，比如[http://abc.com/file.zip](http://abc.com/file.zip)）。我需要拦截这个请求，而不是让他下载实际的 file.zip，而是给他一个我手动保存在计算机 A 上的已经下载的文件。

另外，请注意，我可能没有在计算机 A 上运行 Web 服务器，所以我不能只重定向 url，我需要从缓存中提供它。

对此的任何指示将不胜感激。谢谢

编辑：更多信息。我开始结合使用 HTTP::Daemon 和 LWP::UserAgent 而不是 HTTP::Proxy 到目前为止，我成功拦截了所有请求，然后我在标头中搜索 url。如果特定的文件名不存在，我只需使用 LWP:UserAgent (simple_request) 将请求传递到实际目的地，然后使用 send_response 将响应返回给原始发件人。如果我找到文件名，我不会进一步转发请求，而是尝试使用“send_file_response”方法提供我的特定文件。问题是所有其他请求都工作正常，comp B 能够上网，但是当它尝试下载这个文件时，它只是一直在等待响应。关于使用 squid，我不能在这些机器上安装 squid。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T22:26:54.557

[将Squid](http://www.squid-cache.org/)用于这样的事情不是更好吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T12:48:45.167

我认为从远处看，我们只能猜测 send_file_response 何时不起作用。我会推荐

*   阅读并理解您正在使用的模块和方法的文档

*   以某种方式在代理服务器中记录操作（开始，结束）

*   跟踪客户端 B 和代理服务器之间的通信。

# visual-studio-2005 - 如何在 VS2005 中使用 .NET 3.0？

> ID：715900
> 
> 赞同：0
> 
> 时间：2009-04-03T22:02:09.523
> 
> 标签：visual-studio-2005, c#-3.0, automatic-properties

我正在尝试在 VS2005 中使用自动实现的属性。我的机器上加载了 .NET 3.0 框架，但 Visual Studio 仍在使用 .NET 2.0 进行编译。我如何告诉它使用 .NET 3.0？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T22:05:20.857

不幸的是，我认为不可能做到这一点，因为这是 C# 编译器的一个特性。Visual Studio 2005 被硬编码为使用 C# 2.0 编译器。您需要升级到 Visual Studio 2008 才能使用新的 C# 3.0 功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T22:05:19.640

自动生成的属性需要 C#3.0，这在 VS2005 中不可用。您需要使用 VS2008 来获取自动生成的属性语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:04:15.417

转到您的项目属性。在应用程序选项卡下，您可以更改目标框架

# linux - 你如何让 sudo 保存密码？

> ID：715908
> 
> 赞同：0
> 
> 时间：2009-04-03T22:04:35.337
> 
> 标签：linux, sudo

您如何设置它以使 sudo 不会每次都提示您输入密码？我有根。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T22:12:04.883

使用 /etc/sudoers 中的 NOPASSWD 选项。

但是，这通常是一个坏主意，因为任何可以访问通过 sudo 运行命令而无需密码的帐户的用户都可能会破坏系统。

此外，sudo 应该记住您的密码一段时间。如果这对您的口味来说太快了，您可以按照此处的说明来增加超时：http: [//forums.macosxhints.com/showthread.php?t=83344](http://forums.macosxhints.com/showthread.php?t=83344)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:18:02.513

`man sudoers`是你的朋友。它解释了所有关于`NOPASSWD`和 sudoers 文件，您应该使用`visudo`.

# unicode - Unicode 第一、上一个、下一个和最后一个

> ID：715910
> 
> 赞同：23
> 
> 时间：2009-04-03T22:05:03.463
> 
> 标签：unicode

Unicode 有雪人和棋子。它是否有第一个（<< 或 |<）、前一个（<）、下一个（>）和最后一个（>> 或 >|）符号？这些对于文章等之间的站点导航非常有用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-03T22:11:38.660

它有**«** (0x00AB) 和**»** (0x00BB)

或者这些：

*   ⇤（第一个 0x21E4）
*   ← (上一个 0x2190)
*   →（下一个 0x2192）
*   ⇥ (最后 0x21E5)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-01-18T14:36:08.673

您还有以下选择：

*   ⏮ (0x23EE)
*   ⏪ (0x23EA)
*   ◄ (0x25C4)
*   ► (0x25BA)
*   ⏩ (0x23E9)
*   ⏭ (0x23ED)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T22:13:57.203

还有[一大堆箭矢](http://www.alanwood.net/unicode/arrows.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-06-30T13:13:21.890

我喜欢这些：< ></p>

```
.next:before {
  content: '\232a';
}
.prev:before {
  content: '\2329';
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T23:27:42.500

我找不到任何具有这些确切含义的符号，所以我猜你必须将符号组合成你想要的。也许是箭头 276E 和 276F，以及竖线 2759 ( [PDF](http://www.unicode.org/charts/PDF/U2700.pdf) )。

如果您在网页上使用它，您应该对使用的字符有所限制。并非所有字体都具有完整的 unicode 字符集，并且如您所知，您永远无法 100% 确定页面是否使用您想要的字体显示。也许图像可能是获得一致外观的更好选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T22:14:14.237

嗯……

根据[这个pdf文件](http://www.unicode.org/charts/PDF/U2190.pdf)，你想要

U+2190: ← 左箭头

U+2192: → 右箭头

U+219E: ↞ 类似“第一”的东西

U+21A0: ↠ 类似'last'

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-24T14:05:45.547

另一种可能性是：

*   ⟪`U+27EA`
*   ⟨`U+27E8`
*   ⟩`U+27E9`
*   ⟫`U+27EB`

# sql - 从 2 个相关表中提取唯一电话号码的 SQL 查询

> ID：715915
> 
> 赞同：2
> 
> 时间：2009-04-03T22:06:29.060
> 
> 标签：sql

我正在尝试从 2 个单独的表中创建一个 ANI 查找表，一个是商店表，另一个是这些商店的联系人列表。

我正在使用 MS SQL Server 2005，不幸的是，它不支持 MERGE INTO 语法...

好东西：ANI 查找表有 2 个重要的列，StoreID 和 PhoneNumber。PhoneNumber 列是（唯一的）主键，因为给定的 PhoneNumber 必须只返回一个 StoreID。

Store_Info 重要列：

```
StoreID  
StorePhone  
AltPhone 
```

每个 StoreID 有一个记录，商店之间可能有重复的电话号码。是的，AltPhone 可能与 StorePhone 相同......

Store_Contacts 重要列：

```
StoreID  
Phone 
```

StoreID 有多个条目，一个商店或多个商店之间可能存在重复的电话号码。

样本商店数据

```
StoreID   Parent ID StorePhone       AltPhone  
1         0         402-123-2300     402-123-2345  
2         0         202-321-7800     202-321-7890  
3         1         202-302-5600     202-302-5600 
```

示例联系人数据：

```
StoreID   Title    Name    Phone  
1         Mgr      Bob     402-123-2345  
1         IT       Pat     402-123-2346  
1         Reg Mgr  Dave    402-321-3213  
2         Mgr      Ann     202-231-7890  
2         IT       Mary    202-231-7893  
2         A/R      Ann     202-231-7890  
2         Reg Mgr  Dave    402-321-3213  
3         Mgr      Bob     402-123-2345  
3         AsstMgr  Pete    402-123-2356 
```

我想按以下优先级插入电话号码：

1.  主/单店StorePhone
2.  主/单店 AltPhone
3.  分店 StorePhone
4.  分店 AltPhone
5.  主要/单店联系电话
6.  分店联系电话
    *   如果目标表中已存在电话号码，请不要添加它...

所以生成的数据集应该是：

```
StoreID  Phone  
1        402-123-2300  (first pass)  
2        202-321-7800  
1        402-123-2345  (2nd pass)  
2        202-321-7890  
3        202-302-5600  (3rd & 4th pass - only add once)  
1        402-123-2346  (5th pass - skip dup)  
1        402-321-3213  
2        202-231-7893  (do not add dups)  
3        402-123-2356  (final pass - skip dup) 
```

我确定要选择的重复电话号码的优先级的方法是根据其他条件（例如，主商店与分支）进行多次查询，将找到的第一个条目插入 ANI 查找表并跳过后续重复。

我如何在不使用 RBAR 的情况下做到这一点？我尝试了以下方法，但没有成功 - 实际上，它可以正常工作，直到我到达 Store_Contacts 表，其中给定商店可以有多个相同的电话号码：

```
INSERT INTO dbo.Store_PhoneNumbers (StoreID, PhoneNumber)
    SELECT DISTINCT StoreID, dbo.GetPhoneNumber10(StorePhone)
    FROM dbo.Store_Info
    WHERE dbo.IsAniNumber(dbo.GetPhoneNumber10(StorePhone)) = 1
        AND ParentID = 0
        AND NOT EXISTS (SELECT * FROM dbo.Store_PhoneNumbers WHERE PhoneNumber = dbo.GetPhonenumber10(StorePhone)); 
```

... 重复 AltPhone，然后 StorePhone where ParentID <> 0 然后 AltPhone w/ ParentID <> 0

到目前为止一切顺利，那么这里就是它崩溃的地方：

```
INSERT INTO dbo.Store_PhoneNumbers (StoreID, PhoneNumber)
    SELECT DISTINCT sc.StoreID, dbo.GetPhoneNumber10(sc.Phone)
    FROM Store_Contacts sc
            INNER JOIN
        Store_Info si ON sc.StoreID = si.StoreID
    WHERE (dbo.IsAniNumber(dbo.GetPhoneNumber10(sc.Phone)) = 1)
        AND (si.ParentID = 0)
        AND NOT EXISTS (SELECT * FROM dbo.Store_PhoneNumbers WHERE PhoneNumber = dbo.GetPhonenumber10(sc.Phone)); 
```

...并重复 ParentID <> 0

那是我得到重复条目并且插入失败的地方。

感谢您给我的任何帮助，我即将放弃并使用光标，只是为了完成它......
戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:37:20.817

```
SELECT DISTINCT sc.StoreID, dbo.GetPhoneNumber10(sc.Phone) 
```

DISTINCT 是错误的。它将允许 2 家商店共享相同的号码。使用 GROUP BY 确保第二列是唯一的。

```
INSERT INTO dbo.Store_PhoneNumbers (StoreID, PhoneNumber)
SELECT MIN(StoreID), PhoneNumber
FROM
(
  SELECT sc.StoreID as StoreID, dbo.GetPhoneNumber10(sc.Phone) as PhoneNumber
  FROM Store_Contacts sc
      INNER JOIN
      Store_Info si ON sc.StoreID = si.StoreID
  WHERE (dbo.IsAniNumber(dbo.GetPhoneNumber10(sc.Phone)) = 1)
      AND (si.ParentID = 0)
      AND NOT EXISTS (SELECT * FROM dbo.Store_PhoneNumbers WHERE PhoneNumber = dbo.GetPhonenumber10(sc.Phone))
) sub
GROUP BY PhoneNumber 
```

您可以在其他查​​询中使用 distinct 的原因是您在其中使用单个 StoreID。此查询返回多个 StoreID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T22:42:43.187

它不只是一个基于以下内容的查询：

```
SELECT StorePhone AS Phone -- , ...other columns...
    FROM StoreInfo
UNION
SELECT AltPhone AS Phone   -- , ...other columns...
    FROM StoreInfo
UNION
SELECT Phone               -- , ...other columns...
    FROM Store_Contacts 
```

如果 AltPhone 可以为空，则可以添加 WHERE 子句来消除空值。我不清楚您所说的 ANI 或 RBAR 是什么意思。只要网络相同，您显然可以向不同的结果集添加额外的列。UNION 自动消除重复行。

* * *

> 如果目标表中已存在电话号码，请不要添加它...

啊，那你需要 MERGE 语句。您将使用上述查询的一个小变体作为数据源，合并到您的目标表中。

来自 SQL 2003 标准（第 14.9 节）的语句的 BNF：

```
<merge statement> ::=
     MERGE INTO <target table> [ [ AS ] <merge correlation name> ]
     USING <table reference> ON <search condition>
     <merge operation specification>

<merge correlation name> ::= <correlation name>

<merge operation specification> ::= <merge when clause> ...

<merge when clause> ::=
    <merge when matched clause> |
    <merge when not matched clause>

<merge when matched clause> ::=
    WHEN MATCHED THEN <merge update specification>

<merge when not matched clause> ::=
    WHEN NOT MATCHED THEN <merge insert specification>

<merge update specification> ::= UPDATE SET <set clause list>

<merge insert specification>  ::=
     INSERT [ <left paren> <insert column list> <right paren> ]
     [ <override clause> ] VALUES <merge insert value list>

<merge insert value list> ::=
     <left paren> <merge insert value element>
     [ { <comma> <merge insert value element> }... ] <right paren>

<merge insert value element> ::=
     <value expression> |
     <contextually typed value specification> 
```

您还可以在相关产品手册中找到该声明的说明，该手册通常提供更多选项。在您的情况下，您可能会省略 WHEN MATCHED 子句，只使用 WHEN NOT MATCHED 子句。

* * *

补充观察：

> MS SQL Server 2005 不支持 MERGE。

不是我所知道的唯一具有这种限制的 DBMS。

那么，您可能会面临创建一个临时表并使用 UNION-select 语句中的数据加载它的问题。

然后，您可以根据主数据表中相应行的不存在从临时表中插入主数据表。至少，某些 DBMS 允许您这样做。我不是 MS SQL Server 专家，所以我不知道 UPDATE 语句的细则是否会阻止您从 UPDATE 语句的子查询中更新的表中进行选择。如果你是如此有限，那可能是一个真正的麻烦。

另一种选择是将表卸载为纯文本，并将UNION-select数据卸载为纯文本，然后使用文件系统（命令行）选项来处理它。这有多可行取决于我忘记的数据量。Perl 在这里很有用，将主表读入散列，然后从 UNION-select 数据中选择性地更新它，最后将数据重写到加载文件。然后你“只是”开始事务，删除所有旧数据，加载所有新数据，然后交叉手指并提交。这样做的缺点是会丢失卸载和加载之间所做的更改。因此，如果您决定使用此技术，请务必小心。您可能希望在事务中进行卸载，修改数据，然后删除并重新加载——所有这些都在同一个事务中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:14:52.707

供参考，

ANI = [http://en.wikipedia.org/wiki/Automatic_Number_Identification](http://en.wikipedia.org/wiki/Automatic_Number_Identification)

RBAR= row by agonizing row

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T21:09:31.730

我看到已经选择了一个答案，但如果我没有指出一个更简单、更通用的解决方案，那我就失职了。

与其在插入顺序中隐含优先级，不如使其显式。

您的问题基本上是，“我有多个数据源，并且我知道每个源的优先级。对于每个键，我希望选择具有最高优先级的单个数据。”

首先为您的密钥（电话）选择所有可能的数据（storeid）：

```
create table prioritized_phone( phone char(12), storeid int, priority int);

insert into prioritized_phone(phone, storeid, priority) 
select storephone, storeid, 1  from store_info
union
select altphone, storeid, 2 from store_info 
```

我不知道您如何选择分店的电话，但是有一些查询可以得到它，可能是通过在 storeinfo 中使用 parentid，如下所示：

```
union
select b.storephone, a.storeid, 3
from store_info a join storeinfo b on (a.parentid = b,storeid)
select b.altphone, a.storeid, 4
from store_info a join storeinfo b on (a.parentid = b,storeid) 
```

然后是联系电话：

```
union 
select distinct phone, storeid, 5 from storecontacts; 
```

完成此操作后，对于每部手机，删除除最低（最佳）优先级之外的任何内容：

```
delete from prioritized_phone a where a.priority > 
(select min( priority) from prioritized_phone b where b.phone = a.phone); 
```

现在对于每部电话，我们只有其最低优先级行。这仍然可能不是商店唯一的，因此我们任意选择手机的最低 storeid：

```
delete from prioritized_phone a where a.store_id > 
(select min( store_id ) from prioritized_phone b where b.phone = a.phone); 
```

我们现在每部手机都有一个 storeid，但我们仍然可能有骗子：

```
create table phone_lookup( phone char(12), storeid int);

insert into phone_lookup(phone, storeid)
select distinct phone, storeid 
from prioritized_phone; 
```

为什么这个解决方案更容易？因为它将优先级（隐含在您的解决方案中（由操作顺序隐含））变为我们可以选择的显式值。

# c++ - 成员函数与非成员函数？

> ID：715919
> 
> 赞同：8
> 
> 时间：2009-04-03T22:07:47.153
> 
> 标签：c++, oop

对于在类上运行的函数应该是成员函数还是非成员函数，您的规则是什么？例如，我有一个使用布尔矩阵表示迷宫的类。我正在制作一个名为 isConnected 的函数，它验证迷宫中的 2 个点是否在同一区域（即可以从 A 移动到 B）。

这应该是会员还是非会员？什么是好的规则？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T22:46:57.060

Herb Sutter 说“如果可能的话，我们想让他们成为非会员非朋友”，他比我聪明。

[http://www.gotw.ca/gotw/084.htm](http://www.gotw.ca/gotw/084.htm)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-03T23:35:14.107

好吧，两者都有论据。

支持非成员函数：

*   它提供了[更好的封装](http://www.ddj.com/cpp/184401197)
*   它允许更好的代码重用（std::find 可以被*任何*容器类型重用，因为它是一个自由函数。如果它是一个成员，那么任何容器都必须定义它自己的）
*   它使许多通用编程技巧变得更容易。（`container.begin()`如果是数组则无效`container`。这使得编写在容器上工作的通用代码有点尴尬。但`begin(container)`可以使任何类型都有效，甚至是数组等内置类型）。它还可以通过组合使 mixin 更加简洁，因为它不需要用户通过成员“点”自己来获取要操作的 mixin 对象。

赞成使事物成为成员函数的是：

*   It's familiar. Java and C# *require* this, and in a lot of programmers' eyes, member functions are synonymous with OOP.

and... that's it. (But that argument should not be underestimated. Code readability is important, and if people find it easier to read the member version, that's a strong argument in its favor. It just doesn't produce better code. From a strict "better code" point of view, nonmembers should be preferred when possible.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-03T22:14:13.020

何时将其设为成员函数：

*   当函数与类在逻辑上耦合时（比如你的迷宫连接示例）
*   当函数需要访问私有或受保护的成员时，最好将其设为成员而不是好友。

何时使其成为独立功能

*   当它是一个可以模板化以自然地在其他类上工作的通用函数时（查看 <algorithms> 标头以获得很好的示例）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-03T22:13:44.707

在这种情况下，我会选择一个成员函数。我遵循的规则是，如果一个函数必须访问实例当前状态内部的东西，那么它应该是类的“领域”的一部分。在这种情况下，A 和 B 的连通性取决于对象实例的状态。

当然，你最终可能会让一个类承担太多责任。在这种情况下，保持简单的因素就会发挥作用，您应该考虑您的班级是否试图做太多事情。然后，拥有一个单独的类（例如，在您的情况下为 ConnectednessEvaluator）会很方便，其特定作用是保存可以遍历并作用于您的 Maze 实例的算法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-03T22:10:24.573

我总是参考[FAQ 13.9](http://www.parashift.com/c++-faq-lite/operator-overloading.html#faq-13.9)。这不是一门精确的科学，而是基于自由裁量权的科学。

说当你需要访问类内部时——你应该使用一个成员是一种过于简单化的说法。值得注意的例子是流插入/提取运算符（`>>`和`<<`分别）和二进制`+`。

在您的示例中，`isConnected`是一种测试对象状态的方法，即检查员和成为成员的理想候选人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T22:45:03.587

我倾向于制作非成员函数的唯一东西是只能从成员函数内部调用的东西（不需要在类外可见），并且可以在类的公共成员和/或小型参数数量。

# c++ - Qt：QGraphicsScene 在我期望的时候没有更新

> ID：715920
> 
> 赞同：3
> 
> 时间：2009-04-03T22:08:18.683
> 
> 标签：c++, qt, qgraphicsscene

好的，所以我有`QGraphicsScene`一门课叫做眼睛。我调用一个函数：

```
void eye::playSequence(int sequenceNum) {

    for (int i=0; i<sequences[sequenceNum].numberOfSlides(); i++) {
        presentSlide(sequenceNum, i);
        time_t start;
            time(&start);
            bool cont=false;
            while (!cont) {
                time_t now;
                time(&now);
                double dif;
                dif=difftime(now, start);
                if (dif>5.0)
                    cont=true;
            }
    }
} 
```

每张幻灯片调用：

```
void eye::presentSlide(int sequenceNum, int slideNum) {

    Slide * slide=sequences[sequenceNum].getSlide(slideNum);

    QGraphicsPixmapItem * pic0=scene.addPixmap(slide->getStimulus(0)->getImage());
    pic0->setPos(0,0);

    QGraphicsPixmapItem * pic1=scene.addPixmap(slide->getStimulus(1)->getImage());
    pic1->setPos(horizontalResolution-350,0);

    QGraphicsPixmapItem * pic2=scene.addPixmap(slide->getStimulus(2)->getImage());
    pic2->setPos(horizontalResolution-350,verticalResolution-450);

    QGraphicsPixmapItem * pic3=scene.addPixmap(slide->getStimulus(3)->getImage());
    pic3->setPos(0,verticalResolution-450);
} 
```

现在，我希望这会显示一组图像，等待 5 秒，然后显示下一个，依此类推。相反，在处理完所有幻灯片并显示最后四个图像之前，它不会显示任何内容。我试过`scene.update()`在我能想象到的每一个地方打电话，但它没有做任何事情。似乎场景仅在`playSequence`函数返回时更新。有什么想法可能会在这里发生吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T23:54:51.093

当人们想要做连续动画时，这是一种在事件驱动的 GUI 框架中经常看到的行为。我猜 eye::playSequence 是通过单击按钮调用的，还是从应用程序启动代码期间的某个时间点调用的？无论如何，这就是正在发生的事情。

Qt 使用主应用程序线程来驱动事件循环。事件循环是这样的：

```
while(app_running)
{
  if(EventPending)
    ProcessNextEvent();
} 
```

您看到的问题是屏幕更新是在绘制事件期间完成的。如果您在鼠标单击事件或任何其他事件期间运行某些代码，那么您正在执行的所有绘图都会排队，并将在下一个绘图事件时绘制到屏幕上。有时这需要一段时间才能融入其中。

解决这个问题的最好方法是稍微改变你的方法。一种方法是丢弃您的 while 循环并设置一个 QTimer 设置为每 5 秒触发一次。在计时器插槽中，您可以绘制一张幻灯片。当计时器再次触发时，绘制下一张幻灯片，等等。

如果您想要一个更直接且不太优雅的快速修复，请尝试在调用 presentSlide(sequenceNum, i) 之后立即调用 qapp->processEvents()。这（大多数情况下）将强制应用程序清除所有排队的事件，这些事件应该包括绘制事件。

我还应该提到 eye::presentSlide() 只是在每次迭代时向场景中添加新的场景对象，覆盖上次调用期间添加的对象。将场景想象成冰箱门，当您调用 scene().addXXX 时，您会在门上扔更多冰箱磁铁 :)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T23:56:37.237

您需要让应用程序的事件循环运行以保持用户界面更新。从您的代码中执行此操作的最简单方法是在您的内部 while 循环中调用 QApplication::processEvents()。

许多人会认为您的 while 循环效率低下 - 毕竟，您只是在等待给定的时间段过去。您可能需要考虑重组代码以改用计时器。

你可以在你的 eye 类的构造函数中创建一个 QTimer 对象，设置一个 5 秒的超时时间，并将它的 timeout() 信号连接到你的 eye 类中的一个槽，该槽将索引更新到一组幻灯片并调用 presentSlide()。您将在 playSequence() 函数中启动计时器。

# functional-programming - CafeOBJ cmmdc 和有理数

> ID：715921
> 
> 赞同：0
> 
> 时间：2009-04-03T22:08:27.887
> 
> 标签：functional-programming

在整数模块中，我尝试定义`cmmdc`找到最大公倍数的操作。问题是我做错了，因为代码不适用于 5 和 3 等 2 个素数。

这是我的整数模块代码：

```
module integer

{

    protecting (natural)

    [nat < int]

    op s_ : int -> int                  
    op _+_ : int int -> int { assoc comm idr: 0 }
    op _-_ : int int -> int             
    op _*_ : int int -> int { assoc comm idr: (s 0) } 
    op _/_ : int int -> int     
    op _<_ : int int -> int     
    op _>_ : int int -> int     
    op _<=_ : int int -> int    
    op cmmdc : int int -> int   

    op p_ : int -> int                  -- Predecesor (pentru numere negative)

    op -_ : int -> int                  -- Minusul 

-- -----------------------------------Variable-------------------------------------------------

    vars x y z a b : int

-- -----------------------------------Ecuatii---------------------------------------------------

-- definirea modului de functionare al lui p fata de s

    eq s p x = x .

    eq p s x = x .

-- definirea lui - ca semn

    eq - - x = x .

    eq - 0 = 0 .

    eq - p x = s - x .

    eq - s x = p - x .

-- Adunarea

    eq x + p y = p(x + y) .

-- Scaderea

    eq x - y = x + (- y) .

-- Inmultirea

    eq x * p y = x * y - x .

-- cmmdc

    eq cmmdc(0, x) = x .
    eq cmmdc(x, 0) = x .
    eq cmmdc(s 0, s 0) = s 0 .
    ceq cmmdc(x, y) = cmmdc(x - y , y) if (x > y) .
    ceq cmmdc(x, y) = cmmdc(y - x , x) if (y > x) .

} 
```

由于我正在导入自然数，因此这里是自然模块：

```
module natural

{

    [nat]

    [nznat]

    [nznat < nat]

    op 0 : -> nat

    op s_ : nat -> nznat

    op toBool_ : nat -> Bool

    op _+_ : nat nat -> nat { assoc comm idr: 0 prec: 33}
    op _-'_ : nat nat -> nat
    op _*_ : nat nat -> nat { assoc comm idr: (s 0) prec: 31}
    op _/'_ : nat nznat -> nat
    op _<_ : nat nat -> Bool
    op _>_ : nat nat -> Bool
    op _<=_ : nat nat -> Bool

    op mod : nat nznat -> nat

-- ---------------------------Variabile-------------------------

    var x : nat

    var y : nat

    var z : nat

    var a : nznat

-- ---------------------------Ecuatii---------------------------    

    -- eq x + 0 = x .

    -- eq 0 + x = x .

-- Suma:

    eq x + s y = s (x + y) .

-- Diferenta:   

    eq x -' 0 = x .

    eq 0 -' x = 0 .

    eq s x -' s y = x -' y .

-- Inmultirea

    eq x * 0 = 0 .
    eq x * s y = x * y + x .

-- Impartirea:      [parte intreaga]

    eq 0 /' a = 0 .

    eq x /' a = ((x -' a) /' a) + s 0 .

-- ?

    -- eq 0 < z = true .

    -- eq x < y = toBool (x -' y) .

    -- ceq x < y = true if toBool (x -' y) .

    -- ceq x < y = false if toBool (x -' y) == false .

-- Conversie de la integer la Bool

    eq toBool 0 = true .

    eq toBool z = false .

-- Mai mic

    eq x < y = toBool (x -' y) .

-- Mai mic sau egal 

    ceq x <= y = true if ( x < y ) or ( x == y) .

    ceq x <= y = false if ( y < x ) .

-- Mai mare

    ceq x > y = true if ( y < x ) .

    ceq x > y = false if ( x < y ) .

-- mod

    ceq mod(x, a) = x if (x < a) .
    ceq mod(x, a) = mod(x -' a, a) if (x > a) .

} 
```

* * *

另外，我被要求为有理数（Q）制作一个模块。这是我到目前为止写的，但它似乎有点错误：

```
module rational
{
    protecting (integer)
    [integer < rational]    
    [rational* < rational]

    op _|_ : int nznat -> rational
    op _||_ : nznat nznat -> rational*

    op _+"_ : rational rational -> rational
    op _-"_ : rational rational -> rational
    op _*"_ : rational rational -> rational
    op _/"_ : rational rational* -> rational

    op reducere_ : rational -> rational

-- -----------------------------------Variabile-------------------------------------------------    
    var x : int
    var y : int
    var z : int

    var a : nznat
    var b : nznat
    var c : nznat

-- -----------------------------------Ecuatii---------------------------------------------------

-- Adunarea

    ceq (x | a) +" (y | b) = ( x + y ) | a if ( a == b) .
    ceq (x | a) +" (y | b) = ( x * b + y * a ) | ( a * b) if (a > b) or (a < b) .

-- Scaderea

    ceq (x | a) -" (y | b) = ( x - y ) | a if ( a == b) .
    ceq (x | a) -" (y | b) = ( x * b - y * a ) | ( a * b) if (a > b) or (a < b) .

-- Inmultirea

    eq (x | a) *" (y | b) = (x * y) | (a * b) .

-- Impartirea

    eq (x | a) /" (b || c) = (x * c) | (a * b) .

-- Aducere la acelasi numitor 

    eq reducere x | a = (x / cmmdc(x, a)) | (a / cmmdc(x, a)) .

} 
```

你能告诉我我哪里做错了吗？我似乎无法自己弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T14:00:44.333

尝试“设置步骤”然后“减少 cmmdc(5,3) ”。并在每一步按“n”继续。检查每一步，看看它是否符合您的预期

翻译：incearca cu "set step on" apoi "reduce cmmdc(5,3) 。" si la fiecare pas apasa "n" (n de la next) si verifica atent daca se intampla ceea ce te astepti。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T09:02:40.870

（我假设我们将“最大公约数”称为“最大公约数”是没有意义的。）

我不知道这是什么语言，但您似乎没有针对 cmmdc 的参数相等的情况的条款。

顺便说一句，cmmdc(5,3) 的结果是什么？你期待什么？

（请注意，而不是问“为什么 cmmdc(5,3) 错误？”最好问：“cmmdc(5,3) 返回 x，但我期望 y。这是为什么？”）

# javascript - javascript: history.go(1) 需要保留 ASP 会话？

> ID：715933
> 
> 赞同：2
> 
> 时间：2009-04-03T22:12:06.037
> 
> 标签：javascript, session, asp-classic

我继承了一个经典的 ASP 应用程序，前作者声称：

```
正文 onload="javascript: history.go(1);"
```

需要防止网站“丢失会话”

有人听说过这个怪癖吗？我无法理解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T23:09:15.087

听起来老开发人员试图阻止用户使用前进/后退浏览器按钮进行导航。如果应用程序不是为适应用户跳来跳去而设计的，那么突然从意外页面提交表单可能绝对会破坏会话。

将 history.go(1) 放在每个文档的脚本标记中会强制浏览器重复跳转到最后访问的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T22:37:57.347

不，这不会阻止会话 (a) 过期或 (b) 丢失识别它们的浏览器 cookie。这是“丢失会话”的两个原因。正如您在评论中指出的那样，这通常是为了破解禁用后退按钮。它今天仍在使用。

# php - 如何在 php（特别是 drupal）中使用 CSV 文件进行 SQL 连接？

> ID：715938
> 
> 赞同：1
> 
> 时间：2009-04-03T22:15:06.373
> 
> 标签：php, sql, drupal, csv

嘿伙计们，这是我的问题。我正在编写一个 Drupal 模块。用户以表单的形式将电子邮件地址的 CSV 列表上传到服务器。我需要在我的数据库上进行 JOIN 以从 CSV 文件和数据库中获取唯一地址列表（不，它不适用于垃圾邮件:)。

如何将上传的 CSV 文件转换为可以在 php 中使用我的数据库中的表对其进行 SQL 连接的格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T22:17:34.527

[您可以使用LOAD DATA INFILE](http://www.tech-recipes.com/rx/2345/import_csv_file_directly_into_mysql/)直接加载它

或者，如果您愿意，可以使用[fgetcsv()](http://php.net/fgetcsv)在 PHP 中阅读它，尽情享受，然后将它们插入到临时表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:41:12.597

将数据加载到“临时”表中使其非常容易处理。您将希望将索引应用于表以加快连接速度，但在加载数据之前删除索引然后重新创建它可能会更快。（与所有性能建议一样，在采用更复杂的解决方案之前衡量您自己的结果。）

# c# - 以编程方式更改 log4net 日志记录级别

> ID：715941
> 
> 赞同：62
> 
> 时间：2009-04-03T22:18:12.450
> 
> 标签：c#, logging, log4net

这类似于[650694](https://stackoverflow.com/questions/650694/changing-the-log-level-programmaticaly-in-log4net)但没有接受任何答案，我根本无法得到任何这些建议，我怀疑我的情况可能略有不同。

我正在调用 log4net.Config.XmlConfigurator.Configure()。但是在程序中的那一点之后，我想将日志记录阈值更改为仅在运行时知道的值。

从另一个问题，我尝试：

```
((log4net.Repository.Hierarchy.Logger)mylogger.Logger).Level = log4net.Core.Level.Error; 
```

和：

```
var appender = new log4net.Appender.ColoredConsoleAppender();
appender.Layout = new log4net.Layout.PatternLayout(@"%date %-5level %message%newline");
appender.Threshold = log4net.Core.Level.Error;
appender.ActivateOptions();
log4net.Config.BasicConfigurator.Configure(appender); 
```

但似乎都没有任何效果：我仍然在控制台上看到 DEBUG 和 INFO 日志记录语句。

我的预感是我正在添加一个新的 appender，它对 XML 配置中声明的 appender 没有影响（告诉它打印 DEBUG 级别的消息），但我还没有任何证据。

我一直在研究 log4net API 一段时间，但我只是没有看到它。我缺少一些简单的东西吗？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2011-12-28T20:33:47.607

这里提供的这些解决方案都不适合我。它在**运行时没有改变**

这对我有用：

```
((log4net.Repository.Hierarchy.Hierarchy)LogManager.GetRepository()).Root.Level = Level.Debug;
((log4net.Repository.Hierarchy.Hierarchy)LogManager.GetRepository()).RaiseConfigurationChanged(EventArgs.Empty); 
```

在更改其配置后，您必须调用 RaiseConfigurationChanged。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-03T23:53:10.990

终于找到了一个可行的解决方案，[here](http://geekswithblogs.net/rakker/archive/2007/08/22/114900.aspx)。

大件是：

*   需要在所有记录器上设置阈值，包括“无法按名称检索”根记录器
*   需要从 Hierarchy 的 LevelMap 中获取 Level

非常感谢 Eddie 提出了很好的尖锐问题，这让我在谷歌上搜索到了正确的词。我永远不会独自想到这一点。

（旁白：Repository、Hierarchy、Logger、RootLogger、LevelMap——我什至不知道有可能让一个日志库变得如此复杂。它有大约 20 层间接，我确信它足够灵活，可以处理任何事情，但是几乎不可能做一些简单的事情，比如“不要记录任何高于阈值 X 的消息”。哎呀！）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-02-18T20:51:37.510

有一个简单的方法来做到这一点：

```
LogManager.GetRepository().Threshold = Level.Info; 
```

更多信息可以在[这里](http://www.nerdpad.com/how-to/c-change-log4net-log-path-and-level-programmatically)找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-03-21T20:34:51.953

JeanT 的回答似乎不适用于最新版本的 log4net。

我对其进行了调整以使其正常工作，这将更改为调试级别，但根据需要进行更改。

`foreach(var r in LogManager.GetAllRepositories()) { ((log4net.Repository.Hierarchy.Hierarchy)r).Root.Level = Level.Debug; ((log4net.Repository.Hierarchy.Hierarchy)r).RaiseConfigurationChanged(EventArgs.Empty); }`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-15T23:34:50.763

如果这适用于某人，这就是我在我的 Web 应用程序中实现通过 API 调用公开的切换级别端点的方式，因此我可以动态更改日志记录级别。

```
public HttpResponseMessage Post([FromBody] string logLevel)
{
    var newLevel = ToggleLogging(logLevel);

    // Create your own response here.
    return newLevel;
} 
```

而实际的实现

```
private Level ToggleLogging(string logLevel)
{

    Level level = null;

    if (logLevel != null)
    {
        level = LogManager.GetRepository().LevelMap[logLevel];
    }

    if (level == null)
    {
        level = Level.Warn;
    }

    ILoggerRepository[] repositories = LogManager.GetAllRepositories();

    //Configure all loggers to be at the same level.
    foreach (ILoggerRepository repository in repositories)
    {
        repository.Threshold = level;
        Hierarchy hier = (Hierarchy)repository;
        ILogger[] loggers = hier.GetCurrentLoggers();
        foreach (ILogger logger in loggers)
        {
            ((Logger)logger).Level = level;
        }
    }

    //Configure the root logger.
    Hierarchy h = (Hierarchy)LogManager.GetRepository();
    Logger rootLogger = h.Root;
    rootLogger.Level = level;

    return level;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-22T18:19:47.010

尝试了所有这些答案，但都没有奏效。在调试器中，我可以看到所有记录器级别、根级别、阈值都按指示设置。尽管如此，我在登录的滚动文件中没有看到任何日志级别的变化。

然后我发现在配置文件中appender元素还指定了一个阈值。因此，例如，当我想在 appender 设置为 Warn 时将级别更改为 Debug 时，该 appender 没有接收其他消息，因为它们低于阈值。所以我从 appender 配置中删除了阈值，只保留了级别配置。

```
 <root>
    <level value="Warn" />
    <appender-ref ref="RollingFile" />
  </root> 
```

然后我最终使用 Ken 的解决方案在运行时更改关卡。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-27T15:16:45.853

我一直在寻找相同的方法，发现最新的 NLog 版本 3.2.0.0 提供了以下选项来更改运行时的日志记录级别。

```
 LogManager.GlobalThreshold = LogLevel.Debug; 
```

我认为另一种方法可能是`LogManager.Configuration`使用变量覆盖配置设置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-28T17:24:04.770

在我的情况下，我为不同的附加程序设置了不同的默认级别来设置配置，但是如果应用程序处于详细模式，我想覆盖它们。

我使用了以下内容：

```
var log4NetHierarchy = (log4net.Repository.Hierarchy.Hierarchy)LogManager.GetRepository();
foreach (var appender in log4NetHierarchy.GetAppenders())
{
    if (appender is AppenderSkeleton appenderSkeleton)
    {
        appenderSkeleton.Threshold = Level.All;
    }
}
log4NetHierarchy.RaiseConfigurationChanged(EventArgs.Empty); 
```

# actionscript-3 - Flex 擦除状态转换？

> ID：715947
> 
> 赞同：0
> 
> 时间：2009-04-03T22:21:48.353
> 
> 标签：actionscript-3, flex3

我正在尝试在两种状态之间创建一个简单的擦除/滑动类型转换。类似于 iphone 从一个列表“滑动”到另一个列表的方式（即收件箱 > 邮件列表）

我似乎无法弄清楚或找到有关如何使用 2 个简单的画布组件和过渡来执行此操作的正确文档，其中一个从屏幕向左滑出，而另一个从右侧滑入。

我已经使用以下代码“滑入”了第二个状态，但是如何修改为同时“滑出”第一个状态？

```
<mx:transitions>
    <mx:Transition fromState="summaryState" toState="detailState">
    <mx:Parallel target="{contentCanvas}">
        <mx:WipeLeft duration="300"/>
    </mx:Parallel>
    </mx:Transition>
</mx:transitions> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T22:28:39.927

在[Adob​​e 的网站上](http://www.adobe.com/devnet/flex/quickstart/defining_state_transitions/)，他们提到您应该使用并设置“fromState”和“toState”（您可以使用“*”来定义状态）。我假设您的 2 个简单的画布组件都处于自己的状态？如果是这样，一旦你设置了过渡，它应该能够发挥你的效果。链接的站点还提到可以按顺序或并行播放效果，这可能需要获得您想要的效果。

**编辑：**

我做了一个小测试，这就是我想出的。它似乎在我的测试中有效，因为两个画布都是动画的。我假设您正在使用 setCurrentState("newState", **true** )。我希望这是你所要求的。

```
<mx:transitions>
  <mx:Transition fromState="FirstState" toState="SecondState">
    <mx:Parallel>
      <mx:WipeLeft target="{CanvasA}" duration="300"/>
      <mx:WipeRight target="{CanvasB}" duration="300"/>
    </mx:Parallel>
  </mx:Transition>
</mx:transitions> 
```

**进一步编辑：** [这](http://livedocs.adobe.com/flex/3/html/help.html?content=transitions_1.html)也可能有用。我认为您需要做的是，让两个画布都处于其中一种状态，然后执行它。也许您需要稍微重新安排您的状态，以便两个画布都处于一个状态，目前我假设您已将它们保持在不同的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-14T13:43:06.990

公共函数 addTransitions():void { var transition:Transition = new Transition();
变种移动：移动=新移动（）；

```
 move.duration=400;
  move.targets = windowArray;

  transition.fromState = "*";
  transition.toState = "*";
  transition.effect = move;            

  // I was mising THIS line
  transitions.push(transition); 
```

}

# python - 一个 wxPython 时间线小部件

> ID：715950
> 
> 赞同：2
> 
> 时间：2009-04-03T22:24:24.603
> 
> 标签：python, controls, wxpython, widget, timeline

我正在寻找某个 wxPython 小部件以在我的程序中使用。我希望存在这样的东西，并且您可能知道在哪里可以找到。我将尝试描述我正在寻找的功能：

想象一下像 Audacity 用来显示音轨的小部件。这是一个水平时间线，带有标尺。可以放大和缩小，滚动，并且标尺会更新以反映您在时间轴上的位置/深度。只有时间线的有限段被“占用”，即实际上包含数据。其余为空。可以用鼠标选择时间轴上的任何时间点，当然也可以让它“播放”：以指定的速度从左到右遍历时间轴。

如果您知道至少与我所描述的内容相近的东西，我会很感兴趣。

* * *

如果您想知道这个小部件的工作是什么：它是用于运行模拟的程序。程序在后台计算模拟，扩展时间线的“占用”部分。可以在时间线上选择不同的点来观察系统在某个时间点的状态，当然也可以玩模拟。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T00:46:01.580

快速的网络搜索不会产生任何结果，但其他人希望得到同样的结果。我的猜测是你不会为时间线找到任何不错的 wx 小部件。您可能得到的最接近的是[wxSlider](http://zetcode.com/wxpython/widgets/#slider)。这远非理想，但它会让你启动并运行。您还可以考虑创建一个[自定义小部件](http://www.zetcode.com/wxpython/customwidgets/)——这肯定可以满足您的需求，但工作量很大。对不起，我没有更好的东西，但我认为有一些答案总比没有好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T09:35:26.227

我一直在研究用于 Task Coach ( [http://www.taskcoach.org](http://www.taskcoach.org) ) 的时间线小部件。我还没有单独发布它，但是它与 Task Coach 源代码的其余部分完全隔离，所以你应该可以很容易地把它撕掉。请参阅[http://taskcoach.svn.sourceforge.net/viewvc/taskcoach/trunk/taskcoach/taskcoachlib/thirdparty/timeline/](http://taskcoach.svn.sourceforge.net/viewvc/taskcoach/trunk/taskcoach/taskcoachlib/thirdparty/timeline/)

# ruby - 如果这段代码不是玩笑，它到底是如何工作的？

> ID：715951
> 
> 赞同：6
> 
> 时间：2009-04-03T22:24:46.897
> 
> 标签：ruby, obfuscation

```
class Tree
  def initialize*d;@d,=d;end
  def to_s;@l||@r?",>":@d;end
  def total;(@d.is_a?(Numeric)?@d:0)+(@l?@l.total: 0)+(@r?@r.total: 0);end
  def insert d
    alias g instance_variable_get
    p=lambda{|s,o|d.to_s.send(o,@d.to_s)&&
      (g(s).nil??instance_variable_set(s,Tree.new(d)):g(s).insert(d))}
    @d?p[:@l,:]:@d=d
  end
end 
```

有人愿意尝试解释这是做什么的吗？[它作为我询问的关于代码太聪明](https://stackoverflow.com/questions/708428/whats-an-example-of-ruby-code-thats-too-clever)的问题的答案出现了。但我太聪明了，无法判断这是否只是一个玩笑。如果不是，我很想知道它是如何工作的，如果有人愿意解释的话。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-03T23:04:11.870

**编辑：发布原始混淆示例的人在他的回答中给出[了实际的源代码。](https://stackoverflow.com/questions/715951/if-this-code-is-not-a-joke-how-on-earth-does-it-work/716110#716110)他还发布了[混淆代码的更正版本](https://stackoverflow.com/questions/715951/if-this-code-is-not-a-joke-how-on-earth-does-it-work/716139#716139)，因为正如我所指出的，即使您删除了时髦的语法，其中一些也没有意义。**

那是一些很好的混淆代码。与大多数混淆代码一样，它主要是大量的三元运算符，并且顽固地拒绝在正常人的情况下放入空格。这里基本上是更正常的写法：

```
class Tree
  def initialize(*d)
    @d,  = d # the comma is for multiple return values,
             # but since there's nothing after it,
             # all but the first are discarded.
  end
  def to_s
    @l || @r ? ",>" : @d
  end
  def total
    total = @d.is_a?(Numeric) ? @d : 0
    total += @l.total if @l
    total += @r.total if @r
  end
  def insert(arg)
    if @d
      if @l
        @l.insert(arg)
      else
        @l = Tree.new(arg)
      end
    else
      @d = arg
    end
  end
end 
```

insert 方法在语法上无效（它的一部分缺少方法名称），但据我所知，这基本上就是它的作用。该方法中的混淆非常严重：

1.  它不只是做`@l = whatever`，而是使用`instance_variable_get()`和`instance_variable_set()`。更糟糕的是，它的别名`instance_variable_get()`只是 be `g()`。

2.  它将大部分功能包装在一个 lambda 函数中，并将`@l`. 然后它用鲜为人知的语法调用这个函数`func[arg1, arg2]`，它等价于`func.call(arg1, arg2)`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T22:40:42.597

这似乎是很少行的二叉树实现。如果我对 ruby​​ 语法的理解有限，我深表歉意：

```
class Tree                    // defining the class Tree

    def initialize *d;        // defines the initializer
        @d = d;               // sets the node value
    end

    def to_s;                 // defines the to_s(tring) function
        @l || @r ? ",>" : @d; // conditional operator. Can't tell exactly what this 
                              // function is intending. Would think it should make a
                              // recursive call or two if it's trying to do to_string
    end

    def total;                // defines the total (summation of all nodes) function
        @d.is_a ? (Numeric)   // conditional operator.  Returns
            ? @d              // @d if the data is numeric
            : 0               // or zero
        + (@l ? @l.total : 0) // plus the total for the left branch
        + (@r ? @r.total : 0) // plus the total for the right branch
    end

    def insert d              // defines an insert function
        ??                    // but I'm not going to try to parse it...yuck
    end 
```

希望对一些人有所帮助......：/

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T23:45:12.413

一开始是这样的：

```
class Tree
  include Comparable

  attr_reader :data

  # Create a new node with one initial data element
  def initialize(data=nil)
    @data = data
  end

  # Spaceship operator. Comparable uses this to generate
  #   <, <=, ==, =>, >, and between?
  def <=>(other)
    @data.to_s <=> other.data.to_s
  end

  # Insert an object into the subtree including and under this Node.
  # First choose whether to insert into the left or right subtree,
  # then either create a new node or insert into the existing node at
  # the head of that subtree.
  def insert(data)
    if !@data
      @data = data
    else
      node = (data.to_s < @data.to_s) ? :@left : :@right
      create_or_insert_node(node, data)
    end
  end

  # Sum all the numerical values in this tree. If this data object is a
  # descendant of Numeric, add @data to the sum, then descend into both subtrees.
  def total
    sum = 0
    sum += @data if (@data.is_a? Numeric)
    sum += [@left, @right].map{|e| e.total rescue 0}.inject(0){|a,v|a+v}
    sum
  end

  # Convert this subtree to a String.
  # Format is: <tt>\<data,left_subtree,right_subtree></tt>.
  # Non-existant Nodes are printed as <tt>\<></tt>.
  def to_s
    subtree = lambda do |tree|
      tree.to_s.empty? ? "<>" : tree
    end
    "<#{@data},#{subtree[@left]},#{subtree[@right]}>"
  end

  private ############################################################
  # Given a variable-as-symbol, insert data into the subtree incl. and under this node.
  def create_or_insert_node(nodename, data)
    if instance_variable_get(nodename).nil?
      instance_variable_set(nodename, Tree.new(data))
    else
      instance_variable_get(nodename).insert(data)
    end
  end

end 
```

我想我在缩短它的时候实际上把它弄坏了。九行版本不太好用。不管怎样，我玩得很开心。:P

这是我最喜欢的部分：

```
def initialize*d;@d,=d;end 
```

这实际上是利用并行分配来保存几个字符。您可以将此行扩展为：

```
def initialize(*d)
  @d = d[0]
end 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-04T00:05:10.337

我发布了原始代码。对不起，但我没有费心去检查我是否做得对，而且由于少于符号，一堆东西被剥离了。

```
class Tree
  def initialize*d;@d,=d;end
  def to_s;@l||@r?"<#{@d},<#{@l}>,<#{@r}>>":@d;end
  def total;(@d.is_a?(Numeric)?@d:0)+(@l?@l.total: 0)+(@r?@r.total: 0);end
  def insert d
    alias g instance_variable_get
    p=lambda{|s,o|d.to_s.send(o,@d.to_s)&&
      (g(s).nil??instance_variable_set(s,Tree.new(d)):g(s).insert(d))}
    @d?p[:@l,:<]||p[:@r,:>]:@d=d
  end
end 
```

这就是它应该的样子。

# language-agnostic - 你如何处理不同的字符编码？

> ID：715958
> 
> 赞同：1
> 
> 时间：2009-04-03T22:32:40.653
> 
> 标签：language-agnostic, ide, unicode, encoding, character-encoding

我正在尝试了解有关字符编码的实用编程的基础知识。

有几点需要考虑：

*   我知道如何读取编码不同的文件，并将其转换为控制台的编码。
*   但是当我尝试转换出现在源代码中的文字字符串时，出于某种原因，它并不总是有效：
    *   在 IntelliJ 的`clojure`语言控制台（它的 REPL 或交互式解释器）中，它根本不起作用。我没有看这个特定的控制台是否与 IntelliJ 的标准 java 控制台不同。
    *   在 Apple 的终端中，它有时可以正常工作，具体取决于源文件的编码。
    *   在 Eclipse 和 Netbeans 中，它总是可以正常工作。

有很多资源可以了解 Unicode 和字符编码。但是 AFAIK，学习实际使用指南的内容并不多。StackOverflow 上的其他一些问题很有用，但对于我正在尝试做的事情来说，这些问题都还不够。

**更新：** 在了解了我所面临的问题的普遍性之后，我大大简化了这个问题。最初，它专门针对该`Java`平台，并带有该`clojure`语言的代码示例。要查看这些，请查看此问题的第一个版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T22:57:22.090

您的问题与您的 IDE 如何告诉 Java 编译器解释源文件的编码有关。（控制台输出可能是另一个问题。不知道）

如果你运行没有参数的 javac 程序，你会得到一个帮助打印（下面的 excert），它会提示你它是如何工作的。

```
 -encoding <encoding>       Specify character encoding used by source files 
```

因此，Javac 解释源文件及其文字字符串和所有内容，将其转换为我认为在字节码中的 UTF8。我确信 Closure 编译器也有类似的选项。

在 Eclipse 中，决定源文件编码的选项位于 General > Workspace > Text file encoding 下。在我的瑞典 Windows 机器下，选择的默认值是 CP1252。（我不在乎那里有什么，因为正是出于这个原因，我避免使用 ASCII 之外的字符。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T18:53:32.417

作为能够解决此类问题的知识记录，这里有一些亮点：

1.  **验证程序使用的每个文件的编码**。这包括*源文件*和*数据文件*，无论是在本地还是在任何网络上获取。
    1.  **确保读取*源*文件的内容知道它们各自的编码：**
        *   *如果您使用 IDE*，请验证它用于以下设置的编码：
            *   *IDE 范围的*编码
            *   *项目范围的*编码
            *   *模块范围的*编码
            *   及其*特定于文件的*编码。
            *   当然，您可能希望使用唯一的编码将它们全部标准化。
        *   如果您*在 IDE 之外*使用任何类型的构建工具或编译器，请验证其设置。
    2.  **确保读取*数据*文件的内容知道它们各自的编码。**您将使用您的编程语言的功能从原始编码中解码每个数据文件。
2.  **验证程序生成的每种字符数据**的用户需要什么编码。**您将使用您的编程语言的功能来编码所有内容：

    *   用户界面
    *   由您的程序创建或修改的文件，包括：
        *   网络通讯
        *   日志文件。** 

 **以下由其他人提供的提示可能非常有用：

*   **不要使用默认的平台编码**，除非你真的非常确定你的意思。
*   **更喜欢带有自己编码信息的格式**。XML 就是一个很好的例子：所有有效的 XML 文件都有一个非常明确定义的编码；解析它们不依赖于某些外部方式指定的编码。

另请参阅以下学习资源：

*   Jon Skeet 的[Debugging Unicode Problems](http://pobox.com/~skeet/csharp/debuggingunicode.html)文章，其中包含更多技术方面的技巧。
    *   Jon Skeet 如何[将他的知识应用到 Java](https://stackoverflow.com/questions/498636/java-app-unable-to-read-iso-8859-1-encoded-file-correctly/498644#498644)中。

要扩大主题，请参阅[哪些问题会阻止 Java 应用程序在多个平台上运行？](https://stackoverflow.com/questions/453538/what-issues-prevent-java-applications-from-working-on-multiple-platforms).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T22:36:58.457

除了您展示的代码不是 Java 之外，我还建议您查看 ICU ( [http://site.icu-project.org/](http://site.icu-project.org/) )，它是 Java 和 C++ 中可用的开源 Unicode 库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T22:58:43.537

`-encoding`选项告诉编译器`javac`源文件使用什么字符编码。

IDE 通常默认使用平台字符编码，但可以设置为使用您指定的编码。然后他们又走了一步，让您覆盖单个文件的编码。

如果您的编辑器或 IDE 使用的不是平台默认设置，那么您使用不同的工具编译或编辑文件，您需要确保两个工具都明确指定了相同的编码。

# svn - 寻找一个安全的 SVN 远程更新 post-commit 钩子

> ID：715967
> 
> 赞同：0
> 
> 时间：2009-04-03T22:38:18.050
> 
> 标签：svn, hook, post-commit, staging

我正在与其他一些开发人员一起使用开发、登台、生产服务器环境。

现在我们进行更改，在我们的开发服务器（个人计算机）上测试它们，然后一旦我们对更改感到满意并希望将它们展示给客户端或内部审查，我们将更改提交到存储库并通过 samba 更新登台服务器的工作副本(tortoiseSVN) 或 ssh。

这变得非常乏味和重复。我希望有一个提交后挂钩更新远程登台服务器，但唯一的选择似乎涉及在 SSH 挂钩中硬编码用户凭据或使用用户帐户创建网络挂载。有没有办法将用户身份验证从初始提交传递到登台服务器以进行更新或任何其他建议？

欢迎使用其他设置解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T23:41:29.583

如果您担心将用户 SSH 凭据硬编码到脚本中，您可以创建一个没有密码的 SSH 密钥对。在目标机器上，您需要通过添加限制该密钥对仅运行 Subversion

```
command="/path/to/svnserve -t" 
```

到 SSH 授权密钥文件的前面，例如：

```
command="/usr/bin/svnserve -t" ssh-dss <key text> 
```

修改您的钩子脚本以使用此密钥进行登录，与传统的无密码 SSH 密钥相比，您将拥有（稍微）更高的安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:54:11.163

您是否考虑在您的登台服务器上使用像 CruiseControl ( [http://cruisecontrol.sourceforge.net/ ) 这样的自动化系统？](http://cruisecontrol.sourceforge.net/)

CruiseControl 可以配置为检查是否有新的签入，然后开始构建（通常在第一步进行签出）。

您甚至可以监控不同的分支，并根据签入更改的分支进行自动集成和发布构建。

我们在这里非常成功地使用该习惯用法进行自动化构建。

# asp.net - ASP.NET MVC 最佳实现实践

> ID：715968
> 
> 赞同：3
> 
> 时间：2009-04-03T22:38:55.987
> 
> 标签：asp.net, asp.net-mvc

我最近被要求完全重写和重新设计一个网站，该公司的所有者强调他希望网站使用最新和最先进的技术来制作，但要避免额外的成本。

截至目前，我在研究 CMS 实现和使用 MVC 编写新实现之间左右为难。

该网站主要是宣传册，但需要允许访问者通过表格提交一些数据。有相当多的列表和内容特征是动态的，应该这样对待。由于 ASP.NET MVC 是新的，如果我这样做的话，我不想把实现混为一谈......

关于 MVC 网站的最佳实施实践有什么建议吗？另外，有没有人将他们的 MVC 实现托管在他们推荐的任何地方？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T22:58:06.440

[http://www.sharparchitecture.net/](http://www.sharparchitecture.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:44:47.347

还需要考虑[ASP.Net 动态数据。](http://www.asp.net/dynamicdata/)您可以同时使用 MVC 和 DD。SHanselman 有[一篇很好的文章](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)介绍了如何解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-01T05:35:07.503

到目前为止，我认为[Who Can Help Me](http://whocanhelpme.codeplex.com)是 ASP.NET MVC 的出色实现

我也认为这些是很好的编码示例：

*   [Sharp Architecture](http://www.sharparchitecture.net/)（谁能帮助我利用这个框架的一部分）
*   [MVC 涡轮机](http://mvcturbine.codeplex.com/)

其他一些也很好（一旦您完成了上述操作）。

*   [N2CMS](http://n2cms.com) 内容管理系统
*   [BlogService (AtomSite)](http://atomsite.net)博客引擎
*   [果园CMS](http://orchard.codeplex.com)内容管理系统

# php - 在 PHP 中需要一个简单的哈希

> ID：715969
> 
> 赞同：3
> 
> 时间：2009-04-03T22:39:02.087
> 
> 标签：php, encryption

我需要创建一个简单的散列方法来在 URL 中传递一些数据。它不需要非常安全，它对大多数人来说不应该是显而易见的。

散列需要包含发件人的数字 id 和收件人的 id，我应该能够在读取附加的散列后解码数据。

有任何想法吗？我希望哈希值尽可能短，因为这个 url 旨在通过 IM、电子邮件等共享。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T22:43:42.093

哈希只是一种方式。如果你想解密它，你必须加密它。尝试[mcrypt](http://php.net/manual/en/function.mcrypt-encrypt.php)与[其中之一](http://php.net/manual/en/mcrypt.ciphers.php)。

对于不安全的东西，您可以尝试[base64_encode](http://php.net/manual/en/function.base64-encode.php)，您还可以将[每个](http://php.net/manual/en/function.base-convert.php)数字 id 从 10 位转换为 36 位左右。将数字与秘密常数相乘也会有所帮助。

```
$obscurity = base_convert($recipientId * 42, 10, 36) . ':' . base_convert($senderId * 42, 10, 36) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T22:49:42.797

尝试 base64 编码/解码。与 apache 选项“Multiviews”或 apache mod_rewrite 一起使用，将使您的 url 看起来像：

```
http://mysite.com/messages/[encoded string here] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T22:57:43.727

如果您想再次对其进行解码，base64 绝对应该可以解决问题。

请注意，这不是“散列”，散列通常意味着单向加密。

```
`$senderId = 1234;
$recipientId = 5678;
$myString = $senderId . ":" . $recipientId;
echo base64_encode($myString);` 
```

* * *

 `## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T22:46:30.277

如@OIS 所述，您可以使用加密。

或者，您可以使用散列并将散列值存储在以发件人 ID 和收件人 ID 为关键字的数据库中。PHP 有`md5()`并且`sha1()`是内置的。

# mobile - 从移动浏览器启动 SMS

> ID：715971
> 
> 赞同：5
> 
> 时间：2009-04-03T22:39:53.443
> 
> 标签：mobile

> **可能重复：**
> [从移动浏览器发送短信](https://stackoverflow.com/questions/848575/sending-an-sms-from-mobile-browser)

是否可以通过移动浏览器上的网站链接启动 SMS/Texting 应用程序？我怀疑这在全球范围内是否可行，但对于我们可以检测和显示的某些子集（Blackberry、Windows Mobile、Google Android 等）来说可能是可行的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T20:58:51.240

您可以使用 wap wtai primite: `<a href="sms:1234567?body=hello world">Send SMS</a>`。它可以在绝大多数浏览器上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T16:29:24.733

iOS specific docs: [http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/sms.html](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/sms.html)

examples on other platforms such as Android here: [http://beradrian.wordpress.com/2010/01/15/special-links/](http://beradrian.wordpress.com/2010/01/15/special-links/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T13:01:00.423

我不认为它是开箱即用的，但您可以在最近的 series60 手机（三星 innov8、诺基亚 n85...）上安装 webkit 小部件，以将浏览器与消息传递应用程序链接起来。

# jasper-reports - Jasper 报告 - 组更改时打印

> ID：715972
> 
> 赞同：7
> 
> 时间：2009-04-03T22:39:56.890
> 
> 标签：jasper-reports

我正在尝试打印该组的最后一条记录，但表达式`print when group changes: True`似乎不起作用。它只是打印该组的所有记录。（我根据用户名对记录进行了分组）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-14T20:58:25.173

我遇到了同样的问题。这是我想出的解决方法：

JasperReports 有一些自动生成的变量可以帮助你实现你想要的。对于您创建的每个组，都有一个计数器来跟踪当前组中的项目数：

```
yourGroupName_COUNT 
```

在您的 printWhenExpression 中，只需添加如下表达式，以便仅在您的组破裂时打印文本字段：

```
$V{yourGroupName_COUNT}==1 
```

-本杰明

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-24T08:20:47.510

我不认为该属性正在做你认为它所做的事情。它应该与 isPrintRepeatedValues="false" 一起使用，并按以下方式工作：

“如果您抑制的重复值跨越多个组，如果您在 printWhenGroupChanges 属性中指定该特定组的名称，则可以使其重新出现在某个报告组的开头。” 终极指南第 页。116

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-28T21:40:23.270

我从未使用过“组更改时打印”功能，但现在在新报告上尝试它，我明白你的意思 - 即使组没有更改，它也会打印每个详细记录。

不要使用“组更改时打印”标志，取消选中“打印重复值”标志，这可能会给你你想要的。

# php - 在 SQL 查询中使用 PHP 变量变量

> ID：715984
> 
> 赞同：0
> 
> 时间：2009-04-03T22:44:57.673
> 
> 标签：php, sql, variables

很抱歉这个问题是一个“你能解决它吗”的问题，但是这段代码让我困惑了一段时间。

我基本上是在制作一个包含一堆行和列的表，并且在每个表中我都有一个稍微变化的 SQL 查询。为了使它更容易而不是全部输入，我制作了这个脚本，但它开始变得有点复杂，所以你们中的任何人都可以设法让它正确吗？

```
echo '<td background="images/map/';
$tile = mysql_fetch_array(mysql_query("SELECT image FROM map WHERE horizontal = ${'mapPiece' . $mapPieceCount . [0]} AND verticle = ${'mapPiece' . $mapPieceCount . [0]}"));
echo $tile[0];
echo '.png"></td>'; 
```

谢谢，斯坦尼

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T22:51:32.120

假设我正确解释了这一点， [0] 需要超出花括号：

```
echo '<td background="images/map/';
$tile = mysql_fetch_array(
          mysql_query(
            "SELECT image FROM map WHERE horizontal = ".
            ${'mapPiece' . $mapPieceCount}[0].
            " AND verticle = ".
            ${'mapPiece' . $mapPieceCount}[0]
          )
        );
echo $tile[0]; 
echo '.png"></td>'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T22:51:42.323

首先，您不能`[0]`像在字符串上连接一样附加数组索引。总体而言，如果您只添加几行以使事情更整洁，那会容易得多：

```
$currentPiece = 'mapPiece' . $mapPieceCount;
echo '<td background="images/map/';

$query = 'SELECT image '.
            'FROM map '.
            'WHERE horizontal = '.${$currentPiece}[0].' '.
                'AND verticle = '.${$currentPiece}[0];
$result = mysql_query($query);
$tile = mysql_fetch_array($result);

echo $tile[0];
echo '.png"></td>'; 
```

# java - 在库中使用依赖注入

> ID：715990
> 
> 赞同：7
> 
> 时间：2009-04-03T22:47:36.827
> 
> 标签：java, dependency-injection

我正在编写一个将由现有应用程序使用的 java 库。我正在使用依赖注入，所以测试更容易，而且我熟悉 Spring，所以我打算在测试时使用它来管理依赖注入。然而，最终将使用该库的应用程序不是基于 Spring 的，它目前也不使用任何类型的任何 IoC/DI 容器。我的问题是，如果不使用 Spring 或 Guice，注入依赖项的最佳方法是什么？我应该考虑使用工厂方法来实例化和连接对象吗？依赖项都在库中，因此让应用程序实例化每个依赖项来创建主对象似乎并不合适。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T00:34:07.163

> 如果不使用 Spring 或 Guice，注入依赖项的最佳方法是什么？

如果您的库是用对 DI 友好的习语编写的。它应该很容易用作严格的 Java API。想想你过去的春天经历。有几个库与弹簧模型完美契合，但都是在春季之前编写的。我看不出有什么不好的，`new`然后是几个，然后是对*实际工作*方法`setXX`的调用。只是要格外小心，因为除其他外，您的客户可能会忘记调用spring 可靠调用的 thouse 方法。*`init`*

 *> 我应该考虑使用工厂方法来实例化和连接对象吗？依赖项都在库中，因此让应用程序实例化每个依赖项来创建主对象似乎并不合适。

让客户端应用程序来决定。您正在提供一个库。让 API 客户端连接它自己的对象。举个例子。稍后，可以使用相同的示例在客户端域上创建工厂方法。也许客户端应用程序有自己的配置方式，如果您的库提供的 API 足够灵活以利用这一点，那将是可取的。

或者，也许你可以包括 guice。许可证是 Apache。就像整个 Java 本身一样。

# design-patterns - 此应用程序的设计模式？

> ID：715992
> 
> 赞同：0
> 
> 时间：2009-04-03T22:48:02.720
> 
> 标签：design-patterns

您正在编写一个管理在线课程的应用程序。一门课程以多种不同的方式完成。用户必须执行以下一项或多项操作才能完成课程：

*   在课程中花费 x 小时
*   参加考试并通过考试（每门课程的及格分数可能不同）
*   参加课程中的所有课程
*   其他一些你还不知道的要求

当一门课程完成时，需要发生一些事件。事件取决于课程。可能需要发生以下一项或多项：

*   为用户创建自定义证书
*   通过电子邮件、HTTP 回调或其他方式向组织发出警报
*   其他一些你还不知道的要求

许多课程的要求几乎相同，但有些课程是完全独特的。有很多课程，超过 50 门，而且还在不断增加。

您将如何设计这样的应用程序？有没有一种设计模式可以用来消除冗余代码，让添加/编辑课程变得容易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T23:01:50.770

用于处理最后阶段的消息总线和用于确定它们何时通过的状态机。实际上，所有这些都可以通过消息总线完成。一本值得阅读的好书是《企业集成模式》，它涵盖了此类情况。棘手的部分是确保软件的故障不会导致学生失去学分。

也许我只是有 jms/esb 发烧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T00:03:46.563

在这里，我将如何开始勾勒它......

您有一个 Course 对象，该对象在其构造函数中接受一个 Requirements 对象和一个 OnCompleteActions 对象...授予我将构造函数内部化并创建一个 CourseBuilder 它将知道如何构建所有不同的课程但是...

当课程更新时，它通过将自身传递给需求对象来检查是否满足要求。如果它满足要求，则将自身传递给 OnCompleteActions。

```
private void OnCourseUpdate()
{
        if (this._Requirements.AreMetBy(this))
        {
            this._OnCompleteActions.Execute(this);
        }
} 
```

Requiremetns 对象不过是 IRequirement 的聚合列表，您可以根据您创建的课程进行微调... AreMetBy 方法简单地枚举列表中的所有 IRequirements 并检查您的课程是否满足所有要求...

```
interface IRequirement 
{
    public bool IsMetBy(Course course);
} 
```

然后你可以有各种不同的需求来实现 IRequirement ......

```
class CourseHoursRequirement : IRequirement
{
    public CourseHoursRequirement(int minimumHours)
    {...}

    public bool IsMetBy(Course course)
    {
        return course.NumberHours >= this._MInimumHours 
    }
} 
```

OnCompleteActions 的相同想法将具有一个或多个 IOnCompleteAction 的列表，这些 IOnCompleteAction 将执行每个。前任。CreateCertificateOnCompleteAction、SendEmailOnCompleteAction 等。

通过将每个可能的需求封装在其自己的类中，您可以构建一个具有 MinimumHourRequirement、PassedAllTestRequirement 等的课程。您可以轻松添加新的需求，因为它们都实现了相同的接口。您可能必须随时添加一些限制属性（例如 minimumHours），但真正的工作是在 IsMetBy() 方法内部完成的......

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T21:33:00.063

由于任何课程都有固定的步骤，那么我们可以在这里使用模板模式吗？像

```
interface Course{
timeSpent();
testTaken();
lessonLearnt();
miscllenious();

} 
```

所有课程都会实现这个接口并相应地实现方法。请提供您的意见，以便我清楚我是否理解它。

# c - PostMessage 和 CALLWNDHOOK，缺少已注册的消息？

> ID：715996
> 
> 赞同：-1
> 
> 时间：2009-04-03T22:49:17.133
> 
> 标签：c, winapi, hook

这是情况。我有两个不同的窗口挂钩，一个是 WH_SHELL 品种的全局挂钩，用于监视新的顶级窗口，第二个是 WH_CALLWNDPROC 的线程挂钩，它设置在第一个发现的一些顶级窗口上钩。这两个钩子在不同的 DLL 中实现。

据我所知，两个挂钩都安装正确。~~但是，我没有使用消息代码 > WM_USER~~将注册消息发布到挂钩窗口，而自定义 WH_CALLWNDPROC 挂钩从未处理过注册消息，但是“正常”的窗口消息正在传递，认为它很好。

挂钩已发现窗口的代码：

```
... Getting handle, mod, and procHook ...
DWORD threadId = GetWindowThreadProcessId(handle, NULL);

HHOOK hook = SetWindowsHookEx(WH_CALLWNDPROC, (HOOKPROC)procHook, mod, threadId);

if(!PostMessage(handle, CUSTOM_MESSAGE, NULL, NULL))
{
  ... fetch and print error message ...
} 
```

钩子本身的主体：

```
... Report sends a message to an agreed upon window with the passed wParam & lParam
Report(20, nCode);

if(nCode == CUSTOM_MESSAGE)
{
  ... This code is never reached ...
  Report(50, ERROR_SUCCESS);

  if(PerformTask())
    Report(200, ERROR_SUCCESS);
  else
    Report(400, ERROR_SUCCESS);
}

... More code handling more messages in the same basic form 
```

第一个报告调用是确认钩子已安装并正在工作，因为它在十几岁和二十几岁时发回了一堆消息（ERASEBACKGROUND、PAINT 等）。

~~CUSTOM_MESSAGE 定义为 WM_USER + 314。用于 Report(...) 的消息是 WM_USER + 317。~~

*我已经更新了我的代码以使用 RegisterWindowMessage 来获取要发送的 UINT，我使用 WM_USER 进行进程间通信是不正确的。*

所以，基本上，我的设计或我对 Windows 挂钩和 PostMessage 的使用有什么问题？如果我遗漏了任何细节，请告诉我；涉及很多代码，这已经是一个相当大的问题，所以我试图只包括我认为相关的内容。

顺便说一句，是否有一致同意的更好的方法来调试钩子？我一直在通过将消息发布到商定的窗口并调试其 WndProc 来使用与 cout << ... 所有内容的道德等价物。

谢谢，
-凯文·蒙特罗斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T23:23:08.877

虽然@Michael 关于消息的使用是正确的`WM_USER`（它们应该只在应用程序中使用 -[注册消息](http://msdn.microsoft.com/en-us/library/ms644947.aspx)是更好的方式），同时我认为你没有收到它们的原因是由于钩子的性质`CallWndProc`和张贴的消息。我不是很肯定，但我认为你想`GetMessage`钩住已发布消息的钩子。

另一种选择是挂钩`Debug`钩子，它在所有其他钩子之前接收所有消息。您可以让该手表查看您的自定义消息，然后从那里确定哪个钩子（如果有）接收到您的自定义消息。

编辑：对于调试挂钩，只需附加到有问题的进程，并在挂钩过程中设置断点。这最终是我发现调试它们的最简单方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T03:47:06.497

我想我想通了。没有完全吸收文档的简单案例。

我的 CallWndProc 钩子表现得好像 nCode、wParam 和 lParam 是传递给钩子线程 WndProc 的内容。事实上，lParam 包含一个指向 CWPSTRUCT 的指针。从该结构中读取数据，一切正常。

# actionscript-3 - ActionScript 3 名称属性未返回正确的名称...？

> ID：715997
> 
> 赞同：0
> 
> 时间：2009-04-03T22:49:19.067
> 
> 标签：actionscript-3, properties

我在 as3 中遇到了 name 属性的问题，我创建了这个“点”电影剪辑并导出到一个类，然后我使用循环匿名创建了一堆点。我为每个点分配了数字作为名称

```
private function callDots(num:Number):void
    {                
        for (var i = 0; i < subImagesTotal[num]; i++)
        {
            var d:Dot = new Dot();
            d.x = i*23;
            d.y = 0;

            d.name = i;
            dotContainer.addChild(d]);
        }
    } 
```

到目前为止一切顺利，我检查了如果我在这里追踪名字，我会得到我想要的号码。但是，如果我在其他功能中跟踪它，它不会给我数字。我将所有点添加到“dotContainer”中，如果单击其中一个点，它将调用此函数

```
private function callFullSub(e:MouseEvent):void
   {
        var full_loader:Loader = new Loader();
        var temp:XMLList = subImages[sub];
        var full_url = temp[e.target.name].@IMG;

        full_loader.load(new URLRequest(full_url));
        full_loader.contentLoaderInfo.addEventListener(Event.INIT, fullLoaded);
    } 
```

e.target.name 应该是 1 或 2 之类的数字，但它给了我“instance66”“instance70”，我不知道为什么。因为我之前对装载机做过同样的事情，而且它完全有效。有任何想法吗？谢谢。

克里斯汀

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T15:44:11.327

e.target 返回点击的最里面的对象，这可能是一个 TextField、另一个 MovieClip 或可能是“点”内的一个形状（我不是 100% 的最后一个）。

为了防止这种情况，您可以尝试在添加点时将 mouseChildren 属性设置为 false。这应该确保点内的任何内容都不能调度点击事件，因此点应该这样做。

也许您也可以在事件处理程序中使用如下代码验证目标类型：

```
private function callFullSub(e:MouseEvent):void
{
    if(!e.target is Dot)
        throw new Error("target in callFullSub is not Dot but: " + e.target.toString());

    //The rest of you code here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T14:38:39.393

答案是 [e.currentTarget.name] 我一直在执行此操作！

应返回“Dot1”“Dot2”等。

如果您希望返回的值是数字或字符串以外的其他数据类型（对象名称），请使用 [e.currentTarget.name.substr(3,1).toString()]

应该返回 1、2 等。

纳维

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T02:26:16.427

我首先尝试使用运行时创建的movieClips 使用Flex 重现您的问题，然后使用为ActionScript 导出的点movieClip 符号使用Flash 重现您的问题。两个应用程序都没有出现问题。

您可能已经知道像“instance66”“instance70”这样的名称是默认的枚举实例名称。因此，调度 MouseEvent 的不是点实例。也许您无意中将 callFullSub 分配给了错误的目标，也许是您的容器？尝试在创建它们后立即将其分配给点实例，如下所示：

```
private function callDots(num:Number):void
{                
    for (var i = 0; i < subImagesTotal[num]; i++)
    {
        var d:Dot = new Dot();
        d.x = i*23;
        d.y = 0;

        d.name = i;
        d.addEventListener(MouseEvent.CLICK, callFullSub);
        dotContainer.addChild(d]);
    }
} 
```

请务必暂时注释掉您的原始作业。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-12T20:12:59.780

试试这个可能有用，..

```
d.name = i.toString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T21:47:41.313

你没有显示足够的代码让我能够给你一个明确的答案，但是我会这么说。

```
//After you create each loader you need to set its mouseEnabled
//property to false if you do not want it to be the target of
//Mouse Events, which may be superseding the actual intended target;

var full_loader:Loader = new Loader();
full_loader.mouseEnabled = false;
//Also you could name the loaders and see if what comes back when you click is the same. 
```

还！将此添加到 CLICK 或 MOUSE_DOWN 的鼠标事件处理程序中：

```
trace(e.target is Loader);  //If traces true you have an answer 
```

我相信加载器正在调度鼠标事件。

请提供更多代码，即 Loader.contentLoaderInfo 的 COMPLETE 处理程序触发的代码。我假设这是您将加载程序添加到显示列表的地方，因为我现在看不到。*`********